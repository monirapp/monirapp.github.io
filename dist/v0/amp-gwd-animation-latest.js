(self.AMP=self.AMP||[]).push({n:"amp-gwd-animation",v:"0",f:(function(AMP,_){
var f;function h(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]};function k(a){if(!a)return[];for(var b=Array(a.length),c=0;c<a.length;c++)b[c]=a[c];return b};self.log=self.log||{user:null,dev:null,userForEmbed:null};var l=self.log;function m(){if(!l.user)throw Error("failed to call initLogConstructor");return l.user};var p=Object.prototype.hasOwnProperty;function q(a){if(a.nodeType){var b=(a.ownerDocument||a).defaultView;if(b=b!=(b.__AMP_TOP||b)&&r(b,"action")?t(b,"action"):null)return b}b=v(a);b=w(b);return t(b,"action")}function x(a){var b=v(a),b=w(b);return t(b,"gwd")}function v(a){if(a.nodeType){var b=(a.ownerDocument||a).defaultView,b=b.__AMP_TOP||b;a=t(b,"ampdoc").getAmpDoc(a)}return a}function w(a){a=v(a);return a.isSingleDoc()?a.win:a}
function t(a,b){r(a,b);var c=a.services;c||(c=a.services={});var d=c;a=d[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function r(a,b){a=a.services&&a.services[b];return!(!a||!a.ctor&&!a.obj)};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
var y=/(\0)|^(-)$|([\x01-\x1f\x7f]|^-?[0-9])|([\x80-\uffff0-9a-zA-Z_-]+)|[^]/g;function z(a,b,c,d,e){return e?e:b?"\ufffd":d?a.slice(0,-1)+"\\"+a.slice(-1).charCodeAt(0).toString(16)+" ":"\\"+a};var A=["animationend","webkitAnimationEnd"];function B(a){var b=this;this.c=a;this.h=this.o.bind(this);this.c.whenBodyAvailable().then(function(){for(var a=0;a<A.length;a++)b.c.getBody().addEventListener(A[a],b.h,!0);b.setCurrentPage(0)})}f=B.prototype;f.setEnabled=function(a){this.c.getBody().classList.toggle("i-amphtml-gwd-animation-disabled",!a)};
f.setCurrentPage=function(a){var b=this.c.getRootNode().querySelectorAll("."+"gwd-page-wrapper".replace(y,z));if(0!=b.length){var c=this.c.getRootNode().querySelector("."+"gwd-page-wrapper".replace(y,z)+"."+"gwd-play-animation".replace(y,z));c&&D(c);var d=b[a];d?d.classList.add("gwd-play-animation"):m().error("GWD","Could not find page with index "+a+".")}};
function D(a){a.classList.remove("gwd-play-animation");[a].concat(k(a.querySelectorAll("*"))).forEach(function(a){a.classList.remove("gwd-pause-animation");if(a.hasAttribute("data-gwd-label-animation")){var b=a.getAttribute("data-gwd-label-animation");a.classList.remove(b);a.removeAttribute("data-gwd-label-animation")}delete a.__AMP_GWD_GOTO_COUNTERS__})}f.play=function(a){(a=this.getReceiver(a))&&a.classList.remove("gwd-pause-animation")};f.pause=function(a){(a=this.getReceiver(a))&&a.classList.add("gwd-pause-animation")};
f.togglePlay=function(a){(a=this.getReceiver(a))&&a.classList.toggle("gwd-pause-animation")};f.gotoAndPlay=function(a,b){(a=this.getReceiver(a))&&E(a,b)};f.gotoAndPause=function(a,b){var c=this,d=this.getReceiver(a);d&&(E(d,b),this.c.win.setTimeout(function(){c.pause(a)},40))};
f.gotoAndPlayNTimes=function(a,b,c,d){if(0>=c)m().error("GWD","Invalid maxCount parameter: "+c);else if(d){if(a=this.getReceiver(a)){var e=d+"_"+b,g=a.__AMP_GWD_GOTO_COUNTERS__&&p.call(a.__AMP_GWD_GOTO_COUNTERS__,e)?a.__AMP_GWD_GOTO_COUNTERS__[e]:0;g<c&&(E(a,b),a.__AMP_GWD_GOTO_COUNTERS__||(a.__AMP_GWD_GOTO_COUNTERS__={}),p.call(a.__AMP_GWD_GOTO_COUNTERS__,e)||(a.__AMP_GWD_GOTO_COUNTERS__[e]=0),a.__AMP_GWD_GOTO_COUNTERS__[e]=g+1)}}else m().error("GWD","Event name required but not specified.")};
f.getReceiver=function(a){if("document.body"==a)return this.c.getBody();var b=this.c.getRootNode().getElementById(a);if(b&&b.classList)return b;m().error("GWD","Could not get receiver with id "+a+".");return null};function E(a,b){a.classList.remove("gwd-pause-animation");var c=a.getAttribute("data-gwd-label-animation");c&&(a.classList.remove(c),a.removeAttribute("data-gwd-label-animation"));c==b&&(a.offsetWidth=a.offsetWidth);a.classList.add(b);a.setAttribute("data-gwd-label-animation",b)}
f.o=function(a){var b=a.target.getAttribute("data-event-name");if(b){a={eventName:b,sourceEvent:a};var c=this.c.win,d={detail:a};Object.assign(d,void 0);"function"==typeof c.CustomEvent?a=new c.CustomEvent("gwd.timelineEvent",d):(c=c.document.createEvent("CustomEvent"),c.initCustomEvent("gwd.timelineEvent",!!d.bubbles,!!d.cancelable,a),a=c);var e=a;this.c.getRootNode().dispatchEvent(e)}};f.dispose=function(){for(var a=0;a<A.length;a++)this.c.getBody().removeEventListener(A[a],this.h,!0)};var F={play:["args.id"],pause:["args.id"],togglePlay:["args.id"],gotoAndPlay:["args.id","args.label"],gotoAndPause:["args.id","args.label"],gotoAndPlayNTimes:["args.id","args.label","args.N","event.detail.eventName"],setCurrentPage:["args.index"]};function G(a){a=AMP.BaseElement.call(this,a)||this;a.l="";a.j=a.w.bind(a);return a}h(G,AMP.BaseElement);
G.prototype.buildCallback=function(){this.l=this.element.getAttribute("timeline-event-prefix")||"";this.getAmpDoc().getRootNode().addEventListener("gwd.timelineEvent",this.j,!0);var a=this.getAmpDoc().getRootNode().getElementById("pagedeck");if(a){m().assert(this.element.id,"The amp-gwd-animation element must have an id.");var b=this.element.id+".setCurrentPage(index=event.index)",c=this.getAmpDoc(),d=a,e=b,g;g=d.getAttribute("on")||"";var n=g.indexOf("slideChange:");-1!=n?(n+=12,g=g.substr(0,n)+
e+","+g.substr(n)):(g&&(g+=";"),g+="slideChange:"+e);q(c).setActions(d,g)}var c=this.m.bind(this),C;for(C in F)this.registerAction(C,c)};G.prototype.m=function(a){var b;b=a;if("setCurrentPage"==b.method){var c=this.getAmpDoc().getRootNode().getElementById("pagedeck");b=c&&b.source==c}else b=!0;b&&H(this,a)};
function H(a,b){a=m().assert(x(a.getAmpDoc()),"Cannot execute action because the GWD service is not registered.");var c=F[b.method],d=c.map(function(a){for(var c=a.split("."),d=b,e=0;e<c.length;e++){var u=c[e];if(u&&d&&void 0!==d[u])d=d[u];else{d=void 0;break}}return d});a[b.method].apply(a,d)}G.prototype.w=function(a){q(this.getAmpDoc()).trigger(this.element,""+this.l+a.detail.eventName,a,100)};
G.prototype.detachedCallback=function(){this.getAmpDoc().getRootNode().removeEventListener("gwd.timelineEvent",this.j,!0);return!0};(function(a){a.registerServiceForDoc("gwd",B);a.registerElement("amp-gwd-animation",G,".i-amphtml-gwd-animation-disabled [class*=-animation],.i-amphtml-gwd-animation-disabled [class*=gwdanimation]{-webkit-animation:none!important;animation:none!important}\n/*# sourceURL=/extensions/amp-gwd-animation/0.1/amp-gwd-animation.css*/")})(self.AMP);
})});
//# sourceMappingURL=amp-gwd-animation-0.1.js.map

