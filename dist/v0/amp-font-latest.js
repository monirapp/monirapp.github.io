(self.AMP=self.AMP||[]).push({n:"amp-font",v:"0",f:(function(AMP,_){
function l(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var g=Object.getOwnPropertyDescriptor(b,d);g&&Object.defineProperty(a,d,g)}else a[d]=b[d]};self.log=self.log||{user:null,dev:null,userForEmbed:null};var m=self.log;function n(){if(!m.user)throw Error("failed to call initLogConstructor");return m.user};function q(a,b){a=a.__AMP_TOP||a;var c=a.services;c||(c=a.services={});b=c[b];b.obj||(b.obj=new b.ctor(b.context),b.ctor=null,b.context=null,b.resolve&&b.resolve(b.obj));return b.obj};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
var r,t="Webkit webkit Moz moz ms O o".split(" ");function u(a,b){for(var c in b){var d=a,g=b[c],e;e=d.style;var f=c;if(2>f.length?0:0==f.lastIndexOf("--",0))e=f;else{r||(r=Object.create(null));var h=r[f];if(!h){h=f;if(void 0===e[f]){var k=f.charAt(0).toUpperCase()+f.slice(1);b:{for(var p=0;p<t.length;p++){var w=t[p]+k;if(void 0!==e[w]){k=w;break b}}k=""}void 0!==e[k]&&(h=k)}r[f]=h}e=h}e&&(d.style[e]=g)}};var v=["sans-serif","serif"];function x(a){this.m=a;this.h=a.win.document;this.c=this.j=null;this.C=this.D=!1}x.prototype.load=function(a,b){var c=this;this.c=a;return q(this.m.win,"timer").timeoutPromise(b,y(this)).then(function(){c.D=!0;c.l()},function(a){c.C=!0;c.l();throw a;})};
function y(a){return new Promise(function(b,c){var d=a.c.fontStyle+" "+a.c.variant+" "+a.c.weight+" "+a.c.size+" '"+a.c.family+"'";"fonts"in a.h?a.h.fonts.check(d)?b():a.h.fonts.load(d).then(function(){return a.h.fonts.load(d)}).then(function(){a.h.fonts.check(d)?b():c(Error("Font could not be loaded, probably due to incorrect @font-face."))}).catch(c):z(a).then(b,c)})}
function z(a){return new Promise(function(b,c){var d=q(a.m.win,"vsync"),g=A(a),e=d.createTask({measure:function(){a.D?b():a.C?c(Error("Font loading timed out.")):g.some(function(a){return a.compare()})?b():e()}});e()})}
function A(a){var b=a.j=a.h.createElement("div");u(b,{fontSize:"40px",fontVariant:a.c.variant,fontWeight:a.c.weight,fontStyle:a.c.fontStyle,left:"-999px",lineHeight:"normal",margin:0,padding:0,position:"absolute",top:"-999px",visibility:"hidden"});var c=v.map(function(c){return new B(b,a.c.family,c)});a.m.getBody().appendChild(b);return c}x.prototype.l=function(){if(this.j){var a=this.j;a.parentElement&&a.parentElement.removeChild(a)}this.j=null};
function B(a,b,c){var d=a.ownerDocument,g=b+","+c;this.o=C(d,c);this.B=C(d,g);a.appendChild(this.o);a.appendChild(this.B)}function C(a,b){a=a.createElement("div");a.textContent="MAxmTYklsjo190QW";u(a,{float:"left",fontFamily:b,margin:0,padding:0,whiteSpace:"nowrap"});return a}B.prototype.compare=function(){var a=2<Math.abs(this.o.offsetWidth-this.B.offsetWidth),b=2<Math.abs(this.o.offsetHeight-this.B.offsetHeight);return a||b};function D(a){a=AMP.BaseElement.call(this,a)||this;a.w="";a.H="";a.F="";a.G="";a.A=null;return a}l(D,AMP.BaseElement);D.prototype.prerenderAllowed=function(){return!0};
D.prototype.buildCallback=function(){this.w=n().assert(this.element.getAttribute("font-family"),"The font-family attribute is required for <amp-font> %s",this.element);this.H=this.element.getAttribute("font-weight")||"400";this.F=this.element.getAttribute("font-style")||"normal";this.G=this.element.getAttribute("font-variant")||"normal";this.A=new x(this.getAmpDoc());E(this)};
function E(a){a.A.load({fontStyle:a.F,variant:a.G,weight:a.H,size:"medium",family:a.w},F(a)).then(function(){var b=a.element.getAttribute("on-load-add-class"),c=a.element.getAttribute("on-load-remove-class");G(a,b,c)}).catch(function(){var b=a.element.getAttribute("on-error-add-class"),c=a.element.getAttribute("on-error-remove-class");G(a,b,c);n().warn("amp-font","Font download timed out for "+a.w)})}
function G(a,b,c){var d=a.getAmpDoc(),d=d.getRootNode().documentElement||d.getBody();b&&d.classList.add(b);c&&d.classList.remove(c);a.l()}D.prototype.l=function(){this.A=null};function F(a){var b=parseInt(a.element.getAttribute("timeout"),10),c=b,b="number"!==typeof c||!isFinite(c)||0>b?3E3:b;return b=Math.max(b-q(a.win,"timer").timeSinceStart(),100)}(function(a){a.registerElement("amp-font",D)})(self.AMP);
})});
//# sourceMappingURL=amp-font-0.1.js.map

