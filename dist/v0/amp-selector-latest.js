(self.AMP=self.AMP||[]).push({n:"amp-selector",v:"0",f:(function(AMP,_){
var g;function h(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]};function l(a){if(!a)return[];for(var b=Array(a.length),c=0;c<a.length;c++)b[c]=a[c];return b};self.log=self.log||{user:null,dev:null,userForEmbed:null};var n=self.log;function p(){if(!n.user)throw Error("failed to call initLogConstructor");return n.user};function q(a){if(a.nodeType){var b=(a.ownerDocument||a).defaultView;if(b=b!=(b.__AMP_TOP||b)&&r(b,"action")?t(b,"action"):null)return b}b=u(a);b=u(b);b=b.isSingleDoc()?b.win:b;return t(b,"action")}function u(a){if(a.nodeType){var b=(a.ownerDocument||a).defaultView,b=b.__AMP_TOP||b;a=t(b,"ampdoc").getAmpDoc(a)}return a}
function t(a,b){r(a,b);var c=a.services;c||(c=a.services={});var d=c;a=d[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function r(a,b){a=a.services&&a.services[b];return!(!a||!a.ctor&&!a.obj)};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function v(a,b){for(var c,d=a;d&&d!==c;d=d.parentElement)if(b(d))return d;return null}function w(a){return a.closest?a.closest("[option]"):v(a,function(a){var b=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector;return b?b.call(a,"[option]"):!1})}function x(a){var b=a.body.getAttribute("dir")||a.documentElement.getAttribute("dir")||"ltr";return"rtl"==b};var y={NONE:"none",FOCUS:"focus",SELECT:"select"};function z(a){a=AMP.BaseElement.call(this,a)||this;a.l=!1;a.h=[];a.c=[];a.m=[];a.o=!1;a.B=null;a.j=0;a.w="none";return a}h(z,AMP.BaseElement);g=z.prototype;g.isLayoutSupported=function(){return!0};
g.buildCallback=function(){var a=this;this.B=q(this.element);this.l=this.element.hasAttribute("multiple");this.o=this.element.hasAttribute("disabled");this.element.hasAttribute("role")||this.element.setAttribute("role","listbox");this.l&&this.element.setAttribute("aria-multiselectable","true");this.o&&this.element.setAttribute("aria-disabled","true");var b=this.element.getAttribute("keyboard-select-mode");b?(b=b.toLowerCase(),p().assertEnumValue(y,b),p().assert(!(this.l&&"select"==b),"[keyboard-select-mode=select] not supported for multiple selection amp-selector")):
b="none";this.w=b;this.registerAction("clear",this.A.bind(this));A(this);this.o||(this.element.addEventListener("click",this.C.bind(this)),this.element.addEventListener("keydown",this.D.bind(this)));this.registerAction("selectUp",function(b){var c=b.args;B(a,c&&void 0!==c.delta?-c.delta:-1)},1);this.registerAction("selectDown",function(b){b=b.args;B(a,b&&void 0!==b.delta?b.delta:1)},1);this.registerAction("toggle",function(b){var c=b.args;p().assert(0<=c.index,"'index' must be greater than 0");p().assert(c.index<
a.c.length,"'index' must be less than the length of options in the <amp-selector>");if(c&&void 0!==c.index){b=c.index;var c=c.value,e=a.c[b].hasAttribute("selected"),f=a.c.indexOf(a.h[0]);(void 0!==c?c:!e)!==e&&(f!==b?(C(a,a.c[b]),D(a,a.c[f])):D(a,a.c[b]))}},1);this.element.addEventListener("amp:dom-update",this.F.bind(this))};g.mutatedAttributesCallback=function(a){var b=a.selected;void 0!==b&&E(this,b)};
function E(a,b){if(null===b)a.A();else{var c=Array.isArray(b)?b:[b];a.l||(c=c.slice(0,1));var d=c.reduce(function(a,b){a[b]=!0;return a},Object.create(null));for(b=0;b<a.c.length;b++){var e=a.c[b],f=e.getAttribute("option");d[f]?C(a,e):D(a,e)}F(a);G(a)}}function F(a,b){if("none"!=a.w){a.c.forEach(function(a){a.tabIndex=-1});var c=b;c||(c=a.l?a.c[0]:a.h[0]||a.c[0]);c&&(a.j=a.c.indexOf(c),c.tabIndex=0)}}
g.F=function(){var a=l(this.element.querySelectorAll("[option]")),b;a:{b=this.c;var c=a;if(b.length!==c.length)b=!1;else{for(var d=0;d<b.length;d++)if(b[d]!==c[d]){b=!1;break a}b=!0}}b||(this.c=[],this.h=[],this.m=[],A(this,a))};
function A(a,b){(b?b:l(a.element.querySelectorAll("[option]"))).forEach(function(b){b.hasAttribute("role")||b.setAttribute("role","option");b.hasAttribute("disabled")&&b.setAttribute("aria-disabled","true");b.hasAttribute("selected")?C(a,b):D(a,b);b.tabIndex=0;a.c.push(b)});F(a);G(a)}
function G(a){var b=[],c=a.element.getAttribute("name");if(!c||a.o)return b;var d=a.element.getAttribute("form");a.m.forEach(function(b){a.element.removeChild(b)});a.m=[];var e=a.win.document,f=e.createDocumentFragment();a.h.forEach(function(m){if(!m.hasAttribute("disabled")){var k=e.createElement("input");m=m.getAttribute("option");k.setAttribute("type","hidden");k.setAttribute("name",c);k.setAttribute("value",m);d&&k.setAttribute("form",d);a.m.push(k);f.appendChild(k);b.push(m)}});a.element.appendChild(f);
return b}
function H(a,b){b.hasAttribute("disabled")||a.mutateElement(function(){var c;b.hasAttribute("selected")?a.l&&(D(a,b),c=G(a)):(C(a,b),c=G(a));if(c){F(a,b);var d=a.win;c={targetOption:b.getAttribute("option"),selectedOptions:c};var e={detail:c};Object.assign(e,void 0);"function"==typeof d.CustomEvent?d=new d.CustomEvent("amp-selector.select",e):(d=d.document.createEvent("CustomEvent"),d.initCustomEvent("amp-selector.select",!!e.bubbles,!!e.cancelable,c));var f=d;a.B.trigger(a.element,"select",f,100)}})}
g.C=function(a){if(a=a.target)a.hasAttribute("option")||(a=w(a)),a&&H(this,a)};function B(a,b){var c=a.c.indexOf(a.h[0]);b=c+b;var d=a.c.length,e=0<b&&0<d?b%d:(b%d+d)%d;C(a,a.c[e]);D(a,a.c[c])}
g.D=function(a){var b=a.keyCode;switch(b){case 37:case 38:case 39:case 40:if("none"!=this.w)a:{var c=this.win.document;switch(a.keyCode){case 37:c=x(c)?1:-1;break;case 38:c=-1;break;case 39:c=x(c)?-1:1;break;case 40:c=1;break;default:break a}a.preventDefault();this.c[this.j].tabIndex=-1;this.j=(this.j+c)%this.c.length;0>this.j&&(this.j+=this.c.length);a=this.c[this.j];a.tabIndex=0;try{a.focus()}catch(d){}a=this.c[this.j];"select"==this.w&&H(this,a)}break;case 13:case 32:c=a.keyCode,32!=c&&13!=c||
!this.c.includes(a.target)||(a.preventDefault(),H(this,a.target))}};function D(a,b){b.removeAttribute("selected");b.setAttribute("aria-selected","false");var c=a.h.indexOf(b);-1!==c&&a.h.splice(c,1)}g.A=function(){for(;0<this.h.length;){var a=this.h.pop();D(this,a)}G(this)};function C(a,b){a.h.includes(b)||(a.l||a.A(),b.setAttribute("selected",""),b.setAttribute("aria-selected","true"),a.h.push(b))}(function(a){a.registerElement("amp-selector",z,"amp-selector [option]{cursor:pointer}amp-selector [option][selected]{cursor:auto;outline:1px solid rgba(0,0,0,0.7)}amp-selector [disabled][option],amp-selector[disabled] [option],amp-selector[disabled] [selected],amp-selector [selected][disabled]{cursor:auto;outline:none}\n/*# sourceURL=/extensions/amp-selector/0.1/amp-selector.css*/")})(self.AMP);
})});
//# sourceMappingURL=amp-selector-0.1.js.map

