(self.AMP=self.AMP||[]).push({n:"amp-video-service",p:"high",v:"0",f:(function(AMP,_){
self.log=self.log||{user:null,dev:null,userForEmbed:null};var h=self.log;function k(a,b){a=a.__AMP_TOP||a;return l(a,b)}function m(a){return a.nodeType?k((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function l(a,b){p(a,b);var c=a.services;c||(c=a.services={});var d=c;a=d[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function p(a,b){a=a.services&&a.services[b];return!(!a||!a.ctor&&!a.obj)};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
var q;function r(a,b,c){var d=void 0,g=a,e=c,f;f=function(a){try{return e(a)}catch(v){throw self.reportError(v),v;}};var n=t(),w=!1;d&&(w=d.capture);g.addEventListener(b,f,n?d:w)}function t(){if(void 0!==q)return q;q=!1;try{var a={get capture(){q=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(b){}return q};function u(a,b,c){r(a,b,c)};function x(){this.c=null}x.prototype.add=function(a){var b=this;this.c||(this.c=[]);this.c.push(a);return function(){b.remove(a)}};x.prototype.remove=function(a){this.c&&(a=this.c.indexOf(a),-1<a&&this.c.splice(a,1))};x.prototype.removeAll=function(){this.c&&(this.c.length=0)};x.prototype.fire=function(a){if(this.c)for(var b=this.c,c=0;c<b.length;c++)(0,b[c])(a)};x.prototype.getHandlerCount=function(){return this.c?this.c.length:0};function y(a){var b=this,c=a.win;this.l=a;this.w=k(c,"timer");this.h=null;this.o=function(){b.h.fire();b.w.delay(b.o,1E3)}}y.prototype.register=function(a){var b=a.element;if(this.getEntryOrNull(b))return this.getEntryOrNull(b);if(!a.supportsPlatform())return null;var c=new z(this.l,this,a);c.install();var d=c;return b.__AMP_VIDEO_ENTRY__=d};y.prototype.getEntryOrNull=function(a){return a.__AMP_VIDEO_ENTRY__};
y.prototype.onTick=function(a){this.h=this.h||new x;this.h.add(a);1==this.h.getHandlerCount()&&(this.h.fire(),this.w.delay(this.o,1E3))};y.prototype.getAnalyticsDetails=function(){A("Video analytics");return Promise.resolve()};y.prototype.delegateAutoplay=function(){A("Autoplay delegation")};function z(a,b,c){this.l=a;this.A=b;this.j=c;this.m=!1}z.prototype.onPlaybackTick=function(a){var b=this;this.A.onTick(function(){b.m&&a()})};
z.prototype.install=function(){var a=this,b=this.j.element,c=b.signals();b.dispatchCustomEvent("registered");c.signal("registered");b.whenBuilt().then(function(){var b=a.j.element;B(a);C(a);b.classList.add("i-amphtml-video-interface")});c.whenSignal("load-start").then(function(){D(a)})};function C(a){var b=a.j.element;u(b,"pause",function(){a.m=!1});u(b,"playing",function(){a.m=!0})}
function B(a){function b(a,b){c.registerAction(a,function(){c.signals().signal("user-interacted");b()},d)}var c=a.j,d=1;b("play",function(){return c.play(!1)});b("pause",function(){return c.pause()});b("mute",function(){return c.mute()});b("unmute",function(){return c.unmute()});b("fullscreen",function(){return c.fullscreenEnter()})}
function D(a){a.onPlaybackTick(function(){var b=a.j,c=b.getCurrentTime(),d=b.getDuration();if("number"===typeof c&&isFinite(c)&&"number"===typeof d&&isFinite(d)&&!(0>=d)){var g=a.l.win,b=a.j.element,e;a:{e=a.l;if(e.nodeType){var f=(e.ownerDocument||e).defaultView;if(f=f!=(f.__AMP_TOP||f)&&p(f,"action")?l(f,"action"):null){e=f;break a}}e=m(e);e=m(e);e=e.isSingleDoc()?e.win:e;e=l(e,"action")}var n=e;c={time:c,percent:c/d};d={detail:c};Object.assign(d,void 0);"function"==typeof g.CustomEvent?g=new g.CustomEvent("amp-video-service.timeUpdate",
d):(g=g.document.createEvent("CustomEvent"),g.initCustomEvent("amp-video-service.timeUpdate",!!d.bubbles,!!d.cancelable,c));n.trigger(b,"timeUpdate",g,1)}})}function A(a){var b;if(h.dev)b=h.dev;else throw Error("failed to call initLogConstructor");b.warn("amp-video-service",a+" unimplemented.")}(function(a){a.registerServiceForDoc("video-service",y)})(self.AMP);
})});
//# sourceMappingURL=amp-video-service-0.1.js.map

