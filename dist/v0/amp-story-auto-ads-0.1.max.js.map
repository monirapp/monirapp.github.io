{"version":3,"sources":["node_modules/browser-pack/_prelude.js","build/amp-story-auto-ads-0.1.css.js","extensions/amp-story-auto-ads/0.1/amp-story-auto-ads.js","extensions/amp-story-auto-ads/0.1/utils.js","extensions/amp-story/1.0/amp-story-store-service.js","extensions/amp-story/1.0/embed-mode.js","extensions/amp-story/1.0/navigation-state.js","node_modules/document-register-element/build/document-register-element.patched.js","node_modules/promise-pjs/promise.js","src/analytics.js","src/common-signals.js","src/config.js","src/cookies.js","src/dom.js","src/element-service.js","src/experiments.js","src/json.js","src/log.js","src/mode-object.js","src/mode.js","src/observable.js","src/polyfills.js","src/polyfills/array-includes.js","src/polyfills/custom-elements.js","src/polyfills/document-contains.js","src/polyfills/domtokenlist-toggle.js","src/polyfills/math-sign.js","src/polyfills/object-assign.js","src/polyfills/promise.js","src/service.js","src/services.js","src/string.js","src/style.js","src/types.js","src/url-parse-query-string.js","src/url-try-decode-uri-component.js","src/url.js","src/utils/bytes.js","src/utils/lru-cache.js","src/utils/object.js","src/utils/promise.js","third_party/css-escape/css-escape.js"],"names":[],"mappings":"AAAA;;;;ACAO,IAAM,oBAAM,qpFAAZ;;;;;;;;;;ACgBP;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AACA;;;;;;;;+eA5BA;;;;;;;;;;;;;;;;AA8BA;AACA,IAAM,eAAe,CAArB;;AAEA;AACA,IAAM,MAAM,oBAAZ;;AAEA;AACA,IAAM,SAAS,QAAf;;AAEA;AACA,IAAM,eAAe,cAArB;;AAEA;AACA,IAAM,gBAAgB,KAAtB,C,CAA6B;;AAE7B;AACA,IAAM,mBAAmB,sBAAzB;;AAEA;AACA,IAAM,eAAe,mBAArB;;AAEA;AACA,IAAM,YAAY;AAChB,YAAU,mBADM;AAEhB,WAAS;AAFO,CAAlB;;AAKA;AACA,IAAM,YAAY;AAChB,WAAS,aADO;AAEhB,QAAM,UAFU;AAGhB,QAAM,UAHU;AAIhB,WAAS,aAJO;AAKhB,UAAQ,YALQ;AAMhB,aAAW;AANK,CAAlB;;AASA;AACA,IAAM,WAAW;AACf,WAAS,CADM;AAEf,YAAU,CAFK;AAGf,UAAQ;AAHO,CAAjB;;AAMA;AACA,IAAM,mBAAmB,iBAAI;AAC3B,YAAU,IADiB;AAE3B,iBAAe;AAFY,CAAJ,CAAzB;;AAKA;AACA,IAAM,SAAS;AACb,gBAAc,kBADD;AAEb,aAAW,eAFE;AAGb,eAAa,iBAHA;AAIb,aAAW,eAJE;AAKb,cAAY,gBALC;AAMb,aAAW,eANE;AAOb,gBAAc;AAPD,CAAf;;AAUA;AACA,IAAM,OAAO;AACX;AACA,gBAAc,aAFH;AAGX;AACA,aAAW,UAJA;AAKX;AACA,eAAa,YANF;AAOX;AACA,aAAW,UARA;AASX;AACA,cAAY,WAVD;AAWX;AACA,aAAW,UAZA;AAaX;AACA,gBAAc,aAdH;AAeX;AACA,YAAU,SAhBC;AAiBX;AACA,gBAAc,YAlBH;AAmBX;AACA;AACA,YAAU,UArBC;AAsBX;AACA,YAAU;AAvBC,CAAb;;IA0Ba,e,WAAA,e;;;AAEX;AACA,2BAAY,OAAZ,EAAqB;AAAA;;AAGnB;AAHmB,kIACb,OADa;;AAInB,UAAK,SAAL,GAAiB,IAAjB;;AAEA;AACA,UAAK,gBAAL,GAAwB,IAAxB;;AAEA;AACA,UAAK,iBAAL,GAAyB,CAAzB;;AAEA;AACA,UAAK,cAAL,GAAsB,kBAAK,EAAL,CAAtB;;AAEA;AACA,UAAK,UAAL,GAAkB,EAAlB;;AAEA;AACA,UAAK,uBAAL,GAA+B,CAAC,QAAhC;;AAEA;AACA,UAAK,UAAL,GAAkB,CAAlB;;AAEA;AACA,UAAK,eAAL,GAAuB,CAAvB;;AAEA;AACA,UAAK,iBAAL,GAAyB,IAAzB;;AAEA;AACA,UAAK,kBAAL,GAA0B,KAA1B;;AAEA;AACA,UAAK,OAAL,GAAe,EAAf;;AAEA;AACA,UAAK,cAAL,GAAsB,EAAtB;;AAEA;AACA,UAAK,UAAL,GAAkB,EAAlB;;AAEA;AACA,UAAK,cAAL,GAAsB,IAAtB;;AAEA;;;;;AAKA,UAAK,aAAL,GAAqB,IAArB;AAlDmB;AAmDpB;;AAED;;;;;oCACgB;AAAA;;AACd,aAAO,mBAAS,0BAAT,CAAoC,KAAK,GAAzC,EAA8C,IAA9C,CAAmD,wBAAgB;AACxE,wBAAM,MAAN,CAAa,YAAb,EAA2B,yCAA3B;AACA,eAAK,aAAL,GAAqB,YAArB;;AAEA,YAAI,CAAC,OAAK,8BAAL,EAAL,EAA4C;AAC1C;AACD;;AAED,YAAM,kBAAkB,OAAK,OAAL,CAAa,aAArC;AACA,yBAAO,MAAP,CAAc,gBAAgB,OAAhB,KAA4B,WAA1C,QACQ,GADR;;AAGA,YAAM,SAAS,OAAK,SAAL,EAAf;AACA,YAAM,mBAAmB,mBAAS,aAAT,CAAuB,OAAK,GAA5B,CAAzB;AACA,0BAAiB,MAAM,sBAAvB,CACI,MADJ,EACY,MADZ;AAEA,0BAAiB,MAAM,sBAAvB,CACI,MADJ,EACY,YADZ;;AAGA,eAAO,gBAAgB,OAAhB,GAA0B,IAA1B,CAA+B,gBAAQ;AAC5C,iBAAK,SAAL,GAAiB,IAAjB;AACA,iBAAK,gBAAL,GAAwB,OAAK,SAAL,CAAe,kBAAf,EAAxB;AACA,iBAAK,gBAAL,CAAsB,OAAtB,CAA8B,OAAK,kBAAL,CAAwB,IAAxB,CAA6B,MAA7B,CAA9B;AACD,SAJM,CAAP;AAKD,OAxBM,CAAP;AAyBD;;AAGD;;;;wCACoB;AAClB,aAAO,IAAP;AACD;;AAGD;;;;qCACiB;AAAA;;AACf,UAAI,CAAC,KAAK,8BAAL,EAAL,EAA4C;AAC1C,eAAO,QAAQ,OAAR,EAAP;AACD;;AAED,aAAO,KAAK,SAAL,CAAe,OAAf,GAAyB,UAAzB,CAAoC,6BAAc,QAAlD,EACF,IADE,CACG,YAAM;AACV,eAAK,gBAAL;AACA,eAAK,WAAL;AACA,eAAK,aAAL;AACD,OALE,CAAP;AAMD;;AAGD;;;;;;;;;qDAMiC;AAC/B,aAAO,CAAC,CAAC,KAAK,aAAL,CAAmB,GAAnB,CAAuB,oCAAc,uBAArC,CAAT;AACD;;AAGD;;;;;;;kCAIc;AACZ,UAAM,QAAQ,KAAK,OAAL,CAAa,QAAb,CAAsB,CAAtB,CAAd;AACA,uBAAO,MAAP,CACI,0BAAgB,KAAhB,CADJ,EAEI,UAAQ,GAAR,wBACA,uDAHJ;;AAKA,WAAK,OAAL,GAAe,qBAAU,MAAM,WAAhB,CAAf;AACA,WAAK,eAAL;AACD;;AAGD;;;;;;;uCAImB;AACjB,UAAM,YAAY,KAAK,GAAL,CAAS,QAAT,CAAkB,aAAlB,CAAgC,OAAhC,CAAlB;AACA,gBAAU,SAAV,GAAsB,gCAAtB;;AAEA,UAAM,OAAO,KAAK,GAAL,CAAS,QAAT,CAAkB,aAAlB,CAAgC,GAAhC,CAAb;AACA,WAAK,SAAL,GAAiB,gCAAjB;AACA,WAAK,WAAL,GAAmB,IAAnB;;AAEA,gBAAU,WAAV,CAAsB,IAAtB;AACA,WAAK,SAAL,CAAe,OAAf,CAAuB,WAAvB,CAAmC,SAAnC;AACD;;AAGD;;;;;;;sCAIkB;AAChB,UAAM,eAAe,KAAK,OAAL,CAAa,eAAb,CAArB;AACA,uBAAO,MAAP,CAAc,YAAd,EAA4B,MAAI,GAAJ,gCAC1B,mDADF;;AAFgB,UAKT,IALS,GAKD,YALC,CAKT,IALS;;AAMhB,uBAAO,MAAP,CAAc,IAAd,EAAoB,MAAI,GAAJ,gCAClB,sCADF;AAED;;AAGD;;;;;;;oCAIgB;AAAA;;AACd,UAAM,OAAO,KAAK,aAAL,EAAb;AACA,WAAK,UAAL,CAAgB,IAAhB,CAAqB,IAArB;;AAEA,WAAK,SAAL,CAAe,OAAf,CAAuB,WAAvB,CAAmC,IAAnC;AACA,WAAK,4BAAL,CAAkC,OAAO,YAAzC,sBACM,KAAK,YADX,EAC0B,KAAK,GAAL,EAD1B;;AAGA,WAAK,OAAL,GAAe,IAAf,CAAoB,gBAAQ;AAC1B,eAAK,SAAL,CAAe,OAAf,CAAuB,IAAvB;AACA,eAAK,uBAAL,GAA+B,KAAK,GAAL,EAA/B;AACD,OAHD;AAID;;AAGD;;;;;;;oCAIgB;AAAA;;AACd,UAAM,iBAAiB,KAAK,kBAAL,EAAvB;AACA,UAAM,QAAQ,KAAK,gBAAL,EAAd;;AAEA,UAAM,YAAY,KAAK,GAAL,CAAS,QAAT,CAAkB,aAAlB,CAAgC,KAAhC,CAAlB;AACA,gBAAU,SAAV,CAAoB,GAApB,CAAwB,gBAAxB;;AAEA,UAAM,YAAY,KAAK,GAAL,CAAS,QAAT,CAAkB,aAAlB,CAAgC,sBAAhC,CAAlB;AACA,gBAAU,YAAV,CAAuB,UAAvB,EAAmC,MAAnC;;AAEA,UAAM,gBAAgB,UAAU,SAAV,CAAoB,KAApB,CAAtB;;AAEA,gBAAU,WAAV,CAAsB,KAAtB;AACA,oBAAc,WAAd,CAA0B,SAA1B;AACA,qBAAe,WAAf,CAA2B,SAA3B;AACA,qBAAe,WAAf,CAA2B,aAA3B;;AAEA,WAAK,iBAAL,GAAyB,KAAzB;AACA,WAAK,kBAAL,GAA0B,KAA1B;;AAEA;AACA,YAAM,OAAN,GAAgB,IAAhB,CAAqB,gBAAQ;AAC3B,YAAM,UAAU,KAAK,OAAL,EAAhB;AACA,eAAO,QAAQ,UAAR,CAAmB,6BAAc,QAAjC,CAAP;AACD,OAHD,EAGG,IAHH,CAGQ,YAAM;AACZ;AACA;AACA;AACA,uBAAe,OAAf,GAAyB,IAAzB,CAA8B;AAAA,iBAAQ,KAAK,qBAAL,EAAR;AAAA,SAA9B;;AAEA;AACA;AACA,YAAM,gBAAgB,OAAK,UAAL,CAAgB,OAAK,UAAL,CAAgB,MAAhB,GAAyB,CAAzC,CAAtB;AACA,sBAAc,eAAd,CAA8B,YAA9B;;AAEA,eAAK,4BAAL,CAAkC,OAAO,SAAzC,sBACM,KAAK,SADX,EACuB,KAAK,GAAL,EADvB;AAEA,eAAK,kBAAL,GAA0B,IAA1B;AACD,OAjBD;;AAmBA,aAAO,cAAP;AACD;;AAGD;;;;;;;yCAIqB;AAAA;;AACnB,UAAM,KAAK,EAAE,KAAK,eAAlB;AACA,UAAM,gCAA8B,EAApC;;AAEA;AACA;AACA,WAAK,UAAL,CAAgB,MAAhB,IAA0B,EAA1B;;AAEA;AACA,WAAK,cAAL,CAAoB,EAApB,kEACG,KAAK,QADR,EACmB,EADnB,uCAEG,KAAK,YAFR,EAEuB,wBAAY,KAAK,GAAjB,CAFvB;;AAKA,UAAM,aAAa,kBAAK;AACtB,cAAM,MADgB;AAEtB,cAAM,EAFgB;AAGtB,oBAAY,GAHU;AAItB,6BAAqB;AAJC,OAAL,CAAnB;;AAOA,aAAO,sCACH,KAAK,GAAL,CAAS,QADN,EACgB,gBADhB,EACkC,UADlC,CAAP;AAED;;AAGD;;;;;;;uCAImB;AACjB,UAAM,gBAAgB;AACpB,iBAAS,oBADW;AAEpB,kBAAU,MAFU;AAGpB,qBAAa;AAHO,OAAtB;;AAMA,UAAM,cAAc,KAAK,OAAL,CAAa,eAAb,CAApB;;AAEA,OAAC,QAAD,EAAW,OAAX,EAAoB,QAApB,EAA8B,OAA9B,CAAsC,gBAAQ;AAC5C,YAAI,YAAY,IAAZ,MAAsB,SAA1B,EAAqC;AACnC,2BAAO,IAAP,CAAY,GAAZ,qBAAkC,IAAlC;AACA,iBAAO,YAAY,IAAZ,CAAP;AACD;AACF,OALD;;AAOA,uBAAO,MAAP,CAAc,CAAC,CAAC,iBAAiB,YAAY,IAA7B,CAAhB,EAAuD,GAAH,iBAC9C,YAAY,IADkC,gCAApD;;AAGA,UAAM,aAAa,0BAA4B,OAAO,MAAP,CAAc,EAAd,EAC3C,WAD2C,EAC9B,aAD8B,CAA/C;;AAGA,aAAO,sCACH,KAAK,GAAL,CAAS,QADN,EACgB,QADhB,EAC0B,UAD1B,CAAP;AAED;;AAGD;;;;;;;yCAIqB,a,EAAe;AAClC;AACA,UAAM,SAAS,KAAK,iBAAL,CAAuB,YAAvB,CAAoC,UAAU,OAA9C,CAAf;AACA,UAAM,UAAU,KAAK,iBAAL,CAAuB,YAAvB,CAAoC,UAAU,QAA9C,CAAhB;;AAEA,UAAI,CAAC,MAAD,IAAW,CAAC,OAAhB,EAAyB;AACvB,yBAAO,KAAP,CAAa,GAAb,EAAkB,6BACd,sCADJ;AAEA,eAAO,KAAP;AACD;;AAED;AACA,WAAK,cAAL,CAAoB,KAAK,eAAzB,EAA0C,KAAK,QAA/C,IAA2D,OAA3D;;AAEA,UAAM,UAAU,UAAU,OAAV,CAAhB;AACA,UAAI,CAAC,OAAL,EAAc;AACZ,yBAAO,KAAP,CAAa,GAAb,EAAkB,mCAAlB;AACA,eAAO,KAAP;AACD;;AAED,aAAO,KAAK,eAAL,CAAqB,aAArB,EAAoC,OAApC,EAA6C,MAA7C,CAAP;AACD;;AAGD;;;;;;;;;;oCAOgB,a,EAAe,O,EAAS,M,EAAQ;AAAA;;AAC9C,UAAM,IAAI,KAAK,GAAL,CAAS,QAAT,CAAkB,aAAlB,CAAgC,GAAhC,CAAV;AACA,QAAE,SAAF,GAAc,yBAAd;AACA,QAAE,YAAF,CAAe,QAAf,EAAyB,QAAzB;AACA,4BAAU,CAAV,EAAa;AACX,qBAAa,GADF;AAEX,iBAAS,GAFE;AAGX,mBAAW;AAHA,OAAb;AAKA,QAAE,IAAF,GAAS,MAAT;AACA,QAAE,WAAF,GAAgB,OAAhB;;AAEA,UAAI,EAAE,QAAF,KAAe,QAAf,IAA2B,EAAE,QAAF,KAAe,OAA9C,EAAuD;AACrD,yBAAO,IAAP,CAAY,GAAZ,EAAiB,wCAAjB;AACA,eAAO,KAAP;AACD;;AAED;AACA;AACA,UAAM,UAAU,KAAK,eAArB;AACA,QAAE,gBAAF,CAAmB,OAAnB,EAA4B,YAAM;AAAA;;AAChC,YAAM,2CACH,KAAK,QADF,EACa,OADb,0BAEH,KAAK,UAFF,EAEe,KAAK,GAAL,EAFf,SAAN;AAIA,eAAK,eAAL,CAAqB,OAAO,UAA5B,EAAwC,IAAxC;AACD,OAND;;AAQA,UAAM,WAAW,KAAK,GAAL,CAAS,QAAT,CAAkB,aAAlB,CAAgC,qBAAhC,CAAjB;AACA,eAAS,WAAT,CAAqB,CAArB;AACA,oBAAc,WAAd,CAA0B,QAA1B;AACA,aAAO,IAAP;AACD;;AAGD;;;;;;;uCAImB,gB,EAAkB;AACnC,cAAQ,iBAAiB,IAAzB;AACE,aAAK,iCAAgB,WAArB;AAAA,sCAC8B,iBAAiB,KAD/C;AAAA,cACS,SADT,yBACS,SADT;AAAA,cACoB,MADpB,yBACoB,MADpB;;AAEE,eAAK,uBAAL,CACI,gBAAM,YAAN,CAAmB,SAAnB,CADJ,EAEI,gBAAM,YAAN,CAAmB,MAAnB,CAFJ;AAGA;AANJ;AAQD;;AAGD;;;;;;;;4CAKwB,S,EAAW,M,EAAQ;AACzC,UAAI,KAAK,cAAT,EAAyB;AAAA;;AACvB;AACA,aAAK,eAAL,CAAqB,OAAO,SAA5B,4DACG,KAAK,SADR,EACoB,KAAK,GAAL,EADpB,qCAEG,KAAK,QAFR,EAEmB,KAAK,cAFxB;AAIA,aAAK,cAAL,GAAsB,IAAtB;AACD;;AAED,UAAI,KAAK,UAAL,CAAgB,MAAhB,CAAJ,EAA6B;AAAA;;AAC3B;AACA;AACA,YAAM,UAAU,KAAK,UAAL,CAAgB,MAAhB,CAAhB;AACA,aAAK,eAAL,CAAqB,OAAO,SAA5B,8DACG,KAAK,SADR,EACoB,KAAK,GAAL,EADpB,sCAEG,KAAK,QAFR,EAEmB,OAFnB;;AAKA;AACA;AACA,aAAK,cAAL,GAAsB,OAAtB;AACD;;AAED,UAAI,CAAC,oBAAO,KAAK,cAAZ,EAA4B,MAA5B,CAAL,EAA0C;AACxC,aAAK,iBAAL;AACA,aAAK,cAAL,CAAoB,MAApB,IAA8B,IAA9B;AACD;;AAED,UAAI,KAAK,iBAAL,GAAyB,YAA7B,EAA2C;AACzC,YAAM,UAAU,KAAK,sBAAL,CAA4B,MAA5B,CAAhB;;AAEA,YAAI,YAAY,SAAS,QAAzB,EAAmC;AACjC,eAAK,4BAAL,CAAkC,OAAO,WAAzC,sBACM,KAAK,WADX,EACyB,KAAK,GAAL,EADzB;AAEA,eAAK,UAAL;AACA;AACA,eAAK,cAAL;AACD;;AAED,YAAI,YAAY,SAAS,MAAzB,EAAiC;AAC/B,eAAK,4BAAL,CAAkC,OAAO,YAAzC,sBACM,KAAK,YADX,EAC0B,KAAK,GAAL,EAD1B;AAEA,eAAK,cAAL;AACD;AACF;AACF;;AAGD;;;;;;;qCAIiB;AACf,WAAK,iBAAL,GAAyB,CAAzB;AACA,WAAK,aAAL;AACD;;AAGD;;;;;;;;2CAKuB,c,EAAgB;AACrC,UAAM,eAAe,KAAK,UAAL,CAAgB,KAAK,UAAL,CAAgB,MAAhB,GAAyB,CAAzC,CAArB;AACA,UAAI,CAAC,KAAK,kBAAN,IAA4B,KAAK,WAAL,EAAhC,EAAoD;AAClD;AACA,eAAO,SAAS,MAAhB;AACD;;AAED,UAAI,eAAe,KAAK,SAAL,CAAe,WAAf,CAA2B,cAA3B,CAAnB;AACA,UAAI,cAAc,KAAK,SAAL,CAAe,WAAf,CAA2B,YAA3B,CAAlB;;AAEA,UAAI,CAAC,WAAL,EAAkB;AAChB,eAAO,SAAS,OAAhB;AACD;;AAED,UAAI,KAAK,cAAL,EAAJ,EAA2B;AACzB;AACA;AACA,uBAAe,WAAf;AACA,yBAAiB,YAAY,OAAZ,CAAoB,EAArC;AACA,sBAAc,KAAK,SAAL,CAAe,WAAf,CAA2B,WAA3B,CAAd;AACD;;AAED,UAAI,CAAC,WAAL,EAAkB;AAChB,eAAO,SAAS,OAAhB;AACD;;AAED,UAAI,CAAC,KAAK,kBAAN,IAA4B,aAAa,IAAb,EAA5B,IACA,YAAY,IAAZ,EADJ,EACwB;AACtB;AACA;AACA,eAAO,SAAS,OAAhB;AACD;;AAED,UAAM,aAAa,KAAK,oBAAL,CAA0B,YAA1B,CAAnB;AACA,UAAI,CAAC,UAAL,EAAiB;AACf;AACA,eAAO,SAAS,MAAhB;AACD;;AAED,WAAK,SAAL,CAAe,UAAf,CAA0B,cAA1B,EAA0C,aAAa,EAAvD;;AAEA;AACA;AACA,UAAM,UAAU,KAAK,UAAL,CAAgB,aAAa,EAA7B,CAAhB;AACA,UAAM,aAAa,KAAK,SAAL,CAAe,gBAAf,CAAgC,cAAhC,CAAnB;AACA,WAAK,cAAL,CAAoB,OAApB,EAA6B,KAAK,QAAlC,IAA8C,aAAa,CAA3D;;AAEA,aAAO,SAAS,QAAhB;AACD;;AAGD;;;;;;;qCAIiB;AACf,aAAO,CAAC,CAAC,KAAK,aAAL,CAAmB,GAAnB,CAAuB,oCAAc,aAArC,CAAT;AACD;;AAGD;;;;;;;kCAIc;AACZ,aAAQ,KAAK,GAAL,KAAa,KAAK,uBAAnB,GAA8C,aAArD;AACD;;AAGD;;;;;;;;;iDAM6B,S,EAAW,I,EAAM;AAC5C,aAAO,MAAP,CAAc,IAAd,sBAAsB,KAAK,QAA3B,EAAsC,KAAK,eAA3C;AACA,WAAK,eAAL,CAAqB,SAArB,EAAgC,IAAhC;AACD;;AAGD;;;;;;;;;oCAMgB,S,EAAW,I,EAAM;AAC/B,UAAM,UAAU,KAAK,SAAL,CAAhB;AACA,WAAK,cAAL,CAAoB,OAApB,IAA+B,OAAO,MAAP,CAAc,KAAK,cAAL,CAAoB,OAApB,CAAd,EAC3B,IAD2B,CAA/B;;AAGA,4CAAsB,KAAK,OAA3B,EAAoC,SAApC,EACI,KAAK,cAAL,CAAoB,OAApB,CADJ;AAED;;;;EA/hBkC,IAAI,W;;AAkiBzC,IAAI,SAAJ,CAAc,oBAAd,EAAoC,KAApC,EAA2C,eAAO;AAChD,MAAI,eAAJ,CAAoB,oBAApB,EAA0C,eAA1C;AACD,CAFD;;;;;;QC7nBgB,W,GAAA,W;;AAXhB;;AAGA;;;;;;;;AAQO,SAAS,WAAT,CAAqB,GAArB,EAA0B;AAC/B;AACA,MAAM,aAAa,sCAA0B,GAA1B,EAA+B,EAA/B,CAAnB,CAF+B,CAEwB;AACvD,MAAI,UAAJ,EAAgB;AACd,WAAO,WAAW,IAAX,CAAgB,EAAhB,CAAP;AACD;;AAED;AACA,SAAO,OAAO,IAAI,QAAJ,CAAa,IAAb,GAAoB,KAAK,GAAL,EAApB,GACV,IAAI,IAAJ,CAAS,MAAT,EADU,GACU,IAAI,MAAJ,CAAW,KADrB,GAC6B,IAAI,MAAJ,CAAW,MAD/C,CAAP;AAED,C,CArCD;;;;;;;;;;;;;;;;;;;;;;;;ACgBA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;kNArBA;;;;;;;;;;;;;;;;AAwBA;AACA,IAAM,MAAM,WAAZ;;AAGA;;;;;;;AAOO,IAAM,4CAAkB,SAAlB,eAAkB,MAAO;AACpC,MAAI,UAAU,mBAAS,iBAAT,CAA2B,GAA3B,CAAd;;AAEA,MAAI,CAAC,OAAL,EAAc;AACZ,cAAU,IAAI,oBAAJ,CAAyB,GAAzB,CAAV;AACA,yCAAuB,GAAvB,EAA4B,aAA5B,EAA2C;AAAA,aAAM,OAAN;AAAA,KAA3C;AACD;;AAED,SAAO,OAAP;AACD,CATM;;AAYP;;;;AAIO,IAAM,0BAAS;AACpB,UAAQ,CADY;AAEpB,WAAS,CAFW;AAGpB,UAAQ;AAHY,CAAf;;AAOP;;;;;;;;;;;;;;;;;;;;;;;;;AAyBO,IAAI,8BAAJ;;AAGP;AACO,IAAM,wCAAgB;AAC3B;AACA,2BAAyB,sBAFE;AAG3B,oBAAkB,gBAHS;AAI3B,oCAAkC,8BAJP;AAK3B,+BAA6B,yBALF;AAM3B,wBAAsB,mBANK;AAO3B,iCAA+B,2BAPJ;;AAS3B;AACA,gBAAc,aAVa,EAUE;AAC7B,YAAU,SAXiB;AAY3B,iBAAe,cAZY;AAa3B,iBAAe,cAbY;AAc3B,mBAAiB,eAdU;AAe3B,qBAAmB,iBAfQ;AAgB3B,mBAAiB,gBAhBU;AAiB3B,eAAa,YAjBc;AAkB3B,gBAAc,aAlBa;AAmB3B,aAAW,UAnBgB;AAoB3B,oBAAkB,gBApBS;AAqB3B,2BAAyB,uBArBE;AAsB3B,YAAU,SAtBiB;;AAwB3B;AACA,cAAY,WAzBe;AA0B3B,mBAAiB,eA1BU;AA2B3B,sBAAoB;AA3BO,CAAtB;;AA+BP;AACO,IAAM,0BAAS;AACpB,eAAa,kBADO;AAEpB,kBAAgB,cAFI;AAGpB,iBAAe,cAHK;AAIpB,aAAW,UAJS;AAKpB,kBAAgB,eALI;AAMpB,sBAAoB,kBANA;AAOpB,oBAAkB,gBAPE;AAQpB,oBAAkB,iBARE;AASpB,gBAAc,aATM;AAUpB,iBAAe,cAVK;AAWpB,cAAY,WAXQ;AAYpB,qBAAmB,iBAZC;AAapB,4BAA0B,wBAbN;AAcpB,aAAW;AAdS,CAAf;;AAkBP;;;;;;;AAOA,IAAM,UAAU,SAAV,OAAU,CAAC,KAAD,EAAQ,MAAR,EAAgB,IAAhB,EAAyB;AAAA;;AACvC,UAAQ,MAAR;AACE;AACA,SAAK,OAAO,aAAZ;AACE,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,wDAEvB,cAAc,YAFS,EAEM,CAAC,CAAC,IAFR,mCAGvB,cAAc,YAHS,EAGM,CAAC,CAAC,IAHR;AAA9B;AAKF;AACA,SAAK,OAAO,SAAZ;AACE,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,sBACb,cAAc,QADD,EACY,CAAC,CAAC,IADd;AAA9B;AAEF;AACA,SAAK,OAAO,cAAZ;AACE,UAAI,CAAC,MAAM,cAAc,gBAApB,CAAL,EAA4C;AAC1C,eAAO,KAAP;AACD;AACD,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,sBACb,cAAc,aADD,EACiB,CAAC,CAAC,IADnB;AAA9B;AAEF;AACA,SAAK,OAAO,kBAAZ;AACE,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,0DAEvB,cAAc,iBAFS,EAEW,CAAC,CAAC,IAFb,oCAGvB,cAAc,YAHS,EAGM,CAAC,CAAC,IAHR;AAA9B;AAKF;AACA,SAAK,OAAO,gBAAZ;AACE,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,sBACb,cAAc,eADD,EACmB,CAAC,CAAC,IADrB;AAA9B;AAEF,SAAK,OAAO,gBAAZ;AACE,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,sBACb,cAAc,eADD,EACmB,CAAC,CAAC,IADrB;AAA9B;AAEF;AACA,SAAK,OAAO,YAAZ;AACE,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,sBACb,cAAc,WADD,EACe,CAAC,CAAC,IADjB;AAA9B;AAEF,SAAK,OAAO,aAAZ;AACE,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,sBACb,cAAc,YADD,EACgB,CAAC,CAAC,IADlB;AAA9B;AAEF,SAAK,OAAO,UAAZ;AACE,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,sBACb,cAAc,SADD,EACa,CAAC,CAAC,IADf;AAA9B;AAEF,SAAK,OAAO,wBAAZ;AACE,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,sBACb,cAAc,uBADD,EAC2B,CAAC,CAAC,IAD7B;AAA9B;AAEF,SAAK,OAAO,iBAAZ;AACE,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,4DAEvB,cAAc,YAFS,EAEM,CAAC,CAAC,IAFR,qCAGvB,cAAc,gBAHS,EAGU,CAAC,CAAC,IAHZ;AAA9B;AAKF,SAAK,OAAO,SAAZ;AACE,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,4DAGvB,cAAc,aAHS,EAGO,SAAS,OAAO,OAHvB,qCAIvB,cAAc,QAJS,EAIE,IAJF;AAA9B;AAMF,SAAK,OAAO,cAAZ;AACE,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,sBACb,cAAc,UADD,EACc,IADd;AAA9B;AAEF,SAAK,OAAO,WAAZ;AACE,aAAO,sBAAuB,OAAO,MAAP,CAC1B,EAD0B,EACtB,KADsB,4DAEvB,cAAc,eAFS,EAES,KAAK,EAFd,qCAGvB,cAAc,kBAHS,EAGY,KAAK,KAHjB;AAA9B;AAKF;AACE,sBAAM,KAAN,CAAY,GAAZ,sBAAmC,MAAnC;AACA,aAAO,KAAP;AAtEJ;AAwED,CAzED;;AA4EA;;;;IAGa,oB,WAAA,oB;AACX;;;AAGA,gCAAY,GAAZ,EAAiB;AAAA;;AACf;AACA,SAAK,IAAL,GAAY,GAAZ;;AAEA;AACA,SAAK,UAAL,GAAkB,EAAlB;;AAEA;AACA,SAAK,MAAL,GAAc,qBAAuB,OAAO,MAAP,CACjC,EADiC,EAC7B,KAAK,gBAAL,EAD6B,EACJ,KAAK,kBAAL,EADI,CAArC;AAED;;AAED;;;;;;;;;wBAKI,G,EAAK;AACP,UAAI,CAAC,oBAAO,KAAK,MAAZ,EAAoB,GAApB,CAAL,EAA+B;AAC7B,wBAAM,KAAN,CAAY,GAAZ,qBAAkC,GAAlC;AACA;AACD;AACD,aAAO,KAAK,MAAL,CAAY,GAAZ,CAAP;AACD;;AAED;;;;;;;;;;8BAOU,G,EAAK,Q,EAAoC;AAAA,UAA1B,gBAA0B,uEAAP,KAAO;;AACjD,UAAI,CAAC,oBAAO,KAAK,MAAZ,EAAoB,GAApB,CAAL,EAA+B;AAC7B,wBAAM,KAAN,CAAY,GAAZ,yCAAqD,GAArD;AACA;AACD;AACD,UAAI,CAAC,KAAK,UAAL,CAAgB,GAAhB,CAAL,EAA2B;AACzB,aAAK,UAAL,CAAgB,GAAhB,IAAuB,4BAAvB;AACD;AACD,WAAK,UAAL,CAAgB,GAAhB,EAAqB,GAArB,CAAyB,QAAzB;;AAEA,UAAI,gBAAJ,EAAsB;AACpB,iBAAS,KAAK,GAAL,CAAS,GAAT,CAAT;AACD;AACF;;AAED;;;;;;;;;6BAMS,M,EAAQ,I,EAAM;AAAA;;AACrB,UAAM,WAAW,OAAO,MAAP,CAAc,EAAd,EAAkB,KAAK,MAAvB,CAAjB;AACA,WAAK,MAAL,GAAc,QAAQ,KAAK,MAAb,EAAqB,MAArB,EAA6B,IAA7B,CAAd;;AAEA,aAAO,IAAP,CAAY,KAAK,UAAjB,EAA6B,OAA7B,CAAqC,eAAO;AAC1C,YAAI,SAAS,GAAT,MAAkB,MAAK,MAAL,CAAY,GAAZ,CAAtB,EAAwC;AACtC,gBAAK,UAAL,CAAgB,GAAhB,EAAqB,IAArB,CAA0B,MAAK,MAAL,CAAY,GAAZ,CAA1B;AACD;AACF,OAJD;AAKD;;AAED;;;;;;;;uCAKmB;AAAA;;AACjB;AACA;AACA,8CACG,cAAc,uBADjB,EAC2C,IAD3C,yBAEG,cAAc,gBAFjB,EAEoC,IAFpC,yBAGG,cAAc,gCAHjB,EAGoD,IAHpD,yBAIG,cAAc,2BAJjB,EAI+C,IAJ/C,yBAKG,cAAc,oBALjB,EAKwC,IALxC,yBAMG,cAAc,6BANjB,EAMiD,IANjD,yBAOG,cAAc,YAPjB,EAOgC,KAPhC,yBAQG,cAAc,QARjB,EAQ4B,KAR5B,yBASG,cAAc,aATjB,EASiC,KATjC,yBAUG,cAAc,aAVjB,EAUiC,KAVjC,yBAWG,cAAc,iBAXjB,EAWqC,KAXrC,yBAYG,cAAc,eAZjB,EAYmC,KAZnC,yBAaG,cAAc,eAbjB,EAamC,KAbnC,yBAcG,cAAc,WAdjB,EAc+B,IAd/B,yBAeG,cAAc,YAfjB,EAegC,KAfhC,yBAgBG,cAAc,SAhBjB,EAgB6B,KAhB7B,yBAiBG,cAAc,gBAjBjB,EAiBoC,KAjBpC,yBAkBG,cAAc,uBAlBjB,EAkB2C,IAlB3C,yBAmBG,cAAc,QAnBjB,EAmB4B,OAAO,MAnBnC,yBAoBG,cAAc,UApBjB,EAoB8B,IApB9B,yBAqBG,cAAc,eArBjB,EAqBmC,EArBnC,yBAsBG,cAAc,kBAtBjB,EAsBsC,CAtBtC;AAwBD;;AAED;AACA;;;;;;;;yCAKqB;AAAA;;AACnB,UAAM,YAAY,+BAAe,KAAK,IAAL,CAAU,QAAV,CAAmB,IAAlC,CAAlB;AACA,cAAQ,SAAR;AACE,aAAK,qBAAU,QAAf;AACE,oDACG,cAAc,uBADjB,EAC2C,KAD3C,0BAEG,cAAc,gBAFjB,EAEoC,KAFpC,0BAGG,cAAc,gCAHjB,EAGoD,KAHpD,0BAIG,cAAc,2BAJjB,EAI+C,IAJ/C,0BAKG,cAAc,6BALjB,EAKiD,KALjD,0BAMG,cAAc,WANjB,EAM+B,KAN/B;AAQF,aAAK,qBAAU,UAAf;AACE,qCACG,cAAc,oBADjB,EACwC,KADxC;AAGF;AACE,iBAAO,EAAP;AAfJ;AAiBD;;;;;;;;;;;QC1Ra,c,GAAA,c;;AArDhB;;AACA;;AAGA;;;;AAnBA;;;;;;;;;;;;;;;AAuBO,IAAM,gCAAY;AACvB;;;AAGA,gBAAc,CAJS;;AAMvB;;;;;;;;;;AAUA,YAAU,CAhBa;;AAkBvB;;;;;;;;;;;AAWA,cAAY;AA7BW,CAAlB;;AAiCP;;;;AAIO,IAAM,0CAAiB,WAAvB;;AAGP;;;;;AAKO,SAAS,cAAT,CAAwB,GAAxB,EAA6B;AAClC,MAAM,SAAS,2BAAiB,GAAjB,CAAf;AACA,MAAM,uBAAuB,OAAO,cAAP,CAA7B;AACA,MAAM,iBAAiB,SAAS,oBAAT,EAA+B,EAA/B,CAAvB;;AAEA,SAAO,wBAAY,SAAZ,EAAuB,cAAvB,IACH,yBAA2B,cADxB,GAEH,UAAU,YAFd;AAGD;;;;;;;;qjBC5ED;;;;;;;;;;;;;;;;;AAeA;;AACA;;;;AAGA;;;;AAIO,IAAM,4CAAkB;AAC7B,eAAa,CADgB;AAE7B,iBAAe,CAFc;AAG7B,gBAAc,CAHe;AAI7B,OAAK;AAJwB,CAAxB;;AAQP;AACO,IAAI,0DAAJ;;AAGP;;;;IAGa,e,WAAA,e;AACX;;;;AAIA,2BAAY,GAAZ,EAAiB,UAAjB,EAA6B;AAAA;;AAC3B;AACA,SAAK,WAAL,GAAmB,UAAnB;;AAEA;AACA,SAAK,WAAL,GAAmB,4BAAnB;;AAEA;AACA,SAAK,IAAL,GAAY,GAAZ;;AAEA;AACA,SAAK,aAAL,GAAqB,2CAAgB,KAAK,IAArB,CAArB;;AAEA,SAAK,oBAAL;;AAIE;AACA,gBAAY,OAAO,SAAP,GAAmB,OAAO,SAAP,IAAoB,EAAnD;;AAEA;AACA,QAAI,UAAU,UAAd,EAA0B;AAAC;AAAQ;;AAEnC;AACA,QAAI,UAAU,OAAd,EAAuB;AACnB,UAAI,OAAO,OAAP,IAAkB,QAAQ,KAA9B,EAAqC;AACjC,gBAAQ,KAAR,CAAc,iCAAd;AACH;AACD;AACH;AACD;AACA;AACA,cAAU,OAAV,GAAoB,IAApB;;AAEA;AACA,cAAU,OAAV,GAAoB,CAChB,aADgB,EAEhB,YAFgB,EAGhB,WAHgB,EAIhB,WAJgB,EAKhB,UALgB,EAMhB,UANgB,EAOhB,OAPgB,EAQhB,OARgB,EAShB,OATgB,EAUhB,OAVgB,EAWhB,OAXgB,EAYhB,OAZgB,EAahB,MAbgB,EAchB,MAdgB,EAehB,KAfgB,EAgBhB,IAhBgB,CAApB;;AAmBA;AACA;AACA;AACA;AACA,cAAU,OAAV,GAAoB,UAAS,MAAT,EAAiB;AACjC,aAAO,YAAW;AACd,YAAM,OAAO,MAAM,SAAN,CAAgB,KAAhB,CAAsB,IAAtB,CAA2B,SAA3B,CAAb;AACA,aAAK,OAAL,CAAa,MAAb;AACA,kBAAU,IAAV,CAAe,IAAf;AACA,eAAO,SAAP;AACH,OALD;AAMH,KAPD;;AASA;AACA,SAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,UAAU,OAAV,CAAkB,MAAtC,EAA8C,GAA9C,EAAmD;AAC/C,UAAM,MAAM,UAAU,OAAV,CAAkB,CAAlB,CAAZ;AACA,gBAAU,GAAV,IAAiB,UAAU,OAAV,CAAkB,GAAlB,CAAjB;AACH;;AAED;AACA;AACA,cAAU,IAAV,GAAiB,UAAS,GAAT,EAAc,OAAd,EAAuB;AACpC;AACA,UAAM,SAAS,SAAS,aAAT,CAAuB,QAAvB,CAAf;AACA,aAAO,IAAP,GAAc,iBAAd;AACA,aAAO,KAAP,GAAe,IAAf;AACA,aAAO,GAAP,GAAa,6CACP,GADO,GACD,mBADZ;;AAGA;AACA,UAAM,QAAQ,SAAS,oBAAT,CAA8B,QAA9B,EAAwC,CAAxC,CAAd;AACA,YAAM,UAAN,CAAiB,YAAjB,CAA8B,MAA9B,EAAsC,KAAtC;AACA,gBAAU,YAAV,GAAyB,OAAzB;AACH,KAZD;;AAcA;AACA,cAAU,eAAV,GAA4B,OAA5B;;AAGA;AACA;AACA,cAAU,IAAV,CAAe,kCAAf;;AAEA;AACA;AACA;;AAKH;;AAED;;;;;;;2CAGuB;AAAA;;AACrB,WAAK,aAAL,CAAmB,SAAnB,CAA6B,oCAAc,aAA3C,EAA0D,oBAAY;AACpE,YAAI,QAAJ,EAAc;AACZ,oBAAU,KAAV,CAAgB,eAAhB;AACA,gBAAK,KAAL,CAAW,gBAAgB,aAA3B;AACA,gBAAK,KAAL,CAAW,gBAAgB,GAA3B;AACD;;AAED,YAAI,CAAC,QAAL,EAAe;AACb,oBAAU,KAAV,CAAgB,cAAhB;AACA,gBAAK,KAAL,CAAW,gBAAgB,YAA3B;AACD;AACF,OAXD;AAYD;;AAED;;;;;;4BAGQ,a,EAAe;AACrB,WAAK,WAAL,CAAiB,GAAjB,CAAqB,aAArB;AACD;;AAED;;;;;;;;;;qCAOiB,S,EAAW,U,EAAY,M,EAAQ,W,EAAa;AAAA;;AAC3D,UAAM,cAAc;AAClB,4BADkB;AAElB,sBAFkB;AAGlB,8BAHkB;AAIlB,uBAAe,YAAY;AAJT,OAApB;AAMA,gBAAU,KAAV,CAAgB,aAAhB,EAA8B;AAC1B,cAAM,SADoB;AAE1B,uBAAe,YAAU;AAFC,OAA9B;AAIA,WAAK,KAAL,CAAW,gBAAgB,WAA3B,EAAwC,WAAxC;;AAEA,UAAI,WAAJ,EAAiB;AACf,aAAK,WAAL,GAAmB,IAAnB,CAAwB,sBAAc;AACpC,cAAI,CAAC,UAAL,EAAiB;AACjB,mBAAK,KAAL,CAAW,gBAAgB,GAA3B;AACC;AACF,SAJD;AAKD;AACF;;AAED;;;;;;;0BAIM,I,EAAM,e,EAAiB;AAC3B,WAAK,WAAL,CAAiB,IAAjB,CAAsB,EAAC,UAAD,EAAO,OAAO,eAAd,EAAtB;AACD;;;;;;;ACjNH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACn6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A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","file":"amp-story-auto-ads-0.1.max.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","export const CSS = \"[desktop] amp-story-page[i-amphtml-loading]{-webkit-transform:scale(1.0) translateX(-100%) translateY(200%)!important;transform:scale(1.0) translateX(-100%) translateY(200%)!important}.i-amphtml-story-ad-link{background-color:#fff!important;border-radius:20px!important;bottom:32px!important;box-shadow:0px 2px 12px rgba(0,0,0,0.16)!important;color:#4285f4!important;font-family:Roboto,sans-serif!important;font-weight:700!important;height:36px!important;left:50%!important;letter-spacing:0.2px!important;line-height:36px;margin-left:-60px!important;position:absolute!important;text-align:center;text-decoration:none!important;width:120px!important}amp-story-page[active] .i-amphtml-story-ad-link{-webkit-animation-delay:100ms!important;animation-delay:100ms!important;-webkit-animation-duration:300ms!important;animation-duration:300ms!important;-webkit-animation-timing-function:cubic-bezier(0.4,0.0,0.2,1)!important;animation-timing-function:cubic-bezier(0.4,0.0,0.2,1)!important;-webkit-animation-fill-mode:forwards!important;animation-fill-mode:forwards!important;-webkit-animation-name:ad-cta!important;animation-name:ad-cta!important}@-webkit-keyframes ad-cta{0%{opacity:0;font-size:0px;-webkit-transform:scale(0);transform:scale(0)}to{opacity:1;font-size:13px;-webkit-transform:scale(1);transform:scale(1)}}@keyframes ad-cta{0%{opacity:0;font-size:0px;-webkit-transform:scale(0);transform:scale(0)}to{opacity:1;font-size:13px;-webkit-transform:scale(1);transform:scale(1)}}.i-amphtml-ad-overlay-container{height:24px!important;left:0!important;padding:14px 0 0!important;position:absolute!important;top:0!important;z-index:100001!important}[dir=rtl] .i-amphtml-ad-overlay-container{left:auto!important;right:0!important}[desktop] .i-amphtml-ad-overlay-container{left:calc(50vw - 22.5vh)!important;top:12.5vh!important}[dir=rtl] [desktop] .i-amphtml-ad-overlay-container{left:auto!important;right:calc(50vw - 22.5vh)!important}.i-amphtml-story-ad-attribution{color:#fff!important;font-size:18px!important;font-family:Roboto,sans-serif!important;font-weight:700!important;letter-spacing:0.5px!important;margin:0 0 0 16px!important;opacity:0!important;padding:0!important;visibility:hidden!important}[dir=rtl] .i-amphtml-story-ad-attribution{margin-left:0px!important;margin-right:16px!important}amp-story[ad-showing][desktop] .i-amphtml-story-ad-attribution{-webkit-transition:opacity 0.1s linear 0.3s;transition:opacity 0.1s linear 0.3s}amp-story[ad-showing] .i-amphtml-story-ad-attribution{visibility:visible!important;opacity:1!important}.i-amphtml-glass-pane{height:100%!important;width:100%!important;z-index:1!important}\\n/*# sourceURL=/extensions/amp-story-auto-ads/0.1/amp-story-auto-ads.css*/\";\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CSS} from '../../../build/amp-story-auto-ads-0.1.css';\nimport {CommonSignals} from '../../../src/common-signals';\nimport {Services} from '../../../src/services';\nimport {StateChangeEventDef, StateChangeType} from '../../amp-story/1.0/navigation-state';\nimport {StateProperty} from '../../amp-story/1.0/amp-story-store-service';\nimport {createElementWithAttributes} from '../../../src/dom';\nimport {dev, user} from '../../../src/log';\nimport {dict, hasOwn, map} from '../../../src/utils/object';\nimport {getUniqueId} from './utils';\nimport {isJsonScriptTag} from '../../../src/dom';\nimport {parseJson} from '../../../src/json';\nimport {setStyles} from '../../../src/style';\nimport {triggerAnalyticsEvent} from '../../../src/analytics';\n\n/** @const */\nconst MIN_INTERVAL = 3;\n\n/** @const */\nconst TAG = 'amp-story-auto-ads';\n\n/** @const */\nconst AD_TAG = 'amp-ad';\n\n/** @const */\nconst MUSTACHE_TAG = 'amp-mustache';\n\n/** @const */\nconst TIMEOUT_LIMIT = 10000; // 10 seconds\n\n/** @const */\nconst GLASS_PANE_CLASS = 'i-amphtml-glass-pane';\n\n/** @const */\nconst LOADING_ATTR = 'i-amphtml-loading';\n\n/** @const */\nconst DATA_ATTR = {\n  CTA_TYPE: 'data-vars-ctatype',\n  CTA_URL: 'data-vars-ctaurl',\n};\n\n/** @const */\nconst CTA_TYPES = {\n  EXPLORE: 'Explore Now',\n  SHOP: 'Shop Now',\n  READ: 'Read Now',\n  INSTALL: 'Install Now',\n  LISTEN: 'Listen Now',\n  SUBSCRIBE: 'Subscribe Now',\n};\n\n/** @const */\nconst AD_STATE = {\n  PENDING: 0,\n  INSERTED: 1,\n  FAILED: 2,\n};\n\n/** @const */\nconst ALLOWED_AD_TYPES = map({\n  'custom': true,\n  'doubleclick': true,\n});\n\n/** @enum {string} */\nconst Events = {\n  AD_REQUESTED: 'story-ad-request',\n  AD_LOADED: 'story-ad-load',\n  AD_INSERTED: 'story-ad-insert',\n  AD_VIEWED: 'story-ad-view',\n  AD_CLICKED: 'story-ad-click',\n  AD_EXITED: 'story-ad-exit',\n  AD_DISCARDED: 'story-ad-discard',\n};\n\n/** @enum {string} */\nconst Vars = {\n  // Timestamp when ad is requested.\n  AD_REQUESTED: 'requestTime',\n  // Timestamp when ad emits `INI_LOAD` signal.\n  AD_LOADED: 'loadTime',\n  // Timestamp when ad is inserted into story as page after next.\n  AD_INSERTED: 'insertTime',\n  // Timestamp when page becomes active page.\n  AD_VIEWED: 'viewTime',\n  // Timestamp when ad is clicked.\n  AD_CLICKED: 'clickTime',\n  // Timestamp when ad page moves from active => inactive.\n  AD_EXITED: 'exitTime',\n  // Timestamp when ad is discared due to bad metadata etc.\n  AD_DISCARDED: 'discardTime',\n  // Index of the ad generating the trigger.\n  AD_INDEX: 'adIndex',\n  // Id that should be unique for every ad.\n  AD_UNIQUE_ID: 'adUniqueId',\n  // Position in the parent story. Number of page before ad + 1. Does not count\n  // previously inserted ad pages.\n  POSITION: 'position',\n  // Given cta-type of inserted ad.\n  CTA_TYPE: 'ctaType',\n};\n\nexport class AmpStoryAutoAds extends AMP.BaseElement {\n\n  /** @param {!AmpElement} element */\n  constructor(element) {\n    super(element);\n\n    /** @private {?../../amp-story/0.1/amp-story.AmpStory} */\n    this.ampStory_ = null;\n\n    /** @private {?../../amp-story/0.1/navigation-state.NavigationState} */\n    this.navigationState_ = null;\n\n    /** @private {number} */\n    this.uniquePagesCount_ = 0;\n\n    /** @private {!Object<string, boolean>} */\n    this.uniquePageIds_ = dict({});\n\n    /** @private {!Array<Element>} */\n    this.adPageEls_ = [];\n\n    /** @private {number} */\n    this.timeCurrentPageCreated_ = -Infinity;\n\n    /** @private {number} */\n    this.adsPlaced_ = 0;\n\n    /** @private {number} */\n    this.adPagesCreated_ = 0;\n\n    /** @private {?Element} */\n    this.currentAdElement_ = null;\n\n    /** @private {boolean} */\n    this.isCurrentAdLoaded_ = false;\n\n    /** @private {Object<string, string>} */\n    this.config_ = {};\n\n    /** @private {Object<string, *>} */\n    this.analyticsData_ = {};\n\n    /** @private {Object<string, number>} */\n    this.adPageIds_ = {};\n\n    /** @private {number|null} */\n    this.idOfAdShowing_ = null;\n\n    /**\n     * Version of the story store service depends on which version of amp-story\n     * the publisher is loading. They all have the same implementation.\n     * @private {?../../amp-story/0.1/amp-story-store-service.AmpStoryStoreService|?../../amp-story/1.0/amp-story-store-service.AmpStoryStoreService}\n     */\n    this.storeService_ = null;\n  }\n\n  /** @override */\n  buildCallback() {\n    return Services.storyStoreServiceForOrNull(this.win).then(storeService => {\n      dev().assert(storeService, 'Could not retrieve AmpStoryStoreService');\n      this.storeService_ = storeService;\n\n      if (!this.isAutomaticAdInsertionAllowed_()) {\n        return;\n      }\n\n      const ampStoryElement = this.element.parentElement;\n      user().assert(ampStoryElement.tagName === 'AMP-STORY',\n          `<${TAG}> should be child of <amp-story>`);\n\n      const ampdoc = this.getAmpDoc();\n      const extensionService = Services.extensionsFor(this.win);\n      extensionService./*OK*/installExtensionForDoc(\n          ampdoc, AD_TAG);\n      extensionService./*OK*/installExtensionForDoc(\n          ampdoc, MUSTACHE_TAG);\n\n      return ampStoryElement.getImpl().then(impl => {\n        this.ampStory_ = impl;\n        this.navigationState_ = this.ampStory_.getNavigationState();\n        this.navigationState_.observe(this.handleStateChange_.bind(this));\n      });\n    });\n  }\n\n\n  /** @override */\n  isLayoutSupported() {\n    return true;\n  }\n\n\n  /** @override */\n  layoutCallback() {\n    if (!this.isAutomaticAdInsertionAllowed_()) {\n      return Promise.resolve();\n    }\n\n    return this.ampStory_.signals().whenSignal(CommonSignals.INI_LOAD)\n        .then(() => {\n          this.createAdOverlay_();\n          this.readConfig_();\n          this.schedulePage_();\n        });\n  }\n\n\n  /**\n   * Determines whether or not ad insertion is allowed based on how the story\n   * is served.\n   * @return {boolean}\n   * @private\n   */\n  isAutomaticAdInsertionAllowed_() {\n    return !!this.storeService_.get(StateProperty.CAN_INSERT_AUTOMATIC_AD);\n  }\n\n\n  /**\n   * load in config from child <script> element\n   * @private\n   */\n  readConfig_() {\n    const child = this.element.children[0];\n    user().assert(\n        isJsonScriptTag(child),\n        `The <${TAG}> config should ` +\n        'be inside a <script> tag with type=\"application/json\"');\n\n    this.config_ = parseJson(child.textContent);\n    this.validateConfig_();\n  }\n\n\n  /**\n   * Create a hidden UI that will be shown when ad is displayed\n   * @private\n   */\n  createAdOverlay_() {\n    const container = this.win.document.createElement('aside');\n    container.className = 'i-amphtml-ad-overlay-container';\n\n    const span = this.win.document.createElement('p');\n    span.className = 'i-amphtml-story-ad-attribution';\n    span.textContent = 'Ad';\n\n    container.appendChild(span);\n    this.ampStory_.element.appendChild(container);\n  }\n\n\n  /**\n   * make sure given JSON config is shaped correctly\n   * @private\n   */\n  validateConfig_() {\n    const adAttributes = this.config_['ad-attributes'];\n    user().assert(adAttributes, `<${TAG}>: Error reading config.` +\n      'Top level JSON should have an \"ad-attributes\" key');\n\n    const {type} = adAttributes;\n    user().assert(type, `<${TAG}>: Error reading config.` +\n      'Missing [\"ad-attribues\"][\"type\"] key');\n  }\n\n\n  /**\n   * build page and start preloading\n   * @private\n   */\n  schedulePage_() {\n    const page = this.createAdPage_();\n    this.adPageEls_.push(page);\n\n    this.ampStory_.element.appendChild(page);\n    this.analyticsEventWithCurrentAd_(Events.AD_REQUESTED,\n        {[Vars.AD_REQUESTED]: Date.now()});\n\n    page.getImpl().then(impl => {\n      this.ampStory_.addPage(impl);\n      this.timeCurrentPageCreated_ = Date.now();\n    });\n  }\n\n\n  /**\n   * create an `amp-story-page` containing an `amp-ad`\n   * @private\n   */\n  createAdPage_() {\n    const ampStoryAdPage = this.createPageElement_();\n    const ampAd = this.createAdElement_();\n\n    const glassPane = this.win.document.createElement('div');\n    glassPane.classList.add(GLASS_PANE_CLASS);\n\n    const gridLayer = this.win.document.createElement('amp-story-grid-layer');\n    gridLayer.setAttribute('template', 'fill');\n\n    const paneGridLayer = gridLayer.cloneNode(false);\n\n    gridLayer.appendChild(ampAd);\n    paneGridLayer.appendChild(glassPane);\n    ampStoryAdPage.appendChild(gridLayer);\n    ampStoryAdPage.appendChild(paneGridLayer);\n\n    this.currentAdElement_ = ampAd;\n    this.isCurrentAdLoaded_ = false;\n\n    // set up listener for ad-loaded event\n    ampAd.getImpl().then(impl => {\n      const signals = impl.signals();\n      return signals.whenSignal(CommonSignals.INI_LOAD);\n    }).then(() => {\n      // Ensures the video-manager does not follow the autoplay attribute on\n      // amp-video tags, which would play the ad in the background before it is\n      // displayed.\n      ampStoryAdPage.getImpl().then(impl => impl.delegateVideoAutoplay());\n\n      // remove loading attribute once loaded so that desktop CSS will position\n      // offscren with all other pages\n      const currentPageEl = this.adPageEls_[this.adPageEls_.length - 1];\n      currentPageEl.removeAttribute(LOADING_ATTR);\n\n      this.analyticsEventWithCurrentAd_(Events.AD_LOADED,\n          {[Vars.AD_LOADED]: Date.now()});\n      this.isCurrentAdLoaded_ = true;\n    });\n\n    return ampStoryAdPage;\n  }\n\n\n  /**\n   * @return {!Element}\n   * @private\n   */\n  createPageElement_() {\n    const id = ++this.adPagesCreated_;\n    const pageId = `i-amphtml-ad-page-${id}`;\n\n    // Keep track of ids created so far and a mapping to their index. This\n    // is used to check if a page id is an ad later.\n    this.adPageIds_[pageId] = id;\n\n    // Also create a new object to keep track of any future analytics data.\n    this.analyticsData_[id] = {\n      [Vars.AD_INDEX]: id,\n      [Vars.AD_UNIQUE_ID]: getUniqueId(this.win),\n    };\n\n    const attributes = dict({\n      'id': pageId,\n      'ad': '',\n      'distance': '2',\n      'i-amphtml-loading': '',\n    });\n\n    return createElementWithAttributes(\n        this.win.document, 'amp-story-page', attributes);\n  }\n\n\n  /**\n   * @return {!Element}\n   * @private\n   */\n  createAdElement_() {\n    const requiredAttrs = {\n      'class': 'i-amphtml-story-ad',\n      'layout': 'fill',\n      'amp-story': '',\n    };\n\n    const configAttrs = this.config_['ad-attributes'];\n\n    ['height', 'width', 'layout'].forEach(attr => {\n      if (configAttrs[attr] !== undefined) {\n        user().warn(TAG, `ad-attribute \"${attr}\" is not allowed`);\n        delete configAttrs[attr];\n      }\n    });\n\n    user().assert(!!ALLOWED_AD_TYPES[configAttrs.type], `${TAG}: ` +\n      `\"${configAttrs.type}\" ad type is not supported`);\n\n    const attributes = /** @type {!JsonObject} */ (Object.assign({},\n        configAttrs, requiredAttrs));\n\n    return createElementWithAttributes(\n        this.win.document, 'amp-ad', attributes);\n  }\n\n\n  /**\n   * Validate ad-server response has requirements to build outlink\n   * @param {!Element} adPageElement\n   */\n  maybeCreateCtaLayer_(adPageElement) {\n    // if making a CTA layer we need a button name & outlink url\n    const ctaUrl = this.currentAdElement_.getAttribute(DATA_ATTR.CTA_URL);\n    const ctaType = this.currentAdElement_.getAttribute(DATA_ATTR.CTA_TYPE);\n\n    if (!ctaUrl || !ctaType) {\n      user().error(TAG, 'Both CTA Type & CTA Url ' +\n          'are required in ad-server response.\"');\n      return false;\n    }\n\n    // Store the cta-type as an accesible var for any further pings.\n    this.analyticsData_[this.adPagesCreated_][Vars.CTA_TYPE] = ctaType;\n\n    const ctaText = CTA_TYPES[ctaType];\n    if (!ctaType) {\n      user().error(TAG, 'invalid \"CTA Type\" in ad response');\n      return false;\n    }\n\n    return this.createCtaLayer_(adPageElement, ctaText, ctaUrl);\n  }\n\n\n  /**\n   * Create layer to contain outlink button\n   * @param {!Element} adPageElement\n   * @param {string} ctaText\n   * @param {string} ctaUrl\n   * @return {boolean}\n   */\n  createCtaLayer_(adPageElement, ctaText, ctaUrl) {\n    const a = this.win.document.createElement('a');\n    a.className = 'i-amphtml-story-ad-link';\n    a.setAttribute('target', '_blank');\n    setStyles(a, {\n      'font-size': '0',\n      opactiy: '0',\n      transform: 'scale(0)',\n    });\n    a.href = ctaUrl;\n    a.textContent = ctaText;\n\n    if (a.protocol !== 'https:' && a.protocol !== 'http:') {\n      user().warn(TAG, 'CTA url is not valid. Ad was discarded');\n      return false;\n    }\n\n    // Click listener so that we can fire `story-ad-click` analytics trigger at\n    // the appropriate time.\n    const adIndex = this.adPagesCreated_;\n    a.addEventListener('click', () => {\n      const vars = {\n        [Vars.AD_INDEX]: adIndex,\n        [Vars.AD_CLICKED]: Date.now(),\n      };\n      this.analyticsEvent_(Events.AD_CLICKED, vars);\n    });\n\n    const ctaLayer = this.win.document.createElement('amp-story-cta-layer');\n    ctaLayer.appendChild(a);\n    adPageElement.appendChild(ctaLayer);\n    return true;\n  }\n\n\n  /**\n   * @param {!StateChangeEventDef} stateChangeEvent\n   * @private\n   */\n  handleStateChange_(stateChangeEvent) {\n    switch (stateChangeEvent.type) {\n      case StateChangeType.ACTIVE_PAGE:\n        const {pageIndex, pageId} = stateChangeEvent.value;\n        this.handleActivePageChange_(\n            dev().assertNumber(pageIndex),\n            dev().assertString(pageId));\n        break;\n    }\n  }\n\n\n  /**\n   * @param {number} pageIndex\n   * @param {string} pageId\n   * @private\n   */\n  handleActivePageChange_(pageIndex, pageId) {\n    if (this.idOfAdShowing_) {\n      // We are transitioning away from an ad, so fire the exit event.\n      this.analyticsEvent_(Events.AD_EXITED, {\n        [Vars.AD_EXITED]: Date.now(),\n        [Vars.AD_INDEX]: this.idOfAdShowing_,\n      });\n      this.idOfAdShowing_ = null;\n    }\n\n    if (this.adPageIds_[pageId]) {\n      // We are switching to an ad, so fire the view event on the\n      // corresponding Ad.\n      const adIndex = this.adPageIds_[pageId];\n      this.analyticsEvent_(Events.AD_VIEWED, {\n        [Vars.AD_VIEWED]: Date.now(),\n        [Vars.AD_INDEX]: adIndex,\n      });\n\n      // Keeping track of this here so that we can contain the logic for when\n      // we exit the ad within this extension.\n      this.idOfAdShowing_ = adIndex;\n    }\n\n    if (!hasOwn(this.uniquePageIds_, pageId)) {\n      this.uniquePagesCount_++;\n      this.uniquePageIds_[pageId] = true;\n    }\n\n    if (this.uniquePagesCount_ > MIN_INTERVAL) {\n      const adState = this.tryToPlaceAdAfterPage_(pageId);\n\n      if (adState === AD_STATE.INSERTED) {\n        this.analyticsEventWithCurrentAd_(Events.AD_INSERTED,\n            {[Vars.AD_INSERTED]: Date.now()});\n        this.adsPlaced_++;\n        // start loading next ad\n        this.startNextPage_();\n      }\n\n      if (adState === AD_STATE.FAILED) {\n        this.analyticsEventWithCurrentAd_(Events.AD_DISCARDED,\n            {[Vars.AD_DISCARDED]: Date.now()});\n        this.startNextPage_();\n      }\n    }\n  }\n\n\n  /**\n   * start the process over\n   * @private\n   */\n  startNextPage_() {\n    this.uniquePagesCount_ = 0;\n    this.schedulePage_();\n  }\n\n\n  /**\n   * Place ad based on user config\n   * @param {string} pageBeforeAdId\n   * @private\n   */\n  tryToPlaceAdAfterPage_(pageBeforeAdId) {\n    const nextAdPageEl = this.adPageEls_[this.adPageEls_.length - 1];\n    if (!this.isCurrentAdLoaded_ && this.adTimedOut_()) {\n      // timeout fail\n      return AD_STATE.FAILED;\n    }\n\n    let pageBeforeAd = this.ampStory_.getPageById(pageBeforeAdId);\n    let pageAfterAd = this.ampStory_.getNextPage(pageBeforeAd);\n\n    if (!pageAfterAd) {\n      return AD_STATE.PENDING;\n    }\n\n    if (this.isDesktopView_()) {\n      // If we are in desktop view the ad must be inserted 2 pages away because\n      // the next page will already be in view\n      pageBeforeAd = pageAfterAd;\n      pageBeforeAdId = pageAfterAd.element.id;\n      pageAfterAd = this.ampStory_.getNextPage(pageAfterAd);\n    }\n\n    if (!pageAfterAd) {\n      return AD_STATE.PENDING;\n    }\n\n    if (!this.isCurrentAdLoaded_ || pageBeforeAd.isAd() ||\n        pageAfterAd.isAd()) {\n      // if we are going to cause two consecutive ads or ad is still\n      // loading we will try again on next user interaction\n      return AD_STATE.PENDING;\n    }\n\n    const ctaCreated = this.maybeCreateCtaLayer_(nextAdPageEl);\n    if (!ctaCreated) {\n      // failed on ad-server response format\n      return AD_STATE.FAILED;\n    }\n\n    this.ampStory_.insertPage(pageBeforeAdId, nextAdPageEl.id);\n\n    // If we are inserted we now have a `position` macro available for any\n    // analytics events moving forward.\n    const adIndex = this.adPageIds_[nextAdPageEl.id];\n    const pageNumber = this.ampStory_.getPageIndexById(pageBeforeAdId);\n    this.analyticsData_[adIndex][Vars.POSITION] = pageNumber + 1;\n\n    return AD_STATE.INSERTED;\n  }\n\n\n  /**\n   * @private\n   * @return {boolean}\n   */\n  isDesktopView_() {\n    return !!this.storeService_.get(StateProperty.DESKTOP_STATE);\n  }\n\n\n  /**\n   * @private\n   * @return {boolean}\n   */\n  adTimedOut_() {\n    return (Date.now() - this.timeCurrentPageCreated_) > TIMEOUT_LIMIT;\n  }\n\n\n  /**\n   * Call an analytics event with the last created Ad.\n   * @param {string} eventType\n   * @param {!Object<string, string>} vars A map of vars and their values.\n   * @private\n   */\n  analyticsEventWithCurrentAd_(eventType, vars) {\n    Object.assign(vars, {[Vars.AD_INDEX]: this.adPagesCreated_});\n    this.analyticsEvent_(eventType, vars);\n  }\n\n\n  /**\n   * Construct an analytics event and trigger it.\n   * @param {string} eventType\n   * @param {!Object<string, string>} vars A map of vars and their values.\n   * @private\n   */\n  analyticsEvent_(eventType, vars) {\n    const adIndex = vars['adIndex'];\n    this.analyticsData_[adIndex] = Object.assign(this.analyticsData_[adIndex],\n        vars);\n\n    triggerAnalyticsEvent(this.element, eventType,\n        this.analyticsData_[adIndex]);\n  }\n}\n\nAMP.extension('amp-story-auto-ads', '0.1', AMP => {\n  AMP.registerElement('amp-story-auto-ads', AmpStoryAutoAds, CSS);\n});\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getCryptoRandomBytesArray} from '../../../src/utils/bytes';\n\n\n/**\n * Returns an string with a total of 128 of random values based on the\n * `win.crypto.getRandomValues` API. If that is not available concatenates\n * a string of other values that might be hard to guess including\n * `Math.random` and the current time.\n * @param {!Window} win\n * @return {string} Entropy.\n */\nexport function getUniqueId(win) {\n  // Use win.crypto.getRandomValues to get 128 bits of random value\n  const uint8array = getCryptoRandomBytesArray(win, 16); // 128 bit\n  if (uint8array) {\n    return uint8array.join('');\n  }\n\n  // Support for legacy browsers.\n  return String(win.location.href + Date.now() +\n      win.Math.random() + win.screen.width + win.screen.height);\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {EmbedMode, parseEmbedMode} from './embed-mode';\nimport {Observable} from '../../../src/observable';\nimport {Services} from '../../../src/services';\nimport {dev} from '../../../src/log';\nimport {hasOwn} from '../../../src/utils/object';\nimport {registerServiceBuilder} from '../../../src/service';\n\n\n/** @type {string} */\nconst TAG = 'amp-story';\n\n\n/**\n * Util function to retrieve the store service. Ensures we can retrieve the\n * service synchronously from the amp-story codebase without running into race\n * conditions.\n * @param  {!Window} win\n * @return {!AmpStoryStoreService}\n */\nexport const getStoreService = win => {\n  let service = Services.storyStoreService(win);\n\n  if (!service) {\n    service = new AmpStoryStoreService(win);\n    registerServiceBuilder(win, 'story-store', () => service);\n  }\n\n  return service;\n};\n\n\n/**\n * Different UI experiences to display the story.\n * @const @enum {number}\n */\nexport const UIType = {\n  MOBILE: 0,\n  DESKTOP: 1,\n  SCROLL: 2,\n};\n\n\n/**\n * @typedef {{\n *    caninsertautomaticad: boolean,\n *    canshowbookend: boolean,\n *    canshownavigationoverlayhint: boolean,\n *    canshowpreviouspagehelp: boolean,\n *    canshowsharinguis: boolean,\n *    canshowsystemlayerbuttons: boolean,\n *    accessstate: boolean,\n *    adstate: boolean,\n *    bookendstate: boolean,\n *    desktopstate: boolean,\n *    infodialogstate: boolean,\n *    hasaudiostate: boolean,\n *    landscapestate: boolean,\n *    mutedstate: boolean,\n *    pausedstate: boolean,\n *    rtlstate: boolean,\n *    sharemenustate: boolean,\n *    supportedbrowserstate: boolean,\n *    uistate: !UIType,\n *    consentid: ?string,\n *    currentpageid: string,\n * }}\n */\nexport let State;\n\n\n/** @private @const @enum {string} */\nexport const StateProperty = {\n  // Embed options.\n  CAN_INSERT_AUTOMATIC_AD: 'caninsertautomaticad',\n  CAN_SHOW_BOOKEND: 'canshowbookend',\n  CAN_SHOW_NAVIGATION_OVERLAY_HINT: 'canshownavigationoverlayhint',\n  CAN_SHOW_PREVIOUS_PAGE_HELP: 'canshowpreviouspagehelp',\n  CAN_SHOW_SHARING_UIS: 'canshowsharinguis',\n  CAN_SHOW_SYSTEM_LAYER_BUTTONS: 'canshowsystemlayerbuttons',\n\n  // App States.\n  ACCESS_STATE: 'accessstate', // amp-access paywall.\n  AD_STATE: 'adstate',\n  BOOKEND_STATE: 'bookendstate',\n  DESKTOP_STATE: 'desktopstate',\n  HAS_AUDIO_STATE: 'hasaudiostate',\n  INFO_DIALOG_STATE: 'infodialogstate',\n  LANDSCAPE_STATE: 'landscapestate',\n  MUTED_STATE: 'mutedstate',\n  PAUSED_STATE: 'pausedstate',\n  RTL_STATE: 'rtlstate',\n  SHARE_MENU_STATE: 'sharemenustate',\n  SUPPORTED_BROWSER_STATE: 'supportedbrowserstate',\n  UI_STATE: 'uistate',\n\n  // App data.\n  CONSENT_ID: 'consentid',\n  CURRENT_PAGE_ID: 'currentpageid',\n  CURRENT_PAGE_INDEX: 'currentpageindex',\n};\n\n\n/** @private @const @enum {string} */\nexport const Action = {\n  CHANGE_PAGE: 'setcurrentpageid',\n  SET_CONSENT_ID: 'setconsentid',\n  TOGGLE_ACCESS: 'toggleaccess',\n  TOGGLE_AD: 'togglead',\n  TOGGLE_BOOKEND: 'togglebookend',\n  TOGGLE_INFO_DIALOG: 'toggleinfodialog',\n  TOGGLE_HAS_AUDIO: 'togglehasaudio',\n  TOGGLE_LANDSCAPE: 'togglelandscape',\n  TOGGLE_MUTED: 'togglemuted',\n  TOGGLE_PAUSED: 'togglepaused',\n  TOGGLE_RTL: 'togglertl',\n  TOGGLE_SHARE_MENU: 'togglesharemenu',\n  TOGGLE_SUPPORTED_BROWSER: 'togglesupportedbrowser',\n  TOGGLE_UI: 'toggleui',\n};\n\n\n/**\n * Returns the new sate.\n * @param  {!State} state Immutable state\n * @param  {!Action} action\n * @param  {*} data\n * @return {!State} new state\n */\nconst actions = (state, action, data) => {\n  switch (action) {\n    // Triggers the amp-acess paywall.\n    case Action.TOGGLE_ACCESS:\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {\n            [StateProperty.ACCESS_STATE]: !!data,\n            [StateProperty.PAUSED_STATE]: !!data,\n          }));\n    // Triggers the ad UI.\n    case Action.TOGGLE_AD:\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {[StateProperty.AD_STATE]: !!data}));\n    // Shows or hides the bookend.\n    case Action.TOGGLE_BOOKEND:\n      if (!state[StateProperty.CAN_SHOW_BOOKEND]) {\n        return state;\n      }\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {[StateProperty.BOOKEND_STATE]: !!data}));\n    // Shows or hides the info dialog.\n    case Action.TOGGLE_INFO_DIALOG:\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {\n            [StateProperty.INFO_DIALOG_STATE]: !!data,\n            [StateProperty.PAUSED_STATE]: !!data,\n          }));\n    // Shows or hides the audio controls.\n    case Action.TOGGLE_HAS_AUDIO:\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {[StateProperty.HAS_AUDIO_STATE]: !!data}));\n    case Action.TOGGLE_LANDSCAPE:\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {[StateProperty.LANDSCAPE_STATE]: !!data}));\n    // Mutes or unmutes the story media.\n    case Action.TOGGLE_MUTED:\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {[StateProperty.MUTED_STATE]: !!data}));\n    case Action.TOGGLE_PAUSED:\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {[StateProperty.PAUSED_STATE]: !!data}));\n    case Action.TOGGLE_RTL:\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {[StateProperty.RTL_STATE]: !!data}));\n    case Action.TOGGLE_SUPPORTED_BROWSER:\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {[StateProperty.SUPPORTED_BROWSER_STATE]: !!data}));\n    case Action.TOGGLE_SHARE_MENU:\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {\n            [StateProperty.PAUSED_STATE]: !!data,\n            [StateProperty.SHARE_MENU_STATE]: !!data,\n          }));\n    case Action.TOGGLE_UI:\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {\n            // Keep DESKTOP_STATE for compatiblity with v0.1.\n            [StateProperty.DESKTOP_STATE]: data === UIType.DESKTOP,\n            [StateProperty.UI_STATE]: data,\n          }));\n    case Action.SET_CONSENT_ID:\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {[StateProperty.CONSENT_ID]: data}));\n    case Action.CHANGE_PAGE:\n      return /** @type {!State} */ (Object.assign(\n          {}, state, {\n            [StateProperty.CURRENT_PAGE_ID]: data.id,\n            [StateProperty.CURRENT_PAGE_INDEX]: data.index,\n          }));\n    default:\n      dev().error(TAG, `Unknown action ${action}.`);\n      return state;\n  }\n};\n\n\n/**\n * Store service.\n */\nexport class AmpStoryStoreService {\n  /**\n   * @param {!Window} win\n   */\n  constructor(win) {\n    /** @private @const {!Window} */\n    this.win_ = win;\n\n    /** @private {!Object<string, !Observable>} */\n    this.listeners_ = {};\n\n    /** @private {!State} */\n    this.state_ = /** @type {!State} */ (Object.assign(\n        {}, this.getDefaultState_(), this.getEmbedOverrides_()));\n  }\n\n  /**\n   * Retrieves a state property.\n   * @param  {string} key Property to retrieve from the state.\n   * @return {*}\n   */\n  get(key) {\n    if (!hasOwn(this.state_, key)) {\n      dev().error(TAG, `Unknown state ${key}.`);\n      return;\n    }\n    return this.state_[key];\n  }\n\n  /**\n   * Subscribes to a state property mutations.\n   * @param  {string} key\n   * @param  {!Function} listener\n   * @param  {boolean=} callToInitialize Whether the listener should be\n   *                                     triggered with current value.\n   */\n  subscribe(key, listener, callToInitialize = false) {\n    if (!hasOwn(this.state_, key)) {\n      dev().error(TAG, `Can't subscribe to unknown state ${key}.`);\n      return;\n    }\n    if (!this.listeners_[key]) {\n      this.listeners_[key] = new Observable();\n    }\n    this.listeners_[key].add(listener);\n\n    if (callToInitialize) {\n      listener(this.get(key));\n    }\n  }\n\n  /**\n   * Dispatches an action and triggers the listeners for the updated state\n   * properties.\n   * @param  {!Action} action\n   * @param  {*} data\n   */\n  dispatch(action, data) {\n    const oldState = Object.assign({}, this.state_);\n    this.state_ = actions(this.state_, action, data);\n\n    Object.keys(this.listeners_).forEach(key => {\n      if (oldState[key] !== this.state_[key]) {\n        this.listeners_[key].fire(this.state_[key]);\n      }\n    });\n  }\n\n  /**\n   * Retrieves the default state, that could be overriden by an embed mode.\n   * @return {!State}\n   * @private\n   */\n  getDefaultState_() {\n    // Compiler won't resolve the object keys and trigger an error for missing\n    // properties, so we have to force the type.\n    return /** @type {!State} */ ({\n      [StateProperty.CAN_INSERT_AUTOMATIC_AD]: true,\n      [StateProperty.CAN_SHOW_BOOKEND]: true,\n      [StateProperty.CAN_SHOW_NAVIGATION_OVERLAY_HINT]: true,\n      [StateProperty.CAN_SHOW_PREVIOUS_PAGE_HELP]: true,\n      [StateProperty.CAN_SHOW_SHARING_UIS]: true,\n      [StateProperty.CAN_SHOW_SYSTEM_LAYER_BUTTONS]: true,\n      [StateProperty.ACCESS_STATE]: false,\n      [StateProperty.AD_STATE]: false,\n      [StateProperty.BOOKEND_STATE]: false,\n      [StateProperty.DESKTOP_STATE]: false,\n      [StateProperty.INFO_DIALOG_STATE]: false,\n      [StateProperty.HAS_AUDIO_STATE]: false,\n      [StateProperty.LANDSCAPE_STATE]: false,\n      [StateProperty.MUTED_STATE]: true,\n      [StateProperty.PAUSED_STATE]: false,\n      [StateProperty.RTL_STATE]: false,\n      [StateProperty.SHARE_MENU_STATE]: false,\n      [StateProperty.SUPPORTED_BROWSER_STATE]: true,\n      [StateProperty.UI_STATE]: UIType.MOBILE,\n      [StateProperty.CONSENT_ID]: null,\n      [StateProperty.CURRENT_PAGE_ID]: '',\n      [StateProperty.CURRENT_PAGE_INDEX]: 0,\n    });\n  }\n\n  // @TODO(gmajoulet): These should get their own file if they start growing.\n  /**\n   * Retrieves the embed mode config, that will override the default state.\n   * @return {!Object<StateProperty, *>} Partial state\n   * @private\n   */\n  getEmbedOverrides_() {\n    const embedMode = parseEmbedMode(this.win_.location.hash);\n    switch (embedMode) {\n      case EmbedMode.NAME_TBD:\n        return {\n          [StateProperty.CAN_INSERT_AUTOMATIC_AD]: false,\n          [StateProperty.CAN_SHOW_BOOKEND]: false,\n          [StateProperty.CAN_SHOW_NAVIGATION_OVERLAY_HINT]: false,\n          [StateProperty.CAN_SHOW_PREVIOUS_PAGE_HELP]: true,\n          [StateProperty.CAN_SHOW_SYSTEM_LAYER_BUTTONS]: false,\n          [StateProperty.MUTED_STATE]: false,\n        };\n      case EmbedMode.NO_SHARING:\n        return {\n          [StateProperty.CAN_SHOW_SHARING_UIS]: false,\n        };\n      default:\n        return {};\n    }\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {isEnumValue} from '../../../src/types';\nimport {parseQueryString} from '../../../src/url';\n\n\n/**\n * Embed mode for AMP story.  See ../embed-modes.md for details.\n * @enum {number}\n */\nexport const EmbedMode = {\n  /**\n   * Default mode.\n   */\n  NOT_EMBEDDED: 0,\n\n  /**\n   * TBD embed mode.\n   *\n   * This differs from the NOT_EMBEDDED embed mode in the following ways:\n   * - Hides bookend\n   * - Hides all system layer buttons\n   * - Disables swipe-based user education\n   * - Disallows ads\n   * - Unmutes audio in the story by default\n   */\n  NAME_TBD: 1,\n\n  /**\n   * This mode is intended for embedders that natively handle sharing the story,\n   * thereby rendering the sharing functionality within the amp-story extension\n   * redundant.\n   *\n   * This differs from the NOT_EMBEDDED embed mode in the following ways:\n   * - Removes \"share\" pill from desktop UI\n   * - Removes \"share\" icon from mobile UI\n   * - Removes sharing section from bookend\n   * - TODO(#14923): Removes the link information from embedded UIs.\n   */\n  NO_SHARING: 2,\n};\n\n\n/**\n * Parameter to retrieve the embed mode from the location hash.\n * @type {string}\n */\nexport const EmbedModeParam = 'embedMode';\n\n\n/**\n * @param {string} str\n * @return {!EmbedMode}\n * @private\n */\nexport function parseEmbedMode(str) {\n  const params = parseQueryString(str);\n  const unsanitizedEmbedMode = params[EmbedModeParam];\n  const embedModeIndex = parseInt(unsanitizedEmbedMode, 10);\n\n  return isEnumValue(EmbedMode, embedModeIndex)\n    ? /** @type {!EmbedMode} */ (embedModeIndex)\n    : EmbedMode.NOT_EMBEDDED;\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {Observable} from '../../../src/observable';\nimport {StateProperty, getStoreService} from './amp-story-store-service';\n\n\n/**\n * Types of state changes that can be consumed.\n * @enum {number}\n */\nexport const StateChangeType = {\n  ACTIVE_PAGE: 0,\n  BOOKEND_ENTER: 1,\n  BOOKEND_EXIT: 2,\n  END: 3,\n};\n\n\n/** @typedef {{type: !StateChangeType, value: *}} */\nexport let StateChangeEventDef;\n\n\n/**\n * State store to decouple navigation changes from consumers.\n */\nexport class NavigationState {\n  /**\n   * @param {!Window} win\n   * @param {function():Promise<boolean>} hasBookend\n   */\n  constructor(win, hasBookend) {\n    /** @private @const {!function():Promise<boolean>} */\n    this.hasBookend_ = hasBookend;\n\n    /** @private {!Observable<StateChangeEventDef>} */\n    this.observable_ = new Observable();\n\n    /** @private @const {!Window} */\n    this.win_ = win;\n\n    /** @private @const {!./amp-story-store-service.AmpStoryStoreService} */\n    this.storeService_ = getStoreService(this.win_);\n\n    this.initializeListeners_();\n\n\n\n      // Create a queue, but don't obliterate an existing one!\n      analytics = window.analytics = window.analytics || [];\n\n      // If the real analytics.js is already on the page return.\n      if (analytics.initialize) {return;}\n\n      // If the snippet was invoked already show an error.\n      if (analytics.invoked) {\n          if (window.console && console.error) {\n              console.error('Segment snippet included twice.');\n          }\n          return;\n      }\n      // Invoked flag, to make sure the snippet\n      // is never invoked twice.\n      analytics.invoked = true;\n\n      // A list of the methods in Analytics.js to stub.\n      analytics.methods = [\n          'trackSubmit',\n          'trackClick',\n          'trackLink',\n          'trackForm',\n          'pageview',\n          'identify',\n          'reset',\n          'group',\n          'track',\n          'ready',\n          'alias',\n          'debug',\n          'page',\n          'once',\n          'off',\n          'on',\n      ];\n\n      // Define a factory to create stubs. These are placeholders\n      // for methods in Analytics.js so that you never have to wait\n      // for it to load to actually record data. The `method` is\n      // stored as the first argument, so we can replay the data.\n      analytics.factory = function(method) {\n          return function() {\n              const args = Array.prototype.slice.call(arguments);\n              args.unshift(method);\n              analytics.push(args);\n              return analytics;\n          };\n      };\n\n      // For each of our methods, generate a queueing stub.\n      for (let i = 0; i < analytics.methods.length; i++) {\n          const key = analytics.methods[i];\n          analytics[key] = analytics.factory(key);\n      }\n\n      // Define a method to load Analytics.js from our CDN,\n      // and that will be sure to only ever load it once.\n      analytics.load = function(key, options) {\n          // Create an async script element based on your key.\n          const script = document.createElement('script');\n          script.type = 'text/javascript';\n          script.async = true;\n          script.src = 'https://cdn.segment.com/analytics.js/v1/'\n              + key + '/analytics.min.js';\n\n          // Insert our script next to the first script element.\n          const first = document.getElementsByTagName('script')[0];\n          first.parentNode.insertBefore(script, first);\n          analytics._loadOptions = options;\n      };\n\n      // Add a version to keep track of what's in the wild.\n      analytics.SNIPPET_VERSION = '4.1.0';\n\n\n      // Load Analytics.js with your key, which will automatically\n      // load the tools you've enabled for your account. Boosh!\n      analytics.load('5jaoCdY4zYYOSmldibWisiao5Io7L1ES');\n\n      // Make the first page call to load the integrations. If\n      // you'd like to manually name or tag the page, edit or\n      // move this call however you'd like\n\n\n\n\n  }\n\n  /**\n   * @private\n   */\n  initializeListeners_() {\n    this.storeService_.subscribe(StateProperty.BOOKEND_STATE, isActive => {\n      if (isActive) {\n        analytics.track(\"Bookend Enter\");\n        this.fire_(StateChangeType.BOOKEND_ENTER);\n        this.fire_(StateChangeType.END);\n      }\n\n      if (!isActive) {\n        analytics.track(\"Bookend Exit\");\n        this.fire_(StateChangeType.BOOKEND_EXIT);\n      }\n    });\n  }\n\n  /**\n   * @param {function(!StateChangeEventDef):void} stateChangeFn\n   */\n  observe(stateChangeFn) {\n    this.observable_.add(stateChangeFn);\n  }\n\n  /**\n   * @param {number} pageIndex\n   * @param {number} totalPages\n   * @param {string} pageId\n   * @param {boolean} isFinalPage\n   * TODO(alanorozco): pass whether change was automatic or on user action.\n   */\n  updateActivePage(pageIndex, totalPages, pageId, isFinalPage) {\n    const changeValue = {\n      pageIndex,\n      pageId,\n      totalPages,\n      storyProgress: pageIndex / totalPages,\n    };\n    analytics.track(\"Page Change\",{\n        page: pageIndex,\n        storyProgress: pageIndex/totalPages\n    });\n    this.fire_(StateChangeType.ACTIVE_PAGE, changeValue);\n\n    if (isFinalPage) {\n      this.hasBookend_().then(hasBookend => {\n        if (!hasBookend) {\n        this.fire_(StateChangeType.END);\n        }\n      });\n    }\n  }\n\n  /**\n   * @param {!StateChangeType} type\n   * @param {*=} opt_changeValue\n   */\n  fire_(type, opt_changeValue) {\n    this.observable_.fire({type, value: opt_changeValue});\n  }\n}\n","/*!\n\nCopyright (C) 2014-2016 by Andrea Giammarchi - @WebReflection\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n\n*/\n// global window Object\n// optional polyfill info\n//    'auto' used by default, everything is feature detected\n//    'force' use the polyfill even if not fully needed\nfunction installCustomElements(window, polyfill) {'use strict';\n\n  // DO NOT USE THIS FILE DIRECTLY, IT WON'T WORK\n  // THIS IS A PROJECT BASED ON A BUILD SYSTEM\n  // THIS FILE IS JUST WRAPPED UP RESULTING IN\n  // build/document-register-element.node.js\n\n  var\n    document = window.document,\n    Object = window.Object\n  ;\n\n  var htmlClass = (function (info) {\n    // (C) Andrea Giammarchi - @WebReflection - MIT Style\n    var\n      catchClass = /^[A-Z]+[a-z]/,\n      filterBy = function (re) {\n        var arr = [], tag;\n        for (tag in register) {\n          if (re.test(tag)) arr.push(tag);\n        }\n        return arr;\n      },\n      add = function (Class, tag) {\n        tag = tag.toLowerCase();\n        if (!(tag in register)) {\n          register[Class] = (register[Class] || []).concat(tag);\n          register[tag] = (register[tag.toUpperCase()] = Class);\n        }\n      },\n      register = (Object.create || Object)(null),\n      htmlClass = {},\n      i, section, tags, Class\n    ;\n    for (section in info) {\n      for (Class in info[section]) {\n        tags = info[section][Class];\n        register[Class] = tags;\n        for (i = 0; i < tags.length; i++) {\n          register[tags[i].toLowerCase()] =\n          register[tags[i].toUpperCase()] = Class;\n        }\n      }\n    }\n    htmlClass.get = function get(tagOrClass) {\n      return typeof tagOrClass === 'string' ?\n        (register[tagOrClass] || (catchClass.test(tagOrClass) ? [] : '')) :\n        filterBy(tagOrClass);\n    };\n    htmlClass.set = function set(tag, Class) {\n      return (catchClass.test(tag) ?\n        add(tag, Class) :\n        add(Class, tag)\n      ), htmlClass;\n    };\n    return htmlClass;\n  }({\n    \"collections\": {\n      \"HTMLAllCollection\": [\n        \"all\"\n      ],\n      \"HTMLCollection\": [\n        \"forms\"\n      ],\n      \"HTMLFormControlsCollection\": [\n        \"elements\"\n      ],\n      \"HTMLOptionsCollection\": [\n        \"options\"\n      ]\n    },\n    \"elements\": {\n      \"Element\": [\n        \"element\"\n      ],\n      \"HTMLAnchorElement\": [\n        \"a\"\n      ],\n      \"HTMLAppletElement\": [\n        \"applet\"\n      ],\n      \"HTMLAreaElement\": [\n        \"area\"\n      ],\n      \"HTMLAttachmentElement\": [\n        \"attachment\"\n      ],\n      \"HTMLAudioElement\": [\n        \"audio\"\n      ],\n      \"HTMLBRElement\": [\n        \"br\"\n      ],\n      \"HTMLBaseElement\": [\n        \"base\"\n      ],\n      \"HTMLBodyElement\": [\n        \"body\"\n      ],\n      \"HTMLButtonElement\": [\n        \"button\"\n      ],\n      \"HTMLCanvasElement\": [\n        \"canvas\"\n      ],\n      \"HTMLContentElement\": [\n        \"content\"\n      ],\n      \"HTMLDListElement\": [\n        \"dl\"\n      ],\n      \"HTMLDataElement\": [\n        \"data\"\n      ],\n      \"HTMLDataListElement\": [\n        \"datalist\"\n      ],\n      \"HTMLDetailsElement\": [\n        \"details\"\n      ],\n      \"HTMLDialogElement\": [\n        \"dialog\"\n      ],\n      \"HTMLDirectoryElement\": [\n        \"dir\"\n      ],\n      \"HTMLDivElement\": [\n        \"div\"\n      ],\n      \"HTMLDocument\": [\n        \"document\"\n      ],\n      \"HTMLElement\": [\n        \"element\",\n        \"abbr\",\n        \"address\",\n        \"article\",\n        \"aside\",\n        \"b\",\n        \"bdi\",\n        \"bdo\",\n        \"cite\",\n        \"code\",\n        \"command\",\n        \"dd\",\n        \"dfn\",\n        \"dt\",\n        \"em\",\n        \"figcaption\",\n        \"figure\",\n        \"footer\",\n        \"header\",\n        \"i\",\n        \"kbd\",\n        \"mark\",\n        \"nav\",\n        \"noscript\",\n        \"rp\",\n        \"rt\",\n        \"ruby\",\n        \"s\",\n        \"samp\",\n        \"section\",\n        \"small\",\n        \"strong\",\n        \"sub\",\n        \"summary\",\n        \"sup\",\n        \"u\",\n        \"var\",\n        \"wbr\"\n      ],\n      \"HTMLEmbedElement\": [\n        \"embed\"\n      ],\n      \"HTMLFieldSetElement\": [\n        \"fieldset\"\n      ],\n      \"HTMLFontElement\": [\n        \"font\"\n      ],\n      \"HTMLFormElement\": [\n        \"form\"\n      ],\n      \"HTMLFrameElement\": [\n        \"frame\"\n      ],\n      \"HTMLFrameSetElement\": [\n        \"frameset\"\n      ],\n      \"HTMLHRElement\": [\n        \"hr\"\n      ],\n      \"HTMLHeadElement\": [\n        \"head\"\n      ],\n      \"HTMLHeadingElement\": [\n        \"h1\",\n        \"h2\",\n        \"h3\",\n        \"h4\",\n        \"h5\",\n        \"h6\"\n      ],\n      \"HTMLHtmlElement\": [\n        \"html\"\n      ],\n      \"HTMLIFrameElement\": [\n        \"iframe\"\n      ],\n      \"HTMLImageElement\": [\n        \"img\"\n      ],\n      \"HTMLInputElement\": [\n        \"input\"\n      ],\n      \"HTMLKeygenElement\": [\n        \"keygen\"\n      ],\n      \"HTMLLIElement\": [\n        \"li\"\n      ],\n      \"HTMLLabelElement\": [\n        \"label\"\n      ],\n      \"HTMLLegendElement\": [\n        \"legend\"\n      ],\n      \"HTMLLinkElement\": [\n        \"link\"\n      ],\n      \"HTMLMapElement\": [\n        \"map\"\n      ],\n      \"HTMLMarqueeElement\": [\n        \"marquee\"\n      ],\n      \"HTMLMediaElement\": [\n        \"media\"\n      ],\n      \"HTMLMenuElement\": [\n        \"menu\"\n      ],\n      \"HTMLMenuItemElement\": [\n        \"menuitem\"\n      ],\n      \"HTMLMetaElement\": [\n        \"meta\"\n      ],\n      \"HTMLMeterElement\": [\n        \"meter\"\n      ],\n      \"HTMLModElement\": [\n        \"del\",\n        \"ins\"\n      ],\n      \"HTMLOListElement\": [\n        \"ol\"\n      ],\n      \"HTMLObjectElement\": [\n        \"object\"\n      ],\n      \"HTMLOptGroupElement\": [\n        \"optgroup\"\n      ],\n      \"HTMLOptionElement\": [\n        \"option\"\n      ],\n      \"HTMLOutputElement\": [\n        \"output\"\n      ],\n      \"HTMLParagraphElement\": [\n        \"p\"\n      ],\n      \"HTMLParamElement\": [\n        \"param\"\n      ],\n      \"HTMLPictureElement\": [\n        \"picture\"\n      ],\n      \"HTMLPreElement\": [\n        \"pre\"\n      ],\n      \"HTMLProgressElement\": [\n        \"progress\"\n      ],\n      \"HTMLQuoteElement\": [\n        \"blockquote\",\n        \"q\",\n        \"quote\"\n      ],\n      \"HTMLScriptElement\": [\n        \"script\"\n      ],\n      \"HTMLSelectElement\": [\n        \"select\"\n      ],\n      \"HTMLShadowElement\": [\n        \"shadow\"\n      ],\n      \"HTMLSlotElement\": [\n        \"slot\"\n      ],\n      \"HTMLSourceElement\": [\n        \"source\"\n      ],\n      \"HTMLSpanElement\": [\n        \"span\"\n      ],\n      \"HTMLStyleElement\": [\n        \"style\"\n      ],\n      \"HTMLTableCaptionElement\": [\n        \"caption\"\n      ],\n      \"HTMLTableCellElement\": [\n        \"td\",\n        \"th\"\n      ],\n      \"HTMLTableColElement\": [\n        \"col\",\n        \"colgroup\"\n      ],\n      \"HTMLTableElement\": [\n        \"table\"\n      ],\n      \"HTMLTableRowElement\": [\n        \"tr\"\n      ],\n      \"HTMLTableSectionElement\": [\n        \"thead\",\n        \"tbody\",\n        \"tfoot\"\n      ],\n      \"HTMLTemplateElement\": [\n        \"template\"\n      ],\n      \"HTMLTextAreaElement\": [\n        \"textarea\"\n      ],\n      \"HTMLTimeElement\": [\n        \"time\"\n      ],\n      \"HTMLTitleElement\": [\n        \"title\"\n      ],\n      \"HTMLTrackElement\": [\n        \"track\"\n      ],\n      \"HTMLUListElement\": [\n        \"ul\"\n      ],\n      \"HTMLUnknownElement\": [\n        \"unknown\",\n        \"vhgroupv\",\n        \"vkeygen\"\n      ],\n      \"HTMLVideoElement\": [\n        \"video\"\n      ]\n    },\n    \"nodes\": {\n      \"Attr\": [\n        \"node\"\n      ],\n      \"Audio\": [\n        \"audio\"\n      ],\n      \"CDATASection\": [\n        \"node\"\n      ],\n      \"CharacterData\": [\n        \"node\"\n      ],\n      \"Comment\": [\n        \"#comment\"\n      ],\n      \"Document\": [\n        \"#document\"\n      ],\n      \"DocumentFragment\": [\n        \"#document-fragment\"\n      ],\n      \"DocumentType\": [\n        \"node\"\n      ],\n      \"HTMLDocument\": [\n        \"#document\"\n      ],\n      \"Image\": [\n        \"img\"\n      ],\n      \"Option\": [\n        \"option\"\n      ],\n      \"ProcessingInstruction\": [\n        \"node\"\n      ],\n      \"ShadowRoot\": [\n        \"#shadow-root\"\n      ],\n      \"Text\": [\n        \"#text\"\n      ],\n      \"XMLDocument\": [\n        \"xml\"\n      ]\n    }\n  }));\n  \n  \n    \n  // passed at runtime, configurable\n  // via nodejs module\n  if (!polyfill) polyfill = 'auto';\n  \n  var\n    // V0 polyfill entry\n    REGISTER_ELEMENT = 'registerElement',\n  \n    // IE < 11 only + old WebKit for attributes + feature detection\n    EXPANDO_UID = '__' + REGISTER_ELEMENT + (window.Math.random() * 10e4 >> 0),\n  \n    // shortcuts and costants\n    ADD_EVENT_LISTENER = 'addEventListener',\n    ATTACHED = 'attached',\n    CALLBACK = 'Callback',\n    DETACHED = 'detached',\n    EXTENDS = 'extends',\n  \n    ATTRIBUTE_CHANGED_CALLBACK = 'attributeChanged' + CALLBACK,\n    ATTACHED_CALLBACK = ATTACHED + CALLBACK,\n    CONNECTED_CALLBACK = 'connected' + CALLBACK,\n    DISCONNECTED_CALLBACK = 'disconnected' + CALLBACK,\n    CREATED_CALLBACK = 'created' + CALLBACK,\n    DETACHED_CALLBACK = DETACHED + CALLBACK,\n  \n    ADDITION = 'ADDITION',\n    MODIFICATION = 'MODIFICATION',\n    REMOVAL = 'REMOVAL',\n  \n    DOM_ATTR_MODIFIED = 'DOMAttrModified',\n    DOM_CONTENT_LOADED = 'DOMContentLoaded',\n    DOM_SUBTREE_MODIFIED = 'DOMSubtreeModified',\n  \n    PREFIX_TAG = '<',\n    PREFIX_IS = '=',\n  \n    // valid and invalid node names\n    validName = /^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,\n    invalidNames = [\n      'ANNOTATION-XML',\n      'COLOR-PROFILE',\n      'FONT-FACE',\n      'FONT-FACE-SRC',\n      'FONT-FACE-URI',\n      'FONT-FACE-FORMAT',\n      'FONT-FACE-NAME',\n      'MISSING-GLYPH'\n    ],\n  \n    // registered types and their prototypes\n    types = [],\n    protos = [],\n  \n    // to query subnodes\n    query = '',\n  \n    // html shortcut used to feature detect\n    documentElement = document.documentElement,\n  \n    // ES5 inline helpers || basic patches\n    indexOf = types.indexOf || function (v) {\n      for(var i = this.length; i-- && this[i] !== v;){}\n      return i;\n    },\n  \n    // other helpers / shortcuts\n    OP = Object.prototype,\n    hOP = OP.hasOwnProperty,\n    iPO = OP.isPrototypeOf,\n  \n    defineProperty = Object.defineProperty,\n    empty = [],\n    gOPD = Object.getOwnPropertyDescriptor,\n    gOPN = Object.getOwnPropertyNames,\n    gPO = Object.getPrototypeOf,\n    sPO = Object.setPrototypeOf,\n  \n    // jshint proto: true\n    hasProto = !!Object.__proto__,\n  \n    // V1 helpers\n    fixGetClass = false,\n    DRECEV1 = '__dreCEv1',\n    customElements = window.customElements,\n    usableCustomElements = polyfill !== 'force' && !!(\n      customElements &&\n      customElements.define &&\n      customElements.get &&\n      customElements.whenDefined\n    ),\n    Dict = Object.create || Object,\n    Map = window.Map || function Map() {\n      var K = [], V = [], i;\n      return {\n        get: function (k) {\n          return V[indexOf.call(K, k)];\n        },\n        set: function (k, v) {\n          i = indexOf.call(K, k);\n          if (i < 0) V[K.push(k) - 1] = v;\n          else V[i] = v;\n        }\n      };\n    },\n    Promise = window.Promise || function (fn) {\n      var\n        notify = [],\n        done = false,\n        p = {\n          'catch': function () {\n            return p;\n          },\n          'then': function (cb) {\n            notify.push(cb);\n            if (done) setTimeout(resolve, 1);\n            return p;\n          }\n        }\n      ;\n      function resolve(value) {\n        done = true;\n        while (notify.length) notify.shift()(value);\n      }\n      fn(resolve);\n      return p;\n    },\n    justCreated = false,\n    constructors = Dict(null),\n    waitingList = Dict(null),\n    nodeNames = new Map(),\n    secondArgument = function (is) {\n      return is.toLowerCase();\n    },\n  \n    // used to create unique instances\n    create = Object.create || function Bridge(proto) {\n      // silly broken polyfill probably ever used but short enough to work\n      return proto ? ((Bridge.prototype = proto), new Bridge()) : this;\n    },\n  \n    // will set the prototype if possible\n    // or copy over all properties\n    setPrototype = sPO || (\n      hasProto ?\n        function (o, p) {\n          o.__proto__ = p;\n          return o;\n        } : (\n      (gOPN && gOPD) ?\n        (function(){\n          function setProperties(o, p) {\n            for (var\n              key,\n              names = gOPN(p),\n              i = 0, length = names.length;\n              i < length; i++\n            ) {\n              key = names[i];\n              if (!hOP.call(o, key)) {\n                defineProperty(o, key, gOPD(p, key));\n              }\n            }\n          }\n          return function (o, p) {\n            do {\n              setProperties(o, p);\n            } while ((p = gPO(p)) && !iPO.call(p, o));\n            return o;\n          };\n        }()) :\n        function (o, p) {\n          for (var key in p) {\n            o[key] = p[key];\n          }\n          return o;\n        }\n    )),\n  \n    // DOM shortcuts and helpers, if any\n  \n    MutationObserver = window.MutationObserver ||\n                       window.WebKitMutationObserver,\n  \n    HTMLElementPrototype = (\n      window.HTMLElement ||\n      window.Element ||\n      window.Node\n    ).prototype,\n  \n    IE8 = !iPO.call(HTMLElementPrototype, documentElement),\n  \n    safeProperty = IE8 ? function (o, k, d) {\n      o[k] = d.value;\n      return o;\n    } : defineProperty,\n  \n    isValidNode = IE8 ?\n      function (node) {\n        return node.nodeType === 1;\n      } :\n      function (node) {\n        return iPO.call(HTMLElementPrototype, node);\n      },\n  \n    targets = IE8 && [],\n  \n    attachShadow = HTMLElementPrototype.attachShadow,\n    cloneNode = HTMLElementPrototype.cloneNode,\n    dispatchEvent = HTMLElementPrototype.dispatchEvent,\n    getAttribute = HTMLElementPrototype.getAttribute,\n    hasAttribute = HTMLElementPrototype.hasAttribute,\n    removeAttribute = HTMLElementPrototype.removeAttribute,\n    setAttribute = HTMLElementPrototype.setAttribute,\n  \n    // replaced later on\n    createElement = document.createElement,\n    patchedCreateElement = createElement,\n  \n    // shared observer for all attributes\n    attributesObserver = MutationObserver && {\n      attributes: true,\n      characterData: true,\n      attributeOldValue: true\n    },\n  \n    // useful to detect only if there's no MutationObserver\n    DOMAttrModified = MutationObserver || function(e) {\n      doesNotSupportDOMAttrModified = false;\n      documentElement.removeEventListener(\n        DOM_ATTR_MODIFIED,\n        DOMAttrModified\n      );\n    },\n  \n    // will both be used to make DOMNodeInserted asynchronous\n    asapQueue,\n    asapTimer = 0,\n  \n    // internal flags\n    V0 = REGISTER_ELEMENT in document,\n    setListener = true,\n    justSetup = false,\n    doesNotSupportDOMAttrModified = true,\n    dropDomContentLoaded = true,\n  \n    // needed for the innerHTML helper\n    notFromInnerHTMLHelper = true,\n  \n    // optionally defined later on\n    onSubtreeModified,\n    callDOMAttrModified,\n    getAttributesMirror,\n    observer,\n    observe,\n  \n    // based on setting prototype capability\n    // will check proto or the expando attribute\n    // in order to setup the node once\n    patchIfNotAlready,\n    patch\n  ;\n  \n  // only if needed\n  if (!V0) {\n  \n    if (sPO || hasProto) {\n        patchIfNotAlready = function (node, proto) {\n          if (!iPO.call(proto, node)) {\n            setupNode(node, proto);\n          }\n        };\n        patch = setupNode;\n    } else {\n        patchIfNotAlready = function (node, proto) {\n          if (!node[EXPANDO_UID]) {\n            node[EXPANDO_UID] = Object(true);\n            setupNode(node, proto);\n          }\n        };\n        patch = patchIfNotAlready;\n    }\n  \n    if (IE8) {\n      doesNotSupportDOMAttrModified = false;\n      (function (){\n        var\n          descriptor = gOPD(HTMLElementPrototype, ADD_EVENT_LISTENER),\n          addEventListener = descriptor.value,\n          patchedRemoveAttribute = function (name) {\n            var e = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true});\n            e.attrName = name;\n            e.prevValue = getAttribute.call(this, name);\n            e.newValue = null;\n            e[REMOVAL] = e.attrChange = 2;\n            removeAttribute.call(this, name);\n            dispatchEvent.call(this, e);\n          },\n          patchedSetAttribute = function (name, value) {\n            var\n              had = hasAttribute.call(this, name),\n              old = had && getAttribute.call(this, name),\n              e = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true})\n            ;\n            setAttribute.call(this, name, value);\n            e.attrName = name;\n            e.prevValue = had ? old : null;\n            e.newValue = value;\n            if (had) {\n              e[MODIFICATION] = e.attrChange = 1;\n            } else {\n              e[ADDITION] = e.attrChange = 0;\n            }\n            dispatchEvent.call(this, e);\n          },\n          onPropertyChange = function (e) {\n            // jshint eqnull:true\n            var\n              node = e.currentTarget,\n              superSecret = node[EXPANDO_UID],\n              propertyName = e.propertyName,\n              event\n            ;\n            if (superSecret.hasOwnProperty(propertyName)) {\n              superSecret = superSecret[propertyName];\n              event = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true});\n              event.attrName = superSecret.name;\n              event.prevValue = superSecret.value || null;\n              event.newValue = (superSecret.value = node[propertyName] || null);\n              if (event.prevValue == null) {\n                event[ADDITION] = event.attrChange = 0;\n              } else {\n                event[MODIFICATION] = event.attrChange = 1;\n              }\n              dispatchEvent.call(node, event);\n            }\n          }\n        ;\n        descriptor.value = function (type, handler, capture) {\n          if (\n            type === DOM_ATTR_MODIFIED &&\n            this[ATTRIBUTE_CHANGED_CALLBACK] &&\n            this.setAttribute !== patchedSetAttribute\n          ) {\n            this[EXPANDO_UID] = {\n              className: {\n                name: 'class',\n                value: this.className\n              }\n            };\n            this.setAttribute = patchedSetAttribute;\n            this.removeAttribute = patchedRemoveAttribute;\n            addEventListener.call(this, 'propertychange', onPropertyChange);\n          }\n          addEventListener.call(this, type, handler, capture);\n        };\n        defineProperty(HTMLElementPrototype, ADD_EVENT_LISTENER, descriptor);\n      }());\n    } else if (!MutationObserver) {\n      documentElement[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED, DOMAttrModified);\n      documentElement.setAttribute(EXPANDO_UID, 1);\n      documentElement.removeAttribute(EXPANDO_UID);\n      if (doesNotSupportDOMAttrModified) {\n        onSubtreeModified = function (e) {\n          var\n            node = this,\n            oldAttributes,\n            newAttributes,\n            key\n          ;\n          if (node === e.target) {\n            oldAttributes = node[EXPANDO_UID];\n            node[EXPANDO_UID] = (newAttributes = getAttributesMirror(node));\n            for (key in newAttributes) {\n              if (!(key in oldAttributes)) {\n                // attribute was added\n                return callDOMAttrModified(\n                  0,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  ADDITION\n                );\n              } else if (newAttributes[key] !== oldAttributes[key]) {\n                // attribute was changed\n                return callDOMAttrModified(\n                  1,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  MODIFICATION\n                );\n              }\n            }\n            // checking if it has been removed\n            for (key in oldAttributes) {\n              if (!(key in newAttributes)) {\n                // attribute removed\n                return callDOMAttrModified(\n                  2,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  REMOVAL\n                );\n              }\n            }\n          }\n        };\n        callDOMAttrModified = function (\n          attrChange,\n          currentTarget,\n          attrName,\n          prevValue,\n          newValue,\n          action\n        ) {\n          var e = {\n            attrChange: attrChange,\n            currentTarget: currentTarget,\n            attrName: attrName,\n            prevValue: prevValue,\n            newValue: newValue\n          };\n          e[action] = attrChange;\n          onDOMAttrModified(e);\n        };\n        getAttributesMirror = function (node) {\n          for (var\n            attr, name,\n            result = {},\n            attributes = node.attributes,\n            i = 0, length = attributes.length;\n            i < length; i++\n          ) {\n            attr = attributes[i];\n            name = attr.name;\n            if (name !== 'setAttribute') {\n              result[name] = attr.value;\n            }\n          }\n          return result;\n        };\n      }\n    }\n  \n    // set as enumerable, writable and configurable\n    document[REGISTER_ELEMENT] = function registerElement(type, options) {\n      upperType = type.toUpperCase();\n      if (setListener) {\n        // only first time document.registerElement is used\n        // we need to set this listener\n        // setting it by default might slow down for no reason\n        setListener = false;\n        if (MutationObserver) {\n          observer = (function(attached, detached){\n            function checkEmAll(list, callback) {\n              for (var i = 0, length = list.length; i < length; callback(list[i++])){}\n            }\n            return new MutationObserver(function (records) {\n              for (var\n                current, node, newValue,\n                i = 0, length = records.length; i < length; i++\n              ) {\n                current = records[i];\n                if (current.type === 'childList') {\n                  checkEmAll(current.addedNodes, attached);\n                  checkEmAll(current.removedNodes, detached);\n                } else {\n                  node = current.target;\n                  if (notFromInnerHTMLHelper &&\n                      node[ATTRIBUTE_CHANGED_CALLBACK] &&\n                      current.attributeName !== 'style') {\n                    newValue = getAttribute.call(node, current.attributeName);\n                    if (newValue !== current.oldValue) {\n                      node[ATTRIBUTE_CHANGED_CALLBACK](\n                        current.attributeName,\n                        current.oldValue,\n                        newValue\n                      );\n                    }\n                  }\n                }\n              }\n            });\n          }(executeAction(ATTACHED), executeAction(DETACHED)));\n          observe = function (node) {\n            observer.observe(\n              node,\n              {\n                childList: true,\n                subtree: true\n              }\n            );\n            return node;\n          };\n          observe(document);\n          if (attachShadow) {\n            HTMLElementPrototype.attachShadow = function () {\n              return observe(attachShadow.apply(this, arguments));\n            };\n          }\n        } else {\n          asapQueue = [];\n          document[ADD_EVENT_LISTENER]('DOMNodeInserted', onDOMNode(ATTACHED));\n          document[ADD_EVENT_LISTENER]('DOMNodeRemoved', onDOMNode(DETACHED));\n        }\n  \n        document[ADD_EVENT_LISTENER](DOM_CONTENT_LOADED, onReadyStateChange);\n        document[ADD_EVENT_LISTENER]('readystatechange', onReadyStateChange);\n  \n        HTMLElementPrototype.cloneNode = function (deep) {\n          var\n            node = cloneNode.call(this, !!deep),\n            i = getTypeIndex(node)\n          ;\n          if (-1 < i) patch(node, protos[i]);\n          if (deep && query.length) loopAndSetup(node.querySelectorAll(query));\n          return node;\n        };\n      }\n  \n      if (justSetup) return (justSetup = false);\n  \n      if (-2 < (\n        indexOf.call(types, PREFIX_IS + upperType) +\n        indexOf.call(types, PREFIX_TAG + upperType)\n      )) {\n        throwTypeError(type);\n      }\n  \n      if (!validName.test(upperType) || -1 < indexOf.call(invalidNames, upperType)) {\n        throw new Error('The type ' + type + ' is invalid');\n      }\n  \n      var\n        constructor = function () {\n          return extending ?\n            document.createElement(nodeName, upperType) :\n            document.createElement(nodeName);\n        },\n        opt = options || OP,\n        extending = hOP.call(opt, EXTENDS),\n        nodeName = extending ? options[EXTENDS].toUpperCase() : upperType,\n        upperType,\n        i\n      ;\n  \n      if (extending && -1 < (\n        indexOf.call(types, PREFIX_TAG + nodeName)\n      )) {\n        throwTypeError(nodeName);\n      }\n  \n      i = types.push((extending ? PREFIX_IS : PREFIX_TAG) + upperType) - 1;\n  \n      query = query.concat(\n        query.length ? ',' : '',\n        extending ? nodeName + '[is=\"' + type.toLowerCase() + '\"]' : nodeName\n      );\n  \n      constructor.prototype = (\n        protos[i] = hOP.call(opt, 'prototype') ?\n          opt.prototype :\n          create(HTMLElementPrototype)\n      );\n  \n      if (query.length) loopAndVerify(\n        document.querySelectorAll(query),\n        ATTACHED\n      );\n  \n      return constructor;\n    };\n  \n    document.createElement = (patchedCreateElement = function (localName, typeExtension) {\n      var\n        is = getIs(typeExtension),\n        node = is ?\n          createElement.call(document, localName, secondArgument(is)) :\n          createElement.call(document, localName),\n        name = '' + localName,\n        i = indexOf.call(\n          types,\n          (is ? PREFIX_IS : PREFIX_TAG) +\n          (is || name).toUpperCase()\n        ),\n        setup = -1 < i\n      ;\n      if (is) {\n        node.setAttribute('is', is = is.toLowerCase());\n        if (setup) {\n          setup = isInQSA(name.toUpperCase(), is);\n        }\n      }\n      notFromInnerHTMLHelper = !document.createElement.innerHTMLHelper;\n      if (setup) patch(node, protos[i]);\n      return node;\n    });\n  \n  }\n  \n  function ASAP() {\n    var queue = asapQueue.splice(0, asapQueue.length);\n    asapTimer = 0;\n    while (queue.length) {\n      queue.shift().call(\n        null, queue.shift()\n      );\n    }\n  }\n  \n  function loopAndVerify(list, action) {\n    for (var i = 0, length = list.length; i < length; i++) {\n      verifyAndSetupAndAction(list[i], action);\n    }\n  }\n  \n  function loopAndSetup(list) {\n    for (var i = 0, length = list.length, node; i < length; i++) {\n      node = list[i];\n      patch(node, protos[getTypeIndex(node)]);\n    }\n  }\n  \n  function executeAction(action) {\n    return function (node) {\n      if (isValidNode(node)) {\n        verifyAndSetupAndAction(node, action);\n        if (query.length) loopAndVerify(\n          node.querySelectorAll(query),\n          action\n        );\n      }\n    };\n  }\n  \n  function getTypeIndex(target) {\n    var\n      is = getAttribute.call(target, 'is'),\n      nodeName = target.nodeName.toUpperCase(),\n      i = indexOf.call(\n        types,\n        is ?\n            PREFIX_IS + is.toUpperCase() :\n            PREFIX_TAG + nodeName\n      )\n    ;\n    return is && -1 < i && !isInQSA(nodeName, is) ? -1 : i;\n  }\n  \n  function isInQSA(name, type) {\n    return -1 < query.indexOf(name + '[is=\"' + type + '\"]');\n  }\n  \n  function onDOMAttrModified(e) {\n    var\n      node = e.currentTarget,\n      attrChange = e.attrChange,\n      attrName = e.attrName,\n      target = e.target,\n      addition = e[ADDITION] || 2,\n      removal = e[REMOVAL] || 3\n    ;\n    if (notFromInnerHTMLHelper &&\n        (!target || target === node) &&\n        node[ATTRIBUTE_CHANGED_CALLBACK] &&\n        attrName !== 'style' && (\n          e.prevValue !== e.newValue ||\n          // IE9, IE10, and Opera 12 gotcha\n          e.newValue === '' && (\n            attrChange === addition ||\n            attrChange === removal\n          )\n    )) {\n      node[ATTRIBUTE_CHANGED_CALLBACK](\n        attrName,\n        attrChange === addition ? null : e.prevValue,\n        attrChange === removal ? null : e.newValue\n      );\n    }\n  }\n  \n  function onDOMNode(action) {\n    var executor = executeAction(action);\n    return function (e) {\n      asapQueue.push(executor, e.target);\n      if (asapTimer) clearTimeout(asapTimer);\n      asapTimer = setTimeout(ASAP, 1);\n    };\n  }\n  \n  function onReadyStateChange(e) {\n    if (dropDomContentLoaded) {\n      dropDomContentLoaded = false;\n      e.currentTarget.removeEventListener(DOM_CONTENT_LOADED, onReadyStateChange);\n    }\n    if (query.length) loopAndVerify(\n      (e.target || document).querySelectorAll(query),\n      e.detail === DETACHED ? DETACHED : ATTACHED\n    );\n    if (IE8) purge();\n  }\n  \n  function patchedSetAttribute(name, value) {\n    // jshint validthis:true\n    var self = this;\n    setAttribute.call(self, name, value);\n    onSubtreeModified.call(self, {target: self});\n  }\n  \n  function setupNode(node, proto) {\n    setPrototype(node, proto);\n    if (observer) {\n      observer.observe(node, attributesObserver);\n    } else {\n      if (doesNotSupportDOMAttrModified) {\n        node.setAttribute = patchedSetAttribute;\n        node[EXPANDO_UID] = getAttributesMirror(node);\n        node[ADD_EVENT_LISTENER](DOM_SUBTREE_MODIFIED, onSubtreeModified);\n      }\n      node[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED, onDOMAttrModified);\n    }\n    if (node[CREATED_CALLBACK] && notFromInnerHTMLHelper) {\n      node.created = true;\n      node[CREATED_CALLBACK]();\n      node.created = false;\n    }\n  }\n  \n  function purge() {\n    for (var\n      node,\n      i = 0,\n      length = targets.length;\n      i < length; i++\n    ) {\n      node = targets[i];\n      if (!documentElement.contains(node)) {\n        length--;\n        targets.splice(i--, 1);\n        verifyAndSetupAndAction(node, DETACHED);\n      }\n    }\n  }\n  \n  function throwTypeError(type) {\n    throw new Error('A ' + type + ' type is already registered');\n  }\n  \n  function verifyAndSetupAndAction(node, action) {\n    var\n      fn,\n      i = getTypeIndex(node)\n    ;\n    if (-1 < i) {\n      patchIfNotAlready(node, protos[i]);\n      i = 0;\n      if (action === ATTACHED && !node[ATTACHED]) {\n        node[DETACHED] = false;\n        node[ATTACHED] = true;\n        i = 1;\n        if (IE8 && indexOf.call(targets, node) < 0) {\n          targets.push(node);\n        }\n      } else if (action === DETACHED && !node[DETACHED]) {\n        node[ATTACHED] = false;\n        node[DETACHED] = true;\n        i = 1;\n      }\n      if (i && (fn = node[action + CALLBACK])) fn.call(node);\n    }\n  }\n  \n  \n  \n  // V1 in da House!\n  function CustomElementRegistry() {}\n  \n  CustomElementRegistry.prototype = {\n    constructor: CustomElementRegistry,\n    // a workaround for the stubborn WebKit\n    define: usableCustomElements ?\n      function (name, Class, options) {\n        if (options) {\n          CERDefine(name, Class, options);\n        } else {\n          var NAME = name.toUpperCase();\n          constructors[NAME] = {\n            constructor: Class,\n            create: [NAME]\n          };\n          nodeNames.set(Class, NAME);\n          customElements.define(name, Class);\n        }\n      } :\n      CERDefine,\n    get: usableCustomElements ?\n      function (name) {\n        return customElements.get(name) || get(name);\n      } :\n      get,\n    whenDefined: usableCustomElements ?\n      function (name) {\n        return Promise.race([\n          customElements.whenDefined(name),\n          whenDefined(name)\n        ]);\n      } :\n      whenDefined\n  };\n  \n  function CERDefine(name, Class, options) {\n    var\n      is = options && options[EXTENDS] || '',\n      CProto = Class.prototype,\n      proto = create(CProto),\n      attributes = Class.observedAttributes || empty,\n      definition = {prototype: proto}\n    ;\n    // TODO: is this needed at all since it's inherited?\n    // defineProperty(proto, 'constructor', {value: Class});\n    safeProperty(proto, CREATED_CALLBACK, {\n        value: function () {\n          if (justCreated) justCreated = false;\n          else if (!this[DRECEV1]) {\n            this[DRECEV1] = true;\n            new Class(this);\n            if (CProto[CREATED_CALLBACK])\n              CProto[CREATED_CALLBACK].call(this);\n            var info = constructors[nodeNames.get(Class)];\n            if (!usableCustomElements || info.create.length > 1) {\n              notifyAttributes(this);\n            }\n          }\n      }\n    });\n    safeProperty(proto, ATTRIBUTE_CHANGED_CALLBACK, {\n      value: function (name) {\n        if (-1 < indexOf.call(attributes, name))\n          CProto[ATTRIBUTE_CHANGED_CALLBACK].apply(this, arguments);\n      }\n    });\n    if (CProto[CONNECTED_CALLBACK]) {\n      safeProperty(proto, ATTACHED_CALLBACK, {\n        value: CProto[CONNECTED_CALLBACK]\n      });\n    }\n    if (CProto[DISCONNECTED_CALLBACK]) {\n      safeProperty(proto, DETACHED_CALLBACK, {\n        value: CProto[DISCONNECTED_CALLBACK]\n      });\n    }\n    if (is) definition[EXTENDS] = is;\n    name = name.toUpperCase();\n    constructors[name] = {\n      constructor: Class,\n      create: is ? [is, secondArgument(name)] : [name]\n    };\n    nodeNames.set(Class, name);\n    document[REGISTER_ELEMENT](name.toLowerCase(), definition);\n    whenDefined(name);\n    waitingList[name].r();\n  }\n  \n  function get(name) {\n    var info = constructors[name.toUpperCase()];\n    return info && info.constructor;\n  }\n  \n  function getIs(options) {\n    return typeof options === 'string' ?\n        options : (options && options.is || '');\n  }\n  \n  function notifyAttributes(self) {\n    var\n      callback = self[ATTRIBUTE_CHANGED_CALLBACK],\n      attributes = callback ? self.attributes : empty,\n      i = attributes.length,\n      attribute\n    ;\n    while (i--) {\n      attribute =  attributes[i]; // || attributes.item(i);\n      callback.call(\n        self,\n        attribute.name || attribute.nodeName,\n        null,\n        attribute.value || attribute.nodeValue\n      );\n    }\n  }\n  \n  function whenDefined(name) {\n    name = name.toUpperCase();\n    if (!(name in waitingList)) {\n      waitingList[name] = {};\n      waitingList[name].p = new Promise(function (resolve) {\n        waitingList[name].r = resolve;\n      });\n    }\n    return waitingList[name].p;\n  }\n  \n  function polyfillV1() {\n    if (customElements) delete window.customElements;\n    defineProperty(window, 'customElements', {\n      configurable: true,\n      value: new CustomElementRegistry()\n    });\n    defineProperty(window, 'CustomElementRegistry', {\n      configurable: true,\n      value: CustomElementRegistry\n    });\n    for (var\n      patchClass = function (name) {\n        var Class = window[name];\n        if (Class) {\n          window[name] = function CustomElementsV1(self) {\n            var info, isNative;\n            if (!self) self = this;\n            if (!self[DRECEV1]) {\n              justCreated = true;\n              info = constructors[nodeNames.get(self.constructor)];\n              isNative = usableCustomElements && info.create.length === 1;\n              self = isNative ?\n                Reflect.construct(Class, empty, info.constructor) :\n                document.createElement.apply(document, info.create);\n              self[DRECEV1] = true;\n              justCreated = false;\n              if (!isNative) notifyAttributes(self);\n            }\n            return self;\n          };\n          window[name].prototype = Class.prototype;\n          try {\n            Class.prototype.constructor = window[name];\n          } catch(WebKit) {\n            fixGetClass = true;\n            defineProperty(Class, DRECEV1, {value: window[name]});\n          }\n        }\n      },\n      Classes = htmlClass.get(/^HTML[A-Z]*[a-z]/),\n      i = Classes.length;\n      i--;\n      patchClass(Classes[i])\n    ) {}\n    (document.createElement = function (name, options) {\n      var is = getIs(options);\n      return is ?\n        patchedCreateElement.call(this, name, secondArgument(is)) :\n        patchedCreateElement.call(this, name);\n    });\n    if (!V0) {\n      justSetup = true;\n      document[REGISTER_ELEMENT]('');\n    }\n  }\n  \n  // if customElements is not there at all\n  if (!customElements || polyfill === 'force') polyfillV1();\n  else {\n    // if available test extends work as expected\n    try {\n      (function (DRE, options, name) {\n        options[EXTENDS] = 'a';\n        DRE.prototype = create(HTMLAnchorElement.prototype);\n        DRE.prototype.constructor = DRE;\n        window.customElements.define(name, DRE, options);\n        if (\n          getAttribute.call(document.createElement('a', {is: name}), 'is') !== name ||\n          (usableCustomElements && getAttribute.call(new DRE(), 'is') !== name)\n        ) {\n          throw options;\n        }\n      }(\n        function DRE() {\n          return Reflect.construct(HTMLAnchorElement, [], DRE);\n        },\n        {},\n        'document-register-element-a'\n      ));\n    } catch(o_O) {\n      // or force the polyfill if not\n      // and keep internal original reference\n      polyfillV1();\n    }\n  }\n  \n  try {\n    createElement.call(document, 'a', 'a');\n  } catch(FireFox) {\n    secondArgument = function (is) {\n      return {is: is.toLowerCase()};\n    };\n  }\n  \n}\n\nexports.installCustomElements = installCustomElements;\n\n","'use strict';\n\n/**\n * Constructs a ES6/Promises A+ Promise instance.\n *\n * @constructor\n * @param {function(function(*=), function (*=))} resolver\n */\nfunction Promise(resolver) {\n  if (!(this instanceof Promise)) {\n    throw new TypeError('Constructor Promise requires `new`');\n  }\n  if (!isFunction(resolver)) {\n    throw new TypeError('Must pass resolver function');\n  }\n\n  /**\n   * @type {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise}\n   * @private\n   */\n  this._state = PendingPromise;\n\n  /**\n   * @type {*}\n   * @private\n   */\n  this._value = [];\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this._isChainEnd = true;\n\n  doResolve(\n    this,\n    adopter(this, FulfilledPromise),\n    adopter(this, RejectedPromise),\n    { then: resolver }\n  );\n}\n\n/****************************\n  Public Instance Methods\n ****************************/\n\n/**\n * Creates a new promise instance that will receive the result of this promise\n * as inputs to the onFulfilled or onRejected callbacks.\n *\n * @param {function(*)} onFulfilled\n * @param {function(*)} onRejected\n */\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  onFulfilled = isFunction(onFulfilled) ? onFulfilled : void 0;\n  onRejected = isFunction(onRejected) ? onRejected : void 0;\n\n  if (onFulfilled || onRejected) {\n    this._isChainEnd = false;\n  }\n\n  return this._state(\n    this._value,\n    onFulfilled,\n    onRejected\n  );\n};\n\n/**\n * Creates a new promise that will handle the rejected state of this promise.\n *\n * @param {function(*)} onRejected\n * @returns {!Promise}\n */\nPromise.prototype.catch = function(onRejected) {\n  return this.then(void 0, onRejected);\n};\n\n/****************************\n  Public Static Methods\n ****************************/\n\n/**\n * Creates a fulfilled Promise of value. If value is itself a then-able,\n * resolves with the then-able's value.\n *\n * @this {!Promise}\n * @param {*=} value\n * @returns {!Promise}\n */\nPromise.resolve = function(value) {\n  var Constructor = this;\n  var promise;\n\n  if (isObject(value) && value instanceof this) {\n    promise = value;\n  } else {\n    promise = new Constructor(function(resolve) {\n      resolve(value);\n    });\n  }\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a rejected Promise of reason.\n *\n * @this {!Promise}\n * @param {*=} reason\n * @returns {!Promise}\n */\nPromise.reject = function(reason) {\n  var Constructor = this;\n  var promise = new Constructor(function(_, reject) {\n    reject(reason);\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve with an array of the values of the\n * passed in promises. If any promise rejects, the returned promise will\n * reject.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.all = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    var length = promises.length;\n    var values = new Array(length);\n\n    if (length === 0) {\n      return resolve(values);\n    }\n\n    each(promises, function(promise, index) {\n      Constructor.resolve(promise).then(function(value) {\n        values[index] = value;\n        if (--length === 0) {\n          resolve(values);\n        }\n      }, reject);\n    });\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve or reject based on the first\n * resolved or rejected promise.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.race = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    for (var i = 0; i < promises.length; i++) {\n      Constructor.resolve(promises[i]).then(resolve, reject);\n    }\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\nvar onPossiblyUnhandledRejection = function(reason, promise) {\n  throw reason;\n};\n\n/**\n * An internal use static function.\n */\nPromise._overrideUnhandledExceptionHandler = function(handler) {\n  onPossiblyUnhandledRejection = handler;\n};\n\n/****************************\n  Private functions\n ****************************/\n\n/**\n * The Fulfilled Promise state. Calls onFulfilled with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onFulfilled, returns the current promise to avoid an promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} value The current promise's resolved value.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} unused\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Fulfilled state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction FulfilledPromise(value, onFulfilled, unused, deferred) {\n  if (!onFulfilled) {\n    deferredAdopt(deferred, FulfilledPromise, value);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onFulfilled, value));\n  return deferred.promise;\n}\n\n/**\n * The Rejected Promise state. Calls onRejected with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onRejected, returns the current promise to avoid an promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} reason The current promise's rejection reason.\n * @param {function(*=)=} unused\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Rejected state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction RejectedPromise(reason, unused, onRejected, deferred) {\n  if (!onRejected) {\n    deferredAdopt(deferred, RejectedPromise, reason);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onRejected, reason));\n  return deferred.promise;\n}\n\n/**\n * The Pending Promise state. Eventually calls onFulfilled once the promise has\n * resolved, or onRejected once the promise rejects.\n *\n * If there is no onFulfilled and no onRejected, returns the current promise to\n * avoid an promise instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} queue The current promise's pending promises queue.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Pending state from the\n *     Pending state of another promise.\n * @returns {!Promise}\n */\nfunction PendingPromise(queue, onFulfilled, onRejected, deferred) {\n  if (!deferred) {\n    if (!onFulfilled && !onRejected) { return this; }\n    deferred = new Deferred(this.constructor);\n  }\n  queue.push({\n    deferred: deferred,\n    onFulfilled: onFulfilled || deferred.resolve,\n    onRejected: onRejected || deferred.reject\n  });\n  return deferred.promise;\n}\n\n/**\n * Constructs a deferred instance that holds a promise and its resolve and\n * reject functions.\n *\n * @constructor\n */\nfunction Deferred(Promise) {\n  var deferred = this;\n  /** @type {!Promise} */\n  this.promise = new Promise(function(resolve, reject) {\n    /** @type {function(*=)} */\n    deferred.resolve = resolve;\n\n    /** @type {function(*=)} */\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n\n/**\n * Transitions the state of promise to another state. This is only ever called\n * on with a promise that is currently in the Pending state.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction adopt(promise, state, value, adoptee) {\n  var queue = promise._value;\n  promise._state = state;\n  promise._value = value;\n\n  if (adoptee && state === PendingPromise) {\n    adoptee._state(value, void 0, void 0, {\n      promise: promise,\n      resolve: void 0,\n      reject: void 0\n    });\n  }\n\n  for (var i = 0; i < queue.length; i++) {\n    var next = queue[i];\n    promise._state(\n      value,\n      next.onFulfilled,\n      next.onRejected,\n      next.deferred\n    );\n  }\n  queue.length = 0;\n\n  // Determine if this rejected promise will be \"handled\".\n  if (state === RejectedPromise && promise._isChainEnd) {\n    setTimeout(function() {\n      if (promise._isChainEnd) {\n        onPossiblyUnhandledRejection(value, promise);\n      }\n    }, 0);\n  }\n}\n\n/**\n * A partial application of adopt.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @returns {function(*=)}\n */\nfunction adopter(promise, state) {\n  return function(value) {\n    adopt(promise, state, value);\n  };\n}\n\n/**\n * Updates a deferred promises state. Necessary for updating an adopting\n * promise's state when the adoptee resolves.\n *\n * @param {?Deferred} deferred\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction deferredAdopt(deferred, state, value) {\n  if (deferred) {\n    var promise = deferred.promise;\n    promise._state = state;\n    promise._value = value;\n  }\n}\n\n/**\n * A no-op function to prevent double resolving.\n */\nfunction noop() {}\n\n/**\n * Tests if fn is a Function\n *\n * @param {*} fn\n * @returns {boolean}\n */\nfunction isFunction(fn) {\n  return typeof fn === 'function';\n}\n\n/**\n * Tests if fn is an Object\n *\n * @param {*} obj\n * @returns {boolean}\n */\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n/**\n * Iterates over each element of an array, calling the iterator with the\n * element and its index.\n *\n * @param {!Array} collection\n * @param {function(*=,number)} iterator\n */\nfunction each(collection, iterator) {\n  for (var i = 0; i < collection.length; i++) {\n    iterator(collection[i], i);\n  }\n}\n\n/**\n * Creates a function that will attempt to resolve the deferred with the return\n * of fn. If any error is raised, rejects instead.\n *\n * @param {!Deferred} deferred\n * @param {function(*=)} fn\n * @param {*} arg\n * @returns {function()}\n */\nfunction tryCatchDeferred(deferred, fn, arg) {\n  var promise = deferred.promise;\n  var resolve = deferred.resolve;\n  var reject = deferred.reject;\n  return function() {\n    try {\n      var result = fn(arg);\n      doResolve(promise, resolve, reject, result, result);\n    } catch (e) {\n      reject(e);\n    }\n  };\n}\n\n/**\n * Queues and executes multiple deferred functions on another run loop.\n */\nvar defer = (function() {\n  /**\n   * Defers fn to another run loop.\n   */\n  var scheduleFlush;\n  if (typeof window !== 'undefined' && window.postMessage) {\n    window.addEventListener('message', flush);\n    scheduleFlush = function() {\n      window.postMessage('macro-task', '*');\n    };\n  } else {\n    scheduleFlush = function() {\n      setTimeout(flush, 0);\n    };\n  }\n\n  var queue = new Array(16);\n  var length = 0;\n\n  function flush() {\n    for (var i = 0; i < length; i++) {\n      var fn = queue[i];\n      queue[i] = null;\n      fn();\n    }\n    length = 0;\n  }\n\n  /**\n   * @param {function()} fn\n   */\n  function defer(fn) {\n    if (length === 0) { scheduleFlush(); }\n    queue[length++] = fn;\n  }\n\n  return defer;\n})();\n\n/**\n * The Promise resolution procedure.\n * https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n *\n * @param {!Promise} promise\n * @param {function(*=)} resolve\n * @param {function(*=)} reject\n * @param {*} value\n * @param {*=} context\n */\nfunction doResolve(promise, resolve, reject, value, context) {\n  var _reject = reject;\n  var then;\n  var _resolve;\n  try {\n    if (value === promise) {\n      throw new TypeError('Cannot fulfill promise with itself');\n    }\n    var isObj = isObject(value);\n    if (isObj && value instanceof promise.constructor) {\n      adopt(promise, value._state, value._value, value);\n    } else if (isObj && (then = value.then) && isFunction(then)) {\n      _resolve = function(value) {\n        _resolve = _reject = noop;\n        doResolve(promise, resolve, reject, value, value);\n      };\n      _reject = function(reason) {\n        _resolve = _reject = noop;\n        reject(reason);\n      };\n      then.call(\n        context,\n        function(value) { _resolve(value); },\n        function(reason) { _reject(reason); }\n      );\n    } else {\n      resolve(value);\n    }\n  } catch (e) {\n    _reject(e);\n  }\n}\n\nmodule.exports = Promise;\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from './services';\n\n/**\n * Helper method to trigger analytics event if amp-analytics is available.\n * TODO: Do not expose this function\n * @param {!Element} target\n * @param {string} eventType\n * @param {!Object<string, string>=} opt_vars A map of vars and their values.\n */\nexport function triggerAnalyticsEvent(target, eventType, opt_vars) {\n  Services.analyticsForDocOrNull(target).then(analytics => {\n    if (!analytics) {\n      return;\n    }\n    analytics.triggerEventForTarget(target, eventType, opt_vars);\n  });\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Commonly used signals across different elements and documents.\n * @enum {string}\n */\nexport const CommonSignals = {\n\n  /**\n   * The element has been built.\n   */\n  BUILT: 'built',\n\n  /**\n   * The initial contents of an element/document/embed have been loaded.\n   */\n  INI_LOAD: 'ini-load',\n\n  /**\n   * The element has been loaded.\n   */\n  LOAD_END: 'load-end',\n\n  /**\n   * The element has started loading.\n   */\n  LOAD_START: 'load-start',\n\n  /**\n   * Rendering has been confirmed to have been started.\n   */\n  RENDER_START: 'render-start',\n\n  /**\n   * The element has been unlaid out.\n   */\n  UNLOAD: 'unload',\n};\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Allows for runtime configuration. Internally, the runtime should\n * use the src/config.js module for various constants. We can use the\n * AMP_CONFIG global to translate user-defined configurations to this\n * module.\n * @type {!Object<string, string>}\n */\nconst env = self.AMP_CONFIG || {};\n\nconst thirdPartyFrameRegex = typeof env['thirdPartyFrameRegex'] == 'string' ?\n  new RegExp(env['thirdPartyFrameRegex']) : env['thirdPartyFrameRegex'];\n\nconst cdnProxyRegex = typeof env['cdnProxyRegex'] == 'string' ?\n  new RegExp(env['cdnProxyRegex']) : env['cdnProxyRegex'];\n\n/** @type {!Object<string, string|boolean|RegExp>} */\nexport const urls = {\n  thirdParty: env['thirdPartyUrl'] || 'https://3p.ampproject.net',\n  thirdPartyFrameHost: env['thirdPartyFrameHost'] || 'ampproject.net',\n  thirdPartyFrameRegex: thirdPartyFrameRegex || /^d-\\d+\\.ampproject\\.net$/,\n  cdn: env['cdnUrl'] || 'https://cdn.ampproject.org',\n  /* Note that cdnProxyRegex is only ever checked against origins\n   * (proto://host[:port]) so does not need to consider path\n   */\n  cdnProxyRegex: cdnProxyRegex ||\n      /^https:\\/\\/([a-zA-Z0-9_-]+\\.)?cdn\\.ampproject\\.org$/,\n  localhostRegex: /^https?:\\/\\/localhost(:\\d+)?$/,\n  errorReporting: env['errorReportingUrl'] ||\n      'https://amp-error-reporting.appspot.com/r',\n  localDev: env['localDev'] || false,\n};\n\nexport const config = {\n  urls,\n};\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {endsWith} from './string';\nimport {\n  isProxyOrigin,\n  parseUrlDeprecated,\n  tryDecodeUriComponent,\n} from './url';\nimport {urls} from './config';\n\n\n/**\n * Returns the value of the cookie. The cookie access is restricted and must\n * go through the privacy review. Before using this method please file a\n * GitHub issue with \"Privacy Review\" label.\n *\n * Returns the cookie's value or `null`.\n *\n * @param {!Window} win\n * @param {string} name\n * @return {?string}\n */\nexport function getCookie(win, name) {\n  const cookieString = tryGetDocumentCookieNoInline(win);\n  if (!cookieString) {\n    return null;\n  }\n  const cookies = cookieString.split(';');\n  for (let i = 0; i < cookies.length; i++) {\n    const cookie = cookies[i].trim();\n    const eq = cookie.indexOf('=');\n    if (eq == -1) {\n      continue;\n    }\n    if (tryDecodeUriComponent(cookie.substring(0, eq).trim()) == name) {\n      const value = cookie.substring(eq + 1).trim();\n      return tryDecodeUriComponent(value, value);\n    }\n  }\n  return null;\n}\n\n/**\n * This method should not be inlined to prevent TryCatch deoptimization.\n * NoInline keyword at the end of function name also prevents Closure compiler\n * from inlining the function.\n * @param {!Window} win\n * @return {string}\n */\nfunction tryGetDocumentCookieNoInline(win) {\n  try {\n    return win.document.cookie;\n  } catch (e) {\n    // Act as if no cookie is available. Exceptions can be thrown when\n    // AMP docs are opened on origins that do not allow setting\n    // cookies such as null origins.\n    return '';\n  }\n}\n\n/**\n * Sets the value of the cookie. The cookie access is restricted and must\n * go through the privacy review. Before using this method please file a\n * GitHub issue with \"Privacy Review\" label.\n *\n * @param {!Window} win\n * @param {string} name\n * @param {string} value\n * @param {time} expirationTime\n * @param {{\n *   highestAvailableDomain:(boolean|undefined),\n *   domain:(string|undefined)\n * }=} opt_options\n *     - highestAvailableDomain: If true, set the cookie at the widest domain\n *       scope allowed by the browser. E.g. on example.com if we are currently\n *       on www.example.com.\n *     - domain: Explicit domain to set.\n *     - allowOnProxyOrigin: Allow setting a cookie on the AMP Cache.\n */\nexport function setCookie(win, name, value, expirationTime, opt_options) {\n  checkOriginForSettingCookie(win, opt_options, name);\n  if (opt_options && opt_options.highestAvailableDomain) {\n    const parts = win.location.hostname.split('.');\n    let domain = parts[parts.length - 1];\n    for (let i = parts.length - 2; i >= 0; i--) {\n      domain = parts[i] + '.' + domain;\n      trySetCookie(win, name, value, expirationTime, domain);\n      if (getCookie(win, name) == value) {\n        return;\n      }\n    }\n  }\n  let domain = undefined;\n  if (opt_options && opt_options.domain) {\n    domain = opt_options.domain;\n  }\n  trySetCookie(win, name, value, expirationTime, domain);\n}\n\n/**\n * Attempt to set a cookie with the given params.\n *\n * @param {!Window} win\n * @param {string} name\n * @param {string} value\n * @param {time} expirationTime\n * @param {string|undefined} domain\n */\nfunction trySetCookie(win, name, value, expirationTime, domain) {\n  // We do not allow setting cookies on the domain that contains both\n  // the cdn. and www. hosts.\n  if (domain == 'ampproject.org') {\n    // Actively delete them.\n    value = 'delete';\n    expirationTime = 0;\n  }\n  const cookie = encodeURIComponent(name) + '=' +\n      encodeURIComponent(value) +\n      '; path=/' +\n      (domain ? '; domain=' + domain : '') +\n      '; expires=' + new Date(expirationTime).toUTCString();\n  try {\n    win.document.cookie = cookie;\n  } catch (ignore) {\n    // Do not throw if setting the cookie failed Exceptions can be thrown\n    // when AMP docs are opened on origins that do not allow setting\n    // cookies such as null origins.\n  }\n}\n\n/**\n * Throws if a given cookie should not be set on the given origin.\n * This is a defense-in-depth. Callers should never run into this.\n *\n * @param {!Window} win\n * @param {!Object|undefined} options\n * @param {string} name For the error message.\n */\nfunction checkOriginForSettingCookie(win, options, name) {\n  if (options && options.allowOnProxyOrigin) {\n    return;\n  }\n  if (isProxyOrigin(win.location.href)) {\n    throw new Error('Should never attempt to set cookie on proxy origin: '\n        + name);\n  }\n\n  const current = parseUrlDeprecated(win.location.href).hostname.toLowerCase();\n  const proxy = parseUrlDeprecated(urls.cdn).hostname.toLowerCase();\n  if (current == proxy || endsWith(current, '.' + proxy)) {\n    throw new Error('Should never attempt to set cookie on proxy origin.'\n        + ' (in depth check): ' + name);\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Deferred} from './utils/promise';\nimport {cssEscape} from '../third_party/css-escape/css-escape';\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {startsWith} from './string';\nimport {toWin} from './types';\n\nconst HTML_ESCAPE_CHARS = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;',\n};\nconst HTML_ESCAPE_REGEX = /(&|<|>|\"|'|`)/g;\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_PROMISE =\n    '__AMP_UPG_PRM';\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_RESOLVER =\n    '__AMP_UPG_RES';\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * callback is executed.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @param {function()} callback\n */\nexport function waitForChild(parent, checkFunc, callback) {\n  if (checkFunc(parent)) {\n    callback();\n    return;\n  }\n  /** @const {!Window} */\n  const win = toWin(parent.ownerDocument.defaultView);\n  if (win.MutationObserver) {\n    /** @const {MutationObserver} */\n    const observer = new win.MutationObserver(() => {\n      if (checkFunc(parent)) {\n        observer.disconnect();\n        callback();\n      }\n    });\n    observer.observe(parent, {childList: true});\n  } else {\n    /** @const {number} */\n    const interval = win.setInterval(() => {\n      if (checkFunc(parent)) {\n        win.clearInterval(interval);\n        callback();\n      }\n    }, /* milliseconds */ 5);\n  }\n}\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * promise is resolved.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @return {!Promise}\n */\nexport function waitForChildPromise(parent, checkFunc) {\n  return new Promise(resolve => {\n    waitForChild(parent, checkFunc, resolve);\n  });\n}\n\n/**\n * Waits for document's body to be available.\n * Will be deprecated soon; use {@link AmpDoc#whenBodyAvailable} or\n * @{link DocumentState#onBodyAvailable} instead.\n * @param {!Document} doc\n * @param {function()} callback\n */\nexport function waitForBody(doc, callback) {\n  waitForChild(doc.documentElement, () => !!doc.body, callback);\n}\n\n\n/**\n * Waits for document's body to be available.\n * @param {!Document} doc\n * @return {!Promise}\n */\nexport function waitForBodyPromise(doc) {\n  return new Promise(resolve => {\n    waitForBody(doc, resolve);\n  });\n}\n\n\n/**\n * Removes the element.\n * @param {!Element} element\n */\nexport function removeElement(element) {\n  if (element.parentElement) {\n    element.parentElement.removeChild(element);\n  }\n}\n\n\n/**\n * Removes all child nodes of the specified element.\n * @param {!Element} parent\n */\nexport function removeChildren(parent) {\n  while (parent.firstChild) {\n    parent.removeChild(parent.firstChild);\n  }\n}\n\n\n/**\n * Copies all children nodes of element \"from\" to element \"to\". Child nodes\n * are deeply cloned. Notice, that this method should be used with care and\n * preferably on smaller subtrees.\n * @param {!Element} from\n * @param {!Element|!DocumentFragment} to\n */\nexport function copyChildren(from, to) {\n  const frag = to.ownerDocument.createDocumentFragment();\n  for (let n = from.firstChild; n; n = n.nextSibling) {\n    frag.appendChild(n.cloneNode(true));\n  }\n  to.appendChild(frag);\n}\n\n/**\n * Insert the element in the root after the element named after or\n * if that is null at the beginning.\n * @param {!Element|!ShadowRoot} root\n * @param {!Element} element\n * @param {?Node} after\n */\nexport function insertAfterOrAtStart(root, element, after) {\n  const before = after ? after.nextSibling : root.firstChild;\n  root.insertBefore(element, before);\n}\n\n/**\n * Add attributes to an element.\n * @param {!Element} element\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function addAttributesToElement(element, attributes) {\n  for (const attr in attributes) {\n    element.setAttribute(attr, attributes[attr]);\n  }\n  return element;\n}\n\n/**\n * Create a new element on document with specified tagName and attributes.\n * @param {!Document} doc\n * @param {string} tagName\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function createElementWithAttributes(doc, tagName, attributes) {\n  const element = doc.createElement(tagName);\n  return addAttributesToElement(element, attributes);\n}\n\n/**\n * Returns true if node is connected (attached).\n * @param {!Node} node\n * @return {boolean}\n * @see https://dom.spec.whatwg.org/#connected\n */\nexport function isConnectedNode(node) {\n  const connected = node.isConnected;\n  if (connected !== undefined) {\n    return connected;\n  }\n\n  // \"An element is connected if its shadow-including root is a document.\"\n  let n = node;\n  do {\n    n = rootNodeFor(n);\n    if (n.host) {\n      n = n.host;\n    } else {\n      break;\n    }\n  } while (true);\n  return n.nodeType === Node.DOCUMENT_NODE;\n}\n\n/**\n * Returns the root for a given node. Does not cross shadow DOM boundary.\n * @param {!Node} node\n * @return {!Node}\n */\nexport function rootNodeFor(node) {\n  if (Node.prototype.getRootNode) {\n    // Type checker says `getRootNode` may return null.\n    return node.getRootNode() || node;\n  }\n  let n;\n  for (n = node; !!n.parentNode; n = n.parentNode) {}\n  return n;\n}\n\n/**\n * Finds the closest element that satisfies the callback from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {function(!Element):boolean} callback\n * @param {Element=} opt_stopAt optional elemnt to stop the search at.\n * @return {?Element}\n */\nexport function closest(element, callback, opt_stopAt) {\n  for (let el = element; el && el !== opt_stopAt; el = el.parentElement) {\n    if (callback(el)) {\n      return el;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest node that satisfies the callback from this node\n * up the DOM subtree.\n * @param {!Node} node\n * @param {function(!Node):boolean} callback\n * @return {?Node}\n */\nexport function closestNode(node, callback) {\n  for (let n = node; n; n = n.parentNode) {\n    if (callback(n)) {\n      return n;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest element with the specified name from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function closestByTag(element, tagName) {\n  if (element.closest) {\n    return element.closest(tagName);\n  }\n  tagName = tagName.toUpperCase();\n  return closest(element, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Finds the closest element with the specified selector from this element\n * @param {!Element} element\n * @param {string} selector\n * @return {?Element} closest ancestor if found.\n */\nexport function closestBySelector(element, selector) {\n  if (element.closest) {\n    return element.closest(selector);\n  }\n\n  return closest(element, el => {\n    return matches(el, selector);\n  });\n}\n\n/**\n * Checks if the given element matches the selector\n * @param  {!Element} el The element to verify\n * @param  {string} selector The selector to check against\n * @return {boolean} True if the element matched the selector. False otherwise.\n */\nexport function matches(el, selector) {\n  const matcher = el.matches ||\n      el.webkitMatchesSelector ||\n      el.mozMatchesSelector ||\n      el.msMatchesSelector ||\n      el.oMatchesSelector;\n  if (matcher) {\n    return matcher.call(el, selector);\n  }\n  return false; // IE8 always returns false.\n}\n\n/**\n * Finds the first descendant element with the specified name.\n * @param {!Element|!Document|!ShadowRoot} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function elementByTag(element, tagName) {\n  let elements;\n  // getElementsByTagName() is not supported on ShadowRoot.\n  if (typeof element.getElementsByTagName === 'function') {\n    elements = element.getElementsByTagName(tagName);\n  } else {\n    elements = element./*OK*/querySelectorAll(tagName);\n  }\n  return (elements && elements[0]) || null;\n}\n\n\n/**\n * Finds the first child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function childElement(parent, callback) {\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds all child elements that satisfy the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {!Array<!Element>}\n */\nexport function childElements(parent, callback) {\n  const children = [];\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      children.push(child);\n    }\n  }\n  return children;\n}\n\n\n/**\n * Finds the last child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function lastChildElement(parent, callback) {\n  for (let child = parent.lastElementChild; child;\n    child = child.previousElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n/**\n * Finds all child nodes that satisfy the callback.\n * These nodes can include Text, Comment and other child nodes.\n * @param {!Node} parent\n * @param {function(!Node):boolean} callback\n * @return {!Array<!Node>}\n */\nexport function childNodes(parent, callback) {\n  const nodes = [];\n  for (let child = parent.firstChild; child;\n    child = child.nextSibling) {\n    if (callback(child)) {\n      nodes.push(child);\n    }\n  }\n  return nodes;\n}\n\n/**\n * @type {boolean|undefined}\n * @visibleForTesting\n */\nlet scopeSelectorSupported;\n\n/**\n * @param {boolean|undefined} val\n * @visibleForTesting\n */\nexport function setScopeSelectorSupportedForTesting(val) {\n  scopeSelectorSupported = val;\n}\n\n/**\n * Test that the :scope selector is supported and behaves correctly.\n * @param {!Element} parent\n * @return {boolean}\n */\nfunction isScopeSelectorSupported(parent) {\n  const doc = parent.ownerDocument;\n  try {\n    const testElement = doc.createElement('div');\n    const testChild = doc.createElement('div');\n    testElement.appendChild(testChild);\n    // NOTE(cvializ, #12383): Firefox's implementation is incomplete,\n    // therefore we test actual functionality of`:scope` as well.\n    return testElement./*OK*/querySelector(':scope div') === testChild;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Finds the first child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function childElementByAttr(parent, attr) {\n  return scopedQuerySelector/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the last child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function lastChildElementByAttr(parent, attr) {\n  return lastChildElement(parent, el => {\n    return el.hasAttribute(attr);\n  });\n}\n\n\n/**\n * Finds all child elements that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByAttr(parent, attr) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the first child element that has the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {?Element}\n */\nexport function childElementByTag(parent, tagName) {\n  return scopedQuerySelector/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds all child elements with the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByTag(parent, tagName) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds the first element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {?Element}\n */\nexport function scopedQuerySelector(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelector(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const element = root./*OK*/querySelector(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return element;\n}\n\n\n/**\n * Finds the every element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {!NodeList<!Element>}\n */\nexport function scopedQuerySelectorAll(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelectorAll(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const elements = root./*OK*/querySelectorAll(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return elements;\n}\n\n\n/**\n * Returns element data-param- attributes as url parameters key-value pairs.\n * e.g. data-param-some-attr=value -> {someAttr: value}.\n * @param {!Element} element\n * @param {function(string):string=} opt_computeParamNameFunc to compute the\n *    parameter name, get passed the camel-case parameter name.\n * @param {!RegExp=} opt_paramPattern Regex pattern to match data attributes.\n * @return {!JsonObject}\n */\nexport function getDataParamsFromAttributes(element, opt_computeParamNameFunc,\n  opt_paramPattern) {\n  const computeParamNameFunc = opt_computeParamNameFunc || (key => key);\n  const {dataset} = element;\n  const params = dict();\n  const paramPattern = opt_paramPattern ? opt_paramPattern : /^param(.+)/;\n  for (const key in dataset) {\n    const matches = key.match(paramPattern);\n    if (matches) {\n      const param = matches[1][0].toLowerCase() + matches[1].substr(1);\n      params[computeParamNameFunc(param)] = dataset[key];\n    }\n  }\n  return params;\n}\n\n/**\n * Whether the element have a next node in the document order.\n * This means either:\n *  a. The element itself has a nextSibling.\n *  b. Any of the element ancestors has a nextSibling.\n * @param {!Element} element\n * @param {?Node} opt_stopNode\n * @return {boolean}\n */\nexport function hasNextNodeInDocumentOrder(element, opt_stopNode) {\n  let currentElement = element;\n  do {\n    if (currentElement.nextSibling) {\n      return true;\n    }\n  } while ((currentElement = currentElement.parentNode) &&\n            currentElement != opt_stopNode);\n  return false;\n}\n\n\n/**\n * Finds all ancestor elements that satisfy predicate.\n * @param {!Element} child\n * @param {function(!Element):boolean} predicate\n * @return {!Array<!Element>}\n */\nexport function ancestorElements(child, predicate) {\n  const ancestors = [];\n  for (let ancestor = child.parentElement; ancestor;\n    ancestor = ancestor.parentElement) {\n    if (predicate(ancestor)) {\n      ancestors.push(ancestor);\n    }\n  }\n  return ancestors;\n}\n\n\n/**\n * Finds all ancestor elements that has the specified tag name.\n * @param {!Element} child\n * @param {string} tagName\n * @return {!Array<!Element>}\n */\nexport function ancestorElementsByTag(child, tagName) {\n  tagName = tagName.toUpperCase();\n  return ancestorElements(child, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Returns a clone of the content of a template element.\n *\n * Polyfill to replace .content access for browsers that do not support\n * HTMLTemplateElements natively.\n *\n * @param {!HTMLTemplateElement|!Element} template\n * @return {!DocumentFragment}\n */\nexport function templateContentClone(template) {\n  if ('content' in template) {\n    return template.content.cloneNode(true);\n  } else {\n    const content = template.ownerDocument.createDocumentFragment();\n    copyChildren(template, content);\n    return content;\n  }\n}\n\n/**\n * Iterate over an array-like. Some collections like NodeList are\n * lazily evaluated in some browsers, and accessing `length` forces full\n * evaluation. We can improve performance by iterating until an element is\n * `undefined` to avoid checking the `length` property.\n * Test cases: https://jsperf.com/iterating-over-collections-of-elements\n * @param {!IArrayLike<T>} iterable\n * @param {function(T, number)} cb\n * @template T\n */\nexport function iterateCursor(iterable, cb) {\n  for (let i = 0, value; (value = iterable[i]) !== undefined; i++) {\n    cb(value, i);\n  }\n}\n\n/**\n * This method wraps around window's open method. It first tries to execute\n * `open` call with the provided target and if it fails, it retries the call\n * with the `_top` target. This is necessary given that in some embedding\n * scenarios, such as iOS' WKWebView, navigation to `_blank` and other targets\n * is blocked by default.\n *\n * @param {!Window} win\n * @param {string} url\n * @param {string} target\n * @param {string=} opt_features\n * @return {?Window}\n */\nexport function openWindowDialog(win, url, target, opt_features) {\n  // Try first with the specified target. If we're inside the WKWebView or\n  // a similar environments, this method is expected to fail by default for\n  // all targets except `_top`.\n  let res;\n  try {\n    res = win.open(url, target, opt_features);\n  } catch (e) {\n    dev().error('DOM', 'Failed to open url on target: ', target, e);\n  }\n\n  // Then try with `_top` target.\n  if (!res && target != '_top') {\n    res = win.open(url, '_top');\n  }\n  return res;\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n            element.getAttribute('type').toUpperCase() == 'APPLICATION/JSON';\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonLdScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n      element.getAttribute('type').toUpperCase() == 'APPLICATION/LD+JSON';\n}\n\n/**\n * Whether the page's direction is right to left or not.\n * @param {!Document} doc\n * @return {boolean}\n */\nexport function isRTL(doc) {\n  const dir = doc.body.getAttribute('dir')\n                 || doc.documentElement.getAttribute('dir')\n                 || 'ltr';\n  return dir == 'rtl';\n}\n\n\n/**\n * Escapes an ident (ID or a class name) to be used as a CSS selector.\n *\n * See https://drafts.csswg.org/cssom/#serialize-an-identifier.\n *\n * @param {string} ident\n * @return {string}\n */\nexport function escapeCssSelectorIdent(ident) {\n  return cssEscape(ident);\n}\n\n/**\n * Escapes an ident in a way that can be used by :nth-child() psuedo-class.\n *\n * See https://github.com/w3c/csswg-drafts/issues/2306.\n *\n * @param {string|number} ident\n * @return {string}\n */\nexport function escapeCssSelectorNth(ident) {\n  const escaped = String(ident);\n  // Ensure it doesn't close the nth-child psuedo class.\n  dev().assert(escaped.indexOf(')') === -1);\n  return escaped;\n}\n\n/**\n * Escapes `<`, `>` and other HTML charcaters with their escaped forms.\n * @param {string} text\n * @return {string}\n */\nexport function escapeHtml(text) {\n  if (!text) {\n    return text;\n  }\n  return text.replace(HTML_ESCAPE_REGEX, escapeHtmlChar);\n}\n\n/**\n * @param {string} c\n * @return {string}\n */\nfunction escapeHtmlChar(c) {\n  return HTML_ESCAPE_CHARS[c];\n}\n\n/**\n * Tries to focus on the given element; fails silently if browser throws an\n * exception.\n * @param {!Element} element\n */\nexport function tryFocus(element) {\n  try {\n    element./*OK*/focus();\n  } catch (e) {\n    // IE <= 7 may throw exceptions when focusing on hidden items.\n  }\n}\n\n/**\n * Whether the given window is in an iframe or not.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isIframed(win) {\n  return win.parent && win.parent != win;\n}\n\n/**\n * Determines if this element is an AMP element\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isAmpElement(element) {\n  const tag = element.tagName;\n  // Use prefix to recognize AMP element. This is necessary because stub\n  // may not be attached yet.\n  return startsWith(tag, 'AMP-') &&\n      // Some \"amp-*\" elements are not really AMP elements. :smh:\n      !(tag == 'AMP-STICKY-AD-TOP-PADDING' || tag == 'AMP-BODY');\n}\n\n/**\n * Return a promise that resolve when an AMP element upgrade from HTMLElement\n * to CustomElement\n * @param {!Element} element\n * @return {!Promise<!Element>}\n */\nexport function whenUpgradedToCustomElement(element) {\n  dev().assert(isAmpElement(element), 'element is not AmpElement');\n  if (element.createdCallback) {\n    // Element already is CustomElement;\n    return Promise.resolve(element);\n  }\n  // If Element is still HTMLElement, wait for it to upgrade to customElement\n  // Note: use pure string to avoid obfuscation between versions.\n  if (!element[UPGRADE_TO_CUSTOMELEMENT_PROMISE]) {\n    const deferred = new Deferred();\n    element[UPGRADE_TO_CUSTOMELEMENT_PROMISE] = deferred.promise;\n    element[UPGRADE_TO_CUSTOMELEMENT_RESOLVER] = deferred.resolve;\n\n  }\n\n  return element[UPGRADE_TO_CUSTOMELEMENT_PROMISE];\n}\n\n/**\n * Replacement for `Element.requestFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Element/requestFullscreen\n * @param {!Element} element\n */\nexport function fullscreenEnter(element) {\n  const requestFs = element.requestFullscreen\n   || element.requestFullScreen\n   || element.webkitRequestFullscreen\n   || element.webkitRequestFullScreen\n   || element.webkitEnterFullscreen\n   || element.webkitEnterFullScreen\n   || element.msRequestFullscreen\n   || element.msRequestFullScreen\n   || element.mozRequestFullscreen\n   || element.mozRequestFullScreen;\n  if (requestFs) {\n    requestFs.call(element);\n  }\n}\n\n/**\n * Replacement for `Document.exitFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/exitFullscreen\n * @param {!Element} element\n */\nexport function fullscreenExit(element) {\n  let exitFs = element.cancelFullScreen\n               || element.exitFullscreen\n               || element.exitFullScreen\n               || element.webkitExitFullscreen\n               || element.webkitExitFullScreen\n               || element.webkitCancelFullScreen\n               || element.mozCancelFullScreen\n               || element.msExitFullscreen;\n  if (exitFs) {\n    exitFs.call(element);\n    return;\n  }\n  if (element.ownerDocument) {\n    exitFs = element.ownerDocument.cancelFullScreen\n             || element.ownerDocument.exitFullscreen\n             || element.ownerDocument.exitFullScreen\n             || element.ownerDocument.webkitExitFullscreen\n             || element.ownerDocument.webkitExitFullScreen\n             || element.ownerDocument.webkitCancelFullScreen\n             || element.ownerDocument.mozCancelFullScreen\n             || element.ownerDocument.msExitFullscreen;\n  }\n  if (exitFs) {\n    exitFs.call(element.ownerDocument);\n    return;\n  }\n}\n\n\n/**\n * Replacement for `Document.fullscreenElement`.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/fullscreenElement\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isFullscreenElement(element) {\n  const isFullscreen = element.webkitDisplayingFullscreen;\n  if (isFullscreen) {\n    return true;\n  }\n  if (element.ownerDocument) {\n    const fullscreenElement = element.ownerDocument.fullscreenElement\n             || element.ownerDocument.webkitFullscreenElement\n             || element.ownerDocument.mozFullScreenElement\n             || element.webkitCurrentFullScreenElement;\n    if (fullscreenElement == element) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Returns true if node is not disabled.\n *\n * IE8 can return false positives, see {@link matches}.\n * @param {!Element} element\n * @return {boolean}\n * @see https://www.w3.org/TR/html5/forms.html#concept-fe-disabled\n */\nexport function isEnabled(element) {\n  return !(element.disabled || matches(element, ':disabled'));\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as dom from './dom';\nimport {\n  getAmpdoc,\n  getExistingServiceForDocInEmbedScope,\n  getService,\n  getServicePromise,\n  getServicePromiseForDoc,\n  getServicePromiseOrNull,\n  getServicePromiseOrNullForDoc,\n  getTopWindow,\n} from './service';\nimport {toWin} from './types';\nimport {user} from './log';\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. Services.viewportForDoc(...)) for type safety and because the\n * factory should not be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an element,\n *     not the extension.\n * @return {!Promise<*>}\n */\nexport function getElementService(win, id, extension, opt_element) {\n  return getElementServiceIfAvailable(win, id, extension, opt_element).then(\n      service => assertService(service, id, extension));\n}\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailable(win, id, extension, opt_element) {\n  const s = getServicePromiseOrNull(win, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n  return getElementServicePromiseOrNull(win, id, extension, opt_element);\n}\n\n/**\n * @param {!Window} win\n * @param {string} elementName Name of an extended custom element.\n * @return {boolean} Whether this element is scheduled to be loaded.\n */\nfunction isElementScheduled(win, elementName) {\n  // Set in custom-element.js\n  if (!win.ampExtendedElements) {\n    return false;\n  }\n  return !!win.ampExtendedElements[elementName];\n}\n\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. Services.viewportForDoc(...)) for type safety and because the\n * factory should not be passed around.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an element,\n *     not the extension.\n * @return {!Promise<*>}\n */\nexport function getElementServiceForDoc(elementOrAmpDoc, id, extension,\n  opt_element) {\n  return getElementServiceIfAvailableForDoc(\n      elementOrAmpDoc, id, extension, opt_element)\n      .then(service => assertService(service, id, extension));\n}\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDoc(\n  elementOrAmpDoc, id, extension, opt_element) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const s = getServicePromiseOrNullForDoc(elementOrAmpDoc, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n\n  return ampdoc.whenBodyAvailable()\n      .then(() => waitForExtensionIfPresent(\n          ampdoc.win, extension,\n          ampdoc.getHeadNode()))\n      .then(() => {\n        // If this service is provided by an element, then we can't depend on\n        // the service (they may not use the element).\n        if (opt_element) {\n          return getServicePromiseOrNullForDoc(elementOrAmpDoc, id);\n        } else if (isElementScheduled(ampdoc.win, extension)) {\n          return getServicePromiseForDoc(elementOrAmpDoc, id);\n        }\n        return null;\n      });\n}\n\n/**\n * Returns a promise for service for the given id in the embed scope of\n * a given node, if it exists. Otherwise, falls back to ampdoc scope IFF\n * the given node is in the top-level window.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom element that provides\n *     the implementation of this service.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDocInEmbedScope(\n  elementOrAmpDoc, id, extension) {\n  const s = getExistingServiceForDocInEmbedScope(elementOrAmpDoc, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (Promise.resolve(s));\n  }\n  // Return embed-scope element service promise if scheduled.\n  if (elementOrAmpDoc.nodeType) {\n    const win = toWin(elementOrAmpDoc.ownerDocument.defaultView);\n    const topWin = getTopWindow(win);\n    // In embeds, doc-scope services are window-scope. But make sure to\n    // only do this for embeds (not the top window), otherwise we'd grab\n    // a promise from the wrong service holder which would never resolve.\n    if (win !== topWin) {\n      return getElementServicePromiseOrNull(win, id, extension);\n    } else {\n      // Fallback to ampdoc IFF the given node is _not_ FIE.\n      return getElementServiceIfAvailableForDoc(elementOrAmpDoc, id, extension);\n    }\n  }\n  return /** @type {!Promise<?Object>} */ (Promise.resolve(null));\n}\n\n/**\n * Throws user error if `service` is null.\n * @param {Object} service\n * @param {string} id\n * @param {string} extension\n * @return {!Object}\n * @private\n */\nfunction assertService(service, id, extension) {\n  return /** @type {!Object} */ (user().assert(service,\n      'Service %s was requested to be provided through %s, ' +\n      'but %s is not loaded in the current page. To fix this ' +\n      'problem load the JavaScript file for %s in this page.',\n      id, extension, extension, extension));\n}\n\n/**\n * Get list of all the extension JS files\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @return {!Array<string>}\n */\nexport function extensionScriptsInNode(head) {\n  // ampdoc.getHeadNode() can return null\n  if (!head) {\n    return [];\n  }\n  const scripts = [];\n  const list = head.querySelectorAll('script[custom-element]');\n  for (let i = 0; i < list.length; i++) {\n    scripts.push(list[i].getAttribute('custom-element'));\n  }\n  return scripts;\n}\n\n/**\n * Waits for body to be present then verifies that an extension script is\n * present in head for installation.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n * @param {string} extensionId\n * @return {!Promise<boolean>}\n */\nexport function isExtensionScriptInNode(ampdoc, extensionId) {\n  return ampdoc.whenBodyAvailable()\n      .then(() => {\n        return extensionScriptInNode(\n            ampdoc.getHeadNode(), extensionId);\n      });\n}\n\n/**\n * Verifies that an extension script is present in head for\n * installation.\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @param {string} extensionId\n * @private\n */\nfunction extensionScriptInNode(head, extensionId) {\n  return extensionScriptsInNode(head).includes(extensionId);\n}\n\n/**\n * Waits for an extension if its script is present\n * @param {!Window} win\n * @param {string} extension\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @return {!Promise}\n * @private\n */\nfunction waitForExtensionIfPresent(win, extension, head) {\n  /**\n   * If there is an extension script wait for it to load before trying\n   * to get the service. Prevents a race condition when everything but\n   * the extensions is in cache. If there is no script then it's either\n   * not present, or the service was defined by a test. In those cases\n   * we don't wait around for an extension that does not exist.\n   */\n\n  // TODO(jpettitt) investigate registerExtension to short circuit\n  // the dom call in extensionScriptsInNode()\n  if (!extensionScriptInNode(head, extension)) {\n    return Promise.resolve();\n  }\n\n  const extensions = getService(win, 'extensions');\n  return /** @type {!Promise<?Object>} */ (\n    extensions.waitForExtension(win, extension));\n}\n\n/**\n * Returns the promise for service with `id` on the given window if available.\n * Otherwise, resolves with null (service was not registered).\n * @param {!Window} win\n * @param {string} id\n * @param {string} extension\n * @param {boolean=} opt_element\n * @return {!Promise<Object>}\n * @private\n */\nfunction getElementServicePromiseOrNull(win, id, extension, opt_element) {\n  return dom.waitForBodyPromise(win.document)\n      .then(() => waitForExtensionIfPresent(win, extension, win.document.head))\n      .then(() => {\n        // If this service is provided by an element, then we can't depend on\n        // the service (they may not use the element).\n        if (opt_element) {\n          return getServicePromiseOrNull(win, id);\n        } else if (isElementScheduled(win, extension)) {\n          return getServicePromise(win, id);\n        }\n        return null;\n      });\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Experiments system allows a developer to opt-in to test\n * features that are not yet fully tested.\n *\n * Experiments page: https://cdn.ampproject.org/experiments.html *\n */\n\nimport {getCookie, setCookie} from './cookies';\nimport {hasOwn} from './utils/object';\nimport {parseQueryString} from './url';\n\n/** @const {string} */\nconst COOKIE_NAME = 'AMP_EXP';\n\n/** @const {number} */\nconst COOKIE_MAX_AGE_DAYS = 180; // 6 month\n\n/** @const {time} */\nconst COOKIE_EXPIRATION_INTERVAL = COOKIE_MAX_AGE_DAYS * 24 * 60 * 60 * 1000;\n\n/** @const {string} */\nconst TOGGLES_WINDOW_PROPERTY = '__AMP__EXPERIMENT_TOGGLES';\n\n/**\n * @typedef {{\n *   isTrafficEligible: function(!Window):boolean,\n *   branches: !Array<string>\n * }}\n */\nexport let ExperimentInfo;\n\n/**\n * Whether we are in canary.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isCanary(win) {\n  return !!(win.AMP_CONFIG && win.AMP_CONFIG.canary);\n}\n\n/**\n * Returns binary type, e.g., canary, control, or production.\n * @param {!Window} win\n * @return {string}\n */\nexport function getBinaryType(win) {\n  return win.AMP_CONFIG && win.AMP_CONFIG.type ?\n    win.AMP_CONFIG.type : 'unknown';\n}\n\n/**\n * Whether the specified experiment is on or off.\n * @param {!Window} win\n * @param {string} experimentId\n * @return {boolean}\n */\nexport function isExperimentOn(win, experimentId) {\n  const toggles = experimentToggles(win);\n  return !!toggles[experimentId];\n}\n\n/**\n * Toggles the experiment on or off. Returns the actual value of the experiment\n * after toggling is done.\n * @param {!Window} win\n * @param {string} experimentId\n * @param {boolean=} opt_on\n * @param {boolean=} opt_transientExperiment  Whether to toggle the\n *     experiment state \"transiently\" (i.e., for this page load only) or\n *     durably (by saving the experiment IDs to the cookie after toggling).\n *     Default: false (save durably).\n * @return {boolean} New state for experimentId.\n */\nexport function toggleExperiment(win, experimentId, opt_on,\n  opt_transientExperiment) {\n  const currentlyOn = isExperimentOn(win, /*OK*/experimentId);\n  const on = !!(opt_on !== undefined ? opt_on : !currentlyOn);\n  if (on != currentlyOn) {\n    const toggles = experimentToggles(win);\n    toggles[experimentId] = on;\n\n    if (!opt_transientExperiment) {\n      const cookieToggles = getExperimentTogglesFromCookie(win);\n      cookieToggles[experimentId] = on;\n      saveExperimentTogglesToCookie(win, cookieToggles);\n    }\n  }\n  return on;\n}\n\n/**\n * Calculate whether the experiment is on or off based off of the\n * cookieFlag or the global config frequency given.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nexport function experimentToggles(win) {\n  if (win[TOGGLES_WINDOW_PROPERTY]) {\n    return win[TOGGLES_WINDOW_PROPERTY];\n  }\n  win[TOGGLES_WINDOW_PROPERTY] = Object.create(null);\n  const toggles = win[TOGGLES_WINDOW_PROPERTY];\n\n  // Read the default config of this build.\n  if (win.AMP_CONFIG) {\n    for (const experimentId in win.AMP_CONFIG) {\n      const frequency = win.AMP_CONFIG[experimentId];\n      if (typeof frequency === 'number' && frequency >= 0 && frequency <= 1) {\n        toggles[experimentId] = Math.random() < frequency;\n      }\n    }\n  }\n  // Read document level override from meta tag.\n  if (win.AMP_CONFIG\n      && Array.isArray(win.AMP_CONFIG['allow-doc-opt-in'])\n      && win.AMP_CONFIG['allow-doc-opt-in'].length > 0) {\n    const allowed = win.AMP_CONFIG['allow-doc-opt-in'];\n    const meta =\n        win.document.head.querySelector('meta[name=\"amp-experiments-opt-in\"]');\n    if (meta) {\n      const optedInExperiments = meta.getAttribute('content').split(',');\n      for (let i = 0; i < optedInExperiments.length; i++) {\n        if (allowed.indexOf(optedInExperiments[i]) != -1) {\n          toggles[optedInExperiments[i]] = true;\n        }\n      }\n    }\n  }\n\n  Object.assign(toggles, getExperimentTogglesFromCookie(win));\n\n  if (win.AMP_CONFIG\n      && Array.isArray(win.AMP_CONFIG['allow-url-opt-in'])\n      && win.AMP_CONFIG['allow-url-opt-in'].length > 0) {\n    const allowed = win.AMP_CONFIG['allow-url-opt-in'];\n    const hash = win.location.originalHash || win.location.hash;\n    const params = parseQueryString(hash);\n    for (let i = 0; i < allowed.length; i++) {\n      const param = params[`e-${allowed[i]}`];\n      if (param == '1') {\n        toggles[allowed[i]] = true;\n      }\n      if (param == '0') {\n        toggles[allowed[i]] = false;\n      }\n    }\n  }\n  return toggles;\n}\n\n/**\n * Returns the cached experiments toggles, or null if they have not been\n * computed yet.\n * @param {!Window} win\n * @return {Object<string, boolean>}\n */\nexport function experimentTogglesOrNull(win) {\n  return win[TOGGLES_WINDOW_PROPERTY] || null;\n}\n\n/**\n * Returns a set of experiment IDs currently on.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nfunction getExperimentTogglesFromCookie(win) {\n  const experimentCookie = getCookie(win, COOKIE_NAME);\n  const tokens = experimentCookie ? experimentCookie.split(/\\s*,\\s*/g) : [];\n\n  const toggles = Object.create(null);\n  for (let i = 0; i < tokens.length; i++) {\n    if (tokens[i].length == 0) {\n      continue;\n    }\n    if (tokens[i][0] == '-') {\n      toggles[tokens[i].substr(1)] = false;\n    } else {\n      toggles[tokens[i]] = true;\n    }\n  }\n\n  return toggles;\n}\n\n/**\n * Saves a set of experiment IDs currently on.\n * @param {!Window} win\n * @param {!Object<string, boolean>} toggles\n */\nfunction saveExperimentTogglesToCookie(win, toggles) {\n  const experimentIds = [];\n  for (const experiment in toggles) {\n    experimentIds.push((toggles[experiment] === false ? '-' : '') + experiment);\n  }\n\n  setCookie(win, COOKIE_NAME, experimentIds.join(','),\n      Date.now() + COOKIE_EXPIRATION_INTERVAL, {\n        // Set explicit domain, so the cookie gets send to sub domains.\n        domain: win.location.hostname,\n        allowOnProxyOrigin: true,\n      });\n}\n\n/**\n * See getExperimentTogglesFromCookie().\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n * @visibleForTesting\n */\nexport function getExperimentToglesFromCookieForTesting(win) {\n  return getExperimentTogglesFromCookie(win);\n}\n\n/**\n * Resets the experimentsToggle cache for testing purposes.\n * @param {!Window} win\n * @visibleForTesting\n */\nexport function resetExperimentTogglesForTesting(win) {\n  setCookie(win, COOKIE_NAME, '', 0, {\n    domain: win.location.hostname,\n  });\n  win[TOGGLES_WINDOW_PROPERTY] = null;\n}\n\n/**\n * In some browser implementations of Math.random(), sequential calls of\n * Math.random() are correlated and can cause a bias.  In particular,\n * if the previous random() call was < 0.001 (as it will be if we select\n * into an experiment), the next value could be less than 0.5 more than\n * 50.7% of the time.  This provides an implementation that roots down into\n * the crypto API, when available, to produce less biased samples.\n *\n * @return {number} Pseudo-random floating-point value on the range [0, 1).\n */\nfunction slowButAccuratePrng() {\n  // TODO(tdrl): Implement.\n  return Math.random();\n}\n\n/**\n * Container for alternate random number generator implementations.  This\n * allows us to set an \"accurate\" PRNG for branch selection, but to mock it\n * out easily in tests.\n *\n * @visibleForTesting\n * @const {!{accuratePrng: function():number}}\n */\nexport const RANDOM_NUMBER_GENERATORS = {\n  accuratePrng: slowButAccuratePrng,\n};\n\n/**\n * Selects, uniformly at random, a single item from the array.\n * @param {!Array<string>} arr Object to select from.\n * @return {?string} Single item from arr or null if arr was empty.\n */\nfunction selectRandomItem(arr) {\n  const rn = RANDOM_NUMBER_GENERATORS.accuratePrng();\n  return arr[Math.floor(rn * arr.length)] || null;\n}\n\n/**\n * Selects which page-level experiment branches are enabled. If a given\n * experiment name is already set (including to the null / no branches selected\n * state), this won't alter its state.\n *\n * Check whether a given experiment is set using isExperimentOn(win,\n * experimentName) and, if it is on, look for which branch is selected in\n * win.experimentBranches[experimentName].\n *\n * @param {!Window} win Window context on which to save experiment\n *     selection state.\n * @param {!Object<string, !ExperimentInfo>} experiments  Set of experiments to\n *     configure for this page load.\n * @return {!Object<string, string>} Map of experiment names to selected\n *     branches.\n */\nexport function randomlySelectUnsetExperiments(win, experiments) {\n  win.experimentBranches = win.experimentBranches || {};\n  const selectedExperiments = {};\n  for (const experimentName in experiments) {\n    // Skip experimentName if it is not a key of experiments object or if it\n    // has already been populated by some other property.\n    if (!hasOwn(experiments, experimentName)) {\n      continue;\n    }\n    if (hasOwn(win.experimentBranches, experimentName)) {\n      selectedExperiments[experimentName] =\n          win.experimentBranches[experimentName];\n      continue;\n    }\n\n    if (!experiments[experimentName].isTrafficEligible ||\n        !experiments[experimentName].isTrafficEligible(win)) {\n      win.experimentBranches[experimentName] = null;\n      continue;\n    }\n\n    // If we're in the experiment, but we haven't already forced a specific\n    // experiment branch (e.g., via a test setup), then randomize the branch\n    // choice.\n    if (!win.experimentBranches[experimentName] &&\n      isExperimentOn(win, /*OK*/experimentName)) {\n      const {branches} = experiments[experimentName];\n      win.experimentBranches[experimentName] = selectRandomItem(branches);\n      selectedExperiments[experimentName] =\n          win.experimentBranches[experimentName];\n    }\n  }\n  return selectedExperiments;\n}\n\n/**\n * Returns the experiment branch enabled for the given experiment ID.\n * For example, 'control' or 'experiment'.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @return {?string} Active experiment branch ID for experimentName (possibly\n *     null if experimentName has been tested but no branch was enabled).\n */\nexport function getExperimentBranch(win, experimentName) {\n  return win.experimentBranches ? win.experimentBranches[experimentName] : null;\n}\n\n/**\n * Force enable (or disable) a specific branch of a given experiment name.\n * Disables the experiment name altogether if branchId is falseish.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @param {?string} branchId ID of branch to force or null to disable\n *     altogether.\n * @visibleForTesting\n */\nexport function forceExperimentBranch(win, experimentName, branchId) {\n  win.experimentBranches = win.experimentBranches || {};\n  toggleExperiment(win, experimentName, !!branchId, true);\n  win.experimentBranches[experimentName] = branchId;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview This module declares JSON types as defined in the\n * {@link http://json.org/}.\n */\n\nimport {isObject} from './types';\n\n\n// NOTE Type are changed to {*} because of\n// https://github.com/google/closure-compiler/issues/1999\n\n/**\n * JSON scalar. It's either string, number or boolean.\n * @typedef {*} should be string|number|boolean\n */\nlet JSONScalarDef;\n\n\n/**\n * JSON object. It's a map with string keys and JSON values.\n * @typedef {*} should be !Object<string, ?JSONValueDef>\n */\nlet JSONObjectDef;\n\n\n/**\n * JSON array. It's an array with JSON values.\n * @typedef {*} should be !Array<?JSONValueDef>\n */\nlet JSONArrayDef;\n\n\n/**\n * JSON value. It's either a scalar, an object or an array.\n * @typedef {*} should be !JSONScalarDef|!JSONObjectDef|!JSONArrayDef\n */\nlet JSONValueDef;\n\n/**\n * Recreates objects with prototype-less copies.\n * @param {!JsonObject} obj\n * @return {!JsonObject}\n */\nexport function recreateNonProtoObject(obj) {\n  const copy = Object.create(null);\n  for (const k in obj) {\n    if (!hasOwnProperty(obj, k)) {\n      continue;\n    }\n    const v = obj[k];\n    copy[k] = isObject(v) ? recreateNonProtoObject(v) : v;\n  }\n  return /** @type {!JsonObject} */ (copy);\n}\n\n/**\n * Returns a value from an object for a field-based expression. The expression\n * is a simple nested dot-notation of fields, such as `field1.field2`. If any\n * field in a chain does not exist or is not an object or array, the returned\n * value will be `undefined`.\n *\n * @param {!JsonObject} obj\n * @param {string} expr\n * @return {*}\n */\nexport function getValueForExpr(obj, expr) {\n  // The `.` indicates \"the object itself\".\n  if (expr == '.') {\n    return obj;\n  }\n  // Otherwise, navigate via properties.\n  const parts = expr.split('.');\n  let value = obj;\n  for (let i = 0; i < parts.length; i++) {\n    const part = parts[i];\n    if (part &&\n        value &&\n        value[part] !== undefined &&\n        hasOwnProperty(value, part)\n    ) {\n      value = value[part];\n      continue;\n    }\n    value = undefined;\n    break;\n  }\n  return value;\n}\n\n/**\n * Simple wrapper around JSON.parse that casts the return value\n * to JsonObject.\n * Create a new wrapper if an array return value is desired.\n * @param {*} json JSON string to parse\n * @return {?JsonObject} May be extend to parse arrays.\n */\nexport function parseJson(json) {\n  return /** @type {?JsonObject} */(JSON.parse(/** @type {string} */ (json)));\n}\n\n/**\n * Parses the given `json` string without throwing an exception if not valid.\n * Returns `undefined` if parsing fails.\n * Returns the `Object` corresponding to the JSON string when parsing succeeds.\n * @param {*} json JSON string to parse\n * @param {function(!Error)=} opt_onFailed Optional function that will be called\n *     with the error if parsing fails.\n * @return {?JsonObject|undefined} May be extend to parse arrays.\n */\nexport function tryParseJson(json, opt_onFailed) {\n  try {\n    return parseJson(json);\n  } catch (e) {\n    if (opt_onFailed) {\n      opt_onFailed(e);\n    }\n    return undefined;\n  }\n}\n\n/**\n * Recursively checks strict equality of items in nested arrays and objects.\n *\n * @param {JSONValueDef} a\n * @param {JSONValueDef} b\n * @param {number} depth The maximum recursion depth. Must be finite.\n * @return {boolean}\n * @throws {Error} If depth argument is not finite.\n */\nexport function recursiveEquals(a, b, depth = 3) {\n  if (!isFinite(depth)) {\n    throw new Error('depth arg must be finite: ' + depth);\n  }\n  if (a === b) {\n    return true;\n  }\n  // Only check shallow equality for depth < 1.\n  if (depth < 1) {\n    return false;\n  }\n  if (typeof a !== typeof b) {\n    return false;\n  }\n  if (Array.isArray(a) && Array.isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n    for (let i = 0; i < a.length; i++) {\n      if (!recursiveEquals(a[i], b[i], depth - 1)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\n    const keysA = Object.keys(/** @type {!Object} */ (a));\n    const keysB = Object.keys(/** @type {!Object} */ (b));\n    if (keysA.length !== keysB.length) {\n      return false;\n    }\n    for (let i = 0; i < keysA.length; i++) {\n      const keyA = keysA[i];\n      const valueA = a[keyA];\n      const valueB = b[keyA];\n      if (!recursiveEquals(valueA, valueB, depth - 1)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {*} obj\n * @param {string} key\n * @return {boolean}\n */\nfunction hasOwnProperty(obj, key) {\n  if (obj == null || typeof obj != 'object') {\n    return false;\n  }\n  return Object.prototype.hasOwnProperty.call(\n      /** @type {!Object} */ (obj), key);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {getModeObject} from './mode-object';\nimport {isEnumValue} from './types';\n\n/**\n * Triple zero width space.\n *\n * This is added to user error messages, so that we can later identify\n * them, when the only thing that we have is the message. This is the\n * case in many browsers when the global exception handler is invoked.\n *\n * @const {string}\n */\nexport const USER_ERROR_SENTINEL = '\\u200B\\u200B\\u200B';\n\n\n/**\n * Four zero width space.\n *\n * @const {string}\n */\nexport const USER_ERROR_EMBED_SENTINEL = '\\u200B\\u200B\\u200B\\u200B';\n\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a user error.\n */\nexport function isUserErrorMessage(message) {\n  return message.indexOf(USER_ERROR_SENTINEL) >= 0;\n}\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a a user error from an iframe embed.\n */\nexport function isUserErrorEmbed(message) {\n  return message.indexOf(USER_ERROR_EMBED_SENTINEL) >= 0;\n}\n\n\n/**\n * @enum {number}\n * @private Visible for testing only.\n */\nexport const LogLevel = {\n  OFF: 0,\n  ERROR: 1,\n  WARN: 2,\n  INFO: 3,\n  FINE: 4,\n};\n\n/**\n * Sets reportError function. Called from error.js to break cyclic\n * dependency.\n * @param {function(*, !Element=)|undefined} fn\n */\nexport function setReportError(fn) {\n  self.reportError = fn;\n}\n\n/**\n * @type {!LogLevel|undefined}\n * @private\n */\nlet levelOverride_ = undefined;\n\n/**\n * @param {!LogLevel} level\n */\nexport function overrideLogLevel(level) {\n  levelOverride_ = level;\n}\n\n/**\n * Logging class. Use of sentinel string instead of a boolean to check user/dev\n * errors because errors could be rethrown by some native code as a new error,\n * and only a message would survive. Also, some browser don’t support a 5th\n * error object argument in window.onerror. List of supporting browser can be\n * found here:\n * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n * @final\n * @private Visible for testing only.\n */\nexport class Log {\n  /**\n   * opt_suffix will be appended to error message to identify the type of the\n   * error message. We can't rely on the error object to pass along the type\n   * because some browsers do not have this param in its window.onerror API.\n   * See:\n   * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n   *\n   * @param {!Window} win\n   * @param {function(!./mode.ModeDef):!LogLevel} levelFunc\n   * @param {string=} opt_suffix\n   */\n  constructor(win, levelFunc, opt_suffix) {\n    /**\n     * In tests we use the main test window instead of the iframe where\n     * the tests runs because only the former is relayed to the console.\n     * @const {!Window}\n     */\n    this.win = (getMode().test && win.AMP_TEST_IFRAME) ? win.parent : win;\n\n    /** @private @const {function(!./mode.ModeDef):!LogLevel} */\n    this.levelFunc_ = levelFunc;\n\n    /** @private @const {!LogLevel} */\n    this.level_ = this.defaultLevel_();\n\n    /** @private @const {string} */\n    this.suffix_ = opt_suffix || '';\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  getLevel_() {\n    return (levelOverride_ !== undefined) ? levelOverride_ : this.level_;\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  defaultLevel_() {\n    // No console - can't enable logging.\n    if (!this.win.console || !this.win.console.log) {\n      return LogLevel.OFF;\n    }\n\n    // Logging has been explicitly disabled.\n    if (getMode().log == '0') {\n      return LogLevel.OFF;\n    }\n\n    // Logging is enabled for tests directly.\n    if (getMode().test && this.win.ENABLE_LOG) {\n      return LogLevel.FINE;\n    }\n\n    // LocalDev by default allows INFO level, unless overriden by `#log`.\n    if (getMode().localDev && !getMode().log) {\n      return LogLevel.INFO;\n    }\n\n    // Delegate to the specific resolver.\n    return this.levelFunc_(getModeObject());\n  }\n\n  /**\n   * @param {string} tag\n   * @param {string} level\n   * @param {!Array} messages\n   */\n  msg_(tag, level, messages) {\n    if (this.getLevel_() != LogLevel.OFF) {\n      let fn = this.win.console.log;\n      if (level == 'ERROR') {\n        fn = this.win.console.error || fn;\n      } else if (level == 'INFO') {\n        fn = this.win.console.info || fn;\n      } else if (level == 'WARN') {\n        fn = this.win.console.warn || fn;\n      }\n      if (getMode().localDev) {\n        messages.unshift('[' + tag + ']');\n      }\n      fn.apply(this.win.console, messages);\n    }\n  }\n\n  /**\n   * Whether the logging is enabled.\n   * @return {boolean}\n   */\n  isEnabled() {\n    return this.getLevel_() != LogLevel.OFF;\n  }\n\n  /**\n   * Reports a fine-grained message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  fine(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.FINE) {\n      this.msg_(tag, 'FINE', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a informational message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  info(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.INFO) {\n      this.msg_(tag, 'INFO', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a warning message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  warn(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.WARN) {\n      this.msg_(tag, 'WARN', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports an error message. If the logging is disabled, the error is rethrown\n   * asynchronously.\n   * @param {string} tag\n   * @param {...*} var_args\n   * @return {!Error|undefined}\n   * @private\n   */\n  error_(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.ERROR) {\n      this.msg_(tag, 'ERROR', Array.prototype.slice.call(arguments, 1));\n    } else {\n      const error = createErrorVargs.apply(null,\n          Array.prototype.slice.call(arguments, 1));\n      this.prepareError_(error);\n      return error;\n    }\n  }\n\n  /**\n   * Reports an error message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  error(tag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.name = tag || error.name;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Reports an error message and marks with an expected property. If the\n   * logging is disabled, the error is rethrown asynchronously.\n   * @param {string} unusedTag\n   * @param {...*} var_args\n   */\n  expectedError(unusedTag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.expected = true;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Creates an error object.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    return error;\n  }\n\n  /**\n   * Creates an error object with its expected property set to true.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createExpectedError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    error.expected = true;\n    return error;\n  }\n\n  /**\n   * Throws an error if the first argument isn't trueish.\n   *\n   * Supports argument substitution into the message via %s placeholders.\n   *\n   * Throws an error object that has two extra properties:\n   * - associatedElement: This is the first element provided in the var args.\n   *   It can be used for improved display of error messages.\n   * - messageArray: The elements of the substituted message as non-stringified\n   *   elements in an array. When e.g. passed to console.error this yields\n   *   native displays of things like HTML elements.\n   *\n   * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n   *     not evaluate to true.\n   * @param {string=} opt_message The assertion message\n   * @param {...*} var_args Arguments substituted into %s in the message.\n   * @return {T} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 0\n   */\n  assert(shouldBeTrueish, opt_message, var_args) {\n    let firstElement;\n    if (!shouldBeTrueish) {\n      const message = opt_message || 'Assertion failed';\n      const splitMessage = message.split('%s');\n      const first = splitMessage.shift();\n      let formatted = first;\n      const messageArray = [];\n      pushIfNonEmpty(messageArray, first);\n      for (let i = 2; i < arguments.length; i++) {\n        const val = arguments[i];\n        if (val && val.tagName) {\n          firstElement = val;\n        }\n        const nextConstant = splitMessage.shift();\n        messageArray.push(val);\n        pushIfNonEmpty(messageArray, nextConstant.trim());\n        formatted += toString(val) + nextConstant;\n      }\n      const e = new Error(formatted);\n      e.fromAssert = true;\n      e.associatedElement = firstElement;\n      e.messageArray = messageArray;\n      this.prepareError_(e);\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n    return shouldBeTrueish;\n  }\n\n  /**\n   * Throws an error if the first argument isn't an Element\n   *\n   * Otherwise see `assert` for usage\n   *\n   * @param {*} shouldBeElement\n   * @param {string=} opt_message The assertion message\n   * @return {!Element} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertElement(shouldBeElement, opt_message) {\n    const shouldBeTrueish = shouldBeElement && shouldBeElement.nodeType == 1;\n    this.assert(shouldBeTrueish, (opt_message || 'Element expected') + ': %s',\n        shouldBeElement);\n    return /** @type {!Element} */ (shouldBeElement);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a string. The string can\n   * be empty.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeString\n   * @param {string=} opt_message The assertion message\n   * @return {string} The string value. Can be an empty string.\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertString(shouldBeString, opt_message) {\n    this.assert(typeof shouldBeString == 'string',\n        (opt_message || 'String expected') + ': %s', shouldBeString);\n    return /** @type {string} */ (shouldBeString);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a number. The allowed values\n   * include `0` and `NaN`.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeNumber\n   * @param {string=} opt_message The assertion message\n   * @return {number} The number value. The allowed values include `0`\n   *   and `NaN`.\n   */\n  assertNumber(shouldBeNumber, opt_message) {\n    this.assert(typeof shouldBeNumber == 'number',\n        (opt_message || 'Number expected') + ': %s', shouldBeNumber);\n    return /** @type {number} */ (shouldBeNumber);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a boolean.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeBoolean\n   * @param {string=} opt_message The assertion message\n   * @return {boolean} The boolean value.\n   */\n  assertBoolean(shouldBeBoolean, opt_message) {\n    this.assert(!!shouldBeBoolean === shouldBeBoolean,\n        (opt_message || 'Boolean expected') + ': %s', shouldBeBoolean);\n    return /** @type {boolean} */ (shouldBeBoolean);\n  }\n\n  /**\n   * Asserts and returns the enum value. If the enum doesn't contain such a\n   * value, the error is thrown.\n   *\n   * @param {!Object<T>} enumObj\n   * @param {string} s\n   * @param {string=} opt_enumName\n   * @return {T}\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertEnumValue(enumObj, s, opt_enumName) {\n    if (isEnumValue(enumObj, s)) {\n      return s;\n    }\n    this.assert(false,\n        'Unknown %s value: \"%s\"',\n        opt_enumName || 'enum', s);\n  }\n\n  /**\n   * @param {!Error} error\n   * @private\n   */\n  prepareError_(error) {\n    error = duplicateErrorIfNecessary(error);\n    if (this.suffix_) {\n      if (!error.message) {\n        error.message = this.suffix_;\n      } else if (error.message.indexOf(this.suffix_) == -1) {\n        error.message += this.suffix_;\n      }\n    } else if (isUserErrorMessage(error.message)) {\n      error.message = error.message.replace(USER_ERROR_SENTINEL, '');\n    }\n  }\n}\n\n/**\n * @param {string|!Element} val\n * @return {string}\n */\nfunction toString(val) {\n  // Do check equivalent to `val instanceof Element` without cross-window bug\n  if (val && val.nodeType == 1) {\n    return val.tagName.toLowerCase() + (val.id ? '#' + val.id : '');\n  }\n  return /** @type {string} */ (val);\n}\n\n\n/**\n * @param {!Array} array\n * @param {*} val\n */\nfunction pushIfNonEmpty(array, val) {\n  if (val != '') {\n    array.push(val);\n  }\n}\n\n/**\n * Some exceptions (DOMException, namely) have read-only message.\n * @param {!Error} error\n * @return {!Error};\n */\nexport function duplicateErrorIfNecessary(error) {\n  const {message} = error;\n  const test = String(Math.random());\n  error.message = test;\n\n  if (error.message === test) {\n    error.message = message;\n    return error;\n  }\n\n  const e = new Error(error.message);\n  // Copy all the extraneous things we attach.\n  for (const prop in error) {\n    e[prop] = error[prop];\n  }\n  // Ensure these are copied.\n  e.stack = error.stack;\n  return e;\n}\n\n/**\n * @param {...*} var_args\n * @return {!Error}\n * @visibleForTesting\n */\nexport function createErrorVargs(var_args) {\n  let error = null;\n  let message = '';\n  for (let i = 0; i < arguments.length; i++) {\n    const arg = arguments[i];\n    if (arg instanceof Error && !error) {\n      error = duplicateErrorIfNecessary(arg);\n    } else {\n      if (message) {\n        message += ' ';\n      }\n      message += arg;\n    }\n  }\n\n  if (!error) {\n    error = new Error(message);\n  } else if (message) {\n    error.message = message + ': ' + error.message;\n  }\n  return error;\n}\n\n\n/**\n * Rethrows the error without terminating the current context. This preserves\n * whether the original error designation is a user error or a dev error.\n * @param {...*} var_args\n */\nexport function rethrowAsync(var_args) {\n  const error = createErrorVargs.apply(null, arguments);\n  setTimeout(() => {\n    // reportError is installed globally per window in the entry point.\n    self.reportError(error);\n    throw error;\n  });\n}\n\n\n/**\n * Cache for logs. We do not use a Service since the service module depends\n * on Log and closure literally can't even.\n * @type {{user: ?Log, dev: ?Log, userForEmbed: ?Log}}\n */\nself.log = (self.log || {\n  user: null,\n  dev: null,\n  userForEmbed: null,\n});\n\nconst logs = self.log;\n\n/**\n * Eventually holds a constructor for Log objects. Lazily initialized, so we\n * can avoid ever referencing the real constructor except in JS binaries\n * that actually want to include the implementation.\n * @type {?Function}\n */\nlet logConstructor = null;\n\n/**\n * Initializes log contructor.\n */\nexport function initLogConstructor() {\n  logConstructor = Log;\n  // Initialize instances for use. If a binary (an extension for example) that\n  // does not call `initLogConstructor` invokes `dev()` or `user()` earlier than\n  // the binary that does call `initLogConstructor` (amp.js), the extension will\n  // throw an error as that extension will never be able to initialize the log\n  // instances and we also don't want it to call `initLogConstructor` either\n  // (since that will cause the Log implementation to be bundled into that\n  // binary). So we must initialize the instances eagerly so that they are ready\n  // for use (stored globally) after the main binary calls `initLogConstructor`.\n  dev();\n  user();\n}\n\n/**\n * Resets log contructor for testing.\n */\nexport function resetLogConstructorForTesting() {\n  logConstructor = null;\n}\n\n/**\n * Publisher level log.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Development mode is enabled via `#development=1` or logging is explicitly\n *     enabled via `#log=D` where D >= 1.\n *  3. AMP.setLogLevel(D) is called, where D >= 1.\n *\n * @param {!Element=} opt_element\n * @return {!Log}\n */\nexport function user(opt_element) {\n  if (!logs.user) {\n    logs.user = getUserLogger(USER_ERROR_SENTINEL);\n  }\n  if (!isFromEmbed(logs.user.win, opt_element)) {\n    return logs.user;\n  } else {\n    if (logs.userForEmbed) {\n      return logs.userForEmbed;\n    }\n    return logs.userForEmbed = getUserLogger(USER_ERROR_EMBED_SENTINEL);\n  }\n}\n\n/**\n * Getter for user logger\n * @param {string=} suffix\n * @return {!Log}\n */\nfunction getUserLogger(suffix) {\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (mode.development || logNum >= 1) {\n      return LogLevel.FINE;\n    }\n    return LogLevel.WARN;\n  }, suffix);\n}\n\n/**\n * AMP development log. Calls to `devLog().assert` and `dev.fine` are stripped\n * in the PROD binary. However, `devLog().assert` result is preserved in either\n * case.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Logging is explicitly enabled via `#log=D`, where D >= 2.\n *  3. AMP.setLogLevel(D) is called, where D >= 2.\n *\n * @return {!Log}\n */\nexport function dev() {\n  if (logs.dev) {\n    return logs.dev;\n  }\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return logs.dev = new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (logNum >= 3) {\n      return LogLevel.FINE;\n    }\n    if (logNum >= 2) {\n      return LogLevel.INFO;\n    }\n    return LogLevel.OFF;\n  });\n}\n\n/**\n * @param {!Window} win\n * @param {!Element=} opt_element\n * @return {boolean} isEmbed\n */\nexport function isFromEmbed(win, opt_element) {\n  if (!opt_element) {\n    return false;\n  }\n  return opt_element.ownerDocument.defaultView != win;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\n\n/**\n * Provides info about the current app. This return value may be cached and\n * passed around as it will always be DCE'd.\n * @param {?Window=} opt_win\n * @return {!./mode.ModeDef}\n */\nexport function getModeObject(opt_win) {\n  return {\n    localDev: getMode(opt_win).localDev,\n    development: getMode(opt_win).development,\n    filter: getMode(opt_win).filter,\n    minified: getMode(opt_win).minified,\n    lite: getMode(opt_win).lite,\n    test: getMode(opt_win).test,\n    log: getMode(opt_win).log,\n    version: getMode(opt_win).version,\n    rtvVersion: getMode(opt_win).rtvVersion,\n  };\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {parseQueryString_} from './url-parse-query-string';\n\n/**\n * @typedef {{\n *   localDev: boolean,\n *   development: boolean,\n *   filter: (string|undefined),\n *   minified: boolean,\n *   lite: boolean,\n *   test: boolean,\n *   log: (string|undefined),\n *   version: string,\n *   rtvVersion: string,\n * }}\n */\nexport let ModeDef;\n\n/** @type {string} */\nconst version = '$internalRuntimeVersion$';\n\n/**\n * `rtvVersion` is the prefixed version we serve off of the cdn.\n * The prefix denotes canary(00) or prod(01) or an experiment version ( > 01).\n * @type {string}\n */\nlet rtvVersion = '';\n\n/**\n * Provides info about the current app.\n * @param {?Window=} opt_win\n * @return {!ModeDef}\n */\nexport function getMode(opt_win) {\n  const win = opt_win || self;\n  if (win.AMP_MODE) {\n    return win.AMP_MODE;\n  }\n  return win.AMP_MODE = getMode_(win);\n}\n\n/**\n * Provides info about the current app.\n * @param {!Window} win\n * @return {!ModeDef}\n */\nfunction getMode_(win) {\n  // Magic constants that are replaced by closure compiler.\n  // IS_MINIFIED is always replaced with true when closure compiler is used\n  // while IS_DEV is only replaced when `gulp dist` is called without the\n  // --fortesting flag.\n  const IS_DEV = true;\n  const IS_MINIFIED = false;\n\n  const localDevEnabled = !!(self.AMP_CONFIG && self.AMP_CONFIG.localDev);\n  const runningTests = IS_DEV && !!(win.AMP_TEST || win.__karma__);\n  const isLocalDev = IS_DEV && (localDevEnabled || runningTests);\n  const hashQuery = parseQueryString_(\n      // location.originalHash is set by the viewer when it removes the fragment\n      // from the URL.\n      win.location.originalHash || win.location.hash);\n\n  const searchQuery = parseQueryString_(win.location.search);\n\n  if (!rtvVersion) {\n    rtvVersion = getRtvVersion(win, isLocalDev);\n  }\n\n  // The `minified`, `test` and `localDev` properties are replaced\n  // as boolean literals when we run `gulp dist` without the `--fortesting`\n  // flags. This improved DCE on the production file we deploy as the code\n  // paths for localhost/testing/development are eliminated.\n  return {\n    localDev: isLocalDev,\n    // Triggers validation or enable pub level logging. Validation can be\n    // bypassed via #validate=0.\n    // Note that AMP_DEV_MODE flag is used for testing purposes.\n    development: !!(hashQuery['development'] == '1' || win.AMP_DEV_MODE),\n    examiner: hashQuery['development'] == '2',\n    // Allows filtering validation errors by error category. For the\n    // available categories, see ErrorCategory in validator/validator.proto.\n    filter: hashQuery['filter'],\n    // amp-geo override\n    geoOverride: hashQuery['amp-geo'],\n    minified: IS_MINIFIED,\n    // Whether document is in an amp-lite viewer. It signal that the user\n    // would prefer to use less bandwidth.\n    lite: searchQuery['amp_lite'] != undefined,\n    test: runningTests,\n    log: hashQuery['log'],\n    version,\n    rtvVersion,\n  };\n}\n\n/**\n * Retrieve the `rtvVersion` which will have a numeric prefix\n * denoting canary/prod/experiment (unless `isLocalDev` is true).\n *\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n */\nfunction getRtvVersion(win, isLocalDev) {\n  // If it's local dev then we won't actually have a full version so\n  // just use the version.\n  if (isLocalDev) {\n    return version;\n  }\n\n  if (win.AMP_CONFIG && win.AMP_CONFIG.v) {\n    return win.AMP_CONFIG.v;\n  }\n\n  // Currently `$internalRuntimeVersion$` and thus `mode.version` contain only\n  // major version. The full version however must also carry the minor version.\n  // We will default to production default `01` minor version for now.\n  // TODO(erwinmombay): decide whether $internalRuntimeVersion$ should contain\n  // minor version.\n  return `01${version}`;\n}\n\n\n/**\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n * @visibleForTesting\n */\nexport function getRtvVersionForTesting(win, isLocalDev) {\n  return getRtvVersion(win, isLocalDev);\n}\n\n\n/** @visibleForTesting */\nexport function resetRtvVersionForTesting() {\n  rtvVersion = '';\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n\n/**\n * This class helps to manage observers. Observers can be added, removed or\n * fired through and instance of this class.\n * @template TYPE\n */\nexport class Observable {\n\n  /**\n   * Creates an instance of Observable.\n   */\n  constructor() {\n    /** @type {?Array<function(TYPE)>} */\n    this.handlers_ = null;\n  }\n\n  /**\n   * Adds the observer to this instance.\n   * @param {function(TYPE)} handler Observer's handler.\n   * @return {!UnlistenDef}\n   */\n  add(handler) {\n    if (!this.handlers_) {\n      this.handlers_ = [];\n    }\n    this.handlers_.push(handler);\n    return () => {\n      this.remove(handler);\n    };\n  }\n\n  /**\n   * Removes the observer from this instance.\n   * @param {function(TYPE)} handler Observer's instance.\n   */\n  remove(handler) {\n    if (!this.handlers_) {\n      return;\n    }\n    const index = this.handlers_.indexOf(handler);\n    if (index > -1) {\n      this.handlers_.splice(index, 1);\n    }\n  }\n\n  /**\n   * Removes all observers.\n   */\n  removeAll() {\n    if (!this.handlers_) {\n      return;\n    }\n    this.handlers_.length = 0;\n  }\n\n  /**\n   * Fires an event. All observers are called.\n   * @param {TYPE=} opt_event\n   */\n  fire(opt_event) {\n    if (!this.handlers_) {\n      return;\n    }\n    const handlers = this.handlers_;\n    for (let i = 0; i < handlers.length; i++) {\n      const handler = handlers[i];\n      handler(opt_event);\n    }\n  }\n\n  /**\n   * Returns number of handlers. Mostly needed for tests.\n   * @return {number}\n   */\n  getHandlerCount() {\n    if (!this.handlers_) {\n      return 0;\n    }\n    return this.handlers_.length;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {install as installArrayIncludes} from './polyfills/array-includes';\nimport {install as installCustomElements} from './polyfills/custom-elements';\nimport {\n  install as installDOMTokenListToggle,\n} from './polyfills/domtokenlist-toggle';\nimport {install as installDocContains} from './polyfills/document-contains';\nimport {install as installMathSign} from './polyfills/math-sign';\nimport {install as installObjectAssign} from './polyfills/object-assign';\nimport {install as installPromise} from './polyfills/promise';\nimport {installCustomElements as installRegisterElement} from\n  'document-register-element/build/document-register-element.patched';\nimport {isExperimentOn} from './experiments';\n\nif (isExperimentOn(self, 'custom-elements-v1') || getMode().test) {\n  installCustomElements(self, class {});\n} else {\n  installRegisterElement(self, 'auto');\n}\ninstallDOMTokenListToggle(self);\ninstallMathSign(self);\ninstallObjectAssign(self);\ninstallPromise(self);\ninstallDocContains(self);\ninstallArrayIncludes(self);\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Returns true if the element is in the array and false otherwise.\n *\n * @param {*} value\n * @param {number=} opt_fromIndex\n * @return {boolean}\n * @this {Array}\n */\nfunction includes(value, opt_fromIndex) {\n  const fromIndex = opt_fromIndex || 0;\n  const len = this.length;\n  let i = fromIndex >= 0 ? fromIndex : Math.max(len + fromIndex, 0);\n  for (; i < len; i++) {\n    const other = this[i];\n    // If value has been found OR (value is NaN AND other is NaN)\n    /*eslint \"no-self-compare\": 0*/\n    if (other === value || (value !== value && other !== other)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n* Sets the Array.contains polyfill if it does not exist.\n* @param {!Window} win\n*/\nexport function install(win) {\n  if (!win.Array.prototype.includes) {\n    win.Object.defineProperty(Array.prototype, 'includes', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: includes,\n    });\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @typedef {{\n *   promise: !Promise<undefined>,\n *   resolve: function(),\n * }}\n */\nlet DeferredDef;\n\n/**\n * @typedef {!Function}\n */\nlet CustomElementConstructorDef;\n\n/**\n * @typedef {{\n *  name: string,\n *  ctor: !CustomElementConstructorDef,\n * }}\n */\nlet CustomElementDef;\n\n/**\n * Validates the custom element's name.\n * This intentionally ignores \"valid\" higher Unicode Code Points.\n * https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name\n */\nconst VALID_NAME = /^[a-z][a-z0-9._]*-[a-z0-9._-]*$/;\nconst INVALID_NAMES = [\n  'annotation-xml',\n  'color-profile',\n  'font-face',\n  'font-face-src',\n  'font-face-uri',\n  'font-face-format',\n  'font-face-name',\n  'missing-glyph',\n];\n\n/**\n * Asserts that the custom element name conforms to the spec.\n *\n * @param {!Function} SyntaxError\n * @param {string} name\n */\nfunction assertValidName(SyntaxError, name) {\n  if (!VALID_NAME.test(name) || INVALID_NAMES.indexOf(name) >= 0) {\n    throw new SyntaxError(`invalid custom element name \"${name}\"`);\n  }\n}\n\n/**\n * Does win have a full Custom Elements registry?\n *\n * @param {!Window} win\n * @return {boolean}\n */\nfunction hasCustomElements(win) {\n  const {customElements} = win;\n\n  return !!(\n    customElements &&\n    customElements.define &&\n    customElements.get &&\n    customElements.whenDefined);\n}\n\n/**\n * Was HTMLElement already patched for this window?\n *\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isPatched(win) {\n  const tag = win.HTMLElement.toString();\n  return tag.indexOf('[native code]') === -1;\n}\n\n/**\n * The public Custom Elements API.\n */\nclass CustomElementRegistry {\n  /**\n   * @param {!Window} win\n   * @param {!Registry} registry\n   */\n  constructor(win, registry) {\n    /**\n     * @const @private\n     */\n    this.win_ = win;\n\n    /**\n     * @const @private\n     */\n    this.registry_ = registry;\n\n    /**\n     * @type {!Object<string, DeferredDef>}\n     * @private\n     * @const\n     */\n    this.pendingDefines_ = this.win_.Object.create(null);\n  }\n\n  /**\n   * Register the custom element.\n   *\n   * @param {string} name\n   * @param {!CustomElementConstructorDef} ctor\n   * @param {!Object=} options\n   */\n  define(name, ctor, options) {\n    this.registry_.define(name, ctor, options);\n\n    // If anyone is waiting for this custom element to be defined, resolve\n    // their promise.\n    const pending = this.pendingDefines_;\n    const deferred = pending[name];\n    if (deferred) {\n      deferred.resolve();\n      delete pending[name];\n    }\n  }\n\n  /**\n   * Get the constructor of the (already defined) custom element.\n   *\n   * @param {string} name\n   * @return {!CustomElementConstructorDef|undefined}\n   */\n  get(name) {\n    const def = this.registry_.getByName(name);\n    if (def) {\n      return def.ctor;\n    }\n  }\n\n  /**\n   * Returns a promise that waits until the custom element is defined.\n   * If the custom element is already defined, returns a resolved promise.\n   *\n   * @param {string} name\n   * @return {!Promise<undefined>}\n   */\n  whenDefined(name) {\n    const {Promise, SyntaxError} = this.win_;\n    assertValidName(SyntaxError, name);\n\n    if (this.registry_.getByName(name)) {\n      return Promise.resolve();\n    }\n\n    const pending = this.pendingDefines_;\n    const deferred = pending[name];\n    if (deferred) {\n      return deferred.promise;\n    }\n\n    let resolve;\n    const promise = new /*OK*/Promise(res => resolve = res);\n    pending[name] = {\n      promise,\n      resolve,\n    };\n\n    return promise;\n  }\n\n  /**\n   * Upgrade all custom elements inside root.\n   *\n   * @param {!Node} root\n   */\n  upgrade(root) {\n    this.registry_.upgrade(root);\n  }\n}\n\n/**\n * This internal APIs necessary to run the CustomElementRegistry.\n * Since Registry is never exposed externally, all methods are actually\n * available on the instance.\n */\nclass Registry {\n  /**\n   * @param {!Window} win\n   */\n  constructor(win) {\n    /**\n     * @private @const\n     */\n    this.win_ = win;\n\n    /**\n     * @private @const\n     */\n    this.doc_ = win.document;\n\n    /**\n     * @type {!Object<string, !CustomElementDef>}\n     * @private\n     * @const\n     */\n    this.definitions_ = win.Object.create(null);\n\n    /**\n     * A up-to-date DOM selector for all custom elements.\n     * @type {string}\n     */\n    this.query_ = '';\n\n    /**\n     * The currently upgrading element.\n     * @private {Element}\n     */\n    this.current_ = null;\n  }\n\n  /**\n   * The currently-being-upgraded custom element.\n   *\n   * When an already created (through the DOM parsing APIs, or innerHTML)\n   * custom element node is being upgraded, we can't just create a new node\n   * (it's illegal in the spec). But we still need to run the custom element's\n   * constructor code on the node. We avoid this conundrum by running the\n   * constructor while returning this current node in the HTMLElement\n   * class constructor (the base class of all custom elements).\n   *\n   * @return {Element}\n   */\n  current() {\n    const current = this.current_;\n    this.current_ = null;\n    return current;\n  }\n\n  /**\n   * Finds the custom element definition by name.\n   *\n   * @param {string} name\n   * @return {CustomElementDef|undefined}\n   */\n  getByName(name) {\n    const definition = this.definitions_[name];\n    if (definition) {\n      return definition;\n    }\n  }\n\n  /**\n   * Finds the custom element definition by constructor instance.\n   *\n   * @param {CustomElementConstructorDef} ctor\n   * @return {CustomElementDef|undefined}\n   */\n  getByConstructor(ctor) {\n    const definitions = this.definitions_;\n\n    for (const name in definitions) {\n      const def = definitions[name];\n      if (def.ctor === ctor) {\n        return def;\n      }\n    }\n  }\n\n  /**\n   * Registers the custom element definition, and upgrades all elements by that\n   * name in the root document.\n   *\n   * @param {string} name\n   * @param {!CustomElementConstructorDef} ctor\n   * @param {!Object|undefined} options\n   */\n  define(name, ctor, options) {\n    const {Error, SyntaxError} = this.win_;\n\n    if (options) {\n      throw new Error('Extending native custom elements is not supported');\n    }\n\n    assertValidName(SyntaxError, name);\n\n    if (this.getByName(name) ||\n        this.getByConstructor(ctor)) {\n      throw new Error(`duplicate definition \"${name}\"`);\n    }\n\n    // TODO(jridgewell): Record connectedCallback, disconnectedCallback,\n    // adoptedCallback, attributeChangedCallback, and observedAttributes.\n    // TODO(jridgewell): If attributeChangedCallback, gather observedAttributes\n    this.definitions_[name] = {\n      name,\n      ctor,\n    };\n\n    this.observe_(name);\n    this.upgrade(this.doc_, name);\n  }\n\n  /**\n   * Upgrades custom elements descendants of root (but not including root).\n   *\n   * When called with an opt_query, it both upgrades and connects the custom\n   * elements (this is used during the custom element define algorithm).\n   *\n   * @param {!Node} root\n   * @param {string=} opt_query\n   */\n  upgrade(root, opt_query) {\n    // Only CustomElementRegistry.p.define provides a query (the newly defined\n    // custom element). In this case, we are both upgrading _and_ connecting\n    // the custom elements.\n    const newlyDefined = !!opt_query;\n    const query = opt_query || this.query_;\n    const upgradeCandidates = this.queryAll_(root, query);\n\n    for (let i = 0; i < upgradeCandidates.length; i++) {\n      const candidate = upgradeCandidates[i];\n      if (newlyDefined) {\n        this.connectedCallback_(candidate);\n      } else {\n        this.upgradeSelf(candidate);\n      }\n    }\n  }\n\n  /**\n   * Upgrades the custom element node, if a custom element has been registered\n   * by this name.\n   *\n   * @param {!Node} node\n   */\n  upgradeSelf(node) {\n    const def = this.getByName(node.localName);\n    if (!def) {\n      return;\n    }\n\n    this.upgradeSelf_(/** @type {!Element} */(node), def);\n  }\n\n  /**\n   * @param {!Node} root\n   * @param {string} query\n   * @return {!Array|!NodeList}\n   */\n  queryAll_(root, query) {\n    if (!query || !root.querySelectorAll) {\n      // Nothing to do...\n      return [];\n    }\n\n    return root.querySelectorAll(query);\n  }\n\n  /**\n   * Upgrades the (already created via DOM parsing) custom element.\n   *\n   * @param {!Element} node\n   * @param {!CustomElementDef} def\n   */\n  upgradeSelf_(node, def) {\n    const {ctor} = def;\n    if (node instanceof ctor) {\n      return;\n    }\n\n    // Despite how it looks, this is not a useless construction.\n    // HTMLElementPolyfill (the base class of all custom elements) will return\n    // the current node, allowing the custom element's subclass constructor to\n    // run on the node. The node itself is already constructed, so the return\n    // value is just the node.\n    this.current_ = node;\n    const el = new ctor();\n\n    if (el !== node) {\n      throw new this.win_.Error(\n          'Constructor illegally returned a different instance.');\n    }\n  }\n\n  /**\n   * Fires connectedCallback on the custom element, if it has one.\n   * This also upgrades the custom element, since it may not have been\n   * accessible via the root document before (a detached DOM tree).\n   *\n   * @param {!Node} node\n   */\n  connectedCallback_(node) {\n    const def = this.getByName(node.localName);\n    if (!def) {\n      return;\n    }\n    this.upgradeSelf_(/** @type {!Element} */(node), def);\n    // TODO(jridgewell): It may be appropriate to adoptCallback, if the node\n    // used to be in another doc.\n    // TODO(jridgewell): I should be calling the definitions connectedCallback\n    // with node as the context.\n    if (node.connectedCallback) {\n      node.connectedCallback();\n    }\n  }\n\n  /**\n   * Fires disconnectedCallback on the custom element, if it has one.\n   *\n   * @param {!Node} node\n   */\n  disconnectedCallback_(node) {\n    // TODO(jridgewell): I should be calling the definitions connectedCallback\n    // with node as the context.\n    if (node.disconnectedCallback) {\n      node.disconnectedCallback();\n    }\n  }\n\n  /**\n   * Records name as a registered custom element to observe.\n   *\n   * Starts the Mutation Observer if this is the first registered custom\n   * element. This is deferred until the first custom element is defined to\n   * speed up initial rendering of the page.\n   *\n   * Mutation Observers are conveniently available in every browser we care\n   * about. When a node is connected to the root document, all custom\n   * elements (including that node iteself) will be upgraded and call\n   * connectedCallback. When a node is disconnectedCallback from the root\n   * document, all custom elements will call disconnectedCallback.\n   *\n   * @param {string} name\n   */\n  observe_(name) {\n    if (this.query_) {\n      this.query_ += `,${name}`;\n      return;\n    }\n\n    this.query_ = name;\n\n    // The first registered name starts the mutation observer.\n    const observer = new this.win_.MutationObserver(records => {\n      if (records) {\n        this.handleRecords_(records);\n      }\n    });\n    observer.observe(this.doc_, {\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  /**\n   * Handle all the Mutation Observer's Mutation Records.\n   * All added custom elements will be upgraded (if not already) and call\n   * connectedCallback. All removed custom elements will call\n   * disconnectedCallback.\n   *\n   * @param {!Array<!MutationRecord>} records\n   */\n  handleRecords_(records) {\n    for (let i = 0; i < records.length; i++) {\n      const record = records[i];\n      if (!record) {\n        continue;\n      }\n\n      const {addedNodes, removedNodes} = record;\n      for (let i = 0; i < addedNodes.length; i++) {\n        const node = addedNodes[i];\n        const connectedCandidates = this.queryAll_(node, this.query_);\n        this.connectedCallback_(node);\n        for (let i = 0; i < connectedCandidates.length; i++) {\n          this.connectedCallback_(connectedCandidates[i]);\n        }\n      }\n\n      for (let i = 0; i < removedNodes.length; i++) {\n        const node = removedNodes[i];\n        const disconnectedCandidates = this.queryAll_(node, this.query_);\n        this.disconnectedCallback_(node);\n        for (let i = 0; i < disconnectedCandidates.length; i++) {\n          this.disconnectedCallback_(disconnectedCandidates[i]);\n        }\n      }\n    }\n  }\n}\n\n/**\n * Does the polyfilling.\n * @param {!Window} win\n */\nfunction polyfill(win) {\n  const {HTMLElement, Element, Node, Document, Object, document} = win;\n  const {createElement, cloneNode, importNode} = document;\n\n  const registry = new Registry(win);\n  const customElements = new CustomElementRegistry(win, registry);\n\n  // Expose the custom element registry.\n  // Object.getOwnPropertyDescriptor(window, 'customElements')\n  // {get: ƒ, set: undefined, enumerable: true, configurable: true}\n  Object.defineProperty(win, 'customElements', {\n    enumerable: true,\n    configurable: true,\n    // writable: false,\n    value: customElements,\n  });\n\n  // Patch createElement to immediately upgrade the custom element.\n  // This has the added benefit that it avoids the \"already created but needs\n  // constructor code run\" chicken-and-egg problem.\n  Document.prototype.createElement = function createElementPolyfill(name) {\n    const def = registry.getByName(name);\n    if (def) {\n      return new def.ctor();\n    }\n    return createElement.apply(this, arguments);\n  };\n\n  // Patch importNode to immediately upgrade custom elements.\n  // TODO(jridgewell): Can fire adoptedCallback for cross doc imports.\n  Document.prototype.importNode = function importNodePolyfill() {\n    const imported = importNode.apply(this, arguments);\n    if (imported) {\n      registry.upgradeSelf(imported);\n      registry.upgrade(imported);\n    }\n    return imported;\n  };\n\n  // Patch cloneNode to immediately upgrade custom elements.\n  Node.prototype.cloneNode = function cloneNodePolyfill() {\n    const cloned = cloneNode.apply(this, arguments);\n    registry.upgradeSelf(cloned);\n    registry.upgrade(cloned);\n    return cloned;\n  };\n\n  // Patch the innerHTML setter to immediately upgrade custom elements.\n  // Note, this could technically fire connectedCallbacks if this node was\n  // connected, but we leave that to the Mutation Observer.\n  const innerHTMLDesc = Object.getOwnPropertyDescriptor(Element.prototype,\n      'innerHTML');\n  const innerHTMLSetter = innerHTMLDesc.set;\n  innerHTMLDesc.set = function(html) {\n    innerHTMLSetter.call(this, html);\n    registry.upgrade(this);\n  };\n  Object.defineProperty(Element.prototype, 'innerHTML', innerHTMLDesc);\n\n  /**\n   * You can't use the real HTMLElement constructor, because you can't subclass\n   * it without using native classes. So, mock its approximation using\n   * createElement.\n   */\n  function HTMLElementPolyfill() {\n    const {constructor} = this;\n\n    // If we're upgrading an already created custom element, we can't create\n    // another new node (by the spec, it must be the same node).\n    let el = registry.current();\n\n    // If there's not a already created custom element, we're being invoked via\n    // `new`ing the constructor.\n    //\n    // Technically, we could get here via createElement, but we patched that.\n    // If it the custom element was registered, the patch turned it into a\n    // `new` call.\n    // If it was not registered, the native createElement is used. And if\n    // native createElement is being used and we got to this code, we're really\n    // in an infinite loop (a native createElement call just below) so we've\n    // got bigger problems.\n    //\n    // So just take my word we got here via `new`.\n    if (!el) {\n      // The custom element definition is an invariant. If the custom element\n      // is registered, everything works. If it's not, it throws in the member\n      // property access (only defined custom elements can be directly\n      // constructed via `new`).\n      const def = registry.getByConstructor(constructor);\n      el = createElement.call(document, def.name);\n    }\n\n    // Finally, if the node was already constructed, we need to reset it's\n    // prototype to the custom element prototype. And if it wasn't already\n    // constructed, we created a new node via native createElement, and we need\n    // to reset it's prototype. Basically always reset the prototype.\n    Object.setPrototypeOf(el, constructor.prototype);\n    return el;\n  }\n  subClass(Object, HTMLElement, HTMLElementPolyfill);\n\n  // Expose the polyfilled HTMLElement constructor for everyone to extend from.\n  win.HTMLElement = HTMLElementPolyfill;\n}\n\n/**\n * Wraps HTMLElement in a Reflect.construct constructor, so that transpiled\n * classes can `_this = superClass.call(this)` during their construction.\n *\n * This is only used when Custom Elements v1 is already available _and_ we're\n * using transpiled classes (which use ES5 construction idioms).\n *\n * @param {!Window} win\n */\nfunction wrapHTMLElement(win) {\n  const {HTMLElement, Reflect, Object} = win;\n  /**\n   */\n  function HTMLElementWrapper() {\n    const ctor = /** @type {function(...?):?|undefined} */(\n      /** @type {!HTMLElement} */(this).constructor);\n\n    // Reflect.construct allows us to construct a new HTMLElement without using\n    // `new` (which will always fail because native HTMLElement is a restricted\n    // constructor).\n    return Reflect.construct(HTMLElement, [], ctor);\n  }\n  subClass(Object, HTMLElement, HTMLElementWrapper);\n\n  // Expose the wrapped HTMLElement constructor for everyone to extend from.\n  win.HTMLElement = HTMLElementWrapper;\n}\n\n/**\n * Setups up prototype inheritance\n *\n * @param {!Object} Object\n * @param {!Function} superClass\n * @param {!Function} subClass\n */\nfunction subClass(Object, superClass, subClass) {\n  // Object.getOwnPropertyDescriptor(superClass.prototype, 'constructor')\n  // {value: ƒ, writable: true, enumerable: false, configurable: true}\n  subClass.prototype = Object.create(superClass.prototype, {\n    constructor: {\n      // enumerable: false,\n      configurable: true,\n      writable: true,\n      value: subClass,\n    },\n  });\n}\n\n/**\n * Polyfills Custom Elements v1 API. This has 4 modes:\n *\n * 1. Custom elements v1 already supported, using native classes\n * 2. Custom elements v1 already supported, using transpiled classes\n * 3. Custom elements v1 not supported, using native classes\n * 4. Custom elements v1 not supported, using transpiled classes\n *\n * In mode 1, nothing is done. In mode 2, a minimal polyfill is used to support\n * extending the HTMLElement base class. In mode 3 and 4, a full polyfill is\n * done.\n *\n * @param {!Window} win\n * @param {!Function} ctor\n */\nexport function install(win, ctor) {\n  if (isPatched(win)) {\n    return;\n  }\n\n  let install = true;\n  let installWrapper = false;\n\n  if (hasCustomElements(win)) {\n    // If ctor is constructable without new, it's a function. That means it was\n    // compiled down, and we need to do the minimal polyfill because all you\n    // cannot extend HTMLElement without native classes.\n    try {\n      const {Object, Reflect} = win;\n\n      // \"Construct\" ctor using ES5 idioms\n      const instance = Object.create(ctor.prototype);\n      ctor.call(instance);\n\n      // If that succeeded, we're in a transpiled environment\n      // Let's find out if we can wrap HTMLElement and avoid a full patch.\n      installWrapper = !!(Reflect && Reflect.construct);\n    } catch (e) {\n\n      // The ctor threw when we constructed is via ES5, so it's a real class.\n      // We're ok to not install the polyfill.\n      install = false;\n    }\n  }\n\n  if (installWrapper) {\n    wrapHTMLElement(win);\n  } else if (install) {\n    polyfill(win);\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Polyfill for `document.contains()` method. Notice that according to spec\n * `document.contains` is inclusionary.\n * See https://developer.mozilla.org/en-US/docs/Web/API/Node/contains\n * @param {?Node} node\n * @return {boolean}\n * @this {Node}\n */\nfunction documentContainsPolyfill(node) {\n  // Per spec, \"contains\" method is inclusionary\n  // i.e. `node.contains(node) == true`. However, we still need to test\n  // equality to the document itself.\n  return node == this || this.documentElement.contains(node);\n}\n\n\n/**\n * Polyfills `HTMLDocument.contains` API.\n * @param {!Window} win\n */\nexport function install(win) {\n  // HTMLDocument is undefined in Internet Explorer 10, but it has Document,\n  // so we use that as a fallback.\n  const documentClass = win.HTMLDocument || win.Document;\n  if (!documentClass.prototype.contains) {\n    win.Object.defineProperty(documentClass.prototype, 'contains', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: documentContainsPolyfill,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Polyfill for `DOMTokenList.prototype.toggle(token, opt_force)` method. This\n * is specially important because IE does not support `opt_force` attribute. See\n * https://goo.gl/hgKNYY for details.\n * @param {string} token\n * @param {boolean=} opt_force\n * @this {DOMTokenList}\n * @return {boolean}\n */\nfunction domTokenListTogglePolyfill(token, opt_force) {\n  const remove = opt_force === undefined ? this.contains(token) : !opt_force;\n  if (remove) {\n    this.remove(token);\n    return false;\n  } else {\n    this.add(token);\n    return true;\n  }\n}\n\n\n/**\n * Polyfills `DOMTokenList.prototype.toggle` API in IE.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (isIe(win) && win.DOMTokenList) {\n    win.Object.defineProperty(win.DOMTokenList.prototype, 'toggle', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: domTokenListTogglePolyfill,\n    });\n  }\n}\n\n\n/**\n * Whether the current browser is a IE browser.\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isIe(win) {\n  return /Trident|MSIE|IEMobile/i.test(win.navigator.userAgent);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Parses the number x and returns its sign. For positive x returns 1, for\n * negative, -1. For 0 and -0, returns 0 and -0 respectively. For any number\n * that parses to NaN, returns NaN.\n *\n * @param {number} x\n * @return {number}\n */\nexport function sign(x) {\n  x = Number(x);\n\n  // If x is 0, -0, or NaN, return it.\n  if (!x) {\n    return x;\n  }\n\n  return x > 0 ? 1 : -1;\n}\n\n\n/**\n * Sets the Math.sign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Math.sign) {\n    win.Object.defineProperty(win.Math, 'sign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: sign,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst {hasOwnProperty} = Object.prototype;\n\n/**\n * Copies values of all enumerable own properties from one or more source\n * objects (provided as extended arguments to the function) to a target object.\n *\n * @param {!Object} target\n * @param {...Object} var_args\n * @return {!Object}\n */\nexport function assign(target, var_args) {\n  if (target == null) {\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  const output = Object(target);\n  for (let i = 1; i < arguments.length; i++) {\n    const source = arguments[i];\n    if (source != null) {\n      for (const key in source) {\n        if (hasOwnProperty.call(source, key)) {\n          output[key] = source[key];\n        }\n      }\n    }\n  }\n  return output;\n}\n\n\n/**\n * Sets the Object.assign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Object.assign) {\n    win.Object.defineProperty(win.Object, 'assign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: assign,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nimport * as Promise from 'promise-pjs/promise';\n\n/**\n * Sets the Promise polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Promise) {\n    win.Promise = /** @type {?} */ (Promise);\n    // In babel the * export is an Object with a default property.\n    // In closure compiler it is the Promise function itself.\n    if (Promise.default) {\n      win.Promise = Promise.default;\n    }\n    // We copy the individual static methods, because closure\n    // compiler flattens the polyfill namespace.\n    win.Promise.resolve = Promise.resolve;\n    win.Promise.reject = Promise.reject;\n    win.Promise.all = Promise.all;\n    win.Promise.race = Promise.race;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Registration and getter functions for AMP services.\n *\n * Invariant: Service getters never return null for registered services.\n */\n\n// src/polyfills.js must be the first import.\nimport './polyfills'; // eslint-disable-line sort-imports-es6-autofix/sort-imports-es6\n\nimport {Deferred} from './utils/promise';\nimport {dev} from './log';\nimport {toWin} from './types';\n\n\n/**\n * Holds info about a service.\n * - obj: Actual service implementation when available.\n * - promise: Promise for the obj.\n * - resolve: Function to resolve the promise with the object.\n * - context: Argument for ctor, either a window or an ampdoc.\n * - ctor: Function that constructs and returns the service.\n * @typedef {{\n *   obj: (?Object),\n *   promise: (?Promise),\n *   resolve: (?function(!Object)),\n *   context: (?Window|?./service/ampdoc-impl.AmpDoc),\n *   ctor: (?function(new:Object, !Window)|\n *          ?function(new:Object, !./service/ampdoc-impl.AmpDoc)),\n * }}\n */\nlet ServiceHolderDef;\n\n\n/**\n * This interface provides a `dispose` method that will be called by\n * runtime when a service needs to be disposed of.\n * @interface\n */\nexport class Disposable {\n\n  /**\n   * Instructs the service to release any resources it might be holding. Can\n   * be called only once in the lifecycle of a service.\n   */\n  dispose() {}\n}\n\n\n/**\n * This interface provides a `adoptEmbedWindow` method that will be called by\n * runtime for a new embed window.\n * @interface\n */\nexport class EmbeddableService {\n\n  /**\n   * Instructs the service to adopt the embed window and add any necessary\n   * listeners and resources.\n   * @param {!Window} unusedEmbedWin\n   */\n  adoptEmbedWindow(unusedEmbedWin) {}\n}\n\n\n/**\n * Returns a service with the given id. Assumes that it has been registered\n * already.\n * @param {!Window} win\n * @param {string} id\n * @param {boolean=} opt_fallbackToTopWin\n * @return {Object} The service.\n */\nexport function getExistingServiceInEmbedScope(win, id, opt_fallbackToTopWin) {\n  // First, try to resolve via local (embed) window.\n  const local = getLocalExistingServiceForEmbedWinOrNull(win, id);\n  if (local) {\n    return local;\n  }\n  if (opt_fallbackToTopWin) {\n    return getService(win, id);\n  }\n  return null;\n}\n\n/**\n * Returns a service with the given id. Assumes that it has been constructed\n * already.\n *\n * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n * services since sometimes we only have the FIE Document for context.\n *\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id\n * @param {boolean=} opt_fallbackToTopWin\n * @return {Object} The service.\n */\nexport function getExistingServiceForDocInEmbedScope(\n  nodeOrDoc, id, opt_fallbackToTopWin) {\n  // First, try to resolve via local (embed) window.\n  if (nodeOrDoc.nodeType) {\n    // If a node is passed, try to resolve via this node.\n    const win = toWin(/** @type {!Document} */ (\n      nodeOrDoc.ownerDocument || nodeOrDoc).defaultView);\n    const local = getLocalExistingServiceForEmbedWinOrNull(win, id);\n    if (local) {\n      return local;\n    }\n  }\n  // If an ampdoc is passed or fallback is allowed, continue resolving.\n  if (!nodeOrDoc.nodeType || opt_fallbackToTopWin) {\n    return getServiceForDocDeprecated(nodeOrDoc, id);\n  }\n  return null;\n}\n\n/**\n * Installs a service override on amp-doc level.\n * @param {!Window} embedWin\n * @param {string} id\n * @param {!Object} service The service.\n */\nexport function installServiceInEmbedScope(embedWin, id, service) {\n  const topWin = getTopWindow(embedWin);\n  dev().assert(embedWin != topWin,\n      'Service override can only be installed in embed window: %s', id);\n  dev().assert(!getLocalExistingServiceForEmbedWinOrNull(embedWin, id),\n      'Service override has already been installed: %s', id);\n  registerServiceInternal(embedWin, embedWin, id, () => service);\n  getServiceInternal(embedWin, id); // Force service to build.\n}\n\n/**\n * @param {!Window} embedWin\n * @param {string} id\n * @return {?Object}\n */\nfunction getLocalExistingServiceForEmbedWinOrNull(embedWin, id) {\n  // Note that this method currently only resolves against the given window.\n  // It does not try to go all the way up the parent window chain. We can change\n  // this in the future, but for now this gives us a better performance.\n  const topWin = getTopWindow(embedWin);\n  if (embedWin != topWin && isServiceRegistered(embedWin, id)) {\n    return getServiceInternal(embedWin, id);\n  } else {\n    return null;\n  }\n}\n\n/**\n * Registers a service given a class to be used as implementation.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {function(new:Object, !Window)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilder(win,\n  id,\n  constructor,\n  opt_instantiate) {\n  win = getTopWindow(win);\n  registerServiceInternal(win, win, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(win, id);\n  }\n}\n\n\n/**\n * Returns a service and registers it given a class to be used as\n * implementation.\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id of the service.\n * @param {function(new:Object, !./service/ampdoc-impl.AmpDoc)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilderForDoc(nodeOrDoc,\n  id,\n  constructor,\n  opt_instantiate) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  registerServiceInternal(holder, ampdoc, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(holder, id);\n  }\n}\n\n\n/**\n * Returns a service for the given id and window (a per-window singleton). Users\n * should typically wrap this as a special purpose function (e.g.\n * `Services.vsyncFor(win)`) for type safety and because the factory should not\n * be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @template T\n * @return {T}\n */\nexport function getService(win, id) {\n  win = getTopWindow(win);\n  return getServiceInternal(win, id);\n}\n\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. `Services.vsyncFor(win)`) for type safety and because the\n * factory should not be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nexport function getServicePromise(win, id) {\n  return getServicePromiseInternal(win, id);\n}\n\n\n/**\n * Returns a service or null with the given id.\n * @param {!Window} win\n * @param {string} id\n * @return {?Object} The service.\n */\nexport function getExistingServiceOrNull(win, id) {\n  win = getTopWindow(win);\n  if (isServiceRegistered(win, id)) {\n    return getServiceInternal(win, id);\n  } else {\n    return null;\n  }\n}\n\n\n/**\n * Like getServicePromise but returns null if the service was never registered.\n * @param {!Window} win\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNull(win, id) {\n  return getServicePromiseOrNullInternal(win, id);\n}\n\n\n/**\n * Returns a service for the given id and ampdoc (a per-ampdoc singleton).\n * Expects service `id` to be registered.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {T}\n * @template T\n */\nexport function getServiceForDoc(elementOrAmpDoc, id) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  return getServiceInternal(holder, id);\n}\n\n\n/**\n * tl;dr -- Use getServiceForDoc() instead of this.\n *\n * Privileged variant of getServiceForDoc() that accepts non-element params,\n * e.g. window.document. This is currently necessary for doc-level services\n * used in startup, e.g. Chunks. Eventually we want to remove this function\n * and have callers find the appropriate AmpDoc and use getServiceForDoc().\n *\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id\n * @return {T}\n * @template T\n */\nexport function getServiceForDocDeprecated(nodeOrDoc, id) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  return getServiceInternal(holder, id);\n}\n\n\n/**\n * Returns a promise for a service for the given id and ampdoc. Also expects\n * a service that has the actual implementation. The promise resolves when\n * the implementation loaded.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {!Promise<!Object>}\n */\nexport function getServicePromiseForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseInternal(\n      getAmpdocServiceHolder(elementOrAmpDoc), id);\n}\n\n\n/**\n * Like getServicePromiseForDoc but returns null if the service was never\n * registered for this ampdoc.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNullForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseOrNullInternal(\n      getAmpdocServiceHolder(elementOrAmpDoc), id);\n}\n\n/**\n * Set the parent and top windows on a child window (friendly iframe).\n * @param {!Window} win\n * @param {!Window} parentWin\n */\nexport function setParentWindow(win, parentWin) {\n  win.__AMP_PARENT = parentWin;\n  win.__AMP_TOP = getTopWindow(parentWin);\n}\n\n\n/**\n * Returns the parent window for a child window (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getParentWindow(win) {\n  return win.__AMP_PARENT || win;\n}\n\n\n/**\n * Returns the top window where AMP Runtime is installed for a child window\n * (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getTopWindow(win) {\n  return win.__AMP_TOP || win;\n}\n\n\n/**\n * Returns the parent \"friendly\" iframe if the node belongs to a child window.\n * @param {!Node} node\n * @param {!Window} topWin\n * @return {?HTMLIFrameElement}\n */\nexport function getParentWindowFrameElement(node, topWin) {\n  const childWin = (node.ownerDocument || node).defaultView;\n  if (childWin && childWin != topWin && getTopWindow(childWin) == topWin) {\n    try {\n      return /** @type {?HTMLIFrameElement} */ (childWin.frameElement);\n    } catch (e) {\n      // Ignore the error.\n    }\n  }\n  return null;\n}\n\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc}\n */\nexport function getAmpdoc(nodeOrDoc) {\n  if (nodeOrDoc.nodeType) {\n    const win = toWin(/** @type {!Document} */ (\n      nodeOrDoc.ownerDocument || nodeOrDoc).defaultView);\n    return getAmpdocService(win).getAmpDoc(/** @type {!Node} */ (nodeOrDoc));\n  }\n  return /** @type {!./service/ampdoc-impl.AmpDoc} */ (nodeOrDoc);\n}\n\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc|!Window}\n */\nfunction getAmpdocServiceHolder(nodeOrDoc) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  return ampdoc.isSingleDoc() ? ampdoc.win : ampdoc;\n}\n\n\n/**\n * This is essentially a duplicate of `ampdoc.js`, but necessary to avoid\n * circular dependencies.\n * @param {!Window} win\n * @return {!./service/ampdoc-impl.AmpDocService}\n */\nfunction getAmpdocService(win) {\n  return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n    getService(win, 'ampdoc'));\n}\n\n\n/**\n * Get service `id` from `holder`. Assumes the service\n * has already been registered.\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {Object}\n * @template T\n */\nfunction getServiceInternal(holder, id) {\n  dev().assert(isServiceRegistered(holder, id),\n      `Expected service ${id} to be registered`);\n  const services = getServices(holder);\n  const s = services[id];\n  if (!s.obj) {\n    dev().assert(s.ctor, `Service ${id} registered without ctor nor impl.`);\n    dev().assert(s.context, `Service ${id} registered without context.`);\n    s.obj = new s.ctor(s.context);\n    dev().assert(s.obj, `Service ${id} constructed to null.`);\n    s.ctor = null;\n    s.context = null;\n    // The service may have been requested already, in which case we have a\n    // pending promise we need to fulfill.\n    if (s.resolve) {\n      s.resolve(s.obj);\n    }\n  }\n  return s.obj;\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {!Window|!./service/ampdoc-impl.AmpDoc} context Win or AmpDoc.\n * @param {string} id of the service.\n * @param {?function(new:Object, !Window)|?function(new:Object, !./service/ampdoc-impl.AmpDoc)} ctor Constructor function to new the service. Called with context.\n */\nfunction registerServiceInternal(holder, context, id, ctor) {\n  const services = getServices(holder);\n  let s = services[id];\n\n  if (!s) {\n    s = services[id] = {\n      obj: null,\n      promise: null,\n      resolve: null,\n      context: null,\n      ctor: null,\n    };\n  }\n\n  if (s.ctor || s.obj) {\n    // Service already registered.\n    return;\n  }\n\n  s.ctor = ctor;\n  s.context = context;\n\n  // The service may have been requested already, in which case there is a\n  // pending promise that needs to fulfilled.\n  if (s.resolve) {\n    // getServiceInternal will resolve the promise.\n    getServiceInternal(holder, id);\n  }\n}\n\n/**\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nfunction getServicePromiseInternal(holder, id) {\n  const cached = getServicePromiseOrNullInternal(holder, id);\n  if (cached) {\n    return cached;\n  }\n  // Service is not registered.\n\n  // TODO(@cramforce): Add a check that if the element is eventually registered\n  // that the service is actually provided and this promise resolves.\n  const deferred = new Deferred();\n  const {promise, resolve} = deferred;\n\n  const services = getServices(holder);\n  services[id] = {\n    obj: null,\n    promise,\n    resolve,\n    context: null,\n    ctor: null,\n  };\n  return promise;\n}\n\n\n/**\n * Returns a promise for service `id` if the service has been registered\n * on `holder`.\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {?Promise<!Object>}\n */\nfunction getServicePromiseOrNullInternal(holder, id) {\n  const services = getServices(holder);\n  const s = services[id];\n  if (s) {\n    if (s.promise) {\n      return s.promise;\n    } else {\n      // Instantiate service if not already instantiated.\n      getServiceInternal(holder, id);\n      return s.promise = Promise.resolve(/** @type {!Object} */ (s.obj));\n    }\n  }\n  return null;\n}\n\n\n/**\n * Returns the object that holds the services registered in a holder.\n * @param {!Object} holder\n * @return {!Object<string,!ServiceHolderDef>}\n */\nfunction getServices(holder) {\n  let {services} = holder;\n  if (!services) {\n    services = holder.services = {};\n  }\n  return services;\n}\n\n\n/**\n * Whether the specified service implements `Disposable` interface.\n * @param {!Object} service\n * @return {boolean}\n */\nexport function isDisposable(service) {\n  return typeof service.dispose == 'function';\n}\n\n\n/**\n * Asserts that the specified service implements `Disposable` interface and\n * typecasts the instance to `Disposable`.\n * @param {!Object} service\n * @return {!Disposable}\n */\nexport function assertDisposable(service) {\n  dev().assert(isDisposable(service), 'required to implement Disposable');\n  return /** @type {!Disposable} */ (service);\n}\n\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * ampdoc scope.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n */\nexport function disposeServicesForDoc(ampdoc) {\n  disposeServicesInternal(ampdoc);\n}\n\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * embed scope.\n * @param {!Window} embedWin\n */\nexport function disposeServicesForEmbed(embedWin) {\n  disposeServicesInternal(embedWin);\n}\n\n\n/**\n * @param {!Object} holder Object holding the service instances.\n */\nfunction disposeServicesInternal(holder) {\n  // TODO(dvoytenko): Consider marking holder as destroyed for later-arriving\n  // service to be canceled automatically.\n  const services = getServices(holder);\n  for (const id in services) {\n    if (!Object.prototype.hasOwnProperty.call(services, id)) {\n      continue;\n    }\n    const serviceHolder = services[id];\n    if (serviceHolder.obj) {\n      disposeServiceInternal(id, serviceHolder.obj);\n    } else if (serviceHolder.promise) {\n      serviceHolder.promise.then(\n          instance => disposeServiceInternal(id, instance));\n    }\n  }\n}\n\n\n/**\n * @param {string} id\n * @param {!Object} service\n */\nfunction disposeServiceInternal(id, service) {\n  if (!isDisposable(service)) {\n    return;\n  }\n  try {\n    assertDisposable(service).dispose();\n  } catch (e) {\n    // Ensure that a failure to dispose a service does not disrupt other\n    // services.\n    dev().error('SERVICE', 'failed to dispose service', id, e);\n  }\n}\n\n\n/**\n * Whether the specified service implements `EmbeddableService` interface.\n * @param {!Object} service\n * @return {boolean}\n */\nexport function isEmbeddable(service) {\n  return typeof service.adoptEmbedWindow == 'function';\n}\n\n\n/**\n * Adopts an embeddable (implements `EmbeddableService` interface) service\n * in embed scope.\n * @param {!Window} embedWin\n * @param {string} serviceId\n */\nexport function adoptServiceForEmbed(embedWin, serviceId) {\n  const adopted = adoptServiceForEmbedIfEmbeddable(embedWin, serviceId);\n  dev().assert(adopted, `Service ${serviceId} not found on parent ` +\n      'or doesn\\'t implement EmbeddableService.');\n}\n\n\n/**\n * Adopts an embeddable (implements `EmbeddableService` interface) service\n * in embed scope.\n * @param {!Window} embedWin\n * @param {string} serviceId\n * @return {boolean}\n */\nexport function adoptServiceForEmbedIfEmbeddable(embedWin, serviceId) {\n  const frameElement = /** @type {!Node} */ (dev().assert(\n      embedWin.frameElement,\n      'frameElement not found for embed'));\n  const ampdoc = getAmpdoc(frameElement);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  if (!isServiceRegistered(holder, serviceId)) {\n    return false;\n  }\n  const service = getServiceForDocDeprecated(frameElement, serviceId);\n  if (!isEmbeddable(service)) {\n    return false;\n  }\n  service.adoptEmbedWindow(embedWin);\n  return true;\n}\n\n\n/**\n * Resets a single service, so it gets recreated on next getService invocation.\n * @param {!Object} holder\n * @param {string} id of the service.\n */\nexport function resetServiceForTesting(holder, id) {\n  if (holder.services) {\n    holder.services[id] = null;\n  }\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {boolean}\n */\nfunction isServiceRegistered(holder, id) {\n  const service = holder.services && holder.services[id];\n  // All registered services must have an implementation or a constructor.\n  return !!(service && (service.ctor || service.obj));\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getAmpdoc,\n  getExistingServiceForDocInEmbedScope,\n  getExistingServiceOrNull,\n  getService,\n  getServiceForDoc,\n  getServiceForDocDeprecated,\n  getServicePromiseForDoc,\n} from './service';\nimport {\n  getElementServiceForDoc,\n  getElementServiceIfAvailable,\n  getElementServiceIfAvailableForDoc,\n  getElementServiceIfAvailableForDocInEmbedScope,\n} from './element-service';\n\n/** @typedef {!../extensions/amp-subscriptions/0.1/amp-subscriptions.SubscriptionService} */\nexport let SubscriptionService;\n\nexport class Services {\n  /**\n   * Hint: Add extensions folder path to compile.js with\n   * warnings cannot find modules.\n   */\n\n  /**\n   * Returns a promise for the Access service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'access', 'amp-access')));\n  }\n\n  /**\n   * Returns a promise for the Access service or a promise for null if the\n   * service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc, 'access',\n          'amp-access')));\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!SubscriptionService>}\n   */\n  static subscriptionsServiceForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!SubscriptionService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'subscriptions',\n          'amp-subscriptions')));\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?SubscriptionService>}\n   */\n  static subscriptionsServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?SubscriptionService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc, 'subscriptions',\n          'amp-subscriptions')));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/action-impl.ActionService}\n   */\n  static actionServiceForDoc(nodeOrDoc) {\n    return /** @type {!./service/action-impl.ActionService} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'action', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!Activity>}\n   */\n  static activityForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!Activity>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'activity', 'amp-analytics'));\n  }\n\n  /**\n   * Returns the global instance of the `AmpDocService` service that can be\n   * used to resolve an ampdoc for any node: either in the single-doc or\n   * shadow-doc environment.\n   * @param {!Window} window\n   * @return {!./service/ampdoc-impl.AmpDocService}\n   */\n  static ampdocServiceFor(window) {\n    return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n      getService(window, 'ampdoc'));\n  }\n\n  /**\n   * Returns the AmpDoc for the specified context node.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/ampdoc-impl.AmpDoc}\n   */\n  static ampdoc(elementOrAmpDoc) {\n    return getAmpdoc(elementOrAmpDoc);\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @param {boolean=} loadAnalytics\n   * @return {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDoc(elementOrAmpDoc, loadAnalytics = false) {\n    if (loadAnalytics) {\n      // Get Extensions service and force load analytics extension.\n      const ampdoc = getAmpdoc(elementOrAmpDoc);\n      Services.extensionsFor(ampdoc.win)./*OK*/installExtensionForDoc(\n          ampdoc, 'amp-analytics');\n    }\n    return /** @type {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'amp-analytics-instrumentation',\n          'amp-analytics'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc,\n          'amp-analytics-instrumentation', 'amp-analytics'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/batched-xhr-impl.BatchedXhr}\n   */\n  static batchedXhrFor(window) {\n    return /** @type {!./service/batched-xhr-impl.BatchedXhr} */ (\n      getService(window, 'batched-xhr'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>}\n   */\n  static bindForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>} */ (\n      getElementServiceIfAvailableForDocInEmbedScope(\n          elementOrAmpDoc, 'bind', 'amp-bind'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/cid-impl.Cid>}\n   */\n  static cidForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/cid-impl.Cid>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'cid'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/navigation.Navigation}\n   */\n  static navigationForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/navigation.Navigation} */ (\n      getServiceForDoc(elementOrAmpDoc, 'navigation'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/crypto-impl.Crypto}\n   */\n  static cryptoFor(window) {\n    return (/** @type {!./service/crypto-impl.Crypto} */ (\n      getService(window, 'crypto')));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/document-info-impl.DocumentInfoDef} Info about the doc\n   */\n  static documentInfoForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/document-info-impl.DocInfo} */ (\n      getServiceForDoc(elementOrAmpDoc, 'documentInfo')).get();\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/document-state.DocumentState}\n   */\n  static documentStateFor(window) {\n    return getService(window, 'documentState');\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/extensions-impl.Extensions}\n   */\n  static extensionsFor(window) {\n    return /** @type {!./service/extensions-impl.Extensions} */ (\n      getService(window, 'extensions'));\n  }\n\n  /**\n   * Returns service implemented in service/history-impl.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/history-impl.History}\n   */\n  static historyForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/history-impl.History} */ (\n      getServiceForDoc(elementOrAmpDoc, 'history'));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!./input.Input}\n   */\n  static inputFor(win) {\n    return getService(win, 'input');\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/layers-impl.LayoutLayers}\n   */\n  static layersForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/layers-impl.LayoutLayers} */ (\n      getServiceForDoc(elementOrAmpDoc, 'layers'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceFor(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getService(window, 'performance'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceForOrNull(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getExistingServiceOrNull(window, 'performance'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/platform-impl.Platform}\n   */\n  static platformFor(window) {\n    return /** @type {!./service/platform-impl.Platform} */ (\n      getService(window, 'platform'));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Resources is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/resources-impl.Resources}\n   */\n  static resourcesForDoc(nodeOrDoc) {\n    return /** @type {!./service/resources-impl.Resources} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'resources'));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?{incomingFragment: string, outgoingFragment: string}>}\n   */\n  static shareTrackingForOrNull(win) {\n    return (/** @type {!Promise<?{incomingFragment: string, outgoingFragment: string}>} */ (\n      getElementServiceIfAvailable(win, 'share-tracking',\n          'amp-share-tracking', true)));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/variable-service.StoryVariableDef>}\n   */\n  static storyVariableServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/variable-service.StoryVariableDef>} */\n      (getElementServiceIfAvailable(win, 'story-variable', 'amp-story',\n          true)));\n  }\n\n  /**\n   * Version of the story store service depends on which version of amp-story\n   * the publisher is loading. They all have the same implementation.\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService|?../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService>}\n   */\n  static storyStoreServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService|?../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService>} */\n      (getElementServiceIfAvailable(win, 'story-store', 'amp-story')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService}\n   */\n  static storyStoreService(win) {\n    return (/** @type {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService} */\n      (getExistingServiceOrNull(win, 'story-store')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService}\n   */\n  static storyRequestService(win) {\n    return (/** @type {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService} */\n      (getExistingServiceOrNull(win, 'story-request')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!Promise<?../extensions/amp-story/1.0/localization.LocalizationService>}\n   */\n  static localizationServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/localization.LocalizationService>} */\n      (getElementServiceIfAvailable(win, 'localization', 'amp-story', true)));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/1.0/localization.LocalizationService}\n   */\n  static localizationService(win) {\n    return getService(win, 'localization');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService}\n   */\n  static storyStoreServiceV01(win) {\n    return getService(win, 'story-store');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/amp-story-request-service.AmpStoryRequestService}\n   */\n  static storyRequestServiceV01(win) {\n    return getService(win, 'story-request-v01');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!Promise<?../extensions/amp-story/0.1/localization.LocalizationService>}\n   */\n  static localizationServiceForOrNullV01(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/0.1/localization.LocalizationService>} */\n      (getElementServiceIfAvailable(win, 'localization-v01', 'amp-story',\n          true)));\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/localization.LocalizationService}\n   */\n  static localizationServiceV01(win) {\n    return getService(win, 'localization-v01');\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-viewer-integration/0.1/variable-service.ViewerIntegrationVariableDef>}\n   */\n  static viewerIntegrationVariableServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-viewer-integration/0.1/variable-service.ViewerIntegrationVariableDef>} */\n      (getElementServiceIfAvailable(win, 'viewer-integration-variable',\n          'amp-viewer-integration', true)));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>}\n   */\n  static webAnimationServiceFor(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>} */\n      (getElementServiceForDoc(\n          elementOrAmpDoc, 'web-animation', 'amp-animation')));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/storage-impl.Storage>}\n   */\n  static storageForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/storage-impl.Storage>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'storage'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/template-impl.Templates}\n   */\n  static templatesFor(window) {\n    return /** @type {!./service/template-impl.Templates} */ (\n      getService(window, 'templates'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/timer-impl.Timer}\n   */\n  static timerFor(window) {\n    return /** @type {!./service/timer-impl.Timer} */ (\n      getService(window, 'timer'));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/url-replacements-impl.UrlReplacements}\n   */\n  static urlReplacementsForDoc(nodeOrDoc) {\n    return /** @type {!./service/url-replacements-impl.UrlReplacements} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'url-replace', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>}\n   */\n  static userNotificationManagerForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>} */\n      (getElementServiceForDoc(elementOrAmpDoc, 'userNotificationManager',\n          'amp-user-notification')));\n  }\n\n  /**\n   * Returns a promise for the consentPolicy Service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>}\n   */\n  static consentPolicyServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>} */\n      (getElementServiceIfAvailableForDoc(elementOrAmpDoc,\n          'consentPolicyManager', 'amp-consent')));\n  }\n\n  /**\n   * Returns a promise for the geo service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>}\n   */\n  static geoForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>} */ (\n      getElementServiceIfAvailableForDoc(\n          elementOrAmpDoc, 'geo', 'amp-geo', true));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/url-impl.Url}\n   */\n  static urlForDoc(nodeOrDoc) {\n    return /** @type {!./service/url-impl.Url} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'url', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * Returns a promise for the experiment variants or a promise for null if it\n   * is not available on the current page.\n   * @param {!Window} win\n   * @return {!Promise<?Object<string>>}\n   */\n  static variantForOrNull(win) {\n    return /** @type {!Promise<?Object<string>>} */ (\n      getElementServiceIfAvailable(win, 'variant', 'amp-experiment', true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/video-service-interface.VideoServiceInterface}\n   */\n  static videoManagerForDoc(elementOrAmpDoc) {\n    return (\n      /** @type {!./service/video-service-interface.VideoServiceInterface} */ (\n        getServiceForDoc(elementOrAmpDoc, 'video-manager')));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Viewer is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/viewer-impl.Viewer}\n   */\n  static viewerForDoc(nodeOrDoc) {\n    return /** @type {!./service/viewer-impl.Viewer} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'viewer'));\n  }\n\n  /**\n   * Returns promise for the viewer. This is an unusual case and necessary only\n   * for services that need reference to the viewer before it has been\n   * initialized. Most of the code, however, just should use `viewerForDoc`.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/viewer-impl.Viewer>}\n   */\n  static viewerPromiseForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/viewer-impl.Viewer>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'viewer'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/vsync-impl.Vsync}\n   */\n  static vsyncFor(window) {\n    return /** @type {!./service/vsync-impl.Vsync} */ (\n      getService(window, 'vsync'));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Viewport is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/viewport/viewport-impl.Viewport}\n   */\n  static viewportForDoc(nodeOrDoc) {\n    return /** @type {!./service/viewport/viewport-impl.Viewport} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'viewport'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/xhr-impl.Xhr}\n   */\n  static xhrFor(window) {\n    return /** @type {!./service/xhr-impl.Xhr} */ (getService(window, 'xhr'));\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {string} _match\n * @param {string} character\n * @return {string}\n */\nfunction toUpperCase(_match, character) {\n  return character.toUpperCase();\n}\n\n/**\n * @param {string} match\n * @return {string}\n */\nfunction prependDashAndToLowerCase(match) {\n  return '-' + match.toLowerCase();\n}\n\n/**\n * @param {string} name Attribute name containing dashes.\n * @return {string} Dashes removed and successive character sent to upper case.\n * visibleForTesting\n */\nexport function dashToCamelCase(name) {\n  return name.replace(/-([a-z])/g, toUpperCase);\n}\n\n/**\n * Converts a string that is in camelCase to one that is in dash-case.\n *\n * @param {string} string The string to convert.\n * @return {string} The string in dash-case.\n */\nexport function camelCaseToDash(string) {\n  return string.replace(/(?!^)[A-Z]/g, prependDashAndToLowerCase);\n}\n\n/**\n * @param {string} name Attribute name with dashes\n * @return {string} Dashes replaced by underlines.\n */\nexport function dashToUnderline(name) {\n  return name.replace('-', '_');\n}\n\n/**\n * Polyfill for String.prototype.endsWith.\n * @param {string} string\n * @param {string} suffix\n * @return {boolean}\n */\nexport function endsWith(string, suffix) {\n  const index = string.length - suffix.length;\n  return index >= 0 && string.indexOf(suffix, index) == index;\n}\n\n/**\n * Polyfill for String.prototype.startsWith.\n * @param {string} string\n * @param {string} prefix\n * @return {boolean}\n */\nexport function startsWith(string, prefix) {\n  if (prefix.length > string.length) {\n    return false;\n  }\n  return string.lastIndexOf(prefix, 0) == 0;\n}\n\n/**\n * Expands placeholders in a given template string with values.\n *\n * Placeholders use ${key-name} syntax and are replaced with the value\n * returned from the given getter function.\n *\n * @param {string} template The template string to expand.\n * @param {function(string):*} getter Function used to retrieve a value for a\n *   placeholder. Returns values will be coerced into strings.\n * @param {number=} opt_maxIterations Number of times to expand the template.\n *   Defaults to 1, but should be set to a larger value your placeholder tokens\n *   can be expanded to other placeholder tokens. Take caution with large values\n *   as recursively expanding a string can be exponentially expensive.\n */\nexport function expandTemplate(template, getter, opt_maxIterations) {\n  const maxIterations = opt_maxIterations || 1;\n  for (let i = 0; i < maxIterations; i++) {\n    let matches = 0;\n    template = template.replace(/\\${([^}]*)}/g, (_a, b) => {\n      matches++;\n      return getter(b);\n    });\n    if (!matches) {\n      break;\n    }\n  }\n  return template;\n}\n\n/**\n * Hash function djb2a\n * This is intended to be a simple, fast hashing function using minimal code.\n * It does *not* have good cryptographic properties.\n * @param {string} str\n * @return {string} 32-bit unsigned hash of the string\n */\nexport function stringHash32(str) {\n  const {length} = str;\n  let hash = 5381;\n  for (let i = 0; i < length; i++) {\n    hash = hash * 33 ^ str.charCodeAt(i);\n  }\n  // Convert from 32-bit signed to unsigned.\n  return String(hash >>> 0);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Note: loaded by 3p system. Cannot rely on babel polyfills.\nimport {map} from './utils/object.js';\nimport {startsWith} from './string';\n\n\n/** @type {Object<string, string>} */\nlet propertyNameCache;\n\n/** @const {!Array<string>} */\nconst vendorPrefixes = ['Webkit', 'webkit', 'Moz', 'moz', 'ms', 'O', 'o'];\n\n\n/**\n * @export\n * @param {string} camelCase camel cased string\n * @return {string} title cased string\n */\nexport function camelCaseToTitleCase(camelCase) {\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n}\n\n/**\n * Checks the style if a prefixed version of a property exists and returns\n * it or returns an empty string.\n * @private\n * @param {!Object} style\n * @param {string} titleCase the title case version of a css property name\n * @return {string} the prefixed property name or null.\n */\nfunction getVendorJsPropertyName_(style, titleCase) {\n  for (let i = 0; i < vendorPrefixes.length; i++) {\n    const propertyName = vendorPrefixes[i] + titleCase;\n    if (style[propertyName] !== undefined) {\n      return propertyName;\n    }\n  }\n  return '';\n}\n\n/**\n * Returns the possibly prefixed JavaScript property name of a style property\n * (ex. WebkitTransitionDuration) given a camelCase'd version of the property\n * (ex. transitionDuration).\n * @export\n * @param {!Object} style\n * @param {string} camelCase the camel cased version of a css property name\n * @param {boolean=} opt_bypassCache bypass the memoized cache of property\n *   mapping\n * @return {string}\n */\nexport function getVendorJsPropertyName(style, camelCase, opt_bypassCache) {\n  if (startsWith(camelCase, '--')) {\n    // CSS vars are returned as is.\n    return camelCase;\n  }\n  if (!propertyNameCache) {\n    propertyNameCache = map();\n  }\n  let propertyName = propertyNameCache[camelCase];\n  if (!propertyName || opt_bypassCache) {\n    propertyName = camelCase;\n    if (style[camelCase] === undefined) {\n      const titleCase = camelCaseToTitleCase(camelCase);\n      const prefixedPropertyName = getVendorJsPropertyName_(style, titleCase);\n\n      if (style[prefixedPropertyName] !== undefined) {\n        propertyName = prefixedPropertyName;\n      }\n    }\n    if (!opt_bypassCache) {\n      propertyNameCache[camelCase] = propertyName;\n    }\n  }\n  return propertyName;\n}\n\n\n/**\n * Sets the CSS styles of the specified element with !important. The styles\n * are specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setImportantStyles(element, styles) {\n  for (const k in styles) {\n    element.style.setProperty(\n        getVendorJsPropertyName(styles, k), styles[k].toString(), 'important');\n  }\n}\n\n\n/**\n * Sets the CSS style of the specified element with optional units, e.g. \"px\".\n * @param {?Element} element\n * @param {string} property\n * @param {*} value\n * @param {string=} opt_units\n * @param {boolean=} opt_bypassCache\n */\nexport function setStyle(element, property, value, opt_units, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (propertyName) {\n    element.style[propertyName] =\n      /** @type {string} */ (opt_units ? value + opt_units : value);\n  }\n}\n\n\n/**\n * Returns the value of the CSS style of the specified element.\n * @param {!Element} element\n * @param {string} property\n * @param {boolean=} opt_bypassCache\n * @return {*}\n */\nexport function getStyle(element, property, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (!propertyName) {\n    return undefined;\n  }\n  return element.style[propertyName];\n}\n\n\n/**\n * Sets the CSS styles of the specified element. The styles\n * a specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setStyles(element, styles) {\n  for (const k in styles) {\n    setStyle(element, k, styles[k]);\n  }\n}\n\n\n/**\n * Shows or hides the specified element.\n * @param {!Element} element\n * @param {boolean=} opt_display\n */\nexport function toggle(element, opt_display) {\n  if (opt_display === undefined) {\n    opt_display = getStyle(element, 'display') == 'none';\n  }\n  setStyle(element, 'display', opt_display ? '' : 'none');\n}\n\n\n/**\n * Returns a pixel value.\n * @param {number} value\n * @return {string}\n */\nexport function px(value) {\n  return `${value}px`;\n}\n\n/**\n * Returns a degree value.\n * @param {number} value\n * @return {string}\n */\nexport function deg(value) {\n  return `${value}deg`;\n}\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function translateX(value) {\n  if (typeof value == 'string') {\n    return `translateX(${value})`;\n  }\n  return `translateX(${px(value)})`;\n}\n\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} x\n * @param {(number|string)=} opt_y\n * @return {string}\n */\nexport function translate(x, opt_y) {\n  if (typeof x == 'number') {\n    x = px(x);\n  }\n  if (opt_y === undefined) {\n    return `translate(${x})`;\n  }\n  if (typeof opt_y == 'number') {\n    opt_y = px(opt_y);\n  }\n  return `translate(${x}, ${opt_y})`;\n}\n\n\n/**\n * Returns a \"scale\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function scale(value) {\n  return `scale(${value})`;\n}\n\n/**\n * Returns a \"rotate\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function rotate(value) {\n  if (typeof value == 'number') {\n    value = deg(value);\n  }\n  return `rotate(${value})`;\n}\n\n/**\n * Remove alpha value from a rgba color value.\n * Return the new color property with alpha equals if has the alpha value.\n * Caller needs to make sure the input color value is a valid rgba/rgb value\n * @param {string} rgbaColor\n * @return {string}\n */\nexport function removeAlphaFromColor(rgbaColor) {\n  return rgbaColor.replace(\n      /\\(([^,]+),([^,]+),([^,)]+),[^)]+\\)/g, '($1,$2,$3, 1)');\n}\n\n/**\n * Gets the computed style of the element. The helper is necessary to enforce\n * the possible `null` value returned by a buggy Firefox.\n *\n * @param {!Window} win\n * @param {!Element} el\n * @return {!Object<string, string>}\n */\nexport function computedStyle(win, el) {\n  const style = /** @type {?CSSStyleDeclaration} */(win.getComputedStyle(el));\n  return /** @type {!Object<string, string>} */(style) || map();\n}\n\n\n/**\n * Resets styles that were set dynamically (i.e. inline)\n * @param {!Element} element\n * @param {!Array<string>} properties\n */\nexport function resetStyles(element, properties) {\n  const styleObj = {};\n  properties.forEach(prop => {\n    styleObj[prop] = null;\n  });\n  setStyles(element, styleObj);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* @const */\nconst toString_ = Object.prototype.toString;\n\n/**\n * Returns the ECMA [[Class]] of a value\n * @param {*} value\n * @return {string}\n */\nfunction toString(value) {\n  return toString_.call(value);\n}\n\n/**\n * Determines if value is actually an Array.\n * @param {*} value\n * @return {boolean}\n */\nexport function isArray(value) {\n  return Array.isArray(value);\n}\n\n/**\n * Converts an array-like object to an array.\n * @param {?IArrayLike<T>|string} arrayLike\n * @return {!Array<T>}\n * @template T\n */\nexport function toArray(arrayLike) {\n  if (!arrayLike) {\n    return [];\n  }\n  const array = new Array(arrayLike.length);\n  for (let i = 0; i < arrayLike.length; i++) {\n    array[i] = arrayLike[i];\n  }\n  return array;\n}\n\n/**\n * Determines if value is actually an Object.\n * @param {*} value\n * @return {boolean}\n */\nexport function isObject(value) {\n  return toString(value) === '[object Object]';\n}\n\n/**\n * Determines if value is of number type and finite.\n * NaN and Infinity are not considered a finite number.\n * String numbers are not considered numbers.\n * @param {*} value\n * @return {boolean}\n */\nexport function isFiniteNumber(value) {\n  return (typeof value === 'number' && isFinite(value));\n}\n\n/**\n * Checks whether `s` is a valid value of `enumObj`.\n *\n * @param {!Object<T>} enumObj\n * @param {T} s\n * @return {boolean}\n * @template T\n */\nexport function isEnumValue(enumObj, s) {\n  for (const k in enumObj) {\n    if (enumObj[k] === s) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Externs declare that access `defaultView` from `document` or\n * `ownerDocument` is of type `(Window|null)` but most of our parameter types\n * assume that it is never null. This is OK in practice as we ever only get\n * null on disconnected documents or old IE.\n * This helper function casts it into just a simple Window return type.\n *\n * @param {!Window|null} winOrNull\n * @return {!Window}\n */\nexport function toWin(winOrNull) {\n  return /** @type {!Window} */ (winOrNull);\n}\n\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {tryDecodeUriComponent_} from './url-try-decode-uri-component';\n\nconst regex = /(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * DO NOT import the function from this file. Instead, import parseQueryString\n * from `src/url.js`.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString_(queryString) {\n  const params = /** @type {!JsonObject} */ (Object.create(null));\n  if (!queryString) {\n    return params;\n  }\n\n  let match;\n  while ((match = regex.exec(queryString))) {\n    const name = tryDecodeUriComponent_(match[1], match[1]);\n    const value = match[2] ? tryDecodeUriComponent_(match[2], match[2]) : '';\n    params[name] = value;\n  }\n  return params;\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * DO NOT import the function from this file. Instead, import\n * tryDecodeUriComponent from `src/url.js`.\n *\n * @param {string} component\n * @param {string=} fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent_(component, fallback = '') {\n  try {\n    return decodeURIComponent(component);\n  } catch (e) {\n    return fallback;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {LruCache} from './utils/lru-cache';\nimport {dict} from './utils/object';\nimport {endsWith, startsWith} from './string';\nimport {getMode} from './mode';\nimport {isArray} from './types';\nimport {parseQueryString_} from './url-parse-query-string';\nimport {tryDecodeUriComponent_} from './url-try-decode-uri-component';\nimport {urls} from './config';\nimport {user} from './log';\n\n/**\n * @type {!JsonObject}\n */\nconst SERVING_TYPE_PREFIX = dict({\n  // No viewer\n  'c': true,\n  // In viewer\n  'v': true,\n  // Ad landing page\n  'a': true,\n  // Ad\n  'ad': true,\n});\n\n/**\n * Cached a-tag to avoid memory allocation during URL parsing.\n * @type {HTMLAnchorElement}\n */\nlet a;\n\n/**\n * We cached all parsed URLs. As of now there are no use cases\n * of AMP docs that would ever parse an actual large number of URLs,\n * but we often parse the same one over and over again.\n * @type {LruCache}\n */\nlet cache;\n\n/** @private @const Matches amp_js_* parameters in query string. */\nconst AMP_JS_PARAMS_REGEX = /[?&]amp_js[^&]*/;\n\n/** @private @const Matches amp_gsa parameters in query string. */\nconst AMP_GSA_PARAMS_REGEX = /[?&]amp_gsa[^&]*/;\n\n/** @private @const Matches amp_r parameters in query string. */\nconst AMP_R_PARAMS_REGEX = /[?&]amp_r[^&]*/;\n\n/** @private @const Matches usqp parameters from goog experiment in query string. */\nconst GOOGLE_EXPERIMENT_PARAMS_REGEX = /[?&]usqp[^&]*/;\n\nconst INVALID_PROTOCOLS = [\n  /*eslint no-script-url: 0*/ 'javascript:',\n  /*eslint no-script-url: 0*/ 'data:',\n  /*eslint no-script-url: 0*/ 'vbscript:',\n];\n\n/** @const {string} */\nexport const SOURCE_ORIGIN_PARAM = '__amp_source_origin';\n\n/**\n * Returns the correct origin for a given window.\n * @param {!Window} win\n * @return {string} origin\n */\nexport function getWinOrigin(win) {\n  return win.origin || parseUrlDeprecated(win.location.href).origin;\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {string} url\n * @param {boolean=} opt_nocache\n * @return {!Location}\n */\nexport function parseUrlDeprecated(url, opt_nocache) {\n  if (!a) {\n    a = /** @type {!HTMLAnchorElement} */ (self.document.createElement('a'));\n    cache = self.UrlCache || (self.UrlCache = new LruCache(100));\n  }\n\n  return parseUrlWithA(a, url, opt_nocache ? null : cache);\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {!HTMLAnchorElement} a\n * @param {string} url\n * @param {LruCache=} opt_cache\n * @return {!Location}\n * @restricted\n */\nexport function parseUrlWithA(a, url, opt_cache) {\n  if (opt_cache && opt_cache.has(url)) {\n    return opt_cache.get(url);\n  }\n\n  a.href = url;\n\n  // IE11 doesn't provide full URL components when parsing relative URLs.\n  // Assigning to itself again does the trick #3449.\n  if (!a.protocol) {\n    a.href = a.href;\n  }\n\n  const info = /** @type {!Location} */({\n    href: a.href,\n    protocol: a.protocol,\n    host: a.host,\n    hostname: a.hostname,\n    port: a.port == '0' ? '' : a.port,\n    pathname: a.pathname,\n    search: a.search,\n    hash: a.hash,\n    origin: null, // Set below.\n  });\n\n  // Some IE11 specific polyfills.\n  // 1) IE11 strips out the leading '/' in the pathname.\n  if (info.pathname[0] !== '/') {\n    info.pathname = '/' + info.pathname;\n  }\n\n  // 2) For URLs with implicit ports, IE11 parses to default ports while\n  // other browsers leave the port field empty.\n  if ((info.protocol == 'http:' && info.port == 80)\n      || (info.protocol == 'https:' && info.port == 443)) {\n    info.port = '';\n    info.host = info.hostname;\n  }\n\n  // For data URI a.origin is equal to the string 'null' which is not useful.\n  // We instead return the actual origin which is the full URL.\n  if (a.origin && a.origin != 'null') {\n    info.origin = a.origin;\n  } else if (info.protocol == 'data:' || !info.host) {\n    info.origin = info.href;\n  } else {\n    info.origin = info.protocol + '//' + info.host;\n  }\n\n  // Freeze during testing to avoid accidental mutation.\n  const frozen = (getMode().test && Object.freeze) ? Object.freeze(info) : info;\n\n  if (opt_cache) {\n    opt_cache.put(url, frozen);\n  }\n\n  return frozen;\n}\n\n/**\n * Appends the string just before the fragment part (or optionally\n * to the front of the query string) of the URL.\n * @param {string} url\n * @param {string} paramString\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function appendEncodedParamStringToUrl(url, paramString,\n  opt_addToFront) {\n  if (!paramString) {\n    return url;\n  }\n  const mainAndFragment = url.split('#', 2);\n  const mainAndQuery = mainAndFragment[0].split('?', 2);\n\n  let newUrl = mainAndQuery[0] + (\n    mainAndQuery[1]\n      ? (opt_addToFront\n        ? `?${paramString}&${mainAndQuery[1]}`\n        : `?${mainAndQuery[1]}&${paramString}`)\n      : `?${paramString}`);\n  newUrl += mainAndFragment[1] ? `#${mainAndFragment[1]}` : '';\n  return newUrl;\n}\n/**\n * Appends a query string field and value to a url. `key` and `value`\n * will be ran through `encodeURIComponent` before appending.\n * @param {string} url\n * @param {string} key\n * @param {string} value\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function addParamToUrl(url, key, value, opt_addToFront) {\n  const field = `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\n  return appendEncodedParamStringToUrl(url, field, opt_addToFront);\n}\n\n/**\n * Appends query string fields and values to a url. The `params` objects'\n * `key`s and `value`s will be transformed into query string keys/values.\n * @param {string} url\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function addParamsToUrl(url, params) {\n  return appendEncodedParamStringToUrl(url, serializeQueryString(params));\n}\n\n/**\n * Serializes the passed parameter map into a query string with both keys\n * and values encoded.\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function serializeQueryString(params) {\n  const s = [];\n  for (const k in params) {\n    const v = params[k];\n    if (v == null) {\n      continue;\n    } else if (isArray(v)) {\n      for (let i = 0; i < v.length; i++) {\n        const sv = /** @type {string} */ (v[i]);\n        s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n      }\n    } else {\n      const sv = /** @type {string} */ (v);\n      s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n    }\n  }\n  return s.join('&');\n}\n\n/**\n * Returns `true` if the URL is secure: either HTTPS or localhost (for testing).\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isSecureUrlDeprecated(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return (url.protocol == 'https:' ||\n      url.hostname == 'localhost' ||\n      endsWith(url.hostname, '.localhost'));\n}\n\n/**\n * Asserts that a given url is HTTPS or protocol relative. It's a user-level\n * assert.\n *\n * Provides an exception for localhost.\n *\n * @param {?string|undefined} urlString\n * @param {!Element|string} elementContext Element where the url was found.\n * @param {string=} sourceName Used for error messages.\n * @return {string}\n */\nexport function assertHttpsUrl(\n  urlString, elementContext, sourceName = 'source') {\n  user().assert(urlString != null, '%s %s must be available',\n      elementContext, sourceName);\n  // (erwinm, #4560): type cast necessary until #4560 is fixed.\n  const theUrlString = /** @type {string} */ (urlString);\n  user().assert(isSecureUrlDeprecated(theUrlString) || /^(\\/\\/)/.test(theUrlString),\n      '%s %s must start with ' +\n      '\"https://\" or \"//\" or be relative and served from ' +\n      'either https or from localhost. Invalid value: %s',\n      elementContext, sourceName, theUrlString);\n  return theUrlString;\n}\n\n/**\n * Asserts that a given url is an absolute HTTP or HTTPS URL.\n * @param {string} urlString\n * @return {string}\n */\nexport function assertAbsoluteHttpOrHttpsUrl(urlString) {\n  user().assert(/^https?\\:/i.test(urlString),\n      'URL must start with \"http://\" or \"https://\". Invalid value: %s',\n      urlString);\n  return parseUrlDeprecated(urlString).href;\n}\n\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * This function is implemented in a separate file to avoid a circular\n * dependency.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString(queryString) {\n  return parseQueryString_(queryString);\n}\n\n/**\n * Returns the URL without fragment. If URL doesn't contain fragment, the same\n * string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function removeFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return url;\n  }\n  return url.substring(0, index);\n}\n\n/**\n * Returns the fragment from the URL. If the URL doesn't contain fragment,\n * the empty string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function getFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return '';\n  }\n  return url.substring(index);\n}\n\n/**\n * Returns whether the URL has the origin of a proxy.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isProxyOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.cdnProxyRegex.test(url.origin);\n}\n\n/**\n * For proxy-origin URLs, returns the serving type. Otherwise, returns null.\n * E.g., 'https://amp-com.cdn.ampproject.org/a/s/amp.com/amp_document.html'\n * returns 'a'.\n * @param {string|!Location} url URL of an AMP document.\n * @return {?string}\n */\nexport function getProxyServingType(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  if (!isProxyOrigin(url)) {\n    return null;\n  }\n  const path = url.pathname.split('/', 2);\n  return path[1];\n}\n\n/**\n * Returns whether the URL origin is localhost.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isLocalhostOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.localhostRegex.test(url.origin);\n}\n\n/**\n * Returns whether the URL has valid protocol.\n * Deep link protocol is valid, but not javascript etc.\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isProtocolValid(url) {\n  if (!url) {\n    return true;\n  }\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return !INVALID_PROTOCOLS.includes(url.protocol);\n}\n\n/**\n * Returns a URL without AMP JS parameters.\n * @param {string} url\n * @return {string}\n */\nexport function removeAmpJsParamsFromUrl(url) {\n  const parsed = parseUrlDeprecated(url);\n  const search = removeAmpJsParamsFromSearch(parsed.search);\n  return parsed.origin + parsed.pathname + search + parsed.hash;\n\n}\n\n/**\n * Returns a URL without a query string.\n * @param {string} url\n * @return {string}\n */\nexport function removeSearch(url) {\n  const index = url.indexOf('?');\n  if (index == -1) {\n    return url;\n  }\n  const fragment = getFragment(url);\n  return url.substring(0, index) + fragment;\n}\n\n/**\n * Removes parameters that start with amp js parameter pattern and returns the\n * new search string.\n * @param {string} urlSearch\n * @return {string}\n */\nfunction removeAmpJsParamsFromSearch(urlSearch) {\n  if (!urlSearch || urlSearch == '?') {\n    return '';\n  }\n  const search = urlSearch\n      .replace(AMP_JS_PARAMS_REGEX, '')\n      .replace(AMP_GSA_PARAMS_REGEX, '')\n      .replace(AMP_R_PARAMS_REGEX, '')\n      .replace(GOOGLE_EXPERIMENT_PARAMS_REGEX, '')\n      .replace(/^[?&]/, ''); // Removes first ? or &.\n  return search ? '?' + search : '';\n}\n\n/**\n * Returns the source URL of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string}\n */\nexport function getSourceUrl(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n\n  // Not a proxy URL - return the URL itself.\n  if (!isProxyOrigin(url)) {\n    return url.href;\n  }\n\n  // A proxy URL.\n  // Example path that is being matched here.\n  // https://cdn.ampproject.org/c/s/www.origin.com/foo/\n  // The /s/ is optional and signals a secure origin.\n  const path = url.pathname.split('/');\n  const prefix = path[1];\n  user().assert(SERVING_TYPE_PREFIX[prefix],\n      'Unknown path prefix in url %s', url.href);\n  const domainOrHttpsSignal = path[2];\n  const origin = domainOrHttpsSignal == 's'\n    ? 'https://' + decodeURIComponent(path[3])\n    : 'http://' + decodeURIComponent(domainOrHttpsSignal);\n  // Sanity test that what we found looks like a domain.\n  user().assert(origin.indexOf('.') > 0, 'Expected a . in origin %s', origin);\n  path.splice(1, domainOrHttpsSignal == 's' ? 3 : 2);\n  return origin + path.join('/') +\n      removeAmpJsParamsFromSearch(url.search) + (url.hash || '');\n}\n\n/**\n * Returns the source origin of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string} The source origin of the URL.\n */\nexport function getSourceOrigin(url) {\n  return parseUrlDeprecated(getSourceUrl(url)).origin;\n}\n\n/**\n * Returns absolute URL resolved based on the relative URL and the base.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n */\nexport function resolveRelativeUrl(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  if (typeof URL == 'function') {\n    return new URL(relativeUrlString, baseUrl.href).toString();\n  }\n  return resolveRelativeUrlFallback_(relativeUrlString, baseUrl);\n}\n\n/**\n * Fallback for URL resolver when URL class is not available.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n * @private Visible for testing.\n */\nexport function resolveRelativeUrlFallback_(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  relativeUrlString = relativeUrlString.replace(/\\\\/g, '/');\n  const relativeUrl = parseUrlDeprecated(relativeUrlString);\n\n  // Absolute URL.\n  if (startsWith(relativeUrlString.toLowerCase(), relativeUrl.protocol)) {\n    return relativeUrl.href;\n  }\n\n  // Protocol-relative URL.\n  if (startsWith(relativeUrlString, '//')) {\n    return baseUrl.protocol + relativeUrlString;\n  }\n\n  // Absolute path.\n  if (startsWith(relativeUrlString, '/')) {\n    return baseUrl.origin + relativeUrlString;\n  }\n\n  // Relative path.\n  return baseUrl.origin + baseUrl.pathname.replace(/\\/[^/]*$/, '/')\n      + relativeUrlString;\n}\n\n\n/**\n * Add \"__amp_source_origin\" query parameter to the URL.\n * @param {!Window} win\n * @param {string} url\n * @return {string}\n */\nexport function getCorsUrl(win, url) {\n  checkCorsUrl(url);\n  const sourceOrigin = getSourceOrigin(win.location.href);\n  return addParamToUrl(url, SOURCE_ORIGIN_PARAM, sourceOrigin);\n}\n\n\n/**\n * Checks if the url has __amp_source_origin and throws if it does.\n * @param {string} url\n */\nexport function checkCorsUrl(url) {\n  const parsedUrl = parseUrlDeprecated(url);\n  const query = parseQueryString(parsedUrl.search);\n  user().assert(!(SOURCE_ORIGIN_PARAM in query),\n      'Source origin is not allowed in %s', url);\n}\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * @param {string} component\n * @param {string=} opt_fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent(component, opt_fallback) {\n  return tryDecodeUriComponent_(component, opt_fallback);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from '../log';\n\n/**\n * Interpret a byte array as a UTF-8 string.\n * @param {!BufferSource} bytes\n * @return {string}\n */\nexport function utf8Decode(bytes) {\n  if (typeof TextDecoder !== 'undefined') {\n    return new TextDecoder('utf-8').decode(bytes);\n  }\n  const asciiString = bytesToString(new Uint8Array(bytes.buffer || bytes));\n  return decodeURIComponent(escape(asciiString));\n}\n\n/**\n * Turn a string into UTF-8 bytes.\n * @param {string} string\n * @return {!Uint8Array}\n */\nexport function utf8Encode(string) {\n  if (typeof TextEncoder !== 'undefined') {\n    return new TextEncoder('utf-8').encode(string);\n  }\n  return stringToBytes(unescape(encodeURIComponent(string)));\n}\n\n/**\n * Converts a string which holds 8-bit code points, such as the result of atob,\n * into a Uint8Array with the corresponding bytes.\n * If you have a string of characters, you probably want to be using utf8Encode.\n * @param {string} str\n * @return {!Uint8Array}\n */\nexport function stringToBytes(str) {\n  const bytes = new Uint8Array(str.length);\n  for (let i = 0; i < str.length; i++) {\n    const charCode = str.charCodeAt(i);\n    dev().assert(charCode <= 255, 'Characters must be in range [0,255]');\n    bytes[i] = charCode;\n  }\n  return bytes;\n}\n\n/**\n * Converts a 8-bit bytes array into a string\n * @param {!Uint8Array} bytes\n * @return {string}\n */\nexport function bytesToString(bytes) {\n  // Intentionally avoids String.fromCharCode.apply so we don't suffer a\n  // stack overflow. #10495, https://jsperf.com/bytesToString-2\n  const array = new Array(bytes.length);\n  for (let i = 0; i < bytes.length; i++) {\n    array[i] = String.fromCharCode(bytes[i]);\n  }\n  return array.join('');\n}\n\n/**\n * Converts a 4-item byte array to an unsigned integer.\n * Assumes bytes are big endian.\n * @param {!Uint8Array} bytes\n * @return {number}\n */\nexport function bytesToUInt32(bytes) {\n  if (bytes.length != 4) {\n    throw new Error('Received byte array with length != 4');\n  }\n  const val = (bytes[0] & 0xFF) << 24 |\n     (bytes[1] & 0xFF) << 16 |\n     (bytes[2] & 0xFF) << 8 |\n     (bytes[3] & 0xFF);\n  // Convert to unsigned.\n  return val >>> 0;\n}\n\n/**\n * Generate a random bytes array with specific length using\n * win.crypto.getRandomValues. Return null if it is not available.\n * @param {!Window} win\n * @param {number} length\n * @return {?Uint8Array}\n */\nexport function getCryptoRandomBytesArray(win, length) {\n  if (!win.crypto || !win.crypto.getRandomValues) {\n    return null;\n  }\n\n  // Widely available in browsers we support:\n  // http://caniuse.com/#search=getRandomValues\n  const uint8array = new Uint8Array(length);\n  win.crypto.getRandomValues(uint8array);\n  return uint8array;\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from '../log';\n\n/** @const {string} */\nconst TAG = 'lru-cache';\n\n/**\n * @template T\n */\nexport class LruCache {\n  /**\n   * @param {number} capacity\n   */\n  constructor(capacity) {\n    /** @private @const {number} */\n    this.capacity_ = capacity;\n\n    /** @private {number} */\n    this.size_ = 0;\n\n    /**\n     * An incrementing counter to define the last access.\n     * @private {number}\n     */\n    this.access_ = 0;\n\n    /** @private {!Object<(number|string), {payload: T, access: number}>} */\n    this.cache_ = Object.create(null);\n  }\n\n  /**\n   * Returns whether key is cached.\n   *\n   * @param {number|string} key\n   * @return {boolean}\n   */\n  has(key) {\n    return !!this.cache_[key];\n  }\n\n  /**\n   * @param {number|string} key\n   * @return {T} The cached payload.\n   */\n  get(key) {\n    const cacheable = this.cache_[key];\n    if (cacheable) {\n      cacheable.access = ++this.access_;\n      return cacheable.payload;\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {number|string} key\n   * @param {T} payload The payload to cache.\n   */\n  put(key, payload) {\n    if (!this.has(key)) {\n      this.size_++;\n    }\n    this.cache_[key] = {payload, access: this.access_};\n    this.evict_();\n  }\n\n  /**\n   * Evicts the oldest cache entry, if we've exceeded capacity.\n   */\n  evict_() {\n    if (this.size_ <= this.capacity_) {\n      return;\n    }\n\n    dev().warn(TAG, 'Trimming LRU cache');\n    const cache = this.cache_;\n    let oldest = this.access_ + 1;\n    let oldestKey;\n    for (const key in cache) {\n      const {access} = cache[key];\n      if (access < oldest) {\n        oldest = access;\n        oldestKey = key;\n      }\n    }\n\n    if (oldestKey !== undefined) {\n      delete cache[oldestKey];\n      this.size_--;\n    }\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {isObject} from '../types';\n\n/* @const */\nconst hasOwn_ = Object.prototype.hasOwnProperty;\n\n/**\n * Returns a map-like object.\n * If opt_initial is provided, copies its own properties into the\n * newly created object.\n * @param {T=} opt_initial This should typically be an object literal.\n * @return {T}\n * @template T\n */\nexport function map(opt_initial) {\n  const obj = Object.create(null);\n  if (opt_initial) {\n    Object.assign(obj, opt_initial);\n  }\n  return obj;\n}\n\n/**\n * Return an empty JsonObject or makes the passed in object literal\n * an JsonObject.\n * The JsonObject type is just a simple object that is at-dict.\n * See\n * https://github.com/google/closure-compiler/wiki/@struct-and-@dict-Annotations\n * for what a dict is type-wise.\n * The linter enforces that the argument is, in fact, at-dict like.\n * @param {!Object=} opt_initial\n * @return {!JsonObject}\n */\nexport function dict(opt_initial) {\n  // We do not copy. The linter enforces that the passed in object is a literal\n  // and thus the caller cannot have a reference to it.\n  return /** @type {!JsonObject} */ (opt_initial || {});\n}\n\n/**\n * Checks if the given key is a property in the map.\n *\n * @param {T}  obj a map like property.\n * @param {string}  key\n * @return {boolean}\n * @template T\n */\nexport function hasOwn(obj, key) {\n  return hasOwn_.call(obj, key);\n}\n\n/**\n * Returns obj[key] iff key is obj's own property (is not inherited).\n * Otherwise, returns undefined.\n *\n * @param {Object} obj\n * @param {string} key\n * @return {*}\n */\nexport function ownProperty(obj, key) {\n  if (hasOwn(obj, key)) {\n    return obj[key];\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Deep merges source into target.\n *\n * @param {!Object} target\n * @param {!Object} source\n * @param {number} depth The maximum merge depth. If exceeded, Object.assign\n *                       will be used instead.\n * @return {!Object}\n * @throws {Error} If source contains a circular reference.\n * Note: Only nested objects are deep-merged, primitives and arrays are not.\n */\nexport function deepMerge(target, source, depth = 10) {\n  // Keep track of seen objects to detect recursive references.\n  const seen = [];\n\n  /** @type {!Array<{t: !Object, s: !Object, d: number}>} */\n  const queue = [];\n  queue.push({t: target, s: source, d: 0});\n\n  // BFS to ensure objects don't have recursive references at shallower depths.\n  while (queue.length > 0) {\n    const {t, s, d} = queue.shift();\n    if (seen.includes(s)) {\n      throw new Error('Source object has a circular reference.');\n    }\n    seen.push(s);\n    if (t === s) {\n      continue;\n    }\n    if (d > depth) {\n      Object.assign(t, s);\n      continue;\n    }\n    Object.keys(s).forEach(key => {\n      const newValue = s[key];\n      // Perform a deep merge IFF both target and source have the same key\n      // whose corresponding values are objects.\n      if (hasOwn(t, key)) {\n        const oldValue = t[key];\n        if (isObject(newValue) && isObject(oldValue)) {\n          queue.push({t: oldValue, s: newValue, d: d + 1});\n          return;\n        }\n      }\n      t[key] = newValue;\n    });\n  }\n  return target;\n}\n\n/**\n * @param {!Object} o An object to remove properties from\n * @param {!Array<string>} props A list of properties to remove from the Object\n * @return {!Object} An object with the given properties removed\n */\nexport function omit(o, props) {\n  return Object.keys(o).reduce((acc, key) => {\n    if (!props.includes(key)) {\n      acc[key] = o[key];\n    }\n    return acc;\n  }, {});\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns a Deferred struct, which holds a pending promise and its associated\n * resolve and reject functions.\n *\n * This is preferred instead of creating a Promise instance to extract the\n * resolve/reject functions yourself:\n *\n * ```\n * // Avoid doing\n * let resolve;\n * const promise = new Promise(res => {\n *   resolve = res;\n * });\n *\n * // Good\n * const deferred = new Deferred();\n * const { promise, resolve } = deferred;\n * ```\n *\n * @template T\n */\nexport class Deferred {\n  /**\n   * Creates an instance of Deferred.\n   */\n  constructor() {\n    let resolve, reject;\n\n    /**\n     * @const {!Promise<T>}\n     */\n    this.promise = new /*OK*/Promise((res, rej) => {\n      resolve = res;\n      reject = rej;\n    });\n\n    /**\n     * @const {function(T=)}\n     */\n    this.resolve = resolve;\n\n    /**\n     * @const {function(*=)}\n     */\n    this.reject = reject;\n  }\n}\n\n/**\n * Creates a promise resolved to the return value of fn.\n * If fn sync throws, it will cause the promise to reject.\n *\n * @param {function():T} fn\n * @return {!Promise<T>}\n * @template T\n */\nexport function tryResolve(fn) {\n  return new Promise(resolve => {\n    resolve(fn());\n  });\n}\n\n/**\n * Returns a promise which resolves if a threshold amount of the given promises\n * resolve, and rejects otherwise.\n * @param {!Array<!Promise>} promises The array of promises to test.\n * @param {number} count The number of promises that must resolve for the\n *     returned promise to resolve.\n * @return {!Promise} A promise that resolves if any of the given promises\n *     resolve, and which rejects otherwise.\n */\nexport function some(promises, count = 1) {\n  return new Promise((resolve, reject) => {\n    count = Math.max(count, 0);\n    const extra = promises.length - count;\n    if (extra < 0) {\n      reject(new Error('not enough promises to resolve'));\n    }\n    if (promises.length == 0) {\n      resolve([]);\n    }\n    const values = [];\n    const reasons = [];\n\n    const onFulfilled = value => {\n      if (values.length < count) {\n        values.push(value);\n      }\n      if (values.length == count) {\n        resolve(values);\n      }\n    };\n    const onRejected = reason => {\n      if (reasons.length <= extra) {\n        reasons.push(reason);\n      }\n      if (reasons.length > extra) {\n        reject(reasons);\n      }\n    };\n    for (let i = 0; i < promises.length; i++) {\n      Promise.resolve(promises[i]).then(onFulfilled, onRejected);\n    }\n  });\n}\n\n/**\n * Resolves with the result of the last promise added.\n * @implements {IThenable}\n */\nexport class LastAddedResolver {\n  /**\n   * @param {!Array<!Promise>=} opt_promises\n   */\n  constructor(opt_promises) {\n    let resolve_, reject_;\n    /** @private @const {!Promise} */\n    this.promise_ = new Promise((resolve, reject) => {\n      resolve_ = resolve;\n      reject_ = reject;\n    });\n\n    /** @private */\n    this.resolve_ = resolve_;\n\n    /** @private */\n    this.reject_ = reject_;\n\n    /** @private */\n    this.count_ = 0;\n\n    if (opt_promises) {\n      for (let i = 0; i < opt_promises.length; i++) {\n        this.add(opt_promises[i]);\n      }\n    }\n  }\n\n  /**\n   * Add a promise to possibly be resolved.\n   * @param {!Promise} promise\n   * @return {!Promise}\n   */\n  add(promise) {\n    const countAtAdd = ++this.count_;\n    Promise.resolve(promise).then(result => {\n      if (this.count_ === countAtAdd) {\n        this.resolve_(result);\n      }\n    }, error => {\n      // Don't follow behavior of Promise.all and Promise.race error so that\n      // this will only reject when most recently added promise fails.\n      if (this.count_ === countAtAdd) {\n        this.reject_(error);\n      }\n    });\n    return this.promise_;\n  }\n\n  /** @override */\n  then(opt_resolve, opt_reject) {\n    return this.promise_.then(opt_resolve, opt_reject);\n  }\n}\n","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n\n\n/**\n * This regex consists of 4 matching capture groups and one (non-matching) fallback:\n *\n * - (\\0), catch the null terminator character so it may be replaced by UTF\n *   Replacement Char\n * - ^(-)$, catch a solitary dash char, so that it may be backslash escaped.\n *   This is a separate capture group so that the legal-chars (group 4) doesn't\n *   capture it first, since that group doesn't need to escape its dash.\n * - ([\\x01-\\x1f\\x7f]|^-?[0-9]), catch a UTF control char, or any leading\n *   number (with an optional leading dash). The control or the number (but not\n *   the leading dash) must be hex-escaped,.\n * - ([\\x80-\\uffff0-9a-zA-Z_-]+), catch legal-chars, with the exception of a\n *   solitary dash, which will already have matched in group 1.\n * - [^], finally, a catch-all that allows us to backslash escape the char.\n *\n * Together, this matches everything necessary for CSS.escape.\n */\nvar regex = /(\\0)|^(-)$|([\\x01-\\x1f\\x7f]|^-?[0-9])|([\\x80-\\uffff0-9a-zA-Z_-]+)|[^]/g;\n\nfunction escaper(match, nil, dash, hexEscape, chars) {\n  // Chars is the legal-chars (group 4) capture\n  if (chars) {\n    return chars;\n  }\n  // Nil is the null terminator (group 1) capture\n  if (nil) {\n    return '\\uFFFD';\n  }\n  // Both UTF control chars, and leading numbers (with optional leading dash)\n  // (group 3) must be backslash escaped with a trailing space.  Funnily, the\n  // leading dash must not be escaped, but the number. :shrug:\n  if (hexEscape) {\n    return match.slice(0, -1) + '\\\\' + match.slice(-1).charCodeAt(0).toString(16) + ' '\n  }\n  // Finally, the solitary dash and the catch-all chars require backslash\n  // escaping.\n  return '\\\\' + match;\n}\n\n/**\n * https://drafts.csswg.org/cssom/#serialize-an-identifier\n * @param {string} value\n * @return {string}\n */\nexport function cssEscape(value) {\n  return String(value).replace(regex, escaper);\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJidWlsZC9hbXAtc3RvcnktYXV0by1hZHMtMC4xLmNzcy5qcyIsImV4dGVuc2lvbnMvYW1wLXN0b3J5LWF1dG8tYWRzLzAuMS9hbXAtc3RvcnktYXV0by1hZHMuanMiLCJleHRlbnNpb25zL2FtcC1zdG9yeS1hdXRvLWFkcy8wLjEvdXRpbHMuanMiLCJleHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvYW1wLXN0b3J5LXN0b3JlLXNlcnZpY2UuanMiLCJleHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvZW1iZWQtbW9kZS5qcyIsImV4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9uYXZpZ2F0aW9uLXN0YXRlLmpzIiwibm9kZV9tb2R1bGVzL2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQvYnVpbGQvZG9jdW1lbnQtcmVnaXN0ZXItZWxlbWVudC5wYXRjaGVkLmpzIiwibm9kZV9tb2R1bGVzL3Byb21pc2UtcGpzL3Byb21pc2UuanMiLCJzcmMvYW5hbHl0aWNzLmpzIiwic3JjL2NvbW1vbi1zaWduYWxzLmpzIiwic3JjL2NvbmZpZy5qcyIsInNyYy9jb29raWVzLmpzIiwic3JjL2RvbS5qcyIsInNyYy9lbGVtZW50LXNlcnZpY2UuanMiLCJzcmMvZXhwZXJpbWVudHMuanMiLCJzcmMvanNvbi5qcyIsInNyYy9sb2cuanMiLCJzcmMvbW9kZS1vYmplY3QuanMiLCJzcmMvbW9kZS5qcyIsInNyYy9vYnNlcnZhYmxlLmpzIiwic3JjL3BvbHlmaWxscy5qcyIsInNyYy9wb2x5ZmlsbHMvYXJyYXktaW5jbHVkZXMuanMiLCJzcmMvcG9seWZpbGxzL2N1c3RvbS1lbGVtZW50cy5qcyIsInNyYy9wb2x5ZmlsbHMvZG9jdW1lbnQtY29udGFpbnMuanMiLCJzcmMvcG9seWZpbGxzL2RvbXRva2VubGlzdC10b2dnbGUuanMiLCJzcmMvcG9seWZpbGxzL21hdGgtc2lnbi5qcyIsInNyYy9wb2x5ZmlsbHMvb2JqZWN0LWFzc2lnbi5qcyIsInNyYy9wb2x5ZmlsbHMvcHJvbWlzZS5qcyIsInNyYy9zZXJ2aWNlLmpzIiwic3JjL3NlcnZpY2VzLmpzIiwic3JjL3N0cmluZy5qcyIsInNyYy9zdHlsZS5qcyIsInNyYy90eXBlcy5qcyIsInNyYy91cmwtcGFyc2UtcXVlcnktc3RyaW5nLmpzIiwic3JjL3VybC10cnktZGVjb2RlLXVyaS1jb21wb25lbnQuanMiLCJzcmMvdXJsLmpzIiwic3JjL3V0aWxzL2J5dGVzLmpzIiwic3JjL3V0aWxzL2xydS1jYWNoZS5qcyIsInNyYy91dGlscy9vYmplY3QuanMiLCJzcmMvdXRpbHMvcHJvbWlzZS5qcyIsInRoaXJkX3BhcnR5L2Nzcy1lc2NhcGUvY3NzLWVzY2FwZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7OztBQ0FPLElBQU0sb0JBQU0scXBGQUFaOzs7Ozs7Ozs7O0FDZ0JQOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOzs7Ozs7OzsrZUE1QkE7Ozs7Ozs7Ozs7Ozs7Ozs7QUE4QkE7QUFDQSxJQUFNLGVBQWUsQ0FBckI7O0FBRUE7QUFDQSxJQUFNLE1BQU0sb0JBQVo7O0FBRUE7QUFDQSxJQUFNLFNBQVMsUUFBZjs7QUFFQTtBQUNBLElBQU0sZUFBZSxjQUFyQjs7QUFFQTtBQUNBLElBQU0sZ0JBQWdCLEtBQXRCLEMsQ0FBNkI7O0FBRTdCO0FBQ0EsSUFBTSxtQkFBbUIsc0JBQXpCOztBQUVBO0FBQ0EsSUFBTSxlQUFlLG1CQUFyQjs7QUFFQTtBQUNBLElBQU0sWUFBWTtBQUNoQixZQUFVLG1CQURNO0FBRWhCLFdBQVM7QUFGTyxDQUFsQjs7QUFLQTtBQUNBLElBQU0sWUFBWTtBQUNoQixXQUFTLGFBRE87QUFFaEIsUUFBTSxVQUZVO0FBR2hCLFFBQU0sVUFIVTtBQUloQixXQUFTLGFBSk87QUFLaEIsVUFBUSxZQUxRO0FBTWhCLGFBQVc7QUFOSyxDQUFsQjs7QUFTQTtBQUNBLElBQU0s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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ242Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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OiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJleHBvcnQgY29uc3QgQ1NTID0gXCJbZGVza3RvcF0gYW1wLXN0b3J5LXBhZ2VbaS1hbXBodG1sLWxvYWRpbmddey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEuMCkgdHJhbnNsYXRlWCgtMTAwJSkgdHJhbnNsYXRlWSgyMDAlKSFpbXBvcnRhbnQ7dHJhbnNmb3JtOnNjYWxlKDEuMCkgdHJhbnNsYXRlWCgtMTAwJSkgdHJhbnNsYXRlWSgyMDAlKSFpbXBvcnRhbnR9LmktYW1waHRtbC1zdG9yeS1hZC1saW5re2JhY2tncm91bmQtY29sb3I6I2ZmZiFpbXBvcnRhbnQ7Ym9yZGVyLXJhZGl1czoyMHB4IWltcG9ydGFudDtib3R0b206MzJweCFpbXBvcnRhbnQ7Ym94LXNoYWRvdzowcHggMnB4IDEycHggcmdiYSgwLDAsMCwwLjE2KSFpbXBvcnRhbnQ7Y29sb3I6IzQyODVmNCFpbXBvcnRhbnQ7Zm9udC1mYW1pbHk6Um9ib3RvLHNhbnMtc2VyaWYhaW1wb3J0YW50O2ZvbnQtd2VpZ2h0OjcwMCFpbXBvcnRhbnQ7aGVpZ2h0OjM2cHghaW1wb3J0YW50O2xlZnQ6NTAlIWltcG9ydGFudDtsZXR0ZXItc3BhY2luZzowLjJweCFpbXBvcnRhbnQ7bGluZS1oZWlnaHQ6MzZweDttYXJnaW4tbGVmdDotNjBweCFpbXBvcnRhbnQ7cG9zaXRpb246YWJzb2x1dGUhaW1wb3J0YW50O3RleHQtYWxpZ246Y2VudGVyO3RleHQtZGVjb3JhdGlvbjpub25lIWltcG9ydGFudDt3aWR0aDoxMjBweCFpbXBvcnRhbnR9YW1wLXN0b3J5LXBhZ2VbYWN0aXZlXSAuaS1hbXBodG1sLXN0b3J5LWFkLWxpbmt7LXdlYmtpdC1hbmltYXRpb24tZGVsYXk6MTAwbXMhaW1wb3J0YW50O2FuaW1hdGlvbi1kZWxheToxMDBtcyFpbXBvcnRhbnQ7LXdlYmtpdC1hbmltYXRpb24tZHVyYXRpb246MzAwbXMhaW1wb3J0YW50O2FuaW1hdGlvbi1kdXJhdGlvbjozMDBtcyFpbXBvcnRhbnQ7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllcigwLjQsMC4wLDAuMiwxKSFpbXBvcnRhbnQ7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoMC40LDAuMCwwLjIsMSkhaW1wb3J0YW50Oy13ZWJraXQtYW5pbWF0aW9uLWZpbGwtbW9kZTpmb3J3YXJkcyFpbXBvcnRhbnQ7YW5pbWF0aW9uLWZpbGwtbW9kZTpmb3J3YXJkcyFpbXBvcnRhbnQ7LXdlYmtpdC1hbmltYXRpb24tbmFtZTphZC1jdGEhaW1wb3J0YW50O2FuaW1hdGlvbi1uYW1lOmFkLWN0YSFpbXBvcnRhbnR9QC13ZWJraXQta2V5ZnJhbWVzIGFkLWN0YXswJXtvcGFjaXR5OjA7Zm9udC1zaXplOjBweDstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSgwKTt0cmFuc2Zvcm06c2NhbGUoMCl9dG97b3BhY2l0eToxO2ZvbnQtc2l6ZToxM3B4Oy13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEpO3RyYW5zZm9ybTpzY2FsZSgxKX19QGtleWZyYW1lcyBhZC1jdGF7MCV7b3BhY2l0eTowO2ZvbnQtc2l6ZTowcHg7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMCk7dHJhbnNmb3JtOnNjYWxlKDApfXRve29wYWNpdHk6MTtmb250LXNpemU6MTNweDstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSgxKTt0cmFuc2Zvcm06c2NhbGUoMSl9fS5pLWFtcGh0bWwtYWQtb3ZlcmxheS1jb250YWluZXJ7aGVpZ2h0OjI0cHghaW1wb3J0YW50O2xlZnQ6MCFpbXBvcnRhbnQ7cGFkZGluZzoxNHB4IDAgMCFpbXBvcnRhbnQ7cG9zaXRpb246YWJzb2x1dGUhaW1wb3J0YW50O3RvcDowIWltcG9ydGFudDt6LWluZGV4OjEwMDAwMSFpbXBvcnRhbnR9W2Rpcj1ydGxdIC5pLWFtcGh0bWwtYWQtb3ZlcmxheS1jb250YWluZXJ7bGVmdDphdXRvIWltcG9ydGFudDtyaWdodDowIWltcG9ydGFudH1bZGVza3RvcF0gLmktYW1waHRtbC1hZC1vdmVybGF5LWNvbnRhaW5lcntsZWZ0OmNhbGMoNTB2dyAtIDIyLjV2aCkhaW1wb3J0YW50O3RvcDoxMi41dmghaW1wb3J0YW50fVtkaXI9cnRsXSBbZGVza3RvcF0gLmktYW1waHRtbC1hZC1vdmVybGF5LWNvbnRhaW5lcntsZWZ0OmF1dG8haW1wb3J0YW50O3JpZ2h0OmNhbGMoNTB2dyAtIDIyLjV2aCkhaW1wb3J0YW50fS5pLWFtcGh0bWwtc3RvcnktYWQtYXR0cmlidXRpb257Y29sb3I6I2ZmZiFpbXBvcnRhbnQ7Zm9udC1zaXplOjE4cHghaW1wb3J0YW50O2ZvbnQtZmFtaWx5OlJvYm90byxzYW5zLXNlcmlmIWltcG9ydGFudDtmb250LXdlaWdodDo3MDAhaW1wb3J0YW50O2xldHRlci1zcGFjaW5nOjAuNXB4IWltcG9ydGFudDttYXJnaW46MCAwIDAgMTZweCFpbXBvcnRhbnQ7b3BhY2l0eTowIWltcG9ydGFudDtwYWRkaW5nOjAhaW1wb3J0YW50O3Zpc2liaWxpdHk6aGlkZGVuIWltcG9ydGFudH1bZGlyPXJ0bF0gLmktYW1waHRtbC1zdG9yeS1hZC1hdHRyaWJ1dGlvbnttYXJnaW4tbGVmdDowcHghaW1wb3J0YW50O21hcmdpbi1yaWdodDoxNnB4IWltcG9ydGFudH1hbXAtc3RvcnlbYWQtc2hvd2luZ11bZGVza3RvcF0gLmktYW1waHRtbC1zdG9yeS1hZC1hdHRyaWJ1dGlvbnstd2Via2l0LXRyYW5zaXRpb246b3BhY2l0eSAwLjFzIGxpbmVhciAwLjNzO3RyYW5zaXRpb246b3BhY2l0eSAwLjFzIGxpbmVhciAwLjNzfWFtcC1zdG9yeVthZC1zaG93aW5nXSAuaS1hbXBodG1sLXN0b3J5LWFkLWF0dHJpYnV0aW9ue3Zpc2liaWxpdHk6dmlzaWJsZSFpbXBvcnRhbnQ7b3BhY2l0eToxIWltcG9ydGFudH0uaS1hbXBodG1sLWdsYXNzLXBhbmV7aGVpZ2h0OjEwMCUhaW1wb3J0YW50O3dpZHRoOjEwMCUhaW1wb3J0YW50O3otaW5kZXg6MSFpbXBvcnRhbnR9XFxuLyojIHNvdXJjZVVSTD0vZXh0ZW5zaW9ucy9hbXAtc3RvcnktYXV0by1hZHMvMC4xL2FtcC1zdG9yeS1hdXRvLWFkcy5jc3MqL1wiO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7Q1NTfSBmcm9tICcuLi8uLi8uLi9idWlsZC9hbXAtc3RvcnktYXV0by1hZHMtMC4xLmNzcyc7XG5pbXBvcnQge0NvbW1vblNpZ25hbHN9IGZyb20gJy4uLy4uLy4uL3NyYy9jb21tb24tc2lnbmFscyc7XG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZXMnO1xuaW1wb3J0IHtTdGF0ZUNoYW5nZUV2ZW50RGVmLCBTdGF0ZUNoYW5nZVR5cGV9IGZyb20gJy4uLy4uL2FtcC1zdG9yeS8xLjAvbmF2aWdhdGlvbi1zdGF0ZSc7XG5pbXBvcnQge1N0YXRlUHJvcGVydHl9IGZyb20gJy4uLy4uL2FtcC1zdG9yeS8xLjAvYW1wLXN0b3J5LXN0b3JlLXNlcnZpY2UnO1xuaW1wb3J0IHtjcmVhdGVFbGVtZW50V2l0aEF0dHJpYnV0ZXN9IGZyb20gJy4uLy4uLy4uL3NyYy9kb20nO1xuaW1wb3J0IHtkZXYsIHVzZXJ9IGZyb20gJy4uLy4uLy4uL3NyYy9sb2cnO1xuaW1wb3J0IHtkaWN0LCBoYXNPd24sIG1hcH0gZnJvbSAnLi4vLi4vLi4vc3JjL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge2dldFVuaXF1ZUlkfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7aXNKc29uU2NyaXB0VGFnfSBmcm9tICcuLi8uLi8uLi9zcmMvZG9tJztcbmltcG9ydCB7cGFyc2VKc29ufSBmcm9tICcuLi8uLi8uLi9zcmMvanNvbic7XG5pbXBvcnQge3NldFN0eWxlc30gZnJvbSAnLi4vLi4vLi4vc3JjL3N0eWxlJztcbmltcG9ydCB7dHJpZ2dlckFuYWx5dGljc0V2ZW50fSBmcm9tICcuLi8uLi8uLi9zcmMvYW5hbHl0aWNzJztcblxuLyoqIEBjb25zdCAqL1xuY29uc3QgTUlOX0lOVEVSVkFMID0gMztcblxuLyoqIEBjb25zdCAqL1xuY29uc3QgVEFHID0gJ2FtcC1zdG9yeS1hdXRvLWFkcyc7XG5cbi8qKiBAY29uc3QgKi9cbmNvbnN0IEFEX1RBRyA9ICdhbXAtYWQnO1xuXG4vKiogQGNvbnN0ICovXG5jb25zdCBNVVNUQUNIRV9UQUcgPSAnYW1wLW11c3RhY2hlJztcblxuLyoqIEBjb25zdCAqL1xuY29uc3QgVElNRU9VVF9MSU1JVCA9IDEwMDAwOyAvLyAxMCBzZWNvbmRzXG5cbi8qKiBAY29uc3QgKi9cbmNvbnN0IEdMQVNTX1BBTkVfQ0xBU1MgPSAnaS1hbXBodG1sLWdsYXNzLXBhbmUnO1xuXG4vKiogQGNvbnN0ICovXG5jb25zdCBMT0FESU5HX0FUVFIgPSAnaS1hbXBodG1sLWxvYWRpbmcnO1xuXG4vKiogQGNvbnN0ICovXG5jb25zdCBEQVRBX0FUVFIgPSB7XG4gIENUQV9UWVBFOiAnZGF0YS12YXJzLWN0YXR5cGUnLFxuICBDVEFfVVJMOiAnZGF0YS12YXJzLWN0YXVybCcsXG59O1xuXG4vKiogQGNvbnN0ICovXG5jb25zdCBDVEFfVFlQRVMgPSB7XG4gIEVYUExPUkU6ICdFeHBsb3JlIE5vdycsXG4gIFNIT1A6ICdTaG9wIE5vdycsXG4gIFJFQUQ6ICdSZWFkIE5vdycsXG4gIElOU1RBTEw6ICdJbnN0YWxsIE5vdycsXG4gIExJU1RFTjogJ0xpc3RlbiBOb3cnLFxuICBTVUJTQ1JJQkU6ICdTdWJzY3JpYmUgTm93Jyxcbn07XG5cbi8qKiBAY29uc3QgKi9cbmNvbnN0IEFEX1NUQVRFID0ge1xuICBQRU5ESU5HOiAwLFxuICBJTlNFUlRFRDogMSxcbiAgRkFJTEVEOiAyLFxufTtcblxuLyoqIEBjb25zdCAqL1xuY29uc3QgQUxMT1dFRF9BRF9UWVBFUyA9IG1hcCh7XG4gICdjdXN0b20nOiB0cnVlLFxuICAnZG91YmxlY2xpY2snOiB0cnVlLFxufSk7XG5cbi8qKiBAZW51bSB7c3RyaW5nfSAqL1xuY29uc3QgRXZlbnRzID0ge1xuICBBRF9SRVFVRVNURUQ6ICdzdG9yeS1hZC1yZXF1ZXN0JyxcbiAgQURfTE9BREVEOiAnc3RvcnktYWQtbG9hZCcsXG4gIEFEX0lOU0VSVEVEOiAnc3RvcnktYWQtaW5zZXJ0JyxcbiAgQURfVklFV0VEOiAnc3RvcnktYWQtdmlldycsXG4gIEFEX0NMSUNLRUQ6ICdzdG9yeS1hZC1jbGljaycsXG4gIEFEX0VYSVRFRDogJ3N0b3J5LWFkLWV4aXQnLFxuICBBRF9ESVNDQVJERUQ6ICdzdG9yeS1hZC1kaXNjYXJkJyxcbn07XG5cbi8qKiBAZW51bSB7c3RyaW5nfSAqL1xuY29uc3QgVmFycyA9IHtcbiAgLy8gVGltZXN0YW1wIHdoZW4gYWQgaXMgcmVxdWVzdGVkLlxuICBBRF9SRVFVRVNURUQ6ICdyZXF1ZXN0VGltZScsXG4gIC8vIFRpbWVzdGFtcCB3aGVuIGFkIGVtaXRzIGBJTklfTE9BRGAgc2lnbmFsLlxuICBBRF9MT0FERUQ6ICdsb2FkVGltZScsXG4gIC8vIFRpbWVzdGFtcCB3aGVuIGFkIGlzIGluc2VydGVkIGludG8gc3RvcnkgYXMgcGFnZSBhZnRlciBuZXh0LlxuICBBRF9JTlNFUlRFRDogJ2luc2VydFRpbWUnLFxuICAvLyBUaW1lc3RhbXAgd2hlbiBwYWdlIGJlY29tZXMgYWN0aXZlIHBhZ2UuXG4gIEFEX1ZJRVdFRDogJ3ZpZXdUaW1lJyxcbiAgLy8gVGltZXN0YW1wIHdoZW4gYWQgaXMgY2xpY2tlZC5cbiAgQURfQ0xJQ0tFRDogJ2NsaWNrVGltZScsXG4gIC8vIFRpbWVzdGFtcCB3aGVuIGFkIHBhZ2UgbW92ZXMgZnJvbSBhY3RpdmUgPT4gaW5hY3RpdmUuXG4gIEFEX0VYSVRFRDogJ2V4aXRUaW1lJyxcbiAgLy8gVGltZXN0YW1wIHdoZW4gYWQgaXMgZGlzY2FyZWQgZHVlIHRvIGJhZCBtZXRhZGF0YSBldGMuXG4gIEFEX0RJU0NBUkRFRDogJ2Rpc2NhcmRUaW1lJyxcbiAgLy8gSW5kZXggb2YgdGhlIGFkIGdlbmVyYXRpbmcgdGhlIHRyaWdnZXIuXG4gIEFEX0lOREVYOiAnYWRJbmRleCcsXG4gIC8vIElkIHRoYXQgc2hvdWxkIGJlIHVuaXF1ZSBmb3IgZXZlcnkgYWQuXG4gIEFEX1VOSVFVRV9JRDogJ2FkVW5pcXVlSWQnLFxuICAvLyBQb3NpdGlvbiBpbiB0aGUgcGFyZW50IHN0b3J5LiBOdW1iZXIgb2YgcGFnZSBiZWZvcmUgYWQgKyAxLiBEb2VzIG5vdCBjb3VudFxuICAvLyBwcmV2aW91c2x5IGluc2VydGVkIGFkIHBhZ2VzLlxuICBQT1NJVElPTjogJ3Bvc2l0aW9uJyxcbiAgLy8gR2l2ZW4gY3RhLXR5cGUgb2YgaW5zZXJ0ZWQgYWQuXG4gIENUQV9UWVBFOiAnY3RhVHlwZScsXG59O1xuXG5leHBvcnQgY2xhc3MgQW1wU3RvcnlBdXRvQWRzIGV4dGVuZHMgQU1QLkJhc2VFbGVtZW50IHtcblxuICAvKiogQHBhcmFtIHshQW1wRWxlbWVudH0gZWxlbWVudCAqL1xuICBjb25zdHJ1Y3RvcihlbGVtZW50KSB7XG4gICAgc3VwZXIoZWxlbWVudCk7XG5cbiAgICAvKiogQHByaXZhdGUgez8uLi8uLi9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS5BbXBTdG9yeX0gKi9cbiAgICB0aGlzLmFtcFN0b3J5XyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUgez8uLi8uLi9hbXAtc3RvcnkvMC4xL25hdmlnYXRpb24tc3RhdGUuTmF2aWdhdGlvblN0YXRlfSAqL1xuICAgIHRoaXMubmF2aWdhdGlvblN0YXRlXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnVuaXF1ZVBhZ2VzQ291bnRfID0gMDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IU9iamVjdDxzdHJpbmcsIGJvb2xlYW4+fSAqL1xuICAgIHRoaXMudW5pcXVlUGFnZUlkc18gPSBkaWN0KHt9KTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IUFycmF5PEVsZW1lbnQ+fSAqL1xuICAgIHRoaXMuYWRQYWdlRWxzXyA9IFtdO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy50aW1lQ3VycmVudFBhZ2VDcmVhdGVkXyA9IC1JbmZpbml0eTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMuYWRzUGxhY2VkXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLmFkUGFnZXNDcmVhdGVkXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUgez9FbGVtZW50fSAqL1xuICAgIHRoaXMuY3VycmVudEFkRWxlbWVudF8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuaXNDdXJyZW50QWRMb2FkZWRfID0gZmFsc2U7XG5cbiAgICAvKiogQHByaXZhdGUge09iamVjdDxzdHJpbmcsIHN0cmluZz59ICovXG4gICAgdGhpcy5jb25maWdfID0ge307XG5cbiAgICAvKiogQHByaXZhdGUge09iamVjdDxzdHJpbmcsICo+fSAqL1xuICAgIHRoaXMuYW5hbHl0aWNzRGF0YV8gPSB7fTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7T2JqZWN0PHN0cmluZywgbnVtYmVyPn0gKi9cbiAgICB0aGlzLmFkUGFnZUlkc18gPSB7fTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfG51bGx9ICovXG4gICAgdGhpcy5pZE9mQWRTaG93aW5nXyA9IG51bGw7XG5cbiAgICAvKipcbiAgICAgKiBWZXJzaW9uIG9mIHRoZSBzdG9yeSBzdG9yZSBzZXJ2aWNlIGRlcGVuZHMgb24gd2hpY2ggdmVyc2lvbiBvZiBhbXAtc3RvcnlcbiAgICAgKiB0aGUgcHVibGlzaGVyIGlzIGxvYWRpbmcuIFRoZXkgYWxsIGhhdmUgdGhlIHNhbWUgaW1wbGVtZW50YXRpb24uXG4gICAgICogQHByaXZhdGUgez8uLi8uLi9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfD8uLi8uLi9hbXAtc3RvcnkvMS4wL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfVxuICAgICAqL1xuICAgIHRoaXMuc3RvcmVTZXJ2aWNlXyA9IG51bGw7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGJ1aWxkQ2FsbGJhY2soKSB7XG4gICAgcmV0dXJuIFNlcnZpY2VzLnN0b3J5U3RvcmVTZXJ2aWNlRm9yT3JOdWxsKHRoaXMud2luKS50aGVuKHN0b3JlU2VydmljZSA9PiB7XG4gICAgICBkZXYoKS5hc3NlcnQoc3RvcmVTZXJ2aWNlLCAnQ291bGQgbm90IHJldHJpZXZlIEFtcFN0b3J5U3RvcmVTZXJ2aWNlJyk7XG4gICAgICB0aGlzLnN0b3JlU2VydmljZV8gPSBzdG9yZVNlcnZpY2U7XG5cbiAgICAgIGlmICghdGhpcy5pc0F1dG9tYXRpY0FkSW5zZXJ0aW9uQWxsb3dlZF8oKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGFtcFN0b3J5RWxlbWVudCA9IHRoaXMuZWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICAgICAgdXNlcigpLmFzc2VydChhbXBTdG9yeUVsZW1lbnQudGFnTmFtZSA9PT0gJ0FNUC1TVE9SWScsXG4gICAgICAgICAgYDwke1RBR30+IHNob3VsZCBiZSBjaGlsZCBvZiA8YW1wLXN0b3J5PmApO1xuXG4gICAgICBjb25zdCBhbXBkb2MgPSB0aGlzLmdldEFtcERvYygpO1xuICAgICAgY29uc3QgZXh0ZW5zaW9uU2VydmljZSA9IFNlcnZpY2VzLmV4dGVuc2lvbnNGb3IodGhpcy53aW4pO1xuICAgICAgZXh0ZW5zaW9uU2VydmljZS4vKk9LKi9pbnN0YWxsRXh0ZW5zaW9uRm9yRG9jKFxuICAgICAgICAgIGFtcGRvYywgQURfVEFHKTtcbiAgICAgIGV4dGVuc2lvblNlcnZpY2UuLypPSyovaW5zdGFsbEV4dGVuc2lvbkZvckRvYyhcbiAgICAgICAgICBhbXBkb2MsIE1VU1RBQ0hFX1RBRyk7XG5cbiAgICAgIHJldHVybiBhbXBTdG9yeUVsZW1lbnQuZ2V0SW1wbCgpLnRoZW4oaW1wbCA9PiB7XG4gICAgICAgIHRoaXMuYW1wU3RvcnlfID0gaW1wbDtcbiAgICAgICAgdGhpcy5uYXZpZ2F0aW9uU3RhdGVfID0gdGhpcy5hbXBTdG9yeV8uZ2V0TmF2aWdhdGlvblN0YXRlKCk7XG4gICAgICAgIHRoaXMubmF2aWdhdGlvblN0YXRlXy5vYnNlcnZlKHRoaXMuaGFuZGxlU3RhdGVDaGFuZ2VfLmJpbmQodGhpcykpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgaXNMYXlvdXRTdXBwb3J0ZWQoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgbGF5b3V0Q2FsbGJhY2soKSB7XG4gICAgaWYgKCF0aGlzLmlzQXV0b21hdGljQWRJbnNlcnRpb25BbGxvd2VkXygpKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuYW1wU3RvcnlfLnNpZ25hbHMoKS53aGVuU2lnbmFsKENvbW1vblNpZ25hbHMuSU5JX0xPQUQpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmNyZWF0ZUFkT3ZlcmxheV8oKTtcbiAgICAgICAgICB0aGlzLnJlYWRDb25maWdfKCk7XG4gICAgICAgICAgdGhpcy5zY2hlZHVsZVBhZ2VfKCk7XG4gICAgICAgIH0pO1xuICB9XG5cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyB3aGV0aGVyIG9yIG5vdCBhZCBpbnNlcnRpb24gaXMgYWxsb3dlZCBiYXNlZCBvbiBob3cgdGhlIHN0b3J5XG4gICAqIGlzIHNlcnZlZC5cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGlzQXV0b21hdGljQWRJbnNlcnRpb25BbGxvd2VkXygpIHtcbiAgICByZXR1cm4gISF0aGlzLnN0b3JlU2VydmljZV8uZ2V0KFN0YXRlUHJvcGVydHkuQ0FOX0lOU0VSVF9BVVRPTUFUSUNfQUQpO1xuICB9XG5cblxuICAvKipcbiAgICogbG9hZCBpbiBjb25maWcgZnJvbSBjaGlsZCA8c2NyaXB0PiBlbGVtZW50XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICByZWFkQ29uZmlnXygpIHtcbiAgICBjb25zdCBjaGlsZCA9IHRoaXMuZWxlbWVudC5jaGlsZHJlblswXTtcbiAgICB1c2VyKCkuYXNzZXJ0KFxuICAgICAgICBpc0pzb25TY3JpcHRUYWcoY2hpbGQpLFxuICAgICAgICBgVGhlIDwke1RBR30+IGNvbmZpZyBzaG91bGQgYCArXG4gICAgICAgICdiZSBpbnNpZGUgYSA8c2NyaXB0PiB0YWcgd2l0aCB0eXBlPVwiYXBwbGljYXRpb24vanNvblwiJyk7XG5cbiAgICB0aGlzLmNvbmZpZ18gPSBwYXJzZUpzb24oY2hpbGQudGV4dENvbnRlbnQpO1xuICAgIHRoaXMudmFsaWRhdGVDb25maWdfKCk7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBoaWRkZW4gVUkgdGhhdCB3aWxsIGJlIHNob3duIHdoZW4gYWQgaXMgZGlzcGxheWVkXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBjcmVhdGVBZE92ZXJsYXlfKCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMud2luLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FzaWRlJyk7XG4gICAgY29udGFpbmVyLmNsYXNzTmFtZSA9ICdpLWFtcGh0bWwtYWQtb3ZlcmxheS1jb250YWluZXInO1xuXG4gICAgY29uc3Qgc3BhbiA9IHRoaXMud2luLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBzcGFuLmNsYXNzTmFtZSA9ICdpLWFtcGh0bWwtc3RvcnktYWQtYXR0cmlidXRpb24nO1xuICAgIHNwYW4udGV4dENvbnRlbnQgPSAnQWQnO1xuXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHNwYW4pO1xuICAgIHRoaXMuYW1wU3RvcnlfLmVsZW1lbnQuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgfVxuXG5cbiAgLyoqXG4gICAqIG1ha2Ugc3VyZSBnaXZlbiBKU09OIGNvbmZpZyBpcyBzaGFwZWQgY29ycmVjdGx5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB2YWxpZGF0ZUNvbmZpZ18oKSB7XG4gICAgY29uc3QgYWRBdHRyaWJ1dGVzID0gdGhpcy5jb25maWdfWydhZC1hdHRyaWJ1dGVzJ107XG4gICAgdXNlcigpLmFzc2VydChhZEF0dHJpYnV0ZXMsIGA8JHtUQUd9PjogRXJyb3IgcmVhZGluZyBjb25maWcuYCArXG4gICAgICAnVG9wIGxldmVsIEpTT04gc2hvdWxkIGhhdmUgYW4gXCJhZC1hdHRyaWJ1dGVzXCIga2V5Jyk7XG5cbiAgICBjb25zdCB7dHlwZX0gPSBhZEF0dHJpYnV0ZXM7XG4gICAgdXNlcigpLmFzc2VydCh0eXBlLCBgPCR7VEFHfT46IEVycm9yIHJlYWRpbmcgY29uZmlnLmAgK1xuICAgICAgJ01pc3NpbmcgW1wiYWQtYXR0cmlidWVzXCJdW1widHlwZVwiXSBrZXknKTtcbiAgfVxuXG5cbiAgLyoqXG4gICAqIGJ1aWxkIHBhZ2UgYW5kIHN0YXJ0IHByZWxvYWRpbmdcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHNjaGVkdWxlUGFnZV8oKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMuY3JlYXRlQWRQYWdlXygpO1xuICAgIHRoaXMuYWRQYWdlRWxzXy5wdXNoKHBhZ2UpO1xuXG4gICAgdGhpcy5hbXBTdG9yeV8uZWxlbWVudC5hcHBlbmRDaGlsZChwYWdlKTtcbiAgICB0aGlzLmFuYWx5dGljc0V2ZW50V2l0aEN1cnJlbnRBZF8oRXZlbnRzLkFEX1JFUVVFU1RFRCxcbiAgICAgICAge1tWYXJzLkFEX1JFUVVFU1RFRF06IERhdGUubm93KCl9KTtcblxuICAgIHBhZ2UuZ2V0SW1wbCgpLnRoZW4oaW1wbCA9PiB7XG4gICAgICB0aGlzLmFtcFN0b3J5Xy5hZGRQYWdlKGltcGwpO1xuICAgICAgdGhpcy50aW1lQ3VycmVudFBhZ2VDcmVhdGVkXyA9IERhdGUubm93KCk7XG4gICAgfSk7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBjcmVhdGUgYW4gYGFtcC1zdG9yeS1wYWdlYCBjb250YWluaW5nIGFuIGBhbXAtYWRgXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBjcmVhdGVBZFBhZ2VfKCkge1xuICAgIGNvbnN0IGFtcFN0b3J5QWRQYWdlID0gdGhpcy5jcmVhdGVQYWdlRWxlbWVudF8oKTtcbiAgICBjb25zdCBhbXBBZCA9IHRoaXMuY3JlYXRlQWRFbGVtZW50XygpO1xuXG4gICAgY29uc3QgZ2xhc3NQYW5lID0gdGhpcy53aW4uZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZ2xhc3NQYW5lLmNsYXNzTGlzdC5hZGQoR0xBU1NfUEFORV9DTEFTUyk7XG5cbiAgICBjb25zdCBncmlkTGF5ZXIgPSB0aGlzLndpbi5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhbXAtc3RvcnktZ3JpZC1sYXllcicpO1xuICAgIGdyaWRMYXllci5zZXRBdHRyaWJ1dGUoJ3RlbXBsYXRlJywgJ2ZpbGwnKTtcblxuICAgIGNvbnN0IHBhbmVHcmlkTGF5ZXIgPSBncmlkTGF5ZXIuY2xvbmVOb2RlKGZhbHNlKTtcblxuICAgIGdyaWRMYXllci5hcHBlbmRDaGlsZChhbXBBZCk7XG4gICAgcGFuZUdyaWRMYXllci5hcHBlbmRDaGlsZChnbGFzc1BhbmUpO1xuICAgIGFtcFN0b3J5QWRQYWdlLmFwcGVuZENoaWxkKGdyaWRMYXllcik7XG4gICAgYW1wU3RvcnlBZFBhZ2UuYXBwZW5kQ2hpbGQocGFuZUdyaWRMYXllcik7XG5cbiAgICB0aGlzLmN1cnJlbnRBZEVsZW1lbnRfID0gYW1wQWQ7XG4gICAgdGhpcy5pc0N1cnJlbnRBZExvYWRlZF8gPSBmYWxzZTtcblxuICAgIC8vIHNldCB1cCBsaXN0ZW5lciBmb3IgYWQtbG9hZGVkIGV2ZW50XG4gICAgYW1wQWQuZ2V0SW1wbCgpLnRoZW4oaW1wbCA9PiB7XG4gICAgICBjb25zdCBzaWduYWxzID0gaW1wbC5zaWduYWxzKCk7XG4gICAgICByZXR1cm4gc2lnbmFscy53aGVuU2lnbmFsKENvbW1vblNpZ25hbHMuSU5JX0xPQUQpO1xuICAgIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgLy8gRW5zdXJlcyB0aGUgdmlkZW8tbWFuYWdlciBkb2VzIG5vdCBmb2xsb3cgdGhlIGF1dG9wbGF5IGF0dHJpYnV0ZSBvblxuICAgICAgLy8gYW1wLXZpZGVvIHRhZ3MsIHdoaWNoIHdvdWxkIHBsYXkgdGhlIGFkIGluIHRoZSBiYWNrZ3JvdW5kIGJlZm9yZSBpdCBpc1xuICAgICAgLy8gZGlzcGxheWVkLlxuICAgICAgYW1wU3RvcnlBZFBhZ2UuZ2V0SW1wbCgpLnRoZW4oaW1wbCA9PiBpbXBsLmRlbGVnYXRlVmlkZW9BdXRvcGxheSgpKTtcblxuICAgICAgLy8gcmVtb3ZlIGxvYWRpbmcgYXR0cmlidXRlIG9uY2UgbG9hZGVkIHNvIHRoYXQgZGVza3RvcCBDU1Mgd2lsbCBwb3NpdGlvblxuICAgICAgLy8gb2Zmc2NyZW4gd2l0aCBhbGwgb3RoZXIgcGFnZXNcbiAgICAgIGNvbnN0IGN1cnJlbnRQYWdlRWwgPSB0aGlzLmFkUGFnZUVsc19bdGhpcy5hZFBhZ2VFbHNfLmxlbmd0aCAtIDFdO1xuICAgICAgY3VycmVudFBhZ2VFbC5yZW1vdmVBdHRyaWJ1dGUoTE9BRElOR19BVFRSKTtcblxuICAgICAgdGhpcy5hbmFseXRpY3NFdmVudFdpdGhDdXJyZW50QWRfKEV2ZW50cy5BRF9MT0FERUQsXG4gICAgICAgICAge1tWYXJzLkFEX0xPQURFRF06IERhdGUubm93KCl9KTtcbiAgICAgIHRoaXMuaXNDdXJyZW50QWRMb2FkZWRfID0gdHJ1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiBhbXBTdG9yeUFkUGFnZTtcbiAgfVxuXG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFFbGVtZW50fVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgY3JlYXRlUGFnZUVsZW1lbnRfKCkge1xuICAgIGNvbnN0IGlkID0gKyt0aGlzLmFkUGFnZXNDcmVhdGVkXztcbiAgICBjb25zdCBwYWdlSWQgPSBgaS1hbXBodG1sLWFkLXBhZ2UtJHtpZH1gO1xuXG4gICAgLy8gS2VlcCB0cmFjayBvZiBpZHMgY3JlYXRlZCBzbyBmYXIgYW5kIGEgbWFwcGluZyB0byB0aGVpciBpbmRleC4gVGhpc1xuICAgIC8vIGlzIHVzZWQgdG8gY2hlY2sgaWYgYSBwYWdlIGlkIGlzIGFuIGFkIGxhdGVyLlxuICAgIHRoaXMuYWRQYWdlSWRzX1twYWdlSWRdID0gaWQ7XG5cbiAgICAvLyBBbHNvIGNyZWF0ZSBhIG5ldyBvYmplY3QgdG8ga2VlcCB0cmFjayBvZiBhbnkgZnV0dXJlIGFuYWx5dGljcyBkYXRhLlxuICAgIHRoaXMuYW5hbHl0aWNzRGF0YV9baWRdID0ge1xuICAgICAgW1ZhcnMuQURfSU5ERVhdOiBpZCxcbiAgICAgIFtWYXJzLkFEX1VOSVFVRV9JRF06IGdldFVuaXF1ZUlkKHRoaXMud2luKSxcbiAgICB9O1xuXG4gICAgY29uc3QgYXR0cmlidXRlcyA9IGRpY3Qoe1xuICAgICAgJ2lkJzogcGFnZUlkLFxuICAgICAgJ2FkJzogJycsXG4gICAgICAnZGlzdGFuY2UnOiAnMicsXG4gICAgICAnaS1hbXBodG1sLWxvYWRpbmcnOiAnJyxcbiAgICB9KTtcblxuICAgIHJldHVybiBjcmVhdGVFbGVtZW50V2l0aEF0dHJpYnV0ZXMoXG4gICAgICAgIHRoaXMud2luLmRvY3VtZW50LCAnYW1wLXN0b3J5LXBhZ2UnLCBhdHRyaWJ1dGVzKTtcbiAgfVxuXG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFFbGVtZW50fVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgY3JlYXRlQWRFbGVtZW50XygpIHtcbiAgICBjb25zdCByZXF1aXJlZEF0dHJzID0ge1xuICAgICAgJ2NsYXNzJzogJ2ktYW1waHRtbC1zdG9yeS1hZCcsXG4gICAgICAnbGF5b3V0JzogJ2ZpbGwnLFxuICAgICAgJ2FtcC1zdG9yeSc6ICcnLFxuICAgIH07XG5cbiAgICBjb25zdCBjb25maWdBdHRycyA9IHRoaXMuY29uZmlnX1snYWQtYXR0cmlidXRlcyddO1xuXG4gICAgWydoZWlnaHQnLCAnd2lkdGgnLCAnbGF5b3V0J10uZm9yRWFjaChhdHRyID0+IHtcbiAgICAgIGlmIChjb25maWdBdHRyc1thdHRyXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHVzZXIoKS53YXJuKFRBRywgYGFkLWF0dHJpYnV0ZSBcIiR7YXR0cn1cIiBpcyBub3QgYWxsb3dlZGApO1xuICAgICAgICBkZWxldGUgY29uZmlnQXR0cnNbYXR0cl07XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB1c2VyKCkuYXNzZXJ0KCEhQUxMT1dFRF9BRF9UWVBFU1tjb25maWdBdHRycy50eXBlXSwgYCR7VEFHfTogYCArXG4gICAgICBgXCIke2NvbmZpZ0F0dHJzLnR5cGV9XCIgYWQgdHlwZSBpcyBub3Qgc3VwcG9ydGVkYCk7XG5cbiAgICBjb25zdCBhdHRyaWJ1dGVzID0gLyoqIEB0eXBlIHshSnNvbk9iamVjdH0gKi8gKE9iamVjdC5hc3NpZ24oe30sXG4gICAgICAgIGNvbmZpZ0F0dHJzLCByZXF1aXJlZEF0dHJzKSk7XG5cbiAgICByZXR1cm4gY3JlYXRlRWxlbWVudFdpdGhBdHRyaWJ1dGVzKFxuICAgICAgICB0aGlzLndpbi5kb2N1bWVudCwgJ2FtcC1hZCcsIGF0dHJpYnV0ZXMpO1xuICB9XG5cblxuICAvKipcbiAgICogVmFsaWRhdGUgYWQtc2VydmVyIHJlc3BvbnNlIGhhcyByZXF1aXJlbWVudHMgdG8gYnVpbGQgb3V0bGlua1xuICAgKiBAcGFyYW0geyFFbGVtZW50fSBhZFBhZ2VFbGVtZW50XG4gICAqL1xuICBtYXliZUNyZWF0ZUN0YUxheWVyXyhhZFBhZ2VFbGVtZW50KSB7XG4gICAgLy8gaWYgbWFraW5nIGEgQ1RBIGxheWVyIHdlIG5lZWQgYSBidXR0b24gbmFtZSAmIG91dGxpbmsgdXJsXG4gICAgY29uc3QgY3RhVXJsID0gdGhpcy5jdXJyZW50QWRFbGVtZW50Xy5nZXRBdHRyaWJ1dGUoREFUQV9BVFRSLkNUQV9VUkwpO1xuICAgIGNvbnN0IGN0YVR5cGUgPSB0aGlzLmN1cnJlbnRBZEVsZW1lbnRfLmdldEF0dHJpYnV0ZShEQVRBX0FUVFIuQ1RBX1RZUEUpO1xuXG4gICAgaWYgKCFjdGFVcmwgfHwgIWN0YVR5cGUpIHtcbiAgICAgIHVzZXIoKS5lcnJvcihUQUcsICdCb3RoIENUQSBUeXBlICYgQ1RBIFVybCAnICtcbiAgICAgICAgICAnYXJlIHJlcXVpcmVkIGluIGFkLXNlcnZlciByZXNwb25zZS5cIicpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFN0b3JlIHRoZSBjdGEtdHlwZSBhcyBhbiBhY2Nlc2libGUgdmFyIGZvciBhbnkgZnVydGhlciBwaW5ncy5cbiAgICB0aGlzLmFuYWx5dGljc0RhdGFfW3RoaXMuYWRQYWdlc0NyZWF0ZWRfXVtWYXJzLkNUQV9UWVBFXSA9IGN0YVR5cGU7XG5cbiAgICBjb25zdCBjdGFUZXh0ID0gQ1RBX1RZUEVTW2N0YVR5cGVdO1xuICAgIGlmICghY3RhVHlwZSkge1xuICAgICAgdXNlcigpLmVycm9yKFRBRywgJ2ludmFsaWQgXCJDVEEgVHlwZVwiIGluIGFkIHJlc3BvbnNlJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlQ3RhTGF5ZXJfKGFkUGFnZUVsZW1lbnQsIGN0YVRleHQsIGN0YVVybCk7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBDcmVhdGUgbGF5ZXIgdG8gY29udGFpbiBvdXRsaW5rIGJ1dHRvblxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBhZFBhZ2VFbGVtZW50XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBjdGFUZXh0XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBjdGFVcmxcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGNyZWF0ZUN0YUxheWVyXyhhZFBhZ2VFbGVtZW50LCBjdGFUZXh0LCBjdGFVcmwpIHtcbiAgICBjb25zdCBhID0gdGhpcy53aW4uZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgIGEuY2xhc3NOYW1lID0gJ2ktYW1waHRtbC1zdG9yeS1hZC1saW5rJztcbiAgICBhLnNldEF0dHJpYnV0ZSgndGFyZ2V0JywgJ19ibGFuaycpO1xuICAgIHNldFN0eWxlcyhhLCB7XG4gICAgICAnZm9udC1zaXplJzogJzAnLFxuICAgICAgb3BhY3RpeTogJzAnLFxuICAgICAgdHJhbnNmb3JtOiAnc2NhbGUoMCknLFxuICAgIH0pO1xuICAgIGEuaHJlZiA9IGN0YVVybDtcbiAgICBhLnRleHRDb250ZW50ID0gY3RhVGV4dDtcblxuICAgIGlmIChhLnByb3RvY29sICE9PSAnaHR0cHM6JyAmJiBhLnByb3RvY29sICE9PSAnaHR0cDonKSB7XG4gICAgICB1c2VyKCkud2FybihUQUcsICdDVEEgdXJsIGlzIG5vdCB2YWxpZC4gQWQgd2FzIGRpc2NhcmRlZCcpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIENsaWNrIGxpc3RlbmVyIHNvIHRoYXQgd2UgY2FuIGZpcmUgYHN0b3J5LWFkLWNsaWNrYCBhbmFseXRpY3MgdHJpZ2dlciBhdFxuICAgIC8vIHRoZSBhcHByb3ByaWF0ZSB0aW1lLlxuICAgIGNvbnN0IGFkSW5kZXggPSB0aGlzLmFkUGFnZXNDcmVhdGVkXztcbiAgICBhLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFycyA9IHtcbiAgICAgICAgW1ZhcnMuQURfSU5ERVhdOiBhZEluZGV4LFxuICAgICAgICBbVmFycy5BRF9DTElDS0VEXTogRGF0ZS5ub3coKSxcbiAgICAgIH07XG4gICAgICB0aGlzLmFuYWx5dGljc0V2ZW50XyhFdmVudHMuQURfQ0xJQ0tFRCwgdmFycyk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBjdGFMYXllciA9IHRoaXMud2luLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FtcC1zdG9yeS1jdGEtbGF5ZXInKTtcbiAgICBjdGFMYXllci5hcHBlbmRDaGlsZChhKTtcbiAgICBhZFBhZ2VFbGVtZW50LmFwcGVuZENoaWxkKGN0YUxheWVyKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVN0YXRlQ2hhbmdlRXZlbnREZWZ9IHN0YXRlQ2hhbmdlRXZlbnRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGhhbmRsZVN0YXRlQ2hhbmdlXyhzdGF0ZUNoYW5nZUV2ZW50KSB7XG4gICAgc3dpdGNoIChzdGF0ZUNoYW5nZUV2ZW50LnR5cGUpIHtcbiAgICAgIGNhc2UgU3RhdGVDaGFuZ2VUeXBlLkFDVElWRV9QQUdFOlxuICAgICAgICBjb25zdCB7cGFnZUluZGV4LCBwYWdlSWR9ID0gc3RhdGVDaGFuZ2VFdmVudC52YWx1ZTtcbiAgICAgICAgdGhpcy5oYW5kbGVBY3RpdmVQYWdlQ2hhbmdlXyhcbiAgICAgICAgICAgIGRldigpLmFzc2VydE51bWJlcihwYWdlSW5kZXgpLFxuICAgICAgICAgICAgZGV2KCkuYXNzZXJ0U3RyaW5nKHBhZ2VJZCkpO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gcGFnZUluZGV4XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwYWdlSWRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGhhbmRsZUFjdGl2ZVBhZ2VDaGFuZ2VfKHBhZ2VJbmRleCwgcGFnZUlkKSB7XG4gICAgaWYgKHRoaXMuaWRPZkFkU2hvd2luZ18pIHtcbiAgICAgIC8vIFdlIGFyZSB0cmFuc2l0aW9uaW5nIGF3YXkgZnJvbSBhbiBhZCwgc28gZmlyZSB0aGUgZXhpdCBldmVudC5cbiAgICAgIHRoaXMuYW5hbHl0aWNzRXZlbnRfKEV2ZW50cy5BRF9FWElURUQsIHtcbiAgICAgICAgW1ZhcnMuQURfRVhJVEVEXTogRGF0ZS5ub3coKSxcbiAgICAgICAgW1ZhcnMuQURfSU5ERVhdOiB0aGlzLmlkT2ZBZFNob3dpbmdfLFxuICAgICAgfSk7XG4gICAgICB0aGlzLmlkT2ZBZFNob3dpbmdfID0gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5hZFBhZ2VJZHNfW3BhZ2VJZF0pIHtcbiAgICAgIC8vIFdlIGFyZSBzd2l0Y2hpbmcgdG8gYW4gYWQsIHNvIGZpcmUgdGhlIHZpZXcgZXZlbnQgb24gdGhlXG4gICAgICAvLyBjb3JyZXNwb25kaW5nIEFkLlxuICAgICAgY29uc3QgYWRJbmRleCA9IHRoaXMuYWRQYWdlSWRzX1twYWdlSWRdO1xuICAgICAgdGhpcy5hbmFseXRpY3NFdmVudF8oRXZlbnRzLkFEX1ZJRVdFRCwge1xuICAgICAgICBbVmFycy5BRF9WSUVXRURdOiBEYXRlLm5vdygpLFxuICAgICAgICBbVmFycy5BRF9JTkRFWF06IGFkSW5kZXgsXG4gICAgICB9KTtcblxuICAgICAgLy8gS2VlcGluZyB0cmFjayBvZiB0aGlzIGhlcmUgc28gdGhhdCB3ZSBjYW4gY29udGFpbiB0aGUgbG9naWMgZm9yIHdoZW5cbiAgICAgIC8vIHdlIGV4aXQgdGhlIGFkIHdpdGhpbiB0aGlzIGV4dGVuc2lvbi5cbiAgICAgIHRoaXMuaWRPZkFkU2hvd2luZ18gPSBhZEluZGV4O1xuICAgIH1cblxuICAgIGlmICghaGFzT3duKHRoaXMudW5pcXVlUGFnZUlkc18sIHBhZ2VJZCkpIHtcbiAgICAgIHRoaXMudW5pcXVlUGFnZXNDb3VudF8rKztcbiAgICAgIHRoaXMudW5pcXVlUGFnZUlkc19bcGFnZUlkXSA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMudW5pcXVlUGFnZXNDb3VudF8gPiBNSU5fSU5URVJWQUwpIHtcbiAgICAgIGNvbnN0IGFkU3RhdGUgPSB0aGlzLnRyeVRvUGxhY2VBZEFmdGVyUGFnZV8ocGFnZUlkKTtcblxuICAgICAgaWYgKGFkU3RhdGUgPT09IEFEX1NUQVRFLklOU0VSVEVEKSB7XG4gICAgICAgIHRoaXMuYW5hbHl0aWNzRXZlbnRXaXRoQ3VycmVudEFkXyhFdmVudHMuQURfSU5TRVJURUQsXG4gICAgICAgICAgICB7W1ZhcnMuQURfSU5TRVJURURdOiBEYXRlLm5vdygpfSk7XG4gICAgICAgIHRoaXMuYWRzUGxhY2VkXysrO1xuICAgICAgICAvLyBzdGFydCBsb2FkaW5nIG5leHQgYWRcbiAgICAgICAgdGhpcy5zdGFydE5leHRQYWdlXygpO1xuICAgICAgfVxuXG4gICAgICBpZiAoYWRTdGF0ZSA9PT0gQURfU1RBVEUuRkFJTEVEKSB7XG4gICAgICAgIHRoaXMuYW5hbHl0aWNzRXZlbnRXaXRoQ3VycmVudEFkXyhFdmVudHMuQURfRElTQ0FSREVELFxuICAgICAgICAgICAge1tWYXJzLkFEX0RJU0NBUkRFRF06IERhdGUubm93KCl9KTtcbiAgICAgICAgdGhpcy5zdGFydE5leHRQYWdlXygpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG5cbiAgLyoqXG4gICAqIHN0YXJ0IHRoZSBwcm9jZXNzIG92ZXJcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHN0YXJ0TmV4dFBhZ2VfKCkge1xuICAgIHRoaXMudW5pcXVlUGFnZXNDb3VudF8gPSAwO1xuICAgIHRoaXMuc2NoZWR1bGVQYWdlXygpO1xuICB9XG5cblxuICAvKipcbiAgICogUGxhY2UgYWQgYmFzZWQgb24gdXNlciBjb25maWdcbiAgICogQHBhcmFtIHtzdHJpbmd9IHBhZ2VCZWZvcmVBZElkXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB0cnlUb1BsYWNlQWRBZnRlclBhZ2VfKHBhZ2VCZWZvcmVBZElkKSB7XG4gICAgY29uc3QgbmV4dEFkUGFnZUVsID0gdGhpcy5hZFBhZ2VFbHNfW3RoaXMuYWRQYWdlRWxzXy5sZW5ndGggLSAxXTtcbiAgICBpZiAoIXRoaXMuaXNDdXJyZW50QWRMb2FkZWRfICYmIHRoaXMuYWRUaW1lZE91dF8oKSkge1xuICAgICAgLy8gdGltZW91dCBmYWlsXG4gICAgICByZXR1cm4gQURfU1RBVEUuRkFJTEVEO1xuICAgIH1cblxuICAgIGxldCBwYWdlQmVmb3JlQWQgPSB0aGlzLmFtcFN0b3J5Xy5nZXRQYWdlQnlJZChwYWdlQmVmb3JlQWRJZCk7XG4gICAgbGV0IHBhZ2VBZnRlckFkID0gdGhpcy5hbXBTdG9yeV8uZ2V0TmV4dFBhZ2UocGFnZUJlZm9yZUFkKTtcblxuICAgIGlmICghcGFnZUFmdGVyQWQpIHtcbiAgICAgIHJldHVybiBBRF9TVEFURS5QRU5ESU5HO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzRGVza3RvcFZpZXdfKCkpIHtcbiAgICAgIC8vIElmIHdlIGFyZSBpbiBkZXNrdG9wIHZpZXcgdGhlIGFkIG11c3QgYmUgaW5zZXJ0ZWQgMiBwYWdlcyBhd2F5IGJlY2F1c2VcbiAgICAgIC8vIHRoZSBuZXh0IHBhZ2Ugd2lsbCBhbHJlYWR5IGJlIGluIHZpZXdcbiAgICAgIHBhZ2VCZWZvcmVBZCA9IHBhZ2VBZnRlckFkO1xuICAgICAgcGFnZUJlZm9yZUFkSWQgPSBwYWdlQWZ0ZXJBZC5lbGVtZW50LmlkO1xuICAgICAgcGFnZUFmdGVyQWQgPSB0aGlzLmFtcFN0b3J5Xy5nZXROZXh0UGFnZShwYWdlQWZ0ZXJBZCk7XG4gICAgfVxuXG4gICAgaWYgKCFwYWdlQWZ0ZXJBZCkge1xuICAgICAgcmV0dXJuIEFEX1NUQVRFLlBFTkRJTkc7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmlzQ3VycmVudEFkTG9hZGVkXyB8fCBwYWdlQmVmb3JlQWQuaXNBZCgpIHx8XG4gICAgICAgIHBhZ2VBZnRlckFkLmlzQWQoKSkge1xuICAgICAgLy8gaWYgd2UgYXJlIGdvaW5nIHRvIGNhdXNlIHR3byBjb25zZWN1dGl2ZSBhZHMgb3IgYWQgaXMgc3RpbGxcbiAgICAgIC8vIGxvYWRpbmcgd2Ugd2lsbCB0cnkgYWdhaW4gb24gbmV4dCB1c2VyIGludGVyYWN0aW9uXG4gICAgICByZXR1cm4gQURfU1RBVEUuUEVORElORztcbiAgICB9XG5cbiAgICBjb25zdCBjdGFDcmVhdGVkID0gdGhpcy5tYXliZUNyZWF0ZUN0YUxheWVyXyhuZXh0QWRQYWdlRWwpO1xuICAgIGlmICghY3RhQ3JlYXRlZCkge1xuICAgICAgLy8gZmFpbGVkIG9uIGFkLXNlcnZlciByZXNwb25zZSBmb3JtYXRcbiAgICAgIHJldHVybiBBRF9TVEFURS5GQUlMRUQ7XG4gICAgfVxuXG4gICAgdGhpcy5hbXBTdG9yeV8uaW5zZXJ0UGFnZShwYWdlQmVmb3JlQWRJZCwgbmV4dEFkUGFnZUVsLmlkKTtcblxuICAgIC8vIElmIHdlIGFyZSBpbnNlcnRlZCB3ZSBub3cgaGF2ZSBhIGBwb3NpdGlvbmAgbWFjcm8gYXZhaWxhYmxlIGZvciBhbnlcbiAgICAvLyBhbmFseXRpY3MgZXZlbnRzIG1vdmluZyBmb3J3YXJkLlxuICAgIGNvbnN0IGFkSW5kZXggPSB0aGlzLmFkUGFnZUlkc19bbmV4dEFkUGFnZUVsLmlkXTtcbiAgICBjb25zdCBwYWdlTnVtYmVyID0gdGhpcy5hbXBTdG9yeV8uZ2V0UGFnZUluZGV4QnlJZChwYWdlQmVmb3JlQWRJZCk7XG4gICAgdGhpcy5hbmFseXRpY3NEYXRhX1thZEluZGV4XVtWYXJzLlBPU0lUSU9OXSA9IHBhZ2VOdW1iZXIgKyAxO1xuXG4gICAgcmV0dXJuIEFEX1NUQVRFLklOU0VSVEVEO1xuICB9XG5cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlzRGVza3RvcFZpZXdfKCkge1xuICAgIHJldHVybiAhIXRoaXMuc3RvcmVTZXJ2aWNlXy5nZXQoU3RhdGVQcm9wZXJ0eS5ERVNLVE9QX1NUQVRFKTtcbiAgfVxuXG5cbiAgLyoqXG4gICAqIEBwcml2YXRlXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBhZFRpbWVkT3V0XygpIHtcbiAgICByZXR1cm4gKERhdGUubm93KCkgLSB0aGlzLnRpbWVDdXJyZW50UGFnZUNyZWF0ZWRfKSA+IFRJTUVPVVRfTElNSVQ7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBDYWxsIGFuIGFuYWx5dGljcyBldmVudCB3aXRoIHRoZSBsYXN0IGNyZWF0ZWQgQWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn0gdmFycyBBIG1hcCBvZiB2YXJzIGFuZCB0aGVpciB2YWx1ZXMuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBhbmFseXRpY3NFdmVudFdpdGhDdXJyZW50QWRfKGV2ZW50VHlwZSwgdmFycykge1xuICAgIE9iamVjdC5hc3NpZ24odmFycywge1tWYXJzLkFEX0lOREVYXTogdGhpcy5hZFBhZ2VzQ3JlYXRlZF99KTtcbiAgICB0aGlzLmFuYWx5dGljc0V2ZW50XyhldmVudFR5cGUsIHZhcnMpO1xuICB9XG5cblxuICAvKipcbiAgICogQ29uc3RydWN0IGFuIGFuYWx5dGljcyBldmVudCBhbmQgdHJpZ2dlciBpdC5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50VHlwZVxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSB2YXJzIEEgbWFwIG9mIHZhcnMgYW5kIHRoZWlyIHZhbHVlcy5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGFuYWx5dGljc0V2ZW50XyhldmVudFR5cGUsIHZhcnMpIHtcbiAgICBjb25zdCBhZEluZGV4ID0gdmFyc1snYWRJbmRleCddO1xuICAgIHRoaXMuYW5hbHl0aWNzRGF0YV9bYWRJbmRleF0gPSBPYmplY3QuYXNzaWduKHRoaXMuYW5hbHl0aWNzRGF0YV9bYWRJbmRleF0sXG4gICAgICAgIHZhcnMpO1xuXG4gICAgdHJpZ2dlckFuYWx5dGljc0V2ZW50KHRoaXMuZWxlbWVudCwgZXZlbnRUeXBlLFxuICAgICAgICB0aGlzLmFuYWx5dGljc0RhdGFfW2FkSW5kZXhdKTtcbiAgfVxufVxuXG5BTVAuZXh0ZW5zaW9uKCdhbXAtc3RvcnktYXV0by1hZHMnLCAnMC4xJywgQU1QID0+IHtcbiAgQU1QLnJlZ2lzdGVyRWxlbWVudCgnYW1wLXN0b3J5LWF1dG8tYWRzJywgQW1wU3RvcnlBdXRvQWRzLCBDU1MpO1xufSk7XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtnZXRDcnlwdG9SYW5kb21CeXRlc0FycmF5fSBmcm9tICcuLi8uLi8uLi9zcmMvdXRpbHMvYnl0ZXMnO1xuXG5cbi8qKlxuICogUmV0dXJucyBhbiBzdHJpbmcgd2l0aCBhIHRvdGFsIG9mIDEyOCBvZiByYW5kb20gdmFsdWVzIGJhc2VkIG9uIHRoZVxuICogYHdpbi5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzYCBBUEkuIElmIHRoYXQgaXMgbm90IGF2YWlsYWJsZSBjb25jYXRlbmF0ZXNcbiAqIGEgc3RyaW5nIG9mIG90aGVyIHZhbHVlcyB0aGF0IG1pZ2h0IGJlIGhhcmQgdG8gZ3Vlc3MgaW5jbHVkaW5nXG4gKiBgTWF0aC5yYW5kb21gIGFuZCB0aGUgY3VycmVudCB0aW1lLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge3N0cmluZ30gRW50cm9weS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFVuaXF1ZUlkKHdpbikge1xuICAvLyBVc2Ugd2luLmNyeXB0by5nZXRSYW5kb21WYWx1ZXMgdG8gZ2V0IDEyOCBiaXRzIG9mIHJhbmRvbSB2YWx1ZVxuICBjb25zdCB1aW50OGFycmF5ID0gZ2V0Q3J5cHRvUmFuZG9tQnl0ZXNBcnJheSh3aW4sIDE2KTsgLy8gMTI4IGJpdFxuICBpZiAodWludDhhcnJheSkge1xuICAgIHJldHVybiB1aW50OGFycmF5LmpvaW4oJycpO1xuICB9XG5cbiAgLy8gU3VwcG9ydCBmb3IgbGVnYWN5IGJyb3dzZXJzLlxuICByZXR1cm4gU3RyaW5nKHdpbi5sb2NhdGlvbi5ocmVmICsgRGF0ZS5ub3coKSArXG4gICAgICB3aW4uTWF0aC5yYW5kb20oKSArIHdpbi5zY3JlZW4ud2lkdGggKyB3aW4uc2NyZWVuLmhlaWdodCk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtFbWJlZE1vZGUsIHBhcnNlRW1iZWRNb2RlfSBmcm9tICcuL2VtYmVkLW1vZGUnO1xuaW1wb3J0IHtPYnNlcnZhYmxlfSBmcm9tICcuLi8uLi8uLi9zcmMvb2JzZXJ2YWJsZSc7XG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZXMnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4uLy4uLy4uL3NyYy9sb2cnO1xuaW1wb3J0IHtoYXNPd259IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtyZWdpc3RlclNlcnZpY2VCdWlsZGVyfSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZSc7XG5cblxuLyoqIEB0eXBlIHtzdHJpbmd9ICovXG5jb25zdCBUQUcgPSAnYW1wLXN0b3J5JztcblxuXG4vKipcbiAqIFV0aWwgZnVuY3Rpb24gdG8gcmV0cmlldmUgdGhlIHN0b3JlIHNlcnZpY2UuIEVuc3VyZXMgd2UgY2FuIHJldHJpZXZlIHRoZVxuICogc2VydmljZSBzeW5jaHJvbm91c2x5IGZyb20gdGhlIGFtcC1zdG9yeSBjb2RlYmFzZSB3aXRob3V0IHJ1bm5pbmcgaW50byByYWNlXG4gKiBjb25kaXRpb25zLlxuICogQHBhcmFtICB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshQW1wU3RvcnlTdG9yZVNlcnZpY2V9XG4gKi9cbmV4cG9ydCBjb25zdCBnZXRTdG9yZVNlcnZpY2UgPSB3aW4gPT4ge1xuICBsZXQgc2VydmljZSA9IFNlcnZpY2VzLnN0b3J5U3RvcmVTZXJ2aWNlKHdpbik7XG5cbiAgaWYgKCFzZXJ2aWNlKSB7XG4gICAgc2VydmljZSA9IG5ldyBBbXBTdG9yeVN0b3JlU2VydmljZSh3aW4pO1xuICAgIHJlZ2lzdGVyU2VydmljZUJ1aWxkZXIod2luLCAnc3Rvcnktc3RvcmUnLCAoKSA9PiBzZXJ2aWNlKTtcbiAgfVxuXG4gIHJldHVybiBzZXJ2aWNlO1xufTtcblxuXG4vKipcbiAqIERpZmZlcmVudCBVSSBleHBlcmllbmNlcyB0byBkaXNwbGF5IHRoZSBzdG9yeS5cbiAqIEBjb25zdCBAZW51bSB7bnVtYmVyfVxuICovXG5leHBvcnQgY29uc3QgVUlUeXBlID0ge1xuICBNT0JJTEU6IDAsXG4gIERFU0tUT1A6IDEsXG4gIFNDUk9MTDogMixcbn07XG5cblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICAgY2FuaW5zZXJ0YXV0b21hdGljYWQ6IGJvb2xlYW4sXG4gKiAgICBjYW5zaG93Ym9va2VuZDogYm9vbGVhbixcbiAqICAgIGNhbnNob3duYXZpZ2F0aW9ub3ZlcmxheWhpbnQ6IGJvb2xlYW4sXG4gKiAgICBjYW5zaG93cHJldmlvdXNwYWdlaGVscDogYm9vbGVhbixcbiAqICAgIGNhbnNob3dzaGFyaW5ndWlzOiBib29sZWFuLFxuICogICAgY2Fuc2hvd3N5c3RlbWxheWVyYnV0dG9uczogYm9vbGVhbixcbiAqICAgIGFjY2Vzc3N0YXRlOiBib29sZWFuLFxuICogICAgYWRzdGF0ZTogYm9vbGVhbixcbiAqICAgIGJvb2tlbmRzdGF0ZTogYm9vbGVhbixcbiAqICAgIGRlc2t0b3BzdGF0ZTogYm9vbGVhbixcbiAqICAgIGluZm9kaWFsb2dzdGF0ZTogYm9vbGVhbixcbiAqICAgIGhhc2F1ZGlvc3RhdGU6IGJvb2xlYW4sXG4gKiAgICBsYW5kc2NhcGVzdGF0ZTogYm9vbGVhbixcbiAqICAgIG11dGVkc3RhdGU6IGJvb2xlYW4sXG4gKiAgICBwYXVzZWRzdGF0ZTogYm9vbGVhbixcbiAqICAgIHJ0bHN0YXRlOiBib29sZWFuLFxuICogICAgc2hhcmVtZW51c3RhdGU6IGJvb2xlYW4sXG4gKiAgICBzdXBwb3J0ZWRicm93c2Vyc3RhdGU6IGJvb2xlYW4sXG4gKiAgICB1aXN0YXRlOiAhVUlUeXBlLFxuICogICAgY29uc2VudGlkOiA/c3RyaW5nLFxuICogICAgY3VycmVudHBhZ2VpZDogc3RyaW5nLFxuICogfX1cbiAqL1xuZXhwb3J0IGxldCBTdGF0ZTtcblxuXG4vKiogQHByaXZhdGUgQGNvbnN0IEBlbnVtIHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgU3RhdGVQcm9wZXJ0eSA9IHtcbiAgLy8gRW1iZWQgb3B0aW9ucy5cbiAgQ0FOX0lOU0VSVF9BVVRPTUFUSUNfQUQ6ICdjYW5pbnNlcnRhdXRvbWF0aWNhZCcsXG4gIENBTl9TSE9XX0JPT0tFTkQ6ICdjYW5zaG93Ym9va2VuZCcsXG4gIENBTl9TSE9XX05BVklHQVRJT05fT1ZFUkxBWV9ISU5UOiAnY2Fuc2hvd25hdmlnYXRpb25vdmVybGF5aGludCcsXG4gIENBTl9TSE9XX1BSRVZJT1VTX1BBR0VfSEVMUDogJ2NhbnNob3dwcmV2aW91c3BhZ2VoZWxwJyxcbiAgQ0FOX1NIT1dfU0hBUklOR19VSVM6ICdjYW5zaG93c2hhcmluZ3VpcycsXG4gIENBTl9TSE9XX1NZU1RFTV9MQVlFUl9CVVRUT05TOiAnY2Fuc2hvd3N5c3RlbWxheWVyYnV0dG9ucycsXG5cbiAgLy8gQXBwIFN0YXRlcy5cbiAgQUNDRVNTX1NUQVRFOiAnYWNjZXNzc3RhdGUnLCAvLyBhbXAtYWNjZXNzIHBheXdhbGwuXG4gIEFEX1NUQVRFOiAnYWRzdGF0ZScsXG4gIEJPT0tFTkRfU1RBVEU6ICdib29rZW5kc3RhdGUnLFxuICBERVNLVE9QX1NUQVRFOiAnZGVza3RvcHN0YXRlJyxcbiAgSEFTX0FVRElPX1NUQVRFOiAnaGFzYXVkaW9zdGF0ZScsXG4gIElORk9fRElBTE9HX1NUQVRFOiAnaW5mb2RpYWxvZ3N0YXRlJyxcbiAgTEFORFNDQVBFX1NUQVRFOiAnbGFuZHNjYXBlc3RhdGUnLFxuICBNVVRFRF9TVEFURTogJ211dGVkc3RhdGUnLFxuICBQQVVTRURfU1RBVEU6ICdwYXVzZWRzdGF0ZScsXG4gIFJUTF9TVEFURTogJ3J0bHN0YXRlJyxcbiAgU0hBUkVfTUVOVV9TVEFURTogJ3NoYXJlbWVudXN0YXRlJyxcbiAgU1VQUE9SVEVEX0JST1dTRVJfU1RBVEU6ICdzdXBwb3J0ZWRicm93c2Vyc3RhdGUnLFxuICBVSV9TVEFURTogJ3Vpc3RhdGUnLFxuXG4gIC8vIEFwcCBkYXRhLlxuICBDT05TRU5UX0lEOiAnY29uc2VudGlkJyxcbiAgQ1VSUkVOVF9QQUdFX0lEOiAnY3VycmVudHBhZ2VpZCcsXG4gIENVUlJFTlRfUEFHRV9JTkRFWDogJ2N1cnJlbnRwYWdlaW5kZXgnLFxufTtcblxuXG4vKiogQHByaXZhdGUgQGNvbnN0IEBlbnVtIHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgQWN0aW9uID0ge1xuICBDSEFOR0VfUEFHRTogJ3NldGN1cnJlbnRwYWdlaWQnLFxuICBTRVRfQ09OU0VOVF9JRDogJ3NldGNvbnNlbnRpZCcsXG4gIFRPR0dMRV9BQ0NFU1M6ICd0b2dnbGVhY2Nlc3MnLFxuICBUT0dHTEVfQUQ6ICd0b2dnbGVhZCcsXG4gIFRPR0dMRV9CT09LRU5EOiAndG9nZ2xlYm9va2VuZCcsXG4gIFRPR0dMRV9JTkZPX0RJQUxPRzogJ3RvZ2dsZWluZm9kaWFsb2cnLFxuICBUT0dHTEVfSEFTX0FVRElPOiAndG9nZ2xlaGFzYXVkaW8nLFxuICBUT0dHTEVfTEFORFNDQVBFOiAndG9nZ2xlbGFuZHNjYXBlJyxcbiAgVE9HR0xFX01VVEVEOiAndG9nZ2xlbXV0ZWQnLFxuICBUT0dHTEVfUEFVU0VEOiAndG9nZ2xlcGF1c2VkJyxcbiAgVE9HR0xFX1JUTDogJ3RvZ2dsZXJ0bCcsXG4gIFRPR0dMRV9TSEFSRV9NRU5VOiAndG9nZ2xlc2hhcmVtZW51JyxcbiAgVE9HR0xFX1NVUFBPUlRFRF9CUk9XU0VSOiAndG9nZ2xlc3VwcG9ydGVkYnJvd3NlcicsXG4gIFRPR0dMRV9VSTogJ3RvZ2dsZXVpJyxcbn07XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBuZXcgc2F0ZS5cbiAqIEBwYXJhbSAgeyFTdGF0ZX0gc3RhdGUgSW1tdXRhYmxlIHN0YXRlXG4gKiBAcGFyYW0gIHshQWN0aW9ufSBhY3Rpb25cbiAqIEBwYXJhbSAgeyp9IGRhdGFcbiAqIEByZXR1cm4geyFTdGF0ZX0gbmV3IHN0YXRlXG4gKi9cbmNvbnN0IGFjdGlvbnMgPSAoc3RhdGUsIGFjdGlvbiwgZGF0YSkgPT4ge1xuICBzd2l0Y2ggKGFjdGlvbikge1xuICAgIC8vIFRyaWdnZXJzIHRoZSBhbXAtYWNlc3MgcGF5d2FsbC5cbiAgICBjYXNlIEFjdGlvbi5UT0dHTEVfQUNDRVNTOlxuICAgICAgcmV0dXJuIC8qKiBAdHlwZSB7IVN0YXRlfSAqLyAoT2JqZWN0LmFzc2lnbihcbiAgICAgICAgICB7fSwgc3RhdGUsIHtcbiAgICAgICAgICAgIFtTdGF0ZVByb3BlcnR5LkFDQ0VTU19TVEFURV06ICEhZGF0YSxcbiAgICAgICAgICAgIFtTdGF0ZVByb3BlcnR5LlBBVVNFRF9TVEFURV06ICEhZGF0YSxcbiAgICAgICAgICB9KSk7XG4gICAgLy8gVHJpZ2dlcnMgdGhlIGFkIFVJLlxuICAgIGNhc2UgQWN0aW9uLlRPR0dMRV9BRDpcbiAgICAgIHJldHVybiAvKiogQHR5cGUgeyFTdGF0ZX0gKi8gKE9iamVjdC5hc3NpZ24oXG4gICAgICAgICAge30sIHN0YXRlLCB7W1N0YXRlUHJvcGVydHkuQURfU1RBVEVdOiAhIWRhdGF9KSk7XG4gICAgLy8gU2hvd3Mgb3IgaGlkZXMgdGhlIGJvb2tlbmQuXG4gICAgY2FzZSBBY3Rpb24uVE9HR0xFX0JPT0tFTkQ6XG4gICAgICBpZiAoIXN0YXRlW1N0YXRlUHJvcGVydHkuQ0FOX1NIT1dfQk9PS0VORF0pIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIC8qKiBAdHlwZSB7IVN0YXRlfSAqLyAoT2JqZWN0LmFzc2lnbihcbiAgICAgICAgICB7fSwgc3RhdGUsIHtbU3RhdGVQcm9wZXJ0eS5CT09LRU5EX1NUQVRFXTogISFkYXRhfSkpO1xuICAgIC8vIFNob3dzIG9yIGhpZGVzIHRoZSBpbmZvIGRpYWxvZy5cbiAgICBjYXNlIEFjdGlvbi5UT0dHTEVfSU5GT19ESUFMT0c6XG4gICAgICByZXR1cm4gLyoqIEB0eXBlIHshU3RhdGV9ICovIChPYmplY3QuYXNzaWduKFxuICAgICAgICAgIHt9LCBzdGF0ZSwge1xuICAgICAgICAgICAgW1N0YXRlUHJvcGVydHkuSU5GT19ESUFMT0dfU1RBVEVdOiAhIWRhdGEsXG4gICAgICAgICAgICBbU3RhdGVQcm9wZXJ0eS5QQVVTRURfU1RBVEVdOiAhIWRhdGEsXG4gICAgICAgICAgfSkpO1xuICAgIC8vIFNob3dzIG9yIGhpZGVzIHRoZSBhdWRpbyBjb250cm9scy5cbiAgICBjYXNlIEFjdGlvbi5UT0dHTEVfSEFTX0FVRElPOlxuICAgICAgcmV0dXJuIC8qKiBAdHlwZSB7IVN0YXRlfSAqLyAoT2JqZWN0LmFzc2lnbihcbiAgICAgICAgICB7fSwgc3RhdGUsIHtbU3RhdGVQcm9wZXJ0eS5IQVNfQVVESU9fU1RBVEVdOiAhIWRhdGF9KSk7XG4gICAgY2FzZSBBY3Rpb24uVE9HR0xFX0xBTkRTQ0FQRTpcbiAgICAgIHJldHVybiAvKiogQHR5cGUgeyFTdGF0ZX0gKi8gKE9iamVjdC5hc3NpZ24oXG4gICAgICAgICAge30sIHN0YXRlLCB7W1N0YXRlUHJvcGVydHkuTEFORFNDQVBFX1NUQVRFXTogISFkYXRhfSkpO1xuICAgIC8vIE11dGVzIG9yIHVubXV0ZXMgdGhlIHN0b3J5IG1lZGlhLlxuICAgIGNhc2UgQWN0aW9uLlRPR0dMRV9NVVRFRDpcbiAgICAgIHJldHVybiAvKiogQHR5cGUgeyFTdGF0ZX0gKi8gKE9iamVjdC5hc3NpZ24oXG4gICAgICAgICAge30sIHN0YXRlLCB7W1N0YXRlUHJvcGVydHkuTVVURURfU1RBVEVdOiAhIWRhdGF9KSk7XG4gICAgY2FzZSBBY3Rpb24uVE9HR0xFX1BBVVNFRDpcbiAgICAgIHJldHVybiAvKiogQHR5cGUgeyFTdGF0ZX0gKi8gKE9iamVjdC5hc3NpZ24oXG4gICAgICAgICAge30sIHN0YXRlLCB7W1N0YXRlUHJvcGVydHkuUEFVU0VEX1NUQVRFXTogISFkYXRhfSkpO1xuICAgIGNhc2UgQWN0aW9uLlRPR0dMRV9SVEw6XG4gICAgICByZXR1cm4gLyoqIEB0eXBlIHshU3RhdGV9ICovIChPYmplY3QuYXNzaWduKFxuICAgICAgICAgIHt9LCBzdGF0ZSwge1tTdGF0ZVByb3BlcnR5LlJUTF9TVEFURV06ICEhZGF0YX0pKTtcbiAgICBjYXNlIEFjdGlvbi5UT0dHTEVfU1VQUE9SVEVEX0JST1dTRVI6XG4gICAgICByZXR1cm4gLyoqIEB0eXBlIHshU3RhdGV9ICovIChPYmplY3QuYXNzaWduKFxuICAgICAgICAgIHt9LCBzdGF0ZSwge1tTdGF0ZVByb3BlcnR5LlNVUFBPUlRFRF9CUk9XU0VSX1NUQVRFXTogISFkYXRhfSkpO1xuICAgIGNhc2UgQWN0aW9uLlRPR0dMRV9TSEFSRV9NRU5VOlxuICAgICAgcmV0dXJuIC8qKiBAdHlwZSB7IVN0YXRlfSAqLyAoT2JqZWN0LmFzc2lnbihcbiAgICAgICAgICB7fSwgc3RhdGUsIHtcbiAgICAgICAgICAgIFtTdGF0ZVByb3BlcnR5LlBBVVNFRF9TVEFURV06ICEhZGF0YSxcbiAgICAgICAgICAgIFtTdGF0ZVByb3BlcnR5LlNIQVJFX01FTlVfU1RBVEVdOiAhIWRhdGEsXG4gICAgICAgICAgfSkpO1xuICAgIGNhc2UgQWN0aW9uLlRPR0dMRV9VSTpcbiAgICAgIHJldHVybiAvKiogQHR5cGUgeyFTdGF0ZX0gKi8gKE9iamVjdC5hc3NpZ24oXG4gICAgICAgICAge30sIHN0YXRlLCB7XG4gICAgICAgICAgICAvLyBLZWVwIERFU0tUT1BfU1RBVEUgZm9yIGNvbXBhdGlibGl0eSB3aXRoIHYwLjEuXG4gICAgICAgICAgICBbU3RhdGVQcm9wZXJ0eS5ERVNLVE9QX1NUQVRFXTogZGF0YSA9PT0gVUlUeXBlLkRFU0tUT1AsXG4gICAgICAgICAgICBbU3RhdGVQcm9wZXJ0eS5VSV9TVEFURV06IGRhdGEsXG4gICAgICAgICAgfSkpO1xuICAgIGNhc2UgQWN0aW9uLlNFVF9DT05TRU5UX0lEOlxuICAgICAgcmV0dXJuIC8qKiBAdHlwZSB7IVN0YXRlfSAqLyAoT2JqZWN0LmFzc2lnbihcbiAgICAgICAgICB7fSwgc3RhdGUsIHtbU3RhdGVQcm9wZXJ0eS5DT05TRU5UX0lEXTogZGF0YX0pKTtcbiAgICBjYXNlIEFjdGlvbi5DSEFOR0VfUEFHRTpcbiAgICAgIHJldHVybiAvKiogQHR5cGUgeyFTdGF0ZX0gKi8gKE9iamVjdC5hc3NpZ24oXG4gICAgICAgICAge30sIHN0YXRlLCB7XG4gICAgICAgICAgICBbU3RhdGVQcm9wZXJ0eS5DVVJSRU5UX1BBR0VfSURdOiBkYXRhLmlkLFxuICAgICAgICAgICAgW1N0YXRlUHJvcGVydHkuQ1VSUkVOVF9QQUdFX0lOREVYXTogZGF0YS5pbmRleCxcbiAgICAgICAgICB9KSk7XG4gICAgZGVmYXVsdDpcbiAgICAgIGRldigpLmVycm9yKFRBRywgYFVua25vd24gYWN0aW9uICR7YWN0aW9ufS5gKTtcbiAgICAgIHJldHVybiBzdGF0ZTtcbiAgfVxufTtcblxuXG4vKipcbiAqIFN0b3JlIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBjbGFzcyBBbXBTdG9yeVN0b3JlU2VydmljZSB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luKSB7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IVdpbmRvd30gKi9cbiAgICB0aGlzLndpbl8gPSB3aW47XG5cbiAgICAvKiogQHByaXZhdGUgeyFPYmplY3Q8c3RyaW5nLCAhT2JzZXJ2YWJsZT59ICovXG4gICAgdGhpcy5saXN0ZW5lcnNfID0ge307XG5cbiAgICAvKiogQHByaXZhdGUgeyFTdGF0ZX0gKi9cbiAgICB0aGlzLnN0YXRlXyA9IC8qKiBAdHlwZSB7IVN0YXRlfSAqLyAoT2JqZWN0LmFzc2lnbihcbiAgICAgICAge30sIHRoaXMuZ2V0RGVmYXVsdFN0YXRlXygpLCB0aGlzLmdldEVtYmVkT3ZlcnJpZGVzXygpKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIGEgc3RhdGUgcHJvcGVydHkuXG4gICAqIEBwYXJhbSAge3N0cmluZ30ga2V5IFByb3BlcnR5IHRvIHJldHJpZXZlIGZyb20gdGhlIHN0YXRlLlxuICAgKiBAcmV0dXJuIHsqfVxuICAgKi9cbiAgZ2V0KGtleSkge1xuICAgIGlmICghaGFzT3duKHRoaXMuc3RhdGVfLCBrZXkpKSB7XG4gICAgICBkZXYoKS5lcnJvcihUQUcsIGBVbmtub3duIHN0YXRlICR7a2V5fS5gKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuc3RhdGVfW2tleV07XG4gIH1cblxuICAvKipcbiAgICogU3Vic2NyaWJlcyB0byBhIHN0YXRlIHByb3BlcnR5IG11dGF0aW9ucy5cbiAgICogQHBhcmFtICB7c3RyaW5nfSBrZXlcbiAgICogQHBhcmFtICB7IUZ1bmN0aW9ufSBsaXN0ZW5lclxuICAgKiBAcGFyYW0gIHtib29sZWFuPX0gY2FsbFRvSW5pdGlhbGl6ZSBXaGV0aGVyIHRoZSBsaXN0ZW5lciBzaG91bGQgYmVcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcmVkIHdpdGggY3VycmVudCB2YWx1ZS5cbiAgICovXG4gIHN1YnNjcmliZShrZXksIGxpc3RlbmVyLCBjYWxsVG9Jbml0aWFsaXplID0gZmFsc2UpIHtcbiAgICBpZiAoIWhhc093bih0aGlzLnN0YXRlXywga2V5KSkge1xuICAgICAgZGV2KCkuZXJyb3IoVEFHLCBgQ2FuJ3Qgc3Vic2NyaWJlIHRvIHVua25vd24gc3RhdGUgJHtrZXl9LmApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIXRoaXMubGlzdGVuZXJzX1trZXldKSB7XG4gICAgICB0aGlzLmxpc3RlbmVyc19ba2V5XSA9IG5ldyBPYnNlcnZhYmxlKCk7XG4gICAgfVxuICAgIHRoaXMubGlzdGVuZXJzX1trZXldLmFkZChsaXN0ZW5lcik7XG5cbiAgICBpZiAoY2FsbFRvSW5pdGlhbGl6ZSkge1xuICAgICAgbGlzdGVuZXIodGhpcy5nZXQoa2V5KSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERpc3BhdGNoZXMgYW4gYWN0aW9uIGFuZCB0cmlnZ2VycyB0aGUgbGlzdGVuZXJzIGZvciB0aGUgdXBkYXRlZCBzdGF0ZVxuICAgKiBwcm9wZXJ0aWVzLlxuICAgKiBAcGFyYW0gIHshQWN0aW9ufSBhY3Rpb25cbiAgICogQHBhcmFtICB7Kn0gZGF0YVxuICAgKi9cbiAgZGlzcGF0Y2goYWN0aW9uLCBkYXRhKSB7XG4gICAgY29uc3Qgb2xkU3RhdGUgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnN0YXRlXyk7XG4gICAgdGhpcy5zdGF0ZV8gPSBhY3Rpb25zKHRoaXMuc3RhdGVfLCBhY3Rpb24sIGRhdGEpO1xuXG4gICAgT2JqZWN0LmtleXModGhpcy5saXN0ZW5lcnNfKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICBpZiAob2xkU3RhdGVba2V5XSAhPT0gdGhpcy5zdGF0ZV9ba2V5XSkge1xuICAgICAgICB0aGlzLmxpc3RlbmVyc19ba2V5XS5maXJlKHRoaXMuc3RhdGVfW2tleV0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHJpZXZlcyB0aGUgZGVmYXVsdCBzdGF0ZSwgdGhhdCBjb3VsZCBiZSBvdmVycmlkZW4gYnkgYW4gZW1iZWQgbW9kZS5cbiAgICogQHJldHVybiB7IVN0YXRlfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0RGVmYXVsdFN0YXRlXygpIHtcbiAgICAvLyBDb21waWxlciB3b24ndCByZXNvbHZlIHRoZSBvYmplY3Qga2V5cyBhbmQgdHJpZ2dlciBhbiBlcnJvciBmb3IgbWlzc2luZ1xuICAgIC8vIHByb3BlcnRpZXMsIHNvIHdlIGhhdmUgdG8gZm9yY2UgdGhlIHR5cGUuXG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVN0YXRlfSAqLyAoe1xuICAgICAgW1N0YXRlUHJvcGVydHkuQ0FOX0lOU0VSVF9BVVRPTUFUSUNfQURdOiB0cnVlLFxuICAgICAgW1N0YXRlUHJvcGVydHkuQ0FOX1NIT1dfQk9PS0VORF06IHRydWUsXG4gICAgICBbU3RhdGVQcm9wZXJ0eS5DQU5fU0hPV19OQVZJR0FUSU9OX09WRVJMQVlfSElOVF06IHRydWUsXG4gICAgICBbU3RhdGVQcm9wZXJ0eS5DQU5fU0hPV19QUkVWSU9VU19QQUdFX0hFTFBdOiB0cnVlLFxuICAgICAgW1N0YXRlUHJvcGVydHkuQ0FOX1NIT1dfU0hBUklOR19VSVNdOiB0cnVlLFxuICAgICAgW1N0YXRlUHJvcGVydHkuQ0FOX1NIT1dfU1lTVEVNX0xBWUVSX0JVVFRPTlNdOiB0cnVlLFxuICAgICAgW1N0YXRlUHJvcGVydHkuQUNDRVNTX1NUQVRFXTogZmFsc2UsXG4gICAgICBbU3RhdGVQcm9wZXJ0eS5BRF9TVEFURV06IGZhbHNlLFxuICAgICAgW1N0YXRlUHJvcGVydHkuQk9PS0VORF9TVEFURV06IGZhbHNlLFxuICAgICAgW1N0YXRlUHJvcGVydHkuREVTS1RPUF9TVEFURV06IGZhbHNlLFxuICAgICAgW1N0YXRlUHJvcGVydHkuSU5GT19ESUFMT0dfU1RBVEVdOiBmYWxzZSxcbiAgICAgIFtTdGF0ZVByb3BlcnR5LkhBU19BVURJT19TVEFURV06IGZhbHNlLFxuICAgICAgW1N0YXRlUHJvcGVydHkuTEFORFNDQVBFX1NUQVRFXTogZmFsc2UsXG4gICAgICBbU3RhdGVQcm9wZXJ0eS5NVVRFRF9TVEFURV06IHRydWUsXG4gICAgICBbU3RhdGVQcm9wZXJ0eS5QQVVTRURfU1RBVEVdOiBmYWxzZSxcbiAgICAgIFtTdGF0ZVByb3BlcnR5LlJUTF9TVEFURV06IGZhbHNlLFxuICAgICAgW1N0YXRlUHJvcGVydHkuU0hBUkVfTUVOVV9TVEFURV06IGZhbHNlLFxuICAgICAgW1N0YXRlUHJvcGVydHkuU1VQUE9SVEVEX0JST1dTRVJfU1RBVEVdOiB0cnVlLFxuICAgICAgW1N0YXRlUHJvcGVydHkuVUlfU1RBVEVdOiBVSVR5cGUuTU9CSUxFLFxuICAgICAgW1N0YXRlUHJvcGVydHkuQ09OU0VOVF9JRF06IG51bGwsXG4gICAgICBbU3RhdGVQcm9wZXJ0eS5DVVJSRU5UX1BBR0VfSURdOiAnJyxcbiAgICAgIFtTdGF0ZVByb3BlcnR5LkNVUlJFTlRfUEFHRV9JTkRFWF06IDAsXG4gICAgfSk7XG4gIH1cblxuICAvLyBAVE9ETyhnbWFqb3VsZXQpOiBUaGVzZSBzaG91bGQgZ2V0IHRoZWlyIG93biBmaWxlIGlmIHRoZXkgc3RhcnQgZ3Jvd2luZy5cbiAgLyoqXG4gICAqIFJldHJpZXZlcyB0aGUgZW1iZWQgbW9kZSBjb25maWcsIHRoYXQgd2lsbCBvdmVycmlkZSB0aGUgZGVmYXVsdCBzdGF0ZS5cbiAgICogQHJldHVybiB7IU9iamVjdDxTdGF0ZVByb3BlcnR5LCAqPn0gUGFydGlhbCBzdGF0ZVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0RW1iZWRPdmVycmlkZXNfKCkge1xuICAgIGNvbnN0IGVtYmVkTW9kZSA9IHBhcnNlRW1iZWRNb2RlKHRoaXMud2luXy5sb2NhdGlvbi5oYXNoKTtcbiAgICBzd2l0Y2ggKGVtYmVkTW9kZSkge1xuICAgICAgY2FzZSBFbWJlZE1vZGUuTkFNRV9UQkQ6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgW1N0YXRlUHJvcGVydHkuQ0FOX0lOU0VSVF9BVVRPTUFUSUNfQURdOiBmYWxzZSxcbiAgICAgICAgICBbU3RhdGVQcm9wZXJ0eS5DQU5fU0hPV19CT09LRU5EXTogZmFsc2UsXG4gICAgICAgICAgW1N0YXRlUHJvcGVydHkuQ0FOX1NIT1dfTkFWSUdBVElPTl9PVkVSTEFZX0hJTlRdOiBmYWxzZSxcbiAgICAgICAgICBbU3RhdGVQcm9wZXJ0eS5DQU5fU0hPV19QUkVWSU9VU19QQUdFX0hFTFBdOiB0cnVlLFxuICAgICAgICAgIFtTdGF0ZVByb3BlcnR5LkNBTl9TSE9XX1NZU1RFTV9MQVlFUl9CVVRUT05TXTogZmFsc2UsXG4gICAgICAgICAgW1N0YXRlUHJvcGVydHkuTVVURURfU1RBVEVdOiBmYWxzZSxcbiAgICAgICAgfTtcbiAgICAgIGNhc2UgRW1iZWRNb2RlLk5PX1NIQVJJTkc6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgW1N0YXRlUHJvcGVydHkuQ0FOX1NIT1dfU0hBUklOR19VSVNdOiBmYWxzZSxcbiAgICAgICAgfTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHtpc0VudW1WYWx1ZX0gZnJvbSAnLi4vLi4vLi4vc3JjL3R5cGVzJztcbmltcG9ydCB7cGFyc2VRdWVyeVN0cmluZ30gZnJvbSAnLi4vLi4vLi4vc3JjL3VybCc7XG5cblxuLyoqXG4gKiBFbWJlZCBtb2RlIGZvciBBTVAgc3RvcnkuICBTZWUgLi4vZW1iZWQtbW9kZXMubWQgZm9yIGRldGFpbHMuXG4gKiBAZW51bSB7bnVtYmVyfVxuICovXG5leHBvcnQgY29uc3QgRW1iZWRNb2RlID0ge1xuICAvKipcbiAgICogRGVmYXVsdCBtb2RlLlxuICAgKi9cbiAgTk9UX0VNQkVEREVEOiAwLFxuXG4gIC8qKlxuICAgKiBUQkQgZW1iZWQgbW9kZS5cbiAgICpcbiAgICogVGhpcyBkaWZmZXJzIGZyb20gdGhlIE5PVF9FTUJFRERFRCBlbWJlZCBtb2RlIGluIHRoZSBmb2xsb3dpbmcgd2F5czpcbiAgICogLSBIaWRlcyBib29rZW5kXG4gICAqIC0gSGlkZXMgYWxsIHN5c3RlbSBsYXllciBidXR0b25zXG4gICAqIC0gRGlzYWJsZXMgc3dpcGUtYmFzZWQgdXNlciBlZHVjYXRpb25cbiAgICogLSBEaXNhbGxvd3MgYWRzXG4gICAqIC0gVW5tdXRlcyBhdWRpbyBpbiB0aGUgc3RvcnkgYnkgZGVmYXVsdFxuICAgKi9cbiAgTkFNRV9UQkQ6IDEsXG5cbiAgLyoqXG4gICAqIFRoaXMgbW9kZSBpcyBpbnRlbmRlZCBmb3IgZW1iZWRkZXJzIHRoYXQgbmF0aXZlbHkgaGFuZGxlIHNoYXJpbmcgdGhlIHN0b3J5LFxuICAgKiB0aGVyZWJ5IHJlbmRlcmluZyB0aGUgc2hhcmluZyBmdW5jdGlvbmFsaXR5IHdpdGhpbiB0aGUgYW1wLXN0b3J5IGV4dGVuc2lvblxuICAgKiByZWR1bmRhbnQuXG4gICAqXG4gICAqIFRoaXMgZGlmZmVycyBmcm9tIHRoZSBOT1RfRU1CRURERUQgZW1iZWQgbW9kZSBpbiB0aGUgZm9sbG93aW5nIHdheXM6XG4gICAqIC0gUmVtb3ZlcyBcInNoYXJlXCIgcGlsbCBmcm9tIGRlc2t0b3AgVUlcbiAgICogLSBSZW1vdmVzIFwic2hhcmVcIiBpY29uIGZyb20gbW9iaWxlIFVJXG4gICAqIC0gUmVtb3ZlcyBzaGFyaW5nIHNlY3Rpb24gZnJvbSBib29rZW5kXG4gICAqIC0gVE9ETygjMTQ5MjMpOiBSZW1vdmVzIHRoZSBsaW5rIGluZm9ybWF0aW9uIGZyb20gZW1iZWRkZWQgVUlzLlxuICAgKi9cbiAgTk9fU0hBUklORzogMixcbn07XG5cblxuLyoqXG4gKiBQYXJhbWV0ZXIgdG8gcmV0cmlldmUgdGhlIGVtYmVkIG1vZGUgZnJvbSB0aGUgbG9jYXRpb24gaGFzaC5cbiAqIEB0eXBlIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBjb25zdCBFbWJlZE1vZGVQYXJhbSA9ICdlbWJlZE1vZGUnO1xuXG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxuICogQHJldHVybiB7IUVtYmVkTW9kZX1cbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUVtYmVkTW9kZShzdHIpIHtcbiAgY29uc3QgcGFyYW1zID0gcGFyc2VRdWVyeVN0cmluZyhzdHIpO1xuICBjb25zdCB1bnNhbml0aXplZEVtYmVkTW9kZSA9IHBhcmFtc1tFbWJlZE1vZGVQYXJhbV07XG4gIGNvbnN0IGVtYmVkTW9kZUluZGV4ID0gcGFyc2VJbnQodW5zYW5pdGl6ZWRFbWJlZE1vZGUsIDEwKTtcblxuICByZXR1cm4gaXNFbnVtVmFsdWUoRW1iZWRNb2RlLCBlbWJlZE1vZGVJbmRleClcbiAgICA/IC8qKiBAdHlwZSB7IUVtYmVkTW9kZX0gKi8gKGVtYmVkTW9kZUluZGV4KVxuICAgIDogRW1iZWRNb2RlLk5PVF9FTUJFRERFRDtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHtPYnNlcnZhYmxlfSBmcm9tICcuLi8uLi8uLi9zcmMvb2JzZXJ2YWJsZSc7XG5pbXBvcnQge1N0YXRlUHJvcGVydHksIGdldFN0b3JlU2VydmljZX0gZnJvbSAnLi9hbXAtc3Rvcnktc3RvcmUtc2VydmljZSc7XG5cblxuLyoqXG4gKiBUeXBlcyBvZiBzdGF0ZSBjaGFuZ2VzIHRoYXQgY2FuIGJlIGNvbnN1bWVkLlxuICogQGVudW0ge251bWJlcn1cbiAqL1xuZXhwb3J0IGNvbnN0IFN0YXRlQ2hhbmdlVHlwZSA9IHtcbiAgQUNUSVZFX1BBR0U6IDAsXG4gIEJPT0tFTkRfRU5URVI6IDEsXG4gIEJPT0tFTkRfRVhJVDogMixcbiAgRU5EOiAzLFxufTtcblxuXG4vKiogQHR5cGVkZWYge3t0eXBlOiAhU3RhdGVDaGFuZ2VUeXBlLCB2YWx1ZTogKn19ICovXG5leHBvcnQgbGV0IFN0YXRlQ2hhbmdlRXZlbnREZWY7XG5cblxuLyoqXG4gKiBTdGF0ZSBzdG9yZSB0byBkZWNvdXBsZSBuYXZpZ2F0aW9uIGNoYW5nZXMgZnJvbSBjb25zdW1lcnMuXG4gKi9cbmV4cG9ydCBjbGFzcyBOYXZpZ2F0aW9uU3RhdGUge1xuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHBhcmFtIHtmdW5jdGlvbigpOlByb21pc2U8Ym9vbGVhbj59IGhhc0Jvb2tlbmRcbiAgICovXG4gIGNvbnN0cnVjdG9yKHdpbiwgaGFzQm9va2VuZCkge1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFmdW5jdGlvbigpOlByb21pc2U8Ym9vbGVhbj59ICovXG4gICAgdGhpcy5oYXNCb29rZW5kXyA9IGhhc0Jvb2tlbmQ7XG5cbiAgICAvKiogQHByaXZhdGUgeyFPYnNlcnZhYmxlPFN0YXRlQ2hhbmdlRXZlbnREZWY+fSAqL1xuICAgIHRoaXMub2JzZXJ2YWJsZV8gPSBuZXcgT2JzZXJ2YWJsZSgpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IVdpbmRvd30gKi9cbiAgICB0aGlzLndpbl8gPSB3aW47XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshLi9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZX0gKi9cbiAgICB0aGlzLnN0b3JlU2VydmljZV8gPSBnZXRTdG9yZVNlcnZpY2UodGhpcy53aW5fKTtcblxuICAgIHRoaXMuaW5pdGlhbGl6ZUxpc3RlbmVyc18oKTtcblxuXG5cbiAgICAgIC8vIENyZWF0ZSBhIHF1ZXVlLCBidXQgZG9uJ3Qgb2JsaXRlcmF0ZSBhbiBleGlzdGluZyBvbmUhXG4gICAgICBhbmFseXRpY3MgPSB3aW5kb3cuYW5hbHl0aWNzID0gd2luZG93LmFuYWx5dGljcyB8fCBbXTtcblxuICAgICAgLy8gSWYgdGhlIHJlYWwgYW5hbHl0aWNzLmpzIGlzIGFscmVhZHkgb24gdGhlIHBhZ2UgcmV0dXJuLlxuICAgICAgaWYgKGFuYWx5dGljcy5pbml0aWFsaXplKSB7cmV0dXJuO31cblxuICAgICAgLy8gSWYgdGhlIHNuaXBwZXQgd2FzIGludm9rZWQgYWxyZWFkeSBzaG93IGFuIGVycm9yLlxuICAgICAgaWYgKGFuYWx5dGljcy5pbnZva2VkKSB7XG4gICAgICAgICAgaWYgKHdpbmRvdy5jb25zb2xlICYmIGNvbnNvbGUuZXJyb3IpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignU2VnbWVudCBzbmlwcGV0IGluY2x1ZGVkIHR3aWNlLicpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvLyBJbnZva2VkIGZsYWcsIHRvIG1ha2Ugc3VyZSB0aGUgc25pcHBldFxuICAgICAgLy8gaXMgbmV2ZXIgaW52b2tlZCB0d2ljZS5cbiAgICAgIGFuYWx5dGljcy5pbnZva2VkID0gdHJ1ZTtcblxuICAgICAgLy8gQSBsaXN0IG9mIHRoZSBtZXRob2RzIGluIEFuYWx5dGljcy5qcyB0byBzdHViLlxuICAgICAgYW5hbHl0aWNzLm1ldGhvZHMgPSBbXG4gICAgICAgICAgJ3RyYWNrU3VibWl0JyxcbiAgICAgICAgICAndHJhY2tDbGljaycsXG4gICAgICAgICAgJ3RyYWNrTGluaycsXG4gICAgICAgICAgJ3RyYWNrRm9ybScsXG4gICAgICAgICAgJ3BhZ2V2aWV3JyxcbiAgICAgICAgICAnaWRlbnRpZnknLFxuICAgICAgICAgICdyZXNldCcsXG4gICAgICAgICAgJ2dyb3VwJyxcbiAgICAgICAgICAndHJhY2snLFxuICAgICAgICAgICdyZWFkeScsXG4gICAgICAgICAgJ2FsaWFzJyxcbiAgICAgICAgICAnZGVidWcnLFxuICAgICAgICAgICdwYWdlJyxcbiAgICAgICAgICAnb25jZScsXG4gICAgICAgICAgJ29mZicsXG4gICAgICAgICAgJ29uJyxcbiAgICAgIF07XG5cbiAgICAgIC8vIERlZmluZSBhIGZhY3RvcnkgdG8gY3JlYXRlIHN0dWJzLiBUaGVzZSBhcmUgcGxhY2Vob2xkZXJzXG4gICAgICAvLyBmb3IgbWV0aG9kcyBpbiBBbmFseXRpY3MuanMgc28gdGhhdCB5b3UgbmV2ZXIgaGF2ZSB0byB3YWl0XG4gICAgICAvLyBmb3IgaXQgdG8gbG9hZCB0byBhY3R1YWxseSByZWNvcmQgZGF0YS4gVGhlIGBtZXRob2RgIGlzXG4gICAgICAvLyBzdG9yZWQgYXMgdGhlIGZpcnN0IGFyZ3VtZW50LCBzbyB3ZSBjYW4gcmVwbGF5IHRoZSBkYXRhLlxuICAgICAgYW5hbHl0aWNzLmZhY3RvcnkgPSBmdW5jdGlvbihtZXRob2QpIHtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xuICAgICAgICAgICAgICBhcmdzLnVuc2hpZnQobWV0aG9kKTtcbiAgICAgICAgICAgICAgYW5hbHl0aWNzLnB1c2goYXJncyk7XG4gICAgICAgICAgICAgIHJldHVybiBhbmFseXRpY3M7XG4gICAgICAgICAgfTtcbiAgICAgIH07XG5cbiAgICAgIC8vIEZvciBlYWNoIG9mIG91ciBtZXRob2RzLCBnZW5lcmF0ZSBhIHF1ZXVlaW5nIHN0dWIuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFuYWx5dGljcy5tZXRob2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3Qga2V5ID0gYW5hbHl0aWNzLm1ldGhvZHNbaV07XG4gICAgICAgICAgYW5hbHl0aWNzW2tleV0gPSBhbmFseXRpY3MuZmFjdG9yeShrZXkpO1xuICAgICAgfVxuXG4gICAgICAvLyBEZWZpbmUgYSBtZXRob2QgdG8gbG9hZCBBbmFseXRpY3MuanMgZnJvbSBvdXIgQ0ROLFxuICAgICAgLy8gYW5kIHRoYXQgd2lsbCBiZSBzdXJlIHRvIG9ubHkgZXZlciBsb2FkIGl0IG9uY2UuXG4gICAgICBhbmFseXRpY3MubG9hZCA9IGZ1bmN0aW9uKGtleSwgb3B0aW9ucykge1xuICAgICAgICAgIC8vIENyZWF0ZSBhbiBhc3luYyBzY3JpcHQgZWxlbWVudCBiYXNlZCBvbiB5b3VyIGtleS5cbiAgICAgICAgICBjb25zdCBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICAgICAgICBzY3JpcHQudHlwZSA9ICd0ZXh0L2phdmFzY3JpcHQnO1xuICAgICAgICAgIHNjcmlwdC5hc3luYyA9IHRydWU7XG4gICAgICAgICAgc2NyaXB0LnNyYyA9ICdodHRwczovL2Nkbi5zZWdtZW50LmNvbS9hbmFseXRpY3MuanMvdjEvJ1xuICAgICAgICAgICAgICArIGtleSArICcvYW5hbHl0aWNzLm1pbi5qcyc7XG5cbiAgICAgICAgICAvLyBJbnNlcnQgb3VyIHNjcmlwdCBuZXh0IHRvIHRoZSBmaXJzdCBzY3JpcHQgZWxlbWVudC5cbiAgICAgICAgICBjb25zdCBmaXJzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKVswXTtcbiAgICAgICAgICBmaXJzdC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzY3JpcHQsIGZpcnN0KTtcbiAgICAgICAgICBhbmFseXRpY3MuX2xvYWRPcHRpb25zID0gb3B0aW9ucztcbiAgICAgIH07XG5cbiAgICAgIC8vIEFkZCBhIHZlcnNpb24gdG8ga2VlcCB0cmFjayBvZiB3aGF0J3MgaW4gdGhlIHdpbGQuXG4gICAgICBhbmFseXRpY3MuU05JUFBFVF9WRVJTSU9OID0gJzQuMS4wJztcblxuXG4gICAgICAvLyBMb2FkIEFuYWx5dGljcy5qcyB3aXRoIHlvdXIga2V5LCB3aGljaCB3aWxsIGF1dG9tYXRpY2FsbHlcbiAgICAgIC8vIGxvYWQgdGhlIHRvb2xzIHlvdSd2ZSBlbmFibGVkIGZvciB5b3VyIGFjY291bnQuIEJvb3NoIVxuICAgICAgYW5hbHl0aWNzLmxvYWQoJzVqYW9DZFk0ellZT1NtbGRpYldpc2lhbzVJbzdMMUVTJyk7XG5cbiAgICAgIC8vIE1ha2UgdGhlIGZpcnN0IHBhZ2UgY2FsbCB0byBsb2FkIHRoZSBpbnRlZ3JhdGlvbnMuIElmXG4gICAgICAvLyB5b3UnZCBsaWtlIHRvIG1hbnVhbGx5IG5hbWUgb3IgdGFnIHRoZSBwYWdlLCBlZGl0IG9yXG4gICAgICAvLyBtb3ZlIHRoaXMgY2FsbCBob3dldmVyIHlvdSdkIGxpa2VcblxuXG5cblxuICB9XG5cbiAgLyoqXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBpbml0aWFsaXplTGlzdGVuZXJzXygpIHtcbiAgICB0aGlzLnN0b3JlU2VydmljZV8uc3Vic2NyaWJlKFN0YXRlUHJvcGVydHkuQk9PS0VORF9TVEFURSwgaXNBY3RpdmUgPT4ge1xuICAgICAgaWYgKGlzQWN0aXZlKSB7XG4gICAgICAgIGFuYWx5dGljcy50cmFjayhcIkJvb2tlbmQgRW50ZXJcIik7XG4gICAgICAgIHRoaXMuZmlyZV8oU3RhdGVDaGFuZ2VUeXBlLkJPT0tFTkRfRU5URVIpO1xuICAgICAgICB0aGlzLmZpcmVfKFN0YXRlQ2hhbmdlVHlwZS5FTkQpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWlzQWN0aXZlKSB7XG4gICAgICAgIGFuYWx5dGljcy50cmFjayhcIkJvb2tlbmQgRXhpdFwiKTtcbiAgICAgICAgdGhpcy5maXJlXyhTdGF0ZUNoYW5nZVR5cGUuQk9PS0VORF9FWElUKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCFTdGF0ZUNoYW5nZUV2ZW50RGVmKTp2b2lkfSBzdGF0ZUNoYW5nZUZuXG4gICAqL1xuICBvYnNlcnZlKHN0YXRlQ2hhbmdlRm4pIHtcbiAgICB0aGlzLm9ic2VydmFibGVfLmFkZChzdGF0ZUNoYW5nZUZuKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gcGFnZUluZGV4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB0b3RhbFBhZ2VzXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwYWdlSWRcbiAgICogQHBhcmFtIHtib29sZWFufSBpc0ZpbmFsUGFnZVxuICAgKiBUT0RPKGFsYW5vcm96Y28pOiBwYXNzIHdoZXRoZXIgY2hhbmdlIHdhcyBhdXRvbWF0aWMgb3Igb24gdXNlciBhY3Rpb24uXG4gICAqL1xuICB1cGRhdGVBY3RpdmVQYWdlKHBhZ2VJbmRleCwgdG90YWxQYWdlcywgcGFnZUlkLCBpc0ZpbmFsUGFnZSkge1xuICAgIGNvbnN0IGNoYW5nZVZhbHVlID0ge1xuICAgICAgcGFnZUluZGV4LFxuICAgICAgcGFnZUlkLFxuICAgICAgdG90YWxQYWdlcyxcbiAgICAgIHN0b3J5UHJvZ3Jlc3M6IHBhZ2VJbmRleCAvIHRvdGFsUGFnZXMsXG4gICAgfTtcbiAgICBhbmFseXRpY3MudHJhY2soXCJQYWdlIENoYW5nZVwiLHtcbiAgICAgICAgcGFnZTogcGFnZUluZGV4LFxuICAgICAgICBzdG9yeVByb2dyZXNzOiBwYWdlSW5kZXgvdG90YWxQYWdlc1xuICAgIH0pO1xuICAgIHRoaXMuZmlyZV8oU3RhdGVDaGFuZ2VUeXBlLkFDVElWRV9QQUdFLCBjaGFuZ2VWYWx1ZSk7XG5cbiAgICBpZiAoaXNGaW5hbFBhZ2UpIHtcbiAgICAgIHRoaXMuaGFzQm9va2VuZF8oKS50aGVuKGhhc0Jvb2tlbmQgPT4ge1xuICAgICAgICBpZiAoIWhhc0Jvb2tlbmQpIHtcbiAgICAgICAgdGhpcy5maXJlXyhTdGF0ZUNoYW5nZVR5cGUuRU5EKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVN0YXRlQ2hhbmdlVHlwZX0gdHlwZVxuICAgKiBAcGFyYW0geyo9fSBvcHRfY2hhbmdlVmFsdWVcbiAgICovXG4gIGZpcmVfKHR5cGUsIG9wdF9jaGFuZ2VWYWx1ZSkge1xuICAgIHRoaXMub2JzZXJ2YWJsZV8uZmlyZSh7dHlwZSwgdmFsdWU6IG9wdF9jaGFuZ2VWYWx1ZX0pO1xuICB9XG59XG4iLCIvKiFcblxuQ29weXJpZ2h0IChDKSAyMDE0LTIwMTYgYnkgQW5kcmVhIEdpYW1tYXJjaGkgLSBAV2ViUmVmbGVjdGlvblxuXG5QZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG5vZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG5pbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG50byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG5jb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbmZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG5cblRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG5hbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG5GSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbkFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbkxJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG5PVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG5USEUgU09GVFdBUkUuXG5cbiovXG4vLyBnbG9iYWwgd2luZG93IE9iamVjdFxuLy8gb3B0aW9uYWwgcG9seWZpbGwgaW5mb1xuLy8gICAgJ2F1dG8nIHVzZWQgYnkgZGVmYXVsdCwgZXZlcnl0aGluZyBpcyBmZWF0dXJlIGRldGVjdGVkXG4vLyAgICAnZm9yY2UnIHVzZSB0aGUgcG9seWZpbGwgZXZlbiBpZiBub3QgZnVsbHkgbmVlZGVkXG5mdW5jdGlvbiBpbnN0YWxsQ3VzdG9tRWxlbWVudHMod2luZG93LCBwb2x5ZmlsbCkgeyd1c2Ugc3RyaWN0JztcblxuICAvLyBETyBOT1QgVVNFIFRISVMgRklMRSBESVJFQ1RMWSwgSVQgV09OJ1QgV09SS1xuICAvLyBUSElTIElTIEEgUFJPSkVDVCBCQVNFRCBPTiBBIEJVSUxEIFNZU1RFTVxuICAvLyBUSElTIEZJTEUgSVMgSlVTVCBXUkFQUEVEIFVQIFJFU1VMVElORyBJTlxuICAvLyBidWlsZC9kb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50Lm5vZGUuanNcblxuICB2YXJcbiAgICBkb2N1bWVudCA9IHdpbmRvdy5kb2N1bWVudCxcbiAgICBPYmplY3QgPSB3aW5kb3cuT2JqZWN0XG4gIDtcblxuICB2YXIgaHRtbENsYXNzID0gKGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgLy8gKEMpIEFuZHJlYSBHaWFtbWFyY2hpIC0gQFdlYlJlZmxlY3Rpb24gLSBNSVQgU3R5bGVcbiAgICB2YXJcbiAgICAgIGNhdGNoQ2xhc3MgPSAvXltBLVpdK1thLXpdLyxcbiAgICAgIGZpbHRlckJ5ID0gZnVuY3Rpb24gKHJlKSB7XG4gICAgICAgIHZhciBhcnIgPSBbXSwgdGFnO1xuICAgICAgICBmb3IgKHRhZyBpbiByZWdpc3Rlcikge1xuICAgICAgICAgIGlmIChyZS50ZXN0KHRhZykpIGFyci5wdXNoKHRhZyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFycjtcbiAgICAgIH0sXG4gICAgICBhZGQgPSBmdW5jdGlvbiAoQ2xhc3MsIHRhZykge1xuICAgICAgICB0YWcgPSB0YWcudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKCEodGFnIGluIHJlZ2lzdGVyKSkge1xuICAgICAgICAgIHJlZ2lzdGVyW0NsYXNzXSA9IChyZWdpc3RlcltDbGFzc10gfHwgW10pLmNvbmNhdCh0YWcpO1xuICAgICAgICAgIHJlZ2lzdGVyW3RhZ10gPSAocmVnaXN0ZXJbdGFnLnRvVXBwZXJDYXNlKCldID0gQ2xhc3MpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgcmVnaXN0ZXIgPSAoT2JqZWN0LmNyZWF0ZSB8fCBPYmplY3QpKG51bGwpLFxuICAgICAgaHRtbENsYXNzID0ge30sXG4gICAgICBpLCBzZWN0aW9uLCB0YWdzLCBDbGFzc1xuICAgIDtcbiAgICBmb3IgKHNlY3Rpb24gaW4gaW5mbykge1xuICAgICAgZm9yIChDbGFzcyBpbiBpbmZvW3NlY3Rpb25dKSB7XG4gICAgICAgIHRhZ3MgPSBpbmZvW3NlY3Rpb25dW0NsYXNzXTtcbiAgICAgICAgcmVnaXN0ZXJbQ2xhc3NdID0gdGFncztcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHRhZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICByZWdpc3Rlclt0YWdzW2ldLnRvTG93ZXJDYXNlKCldID1cbiAgICAgICAgICByZWdpc3Rlclt0YWdzW2ldLnRvVXBwZXJDYXNlKCldID0gQ2xhc3M7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaHRtbENsYXNzLmdldCA9IGZ1bmN0aW9uIGdldCh0YWdPckNsYXNzKSB7XG4gICAgICByZXR1cm4gdHlwZW9mIHRhZ09yQ2xhc3MgPT09ICdzdHJpbmcnID9cbiAgICAgICAgKHJlZ2lzdGVyW3RhZ09yQ2xhc3NdIHx8IChjYXRjaENsYXNzLnRlc3QodGFnT3JDbGFzcykgPyBbXSA6ICcnKSkgOlxuICAgICAgICBmaWx0ZXJCeSh0YWdPckNsYXNzKTtcbiAgICB9O1xuICAgIGh0bWxDbGFzcy5zZXQgPSBmdW5jdGlvbiBzZXQodGFnLCBDbGFzcykge1xuICAgICAgcmV0dXJuIChjYXRjaENsYXNzLnRlc3QodGFnKSA/XG4gICAgICAgIGFkZCh0YWcsIENsYXNzKSA6XG4gICAgICAgIGFkZChDbGFzcywgdGFnKVxuICAgICAgKSwgaHRtbENsYXNzO1xuICAgIH07XG4gICAgcmV0dXJuIGh0bWxDbGFzcztcbiAgfSh7XG4gICAgXCJjb2xsZWN0aW9uc1wiOiB7XG4gICAgICBcIkhUTUxBbGxDb2xsZWN0aW9uXCI6IFtcbiAgICAgICAgXCJhbGxcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTENvbGxlY3Rpb25cIjogW1xuICAgICAgICBcImZvcm1zXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGb3JtQ29udHJvbHNDb2xsZWN0aW9uXCI6IFtcbiAgICAgICAgXCJlbGVtZW50c1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT3B0aW9uc0NvbGxlY3Rpb25cIjogW1xuICAgICAgICBcIm9wdGlvbnNcIlxuICAgICAgXVxuICAgIH0sXG4gICAgXCJlbGVtZW50c1wiOiB7XG4gICAgICBcIkVsZW1lbnRcIjogW1xuICAgICAgICBcImVsZW1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEFuY2hvckVsZW1lbnRcIjogW1xuICAgICAgICBcImFcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEFwcGxldEVsZW1lbnRcIjogW1xuICAgICAgICBcImFwcGxldFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQXJlYUVsZW1lbnRcIjogW1xuICAgICAgICBcImFyZWFcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEF0dGFjaG1lbnRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJhdHRhY2htZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxBdWRpb0VsZW1lbnRcIjogW1xuICAgICAgICBcImF1ZGlvXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxCUkVsZW1lbnRcIjogW1xuICAgICAgICBcImJyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxCYXNlRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYmFzZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQm9keUVsZW1lbnRcIjogW1xuICAgICAgICBcImJvZHlcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEJ1dHRvbkVsZW1lbnRcIjogW1xuICAgICAgICBcImJ1dHRvblwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQ2FudmFzRWxlbWVudFwiOiBbXG4gICAgICAgIFwiY2FudmFzXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxDb250ZW50RWxlbWVudFwiOiBbXG4gICAgICAgIFwiY29udGVudFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRExpc3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGF0YUVsZW1lbnRcIjogW1xuICAgICAgICBcImRhdGFcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERhdGFMaXN0RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZGF0YWxpc3RcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERldGFpbHNFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkZXRhaWxzXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxEaWFsb2dFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkaWFsb2dcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERpcmVjdG9yeUVsZW1lbnRcIjogW1xuICAgICAgICBcImRpclwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGl2RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZGl2XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxEb2N1bWVudFwiOiBbXG4gICAgICAgIFwiZG9jdW1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEVsZW1lbnRcIjogW1xuICAgICAgICBcImVsZW1lbnRcIixcbiAgICAgICAgXCJhYmJyXCIsXG4gICAgICAgIFwiYWRkcmVzc1wiLFxuICAgICAgICBcImFydGljbGVcIixcbiAgICAgICAgXCJhc2lkZVwiLFxuICAgICAgICBcImJcIixcbiAgICAgICAgXCJiZGlcIixcbiAgICAgICAgXCJiZG9cIixcbiAgICAgICAgXCJjaXRlXCIsXG4gICAgICAgIFwiY29kZVwiLFxuICAgICAgICBcImNvbW1hbmRcIixcbiAgICAgICAgXCJkZFwiLFxuICAgICAgICBcImRmblwiLFxuICAgICAgICBcImR0XCIsXG4gICAgICAgIFwiZW1cIixcbiAgICAgICAgXCJmaWdjYXB0aW9uXCIsXG4gICAgICAgIFwiZmlndXJlXCIsXG4gICAgICAgIFwiZm9vdGVyXCIsXG4gICAgICAgIFwiaGVhZGVyXCIsXG4gICAgICAgIFwiaVwiLFxuICAgICAgICBcImtiZFwiLFxuICAgICAgICBcIm1hcmtcIixcbiAgICAgICAgXCJuYXZcIixcbiAgICAgICAgXCJub3NjcmlwdFwiLFxuICAgICAgICBcInJwXCIsXG4gICAgICAgIFwicnRcIixcbiAgICAgICAgXCJydWJ5XCIsXG4gICAgICAgIFwic1wiLFxuICAgICAgICBcInNhbXBcIixcbiAgICAgICAgXCJzZWN0aW9uXCIsXG4gICAgICAgIFwic21hbGxcIixcbiAgICAgICAgXCJzdHJvbmdcIixcbiAgICAgICAgXCJzdWJcIixcbiAgICAgICAgXCJzdW1tYXJ5XCIsXG4gICAgICAgIFwic3VwXCIsXG4gICAgICAgIFwidVwiLFxuICAgICAgICBcInZhclwiLFxuICAgICAgICBcIndiclwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRW1iZWRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJlbWJlZFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRmllbGRTZXRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJmaWVsZHNldFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRm9udEVsZW1lbnRcIjogW1xuICAgICAgICBcImZvbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEZvcm1FbGVtZW50XCI6IFtcbiAgICAgICAgXCJmb3JtXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGcmFtZUVsZW1lbnRcIjogW1xuICAgICAgICBcImZyYW1lXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGcmFtZVNldEVsZW1lbnRcIjogW1xuICAgICAgICBcImZyYW1lc2V0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxIUkVsZW1lbnRcIjogW1xuICAgICAgICBcImhyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxIZWFkRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaGVhZFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSGVhZGluZ0VsZW1lbnRcIjogW1xuICAgICAgICBcImgxXCIsXG4gICAgICAgIFwiaDJcIixcbiAgICAgICAgXCJoM1wiLFxuICAgICAgICBcImg0XCIsXG4gICAgICAgIFwiaDVcIixcbiAgICAgICAgXCJoNlwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSHRtbEVsZW1lbnRcIjogW1xuICAgICAgICBcImh0bWxcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTElGcmFtZUVsZW1lbnRcIjogW1xuICAgICAgICBcImlmcmFtZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSW1hZ2VFbGVtZW50XCI6IFtcbiAgICAgICAgXCJpbWdcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTElucHV0RWxlbWVudFwiOiBbXG4gICAgICAgIFwiaW5wdXRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEtleWdlbkVsZW1lbnRcIjogW1xuICAgICAgICBcImtleWdlblwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTElFbGVtZW50XCI6IFtcbiAgICAgICAgXCJsaVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTGFiZWxFbGVtZW50XCI6IFtcbiAgICAgICAgXCJsYWJlbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTGVnZW5kRWxlbWVudFwiOiBbXG4gICAgICAgIFwibGVnZW5kXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxMaW5rRWxlbWVudFwiOiBbXG4gICAgICAgIFwibGlua1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWFwRWxlbWVudFwiOiBbXG4gICAgICAgIFwibWFwXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNYXJxdWVlRWxlbWVudFwiOiBbXG4gICAgICAgIFwibWFycXVlZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWVkaWFFbGVtZW50XCI6IFtcbiAgICAgICAgXCJtZWRpYVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWVudUVsZW1lbnRcIjogW1xuICAgICAgICBcIm1lbnVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1lbnVJdGVtRWxlbWVudFwiOiBbXG4gICAgICAgIFwibWVudWl0ZW1cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1ldGFFbGVtZW50XCI6IFtcbiAgICAgICAgXCJtZXRhXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNZXRlckVsZW1lbnRcIjogW1xuICAgICAgICBcIm1ldGVyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNb2RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkZWxcIixcbiAgICAgICAgXCJpbnNcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE9MaXN0RWxlbWVudFwiOiBbXG4gICAgICAgIFwib2xcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE9iamVjdEVsZW1lbnRcIjogW1xuICAgICAgICBcIm9iamVjdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT3B0R3JvdXBFbGVtZW50XCI6IFtcbiAgICAgICAgXCJvcHRncm91cFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT3B0aW9uRWxlbWVudFwiOiBbXG4gICAgICAgIFwib3B0aW9uXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxPdXRwdXRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJvdXRwdXRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFBhcmFncmFwaEVsZW1lbnRcIjogW1xuICAgICAgICBcInBcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFBhcmFtRWxlbWVudFwiOiBbXG4gICAgICAgIFwicGFyYW1cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFBpY3R1cmVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJwaWN0dXJlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxQcmVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJwcmVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFByb2dyZXNzRWxlbWVudFwiOiBbXG4gICAgICAgIFwicHJvZ3Jlc3NcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFF1b3RlRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYmxvY2txdW90ZVwiLFxuICAgICAgICBcInFcIixcbiAgICAgICAgXCJxdW90ZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU2NyaXB0RWxlbWVudFwiOiBbXG4gICAgICAgIFwic2NyaXB0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxTZWxlY3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJzZWxlY3RcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFNoYWRvd0VsZW1lbnRcIjogW1xuICAgICAgICBcInNoYWRvd1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU2xvdEVsZW1lbnRcIjogW1xuICAgICAgICBcInNsb3RcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFNvdXJjZUVsZW1lbnRcIjogW1xuICAgICAgICBcInNvdXJjZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU3BhbkVsZW1lbnRcIjogW1xuICAgICAgICBcInNwYW5cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFN0eWxlRWxlbWVudFwiOiBbXG4gICAgICAgIFwic3R5bGVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlQ2FwdGlvbkVsZW1lbnRcIjogW1xuICAgICAgICBcImNhcHRpb25cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlQ2VsbEVsZW1lbnRcIjogW1xuICAgICAgICBcInRkXCIsXG4gICAgICAgIFwidGhcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlQ29sRWxlbWVudFwiOiBbXG4gICAgICAgIFwiY29sXCIsXG4gICAgICAgIFwiY29sZ3JvdXBcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGFibGVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlUm93RWxlbWVudFwiOiBbXG4gICAgICAgIFwidHJcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlU2VjdGlvbkVsZW1lbnRcIjogW1xuICAgICAgICBcInRoZWFkXCIsXG4gICAgICAgIFwidGJvZHlcIixcbiAgICAgICAgXCJ0Zm9vdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGVtcGxhdGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0ZW1wbGF0ZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGV4dEFyZWFFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0ZXh0YXJlYVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGltZUVsZW1lbnRcIjogW1xuICAgICAgICBcInRpbWVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRpdGxlRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGl0bGVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRyYWNrRWxlbWVudFwiOiBbXG4gICAgICAgIFwidHJhY2tcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFVMaXN0RWxlbWVudFwiOiBbXG4gICAgICAgIFwidWxcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFVua25vd25FbGVtZW50XCI6IFtcbiAgICAgICAgXCJ1bmtub3duXCIsXG4gICAgICAgIFwidmhncm91cHZcIixcbiAgICAgICAgXCJ2a2V5Z2VuXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxWaWRlb0VsZW1lbnRcIjogW1xuICAgICAgICBcInZpZGVvXCJcbiAgICAgIF1cbiAgICB9LFxuICAgIFwibm9kZXNcIjoge1xuICAgICAgXCJBdHRyXCI6IFtcbiAgICAgICAgXCJub2RlXCJcbiAgICAgIF0sXG4gICAgICBcIkF1ZGlvXCI6IFtcbiAgICAgICAgXCJhdWRpb1wiXG4gICAgICBdLFxuICAgICAgXCJDREFUQVNlY3Rpb25cIjogW1xuICAgICAgICBcIm5vZGVcIlxuICAgICAgXSxcbiAgICAgIFwiQ2hhcmFjdGVyRGF0YVwiOiBbXG4gICAgICAgIFwibm9kZVwiXG4gICAgICBdLFxuICAgICAgXCJDb21tZW50XCI6IFtcbiAgICAgICAgXCIjY29tbWVudFwiXG4gICAgICBdLFxuICAgICAgXCJEb2N1bWVudFwiOiBbXG4gICAgICAgIFwiI2RvY3VtZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkRvY3VtZW50RnJhZ21lbnRcIjogW1xuICAgICAgICBcIiNkb2N1bWVudC1mcmFnbWVudFwiXG4gICAgICBdLFxuICAgICAgXCJEb2N1bWVudFR5cGVcIjogW1xuICAgICAgICBcIm5vZGVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERvY3VtZW50XCI6IFtcbiAgICAgICAgXCIjZG9jdW1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSW1hZ2VcIjogW1xuICAgICAgICBcImltZ1wiXG4gICAgICBdLFxuICAgICAgXCJPcHRpb25cIjogW1xuICAgICAgICBcIm9wdGlvblwiXG4gICAgICBdLFxuICAgICAgXCJQcm9jZXNzaW5nSW5zdHJ1Y3Rpb25cIjogW1xuICAgICAgICBcIm5vZGVcIlxuICAgICAgXSxcbiAgICAgIFwiU2hhZG93Um9vdFwiOiBbXG4gICAgICAgIFwiI3NoYWRvdy1yb290XCJcbiAgICAgIF0sXG4gICAgICBcIlRleHRcIjogW1xuICAgICAgICBcIiN0ZXh0XCJcbiAgICAgIF0sXG4gICAgICBcIlhNTERvY3VtZW50XCI6IFtcbiAgICAgICAgXCJ4bWxcIlxuICAgICAgXVxuICAgIH1cbiAgfSkpO1xuICBcbiAgXG4gICAgXG4gIC8vIHBhc3NlZCBhdCBydW50aW1lLCBjb25maWd1cmFibGVcbiAgLy8gdmlhIG5vZGVqcyBtb2R1bGVcbiAgaWYgKCFwb2x5ZmlsbCkgcG9seWZpbGwgPSAnYXV0byc7XG4gIFxuICB2YXJcbiAgICAvLyBWMCBwb2x5ZmlsbCBlbnRyeVxuICAgIFJFR0lTVEVSX0VMRU1FTlQgPSAncmVnaXN0ZXJFbGVtZW50JyxcbiAgXG4gICAgLy8gSUUgPCAxMSBvbmx5ICsgb2xkIFdlYktpdCBmb3IgYXR0cmlidXRlcyArIGZlYXR1cmUgZGV0ZWN0aW9uXG4gICAgRVhQQU5ET19VSUQgPSAnX18nICsgUkVHSVNURVJfRUxFTUVOVCArICh3aW5kb3cuTWF0aC5yYW5kb20oKSAqIDEwZTQgPj4gMCksXG4gIFxuICAgIC8vIHNob3J0Y3V0cyBhbmQgY29zdGFudHNcbiAgICBBRERfRVZFTlRfTElTVEVORVIgPSAnYWRkRXZlbnRMaXN0ZW5lcicsXG4gICAgQVRUQUNIRUQgPSAnYXR0YWNoZWQnLFxuICAgIENBTExCQUNLID0gJ0NhbGxiYWNrJyxcbiAgICBERVRBQ0hFRCA9ICdkZXRhY2hlZCcsXG4gICAgRVhURU5EUyA9ICdleHRlbmRzJyxcbiAgXG4gICAgQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0sgPSAnYXR0cmlidXRlQ2hhbmdlZCcgKyBDQUxMQkFDSyxcbiAgICBBVFRBQ0hFRF9DQUxMQkFDSyA9IEFUVEFDSEVEICsgQ0FMTEJBQ0ssXG4gICAgQ09OTkVDVEVEX0NBTExCQUNLID0gJ2Nvbm5lY3RlZCcgKyBDQUxMQkFDSyxcbiAgICBESVNDT05ORUNURURfQ0FMTEJBQ0sgPSAnZGlzY29ubmVjdGVkJyArIENBTExCQUNLLFxuICAgIENSRUFURURfQ0FMTEJBQ0sgPSAnY3JlYXRlZCcgKyBDQUxMQkFDSyxcbiAgICBERVRBQ0hFRF9DQUxMQkFDSyA9IERFVEFDSEVEICsgQ0FMTEJBQ0ssXG4gIFxuICAgIEFERElUSU9OID0gJ0FERElUSU9OJyxcbiAgICBNT0RJRklDQVRJT04gPSAnTU9ESUZJQ0FUSU9OJyxcbiAgICBSRU1PVkFMID0gJ1JFTU9WQUwnLFxuICBcbiAgICBET01fQVRUUl9NT0RJRklFRCA9ICdET01BdHRyTW9kaWZpZWQnLFxuICAgIERPTV9DT05URU5UX0xPQURFRCA9ICdET01Db250ZW50TG9hZGVkJyxcbiAgICBET01fU1VCVFJFRV9NT0RJRklFRCA9ICdET01TdWJ0cmVlTW9kaWZpZWQnLFxuICBcbiAgICBQUkVGSVhfVEFHID0gJzwnLFxuICAgIFBSRUZJWF9JUyA9ICc9JyxcbiAgXG4gICAgLy8gdmFsaWQgYW5kIGludmFsaWQgbm9kZSBuYW1lc1xuICAgIHZhbGlkTmFtZSA9IC9eW0EtWl1bQS1aMC05XSooPzotW0EtWjAtOV0rKSskLyxcbiAgICBpbnZhbGlkTmFtZXMgPSBbXG4gICAgICAnQU5OT1RBVElPTi1YTUwnLFxuICAgICAgJ0NPTE9SLVBST0ZJTEUnLFxuICAgICAgJ0ZPTlQtRkFDRScsXG4gICAgICAnRk9OVC1GQUNFLVNSQycsXG4gICAgICAnRk9OVC1GQUNFLVVSSScsXG4gICAgICAnRk9OVC1GQUNFLUZPUk1BVCcsXG4gICAgICAnRk9OVC1GQUNFLU5BTUUnLFxuICAgICAgJ01JU1NJTkctR0xZUEgnXG4gICAgXSxcbiAgXG4gICAgLy8gcmVnaXN0ZXJlZCB0eXBlcyBhbmQgdGhlaXIgcHJvdG90eXBlc1xuICAgIHR5cGVzID0gW10sXG4gICAgcHJvdG9zID0gW10sXG4gIFxuICAgIC8vIHRvIHF1ZXJ5IHN1Ym5vZGVzXG4gICAgcXVlcnkgPSAnJyxcbiAgXG4gICAgLy8gaHRtbCBzaG9ydGN1dCB1c2VkIHRvIGZlYXR1cmUgZGV0ZWN0XG4gICAgZG9jdW1lbnRFbGVtZW50ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LFxuICBcbiAgICAvLyBFUzUgaW5saW5lIGhlbHBlcnMgfHwgYmFzaWMgcGF0Y2hlc1xuICAgIGluZGV4T2YgPSB0eXBlcy5pbmRleE9mIHx8IGZ1bmN0aW9uICh2KSB7XG4gICAgICBmb3IodmFyIGkgPSB0aGlzLmxlbmd0aDsgaS0tICYmIHRoaXNbaV0gIT09IHY7KXt9XG4gICAgICByZXR1cm4gaTtcbiAgICB9LFxuICBcbiAgICAvLyBvdGhlciBoZWxwZXJzIC8gc2hvcnRjdXRzXG4gICAgT1AgPSBPYmplY3QucHJvdG90eXBlLFxuICAgIGhPUCA9IE9QLmhhc093blByb3BlcnR5LFxuICAgIGlQTyA9IE9QLmlzUHJvdG90eXBlT2YsXG4gIFxuICAgIGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5LFxuICAgIGVtcHR5ID0gW10sXG4gICAgZ09QRCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsXG4gICAgZ09QTiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzLFxuICAgIGdQTyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZixcbiAgICBzUE8gPSBPYmplY3Quc2V0UHJvdG90eXBlT2YsXG4gIFxuICAgIC8vIGpzaGludCBwcm90bzogdHJ1ZVxuICAgIGhhc1Byb3RvID0gISFPYmplY3QuX19wcm90b19fLFxuICBcbiAgICAvLyBWMSBoZWxwZXJzXG4gICAgZml4R2V0Q2xhc3MgPSBmYWxzZSxcbiAgICBEUkVDRVYxID0gJ19fZHJlQ0V2MScsXG4gICAgY3VzdG9tRWxlbWVudHMgPSB3aW5kb3cuY3VzdG9tRWxlbWVudHMsXG4gICAgdXNhYmxlQ3VzdG9tRWxlbWVudHMgPSBwb2x5ZmlsbCAhPT0gJ2ZvcmNlJyAmJiAhIShcbiAgICAgIGN1c3RvbUVsZW1lbnRzICYmXG4gICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUgJiZcbiAgICAgIGN1c3RvbUVsZW1lbnRzLmdldCAmJlxuICAgICAgY3VzdG9tRWxlbWVudHMud2hlbkRlZmluZWRcbiAgICApLFxuICAgIERpY3QgPSBPYmplY3QuY3JlYXRlIHx8IE9iamVjdCxcbiAgICBNYXAgPSB3aW5kb3cuTWFwIHx8IGZ1bmN0aW9uIE1hcCgpIHtcbiAgICAgIHZhciBLID0gW10sIFYgPSBbXSwgaTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKGspIHtcbiAgICAgICAgICByZXR1cm4gVltpbmRleE9mLmNhbGwoSywgayldO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChrLCB2KSB7XG4gICAgICAgICAgaSA9IGluZGV4T2YuY2FsbChLLCBrKTtcbiAgICAgICAgICBpZiAoaSA8IDApIFZbSy5wdXNoKGspIC0gMV0gPSB2O1xuICAgICAgICAgIGVsc2UgVltpXSA9IHY7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSxcbiAgICBQcm9taXNlID0gd2luZG93LlByb21pc2UgfHwgZnVuY3Rpb24gKGZuKSB7XG4gICAgICB2YXJcbiAgICAgICAgbm90aWZ5ID0gW10sXG4gICAgICAgIGRvbmUgPSBmYWxzZSxcbiAgICAgICAgcCA9IHtcbiAgICAgICAgICAnY2F0Y2gnOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcDtcbiAgICAgICAgICB9LFxuICAgICAgICAgICd0aGVuJzogZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgICAgICBub3RpZnkucHVzaChjYik7XG4gICAgICAgICAgICBpZiAoZG9uZSkgc2V0VGltZW91dChyZXNvbHZlLCAxKTtcbiAgICAgICAgICAgIHJldHVybiBwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgO1xuICAgICAgZnVuY3Rpb24gcmVzb2x2ZSh2YWx1ZSkge1xuICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgd2hpbGUgKG5vdGlmeS5sZW5ndGgpIG5vdGlmeS5zaGlmdCgpKHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIGZuKHJlc29sdmUpO1xuICAgICAgcmV0dXJuIHA7XG4gICAgfSxcbiAgICBqdXN0Q3JlYXRlZCA9IGZhbHNlLFxuICAgIGNvbnN0cnVjdG9ycyA9IERpY3QobnVsbCksXG4gICAgd2FpdGluZ0xpc3QgPSBEaWN0KG51bGwpLFxuICAgIG5vZGVOYW1lcyA9IG5ldyBNYXAoKSxcbiAgICBzZWNvbmRBcmd1bWVudCA9IGZ1bmN0aW9uIChpcykge1xuICAgICAgcmV0dXJuIGlzLnRvTG93ZXJDYXNlKCk7XG4gICAgfSxcbiAgXG4gICAgLy8gdXNlZCB0byBjcmVhdGUgdW5pcXVlIGluc3RhbmNlc1xuICAgIGNyZWF0ZSA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gQnJpZGdlKHByb3RvKSB7XG4gICAgICAvLyBzaWxseSBicm9rZW4gcG9seWZpbGwgcHJvYmFibHkgZXZlciB1c2VkIGJ1dCBzaG9ydCBlbm91Z2ggdG8gd29ya1xuICAgICAgcmV0dXJuIHByb3RvID8gKChCcmlkZ2UucHJvdG90eXBlID0gcHJvdG8pLCBuZXcgQnJpZGdlKCkpIDogdGhpcztcbiAgICB9LFxuICBcbiAgICAvLyB3aWxsIHNldCB0aGUgcHJvdG90eXBlIGlmIHBvc3NpYmxlXG4gICAgLy8gb3IgY29weSBvdmVyIGFsbCBwcm9wZXJ0aWVzXG4gICAgc2V0UHJvdG90eXBlID0gc1BPIHx8IChcbiAgICAgIGhhc1Byb3RvID9cbiAgICAgICAgZnVuY3Rpb24gKG8sIHApIHtcbiAgICAgICAgICBvLl9fcHJvdG9fXyA9IHA7XG4gICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgIH0gOiAoXG4gICAgICAoZ09QTiAmJiBnT1BEKSA/XG4gICAgICAgIChmdW5jdGlvbigpe1xuICAgICAgICAgIGZ1bmN0aW9uIHNldFByb3BlcnRpZXMobywgcCkge1xuICAgICAgICAgICAgZm9yICh2YXJcbiAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICBuYW1lcyA9IGdPUE4ocCksXG4gICAgICAgICAgICAgIGkgPSAwLCBsZW5ndGggPSBuYW1lcy5sZW5ndGg7XG4gICAgICAgICAgICAgIGkgPCBsZW5ndGg7IGkrK1xuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgIGtleSA9IG5hbWVzW2ldO1xuICAgICAgICAgICAgICBpZiAoIWhPUC5jYWxsKG8sIGtleSkpIHtcbiAgICAgICAgICAgICAgICBkZWZpbmVQcm9wZXJ0eShvLCBrZXksIGdPUEQocCwga2V5KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChvLCBwKSB7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgIHNldFByb3BlcnRpZXMobywgcCk7XG4gICAgICAgICAgICB9IHdoaWxlICgocCA9IGdQTyhwKSkgJiYgIWlQTy5jYWxsKHAsIG8pKTtcbiAgICAgICAgICAgIHJldHVybiBvO1xuICAgICAgICAgIH07XG4gICAgICAgIH0oKSkgOlxuICAgICAgICBmdW5jdGlvbiAobywgcCkge1xuICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwKSB7XG4gICAgICAgICAgICBvW2tleV0gPSBwW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBvO1xuICAgICAgICB9XG4gICAgKSksXG4gIFxuICAgIC8vIERPTSBzaG9ydGN1dHMgYW5kIGhlbHBlcnMsIGlmIGFueVxuICBcbiAgICBNdXRhdGlvbk9ic2VydmVyID0gd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LldlYktpdE11dGF0aW9uT2JzZXJ2ZXIsXG4gIFxuICAgIEhUTUxFbGVtZW50UHJvdG90eXBlID0gKFxuICAgICAgd2luZG93LkhUTUxFbGVtZW50IHx8XG4gICAgICB3aW5kb3cuRWxlbWVudCB8fFxuICAgICAgd2luZG93Lk5vZGVcbiAgICApLnByb3RvdHlwZSxcbiAgXG4gICAgSUU4ID0gIWlQTy5jYWxsKEhUTUxFbGVtZW50UHJvdG90eXBlLCBkb2N1bWVudEVsZW1lbnQpLFxuICBcbiAgICBzYWZlUHJvcGVydHkgPSBJRTggPyBmdW5jdGlvbiAobywgaywgZCkge1xuICAgICAgb1trXSA9IGQudmFsdWU7XG4gICAgICByZXR1cm4gbztcbiAgICB9IDogZGVmaW5lUHJvcGVydHksXG4gIFxuICAgIGlzVmFsaWROb2RlID0gSUU4ID9cbiAgICAgIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHJldHVybiBub2RlLm5vZGVUeXBlID09PSAxO1xuICAgICAgfSA6XG4gICAgICBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICByZXR1cm4gaVBPLmNhbGwoSFRNTEVsZW1lbnRQcm90b3R5cGUsIG5vZGUpO1xuICAgICAgfSxcbiAgXG4gICAgdGFyZ2V0cyA9IElFOCAmJiBbXSxcbiAgXG4gICAgYXR0YWNoU2hhZG93ID0gSFRNTEVsZW1lbnRQcm90b3R5cGUuYXR0YWNoU2hhZG93LFxuICAgIGNsb25lTm9kZSA9IEhUTUxFbGVtZW50UHJvdG90eXBlLmNsb25lTm9kZSxcbiAgICBkaXNwYXRjaEV2ZW50ID0gSFRNTEVsZW1lbnRQcm90b3R5cGUuZGlzcGF0Y2hFdmVudCxcbiAgICBnZXRBdHRyaWJ1dGUgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5nZXRBdHRyaWJ1dGUsXG4gICAgaGFzQXR0cmlidXRlID0gSFRNTEVsZW1lbnRQcm90b3R5cGUuaGFzQXR0cmlidXRlLFxuICAgIHJlbW92ZUF0dHJpYnV0ZSA9IEhUTUxFbGVtZW50UHJvdG90eXBlLnJlbW92ZUF0dHJpYnV0ZSxcbiAgICBzZXRBdHRyaWJ1dGUgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5zZXRBdHRyaWJ1dGUsXG4gIFxuICAgIC8vIHJlcGxhY2VkIGxhdGVyIG9uXG4gICAgY3JlYXRlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQsXG4gICAgcGF0Y2hlZENyZWF0ZUVsZW1lbnQgPSBjcmVhdGVFbGVtZW50LFxuICBcbiAgICAvLyBzaGFyZWQgb2JzZXJ2ZXIgZm9yIGFsbCBhdHRyaWJ1dGVzXG4gICAgYXR0cmlidXRlc09ic2VydmVyID0gTXV0YXRpb25PYnNlcnZlciAmJiB7XG4gICAgICBhdHRyaWJ1dGVzOiB0cnVlLFxuICAgICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSxcbiAgICAgIGF0dHJpYnV0ZU9sZFZhbHVlOiB0cnVlXG4gICAgfSxcbiAgXG4gICAgLy8gdXNlZnVsIHRvIGRldGVjdCBvbmx5IGlmIHRoZXJlJ3Mgbm8gTXV0YXRpb25PYnNlcnZlclxuICAgIERPTUF0dHJNb2RpZmllZCA9IE11dGF0aW9uT2JzZXJ2ZXIgfHwgZnVuY3Rpb24oZSkge1xuICAgICAgZG9lc05vdFN1cHBvcnRET01BdHRyTW9kaWZpZWQgPSBmYWxzZTtcbiAgICAgIGRvY3VtZW50RWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgICBET01fQVRUUl9NT0RJRklFRCxcbiAgICAgICAgRE9NQXR0ck1vZGlmaWVkXG4gICAgICApO1xuICAgIH0sXG4gIFxuICAgIC8vIHdpbGwgYm90aCBiZSB1c2VkIHRvIG1ha2UgRE9NTm9kZUluc2VydGVkIGFzeW5jaHJvbm91c1xuICAgIGFzYXBRdWV1ZSxcbiAgICBhc2FwVGltZXIgPSAwLFxuICBcbiAgICAvLyBpbnRlcm5hbCBmbGFnc1xuICAgIFYwID0gUkVHSVNURVJfRUxFTUVOVCBpbiBkb2N1bWVudCxcbiAgICBzZXRMaXN0ZW5lciA9IHRydWUsXG4gICAganVzdFNldHVwID0gZmFsc2UsXG4gICAgZG9lc05vdFN1cHBvcnRET01BdHRyTW9kaWZpZWQgPSB0cnVlLFxuICAgIGRyb3BEb21Db250ZW50TG9hZGVkID0gdHJ1ZSxcbiAgXG4gICAgLy8gbmVlZGVkIGZvciB0aGUgaW5uZXJIVE1MIGhlbHBlclxuICAgIG5vdEZyb21Jbm5lckhUTUxIZWxwZXIgPSB0cnVlLFxuICBcbiAgICAvLyBvcHRpb25hbGx5IGRlZmluZWQgbGF0ZXIgb25cbiAgICBvblN1YnRyZWVNb2RpZmllZCxcbiAgICBjYWxsRE9NQXR0ck1vZGlmaWVkLFxuICAgIGdldEF0dHJpYnV0ZXNNaXJyb3IsXG4gICAgb2JzZXJ2ZXIsXG4gICAgb2JzZXJ2ZSxcbiAgXG4gICAgLy8gYmFzZWQgb24gc2V0dGluZyBwcm90b3R5cGUgY2FwYWJpbGl0eVxuICAgIC8vIHdpbGwgY2hlY2sgcHJvdG8gb3IgdGhlIGV4cGFuZG8gYXR0cmlidXRlXG4gICAgLy8gaW4gb3JkZXIgdG8gc2V0dXAgdGhlIG5vZGUgb25jZVxuICAgIHBhdGNoSWZOb3RBbHJlYWR5LFxuICAgIHBhdGNoXG4gIDtcbiAgXG4gIC8vIG9ubHkgaWYgbmVlZGVkXG4gIGlmICghVjApIHtcbiAgXG4gICAgaWYgKHNQTyB8fCBoYXNQcm90bykge1xuICAgICAgICBwYXRjaElmTm90QWxyZWFkeSA9IGZ1bmN0aW9uIChub2RlLCBwcm90bykge1xuICAgICAgICAgIGlmICghaVBPLmNhbGwocHJvdG8sIG5vZGUpKSB7XG4gICAgICAgICAgICBzZXR1cE5vZGUobm9kZSwgcHJvdG8pO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcGF0Y2ggPSBzZXR1cE5vZGU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcGF0Y2hJZk5vdEFscmVhZHkgPSBmdW5jdGlvbiAobm9kZSwgcHJvdG8pIHtcbiAgICAgICAgICBpZiAoIW5vZGVbRVhQQU5ET19VSURdKSB7XG4gICAgICAgICAgICBub2RlW0VYUEFORE9fVUlEXSA9IE9iamVjdCh0cnVlKTtcbiAgICAgICAgICAgIHNldHVwTm9kZShub2RlLCBwcm90byk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBwYXRjaCA9IHBhdGNoSWZOb3RBbHJlYWR5O1xuICAgIH1cbiAgXG4gICAgaWYgKElFOCkge1xuICAgICAgZG9lc05vdFN1cHBvcnRET01BdHRyTW9kaWZpZWQgPSBmYWxzZTtcbiAgICAgIChmdW5jdGlvbiAoKXtcbiAgICAgICAgdmFyXG4gICAgICAgICAgZGVzY3JpcHRvciA9IGdPUEQoSFRNTEVsZW1lbnRQcm90b3R5cGUsIEFERF9FVkVOVF9MSVNURU5FUiksXG4gICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lciA9IGRlc2NyaXB0b3IudmFsdWUsXG4gICAgICAgICAgcGF0Y2hlZFJlbW92ZUF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICB2YXIgZSA9IG5ldyBDdXN0b21FdmVudChET01fQVRUUl9NT0RJRklFRCwge2J1YmJsZXM6IHRydWV9KTtcbiAgICAgICAgICAgIGUuYXR0ck5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgZS5wcmV2VmFsdWUgPSBnZXRBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuYW1lKTtcbiAgICAgICAgICAgIGUubmV3VmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgZVtSRU1PVkFMXSA9IGUuYXR0ckNoYW5nZSA9IDI7XG4gICAgICAgICAgICByZW1vdmVBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuYW1lKTtcbiAgICAgICAgICAgIGRpc3BhdGNoRXZlbnQuY2FsbCh0aGlzLCBlKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBhdGNoZWRTZXRBdHRyaWJ1dGUgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgICAgIHZhclxuICAgICAgICAgICAgICBoYWQgPSBoYXNBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuYW1lKSxcbiAgICAgICAgICAgICAgb2xkID0gaGFkICYmIGdldEF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUpLFxuICAgICAgICAgICAgICBlID0gbmV3IEN1c3RvbUV2ZW50KERPTV9BVFRSX01PRElGSUVELCB7YnViYmxlczogdHJ1ZX0pXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICBzZXRBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICBlLmF0dHJOYW1lID0gbmFtZTtcbiAgICAgICAgICAgIGUucHJldlZhbHVlID0gaGFkID8gb2xkIDogbnVsbDtcbiAgICAgICAgICAgIGUubmV3VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChoYWQpIHtcbiAgICAgICAgICAgICAgZVtNT0RJRklDQVRJT05dID0gZS5hdHRyQ2hhbmdlID0gMTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGVbQURESVRJT05dID0gZS5hdHRyQ2hhbmdlID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRpc3BhdGNoRXZlbnQuY2FsbCh0aGlzLCBlKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uUHJvcGVydHlDaGFuZ2UgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgLy8ganNoaW50IGVxbnVsbDp0cnVlXG4gICAgICAgICAgICB2YXJcbiAgICAgICAgICAgICAgbm9kZSA9IGUuY3VycmVudFRhcmdldCxcbiAgICAgICAgICAgICAgc3VwZXJTZWNyZXQgPSBub2RlW0VYUEFORE9fVUlEXSxcbiAgICAgICAgICAgICAgcHJvcGVydHlOYW1lID0gZS5wcm9wZXJ0eU5hbWUsXG4gICAgICAgICAgICAgIGV2ZW50XG4gICAgICAgICAgICA7XG4gICAgICAgICAgICBpZiAoc3VwZXJTZWNyZXQuaGFzT3duUHJvcGVydHkocHJvcGVydHlOYW1lKSkge1xuICAgICAgICAgICAgICBzdXBlclNlY3JldCA9IHN1cGVyU2VjcmV0W3Byb3BlcnR5TmFtZV07XG4gICAgICAgICAgICAgIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KERPTV9BVFRSX01PRElGSUVELCB7YnViYmxlczogdHJ1ZX0pO1xuICAgICAgICAgICAgICBldmVudC5hdHRyTmFtZSA9IHN1cGVyU2VjcmV0Lm5hbWU7XG4gICAgICAgICAgICAgIGV2ZW50LnByZXZWYWx1ZSA9IHN1cGVyU2VjcmV0LnZhbHVlIHx8IG51bGw7XG4gICAgICAgICAgICAgIGV2ZW50Lm5ld1ZhbHVlID0gKHN1cGVyU2VjcmV0LnZhbHVlID0gbm9kZVtwcm9wZXJ0eU5hbWVdIHx8IG51bGwpO1xuICAgICAgICAgICAgICBpZiAoZXZlbnQucHJldlZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBldmVudFtBRERJVElPTl0gPSBldmVudC5hdHRyQ2hhbmdlID0gMDtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBldmVudFtNT0RJRklDQVRJT05dID0gZXZlbnQuYXR0ckNoYW5nZSA9IDE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZGlzcGF0Y2hFdmVudC5jYWxsKG5vZGUsIGV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIDtcbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uICh0eXBlLCBoYW5kbGVyLCBjYXB0dXJlKSB7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgdHlwZSA9PT0gRE9NX0FUVFJfTU9ESUZJRUQgJiZcbiAgICAgICAgICAgIHRoaXNbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdICYmXG4gICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZSAhPT0gcGF0Y2hlZFNldEF0dHJpYnV0ZVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgdGhpc1tFWFBBTkRPX1VJRF0gPSB7XG4gICAgICAgICAgICAgIGNsYXNzTmFtZToge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdjbGFzcycsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuY2xhc3NOYW1lXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZSA9IHBhdGNoZWRTZXRBdHRyaWJ1dGU7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZSA9IHBhdGNoZWRSZW1vdmVBdHRyaWJ1dGU7XG4gICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyLmNhbGwodGhpcywgJ3Byb3BlcnR5Y2hhbmdlJywgb25Qcm9wZXJ0eUNoYW5nZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCB0eXBlLCBoYW5kbGVyLCBjYXB0dXJlKTtcbiAgICAgICAgfTtcbiAgICAgICAgZGVmaW5lUHJvcGVydHkoSFRNTEVsZW1lbnRQcm90b3R5cGUsIEFERF9FVkVOVF9MSVNURU5FUiwgZGVzY3JpcHRvcik7XG4gICAgICB9KCkpO1xuICAgIH0gZWxzZSBpZiAoIU11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAgIGRvY3VtZW50RWxlbWVudFtBRERfRVZFTlRfTElTVEVORVJdKERPTV9BVFRSX01PRElGSUVELCBET01BdHRyTW9kaWZpZWQpO1xuICAgICAgZG9jdW1lbnRFbGVtZW50LnNldEF0dHJpYnV0ZShFWFBBTkRPX1VJRCwgMSk7XG4gICAgICBkb2N1bWVudEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKEVYUEFORE9fVUlEKTtcbiAgICAgIGlmIChkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCkge1xuICAgICAgICBvblN1YnRyZWVNb2RpZmllZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdmFyXG4gICAgICAgICAgICBub2RlID0gdGhpcyxcbiAgICAgICAgICAgIG9sZEF0dHJpYnV0ZXMsXG4gICAgICAgICAgICBuZXdBdHRyaWJ1dGVzLFxuICAgICAgICAgICAga2V5XG4gICAgICAgICAgO1xuICAgICAgICAgIGlmIChub2RlID09PSBlLnRhcmdldCkge1xuICAgICAgICAgICAgb2xkQXR0cmlidXRlcyA9IG5vZGVbRVhQQU5ET19VSURdO1xuICAgICAgICAgICAgbm9kZVtFWFBBTkRPX1VJRF0gPSAobmV3QXR0cmlidXRlcyA9IGdldEF0dHJpYnV0ZXNNaXJyb3Iobm9kZSkpO1xuICAgICAgICAgICAgZm9yIChrZXkgaW4gbmV3QXR0cmlidXRlcykge1xuICAgICAgICAgICAgICBpZiAoIShrZXkgaW4gb2xkQXR0cmlidXRlcykpIHtcbiAgICAgICAgICAgICAgICAvLyBhdHRyaWJ1dGUgd2FzIGFkZGVkXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxET01BdHRyTW9kaWZpZWQoXG4gICAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgIG9sZEF0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIG5ld0F0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIEFERElUSU9OXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChuZXdBdHRyaWJ1dGVzW2tleV0gIT09IG9sZEF0dHJpYnV0ZXNba2V5XSkge1xuICAgICAgICAgICAgICAgIC8vIGF0dHJpYnV0ZSB3YXMgY2hhbmdlZFxuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsRE9NQXR0ck1vZGlmaWVkKFxuICAgICAgICAgICAgICAgICAgMSxcbiAgICAgICAgICAgICAgICAgIG5vZGUsXG4gICAgICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgICAgICBvbGRBdHRyaWJ1dGVzW2tleV0sXG4gICAgICAgICAgICAgICAgICBuZXdBdHRyaWJ1dGVzW2tleV0sXG4gICAgICAgICAgICAgICAgICBNT0RJRklDQVRJT05cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjaGVja2luZyBpZiBpdCBoYXMgYmVlbiByZW1vdmVkXG4gICAgICAgICAgICBmb3IgKGtleSBpbiBvbGRBdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgIGlmICghKGtleSBpbiBuZXdBdHRyaWJ1dGVzKSkge1xuICAgICAgICAgICAgICAgIC8vIGF0dHJpYnV0ZSByZW1vdmVkXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxET01BdHRyTW9kaWZpZWQoXG4gICAgICAgICAgICAgICAgICAyLFxuICAgICAgICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgIG9sZEF0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIG5ld0F0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIFJFTU9WQUxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjYWxsRE9NQXR0ck1vZGlmaWVkID0gZnVuY3Rpb24gKFxuICAgICAgICAgIGF0dHJDaGFuZ2UsXG4gICAgICAgICAgY3VycmVudFRhcmdldCxcbiAgICAgICAgICBhdHRyTmFtZSxcbiAgICAgICAgICBwcmV2VmFsdWUsXG4gICAgICAgICAgbmV3VmFsdWUsXG4gICAgICAgICAgYWN0aW9uXG4gICAgICAgICkge1xuICAgICAgICAgIHZhciBlID0ge1xuICAgICAgICAgICAgYXR0ckNoYW5nZTogYXR0ckNoYW5nZSxcbiAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQ6IGN1cnJlbnRUYXJnZXQsXG4gICAgICAgICAgICBhdHRyTmFtZTogYXR0ck5hbWUsXG4gICAgICAgICAgICBwcmV2VmFsdWU6IHByZXZWYWx1ZSxcbiAgICAgICAgICAgIG5ld1ZhbHVlOiBuZXdWYWx1ZVxuICAgICAgICAgIH07XG4gICAgICAgICAgZVthY3Rpb25dID0gYXR0ckNoYW5nZTtcbiAgICAgICAgICBvbkRPTUF0dHJNb2RpZmllZChlKTtcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0QXR0cmlidXRlc01pcnJvciA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgZm9yICh2YXJcbiAgICAgICAgICAgIGF0dHIsIG5hbWUsXG4gICAgICAgICAgICByZXN1bHQgPSB7fSxcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSBub2RlLmF0dHJpYnV0ZXMsXG4gICAgICAgICAgICBpID0gMCwgbGVuZ3RoID0gYXR0cmlidXRlcy5sZW5ndGg7XG4gICAgICAgICAgICBpIDwgbGVuZ3RoOyBpKytcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIGF0dHIgPSBhdHRyaWJ1dGVzW2ldO1xuICAgICAgICAgICAgbmFtZSA9IGF0dHIubmFtZTtcbiAgICAgICAgICAgIGlmIChuYW1lICE9PSAnc2V0QXR0cmlidXRlJykge1xuICAgICAgICAgICAgICByZXN1bHRbbmFtZV0gPSBhdHRyLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgXG4gICAgLy8gc2V0IGFzIGVudW1lcmFibGUsIHdyaXRhYmxlIGFuZCBjb25maWd1cmFibGVcbiAgICBkb2N1bWVudFtSRUdJU1RFUl9FTEVNRU5UXSA9IGZ1bmN0aW9uIHJlZ2lzdGVyRWxlbWVudCh0eXBlLCBvcHRpb25zKSB7XG4gICAgICB1cHBlclR5cGUgPSB0eXBlLnRvVXBwZXJDYXNlKCk7XG4gICAgICBpZiAoc2V0TGlzdGVuZXIpIHtcbiAgICAgICAgLy8gb25seSBmaXJzdCB0aW1lIGRvY3VtZW50LnJlZ2lzdGVyRWxlbWVudCBpcyB1c2VkXG4gICAgICAgIC8vIHdlIG5lZWQgdG8gc2V0IHRoaXMgbGlzdGVuZXJcbiAgICAgICAgLy8gc2V0dGluZyBpdCBieSBkZWZhdWx0IG1pZ2h0IHNsb3cgZG93biBmb3Igbm8gcmVhc29uXG4gICAgICAgIHNldExpc3RlbmVyID0gZmFsc2U7XG4gICAgICAgIGlmIChNdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgICAgICAgb2JzZXJ2ZXIgPSAoZnVuY3Rpb24oYXR0YWNoZWQsIGRldGFjaGVkKXtcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrRW1BbGwobGlzdCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGxpc3QubGVuZ3RoOyBpIDwgbGVuZ3RoOyBjYWxsYmFjayhsaXN0W2krK10pKXt9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKHJlY29yZHMpIHtcbiAgICAgICAgICAgICAgZm9yICh2YXJcbiAgICAgICAgICAgICAgICBjdXJyZW50LCBub2RlLCBuZXdWYWx1ZSxcbiAgICAgICAgICAgICAgICBpID0gMCwgbGVuZ3RoID0gcmVjb3Jkcy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrK1xuICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50ID0gcmVjb3Jkc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudC50eXBlID09PSAnY2hpbGRMaXN0Jykge1xuICAgICAgICAgICAgICAgICAgY2hlY2tFbUFsbChjdXJyZW50LmFkZGVkTm9kZXMsIGF0dGFjaGVkKTtcbiAgICAgICAgICAgICAgICAgIGNoZWNrRW1BbGwoY3VycmVudC5yZW1vdmVkTm9kZXMsIGRldGFjaGVkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgbm9kZSA9IGN1cnJlbnQudGFyZ2V0O1xuICAgICAgICAgICAgICAgICAgaWYgKG5vdEZyb21Jbm5lckhUTUxIZWxwZXIgJiZcbiAgICAgICAgICAgICAgICAgICAgICBub2RlW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXSAmJlxuICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQuYXR0cmlidXRlTmFtZSAhPT0gJ3N0eWxlJykge1xuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IGdldEF0dHJpYnV0ZS5jYWxsKG5vZGUsIGN1cnJlbnQuYXR0cmlidXRlTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gY3VycmVudC5vbGRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgIG5vZGVbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdKFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5hdHRyaWJ1dGVOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5vbGRWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfShleGVjdXRlQWN0aW9uKEFUVEFDSEVEKSwgZXhlY3V0ZUFjdGlvbihERVRBQ0hFRCkpKTtcbiAgICAgICAgICBvYnNlcnZlID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUoXG4gICAgICAgICAgICAgIG5vZGUsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgc3VidHJlZTogdHJ1ZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgICAgfTtcbiAgICAgICAgICBvYnNlcnZlKGRvY3VtZW50KTtcbiAgICAgICAgICBpZiAoYXR0YWNoU2hhZG93KSB7XG4gICAgICAgICAgICBIVE1MRWxlbWVudFByb3RvdHlwZS5hdHRhY2hTaGFkb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBvYnNlcnZlKGF0dGFjaFNoYWRvdy5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFzYXBRdWV1ZSA9IFtdO1xuICAgICAgICAgIGRvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oJ0RPTU5vZGVJbnNlcnRlZCcsIG9uRE9NTm9kZShBVFRBQ0hFRCkpO1xuICAgICAgICAgIGRvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oJ0RPTU5vZGVSZW1vdmVkJywgb25ET01Ob2RlKERFVEFDSEVEKSk7XG4gICAgICAgIH1cbiAgXG4gICAgICAgIGRvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oRE9NX0NPTlRFTlRfTE9BREVELCBvblJlYWR5U3RhdGVDaGFuZ2UpO1xuICAgICAgICBkb2N1bWVudFtBRERfRVZFTlRfTElTVEVORVJdKCdyZWFkeXN0YXRlY2hhbmdlJywgb25SZWFkeVN0YXRlQ2hhbmdlKTtcbiAgXG4gICAgICAgIEhUTUxFbGVtZW50UHJvdG90eXBlLmNsb25lTm9kZSA9IGZ1bmN0aW9uIChkZWVwKSB7XG4gICAgICAgICAgdmFyXG4gICAgICAgICAgICBub2RlID0gY2xvbmVOb2RlLmNhbGwodGhpcywgISFkZWVwKSxcbiAgICAgICAgICAgIGkgPSBnZXRUeXBlSW5kZXgobm9kZSlcbiAgICAgICAgICA7XG4gICAgICAgICAgaWYgKC0xIDwgaSkgcGF0Y2gobm9kZSwgcHJvdG9zW2ldKTtcbiAgICAgICAgICBpZiAoZGVlcCAmJiBxdWVyeS5sZW5ndGgpIGxvb3BBbmRTZXR1cChub2RlLnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpKTtcbiAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgXG4gICAgICBpZiAoanVzdFNldHVwKSByZXR1cm4gKGp1c3RTZXR1cCA9IGZhbHNlKTtcbiAgXG4gICAgICBpZiAoLTIgPCAoXG4gICAgICAgIGluZGV4T2YuY2FsbCh0eXBlcywgUFJFRklYX0lTICsgdXBwZXJUeXBlKSArXG4gICAgICAgIGluZGV4T2YuY2FsbCh0eXBlcywgUFJFRklYX1RBRyArIHVwcGVyVHlwZSlcbiAgICAgICkpIHtcbiAgICAgICAgdGhyb3dUeXBlRXJyb3IodHlwZSk7XG4gICAgICB9XG4gIFxuICAgICAgaWYgKCF2YWxpZE5hbWUudGVzdCh1cHBlclR5cGUpIHx8IC0xIDwgaW5kZXhPZi5jYWxsKGludmFsaWROYW1lcywgdXBwZXJUeXBlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSB0eXBlICcgKyB0eXBlICsgJyBpcyBpbnZhbGlkJyk7XG4gICAgICB9XG4gIFxuICAgICAgdmFyXG4gICAgICAgIGNvbnN0cnVjdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBleHRlbmRpbmcgP1xuICAgICAgICAgICAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudChub2RlTmFtZSwgdXBwZXJUeXBlKSA6XG4gICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGVOYW1lKTtcbiAgICAgICAgfSxcbiAgICAgICAgb3B0ID0gb3B0aW9ucyB8fCBPUCxcbiAgICAgICAgZXh0ZW5kaW5nID0gaE9QLmNhbGwob3B0LCBFWFRFTkRTKSxcbiAgICAgICAgbm9kZU5hbWUgPSBleHRlbmRpbmcgPyBvcHRpb25zW0VYVEVORFNdLnRvVXBwZXJDYXNlKCkgOiB1cHBlclR5cGUsXG4gICAgICAgIHVwcGVyVHlwZSxcbiAgICAgICAgaVxuICAgICAgO1xuICBcbiAgICAgIGlmIChleHRlbmRpbmcgJiYgLTEgPCAoXG4gICAgICAgIGluZGV4T2YuY2FsbCh0eXBlcywgUFJFRklYX1RBRyArIG5vZGVOYW1lKVxuICAgICAgKSkge1xuICAgICAgICB0aHJvd1R5cGVFcnJvcihub2RlTmFtZSk7XG4gICAgICB9XG4gIFxuICAgICAgaSA9IHR5cGVzLnB1c2goKGV4dGVuZGluZyA/IFBSRUZJWF9JUyA6IFBSRUZJWF9UQUcpICsgdXBwZXJUeXBlKSAtIDE7XG4gIFxuICAgICAgcXVlcnkgPSBxdWVyeS5jb25jYXQoXG4gICAgICAgIHF1ZXJ5Lmxlbmd0aCA/ICcsJyA6ICcnLFxuICAgICAgICBleHRlbmRpbmcgPyBub2RlTmFtZSArICdbaXM9XCInICsgdHlwZS50b0xvd2VyQ2FzZSgpICsgJ1wiXScgOiBub2RlTmFtZVxuICAgICAgKTtcbiAgXG4gICAgICBjb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSAoXG4gICAgICAgIHByb3Rvc1tpXSA9IGhPUC5jYWxsKG9wdCwgJ3Byb3RvdHlwZScpID9cbiAgICAgICAgICBvcHQucHJvdG90eXBlIDpcbiAgICAgICAgICBjcmVhdGUoSFRNTEVsZW1lbnRQcm90b3R5cGUpXG4gICAgICApO1xuICBcbiAgICAgIGlmIChxdWVyeS5sZW5ndGgpIGxvb3BBbmRWZXJpZnkoXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpLFxuICAgICAgICBBVFRBQ0hFRFxuICAgICAgKTtcbiAgXG4gICAgICByZXR1cm4gY29uc3RydWN0b3I7XG4gICAgfTtcbiAgXG4gICAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCA9IChwYXRjaGVkQ3JlYXRlRWxlbWVudCA9IGZ1bmN0aW9uIChsb2NhbE5hbWUsIHR5cGVFeHRlbnNpb24pIHtcbiAgICAgIHZhclxuICAgICAgICBpcyA9IGdldElzKHR5cGVFeHRlbnNpb24pLFxuICAgICAgICBub2RlID0gaXMgP1xuICAgICAgICAgIGNyZWF0ZUVsZW1lbnQuY2FsbChkb2N1bWVudCwgbG9jYWxOYW1lLCBzZWNvbmRBcmd1bWVudChpcykpIDpcbiAgICAgICAgICBjcmVhdGVFbGVtZW50LmNhbGwoZG9jdW1lbnQsIGxvY2FsTmFtZSksXG4gICAgICAgIG5hbWUgPSAnJyArIGxvY2FsTmFtZSxcbiAgICAgICAgaSA9IGluZGV4T2YuY2FsbChcbiAgICAgICAgICB0eXBlcyxcbiAgICAgICAgICAoaXMgPyBQUkVGSVhfSVMgOiBQUkVGSVhfVEFHKSArXG4gICAgICAgICAgKGlzIHx8IG5hbWUpLnRvVXBwZXJDYXNlKClcbiAgICAgICAgKSxcbiAgICAgICAgc2V0dXAgPSAtMSA8IGlcbiAgICAgIDtcbiAgICAgIGlmIChpcykge1xuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSgnaXMnLCBpcyA9IGlzLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICBpZiAoc2V0dXApIHtcbiAgICAgICAgICBzZXR1cCA9IGlzSW5RU0EobmFtZS50b1VwcGVyQ2FzZSgpLCBpcyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIG5vdEZyb21Jbm5lckhUTUxIZWxwZXIgPSAhZG9jdW1lbnQuY3JlYXRlRWxlbWVudC5pbm5lckhUTUxIZWxwZXI7XG4gICAgICBpZiAoc2V0dXApIHBhdGNoKG5vZGUsIHByb3Rvc1tpXSk7XG4gICAgICByZXR1cm4gbm9kZTtcbiAgICB9KTtcbiAgXG4gIH1cbiAgXG4gIGZ1bmN0aW9uIEFTQVAoKSB7XG4gICAgdmFyIHF1ZXVlID0gYXNhcFF1ZXVlLnNwbGljZSgwLCBhc2FwUXVldWUubGVuZ3RoKTtcbiAgICBhc2FwVGltZXIgPSAwO1xuICAgIHdoaWxlIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgIHF1ZXVlLnNoaWZ0KCkuY2FsbChcbiAgICAgICAgbnVsbCwgcXVldWUuc2hpZnQoKVxuICAgICAgKTtcbiAgICB9XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGxvb3BBbmRWZXJpZnkobGlzdCwgYWN0aW9uKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGxpc3QubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZlcmlmeUFuZFNldHVwQW5kQWN0aW9uKGxpc3RbaV0sIGFjdGlvbik7XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiBsb29wQW5kU2V0dXAobGlzdCkge1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBsaXN0Lmxlbmd0aCwgbm9kZTsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBub2RlID0gbGlzdFtpXTtcbiAgICAgIHBhdGNoKG5vZGUsIHByb3Rvc1tnZXRUeXBlSW5kZXgobm9kZSldKTtcbiAgICB9XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGV4ZWN1dGVBY3Rpb24oYWN0aW9uKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICBpZiAoaXNWYWxpZE5vZGUobm9kZSkpIHtcbiAgICAgICAgdmVyaWZ5QW5kU2V0dXBBbmRBY3Rpb24obm9kZSwgYWN0aW9uKTtcbiAgICAgICAgaWYgKHF1ZXJ5Lmxlbmd0aCkgbG9vcEFuZFZlcmlmeShcbiAgICAgICAgICBub2RlLnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpLFxuICAgICAgICAgIGFjdGlvblxuICAgICAgICApO1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGdldFR5cGVJbmRleCh0YXJnZXQpIHtcbiAgICB2YXJcbiAgICAgIGlzID0gZ2V0QXR0cmlidXRlLmNhbGwodGFyZ2V0LCAnaXMnKSxcbiAgICAgIG5vZGVOYW1lID0gdGFyZ2V0Lm5vZGVOYW1lLnRvVXBwZXJDYXNlKCksXG4gICAgICBpID0gaW5kZXhPZi5jYWxsKFxuICAgICAgICB0eXBlcyxcbiAgICAgICAgaXMgP1xuICAgICAgICAgICAgUFJFRklYX0lTICsgaXMudG9VcHBlckNhc2UoKSA6XG4gICAgICAgICAgICBQUkVGSVhfVEFHICsgbm9kZU5hbWVcbiAgICAgIClcbiAgICA7XG4gICAgcmV0dXJuIGlzICYmIC0xIDwgaSAmJiAhaXNJblFTQShub2RlTmFtZSwgaXMpID8gLTEgOiBpO1xuICB9XG4gIFxuICBmdW5jdGlvbiBpc0luUVNBKG5hbWUsIHR5cGUpIHtcbiAgICByZXR1cm4gLTEgPCBxdWVyeS5pbmRleE9mKG5hbWUgKyAnW2lzPVwiJyArIHR5cGUgKyAnXCJdJyk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIG9uRE9NQXR0ck1vZGlmaWVkKGUpIHtcbiAgICB2YXJcbiAgICAgIG5vZGUgPSBlLmN1cnJlbnRUYXJnZXQsXG4gICAgICBhdHRyQ2hhbmdlID0gZS5hdHRyQ2hhbmdlLFxuICAgICAgYXR0ck5hbWUgPSBlLmF0dHJOYW1lLFxuICAgICAgdGFyZ2V0ID0gZS50YXJnZXQsXG4gICAgICBhZGRpdGlvbiA9IGVbQURESVRJT05dIHx8IDIsXG4gICAgICByZW1vdmFsID0gZVtSRU1PVkFMXSB8fCAzXG4gICAgO1xuICAgIGlmIChub3RGcm9tSW5uZXJIVE1MSGVscGVyICYmXG4gICAgICAgICghdGFyZ2V0IHx8IHRhcmdldCA9PT0gbm9kZSkgJiZcbiAgICAgICAgbm9kZVtBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDS10gJiZcbiAgICAgICAgYXR0ck5hbWUgIT09ICdzdHlsZScgJiYgKFxuICAgICAgICAgIGUucHJldlZhbHVlICE9PSBlLm5ld1ZhbHVlIHx8XG4gICAgICAgICAgLy8gSUU5LCBJRTEwLCBhbmQgT3BlcmEgMTIgZ290Y2hhXG4gICAgICAgICAgZS5uZXdWYWx1ZSA9PT0gJycgJiYgKFxuICAgICAgICAgICAgYXR0ckNoYW5nZSA9PT0gYWRkaXRpb24gfHxcbiAgICAgICAgICAgIGF0dHJDaGFuZ2UgPT09IHJlbW92YWxcbiAgICAgICAgICApXG4gICAgKSkge1xuICAgICAgbm9kZVtBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDS10oXG4gICAgICAgIGF0dHJOYW1lLFxuICAgICAgICBhdHRyQ2hhbmdlID09PSBhZGRpdGlvbiA/IG51bGwgOiBlLnByZXZWYWx1ZSxcbiAgICAgICAgYXR0ckNoYW5nZSA9PT0gcmVtb3ZhbCA/IG51bGwgOiBlLm5ld1ZhbHVlXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gb25ET01Ob2RlKGFjdGlvbikge1xuICAgIHZhciBleGVjdXRvciA9IGV4ZWN1dGVBY3Rpb24oYWN0aW9uKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGFzYXBRdWV1ZS5wdXNoKGV4ZWN1dG9yLCBlLnRhcmdldCk7XG4gICAgICBpZiAoYXNhcFRpbWVyKSBjbGVhclRpbWVvdXQoYXNhcFRpbWVyKTtcbiAgICAgIGFzYXBUaW1lciA9IHNldFRpbWVvdXQoQVNBUCwgMSk7XG4gICAgfTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gb25SZWFkeVN0YXRlQ2hhbmdlKGUpIHtcbiAgICBpZiAoZHJvcERvbUNvbnRlbnRMb2FkZWQpIHtcbiAgICAgIGRyb3BEb21Db250ZW50TG9hZGVkID0gZmFsc2U7XG4gICAgICBlLmN1cnJlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihET01fQ09OVEVOVF9MT0FERUQsIG9uUmVhZHlTdGF0ZUNoYW5nZSk7XG4gICAgfVxuICAgIGlmIChxdWVyeS5sZW5ndGgpIGxvb3BBbmRWZXJpZnkoXG4gICAgICAoZS50YXJnZXQgfHwgZG9jdW1lbnQpLnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpLFxuICAgICAgZS5kZXRhaWwgPT09IERFVEFDSEVEID8gREVUQUNIRUQgOiBBVFRBQ0hFRFxuICAgICk7XG4gICAgaWYgKElFOCkgcHVyZ2UoKTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gcGF0Y2hlZFNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkge1xuICAgIC8vIGpzaGludCB2YWxpZHRoaXM6dHJ1ZVxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZXRBdHRyaWJ1dGUuY2FsbChzZWxmLCBuYW1lLCB2YWx1ZSk7XG4gICAgb25TdWJ0cmVlTW9kaWZpZWQuY2FsbChzZWxmLCB7dGFyZ2V0OiBzZWxmfSk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHNldHVwTm9kZShub2RlLCBwcm90bykge1xuICAgIHNldFByb3RvdHlwZShub2RlLCBwcm90byk7XG4gICAgaWYgKG9ic2VydmVyKSB7XG4gICAgICBvYnNlcnZlci5vYnNlcnZlKG5vZGUsIGF0dHJpYnV0ZXNPYnNlcnZlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCkge1xuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSA9IHBhdGNoZWRTZXRBdHRyaWJ1dGU7XG4gICAgICAgIG5vZGVbRVhQQU5ET19VSURdID0gZ2V0QXR0cmlidXRlc01pcnJvcihub2RlKTtcbiAgICAgICAgbm9kZVtBRERfRVZFTlRfTElTVEVORVJdKERPTV9TVUJUUkVFX01PRElGSUVELCBvblN1YnRyZWVNb2RpZmllZCk7XG4gICAgICB9XG4gICAgICBub2RlW0FERF9FVkVOVF9MSVNURU5FUl0oRE9NX0FUVFJfTU9ESUZJRUQsIG9uRE9NQXR0ck1vZGlmaWVkKTtcbiAgICB9XG4gICAgaWYgKG5vZGVbQ1JFQVRFRF9DQUxMQkFDS10gJiYgbm90RnJvbUlubmVySFRNTEhlbHBlcikge1xuICAgICAgbm9kZS5jcmVhdGVkID0gdHJ1ZTtcbiAgICAgIG5vZGVbQ1JFQVRFRF9DQUxMQkFDS10oKTtcbiAgICAgIG5vZGUuY3JlYXRlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gcHVyZ2UoKSB7XG4gICAgZm9yICh2YXJcbiAgICAgIG5vZGUsXG4gICAgICBpID0gMCxcbiAgICAgIGxlbmd0aCA9IHRhcmdldHMubGVuZ3RoO1xuICAgICAgaSA8IGxlbmd0aDsgaSsrXG4gICAgKSB7XG4gICAgICBub2RlID0gdGFyZ2V0c1tpXTtcbiAgICAgIGlmICghZG9jdW1lbnRFbGVtZW50LmNvbnRhaW5zKG5vZGUpKSB7XG4gICAgICAgIGxlbmd0aC0tO1xuICAgICAgICB0YXJnZXRzLnNwbGljZShpLS0sIDEpO1xuICAgICAgICB2ZXJpZnlBbmRTZXR1cEFuZEFjdGlvbihub2RlLCBERVRBQ0hFRCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiB0aHJvd1R5cGVFcnJvcih0eXBlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdBICcgKyB0eXBlICsgJyB0eXBlIGlzIGFscmVhZHkgcmVnaXN0ZXJlZCcpO1xuICB9XG4gIFxuICBmdW5jdGlvbiB2ZXJpZnlBbmRTZXR1cEFuZEFjdGlvbihub2RlLCBhY3Rpb24pIHtcbiAgICB2YXJcbiAgICAgIGZuLFxuICAgICAgaSA9IGdldFR5cGVJbmRleChub2RlKVxuICAgIDtcbiAgICBpZiAoLTEgPCBpKSB7XG4gICAgICBwYXRjaElmTm90QWxyZWFkeShub2RlLCBwcm90b3NbaV0pO1xuICAgICAgaSA9IDA7XG4gICAgICBpZiAoYWN0aW9uID09PSBBVFRBQ0hFRCAmJiAhbm9kZVtBVFRBQ0hFRF0pIHtcbiAgICAgICAgbm9kZVtERVRBQ0hFRF0gPSBmYWxzZTtcbiAgICAgICAgbm9kZVtBVFRBQ0hFRF0gPSB0cnVlO1xuICAgICAgICBpID0gMTtcbiAgICAgICAgaWYgKElFOCAmJiBpbmRleE9mLmNhbGwodGFyZ2V0cywgbm9kZSkgPCAwKSB7XG4gICAgICAgICAgdGFyZ2V0cy5wdXNoKG5vZGUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gREVUQUNIRUQgJiYgIW5vZGVbREVUQUNIRURdKSB7XG4gICAgICAgIG5vZGVbQVRUQUNIRURdID0gZmFsc2U7XG4gICAgICAgIG5vZGVbREVUQUNIRURdID0gdHJ1ZTtcbiAgICAgICAgaSA9IDE7XG4gICAgICB9XG4gICAgICBpZiAoaSAmJiAoZm4gPSBub2RlW2FjdGlvbiArIENBTExCQUNLXSkpIGZuLmNhbGwobm9kZSk7XG4gICAgfVxuICB9XG4gIFxuICBcbiAgXG4gIC8vIFYxIGluIGRhIEhvdXNlIVxuICBmdW5jdGlvbiBDdXN0b21FbGVtZW50UmVnaXN0cnkoKSB7fVxuICBcbiAgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5LnByb3RvdHlwZSA9IHtcbiAgICBjb25zdHJ1Y3RvcjogQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5LFxuICAgIC8vIGEgd29ya2Fyb3VuZCBmb3IgdGhlIHN0dWJib3JuIFdlYktpdFxuICAgIGRlZmluZTogdXNhYmxlQ3VzdG9tRWxlbWVudHMgP1xuICAgICAgZnVuY3Rpb24gKG5hbWUsIENsYXNzLCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChvcHRpb25zKSB7XG4gICAgICAgICAgQ0VSRGVmaW5lKG5hbWUsIENsYXNzLCBvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgTkFNRSA9IG5hbWUudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICBjb25zdHJ1Y3RvcnNbTkFNRV0gPSB7XG4gICAgICAgICAgICBjb25zdHJ1Y3RvcjogQ2xhc3MsXG4gICAgICAgICAgICBjcmVhdGU6IFtOQU1FXVxuICAgICAgICAgIH07XG4gICAgICAgICAgbm9kZU5hbWVzLnNldChDbGFzcywgTkFNRSk7XG4gICAgICAgICAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKG5hbWUsIENsYXNzKTtcbiAgICAgICAgfVxuICAgICAgfSA6XG4gICAgICBDRVJEZWZpbmUsXG4gICAgZ2V0OiB1c2FibGVDdXN0b21FbGVtZW50cyA/XG4gICAgICBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gY3VzdG9tRWxlbWVudHMuZ2V0KG5hbWUpIHx8IGdldChuYW1lKTtcbiAgICAgIH0gOlxuICAgICAgZ2V0LFxuICAgIHdoZW5EZWZpbmVkOiB1c2FibGVDdXN0b21FbGVtZW50cyA/XG4gICAgICBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yYWNlKFtcbiAgICAgICAgICBjdXN0b21FbGVtZW50cy53aGVuRGVmaW5lZChuYW1lKSxcbiAgICAgICAgICB3aGVuRGVmaW5lZChuYW1lKVxuICAgICAgICBdKTtcbiAgICAgIH0gOlxuICAgICAgd2hlbkRlZmluZWRcbiAgfTtcbiAgXG4gIGZ1bmN0aW9uIENFUkRlZmluZShuYW1lLCBDbGFzcywgb3B0aW9ucykge1xuICAgIHZhclxuICAgICAgaXMgPSBvcHRpb25zICYmIG9wdGlvbnNbRVhURU5EU10gfHwgJycsXG4gICAgICBDUHJvdG8gPSBDbGFzcy5wcm90b3R5cGUsXG4gICAgICBwcm90byA9IGNyZWF0ZShDUHJvdG8pLFxuICAgICAgYXR0cmlidXRlcyA9IENsYXNzLm9ic2VydmVkQXR0cmlidXRlcyB8fCBlbXB0eSxcbiAgICAgIGRlZmluaXRpb24gPSB7cHJvdG90eXBlOiBwcm90b31cbiAgICA7XG4gICAgLy8gVE9ETzogaXMgdGhpcyBuZWVkZWQgYXQgYWxsIHNpbmNlIGl0J3MgaW5oZXJpdGVkP1xuICAgIC8vIGRlZmluZVByb3BlcnR5KHByb3RvLCAnY29uc3RydWN0b3InLCB7dmFsdWU6IENsYXNzfSk7XG4gICAgc2FmZVByb3BlcnR5KHByb3RvLCBDUkVBVEVEX0NBTExCQUNLLCB7XG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKGp1c3RDcmVhdGVkKSBqdXN0Q3JlYXRlZCA9IGZhbHNlO1xuICAgICAgICAgIGVsc2UgaWYgKCF0aGlzW0RSRUNFVjFdKSB7XG4gICAgICAgICAgICB0aGlzW0RSRUNFVjFdID0gdHJ1ZTtcbiAgICAgICAgICAgIG5ldyBDbGFzcyh0aGlzKTtcbiAgICAgICAgICAgIGlmIChDUHJvdG9bQ1JFQVRFRF9DQUxMQkFDS10pXG4gICAgICAgICAgICAgIENQcm90b1tDUkVBVEVEX0NBTExCQUNLXS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdmFyIGluZm8gPSBjb25zdHJ1Y3RvcnNbbm9kZU5hbWVzLmdldChDbGFzcyldO1xuICAgICAgICAgICAgaWYgKCF1c2FibGVDdXN0b21FbGVtZW50cyB8fCBpbmZvLmNyZWF0ZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgIG5vdGlmeUF0dHJpYnV0ZXModGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIHNhZmVQcm9wZXJ0eShwcm90bywgQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0ssIHtcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICBpZiAoLTEgPCBpbmRleE9mLmNhbGwoYXR0cmlidXRlcywgbmFtZSkpXG4gICAgICAgICAgQ1Byb3RvW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChDUHJvdG9bQ09OTkVDVEVEX0NBTExCQUNLXSkge1xuICAgICAgc2FmZVByb3BlcnR5KHByb3RvLCBBVFRBQ0hFRF9DQUxMQkFDSywge1xuICAgICAgICB2YWx1ZTogQ1Byb3RvW0NPTk5FQ1RFRF9DQUxMQkFDS11cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoQ1Byb3RvW0RJU0NPTk5FQ1RFRF9DQUxMQkFDS10pIHtcbiAgICAgIHNhZmVQcm9wZXJ0eShwcm90bywgREVUQUNIRURfQ0FMTEJBQ0ssIHtcbiAgICAgICAgdmFsdWU6IENQcm90b1tESVNDT05ORUNURURfQ0FMTEJBQ0tdXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGlzKSBkZWZpbml0aW9uW0VYVEVORFNdID0gaXM7XG4gICAgbmFtZSA9IG5hbWUudG9VcHBlckNhc2UoKTtcbiAgICBjb25zdHJ1Y3RvcnNbbmFtZV0gPSB7XG4gICAgICBjb25zdHJ1Y3RvcjogQ2xhc3MsXG4gICAgICBjcmVhdGU6IGlzID8gW2lzLCBzZWNvbmRBcmd1bWVudChuYW1lKV0gOiBbbmFtZV1cbiAgICB9O1xuICAgIG5vZGVOYW1lcy5zZXQoQ2xhc3MsIG5hbWUpO1xuICAgIGRvY3VtZW50W1JFR0lTVEVSX0VMRU1FTlRdKG5hbWUudG9Mb3dlckNhc2UoKSwgZGVmaW5pdGlvbik7XG4gICAgd2hlbkRlZmluZWQobmFtZSk7XG4gICAgd2FpdGluZ0xpc3RbbmFtZV0ucigpO1xuICB9XG4gIFxuICBmdW5jdGlvbiBnZXQobmFtZSkge1xuICAgIHZhciBpbmZvID0gY29uc3RydWN0b3JzW25hbWUudG9VcHBlckNhc2UoKV07XG4gICAgcmV0dXJuIGluZm8gJiYgaW5mby5jb25zdHJ1Y3RvcjtcbiAgfVxuICBcbiAgZnVuY3Rpb24gZ2V0SXMob3B0aW9ucykge1xuICAgIHJldHVybiB0eXBlb2Ygb3B0aW9ucyA9PT0gJ3N0cmluZycgP1xuICAgICAgICBvcHRpb25zIDogKG9wdGlvbnMgJiYgb3B0aW9ucy5pcyB8fCAnJyk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIG5vdGlmeUF0dHJpYnV0ZXMoc2VsZikge1xuICAgIHZhclxuICAgICAgY2FsbGJhY2sgPSBzZWxmW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXSxcbiAgICAgIGF0dHJpYnV0ZXMgPSBjYWxsYmFjayA/IHNlbGYuYXR0cmlidXRlcyA6IGVtcHR5LFxuICAgICAgaSA9IGF0dHJpYnV0ZXMubGVuZ3RoLFxuICAgICAgYXR0cmlidXRlXG4gICAgO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIGF0dHJpYnV0ZSA9ICBhdHRyaWJ1dGVzW2ldOyAvLyB8fCBhdHRyaWJ1dGVzLml0ZW0oaSk7XG4gICAgICBjYWxsYmFjay5jYWxsKFxuICAgICAgICBzZWxmLFxuICAgICAgICBhdHRyaWJ1dGUubmFtZSB8fCBhdHRyaWJ1dGUubm9kZU5hbWUsXG4gICAgICAgIG51bGwsXG4gICAgICAgIGF0dHJpYnV0ZS52YWx1ZSB8fCBhdHRyaWJ1dGUubm9kZVZhbHVlXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gd2hlbkRlZmluZWQobmFtZSkge1xuICAgIG5hbWUgPSBuYW1lLnRvVXBwZXJDYXNlKCk7XG4gICAgaWYgKCEobmFtZSBpbiB3YWl0aW5nTGlzdCkpIHtcbiAgICAgIHdhaXRpbmdMaXN0W25hbWVdID0ge307XG4gICAgICB3YWl0aW5nTGlzdFtuYW1lXS5wID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgd2FpdGluZ0xpc3RbbmFtZV0uciA9IHJlc29sdmU7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHdhaXRpbmdMaXN0W25hbWVdLnA7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHBvbHlmaWxsVjEoKSB7XG4gICAgaWYgKGN1c3RvbUVsZW1lbnRzKSBkZWxldGUgd2luZG93LmN1c3RvbUVsZW1lbnRzO1xuICAgIGRlZmluZVByb3BlcnR5KHdpbmRvdywgJ2N1c3RvbUVsZW1lbnRzJywge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IG5ldyBDdXN0b21FbGVtZW50UmVnaXN0cnkoKVxuICAgIH0pO1xuICAgIGRlZmluZVByb3BlcnR5KHdpbmRvdywgJ0N1c3RvbUVsZW1lbnRSZWdpc3RyeScsIHtcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHZhbHVlOiBDdXN0b21FbGVtZW50UmVnaXN0cnlcbiAgICB9KTtcbiAgICBmb3IgKHZhclxuICAgICAgcGF0Y2hDbGFzcyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBDbGFzcyA9IHdpbmRvd1tuYW1lXTtcbiAgICAgICAgaWYgKENsYXNzKSB7XG4gICAgICAgICAgd2luZG93W25hbWVdID0gZnVuY3Rpb24gQ3VzdG9tRWxlbWVudHNWMShzZWxmKSB7XG4gICAgICAgICAgICB2YXIgaW5mbywgaXNOYXRpdmU7XG4gICAgICAgICAgICBpZiAoIXNlbGYpIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKCFzZWxmW0RSRUNFVjFdKSB7XG4gICAgICAgICAgICAgIGp1c3RDcmVhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgaW5mbyA9IGNvbnN0cnVjdG9yc1tub2RlTmFtZXMuZ2V0KHNlbGYuY29uc3RydWN0b3IpXTtcbiAgICAgICAgICAgICAgaXNOYXRpdmUgPSB1c2FibGVDdXN0b21FbGVtZW50cyAmJiBpbmZvLmNyZWF0ZS5sZW5ndGggPT09IDE7XG4gICAgICAgICAgICAgIHNlbGYgPSBpc05hdGl2ZSA/XG4gICAgICAgICAgICAgICAgUmVmbGVjdC5jb25zdHJ1Y3QoQ2xhc3MsIGVtcHR5LCBpbmZvLmNvbnN0cnVjdG9yKSA6XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudC5hcHBseShkb2N1bWVudCwgaW5mby5jcmVhdGUpO1xuICAgICAgICAgICAgICBzZWxmW0RSRUNFVjFdID0gdHJ1ZTtcbiAgICAgICAgICAgICAganVzdENyZWF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgaWYgKCFpc05hdGl2ZSkgbm90aWZ5QXR0cmlidXRlcyhzZWxmKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzZWxmO1xuICAgICAgICAgIH07XG4gICAgICAgICAgd2luZG93W25hbWVdLnByb3RvdHlwZSA9IENsYXNzLnByb3RvdHlwZTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gd2luZG93W25hbWVdO1xuICAgICAgICAgIH0gY2F0Y2goV2ViS2l0KSB7XG4gICAgICAgICAgICBmaXhHZXRDbGFzcyA9IHRydWU7XG4gICAgICAgICAgICBkZWZpbmVQcm9wZXJ0eShDbGFzcywgRFJFQ0VWMSwge3ZhbHVlOiB3aW5kb3dbbmFtZV19KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBDbGFzc2VzID0gaHRtbENsYXNzLmdldCgvXkhUTUxbQS1aXSpbYS16XS8pLFxuICAgICAgaSA9IENsYXNzZXMubGVuZ3RoO1xuICAgICAgaS0tO1xuICAgICAgcGF0Y2hDbGFzcyhDbGFzc2VzW2ldKVxuICAgICkge31cbiAgICAoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCA9IGZ1bmN0aW9uIChuYW1lLCBvcHRpb25zKSB7XG4gICAgICB2YXIgaXMgPSBnZXRJcyhvcHRpb25zKTtcbiAgICAgIHJldHVybiBpcyA/XG4gICAgICAgIHBhdGNoZWRDcmVhdGVFbGVtZW50LmNhbGwodGhpcywgbmFtZSwgc2Vjb25kQXJndW1lbnQoaXMpKSA6XG4gICAgICAgIHBhdGNoZWRDcmVhdGVFbGVtZW50LmNhbGwodGhpcywgbmFtZSk7XG4gICAgfSk7XG4gICAgaWYgKCFWMCkge1xuICAgICAganVzdFNldHVwID0gdHJ1ZTtcbiAgICAgIGRvY3VtZW50W1JFR0lTVEVSX0VMRU1FTlRdKCcnKTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIGlmIGN1c3RvbUVsZW1lbnRzIGlzIG5vdCB0aGVyZSBhdCBhbGxcbiAgaWYgKCFjdXN0b21FbGVtZW50cyB8fCBwb2x5ZmlsbCA9PT0gJ2ZvcmNlJykgcG9seWZpbGxWMSgpO1xuICBlbHNlIHtcbiAgICAvLyBpZiBhdmFpbGFibGUgdGVzdCBleHRlbmRzIHdvcmsgYXMgZXhwZWN0ZWRcbiAgICB0cnkge1xuICAgICAgKGZ1bmN0aW9uIChEUkUsIG9wdGlvbnMsIG5hbWUpIHtcbiAgICAgICAgb3B0aW9uc1tFWFRFTkRTXSA9ICdhJztcbiAgICAgICAgRFJFLnByb3RvdHlwZSA9IGNyZWF0ZShIVE1MQW5jaG9yRWxlbWVudC5wcm90b3R5cGUpO1xuICAgICAgICBEUkUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRFJFO1xuICAgICAgICB3aW5kb3cuY3VzdG9tRWxlbWVudHMuZGVmaW5lKG5hbWUsIERSRSwgb3B0aW9ucyk7XG4gICAgICAgIGlmIChcbiAgICAgICAgICBnZXRBdHRyaWJ1dGUuY2FsbChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJywge2lzOiBuYW1lfSksICdpcycpICE9PSBuYW1lIHx8XG4gICAgICAgICAgKHVzYWJsZUN1c3RvbUVsZW1lbnRzICYmIGdldEF0dHJpYnV0ZS5jYWxsKG5ldyBEUkUoKSwgJ2lzJykgIT09IG5hbWUpXG4gICAgICAgICkge1xuICAgICAgICAgIHRocm93IG9wdGlvbnM7XG4gICAgICAgIH1cbiAgICAgIH0oXG4gICAgICAgIGZ1bmN0aW9uIERSRSgpIHtcbiAgICAgICAgICByZXR1cm4gUmVmbGVjdC5jb25zdHJ1Y3QoSFRNTEFuY2hvckVsZW1lbnQsIFtdLCBEUkUpO1xuICAgICAgICB9LFxuICAgICAgICB7fSxcbiAgICAgICAgJ2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQtYSdcbiAgICAgICkpO1xuICAgIH0gY2F0Y2gob19PKSB7XG4gICAgICAvLyBvciBmb3JjZSB0aGUgcG9seWZpbGwgaWYgbm90XG4gICAgICAvLyBhbmQga2VlcCBpbnRlcm5hbCBvcmlnaW5hbCByZWZlcmVuY2VcbiAgICAgIHBvbHlmaWxsVjEoKTtcbiAgICB9XG4gIH1cbiAgXG4gIHRyeSB7XG4gICAgY3JlYXRlRWxlbWVudC5jYWxsKGRvY3VtZW50LCAnYScsICdhJyk7XG4gIH0gY2F0Y2goRmlyZUZveCkge1xuICAgIHNlY29uZEFyZ3VtZW50ID0gZnVuY3Rpb24gKGlzKSB7XG4gICAgICByZXR1cm4ge2lzOiBpcy50b0xvd2VyQ2FzZSgpfTtcbiAgICB9O1xuICB9XG4gIFxufVxuXG5leHBvcnRzLmluc3RhbGxDdXN0b21FbGVtZW50cyA9IGluc3RhbGxDdXN0b21FbGVtZW50cztcblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIENvbnN0cnVjdHMgYSBFUzYvUHJvbWlzZXMgQSsgUHJvbWlzZSBpbnN0YW5jZS5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oZnVuY3Rpb24oKj0pLCBmdW5jdGlvbiAoKj0pKX0gcmVzb2x2ZXJcbiAqL1xuZnVuY3Rpb24gUHJvbWlzZShyZXNvbHZlcikge1xuICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDb25zdHJ1Y3RvciBQcm9taXNlIHJlcXVpcmVzIGBuZXdgJyk7XG4gIH1cbiAgaWYgKCFpc0Z1bmN0aW9uKHJlc29sdmVyKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ011c3QgcGFzcyByZXNvbHZlciBmdW5jdGlvbicpO1xuICB9XG5cbiAgLyoqXG4gICAqIEB0eXBlIHtmdW5jdGlvbih0aGlzOlByb21pc2UsKj0sZnVuY3Rpb24oKj0pLGZ1bmN0aW9uKCo9KSxEZWZlcnJlZCk6IVByb21pc2V9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB0aGlzLl9zdGF0ZSA9IFBlbmRpbmdQcm9taXNlO1xuXG4gIC8qKlxuICAgKiBAdHlwZSB7Kn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHRoaXMuX3ZhbHVlID0gW107XG5cbiAgLyoqXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGhpcy5faXNDaGFpbkVuZCA9IHRydWU7XG5cbiAgZG9SZXNvbHZlKFxuICAgIHRoaXMsXG4gICAgYWRvcHRlcih0aGlzLCBGdWxmaWxsZWRQcm9taXNlKSxcbiAgICBhZG9wdGVyKHRoaXMsIFJlamVjdGVkUHJvbWlzZSksXG4gICAgeyB0aGVuOiByZXNvbHZlciB9XG4gICk7XG59XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gIFB1YmxpYyBJbnN0YW5jZSBNZXRob2RzXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHByb21pc2UgaW5zdGFuY2UgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIHJlc3VsdCBvZiB0aGlzIHByb21pc2VcbiAqIGFzIGlucHV0cyB0byB0aGUgb25GdWxmaWxsZWQgb3Igb25SZWplY3RlZCBjYWxsYmFja3MuXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbigqKX0gb25GdWxmaWxsZWRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKil9IG9uUmVqZWN0ZWRcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7XG4gIG9uRnVsZmlsbGVkID0gaXNGdW5jdGlvbihvbkZ1bGZpbGxlZCkgPyBvbkZ1bGZpbGxlZCA6IHZvaWQgMDtcbiAgb25SZWplY3RlZCA9IGlzRnVuY3Rpb24ob25SZWplY3RlZCkgPyBvblJlamVjdGVkIDogdm9pZCAwO1xuXG4gIGlmIChvbkZ1bGZpbGxlZCB8fCBvblJlamVjdGVkKSB7XG4gICAgdGhpcy5faXNDaGFpbkVuZCA9IGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHRoaXMuX3N0YXRlKFxuICAgIHRoaXMuX3ZhbHVlLFxuICAgIG9uRnVsZmlsbGVkLFxuICAgIG9uUmVqZWN0ZWRcbiAgKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBwcm9taXNlIHRoYXQgd2lsbCBoYW5kbGUgdGhlIHJlamVjdGVkIHN0YXRlIG9mIHRoaXMgcHJvbWlzZS5cbiAqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCopfSBvblJlamVjdGVkXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cblByb21pc2UucHJvdG90eXBlLmNhdGNoID0gZnVuY3Rpb24ob25SZWplY3RlZCkge1xuICByZXR1cm4gdGhpcy50aGVuKHZvaWQgMCwgb25SZWplY3RlZCk7XG59O1xuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICBQdWJsaWMgU3RhdGljIE1ldGhvZHNcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4vKipcbiAqIENyZWF0ZXMgYSBmdWxmaWxsZWQgUHJvbWlzZSBvZiB2YWx1ZS4gSWYgdmFsdWUgaXMgaXRzZWxmIGEgdGhlbi1hYmxlLFxuICogcmVzb2x2ZXMgd2l0aCB0aGUgdGhlbi1hYmxlJ3MgdmFsdWUuXG4gKlxuICogQHRoaXMgeyFQcm9taXNlfVxuICogQHBhcmFtIHsqPX0gdmFsdWVcbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuUHJvbWlzZS5yZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcbiAgdmFyIHByb21pc2U7XG5cbiAgaWYgKGlzT2JqZWN0KHZhbHVlKSAmJiB2YWx1ZSBpbnN0YW5jZW9mIHRoaXMpIHtcbiAgICBwcm9taXNlID0gdmFsdWU7XG4gIH0gZWxzZSB7XG4gICAgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICByZXNvbHZlKHZhbHVlKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlfSAqLyhwcm9taXNlKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIHJlamVjdGVkIFByb21pc2Ugb2YgcmVhc29uLlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX1cbiAqIEBwYXJhbSB7Kj19IHJlYXNvblxuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5Qcm9taXNlLnJlamVjdCA9IGZ1bmN0aW9uKHJlYXNvbikge1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbihfLCByZWplY3QpIHtcbiAgICByZWplY3QocmVhc29uKTtcbiAgfSk7XG5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2V9ICovKHByb21pc2UpO1xufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgUHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB3aXRoIGFuIGFycmF5IG9mIHRoZSB2YWx1ZXMgb2YgdGhlXG4gKiBwYXNzZWQgaW4gcHJvbWlzZXMuIElmIGFueSBwcm9taXNlIHJlamVjdHMsIHRoZSByZXR1cm5lZCBwcm9taXNlIHdpbGxcbiAqIHJlamVjdC5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9XG4gKiBAcGFyYW0geyFBcnJheTxQcm9taXNlfCo+fSBwcm9taXNlc1xuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5Qcm9taXNlLmFsbCA9IGZ1bmN0aW9uKHByb21pc2VzKSB7XG4gIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG4gIHZhciBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHZhciBsZW5ndGggPSBwcm9taXNlcy5sZW5ndGg7XG4gICAgdmFyIHZhbHVlcyA9IG5ldyBBcnJheShsZW5ndGgpO1xuXG4gICAgaWYgKGxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHJlc29sdmUodmFsdWVzKTtcbiAgICB9XG5cbiAgICBlYWNoKHByb21pc2VzLCBmdW5jdGlvbihwcm9taXNlLCBpbmRleCkge1xuICAgICAgQ29uc3RydWN0b3IucmVzb2x2ZShwcm9taXNlKS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgaWYgKC0tbGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgcmVzb2x2ZSh2YWx1ZXMpO1xuICAgICAgICB9XG4gICAgICB9LCByZWplY3QpO1xuICAgIH0pO1xuICB9KTtcblxuICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZX0gKi8ocHJvbWlzZSk7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBQcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIG9yIHJlamVjdCBiYXNlZCBvbiB0aGUgZmlyc3RcbiAqIHJlc29sdmVkIG9yIHJlamVjdGVkIHByb21pc2UuXG4gKlxuICogQHRoaXMgeyFQcm9taXNlfVxuICogQHBhcmFtIHshQXJyYXk8UHJvbWlzZXwqPn0gcHJvbWlzZXNcbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuUHJvbWlzZS5yYWNlID0gZnVuY3Rpb24ocHJvbWlzZXMpIHtcbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcbiAgdmFyIHByb21pc2UgPSBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9taXNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgQ29uc3RydWN0b3IucmVzb2x2ZShwcm9taXNlc1tpXSkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2V9ICovKHByb21pc2UpO1xufTtcblxudmFyIG9uUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gPSBmdW5jdGlvbihyZWFzb24sIHByb21pc2UpIHtcbiAgdGhyb3cgcmVhc29uO1xufTtcblxuLyoqXG4gKiBBbiBpbnRlcm5hbCB1c2Ugc3RhdGljIGZ1bmN0aW9uLlxuICovXG5Qcm9taXNlLl9vdmVycmlkZVVuaGFuZGxlZEV4Y2VwdGlvbkhhbmRsZXIgPSBmdW5jdGlvbihoYW5kbGVyKSB7XG4gIG9uUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gPSBoYW5kbGVyO1xufTtcblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgUHJpdmF0ZSBmdW5jdGlvbnNcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4vKipcbiAqIFRoZSBGdWxmaWxsZWQgUHJvbWlzZSBzdGF0ZS4gQ2FsbHMgb25GdWxmaWxsZWQgd2l0aCB0aGUgcmVzb2x2ZWQgdmFsdWUgb2ZcbiAqIHRoaXMgcHJvbWlzZSwgY3JlYXRpbmcgYSBuZXcgcHJvbWlzZS5cbiAqXG4gKiBJZiB0aGVyZSBpcyBubyBvbkZ1bGZpbGxlZCwgcmV0dXJucyB0aGUgY3VycmVudCBwcm9taXNlIHRvIGF2b2lkIGFuIHByb21pc2VcbiAqIGluc3RhbmNlLlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX0gVGhlIGN1cnJlbnQgcHJvbWlzZVxuICogQHBhcmFtIHsqPX0gdmFsdWUgVGhlIGN1cnJlbnQgcHJvbWlzZSdzIHJlc29sdmVkIHZhbHVlLlxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSBvbkZ1bGZpbGxlZFxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSB1bnVzZWRcbiAqIEBwYXJhbSB7RGVmZXJyZWR9IGRlZmVycmVkIEEgZGVmZXJyZWQgb2JqZWN0IHRoYXQgaG9sZHMgYSBwcm9taXNlIGFuZCBpdHNcbiAqICAgICByZXNvbHZlIGFuZCByZWplY3QgZnVuY3Rpb25zLiBJdCBJUyBOT1QgcGFzc2VkIHdoZW4gY2FsbGVkIGZyb21cbiAqICAgICBQcm9taXNlI3RoZW4gdG8gc2F2ZSBhbiBvYmplY3QgaW5zdGFuY2UgKHNpbmNlIHdlIG1heSByZXR1cm4gdGhlIGN1cnJlbnRcbiAqICAgICBwcm9taXNlKS4gSXQgSVMgcGFzc2VkIGluIHdoZW4gYWRvcHRpbmcgdGhlIEZ1bGZpbGxlZCBzdGF0ZSBmcm9tIHRoZVxuICogICAgIFBlbmRpbmcgc3RhdGUuXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cbmZ1bmN0aW9uIEZ1bGZpbGxlZFByb21pc2UodmFsdWUsIG9uRnVsZmlsbGVkLCB1bnVzZWQsIGRlZmVycmVkKSB7XG4gIGlmICghb25GdWxmaWxsZWQpIHtcbiAgICBkZWZlcnJlZEFkb3B0KGRlZmVycmVkLCBGdWxmaWxsZWRQcm9taXNlLCB2YWx1ZSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgaWYgKCFkZWZlcnJlZCkge1xuICAgIGRlZmVycmVkID0gbmV3IERlZmVycmVkKHRoaXMuY29uc3RydWN0b3IpO1xuICB9XG4gIGRlZmVyKHRyeUNhdGNoRGVmZXJyZWQoZGVmZXJyZWQsIG9uRnVsZmlsbGVkLCB2YWx1ZSkpO1xuICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbn1cblxuLyoqXG4gKiBUaGUgUmVqZWN0ZWQgUHJvbWlzZSBzdGF0ZS4gQ2FsbHMgb25SZWplY3RlZCB3aXRoIHRoZSByZXNvbHZlZCB2YWx1ZSBvZlxuICogdGhpcyBwcm9taXNlLCBjcmVhdGluZyBhIG5ldyBwcm9taXNlLlxuICpcbiAqIElmIHRoZXJlIGlzIG5vIG9uUmVqZWN0ZWQsIHJldHVybnMgdGhlIGN1cnJlbnQgcHJvbWlzZSB0byBhdm9pZCBhbiBwcm9taXNlXG4gKiBpbnN0YW5jZS5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9IFRoZSBjdXJyZW50IHByb21pc2VcbiAqIEBwYXJhbSB7Kj19IHJlYXNvbiBUaGUgY3VycmVudCBwcm9taXNlJ3MgcmVqZWN0aW9uIHJlYXNvbi5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0pPX0gdW51c2VkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IG9uUmVqZWN0ZWRcbiAqIEBwYXJhbSB7RGVmZXJyZWR9IGRlZmVycmVkIEEgZGVmZXJyZWQgb2JqZWN0IHRoYXQgaG9sZHMgYSBwcm9taXNlIGFuZCBpdHNcbiAqICAgICByZXNvbHZlIGFuZCByZWplY3QgZnVuY3Rpb25zLiBJdCBJUyBOT1QgcGFzc2VkIHdoZW4gY2FsbGVkIGZyb21cbiAqICAgICBQcm9taXNlI3RoZW4gdG8gc2F2ZSBhbiBvYmplY3QgaW5zdGFuY2UgKHNpbmNlIHdlIG1heSByZXR1cm4gdGhlIGN1cnJlbnRcbiAqICAgICBwcm9taXNlKS4gSXQgSVMgcGFzc2VkIGluIHdoZW4gYWRvcHRpbmcgdGhlIFJlamVjdGVkIHN0YXRlIGZyb20gdGhlXG4gKiAgICAgUGVuZGluZyBzdGF0ZS5cbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gUmVqZWN0ZWRQcm9taXNlKHJlYXNvbiwgdW51c2VkLCBvblJlamVjdGVkLCBkZWZlcnJlZCkge1xuICBpZiAoIW9uUmVqZWN0ZWQpIHtcbiAgICBkZWZlcnJlZEFkb3B0KGRlZmVycmVkLCBSZWplY3RlZFByb21pc2UsIHJlYXNvbik7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgaWYgKCFkZWZlcnJlZCkge1xuICAgIGRlZmVycmVkID0gbmV3IERlZmVycmVkKHRoaXMuY29uc3RydWN0b3IpO1xuICB9XG4gIGRlZmVyKHRyeUNhdGNoRGVmZXJyZWQoZGVmZXJyZWQsIG9uUmVqZWN0ZWQsIHJlYXNvbikpO1xuICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbn1cblxuLyoqXG4gKiBUaGUgUGVuZGluZyBQcm9taXNlIHN0YXRlLiBFdmVudHVhbGx5IGNhbGxzIG9uRnVsZmlsbGVkIG9uY2UgdGhlIHByb21pc2UgaGFzXG4gKiByZXNvbHZlZCwgb3Igb25SZWplY3RlZCBvbmNlIHRoZSBwcm9taXNlIHJlamVjdHMuXG4gKlxuICogSWYgdGhlcmUgaXMgbm8gb25GdWxmaWxsZWQgYW5kIG5vIG9uUmVqZWN0ZWQsIHJldHVybnMgdGhlIGN1cnJlbnQgcHJvbWlzZSB0b1xuICogYXZvaWQgYW4gcHJvbWlzZSBpbnN0YW5jZS5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9IFRoZSBjdXJyZW50IHByb21pc2VcbiAqIEBwYXJhbSB7Kj19IHF1ZXVlIFRoZSBjdXJyZW50IHByb21pc2UncyBwZW5kaW5nIHByb21pc2VzIHF1ZXVlLlxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSBvbkZ1bGZpbGxlZFxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSBvblJlamVjdGVkXG4gKiBAcGFyYW0ge0RlZmVycmVkfSBkZWZlcnJlZCBBIGRlZmVycmVkIG9iamVjdCB0aGF0IGhvbGRzIGEgcHJvbWlzZSBhbmQgaXRzXG4gKiAgICAgcmVzb2x2ZSBhbmQgcmVqZWN0IGZ1bmN0aW9ucy4gSXQgSVMgTk9UIHBhc3NlZCB3aGVuIGNhbGxlZCBmcm9tXG4gKiAgICAgUHJvbWlzZSN0aGVuIHRvIHNhdmUgYW4gb2JqZWN0IGluc3RhbmNlIChzaW5jZSB3ZSBtYXkgcmV0dXJuIHRoZSBjdXJyZW50XG4gKiAgICAgcHJvbWlzZSkuIEl0IElTIHBhc3NlZCBpbiB3aGVuIGFkb3B0aW5nIHRoZSBQZW5kaW5nIHN0YXRlIGZyb20gdGhlXG4gKiAgICAgUGVuZGluZyBzdGF0ZSBvZiBhbm90aGVyIHByb21pc2UuXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cbmZ1bmN0aW9uIFBlbmRpbmdQcm9taXNlKHF1ZXVlLCBvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCwgZGVmZXJyZWQpIHtcbiAgaWYgKCFkZWZlcnJlZCkge1xuICAgIGlmICghb25GdWxmaWxsZWQgJiYgIW9uUmVqZWN0ZWQpIHsgcmV0dXJuIHRoaXM7IH1cbiAgICBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCh0aGlzLmNvbnN0cnVjdG9yKTtcbiAgfVxuICBxdWV1ZS5wdXNoKHtcbiAgICBkZWZlcnJlZDogZGVmZXJyZWQsXG4gICAgb25GdWxmaWxsZWQ6IG9uRnVsZmlsbGVkIHx8IGRlZmVycmVkLnJlc29sdmUsXG4gICAgb25SZWplY3RlZDogb25SZWplY3RlZCB8fCBkZWZlcnJlZC5yZWplY3RcbiAgfSk7XG4gIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xufVxuXG4vKipcbiAqIENvbnN0cnVjdHMgYSBkZWZlcnJlZCBpbnN0YW5jZSB0aGF0IGhvbGRzIGEgcHJvbWlzZSBhbmQgaXRzIHJlc29sdmUgYW5kXG4gKiByZWplY3QgZnVuY3Rpb25zLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBEZWZlcnJlZChQcm9taXNlKSB7XG4gIHZhciBkZWZlcnJlZCA9IHRoaXM7XG4gIC8qKiBAdHlwZSB7IVByb21pc2V9ICovXG4gIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIC8qKiBAdHlwZSB7ZnVuY3Rpb24oKj0pfSAqL1xuICAgIGRlZmVycmVkLnJlc29sdmUgPSByZXNvbHZlO1xuXG4gICAgLyoqIEB0eXBlIHtmdW5jdGlvbigqPSl9ICovXG4gICAgZGVmZXJyZWQucmVqZWN0ID0gcmVqZWN0O1xuICB9KTtcbiAgcmV0dXJuIGRlZmVycmVkO1xufVxuXG4vKipcbiAqIFRyYW5zaXRpb25zIHRoZSBzdGF0ZSBvZiBwcm9taXNlIHRvIGFub3RoZXIgc3RhdGUuIFRoaXMgaXMgb25seSBldmVyIGNhbGxlZFxuICogb24gd2l0aCBhIHByb21pc2UgdGhhdCBpcyBjdXJyZW50bHkgaW4gdGhlIFBlbmRpbmcgc3RhdGUuXG4gKlxuICogQHBhcmFtIHshUHJvbWlzZX0gcHJvbWlzZVxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlByb21pc2UsKj0sZnVuY3Rpb24oKj0pLGZ1bmN0aW9uKCo9KSxEZWZlcnJlZCk6IVByb21pc2V9IHN0YXRlXG4gKiBAcGFyYW0geyo9fSB2YWx1ZVxuICovXG5mdW5jdGlvbiBhZG9wdChwcm9taXNlLCBzdGF0ZSwgdmFsdWUsIGFkb3B0ZWUpIHtcbiAgdmFyIHF1ZXVlID0gcHJvbWlzZS5fdmFsdWU7XG4gIHByb21pc2UuX3N0YXRlID0gc3RhdGU7XG4gIHByb21pc2UuX3ZhbHVlID0gdmFsdWU7XG5cbiAgaWYgKGFkb3B0ZWUgJiYgc3RhdGUgPT09IFBlbmRpbmdQcm9taXNlKSB7XG4gICAgYWRvcHRlZS5fc3RhdGUodmFsdWUsIHZvaWQgMCwgdm9pZCAwLCB7XG4gICAgICBwcm9taXNlOiBwcm9taXNlLFxuICAgICAgcmVzb2x2ZTogdm9pZCAwLFxuICAgICAgcmVqZWN0OiB2b2lkIDBcbiAgICB9KTtcbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgbmV4dCA9IHF1ZXVlW2ldO1xuICAgIHByb21pc2UuX3N0YXRlKFxuICAgICAgdmFsdWUsXG4gICAgICBuZXh0Lm9uRnVsZmlsbGVkLFxuICAgICAgbmV4dC5vblJlamVjdGVkLFxuICAgICAgbmV4dC5kZWZlcnJlZFxuICAgICk7XG4gIH1cbiAgcXVldWUubGVuZ3RoID0gMDtcblxuICAvLyBEZXRlcm1pbmUgaWYgdGhpcyByZWplY3RlZCBwcm9taXNlIHdpbGwgYmUgXCJoYW5kbGVkXCIuXG4gIGlmIChzdGF0ZSA9PT0gUmVqZWN0ZWRQcm9taXNlICYmIHByb21pc2UuX2lzQ2hhaW5FbmQpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHByb21pc2UuX2lzQ2hhaW5FbmQpIHtcbiAgICAgICAgb25Qb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbih2YWx1ZSwgcHJvbWlzZSk7XG4gICAgICB9XG4gICAgfSwgMCk7XG4gIH1cbn1cblxuLyoqXG4gKiBBIHBhcnRpYWwgYXBwbGljYXRpb24gb2YgYWRvcHQuXG4gKlxuICogQHBhcmFtIHshUHJvbWlzZX0gcHJvbWlzZVxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlByb21pc2UsKj0sZnVuY3Rpb24oKj0pLGZ1bmN0aW9uKCo9KSxEZWZlcnJlZCk6IVByb21pc2V9IHN0YXRlXG4gKiBAcmV0dXJucyB7ZnVuY3Rpb24oKj0pfVxuICovXG5mdW5jdGlvbiBhZG9wdGVyKHByb21pc2UsIHN0YXRlKSB7XG4gIHJldHVybiBmdW5jdGlvbih2YWx1ZSkge1xuICAgIGFkb3B0KHByb21pc2UsIHN0YXRlLCB2YWx1ZSk7XG4gIH07XG59XG5cbi8qKlxuICogVXBkYXRlcyBhIGRlZmVycmVkIHByb21pc2VzIHN0YXRlLiBOZWNlc3NhcnkgZm9yIHVwZGF0aW5nIGFuIGFkb3B0aW5nXG4gKiBwcm9taXNlJ3Mgc3RhdGUgd2hlbiB0aGUgYWRvcHRlZSByZXNvbHZlcy5cbiAqXG4gKiBAcGFyYW0gez9EZWZlcnJlZH0gZGVmZXJyZWRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24odGhpczpQcm9taXNlLCo9LGZ1bmN0aW9uKCo9KSxmdW5jdGlvbigqPSksRGVmZXJyZWQpOiFQcm9taXNlfSBzdGF0ZVxuICogQHBhcmFtIHsqPX0gdmFsdWVcbiAqL1xuZnVuY3Rpb24gZGVmZXJyZWRBZG9wdChkZWZlcnJlZCwgc3RhdGUsIHZhbHVlKSB7XG4gIGlmIChkZWZlcnJlZCkge1xuICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICBwcm9taXNlLl9zdGF0ZSA9IHN0YXRlO1xuICAgIHByb21pc2UuX3ZhbHVlID0gdmFsdWU7XG4gIH1cbn1cblxuLyoqXG4gKiBBIG5vLW9wIGZ1bmN0aW9uIHRvIHByZXZlbnQgZG91YmxlIHJlc29sdmluZy5cbiAqL1xuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbi8qKlxuICogVGVzdHMgaWYgZm4gaXMgYSBGdW5jdGlvblxuICpcbiAqIEBwYXJhbSB7Kn0gZm5cbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc0Z1bmN0aW9uKGZuKSB7XG4gIHJldHVybiB0eXBlb2YgZm4gPT09ICdmdW5jdGlvbic7XG59XG5cbi8qKlxuICogVGVzdHMgaWYgZm4gaXMgYW4gT2JqZWN0XG4gKlxuICogQHBhcmFtIHsqfSBvYmpcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc09iamVjdChvYmopIHtcbiAgcmV0dXJuIG9iaiA9PT0gT2JqZWN0KG9iaik7XG59XG5cbi8qKlxuICogSXRlcmF0ZXMgb3ZlciBlYWNoIGVsZW1lbnQgb2YgYW4gYXJyYXksIGNhbGxpbmcgdGhlIGl0ZXJhdG9yIHdpdGggdGhlXG4gKiBlbGVtZW50IGFuZCBpdHMgaW5kZXguXG4gKlxuICogQHBhcmFtIHshQXJyYXl9IGNvbGxlY3Rpb25cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0sbnVtYmVyKX0gaXRlcmF0b3JcbiAqL1xuZnVuY3Rpb24gZWFjaChjb2xsZWN0aW9uLCBpdGVyYXRvcikge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbGxlY3Rpb24ubGVuZ3RoOyBpKyspIHtcbiAgICBpdGVyYXRvcihjb2xsZWN0aW9uW2ldLCBpKTtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgYXR0ZW1wdCB0byByZXNvbHZlIHRoZSBkZWZlcnJlZCB3aXRoIHRoZSByZXR1cm5cbiAqIG9mIGZuLiBJZiBhbnkgZXJyb3IgaXMgcmFpc2VkLCByZWplY3RzIGluc3RlYWQuXG4gKlxuICogQHBhcmFtIHshRGVmZXJyZWR9IGRlZmVycmVkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KX0gZm5cbiAqIEBwYXJhbSB7Kn0gYXJnXG4gKiBAcmV0dXJucyB7ZnVuY3Rpb24oKX1cbiAqL1xuZnVuY3Rpb24gdHJ5Q2F0Y2hEZWZlcnJlZChkZWZlcnJlZCwgZm4sIGFyZykge1xuICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gIHZhciByZXNvbHZlID0gZGVmZXJyZWQucmVzb2x2ZTtcbiAgdmFyIHJlamVjdCA9IGRlZmVycmVkLnJlamVjdDtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHRyeSB7XG4gICAgICB2YXIgcmVzdWx0ID0gZm4oYXJnKTtcbiAgICAgIGRvUmVzb2x2ZShwcm9taXNlLCByZXNvbHZlLCByZWplY3QsIHJlc3VsdCwgcmVzdWx0KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZWplY3QoZSk7XG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIFF1ZXVlcyBhbmQgZXhlY3V0ZXMgbXVsdGlwbGUgZGVmZXJyZWQgZnVuY3Rpb25zIG9uIGFub3RoZXIgcnVuIGxvb3AuXG4gKi9cbnZhciBkZWZlciA9IChmdW5jdGlvbigpIHtcbiAgLyoqXG4gICAqIERlZmVycyBmbiB0byBhbm90aGVyIHJ1biBsb29wLlxuICAgKi9cbiAgdmFyIHNjaGVkdWxlRmx1c2g7XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucG9zdE1lc3NhZ2UpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZsdXNoKTtcbiAgICBzY2hlZHVsZUZsdXNoID0gZnVuY3Rpb24oKSB7XG4gICAgICB3aW5kb3cucG9zdE1lc3NhZ2UoJ21hY3JvLXRhc2snLCAnKicpO1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgc2NoZWR1bGVGbHVzaCA9IGZ1bmN0aW9uKCkge1xuICAgICAgc2V0VGltZW91dChmbHVzaCwgMCk7XG4gICAgfTtcbiAgfVxuXG4gIHZhciBxdWV1ZSA9IG5ldyBBcnJheSgxNik7XG4gIHZhciBsZW5ndGggPSAwO1xuXG4gIGZ1bmN0aW9uIGZsdXNoKCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBmbiA9IHF1ZXVlW2ldO1xuICAgICAgcXVldWVbaV0gPSBudWxsO1xuICAgICAgZm4oKTtcbiAgICB9XG4gICAgbGVuZ3RoID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGZuXG4gICAqL1xuICBmdW5jdGlvbiBkZWZlcihmbikge1xuICAgIGlmIChsZW5ndGggPT09IDApIHsgc2NoZWR1bGVGbHVzaCgpOyB9XG4gICAgcXVldWVbbGVuZ3RoKytdID0gZm47XG4gIH1cblxuICByZXR1cm4gZGVmZXI7XG59KSgpO1xuXG4vKipcbiAqIFRoZSBQcm9taXNlIHJlc29sdXRpb24gcHJvY2VkdXJlLlxuICogaHR0cHM6Ly9naXRodWIuY29tL3Byb21pc2VzLWFwbHVzL3Byb21pc2VzLXNwZWMjdGhlLXByb21pc2UtcmVzb2x1dGlvbi1wcm9jZWR1cmVcbiAqXG4gKiBAcGFyYW0geyFQcm9taXNlfSBwcm9taXNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KX0gcmVzb2x2ZVxuICogQHBhcmFtIHtmdW5jdGlvbigqPSl9IHJlamVjdFxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHBhcmFtIHsqPX0gY29udGV4dFxuICovXG5mdW5jdGlvbiBkb1Jlc29sdmUocHJvbWlzZSwgcmVzb2x2ZSwgcmVqZWN0LCB2YWx1ZSwgY29udGV4dCkge1xuICB2YXIgX3JlamVjdCA9IHJlamVjdDtcbiAgdmFyIHRoZW47XG4gIHZhciBfcmVzb2x2ZTtcbiAgdHJ5IHtcbiAgICBpZiAodmFsdWUgPT09IHByb21pc2UpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBmdWxmaWxsIHByb21pc2Ugd2l0aCBpdHNlbGYnKTtcbiAgICB9XG4gICAgdmFyIGlzT2JqID0gaXNPYmplY3QodmFsdWUpO1xuICAgIGlmIChpc09iaiAmJiB2YWx1ZSBpbnN0YW5jZW9mIHByb21pc2UuY29uc3RydWN0b3IpIHtcbiAgICAgIGFkb3B0KHByb21pc2UsIHZhbHVlLl9zdGF0ZSwgdmFsdWUuX3ZhbHVlLCB2YWx1ZSk7XG4gICAgfSBlbHNlIGlmIChpc09iaiAmJiAodGhlbiA9IHZhbHVlLnRoZW4pICYmIGlzRnVuY3Rpb24odGhlbikpIHtcbiAgICAgIF9yZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgX3Jlc29sdmUgPSBfcmVqZWN0ID0gbm9vcDtcbiAgICAgICAgZG9SZXNvbHZlKHByb21pc2UsIHJlc29sdmUsIHJlamVjdCwgdmFsdWUsIHZhbHVlKTtcbiAgICAgIH07XG4gICAgICBfcmVqZWN0ID0gZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgIF9yZXNvbHZlID0gX3JlamVjdCA9IG5vb3A7XG4gICAgICAgIHJlamVjdChyZWFzb24pO1xuICAgICAgfTtcbiAgICAgIHRoZW4uY2FsbChcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgZnVuY3Rpb24odmFsdWUpIHsgX3Jlc29sdmUodmFsdWUpOyB9LFxuICAgICAgICBmdW5jdGlvbihyZWFzb24pIHsgX3JlamVjdChyZWFzb24pOyB9XG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXNvbHZlKHZhbHVlKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBfcmVqZWN0KGUpO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gUHJvbWlzZTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuL3NlcnZpY2VzJztcblxuLyoqXG4gKiBIZWxwZXIgbWV0aG9kIHRvIHRyaWdnZXIgYW5hbHl0aWNzIGV2ZW50IGlmIGFtcC1hbmFseXRpY3MgaXMgYXZhaWxhYmxlLlxuICogVE9ETzogRG8gbm90IGV4cG9zZSB0aGlzIGZ1bmN0aW9uXG4gKiBAcGFyYW0geyFFbGVtZW50fSB0YXJnZXRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz49fSBvcHRfdmFycyBBIG1hcCBvZiB2YXJzIGFuZCB0aGVpciB2YWx1ZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmlnZ2VyQW5hbHl0aWNzRXZlbnQodGFyZ2V0LCBldmVudFR5cGUsIG9wdF92YXJzKSB7XG4gIFNlcnZpY2VzLmFuYWx5dGljc0ZvckRvY09yTnVsbCh0YXJnZXQpLnRoZW4oYW5hbHl0aWNzID0+IHtcbiAgICBpZiAoIWFuYWx5dGljcykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhbmFseXRpY3MudHJpZ2dlckV2ZW50Rm9yVGFyZ2V0KHRhcmdldCwgZXZlbnRUeXBlLCBvcHRfdmFycyk7XG4gIH0pO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuLyoqXG4gKiBDb21tb25seSB1c2VkIHNpZ25hbHMgYWNyb3NzIGRpZmZlcmVudCBlbGVtZW50cyBhbmQgZG9jdW1lbnRzLlxuICogQGVudW0ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGNvbnN0IENvbW1vblNpZ25hbHMgPSB7XG5cbiAgLyoqXG4gICAqIFRoZSBlbGVtZW50IGhhcyBiZWVuIGJ1aWx0LlxuICAgKi9cbiAgQlVJTFQ6ICdidWlsdCcsXG5cbiAgLyoqXG4gICAqIFRoZSBpbml0aWFsIGNvbnRlbnRzIG9mIGFuIGVsZW1lbnQvZG9jdW1lbnQvZW1iZWQgaGF2ZSBiZWVuIGxvYWRlZC5cbiAgICovXG4gIElOSV9MT0FEOiAnaW5pLWxvYWQnLFxuXG4gIC8qKlxuICAgKiBUaGUgZWxlbWVudCBoYXMgYmVlbiBsb2FkZWQuXG4gICAqL1xuICBMT0FEX0VORDogJ2xvYWQtZW5kJyxcblxuICAvKipcbiAgICogVGhlIGVsZW1lbnQgaGFzIHN0YXJ0ZWQgbG9hZGluZy5cbiAgICovXG4gIExPQURfU1RBUlQ6ICdsb2FkLXN0YXJ0JyxcblxuICAvKipcbiAgICogUmVuZGVyaW5nIGhhcyBiZWVuIGNvbmZpcm1lZCB0byBoYXZlIGJlZW4gc3RhcnRlZC5cbiAgICovXG4gIFJFTkRFUl9TVEFSVDogJ3JlbmRlci1zdGFydCcsXG5cbiAgLyoqXG4gICAqIFRoZSBlbGVtZW50IGhhcyBiZWVuIHVubGFpZCBvdXQuXG4gICAqL1xuICBVTkxPQUQ6ICd1bmxvYWQnLFxufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEFsbG93cyBmb3IgcnVudGltZSBjb25maWd1cmF0aW9uLiBJbnRlcm5hbGx5LCB0aGUgcnVudGltZSBzaG91bGRcbiAqIHVzZSB0aGUgc3JjL2NvbmZpZy5qcyBtb2R1bGUgZm9yIHZhcmlvdXMgY29uc3RhbnRzLiBXZSBjYW4gdXNlIHRoZVxuICogQU1QX0NPTkZJRyBnbG9iYWwgdG8gdHJhbnNsYXRlIHVzZXItZGVmaW5lZCBjb25maWd1cmF0aW9ucyB0byB0aGlzXG4gKiBtb2R1bGUuXG4gKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59XG4gKi9cbmNvbnN0IGVudiA9IHNlbGYuQU1QX0NPTkZJRyB8fCB7fTtcblxuY29uc3QgdGhpcmRQYXJ0eUZyYW1lUmVnZXggPSB0eXBlb2YgZW52Wyd0aGlyZFBhcnR5RnJhbWVSZWdleCddID09ICdzdHJpbmcnID9cbiAgbmV3IFJlZ0V4cChlbnZbJ3RoaXJkUGFydHlGcmFtZVJlZ2V4J10pIDogZW52Wyd0aGlyZFBhcnR5RnJhbWVSZWdleCddO1xuXG5jb25zdCBjZG5Qcm94eVJlZ2V4ID0gdHlwZW9mIGVudlsnY2RuUHJveHlSZWdleCddID09ICdzdHJpbmcnID9cbiAgbmV3IFJlZ0V4cChlbnZbJ2NkblByb3h5UmVnZXgnXSkgOiBlbnZbJ2NkblByb3h5UmVnZXgnXTtcblxuLyoqIEB0eXBlIHshT2JqZWN0PHN0cmluZywgc3RyaW5nfGJvb2xlYW58UmVnRXhwPn0gKi9cbmV4cG9ydCBjb25zdCB1cmxzID0ge1xuICB0aGlyZFBhcnR5OiBlbnZbJ3RoaXJkUGFydHlVcmwnXSB8fCAnaHR0cHM6Ly8zcC5hbXBwcm9qZWN0Lm5ldCcsXG4gIHRoaXJkUGFydHlGcmFtZUhvc3Q6IGVudlsndGhpcmRQYXJ0eUZyYW1lSG9zdCddIHx8ICdhbXBwcm9qZWN0Lm5ldCcsXG4gIHRoaXJkUGFydHlGcmFtZVJlZ2V4OiB0aGlyZFBhcnR5RnJhbWVSZWdleCB8fCAvXmQtXFxkK1xcLmFtcHByb2plY3RcXC5uZXQkLyxcbiAgY2RuOiBlbnZbJ2NkblVybCddIHx8ICdodHRwczovL2Nkbi5hbXBwcm9qZWN0Lm9yZycsXG4gIC8qIE5vdGUgdGhhdCBjZG5Qcm94eVJlZ2V4IGlzIG9ubHkgZXZlciBjaGVja2VkIGFnYWluc3Qgb3JpZ2luc1xuICAgKiAocHJvdG86Ly9ob3N0Wzpwb3J0XSkgc28gZG9lcyBub3QgbmVlZCB0byBjb25zaWRlciBwYXRoXG4gICAqL1xuICBjZG5Qcm94eVJlZ2V4OiBjZG5Qcm94eVJlZ2V4IHx8XG4gICAgICAvXmh0dHBzOlxcL1xcLyhbYS16QS1aMC05Xy1dK1xcLik/Y2RuXFwuYW1wcHJvamVjdFxcLm9yZyQvLFxuICBsb2NhbGhvc3RSZWdleDogL15odHRwcz86XFwvXFwvbG9jYWxob3N0KDpcXGQrKT8kLyxcbiAgZXJyb3JSZXBvcnRpbmc6IGVudlsnZXJyb3JSZXBvcnRpbmdVcmwnXSB8fFxuICAgICAgJ2h0dHBzOi8vYW1wLWVycm9yLXJlcG9ydGluZy5hcHBzcG90LmNvbS9yJyxcbiAgbG9jYWxEZXY6IGVudlsnbG9jYWxEZXYnXSB8fCBmYWxzZSxcbn07XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIHVybHMsXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7ZW5kc1dpdGh9IGZyb20gJy4vc3RyaW5nJztcbmltcG9ydCB7XG4gIGlzUHJveHlPcmlnaW4sXG4gIHBhcnNlVXJsRGVwcmVjYXRlZCxcbiAgdHJ5RGVjb2RlVXJpQ29tcG9uZW50LFxufSBmcm9tICcuL3VybCc7XG5pbXBvcnQge3VybHN9IGZyb20gJy4vY29uZmlnJztcblxuXG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBjb29raWUuIFRoZSBjb29raWUgYWNjZXNzIGlzIHJlc3RyaWN0ZWQgYW5kIG11c3RcbiAqIGdvIHRocm91Z2ggdGhlIHByaXZhY3kgcmV2aWV3LiBCZWZvcmUgdXNpbmcgdGhpcyBtZXRob2QgcGxlYXNlIGZpbGUgYVxuICogR2l0SHViIGlzc3VlIHdpdGggXCJQcml2YWN5IFJldmlld1wiIGxhYmVsLlxuICpcbiAqIFJldHVybnMgdGhlIGNvb2tpZSdzIHZhbHVlIG9yIGBudWxsYC5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAqIEByZXR1cm4gez9zdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb29raWUod2luLCBuYW1lKSB7XG4gIGNvbnN0IGNvb2tpZVN0cmluZyA9IHRyeUdldERvY3VtZW50Q29va2llTm9JbmxpbmUod2luKTtcbiAgaWYgKCFjb29raWVTdHJpbmcpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBjb29raWVzID0gY29va2llU3RyaW5nLnNwbGl0KCc7Jyk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY29va2llcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGNvb2tpZSA9IGNvb2tpZXNbaV0udHJpbSgpO1xuICAgIGNvbnN0IGVxID0gY29va2llLmluZGV4T2YoJz0nKTtcbiAgICBpZiAoZXEgPT0gLTEpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAodHJ5RGVjb2RlVXJpQ29tcG9uZW50KGNvb2tpZS5zdWJzdHJpbmcoMCwgZXEpLnRyaW0oKSkgPT0gbmFtZSkge1xuICAgICAgY29uc3QgdmFsdWUgPSBjb29raWUuc3Vic3RyaW5nKGVxICsgMSkudHJpbSgpO1xuICAgICAgcmV0dXJuIHRyeURlY29kZVVyaUNvbXBvbmVudCh2YWx1ZSwgdmFsdWUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBUaGlzIG1ldGhvZCBzaG91bGQgbm90IGJlIGlubGluZWQgdG8gcHJldmVudCBUcnlDYXRjaCBkZW9wdGltaXphdGlvbi5cbiAqIE5vSW5saW5lIGtleXdvcmQgYXQgdGhlIGVuZCBvZiBmdW5jdGlvbiBuYW1lIGFsc28gcHJldmVudHMgQ2xvc3VyZSBjb21waWxlclxuICogZnJvbSBpbmxpbmluZyB0aGUgZnVuY3Rpb24uXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0cnlHZXREb2N1bWVudENvb2tpZU5vSW5saW5lKHdpbikge1xuICB0cnkge1xuICAgIHJldHVybiB3aW4uZG9jdW1lbnQuY29va2llO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gQWN0IGFzIGlmIG5vIGNvb2tpZSBpcyBhdmFpbGFibGUuIEV4Y2VwdGlvbnMgY2FuIGJlIHRocm93biB3aGVuXG4gICAgLy8gQU1QIGRvY3MgYXJlIG9wZW5lZCBvbiBvcmlnaW5zIHRoYXQgZG8gbm90IGFsbG93IHNldHRpbmdcbiAgICAvLyBjb29raWVzIHN1Y2ggYXMgbnVsbCBvcmlnaW5zLlxuICAgIHJldHVybiAnJztcbiAgfVxufVxuXG4vKipcbiAqIFNldHMgdGhlIHZhbHVlIG9mIHRoZSBjb29raWUuIFRoZSBjb29raWUgYWNjZXNzIGlzIHJlc3RyaWN0ZWQgYW5kIG11c3RcbiAqIGdvIHRocm91Z2ggdGhlIHByaXZhY3kgcmV2aWV3LiBCZWZvcmUgdXNpbmcgdGhpcyBtZXRob2QgcGxlYXNlIGZpbGUgYVxuICogR2l0SHViIGlzc3VlIHdpdGggXCJQcml2YWN5IFJldmlld1wiIGxhYmVsLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gKiBAcGFyYW0ge3RpbWV9IGV4cGlyYXRpb25UaW1lXG4gKiBAcGFyYW0ge3tcbiAqICAgaGlnaGVzdEF2YWlsYWJsZURvbWFpbjooYm9vbGVhbnx1bmRlZmluZWQpLFxuICogICBkb21haW46KHN0cmluZ3x1bmRlZmluZWQpXG4gKiB9PX0gb3B0X29wdGlvbnNcbiAqICAgICAtIGhpZ2hlc3RBdmFpbGFibGVEb21haW46IElmIHRydWUsIHNldCB0aGUgY29va2llIGF0IHRoZSB3aWRlc3QgZG9tYWluXG4gKiAgICAgICBzY29wZSBhbGxvd2VkIGJ5IHRoZSBicm93c2VyLiBFLmcuIG9uIGV4YW1wbGUuY29tIGlmIHdlIGFyZSBjdXJyZW50bHlcbiAqICAgICAgIG9uIHd3dy5leGFtcGxlLmNvbS5cbiAqICAgICAtIGRvbWFpbjogRXhwbGljaXQgZG9tYWluIHRvIHNldC5cbiAqICAgICAtIGFsbG93T25Qcm94eU9yaWdpbjogQWxsb3cgc2V0dGluZyBhIGNvb2tpZSBvbiB0aGUgQU1QIENhY2hlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0Q29va2llKHdpbiwgbmFtZSwgdmFsdWUsIGV4cGlyYXRpb25UaW1lLCBvcHRfb3B0aW9ucykge1xuICBjaGVja09yaWdpbkZvclNldHRpbmdDb29raWUod2luLCBvcHRfb3B0aW9ucywgbmFtZSk7XG4gIGlmIChvcHRfb3B0aW9ucyAmJiBvcHRfb3B0aW9ucy5oaWdoZXN0QXZhaWxhYmxlRG9tYWluKSB7XG4gICAgY29uc3QgcGFydHMgPSB3aW4ubG9jYXRpb24uaG9zdG5hbWUuc3BsaXQoJy4nKTtcbiAgICBsZXQgZG9tYWluID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMV07XG4gICAgZm9yIChsZXQgaSA9IHBhcnRzLmxlbmd0aCAtIDI7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBkb21haW4gPSBwYXJ0c1tpXSArICcuJyArIGRvbWFpbjtcbiAgICAgIHRyeVNldENvb2tpZSh3aW4sIG5hbWUsIHZhbHVlLCBleHBpcmF0aW9uVGltZSwgZG9tYWluKTtcbiAgICAgIGlmIChnZXRDb29raWUod2luLCBuYW1lKSA9PSB2YWx1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGxldCBkb21haW4gPSB1bmRlZmluZWQ7XG4gIGlmIChvcHRfb3B0aW9ucyAmJiBvcHRfb3B0aW9ucy5kb21haW4pIHtcbiAgICBkb21haW4gPSBvcHRfb3B0aW9ucy5kb21haW47XG4gIH1cbiAgdHJ5U2V0Q29va2llKHdpbiwgbmFtZSwgdmFsdWUsIGV4cGlyYXRpb25UaW1lLCBkb21haW4pO1xufVxuXG4vKipcbiAqIEF0dGVtcHQgdG8gc2V0IGEgY29va2llIHdpdGggdGhlIGdpdmVuIHBhcmFtcy5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICogQHBhcmFtIHt0aW1lfSBleHBpcmF0aW9uVGltZVxuICogQHBhcmFtIHtzdHJpbmd8dW5kZWZpbmVkfSBkb21haW5cbiAqL1xuZnVuY3Rpb24gdHJ5U2V0Q29va2llKHdpbiwgbmFtZSwgdmFsdWUsIGV4cGlyYXRpb25UaW1lLCBkb21haW4pIHtcbiAgLy8gV2UgZG8gbm90IGFsbG93IHNldHRpbmcgY29va2llcyBvbiB0aGUgZG9tYWluIHRoYXQgY29udGFpbnMgYm90aFxuICAvLyB0aGUgY2RuLiBhbmQgd3d3LiBob3N0cy5cbiAgaWYgKGRvbWFpbiA9PSAnYW1wcHJvamVjdC5vcmcnKSB7XG4gICAgLy8gQWN0aXZlbHkgZGVsZXRlIHRoZW0uXG4gICAgdmFsdWUgPSAnZGVsZXRlJztcbiAgICBleHBpcmF0aW9uVGltZSA9IDA7XG4gIH1cbiAgY29uc3QgY29va2llID0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJz0nICtcbiAgICAgIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgK1xuICAgICAgJzsgcGF0aD0vJyArXG4gICAgICAoZG9tYWluID8gJzsgZG9tYWluPScgKyBkb21haW4gOiAnJykgK1xuICAgICAgJzsgZXhwaXJlcz0nICsgbmV3IERhdGUoZXhwaXJhdGlvblRpbWUpLnRvVVRDU3RyaW5nKCk7XG4gIHRyeSB7XG4gICAgd2luLmRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZTtcbiAgfSBjYXRjaCAoaWdub3JlKSB7XG4gICAgLy8gRG8gbm90IHRocm93IGlmIHNldHRpbmcgdGhlIGNvb2tpZSBmYWlsZWQgRXhjZXB0aW9ucyBjYW4gYmUgdGhyb3duXG4gICAgLy8gd2hlbiBBTVAgZG9jcyBhcmUgb3BlbmVkIG9uIG9yaWdpbnMgdGhhdCBkbyBub3QgYWxsb3cgc2V0dGluZ1xuICAgIC8vIGNvb2tpZXMgc3VjaCBhcyBudWxsIG9yaWdpbnMuXG4gIH1cbn1cblxuLyoqXG4gKiBUaHJvd3MgaWYgYSBnaXZlbiBjb29raWUgc2hvdWxkIG5vdCBiZSBzZXQgb24gdGhlIGdpdmVuIG9yaWdpbi5cbiAqIFRoaXMgaXMgYSBkZWZlbnNlLWluLWRlcHRoLiBDYWxsZXJzIHNob3VsZCBuZXZlciBydW4gaW50byB0aGlzLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFPYmplY3R8dW5kZWZpbmVkfSBvcHRpb25zXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBGb3IgdGhlIGVycm9yIG1lc3NhZ2UuXG4gKi9cbmZ1bmN0aW9uIGNoZWNrT3JpZ2luRm9yU2V0dGluZ0Nvb2tpZSh3aW4sIG9wdGlvbnMsIG5hbWUpIHtcbiAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5hbGxvd09uUHJveHlPcmlnaW4pIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGlzUHJveHlPcmlnaW4od2luLmxvY2F0aW9uLmhyZWYpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdTaG91bGQgbmV2ZXIgYXR0ZW1wdCB0byBzZXQgY29va2llIG9uIHByb3h5IG9yaWdpbjogJ1xuICAgICAgICArIG5hbWUpO1xuICB9XG5cbiAgY29uc3QgY3VycmVudCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh3aW4ubG9jYXRpb24uaHJlZikuaG9zdG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgcHJveHkgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJscy5jZG4pLmhvc3RuYW1lLnRvTG93ZXJDYXNlKCk7XG4gIGlmIChjdXJyZW50ID09IHByb3h5IHx8IGVuZHNXaXRoKGN1cnJlbnQsICcuJyArIHByb3h5KSkge1xuICAgIHRocm93IG5ldyBFcnJvcignU2hvdWxkIG5ldmVyIGF0dGVtcHQgdG8gc2V0IGNvb2tpZSBvbiBwcm94eSBvcmlnaW4uJ1xuICAgICAgICArICcgKGluIGRlcHRoIGNoZWNrKTogJyArIG5hbWUpO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtEZWZlcnJlZH0gZnJvbSAnLi91dGlscy9wcm9taXNlJztcbmltcG9ydCB7Y3NzRXNjYXBlfSBmcm9tICcuLi90aGlyZF9wYXJ0eS9jc3MtZXNjYXBlL2Nzcy1lc2NhcGUnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7ZGljdH0gZnJvbSAnLi91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtzdGFydHNXaXRofSBmcm9tICcuL3N0cmluZyc7XG5pbXBvcnQge3RvV2lufSBmcm9tICcuL3R5cGVzJztcblxuY29uc3QgSFRNTF9FU0NBUEVfQ0hBUlMgPSB7XG4gICcmJzogJyZhbXA7JyxcbiAgJzwnOiAnJmx0OycsXG4gICc+JzogJyZndDsnLFxuICAnXCInOiAnJnF1b3Q7JyxcbiAgXCInXCI6ICcmI3gyNzsnLFxuICAnYCc6ICcmI3g2MDsnLFxufTtcbmNvbnN0IEhUTUxfRVNDQVBFX1JFR0VYID0gLygmfDx8PnxcInwnfGApL2c7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUFJPTUlTRSA9XG4gICAgJ19fQU1QX1VQR19QUk0nO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1JFU09MVkVSID1cbiAgICAnX19BTVBfVVBHX1JFUyc7XG5cbi8qKlxuICogV2FpdHMgdW50aWwgdGhlIGNoaWxkIGVsZW1lbnQgaXMgY29uc3RydWN0ZWQuIE9uY2UgdGhlIGNoaWxkIGlzIGZvdW5kLCB0aGVcbiAqIGNhbGxiYWNrIGlzIGV4ZWN1dGVkLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjaGVja0Z1bmNcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gY2FsbGJhY2tcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JDaGlsZChwYXJlbnQsIGNoZWNrRnVuYywgY2FsbGJhY2spIHtcbiAgaWYgKGNoZWNrRnVuYyhwYXJlbnQpKSB7XG4gICAgY2FsbGJhY2soKTtcbiAgICByZXR1cm47XG4gIH1cbiAgLyoqIEBjb25zdCB7IVdpbmRvd30gKi9cbiAgY29uc3Qgd2luID0gdG9XaW4ocGFyZW50Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcpO1xuICBpZiAod2luLk11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAvKiogQGNvbnN0IHtNdXRhdGlvbk9ic2VydmVyfSAqL1xuICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IHdpbi5NdXRhdGlvbk9ic2VydmVyKCgpID0+IHtcbiAgICAgIGlmIChjaGVja0Z1bmMocGFyZW50KSkge1xuICAgICAgICBvYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZShwYXJlbnQsIHtjaGlsZExpc3Q6IHRydWV9KTtcbiAgfSBlbHNlIHtcbiAgICAvKiogQGNvbnN0IHtudW1iZXJ9ICovXG4gICAgY29uc3QgaW50ZXJ2YWwgPSB3aW4uc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYgKGNoZWNrRnVuYyhwYXJlbnQpKSB7XG4gICAgICAgIHdpbi5jbGVhckludGVydmFsKGludGVydmFsKTtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH1cbiAgICB9LCAvKiBtaWxsaXNlY29uZHMgKi8gNSk7XG4gIH1cbn1cblxuLyoqXG4gKiBXYWl0cyB1bnRpbCB0aGUgY2hpbGQgZWxlbWVudCBpcyBjb25zdHJ1Y3RlZC4gT25jZSB0aGUgY2hpbGQgaXMgZm91bmQsIHRoZVxuICogcHJvbWlzZSBpcyByZXNvbHZlZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2hlY2tGdW5jXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JDaGlsZFByb21pc2UocGFyZW50LCBjaGVja0Z1bmMpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgIHdhaXRGb3JDaGlsZChwYXJlbnQsIGNoZWNrRnVuYywgcmVzb2x2ZSk7XG4gIH0pO1xufVxuXG4vKipcbiAqIFdhaXRzIGZvciBkb2N1bWVudCdzIGJvZHkgdG8gYmUgYXZhaWxhYmxlLlxuICogV2lsbCBiZSBkZXByZWNhdGVkIHNvb247IHVzZSB7QGxpbmsgQW1wRG9jI3doZW5Cb2R5QXZhaWxhYmxlfSBvclxuICogQHtsaW5rIERvY3VtZW50U3RhdGUjb25Cb2R5QXZhaWxhYmxlfSBpbnN0ZWFkLlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHBhcmFtIHtmdW5jdGlvbigpfSBjYWxsYmFja1xuICovXG5leHBvcnQgZnVuY3Rpb24gd2FpdEZvckJvZHkoZG9jLCBjYWxsYmFjaykge1xuICB3YWl0Rm9yQ2hpbGQoZG9jLmRvY3VtZW50RWxlbWVudCwgKCkgPT4gISFkb2MuYm9keSwgY2FsbGJhY2spO1xufVxuXG5cbi8qKlxuICogV2FpdHMgZm9yIGRvY3VtZW50J3MgYm9keSB0byBiZSBhdmFpbGFibGUuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JCb2R5UHJvbWlzZShkb2MpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgIHdhaXRGb3JCb2R5KGRvYywgcmVzb2x2ZSk7XG4gIH0pO1xufVxuXG5cbi8qKlxuICogUmVtb3ZlcyB0aGUgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUVsZW1lbnQoZWxlbWVudCkge1xuICBpZiAoZWxlbWVudC5wYXJlbnRFbGVtZW50KSB7XG4gICAgZWxlbWVudC5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZW1vdmVzIGFsbCBjaGlsZCBub2RlcyBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUNoaWxkcmVuKHBhcmVudCkge1xuICB3aGlsZSAocGFyZW50LmZpcnN0Q2hpbGQpIHtcbiAgICBwYXJlbnQucmVtb3ZlQ2hpbGQocGFyZW50LmZpcnN0Q2hpbGQpO1xuICB9XG59XG5cblxuLyoqXG4gKiBDb3BpZXMgYWxsIGNoaWxkcmVuIG5vZGVzIG9mIGVsZW1lbnQgXCJmcm9tXCIgdG8gZWxlbWVudCBcInRvXCIuIENoaWxkIG5vZGVzXG4gKiBhcmUgZGVlcGx5IGNsb25lZC4gTm90aWNlLCB0aGF0IHRoaXMgbWV0aG9kIHNob3VsZCBiZSB1c2VkIHdpdGggY2FyZSBhbmRcbiAqIHByZWZlcmFibHkgb24gc21hbGxlciBzdWJ0cmVlcy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGZyb21cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IURvY3VtZW50RnJhZ21lbnR9IHRvXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb3B5Q2hpbGRyZW4oZnJvbSwgdG8pIHtcbiAgY29uc3QgZnJhZyA9IHRvLm93bmVyRG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICBmb3IgKGxldCBuID0gZnJvbS5maXJzdENoaWxkOyBuOyBuID0gbi5uZXh0U2libGluZykge1xuICAgIGZyYWcuYXBwZW5kQ2hpbGQobi5jbG9uZU5vZGUodHJ1ZSkpO1xuICB9XG4gIHRvLmFwcGVuZENoaWxkKGZyYWcpO1xufVxuXG4vKipcbiAqIEluc2VydCB0aGUgZWxlbWVudCBpbiB0aGUgcm9vdCBhZnRlciB0aGUgZWxlbWVudCBuYW1lZCBhZnRlciBvclxuICogaWYgdGhhdCBpcyBudWxsIGF0IHRoZSBiZWdpbm5pbmcuXG4gKiBAcGFyYW0geyFFbGVtZW50fCFTaGFkb3dSb290fSByb290XG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0gez9Ob2RlfSBhZnRlclxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zZXJ0QWZ0ZXJPckF0U3RhcnQocm9vdCwgZWxlbWVudCwgYWZ0ZXIpIHtcbiAgY29uc3QgYmVmb3JlID0gYWZ0ZXIgPyBhZnRlci5uZXh0U2libGluZyA6IHJvb3QuZmlyc3RDaGlsZDtcbiAgcm9vdC5pbnNlcnRCZWZvcmUoZWxlbWVudCwgYmVmb3JlKTtcbn1cblxuLyoqXG4gKiBBZGQgYXR0cmlidXRlcyB0byBhbiBlbGVtZW50LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHshSnNvbk9iamVjdDxzdHJpbmcsIHN0cmluZz59IGF0dHJpYnV0ZXNcbiAqIEByZXR1cm4geyFFbGVtZW50fSBjcmVhdGVkIGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZEF0dHJpYnV0ZXNUb0VsZW1lbnQoZWxlbWVudCwgYXR0cmlidXRlcykge1xuICBmb3IgKGNvbnN0IGF0dHIgaW4gYXR0cmlidXRlcykge1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKGF0dHIsIGF0dHJpYnV0ZXNbYXR0cl0pO1xuICB9XG4gIHJldHVybiBlbGVtZW50O1xufVxuXG4vKipcbiAqIENyZWF0ZSBhIG5ldyBlbGVtZW50IG9uIGRvY3VtZW50IHdpdGggc3BlY2lmaWVkIHRhZ05hbWUgYW5kIGF0dHJpYnV0ZXMuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHBhcmFtIHshSnNvbk9iamVjdDxzdHJpbmcsIHN0cmluZz59IGF0dHJpYnV0ZXNcbiAqIEByZXR1cm4geyFFbGVtZW50fSBjcmVhdGVkIGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnRXaXRoQXR0cmlidXRlcyhkb2MsIHRhZ05hbWUsIGF0dHJpYnV0ZXMpIHtcbiAgY29uc3QgZWxlbWVudCA9IGRvYy5jcmVhdGVFbGVtZW50KHRhZ05hbWUpO1xuICByZXR1cm4gYWRkQXR0cmlidXRlc1RvRWxlbWVudChlbGVtZW50LCBhdHRyaWJ1dGVzKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgbm9kZSBpcyBjb25uZWN0ZWQgKGF0dGFjaGVkKS5cbiAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAc2VlIGh0dHBzOi8vZG9tLnNwZWMud2hhdHdnLm9yZy8jY29ubmVjdGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Nvbm5lY3RlZE5vZGUobm9kZSkge1xuICBjb25zdCBjb25uZWN0ZWQgPSBub2RlLmlzQ29ubmVjdGVkO1xuICBpZiAoY29ubmVjdGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gY29ubmVjdGVkO1xuICB9XG5cbiAgLy8gXCJBbiBlbGVtZW50IGlzIGNvbm5lY3RlZCBpZiBpdHMgc2hhZG93LWluY2x1ZGluZyByb290IGlzIGEgZG9jdW1lbnQuXCJcbiAgbGV0IG4gPSBub2RlO1xuICBkbyB7XG4gICAgbiA9IHJvb3ROb2RlRm9yKG4pO1xuICAgIGlmIChuLmhvc3QpIHtcbiAgICAgIG4gPSBuLmhvc3Q7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfSB3aGlsZSAodHJ1ZSk7XG4gIHJldHVybiBuLm5vZGVUeXBlID09PSBOb2RlLkRPQ1VNRU5UX05PREU7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgcm9vdCBmb3IgYSBnaXZlbiBub2RlLiBEb2VzIG5vdCBjcm9zcyBzaGFkb3cgRE9NIGJvdW5kYXJ5LlxuICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICogQHJldHVybiB7IU5vZGV9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByb290Tm9kZUZvcihub2RlKSB7XG4gIGlmIChOb2RlLnByb3RvdHlwZS5nZXRSb290Tm9kZSkge1xuICAgIC8vIFR5cGUgY2hlY2tlciBzYXlzIGBnZXRSb290Tm9kZWAgbWF5IHJldHVybiBudWxsLlxuICAgIHJldHVybiBub2RlLmdldFJvb3ROb2RlKCkgfHwgbm9kZTtcbiAgfVxuICBsZXQgbjtcbiAgZm9yIChuID0gbm9kZTsgISFuLnBhcmVudE5vZGU7IG4gPSBuLnBhcmVudE5vZGUpIHt9XG4gIHJldHVybiBuO1xufVxuXG4vKipcbiAqIEZpbmRzIHRoZSBjbG9zZXN0IGVsZW1lbnQgdGhhdCBzYXRpc2ZpZXMgdGhlIGNhbGxiYWNrIGZyb20gdGhpcyBlbGVtZW50XG4gKiB1cCB0aGUgRE9NIHN1YnRyZWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjYWxsYmFja1xuICogQHBhcmFtIHtFbGVtZW50PX0gb3B0X3N0b3BBdCBvcHRpb25hbCBlbGVtbnQgdG8gc3RvcCB0aGUgc2VhcmNoIGF0LlxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbG9zZXN0KGVsZW1lbnQsIGNhbGxiYWNrLCBvcHRfc3RvcEF0KSB7XG4gIGZvciAobGV0IGVsID0gZWxlbWVudDsgZWwgJiYgZWwgIT09IG9wdF9zdG9wQXQ7IGVsID0gZWwucGFyZW50RWxlbWVudCkge1xuICAgIGlmIChjYWxsYmFjayhlbCkpIHtcbiAgICAgIHJldHVybiBlbDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgY2xvc2VzdCBub2RlIHRoYXQgc2F0aXNmaWVzIHRoZSBjYWxsYmFjayBmcm9tIHRoaXMgbm9kZVxuICogdXAgdGhlIERPTSBzdWJ0cmVlLlxuICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICogQHBhcmFtIHtmdW5jdGlvbighTm9kZSk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEByZXR1cm4gez9Ob2RlfVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VzdE5vZGUobm9kZSwgY2FsbGJhY2spIHtcbiAgZm9yIChsZXQgbiA9IG5vZGU7IG47IG4gPSBuLnBhcmVudE5vZGUpIHtcbiAgICBpZiAoY2FsbGJhY2sobikpIHtcbiAgICAgIHJldHVybiBuO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBjbG9zZXN0IGVsZW1lbnQgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUgZnJvbSB0aGlzIGVsZW1lbnRcbiAqIHVwIHRoZSBET00gc3VidHJlZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsb3Nlc3RCeVRhZyhlbGVtZW50LCB0YWdOYW1lKSB7XG4gIGlmIChlbGVtZW50LmNsb3Nlc3QpIHtcbiAgICByZXR1cm4gZWxlbWVudC5jbG9zZXN0KHRhZ05hbWUpO1xuICB9XG4gIHRhZ05hbWUgPSB0YWdOYW1lLnRvVXBwZXJDYXNlKCk7XG4gIHJldHVybiBjbG9zZXN0KGVsZW1lbnQsIGVsID0+IHtcbiAgICByZXR1cm4gZWwudGFnTmFtZSA9PSB0YWdOYW1lO1xuICB9KTtcbn1cblxuLyoqXG4gKiBGaW5kcyB0aGUgY2xvc2VzdCBlbGVtZW50IHdpdGggdGhlIHNwZWNpZmllZCBzZWxlY3RvciBmcm9tIHRoaXMgZWxlbWVudFxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHNlbGVjdG9yXG4gKiBAcmV0dXJuIHs/RWxlbWVudH0gY2xvc2VzdCBhbmNlc3RvciBpZiBmb3VuZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsb3Nlc3RCeVNlbGVjdG9yKGVsZW1lbnQsIHNlbGVjdG9yKSB7XG4gIGlmIChlbGVtZW50LmNsb3Nlc3QpIHtcbiAgICByZXR1cm4gZWxlbWVudC5jbG9zZXN0KHNlbGVjdG9yKTtcbiAgfVxuXG4gIHJldHVybiBjbG9zZXN0KGVsZW1lbnQsIGVsID0+IHtcbiAgICByZXR1cm4gbWF0Y2hlcyhlbCwgc2VsZWN0b3IpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgdGhlIGdpdmVuIGVsZW1lbnQgbWF0Y2hlcyB0aGUgc2VsZWN0b3JcbiAqIEBwYXJhbSAgeyFFbGVtZW50fSBlbCBUaGUgZWxlbWVudCB0byB2ZXJpZnlcbiAqIEBwYXJhbSAge3N0cmluZ30gc2VsZWN0b3IgVGhlIHNlbGVjdG9yIHRvIGNoZWNrIGFnYWluc3RcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIGVsZW1lbnQgbWF0Y2hlZCB0aGUgc2VsZWN0b3IuIEZhbHNlIG90aGVyd2lzZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hdGNoZXMoZWwsIHNlbGVjdG9yKSB7XG4gIGNvbnN0IG1hdGNoZXIgPSBlbC5tYXRjaGVzIHx8XG4gICAgICBlbC53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHxcbiAgICAgIGVsLm1vek1hdGNoZXNTZWxlY3RvciB8fFxuICAgICAgZWwubXNNYXRjaGVzU2VsZWN0b3IgfHxcbiAgICAgIGVsLm9NYXRjaGVzU2VsZWN0b3I7XG4gIGlmIChtYXRjaGVyKSB7XG4gICAgcmV0dXJuIG1hdGNoZXIuY2FsbChlbCwgc2VsZWN0b3IpO1xuICB9XG4gIHJldHVybiBmYWxzZTsgLy8gSUU4IGFsd2F5cyByZXR1cm5zIGZhbHNlLlxufVxuXG4vKipcbiAqIEZpbmRzIHRoZSBmaXJzdCBkZXNjZW5kYW50IGVsZW1lbnQgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fCFEb2N1bWVudHwhU2hhZG93Um9vdH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWVcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZWxlbWVudEJ5VGFnKGVsZW1lbnQsIHRhZ05hbWUpIHtcbiAgbGV0IGVsZW1lbnRzO1xuICAvLyBnZXRFbGVtZW50c0J5VGFnTmFtZSgpIGlzIG5vdCBzdXBwb3J0ZWQgb24gU2hhZG93Um9vdC5cbiAgaWYgKHR5cGVvZiBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lID09PSAnZnVuY3Rpb24nKSB7XG4gICAgZWxlbWVudHMgPSBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhZ05hbWUpO1xuICB9IGVsc2Uge1xuICAgIGVsZW1lbnRzID0gZWxlbWVudC4vKk9LKi9xdWVyeVNlbGVjdG9yQWxsKHRhZ05hbWUpO1xuICB9XG4gIHJldHVybiAoZWxlbWVudHMgJiYgZWxlbWVudHNbMF0pIHx8IG51bGw7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgZmlyc3QgY2hpbGQgZWxlbWVudCB0aGF0IHNhdGlzZmllcyB0aGUgY2FsbGJhY2suXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IGNhbGxiYWNrXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudChwYXJlbnQsIGNhbGxiYWNrKSB7XG4gIGZvciAobGV0IGNoaWxkID0gcGFyZW50LmZpcnN0RWxlbWVudENoaWxkOyBjaGlsZDtcbiAgICBjaGlsZCA9IGNoaWxkLm5leHRFbGVtZW50U2libGluZykge1xuICAgIGlmIChjYWxsYmFjayhjaGlsZCkpIHtcbiAgICAgIHJldHVybiBjaGlsZDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuLyoqXG4gKiBGaW5kcyBhbGwgY2hpbGQgZWxlbWVudHMgdGhhdCBzYXRpc2Z5IHRoZSBjYWxsYmFjay5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEByZXR1cm4geyFBcnJheTwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnRzKHBhcmVudCwgY2FsbGJhY2spIHtcbiAgY29uc3QgY2hpbGRyZW4gPSBbXTtcbiAgZm9yIChsZXQgY2hpbGQgPSBwYXJlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7IGNoaWxkO1xuICAgIGNoaWxkID0gY2hpbGQubmV4dEVsZW1lbnRTaWJsaW5nKSB7XG4gICAgaWYgKGNhbGxiYWNrKGNoaWxkKSkge1xuICAgICAgY2hpbGRyZW4ucHVzaChjaGlsZCk7XG4gICAgfVxuICB9XG4gIHJldHVybiBjaGlsZHJlbjtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBsYXN0IGNoaWxkIGVsZW1lbnQgdGhhdCBzYXRpc2ZpZXMgdGhlIGNhbGxiYWNrLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjYWxsYmFja1xuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXN0Q2hpbGRFbGVtZW50KHBhcmVudCwgY2FsbGJhY2spIHtcbiAgZm9yIChsZXQgY2hpbGQgPSBwYXJlbnQubGFzdEVsZW1lbnRDaGlsZDsgY2hpbGQ7XG4gICAgY2hpbGQgPSBjaGlsZC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKSB7XG4gICAgaWYgKGNhbGxiYWNrKGNoaWxkKSkge1xuICAgICAgcmV0dXJuIGNoaWxkO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBGaW5kcyBhbGwgY2hpbGQgbm9kZXMgdGhhdCBzYXRpc2Z5IHRoZSBjYWxsYmFjay5cbiAqIFRoZXNlIG5vZGVzIGNhbiBpbmNsdWRlIFRleHQsIENvbW1lbnQgYW5kIG90aGVyIGNoaWxkIG5vZGVzLlxuICogQHBhcmFtIHshTm9kZX0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFOb2RlKTpib29sZWFufSBjYWxsYmFja1xuICogQHJldHVybiB7IUFycmF5PCFOb2RlPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkTm9kZXMocGFyZW50LCBjYWxsYmFjaykge1xuICBjb25zdCBub2RlcyA9IFtdO1xuICBmb3IgKGxldCBjaGlsZCA9IHBhcmVudC5maXJzdENoaWxkOyBjaGlsZDtcbiAgICBjaGlsZCA9IGNoaWxkLm5leHRTaWJsaW5nKSB7XG4gICAgaWYgKGNhbGxiYWNrKGNoaWxkKSkge1xuICAgICAgbm9kZXMucHVzaChjaGlsZCk7XG4gICAgfVxuICB9XG4gIHJldHVybiBub2Rlcztcbn1cblxuLyoqXG4gKiBAdHlwZSB7Ym9vbGVhbnx1bmRlZmluZWR9XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xubGV0IHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQ7XG5cbi8qKlxuICogQHBhcmFtIHtib29sZWFufHVuZGVmaW5lZH0gdmFsXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFNjb3BlU2VsZWN0b3JTdXBwb3J0ZWRGb3JUZXN0aW5nKHZhbCkge1xuICBzY29wZVNlbGVjdG9yU3VwcG9ydGVkID0gdmFsO1xufVxuXG4vKipcbiAqIFRlc3QgdGhhdCB0aGUgOnNjb3BlIHNlbGVjdG9yIGlzIHN1cHBvcnRlZCBhbmQgYmVoYXZlcyBjb3JyZWN0bHkuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzU2NvcGVTZWxlY3RvclN1cHBvcnRlZChwYXJlbnQpIHtcbiAgY29uc3QgZG9jID0gcGFyZW50Lm93bmVyRG9jdW1lbnQ7XG4gIHRyeSB7XG4gICAgY29uc3QgdGVzdEVsZW1lbnQgPSBkb2MuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgdGVzdENoaWxkID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRlc3RFbGVtZW50LmFwcGVuZENoaWxkKHRlc3RDaGlsZCk7XG4gICAgLy8gTk9URShjdmlhbGl6LCAjMTIzODMpOiBGaXJlZm94J3MgaW1wbGVtZW50YXRpb24gaXMgaW5jb21wbGV0ZSxcbiAgICAvLyB0aGVyZWZvcmUgd2UgdGVzdCBhY3R1YWwgZnVuY3Rpb25hbGl0eSBvZmA6c2NvcGVgIGFzIHdlbGwuXG4gICAgcmV0dXJuIHRlc3RFbGVtZW50Li8qT0sqL3F1ZXJ5U2VsZWN0b3IoJzpzY29wZSBkaXYnKSA9PT0gdGVzdENoaWxkO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8qKlxuICogRmluZHMgdGhlIGZpcnN0IGNoaWxkIGVsZW1lbnQgdGhhdCBoYXMgdGhlIHNwZWNpZmllZCBhdHRyaWJ1dGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudEJ5QXR0cihwYXJlbnQsIGF0dHIpIHtcbiAgcmV0dXJuIHNjb3BlZFF1ZXJ5U2VsZWN0b3IvKk9LKi8ocGFyZW50LCBgPiBbJHthdHRyfV1gKTtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBsYXN0IGNoaWxkIGVsZW1lbnQgdGhhdCBoYXMgdGhlIHNwZWNpZmllZCBhdHRyaWJ1dGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxhc3RDaGlsZEVsZW1lbnRCeUF0dHIocGFyZW50LCBhdHRyKSB7XG4gIHJldHVybiBsYXN0Q2hpbGRFbGVtZW50KHBhcmVudCwgZWwgPT4ge1xuICAgIHJldHVybiBlbC5oYXNBdHRyaWJ1dGUoYXR0cik7XG4gIH0pO1xufVxuXG5cbi8qKlxuICogRmluZHMgYWxsIGNoaWxkIGVsZW1lbnRzIHRoYXQgaGFzIHRoZSBzcGVjaWZpZWQgYXR0cmlidXRlLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gYXR0clxuICogQHJldHVybiB7IU5vZGVMaXN0PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudHNCeUF0dHIocGFyZW50LCBhdHRyKSB7XG4gIHJldHVybiBzY29wZWRRdWVyeVNlbGVjdG9yQWxsLypPSyovKHBhcmVudCwgYD4gWyR7YXR0cn1dYCk7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgZmlyc3QgY2hpbGQgZWxlbWVudCB0aGF0IGhhcyB0aGUgc3BlY2lmaWVkIHRhZyBuYW1lLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnRCeVRhZyhwYXJlbnQsIHRhZ05hbWUpIHtcbiAgcmV0dXJuIHNjb3BlZFF1ZXJ5U2VsZWN0b3IvKk9LKi8ocGFyZW50LCBgPiAke3RhZ05hbWV9YCk7XG59XG5cblxuLyoqXG4gKiBGaW5kcyBhbGwgY2hpbGQgZWxlbWVudHMgd2l0aCB0aGUgc3BlY2lmaWVkIHRhZyBuYW1lLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7IU5vZGVMaXN0PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudHNCeVRhZyhwYXJlbnQsIHRhZ05hbWUpIHtcbiAgcmV0dXJuIHNjb3BlZFF1ZXJ5U2VsZWN0b3JBbGwvKk9LKi8ocGFyZW50LCBgPiAke3RhZ05hbWV9YCk7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgZmlyc3QgZWxlbWVudCB0aGF0IG1hdGNoZXMgYHNlbGVjdG9yYCwgc2NvcGVkIGluc2lkZSBgcm9vdGAuXG4gKiBOb3RlOiBpbiBJRSwgdGhpcyBjYXVzZXMgYSBxdWljayBtdXRhdGlvbiBvZiB0aGUgZWxlbWVudCdzIGNsYXNzIGxpc3QuXG4gKiBAcGFyYW0geyFFbGVtZW50fSByb290XG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2NvcGVkUXVlcnlTZWxlY3Rvcihyb290LCBzZWxlY3Rvcikge1xuICBpZiAoc2NvcGVTZWxlY3RvclN1cHBvcnRlZCA9PSBudWxsKSB7XG4gICAgc2NvcGVTZWxlY3RvclN1cHBvcnRlZCA9IGlzU2NvcGVTZWxlY3RvclN1cHBvcnRlZChyb290KTtcbiAgfVxuICBpZiAoc2NvcGVTZWxlY3RvclN1cHBvcnRlZCkge1xuICAgIHJldHVybiByb290Li8qT0sqL3F1ZXJ5U2VsZWN0b3IoYDpzY29wZSAke3NlbGVjdG9yfWApO1xuICB9XG5cbiAgLy8gT25seSBJRS5cbiAgY29uc3QgdW5pcXVlID0gJ2ktYW1waHRtbC1zY29wZWQnO1xuICByb290LmNsYXNzTGlzdC5hZGQodW5pcXVlKTtcbiAgY29uc3QgZWxlbWVudCA9IHJvb3QuLypPSyovcXVlcnlTZWxlY3RvcihgLiR7dW5pcXVlfSAke3NlbGVjdG9yfWApO1xuICByb290LmNsYXNzTGlzdC5yZW1vdmUodW5pcXVlKTtcbiAgcmV0dXJuIGVsZW1lbnQ7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgZXZlcnkgZWxlbWVudCB0aGF0IG1hdGNoZXMgYHNlbGVjdG9yYCwgc2NvcGVkIGluc2lkZSBgcm9vdGAuXG4gKiBOb3RlOiBpbiBJRSwgdGhpcyBjYXVzZXMgYSBxdWljayBtdXRhdGlvbiBvZiB0aGUgZWxlbWVudCdzIGNsYXNzIGxpc3QuXG4gKiBAcGFyYW0geyFFbGVtZW50fSByb290XG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcbiAqIEByZXR1cm4geyFOb2RlTGlzdDwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzY29wZWRRdWVyeVNlbGVjdG9yQWxsKHJvb3QsIHNlbGVjdG9yKSB7XG4gIGlmIChzY29wZVNlbGVjdG9yU3VwcG9ydGVkID09IG51bGwpIHtcbiAgICBzY29wZVNlbGVjdG9yU3VwcG9ydGVkID0gaXNTY29wZVNlbGVjdG9yU3VwcG9ydGVkKHJvb3QpO1xuICB9XG4gIGlmIChzY29wZVNlbGVjdG9yU3VwcG9ydGVkKSB7XG4gICAgcmV0dXJuIHJvb3QuLypPSyovcXVlcnlTZWxlY3RvckFsbChgOnNjb3BlICR7c2VsZWN0b3J9YCk7XG4gIH1cblxuICAvLyBPbmx5IElFLlxuICBjb25zdCB1bmlxdWUgPSAnaS1hbXBodG1sLXNjb3BlZCc7XG4gIHJvb3QuY2xhc3NMaXN0LmFkZCh1bmlxdWUpO1xuICBjb25zdCBlbGVtZW50cyA9IHJvb3QuLypPSyovcXVlcnlTZWxlY3RvckFsbChgLiR7dW5pcXVlfSAke3NlbGVjdG9yfWApO1xuICByb290LmNsYXNzTGlzdC5yZW1vdmUodW5pcXVlKTtcbiAgcmV0dXJuIGVsZW1lbnRzO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBlbGVtZW50IGRhdGEtcGFyYW0tIGF0dHJpYnV0ZXMgYXMgdXJsIHBhcmFtZXRlcnMga2V5LXZhbHVlIHBhaXJzLlxuICogZS5nLiBkYXRhLXBhcmFtLXNvbWUtYXR0cj12YWx1ZSAtPiB7c29tZUF0dHI6IHZhbHVlfS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nKTpzdHJpbmc9fSBvcHRfY29tcHV0ZVBhcmFtTmFtZUZ1bmMgdG8gY29tcHV0ZSB0aGVcbiAqICAgIHBhcmFtZXRlciBuYW1lLCBnZXQgcGFzc2VkIHRoZSBjYW1lbC1jYXNlIHBhcmFtZXRlciBuYW1lLlxuICogQHBhcmFtIHshUmVnRXhwPX0gb3B0X3BhcmFtUGF0dGVybiBSZWdleCBwYXR0ZXJuIHRvIG1hdGNoIGRhdGEgYXR0cmlidXRlcy5cbiAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGF0YVBhcmFtc0Zyb21BdHRyaWJ1dGVzKGVsZW1lbnQsIG9wdF9jb21wdXRlUGFyYW1OYW1lRnVuYyxcbiAgb3B0X3BhcmFtUGF0dGVybikge1xuICBjb25zdCBjb21wdXRlUGFyYW1OYW1lRnVuYyA9IG9wdF9jb21wdXRlUGFyYW1OYW1lRnVuYyB8fCAoa2V5ID0+IGtleSk7XG4gIGNvbnN0IHtkYXRhc2V0fSA9IGVsZW1lbnQ7XG4gIGNvbnN0IHBhcmFtcyA9IGRpY3QoKTtcbiAgY29uc3QgcGFyYW1QYXR0ZXJuID0gb3B0X3BhcmFtUGF0dGVybiA/IG9wdF9wYXJhbVBhdHRlcm4gOiAvXnBhcmFtKC4rKS87XG4gIGZvciAoY29uc3Qga2V5IGluIGRhdGFzZXQpIHtcbiAgICBjb25zdCBtYXRjaGVzID0ga2V5Lm1hdGNoKHBhcmFtUGF0dGVybik7XG4gICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgIGNvbnN0IHBhcmFtID0gbWF0Y2hlc1sxXVswXS50b0xvd2VyQ2FzZSgpICsgbWF0Y2hlc1sxXS5zdWJzdHIoMSk7XG4gICAgICBwYXJhbXNbY29tcHV0ZVBhcmFtTmFtZUZ1bmMocGFyYW0pXSA9IGRhdGFzZXRba2V5XTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBhcmFtcztcbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBlbGVtZW50IGhhdmUgYSBuZXh0IG5vZGUgaW4gdGhlIGRvY3VtZW50IG9yZGVyLlxuICogVGhpcyBtZWFucyBlaXRoZXI6XG4gKiAgYS4gVGhlIGVsZW1lbnQgaXRzZWxmIGhhcyBhIG5leHRTaWJsaW5nLlxuICogIGIuIEFueSBvZiB0aGUgZWxlbWVudCBhbmNlc3RvcnMgaGFzIGEgbmV4dFNpYmxpbmcuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0gez9Ob2RlfSBvcHRfc3RvcE5vZGVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoYXNOZXh0Tm9kZUluRG9jdW1lbnRPcmRlcihlbGVtZW50LCBvcHRfc3RvcE5vZGUpIHtcbiAgbGV0IGN1cnJlbnRFbGVtZW50ID0gZWxlbWVudDtcbiAgZG8ge1xuICAgIGlmIChjdXJyZW50RWxlbWVudC5uZXh0U2libGluZykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9IHdoaWxlICgoY3VycmVudEVsZW1lbnQgPSBjdXJyZW50RWxlbWVudC5wYXJlbnROb2RlKSAmJlxuICAgICAgICAgICAgY3VycmVudEVsZW1lbnQgIT0gb3B0X3N0b3BOb2RlKTtcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5cbi8qKlxuICogRmluZHMgYWxsIGFuY2VzdG9yIGVsZW1lbnRzIHRoYXQgc2F0aXNmeSBwcmVkaWNhdGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBjaGlsZFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gcHJlZGljYXRlXG4gKiBAcmV0dXJuIHshQXJyYXk8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gYW5jZXN0b3JFbGVtZW50cyhjaGlsZCwgcHJlZGljYXRlKSB7XG4gIGNvbnN0IGFuY2VzdG9ycyA9IFtdO1xuICBmb3IgKGxldCBhbmNlc3RvciA9IGNoaWxkLnBhcmVudEVsZW1lbnQ7IGFuY2VzdG9yO1xuICAgIGFuY2VzdG9yID0gYW5jZXN0b3IucGFyZW50RWxlbWVudCkge1xuICAgIGlmIChwcmVkaWNhdGUoYW5jZXN0b3IpKSB7XG4gICAgICBhbmNlc3RvcnMucHVzaChhbmNlc3Rvcik7XG4gICAgfVxuICB9XG4gIHJldHVybiBhbmNlc3RvcnM7XG59XG5cblxuLyoqXG4gKiBGaW5kcyBhbGwgYW5jZXN0b3IgZWxlbWVudHMgdGhhdCBoYXMgdGhlIHNwZWNpZmllZCB0YWcgbmFtZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGNoaWxkXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7IUFycmF5PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFuY2VzdG9yRWxlbWVudHNCeVRhZyhjaGlsZCwgdGFnTmFtZSkge1xuICB0YWdOYW1lID0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xuICByZXR1cm4gYW5jZXN0b3JFbGVtZW50cyhjaGlsZCwgZWwgPT4ge1xuICAgIHJldHVybiBlbC50YWdOYW1lID09IHRhZ05hbWU7XG4gIH0pO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBjbG9uZSBvZiB0aGUgY29udGVudCBvZiBhIHRlbXBsYXRlIGVsZW1lbnQuXG4gKlxuICogUG9seWZpbGwgdG8gcmVwbGFjZSAuY29udGVudCBhY2Nlc3MgZm9yIGJyb3dzZXJzIHRoYXQgZG8gbm90IHN1cHBvcnRcbiAqIEhUTUxUZW1wbGF0ZUVsZW1lbnRzIG5hdGl2ZWx5LlxuICpcbiAqIEBwYXJhbSB7IUhUTUxUZW1wbGF0ZUVsZW1lbnR8IUVsZW1lbnR9IHRlbXBsYXRlXG4gKiBAcmV0dXJuIHshRG9jdW1lbnRGcmFnbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRlbXBsYXRlQ29udGVudENsb25lKHRlbXBsYXRlKSB7XG4gIGlmICgnY29udGVudCcgaW4gdGVtcGxhdGUpIHtcbiAgICByZXR1cm4gdGVtcGxhdGUuY29udGVudC5jbG9uZU5vZGUodHJ1ZSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgY29udGVudCA9IHRlbXBsYXRlLm93bmVyRG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIGNvcHlDaGlsZHJlbih0ZW1wbGF0ZSwgY29udGVudCk7XG4gICAgcmV0dXJuIGNvbnRlbnQ7XG4gIH1cbn1cblxuLyoqXG4gKiBJdGVyYXRlIG92ZXIgYW4gYXJyYXktbGlrZS4gU29tZSBjb2xsZWN0aW9ucyBsaWtlIE5vZGVMaXN0IGFyZVxuICogbGF6aWx5IGV2YWx1YXRlZCBpbiBzb21lIGJyb3dzZXJzLCBhbmQgYWNjZXNzaW5nIGBsZW5ndGhgIGZvcmNlcyBmdWxsXG4gKiBldmFsdWF0aW9uLiBXZSBjYW4gaW1wcm92ZSBwZXJmb3JtYW5jZSBieSBpdGVyYXRpbmcgdW50aWwgYW4gZWxlbWVudCBpc1xuICogYHVuZGVmaW5lZGAgdG8gYXZvaWQgY2hlY2tpbmcgdGhlIGBsZW5ndGhgIHByb3BlcnR5LlxuICogVGVzdCBjYXNlczogaHR0cHM6Ly9qc3BlcmYuY29tL2l0ZXJhdGluZy1vdmVyLWNvbGxlY3Rpb25zLW9mLWVsZW1lbnRzXG4gKiBAcGFyYW0geyFJQXJyYXlMaWtlPFQ+fSBpdGVyYWJsZVxuICogQHBhcmFtIHtmdW5jdGlvbihULCBudW1iZXIpfSBjYlxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGl0ZXJhdGVDdXJzb3IoaXRlcmFibGUsIGNiKSB7XG4gIGZvciAobGV0IGkgPSAwLCB2YWx1ZTsgKHZhbHVlID0gaXRlcmFibGVbaV0pICE9PSB1bmRlZmluZWQ7IGkrKykge1xuICAgIGNiKHZhbHVlLCBpKTtcbiAgfVxufVxuXG4vKipcbiAqIFRoaXMgbWV0aG9kIHdyYXBzIGFyb3VuZCB3aW5kb3cncyBvcGVuIG1ldGhvZC4gSXQgZmlyc3QgdHJpZXMgdG8gZXhlY3V0ZVxuICogYG9wZW5gIGNhbGwgd2l0aCB0aGUgcHJvdmlkZWQgdGFyZ2V0IGFuZCBpZiBpdCBmYWlscywgaXQgcmV0cmllcyB0aGUgY2FsbFxuICogd2l0aCB0aGUgYF90b3BgIHRhcmdldC4gVGhpcyBpcyBuZWNlc3NhcnkgZ2l2ZW4gdGhhdCBpbiBzb21lIGVtYmVkZGluZ1xuICogc2NlbmFyaW9zLCBzdWNoIGFzIGlPUycgV0tXZWJWaWV3LCBuYXZpZ2F0aW9uIHRvIGBfYmxhbmtgIGFuZCBvdGhlciB0YXJnZXRzXG4gKiBpcyBibG9ja2VkIGJ5IGRlZmF1bHQuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YXJnZXRcbiAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X2ZlYXR1cmVzXG4gKiBAcmV0dXJuIHs/V2luZG93fVxuICovXG5leHBvcnQgZnVuY3Rpb24gb3BlbldpbmRvd0RpYWxvZyh3aW4sIHVybCwgdGFyZ2V0LCBvcHRfZmVhdHVyZXMpIHtcbiAgLy8gVHJ5IGZpcnN0IHdpdGggdGhlIHNwZWNpZmllZCB0YXJnZXQuIElmIHdlJ3JlIGluc2lkZSB0aGUgV0tXZWJWaWV3IG9yXG4gIC8vIGEgc2ltaWxhciBlbnZpcm9ubWVudHMsIHRoaXMgbWV0aG9kIGlzIGV4cGVjdGVkIHRvIGZhaWwgYnkgZGVmYXVsdCBmb3JcbiAgLy8gYWxsIHRhcmdldHMgZXhjZXB0IGBfdG9wYC5cbiAgbGV0IHJlcztcbiAgdHJ5IHtcbiAgICByZXMgPSB3aW4ub3Blbih1cmwsIHRhcmdldCwgb3B0X2ZlYXR1cmVzKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGRldigpLmVycm9yKCdET00nLCAnRmFpbGVkIHRvIG9wZW4gdXJsIG9uIHRhcmdldDogJywgdGFyZ2V0LCBlKTtcbiAgfVxuXG4gIC8vIFRoZW4gdHJ5IHdpdGggYF90b3BgIHRhcmdldC5cbiAgaWYgKCFyZXMgJiYgdGFyZ2V0ICE9ICdfdG9wJykge1xuICAgIHJlcyA9IHdpbi5vcGVuKHVybCwgJ190b3AnKTtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGVsZW1lbnQgaXMgYSBzY3JpcHQgdGFnIHdpdGggYXBwbGljYXRpb24vanNvbiB0eXBlLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzSnNvblNjcmlwdFRhZyhlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50LnRhZ05hbWUgPT0gJ1NDUklQVCcgJiZcbiAgICAgICAgICAgIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykudG9VcHBlckNhc2UoKSA9PSAnQVBQTElDQVRJT04vSlNPTic7XG59XG5cbi8qKlxuICogV2hldGhlciB0aGUgZWxlbWVudCBpcyBhIHNjcmlwdCB0YWcgd2l0aCBhcHBsaWNhdGlvbi9qc29uIHR5cGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNKc29uTGRTY3JpcHRUYWcoZWxlbWVudCkge1xuICByZXR1cm4gZWxlbWVudC50YWdOYW1lID09ICdTQ1JJUFQnICYmXG4gICAgICBlbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpLnRvVXBwZXJDYXNlKCkgPT0gJ0FQUExJQ0FUSU9OL0xEK0pTT04nO1xufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHBhZ2UncyBkaXJlY3Rpb24gaXMgcmlnaHQgdG8gbGVmdCBvciBub3QuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNSVEwoZG9jKSB7XG4gIGNvbnN0IGRpciA9IGRvYy5ib2R5LmdldEF0dHJpYnV0ZSgnZGlyJylcbiAgICAgICAgICAgICAgICAgfHwgZG9jLmRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RpcicpXG4gICAgICAgICAgICAgICAgIHx8ICdsdHInO1xuICByZXR1cm4gZGlyID09ICdydGwnO1xufVxuXG5cbi8qKlxuICogRXNjYXBlcyBhbiBpZGVudCAoSUQgb3IgYSBjbGFzcyBuYW1lKSB0byBiZSB1c2VkIGFzIGEgQ1NTIHNlbGVjdG9yLlxuICpcbiAqIFNlZSBodHRwczovL2RyYWZ0cy5jc3N3Zy5vcmcvY3Nzb20vI3NlcmlhbGl6ZS1hbi1pZGVudGlmaWVyLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZGVudFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXNjYXBlQ3NzU2VsZWN0b3JJZGVudChpZGVudCkge1xuICByZXR1cm4gY3NzRXNjYXBlKGlkZW50KTtcbn1cblxuLyoqXG4gKiBFc2NhcGVzIGFuIGlkZW50IGluIGEgd2F5IHRoYXQgY2FuIGJlIHVzZWQgYnkgOm50aC1jaGlsZCgpIHBzdWVkby1jbGFzcy5cbiAqXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3czYy9jc3N3Zy1kcmFmdHMvaXNzdWVzLzIzMDYuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfSBpZGVudFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXNjYXBlQ3NzU2VsZWN0b3JOdGgoaWRlbnQpIHtcbiAgY29uc3QgZXNjYXBlZCA9IFN0cmluZyhpZGVudCk7XG4gIC8vIEVuc3VyZSBpdCBkb2Vzbid0IGNsb3NlIHRoZSBudGgtY2hpbGQgcHN1ZWRvIGNsYXNzLlxuICBkZXYoKS5hc3NlcnQoZXNjYXBlZC5pbmRleE9mKCcpJykgPT09IC0xKTtcbiAgcmV0dXJuIGVzY2FwZWQ7XG59XG5cbi8qKlxuICogRXNjYXBlcyBgPGAsIGA+YCBhbmQgb3RoZXIgSFRNTCBjaGFyY2F0ZXJzIHdpdGggdGhlaXIgZXNjYXBlZCBmb3Jtcy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVIdG1sKHRleHQpIHtcbiAgaWYgKCF0ZXh0KSB7XG4gICAgcmV0dXJuIHRleHQ7XG4gIH1cbiAgcmV0dXJuIHRleHQucmVwbGFjZShIVE1MX0VTQ0FQRV9SRUdFWCwgZXNjYXBlSHRtbENoYXIpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBjXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGVzY2FwZUh0bWxDaGFyKGMpIHtcbiAgcmV0dXJuIEhUTUxfRVNDQVBFX0NIQVJTW2NdO1xufVxuXG4vKipcbiAqIFRyaWVzIHRvIGZvY3VzIG9uIHRoZSBnaXZlbiBlbGVtZW50OyBmYWlscyBzaWxlbnRseSBpZiBicm93c2VyIHRocm93cyBhblxuICogZXhjZXB0aW9uLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ5Rm9jdXMoZWxlbWVudCkge1xuICB0cnkge1xuICAgIGVsZW1lbnQuLypPSyovZm9jdXMoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIC8vIElFIDw9IDcgbWF5IHRocm93IGV4Y2VwdGlvbnMgd2hlbiBmb2N1c2luZyBvbiBoaWRkZW4gaXRlbXMuXG4gIH1cbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBnaXZlbiB3aW5kb3cgaXMgaW4gYW4gaWZyYW1lIG9yIG5vdC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNJZnJhbWVkKHdpbikge1xuICByZXR1cm4gd2luLnBhcmVudCAmJiB3aW4ucGFyZW50ICE9IHdpbjtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmVzIGlmIHRoaXMgZWxlbWVudCBpcyBhbiBBTVAgZWxlbWVudFxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQW1wRWxlbWVudChlbGVtZW50KSB7XG4gIGNvbnN0IHRhZyA9IGVsZW1lbnQudGFnTmFtZTtcbiAgLy8gVXNlIHByZWZpeCB0byByZWNvZ25pemUgQU1QIGVsZW1lbnQuIFRoaXMgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugc3R1YlxuICAvLyBtYXkgbm90IGJlIGF0dGFjaGVkIHlldC5cbiAgcmV0dXJuIHN0YXJ0c1dpdGgodGFnLCAnQU1QLScpICYmXG4gICAgICAvLyBTb21lIFwiYW1wLSpcIiBlbGVtZW50cyBhcmUgbm90IHJlYWxseSBBTVAgZWxlbWVudHMuIDpzbWg6XG4gICAgICAhKHRhZyA9PSAnQU1QLVNUSUNLWS1BRC1UT1AtUEFERElORycgfHwgdGFnID09ICdBTVAtQk9EWScpO1xufVxuXG4vKipcbiAqIFJldHVybiBhIHByb21pc2UgdGhhdCByZXNvbHZlIHdoZW4gYW4gQU1QIGVsZW1lbnQgdXBncmFkZSBmcm9tIEhUTUxFbGVtZW50XG4gKiB0byBDdXN0b21FbGVtZW50XG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aGVuVXBncmFkZWRUb0N1c3RvbUVsZW1lbnQoZWxlbWVudCkge1xuICBkZXYoKS5hc3NlcnQoaXNBbXBFbGVtZW50KGVsZW1lbnQpLCAnZWxlbWVudCBpcyBub3QgQW1wRWxlbWVudCcpO1xuICBpZiAoZWxlbWVudC5jcmVhdGVkQ2FsbGJhY2spIHtcbiAgICAvLyBFbGVtZW50IGFscmVhZHkgaXMgQ3VzdG9tRWxlbWVudDtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGVsZW1lbnQpO1xuICB9XG4gIC8vIElmIEVsZW1lbnQgaXMgc3RpbGwgSFRNTEVsZW1lbnQsIHdhaXQgZm9yIGl0IHRvIHVwZ3JhZGUgdG8gY3VzdG9tRWxlbWVudFxuICAvLyBOb3RlOiB1c2UgcHVyZSBzdHJpbmcgdG8gYXZvaWQgb2JmdXNjYXRpb24gYmV0d2VlbiB2ZXJzaW9ucy5cbiAgaWYgKCFlbGVtZW50W1VQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9QUk9NSVNFXSkge1xuICAgIGNvbnN0IGRlZmVycmVkID0gbmV3IERlZmVycmVkKCk7XG4gICAgZWxlbWVudFtVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUFJPTUlTRV0gPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgIGVsZW1lbnRbVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1JFU09MVkVSXSA9IGRlZmVycmVkLnJlc29sdmU7XG5cbiAgfVxuXG4gIHJldHVybiBlbGVtZW50W1VQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9QUk9NSVNFXTtcbn1cblxuLyoqXG4gKiBSZXBsYWNlbWVudCBmb3IgYEVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4oKWAgbWV0aG9kLlxuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0VsZW1lbnQvcmVxdWVzdEZ1bGxzY3JlZW5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZ1bGxzY3JlZW5FbnRlcihlbGVtZW50KSB7XG4gIGNvbnN0IHJlcXVlc3RGcyA9IGVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW5cbiAgIHx8IGVsZW1lbnQucmVxdWVzdEZ1bGxTY3JlZW5cbiAgIHx8IGVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW5cbiAgIHx8IGVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxTY3JlZW5cbiAgIHx8IGVsZW1lbnQud2Via2l0RW50ZXJGdWxsc2NyZWVuXG4gICB8fCBlbGVtZW50LndlYmtpdEVudGVyRnVsbFNjcmVlblxuICAgfHwgZWxlbWVudC5tc1JlcXVlc3RGdWxsc2NyZWVuXG4gICB8fCBlbGVtZW50Lm1zUmVxdWVzdEZ1bGxTY3JlZW5cbiAgIHx8IGVsZW1lbnQubW96UmVxdWVzdEZ1bGxzY3JlZW5cbiAgIHx8IGVsZW1lbnQubW96UmVxdWVzdEZ1bGxTY3JlZW47XG4gIGlmIChyZXF1ZXN0RnMpIHtcbiAgICByZXF1ZXN0RnMuY2FsbChlbGVtZW50KTtcbiAgfVxufVxuXG4vKipcbiAqIFJlcGxhY2VtZW50IGZvciBgRG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4oKWAgbWV0aG9kLlxuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0RvY3VtZW50L2V4aXRGdWxsc2NyZWVuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmdWxsc2NyZWVuRXhpdChlbGVtZW50KSB7XG4gIGxldCBleGl0RnMgPSBlbGVtZW50LmNhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50LmV4aXRGdWxsc2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC5leGl0RnVsbFNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50LndlYmtpdEV4aXRGdWxsU2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC53ZWJraXRDYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC5tb3pDYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC5tc0V4aXRGdWxsc2NyZWVuO1xuICBpZiAoZXhpdEZzKSB7XG4gICAgZXhpdEZzLmNhbGwoZWxlbWVudCk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChlbGVtZW50Lm93bmVyRG9jdW1lbnQpIHtcbiAgICBleGl0RnMgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuY2FuY2VsRnVsbFNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC5leGl0RnVsbHNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC5leGl0RnVsbFNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC53ZWJraXRFeGl0RnVsbFNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC53ZWJraXRDYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlbjtcbiAgfVxuICBpZiAoZXhpdEZzKSB7XG4gICAgZXhpdEZzLmNhbGwoZWxlbWVudC5vd25lckRvY3VtZW50KTtcbiAgICByZXR1cm47XG4gIH1cbn1cblxuXG4vKipcbiAqIFJlcGxhY2VtZW50IGZvciBgRG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnRgLlxuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0RvY3VtZW50L2Z1bGxzY3JlZW5FbGVtZW50XG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNGdWxsc2NyZWVuRWxlbWVudChlbGVtZW50KSB7XG4gIGNvbnN0IGlzRnVsbHNjcmVlbiA9IGVsZW1lbnQud2Via2l0RGlzcGxheWluZ0Z1bGxzY3JlZW47XG4gIGlmIChpc0Z1bGxzY3JlZW4pIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAoZWxlbWVudC5vd25lckRvY3VtZW50KSB7XG4gICAgY29uc3QgZnVsbHNjcmVlbkVsZW1lbnQgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnRcbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVsZW1lbnRcbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQubW96RnVsbFNjcmVlbkVsZW1lbnRcbiAgICAgICAgICAgICB8fCBlbGVtZW50LndlYmtpdEN1cnJlbnRGdWxsU2NyZWVuRWxlbWVudDtcbiAgICBpZiAoZnVsbHNjcmVlbkVsZW1lbnQgPT0gZWxlbWVudCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgbm9kZSBpcyBub3QgZGlzYWJsZWQuXG4gKlxuICogSUU4IGNhbiByZXR1cm4gZmFsc2UgcG9zaXRpdmVzLCBzZWUge0BsaW5rIG1hdGNoZXN9LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEBzZWUgaHR0cHM6Ly93d3cudzMub3JnL1RSL2h0bWw1L2Zvcm1zLmh0bWwjY29uY2VwdC1mZS1kaXNhYmxlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNFbmFibGVkKGVsZW1lbnQpIHtcbiAgcmV0dXJuICEoZWxlbWVudC5kaXNhYmxlZCB8fCBtYXRjaGVzKGVsZW1lbnQsICc6ZGlzYWJsZWQnKSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0ICogYXMgZG9tIGZyb20gJy4vZG9tJztcbmltcG9ydCB7XG4gIGdldEFtcGRvYyxcbiAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlLFxuICBnZXRTZXJ2aWNlLFxuICBnZXRTZXJ2aWNlUHJvbWlzZSxcbiAgZ2V0U2VydmljZVByb21pc2VGb3JEb2MsXG4gIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsLFxuICBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEZvckRvYyxcbiAgZ2V0VG9wV2luZG93LFxufSBmcm9tICcuL3NlcnZpY2UnO1xuaW1wb3J0IHt0b1dpbn0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQge3VzZXJ9IGZyb20gJy4vbG9nJztcblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIHdpbmRvdy4gQWxzbyBleHBlY3RzIGFuXG4gKiBlbGVtZW50IHRoYXQgaGFzIHRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24uIFRoZSBwcm9taXNlIHJlc29sdmVzIHdoZW4gdGhlXG4gKiBpbXBsZW1lbnRhdGlvbiBsb2FkZWQuIFVzZXJzIHNob3VsZCB0eXBpY2FsbHkgd3JhcCB0aGlzIGFzIGEgc3BlY2lhbCBwdXJwb3NlXG4gKiBmdW5jdGlvbiAoZS5nLiBTZXJ2aWNlcy52aWV3cG9ydEZvckRvYyguLi4pKSBmb3IgdHlwZSBzYWZldHkgYW5kIGJlY2F1c2UgdGhlXG4gKiBmYWN0b3J5IHNob3VsZCBub3QgYmUgcGFzc2VkIGFyb3VuZC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uIE5hbWUgb2YgdGhlIGN1c3RvbSBleHRlbnNpb24gdGhhdCBwcm92aWRlcyB0aGVcbiAqICAgICBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZWxlbWVudCBXaGV0aGVyIHRoaXMgc2VydmljZSBpcyBwcm92aWRlZCBieSBhbiBlbGVtZW50LFxuICogICAgIG5vdCB0aGUgZXh0ZW5zaW9uLlxuICogQHJldHVybiB7IVByb21pc2U8Kj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50U2VydmljZSh3aW4sIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KSB7XG4gIHJldHVybiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpLnRoZW4oXG4gICAgICBzZXJ2aWNlID0+IGFzc2VydFNlcnZpY2Uoc2VydmljZSwgaWQsIGV4dGVuc2lvbikpO1xufVxuXG4vKipcbiAqIFNhbWUgYXMgZ2V0RWxlbWVudFNlcnZpY2UgYnV0IHByb2R1Y2VzIG51bGwgaWYgdGhlIGdpdmVuIGVsZW1lbnQgaXMgbm90XG4gKiBhY3R1YWxseSBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uIE5hbWUgb2YgdGhlIGN1c3RvbSBleHRlbnNpb24gdGhhdCBwcm92aWRlcyB0aGVcbiAqICAgICBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZWxlbWVudCBXaGV0aGVyIHRoaXMgc2VydmljZSBpcyBwcm92aWRlZCBieSBhblxuICogICAgIGVsZW1lbnQsIG5vdCB0aGUgZXh0ZW5zaW9uLlxuICogQHJldHVybiB7IVByb21pc2U8P09iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpIHtcbiAgY29uc3QgcyA9IGdldFNlcnZpY2VQcm9taXNlT3JOdWxsKHdpbiwgaWQpO1xuICBpZiAocykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAocyk7XG4gIH1cbiAgcmV0dXJuIGdldEVsZW1lbnRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGVsZW1lbnROYW1lIE5hbWUgb2YgYW4gZXh0ZW5kZWQgY3VzdG9tIGVsZW1lbnQuXG4gKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoaXMgZWxlbWVudCBpcyBzY2hlZHVsZWQgdG8gYmUgbG9hZGVkLlxuICovXG5mdW5jdGlvbiBpc0VsZW1lbnRTY2hlZHVsZWQod2luLCBlbGVtZW50TmFtZSkge1xuICAvLyBTZXQgaW4gY3VzdG9tLWVsZW1lbnQuanNcbiAgaWYgKCF3aW4uYW1wRXh0ZW5kZWRFbGVtZW50cykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gISF3aW4uYW1wRXh0ZW5kZWRFbGVtZW50c1tlbGVtZW50TmFtZV07XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIHdpbmRvdy4gQWxzbyBleHBlY3RzIGFuXG4gKiBlbGVtZW50IHRoYXQgaGFzIHRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24uIFRoZSBwcm9taXNlIHJlc29sdmVzIHdoZW4gdGhlXG4gKiBpbXBsZW1lbnRhdGlvbiBsb2FkZWQuIFVzZXJzIHNob3VsZCB0eXBpY2FsbHkgd3JhcCB0aGlzIGFzIGEgc3BlY2lhbCBwdXJwb3NlXG4gKiBmdW5jdGlvbiAoZS5nLiBTZXJ2aWNlcy52aWV3cG9ydEZvckRvYyguLi4pKSBmb3IgdHlwZSBzYWZldHkgYW5kIGJlY2F1c2UgdGhlXG4gKiBmYWN0b3J5IHNob3VsZCBub3QgYmUgcGFzc2VkIGFyb3VuZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbiBOYW1lIG9mIHRoZSBjdXN0b20gZXh0ZW5zaW9uIHRoYXQgcHJvdmlkZXMgdGhlXG4gKiAgICAgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBzZXJ2aWNlLlxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2VsZW1lbnQgV2hldGhlciB0aGlzIHNlcnZpY2UgaXMgcHJvdmlkZWQgYnkgYW4gZWxlbWVudCxcbiAqICAgICBub3QgdGhlIGV4dGVuc2lvbi5cbiAqIEByZXR1cm4geyFQcm9taXNlPCo+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCwgZXh0ZW5zaW9uLFxuICBvcHRfZWxlbWVudCkge1xuICByZXR1cm4gZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhcbiAgICAgIGVsZW1lbnRPckFtcERvYywgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpXG4gICAgICAudGhlbihzZXJ2aWNlID0+IGFzc2VydFNlcnZpY2Uoc2VydmljZSwgaWQsIGV4dGVuc2lvbikpO1xufVxuXG4vKipcbiAqIFNhbWUgYXMgZ2V0RWxlbWVudFNlcnZpY2UgYnV0IHByb2R1Y2VzIG51bGwgaWYgdGhlIGdpdmVuIGVsZW1lbnQgaXMgbm90XG4gKiBhY3R1YWxseSBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbiBOYW1lIG9mIHRoZSBjdXN0b20gZXh0ZW5zaW9uIHRoYXQgcHJvdmlkZXMgdGhlXG4gKiAgICAgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBzZXJ2aWNlLlxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2VsZW1lbnQgV2hldGhlciB0aGlzIHNlcnZpY2UgaXMgcHJvdmlkZWQgYnkgYW5cbiAqICAgICBlbGVtZW50LCBub3QgdGhlIGV4dGVuc2lvbi5cbiAqIEByZXR1cm4geyFQcm9taXNlPD9PYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhcbiAgZWxlbWVudE9yQW1wRG9jLCBpZCwgZXh0ZW5zaW9uLCBvcHRfZWxlbWVudCkge1xuICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2MoZWxlbWVudE9yQW1wRG9jKTtcbiAgY29uc3QgcyA9IGdldFNlcnZpY2VQcm9taXNlT3JOdWxsRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpO1xuICBpZiAocykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAocyk7XG4gIH1cblxuICByZXR1cm4gYW1wZG9jLndoZW5Cb2R5QXZhaWxhYmxlKClcbiAgICAgIC50aGVuKCgpID0+IHdhaXRGb3JFeHRlbnNpb25JZlByZXNlbnQoXG4gICAgICAgICAgYW1wZG9jLndpbiwgZXh0ZW5zaW9uLFxuICAgICAgICAgIGFtcGRvYy5nZXRIZWFkTm9kZSgpKSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgLy8gSWYgdGhpcyBzZXJ2aWNlIGlzIHByb3ZpZGVkIGJ5IGFuIGVsZW1lbnQsIHRoZW4gd2UgY2FuJ3QgZGVwZW5kIG9uXG4gICAgICAgIC8vIHRoZSBzZXJ2aWNlICh0aGV5IG1heSBub3QgdXNlIHRoZSBlbGVtZW50KS5cbiAgICAgICAgaWYgKG9wdF9lbGVtZW50KSB7XG4gICAgICAgICAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzRWxlbWVudFNjaGVkdWxlZChhbXBkb2Mud2luLCBleHRlbnNpb24pKSB7XG4gICAgICAgICAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgZm9yIHNlcnZpY2UgZm9yIHRoZSBnaXZlbiBpZCBpbiB0aGUgZW1iZWQgc2NvcGUgb2ZcbiAqIGEgZ2l2ZW4gbm9kZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UsIGZhbGxzIGJhY2sgdG8gYW1wZG9jIHNjb3BlIElGRlxuICogdGhlIGdpdmVuIG5vZGUgaXMgaW4gdGhlIHRvcC1sZXZlbCB3aW5kb3cuXG4gKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb24gTmFtZSBvZiB0aGUgY3VzdG9tIGVsZW1lbnQgdGhhdCBwcm92aWRlc1xuICogICAgIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTw/T2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2NJbkVtYmVkU2NvcGUoXG4gIGVsZW1lbnRPckFtcERvYywgaWQsIGV4dGVuc2lvbikge1xuICBjb25zdCBzID0gZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKGVsZW1lbnRPckFtcERvYywgaWQpO1xuICBpZiAocykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAoUHJvbWlzZS5yZXNvbHZlKHMpKTtcbiAgfVxuICAvLyBSZXR1cm4gZW1iZWQtc2NvcGUgZWxlbWVudCBzZXJ2aWNlIHByb21pc2UgaWYgc2NoZWR1bGVkLlxuICBpZiAoZWxlbWVudE9yQW1wRG9jLm5vZGVUeXBlKSB7XG4gICAgY29uc3Qgd2luID0gdG9XaW4oZWxlbWVudE9yQW1wRG9jLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcpO1xuICAgIGNvbnN0IHRvcFdpbiA9IGdldFRvcFdpbmRvdyh3aW4pO1xuICAgIC8vIEluIGVtYmVkcywgZG9jLXNjb3BlIHNlcnZpY2VzIGFyZSB3aW5kb3ctc2NvcGUuIEJ1dCBtYWtlIHN1cmUgdG9cbiAgICAvLyBvbmx5IGRvIHRoaXMgZm9yIGVtYmVkcyAobm90IHRoZSB0b3Agd2luZG93KSwgb3RoZXJ3aXNlIHdlJ2QgZ3JhYlxuICAgIC8vIGEgcHJvbWlzZSBmcm9tIHRoZSB3cm9uZyBzZXJ2aWNlIGhvbGRlciB3aGljaCB3b3VsZCBuZXZlciByZXNvbHZlLlxuICAgIGlmICh3aW4gIT09IHRvcFdpbikge1xuICAgICAgcmV0dXJuIGdldEVsZW1lbnRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkLCBleHRlbnNpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBGYWxsYmFjayB0byBhbXBkb2MgSUZGIHRoZSBnaXZlbiBub2RlIGlzIF9ub3RfIEZJRS5cbiAgICAgIHJldHVybiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQsIGV4dGVuc2lvbik7XG4gICAgfVxuICB9XG4gIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAoUHJvbWlzZS5yZXNvbHZlKG51bGwpKTtcbn1cblxuLyoqXG4gKiBUaHJvd3MgdXNlciBlcnJvciBpZiBgc2VydmljZWAgaXMgbnVsbC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBzZXJ2aWNlXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb25cbiAqIEByZXR1cm4geyFPYmplY3R9XG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBhc3NlcnRTZXJ2aWNlKHNlcnZpY2UsIGlkLCBleHRlbnNpb24pIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IU9iamVjdH0gKi8gKHVzZXIoKS5hc3NlcnQoc2VydmljZSxcbiAgICAgICdTZXJ2aWNlICVzIHdhcyByZXF1ZXN0ZWQgdG8gYmUgcHJvdmlkZWQgdGhyb3VnaCAlcywgJyArXG4gICAgICAnYnV0ICVzIGlzIG5vdCBsb2FkZWQgaW4gdGhlIGN1cnJlbnQgcGFnZS4gVG8gZml4IHRoaXMgJyArXG4gICAgICAncHJvYmxlbSBsb2FkIHRoZSBKYXZhU2NyaXB0IGZpbGUgZm9yICVzIGluIHRoaXMgcGFnZS4nLFxuICAgICAgaWQsIGV4dGVuc2lvbiwgZXh0ZW5zaW9uLCBleHRlbnNpb24pKTtcbn1cblxuLyoqXG4gKiBHZXQgbGlzdCBvZiBhbGwgdGhlIGV4dGVuc2lvbiBKUyBmaWxlc1xuICogQHBhcmFtIHtIVE1MSGVhZEVsZW1lbnR8RWxlbWVudHxTaGFkb3dSb290fSBoZWFkXG4gKiBAcmV0dXJuIHshQXJyYXk8c3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dGVuc2lvblNjcmlwdHNJbk5vZGUoaGVhZCkge1xuICAvLyBhbXBkb2MuZ2V0SGVhZE5vZGUoKSBjYW4gcmV0dXJuIG51bGxcbiAgaWYgKCFoZWFkKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGNvbnN0IHNjcmlwdHMgPSBbXTtcbiAgY29uc3QgbGlzdCA9IGhlYWQucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0W2N1c3RvbS1lbGVtZW50XScpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICBzY3JpcHRzLnB1c2gobGlzdFtpXS5nZXRBdHRyaWJ1dGUoJ2N1c3RvbS1lbGVtZW50JykpO1xuICB9XG4gIHJldHVybiBzY3JpcHRzO1xufVxuXG4vKipcbiAqIFdhaXRzIGZvciBib2R5IHRvIGJlIHByZXNlbnQgdGhlbiB2ZXJpZmllcyB0aGF0IGFuIGV4dGVuc2lvbiBzY3JpcHQgaXNcbiAqIHByZXNlbnQgaW4gaGVhZCBmb3IgaW5zdGFsbGF0aW9uLlxuICogQHBhcmFtIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uSWRcbiAqIEByZXR1cm4geyFQcm9taXNlPGJvb2xlYW4+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNFeHRlbnNpb25TY3JpcHRJbk5vZGUoYW1wZG9jLCBleHRlbnNpb25JZCkge1xuICByZXR1cm4gYW1wZG9jLndoZW5Cb2R5QXZhaWxhYmxlKClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgcmV0dXJuIGV4dGVuc2lvblNjcmlwdEluTm9kZShcbiAgICAgICAgICAgIGFtcGRvYy5nZXRIZWFkTm9kZSgpLCBleHRlbnNpb25JZCk7XG4gICAgICB9KTtcbn1cblxuLyoqXG4gKiBWZXJpZmllcyB0aGF0IGFuIGV4dGVuc2lvbiBzY3JpcHQgaXMgcHJlc2VudCBpbiBoZWFkIGZvclxuICogaW5zdGFsbGF0aW9uLlxuICogQHBhcmFtIHtIVE1MSGVhZEVsZW1lbnR8RWxlbWVudHxTaGFkb3dSb290fSBoZWFkXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uSWRcbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIGV4dGVuc2lvblNjcmlwdEluTm9kZShoZWFkLCBleHRlbnNpb25JZCkge1xuICByZXR1cm4gZXh0ZW5zaW9uU2NyaXB0c0luTm9kZShoZWFkKS5pbmNsdWRlcyhleHRlbnNpb25JZCk7XG59XG5cbi8qKlxuICogV2FpdHMgZm9yIGFuIGV4dGVuc2lvbiBpZiBpdHMgc2NyaXB0IGlzIHByZXNlbnRcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uXG4gKiBAcGFyYW0ge0hUTUxIZWFkRWxlbWVudHxFbGVtZW50fFNoYWRvd1Jvb3R9IGhlYWRcbiAqIEByZXR1cm4geyFQcm9taXNlfVxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gd2FpdEZvckV4dGVuc2lvbklmUHJlc2VudCh3aW4sIGV4dGVuc2lvbiwgaGVhZCkge1xuICAvKipcbiAgICogSWYgdGhlcmUgaXMgYW4gZXh0ZW5zaW9uIHNjcmlwdCB3YWl0IGZvciBpdCB0byBsb2FkIGJlZm9yZSB0cnlpbmdcbiAgICogdG8gZ2V0IHRoZSBzZXJ2aWNlLiBQcmV2ZW50cyBhIHJhY2UgY29uZGl0aW9uIHdoZW4gZXZlcnl0aGluZyBidXRcbiAgICogdGhlIGV4dGVuc2lvbnMgaXMgaW4gY2FjaGUuIElmIHRoZXJlIGlzIG5vIHNjcmlwdCB0aGVuIGl0J3MgZWl0aGVyXG4gICAqIG5vdCBwcmVzZW50LCBvciB0aGUgc2VydmljZSB3YXMgZGVmaW5lZCBieSBhIHRlc3QuIEluIHRob3NlIGNhc2VzXG4gICAqIHdlIGRvbid0IHdhaXQgYXJvdW5kIGZvciBhbiBleHRlbnNpb24gdGhhdCBkb2VzIG5vdCBleGlzdC5cbiAgICovXG5cbiAgLy8gVE9ETyhqcGV0dGl0dCkgaW52ZXN0aWdhdGUgcmVnaXN0ZXJFeHRlbnNpb24gdG8gc2hvcnQgY2lyY3VpdFxuICAvLyB0aGUgZG9tIGNhbGwgaW4gZXh0ZW5zaW9uU2NyaXB0c0luTm9kZSgpXG4gIGlmICghZXh0ZW5zaW9uU2NyaXB0SW5Ob2RlKGhlYWQsIGV4dGVuc2lvbikpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH1cblxuICBjb25zdCBleHRlbnNpb25zID0gZ2V0U2VydmljZSh3aW4sICdleHRlbnNpb25zJyk7XG4gIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAoXG4gICAgZXh0ZW5zaW9ucy53YWl0Rm9yRXh0ZW5zaW9uKHdpbiwgZXh0ZW5zaW9uKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgcHJvbWlzZSBmb3Igc2VydmljZSB3aXRoIGBpZGAgb24gdGhlIGdpdmVuIHdpbmRvdyBpZiBhdmFpbGFibGUuXG4gKiBPdGhlcndpc2UsIHJlc29sdmVzIHdpdGggbnVsbCAoc2VydmljZSB3YXMgbm90IHJlZ2lzdGVyZWQpLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvblxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2VsZW1lbnRcbiAqIEByZXR1cm4geyFQcm9taXNlPE9iamVjdD59XG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBnZXRFbGVtZW50U2VydmljZVByb21pc2VPck51bGwod2luLCBpZCwgZXh0ZW5zaW9uLCBvcHRfZWxlbWVudCkge1xuICByZXR1cm4gZG9tLndhaXRGb3JCb2R5UHJvbWlzZSh3aW4uZG9jdW1lbnQpXG4gICAgICAudGhlbigoKSA9PiB3YWl0Rm9yRXh0ZW5zaW9uSWZQcmVzZW50KHdpbiwgZXh0ZW5zaW9uLCB3aW4uZG9jdW1lbnQuaGVhZCkpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIC8vIElmIHRoaXMgc2VydmljZSBpcyBwcm92aWRlZCBieSBhbiBlbGVtZW50LCB0aGVuIHdlIGNhbid0IGRlcGVuZCBvblxuICAgICAgICAvLyB0aGUgc2VydmljZSAodGhleSBtYXkgbm90IHVzZSB0aGUgZWxlbWVudCkuXG4gICAgICAgIGlmIChvcHRfZWxlbWVudCkge1xuICAgICAgICAgIHJldHVybiBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkKTtcbiAgICAgICAgfSBlbHNlIGlmIChpc0VsZW1lbnRTY2hlZHVsZWQod2luLCBleHRlbnNpb24pKSB7XG4gICAgICAgICAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlKHdpbiwgaWQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IEV4cGVyaW1lbnRzIHN5c3RlbSBhbGxvd3MgYSBkZXZlbG9wZXIgdG8gb3B0LWluIHRvIHRlc3RcbiAqIGZlYXR1cmVzIHRoYXQgYXJlIG5vdCB5ZXQgZnVsbHkgdGVzdGVkLlxuICpcbiAqIEV4cGVyaW1lbnRzIHBhZ2U6IGh0dHBzOi8vY2RuLmFtcHByb2plY3Qub3JnL2V4cGVyaW1lbnRzLmh0bWwgKlxuICovXG5cbmltcG9ydCB7Z2V0Q29va2llLCBzZXRDb29raWV9IGZyb20gJy4vY29va2llcyc7XG5pbXBvcnQge2hhc093bn0gZnJvbSAnLi91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtwYXJzZVF1ZXJ5U3RyaW5nfSBmcm9tICcuL3VybCc7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmNvbnN0IENPT0tJRV9OQU1FID0gJ0FNUF9FWFAnO1xuXG4vKiogQGNvbnN0IHtudW1iZXJ9ICovXG5jb25zdCBDT09LSUVfTUFYX0FHRV9EQVlTID0gMTgwOyAvLyA2IG1vbnRoXG5cbi8qKiBAY29uc3Qge3RpbWV9ICovXG5jb25zdCBDT09LSUVfRVhQSVJBVElPTl9JTlRFUlZBTCA9IENPT0tJRV9NQVhfQUdFX0RBWVMgKiAyNCAqIDYwICogNjAgKiAxMDAwO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5jb25zdCBUT0dHTEVTX1dJTkRPV19QUk9QRVJUWSA9ICdfX0FNUF9fRVhQRVJJTUVOVF9UT0dHTEVTJztcblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBpc1RyYWZmaWNFbGlnaWJsZTogZnVuY3Rpb24oIVdpbmRvdyk6Ym9vbGVhbixcbiAqICAgYnJhbmNoZXM6ICFBcnJheTxzdHJpbmc+XG4gKiB9fVxuICovXG5leHBvcnQgbGV0IEV4cGVyaW1lbnRJbmZvO1xuXG4vKipcbiAqIFdoZXRoZXIgd2UgYXJlIGluIGNhbmFyeS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNDYW5hcnkod2luKSB7XG4gIHJldHVybiAhISh3aW4uQU1QX0NPTkZJRyAmJiB3aW4uQU1QX0NPTkZJRy5jYW5hcnkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYmluYXJ5IHR5cGUsIGUuZy4sIGNhbmFyeSwgY29udHJvbCwgb3IgcHJvZHVjdGlvbi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRCaW5hcnlUeXBlKHdpbikge1xuICByZXR1cm4gd2luLkFNUF9DT05GSUcgJiYgd2luLkFNUF9DT05GSUcudHlwZSA/XG4gICAgd2luLkFNUF9DT05GSUcudHlwZSA6ICd1bmtub3duJztcbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBzcGVjaWZpZWQgZXhwZXJpbWVudCBpcyBvbiBvciBvZmYuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGV4cGVyaW1lbnRJZFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRXhwZXJpbWVudE9uKHdpbiwgZXhwZXJpbWVudElkKSB7XG4gIGNvbnN0IHRvZ2dsZXMgPSBleHBlcmltZW50VG9nZ2xlcyh3aW4pO1xuICByZXR1cm4gISF0b2dnbGVzW2V4cGVyaW1lbnRJZF07XG59XG5cbi8qKlxuICogVG9nZ2xlcyB0aGUgZXhwZXJpbWVudCBvbiBvciBvZmYuIFJldHVybnMgdGhlIGFjdHVhbCB2YWx1ZSBvZiB0aGUgZXhwZXJpbWVudFxuICogYWZ0ZXIgdG9nZ2xpbmcgaXMgZG9uZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gZXhwZXJpbWVudElkXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfb25cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF90cmFuc2llbnRFeHBlcmltZW50ICBXaGV0aGVyIHRvIHRvZ2dsZSB0aGVcbiAqICAgICBleHBlcmltZW50IHN0YXRlIFwidHJhbnNpZW50bHlcIiAoaS5lLiwgZm9yIHRoaXMgcGFnZSBsb2FkIG9ubHkpIG9yXG4gKiAgICAgZHVyYWJseSAoYnkgc2F2aW5nIHRoZSBleHBlcmltZW50IElEcyB0byB0aGUgY29va2llIGFmdGVyIHRvZ2dsaW5nKS5cbiAqICAgICBEZWZhdWx0OiBmYWxzZSAoc2F2ZSBkdXJhYmx5KS5cbiAqIEByZXR1cm4ge2Jvb2xlYW59IE5ldyBzdGF0ZSBmb3IgZXhwZXJpbWVudElkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlRXhwZXJpbWVudCh3aW4sIGV4cGVyaW1lbnRJZCwgb3B0X29uLFxuICBvcHRfdHJhbnNpZW50RXhwZXJpbWVudCkge1xuICBjb25zdCBjdXJyZW50bHlPbiA9IGlzRXhwZXJpbWVudE9uKHdpbiwgLypPSyovZXhwZXJpbWVudElkKTtcbiAgY29uc3Qgb24gPSAhIShvcHRfb24gIT09IHVuZGVmaW5lZCA/IG9wdF9vbiA6ICFjdXJyZW50bHlPbik7XG4gIGlmIChvbiAhPSBjdXJyZW50bHlPbikge1xuICAgIGNvbnN0IHRvZ2dsZXMgPSBleHBlcmltZW50VG9nZ2xlcyh3aW4pO1xuICAgIHRvZ2dsZXNbZXhwZXJpbWVudElkXSA9IG9uO1xuXG4gICAgaWYgKCFvcHRfdHJhbnNpZW50RXhwZXJpbWVudCkge1xuICAgICAgY29uc3QgY29va2llVG9nZ2xlcyA9IGdldEV4cGVyaW1lbnRUb2dnbGVzRnJvbUNvb2tpZSh3aW4pO1xuICAgICAgY29va2llVG9nZ2xlc1tleHBlcmltZW50SWRdID0gb247XG4gICAgICBzYXZlRXhwZXJpbWVudFRvZ2dsZXNUb0Nvb2tpZSh3aW4sIGNvb2tpZVRvZ2dsZXMpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gb247XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIHdoZXRoZXIgdGhlIGV4cGVyaW1lbnQgaXMgb24gb3Igb2ZmIGJhc2VkIG9mZiBvZiB0aGVcbiAqIGNvb2tpZUZsYWcgb3IgdGhlIGdsb2JhbCBjb25maWcgZnJlcXVlbmN5IGdpdmVuLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4cGVyaW1lbnRUb2dnbGVzKHdpbikge1xuICBpZiAod2luW1RPR0dMRVNfV0lORE9XX1BST1BFUlRZXSkge1xuICAgIHJldHVybiB3aW5bVE9HR0xFU19XSU5ET1dfUFJPUEVSVFldO1xuICB9XG4gIHdpbltUT0dHTEVTX1dJTkRPV19QUk9QRVJUWV0gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBjb25zdCB0b2dnbGVzID0gd2luW1RPR0dMRVNfV0lORE9XX1BST1BFUlRZXTtcblxuICAvLyBSZWFkIHRoZSBkZWZhdWx0IGNvbmZpZyBvZiB0aGlzIGJ1aWxkLlxuICBpZiAod2luLkFNUF9DT05GSUcpIHtcbiAgICBmb3IgKGNvbnN0IGV4cGVyaW1lbnRJZCBpbiB3aW4uQU1QX0NPTkZJRykge1xuICAgICAgY29uc3QgZnJlcXVlbmN5ID0gd2luLkFNUF9DT05GSUdbZXhwZXJpbWVudElkXTtcbiAgICAgIGlmICh0eXBlb2YgZnJlcXVlbmN5ID09PSAnbnVtYmVyJyAmJiBmcmVxdWVuY3kgPj0gMCAmJiBmcmVxdWVuY3kgPD0gMSkge1xuICAgICAgICB0b2dnbGVzW2V4cGVyaW1lbnRJZF0gPSBNYXRoLnJhbmRvbSgpIDwgZnJlcXVlbmN5O1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAvLyBSZWFkIGRvY3VtZW50IGxldmVsIG92ZXJyaWRlIGZyb20gbWV0YSB0YWcuXG4gIGlmICh3aW4uQU1QX0NPTkZJR1xuICAgICAgJiYgQXJyYXkuaXNBcnJheSh3aW4uQU1QX0NPTkZJR1snYWxsb3ctZG9jLW9wdC1pbiddKVxuICAgICAgJiYgd2luLkFNUF9DT05GSUdbJ2FsbG93LWRvYy1vcHQtaW4nXS5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgYWxsb3dlZCA9IHdpbi5BTVBfQ09ORklHWydhbGxvdy1kb2Mtb3B0LWluJ107XG4gICAgY29uc3QgbWV0YSA9XG4gICAgICAgIHdpbi5kb2N1bWVudC5oZWFkLnF1ZXJ5U2VsZWN0b3IoJ21ldGFbbmFtZT1cImFtcC1leHBlcmltZW50cy1vcHQtaW5cIl0nKTtcbiAgICBpZiAobWV0YSkge1xuICAgICAgY29uc3Qgb3B0ZWRJbkV4cGVyaW1lbnRzID0gbWV0YS5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKS5zcGxpdCgnLCcpO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcHRlZEluRXhwZXJpbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGFsbG93ZWQuaW5kZXhPZihvcHRlZEluRXhwZXJpbWVudHNbaV0pICE9IC0xKSB7XG4gICAgICAgICAgdG9nZ2xlc1tvcHRlZEluRXhwZXJpbWVudHNbaV1dID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIE9iamVjdC5hc3NpZ24odG9nZ2xlcywgZ2V0RXhwZXJpbWVudFRvZ2dsZXNGcm9tQ29va2llKHdpbikpO1xuXG4gIGlmICh3aW4uQU1QX0NPTkZJR1xuICAgICAgJiYgQXJyYXkuaXNBcnJheSh3aW4uQU1QX0NPTkZJR1snYWxsb3ctdXJsLW9wdC1pbiddKVxuICAgICAgJiYgd2luLkFNUF9DT05GSUdbJ2FsbG93LXVybC1vcHQtaW4nXS5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgYWxsb3dlZCA9IHdpbi5BTVBfQ09ORklHWydhbGxvdy11cmwtb3B0LWluJ107XG4gICAgY29uc3QgaGFzaCA9IHdpbi5sb2NhdGlvbi5vcmlnaW5hbEhhc2ggfHwgd2luLmxvY2F0aW9uLmhhc2g7XG4gICAgY29uc3QgcGFyYW1zID0gcGFyc2VRdWVyeVN0cmluZyhoYXNoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbG93ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHBhcmFtID0gcGFyYW1zW2BlLSR7YWxsb3dlZFtpXX1gXTtcbiAgICAgIGlmIChwYXJhbSA9PSAnMScpIHtcbiAgICAgICAgdG9nZ2xlc1thbGxvd2VkW2ldXSA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAocGFyYW0gPT0gJzAnKSB7XG4gICAgICAgIHRvZ2dsZXNbYWxsb3dlZFtpXV0gPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRvZ2dsZXM7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgY2FjaGVkIGV4cGVyaW1lbnRzIHRvZ2dsZXMsIG9yIG51bGwgaWYgdGhleSBoYXZlIG5vdCBiZWVuXG4gKiBjb21wdXRlZCB5ZXQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7T2JqZWN0PHN0cmluZywgYm9vbGVhbj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHBlcmltZW50VG9nZ2xlc09yTnVsbCh3aW4pIHtcbiAgcmV0dXJuIHdpbltUT0dHTEVTX1dJTkRPV19QUk9QRVJUWV0gfHwgbnVsbDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2V0IG9mIGV4cGVyaW1lbnQgSURzIGN1cnJlbnRseSBvbi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgYm9vbGVhbj59XG4gKi9cbmZ1bmN0aW9uIGdldEV4cGVyaW1lbnRUb2dnbGVzRnJvbUNvb2tpZSh3aW4pIHtcbiAgY29uc3QgZXhwZXJpbWVudENvb2tpZSA9IGdldENvb2tpZSh3aW4sIENPT0tJRV9OQU1FKTtcbiAgY29uc3QgdG9rZW5zID0gZXhwZXJpbWVudENvb2tpZSA/IGV4cGVyaW1lbnRDb29raWUuc3BsaXQoL1xccyosXFxzKi9nKSA6IFtdO1xuXG4gIGNvbnN0IHRvZ2dsZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHRva2Vucy5sZW5ndGg7IGkrKykge1xuICAgIGlmICh0b2tlbnNbaV0ubGVuZ3RoID09IDApIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAodG9rZW5zW2ldWzBdID09ICctJykge1xuICAgICAgdG9nZ2xlc1t0b2tlbnNbaV0uc3Vic3RyKDEpXSA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0b2dnbGVzW3Rva2Vuc1tpXV0gPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0b2dnbGVzO1xufVxuXG4vKipcbiAqIFNhdmVzIGEgc2V0IG9mIGV4cGVyaW1lbnQgSURzIGN1cnJlbnRseSBvbi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPn0gdG9nZ2xlc1xuICovXG5mdW5jdGlvbiBzYXZlRXhwZXJpbWVudFRvZ2dsZXNUb0Nvb2tpZSh3aW4sIHRvZ2dsZXMpIHtcbiAgY29uc3QgZXhwZXJpbWVudElkcyA9IFtdO1xuICBmb3IgKGNvbnN0IGV4cGVyaW1lbnQgaW4gdG9nZ2xlcykge1xuICAgIGV4cGVyaW1lbnRJZHMucHVzaCgodG9nZ2xlc1tleHBlcmltZW50XSA9PT0gZmFsc2UgPyAnLScgOiAnJykgKyBleHBlcmltZW50KTtcbiAgfVxuXG4gIHNldENvb2tpZSh3aW4sIENPT0tJRV9OQU1FLCBleHBlcmltZW50SWRzLmpvaW4oJywnKSxcbiAgICAgIERhdGUubm93KCkgKyBDT09LSUVfRVhQSVJBVElPTl9JTlRFUlZBTCwge1xuICAgICAgICAvLyBTZXQgZXhwbGljaXQgZG9tYWluLCBzbyB0aGUgY29va2llIGdldHMgc2VuZCB0byBzdWIgZG9tYWlucy5cbiAgICAgICAgZG9tYWluOiB3aW4ubG9jYXRpb24uaG9zdG5hbWUsXG4gICAgICAgIGFsbG93T25Qcm94eU9yaWdpbjogdHJ1ZSxcbiAgICAgIH0pO1xufVxuXG4vKipcbiAqIFNlZSBnZXRFeHBlcmltZW50VG9nZ2xlc0Zyb21Db29raWUoKS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgYm9vbGVhbj59XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4cGVyaW1lbnRUb2dsZXNGcm9tQ29va2llRm9yVGVzdGluZyh3aW4pIHtcbiAgcmV0dXJuIGdldEV4cGVyaW1lbnRUb2dnbGVzRnJvbUNvb2tpZSh3aW4pO1xufVxuXG4vKipcbiAqIFJlc2V0cyB0aGUgZXhwZXJpbWVudHNUb2dnbGUgY2FjaGUgZm9yIHRlc3RpbmcgcHVycG9zZXMuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldEV4cGVyaW1lbnRUb2dnbGVzRm9yVGVzdGluZyh3aW4pIHtcbiAgc2V0Q29va2llKHdpbiwgQ09PS0lFX05BTUUsICcnLCAwLCB7XG4gICAgZG9tYWluOiB3aW4ubG9jYXRpb24uaG9zdG5hbWUsXG4gIH0pO1xuICB3aW5bVE9HR0xFU19XSU5ET1dfUFJPUEVSVFldID0gbnVsbDtcbn1cblxuLyoqXG4gKiBJbiBzb21lIGJyb3dzZXIgaW1wbGVtZW50YXRpb25zIG9mIE1hdGgucmFuZG9tKCksIHNlcXVlbnRpYWwgY2FsbHMgb2ZcbiAqIE1hdGgucmFuZG9tKCkgYXJlIGNvcnJlbGF0ZWQgYW5kIGNhbiBjYXVzZSBhIGJpYXMuICBJbiBwYXJ0aWN1bGFyLFxuICogaWYgdGhlIHByZXZpb3VzIHJhbmRvbSgpIGNhbGwgd2FzIDwgMC4wMDEgKGFzIGl0IHdpbGwgYmUgaWYgd2Ugc2VsZWN0XG4gKiBpbnRvIGFuIGV4cGVyaW1lbnQpLCB0aGUgbmV4dCB2YWx1ZSBjb3VsZCBiZSBsZXNzIHRoYW4gMC41IG1vcmUgdGhhblxuICogNTAuNyUgb2YgdGhlIHRpbWUuICBUaGlzIHByb3ZpZGVzIGFuIGltcGxlbWVudGF0aW9uIHRoYXQgcm9vdHMgZG93biBpbnRvXG4gKiB0aGUgY3J5cHRvIEFQSSwgd2hlbiBhdmFpbGFibGUsIHRvIHByb2R1Y2UgbGVzcyBiaWFzZWQgc2FtcGxlcy5cbiAqXG4gKiBAcmV0dXJuIHtudW1iZXJ9IFBzZXVkby1yYW5kb20gZmxvYXRpbmctcG9pbnQgdmFsdWUgb24gdGhlIHJhbmdlIFswLCAxKS5cbiAqL1xuZnVuY3Rpb24gc2xvd0J1dEFjY3VyYXRlUHJuZygpIHtcbiAgLy8gVE9ETyh0ZHJsKTogSW1wbGVtZW50LlxuICByZXR1cm4gTWF0aC5yYW5kb20oKTtcbn1cblxuLyoqXG4gKiBDb250YWluZXIgZm9yIGFsdGVybmF0ZSByYW5kb20gbnVtYmVyIGdlbmVyYXRvciBpbXBsZW1lbnRhdGlvbnMuICBUaGlzXG4gKiBhbGxvd3MgdXMgdG8gc2V0IGFuIFwiYWNjdXJhdGVcIiBQUk5HIGZvciBicmFuY2ggc2VsZWN0aW9uLCBidXQgdG8gbW9jayBpdFxuICogb3V0IGVhc2lseSBpbiB0ZXN0cy5cbiAqXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqIEBjb25zdCB7IXthY2N1cmF0ZVBybmc6IGZ1bmN0aW9uKCk6bnVtYmVyfX1cbiAqL1xuZXhwb3J0IGNvbnN0IFJBTkRPTV9OVU1CRVJfR0VORVJBVE9SUyA9IHtcbiAgYWNjdXJhdGVQcm5nOiBzbG93QnV0QWNjdXJhdGVQcm5nLFxufTtcblxuLyoqXG4gKiBTZWxlY3RzLCB1bmlmb3JtbHkgYXQgcmFuZG9tLCBhIHNpbmdsZSBpdGVtIGZyb20gdGhlIGFycmF5LlxuICogQHBhcmFtIHshQXJyYXk8c3RyaW5nPn0gYXJyIE9iamVjdCB0byBzZWxlY3QgZnJvbS5cbiAqIEByZXR1cm4gez9zdHJpbmd9IFNpbmdsZSBpdGVtIGZyb20gYXJyIG9yIG51bGwgaWYgYXJyIHdhcyBlbXB0eS5cbiAqL1xuZnVuY3Rpb24gc2VsZWN0UmFuZG9tSXRlbShhcnIpIHtcbiAgY29uc3Qgcm4gPSBSQU5ET01fTlVNQkVSX0dFTkVSQVRPUlMuYWNjdXJhdGVQcm5nKCk7XG4gIHJldHVybiBhcnJbTWF0aC5mbG9vcihybiAqIGFyci5sZW5ndGgpXSB8fCBudWxsO1xufVxuXG4vKipcbiAqIFNlbGVjdHMgd2hpY2ggcGFnZS1sZXZlbCBleHBlcmltZW50IGJyYW5jaGVzIGFyZSBlbmFibGVkLiBJZiBhIGdpdmVuXG4gKiBleHBlcmltZW50IG5hbWUgaXMgYWxyZWFkeSBzZXQgKGluY2x1ZGluZyB0byB0aGUgbnVsbCAvIG5vIGJyYW5jaGVzIHNlbGVjdGVkXG4gKiBzdGF0ZSksIHRoaXMgd29uJ3QgYWx0ZXIgaXRzIHN0YXRlLlxuICpcbiAqIENoZWNrIHdoZXRoZXIgYSBnaXZlbiBleHBlcmltZW50IGlzIHNldCB1c2luZyBpc0V4cGVyaW1lbnRPbih3aW4sXG4gKiBleHBlcmltZW50TmFtZSkgYW5kLCBpZiBpdCBpcyBvbiwgbG9vayBmb3Igd2hpY2ggYnJhbmNoIGlzIHNlbGVjdGVkIGluXG4gKiB3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXS5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpbiBXaW5kb3cgY29udGV4dCBvbiB3aGljaCB0byBzYXZlIGV4cGVyaW1lbnRcbiAqICAgICBzZWxlY3Rpb24gc3RhdGUuXG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAhRXhwZXJpbWVudEluZm8+fSBleHBlcmltZW50cyAgU2V0IG9mIGV4cGVyaW1lbnRzIHRvXG4gKiAgICAgY29uZmlndXJlIGZvciB0aGlzIHBhZ2UgbG9hZC5cbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBNYXAgb2YgZXhwZXJpbWVudCBuYW1lcyB0byBzZWxlY3RlZFxuICogICAgIGJyYW5jaGVzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tbHlTZWxlY3RVbnNldEV4cGVyaW1lbnRzKHdpbiwgZXhwZXJpbWVudHMpIHtcbiAgd2luLmV4cGVyaW1lbnRCcmFuY2hlcyA9IHdpbi5leHBlcmltZW50QnJhbmNoZXMgfHwge307XG4gIGNvbnN0IHNlbGVjdGVkRXhwZXJpbWVudHMgPSB7fTtcbiAgZm9yIChjb25zdCBleHBlcmltZW50TmFtZSBpbiBleHBlcmltZW50cykge1xuICAgIC8vIFNraXAgZXhwZXJpbWVudE5hbWUgaWYgaXQgaXMgbm90IGEga2V5IG9mIGV4cGVyaW1lbnRzIG9iamVjdCBvciBpZiBpdFxuICAgIC8vIGhhcyBhbHJlYWR5IGJlZW4gcG9wdWxhdGVkIGJ5IHNvbWUgb3RoZXIgcHJvcGVydHkuXG4gICAgaWYgKCFoYXNPd24oZXhwZXJpbWVudHMsIGV4cGVyaW1lbnROYW1lKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChoYXNPd24od2luLmV4cGVyaW1lbnRCcmFuY2hlcywgZXhwZXJpbWVudE5hbWUpKSB7XG4gICAgICBzZWxlY3RlZEV4cGVyaW1lbnRzW2V4cGVyaW1lbnROYW1lXSA9XG4gICAgICAgICAgd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV07XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoIWV4cGVyaW1lbnRzW2V4cGVyaW1lbnROYW1lXS5pc1RyYWZmaWNFbGlnaWJsZSB8fFxuICAgICAgICAhZXhwZXJpbWVudHNbZXhwZXJpbWVudE5hbWVdLmlzVHJhZmZpY0VsaWdpYmxlKHdpbikpIHtcbiAgICAgIHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdID0gbnVsbDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIC8vIElmIHdlJ3JlIGluIHRoZSBleHBlcmltZW50LCBidXQgd2UgaGF2ZW4ndCBhbHJlYWR5IGZvcmNlZCBhIHNwZWNpZmljXG4gICAgLy8gZXhwZXJpbWVudCBicmFuY2ggKGUuZy4sIHZpYSBhIHRlc3Qgc2V0dXApLCB0aGVuIHJhbmRvbWl6ZSB0aGUgYnJhbmNoXG4gICAgLy8gY2hvaWNlLlxuICAgIGlmICghd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV0gJiZcbiAgICAgIGlzRXhwZXJpbWVudE9uKHdpbiwgLypPSyovZXhwZXJpbWVudE5hbWUpKSB7XG4gICAgICBjb25zdCB7YnJhbmNoZXN9ID0gZXhwZXJpbWVudHNbZXhwZXJpbWVudE5hbWVdO1xuICAgICAgd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV0gPSBzZWxlY3RSYW5kb21JdGVtKGJyYW5jaGVzKTtcbiAgICAgIHNlbGVjdGVkRXhwZXJpbWVudHNbZXhwZXJpbWVudE5hbWVdID1cbiAgICAgICAgICB3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHNlbGVjdGVkRXhwZXJpbWVudHM7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZXhwZXJpbWVudCBicmFuY2ggZW5hYmxlZCBmb3IgdGhlIGdpdmVuIGV4cGVyaW1lbnQgSUQuXG4gKiBGb3IgZXhhbXBsZSwgJ2NvbnRyb2wnIG9yICdleHBlcmltZW50Jy5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpbiBXaW5kb3cgY29udGV4dCB0byBjaGVjayBmb3IgZXhwZXJpbWVudCBzdGF0ZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHBlcmltZW50TmFtZSBOYW1lIG9mIHRoZSBleHBlcmltZW50IHRvIGNoZWNrLlxuICogQHJldHVybiB7P3N0cmluZ30gQWN0aXZlIGV4cGVyaW1lbnQgYnJhbmNoIElEIGZvciBleHBlcmltZW50TmFtZSAocG9zc2libHlcbiAqICAgICBudWxsIGlmIGV4cGVyaW1lbnROYW1lIGhhcyBiZWVuIHRlc3RlZCBidXQgbm8gYnJhbmNoIHdhcyBlbmFibGVkKS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4cGVyaW1lbnRCcmFuY2god2luLCBleHBlcmltZW50TmFtZSkge1xuICByZXR1cm4gd2luLmV4cGVyaW1lbnRCcmFuY2hlcyA/IHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdIDogbnVsbDtcbn1cblxuLyoqXG4gKiBGb3JjZSBlbmFibGUgKG9yIGRpc2FibGUpIGEgc3BlY2lmaWMgYnJhbmNoIG9mIGEgZ2l2ZW4gZXhwZXJpbWVudCBuYW1lLlxuICogRGlzYWJsZXMgdGhlIGV4cGVyaW1lbnQgbmFtZSBhbHRvZ2V0aGVyIGlmIGJyYW5jaElkIGlzIGZhbHNlaXNoLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luIFdpbmRvdyBjb250ZXh0IHRvIGNoZWNrIGZvciBleHBlcmltZW50IHN0YXRlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4cGVyaW1lbnROYW1lIE5hbWUgb2YgdGhlIGV4cGVyaW1lbnQgdG8gY2hlY2suXG4gKiBAcGFyYW0gez9zdHJpbmd9IGJyYW5jaElkIElEIG9mIGJyYW5jaCB0byBmb3JjZSBvciBudWxsIHRvIGRpc2FibGVcbiAqICAgICBhbHRvZ2V0aGVyLlxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JjZUV4cGVyaW1lbnRCcmFuY2god2luLCBleHBlcmltZW50TmFtZSwgYnJhbmNoSWQpIHtcbiAgd2luLmV4cGVyaW1lbnRCcmFuY2hlcyA9IHdpbi5leHBlcmltZW50QnJhbmNoZXMgfHwge307XG4gIHRvZ2dsZUV4cGVyaW1lbnQod2luLCBleHBlcmltZW50TmFtZSwgISFicmFuY2hJZCwgdHJ1ZSk7XG4gIHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdID0gYnJhbmNoSWQ7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IFRoaXMgbW9kdWxlIGRlY2xhcmVzIEpTT04gdHlwZXMgYXMgZGVmaW5lZCBpbiB0aGVcbiAqIHtAbGluayBodHRwOi8vanNvbi5vcmcvfS5cbiAqL1xuXG5pbXBvcnQge2lzT2JqZWN0fSBmcm9tICcuL3R5cGVzJztcblxuXG4vLyBOT1RFIFR5cGUgYXJlIGNoYW5nZWQgdG8geyp9IGJlY2F1c2Ugb2Zcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvY2xvc3VyZS1jb21waWxlci9pc3N1ZXMvMTk5OVxuXG4vKipcbiAqIEpTT04gc2NhbGFyLiBJdCdzIGVpdGhlciBzdHJpbmcsIG51bWJlciBvciBib29sZWFuLlxuICogQHR5cGVkZWYgeyp9IHNob3VsZCBiZSBzdHJpbmd8bnVtYmVyfGJvb2xlYW5cbiAqL1xubGV0IEpTT05TY2FsYXJEZWY7XG5cblxuLyoqXG4gKiBKU09OIG9iamVjdC4gSXQncyBhIG1hcCB3aXRoIHN0cmluZyBrZXlzIGFuZCBKU09OIHZhbHVlcy5cbiAqIEB0eXBlZGVmIHsqfSBzaG91bGQgYmUgIU9iamVjdDxzdHJpbmcsID9KU09OVmFsdWVEZWY+XG4gKi9cbmxldCBKU09OT2JqZWN0RGVmO1xuXG5cbi8qKlxuICogSlNPTiBhcnJheS4gSXQncyBhbiBhcnJheSB3aXRoIEpTT04gdmFsdWVzLlxuICogQHR5cGVkZWYgeyp9IHNob3VsZCBiZSAhQXJyYXk8P0pTT05WYWx1ZURlZj5cbiAqL1xubGV0IEpTT05BcnJheURlZjtcblxuXG4vKipcbiAqIEpTT04gdmFsdWUuIEl0J3MgZWl0aGVyIGEgc2NhbGFyLCBhbiBvYmplY3Qgb3IgYW4gYXJyYXkuXG4gKiBAdHlwZWRlZiB7Kn0gc2hvdWxkIGJlICFKU09OU2NhbGFyRGVmfCFKU09OT2JqZWN0RGVmfCFKU09OQXJyYXlEZWZcbiAqL1xubGV0IEpTT05WYWx1ZURlZjtcblxuLyoqXG4gKiBSZWNyZWF0ZXMgb2JqZWN0cyB3aXRoIHByb3RvdHlwZS1sZXNzIGNvcGllcy5cbiAqIEBwYXJhbSB7IUpzb25PYmplY3R9IG9ialxuICogQHJldHVybiB7IUpzb25PYmplY3R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWNyZWF0ZU5vblByb3RvT2JqZWN0KG9iaikge1xuICBjb25zdCBjb3B5ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgZm9yIChjb25zdCBrIGluIG9iaikge1xuICAgIGlmICghaGFzT3duUHJvcGVydHkob2JqLCBrKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGNvbnN0IHYgPSBvYmpba107XG4gICAgY29weVtrXSA9IGlzT2JqZWN0KHYpID8gcmVjcmVhdGVOb25Qcm90b09iamVjdCh2KSA6IHY7XG4gIH1cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovIChjb3B5KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgdmFsdWUgZnJvbSBhbiBvYmplY3QgZm9yIGEgZmllbGQtYmFzZWQgZXhwcmVzc2lvbi4gVGhlIGV4cHJlc3Npb25cbiAqIGlzIGEgc2ltcGxlIG5lc3RlZCBkb3Qtbm90YXRpb24gb2YgZmllbGRzLCBzdWNoIGFzIGBmaWVsZDEuZmllbGQyYC4gSWYgYW55XG4gKiBmaWVsZCBpbiBhIGNoYWluIGRvZXMgbm90IGV4aXN0IG9yIGlzIG5vdCBhbiBvYmplY3Qgb3IgYXJyYXksIHRoZSByZXR1cm5lZFxuICogdmFsdWUgd2lsbCBiZSBgdW5kZWZpbmVkYC5cbiAqXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0fSBvYmpcbiAqIEBwYXJhbSB7c3RyaW5nfSBleHByXG4gKiBAcmV0dXJuIHsqfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmFsdWVGb3JFeHByKG9iaiwgZXhwcikge1xuICAvLyBUaGUgYC5gIGluZGljYXRlcyBcInRoZSBvYmplY3QgaXRzZWxmXCIuXG4gIGlmIChleHByID09ICcuJykge1xuICAgIHJldHVybiBvYmo7XG4gIH1cbiAgLy8gT3RoZXJ3aXNlLCBuYXZpZ2F0ZSB2aWEgcHJvcGVydGllcy5cbiAgY29uc3QgcGFydHMgPSBleHByLnNwbGl0KCcuJyk7XG4gIGxldCB2YWx1ZSA9IG9iajtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHBhcnQgPSBwYXJ0c1tpXTtcbiAgICBpZiAocGFydCAmJlxuICAgICAgICB2YWx1ZSAmJlxuICAgICAgICB2YWx1ZVtwYXJ0XSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgIGhhc093blByb3BlcnR5KHZhbHVlLCBwYXJ0KVxuICAgICkge1xuICAgICAgdmFsdWUgPSB2YWx1ZVtwYXJ0XTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICB2YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICBicmVhaztcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5cbi8qKlxuICogU2ltcGxlIHdyYXBwZXIgYXJvdW5kIEpTT04ucGFyc2UgdGhhdCBjYXN0cyB0aGUgcmV0dXJuIHZhbHVlXG4gKiB0byBKc29uT2JqZWN0LlxuICogQ3JlYXRlIGEgbmV3IHdyYXBwZXIgaWYgYW4gYXJyYXkgcmV0dXJuIHZhbHVlIGlzIGRlc2lyZWQuXG4gKiBAcGFyYW0geyp9IGpzb24gSlNPTiBzdHJpbmcgdG8gcGFyc2VcbiAqIEByZXR1cm4gez9Kc29uT2JqZWN0fSBNYXkgYmUgZXh0ZW5kIHRvIHBhcnNlIGFycmF5cy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSnNvbihqc29uKSB7XG4gIHJldHVybiAvKiogQHR5cGUgez9Kc29uT2JqZWN0fSAqLyhKU09OLnBhcnNlKC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAoanNvbikpKTtcbn1cblxuLyoqXG4gKiBQYXJzZXMgdGhlIGdpdmVuIGBqc29uYCBzdHJpbmcgd2l0aG91dCB0aHJvd2luZyBhbiBleGNlcHRpb24gaWYgbm90IHZhbGlkLlxuICogUmV0dXJucyBgdW5kZWZpbmVkYCBpZiBwYXJzaW5nIGZhaWxzLlxuICogUmV0dXJucyB0aGUgYE9iamVjdGAgY29ycmVzcG9uZGluZyB0byB0aGUgSlNPTiBzdHJpbmcgd2hlbiBwYXJzaW5nIHN1Y2NlZWRzLlxuICogQHBhcmFtIHsqfSBqc29uIEpTT04gc3RyaW5nIHRvIHBhcnNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFcnJvcik9fSBvcHRfb25GYWlsZWQgT3B0aW9uYWwgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZFxuICogICAgIHdpdGggdGhlIGVycm9yIGlmIHBhcnNpbmcgZmFpbHMuXG4gKiBAcmV0dXJuIHs/SnNvbk9iamVjdHx1bmRlZmluZWR9IE1heSBiZSBleHRlbmQgdG8gcGFyc2UgYXJyYXlzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ5UGFyc2VKc29uKGpzb24sIG9wdF9vbkZhaWxlZCkge1xuICB0cnkge1xuICAgIHJldHVybiBwYXJzZUpzb24oanNvbik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBpZiAob3B0X29uRmFpbGVkKSB7XG4gICAgICBvcHRfb25GYWlsZWQoZSk7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn1cblxuLyoqXG4gKiBSZWN1cnNpdmVseSBjaGVja3Mgc3RyaWN0IGVxdWFsaXR5IG9mIGl0ZW1zIGluIG5lc3RlZCBhcnJheXMgYW5kIG9iamVjdHMuXG4gKlxuICogQHBhcmFtIHtKU09OVmFsdWVEZWZ9IGFcbiAqIEBwYXJhbSB7SlNPTlZhbHVlRGVmfSBiXG4gKiBAcGFyYW0ge251bWJlcn0gZGVwdGggVGhlIG1heGltdW0gcmVjdXJzaW9uIGRlcHRoLiBNdXN0IGJlIGZpbml0ZS5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgZGVwdGggYXJndW1lbnQgaXMgbm90IGZpbml0ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlY3Vyc2l2ZUVxdWFscyhhLCBiLCBkZXB0aCA9IDMpIHtcbiAgaWYgKCFpc0Zpbml0ZShkZXB0aCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2RlcHRoIGFyZyBtdXN0IGJlIGZpbml0ZTogJyArIGRlcHRoKTtcbiAgfVxuICBpZiAoYSA9PT0gYikge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIC8vIE9ubHkgY2hlY2sgc2hhbGxvdyBlcXVhbGl0eSBmb3IgZGVwdGggPCAxLlxuICBpZiAoZGVwdGggPCAxKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmICh0eXBlb2YgYSAhPT0gdHlwZW9mIGIpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgaWYgKEFycmF5LmlzQXJyYXkoYSkgJiYgQXJyYXkuaXNBcnJheShiKSkge1xuICAgIGlmIChhLmxlbmd0aCAhPT0gYi5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoIXJlY3Vyc2l2ZUVxdWFscyhhW2ldLCBiW2ldLCBkZXB0aCAtIDEpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgaWYgKGEgJiYgYiAmJiB0eXBlb2YgYSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIGIgPT09ICdvYmplY3QnKSB7XG4gICAgY29uc3Qga2V5c0EgPSBPYmplY3Qua2V5cygvKiogQHR5cGUgeyFPYmplY3R9ICovIChhKSk7XG4gICAgY29uc3Qga2V5c0IgPSBPYmplY3Qua2V5cygvKiogQHR5cGUgeyFPYmplY3R9ICovIChiKSk7XG4gICAgaWYgKGtleXNBLmxlbmd0aCAhPT0ga2V5c0IubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5c0EubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGtleUEgPSBrZXlzQVtpXTtcbiAgICAgIGNvbnN0IHZhbHVlQSA9IGFba2V5QV07XG4gICAgICBjb25zdCB2YWx1ZUIgPSBiW2tleUFdO1xuICAgICAgaWYgKCFyZWN1cnNpdmVFcXVhbHModmFsdWVBLCB2YWx1ZUIsIGRlcHRoIC0gMSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyp9IG9ialxuICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaGFzT3duUHJvcGVydHkob2JqLCBrZXkpIHtcbiAgaWYgKG9iaiA9PSBudWxsIHx8IHR5cGVvZiBvYmogIT0gJ29iamVjdCcpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChcbiAgICAgIC8qKiBAdHlwZSB7IU9iamVjdH0gKi8gKG9iaiksIGtleSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuL21vZGUnO1xuaW1wb3J0IHtnZXRNb2RlT2JqZWN0fSBmcm9tICcuL21vZGUtb2JqZWN0JztcbmltcG9ydCB7aXNFbnVtVmFsdWV9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIFRyaXBsZSB6ZXJvIHdpZHRoIHNwYWNlLlxuICpcbiAqIFRoaXMgaXMgYWRkZWQgdG8gdXNlciBlcnJvciBtZXNzYWdlcywgc28gdGhhdCB3ZSBjYW4gbGF0ZXIgaWRlbnRpZnlcbiAqIHRoZW0sIHdoZW4gdGhlIG9ubHkgdGhpbmcgdGhhdCB3ZSBoYXZlIGlzIHRoZSBtZXNzYWdlLiBUaGlzIGlzIHRoZVxuICogY2FzZSBpbiBtYW55IGJyb3dzZXJzIHdoZW4gdGhlIGdsb2JhbCBleGNlcHRpb24gaGFuZGxlciBpcyBpbnZva2VkLlxuICpcbiAqIEBjb25zdCB7c3RyaW5nfVxuICovXG5leHBvcnQgY29uc3QgVVNFUl9FUlJPUl9TRU5USU5FTCA9ICdcXHUyMDBCXFx1MjAwQlxcdTIwMEInO1xuXG5cbi8qKlxuICogRm91ciB6ZXJvIHdpZHRoIHNwYWNlLlxuICpcbiAqIEBjb25zdCB7c3RyaW5nfVxuICovXG5leHBvcnQgY29uc3QgVVNFUl9FUlJPUl9FTUJFRF9TRU5USU5FTCA9ICdcXHUyMDBCXFx1MjAwQlxcdTIwMEJcXHUyMDBCJztcblxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoaXMgbWVzc2FnZSB3YXMgYSB1c2VyIGVycm9yLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNVc2VyRXJyb3JNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgcmV0dXJuIG1lc3NhZ2UuaW5kZXhPZihVU0VSX0VSUk9SX1NFTlRJTkVMKSA+PSAwO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoaXMgbWVzc2FnZSB3YXMgYSBhIHVzZXIgZXJyb3IgZnJvbSBhbiBpZnJhbWUgZW1iZWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1VzZXJFcnJvckVtYmVkKG1lc3NhZ2UpIHtcbiAgcmV0dXJuIG1lc3NhZ2UuaW5kZXhPZihVU0VSX0VSUk9SX0VNQkVEX1NFTlRJTkVMKSA+PSAwO1xufVxuXG5cbi8qKlxuICogQGVudW0ge251bWJlcn1cbiAqIEBwcml2YXRlIFZpc2libGUgZm9yIHRlc3Rpbmcgb25seS5cbiAqL1xuZXhwb3J0IGNvbnN0IExvZ0xldmVsID0ge1xuICBPRkY6IDAsXG4gIEVSUk9SOiAxLFxuICBXQVJOOiAyLFxuICBJTkZPOiAzLFxuICBGSU5FOiA0LFxufTtcblxuLyoqXG4gKiBTZXRzIHJlcG9ydEVycm9yIGZ1bmN0aW9uLiBDYWxsZWQgZnJvbSBlcnJvci5qcyB0byBicmVhayBjeWNsaWNcbiAqIGRlcGVuZGVuY3kuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCosICFFbGVtZW50PSl8dW5kZWZpbmVkfSBmblxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0UmVwb3J0RXJyb3IoZm4pIHtcbiAgc2VsZi5yZXBvcnRFcnJvciA9IGZuO1xufVxuXG4vKipcbiAqIEB0eXBlIHshTG9nTGV2ZWx8dW5kZWZpbmVkfVxuICogQHByaXZhdGVcbiAqL1xubGV0IGxldmVsT3ZlcnJpZGVfID0gdW5kZWZpbmVkO1xuXG4vKipcbiAqIEBwYXJhbSB7IUxvZ0xldmVsfSBsZXZlbFxuICovXG5leHBvcnQgZnVuY3Rpb24gb3ZlcnJpZGVMb2dMZXZlbChsZXZlbCkge1xuICBsZXZlbE92ZXJyaWRlXyA9IGxldmVsO1xufVxuXG4vKipcbiAqIExvZ2dpbmcgY2xhc3MuIFVzZSBvZiBzZW50aW5lbCBzdHJpbmcgaW5zdGVhZCBvZiBhIGJvb2xlYW4gdG8gY2hlY2sgdXNlci9kZXZcbiAqIGVycm9ycyBiZWNhdXNlIGVycm9ycyBjb3VsZCBiZSByZXRocm93biBieSBzb21lIG5hdGl2ZSBjb2RlIGFzIGEgbmV3IGVycm9yLFxuICogYW5kIG9ubHkgYSBtZXNzYWdlIHdvdWxkIHN1cnZpdmUuIEFsc28sIHNvbWUgYnJvd3NlciBkb27igJl0IHN1cHBvcnQgYSA1dGhcbiAqIGVycm9yIG9iamVjdCBhcmd1bWVudCBpbiB3aW5kb3cub25lcnJvci4gTGlzdCBvZiBzdXBwb3J0aW5nIGJyb3dzZXIgY2FuIGJlXG4gKiBmb3VuZCBoZXJlOlxuICogaHR0cHM6Ly9ibG9nLnNlbnRyeS5pby8yMDE2LzAxLzA0L2NsaWVudC1qYXZhc2NyaXB0LXJlcG9ydGluZy13aW5kb3ctb25lcnJvci5odG1sXG4gKiBAZmluYWxcbiAqIEBwcml2YXRlIFZpc2libGUgZm9yIHRlc3Rpbmcgb25seS5cbiAqL1xuZXhwb3J0IGNsYXNzIExvZyB7XG4gIC8qKlxuICAgKiBvcHRfc3VmZml4IHdpbGwgYmUgYXBwZW5kZWQgdG8gZXJyb3IgbWVzc2FnZSB0byBpZGVudGlmeSB0aGUgdHlwZSBvZiB0aGVcbiAgICogZXJyb3IgbWVzc2FnZS4gV2UgY2FuJ3QgcmVseSBvbiB0aGUgZXJyb3Igb2JqZWN0IHRvIHBhc3MgYWxvbmcgdGhlIHR5cGVcbiAgICogYmVjYXVzZSBzb21lIGJyb3dzZXJzIGRvIG5vdCBoYXZlIHRoaXMgcGFyYW0gaW4gaXRzIHdpbmRvdy5vbmVycm9yIEFQSS5cbiAgICogU2VlOlxuICAgKiBodHRwczovL2Jsb2cuc2VudHJ5LmlvLzIwMTYvMDEvMDQvY2xpZW50LWphdmFzY3JpcHQtcmVwb3J0aW5nLXdpbmRvdy1vbmVycm9yLmh0bWxcbiAgICpcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHBhcmFtIHtmdW5jdGlvbighLi9tb2RlLk1vZGVEZWYpOiFMb2dMZXZlbH0gbGV2ZWxGdW5jXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X3N1ZmZpeFxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luLCBsZXZlbEZ1bmMsIG9wdF9zdWZmaXgpIHtcbiAgICAvKipcbiAgICAgKiBJbiB0ZXN0cyB3ZSB1c2UgdGhlIG1haW4gdGVzdCB3aW5kb3cgaW5zdGVhZCBvZiB0aGUgaWZyYW1lIHdoZXJlXG4gICAgICogdGhlIHRlc3RzIHJ1bnMgYmVjYXVzZSBvbmx5IHRoZSBmb3JtZXIgaXMgcmVsYXllZCB0byB0aGUgY29uc29sZS5cbiAgICAgKiBAY29uc3QgeyFXaW5kb3d9XG4gICAgICovXG4gICAgdGhpcy53aW4gPSAoZ2V0TW9kZSgpLnRlc3QgJiYgd2luLkFNUF9URVNUX0lGUkFNRSkgPyB3aW4ucGFyZW50IDogd2luO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7ZnVuY3Rpb24oIS4vbW9kZS5Nb2RlRGVmKTohTG9nTGV2ZWx9ICovXG4gICAgdGhpcy5sZXZlbEZ1bmNfID0gbGV2ZWxGdW5jO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IUxvZ0xldmVsfSAqL1xuICAgIHRoaXMubGV2ZWxfID0gdGhpcy5kZWZhdWx0TGV2ZWxfKCk7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtzdHJpbmd9ICovXG4gICAgdGhpcy5zdWZmaXhfID0gb3B0X3N1ZmZpeCB8fCAnJztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshTG9nTGV2ZWx9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRMZXZlbF8oKSB7XG4gICAgcmV0dXJuIChsZXZlbE92ZXJyaWRlXyAhPT0gdW5kZWZpbmVkKSA/IGxldmVsT3ZlcnJpZGVfIDogdGhpcy5sZXZlbF87XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IUxvZ0xldmVsfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZGVmYXVsdExldmVsXygpIHtcbiAgICAvLyBObyBjb25zb2xlIC0gY2FuJ3QgZW5hYmxlIGxvZ2dpbmcuXG4gICAgaWYgKCF0aGlzLndpbi5jb25zb2xlIHx8ICF0aGlzLndpbi5jb25zb2xlLmxvZykge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLk9GRjtcbiAgICB9XG5cbiAgICAvLyBMb2dnaW5nIGhhcyBiZWVuIGV4cGxpY2l0bHkgZGlzYWJsZWQuXG4gICAgaWYgKGdldE1vZGUoKS5sb2cgPT0gJzAnKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuT0ZGO1xuICAgIH1cblxuICAgIC8vIExvZ2dpbmcgaXMgZW5hYmxlZCBmb3IgdGVzdHMgZGlyZWN0bHkuXG4gICAgaWYgKGdldE1vZGUoKS50ZXN0ICYmIHRoaXMud2luLkVOQUJMRV9MT0cpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5GSU5FO1xuICAgIH1cblxuICAgIC8vIExvY2FsRGV2IGJ5IGRlZmF1bHQgYWxsb3dzIElORk8gbGV2ZWwsIHVubGVzcyBvdmVycmlkZW4gYnkgYCNsb2dgLlxuICAgIGlmIChnZXRNb2RlKCkubG9jYWxEZXYgJiYgIWdldE1vZGUoKS5sb2cpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5JTkZPO1xuICAgIH1cblxuICAgIC8vIERlbGVnYXRlIHRvIHRoZSBzcGVjaWZpYyByZXNvbHZlci5cbiAgICByZXR1cm4gdGhpcy5sZXZlbEZ1bmNfKGdldE1vZGVPYmplY3QoKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0ge3N0cmluZ30gbGV2ZWxcbiAgICogQHBhcmFtIHshQXJyYXl9IG1lc3NhZ2VzXG4gICAqL1xuICBtc2dfKHRhZywgbGV2ZWwsIG1lc3NhZ2VzKSB7XG4gICAgaWYgKHRoaXMuZ2V0TGV2ZWxfKCkgIT0gTG9nTGV2ZWwuT0ZGKSB7XG4gICAgICBsZXQgZm4gPSB0aGlzLndpbi5jb25zb2xlLmxvZztcbiAgICAgIGlmIChsZXZlbCA9PSAnRVJST1InKSB7XG4gICAgICAgIGZuID0gdGhpcy53aW4uY29uc29sZS5lcnJvciB8fCBmbjtcbiAgICAgIH0gZWxzZSBpZiAobGV2ZWwgPT0gJ0lORk8nKSB7XG4gICAgICAgIGZuID0gdGhpcy53aW4uY29uc29sZS5pbmZvIHx8IGZuO1xuICAgICAgfSBlbHNlIGlmIChsZXZlbCA9PSAnV0FSTicpIHtcbiAgICAgICAgZm4gPSB0aGlzLndpbi5jb25zb2xlLndhcm4gfHwgZm47XG4gICAgICB9XG4gICAgICBpZiAoZ2V0TW9kZSgpLmxvY2FsRGV2KSB7XG4gICAgICAgIG1lc3NhZ2VzLnVuc2hpZnQoJ1snICsgdGFnICsgJ10nKTtcbiAgICAgIH1cbiAgICAgIGZuLmFwcGx5KHRoaXMud2luLmNvbnNvbGUsIG1lc3NhZ2VzKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciB0aGUgbG9nZ2luZyBpcyBlbmFibGVkLlxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgaXNFbmFibGVkKCkge1xuICAgIHJldHVybiB0aGlzLmdldExldmVsXygpICE9IExvZ0xldmVsLk9GRjtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGEgZmluZS1ncmFpbmVkIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKi9cbiAgZmluZSh0YWcsIHZhcl9hcmdzKSB7XG4gICAgaWYgKHRoaXMuZ2V0TGV2ZWxfKCkgPj0gTG9nTGV2ZWwuRklORSkge1xuICAgICAgdGhpcy5tc2dfKHRhZywgJ0ZJTkUnLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVwb3J0cyBhIGluZm9ybWF0aW9uYWwgbWVzc2FnZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqL1xuICBpbmZvKHRhZywgdmFyX2FyZ3MpIHtcbiAgICBpZiAodGhpcy5nZXRMZXZlbF8oKSA+PSBMb2dMZXZlbC5JTkZPKSB7XG4gICAgICB0aGlzLm1zZ18odGFnLCAnSU5GTycsIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGEgd2FybmluZyBtZXNzYWdlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICovXG4gIHdhcm4odGFnLCB2YXJfYXJncykge1xuICAgIGlmICh0aGlzLmdldExldmVsXygpID49IExvZ0xldmVsLldBUk4pIHtcbiAgICAgIHRoaXMubXNnXyh0YWcsICdXQVJOJywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9ydHMgYW4gZXJyb3IgbWVzc2FnZS4gSWYgdGhlIGxvZ2dpbmcgaXMgZGlzYWJsZWQsIHRoZSBlcnJvciBpcyByZXRocm93blxuICAgKiBhc3luY2hyb25vdXNseS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqIEByZXR1cm4geyFFcnJvcnx1bmRlZmluZWR9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBlcnJvcl8odGFnLCB2YXJfYXJncykge1xuICAgIGlmICh0aGlzLmdldExldmVsXygpID49IExvZ0xldmVsLkVSUk9SKSB7XG4gICAgICB0aGlzLm1zZ18odGFnLCAnRVJST1InLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZXJyb3IgPSBjcmVhdGVFcnJvclZhcmdzLmFwcGx5KG51bGwsXG4gICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgICB0aGlzLnByZXBhcmVFcnJvcl8oZXJyb3IpO1xuICAgICAgcmV0dXJuIGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGFuIGVycm9yIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKi9cbiAgZXJyb3IodGFnLCB2YXJfYXJncykge1xuICAgIGNvbnN0IGVycm9yID0gdGhpcy5lcnJvcl8uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGVycm9yLm5hbWUgPSB0YWcgfHwgZXJyb3IubmFtZTtcbiAgICAgIC8vIHJlcG9ydEVycm9yIGlzIGluc3RhbGxlZCBnbG9iYWxseSBwZXIgd2luZG93IGluIHRoZSBlbnRyeSBwb2ludC5cbiAgICAgIHNlbGYucmVwb3J0RXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGFuIGVycm9yIG1lc3NhZ2UgYW5kIG1hcmtzIHdpdGggYW4gZXhwZWN0ZWQgcHJvcGVydHkuIElmIHRoZVxuICAgKiBsb2dnaW5nIGlzIGRpc2FibGVkLCB0aGUgZXJyb3IgaXMgcmV0aHJvd24gYXN5bmNocm9ub3VzbHkuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB1bnVzZWRUYWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKi9cbiAgZXhwZWN0ZWRFcnJvcih1bnVzZWRUYWcsIHZhcl9hcmdzKSB7XG4gICAgY29uc3QgZXJyb3IgPSB0aGlzLmVycm9yXy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmIChlcnJvcikge1xuICAgICAgZXJyb3IuZXhwZWN0ZWQgPSB0cnVlO1xuICAgICAgLy8gcmVwb3J0RXJyb3IgaXMgaW5zdGFsbGVkIGdsb2JhbGx5IHBlciB3aW5kb3cgaW4gdGhlIGVudHJ5IHBvaW50LlxuICAgICAgc2VsZi5yZXBvcnRFcnJvcihlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gZXJyb3Igb2JqZWN0LlxuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqIEByZXR1cm4geyFFcnJvcn1cbiAgICovXG4gIGNyZWF0ZUVycm9yKHZhcl9hcmdzKSB7XG4gICAgY29uc3QgZXJyb3IgPSBjcmVhdGVFcnJvclZhcmdzLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgdGhpcy5wcmVwYXJlRXJyb3JfKGVycm9yKTtcbiAgICByZXR1cm4gZXJyb3I7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBlcnJvciBvYmplY3Qgd2l0aCBpdHMgZXhwZWN0ZWQgcHJvcGVydHkgc2V0IHRvIHRydWUuXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICogQHJldHVybiB7IUVycm9yfVxuICAgKi9cbiAgY3JlYXRlRXhwZWN0ZWRFcnJvcih2YXJfYXJncykge1xuICAgIGNvbnN0IGVycm9yID0gY3JlYXRlRXJyb3JWYXJncy5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgIHRoaXMucHJlcGFyZUVycm9yXyhlcnJvcik7XG4gICAgZXJyb3IuZXhwZWN0ZWQgPSB0cnVlO1xuICAgIHJldHVybiBlcnJvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzbid0IHRydWVpc2guXG4gICAqXG4gICAqIFN1cHBvcnRzIGFyZ3VtZW50IHN1YnN0aXR1dGlvbiBpbnRvIHRoZSBtZXNzYWdlIHZpYSAlcyBwbGFjZWhvbGRlcnMuXG4gICAqXG4gICAqIFRocm93cyBhbiBlcnJvciBvYmplY3QgdGhhdCBoYXMgdHdvIGV4dHJhIHByb3BlcnRpZXM6XG4gICAqIC0gYXNzb2NpYXRlZEVsZW1lbnQ6IFRoaXMgaXMgdGhlIGZpcnN0IGVsZW1lbnQgcHJvdmlkZWQgaW4gdGhlIHZhciBhcmdzLlxuICAgKiAgIEl0IGNhbiBiZSB1c2VkIGZvciBpbXByb3ZlZCBkaXNwbGF5IG9mIGVycm9yIG1lc3NhZ2VzLlxuICAgKiAtIG1lc3NhZ2VBcnJheTogVGhlIGVsZW1lbnRzIG9mIHRoZSBzdWJzdGl0dXRlZCBtZXNzYWdlIGFzIG5vbi1zdHJpbmdpZmllZFxuICAgKiAgIGVsZW1lbnRzIGluIGFuIGFycmF5LiBXaGVuIGUuZy4gcGFzc2VkIHRvIGNvbnNvbGUuZXJyb3IgdGhpcyB5aWVsZHNcbiAgICogICBuYXRpdmUgZGlzcGxheXMgb2YgdGhpbmdzIGxpa2UgSFRNTCBlbGVtZW50cy5cbiAgICpcbiAgICogQHBhcmFtIHtUfSBzaG91bGRCZVRydWVpc2ggVGhlIHZhbHVlIHRvIGFzc2VydC4gVGhlIGFzc2VydCBmYWlscyBpZiBpdCBkb2VzXG4gICAqICAgICBub3QgZXZhbHVhdGUgdG8gdHJ1ZS5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfbWVzc2FnZSBUaGUgYXNzZXJ0aW9uIG1lc3NhZ2VcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJncyBBcmd1bWVudHMgc3Vic3RpdHV0ZWQgaW50byAlcyBpbiB0aGUgbWVzc2FnZS5cbiAgICogQHJldHVybiB7VH0gVGhlIHZhbHVlIG9mIHNob3VsZEJlVHJ1ZWlzaC5cbiAgICogQHRlbXBsYXRlIFRcbiAgICogZXNsaW50IFwiZ29vZ2xlLWNhbWVsY2FzZS9nb29nbGUtY2FtZWxjYXNlXCI6IDBcbiAgICovXG4gIGFzc2VydChzaG91bGRCZVRydWVpc2gsIG9wdF9tZXNzYWdlLCB2YXJfYXJncykge1xuICAgIGxldCBmaXJzdEVsZW1lbnQ7XG4gICAgaWYgKCFzaG91bGRCZVRydWVpc2gpIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBvcHRfbWVzc2FnZSB8fCAnQXNzZXJ0aW9uIGZhaWxlZCc7XG4gICAgICBjb25zdCBzcGxpdE1lc3NhZ2UgPSBtZXNzYWdlLnNwbGl0KCclcycpO1xuICAgICAgY29uc3QgZmlyc3QgPSBzcGxpdE1lc3NhZ2Uuc2hpZnQoKTtcbiAgICAgIGxldCBmb3JtYXR0ZWQgPSBmaXJzdDtcbiAgICAgIGNvbnN0IG1lc3NhZ2VBcnJheSA9IFtdO1xuICAgICAgcHVzaElmTm9uRW1wdHkobWVzc2FnZUFycmF5LCBmaXJzdCk7XG4gICAgICBmb3IgKGxldCBpID0gMjsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCB2YWwgPSBhcmd1bWVudHNbaV07XG4gICAgICAgIGlmICh2YWwgJiYgdmFsLnRhZ05hbWUpIHtcbiAgICAgICAgICBmaXJzdEVsZW1lbnQgPSB2YWw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmV4dENvbnN0YW50ID0gc3BsaXRNZXNzYWdlLnNoaWZ0KCk7XG4gICAgICAgIG1lc3NhZ2VBcnJheS5wdXNoKHZhbCk7XG4gICAgICAgIHB1c2hJZk5vbkVtcHR5KG1lc3NhZ2VBcnJheSwgbmV4dENvbnN0YW50LnRyaW0oKSk7XG4gICAgICAgIGZvcm1hdHRlZCArPSB0b1N0cmluZyh2YWwpICsgbmV4dENvbnN0YW50O1xuICAgICAgfVxuICAgICAgY29uc3QgZSA9IG5ldyBFcnJvcihmb3JtYXR0ZWQpO1xuICAgICAgZS5mcm9tQXNzZXJ0ID0gdHJ1ZTtcbiAgICAgIGUuYXNzb2NpYXRlZEVsZW1lbnQgPSBmaXJzdEVsZW1lbnQ7XG4gICAgICBlLm1lc3NhZ2VBcnJheSA9IG1lc3NhZ2VBcnJheTtcbiAgICAgIHRoaXMucHJlcGFyZUVycm9yXyhlKTtcbiAgICAgIC8vIHJlcG9ydEVycm9yIGlzIGluc3RhbGxlZCBnbG9iYWxseSBwZXIgd2luZG93IGluIHRoZSBlbnRyeSBwb2ludC5cbiAgICAgIHNlbGYucmVwb3J0RXJyb3IoZSk7XG4gICAgICB0aHJvdyBlO1xuICAgIH1cbiAgICByZXR1cm4gc2hvdWxkQmVUcnVlaXNoO1xuICB9XG5cbiAgLyoqXG4gICAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgZmlyc3QgYXJndW1lbnQgaXNuJ3QgYW4gRWxlbWVudFxuICAgKlxuICAgKiBPdGhlcndpc2Ugc2VlIGBhc3NlcnRgIGZvciB1c2FnZVxuICAgKlxuICAgKiBAcGFyYW0geyp9IHNob3VsZEJlRWxlbWVudFxuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9tZXNzYWdlIFRoZSBhc3NlcnRpb24gbWVzc2FnZVxuICAgKiBAcmV0dXJuIHshRWxlbWVudH0gVGhlIHZhbHVlIG9mIHNob3VsZEJlVHJ1ZWlzaC5cbiAgICogQHRlbXBsYXRlIFRcbiAgICogZXNsaW50IFwiZ29vZ2xlLWNhbWVsY2FzZS9nb29nbGUtY2FtZWxjYXNlXCI6IDJcbiAgICovXG4gIGFzc2VydEVsZW1lbnQoc2hvdWxkQmVFbGVtZW50LCBvcHRfbWVzc2FnZSkge1xuICAgIGNvbnN0IHNob3VsZEJlVHJ1ZWlzaCA9IHNob3VsZEJlRWxlbWVudCAmJiBzaG91bGRCZUVsZW1lbnQubm9kZVR5cGUgPT0gMTtcbiAgICB0aGlzLmFzc2VydChzaG91bGRCZVRydWVpc2gsIChvcHRfbWVzc2FnZSB8fCAnRWxlbWVudCBleHBlY3RlZCcpICsgJzogJXMnLFxuICAgICAgICBzaG91bGRCZUVsZW1lbnQpO1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFFbGVtZW50fSAqLyAoc2hvdWxkQmVFbGVtZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzbid0IGEgc3RyaW5nLiBUaGUgc3RyaW5nIGNhblxuICAgKiBiZSBlbXB0eS5cbiAgICpcbiAgICogRm9yIG1vcmUgZGV0YWlscyBzZWUgYGFzc2VydGAuXG4gICAqXG4gICAqIEBwYXJhbSB7Kn0gc2hvdWxkQmVTdHJpbmdcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfbWVzc2FnZSBUaGUgYXNzZXJ0aW9uIG1lc3NhZ2VcbiAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgc3RyaW5nIHZhbHVlLiBDYW4gYmUgYW4gZW1wdHkgc3RyaW5nLlxuICAgKiBlc2xpbnQgXCJnb29nbGUtY2FtZWxjYXNlL2dvb2dsZS1jYW1lbGNhc2VcIjogMlxuICAgKi9cbiAgYXNzZXJ0U3RyaW5nKHNob3VsZEJlU3RyaW5nLCBvcHRfbWVzc2FnZSkge1xuICAgIHRoaXMuYXNzZXJ0KHR5cGVvZiBzaG91bGRCZVN0cmluZyA9PSAnc3RyaW5nJyxcbiAgICAgICAgKG9wdF9tZXNzYWdlIHx8ICdTdHJpbmcgZXhwZWN0ZWQnKSArICc6ICVzJywgc2hvdWxkQmVTdHJpbmcpO1xuICAgIHJldHVybiAvKiogQHR5cGUge3N0cmluZ30gKi8gKHNob3VsZEJlU3RyaW5nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzbid0IGEgbnVtYmVyLiBUaGUgYWxsb3dlZCB2YWx1ZXNcbiAgICogaW5jbHVkZSBgMGAgYW5kIGBOYU5gLlxuICAgKlxuICAgKiBGb3IgbW9yZSBkZXRhaWxzIHNlZSBgYXNzZXJ0YC5cbiAgICpcbiAgICogQHBhcmFtIHsqfSBzaG91bGRCZU51bWJlclxuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9tZXNzYWdlIFRoZSBhc3NlcnRpb24gbWVzc2FnZVxuICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBudW1iZXIgdmFsdWUuIFRoZSBhbGxvd2VkIHZhbHVlcyBpbmNsdWRlIGAwYFxuICAgKiAgIGFuZCBgTmFOYC5cbiAgICovXG4gIGFzc2VydE51bWJlcihzaG91bGRCZU51bWJlciwgb3B0X21lc3NhZ2UpIHtcbiAgICB0aGlzLmFzc2VydCh0eXBlb2Ygc2hvdWxkQmVOdW1iZXIgPT0gJ251bWJlcicsXG4gICAgICAgIChvcHRfbWVzc2FnZSB8fCAnTnVtYmVyIGV4cGVjdGVkJykgKyAnOiAlcycsIHNob3VsZEJlTnVtYmVyKTtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHtudW1iZXJ9ICovIChzaG91bGRCZU51bWJlcik7XG4gIH1cblxuICAvKipcbiAgICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpc24ndCBhIGJvb2xlYW4uXG4gICAqXG4gICAqIEZvciBtb3JlIGRldGFpbHMgc2VlIGBhc3NlcnRgLlxuICAgKlxuICAgKiBAcGFyYW0geyp9IHNob3VsZEJlQm9vbGVhblxuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9tZXNzYWdlIFRoZSBhc3NlcnRpb24gbWVzc2FnZVxuICAgKiBAcmV0dXJuIHtib29sZWFufSBUaGUgYm9vbGVhbiB2YWx1ZS5cbiAgICovXG4gIGFzc2VydEJvb2xlYW4oc2hvdWxkQmVCb29sZWFuLCBvcHRfbWVzc2FnZSkge1xuICAgIHRoaXMuYXNzZXJ0KCEhc2hvdWxkQmVCb29sZWFuID09PSBzaG91bGRCZUJvb2xlYW4sXG4gICAgICAgIChvcHRfbWVzc2FnZSB8fCAnQm9vbGVhbiBleHBlY3RlZCcpICsgJzogJXMnLCBzaG91bGRCZUJvb2xlYW4pO1xuICAgIHJldHVybiAvKiogQHR5cGUge2Jvb2xlYW59ICovIChzaG91bGRCZUJvb2xlYW4pO1xuICB9XG5cbiAgLyoqXG4gICAqIEFzc2VydHMgYW5kIHJldHVybnMgdGhlIGVudW0gdmFsdWUuIElmIHRoZSBlbnVtIGRvZXNuJ3QgY29udGFpbiBzdWNoIGFcbiAgICogdmFsdWUsIHRoZSBlcnJvciBpcyB0aHJvd24uXG4gICAqXG4gICAqIEBwYXJhbSB7IU9iamVjdDxUPn0gZW51bU9ialxuICAgKiBAcGFyYW0ge3N0cmluZ30gc1xuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9lbnVtTmFtZVxuICAgKiBAcmV0dXJuIHtUfVxuICAgKiBAdGVtcGxhdGUgVFxuICAgKiBlc2xpbnQgXCJnb29nbGUtY2FtZWxjYXNlL2dvb2dsZS1jYW1lbGNhc2VcIjogMlxuICAgKi9cbiAgYXNzZXJ0RW51bVZhbHVlKGVudW1PYmosIHMsIG9wdF9lbnVtTmFtZSkge1xuICAgIGlmIChpc0VudW1WYWx1ZShlbnVtT2JqLCBzKSkge1xuICAgICAgcmV0dXJuIHM7XG4gICAgfVxuICAgIHRoaXMuYXNzZXJ0KGZhbHNlLFxuICAgICAgICAnVW5rbm93biAlcyB2YWx1ZTogXCIlc1wiJyxcbiAgICAgICAgb3B0X2VudW1OYW1lIHx8ICdlbnVtJywgcyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRXJyb3J9IGVycm9yXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcmVwYXJlRXJyb3JfKGVycm9yKSB7XG4gICAgZXJyb3IgPSBkdXBsaWNhdGVFcnJvcklmTmVjZXNzYXJ5KGVycm9yKTtcbiAgICBpZiAodGhpcy5zdWZmaXhfKSB7XG4gICAgICBpZiAoIWVycm9yLm1lc3NhZ2UpIHtcbiAgICAgICAgZXJyb3IubWVzc2FnZSA9IHRoaXMuc3VmZml4XztcbiAgICAgIH0gZWxzZSBpZiAoZXJyb3IubWVzc2FnZS5pbmRleE9mKHRoaXMuc3VmZml4XykgPT0gLTEpIHtcbiAgICAgICAgZXJyb3IubWVzc2FnZSArPSB0aGlzLnN1ZmZpeF87XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChpc1VzZXJFcnJvck1lc3NhZ2UoZXJyb3IubWVzc2FnZSkpIHtcbiAgICAgIGVycm9yLm1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlLnJlcGxhY2UoVVNFUl9FUlJPUl9TRU5USU5FTCwgJycpO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfCFFbGVtZW50fSB2YWxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gdG9TdHJpbmcodmFsKSB7XG4gIC8vIERvIGNoZWNrIGVxdWl2YWxlbnQgdG8gYHZhbCBpbnN0YW5jZW9mIEVsZW1lbnRgIHdpdGhvdXQgY3Jvc3Mtd2luZG93IGJ1Z1xuICBpZiAodmFsICYmIHZhbC5ub2RlVHlwZSA9PSAxKSB7XG4gICAgcmV0dXJuIHZhbC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgKyAodmFsLmlkID8gJyMnICsgdmFsLmlkIDogJycpO1xuICB9XG4gIHJldHVybiAvKiogQHR5cGUge3N0cmluZ30gKi8gKHZhbCk7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFBcnJheX0gYXJyYXlcbiAqIEBwYXJhbSB7Kn0gdmFsXG4gKi9cbmZ1bmN0aW9uIHB1c2hJZk5vbkVtcHR5KGFycmF5LCB2YWwpIHtcbiAgaWYgKHZhbCAhPSAnJykge1xuICAgIGFycmF5LnB1c2godmFsKTtcbiAgfVxufVxuXG4vKipcbiAqIFNvbWUgZXhjZXB0aW9ucyAoRE9NRXhjZXB0aW9uLCBuYW1lbHkpIGhhdmUgcmVhZC1vbmx5IG1lc3NhZ2UuXG4gKiBAcGFyYW0geyFFcnJvcn0gZXJyb3JcbiAqIEByZXR1cm4geyFFcnJvcn07XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkdXBsaWNhdGVFcnJvcklmTmVjZXNzYXJ5KGVycm9yKSB7XG4gIGNvbnN0IHttZXNzYWdlfSA9IGVycm9yO1xuICBjb25zdCB0ZXN0ID0gU3RyaW5nKE1hdGgucmFuZG9tKCkpO1xuICBlcnJvci5tZXNzYWdlID0gdGVzdDtcblxuICBpZiAoZXJyb3IubWVzc2FnZSA9PT0gdGVzdCkge1xuICAgIGVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIHJldHVybiBlcnJvcjtcbiAgfVxuXG4gIGNvbnN0IGUgPSBuZXcgRXJyb3IoZXJyb3IubWVzc2FnZSk7XG4gIC8vIENvcHkgYWxsIHRoZSBleHRyYW5lb3VzIHRoaW5ncyB3ZSBhdHRhY2guXG4gIGZvciAoY29uc3QgcHJvcCBpbiBlcnJvcikge1xuICAgIGVbcHJvcF0gPSBlcnJvcltwcm9wXTtcbiAgfVxuICAvLyBFbnN1cmUgdGhlc2UgYXJlIGNvcGllZC5cbiAgZS5zdGFjayA9IGVycm9yLnN0YWNrO1xuICByZXR1cm4gZTtcbn1cblxuLyoqXG4gKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gKiBAcmV0dXJuIHshRXJyb3J9XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVycm9yVmFyZ3ModmFyX2FyZ3MpIHtcbiAgbGV0IGVycm9yID0gbnVsbDtcbiAgbGV0IG1lc3NhZ2UgPSAnJztcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBhcmcgPSBhcmd1bWVudHNbaV07XG4gICAgaWYgKGFyZyBpbnN0YW5jZW9mIEVycm9yICYmICFlcnJvcikge1xuICAgICAgZXJyb3IgPSBkdXBsaWNhdGVFcnJvcklmTmVjZXNzYXJ5KGFyZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICAgIG1lc3NhZ2UgKz0gJyAnO1xuICAgICAgfVxuICAgICAgbWVzc2FnZSArPSBhcmc7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFlcnJvcikge1xuICAgIGVycm9yID0gbmV3IEVycm9yKG1lc3NhZ2UpO1xuICB9IGVsc2UgaWYgKG1lc3NhZ2UpIHtcbiAgICBlcnJvci5tZXNzYWdlID0gbWVzc2FnZSArICc6ICcgKyBlcnJvci5tZXNzYWdlO1xuICB9XG4gIHJldHVybiBlcnJvcjtcbn1cblxuXG4vKipcbiAqIFJldGhyb3dzIHRoZSBlcnJvciB3aXRob3V0IHRlcm1pbmF0aW5nIHRoZSBjdXJyZW50IGNvbnRleHQuIFRoaXMgcHJlc2VydmVzXG4gKiB3aGV0aGVyIHRoZSBvcmlnaW5hbCBlcnJvciBkZXNpZ25hdGlvbiBpcyBhIHVzZXIgZXJyb3Igb3IgYSBkZXYgZXJyb3IuXG4gKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXRocm93QXN5bmModmFyX2FyZ3MpIHtcbiAgY29uc3QgZXJyb3IgPSBjcmVhdGVFcnJvclZhcmdzLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIC8vIHJlcG9ydEVycm9yIGlzIGluc3RhbGxlZCBnbG9iYWxseSBwZXIgd2luZG93IGluIHRoZSBlbnRyeSBwb2ludC5cbiAgICBzZWxmLnJlcG9ydEVycm9yKGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfSk7XG59XG5cblxuLyoqXG4gKiBDYWNoZSBmb3IgbG9ncy4gV2UgZG8gbm90IHVzZSBhIFNlcnZpY2Ugc2luY2UgdGhlIHNlcnZpY2UgbW9kdWxlIGRlcGVuZHNcbiAqIG9uIExvZyBhbmQgY2xvc3VyZSBsaXRlcmFsbHkgY2FuJ3QgZXZlbi5cbiAqIEB0eXBlIHt7dXNlcjogP0xvZywgZGV2OiA/TG9nLCB1c2VyRm9yRW1iZWQ6ID9Mb2d9fVxuICovXG5zZWxmLmxvZyA9IChzZWxmLmxvZyB8fCB7XG4gIHVzZXI6IG51bGwsXG4gIGRldjogbnVsbCxcbiAgdXNlckZvckVtYmVkOiBudWxsLFxufSk7XG5cbmNvbnN0IGxvZ3MgPSBzZWxmLmxvZztcblxuLyoqXG4gKiBFdmVudHVhbGx5IGhvbGRzIGEgY29uc3RydWN0b3IgZm9yIExvZyBvYmplY3RzLiBMYXppbHkgaW5pdGlhbGl6ZWQsIHNvIHdlXG4gKiBjYW4gYXZvaWQgZXZlciByZWZlcmVuY2luZyB0aGUgcmVhbCBjb25zdHJ1Y3RvciBleGNlcHQgaW4gSlMgYmluYXJpZXNcbiAqIHRoYXQgYWN0dWFsbHkgd2FudCB0byBpbmNsdWRlIHRoZSBpbXBsZW1lbnRhdGlvbi5cbiAqIEB0eXBlIHs/RnVuY3Rpb259XG4gKi9cbmxldCBsb2dDb25zdHJ1Y3RvciA9IG51bGw7XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgbG9nIGNvbnRydWN0b3IuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbml0TG9nQ29uc3RydWN0b3IoKSB7XG4gIGxvZ0NvbnN0cnVjdG9yID0gTG9nO1xuICAvLyBJbml0aWFsaXplIGluc3RhbmNlcyBmb3IgdXNlLiBJZiBhIGJpbmFyeSAoYW4gZXh0ZW5zaW9uIGZvciBleGFtcGxlKSB0aGF0XG4gIC8vIGRvZXMgbm90IGNhbGwgYGluaXRMb2dDb25zdHJ1Y3RvcmAgaW52b2tlcyBgZGV2KClgIG9yIGB1c2VyKClgIGVhcmxpZXIgdGhhblxuICAvLyB0aGUgYmluYXJ5IHRoYXQgZG9lcyBjYWxsIGBpbml0TG9nQ29uc3RydWN0b3JgIChhbXAuanMpLCB0aGUgZXh0ZW5zaW9uIHdpbGxcbiAgLy8gdGhyb3cgYW4gZXJyb3IgYXMgdGhhdCBleHRlbnNpb24gd2lsbCBuZXZlciBiZSBhYmxlIHRvIGluaXRpYWxpemUgdGhlIGxvZ1xuICAvLyBpbnN0YW5jZXMgYW5kIHdlIGFsc28gZG9uJ3Qgd2FudCBpdCB0byBjYWxsIGBpbml0TG9nQ29uc3RydWN0b3JgIGVpdGhlclxuICAvLyAoc2luY2UgdGhhdCB3aWxsIGNhdXNlIHRoZSBMb2cgaW1wbGVtZW50YXRpb24gdG8gYmUgYnVuZGxlZCBpbnRvIHRoYXRcbiAgLy8gYmluYXJ5KS4gU28gd2UgbXVzdCBpbml0aWFsaXplIHRoZSBpbnN0YW5jZXMgZWFnZXJseSBzbyB0aGF0IHRoZXkgYXJlIHJlYWR5XG4gIC8vIGZvciB1c2UgKHN0b3JlZCBnbG9iYWxseSkgYWZ0ZXIgdGhlIG1haW4gYmluYXJ5IGNhbGxzIGBpbml0TG9nQ29uc3RydWN0b3JgLlxuICBkZXYoKTtcbiAgdXNlcigpO1xufVxuXG4vKipcbiAqIFJlc2V0cyBsb2cgY29udHJ1Y3RvciBmb3IgdGVzdGluZy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0TG9nQ29uc3RydWN0b3JGb3JUZXN0aW5nKCkge1xuICBsb2dDb25zdHJ1Y3RvciA9IG51bGw7XG59XG5cbi8qKlxuICogUHVibGlzaGVyIGxldmVsIGxvZy5cbiAqXG4gKiBFbmFibGVkIGluIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAqICAxLiBOb3QgZGlzYWJsZWQgdXNpbmcgYCNsb2c9MGAuXG4gKiAgMi4gRGV2ZWxvcG1lbnQgbW9kZSBpcyBlbmFibGVkIHZpYSBgI2RldmVsb3BtZW50PTFgIG9yIGxvZ2dpbmcgaXMgZXhwbGljaXRseVxuICogICAgIGVuYWJsZWQgdmlhIGAjbG9nPURgIHdoZXJlIEQgPj0gMS5cbiAqICAzLiBBTVAuc2V0TG9nTGV2ZWwoRCkgaXMgY2FsbGVkLCB3aGVyZSBEID49IDEuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudD19IG9wdF9lbGVtZW50XG4gKiBAcmV0dXJuIHshTG9nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlcihvcHRfZWxlbWVudCkge1xuICBpZiAoIWxvZ3MudXNlcikge1xuICAgIGxvZ3MudXNlciA9IGdldFVzZXJMb2dnZXIoVVNFUl9FUlJPUl9TRU5USU5FTCk7XG4gIH1cbiAgaWYgKCFpc0Zyb21FbWJlZChsb2dzLnVzZXIud2luLCBvcHRfZWxlbWVudCkpIHtcbiAgICByZXR1cm4gbG9ncy51c2VyO1xuICB9IGVsc2Uge1xuICAgIGlmIChsb2dzLnVzZXJGb3JFbWJlZCkge1xuICAgICAgcmV0dXJuIGxvZ3MudXNlckZvckVtYmVkO1xuICAgIH1cbiAgICByZXR1cm4gbG9ncy51c2VyRm9yRW1iZWQgPSBnZXRVc2VyTG9nZ2VyKFVTRVJfRVJST1JfRU1CRURfU0VOVElORUwpO1xuICB9XG59XG5cbi8qKlxuICogR2V0dGVyIGZvciB1c2VyIGxvZ2dlclxuICogQHBhcmFtIHtzdHJpbmc9fSBzdWZmaXhcbiAqIEByZXR1cm4geyFMb2d9XG4gKi9cbmZ1bmN0aW9uIGdldFVzZXJMb2dnZXIoc3VmZml4KSB7XG4gIGlmICghbG9nQ29uc3RydWN0b3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2ZhaWxlZCB0byBjYWxsIGluaXRMb2dDb25zdHJ1Y3RvcicpO1xuICB9XG4gIHJldHVybiBuZXcgbG9nQ29uc3RydWN0b3Ioc2VsZiwgbW9kZSA9PiB7XG4gICAgY29uc3QgbG9nTnVtID0gcGFyc2VJbnQobW9kZS5sb2csIDEwKTtcbiAgICBpZiAobW9kZS5kZXZlbG9wbWVudCB8fCBsb2dOdW0gPj0gMSkge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLkZJTkU7XG4gICAgfVxuICAgIHJldHVybiBMb2dMZXZlbC5XQVJOO1xuICB9LCBzdWZmaXgpO1xufVxuXG4vKipcbiAqIEFNUCBkZXZlbG9wbWVudCBsb2cuIENhbGxzIHRvIGBkZXZMb2coKS5hc3NlcnRgIGFuZCBgZGV2LmZpbmVgIGFyZSBzdHJpcHBlZFxuICogaW4gdGhlIFBST0QgYmluYXJ5LiBIb3dldmVyLCBgZGV2TG9nKCkuYXNzZXJ0YCByZXN1bHQgaXMgcHJlc2VydmVkIGluIGVpdGhlclxuICogY2FzZS5cbiAqXG4gKiBFbmFibGVkIGluIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAqICAxLiBOb3QgZGlzYWJsZWQgdXNpbmcgYCNsb2c9MGAuXG4gKiAgMi4gTG9nZ2luZyBpcyBleHBsaWNpdGx5IGVuYWJsZWQgdmlhIGAjbG9nPURgLCB3aGVyZSBEID49IDIuXG4gKiAgMy4gQU1QLnNldExvZ0xldmVsKEQpIGlzIGNhbGxlZCwgd2hlcmUgRCA+PSAyLlxuICpcbiAqIEByZXR1cm4geyFMb2d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZXYoKSB7XG4gIGlmIChsb2dzLmRldikge1xuICAgIHJldHVybiBsb2dzLmRldjtcbiAgfVxuICBpZiAoIWxvZ0NvbnN0cnVjdG9yKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdmYWlsZWQgdG8gY2FsbCBpbml0TG9nQ29uc3RydWN0b3InKTtcbiAgfVxuICByZXR1cm4gbG9ncy5kZXYgPSBuZXcgbG9nQ29uc3RydWN0b3Ioc2VsZiwgbW9kZSA9PiB7XG4gICAgY29uc3QgbG9nTnVtID0gcGFyc2VJbnQobW9kZS5sb2csIDEwKTtcbiAgICBpZiAobG9nTnVtID49IDMpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5GSU5FO1xuICAgIH1cbiAgICBpZiAobG9nTnVtID49IDIpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5JTkZPO1xuICAgIH1cbiAgICByZXR1cm4gTG9nTGV2ZWwuT0ZGO1xuICB9KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshRWxlbWVudD19IG9wdF9lbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufSBpc0VtYmVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Zyb21FbWJlZCh3aW4sIG9wdF9lbGVtZW50KSB7XG4gIGlmICghb3B0X2VsZW1lbnQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIG9wdF9lbGVtZW50Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcgIT0gd2luO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7Z2V0TW9kZX0gZnJvbSAnLi9tb2RlJztcblxuLyoqXG4gKiBQcm92aWRlcyBpbmZvIGFib3V0IHRoZSBjdXJyZW50IGFwcC4gVGhpcyByZXR1cm4gdmFsdWUgbWF5IGJlIGNhY2hlZCBhbmRcbiAqIHBhc3NlZCBhcm91bmQgYXMgaXQgd2lsbCBhbHdheXMgYmUgRENFJ2QuXG4gKiBAcGFyYW0gez9XaW5kb3c9fSBvcHRfd2luXG4gKiBAcmV0dXJuIHshLi9tb2RlLk1vZGVEZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRNb2RlT2JqZWN0KG9wdF93aW4pIHtcbiAgcmV0dXJuIHtcbiAgICBsb2NhbERldjogZ2V0TW9kZShvcHRfd2luKS5sb2NhbERldixcbiAgICBkZXZlbG9wbWVudDogZ2V0TW9kZShvcHRfd2luKS5kZXZlbG9wbWVudCxcbiAgICBmaWx0ZXI6IGdldE1vZGUob3B0X3dpbikuZmlsdGVyLFxuICAgIG1pbmlmaWVkOiBnZXRNb2RlKG9wdF93aW4pLm1pbmlmaWVkLFxuICAgIGxpdGU6IGdldE1vZGUob3B0X3dpbikubGl0ZSxcbiAgICB0ZXN0OiBnZXRNb2RlKG9wdF93aW4pLnRlc3QsXG4gICAgbG9nOiBnZXRNb2RlKG9wdF93aW4pLmxvZyxcbiAgICB2ZXJzaW9uOiBnZXRNb2RlKG9wdF93aW4pLnZlcnNpb24sXG4gICAgcnR2VmVyc2lvbjogZ2V0TW9kZShvcHRfd2luKS5ydHZWZXJzaW9uLFxuICB9O1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7cGFyc2VRdWVyeVN0cmluZ199IGZyb20gJy4vdXJsLXBhcnNlLXF1ZXJ5LXN0cmluZyc7XG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgbG9jYWxEZXY6IGJvb2xlYW4sXG4gKiAgIGRldmVsb3BtZW50OiBib29sZWFuLFxuICogICBmaWx0ZXI6IChzdHJpbmd8dW5kZWZpbmVkKSxcbiAqICAgbWluaWZpZWQ6IGJvb2xlYW4sXG4gKiAgIGxpdGU6IGJvb2xlYW4sXG4gKiAgIHRlc3Q6IGJvb2xlYW4sXG4gKiAgIGxvZzogKHN0cmluZ3x1bmRlZmluZWQpLFxuICogICB2ZXJzaW9uOiBzdHJpbmcsXG4gKiAgIHJ0dlZlcnNpb246IHN0cmluZyxcbiAqIH19XG4gKi9cbmV4cG9ydCBsZXQgTW9kZURlZjtcblxuLyoqIEB0eXBlIHtzdHJpbmd9ICovXG5jb25zdCB2ZXJzaW9uID0gJyRpbnRlcm5hbFJ1bnRpbWVWZXJzaW9uJCc7XG5cbi8qKlxuICogYHJ0dlZlcnNpb25gIGlzIHRoZSBwcmVmaXhlZCB2ZXJzaW9uIHdlIHNlcnZlIG9mZiBvZiB0aGUgY2RuLlxuICogVGhlIHByZWZpeCBkZW5vdGVzIGNhbmFyeSgwMCkgb3IgcHJvZCgwMSkgb3IgYW4gZXhwZXJpbWVudCB2ZXJzaW9uICggPiAwMSkuXG4gKiBAdHlwZSB7c3RyaW5nfVxuICovXG5sZXQgcnR2VmVyc2lvbiA9ICcnO1xuXG4vKipcbiAqIFByb3ZpZGVzIGluZm8gYWJvdXQgdGhlIGN1cnJlbnQgYXBwLlxuICogQHBhcmFtIHs/V2luZG93PX0gb3B0X3dpblxuICogQHJldHVybiB7IU1vZGVEZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRNb2RlKG9wdF93aW4pIHtcbiAgY29uc3Qgd2luID0gb3B0X3dpbiB8fCBzZWxmO1xuICBpZiAod2luLkFNUF9NT0RFKSB7XG4gICAgcmV0dXJuIHdpbi5BTVBfTU9ERTtcbiAgfVxuICByZXR1cm4gd2luLkFNUF9NT0RFID0gZ2V0TW9kZV8od2luKTtcbn1cblxuLyoqXG4gKiBQcm92aWRlcyBpbmZvIGFib3V0IHRoZSBjdXJyZW50IGFwcC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshTW9kZURlZn1cbiAqL1xuZnVuY3Rpb24gZ2V0TW9kZV8od2luKSB7XG4gIC8vIE1hZ2ljIGNvbnN0YW50cyB0aGF0IGFyZSByZXBsYWNlZCBieSBjbG9zdXJlIGNvbXBpbGVyLlxuICAvLyBJU19NSU5JRklFRCBpcyBhbHdheXMgcmVwbGFjZWQgd2l0aCB0cnVlIHdoZW4gY2xvc3VyZSBjb21waWxlciBpcyB1c2VkXG4gIC8vIHdoaWxlIElTX0RFViBpcyBvbmx5IHJlcGxhY2VkIHdoZW4gYGd1bHAgZGlzdGAgaXMgY2FsbGVkIHdpdGhvdXQgdGhlXG4gIC8vIC0tZm9ydGVzdGluZyBmbGFnLlxuICBjb25zdCBJU19ERVYgPSB0cnVlO1xuICBjb25zdCBJU19NSU5JRklFRCA9IGZhbHNlO1xuXG4gIGNvbnN0IGxvY2FsRGV2RW5hYmxlZCA9ICEhKHNlbGYuQU1QX0NPTkZJRyAmJiBzZWxmLkFNUF9DT05GSUcubG9jYWxEZXYpO1xuICBjb25zdCBydW5uaW5nVGVzdHMgPSBJU19ERVYgJiYgISEod2luLkFNUF9URVNUIHx8IHdpbi5fX2thcm1hX18pO1xuICBjb25zdCBpc0xvY2FsRGV2ID0gSVNfREVWICYmIChsb2NhbERldkVuYWJsZWQgfHwgcnVubmluZ1Rlc3RzKTtcbiAgY29uc3QgaGFzaFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZ18oXG4gICAgICAvLyBsb2NhdGlvbi5vcmlnaW5hbEhhc2ggaXMgc2V0IGJ5IHRoZSB2aWV3ZXIgd2hlbiBpdCByZW1vdmVzIHRoZSBmcmFnbWVudFxuICAgICAgLy8gZnJvbSB0aGUgVVJMLlxuICAgICAgd2luLmxvY2F0aW9uLm9yaWdpbmFsSGFzaCB8fCB3aW4ubG9jYXRpb24uaGFzaCk7XG5cbiAgY29uc3Qgc2VhcmNoUXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nXyh3aW4ubG9jYXRpb24uc2VhcmNoKTtcblxuICBpZiAoIXJ0dlZlcnNpb24pIHtcbiAgICBydHZWZXJzaW9uID0gZ2V0UnR2VmVyc2lvbih3aW4sIGlzTG9jYWxEZXYpO1xuICB9XG5cbiAgLy8gVGhlIGBtaW5pZmllZGAsIGB0ZXN0YCBhbmQgYGxvY2FsRGV2YCBwcm9wZXJ0aWVzIGFyZSByZXBsYWNlZFxuICAvLyBhcyBib29sZWFuIGxpdGVyYWxzIHdoZW4gd2UgcnVuIGBndWxwIGRpc3RgIHdpdGhvdXQgdGhlIGAtLWZvcnRlc3RpbmdgXG4gIC8vIGZsYWdzLiBUaGlzIGltcHJvdmVkIERDRSBvbiB0aGUgcHJvZHVjdGlvbiBmaWxlIHdlIGRlcGxveSBhcyB0aGUgY29kZVxuICAvLyBwYXRocyBmb3IgbG9jYWxob3N0L3Rlc3RpbmcvZGV2ZWxvcG1lbnQgYXJlIGVsaW1pbmF0ZWQuXG4gIHJldHVybiB7XG4gICAgbG9jYWxEZXY6IGlzTG9jYWxEZXYsXG4gICAgLy8gVHJpZ2dlcnMgdmFsaWRhdGlvbiBvciBlbmFibGUgcHViIGxldmVsIGxvZ2dpbmcuIFZhbGlkYXRpb24gY2FuIGJlXG4gICAgLy8gYnlwYXNzZWQgdmlhICN2YWxpZGF0ZT0wLlxuICAgIC8vIE5vdGUgdGhhdCBBTVBfREVWX01PREUgZmxhZyBpcyB1c2VkIGZvciB0ZXN0aW5nIHB1cnBvc2VzLlxuICAgIGRldmVsb3BtZW50OiAhIShoYXNoUXVlcnlbJ2RldmVsb3BtZW50J10gPT0gJzEnIHx8IHdpbi5BTVBfREVWX01PREUpLFxuICAgIGV4YW1pbmVyOiBoYXNoUXVlcnlbJ2RldmVsb3BtZW50J10gPT0gJzInLFxuICAgIC8vIEFsbG93cyBmaWx0ZXJpbmcgdmFsaWRhdGlvbiBlcnJvcnMgYnkgZXJyb3IgY2F0ZWdvcnkuIEZvciB0aGVcbiAgICAvLyBhdmFpbGFibGUgY2F0ZWdvcmllcywgc2VlIEVycm9yQ2F0ZWdvcnkgaW4gdmFsaWRhdG9yL3ZhbGlkYXRvci5wcm90by5cbiAgICBmaWx0ZXI6IGhhc2hRdWVyeVsnZmlsdGVyJ10sXG4gICAgLy8gYW1wLWdlbyBvdmVycmlkZVxuICAgIGdlb092ZXJyaWRlOiBoYXNoUXVlcnlbJ2FtcC1nZW8nXSxcbiAgICBtaW5pZmllZDogSVNfTUlOSUZJRUQsXG4gICAgLy8gV2hldGhlciBkb2N1bWVudCBpcyBpbiBhbiBhbXAtbGl0ZSB2aWV3ZXIuIEl0IHNpZ25hbCB0aGF0IHRoZSB1c2VyXG4gICAgLy8gd291bGQgcHJlZmVyIHRvIHVzZSBsZXNzIGJhbmR3aWR0aC5cbiAgICBsaXRlOiBzZWFyY2hRdWVyeVsnYW1wX2xpdGUnXSAhPSB1bmRlZmluZWQsXG4gICAgdGVzdDogcnVubmluZ1Rlc3RzLFxuICAgIGxvZzogaGFzaFF1ZXJ5Wydsb2cnXSxcbiAgICB2ZXJzaW9uLFxuICAgIHJ0dlZlcnNpb24sXG4gIH07XG59XG5cbi8qKlxuICogUmV0cmlldmUgdGhlIGBydHZWZXJzaW9uYCB3aGljaCB3aWxsIGhhdmUgYSBudW1lcmljIHByZWZpeFxuICogZGVub3RpbmcgY2FuYXJ5L3Byb2QvZXhwZXJpbWVudCAodW5sZXNzIGBpc0xvY2FsRGV2YCBpcyB0cnVlKS5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtib29sZWFufSBpc0xvY2FsRGV2XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGdldFJ0dlZlcnNpb24od2luLCBpc0xvY2FsRGV2KSB7XG4gIC8vIElmIGl0J3MgbG9jYWwgZGV2IHRoZW4gd2Ugd29uJ3QgYWN0dWFsbHkgaGF2ZSBhIGZ1bGwgdmVyc2lvbiBzb1xuICAvLyBqdXN0IHVzZSB0aGUgdmVyc2lvbi5cbiAgaWYgKGlzTG9jYWxEZXYpIHtcbiAgICByZXR1cm4gdmVyc2lvbjtcbiAgfVxuXG4gIGlmICh3aW4uQU1QX0NPTkZJRyAmJiB3aW4uQU1QX0NPTkZJRy52KSB7XG4gICAgcmV0dXJuIHdpbi5BTVBfQ09ORklHLnY7XG4gIH1cblxuICAvLyBDdXJyZW50bHkgYCRpbnRlcm5hbFJ1bnRpbWVWZXJzaW9uJGAgYW5kIHRodXMgYG1vZGUudmVyc2lvbmAgY29udGFpbiBvbmx5XG4gIC8vIG1ham9yIHZlcnNpb24uIFRoZSBmdWxsIHZlcnNpb24gaG93ZXZlciBtdXN0IGFsc28gY2FycnkgdGhlIG1pbm9yIHZlcnNpb24uXG4gIC8vIFdlIHdpbGwgZGVmYXVsdCB0byBwcm9kdWN0aW9uIGRlZmF1bHQgYDAxYCBtaW5vciB2ZXJzaW9uIGZvciBub3cuXG4gIC8vIFRPRE8oZXJ3aW5tb21iYXkpOiBkZWNpZGUgd2hldGhlciAkaW50ZXJuYWxSdW50aW1lVmVyc2lvbiQgc2hvdWxkIGNvbnRhaW5cbiAgLy8gbWlub3IgdmVyc2lvbi5cbiAgcmV0dXJuIGAwMSR7dmVyc2lvbn1gO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNMb2NhbERldlxuICogQHJldHVybiB7c3RyaW5nfVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRSdHZWZXJzaW9uRm9yVGVzdGluZyh3aW4sIGlzTG9jYWxEZXYpIHtcbiAgcmV0dXJuIGdldFJ0dlZlcnNpb24od2luLCBpc0xvY2FsRGV2KTtcbn1cblxuXG4vKiogQHZpc2libGVGb3JUZXN0aW5nICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRSdHZWZXJzaW9uRm9yVGVzdGluZygpIHtcbiAgcnR2VmVyc2lvbiA9ICcnO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuXG4vKipcbiAqIFRoaXMgY2xhc3MgaGVscHMgdG8gbWFuYWdlIG9ic2VydmVycy4gT2JzZXJ2ZXJzIGNhbiBiZSBhZGRlZCwgcmVtb3ZlZCBvclxuICogZmlyZWQgdGhyb3VnaCBhbmQgaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAqIEB0ZW1wbGF0ZSBUWVBFXG4gKi9cbmV4cG9ydCBjbGFzcyBPYnNlcnZhYmxlIHtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBPYnNlcnZhYmxlLlxuICAgKi9cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLyoqIEB0eXBlIHs/QXJyYXk8ZnVuY3Rpb24oVFlQRSk+fSAqL1xuICAgIHRoaXMuaGFuZGxlcnNfID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIHRoZSBvYnNlcnZlciB0byB0aGlzIGluc3RhbmNlLlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKFRZUEUpfSBoYW5kbGVyIE9ic2VydmVyJ3MgaGFuZGxlci5cbiAgICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICAgKi9cbiAgYWRkKGhhbmRsZXIpIHtcbiAgICBpZiAoIXRoaXMuaGFuZGxlcnNfKSB7XG4gICAgICB0aGlzLmhhbmRsZXJzXyA9IFtdO1xuICAgIH1cbiAgICB0aGlzLmhhbmRsZXJzXy5wdXNoKGhhbmRsZXIpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICB0aGlzLnJlbW92ZShoYW5kbGVyKTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgdGhlIG9ic2VydmVyIGZyb20gdGhpcyBpbnN0YW5jZS5cbiAgICogQHBhcmFtIHtmdW5jdGlvbihUWVBFKX0gaGFuZGxlciBPYnNlcnZlcidzIGluc3RhbmNlLlxuICAgKi9cbiAgcmVtb3ZlKGhhbmRsZXIpIHtcbiAgICBpZiAoIXRoaXMuaGFuZGxlcnNfKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5oYW5kbGVyc18uaW5kZXhPZihoYW5kbGVyKTtcbiAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgdGhpcy5oYW5kbGVyc18uc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlcyBhbGwgb2JzZXJ2ZXJzLlxuICAgKi9cbiAgcmVtb3ZlQWxsKCkge1xuICAgIGlmICghdGhpcy5oYW5kbGVyc18pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5oYW5kbGVyc18ubGVuZ3RoID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBGaXJlcyBhbiBldmVudC4gQWxsIG9ic2VydmVycyBhcmUgY2FsbGVkLlxuICAgKiBAcGFyYW0ge1RZUEU9fSBvcHRfZXZlbnRcbiAgICovXG4gIGZpcmUob3B0X2V2ZW50KSB7XG4gICAgaWYgKCF0aGlzLmhhbmRsZXJzXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBoYW5kbGVycyA9IHRoaXMuaGFuZGxlcnNfO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaGFuZGxlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGhhbmRsZXIgPSBoYW5kbGVyc1tpXTtcbiAgICAgIGhhbmRsZXIob3B0X2V2ZW50KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBudW1iZXIgb2YgaGFuZGxlcnMuIE1vc3RseSBuZWVkZWQgZm9yIHRlc3RzLlxuICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAqL1xuICBnZXRIYW5kbGVyQ291bnQoKSB7XG4gICAgaWYgKCF0aGlzLmhhbmRsZXJzXykge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmhhbmRsZXJzXy5sZW5ndGg7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4vbW9kZSc7XG5pbXBvcnQge2luc3RhbGwgYXMgaW5zdGFsbEFycmF5SW5jbHVkZXN9IGZyb20gJy4vcG9seWZpbGxzL2FycmF5LWluY2x1ZGVzJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsQ3VzdG9tRWxlbWVudHN9IGZyb20gJy4vcG9seWZpbGxzL2N1c3RvbS1lbGVtZW50cyc7XG5pbXBvcnQge1xuICBpbnN0YWxsIGFzIGluc3RhbGxET01Ub2tlbkxpc3RUb2dnbGUsXG59IGZyb20gJy4vcG9seWZpbGxzL2RvbXRva2VubGlzdC10b2dnbGUnO1xuaW1wb3J0IHtpbnN0YWxsIGFzIGluc3RhbGxEb2NDb250YWluc30gZnJvbSAnLi9wb2x5ZmlsbHMvZG9jdW1lbnQtY29udGFpbnMnO1xuaW1wb3J0IHtpbnN0YWxsIGFzIGluc3RhbGxNYXRoU2lnbn0gZnJvbSAnLi9wb2x5ZmlsbHMvbWF0aC1zaWduJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsT2JqZWN0QXNzaWdufSBmcm9tICcuL3BvbHlmaWxscy9vYmplY3QtYXNzaWduJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsUHJvbWlzZX0gZnJvbSAnLi9wb2x5ZmlsbHMvcHJvbWlzZSc7XG5pbXBvcnQge2luc3RhbGxDdXN0b21FbGVtZW50cyBhcyBpbnN0YWxsUmVnaXN0ZXJFbGVtZW50fSBmcm9tXG4gICdkb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50L2J1aWxkL2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQucGF0Y2hlZCc7XG5pbXBvcnQge2lzRXhwZXJpbWVudE9ufSBmcm9tICcuL2V4cGVyaW1lbnRzJztcblxuaWYgKGlzRXhwZXJpbWVudE9uKHNlbGYsICdjdXN0b20tZWxlbWVudHMtdjEnKSB8fCBnZXRNb2RlKCkudGVzdCkge1xuICBpbnN0YWxsQ3VzdG9tRWxlbWVudHMoc2VsZiwgY2xhc3Mge30pO1xufSBlbHNlIHtcbiAgaW5zdGFsbFJlZ2lzdGVyRWxlbWVudChzZWxmLCAnYXV0bycpO1xufVxuaW5zdGFsbERPTVRva2VuTGlzdFRvZ2dsZShzZWxmKTtcbmluc3RhbGxNYXRoU2lnbihzZWxmKTtcbmluc3RhbGxPYmplY3RBc3NpZ24oc2VsZik7XG5pbnN0YWxsUHJvbWlzZShzZWxmKTtcbmluc3RhbGxEb2NDb250YWlucyhzZWxmKTtcbmluc3RhbGxBcnJheUluY2x1ZGVzKHNlbGYpO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIGVsZW1lbnQgaXMgaW4gdGhlIGFycmF5IGFuZCBmYWxzZSBvdGhlcndpc2UuXG4gKlxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHBhcmFtIHtudW1iZXI9fSBvcHRfZnJvbUluZGV4XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHRoaXMge0FycmF5fVxuICovXG5mdW5jdGlvbiBpbmNsdWRlcyh2YWx1ZSwgb3B0X2Zyb21JbmRleCkge1xuICBjb25zdCBmcm9tSW5kZXggPSBvcHRfZnJvbUluZGV4IHx8IDA7XG4gIGNvbnN0IGxlbiA9IHRoaXMubGVuZ3RoO1xuICBsZXQgaSA9IGZyb21JbmRleCA+PSAwID8gZnJvbUluZGV4IDogTWF0aC5tYXgobGVuICsgZnJvbUluZGV4LCAwKTtcbiAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgIGNvbnN0IG90aGVyID0gdGhpc1tpXTtcbiAgICAvLyBJZiB2YWx1ZSBoYXMgYmVlbiBmb3VuZCBPUiAodmFsdWUgaXMgTmFOIEFORCBvdGhlciBpcyBOYU4pXG4gICAgLyplc2xpbnQgXCJuby1zZWxmLWNvbXBhcmVcIjogMCovXG4gICAgaWYgKG90aGVyID09PSB2YWx1ZSB8fCAodmFsdWUgIT09IHZhbHVlICYmIG90aGVyICE9PSBvdGhlcikpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuKiBTZXRzIHRoZSBBcnJheS5jb250YWlucyBwb2x5ZmlsbCBpZiBpdCBkb2VzIG5vdCBleGlzdC5cbiogQHBhcmFtIHshV2luZG93fSB3aW5cbiovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzKSB7XG4gICAgd2luLk9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdpbmNsdWRlcycsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogaW5jbHVkZXMsXG4gICAgfSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHByb21pc2U6ICFQcm9taXNlPHVuZGVmaW5lZD4sXG4gKiAgIHJlc29sdmU6IGZ1bmN0aW9uKCksXG4gKiB9fVxuICovXG5sZXQgRGVmZXJyZWREZWY7XG5cbi8qKlxuICogQHR5cGVkZWYgeyFGdW5jdGlvbn1cbiAqL1xubGV0IEN1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZjtcblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogIG5hbWU6IHN0cmluZyxcbiAqICBjdG9yOiAhQ3VzdG9tRWxlbWVudENvbnN0cnVjdG9yRGVmLFxuICogfX1cbiAqL1xubGV0IEN1c3RvbUVsZW1lbnREZWY7XG5cbi8qKlxuICogVmFsaWRhdGVzIHRoZSBjdXN0b20gZWxlbWVudCdzIG5hbWUuXG4gKiBUaGlzIGludGVudGlvbmFsbHkgaWdub3JlcyBcInZhbGlkXCIgaGlnaGVyIFVuaWNvZGUgQ29kZSBQb2ludHMuXG4gKiBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9jdXN0b20tZWxlbWVudHMuaHRtbCN2YWxpZC1jdXN0b20tZWxlbWVudC1uYW1lXG4gKi9cbmNvbnN0IFZBTElEX05BTUUgPSAvXlthLXpdW2EtejAtOS5fXSotW2EtejAtOS5fLV0qJC87XG5jb25zdCBJTlZBTElEX05BTUVTID0gW1xuICAnYW5ub3RhdGlvbi14bWwnLFxuICAnY29sb3ItcHJvZmlsZScsXG4gICdmb250LWZhY2UnLFxuICAnZm9udC1mYWNlLXNyYycsXG4gICdmb250LWZhY2UtdXJpJyxcbiAgJ2ZvbnQtZmFjZS1mb3JtYXQnLFxuICAnZm9udC1mYWNlLW5hbWUnLFxuICAnbWlzc2luZy1nbHlwaCcsXG5dO1xuXG4vKipcbiAqIEFzc2VydHMgdGhhdCB0aGUgY3VzdG9tIGVsZW1lbnQgbmFtZSBjb25mb3JtcyB0byB0aGUgc3BlYy5cbiAqXG4gKiBAcGFyYW0geyFGdW5jdGlvbn0gU3ludGF4RXJyb3JcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gKi9cbmZ1bmN0aW9uIGFzc2VydFZhbGlkTmFtZShTeW50YXhFcnJvciwgbmFtZSkge1xuICBpZiAoIVZBTElEX05BTUUudGVzdChuYW1lKSB8fCBJTlZBTElEX05BTUVTLmluZGV4T2YobmFtZSkgPj0gMCkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgaW52YWxpZCBjdXN0b20gZWxlbWVudCBuYW1lIFwiJHtuYW1lfVwiYCk7XG4gIH1cbn1cblxuLyoqXG4gKiBEb2VzIHdpbiBoYXZlIGEgZnVsbCBDdXN0b20gRWxlbWVudHMgcmVnaXN0cnk/XG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGhhc0N1c3RvbUVsZW1lbnRzKHdpbikge1xuICBjb25zdCB7Y3VzdG9tRWxlbWVudHN9ID0gd2luO1xuXG4gIHJldHVybiAhIShcbiAgICBjdXN0b21FbGVtZW50cyAmJlxuICAgIGN1c3RvbUVsZW1lbnRzLmRlZmluZSAmJlxuICAgIGN1c3RvbUVsZW1lbnRzLmdldCAmJlxuICAgIGN1c3RvbUVsZW1lbnRzLndoZW5EZWZpbmVkKTtcbn1cblxuLyoqXG4gKiBXYXMgSFRNTEVsZW1lbnQgYWxyZWFkeSBwYXRjaGVkIGZvciB0aGlzIHdpbmRvdz9cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNQYXRjaGVkKHdpbikge1xuICBjb25zdCB0YWcgPSB3aW4uSFRNTEVsZW1lbnQudG9TdHJpbmcoKTtcbiAgcmV0dXJuIHRhZy5pbmRleE9mKCdbbmF0aXZlIGNvZGVdJykgPT09IC0xO1xufVxuXG4vKipcbiAqIFRoZSBwdWJsaWMgQ3VzdG9tIEVsZW1lbnRzIEFQSS5cbiAqL1xuY2xhc3MgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5IHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEBwYXJhbSB7IVJlZ2lzdHJ5fSByZWdpc3RyeVxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luLCByZWdpc3RyeSkge1xuICAgIC8qKlxuICAgICAqIEBjb25zdCBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMud2luXyA9IHdpbjtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdCBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMucmVnaXN0cnlfID0gcmVnaXN0cnk7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsIERlZmVycmVkRGVmPn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBjb25zdFxuICAgICAqL1xuICAgIHRoaXMucGVuZGluZ0RlZmluZXNfID0gdGhpcy53aW5fLk9iamVjdC5jcmVhdGUobnVsbCk7XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXIgdGhlIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcGFyYW0geyFDdXN0b21FbGVtZW50Q29uc3RydWN0b3JEZWZ9IGN0b3JcbiAgICogQHBhcmFtIHshT2JqZWN0PX0gb3B0aW9uc1xuICAgKi9cbiAgZGVmaW5lKG5hbWUsIGN0b3IsIG9wdGlvbnMpIHtcbiAgICB0aGlzLnJlZ2lzdHJ5Xy5kZWZpbmUobmFtZSwgY3Rvciwgb3B0aW9ucyk7XG5cbiAgICAvLyBJZiBhbnlvbmUgaXMgd2FpdGluZyBmb3IgdGhpcyBjdXN0b20gZWxlbWVudCB0byBiZSBkZWZpbmVkLCByZXNvbHZlXG4gICAgLy8gdGhlaXIgcHJvbWlzZS5cbiAgICBjb25zdCBwZW5kaW5nID0gdGhpcy5wZW5kaW5nRGVmaW5lc187XG4gICAgY29uc3QgZGVmZXJyZWQgPSBwZW5kaW5nW25hbWVdO1xuICAgIGlmIChkZWZlcnJlZCkge1xuICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgZGVsZXRlIHBlbmRpbmdbbmFtZV07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY29uc3RydWN0b3Igb2YgdGhlIChhbHJlYWR5IGRlZmluZWQpIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcmV0dXJuIHshQ3VzdG9tRWxlbWVudENvbnN0cnVjdG9yRGVmfHVuZGVmaW5lZH1cbiAgICovXG4gIGdldChuYW1lKSB7XG4gICAgY29uc3QgZGVmID0gdGhpcy5yZWdpc3RyeV8uZ2V0QnlOYW1lKG5hbWUpO1xuICAgIGlmIChkZWYpIHtcbiAgICAgIHJldHVybiBkZWYuY3RvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgdGhhdCB3YWl0cyB1bnRpbCB0aGUgY3VzdG9tIGVsZW1lbnQgaXMgZGVmaW5lZC5cbiAgICogSWYgdGhlIGN1c3RvbSBlbGVtZW50IGlzIGFscmVhZHkgZGVmaW5lZCwgcmV0dXJucyBhIHJlc29sdmVkIHByb21pc2UuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAqIEByZXR1cm4geyFQcm9taXNlPHVuZGVmaW5lZD59XG4gICAqL1xuICB3aGVuRGVmaW5lZChuYW1lKSB7XG4gICAgY29uc3Qge1Byb21pc2UsIFN5bnRheEVycm9yfSA9IHRoaXMud2luXztcbiAgICBhc3NlcnRWYWxpZE5hbWUoU3ludGF4RXJyb3IsIG5hbWUpO1xuXG4gICAgaWYgKHRoaXMucmVnaXN0cnlfLmdldEJ5TmFtZShuYW1lKSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cblxuICAgIGNvbnN0IHBlbmRpbmcgPSB0aGlzLnBlbmRpbmdEZWZpbmVzXztcbiAgICBjb25zdCBkZWZlcnJlZCA9IHBlbmRpbmdbbmFtZV07XG4gICAgaWYgKGRlZmVycmVkKSB7XG4gICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBsZXQgcmVzb2x2ZTtcbiAgICBjb25zdCBwcm9taXNlID0gbmV3IC8qT0sqL1Byb21pc2UocmVzID0+IHJlc29sdmUgPSByZXMpO1xuICAgIHBlbmRpbmdbbmFtZV0gPSB7XG4gICAgICBwcm9taXNlLFxuICAgICAgcmVzb2x2ZSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHByb21pc2U7XG4gIH1cblxuICAvKipcbiAgICogVXBncmFkZSBhbGwgY3VzdG9tIGVsZW1lbnRzIGluc2lkZSByb290LlxuICAgKlxuICAgKiBAcGFyYW0geyFOb2RlfSByb290XG4gICAqL1xuICB1cGdyYWRlKHJvb3QpIHtcbiAgICB0aGlzLnJlZ2lzdHJ5Xy51cGdyYWRlKHJvb3QpO1xuICB9XG59XG5cbi8qKlxuICogVGhpcyBpbnRlcm5hbCBBUElzIG5lY2Vzc2FyeSB0byBydW4gdGhlIEN1c3RvbUVsZW1lbnRSZWdpc3RyeS5cbiAqIFNpbmNlIFJlZ2lzdHJ5IGlzIG5ldmVyIGV4cG9zZWQgZXh0ZXJuYWxseSwgYWxsIG1ldGhvZHMgYXJlIGFjdHVhbGx5XG4gKiBhdmFpbGFibGUgb24gdGhlIGluc3RhbmNlLlxuICovXG5jbGFzcyBSZWdpc3RyeSB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luKSB7XG4gICAgLyoqXG4gICAgICogQHByaXZhdGUgQGNvbnN0XG4gICAgICovXG4gICAgdGhpcy53aW5fID0gd2luO1xuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGUgQGNvbnN0XG4gICAgICovXG4gICAgdGhpcy5kb2NfID0gd2luLmRvY3VtZW50O1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCAhQ3VzdG9tRWxlbWVudERlZj59XG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAY29uc3RcbiAgICAgKi9cbiAgICB0aGlzLmRlZmluaXRpb25zXyA9IHdpbi5PYmplY3QuY3JlYXRlKG51bGwpO1xuXG4gICAgLyoqXG4gICAgICogQSB1cC10by1kYXRlIERPTSBzZWxlY3RvciBmb3IgYWxsIGN1c3RvbSBlbGVtZW50cy5cbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIHRoaXMucXVlcnlfID0gJyc7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgY3VycmVudGx5IHVwZ3JhZGluZyBlbGVtZW50LlxuICAgICAqIEBwcml2YXRlIHtFbGVtZW50fVxuICAgICAqL1xuICAgIHRoaXMuY3VycmVudF8gPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50bHktYmVpbmctdXBncmFkZWQgY3VzdG9tIGVsZW1lbnQuXG4gICAqXG4gICAqIFdoZW4gYW4gYWxyZWFkeSBjcmVhdGVkICh0aHJvdWdoIHRoZSBET00gcGFyc2luZyBBUElzLCBvciBpbm5lckhUTUwpXG4gICAqIGN1c3RvbSBlbGVtZW50IG5vZGUgaXMgYmVpbmcgdXBncmFkZWQsIHdlIGNhbid0IGp1c3QgY3JlYXRlIGEgbmV3IG5vZGVcbiAgICogKGl0J3MgaWxsZWdhbCBpbiB0aGUgc3BlYykuIEJ1dCB3ZSBzdGlsbCBuZWVkIHRvIHJ1biB0aGUgY3VzdG9tIGVsZW1lbnQnc1xuICAgKiBjb25zdHJ1Y3RvciBjb2RlIG9uIHRoZSBub2RlLiBXZSBhdm9pZCB0aGlzIGNvbnVuZHJ1bSBieSBydW5uaW5nIHRoZVxuICAgKiBjb25zdHJ1Y3RvciB3aGlsZSByZXR1cm5pbmcgdGhpcyBjdXJyZW50IG5vZGUgaW4gdGhlIEhUTUxFbGVtZW50XG4gICAqIGNsYXNzIGNvbnN0cnVjdG9yICh0aGUgYmFzZSBjbGFzcyBvZiBhbGwgY3VzdG9tIGVsZW1lbnRzKS5cbiAgICpcbiAgICogQHJldHVybiB7RWxlbWVudH1cbiAgICovXG4gIGN1cnJlbnQoKSB7XG4gICAgY29uc3QgY3VycmVudCA9IHRoaXMuY3VycmVudF87XG4gICAgdGhpcy5jdXJyZW50XyA9IG51bGw7XG4gICAgcmV0dXJuIGN1cnJlbnQ7XG4gIH1cblxuICAvKipcbiAgICogRmluZHMgdGhlIGN1c3RvbSBlbGVtZW50IGRlZmluaXRpb24gYnkgbmFtZS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICogQHJldHVybiB7Q3VzdG9tRWxlbWVudERlZnx1bmRlZmluZWR9XG4gICAqL1xuICBnZXRCeU5hbWUobmFtZSkge1xuICAgIGNvbnN0IGRlZmluaXRpb24gPSB0aGlzLmRlZmluaXRpb25zX1tuYW1lXTtcbiAgICBpZiAoZGVmaW5pdGlvbikge1xuICAgICAgcmV0dXJuIGRlZmluaXRpb247XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZpbmRzIHRoZSBjdXN0b20gZWxlbWVudCBkZWZpbml0aW9uIGJ5IGNvbnN0cnVjdG9yIGluc3RhbmNlLlxuICAgKlxuICAgKiBAcGFyYW0ge0N1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZn0gY3RvclxuICAgKiBAcmV0dXJuIHtDdXN0b21FbGVtZW50RGVmfHVuZGVmaW5lZH1cbiAgICovXG4gIGdldEJ5Q29uc3RydWN0b3IoY3Rvcikge1xuICAgIGNvbnN0IGRlZmluaXRpb25zID0gdGhpcy5kZWZpbml0aW9uc187XG5cbiAgICBmb3IgKGNvbnN0IG5hbWUgaW4gZGVmaW5pdGlvbnMpIHtcbiAgICAgIGNvbnN0IGRlZiA9IGRlZmluaXRpb25zW25hbWVdO1xuICAgICAgaWYgKGRlZi5jdG9yID09PSBjdG9yKSB7XG4gICAgICAgIHJldHVybiBkZWY7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVycyB0aGUgY3VzdG9tIGVsZW1lbnQgZGVmaW5pdGlvbiwgYW5kIHVwZ3JhZGVzIGFsbCBlbGVtZW50cyBieSB0aGF0XG4gICAqIG5hbWUgaW4gdGhlIHJvb3QgZG9jdW1lbnQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAqIEBwYXJhbSB7IUN1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZn0gY3RvclxuICAgKiBAcGFyYW0geyFPYmplY3R8dW5kZWZpbmVkfSBvcHRpb25zXG4gICAqL1xuICBkZWZpbmUobmFtZSwgY3Rvciwgb3B0aW9ucykge1xuICAgIGNvbnN0IHtFcnJvciwgU3ludGF4RXJyb3J9ID0gdGhpcy53aW5fO1xuXG4gICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRXh0ZW5kaW5nIG5hdGl2ZSBjdXN0b20gZWxlbWVudHMgaXMgbm90IHN1cHBvcnRlZCcpO1xuICAgIH1cblxuICAgIGFzc2VydFZhbGlkTmFtZShTeW50YXhFcnJvciwgbmFtZSk7XG5cbiAgICBpZiAodGhpcy5nZXRCeU5hbWUobmFtZSkgfHxcbiAgICAgICAgdGhpcy5nZXRCeUNvbnN0cnVjdG9yKGN0b3IpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYGR1cGxpY2F0ZSBkZWZpbml0aW9uIFwiJHtuYW1lfVwiYCk7XG4gICAgfVxuXG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogUmVjb3JkIGNvbm5lY3RlZENhbGxiYWNrLCBkaXNjb25uZWN0ZWRDYWxsYmFjayxcbiAgICAvLyBhZG9wdGVkQ2FsbGJhY2ssIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjaywgYW5kIG9ic2VydmVkQXR0cmlidXRlcy5cbiAgICAvLyBUT0RPKGpyaWRnZXdlbGwpOiBJZiBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2ssIGdhdGhlciBvYnNlcnZlZEF0dHJpYnV0ZXNcbiAgICB0aGlzLmRlZmluaXRpb25zX1tuYW1lXSA9IHtcbiAgICAgIG5hbWUsXG4gICAgICBjdG9yLFxuICAgIH07XG5cbiAgICB0aGlzLm9ic2VydmVfKG5hbWUpO1xuICAgIHRoaXMudXBncmFkZSh0aGlzLmRvY18sIG5hbWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZ3JhZGVzIGN1c3RvbSBlbGVtZW50cyBkZXNjZW5kYW50cyBvZiByb290IChidXQgbm90IGluY2x1ZGluZyByb290KS5cbiAgICpcbiAgICogV2hlbiBjYWxsZWQgd2l0aCBhbiBvcHRfcXVlcnksIGl0IGJvdGggdXBncmFkZXMgYW5kIGNvbm5lY3RzIHRoZSBjdXN0b21cbiAgICogZWxlbWVudHMgKHRoaXMgaXMgdXNlZCBkdXJpbmcgdGhlIGN1c3RvbSBlbGVtZW50IGRlZmluZSBhbGdvcml0aG0pLlxuICAgKlxuICAgKiBAcGFyYW0geyFOb2RlfSByb290XG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X3F1ZXJ5XG4gICAqL1xuICB1cGdyYWRlKHJvb3QsIG9wdF9xdWVyeSkge1xuICAgIC8vIE9ubHkgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5LnAuZGVmaW5lIHByb3ZpZGVzIGEgcXVlcnkgKHRoZSBuZXdseSBkZWZpbmVkXG4gICAgLy8gY3VzdG9tIGVsZW1lbnQpLiBJbiB0aGlzIGNhc2UsIHdlIGFyZSBib3RoIHVwZ3JhZGluZyBfYW5kXyBjb25uZWN0aW5nXG4gICAgLy8gdGhlIGN1c3RvbSBlbGVtZW50cy5cbiAgICBjb25zdCBuZXdseURlZmluZWQgPSAhIW9wdF9xdWVyeTtcbiAgICBjb25zdCBxdWVyeSA9IG9wdF9xdWVyeSB8fCB0aGlzLnF1ZXJ5XztcbiAgICBjb25zdCB1cGdyYWRlQ2FuZGlkYXRlcyA9IHRoaXMucXVlcnlBbGxfKHJvb3QsIHF1ZXJ5KTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXBncmFkZUNhbmRpZGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGNhbmRpZGF0ZSA9IHVwZ3JhZGVDYW5kaWRhdGVzW2ldO1xuICAgICAgaWYgKG5ld2x5RGVmaW5lZCkge1xuICAgICAgICB0aGlzLmNvbm5lY3RlZENhbGxiYWNrXyhjYW5kaWRhdGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy51cGdyYWRlU2VsZihjYW5kaWRhdGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGdyYWRlcyB0aGUgY3VzdG9tIGVsZW1lbnQgbm9kZSwgaWYgYSBjdXN0b20gZWxlbWVudCBoYXMgYmVlbiByZWdpc3RlcmVkXG4gICAqIGJ5IHRoaXMgbmFtZS5cbiAgICpcbiAgICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICAgKi9cbiAgdXBncmFkZVNlbGYobm9kZSkge1xuICAgIGNvbnN0IGRlZiA9IHRoaXMuZ2V0QnlOYW1lKG5vZGUubG9jYWxOYW1lKTtcbiAgICBpZiAoIWRlZikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudXBncmFkZVNlbGZfKC8qKiBAdHlwZSB7IUVsZW1lbnR9ICovKG5vZGUpLCBkZWYpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IU5vZGV9IHJvb3RcbiAgICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5XG4gICAqIEByZXR1cm4geyFBcnJheXwhTm9kZUxpc3R9XG4gICAqL1xuICBxdWVyeUFsbF8ocm9vdCwgcXVlcnkpIHtcbiAgICBpZiAoIXF1ZXJ5IHx8ICFyb290LnF1ZXJ5U2VsZWN0b3JBbGwpIHtcbiAgICAgIC8vIE5vdGhpbmcgdG8gZG8uLi5cbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICByZXR1cm4gcm9vdC5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGdyYWRlcyB0aGUgKGFscmVhZHkgY3JlYXRlZCB2aWEgRE9NIHBhcnNpbmcpIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBub2RlXG4gICAqIEBwYXJhbSB7IUN1c3RvbUVsZW1lbnREZWZ9IGRlZlxuICAgKi9cbiAgdXBncmFkZVNlbGZfKG5vZGUsIGRlZikge1xuICAgIGNvbnN0IHtjdG9yfSA9IGRlZjtcbiAgICBpZiAobm9kZSBpbnN0YW5jZW9mIGN0b3IpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBEZXNwaXRlIGhvdyBpdCBsb29rcywgdGhpcyBpcyBub3QgYSB1c2VsZXNzIGNvbnN0cnVjdGlvbi5cbiAgICAvLyBIVE1MRWxlbWVudFBvbHlmaWxsICh0aGUgYmFzZSBjbGFzcyBvZiBhbGwgY3VzdG9tIGVsZW1lbnRzKSB3aWxsIHJldHVyblxuICAgIC8vIHRoZSBjdXJyZW50IG5vZGUsIGFsbG93aW5nIHRoZSBjdXN0b20gZWxlbWVudCdzIHN1YmNsYXNzIGNvbnN0cnVjdG9yIHRvXG4gICAgLy8gcnVuIG9uIHRoZSBub2RlLiBUaGUgbm9kZSBpdHNlbGYgaXMgYWxyZWFkeSBjb25zdHJ1Y3RlZCwgc28gdGhlIHJldHVyblxuICAgIC8vIHZhbHVlIGlzIGp1c3QgdGhlIG5vZGUuXG4gICAgdGhpcy5jdXJyZW50XyA9IG5vZGU7XG4gICAgY29uc3QgZWwgPSBuZXcgY3RvcigpO1xuXG4gICAgaWYgKGVsICE9PSBub2RlKSB7XG4gICAgICB0aHJvdyBuZXcgdGhpcy53aW5fLkVycm9yKFxuICAgICAgICAgICdDb25zdHJ1Y3RvciBpbGxlZ2FsbHkgcmV0dXJuZWQgYSBkaWZmZXJlbnQgaW5zdGFuY2UuJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZpcmVzIGNvbm5lY3RlZENhbGxiYWNrIG9uIHRoZSBjdXN0b20gZWxlbWVudCwgaWYgaXQgaGFzIG9uZS5cbiAgICogVGhpcyBhbHNvIHVwZ3JhZGVzIHRoZSBjdXN0b20gZWxlbWVudCwgc2luY2UgaXQgbWF5IG5vdCBoYXZlIGJlZW5cbiAgICogYWNjZXNzaWJsZSB2aWEgdGhlIHJvb3QgZG9jdW1lbnQgYmVmb3JlIChhIGRldGFjaGVkIERPTSB0cmVlKS5cbiAgICpcbiAgICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICAgKi9cbiAgY29ubmVjdGVkQ2FsbGJhY2tfKG5vZGUpIHtcbiAgICBjb25zdCBkZWYgPSB0aGlzLmdldEJ5TmFtZShub2RlLmxvY2FsTmFtZSk7XG4gICAgaWYgKCFkZWYpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy51cGdyYWRlU2VsZl8oLyoqIEB0eXBlIHshRWxlbWVudH0gKi8obm9kZSksIGRlZik7XG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogSXQgbWF5IGJlIGFwcHJvcHJpYXRlIHRvIGFkb3B0Q2FsbGJhY2ssIGlmIHRoZSBub2RlXG4gICAgLy8gdXNlZCB0byBiZSBpbiBhbm90aGVyIGRvYy5cbiAgICAvLyBUT0RPKGpyaWRnZXdlbGwpOiBJIHNob3VsZCBiZSBjYWxsaW5nIHRoZSBkZWZpbml0aW9ucyBjb25uZWN0ZWRDYWxsYmFja1xuICAgIC8vIHdpdGggbm9kZSBhcyB0aGUgY29udGV4dC5cbiAgICBpZiAobm9kZS5jb25uZWN0ZWRDYWxsYmFjaykge1xuICAgICAgbm9kZS5jb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGaXJlcyBkaXNjb25uZWN0ZWRDYWxsYmFjayBvbiB0aGUgY3VzdG9tIGVsZW1lbnQsIGlmIGl0IGhhcyBvbmUuXG4gICAqXG4gICAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAgICovXG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrXyhub2RlKSB7XG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogSSBzaG91bGQgYmUgY2FsbGluZyB0aGUgZGVmaW5pdGlvbnMgY29ubmVjdGVkQ2FsbGJhY2tcbiAgICAvLyB3aXRoIG5vZGUgYXMgdGhlIGNvbnRleHQuXG4gICAgaWYgKG5vZGUuZGlzY29ubmVjdGVkQ2FsbGJhY2spIHtcbiAgICAgIG5vZGUuZGlzY29ubmVjdGVkQ2FsbGJhY2soKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkcyBuYW1lIGFzIGEgcmVnaXN0ZXJlZCBjdXN0b20gZWxlbWVudCB0byBvYnNlcnZlLlxuICAgKlxuICAgKiBTdGFydHMgdGhlIE11dGF0aW9uIE9ic2VydmVyIGlmIHRoaXMgaXMgdGhlIGZpcnN0IHJlZ2lzdGVyZWQgY3VzdG9tXG4gICAqIGVsZW1lbnQuIFRoaXMgaXMgZGVmZXJyZWQgdW50aWwgdGhlIGZpcnN0IGN1c3RvbSBlbGVtZW50IGlzIGRlZmluZWQgdG9cbiAgICogc3BlZWQgdXAgaW5pdGlhbCByZW5kZXJpbmcgb2YgdGhlIHBhZ2UuXG4gICAqXG4gICAqIE11dGF0aW9uIE9ic2VydmVycyBhcmUgY29udmVuaWVudGx5IGF2YWlsYWJsZSBpbiBldmVyeSBicm93c2VyIHdlIGNhcmVcbiAgICogYWJvdXQuIFdoZW4gYSBub2RlIGlzIGNvbm5lY3RlZCB0byB0aGUgcm9vdCBkb2N1bWVudCwgYWxsIGN1c3RvbVxuICAgKiBlbGVtZW50cyAoaW5jbHVkaW5nIHRoYXQgbm9kZSBpdGVzZWxmKSB3aWxsIGJlIHVwZ3JhZGVkIGFuZCBjYWxsXG4gICAqIGNvbm5lY3RlZENhbGxiYWNrLiBXaGVuIGEgbm9kZSBpcyBkaXNjb25uZWN0ZWRDYWxsYmFjayBmcm9tIHRoZSByb290XG4gICAqIGRvY3VtZW50LCBhbGwgY3VzdG9tIGVsZW1lbnRzIHdpbGwgY2FsbCBkaXNjb25uZWN0ZWRDYWxsYmFjay5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICovXG4gIG9ic2VydmVfKG5hbWUpIHtcbiAgICBpZiAodGhpcy5xdWVyeV8pIHtcbiAgICAgIHRoaXMucXVlcnlfICs9IGAsJHtuYW1lfWA7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5xdWVyeV8gPSBuYW1lO1xuXG4gICAgLy8gVGhlIGZpcnN0IHJlZ2lzdGVyZWQgbmFtZSBzdGFydHMgdGhlIG11dGF0aW9uIG9ic2VydmVyLlxuICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IHRoaXMud2luXy5NdXRhdGlvbk9ic2VydmVyKHJlY29yZHMgPT4ge1xuICAgICAgaWYgKHJlY29yZHMpIHtcbiAgICAgICAgdGhpcy5oYW5kbGVSZWNvcmRzXyhyZWNvcmRzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBvYnNlcnZlci5vYnNlcnZlKHRoaXMuZG9jXywge1xuICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgc3VidHJlZTogdHJ1ZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgYWxsIHRoZSBNdXRhdGlvbiBPYnNlcnZlcidzIE11dGF0aW9uIFJlY29yZHMuXG4gICAqIEFsbCBhZGRlZCBjdXN0b20gZWxlbWVudHMgd2lsbCBiZSB1cGdyYWRlZCAoaWYgbm90IGFscmVhZHkpIGFuZCBjYWxsXG4gICAqIGNvbm5lY3RlZENhbGxiYWNrLiBBbGwgcmVtb3ZlZCBjdXN0b20gZWxlbWVudHMgd2lsbCBjYWxsXG4gICAqIGRpc2Nvbm5lY3RlZENhbGxiYWNrLlxuICAgKlxuICAgKiBAcGFyYW0geyFBcnJheTwhTXV0YXRpb25SZWNvcmQ+fSByZWNvcmRzXG4gICAqL1xuICBoYW5kbGVSZWNvcmRzXyhyZWNvcmRzKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZWNvcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCByZWNvcmQgPSByZWNvcmRzW2ldO1xuICAgICAgaWYgKCFyZWNvcmQpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHthZGRlZE5vZGVzLCByZW1vdmVkTm9kZXN9ID0gcmVjb3JkO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhZGRlZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBhZGRlZE5vZGVzW2ldO1xuICAgICAgICBjb25zdCBjb25uZWN0ZWRDYW5kaWRhdGVzID0gdGhpcy5xdWVyeUFsbF8obm9kZSwgdGhpcy5xdWVyeV8pO1xuICAgICAgICB0aGlzLmNvbm5lY3RlZENhbGxiYWNrXyhub2RlKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb25uZWN0ZWRDYW5kaWRhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdGhpcy5jb25uZWN0ZWRDYWxsYmFja18oY29ubmVjdGVkQ2FuZGlkYXRlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZW1vdmVkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IHJlbW92ZWROb2Rlc1tpXTtcbiAgICAgICAgY29uc3QgZGlzY29ubmVjdGVkQ2FuZGlkYXRlcyA9IHRoaXMucXVlcnlBbGxfKG5vZGUsIHRoaXMucXVlcnlfKTtcbiAgICAgICAgdGhpcy5kaXNjb25uZWN0ZWRDYWxsYmFja18obm9kZSk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGlzY29ubmVjdGVkQ2FuZGlkYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuZGlzY29ubmVjdGVkQ2FsbGJhY2tfKGRpc2Nvbm5lY3RlZENhbmRpZGF0ZXNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogRG9lcyB0aGUgcG9seWZpbGxpbmcuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5mdW5jdGlvbiBwb2x5ZmlsbCh3aW4pIHtcbiAgY29uc3Qge0hUTUxFbGVtZW50LCBFbGVtZW50LCBOb2RlLCBEb2N1bWVudCwgT2JqZWN0LCBkb2N1bWVudH0gPSB3aW47XG4gIGNvbnN0IHtjcmVhdGVFbGVtZW50LCBjbG9uZU5vZGUsIGltcG9ydE5vZGV9ID0gZG9jdW1lbnQ7XG5cbiAgY29uc3QgcmVnaXN0cnkgPSBuZXcgUmVnaXN0cnkod2luKTtcbiAgY29uc3QgY3VzdG9tRWxlbWVudHMgPSBuZXcgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5KHdpbiwgcmVnaXN0cnkpO1xuXG4gIC8vIEV4cG9zZSB0aGUgY3VzdG9tIGVsZW1lbnQgcmVnaXN0cnkuXG4gIC8vIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LCAnY3VzdG9tRWxlbWVudHMnKVxuICAvLyB7Z2V0OiDGkiwgc2V0OiB1bmRlZmluZWQsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZX1cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbiwgJ2N1c3RvbUVsZW1lbnRzJywge1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIC8vIHdyaXRhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogY3VzdG9tRWxlbWVudHMsXG4gIH0pO1xuXG4gIC8vIFBhdGNoIGNyZWF0ZUVsZW1lbnQgdG8gaW1tZWRpYXRlbHkgdXBncmFkZSB0aGUgY3VzdG9tIGVsZW1lbnQuXG4gIC8vIFRoaXMgaGFzIHRoZSBhZGRlZCBiZW5lZml0IHRoYXQgaXQgYXZvaWRzIHRoZSBcImFscmVhZHkgY3JlYXRlZCBidXQgbmVlZHNcbiAgLy8gY29uc3RydWN0b3IgY29kZSBydW5cIiBjaGlja2VuLWFuZC1lZ2cgcHJvYmxlbS5cbiAgRG9jdW1lbnQucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbiBjcmVhdGVFbGVtZW50UG9seWZpbGwobmFtZSkge1xuICAgIGNvbnN0IGRlZiA9IHJlZ2lzdHJ5LmdldEJ5TmFtZShuYW1lKTtcbiAgICBpZiAoZGVmKSB7XG4gICAgICByZXR1cm4gbmV3IGRlZi5jdG9yKCk7XG4gICAgfVxuICAgIHJldHVybiBjcmVhdGVFbGVtZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgLy8gUGF0Y2ggaW1wb3J0Tm9kZSB0byBpbW1lZGlhdGVseSB1cGdyYWRlIGN1c3RvbSBlbGVtZW50cy5cbiAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogQ2FuIGZpcmUgYWRvcHRlZENhbGxiYWNrIGZvciBjcm9zcyBkb2MgaW1wb3J0cy5cbiAgRG9jdW1lbnQucHJvdG90eXBlLmltcG9ydE5vZGUgPSBmdW5jdGlvbiBpbXBvcnROb2RlUG9seWZpbGwoKSB7XG4gICAgY29uc3QgaW1wb3J0ZWQgPSBpbXBvcnROb2RlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKGltcG9ydGVkKSB7XG4gICAgICByZWdpc3RyeS51cGdyYWRlU2VsZihpbXBvcnRlZCk7XG4gICAgICByZWdpc3RyeS51cGdyYWRlKGltcG9ydGVkKTtcbiAgICB9XG4gICAgcmV0dXJuIGltcG9ydGVkO1xuICB9O1xuXG4gIC8vIFBhdGNoIGNsb25lTm9kZSB0byBpbW1lZGlhdGVseSB1cGdyYWRlIGN1c3RvbSBlbGVtZW50cy5cbiAgTm9kZS5wcm90b3R5cGUuY2xvbmVOb2RlID0gZnVuY3Rpb24gY2xvbmVOb2RlUG9seWZpbGwoKSB7XG4gICAgY29uc3QgY2xvbmVkID0gY2xvbmVOb2RlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgcmVnaXN0cnkudXBncmFkZVNlbGYoY2xvbmVkKTtcbiAgICByZWdpc3RyeS51cGdyYWRlKGNsb25lZCk7XG4gICAgcmV0dXJuIGNsb25lZDtcbiAgfTtcblxuICAvLyBQYXRjaCB0aGUgaW5uZXJIVE1MIHNldHRlciB0byBpbW1lZGlhdGVseSB1cGdyYWRlIGN1c3RvbSBlbGVtZW50cy5cbiAgLy8gTm90ZSwgdGhpcyBjb3VsZCB0ZWNobmljYWxseSBmaXJlIGNvbm5lY3RlZENhbGxiYWNrcyBpZiB0aGlzIG5vZGUgd2FzXG4gIC8vIGNvbm5lY3RlZCwgYnV0IHdlIGxlYXZlIHRoYXQgdG8gdGhlIE11dGF0aW9uIE9ic2VydmVyLlxuICBjb25zdCBpbm5lckhUTUxEZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihFbGVtZW50LnByb3RvdHlwZSxcbiAgICAgICdpbm5lckhUTUwnKTtcbiAgY29uc3QgaW5uZXJIVE1MU2V0dGVyID0gaW5uZXJIVE1MRGVzYy5zZXQ7XG4gIGlubmVySFRNTERlc2Muc2V0ID0gZnVuY3Rpb24oaHRtbCkge1xuICAgIGlubmVySFRNTFNldHRlci5jYWxsKHRoaXMsIGh0bWwpO1xuICAgIHJlZ2lzdHJ5LnVwZ3JhZGUodGhpcyk7XG4gIH07XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFbGVtZW50LnByb3RvdHlwZSwgJ2lubmVySFRNTCcsIGlubmVySFRNTERlc2MpO1xuXG4gIC8qKlxuICAgKiBZb3UgY2FuJ3QgdXNlIHRoZSByZWFsIEhUTUxFbGVtZW50IGNvbnN0cnVjdG9yLCBiZWNhdXNlIHlvdSBjYW4ndCBzdWJjbGFzc1xuICAgKiBpdCB3aXRob3V0IHVzaW5nIG5hdGl2ZSBjbGFzc2VzLiBTbywgbW9jayBpdHMgYXBwcm94aW1hdGlvbiB1c2luZ1xuICAgKiBjcmVhdGVFbGVtZW50LlxuICAgKi9cbiAgZnVuY3Rpb24gSFRNTEVsZW1lbnRQb2x5ZmlsbCgpIHtcbiAgICBjb25zdCB7Y29uc3RydWN0b3J9ID0gdGhpcztcblxuICAgIC8vIElmIHdlJ3JlIHVwZ3JhZGluZyBhbiBhbHJlYWR5IGNyZWF0ZWQgY3VzdG9tIGVsZW1lbnQsIHdlIGNhbid0IGNyZWF0ZVxuICAgIC8vIGFub3RoZXIgbmV3IG5vZGUgKGJ5IHRoZSBzcGVjLCBpdCBtdXN0IGJlIHRoZSBzYW1lIG5vZGUpLlxuICAgIGxldCBlbCA9IHJlZ2lzdHJ5LmN1cnJlbnQoKTtcblxuICAgIC8vIElmIHRoZXJlJ3Mgbm90IGEgYWxyZWFkeSBjcmVhdGVkIGN1c3RvbSBlbGVtZW50LCB3ZSdyZSBiZWluZyBpbnZva2VkIHZpYVxuICAgIC8vIGBuZXdgaW5nIHRoZSBjb25zdHJ1Y3Rvci5cbiAgICAvL1xuICAgIC8vIFRlY2huaWNhbGx5LCB3ZSBjb3VsZCBnZXQgaGVyZSB2aWEgY3JlYXRlRWxlbWVudCwgYnV0IHdlIHBhdGNoZWQgdGhhdC5cbiAgICAvLyBJZiBpdCB0aGUgY3VzdG9tIGVsZW1lbnQgd2FzIHJlZ2lzdGVyZWQsIHRoZSBwYXRjaCB0dXJuZWQgaXQgaW50byBhXG4gICAgLy8gYG5ld2AgY2FsbC5cbiAgICAvLyBJZiBpdCB3YXMgbm90IHJlZ2lzdGVyZWQsIHRoZSBuYXRpdmUgY3JlYXRlRWxlbWVudCBpcyB1c2VkLiBBbmQgaWZcbiAgICAvLyBuYXRpdmUgY3JlYXRlRWxlbWVudCBpcyBiZWluZyB1c2VkIGFuZCB3ZSBnb3QgdG8gdGhpcyBjb2RlLCB3ZSdyZSByZWFsbHlcbiAgICAvLyBpbiBhbiBpbmZpbml0ZSBsb29wIChhIG5hdGl2ZSBjcmVhdGVFbGVtZW50IGNhbGwganVzdCBiZWxvdykgc28gd2UndmVcbiAgICAvLyBnb3QgYmlnZ2VyIHByb2JsZW1zLlxuICAgIC8vXG4gICAgLy8gU28ganVzdCB0YWtlIG15IHdvcmQgd2UgZ290IGhlcmUgdmlhIGBuZXdgLlxuICAgIGlmICghZWwpIHtcbiAgICAgIC8vIFRoZSBjdXN0b20gZWxlbWVudCBkZWZpbml0aW9uIGlzIGFuIGludmFyaWFudC4gSWYgdGhlIGN1c3RvbSBlbGVtZW50XG4gICAgICAvLyBpcyByZWdpc3RlcmVkLCBldmVyeXRoaW5nIHdvcmtzLiBJZiBpdCdzIG5vdCwgaXQgdGhyb3dzIGluIHRoZSBtZW1iZXJcbiAgICAgIC8vIHByb3BlcnR5IGFjY2VzcyAob25seSBkZWZpbmVkIGN1c3RvbSBlbGVtZW50cyBjYW4gYmUgZGlyZWN0bHlcbiAgICAgIC8vIGNvbnN0cnVjdGVkIHZpYSBgbmV3YCkuXG4gICAgICBjb25zdCBkZWYgPSByZWdpc3RyeS5nZXRCeUNvbnN0cnVjdG9yKGNvbnN0cnVjdG9yKTtcbiAgICAgIGVsID0gY3JlYXRlRWxlbWVudC5jYWxsKGRvY3VtZW50LCBkZWYubmFtZSk7XG4gICAgfVxuXG4gICAgLy8gRmluYWxseSwgaWYgdGhlIG5vZGUgd2FzIGFscmVhZHkgY29uc3RydWN0ZWQsIHdlIG5lZWQgdG8gcmVzZXQgaXQnc1xuICAgIC8vIHByb3RvdHlwZSB0byB0aGUgY3VzdG9tIGVsZW1lbnQgcHJvdG90eXBlLiBBbmQgaWYgaXQgd2Fzbid0IGFscmVhZHlcbiAgICAvLyBjb25zdHJ1Y3RlZCwgd2UgY3JlYXRlZCBhIG5ldyBub2RlIHZpYSBuYXRpdmUgY3JlYXRlRWxlbWVudCwgYW5kIHdlIG5lZWRcbiAgICAvLyB0byByZXNldCBpdCdzIHByb3RvdHlwZS4gQmFzaWNhbGx5IGFsd2F5cyByZXNldCB0aGUgcHJvdG90eXBlLlxuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihlbCwgY29uc3RydWN0b3IucHJvdG90eXBlKTtcbiAgICByZXR1cm4gZWw7XG4gIH1cbiAgc3ViQ2xhc3MoT2JqZWN0LCBIVE1MRWxlbWVudCwgSFRNTEVsZW1lbnRQb2x5ZmlsbCk7XG5cbiAgLy8gRXhwb3NlIHRoZSBwb2x5ZmlsbGVkIEhUTUxFbGVtZW50IGNvbnN0cnVjdG9yIGZvciBldmVyeW9uZSB0byBleHRlbmQgZnJvbS5cbiAgd2luLkhUTUxFbGVtZW50ID0gSFRNTEVsZW1lbnRQb2x5ZmlsbDtcbn1cblxuLyoqXG4gKiBXcmFwcyBIVE1MRWxlbWVudCBpbiBhIFJlZmxlY3QuY29uc3RydWN0IGNvbnN0cnVjdG9yLCBzbyB0aGF0IHRyYW5zcGlsZWRcbiAqIGNsYXNzZXMgY2FuIGBfdGhpcyA9IHN1cGVyQ2xhc3MuY2FsbCh0aGlzKWAgZHVyaW5nIHRoZWlyIGNvbnN0cnVjdGlvbi5cbiAqXG4gKiBUaGlzIGlzIG9ubHkgdXNlZCB3aGVuIEN1c3RvbSBFbGVtZW50cyB2MSBpcyBhbHJlYWR5IGF2YWlsYWJsZSBfYW5kXyB3ZSdyZVxuICogdXNpbmcgdHJhbnNwaWxlZCBjbGFzc2VzICh3aGljaCB1c2UgRVM1IGNvbnN0cnVjdGlvbiBpZGlvbXMpLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKi9cbmZ1bmN0aW9uIHdyYXBIVE1MRWxlbWVudCh3aW4pIHtcbiAgY29uc3Qge0hUTUxFbGVtZW50LCBSZWZsZWN0LCBPYmplY3R9ID0gd2luO1xuICAvKipcbiAgICovXG4gIGZ1bmN0aW9uIEhUTUxFbGVtZW50V3JhcHBlcigpIHtcbiAgICBjb25zdCBjdG9yID0gLyoqIEB0eXBlIHtmdW5jdGlvbiguLi4/KTo/fHVuZGVmaW5lZH0gKi8oXG4gICAgICAvKiogQHR5cGUgeyFIVE1MRWxlbWVudH0gKi8odGhpcykuY29uc3RydWN0b3IpO1xuXG4gICAgLy8gUmVmbGVjdC5jb25zdHJ1Y3QgYWxsb3dzIHVzIHRvIGNvbnN0cnVjdCBhIG5ldyBIVE1MRWxlbWVudCB3aXRob3V0IHVzaW5nXG4gICAgLy8gYG5ld2AgKHdoaWNoIHdpbGwgYWx3YXlzIGZhaWwgYmVjYXVzZSBuYXRpdmUgSFRNTEVsZW1lbnQgaXMgYSByZXN0cmljdGVkXG4gICAgLy8gY29uc3RydWN0b3IpLlxuICAgIHJldHVybiBSZWZsZWN0LmNvbnN0cnVjdChIVE1MRWxlbWVudCwgW10sIGN0b3IpO1xuICB9XG4gIHN1YkNsYXNzKE9iamVjdCwgSFRNTEVsZW1lbnQsIEhUTUxFbGVtZW50V3JhcHBlcik7XG5cbiAgLy8gRXhwb3NlIHRoZSB3cmFwcGVkIEhUTUxFbGVtZW50IGNvbnN0cnVjdG9yIGZvciBldmVyeW9uZSB0byBleHRlbmQgZnJvbS5cbiAgd2luLkhUTUxFbGVtZW50ID0gSFRNTEVsZW1lbnRXcmFwcGVyO1xufVxuXG4vKipcbiAqIFNldHVwcyB1cCBwcm90b3R5cGUgaW5oZXJpdGFuY2VcbiAqXG4gKiBAcGFyYW0geyFPYmplY3R9IE9iamVjdFxuICogQHBhcmFtIHshRnVuY3Rpb259IHN1cGVyQ2xhc3NcbiAqIEBwYXJhbSB7IUZ1bmN0aW9ufSBzdWJDbGFzc1xuICovXG5mdW5jdGlvbiBzdWJDbGFzcyhPYmplY3QsIHN1cGVyQ2xhc3MsIHN1YkNsYXNzKSB7XG4gIC8vIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc3VwZXJDbGFzcy5wcm90b3R5cGUsICdjb25zdHJ1Y3RvcicpXG4gIC8vIHt2YWx1ZTogxpIsIHdyaXRhYmxlOiB0cnVlLCBlbnVtZXJhYmxlOiBmYWxzZSwgY29uZmlndXJhYmxlOiB0cnVlfVxuICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7XG4gICAgY29uc3RydWN0b3I6IHtcbiAgICAgIC8vIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogc3ViQ2xhc3MsXG4gICAgfSxcbiAgfSk7XG59XG5cbi8qKlxuICogUG9seWZpbGxzIEN1c3RvbSBFbGVtZW50cyB2MSBBUEkuIFRoaXMgaGFzIDQgbW9kZXM6XG4gKlxuICogMS4gQ3VzdG9tIGVsZW1lbnRzIHYxIGFscmVhZHkgc3VwcG9ydGVkLCB1c2luZyBuYXRpdmUgY2xhc3Nlc1xuICogMi4gQ3VzdG9tIGVsZW1lbnRzIHYxIGFscmVhZHkgc3VwcG9ydGVkLCB1c2luZyB0cmFuc3BpbGVkIGNsYXNzZXNcbiAqIDMuIEN1c3RvbSBlbGVtZW50cyB2MSBub3Qgc3VwcG9ydGVkLCB1c2luZyBuYXRpdmUgY2xhc3Nlc1xuICogNC4gQ3VzdG9tIGVsZW1lbnRzIHYxIG5vdCBzdXBwb3J0ZWQsIHVzaW5nIHRyYW5zcGlsZWQgY2xhc3Nlc1xuICpcbiAqIEluIG1vZGUgMSwgbm90aGluZyBpcyBkb25lLiBJbiBtb2RlIDIsIGEgbWluaW1hbCBwb2x5ZmlsbCBpcyB1c2VkIHRvIHN1cHBvcnRcbiAqIGV4dGVuZGluZyB0aGUgSFRNTEVsZW1lbnQgYmFzZSBjbGFzcy4gSW4gbW9kZSAzIGFuZCA0LCBhIGZ1bGwgcG9seWZpbGwgaXNcbiAqIGRvbmUuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IUZ1bmN0aW9ufSBjdG9yXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnN0YWxsKHdpbiwgY3Rvcikge1xuICBpZiAoaXNQYXRjaGVkKHdpbikpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgaW5zdGFsbCA9IHRydWU7XG4gIGxldCBpbnN0YWxsV3JhcHBlciA9IGZhbHNlO1xuXG4gIGlmIChoYXNDdXN0b21FbGVtZW50cyh3aW4pKSB7XG4gICAgLy8gSWYgY3RvciBpcyBjb25zdHJ1Y3RhYmxlIHdpdGhvdXQgbmV3LCBpdCdzIGEgZnVuY3Rpb24uIFRoYXQgbWVhbnMgaXQgd2FzXG4gICAgLy8gY29tcGlsZWQgZG93biwgYW5kIHdlIG5lZWQgdG8gZG8gdGhlIG1pbmltYWwgcG9seWZpbGwgYmVjYXVzZSBhbGwgeW91XG4gICAgLy8gY2Fubm90IGV4dGVuZCBIVE1MRWxlbWVudCB3aXRob3V0IG5hdGl2ZSBjbGFzc2VzLlxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7T2JqZWN0LCBSZWZsZWN0fSA9IHdpbjtcblxuICAgICAgLy8gXCJDb25zdHJ1Y3RcIiBjdG9yIHVzaW5nIEVTNSBpZGlvbXNcbiAgICAgIGNvbnN0IGluc3RhbmNlID0gT2JqZWN0LmNyZWF0ZShjdG9yLnByb3RvdHlwZSk7XG4gICAgICBjdG9yLmNhbGwoaW5zdGFuY2UpO1xuXG4gICAgICAvLyBJZiB0aGF0IHN1Y2NlZWRlZCwgd2UncmUgaW4gYSB0cmFuc3BpbGVkIGVudmlyb25tZW50XG4gICAgICAvLyBMZXQncyBmaW5kIG91dCBpZiB3ZSBjYW4gd3JhcCBIVE1MRWxlbWVudCBhbmQgYXZvaWQgYSBmdWxsIHBhdGNoLlxuICAgICAgaW5zdGFsbFdyYXBwZXIgPSAhIShSZWZsZWN0ICYmIFJlZmxlY3QuY29uc3RydWN0KTtcbiAgICB9IGNhdGNoIChlKSB7XG5cbiAgICAgIC8vIFRoZSBjdG9yIHRocmV3IHdoZW4gd2UgY29uc3RydWN0ZWQgaXMgdmlhIEVTNSwgc28gaXQncyBhIHJlYWwgY2xhc3MuXG4gICAgICAvLyBXZSdyZSBvayB0byBub3QgaW5zdGFsbCB0aGUgcG9seWZpbGwuXG4gICAgICBpbnN0YWxsID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgaWYgKGluc3RhbGxXcmFwcGVyKSB7XG4gICAgd3JhcEhUTUxFbGVtZW50KHdpbik7XG4gIH0gZWxzZSBpZiAoaW5zdGFsbCkge1xuICAgIHBvbHlmaWxsKHdpbik7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogUG9seWZpbGwgZm9yIGBkb2N1bWVudC5jb250YWlucygpYCBtZXRob2QuIE5vdGljZSB0aGF0IGFjY29yZGluZyB0byBzcGVjXG4gKiBgZG9jdW1lbnQuY29udGFpbnNgIGlzIGluY2x1c2lvbmFyeS5cbiAqIFNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvTm9kZS9jb250YWluc1xuICogQHBhcmFtIHs/Tm9kZX0gbm9kZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0aGlzIHtOb2RlfVxuICovXG5mdW5jdGlvbiBkb2N1bWVudENvbnRhaW5zUG9seWZpbGwobm9kZSkge1xuICAvLyBQZXIgc3BlYywgXCJjb250YWluc1wiIG1ldGhvZCBpcyBpbmNsdXNpb25hcnlcbiAgLy8gaS5lLiBgbm9kZS5jb250YWlucyhub2RlKSA9PSB0cnVlYC4gSG93ZXZlciwgd2Ugc3RpbGwgbmVlZCB0byB0ZXN0XG4gIC8vIGVxdWFsaXR5IHRvIHRoZSBkb2N1bWVudCBpdHNlbGYuXG4gIHJldHVybiBub2RlID09IHRoaXMgfHwgdGhpcy5kb2N1bWVudEVsZW1lbnQuY29udGFpbnMobm9kZSk7XG59XG5cblxuLyoqXG4gKiBQb2x5ZmlsbHMgYEhUTUxEb2N1bWVudC5jb250YWluc2AgQVBJLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIC8vIEhUTUxEb2N1bWVudCBpcyB1bmRlZmluZWQgaW4gSW50ZXJuZXQgRXhwbG9yZXIgMTAsIGJ1dCBpdCBoYXMgRG9jdW1lbnQsXG4gIC8vIHNvIHdlIHVzZSB0aGF0IGFzIGEgZmFsbGJhY2suXG4gIGNvbnN0IGRvY3VtZW50Q2xhc3MgPSB3aW4uSFRNTERvY3VtZW50IHx8IHdpbi5Eb2N1bWVudDtcbiAgaWYgKCFkb2N1bWVudENsYXNzLnByb3RvdHlwZS5jb250YWlucykge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkoZG9jdW1lbnRDbGFzcy5wcm90b3R5cGUsICdjb250YWlucycsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogZG9jdW1lbnRDb250YWluc1BvbHlmaWxsLFxuICAgIH0pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBgRE9NVG9rZW5MaXN0LnByb3RvdHlwZS50b2dnbGUodG9rZW4sIG9wdF9mb3JjZSlgIG1ldGhvZC4gVGhpc1xuICogaXMgc3BlY2lhbGx5IGltcG9ydGFudCBiZWNhdXNlIElFIGRvZXMgbm90IHN1cHBvcnQgYG9wdF9mb3JjZWAgYXR0cmlidXRlLiBTZWVcbiAqIGh0dHBzOi8vZ29vLmdsL2hnS05ZWSBmb3IgZGV0YWlscy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0b2tlblxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2ZvcmNlXG4gKiBAdGhpcyB7RE9NVG9rZW5MaXN0fVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gZG9tVG9rZW5MaXN0VG9nZ2xlUG9seWZpbGwodG9rZW4sIG9wdF9mb3JjZSkge1xuICBjb25zdCByZW1vdmUgPSBvcHRfZm9yY2UgPT09IHVuZGVmaW5lZCA/IHRoaXMuY29udGFpbnModG9rZW4pIDogIW9wdF9mb3JjZTtcbiAgaWYgKHJlbW92ZSkge1xuICAgIHRoaXMucmVtb3ZlKHRva2VuKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5hZGQodG9rZW4pO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG5cblxuLyoqXG4gKiBQb2x5ZmlsbHMgYERPTVRva2VuTGlzdC5wcm90b3R5cGUudG9nZ2xlYCBBUEkgaW4gSUUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKGlzSWUod2luKSAmJiB3aW4uRE9NVG9rZW5MaXN0KSB7XG4gICAgd2luLk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW4uRE9NVG9rZW5MaXN0LnByb3RvdHlwZSwgJ3RvZ2dsZScsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogZG9tVG9rZW5MaXN0VG9nZ2xlUG9seWZpbGwsXG4gICAgfSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGN1cnJlbnQgYnJvd3NlciBpcyBhIElFIGJyb3dzZXIuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNJZSh3aW4pIHtcbiAgcmV0dXJuIC9UcmlkZW50fE1TSUV8SUVNb2JpbGUvaS50ZXN0KHdpbi5uYXZpZ2F0b3IudXNlckFnZW50KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIFBhcnNlcyB0aGUgbnVtYmVyIHggYW5kIHJldHVybnMgaXRzIHNpZ24uIEZvciBwb3NpdGl2ZSB4IHJldHVybnMgMSwgZm9yXG4gKiBuZWdhdGl2ZSwgLTEuIEZvciAwIGFuZCAtMCwgcmV0dXJucyAwIGFuZCAtMCByZXNwZWN0aXZlbHkuIEZvciBhbnkgbnVtYmVyXG4gKiB0aGF0IHBhcnNlcyB0byBOYU4sIHJldHVybnMgTmFOLlxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gKiBAcmV0dXJuIHtudW1iZXJ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaWduKHgpIHtcbiAgeCA9IE51bWJlcih4KTtcblxuICAvLyBJZiB4IGlzIDAsIC0wLCBvciBOYU4sIHJldHVybiBpdC5cbiAgaWYgKCF4KSB7XG4gICAgcmV0dXJuIHg7XG4gIH1cblxuICByZXR1cm4geCA+IDAgPyAxIDogLTE7XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBNYXRoLnNpZ24gcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uTWF0aC5zaWduKSB7XG4gICAgd2luLk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW4uTWF0aCwgJ3NpZ24nLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IHNpZ24sXG4gICAgfSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5jb25zdCB7aGFzT3duUHJvcGVydHl9ID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqXG4gKiBDb3BpZXMgdmFsdWVzIG9mIGFsbCBlbnVtZXJhYmxlIG93biBwcm9wZXJ0aWVzIGZyb20gb25lIG9yIG1vcmUgc291cmNlXG4gKiBvYmplY3RzIChwcm92aWRlZCBhcyBleHRlbmRlZCBhcmd1bWVudHMgdG8gdGhlIGZ1bmN0aW9uKSB0byBhIHRhcmdldCBvYmplY3QuXG4gKlxuICogQHBhcmFtIHshT2JqZWN0fSB0YXJnZXRcbiAqIEBwYXJhbSB7Li4uT2JqZWN0fSB2YXJfYXJnc1xuICogQHJldHVybiB7IU9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQsIHZhcl9hcmdzKSB7XG4gIGlmICh0YXJnZXQgPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjb252ZXJ0IHVuZGVmaW5lZCBvciBudWxsIHRvIG9iamVjdCcpO1xuICB9XG5cbiAgY29uc3Qgb3V0cHV0ID0gT2JqZWN0KHRhcmdldCk7XG4gIGZvciAobGV0IGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgIGlmIChzb3VyY2UgIT0gbnVsbCkge1xuICAgICAgZm9yIChjb25zdCBrZXkgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkge1xuICAgICAgICAgIG91dHB1dFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG91dHB1dDtcbn1cblxuXG4vKipcbiAqIFNldHMgdGhlIE9iamVjdC5hc3NpZ24gcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uT2JqZWN0LmFzc2lnbikge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkod2luLk9iamVjdCwgJ2Fzc2lnbicsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogYXNzaWduLFxuICAgIH0pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG5pbXBvcnQgKiBhcyBQcm9taXNlIGZyb20gJ3Byb21pc2UtcGpzL3Byb21pc2UnO1xuXG4vKipcbiAqIFNldHMgdGhlIFByb21pc2UgcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uUHJvbWlzZSkge1xuICAgIHdpbi5Qcm9taXNlID0gLyoqIEB0eXBlIHs/fSAqLyAoUHJvbWlzZSk7XG4gICAgLy8gSW4gYmFiZWwgdGhlICogZXhwb3J0IGlzIGFuIE9iamVjdCB3aXRoIGEgZGVmYXVsdCBwcm9wZXJ0eS5cbiAgICAvLyBJbiBjbG9zdXJlIGNvbXBpbGVyIGl0IGlzIHRoZSBQcm9taXNlIGZ1bmN0aW9uIGl0c2VsZi5cbiAgICBpZiAoUHJvbWlzZS5kZWZhdWx0KSB7XG4gICAgICB3aW4uUHJvbWlzZSA9IFByb21pc2UuZGVmYXVsdDtcbiAgICB9XG4gICAgLy8gV2UgY29weSB0aGUgaW5kaXZpZHVhbCBzdGF0aWMgbWV0aG9kcywgYmVjYXVzZSBjbG9zdXJlXG4gICAgLy8gY29tcGlsZXIgZmxhdHRlbnMgdGhlIHBvbHlmaWxsIG5hbWVzcGFjZS5cbiAgICB3aW4uUHJvbWlzZS5yZXNvbHZlID0gUHJvbWlzZS5yZXNvbHZlO1xuICAgIHdpbi5Qcm9taXNlLnJlamVjdCA9IFByb21pc2UucmVqZWN0O1xuICAgIHdpbi5Qcm9taXNlLmFsbCA9IFByb21pc2UuYWxsO1xuICAgIHdpbi5Qcm9taXNlLnJhY2UgPSBQcm9taXNlLnJhY2U7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgUmVnaXN0cmF0aW9uIGFuZCBnZXR0ZXIgZnVuY3Rpb25zIGZvciBBTVAgc2VydmljZXMuXG4gKlxuICogSW52YXJpYW50OiBTZXJ2aWNlIGdldHRlcnMgbmV2ZXIgcmV0dXJuIG51bGwgZm9yIHJlZ2lzdGVyZWQgc2VydmljZXMuXG4gKi9cblxuLy8gc3JjL3BvbHlmaWxscy5qcyBtdXN0IGJlIHRoZSBmaXJzdCBpbXBvcnQuXG5pbXBvcnQgJy4vcG9seWZpbGxzJzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBzb3J0LWltcG9ydHMtZXM2LWF1dG9maXgvc29ydC1pbXBvcnRzLWVzNlxuXG5pbXBvcnQge0RlZmVycmVkfSBmcm9tICcuL3V0aWxzL3Byb21pc2UnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7dG9XaW59IGZyb20gJy4vdHlwZXMnO1xuXG5cbi8qKlxuICogSG9sZHMgaW5mbyBhYm91dCBhIHNlcnZpY2UuXG4gKiAtIG9iajogQWN0dWFsIHNlcnZpY2UgaW1wbGVtZW50YXRpb24gd2hlbiBhdmFpbGFibGUuXG4gKiAtIHByb21pc2U6IFByb21pc2UgZm9yIHRoZSBvYmouXG4gKiAtIHJlc29sdmU6IEZ1bmN0aW9uIHRvIHJlc29sdmUgdGhlIHByb21pc2Ugd2l0aCB0aGUgb2JqZWN0LlxuICogLSBjb250ZXh0OiBBcmd1bWVudCBmb3IgY3RvciwgZWl0aGVyIGEgd2luZG93IG9yIGFuIGFtcGRvYy5cbiAqIC0gY3RvcjogRnVuY3Rpb24gdGhhdCBjb25zdHJ1Y3RzIGFuZCByZXR1cm5zIHRoZSBzZXJ2aWNlLlxuICogQHR5cGVkZWYge3tcbiAqICAgb2JqOiAoP09iamVjdCksXG4gKiAgIHByb21pc2U6ICg/UHJvbWlzZSksXG4gKiAgIHJlc29sdmU6ICg/ZnVuY3Rpb24oIU9iamVjdCkpLFxuICogICBjb250ZXh0OiAoP1dpbmRvd3w/Li9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvYyksXG4gKiAgIGN0b3I6ICg/ZnVuY3Rpb24obmV3Ok9iamVjdCwgIVdpbmRvdyl8XG4gKiAgICAgICAgICA/ZnVuY3Rpb24obmV3Ok9iamVjdCwgIS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2MpKSxcbiAqIH19XG4gKi9cbmxldCBTZXJ2aWNlSG9sZGVyRGVmO1xuXG5cbi8qKlxuICogVGhpcyBpbnRlcmZhY2UgcHJvdmlkZXMgYSBgZGlzcG9zZWAgbWV0aG9kIHRoYXQgd2lsbCBiZSBjYWxsZWQgYnlcbiAqIHJ1bnRpbWUgd2hlbiBhIHNlcnZpY2UgbmVlZHMgdG8gYmUgZGlzcG9zZWQgb2YuXG4gKiBAaW50ZXJmYWNlXG4gKi9cbmV4cG9ydCBjbGFzcyBEaXNwb3NhYmxlIHtcblxuICAvKipcbiAgICogSW5zdHJ1Y3RzIHRoZSBzZXJ2aWNlIHRvIHJlbGVhc2UgYW55IHJlc291cmNlcyBpdCBtaWdodCBiZSBob2xkaW5nLiBDYW5cbiAgICogYmUgY2FsbGVkIG9ubHkgb25jZSBpbiB0aGUgbGlmZWN5Y2xlIG9mIGEgc2VydmljZS5cbiAgICovXG4gIGRpc3Bvc2UoKSB7fVxufVxuXG5cbi8qKlxuICogVGhpcyBpbnRlcmZhY2UgcHJvdmlkZXMgYSBgYWRvcHRFbWJlZFdpbmRvd2AgbWV0aG9kIHRoYXQgd2lsbCBiZSBjYWxsZWQgYnlcbiAqIHJ1bnRpbWUgZm9yIGEgbmV3IGVtYmVkIHdpbmRvdy5cbiAqIEBpbnRlcmZhY2VcbiAqL1xuZXhwb3J0IGNsYXNzIEVtYmVkZGFibGVTZXJ2aWNlIHtcblxuICAvKipcbiAgICogSW5zdHJ1Y3RzIHRoZSBzZXJ2aWNlIHRvIGFkb3B0IHRoZSBlbWJlZCB3aW5kb3cgYW5kIGFkZCBhbnkgbmVjZXNzYXJ5XG4gICAqIGxpc3RlbmVycyBhbmQgcmVzb3VyY2VzLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHVudXNlZEVtYmVkV2luXG4gICAqL1xuICBhZG9wdEVtYmVkV2luZG93KHVudXNlZEVtYmVkV2luKSB7fVxufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2Ugd2l0aCB0aGUgZ2l2ZW4gaWQuIEFzc3VtZXMgdGhhdCBpdCBoYXMgYmVlbiByZWdpc3RlcmVkXG4gKiBhbHJlYWR5LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2ZhbGxiYWNrVG9Ub3BXaW5cbiAqIEByZXR1cm4ge09iamVjdH0gVGhlIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFeGlzdGluZ1NlcnZpY2VJbkVtYmVkU2NvcGUod2luLCBpZCwgb3B0X2ZhbGxiYWNrVG9Ub3BXaW4pIHtcbiAgLy8gRmlyc3QsIHRyeSB0byByZXNvbHZlIHZpYSBsb2NhbCAoZW1iZWQpIHdpbmRvdy5cbiAgY29uc3QgbG9jYWwgPSBnZXRMb2NhbEV4aXN0aW5nU2VydmljZUZvckVtYmVkV2luT3JOdWxsKHdpbiwgaWQpO1xuICBpZiAobG9jYWwpIHtcbiAgICByZXR1cm4gbG9jYWw7XG4gIH1cbiAgaWYgKG9wdF9mYWxsYmFja1RvVG9wV2luKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2Uod2luLCBpZCk7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2Ugd2l0aCB0aGUgZ2l2ZW4gaWQuIEFzc3VtZXMgdGhhdCBpdCBoYXMgYmVlbiBjb25zdHJ1Y3RlZFxuICogYWxyZWFkeS5cbiAqXG4gKiBVbmxpa2UgbW9zdCBzZXJ2aWNlIGdldHRlcnMsIHBhc3NpbmcgYE5vZGVgIGlzIG5lY2Vzc2FyeSBmb3Igc29tZSBGSUUtc2NvcGVcbiAqIHNlcnZpY2VzIHNpbmNlIHNvbWV0aW1lcyB3ZSBvbmx5IGhhdmUgdGhlIEZJRSBEb2N1bWVudCBmb3IgY29udGV4dC5cbiAqXG4gKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2ZhbGxiYWNrVG9Ub3BXaW5cbiAqIEByZXR1cm4ge09iamVjdH0gVGhlIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUoXG4gIG5vZGVPckRvYywgaWQsIG9wdF9mYWxsYmFja1RvVG9wV2luKSB7XG4gIC8vIEZpcnN0LCB0cnkgdG8gcmVzb2x2ZSB2aWEgbG9jYWwgKGVtYmVkKSB3aW5kb3cuXG4gIGlmIChub2RlT3JEb2Mubm9kZVR5cGUpIHtcbiAgICAvLyBJZiBhIG5vZGUgaXMgcGFzc2VkLCB0cnkgdG8gcmVzb2x2ZSB2aWEgdGhpcyBub2RlLlxuICAgIGNvbnN0IHdpbiA9IHRvV2luKC8qKiBAdHlwZSB7IURvY3VtZW50fSAqLyAoXG4gICAgICBub2RlT3JEb2Mub3duZXJEb2N1bWVudCB8fCBub2RlT3JEb2MpLmRlZmF1bHRWaWV3KTtcbiAgICBjb25zdCBsb2NhbCA9IGdldExvY2FsRXhpc3RpbmdTZXJ2aWNlRm9yRW1iZWRXaW5Pck51bGwod2luLCBpZCk7XG4gICAgaWYgKGxvY2FsKSB7XG4gICAgICByZXR1cm4gbG9jYWw7XG4gICAgfVxuICB9XG4gIC8vIElmIGFuIGFtcGRvYyBpcyBwYXNzZWQgb3IgZmFsbGJhY2sgaXMgYWxsb3dlZCwgY29udGludWUgcmVzb2x2aW5nLlxuICBpZiAoIW5vZGVPckRvYy5ub2RlVHlwZSB8fCBvcHRfZmFsbGJhY2tUb1RvcFdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZChub2RlT3JEb2MsIGlkKTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBJbnN0YWxscyBhIHNlcnZpY2Ugb3ZlcnJpZGUgb24gYW1wLWRvYyBsZXZlbC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gZW1iZWRXaW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHshT2JqZWN0fSBzZXJ2aWNlIFRoZSBzZXJ2aWNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbFNlcnZpY2VJbkVtYmVkU2NvcGUoZW1iZWRXaW4sIGlkLCBzZXJ2aWNlKSB7XG4gIGNvbnN0IHRvcFdpbiA9IGdldFRvcFdpbmRvdyhlbWJlZFdpbik7XG4gIGRldigpLmFzc2VydChlbWJlZFdpbiAhPSB0b3BXaW4sXG4gICAgICAnU2VydmljZSBvdmVycmlkZSBjYW4gb25seSBiZSBpbnN0YWxsZWQgaW4gZW1iZWQgd2luZG93OiAlcycsIGlkKTtcbiAgZGV2KCkuYXNzZXJ0KCFnZXRMb2NhbEV4aXN0aW5nU2VydmljZUZvckVtYmVkV2luT3JOdWxsKGVtYmVkV2luLCBpZCksXG4gICAgICAnU2VydmljZSBvdmVycmlkZSBoYXMgYWxyZWFkeSBiZWVuIGluc3RhbGxlZDogJXMnLCBpZCk7XG4gIHJlZ2lzdGVyU2VydmljZUludGVybmFsKGVtYmVkV2luLCBlbWJlZFdpbiwgaWQsICgpID0+IHNlcnZpY2UpO1xuICBnZXRTZXJ2aWNlSW50ZXJuYWwoZW1iZWRXaW4sIGlkKTsgLy8gRm9yY2Ugc2VydmljZSB0byBidWlsZC5cbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IGVtYmVkV2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4gez9PYmplY3R9XG4gKi9cbmZ1bmN0aW9uIGdldExvY2FsRXhpc3RpbmdTZXJ2aWNlRm9yRW1iZWRXaW5Pck51bGwoZW1iZWRXaW4sIGlkKSB7XG4gIC8vIE5vdGUgdGhhdCB0aGlzIG1ldGhvZCBjdXJyZW50bHkgb25seSByZXNvbHZlcyBhZ2FpbnN0IHRoZSBnaXZlbiB3aW5kb3cuXG4gIC8vIEl0IGRvZXMgbm90IHRyeSB0byBnbyBhbGwgdGhlIHdheSB1cCB0aGUgcGFyZW50IHdpbmRvdyBjaGFpbi4gV2UgY2FuIGNoYW5nZVxuICAvLyB0aGlzIGluIHRoZSBmdXR1cmUsIGJ1dCBmb3Igbm93IHRoaXMgZ2l2ZXMgdXMgYSBiZXR0ZXIgcGVyZm9ybWFuY2UuXG4gIGNvbnN0IHRvcFdpbiA9IGdldFRvcFdpbmRvdyhlbWJlZFdpbik7XG4gIGlmIChlbWJlZFdpbiAhPSB0b3BXaW4gJiYgaXNTZXJ2aWNlUmVnaXN0ZXJlZChlbWJlZFdpbiwgaWQpKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2VJbnRlcm5hbChlbWJlZFdpbiwgaWQpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogUmVnaXN0ZXJzIGEgc2VydmljZSBnaXZlbiBhIGNsYXNzIHRvIGJlIHVzZWQgYXMgaW1wbGVtZW50YXRpb24uXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtmdW5jdGlvbihuZXc6T2JqZWN0LCAhV2luZG93KX0gY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pbnN0YW50aWF0ZSBXaGV0aGVyIHRvIGltbWVkaWF0ZWx5IGNyZWF0ZSB0aGUgc2VydmljZVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJTZXJ2aWNlQnVpbGRlcih3aW4sXG4gIGlkLFxuICBjb25zdHJ1Y3RvcixcbiAgb3B0X2luc3RhbnRpYXRlKSB7XG4gIHdpbiA9IGdldFRvcFdpbmRvdyh3aW4pO1xuICByZWdpc3RlclNlcnZpY2VJbnRlcm5hbCh3aW4sIHdpbiwgaWQsIGNvbnN0cnVjdG9yKTtcbiAgaWYgKG9wdF9pbnN0YW50aWF0ZSkge1xuICAgIGdldFNlcnZpY2VJbnRlcm5hbCh3aW4sIGlkKTtcbiAgfVxufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2UgYW5kIHJlZ2lzdGVycyBpdCBnaXZlbiBhIGNsYXNzIHRvIGJlIHVzZWQgYXNcbiAqIGltcGxlbWVudGF0aW9uLlxuICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKG5ldzpPYmplY3QsICEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jKX0gY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pbnN0YW50aWF0ZSBXaGV0aGVyIHRvIGltbWVkaWF0ZWx5IGNyZWF0ZSB0aGUgc2VydmljZVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJTZXJ2aWNlQnVpbGRlckZvckRvYyhub2RlT3JEb2MsXG4gIGlkLFxuICBjb25zdHJ1Y3RvcixcbiAgb3B0X2luc3RhbnRpYXRlKSB7XG4gIGNvbnN0IGFtcGRvYyA9IGdldEFtcGRvYyhub2RlT3JEb2MpO1xuICBjb25zdCBob2xkZXIgPSBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGFtcGRvYyk7XG4gIHJlZ2lzdGVyU2VydmljZUludGVybmFsKGhvbGRlciwgYW1wZG9jLCBpZCwgY29uc3RydWN0b3IpO1xuICBpZiAob3B0X2luc3RhbnRpYXRlKSB7XG4gICAgZ2V0U2VydmljZUludGVybmFsKGhvbGRlciwgaWQpO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VydmljZSBmb3IgdGhlIGdpdmVuIGlkIGFuZCB3aW5kb3cgKGEgcGVyLXdpbmRvdyBzaW5nbGV0b24pLiBVc2Vyc1xuICogc2hvdWxkIHR5cGljYWxseSB3cmFwIHRoaXMgYXMgYSBzcGVjaWFsIHB1cnBvc2UgZnVuY3Rpb24gKGUuZy5cbiAqIGBTZXJ2aWNlcy52c3luY0Zvcih3aW4pYCkgZm9yIHR5cGUgc2FmZXR5IGFuZCBiZWNhdXNlIHRoZSBmYWN0b3J5IHNob3VsZCBub3RcbiAqIGJlIHBhc3NlZCBhcm91bmQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHRlbXBsYXRlIFRcbiAqIEByZXR1cm4ge1R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlKHdpbiwgaWQpIHtcbiAgd2luID0gZ2V0VG9wV2luZG93KHdpbik7XG4gIHJldHVybiBnZXRTZXJ2aWNlSW50ZXJuYWwod2luLCBpZCk7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIHdpbmRvdy4gQWxzbyBleHBlY3RzIGFuXG4gKiBlbGVtZW50IHRoYXQgaGFzIHRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24uIFRoZSBwcm9taXNlIHJlc29sdmVzIHdoZW4gdGhlXG4gKiBpbXBsZW1lbnRhdGlvbiBsb2FkZWQuIFVzZXJzIHNob3VsZCB0eXBpY2FsbHkgd3JhcCB0aGlzIGFzIGEgc3BlY2lhbCBwdXJwb3NlXG4gKiBmdW5jdGlvbiAoZS5nLiBgU2VydmljZXMudnN5bmNGb3Iod2luKWApIGZvciB0eXBlIHNhZmV0eSBhbmQgYmVjYXVzZSB0aGVcbiAqIGZhY3Rvcnkgc2hvdWxkIG5vdCBiZSBwYXNzZWQgYXJvdW5kLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEByZXR1cm4geyFQcm9taXNlPCFPYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2Uod2luLCBpZCkge1xuICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VJbnRlcm5hbCh3aW4sIGlkKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBzZXJ2aWNlIG9yIG51bGwgd2l0aCB0aGUgZ2l2ZW4gaWQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJuIHs/T2JqZWN0fSBUaGUgc2VydmljZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4aXN0aW5nU2VydmljZU9yTnVsbCh3aW4sIGlkKSB7XG4gIHdpbiA9IGdldFRvcFdpbmRvdyh3aW4pO1xuICBpZiAoaXNTZXJ2aWNlUmVnaXN0ZXJlZCh3aW4sIGlkKSkge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlSW50ZXJuYWwod2luLCBpZCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuXG4vKipcbiAqIExpa2UgZ2V0U2VydmljZVByb21pc2UgYnV0IHJldHVybnMgbnVsbCBpZiB0aGUgc2VydmljZSB3YXMgbmV2ZXIgcmVnaXN0ZXJlZC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4gez9Qcm9taXNlPCFPYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2VPck51bGwod2luLCBpZCkge1xuICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VPck51bGxJbnRlcm5hbCh3aW4sIGlkKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIGFtcGRvYyAoYSBwZXItYW1wZG9jIHNpbmdsZXRvbikuXG4gKiBFeHBlY3RzIHNlcnZpY2UgYGlkYCB0byBiZSByZWdpc3RlcmVkLlxuICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4ge1R9XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGlkKSB7XG4gIGNvbnN0IGFtcGRvYyA9IGdldEFtcGRvYyhlbGVtZW50T3JBbXBEb2MpO1xuICBjb25zdCBob2xkZXIgPSBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGFtcGRvYyk7XG4gIHJldHVybiBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCk7XG59XG5cblxuLyoqXG4gKiB0bDtkciAtLSBVc2UgZ2V0U2VydmljZUZvckRvYygpIGluc3RlYWQgb2YgdGhpcy5cbiAqXG4gKiBQcml2aWxlZ2VkIHZhcmlhbnQgb2YgZ2V0U2VydmljZUZvckRvYygpIHRoYXQgYWNjZXB0cyBub24tZWxlbWVudCBwYXJhbXMsXG4gKiBlLmcuIHdpbmRvdy5kb2N1bWVudC4gVGhpcyBpcyBjdXJyZW50bHkgbmVjZXNzYXJ5IGZvciBkb2MtbGV2ZWwgc2VydmljZXNcbiAqIHVzZWQgaW4gc3RhcnR1cCwgZS5nLiBDaHVua3MuIEV2ZW50dWFsbHkgd2Ugd2FudCB0byByZW1vdmUgdGhpcyBmdW5jdGlvblxuICogYW5kIGhhdmUgY2FsbGVycyBmaW5kIHRoZSBhcHByb3ByaWF0ZSBBbXBEb2MgYW5kIHVzZSBnZXRTZXJ2aWNlRm9yRG9jKCkuXG4gKlxuICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4ge1R9XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQobm9kZU9yRG9jLCBpZCkge1xuICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2Mobm9kZU9yRG9jKTtcbiAgY29uc3QgaG9sZGVyID0gZ2V0QW1wZG9jU2VydmljZUhvbGRlcihhbXBkb2MpO1xuICByZXR1cm4gZ2V0U2VydmljZUludGVybmFsKGhvbGRlciwgaWQpO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgZm9yIGEgc2VydmljZSBmb3IgdGhlIGdpdmVuIGlkIGFuZCBhbXBkb2MuIEFsc28gZXhwZWN0c1xuICogYSBzZXJ2aWNlIHRoYXQgaGFzIHRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24uIFRoZSBwcm9taXNlIHJlc29sdmVzIHdoZW5cbiAqIHRoZSBpbXBsZW1lbnRhdGlvbiBsb2FkZWQuXG4gKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybiB7IVByb21pc2U8IU9iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGlkKSB7XG4gIHJldHVybiBnZXRTZXJ2aWNlUHJvbWlzZUludGVybmFsKFxuICAgICAgZ2V0QW1wZG9jU2VydmljZUhvbGRlcihlbGVtZW50T3JBbXBEb2MpLCBpZCk7XG59XG5cblxuLyoqXG4gKiBMaWtlIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jIGJ1dCByZXR1cm5zIG51bGwgaWYgdGhlIHNlcnZpY2Ugd2FzIG5ldmVyXG4gKiByZWdpc3RlcmVkIGZvciB0aGlzIGFtcGRvYy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJuIHs/UHJvbWlzZTwhT2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpIHtcbiAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsSW50ZXJuYWwoXG4gICAgICBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGVsZW1lbnRPckFtcERvYyksIGlkKTtcbn1cblxuLyoqXG4gKiBTZXQgdGhlIHBhcmVudCBhbmQgdG9wIHdpbmRvd3Mgb24gYSBjaGlsZCB3aW5kb3cgKGZyaWVuZGx5IGlmcmFtZSkuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshV2luZG93fSBwYXJlbnRXaW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFBhcmVudFdpbmRvdyh3aW4sIHBhcmVudFdpbikge1xuICB3aW4uX19BTVBfUEFSRU5UID0gcGFyZW50V2luO1xuICB3aW4uX19BTVBfVE9QID0gZ2V0VG9wV2luZG93KHBhcmVudFdpbik7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwYXJlbnQgd2luZG93IGZvciBhIGNoaWxkIHdpbmRvdyAoZnJpZW5kbHkgaWZyYW1lKS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshV2luZG93fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGFyZW50V2luZG93KHdpbikge1xuICByZXR1cm4gd2luLl9fQU1QX1BBUkVOVCB8fCB3aW47XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB0b3Agd2luZG93IHdoZXJlIEFNUCBSdW50aW1lIGlzIGluc3RhbGxlZCBmb3IgYSBjaGlsZCB3aW5kb3dcbiAqIChmcmllbmRseSBpZnJhbWUpLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFXaW5kb3d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUb3BXaW5kb3cod2luKSB7XG4gIHJldHVybiB3aW4uX19BTVBfVE9QIHx8IHdpbjtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIHBhcmVudCBcImZyaWVuZGx5XCIgaWZyYW1lIGlmIHRoZSBub2RlIGJlbG9uZ3MgdG8gYSBjaGlsZCB3aW5kb3cuXG4gKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gKiBAcGFyYW0geyFXaW5kb3d9IHRvcFdpblxuICogQHJldHVybiB7P0hUTUxJRnJhbWVFbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGFyZW50V2luZG93RnJhbWVFbGVtZW50KG5vZGUsIHRvcFdpbikge1xuICBjb25zdCBjaGlsZFdpbiA9IChub2RlLm93bmVyRG9jdW1lbnQgfHwgbm9kZSkuZGVmYXVsdFZpZXc7XG4gIGlmIChjaGlsZFdpbiAmJiBjaGlsZFdpbiAhPSB0b3BXaW4gJiYgZ2V0VG9wV2luZG93KGNoaWxkV2luKSA9PSB0b3BXaW4pIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIC8qKiBAdHlwZSB7P0hUTUxJRnJhbWVFbGVtZW50fSAqLyAoY2hpbGRXaW4uZnJhbWVFbGVtZW50KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAvLyBJZ25vcmUgdGhlIGVycm9yLlxuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICogQHJldHVybiB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBbXBkb2Mobm9kZU9yRG9jKSB7XG4gIGlmIChub2RlT3JEb2Mubm9kZVR5cGUpIHtcbiAgICBjb25zdCB3aW4gPSB0b1dpbigvKiogQHR5cGUgeyFEb2N1bWVudH0gKi8gKFxuICAgICAgbm9kZU9yRG9jLm93bmVyRG9jdW1lbnQgfHwgbm9kZU9yRG9jKS5kZWZhdWx0Vmlldyk7XG4gICAgcmV0dXJuIGdldEFtcGRvY1NlcnZpY2Uod2luKS5nZXRBbXBEb2MoLyoqIEB0eXBlIHshTm9kZX0gKi8gKG5vZGVPckRvYykpO1xuICB9XG4gIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSAqLyAobm9kZU9yRG9jKTtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICogQHJldHVybiB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N8IVdpbmRvd31cbiAqL1xuZnVuY3Rpb24gZ2V0QW1wZG9jU2VydmljZUhvbGRlcihub2RlT3JEb2MpIHtcbiAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKG5vZGVPckRvYyk7XG4gIHJldHVybiBhbXBkb2MuaXNTaW5nbGVEb2MoKSA/IGFtcGRvYy53aW4gOiBhbXBkb2M7XG59XG5cblxuLyoqXG4gKiBUaGlzIGlzIGVzc2VudGlhbGx5IGEgZHVwbGljYXRlIG9mIGBhbXBkb2MuanNgLCBidXQgbmVjZXNzYXJ5IHRvIGF2b2lkXG4gKiBjaXJjdWxhciBkZXBlbmRlbmNpZXMuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2NTZXJ2aWNlfVxuICovXG5mdW5jdGlvbiBnZXRBbXBkb2NTZXJ2aWNlKHdpbikge1xuICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY1NlcnZpY2V9ICovIChcbiAgICBnZXRTZXJ2aWNlKHdpbiwgJ2FtcGRvYycpKTtcbn1cblxuXG4vKipcbiAqIEdldCBzZXJ2aWNlIGBpZGAgZnJvbSBgaG9sZGVyYC4gQXNzdW1lcyB0aGUgc2VydmljZVxuICogaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkLlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXIgT2JqZWN0IGhvbGRpbmcgdGhlIHNlcnZpY2UgaW5zdGFuY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHtPYmplY3R9XG4gKiBAdGVtcGxhdGUgVFxuICovXG5mdW5jdGlvbiBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCkge1xuICBkZXYoKS5hc3NlcnQoaXNTZXJ2aWNlUmVnaXN0ZXJlZChob2xkZXIsIGlkKSxcbiAgICAgIGBFeHBlY3RlZCBzZXJ2aWNlICR7aWR9IHRvIGJlIHJlZ2lzdGVyZWRgKTtcbiAgY29uc3Qgc2VydmljZXMgPSBnZXRTZXJ2aWNlcyhob2xkZXIpO1xuICBjb25zdCBzID0gc2VydmljZXNbaWRdO1xuICBpZiAoIXMub2JqKSB7XG4gICAgZGV2KCkuYXNzZXJ0KHMuY3RvciwgYFNlcnZpY2UgJHtpZH0gcmVnaXN0ZXJlZCB3aXRob3V0IGN0b3Igbm9yIGltcGwuYCk7XG4gICAgZGV2KCkuYXNzZXJ0KHMuY29udGV4dCwgYFNlcnZpY2UgJHtpZH0gcmVnaXN0ZXJlZCB3aXRob3V0IGNvbnRleHQuYCk7XG4gICAgcy5vYmogPSBuZXcgcy5jdG9yKHMuY29udGV4dCk7XG4gICAgZGV2KCkuYXNzZXJ0KHMub2JqLCBgU2VydmljZSAke2lkfSBjb25zdHJ1Y3RlZCB0byBudWxsLmApO1xuICAgIHMuY3RvciA9IG51bGw7XG4gICAgcy5jb250ZXh0ID0gbnVsbDtcbiAgICAvLyBUaGUgc2VydmljZSBtYXkgaGF2ZSBiZWVuIHJlcXVlc3RlZCBhbHJlYWR5LCBpbiB3aGljaCBjYXNlIHdlIGhhdmUgYVxuICAgIC8vIHBlbmRpbmcgcHJvbWlzZSB3ZSBuZWVkIHRvIGZ1bGZpbGwuXG4gICAgaWYgKHMucmVzb2x2ZSkge1xuICAgICAgcy5yZXNvbHZlKHMub2JqKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHMub2JqO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyIE9iamVjdCBob2xkaW5nIHRoZSBzZXJ2aWNlIGluc3RhbmNlLlxuICogQHBhcmFtIHshV2luZG93fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBjb250ZXh0IFdpbiBvciBBbXBEb2MuXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0gez9mdW5jdGlvbihuZXc6T2JqZWN0LCAhV2luZG93KXw/ZnVuY3Rpb24obmV3Ok9iamVjdCwgIS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2MpfSBjdG9yIENvbnN0cnVjdG9yIGZ1bmN0aW9uIHRvIG5ldyB0aGUgc2VydmljZS4gQ2FsbGVkIHdpdGggY29udGV4dC5cbiAqL1xuZnVuY3Rpb24gcmVnaXN0ZXJTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBjb250ZXh0LCBpZCwgY3Rvcikge1xuICBjb25zdCBzZXJ2aWNlcyA9IGdldFNlcnZpY2VzKGhvbGRlcik7XG4gIGxldCBzID0gc2VydmljZXNbaWRdO1xuXG4gIGlmICghcykge1xuICAgIHMgPSBzZXJ2aWNlc1tpZF0gPSB7XG4gICAgICBvYmo6IG51bGwsXG4gICAgICBwcm9taXNlOiBudWxsLFxuICAgICAgcmVzb2x2ZTogbnVsbCxcbiAgICAgIGNvbnRleHQ6IG51bGwsXG4gICAgICBjdG9yOiBudWxsLFxuICAgIH07XG4gIH1cblxuICBpZiAocy5jdG9yIHx8IHMub2JqKSB7XG4gICAgLy8gU2VydmljZSBhbHJlYWR5IHJlZ2lzdGVyZWQuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcy5jdG9yID0gY3RvcjtcbiAgcy5jb250ZXh0ID0gY29udGV4dDtcblxuICAvLyBUaGUgc2VydmljZSBtYXkgaGF2ZSBiZWVuIHJlcXVlc3RlZCBhbHJlYWR5LCBpbiB3aGljaCBjYXNlIHRoZXJlIGlzIGFcbiAgLy8gcGVuZGluZyBwcm9taXNlIHRoYXQgbmVlZHMgdG8gZnVsZmlsbGVkLlxuICBpZiAocy5yZXNvbHZlKSB7XG4gICAgLy8gZ2V0U2VydmljZUludGVybmFsIHdpbGwgcmVzb2x2ZSB0aGUgcHJvbWlzZS5cbiAgICBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCk7XG4gIH1cbn1cblxuLyoqXG4gKiBAcGFyYW0geyFPYmplY3R9IGhvbGRlclxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHJldHVybiB7IVByb21pc2U8IU9iamVjdD59XG4gKi9cbmZ1bmN0aW9uIGdldFNlcnZpY2VQcm9taXNlSW50ZXJuYWwoaG9sZGVyLCBpZCkge1xuICBjb25zdCBjYWNoZWQgPSBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEludGVybmFsKGhvbGRlciwgaWQpO1xuICBpZiAoY2FjaGVkKSB7XG4gICAgcmV0dXJuIGNhY2hlZDtcbiAgfVxuICAvLyBTZXJ2aWNlIGlzIG5vdCByZWdpc3RlcmVkLlxuXG4gIC8vIFRPRE8oQGNyYW1mb3JjZSk6IEFkZCBhIGNoZWNrIHRoYXQgaWYgdGhlIGVsZW1lbnQgaXMgZXZlbnR1YWxseSByZWdpc3RlcmVkXG4gIC8vIHRoYXQgdGhlIHNlcnZpY2UgaXMgYWN0dWFsbHkgcHJvdmlkZWQgYW5kIHRoaXMgcHJvbWlzZSByZXNvbHZlcy5cbiAgY29uc3QgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcbiAgY29uc3Qge3Byb21pc2UsIHJlc29sdmV9ID0gZGVmZXJyZWQ7XG5cbiAgY29uc3Qgc2VydmljZXMgPSBnZXRTZXJ2aWNlcyhob2xkZXIpO1xuICBzZXJ2aWNlc1tpZF0gPSB7XG4gICAgb2JqOiBudWxsLFxuICAgIHByb21pc2UsXG4gICAgcmVzb2x2ZSxcbiAgICBjb250ZXh0OiBudWxsLFxuICAgIGN0b3I6IG51bGwsXG4gIH07XG4gIHJldHVybiBwcm9taXNlO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgZm9yIHNlcnZpY2UgYGlkYCBpZiB0aGUgc2VydmljZSBoYXMgYmVlbiByZWdpc3RlcmVkXG4gKiBvbiBgaG9sZGVyYC5cbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHs/UHJvbWlzZTwhT2JqZWN0Pn1cbiAqL1xuZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2VPck51bGxJbnRlcm5hbChob2xkZXIsIGlkKSB7XG4gIGNvbnN0IHNlcnZpY2VzID0gZ2V0U2VydmljZXMoaG9sZGVyKTtcbiAgY29uc3QgcyA9IHNlcnZpY2VzW2lkXTtcbiAgaWYgKHMpIHtcbiAgICBpZiAocy5wcm9taXNlKSB7XG4gICAgICByZXR1cm4gcy5wcm9taXNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBJbnN0YW50aWF0ZSBzZXJ2aWNlIGlmIG5vdCBhbHJlYWR5IGluc3RhbnRpYXRlZC5cbiAgICAgIGdldFNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGlkKTtcbiAgICAgIHJldHVybiBzLnByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoLyoqIEB0eXBlIHshT2JqZWN0fSAqLyAocy5vYmopKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBvYmplY3QgdGhhdCBob2xkcyB0aGUgc2VydmljZXMgcmVnaXN0ZXJlZCBpbiBhIGhvbGRlci5cbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywhU2VydmljZUhvbGRlckRlZj59XG4gKi9cbmZ1bmN0aW9uIGdldFNlcnZpY2VzKGhvbGRlcikge1xuICBsZXQge3NlcnZpY2VzfSA9IGhvbGRlcjtcbiAgaWYgKCFzZXJ2aWNlcykge1xuICAgIHNlcnZpY2VzID0gaG9sZGVyLnNlcnZpY2VzID0ge307XG4gIH1cbiAgcmV0dXJuIHNlcnZpY2VzO1xufVxuXG5cbi8qKlxuICogV2hldGhlciB0aGUgc3BlY2lmaWVkIHNlcnZpY2UgaW1wbGVtZW50cyBgRGlzcG9zYWJsZWAgaW50ZXJmYWNlLlxuICogQHBhcmFtIHshT2JqZWN0fSBzZXJ2aWNlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNEaXNwb3NhYmxlKHNlcnZpY2UpIHtcbiAgcmV0dXJuIHR5cGVvZiBzZXJ2aWNlLmRpc3Bvc2UgPT0gJ2Z1bmN0aW9uJztcbn1cblxuXG4vKipcbiAqIEFzc2VydHMgdGhhdCB0aGUgc3BlY2lmaWVkIHNlcnZpY2UgaW1wbGVtZW50cyBgRGlzcG9zYWJsZWAgaW50ZXJmYWNlIGFuZFxuICogdHlwZWNhc3RzIHRoZSBpbnN0YW5jZSB0byBgRGlzcG9zYWJsZWAuXG4gKiBAcGFyYW0geyFPYmplY3R9IHNlcnZpY2VcbiAqIEByZXR1cm4geyFEaXNwb3NhYmxlfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RGlzcG9zYWJsZShzZXJ2aWNlKSB7XG4gIGRldigpLmFzc2VydChpc0Rpc3Bvc2FibGUoc2VydmljZSksICdyZXF1aXJlZCB0byBpbXBsZW1lbnQgRGlzcG9zYWJsZScpO1xuICByZXR1cm4gLyoqIEB0eXBlIHshRGlzcG9zYWJsZX0gKi8gKHNlcnZpY2UpO1xufVxuXG5cbi8qKlxuICogRGlzcG9zZXMgYWxsIGRpc3Bvc2FibGUgKGltcGxlbWVudHMgYERpc3Bvc2FibGVgIGludGVyZmFjZSkgc2VydmljZXMgaW5cbiAqIGFtcGRvYyBzY29wZS5cbiAqIEBwYXJhbSB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICovXG5leHBvcnQgZnVuY3Rpb24gZGlzcG9zZVNlcnZpY2VzRm9yRG9jKGFtcGRvYykge1xuICBkaXNwb3NlU2VydmljZXNJbnRlcm5hbChhbXBkb2MpO1xufVxuXG5cbi8qKlxuICogRGlzcG9zZXMgYWxsIGRpc3Bvc2FibGUgKGltcGxlbWVudHMgYERpc3Bvc2FibGVgIGludGVyZmFjZSkgc2VydmljZXMgaW5cbiAqIGVtYmVkIHNjb3BlLlxuICogQHBhcmFtIHshV2luZG93fSBlbWJlZFdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gZGlzcG9zZVNlcnZpY2VzRm9yRW1iZWQoZW1iZWRXaW4pIHtcbiAgZGlzcG9zZVNlcnZpY2VzSW50ZXJuYWwoZW1iZWRXaW4pO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXIgT2JqZWN0IGhvbGRpbmcgdGhlIHNlcnZpY2UgaW5zdGFuY2VzLlxuICovXG5mdW5jdGlvbiBkaXNwb3NlU2VydmljZXNJbnRlcm5hbChob2xkZXIpIHtcbiAgLy8gVE9ETyhkdm95dGVua28pOiBDb25zaWRlciBtYXJraW5nIGhvbGRlciBhcyBkZXN0cm95ZWQgZm9yIGxhdGVyLWFycml2aW5nXG4gIC8vIHNlcnZpY2UgdG8gYmUgY2FuY2VsZWQgYXV0b21hdGljYWxseS5cbiAgY29uc3Qgc2VydmljZXMgPSBnZXRTZXJ2aWNlcyhob2xkZXIpO1xuICBmb3IgKGNvbnN0IGlkIGluIHNlcnZpY2VzKSB7XG4gICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc2VydmljZXMsIGlkKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGNvbnN0IHNlcnZpY2VIb2xkZXIgPSBzZXJ2aWNlc1tpZF07XG4gICAgaWYgKHNlcnZpY2VIb2xkZXIub2JqKSB7XG4gICAgICBkaXNwb3NlU2VydmljZUludGVybmFsKGlkLCBzZXJ2aWNlSG9sZGVyLm9iaik7XG4gICAgfSBlbHNlIGlmIChzZXJ2aWNlSG9sZGVyLnByb21pc2UpIHtcbiAgICAgIHNlcnZpY2VIb2xkZXIucHJvbWlzZS50aGVuKFxuICAgICAgICAgIGluc3RhbmNlID0+IGRpc3Bvc2VTZXJ2aWNlSW50ZXJuYWwoaWQsIGluc3RhbmNlKSk7XG4gICAgfVxuICB9XG59XG5cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEBwYXJhbSB7IU9iamVjdH0gc2VydmljZVxuICovXG5mdW5jdGlvbiBkaXNwb3NlU2VydmljZUludGVybmFsKGlkLCBzZXJ2aWNlKSB7XG4gIGlmICghaXNEaXNwb3NhYmxlKHNlcnZpY2UpKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHRyeSB7XG4gICAgYXNzZXJ0RGlzcG9zYWJsZShzZXJ2aWNlKS5kaXNwb3NlKCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBFbnN1cmUgdGhhdCBhIGZhaWx1cmUgdG8gZGlzcG9zZSBhIHNlcnZpY2UgZG9lcyBub3QgZGlzcnVwdCBvdGhlclxuICAgIC8vIHNlcnZpY2VzLlxuICAgIGRldigpLmVycm9yKCdTRVJWSUNFJywgJ2ZhaWxlZCB0byBkaXNwb3NlIHNlcnZpY2UnLCBpZCwgZSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHNwZWNpZmllZCBzZXJ2aWNlIGltcGxlbWVudHMgYEVtYmVkZGFibGVTZXJ2aWNlYCBpbnRlcmZhY2UuXG4gKiBAcGFyYW0geyFPYmplY3R9IHNlcnZpY2VcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0VtYmVkZGFibGUoc2VydmljZSkge1xuICByZXR1cm4gdHlwZW9mIHNlcnZpY2UuYWRvcHRFbWJlZFdpbmRvdyA9PSAnZnVuY3Rpb24nO1xufVxuXG5cbi8qKlxuICogQWRvcHRzIGFuIGVtYmVkZGFibGUgKGltcGxlbWVudHMgYEVtYmVkZGFibGVTZXJ2aWNlYCBpbnRlcmZhY2UpIHNlcnZpY2VcbiAqIGluIGVtYmVkIHNjb3BlLlxuICogQHBhcmFtIHshV2luZG93fSBlbWJlZFdpblxuICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VJZFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRvcHRTZXJ2aWNlRm9yRW1iZWQoZW1iZWRXaW4sIHNlcnZpY2VJZCkge1xuICBjb25zdCBhZG9wdGVkID0gYWRvcHRTZXJ2aWNlRm9yRW1iZWRJZkVtYmVkZGFibGUoZW1iZWRXaW4sIHNlcnZpY2VJZCk7XG4gIGRldigpLmFzc2VydChhZG9wdGVkLCBgU2VydmljZSAke3NlcnZpY2VJZH0gbm90IGZvdW5kIG9uIHBhcmVudCBgICtcbiAgICAgICdvciBkb2VzblxcJ3QgaW1wbGVtZW50IEVtYmVkZGFibGVTZXJ2aWNlLicpO1xufVxuXG5cbi8qKlxuICogQWRvcHRzIGFuIGVtYmVkZGFibGUgKGltcGxlbWVudHMgYEVtYmVkZGFibGVTZXJ2aWNlYCBpbnRlcmZhY2UpIHNlcnZpY2VcbiAqIGluIGVtYmVkIHNjb3BlLlxuICogQHBhcmFtIHshV2luZG93fSBlbWJlZFdpblxuICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VJZFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkb3B0U2VydmljZUZvckVtYmVkSWZFbWJlZGRhYmxlKGVtYmVkV2luLCBzZXJ2aWNlSWQpIHtcbiAgY29uc3QgZnJhbWVFbGVtZW50ID0gLyoqIEB0eXBlIHshTm9kZX0gKi8gKGRldigpLmFzc2VydChcbiAgICAgIGVtYmVkV2luLmZyYW1lRWxlbWVudCxcbiAgICAgICdmcmFtZUVsZW1lbnQgbm90IGZvdW5kIGZvciBlbWJlZCcpKTtcbiAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKGZyYW1lRWxlbWVudCk7XG4gIGNvbnN0IGhvbGRlciA9IGdldEFtcGRvY1NlcnZpY2VIb2xkZXIoYW1wZG9jKTtcbiAgaWYgKCFpc1NlcnZpY2VSZWdpc3RlcmVkKGhvbGRlciwgc2VydmljZUlkKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBjb25zdCBzZXJ2aWNlID0gZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQoZnJhbWVFbGVtZW50LCBzZXJ2aWNlSWQpO1xuICBpZiAoIWlzRW1iZWRkYWJsZShzZXJ2aWNlKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBzZXJ2aWNlLmFkb3B0RW1iZWRXaW5kb3coZW1iZWRXaW4pO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuXG4vKipcbiAqIFJlc2V0cyBhIHNpbmdsZSBzZXJ2aWNlLCBzbyBpdCBnZXRzIHJlY3JlYXRlZCBvbiBuZXh0IGdldFNlcnZpY2UgaW52b2NhdGlvbi5cbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldFNlcnZpY2VGb3JUZXN0aW5nKGhvbGRlciwgaWQpIHtcbiAgaWYgKGhvbGRlci5zZXJ2aWNlcykge1xuICAgIGhvbGRlci5zZXJ2aWNlc1tpZF0gPSBudWxsO1xuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXIgT2JqZWN0IGhvbGRpbmcgdGhlIHNlcnZpY2UgaW5zdGFuY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc1NlcnZpY2VSZWdpc3RlcmVkKGhvbGRlciwgaWQpIHtcbiAgY29uc3Qgc2VydmljZSA9IGhvbGRlci5zZXJ2aWNlcyAmJiBob2xkZXIuc2VydmljZXNbaWRdO1xuICAvLyBBbGwgcmVnaXN0ZXJlZCBzZXJ2aWNlcyBtdXN0IGhhdmUgYW4gaW1wbGVtZW50YXRpb24gb3IgYSBjb25zdHJ1Y3Rvci5cbiAgcmV0dXJuICEhKHNlcnZpY2UgJiYgKHNlcnZpY2UuY3RvciB8fCBzZXJ2aWNlLm9iaikpO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIGdldEFtcGRvYyxcbiAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlLFxuICBnZXRFeGlzdGluZ1NlcnZpY2VPck51bGwsXG4gIGdldFNlcnZpY2UsXG4gIGdldFNlcnZpY2VGb3JEb2MsXG4gIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkLFxuICBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyxcbn0gZnJvbSAnLi9zZXJ2aWNlJztcbmltcG9ydCB7XG4gIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jLFxuICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlLFxuICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jLFxuICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jSW5FbWJlZFNjb3BlLFxufSBmcm9tICcuL2VsZW1lbnQtc2VydmljZSc7XG5cbi8qKiBAdHlwZWRlZiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN1YnNjcmlwdGlvbnMvMC4xL2FtcC1zdWJzY3JpcHRpb25zLlN1YnNjcmlwdGlvblNlcnZpY2V9ICovXG5leHBvcnQgbGV0IFN1YnNjcmlwdGlvblNlcnZpY2U7XG5cbmV4cG9ydCBjbGFzcyBTZXJ2aWNlcyB7XG4gIC8qKlxuICAgKiBIaW50OiBBZGQgZXh0ZW5zaW9ucyBmb2xkZXIgcGF0aCB0byBjb21waWxlLmpzIHdpdGhcbiAgICogd2FybmluZ3MgY2Fubm90IGZpbmQgbW9kdWxlcy5cbiAgICovXG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIGZvciB0aGUgQWNjZXNzIHNlcnZpY2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtYWNjZXNzLzAuMS9hbXAtYWNjZXNzLkFjY2Vzc1NlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFjY2Vzc1NlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hY2Nlc3MvMC4xL2FtcC1hY2Nlc3MuQWNjZXNzU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2FjY2VzcycsICdhbXAtYWNjZXNzJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIEFjY2VzcyBzZXJ2aWNlIG9yIGEgcHJvbWlzZSBmb3IgbnVsbCBpZiB0aGVcbiAgICogc2VydmljZSBpcyBub3QgYXZhaWxhYmxlIG9uIHRoZSBjdXJyZW50IHBhZ2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYWNjZXNzLzAuMS9hbXAtYWNjZXNzLkFjY2Vzc1NlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFjY2Vzc1NlcnZpY2VGb3JEb2NPck51bGwoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1hY2Nlc3MvMC4xL2FtcC1hY2Nlc3MuQWNjZXNzU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnYWNjZXNzJyxcbiAgICAgICAgICAnYW1wLWFjY2VzcycpKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBTdWJzY3JpcHRpb25zIHNlcnZpY2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhU3Vic2NyaXB0aW9uU2VydmljZT59XG4gICAqL1xuICBzdGF0aWMgc3Vic2NyaXB0aW9uc1NlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCFTdWJzY3JpcHRpb25TZXJ2aWNlPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnc3Vic2NyaXB0aW9ucycsXG4gICAgICAgICAgJ2FtcC1zdWJzY3JpcHRpb25zJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIFN1YnNjcmlwdGlvbnMgc2VydmljZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD9TdWJzY3JpcHRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBzdWJzY3JpcHRpb25zU2VydmljZUZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8P1N1YnNjcmlwdGlvblNlcnZpY2U+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ3N1YnNjcmlwdGlvbnMnLFxuICAgICAgICAgICdhbXAtc3Vic2NyaXB0aW9ucycpKSk7XG4gIH1cblxuICAvKipcbiAgICogVW5saWtlIG1vc3Qgc2VydmljZSBnZXR0ZXJzLCBwYXNzaW5nIGBOb2RlYCBpcyBuZWNlc3NhcnkgZm9yIHNvbWUgRklFLXNjb3BlXG4gICAqIHNlcnZpY2VzIHNpbmNlIHNvbWV0aW1lcyB3ZSBvbmx5IGhhdmUgdGhlIEZJRSBEb2N1bWVudCBmb3IgY29udGV4dC5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvYWN0aW9uLWltcGwuQWN0aW9uU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBhY3Rpb25TZXJ2aWNlRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvYWN0aW9uLWltcGwuQWN0aW9uU2VydmljZX0gKi8gKFxuICAgICAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIG5vZGVPckRvYywgJ2FjdGlvbicsIC8qIG9wdF9mYWxsYmFja1RvVG9wV2luICovIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8IUFjdGl2aXR5Pn1cbiAgICovXG4gIHN0YXRpYyBhY3Rpdml0eUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhQWN0aXZpdHk+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdhY3Rpdml0eScsICdhbXAtYW5hbHl0aWNzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGdsb2JhbCBpbnN0YW5jZSBvZiB0aGUgYEFtcERvY1NlcnZpY2VgIHNlcnZpY2UgdGhhdCBjYW4gYmVcbiAgICogdXNlZCB0byByZXNvbHZlIGFuIGFtcGRvYyBmb3IgYW55IG5vZGU6IGVpdGhlciBpbiB0aGUgc2luZ2xlLWRvYyBvclxuICAgKiBzaGFkb3ctZG9jIGVudmlyb25tZW50LlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY1NlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgYW1wZG9jU2VydmljZUZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY1NlcnZpY2V9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAnYW1wZG9jJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIEFtcERvYyBmb3IgdGhlIHNwZWNpZmllZCBjb250ZXh0IG5vZGUuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY31cbiAgICovXG4gIHN0YXRpYyBhbXBkb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIGdldEFtcGRvYyhlbGVtZW50T3JBbXBEb2MpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBsb2FkQW5hbHl0aWNzXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hbmFseXRpY3MvMC4xL2luc3RydW1lbnRhdGlvbi5JbnN0cnVtZW50YXRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBhbmFseXRpY3NGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBsb2FkQW5hbHl0aWNzID0gZmFsc2UpIHtcbiAgICBpZiAobG9hZEFuYWx5dGljcykge1xuICAgICAgLy8gR2V0IEV4dGVuc2lvbnMgc2VydmljZSBhbmQgZm9yY2UgbG9hZCBhbmFseXRpY3MgZXh0ZW5zaW9uLlxuICAgICAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKGVsZW1lbnRPckFtcERvYyk7XG4gICAgICBTZXJ2aWNlcy5leHRlbnNpb25zRm9yKGFtcGRvYy53aW4pLi8qT0sqL2luc3RhbGxFeHRlbnNpb25Gb3JEb2MoXG4gICAgICAgICAgYW1wZG9jLCAnYW1wLWFuYWx5dGljcycpO1xuICAgIH1cbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtYW5hbHl0aWNzLzAuMS9pbnN0cnVtZW50YXRpb24uSW5zdHJ1bWVudGF0aW9uU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2FtcC1hbmFseXRpY3MtaW5zdHJ1bWVudGF0aW9uJyxcbiAgICAgICAgICAnYW1wLWFuYWx5dGljcycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWFuYWx5dGljcy8wLjEvaW5zdHJ1bWVudGF0aW9uLkluc3RydW1lbnRhdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFuYWx5dGljc0ZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYW5hbHl0aWNzLzAuMS9pbnN0cnVtZW50YXRpb24uSW5zdHJ1bWVudGF0aW9uU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLFxuICAgICAgICAgICdhbXAtYW5hbHl0aWNzLWluc3RydW1lbnRhdGlvbicsICdhbXAtYW5hbHl0aWNzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvYmF0Y2hlZC14aHItaW1wbC5CYXRjaGVkWGhyfVxuICAgKi9cbiAgc3RhdGljIGJhdGNoZWRYaHJGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9iYXRjaGVkLXhoci1pbXBsLkJhdGNoZWRYaHJ9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAnYmF0Y2hlZC14aHInKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1iaW5kLzAuMS9iaW5kLWltcGwuQmluZD59XG4gICAqL1xuICBzdGF0aWMgYmluZEZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYmluZC8wLjEvYmluZC1pbXBsLkJpbmQ+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIGVsZW1lbnRPckFtcERvYywgJ2JpbmQnLCAnYW1wLWJpbmQnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuL3NlcnZpY2UvY2lkLWltcGwuQ2lkPn1cbiAgICovXG4gIHN0YXRpYyBjaWRGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8IS4vc2VydmljZS9jaWQtaW1wbC5DaWQ+fSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdjaWQnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvbmF2aWdhdGlvbi5OYXZpZ2F0aW9ufVxuICAgKi9cbiAgc3RhdGljIG5hdmlnYXRpb25Gb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9uYXZpZ2F0aW9uLk5hdmlnYXRpb259ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnbmF2aWdhdGlvbicpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2NyeXB0by1pbXBsLkNyeXB0b31cbiAgICovXG4gIHN0YXRpYyBjcnlwdG9Gb3Iod2luZG93KSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyEuL3NlcnZpY2UvY3J5cHRvLWltcGwuQ3J5cHRvfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ2NyeXB0bycpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvZG9jdW1lbnQtaW5mby1pbXBsLkRvY3VtZW50SW5mb0RlZn0gSW5mbyBhYm91dCB0aGUgZG9jXG4gICAqL1xuICBzdGF0aWMgZG9jdW1lbnRJbmZvRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvZG9jdW1lbnQtaW5mby1pbXBsLkRvY0luZm99ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnZG9jdW1lbnRJbmZvJykpLmdldCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvZG9jdW1lbnQtc3RhdGUuRG9jdW1lbnRTdGF0ZX1cbiAgICovXG4gIHN0YXRpYyBkb2N1bWVudFN0YXRlRm9yKHdpbmRvdykge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbmRvdywgJ2RvY3VtZW50U3RhdGUnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2V4dGVuc2lvbnMtaW1wbC5FeHRlbnNpb25zfVxuICAgKi9cbiAgc3RhdGljIGV4dGVuc2lvbnNGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9leHRlbnNpb25zLWltcGwuRXh0ZW5zaW9uc30gKi8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdleHRlbnNpb25zJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgc2VydmljZSBpbXBsZW1lbnRlZCBpbiBzZXJ2aWNlL2hpc3RvcnktaW1wbC5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvaGlzdG9yeS1pbXBsLkhpc3Rvcnl9XG4gICAqL1xuICBzdGF0aWMgaGlzdG9yeUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2hpc3RvcnktaW1wbC5IaXN0b3J5fSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2hpc3RvcnknKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4vaW5wdXQuSW5wdXR9XG4gICAqL1xuICBzdGF0aWMgaW5wdXRGb3Iod2luKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2Uod2luLCAnaW5wdXQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9sYXllcnMtaW1wbC5MYXlvdXRMYXllcnN9XG4gICAqL1xuICBzdGF0aWMgbGF5ZXJzRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvbGF5ZXJzLWltcGwuTGF5b3V0TGF5ZXJzfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2xheWVycycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3BlcmZvcm1hbmNlLWltcGwuUGVyZm9ybWFuY2V9XG4gICAqL1xuICBzdGF0aWMgcGVyZm9ybWFuY2VGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9wZXJmb3JtYW5jZS1pbXBsLlBlcmZvcm1hbmNlfSovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAncGVyZm9ybWFuY2UnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9wZXJmb3JtYW5jZS1pbXBsLlBlcmZvcm1hbmNlfVxuICAgKi9cbiAgc3RhdGljIHBlcmZvcm1hbmNlRm9yT3JOdWxsKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvcGVyZm9ybWFuY2UtaW1wbC5QZXJmb3JtYW5jZX0qLyAoXG4gICAgICBnZXRFeGlzdGluZ1NlcnZpY2VPck51bGwod2luZG93LCAncGVyZm9ybWFuY2UnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9wbGF0Zm9ybS1pbXBsLlBsYXRmb3JtfVxuICAgKi9cbiAgc3RhdGljIHBsYXRmb3JtRm9yKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvcGxhdGZvcm0taW1wbC5QbGF0Zm9ybX0gKi8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdwbGF0Zm9ybScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VzIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKCkgc2luY2UgUmVzb3VyY2VzIGlzIGEgc3RhcnR1cCBzZXJ2aWNlLlxuICAgKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9yZXNvdXJjZXMtaW1wbC5SZXNvdXJjZXN9XG4gICAqL1xuICBzdGF0aWMgcmVzb3VyY2VzRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvcmVzb3VyY2VzLWltcGwuUmVzb3VyY2VzfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZChub2RlT3JEb2MsICdyZXNvdXJjZXMnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7P1Byb21pc2U8P3tpbmNvbWluZ0ZyYWdtZW50OiBzdHJpbmcsIG91dGdvaW5nRnJhZ21lbnQ6IHN0cmluZ30+fVxuICAgKi9cbiAgc3RhdGljIHNoYXJlVHJhY2tpbmdGb3JPck51bGwod2luKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPD97aW5jb21pbmdGcmFnbWVudDogc3RyaW5nLCBvdXRnb2luZ0ZyYWdtZW50OiBzdHJpbmd9Pn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICdzaGFyZS10cmFja2luZycsXG4gICAgICAgICAgJ2FtcC1zaGFyZS10cmFja2luZycsIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7P1Byb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC92YXJpYWJsZS1zZXJ2aWNlLlN0b3J5VmFyaWFibGVEZWY+fVxuICAgKi9cbiAgc3RhdGljIHN0b3J5VmFyaWFibGVTZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL3ZhcmlhYmxlLXNlcnZpY2UuU3RvcnlWYXJpYWJsZURlZj59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICdzdG9yeS12YXJpYWJsZScsICdhbXAtc3RvcnknLFxuICAgICAgICAgIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogVmVyc2lvbiBvZiB0aGUgc3Rvcnkgc3RvcmUgc2VydmljZSBkZXBlbmRzIG9uIHdoaWNoIHZlcnNpb24gb2YgYW1wLXN0b3J5XG4gICAqIHRoZSBwdWJsaXNoZXIgaXMgbG9hZGluZy4gVGhleSBhbGwgaGF2ZSB0aGUgc2FtZSBpbXBsZW1lbnRhdGlvbi5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7P1Byb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZXw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBzdG9yeVN0b3JlU2VydmljZUZvck9yTnVsbCh3aW4pIHtcbiAgICByZXR1cm4gKFxuICAgIC8qKiBAdHlwZSB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZXw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgJ3N0b3J5LXN0b3JlJywgJ2FtcC1zdG9yeScpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBzdG9yeVN0b3JlU2VydmljZSh3aW4pIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZX0gKi9cbiAgICAgIChnZXRFeGlzdGluZ1NlcnZpY2VPck51bGwod2luLCAnc3Rvcnktc3RvcmUnKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4gez8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvYW1wLXN0b3J5LXJlcXVlc3Qtc2VydmljZS5BbXBTdG9yeVJlcXVlc3RTZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIHN0b3J5UmVxdWVzdFNlcnZpY2Uod2luKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgez8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvYW1wLXN0b3J5LXJlcXVlc3Qtc2VydmljZS5BbXBTdG9yeVJlcXVlc3RTZXJ2aWNlfSAqL1xuICAgICAgKGdldEV4aXN0aW5nU2VydmljZU9yTnVsbCh3aW4sICdzdG9yeS1yZXF1ZXN0JykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2xvY2FsaXphdGlvbi5Mb2NhbGl6YXRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBsb2NhbGl6YXRpb25TZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2xvY2FsaXphdGlvbi5Mb2NhbGl6YXRpb25TZXJ2aWNlPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgJ2xvY2FsaXphdGlvbicsICdhbXAtc3RvcnknLCB0cnVlKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4geyEuLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgbG9jYWxpemF0aW9uU2VydmljZSh3aW4pIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZSh3aW4sICdsb2NhbGl6YXRpb24nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUT0RPKCMxNDM1Nyk6IFJlbW92ZSB0aGlzIHdoZW4gYW1wLXN0b3J5OjAuMSBpcyBkZXByZWNhdGVkLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshLi4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIHN0b3J5U3RvcmVTZXJ2aWNlVjAxKHdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbiwgJ3N0b3J5LXN0b3JlJyk7XG4gIH1cblxuICAvKipcbiAgICogVE9ETygjMTQzNTcpOiBSZW1vdmUgdGhpcyB3aGVuIGFtcC1zdG9yeTowLjEgaXMgZGVwcmVjYXRlZC5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzAuMS9hbXAtc3RvcnktcmVxdWVzdC1zZXJ2aWNlLkFtcFN0b3J5UmVxdWVzdFNlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgc3RvcnlSZXF1ZXN0U2VydmljZVYwMSh3aW4pIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZSh3aW4sICdzdG9yeS1yZXF1ZXN0LXYwMScpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRPRE8oIzE0MzU3KTogUmVtb3ZlIHRoaXMgd2hlbiBhbXAtc3Rvcnk6MC4xIGlzIGRlcHJlY2F0ZWQuXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGxvY2FsaXphdGlvblNlcnZpY2VGb3JPck51bGxWMDEod2luKSB7XG4gICAgcmV0dXJuIChcbiAgICAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2U+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAnbG9jYWxpemF0aW9uLXYwMScsICdhbXAtc3RvcnknLFxuICAgICAgICAgIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogVE9ETygjMTQzNTcpOiBSZW1vdmUgdGhpcyB3aGVuIGFtcC1zdG9yeTowLjEgaXMgZGVwcmVjYXRlZC5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzAuMS9sb2NhbGl6YXRpb24uTG9jYWxpemF0aW9uU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBsb2NhbGl6YXRpb25TZXJ2aWNlVjAxKHdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbiwgJ2xvY2FsaXphdGlvbi12MDEnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHs/UHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtdmlld2VyLWludGVncmF0aW9uLzAuMS92YXJpYWJsZS1zZXJ2aWNlLlZpZXdlckludGVncmF0aW9uVmFyaWFibGVEZWY+fVxuICAgKi9cbiAgc3RhdGljIHZpZXdlckludGVncmF0aW9uVmFyaWFibGVTZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtdmlld2VyLWludGVncmF0aW9uLzAuMS92YXJpYWJsZS1zZXJ2aWNlLlZpZXdlckludGVncmF0aW9uVmFyaWFibGVEZWY+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAndmlld2VyLWludGVncmF0aW9uLXZhcmlhYmxlJyxcbiAgICAgICAgICAnYW1wLXZpZXdlci1pbnRlZ3JhdGlvbicsIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hbmltYXRpb24vMC4xL3dlYi1hbmltYXRpb24tc2VydmljZS5XZWJBbmltYXRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyB3ZWJBbmltYXRpb25TZXJ2aWNlRm9yKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAoLyoqIEB0eXBlIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtYW5pbWF0aW9uLzAuMS93ZWItYW5pbWF0aW9uLXNlcnZpY2UuV2ViQW5pbWF0aW9uU2VydmljZT59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoXG4gICAgICAgICAgZWxlbWVudE9yQW1wRG9jLCAnd2ViLWFuaW1hdGlvbicsICdhbXAtYW5pbWF0aW9uJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8IS4vc2VydmljZS9zdG9yYWdlLWltcGwuU3RvcmFnZT59XG4gICAqL1xuICBzdGF0aWMgc3RvcmFnZUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3N0b3JhZ2UtaW1wbC5TdG9yYWdlPn0gKi8gKFxuICAgICAgZ2V0U2VydmljZVByb21pc2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnc3RvcmFnZScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3RlbXBsYXRlLWltcGwuVGVtcGxhdGVzfVxuICAgKi9cbiAgc3RhdGljIHRlbXBsYXRlc0Zvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3RlbXBsYXRlLWltcGwuVGVtcGxhdGVzfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3RlbXBsYXRlcycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3RpbWVyLWltcGwuVGltZXJ9XG4gICAqL1xuICBzdGF0aWMgdGltZXJGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS90aW1lci1pbXBsLlRpbWVyfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3RpbWVyJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVubGlrZSBtb3N0IHNlcnZpY2UgZ2V0dGVycywgcGFzc2luZyBgTm9kZWAgaXMgbmVjZXNzYXJ5IGZvciBzb21lIEZJRS1zY29wZVxuICAgKiBzZXJ2aWNlcyBzaW5jZSBzb21ldGltZXMgd2Ugb25seSBoYXZlIHRoZSBGSUUgRG9jdW1lbnQgZm9yIGNvbnRleHQuXG4gICAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3VybC1yZXBsYWNlbWVudHMtaW1wbC5VcmxSZXBsYWNlbWVudHN9XG4gICAqL1xuICBzdGF0aWMgdXJsUmVwbGFjZW1lbnRzRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvdXJsLXJlcGxhY2VtZW50cy1pbXBsLlVybFJlcGxhY2VtZW50c30gKi8gKFxuICAgICAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIG5vZGVPckRvYywgJ3VybC1yZXBsYWNlJywgLyogb3B0X2ZhbGxiYWNrVG9Ub3BXaW4gKi8gdHJ1ZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtdXNlci1ub3RpZmljYXRpb24vMC4xL2FtcC11c2VyLW5vdGlmaWNhdGlvbi5Vc2VyTm90aWZpY2F0aW9uTWFuYWdlcj59XG4gICAqL1xuICBzdGF0aWMgdXNlck5vdGlmaWNhdGlvbk1hbmFnZXJGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC11c2VyLW5vdGlmaWNhdGlvbi8wLjEvYW1wLXVzZXItbm90aWZpY2F0aW9uLlVzZXJOb3RpZmljYXRpb25NYW5hZ2VyPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICd1c2VyTm90aWZpY2F0aW9uTWFuYWdlcicsXG4gICAgICAgICAgJ2FtcC11c2VyLW5vdGlmaWNhdGlvbicpKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBjb25zZW50UG9saWN5IFNlcnZpY2Ugb3IgYSBwcm9taXNlIGZvciBudWxsIGlmXG4gICAqIHRoZSBzZXJ2aWNlIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1jb25zZW50LzAuMS9jb25zZW50LXBvbGljeS1tYW5hZ2VyLkNvbnNlbnRQb2xpY3lNYW5hZ2VyPn1cbiAgICovXG4gIHN0YXRpYyBjb25zZW50UG9saWN5U2VydmljZUZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWNvbnNlbnQvMC4xL2NvbnNlbnQtcG9saWN5LW1hbmFnZXIuQ29uc2VudFBvbGljeU1hbmFnZXI+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLFxuICAgICAgICAgICdjb25zZW50UG9saWN5TWFuYWdlcicsICdhbXAtY29uc2VudCcpKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBnZW8gc2VydmljZSBvciBhIHByb21pc2UgZm9yIG51bGwgaWZcbiAgICogdGhlIHNlcnZpY2UgaXMgbm90IGF2YWlsYWJsZSBvbiB0aGUgY3VycmVudCBwYWdlLlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWdlby8wLjEvYW1wLWdlby5HZW9EZWY+fVxuICAgKi9cbiAgc3RhdGljIGdlb0ZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtZ2VvLzAuMS9hbXAtZ2VvLkdlb0RlZj59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoXG4gICAgICAgICAgZWxlbWVudE9yQW1wRG9jLCAnZ2VvJywgJ2FtcC1nZW8nLCB0cnVlKSk7XG4gIH1cblxuICAvKipcbiAgICogVW5saWtlIG1vc3Qgc2VydmljZSBnZXR0ZXJzLCBwYXNzaW5nIGBOb2RlYCBpcyBuZWNlc3NhcnkgZm9yIHNvbWUgRklFLXNjb3BlXG4gICAqIHNlcnZpY2VzIHNpbmNlIHNvbWV0aW1lcyB3ZSBvbmx5IGhhdmUgdGhlIEZJRSBEb2N1bWVudCBmb3IgY29udGV4dC5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvdXJsLWltcGwuVXJsfVxuICAgKi9cbiAgc3RhdGljIHVybEZvckRvYyhub2RlT3JEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3VybC1pbXBsLlVybH0gKi8gKFxuICAgICAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIG5vZGVPckRvYywgJ3VybCcsIC8qIG9wdF9mYWxsYmFja1RvVG9wV2luICovIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIGV4cGVyaW1lbnQgdmFyaWFudHMgb3IgYSBwcm9taXNlIGZvciBudWxsIGlmIGl0XG4gICAqIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IVByb21pc2U8P09iamVjdDxzdHJpbmc+Pn1cbiAgICovXG4gIHN0YXRpYyB2YXJpYW50Rm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q8c3RyaW5nPj59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAndmFyaWFudCcsICdhbXAtZXhwZXJpbWVudCcsIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS92aWRlby1zZXJ2aWNlLWludGVyZmFjZS5WaWRlb1NlcnZpY2VJbnRlcmZhY2V9XG4gICAqL1xuICBzdGF0aWMgdmlkZW9NYW5hZ2VyRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAoXG4gICAgICAvKiogQHR5cGUgeyEuL3NlcnZpY2UvdmlkZW8tc2VydmljZS1pbnRlcmZhY2UuVmlkZW9TZXJ2aWNlSW50ZXJmYWNlfSAqLyAoXG4gICAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAndmlkZW8tbWFuYWdlcicpKSk7XG4gIH1cblxuICAvKipcbiAgICogVXNlcyBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZCgpIHNpbmNlIFZpZXdlciBpcyBhIHN0YXJ0dXAgc2VydmljZS5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2Uvdmlld2VyLWltcGwuVmlld2VyfVxuICAgKi9cbiAgc3RhdGljIHZpZXdlckZvckRvYyhub2RlT3JEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcn0gKi8gKFxuICAgICAgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQobm9kZU9yRG9jLCAndmlld2VyJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgcHJvbWlzZSBmb3IgdGhlIHZpZXdlci4gVGhpcyBpcyBhbiB1bnVzdWFsIGNhc2UgYW5kIG5lY2Vzc2FyeSBvbmx5XG4gICAqIGZvciBzZXJ2aWNlcyB0aGF0IG5lZWQgcmVmZXJlbmNlIHRvIHRoZSB2aWV3ZXIgYmVmb3JlIGl0IGhhcyBiZWVuXG4gICAqIGluaXRpYWxpemVkLiBNb3N0IG9mIHRoZSBjb2RlLCBob3dldmVyLCBqdXN0IHNob3VsZCB1c2UgYHZpZXdlckZvckRvY2AuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcj59XG4gICAqL1xuICBzdGF0aWMgdmlld2VyUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcj59ICovIChcbiAgICAgIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ3ZpZXdlcicpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3ZzeW5jLWltcGwuVnN5bmN9XG4gICAqL1xuICBzdGF0aWMgdnN5bmNGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS92c3luYy1pbXBsLlZzeW5jfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3ZzeW5jJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZXMgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQoKSBzaW5jZSBWaWV3cG9ydCBpcyBhIHN0YXJ0dXAgc2VydmljZS5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2Uvdmlld3BvcnQvdmlld3BvcnQtaW1wbC5WaWV3cG9ydH1cbiAgICovXG4gIHN0YXRpYyB2aWV3cG9ydEZvckRvYyhub2RlT3JEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3ZpZXdwb3J0L3ZpZXdwb3J0LWltcGwuVmlld3BvcnR9ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKG5vZGVPckRvYywgJ3ZpZXdwb3J0JykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UveGhyLWltcGwuWGhyfVxuICAgKi9cbiAgc3RhdGljIHhockZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3hoci1pbXBsLlhocn0gKi8gKGdldFNlcnZpY2Uod2luZG93LCAneGhyJykpO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gX21hdGNoXG4gKiBAcGFyYW0ge3N0cmluZ30gY2hhcmFjdGVyXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHRvVXBwZXJDYXNlKF9tYXRjaCwgY2hhcmFjdGVyKSB7XG4gIHJldHVybiBjaGFyYWN0ZXIudG9VcHBlckNhc2UoKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWF0Y2hcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gcHJlcGVuZERhc2hBbmRUb0xvd2VyQ2FzZShtYXRjaCkge1xuICByZXR1cm4gJy0nICsgbWF0Y2gudG9Mb3dlckNhc2UoKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBBdHRyaWJ1dGUgbmFtZSBjb250YWluaW5nIGRhc2hlcy5cbiAqIEByZXR1cm4ge3N0cmluZ30gRGFzaGVzIHJlbW92ZWQgYW5kIHN1Y2Nlc3NpdmUgY2hhcmFjdGVyIHNlbnQgdG8gdXBwZXIgY2FzZS5cbiAqIHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkYXNoVG9DYW1lbENhc2UobmFtZSkge1xuICByZXR1cm4gbmFtZS5yZXBsYWNlKC8tKFthLXpdKS9nLCB0b1VwcGVyQ2FzZSk7XG59XG5cbi8qKlxuICogQ29udmVydHMgYSBzdHJpbmcgdGhhdCBpcyBpbiBjYW1lbENhc2UgdG8gb25lIHRoYXQgaXMgaW4gZGFzaC1jYXNlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJpbmcgVGhlIHN0cmluZyB0byBjb252ZXJ0LlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgc3RyaW5nIGluIGRhc2gtY2FzZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNhbWVsQ2FzZVRvRGFzaChzdHJpbmcpIHtcbiAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC8oPyFeKVtBLVpdL2csIHByZXBlbmREYXNoQW5kVG9Mb3dlckNhc2UpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIEF0dHJpYnV0ZSBuYW1lIHdpdGggZGFzaGVzXG4gKiBAcmV0dXJuIHtzdHJpbmd9IERhc2hlcyByZXBsYWNlZCBieSB1bmRlcmxpbmVzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZGFzaFRvVW5kZXJsaW5lKG5hbWUpIHtcbiAgcmV0dXJuIG5hbWUucmVwbGFjZSgnLScsICdfJyk7XG59XG5cbi8qKlxuICogUG9seWZpbGwgZm9yIFN0cmluZy5wcm90b3R5cGUuZW5kc1dpdGguXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nXG4gKiBAcGFyYW0ge3N0cmluZ30gc3VmZml4XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gZW5kc1dpdGgoc3RyaW5nLCBzdWZmaXgpIHtcbiAgY29uc3QgaW5kZXggPSBzdHJpbmcubGVuZ3RoIC0gc3VmZml4Lmxlbmd0aDtcbiAgcmV0dXJuIGluZGV4ID49IDAgJiYgc3RyaW5nLmluZGV4T2Yoc3VmZml4LCBpbmRleCkgPT0gaW5kZXg7XG59XG5cbi8qKlxuICogUG9seWZpbGwgZm9yIFN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aC5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJpbmdcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcmVmaXhcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdGFydHNXaXRoKHN0cmluZywgcHJlZml4KSB7XG4gIGlmIChwcmVmaXgubGVuZ3RoID4gc3RyaW5nLmxlbmd0aCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gc3RyaW5nLmxhc3RJbmRleE9mKHByZWZpeCwgMCkgPT0gMDtcbn1cblxuLyoqXG4gKiBFeHBhbmRzIHBsYWNlaG9sZGVycyBpbiBhIGdpdmVuIHRlbXBsYXRlIHN0cmluZyB3aXRoIHZhbHVlcy5cbiAqXG4gKiBQbGFjZWhvbGRlcnMgdXNlICR7a2V5LW5hbWV9IHN5bnRheCBhbmQgYXJlIHJlcGxhY2VkIHdpdGggdGhlIHZhbHVlXG4gKiByZXR1cm5lZCBmcm9tIHRoZSBnaXZlbiBnZXR0ZXIgZnVuY3Rpb24uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHRlbXBsYXRlIFRoZSB0ZW1wbGF0ZSBzdHJpbmcgdG8gZXhwYW5kLlxuICogQHBhcmFtIHtmdW5jdGlvbihzdHJpbmcpOip9IGdldHRlciBGdW5jdGlvbiB1c2VkIHRvIHJldHJpZXZlIGEgdmFsdWUgZm9yIGFcbiAqICAgcGxhY2Vob2xkZXIuIFJldHVybnMgdmFsdWVzIHdpbGwgYmUgY29lcmNlZCBpbnRvIHN0cmluZ3MuXG4gKiBAcGFyYW0ge251bWJlcj19IG9wdF9tYXhJdGVyYXRpb25zIE51bWJlciBvZiB0aW1lcyB0byBleHBhbmQgdGhlIHRlbXBsYXRlLlxuICogICBEZWZhdWx0cyB0byAxLCBidXQgc2hvdWxkIGJlIHNldCB0byBhIGxhcmdlciB2YWx1ZSB5b3VyIHBsYWNlaG9sZGVyIHRva2Vuc1xuICogICBjYW4gYmUgZXhwYW5kZWQgdG8gb3RoZXIgcGxhY2Vob2xkZXIgdG9rZW5zLiBUYWtlIGNhdXRpb24gd2l0aCBsYXJnZSB2YWx1ZXNcbiAqICAgYXMgcmVjdXJzaXZlbHkgZXhwYW5kaW5nIGEgc3RyaW5nIGNhbiBiZSBleHBvbmVudGlhbGx5IGV4cGVuc2l2ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4cGFuZFRlbXBsYXRlKHRlbXBsYXRlLCBnZXR0ZXIsIG9wdF9tYXhJdGVyYXRpb25zKSB7XG4gIGNvbnN0IG1heEl0ZXJhdGlvbnMgPSBvcHRfbWF4SXRlcmF0aW9ucyB8fCAxO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IG1heEl0ZXJhdGlvbnM7IGkrKykge1xuICAgIGxldCBtYXRjaGVzID0gMDtcbiAgICB0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UoL1xcJHsoW159XSopfS9nLCAoX2EsIGIpID0+IHtcbiAgICAgIG1hdGNoZXMrKztcbiAgICAgIHJldHVybiBnZXR0ZXIoYik7XG4gICAgfSk7XG4gICAgaWYgKCFtYXRjaGVzKSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRlbXBsYXRlO1xufVxuXG4vKipcbiAqIEhhc2ggZnVuY3Rpb24gZGpiMmFcbiAqIFRoaXMgaXMgaW50ZW5kZWQgdG8gYmUgYSBzaW1wbGUsIGZhc3QgaGFzaGluZyBmdW5jdGlvbiB1c2luZyBtaW5pbWFsIGNvZGUuXG4gKiBJdCBkb2VzICpub3QqIGhhdmUgZ29vZCBjcnlwdG9ncmFwaGljIHByb3BlcnRpZXMuXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyXG4gKiBAcmV0dXJuIHtzdHJpbmd9IDMyLWJpdCB1bnNpZ25lZCBoYXNoIG9mIHRoZSBzdHJpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0cmluZ0hhc2gzMihzdHIpIHtcbiAgY29uc3Qge2xlbmd0aH0gPSBzdHI7XG4gIGxldCBoYXNoID0gNTM4MTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGhhc2ggPSBoYXNoICogMzMgXiBzdHIuY2hhckNvZGVBdChpKTtcbiAgfVxuICAvLyBDb252ZXJ0IGZyb20gMzItYml0IHNpZ25lZCB0byB1bnNpZ25lZC5cbiAgcmV0dXJuIFN0cmluZyhoYXNoID4+PiAwKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vLyBOb3RlOiBsb2FkZWQgYnkgM3Agc3lzdGVtLiBDYW5ub3QgcmVseSBvbiBiYWJlbCBwb2x5ZmlsbHMuXG5pbXBvcnQge21hcH0gZnJvbSAnLi91dGlscy9vYmplY3QuanMnO1xuaW1wb3J0IHtzdGFydHNXaXRofSBmcm9tICcuL3N0cmluZyc7XG5cblxuLyoqIEB0eXBlIHtPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSAqL1xubGV0IHByb3BlcnR5TmFtZUNhY2hlO1xuXG4vKiogQGNvbnN0IHshQXJyYXk8c3RyaW5nPn0gKi9cbmNvbnN0IHZlbmRvclByZWZpeGVzID0gWydXZWJraXQnLCAnd2Via2l0JywgJ01veicsICdtb3onLCAnbXMnLCAnTycsICdvJ107XG5cblxuLyoqXG4gKiBAZXhwb3J0XG4gKiBAcGFyYW0ge3N0cmluZ30gY2FtZWxDYXNlIGNhbWVsIGNhc2VkIHN0cmluZ1xuICogQHJldHVybiB7c3RyaW5nfSB0aXRsZSBjYXNlZCBzdHJpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNhbWVsQ2FzZVRvVGl0bGVDYXNlKGNhbWVsQ2FzZSkge1xuICByZXR1cm4gY2FtZWxDYXNlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgY2FtZWxDYXNlLnNsaWNlKDEpO1xufVxuXG4vKipcbiAqIENoZWNrcyB0aGUgc3R5bGUgaWYgYSBwcmVmaXhlZCB2ZXJzaW9uIG9mIGEgcHJvcGVydHkgZXhpc3RzIGFuZCByZXR1cm5zXG4gKiBpdCBvciByZXR1cm5zIGFuIGVtcHR5IHN0cmluZy5cbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyFPYmplY3R9IHN0eWxlXG4gKiBAcGFyYW0ge3N0cmluZ30gdGl0bGVDYXNlIHRoZSB0aXRsZSBjYXNlIHZlcnNpb24gb2YgYSBjc3MgcHJvcGVydHkgbmFtZVxuICogQHJldHVybiB7c3RyaW5nfSB0aGUgcHJlZml4ZWQgcHJvcGVydHkgbmFtZSBvciBudWxsLlxuICovXG5mdW5jdGlvbiBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZV8oc3R5bGUsIHRpdGxlQ2FzZSkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHZlbmRvclByZWZpeGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgcHJvcGVydHlOYW1lID0gdmVuZG9yUHJlZml4ZXNbaV0gKyB0aXRsZUNhc2U7XG4gICAgaWYgKHN0eWxlW3Byb3BlcnR5TmFtZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHByb3BlcnR5TmFtZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuICcnO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHBvc3NpYmx5IHByZWZpeGVkIEphdmFTY3JpcHQgcHJvcGVydHkgbmFtZSBvZiBhIHN0eWxlIHByb3BlcnR5XG4gKiAoZXguIFdlYmtpdFRyYW5zaXRpb25EdXJhdGlvbikgZ2l2ZW4gYSBjYW1lbENhc2UnZCB2ZXJzaW9uIG9mIHRoZSBwcm9wZXJ0eVxuICogKGV4LiB0cmFuc2l0aW9uRHVyYXRpb24pLlxuICogQGV4cG9ydFxuICogQHBhcmFtIHshT2JqZWN0fSBzdHlsZVxuICogQHBhcmFtIHtzdHJpbmd9IGNhbWVsQ2FzZSB0aGUgY2FtZWwgY2FzZWQgdmVyc2lvbiBvZiBhIGNzcyBwcm9wZXJ0eSBuYW1lXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfYnlwYXNzQ2FjaGUgYnlwYXNzIHRoZSBtZW1vaXplZCBjYWNoZSBvZiBwcm9wZXJ0eVxuICogICBtYXBwaW5nXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZShzdHlsZSwgY2FtZWxDYXNlLCBvcHRfYnlwYXNzQ2FjaGUpIHtcbiAgaWYgKHN0YXJ0c1dpdGgoY2FtZWxDYXNlLCAnLS0nKSkge1xuICAgIC8vIENTUyB2YXJzIGFyZSByZXR1cm5lZCBhcyBpcy5cbiAgICByZXR1cm4gY2FtZWxDYXNlO1xuICB9XG4gIGlmICghcHJvcGVydHlOYW1lQ2FjaGUpIHtcbiAgICBwcm9wZXJ0eU5hbWVDYWNoZSA9IG1hcCgpO1xuICB9XG4gIGxldCBwcm9wZXJ0eU5hbWUgPSBwcm9wZXJ0eU5hbWVDYWNoZVtjYW1lbENhc2VdO1xuICBpZiAoIXByb3BlcnR5TmFtZSB8fCBvcHRfYnlwYXNzQ2FjaGUpIHtcbiAgICBwcm9wZXJ0eU5hbWUgPSBjYW1lbENhc2U7XG4gICAgaWYgKHN0eWxlW2NhbWVsQ2FzZV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgY29uc3QgdGl0bGVDYXNlID0gY2FtZWxDYXNlVG9UaXRsZUNhc2UoY2FtZWxDYXNlKTtcbiAgICAgIGNvbnN0IHByZWZpeGVkUHJvcGVydHlOYW1lID0gZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWVfKHN0eWxlLCB0aXRsZUNhc2UpO1xuXG4gICAgICBpZiAoc3R5bGVbcHJlZml4ZWRQcm9wZXJ0eU5hbWVdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcHJvcGVydHlOYW1lID0gcHJlZml4ZWRQcm9wZXJ0eU5hbWU7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghb3B0X2J5cGFzc0NhY2hlKSB7XG4gICAgICBwcm9wZXJ0eU5hbWVDYWNoZVtjYW1lbENhc2VdID0gcHJvcGVydHlOYW1lO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcHJvcGVydHlOYW1lO1xufVxuXG5cbi8qKlxuICogU2V0cyB0aGUgQ1NTIHN0eWxlcyBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgd2l0aCAhaW1wb3J0YW50LiBUaGUgc3R5bGVzXG4gKiBhcmUgc3BlY2lmaWVkIGFzIGEgbWFwIGZyb20gQ1NTIHByb3BlcnR5IG5hbWVzIHRvIHRoZWlyIHZhbHVlcy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICo+fSBzdHlsZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldEltcG9ydGFudFN0eWxlcyhlbGVtZW50LCBzdHlsZXMpIHtcbiAgZm9yIChjb25zdCBrIGluIHN0eWxlcykge1xuICAgIGVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoXG4gICAgICAgIGdldFZlbmRvckpzUHJvcGVydHlOYW1lKHN0eWxlcywgayksIHN0eWxlc1trXS50b1N0cmluZygpLCAnaW1wb3J0YW50Jyk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFNldHMgdGhlIENTUyBzdHlsZSBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgd2l0aCBvcHRpb25hbCB1bml0cywgZS5nLiBcInB4XCIuXG4gKiBAcGFyYW0gez9FbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvcGVydHlcbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X3VuaXRzXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfYnlwYXNzQ2FjaGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFN0eWxlKGVsZW1lbnQsIHByb3BlcnR5LCB2YWx1ZSwgb3B0X3VuaXRzLCBvcHRfYnlwYXNzQ2FjaGUpIHtcbiAgY29uc3QgcHJvcGVydHlOYW1lID0gZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWUoZWxlbWVudC5zdHlsZSwgcHJvcGVydHksXG4gICAgICBvcHRfYnlwYXNzQ2FjaGUpO1xuICBpZiAocHJvcGVydHlOYW1lKSB7XG4gICAgZWxlbWVudC5zdHlsZVtwcm9wZXJ0eU5hbWVdID1cbiAgICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAob3B0X3VuaXRzID8gdmFsdWUgKyBvcHRfdW5pdHMgOiB2YWx1ZSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBDU1Mgc3R5bGUgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5XG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfYnlwYXNzQ2FjaGVcbiAqIEByZXR1cm4geyp9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdHlsZShlbGVtZW50LCBwcm9wZXJ0eSwgb3B0X2J5cGFzc0NhY2hlKSB7XG4gIGNvbnN0IHByb3BlcnR5TmFtZSA9IGdldFZlbmRvckpzUHJvcGVydHlOYW1lKGVsZW1lbnQuc3R5bGUsIHByb3BlcnR5LFxuICAgICAgb3B0X2J5cGFzc0NhY2hlKTtcbiAgaWYgKCFwcm9wZXJ0eU5hbWUpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIHJldHVybiBlbGVtZW50LnN0eWxlW3Byb3BlcnR5TmFtZV07XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBDU1Mgc3R5bGVzIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudC4gVGhlIHN0eWxlc1xuICogYSBzcGVjaWZpZWQgYXMgYSBtYXAgZnJvbSBDU1MgcHJvcGVydHkgbmFtZXMgdG8gdGhlaXIgdmFsdWVzLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgKj59IHN0eWxlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0U3R5bGVzKGVsZW1lbnQsIHN0eWxlcykge1xuICBmb3IgKGNvbnN0IGsgaW4gc3R5bGVzKSB7XG4gICAgc2V0U3R5bGUoZWxlbWVudCwgaywgc3R5bGVzW2tdKTtcbiAgfVxufVxuXG5cbi8qKlxuICogU2hvd3Mgb3IgaGlkZXMgdGhlIHNwZWNpZmllZCBlbGVtZW50LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2Rpc3BsYXlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvZ2dsZShlbGVtZW50LCBvcHRfZGlzcGxheSkge1xuICBpZiAob3B0X2Rpc3BsYXkgPT09IHVuZGVmaW5lZCkge1xuICAgIG9wdF9kaXNwbGF5ID0gZ2V0U3R5bGUoZWxlbWVudCwgJ2Rpc3BsYXknKSA9PSAnbm9uZSc7XG4gIH1cbiAgc2V0U3R5bGUoZWxlbWVudCwgJ2Rpc3BsYXknLCBvcHRfZGlzcGxheSA/ICcnIDogJ25vbmUnKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBwaXhlbCB2YWx1ZS5cbiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcHgodmFsdWUpIHtcbiAgcmV0dXJuIGAke3ZhbHVlfXB4YDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgZGVncmVlIHZhbHVlLlxuICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWcodmFsdWUpIHtcbiAgcmV0dXJuIGAke3ZhbHVlfWRlZ2A7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIFwidHJhbnNsYXRlWFwiIGZvciBDU1MgXCJ0cmFuc2Zvcm1cIiBwcm9wZXJ0eS5cbiAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyYW5zbGF0ZVgodmFsdWUpIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBgdHJhbnNsYXRlWCgke3ZhbHVlfSlgO1xuICB9XG4gIHJldHVybiBgdHJhbnNsYXRlWCgke3B4KHZhbHVlKX0pYDtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBcInRyYW5zbGF0ZVhcIiBmb3IgQ1NTIFwidHJhbnNmb3JtXCIgcHJvcGVydHkuXG4gKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IHhcbiAqIEBwYXJhbSB7KG51bWJlcnxzdHJpbmcpPX0gb3B0X3lcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyYW5zbGF0ZSh4LCBvcHRfeSkge1xuICBpZiAodHlwZW9mIHggPT0gJ251bWJlcicpIHtcbiAgICB4ID0gcHgoeCk7XG4gIH1cbiAgaWYgKG9wdF95ID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gYHRyYW5zbGF0ZSgke3h9KWA7XG4gIH1cbiAgaWYgKHR5cGVvZiBvcHRfeSA9PSAnbnVtYmVyJykge1xuICAgIG9wdF95ID0gcHgob3B0X3kpO1xuICB9XG4gIHJldHVybiBgdHJhbnNsYXRlKCR7eH0sICR7b3B0X3l9KWA7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgXCJzY2FsZVwiIGZvciBDU1MgXCJ0cmFuc2Zvcm1cIiBwcm9wZXJ0eS5cbiAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNjYWxlKHZhbHVlKSB7XG4gIHJldHVybiBgc2NhbGUoJHt2YWx1ZX0pYDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgXCJyb3RhdGVcIiBmb3IgQ1NTIFwidHJhbnNmb3JtXCIgcHJvcGVydHkuXG4gKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByb3RhdGUodmFsdWUpIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJykge1xuICAgIHZhbHVlID0gZGVnKHZhbHVlKTtcbiAgfVxuICByZXR1cm4gYHJvdGF0ZSgke3ZhbHVlfSlgO1xufVxuXG4vKipcbiAqIFJlbW92ZSBhbHBoYSB2YWx1ZSBmcm9tIGEgcmdiYSBjb2xvciB2YWx1ZS5cbiAqIFJldHVybiB0aGUgbmV3IGNvbG9yIHByb3BlcnR5IHdpdGggYWxwaGEgZXF1YWxzIGlmIGhhcyB0aGUgYWxwaGEgdmFsdWUuXG4gKiBDYWxsZXIgbmVlZHMgdG8gbWFrZSBzdXJlIHRoZSBpbnB1dCBjb2xvciB2YWx1ZSBpcyBhIHZhbGlkIHJnYmEvcmdiIHZhbHVlXG4gKiBAcGFyYW0ge3N0cmluZ30gcmdiYUNvbG9yXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVBbHBoYUZyb21Db2xvcihyZ2JhQ29sb3IpIHtcbiAgcmV0dXJuIHJnYmFDb2xvci5yZXBsYWNlKFxuICAgICAgL1xcKChbXixdKyksKFteLF0rKSwoW14sKV0rKSxbXildK1xcKS9nLCAnKCQxLCQyLCQzLCAxKScpO1xufVxuXG4vKipcbiAqIEdldHMgdGhlIGNvbXB1dGVkIHN0eWxlIG9mIHRoZSBlbGVtZW50LiBUaGUgaGVscGVyIGlzIG5lY2Vzc2FyeSB0byBlbmZvcmNlXG4gKiB0aGUgcG9zc2libGUgYG51bGxgIHZhbHVlIHJldHVybmVkIGJ5IGEgYnVnZ3kgRmlyZWZveC5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshRWxlbWVudH0gZWxcbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZWRTdHlsZSh3aW4sIGVsKSB7XG4gIGNvbnN0IHN0eWxlID0gLyoqIEB0eXBlIHs/Q1NTU3R5bGVEZWNsYXJhdGlvbn0gKi8od2luLmdldENvbXB1dGVkU3R5bGUoZWwpKTtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59ICovKHN0eWxlKSB8fCBtYXAoKTtcbn1cblxuXG4vKipcbiAqIFJlc2V0cyBzdHlsZXMgdGhhdCB3ZXJlIHNldCBkeW5hbWljYWxseSAoaS5lLiBpbmxpbmUpXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0geyFBcnJheTxzdHJpbmc+fSBwcm9wZXJ0aWVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldFN0eWxlcyhlbGVtZW50LCBwcm9wZXJ0aWVzKSB7XG4gIGNvbnN0IHN0eWxlT2JqID0ge307XG4gIHByb3BlcnRpZXMuZm9yRWFjaChwcm9wID0+IHtcbiAgICBzdHlsZU9ialtwcm9wXSA9IG51bGw7XG4gIH0pO1xuICBzZXRTdHlsZXMoZWxlbWVudCwgc3R5bGVPYmopO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qIEBjb25zdCAqL1xuY29uc3QgdG9TdHJpbmdfID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBFQ01BIFtbQ2xhc3NdXSBvZiBhIHZhbHVlXG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHRvU3RyaW5nKHZhbHVlKSB7XG4gIHJldHVybiB0b1N0cmluZ18uY2FsbCh2YWx1ZSk7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lcyBpZiB2YWx1ZSBpcyBhY3R1YWxseSBhbiBBcnJheS5cbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0FycmF5KHZhbHVlKSB7XG4gIHJldHVybiBBcnJheS5pc0FycmF5KHZhbHVlKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhbiBhcnJheS1saWtlIG9iamVjdCB0byBhbiBhcnJheS5cbiAqIEBwYXJhbSB7P0lBcnJheUxpa2U8VD58c3RyaW5nfSBhcnJheUxpa2VcbiAqIEByZXR1cm4geyFBcnJheTxUPn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b0FycmF5KGFycmF5TGlrZSkge1xuICBpZiAoIWFycmF5TGlrZSkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBjb25zdCBhcnJheSA9IG5ldyBBcnJheShhcnJheUxpa2UubGVuZ3RoKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheUxpa2UubGVuZ3RoOyBpKyspIHtcbiAgICBhcnJheVtpXSA9IGFycmF5TGlrZVtpXTtcbiAgfVxuICByZXR1cm4gYXJyYXk7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lcyBpZiB2YWx1ZSBpcyBhY3R1YWxseSBhbiBPYmplY3QuXG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgcmV0dXJuIHRvU3RyaW5nKHZhbHVlKSA9PT0gJ1tvYmplY3QgT2JqZWN0XSc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lcyBpZiB2YWx1ZSBpcyBvZiBudW1iZXIgdHlwZSBhbmQgZmluaXRlLlxuICogTmFOIGFuZCBJbmZpbml0eSBhcmUgbm90IGNvbnNpZGVyZWQgYSBmaW5pdGUgbnVtYmVyLlxuICogU3RyaW5nIG51bWJlcnMgYXJlIG5vdCBjb25zaWRlcmVkIG51bWJlcnMuXG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNGaW5pdGVOdW1iZXIodmFsdWUpIHtcbiAgcmV0dXJuICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIGlzRmluaXRlKHZhbHVlKSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIHdoZXRoZXIgYHNgIGlzIGEgdmFsaWQgdmFsdWUgb2YgYGVudW1PYmpgLlxuICpcbiAqIEBwYXJhbSB7IU9iamVjdDxUPn0gZW51bU9ialxuICogQHBhcmFtIHtUfSBzXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRW51bVZhbHVlKGVudW1PYmosIHMpIHtcbiAgZm9yIChjb25zdCBrIGluIGVudW1PYmopIHtcbiAgICBpZiAoZW51bU9ialtrXSA9PT0gcykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBFeHRlcm5zIGRlY2xhcmUgdGhhdCBhY2Nlc3MgYGRlZmF1bHRWaWV3YCBmcm9tIGBkb2N1bWVudGAgb3JcbiAqIGBvd25lckRvY3VtZW50YCBpcyBvZiB0eXBlIGAoV2luZG93fG51bGwpYCBidXQgbW9zdCBvZiBvdXIgcGFyYW1ldGVyIHR5cGVzXG4gKiBhc3N1bWUgdGhhdCBpdCBpcyBuZXZlciBudWxsLiBUaGlzIGlzIE9LIGluIHByYWN0aWNlIGFzIHdlIGV2ZXIgb25seSBnZXRcbiAqIG51bGwgb24gZGlzY29ubmVjdGVkIGRvY3VtZW50cyBvciBvbGQgSUUuXG4gKiBUaGlzIGhlbHBlciBmdW5jdGlvbiBjYXN0cyBpdCBpbnRvIGp1c3QgYSBzaW1wbGUgV2luZG93IHJldHVybiB0eXBlLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd3xudWxsfSB3aW5Pck51bGxcbiAqIEByZXR1cm4geyFXaW5kb3d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b1dpbih3aW5Pck51bGwpIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVdpbmRvd30gKi8gKHdpbk9yTnVsbCk7XG59XG5cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge3RyeURlY29kZVVyaUNvbXBvbmVudF99IGZyb20gJy4vdXJsLXRyeS1kZWNvZGUtdXJpLWNvbXBvbmVudCc7XG5cbmNvbnN0IHJlZ2V4ID0gLyg/Ol5bIz9dP3wmKShbXj0mXSspKD86PShbXiZdKikpPy9nO1xuXG4vKipcbiAqIFBhcnNlcyB0aGUgcXVlcnkgc3RyaW5nIG9mIGFuIFVSTC4gVGhpcyBtZXRob2QgcmV0dXJucyBhIHNpbXBsZSBrZXkvdmFsdWVcbiAqIG1hcC4gSWYgdGhlcmUgYXJlIGR1cGxpY2F0ZSBrZXlzIHRoZSBsYXRlc3QgdmFsdWUgaXMgcmV0dXJuZWQuXG4gKlxuICogRE8gTk9UIGltcG9ydCB0aGUgZnVuY3Rpb24gZnJvbSB0aGlzIGZpbGUuIEluc3RlYWQsIGltcG9ydCBwYXJzZVF1ZXJ5U3RyaW5nXG4gKiBmcm9tIGBzcmMvdXJsLmpzYC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcXVlcnlTdHJpbmdcbiAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VRdWVyeVN0cmluZ18ocXVlcnlTdHJpbmcpIHtcbiAgY29uc3QgcGFyYW1zID0gLyoqIEB0eXBlIHshSnNvbk9iamVjdH0gKi8gKE9iamVjdC5jcmVhdGUobnVsbCkpO1xuICBpZiAoIXF1ZXJ5U3RyaW5nKSB7XG4gICAgcmV0dXJuIHBhcmFtcztcbiAgfVxuXG4gIGxldCBtYXRjaDtcbiAgd2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWMocXVlcnlTdHJpbmcpKSkge1xuICAgIGNvbnN0IG5hbWUgPSB0cnlEZWNvZGVVcmlDb21wb25lbnRfKG1hdGNoWzFdLCBtYXRjaFsxXSk7XG4gICAgY29uc3QgdmFsdWUgPSBtYXRjaFsyXSA/IHRyeURlY29kZVVyaUNvbXBvbmVudF8obWF0Y2hbMl0sIG1hdGNoWzJdKSA6ICcnO1xuICAgIHBhcmFtc1tuYW1lXSA9IHZhbHVlO1xuICB9XG4gIHJldHVybiBwYXJhbXM7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBUcmllcyB0byBkZWNvZGUgYSBVUkkgY29tcG9uZW50LCBmYWxsaW5nIGJhY2sgdG8gb3B0X2ZhbGxiYWNrIChvciBhbiBlbXB0eVxuICogc3RyaW5nKVxuICpcbiAqIERPIE5PVCBpbXBvcnQgdGhlIGZ1bmN0aW9uIGZyb20gdGhpcyBmaWxlLiBJbnN0ZWFkLCBpbXBvcnRcbiAqIHRyeURlY29kZVVyaUNvbXBvbmVudCBmcm9tIGBzcmMvdXJsLmpzYC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gY29tcG9uZW50XG4gKiBAcGFyYW0ge3N0cmluZz19IGZhbGxiYWNrXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnlEZWNvZGVVcmlDb21wb25lbnRfKGNvbXBvbmVudCwgZmFsbGJhY2sgPSAnJykge1xuICB0cnkge1xuICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoY29tcG9uZW50KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBmYWxsYmFjaztcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7THJ1Q2FjaGV9IGZyb20gJy4vdXRpbHMvbHJ1LWNhY2hlJztcbmltcG9ydCB7ZGljdH0gZnJvbSAnLi91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtlbmRzV2l0aCwgc3RhcnRzV2l0aH0gZnJvbSAnLi9zdHJpbmcnO1xuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuL21vZGUnO1xuaW1wb3J0IHtpc0FycmF5fSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7cGFyc2VRdWVyeVN0cmluZ199IGZyb20gJy4vdXJsLXBhcnNlLXF1ZXJ5LXN0cmluZyc7XG5pbXBvcnQge3RyeURlY29kZVVyaUNvbXBvbmVudF99IGZyb20gJy4vdXJsLXRyeS1kZWNvZGUtdXJpLWNvbXBvbmVudCc7XG5pbXBvcnQge3VybHN9IGZyb20gJy4vY29uZmlnJztcbmltcG9ydCB7dXNlcn0gZnJvbSAnLi9sb2cnO1xuXG4vKipcbiAqIEB0eXBlIHshSnNvbk9iamVjdH1cbiAqL1xuY29uc3QgU0VSVklOR19UWVBFX1BSRUZJWCA9IGRpY3Qoe1xuICAvLyBObyB2aWV3ZXJcbiAgJ2MnOiB0cnVlLFxuICAvLyBJbiB2aWV3ZXJcbiAgJ3YnOiB0cnVlLFxuICAvLyBBZCBsYW5kaW5nIHBhZ2VcbiAgJ2EnOiB0cnVlLFxuICAvLyBBZFxuICAnYWQnOiB0cnVlLFxufSk7XG5cbi8qKlxuICogQ2FjaGVkIGEtdGFnIHRvIGF2b2lkIG1lbW9yeSBhbGxvY2F0aW9uIGR1cmluZyBVUkwgcGFyc2luZy5cbiAqIEB0eXBlIHtIVE1MQW5jaG9yRWxlbWVudH1cbiAqL1xubGV0IGE7XG5cbi8qKlxuICogV2UgY2FjaGVkIGFsbCBwYXJzZWQgVVJMcy4gQXMgb2Ygbm93IHRoZXJlIGFyZSBubyB1c2UgY2FzZXNcbiAqIG9mIEFNUCBkb2NzIHRoYXQgd291bGQgZXZlciBwYXJzZSBhbiBhY3R1YWwgbGFyZ2UgbnVtYmVyIG9mIFVSTHMsXG4gKiBidXQgd2Ugb2Z0ZW4gcGFyc2UgdGhlIHNhbWUgb25lIG92ZXIgYW5kIG92ZXIgYWdhaW4uXG4gKiBAdHlwZSB7THJ1Q2FjaGV9XG4gKi9cbmxldCBjYWNoZTtcblxuLyoqIEBwcml2YXRlIEBjb25zdCBNYXRjaGVzIGFtcF9qc18qIHBhcmFtZXRlcnMgaW4gcXVlcnkgc3RyaW5nLiAqL1xuY29uc3QgQU1QX0pTX1BBUkFNU19SRUdFWCA9IC9bPyZdYW1wX2pzW14mXSovO1xuXG4vKiogQHByaXZhdGUgQGNvbnN0IE1hdGNoZXMgYW1wX2dzYSBwYXJhbWV0ZXJzIGluIHF1ZXJ5IHN0cmluZy4gKi9cbmNvbnN0IEFNUF9HU0FfUEFSQU1TX1JFR0VYID0gL1s/Jl1hbXBfZ3NhW14mXSovO1xuXG4vKiogQHByaXZhdGUgQGNvbnN0IE1hdGNoZXMgYW1wX3IgcGFyYW1ldGVycyBpbiBxdWVyeSBzdHJpbmcuICovXG5jb25zdCBBTVBfUl9QQVJBTVNfUkVHRVggPSAvWz8mXWFtcF9yW14mXSovO1xuXG4vKiogQHByaXZhdGUgQGNvbnN0IE1hdGNoZXMgdXNxcCBwYXJhbWV0ZXJzIGZyb20gZ29vZyBleHBlcmltZW50IGluIHF1ZXJ5IHN0cmluZy4gKi9cbmNvbnN0IEdPT0dMRV9FWFBFUklNRU5UX1BBUkFNU19SRUdFWCA9IC9bPyZddXNxcFteJl0qLztcblxuY29uc3QgSU5WQUxJRF9QUk9UT0NPTFMgPSBbXG4gIC8qZXNsaW50IG5vLXNjcmlwdC11cmw6IDAqLyAnamF2YXNjcmlwdDonLFxuICAvKmVzbGludCBuby1zY3JpcHQtdXJsOiAwKi8gJ2RhdGE6JyxcbiAgLyplc2xpbnQgbm8tc2NyaXB0LXVybDogMCovICd2YnNjcmlwdDonLFxuXTtcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuZXhwb3J0IGNvbnN0IFNPVVJDRV9PUklHSU5fUEFSQU0gPSAnX19hbXBfc291cmNlX29yaWdpbic7XG5cbi8qKlxuICogUmV0dXJucyB0aGUgY29ycmVjdCBvcmlnaW4gZm9yIGEgZ2l2ZW4gd2luZG93LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge3N0cmluZ30gb3JpZ2luXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRXaW5PcmlnaW4od2luKSB7XG4gIHJldHVybiB3aW4ub3JpZ2luIHx8IHBhcnNlVXJsRGVwcmVjYXRlZCh3aW4ubG9jYXRpb24uaHJlZikub3JpZ2luO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBMb2NhdGlvbi1saWtlIG9iamVjdCBmb3IgdGhlIGdpdmVuIFVSTC4gSWYgaXQgaXMgcmVsYXRpdmUsXG4gKiB0aGUgVVJMIGdldHMgcmVzb2x2ZWQuXG4gKiBDb25zaWRlciB0aGUgcmV0dXJuZWQgb2JqZWN0IGltbXV0YWJsZS4gVGhpcyBpcyBlbmZvcmNlZCBkdXJpbmdcbiAqIHRlc3RpbmcgYnkgZnJlZXppbmcgdGhlIG9iamVjdC5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9ub2NhY2hlXG4gKiBAcmV0dXJuIHshTG9jYXRpb259XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVVybERlcHJlY2F0ZWQodXJsLCBvcHRfbm9jYWNoZSkge1xuICBpZiAoIWEpIHtcbiAgICBhID0gLyoqIEB0eXBlIHshSFRNTEFuY2hvckVsZW1lbnR9ICovIChzZWxmLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKSk7XG4gICAgY2FjaGUgPSBzZWxmLlVybENhY2hlIHx8IChzZWxmLlVybENhY2hlID0gbmV3IExydUNhY2hlKDEwMCkpO1xuICB9XG5cbiAgcmV0dXJuIHBhcnNlVXJsV2l0aEEoYSwgdXJsLCBvcHRfbm9jYWNoZSA/IG51bGwgOiBjYWNoZSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIExvY2F0aW9uLWxpa2Ugb2JqZWN0IGZvciB0aGUgZ2l2ZW4gVVJMLiBJZiBpdCBpcyByZWxhdGl2ZSxcbiAqIHRoZSBVUkwgZ2V0cyByZXNvbHZlZC5cbiAqIENvbnNpZGVyIHRoZSByZXR1cm5lZCBvYmplY3QgaW1tdXRhYmxlLiBUaGlzIGlzIGVuZm9yY2VkIGR1cmluZ1xuICogdGVzdGluZyBieSBmcmVlemluZyB0aGUgb2JqZWN0LlxuICogQHBhcmFtIHshSFRNTEFuY2hvckVsZW1lbnR9IGFcbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7THJ1Q2FjaGU9fSBvcHRfY2FjaGVcbiAqIEByZXR1cm4geyFMb2NhdGlvbn1cbiAqIEByZXN0cmljdGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVVybFdpdGhBKGEsIHVybCwgb3B0X2NhY2hlKSB7XG4gIGlmIChvcHRfY2FjaGUgJiYgb3B0X2NhY2hlLmhhcyh1cmwpKSB7XG4gICAgcmV0dXJuIG9wdF9jYWNoZS5nZXQodXJsKTtcbiAgfVxuXG4gIGEuaHJlZiA9IHVybDtcblxuICAvLyBJRTExIGRvZXNuJ3QgcHJvdmlkZSBmdWxsIFVSTCBjb21wb25lbnRzIHdoZW4gcGFyc2luZyByZWxhdGl2ZSBVUkxzLlxuICAvLyBBc3NpZ25pbmcgdG8gaXRzZWxmIGFnYWluIGRvZXMgdGhlIHRyaWNrICMzNDQ5LlxuICBpZiAoIWEucHJvdG9jb2wpIHtcbiAgICBhLmhyZWYgPSBhLmhyZWY7XG4gIH1cblxuICBjb25zdCBpbmZvID0gLyoqIEB0eXBlIHshTG9jYXRpb259ICovKHtcbiAgICBocmVmOiBhLmhyZWYsXG4gICAgcHJvdG9jb2w6IGEucHJvdG9jb2wsXG4gICAgaG9zdDogYS5ob3N0LFxuICAgIGhvc3RuYW1lOiBhLmhvc3RuYW1lLFxuICAgIHBvcnQ6IGEucG9ydCA9PSAnMCcgPyAnJyA6IGEucG9ydCxcbiAgICBwYXRobmFtZTogYS5wYXRobmFtZSxcbiAgICBzZWFyY2g6IGEuc2VhcmNoLFxuICAgIGhhc2g6IGEuaGFzaCxcbiAgICBvcmlnaW46IG51bGwsIC8vIFNldCBiZWxvdy5cbiAgfSk7XG5cbiAgLy8gU29tZSBJRTExIHNwZWNpZmljIHBvbHlmaWxscy5cbiAgLy8gMSkgSUUxMSBzdHJpcHMgb3V0IHRoZSBsZWFkaW5nICcvJyBpbiB0aGUgcGF0aG5hbWUuXG4gIGlmIChpbmZvLnBhdGhuYW1lWzBdICE9PSAnLycpIHtcbiAgICBpbmZvLnBhdGhuYW1lID0gJy8nICsgaW5mby5wYXRobmFtZTtcbiAgfVxuXG4gIC8vIDIpIEZvciBVUkxzIHdpdGggaW1wbGljaXQgcG9ydHMsIElFMTEgcGFyc2VzIHRvIGRlZmF1bHQgcG9ydHMgd2hpbGVcbiAgLy8gb3RoZXIgYnJvd3NlcnMgbGVhdmUgdGhlIHBvcnQgZmllbGQgZW1wdHkuXG4gIGlmICgoaW5mby5wcm90b2NvbCA9PSAnaHR0cDonICYmIGluZm8ucG9ydCA9PSA4MClcbiAgICAgIHx8IChpbmZvLnByb3RvY29sID09ICdodHRwczonICYmIGluZm8ucG9ydCA9PSA0NDMpKSB7XG4gICAgaW5mby5wb3J0ID0gJyc7XG4gICAgaW5mby5ob3N0ID0gaW5mby5ob3N0bmFtZTtcbiAgfVxuXG4gIC8vIEZvciBkYXRhIFVSSSBhLm9yaWdpbiBpcyBlcXVhbCB0byB0aGUgc3RyaW5nICdudWxsJyB3aGljaCBpcyBub3QgdXNlZnVsLlxuICAvLyBXZSBpbnN0ZWFkIHJldHVybiB0aGUgYWN0dWFsIG9yaWdpbiB3aGljaCBpcyB0aGUgZnVsbCBVUkwuXG4gIGlmIChhLm9yaWdpbiAmJiBhLm9yaWdpbiAhPSAnbnVsbCcpIHtcbiAgICBpbmZvLm9yaWdpbiA9IGEub3JpZ2luO1xuICB9IGVsc2UgaWYgKGluZm8ucHJvdG9jb2wgPT0gJ2RhdGE6JyB8fCAhaW5mby5ob3N0KSB7XG4gICAgaW5mby5vcmlnaW4gPSBpbmZvLmhyZWY7XG4gIH0gZWxzZSB7XG4gICAgaW5mby5vcmlnaW4gPSBpbmZvLnByb3RvY29sICsgJy8vJyArIGluZm8uaG9zdDtcbiAgfVxuXG4gIC8vIEZyZWV6ZSBkdXJpbmcgdGVzdGluZyB0byBhdm9pZCBhY2NpZGVudGFsIG11dGF0aW9uLlxuICBjb25zdCBmcm96ZW4gPSAoZ2V0TW9kZSgpLnRlc3QgJiYgT2JqZWN0LmZyZWV6ZSkgPyBPYmplY3QuZnJlZXplKGluZm8pIDogaW5mbztcblxuICBpZiAob3B0X2NhY2hlKSB7XG4gICAgb3B0X2NhY2hlLnB1dCh1cmwsIGZyb3plbik7XG4gIH1cblxuICByZXR1cm4gZnJvemVuO1xufVxuXG4vKipcbiAqIEFwcGVuZHMgdGhlIHN0cmluZyBqdXN0IGJlZm9yZSB0aGUgZnJhZ21lbnQgcGFydCAob3Igb3B0aW9uYWxseVxuICogdG8gdGhlIGZyb250IG9mIHRoZSBxdWVyeSBzdHJpbmcpIG9mIHRoZSBVUkwuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0ge3N0cmluZ30gcGFyYW1TdHJpbmdcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9hZGRUb0Zyb250XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcHBlbmRFbmNvZGVkUGFyYW1TdHJpbmdUb1VybCh1cmwsIHBhcmFtU3RyaW5nLFxuICBvcHRfYWRkVG9Gcm9udCkge1xuICBpZiAoIXBhcmFtU3RyaW5nKSB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxuICBjb25zdCBtYWluQW5kRnJhZ21lbnQgPSB1cmwuc3BsaXQoJyMnLCAyKTtcbiAgY29uc3QgbWFpbkFuZFF1ZXJ5ID0gbWFpbkFuZEZyYWdtZW50WzBdLnNwbGl0KCc/JywgMik7XG5cbiAgbGV0IG5ld1VybCA9IG1haW5BbmRRdWVyeVswXSArIChcbiAgICBtYWluQW5kUXVlcnlbMV1cbiAgICAgID8gKG9wdF9hZGRUb0Zyb250XG4gICAgICAgID8gYD8ke3BhcmFtU3RyaW5nfSYke21haW5BbmRRdWVyeVsxXX1gXG4gICAgICAgIDogYD8ke21haW5BbmRRdWVyeVsxXX0mJHtwYXJhbVN0cmluZ31gKVxuICAgICAgOiBgPyR7cGFyYW1TdHJpbmd9YCk7XG4gIG5ld1VybCArPSBtYWluQW5kRnJhZ21lbnRbMV0gPyBgIyR7bWFpbkFuZEZyYWdtZW50WzFdfWAgOiAnJztcbiAgcmV0dXJuIG5ld1VybDtcbn1cbi8qKlxuICogQXBwZW5kcyBhIHF1ZXJ5IHN0cmluZyBmaWVsZCBhbmQgdmFsdWUgdG8gYSB1cmwuIGBrZXlgIGFuZCBgdmFsdWVgXG4gKiB3aWxsIGJlIHJhbiB0aHJvdWdoIGBlbmNvZGVVUklDb21wb25lbnRgIGJlZm9yZSBhcHBlbmRpbmcuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5XG4gKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9hZGRUb0Zyb250XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGRQYXJhbVRvVXJsKHVybCwga2V5LCB2YWx1ZSwgb3B0X2FkZFRvRnJvbnQpIHtcbiAgY29uc3QgZmllbGQgPSBgJHtlbmNvZGVVUklDb21wb25lbnQoa2V5KX09JHtlbmNvZGVVUklDb21wb25lbnQodmFsdWUpfWA7XG4gIHJldHVybiBhcHBlbmRFbmNvZGVkUGFyYW1TdHJpbmdUb1VybCh1cmwsIGZpZWxkLCBvcHRfYWRkVG9Gcm9udCk7XG59XG5cbi8qKlxuICogQXBwZW5kcyBxdWVyeSBzdHJpbmcgZmllbGRzIGFuZCB2YWx1ZXMgdG8gYSB1cmwuIFRoZSBgcGFyYW1zYCBvYmplY3RzJ1xuICogYGtleWBzIGFuZCBgdmFsdWVgcyB3aWxsIGJlIHRyYW5zZm9ybWVkIGludG8gcXVlcnkgc3RyaW5nIGtleXMvdmFsdWVzLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHBhcmFtIHshSnNvbk9iamVjdDxzdHJpbmcsIHN0cmluZ3whQXJyYXk8c3RyaW5nPj59IHBhcmFtc1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkUGFyYW1zVG9VcmwodXJsLCBwYXJhbXMpIHtcbiAgcmV0dXJuIGFwcGVuZEVuY29kZWRQYXJhbVN0cmluZ1RvVXJsKHVybCwgc2VyaWFsaXplUXVlcnlTdHJpbmcocGFyYW1zKSk7XG59XG5cbi8qKlxuICogU2VyaWFsaXplcyB0aGUgcGFzc2VkIHBhcmFtZXRlciBtYXAgaW50byBhIHF1ZXJ5IHN0cmluZyB3aXRoIGJvdGgga2V5c1xuICogYW5kIHZhbHVlcyBlbmNvZGVkLlxuICogQHBhcmFtIHshSnNvbk9iamVjdDxzdHJpbmcsIHN0cmluZ3whQXJyYXk8c3RyaW5nPj59IHBhcmFtc1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2VyaWFsaXplUXVlcnlTdHJpbmcocGFyYW1zKSB7XG4gIGNvbnN0IHMgPSBbXTtcbiAgZm9yIChjb25zdCBrIGluIHBhcmFtcykge1xuICAgIGNvbnN0IHYgPSBwYXJhbXNba107XG4gICAgaWYgKHYgPT0gbnVsbCkge1xuICAgICAgY29udGludWU7XG4gICAgfSBlbHNlIGlmIChpc0FycmF5KHYpKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHYubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgc3YgPSAvKiogQHR5cGUge3N0cmluZ30gKi8gKHZbaV0pO1xuICAgICAgICBzLnB1c2goYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGspfT0ke2VuY29kZVVSSUNvbXBvbmVudChzdil9YCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHN2ID0gLyoqIEB0eXBlIHtzdHJpbmd9ICovICh2KTtcbiAgICAgIHMucHVzaChgJHtlbmNvZGVVUklDb21wb25lbnQoayl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHN2KX1gKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHMuam9pbignJicpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBVUkwgaXMgc2VjdXJlOiBlaXRoZXIgSFRUUFMgb3IgbG9jYWxob3N0IChmb3IgdGVzdGluZykuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzU2VjdXJlVXJsRGVwcmVjYXRlZCh1cmwpIHtcbiAgaWYgKHR5cGVvZiB1cmwgPT0gJ3N0cmluZycpIHtcbiAgICB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgfVxuICByZXR1cm4gKHVybC5wcm90b2NvbCA9PSAnaHR0cHM6JyB8fFxuICAgICAgdXJsLmhvc3RuYW1lID09ICdsb2NhbGhvc3QnIHx8XG4gICAgICBlbmRzV2l0aCh1cmwuaG9zdG5hbWUsICcubG9jYWxob3N0JykpO1xufVxuXG4vKipcbiAqIEFzc2VydHMgdGhhdCBhIGdpdmVuIHVybCBpcyBIVFRQUyBvciBwcm90b2NvbCByZWxhdGl2ZS4gSXQncyBhIHVzZXItbGV2ZWxcbiAqIGFzc2VydC5cbiAqXG4gKiBQcm92aWRlcyBhbiBleGNlcHRpb24gZm9yIGxvY2FsaG9zdC5cbiAqXG4gKiBAcGFyYW0gez9zdHJpbmd8dW5kZWZpbmVkfSB1cmxTdHJpbmdcbiAqIEBwYXJhbSB7IUVsZW1lbnR8c3RyaW5nfSBlbGVtZW50Q29udGV4dCBFbGVtZW50IHdoZXJlIHRoZSB1cmwgd2FzIGZvdW5kLlxuICogQHBhcmFtIHtzdHJpbmc9fSBzb3VyY2VOYW1lIFVzZWQgZm9yIGVycm9yIG1lc3NhZ2VzLlxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0SHR0cHNVcmwoXG4gIHVybFN0cmluZywgZWxlbWVudENvbnRleHQsIHNvdXJjZU5hbWUgPSAnc291cmNlJykge1xuICB1c2VyKCkuYXNzZXJ0KHVybFN0cmluZyAhPSBudWxsLCAnJXMgJXMgbXVzdCBiZSBhdmFpbGFibGUnLFxuICAgICAgZWxlbWVudENvbnRleHQsIHNvdXJjZU5hbWUpO1xuICAvLyAoZXJ3aW5tLCAjNDU2MCk6IHR5cGUgY2FzdCBuZWNlc3NhcnkgdW50aWwgIzQ1NjAgaXMgZml4ZWQuXG4gIGNvbnN0IHRoZVVybFN0cmluZyA9IC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAodXJsU3RyaW5nKTtcbiAgdXNlcigpLmFzc2VydChpc1NlY3VyZVVybERlcHJlY2F0ZWQodGhlVXJsU3RyaW5nKSB8fCAvXihcXC9cXC8pLy50ZXN0KHRoZVVybFN0cmluZyksXG4gICAgICAnJXMgJXMgbXVzdCBzdGFydCB3aXRoICcgK1xuICAgICAgJ1wiaHR0cHM6Ly9cIiBvciBcIi8vXCIgb3IgYmUgcmVsYXRpdmUgYW5kIHNlcnZlZCBmcm9tICcgK1xuICAgICAgJ2VpdGhlciBodHRwcyBvciBmcm9tIGxvY2FsaG9zdC4gSW52YWxpZCB2YWx1ZTogJXMnLFxuICAgICAgZWxlbWVudENvbnRleHQsIHNvdXJjZU5hbWUsIHRoZVVybFN0cmluZyk7XG4gIHJldHVybiB0aGVVcmxTdHJpbmc7XG59XG5cbi8qKlxuICogQXNzZXJ0cyB0aGF0IGEgZ2l2ZW4gdXJsIGlzIGFuIGFic29sdXRlIEhUVFAgb3IgSFRUUFMgVVJMLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFN0cmluZ1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0QWJzb2x1dGVIdHRwT3JIdHRwc1VybCh1cmxTdHJpbmcpIHtcbiAgdXNlcigpLmFzc2VydCgvXmh0dHBzP1xcOi9pLnRlc3QodXJsU3RyaW5nKSxcbiAgICAgICdVUkwgbXVzdCBzdGFydCB3aXRoIFwiaHR0cDovL1wiIG9yIFwiaHR0cHM6Ly9cIi4gSW52YWxpZCB2YWx1ZTogJXMnLFxuICAgICAgdXJsU3RyaW5nKTtcbiAgcmV0dXJuIHBhcnNlVXJsRGVwcmVjYXRlZCh1cmxTdHJpbmcpLmhyZWY7XG59XG5cblxuLyoqXG4gKiBQYXJzZXMgdGhlIHF1ZXJ5IHN0cmluZyBvZiBhbiBVUkwuIFRoaXMgbWV0aG9kIHJldHVybnMgYSBzaW1wbGUga2V5L3ZhbHVlXG4gKiBtYXAuIElmIHRoZXJlIGFyZSBkdXBsaWNhdGUga2V5cyB0aGUgbGF0ZXN0IHZhbHVlIGlzIHJldHVybmVkLlxuICpcbiAqIFRoaXMgZnVuY3Rpb24gaXMgaW1wbGVtZW50ZWQgaW4gYSBzZXBhcmF0ZSBmaWxlIHRvIGF2b2lkIGEgY2lyY3VsYXJcbiAqIGRlcGVuZGVuY3kuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5U3RyaW5nXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlUXVlcnlTdHJpbmcocXVlcnlTdHJpbmcpIHtcbiAgcmV0dXJuIHBhcnNlUXVlcnlTdHJpbmdfKHF1ZXJ5U3RyaW5nKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBVUkwgd2l0aG91dCBmcmFnbWVudC4gSWYgVVJMIGRvZXNuJ3QgY29udGFpbiBmcmFnbWVudCwgdGhlIHNhbWVcbiAqIHN0cmluZyBpcyByZXR1cm5lZC5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUZyYWdtZW50KHVybCkge1xuICBjb25zdCBpbmRleCA9IHVybC5pbmRleE9mKCcjJyk7XG4gIGlmIChpbmRleCA9PSAtMSkge1xuICAgIHJldHVybiB1cmw7XG4gIH1cbiAgcmV0dXJuIHVybC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGZyYWdtZW50IGZyb20gdGhlIFVSTC4gSWYgdGhlIFVSTCBkb2Vzbid0IGNvbnRhaW4gZnJhZ21lbnQsXG4gKiB0aGUgZW1wdHkgc3RyaW5nIGlzIHJldHVybmVkLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RnJhZ21lbnQodXJsKSB7XG4gIGNvbnN0IGluZGV4ID0gdXJsLmluZGV4T2YoJyMnKTtcbiAgaWYgKGluZGV4ID09IC0xKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG4gIHJldHVybiB1cmwuc3Vic3RyaW5nKGluZGV4KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgdGhlIFVSTCBoYXMgdGhlIG9yaWdpbiBvZiBhIHByb3h5LlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmwgVVJMIG9mIGFuIEFNUCBkb2N1bWVudC5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1Byb3h5T3JpZ2luKHVybCkge1xuICBpZiAodHlwZW9mIHVybCA9PSAnc3RyaW5nJykge1xuICAgIHVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICB9XG4gIHJldHVybiB1cmxzLmNkblByb3h5UmVnZXgudGVzdCh1cmwub3JpZ2luKTtcbn1cblxuLyoqXG4gKiBGb3IgcHJveHktb3JpZ2luIFVSTHMsIHJldHVybnMgdGhlIHNlcnZpbmcgdHlwZS4gT3RoZXJ3aXNlLCByZXR1cm5zIG51bGwuXG4gKiBFLmcuLCAnaHR0cHM6Ly9hbXAtY29tLmNkbi5hbXBwcm9qZWN0Lm9yZy9hL3MvYW1wLmNvbS9hbXBfZG9jdW1lbnQuaHRtbCdcbiAqIHJldHVybnMgJ2EnLlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmwgVVJMIG9mIGFuIEFNUCBkb2N1bWVudC5cbiAqIEByZXR1cm4gez9zdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcm94eVNlcnZpbmdUeXBlKHVybCkge1xuICBpZiAodHlwZW9mIHVybCA9PSAnc3RyaW5nJykge1xuICAgIHVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICB9XG4gIGlmICghaXNQcm94eU9yaWdpbih1cmwpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgcGF0aCA9IHVybC5wYXRobmFtZS5zcGxpdCgnLycsIDIpO1xuICByZXR1cm4gcGF0aFsxXTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgdGhlIFVSTCBvcmlnaW4gaXMgbG9jYWxob3N0LlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmwgVVJMIG9mIGFuIEFNUCBkb2N1bWVudC5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvY2FsaG9zdE9yaWdpbih1cmwpIHtcbiAgaWYgKHR5cGVvZiB1cmwgPT0gJ3N0cmluZycpIHtcbiAgICB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgfVxuICByZXR1cm4gdXJscy5sb2NhbGhvc3RSZWdleC50ZXN0KHVybC5vcmlnaW4pO1xufVxuXG4vKipcbiAqIFJldHVybnMgd2hldGhlciB0aGUgVVJMIGhhcyB2YWxpZCBwcm90b2NvbC5cbiAqIERlZXAgbGluayBwcm90b2NvbCBpcyB2YWxpZCwgYnV0IG5vdCBqYXZhc2NyaXB0IGV0Yy5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNQcm90b2NvbFZhbGlkKHVybCkge1xuICBpZiAoIXVybCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGlmICh0eXBlb2YgdXJsID09ICdzdHJpbmcnKSB7XG4gICAgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIH1cbiAgcmV0dXJuICFJTlZBTElEX1BST1RPQ09MUy5pbmNsdWRlcyh1cmwucHJvdG9jb2wpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBVUkwgd2l0aG91dCBBTVAgSlMgcGFyYW1ldGVycy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUFtcEpzUGFyYW1zRnJvbVVybCh1cmwpIHtcbiAgY29uc3QgcGFyc2VkID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIGNvbnN0IHNlYXJjaCA9IHJlbW92ZUFtcEpzUGFyYW1zRnJvbVNlYXJjaChwYXJzZWQuc2VhcmNoKTtcbiAgcmV0dXJuIHBhcnNlZC5vcmlnaW4gKyBwYXJzZWQucGF0aG5hbWUgKyBzZWFyY2ggKyBwYXJzZWQuaGFzaDtcblxufVxuXG4vKipcbiAqIFJldHVybnMgYSBVUkwgd2l0aG91dCBhIHF1ZXJ5IHN0cmluZy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZVNlYXJjaCh1cmwpIHtcbiAgY29uc3QgaW5kZXggPSB1cmwuaW5kZXhPZignPycpO1xuICBpZiAoaW5kZXggPT0gLTEpIHtcbiAgICByZXR1cm4gdXJsO1xuICB9XG4gIGNvbnN0IGZyYWdtZW50ID0gZ2V0RnJhZ21lbnQodXJsKTtcbiAgcmV0dXJuIHVybC5zdWJzdHJpbmcoMCwgaW5kZXgpICsgZnJhZ21lbnQ7XG59XG5cbi8qKlxuICogUmVtb3ZlcyBwYXJhbWV0ZXJzIHRoYXQgc3RhcnQgd2l0aCBhbXAganMgcGFyYW1ldGVyIHBhdHRlcm4gYW5kIHJldHVybnMgdGhlXG4gKiBuZXcgc2VhcmNoIHN0cmluZy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxTZWFyY2hcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gcmVtb3ZlQW1wSnNQYXJhbXNGcm9tU2VhcmNoKHVybFNlYXJjaCkge1xuICBpZiAoIXVybFNlYXJjaCB8fCB1cmxTZWFyY2ggPT0gJz8nKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG4gIGNvbnN0IHNlYXJjaCA9IHVybFNlYXJjaFxuICAgICAgLnJlcGxhY2UoQU1QX0pTX1BBUkFNU19SRUdFWCwgJycpXG4gICAgICAucmVwbGFjZShBTVBfR1NBX1BBUkFNU19SRUdFWCwgJycpXG4gICAgICAucmVwbGFjZShBTVBfUl9QQVJBTVNfUkVHRVgsICcnKVxuICAgICAgLnJlcGxhY2UoR09PR0xFX0VYUEVSSU1FTlRfUEFSQU1TX1JFR0VYLCAnJylcbiAgICAgIC5yZXBsYWNlKC9eWz8mXS8sICcnKTsgLy8gUmVtb3ZlcyBmaXJzdCA/IG9yICYuXG4gIHJldHVybiBzZWFyY2ggPyAnPycgKyBzZWFyY2ggOiAnJztcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBzb3VyY2UgVVJMIG9mIGFuIEFNUCBkb2N1bWVudCBmb3IgZG9jdW1lbnRzIHNlcnZlZFxuICogb24gYSBwcm94eSBvcmlnaW4gb3IgZGlyZWN0bHkuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybCBVUkwgb2YgYW4gQU1QIGRvY3VtZW50LlxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U291cmNlVXJsKHVybCkge1xuICBpZiAodHlwZW9mIHVybCA9PSAnc3RyaW5nJykge1xuICAgIHVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICB9XG5cbiAgLy8gTm90IGEgcHJveHkgVVJMIC0gcmV0dXJuIHRoZSBVUkwgaXRzZWxmLlxuICBpZiAoIWlzUHJveHlPcmlnaW4odXJsKSkge1xuICAgIHJldHVybiB1cmwuaHJlZjtcbiAgfVxuXG4gIC8vIEEgcHJveHkgVVJMLlxuICAvLyBFeGFtcGxlIHBhdGggdGhhdCBpcyBiZWluZyBtYXRjaGVkIGhlcmUuXG4gIC8vIGh0dHBzOi8vY2RuLmFtcHByb2plY3Qub3JnL2Mvcy93d3cub3JpZ2luLmNvbS9mb28vXG4gIC8vIFRoZSAvcy8gaXMgb3B0aW9uYWwgYW5kIHNpZ25hbHMgYSBzZWN1cmUgb3JpZ2luLlxuICBjb25zdCBwYXRoID0gdXJsLnBhdGhuYW1lLnNwbGl0KCcvJyk7XG4gIGNvbnN0IHByZWZpeCA9IHBhdGhbMV07XG4gIHVzZXIoKS5hc3NlcnQoU0VSVklOR19UWVBFX1BSRUZJWFtwcmVmaXhdLFxuICAgICAgJ1Vua25vd24gcGF0aCBwcmVmaXggaW4gdXJsICVzJywgdXJsLmhyZWYpO1xuICBjb25zdCBkb21haW5Pckh0dHBzU2lnbmFsID0gcGF0aFsyXTtcbiAgY29uc3Qgb3JpZ2luID0gZG9tYWluT3JIdHRwc1NpZ25hbCA9PSAncydcbiAgICA/ICdodHRwczovLycgKyBkZWNvZGVVUklDb21wb25lbnQocGF0aFszXSlcbiAgICA6ICdodHRwOi8vJyArIGRlY29kZVVSSUNvbXBvbmVudChkb21haW5Pckh0dHBzU2lnbmFsKTtcbiAgLy8gU2FuaXR5IHRlc3QgdGhhdCB3aGF0IHdlIGZvdW5kIGxvb2tzIGxpa2UgYSBkb21haW4uXG4gIHVzZXIoKS5hc3NlcnQob3JpZ2luLmluZGV4T2YoJy4nKSA+IDAsICdFeHBlY3RlZCBhIC4gaW4gb3JpZ2luICVzJywgb3JpZ2luKTtcbiAgcGF0aC5zcGxpY2UoMSwgZG9tYWluT3JIdHRwc1NpZ25hbCA9PSAncycgPyAzIDogMik7XG4gIHJldHVybiBvcmlnaW4gKyBwYXRoLmpvaW4oJy8nKSArXG4gICAgICByZW1vdmVBbXBKc1BhcmFtc0Zyb21TZWFyY2godXJsLnNlYXJjaCkgKyAodXJsLmhhc2ggfHwgJycpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHNvdXJjZSBvcmlnaW4gb2YgYW4gQU1QIGRvY3VtZW50IGZvciBkb2N1bWVudHMgc2VydmVkXG4gKiBvbiBhIHByb3h5IG9yaWdpbiBvciBkaXJlY3RseS5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsIFVSTCBvZiBhbiBBTVAgZG9jdW1lbnQuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBzb3VyY2Ugb3JpZ2luIG9mIHRoZSBVUkwuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTb3VyY2VPcmlnaW4odXJsKSB7XG4gIHJldHVybiBwYXJzZVVybERlcHJlY2F0ZWQoZ2V0U291cmNlVXJsKHVybCkpLm9yaWdpbjtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFic29sdXRlIFVSTCByZXNvbHZlZCBiYXNlZCBvbiB0aGUgcmVsYXRpdmUgVVJMIGFuZCB0aGUgYmFzZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSByZWxhdGl2ZVVybFN0cmluZ1xuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSBiYXNlVXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNvbHZlUmVsYXRpdmVVcmwocmVsYXRpdmVVcmxTdHJpbmcsIGJhc2VVcmwpIHtcbiAgaWYgKHR5cGVvZiBiYXNlVXJsID09ICdzdHJpbmcnKSB7XG4gICAgYmFzZVVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZChiYXNlVXJsKTtcbiAgfVxuICBpZiAodHlwZW9mIFVSTCA9PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIG5ldyBVUkwocmVsYXRpdmVVcmxTdHJpbmcsIGJhc2VVcmwuaHJlZikudG9TdHJpbmcoKTtcbiAgfVxuICByZXR1cm4gcmVzb2x2ZVJlbGF0aXZlVXJsRmFsbGJhY2tfKHJlbGF0aXZlVXJsU3RyaW5nLCBiYXNlVXJsKTtcbn1cblxuLyoqXG4gKiBGYWxsYmFjayBmb3IgVVJMIHJlc29sdmVyIHdoZW4gVVJMIGNsYXNzIGlzIG5vdCBhdmFpbGFibGUuXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVsYXRpdmVVcmxTdHJpbmdcbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gYmFzZVVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICogQHByaXZhdGUgVmlzaWJsZSBmb3IgdGVzdGluZy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVSZWxhdGl2ZVVybEZhbGxiYWNrXyhyZWxhdGl2ZVVybFN0cmluZywgYmFzZVVybCkge1xuICBpZiAodHlwZW9mIGJhc2VVcmwgPT0gJ3N0cmluZycpIHtcbiAgICBiYXNlVXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKGJhc2VVcmwpO1xuICB9XG4gIHJlbGF0aXZlVXJsU3RyaW5nID0gcmVsYXRpdmVVcmxTdHJpbmcucmVwbGFjZSgvXFxcXC9nLCAnLycpO1xuICBjb25zdCByZWxhdGl2ZVVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZChyZWxhdGl2ZVVybFN0cmluZyk7XG5cbiAgLy8gQWJzb2x1dGUgVVJMLlxuICBpZiAoc3RhcnRzV2l0aChyZWxhdGl2ZVVybFN0cmluZy50b0xvd2VyQ2FzZSgpLCByZWxhdGl2ZVVybC5wcm90b2NvbCkpIHtcbiAgICByZXR1cm4gcmVsYXRpdmVVcmwuaHJlZjtcbiAgfVxuXG4gIC8vIFByb3RvY29sLXJlbGF0aXZlIFVSTC5cbiAgaWYgKHN0YXJ0c1dpdGgocmVsYXRpdmVVcmxTdHJpbmcsICcvLycpKSB7XG4gICAgcmV0dXJuIGJhc2VVcmwucHJvdG9jb2wgKyByZWxhdGl2ZVVybFN0cmluZztcbiAgfVxuXG4gIC8vIEFic29sdXRlIHBhdGguXG4gIGlmIChzdGFydHNXaXRoKHJlbGF0aXZlVXJsU3RyaW5nLCAnLycpKSB7XG4gICAgcmV0dXJuIGJhc2VVcmwub3JpZ2luICsgcmVsYXRpdmVVcmxTdHJpbmc7XG4gIH1cblxuICAvLyBSZWxhdGl2ZSBwYXRoLlxuICByZXR1cm4gYmFzZVVybC5vcmlnaW4gKyBiYXNlVXJsLnBhdGhuYW1lLnJlcGxhY2UoL1xcL1teL10qJC8sICcvJylcbiAgICAgICsgcmVsYXRpdmVVcmxTdHJpbmc7XG59XG5cblxuLyoqXG4gKiBBZGQgXCJfX2FtcF9zb3VyY2Vfb3JpZ2luXCIgcXVlcnkgcGFyYW1ldGVyIHRvIHRoZSBVUkwuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29yc1VybCh3aW4sIHVybCkge1xuICBjaGVja0NvcnNVcmwodXJsKTtcbiAgY29uc3Qgc291cmNlT3JpZ2luID0gZ2V0U291cmNlT3JpZ2luKHdpbi5sb2NhdGlvbi5ocmVmKTtcbiAgcmV0dXJuIGFkZFBhcmFtVG9VcmwodXJsLCBTT1VSQ0VfT1JJR0lOX1BBUkFNLCBzb3VyY2VPcmlnaW4pO1xufVxuXG5cbi8qKlxuICogQ2hlY2tzIGlmIHRoZSB1cmwgaGFzIF9fYW1wX3NvdXJjZV9vcmlnaW4gYW5kIHRocm93cyBpZiBpdCBkb2VzLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tDb3JzVXJsKHVybCkge1xuICBjb25zdCBwYXJzZWRVcmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgY29uc3QgcXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKHBhcnNlZFVybC5zZWFyY2gpO1xuICB1c2VyKCkuYXNzZXJ0KCEoU09VUkNFX09SSUdJTl9QQVJBTSBpbiBxdWVyeSksXG4gICAgICAnU291cmNlIG9yaWdpbiBpcyBub3QgYWxsb3dlZCBpbiAlcycsIHVybCk7XG59XG5cbi8qKlxuICogVHJpZXMgdG8gZGVjb2RlIGEgVVJJIGNvbXBvbmVudCwgZmFsbGluZyBiYWNrIHRvIG9wdF9mYWxsYmFjayAob3IgYW4gZW1wdHlcbiAqIHN0cmluZylcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gY29tcG9uZW50XG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF9mYWxsYmFja1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ5RGVjb2RlVXJpQ29tcG9uZW50KGNvbXBvbmVudCwgb3B0X2ZhbGxiYWNrKSB7XG4gIHJldHVybiB0cnlEZWNvZGVVcmlDb21wb25lbnRfKGNvbXBvbmVudCwgb3B0X2ZhbGxiYWNrKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2Rldn0gZnJvbSAnLi4vbG9nJztcblxuLyoqXG4gKiBJbnRlcnByZXQgYSBieXRlIGFycmF5IGFzIGEgVVRGLTggc3RyaW5nLlxuICogQHBhcmFtIHshQnVmZmVyU291cmNlfSBieXRlc1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdXRmOERlY29kZShieXRlcykge1xuICBpZiAodHlwZW9mIFRleHREZWNvZGVyICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoJ3V0Zi04JykuZGVjb2RlKGJ5dGVzKTtcbiAgfVxuICBjb25zdCBhc2NpaVN0cmluZyA9IGJ5dGVzVG9TdHJpbmcobmV3IFVpbnQ4QXJyYXkoYnl0ZXMuYnVmZmVyIHx8IGJ5dGVzKSk7XG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGFzY2lpU3RyaW5nKSk7XG59XG5cbi8qKlxuICogVHVybiBhIHN0cmluZyBpbnRvIFVURi04IGJ5dGVzLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZ1xuICogQHJldHVybiB7IVVpbnQ4QXJyYXl9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1dGY4RW5jb2RlKHN0cmluZykge1xuICBpZiAodHlwZW9mIFRleHRFbmNvZGVyICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBuZXcgVGV4dEVuY29kZXIoJ3V0Zi04JykuZW5jb2RlKHN0cmluZyk7XG4gIH1cbiAgcmV0dXJuIHN0cmluZ1RvQnl0ZXModW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZykpKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIHN0cmluZyB3aGljaCBob2xkcyA4LWJpdCBjb2RlIHBvaW50cywgc3VjaCBhcyB0aGUgcmVzdWx0IG9mIGF0b2IsXG4gKiBpbnRvIGEgVWludDhBcnJheSB3aXRoIHRoZSBjb3JyZXNwb25kaW5nIGJ5dGVzLlxuICogSWYgeW91IGhhdmUgYSBzdHJpbmcgb2YgY2hhcmFjdGVycywgeW91IHByb2JhYmx5IHdhbnQgdG8gYmUgdXNpbmcgdXRmOEVuY29kZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcbiAqIEByZXR1cm4geyFVaW50OEFycmF5fVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RyaW5nVG9CeXRlcyhzdHIpIHtcbiAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheShzdHIubGVuZ3RoKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBjaGFyQ29kZSA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgIGRldigpLmFzc2VydChjaGFyQ29kZSA8PSAyNTUsICdDaGFyYWN0ZXJzIG11c3QgYmUgaW4gcmFuZ2UgWzAsMjU1XScpO1xuICAgIGJ5dGVzW2ldID0gY2hhckNvZGU7XG4gIH1cbiAgcmV0dXJuIGJ5dGVzO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgOC1iaXQgYnl0ZXMgYXJyYXkgaW50byBhIHN0cmluZ1xuICogQHBhcmFtIHshVWludDhBcnJheX0gYnl0ZXNcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJ5dGVzVG9TdHJpbmcoYnl0ZXMpIHtcbiAgLy8gSW50ZW50aW9uYWxseSBhdm9pZHMgU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseSBzbyB3ZSBkb24ndCBzdWZmZXIgYVxuICAvLyBzdGFjayBvdmVyZmxvdy4gIzEwNDk1LCBodHRwczovL2pzcGVyZi5jb20vYnl0ZXNUb1N0cmluZy0yXG4gIGNvbnN0IGFycmF5ID0gbmV3IEFycmF5KGJ5dGVzLmxlbmd0aCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICBhcnJheVtpXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0pO1xuICB9XG4gIHJldHVybiBhcnJheS5qb2luKCcnKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIDQtaXRlbSBieXRlIGFycmF5IHRvIGFuIHVuc2lnbmVkIGludGVnZXIuXG4gKiBBc3N1bWVzIGJ5dGVzIGFyZSBiaWcgZW5kaWFuLlxuICogQHBhcmFtIHshVWludDhBcnJheX0gYnl0ZXNcbiAqIEByZXR1cm4ge251bWJlcn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJ5dGVzVG9VSW50MzIoYnl0ZXMpIHtcbiAgaWYgKGJ5dGVzLmxlbmd0aCAhPSA0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdSZWNlaXZlZCBieXRlIGFycmF5IHdpdGggbGVuZ3RoICE9IDQnKTtcbiAgfVxuICBjb25zdCB2YWwgPSAoYnl0ZXNbMF0gJiAweEZGKSA8PCAyNCB8XG4gICAgIChieXRlc1sxXSAmIDB4RkYpIDw8IDE2IHxcbiAgICAgKGJ5dGVzWzJdICYgMHhGRikgPDwgOCB8XG4gICAgIChieXRlc1szXSAmIDB4RkYpO1xuICAvLyBDb252ZXJ0IHRvIHVuc2lnbmVkLlxuICByZXR1cm4gdmFsID4+PiAwO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIGEgcmFuZG9tIGJ5dGVzIGFycmF5IHdpdGggc3BlY2lmaWMgbGVuZ3RoIHVzaW5nXG4gKiB3aW4uY3J5cHRvLmdldFJhbmRvbVZhbHVlcy4gUmV0dXJuIG51bGwgaWYgaXQgaXMgbm90IGF2YWlsYWJsZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge251bWJlcn0gbGVuZ3RoXG4gKiBAcmV0dXJuIHs/VWludDhBcnJheX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENyeXB0b1JhbmRvbUJ5dGVzQXJyYXkod2luLCBsZW5ndGgpIHtcbiAgaWYgKCF3aW4uY3J5cHRvIHx8ICF3aW4uY3J5cHRvLmdldFJhbmRvbVZhbHVlcykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLy8gV2lkZWx5IGF2YWlsYWJsZSBpbiBicm93c2VycyB3ZSBzdXBwb3J0OlxuICAvLyBodHRwOi8vY2FuaXVzZS5jb20vI3NlYXJjaD1nZXRSYW5kb21WYWx1ZXNcbiAgY29uc3QgdWludDhhcnJheSA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7XG4gIHdpbi5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKHVpbnQ4YXJyYXkpO1xuICByZXR1cm4gdWludDhhcnJheTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2Rldn0gZnJvbSAnLi4vbG9nJztcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgVEFHID0gJ2xydS1jYWNoZSc7XG5cbi8qKlxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGNsYXNzIExydUNhY2hlIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBjYXBhY2l0eVxuICAgKi9cbiAgY29uc3RydWN0b3IoY2FwYWNpdHkpIHtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtudW1iZXJ9ICovXG4gICAgdGhpcy5jYXBhY2l0eV8gPSBjYXBhY2l0eTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMuc2l6ZV8gPSAwO1xuXG4gICAgLyoqXG4gICAgICogQW4gaW5jcmVtZW50aW5nIGNvdW50ZXIgdG8gZGVmaW5lIHRoZSBsYXN0IGFjY2Vzcy5cbiAgICAgKiBAcHJpdmF0ZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHRoaXMuYWNjZXNzXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUgeyFPYmplY3Q8KG51bWJlcnxzdHJpbmcpLCB7cGF5bG9hZDogVCwgYWNjZXNzOiBudW1iZXJ9Pn0gKi9cbiAgICB0aGlzLmNhY2hlXyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB3aGV0aGVyIGtleSBpcyBjYWNoZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30ga2V5XG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBoYXMoa2V5KSB7XG4gICAgcmV0dXJuICEhdGhpcy5jYWNoZV9ba2V5XTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IGtleVxuICAgKiBAcmV0dXJuIHtUfSBUaGUgY2FjaGVkIHBheWxvYWQuXG4gICAqL1xuICBnZXQoa2V5KSB7XG4gICAgY29uc3QgY2FjaGVhYmxlID0gdGhpcy5jYWNoZV9ba2V5XTtcbiAgICBpZiAoY2FjaGVhYmxlKSB7XG4gICAgICBjYWNoZWFibGUuYWNjZXNzID0gKyt0aGlzLmFjY2Vzc187XG4gICAgICByZXR1cm4gY2FjaGVhYmxlLnBheWxvYWQ7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSBrZXlcbiAgICogQHBhcmFtIHtUfSBwYXlsb2FkIFRoZSBwYXlsb2FkIHRvIGNhY2hlLlxuICAgKi9cbiAgcHV0KGtleSwgcGF5bG9hZCkge1xuICAgIGlmICghdGhpcy5oYXMoa2V5KSkge1xuICAgICAgdGhpcy5zaXplXysrO1xuICAgIH1cbiAgICB0aGlzLmNhY2hlX1trZXldID0ge3BheWxvYWQsIGFjY2VzczogdGhpcy5hY2Nlc3NffTtcbiAgICB0aGlzLmV2aWN0XygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEV2aWN0cyB0aGUgb2xkZXN0IGNhY2hlIGVudHJ5LCBpZiB3ZSd2ZSBleGNlZWRlZCBjYXBhY2l0eS5cbiAgICovXG4gIGV2aWN0XygpIHtcbiAgICBpZiAodGhpcy5zaXplXyA8PSB0aGlzLmNhcGFjaXR5Xykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGRldigpLndhcm4oVEFHLCAnVHJpbW1pbmcgTFJVIGNhY2hlJyk7XG4gICAgY29uc3QgY2FjaGUgPSB0aGlzLmNhY2hlXztcbiAgICBsZXQgb2xkZXN0ID0gdGhpcy5hY2Nlc3NfICsgMTtcbiAgICBsZXQgb2xkZXN0S2V5O1xuICAgIGZvciAoY29uc3Qga2V5IGluIGNhY2hlKSB7XG4gICAgICBjb25zdCB7YWNjZXNzfSA9IGNhY2hlW2tleV07XG4gICAgICBpZiAoYWNjZXNzIDwgb2xkZXN0KSB7XG4gICAgICAgIG9sZGVzdCA9IGFjY2VzcztcbiAgICAgICAgb2xkZXN0S2V5ID0ga2V5O1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvbGRlc3RLZXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZGVsZXRlIGNhY2hlW29sZGVzdEtleV07XG4gICAgICB0aGlzLnNpemVfLS07XG4gICAgfVxuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtpc09iamVjdH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKiBAY29uc3QgKi9cbmNvbnN0IGhhc093bl8gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuXG4vKipcbiAqIFJldHVybnMgYSBtYXAtbGlrZSBvYmplY3QuXG4gKiBJZiBvcHRfaW5pdGlhbCBpcyBwcm92aWRlZCwgY29waWVzIGl0cyBvd24gcHJvcGVydGllcyBpbnRvIHRoZVxuICogbmV3bHkgY3JlYXRlZCBvYmplY3QuXG4gKiBAcGFyYW0ge1Q9fSBvcHRfaW5pdGlhbCBUaGlzIHNob3VsZCB0eXBpY2FsbHkgYmUgYW4gb2JqZWN0IGxpdGVyYWwuXG4gKiBAcmV0dXJuIHtUfVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hcChvcHRfaW5pdGlhbCkge1xuICBjb25zdCBvYmogPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBpZiAob3B0X2luaXRpYWwpIHtcbiAgICBPYmplY3QuYXNzaWduKG9iaiwgb3B0X2luaXRpYWwpO1xuICB9XG4gIHJldHVybiBvYmo7XG59XG5cbi8qKlxuICogUmV0dXJuIGFuIGVtcHR5IEpzb25PYmplY3Qgb3IgbWFrZXMgdGhlIHBhc3NlZCBpbiBvYmplY3QgbGl0ZXJhbFxuICogYW4gSnNvbk9iamVjdC5cbiAqIFRoZSBKc29uT2JqZWN0IHR5cGUgaXMganVzdCBhIHNpbXBsZSBvYmplY3QgdGhhdCBpcyBhdC1kaWN0LlxuICogU2VlXG4gKiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2Nsb3N1cmUtY29tcGlsZXIvd2lraS9Ac3RydWN0LWFuZC1AZGljdC1Bbm5vdGF0aW9uc1xuICogZm9yIHdoYXQgYSBkaWN0IGlzIHR5cGUtd2lzZS5cbiAqIFRoZSBsaW50ZXIgZW5mb3JjZXMgdGhhdCB0aGUgYXJndW1lbnQgaXMsIGluIGZhY3QsIGF0LWRpY3QgbGlrZS5cbiAqIEBwYXJhbSB7IU9iamVjdD19IG9wdF9pbml0aWFsXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpY3Qob3B0X2luaXRpYWwpIHtcbiAgLy8gV2UgZG8gbm90IGNvcHkuIFRoZSBsaW50ZXIgZW5mb3JjZXMgdGhhdCB0aGUgcGFzc2VkIGluIG9iamVjdCBpcyBhIGxpdGVyYWxcbiAgLy8gYW5kIHRodXMgdGhlIGNhbGxlciBjYW5ub3QgaGF2ZSBhIHJlZmVyZW5jZSB0byBpdC5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovIChvcHRfaW5pdGlhbCB8fCB7fSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIHRoZSBnaXZlbiBrZXkgaXMgYSBwcm9wZXJ0eSBpbiB0aGUgbWFwLlxuICpcbiAqIEBwYXJhbSB7VH0gIG9iaiBhIG1hcCBsaWtlIHByb3BlcnR5LlxuICogQHBhcmFtIHtzdHJpbmd9ICBrZXlcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzT3duKG9iaiwga2V5KSB7XG4gIHJldHVybiBoYXNPd25fLmNhbGwob2JqLCBrZXkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgb2JqW2tleV0gaWZmIGtleSBpcyBvYmoncyBvd24gcHJvcGVydHkgKGlzIG5vdCBpbmhlcml0ZWQpLlxuICogT3RoZXJ3aXNlLCByZXR1cm5zIHVuZGVmaW5lZC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5XG4gKiBAcmV0dXJuIHsqfVxuICovXG5leHBvcnQgZnVuY3Rpb24gb3duUHJvcGVydHkob2JqLCBrZXkpIHtcbiAgaWYgKGhhc093bihvYmosIGtleSkpIHtcbiAgICByZXR1cm4gb2JqW2tleV07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG4vKipcbiAqIERlZXAgbWVyZ2VzIHNvdXJjZSBpbnRvIHRhcmdldC5cbiAqXG4gKiBAcGFyYW0geyFPYmplY3R9IHRhcmdldFxuICogQHBhcmFtIHshT2JqZWN0fSBzb3VyY2VcbiAqIEBwYXJhbSB7bnVtYmVyfSBkZXB0aCBUaGUgbWF4aW11bSBtZXJnZSBkZXB0aC4gSWYgZXhjZWVkZWQsIE9iamVjdC5hc3NpZ25cbiAqICAgICAgICAgICAgICAgICAgICAgICB3aWxsIGJlIHVzZWQgaW5zdGVhZC5cbiAqIEByZXR1cm4geyFPYmplY3R9XG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgc291cmNlIGNvbnRhaW5zIGEgY2lyY3VsYXIgcmVmZXJlbmNlLlxuICogTm90ZTogT25seSBuZXN0ZWQgb2JqZWN0cyBhcmUgZGVlcC1tZXJnZWQsIHByaW1pdGl2ZXMgYW5kIGFycmF5cyBhcmUgbm90LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVlcE1lcmdlKHRhcmdldCwgc291cmNlLCBkZXB0aCA9IDEwKSB7XG4gIC8vIEtlZXAgdHJhY2sgb2Ygc2VlbiBvYmplY3RzIHRvIGRldGVjdCByZWN1cnNpdmUgcmVmZXJlbmNlcy5cbiAgY29uc3Qgc2VlbiA9IFtdO1xuXG4gIC8qKiBAdHlwZSB7IUFycmF5PHt0OiAhT2JqZWN0LCBzOiAhT2JqZWN0LCBkOiBudW1iZXJ9Pn0gKi9cbiAgY29uc3QgcXVldWUgPSBbXTtcbiAgcXVldWUucHVzaCh7dDogdGFyZ2V0LCBzOiBzb3VyY2UsIGQ6IDB9KTtcblxuICAvLyBCRlMgdG8gZW5zdXJlIG9iamVjdHMgZG9uJ3QgaGF2ZSByZWN1cnNpdmUgcmVmZXJlbmNlcyBhdCBzaGFsbG93ZXIgZGVwdGhzLlxuICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IHt0LCBzLCBkfSA9IHF1ZXVlLnNoaWZ0KCk7XG4gICAgaWYgKHNlZW4uaW5jbHVkZXMocykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignU291cmNlIG9iamVjdCBoYXMgYSBjaXJjdWxhciByZWZlcmVuY2UuJyk7XG4gICAgfVxuICAgIHNlZW4ucHVzaChzKTtcbiAgICBpZiAodCA9PT0gcykge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChkID4gZGVwdGgpIHtcbiAgICAgIE9iamVjdC5hc3NpZ24odCwgcyk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgT2JqZWN0LmtleXMocykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgY29uc3QgbmV3VmFsdWUgPSBzW2tleV07XG4gICAgICAvLyBQZXJmb3JtIGEgZGVlcCBtZXJnZSBJRkYgYm90aCB0YXJnZXQgYW5kIHNvdXJjZSBoYXZlIHRoZSBzYW1lIGtleVxuICAgICAgLy8gd2hvc2UgY29ycmVzcG9uZGluZyB2YWx1ZXMgYXJlIG9iamVjdHMuXG4gICAgICBpZiAoaGFzT3duKHQsIGtleSkpIHtcbiAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0W2tleV07XG4gICAgICAgIGlmIChpc09iamVjdChuZXdWYWx1ZSkgJiYgaXNPYmplY3Qob2xkVmFsdWUpKSB7XG4gICAgICAgICAgcXVldWUucHVzaCh7dDogb2xkVmFsdWUsIHM6IG5ld1ZhbHVlLCBkOiBkICsgMX0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdFtrZXldID0gbmV3VmFsdWU7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHRhcmdldDtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFPYmplY3R9IG8gQW4gb2JqZWN0IHRvIHJlbW92ZSBwcm9wZXJ0aWVzIGZyb21cbiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHByb3BzIEEgbGlzdCBvZiBwcm9wZXJ0aWVzIHRvIHJlbW92ZSBmcm9tIHRoZSBPYmplY3RcbiAqIEByZXR1cm4geyFPYmplY3R9IEFuIG9iamVjdCB3aXRoIHRoZSBnaXZlbiBwcm9wZXJ0aWVzIHJlbW92ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9taXQobywgcHJvcHMpIHtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG8pLnJlZHVjZSgoYWNjLCBrZXkpID0+IHtcbiAgICBpZiAoIXByb3BzLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgIGFjY1trZXldID0gb1trZXldO1xuICAgIH1cbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBSZXR1cm5zIGEgRGVmZXJyZWQgc3RydWN0LCB3aGljaCBob2xkcyBhIHBlbmRpbmcgcHJvbWlzZSBhbmQgaXRzIGFzc29jaWF0ZWRcbiAqIHJlc29sdmUgYW5kIHJlamVjdCBmdW5jdGlvbnMuXG4gKlxuICogVGhpcyBpcyBwcmVmZXJyZWQgaW5zdGVhZCBvZiBjcmVhdGluZyBhIFByb21pc2UgaW5zdGFuY2UgdG8gZXh0cmFjdCB0aGVcbiAqIHJlc29sdmUvcmVqZWN0IGZ1bmN0aW9ucyB5b3Vyc2VsZjpcbiAqXG4gKiBgYGBcbiAqIC8vIEF2b2lkIGRvaW5nXG4gKiBsZXQgcmVzb2x2ZTtcbiAqIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZShyZXMgPT4ge1xuICogICByZXNvbHZlID0gcmVzO1xuICogfSk7XG4gKlxuICogLy8gR29vZFxuICogY29uc3QgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcbiAqIGNvbnN0IHsgcHJvbWlzZSwgcmVzb2x2ZSB9ID0gZGVmZXJyZWQ7XG4gKiBgYGBcbiAqXG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgY2xhc3MgRGVmZXJyZWQge1xuICAvKipcbiAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBEZWZlcnJlZC5cbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIGxldCByZXNvbHZlLCByZWplY3Q7XG5cbiAgICAvKipcbiAgICAgKiBAY29uc3QgeyFQcm9taXNlPFQ+fVxuICAgICAqL1xuICAgIHRoaXMucHJvbWlzZSA9IG5ldyAvKk9LKi9Qcm9taXNlKChyZXMsIHJlaikgPT4ge1xuICAgICAgcmVzb2x2ZSA9IHJlcztcbiAgICAgIHJlamVjdCA9IHJlajtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdCB7ZnVuY3Rpb24oVD0pfVxuICAgICAqL1xuICAgIHRoaXMucmVzb2x2ZSA9IHJlc29sdmU7XG5cbiAgICAvKipcbiAgICAgKiBAY29uc3Qge2Z1bmN0aW9uKCo9KX1cbiAgICAgKi9cbiAgICB0aGlzLnJlamVjdCA9IHJlamVjdDtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBwcm9taXNlIHJlc29sdmVkIHRvIHRoZSByZXR1cm4gdmFsdWUgb2YgZm4uXG4gKiBJZiBmbiBzeW5jIHRocm93cywgaXQgd2lsbCBjYXVzZSB0aGUgcHJvbWlzZSB0byByZWplY3QuXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbigpOlR9IGZuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTxUPn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnlSZXNvbHZlKGZuKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICByZXNvbHZlKGZuKCkpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSB3aGljaCByZXNvbHZlcyBpZiBhIHRocmVzaG9sZCBhbW91bnQgb2YgdGhlIGdpdmVuIHByb21pc2VzXG4gKiByZXNvbHZlLCBhbmQgcmVqZWN0cyBvdGhlcndpc2UuXG4gKiBAcGFyYW0geyFBcnJheTwhUHJvbWlzZT59IHByb21pc2VzIFRoZSBhcnJheSBvZiBwcm9taXNlcyB0byB0ZXN0LlxuICogQHBhcmFtIHtudW1iZXJ9IGNvdW50IFRoZSBudW1iZXIgb2YgcHJvbWlzZXMgdGhhdCBtdXN0IHJlc29sdmUgZm9yIHRoZVxuICogICAgIHJldHVybmVkIHByb21pc2UgdG8gcmVzb2x2ZS5cbiAqIEByZXR1cm4geyFQcm9taXNlfSBBIHByb21pc2UgdGhhdCByZXNvbHZlcyBpZiBhbnkgb2YgdGhlIGdpdmVuIHByb21pc2VzXG4gKiAgICAgcmVzb2x2ZSwgYW5kIHdoaWNoIHJlamVjdHMgb3RoZXJ3aXNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc29tZShwcm9taXNlcywgY291bnQgPSAxKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgY291bnQgPSBNYXRoLm1heChjb3VudCwgMCk7XG4gICAgY29uc3QgZXh0cmEgPSBwcm9taXNlcy5sZW5ndGggLSBjb3VudDtcbiAgICBpZiAoZXh0cmEgPCAwKSB7XG4gICAgICByZWplY3QobmV3IEVycm9yKCdub3QgZW5vdWdoIHByb21pc2VzIHRvIHJlc29sdmUnKSk7XG4gICAgfVxuICAgIGlmIChwcm9taXNlcy5sZW5ndGggPT0gMCkge1xuICAgICAgcmVzb2x2ZShbXSk7XG4gICAgfVxuICAgIGNvbnN0IHZhbHVlcyA9IFtdO1xuICAgIGNvbnN0IHJlYXNvbnMgPSBbXTtcblxuICAgIGNvbnN0IG9uRnVsZmlsbGVkID0gdmFsdWUgPT4ge1xuICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPCBjb3VudCkge1xuICAgICAgICB2YWx1ZXMucHVzaCh2YWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAodmFsdWVzLmxlbmd0aCA9PSBjb3VudCkge1xuICAgICAgICByZXNvbHZlKHZhbHVlcyk7XG4gICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBvblJlamVjdGVkID0gcmVhc29uID0+IHtcbiAgICAgIGlmIChyZWFzb25zLmxlbmd0aCA8PSBleHRyYSkge1xuICAgICAgICByZWFzb25zLnB1c2gocmVhc29uKTtcbiAgICAgIH1cbiAgICAgIGlmIChyZWFzb25zLmxlbmd0aCA+IGV4dHJhKSB7XG4gICAgICAgIHJlamVjdChyZWFzb25zKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvbWlzZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIFByb21pc2UucmVzb2x2ZShwcm9taXNlc1tpXSkudGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCk7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiBSZXNvbHZlcyB3aXRoIHRoZSByZXN1bHQgb2YgdGhlIGxhc3QgcHJvbWlzZSBhZGRlZC5cbiAqIEBpbXBsZW1lbnRzIHtJVGhlbmFibGV9XG4gKi9cbmV4cG9ydCBjbGFzcyBMYXN0QWRkZWRSZXNvbHZlciB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFBcnJheTwhUHJvbWlzZT49fSBvcHRfcHJvbWlzZXNcbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdF9wcm9taXNlcykge1xuICAgIGxldCByZXNvbHZlXywgcmVqZWN0XztcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshUHJvbWlzZX0gKi9cbiAgICB0aGlzLnByb21pc2VfID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgcmVzb2x2ZV8gPSByZXNvbHZlO1xuICAgICAgcmVqZWN0XyA9IHJlamVjdDtcbiAgICB9KTtcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMucmVzb2x2ZV8gPSByZXNvbHZlXztcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMucmVqZWN0XyA9IHJlamVjdF87XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICB0aGlzLmNvdW50XyA9IDA7XG5cbiAgICBpZiAob3B0X3Byb21pc2VzKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wdF9wcm9taXNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLmFkZChvcHRfcHJvbWlzZXNbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYSBwcm9taXNlIHRvIHBvc3NpYmx5IGJlIHJlc29sdmVkLlxuICAgKiBAcGFyYW0geyFQcm9taXNlfSBwcm9taXNlXG4gICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgKi9cbiAgYWRkKHByb21pc2UpIHtcbiAgICBjb25zdCBjb3VudEF0QWRkID0gKyt0aGlzLmNvdW50XztcbiAgICBQcm9taXNlLnJlc29sdmUocHJvbWlzZSkudGhlbihyZXN1bHQgPT4ge1xuICAgICAgaWYgKHRoaXMuY291bnRfID09PSBjb3VudEF0QWRkKSB7XG4gICAgICAgIHRoaXMucmVzb2x2ZV8ocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9LCBlcnJvciA9PiB7XG4gICAgICAvLyBEb24ndCBmb2xsb3cgYmVoYXZpb3Igb2YgUHJvbWlzZS5hbGwgYW5kIFByb21pc2UucmFjZSBlcnJvciBzbyB0aGF0XG4gICAgICAvLyB0aGlzIHdpbGwgb25seSByZWplY3Qgd2hlbiBtb3N0IHJlY2VudGx5IGFkZGVkIHByb21pc2UgZmFpbHMuXG4gICAgICBpZiAodGhpcy5jb3VudF8gPT09IGNvdW50QXRBZGQpIHtcbiAgICAgICAgdGhpcy5yZWplY3RfKGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5wcm9taXNlXztcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgdGhlbihvcHRfcmVzb2x2ZSwgb3B0X3JlamVjdCkge1xuICAgIHJldHVybiB0aGlzLnByb21pc2VfLnRoZW4ob3B0X3Jlc29sdmUsIG9wdF9yZWplY3QpO1xuICB9XG59XG4iLCIvKiEgaHR0cHM6Ly9tdGhzLmJlL2Nzc2VzY2FwZSB2MS41LjEgYnkgQG1hdGhpYXMgfCBNSVQgbGljZW5zZSAqL1xuXG5cbi8qKlxuICogVGhpcyByZWdleCBjb25zaXN0cyBvZiA0IG1hdGNoaW5nIGNhcHR1cmUgZ3JvdXBzIGFuZCBvbmUgKG5vbi1tYXRjaGluZykgZmFsbGJhY2s6XG4gKlxuICogLSAoXFwwKSwgY2F0Y2ggdGhlIG51bGwgdGVybWluYXRvciBjaGFyYWN0ZXIgc28gaXQgbWF5IGJlIHJlcGxhY2VkIGJ5IFVURlxuICogICBSZXBsYWNlbWVudCBDaGFyXG4gKiAtIF4oLSkkLCBjYXRjaCBhIHNvbGl0YXJ5IGRhc2ggY2hhciwgc28gdGhhdCBpdCBtYXkgYmUgYmFja3NsYXNoIGVzY2FwZWQuXG4gKiAgIFRoaXMgaXMgYSBzZXBhcmF0ZSBjYXB0dXJlIGdyb3VwIHNvIHRoYXQgdGhlIGxlZ2FsLWNoYXJzIChncm91cCA0KSBkb2Vzbid0XG4gKiAgIGNhcHR1cmUgaXQgZmlyc3QsIHNpbmNlIHRoYXQgZ3JvdXAgZG9lc24ndCBuZWVkIHRvIGVzY2FwZSBpdHMgZGFzaC5cbiAqIC0gKFtcXHgwMS1cXHgxZlxceDdmXXxeLT9bMC05XSksIGNhdGNoIGEgVVRGIGNvbnRyb2wgY2hhciwgb3IgYW55IGxlYWRpbmdcbiAqICAgbnVtYmVyICh3aXRoIGFuIG9wdGlvbmFsIGxlYWRpbmcgZGFzaCkuIFRoZSBjb250cm9sIG9yIHRoZSBudW1iZXIgKGJ1dCBub3RcbiAqICAgdGhlIGxlYWRpbmcgZGFzaCkgbXVzdCBiZSBoZXgtZXNjYXBlZCwuXG4gKiAtIChbXFx4ODAtXFx1ZmZmZjAtOWEtekEtWl8tXSspLCBjYXRjaCBsZWdhbC1jaGFycywgd2l0aCB0aGUgZXhjZXB0aW9uIG9mIGFcbiAqICAgc29saXRhcnkgZGFzaCwgd2hpY2ggd2lsbCBhbHJlYWR5IGhhdmUgbWF0Y2hlZCBpbiBncm91cCAxLlxuICogLSBbXl0sIGZpbmFsbHksIGEgY2F0Y2gtYWxsIHRoYXQgYWxsb3dzIHVzIHRvIGJhY2tzbGFzaCBlc2NhcGUgdGhlIGNoYXIuXG4gKlxuICogVG9nZXRoZXIsIHRoaXMgbWF0Y2hlcyBldmVyeXRoaW5nIG5lY2Vzc2FyeSBmb3IgQ1NTLmVzY2FwZS5cbiAqL1xudmFyIHJlZ2V4ID0gLyhcXDApfF4oLSkkfChbXFx4MDEtXFx4MWZcXHg3Zl18Xi0/WzAtOV0pfChbXFx4ODAtXFx1ZmZmZjAtOWEtekEtWl8tXSspfFteXS9nO1xuXG5mdW5jdGlvbiBlc2NhcGVyKG1hdGNoLCBuaWwsIGRhc2gsIGhleEVzY2FwZSwgY2hhcnMpIHtcbiAgLy8gQ2hhcnMgaXMgdGhlIGxlZ2FsLWNoYXJzIChncm91cCA0KSBjYXB0dXJlXG4gIGlmIChjaGFycykge1xuICAgIHJldHVybiBjaGFycztcbiAgfVxuICAvLyBOaWwgaXMgdGhlIG51bGwgdGVybWluYXRvciAoZ3JvdXAgMSkgY2FwdHVyZVxuICBpZiAobmlsKSB7XG4gICAgcmV0dXJuICdcXHVGRkZEJztcbiAgfVxuICAvLyBCb3RoIFVURiBjb250cm9sIGNoYXJzLCBhbmQgbGVhZGluZyBudW1iZXJzICh3aXRoIG9wdGlvbmFsIGxlYWRpbmcgZGFzaClcbiAgLy8gKGdyb3VwIDMpIG11c3QgYmUgYmFja3NsYXNoIGVzY2FwZWQgd2l0aCBhIHRyYWlsaW5nIHNwYWNlLiAgRnVubmlseSwgdGhlXG4gIC8vIGxlYWRpbmcgZGFzaCBtdXN0IG5vdCBiZSBlc2NhcGVkLCBidXQgdGhlIG51bWJlci4gOnNocnVnOlxuICBpZiAoaGV4RXNjYXBlKSB7XG4gICAgcmV0dXJuIG1hdGNoLnNsaWNlKDAsIC0xKSArICdcXFxcJyArIG1hdGNoLnNsaWNlKC0xKS5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KSArICcgJ1xuICB9XG4gIC8vIEZpbmFsbHksIHRoZSBzb2xpdGFyeSBkYXNoIGFuZCB0aGUgY2F0Y2gtYWxsIGNoYXJzIHJlcXVpcmUgYmFja3NsYXNoXG4gIC8vIGVzY2FwaW5nLlxuICByZXR1cm4gJ1xcXFwnICsgbWF0Y2g7XG59XG5cbi8qKlxuICogaHR0cHM6Ly9kcmFmdHMuY3Nzd2cub3JnL2Nzc29tLyNzZXJpYWxpemUtYW4taWRlbnRpZmllclxuICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjc3NFc2NhcGUodmFsdWUpIHtcbiAgcmV0dXJuIFN0cmluZyh2YWx1ZSkucmVwbGFjZShyZWdleCwgZXNjYXBlcik7XG59XG4iXX0="}