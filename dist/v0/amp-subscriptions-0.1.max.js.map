{"version":3,"sources":["node_modules/browser-pack/_prelude.js","build/amp-subscriptions-0.1.css.js","extensions/amp-access/0.1/access-expr-impl.js","extensions/amp-access/0.1/access-expr.js","extensions/amp-access/0.1/jwt.js","extensions/amp-access/0.1/login-dialog.js","extensions/amp-subscriptions/0.1/actions.js","extensions/amp-subscriptions/0.1/amp-subscriptions.js","extensions/amp-subscriptions/0.1/analytics.js","extensions/amp-subscriptions/0.1/dialog.js","extensions/amp-subscriptions/0.1/doc-impl.js","extensions/amp-subscriptions/0.1/entitlement.js","extensions/amp-subscriptions/0.1/expr.js","extensions/amp-subscriptions/0.1/local-subscription-platform-renderer.js","extensions/amp-subscriptions/0.1/local-subscription-platform.js","extensions/amp-subscriptions/0.1/platform-store.js","extensions/amp-subscriptions/0.1/renderer.js","extensions/amp-subscriptions/0.1/service-adapter.js","extensions/amp-subscriptions/0.1/subscription-platform.js","extensions/amp-subscriptions/0.1/url-builder.js","extensions/amp-subscriptions/0.1/viewer-subscription-platform.js","extensions/amp-subscriptions/0.1/viewer-tracker.js","node_modules/document-register-element/build/document-register-element.patched.js","node_modules/promise-pjs/promise.js","src/amp-events.js","src/analytics.js","src/config.js","src/cookies.js","src/dom.js","src/element-service.js","src/error.js","src/event-helper-listen.js","src/event-helper.js","src/experiments.js","src/exponential-backoff.js","src/json.js","src/log.js","src/mode-object.js","src/mode.js","src/observable.js","src/polyfills.js","src/polyfills/array-includes.js","src/polyfills/custom-elements.js","src/polyfills/document-contains.js","src/polyfills/domtokenlist-toggle.js","src/polyfills/math-sign.js","src/polyfills/object-assign.js","src/polyfills/promise.js","src/render-delaying-services.js","src/service.js","src/services.js","src/string.js","src/style-installer.js","src/style.js","src/types.js","src/url-parse-query-string.js","src/url-try-decode-uri-component.js","src/url.js","src/utils/base64.js","src/utils/bytes.js","src/utils/lru-cache.js","src/utils/object.js","src/utils/pem.js","src/utils/promise.js","third_party/css-escape/css-escape.js","third_party/subscriptions-project/config.js"],"names":[],"mappings":"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AAa,SAAb,EAAL,EAA+B;AAC7B,mBAAO,0BAAP;AACD;AACF,SAJgB,CAAjB;;AAMA;AACA,YAAM,YAAY,OAAK,MAAL,CAAY,KAAZ,CAAkB,OAAlB,EAA2B,UAA3B,CAAlB;AACA,oBAAY,IAAZ,CAAiB;AAAA,iBAAM,OAAK,MAAL,CAAY,MAAZ,CAAmB,SAAnB,CAAN;AAAA,SAAjB;;AAEA;AACA,oBAAY,IAAZ,CAAiB,OAAK,SAAL,CAAe,QAAf,CAAwB,OAAxB,CAAjB;;AAEA;AACA,oBAAY,IAAZ,CAAiB,6BAAW,OAAK,OAAL,CAAa,WAAb,EAAX,EACb,OADa,EACJ,OADI,CAAjB;AAED,OAlBM,EAkBJ,IAlBI,CAkBC,YAAM;AACZ,oBAAY,OAAZ,CAAoB;AAAA,iBAAY,UAAZ;AAAA,SAApB;AACD,OApBM,EAoBJ,kBAAU;AACX,oBAAY,OAAZ,CAAoB;AAAA,iBAAY,UAAZ;AAAA,SAApB;AACA,cAAM,MAAN;AACD,OAvBM,CAAP;AAwBD;;;;;;;AC9HH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACn6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACngBA;;;;;;;;;;;;;;;;AAgBA;;;;AAIO,IAAM,gCAAY;AACvB,SAAO,WADgB;AAEvB,cAAY,gBAFW;AAGvB,qBAAmB,sBAHI,EAGoB;AAC3C;AACA;AACA,YAAU,cANa;AAOvB,WAAS,aAPc;AAQvB,cAAY,gBARW;AASvB,YAAU,cATa;AAUvB,SAAO;AAVgB,CAAlB;;;;;;QCKS,qB,GAAA,qB;;AAThB;;AAEA;;;;;;;AAOO,SAAS,qBAAT,CAA+B,MAA/B,EAAuC,SAAvC,EAAkD,QAAlD,EAA4D;AACjE,qBAAS,qBAAT,CAA+B,MAA/B,EAAuC,IAAvC,CAA4C,qBAAa;AACvD,QAAI,CAAC,SAAL,EAAgB;AACd;AACD;AACD,cAAU,qBAAV,CAAgC,MAAhC,EAAwC,SAAx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","file":"amp-subscriptions-0.1.max.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","export const CSS = \"body:not(.i-amphtml-subs-loading) [subscriptions-section=loading]{display:none!important}body:not(.i-amphtml-subs-grant-yes) [subscriptions-section=content]{display:none!important}body:not(.i-amphtml-subs-grant-no) [subscriptions-section=content-not-granted]{display:none!important}body.i-amphtml-subs-delegated [subscriptions-section=actions],body.i-amphtml-subs-grant-unk [subscriptions-section=actions]{display:none!important}body.i-amphtml-subs-grant-unk [subscriptions-action]{display:none!important}[subscriptions-action]:not(.i-amphtml-subs-display),[subscriptions-actions]:not(.i-amphtml-subs-display),[subscriptions-section=actions]:not(.i-amphtml-subs-display){display:none!important}amp-subscriptions-dialog{display:block!important;position:fixed!important;bottom:0!important;left:0!important;margin-left:0!important;width:100%!important;z-index:2147483641;max-height:90vh;box-sizing:border-box;opacity:1;background-image:none;background-color:#fff;box-shadow:0 0 5px 0 rgba(0,0,0,0.2);margin-bottom:0;-webkit-transition:-webkit-transform 0.3s ease-in;transition:-webkit-transform 0.3s ease-in;transition:transform 0.3s ease-in;transition:transform 0.3s ease-in,-webkit-transform 0.3s ease-in}.i-amphtml-subs-dialog-close-button{position:absolute;width:28px;height:28px;top:-28px;right:0;background-image:url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg width='13' height='13' viewBox='341 8 13 13' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%234F4F4F' d='M354 9.31L352.69 8l-5.19 5.19L342.31 8 341 9.31l5.19 5.19-5.19 5.19 1.31 1.31 5.19-5.19 5.19 5.19 1.31-1.31-5.19-5.19z' fill-rule='evenodd'/%3E%3C/svg%3E\\\");background-size:13px 13px;background-position:9px;background-color:#fff;background-repeat:no-repeat;box-shadow:0 -1px 1px 0 rgba(0,0,0,0.2);border:none;border-radius:12px 0 0 0;cursor:pointer}body:not(.i-amphtml-subs-grant-yes) .i-amphtml-subs-dialog-close-button{display:none}.i-amphtml-subs-progress{height:2px;background-color:#ccc;position:relative;margin:8px;overflow:hidden}.i-amphtml-subs-progress:after{content:\\\"\\\";background-color:#2196f3;height:2px;position:absolute;left:0;top:0;width:20%;-webkit-animation:i-amphtml-subs-loading-progress 1500ms ease-in-out infinite;animation:i-amphtml-subs-loading-progress 1500ms ease-in-out infinite}@-webkit-keyframes i-amphtml-subs-loading-progress{0%{-webkit-transform:translateX(-100%);transform:translateX(-100%)}to{-webkit-transform:translateX(500%);transform:translateX(500%)}}@keyframes i-amphtml-subs-loading-progress{0%{-webkit-transform:translateX(-100%);transform:translateX(-100%)}to{-webkit-transform:translateX(500%);transform:translateX(500%)}}@media (min-width:480px){amp-subscriptions-dialog{width:480px!important;left:-240px!important;margin-left:50vw!important}}\\n/*# sourceURL=/extensions/amp-subscriptions/0.1/amp-subscriptions.css*/\";\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/** @fileoverview @suppress {checkTypes, suspiciousCode, uselessCode} */\n\n/* parser generated by jison 0.4.18 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,3],$V1=[1,4],$V2=[1,18],$V3=[1,13],$V4=[1,14],$V5=[1,15],$V6=[1,16],$V7=[1,17],$V8=[1,20],$V9=[1,21],$Va=[5,6,7,10],$Vb=[5,6,7,10,15,16,17,18,19,20,21],$Vc=[5,6,7,10,15,16,17,18,19,20,21,25];\nvar parser = {trace: function trace() { },\nyy: {},\nsymbols_: {\"error\":2,\"result\":3,\"search_condition\":4,\"EOF\":5,\"OR\":6,\"AND\":7,\"NOT\":8,\"(\":9,\")\":10,\"predicate\":11,\"comparison_predicate\":12,\"truthy_predicate\":13,\"scalar_exp\":14,\"EQ\":15,\"DEQ\":16,\"NEQ\":17,\"LT\":18,\"LTE\":19,\"GT\":20,\"GTE\":21,\"atom\":22,\"field_ref\":23,\"literal\":24,\"DOT\":25,\"field_name\":26,\"NAME\":27,\"STRING\":28,\"NUMERIC\":29,\"TRUE\":30,\"FALSE\":31,\"NULL\":32,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",5:\"EOF\",6:\"OR\",7:\"AND\",8:\"NOT\",9:\"(\",10:\")\",15:\"EQ\",16:\"DEQ\",17:\"NEQ\",18:\"LT\",19:\"LTE\",20:\"GT\",21:\"GTE\",25:\"DOT\",27:\"NAME\",28:\"STRING\",29:\"NUMERIC\",30:\"TRUE\",31:\"FALSE\",32:\"NULL\"},\nproductions_: [0,[3,2],[4,3],[4,3],[4,2],[4,3],[4,1],[11,1],[11,1],[12,3],[12,3],[12,3],[12,3],[12,3],[12,3],[12,3],[13,1],[14,1],[14,1],[22,1],[23,3],[23,1],[26,1],[24,1],[24,1],[24,1],[24,1],[24,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 1:\nreturn $$[$0-1];\nbreak;\ncase 2:\nthis.$ = $$[$0-2] || $$[$0];\nbreak;\ncase 3:\nthis.$ = $$[$0-2] && $$[$0];\nbreak;\ncase 4:\nthis.$ = !$$[$0];\nbreak;\ncase 5:\nthis.$ = $$[$0-1];\nbreak;\ncase 6: case 7: case 8: case 17: case 18: case 19:\nthis.$ = $$[$0];\nbreak;\ncase 9:\nthis.$ = $$[$0-2] === $$[$0];\nbreak;\ncase 10:\nthrow new Error('\"==\" is not allowed, use \"=\"');\nbreak;\ncase 11:\nthis.$ = $$[$0-2] !== $$[$0];\nbreak;\ncase 12:\nthis.$ = typeof $$[$0-2] == typeof $$[$0] && $$[$0-2] < $$[$0];\nbreak;\ncase 13:\nthis.$ = typeof $$[$0-2] == typeof $$[$0] && $$[$0-2] <= $$[$0];\nbreak;\ncase 14:\nthis.$ = typeof $$[$0-2] == typeof $$[$0] && $$[$0-2] > $$[$0];\nbreak;\ncase 15:\nthis.$ = typeof $$[$0-2] == typeof $$[$0] && $$[$0-2] >= $$[$0];\nbreak;\ncase 16:\nthis.$ = ($$[$0] !== undefined && $$[$0] !== null\n                && $$[$0] !== '' && $$[$0] !== 0 && $$[$0] !== false);\nbreak;\ncase 20:\nthis.$ = Object.prototype.toString.call($$[$0-2]) == '[object Object]' && $$[$0-2].hasOwnProperty($$[$0]) ? $$[$0-2][$$[$0]] : null;\nbreak;\ncase 21:\nthis.$ = yy[$$[$0]] !== undefined ? yy[$$[$0]] : null;\nbreak;\ncase 22:\nthis.$ = yytext;\nbreak;\ncase 23:\nthis.$ = yytext.substring(1, yytext.length - 1);\nbreak;\ncase 24:\nthis.$ = Number(yytext);\nbreak;\ncase 25:\nthis.$ = true\nbreak;\ncase 26:\nthis.$ = false\nbreak;\ncase 27:\nthis.$ = null\nbreak;\n}\n},\ntable: [{3:1,4:2,8:$V0,9:$V1,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:$V2,28:$V3,29:$V4,30:$V5,31:$V6,32:$V7},{1:[3]},{5:[1,19],6:$V8,7:$V9},{4:22,8:$V0,9:$V1,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:$V2,28:$V3,29:$V4,30:$V5,31:$V6,32:$V7},{4:23,8:$V0,9:$V1,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:$V2,28:$V3,29:$V4,30:$V5,31:$V6,32:$V7},o($Va,[2,6]),o($Va,[2,7]),o($Va,[2,8]),o($Va,[2,16],{15:[1,24],16:[1,25],17:[1,26],18:[1,27],19:[1,28],20:[1,29],21:[1,30]}),o($Vb,[2,17]),o($Vb,[2,18],{25:[1,31]}),o($Vb,[2,19]),o($Vc,[2,21]),o($Vb,[2,23]),o($Vb,[2,24]),o($Vb,[2,25]),o($Vb,[2,26]),o($Vb,[2,27]),o($Vc,[2,22]),{1:[2,1]},{4:32,8:$V0,9:$V1,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:$V2,28:$V3,29:$V4,30:$V5,31:$V6,32:$V7},{4:33,8:$V0,9:$V1,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:$V2,28:$V3,29:$V4,30:$V5,31:$V6,32:$V7},o($Va,[2,4]),{6:$V8,7:$V9,10:[1,34]},{14:35,22:9,23:10,24:11,26:12,27:$V2,28:$V3,29:$V4,30:$V5,31:$V6,32:$V7},{14:36,22:9,23:10,24:11,26:12,27:$V2,28:$V3,29:$V4,30:$V5,31:$V6,32:$V7},{14:37,22:9,23:10,24:11,26:12,27:$V2,28:$V3,29:$V4,30:$V5,31:$V6,32:$V7},{14:38,22:9,23:10,24:11,26:12,27:$V2,28:$V3,29:$V4,30:$V5,31:$V6,32:$V7},{14:39,22:9,23:10,24:11,26:12,27:$V2,28:$V3,29:$V4,30:$V5,31:$V6,32:$V7},{14:40,22:9,23:10,24:11,26:12,27:$V2,28:$V3,29:$V4,30:$V5,31:$V6,32:$V7},{14:41,22:9,23:10,24:11,26:12,27:$V2,28:$V3,29:$V4,30:$V5,31:$V6,32:$V7},{26:42,27:$V2},o([5,6,10],[2,2],{7:$V9}),o($Va,[2,3]),o($Va,[2,5]),o($Va,[2,9]),o($Va,[2,10]),o($Va,[2,11]),o($Va,[2,12]),o($Va,[2,13]),o($Va,[2,14]),o($Va,[2,15]),o($Vc,[2,20])],\ndefaultActions: {19:[2,1]},\nparseError: function parseError(str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        var error = new Error(str);\n        error.hash = hash;\n        throw error;\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    var args = lstack.slice.call(arguments, 1);\n    var lexer = Object.create(this.lexer);\n    var sharedState = { yy: {} };\n    for (var k in this.yy) {\n        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {\n            sharedState.yy[k] = this.yy[k];\n        }\n    }\n    lexer.setInput(input, sharedState.yy);\n    sharedState.yy.lexer = lexer;\n    sharedState.yy.parser = this;\n    if (typeof lexer.yylloc == 'undefined') {\n        lexer.yylloc = {};\n    }\n    var yyloc = lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = lexer.options && lexer.options.ranges;\n    if (typeof sharedState.yy.parseError === 'function') {\n        this.parseError = sharedState.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n    _token_stack:\n        var lex = function () {\n            var token;\n            token = lexer.lex() || EOF;\n            if (typeof token !== 'number') {\n                token = self.symbols_[token] || token;\n            }\n            return token;\n        };\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n                    if (typeof action === 'undefined' || !action.length || !action[0]) {\n                var errStr = '';\n                expected = [];\n                for (p in table[state]) {\n                    if (this.terminals_[p] && p > TERROR) {\n                        expected.push('\\'' + this.terminals_[p] + '\\'');\n                    }\n                }\n                if (lexer.showPosition) {\n                    errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n                } else {\n                    errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n                }\n                this.parseError(errStr, {\n                    text: lexer.match,\n                    token: this.terminals_[symbol] || symbol,\n                    line: lexer.yylineno,\n                    loc: yyloc,\n                    expected: expected\n                });\n            }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(lexer.yytext);\n            lstack.push(lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = lexer.yyleng;\n                yytext = lexer.yytext;\n                yylineno = lexer.yylineno;\n                yyloc = lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.apply(yyval, [\n                yytext,\n                yyleng,\n                yylineno,\n                sharedState.yy,\n                action[1],\n                vstack,\n                lstack\n            ].concat(args));\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\n/* generated by jison-lex 0.3.4 */\nvar lexer = (function(){\nvar lexer = ({\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input, yy) {\n        this.yy = yy || this.yy || {};\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function (match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex() {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin(condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState() {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules() {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState(n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState(condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0:/* skip whitespace */\nbreak;\ncase 1:return 7\nbreak;\ncase 2:return 6\nbreak;\ncase 3:return 8\nbreak;\ncase 4:return 32\nbreak;\ncase 5:return 30\nbreak;\ncase 6:return 30\nbreak;\ncase 7:return 31\nbreak;\ncase 8:return 31\nbreak;\ncase 9:return 9\nbreak;\ncase 10:return 10\nbreak;\ncase 11:return '|'\nbreak;\ncase 12:return 19\nbreak;\ncase 13:return 18\nbreak;\ncase 14:return 21\nbreak;\ncase 15:return 20\nbreak;\ncase 16:return 17\nbreak;\ncase 17:return 16\nbreak;\ncase 18:return 15\nbreak;\ncase 19:return 29\nbreak;\ncase 20:return 27\nbreak;\ncase 21:return 28\nbreak;\ncase 22:return 28\nbreak;\ncase 23:return 25\nbreak;\ncase 24:return 'INVALID'\nbreak;\ncase 25:return 5\nbreak;\n}\n},\nrules: [/^(?:\\s+)/,/^(?:AND\\b)/,/^(?:OR\\b)/,/^(?:NOT\\b)/,/^(?:NULL\\b)/,/^(?:TRUE\\b)/,/^(?:true\\b)/,/^(?:FALSE\\b)/,/^(?:false\\b)/,/^(?:\\()/,/^(?:\\))/,/^(?:\\|)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:!=)/,/^(?:==)/,/^(?:=)/,/^(?:-?[0-9]+(\\.[0-9]+)?\\b)/,/^(?:[a-zA-Z_][a-zA-Z0-9_]*)/,/^(?:'[^\\']*')/,/^(?:\"[^\\\"]*\")/,/^(?:\\.)/,/^(?:.)/,/^(?:$)/],\nconditions: {\"INITIAL\":{\"rules\":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],\"inclusive\":true}}\n});\nreturn lexer;\n})();\nparser.lexer = lexer;\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\nexport const accessParser = parser;\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {accessParser as parser} from './access-expr-impl';\n\n\n/**\n * Evaluates access expression.\n *\n * The grammar is defined in the `access-expr-impl.jison` and compiled using\n * (Jison)[https://zaach.github.io/jison/] parser. The compilation steps are\n * described in the [access-expr-impl.md].\n *\n * Grammar highlights:\n * - Shorthand truthy expressions are allowed, such as `field`. Truthy value\n *   is defined as `X !== null && X !== '' && X !== 0 && X !== false`.\n * - Basic equality expressions: `X = 1`, `X = true`, `X = \"A\"`. And also,\n *   non-equality: `X != 1` and so on.\n * - Basic comparison expressions only defined for numbers: `X < 1`,\n *   `X >= 10`.\n * - Boolean logic: `X = 1 OR Y = 1`, `X = 1 AND Y = 2`, `NOT X`, `NOT (X = 1)`.\n *\n * @param {string} expr\n * @param {!JsonObject} data\n * @return {boolean}\n */\nexport function evaluateAccessExpr(expr, data) {\n  try {\n    parser.yy = data;\n    return !!parser.parse(expr);\n  } finally {\n    parser.yy = null;\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  base64UrlDecodeToBytes,\n} from '../../../src/utils/base64';\nimport {pemToBytes} from '../../../src/utils/pem';\nimport {stringToBytes, utf8Decode} from '../../../src/utils/bytes';\nimport {tryParseJson} from '../../../src/json';\n\n\n/**\n * @typedef {{\n *   header: (?JsonObject|undefined),\n *   payload: (?JsonObject|undefined),\n *   verifiable: string,\n *   sig: string,\n * }}\n */\nlet JwtTokenInternalDef;\n\n\n/**\n * Provides helper methods to decode and verify JWT tokens.\n */\nexport class JwtHelper {\n\n  /**\n   * @param {!Window} win\n   */\n  constructor(win) {\n\n    /** @const {!Window} */\n    this.win = win;\n\n    /**\n     * Might be `null` if the platform does not support Crypto Subtle.\n     * @const @private {?webCrypto.SubtleCrypto}\n     */\n    this.subtle_ = (win.crypto &&\n        (win.crypto.subtle || win.crypto.webkitSubtle)) || null;\n  }\n\n  /**\n   * Decodes JWT token and returns its payload.\n   * @param {string} encodedToken\n   * @return {?JsonObject|undefined}\n   */\n  decode(encodedToken) {\n    return this.decodeInternal_(encodedToken).payload;\n  }\n\n  /**\n   * Whether the signature-verification supported on this platform.\n   * @return {boolean}\n   */\n  isVerificationSupported() {\n    return !!this.subtle_;\n  }\n\n  /**\n   * Decodes HWT token and verifies its signature.\n   * @param {string} encodedToken\n   * @param {!Promise<string>} pemPromise\n   * @return {!Promise<!JsonObject>}\n   */\n  decodeAndVerify(encodedToken, pemPromise) {\n    if (!this.subtle_) {\n      throw new Error('Crypto is not supported on this platform');\n    }\n    const decodedPromise = new Promise(\n        resolve => resolve(this.decodeInternal_(encodedToken)));\n    return decodedPromise.then(decoded => {\n      const alg = decoded.header['alg'];\n      if (!alg || alg != 'RS256') {\n        // TODO(dvoytenko@): Support other RS* algos.\n        throw new Error('Only alg=RS256 is supported');\n      }\n      return this.importKey_(pemPromise).then(key => {\n        const sig = base64UrlDecodeToBytes(decoded.sig);\n        return this.subtle_.verify(\n            /* options */ {name: 'RSASSA-PKCS1-v1_5'},\n            key,\n            sig,\n            stringToBytes(decoded.verifiable)\n        );\n      }).then(isValid => {\n        if (isValid) {\n          return decoded.payload;\n        }\n        throw new Error('Signature verification failed');\n      });\n    });\n  }\n\n  /**\n   * @param {string} encodedToken\n   * @return {!JwtTokenInternalDef}\n   * @private\n   */\n  decodeInternal_(encodedToken) {\n    /**\n     * See https://jwt.io/introduction/\n     */\n    function invalidToken() {\n      throw new Error(`Invalid token: \"${encodedToken}\"`);\n    }\n\n    // Encoded token has three parts: header.payload.sig\n    // Note! The padding is not allowed by JWT spec:\n    // http://self-issued.info/docs/draft-goland-json-web-token-00.html#rfc.section.5\n    const parts = encodedToken.split('.');\n    if (parts.length != 3) {\n      invalidToken();\n    }\n    const headerUtf8Bytes = base64UrlDecodeToBytes(parts[0]);\n    const payloadUtf8Bytes = base64UrlDecodeToBytes(parts[1]);\n    return {\n      header: tryParseJson(utf8Decode(headerUtf8Bytes), invalidToken),\n      payload: tryParseJson(utf8Decode(payloadUtf8Bytes), invalidToken),\n      verifiable: `${parts[0]}.${parts[1]}`,\n      sig: parts[2],\n    };\n  }\n\n  /**\n   * @param {!Promise<string>} pemPromise\n   * @return {!Promise<!webCrypto.CryptoKey>}\n   */\n  importKey_(pemPromise) {\n    return pemPromise.then(pem => {\n      return this.subtle_.importKey(\n          /* format */ 'spki',\n          pemToBytes(pem),\n          /* algo options */ {\n            name: 'RSASSA-PKCS1-v1_5',\n            hash: {name: 'SHA-256'},\n          },\n          /* extractable */ false,\n          /* uses */ ['verify']);\n    });\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from '../../../src/services';\nimport {dev, user} from '../../../src/log';\nimport {dict} from '../../../src/utils/object';\nimport {getData, listen} from '../../../src/event-helper';\nimport {getMode} from '../../../src/mode';\nimport {openWindowDialog} from '../../../src/dom';\nimport {parseUrlDeprecated} from '../../../src/url';\nimport {urls} from '../../../src/config';\n\n/** @const */\nconst TAG = 'amp-access-login';\n\n/** @const {!RegExp} */\nconst RETURN_URL_REGEX = new RegExp('RETURN_URL');\n\n/**\n * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n * @param {string|!Promise<string>} urlOrPromise\n * @return {!WebLoginDialog|!ViewerLoginDialog}\n */\nexport function createLoginDialog(ampdoc, urlOrPromise) {\n  const viewer = Services.viewerForDoc(ampdoc);\n  const overrideDialog = parseInt(viewer.getParam('dialog'), 10);\n  if (overrideDialog) {\n    return new ViewerLoginDialog(viewer, urlOrPromise);\n  }\n  return new WebLoginDialog(ampdoc.win, viewer, urlOrPromise);\n}\n\n\n/**\n * Opens the login dialog for the specified URL. If the login dialog succeeds,\n * the returned promised is resolved with the dialog's response. Otherwise, the\n * returned promise is rejected.\n * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n * @param {string|!Promise<string>} urlOrPromise\n * @return {!Promise<string>}\n */\nexport function openLoginDialog(ampdoc, urlOrPromise) {\n  return createLoginDialog(ampdoc, urlOrPromise).open();\n}\n\n/**\n * Gets the final login URL with all the performed replacements.\n * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n * @param {string|!Promise<string>} urlOrPromise\n * @return {!Promise<string>}\n */\nexport function getLoginUrl(ampdoc, urlOrPromise) {\n  return createLoginDialog(ampdoc, urlOrPromise).getLoginUrl();\n}\n\n\n/**\n * The implementation of the Login Dialog delegated via Viewer.\n */\nclass ViewerLoginDialog {\n  /**\n   * @param {!../../../src/service/viewer-impl.Viewer} viewer\n   * @param {string|!Promise<string>} urlOrPromise\n   */\n  constructor(viewer, urlOrPromise) {\n    /** @const {!../../../src/service/viewer-impl.Viewer} */\n    this.viewer = viewer;\n\n    /** @const {string|!Promise<string>} */\n    this.urlOrPromise = urlOrPromise;\n  }\n\n  /**\n  * @return {!Promise<string>}\n  */\n  getLoginUrl() {\n    let urlPromise;\n    if (typeof this.urlOrPromise == 'string') {\n      urlPromise = Promise.resolve(this.urlOrPromise);\n    } else {\n      urlPromise = this.urlOrPromise;\n    }\n    return urlPromise.then(url => {\n      return buildLoginUrl(url, 'RETURN_URL');\n    });\n  }\n\n\n  /**\n   * Opens the dialog. Returns the promise that will yield with the dialog's\n   * result or will be rejected if dialog fails. The dialog's result is\n   * typically a hash string from the return URL.\n   * @return {!Promise<string>}\n   */\n  open() {\n    return this.getLoginUrl().then(loginUrl => {\n      dev().fine(TAG, 'Open viewer dialog: ', loginUrl);\n      return this.viewer.sendMessageAwaitResponse('openDialog', dict({\n        'url': loginUrl,\n      }));\n    });\n  }\n\n}\n\n\n/**\n * Web-based implementation of the Login Dialog.\n * @visibleForTesting\n */\nexport class WebLoginDialog {\n  /**\n   * @param {!Window} win\n   * @param {!../../../src/service/viewer-impl.Viewer} viewer\n   * @param {string|!Promise<string>} urlOrPromise\n   */\n  constructor(win, viewer, urlOrPromise) {\n    /** @const {!Window} */\n    this.win = win;\n\n    /** @const {!../../../src/service/viewer-impl.Viewer} */\n    this.viewer = viewer;\n\n    /** @const {string|!Promise<string>} */\n    this.urlOrPromise = urlOrPromise;\n\n    /** @private {?function(?string)} */\n    this.resolve_ = null;\n\n    /** @private {?function(*)} */\n    this.reject_ = null;\n\n    /** @private {?Window} */\n    this.dialog_ = null;\n\n    /** @private {?Promise} */\n    this.dialogReadyPromise_ = null;\n\n    /** @private {?number} */\n    this.heartbeatInterval_ = null;\n\n    /** @private {?UnlistenDef} */\n    this.messageUnlisten_ = null;\n  }\n\n  /**\n   * Opens the dialog. Returns the promise that will yield with the dialog's\n   * result or will be rejected if dialog fails.\n   * @return {!Promise<string>}\n   */\n  open() {\n    user().assert(!this.resolve_, 'Dialog already opened');\n    return new Promise((resolve, reject) => {\n      this.resolve_ = resolve;\n      this.reject_ = reject;\n      // Must always be called synchronously.\n      this.openInternal_();\n    }).then(result => {\n      this.cleanup_();\n      return result;\n    }, error => {\n      this.cleanup_();\n      throw error;\n    });\n  }\n\n  /** @private */\n  cleanup_() {\n    this.resolve_ = null;\n    this.reject_ = null;\n\n    if (this.dialog_) {\n      try {\n        this.dialog_.close();\n      } catch (e) {\n        // Ignore.\n      }\n      this.dialog_ = null;\n    }\n\n    if (this.heartbeatInterval_) {\n      this.win.clearInterval(this.heartbeatInterval_);\n      this.heartbeatInterval_ = null;\n    }\n\n    if (this.messageUnlisten_) {\n      this.messageUnlisten_();\n      this.messageUnlisten_ = null;\n    }\n  }\n\n  /**\n  * @return {!Promise<string>}\n  */\n  getLoginUrl() {\n    let urlPromise;\n    if (typeof this.urlOrPromise == 'string') {\n      urlPromise = Promise.resolve(this.urlOrPromise);\n    } else {\n      urlPromise = this.urlOrPromise;\n    }\n    return urlPromise.then(url => {\n      return buildLoginUrl(url, this.getReturnUrl_());\n    });\n  }\n\n  /** @private */\n  openInternal_() {\n    const {screen} = this.win;\n    const w = Math.floor(Math.min(700, screen.width * 0.9));\n    const h = Math.floor(Math.min(450, screen.height * 0.9));\n    const x = Math.floor((screen.width - w) / 2);\n    const y = Math.floor((screen.height - h) / 2);\n    const sizing = `height=${h},width=${w},left=${x},top=${y}`;\n    const options = `${sizing},resizable=yes,scrollbars=yes`;\n    const returnUrl = this.getReturnUrl_();\n\n    this.dialogReadyPromise_ = null;\n    if (typeof this.urlOrPromise == 'string') {\n      const loginUrl = buildLoginUrl(this.urlOrPromise, returnUrl);\n      dev().fine(TAG, 'Open dialog: ', loginUrl, returnUrl, w, h, x, y);\n      this.dialog_ = openWindowDialog(this.win, loginUrl, '_blank', options);\n      if (this.dialog_) {\n        this.dialogReadyPromise_ = Promise.resolve();\n      }\n    } else {\n      dev().fine(TAG, 'Open dialog: ', 'about:blank', returnUrl, w, h, x, y);\n      this.dialog_ = openWindowDialog(this.win, '', '_blank', options);\n      if (this.dialog_) {\n        this.dialogReadyPromise_ = this.urlOrPromise.then(url => {\n          const loginUrl = buildLoginUrl(url, returnUrl);\n          dev().fine(TAG, 'Set dialog url: ', loginUrl);\n          this.dialog_.location.replace(loginUrl);\n        }, error => {\n          throw new Error('failed to resolve url: ' + error);\n        });\n      }\n    }\n\n    if (this.dialogReadyPromise_) {\n      this.dialogReadyPromise_.then(() => {\n        this.setupDialog_(returnUrl);\n      }, error => {\n        this.loginDone_(/* result */ null, error);\n      });\n    } else {\n      this.loginDone_(/* result */ null, new Error('failed to open dialog'));\n    }\n  }\n\n  /**\n   * @param {string} returnUrl\n   * @private\n   */\n  setupDialog_(returnUrl) {\n    const returnOrigin = parseUrlDeprecated(returnUrl).origin;\n\n    this.heartbeatInterval_ = this.win.setInterval(() => {\n      if (this.dialog_.closed) {\n        this.win.clearInterval(this.heartbeatInterval_);\n        this.heartbeatInterval_ = null;\n        // Give a chance for the result to arrive, but otherwise consider the\n        // responce to be empty.\n        this.win.setTimeout(() => {\n          this.loginDone_('');\n        }, 3000);\n      }\n    }, 500);\n\n    this.messageUnlisten_ = listen(this.win, 'message', e => {\n      dev().fine(TAG, 'MESSAGE:', e);\n      if (e.origin != returnOrigin) {\n        return;\n      }\n      if (!getData(e) || getData(e)['sentinel'] != 'amp') {\n        return;\n      }\n      dev().fine(TAG, 'Received message from dialog: ', getData(e));\n      if (getData(e)['type'] == 'result') {\n        if (this.dialog_) {\n          this.dialog_./*OK*/postMessage(dict({\n            'sentinel': 'amp',\n            'type': 'result-ack',\n          }), returnOrigin);\n        }\n        this.loginDone_(getData(e)['result']);\n      }\n    });\n  }\n\n  /**\n   * @param {?string} result\n   * @param {*=} opt_error\n   * @private\n   */\n  loginDone_(result, opt_error) {\n    if (!this.resolve_) {\n      return;\n    }\n    dev().fine(TAG, 'Login done: ', result, opt_error);\n    if (opt_error) {\n      this.reject_(opt_error);\n    } else {\n      this.resolve_(result);\n    }\n    this.cleanup_();\n  }\n\n  /**\n   * @return {string}\n   * @private\n   */\n  getReturnUrl_() {\n    const currentUrl = this.viewer.getResolvedViewerUrl();\n    let returnUrl;\n    if (getMode().localDev) {\n      const loc = this.win.location;\n      returnUrl = loc.protocol + '//' + loc.host +\n          '/extensions/amp-access/0.1/amp-login-done.html';\n    } else {\n      returnUrl = `${urls.cdn}/v0/amp-login-done-0.1.html`;\n    }\n    return returnUrl + '?url=' + encodeURIComponent(currentUrl);\n  }\n}\n\n\n/**\n * @param {string} url\n * @param {string} returnUrl\n * @return {string}\n * @private\n */\nfunction buildLoginUrl(url, returnUrl) {\n  // RETURN_URL has to arrive here unreplaced by UrlReplacements for two\n  // reasons: (1) sync replacement and (2) if we need to propagate this\n  // replacement to the viewer.\n  if (RETURN_URL_REGEX.test(url)) {\n    return url.replace(RETURN_URL_REGEX, encodeURIComponent(returnUrl));\n  }\n  return url +\n      (url.indexOf('?') == -1 ? '?' : '&') +\n      'return=' + encodeURIComponent(returnUrl);\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {assertHttpsUrl} from '../../../src/url';\nimport {dev, user} from '../../../src/log';\nimport {dict} from '../../../src/utils/object';\nimport {openLoginDialog} from '../../amp-access/0.1/login-dialog';\nimport {parseQueryString} from '../../../src/url';\n\n/** @const */\nconst TAG = 'amp-subscriptions';\n\n\n/**\n */\nexport class Actions {\n\n  /**\n   * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n   * @param {!./url-builder.UrlBuilder} urlBuilder\n   * @param {!./analytics.SubscriptionAnalytics} analytics\n   * @param {!Object<string, string>} actionMap\n   */\n  constructor(ampdoc, urlBuilder, analytics, actionMap) {\n    // Check that all URLs are valid.\n    for (const k in actionMap) {\n      assertHttpsUrl(actionMap[k], `action ${k}`);\n    }\n\n    /** @private @const {!Object<string, string>} */\n    this.actionsConfig_ = actionMap;\n    /** @private @const {!Object<string, string>} */\n    this.builtActionUrlMap_ = dict();\n    /** @private @const {!./url-builder.UrlBuilder} */\n    this.urlBuilder_ = urlBuilder;\n    /** @private @const {!./analytics.SubscriptionAnalytics} */\n    this.analytics_ = analytics;\n    /** @private {?Promise} */\n    this.actionPromise_ = null;\n    /** @private {number} */\n    this.actionStartTime_ = 0;\n    /** @private @const {function(string):Promise<string>} */\n    this.openPopup_ = openLoginDialog.bind(null, ampdoc);\n\n    // Build all URLs.\n    this.build();\n  }\n\n  /**\n   * @return {?Promise<!Object<string, string>>}\n   */\n  build() {\n    if (Object.keys(this.actionsConfig_).length == 0) {\n      return null;\n    }\n    const promises = [];\n    for (const k in this.actionsConfig_) {\n      promises.push(this.urlBuilder_.buildUrl(\n          this.actionsConfig_[k], /* useAuthData */ true)\n          .then(url => {\n            this.builtActionUrlMap_[k] = url;\n          }));\n    }\n    return Promise.all(promises).then(() => {\n      return this.builtActionUrlMap_;\n    });\n  }\n\n  /**\n   * @param {string} action\n   * @return {!Promise<string>}\n   */\n  execute(action) {\n    user().assert(this.actionsConfig_[action],\n        'Action URL is not configured: %s', action);\n    // URL should always be available at this time.\n    const url = user().assert(this.builtActionUrlMap_[action],\n        'Action URL is not ready: %s', action);\n    return this.execute_(url, 'subscriptions-action-' + action);\n  }\n\n  /**\n   * @param {string} url\n   * @param {string} eventLabel\n   * @return {!Promise}\n   * @private\n   */\n  execute_(url, eventLabel) {\n    const now = Date.now();\n\n    // If action is pending, block a new one from starting for 1 second. After\n    // 1 second, however, the new action request will be allowed to proceed,\n    // given that we cannot always determine fully if the previous attempt is\n    // \"stuck\".\n    if (this.actionPromise_ && (now - this.actionStartTime_ < 1000)) {\n      return this.actionPromise_;\n    }\n\n    dev().fine(TAG, 'Start action: ', url, eventLabel);\n\n    this.analytics_.event(eventLabel + '-started');\n    const dialogPromise = this.openPopup_(url);\n    const actionPromise = dialogPromise.then(result => {\n      dev().fine(TAG, 'Action completed: ', eventLabel, result);\n      this.actionPromise_ = null;\n      const query = parseQueryString(result);\n      const s = query['success'];\n      const success = (s == 'true' || s == 'yes' || s == '1');\n      if (success) {\n        this.analytics_.event(eventLabel + '-success');\n      } else {\n        this.analytics_.event(eventLabel + '-rejected');\n      }\n      return (success || !s);\n    }).catch(reason => {\n      dev().fine(TAG, 'Action failed: ', eventLabel, reason);\n      this.analytics_.event(eventLabel + '-failed');\n      if (this.actionPromise_ == actionPromise) {\n        this.actionPromise_ = null;\n      }\n      throw reason;\n    });\n    this.actionPromise_ = actionPromise;\n    this.actionStartTime_ = now;\n    return this.actionPromise_;\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CSS} from '../../../build/amp-subscriptions-0.1.css';\nimport {Dialog} from './dialog';\nimport {DocImpl} from './doc-impl';\nimport {Entitlement} from './entitlement';\nimport {LocalSubscriptionPlatform} from './local-subscription-platform';\nimport {PageConfig, PageConfigResolver} from '../../../third_party/subscriptions-project/config';\nimport {PlatformStore} from './platform-store';\nimport {Renderer} from './renderer';\nimport {ServiceAdapter} from './service-adapter';\nimport {Services} from '../../../src/services';\nimport {SubscriptionAnalytics, SubscriptionAnalyticsEvents} from './analytics';\nimport {SubscriptionPlatform} from './subscription-platform';\nimport {ViewerSubscriptionPlatform} from './viewer-subscription-platform';\nimport {ViewerTracker} from './viewer-tracker';\nimport {dev, user} from '../../../src/log';\nimport {getMode} from '../../../src/mode';\nimport {getValueForExpr} from '../../../src/json';\nimport {getWinOrigin} from '../../../src/url';\nimport {installStylesForDoc} from '../../../src/style-installer';\nimport {tryParseJson} from '../../../src/json';\n\n/** @const */\nconst TAG = 'amp-subscriptions';\n\n/** @const */\nconst SERVICE_TIMEOUT = 3000;\n\n\n/**\n * @implements {../../amp-access/0.1/access-vars.AccessVars}\n */\nexport class SubscriptionService {\n  /**\n   * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n   */\n  constructor(ampdoc) {\n    const configElement = ampdoc.getElementById(TAG);\n\n    /** @const @private */\n    this.ampdoc_ = ampdoc;\n\n    // Install styles.\n    installStylesForDoc(ampdoc, CSS, () => {}, false, TAG);\n\n    /** @private {?Promise} */\n    this.initialized_ = null;\n\n    /** @private @const {!Renderer} */\n    this.renderer_ = new Renderer(ampdoc);\n\n    /** @private {?PageConfig} */\n    this.pageConfig_ = null;\n\n    /** @private {?JsonObject} */\n    this.platformConfig_ = null;\n\n    /** @private {?PlatformStore} */\n    this.platformStore_ = null;\n\n    /** @const @private {!Element} */\n    this.configElement_ = user().assertElement(configElement);\n\n    /** @private {!SubscriptionAnalytics} */\n    this.subscriptionAnalytics_ =\n        new SubscriptionAnalytics(this.configElement_);\n\n    /** @private {!ServiceAdapter} */\n    this.serviceAdapter_ = new ServiceAdapter(this);\n\n    /** @private {!Dialog} */\n    this.dialog_ = new Dialog(ampdoc);\n\n    /** @private {!ViewerTracker} */\n    this.viewerTracker_ = new ViewerTracker(ampdoc);\n\n    /** @private @const {!../../../src/service/viewer-impl.Viewer} */\n    this.viewer_ = Services.viewerForDoc(ampdoc);\n\n    /** @private {?Promise} */\n    this.viewTrackerPromise_ = null;\n\n    /** @const @private {!../../../src/service/timer-impl.Timer} */\n    this.timer_ = Services.timerFor(ampdoc.win);\n\n    /** @private @const {boolean} */\n    this.doesViewerProvideAuth_ = this.viewer_.hasCapability('auth');\n\n    /** @private @const {!Promise<!../../../src/service/cid-impl.Cid>} */\n    this.cid_ = Services.cidForDoc(ampdoc);\n\n    /** @private {!Object<string, ?Promise<string>>} */\n    this.readerIdPromiseMap_ = {};\n  }\n\n  /**\n   * @return {!Promise}\n   * @private\n   */\n  initialize_() {\n    if (!this.initialized_) {\n      const doc = new DocImpl(this.ampdoc_);\n      const pageConfigResolver = new PageConfigResolver(doc);\n      this.initialized_ = Promise.all([\n        this.getPlatformConfig_(),\n        pageConfigResolver.resolveConfig(),\n      ]).then(promiseValues => {\n        /** @type {!JsonObject} */\n        this.platformConfig_ = promiseValues[0];\n        /** @type {!PageConfig} */\n        this.pageConfig_ = promiseValues[1];\n      });\n    }\n    return this.initialized_;\n  }\n\n  /**\n   * @param {!JsonObject} serviceConfig\n   * @private\n   */\n  initializeLocalPlatforms_(serviceConfig) {\n    if ((serviceConfig['serviceId'] || 'local') == 'local') {\n      this.platformStore_.resolvePlatform('local',\n          new LocalSubscriptionPlatform(\n              this.ampdoc_,\n              serviceConfig,\n              this.serviceAdapter_,\n              this.subscriptionAnalytics_\n          )\n      );\n    }\n  }\n\n  /**\n   * @private\n   * @return {!Promise<!JsonObject>}\n   */\n  getPlatformConfig_() {\n    return new Promise((resolve, reject) => {\n      const rawContent = tryParseJson(this.configElement_.textContent, e => {\n        reject('Failed to parse \"amp-subscriptions\" JSON: ' + e);\n      });\n      resolve(rawContent);\n    });\n  }\n\n  /**\n   * This method registers an auto initialized subcription platform with this\n   * service.\n   *\n   * @param {string} serviceId\n   * @param {function(!JsonObject, !ServiceAdapter):!SubscriptionPlatform} subscriptionPlatformFactory\n   */\n  registerPlatform(serviceId, subscriptionPlatformFactory) {\n    return this.initialize_().then(() => {\n      if (this.doesViewerProvideAuth_) {\n        return; // External platforms should not register if viewer provides auth\n      }\n      const matchedServices = this.platformConfig_['services'].filter(\n          service => (service.serviceId || 'local') === serviceId);\n\n      const matchedServiceConfig = user().assert(matchedServices[0],\n          'No matching services for the ID found');\n\n      const subscriptionPlatform = subscriptionPlatformFactory(\n          matchedServiceConfig,\n          this.serviceAdapter_);\n\n      this.platformStore_.resolvePlatform(subscriptionPlatform.getServiceId(),\n          subscriptionPlatform);\n      this.subscriptionAnalytics_.serviceEvent(\n          SubscriptionAnalyticsEvents.PLATFORM_REGISTERED,\n          subscriptionPlatform.getServiceId()\n      );\n      this.fetchEntitlements_(subscriptionPlatform);\n    });\n  }\n\n  /**\n   * @param {boolean} grantState\n   * @private\n   */\n  processGrantState_(grantState) {\n    this.renderer_.toggleLoading(false);\n    this.renderer_.setGrantState(grantState);\n    this.viewTrackerPromise_ = this.viewerTracker_.scheduleView(2000);\n    if (grantState === false) {\n      // TODO(@prateekbh): Show UI that no eligible entitlement found\n      return;\n    }\n  }\n\n  /**\n   * @param {string} serviceId\n   * @param {!./entitlement.Entitlement} entitlement\n   * @private\n   */\n  resolveEntitlementsToStore_(serviceId, entitlement) {\n    this.platformStore_.resolveEntitlement(serviceId, entitlement);\n    this.subscriptionAnalytics_.serviceEvent(\n        SubscriptionAnalyticsEvents.ENTITLEMENT_RESOLVED,\n        serviceId\n    );\n  }\n\n  /**\n   * @param {!SubscriptionPlatform} subscriptionPlatform\n   * @return {!Promise}\n   */\n  fetchEntitlements_(subscriptionPlatform) {\n    let timeout = SERVICE_TIMEOUT;\n    if (getMode().development || getMode().localDev) {\n      timeout = SERVICE_TIMEOUT * 2;\n    }\n    return this.viewer_.whenFirstVisible().then(() => {\n      return this.timer_.timeoutPromise(\n          timeout,\n          subscriptionPlatform.getEntitlements()\n      ).then(entitlement => {\n        entitlement = entitlement || Entitlement.empty(\n            subscriptionPlatform.getServiceId());\n        this.resolveEntitlementsToStore_(subscriptionPlatform.getServiceId(),\n            entitlement);\n        return entitlement;\n      }).catch(reason => {\n        const serviceId = subscriptionPlatform.getServiceId();\n        this.platformStore_.reportPlatformFailure(serviceId);\n        throw user().createError(\n            `fetch entitlements failed for ${serviceId}`, reason\n        );\n      });\n    });\n  }\n\n  /**\n   * Starts the amp-subscription Service\n   * @return {SubscriptionService}\n   */\n  start() {\n    this.initialize_().then(() => {\n      this.subscriptionAnalytics_.event(SubscriptionAnalyticsEvents.STARTED);\n      this.renderer_.toggleLoading(true);\n\n      user().assert(this.pageConfig_, 'Page config is null');\n\n      if (this.doesViewerProvideAuth_) {\n        this.delegateAuthToViewer_();\n        this.startAuthorizationFlow_(false);\n        return;\n      } else if (this.platformConfig_['alwaysGrant']) {\n        // If service config has `alwaysGrant` key as true, publisher wants it\n        // to be open always until a sviewer decides otherwise.\n        this.processGrantState_(true);\n        return;\n      }\n\n      user().assert(this.platformConfig_['services'],\n          'Services not configured in service config');\n\n      const serviceIds = this.platformConfig_['services'].map(service =>\n        service['serviceId'] || 'local');\n\n      this.initializePlatformStore_(serviceIds);\n\n      this.platformConfig_['services'].forEach(service => {\n        this.initializeLocalPlatforms_(service);\n      });\n\n      this.platformStore_.getAvailablePlatforms().forEach(\n          subscriptionPlatform => {\n            this.fetchEntitlements_(subscriptionPlatform);\n          }\n      );\n      this.startAuthorizationFlow_();\n\n    });\n    return this;\n  }\n\n  /**\n   * Initializes the PlatformStore with the service ids.\n   * @param {!Array<string>} serviceIds\n   */\n  initializePlatformStore_(serviceIds) {\n    const fallbackEntitlement = this.platformConfig_['fallbackEntitlement'] ?\n      Entitlement.parseFromJson(this.platformConfig_['fallbackEntitlement']) :\n      Entitlement.empty('local');\n    this.platformStore_ = new PlatformStore(serviceIds,\n        this.platformConfig_['score'],\n        fallbackEntitlement);\n  }\n\n  /**\n   * Delegates authentication to viewer\n   */\n  delegateAuthToViewer_() {\n    const serviceIds = ['local'];\n    const origin = getWinOrigin(this.ampdoc_.win);\n    this.initializePlatformStore_(serviceIds);\n\n    this.platformConfig_['services'].forEach(service => {\n      if ((service['serviceId'] || 'local') == 'local') {\n        const viewerPlatform = new ViewerSubscriptionPlatform(\n            this.ampdoc_,\n            service,\n            this.serviceAdapter_,\n            origin,\n            this.subscriptionAnalytics_\n        );\n        this.platformStore_.resolvePlatform('local', viewerPlatform);\n        viewerPlatform.getEntitlements().then(entitlement => {\n          dev().assert(entitlement, 'Entitlement is null');\n          // Viewer authorization is redirected to use local platform instead.\n          this.platformStore_.resolveEntitlement('local',\n              /** @type {!./entitlement.Entitlement}*/ (entitlement));\n        });\n      }\n    });\n  }\n\n  /**\n   * @param {string} serviceId\n   * @return {!Promise<string>}\n   */\n  getReaderId(serviceId) {\n    let readerId = this.readerIdPromiseMap_[serviceId];\n    if (!readerId) {\n      const consent = Promise.resolve();\n      // Scope is kept \"amp-access\" by default to avoid unnecessary CID\n      // rotation.\n      const scope =\n          'amp-access' + (serviceId == 'local' ? '' : '-' + serviceId);\n      readerId = this.cid_.then(cid => {\n        return cid.get(\n            {scope, createCookieIfNotPresent: true},\n            consent);\n      });\n      this.readerIdPromiseMap_[serviceId] = readerId;\n    }\n    return readerId;\n  }\n\n  /**\n   * Returns the singleton Dialog instance\n   * @return {!Dialog}\n   */\n  getDialog() {\n    return this.dialog_;\n  }\n\n  /**\n   * Unblock document based on grant state and selected platform\n   * @param {boolean=} doPlatformSelection\n   * @private\n   */\n  startAuthorizationFlow_(doPlatformSelection = true) {\n    this.platformStore_.getGrantStatus().then(grantState => {\n      this.processGrantState_(grantState);\n      this.performPingback_();\n    });\n\n    if (doPlatformSelection) {\n      this.selectAndActivatePlatform_();\n    }\n  }\n\n  /** @private */\n  selectAndActivatePlatform_() {\n    const requireValuesPromise = Promise.all([\n      this.platformStore_.getGrantStatus(),\n      this.platformStore_.selectPlatform(),\n    ]);\n\n    return requireValuesPromise.then(resolvedValues => {\n      const selectedPlatform = resolvedValues[1];\n      const selectedEntitlement = this.platformStore_.getResolvedEntitlementFor(\n          selectedPlatform.getServiceId());\n\n      selectedPlatform.activate(selectedEntitlement);\n      this.subscriptionAnalytics_.serviceEvent(\n          SubscriptionAnalyticsEvents.PLATFORM_ACTIVATED,\n          selectedPlatform.getServiceId());\n      if (selectedEntitlement.granted) {\n        this.subscriptionAnalytics_.serviceEvent(\n            SubscriptionAnalyticsEvents.ACCESS_GRANTED,\n            selectedPlatform.getServiceId());\n      } else {\n        this.subscriptionAnalytics_.serviceEvent(\n            SubscriptionAnalyticsEvents.PAYWALL_ACTIVATED,\n            selectedPlatform.getServiceId());\n        this.subscriptionAnalytics_.serviceEvent(\n            SubscriptionAnalyticsEvents.ACCESS_DENIED,\n            selectedPlatform.getServiceId());\n      }\n    });\n  }\n\n  /**\n   * Performs pingback on local platform.\n   * @return {?Promise}\n   * @private\n   */\n  performPingback_() {\n    if (this.viewTrackerPromise_) {\n      return this.viewTrackerPromise_.then(() => {\n        return this.platformStore_.getGrantEntitlement();\n      }).then(grantStateEntitlement => {\n        const localPlatform = this.platformStore_.getLocalPlatform();\n        if (localPlatform.isPingbackEnabled()) {\n          localPlatform.pingback(grantStateEntitlement\n              || Entitlement.empty('local'));\n        }\n      });\n    }\n    return null;\n  }\n\n  /**\n   * Returns Page config\n   * @return {!PageConfig}\n   */\n  getPageConfig() {\n    const pageConfig = dev().assert(this.pageConfig_,\n        'Page config is not yet fetched');\n    return /** @type {!PageConfig} */(pageConfig);\n  }\n\n  /**\n   * Re authorizes a platform\n   * @param {!SubscriptionPlatform} subscriptionPlatform\n   * @return {!Promise}\n   */\n  reAuthorizePlatform(subscriptionPlatform) {\n    this.platformStore_.resetEntitlementFor(\n        subscriptionPlatform.getServiceId());\n    return this.fetchEntitlements_(subscriptionPlatform).then(() => {\n      this.subscriptionAnalytics_.serviceEvent(\n          SubscriptionAnalyticsEvents.PLATFORM_REAUTHORIZED,\n          subscriptionPlatform.getServiceId()\n      );\n      this.platformStore_.reset();\n      this.startAuthorizationFlow_();\n    });\n  }\n\n  /**\n   * Delegates an action to local platform.\n   * @param {string} action\n   * @return {!Promise<boolean>}\n   */\n  delegateActionToLocal(action) {\n    return this.delegateActionToService(action, 'local');\n  }\n\n  /**\n   * Delegates an action to specified platform.\n   * @param {string} action\n   * @param {string} serviceId\n   * @return {!Promise<boolean>}\n   */\n  delegateActionToService(action, serviceId) {\n    return new Promise(resolve => {\n      this.platformStore_.onPlatformResolves(serviceId, platform => {\n        dev().assert(platform, 'Platform is not registered');\n        this.subscriptionAnalytics_.event(\n            SubscriptionAnalyticsEvents.ACTION_DELEGATED,\n            {\n              action,\n              serviceId,\n            }\n        );\n        resolve(platform.executeAction(action));\n      });\n    });\n  }\n\n  /**\n   * Delegate UI decoration to another service.\n   * @param {!Element} element\n   * @param {string} serviceId\n   * @param {string} action\n   * @param {?JsonObject} options\n   */\n  decorateServiceAction(element, serviceId, action, options) {\n    this.platformStore_.onPlatformResolves(serviceId, platform => {\n      dev().assert(platform, 'Platform is not registered');\n      platform.decorateUI(element, action, options);\n    });\n  }\n\n  /**\n   * Evaluates platforms and select the one to be selected for login.\n   * @return {!./subscription-platform.SubscriptionPlatform}\n   */\n  selectPlatformForLogin() {\n    return this.platformStore_.selectPlatformForLogin();\n  }\n\n  /** @override from AccessVars */\n  getAccessReaderId() {\n    return this.initialize_().then(() => this.getReaderId('local'));\n  }\n\n  /** @override from AccessVars */\n  getAuthdataField(field) {\n    return this.initialize_().then(() => {\n      return this.platformStore_.getEntitlementPromiseFor('local');\n    }).then(entitlement => {\n      return getValueForExpr(entitlement.json(), field);\n    });\n  }\n}\n\n\n/** @package @VisibleForTesting */\nexport function getPlatformClassForTesting() {\n  return SubscriptionPlatform;\n}\n\n/**\n * TODO(dvoytenko): remove once compiler type checking is fixed for third_party.\n * @package @VisibleForTesting\n */\nexport function getPageConfigClassForTesting() {\n  return PageConfig;\n}\n\n\n// Register the extension services.\nAMP.extension(TAG, '0.1', function(AMP) {\n  AMP.registerServiceForDoc('subscriptions', function(ampdoc) {\n    return new SubscriptionService(ampdoc).start();\n  });\n});\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {triggerAnalyticsEvent} from '../../../src/analytics';\n\nexport const SubscriptionAnalyticsEvents = {\n  PLATFORM_ACTIVATED: 'subscriptions-platform-activated',\n  PAYWALL_ACTIVATED: 'subscriptions-paywall-activated',\n  PLATFORM_REGISTERED: 'subscriptions-platform-registered',\n  PLATFORM_REAUTHORIZED: 'subscriptions-platform-re-authorized',\n  ACTION_DELEGATED: 'subscriptions-action-delegated',\n  ENTITLEMENT_RESOLVED: 'subscriptions-entitlement-resolved',\n  STARTED: 'subscriptions-started',\n  ACCESS_GRANTED: 'subscriptions-access-granted',\n  ACCESS_DENIED: 'subscriptions-access-denied',\n};\n\nexport class SubscriptionAnalytics {\n\n  /**\n   * Creates an instance of SubscriptionAnalytics.\n   * @param {!Element} element\n   */\n  constructor(element) {\n    this.element_ = element;\n  }\n\n  /**\n   *\n   * @param {string} eventType\n   * @param {string} serviceId\n   * @param {Object<string, string>=} opt_vars\n   */\n  serviceEvent(eventType, serviceId, opt_vars) {\n    this.event(eventType, Object.assign({\n      serviceId,\n    }, opt_vars));\n  }\n\n  /**\n   *\n   * @param {string} eventType\n   * @param {Object<string, string>=} opt_vars\n   */\n  event(eventType, opt_vars) {\n    triggerAnalyticsEvent(this.element_, eventType, opt_vars || {});\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from '../../../src/services';\nimport {createElementWithAttributes} from '../../../src/dom';\nimport {setImportantStyles, toggle} from '../../../src/style';\n\n\nexport class Dialog {\n  /**\n   * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n   */\n  constructor(ampdoc) {\n    /** @private @const {!../../../src/service/ampdoc-impl.AmpDoc} */\n    this.ampdoc_ = ampdoc;\n\n    /** @private @const {!../../../src/service/vsync-impl.Vsync} */\n    this.vsync_ = Services.vsyncFor(ampdoc.win);\n\n    /** @private @const {!../../../src/service/timer-impl.Timer} */\n    this.timer_ = Services.timerFor(ampdoc.win);\n\n    /**\n     * @private @const {!../../../src/service/viewport/viewport-impl.Viewport}\n     */\n    this.viewport_ = Services.viewportForDoc(ampdoc);\n\n    /** @private {boolean} */\n    this.visible_ = false;\n\n    /** @private {?Element} */\n    this.content_ = null;\n\n    const doc = this.ampdoc_.win.document;\n\n    this.wrapper_ = createElementWithAttributes(\n        doc,\n        'amp-subscriptions-dialog', /** @type {!JsonObject} */ ({\n          'role': 'dialog',\n        }));\n\n    /** @private @const {!Element} */\n    this.closeButton_ = createElementWithAttributes(\n        doc,\n        'button', /** @type {!JsonObject} */ ({\n          'class': 'i-amphtml-subs-dialog-close-button',\n        }));\n    this.showCloseAction(false);\n    this.wrapper_.appendChild(this.closeButton_);\n    this.closeButton_.addEventListener('click', () => {\n      this.close();\n    });\n\n    // Start hidden.\n    this.ampdoc_.getBody().appendChild(this.wrapper_);\n    setImportantStyles(this.wrapper_, {\n      display: 'none',\n      transform: 'translateY(100%)',\n    });\n  }\n\n  /**\n   * @return {!Element}\n   */\n  getRoot() {\n    return this.wrapper_;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  isVisible() {\n    return this.visible_;\n  }\n\n  /**\n   * Opens the dialog with the specified content.\n   * @param {!Element} content\n   * @param {boolean=} showCloseAction\n   * @return {!Promise}\n   */\n  open(content, showCloseAction = true) {\n    if (this.content_) {\n      this.wrapper_.replaceChild(content, this.content_);\n    } else {\n      this.wrapper_.appendChild(content);\n    }\n    this.content_ = content;\n    if (this.visible_) {\n      return Promise.resolve();\n    }\n    this.visible_ = true;\n    return this.vsync_.mutatePromise(() => {\n      setImportantStyles(this.wrapper_, {\n        display: 'block',\n      });\n      this.showCloseAction(/** @type {boolean} */ (showCloseAction));\n    }).then(() => {\n      // Animate to display.\n      return this.vsync_.mutatePromise(() => {\n        setImportantStyles(this.wrapper_, {\n          transform: 'translateY(0)',\n        });\n        return this.timer_.promise(300);\n      });\n    }).then(() => {\n      // Update page layout.\n      let offsetHeight;\n      return this.vsync_.runPromise({\n        measure: () => {\n          offsetHeight = this.wrapper_./*OK*/offsetHeight;\n        },\n        mutate: () => {\n          this.viewport_.updatePaddingBottom(offsetHeight);\n        },\n      });\n    });\n  }\n\n  /**\n   * Closes the dialog.\n   * @return {!Promise}\n   */\n  close() {\n    if (!this.visible_) {\n      return Promise.resolve();\n    }\n    return this.vsync_.mutatePromise(() => {\n      setImportantStyles(this.wrapper_, {\n        transform: 'translateY(100%)',\n      });\n      return this.timer_.promise(300);\n    }).then(() => {\n      return this.vsync_.mutatePromise(() => {\n        setImportantStyles(this.wrapper_, {\n          display: 'none',\n        });\n        this.viewport_.updatePaddingBottom(0);\n        this.visible_ = false;\n      });\n    });\n  }\n\n  /**\n   * Renders or hides the \"Close\" action button. For some flows, this button\n   * should be hidden.\n   * @param {boolean} show\n   */\n  showCloseAction(show) {\n    toggle(this.closeButton_, show);\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Doc} from '../../../third_party/subscriptions-project/config';\nimport {dev} from '../../../src/log';\n\n\n/**\n * Adopts config document to ampdoc.\n * @implements {Doc}\n */\nexport class DocImpl {\n\n  /**\n   * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n   */\n  constructor(ampdoc) {\n    /** @private @const {!../../../src/service/ampdoc-impl.AmpDoc} */\n    this.ampdoc_ = ampdoc;\n  }\n\n  /** @override */\n  getWin() {\n    return this.ampdoc_.win;\n  }\n\n  /** @override */\n  getRootNode() {\n    return this.ampdoc_.getRootNode();\n  }\n\n  /** @override */\n  getRootElement() {\n    const root = this.ampdoc_.getRootNode();\n    return dev().assertElement(root.documentElement || root.body || root);\n  }\n\n  /** @override */\n  getHead() {\n    return dev().assertElement(this.ampdoc_.getHeadNode());\n  }\n\n  /** @override */\n  getBody() {\n    return this.ampdoc_.isBodyAvailable() ? this.ampdoc_.getBody() : null;\n  }\n\n  /** @override */\n  isReady() {\n    return this.ampdoc_.isReady();\n  }\n\n  /** @override */\n  whenReady() {\n    return this.ampdoc_.whenReady();\n  }\n}\n\n\n/** @package Visible for testing only. */\nexport function getDocClassForTesting() {\n  return Doc;\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {dict} from '../../../src/utils/object';\n\n/** @enum {string} */\nexport const GrantReason = {\n  'SUBSCRIBER': 'SUBSCRIBER',\n  'METERING': 'METERING',\n};\n\n/**\n * The single entitlement object.\n */\nexport class Entitlement {\n\n  /**\n   * @param {string} service\n   * @return {!Entitlement}\n   */\n  static empty(service) {\n    return new Entitlement({\n      source: '',\n      raw: '',\n      service,\n      granted: false,\n    });\n  }\n\n  /**\n   * @param {Object} input\n   * @param {string} [input.source]\n   * @param {string} [input.raw]\n   * @param {string} [input.service]\n   * @param {boolean} [input.granted]\n   * @param {?GrantReason} [input.grantReason]\n   * @param {?JsonObject} [input.dataObject]\n   */\n  constructor({source, raw = '', service, granted = false,\n    grantReason = '', dataObject}) {\n    /** @const {string} */\n    this.raw = raw;\n    /** @const {string} */\n    this.source = source;\n    /** {string} */\n    this.service = service;\n    /** @const {boolean} */\n    this.granted = granted;\n    /** @const {?string} */\n    this.grantReason = grantReason;\n    /** @const {?JsonObject} */\n    this.data = dataObject;\n  }\n\n  /**\n   * Returns json format of entitlements\n   * @return {!JsonObject}\n   */\n  json() {\n    const entitlementJson = dict({\n      'source': this.source,\n      'service': this.service,\n      'granted': this.granted,\n      'grantReason': this.grantReason,\n      'data': this.data,\n    });\n    return (entitlementJson);\n  }\n\n  /**\n   * Returns json to be used for pingback.\n   *\n   * @return {!JsonObject}\n   */\n  jsonForPingback() {\n    return /** @type {!JsonObject} */ (Object.assign({},\n        {'raw': this.raw},\n        this.json()));\n  }\n\n  /**\n   * @param {?JsonObject} json\n   * @param {?string} rawData\n   * @return {!Entitlement}\n   */\n  static parseFromJson(json, rawData = null) {\n    if (!json) {\n      json = dict();\n    }\n    const raw = rawData || JSON.stringify(json);\n    const source = json['source'] || '';\n    const granted = json['granted'] || false;\n    const grantReason = json['grantReason'];\n    const dataObject = json['data'] || null;\n    return new Entitlement({source, raw, service: '',\n      granted, grantReason, dataObject});\n  }\n\n  /**\n   * Returns if the user is a subscriber.\n   * @return {boolean}\n   */\n  isSubscriber() {\n    return this.granted && this.grantReason === GrantReason.SUBSCRIBER;\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {evaluateAccessExpr} from '../../amp-access/0.1/access-expr';\n\n\n/**\n * @param {string} expr\n * @param {!JsonObject} data\n * @return {boolean}\n */\nexport function evaluateExpr(expr, data) {\n  return evaluateAccessExpr(expr, data);\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Entitlement} from './entitlement';\nimport {Services} from '../../../src/services';\nimport {evaluateExpr} from './expr';\n\n/**\n * This implements the rendering methods for local platform.\n *\n */\nexport class LocalSubscriptionPlatformRenderer {\n\n  /**\n   * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n   * @param {!./dialog.Dialog} dialog\n   * @param {!./service-adapter.ServiceAdapter} serviceAdapter\n   */\n  constructor(ampdoc, dialog, serviceAdapter) {\n    /** @private @const */\n    this.ampdoc_ = ampdoc;\n\n    /** @private @const */\n    this.rootNode_ = ampdoc.getRootNode();\n\n    /** @private @const {!./dialog.Dialog} */\n    this.dialog_ = dialog;\n\n    /** @private @const {!../../../src/service/template-impl.Templates} */\n    this.templates_ = Services.templatesFor(ampdoc.win);\n\n    /** @private @const {!./service-adapter.ServiceAdapter} */\n    this.serviceAdapter_ = serviceAdapter;\n  }\n\n  /**\n   *\n   * @param {!JsonObject} renderState\n   */\n  render(renderState) {\n    return Promise.all([\n      this.renderActions_(renderState),\n      this.renderDialog_(/** @type {!JsonObject} */(renderState)),\n    ]);\n  }\n\n  /**\n   * @param {!JsonObject} renderState\n   */\n  renderActions_(renderState) {\n    this.renderActionsInNode_(renderState, this.rootNode_);\n  }\n\n  /**\n   * @param {!JsonObject} authResponse\n   * @return {!Promise<boolean>}\n   */\n  renderDialog_(authResponse) {\n    // Make sure the document is fully parsed.\n    return this.ampdoc_.whenReady().then(() => {\n      // Find the first matching dialog.\n      const candidates = this.ampdoc_.getRootNode()\n          .querySelectorAll('[subscriptions-dialog][subscriptions-display]');\n      for (let i = 0; i < candidates.length; i++) {\n        const candidate = candidates[i];\n        const expr = candidate.getAttribute('subscriptions-display');\n        if (expr && evaluateExpr(expr, authResponse)) {\n          return candidate;\n        }\n      }\n    }).then(candidate => {\n      if (!candidate) {\n        return;\n      }\n      if (candidate.tagName == 'TEMPLATE') {\n        return this.templates_.renderTemplate(candidate, authResponse)\n            .then(element => {\n              const renderState =\n                /** @type {!JsonObject} */(authResponse);\n              return this.renderActionsInNode_(\n                  renderState,\n                  element);\n            });\n      }\n      const clone = candidate.cloneNode(true);\n      clone.removeAttribute('subscriptions-dialog');\n      clone.removeAttribute('subscriptions-display');\n      return clone;\n    }).then(element => {\n      if (!element) {\n        return;\n      }\n      return this.dialog_.open(element, /* showCloseButton */ true);\n    });\n  }\n\n  /**\n   * Renders actions inside a given node according to an authResponse\n   * @param {!JsonObject} renderState\n   * @param {!Node} rootNode\n   * @return {!Promise<Node>}\n   * @private\n   */\n  renderActionsInNode_(renderState, rootNode) {\n    return this.ampdoc_.whenReady().then(() => {\n      // Find the matching actions and sections and make them visible if\n      // evalutes to true.\n      const querySelectors =\n          '[subscriptions-action], [subscriptions-section=\"actions\"],'\n              + ' [subscriptions-actions]';\n      const actionCandidates = rootNode.querySelectorAll(querySelectors);\n      for (let i = 0; i < actionCandidates.length; i++) {\n        const candidate = actionCandidates[i];\n        const expr = candidate.getAttribute('subscriptions-display');\n        if (expr && evaluateExpr(expr,\n            /** @type {!JsonObject} */(renderState))) {\n          candidate.classList.add('i-amphtml-subs-display');\n          if (candidate.getAttribute('subscriptions-service')\n            && candidate.getAttribute('subscriptions-action')\n            && candidate.getAttribute('subscriptions-decorate') !== 'false') {\n            this.serviceAdapter_.decorateServiceAction(\n                candidate,\n                candidate.getAttribute('subscriptions-service'),\n                candidate.getAttribute('subscriptions-action'),\n                null\n            );\n          }\n        } else {\n          candidate.classList.remove('i-amphtml-subs-display');\n        }\n      }\n      return rootNode;\n    });\n  }\n}\n\n/**\n * TODO(dvoytenko): remove once compiler type checking is fixed for third_party.\n * @package @VisibleForTesting\n */\nexport function getEntitlementClassForTesting() {\n  return Entitlement;\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Actions} from './actions';\nimport {Entitlement} from './entitlement';\nimport {LocalSubscriptionPlatformRenderer} from './local-subscription-platform-renderer';\nimport {PageConfig} from '../../../third_party/subscriptions-project/config';\nimport {Services} from '../../../src/services';\nimport {UrlBuilder} from './url-builder';\nimport {assertHttpsUrl} from '../../../src/url';\nimport {closestBySelector} from '../../../src/dom';\nimport {dev, user} from '../../../src/log';\nimport {dict} from '../../../src/utils/object';\n\n\n/**\n * This implements the methods to interact with various subscription platforms.\n *\n * @implements {./subscription-platform.SubscriptionPlatform}\n */\nexport class LocalSubscriptionPlatform {\n\n  /**\n   * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n   * @param {!JsonObject} platformConfig\n   * @param {!./service-adapter.ServiceAdapter} serviceAdapter\n   * @param {!./analytics.SubscriptionAnalytics} subscriptionAnalytics\n   */\n  constructor(ampdoc, platformConfig, serviceAdapter, subscriptionAnalytics) {\n    /** @const */\n    this.ampdoc_ = ampdoc;\n\n    /** @private @const */\n    this.rootNode_ = ampdoc.getRootNode();\n\n    /** @const @private {!JsonObject} */\n    this.serviceConfig_ = platformConfig;\n\n    /** @private @const {!./service-adapter.ServiceAdapter} */\n    this.serviceAdapter_ = serviceAdapter;\n\n    /** @const @private {!../../../src/service/xhr-impl.Xhr} */\n    this.xhr_ = Services.xhrFor(this.ampdoc_.win);\n\n    /** @private @const {string} */\n    this.authorizationUrl_ = assertHttpsUrl(\n        user().assert(\n            this.serviceConfig_['authorizationUrl'],\n            'Service config does not have authorization Url'\n        ),\n        'Authorization Url'\n    );\n\n    /** @private {!UrlBuilder} */\n    this.urlBuilder_ = new UrlBuilder(\n        this.ampdoc_,\n        this.serviceAdapter_.getReaderId('local'));\n\n    /** @private {!./analytics.SubscriptionAnalytics} */\n    this.subscriptionAnalytics_ = subscriptionAnalytics;\n\n    user().assert(this.serviceConfig_['actions'],\n        'Actions have not been defined in the service config');\n\n    /** @private {!Actions} */\n    this.actions_ = new Actions(\n        this.ampdoc_, this.urlBuilder_,\n        this.subscriptionAnalytics_,\n        this.validateActionMap(this.serviceConfig_['actions'])\n    );\n\n    /** @private {!LocalSubscriptionPlatformRenderer}*/\n    this.renderer_ = new LocalSubscriptionPlatformRenderer(this.ampdoc_,\n        serviceAdapter.getDialog(), this.serviceAdapter_);\n\n    /** @private @const {?string} */\n    this.pingbackUrl_ = this.serviceConfig_['pingbackUrl'] || null;\n\n    this.initializeListeners_();\n  }\n\n  /**\n   * @override\n   */\n  getServiceId() {\n    return 'local';\n  }\n\n  /**\n   * Validates the action map\n   * @param {!JsonObject<string, string>} actionMap\n   * @return {!JsonObject<string, string>}\n   */\n  validateActionMap(actionMap) {\n    user().assert(actionMap['login'],\n        'Action \"login\" is not present in action map');\n    user().assert(actionMap['subscribe'],\n        'Action \"subscribe\" is not present in action map');\n    return actionMap;\n  }\n\n  /**\n   * Add event listener for the subscriptions action\n   * @private\n   */\n  initializeListeners_() {\n    this.rootNode_.addEventListener('click', e => {\n      const element = closestBySelector(dev().assertElement(e.target),\n          '[subscriptions-action]');\n      this.handleClick_(element);\n    });\n  }\n\n  /**\n   * Handle click on subscription-action\n   * @private\n   * @param {Node} element\n   */\n  handleClick_(element) {\n    if (element) {\n      const action = element.getAttribute('subscriptions-action');\n      const serviceAttr = element.getAttribute('subscriptions-service');\n      if (serviceAttr == 'local') {\n        this.executeAction(action);\n      } else if ((serviceAttr || 'auto') == 'auto') {\n        if (action == 'login') {\n          // The \"login\" action is somewhat special b/c viewers can\n          // enhance this action, e.g. to provide save/link feature.\n          const platform = this.serviceAdapter_.selectPlatformForLogin();\n          this.serviceAdapter_.delegateActionToService(\n              action, platform.getServiceId());\n        } else {\n          this.executeAction(action);\n        }\n      } else if (serviceAttr) {\n        this.serviceAdapter_.delegateActionToService(action, serviceAttr);\n      }\n    }\n  }\n\n  /** @override */\n  activate(entitlement) {\n    const renderState = entitlement.json();\n    this.urlBuilder_.setAuthResponse(renderState);\n    this.actions_.build().then(() => {\n      this.renderer_.render(renderState);\n    });\n  }\n\n  /** @override */\n  executeAction(action) {\n    const actionExecution = this.actions_.execute(action);\n    return actionExecution.then(result => {\n      if (result) {\n        this.serviceAdapter_.reAuthorizePlatform(this);\n      }\n      return !!result;\n    });\n  }\n\n  /** @override */\n  getEntitlements() {\n    return this.urlBuilder_.buildUrl(this.authorizationUrl_,\n        /* useAuthData */ false)\n        .then(fetchUrl =>\n          this.xhr_.fetchJson(fetchUrl, {credentials: 'include'})\n              .then(res => res.json())\n              .then(resJson => {\n                return Entitlement.parseFromJson(resJson);\n              }));\n  }\n\n  /** @override */\n  isPingbackEnabled() {\n    return !!this.pingbackUrl_;\n  }\n\n  /** @override */\n  pingback(selectedEntitlement) {\n    if (!this.isPingbackEnabled) {\n      return;\n    }\n    const pingbackUrl = /** @type {string} */ (dev().assert(this.pingbackUrl_,\n        'pingbackUrl is null'));\n\n    const promise = this.urlBuilder_.buildUrl(pingbackUrl,\n        /* useAuthData */ true);\n    return promise.then(url => {\n      return this.xhr_.sendSignal(url, {\n        method: 'POST',\n        credentials: 'include',\n        headers: dict({\n          'Content-Type': 'text/plain',\n        }),\n        body: JSON.stringify(selectedEntitlement.jsonForPingback()),\n      });\n    });\n  }\n\n  /** @override */\n  supportsCurrentViewer() {\n    return false;\n  }\n\n  /** @override */\n  getBaseScore() {\n    return this.serviceConfig_['baseScore'] || 0;\n  }\n\n  /** @override */\n  decorateUI(unusedNode, unusedAction, unusedOptions) {}\n}\n\n/**\n * TODO(dvoytenko): remove once compiler type checking is fixed for third_party.\n * @package @VisibleForTesting\n */\nexport function getPageConfigClassForTesting() {\n  return PageConfig;\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Deferred} from '../../../src/utils/promise';\nimport {Entitlement} from './entitlement';\nimport {Observable} from '../../../src/observable';\nimport {dev, user} from '../../../src/log';\nimport {dict, hasOwn} from '../../../src/utils/object';\n\n\n/** @typedef {{serviceId: string, entitlement: (!./entitlement.Entitlement|undefined)}} */\nexport let EntitlementChangeEventDef;\n\n/** @const */\nconst TAG = 'amp-subscriptions';\n\nexport class PlatformStore {\n  /**\n   * @param {!Array<string>} expectedServiceIds\n   * @param {!JsonObject} scoreConfig\n   * @param {!./entitlement.Entitlement} fallbackEntitlement\n   */\n  constructor(expectedServiceIds, scoreConfig, fallbackEntitlement) {\n\n    /** @private @const {!Object<string, !./subscription-platform.SubscriptionPlatform>} */\n    this.subscriptionPlatforms_ = dict();\n\n    /** @private @const {!Array<string>} */\n    this.serviceIds_ = expectedServiceIds;\n\n    /** @private @const {!Object<string, !./entitlement.Entitlement>} */\n    this.entitlements_ = {};\n\n    /**\n     * @private @const\n     * {!Object<string, !Deferred<!./entitlement.Entitlement>>}\n     */\n    this.entitlementDeferredMap_ = {};\n    expectedServiceIds.forEach(serviceId => {\n      this.entitlementDeferredMap_[serviceId] = new Deferred();\n    });\n\n    /** @private @const {!Observable<!EntitlementChangeEventDef>} */\n    this.onEntitlementResolvedCallbacks_ = new Observable();\n\n    /** @private @const {!Observable<{serviceId: string}>} */\n    this.onPlatformResolvedCallbacks_ = new Observable();\n\n    /** @private {?Deferred} */\n    this.grantStatusPromise_ = null;\n\n    /** @private @const {!Observable} */\n    this.onGrantStateResolvedCallbacks_ = new Observable();\n\n    /** @private {?Entitlement} */\n    this.grantStatusEntitlement_ = null;\n\n    /** @private {?Deferred<?Entitlement>} */\n    this.grantStatusEntitlementPromise_ = null;\n\n    /** @private {?Deferred<!Array<!./entitlement.Entitlement>>} */\n    this.allResolvedPromise_ = null;\n\n    /** @private {!Array<string>} */\n    this.failedPlatforms_ = [];\n\n    /** @private @canst {!./entitlement.Entitlement} */\n    this.fallbackEntitlement_ = fallbackEntitlement;\n\n    /** @private @const {!Object<string, number>} */\n    this.scoreConfig_ = Object.assign({\n      'supportsViewer': 10,\n    }, scoreConfig);\n  }\n\n  /**\n   * Resolves a platform in the store\n   * @param {string} serviceId\n   * @param {!./subscription-platform.SubscriptionPlatform} platform\n   */\n  resolvePlatform(serviceId, platform) {\n    this.subscriptionPlatforms_[serviceId] = platform;\n    this.onPlatformResolvedCallbacks_.fire({\n      serviceId,\n    });\n  }\n\n  /**\n   *Calls a callback for when a platform is resolved.\n   * @param {string} serviceId\n   * @param {!Function} callback\n   */\n  onPlatformResolves(serviceId, callback) {\n    const platform = this.subscriptionPlatforms_[serviceId];\n    if (platform) {\n      callback(platform);\n    } else {\n      this.onPlatformResolvedCallbacks_.add(e => {\n        if (e.serviceId === serviceId) {\n          callback(this.getPlatform(serviceId));\n        }\n      });\n    }\n  }\n\n  /**\n   * Returns the platform for the given id\n   * @param {string} serviceId\n   * @return {!./subscription-platform.SubscriptionPlatform}\n   */\n  getPlatform(serviceId) {\n    const platform = this.subscriptionPlatforms_[serviceId];\n    dev().assert(platform, `Platform for id ${serviceId} is not resolved`);\n    return platform;\n  }\n\n  /**\n   * Returns the local platform;\n   * @return {!./local-subscription-platform.LocalSubscriptionPlatform}\n   */\n  getLocalPlatform() {\n    const localPlatform =\n        /** @type{!./local-subscription-platform.LocalSubscriptionPlatform} */\n        (this.getPlatform('local'));\n    return localPlatform;\n  }\n\n  /**\n   * Returns all available platforms.\n   *\n   * @return {!Array<!./subscription-platform.SubscriptionPlatform>}\n   */\n  getAvailablePlatforms() {\n    const platforms = [];\n    for (const platformKey in this.subscriptionPlatforms_) {\n      const subscriptionPlatform =\n        this.subscriptionPlatforms_[platformKey];\n      platforms.push(subscriptionPlatform);\n    }\n    return platforms;\n  }\n\n  /**\n   * This registers a callback which is called whenever a service id is resolved\n   * with an entitlement.\n   * @param {function(!EntitlementChangeEventDef):void} callback\n   */\n  onChange(callback) {\n    this.onEntitlementResolvedCallbacks_.add(callback);\n  }\n\n  /**\n   * This resolves the entitlement to a serviceId\n   * @param {string} serviceId\n   * @param {!./entitlement.Entitlement} entitlement\n   */\n  resolveEntitlement(serviceId, entitlement) {\n    if (entitlement) {\n      entitlement.service = serviceId;\n    }\n    this.entitlements_[serviceId] = entitlement;\n    const deferred = this.entitlementDeferredMap_[serviceId];\n    if (deferred) {\n      deferred.resolve(entitlement);\n    }\n    // Remove this serviceId as a failed platform now\n    if (this.failedPlatforms_.indexOf(serviceId) != -1) {\n      this.failedPlatforms_.splice(this.failedPlatforms_.indexOf(serviceId));\n    }\n    // Call all onChange callbacks.\n    this.onEntitlementResolvedCallbacks_.fire({serviceId, entitlement});\n  }\n\n  /**\n   * Returns entitlement for a platform.\n   * @param {string} serviceId\n   * @return {!./entitlement.Entitlement} entitlement\n   */\n  getResolvedEntitlementFor(serviceId) {\n    dev().assert(this.entitlements_[serviceId],\n        `Platform ${serviceId} has not yet resolved with entitlements`);\n    return this.entitlements_[serviceId];\n  }\n\n  /**\n   * Returns entitlement for a platform once it's resolved.\n   * @param {string} serviceId\n   * @return {!Promise<!./entitlement.Entitlement>} entitlement\n   */\n  getEntitlementPromiseFor(serviceId) {\n    dev().assert(this.entitlementDeferredMap_[serviceId],\n        `Platform ${serviceId} is not declared`);\n    return this.entitlementDeferredMap_[serviceId].promise;\n  }\n\n  /**\n   * @param {string} serviceId\n   */\n  resetEntitlementFor(serviceId) {\n    dev().assert(this.entitlementDeferredMap_[serviceId],\n        `Platform ${serviceId} is not declared`);\n    this.entitlementDeferredMap_[serviceId] = new Deferred();\n  }\n\n  /**\n   * @return {!Promise<boolean>}\n   */\n  getGrantStatus() {\n    if (this.grantStatusPromise_ !== null) {\n      return this.grantStatusPromise_.promise;\n    }\n\n    this.grantStatusPromise_ = new Deferred();\n\n    // Check if current entitlements unblocks the reader\n    for (const key in this.entitlements_) {\n      const entitlement = (this.entitlements_[key]);\n      if (entitlement.granted) {\n        this.saveGrantEntitlement_(entitlement);\n        this.grantStatusPromise_.resolve(true);\n      }\n    }\n\n    if (this.areAllPlatformsResolved_()) {\n      // Resolve with null if non of the entitlements unblocks the reader\n      this.grantStatusPromise_.resolve(false);\n    } else {\n      // Listen if any upcoming entitlements unblock the reader\n      this.onChange(({entitlement}) => {\n        if (entitlement.granted) {\n          this.saveGrantEntitlement_(entitlement);\n          this.grantStatusPromise_.resolve(true);\n        } else if (this.areAllPlatformsResolved_()) {\n          this.grantStatusPromise_.resolve(false);\n        }\n      });\n    }\n\n    return this.grantStatusPromise_.promise;\n  }\n\n  /**\n   * Checks and saves the entitlement for grant status\n   * @param {!Entitlement} entitlement\n   * @private\n   */\n  saveGrantEntitlement_(entitlement) {\n    // The entitlement will be stored either if its the first one to grant\n    // or the new one has full subscription but the last one didn't.\n    if ((!this.grantStatusEntitlement_ && entitlement.granted)\n        || (this.grantStatusEntitlement_\n          && !this.grantStatusEntitlement_.isSubscriber()\n          && entitlement.isSubscriber())) {\n      this.grantStatusEntitlement_ = entitlement;\n      this.onGrantStateResolvedCallbacks_.fire();\n    }\n  }\n\n  /**\n   * Returns the entitlement which unlocked the document\n   * @return {!Promise<?Entitlement>}\n   */\n  getGrantEntitlement() {\n    if (this.grantStatusEntitlementPromise_) {\n      return (this.grantStatusEntitlementPromise_.promise);\n    }\n    this.grantStatusEntitlementPromise_ = new Deferred();\n    if ((this.grantStatusEntitlement_\n        && this.grantStatusEntitlement_.isSubscriber())\n          || this.areAllPlatformsResolved_()) {\n      this.grantStatusEntitlementPromise_.resolve(this.grantStatusEntitlement_);\n    } else {\n      this.onGrantStateResolvedCallbacks_.add(() => {\n        if (this.grantStatusEntitlement_.granted\n            || this.areAllPlatformsResolved_()) {\n          this.grantStatusEntitlementPromise_.resolve(\n              this.grantStatusEntitlement_);\n        }\n      });\n    }\n    return this.grantStatusEntitlementPromise_.promise;\n  }\n\n  /**\n   * Clears the grant status\n   */\n  reset() {\n    this.grantStatusPromise_ = null;\n  }\n\n  /**\n   * Returns entitlements when all services are done fetching them.\n   * @private\n   * @return {!Promise<!Array<!./entitlement.Entitlement>>}\n   */\n  getAllPlatformsEntitlements_() {\n    if (this.allResolvedPromise_) {\n      return this.allResolvedPromise_.promise;\n    }\n    this.allResolvedPromise_ = new Deferred();\n    if (this.areAllPlatformsResolved_()) {\n      // Resolve with null if non of the entitlements unblocks the reader\n      this.allResolvedPromise_.resolve(\n          this.getAvailablePlatformsEntitlements_());\n    } else {\n      // Listen if any upcoming entitlements unblock the reader\n      this.onChange(() => {\n        if (this.areAllPlatformsResolved_()) {\n          this.allResolvedPromise_.resolve(\n              this.getAvailablePlatformsEntitlements_());\n        }\n      });\n    }\n    return this.allResolvedPromise_.promise;\n  }\n\n  /**\n   * Returns entitlements for resolved platforms.\n   * @private\n   * @return {!Array<!./entitlement.Entitlement>}\n   */\n  getAvailablePlatformsEntitlements_() {\n    const entitlements = [];\n    for (const platform in this.entitlements_) {\n      if (hasOwn(this.entitlements_, platform)) {\n        entitlements.push(this.entitlements_[platform]);\n      }\n    }\n    return entitlements;\n  }\n\n  /**\n   * Returns entitlements when all services are done fetching them.\n   * @return {!Promise<!./subscription-platform.SubscriptionPlatform>}\n   */\n  selectPlatform() {\n\n    return this.getAllPlatformsEntitlements_().then(() => {\n      // TODO(@prateekbh): explain why sometimes a quick resolve is possible vs\n      // waiting for all entitlement.\n      return this.selectApplicablePlatform_();\n    });\n  }\n\n  /**\n   * Returns the number of entitlements resolved\n   * @return {boolean}\n   * @private\n   */\n  areAllPlatformsResolved_() {\n    const entitlementsResolved = Object.keys(this.entitlements_).length;\n    return entitlementsResolved === this.serviceIds_.length;\n  }\n\n  /**\n   * Returns most qualified platform. Qualification of a platform is based on an\n   * integer weight. Every platform starts with weight 0 and evaluated against\n   * the following parameters,\n   * - user is subscribed with platform (Gives weight 10)\n   * - supports the current viewer (Gives weight 9)\n   *\n   * In the end candidate with max weight is selected. However if candidate's\n   * weight is equal to local platform, then local platform is selected.\n   * @return {!./subscription-platform.SubscriptionPlatform}\n   * @private\n   */\n  selectApplicablePlatform_() {\n    const localPlatform = this.getLocalPlatform();\n    let localWeight = 0;\n    /** @type {!Array<!Object<!./subscription-platform.SubscriptionPlatform, number>>} */\n    const platformWeights = [];\n\n    dev().assert(this.areAllPlatformsResolved_(),\n        'All platforms are not resolved yet');\n\n    this.getAvailablePlatforms().forEach(platform => {\n      let weight = 0;\n      const entitlement =\n          this.getResolvedEntitlementFor(platform.getServiceId());\n\n      // Subscriber wins immediatly.\n      if (entitlement.isSubscriber()) {\n        weight += 100000;\n      }\n\n      // Add the base score\n      weight += platform.getBaseScore();\n\n      // If supports the current viewer, gains weight 9\n      if (platform.supportsCurrentViewer()) {\n        weight += this.scoreConfig_['supportsViewer'];\n      }\n\n      platformWeights.push({\n        platform,\n        weight,\n      });\n      if (platform.getServiceId() === 'local') {\n        localWeight = weight;\n      }\n    });\n\n    platformWeights.sort(function(platform1, platform2) {\n      return platform2.weight - platform1.weight;\n    });\n    // Nobody supports current viewer, nor is anybody subscribed\n    if (platformWeights.length === 0) {\n      return localPlatform;\n    }\n\n    const winningWeight = platformWeights[0].weight;\n\n    if (winningWeight > localWeight) {\n      return platformWeights[0].platform;\n    }\n\n    return localPlatform;\n  }\n\n  /**\n   * Records a platform failure and logs error if all platforms have failed.\n   * @param {string} serviceId\n   */\n  reportPlatformFailure(serviceId) {\n    if (this.failedPlatforms_.indexOf(serviceId) == -1) {\n      const entitlement = Entitlement.empty(serviceId);\n      this.resolveEntitlement(serviceId, entitlement);\n      this.failedPlatforms_.push(serviceId);\n    }\n\n    if (this.failedPlatforms_.length == this.serviceIds_.length) {\n      user().warn(TAG, 'All platforms have failed to resolve, '\n          + 'using fallback entitlement for local platform');\n      this.resolveEntitlement(this.getLocalPlatform().getServiceId(),\n          this.fallbackEntitlement_);\n    }\n  }\n\n  /**\n   * Evaluates platforms and select the one to be selected for login.\n   * @return {!./subscription-platform.SubscriptionPlatform}\n   */\n  selectPlatformForLogin() {\n    const platformScores = [];\n    this.getAvailablePlatforms().forEach(platform => {\n      let score = 0;\n      if (platform.supportsCurrentViewer()) {\n        score += 1000;\n      }\n      platformScores.push({\n        platform,\n        score,\n      });\n    });\n\n    platformScores.sort(function(platform1, platform2) {\n      return platform2.weight - platform1.weight;\n    });\n\n    if (platformScores.length === 0 || platformScores[0].score === 0) {\n      return this.getLocalPlatform();\n    }\n\n    return platformScores[0].platform;\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from '../../../src/services';\nimport {createElementWithAttributes} from '../../../src/dom';\nimport {dict} from '../../../src/utils/object';\n\nconst CSS_PREFIX = 'i-amphtml-subs';\n\n\nexport class Renderer {\n\n  /**\n   * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n   */\n  constructor(ampdoc) {\n    /** @const @private */\n    this.ampdoc_ = ampdoc;\n\n    /** @const @private {!../../../src/service/resources-impl.Resources} */\n    this.resources_ = Services.resourcesForDoc(ampdoc);\n\n    // Initial state is \"unknown\".\n    this.setGrantState(null);\n    this.getBodyElement_().classList.add(`${CSS_PREFIX}-ready`);\n\n    // Check and add progress bar.\n    this.addLoadingBar();\n  }\n\n  /**\n   * @return {!Element}\n   * @private\n   */\n  getBodyElement_() {\n    return this.ampdoc_.getBody();\n  }\n\n  /**\n   * @param {string} type\n   * @param {?boolean} state\n   * @private\n   */\n  setState_(type, state) {\n    this.resources_.mutateElement(this.ampdoc_.getBody() , () => {\n      this.getBodyElement_().classList.toggle(\n          `${CSS_PREFIX}-${type}-unk`,\n          state === null);\n      this.getBodyElement_().classList.toggle(\n          `${CSS_PREFIX}-${type}-yes`,\n          state === true);\n      this.getBodyElement_().classList.toggle(\n          `${CSS_PREFIX}-${type}-no`,\n          state === false);\n    });\n  }\n\n  /**\n   * Adds a loading bar.\n   *\n   * @return {!Promise}\n   */\n  addLoadingBar() {\n    return this.ampdoc_.whenReady().then(() => {\n      if (!this.ampdoc_.getBody().querySelector(\n          '[subscriptions-section=loading]')) {\n        const element = createElementWithAttributes(this.ampdoc_.win.document,\n            'div' ,\n            dict({\n              'class': 'i-amphtml-subs-progress',\n              'subscriptions-section': 'loading',\n            })\n        );\n        this.ampdoc_.getBody().appendChild(element);\n      }\n    });\n  }\n\n  /**\n   * @param {string} type\n   * @param {boolean} state\n   * @private\n   */\n  toggleState_(type, state) {\n    this.resources_.mutateElement(this.ampdoc_.getBody(), () => {\n      this.getBodyElement_().classList.toggle(`${CSS_PREFIX}-${type}`, state);\n    });\n  }\n\n  /**\n   * @param {?boolean} state\n   */\n  setGrantState(state) {\n    this.setState_('grant', state);\n  }\n\n  /**\n   * @param {boolean} loading\n   */\n  toggleLoading(loading) {\n    this.toggleState_('loading', loading);\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {PageConfig} from '../../../third_party/subscriptions-project/config';\n\nexport class ServiceAdapter {\n\n  /**\n   * @param {./amp-subscriptions.SubscriptionService} subscriptionService\n   */\n  constructor(subscriptionService) {\n    this.subscriptionService_ = subscriptionService;\n  }\n\n  /**\n   * Returns the page config.\n   * @return {!PageConfig}\n   */\n  getPageConfig() {\n    return this.subscriptionService_.getPageConfig();\n  }\n\n  /**\n   * Returns the reader ID for the specified service.\n   * @param {string} serviceId\n   * @return {!Promise<string>}\n   */\n  getReaderId(serviceId) {\n    return this.subscriptionService_.getReaderId(serviceId);\n  }\n\n  /**\n   * Delegates actions to local platform.\n   * @param {string} action\n   * @return {!Promise<boolean>}\n   */\n  delegateActionToLocal(action) {\n    return this.delegateActionToService(action, 'local');\n  }\n\n  /**\n   * Delegates actions to a given service.\n   * @param {string} action\n   * @param {string} serviceId\n   * @return {!Promise<boolean>}\n   */\n  delegateActionToService(action, serviceId) {\n    return this.subscriptionService_.delegateActionToService(action, serviceId);\n  }\n\n  /**\n   * Delegate UI decoration to another service.\n   * @param {!Element} element\n   * @param {string} serviceId\n   * @param {string} action\n   * @param {?JsonObject} options\n   */\n  decorateServiceAction(element, serviceId, action, options) {\n    this.subscriptionService_.decorateServiceAction(element, serviceId,\n        action, options);\n  }\n\n  /**\n   * Reauthorize platforms\n   * @param {!./subscription-platform.SubscriptionPlatform} subscriptionPlatform\n   */\n  reAuthorizePlatform(subscriptionPlatform) {\n    this.subscriptionService_.reAuthorizePlatform(subscriptionPlatform);\n  }\n\n  /**\n   * Returns the singleton Dialog instance\n   * @return {!./dialog.Dialog}\n   */\n  getDialog() {\n    return this.subscriptionService_.getDialog();\n  }\n\n  /**\n   * Returns login platform based on platform selection\n   *\n   * @return {!./subscription-platform.SubscriptionPlatform}\n   */\n  selectPlatformForLogin() {\n    return this.subscriptionService_.selectPlatformForLogin();\n  }\n}\n\n/** @package @VisibleForTesting */\nexport function getPageConfigForTesting() {\n  return PageConfig;\n}\n\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {PageConfig} from '../../../third_party/subscriptions-project/config';\n\n/**\n * This interface is intended to be implemented by Subscription platforms to\n * provide method of getting entitlements.\n *\n * @interface\n */\nexport class SubscriptionPlatform {\n\n  /**\n   * Returns the service Id.\n   * @return {string}\n   */\n  getServiceId() {}\n\n  /**\n   * Requests entitlement for a subscription platform.\n   * @return {!Promise<?./entitlement.Entitlement>}\n   */\n  getEntitlements() {}\n\n  /**\n   * Activates the subscription platform and hands over the control for\n   * rendering.\n   * @param {!./entitlement.Entitlement} unusedEntitlement\n   */\n  activate(unusedEntitlement) {}\n\n  /**\n   * Returns if pingback is enabled for this platform.\n   * @return {boolean}\n   */\n  isPingbackEnabled() {}\n\n  /**\n   * Performs the pingback to the subscription platform.\n   * @param {!./entitlement.Entitlement} unusedSelectedPlatform\n   * @return {!Promise|undefined}\n   */\n  pingback(unusedSelectedPlatform) {}\n\n  /**\n   * Tells if this platform supports the current viewer.\n   * @return {boolean}\n   */\n  supportsCurrentViewer() {}\n\n  /**\n   * Executes action for the local platform.\n   * @param {string} unusedAction\n   * @return {!Promise<boolean>}\n   */\n  executeAction(unusedAction) {}\n\n  /**\n   * Returns the base score configured for the platform.\n   * @return {number}\n   */\n  getBaseScore() {}\n\n  /**\n   * Decorate the DomNode according to your platform\n   * @param {!Element} unusedElement\n   * @param {string} unusedAction\n   * @param {?JsonObject} unusedOptions\n   */\n  decorateUI(unusedElement, unusedAction, unusedOptions) {}\n}\n\n/**\n * TODO(dvoytenko): remove once compiler type checking is fixed for third_party.\n * @package @visibleForTesting\n */\nexport function getPageConfigClassForTesting() {\n  return PageConfig;\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from '../../../src/services';\nimport {getValueForExpr} from '../../../src/json';\n\n\nexport class UrlBuilder {\n\n  /**\n   * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n   * @param {!Promise<string>} readerIdPromise\n   */\n  constructor(ampdoc, readerIdPromise) {\n    /** @private @const {!../../../src/service/url-replacements-impl.UrlReplacements} */\n    this.urlReplacements_ = Services.urlReplacementsForDoc(ampdoc);\n    /** @private @const {!Promise<string>} */\n    this.readerIdPromise_ = readerIdPromise;\n\n    /** @private {?JsonObject} */\n    this.authResponse_ = null;\n  }\n\n  /**\n   * @param {!JsonObject} authResponse\n   */\n  setAuthResponse(authResponse) {\n    this.authResponse_ = authResponse;\n  }\n\n  /**\n   * @param {string} url\n   * @param {boolean} useAuthData Allows `AUTH(field)` URL var substitutions.\n   * @return {!Promise<string>}\n   */\n  buildUrl(url, useAuthData) {\n    return this.prepareUrlVars_(useAuthData).then(vars => {\n      return this.urlReplacements_.expandUrlAsync(url, vars);\n    });\n  }\n\n  /**\n   * @param {string} url\n   * @param {boolean} useAuthData Allows `AUTH(field)` URL var substitutions.\n   * @return {!Promise<!Object<string, *>>}\n   */\n  collectUrlVars(url, useAuthData) {\n    return this.prepareUrlVars_(useAuthData).then(vars => {\n      return this.urlReplacements_.collectVars(url, vars);\n    });\n  }\n\n  /**\n   * @param {boolean} useAuthData Allows `AUTH(field)` URL var substitutions.\n   * @return {!Promise<!Object<string, *>>}\n   * @private\n   */\n  prepareUrlVars_(useAuthData) {\n    return this.readerIdPromise_.then(readerId => {\n      const vars = {\n        'READER_ID': readerId,\n        'ACCESS_READER_ID': readerId, // A synonym.\n      };\n      if (useAuthData) {\n        vars['AUTHDATA'] = field => {\n          if (this.authResponse_) {\n            return getValueForExpr(this.authResponse_, field);\n          }\n          return undefined;\n        };\n      }\n      return vars;\n    });\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nimport {Entitlement, GrantReason} from './entitlement';\nimport {JwtHelper} from '../../amp-access/0.1/jwt';\nimport {LocalSubscriptionPlatform} from './local-subscription-platform';\nimport {PageConfig} from '../../../third_party/subscriptions-project/config';\nimport {Services} from '../../../src/services';\nimport {dev, user} from '../../../src/log';\nimport {dict} from '../../../src/utils/object';\nimport {getSourceOrigin, getWinOrigin} from '../../../src/url';\n\n\n/**\n * This implements the methods to interact with viewer subscription platform.\n * @implements {./subscription-platform.SubscriptionPlatform}\n */\nexport class ViewerSubscriptionPlatform {\n\n  /**\n   * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n   * @param {!JsonObject} platformConfig\n   * @param {!./service-adapter.ServiceAdapter} serviceAdapter\n   * @param {string} origin\n   * @param {!./analytics.SubscriptionAnalytics} subscriptionAnalytics\n   */\n  constructor(ampdoc, platformConfig, serviceAdapter, origin,\n    subscriptionAnalytics) {\n    /** @private @const */\n    this.ampdoc_ = ampdoc;\n\n    /** @private @const {!PageConfig} */\n    this.pageConfig_ = serviceAdapter.getPageConfig();\n\n    /** @private @const {!LocalSubscriptionPlatform} */\n    this.platform_ = new LocalSubscriptionPlatform(\n        ampdoc, platformConfig, serviceAdapter, subscriptionAnalytics);\n\n    /** @const @private {!../../../src/service/viewer-impl.Viewer} */\n    this.viewer_ = Services.viewerForDoc(this.ampdoc_);\n\n    /** @private @const {!JwtHelper} */\n    this.jwtHelper_ = new JwtHelper(ampdoc.win);\n\n    /** @private @const {string} */\n    this.publicationId_ = this.pageConfig_.getPublicationId();\n\n    /** @private @const {?string} */\n    this.currentProductId_ = this.pageConfig_.getProductId();\n\n    /** @private @const {string} */\n    this.origin_ = origin;\n  }\n\n  /** @override */\n  getEntitlements() {\n    dev().assert(this.currentProductId_, 'Current product is not set');\n\n    const entitlementPromise = this.viewer_.sendMessageAwaitResponse(\n        'auth',\n        dict({\n          'publicationId': this.publicationId_,\n          'productId': this.currentProductId_,\n          'origin': this.origin_,\n        })\n    ).then(entitlementData => {\n      const authData = (entitlementData || {})['authorization'];\n      if (!authData) {\n        return Entitlement.empty('local');\n      }\n      return this.verifyAuthToken_(authData);\n    }).catch(reason => {\n      this.sendAuthTokenErrorToViewer_(reason.message);\n      throw reason;\n    });\n    return /** @type{!Promise<Entitlement>} */ (entitlementPromise);\n  }\n\n  /**\n   * Logs error and sends message to viewer\n   * @param {string} token\n   * @return {!Promise<!Entitlement>}\n   * @private\n   */\n  verifyAuthToken_(token) {\n    return new Promise(resolve => {\n      const origin = getWinOrigin(this.ampdoc_.win);\n      const sourceOrigin = getSourceOrigin(this.ampdoc_.win.location);\n      const decodedData = this.jwtHelper_.decode(token);\n      const currentProductId = /** @type {string} */ (user().assert(\n          this.pageConfig_.getProductId(),\n          'Product id is null'\n      ));\n      if (decodedData['aud'] != origin && decodedData['aud'] != sourceOrigin) {\n        throw user().createError(\n            `The mismatching \"aud\" field: ${decodedData['aud']}`);\n      }\n      if (decodedData['exp'] < Math.floor(Date.now() / 1000)) {\n        throw user().createError('Payload is expired');\n      }\n      const entitlements = decodedData['entitlements'];\n      let entitlement = Entitlement.empty('local');\n      if (Array.isArray(entitlements)) {\n        for (let index = 0; index < entitlements.length; index++) {\n          if (entitlements[index]['products'].indexOf(currentProductId)\n              !== -1) {\n            const entitlementObject = entitlements[index];\n            entitlement = new Entitlement({\n              source: 'viewer',\n              raw: token,\n              granted: true,\n              grantReason: entitlementObject.subscriptionToken ?\n                GrantReason.SUBSCRIBER : '',\n              dataObject: entitlementObject,\n            });\n            break;\n          }\n        }\n      } else if (decodedData['metering'] && !decodedData['entitlements']) {\n        // Special case where viewer gives metering but no entitlement\n        entitlement = new Entitlement({\n          source: decodedData['iss'] || '',\n          raw: token,\n          granted: true,\n          grantReason: GrantReason.METERING,\n          dataObject: decodedData['metering'],\n        });\n      } else if (entitlements) { // Not null\n        entitlement = new Entitlement({\n          source: 'viewer',\n          raw: token,\n          granted: entitlements.granted,\n          grantReason: entitlements.subscriptionToken ?\n            GrantReason.SUBSCRIBER : '',\n          dataObject: entitlements,\n        });\n      }\n\n      entitlement.service = 'local';\n      resolve(entitlement);\n    });\n  }\n\n  /**\n   * Logs error and sends message to viewer\n   * @param {string} errorString\n   * @private\n   */\n  sendAuthTokenErrorToViewer_(errorString) {\n    this.viewer_.sendMessage('auth-rejected', dict({\n      'reason': errorString,\n    }));\n  }\n\n  /** @override */\n  getServiceId() {\n    return this.platform_.getServiceId();\n  }\n\n  /** @override */\n  activate() {\n  }\n\n  /** @override */\n  isPingbackEnabled() {\n    return this.platform_.isPingbackEnabled();\n  }\n\n  /** @override */\n  pingback(selectedPlatform) {\n    this.platform_.pingback(selectedPlatform);\n  }\n\n  /** @override */\n  supportsCurrentViewer() {\n    return this.platform_.supportsCurrentViewer();\n  }\n\n  /** @override */\n  getBaseScore() {\n    return 0;\n  }\n\n  /** @override */\n  executeAction(action) {\n    return this.platform_.executeAction(action);\n  }\n\n  /** @override */\n  decorateUI(element, action, options) {\n    return this.platform_.decorateUI(element, action, options);\n  }\n}\n\n/**\n * TODO(dvoytenko): remove once compiler type checking is fixed for third_party.\n * @package @visibleForTesting\n */\nexport function getPageConfigClassForTesting() {\n  return PageConfig;\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from '../../../src/services';\nimport {cancellation} from '../../../src/error';\nimport {dev} from '../../../src/log';\nimport {listenOnce} from '../../../src/event-helper';\n\nconst TAG = 'local-viewer';\n\nexport class ViewerTracker {\n  /**\n   * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n   */\n  constructor(ampdoc) {\n    /** @private */\n    this.ampdoc_ = ampdoc;\n\n    /** @private @const {!../../../src/service/viewer-impl.Viewer} */\n    this.viewer_ = Services.viewerForDoc(ampdoc);\n\n    /** @private {?Promise} */\n    this.reportViewPromise_ = null;\n\n    /** @const @private {!../../../src/service/timer-impl.Timer} */\n    this.timer_ = Services.timerFor(ampdoc.win);\n\n    /** @private @const {!../../../src/service/viewport/viewport-impl.Viewport} */\n    this.viewport_ = Services.viewportForDoc(ampdoc);\n  }\n\n  /**\n   * @param {time} timeToView\n   * @return {!Promise}\n   */\n  scheduleView(timeToView) {\n    this.reportViewPromise_ = null;\n    return this.ampdoc_.whenReady().then(() => {\n      return new Promise(resolve => {\n        if (this.viewer_.isVisible()) {\n          resolve();\n        }\n        this.viewer_.onVisibilityChanged(() => {\n          if (this.viewer_.isVisible()) {\n            resolve();\n          }\n        });\n      }).then(() => this.reportWhenViewed_(timeToView));\n    });\n  }\n\n  /**\n   * @param {time} timeToView\n   * @return {!Promise}\n   * @private\n   */\n  reportWhenViewed_(timeToView) {\n    if (this.reportViewPromise_) {\n      return this.reportViewPromise_;\n    }\n    dev().fine(TAG, 'start view monitoring');\n    this.reportViewPromise_ = this.whenViewed_(timeToView)\n        .catch(reason => {\n          // Ignore - view has been canceled.\n          dev().fine(TAG, 'view cancelled:', reason);\n          this.reportViewPromise_ = null;\n          throw reason;\n        });\n\n    return this.reportViewPromise_;\n  }\n\n  /**\n   * The promise will be resolved when a view of this document has occurred. It\n   * will be rejected if the current impression should not be counted as a view.\n   * @param {time} timeToView Pass the value of 0 when this method is called\n   *   as the result of the user action.\n   * @return {!Promise}\n   * @private\n   */\n  whenViewed_(timeToView) {\n    if (timeToView == 0) {\n      // Immediate view has been registered. This will happen when this method\n      // is called as the result of the user action.\n      return Promise.resolve();\n    }\n\n    // Viewing kick off: document is visible.\n    const unlistenSet = [];\n    return new Promise((resolve, reject) => {\n      // 1. Document becomes invisible again: cancel.\n      unlistenSet.push(this.viewer_.onVisibilityChanged(() => {\n        if (!this.viewer_.isVisible()) {\n          reject(cancellation());\n        }\n      }));\n\n      // 2. After a few seconds: register a view.\n      const timeoutId = this.timer_.delay(resolve, timeToView);\n      unlistenSet.push(() => this.timer_.cancel(timeoutId));\n\n      // 3. If scrolled: register a view.\n      unlistenSet.push(this.viewport_.onScroll(resolve));\n\n      // 4. Tap: register a view.\n      unlistenSet.push(listenOnce(this.ampdoc_.getRootNode(),\n          'click', resolve));\n    }).then(() => {\n      unlistenSet.forEach(unlisten => unlisten());\n    }, reason => {\n      unlistenSet.forEach(unlisten => unlisten());\n      throw reason;\n    });\n  }\n}\n","/*!\n\nCopyright (C) 2014-2016 by Andrea Giammarchi - @WebReflection\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n\n*/\n// global window Object\n// optional polyfill info\n//    'auto' used by default, everything is feature detected\n//    'force' use the polyfill even if not fully needed\nfunction installCustomElements(window, polyfill) {'use strict';\n\n  // DO NOT USE THIS FILE DIRECTLY, IT WON'T WORK\n  // THIS IS A PROJECT BASED ON A BUILD SYSTEM\n  // THIS FILE IS JUST WRAPPED UP RESULTING IN\n  // build/document-register-element.node.js\n\n  var\n    document = window.document,\n    Object = window.Object\n  ;\n\n  var htmlClass = (function (info) {\n    // (C) Andrea Giammarchi - @WebReflection - MIT Style\n    var\n      catchClass = /^[A-Z]+[a-z]/,\n      filterBy = function (re) {\n        var arr = [], tag;\n        for (tag in register) {\n          if (re.test(tag)) arr.push(tag);\n        }\n        return arr;\n      },\n      add = function (Class, tag) {\n        tag = tag.toLowerCase();\n        if (!(tag in register)) {\n          register[Class] = (register[Class] || []).concat(tag);\n          register[tag] = (register[tag.toUpperCase()] = Class);\n        }\n      },\n      register = (Object.create || Object)(null),\n      htmlClass = {},\n      i, section, tags, Class\n    ;\n    for (section in info) {\n      for (Class in info[section]) {\n        tags = info[section][Class];\n        register[Class] = tags;\n        for (i = 0; i < tags.length; i++) {\n          register[tags[i].toLowerCase()] =\n          register[tags[i].toUpperCase()] = Class;\n        }\n      }\n    }\n    htmlClass.get = function get(tagOrClass) {\n      return typeof tagOrClass === 'string' ?\n        (register[tagOrClass] || (catchClass.test(tagOrClass) ? [] : '')) :\n        filterBy(tagOrClass);\n    };\n    htmlClass.set = function set(tag, Class) {\n      return (catchClass.test(tag) ?\n        add(tag, Class) :\n        add(Class, tag)\n      ), htmlClass;\n    };\n    return htmlClass;\n  }({\n    \"collections\": {\n      \"HTMLAllCollection\": [\n        \"all\"\n      ],\n      \"HTMLCollection\": [\n        \"forms\"\n      ],\n      \"HTMLFormControlsCollection\": [\n        \"elements\"\n      ],\n      \"HTMLOptionsCollection\": [\n        \"options\"\n      ]\n    },\n    \"elements\": {\n      \"Element\": [\n        \"element\"\n      ],\n      \"HTMLAnchorElement\": [\n        \"a\"\n      ],\n      \"HTMLAppletElement\": [\n        \"applet\"\n      ],\n      \"HTMLAreaElement\": [\n        \"area\"\n      ],\n      \"HTMLAttachmentElement\": [\n        \"attachment\"\n      ],\n      \"HTMLAudioElement\": [\n        \"audio\"\n      ],\n      \"HTMLBRElement\": [\n        \"br\"\n      ],\n      \"HTMLBaseElement\": [\n        \"base\"\n      ],\n      \"HTMLBodyElement\": [\n        \"body\"\n      ],\n      \"HTMLButtonElement\": [\n        \"button\"\n      ],\n      \"HTMLCanvasElement\": [\n        \"canvas\"\n      ],\n      \"HTMLContentElement\": [\n        \"content\"\n      ],\n      \"HTMLDListElement\": [\n        \"dl\"\n      ],\n      \"HTMLDataElement\": [\n        \"data\"\n      ],\n      \"HTMLDataListElement\": [\n        \"datalist\"\n      ],\n      \"HTMLDetailsElement\": [\n        \"details\"\n      ],\n      \"HTMLDialogElement\": [\n        \"dialog\"\n      ],\n      \"HTMLDirectoryElement\": [\n        \"dir\"\n      ],\n      \"HTMLDivElement\": [\n        \"div\"\n      ],\n      \"HTMLDocument\": [\n        \"document\"\n      ],\n      \"HTMLElement\": [\n        \"element\",\n        \"abbr\",\n        \"address\",\n        \"article\",\n        \"aside\",\n        \"b\",\n        \"bdi\",\n        \"bdo\",\n        \"cite\",\n        \"code\",\n        \"command\",\n        \"dd\",\n        \"dfn\",\n        \"dt\",\n        \"em\",\n        \"figcaption\",\n        \"figure\",\n        \"footer\",\n        \"header\",\n        \"i\",\n        \"kbd\",\n        \"mark\",\n        \"nav\",\n        \"noscript\",\n        \"rp\",\n        \"rt\",\n        \"ruby\",\n        \"s\",\n        \"samp\",\n        \"section\",\n        \"small\",\n        \"strong\",\n        \"sub\",\n        \"summary\",\n        \"sup\",\n        \"u\",\n        \"var\",\n        \"wbr\"\n      ],\n      \"HTMLEmbedElement\": [\n        \"embed\"\n      ],\n      \"HTMLFieldSetElement\": [\n        \"fieldset\"\n      ],\n      \"HTMLFontElement\": [\n        \"font\"\n      ],\n      \"HTMLFormElement\": [\n        \"form\"\n      ],\n      \"HTMLFrameElement\": [\n        \"frame\"\n      ],\n      \"HTMLFrameSetElement\": [\n        \"frameset\"\n      ],\n      \"HTMLHRElement\": [\n        \"hr\"\n      ],\n      \"HTMLHeadElement\": [\n        \"head\"\n      ],\n      \"HTMLHeadingElement\": [\n        \"h1\",\n        \"h2\",\n        \"h3\",\n        \"h4\",\n        \"h5\",\n        \"h6\"\n      ],\n      \"HTMLHtmlElement\": [\n        \"html\"\n      ],\n      \"HTMLIFrameElement\": [\n        \"iframe\"\n      ],\n      \"HTMLImageElement\": [\n        \"img\"\n      ],\n      \"HTMLInputElement\": [\n        \"input\"\n      ],\n      \"HTMLKeygenElement\": [\n        \"keygen\"\n      ],\n      \"HTMLLIElement\": [\n        \"li\"\n      ],\n      \"HTMLLabelElement\": [\n        \"label\"\n      ],\n      \"HTMLLegendElement\": [\n        \"legend\"\n      ],\n      \"HTMLLinkElement\": [\n        \"link\"\n      ],\n      \"HTMLMapElement\": [\n        \"map\"\n      ],\n      \"HTMLMarqueeElement\": [\n        \"marquee\"\n      ],\n      \"HTMLMediaElement\": [\n        \"media\"\n      ],\n      \"HTMLMenuElement\": [\n        \"menu\"\n      ],\n      \"HTMLMenuItemElement\": [\n        \"menuitem\"\n      ],\n      \"HTMLMetaElement\": [\n        \"meta\"\n      ],\n      \"HTMLMeterElement\": [\n        \"meter\"\n      ],\n      \"HTMLModElement\": [\n        \"del\",\n        \"ins\"\n      ],\n      \"HTMLOListElement\": [\n        \"ol\"\n      ],\n      \"HTMLObjectElement\": [\n        \"object\"\n      ],\n      \"HTMLOptGroupElement\": [\n        \"optgroup\"\n      ],\n      \"HTMLOptionElement\": [\n        \"option\"\n      ],\n      \"HTMLOutputElement\": [\n        \"output\"\n      ],\n      \"HTMLParagraphElement\": [\n        \"p\"\n      ],\n      \"HTMLParamElement\": [\n        \"param\"\n      ],\n      \"HTMLPictureElement\": [\n        \"picture\"\n      ],\n      \"HTMLPreElement\": [\n        \"pre\"\n      ],\n      \"HTMLProgressElement\": [\n        \"progress\"\n      ],\n      \"HTMLQuoteElement\": [\n        \"blockquote\",\n        \"q\",\n        \"quote\"\n      ],\n      \"HTMLScriptElement\": [\n        \"script\"\n      ],\n      \"HTMLSelectElement\": [\n        \"select\"\n      ],\n      \"HTMLShadowElement\": [\n        \"shadow\"\n      ],\n      \"HTMLSlotElement\": [\n        \"slot\"\n      ],\n      \"HTMLSourceElement\": [\n        \"source\"\n      ],\n      \"HTMLSpanElement\": [\n        \"span\"\n      ],\n      \"HTMLStyleElement\": [\n        \"style\"\n      ],\n      \"HTMLTableCaptionElement\": [\n        \"caption\"\n      ],\n      \"HTMLTableCellElement\": [\n        \"td\",\n        \"th\"\n      ],\n      \"HTMLTableColElement\": [\n        \"col\",\n        \"colgroup\"\n      ],\n      \"HTMLTableElement\": [\n        \"table\"\n      ],\n      \"HTMLTableRowElement\": [\n        \"tr\"\n      ],\n      \"HTMLTableSectionElement\": [\n        \"thead\",\n        \"tbody\",\n        \"tfoot\"\n      ],\n      \"HTMLTemplateElement\": [\n        \"template\"\n      ],\n      \"HTMLTextAreaElement\": [\n        \"textarea\"\n      ],\n      \"HTMLTimeElement\": [\n        \"time\"\n      ],\n      \"HTMLTitleElement\": [\n        \"title\"\n      ],\n      \"HTMLTrackElement\": [\n        \"track\"\n      ],\n      \"HTMLUListElement\": [\n        \"ul\"\n      ],\n      \"HTMLUnknownElement\": [\n        \"unknown\",\n        \"vhgroupv\",\n        \"vkeygen\"\n      ],\n      \"HTMLVideoElement\": [\n        \"video\"\n      ]\n    },\n    \"nodes\": {\n      \"Attr\": [\n        \"node\"\n      ],\n      \"Audio\": [\n        \"audio\"\n      ],\n      \"CDATASection\": [\n        \"node\"\n      ],\n      \"CharacterData\": [\n        \"node\"\n      ],\n      \"Comment\": [\n        \"#comment\"\n      ],\n      \"Document\": [\n        \"#document\"\n      ],\n      \"DocumentFragment\": [\n        \"#document-fragment\"\n      ],\n      \"DocumentType\": [\n        \"node\"\n      ],\n      \"HTMLDocument\": [\n        \"#document\"\n      ],\n      \"Image\": [\n        \"img\"\n      ],\n      \"Option\": [\n        \"option\"\n      ],\n      \"ProcessingInstruction\": [\n        \"node\"\n      ],\n      \"ShadowRoot\": [\n        \"#shadow-root\"\n      ],\n      \"Text\": [\n        \"#text\"\n      ],\n      \"XMLDocument\": [\n        \"xml\"\n      ]\n    }\n  }));\n  \n  \n    \n  // passed at runtime, configurable\n  // via nodejs module\n  if (!polyfill) polyfill = 'auto';\n  \n  var\n    // V0 polyfill entry\n    REGISTER_ELEMENT = 'registerElement',\n  \n    // IE < 11 only + old WebKit for attributes + feature detection\n    EXPANDO_UID = '__' + REGISTER_ELEMENT + (window.Math.random() * 10e4 >> 0),\n  \n    // shortcuts and costants\n    ADD_EVENT_LISTENER = 'addEventListener',\n    ATTACHED = 'attached',\n    CALLBACK = 'Callback',\n    DETACHED = 'detached',\n    EXTENDS = 'extends',\n  \n    ATTRIBUTE_CHANGED_CALLBACK = 'attributeChanged' + CALLBACK,\n    ATTACHED_CALLBACK = ATTACHED + CALLBACK,\n    CONNECTED_CALLBACK = 'connected' + CALLBACK,\n    DISCONNECTED_CALLBACK = 'disconnected' + CALLBACK,\n    CREATED_CALLBACK = 'created' + CALLBACK,\n    DETACHED_CALLBACK = DETACHED + CALLBACK,\n  \n    ADDITION = 'ADDITION',\n    MODIFICATION = 'MODIFICATION',\n    REMOVAL = 'REMOVAL',\n  \n    DOM_ATTR_MODIFIED = 'DOMAttrModified',\n    DOM_CONTENT_LOADED = 'DOMContentLoaded',\n    DOM_SUBTREE_MODIFIED = 'DOMSubtreeModified',\n  \n    PREFIX_TAG = '<',\n    PREFIX_IS = '=',\n  \n    // valid and invalid node names\n    validName = /^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,\n    invalidNames = [\n      'ANNOTATION-XML',\n      'COLOR-PROFILE',\n      'FONT-FACE',\n      'FONT-FACE-SRC',\n      'FONT-FACE-URI',\n      'FONT-FACE-FORMAT',\n      'FONT-FACE-NAME',\n      'MISSING-GLYPH'\n    ],\n  \n    // registered types and their prototypes\n    types = [],\n    protos = [],\n  \n    // to query subnodes\n    query = '',\n  \n    // html shortcut used to feature detect\n    documentElement = document.documentElement,\n  \n    // ES5 inline helpers || basic patches\n    indexOf = types.indexOf || function (v) {\n      for(var i = this.length; i-- && this[i] !== v;){}\n      return i;\n    },\n  \n    // other helpers / shortcuts\n    OP = Object.prototype,\n    hOP = OP.hasOwnProperty,\n    iPO = OP.isPrototypeOf,\n  \n    defineProperty = Object.defineProperty,\n    empty = [],\n    gOPD = Object.getOwnPropertyDescriptor,\n    gOPN = Object.getOwnPropertyNames,\n    gPO = Object.getPrototypeOf,\n    sPO = Object.setPrototypeOf,\n  \n    // jshint proto: true\n    hasProto = !!Object.__proto__,\n  \n    // V1 helpers\n    fixGetClass = false,\n    DRECEV1 = '__dreCEv1',\n    customElements = window.customElements,\n    usableCustomElements = polyfill !== 'force' && !!(\n      customElements &&\n      customElements.define &&\n      customElements.get &&\n      customElements.whenDefined\n    ),\n    Dict = Object.create || Object,\n    Map = window.Map || function Map() {\n      var K = [], V = [], i;\n      return {\n        get: function (k) {\n          return V[indexOf.call(K, k)];\n        },\n        set: function (k, v) {\n          i = indexOf.call(K, k);\n          if (i < 0) V[K.push(k) - 1] = v;\n          else V[i] = v;\n        }\n      };\n    },\n    Promise = window.Promise || function (fn) {\n      var\n        notify = [],\n        done = false,\n        p = {\n          'catch': function () {\n            return p;\n          },\n          'then': function (cb) {\n            notify.push(cb);\n            if (done) setTimeout(resolve, 1);\n            return p;\n          }\n        }\n      ;\n      function resolve(value) {\n        done = true;\n        while (notify.length) notify.shift()(value);\n      }\n      fn(resolve);\n      return p;\n    },\n    justCreated = false,\n    constructors = Dict(null),\n    waitingList = Dict(null),\n    nodeNames = new Map(),\n    secondArgument = function (is) {\n      return is.toLowerCase();\n    },\n  \n    // used to create unique instances\n    create = Object.create || function Bridge(proto) {\n      // silly broken polyfill probably ever used but short enough to work\n      return proto ? ((Bridge.prototype = proto), new Bridge()) : this;\n    },\n  \n    // will set the prototype if possible\n    // or copy over all properties\n    setPrototype = sPO || (\n      hasProto ?\n        function (o, p) {\n          o.__proto__ = p;\n          return o;\n        } : (\n      (gOPN && gOPD) ?\n        (function(){\n          function setProperties(o, p) {\n            for (var\n              key,\n              names = gOPN(p),\n              i = 0, length = names.length;\n              i < length; i++\n            ) {\n              key = names[i];\n              if (!hOP.call(o, key)) {\n                defineProperty(o, key, gOPD(p, key));\n              }\n            }\n          }\n          return function (o, p) {\n            do {\n              setProperties(o, p);\n            } while ((p = gPO(p)) && !iPO.call(p, o));\n            return o;\n          };\n        }()) :\n        function (o, p) {\n          for (var key in p) {\n            o[key] = p[key];\n          }\n          return o;\n        }\n    )),\n  \n    // DOM shortcuts and helpers, if any\n  \n    MutationObserver = window.MutationObserver ||\n                       window.WebKitMutationObserver,\n  \n    HTMLElementPrototype = (\n      window.HTMLElement ||\n      window.Element ||\n      window.Node\n    ).prototype,\n  \n    IE8 = !iPO.call(HTMLElementPrototype, documentElement),\n  \n    safeProperty = IE8 ? function (o, k, d) {\n      o[k] = d.value;\n      return o;\n    } : defineProperty,\n  \n    isValidNode = IE8 ?\n      function (node) {\n        return node.nodeType === 1;\n      } :\n      function (node) {\n        return iPO.call(HTMLElementPrototype, node);\n      },\n  \n    targets = IE8 && [],\n  \n    attachShadow = HTMLElementPrototype.attachShadow,\n    cloneNode = HTMLElementPrototype.cloneNode,\n    dispatchEvent = HTMLElementPrototype.dispatchEvent,\n    getAttribute = HTMLElementPrototype.getAttribute,\n    hasAttribute = HTMLElementPrototype.hasAttribute,\n    removeAttribute = HTMLElementPrototype.removeAttribute,\n    setAttribute = HTMLElementPrototype.setAttribute,\n  \n    // replaced later on\n    createElement = document.createElement,\n    patchedCreateElement = createElement,\n  \n    // shared observer for all attributes\n    attributesObserver = MutationObserver && {\n      attributes: true,\n      characterData: true,\n      attributeOldValue: true\n    },\n  \n    // useful to detect only if there's no MutationObserver\n    DOMAttrModified = MutationObserver || function(e) {\n      doesNotSupportDOMAttrModified = false;\n      documentElement.removeEventListener(\n        DOM_ATTR_MODIFIED,\n        DOMAttrModified\n      );\n    },\n  \n    // will both be used to make DOMNodeInserted asynchronous\n    asapQueue,\n    asapTimer = 0,\n  \n    // internal flags\n    V0 = REGISTER_ELEMENT in document,\n    setListener = true,\n    justSetup = false,\n    doesNotSupportDOMAttrModified = true,\n    dropDomContentLoaded = true,\n  \n    // needed for the innerHTML helper\n    notFromInnerHTMLHelper = true,\n  \n    // optionally defined later on\n    onSubtreeModified,\n    callDOMAttrModified,\n    getAttributesMirror,\n    observer,\n    observe,\n  \n    // based on setting prototype capability\n    // will check proto or the expando attribute\n    // in order to setup the node once\n    patchIfNotAlready,\n    patch\n  ;\n  \n  // only if needed\n  if (!V0) {\n  \n    if (sPO || hasProto) {\n        patchIfNotAlready = function (node, proto) {\n          if (!iPO.call(proto, node)) {\n            setupNode(node, proto);\n          }\n        };\n        patch = setupNode;\n    } else {\n        patchIfNotAlready = function (node, proto) {\n          if (!node[EXPANDO_UID]) {\n            node[EXPANDO_UID] = Object(true);\n            setupNode(node, proto);\n          }\n        };\n        patch = patchIfNotAlready;\n    }\n  \n    if (IE8) {\n      doesNotSupportDOMAttrModified = false;\n      (function (){\n        var\n          descriptor = gOPD(HTMLElementPrototype, ADD_EVENT_LISTENER),\n          addEventListener = descriptor.value,\n          patchedRemoveAttribute = function (name) {\n            var e = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true});\n            e.attrName = name;\n            e.prevValue = getAttribute.call(this, name);\n            e.newValue = null;\n            e[REMOVAL] = e.attrChange = 2;\n            removeAttribute.call(this, name);\n            dispatchEvent.call(this, e);\n          },\n          patchedSetAttribute = function (name, value) {\n            var\n              had = hasAttribute.call(this, name),\n              old = had && getAttribute.call(this, name),\n              e = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true})\n            ;\n            setAttribute.call(this, name, value);\n            e.attrName = name;\n            e.prevValue = had ? old : null;\n            e.newValue = value;\n            if (had) {\n              e[MODIFICATION] = e.attrChange = 1;\n            } else {\n              e[ADDITION] = e.attrChange = 0;\n            }\n            dispatchEvent.call(this, e);\n          },\n          onPropertyChange = function (e) {\n            // jshint eqnull:true\n            var\n              node = e.currentTarget,\n              superSecret = node[EXPANDO_UID],\n              propertyName = e.propertyName,\n              event\n            ;\n            if (superSecret.hasOwnProperty(propertyName)) {\n              superSecret = superSecret[propertyName];\n              event = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true});\n              event.attrName = superSecret.name;\n              event.prevValue = superSecret.value || null;\n              event.newValue = (superSecret.value = node[propertyName] || null);\n              if (event.prevValue == null) {\n                event[ADDITION] = event.attrChange = 0;\n              } else {\n                event[MODIFICATION] = event.attrChange = 1;\n              }\n              dispatchEvent.call(node, event);\n            }\n          }\n        ;\n        descriptor.value = function (type, handler, capture) {\n          if (\n            type === DOM_ATTR_MODIFIED &&\n            this[ATTRIBUTE_CHANGED_CALLBACK] &&\n            this.setAttribute !== patchedSetAttribute\n          ) {\n            this[EXPANDO_UID] = {\n              className: {\n                name: 'class',\n                value: this.className\n              }\n            };\n            this.setAttribute = patchedSetAttribute;\n            this.removeAttribute = patchedRemoveAttribute;\n            addEventListener.call(this, 'propertychange', onPropertyChange);\n          }\n          addEventListener.call(this, type, handler, capture);\n        };\n        defineProperty(HTMLElementPrototype, ADD_EVENT_LISTENER, descriptor);\n      }());\n    } else if (!MutationObserver) {\n      documentElement[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED, DOMAttrModified);\n      documentElement.setAttribute(EXPANDO_UID, 1);\n      documentElement.removeAttribute(EXPANDO_UID);\n      if (doesNotSupportDOMAttrModified) {\n        onSubtreeModified = function (e) {\n          var\n            node = this,\n            oldAttributes,\n            newAttributes,\n            key\n          ;\n          if (node === e.target) {\n            oldAttributes = node[EXPANDO_UID];\n            node[EXPANDO_UID] = (newAttributes = getAttributesMirror(node));\n            for (key in newAttributes) {\n              if (!(key in oldAttributes)) {\n                // attribute was added\n                return callDOMAttrModified(\n                  0,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  ADDITION\n                );\n              } else if (newAttributes[key] !== oldAttributes[key]) {\n                // attribute was changed\n                return callDOMAttrModified(\n                  1,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  MODIFICATION\n                );\n              }\n            }\n            // checking if it has been removed\n            for (key in oldAttributes) {\n              if (!(key in newAttributes)) {\n                // attribute removed\n                return callDOMAttrModified(\n                  2,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  REMOVAL\n                );\n              }\n            }\n          }\n        };\n        callDOMAttrModified = function (\n          attrChange,\n          currentTarget,\n          attrName,\n          prevValue,\n          newValue,\n          action\n        ) {\n          var e = {\n            attrChange: attrChange,\n            currentTarget: currentTarget,\n            attrName: attrName,\n            prevValue: prevValue,\n            newValue: newValue\n          };\n          e[action] = attrChange;\n          onDOMAttrModified(e);\n        };\n        getAttributesMirror = function (node) {\n          for (var\n            attr, name,\n            result = {},\n            attributes = node.attributes,\n            i = 0, length = attributes.length;\n            i < length; i++\n          ) {\n            attr = attributes[i];\n            name = attr.name;\n            if (name !== 'setAttribute') {\n              result[name] = attr.value;\n            }\n          }\n          return result;\n        };\n      }\n    }\n  \n    // set as enumerable, writable and configurable\n    document[REGISTER_ELEMENT] = function registerElement(type, options) {\n      upperType = type.toUpperCase();\n      if (setListener) {\n        // only first time document.registerElement is used\n        // we need to set this listener\n        // setting it by default might slow down for no reason\n        setListener = false;\n        if (MutationObserver) {\n          observer = (function(attached, detached){\n            function checkEmAll(list, callback) {\n              for (var i = 0, length = list.length; i < length; callback(list[i++])){}\n            }\n            return new MutationObserver(function (records) {\n              for (var\n                current, node, newValue,\n                i = 0, length = records.length; i < length; i++\n              ) {\n                current = records[i];\n                if (current.type === 'childList') {\n                  checkEmAll(current.addedNodes, attached);\n                  checkEmAll(current.removedNodes, detached);\n                } else {\n                  node = current.target;\n                  if (notFromInnerHTMLHelper &&\n                      node[ATTRIBUTE_CHANGED_CALLBACK] &&\n                      current.attributeName !== 'style') {\n                    newValue = getAttribute.call(node, current.attributeName);\n                    if (newValue !== current.oldValue) {\n                      node[ATTRIBUTE_CHANGED_CALLBACK](\n                        current.attributeName,\n                        current.oldValue,\n                        newValue\n                      );\n                    }\n                  }\n                }\n              }\n            });\n          }(executeAction(ATTACHED), executeAction(DETACHED)));\n          observe = function (node) {\n            observer.observe(\n              node,\n              {\n                childList: true,\n                subtree: true\n              }\n            );\n            return node;\n          };\n          observe(document);\n          if (attachShadow) {\n            HTMLElementPrototype.attachShadow = function () {\n              return observe(attachShadow.apply(this, arguments));\n            };\n          }\n        } else {\n          asapQueue = [];\n          document[ADD_EVENT_LISTENER]('DOMNodeInserted', onDOMNode(ATTACHED));\n          document[ADD_EVENT_LISTENER]('DOMNodeRemoved', onDOMNode(DETACHED));\n        }\n  \n        document[ADD_EVENT_LISTENER](DOM_CONTENT_LOADED, onReadyStateChange);\n        document[ADD_EVENT_LISTENER]('readystatechange', onReadyStateChange);\n  \n        HTMLElementPrototype.cloneNode = function (deep) {\n          var\n            node = cloneNode.call(this, !!deep),\n            i = getTypeIndex(node)\n          ;\n          if (-1 < i) patch(node, protos[i]);\n          if (deep && query.length) loopAndSetup(node.querySelectorAll(query));\n          return node;\n        };\n      }\n  \n      if (justSetup) return (justSetup = false);\n  \n      if (-2 < (\n        indexOf.call(types, PREFIX_IS + upperType) +\n        indexOf.call(types, PREFIX_TAG + upperType)\n      )) {\n        throwTypeError(type);\n      }\n  \n      if (!validName.test(upperType) || -1 < indexOf.call(invalidNames, upperType)) {\n        throw new Error('The type ' + type + ' is invalid');\n      }\n  \n      var\n        constructor = function () {\n          return extending ?\n            document.createElement(nodeName, upperType) :\n            document.createElement(nodeName);\n        },\n        opt = options || OP,\n        extending = hOP.call(opt, EXTENDS),\n        nodeName = extending ? options[EXTENDS].toUpperCase() : upperType,\n        upperType,\n        i\n      ;\n  \n      if (extending && -1 < (\n        indexOf.call(types, PREFIX_TAG + nodeName)\n      )) {\n        throwTypeError(nodeName);\n      }\n  \n      i = types.push((extending ? PREFIX_IS : PREFIX_TAG) + upperType) - 1;\n  \n      query = query.concat(\n        query.length ? ',' : '',\n        extending ? nodeName + '[is=\"' + type.toLowerCase() + '\"]' : nodeName\n      );\n  \n      constructor.prototype = (\n        protos[i] = hOP.call(opt, 'prototype') ?\n          opt.prototype :\n          create(HTMLElementPrototype)\n      );\n  \n      if (query.length) loopAndVerify(\n        document.querySelectorAll(query),\n        ATTACHED\n      );\n  \n      return constructor;\n    };\n  \n    document.createElement = (patchedCreateElement = function (localName, typeExtension) {\n      var\n        is = getIs(typeExtension),\n        node = is ?\n          createElement.call(document, localName, secondArgument(is)) :\n          createElement.call(document, localName),\n        name = '' + localName,\n        i = indexOf.call(\n          types,\n          (is ? PREFIX_IS : PREFIX_TAG) +\n          (is || name).toUpperCase()\n        ),\n        setup = -1 < i\n      ;\n      if (is) {\n        node.setAttribute('is', is = is.toLowerCase());\n        if (setup) {\n          setup = isInQSA(name.toUpperCase(), is);\n        }\n      }\n      notFromInnerHTMLHelper = !document.createElement.innerHTMLHelper;\n      if (setup) patch(node, protos[i]);\n      return node;\n    });\n  \n  }\n  \n  function ASAP() {\n    var queue = asapQueue.splice(0, asapQueue.length);\n    asapTimer = 0;\n    while (queue.length) {\n      queue.shift().call(\n        null, queue.shift()\n      );\n    }\n  }\n  \n  function loopAndVerify(list, action) {\n    for (var i = 0, length = list.length; i < length; i++) {\n      verifyAndSetupAndAction(list[i], action);\n    }\n  }\n  \n  function loopAndSetup(list) {\n    for (var i = 0, length = list.length, node; i < length; i++) {\n      node = list[i];\n      patch(node, protos[getTypeIndex(node)]);\n    }\n  }\n  \n  function executeAction(action) {\n    return function (node) {\n      if (isValidNode(node)) {\n        verifyAndSetupAndAction(node, action);\n        if (query.length) loopAndVerify(\n          node.querySelectorAll(query),\n          action\n        );\n      }\n    };\n  }\n  \n  function getTypeIndex(target) {\n    var\n      is = getAttribute.call(target, 'is'),\n      nodeName = target.nodeName.toUpperCase(),\n      i = indexOf.call(\n        types,\n        is ?\n            PREFIX_IS + is.toUpperCase() :\n            PREFIX_TAG + nodeName\n      )\n    ;\n    return is && -1 < i && !isInQSA(nodeName, is) ? -1 : i;\n  }\n  \n  function isInQSA(name, type) {\n    return -1 < query.indexOf(name + '[is=\"' + type + '\"]');\n  }\n  \n  function onDOMAttrModified(e) {\n    var\n      node = e.currentTarget,\n      attrChange = e.attrChange,\n      attrName = e.attrName,\n      target = e.target,\n      addition = e[ADDITION] || 2,\n      removal = e[REMOVAL] || 3\n    ;\n    if (notFromInnerHTMLHelper &&\n        (!target || target === node) &&\n        node[ATTRIBUTE_CHANGED_CALLBACK] &&\n        attrName !== 'style' && (\n          e.prevValue !== e.newValue ||\n          // IE9, IE10, and Opera 12 gotcha\n          e.newValue === '' && (\n            attrChange === addition ||\n            attrChange === removal\n          )\n    )) {\n      node[ATTRIBUTE_CHANGED_CALLBACK](\n        attrName,\n        attrChange === addition ? null : e.prevValue,\n        attrChange === removal ? null : e.newValue\n      );\n    }\n  }\n  \n  function onDOMNode(action) {\n    var executor = executeAction(action);\n    return function (e) {\n      asapQueue.push(executor, e.target);\n      if (asapTimer) clearTimeout(asapTimer);\n      asapTimer = setTimeout(ASAP, 1);\n    };\n  }\n  \n  function onReadyStateChange(e) {\n    if (dropDomContentLoaded) {\n      dropDomContentLoaded = false;\n      e.currentTarget.removeEventListener(DOM_CONTENT_LOADED, onReadyStateChange);\n    }\n    if (query.length) loopAndVerify(\n      (e.target || document).querySelectorAll(query),\n      e.detail === DETACHED ? DETACHED : ATTACHED\n    );\n    if (IE8) purge();\n  }\n  \n  function patchedSetAttribute(name, value) {\n    // jshint validthis:true\n    var self = this;\n    setAttribute.call(self, name, value);\n    onSubtreeModified.call(self, {target: self});\n  }\n  \n  function setupNode(node, proto) {\n    setPrototype(node, proto);\n    if (observer) {\n      observer.observe(node, attributesObserver);\n    } else {\n      if (doesNotSupportDOMAttrModified) {\n        node.setAttribute = patchedSetAttribute;\n        node[EXPANDO_UID] = getAttributesMirror(node);\n        node[ADD_EVENT_LISTENER](DOM_SUBTREE_MODIFIED, onSubtreeModified);\n      }\n      node[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED, onDOMAttrModified);\n    }\n    if (node[CREATED_CALLBACK] && notFromInnerHTMLHelper) {\n      node.created = true;\n      node[CREATED_CALLBACK]();\n      node.created = false;\n    }\n  }\n  \n  function purge() {\n    for (var\n      node,\n      i = 0,\n      length = targets.length;\n      i < length; i++\n    ) {\n      node = targets[i];\n      if (!documentElement.contains(node)) {\n        length--;\n        targets.splice(i--, 1);\n        verifyAndSetupAndAction(node, DETACHED);\n      }\n    }\n  }\n  \n  function throwTypeError(type) {\n    throw new Error('A ' + type + ' type is already registered');\n  }\n  \n  function verifyAndSetupAndAction(node, action) {\n    var\n      fn,\n      i = getTypeIndex(node)\n    ;\n    if (-1 < i) {\n      patchIfNotAlready(node, protos[i]);\n      i = 0;\n      if (action === ATTACHED && !node[ATTACHED]) {\n        node[DETACHED] = false;\n        node[ATTACHED] = true;\n        i = 1;\n        if (IE8 && indexOf.call(targets, node) < 0) {\n          targets.push(node);\n        }\n      } else if (action === DETACHED && !node[DETACHED]) {\n        node[ATTACHED] = false;\n        node[DETACHED] = true;\n        i = 1;\n      }\n      if (i && (fn = node[action + CALLBACK])) fn.call(node);\n    }\n  }\n  \n  \n  \n  // V1 in da House!\n  function CustomElementRegistry() {}\n  \n  CustomElementRegistry.prototype = {\n    constructor: CustomElementRegistry,\n    // a workaround for the stubborn WebKit\n    define: usableCustomElements ?\n      function (name, Class, options) {\n        if (options) {\n          CERDefine(name, Class, options);\n        } else {\n          var NAME = name.toUpperCase();\n          constructors[NAME] = {\n            constructor: Class,\n            create: [NAME]\n          };\n          nodeNames.set(Class, NAME);\n          customElements.define(name, Class);\n        }\n      } :\n      CERDefine,\n    get: usableCustomElements ?\n      function (name) {\n        return customElements.get(name) || get(name);\n      } :\n      get,\n    whenDefined: usableCustomElements ?\n      function (name) {\n        return Promise.race([\n          customElements.whenDefined(name),\n          whenDefined(name)\n        ]);\n      } :\n      whenDefined\n  };\n  \n  function CERDefine(name, Class, options) {\n    var\n      is = options && options[EXTENDS] || '',\n      CProto = Class.prototype,\n      proto = create(CProto),\n      attributes = Class.observedAttributes || empty,\n      definition = {prototype: proto}\n    ;\n    // TODO: is this needed at all since it's inherited?\n    // defineProperty(proto, 'constructor', {value: Class});\n    safeProperty(proto, CREATED_CALLBACK, {\n        value: function () {\n          if (justCreated) justCreated = false;\n          else if (!this[DRECEV1]) {\n            this[DRECEV1] = true;\n            new Class(this);\n            if (CProto[CREATED_CALLBACK])\n              CProto[CREATED_CALLBACK].call(this);\n            var info = constructors[nodeNames.get(Class)];\n            if (!usableCustomElements || info.create.length > 1) {\n              notifyAttributes(this);\n            }\n          }\n      }\n    });\n    safeProperty(proto, ATTRIBUTE_CHANGED_CALLBACK, {\n      value: function (name) {\n        if (-1 < indexOf.call(attributes, name))\n          CProto[ATTRIBUTE_CHANGED_CALLBACK].apply(this, arguments);\n      }\n    });\n    if (CProto[CONNECTED_CALLBACK]) {\n      safeProperty(proto, ATTACHED_CALLBACK, {\n        value: CProto[CONNECTED_CALLBACK]\n      });\n    }\n    if (CProto[DISCONNECTED_CALLBACK]) {\n      safeProperty(proto, DETACHED_CALLBACK, {\n        value: CProto[DISCONNECTED_CALLBACK]\n      });\n    }\n    if (is) definition[EXTENDS] = is;\n    name = name.toUpperCase();\n    constructors[name] = {\n      constructor: Class,\n      create: is ? [is, secondArgument(name)] : [name]\n    };\n    nodeNames.set(Class, name);\n    document[REGISTER_ELEMENT](name.toLowerCase(), definition);\n    whenDefined(name);\n    waitingList[name].r();\n  }\n  \n  function get(name) {\n    var info = constructors[name.toUpperCase()];\n    return info && info.constructor;\n  }\n  \n  function getIs(options) {\n    return typeof options === 'string' ?\n        options : (options && options.is || '');\n  }\n  \n  function notifyAttributes(self) {\n    var\n      callback = self[ATTRIBUTE_CHANGED_CALLBACK],\n      attributes = callback ? self.attributes : empty,\n      i = attributes.length,\n      attribute\n    ;\n    while (i--) {\n      attribute =  attributes[i]; // || attributes.item(i);\n      callback.call(\n        self,\n        attribute.name || attribute.nodeName,\n        null,\n        attribute.value || attribute.nodeValue\n      );\n    }\n  }\n  \n  function whenDefined(name) {\n    name = name.toUpperCase();\n    if (!(name in waitingList)) {\n      waitingList[name] = {};\n      waitingList[name].p = new Promise(function (resolve) {\n        waitingList[name].r = resolve;\n      });\n    }\n    return waitingList[name].p;\n  }\n  \n  function polyfillV1() {\n    if (customElements) delete window.customElements;\n    defineProperty(window, 'customElements', {\n      configurable: true,\n      value: new CustomElementRegistry()\n    });\n    defineProperty(window, 'CustomElementRegistry', {\n      configurable: true,\n      value: CustomElementRegistry\n    });\n    for (var\n      patchClass = function (name) {\n        var Class = window[name];\n        if (Class) {\n          window[name] = function CustomElementsV1(self) {\n            var info, isNative;\n            if (!self) self = this;\n            if (!self[DRECEV1]) {\n              justCreated = true;\n              info = constructors[nodeNames.get(self.constructor)];\n              isNative = usableCustomElements && info.create.length === 1;\n              self = isNative ?\n                Reflect.construct(Class, empty, info.constructor) :\n                document.createElement.apply(document, info.create);\n              self[DRECEV1] = true;\n              justCreated = false;\n              if (!isNative) notifyAttributes(self);\n            }\n            return self;\n          };\n          window[name].prototype = Class.prototype;\n          try {\n            Class.prototype.constructor = window[name];\n          } catch(WebKit) {\n            fixGetClass = true;\n            defineProperty(Class, DRECEV1, {value: window[name]});\n          }\n        }\n      },\n      Classes = htmlClass.get(/^HTML[A-Z]*[a-z]/),\n      i = Classes.length;\n      i--;\n      patchClass(Classes[i])\n    ) {}\n    (document.createElement = function (name, options) {\n      var is = getIs(options);\n      return is ?\n        patchedCreateElement.call(this, name, secondArgument(is)) :\n        patchedCreateElement.call(this, name);\n    });\n    if (!V0) {\n      justSetup = true;\n      document[REGISTER_ELEMENT]('');\n    }\n  }\n  \n  // if customElements is not there at all\n  if (!customElements || polyfill === 'force') polyfillV1();\n  else {\n    // if available test extends work as expected\n    try {\n      (function (DRE, options, name) {\n        options[EXTENDS] = 'a';\n        DRE.prototype = create(HTMLAnchorElement.prototype);\n        DRE.prototype.constructor = DRE;\n        window.customElements.define(name, DRE, options);\n        if (\n          getAttribute.call(document.createElement('a', {is: name}), 'is') !== name ||\n          (usableCustomElements && getAttribute.call(new DRE(), 'is') !== name)\n        ) {\n          throw options;\n        }\n      }(\n        function DRE() {\n          return Reflect.construct(HTMLAnchorElement, [], DRE);\n        },\n        {},\n        'document-register-element-a'\n      ));\n    } catch(o_O) {\n      // or force the polyfill if not\n      // and keep internal original reference\n      polyfillV1();\n    }\n  }\n  \n  try {\n    createElement.call(document, 'a', 'a');\n  } catch(FireFox) {\n    secondArgument = function (is) {\n      return {is: is.toLowerCase()};\n    };\n  }\n  \n}\n\nexports.installCustomElements = installCustomElements;\n\n","'use strict';\n\n/**\n * Constructs a ES6/Promises A+ Promise instance.\n *\n * @constructor\n * @param {function(function(*=), function (*=))} resolver\n */\nfunction Promise(resolver) {\n  if (!(this instanceof Promise)) {\n    throw new TypeError('Constructor Promise requires `new`');\n  }\n  if (!isFunction(resolver)) {\n    throw new TypeError('Must pass resolver function');\n  }\n\n  /**\n   * @type {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise}\n   * @private\n   */\n  this._state = PendingPromise;\n\n  /**\n   * @type {*}\n   * @private\n   */\n  this._value = [];\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this._isChainEnd = true;\n\n  doResolve(\n    this,\n    adopter(this, FulfilledPromise),\n    adopter(this, RejectedPromise),\n    { then: resolver }\n  );\n}\n\n/****************************\n  Public Instance Methods\n ****************************/\n\n/**\n * Creates a new promise instance that will receive the result of this promise\n * as inputs to the onFulfilled or onRejected callbacks.\n *\n * @param {function(*)} onFulfilled\n * @param {function(*)} onRejected\n */\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  onFulfilled = isFunction(onFulfilled) ? onFulfilled : void 0;\n  onRejected = isFunction(onRejected) ? onRejected : void 0;\n\n  if (onFulfilled || onRejected) {\n    this._isChainEnd = false;\n  }\n\n  return this._state(\n    this._value,\n    onFulfilled,\n    onRejected\n  );\n};\n\n/**\n * Creates a new promise that will handle the rejected state of this promise.\n *\n * @param {function(*)} onRejected\n * @returns {!Promise}\n */\nPromise.prototype.catch = function(onRejected) {\n  return this.then(void 0, onRejected);\n};\n\n/****************************\n  Public Static Methods\n ****************************/\n\n/**\n * Creates a fulfilled Promise of value. If value is itself a then-able,\n * resolves with the then-able's value.\n *\n * @this {!Promise}\n * @param {*=} value\n * @returns {!Promise}\n */\nPromise.resolve = function(value) {\n  var Constructor = this;\n  var promise;\n\n  if (isObject(value) && value instanceof this) {\n    promise = value;\n  } else {\n    promise = new Constructor(function(resolve) {\n      resolve(value);\n    });\n  }\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a rejected Promise of reason.\n *\n * @this {!Promise}\n * @param {*=} reason\n * @returns {!Promise}\n */\nPromise.reject = function(reason) {\n  var Constructor = this;\n  var promise = new Constructor(function(_, reject) {\n    reject(reason);\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve with an array of the values of the\n * passed in promises. If any promise rejects, the returned promise will\n * reject.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.all = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    var length = promises.length;\n    var values = new Array(length);\n\n    if (length === 0) {\n      return resolve(values);\n    }\n\n    each(promises, function(promise, index) {\n      Constructor.resolve(promise).then(function(value) {\n        values[index] = value;\n        if (--length === 0) {\n          resolve(values);\n        }\n      }, reject);\n    });\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve or reject based on the first\n * resolved or rejected promise.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.race = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    for (var i = 0; i < promises.length; i++) {\n      Constructor.resolve(promises[i]).then(resolve, reject);\n    }\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\nvar onPossiblyUnhandledRejection = function(reason, promise) {\n  throw reason;\n};\n\n/**\n * An internal use static function.\n */\nPromise._overrideUnhandledExceptionHandler = function(handler) {\n  onPossiblyUnhandledRejection = handler;\n};\n\n/****************************\n  Private functions\n ****************************/\n\n/**\n * The Fulfilled Promise state. Calls onFulfilled with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onFulfilled, returns the current promise to avoid an promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} value The current promise's resolved value.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} unused\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Fulfilled state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction FulfilledPromise(value, onFulfilled, unused, deferred) {\n  if (!onFulfilled) {\n    deferredAdopt(deferred, FulfilledPromise, value);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onFulfilled, value));\n  return deferred.promise;\n}\n\n/**\n * The Rejected Promise state. Calls onRejected with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onRejected, returns the current promise to avoid an promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} reason The current promise's rejection reason.\n * @param {function(*=)=} unused\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Rejected state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction RejectedPromise(reason, unused, onRejected, deferred) {\n  if (!onRejected) {\n    deferredAdopt(deferred, RejectedPromise, reason);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onRejected, reason));\n  return deferred.promise;\n}\n\n/**\n * The Pending Promise state. Eventually calls onFulfilled once the promise has\n * resolved, or onRejected once the promise rejects.\n *\n * If there is no onFulfilled and no onRejected, returns the current promise to\n * avoid an promise instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} queue The current promise's pending promises queue.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Pending state from the\n *     Pending state of another promise.\n * @returns {!Promise}\n */\nfunction PendingPromise(queue, onFulfilled, onRejected, deferred) {\n  if (!deferred) {\n    if (!onFulfilled && !onRejected) { return this; }\n    deferred = new Deferred(this.constructor);\n  }\n  queue.push({\n    deferred: deferred,\n    onFulfilled: onFulfilled || deferred.resolve,\n    onRejected: onRejected || deferred.reject\n  });\n  return deferred.promise;\n}\n\n/**\n * Constructs a deferred instance that holds a promise and its resolve and\n * reject functions.\n *\n * @constructor\n */\nfunction Deferred(Promise) {\n  var deferred = this;\n  /** @type {!Promise} */\n  this.promise = new Promise(function(resolve, reject) {\n    /** @type {function(*=)} */\n    deferred.resolve = resolve;\n\n    /** @type {function(*=)} */\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n\n/**\n * Transitions the state of promise to another state. This is only ever called\n * on with a promise that is currently in the Pending state.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction adopt(promise, state, value, adoptee) {\n  var queue = promise._value;\n  promise._state = state;\n  promise._value = value;\n\n  if (adoptee && state === PendingPromise) {\n    adoptee._state(value, void 0, void 0, {\n      promise: promise,\n      resolve: void 0,\n      reject: void 0\n    });\n  }\n\n  for (var i = 0; i < queue.length; i++) {\n    var next = queue[i];\n    promise._state(\n      value,\n      next.onFulfilled,\n      next.onRejected,\n      next.deferred\n    );\n  }\n  queue.length = 0;\n\n  // Determine if this rejected promise will be \"handled\".\n  if (state === RejectedPromise && promise._isChainEnd) {\n    setTimeout(function() {\n      if (promise._isChainEnd) {\n        onPossiblyUnhandledRejection(value, promise);\n      }\n    }, 0);\n  }\n}\n\n/**\n * A partial application of adopt.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @returns {function(*=)}\n */\nfunction adopter(promise, state) {\n  return function(value) {\n    adopt(promise, state, value);\n  };\n}\n\n/**\n * Updates a deferred promises state. Necessary for updating an adopting\n * promise's state when the adoptee resolves.\n *\n * @param {?Deferred} deferred\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction deferredAdopt(deferred, state, value) {\n  if (deferred) {\n    var promise = deferred.promise;\n    promise._state = state;\n    promise._value = value;\n  }\n}\n\n/**\n * A no-op function to prevent double resolving.\n */\nfunction noop() {}\n\n/**\n * Tests if fn is a Function\n *\n * @param {*} fn\n * @returns {boolean}\n */\nfunction isFunction(fn) {\n  return typeof fn === 'function';\n}\n\n/**\n * Tests if fn is an Object\n *\n * @param {*} obj\n * @returns {boolean}\n */\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n/**\n * Iterates over each element of an array, calling the iterator with the\n * element and its index.\n *\n * @param {!Array} collection\n * @param {function(*=,number)} iterator\n */\nfunction each(collection, iterator) {\n  for (var i = 0; i < collection.length; i++) {\n    iterator(collection[i], i);\n  }\n}\n\n/**\n * Creates a function that will attempt to resolve the deferred with the return\n * of fn. If any error is raised, rejects instead.\n *\n * @param {!Deferred} deferred\n * @param {function(*=)} fn\n * @param {*} arg\n * @returns {function()}\n */\nfunction tryCatchDeferred(deferred, fn, arg) {\n  var promise = deferred.promise;\n  var resolve = deferred.resolve;\n  var reject = deferred.reject;\n  return function() {\n    try {\n      var result = fn(arg);\n      doResolve(promise, resolve, reject, result, result);\n    } catch (e) {\n      reject(e);\n    }\n  };\n}\n\n/**\n * Queues and executes multiple deferred functions on another run loop.\n */\nvar defer = (function() {\n  /**\n   * Defers fn to another run loop.\n   */\n  var scheduleFlush;\n  if (typeof window !== 'undefined' && window.postMessage) {\n    window.addEventListener('message', flush);\n    scheduleFlush = function() {\n      window.postMessage('macro-task', '*');\n    };\n  } else {\n    scheduleFlush = function() {\n      setTimeout(flush, 0);\n    };\n  }\n\n  var queue = new Array(16);\n  var length = 0;\n\n  function flush() {\n    for (var i = 0; i < length; i++) {\n      var fn = queue[i];\n      queue[i] = null;\n      fn();\n    }\n    length = 0;\n  }\n\n  /**\n   * @param {function()} fn\n   */\n  function defer(fn) {\n    if (length === 0) { scheduleFlush(); }\n    queue[length++] = fn;\n  }\n\n  return defer;\n})();\n\n/**\n * The Promise resolution procedure.\n * https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n *\n * @param {!Promise} promise\n * @param {function(*=)} resolve\n * @param {function(*=)} reject\n * @param {*} value\n * @param {*=} context\n */\nfunction doResolve(promise, resolve, reject, value, context) {\n  var _reject = reject;\n  var then;\n  var _resolve;\n  try {\n    if (value === promise) {\n      throw new TypeError('Cannot fulfill promise with itself');\n    }\n    var isObj = isObject(value);\n    if (isObj && value instanceof promise.constructor) {\n      adopt(promise, value._state, value._value, value);\n    } else if (isObj && (then = value.then) && isFunction(then)) {\n      _resolve = function(value) {\n        _resolve = _reject = noop;\n        doResolve(promise, resolve, reject, value, value);\n      };\n      _reject = function(reason) {\n        _resolve = _reject = noop;\n        reject(reason);\n      };\n      then.call(\n        context,\n        function(value) { _resolve(value); },\n        function(reason) { _reject(reason); }\n      );\n    } else {\n      resolve(value);\n    }\n  } catch (e) {\n    _reject(e);\n  }\n}\n\nmodule.exports = Promise;\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Common AMP events.\n * @enum {string}\n */\nexport const AmpEvents = {\n  BUILT: 'amp:built',\n  DOM_UPDATE: 'amp:dom-update',\n  VISIBILITY_CHANGE: 'amp:visibilitychange', // https://github.com/ampproject/amphtml/blob/master/ads/README.md#page-visibility\n  // The following codes are only used for testing.\n  // TODO(choumx): Move these to a separate enum so they can be DCE'd.\n  ATTACHED: 'amp:attached',\n  STUBBED: 'amp:stubbed',\n  LOAD_START: 'amp:load:start',\n  LOAD_END: 'amp:load:end',\n  ERROR: 'amp:error',\n};\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from './services';\n\n/**\n * Helper method to trigger analytics event if amp-analytics is available.\n * TODO: Do not expose this function\n * @param {!Element} target\n * @param {string} eventType\n * @param {!Object<string, string>=} opt_vars A map of vars and their values.\n */\nexport function triggerAnalyticsEvent(target, eventType, opt_vars) {\n  Services.analyticsForDocOrNull(target).then(analytics => {\n    if (!analytics) {\n      return;\n    }\n    analytics.triggerEventForTarget(target, eventType, opt_vars);\n  });\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Allows for runtime configuration. Internally, the runtime should\n * use the src/config.js module for various constants. We can use the\n * AMP_CONFIG global to translate user-defined configurations to this\n * module.\n * @type {!Object<string, string>}\n */\nconst env = self.AMP_CONFIG || {};\n\nconst thirdPartyFrameRegex = typeof env['thirdPartyFrameRegex'] == 'string' ?\n  new RegExp(env['thirdPartyFrameRegex']) : env['thirdPartyFrameRegex'];\n\nconst cdnProxyRegex = typeof env['cdnProxyRegex'] == 'string' ?\n  new RegExp(env['cdnProxyRegex']) : env['cdnProxyRegex'];\n\n/** @type {!Object<string, string|boolean|RegExp>} */\nexport const urls = {\n  thirdParty: env['thirdPartyUrl'] || 'https://3p.ampproject.net',\n  thirdPartyFrameHost: env['thirdPartyFrameHost'] || 'ampproject.net',\n  thirdPartyFrameRegex: thirdPartyFrameRegex || /^d-\\d+\\.ampproject\\.net$/,\n  cdn: env['cdnUrl'] || 'https://cdn.ampproject.org',\n  /* Note that cdnProxyRegex is only ever checked against origins\n   * (proto://host[:port]) so does not need to consider path\n   */\n  cdnProxyRegex: cdnProxyRegex ||\n      /^https:\\/\\/([a-zA-Z0-9_-]+\\.)?cdn\\.ampproject\\.org$/,\n  localhostRegex: /^https?:\\/\\/localhost(:\\d+)?$/,\n  errorReporting: env['errorReportingUrl'] ||\n      'https://amp-error-reporting.appspot.com/r',\n  localDev: env['localDev'] || false,\n};\n\nexport const config = {\n  urls,\n};\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {endsWith} from './string';\nimport {\n  isProxyOrigin,\n  parseUrlDeprecated,\n  tryDecodeUriComponent,\n} from './url';\nimport {urls} from './config';\n\n\n/**\n * Returns the value of the cookie. The cookie access is restricted and must\n * go through the privacy review. Before using this method please file a\n * GitHub issue with \"Privacy Review\" label.\n *\n * Returns the cookie's value or `null`.\n *\n * @param {!Window} win\n * @param {string} name\n * @return {?string}\n */\nexport function getCookie(win, name) {\n  const cookieString = tryGetDocumentCookieNoInline(win);\n  if (!cookieString) {\n    return null;\n  }\n  const cookies = cookieString.split(';');\n  for (let i = 0; i < cookies.length; i++) {\n    const cookie = cookies[i].trim();\n    const eq = cookie.indexOf('=');\n    if (eq == -1) {\n      continue;\n    }\n    if (tryDecodeUriComponent(cookie.substring(0, eq).trim()) == name) {\n      const value = cookie.substring(eq + 1).trim();\n      return tryDecodeUriComponent(value, value);\n    }\n  }\n  return null;\n}\n\n/**\n * This method should not be inlined to prevent TryCatch deoptimization.\n * NoInline keyword at the end of function name also prevents Closure compiler\n * from inlining the function.\n * @param {!Window} win\n * @return {string}\n */\nfunction tryGetDocumentCookieNoInline(win) {\n  try {\n    return win.document.cookie;\n  } catch (e) {\n    // Act as if no cookie is available. Exceptions can be thrown when\n    // AMP docs are opened on origins that do not allow setting\n    // cookies such as null origins.\n    return '';\n  }\n}\n\n/**\n * Sets the value of the cookie. The cookie access is restricted and must\n * go through the privacy review. Before using this method please file a\n * GitHub issue with \"Privacy Review\" label.\n *\n * @param {!Window} win\n * @param {string} name\n * @param {string} value\n * @param {time} expirationTime\n * @param {{\n *   highestAvailableDomain:(boolean|undefined),\n *   domain:(string|undefined)\n * }=} opt_options\n *     - highestAvailableDomain: If true, set the cookie at the widest domain\n *       scope allowed by the browser. E.g. on example.com if we are currently\n *       on www.example.com.\n *     - domain: Explicit domain to set.\n *     - allowOnProxyOrigin: Allow setting a cookie on the AMP Cache.\n */\nexport function setCookie(win, name, value, expirationTime, opt_options) {\n  checkOriginForSettingCookie(win, opt_options, name);\n  if (opt_options && opt_options.highestAvailableDomain) {\n    const parts = win.location.hostname.split('.');\n    let domain = parts[parts.length - 1];\n    for (let i = parts.length - 2; i >= 0; i--) {\n      domain = parts[i] + '.' + domain;\n      trySetCookie(win, name, value, expirationTime, domain);\n      if (getCookie(win, name) == value) {\n        return;\n      }\n    }\n  }\n  let domain = undefined;\n  if (opt_options && opt_options.domain) {\n    domain = opt_options.domain;\n  }\n  trySetCookie(win, name, value, expirationTime, domain);\n}\n\n/**\n * Attempt to set a cookie with the given params.\n *\n * @param {!Window} win\n * @param {string} name\n * @param {string} value\n * @param {time} expirationTime\n * @param {string|undefined} domain\n */\nfunction trySetCookie(win, name, value, expirationTime, domain) {\n  // We do not allow setting cookies on the domain that contains both\n  // the cdn. and www. hosts.\n  if (domain == 'ampproject.org') {\n    // Actively delete them.\n    value = 'delete';\n    expirationTime = 0;\n  }\n  const cookie = encodeURIComponent(name) + '=' +\n      encodeURIComponent(value) +\n      '; path=/' +\n      (domain ? '; domain=' + domain : '') +\n      '; expires=' + new Date(expirationTime).toUTCString();\n  try {\n    win.document.cookie = cookie;\n  } catch (ignore) {\n    // Do not throw if setting the cookie failed Exceptions can be thrown\n    // when AMP docs are opened on origins that do not allow setting\n    // cookies such as null origins.\n  }\n}\n\n/**\n * Throws if a given cookie should not be set on the given origin.\n * This is a defense-in-depth. Callers should never run into this.\n *\n * @param {!Window} win\n * @param {!Object|undefined} options\n * @param {string} name For the error message.\n */\nfunction checkOriginForSettingCookie(win, options, name) {\n  if (options && options.allowOnProxyOrigin) {\n    return;\n  }\n  if (isProxyOrigin(win.location.href)) {\n    throw new Error('Should never attempt to set cookie on proxy origin: '\n        + name);\n  }\n\n  const current = parseUrlDeprecated(win.location.href).hostname.toLowerCase();\n  const proxy = parseUrlDeprecated(urls.cdn).hostname.toLowerCase();\n  if (current == proxy || endsWith(current, '.' + proxy)) {\n    throw new Error('Should never attempt to set cookie on proxy origin.'\n        + ' (in depth check): ' + name);\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Deferred} from './utils/promise';\nimport {cssEscape} from '../third_party/css-escape/css-escape';\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {startsWith} from './string';\nimport {toWin} from './types';\n\nconst HTML_ESCAPE_CHARS = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;',\n};\nconst HTML_ESCAPE_REGEX = /(&|<|>|\"|'|`)/g;\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_PROMISE =\n    '__AMP_UPG_PRM';\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_RESOLVER =\n    '__AMP_UPG_RES';\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * callback is executed.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @param {function()} callback\n */\nexport function waitForChild(parent, checkFunc, callback) {\n  if (checkFunc(parent)) {\n    callback();\n    return;\n  }\n  /** @const {!Window} */\n  const win = toWin(parent.ownerDocument.defaultView);\n  if (win.MutationObserver) {\n    /** @const {MutationObserver} */\n    const observer = new win.MutationObserver(() => {\n      if (checkFunc(parent)) {\n        observer.disconnect();\n        callback();\n      }\n    });\n    observer.observe(parent, {childList: true});\n  } else {\n    /** @const {number} */\n    const interval = win.setInterval(() => {\n      if (checkFunc(parent)) {\n        win.clearInterval(interval);\n        callback();\n      }\n    }, /* milliseconds */ 5);\n  }\n}\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * promise is resolved.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @return {!Promise}\n */\nexport function waitForChildPromise(parent, checkFunc) {\n  return new Promise(resolve => {\n    waitForChild(parent, checkFunc, resolve);\n  });\n}\n\n/**\n * Waits for document's body to be available.\n * Will be deprecated soon; use {@link AmpDoc#whenBodyAvailable} or\n * @{link DocumentState#onBodyAvailable} instead.\n * @param {!Document} doc\n * @param {function()} callback\n */\nexport function waitForBody(doc, callback) {\n  waitForChild(doc.documentElement, () => !!doc.body, callback);\n}\n\n\n/**\n * Waits for document's body to be available.\n * @param {!Document} doc\n * @return {!Promise}\n */\nexport function waitForBodyPromise(doc) {\n  return new Promise(resolve => {\n    waitForBody(doc, resolve);\n  });\n}\n\n\n/**\n * Removes the element.\n * @param {!Element} element\n */\nexport function removeElement(element) {\n  if (element.parentElement) {\n    element.parentElement.removeChild(element);\n  }\n}\n\n\n/**\n * Removes all child nodes of the specified element.\n * @param {!Element} parent\n */\nexport function removeChildren(parent) {\n  while (parent.firstChild) {\n    parent.removeChild(parent.firstChild);\n  }\n}\n\n\n/**\n * Copies all children nodes of element \"from\" to element \"to\". Child nodes\n * are deeply cloned. Notice, that this method should be used with care and\n * preferably on smaller subtrees.\n * @param {!Element} from\n * @param {!Element|!DocumentFragment} to\n */\nexport function copyChildren(from, to) {\n  const frag = to.ownerDocument.createDocumentFragment();\n  for (let n = from.firstChild; n; n = n.nextSibling) {\n    frag.appendChild(n.cloneNode(true));\n  }\n  to.appendChild(frag);\n}\n\n/**\n * Insert the element in the root after the element named after or\n * if that is null at the beginning.\n * @param {!Element|!ShadowRoot} root\n * @param {!Element} element\n * @param {?Node} after\n */\nexport function insertAfterOrAtStart(root, element, after) {\n  const before = after ? after.nextSibling : root.firstChild;\n  root.insertBefore(element, before);\n}\n\n/**\n * Add attributes to an element.\n * @param {!Element} element\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function addAttributesToElement(element, attributes) {\n  for (const attr in attributes) {\n    element.setAttribute(attr, attributes[attr]);\n  }\n  return element;\n}\n\n/**\n * Create a new element on document with specified tagName and attributes.\n * @param {!Document} doc\n * @param {string} tagName\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function createElementWithAttributes(doc, tagName, attributes) {\n  const element = doc.createElement(tagName);\n  return addAttributesToElement(element, attributes);\n}\n\n/**\n * Returns true if node is connected (attached).\n * @param {!Node} node\n * @return {boolean}\n * @see https://dom.spec.whatwg.org/#connected\n */\nexport function isConnectedNode(node) {\n  const connected = node.isConnected;\n  if (connected !== undefined) {\n    return connected;\n  }\n\n  // \"An element is connected if its shadow-including root is a document.\"\n  let n = node;\n  do {\n    n = rootNodeFor(n);\n    if (n.host) {\n      n = n.host;\n    } else {\n      break;\n    }\n  } while (true);\n  return n.nodeType === Node.DOCUMENT_NODE;\n}\n\n/**\n * Returns the root for a given node. Does not cross shadow DOM boundary.\n * @param {!Node} node\n * @return {!Node}\n */\nexport function rootNodeFor(node) {\n  if (Node.prototype.getRootNode) {\n    // Type checker says `getRootNode` may return null.\n    return node.getRootNode() || node;\n  }\n  let n;\n  for (n = node; !!n.parentNode; n = n.parentNode) {}\n  return n;\n}\n\n/**\n * Finds the closest element that satisfies the callback from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {function(!Element):boolean} callback\n * @param {Element=} opt_stopAt optional elemnt to stop the search at.\n * @return {?Element}\n */\nexport function closest(element, callback, opt_stopAt) {\n  for (let el = element; el && el !== opt_stopAt; el = el.parentElement) {\n    if (callback(el)) {\n      return el;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest node that satisfies the callback from this node\n * up the DOM subtree.\n * @param {!Node} node\n * @param {function(!Node):boolean} callback\n * @return {?Node}\n */\nexport function closestNode(node, callback) {\n  for (let n = node; n; n = n.parentNode) {\n    if (callback(n)) {\n      return n;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest element with the specified name from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function closestByTag(element, tagName) {\n  if (element.closest) {\n    return element.closest(tagName);\n  }\n  tagName = tagName.toUpperCase();\n  return closest(element, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Finds the closest element with the specified selector from this element\n * @param {!Element} element\n * @param {string} selector\n * @return {?Element} closest ancestor if found.\n */\nexport function closestBySelector(element, selector) {\n  if (element.closest) {\n    return element.closest(selector);\n  }\n\n  return closest(element, el => {\n    return matches(el, selector);\n  });\n}\n\n/**\n * Checks if the given element matches the selector\n * @param  {!Element} el The element to verify\n * @param  {string} selector The selector to check against\n * @return {boolean} True if the element matched the selector. False otherwise.\n */\nexport function matches(el, selector) {\n  const matcher = el.matches ||\n      el.webkitMatchesSelector ||\n      el.mozMatchesSelector ||\n      el.msMatchesSelector ||\n      el.oMatchesSelector;\n  if (matcher) {\n    return matcher.call(el, selector);\n  }\n  return false; // IE8 always returns false.\n}\n\n/**\n * Finds the first descendant element with the specified name.\n * @param {!Element|!Document|!ShadowRoot} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function elementByTag(element, tagName) {\n  let elements;\n  // getElementsByTagName() is not supported on ShadowRoot.\n  if (typeof element.getElementsByTagName === 'function') {\n    elements = element.getElementsByTagName(tagName);\n  } else {\n    elements = element./*OK*/querySelectorAll(tagName);\n  }\n  return (elements && elements[0]) || null;\n}\n\n\n/**\n * Finds the first child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function childElement(parent, callback) {\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds all child elements that satisfy the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {!Array<!Element>}\n */\nexport function childElements(parent, callback) {\n  const children = [];\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      children.push(child);\n    }\n  }\n  return children;\n}\n\n\n/**\n * Finds the last child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function lastChildElement(parent, callback) {\n  for (let child = parent.lastElementChild; child;\n    child = child.previousElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n/**\n * Finds all child nodes that satisfy the callback.\n * These nodes can include Text, Comment and other child nodes.\n * @param {!Node} parent\n * @param {function(!Node):boolean} callback\n * @return {!Array<!Node>}\n */\nexport function childNodes(parent, callback) {\n  const nodes = [];\n  for (let child = parent.firstChild; child;\n    child = child.nextSibling) {\n    if (callback(child)) {\n      nodes.push(child);\n    }\n  }\n  return nodes;\n}\n\n/**\n * @type {boolean|undefined}\n * @visibleForTesting\n */\nlet scopeSelectorSupported;\n\n/**\n * @param {boolean|undefined} val\n * @visibleForTesting\n */\nexport function setScopeSelectorSupportedForTesting(val) {\n  scopeSelectorSupported = val;\n}\n\n/**\n * Test that the :scope selector is supported and behaves correctly.\n * @param {!Element} parent\n * @return {boolean}\n */\nfunction isScopeSelectorSupported(parent) {\n  const doc = parent.ownerDocument;\n  try {\n    const testElement = doc.createElement('div');\n    const testChild = doc.createElement('div');\n    testElement.appendChild(testChild);\n    // NOTE(cvializ, #12383): Firefox's implementation is incomplete,\n    // therefore we test actual functionality of`:scope` as well.\n    return testElement./*OK*/querySelector(':scope div') === testChild;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Finds the first child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function childElementByAttr(parent, attr) {\n  return scopedQuerySelector/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the last child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function lastChildElementByAttr(parent, attr) {\n  return lastChildElement(parent, el => {\n    return el.hasAttribute(attr);\n  });\n}\n\n\n/**\n * Finds all child elements that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByAttr(parent, attr) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the first child element that has the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {?Element}\n */\nexport function childElementByTag(parent, tagName) {\n  return scopedQuerySelector/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds all child elements with the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByTag(parent, tagName) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds the first element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {?Element}\n */\nexport function scopedQuerySelector(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelector(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const element = root./*OK*/querySelector(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return element;\n}\n\n\n/**\n * Finds the every element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {!NodeList<!Element>}\n */\nexport function scopedQuerySelectorAll(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelectorAll(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const elements = root./*OK*/querySelectorAll(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return elements;\n}\n\n\n/**\n * Returns element data-param- attributes as url parameters key-value pairs.\n * e.g. data-param-some-attr=value -> {someAttr: value}.\n * @param {!Element} element\n * @param {function(string):string=} opt_computeParamNameFunc to compute the\n *    parameter name, get passed the camel-case parameter name.\n * @param {!RegExp=} opt_paramPattern Regex pattern to match data attributes.\n * @return {!JsonObject}\n */\nexport function getDataParamsFromAttributes(element, opt_computeParamNameFunc,\n  opt_paramPattern) {\n  const computeParamNameFunc = opt_computeParamNameFunc || (key => key);\n  const {dataset} = element;\n  const params = dict();\n  const paramPattern = opt_paramPattern ? opt_paramPattern : /^param(.+)/;\n  for (const key in dataset) {\n    const matches = key.match(paramPattern);\n    if (matches) {\n      const param = matches[1][0].toLowerCase() + matches[1].substr(1);\n      params[computeParamNameFunc(param)] = dataset[key];\n    }\n  }\n  return params;\n}\n\n/**\n * Whether the element have a next node in the document order.\n * This means either:\n *  a. The element itself has a nextSibling.\n *  b. Any of the element ancestors has a nextSibling.\n * @param {!Element} element\n * @param {?Node} opt_stopNode\n * @return {boolean}\n */\nexport function hasNextNodeInDocumentOrder(element, opt_stopNode) {\n  let currentElement = element;\n  do {\n    if (currentElement.nextSibling) {\n      return true;\n    }\n  } while ((currentElement = currentElement.parentNode) &&\n            currentElement != opt_stopNode);\n  return false;\n}\n\n\n/**\n * Finds all ancestor elements that satisfy predicate.\n * @param {!Element} child\n * @param {function(!Element):boolean} predicate\n * @return {!Array<!Element>}\n */\nexport function ancestorElements(child, predicate) {\n  const ancestors = [];\n  for (let ancestor = child.parentElement; ancestor;\n    ancestor = ancestor.parentElement) {\n    if (predicate(ancestor)) {\n      ancestors.push(ancestor);\n    }\n  }\n  return ancestors;\n}\n\n\n/**\n * Finds all ancestor elements that has the specified tag name.\n * @param {!Element} child\n * @param {string} tagName\n * @return {!Array<!Element>}\n */\nexport function ancestorElementsByTag(child, tagName) {\n  tagName = tagName.toUpperCase();\n  return ancestorElements(child, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Returns a clone of the content of a template element.\n *\n * Polyfill to replace .content access for browsers that do not support\n * HTMLTemplateElements natively.\n *\n * @param {!HTMLTemplateElement|!Element} template\n * @return {!DocumentFragment}\n */\nexport function templateContentClone(template) {\n  if ('content' in template) {\n    return template.content.cloneNode(true);\n  } else {\n    const content = template.ownerDocument.createDocumentFragment();\n    copyChildren(template, content);\n    return content;\n  }\n}\n\n/**\n * Iterate over an array-like. Some collections like NodeList are\n * lazily evaluated in some browsers, and accessing `length` forces full\n * evaluation. We can improve performance by iterating until an element is\n * `undefined` to avoid checking the `length` property.\n * Test cases: https://jsperf.com/iterating-over-collections-of-elements\n * @param {!IArrayLike<T>} iterable\n * @param {function(T, number)} cb\n * @template T\n */\nexport function iterateCursor(iterable, cb) {\n  for (let i = 0, value; (value = iterable[i]) !== undefined; i++) {\n    cb(value, i);\n  }\n}\n\n/**\n * This method wraps around window's open method. It first tries to execute\n * `open` call with the provided target and if it fails, it retries the call\n * with the `_top` target. This is necessary given that in some embedding\n * scenarios, such as iOS' WKWebView, navigation to `_blank` and other targets\n * is blocked by default.\n *\n * @param {!Window} win\n * @param {string} url\n * @param {string} target\n * @param {string=} opt_features\n * @return {?Window}\n */\nexport function openWindowDialog(win, url, target, opt_features) {\n  // Try first with the specified target. If we're inside the WKWebView or\n  // a similar environments, this method is expected to fail by default for\n  // all targets except `_top`.\n  let res;\n  try {\n    res = win.open(url, target, opt_features);\n  } catch (e) {\n    dev().error('DOM', 'Failed to open url on target: ', target, e);\n  }\n\n  // Then try with `_top` target.\n  if (!res && target != '_top') {\n    res = win.open(url, '_top');\n  }\n  return res;\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n            element.getAttribute('type').toUpperCase() == 'APPLICATION/JSON';\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonLdScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n      element.getAttribute('type').toUpperCase() == 'APPLICATION/LD+JSON';\n}\n\n/**\n * Whether the page's direction is right to left or not.\n * @param {!Document} doc\n * @return {boolean}\n */\nexport function isRTL(doc) {\n  const dir = doc.body.getAttribute('dir')\n                 || doc.documentElement.getAttribute('dir')\n                 || 'ltr';\n  return dir == 'rtl';\n}\n\n\n/**\n * Escapes an ident (ID or a class name) to be used as a CSS selector.\n *\n * See https://drafts.csswg.org/cssom/#serialize-an-identifier.\n *\n * @param {string} ident\n * @return {string}\n */\nexport function escapeCssSelectorIdent(ident) {\n  return cssEscape(ident);\n}\n\n/**\n * Escapes an ident in a way that can be used by :nth-child() psuedo-class.\n *\n * See https://github.com/w3c/csswg-drafts/issues/2306.\n *\n * @param {string|number} ident\n * @return {string}\n */\nexport function escapeCssSelectorNth(ident) {\n  const escaped = String(ident);\n  // Ensure it doesn't close the nth-child psuedo class.\n  dev().assert(escaped.indexOf(')') === -1);\n  return escaped;\n}\n\n/**\n * Escapes `<`, `>` and other HTML charcaters with their escaped forms.\n * @param {string} text\n * @return {string}\n */\nexport function escapeHtml(text) {\n  if (!text) {\n    return text;\n  }\n  return text.replace(HTML_ESCAPE_REGEX, escapeHtmlChar);\n}\n\n/**\n * @param {string} c\n * @return {string}\n */\nfunction escapeHtmlChar(c) {\n  return HTML_ESCAPE_CHARS[c];\n}\n\n/**\n * Tries to focus on the given element; fails silently if browser throws an\n * exception.\n * @param {!Element} element\n */\nexport function tryFocus(element) {\n  try {\n    element./*OK*/focus();\n  } catch (e) {\n    // IE <= 7 may throw exceptions when focusing on hidden items.\n  }\n}\n\n/**\n * Whether the given window is in an iframe or not.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isIframed(win) {\n  return win.parent && win.parent != win;\n}\n\n/**\n * Determines if this element is an AMP element\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isAmpElement(element) {\n  const tag = element.tagName;\n  // Use prefix to recognize AMP element. This is necessary because stub\n  // may not be attached yet.\n  return startsWith(tag, 'AMP-') &&\n      // Some \"amp-*\" elements are not really AMP elements. :smh:\n      !(tag == 'AMP-STICKY-AD-TOP-PADDING' || tag == 'AMP-BODY');\n}\n\n/**\n * Return a promise that resolve when an AMP element upgrade from HTMLElement\n * to CustomElement\n * @param {!Element} element\n * @return {!Promise<!Element>}\n */\nexport function whenUpgradedToCustomElement(element) {\n  dev().assert(isAmpElement(element), 'element is not AmpElement');\n  if (element.createdCallback) {\n    // Element already is CustomElement;\n    return Promise.resolve(element);\n  }\n  // If Element is still HTMLElement, wait for it to upgrade to customElement\n  // Note: use pure string to avoid obfuscation between versions.\n  if (!element[UPGRADE_TO_CUSTOMELEMENT_PROMISE]) {\n    const deferred = new Deferred();\n    element[UPGRADE_TO_CUSTOMELEMENT_PROMISE] = deferred.promise;\n    element[UPGRADE_TO_CUSTOMELEMENT_RESOLVER] = deferred.resolve;\n\n  }\n\n  return element[UPGRADE_TO_CUSTOMELEMENT_PROMISE];\n}\n\n/**\n * Replacement for `Element.requestFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Element/requestFullscreen\n * @param {!Element} element\n */\nexport function fullscreenEnter(element) {\n  const requestFs = element.requestFullscreen\n   || element.requestFullScreen\n   || element.webkitRequestFullscreen\n   || element.webkitRequestFullScreen\n   || element.webkitEnterFullscreen\n   || element.webkitEnterFullScreen\n   || element.msRequestFullscreen\n   || element.msRequestFullScreen\n   || element.mozRequestFullscreen\n   || element.mozRequestFullScreen;\n  if (requestFs) {\n    requestFs.call(element);\n  }\n}\n\n/**\n * Replacement for `Document.exitFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/exitFullscreen\n * @param {!Element} element\n */\nexport function fullscreenExit(element) {\n  let exitFs = element.cancelFullScreen\n               || element.exitFullscreen\n               || element.exitFullScreen\n               || element.webkitExitFullscreen\n               || element.webkitExitFullScreen\n               || element.webkitCancelFullScreen\n               || element.mozCancelFullScreen\n               || element.msExitFullscreen;\n  if (exitFs) {\n    exitFs.call(element);\n    return;\n  }\n  if (element.ownerDocument) {\n    exitFs = element.ownerDocument.cancelFullScreen\n             || element.ownerDocument.exitFullscreen\n             || element.ownerDocument.exitFullScreen\n             || element.ownerDocument.webkitExitFullscreen\n             || element.ownerDocument.webkitExitFullScreen\n             || element.ownerDocument.webkitCancelFullScreen\n             || element.ownerDocument.mozCancelFullScreen\n             || element.ownerDocument.msExitFullscreen;\n  }\n  if (exitFs) {\n    exitFs.call(element.ownerDocument);\n    return;\n  }\n}\n\n\n/**\n * Replacement for `Document.fullscreenElement`.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/fullscreenElement\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isFullscreenElement(element) {\n  const isFullscreen = element.webkitDisplayingFullscreen;\n  if (isFullscreen) {\n    return true;\n  }\n  if (element.ownerDocument) {\n    const fullscreenElement = element.ownerDocument.fullscreenElement\n             || element.ownerDocument.webkitFullscreenElement\n             || element.ownerDocument.mozFullScreenElement\n             || element.webkitCurrentFullScreenElement;\n    if (fullscreenElement == element) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Returns true if node is not disabled.\n *\n * IE8 can return false positives, see {@link matches}.\n * @param {!Element} element\n * @return {boolean}\n * @see https://www.w3.org/TR/html5/forms.html#concept-fe-disabled\n */\nexport function isEnabled(element) {\n  return !(element.disabled || matches(element, ':disabled'));\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as dom from './dom';\nimport {\n  getAmpdoc,\n  getExistingServiceForDocInEmbedScope,\n  getService,\n  getServicePromise,\n  getServicePromiseForDoc,\n  getServicePromiseOrNull,\n  getServicePromiseOrNullForDoc,\n  getTopWindow,\n} from './service';\nimport {toWin} from './types';\nimport {user} from './log';\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. Services.viewportForDoc(...)) for type safety and because the\n * factory should not be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an element,\n *     not the extension.\n * @return {!Promise<*>}\n */\nexport function getElementService(win, id, extension, opt_element) {\n  return getElementServiceIfAvailable(win, id, extension, opt_element).then(\n      service => assertService(service, id, extension));\n}\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailable(win, id, extension, opt_element) {\n  const s = getServicePromiseOrNull(win, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n  return getElementServicePromiseOrNull(win, id, extension, opt_element);\n}\n\n/**\n * @param {!Window} win\n * @param {string} elementName Name of an extended custom element.\n * @return {boolean} Whether this element is scheduled to be loaded.\n */\nfunction isElementScheduled(win, elementName) {\n  // Set in custom-element.js\n  if (!win.ampExtendedElements) {\n    return false;\n  }\n  return !!win.ampExtendedElements[elementName];\n}\n\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. Services.viewportForDoc(...)) for type safety and because the\n * factory should not be passed around.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an element,\n *     not the extension.\n * @return {!Promise<*>}\n */\nexport function getElementServiceForDoc(elementOrAmpDoc, id, extension,\n  opt_element) {\n  return getElementServiceIfAvailableForDoc(\n      elementOrAmpDoc, id, extension, opt_element)\n      .then(service => assertService(service, id, extension));\n}\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDoc(\n  elementOrAmpDoc, id, extension, opt_element) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const s = getServicePromiseOrNullForDoc(elementOrAmpDoc, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n\n  return ampdoc.whenBodyAvailable()\n      .then(() => waitForExtensionIfPresent(\n          ampdoc.win, extension,\n          ampdoc.getHeadNode()))\n      .then(() => {\n        // If this service is provided by an element, then we can't depend on\n        // the service (they may not use the element).\n        if (opt_element) {\n          return getServicePromiseOrNullForDoc(elementOrAmpDoc, id);\n        } else if (isElementScheduled(ampdoc.win, extension)) {\n          return getServicePromiseForDoc(elementOrAmpDoc, id);\n        }\n        return null;\n      });\n}\n\n/**\n * Returns a promise for service for the given id in the embed scope of\n * a given node, if it exists. Otherwise, falls back to ampdoc scope IFF\n * the given node is in the top-level window.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom element that provides\n *     the implementation of this service.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDocInEmbedScope(\n  elementOrAmpDoc, id, extension) {\n  const s = getExistingServiceForDocInEmbedScope(elementOrAmpDoc, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (Promise.resolve(s));\n  }\n  // Return embed-scope element service promise if scheduled.\n  if (elementOrAmpDoc.nodeType) {\n    const win = toWin(elementOrAmpDoc.ownerDocument.defaultView);\n    const topWin = getTopWindow(win);\n    // In embeds, doc-scope services are window-scope. But make sure to\n    // only do this for embeds (not the top window), otherwise we'd grab\n    // a promise from the wrong service holder which would never resolve.\n    if (win !== topWin) {\n      return getElementServicePromiseOrNull(win, id, extension);\n    } else {\n      // Fallback to ampdoc IFF the given node is _not_ FIE.\n      return getElementServiceIfAvailableForDoc(elementOrAmpDoc, id, extension);\n    }\n  }\n  return /** @type {!Promise<?Object>} */ (Promise.resolve(null));\n}\n\n/**\n * Throws user error if `service` is null.\n * @param {Object} service\n * @param {string} id\n * @param {string} extension\n * @return {!Object}\n * @private\n */\nfunction assertService(service, id, extension) {\n  return /** @type {!Object} */ (user().assert(service,\n      'Service %s was requested to be provided through %s, ' +\n      'but %s is not loaded in the current page. To fix this ' +\n      'problem load the JavaScript file for %s in this page.',\n      id, extension, extension, extension));\n}\n\n/**\n * Get list of all the extension JS files\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @return {!Array<string>}\n */\nexport function extensionScriptsInNode(head) {\n  // ampdoc.getHeadNode() can return null\n  if (!head) {\n    return [];\n  }\n  const scripts = [];\n  const list = head.querySelectorAll('script[custom-element]');\n  for (let i = 0; i < list.length; i++) {\n    scripts.push(list[i].getAttribute('custom-element'));\n  }\n  return scripts;\n}\n\n/**\n * Waits for body to be present then verifies that an extension script is\n * present in head for installation.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n * @param {string} extensionId\n * @return {!Promise<boolean>}\n */\nexport function isExtensionScriptInNode(ampdoc, extensionId) {\n  return ampdoc.whenBodyAvailable()\n      .then(() => {\n        return extensionScriptInNode(\n            ampdoc.getHeadNode(), extensionId);\n      });\n}\n\n/**\n * Verifies that an extension script is present in head for\n * installation.\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @param {string} extensionId\n * @private\n */\nfunction extensionScriptInNode(head, extensionId) {\n  return extensionScriptsInNode(head).includes(extensionId);\n}\n\n/**\n * Waits for an extension if its script is present\n * @param {!Window} win\n * @param {string} extension\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @return {!Promise}\n * @private\n */\nfunction waitForExtensionIfPresent(win, extension, head) {\n  /**\n   * If there is an extension script wait for it to load before trying\n   * to get the service. Prevents a race condition when everything but\n   * the extensions is in cache. If there is no script then it's either\n   * not present, or the service was defined by a test. In those cases\n   * we don't wait around for an extension that does not exist.\n   */\n\n  // TODO(jpettitt) investigate registerExtension to short circuit\n  // the dom call in extensionScriptsInNode()\n  if (!extensionScriptInNode(head, extension)) {\n    return Promise.resolve();\n  }\n\n  const extensions = getService(win, 'extensions');\n  return /** @type {!Promise<?Object>} */ (\n    extensions.waitForExtension(win, extension));\n}\n\n/**\n * Returns the promise for service with `id` on the given window if available.\n * Otherwise, resolves with null (service was not registered).\n * @param {!Window} win\n * @param {string} id\n * @param {string} extension\n * @param {boolean=} opt_element\n * @return {!Promise<Object>}\n * @private\n */\nfunction getElementServicePromiseOrNull(win, id, extension, opt_element) {\n  return dom.waitForBodyPromise(win.document)\n      .then(() => waitForExtensionIfPresent(win, extension, win.document.head))\n      .then(() => {\n        // If this service is provided by an element, then we can't depend on\n        // the service (they may not use the element).\n        if (opt_element) {\n          return getServicePromiseOrNull(win, id);\n        } else if (isElementScheduled(win, extension)) {\n          return getServicePromise(win, id);\n        }\n        return null;\n      });\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nimport {AmpEvents} from './amp-events';\nimport {Services} from './services';\nimport {\n  USER_ERROR_SENTINEL,\n  dev,\n  duplicateErrorIfNecessary,\n  isUserErrorEmbed,\n  isUserErrorMessage,\n} from './log';\nimport {experimentTogglesOrNull, getBinaryType, isCanary} from './experiments';\nimport {exponentialBackoff} from './exponential-backoff';\nimport {getMode} from './mode';\nimport {isExperimentOn} from './experiments';\nimport {\n  isLoadErrorMessage,\n} from './event-helper';\nimport {isProxyOrigin} from './url';\nimport {makeBodyVisible} from './style-installer';\nimport {startsWith} from './string';\nimport {triggerAnalyticsEvent} from './analytics';\nimport {urls} from './config';\n\n/**\n * @const {string}\n */\nconst CANCELLED = 'CANCELLED';\n\n/**\n * @const {string}\n */\nconst BLOCK_BY_CONSENT = 'BLOCK_BY_CONSENT';\n\n\n/**\n * The threshold for errors throttled because nothing can be done about\n * them, but we'd still like to report the rough number.\n * @const {number}\n */\nconst NON_ACTIONABLE_ERROR_THROTTLE_THRESHOLD = 0.001;\n\n/**\n * The threshold for errors throttled because nothing can be done about\n * them, but we'd still like to report the rough number.\n * @const {number}\n */\nconst USER_ERROR_THROTTLE_THRESHOLD = 0.1;\n\n\n/**\n * Collects error messages, so they can be included in subsequent reports.\n * That allows identifying errors that might be caused by previous errors.\n */\nlet accumulatedErrorMessages = self.AMPErrors || [];\n// Use a true global, to avoid multi-module inclusion issues.\nself.AMPErrors = accumulatedErrorMessages;\n\n/**\n * Pushes element into array, keeping at most the most recent limit elements\n *\n * @param {!Array<T>} array\n * @param {T} element\n * @param {number} limit\n * @template T\n */\nfunction pushLimit(array, element, limit) {\n  if (array.length >= limit) {\n    array.splice(0, array.length - limit + 1);\n  }\n  array.push(element);\n}\n\n/**\n * A wrapper around our exponentialBackoff, to lazy initialize it to avoid an\n * un-DCE'able side-effect.\n * @param {function()} work the function to execute after backoff\n * @return {number} the setTimeout id\n */\nlet reportingBackoff = function(work) {\n  // Set reportingBackoff as the lazy-created function. JS Vooodoooo.\n  reportingBackoff = exponentialBackoff(1.5);\n  return reportingBackoff(work);\n};\n\n/**\n * Attempts to stringify a value, falling back to String.\n * @param {*} value\n * @return {string}\n */\nfunction tryJsonStringify(value) {\n  try {\n    // Cast is fine, because we really don't care here. Just trying.\n    return JSON.stringify(/** @type {!JsonObject} */ (value));\n  } catch (e) {\n    return String(value);\n  }\n}\n\n/**\n * The true JS engine, as detected by inspecting an Error stack. This should be\n * used with the userAgent to tell definitely. I.e., Chrome on iOS is really a\n * Safari JS engine.\n */\nlet detectedJsEngine;\n\n/**\n * @param {!Window} win\n * @param {*} error\n * @param {!Element=} opt_associatedElement\n */\nexport function reportErrorForWin(win, error, opt_associatedElement) {\n  reportError(error, opt_associatedElement);\n  if (error && !!win && isUserErrorMessage(error.message)\n      && !isUserErrorEmbed(error.message)) {\n    reportErrorToAnalytics(/** @type {!Error} */(error), win);\n  }\n}\n\n/**\n * Reports an error. If the error has an \"associatedElement\" property\n * the element is marked with the `i-amphtml-element-error` and displays\n * the message itself. The message is always send to the console.\n * If the error has a \"messageArray\" property, that array is logged.\n * This way one gets the native fidelity of the console for things like\n * elements instead of stringification.\n * @param {*} error\n * @param {!Element=} opt_associatedElement\n * @return {!Error}\n */\nexport function reportError(error, opt_associatedElement) {\n  try {\n    // Convert error to the expected type.\n    let isValidError;\n    if (error) {\n      if (error.message !== undefined) {\n        error = duplicateErrorIfNecessary(/** @type {!Error} */(error));\n        isValidError = true;\n      } else {\n        const origError = error;\n        error = new Error(tryJsonStringify(origError));\n        error.origError = origError;\n      }\n    } else {\n      error = new Error('Unknown error');\n    }\n    // Report if error is not an expected type.\n    if (!isValidError && getMode().localDev && !getMode().test) {\n      setTimeout(function() {\n        const rethrow = new Error(\n            '_reported_ Error reported incorrectly: ' + error);\n        throw rethrow;\n      });\n    }\n\n    if (error.reported) {\n      return /** @type {!Error} */ (error);\n    }\n    error.reported = true;\n\n    // Update element.\n    const element = opt_associatedElement || error.associatedElement;\n    if (element && element.classList) {\n      element.classList.add('i-amphtml-error');\n      if (getMode().development) {\n        element.classList.add('i-amphtml-element-error');\n        element.setAttribute('error-message', error.message);\n      }\n    }\n\n    // Report to console.\n    if (self.console) {\n      const output = (console.error || console.log);\n      if (error.messageArray) {\n        output.apply(console, error.messageArray);\n      } else {\n        if (element) {\n          output.call(console, error.message, element);\n        } else if (!getMode().minified) {\n          output.call(console, error.stack);\n        } else {\n          output.call(console, error.message);\n        }\n      }\n    }\n    if (element && element.dispatchCustomEventForTesting) {\n      element.dispatchCustomEventForTesting(AmpEvents.ERROR, error.message);\n    }\n\n    // 'call' to make linter happy. And .call to make compiler happy\n    // that expects some @this.\n    reportErrorToServer['call'](undefined, undefined, undefined, undefined,\n        undefined, error);\n  } catch (errorReportingError) {\n    setTimeout(function() {\n      throw errorReportingError;\n    });\n  }\n  return /** @type {!Error} */ (error);\n}\n\n/**\n * Returns an error for a cancellation of a promise.\n * @return {!Error}\n */\nexport function cancellation() {\n  return new Error(CANCELLED);\n}\n\n/**\n * @param {*} errorOrMessage\n * @return {boolean}\n */\nexport function isCancellation(errorOrMessage) {\n  if (!errorOrMessage) {\n    return false;\n  }\n  if (typeof errorOrMessage == 'string') {\n    return startsWith(errorOrMessage, CANCELLED);\n  }\n  if (typeof errorOrMessage.message == 'string') {\n    return startsWith(errorOrMessage.message, CANCELLED);\n  }\n  return false;\n}\n\n/**\n * Returns an error for component blocked by consent\n * @return {!Error}\n */\nexport function blockedByConsentError() {\n  return new Error(BLOCK_BY_CONSENT);\n}\n\n/**\n * @param {*} errorOrMessage\n * @return {boolean}\n */\nexport function isBlockedByConsent(errorOrMessage) {\n  if (!errorOrMessage) {\n    return false;\n  }\n  if (typeof errorOrMessage == 'string') {\n    return startsWith(errorOrMessage, BLOCK_BY_CONSENT);\n  }\n  if (typeof errorOrMessage.message == 'string') {\n    return startsWith(errorOrMessage.message, BLOCK_BY_CONSENT);\n  }\n  return false;\n}\n\n\n/**\n * Install handling of global unhandled exceptions.\n * @param {!Window} win\n */\nexport function installErrorReporting(win) {\n  win.onerror = /** @type {!Function} */ (reportErrorToServer);\n  win.addEventListener('unhandledrejection', event => {\n    if (event.reason &&\n      (event.reason.message === CANCELLED ||\n      event.reason.message === BLOCK_BY_CONSENT)) {\n      event.preventDefault();\n      return;\n    }\n    reportError(event.reason || new Error('rejected promise ' + event));\n  });\n}\n\n/**\n * Signature designed, so it can work with window.onerror\n * @param {string|undefined} message\n * @param {string|undefined} filename\n * @param {string|undefined} line\n * @param {string|undefined} col\n * @param {*|undefined} error\n * @this {!Window|undefined}\n */\nfunction reportErrorToServer(message, filename, line, col, error) {\n  // Make an attempt to unhide the body.\n  if (this && this.document) {\n    makeBodyVisible(this.document);\n  }\n  if (getMode().localDev || getMode().development || getMode().test) {\n    return;\n  }\n  let hasNonAmpJs = false;\n  try {\n    hasNonAmpJs = detectNonAmpJs(self);\n  } catch (ignore) {\n    // Ignore errors during error report generation.\n  }\n  if (hasNonAmpJs && Math.random() > 0.01) {\n    // Only report 1% of errors on pages with non-AMP JS.\n    // These errors can almost never be acted upon, but spikes such as\n    // due to buggy browser extensions may be helpful to notify authors.\n    return;\n  }\n  const data = getErrorReportData(message, filename, line, col, error,\n      hasNonAmpJs);\n  if (data) {\n    // Report the error to viewer if it has the capability. The data passed\n    // to the viewer is exactly the same as the data passed to the server\n    // below.\n    maybeReportErrorToViewer(this, data);\n    reportingBackoff(() => {\n      const xhr = new XMLHttpRequest();\n      xhr.open('POST', urls.errorReporting, true);\n      xhr.send(JSON.stringify(data));\n    });\n  }\n}\n\n/**\n * Passes the given error data to the viewer if the following criteria is met:\n * - The viewer is a trusted viewer\n * - The viewer has the `errorReporter` capability\n * - The AMP doc is in single doc mode\n * - The AMP doc is opted-in for error interception (`<html>` tag has the\n *   `report-errors-to-viewer` attribute)\n *\n * @param {!Window} win\n * @param {!JsonObject} data Data from `getErrorReportData`.\n * @return {!Promise<boolean>} `Promise<True>` if the error was sent to the\n *     viewer, `Promise<False>` otherwise.\n * @visibleForTesting\n */\nexport function maybeReportErrorToViewer(win, data) {\n  const ampdocService = Services.ampdocServiceFor(win);\n  if (!ampdocService.isSingleDoc()) {\n    return Promise.resolve(false);\n  }\n  const ampdocSingle = ampdocService.getAmpDoc();\n  const htmlElement = ampdocSingle.getRootNode().documentElement;\n  const docOptedIn = htmlElement.hasAttribute('report-errors-to-viewer');\n  if (!docOptedIn) {\n    return Promise.resolve(false);\n  }\n\n  const viewer = Services.viewerForDoc(ampdocSingle);\n  if (!viewer.hasCapability('errorReporter')) {\n    return Promise.resolve(false);\n  }\n\n  return viewer.isTrustedViewer().then(viewerTrusted => {\n    if (!viewerTrusted) {\n      return false;\n    }\n    viewer.sendMessage('error', data);\n    return true;\n  });\n}\n\n/**\n * Signature designed, so it can work with window.onerror\n * @param {string|undefined} message\n * @param {string|undefined} filename\n * @param {string|undefined} line\n * @param {string|undefined} col\n * @param {*|undefined} error\n * @param {boolean} hasNonAmpJs\n * @return {!JsonObject|undefined} The data to post\n * visibleForTesting\n */\nexport function getErrorReportData(message, filename, line, col, error,\n  hasNonAmpJs) {\n  let expected = false;\n  if (error) {\n    if (error.message) {\n      message = error.message;\n    } else {\n      // This should never be a string, but sometimes it is.\n      message = String(error);\n    }\n    // An \"expected\" error is still an error, i.e. some features are disabled\n    // or not functioning fully because of it. However, it's an expected\n    // error. E.g. as is the case with some browser API missing (storage).\n    // Thus, the error can be classified differently by log aggregators.\n    // The main goal is to monitor that an \"expected\" error doesn't deteriorate\n    // over time. It's impossible to completely eliminate it.\n    if (error.expected) {\n      expected = true;\n    }\n  }\n  if (!message) {\n    message = 'Unknown error';\n  }\n  if (/_reported_/.test(message)) {\n    return;\n  }\n  if (message == CANCELLED) {\n    return;\n  }\n\n  const detachedWindow = !(self && self.window);\n  const throttleBase = Math.random();\n\n  // We throttle load errors and generic \"Script error.\" errors\n  // that have no information and thus cannot be acted upon.\n  if (isLoadErrorMessage(message) ||\n    // See https://github.com/ampproject/amphtml/issues/7353\n    // for context.\n    message == 'Script error.' ||\n    // Window has become detached, really anything can happen\n    // at this point.\n    detachedWindow) {\n    expected = true;\n\n    if (throttleBase > NON_ACTIONABLE_ERROR_THROTTLE_THRESHOLD) {\n      return;\n    }\n  }\n\n  const isUserError = isUserErrorMessage(message);\n\n  // Only report a subset of user errors.\n  if (isUserError && throttleBase > USER_ERROR_THROTTLE_THRESHOLD) {\n    return;\n  }\n\n  // This is the App Engine app in\n  // https://github.com/ampproject/error-tracker\n  // It stores error reports via https://cloud.google.com/error-reporting/\n  // for analyzing production issues.\n  const data = /** @type {!JsonObject} */ (Object.create(null));\n  data['v'] = getMode().rtvVersion;\n  data['noAmp'] = hasNonAmpJs ? '1' : '0';\n  data['m'] = message.replace(USER_ERROR_SENTINEL, '');\n  data['a'] = isUserError ? '1' : '0';\n\n  // Errors are tagged with \"ex\" (\"expected\") label to allow loggers to\n  // classify these errors as benchmarks and not exceptions.\n  data['ex'] = expected ? '1' : '0';\n  data['dw'] = detachedWindow ? '1' : '0';\n\n  let runtime = '1p';\n  if (self.context && self.context.location) {\n    data['3p'] = '1';\n    runtime = '3p';\n  } else if (getMode().runtime) {\n    runtime = getMode().runtime;\n  }\n  data['rt'] = runtime;\n\n  // TODO(erwinm): Remove ca when all systems read `bt` instead of `ca` to\n  // identify js binary type.\n  data['ca'] = isCanary(self) ? '1' : '0';\n\n  // Pass binary type.\n  data['bt'] = getBinaryType(self);\n\n  if (self.location.ancestorOrigins && self.location.ancestorOrigins[0]) {\n    data['or'] = self.location.ancestorOrigins[0];\n  }\n  if (self.viewerState) {\n    data['vs'] = self.viewerState;\n  }\n  // Is embedded?\n  if (self.parent && self.parent != self) {\n    data['iem'] = '1';\n  }\n\n  if (self.AMP && self.AMP.viewer) {\n    const resolvedViewerUrl = self.AMP.viewer.getResolvedViewerUrl();\n    const messagingOrigin = self.AMP.viewer.maybeGetMessagingOrigin();\n    if (resolvedViewerUrl) {\n      data['rvu'] = resolvedViewerUrl;\n    }\n    if (messagingOrigin) {\n      data['mso'] = messagingOrigin;\n    }\n  }\n\n  if (!detectedJsEngine) {\n    detectedJsEngine = detectJsEngineFromStack();\n  }\n  data['jse'] = detectedJsEngine;\n\n  const exps = [];\n  const experiments = experimentTogglesOrNull(self);\n  for (const exp in experiments) {\n    const on = experiments[exp];\n    exps.push(`${exp}=${on ? '1' : '0'}`);\n  }\n  data['exps'] = exps.join(',');\n\n  if (error) {\n    const tagName = error.associatedElement\n      ? error.associatedElement.tagName\n      : 'u'; // Unknown\n    data['el'] = tagName;\n\n    if (error.args) {\n      data['args'] = JSON.stringify(error.args);\n    }\n\n    if (!isUserError && !error.ignoreStack && error.stack) {\n      data['s'] = error.stack;\n    }\n\n    error.message += ' _reported_';\n  } else {\n    data['f'] = filename || '';\n    data['l'] = line || '';\n    data['c'] = col || '';\n  }\n  data['r'] = self.document.referrer;\n  data['ae'] = accumulatedErrorMessages.join(',');\n  data['fr'] = self.location.originalHash || self.location.hash;\n\n  pushLimit(accumulatedErrorMessages, message, 25);\n\n  return data;\n}\n\n/**\n * Returns true if it appears like there is non-AMP JS on the\n * current page.\n * @param {!Window} win\n * @return {boolean}\n * @visibleForTesting\n */\nexport function detectNonAmpJs(win) {\n  const scripts = win.document.querySelectorAll('script[src]');\n  for (let i = 0; i < scripts.length; i++) {\n    if (!isProxyOrigin(scripts[i].src.toLowerCase())) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Resets accumulated error messages for testing\n */\nexport function resetAccumulatedErrorMessagesForTesting() {\n  accumulatedErrorMessages = [];\n}\n\n/**\n * Does a series of checks on the stack of an thrown error to determine the\n * JS engine that is currently running. This gives a bit more information than\n * just the UserAgent, since browsers often allow overriding it to \"emulate\"\n * mobile.\n * @return {string}\n * @visibleForTesting\n */\nexport function detectJsEngineFromStack() {\n  /** @constructor */\n  function Fn() {}\n  Fn.prototype.t = function() {\n    throw new Error('message');\n  };\n  const object = new Fn();\n  try {\n    object.t();\n  } catch (e) {\n    const {stack} = e;\n\n    // Safari only mentions the method name.\n    if (startsWith(stack, 't@')) {\n      return 'Safari';\n    }\n\n    // Firefox mentions \"prototype\".\n    if (stack.indexOf('.prototype.t@') > -1) {\n      return 'Firefox';\n    }\n\n    // IE looks like Chrome, but includes a context for the base stack line.\n    // Explicitly, we're looking for something like:\n    // \"    at Global code (https://example.com/app.js:1:200)\" or\n    // \"    at Anonymous function (https://example.com/app.js:1:200)\"\n    // vs Chrome which has:\n    // \"    at https://example.com/app.js:1:200\"\n    const last = stack.split('\\n').pop();\n    if (/\\bat .* \\(/i.test(last)) {\n      return 'IE';\n    }\n\n    // Finally, chrome includes the error message in the stack.\n    if (startsWith(stack, 'Error: message')) {\n      return 'Chrome';\n    }\n  }\n\n  return 'unknown';\n}\n\n/**\n * @param {!Error} error\n * @param {!Window} win\n */\nexport function reportErrorToAnalytics(error, win) {\n  if (isExperimentOn(win, 'user-error-reporting')) {\n    const vars = {\n      'errorName': error.name,\n      'errorMessage': error.message,\n    };\n    triggerAnalyticsEvent(getRootElement_(win), 'user-error', vars);\n  }\n}\n\n/**\n * @param {!Window} win\n * @return {!Element}\n * @private\n */\nfunction getRootElement_(win) {\n  const root = Services.ampdocServiceFor(win).getAmpDoc().getRootNode();\n  return dev().assertElement(root.documentElement || root.body || root);\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n  * Whether addEventListener supports options or only takes capture as a boolean\n  * @type {boolean|undefined}\n  * @visibleForTesting\n  */\nlet optsSupported;\n\n/**\n * Listens for the specified event on the element.\n *\n * Do not use this directly. This method is implemented as a shared\n * dependency. Use `listen()` in either `event-helper` or `3p-frame-messaging`,\n * depending on your use case.\n *\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function internalListenImplementation(element, eventType, listener,\n  opt_evtListenerOpts) {\n  let localElement = element;\n  let localListener = listener;\n  /**\n   * @type {?Function}\n   */\n  let wrapped;\n\n  wrapped = event => {\n    try {\n      return localListener(event);\n    } catch (e) {\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n  };\n  const optsSupported = detectEvtListenerOptsSupport();\n  let capture = false;\n  if (opt_evtListenerOpts) {\n    capture = opt_evtListenerOpts.capture;\n  }\n  localElement.addEventListener(\n      eventType,\n      wrapped,\n      optsSupported ? opt_evtListenerOpts : capture\n  );\n  return () => {\n    if (localElement) {\n      localElement.removeEventListener(\n          eventType,\n          wrapped,\n          optsSupported ? opt_evtListenerOpts : capture\n      );\n    }\n    // Ensure these are GC'd\n    localListener = null;\n    localElement = null;\n    wrapped = null;\n  };\n}\n\n/**\n * Tests whether the browser supports options as an argument of addEventListener\n * or not.\n *\n * @return {boolean}\n */\nexport function detectEvtListenerOptsSupport() {\n  // Only run the test once\n  if (optsSupported !== undefined) {\n    return optsSupported;\n  }\n\n  optsSupported = false;\n  try {\n    // Test whether browser supports EventListenerOptions or not\n    const options = {\n      get capture() {\n        optsSupported = true;\n      },\n    };\n    self.addEventListener('test-options', null, options);\n    self.removeEventListener('test-options', null, options);\n  } catch (err) {\n    // EventListenerOptions are not supported\n  }\n  return optsSupported;\n}\n\n/**\n  * Resets the test for whether addEventListener supports options or not.\n  */\nexport function resetEvtListenerOptsSupportForTesting() {\n  optsSupported = undefined;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {internalListenImplementation} from './event-helper-listen';\nimport {user} from './log';\n\n/** @const {string}  */\nconst LOAD_FAILURE_PREFIX = 'Failed to load:';\n\n/**\n * Returns a CustomEvent with a given type and detail; supports fallback for IE.\n * @param {!Window} win\n * @param {string} type\n * @param {!JsonObject|string|undefined|null} detail\n * @param {EventInit=} opt_eventInit\n * @return {!Event}\n */\nexport function createCustomEvent(win, type, detail, opt_eventInit) {\n  const eventInit = /** @type {!CustomEventInit} */ ({detail});\n  Object.assign(eventInit, opt_eventInit);\n  // win.CustomEvent is a function on Edge, Chrome, FF, Safari but\n  // is an object on IE 11.\n  if (typeof win.CustomEvent == 'function') {\n    return new win.CustomEvent(type, eventInit);\n  } else {\n    // Deprecated fallback for IE.\n    const e = win.document.createEvent('CustomEvent');\n    e.initCustomEvent(\n        type, !!eventInit.bubbles, !!eventInit.cancelable, detail);\n    return e;\n  }\n}\n\n/**\n * Listens for the specified event on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listen(element, eventType, listener, opt_evtListenerOpts) {\n  return internalListenImplementation(\n      element, eventType, listener, opt_evtListenerOpts);\n}\n\n/**\n * Returns the data property of an event with the correct type.\n * @param {!Event|{data: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getData(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.data);\n}\n\n/**\n * Returns the detail property of an event with the correct type.\n * @param {!Event|{detail: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getDetail(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.detail);\n}\n\n/**\n * Listens for the specified event on the element and removes the listener\n * as soon as event has been received.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listenOnce(element, eventType, listener, opt_evtListenerOpts) {\n  let localListener = listener;\n  const unlisten = internalListenImplementation(element, eventType, event => {\n    try {\n      localListener(event);\n    } finally {\n      // Ensure listener is GC'd\n      localListener = null;\n      unlisten();\n    }\n  }, opt_evtListenerOpts);\n  return unlisten;\n}\n\n\n/**\n * Returns  a promise that will resolve as soon as the specified event has\n * fired on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {Object=} opt_evtListenerOpts\n * @param {function(!UnlistenDef)=} opt_cancel An optional function that, when\n *     provided, will be called with the unlistener. This gives the caller\n *     access to the unlistener, so it may be called manually when necessary.\n * @return {!Promise<!Event>}\n */\nexport function listenOncePromise(element, eventType, opt_evtListenerOpts,\n  opt_cancel) {\n  let unlisten;\n  const eventPromise = new Promise(resolve => {\n    unlisten = listenOnce(element, eventType, resolve, opt_evtListenerOpts);\n  });\n  eventPromise.then(unlisten, unlisten);\n  if (opt_cancel) {\n    opt_cancel(unlisten);\n  }\n  return eventPromise;\n}\n\n\n/**\n * Whether the specified element/window has been loaded already.\n * @param {!Element|!Window} eleOrWindow\n * @return {boolean}\n */\nexport function isLoaded(eleOrWindow) {\n  return !!(eleOrWindow.complete || eleOrWindow.readyState == 'complete'\n      // If the passed in thing is a Window, infer loaded state from\n      //\n      || (eleOrWindow.document\n          && eleOrWindow.document.readyState == 'complete'));\n}\n\n/**\n * Returns a promise that will resolve or fail based on the eleOrWindow's 'load'\n * and 'error' events. Optionally this method takes a timeout, which will reject\n * the promise if the resource has not loaded by then.\n * @param {T} eleOrWindow Supports both Elements and as a special case Windows.\n * @return {!Promise<T>}\n * @template T\n */\nexport function loadPromise(eleOrWindow) {\n  let unlistenLoad;\n  let unlistenError;\n  if (isLoaded(eleOrWindow)) {\n    return Promise.resolve(eleOrWindow);\n  }\n  const loadingPromise = new Promise((resolve, reject) => {\n    // Listen once since IE 5/6/7 fire the onload event continuously for\n    // animated GIFs.\n    const {tagName} = eleOrWindow;\n    if (tagName === 'AUDIO' || tagName === 'VIDEO') {\n      unlistenLoad = listenOnce(eleOrWindow, 'loadstart', resolve);\n    } else {\n      unlistenLoad = listenOnce(eleOrWindow, 'load', resolve);\n    }\n    // For elements, unlisten on error (don't for Windows).\n    if (tagName) {\n      unlistenError = listenOnce(eleOrWindow, 'error', reject);\n    }\n  });\n\n  return loadingPromise.then(() => {\n    if (unlistenError) {\n      unlistenError();\n    }\n    return eleOrWindow;\n  }, () => {\n    if (unlistenLoad) {\n      unlistenLoad();\n    }\n    failedToLoad(eleOrWindow);\n  });\n}\n\n/**\n * Emit error on load failure.\n * @param {!Element|!Window} eleOrWindow Supports both Elements and as a special\n *     case Windows.\n */\nfunction failedToLoad(eleOrWindow) {\n  // Report failed loads as user errors so that they automatically go\n  // into the \"document error\" bucket.\n  let target = eleOrWindow;\n  if (target && target.src) {\n    target = target.src;\n  }\n  throw user().createError(LOAD_FAILURE_PREFIX, target);\n}\n\n/**\n * Returns true if this error message is was created for a load error.\n * @param {string} message An error message\n * @return {boolean}\n */\nexport function isLoadErrorMessage(message) {\n  return message.indexOf(LOAD_FAILURE_PREFIX) != -1;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Experiments system allows a developer to opt-in to test\n * features that are not yet fully tested.\n *\n * Experiments page: https://cdn.ampproject.org/experiments.html *\n */\n\nimport {getCookie, setCookie} from './cookies';\nimport {hasOwn} from './utils/object';\nimport {parseQueryString} from './url';\n\n/** @const {string} */\nconst COOKIE_NAME = 'AMP_EXP';\n\n/** @const {number} */\nconst COOKIE_MAX_AGE_DAYS = 180; // 6 month\n\n/** @const {time} */\nconst COOKIE_EXPIRATION_INTERVAL = COOKIE_MAX_AGE_DAYS * 24 * 60 * 60 * 1000;\n\n/** @const {string} */\nconst TOGGLES_WINDOW_PROPERTY = '__AMP__EXPERIMENT_TOGGLES';\n\n/**\n * @typedef {{\n *   isTrafficEligible: function(!Window):boolean,\n *   branches: !Array<string>\n * }}\n */\nexport let ExperimentInfo;\n\n/**\n * Whether we are in canary.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isCanary(win) {\n  return !!(win.AMP_CONFIG && win.AMP_CONFIG.canary);\n}\n\n/**\n * Returns binary type, e.g., canary, control, or production.\n * @param {!Window} win\n * @return {string}\n */\nexport function getBinaryType(win) {\n  return win.AMP_CONFIG && win.AMP_CONFIG.type ?\n    win.AMP_CONFIG.type : 'unknown';\n}\n\n/**\n * Whether the specified experiment is on or off.\n * @param {!Window} win\n * @param {string} experimentId\n * @return {boolean}\n */\nexport function isExperimentOn(win, experimentId) {\n  const toggles = experimentToggles(win);\n  return !!toggles[experimentId];\n}\n\n/**\n * Toggles the experiment on or off. Returns the actual value of the experiment\n * after toggling is done.\n * @param {!Window} win\n * @param {string} experimentId\n * @param {boolean=} opt_on\n * @param {boolean=} opt_transientExperiment  Whether to toggle the\n *     experiment state \"transiently\" (i.e., for this page load only) or\n *     durably (by saving the experiment IDs to the cookie after toggling).\n *     Default: false (save durably).\n * @return {boolean} New state for experimentId.\n */\nexport function toggleExperiment(win, experimentId, opt_on,\n  opt_transientExperiment) {\n  const currentlyOn = isExperimentOn(win, /*OK*/experimentId);\n  const on = !!(opt_on !== undefined ? opt_on : !currentlyOn);\n  if (on != currentlyOn) {\n    const toggles = experimentToggles(win);\n    toggles[experimentId] = on;\n\n    if (!opt_transientExperiment) {\n      const cookieToggles = getExperimentTogglesFromCookie(win);\n      cookieToggles[experimentId] = on;\n      saveExperimentTogglesToCookie(win, cookieToggles);\n    }\n  }\n  return on;\n}\n\n/**\n * Calculate whether the experiment is on or off based off of the\n * cookieFlag or the global config frequency given.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nexport function experimentToggles(win) {\n  if (win[TOGGLES_WINDOW_PROPERTY]) {\n    return win[TOGGLES_WINDOW_PROPERTY];\n  }\n  win[TOGGLES_WINDOW_PROPERTY] = Object.create(null);\n  const toggles = win[TOGGLES_WINDOW_PROPERTY];\n\n  // Read the default config of this build.\n  if (win.AMP_CONFIG) {\n    for (const experimentId in win.AMP_CONFIG) {\n      const frequency = win.AMP_CONFIG[experimentId];\n      if (typeof frequency === 'number' && frequency >= 0 && frequency <= 1) {\n        toggles[experimentId] = Math.random() < frequency;\n      }\n    }\n  }\n  // Read document level override from meta tag.\n  if (win.AMP_CONFIG\n      && Array.isArray(win.AMP_CONFIG['allow-doc-opt-in'])\n      && win.AMP_CONFIG['allow-doc-opt-in'].length > 0) {\n    const allowed = win.AMP_CONFIG['allow-doc-opt-in'];\n    const meta =\n        win.document.head.querySelector('meta[name=\"amp-experiments-opt-in\"]');\n    if (meta) {\n      const optedInExperiments = meta.getAttribute('content').split(',');\n      for (let i = 0; i < optedInExperiments.length; i++) {\n        if (allowed.indexOf(optedInExperiments[i]) != -1) {\n          toggles[optedInExperiments[i]] = true;\n        }\n      }\n    }\n  }\n\n  Object.assign(toggles, getExperimentTogglesFromCookie(win));\n\n  if (win.AMP_CONFIG\n      && Array.isArray(win.AMP_CONFIG['allow-url-opt-in'])\n      && win.AMP_CONFIG['allow-url-opt-in'].length > 0) {\n    const allowed = win.AMP_CONFIG['allow-url-opt-in'];\n    const hash = win.location.originalHash || win.location.hash;\n    const params = parseQueryString(hash);\n    for (let i = 0; i < allowed.length; i++) {\n      const param = params[`e-${allowed[i]}`];\n      if (param == '1') {\n        toggles[allowed[i]] = true;\n      }\n      if (param == '0') {\n        toggles[allowed[i]] = false;\n      }\n    }\n  }\n  return toggles;\n}\n\n/**\n * Returns the cached experiments toggles, or null if they have not been\n * computed yet.\n * @param {!Window} win\n * @return {Object<string, boolean>}\n */\nexport function experimentTogglesOrNull(win) {\n  return win[TOGGLES_WINDOW_PROPERTY] || null;\n}\n\n/**\n * Returns a set of experiment IDs currently on.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nfunction getExperimentTogglesFromCookie(win) {\n  const experimentCookie = getCookie(win, COOKIE_NAME);\n  const tokens = experimentCookie ? experimentCookie.split(/\\s*,\\s*/g) : [];\n\n  const toggles = Object.create(null);\n  for (let i = 0; i < tokens.length; i++) {\n    if (tokens[i].length == 0) {\n      continue;\n    }\n    if (tokens[i][0] == '-') {\n      toggles[tokens[i].substr(1)] = false;\n    } else {\n      toggles[tokens[i]] = true;\n    }\n  }\n\n  return toggles;\n}\n\n/**\n * Saves a set of experiment IDs currently on.\n * @param {!Window} win\n * @param {!Object<string, boolean>} toggles\n */\nfunction saveExperimentTogglesToCookie(win, toggles) {\n  const experimentIds = [];\n  for (const experiment in toggles) {\n    experimentIds.push((toggles[experiment] === false ? '-' : '') + experiment);\n  }\n\n  setCookie(win, COOKIE_NAME, experimentIds.join(','),\n      Date.now() + COOKIE_EXPIRATION_INTERVAL, {\n        // Set explicit domain, so the cookie gets send to sub domains.\n        domain: win.location.hostname,\n        allowOnProxyOrigin: true,\n      });\n}\n\n/**\n * See getExperimentTogglesFromCookie().\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n * @visibleForTesting\n */\nexport function getExperimentToglesFromCookieForTesting(win) {\n  return getExperimentTogglesFromCookie(win);\n}\n\n/**\n * Resets the experimentsToggle cache for testing purposes.\n * @param {!Window} win\n * @visibleForTesting\n */\nexport function resetExperimentTogglesForTesting(win) {\n  setCookie(win, COOKIE_NAME, '', 0, {\n    domain: win.location.hostname,\n  });\n  win[TOGGLES_WINDOW_PROPERTY] = null;\n}\n\n/**\n * In some browser implementations of Math.random(), sequential calls of\n * Math.random() are correlated and can cause a bias.  In particular,\n * if the previous random() call was < 0.001 (as it will be if we select\n * into an experiment), the next value could be less than 0.5 more than\n * 50.7% of the time.  This provides an implementation that roots down into\n * the crypto API, when available, to produce less biased samples.\n *\n * @return {number} Pseudo-random floating-point value on the range [0, 1).\n */\nfunction slowButAccuratePrng() {\n  // TODO(tdrl): Implement.\n  return Math.random();\n}\n\n/**\n * Container for alternate random number generator implementations.  This\n * allows us to set an \"accurate\" PRNG for branch selection, but to mock it\n * out easily in tests.\n *\n * @visibleForTesting\n * @const {!{accuratePrng: function():number}}\n */\nexport const RANDOM_NUMBER_GENERATORS = {\n  accuratePrng: slowButAccuratePrng,\n};\n\n/**\n * Selects, uniformly at random, a single item from the array.\n * @param {!Array<string>} arr Object to select from.\n * @return {?string} Single item from arr or null if arr was empty.\n */\nfunction selectRandomItem(arr) {\n  const rn = RANDOM_NUMBER_GENERATORS.accuratePrng();\n  return arr[Math.floor(rn * arr.length)] || null;\n}\n\n/**\n * Selects which page-level experiment branches are enabled. If a given\n * experiment name is already set (including to the null / no branches selected\n * state), this won't alter its state.\n *\n * Check whether a given experiment is set using isExperimentOn(win,\n * experimentName) and, if it is on, look for which branch is selected in\n * win.experimentBranches[experimentName].\n *\n * @param {!Window} win Window context on which to save experiment\n *     selection state.\n * @param {!Object<string, !ExperimentInfo>} experiments  Set of experiments to\n *     configure for this page load.\n * @return {!Object<string, string>} Map of experiment names to selected\n *     branches.\n */\nexport function randomlySelectUnsetExperiments(win, experiments) {\n  win.experimentBranches = win.experimentBranches || {};\n  const selectedExperiments = {};\n  for (const experimentName in experiments) {\n    // Skip experimentName if it is not a key of experiments object or if it\n    // has already been populated by some other property.\n    if (!hasOwn(experiments, experimentName)) {\n      continue;\n    }\n    if (hasOwn(win.experimentBranches, experimentName)) {\n      selectedExperiments[experimentName] =\n          win.experimentBranches[experimentName];\n      continue;\n    }\n\n    if (!experiments[experimentName].isTrafficEligible ||\n        !experiments[experimentName].isTrafficEligible(win)) {\n      win.experimentBranches[experimentName] = null;\n      continue;\n    }\n\n    // If we're in the experiment, but we haven't already forced a specific\n    // experiment branch (e.g., via a test setup), then randomize the branch\n    // choice.\n    if (!win.experimentBranches[experimentName] &&\n      isExperimentOn(win, /*OK*/experimentName)) {\n      const {branches} = experiments[experimentName];\n      win.experimentBranches[experimentName] = selectRandomItem(branches);\n      selectedExperiments[experimentName] =\n          win.experimentBranches[experimentName];\n    }\n  }\n  return selectedExperiments;\n}\n\n/**\n * Returns the experiment branch enabled for the given experiment ID.\n * For example, 'control' or 'experiment'.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @return {?string} Active experiment branch ID for experimentName (possibly\n *     null if experimentName has been tested but no branch was enabled).\n */\nexport function getExperimentBranch(win, experimentName) {\n  return win.experimentBranches ? win.experimentBranches[experimentName] : null;\n}\n\n/**\n * Force enable (or disable) a specific branch of a given experiment name.\n * Disables the experiment name altogether if branchId is falseish.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @param {?string} branchId ID of branch to force or null to disable\n *     altogether.\n * @visibleForTesting\n */\nexport function forceExperimentBranch(win, experimentName, branchId) {\n  win.experimentBranches = win.experimentBranches || {};\n  toggleExperiment(win, experimentName, !!branchId, true);\n  win.experimentBranches[experimentName] = branchId;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * @param {number=} opt_base Exponential base. Defaults to 2.\n * @return {function(function()): number} Function that when invoked will\n *     call the passed in function. On every invocation the next\n *     invocation of the passed in function will be exponentially\n *     later. Returned function returns timeout id.\n */\nexport function exponentialBackoff(opt_base) {\n  const getTimeout = exponentialBackoffClock(opt_base);\n  return work => {\n    return setTimeout(work, getTimeout());\n  };\n}\n\n/**\n * @param {number=} opt_base Exponential base. Defaults to 2.\n * @return {function(): number} Function that when invoked will return\n *    a number that exponentially grows per invocation.\n */\nexport function exponentialBackoffClock(opt_base) {\n  const base = opt_base || 2;\n  let count = 0;\n  return () => {\n    let wait = Math.pow(base, count++);\n    wait += getJitter(wait);\n    return wait * 1000;\n  };\n}\n\n/**\n * Add jitter to avoid the thundering herd. This can e.g. happen when\n * we poll a backend and it fails for everyone at the same time.\n * We add up to 30% (default) longer or shorter than the given time.\n *\n * @param {number} wait the amount if base milliseconds\n * @param {number=} opt_perc the min/max percentage to add or sutract\n * @return {number}\n */\nexport function getJitter(wait, opt_perc) {\n  opt_perc = opt_perc || .3;\n  let jitter = wait * opt_perc * Math.random();\n  if (Math.random() > .5) {\n    jitter *= -1;\n  }\n  return jitter;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview This module declares JSON types as defined in the\n * {@link http://json.org/}.\n */\n\nimport {isObject} from './types';\n\n\n// NOTE Type are changed to {*} because of\n// https://github.com/google/closure-compiler/issues/1999\n\n/**\n * JSON scalar. It's either string, number or boolean.\n * @typedef {*} should be string|number|boolean\n */\nlet JSONScalarDef;\n\n\n/**\n * JSON object. It's a map with string keys and JSON values.\n * @typedef {*} should be !Object<string, ?JSONValueDef>\n */\nlet JSONObjectDef;\n\n\n/**\n * JSON array. It's an array with JSON values.\n * @typedef {*} should be !Array<?JSONValueDef>\n */\nlet JSONArrayDef;\n\n\n/**\n * JSON value. It's either a scalar, an object or an array.\n * @typedef {*} should be !JSONScalarDef|!JSONObjectDef|!JSONArrayDef\n */\nlet JSONValueDef;\n\n/**\n * Recreates objects with prototype-less copies.\n * @param {!JsonObject} obj\n * @return {!JsonObject}\n */\nexport function recreateNonProtoObject(obj) {\n  const copy = Object.create(null);\n  for (const k in obj) {\n    if (!hasOwnProperty(obj, k)) {\n      continue;\n    }\n    const v = obj[k];\n    copy[k] = isObject(v) ? recreateNonProtoObject(v) : v;\n  }\n  return /** @type {!JsonObject} */ (copy);\n}\n\n/**\n * Returns a value from an object for a field-based expression. The expression\n * is a simple nested dot-notation of fields, such as `field1.field2`. If any\n * field in a chain does not exist or is not an object or array, the returned\n * value will be `undefined`.\n *\n * @param {!JsonObject} obj\n * @param {string} expr\n * @return {*}\n */\nexport function getValueForExpr(obj, expr) {\n  // The `.` indicates \"the object itself\".\n  if (expr == '.') {\n    return obj;\n  }\n  // Otherwise, navigate via properties.\n  const parts = expr.split('.');\n  let value = obj;\n  for (let i = 0; i < parts.length; i++) {\n    const part = parts[i];\n    if (part &&\n        value &&\n        value[part] !== undefined &&\n        hasOwnProperty(value, part)\n    ) {\n      value = value[part];\n      continue;\n    }\n    value = undefined;\n    break;\n  }\n  return value;\n}\n\n/**\n * Simple wrapper around JSON.parse that casts the return value\n * to JsonObject.\n * Create a new wrapper if an array return value is desired.\n * @param {*} json JSON string to parse\n * @return {?JsonObject} May be extend to parse arrays.\n */\nexport function parseJson(json) {\n  return /** @type {?JsonObject} */(JSON.parse(/** @type {string} */ (json)));\n}\n\n/**\n * Parses the given `json` string without throwing an exception if not valid.\n * Returns `undefined` if parsing fails.\n * Returns the `Object` corresponding to the JSON string when parsing succeeds.\n * @param {*} json JSON string to parse\n * @param {function(!Error)=} opt_onFailed Optional function that will be called\n *     with the error if parsing fails.\n * @return {?JsonObject|undefined} May be extend to parse arrays.\n */\nexport function tryParseJson(json, opt_onFailed) {\n  try {\n    return parseJson(json);\n  } catch (e) {\n    if (opt_onFailed) {\n      opt_onFailed(e);\n    }\n    return undefined;\n  }\n}\n\n/**\n * Recursively checks strict equality of items in nested arrays and objects.\n *\n * @param {JSONValueDef} a\n * @param {JSONValueDef} b\n * @param {number} depth The maximum recursion depth. Must be finite.\n * @return {boolean}\n * @throws {Error} If depth argument is not finite.\n */\nexport function recursiveEquals(a, b, depth = 3) {\n  if (!isFinite(depth)) {\n    throw new Error('depth arg must be finite: ' + depth);\n  }\n  if (a === b) {\n    return true;\n  }\n  // Only check shallow equality for depth < 1.\n  if (depth < 1) {\n    return false;\n  }\n  if (typeof a !== typeof b) {\n    return false;\n  }\n  if (Array.isArray(a) && Array.isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n    for (let i = 0; i < a.length; i++) {\n      if (!recursiveEquals(a[i], b[i], depth - 1)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\n    const keysA = Object.keys(/** @type {!Object} */ (a));\n    const keysB = Object.keys(/** @type {!Object} */ (b));\n    if (keysA.length !== keysB.length) {\n      return false;\n    }\n    for (let i = 0; i < keysA.length; i++) {\n      const keyA = keysA[i];\n      const valueA = a[keyA];\n      const valueB = b[keyA];\n      if (!recursiveEquals(valueA, valueB, depth - 1)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {*} obj\n * @param {string} key\n * @return {boolean}\n */\nfunction hasOwnProperty(obj, key) {\n  if (obj == null || typeof obj != 'object') {\n    return false;\n  }\n  return Object.prototype.hasOwnProperty.call(\n      /** @type {!Object} */ (obj), key);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {getModeObject} from './mode-object';\nimport {isEnumValue} from './types';\n\n/**\n * Triple zero width space.\n *\n * This is added to user error messages, so that we can later identify\n * them, when the only thing that we have is the message. This is the\n * case in many browsers when the global exception handler is invoked.\n *\n * @const {string}\n */\nexport const USER_ERROR_SENTINEL = '\\u200B\\u200B\\u200B';\n\n\n/**\n * Four zero width space.\n *\n * @const {string}\n */\nexport const USER_ERROR_EMBED_SENTINEL = '\\u200B\\u200B\\u200B\\u200B';\n\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a user error.\n */\nexport function isUserErrorMessage(message) {\n  return message.indexOf(USER_ERROR_SENTINEL) >= 0;\n}\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a a user error from an iframe embed.\n */\nexport function isUserErrorEmbed(message) {\n  return message.indexOf(USER_ERROR_EMBED_SENTINEL) >= 0;\n}\n\n\n/**\n * @enum {number}\n * @private Visible for testing only.\n */\nexport const LogLevel = {\n  OFF: 0,\n  ERROR: 1,\n  WARN: 2,\n  INFO: 3,\n  FINE: 4,\n};\n\n/**\n * Sets reportError function. Called from error.js to break cyclic\n * dependency.\n * @param {function(*, !Element=)|undefined} fn\n */\nexport function setReportError(fn) {\n  self.reportError = fn;\n}\n\n/**\n * @type {!LogLevel|undefined}\n * @private\n */\nlet levelOverride_ = undefined;\n\n/**\n * @param {!LogLevel} level\n */\nexport function overrideLogLevel(level) {\n  levelOverride_ = level;\n}\n\n/**\n * Logging class. Use of sentinel string instead of a boolean to check user/dev\n * errors because errors could be rethrown by some native code as a new error,\n * and only a message would survive. Also, some browser don’t support a 5th\n * error object argument in window.onerror. List of supporting browser can be\n * found here:\n * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n * @final\n * @private Visible for testing only.\n */\nexport class Log {\n  /**\n   * opt_suffix will be appended to error message to identify the type of the\n   * error message. We can't rely on the error object to pass along the type\n   * because some browsers do not have this param in its window.onerror API.\n   * See:\n   * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n   *\n   * @param {!Window} win\n   * @param {function(!./mode.ModeDef):!LogLevel} levelFunc\n   * @param {string=} opt_suffix\n   */\n  constructor(win, levelFunc, opt_suffix) {\n    /**\n     * In tests we use the main test window instead of the iframe where\n     * the tests runs because only the former is relayed to the console.\n     * @const {!Window}\n     */\n    this.win = (getMode().test && win.AMP_TEST_IFRAME) ? win.parent : win;\n\n    /** @private @const {function(!./mode.ModeDef):!LogLevel} */\n    this.levelFunc_ = levelFunc;\n\n    /** @private @const {!LogLevel} */\n    this.level_ = this.defaultLevel_();\n\n    /** @private @const {string} */\n    this.suffix_ = opt_suffix || '';\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  getLevel_() {\n    return (levelOverride_ !== undefined) ? levelOverride_ : this.level_;\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  defaultLevel_() {\n    // No console - can't enable logging.\n    if (!this.win.console || !this.win.console.log) {\n      return LogLevel.OFF;\n    }\n\n    // Logging has been explicitly disabled.\n    if (getMode().log == '0') {\n      return LogLevel.OFF;\n    }\n\n    // Logging is enabled for tests directly.\n    if (getMode().test && this.win.ENABLE_LOG) {\n      return LogLevel.FINE;\n    }\n\n    // LocalDev by default allows INFO level, unless overriden by `#log`.\n    if (getMode().localDev && !getMode().log) {\n      return LogLevel.INFO;\n    }\n\n    // Delegate to the specific resolver.\n    return this.levelFunc_(getModeObject());\n  }\n\n  /**\n   * @param {string} tag\n   * @param {string} level\n   * @param {!Array} messages\n   */\n  msg_(tag, level, messages) {\n    if (this.getLevel_() != LogLevel.OFF) {\n      let fn = this.win.console.log;\n      if (level == 'ERROR') {\n        fn = this.win.console.error || fn;\n      } else if (level == 'INFO') {\n        fn = this.win.console.info || fn;\n      } else if (level == 'WARN') {\n        fn = this.win.console.warn || fn;\n      }\n      if (getMode().localDev) {\n        messages.unshift('[' + tag + ']');\n      }\n      fn.apply(this.win.console, messages);\n    }\n  }\n\n  /**\n   * Whether the logging is enabled.\n   * @return {boolean}\n   */\n  isEnabled() {\n    return this.getLevel_() != LogLevel.OFF;\n  }\n\n  /**\n   * Reports a fine-grained message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  fine(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.FINE) {\n      this.msg_(tag, 'FINE', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a informational message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  info(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.INFO) {\n      this.msg_(tag, 'INFO', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a warning message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  warn(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.WARN) {\n      this.msg_(tag, 'WARN', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports an error message. If the logging is disabled, the error is rethrown\n   * asynchronously.\n   * @param {string} tag\n   * @param {...*} var_args\n   * @return {!Error|undefined}\n   * @private\n   */\n  error_(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.ERROR) {\n      this.msg_(tag, 'ERROR', Array.prototype.slice.call(arguments, 1));\n    } else {\n      const error = createErrorVargs.apply(null,\n          Array.prototype.slice.call(arguments, 1));\n      this.prepareError_(error);\n      return error;\n    }\n  }\n\n  /**\n   * Reports an error message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  error(tag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.name = tag || error.name;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Reports an error message and marks with an expected property. If the\n   * logging is disabled, the error is rethrown asynchronously.\n   * @param {string} unusedTag\n   * @param {...*} var_args\n   */\n  expectedError(unusedTag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.expected = true;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Creates an error object.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    return error;\n  }\n\n  /**\n   * Creates an error object with its expected property set to true.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createExpectedError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    error.expected = true;\n    return error;\n  }\n\n  /**\n   * Throws an error if the first argument isn't trueish.\n   *\n   * Supports argument substitution into the message via %s placeholders.\n   *\n   * Throws an error object that has two extra properties:\n   * - associatedElement: This is the first element provided in the var args.\n   *   It can be used for improved display of error messages.\n   * - messageArray: The elements of the substituted message as non-stringified\n   *   elements in an array. When e.g. passed to console.error this yields\n   *   native displays of things like HTML elements.\n   *\n   * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n   *     not evaluate to true.\n   * @param {string=} opt_message The assertion message\n   * @param {...*} var_args Arguments substituted into %s in the message.\n   * @return {T} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 0\n   */\n  assert(shouldBeTrueish, opt_message, var_args) {\n    let firstElement;\n    if (!shouldBeTrueish) {\n      const message = opt_message || 'Assertion failed';\n      const splitMessage = message.split('%s');\n      const first = splitMessage.shift();\n      let formatted = first;\n      const messageArray = [];\n      pushIfNonEmpty(messageArray, first);\n      for (let i = 2; i < arguments.length; i++) {\n        const val = arguments[i];\n        if (val && val.tagName) {\n          firstElement = val;\n        }\n        const nextConstant = splitMessage.shift();\n        messageArray.push(val);\n        pushIfNonEmpty(messageArray, nextConstant.trim());\n        formatted += toString(val) + nextConstant;\n      }\n      const e = new Error(formatted);\n      e.fromAssert = true;\n      e.associatedElement = firstElement;\n      e.messageArray = messageArray;\n      this.prepareError_(e);\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n    return shouldBeTrueish;\n  }\n\n  /**\n   * Throws an error if the first argument isn't an Element\n   *\n   * Otherwise see `assert` for usage\n   *\n   * @param {*} shouldBeElement\n   * @param {string=} opt_message The assertion message\n   * @return {!Element} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertElement(shouldBeElement, opt_message) {\n    const shouldBeTrueish = shouldBeElement && shouldBeElement.nodeType == 1;\n    this.assert(shouldBeTrueish, (opt_message || 'Element expected') + ': %s',\n        shouldBeElement);\n    return /** @type {!Element} */ (shouldBeElement);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a string. The string can\n   * be empty.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeString\n   * @param {string=} opt_message The assertion message\n   * @return {string} The string value. Can be an empty string.\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertString(shouldBeString, opt_message) {\n    this.assert(typeof shouldBeString == 'string',\n        (opt_message || 'String expected') + ': %s', shouldBeString);\n    return /** @type {string} */ (shouldBeString);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a number. The allowed values\n   * include `0` and `NaN`.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeNumber\n   * @param {string=} opt_message The assertion message\n   * @return {number} The number value. The allowed values include `0`\n   *   and `NaN`.\n   */\n  assertNumber(shouldBeNumber, opt_message) {\n    this.assert(typeof shouldBeNumber == 'number',\n        (opt_message || 'Number expected') + ': %s', shouldBeNumber);\n    return /** @type {number} */ (shouldBeNumber);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a boolean.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeBoolean\n   * @param {string=} opt_message The assertion message\n   * @return {boolean} The boolean value.\n   */\n  assertBoolean(shouldBeBoolean, opt_message) {\n    this.assert(!!shouldBeBoolean === shouldBeBoolean,\n        (opt_message || 'Boolean expected') + ': %s', shouldBeBoolean);\n    return /** @type {boolean} */ (shouldBeBoolean);\n  }\n\n  /**\n   * Asserts and returns the enum value. If the enum doesn't contain such a\n   * value, the error is thrown.\n   *\n   * @param {!Object<T>} enumObj\n   * @param {string} s\n   * @param {string=} opt_enumName\n   * @return {T}\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertEnumValue(enumObj, s, opt_enumName) {\n    if (isEnumValue(enumObj, s)) {\n      return s;\n    }\n    this.assert(false,\n        'Unknown %s value: \"%s\"',\n        opt_enumName || 'enum', s);\n  }\n\n  /**\n   * @param {!Error} error\n   * @private\n   */\n  prepareError_(error) {\n    error = duplicateErrorIfNecessary(error);\n    if (this.suffix_) {\n      if (!error.message) {\n        error.message = this.suffix_;\n      } else if (error.message.indexOf(this.suffix_) == -1) {\n        error.message += this.suffix_;\n      }\n    } else if (isUserErrorMessage(error.message)) {\n      error.message = error.message.replace(USER_ERROR_SENTINEL, '');\n    }\n  }\n}\n\n/**\n * @param {string|!Element} val\n * @return {string}\n */\nfunction toString(val) {\n  // Do check equivalent to `val instanceof Element` without cross-window bug\n  if (val && val.nodeType == 1) {\n    return val.tagName.toLowerCase() + (val.id ? '#' + val.id : '');\n  }\n  return /** @type {string} */ (val);\n}\n\n\n/**\n * @param {!Array} array\n * @param {*} val\n */\nfunction pushIfNonEmpty(array, val) {\n  if (val != '') {\n    array.push(val);\n  }\n}\n\n/**\n * Some exceptions (DOMException, namely) have read-only message.\n * @param {!Error} error\n * @return {!Error};\n */\nexport function duplicateErrorIfNecessary(error) {\n  const {message} = error;\n  const test = String(Math.random());\n  error.message = test;\n\n  if (error.message === test) {\n    error.message = message;\n    return error;\n  }\n\n  const e = new Error(error.message);\n  // Copy all the extraneous things we attach.\n  for (const prop in error) {\n    e[prop] = error[prop];\n  }\n  // Ensure these are copied.\n  e.stack = error.stack;\n  return e;\n}\n\n/**\n * @param {...*} var_args\n * @return {!Error}\n * @visibleForTesting\n */\nexport function createErrorVargs(var_args) {\n  let error = null;\n  let message = '';\n  for (let i = 0; i < arguments.length; i++) {\n    const arg = arguments[i];\n    if (arg instanceof Error && !error) {\n      error = duplicateErrorIfNecessary(arg);\n    } else {\n      if (message) {\n        message += ' ';\n      }\n      message += arg;\n    }\n  }\n\n  if (!error) {\n    error = new Error(message);\n  } else if (message) {\n    error.message = message + ': ' + error.message;\n  }\n  return error;\n}\n\n\n/**\n * Rethrows the error without terminating the current context. This preserves\n * whether the original error designation is a user error or a dev error.\n * @param {...*} var_args\n */\nexport function rethrowAsync(var_args) {\n  const error = createErrorVargs.apply(null, arguments);\n  setTimeout(() => {\n    // reportError is installed globally per window in the entry point.\n    self.reportError(error);\n    throw error;\n  });\n}\n\n\n/**\n * Cache for logs. We do not use a Service since the service module depends\n * on Log and closure literally can't even.\n * @type {{user: ?Log, dev: ?Log, userForEmbed: ?Log}}\n */\nself.log = (self.log || {\n  user: null,\n  dev: null,\n  userForEmbed: null,\n});\n\nconst logs = self.log;\n\n/**\n * Eventually holds a constructor for Log objects. Lazily initialized, so we\n * can avoid ever referencing the real constructor except in JS binaries\n * that actually want to include the implementation.\n * @type {?Function}\n */\nlet logConstructor = null;\n\n/**\n * Initializes log contructor.\n */\nexport function initLogConstructor() {\n  logConstructor = Log;\n  // Initialize instances for use. If a binary (an extension for example) that\n  // does not call `initLogConstructor` invokes `dev()` or `user()` earlier than\n  // the binary that does call `initLogConstructor` (amp.js), the extension will\n  // throw an error as that extension will never be able to initialize the log\n  // instances and we also don't want it to call `initLogConstructor` either\n  // (since that will cause the Log implementation to be bundled into that\n  // binary). So we must initialize the instances eagerly so that they are ready\n  // for use (stored globally) after the main binary calls `initLogConstructor`.\n  dev();\n  user();\n}\n\n/**\n * Resets log contructor for testing.\n */\nexport function resetLogConstructorForTesting() {\n  logConstructor = null;\n}\n\n/**\n * Publisher level log.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Development mode is enabled via `#development=1` or logging is explicitly\n *     enabled via `#log=D` where D >= 1.\n *  3. AMP.setLogLevel(D) is called, where D >= 1.\n *\n * @param {!Element=} opt_element\n * @return {!Log}\n */\nexport function user(opt_element) {\n  if (!logs.user) {\n    logs.user = getUserLogger(USER_ERROR_SENTINEL);\n  }\n  if (!isFromEmbed(logs.user.win, opt_element)) {\n    return logs.user;\n  } else {\n    if (logs.userForEmbed) {\n      return logs.userForEmbed;\n    }\n    return logs.userForEmbed = getUserLogger(USER_ERROR_EMBED_SENTINEL);\n  }\n}\n\n/**\n * Getter for user logger\n * @param {string=} suffix\n * @return {!Log}\n */\nfunction getUserLogger(suffix) {\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (mode.development || logNum >= 1) {\n      return LogLevel.FINE;\n    }\n    return LogLevel.WARN;\n  }, suffix);\n}\n\n/**\n * AMP development log. Calls to `devLog().assert` and `dev.fine` are stripped\n * in the PROD binary. However, `devLog().assert` result is preserved in either\n * case.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Logging is explicitly enabled via `#log=D`, where D >= 2.\n *  3. AMP.setLogLevel(D) is called, where D >= 2.\n *\n * @return {!Log}\n */\nexport function dev() {\n  if (logs.dev) {\n    return logs.dev;\n  }\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return logs.dev = new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (logNum >= 3) {\n      return LogLevel.FINE;\n    }\n    if (logNum >= 2) {\n      return LogLevel.INFO;\n    }\n    return LogLevel.OFF;\n  });\n}\n\n/**\n * @param {!Window} win\n * @param {!Element=} opt_element\n * @return {boolean} isEmbed\n */\nexport function isFromEmbed(win, opt_element) {\n  if (!opt_element) {\n    return false;\n  }\n  return opt_element.ownerDocument.defaultView != win;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\n\n/**\n * Provides info about the current app. This return value may be cached and\n * passed around as it will always be DCE'd.\n * @param {?Window=} opt_win\n * @return {!./mode.ModeDef}\n */\nexport function getModeObject(opt_win) {\n  return {\n    localDev: getMode(opt_win).localDev,\n    development: getMode(opt_win).development,\n    filter: getMode(opt_win).filter,\n    minified: getMode(opt_win).minified,\n    lite: getMode(opt_win).lite,\n    test: getMode(opt_win).test,\n    log: getMode(opt_win).log,\n    version: getMode(opt_win).version,\n    rtvVersion: getMode(opt_win).rtvVersion,\n  };\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {parseQueryString_} from './url-parse-query-string';\n\n/**\n * @typedef {{\n *   localDev: boolean,\n *   development: boolean,\n *   filter: (string|undefined),\n *   minified: boolean,\n *   lite: boolean,\n *   test: boolean,\n *   log: (string|undefined),\n *   version: string,\n *   rtvVersion: string,\n * }}\n */\nexport let ModeDef;\n\n/** @type {string} */\nconst version = '$internalRuntimeVersion$';\n\n/**\n * `rtvVersion` is the prefixed version we serve off of the cdn.\n * The prefix denotes canary(00) or prod(01) or an experiment version ( > 01).\n * @type {string}\n */\nlet rtvVersion = '';\n\n/**\n * Provides info about the current app.\n * @param {?Window=} opt_win\n * @return {!ModeDef}\n */\nexport function getMode(opt_win) {\n  const win = opt_win || self;\n  if (win.AMP_MODE) {\n    return win.AMP_MODE;\n  }\n  return win.AMP_MODE = getMode_(win);\n}\n\n/**\n * Provides info about the current app.\n * @param {!Window} win\n * @return {!ModeDef}\n */\nfunction getMode_(win) {\n  // Magic constants that are replaced by closure compiler.\n  // IS_MINIFIED is always replaced with true when closure compiler is used\n  // while IS_DEV is only replaced when `gulp dist` is called without the\n  // --fortesting flag.\n  const IS_DEV = true;\n  const IS_MINIFIED = false;\n\n  const localDevEnabled = !!(self.AMP_CONFIG && self.AMP_CONFIG.localDev);\n  const runningTests = IS_DEV && !!(win.AMP_TEST || win.__karma__);\n  const isLocalDev = IS_DEV && (localDevEnabled || runningTests);\n  const hashQuery = parseQueryString_(\n      // location.originalHash is set by the viewer when it removes the fragment\n      // from the URL.\n      win.location.originalHash || win.location.hash);\n\n  const searchQuery = parseQueryString_(win.location.search);\n\n  if (!rtvVersion) {\n    rtvVersion = getRtvVersion(win, isLocalDev);\n  }\n\n  // The `minified`, `test` and `localDev` properties are replaced\n  // as boolean literals when we run `gulp dist` without the `--fortesting`\n  // flags. This improved DCE on the production file we deploy as the code\n  // paths for localhost/testing/development are eliminated.\n  return {\n    localDev: isLocalDev,\n    // Triggers validation or enable pub level logging. Validation can be\n    // bypassed via #validate=0.\n    // Note that AMP_DEV_MODE flag is used for testing purposes.\n    development: !!(hashQuery['development'] == '1' || win.AMP_DEV_MODE),\n    examiner: hashQuery['development'] == '2',\n    // Allows filtering validation errors by error category. For the\n    // available categories, see ErrorCategory in validator/validator.proto.\n    filter: hashQuery['filter'],\n    // amp-geo override\n    geoOverride: hashQuery['amp-geo'],\n    minified: IS_MINIFIED,\n    // Whether document is in an amp-lite viewer. It signal that the user\n    // would prefer to use less bandwidth.\n    lite: searchQuery['amp_lite'] != undefined,\n    test: runningTests,\n    log: hashQuery['log'],\n    version,\n    rtvVersion,\n  };\n}\n\n/**\n * Retrieve the `rtvVersion` which will have a numeric prefix\n * denoting canary/prod/experiment (unless `isLocalDev` is true).\n *\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n */\nfunction getRtvVersion(win, isLocalDev) {\n  // If it's local dev then we won't actually have a full version so\n  // just use the version.\n  if (isLocalDev) {\n    return version;\n  }\n\n  if (win.AMP_CONFIG && win.AMP_CONFIG.v) {\n    return win.AMP_CONFIG.v;\n  }\n\n  // Currently `$internalRuntimeVersion$` and thus `mode.version` contain only\n  // major version. The full version however must also carry the minor version.\n  // We will default to production default `01` minor version for now.\n  // TODO(erwinmombay): decide whether $internalRuntimeVersion$ should contain\n  // minor version.\n  return `01${version}`;\n}\n\n\n/**\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n * @visibleForTesting\n */\nexport function getRtvVersionForTesting(win, isLocalDev) {\n  return getRtvVersion(win, isLocalDev);\n}\n\n\n/** @visibleForTesting */\nexport function resetRtvVersionForTesting() {\n  rtvVersion = '';\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n\n/**\n * This class helps to manage observers. Observers can be added, removed or\n * fired through and instance of this class.\n * @template TYPE\n */\nexport class Observable {\n\n  /**\n   * Creates an instance of Observable.\n   */\n  constructor() {\n    /** @type {?Array<function(TYPE)>} */\n    this.handlers_ = null;\n  }\n\n  /**\n   * Adds the observer to this instance.\n   * @param {function(TYPE)} handler Observer's handler.\n   * @return {!UnlistenDef}\n   */\n  add(handler) {\n    if (!this.handlers_) {\n      this.handlers_ = [];\n    }\n    this.handlers_.push(handler);\n    return () => {\n      this.remove(handler);\n    };\n  }\n\n  /**\n   * Removes the observer from this instance.\n   * @param {function(TYPE)} handler Observer's instance.\n   */\n  remove(handler) {\n    if (!this.handlers_) {\n      return;\n    }\n    const index = this.handlers_.indexOf(handler);\n    if (index > -1) {\n      this.handlers_.splice(index, 1);\n    }\n  }\n\n  /**\n   * Removes all observers.\n   */\n  removeAll() {\n    if (!this.handlers_) {\n      return;\n    }\n    this.handlers_.length = 0;\n  }\n\n  /**\n   * Fires an event. All observers are called.\n   * @param {TYPE=} opt_event\n   */\n  fire(opt_event) {\n    if (!this.handlers_) {\n      return;\n    }\n    const handlers = this.handlers_;\n    for (let i = 0; i < handlers.length; i++) {\n      const handler = handlers[i];\n      handler(opt_event);\n    }\n  }\n\n  /**\n   * Returns number of handlers. Mostly needed for tests.\n   * @return {number}\n   */\n  getHandlerCount() {\n    if (!this.handlers_) {\n      return 0;\n    }\n    return this.handlers_.length;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {install as installArrayIncludes} from './polyfills/array-includes';\nimport {install as installCustomElements} from './polyfills/custom-elements';\nimport {\n  install as installDOMTokenListToggle,\n} from './polyfills/domtokenlist-toggle';\nimport {install as installDocContains} from './polyfills/document-contains';\nimport {install as installMathSign} from './polyfills/math-sign';\nimport {install as installObjectAssign} from './polyfills/object-assign';\nimport {install as installPromise} from './polyfills/promise';\nimport {installCustomElements as installRegisterElement} from\n  'document-register-element/build/document-register-element.patched';\nimport {isExperimentOn} from './experiments';\n\nif (isExperimentOn(self, 'custom-elements-v1') || getMode().test) {\n  installCustomElements(self, class {});\n} else {\n  installRegisterElement(self, 'auto');\n}\ninstallDOMTokenListToggle(self);\ninstallMathSign(self);\ninstallObjectAssign(self);\ninstallPromise(self);\ninstallDocContains(self);\ninstallArrayIncludes(self);\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Returns true if the element is in the array and false otherwise.\n *\n * @param {*} value\n * @param {number=} opt_fromIndex\n * @return {boolean}\n * @this {Array}\n */\nfunction includes(value, opt_fromIndex) {\n  const fromIndex = opt_fromIndex || 0;\n  const len = this.length;\n  let i = fromIndex >= 0 ? fromIndex : Math.max(len + fromIndex, 0);\n  for (; i < len; i++) {\n    const other = this[i];\n    // If value has been found OR (value is NaN AND other is NaN)\n    /*eslint \"no-self-compare\": 0*/\n    if (other === value || (value !== value && other !== other)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n* Sets the Array.contains polyfill if it does not exist.\n* @param {!Window} win\n*/\nexport function install(win) {\n  if (!win.Array.prototype.includes) {\n    win.Object.defineProperty(Array.prototype, 'includes', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: includes,\n    });\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @typedef {{\n *   promise: !Promise<undefined>,\n *   resolve: function(),\n * }}\n */\nlet DeferredDef;\n\n/**\n * @typedef {!Function}\n */\nlet CustomElementConstructorDef;\n\n/**\n * @typedef {{\n *  name: string,\n *  ctor: !CustomElementConstructorDef,\n * }}\n */\nlet CustomElementDef;\n\n/**\n * Validates the custom element's name.\n * This intentionally ignores \"valid\" higher Unicode Code Points.\n * https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name\n */\nconst VALID_NAME = /^[a-z][a-z0-9._]*-[a-z0-9._-]*$/;\nconst INVALID_NAMES = [\n  'annotation-xml',\n  'color-profile',\n  'font-face',\n  'font-face-src',\n  'font-face-uri',\n  'font-face-format',\n  'font-face-name',\n  'missing-glyph',\n];\n\n/**\n * Asserts that the custom element name conforms to the spec.\n *\n * @param {!Function} SyntaxError\n * @param {string} name\n */\nfunction assertValidName(SyntaxError, name) {\n  if (!VALID_NAME.test(name) || INVALID_NAMES.indexOf(name) >= 0) {\n    throw new SyntaxError(`invalid custom element name \"${name}\"`);\n  }\n}\n\n/**\n * Does win have a full Custom Elements registry?\n *\n * @param {!Window} win\n * @return {boolean}\n */\nfunction hasCustomElements(win) {\n  const {customElements} = win;\n\n  return !!(\n    customElements &&\n    customElements.define &&\n    customElements.get &&\n    customElements.whenDefined);\n}\n\n/**\n * Was HTMLElement already patched for this window?\n *\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isPatched(win) {\n  const tag = win.HTMLElement.toString();\n  return tag.indexOf('[native code]') === -1;\n}\n\n/**\n * The public Custom Elements API.\n */\nclass CustomElementRegistry {\n  /**\n   * @param {!Window} win\n   * @param {!Registry} registry\n   */\n  constructor(win, registry) {\n    /**\n     * @const @private\n     */\n    this.win_ = win;\n\n    /**\n     * @const @private\n     */\n    this.registry_ = registry;\n\n    /**\n     * @type {!Object<string, DeferredDef>}\n     * @private\n     * @const\n     */\n    this.pendingDefines_ = this.win_.Object.create(null);\n  }\n\n  /**\n   * Register the custom element.\n   *\n   * @param {string} name\n   * @param {!CustomElementConstructorDef} ctor\n   * @param {!Object=} options\n   */\n  define(name, ctor, options) {\n    this.registry_.define(name, ctor, options);\n\n    // If anyone is waiting for this custom element to be defined, resolve\n    // their promise.\n    const pending = this.pendingDefines_;\n    const deferred = pending[name];\n    if (deferred) {\n      deferred.resolve();\n      delete pending[name];\n    }\n  }\n\n  /**\n   * Get the constructor of the (already defined) custom element.\n   *\n   * @param {string} name\n   * @return {!CustomElementConstructorDef|undefined}\n   */\n  get(name) {\n    const def = this.registry_.getByName(name);\n    if (def) {\n      return def.ctor;\n    }\n  }\n\n  /**\n   * Returns a promise that waits until the custom element is defined.\n   * If the custom element is already defined, returns a resolved promise.\n   *\n   * @param {string} name\n   * @return {!Promise<undefined>}\n   */\n  whenDefined(name) {\n    const {Promise, SyntaxError} = this.win_;\n    assertValidName(SyntaxError, name);\n\n    if (this.registry_.getByName(name)) {\n      return Promise.resolve();\n    }\n\n    const pending = this.pendingDefines_;\n    const deferred = pending[name];\n    if (deferred) {\n      return deferred.promise;\n    }\n\n    let resolve;\n    const promise = new /*OK*/Promise(res => resolve = res);\n    pending[name] = {\n      promise,\n      resolve,\n    };\n\n    return promise;\n  }\n\n  /**\n   * Upgrade all custom elements inside root.\n   *\n   * @param {!Node} root\n   */\n  upgrade(root) {\n    this.registry_.upgrade(root);\n  }\n}\n\n/**\n * This internal APIs necessary to run the CustomElementRegistry.\n * Since Registry is never exposed externally, all methods are actually\n * available on the instance.\n */\nclass Registry {\n  /**\n   * @param {!Window} win\n   */\n  constructor(win) {\n    /**\n     * @private @const\n     */\n    this.win_ = win;\n\n    /**\n     * @private @const\n     */\n    this.doc_ = win.document;\n\n    /**\n     * @type {!Object<string, !CustomElementDef>}\n     * @private\n     * @const\n     */\n    this.definitions_ = win.Object.create(null);\n\n    /**\n     * A up-to-date DOM selector for all custom elements.\n     * @type {string}\n     */\n    this.query_ = '';\n\n    /**\n     * The currently upgrading element.\n     * @private {Element}\n     */\n    this.current_ = null;\n  }\n\n  /**\n   * The currently-being-upgraded custom element.\n   *\n   * When an already created (through the DOM parsing APIs, or innerHTML)\n   * custom element node is being upgraded, we can't just create a new node\n   * (it's illegal in the spec). But we still need to run the custom element's\n   * constructor code on the node. We avoid this conundrum by running the\n   * constructor while returning this current node in the HTMLElement\n   * class constructor (the base class of all custom elements).\n   *\n   * @return {Element}\n   */\n  current() {\n    const current = this.current_;\n    this.current_ = null;\n    return current;\n  }\n\n  /**\n   * Finds the custom element definition by name.\n   *\n   * @param {string} name\n   * @return {CustomElementDef|undefined}\n   */\n  getByName(name) {\n    const definition = this.definitions_[name];\n    if (definition) {\n      return definition;\n    }\n  }\n\n  /**\n   * Finds the custom element definition by constructor instance.\n   *\n   * @param {CustomElementConstructorDef} ctor\n   * @return {CustomElementDef|undefined}\n   */\n  getByConstructor(ctor) {\n    const definitions = this.definitions_;\n\n    for (const name in definitions) {\n      const def = definitions[name];\n      if (def.ctor === ctor) {\n        return def;\n      }\n    }\n  }\n\n  /**\n   * Registers the custom element definition, and upgrades all elements by that\n   * name in the root document.\n   *\n   * @param {string} name\n   * @param {!CustomElementConstructorDef} ctor\n   * @param {!Object|undefined} options\n   */\n  define(name, ctor, options) {\n    const {Error, SyntaxError} = this.win_;\n\n    if (options) {\n      throw new Error('Extending native custom elements is not supported');\n    }\n\n    assertValidName(SyntaxError, name);\n\n    if (this.getByName(name) ||\n        this.getByConstructor(ctor)) {\n      throw new Error(`duplicate definition \"${name}\"`);\n    }\n\n    // TODO(jridgewell): Record connectedCallback, disconnectedCallback,\n    // adoptedCallback, attributeChangedCallback, and observedAttributes.\n    // TODO(jridgewell): If attributeChangedCallback, gather observedAttributes\n    this.definitions_[name] = {\n      name,\n      ctor,\n    };\n\n    this.observe_(name);\n    this.upgrade(this.doc_, name);\n  }\n\n  /**\n   * Upgrades custom elements descendants of root (but not including root).\n   *\n   * When called with an opt_query, it both upgrades and connects the custom\n   * elements (this is used during the custom element define algorithm).\n   *\n   * @param {!Node} root\n   * @param {string=} opt_query\n   */\n  upgrade(root, opt_query) {\n    // Only CustomElementRegistry.p.define provides a query (the newly defined\n    // custom element). In this case, we are both upgrading _and_ connecting\n    // the custom elements.\n    const newlyDefined = !!opt_query;\n    const query = opt_query || this.query_;\n    const upgradeCandidates = this.queryAll_(root, query);\n\n    for (let i = 0; i < upgradeCandidates.length; i++) {\n      const candidate = upgradeCandidates[i];\n      if (newlyDefined) {\n        this.connectedCallback_(candidate);\n      } else {\n        this.upgradeSelf(candidate);\n      }\n    }\n  }\n\n  /**\n   * Upgrades the custom element node, if a custom element has been registered\n   * by this name.\n   *\n   * @param {!Node} node\n   */\n  upgradeSelf(node) {\n    const def = this.getByName(node.localName);\n    if (!def) {\n      return;\n    }\n\n    this.upgradeSelf_(/** @type {!Element} */(node), def);\n  }\n\n  /**\n   * @param {!Node} root\n   * @param {string} query\n   * @return {!Array|!NodeList}\n   */\n  queryAll_(root, query) {\n    if (!query || !root.querySelectorAll) {\n      // Nothing to do...\n      return [];\n    }\n\n    return root.querySelectorAll(query);\n  }\n\n  /**\n   * Upgrades the (already created via DOM parsing) custom element.\n   *\n   * @param {!Element} node\n   * @param {!CustomElementDef} def\n   */\n  upgradeSelf_(node, def) {\n    const {ctor} = def;\n    if (node instanceof ctor) {\n      return;\n    }\n\n    // Despite how it looks, this is not a useless construction.\n    // HTMLElementPolyfill (the base class of all custom elements) will return\n    // the current node, allowing the custom element's subclass constructor to\n    // run on the node. The node itself is already constructed, so the return\n    // value is just the node.\n    this.current_ = node;\n    const el = new ctor();\n\n    if (el !== node) {\n      throw new this.win_.Error(\n          'Constructor illegally returned a different instance.');\n    }\n  }\n\n  /**\n   * Fires connectedCallback on the custom element, if it has one.\n   * This also upgrades the custom element, since it may not have been\n   * accessible via the root document before (a detached DOM tree).\n   *\n   * @param {!Node} node\n   */\n  connectedCallback_(node) {\n    const def = this.getByName(node.localName);\n    if (!def) {\n      return;\n    }\n    this.upgradeSelf_(/** @type {!Element} */(node), def);\n    // TODO(jridgewell): It may be appropriate to adoptCallback, if the node\n    // used to be in another doc.\n    // TODO(jridgewell): I should be calling the definitions connectedCallback\n    // with node as the context.\n    if (node.connectedCallback) {\n      node.connectedCallback();\n    }\n  }\n\n  /**\n   * Fires disconnectedCallback on the custom element, if it has one.\n   *\n   * @param {!Node} node\n   */\n  disconnectedCallback_(node) {\n    // TODO(jridgewell): I should be calling the definitions connectedCallback\n    // with node as the context.\n    if (node.disconnectedCallback) {\n      node.disconnectedCallback();\n    }\n  }\n\n  /**\n   * Records name as a registered custom element to observe.\n   *\n   * Starts the Mutation Observer if this is the first registered custom\n   * element. This is deferred until the first custom element is defined to\n   * speed up initial rendering of the page.\n   *\n   * Mutation Observers are conveniently available in every browser we care\n   * about. When a node is connected to the root document, all custom\n   * elements (including that node iteself) will be upgraded and call\n   * connectedCallback. When a node is disconnectedCallback from the root\n   * document, all custom elements will call disconnectedCallback.\n   *\n   * @param {string} name\n   */\n  observe_(name) {\n    if (this.query_) {\n      this.query_ += `,${name}`;\n      return;\n    }\n\n    this.query_ = name;\n\n    // The first registered name starts the mutation observer.\n    const observer = new this.win_.MutationObserver(records => {\n      if (records) {\n        this.handleRecords_(records);\n      }\n    });\n    observer.observe(this.doc_, {\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  /**\n   * Handle all the Mutation Observer's Mutation Records.\n   * All added custom elements will be upgraded (if not already) and call\n   * connectedCallback. All removed custom elements will call\n   * disconnectedCallback.\n   *\n   * @param {!Array<!MutationRecord>} records\n   */\n  handleRecords_(records) {\n    for (let i = 0; i < records.length; i++) {\n      const record = records[i];\n      if (!record) {\n        continue;\n      }\n\n      const {addedNodes, removedNodes} = record;\n      for (let i = 0; i < addedNodes.length; i++) {\n        const node = addedNodes[i];\n        const connectedCandidates = this.queryAll_(node, this.query_);\n        this.connectedCallback_(node);\n        for (let i = 0; i < connectedCandidates.length; i++) {\n          this.connectedCallback_(connectedCandidates[i]);\n        }\n      }\n\n      for (let i = 0; i < removedNodes.length; i++) {\n        const node = removedNodes[i];\n        const disconnectedCandidates = this.queryAll_(node, this.query_);\n        this.disconnectedCallback_(node);\n        for (let i = 0; i < disconnectedCandidates.length; i++) {\n          this.disconnectedCallback_(disconnectedCandidates[i]);\n        }\n      }\n    }\n  }\n}\n\n/**\n * Does the polyfilling.\n * @param {!Window} win\n */\nfunction polyfill(win) {\n  const {HTMLElement, Element, Node, Document, Object, document} = win;\n  const {createElement, cloneNode, importNode} = document;\n\n  const registry = new Registry(win);\n  const customElements = new CustomElementRegistry(win, registry);\n\n  // Expose the custom element registry.\n  // Object.getOwnPropertyDescriptor(window, 'customElements')\n  // {get: ƒ, set: undefined, enumerable: true, configurable: true}\n  Object.defineProperty(win, 'customElements', {\n    enumerable: true,\n    configurable: true,\n    // writable: false,\n    value: customElements,\n  });\n\n  // Patch createElement to immediately upgrade the custom element.\n  // This has the added benefit that it avoids the \"already created but needs\n  // constructor code run\" chicken-and-egg problem.\n  Document.prototype.createElement = function createElementPolyfill(name) {\n    const def = registry.getByName(name);\n    if (def) {\n      return new def.ctor();\n    }\n    return createElement.apply(this, arguments);\n  };\n\n  // Patch importNode to immediately upgrade custom elements.\n  // TODO(jridgewell): Can fire adoptedCallback for cross doc imports.\n  Document.prototype.importNode = function importNodePolyfill() {\n    const imported = importNode.apply(this, arguments);\n    if (imported) {\n      registry.upgradeSelf(imported);\n      registry.upgrade(imported);\n    }\n    return imported;\n  };\n\n  // Patch cloneNode to immediately upgrade custom elements.\n  Node.prototype.cloneNode = function cloneNodePolyfill() {\n    const cloned = cloneNode.apply(this, arguments);\n    registry.upgradeSelf(cloned);\n    registry.upgrade(cloned);\n    return cloned;\n  };\n\n  // Patch the innerHTML setter to immediately upgrade custom elements.\n  // Note, this could technically fire connectedCallbacks if this node was\n  // connected, but we leave that to the Mutation Observer.\n  const innerHTMLDesc = Object.getOwnPropertyDescriptor(Element.prototype,\n      'innerHTML');\n  const innerHTMLSetter = innerHTMLDesc.set;\n  innerHTMLDesc.set = function(html) {\n    innerHTMLSetter.call(this, html);\n    registry.upgrade(this);\n  };\n  Object.defineProperty(Element.prototype, 'innerHTML', innerHTMLDesc);\n\n  /**\n   * You can't use the real HTMLElement constructor, because you can't subclass\n   * it without using native classes. So, mock its approximation using\n   * createElement.\n   */\n  function HTMLElementPolyfill() {\n    const {constructor} = this;\n\n    // If we're upgrading an already created custom element, we can't create\n    // another new node (by the spec, it must be the same node).\n    let el = registry.current();\n\n    // If there's not a already created custom element, we're being invoked via\n    // `new`ing the constructor.\n    //\n    // Technically, we could get here via createElement, but we patched that.\n    // If it the custom element was registered, the patch turned it into a\n    // `new` call.\n    // If it was not registered, the native createElement is used. And if\n    // native createElement is being used and we got to this code, we're really\n    // in an infinite loop (a native createElement call just below) so we've\n    // got bigger problems.\n    //\n    // So just take my word we got here via `new`.\n    if (!el) {\n      // The custom element definition is an invariant. If the custom element\n      // is registered, everything works. If it's not, it throws in the member\n      // property access (only defined custom elements can be directly\n      // constructed via `new`).\n      const def = registry.getByConstructor(constructor);\n      el = createElement.call(document, def.name);\n    }\n\n    // Finally, if the node was already constructed, we need to reset it's\n    // prototype to the custom element prototype. And if it wasn't already\n    // constructed, we created a new node via native createElement, and we need\n    // to reset it's prototype. Basically always reset the prototype.\n    Object.setPrototypeOf(el, constructor.prototype);\n    return el;\n  }\n  subClass(Object, HTMLElement, HTMLElementPolyfill);\n\n  // Expose the polyfilled HTMLElement constructor for everyone to extend from.\n  win.HTMLElement = HTMLElementPolyfill;\n}\n\n/**\n * Wraps HTMLElement in a Reflect.construct constructor, so that transpiled\n * classes can `_this = superClass.call(this)` during their construction.\n *\n * This is only used when Custom Elements v1 is already available _and_ we're\n * using transpiled classes (which use ES5 construction idioms).\n *\n * @param {!Window} win\n */\nfunction wrapHTMLElement(win) {\n  const {HTMLElement, Reflect, Object} = win;\n  /**\n   */\n  function HTMLElementWrapper() {\n    const ctor = /** @type {function(...?):?|undefined} */(\n      /** @type {!HTMLElement} */(this).constructor);\n\n    // Reflect.construct allows us to construct a new HTMLElement without using\n    // `new` (which will always fail because native HTMLElement is a restricted\n    // constructor).\n    return Reflect.construct(HTMLElement, [], ctor);\n  }\n  subClass(Object, HTMLElement, HTMLElementWrapper);\n\n  // Expose the wrapped HTMLElement constructor for everyone to extend from.\n  win.HTMLElement = HTMLElementWrapper;\n}\n\n/**\n * Setups up prototype inheritance\n *\n * @param {!Object} Object\n * @param {!Function} superClass\n * @param {!Function} subClass\n */\nfunction subClass(Object, superClass, subClass) {\n  // Object.getOwnPropertyDescriptor(superClass.prototype, 'constructor')\n  // {value: ƒ, writable: true, enumerable: false, configurable: true}\n  subClass.prototype = Object.create(superClass.prototype, {\n    constructor: {\n      // enumerable: false,\n      configurable: true,\n      writable: true,\n      value: subClass,\n    },\n  });\n}\n\n/**\n * Polyfills Custom Elements v1 API. This has 4 modes:\n *\n * 1. Custom elements v1 already supported, using native classes\n * 2. Custom elements v1 already supported, using transpiled classes\n * 3. Custom elements v1 not supported, using native classes\n * 4. Custom elements v1 not supported, using transpiled classes\n *\n * In mode 1, nothing is done. In mode 2, a minimal polyfill is used to support\n * extending the HTMLElement base class. In mode 3 and 4, a full polyfill is\n * done.\n *\n * @param {!Window} win\n * @param {!Function} ctor\n */\nexport function install(win, ctor) {\n  if (isPatched(win)) {\n    return;\n  }\n\n  let install = true;\n  let installWrapper = false;\n\n  if (hasCustomElements(win)) {\n    // If ctor is constructable without new, it's a function. That means it was\n    // compiled down, and we need to do the minimal polyfill because all you\n    // cannot extend HTMLElement without native classes.\n    try {\n      const {Object, Reflect} = win;\n\n      // \"Construct\" ctor using ES5 idioms\n      const instance = Object.create(ctor.prototype);\n      ctor.call(instance);\n\n      // If that succeeded, we're in a transpiled environment\n      // Let's find out if we can wrap HTMLElement and avoid a full patch.\n      installWrapper = !!(Reflect && Reflect.construct);\n    } catch (e) {\n\n      // The ctor threw when we constructed is via ES5, so it's a real class.\n      // We're ok to not install the polyfill.\n      install = false;\n    }\n  }\n\n  if (installWrapper) {\n    wrapHTMLElement(win);\n  } else if (install) {\n    polyfill(win);\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Polyfill for `document.contains()` method. Notice that according to spec\n * `document.contains` is inclusionary.\n * See https://developer.mozilla.org/en-US/docs/Web/API/Node/contains\n * @param {?Node} node\n * @return {boolean}\n * @this {Node}\n */\nfunction documentContainsPolyfill(node) {\n  // Per spec, \"contains\" method is inclusionary\n  // i.e. `node.contains(node) == true`. However, we still need to test\n  // equality to the document itself.\n  return node == this || this.documentElement.contains(node);\n}\n\n\n/**\n * Polyfills `HTMLDocument.contains` API.\n * @param {!Window} win\n */\nexport function install(win) {\n  // HTMLDocument is undefined in Internet Explorer 10, but it has Document,\n  // so we use that as a fallback.\n  const documentClass = win.HTMLDocument || win.Document;\n  if (!documentClass.prototype.contains) {\n    win.Object.defineProperty(documentClass.prototype, 'contains', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: documentContainsPolyfill,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Polyfill for `DOMTokenList.prototype.toggle(token, opt_force)` method. This\n * is specially important because IE does not support `opt_force` attribute. See\n * https://goo.gl/hgKNYY for details.\n * @param {string} token\n * @param {boolean=} opt_force\n * @this {DOMTokenList}\n * @return {boolean}\n */\nfunction domTokenListTogglePolyfill(token, opt_force) {\n  const remove = opt_force === undefined ? this.contains(token) : !opt_force;\n  if (remove) {\n    this.remove(token);\n    return false;\n  } else {\n    this.add(token);\n    return true;\n  }\n}\n\n\n/**\n * Polyfills `DOMTokenList.prototype.toggle` API in IE.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (isIe(win) && win.DOMTokenList) {\n    win.Object.defineProperty(win.DOMTokenList.prototype, 'toggle', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: domTokenListTogglePolyfill,\n    });\n  }\n}\n\n\n/**\n * Whether the current browser is a IE browser.\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isIe(win) {\n  return /Trident|MSIE|IEMobile/i.test(win.navigator.userAgent);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Parses the number x and returns its sign. For positive x returns 1, for\n * negative, -1. For 0 and -0, returns 0 and -0 respectively. For any number\n * that parses to NaN, returns NaN.\n *\n * @param {number} x\n * @return {number}\n */\nexport function sign(x) {\n  x = Number(x);\n\n  // If x is 0, -0, or NaN, return it.\n  if (!x) {\n    return x;\n  }\n\n  return x > 0 ? 1 : -1;\n}\n\n\n/**\n * Sets the Math.sign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Math.sign) {\n    win.Object.defineProperty(win.Math, 'sign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: sign,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst {hasOwnProperty} = Object.prototype;\n\n/**\n * Copies values of all enumerable own properties from one or more source\n * objects (provided as extended arguments to the function) to a target object.\n *\n * @param {!Object} target\n * @param {...Object} var_args\n * @return {!Object}\n */\nexport function assign(target, var_args) {\n  if (target == null) {\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  const output = Object(target);\n  for (let i = 1; i < arguments.length; i++) {\n    const source = arguments[i];\n    if (source != null) {\n      for (const key in source) {\n        if (hasOwnProperty.call(source, key)) {\n          output[key] = source[key];\n        }\n      }\n    }\n  }\n  return output;\n}\n\n\n/**\n * Sets the Object.assign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Object.assign) {\n    win.Object.defineProperty(win.Object, 'assign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: assign,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nimport * as Promise from 'promise-pjs/promise';\n\n/**\n * Sets the Promise polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Promise) {\n    win.Promise = /** @type {?} */ (Promise);\n    // In babel the * export is an Object with a default property.\n    // In closure compiler it is the Promise function itself.\n    if (Promise.default) {\n      win.Promise = Promise.default;\n    }\n    // We copy the individual static methods, because closure\n    // compiler flattens the polyfill namespace.\n    win.Promise.resolve = Promise.resolve;\n    win.Promise.reject = Promise.reject;\n    win.Promise.all = Promise.all;\n    win.Promise.race = Promise.race;\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from './services';\nimport {dev} from './log';\nimport {getServicePromise} from './service';\n\n/**\n * A map of services that delay rendering. The key is the name of the service\n * and the value is a DOM query which is used to check if the service is needed\n * in the current document.\n * Do not add a service unless absolutely necessary.\n *\n * \\   \\  /  \\  /   / /   \\     |   _  \\     |  \\ |  | |  | |  \\ |  |  / _____|\n *  \\   \\/    \\/   / /  ^  \\    |  |_)  |    |   \\|  | |  | |   \\|  | |  |  __\n *   \\            / /  /_\\  \\   |      /     |  . `  | |  | |  . `  | |  | |_ |\n *    \\    /\\    / /  _____  \\  |  |\\  \\----.|  |\\   | |  | |  |\\   | |  |__| |\n *     \\__/  \\__/ /__/     \\__\\ | _| `._____||__| \\__| |__| |__| \\__|  \\______|\n *\n * The equivalent of this list is used for server-side rendering (SSR) and any\n * changes made to it must be made in coordination with caches that implement\n * SSR. For more information on SSR see bit.ly/amp-ssr.\n *\n * @const {!Object<string, string>}\n */\nconst SERVICES = {\n  'amp-dynamic-css-classes': '[custom-element=amp-dynamic-css-classes]',\n  'variant': 'amp-experiment',\n  'amp-story': 'amp-story[standalone]',\n};\n\n/**\n * Maximum milliseconds to wait for all extensions to load before erroring.\n * @const\n */\nconst LOAD_TIMEOUT = 3000;\n\n/**\n * Detects any render delaying services that are required on the page, and\n * returns a promise with a timeout.\n * @param {!Window} win\n * @return {!Promise<!Array<*>>} resolves to an Array that has the same length\n *     as the detected render delaying services\n */\nexport function waitForServices(win) {\n  const promises = includedServices(win).map(service => {\n    return Services.timerFor(win).timeoutPromise(\n        LOAD_TIMEOUT,\n        getServicePromise(win, service),\n        `Render timeout waiting for service ${service} to be ready.`\n    );\n  });\n  return Promise.all(promises);\n}\n\n/**\n * Returns true if the page has a render delaying service.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function hasRenderDelayingServices(win) {\n  return includedServices(win).length > 0;\n}\n\n/**\n * Detects which, if any, render-delaying extensions are included on the page.\n * @param {!Window} win\n * @return {!Array<string>}\n */\nexport function includedServices(win) {\n  /** @const {!Document} */\n  const doc = win.document;\n  dev().assert(doc.body);\n\n  return Object.keys(SERVICES).filter(service => {\n    return doc.querySelector(SERVICES[service]);\n  });\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Registration and getter functions for AMP services.\n *\n * Invariant: Service getters never return null for registered services.\n */\n\n// src/polyfills.js must be the first import.\nimport './polyfills'; // eslint-disable-line sort-imports-es6-autofix/sort-imports-es6\n\nimport {Deferred} from './utils/promise';\nimport {dev} from './log';\nimport {toWin} from './types';\n\n\n/**\n * Holds info about a service.\n * - obj: Actual service implementation when available.\n * - promise: Promise for the obj.\n * - resolve: Function to resolve the promise with the object.\n * - context: Argument for ctor, either a window or an ampdoc.\n * - ctor: Function that constructs and returns the service.\n * @typedef {{\n *   obj: (?Object),\n *   promise: (?Promise),\n *   resolve: (?function(!Object)),\n *   context: (?Window|?./service/ampdoc-impl.AmpDoc),\n *   ctor: (?function(new:Object, !Window)|\n *          ?function(new:Object, !./service/ampdoc-impl.AmpDoc)),\n * }}\n */\nlet ServiceHolderDef;\n\n\n/**\n * This interface provides a `dispose` method that will be called by\n * runtime when a service needs to be disposed of.\n * @interface\n */\nexport class Disposable {\n\n  /**\n   * Instructs the service to release any resources it might be holding. Can\n   * be called only once in the lifecycle of a service.\n   */\n  dispose() {}\n}\n\n\n/**\n * This interface provides a `adoptEmbedWindow` method that will be called by\n * runtime for a new embed window.\n * @interface\n */\nexport class EmbeddableService {\n\n  /**\n   * Instructs the service to adopt the embed window and add any necessary\n   * listeners and resources.\n   * @param {!Window} unusedEmbedWin\n   */\n  adoptEmbedWindow(unusedEmbedWin) {}\n}\n\n\n/**\n * Returns a service with the given id. Assumes that it has been registered\n * already.\n * @param {!Window} win\n * @param {string} id\n * @param {boolean=} opt_fallbackToTopWin\n * @return {Object} The service.\n */\nexport function getExistingServiceInEmbedScope(win, id, opt_fallbackToTopWin) {\n  // First, try to resolve via local (embed) window.\n  const local = getLocalExistingServiceForEmbedWinOrNull(win, id);\n  if (local) {\n    return local;\n  }\n  if (opt_fallbackToTopWin) {\n    return getService(win, id);\n  }\n  return null;\n}\n\n/**\n * Returns a service with the given id. Assumes that it has been constructed\n * already.\n *\n * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n * services since sometimes we only have the FIE Document for context.\n *\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id\n * @param {boolean=} opt_fallbackToTopWin\n * @return {Object} The service.\n */\nexport function getExistingServiceForDocInEmbedScope(\n  nodeOrDoc, id, opt_fallbackToTopWin) {\n  // First, try to resolve via local (embed) window.\n  if (nodeOrDoc.nodeType) {\n    // If a node is passed, try to resolve via this node.\n    const win = toWin(/** @type {!Document} */ (\n      nodeOrDoc.ownerDocument || nodeOrDoc).defaultView);\n    const local = getLocalExistingServiceForEmbedWinOrNull(win, id);\n    if (local) {\n      return local;\n    }\n  }\n  // If an ampdoc is passed or fallback is allowed, continue resolving.\n  if (!nodeOrDoc.nodeType || opt_fallbackToTopWin) {\n    return getServiceForDocDeprecated(nodeOrDoc, id);\n  }\n  return null;\n}\n\n/**\n * Installs a service override on amp-doc level.\n * @param {!Window} embedWin\n * @param {string} id\n * @param {!Object} service The service.\n */\nexport function installServiceInEmbedScope(embedWin, id, service) {\n  const topWin = getTopWindow(embedWin);\n  dev().assert(embedWin != topWin,\n      'Service override can only be installed in embed window: %s', id);\n  dev().assert(!getLocalExistingServiceForEmbedWinOrNull(embedWin, id),\n      'Service override has already been installed: %s', id);\n  registerServiceInternal(embedWin, embedWin, id, () => service);\n  getServiceInternal(embedWin, id); // Force service to build.\n}\n\n/**\n * @param {!Window} embedWin\n * @param {string} id\n * @return {?Object}\n */\nfunction getLocalExistingServiceForEmbedWinOrNull(embedWin, id) {\n  // Note that this method currently only resolves against the given window.\n  // It does not try to go all the way up the parent window chain. We can change\n  // this in the future, but for now this gives us a better performance.\n  const topWin = getTopWindow(embedWin);\n  if (embedWin != topWin && isServiceRegistered(embedWin, id)) {\n    return getServiceInternal(embedWin, id);\n  } else {\n    return null;\n  }\n}\n\n/**\n * Registers a service given a class to be used as implementation.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {function(new:Object, !Window)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilder(win,\n  id,\n  constructor,\n  opt_instantiate) {\n  win = getTopWindow(win);\n  registerServiceInternal(win, win, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(win, id);\n  }\n}\n\n\n/**\n * Returns a service and registers it given a class to be used as\n * implementation.\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id of the service.\n * @param {function(new:Object, !./service/ampdoc-impl.AmpDoc)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilderForDoc(nodeOrDoc,\n  id,\n  constructor,\n  opt_instantiate) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  registerServiceInternal(holder, ampdoc, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(holder, id);\n  }\n}\n\n\n/**\n * Returns a service for the given id and window (a per-window singleton). Users\n * should typically wrap this as a special purpose function (e.g.\n * `Services.vsyncFor(win)`) for type safety and because the factory should not\n * be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @template T\n * @return {T}\n */\nexport function getService(win, id) {\n  win = getTopWindow(win);\n  return getServiceInternal(win, id);\n}\n\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. `Services.vsyncFor(win)`) for type safety and because the\n * factory should not be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nexport function getServicePromise(win, id) {\n  return getServicePromiseInternal(win, id);\n}\n\n\n/**\n * Returns a service or null with the given id.\n * @param {!Window} win\n * @param {string} id\n * @return {?Object} The service.\n */\nexport function getExistingServiceOrNull(win, id) {\n  win = getTopWindow(win);\n  if (isServiceRegistered(win, id)) {\n    return getServiceInternal(win, id);\n  } else {\n    return null;\n  }\n}\n\n\n/**\n * Like getServicePromise but returns null if the service was never registered.\n * @param {!Window} win\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNull(win, id) {\n  return getServicePromiseOrNullInternal(win, id);\n}\n\n\n/**\n * Returns a service for the given id and ampdoc (a per-ampdoc singleton).\n * Expects service `id` to be registered.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {T}\n * @template T\n */\nexport function getServiceForDoc(elementOrAmpDoc, id) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  return getServiceInternal(holder, id);\n}\n\n\n/**\n * tl;dr -- Use getServiceForDoc() instead of this.\n *\n * Privileged variant of getServiceForDoc() that accepts non-element params,\n * e.g. window.document. This is currently necessary for doc-level services\n * used in startup, e.g. Chunks. Eventually we want to remove this function\n * and have callers find the appropriate AmpDoc and use getServiceForDoc().\n *\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id\n * @return {T}\n * @template T\n */\nexport function getServiceForDocDeprecated(nodeOrDoc, id) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  return getServiceInternal(holder, id);\n}\n\n\n/**\n * Returns a promise for a service for the given id and ampdoc. Also expects\n * a service that has the actual implementation. The promise resolves when\n * the implementation loaded.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {!Promise<!Object>}\n */\nexport function getServicePromiseForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseInternal(\n      getAmpdocServiceHolder(elementOrAmpDoc), id);\n}\n\n\n/**\n * Like getServicePromiseForDoc but returns null if the service was never\n * registered for this ampdoc.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNullForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseOrNullInternal(\n      getAmpdocServiceHolder(elementOrAmpDoc), id);\n}\n\n/**\n * Set the parent and top windows on a child window (friendly iframe).\n * @param {!Window} win\n * @param {!Window} parentWin\n */\nexport function setParentWindow(win, parentWin) {\n  win.__AMP_PARENT = parentWin;\n  win.__AMP_TOP = getTopWindow(parentWin);\n}\n\n\n/**\n * Returns the parent window for a child window (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getParentWindow(win) {\n  return win.__AMP_PARENT || win;\n}\n\n\n/**\n * Returns the top window where AMP Runtime is installed for a child window\n * (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getTopWindow(win) {\n  return win.__AMP_TOP || win;\n}\n\n\n/**\n * Returns the parent \"friendly\" iframe if the node belongs to a child window.\n * @param {!Node} node\n * @param {!Window} topWin\n * @return {?HTMLIFrameElement}\n */\nexport function getParentWindowFrameElement(node, topWin) {\n  const childWin = (node.ownerDocument || node).defaultView;\n  if (childWin && childWin != topWin && getTopWindow(childWin) == topWin) {\n    try {\n      return /** @type {?HTMLIFrameElement} */ (childWin.frameElement);\n    } catch (e) {\n      // Ignore the error.\n    }\n  }\n  return null;\n}\n\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc}\n */\nexport function getAmpdoc(nodeOrDoc) {\n  if (nodeOrDoc.nodeType) {\n    const win = toWin(/** @type {!Document} */ (\n      nodeOrDoc.ownerDocument || nodeOrDoc).defaultView);\n    return getAmpdocService(win).getAmpDoc(/** @type {!Node} */ (nodeOrDoc));\n  }\n  return /** @type {!./service/ampdoc-impl.AmpDoc} */ (nodeOrDoc);\n}\n\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc|!Window}\n */\nfunction getAmpdocServiceHolder(nodeOrDoc) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  return ampdoc.isSingleDoc() ? ampdoc.win : ampdoc;\n}\n\n\n/**\n * This is essentially a duplicate of `ampdoc.js`, but necessary to avoid\n * circular dependencies.\n * @param {!Window} win\n * @return {!./service/ampdoc-impl.AmpDocService}\n */\nfunction getAmpdocService(win) {\n  return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n    getService(win, 'ampdoc'));\n}\n\n\n/**\n * Get service `id` from `holder`. Assumes the service\n * has already been registered.\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {Object}\n * @template T\n */\nfunction getServiceInternal(holder, id) {\n  dev().assert(isServiceRegistered(holder, id),\n      `Expected service ${id} to be registered`);\n  const services = getServices(holder);\n  const s = services[id];\n  if (!s.obj) {\n    dev().assert(s.ctor, `Service ${id} registered without ctor nor impl.`);\n    dev().assert(s.context, `Service ${id} registered without context.`);\n    s.obj = new s.ctor(s.context);\n    dev().assert(s.obj, `Service ${id} constructed to null.`);\n    s.ctor = null;\n    s.context = null;\n    // The service may have been requested already, in which case we have a\n    // pending promise we need to fulfill.\n    if (s.resolve) {\n      s.resolve(s.obj);\n    }\n  }\n  return s.obj;\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {!Window|!./service/ampdoc-impl.AmpDoc} context Win or AmpDoc.\n * @param {string} id of the service.\n * @param {?function(new:Object, !Window)|?function(new:Object, !./service/ampdoc-impl.AmpDoc)} ctor Constructor function to new the service. Called with context.\n */\nfunction registerServiceInternal(holder, context, id, ctor) {\n  const services = getServices(holder);\n  let s = services[id];\n\n  if (!s) {\n    s = services[id] = {\n      obj: null,\n      promise: null,\n      resolve: null,\n      context: null,\n      ctor: null,\n    };\n  }\n\n  if (s.ctor || s.obj) {\n    // Service already registered.\n    return;\n  }\n\n  s.ctor = ctor;\n  s.context = context;\n\n  // The service may have been requested already, in which case there is a\n  // pending promise that needs to fulfilled.\n  if (s.resolve) {\n    // getServiceInternal will resolve the promise.\n    getServiceInternal(holder, id);\n  }\n}\n\n/**\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nfunction getServicePromiseInternal(holder, id) {\n  const cached = getServicePromiseOrNullInternal(holder, id);\n  if (cached) {\n    return cached;\n  }\n  // Service is not registered.\n\n  // TODO(@cramforce): Add a check that if the element is eventually registered\n  // that the service is actually provided and this promise resolves.\n  const deferred = new Deferred();\n  const {promise, resolve} = deferred;\n\n  const services = getServices(holder);\n  services[id] = {\n    obj: null,\n    promise,\n    resolve,\n    context: null,\n    ctor: null,\n  };\n  return promise;\n}\n\n\n/**\n * Returns a promise for service `id` if the service has been registered\n * on `holder`.\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {?Promise<!Object>}\n */\nfunction getServicePromiseOrNullInternal(holder, id) {\n  const services = getServices(holder);\n  const s = services[id];\n  if (s) {\n    if (s.promise) {\n      return s.promise;\n    } else {\n      // Instantiate service if not already instantiated.\n      getServiceInternal(holder, id);\n      return s.promise = Promise.resolve(/** @type {!Object} */ (s.obj));\n    }\n  }\n  return null;\n}\n\n\n/**\n * Returns the object that holds the services registered in a holder.\n * @param {!Object} holder\n * @return {!Object<string,!ServiceHolderDef>}\n */\nfunction getServices(holder) {\n  let {services} = holder;\n  if (!services) {\n    services = holder.services = {};\n  }\n  return services;\n}\n\n\n/**\n * Whether the specified service implements `Disposable` interface.\n * @param {!Object} service\n * @return {boolean}\n */\nexport function isDisposable(service) {\n  return typeof service.dispose == 'function';\n}\n\n\n/**\n * Asserts that the specified service implements `Disposable` interface and\n * typecasts the instance to `Disposable`.\n * @param {!Object} service\n * @return {!Disposable}\n */\nexport function assertDisposable(service) {\n  dev().assert(isDisposable(service), 'required to implement Disposable');\n  return /** @type {!Disposable} */ (service);\n}\n\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * ampdoc scope.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n */\nexport function disposeServicesForDoc(ampdoc) {\n  disposeServicesInternal(ampdoc);\n}\n\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * embed scope.\n * @param {!Window} embedWin\n */\nexport function disposeServicesForEmbed(embedWin) {\n  disposeServicesInternal(embedWin);\n}\n\n\n/**\n * @param {!Object} holder Object holding the service instances.\n */\nfunction disposeServicesInternal(holder) {\n  // TODO(dvoytenko): Consider marking holder as destroyed for later-arriving\n  // service to be canceled automatically.\n  const services = getServices(holder);\n  for (const id in services) {\n    if (!Object.prototype.hasOwnProperty.call(services, id)) {\n      continue;\n    }\n    const serviceHolder = services[id];\n    if (serviceHolder.obj) {\n      disposeServiceInternal(id, serviceHolder.obj);\n    } else if (serviceHolder.promise) {\n      serviceHolder.promise.then(\n          instance => disposeServiceInternal(id, instance));\n    }\n  }\n}\n\n\n/**\n * @param {string} id\n * @param {!Object} service\n */\nfunction disposeServiceInternal(id, service) {\n  if (!isDisposable(service)) {\n    return;\n  }\n  try {\n    assertDisposable(service).dispose();\n  } catch (e) {\n    // Ensure that a failure to dispose a service does not disrupt other\n    // services.\n    dev().error('SERVICE', 'failed to dispose service', id, e);\n  }\n}\n\n\n/**\n * Whether the specified service implements `EmbeddableService` interface.\n * @param {!Object} service\n * @return {boolean}\n */\nexport function isEmbeddable(service) {\n  return typeof service.adoptEmbedWindow == 'function';\n}\n\n\n/**\n * Adopts an embeddable (implements `EmbeddableService` interface) service\n * in embed scope.\n * @param {!Window} embedWin\n * @param {string} serviceId\n */\nexport function adoptServiceForEmbed(embedWin, serviceId) {\n  const adopted = adoptServiceForEmbedIfEmbeddable(embedWin, serviceId);\n  dev().assert(adopted, `Service ${serviceId} not found on parent ` +\n      'or doesn\\'t implement EmbeddableService.');\n}\n\n\n/**\n * Adopts an embeddable (implements `EmbeddableService` interface) service\n * in embed scope.\n * @param {!Window} embedWin\n * @param {string} serviceId\n * @return {boolean}\n */\nexport function adoptServiceForEmbedIfEmbeddable(embedWin, serviceId) {\n  const frameElement = /** @type {!Node} */ (dev().assert(\n      embedWin.frameElement,\n      'frameElement not found for embed'));\n  const ampdoc = getAmpdoc(frameElement);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  if (!isServiceRegistered(holder, serviceId)) {\n    return false;\n  }\n  const service = getServiceForDocDeprecated(frameElement, serviceId);\n  if (!isEmbeddable(service)) {\n    return false;\n  }\n  service.adoptEmbedWindow(embedWin);\n  return true;\n}\n\n\n/**\n * Resets a single service, so it gets recreated on next getService invocation.\n * @param {!Object} holder\n * @param {string} id of the service.\n */\nexport function resetServiceForTesting(holder, id) {\n  if (holder.services) {\n    holder.services[id] = null;\n  }\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {boolean}\n */\nfunction isServiceRegistered(holder, id) {\n  const service = holder.services && holder.services[id];\n  // All registered services must have an implementation or a constructor.\n  return !!(service && (service.ctor || service.obj));\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getAmpdoc,\n  getExistingServiceForDocInEmbedScope,\n  getExistingServiceOrNull,\n  getService,\n  getServiceForDoc,\n  getServiceForDocDeprecated,\n  getServicePromiseForDoc,\n} from './service';\nimport {\n  getElementServiceForDoc,\n  getElementServiceIfAvailable,\n  getElementServiceIfAvailableForDoc,\n  getElementServiceIfAvailableForDocInEmbedScope,\n} from './element-service';\n\n/** @typedef {!../extensions/amp-subscriptions/0.1/amp-subscriptions.SubscriptionService} */\nexport let SubscriptionService;\n\nexport class Services {\n  /**\n   * Hint: Add extensions folder path to compile.js with\n   * warnings cannot find modules.\n   */\n\n  /**\n   * Returns a promise for the Access service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'access', 'amp-access')));\n  }\n\n  /**\n   * Returns a promise for the Access service or a promise for null if the\n   * service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc, 'access',\n          'amp-access')));\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!SubscriptionService>}\n   */\n  static subscriptionsServiceForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!SubscriptionService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'subscriptions',\n          'amp-subscriptions')));\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?SubscriptionService>}\n   */\n  static subscriptionsServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?SubscriptionService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc, 'subscriptions',\n          'amp-subscriptions')));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/action-impl.ActionService}\n   */\n  static actionServiceForDoc(nodeOrDoc) {\n    return /** @type {!./service/action-impl.ActionService} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'action', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!Activity>}\n   */\n  static activityForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!Activity>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'activity', 'amp-analytics'));\n  }\n\n  /**\n   * Returns the global instance of the `AmpDocService` service that can be\n   * used to resolve an ampdoc for any node: either in the single-doc or\n   * shadow-doc environment.\n   * @param {!Window} window\n   * @return {!./service/ampdoc-impl.AmpDocService}\n   */\n  static ampdocServiceFor(window) {\n    return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n      getService(window, 'ampdoc'));\n  }\n\n  /**\n   * Returns the AmpDoc for the specified context node.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/ampdoc-impl.AmpDoc}\n   */\n  static ampdoc(elementOrAmpDoc) {\n    return getAmpdoc(elementOrAmpDoc);\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @param {boolean=} loadAnalytics\n   * @return {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDoc(elementOrAmpDoc, loadAnalytics = false) {\n    if (loadAnalytics) {\n      // Get Extensions service and force load analytics extension.\n      const ampdoc = getAmpdoc(elementOrAmpDoc);\n      Services.extensionsFor(ampdoc.win)./*OK*/installExtensionForDoc(\n          ampdoc, 'amp-analytics');\n    }\n    return /** @type {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'amp-analytics-instrumentation',\n          'amp-analytics'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc,\n          'amp-analytics-instrumentation', 'amp-analytics'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/batched-xhr-impl.BatchedXhr}\n   */\n  static batchedXhrFor(window) {\n    return /** @type {!./service/batched-xhr-impl.BatchedXhr} */ (\n      getService(window, 'batched-xhr'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>}\n   */\n  static bindForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>} */ (\n      getElementServiceIfAvailableForDocInEmbedScope(\n          elementOrAmpDoc, 'bind', 'amp-bind'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/cid-impl.Cid>}\n   */\n  static cidForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/cid-impl.Cid>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'cid'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/navigation.Navigation}\n   */\n  static navigationForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/navigation.Navigation} */ (\n      getServiceForDoc(elementOrAmpDoc, 'navigation'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/crypto-impl.Crypto}\n   */\n  static cryptoFor(window) {\n    return (/** @type {!./service/crypto-impl.Crypto} */ (\n      getService(window, 'crypto')));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/document-info-impl.DocumentInfoDef} Info about the doc\n   */\n  static documentInfoForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/document-info-impl.DocInfo} */ (\n      getServiceForDoc(elementOrAmpDoc, 'documentInfo')).get();\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/document-state.DocumentState}\n   */\n  static documentStateFor(window) {\n    return getService(window, 'documentState');\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/extensions-impl.Extensions}\n   */\n  static extensionsFor(window) {\n    return /** @type {!./service/extensions-impl.Extensions} */ (\n      getService(window, 'extensions'));\n  }\n\n  /**\n   * Returns service implemented in service/history-impl.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/history-impl.History}\n   */\n  static historyForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/history-impl.History} */ (\n      getServiceForDoc(elementOrAmpDoc, 'history'));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!./input.Input}\n   */\n  static inputFor(win) {\n    return getService(win, 'input');\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/layers-impl.LayoutLayers}\n   */\n  static layersForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/layers-impl.LayoutLayers} */ (\n      getServiceForDoc(elementOrAmpDoc, 'layers'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceFor(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getService(window, 'performance'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceForOrNull(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getExistingServiceOrNull(window, 'performance'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/platform-impl.Platform}\n   */\n  static platformFor(window) {\n    return /** @type {!./service/platform-impl.Platform} */ (\n      getService(window, 'platform'));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Resources is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/resources-impl.Resources}\n   */\n  static resourcesForDoc(nodeOrDoc) {\n    return /** @type {!./service/resources-impl.Resources} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'resources'));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?{incomingFragment: string, outgoingFragment: string}>}\n   */\n  static shareTrackingForOrNull(win) {\n    return (/** @type {!Promise<?{incomingFragment: string, outgoingFragment: string}>} */ (\n      getElementServiceIfAvailable(win, 'share-tracking',\n          'amp-share-tracking', true)));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/variable-service.StoryVariableDef>}\n   */\n  static storyVariableServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/variable-service.StoryVariableDef>} */\n      (getElementServiceIfAvailable(win, 'story-variable', 'amp-story',\n          true)));\n  }\n\n  /**\n   * Version of the story store service depends on which version of amp-story\n   * the publisher is loading. They all have the same implementation.\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService|?../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService>}\n   */\n  static storyStoreServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService|?../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService>} */\n      (getElementServiceIfAvailable(win, 'story-store', 'amp-story')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService}\n   */\n  static storyStoreService(win) {\n    return (/** @type {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService} */\n      (getExistingServiceOrNull(win, 'story-store')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService}\n   */\n  static storyRequestService(win) {\n    return (/** @type {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService} */\n      (getExistingServiceOrNull(win, 'story-request')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!Promise<?../extensions/amp-story/1.0/localization.LocalizationService>}\n   */\n  static localizationServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/localization.LocalizationService>} */\n      (getElementServiceIfAvailable(win, 'localization', 'amp-story', true)));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/1.0/localization.LocalizationService}\n   */\n  static localizationService(win) {\n    return getService(win, 'localization');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService}\n   */\n  static storyStoreServiceV01(win) {\n    return getService(win, 'story-store');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/amp-story-request-service.AmpStoryRequestService}\n   */\n  static storyRequestServiceV01(win) {\n    return getService(win, 'story-request-v01');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!Promise<?../extensions/amp-story/0.1/localization.LocalizationService>}\n   */\n  static localizationServiceForOrNullV01(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/0.1/localization.LocalizationService>} */\n      (getElementServiceIfAvailable(win, 'localization-v01', 'amp-story',\n          true)));\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/localization.LocalizationService}\n   */\n  static localizationServiceV01(win) {\n    return getService(win, 'localization-v01');\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-viewer-integration/0.1/variable-service.ViewerIntegrationVariableDef>}\n   */\n  static viewerIntegrationVariableServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-viewer-integration/0.1/variable-service.ViewerIntegrationVariableDef>} */\n      (getElementServiceIfAvailable(win, 'viewer-integration-variable',\n          'amp-viewer-integration', true)));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>}\n   */\n  static webAnimationServiceFor(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>} */\n      (getElementServiceForDoc(\n          elementOrAmpDoc, 'web-animation', 'amp-animation')));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/storage-impl.Storage>}\n   */\n  static storageForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/storage-impl.Storage>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'storage'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/template-impl.Templates}\n   */\n  static templatesFor(window) {\n    return /** @type {!./service/template-impl.Templates} */ (\n      getService(window, 'templates'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/timer-impl.Timer}\n   */\n  static timerFor(window) {\n    return /** @type {!./service/timer-impl.Timer} */ (\n      getService(window, 'timer'));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/url-replacements-impl.UrlReplacements}\n   */\n  static urlReplacementsForDoc(nodeOrDoc) {\n    return /** @type {!./service/url-replacements-impl.UrlReplacements} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'url-replace', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>}\n   */\n  static userNotificationManagerForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>} */\n      (getElementServiceForDoc(elementOrAmpDoc, 'userNotificationManager',\n          'amp-user-notification')));\n  }\n\n  /**\n   * Returns a promise for the consentPolicy Service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>}\n   */\n  static consentPolicyServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>} */\n      (getElementServiceIfAvailableForDoc(elementOrAmpDoc,\n          'consentPolicyManager', 'amp-consent')));\n  }\n\n  /**\n   * Returns a promise for the geo service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>}\n   */\n  static geoForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>} */ (\n      getElementServiceIfAvailableForDoc(\n          elementOrAmpDoc, 'geo', 'amp-geo', true));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/url-impl.Url}\n   */\n  static urlForDoc(nodeOrDoc) {\n    return /** @type {!./service/url-impl.Url} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'url', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * Returns a promise for the experiment variants or a promise for null if it\n   * is not available on the current page.\n   * @param {!Window} win\n   * @return {!Promise<?Object<string>>}\n   */\n  static variantForOrNull(win) {\n    return /** @type {!Promise<?Object<string>>} */ (\n      getElementServiceIfAvailable(win, 'variant', 'amp-experiment', true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/video-service-interface.VideoServiceInterface}\n   */\n  static videoManagerForDoc(elementOrAmpDoc) {\n    return (\n      /** @type {!./service/video-service-interface.VideoServiceInterface} */ (\n        getServiceForDoc(elementOrAmpDoc, 'video-manager')));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Viewer is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/viewer-impl.Viewer}\n   */\n  static viewerForDoc(nodeOrDoc) {\n    return /** @type {!./service/viewer-impl.Viewer} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'viewer'));\n  }\n\n  /**\n   * Returns promise for the viewer. This is an unusual case and necessary only\n   * for services that need reference to the viewer before it has been\n   * initialized. Most of the code, however, just should use `viewerForDoc`.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/viewer-impl.Viewer>}\n   */\n  static viewerPromiseForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/viewer-impl.Viewer>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'viewer'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/vsync-impl.Vsync}\n   */\n  static vsyncFor(window) {\n    return /** @type {!./service/vsync-impl.Vsync} */ (\n      getService(window, 'vsync'));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Viewport is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/viewport/viewport-impl.Viewport}\n   */\n  static viewportForDoc(nodeOrDoc) {\n    return /** @type {!./service/viewport/viewport-impl.Viewport} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'viewport'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/xhr-impl.Xhr}\n   */\n  static xhrFor(window) {\n    return /** @type {!./service/xhr-impl.Xhr} */ (getService(window, 'xhr'));\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {string} _match\n * @param {string} character\n * @return {string}\n */\nfunction toUpperCase(_match, character) {\n  return character.toUpperCase();\n}\n\n/**\n * @param {string} match\n * @return {string}\n */\nfunction prependDashAndToLowerCase(match) {\n  return '-' + match.toLowerCase();\n}\n\n/**\n * @param {string} name Attribute name containing dashes.\n * @return {string} Dashes removed and successive character sent to upper case.\n * visibleForTesting\n */\nexport function dashToCamelCase(name) {\n  return name.replace(/-([a-z])/g, toUpperCase);\n}\n\n/**\n * Converts a string that is in camelCase to one that is in dash-case.\n *\n * @param {string} string The string to convert.\n * @return {string} The string in dash-case.\n */\nexport function camelCaseToDash(string) {\n  return string.replace(/(?!^)[A-Z]/g, prependDashAndToLowerCase);\n}\n\n/**\n * @param {string} name Attribute name with dashes\n * @return {string} Dashes replaced by underlines.\n */\nexport function dashToUnderline(name) {\n  return name.replace('-', '_');\n}\n\n/**\n * Polyfill for String.prototype.endsWith.\n * @param {string} string\n * @param {string} suffix\n * @return {boolean}\n */\nexport function endsWith(string, suffix) {\n  const index = string.length - suffix.length;\n  return index >= 0 && string.indexOf(suffix, index) == index;\n}\n\n/**\n * Polyfill for String.prototype.startsWith.\n * @param {string} string\n * @param {string} prefix\n * @return {boolean}\n */\nexport function startsWith(string, prefix) {\n  if (prefix.length > string.length) {\n    return false;\n  }\n  return string.lastIndexOf(prefix, 0) == 0;\n}\n\n/**\n * Expands placeholders in a given template string with values.\n *\n * Placeholders use ${key-name} syntax and are replaced with the value\n * returned from the given getter function.\n *\n * @param {string} template The template string to expand.\n * @param {function(string):*} getter Function used to retrieve a value for a\n *   placeholder. Returns values will be coerced into strings.\n * @param {number=} opt_maxIterations Number of times to expand the template.\n *   Defaults to 1, but should be set to a larger value your placeholder tokens\n *   can be expanded to other placeholder tokens. Take caution with large values\n *   as recursively expanding a string can be exponentially expensive.\n */\nexport function expandTemplate(template, getter, opt_maxIterations) {\n  const maxIterations = opt_maxIterations || 1;\n  for (let i = 0; i < maxIterations; i++) {\n    let matches = 0;\n    template = template.replace(/\\${([^}]*)}/g, (_a, b) => {\n      matches++;\n      return getter(b);\n    });\n    if (!matches) {\n      break;\n    }\n  }\n  return template;\n}\n\n/**\n * Hash function djb2a\n * This is intended to be a simple, fast hashing function using minimal code.\n * It does *not* have good cryptographic properties.\n * @param {string} str\n * @return {string} 32-bit unsigned hash of the string\n */\nexport function stringHash32(str) {\n  const {length} = str;\n  let hash = 5381;\n  for (let i = 0; i < length; i++) {\n    hash = hash * 33 ^ str.charCodeAt(i);\n  }\n  // Convert from 32-bit signed to unsigned.\n  return String(hash >>> 0);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from './services';\nimport {dev, rethrowAsync} from './log';\nimport {insertAfterOrAtStart, waitForBody} from './dom';\nimport {map} from './utils/object';\nimport {setStyles} from './style';\nimport {waitForServices} from './render-delaying-services';\n\nconst TRANSFORMER_PROP = '__AMP_CSS_TR';\nconst STYLE_MAP_PROP = '__AMP_CSS_SM';\nconst bodyVisibleSentinel = '__AMP_BODY_VISIBLE';\n\n\n/**\n * Adds the given css text to the given ampdoc.\n *\n * The style tags will be at the beginning of the head before all author\n * styles. One element can be the main runtime CSS. This is guaranteed\n * to always be the first stylesheet in the doc.\n *\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc The ampdoc that should get the new styles.\n * @param {string} cssText\n * @param {?function(!Element)|undefined} cb Called when the new styles are available.\n *     Not using a promise, because this is synchronous when possible.\n *     for better performance.\n * @param {boolean=} opt_isRuntimeCss If true, this style tag will be inserted\n *     as the first element in head and all style elements will be positioned\n *     after.\n * @param {string=} opt_ext\n * @return {!Element}\n */\nexport function installStylesForDoc(\n  ampdoc, cssText, cb, opt_isRuntimeCss, opt_ext) {\n  const cssRoot = ampdoc.getHeadNode();\n  const style = insertStyleElement(\n      cssRoot,\n      maybeTransform(cssRoot, cssText),\n      opt_isRuntimeCss || false,\n      opt_ext || null);\n\n  if (cb) {\n    const rootNode = ampdoc.getRootNode();\n    // Styles aren't always available synchronously. E.g. if there is a\n    // pending style download, it will have to finish before the new\n    // style is visible.\n    // For this reason we poll until the style becomes available.\n    // Sync case.\n    if (styleLoaded(rootNode, style)) {\n      cb(style);\n      return style;\n    }\n    // Poll until styles are available.\n    const interval = setInterval(() => {\n      if (styleLoaded(rootNode, style)) {\n        clearInterval(interval);\n        cb(style);\n      }\n    }, 4);\n  }\n  return style;\n}\n\n\n/**\n * Adds the given css text to the given document.\n * TODO(dvoytenko, #10705): Remove this method once FIE/ampdoc migration is\n * done.\n *\n * @param {!Document} doc The document that should get the new styles.\n * @param {string} cssText\n * @param {?function(!Element)|undefined} cb Called when the new styles are\n *     available. Not using a promise, because this is synchronous when\n *     possible. for better performance.\n * @param {boolean=} opt_isRuntimeCss If true, this style tag will be inserted\n *     as the first element in head and all style elements will be positioned\n *     after.\n * @param {string=} opt_ext\n * @return {!Element}\n */\nexport function installStylesLegacy(\n  doc, cssText, cb, opt_isRuntimeCss, opt_ext) {\n  const style = insertStyleElement(\n      dev().assertElement(doc.head),\n      cssText,\n      opt_isRuntimeCss || false,\n      opt_ext || null);\n\n  if (cb) {\n    // Styles aren't always available synchronously. E.g. if there is a\n    // pending style download, it will have to finish before the new\n    // style is visible.\n    // For this reason we poll until the style becomes available.\n    // Sync case.\n    if (styleLoaded(doc, style)) {\n      cb(style);\n      return style;\n    }\n    // Poll until styles are available.\n    const interval = setInterval(() => {\n      if (styleLoaded(doc, style)) {\n        clearInterval(interval);\n        cb(style);\n      }\n    }, 4);\n  }\n  return style;\n}\n\n\n/**\n * Creates the properly configured style element.\n * @param {!Element|!ShadowRoot} cssRoot\n * @param {string} cssText\n * @param {boolean} isRuntimeCss\n * @param {?string} ext\n * @return {!Element}\n */\nfunction insertStyleElement(cssRoot, cssText, isRuntimeCss, ext) {\n  let styleMap = cssRoot[STYLE_MAP_PROP];\n  if (!styleMap) {\n    styleMap = cssRoot[STYLE_MAP_PROP] = map();\n  }\n\n  const isExtCss = !isRuntimeCss &&\n      (ext && ext != 'amp-custom' && ext != 'amp-keyframes');\n  const key =\n      isRuntimeCss ? 'amp-runtime' :\n        isExtCss ? `amp-extension=${ext}` : null;\n\n  // Check if it has already been created or discovered.\n  if (key) {\n    const existing = getExistingStyleElement(cssRoot, styleMap, key);\n    if (existing) {\n      return existing;\n    }\n  }\n\n  // Create the new style element and append to cssRoot.\n  const doc = (cssRoot.ownerDocument || cssRoot);\n  const style = doc.createElement('style');\n  style./*OK*/textContent = cssText;\n  let afterElement = null;\n  // Make sure that we place style tags after the main runtime CSS. Otherwise\n  // the order is random.\n  if (isRuntimeCss) {\n    style.setAttribute('amp-runtime', '');\n  } else if (isExtCss) {\n    style.setAttribute('amp-extension', ext || '');\n    afterElement = dev().assertElement(getExistingStyleElement(\n        cssRoot, styleMap, 'amp-runtime'));\n  } else {\n    if (ext) {\n      style.setAttribute(ext, '');\n    }\n    afterElement = cssRoot.lastChild;\n  }\n  insertAfterOrAtStart(cssRoot, style, afterElement);\n  if (key) {\n    styleMap[key] = style;\n  }\n  return style;\n}\n\n\n/**\n * @param {!Element|!ShadowRoot} cssRoot\n * @param {!Object<string, !Element>} styleMap\n * @param {string} key\n * @return {?Element}\n */\nfunction getExistingStyleElement(cssRoot, styleMap, key) {\n  // Already cached.\n  if (styleMap[key]) {\n    return styleMap[key];\n  }\n  // Check if the style has already been added by the server layout.\n  const existing = cssRoot./*OK*/querySelector(`style[${key}]`);\n  if (existing) {\n    styleMap[key] = existing;\n    return existing;\n  }\n  // Nothing found.\n  return null;\n}\n\n\n/**\n * Applies a transformer to the CSS text if it has been registered.\n * @param {!Element|!ShadowRoot} cssRoot\n * @param {function(string):string} transformer\n */\nexport function installCssTransformer(cssRoot, transformer) {\n  cssRoot[TRANSFORMER_PROP] = transformer;\n}\n\n\n/**\n * Applies a transformer to the CSS text if it has been registered.\n * @param {!Element|!ShadowRoot} cssRoot\n * @param {string} cssText\n * @return {string}\n */\nfunction maybeTransform(cssRoot, cssText) {\n  const transformer = cssRoot[TRANSFORMER_PROP];\n  return transformer ? transformer(cssText) : cssText;\n}\n\n\n/**\n * Sets the document's body opacity to 1.\n * If the body is not yet available (because our script was loaded\n * synchronously), polls until it is.\n * @param {!Document} doc The document who's body we should make visible.\n * @param {boolean=} opt_waitForServices Whether the body visibility should\n *     be blocked on key services being loaded.\n */\nexport function makeBodyVisible(doc, opt_waitForServices) {\n  dev().assert(doc.defaultView, 'Passed in document must have a defaultView');\n  const win = /** @type {!Window} */ (doc.defaultView);\n  if (win[bodyVisibleSentinel]) {\n    return;\n  }\n  const set = () => {\n    win[bodyVisibleSentinel] = true;\n    setStyles(dev().assertElement(doc.body), {\n      opacity: 1,\n      visibility: 'visible',\n      'animation': 'none',\n    });\n    renderStartedNoInline(doc);\n  };\n  try {\n    waitForBody(doc, () => {\n      if (win[bodyVisibleSentinel]) {\n        return;\n      }\n      win[bodyVisibleSentinel] = true;\n      if (opt_waitForServices) {\n        waitForServices(win).catch(reason => {\n          rethrowAsync(reason);\n          return [];\n        }).then(services => {\n          set();\n          if (services.length > 0) {\n            Services.resourcesForDoc(doc)./*OK*/schedulePass(\n                1, /* relayoutAll */ true);\n          }\n          try {\n            const perf = Services.performanceFor(win);\n            perf.tick('mbv');\n            perf.flush();\n          } catch (e) {}\n        });\n      } else {\n        set();\n      }\n    });\n  } catch (e) {\n    // If there was an error during the logic above (such as service not\n    // yet installed, definitely try to make the body visible.\n    set();\n    // Avoid errors in the function to break execution flow as this is\n    // often called as a last resort.\n    rethrowAsync(e);\n  }\n}\n\n\n/**\n * @param {!Document} doc\n */\nfunction renderStartedNoInline(doc) {\n  try {\n    Services.resourcesForDoc(doc).renderStarted();\n  } catch (e) {\n    // `makeBodyVisible` is called in the error-processing cycle and thus\n    // could be triggered when runtime's initialization is incomplete which\n    // would cause unrelated errors to be thrown here.\n  }\n}\n\n\n/**\n * Indicates that the body is always visible. For instance, in case of PWA.\n * @param {!Window} win\n */\nexport function bodyAlwaysVisible(win) {\n  win[bodyVisibleSentinel] = true;\n}\n\n\n/**\n * Checks whether a style element was registered in the DOM.\n * @param {!Document|!ShadowRoot} doc\n * @param {!Element} style\n * @return {boolean}\n */\nfunction styleLoaded(doc, style) {\n  const sheets = doc.styleSheets;\n  for (let i = 0; i < sheets.length; i++) {\n    const sheet = sheets[i];\n    if (sheet.ownerNode == style) {\n      return true;\n    }\n  }\n  return false;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Note: loaded by 3p system. Cannot rely on babel polyfills.\nimport {map} from './utils/object.js';\nimport {startsWith} from './string';\n\n\n/** @type {Object<string, string>} */\nlet propertyNameCache;\n\n/** @const {!Array<string>} */\nconst vendorPrefixes = ['Webkit', 'webkit', 'Moz', 'moz', 'ms', 'O', 'o'];\n\n\n/**\n * @export\n * @param {string} camelCase camel cased string\n * @return {string} title cased string\n */\nexport function camelCaseToTitleCase(camelCase) {\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n}\n\n/**\n * Checks the style if a prefixed version of a property exists and returns\n * it or returns an empty string.\n * @private\n * @param {!Object} style\n * @param {string} titleCase the title case version of a css property name\n * @return {string} the prefixed property name or null.\n */\nfunction getVendorJsPropertyName_(style, titleCase) {\n  for (let i = 0; i < vendorPrefixes.length; i++) {\n    const propertyName = vendorPrefixes[i] + titleCase;\n    if (style[propertyName] !== undefined) {\n      return propertyName;\n    }\n  }\n  return '';\n}\n\n/**\n * Returns the possibly prefixed JavaScript property name of a style property\n * (ex. WebkitTransitionDuration) given a camelCase'd version of the property\n * (ex. transitionDuration).\n * @export\n * @param {!Object} style\n * @param {string} camelCase the camel cased version of a css property name\n * @param {boolean=} opt_bypassCache bypass the memoized cache of property\n *   mapping\n * @return {string}\n */\nexport function getVendorJsPropertyName(style, camelCase, opt_bypassCache) {\n  if (startsWith(camelCase, '--')) {\n    // CSS vars are returned as is.\n    return camelCase;\n  }\n  if (!propertyNameCache) {\n    propertyNameCache = map();\n  }\n  let propertyName = propertyNameCache[camelCase];\n  if (!propertyName || opt_bypassCache) {\n    propertyName = camelCase;\n    if (style[camelCase] === undefined) {\n      const titleCase = camelCaseToTitleCase(camelCase);\n      const prefixedPropertyName = getVendorJsPropertyName_(style, titleCase);\n\n      if (style[prefixedPropertyName] !== undefined) {\n        propertyName = prefixedPropertyName;\n      }\n    }\n    if (!opt_bypassCache) {\n      propertyNameCache[camelCase] = propertyName;\n    }\n  }\n  return propertyName;\n}\n\n\n/**\n * Sets the CSS styles of the specified element with !important. The styles\n * are specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setImportantStyles(element, styles) {\n  for (const k in styles) {\n    element.style.setProperty(\n        getVendorJsPropertyName(styles, k), styles[k].toString(), 'important');\n  }\n}\n\n\n/**\n * Sets the CSS style of the specified element with optional units, e.g. \"px\".\n * @param {?Element} element\n * @param {string} property\n * @param {*} value\n * @param {string=} opt_units\n * @param {boolean=} opt_bypassCache\n */\nexport function setStyle(element, property, value, opt_units, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (propertyName) {\n    element.style[propertyName] =\n      /** @type {string} */ (opt_units ? value + opt_units : value);\n  }\n}\n\n\n/**\n * Returns the value of the CSS style of the specified element.\n * @param {!Element} element\n * @param {string} property\n * @param {boolean=} opt_bypassCache\n * @return {*}\n */\nexport function getStyle(element, property, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (!propertyName) {\n    return undefined;\n  }\n  return element.style[propertyName];\n}\n\n\n/**\n * Sets the CSS styles of the specified element. The styles\n * a specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setStyles(element, styles) {\n  for (const k in styles) {\n    setStyle(element, k, styles[k]);\n  }\n}\n\n\n/**\n * Shows or hides the specified element.\n * @param {!Element} element\n * @param {boolean=} opt_display\n */\nexport function toggle(element, opt_display) {\n  if (opt_display === undefined) {\n    opt_display = getStyle(element, 'display') == 'none';\n  }\n  setStyle(element, 'display', opt_display ? '' : 'none');\n}\n\n\n/**\n * Returns a pixel value.\n * @param {number} value\n * @return {string}\n */\nexport function px(value) {\n  return `${value}px`;\n}\n\n/**\n * Returns a degree value.\n * @param {number} value\n * @return {string}\n */\nexport function deg(value) {\n  return `${value}deg`;\n}\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function translateX(value) {\n  if (typeof value == 'string') {\n    return `translateX(${value})`;\n  }\n  return `translateX(${px(value)})`;\n}\n\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} x\n * @param {(number|string)=} opt_y\n * @return {string}\n */\nexport function translate(x, opt_y) {\n  if (typeof x == 'number') {\n    x = px(x);\n  }\n  if (opt_y === undefined) {\n    return `translate(${x})`;\n  }\n  if (typeof opt_y == 'number') {\n    opt_y = px(opt_y);\n  }\n  return `translate(${x}, ${opt_y})`;\n}\n\n\n/**\n * Returns a \"scale\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function scale(value) {\n  return `scale(${value})`;\n}\n\n/**\n * Returns a \"rotate\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function rotate(value) {\n  if (typeof value == 'number') {\n    value = deg(value);\n  }\n  return `rotate(${value})`;\n}\n\n/**\n * Remove alpha value from a rgba color value.\n * Return the new color property with alpha equals if has the alpha value.\n * Caller needs to make sure the input color value is a valid rgba/rgb value\n * @param {string} rgbaColor\n * @return {string}\n */\nexport function removeAlphaFromColor(rgbaColor) {\n  return rgbaColor.replace(\n      /\\(([^,]+),([^,]+),([^,)]+),[^)]+\\)/g, '($1,$2,$3, 1)');\n}\n\n/**\n * Gets the computed style of the element. The helper is necessary to enforce\n * the possible `null` value returned by a buggy Firefox.\n *\n * @param {!Window} win\n * @param {!Element} el\n * @return {!Object<string, string>}\n */\nexport function computedStyle(win, el) {\n  const style = /** @type {?CSSStyleDeclaration} */(win.getComputedStyle(el));\n  return /** @type {!Object<string, string>} */(style) || map();\n}\n\n\n/**\n * Resets styles that were set dynamically (i.e. inline)\n * @param {!Element} element\n * @param {!Array<string>} properties\n */\nexport function resetStyles(element, properties) {\n  const styleObj = {};\n  properties.forEach(prop => {\n    styleObj[prop] = null;\n  });\n  setStyles(element, styleObj);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* @const */\nconst toString_ = Object.prototype.toString;\n\n/**\n * Returns the ECMA [[Class]] of a value\n * @param {*} value\n * @return {string}\n */\nfunction toString(value) {\n  return toString_.call(value);\n}\n\n/**\n * Determines if value is actually an Array.\n * @param {*} value\n * @return {boolean}\n */\nexport function isArray(value) {\n  return Array.isArray(value);\n}\n\n/**\n * Converts an array-like object to an array.\n * @param {?IArrayLike<T>|string} arrayLike\n * @return {!Array<T>}\n * @template T\n */\nexport function toArray(arrayLike) {\n  if (!arrayLike) {\n    return [];\n  }\n  const array = new Array(arrayLike.length);\n  for (let i = 0; i < arrayLike.length; i++) {\n    array[i] = arrayLike[i];\n  }\n  return array;\n}\n\n/**\n * Determines if value is actually an Object.\n * @param {*} value\n * @return {boolean}\n */\nexport function isObject(value) {\n  return toString(value) === '[object Object]';\n}\n\n/**\n * Determines if value is of number type and finite.\n * NaN and Infinity are not considered a finite number.\n * String numbers are not considered numbers.\n * @param {*} value\n * @return {boolean}\n */\nexport function isFiniteNumber(value) {\n  return (typeof value === 'number' && isFinite(value));\n}\n\n/**\n * Checks whether `s` is a valid value of `enumObj`.\n *\n * @param {!Object<T>} enumObj\n * @param {T} s\n * @return {boolean}\n * @template T\n */\nexport function isEnumValue(enumObj, s) {\n  for (const k in enumObj) {\n    if (enumObj[k] === s) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Externs declare that access `defaultView` from `document` or\n * `ownerDocument` is of type `(Window|null)` but most of our parameter types\n * assume that it is never null. This is OK in practice as we ever only get\n * null on disconnected documents or old IE.\n * This helper function casts it into just a simple Window return type.\n *\n * @param {!Window|null} winOrNull\n * @return {!Window}\n */\nexport function toWin(winOrNull) {\n  return /** @type {!Window} */ (winOrNull);\n}\n\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {tryDecodeUriComponent_} from './url-try-decode-uri-component';\n\nconst regex = /(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * DO NOT import the function from this file. Instead, import parseQueryString\n * from `src/url.js`.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString_(queryString) {\n  const params = /** @type {!JsonObject} */ (Object.create(null));\n  if (!queryString) {\n    return params;\n  }\n\n  let match;\n  while ((match = regex.exec(queryString))) {\n    const name = tryDecodeUriComponent_(match[1], match[1]);\n    const value = match[2] ? tryDecodeUriComponent_(match[2], match[2]) : '';\n    params[name] = value;\n  }\n  return params;\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * DO NOT import the function from this file. Instead, import\n * tryDecodeUriComponent from `src/url.js`.\n *\n * @param {string} component\n * @param {string=} fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent_(component, fallback = '') {\n  try {\n    return decodeURIComponent(component);\n  } catch (e) {\n    return fallback;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {LruCache} from './utils/lru-cache';\nimport {dict} from './utils/object';\nimport {endsWith, startsWith} from './string';\nimport {getMode} from './mode';\nimport {isArray} from './types';\nimport {parseQueryString_} from './url-parse-query-string';\nimport {tryDecodeUriComponent_} from './url-try-decode-uri-component';\nimport {urls} from './config';\nimport {user} from './log';\n\n/**\n * @type {!JsonObject}\n */\nconst SERVING_TYPE_PREFIX = dict({\n  // No viewer\n  'c': true,\n  // In viewer\n  'v': true,\n  // Ad landing page\n  'a': true,\n  // Ad\n  'ad': true,\n});\n\n/**\n * Cached a-tag to avoid memory allocation during URL parsing.\n * @type {HTMLAnchorElement}\n */\nlet a;\n\n/**\n * We cached all parsed URLs. As of now there are no use cases\n * of AMP docs that would ever parse an actual large number of URLs,\n * but we often parse the same one over and over again.\n * @type {LruCache}\n */\nlet cache;\n\n/** @private @const Matches amp_js_* parameters in query string. */\nconst AMP_JS_PARAMS_REGEX = /[?&]amp_js[^&]*/;\n\n/** @private @const Matches amp_gsa parameters in query string. */\nconst AMP_GSA_PARAMS_REGEX = /[?&]amp_gsa[^&]*/;\n\n/** @private @const Matches amp_r parameters in query string. */\nconst AMP_R_PARAMS_REGEX = /[?&]amp_r[^&]*/;\n\n/** @private @const Matches usqp parameters from goog experiment in query string. */\nconst GOOGLE_EXPERIMENT_PARAMS_REGEX = /[?&]usqp[^&]*/;\n\nconst INVALID_PROTOCOLS = [\n  /*eslint no-script-url: 0*/ 'javascript:',\n  /*eslint no-script-url: 0*/ 'data:',\n  /*eslint no-script-url: 0*/ 'vbscript:',\n];\n\n/** @const {string} */\nexport const SOURCE_ORIGIN_PARAM = '__amp_source_origin';\n\n/**\n * Returns the correct origin for a given window.\n * @param {!Window} win\n * @return {string} origin\n */\nexport function getWinOrigin(win) {\n  return win.origin || parseUrlDeprecated(win.location.href).origin;\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {string} url\n * @param {boolean=} opt_nocache\n * @return {!Location}\n */\nexport function parseUrlDeprecated(url, opt_nocache) {\n  if (!a) {\n    a = /** @type {!HTMLAnchorElement} */ (self.document.createElement('a'));\n    cache = self.UrlCache || (self.UrlCache = new LruCache(100));\n  }\n\n  return parseUrlWithA(a, url, opt_nocache ? null : cache);\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {!HTMLAnchorElement} a\n * @param {string} url\n * @param {LruCache=} opt_cache\n * @return {!Location}\n * @restricted\n */\nexport function parseUrlWithA(a, url, opt_cache) {\n  if (opt_cache && opt_cache.has(url)) {\n    return opt_cache.get(url);\n  }\n\n  a.href = url;\n\n  // IE11 doesn't provide full URL components when parsing relative URLs.\n  // Assigning to itself again does the trick #3449.\n  if (!a.protocol) {\n    a.href = a.href;\n  }\n\n  const info = /** @type {!Location} */({\n    href: a.href,\n    protocol: a.protocol,\n    host: a.host,\n    hostname: a.hostname,\n    port: a.port == '0' ? '' : a.port,\n    pathname: a.pathname,\n    search: a.search,\n    hash: a.hash,\n    origin: null, // Set below.\n  });\n\n  // Some IE11 specific polyfills.\n  // 1) IE11 strips out the leading '/' in the pathname.\n  if (info.pathname[0] !== '/') {\n    info.pathname = '/' + info.pathname;\n  }\n\n  // 2) For URLs with implicit ports, IE11 parses to default ports while\n  // other browsers leave the port field empty.\n  if ((info.protocol == 'http:' && info.port == 80)\n      || (info.protocol == 'https:' && info.port == 443)) {\n    info.port = '';\n    info.host = info.hostname;\n  }\n\n  // For data URI a.origin is equal to the string 'null' which is not useful.\n  // We instead return the actual origin which is the full URL.\n  if (a.origin && a.origin != 'null') {\n    info.origin = a.origin;\n  } else if (info.protocol == 'data:' || !info.host) {\n    info.origin = info.href;\n  } else {\n    info.origin = info.protocol + '//' + info.host;\n  }\n\n  // Freeze during testing to avoid accidental mutation.\n  const frozen = (getMode().test && Object.freeze) ? Object.freeze(info) : info;\n\n  if (opt_cache) {\n    opt_cache.put(url, frozen);\n  }\n\n  return frozen;\n}\n\n/**\n * Appends the string just before the fragment part (or optionally\n * to the front of the query string) of the URL.\n * @param {string} url\n * @param {string} paramString\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function appendEncodedParamStringToUrl(url, paramString,\n  opt_addToFront) {\n  if (!paramString) {\n    return url;\n  }\n  const mainAndFragment = url.split('#', 2);\n  const mainAndQuery = mainAndFragment[0].split('?', 2);\n\n  let newUrl = mainAndQuery[0] + (\n    mainAndQuery[1]\n      ? (opt_addToFront\n        ? `?${paramString}&${mainAndQuery[1]}`\n        : `?${mainAndQuery[1]}&${paramString}`)\n      : `?${paramString}`);\n  newUrl += mainAndFragment[1] ? `#${mainAndFragment[1]}` : '';\n  return newUrl;\n}\n/**\n * Appends a query string field and value to a url. `key` and `value`\n * will be ran through `encodeURIComponent` before appending.\n * @param {string} url\n * @param {string} key\n * @param {string} value\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function addParamToUrl(url, key, value, opt_addToFront) {\n  const field = `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\n  return appendEncodedParamStringToUrl(url, field, opt_addToFront);\n}\n\n/**\n * Appends query string fields and values to a url. The `params` objects'\n * `key`s and `value`s will be transformed into query string keys/values.\n * @param {string} url\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function addParamsToUrl(url, params) {\n  return appendEncodedParamStringToUrl(url, serializeQueryString(params));\n}\n\n/**\n * Serializes the passed parameter map into a query string with both keys\n * and values encoded.\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function serializeQueryString(params) {\n  const s = [];\n  for (const k in params) {\n    const v = params[k];\n    if (v == null) {\n      continue;\n    } else if (isArray(v)) {\n      for (let i = 0; i < v.length; i++) {\n        const sv = /** @type {string} */ (v[i]);\n        s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n      }\n    } else {\n      const sv = /** @type {string} */ (v);\n      s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n    }\n  }\n  return s.join('&');\n}\n\n/**\n * Returns `true` if the URL is secure: either HTTPS or localhost (for testing).\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isSecureUrlDeprecated(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return (url.protocol == 'https:' ||\n      url.hostname == 'localhost' ||\n      endsWith(url.hostname, '.localhost'));\n}\n\n/**\n * Asserts that a given url is HTTPS or protocol relative. It's a user-level\n * assert.\n *\n * Provides an exception for localhost.\n *\n * @param {?string|undefined} urlString\n * @param {!Element|string} elementContext Element where the url was found.\n * @param {string=} sourceName Used for error messages.\n * @return {string}\n */\nexport function assertHttpsUrl(\n  urlString, elementContext, sourceName = 'source') {\n  user().assert(urlString != null, '%s %s must be available',\n      elementContext, sourceName);\n  // (erwinm, #4560): type cast necessary until #4560 is fixed.\n  const theUrlString = /** @type {string} */ (urlString);\n  user().assert(isSecureUrlDeprecated(theUrlString) || /^(\\/\\/)/.test(theUrlString),\n      '%s %s must start with ' +\n      '\"https://\" or \"//\" or be relative and served from ' +\n      'either https or from localhost. Invalid value: %s',\n      elementContext, sourceName, theUrlString);\n  return theUrlString;\n}\n\n/**\n * Asserts that a given url is an absolute HTTP or HTTPS URL.\n * @param {string} urlString\n * @return {string}\n */\nexport function assertAbsoluteHttpOrHttpsUrl(urlString) {\n  user().assert(/^https?\\:/i.test(urlString),\n      'URL must start with \"http://\" or \"https://\". Invalid value: %s',\n      urlString);\n  return parseUrlDeprecated(urlString).href;\n}\n\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * This function is implemented in a separate file to avoid a circular\n * dependency.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString(queryString) {\n  return parseQueryString_(queryString);\n}\n\n/**\n * Returns the URL without fragment. If URL doesn't contain fragment, the same\n * string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function removeFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return url;\n  }\n  return url.substring(0, index);\n}\n\n/**\n * Returns the fragment from the URL. If the URL doesn't contain fragment,\n * the empty string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function getFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return '';\n  }\n  return url.substring(index);\n}\n\n/**\n * Returns whether the URL has the origin of a proxy.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isProxyOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.cdnProxyRegex.test(url.origin);\n}\n\n/**\n * For proxy-origin URLs, returns the serving type. Otherwise, returns null.\n * E.g., 'https://amp-com.cdn.ampproject.org/a/s/amp.com/amp_document.html'\n * returns 'a'.\n * @param {string|!Location} url URL of an AMP document.\n * @return {?string}\n */\nexport function getProxyServingType(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  if (!isProxyOrigin(url)) {\n    return null;\n  }\n  const path = url.pathname.split('/', 2);\n  return path[1];\n}\n\n/**\n * Returns whether the URL origin is localhost.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isLocalhostOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.localhostRegex.test(url.origin);\n}\n\n/**\n * Returns whether the URL has valid protocol.\n * Deep link protocol is valid, but not javascript etc.\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isProtocolValid(url) {\n  if (!url) {\n    return true;\n  }\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return !INVALID_PROTOCOLS.includes(url.protocol);\n}\n\n/**\n * Returns a URL without AMP JS parameters.\n * @param {string} url\n * @return {string}\n */\nexport function removeAmpJsParamsFromUrl(url) {\n  const parsed = parseUrlDeprecated(url);\n  const search = removeAmpJsParamsFromSearch(parsed.search);\n  return parsed.origin + parsed.pathname + search + parsed.hash;\n\n}\n\n/**\n * Returns a URL without a query string.\n * @param {string} url\n * @return {string}\n */\nexport function removeSearch(url) {\n  const index = url.indexOf('?');\n  if (index == -1) {\n    return url;\n  }\n  const fragment = getFragment(url);\n  return url.substring(0, index) + fragment;\n}\n\n/**\n * Removes parameters that start with amp js parameter pattern and returns the\n * new search string.\n * @param {string} urlSearch\n * @return {string}\n */\nfunction removeAmpJsParamsFromSearch(urlSearch) {\n  if (!urlSearch || urlSearch == '?') {\n    return '';\n  }\n  const search = urlSearch\n      .replace(AMP_JS_PARAMS_REGEX, '')\n      .replace(AMP_GSA_PARAMS_REGEX, '')\n      .replace(AMP_R_PARAMS_REGEX, '')\n      .replace(GOOGLE_EXPERIMENT_PARAMS_REGEX, '')\n      .replace(/^[?&]/, ''); // Removes first ? or &.\n  return search ? '?' + search : '';\n}\n\n/**\n * Returns the source URL of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string}\n */\nexport function getSourceUrl(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n\n  // Not a proxy URL - return the URL itself.\n  if (!isProxyOrigin(url)) {\n    return url.href;\n  }\n\n  // A proxy URL.\n  // Example path that is being matched here.\n  // https://cdn.ampproject.org/c/s/www.origin.com/foo/\n  // The /s/ is optional and signals a secure origin.\n  const path = url.pathname.split('/');\n  const prefix = path[1];\n  user().assert(SERVING_TYPE_PREFIX[prefix],\n      'Unknown path prefix in url %s', url.href);\n  const domainOrHttpsSignal = path[2];\n  const origin = domainOrHttpsSignal == 's'\n    ? 'https://' + decodeURIComponent(path[3])\n    : 'http://' + decodeURIComponent(domainOrHttpsSignal);\n  // Sanity test that what we found looks like a domain.\n  user().assert(origin.indexOf('.') > 0, 'Expected a . in origin %s', origin);\n  path.splice(1, domainOrHttpsSignal == 's' ? 3 : 2);\n  return origin + path.join('/') +\n      removeAmpJsParamsFromSearch(url.search) + (url.hash || '');\n}\n\n/**\n * Returns the source origin of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string} The source origin of the URL.\n */\nexport function getSourceOrigin(url) {\n  return parseUrlDeprecated(getSourceUrl(url)).origin;\n}\n\n/**\n * Returns absolute URL resolved based on the relative URL and the base.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n */\nexport function resolveRelativeUrl(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  if (typeof URL == 'function') {\n    return new URL(relativeUrlString, baseUrl.href).toString();\n  }\n  return resolveRelativeUrlFallback_(relativeUrlString, baseUrl);\n}\n\n/**\n * Fallback for URL resolver when URL class is not available.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n * @private Visible for testing.\n */\nexport function resolveRelativeUrlFallback_(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  relativeUrlString = relativeUrlString.replace(/\\\\/g, '/');\n  const relativeUrl = parseUrlDeprecated(relativeUrlString);\n\n  // Absolute URL.\n  if (startsWith(relativeUrlString.toLowerCase(), relativeUrl.protocol)) {\n    return relativeUrl.href;\n  }\n\n  // Protocol-relative URL.\n  if (startsWith(relativeUrlString, '//')) {\n    return baseUrl.protocol + relativeUrlString;\n  }\n\n  // Absolute path.\n  if (startsWith(relativeUrlString, '/')) {\n    return baseUrl.origin + relativeUrlString;\n  }\n\n  // Relative path.\n  return baseUrl.origin + baseUrl.pathname.replace(/\\/[^/]*$/, '/')\n      + relativeUrlString;\n}\n\n\n/**\n * Add \"__amp_source_origin\" query parameter to the URL.\n * @param {!Window} win\n * @param {string} url\n * @return {string}\n */\nexport function getCorsUrl(win, url) {\n  checkCorsUrl(url);\n  const sourceOrigin = getSourceOrigin(win.location.href);\n  return addParamToUrl(url, SOURCE_ORIGIN_PARAM, sourceOrigin);\n}\n\n\n/**\n * Checks if the url has __amp_source_origin and throws if it does.\n * @param {string} url\n */\nexport function checkCorsUrl(url) {\n  const parsedUrl = parseUrlDeprecated(url);\n  const query = parseQueryString(parsedUrl.search);\n  user().assert(!(SOURCE_ORIGIN_PARAM in query),\n      'Source origin is not allowed in %s', url);\n}\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * @param {string} component\n * @param {string=} opt_fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent(component, opt_fallback) {\n  return tryDecodeUriComponent_(component, opt_fallback);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {bytesToString, stringToBytes, utf8Encode} from './bytes';\n\n/**\n * Character mapping from base64url to base64.\n * @const {!Object<string, string>}\n */\nconst base64UrlDecodeSubs = {'-': '+', '_': '/', '.': '='};\n\n/**\n * Character mapping from base64 to base64url.\n * @const {!Object<string, string>}\n */\nconst base64UrlEncodeSubs = {'+': '-', '/': '_', '=': '.'};\n\n/**\n * Converts a string which is in base64url encoding into a Uint8Array\n * containing the decoded value.\n * @param {string} str\n * @return {!Uint8Array}\n */\nexport function base64UrlDecodeToBytes(str) {\n  const encoded = atob(str.replace(/[-_.]/g, ch => base64UrlDecodeSubs[ch]));\n  return stringToBytes(encoded);\n}\n\n/**\n * Converts a string which is in base64 encoding into a Uint8Array\n * containing the decoded value.\n * @param {string} str\n * @return {!Uint8Array}\n */\nexport function base64DecodeToBytes(str) {\n  return stringToBytes(atob(str));\n}\n\n/**\n * Converts a bytes array into base64url encoded string.\n * base64url is defined in RFC 4648. It is sometimes referred to as \"web safe\".\n * @param {!Uint8Array} bytes\n * @return {string}\n */\nexport function base64UrlEncodeFromBytes(bytes) {\n  const str = bytesToString(bytes);\n  return btoa(str).replace(/[+/=]/g, ch => base64UrlEncodeSubs[ch]);\n}\n\n/**\n * Converts a string into base64url encoded string.\n * base64url is defined in RFC 4648. It is sometimes referred to as \"web safe\".\n * @param {string} str\n * @return {string}\n */\nexport function base64UrlEncodeFromString(str) {\n  const bytes = utf8Encode(str);\n  return base64UrlEncodeFromBytes(bytes);\n}\n\n/**\n * Converts a bytes array into base64 encoded string.\n * @param {!Uint8Array} bytes\n * @return {string}\n */\nexport function base64EncodeFromBytes(bytes) {\n  return btoa(bytesToString(bytes));\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from '../log';\n\n/**\n * Interpret a byte array as a UTF-8 string.\n * @param {!BufferSource} bytes\n * @return {string}\n */\nexport function utf8Decode(bytes) {\n  if (typeof TextDecoder !== 'undefined') {\n    return new TextDecoder('utf-8').decode(bytes);\n  }\n  const asciiString = bytesToString(new Uint8Array(bytes.buffer || bytes));\n  return decodeURIComponent(escape(asciiString));\n}\n\n/**\n * Turn a string into UTF-8 bytes.\n * @param {string} string\n * @return {!Uint8Array}\n */\nexport function utf8Encode(string) {\n  if (typeof TextEncoder !== 'undefined') {\n    return new TextEncoder('utf-8').encode(string);\n  }\n  return stringToBytes(unescape(encodeURIComponent(string)));\n}\n\n/**\n * Converts a string which holds 8-bit code points, such as the result of atob,\n * into a Uint8Array with the corresponding bytes.\n * If you have a string of characters, you probably want to be using utf8Encode.\n * @param {string} str\n * @return {!Uint8Array}\n */\nexport function stringToBytes(str) {\n  const bytes = new Uint8Array(str.length);\n  for (let i = 0; i < str.length; i++) {\n    const charCode = str.charCodeAt(i);\n    dev().assert(charCode <= 255, 'Characters must be in range [0,255]');\n    bytes[i] = charCode;\n  }\n  return bytes;\n}\n\n/**\n * Converts a 8-bit bytes array into a string\n * @param {!Uint8Array} bytes\n * @return {string}\n */\nexport function bytesToString(bytes) {\n  // Intentionally avoids String.fromCharCode.apply so we don't suffer a\n  // stack overflow. #10495, https://jsperf.com/bytesToString-2\n  const array = new Array(bytes.length);\n  for (let i = 0; i < bytes.length; i++) {\n    array[i] = String.fromCharCode(bytes[i]);\n  }\n  return array.join('');\n}\n\n/**\n * Converts a 4-item byte array to an unsigned integer.\n * Assumes bytes are big endian.\n * @param {!Uint8Array} bytes\n * @return {number}\n */\nexport function bytesToUInt32(bytes) {\n  if (bytes.length != 4) {\n    throw new Error('Received byte array with length != 4');\n  }\n  const val = (bytes[0] & 0xFF) << 24 |\n     (bytes[1] & 0xFF) << 16 |\n     (bytes[2] & 0xFF) << 8 |\n     (bytes[3] & 0xFF);\n  // Convert to unsigned.\n  return val >>> 0;\n}\n\n/**\n * Generate a random bytes array with specific length using\n * win.crypto.getRandomValues. Return null if it is not available.\n * @param {!Window} win\n * @param {number} length\n * @return {?Uint8Array}\n */\nexport function getCryptoRandomBytesArray(win, length) {\n  if (!win.crypto || !win.crypto.getRandomValues) {\n    return null;\n  }\n\n  // Widely available in browsers we support:\n  // http://caniuse.com/#search=getRandomValues\n  const uint8array = new Uint8Array(length);\n  win.crypto.getRandomValues(uint8array);\n  return uint8array;\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from '../log';\n\n/** @const {string} */\nconst TAG = 'lru-cache';\n\n/**\n * @template T\n */\nexport class LruCache {\n  /**\n   * @param {number} capacity\n   */\n  constructor(capacity) {\n    /** @private @const {number} */\n    this.capacity_ = capacity;\n\n    /** @private {number} */\n    this.size_ = 0;\n\n    /**\n     * An incrementing counter to define the last access.\n     * @private {number}\n     */\n    this.access_ = 0;\n\n    /** @private {!Object<(number|string), {payload: T, access: number}>} */\n    this.cache_ = Object.create(null);\n  }\n\n  /**\n   * Returns whether key is cached.\n   *\n   * @param {number|string} key\n   * @return {boolean}\n   */\n  has(key) {\n    return !!this.cache_[key];\n  }\n\n  /**\n   * @param {number|string} key\n   * @return {T} The cached payload.\n   */\n  get(key) {\n    const cacheable = this.cache_[key];\n    if (cacheable) {\n      cacheable.access = ++this.access_;\n      return cacheable.payload;\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {number|string} key\n   * @param {T} payload The payload to cache.\n   */\n  put(key, payload) {\n    if (!this.has(key)) {\n      this.size_++;\n    }\n    this.cache_[key] = {payload, access: this.access_};\n    this.evict_();\n  }\n\n  /**\n   * Evicts the oldest cache entry, if we've exceeded capacity.\n   */\n  evict_() {\n    if (this.size_ <= this.capacity_) {\n      return;\n    }\n\n    dev().warn(TAG, 'Trimming LRU cache');\n    const cache = this.cache_;\n    let oldest = this.access_ + 1;\n    let oldestKey;\n    for (const key in cache) {\n      const {access} = cache[key];\n      if (access < oldest) {\n        oldest = access;\n        oldestKey = key;\n      }\n    }\n\n    if (oldestKey !== undefined) {\n      delete cache[oldestKey];\n      this.size_--;\n    }\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {isObject} from '../types';\n\n/* @const */\nconst hasOwn_ = Object.prototype.hasOwnProperty;\n\n/**\n * Returns a map-like object.\n * If opt_initial is provided, copies its own properties into the\n * newly created object.\n * @param {T=} opt_initial This should typically be an object literal.\n * @return {T}\n * @template T\n */\nexport function map(opt_initial) {\n  const obj = Object.create(null);\n  if (opt_initial) {\n    Object.assign(obj, opt_initial);\n  }\n  return obj;\n}\n\n/**\n * Return an empty JsonObject or makes the passed in object literal\n * an JsonObject.\n * The JsonObject type is just a simple object that is at-dict.\n * See\n * https://github.com/google/closure-compiler/wiki/@struct-and-@dict-Annotations\n * for what a dict is type-wise.\n * The linter enforces that the argument is, in fact, at-dict like.\n * @param {!Object=} opt_initial\n * @return {!JsonObject}\n */\nexport function dict(opt_initial) {\n  // We do not copy. The linter enforces that the passed in object is a literal\n  // and thus the caller cannot have a reference to it.\n  return /** @type {!JsonObject} */ (opt_initial || {});\n}\n\n/**\n * Checks if the given key is a property in the map.\n *\n * @param {T}  obj a map like property.\n * @param {string}  key\n * @return {boolean}\n * @template T\n */\nexport function hasOwn(obj, key) {\n  return hasOwn_.call(obj, key);\n}\n\n/**\n * Returns obj[key] iff key is obj's own property (is not inherited).\n * Otherwise, returns undefined.\n *\n * @param {Object} obj\n * @param {string} key\n * @return {*}\n */\nexport function ownProperty(obj, key) {\n  if (hasOwn(obj, key)) {\n    return obj[key];\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Deep merges source into target.\n *\n * @param {!Object} target\n * @param {!Object} source\n * @param {number} depth The maximum merge depth. If exceeded, Object.assign\n *                       will be used instead.\n * @return {!Object}\n * @throws {Error} If source contains a circular reference.\n * Note: Only nested objects are deep-merged, primitives and arrays are not.\n */\nexport function deepMerge(target, source, depth = 10) {\n  // Keep track of seen objects to detect recursive references.\n  const seen = [];\n\n  /** @type {!Array<{t: !Object, s: !Object, d: number}>} */\n  const queue = [];\n  queue.push({t: target, s: source, d: 0});\n\n  // BFS to ensure objects don't have recursive references at shallower depths.\n  while (queue.length > 0) {\n    const {t, s, d} = queue.shift();\n    if (seen.includes(s)) {\n      throw new Error('Source object has a circular reference.');\n    }\n    seen.push(s);\n    if (t === s) {\n      continue;\n    }\n    if (d > depth) {\n      Object.assign(t, s);\n      continue;\n    }\n    Object.keys(s).forEach(key => {\n      const newValue = s[key];\n      // Perform a deep merge IFF both target and source have the same key\n      // whose corresponding values are objects.\n      if (hasOwn(t, key)) {\n        const oldValue = t[key];\n        if (isObject(newValue) && isObject(oldValue)) {\n          queue.push({t: oldValue, s: newValue, d: d + 1});\n          return;\n        }\n      }\n      t[key] = newValue;\n    });\n  }\n  return target;\n}\n\n/**\n * @param {!Object} o An object to remove properties from\n * @param {!Array<string>} props A list of properties to remove from the Object\n * @return {!Object} An object with the given properties removed\n */\nexport function omit(o, props) {\n  return Object.keys(o).reduce((acc, key) => {\n    if (!props.includes(key)) {\n      acc[key] = o[key];\n    }\n    return acc;\n  }, {});\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {base64DecodeToBytes} from './base64';\n\n\n/**\n * Converts a text in PEM format into a binary array buffer.\n * @param {string} pem\n * @return {!Uint8Array}\n * @visibleForTesting\n */\nexport function pemToBytes(pem) {\n  pem = pem.trim();\n\n  // Remove pem prefix, e.g. \"----BEGIN PUBLIC KEY----\".\n  pem = pem.replace(/^\\-+BEGIN[^-]*\\-+/, '');\n\n  // Remove pem suffix, e.g. \"----END PUBLIC KEY----\".\n  pem = pem.replace(/\\-+END[^-]*\\-+$/, '');\n\n  // Remove line breaks.\n  pem = pem.replace(/[\\r\\n]/g, '').trim();\n\n  return base64DecodeToBytes(pem);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns a Deferred struct, which holds a pending promise and its associated\n * resolve and reject functions.\n *\n * This is preferred instead of creating a Promise instance to extract the\n * resolve/reject functions yourself:\n *\n * ```\n * // Avoid doing\n * let resolve;\n * const promise = new Promise(res => {\n *   resolve = res;\n * });\n *\n * // Good\n * const deferred = new Deferred();\n * const { promise, resolve } = deferred;\n * ```\n *\n * @template T\n */\nexport class Deferred {\n  /**\n   * Creates an instance of Deferred.\n   */\n  constructor() {\n    let resolve, reject;\n\n    /**\n     * @const {!Promise<T>}\n     */\n    this.promise = new /*OK*/Promise((res, rej) => {\n      resolve = res;\n      reject = rej;\n    });\n\n    /**\n     * @const {function(T=)}\n     */\n    this.resolve = resolve;\n\n    /**\n     * @const {function(*=)}\n     */\n    this.reject = reject;\n  }\n}\n\n/**\n * Creates a promise resolved to the return value of fn.\n * If fn sync throws, it will cause the promise to reject.\n *\n * @param {function():T} fn\n * @return {!Promise<T>}\n * @template T\n */\nexport function tryResolve(fn) {\n  return new Promise(resolve => {\n    resolve(fn());\n  });\n}\n\n/**\n * Returns a promise which resolves if a threshold amount of the given promises\n * resolve, and rejects otherwise.\n * @param {!Array<!Promise>} promises The array of promises to test.\n * @param {number} count The number of promises that must resolve for the\n *     returned promise to resolve.\n * @return {!Promise} A promise that resolves if any of the given promises\n *     resolve, and which rejects otherwise.\n */\nexport function some(promises, count = 1) {\n  return new Promise((resolve, reject) => {\n    count = Math.max(count, 0);\n    const extra = promises.length - count;\n    if (extra < 0) {\n      reject(new Error('not enough promises to resolve'));\n    }\n    if (promises.length == 0) {\n      resolve([]);\n    }\n    const values = [];\n    const reasons = [];\n\n    const onFulfilled = value => {\n      if (values.length < count) {\n        values.push(value);\n      }\n      if (values.length == count) {\n        resolve(values);\n      }\n    };\n    const onRejected = reason => {\n      if (reasons.length <= extra) {\n        reasons.push(reason);\n      }\n      if (reasons.length > extra) {\n        reject(reasons);\n      }\n    };\n    for (let i = 0; i < promises.length; i++) {\n      Promise.resolve(promises[i]).then(onFulfilled, onRejected);\n    }\n  });\n}\n\n/**\n * Resolves with the result of the last promise added.\n * @implements {IThenable}\n */\nexport class LastAddedResolver {\n  /**\n   * @param {!Array<!Promise>=} opt_promises\n   */\n  constructor(opt_promises) {\n    let resolve_, reject_;\n    /** @private @const {!Promise} */\n    this.promise_ = new Promise((resolve, reject) => {\n      resolve_ = resolve;\n      reject_ = reject;\n    });\n\n    /** @private */\n    this.resolve_ = resolve_;\n\n    /** @private */\n    this.reject_ = reject_;\n\n    /** @private */\n    this.count_ = 0;\n\n    if (opt_promises) {\n      for (let i = 0; i < opt_promises.length; i++) {\n        this.add(opt_promises[i]);\n      }\n    }\n  }\n\n  /**\n   * Add a promise to possibly be resolved.\n   * @param {!Promise} promise\n   * @return {!Promise}\n   */\n  add(promise) {\n    const countAtAdd = ++this.count_;\n    Promise.resolve(promise).then(result => {\n      if (this.count_ === countAtAdd) {\n        this.resolve_(result);\n      }\n    }, error => {\n      // Don't follow behavior of Promise.all and Promise.race error so that\n      // this will only reject when most recently added promise fails.\n      if (this.count_ === countAtAdd) {\n        this.reject_(error);\n      }\n    });\n    return this.promise_;\n  }\n\n  /** @override */\n  then(opt_resolve, opt_reject) {\n    return this.promise_.then(opt_resolve, opt_reject);\n  }\n}\n","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n\n\n/**\n * This regex consists of 4 matching capture groups and one (non-matching) fallback:\n *\n * - (\\0), catch the null terminator character so it may be replaced by UTF\n *   Replacement Char\n * - ^(-)$, catch a solitary dash char, so that it may be backslash escaped.\n *   This is a separate capture group so that the legal-chars (group 4) doesn't\n *   capture it first, since that group doesn't need to escape its dash.\n * - ([\\x01-\\x1f\\x7f]|^-?[0-9]), catch a UTF control char, or any leading\n *   number (with an optional leading dash). The control or the number (but not\n *   the leading dash) must be hex-escaped,.\n * - ([\\x80-\\uffff0-9a-zA-Z_-]+), catch legal-chars, with the exception of a\n *   solitary dash, which will already have matched in group 1.\n * - [^], finally, a catch-all that allows us to backslash escape the char.\n *\n * Together, this matches everything necessary for CSS.escape.\n */\nvar regex = /(\\0)|^(-)$|([\\x01-\\x1f\\x7f]|^-?[0-9])|([\\x80-\\uffff0-9a-zA-Z_-]+)|[^]/g;\n\nfunction escaper(match, nil, dash, hexEscape, chars) {\n  // Chars is the legal-chars (group 4) capture\n  if (chars) {\n    return chars;\n  }\n  // Nil is the null terminator (group 1) capture\n  if (nil) {\n    return '\\uFFFD';\n  }\n  // Both UTF control chars, and leading numbers (with optional leading dash)\n  // (group 3) must be backslash escaped with a trailing space.  Funnily, the\n  // leading dash must not be escaped, but the number. :shrug:\n  if (hexEscape) {\n    return match.slice(0, -1) + '\\\\' + match.slice(-1).charCodeAt(0).toString(16) + ' '\n  }\n  // Finally, the solitary dash and the catch-all chars require backslash\n  // escaping.\n  return '\\\\' + match;\n}\n\n/**\n * https://drafts.csswg.org/cssom/#serialize-an-identifier\n * @param {string} value\n * @return {string}\n */\nexport function cssEscape(value) {\n  return String(value).replace(regex, escaper);\n}\n","/**\n * Copyright 2018 The Subscribe with Google Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/** Version: 0.1.22.23 */\n/**\n * Copyright 2018 The Subscribe with Google Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * @param {!Document} doc\n * @return {string}\n */\nfunction getReadyState(doc) {\n  return /** @type {string} */ (doc['readyState']);\n}\n\n\n/**\n * Whether the document is ready.\n * @param {!Document} doc\n * @return {boolean}\n */\nfunction isDocumentReady(doc) {\n  const readyState = getReadyState(doc);\n  return readyState != 'loading' && readyState != 'uninitialized';\n}\n\n/**\n * Calls the callback when document is ready.\n * @param {!Document} doc\n * @param {function(!Document)} callback\n */\nfunction onDocumentReady(doc, callback) {\n  onDocumentState(doc, isDocumentReady, callback);\n}\n\n/**\n * Calls the callback when document's state satisfies the stateFn.\n * @param {!Document} doc\n * @param {function(!Document):boolean} stateFn\n * @param {function(!Document)} callback\n */\nfunction onDocumentState(doc, stateFn, callback) {\n  let ready = stateFn(doc);\n  if (ready) {\n    callback(doc);\n  } else {\n    const readyListener = () => {\n      if (stateFn(doc)) {\n        if (!ready) {\n          ready = true;\n          callback(doc);\n        }\n        doc.removeEventListener('readystatechange', readyListener);\n      }\n    };\n    doc.addEventListener('readystatechange', readyListener);\n  }\n}\n\n/**\n * Returns a promise that is resolved when document is ready.\n * @param {!Document} doc\n * @return {!Promise<!Document>}\n */\nfunction whenDocumentReady(doc) {\n  return new Promise(resolve => {\n    onDocumentReady(doc, resolve);\n  });\n}\n\n/**\n * Copyright 2018 The Subscribe with Google Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * @interface\n */\nclass Doc {\n\n  /**\n   * @return {!Window}\n   */\n  getWin() {}\n\n  /**\n   * The `Document` node or analog.\n   * @return {!Node}\n   */\n  getRootNode() {}\n\n  /**\n   * The `Document.documentElement` element or analog.\n   * @return {!Element}\n   */\n  getRootElement() {}\n\n  /**\n   * The `Document.head` element or analog. Returns `null` if not available\n   * yet.\n   * @return {!Element}\n   */\n  getHead() {}\n\n  /**\n   * The `Document.body` element or analog. Returns `null` if not available\n   * yet.\n   * @return {?Element}\n   */\n  getBody() {}\n\n  /**\n   * Whether the document has been fully constructed.\n   * @return {boolean}\n   */\n  isReady() {}\n\n  /**\n   * Resolved when document has been fully constructed.\n   * @return {!Promise}\n   */\n  whenReady() {}\n}\n\n\n/** @implements {Doc} */\nclass GlobalDoc {\n\n  /**\n   * @param {!Window|!Document} winOrDoc\n   */\n  constructor(winOrDoc) {\n    const isWin = !!winOrDoc.document;\n    /** @private @const {!Window} */\n    this.win_ = isWin ?\n        /** @type {!Window} */ (winOrDoc) :\n        /** @type {!Window} */ (\n            (/** @type {!Document} */ (winOrDoc)).defaultView);\n    /** @private @const {!Document} */\n    this.doc_ = isWin ?\n        /** @type {!Window} */ (winOrDoc).document :\n        /** @type {!Document} */ (winOrDoc);\n  }\n\n  /** @override */\n  getWin() {\n    return this.win_;\n  }\n\n  /** @override */\n  getRootNode() {\n    return this.doc_;\n  }\n\n  /** @override */\n  getRootElement() {\n    return this.doc_.documentElement;\n  }\n\n  /** @override */\n  getHead() {\n    // `document.head` always has a chance to be parsed, at least partially.\n    return /** @type {!Element} */ (this.doc_.head);\n  }\n\n  /** @override */\n  getBody() {\n    return this.doc_.body;\n  }\n\n  /** @override */\n  isReady() {\n    return isDocumentReady(this.doc_);\n  }\n\n  /** @override */\n  whenReady() {\n    return whenDocumentReady(this.doc_);\n  }\n}\n\n\n/**\n * @param {!Document|!Window|!Doc} input\n * @return {!Doc}\n */\nfunction resolveDoc(input) {\n  // Is it a `Document`\n  if ((/** @type {!Document} */ (input)).nodeType === /* DOCUMENT */ 9) {\n    return new GlobalDoc(/** @type {!Document} */ (input));\n  }\n  // Is it a `Window`?\n  if ((/** @type {!Window} */ (input)).document) {\n    return new GlobalDoc(/** @type {!Window} */ (input));\n  }\n  return /** @type {!Doc} */ (input);\n}\n\n/**\n * Copyright 2018 The Subscribe with Google Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n */\nclass PageConfig {\n\n  /**\n   * @param {string} productOrPublicationId\n   * @param {boolean} locked\n   */\n  constructor(productOrPublicationId, locked) {\n    let publicationId, productId, label;\n    const div = productOrPublicationId.indexOf(':');\n    if (div != -1) {\n      // The argument is a product id.\n      productId = productOrPublicationId;\n      publicationId = productId.substring(0, div);\n      label = productId.substring(div + 1);\n    } else {\n      // The argument is a publication id.\n      publicationId = productOrPublicationId;\n      productId = null;\n      label = null;\n    }\n\n    /** @private @const {string} */\n    this.publicationId_ = publicationId;\n    /** @private @const {?string} */\n    this.productId_ = productId;\n    /** @private @const {?string} */\n    this.label_ = label;\n    /** @private @const {boolean} */\n    this.locked_ = locked;\n  }\n\n  /**\n   * @return {string}\n   */\n  getPublicationId() {\n    return this.publicationId_;\n  }\n\n  /**\n   * @return {?string}\n   */\n  getProductId() {\n    return this.productId_;\n  }\n\n  /**\n   * @return {?string}\n   */\n  getLabel() {\n    return this.label_;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  isLocked() {\n    return this.locked_;\n  }\n}\n\n/**\n * Copyright 2018 The Subscribe with Google Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Copyright 2018 The Subscribe with Google Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Copyright 2018 The Subscribe with Google Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Copyright 2018 The Subscribe with Google Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Copyright 2018 The Subscribe with Google Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Whether the element have a next node in the document order.\n * This means either:\n *  a. The element itself has a nextSibling.\n *  b. Any of the element ancestors has a nextSibling.\n * @param {!Element} element\n * @param {?Node=} opt_stopNode\n * @return {boolean}\n */\nfunction hasNextNodeInDocumentOrder(element, opt_stopNode) {\n  let currentElement = element;\n  do {\n    if (currentElement.nextSibling) {\n      return true;\n    }\n  } while ((currentElement = currentElement.parentNode) &&\n            currentElement != opt_stopNode);\n  return false;\n}\n\n/**\n * Copyright 2018 The Subscribe with Google Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Determines if value is actually an Array.\n * @param {*} value\n * @return {boolean}\n */\nfunction isArray(value) {\n  return Array.isArray(value);\n}\n\n/**\n * Copyright 2018 The Subscribe with Google Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Simple wrapper around JSON.parse that casts the return value\n * to JsonObject.\n * Create a new wrapper if an array return value is desired.\n * @param {*} json JSON string to parse\n * @return {?JsonObject|undefined} May be extend to parse arrays.\n */\nfunction parseJson(json) {\n  return /** @type {?JsonObject} */(JSON.parse(/** @type {string} */ (json)));\n}\n\n/**\n * Parses the given `json` string without throwing an exception if not valid.\n * Returns `undefined` if parsing fails.\n * Returns the `Object` corresponding to the JSON string when parsing succeeds.\n * @param {*} json JSON string to parse\n * @param {function(!Error)=} opt_onFailed Optional function that will be called\n *     with the error if parsing fails.\n * @return {?JsonObject|undefined} May be extend to parse arrays.\n */\nfunction tryParseJson(json, opt_onFailed) {\n  try {\n    return parseJson(json);\n  } catch (e) {\n    if (opt_onFailed) {\n      opt_onFailed(e);\n    }\n    return undefined;\n  }\n}\n\n/**\n * Copyright 2018 The Subscribe with Google Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst ALREADY_SEEN = '__SWG-SEEN__';\n\n\n/**\n */\nclass PageConfigResolver {\n\n  /**\n   * @param {!Window|!Document|!Doc} winOrDoc\n   */\n  constructor(winOrDoc) {\n    /** @private @const {!Doc} */\n    this.doc_ = resolveDoc(winOrDoc);\n\n    /** @private {?function((!PageConfig|!Promise))} */\n    this.configResolver_ = null;\n\n    /** @private @const {!Promise<!PageConfig>} */\n    this.configPromise_ = new Promise(resolve => {\n      this.configResolver_ = resolve;\n    });\n\n    /** @private @const {!MetaParser} */\n    this.metaParser_ = new MetaParser(this.doc_);\n    /** @private @const {!JsonLdParser} */\n    this.ldParser_ = new JsonLdParser(this.doc_);\n    /** @private @const {!MicrodataParser} */\n    this.microdataParser_ = new MicrodataParser(this.doc_);\n  }\n\n  /**\n   * @return {!Promise<!PageConfig>}\n   */\n  resolveConfig() {\n    // Try resolve the config at different times.\n    Promise.resolve().then(this.check.bind(this));\n    this.doc_.whenReady().then(this.check.bind(this));\n    return this.configPromise_;\n  }\n\n  /**\n   * @return {?PageConfig}\n   */\n  check() {\n    // Already resolved.\n    if (!this.configResolver_) {\n      return null;\n    }\n    let config = this.metaParser_.check();\n    if (!config) {\n      config = this.ldParser_.check();\n    }\n    if (!config) {\n      config = this.microdataParser_.check();\n    }\n    if (config) {\n      // Product ID has been found: initialize the rest of the config.\n      this.configResolver_(config);\n      this.configResolver_ = null;\n    } else if (this.doc_.isReady()) {\n      this.configResolver_(Promise.reject(\n          new Error('No config could be discovered in the page')));\n      this.configResolver_ = null;\n    }\n    return config;\n  }\n}\n\n\nclass MetaParser {\n  /**\n   * @param {!Doc} doc\n   */\n  constructor(doc) {\n    /** @private @const {!Doc} */\n    this.doc_ = doc;\n  }\n\n  /**\n   * @return {?PageConfig}\n   */\n  check() {\n    if (!this.doc_.getBody()) {\n      // Wait until the whole `<head>` is parsed.\n      return null;\n    }\n\n    // Try to find product id.\n    const productId = getMetaTag(this.doc_.getRootNode(),\n        'subscriptions-product-id');\n    if (!productId) {\n      return null;\n    }\n\n    // Is locked?\n    const accessibleForFree = getMetaTag(this.doc_.getRootNode(),\n        'subscriptions-accessible-for-free');\n    const locked = (accessibleForFree &&\n        accessibleForFree.toLowerCase() == 'false') || false;\n\n    return new PageConfig(productId, locked);\n  }\n}\n\n\nclass JsonLdParser {\n  /**\n   * @param {!Doc} doc\n   */\n  constructor(doc) {\n    /** @private @const {!Doc} */\n    this.doc_ = doc;\n  }\n\n  /**\n   * @return {?PageConfig}\n   */\n  check() {\n    if (!this.doc_.getBody()) {\n      // Wait until the whole `<head>` is parsed.\n      return null;\n    }\n\n    const domReady = this.doc_.isReady();\n\n    // type: 'application/ld+json'\n    const elements = this.doc_.getRootNode().querySelectorAll(\n        'script[type=\"application/ld+json\"]');\n    for (let i = 0; i < elements.length; i++) {\n      const element = elements[i];\n      if (element[ALREADY_SEEN] ||\n          !element.textContent ||\n          !domReady && !hasNextNodeInDocumentOrder(element)) {\n        continue;\n      }\n      element[ALREADY_SEEN] = true;\n      if (element.textContent.indexOf('NewsArticle') == -1) {\n        continue;\n      }\n      const possibleConfig = this.tryExtractConfig_(element);\n      if (possibleConfig) {\n        return possibleConfig;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * @param {!Element} element\n   * @return {?PageConfig}\n   */\n  tryExtractConfig_(element) {\n    const json = tryParseJson(element.textContent);\n    if (!json) {\n      return null;\n    }\n\n    // Must be a NewsArticle.\n    if (!this.checkType_(json, 'NewsArticle')) {\n      return null;\n    }\n\n    // Must have a isPartOf[@type=Product].\n    let productId = null;\n    const partOfArray = this.valueArray_(json, 'isPartOf');\n    if (partOfArray) {\n      for (let i = 0; i < partOfArray.length; i++) {\n        productId = this.discoverProductId_(partOfArray[i]);\n        if (productId) {\n          break;\n        }\n      }\n    }\n    if (!productId) {\n      return null;\n    }\n\n    // Found product id, just check for the access flag.\n    const isAccessibleForFree = this.bool_(\n        this.singleValue_(json, 'isAccessibleForFree'),\n        /* default */ true);\n\n    return new PageConfig(productId, !isAccessibleForFree);\n  }\n\n  /**\n   * @param {*} value\n   * @param {boolean} def\n   * @return {boolean}\n   */\n  bool_(value, def) {\n    if (value == null || value === '') {\n      return def;\n    }\n    if (typeof value == 'boolean') {\n      return value;\n    }\n    if (typeof value == 'string') {\n      const lowercase = value.toLowerCase();\n      if (lowercase == 'false') {\n        return false;\n      }\n      if (lowercase == 'true') {\n        return true;\n      }\n    }\n    return def;\n  }\n\n  /**\n   * @param {!Object} json\n   * @return {?string}\n   */\n  discoverProductId_(json) {\n    // Must have type `Product`.\n    if (!this.checkType_(json, 'Product')) {\n      return null;\n    }\n    return /** @type {?string} */ (this.singleValue_(json, 'productID'));\n  }\n\n  /**\n   * @param {!Object} json\n   * @param {string} name\n   * @return {?Array}\n   */\n  valueArray_(json, name) {\n    const value = json[name];\n    if (value == null || value === '') {\n      return null;\n    }\n    return isArray(value) ? value : [value];\n  }\n\n  /**\n   * @param {!Object} json\n   * @param {string} name\n   * @return {*}\n   */\n  singleValue_(json, name) {\n    const valueArray = this.valueArray_(json, name);\n    const value = valueArray && valueArray[0];\n    return (value == null || value === '') ? null : value;\n  }\n\n  /**\n   * @param {!Object} json\n   * @param {string} expectedType\n   * @return {boolean}\n   */\n  checkType_(json, expectedType) {\n    const typeArray = this.valueArray_(json, '@type');\n    if (!typeArray) {\n      return false;\n    }\n    return (typeArray.includes(expectedType) ||\n        typeArray.includes('http://schema.org/' + expectedType));\n  }\n}\n\nclass MicrodataParser {\n  /**\n   * @param {!Doc} doc\n   */\n  constructor(doc) {\n    /** @private @const {!Doc} */\n    this.doc_ = doc;\n    /** @private {?boolean} */\n    this.access_ = null;\n    /** @private {?string} */\n    this.productId_ = null;\n  }\n\n  /**\n   * Returns false if access is restricted, otherwise true\n   * @param {!Element} root An element that is an item of type 'NewsArticle'\n   * @return {?boolean} locked access\n   * @private\n   */\n  discoverAccess_(root) {\n    const ALREADY_SEEN = 'alreadySeenForAccessInfo';\n    const nodeList = root\n        .querySelectorAll(\"[itemprop='isAccessibleForFree']\");\n    for (let i = 0; nodeList[i]; i++) {\n      const element = nodeList[i];\n      const content = element.getAttribute('content') || element.textContent;\n      if (!content) {\n        continue;\n      }\n      if (this.isValidElement_(element, root, ALREADY_SEEN)) {\n        let accessForFree = null;\n        if (content.toLowerCase() == 'true') {\n          accessForFree = true;\n        } else if (content.toLowerCase() == 'false') {\n          accessForFree = false;\n        }\n        return accessForFree;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Verifies if an element is valid based on the following\n   * - child of an item of type 'NewsArticle'\n   * - not a child of an item of any other type\n   * - not seen before, marked using the alreadySeen tag\n   * @param {?Element} current the element to be verified\n   * @param {!Element} root the parent to track up to\n   * @param {!string} alreadySeen used to tag already visited nodes\n   * @return {!boolean} valid node\n   * @private\n   */\n  isValidElement_(current, root, alreadySeen) {\n    for (let node = current;\n        node && !node[alreadySeen]; node = node.parentNode) {\n      node[alreadySeen] = true;\n      if (node.hasAttribute('itemscope')) {\n        /**{?string} */\n        const type = node.getAttribute('itemtype');\n        if (type.indexOf('http://schema.org/NewsArticle') >= 0) {\n          return true;\n        } else {\n          return false;\n        }\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Obtains the product ID that meets the requirements\n   * - child of an item of type 'NewsArticle'\n   * - Not a child of an item of type 'Section'\n   * - child of an item of type 'productID'\n   * @param {!Element} root An element that is an item of type 'NewsArticle'\n   * @return {?string} product ID, if found\n   * @private\n   */\n  discoverProductId_(root) {\n    const ALREADY_SEEN = 'alreadySeenForProductInfo';\n    const nodeList = root\n        .querySelectorAll('[itemprop=\"productID\"]');\n    for (let i = 0; nodeList[i]; i++) {\n      const element = nodeList[i];\n      const content = element.getAttribute('content') || element.textContent;\n      const item = element.closest('[itemtype][itemscope]');\n      const type = item.getAttribute('itemtype');\n      if (type.indexOf('http://schema.org/Product') <= -1) {\n        continue;\n      }\n      if (this.isValidElement_(item.parentElement, root, ALREADY_SEEN)) {\n        return content;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Returns PageConfig if available\n   * @return {?PageConfig} PageConfig found so far\n   */\n  getPageConfig_() {\n    let locked = null;\n    if (this.access_ != null) {\n      locked = !this.access_;\n    } else if (this.doc_.isReady()) {\n      // Default to unlocked\n      locked = false;\n    }\n    if (this.productId_ != null && locked != null) {\n      return new PageConfig(this.productId_, locked);\n    }\n    return null;\n  }\n\n  /**\n   * Extracts page config from Microdata in the DOM\n   * @return {?PageConfig} PageConfig found\n   */\n  tryExtractConfig_() {\n    let config = this.getPageConfig_();\n    if (config) {\n      return config;\n    }\n    const nodeList = this.doc_.getRootNode().querySelectorAll(\n        '[itemscope][itemtype*=\"http://schema.org/NewsArticle\"]');\n    for (let i = 0; nodeList[i] && config == null; i++) {\n      const element = nodeList[i];\n      if (this.access_ == null) {\n        this.access_ = this.discoverAccess_(element);\n      }\n      if (!this.productId_) {\n        this.productId_ = this.discoverProductId_(element);\n      }\n      config = this.getPageConfig_();\n    }\n    return config;\n  }\n\n  /**\n   * @return {?PageConfig}\n   */\n  check() {\n    if (!this.doc_.getBody()) {\n      // Wait until the whole `<head>` is parsed.\n      return null;\n    }\n    return this.tryExtractConfig_();\n  }\n}\n\n/**\n * Returns the value from content attribute of a meta tag with given name.\n *\n * If multiple tags are found, the first value is returned.\n *\n * @param {!Node} rootNode\n * @param {string} name The tag name to look for.\n * @return {?string} attribute value or empty string.\n * @private\n */\nfunction getMetaTag(rootNode, name) {\n  const el = rootNode.querySelector(`meta[name=\"${name}\"]`);\n  if (el) {\n    return el.getAttribute('content');\n  }\n  return null;\n}\n\n/**\n * Copyright 2018 The Subscribe with Google Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nexport {\n  Doc,\n  PageConfig,\n  PageConfigResolver,\n};\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJidWlsZC9hbXAtc3Vic2NyaXB0aW9ucy0wLjEuY3NzLmpzIiwiZXh0ZW5zaW9ucy9hbXAtYWNjZXNzLzAuMS9hY2Nlc3MtZXhwci1pbXBsLmpzIiwiZXh0ZW5zaW9ucy9hbXAtYWNjZXNzLzAuMS9hY2Nlc3MtZXhwci5qcyIsImV4dGVuc2lvbnMvYW1wLWFjY2Vzcy8wLjEvand0LmpzIiwiZXh0ZW5zaW9ucy9hbXAtYWNjZXNzLzAuMS9sb2dpbi1kaWFsb2cuanMiLCJleHRlbnNpb25zL2FtcC1zdWJzY3JpcHRpb25zLzAuMS9hY3Rpb25zLmpzIiwiZXh0ZW5zaW9ucy9hbXAtc3Vic2NyaXB0aW9ucy8wLjEvYW1wLXN1YnNjcmlwdGlvbnMuanMiLCJleHRlbnNpb25zL2FtcC1zdWJzY3JpcHRpb25zLzAuMS9hbmFseXRpY3MuanMiLCJleHRlbnNpb25zL2FtcC1zdWJzY3JpcHRpb25zLzAuMS9kaWFsb2cuanMiLCJleHRlbnNpb25zL2FtcC1zdWJzY3JpcHRpb25zLzAuMS9kb2MtaW1wbC5qcyIsImV4dGVuc2lvbnMvYW1wLXN1YnNjcmlwdGlvbnMvMC4xL2VudGl0bGVtZW50LmpzIiwiZXh0ZW5zaW9ucy9hbXAtc3Vic2NyaXB0aW9ucy8wLjEvZXhwci5qcyIsImV4dGVuc2lvbnMvYW1wLXN1YnNjcmlwdGlvbnMvMC4xL2xvY2FsLXN1YnNjcmlwdGlvbi1wbGF0Zm9ybS1yZW5kZXJlci5qcyIsImV4dGVuc2lvbnMvYW1wLXN1YnNjcmlwdGlvbnMvMC4xL2xvY2FsLXN1YnNjcmlwdGlvbi1wbGF0Zm9ybS5qcyIsImV4dGVuc2lvbnMvYW1wLXN1YnNjcmlwdGlvbnMvMC4xL3BsYXRmb3JtLXN0b3JlLmpzIiwiZXh0ZW5zaW9ucy9hbXAtc3Vic2NyaXB0aW9ucy8wLjEvcmVuZGVyZXIuanMiLCJleHRlbnNpb25zL2FtcC1zdWJzY3JpcHRpb25zLzAuMS9zZXJ2aWNlLWFkYXB0ZXIuanMiLCJleHRlbnNpb25zL2FtcC1zdWJzY3JpcHRpb25zLzAuMS9zdWJzY3JpcHRpb24tcGxhdGZvcm0uanMiLCJleHRlbnNpb25zL2FtcC1zdWJzY3JpcHRpb25zLzAuMS91cmwtYnVpbGRlci5qcyIsImV4dGVuc2lvbnMvYW1wLXN1YnNjcmlwdGlvbnMvMC4xL3ZpZXdlci1zdWJzY3JpcHRpb24tcGxhdGZvcm0uanMiLCJleHRlbnNpb25zL2FtcC1zdWJzY3JpcHRpb25zLzAuMS92aWV3ZXItdHJhY2tlci5qcyIsIm5vZGVfbW9kdWxlcy9kb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50L2J1aWxkL2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQucGF0Y2hlZC5qcyIsIm5vZGVfbW9kdWxlcy9wcm9taXNlLXBqcy9wcm9taXNlLmpzIiwic3JjL2FtcC1ldmVudHMuanMiLCJzcmMvYW5hbHl0aWNzLmpzIiwic3JjL2NvbmZpZy5qcyIsInNyYy9jb29raWVzLmpzIiwic3JjL2RvbS5qcyIsInNyYy9lbGVtZW50LXNlcnZpY2UuanMiLCJzcmMvZXJyb3IuanMiLCJzcmMvZXZlbnQtaGVscGVyLWxpc3Rlbi5qcyIsInNyYy9ldmVudC1oZWxwZXIuanMiLCJzcmMvZXhwZXJpbWVudHMuanMiLCJzcmMvZXhwb25lbnRpYWwtYmFja29mZi5qcyIsInNyYy9qc29uLmpzIiwic3JjL2xvZy5qcyIsInNyYy9tb2RlLW9iamVjdC5qcyIsInNyYy9tb2RlLmpzIiwic3JjL29ic2VydmFibGUuanMiLCJzcmMvcG9seWZpbGxzLmpzIiwic3JjL3BvbHlmaWxscy9hcnJheS1pbmNsdWRlcy5qcyIsInNyYy9wb2x5ZmlsbHMvY3VzdG9tLWVsZW1lbnRzLmpzIiwic3JjL3BvbHlmaWxscy9kb2N1bWVudC1jb250YWlucy5qcyIsInNyYy9wb2x5ZmlsbHMvZG9tdG9rZW5saXN0LXRvZ2dsZS5qcyIsInNyYy9wb2x5ZmlsbHMvbWF0aC1zaWduLmpzIiwic3JjL3BvbHlmaWxscy9vYmplY3QtYXNzaWduLmpzIiwic3JjL3BvbHlmaWxscy9wcm9taXNlLmpzIiwic3JjL3JlbmRlci1kZWxheWluZy1zZXJ2aWNlcy5qcyIsInNyYy9zZXJ2aWNlLmpzIiwic3JjL3NlcnZpY2VzLmpzIiwic3JjL3N0cmluZy5qcyIsInNyYy9zdHlsZS1pbnN0YWxsZXIuanMiLCJzcmMvc3R5bGUuanMiLCJzcmMvdHlwZXMuanMiLCJzcmMvdXJsLXBhcnNlLXF1ZXJ5LXN0cmluZy5qcyIsInNyYy91cmwtdHJ5LWRlY29kZS11cmktY29tcG9uZW50LmpzIiwic3JjL3VybC5qcyIsInNyYy91dGlscy9iYXNlNjQuanMiLCJzcmMvdXRpbHMvYnl0ZXMuanMiLCJzcmMvdXRpbHMvbHJ1LWNhY2hlLmpzIiwic3JjL3V0aWxzL29iamVjdC5qcyIsInNyYy91dGlscy9wZW0uanMiLCJzcmMvdXRpbHMvcHJvbWlzZS5qcyIsInRoaXJkX3BhcnR5L2Nzcy1lc2NhcGUvY3NzLWVzY2FwZS5qcyIsInRoaXJkX3BhcnR5L3N1YnNjcmlwdGlvbnMtcHJvamVjdC9jb25maWcuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7QUNBTyxJQUFNLG9CQUFNLG14RkFBWjs7Ozs7Ozs7O0FDQVA7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpQkE7O0FBRUE7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBd0VBLElBQUksU0FBVSxZQUFVO0FBQ3hCLFFBQUksSUFBRSxXQUFTLENBQVQsRUFBVyxDQUFYLEVBQWEsRUFBYixFQUFlLENBQWYsRUFBaUI7QUFBQyxhQUFJLEtBQUUsTUFBRyxFQUFMLEVBQVEsSUFBRSxFQUFFLE1BQWhCLEVBQXVCLEdBQXZCLEVBQTJCLEdBQUUsRUFBRSxDQUFGLENBQUYsSUFBUSxDQUFuQyxJQUFzQyxPQUFPLEVBQVA7QUFBUyxLQUF2RTtBQUFBLFFBQXdFLE1BQUksQ0FBQyxDQUFELEVBQUcsQ0FBSCxDQUE1RTtBQUFBLFFBQWtGLE1BQUksQ0FBQyxDQUFELEVB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ242Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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ZUFBSyxVQUFMLEdBQWtCLEtBQUssa0JBQUwsQ0FBd0IsT0FBeEIsQ0FBbEI7QUFDRDtBQUNELGlCQUFTLEtBQUssY0FBTCxFQUFUO0FBQ0Q7QUFDRCxhQUFPLE1BQVA7QUFDRDs7QUFFRDs7Ozs7OzRCQUdRO0FBQ04sVUFBSSxDQUFDLEtBQUssSUFBTCxDQUFVLE9BQVYsRUFBTCxFQUEwQjtBQUN4QjtBQUNBLGVBQU8sSUFBUDtBQUNEO0FBQ0QsYUFBTyxLQUFLLGlCQUFMLEVBQVA7QUFDRDs7Ozs7O0FBR0g7Ozs7Ozs7Ozs7OztBQVVBLFNBQVMsVUFBVCxDQUFvQixRQUFwQixFQUE4QixJQUE5QixFQUFvQztBQUNsQyxNQUFNLEtBQUssU0FBUyxhQUFULGlCQUFxQyxJQUFyQyxRQUFYO0FBQ0EsTUFBSSxFQUFKLEVBQVE7QUFDTixXQUFPLEdBQUcsWUFBSCxDQUFnQixTQUFoQixDQUFQO0FBQ0Q7QUFDRCxTQUFPLElBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7Ozs7Ozs7OztRQWtCRSxHLEdBQUEsRztRQUNBLFUsR0FBQSxVO1FBQ0Esa0IsR0FBQSxrQiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJleHBvcnQgY29uc3QgQ1NTID0gXCJib2R5Om5vdCguaS1hbXBodG1sLXN1YnMtbG9hZGluZykgW3N1YnNjcmlwdGlvbnMtc2VjdGlvbj1sb2FkaW5nXXtkaXNwbGF5Om5vbmUhaW1wb3J0YW50fWJvZHk6bm90KC5pLWFtcGh0bWwtc3Vicy1ncmFudC15ZXMpIFtzdWJzY3JpcHRpb25zLXNlY3Rpb249Y29udGVudF17ZGlzcGxheTpub25lIWltcG9ydGFudH1ib2R5Om5vdCguaS1hbXBodG1sLXN1YnMtZ3JhbnQtbm8pIFtzdWJzY3JpcHRpb25zLXNlY3Rpb249Y29udGVudC1ub3QtZ3JhbnRlZF17ZGlzcGxheTpub25lIWltcG9ydGFudH1ib2R5LmktYW1waHRtbC1zdWJzLWRlbGVnYXRlZCBbc3Vic2NyaXB0aW9ucy1zZWN0aW9uPWFjdGlvbnNdLGJvZHkuaS1hbXBodG1sLXN1YnMtZ3JhbnQtdW5rIFtzdWJzY3JpcHRpb25zLXNlY3Rpb249YWN0aW9uc117ZGlzcGxheTpub25lIWltcG9ydGFudH1ib2R5LmktYW1waHRtbC1zdWJzLWdyYW50LXVuayBbc3Vic2NyaXB0aW9ucy1hY3Rpb25de2Rpc3BsYXk6bm9uZSFpbXBvcnRhbnR9W3N1YnNjcmlwdGlvbnMtYWN0aW9uXTpub3QoLmktYW1waHRtbC1zdWJzLWRpc3BsYXkpLFtzdWJzY3JpcHRpb25zLWFjdGlvbnNdOm5vdCguaS1hbXBodG1sLXN1YnMtZGlzcGxheSksW3N1YnNjcmlwdGlvbnMtc2VjdGlvbj1hY3Rpb25zXTpub3QoLmktYW1waHRtbC1zdWJzLWRpc3BsYXkpe2Rpc3BsYXk6bm9uZSFpbXBvcnRhbnR9YW1wLXN1YnNjcmlwdGlvbnMtZGlhbG9ne2Rpc3BsYXk6YmxvY2shaW1wb3J0YW50O3Bvc2l0aW9uOmZpeGVkIWltcG9ydGFudDtib3R0b206MCFpbXBvcnRhbnQ7bGVmdDowIWltcG9ydGFudDttYXJnaW4tbGVmdDowIWltcG9ydGFudDt3aWR0aDoxMDAlIWltcG9ydGFudDt6LWluZGV4OjIxNDc0ODM2NDE7bWF4LWhlaWdodDo5MHZoO2JveC1zaXppbmc6Ym9yZGVyLWJveDtvcGFjaXR5OjE7YmFja2dyb3VuZC1pbWFnZTpub25lO2JhY2tncm91bmQtY29sb3I6I2ZmZjtib3gtc2hhZG93OjAgMCA1cHggMCByZ2JhKDAsMCwwLDAuMik7bWFyZ2luLWJvdHRvbTowOy13ZWJraXQtdHJhbnNpdGlvbjotd2Via2l0LXRyYW5zZm9ybSAwLjNzIGVhc2UtaW47dHJhbnNpdGlvbjotd2Via2l0LXRyYW5zZm9ybSAwLjNzIGVhc2UtaW47dHJhbnNpdGlvbjp0cmFuc2Zvcm0gMC4zcyBlYXNlLWluO3RyYW5zaXRpb246dHJhbnNmb3JtIDAuM3MgZWFzZS1pbiwtd2Via2l0LXRyYW5zZm9ybSAwLjNzIGVhc2UtaW59LmktYW1waHRtbC1zdWJzLWRpYWxvZy1jbG9zZS1idXR0b257cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MjhweDtoZWlnaHQ6MjhweDt0b3A6LTI4cHg7cmlnaHQ6MDtiYWNrZ3JvdW5kLWltYWdlOnVybChcXFwiZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgsJTNDc3ZnIHdpZHRoPScxMycgaGVpZ2h0PScxMycgdmlld0JveD0nMzQxIDggMTMgMTMnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyclM0UlM0NwYXRoIGZpbGw9JyUyMzRGNEY0RicgZD0nTTM1NCA5LjMxTDM1Mi42OSA4bC01LjE5IDUuMTlMMzQyLjMxIDggMzQxIDkuMzFsNS4xOSA1LjE5LTUuMTkgNS4xOSAxLjMxIDEuMzEgNS4xOS01LjE5IDUuMTkgNS4xOSAxLjMxLTEuMzEtNS4xOS01LjE5eicgZmlsbC1ydWxlPSdldmVub2RkJy8lM0UlM0Mvc3ZnJTNFXFxcIik7YmFja2dyb3VuZC1zaXplOjEzcHggMTNweDtiYWNrZ3JvdW5kLXBvc2l0aW9uOjlweDtiYWNrZ3JvdW5kLWNvbG9yOiNmZmY7YmFja2dyb3VuZC1yZXBlYXQ6bm8tcmVwZWF0O2JveC1zaGFkb3c6MCAtMXB4IDFweCAwIHJnYmEoMCwwLDAsMC4yKTtib3JkZXI6bm9uZTtib3JkZXItcmFkaXVzOjEycHggMCAwIDA7Y3Vyc29yOnBvaW50ZXJ9Ym9keTpub3QoLmktYW1waHRtbC1zdWJzLWdyYW50LXllcykgLmktYW1waHRtbC1zdWJzLWRpYWxvZy1jbG9zZS1idXR0b257ZGlzcGxheTpub25lfS5pLWFtcGh0bWwtc3Vicy1wcm9ncmVzc3toZWlnaHQ6MnB4O2JhY2tncm91bmQtY29sb3I6I2NjYztwb3NpdGlvbjpyZWxhdGl2ZTttYXJnaW46OHB4O292ZXJmbG93OmhpZGRlbn0uaS1hbXBodG1sLXN1YnMtcHJvZ3Jlc3M6YWZ0ZXJ7Y29udGVudDpcXFwiXFxcIjtiYWNrZ3JvdW5kLWNvbG9yOiMyMTk2ZjM7aGVpZ2h0OjJweDtwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7dG9wOjA7d2lkdGg6MjAlOy13ZWJraXQtYW5pbWF0aW9uOmktYW1waHRtbC1zdWJzLWxvYWRpbmctcHJvZ3Jlc3MgMTUwMG1zIGVhc2UtaW4tb3V0IGluZmluaXRlO2FuaW1hdGlvbjppLWFtcGh0bWwtc3Vicy1sb2FkaW5nLXByb2dyZXNzIDE1MDBtcyBlYXNlLWluLW91dCBpbmZpbml0ZX1ALXdlYmtpdC1rZXlmcmFtZXMgaS1hbXBodG1sLXN1YnMtbG9hZGluZy1wcm9ncmVzc3swJXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMDAlKTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtMTAwJSl9dG97LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCg1MDAlKTt0cmFuc2Zvcm06dHJhbnNsYXRlWCg1MDAlKX19QGtleWZyYW1lcyBpLWFtcGh0bWwtc3Vicy1sb2FkaW5nLXByb2dyZXNzezAley13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTEwMCUpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMDAlKX10b3std2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDUwMCUpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKDUwMCUpfX1AbWVkaWEgKG1pbi13aWR0aDo0ODBweCl7YW1wLXN1YnNjcmlwdGlvbnMtZGlhbG9ne3dpZHRoOjQ4MHB4IWltcG9ydGFudDtsZWZ0Oi0yNDBweCFpbXBvcnRhbnQ7bWFyZ2luLWxlZnQ6NTB2dyFpbXBvcnRhbnR9fVxcbi8qIyBzb3VyY2VVUkw9L2V4dGVuc2lvbnMvYW1wLXN1YnNjcmlwdGlvbnMvMC4xL2FtcC1zdWJzY3JpcHRpb25zLmNzcyovXCI7XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG4vKiogQGZpbGVvdmVydmlldyBAc3VwcHJlc3Mge2NoZWNrVHlwZXMsIHN1c3BpY2lvdXNDb2RlLCB1c2VsZXNzQ29kZX0gKi9cblxuLyogcGFyc2VyIGdlbmVyYXRlZCBieSBqaXNvbiAwLjQuMTggKi9cbi8qXG4gIFJldHVybnMgYSBQYXJzZXIgb2JqZWN0IG9mIHRoZSBmb2xsb3dpbmcgc3RydWN0dXJlOlxuXG4gIFBhcnNlcjoge1xuICAgIHl5OiB7fVxuICB9XG5cbiAgUGFyc2VyLnByb3RvdHlwZToge1xuICAgIHl5OiB7fSxcbiAgICB0cmFjZTogZnVuY3Rpb24oKSxcbiAgICBzeW1ib2xzXzoge2Fzc29jaWF0aXZlIGxpc3Q6IG5hbWUgPT0+IG51bWJlcn0sXG4gICAgdGVybWluYWxzXzoge2Fzc29jaWF0aXZlIGxpc3Q6IG51bWJlciA9PT4gbmFtZX0sXG4gICAgcHJvZHVjdGlvbnNfOiBbLi4uXSxcbiAgICBwZXJmb3JtQWN0aW9uOiBmdW5jdGlvbiBhbm9ueW1vdXMoeXl0ZXh0LCB5eWxlbmcsIHl5bGluZW5vLCB5eSwgeXlzdGF0ZSwgJCQsIF8kKSxcbiAgICB0YWJsZTogWy4uLl0sXG4gICAgZGVmYXVsdEFjdGlvbnM6IHsuLi59LFxuICAgIHBhcnNlRXJyb3I6IGZ1bmN0aW9uKHN0ciwgaGFzaCksXG4gICAgcGFyc2U6IGZ1bmN0aW9uKGlucHV0KSxcblxuICAgIGxleGVyOiB7XG4gICAgICAgIEVPRjogMSxcbiAgICAgICAgcGFyc2VFcnJvcjogZnVuY3Rpb24oc3RyLCBoYXNoKSxcbiAgICAgICAgc2V0SW5wdXQ6IGZ1bmN0aW9uKGlucHV0KSxcbiAgICAgICAgaW5wdXQ6IGZ1bmN0aW9uKCksXG4gICAgICAgIHVucHV0OiBmdW5jdGlvbihzdHIpLFxuICAgICAgICBtb3JlOiBmdW5jdGlvbigpLFxuICAgICAgICBsZXNzOiBmdW5jdGlvbihuKSxcbiAgICAgICAgcGFzdElucHV0OiBmdW5jdGlvbigpLFxuICAgICAgICB1cGNvbWluZ0lucHV0OiBmdW5jdGlvbigpLFxuICAgICAgICBzaG93UG9zaXRpb246IGZ1bmN0aW9uKCksXG4gICAgICAgIHRlc3RfbWF0Y2g6IGZ1bmN0aW9uKHJlZ2V4X21hdGNoX2FycmF5LCBydWxlX2luZGV4KSxcbiAgICAgICAgbmV4dDogZnVuY3Rpb24oKSxcbiAgICAgICAgbGV4OiBmdW5jdGlvbigpLFxuICAgICAgICBiZWdpbjogZnVuY3Rpb24oY29uZGl0aW9uKSxcbiAgICAgICAgcG9wU3RhdGU6IGZ1bmN0aW9uKCksXG4gICAgICAgIF9jdXJyZW50UnVsZXM6IGZ1bmN0aW9uKCksXG4gICAgICAgIHRvcFN0YXRlOiBmdW5jdGlvbigpLFxuICAgICAgICBwdXNoU3RhdGU6IGZ1bmN0aW9uKGNvbmRpdGlvbiksXG5cbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgcmFuZ2VzOiBib29sZWFuICAgICAgICAgICAob3B0aW9uYWw6IHRydWUgPT0+IHRva2VuIGxvY2F0aW9uIGluZm8gd2lsbCBpbmNsdWRlIGEgLnJhbmdlW10gbWVtYmVyKVxuICAgICAgICAgICAgZmxleDogYm9vbGVhbiAgICAgICAgICAgICAob3B0aW9uYWw6IHRydWUgPT0+IGZsZXgtbGlrZSBsZXhpbmcgYmVoYXZpb3VyIHdoZXJlIHRoZSBydWxlcyBhcmUgdGVzdGVkIGV4aGF1c3RpdmVseSB0byBmaW5kIHRoZSBsb25nZXN0IG1hdGNoKVxuICAgICAgICAgICAgYmFja3RyYWNrX2xleGVyOiBib29sZWFuICAob3B0aW9uYWw6IHRydWUgPT0+IGxleGVyIHJlZ2V4ZXMgYXJlIHRlc3RlZCBpbiBvcmRlciBhbmQgZm9yIGVhY2ggbWF0Y2hpbmcgcmVnZXggdGhlIGFjdGlvbiBjb2RlIGlzIGludm9rZWQ7IHRoZSBsZXhlciB0ZXJtaW5hdGVzIHRoZSBzY2FuIHdoZW4gYSB0b2tlbiBpcyByZXR1cm5lZCBieSB0aGUgYWN0aW9uIGNvZGUpXG4gICAgICAgIH0sXG5cbiAgICAgICAgcGVyZm9ybUFjdGlvbjogZnVuY3Rpb24oeXksIHl5XywgJGF2b2lkaW5nX25hbWVfY29sbGlzaW9ucywgWVlfU1RBUlQpLFxuICAgICAgICBydWxlczogWy4uLl0sXG4gICAgICAgIGNvbmRpdGlvbnM6IHthc3NvY2lhdGl2ZSBsaXN0OiBuYW1lID09PiBzZXR9LFxuICAgIH1cbiAgfVxuXG5cbiAgdG9rZW4gbG9jYXRpb24gaW5mbyAoQCQsIF8kLCBldGMuKToge1xuICAgIGZpcnN0X2xpbmU6IG4sXG4gICAgbGFzdF9saW5lOiBuLFxuICAgIGZpcnN0X2NvbHVtbjogbixcbiAgICBsYXN0X2NvbHVtbjogbixcbiAgICByYW5nZTogW3N0YXJ0X251bWJlciwgZW5kX251bWJlcl0gICAgICAgKHdoZXJlIHRoZSBudW1iZXJzIGFyZSBpbmRleGVzIGludG8gdGhlIGlucHV0IHN0cmluZywgcmVndWxhciB6ZXJvLWJhc2VkKVxuICB9XG5cblxuICB0aGUgcGFyc2VFcnJvciBmdW5jdGlvbiByZWNlaXZlcyBhICdoYXNoJyBvYmplY3Qgd2l0aCB0aGVzZSBtZW1iZXJzIGZvciBsZXhlciBhbmQgcGFyc2VyIGVycm9yczoge1xuICAgIHRleHQ6ICAgICAgICAobWF0Y2hlZCB0ZXh0KVxuICAgIHRva2VuOiAgICAgICAodGhlIHByb2R1Y2VkIHRlcm1pbmFsIHRva2VuLCBpZiBhbnkpXG4gICAgbGluZTogICAgICAgICh5eWxpbmVubylcbiAgfVxuICB3aGlsZSBwYXJzZXIgKGdyYW1tYXIpIGVycm9ycyB3aWxsIGFsc28gcHJvdmlkZSB0aGVzZSBtZW1iZXJzLCBpLmUuIHBhcnNlciBlcnJvcnMgZGVsaXZlciBhIHN1cGVyc2V0IG9mIGF0dHJpYnV0ZXM6IHtcbiAgICBsb2M6ICAgICAgICAgKHl5bGxvYylcbiAgICBleHBlY3RlZDogICAgKHN0cmluZyBkZXNjcmliaW5nIHRoZSBzZXQgb2YgZXhwZWN0ZWQgdG9rZW5zKVxuICAgIHJlY292ZXJhYmxlOiAoYm9vbGVhbjogVFJVRSB3aGVuIHRoZSBwYXJzZXIgaGFzIGEgZXJyb3IgcmVjb3ZlcnkgcnVsZSBhdmFpbGFibGUgZm9yIHRoaXMgcGFydGljdWxhciBlcnJvcilcbiAgfVxuKi9cbnZhciBwYXJzZXIgPSAoZnVuY3Rpb24oKXtcbnZhciBvPWZ1bmN0aW9uKGssdixvLGwpe2ZvcihvPW98fHt9LGw9ay5sZW5ndGg7bC0tO29ba1tsXV09dik7cmV0dXJuIG99LCRWMD1bMSwzXSwkVjE9WzEsNF0sJFYyPVsxLDE4XSwkVjM9WzEsMTNdLCRWND1bMSwxNF0sJFY1PVsxLDE1XSwkVjY9WzEsMTZdLCRWNz1bMSwxN10sJFY4PVsxLDIwXSwkVjk9WzEsMjFdLCRWYT1bNSw2LDcsMTBdLCRWYj1bNSw2LDcsMTAsMTUsMTYsMTcsMTgsMTksMjAsMjFdLCRWYz1bNSw2LDcsMTAsMTUsMTYsMTcsMTgsMTksMjAsMjEsMjVdO1xudmFyIHBhcnNlciA9IHt0cmFjZTogZnVuY3Rpb24gdHJhY2UoKSB7IH0sXG55eToge30sXG5zeW1ib2xzXzoge1wiZXJyb3JcIjoyLFwicmVzdWx0XCI6MyxcInNlYXJjaF9jb25kaXRpb25cIjo0LFwiRU9GXCI6NSxcIk9SXCI6NixcIkFORFwiOjcsXCJOT1RcIjo4LFwiKFwiOjksXCIpXCI6MTAsXCJwcmVkaWNhdGVcIjoxMSxcImNvbXBhcmlzb25fcHJlZGljYXRlXCI6MTIsXCJ0cnV0aHlfcHJlZGljYXRlXCI6MTMsXCJzY2FsYXJfZXhwXCI6MTQsXCJFUVwiOjE1LFwiREVRXCI6MTYsXCJORVFcIjoxNyxcIkxUXCI6MTgsXCJMVEVcIjoxOSxcIkdUXCI6MjAsXCJHVEVcIjoyMSxcImF0b21cIjoyMixcImZpZWxkX3JlZlwiOjIzLFwibGl0ZXJhbFwiOjI0LFwiRE9UXCI6MjUsXCJmaWVsZF9uYW1lXCI6MjYsXCJOQU1FXCI6MjcsXCJTVFJJTkdcIjoyOCxcIk5VTUVSSUNcIjoyOSxcIlRSVUVcIjozMCxcIkZBTFNFXCI6MzEsXCJOVUxMXCI6MzIsXCIkYWNjZXB0XCI6MCxcIiRlbmRcIjoxfSxcbnRlcm1pbmFsc186IHsyOlwiZXJyb3JcIiw1OlwiRU9GXCIsNjpcIk9SXCIsNzpcIkFORFwiLDg6XCJOT1RcIiw5OlwiKFwiLDEwOlwiKVwiLDE1OlwiRVFcIiwxNjpcIkRFUVwiLDE3OlwiTkVRXCIsMTg6XCJMVFwiLDE5OlwiTFRFXCIsMjA6XCJHVFwiLDIxOlwiR1RFXCIsMjU6XCJET1RcIiwyNzpcIk5BTUVcIiwyODpcIlNUUklOR1wiLDI5OlwiTlVNRVJJQ1wiLDMwOlwiVFJVRVwiLDMxOlwiRkFMU0VcIiwzMjpcIk5VTExcIn0sXG5wcm9kdWN0aW9uc186IFswLFszLDJdLFs0LDNdLFs0LDNdLFs0LDJdLFs0LDNdLFs0LDFdLFsxMSwxXSxbMTEsMV0sWzEyLDNdLFsxMiwzXSxbMTIsM10sWzEyLDNdLFsxMiwzXSxbMTIsM10sWzEyLDNdLFsxMywxXSxbMTQsMV0sWzE0LDFdLFsyMiwxXSxbMjMsM10sWzIzLDFdLFsyNiwxXSxbMjQsMV0sWzI0LDFdLFsyNCwxXSxbMjQsMV0sWzI0LDFdXSxcbnBlcmZvcm1BY3Rpb246IGZ1bmN0aW9uIGFub255bW91cyh5eXRleHQsIHl5bGVuZywgeXlsaW5lbm8sIHl5LCB5eXN0YXRlIC8qIGFjdGlvblsxXSAqLywgJCQgLyogdnN0YWNrICovLCBfJCAvKiBsc3RhY2sgKi8pIHtcbi8qIHRoaXMgPT0geXl2YWwgKi9cblxudmFyICQwID0gJCQubGVuZ3RoIC0gMTtcbnN3aXRjaCAoeXlzdGF0ZSkge1xuY2FzZSAxOlxucmV0dXJuICQkWyQwLTFdO1xuYnJlYWs7XG5jYXNlIDI6XG50aGlzLiQgPSAkJFskMC0yXSB8fCAkJFskMF07XG5icmVhaztcbmNhc2UgMzpcbnRoaXMuJCA9ICQkWyQwLTJdICYmICQkWyQwXTtcbmJyZWFrO1xuY2FzZSA0OlxudGhpcy4kID0gISQkWyQwXTtcbmJyZWFrO1xuY2FzZSA1OlxudGhpcy4kID0gJCRbJDAtMV07XG5icmVhaztcbmNhc2UgNjogY2FzZSA3OiBjYXNlIDg6IGNhc2UgMTc6IGNhc2UgMTg6IGNhc2UgMTk6XG50aGlzLiQgPSAkJFskMF07XG5icmVhaztcbmNhc2UgOTpcbnRoaXMuJCA9ICQkWyQwLTJdID09PSAkJFskMF07XG5icmVhaztcbmNhc2UgMTA6XG50aHJvdyBuZXcgRXJyb3IoJ1wiPT1cIiBpcyBub3QgYWxsb3dlZCwgdXNlIFwiPVwiJyk7XG5icmVhaztcbmNhc2UgMTE6XG50aGlzLiQgPSAkJFskMC0yXSAhPT0gJCRbJDBdO1xuYnJlYWs7XG5jYXNlIDEyOlxudGhpcy4kID0gdHlwZW9mICQkWyQwLTJdID09IHR5cGVvZiAkJFskMF0gJiYgJCRbJDAtMl0gPCAkJFskMF07XG5icmVhaztcbmNhc2UgMTM6XG50aGlzLiQgPSB0eXBlb2YgJCRbJDAtMl0gPT0gdHlwZW9mICQkWyQwXSAmJiAkJFskMC0yXSA8PSAkJFskMF07XG5icmVhaztcbmNhc2UgMTQ6XG50aGlzLiQgPSB0eXBlb2YgJCRbJDAtMl0gPT0gdHlwZW9mICQkWyQwXSAmJiAkJFskMC0yXSA+ICQkWyQwXTtcbmJyZWFrO1xuY2FzZSAxNTpcbnRoaXMuJCA9IHR5cGVvZiAkJFskMC0yXSA9PSB0eXBlb2YgJCRbJDBdICYmICQkWyQwLTJdID49ICQkWyQwXTtcbmJyZWFrO1xuY2FzZSAxNjpcbnRoaXMuJCA9ICgkJFskMF0gIT09IHVuZGVmaW5lZCAmJiAkJFskMF0gIT09IG51bGxcbiAgICAgICAgICAgICAgICAmJiAkJFskMF0gIT09ICcnICYmICQkWyQwXSAhPT0gMCAmJiAkJFskMF0gIT09IGZhbHNlKTtcbmJyZWFrO1xuY2FzZSAyMDpcbnRoaXMuJCA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCgkJFskMC0yXSkgPT0gJ1tvYmplY3QgT2JqZWN0XScgJiYgJCRbJDAtMl0uaGFzT3duUHJvcGVydHkoJCRbJDBdKSA/ICQkWyQwLTJdWyQkWyQwXV0gOiBudWxsO1xuYnJlYWs7XG5jYXNlIDIxOlxudGhpcy4kID0geXlbJCRbJDBdXSAhPT0gdW5kZWZpbmVkID8geXlbJCRbJDBdXSA6IG51bGw7XG5icmVhaztcbmNhc2UgMjI6XG50aGlzLiQgPSB5eXRleHQ7XG5icmVhaztcbmNhc2UgMjM6XG50aGlzLiQgPSB5eXRleHQuc3Vic3RyaW5nKDEsIHl5dGV4dC5sZW5ndGggLSAxKTtcbmJyZWFrO1xuY2FzZSAyNDpcbnRoaXMuJCA9IE51bWJlcih5eXRleHQpO1xuYnJlYWs7XG5jYXNlIDI1OlxudGhpcy4kID0gdHJ1ZVxuYnJlYWs7XG5jYXNlIDI2OlxudGhpcy4kID0gZmFsc2VcbmJyZWFrO1xuY2FzZSAyNzpcbnRoaXMuJCA9IG51bGxcbmJyZWFrO1xufVxufSxcbnRhYmxlOiBbezM6MSw0OjIsODokVjAsOTokVjEsMTE6NSwxMjo2LDEzOjcsMTQ6OCwyMjo5LDIzOjEwLDI0OjExLDI2OjEyLDI3OiRWMiwyODokVjMsMjk6JFY0LDMwOiRWNSwzMTokVjYsMzI6JFY3fSx7MTpbM119LHs1OlsxLDE5XSw2OiRWOCw3OiRWOX0sezQ6MjIsODokVjAsOTokVjEsMTE6NSwxMjo2LDEzOjcsMTQ6OCwyMjo5LDIzOjEwLDI0OjExLDI2OjEyLDI3OiRWMiwyODokVjMsMjk6JFY0LDMwOiRWNSwzMTokVjYsMzI6JFY3fSx7NDoyMyw4OiRWMCw5OiRWMSwxMTo1LDEyOjYsMTM6NywxNDo4LDIyOjksMjM6MTAsMjQ6MTEsMjY6MTIsMjc6JFYyLDI4OiRWMywyOTokVjQsMzA6JFY1LDMxOiRWNiwzMjokVjd9LG8oJFZhLFsyLDZdKSxvKCRWYSxbMiw3XSksbygkVmEsWzIsOF0pLG8oJFZhLFsyLDE2XSx7MTU6WzEsMjRdLDE2OlsxLDI1XSwxNzpbMSwyNl0sMTg6WzEsMjddLDE5OlsxLDI4XSwyMDpbMSwyOV0sMjE6WzEsMzBdfSksbygkVmIsWzIsMTddKSxvKCRWYixbMiwxOF0sezI1OlsxLDMxXX0pLG8oJFZiLFsyLDE5XSksbygkVmMsWzIsMjFdKSxvKCRWYixbMiwyM10pLG8oJFZiLFsyLDI0XSksbygkVmIsWzIsMjVdKSxvKCRWYixbMiwyNl0pLG8oJFZiLFsyLDI3XSksbygkVmMsWzIsMjJdKSx7MTpbMiwxXX0sezQ6MzIsODokVjAsOTokVjEsMTE6NSwxMjo2LDEzOjcsMTQ6OCwyMjo5LDIzOjEwLDI0OjExLDI2OjEyLDI3OiRWMiwyODokVjMsMjk6JFY0LDMwOiRWNSwzMTokVjYsMzI6JFY3fSx7NDozMyw4OiRWMCw5OiRWMSwxMTo1LDEyOjYsMTM6NywxNDo4LDIyOjksMjM6MTAsMjQ6MTEsMjY6MTIsMjc6JFYyLDI4OiRWMywyOTokVjQsMzA6JFY1LDMxOiRWNiwzMjokVjd9LG8oJFZhLFsyLDRdKSx7NjokVjgsNzokVjksMTA6WzEsMzRdfSx7MTQ6MzUsMjI6OSwyMzoxMCwyNDoxMSwyNjoxMiwyNzokVjIsMjg6JFYzLDI5OiRWNCwzMDokVjUsMzE6JFY2LDMyOiRWN30sezE0OjM2LDIyOjksMjM6MTAsMjQ6MTEsMjY6MTIsMjc6JFYyLDI4OiRWMywyOTokVjQsMzA6JFY1LDMxOiRWNiwzMjokVjd9LHsxNDozNywyMjo5LDIzOjEwLDI0OjExLDI2OjEyLDI3OiRWMiwyODokVjMsMjk6JFY0LDMwOiRWNSwzMTokVjYsMzI6JFY3fSx7MTQ6MzgsMjI6OSwyMzoxMCwyNDoxMSwyNjoxMiwyNzokVjIsMjg6JFYzLDI5OiRWNCwzMDokVjUsMzE6JFY2LDMyOiRWN30sezE0OjM5LDIyOjksMjM6MTAsMjQ6MTEsMjY6MTIsMjc6JFYyLDI4OiRWMywyOTokVjQsMzA6JFY1LDMxOiRWNiwzMjokVjd9LHsxNDo0MCwyMjo5LDIzOjEwLDI0OjExLDI2OjEyLDI3OiRWMiwyODokVjMsMjk6JFY0LDMwOiRWNSwzMTokVjYsMzI6JFY3fSx7MTQ6NDEsMjI6OSwyMzoxMCwyNDoxMSwyNjoxMiwyNzokVjIsMjg6JFYzLDI5OiRWNCwzMDokVjUsMzE6JFY2LDMyOiRWN30sezI2OjQyLDI3OiRWMn0sbyhbNSw2LDEwXSxbMiwyXSx7NzokVjl9KSxvKCRWYSxbMiwzXSksbygkVmEsWzIsNV0pLG8oJFZhLFsyLDldKSxvKCRWYSxbMiwxMF0pLG8oJFZhLFsyLDExXSksbygkVmEsWzIsMTJdKSxvKCRWYSxbMiwxM10pLG8oJFZhLFsyLDE0XSksbygkVmEsWzIsMTVdKSxvKCRWYyxbMiwyMF0pXSxcbmRlZmF1bHRBY3Rpb25zOiB7MTk6WzIsMV19LFxucGFyc2VFcnJvcjogZnVuY3Rpb24gcGFyc2VFcnJvcihzdHIsIGhhc2gpIHtcbiAgICBpZiAoaGFzaC5yZWNvdmVyYWJsZSkge1xuICAgICAgICB0aGlzLnRyYWNlKHN0cik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGVycm9yID0gbmV3IEVycm9yKHN0cik7XG4gICAgICAgIGVycm9yLmhhc2ggPSBoYXNoO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG59LFxucGFyc2U6IGZ1bmN0aW9uIHBhcnNlKGlucHV0KSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzLCBzdGFjayA9IFswXSwgdHN0YWNrID0gW10sIHZzdGFjayA9IFtudWxsXSwgbHN0YWNrID0gW10sIHRhYmxlID0gdGhpcy50YWJsZSwgeXl0ZXh0ID0gJycsIHl5bGluZW5vID0gMCwgeXlsZW5nID0gMCwgcmVjb3ZlcmluZyA9IDAsIFRFUlJPUiA9IDIsIEVPRiA9IDE7XG4gICAgdmFyIGFyZ3MgPSBsc3RhY2suc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuICAgIHZhciBsZXhlciA9IE9iamVjdC5jcmVhdGUodGhpcy5sZXhlcik7XG4gICAgdmFyIHNoYXJlZFN0YXRlID0geyB5eToge30gfTtcbiAgICBmb3IgKHZhciBrIGluIHRoaXMueXkpIHtcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLnl5LCBrKSkge1xuICAgICAgICAgICAgc2hhcmVkU3RhdGUueXlba10gPSB0aGlzLnl5W2tdO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxleGVyLnNldElucHV0KGlucHV0LCBzaGFyZWRTdGF0ZS55eSk7XG4gICAgc2hhcmVkU3RhdGUueXkubGV4ZXIgPSBsZXhlcjtcbiAgICBzaGFyZWRTdGF0ZS55eS5wYXJzZXIgPSB0aGlzO1xuICAgIGlmICh0eXBlb2YgbGV4ZXIueXlsbG9jID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGxleGVyLnl5bGxvYyA9IHt9O1xuICAgIH1cbiAgICB2YXIgeXlsb2MgPSBsZXhlci55eWxsb2M7XG4gICAgbHN0YWNrLnB1c2goeXlsb2MpO1xuICAgIHZhciByYW5nZXMgPSBsZXhlci5vcHRpb25zICYmIGxleGVyLm9wdGlvbnMucmFuZ2VzO1xuICAgIGlmICh0eXBlb2Ygc2hhcmVkU3RhdGUueXkucGFyc2VFcnJvciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aGlzLnBhcnNlRXJyb3IgPSBzaGFyZWRTdGF0ZS55eS5wYXJzZUVycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucGFyc2VFcnJvciA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKS5wYXJzZUVycm9yO1xuICAgIH1cbiAgICBmdW5jdGlvbiBwb3BTdGFjayhuKSB7XG4gICAgICAgIHN0YWNrLmxlbmd0aCA9IHN0YWNrLmxlbmd0aCAtIDIgKiBuO1xuICAgICAgICB2c3RhY2subGVuZ3RoID0gdnN0YWNrLmxlbmd0aCAtIG47XG4gICAgICAgIGxzdGFjay5sZW5ndGggPSBsc3RhY2subGVuZ3RoIC0gbjtcbiAgICB9XG4gICAgX3Rva2VuX3N0YWNrOlxuICAgICAgICB2YXIgbGV4ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRva2VuO1xuICAgICAgICAgICAgdG9rZW4gPSBsZXhlci5sZXgoKSB8fCBFT0Y7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRva2VuICE9PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgIHRva2VuID0gc2VsZi5zeW1ib2xzX1t0b2tlbl0gfHwgdG9rZW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdG9rZW47XG4gICAgICAgIH07XG4gICAgdmFyIHN5bWJvbCwgcHJlRXJyb3JTeW1ib2wsIHN0YXRlLCBhY3Rpb24sIGEsIHIsIHl5dmFsID0ge30sIHAsIGxlbiwgbmV3U3RhdGUsIGV4cGVjdGVkO1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHN0YXRlID0gc3RhY2tbc3RhY2subGVuZ3RoIC0gMV07XG4gICAgICAgIGlmICh0aGlzLmRlZmF1bHRBY3Rpb25zW3N0YXRlXSkge1xuICAgICAgICAgICAgYWN0aW9uID0gdGhpcy5kZWZhdWx0QWN0aW9uc1tzdGF0ZV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoc3ltYm9sID09PSBudWxsIHx8IHR5cGVvZiBzeW1ib2wgPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICBzeW1ib2wgPSBsZXgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFjdGlvbiA9IHRhYmxlW3N0YXRlXSAmJiB0YWJsZVtzdGF0ZV1bc3ltYm9sXTtcbiAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGFjdGlvbiA9PT0gJ3VuZGVmaW5lZCcgfHwgIWFjdGlvbi5sZW5ndGggfHwgIWFjdGlvblswXSkge1xuICAgICAgICAgICAgICAgIHZhciBlcnJTdHIgPSAnJztcbiAgICAgICAgICAgICAgICBleHBlY3RlZCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAocCBpbiB0YWJsZVtzdGF0ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudGVybWluYWxzX1twXSAmJiBwID4gVEVSUk9SKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBlY3RlZC5wdXNoKCdcXCcnICsgdGhpcy50ZXJtaW5hbHNfW3BdICsgJ1xcJycpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChsZXhlci5zaG93UG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyU3RyID0gJ1BhcnNlIGVycm9yIG9uIGxpbmUgJyArICh5eWxpbmVubyArIDEpICsgJzpcXG4nICsgbGV4ZXIuc2hvd1Bvc2l0aW9uKCkgKyAnXFxuRXhwZWN0aW5nICcgKyBleHBlY3RlZC5qb2luKCcsICcpICsgJywgZ290IFxcJycgKyAodGhpcy50ZXJtaW5hbHNfW3N5bWJvbF0gfHwgc3ltYm9sKSArICdcXCcnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVyclN0ciA9ICdQYXJzZSBlcnJvciBvbiBsaW5lICcgKyAoeXlsaW5lbm8gKyAxKSArICc6IFVuZXhwZWN0ZWQgJyArIChzeW1ib2wgPT0gRU9GID8gJ2VuZCBvZiBpbnB1dCcgOiAnXFwnJyArICh0aGlzLnRlcm1pbmFsc19bc3ltYm9sXSB8fCBzeW1ib2wpICsgJ1xcJycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnBhcnNlRXJyb3IoZXJyU3RyLCB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IGxleGVyLm1hdGNoLFxuICAgICAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy50ZXJtaW5hbHNfW3N5bWJvbF0gfHwgc3ltYm9sLFxuICAgICAgICAgICAgICAgICAgICBsaW5lOiBsZXhlci55eWxpbmVubyxcbiAgICAgICAgICAgICAgICAgICAgbG9jOiB5eWxvYyxcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWQ6IGV4cGVjdGVkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIGlmIChhY3Rpb25bMF0gaW5zdGFuY2VvZiBBcnJheSAmJiBhY3Rpb24ubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQYXJzZSBFcnJvcjogbXVsdGlwbGUgYWN0aW9ucyBwb3NzaWJsZSBhdCBzdGF0ZTogJyArIHN0YXRlICsgJywgdG9rZW46ICcgKyBzeW1ib2wpO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAoYWN0aW9uWzBdKSB7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHN0YWNrLnB1c2goc3ltYm9sKTtcbiAgICAgICAgICAgIHZzdGFjay5wdXNoKGxleGVyLnl5dGV4dCk7XG4gICAgICAgICAgICBsc3RhY2sucHVzaChsZXhlci55eWxsb2MpO1xuICAgICAgICAgICAgc3RhY2sucHVzaChhY3Rpb25bMV0pO1xuICAgICAgICAgICAgc3ltYm9sID0gbnVsbDtcbiAgICAgICAgICAgIGlmICghcHJlRXJyb3JTeW1ib2wpIHtcbiAgICAgICAgICAgICAgICB5eWxlbmcgPSBsZXhlci55eWxlbmc7XG4gICAgICAgICAgICAgICAgeXl0ZXh0ID0gbGV4ZXIueXl0ZXh0O1xuICAgICAgICAgICAgICAgIHl5bGluZW5vID0gbGV4ZXIueXlsaW5lbm87XG4gICAgICAgICAgICAgICAgeXlsb2MgPSBsZXhlci55eWxsb2M7XG4gICAgICAgICAgICAgICAgaWYgKHJlY292ZXJpbmcgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlY292ZXJpbmctLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHN5bWJvbCA9IHByZUVycm9yU3ltYm9sO1xuICAgICAgICAgICAgICAgIHByZUVycm9yU3ltYm9sID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBsZW4gPSB0aGlzLnByb2R1Y3Rpb25zX1thY3Rpb25bMV1dWzFdO1xuICAgICAgICAgICAgeXl2YWwuJCA9IHZzdGFja1t2c3RhY2subGVuZ3RoIC0gbGVuXTtcbiAgICAgICAgICAgIHl5dmFsLl8kID0ge1xuICAgICAgICAgICAgICAgIGZpcnN0X2xpbmU6IGxzdGFja1tsc3RhY2subGVuZ3RoIC0gKGxlbiB8fCAxKV0uZmlyc3RfbGluZSxcbiAgICAgICAgICAgICAgICBsYXN0X2xpbmU6IGxzdGFja1tsc3RhY2subGVuZ3RoIC0gMV0ubGFzdF9saW5lLFxuICAgICAgICAgICAgICAgIGZpcnN0X2NvbHVtbjogbHN0YWNrW2xzdGFjay5sZW5ndGggLSAobGVuIHx8IDEpXS5maXJzdF9jb2x1bW4sXG4gICAgICAgICAgICAgICAgbGFzdF9jb2x1bW46IGxzdGFja1tsc3RhY2subGVuZ3RoIC0gMV0ubGFzdF9jb2x1bW5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAocmFuZ2VzKSB7XG4gICAgICAgICAgICAgICAgeXl2YWwuXyQucmFuZ2UgPSBbXG4gICAgICAgICAgICAgICAgICAgIGxzdGFja1tsc3RhY2subGVuZ3RoIC0gKGxlbiB8fCAxKV0ucmFuZ2VbMF0sXG4gICAgICAgICAgICAgICAgICAgIGxzdGFja1tsc3RhY2subGVuZ3RoIC0gMV0ucmFuZ2VbMV1cbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgciA9IHRoaXMucGVyZm9ybUFjdGlvbi5hcHBseSh5eXZhbCwgW1xuICAgICAgICAgICAgICAgIHl5dGV4dCxcbiAgICAgICAgICAgICAgICB5eWxlbmcsXG4gICAgICAgICAgICAgICAgeXlsaW5lbm8sXG4gICAgICAgICAgICAgICAgc2hhcmVkU3RhdGUueXksXG4gICAgICAgICAgICAgICAgYWN0aW9uWzFdLFxuICAgICAgICAgICAgICAgIHZzdGFjayxcbiAgICAgICAgICAgICAgICBsc3RhY2tcbiAgICAgICAgICAgIF0uY29uY2F0KGFyZ3MpKTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgciAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsZW4pIHtcbiAgICAgICAgICAgICAgICBzdGFjayA9IHN0YWNrLnNsaWNlKDAsIC0xICogbGVuICogMik7XG4gICAgICAgICAgICAgICAgdnN0YWNrID0gdnN0YWNrLnNsaWNlKDAsIC0xICogbGVuKTtcbiAgICAgICAgICAgICAgICBsc3RhY2sgPSBsc3RhY2suc2xpY2UoMCwgLTEgKiBsZW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RhY2sucHVzaCh0aGlzLnByb2R1Y3Rpb25zX1thY3Rpb25bMV1dWzBdKTtcbiAgICAgICAgICAgIHZzdGFjay5wdXNoKHl5dmFsLiQpO1xuICAgICAgICAgICAgbHN0YWNrLnB1c2goeXl2YWwuXyQpO1xuICAgICAgICAgICAgbmV3U3RhdGUgPSB0YWJsZVtzdGFja1tzdGFjay5sZW5ndGggLSAyXV1bc3RhY2tbc3RhY2subGVuZ3RoIC0gMV1dO1xuICAgICAgICAgICAgc3RhY2sucHVzaChuZXdTdGF0ZSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59fTtcbi8qIGdlbmVyYXRlZCBieSBqaXNvbi1sZXggMC4zLjQgKi9cbnZhciBsZXhlciA9IChmdW5jdGlvbigpe1xudmFyIGxleGVyID0gKHtcblxuRU9GOjEsXG5cbnBhcnNlRXJyb3I6ZnVuY3Rpb24gcGFyc2VFcnJvcihzdHIsIGhhc2gpIHtcbiAgICAgICAgaWYgKHRoaXMueXkucGFyc2VyKSB7XG4gICAgICAgICAgICB0aGlzLnl5LnBhcnNlci5wYXJzZUVycm9yKHN0ciwgaGFzaCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3Ioc3RyKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbi8vIHJlc2V0cyB0aGUgbGV4ZXIsIHNldHMgbmV3IGlucHV0XG5zZXRJbnB1dDpmdW5jdGlvbiAoaW5wdXQsIHl5KSB7XG4gICAgICAgIHRoaXMueXkgPSB5eSB8fCB0aGlzLnl5IHx8IHt9O1xuICAgICAgICB0aGlzLl9pbnB1dCA9IGlucHV0O1xuICAgICAgICB0aGlzLl9tb3JlID0gdGhpcy5fYmFja3RyYWNrID0gdGhpcy5kb25lID0gZmFsc2U7XG4gICAgICAgIHRoaXMueXlsaW5lbm8gPSB0aGlzLnl5bGVuZyA9IDA7XG4gICAgICAgIHRoaXMueXl0ZXh0ID0gdGhpcy5tYXRjaGVkID0gdGhpcy5tYXRjaCA9ICcnO1xuICAgICAgICB0aGlzLmNvbmRpdGlvblN0YWNrID0gWydJTklUSUFMJ107XG4gICAgICAgIHRoaXMueXlsbG9jID0ge1xuICAgICAgICAgICAgZmlyc3RfbGluZTogMSxcbiAgICAgICAgICAgIGZpcnN0X2NvbHVtbjogMCxcbiAgICAgICAgICAgIGxhc3RfbGluZTogMSxcbiAgICAgICAgICAgIGxhc3RfY29sdW1uOiAwXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMucmFuZ2VzKSB7XG4gICAgICAgICAgICB0aGlzLnl5bGxvYy5yYW5nZSA9IFswLDBdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub2Zmc2V0ID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuLy8gY29uc3VtZXMgYW5kIHJldHVybnMgb25lIGNoYXIgZnJvbSB0aGUgaW5wdXRcbmlucHV0OmZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNoID0gdGhpcy5faW5wdXRbMF07XG4gICAgICAgIHRoaXMueXl0ZXh0ICs9IGNoO1xuICAgICAgICB0aGlzLnl5bGVuZysrO1xuICAgICAgICB0aGlzLm9mZnNldCsrO1xuICAgICAgICB0aGlzLm1hdGNoICs9IGNoO1xuICAgICAgICB0aGlzLm1hdGNoZWQgKz0gY2g7XG4gICAgICAgIHZhciBsaW5lcyA9IGNoLm1hdGNoKC8oPzpcXHJcXG4/fFxcbikuKi9nKTtcbiAgICAgICAgaWYgKGxpbmVzKSB7XG4gICAgICAgICAgICB0aGlzLnl5bGluZW5vKys7XG4gICAgICAgICAgICB0aGlzLnl5bGxvYy5sYXN0X2xpbmUrKztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMueXlsbG9jLmxhc3RfY29sdW1uKys7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5yYW5nZXMpIHtcbiAgICAgICAgICAgIHRoaXMueXlsbG9jLnJhbmdlWzFdKys7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9pbnB1dCA9IHRoaXMuX2lucHV0LnNsaWNlKDEpO1xuICAgICAgICByZXR1cm4gY2g7XG4gICAgfSxcblxuLy8gdW5zaGlmdHMgb25lIGNoYXIgKG9yIGEgc3RyaW5nKSBpbnRvIHRoZSBpbnB1dFxudW5wdXQ6ZnVuY3Rpb24gKGNoKSB7XG4gICAgICAgIHZhciBsZW4gPSBjaC5sZW5ndGg7XG4gICAgICAgIHZhciBsaW5lcyA9IGNoLnNwbGl0KC8oPzpcXHJcXG4/fFxcbikvZyk7XG5cbiAgICAgICAgdGhpcy5faW5wdXQgPSBjaCArIHRoaXMuX2lucHV0O1xuICAgICAgICB0aGlzLnl5dGV4dCA9IHRoaXMueXl0ZXh0LnN1YnN0cigwLCB0aGlzLnl5dGV4dC5sZW5ndGggLSBsZW4pO1xuICAgICAgICAvL3RoaXMueXlsZW5nIC09IGxlbjtcbiAgICAgICAgdGhpcy5vZmZzZXQgLT0gbGVuO1xuICAgICAgICB2YXIgb2xkTGluZXMgPSB0aGlzLm1hdGNoLnNwbGl0KC8oPzpcXHJcXG4/fFxcbikvZyk7XG4gICAgICAgIHRoaXMubWF0Y2ggPSB0aGlzLm1hdGNoLnN1YnN0cigwLCB0aGlzLm1hdGNoLmxlbmd0aCAtIDEpO1xuICAgICAgICB0aGlzLm1hdGNoZWQgPSB0aGlzLm1hdGNoZWQuc3Vic3RyKDAsIHRoaXMubWF0Y2hlZC5sZW5ndGggLSAxKTtcblxuICAgICAgICBpZiAobGluZXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgdGhpcy55eWxpbmVubyAtPSBsaW5lcy5sZW5ndGggLSAxO1xuICAgICAgICB9XG4gICAgICAgIHZhciByID0gdGhpcy55eWxsb2MucmFuZ2U7XG5cbiAgICAgICAgdGhpcy55eWxsb2MgPSB7XG4gICAgICAgICAgICBmaXJzdF9saW5lOiB0aGlzLnl5bGxvYy5maXJzdF9saW5lLFxuICAgICAgICAgICAgbGFzdF9saW5lOiB0aGlzLnl5bGluZW5vICsgMSxcbiAgICAgICAgICAgIGZpcnN0X2NvbHVtbjogdGhpcy55eWxsb2MuZmlyc3RfY29sdW1uLFxuICAgICAgICAgICAgbGFzdF9jb2x1bW46IGxpbmVzID9cbiAgICAgICAgICAgICAgICAobGluZXMubGVuZ3RoID09PSBvbGRMaW5lcy5sZW5ndGggPyB0aGlzLnl5bGxvYy5maXJzdF9jb2x1bW4gOiAwKVxuICAgICAgICAgICAgICAgICArIG9sZExpbmVzW29sZExpbmVzLmxlbmd0aCAtIGxpbmVzLmxlbmd0aF0ubGVuZ3RoIC0gbGluZXNbMF0ubGVuZ3RoIDpcbiAgICAgICAgICAgICAgdGhpcy55eWxsb2MuZmlyc3RfY29sdW1uIC0gbGVuXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5yYW5nZXMpIHtcbiAgICAgICAgICAgIHRoaXMueXlsbG9jLnJhbmdlID0gW3JbMF0sIHJbMF0gKyB0aGlzLnl5bGVuZyAtIGxlbl07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy55eWxlbmcgPSB0aGlzLnl5dGV4dC5sZW5ndGg7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbi8vIFdoZW4gY2FsbGVkIGZyb20gYWN0aW9uLCBjYWNoZXMgbWF0Y2hlZCB0ZXh0IGFuZCBhcHBlbmRzIGl0IG9uIG5leHQgYWN0aW9uXG5tb3JlOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fbW9yZSA9IHRydWU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbi8vIFdoZW4gY2FsbGVkIGZyb20gYWN0aW9uLCBzaWduYWxzIHRoZSBsZXhlciB0aGF0IHRoaXMgcnVsZSBmYWlscyB0byBtYXRjaCB0aGUgaW5wdXQsIHNvIHRoZSBuZXh0IG1hdGNoaW5nIHJ1bGUgKHJlZ2V4KSBzaG91bGQgYmUgdGVzdGVkIGluc3RlYWQuXG5yZWplY3Q6ZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmJhY2t0cmFja19sZXhlcikge1xuICAgICAgICAgICAgdGhpcy5fYmFja3RyYWNrID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlRXJyb3IoJ0xleGljYWwgZXJyb3Igb24gbGluZSAnICsgKHRoaXMueXlsaW5lbm8gKyAxKSArICcuIFlvdSBjYW4gb25seSBpbnZva2UgcmVqZWN0KCkgaW4gdGhlIGxleGVyIHdoZW4gdGhlIGxleGVyIGlzIG9mIHRoZSBiYWNrdHJhY2tpbmcgcGVyc3Vhc2lvbiAob3B0aW9ucy5iYWNrdHJhY2tfbGV4ZXIgPSB0cnVlKS5cXG4nICsgdGhpcy5zaG93UG9zaXRpb24oKSwge1xuICAgICAgICAgICAgICAgIHRleHQ6IFwiXCIsXG4gICAgICAgICAgICAgICAgdG9rZW46IG51bGwsXG4gICAgICAgICAgICAgICAgbGluZTogdGhpcy55eWxpbmVub1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4vLyByZXRhaW4gZmlyc3QgbiBjaGFyYWN0ZXJzIG9mIHRoZSBtYXRjaFxubGVzczpmdW5jdGlvbiAobikge1xuICAgICAgICB0aGlzLnVucHV0KHRoaXMubWF0Y2guc2xpY2UobikpO1xuICAgIH0sXG5cbi8vIGRpc3BsYXlzIGFscmVhZHkgbWF0Y2hlZCBpbnB1dCwgaS5lLiBmb3IgZXJyb3IgbWVzc2FnZXNcbnBhc3RJbnB1dDpmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYXN0ID0gdGhpcy5tYXRjaGVkLnN1YnN0cigwLCB0aGlzLm1hdGNoZWQubGVuZ3RoIC0gdGhpcy5tYXRjaC5sZW5ndGgpO1xuICAgICAgICByZXR1cm4gKHBhc3QubGVuZ3RoID4gMjAgPyAnLi4uJzonJykgKyBwYXN0LnN1YnN0cigtMjApLnJlcGxhY2UoL1xcbi9nLCBcIlwiKTtcbiAgICB9LFxuXG4vLyBkaXNwbGF5cyB1cGNvbWluZyBpbnB1dCwgaS5lLiBmb3IgZXJyb3IgbWVzc2FnZXNcbnVwY29taW5nSW5wdXQ6ZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmV4dCA9IHRoaXMubWF0Y2g7XG4gICAgICAgIGlmIChuZXh0Lmxlbmd0aCA8IDIwKSB7XG4gICAgICAgICAgICBuZXh0ICs9IHRoaXMuX2lucHV0LnN1YnN0cigwLCAyMC1uZXh0Lmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXh0LnN1YnN0cigwLDIwKSArIChuZXh0Lmxlbmd0aCA+IDIwID8gJy4uLicgOiAnJykpLnJlcGxhY2UoL1xcbi9nLCBcIlwiKTtcbiAgICB9LFxuXG4vLyBkaXNwbGF5cyB0aGUgY2hhcmFjdGVyIHBvc2l0aW9uIHdoZXJlIHRoZSBsZXhpbmcgZXJyb3Igb2NjdXJyZWQsIGkuZS4gZm9yIGVycm9yIG1lc3NhZ2VzXG5zaG93UG9zaXRpb246ZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcHJlID0gdGhpcy5wYXN0SW5wdXQoKTtcbiAgICAgICAgdmFyIGMgPSBuZXcgQXJyYXkocHJlLmxlbmd0aCArIDEpLmpvaW4oXCItXCIpO1xuICAgICAgICByZXR1cm4gcHJlICsgdGhpcy51cGNvbWluZ0lucHV0KCkgKyBcIlxcblwiICsgYyArIFwiXlwiO1xuICAgIH0sXG5cbi8vIHRlc3QgdGhlIGxleGVkIHRva2VuOiByZXR1cm4gRkFMU0Ugd2hlbiBub3QgYSBtYXRjaCwgb3RoZXJ3aXNlIHJldHVybiB0b2tlblxudGVzdF9tYXRjaDpmdW5jdGlvbiAobWF0Y2gsIGluZGV4ZWRfcnVsZSkge1xuICAgICAgICB2YXIgdG9rZW4sXG4gICAgICAgICAgICBsaW5lcyxcbiAgICAgICAgICAgIGJhY2t1cDtcblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmJhY2t0cmFja19sZXhlcikge1xuICAgICAgICAgICAgLy8gc2F2ZSBjb250ZXh0XG4gICAgICAgICAgICBiYWNrdXAgPSB7XG4gICAgICAgICAgICAgICAgeXlsaW5lbm86IHRoaXMueXlsaW5lbm8sXG4gICAgICAgICAgICAgICAgeXlsbG9jOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpcnN0X2xpbmU6IHRoaXMueXlsbG9jLmZpcnN0X2xpbmUsXG4gICAgICAgICAgICAgICAgICAgIGxhc3RfbGluZTogdGhpcy5sYXN0X2xpbmUsXG4gICAgICAgICAgICAgICAgICAgIGZpcnN0X2NvbHVtbjogdGhpcy55eWxsb2MuZmlyc3RfY29sdW1uLFxuICAgICAgICAgICAgICAgICAgICBsYXN0X2NvbHVtbjogdGhpcy55eWxsb2MubGFzdF9jb2x1bW5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHl5dGV4dDogdGhpcy55eXRleHQsXG4gICAgICAgICAgICAgICAgbWF0Y2g6IHRoaXMubWF0Y2gsXG4gICAgICAgICAgICAgICAgbWF0Y2hlczogdGhpcy5tYXRjaGVzLFxuICAgICAgICAgICAgICAgIG1hdGNoZWQ6IHRoaXMubWF0Y2hlZCxcbiAgICAgICAgICAgICAgICB5eWxlbmc6IHRoaXMueXlsZW5nLFxuICAgICAgICAgICAgICAgIG9mZnNldDogdGhpcy5vZmZzZXQsXG4gICAgICAgICAgICAgICAgX21vcmU6IHRoaXMuX21vcmUsXG4gICAgICAgICAgICAgICAgX2lucHV0OiB0aGlzLl9pbnB1dCxcbiAgICAgICAgICAgICAgICB5eTogdGhpcy55eSxcbiAgICAgICAgICAgICAgICBjb25kaXRpb25TdGFjazogdGhpcy5jb25kaXRpb25TdGFjay5zbGljZSgwKSxcbiAgICAgICAgICAgICAgICBkb25lOiB0aGlzLmRvbmVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnJhbmdlcykge1xuICAgICAgICAgICAgICAgIGJhY2t1cC55eWxsb2MucmFuZ2UgPSB0aGlzLnl5bGxvYy5yYW5nZS5zbGljZSgwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGxpbmVzID0gbWF0Y2hbMF0ubWF0Y2goLyg/Olxcclxcbj98XFxuKS4qL2cpO1xuICAgICAgICBpZiAobGluZXMpIHtcbiAgICAgICAgICAgIHRoaXMueXlsaW5lbm8gKz0gbGluZXMubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMueXlsbG9jID0ge1xuICAgICAgICAgICAgZmlyc3RfbGluZTogdGhpcy55eWxsb2MubGFzdF9saW5lLFxuICAgICAgICAgICAgbGFzdF9saW5lOiB0aGlzLnl5bGluZW5vICsgMSxcbiAgICAgICAgICAgIGZpcnN0X2NvbHVtbjogdGhpcy55eWxsb2MubGFzdF9jb2x1bW4sXG4gICAgICAgICAgICBsYXN0X2NvbHVtbjogbGluZXMgP1xuICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdLmxlbmd0aCAtIGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdLm1hdGNoKC9cXHI/XFxuPy8pWzBdLmxlbmd0aCA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy55eWxsb2MubGFzdF9jb2x1bW4gKyBtYXRjaFswXS5sZW5ndGhcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy55eXRleHQgKz0gbWF0Y2hbMF07XG4gICAgICAgIHRoaXMubWF0Y2ggKz0gbWF0Y2hbMF07XG4gICAgICAgIHRoaXMubWF0Y2hlcyA9IG1hdGNoO1xuICAgICAgICB0aGlzLnl5bGVuZyA9IHRoaXMueXl0ZXh0Lmxlbmd0aDtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5yYW5nZXMpIHtcbiAgICAgICAgICAgIHRoaXMueXlsbG9jLnJhbmdlID0gW3RoaXMub2Zmc2V0LCB0aGlzLm9mZnNldCArPSB0aGlzLnl5bGVuZ107XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbW9yZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9iYWNrdHJhY2sgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5faW5wdXQgPSB0aGlzLl9pbnB1dC5zbGljZShtYXRjaFswXS5sZW5ndGgpO1xuICAgICAgICB0aGlzLm1hdGNoZWQgKz0gbWF0Y2hbMF07XG4gICAgICAgIHRva2VuID0gdGhpcy5wZXJmb3JtQWN0aW9uLmNhbGwodGhpcywgdGhpcy55eSwgdGhpcywgaW5kZXhlZF9ydWxlLCB0aGlzLmNvbmRpdGlvblN0YWNrW3RoaXMuY29uZGl0aW9uU3RhY2subGVuZ3RoIC0gMV0pO1xuICAgICAgICBpZiAodGhpcy5kb25lICYmIHRoaXMuX2lucHV0KSB7XG4gICAgICAgICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHJldHVybiB0b2tlbjtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9iYWNrdHJhY2spIHtcbiAgICAgICAgICAgIC8vIHJlY292ZXIgY29udGV4dFxuICAgICAgICAgICAgZm9yICh2YXIgayBpbiBiYWNrdXApIHtcbiAgICAgICAgICAgICAgICB0aGlzW2tdID0gYmFja3VwW2tdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBydWxlIGFjdGlvbiBjYWxsZWQgcmVqZWN0KCkgaW1wbHlpbmcgdGhlIG5leHQgcnVsZSBzaG91bGQgYmUgdGVzdGVkIGluc3RlYWQuXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0sXG5cbi8vIHJldHVybiBuZXh0IG1hdGNoIGluIGlucHV0XG5uZXh0OmZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuZG9uZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuRU9GO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5faW5wdXQpIHtcbiAgICAgICAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgdG9rZW4sXG4gICAgICAgICAgICBtYXRjaCxcbiAgICAgICAgICAgIHRlbXBNYXRjaCxcbiAgICAgICAgICAgIGluZGV4O1xuICAgICAgICBpZiAoIXRoaXMuX21vcmUpIHtcbiAgICAgICAgICAgIHRoaXMueXl0ZXh0ID0gJyc7XG4gICAgICAgICAgICB0aGlzLm1hdGNoID0gJyc7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJ1bGVzID0gdGhpcy5fY3VycmVudFJ1bGVzKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcnVsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRlbXBNYXRjaCA9IHRoaXMuX2lucHV0Lm1hdGNoKHRoaXMucnVsZXNbcnVsZXNbaV1dKTtcbiAgICAgICAgICAgIGlmICh0ZW1wTWF0Y2ggJiYgKCFtYXRjaCB8fCB0ZW1wTWF0Y2hbMF0ubGVuZ3RoID4gbWF0Y2hbMF0ubGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgIG1hdGNoID0gdGVtcE1hdGNoO1xuICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmJhY2t0cmFja19sZXhlcikge1xuICAgICAgICAgICAgICAgICAgICB0b2tlbiA9IHRoaXMudGVzdF9tYXRjaCh0ZW1wTWF0Y2gsIHJ1bGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRva2VuICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JhY2t0cmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2ggPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBydWxlIGFjdGlvbiBjYWxsZWQgcmVqZWN0KCkgaW1wbHlpbmcgYSBydWxlIE1JU21hdGNoLlxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZWxzZTogdGhpcyBpcyBhIGxleGVyIHJ1bGUgd2hpY2ggY29uc3VtZXMgaW5wdXQgd2l0aG91dCBwcm9kdWNpbmcgYSB0b2tlbiAoZS5nLiB3aGl0ZXNwYWNlKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghdGhpcy5vcHRpb25zLmZsZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgdG9rZW4gPSB0aGlzLnRlc3RfbWF0Y2gobWF0Y2gsIHJ1bGVzW2luZGV4XSk7XG4gICAgICAgICAgICBpZiAodG9rZW4gIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZWxzZTogdGhpcyBpcyBhIGxleGVyIHJ1bGUgd2hpY2ggY29uc3VtZXMgaW5wdXQgd2l0aG91dCBwcm9kdWNpbmcgYSB0b2tlbiAoZS5nLiB3aGl0ZXNwYWNlKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9pbnB1dCA9PT0gXCJcIikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuRU9GO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VFcnJvcignTGV4aWNhbCBlcnJvciBvbiBsaW5lICcgKyAodGhpcy55eWxpbmVubyArIDEpICsgJy4gVW5yZWNvZ25pemVkIHRleHQuXFxuJyArIHRoaXMuc2hvd1Bvc2l0aW9uKCksIHtcbiAgICAgICAgICAgICAgICB0ZXh0OiBcIlwiLFxuICAgICAgICAgICAgICAgIHRva2VuOiBudWxsLFxuICAgICAgICAgICAgICAgIGxpbmU6IHRoaXMueXlsaW5lbm9cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSxcblxuLy8gcmV0dXJuIG5leHQgbWF0Y2ggdGhhdCBoYXMgYSB0b2tlblxubGV4OmZ1bmN0aW9uIGxleCgpIHtcbiAgICAgICAgdmFyIHIgPSB0aGlzLm5leHQoKTtcbiAgICAgICAgaWYgKHIpIHtcbiAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGV4KCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4vLyBhY3RpdmF0ZXMgYSBuZXcgbGV4ZXIgY29uZGl0aW9uIHN0YXRlIChwdXNoZXMgdGhlIG5ldyBsZXhlciBjb25kaXRpb24gc3RhdGUgb250byB0aGUgY29uZGl0aW9uIHN0YWNrKVxuYmVnaW46ZnVuY3Rpb24gYmVnaW4oY29uZGl0aW9uKSB7XG4gICAgICAgIHRoaXMuY29uZGl0aW9uU3RhY2sucHVzaChjb25kaXRpb24pO1xuICAgIH0sXG5cbi8vIHBvcCB0aGUgcHJldmlvdXNseSBhY3RpdmUgbGV4ZXIgY29uZGl0aW9uIHN0YXRlIG9mZiB0aGUgY29uZGl0aW9uIHN0YWNrXG5wb3BTdGF0ZTpmdW5jdGlvbiBwb3BTdGF0ZSgpIHtcbiAgICAgICAgdmFyIG4gPSB0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aCAtIDE7XG4gICAgICAgIGlmIChuID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uZGl0aW9uU3RhY2sucG9wKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb25kaXRpb25TdGFja1swXTtcbiAgICAgICAgfVxuICAgIH0sXG5cbi8vIHByb2R1Y2UgdGhlIGxleGVyIHJ1bGUgc2V0IHdoaWNoIGlzIGFjdGl2ZSBmb3IgdGhlIGN1cnJlbnRseSBhY3RpdmUgbGV4ZXIgY29uZGl0aW9uIHN0YXRlXG5fY3VycmVudFJ1bGVzOmZ1bmN0aW9uIF9jdXJyZW50UnVsZXMoKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aCAmJiB0aGlzLmNvbmRpdGlvblN0YWNrW3RoaXMuY29uZGl0aW9uU3RhY2subGVuZ3RoIC0gMV0pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmRpdGlvbnNbdGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aCAtIDFdXS5ydWxlcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmRpdGlvbnNbXCJJTklUSUFMXCJdLnJ1bGVzO1xuICAgICAgICB9XG4gICAgfSxcblxuLy8gcmV0dXJuIHRoZSBjdXJyZW50bHkgYWN0aXZlIGxleGVyIGNvbmRpdGlvbiBzdGF0ZTsgd2hlbiBhbiBpbmRleCBhcmd1bWVudCBpcyBwcm92aWRlZCBpdCBwcm9kdWNlcyB0aGUgTi10aCBwcmV2aW91cyBjb25kaXRpb24gc3RhdGUsIGlmIGF2YWlsYWJsZVxudG9wU3RhdGU6ZnVuY3Rpb24gdG9wU3RhdGUobikge1xuICAgICAgICBuID0gdGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGggLSAxIC0gTWF0aC5hYnMobiB8fCAwKTtcbiAgICAgICAgaWYgKG4gPj0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uZGl0aW9uU3RhY2tbbl07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJJTklUSUFMXCI7XG4gICAgICAgIH1cbiAgICB9LFxuXG4vLyBhbGlhcyBmb3IgYmVnaW4oY29uZGl0aW9uKVxucHVzaFN0YXRlOmZ1bmN0aW9uIHB1c2hTdGF0ZShjb25kaXRpb24pIHtcbiAgICAgICAgdGhpcy5iZWdpbihjb25kaXRpb24pO1xuICAgIH0sXG5cbi8vIHJldHVybiB0aGUgbnVtYmVyIG9mIHN0YXRlcyBjdXJyZW50bHkgb24gdGhlIHN0YWNrXG5zdGF0ZVN0YWNrU2l6ZTpmdW5jdGlvbiBzdGF0ZVN0YWNrU2l6ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uZGl0aW9uU3RhY2subGVuZ3RoO1xuICAgIH0sXG5vcHRpb25zOiB7fSxcbnBlcmZvcm1BY3Rpb246IGZ1bmN0aW9uIGFub255bW91cyh5eSx5eV8sJGF2b2lkaW5nX25hbWVfY29sbGlzaW9ucyxZWV9TVEFSVCkge1xudmFyIFlZU1RBVEU9WVlfU1RBUlQ7XG5zd2l0Y2goJGF2b2lkaW5nX25hbWVfY29sbGlzaW9ucykge1xuY2FzZSAwOi8qIHNraXAgd2hpdGVzcGFjZSAqL1xuYnJlYWs7XG5jYXNlIDE6cmV0dXJuIDdcbmJyZWFrO1xuY2FzZSAyOnJldHVybiA2XG5icmVhaztcbmNhc2UgMzpyZXR1cm4gOFxuYnJlYWs7XG5jYXNlIDQ6cmV0dXJuIDMyXG5icmVhaztcbmNhc2UgNTpyZXR1cm4gMzBcbmJyZWFrO1xuY2FzZSA2OnJldHVybiAzMFxuYnJlYWs7XG5jYXNlIDc6cmV0dXJuIDMxXG5icmVhaztcbmNhc2UgODpyZXR1cm4gMzFcbmJyZWFrO1xuY2FzZSA5OnJldHVybiA5XG5icmVhaztcbmNhc2UgMTA6cmV0dXJuIDEwXG5icmVhaztcbmNhc2UgMTE6cmV0dXJuICd8J1xuYnJlYWs7XG5jYXNlIDEyOnJldHVybiAxOVxuYnJlYWs7XG5jYXNlIDEzOnJldHVybiAxOFxuYnJlYWs7XG5jYXNlIDE0OnJldHVybiAyMVxuYnJlYWs7XG5jYXNlIDE1OnJldHVybiAyMFxuYnJlYWs7XG5jYXNlIDE2OnJldHVybiAxN1xuYnJlYWs7XG5jYXNlIDE3OnJldHVybiAxNlxuYnJlYWs7XG5jYXNlIDE4OnJldHVybiAxNVxuYnJlYWs7XG5jYXNlIDE5OnJldHVybiAyOVxuYnJlYWs7XG5jYXNlIDIwOnJldHVybiAyN1xuYnJlYWs7XG5jYXNlIDIxOnJldHVybiAyOFxuYnJlYWs7XG5jYXNlIDIyOnJldHVybiAyOFxuYnJlYWs7XG5jYXNlIDIzOnJldHVybiAyNVxuYnJlYWs7XG5jYXNlIDI0OnJldHVybiAnSU5WQUxJRCdcbmJyZWFrO1xuY2FzZSAyNTpyZXR1cm4gNVxuYnJlYWs7XG59XG59LFxucnVsZXM6IFsvXig/OlxccyspLywvXig/OkFORFxcYikvLC9eKD86T1JcXGIpLywvXig/Ok5PVFxcYikvLC9eKD86TlVMTFxcYikvLC9eKD86VFJVRVxcYikvLC9eKD86dHJ1ZVxcYikvLC9eKD86RkFMU0VcXGIpLywvXig/OmZhbHNlXFxiKS8sL14oPzpcXCgpLywvXig/OlxcKSkvLC9eKD86XFx8KS8sL14oPzo8PSkvLC9eKD86PCkvLC9eKD86Pj0pLywvXig/Oj4pLywvXig/OiE9KS8sL14oPzo9PSkvLC9eKD86PSkvLC9eKD86LT9bMC05XSsoXFwuWzAtOV0rKT9cXGIpLywvXig/OlthLXpBLVpfXVthLXpBLVowLTlfXSopLywvXig/OidbXlxcJ10qJykvLC9eKD86XCJbXlxcXCJdKlwiKS8sL14oPzpcXC4pLywvXig/Oi4pLywvXig/OiQpL10sXG5jb25kaXRpb25zOiB7XCJJTklUSUFMXCI6e1wicnVsZXNcIjpbMCwxLDIsMyw0LDUsNiw3LDgsOSwxMCwxMSwxMiwxMywxNCwxNSwxNiwxNywxOCwxOSwyMCwyMSwyMiwyMywyNCwyNV0sXCJpbmNsdXNpdmVcIjp0cnVlfX1cbn0pO1xucmV0dXJuIGxleGVyO1xufSkoKTtcbnBhcnNlci5sZXhlciA9IGxleGVyO1xuZnVuY3Rpb24gUGFyc2VyICgpIHtcbiAgdGhpcy55eSA9IHt9O1xufVxuUGFyc2VyLnByb3RvdHlwZSA9IHBhcnNlcjtwYXJzZXIuUGFyc2VyID0gUGFyc2VyO1xucmV0dXJuIG5ldyBQYXJzZXI7XG59KSgpO1xuXG5leHBvcnQgY29uc3QgYWNjZXNzUGFyc2VyID0gcGFyc2VyO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7YWNjZXNzUGFyc2VyIGFzIHBhcnNlcn0gZnJvbSAnLi9hY2Nlc3MtZXhwci1pbXBsJztcblxuXG4vKipcbiAqIEV2YWx1YXRlcyBhY2Nlc3MgZXhwcmVzc2lvbi5cbiAqXG4gKiBUaGUgZ3JhbW1hciBpcyBkZWZpbmVkIGluIHRoZSBgYWNjZXNzLWV4cHItaW1wbC5qaXNvbmAgYW5kIGNvbXBpbGVkIHVzaW5nXG4gKiAoSmlzb24pW2h0dHBzOi8vemFhY2guZ2l0aHViLmlvL2ppc29uL10gcGFyc2VyLiBUaGUgY29tcGlsYXRpb24gc3RlcHMgYXJlXG4gKiBkZXNjcmliZWQgaW4gdGhlIFthY2Nlc3MtZXhwci1pbXBsLm1kXS5cbiAqXG4gKiBHcmFtbWFyIGhpZ2hsaWdodHM6XG4gKiAtIFNob3J0aGFuZCB0cnV0aHkgZXhwcmVzc2lvbnMgYXJlIGFsbG93ZWQsIHN1Y2ggYXMgYGZpZWxkYC4gVHJ1dGh5IHZhbHVlXG4gKiAgIGlzIGRlZmluZWQgYXMgYFggIT09IG51bGwgJiYgWCAhPT0gJycgJiYgWCAhPT0gMCAmJiBYICE9PSBmYWxzZWAuXG4gKiAtIEJhc2ljIGVxdWFsaXR5IGV4cHJlc3Npb25zOiBgWCA9IDFgLCBgWCA9IHRydWVgLCBgWCA9IFwiQVwiYC4gQW5kIGFsc28sXG4gKiAgIG5vbi1lcXVhbGl0eTogYFggIT0gMWAgYW5kIHNvIG9uLlxuICogLSBCYXNpYyBjb21wYXJpc29uIGV4cHJlc3Npb25zIG9ubHkgZGVmaW5lZCBmb3IgbnVtYmVyczogYFggPCAxYCxcbiAqICAgYFggPj0gMTBgLlxuICogLSBCb29sZWFuIGxvZ2ljOiBgWCA9IDEgT1IgWSA9IDFgLCBgWCA9IDEgQU5EIFkgPSAyYCwgYE5PVCBYYCwgYE5PVCAoWCA9IDEpYC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gZXhwclxuICogQHBhcmFtIHshSnNvbk9iamVjdH0gZGF0YVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV2YWx1YXRlQWNjZXNzRXhwcihleHByLCBkYXRhKSB7XG4gIHRyeSB7XG4gICAgcGFyc2VyLnl5ID0gZGF0YTtcbiAgICByZXR1cm4gISFwYXJzZXIucGFyc2UoZXhwcik7XG4gIH0gZmluYWxseSB7XG4gICAgcGFyc2VyLnl5ID0gbnVsbDtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIGJhc2U2NFVybERlY29kZVRvQnl0ZXMsXG59IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9iYXNlNjQnO1xuaW1wb3J0IHtwZW1Ub0J5dGVzfSBmcm9tICcuLi8uLi8uLi9zcmMvdXRpbHMvcGVtJztcbmltcG9ydCB7c3RyaW5nVG9CeXRlcywgdXRmOERlY29kZX0gZnJvbSAnLi4vLi4vLi4vc3JjL3V0aWxzL2J5dGVzJztcbmltcG9ydCB7dHJ5UGFyc2VKc29ufSBmcm9tICcuLi8uLi8uLi9zcmMvanNvbic7XG5cblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBoZWFkZXI6ICg/SnNvbk9iamVjdHx1bmRlZmluZWQpLFxuICogICBwYXlsb2FkOiAoP0pzb25PYmplY3R8dW5kZWZpbmVkKSxcbiAqICAgdmVyaWZpYWJsZTogc3RyaW5nLFxuICogICBzaWc6IHN0cmluZyxcbiAqIH19XG4gKi9cbmxldCBKd3RUb2tlbkludGVybmFsRGVmO1xuXG5cbi8qKlxuICogUHJvdmlkZXMgaGVscGVyIG1ldGhvZHMgdG8gZGVjb2RlIGFuZCB2ZXJpZnkgSldUIHRva2Vucy5cbiAqL1xuZXhwb3J0IGNsYXNzIEp3dEhlbHBlciB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqL1xuICBjb25zdHJ1Y3Rvcih3aW4pIHtcblxuICAgIC8qKiBAY29uc3QgeyFXaW5kb3d9ICovXG4gICAgdGhpcy53aW4gPSB3aW47XG5cbiAgICAvKipcbiAgICAgKiBNaWdodCBiZSBgbnVsbGAgaWYgdGhlIHBsYXRmb3JtIGRvZXMgbm90IHN1cHBvcnQgQ3J5cHRvIFN1YnRsZS5cbiAgICAgKiBAY29uc3QgQHByaXZhdGUgez93ZWJDcnlwdG8uU3VidGxlQ3J5cHRvfVxuICAgICAqL1xuICAgIHRoaXMuc3VidGxlXyA9ICh3aW4uY3J5cHRvICYmXG4gICAgICAgICh3aW4uY3J5cHRvLnN1YnRsZSB8fCB3aW4uY3J5cHRvLndlYmtpdFN1YnRsZSkpIHx8IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogRGVjb2RlcyBKV1QgdG9rZW4gYW5kIHJldHVybnMgaXRzIHBheWxvYWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBlbmNvZGVkVG9rZW5cbiAgICogQHJldHVybiB7P0pzb25PYmplY3R8dW5kZWZpbmVkfVxuICAgKi9cbiAgZGVjb2RlKGVuY29kZWRUb2tlbikge1xuICAgIHJldHVybiB0aGlzLmRlY29kZUludGVybmFsXyhlbmNvZGVkVG9rZW4pLnBheWxvYWQ7XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciB0aGUgc2lnbmF0dXJlLXZlcmlmaWNhdGlvbiBzdXBwb3J0ZWQgb24gdGhpcyBwbGF0Zm9ybS5cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlzVmVyaWZpY2F0aW9uU3VwcG9ydGVkKCkge1xuICAgIHJldHVybiAhIXRoaXMuc3VidGxlXztcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWNvZGVzIEhXVCB0b2tlbiBhbmQgdmVyaWZpZXMgaXRzIHNpZ25hdHVyZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGVuY29kZWRUb2tlblxuICAgKiBAcGFyYW0geyFQcm9taXNlPHN0cmluZz59IHBlbVByb21pc2VcbiAgICogQHJldHVybiB7IVByb21pc2U8IUpzb25PYmplY3Q+fVxuICAgKi9cbiAgZGVjb2RlQW5kVmVyaWZ5KGVuY29kZWRUb2tlbiwgcGVtUHJvbWlzZSkge1xuICAgIGlmICghdGhpcy5zdWJ0bGVfKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NyeXB0byBpcyBub3Qgc3VwcG9ydGVkIG9uIHRoaXMgcGxhdGZvcm0nKTtcbiAgICB9XG4gICAgY29uc3QgZGVjb2RlZFByb21pc2UgPSBuZXcgUHJvbWlzZShcbiAgICAgICAgcmVzb2x2ZSA9PiByZXNvbHZlKHRoaXMuZGVjb2RlSW50ZXJuYWxfKGVuY29kZWRUb2tlbikpKTtcbiAgICByZXR1cm4gZGVjb2RlZFByb21pc2UudGhlbihkZWNvZGVkID0+IHtcbiAgICAgIGNvbnN0IGFsZyA9IGRlY29kZWQuaGVhZGVyWydhbGcnXTtcbiAgICAgIGlmICghYWxnIHx8IGFsZyAhPSAnUlMyNTYnKSB7XG4gICAgICAgIC8vIFRPRE8oZHZveXRlbmtvQCk6IFN1cHBvcnQgb3RoZXIgUlMqIGFsZ29zLlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ09ubHkgYWxnPVJTMjU2IGlzIHN1cHBvcnRlZCcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuaW1wb3J0S2V5XyhwZW1Qcm9taXNlKS50aGVuKGtleSA9PiB7XG4gICAgICAgIGNvbnN0IHNpZyA9IGJhc2U2NFVybERlY29kZVRvQnl0ZXMoZGVjb2RlZC5zaWcpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGVfLnZlcmlmeShcbiAgICAgICAgICAgIC8qIG9wdGlvbnMgKi8ge25hbWU6ICdSU0FTU0EtUEtDUzEtdjFfNSd9LFxuICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgc2lnLFxuICAgICAgICAgICAgc3RyaW5nVG9CeXRlcyhkZWNvZGVkLnZlcmlmaWFibGUpXG4gICAgICAgICk7XG4gICAgICB9KS50aGVuKGlzVmFsaWQgPT4ge1xuICAgICAgICBpZiAoaXNWYWxpZCkge1xuICAgICAgICAgIHJldHVybiBkZWNvZGVkLnBheWxvYWQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTaWduYXR1cmUgdmVyaWZpY2F0aW9uIGZhaWxlZCcpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IGVuY29kZWRUb2tlblxuICAgKiBAcmV0dXJuIHshSnd0VG9rZW5JbnRlcm5hbERlZn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGRlY29kZUludGVybmFsXyhlbmNvZGVkVG9rZW4pIHtcbiAgICAvKipcbiAgICAgKiBTZWUgaHR0cHM6Ly9qd3QuaW8vaW50cm9kdWN0aW9uL1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGludmFsaWRUb2tlbigpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCB0b2tlbjogXCIke2VuY29kZWRUb2tlbn1cImApO1xuICAgIH1cblxuICAgIC8vIEVuY29kZWQgdG9rZW4gaGFzIHRocmVlIHBhcnRzOiBoZWFkZXIucGF5bG9hZC5zaWdcbiAgICAvLyBOb3RlISBUaGUgcGFkZGluZyBpcyBub3QgYWxsb3dlZCBieSBKV1Qgc3BlYzpcbiAgICAvLyBodHRwOi8vc2VsZi1pc3N1ZWQuaW5mby9kb2NzL2RyYWZ0LWdvbGFuZC1qc29uLXdlYi10b2tlbi0wMC5odG1sI3JmYy5zZWN0aW9uLjVcbiAgICBjb25zdCBwYXJ0cyA9IGVuY29kZWRUb2tlbi5zcGxpdCgnLicpO1xuICAgIGlmIChwYXJ0cy5sZW5ndGggIT0gMykge1xuICAgICAgaW52YWxpZFRva2VuKCk7XG4gICAgfVxuICAgIGNvbnN0IGhlYWRlclV0ZjhCeXRlcyA9IGJhc2U2NFVybERlY29kZVRvQnl0ZXMocGFydHNbMF0pO1xuICAgIGNvbnN0IHBheWxvYWRVdGY4Qnl0ZXMgPSBiYXNlNjRVcmxEZWNvZGVUb0J5dGVzKHBhcnRzWzFdKTtcbiAgICByZXR1cm4ge1xuICAgICAgaGVhZGVyOiB0cnlQYXJzZUpzb24odXRmOERlY29kZShoZWFkZXJVdGY4Qnl0ZXMpLCBpbnZhbGlkVG9rZW4pLFxuICAgICAgcGF5bG9hZDogdHJ5UGFyc2VKc29uKHV0ZjhEZWNvZGUocGF5bG9hZFV0ZjhCeXRlcyksIGludmFsaWRUb2tlbiksXG4gICAgICB2ZXJpZmlhYmxlOiBgJHtwYXJ0c1swXX0uJHtwYXJ0c1sxXX1gLFxuICAgICAgc2lnOiBwYXJ0c1syXSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVByb21pc2U8c3RyaW5nPn0gcGVtUHJvbWlzZVxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhd2ViQ3J5cHRvLkNyeXB0b0tleT59XG4gICAqL1xuICBpbXBvcnRLZXlfKHBlbVByb21pc2UpIHtcbiAgICByZXR1cm4gcGVtUHJvbWlzZS50aGVuKHBlbSA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5zdWJ0bGVfLmltcG9ydEtleShcbiAgICAgICAgICAvKiBmb3JtYXQgKi8gJ3Nwa2knLFxuICAgICAgICAgIHBlbVRvQnl0ZXMocGVtKSxcbiAgICAgICAgICAvKiBhbGdvIG9wdGlvbnMgKi8ge1xuICAgICAgICAgICAgbmFtZTogJ1JTQVNTQS1QS0NTMS12MV81JyxcbiAgICAgICAgICAgIGhhc2g6IHtuYW1lOiAnU0hBLTI1Nid9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgLyogZXh0cmFjdGFibGUgKi8gZmFsc2UsXG4gICAgICAgICAgLyogdXNlcyAqLyBbJ3ZlcmlmeSddKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4uLy4uLy4uL3NyYy9zZXJ2aWNlcyc7XG5pbXBvcnQge2RldiwgdXNlcn0gZnJvbSAnLi4vLi4vLi4vc3JjL2xvZyc7XG5pbXBvcnQge2RpY3R9IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtnZXREYXRhLCBsaXN0ZW59IGZyb20gJy4uLy4uLy4uL3NyYy9ldmVudC1oZWxwZXInO1xuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuLi8uLi8uLi9zcmMvbW9kZSc7XG5pbXBvcnQge29wZW5XaW5kb3dEaWFsb2d9IGZyb20gJy4uLy4uLy4uL3NyYy9kb20nO1xuaW1wb3J0IHtwYXJzZVVybERlcHJlY2F0ZWR9IGZyb20gJy4uLy4uLy4uL3NyYy91cmwnO1xuaW1wb3J0IHt1cmxzfSBmcm9tICcuLi8uLi8uLi9zcmMvY29uZmlnJztcblxuLyoqIEBjb25zdCAqL1xuY29uc3QgVEFHID0gJ2FtcC1hY2Nlc3MtbG9naW4nO1xuXG4vKiogQGNvbnN0IHshUmVnRXhwfSAqL1xuY29uc3QgUkVUVVJOX1VSTF9SRUdFWCA9IG5ldyBSZWdFeHAoJ1JFVFVSTl9VUkwnKTtcblxuLyoqXG4gKiBAcGFyYW0geyEuLi8uLi8uLi9zcmMvc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICogQHBhcmFtIHtzdHJpbmd8IVByb21pc2U8c3RyaW5nPn0gdXJsT3JQcm9taXNlXG4gKiBAcmV0dXJuIHshV2ViTG9naW5EaWFsb2d8IVZpZXdlckxvZ2luRGlhbG9nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTG9naW5EaWFsb2coYW1wZG9jLCB1cmxPclByb21pc2UpIHtcbiAgY29uc3Qgdmlld2VyID0gU2VydmljZXMudmlld2VyRm9yRG9jKGFtcGRvYyk7XG4gIGNvbnN0IG92ZXJyaWRlRGlhbG9nID0gcGFyc2VJbnQodmlld2VyLmdldFBhcmFtKCdkaWFsb2cnKSwgMTApO1xuICBpZiAob3ZlcnJpZGVEaWFsb2cpIHtcbiAgICByZXR1cm4gbmV3IFZpZXdlckxvZ2luRGlhbG9nKHZpZXdlciwgdXJsT3JQcm9taXNlKTtcbiAgfVxuICByZXR1cm4gbmV3IFdlYkxvZ2luRGlhbG9nKGFtcGRvYy53aW4sIHZpZXdlciwgdXJsT3JQcm9taXNlKTtcbn1cblxuXG4vKipcbiAqIE9wZW5zIHRoZSBsb2dpbiBkaWFsb2cgZm9yIHRoZSBzcGVjaWZpZWQgVVJMLiBJZiB0aGUgbG9naW4gZGlhbG9nIHN1Y2NlZWRzLFxuICogdGhlIHJldHVybmVkIHByb21pc2VkIGlzIHJlc29sdmVkIHdpdGggdGhlIGRpYWxvZydzIHJlc3BvbnNlLiBPdGhlcndpc2UsIHRoZVxuICogcmV0dXJuZWQgcHJvbWlzZSBpcyByZWplY3RlZC5cbiAqIEBwYXJhbSB7IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gKiBAcGFyYW0ge3N0cmluZ3whUHJvbWlzZTxzdHJpbmc+fSB1cmxPclByb21pc2VcbiAqIEByZXR1cm4geyFQcm9taXNlPHN0cmluZz59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvcGVuTG9naW5EaWFsb2coYW1wZG9jLCB1cmxPclByb21pc2UpIHtcbiAgcmV0dXJuIGNyZWF0ZUxvZ2luRGlhbG9nKGFtcGRvYywgdXJsT3JQcm9taXNlKS5vcGVuKCk7XG59XG5cbi8qKlxuICogR2V0cyB0aGUgZmluYWwgbG9naW4gVVJMIHdpdGggYWxsIHRoZSBwZXJmb3JtZWQgcmVwbGFjZW1lbnRzLlxuICogQHBhcmFtIHshLi4vLi4vLi4vc3JjL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAqIEBwYXJhbSB7c3RyaW5nfCFQcm9taXNlPHN0cmluZz59IHVybE9yUHJvbWlzZVxuICogQHJldHVybiB7IVByb21pc2U8c3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExvZ2luVXJsKGFtcGRvYywgdXJsT3JQcm9taXNlKSB7XG4gIHJldHVybiBjcmVhdGVMb2dpbkRpYWxvZyhhbXBkb2MsIHVybE9yUHJvbWlzZSkuZ2V0TG9naW5VcmwoKTtcbn1cblxuXG4vKipcbiAqIFRoZSBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgTG9naW4gRGlhbG9nIGRlbGVnYXRlZCB2aWEgVmlld2VyLlxuICovXG5jbGFzcyBWaWV3ZXJMb2dpbkRpYWxvZyB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyEuLi8uLi8uLi9zcmMvc2VydmljZS92aWV3ZXItaW1wbC5WaWV3ZXJ9IHZpZXdlclxuICAgKiBAcGFyYW0ge3N0cmluZ3whUHJvbWlzZTxzdHJpbmc+fSB1cmxPclByb21pc2VcbiAgICovXG4gIGNvbnN0cnVjdG9yKHZpZXdlciwgdXJsT3JQcm9taXNlKSB7XG4gICAgLyoqIEBjb25zdCB7IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcn0gKi9cbiAgICB0aGlzLnZpZXdlciA9IHZpZXdlcjtcblxuICAgIC8qKiBAY29uc3Qge3N0cmluZ3whUHJvbWlzZTxzdHJpbmc+fSAqL1xuICAgIHRoaXMudXJsT3JQcm9taXNlID0gdXJsT3JQcm9taXNlO1xuICB9XG5cbiAgLyoqXG4gICogQHJldHVybiB7IVByb21pc2U8c3RyaW5nPn1cbiAgKi9cbiAgZ2V0TG9naW5VcmwoKSB7XG4gICAgbGV0IHVybFByb21pc2U7XG4gICAgaWYgKHR5cGVvZiB0aGlzLnVybE9yUHJvbWlzZSA9PSAnc3RyaW5nJykge1xuICAgICAgdXJsUHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSh0aGlzLnVybE9yUHJvbWlzZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVybFByb21pc2UgPSB0aGlzLnVybE9yUHJvbWlzZTtcbiAgICB9XG4gICAgcmV0dXJuIHVybFByb21pc2UudGhlbih1cmwgPT4ge1xuICAgICAgcmV0dXJuIGJ1aWxkTG9naW5VcmwodXJsLCAnUkVUVVJOX1VSTCcpO1xuICAgIH0pO1xuICB9XG5cblxuICAvKipcbiAgICogT3BlbnMgdGhlIGRpYWxvZy4gUmV0dXJucyB0aGUgcHJvbWlzZSB0aGF0IHdpbGwgeWllbGQgd2l0aCB0aGUgZGlhbG9nJ3NcbiAgICogcmVzdWx0IG9yIHdpbGwgYmUgcmVqZWN0ZWQgaWYgZGlhbG9nIGZhaWxzLiBUaGUgZGlhbG9nJ3MgcmVzdWx0IGlzXG4gICAqIHR5cGljYWxseSBhIGhhc2ggc3RyaW5nIGZyb20gdGhlIHJldHVybiBVUkwuXG4gICAqIEByZXR1cm4geyFQcm9taXNlPHN0cmluZz59XG4gICAqL1xuICBvcGVuKCkge1xuICAgIHJldHVybiB0aGlzLmdldExvZ2luVXJsKCkudGhlbihsb2dpblVybCA9PiB7XG4gICAgICBkZXYoKS5maW5lKFRBRywgJ09wZW4gdmlld2VyIGRpYWxvZzogJywgbG9naW5VcmwpO1xuICAgICAgcmV0dXJuIHRoaXMudmlld2VyLnNlbmRNZXNzYWdlQXdhaXRSZXNwb25zZSgnb3BlbkRpYWxvZycsIGRpY3Qoe1xuICAgICAgICAndXJsJzogbG9naW5VcmwsXG4gICAgICB9KSk7XG4gICAgfSk7XG4gIH1cblxufVxuXG5cbi8qKlxuICogV2ViLWJhc2VkIGltcGxlbWVudGF0aW9uIG9mIHRoZSBMb2dpbiBEaWFsb2cuXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGNsYXNzIFdlYkxvZ2luRGlhbG9nIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEBwYXJhbSB7IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcn0gdmlld2VyXG4gICAqIEBwYXJhbSB7c3RyaW5nfCFQcm9taXNlPHN0cmluZz59IHVybE9yUHJvbWlzZVxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luLCB2aWV3ZXIsIHVybE9yUHJvbWlzZSkge1xuICAgIC8qKiBAY29uc3QgeyFXaW5kb3d9ICovXG4gICAgdGhpcy53aW4gPSB3aW47XG5cbiAgICAvKiogQGNvbnN0IHshLi4vLi4vLi4vc3JjL3NlcnZpY2Uvdmlld2VyLWltcGwuVmlld2VyfSAqL1xuICAgIHRoaXMudmlld2VyID0gdmlld2VyO1xuXG4gICAgLyoqIEBjb25zdCB7c3RyaW5nfCFQcm9taXNlPHN0cmluZz59ICovXG4gICAgdGhpcy51cmxPclByb21pc2UgPSB1cmxPclByb21pc2U7XG5cbiAgICAvKiogQHByaXZhdGUgez9mdW5jdGlvbig/c3RyaW5nKX0gKi9cbiAgICB0aGlzLnJlc29sdmVfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P2Z1bmN0aW9uKCopfSAqL1xuICAgIHRoaXMucmVqZWN0XyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUgez9XaW5kb3d9ICovXG4gICAgdGhpcy5kaWFsb2dfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P1Byb21pc2V9ICovXG4gICAgdGhpcy5kaWFsb2dSZWFkeVByb21pc2VfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P251bWJlcn0gKi9cbiAgICB0aGlzLmhlYXJ0YmVhdEludGVydmFsXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUgez9Vbmxpc3RlbkRlZn0gKi9cbiAgICB0aGlzLm1lc3NhZ2VVbmxpc3Rlbl8gPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIE9wZW5zIHRoZSBkaWFsb2cuIFJldHVybnMgdGhlIHByb21pc2UgdGhhdCB3aWxsIHlpZWxkIHdpdGggdGhlIGRpYWxvZydzXG4gICAqIHJlc3VsdCBvciB3aWxsIGJlIHJlamVjdGVkIGlmIGRpYWxvZyBmYWlscy5cbiAgICogQHJldHVybiB7IVByb21pc2U8c3RyaW5nPn1cbiAgICovXG4gIG9wZW4oKSB7XG4gICAgdXNlcigpLmFzc2VydCghdGhpcy5yZXNvbHZlXywgJ0RpYWxvZyBhbHJlYWR5IG9wZW5lZCcpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0aGlzLnJlc29sdmVfID0gcmVzb2x2ZTtcbiAgICAgIHRoaXMucmVqZWN0XyA9IHJlamVjdDtcbiAgICAgIC8vIE11c3QgYWx3YXlzIGJlIGNhbGxlZCBzeW5jaHJvbm91c2x5LlxuICAgICAgdGhpcy5vcGVuSW50ZXJuYWxfKCk7XG4gICAgfSkudGhlbihyZXN1bHQgPT4ge1xuICAgICAgdGhpcy5jbGVhbnVwXygpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LCBlcnJvciA9PiB7XG4gICAgICB0aGlzLmNsZWFudXBfKCk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBAcHJpdmF0ZSAqL1xuICBjbGVhbnVwXygpIHtcbiAgICB0aGlzLnJlc29sdmVfID0gbnVsbDtcbiAgICB0aGlzLnJlamVjdF8gPSBudWxsO1xuXG4gICAgaWYgKHRoaXMuZGlhbG9nXykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy5kaWFsb2dfLmNsb3NlKCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8vIElnbm9yZS5cbiAgICAgIH1cbiAgICAgIHRoaXMuZGlhbG9nXyA9IG51bGw7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaGVhcnRiZWF0SW50ZXJ2YWxfKSB7XG4gICAgICB0aGlzLndpbi5jbGVhckludGVydmFsKHRoaXMuaGVhcnRiZWF0SW50ZXJ2YWxfKTtcbiAgICAgIHRoaXMuaGVhcnRiZWF0SW50ZXJ2YWxfID0gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5tZXNzYWdlVW5saXN0ZW5fKSB7XG4gICAgICB0aGlzLm1lc3NhZ2VVbmxpc3Rlbl8oKTtcbiAgICAgIHRoaXMubWVzc2FnZVVubGlzdGVuXyA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICogQHJldHVybiB7IVByb21pc2U8c3RyaW5nPn1cbiAgKi9cbiAgZ2V0TG9naW5VcmwoKSB7XG4gICAgbGV0IHVybFByb21pc2U7XG4gICAgaWYgKHR5cGVvZiB0aGlzLnVybE9yUHJvbWlzZSA9PSAnc3RyaW5nJykge1xuICAgICAgdXJsUHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSh0aGlzLnVybE9yUHJvbWlzZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVybFByb21pc2UgPSB0aGlzLnVybE9yUHJvbWlzZTtcbiAgICB9XG4gICAgcmV0dXJuIHVybFByb21pc2UudGhlbih1cmwgPT4ge1xuICAgICAgcmV0dXJuIGJ1aWxkTG9naW5VcmwodXJsLCB0aGlzLmdldFJldHVyblVybF8oKSk7XG4gICAgfSk7XG4gIH1cblxuICAvKiogQHByaXZhdGUgKi9cbiAgb3BlbkludGVybmFsXygpIHtcbiAgICBjb25zdCB7c2NyZWVufSA9IHRoaXMud2luO1xuICAgIGNvbnN0IHcgPSBNYXRoLmZsb29yKE1hdGgubWluKDcwMCwgc2NyZWVuLndpZHRoICogMC45KSk7XG4gICAgY29uc3QgaCA9IE1hdGguZmxvb3IoTWF0aC5taW4oNDUwLCBzY3JlZW4uaGVpZ2h0ICogMC45KSk7XG4gICAgY29uc3QgeCA9IE1hdGguZmxvb3IoKHNjcmVlbi53aWR0aCAtIHcpIC8gMik7XG4gICAgY29uc3QgeSA9IE1hdGguZmxvb3IoKHNjcmVlbi5oZWlnaHQgLSBoKSAvIDIpO1xuICAgIGNvbnN0IHNpemluZyA9IGBoZWlnaHQ9JHtofSx3aWR0aD0ke3d9LGxlZnQ9JHt4fSx0b3A9JHt5fWA7XG4gICAgY29uc3Qgb3B0aW9ucyA9IGAke3NpemluZ30scmVzaXphYmxlPXllcyxzY3JvbGxiYXJzPXllc2A7XG4gICAgY29uc3QgcmV0dXJuVXJsID0gdGhpcy5nZXRSZXR1cm5VcmxfKCk7XG5cbiAgICB0aGlzLmRpYWxvZ1JlYWR5UHJvbWlzZV8gPSBudWxsO1xuICAgIGlmICh0eXBlb2YgdGhpcy51cmxPclByb21pc2UgPT0gJ3N0cmluZycpIHtcbiAgICAgIGNvbnN0IGxvZ2luVXJsID0gYnVpbGRMb2dpblVybCh0aGlzLnVybE9yUHJvbWlzZSwgcmV0dXJuVXJsKTtcbiAgICAgIGRldigpLmZpbmUoVEFHLCAnT3BlbiBkaWFsb2c6ICcsIGxvZ2luVXJsLCByZXR1cm5VcmwsIHcsIGgsIHgsIHkpO1xuICAgICAgdGhpcy5kaWFsb2dfID0gb3BlbldpbmRvd0RpYWxvZyh0aGlzLndpbiwgbG9naW5VcmwsICdfYmxhbmsnLCBvcHRpb25zKTtcbiAgICAgIGlmICh0aGlzLmRpYWxvZ18pIHtcbiAgICAgICAgdGhpcy5kaWFsb2dSZWFkeVByb21pc2VfID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGRldigpLmZpbmUoVEFHLCAnT3BlbiBkaWFsb2c6ICcsICdhYm91dDpibGFuaycsIHJldHVyblVybCwgdywgaCwgeCwgeSk7XG4gICAgICB0aGlzLmRpYWxvZ18gPSBvcGVuV2luZG93RGlhbG9nKHRoaXMud2luLCAnJywgJ19ibGFuaycsIG9wdGlvbnMpO1xuICAgICAgaWYgKHRoaXMuZGlhbG9nXykge1xuICAgICAgICB0aGlzLmRpYWxvZ1JlYWR5UHJvbWlzZV8gPSB0aGlzLnVybE9yUHJvbWlzZS50aGVuKHVybCA9PiB7XG4gICAgICAgICAgY29uc3QgbG9naW5VcmwgPSBidWlsZExvZ2luVXJsKHVybCwgcmV0dXJuVXJsKTtcbiAgICAgICAgICBkZXYoKS5maW5lKFRBRywgJ1NldCBkaWFsb2cgdXJsOiAnLCBsb2dpblVybCk7XG4gICAgICAgICAgdGhpcy5kaWFsb2dfLmxvY2F0aW9uLnJlcGxhY2UobG9naW5VcmwpO1xuICAgICAgICB9LCBlcnJvciA9PiB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdmYWlsZWQgdG8gcmVzb2x2ZSB1cmw6ICcgKyBlcnJvcik7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLmRpYWxvZ1JlYWR5UHJvbWlzZV8pIHtcbiAgICAgIHRoaXMuZGlhbG9nUmVhZHlQcm9taXNlXy50aGVuKCgpID0+IHtcbiAgICAgICAgdGhpcy5zZXR1cERpYWxvZ18ocmV0dXJuVXJsKTtcbiAgICAgIH0sIGVycm9yID0+IHtcbiAgICAgICAgdGhpcy5sb2dpbkRvbmVfKC8qIHJlc3VsdCAqLyBudWxsLCBlcnJvcik7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5sb2dpbkRvbmVfKC8qIHJlc3VsdCAqLyBudWxsLCBuZXcgRXJyb3IoJ2ZhaWxlZCB0byBvcGVuIGRpYWxvZycpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IHJldHVyblVybFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc2V0dXBEaWFsb2dfKHJldHVyblVybCkge1xuICAgIGNvbnN0IHJldHVybk9yaWdpbiA9IHBhcnNlVXJsRGVwcmVjYXRlZChyZXR1cm5VcmwpLm9yaWdpbjtcblxuICAgIHRoaXMuaGVhcnRiZWF0SW50ZXJ2YWxfID0gdGhpcy53aW4uc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuZGlhbG9nXy5jbG9zZWQpIHtcbiAgICAgICAgdGhpcy53aW4uY2xlYXJJbnRlcnZhbCh0aGlzLmhlYXJ0YmVhdEludGVydmFsXyk7XG4gICAgICAgIHRoaXMuaGVhcnRiZWF0SW50ZXJ2YWxfID0gbnVsbDtcbiAgICAgICAgLy8gR2l2ZSBhIGNoYW5jZSBmb3IgdGhlIHJlc3VsdCB0byBhcnJpdmUsIGJ1dCBvdGhlcndpc2UgY29uc2lkZXIgdGhlXG4gICAgICAgIC8vIHJlc3BvbmNlIHRvIGJlIGVtcHR5LlxuICAgICAgICB0aGlzLndpbi5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0aGlzLmxvZ2luRG9uZV8oJycpO1xuICAgICAgICB9LCAzMDAwKTtcbiAgICAgIH1cbiAgICB9LCA1MDApO1xuXG4gICAgdGhpcy5tZXNzYWdlVW5saXN0ZW5fID0gbGlzdGVuKHRoaXMud2luLCAnbWVzc2FnZScsIGUgPT4ge1xuICAgICAgZGV2KCkuZmluZShUQUcsICdNRVNTQUdFOicsIGUpO1xuICAgICAgaWYgKGUub3JpZ2luICE9IHJldHVybk9yaWdpbikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoIWdldERhdGEoZSkgfHwgZ2V0RGF0YShlKVsnc2VudGluZWwnXSAhPSAnYW1wJykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBkZXYoKS5maW5lKFRBRywgJ1JlY2VpdmVkIG1lc3NhZ2UgZnJvbSBkaWFsb2c6ICcsIGdldERhdGEoZSkpO1xuICAgICAgaWYgKGdldERhdGEoZSlbJ3R5cGUnXSA9PSAncmVzdWx0Jykge1xuICAgICAgICBpZiAodGhpcy5kaWFsb2dfKSB7XG4gICAgICAgICAgdGhpcy5kaWFsb2dfLi8qT0sqL3Bvc3RNZXNzYWdlKGRpY3Qoe1xuICAgICAgICAgICAgJ3NlbnRpbmVsJzogJ2FtcCcsXG4gICAgICAgICAgICAndHlwZSc6ICdyZXN1bHQtYWNrJyxcbiAgICAgICAgICB9KSwgcmV0dXJuT3JpZ2luKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxvZ2luRG9uZV8oZ2V0RGF0YShlKVsncmVzdWx0J10pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7P3N0cmluZ30gcmVzdWx0XG4gICAqIEBwYXJhbSB7Kj19IG9wdF9lcnJvclxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgbG9naW5Eb25lXyhyZXN1bHQsIG9wdF9lcnJvcikge1xuICAgIGlmICghdGhpcy5yZXNvbHZlXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkZXYoKS5maW5lKFRBRywgJ0xvZ2luIGRvbmU6ICcsIHJlc3VsdCwgb3B0X2Vycm9yKTtcbiAgICBpZiAob3B0X2Vycm9yKSB7XG4gICAgICB0aGlzLnJlamVjdF8ob3B0X2Vycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZXNvbHZlXyhyZXN1bHQpO1xuICAgIH1cbiAgICB0aGlzLmNsZWFudXBfKCk7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7c3RyaW5nfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0UmV0dXJuVXJsXygpIHtcbiAgICBjb25zdCBjdXJyZW50VXJsID0gdGhpcy52aWV3ZXIuZ2V0UmVzb2x2ZWRWaWV3ZXJVcmwoKTtcbiAgICBsZXQgcmV0dXJuVXJsO1xuICAgIGlmIChnZXRNb2RlKCkubG9jYWxEZXYpIHtcbiAgICAgIGNvbnN0IGxvYyA9IHRoaXMud2luLmxvY2F0aW9uO1xuICAgICAgcmV0dXJuVXJsID0gbG9jLnByb3RvY29sICsgJy8vJyArIGxvYy5ob3N0ICtcbiAgICAgICAgICAnL2V4dGVuc2lvbnMvYW1wLWFjY2Vzcy8wLjEvYW1wLWxvZ2luLWRvbmUuaHRtbCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVyblVybCA9IGAke3VybHMuY2RufS92MC9hbXAtbG9naW4tZG9uZS0wLjEuaHRtbGA7XG4gICAgfVxuICAgIHJldHVybiByZXR1cm5VcmwgKyAnP3VybD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGN1cnJlbnRVcmwpO1xuICB9XG59XG5cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0ge3N0cmluZ30gcmV0dXJuVXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBidWlsZExvZ2luVXJsKHVybCwgcmV0dXJuVXJsKSB7XG4gIC8vIFJFVFVSTl9VUkwgaGFzIHRvIGFycml2ZSBoZXJlIHVucmVwbGFjZWQgYnkgVXJsUmVwbGFjZW1lbnRzIGZvciB0d29cbiAgLy8gcmVhc29uczogKDEpIHN5bmMgcmVwbGFjZW1lbnQgYW5kICgyKSBpZiB3ZSBuZWVkIHRvIHByb3BhZ2F0ZSB0aGlzXG4gIC8vIHJlcGxhY2VtZW50IHRvIHRoZSB2aWV3ZXIuXG4gIGlmIChSRVRVUk5fVVJMX1JFR0VYLnRlc3QodXJsKSkge1xuICAgIHJldHVybiB1cmwucmVwbGFjZShSRVRVUk5fVVJMX1JFR0VYLCBlbmNvZGVVUklDb21wb25lbnQocmV0dXJuVXJsKSk7XG4gIH1cbiAgcmV0dXJuIHVybCArXG4gICAgICAodXJsLmluZGV4T2YoJz8nKSA9PSAtMSA/ICc/JyA6ICcmJykgK1xuICAgICAgJ3JldHVybj0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHJldHVyblVybCk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHthc3NlcnRIdHRwc1VybH0gZnJvbSAnLi4vLi4vLi4vc3JjL3VybCc7XG5pbXBvcnQge2RldiwgdXNlcn0gZnJvbSAnLi4vLi4vLi4vc3JjL2xvZyc7XG5pbXBvcnQge2RpY3R9IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtvcGVuTG9naW5EaWFsb2d9IGZyb20gJy4uLy4uL2FtcC1hY2Nlc3MvMC4xL2xvZ2luLWRpYWxvZyc7XG5pbXBvcnQge3BhcnNlUXVlcnlTdHJpbmd9IGZyb20gJy4uLy4uLy4uL3NyYy91cmwnO1xuXG4vKiogQGNvbnN0ICovXG5jb25zdCBUQUcgPSAnYW1wLXN1YnNjcmlwdGlvbnMnO1xuXG5cbi8qKlxuICovXG5leHBvcnQgY2xhc3MgQWN0aW9ucyB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gICAqIEBwYXJhbSB7IS4vdXJsLWJ1aWxkZXIuVXJsQnVpbGRlcn0gdXJsQnVpbGRlclxuICAgKiBAcGFyYW0geyEuL2FuYWx5dGljcy5TdWJzY3JpcHRpb25BbmFseXRpY3N9IGFuYWx5dGljc1xuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBhY3Rpb25NYXBcbiAgICovXG4gIGNvbnN0cnVjdG9yKGFtcGRvYywgdXJsQnVpbGRlciwgYW5hbHl0aWNzLCBhY3Rpb25NYXApIHtcbiAgICAvLyBDaGVjayB0aGF0IGFsbCBVUkxzIGFyZSB2YWxpZC5cbiAgICBmb3IgKGNvbnN0IGsgaW4gYWN0aW9uTWFwKSB7XG4gICAgICBhc3NlcnRIdHRwc1VybChhY3Rpb25NYXBba10sIGBhY3Rpb24gJHtrfWApO1xuICAgIH1cblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSAqL1xuICAgIHRoaXMuYWN0aW9uc0NvbmZpZ18gPSBhY3Rpb25NYXA7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59ICovXG4gICAgdGhpcy5idWlsdEFjdGlvblVybE1hcF8gPSBkaWN0KCk7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IS4vdXJsLWJ1aWxkZXIuVXJsQnVpbGRlcn0gKi9cbiAgICB0aGlzLnVybEJ1aWxkZXJfID0gdXJsQnVpbGRlcjtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshLi9hbmFseXRpY3MuU3Vic2NyaXB0aW9uQW5hbHl0aWNzfSAqL1xuICAgIHRoaXMuYW5hbHl0aWNzXyA9IGFuYWx5dGljcztcbiAgICAvKiogQHByaXZhdGUgez9Qcm9taXNlfSAqL1xuICAgIHRoaXMuYWN0aW9uUHJvbWlzZV8gPSBudWxsO1xuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMuYWN0aW9uU3RhcnRUaW1lXyA9IDA7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7ZnVuY3Rpb24oc3RyaW5nKTpQcm9taXNlPHN0cmluZz59ICovXG4gICAgdGhpcy5vcGVuUG9wdXBfID0gb3BlbkxvZ2luRGlhbG9nLmJpbmQobnVsbCwgYW1wZG9jKTtcblxuICAgIC8vIEJ1aWxkIGFsbCBVUkxzLlxuICAgIHRoaXMuYnVpbGQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHs/UHJvbWlzZTwhT2JqZWN0PHN0cmluZywgc3RyaW5nPj59XG4gICAqL1xuICBidWlsZCgpIHtcbiAgICBpZiAoT2JqZWN0LmtleXModGhpcy5hY3Rpb25zQ29uZmlnXykubGVuZ3RoID09IDApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBwcm9taXNlcyA9IFtdO1xuICAgIGZvciAoY29uc3QgayBpbiB0aGlzLmFjdGlvbnNDb25maWdfKSB7XG4gICAgICBwcm9taXNlcy5wdXNoKHRoaXMudXJsQnVpbGRlcl8uYnVpbGRVcmwoXG4gICAgICAgICAgdGhpcy5hY3Rpb25zQ29uZmlnX1trXSwgLyogdXNlQXV0aERhdGEgKi8gdHJ1ZSlcbiAgICAgICAgICAudGhlbih1cmwgPT4ge1xuICAgICAgICAgICAgdGhpcy5idWlsdEFjdGlvblVybE1hcF9ba10gPSB1cmw7XG4gICAgICAgICAgfSkpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oKCkgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuYnVpbHRBY3Rpb25VcmxNYXBfO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpb25cbiAgICogQHJldHVybiB7IVByb21pc2U8c3RyaW5nPn1cbiAgICovXG4gIGV4ZWN1dGUoYWN0aW9uKSB7XG4gICAgdXNlcigpLmFzc2VydCh0aGlzLmFjdGlvbnNDb25maWdfW2FjdGlvbl0sXG4gICAgICAgICdBY3Rpb24gVVJMIGlzIG5vdCBjb25maWd1cmVkOiAlcycsIGFjdGlvbik7XG4gICAgLy8gVVJMIHNob3VsZCBhbHdheXMgYmUgYXZhaWxhYmxlIGF0IHRoaXMgdGltZS5cbiAgICBjb25zdCB1cmwgPSB1c2VyKCkuYXNzZXJ0KHRoaXMuYnVpbHRBY3Rpb25VcmxNYXBfW2FjdGlvbl0sXG4gICAgICAgICdBY3Rpb24gVVJMIGlzIG5vdCByZWFkeTogJXMnLCBhY3Rpb24pO1xuICAgIHJldHVybiB0aGlzLmV4ZWN1dGVfKHVybCwgJ3N1YnNjcmlwdGlvbnMtYWN0aW9uLScgKyBhY3Rpb24pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAgICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50TGFiZWxcbiAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBleGVjdXRlXyh1cmwsIGV2ZW50TGFiZWwpIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuXG4gICAgLy8gSWYgYWN0aW9uIGlzIHBlbmRpbmcsIGJsb2NrIGEgbmV3IG9uZSBmcm9tIHN0YXJ0aW5nIGZvciAxIHNlY29uZC4gQWZ0ZXJcbiAgICAvLyAxIHNlY29uZCwgaG93ZXZlciwgdGhlIG5ldyBhY3Rpb24gcmVxdWVzdCB3aWxsIGJlIGFsbG93ZWQgdG8gcHJvY2VlZCxcbiAgICAvLyBnaXZlbiB0aGF0IHdlIGNhbm5vdCBhbHdheXMgZGV0ZXJtaW5lIGZ1bGx5IGlmIHRoZSBwcmV2aW91cyBhdHRlbXB0IGlzXG4gICAgLy8gXCJzdHVja1wiLlxuICAgIGlmICh0aGlzLmFjdGlvblByb21pc2VfICYmIChub3cgLSB0aGlzLmFjdGlvblN0YXJ0VGltZV8gPCAxMDAwKSkge1xuICAgICAgcmV0dXJuIHRoaXMuYWN0aW9uUHJvbWlzZV87XG4gICAgfVxuXG4gICAgZGV2KCkuZmluZShUQUcsICdTdGFydCBhY3Rpb246ICcsIHVybCwgZXZlbnRMYWJlbCk7XG5cbiAgICB0aGlzLmFuYWx5dGljc18uZXZlbnQoZXZlbnRMYWJlbCArICctc3RhcnRlZCcpO1xuICAgIGNvbnN0IGRpYWxvZ1Byb21pc2UgPSB0aGlzLm9wZW5Qb3B1cF8odXJsKTtcbiAgICBjb25zdCBhY3Rpb25Qcm9taXNlID0gZGlhbG9nUHJvbWlzZS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICBkZXYoKS5maW5lKFRBRywgJ0FjdGlvbiBjb21wbGV0ZWQ6ICcsIGV2ZW50TGFiZWwsIHJlc3VsdCk7XG4gICAgICB0aGlzLmFjdGlvblByb21pc2VfID0gbnVsbDtcbiAgICAgIGNvbnN0IHF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyhyZXN1bHQpO1xuICAgICAgY29uc3QgcyA9IHF1ZXJ5WydzdWNjZXNzJ107XG4gICAgICBjb25zdCBzdWNjZXNzID0gKHMgPT0gJ3RydWUnIHx8IHMgPT0gJ3llcycgfHwgcyA9PSAnMScpO1xuICAgICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgICAgdGhpcy5hbmFseXRpY3NfLmV2ZW50KGV2ZW50TGFiZWwgKyAnLXN1Y2Nlc3MnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuYW5hbHl0aWNzXy5ldmVudChldmVudExhYmVsICsgJy1yZWplY3RlZCcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIChzdWNjZXNzIHx8ICFzKTtcbiAgICB9KS5jYXRjaChyZWFzb24gPT4ge1xuICAgICAgZGV2KCkuZmluZShUQUcsICdBY3Rpb24gZmFpbGVkOiAnLCBldmVudExhYmVsLCByZWFzb24pO1xuICAgICAgdGhpcy5hbmFseXRpY3NfLmV2ZW50KGV2ZW50TGFiZWwgKyAnLWZhaWxlZCcpO1xuICAgICAgaWYgKHRoaXMuYWN0aW9uUHJvbWlzZV8gPT0gYWN0aW9uUHJvbWlzZSkge1xuICAgICAgICB0aGlzLmFjdGlvblByb21pc2VfID0gbnVsbDtcbiAgICAgIH1cbiAgICAgIHRocm93IHJlYXNvbjtcbiAgICB9KTtcbiAgICB0aGlzLmFjdGlvblByb21pc2VfID0gYWN0aW9uUHJvbWlzZTtcbiAgICB0aGlzLmFjdGlvblN0YXJ0VGltZV8gPSBub3c7XG4gICAgcmV0dXJuIHRoaXMuYWN0aW9uUHJvbWlzZV87XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge0NTU30gZnJvbSAnLi4vLi4vLi4vYnVpbGQvYW1wLXN1YnNjcmlwdGlvbnMtMC4xLmNzcyc7XG5pbXBvcnQge0RpYWxvZ30gZnJvbSAnLi9kaWFsb2cnO1xuaW1wb3J0IHtEb2NJbXBsfSBmcm9tICcuL2RvYy1pbXBsJztcbmltcG9ydCB7RW50aXRsZW1lbnR9IGZyb20gJy4vZW50aXRsZW1lbnQnO1xuaW1wb3J0IHtMb2NhbFN1YnNjcmlwdGlvblBsYXRmb3JtfSBmcm9tICcuL2xvY2FsLXN1YnNjcmlwdGlvbi1wbGF0Zm9ybSc7XG5pbXBvcnQge1BhZ2VDb25maWcsIFBhZ2VDb25maWdSZXNvbHZlcn0gZnJvbSAnLi4vLi4vLi4vdGhpcmRfcGFydHkvc3Vic2NyaXB0aW9ucy1wcm9qZWN0L2NvbmZpZyc7XG5pbXBvcnQge1BsYXRmb3JtU3RvcmV9IGZyb20gJy4vcGxhdGZvcm0tc3RvcmUnO1xuaW1wb3J0IHtSZW5kZXJlcn0gZnJvbSAnLi9yZW5kZXJlcic7XG5pbXBvcnQge1NlcnZpY2VBZGFwdGVyfSBmcm9tICcuL3NlcnZpY2UtYWRhcHRlcic7XG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZXMnO1xuaW1wb3J0IHtTdWJzY3JpcHRpb25BbmFseXRpY3MsIFN1YnNjcmlwdGlvbkFuYWx5dGljc0V2ZW50c30gZnJvbSAnLi9hbmFseXRpY3MnO1xuaW1wb3J0IHtTdWJzY3JpcHRpb25QbGF0Zm9ybX0gZnJvbSAnLi9zdWJzY3JpcHRpb24tcGxhdGZvcm0nO1xuaW1wb3J0IHtWaWV3ZXJTdWJzY3JpcHRpb25QbGF0Zm9ybX0gZnJvbSAnLi92aWV3ZXItc3Vic2NyaXB0aW9uLXBsYXRmb3JtJztcbmltcG9ydCB7Vmlld2VyVHJhY2tlcn0gZnJvbSAnLi92aWV3ZXItdHJhY2tlcic7XG5pbXBvcnQge2RldiwgdXNlcn0gZnJvbSAnLi4vLi4vLi4vc3JjL2xvZyc7XG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4uLy4uLy4uL3NyYy9tb2RlJztcbmltcG9ydCB7Z2V0VmFsdWVGb3JFeHByfSBmcm9tICcuLi8uLi8uLi9zcmMvanNvbic7XG5pbXBvcnQge2dldFdpbk9yaWdpbn0gZnJvbSAnLi4vLi4vLi4vc3JjL3VybCc7XG5pbXBvcnQge2luc3RhbGxTdHlsZXNGb3JEb2N9IGZyb20gJy4uLy4uLy4uL3NyYy9zdHlsZS1pbnN0YWxsZXInO1xuaW1wb3J0IHt0cnlQYXJzZUpzb259IGZyb20gJy4uLy4uLy4uL3NyYy9qc29uJztcblxuLyoqIEBjb25zdCAqL1xuY29uc3QgVEFHID0gJ2FtcC1zdWJzY3JpcHRpb25zJztcblxuLyoqIEBjb25zdCAqL1xuY29uc3QgU0VSVklDRV9USU1FT1VUID0gMzAwMDtcblxuXG4vKipcbiAqIEBpbXBsZW1lbnRzIHsuLi8uLi9hbXAtYWNjZXNzLzAuMS9hY2Nlc3MtdmFycy5BY2Nlc3NWYXJzfVxuICovXG5leHBvcnQgY2xhc3MgU3Vic2NyaXB0aW9uU2VydmljZSB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyEuLi8uLi8uLi9zcmMvc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICAgKi9cbiAgY29uc3RydWN0b3IoYW1wZG9jKSB7XG4gICAgY29uc3QgY29uZmlnRWxlbWVudCA9IGFtcGRvYy5nZXRFbGVtZW50QnlJZChUQUcpO1xuXG4gICAgLyoqIEBjb25zdCBAcHJpdmF0ZSAqL1xuICAgIHRoaXMuYW1wZG9jXyA9IGFtcGRvYztcblxuICAgIC8vIEluc3RhbGwgc3R5bGVzLlxuICAgIGluc3RhbGxTdHlsZXNGb3JEb2MoYW1wZG9jLCBDU1MsICgpID0+IHt9LCBmYWxzZSwgVEFHKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P1Byb21pc2V9ICovXG4gICAgdGhpcy5pbml0aWFsaXplZF8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IVJlbmRlcmVyfSAqL1xuICAgIHRoaXMucmVuZGVyZXJfID0gbmV3IFJlbmRlcmVyKGFtcGRvYyk7XG5cbiAgICAvKiogQHByaXZhdGUgez9QYWdlQ29uZmlnfSAqL1xuICAgIHRoaXMucGFnZUNvbmZpZ18gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/SnNvbk9iamVjdH0gKi9cbiAgICB0aGlzLnBsYXRmb3JtQ29uZmlnXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUgez9QbGF0Zm9ybVN0b3JlfSAqL1xuICAgIHRoaXMucGxhdGZvcm1TdG9yZV8gPSBudWxsO1xuXG4gICAgLyoqIEBjb25zdCBAcHJpdmF0ZSB7IUVsZW1lbnR9ICovXG4gICAgdGhpcy5jb25maWdFbGVtZW50XyA9IHVzZXIoKS5hc3NlcnRFbGVtZW50KGNvbmZpZ0VsZW1lbnQpO1xuXG4gICAgLyoqIEBwcml2YXRlIHshU3Vic2NyaXB0aW9uQW5hbHl0aWNzfSAqL1xuICAgIHRoaXMuc3Vic2NyaXB0aW9uQW5hbHl0aWNzXyA9XG4gICAgICAgIG5ldyBTdWJzY3JpcHRpb25BbmFseXRpY3ModGhpcy5jb25maWdFbGVtZW50Xyk7XG5cbiAgICAvKiogQHByaXZhdGUgeyFTZXJ2aWNlQWRhcHRlcn0gKi9cbiAgICB0aGlzLnNlcnZpY2VBZGFwdGVyXyA9IG5ldyBTZXJ2aWNlQWRhcHRlcih0aGlzKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IURpYWxvZ30gKi9cbiAgICB0aGlzLmRpYWxvZ18gPSBuZXcgRGlhbG9nKGFtcGRvYyk7XG5cbiAgICAvKiogQHByaXZhdGUgeyFWaWV3ZXJUcmFja2VyfSAqL1xuICAgIHRoaXMudmlld2VyVHJhY2tlcl8gPSBuZXcgVmlld2VyVHJhY2tlcihhbXBkb2MpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcn0gKi9cbiAgICB0aGlzLnZpZXdlcl8gPSBTZXJ2aWNlcy52aWV3ZXJGb3JEb2MoYW1wZG9jKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P1Byb21pc2V9ICovXG4gICAgdGhpcy52aWV3VHJhY2tlclByb21pc2VfID0gbnVsbDtcblxuICAgIC8qKiBAY29uc3QgQHByaXZhdGUgeyEuLi8uLi8uLi9zcmMvc2VydmljZS90aW1lci1pbXBsLlRpbWVyfSAqL1xuICAgIHRoaXMudGltZXJfID0gU2VydmljZXMudGltZXJGb3IoYW1wZG9jLndpbik7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtib29sZWFufSAqL1xuICAgIHRoaXMuZG9lc1ZpZXdlclByb3ZpZGVBdXRoXyA9IHRoaXMudmlld2VyXy5oYXNDYXBhYmlsaXR5KCdhdXRoJyk7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshUHJvbWlzZTwhLi4vLi4vLi4vc3JjL3NlcnZpY2UvY2lkLWltcGwuQ2lkPn0gKi9cbiAgICB0aGlzLmNpZF8gPSBTZXJ2aWNlcy5jaWRGb3JEb2MoYW1wZG9jKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IU9iamVjdDxzdHJpbmcsID9Qcm9taXNlPHN0cmluZz4+fSAqL1xuICAgIHRoaXMucmVhZGVySWRQcm9taXNlTWFwXyA9IHt9O1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgaW5pdGlhbGl6ZV8oKSB7XG4gICAgaWYgKCF0aGlzLmluaXRpYWxpemVkXykge1xuICAgICAgY29uc3QgZG9jID0gbmV3IERvY0ltcGwodGhpcy5hbXBkb2NfKTtcbiAgICAgIGNvbnN0IHBhZ2VDb25maWdSZXNvbHZlciA9IG5ldyBQYWdlQ29uZmlnUmVzb2x2ZXIoZG9jKTtcbiAgICAgIHRoaXMuaW5pdGlhbGl6ZWRfID0gUHJvbWlzZS5hbGwoW1xuICAgICAgICB0aGlzLmdldFBsYXRmb3JtQ29uZmlnXygpLFxuICAgICAgICBwYWdlQ29uZmlnUmVzb2x2ZXIucmVzb2x2ZUNvbmZpZygpLFxuICAgICAgXSkudGhlbihwcm9taXNlVmFsdWVzID0+IHtcbiAgICAgICAgLyoqIEB0eXBlIHshSnNvbk9iamVjdH0gKi9cbiAgICAgICAgdGhpcy5wbGF0Zm9ybUNvbmZpZ18gPSBwcm9taXNlVmFsdWVzWzBdO1xuICAgICAgICAvKiogQHR5cGUgeyFQYWdlQ29uZmlnfSAqL1xuICAgICAgICB0aGlzLnBhZ2VDb25maWdfID0gcHJvbWlzZVZhbHVlc1sxXTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5pbml0aWFsaXplZF87XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshSnNvbk9iamVjdH0gc2VydmljZUNvbmZpZ1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgaW5pdGlhbGl6ZUxvY2FsUGxhdGZvcm1zXyhzZXJ2aWNlQ29uZmlnKSB7XG4gICAgaWYgKChzZXJ2aWNlQ29uZmlnWydzZXJ2aWNlSWQnXSB8fCAnbG9jYWwnKSA9PSAnbG9jYWwnKSB7XG4gICAgICB0aGlzLnBsYXRmb3JtU3RvcmVfLnJlc29sdmVQbGF0Zm9ybSgnbG9jYWwnLFxuICAgICAgICAgIG5ldyBMb2NhbFN1YnNjcmlwdGlvblBsYXRmb3JtKFxuICAgICAgICAgICAgICB0aGlzLmFtcGRvY18sXG4gICAgICAgICAgICAgIHNlcnZpY2VDb25maWcsXG4gICAgICAgICAgICAgIHRoaXMuc2VydmljZUFkYXB0ZXJfLFxuICAgICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbkFuYWx5dGljc19cbiAgICAgICAgICApXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhSnNvbk9iamVjdD59XG4gICAqL1xuICBnZXRQbGF0Zm9ybUNvbmZpZ18oKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNvbnN0IHJhd0NvbnRlbnQgPSB0cnlQYXJzZUpzb24odGhpcy5jb25maWdFbGVtZW50Xy50ZXh0Q29udGVudCwgZSA9PiB7XG4gICAgICAgIHJlamVjdCgnRmFpbGVkIHRvIHBhcnNlIFwiYW1wLXN1YnNjcmlwdGlvbnNcIiBKU09OOiAnICsgZSk7XG4gICAgICB9KTtcbiAgICAgIHJlc29sdmUocmF3Q29udGVudCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogVGhpcyBtZXRob2QgcmVnaXN0ZXJzIGFuIGF1dG8gaW5pdGlhbGl6ZWQgc3ViY3JpcHRpb24gcGxhdGZvcm0gd2l0aCB0aGlzXG4gICAqIHNlcnZpY2UuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlSWRcbiAgICogQHBhcmFtIHtmdW5jdGlvbighSnNvbk9iamVjdCwgIVNlcnZpY2VBZGFwdGVyKTohU3Vic2NyaXB0aW9uUGxhdGZvcm19IHN1YnNjcmlwdGlvblBsYXRmb3JtRmFjdG9yeVxuICAgKi9cbiAgcmVnaXN0ZXJQbGF0Zm9ybShzZXJ2aWNlSWQsIHN1YnNjcmlwdGlvblBsYXRmb3JtRmFjdG9yeSkge1xuICAgIHJldHVybiB0aGlzLmluaXRpYWxpemVfKCkudGhlbigoKSA9PiB7XG4gICAgICBpZiAodGhpcy5kb2VzVmlld2VyUHJvdmlkZUF1dGhfKSB7XG4gICAgICAgIHJldHVybjsgLy8gRXh0ZXJuYWwgcGxhdGZvcm1zIHNob3VsZCBub3QgcmVnaXN0ZXIgaWYgdmlld2VyIHByb3ZpZGVzIGF1dGhcbiAgICAgIH1cbiAgICAgIGNvbnN0IG1hdGNoZWRTZXJ2aWNlcyA9IHRoaXMucGxhdGZvcm1Db25maWdfWydzZXJ2aWNlcyddLmZpbHRlcihcbiAgICAgICAgICBzZXJ2aWNlID0+IChzZXJ2aWNlLnNlcnZpY2VJZCB8fCAnbG9jYWwnKSA9PT0gc2VydmljZUlkKTtcblxuICAgICAgY29uc3QgbWF0Y2hlZFNlcnZpY2VDb25maWcgPSB1c2VyKCkuYXNzZXJ0KG1hdGNoZWRTZXJ2aWNlc1swXSxcbiAgICAgICAgICAnTm8gbWF0Y2hpbmcgc2VydmljZXMgZm9yIHRoZSBJRCBmb3VuZCcpO1xuXG4gICAgICBjb25zdCBzdWJzY3JpcHRpb25QbGF0Zm9ybSA9IHN1YnNjcmlwdGlvblBsYXRmb3JtRmFjdG9yeShcbiAgICAgICAgICBtYXRjaGVkU2VydmljZUNvbmZpZyxcbiAgICAgICAgICB0aGlzLnNlcnZpY2VBZGFwdGVyXyk7XG5cbiAgICAgIHRoaXMucGxhdGZvcm1TdG9yZV8ucmVzb2x2ZVBsYXRmb3JtKHN1YnNjcmlwdGlvblBsYXRmb3JtLmdldFNlcnZpY2VJZCgpLFxuICAgICAgICAgIHN1YnNjcmlwdGlvblBsYXRmb3JtKTtcbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9uQW5hbHl0aWNzXy5zZXJ2aWNlRXZlbnQoXG4gICAgICAgICAgU3Vic2NyaXB0aW9uQW5hbHl0aWNzRXZlbnRzLlBMQVRGT1JNX1JFR0lTVEVSRUQsXG4gICAgICAgICAgc3Vic2NyaXB0aW9uUGxhdGZvcm0uZ2V0U2VydmljZUlkKClcbiAgICAgICk7XG4gICAgICB0aGlzLmZldGNoRW50aXRsZW1lbnRzXyhzdWJzY3JpcHRpb25QbGF0Zm9ybSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtib29sZWFufSBncmFudFN0YXRlXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcm9jZXNzR3JhbnRTdGF0ZV8oZ3JhbnRTdGF0ZSkge1xuICAgIHRoaXMucmVuZGVyZXJfLnRvZ2dsZUxvYWRpbmcoZmFsc2UpO1xuICAgIHRoaXMucmVuZGVyZXJfLnNldEdyYW50U3RhdGUoZ3JhbnRTdGF0ZSk7XG4gICAgdGhpcy52aWV3VHJhY2tlclByb21pc2VfID0gdGhpcy52aWV3ZXJUcmFja2VyXy5zY2hlZHVsZVZpZXcoMjAwMCk7XG4gICAgaWYgKGdyYW50U3RhdGUgPT09IGZhbHNlKSB7XG4gICAgICAvLyBUT0RPKEBwcmF0ZWVrYmgpOiBTaG93IFVJIHRoYXQgbm8gZWxpZ2libGUgZW50aXRsZW1lbnQgZm91bmRcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VJZFxuICAgKiBAcGFyYW0geyEuL2VudGl0bGVtZW50LkVudGl0bGVtZW50fSBlbnRpdGxlbWVudFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcmVzb2x2ZUVudGl0bGVtZW50c1RvU3RvcmVfKHNlcnZpY2VJZCwgZW50aXRsZW1lbnQpIHtcbiAgICB0aGlzLnBsYXRmb3JtU3RvcmVfLnJlc29sdmVFbnRpdGxlbWVudChzZXJ2aWNlSWQsIGVudGl0bGVtZW50KTtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbkFuYWx5dGljc18uc2VydmljZUV2ZW50KFxuICAgICAgICBTdWJzY3JpcHRpb25BbmFseXRpY3NFdmVudHMuRU5USVRMRU1FTlRfUkVTT0xWRUQsXG4gICAgICAgIHNlcnZpY2VJZFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshU3Vic2NyaXB0aW9uUGxhdGZvcm19IHN1YnNjcmlwdGlvblBsYXRmb3JtXG4gICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgKi9cbiAgZmV0Y2hFbnRpdGxlbWVudHNfKHN1YnNjcmlwdGlvblBsYXRmb3JtKSB7XG4gICAgbGV0IHRpbWVvdXQgPSBTRVJWSUNFX1RJTUVPVVQ7XG4gICAgaWYgKGdldE1vZGUoKS5kZXZlbG9wbWVudCB8fCBnZXRNb2RlKCkubG9jYWxEZXYpIHtcbiAgICAgIHRpbWVvdXQgPSBTRVJWSUNFX1RJTUVPVVQgKiAyO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy52aWV3ZXJfLndoZW5GaXJzdFZpc2libGUoKS50aGVuKCgpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLnRpbWVyXy50aW1lb3V0UHJvbWlzZShcbiAgICAgICAgICB0aW1lb3V0LFxuICAgICAgICAgIHN1YnNjcmlwdGlvblBsYXRmb3JtLmdldEVudGl0bGVtZW50cygpXG4gICAgICApLnRoZW4oZW50aXRsZW1lbnQgPT4ge1xuICAgICAgICBlbnRpdGxlbWVudCA9IGVudGl0bGVtZW50IHx8IEVudGl0bGVtZW50LmVtcHR5KFxuICAgICAgICAgICAgc3Vic2NyaXB0aW9uUGxhdGZvcm0uZ2V0U2VydmljZUlkKCkpO1xuICAgICAgICB0aGlzLnJlc29sdmVFbnRpdGxlbWVudHNUb1N0b3JlXyhzdWJzY3JpcHRpb25QbGF0Zm9ybS5nZXRTZXJ2aWNlSWQoKSxcbiAgICAgICAgICAgIGVudGl0bGVtZW50KTtcbiAgICAgICAgcmV0dXJuIGVudGl0bGVtZW50O1xuICAgICAgfSkuY2F0Y2gocmVhc29uID0+IHtcbiAgICAgICAgY29uc3Qgc2VydmljZUlkID0gc3Vic2NyaXB0aW9uUGxhdGZvcm0uZ2V0U2VydmljZUlkKCk7XG4gICAgICAgIHRoaXMucGxhdGZvcm1TdG9yZV8ucmVwb3J0UGxhdGZvcm1GYWlsdXJlKHNlcnZpY2VJZCk7XG4gICAgICAgIHRocm93IHVzZXIoKS5jcmVhdGVFcnJvcihcbiAgICAgICAgICAgIGBmZXRjaCBlbnRpdGxlbWVudHMgZmFpbGVkIGZvciAke3NlcnZpY2VJZH1gLCByZWFzb25cbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0cyB0aGUgYW1wLXN1YnNjcmlwdGlvbiBTZXJ2aWNlXG4gICAqIEByZXR1cm4ge1N1YnNjcmlwdGlvblNlcnZpY2V9XG4gICAqL1xuICBzdGFydCgpIHtcbiAgICB0aGlzLmluaXRpYWxpemVfKCkudGhlbigoKSA9PiB7XG4gICAgICB0aGlzLnN1YnNjcmlwdGlvbkFuYWx5dGljc18uZXZlbnQoU3Vic2NyaXB0aW9uQW5hbHl0aWNzRXZlbnRzLlNUQVJURUQpO1xuICAgICAgdGhpcy5yZW5kZXJlcl8udG9nZ2xlTG9hZGluZyh0cnVlKTtcblxuICAgICAgdXNlcigpLmFzc2VydCh0aGlzLnBhZ2VDb25maWdfLCAnUGFnZSBjb25maWcgaXMgbnVsbCcpO1xuXG4gICAgICBpZiAodGhpcy5kb2VzVmlld2VyUHJvdmlkZUF1dGhfKSB7XG4gICAgICAgIHRoaXMuZGVsZWdhdGVBdXRoVG9WaWV3ZXJfKCk7XG4gICAgICAgIHRoaXMuc3RhcnRBdXRob3JpemF0aW9uRmxvd18oZmFsc2UpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9IGVsc2UgaWYgKHRoaXMucGxhdGZvcm1Db25maWdfWydhbHdheXNHcmFudCddKSB7XG4gICAgICAgIC8vIElmIHNlcnZpY2UgY29uZmlnIGhhcyBgYWx3YXlzR3JhbnRgIGtleSBhcyB0cnVlLCBwdWJsaXNoZXIgd2FudHMgaXRcbiAgICAgICAgLy8gdG8gYmUgb3BlbiBhbHdheXMgdW50aWwgYSBzdmlld2VyIGRlY2lkZXMgb3RoZXJ3aXNlLlxuICAgICAgICB0aGlzLnByb2Nlc3NHcmFudFN0YXRlXyh0cnVlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB1c2VyKCkuYXNzZXJ0KHRoaXMucGxhdGZvcm1Db25maWdfWydzZXJ2aWNlcyddLFxuICAgICAgICAgICdTZXJ2aWNlcyBub3QgY29uZmlndXJlZCBpbiBzZXJ2aWNlIGNvbmZpZycpO1xuXG4gICAgICBjb25zdCBzZXJ2aWNlSWRzID0gdGhpcy5wbGF0Zm9ybUNvbmZpZ19bJ3NlcnZpY2VzJ10ubWFwKHNlcnZpY2UgPT5cbiAgICAgICAgc2VydmljZVsnc2VydmljZUlkJ10gfHwgJ2xvY2FsJyk7XG5cbiAgICAgIHRoaXMuaW5pdGlhbGl6ZVBsYXRmb3JtU3RvcmVfKHNlcnZpY2VJZHMpO1xuXG4gICAgICB0aGlzLnBsYXRmb3JtQ29uZmlnX1snc2VydmljZXMnXS5mb3JFYWNoKHNlcnZpY2UgPT4ge1xuICAgICAgICB0aGlzLmluaXRpYWxpemVMb2NhbFBsYXRmb3Jtc18oc2VydmljZSk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5wbGF0Zm9ybVN0b3JlXy5nZXRBdmFpbGFibGVQbGF0Zm9ybXMoKS5mb3JFYWNoKFxuICAgICAgICAgIHN1YnNjcmlwdGlvblBsYXRmb3JtID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmV0Y2hFbnRpdGxlbWVudHNfKHN1YnNjcmlwdGlvblBsYXRmb3JtKTtcbiAgICAgICAgICB9XG4gICAgICApO1xuICAgICAgdGhpcy5zdGFydEF1dGhvcml6YXRpb25GbG93XygpO1xuXG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZXMgdGhlIFBsYXRmb3JtU3RvcmUgd2l0aCB0aGUgc2VydmljZSBpZHMuXG4gICAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHNlcnZpY2VJZHNcbiAgICovXG4gIGluaXRpYWxpemVQbGF0Zm9ybVN0b3JlXyhzZXJ2aWNlSWRzKSB7XG4gICAgY29uc3QgZmFsbGJhY2tFbnRpdGxlbWVudCA9IHRoaXMucGxhdGZvcm1Db25maWdfWydmYWxsYmFja0VudGl0bGVtZW50J10gP1xuICAgICAgRW50aXRsZW1lbnQucGFyc2VGcm9tSnNvbih0aGlzLnBsYXRmb3JtQ29uZmlnX1snZmFsbGJhY2tFbnRpdGxlbWVudCddKSA6XG4gICAgICBFbnRpdGxlbWVudC5lbXB0eSgnbG9jYWwnKTtcbiAgICB0aGlzLnBsYXRmb3JtU3RvcmVfID0gbmV3IFBsYXRmb3JtU3RvcmUoc2VydmljZUlkcyxcbiAgICAgICAgdGhpcy5wbGF0Zm9ybUNvbmZpZ19bJ3Njb3JlJ10sXG4gICAgICAgIGZhbGxiYWNrRW50aXRsZW1lbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIERlbGVnYXRlcyBhdXRoZW50aWNhdGlvbiB0byB2aWV3ZXJcbiAgICovXG4gIGRlbGVnYXRlQXV0aFRvVmlld2VyXygpIHtcbiAgICBjb25zdCBzZXJ2aWNlSWRzID0gWydsb2NhbCddO1xuICAgIGNvbnN0IG9yaWdpbiA9IGdldFdpbk9yaWdpbih0aGlzLmFtcGRvY18ud2luKTtcbiAgICB0aGlzLmluaXRpYWxpemVQbGF0Zm9ybVN0b3JlXyhzZXJ2aWNlSWRzKTtcblxuICAgIHRoaXMucGxhdGZvcm1Db25maWdfWydzZXJ2aWNlcyddLmZvckVhY2goc2VydmljZSA9PiB7XG4gICAgICBpZiAoKHNlcnZpY2VbJ3NlcnZpY2VJZCddIHx8ICdsb2NhbCcpID09ICdsb2NhbCcpIHtcbiAgICAgICAgY29uc3Qgdmlld2VyUGxhdGZvcm0gPSBuZXcgVmlld2VyU3Vic2NyaXB0aW9uUGxhdGZvcm0oXG4gICAgICAgICAgICB0aGlzLmFtcGRvY18sXG4gICAgICAgICAgICBzZXJ2aWNlLFxuICAgICAgICAgICAgdGhpcy5zZXJ2aWNlQWRhcHRlcl8sXG4gICAgICAgICAgICBvcmlnaW4sXG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbkFuYWx5dGljc19cbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5wbGF0Zm9ybVN0b3JlXy5yZXNvbHZlUGxhdGZvcm0oJ2xvY2FsJywgdmlld2VyUGxhdGZvcm0pO1xuICAgICAgICB2aWV3ZXJQbGF0Zm9ybS5nZXRFbnRpdGxlbWVudHMoKS50aGVuKGVudGl0bGVtZW50ID0+IHtcbiAgICAgICAgICBkZXYoKS5hc3NlcnQoZW50aXRsZW1lbnQsICdFbnRpdGxlbWVudCBpcyBudWxsJyk7XG4gICAgICAgICAgLy8gVmlld2VyIGF1dGhvcml6YXRpb24gaXMgcmVkaXJlY3RlZCB0byB1c2UgbG9jYWwgcGxhdGZvcm0gaW5zdGVhZC5cbiAgICAgICAgICB0aGlzLnBsYXRmb3JtU3RvcmVfLnJlc29sdmVFbnRpdGxlbWVudCgnbG9jYWwnLFxuICAgICAgICAgICAgICAvKiogQHR5cGUgeyEuL2VudGl0bGVtZW50LkVudGl0bGVtZW50fSovIChlbnRpdGxlbWVudCkpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gc2VydmljZUlkXG4gICAqIEByZXR1cm4geyFQcm9taXNlPHN0cmluZz59XG4gICAqL1xuICBnZXRSZWFkZXJJZChzZXJ2aWNlSWQpIHtcbiAgICBsZXQgcmVhZGVySWQgPSB0aGlzLnJlYWRlcklkUHJvbWlzZU1hcF9bc2VydmljZUlkXTtcbiAgICBpZiAoIXJlYWRlcklkKSB7XG4gICAgICBjb25zdCBjb25zZW50ID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAvLyBTY29wZSBpcyBrZXB0IFwiYW1wLWFjY2Vzc1wiIGJ5IGRlZmF1bHQgdG8gYXZvaWQgdW5uZWNlc3NhcnkgQ0lEXG4gICAgICAvLyByb3RhdGlvbi5cbiAgICAgIGNvbnN0IHNjb3BlID1cbiAgICAgICAgICAnYW1wLWFjY2VzcycgKyAoc2VydmljZUlkID09ICdsb2NhbCcgPyAnJyA6ICctJyArIHNlcnZpY2VJZCk7XG4gICAgICByZWFkZXJJZCA9IHRoaXMuY2lkXy50aGVuKGNpZCA9PiB7XG4gICAgICAgIHJldHVybiBjaWQuZ2V0KFxuICAgICAgICAgICAge3Njb3BlLCBjcmVhdGVDb29raWVJZk5vdFByZXNlbnQ6IHRydWV9LFxuICAgICAgICAgICAgY29uc2VudCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMucmVhZGVySWRQcm9taXNlTWFwX1tzZXJ2aWNlSWRdID0gcmVhZGVySWQ7XG4gICAgfVxuICAgIHJldHVybiByZWFkZXJJZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBzaW5nbGV0b24gRGlhbG9nIGluc3RhbmNlXG4gICAqIEByZXR1cm4geyFEaWFsb2d9XG4gICAqL1xuICBnZXREaWFsb2coKSB7XG4gICAgcmV0dXJuIHRoaXMuZGlhbG9nXztcbiAgfVxuXG4gIC8qKlxuICAgKiBVbmJsb2NrIGRvY3VtZW50IGJhc2VkIG9uIGdyYW50IHN0YXRlIGFuZCBzZWxlY3RlZCBwbGF0Zm9ybVxuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBkb1BsYXRmb3JtU2VsZWN0aW9uXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzdGFydEF1dGhvcml6YXRpb25GbG93Xyhkb1BsYXRmb3JtU2VsZWN0aW9uID0gdHJ1ZSkge1xuICAgIHRoaXMucGxhdGZvcm1TdG9yZV8uZ2V0R3JhbnRTdGF0dXMoKS50aGVuKGdyYW50U3RhdGUgPT4ge1xuICAgICAgdGhpcy5wcm9jZXNzR3JhbnRTdGF0ZV8oZ3JhbnRTdGF0ZSk7XG4gICAgICB0aGlzLnBlcmZvcm1QaW5nYmFja18oKTtcbiAgICB9KTtcblxuICAgIGlmIChkb1BsYXRmb3JtU2VsZWN0aW9uKSB7XG4gICAgICB0aGlzLnNlbGVjdEFuZEFjdGl2YXRlUGxhdGZvcm1fKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIHNlbGVjdEFuZEFjdGl2YXRlUGxhdGZvcm1fKCkge1xuICAgIGNvbnN0IHJlcXVpcmVWYWx1ZXNQcm9taXNlID0gUHJvbWlzZS5hbGwoW1xuICAgICAgdGhpcy5wbGF0Zm9ybVN0b3JlXy5nZXRHcmFudFN0YXR1cygpLFxuICAgICAgdGhpcy5wbGF0Zm9ybVN0b3JlXy5zZWxlY3RQbGF0Zm9ybSgpLFxuICAgIF0pO1xuXG4gICAgcmV0dXJuIHJlcXVpcmVWYWx1ZXNQcm9taXNlLnRoZW4ocmVzb2x2ZWRWYWx1ZXMgPT4ge1xuICAgICAgY29uc3Qgc2VsZWN0ZWRQbGF0Zm9ybSA9IHJlc29sdmVkVmFsdWVzWzFdO1xuICAgICAgY29uc3Qgc2VsZWN0ZWRFbnRpdGxlbWVudCA9IHRoaXMucGxhdGZvcm1TdG9yZV8uZ2V0UmVzb2x2ZWRFbnRpdGxlbWVudEZvcihcbiAgICAgICAgICBzZWxlY3RlZFBsYXRmb3JtLmdldFNlcnZpY2VJZCgpKTtcblxuICAgICAgc2VsZWN0ZWRQbGF0Zm9ybS5hY3RpdmF0ZShzZWxlY3RlZEVudGl0bGVtZW50KTtcbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9uQW5hbHl0aWNzXy5zZXJ2aWNlRXZlbnQoXG4gICAgICAgICAgU3Vic2NyaXB0aW9uQW5hbHl0aWNzRXZlbnRzLlBMQVRGT1JNX0FDVElWQVRFRCxcbiAgICAgICAgICBzZWxlY3RlZFBsYXRmb3JtLmdldFNlcnZpY2VJZCgpKTtcbiAgICAgIGlmIChzZWxlY3RlZEVudGl0bGVtZW50LmdyYW50ZWQpIHtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25BbmFseXRpY3NfLnNlcnZpY2VFdmVudChcbiAgICAgICAgICAgIFN1YnNjcmlwdGlvbkFuYWx5dGljc0V2ZW50cy5BQ0NFU1NfR1JBTlRFRCxcbiAgICAgICAgICAgIHNlbGVjdGVkUGxhdGZvcm0uZ2V0U2VydmljZUlkKCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25BbmFseXRpY3NfLnNlcnZpY2VFdmVudChcbiAgICAgICAgICAgIFN1YnNjcmlwdGlvbkFuYWx5dGljc0V2ZW50cy5QQVlXQUxMX0FDVElWQVRFRCxcbiAgICAgICAgICAgIHNlbGVjdGVkUGxhdGZvcm0uZ2V0U2VydmljZUlkKCkpO1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbkFuYWx5dGljc18uc2VydmljZUV2ZW50KFxuICAgICAgICAgICAgU3Vic2NyaXB0aW9uQW5hbHl0aWNzRXZlbnRzLkFDQ0VTU19ERU5JRUQsXG4gICAgICAgICAgICBzZWxlY3RlZFBsYXRmb3JtLmdldFNlcnZpY2VJZCgpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBwaW5nYmFjayBvbiBsb2NhbCBwbGF0Zm9ybS5cbiAgICogQHJldHVybiB7P1Byb21pc2V9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwZXJmb3JtUGluZ2JhY2tfKCkge1xuICAgIGlmICh0aGlzLnZpZXdUcmFja2VyUHJvbWlzZV8pIHtcbiAgICAgIHJldHVybiB0aGlzLnZpZXdUcmFja2VyUHJvbWlzZV8udGhlbigoKSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLnBsYXRmb3JtU3RvcmVfLmdldEdyYW50RW50aXRsZW1lbnQoKTtcbiAgICAgIH0pLnRoZW4oZ3JhbnRTdGF0ZUVudGl0bGVtZW50ID0+IHtcbiAgICAgICAgY29uc3QgbG9jYWxQbGF0Zm9ybSA9IHRoaXMucGxhdGZvcm1TdG9yZV8uZ2V0TG9jYWxQbGF0Zm9ybSgpO1xuICAgICAgICBpZiAobG9jYWxQbGF0Zm9ybS5pc1BpbmdiYWNrRW5hYmxlZCgpKSB7XG4gICAgICAgICAgbG9jYWxQbGF0Zm9ybS5waW5nYmFjayhncmFudFN0YXRlRW50aXRsZW1lbnRcbiAgICAgICAgICAgICAgfHwgRW50aXRsZW1lbnQuZW1wdHkoJ2xvY2FsJykpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBQYWdlIGNvbmZpZ1xuICAgKiBAcmV0dXJuIHshUGFnZUNvbmZpZ31cbiAgICovXG4gIGdldFBhZ2VDb25maWcoKSB7XG4gICAgY29uc3QgcGFnZUNvbmZpZyA9IGRldigpLmFzc2VydCh0aGlzLnBhZ2VDb25maWdfLFxuICAgICAgICAnUGFnZSBjb25maWcgaXMgbm90IHlldCBmZXRjaGVkJyk7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVBhZ2VDb25maWd9ICovKHBhZ2VDb25maWcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlIGF1dGhvcml6ZXMgYSBwbGF0Zm9ybVxuICAgKiBAcGFyYW0geyFTdWJzY3JpcHRpb25QbGF0Zm9ybX0gc3Vic2NyaXB0aW9uUGxhdGZvcm1cbiAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAqL1xuICByZUF1dGhvcml6ZVBsYXRmb3JtKHN1YnNjcmlwdGlvblBsYXRmb3JtKSB7XG4gICAgdGhpcy5wbGF0Zm9ybVN0b3JlXy5yZXNldEVudGl0bGVtZW50Rm9yKFxuICAgICAgICBzdWJzY3JpcHRpb25QbGF0Zm9ybS5nZXRTZXJ2aWNlSWQoKSk7XG4gICAgcmV0dXJuIHRoaXMuZmV0Y2hFbnRpdGxlbWVudHNfKHN1YnNjcmlwdGlvblBsYXRmb3JtKS50aGVuKCgpID0+IHtcbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9uQW5hbHl0aWNzXy5zZXJ2aWNlRXZlbnQoXG4gICAgICAgICAgU3Vic2NyaXB0aW9uQW5hbHl0aWNzRXZlbnRzLlBMQVRGT1JNX1JFQVVUSE9SSVpFRCxcbiAgICAgICAgICBzdWJzY3JpcHRpb25QbGF0Zm9ybS5nZXRTZXJ2aWNlSWQoKVxuICAgICAgKTtcbiAgICAgIHRoaXMucGxhdGZvcm1TdG9yZV8ucmVzZXQoKTtcbiAgICAgIHRoaXMuc3RhcnRBdXRob3JpemF0aW9uRmxvd18oKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxlZ2F0ZXMgYW4gYWN0aW9uIHRvIGxvY2FsIHBsYXRmb3JtLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gYWN0aW9uXG4gICAqIEByZXR1cm4geyFQcm9taXNlPGJvb2xlYW4+fVxuICAgKi9cbiAgZGVsZWdhdGVBY3Rpb25Ub0xvY2FsKGFjdGlvbikge1xuICAgIHJldHVybiB0aGlzLmRlbGVnYXRlQWN0aW9uVG9TZXJ2aWNlKGFjdGlvbiwgJ2xvY2FsJyk7XG4gIH1cblxuICAvKipcbiAgICogRGVsZWdhdGVzIGFuIGFjdGlvbiB0byBzcGVjaWZpZWQgcGxhdGZvcm0uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpb25cbiAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VJZFxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTxib29sZWFuPn1cbiAgICovXG4gIGRlbGVnYXRlQWN0aW9uVG9TZXJ2aWNlKGFjdGlvbiwgc2VydmljZUlkKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgdGhpcy5wbGF0Zm9ybVN0b3JlXy5vblBsYXRmb3JtUmVzb2x2ZXMoc2VydmljZUlkLCBwbGF0Zm9ybSA9PiB7XG4gICAgICAgIGRldigpLmFzc2VydChwbGF0Zm9ybSwgJ1BsYXRmb3JtIGlzIG5vdCByZWdpc3RlcmVkJyk7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uQW5hbHl0aWNzXy5ldmVudChcbiAgICAgICAgICAgIFN1YnNjcmlwdGlvbkFuYWx5dGljc0V2ZW50cy5BQ1RJT05fREVMRUdBVEVELFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBhY3Rpb24sXG4gICAgICAgICAgICAgIHNlcnZpY2VJZCxcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgcmVzb2x2ZShwbGF0Zm9ybS5leGVjdXRlQWN0aW9uKGFjdGlvbikpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRGVsZWdhdGUgVUkgZGVjb3JhdGlvbiB0byBhbm90aGVyIHNlcnZpY2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VJZFxuICAgKiBAcGFyYW0ge3N0cmluZ30gYWN0aW9uXG4gICAqIEBwYXJhbSB7P0pzb25PYmplY3R9IG9wdGlvbnNcbiAgICovXG4gIGRlY29yYXRlU2VydmljZUFjdGlvbihlbGVtZW50LCBzZXJ2aWNlSWQsIGFjdGlvbiwgb3B0aW9ucykge1xuICAgIHRoaXMucGxhdGZvcm1TdG9yZV8ub25QbGF0Zm9ybVJlc29sdmVzKHNlcnZpY2VJZCwgcGxhdGZvcm0gPT4ge1xuICAgICAgZGV2KCkuYXNzZXJ0KHBsYXRmb3JtLCAnUGxhdGZvcm0gaXMgbm90IHJlZ2lzdGVyZWQnKTtcbiAgICAgIHBsYXRmb3JtLmRlY29yYXRlVUkoZWxlbWVudCwgYWN0aW9uLCBvcHRpb25zKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFdmFsdWF0ZXMgcGxhdGZvcm1zIGFuZCBzZWxlY3QgdGhlIG9uZSB0byBiZSBzZWxlY3RlZCBmb3IgbG9naW4uXG4gICAqIEByZXR1cm4geyEuL3N1YnNjcmlwdGlvbi1wbGF0Zm9ybS5TdWJzY3JpcHRpb25QbGF0Zm9ybX1cbiAgICovXG4gIHNlbGVjdFBsYXRmb3JtRm9yTG9naW4oKSB7XG4gICAgcmV0dXJuIHRoaXMucGxhdGZvcm1TdG9yZV8uc2VsZWN0UGxhdGZvcm1Gb3JMb2dpbigpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSBmcm9tIEFjY2Vzc1ZhcnMgKi9cbiAgZ2V0QWNjZXNzUmVhZGVySWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaW5pdGlhbGl6ZV8oKS50aGVuKCgpID0+IHRoaXMuZ2V0UmVhZGVySWQoJ2xvY2FsJykpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSBmcm9tIEFjY2Vzc1ZhcnMgKi9cbiAgZ2V0QXV0aGRhdGFGaWVsZChmaWVsZCkge1xuICAgIHJldHVybiB0aGlzLmluaXRpYWxpemVfKCkudGhlbigoKSA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5wbGF0Zm9ybVN0b3JlXy5nZXRFbnRpdGxlbWVudFByb21pc2VGb3IoJ2xvY2FsJyk7XG4gICAgfSkudGhlbihlbnRpdGxlbWVudCA9PiB7XG4gICAgICByZXR1cm4gZ2V0VmFsdWVGb3JFeHByKGVudGl0bGVtZW50Lmpzb24oKSwgZmllbGQpO1xuICAgIH0pO1xuICB9XG59XG5cblxuLyoqIEBwYWNrYWdlIEBWaXNpYmxlRm9yVGVzdGluZyAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFBsYXRmb3JtQ2xhc3NGb3JUZXN0aW5nKCkge1xuICByZXR1cm4gU3Vic2NyaXB0aW9uUGxhdGZvcm07XG59XG5cbi8qKlxuICogVE9ETyhkdm95dGVua28pOiByZW1vdmUgb25jZSBjb21waWxlciB0eXBlIGNoZWNraW5nIGlzIGZpeGVkIGZvciB0aGlyZF9wYXJ0eS5cbiAqIEBwYWNrYWdlIEBWaXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGFnZUNvbmZpZ0NsYXNzRm9yVGVzdGluZygpIHtcbiAgcmV0dXJuIFBhZ2VDb25maWc7XG59XG5cblxuLy8gUmVnaXN0ZXIgdGhlIGV4dGVuc2lvbiBzZXJ2aWNlcy5cbkFNUC5leHRlbnNpb24oVEFHLCAnMC4xJywgZnVuY3Rpb24oQU1QKSB7XG4gIEFNUC5yZWdpc3RlclNlcnZpY2VGb3JEb2MoJ3N1YnNjcmlwdGlvbnMnLCBmdW5jdGlvbihhbXBkb2MpIHtcbiAgICByZXR1cm4gbmV3IFN1YnNjcmlwdGlvblNlcnZpY2UoYW1wZG9jKS5zdGFydCgpO1xuICB9KTtcbn0pO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7dHJpZ2dlckFuYWx5dGljc0V2ZW50fSBmcm9tICcuLi8uLi8uLi9zcmMvYW5hbHl0aWNzJztcblxuZXhwb3J0IGNvbnN0IFN1YnNjcmlwdGlvbkFuYWx5dGljc0V2ZW50cyA9IHtcbiAgUExBVEZPUk1fQUNUSVZBVEVEOiAnc3Vic2NyaXB0aW9ucy1wbGF0Zm9ybS1hY3RpdmF0ZWQnLFxuICBQQVlXQUxMX0FDVElWQVRFRDogJ3N1YnNjcmlwdGlvbnMtcGF5d2FsbC1hY3RpdmF0ZWQnLFxuICBQTEFURk9STV9SRUdJU1RFUkVEOiAnc3Vic2NyaXB0aW9ucy1wbGF0Zm9ybS1yZWdpc3RlcmVkJyxcbiAgUExBVEZPUk1fUkVBVVRIT1JJWkVEOiAnc3Vic2NyaXB0aW9ucy1wbGF0Zm9ybS1yZS1hdXRob3JpemVkJyxcbiAgQUNUSU9OX0RFTEVHQVRFRDogJ3N1YnNjcmlwdGlvbnMtYWN0aW9uLWRlbGVnYXRlZCcsXG4gIEVOVElUTEVNRU5UX1JFU09MVkVEOiAnc3Vic2NyaXB0aW9ucy1lbnRpdGxlbWVudC1yZXNvbHZlZCcsXG4gIFNUQVJURUQ6ICdzdWJzY3JpcHRpb25zLXN0YXJ0ZWQnLFxuICBBQ0NFU1NfR1JBTlRFRDogJ3N1YnNjcmlwdGlvbnMtYWNjZXNzLWdyYW50ZWQnLFxuICBBQ0NFU1NfREVOSUVEOiAnc3Vic2NyaXB0aW9ucy1hY2Nlc3MtZGVuaWVkJyxcbn07XG5cbmV4cG9ydCBjbGFzcyBTdWJzY3JpcHRpb25BbmFseXRpY3Mge1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIFN1YnNjcmlwdGlvbkFuYWx5dGljcy5cbiAgICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICAgKi9cbiAgY29uc3RydWN0b3IoZWxlbWVudCkge1xuICAgIHRoaXMuZWxlbWVudF8gPSBlbGVtZW50O1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VJZFxuICAgKiBAcGFyYW0ge09iamVjdDxzdHJpbmcsIHN0cmluZz49fSBvcHRfdmFyc1xuICAgKi9cbiAgc2VydmljZUV2ZW50KGV2ZW50VHlwZSwgc2VydmljZUlkLCBvcHRfdmFycykge1xuICAgIHRoaXMuZXZlbnQoZXZlbnRUeXBlLCBPYmplY3QuYXNzaWduKHtcbiAgICAgIHNlcnZpY2VJZCxcbiAgICB9LCBvcHRfdmFycykpO1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAgICogQHBhcmFtIHtPYmplY3Q8c3RyaW5nLCBzdHJpbmc+PX0gb3B0X3ZhcnNcbiAgICovXG4gIGV2ZW50KGV2ZW50VHlwZSwgb3B0X3ZhcnMpIHtcbiAgICB0cmlnZ2VyQW5hbHl0aWNzRXZlbnQodGhpcy5lbGVtZW50XywgZXZlbnRUeXBlLCBvcHRfdmFycyB8fCB7fSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZXMnO1xuaW1wb3J0IHtjcmVhdGVFbGVtZW50V2l0aEF0dHJpYnV0ZXN9IGZyb20gJy4uLy4uLy4uL3NyYy9kb20nO1xuaW1wb3J0IHtzZXRJbXBvcnRhbnRTdHlsZXMsIHRvZ2dsZX0gZnJvbSAnLi4vLi4vLi4vc3JjL3N0eWxlJztcblxuXG5leHBvcnQgY2xhc3MgRGlhbG9nIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhbXBkb2MpIHtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshLi4vLi4vLi4vc3JjL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSAqL1xuICAgIHRoaXMuYW1wZG9jXyA9IGFtcGRvYztcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyEuLi8uLi8uLi9zcmMvc2VydmljZS92c3luYy1pbXBsLlZzeW5jfSAqL1xuICAgIHRoaXMudnN5bmNfID0gU2VydmljZXMudnN5bmNGb3IoYW1wZG9jLndpbik7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshLi4vLi4vLi4vc3JjL3NlcnZpY2UvdGltZXItaW1wbC5UaW1lcn0gKi9cbiAgICB0aGlzLnRpbWVyXyA9IFNlcnZpY2VzLnRpbWVyRm9yKGFtcGRvYy53aW4pO1xuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGUgQGNvbnN0IHshLi4vLi4vLi4vc3JjL3NlcnZpY2Uvdmlld3BvcnQvdmlld3BvcnQtaW1wbC5WaWV3cG9ydH1cbiAgICAgKi9cbiAgICB0aGlzLnZpZXdwb3J0XyA9IFNlcnZpY2VzLnZpZXdwb3J0Rm9yRG9jKGFtcGRvYyk7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy52aXNpYmxlXyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/RWxlbWVudH0gKi9cbiAgICB0aGlzLmNvbnRlbnRfID0gbnVsbDtcblxuICAgIGNvbnN0IGRvYyA9IHRoaXMuYW1wZG9jXy53aW4uZG9jdW1lbnQ7XG5cbiAgICB0aGlzLndyYXBwZXJfID0gY3JlYXRlRWxlbWVudFdpdGhBdHRyaWJ1dGVzKFxuICAgICAgICBkb2MsXG4gICAgICAgICdhbXAtc3Vic2NyaXB0aW9ucy1kaWFsb2cnLCAvKiogQHR5cGUgeyFKc29uT2JqZWN0fSAqLyAoe1xuICAgICAgICAgICdyb2xlJzogJ2RpYWxvZycsXG4gICAgICAgIH0pKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFFbGVtZW50fSAqL1xuICAgIHRoaXMuY2xvc2VCdXR0b25fID0gY3JlYXRlRWxlbWVudFdpdGhBdHRyaWJ1dGVzKFxuICAgICAgICBkb2MsXG4gICAgICAgICdidXR0b24nLCAvKiogQHR5cGUgeyFKc29uT2JqZWN0fSAqLyAoe1xuICAgICAgICAgICdjbGFzcyc6ICdpLWFtcGh0bWwtc3Vicy1kaWFsb2ctY2xvc2UtYnV0dG9uJyxcbiAgICAgICAgfSkpO1xuICAgIHRoaXMuc2hvd0Nsb3NlQWN0aW9uKGZhbHNlKTtcbiAgICB0aGlzLndyYXBwZXJfLmFwcGVuZENoaWxkKHRoaXMuY2xvc2VCdXR0b25fKTtcbiAgICB0aGlzLmNsb3NlQnV0dG9uXy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIC8vIFN0YXJ0IGhpZGRlbi5cbiAgICB0aGlzLmFtcGRvY18uZ2V0Qm9keSgpLmFwcGVuZENoaWxkKHRoaXMud3JhcHBlcl8pO1xuICAgIHNldEltcG9ydGFudFN0eWxlcyh0aGlzLndyYXBwZXJfLCB7XG4gICAgICBkaXNwbGF5OiAnbm9uZScsXG4gICAgICB0cmFuc2Zvcm06ICd0cmFuc2xhdGVZKDEwMCUpJyxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshRWxlbWVudH1cbiAgICovXG4gIGdldFJvb3QoKSB7XG4gICAgcmV0dXJuIHRoaXMud3JhcHBlcl87XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlzVmlzaWJsZSgpIHtcbiAgICByZXR1cm4gdGhpcy52aXNpYmxlXztcbiAgfVxuXG4gIC8qKlxuICAgKiBPcGVucyB0aGUgZGlhbG9nIHdpdGggdGhlIHNwZWNpZmllZCBjb250ZW50LlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBjb250ZW50XG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IHNob3dDbG9zZUFjdGlvblxuICAgKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAgICovXG4gIG9wZW4oY29udGVudCwgc2hvd0Nsb3NlQWN0aW9uID0gdHJ1ZSkge1xuICAgIGlmICh0aGlzLmNvbnRlbnRfKSB7XG4gICAgICB0aGlzLndyYXBwZXJfLnJlcGxhY2VDaGlsZChjb250ZW50LCB0aGlzLmNvbnRlbnRfKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy53cmFwcGVyXy5hcHBlbmRDaGlsZChjb250ZW50KTtcbiAgICB9XG4gICAgdGhpcy5jb250ZW50XyA9IGNvbnRlbnQ7XG4gICAgaWYgKHRoaXMudmlzaWJsZV8pIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgdGhpcy52aXNpYmxlXyA9IHRydWU7XG4gICAgcmV0dXJuIHRoaXMudnN5bmNfLm11dGF0ZVByb21pc2UoKCkgPT4ge1xuICAgICAgc2V0SW1wb3J0YW50U3R5bGVzKHRoaXMud3JhcHBlcl8sIHtcbiAgICAgICAgZGlzcGxheTogJ2Jsb2NrJyxcbiAgICAgIH0pO1xuICAgICAgdGhpcy5zaG93Q2xvc2VBY3Rpb24oLyoqIEB0eXBlIHtib29sZWFufSAqLyAoc2hvd0Nsb3NlQWN0aW9uKSk7XG4gICAgfSkudGhlbigoKSA9PiB7XG4gICAgICAvLyBBbmltYXRlIHRvIGRpc3BsYXkuXG4gICAgICByZXR1cm4gdGhpcy52c3luY18ubXV0YXRlUHJvbWlzZSgoKSA9PiB7XG4gICAgICAgIHNldEltcG9ydGFudFN0eWxlcyh0aGlzLndyYXBwZXJfLCB7XG4gICAgICAgICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgwKScsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy50aW1lcl8ucHJvbWlzZSgzMDApO1xuICAgICAgfSk7XG4gICAgfSkudGhlbigoKSA9PiB7XG4gICAgICAvLyBVcGRhdGUgcGFnZSBsYXlvdXQuXG4gICAgICBsZXQgb2Zmc2V0SGVpZ2h0O1xuICAgICAgcmV0dXJuIHRoaXMudnN5bmNfLnJ1blByb21pc2Uoe1xuICAgICAgICBtZWFzdXJlOiAoKSA9PiB7XG4gICAgICAgICAgb2Zmc2V0SGVpZ2h0ID0gdGhpcy53cmFwcGVyXy4vKk9LKi9vZmZzZXRIZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIG11dGF0ZTogKCkgPT4ge1xuICAgICAgICAgIHRoaXMudmlld3BvcnRfLnVwZGF0ZVBhZGRpbmdCb3R0b20ob2Zmc2V0SGVpZ2h0KTtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENsb3NlcyB0aGUgZGlhbG9nLlxuICAgKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAgICovXG4gIGNsb3NlKCkge1xuICAgIGlmICghdGhpcy52aXNpYmxlXykge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy52c3luY18ubXV0YXRlUHJvbWlzZSgoKSA9PiB7XG4gICAgICBzZXRJbXBvcnRhbnRTdHlsZXModGhpcy53cmFwcGVyXywge1xuICAgICAgICB0cmFuc2Zvcm06ICd0cmFuc2xhdGVZKDEwMCUpJyxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaXMudGltZXJfLnByb21pc2UoMzAwKTtcbiAgICB9KS50aGVuKCgpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLnZzeW5jXy5tdXRhdGVQcm9taXNlKCgpID0+IHtcbiAgICAgICAgc2V0SW1wb3J0YW50U3R5bGVzKHRoaXMud3JhcHBlcl8sIHtcbiAgICAgICAgICBkaXNwbGF5OiAnbm9uZScsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnZpZXdwb3J0Xy51cGRhdGVQYWRkaW5nQm90dG9tKDApO1xuICAgICAgICB0aGlzLnZpc2libGVfID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXJzIG9yIGhpZGVzIHRoZSBcIkNsb3NlXCIgYWN0aW9uIGJ1dHRvbi4gRm9yIHNvbWUgZmxvd3MsIHRoaXMgYnV0dG9uXG4gICAqIHNob3VsZCBiZSBoaWRkZW4uXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gc2hvd1xuICAgKi9cbiAgc2hvd0Nsb3NlQWN0aW9uKHNob3cpIHtcbiAgICB0b2dnbGUodGhpcy5jbG9zZUJ1dHRvbl8sIHNob3cpO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtEb2N9IGZyb20gJy4uLy4uLy4uL3RoaXJkX3BhcnR5L3N1YnNjcmlwdGlvbnMtcHJvamVjdC9jb25maWcnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4uLy4uLy4uL3NyYy9sb2cnO1xuXG5cbi8qKlxuICogQWRvcHRzIGNvbmZpZyBkb2N1bWVudCB0byBhbXBkb2MuXG4gKiBAaW1wbGVtZW50cyB7RG9jfVxuICovXG5leHBvcnQgY2xhc3MgRG9jSW1wbCB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhbXBkb2MpIHtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshLi4vLi4vLi4vc3JjL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSAqL1xuICAgIHRoaXMuYW1wZG9jXyA9IGFtcGRvYztcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgZ2V0V2luKCkge1xuICAgIHJldHVybiB0aGlzLmFtcGRvY18ud2luO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBnZXRSb290Tm9kZSgpIHtcbiAgICByZXR1cm4gdGhpcy5hbXBkb2NfLmdldFJvb3ROb2RlKCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGdldFJvb3RFbGVtZW50KCkge1xuICAgIGNvbnN0IHJvb3QgPSB0aGlzLmFtcGRvY18uZ2V0Um9vdE5vZGUoKTtcbiAgICByZXR1cm4gZGV2KCkuYXNzZXJ0RWxlbWVudChyb290LmRvY3VtZW50RWxlbWVudCB8fCByb290LmJvZHkgfHwgcm9vdCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGdldEhlYWQoKSB7XG4gICAgcmV0dXJuIGRldigpLmFzc2VydEVsZW1lbnQodGhpcy5hbXBkb2NfLmdldEhlYWROb2RlKCkpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBnZXRCb2R5KCkge1xuICAgIHJldHVybiB0aGlzLmFtcGRvY18uaXNCb2R5QXZhaWxhYmxlKCkgPyB0aGlzLmFtcGRvY18uZ2V0Qm9keSgpIDogbnVsbDtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgaXNSZWFkeSgpIHtcbiAgICByZXR1cm4gdGhpcy5hbXBkb2NfLmlzUmVhZHkoKTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgd2hlblJlYWR5KCkge1xuICAgIHJldHVybiB0aGlzLmFtcGRvY18ud2hlblJlYWR5KCk7XG4gIH1cbn1cblxuXG4vKiogQHBhY2thZ2UgVmlzaWJsZSBmb3IgdGVzdGluZyBvbmx5LiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldERvY0NsYXNzRm9yVGVzdGluZygpIHtcbiAgcmV0dXJuIERvYztcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHtkaWN0fSBmcm9tICcuLi8uLi8uLi9zcmMvdXRpbHMvb2JqZWN0JztcblxuLyoqIEBlbnVtIHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgR3JhbnRSZWFzb24gPSB7XG4gICdTVUJTQ1JJQkVSJzogJ1NVQlNDUklCRVInLFxuICAnTUVURVJJTkcnOiAnTUVURVJJTkcnLFxufTtcblxuLyoqXG4gKiBUaGUgc2luZ2xlIGVudGl0bGVtZW50IG9iamVjdC5cbiAqL1xuZXhwb3J0IGNsYXNzIEVudGl0bGVtZW50IHtcblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VcbiAgICogQHJldHVybiB7IUVudGl0bGVtZW50fVxuICAgKi9cbiAgc3RhdGljIGVtcHR5KHNlcnZpY2UpIHtcbiAgICByZXR1cm4gbmV3IEVudGl0bGVtZW50KHtcbiAgICAgIHNvdXJjZTogJycsXG4gICAgICByYXc6ICcnLFxuICAgICAgc2VydmljZSxcbiAgICAgIGdyYW50ZWQ6IGZhbHNlLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBpbnB1dFxuICAgKiBAcGFyYW0ge3N0cmluZ30gW2lucHV0LnNvdXJjZV1cbiAgICogQHBhcmFtIHtzdHJpbmd9IFtpbnB1dC5yYXddXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBbaW5wdXQuc2VydmljZV1cbiAgICogQHBhcmFtIHtib29sZWFufSBbaW5wdXQuZ3JhbnRlZF1cbiAgICogQHBhcmFtIHs/R3JhbnRSZWFzb259IFtpbnB1dC5ncmFudFJlYXNvbl1cbiAgICogQHBhcmFtIHs/SnNvbk9iamVjdH0gW2lucHV0LmRhdGFPYmplY3RdXG4gICAqL1xuICBjb25zdHJ1Y3Rvcih7c291cmNlLCByYXcgPSAnJywgc2VydmljZSwgZ3JhbnRlZCA9IGZhbHNlLFxuICAgIGdyYW50UmVhc29uID0gJycsIGRhdGFPYmplY3R9KSB7XG4gICAgLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuICAgIHRoaXMucmF3ID0gcmF3O1xuICAgIC8qKiBAY29uc3Qge3N0cmluZ30gKi9cbiAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAvKioge3N0cmluZ30gKi9cbiAgICB0aGlzLnNlcnZpY2UgPSBzZXJ2aWNlO1xuICAgIC8qKiBAY29uc3Qge2Jvb2xlYW59ICovXG4gICAgdGhpcy5ncmFudGVkID0gZ3JhbnRlZDtcbiAgICAvKiogQGNvbnN0IHs/c3RyaW5nfSAqL1xuICAgIHRoaXMuZ3JhbnRSZWFzb24gPSBncmFudFJlYXNvbjtcbiAgICAvKiogQGNvbnN0IHs/SnNvbk9iamVjdH0gKi9cbiAgICB0aGlzLmRhdGEgPSBkYXRhT2JqZWN0O1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMganNvbiBmb3JtYXQgb2YgZW50aXRsZW1lbnRzXG4gICAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICAgKi9cbiAganNvbigpIHtcbiAgICBjb25zdCBlbnRpdGxlbWVudEpzb24gPSBkaWN0KHtcbiAgICAgICdzb3VyY2UnOiB0aGlzLnNvdXJjZSxcbiAgICAgICdzZXJ2aWNlJzogdGhpcy5zZXJ2aWNlLFxuICAgICAgJ2dyYW50ZWQnOiB0aGlzLmdyYW50ZWQsXG4gICAgICAnZ3JhbnRSZWFzb24nOiB0aGlzLmdyYW50UmVhc29uLFxuICAgICAgJ2RhdGEnOiB0aGlzLmRhdGEsXG4gICAgfSk7XG4gICAgcmV0dXJuIChlbnRpdGxlbWVudEpzb24pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMganNvbiB0byBiZSB1c2VkIGZvciBwaW5nYmFjay5cbiAgICpcbiAgICogQHJldHVybiB7IUpzb25PYmplY3R9XG4gICAqL1xuICBqc29uRm9yUGluZ2JhY2soKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovIChPYmplY3QuYXNzaWduKHt9LFxuICAgICAgICB7J3Jhdyc6IHRoaXMucmF3fSxcbiAgICAgICAgdGhpcy5qc29uKCkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gez9Kc29uT2JqZWN0fSBqc29uXG4gICAqIEBwYXJhbSB7P3N0cmluZ30gcmF3RGF0YVxuICAgKiBAcmV0dXJuIHshRW50aXRsZW1lbnR9XG4gICAqL1xuICBzdGF0aWMgcGFyc2VGcm9tSnNvbihqc29uLCByYXdEYXRhID0gbnVsbCkge1xuICAgIGlmICghanNvbikge1xuICAgICAganNvbiA9IGRpY3QoKTtcbiAgICB9XG4gICAgY29uc3QgcmF3ID0gcmF3RGF0YSB8fCBKU09OLnN0cmluZ2lmeShqc29uKTtcbiAgICBjb25zdCBzb3VyY2UgPSBqc29uWydzb3VyY2UnXSB8fCAnJztcbiAgICBjb25zdCBncmFudGVkID0ganNvblsnZ3JhbnRlZCddIHx8IGZhbHNlO1xuICAgIGNvbnN0IGdyYW50UmVhc29uID0ganNvblsnZ3JhbnRSZWFzb24nXTtcbiAgICBjb25zdCBkYXRhT2JqZWN0ID0ganNvblsnZGF0YSddIHx8IG51bGw7XG4gICAgcmV0dXJuIG5ldyBFbnRpdGxlbWVudCh7c291cmNlLCByYXcsIHNlcnZpY2U6ICcnLFxuICAgICAgZ3JhbnRlZCwgZ3JhbnRSZWFzb24sIGRhdGFPYmplY3R9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGlmIHRoZSB1c2VyIGlzIGEgc3Vic2NyaWJlci5cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlzU3Vic2NyaWJlcigpIHtcbiAgICByZXR1cm4gdGhpcy5ncmFudGVkICYmIHRoaXMuZ3JhbnRSZWFzb24gPT09IEdyYW50UmVhc29uLlNVQlNDUklCRVI7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2V2YWx1YXRlQWNjZXNzRXhwcn0gZnJvbSAnLi4vLi4vYW1wLWFjY2Vzcy8wLjEvYWNjZXNzLWV4cHInO1xuXG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IGV4cHJcbiAqIEBwYXJhbSB7IUpzb25PYmplY3R9IGRhdGFcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBldmFsdWF0ZUV4cHIoZXhwciwgZGF0YSkge1xuICByZXR1cm4gZXZhbHVhdGVBY2Nlc3NFeHByKGV4cHIsIGRhdGEpO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7RW50aXRsZW1lbnR9IGZyb20gJy4vZW50aXRsZW1lbnQnO1xuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi4vLi4vLi4vc3JjL3NlcnZpY2VzJztcbmltcG9ydCB7ZXZhbHVhdGVFeHByfSBmcm9tICcuL2V4cHInO1xuXG4vKipcbiAqIFRoaXMgaW1wbGVtZW50cyB0aGUgcmVuZGVyaW5nIG1ldGhvZHMgZm9yIGxvY2FsIHBsYXRmb3JtLlxuICpcbiAqL1xuZXhwb3J0IGNsYXNzIExvY2FsU3Vic2NyaXB0aW9uUGxhdGZvcm1SZW5kZXJlciB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gICAqIEBwYXJhbSB7IS4vZGlhbG9nLkRpYWxvZ30gZGlhbG9nXG4gICAqIEBwYXJhbSB7IS4vc2VydmljZS1hZGFwdGVyLlNlcnZpY2VBZGFwdGVyfSBzZXJ2aWNlQWRhcHRlclxuICAgKi9cbiAgY29uc3RydWN0b3IoYW1wZG9jLCBkaWFsb2csIHNlcnZpY2VBZGFwdGVyKSB7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCAqL1xuICAgIHRoaXMuYW1wZG9jXyA9IGFtcGRvYztcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgKi9cbiAgICB0aGlzLnJvb3ROb2RlXyA9IGFtcGRvYy5nZXRSb290Tm9kZSgpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IS4vZGlhbG9nLkRpYWxvZ30gKi9cbiAgICB0aGlzLmRpYWxvZ18gPSBkaWFsb2c7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshLi4vLi4vLi4vc3JjL3NlcnZpY2UvdGVtcGxhdGUtaW1wbC5UZW1wbGF0ZXN9ICovXG4gICAgdGhpcy50ZW1wbGF0ZXNfID0gU2VydmljZXMudGVtcGxhdGVzRm9yKGFtcGRvYy53aW4pO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IS4vc2VydmljZS1hZGFwdGVyLlNlcnZpY2VBZGFwdGVyfSAqL1xuICAgIHRoaXMuc2VydmljZUFkYXB0ZXJfID0gc2VydmljZUFkYXB0ZXI7XG4gIH1cblxuICAvKipcbiAgICpcbiAgICogQHBhcmFtIHshSnNvbk9iamVjdH0gcmVuZGVyU3RhdGVcbiAgICovXG4gIHJlbmRlcihyZW5kZXJTdGF0ZSkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbXG4gICAgICB0aGlzLnJlbmRlckFjdGlvbnNfKHJlbmRlclN0YXRlKSxcbiAgICAgIHRoaXMucmVuZGVyRGlhbG9nXygvKiogQHR5cGUgeyFKc29uT2JqZWN0fSAqLyhyZW5kZXJTdGF0ZSkpLFxuICAgIF0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUpzb25PYmplY3R9IHJlbmRlclN0YXRlXG4gICAqL1xuICByZW5kZXJBY3Rpb25zXyhyZW5kZXJTdGF0ZSkge1xuICAgIHRoaXMucmVuZGVyQWN0aW9uc0luTm9kZV8ocmVuZGVyU3RhdGUsIHRoaXMucm9vdE5vZGVfKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFKc29uT2JqZWN0fSBhdXRoUmVzcG9uc2VcbiAgICogQHJldHVybiB7IVByb21pc2U8Ym9vbGVhbj59XG4gICAqL1xuICByZW5kZXJEaWFsb2dfKGF1dGhSZXNwb25zZSkge1xuICAgIC8vIE1ha2Ugc3VyZSB0aGUgZG9jdW1lbnQgaXMgZnVsbHkgcGFyc2VkLlxuICAgIHJldHVybiB0aGlzLmFtcGRvY18ud2hlblJlYWR5KCkudGhlbigoKSA9PiB7XG4gICAgICAvLyBGaW5kIHRoZSBmaXJzdCBtYXRjaGluZyBkaWFsb2cuXG4gICAgICBjb25zdCBjYW5kaWRhdGVzID0gdGhpcy5hbXBkb2NfLmdldFJvb3ROb2RlKClcbiAgICAgICAgICAucXVlcnlTZWxlY3RvckFsbCgnW3N1YnNjcmlwdGlvbnMtZGlhbG9nXVtzdWJzY3JpcHRpb25zLWRpc3BsYXldJyk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNhbmRpZGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgY2FuZGlkYXRlID0gY2FuZGlkYXRlc1tpXTtcbiAgICAgICAgY29uc3QgZXhwciA9IGNhbmRpZGF0ZS5nZXRBdHRyaWJ1dGUoJ3N1YnNjcmlwdGlvbnMtZGlzcGxheScpO1xuICAgICAgICBpZiAoZXhwciAmJiBldmFsdWF0ZUV4cHIoZXhwciwgYXV0aFJlc3BvbnNlKSkge1xuICAgICAgICAgIHJldHVybiBjYW5kaWRhdGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KS50aGVuKGNhbmRpZGF0ZSA9PiB7XG4gICAgICBpZiAoIWNhbmRpZGF0ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoY2FuZGlkYXRlLnRhZ05hbWUgPT0gJ1RFTVBMQVRFJykge1xuICAgICAgICByZXR1cm4gdGhpcy50ZW1wbGF0ZXNfLnJlbmRlclRlbXBsYXRlKGNhbmRpZGF0ZSwgYXV0aFJlc3BvbnNlKVxuICAgICAgICAgICAgLnRoZW4oZWxlbWVudCA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHJlbmRlclN0YXRlID1cbiAgICAgICAgICAgICAgICAvKiogQHR5cGUgeyFKc29uT2JqZWN0fSAqLyhhdXRoUmVzcG9uc2UpO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJBY3Rpb25zSW5Ob2RlXyhcbiAgICAgICAgICAgICAgICAgIHJlbmRlclN0YXRlLFxuICAgICAgICAgICAgICAgICAgZWxlbWVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNsb25lID0gY2FuZGlkYXRlLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgIGNsb25lLnJlbW92ZUF0dHJpYnV0ZSgnc3Vic2NyaXB0aW9ucy1kaWFsb2cnKTtcbiAgICAgIGNsb25lLnJlbW92ZUF0dHJpYnV0ZSgnc3Vic2NyaXB0aW9ucy1kaXNwbGF5Jyk7XG4gICAgICByZXR1cm4gY2xvbmU7XG4gICAgfSkudGhlbihlbGVtZW50ID0+IHtcbiAgICAgIGlmICghZWxlbWVudCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5kaWFsb2dfLm9wZW4oZWxlbWVudCwgLyogc2hvd0Nsb3NlQnV0dG9uICovIHRydWUpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgYWN0aW9ucyBpbnNpZGUgYSBnaXZlbiBub2RlIGFjY29yZGluZyB0byBhbiBhdXRoUmVzcG9uc2VcbiAgICogQHBhcmFtIHshSnNvbk9iamVjdH0gcmVuZGVyU3RhdGVcbiAgICogQHBhcmFtIHshTm9kZX0gcm9vdE5vZGVcbiAgICogQHJldHVybiB7IVByb21pc2U8Tm9kZT59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICByZW5kZXJBY3Rpb25zSW5Ob2RlXyhyZW5kZXJTdGF0ZSwgcm9vdE5vZGUpIHtcbiAgICByZXR1cm4gdGhpcy5hbXBkb2NfLndoZW5SZWFkeSgpLnRoZW4oKCkgPT4ge1xuICAgICAgLy8gRmluZCB0aGUgbWF0Y2hpbmcgYWN0aW9ucyBhbmQgc2VjdGlvbnMgYW5kIG1ha2UgdGhlbSB2aXNpYmxlIGlmXG4gICAgICAvLyBldmFsdXRlcyB0byB0cnVlLlxuICAgICAgY29uc3QgcXVlcnlTZWxlY3RvcnMgPVxuICAgICAgICAgICdbc3Vic2NyaXB0aW9ucy1hY3Rpb25dLCBbc3Vic2NyaXB0aW9ucy1zZWN0aW9uPVwiYWN0aW9uc1wiXSwnXG4gICAgICAgICAgICAgICsgJyBbc3Vic2NyaXB0aW9ucy1hY3Rpb25zXSc7XG4gICAgICBjb25zdCBhY3Rpb25DYW5kaWRhdGVzID0gcm9vdE5vZGUucXVlcnlTZWxlY3RvckFsbChxdWVyeVNlbGVjdG9ycyk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFjdGlvbkNhbmRpZGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgY2FuZGlkYXRlID0gYWN0aW9uQ2FuZGlkYXRlc1tpXTtcbiAgICAgICAgY29uc3QgZXhwciA9IGNhbmRpZGF0ZS5nZXRBdHRyaWJ1dGUoJ3N1YnNjcmlwdGlvbnMtZGlzcGxheScpO1xuICAgICAgICBpZiAoZXhwciAmJiBldmFsdWF0ZUV4cHIoZXhwcixcbiAgICAgICAgICAgIC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovKHJlbmRlclN0YXRlKSkpIHtcbiAgICAgICAgICBjYW5kaWRhdGUuY2xhc3NMaXN0LmFkZCgnaS1hbXBodG1sLXN1YnMtZGlzcGxheScpO1xuICAgICAgICAgIGlmIChjYW5kaWRhdGUuZ2V0QXR0cmlidXRlKCdzdWJzY3JpcHRpb25zLXNlcnZpY2UnKVxuICAgICAgICAgICAgJiYgY2FuZGlkYXRlLmdldEF0dHJpYnV0ZSgnc3Vic2NyaXB0aW9ucy1hY3Rpb24nKVxuICAgICAgICAgICAgJiYgY2FuZGlkYXRlLmdldEF0dHJpYnV0ZSgnc3Vic2NyaXB0aW9ucy1kZWNvcmF0ZScpICE9PSAnZmFsc2UnKSB7XG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VBZGFwdGVyXy5kZWNvcmF0ZVNlcnZpY2VBY3Rpb24oXG4gICAgICAgICAgICAgICAgY2FuZGlkYXRlLFxuICAgICAgICAgICAgICAgIGNhbmRpZGF0ZS5nZXRBdHRyaWJ1dGUoJ3N1YnNjcmlwdGlvbnMtc2VydmljZScpLFxuICAgICAgICAgICAgICAgIGNhbmRpZGF0ZS5nZXRBdHRyaWJ1dGUoJ3N1YnNjcmlwdGlvbnMtYWN0aW9uJyksXG4gICAgICAgICAgICAgICAgbnVsbFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2FuZGlkYXRlLmNsYXNzTGlzdC5yZW1vdmUoJ2ktYW1waHRtbC1zdWJzLWRpc3BsYXknKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJvb3ROb2RlO1xuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICogVE9ETyhkdm95dGVua28pOiByZW1vdmUgb25jZSBjb21waWxlciB0eXBlIGNoZWNraW5nIGlzIGZpeGVkIGZvciB0aGlyZF9wYXJ0eS5cbiAqIEBwYWNrYWdlIEBWaXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RW50aXRsZW1lbnRDbGFzc0ZvclRlc3RpbmcoKSB7XG4gIHJldHVybiBFbnRpdGxlbWVudDtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge0FjdGlvbnN9IGZyb20gJy4vYWN0aW9ucyc7XG5pbXBvcnQge0VudGl0bGVtZW50fSBmcm9tICcuL2VudGl0bGVtZW50JztcbmltcG9ydCB7TG9jYWxTdWJzY3JpcHRpb25QbGF0Zm9ybVJlbmRlcmVyfSBmcm9tICcuL2xvY2FsLXN1YnNjcmlwdGlvbi1wbGF0Zm9ybS1yZW5kZXJlcic7XG5pbXBvcnQge1BhZ2VDb25maWd9IGZyb20gJy4uLy4uLy4uL3RoaXJkX3BhcnR5L3N1YnNjcmlwdGlvbnMtcHJvamVjdC9jb25maWcnO1xuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi4vLi4vLi4vc3JjL3NlcnZpY2VzJztcbmltcG9ydCB7VXJsQnVpbGRlcn0gZnJvbSAnLi91cmwtYnVpbGRlcic7XG5pbXBvcnQge2Fzc2VydEh0dHBzVXJsfSBmcm9tICcuLi8uLi8uLi9zcmMvdXJsJztcbmltcG9ydCB7Y2xvc2VzdEJ5U2VsZWN0b3J9IGZyb20gJy4uLy4uLy4uL3NyYy9kb20nO1xuaW1wb3J0IHtkZXYsIHVzZXJ9IGZyb20gJy4uLy4uLy4uL3NyYy9sb2cnO1xuaW1wb3J0IHtkaWN0fSBmcm9tICcuLi8uLi8uLi9zcmMvdXRpbHMvb2JqZWN0JztcblxuXG4vKipcbiAqIFRoaXMgaW1wbGVtZW50cyB0aGUgbWV0aG9kcyB0byBpbnRlcmFjdCB3aXRoIHZhcmlvdXMgc3Vic2NyaXB0aW9uIHBsYXRmb3Jtcy5cbiAqXG4gKiBAaW1wbGVtZW50cyB7Li9zdWJzY3JpcHRpb24tcGxhdGZvcm0uU3Vic2NyaXB0aW9uUGxhdGZvcm19XG4gKi9cbmV4cG9ydCBjbGFzcyBMb2NhbFN1YnNjcmlwdGlvblBsYXRmb3JtIHtcblxuICAvKipcbiAgICogQHBhcmFtIHshLi4vLi4vLi4vc3JjL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAgICogQHBhcmFtIHshSnNvbk9iamVjdH0gcGxhdGZvcm1Db25maWdcbiAgICogQHBhcmFtIHshLi9zZXJ2aWNlLWFkYXB0ZXIuU2VydmljZUFkYXB0ZXJ9IHNlcnZpY2VBZGFwdGVyXG4gICAqIEBwYXJhbSB7IS4vYW5hbHl0aWNzLlN1YnNjcmlwdGlvbkFuYWx5dGljc30gc3Vic2NyaXB0aW9uQW5hbHl0aWNzXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhbXBkb2MsIHBsYXRmb3JtQ29uZmlnLCBzZXJ2aWNlQWRhcHRlciwgc3Vic2NyaXB0aW9uQW5hbHl0aWNzKSB7XG4gICAgLyoqIEBjb25zdCAqL1xuICAgIHRoaXMuYW1wZG9jXyA9IGFtcGRvYztcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgKi9cbiAgICB0aGlzLnJvb3ROb2RlXyA9IGFtcGRvYy5nZXRSb290Tm9kZSgpO1xuXG4gICAgLyoqIEBjb25zdCBAcHJpdmF0ZSB7IUpzb25PYmplY3R9ICovXG4gICAgdGhpcy5zZXJ2aWNlQ29uZmlnXyA9IHBsYXRmb3JtQ29uZmlnO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IS4vc2VydmljZS1hZGFwdGVyLlNlcnZpY2VBZGFwdGVyfSAqL1xuICAgIHRoaXMuc2VydmljZUFkYXB0ZXJfID0gc2VydmljZUFkYXB0ZXI7XG5cbiAgICAvKiogQGNvbnN0IEBwcml2YXRlIHshLi4vLi4vLi4vc3JjL3NlcnZpY2UveGhyLWltcGwuWGhyfSAqL1xuICAgIHRoaXMueGhyXyA9IFNlcnZpY2VzLnhockZvcih0aGlzLmFtcGRvY18ud2luKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge3N0cmluZ30gKi9cbiAgICB0aGlzLmF1dGhvcml6YXRpb25VcmxfID0gYXNzZXJ0SHR0cHNVcmwoXG4gICAgICAgIHVzZXIoKS5hc3NlcnQoXG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VDb25maWdfWydhdXRob3JpemF0aW9uVXJsJ10sXG4gICAgICAgICAgICAnU2VydmljZSBjb25maWcgZG9lcyBub3QgaGF2ZSBhdXRob3JpemF0aW9uIFVybCdcbiAgICAgICAgKSxcbiAgICAgICAgJ0F1dGhvcml6YXRpb24gVXJsJ1xuICAgICk7XG5cbiAgICAvKiogQHByaXZhdGUgeyFVcmxCdWlsZGVyfSAqL1xuICAgIHRoaXMudXJsQnVpbGRlcl8gPSBuZXcgVXJsQnVpbGRlcihcbiAgICAgICAgdGhpcy5hbXBkb2NfLFxuICAgICAgICB0aGlzLnNlcnZpY2VBZGFwdGVyXy5nZXRSZWFkZXJJZCgnbG9jYWwnKSk7XG5cbiAgICAvKiogQHByaXZhdGUgeyEuL2FuYWx5dGljcy5TdWJzY3JpcHRpb25BbmFseXRpY3N9ICovXG4gICAgdGhpcy5zdWJzY3JpcHRpb25BbmFseXRpY3NfID0gc3Vic2NyaXB0aW9uQW5hbHl0aWNzO1xuXG4gICAgdXNlcigpLmFzc2VydCh0aGlzLnNlcnZpY2VDb25maWdfWydhY3Rpb25zJ10sXG4gICAgICAgICdBY3Rpb25zIGhhdmUgbm90IGJlZW4gZGVmaW5lZCBpbiB0aGUgc2VydmljZSBjb25maWcnKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IUFjdGlvbnN9ICovXG4gICAgdGhpcy5hY3Rpb25zXyA9IG5ldyBBY3Rpb25zKFxuICAgICAgICB0aGlzLmFtcGRvY18sIHRoaXMudXJsQnVpbGRlcl8sXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uQW5hbHl0aWNzXyxcbiAgICAgICAgdGhpcy52YWxpZGF0ZUFjdGlvbk1hcCh0aGlzLnNlcnZpY2VDb25maWdfWydhY3Rpb25zJ10pXG4gICAgKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IUxvY2FsU3Vic2NyaXB0aW9uUGxhdGZvcm1SZW5kZXJlcn0qL1xuICAgIHRoaXMucmVuZGVyZXJfID0gbmV3IExvY2FsU3Vic2NyaXB0aW9uUGxhdGZvcm1SZW5kZXJlcih0aGlzLmFtcGRvY18sXG4gICAgICAgIHNlcnZpY2VBZGFwdGVyLmdldERpYWxvZygpLCB0aGlzLnNlcnZpY2VBZGFwdGVyXyk7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHs/c3RyaW5nfSAqL1xuICAgIHRoaXMucGluZ2JhY2tVcmxfID0gdGhpcy5zZXJ2aWNlQ29uZmlnX1sncGluZ2JhY2tVcmwnXSB8fCBudWxsO1xuXG4gICAgdGhpcy5pbml0aWFsaXplTGlzdGVuZXJzXygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBvdmVycmlkZVxuICAgKi9cbiAgZ2V0U2VydmljZUlkKCkge1xuICAgIHJldHVybiAnbG9jYWwnO1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlcyB0aGUgYWN0aW9uIG1hcFxuICAgKiBAcGFyYW0geyFKc29uT2JqZWN0PHN0cmluZywgc3RyaW5nPn0gYWN0aW9uTWFwXG4gICAqIEByZXR1cm4geyFKc29uT2JqZWN0PHN0cmluZywgc3RyaW5nPn1cbiAgICovXG4gIHZhbGlkYXRlQWN0aW9uTWFwKGFjdGlvbk1hcCkge1xuICAgIHVzZXIoKS5hc3NlcnQoYWN0aW9uTWFwWydsb2dpbiddLFxuICAgICAgICAnQWN0aW9uIFwibG9naW5cIiBpcyBub3QgcHJlc2VudCBpbiBhY3Rpb24gbWFwJyk7XG4gICAgdXNlcigpLmFzc2VydChhY3Rpb25NYXBbJ3N1YnNjcmliZSddLFxuICAgICAgICAnQWN0aW9uIFwic3Vic2NyaWJlXCIgaXMgbm90IHByZXNlbnQgaW4gYWN0aW9uIG1hcCcpO1xuICAgIHJldHVybiBhY3Rpb25NYXA7XG4gIH1cblxuICAvKipcbiAgICogQWRkIGV2ZW50IGxpc3RlbmVyIGZvciB0aGUgc3Vic2NyaXB0aW9ucyBhY3Rpb25cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGluaXRpYWxpemVMaXN0ZW5lcnNfKCkge1xuICAgIHRoaXMucm9vdE5vZGVfLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG4gICAgICBjb25zdCBlbGVtZW50ID0gY2xvc2VzdEJ5U2VsZWN0b3IoZGV2KCkuYXNzZXJ0RWxlbWVudChlLnRhcmdldCksXG4gICAgICAgICAgJ1tzdWJzY3JpcHRpb25zLWFjdGlvbl0nKTtcbiAgICAgIHRoaXMuaGFuZGxlQ2xpY2tfKGVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBjbGljayBvbiBzdWJzY3JpcHRpb24tYWN0aW9uXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7Tm9kZX0gZWxlbWVudFxuICAgKi9cbiAgaGFuZGxlQ2xpY2tfKGVsZW1lbnQpIHtcbiAgICBpZiAoZWxlbWVudCkge1xuICAgICAgY29uc3QgYWN0aW9uID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3N1YnNjcmlwdGlvbnMtYWN0aW9uJyk7XG4gICAgICBjb25zdCBzZXJ2aWNlQXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdzdWJzY3JpcHRpb25zLXNlcnZpY2UnKTtcbiAgICAgIGlmIChzZXJ2aWNlQXR0ciA9PSAnbG9jYWwnKSB7XG4gICAgICAgIHRoaXMuZXhlY3V0ZUFjdGlvbihhY3Rpb24pO1xuICAgICAgfSBlbHNlIGlmICgoc2VydmljZUF0dHIgfHwgJ2F1dG8nKSA9PSAnYXV0bycpIHtcbiAgICAgICAgaWYgKGFjdGlvbiA9PSAnbG9naW4nKSB7XG4gICAgICAgICAgLy8gVGhlIFwibG9naW5cIiBhY3Rpb24gaXMgc29tZXdoYXQgc3BlY2lhbCBiL2Mgdmlld2VycyBjYW5cbiAgICAgICAgICAvLyBlbmhhbmNlIHRoaXMgYWN0aW9uLCBlLmcuIHRvIHByb3ZpZGUgc2F2ZS9saW5rIGZlYXR1cmUuXG4gICAgICAgICAgY29uc3QgcGxhdGZvcm0gPSB0aGlzLnNlcnZpY2VBZGFwdGVyXy5zZWxlY3RQbGF0Zm9ybUZvckxvZ2luKCk7XG4gICAgICAgICAgdGhpcy5zZXJ2aWNlQWRhcHRlcl8uZGVsZWdhdGVBY3Rpb25Ub1NlcnZpY2UoXG4gICAgICAgICAgICAgIGFjdGlvbiwgcGxhdGZvcm0uZ2V0U2VydmljZUlkKCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuZXhlY3V0ZUFjdGlvbihhY3Rpb24pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHNlcnZpY2VBdHRyKSB7XG4gICAgICAgIHRoaXMuc2VydmljZUFkYXB0ZXJfLmRlbGVnYXRlQWN0aW9uVG9TZXJ2aWNlKGFjdGlvbiwgc2VydmljZUF0dHIpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgYWN0aXZhdGUoZW50aXRsZW1lbnQpIHtcbiAgICBjb25zdCByZW5kZXJTdGF0ZSA9IGVudGl0bGVtZW50Lmpzb24oKTtcbiAgICB0aGlzLnVybEJ1aWxkZXJfLnNldEF1dGhSZXNwb25zZShyZW5kZXJTdGF0ZSk7XG4gICAgdGhpcy5hY3Rpb25zXy5idWlsZCgpLnRoZW4oKCkgPT4ge1xuICAgICAgdGhpcy5yZW5kZXJlcl8ucmVuZGVyKHJlbmRlclN0YXRlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgZXhlY3V0ZUFjdGlvbihhY3Rpb24pIHtcbiAgICBjb25zdCBhY3Rpb25FeGVjdXRpb24gPSB0aGlzLmFjdGlvbnNfLmV4ZWN1dGUoYWN0aW9uKTtcbiAgICByZXR1cm4gYWN0aW9uRXhlY3V0aW9uLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgdGhpcy5zZXJ2aWNlQWRhcHRlcl8ucmVBdXRob3JpemVQbGF0Zm9ybSh0aGlzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAhIXJlc3VsdDtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgZ2V0RW50aXRsZW1lbnRzKCkge1xuICAgIHJldHVybiB0aGlzLnVybEJ1aWxkZXJfLmJ1aWxkVXJsKHRoaXMuYXV0aG9yaXphdGlvblVybF8sXG4gICAgICAgIC8qIHVzZUF1dGhEYXRhICovIGZhbHNlKVxuICAgICAgICAudGhlbihmZXRjaFVybCA9PlxuICAgICAgICAgIHRoaXMueGhyXy5mZXRjaEpzb24oZmV0Y2hVcmwsIHtjcmVkZW50aWFsczogJ2luY2x1ZGUnfSlcbiAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXG4gICAgICAgICAgICAgIC50aGVuKHJlc0pzb24gPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBFbnRpdGxlbWVudC5wYXJzZUZyb21Kc29uKHJlc0pzb24pO1xuICAgICAgICAgICAgICB9KSk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGlzUGluZ2JhY2tFbmFibGVkKCkge1xuICAgIHJldHVybiAhIXRoaXMucGluZ2JhY2tVcmxfO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBwaW5nYmFjayhzZWxlY3RlZEVudGl0bGVtZW50KSB7XG4gICAgaWYgKCF0aGlzLmlzUGluZ2JhY2tFbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHBpbmdiYWNrVXJsID0gLyoqIEB0eXBlIHtzdHJpbmd9ICovIChkZXYoKS5hc3NlcnQodGhpcy5waW5nYmFja1VybF8sXG4gICAgICAgICdwaW5nYmFja1VybCBpcyBudWxsJykpO1xuXG4gICAgY29uc3QgcHJvbWlzZSA9IHRoaXMudXJsQnVpbGRlcl8uYnVpbGRVcmwocGluZ2JhY2tVcmwsXG4gICAgICAgIC8qIHVzZUF1dGhEYXRhICovIHRydWUpO1xuICAgIHJldHVybiBwcm9taXNlLnRoZW4odXJsID0+IHtcbiAgICAgIHJldHVybiB0aGlzLnhocl8uc2VuZFNpZ25hbCh1cmwsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZScsXG4gICAgICAgIGhlYWRlcnM6IGRpY3Qoe1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbicsXG4gICAgICAgIH0pLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShzZWxlY3RlZEVudGl0bGVtZW50Lmpzb25Gb3JQaW5nYmFjaygpKSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBzdXBwb3J0c0N1cnJlbnRWaWV3ZXIoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBnZXRCYXNlU2NvcmUoKSB7XG4gICAgcmV0dXJuIHRoaXMuc2VydmljZUNvbmZpZ19bJ2Jhc2VTY29yZSddIHx8IDA7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGRlY29yYXRlVUkodW51c2VkTm9kZSwgdW51c2VkQWN0aW9uLCB1bnVzZWRPcHRpb25zKSB7fVxufVxuXG4vKipcbiAqIFRPRE8oZHZveXRlbmtvKTogcmVtb3ZlIG9uY2UgY29tcGlsZXIgdHlwZSBjaGVja2luZyBpcyBmaXhlZCBmb3IgdGhpcmRfcGFydHkuXG4gKiBAcGFja2FnZSBAVmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFBhZ2VDb25maWdDbGFzc0ZvclRlc3RpbmcoKSB7XG4gIHJldHVybiBQYWdlQ29uZmlnO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7RGVmZXJyZWR9IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9wcm9taXNlJztcbmltcG9ydCB7RW50aXRsZW1lbnR9IGZyb20gJy4vZW50aXRsZW1lbnQnO1xuaW1wb3J0IHtPYnNlcnZhYmxlfSBmcm9tICcuLi8uLi8uLi9zcmMvb2JzZXJ2YWJsZSc7XG5pbXBvcnQge2RldiwgdXNlcn0gZnJvbSAnLi4vLi4vLi4vc3JjL2xvZyc7XG5pbXBvcnQge2RpY3QsIGhhc093bn0gZnJvbSAnLi4vLi4vLi4vc3JjL3V0aWxzL29iamVjdCc7XG5cblxuLyoqIEB0eXBlZGVmIHt7c2VydmljZUlkOiBzdHJpbmcsIGVudGl0bGVtZW50OiAoIS4vZW50aXRsZW1lbnQuRW50aXRsZW1lbnR8dW5kZWZpbmVkKX19ICovXG5leHBvcnQgbGV0IEVudGl0bGVtZW50Q2hhbmdlRXZlbnREZWY7XG5cbi8qKiBAY29uc3QgKi9cbmNvbnN0IFRBRyA9ICdhbXAtc3Vic2NyaXB0aW9ucyc7XG5cbmV4cG9ydCBjbGFzcyBQbGF0Zm9ybVN0b3JlIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IGV4cGVjdGVkU2VydmljZUlkc1xuICAgKiBAcGFyYW0geyFKc29uT2JqZWN0fSBzY29yZUNvbmZpZ1xuICAgKiBAcGFyYW0geyEuL2VudGl0bGVtZW50LkVudGl0bGVtZW50fSBmYWxsYmFja0VudGl0bGVtZW50XG4gICAqL1xuICBjb25zdHJ1Y3RvcihleHBlY3RlZFNlcnZpY2VJZHMsIHNjb3JlQ29uZmlnLCBmYWxsYmFja0VudGl0bGVtZW50KSB7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshT2JqZWN0PHN0cmluZywgIS4vc3Vic2NyaXB0aW9uLXBsYXRmb3JtLlN1YnNjcmlwdGlvblBsYXRmb3JtPn0gKi9cbiAgICB0aGlzLnN1YnNjcmlwdGlvblBsYXRmb3Jtc18gPSBkaWN0KCk7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshQXJyYXk8c3RyaW5nPn0gKi9cbiAgICB0aGlzLnNlcnZpY2VJZHNfID0gZXhwZWN0ZWRTZXJ2aWNlSWRzO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IU9iamVjdDxzdHJpbmcsICEuL2VudGl0bGVtZW50LkVudGl0bGVtZW50Pn0gKi9cbiAgICB0aGlzLmVudGl0bGVtZW50c18gPSB7fTtcblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlIEBjb25zdFxuICAgICAqIHshT2JqZWN0PHN0cmluZywgIURlZmVycmVkPCEuL2VudGl0bGVtZW50LkVudGl0bGVtZW50Pj59XG4gICAgICovXG4gICAgdGhpcy5lbnRpdGxlbWVudERlZmVycmVkTWFwXyA9IHt9O1xuICAgIGV4cGVjdGVkU2VydmljZUlkcy5mb3JFYWNoKHNlcnZpY2VJZCA9PiB7XG4gICAgICB0aGlzLmVudGl0bGVtZW50RGVmZXJyZWRNYXBfW3NlcnZpY2VJZF0gPSBuZXcgRGVmZXJyZWQoKTtcbiAgICB9KTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFPYnNlcnZhYmxlPCFFbnRpdGxlbWVudENoYW5nZUV2ZW50RGVmPn0gKi9cbiAgICB0aGlzLm9uRW50aXRsZW1lbnRSZXNvbHZlZENhbGxiYWNrc18gPSBuZXcgT2JzZXJ2YWJsZSgpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IU9ic2VydmFibGU8e3NlcnZpY2VJZDogc3RyaW5nfT59ICovXG4gICAgdGhpcy5vblBsYXRmb3JtUmVzb2x2ZWRDYWxsYmFja3NfID0gbmV3IE9ic2VydmFibGUoKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P0RlZmVycmVkfSAqL1xuICAgIHRoaXMuZ3JhbnRTdGF0dXNQcm9taXNlXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshT2JzZXJ2YWJsZX0gKi9cbiAgICB0aGlzLm9uR3JhbnRTdGF0ZVJlc29sdmVkQ2FsbGJhY2tzXyA9IG5ldyBPYnNlcnZhYmxlKCk7XG5cbiAgICAvKiogQHByaXZhdGUgez9FbnRpdGxlbWVudH0gKi9cbiAgICB0aGlzLmdyYW50U3RhdHVzRW50aXRsZW1lbnRfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P0RlZmVycmVkPD9FbnRpdGxlbWVudD59ICovXG4gICAgdGhpcy5ncmFudFN0YXR1c0VudGl0bGVtZW50UHJvbWlzZV8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/RGVmZXJyZWQ8IUFycmF5PCEuL2VudGl0bGVtZW50LkVudGl0bGVtZW50Pj59ICovXG4gICAgdGhpcy5hbGxSZXNvbHZlZFByb21pc2VfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IUFycmF5PHN0cmluZz59ICovXG4gICAgdGhpcy5mYWlsZWRQbGF0Zm9ybXNfID0gW107XG5cbiAgICAvKiogQHByaXZhdGUgQGNhbnN0IHshLi9lbnRpdGxlbWVudC5FbnRpdGxlbWVudH0gKi9cbiAgICB0aGlzLmZhbGxiYWNrRW50aXRsZW1lbnRfID0gZmFsbGJhY2tFbnRpdGxlbWVudDtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFPYmplY3Q8c3RyaW5nLCBudW1iZXI+fSAqL1xuICAgIHRoaXMuc2NvcmVDb25maWdfID0gT2JqZWN0LmFzc2lnbih7XG4gICAgICAnc3VwcG9ydHNWaWV3ZXInOiAxMCxcbiAgICB9LCBzY29yZUNvbmZpZyk7XG4gIH1cblxuICAvKipcbiAgICogUmVzb2x2ZXMgYSBwbGF0Zm9ybSBpbiB0aGUgc3RvcmVcbiAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VJZFxuICAgKiBAcGFyYW0geyEuL3N1YnNjcmlwdGlvbi1wbGF0Zm9ybS5TdWJzY3JpcHRpb25QbGF0Zm9ybX0gcGxhdGZvcm1cbiAgICovXG4gIHJlc29sdmVQbGF0Zm9ybShzZXJ2aWNlSWQsIHBsYXRmb3JtKSB7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25QbGF0Zm9ybXNfW3NlcnZpY2VJZF0gPSBwbGF0Zm9ybTtcbiAgICB0aGlzLm9uUGxhdGZvcm1SZXNvbHZlZENhbGxiYWNrc18uZmlyZSh7XG4gICAgICBzZXJ2aWNlSWQsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICpDYWxscyBhIGNhbGxiYWNrIGZvciB3aGVuIGEgcGxhdGZvcm0gaXMgcmVzb2x2ZWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlSWRcbiAgICogQHBhcmFtIHshRnVuY3Rpb259IGNhbGxiYWNrXG4gICAqL1xuICBvblBsYXRmb3JtUmVzb2x2ZXMoc2VydmljZUlkLCBjYWxsYmFjaykge1xuICAgIGNvbnN0IHBsYXRmb3JtID0gdGhpcy5zdWJzY3JpcHRpb25QbGF0Zm9ybXNfW3NlcnZpY2VJZF07XG4gICAgaWYgKHBsYXRmb3JtKSB7XG4gICAgICBjYWxsYmFjayhwbGF0Zm9ybSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMub25QbGF0Zm9ybVJlc29sdmVkQ2FsbGJhY2tzXy5hZGQoZSA9PiB7XG4gICAgICAgIGlmIChlLnNlcnZpY2VJZCA9PT0gc2VydmljZUlkKSB7XG4gICAgICAgICAgY2FsbGJhY2sodGhpcy5nZXRQbGF0Zm9ybShzZXJ2aWNlSWQpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHBsYXRmb3JtIGZvciB0aGUgZ2l2ZW4gaWRcbiAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VJZFxuICAgKiBAcmV0dXJuIHshLi9zdWJzY3JpcHRpb24tcGxhdGZvcm0uU3Vic2NyaXB0aW9uUGxhdGZvcm19XG4gICAqL1xuICBnZXRQbGF0Zm9ybShzZXJ2aWNlSWQpIHtcbiAgICBjb25zdCBwbGF0Zm9ybSA9IHRoaXMuc3Vic2NyaXB0aW9uUGxhdGZvcm1zX1tzZXJ2aWNlSWRdO1xuICAgIGRldigpLmFzc2VydChwbGF0Zm9ybSwgYFBsYXRmb3JtIGZvciBpZCAke3NlcnZpY2VJZH0gaXMgbm90IHJlc29sdmVkYCk7XG4gICAgcmV0dXJuIHBsYXRmb3JtO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGxvY2FsIHBsYXRmb3JtO1xuICAgKiBAcmV0dXJuIHshLi9sb2NhbC1zdWJzY3JpcHRpb24tcGxhdGZvcm0uTG9jYWxTdWJzY3JpcHRpb25QbGF0Zm9ybX1cbiAgICovXG4gIGdldExvY2FsUGxhdGZvcm0oKSB7XG4gICAgY29uc3QgbG9jYWxQbGF0Zm9ybSA9XG4gICAgICAgIC8qKiBAdHlwZXshLi9sb2NhbC1zdWJzY3JpcHRpb24tcGxhdGZvcm0uTG9jYWxTdWJzY3JpcHRpb25QbGF0Zm9ybX0gKi9cbiAgICAgICAgKHRoaXMuZ2V0UGxhdGZvcm0oJ2xvY2FsJykpO1xuICAgIHJldHVybiBsb2NhbFBsYXRmb3JtO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYWxsIGF2YWlsYWJsZSBwbGF0Zm9ybXMuXG4gICAqXG4gICAqIEByZXR1cm4geyFBcnJheTwhLi9zdWJzY3JpcHRpb24tcGxhdGZvcm0uU3Vic2NyaXB0aW9uUGxhdGZvcm0+fVxuICAgKi9cbiAgZ2V0QXZhaWxhYmxlUGxhdGZvcm1zKCkge1xuICAgIGNvbnN0IHBsYXRmb3JtcyA9IFtdO1xuICAgIGZvciAoY29uc3QgcGxhdGZvcm1LZXkgaW4gdGhpcy5zdWJzY3JpcHRpb25QbGF0Zm9ybXNfKSB7XG4gICAgICBjb25zdCBzdWJzY3JpcHRpb25QbGF0Zm9ybSA9XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uUGxhdGZvcm1zX1twbGF0Zm9ybUtleV07XG4gICAgICBwbGF0Zm9ybXMucHVzaChzdWJzY3JpcHRpb25QbGF0Zm9ybSk7XG4gICAgfVxuICAgIHJldHVybiBwbGF0Zm9ybXM7XG4gIH1cblxuICAvKipcbiAgICogVGhpcyByZWdpc3RlcnMgYSBjYWxsYmFjayB3aGljaCBpcyBjYWxsZWQgd2hlbmV2ZXIgYSBzZXJ2aWNlIGlkIGlzIHJlc29sdmVkXG4gICAqIHdpdGggYW4gZW50aXRsZW1lbnQuXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVudGl0bGVtZW50Q2hhbmdlRXZlbnREZWYpOnZvaWR9IGNhbGxiYWNrXG4gICAqL1xuICBvbkNoYW5nZShjYWxsYmFjaykge1xuICAgIHRoaXMub25FbnRpdGxlbWVudFJlc29sdmVkQ2FsbGJhY2tzXy5hZGQoY2FsbGJhY2spO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgcmVzb2x2ZXMgdGhlIGVudGl0bGVtZW50IHRvIGEgc2VydmljZUlkXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlSWRcbiAgICogQHBhcmFtIHshLi9lbnRpdGxlbWVudC5FbnRpdGxlbWVudH0gZW50aXRsZW1lbnRcbiAgICovXG4gIHJlc29sdmVFbnRpdGxlbWVudChzZXJ2aWNlSWQsIGVudGl0bGVtZW50KSB7XG4gICAgaWYgKGVudGl0bGVtZW50KSB7XG4gICAgICBlbnRpdGxlbWVudC5zZXJ2aWNlID0gc2VydmljZUlkO1xuICAgIH1cbiAgICB0aGlzLmVudGl0bGVtZW50c19bc2VydmljZUlkXSA9IGVudGl0bGVtZW50O1xuICAgIGNvbnN0IGRlZmVycmVkID0gdGhpcy5lbnRpdGxlbWVudERlZmVycmVkTWFwX1tzZXJ2aWNlSWRdO1xuICAgIGlmIChkZWZlcnJlZCkge1xuICAgICAgZGVmZXJyZWQucmVzb2x2ZShlbnRpdGxlbWVudCk7XG4gICAgfVxuICAgIC8vIFJlbW92ZSB0aGlzIHNlcnZpY2VJZCBhcyBhIGZhaWxlZCBwbGF0Zm9ybSBub3dcbiAgICBpZiAodGhpcy5mYWlsZWRQbGF0Zm9ybXNfLmluZGV4T2Yoc2VydmljZUlkKSAhPSAtMSkge1xuICAgICAgdGhpcy5mYWlsZWRQbGF0Zm9ybXNfLnNwbGljZSh0aGlzLmZhaWxlZFBsYXRmb3Jtc18uaW5kZXhPZihzZXJ2aWNlSWQpKTtcbiAgICB9XG4gICAgLy8gQ2FsbCBhbGwgb25DaGFuZ2UgY2FsbGJhY2tzLlxuICAgIHRoaXMub25FbnRpdGxlbWVudFJlc29sdmVkQ2FsbGJhY2tzXy5maXJlKHtzZXJ2aWNlSWQsIGVudGl0bGVtZW50fSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBlbnRpdGxlbWVudCBmb3IgYSBwbGF0Zm9ybS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VJZFxuICAgKiBAcmV0dXJuIHshLi9lbnRpdGxlbWVudC5FbnRpdGxlbWVudH0gZW50aXRsZW1lbnRcbiAgICovXG4gIGdldFJlc29sdmVkRW50aXRsZW1lbnRGb3Ioc2VydmljZUlkKSB7XG4gICAgZGV2KCkuYXNzZXJ0KHRoaXMuZW50aXRsZW1lbnRzX1tzZXJ2aWNlSWRdLFxuICAgICAgICBgUGxhdGZvcm0gJHtzZXJ2aWNlSWR9IGhhcyBub3QgeWV0IHJlc29sdmVkIHdpdGggZW50aXRsZW1lbnRzYCk7XG4gICAgcmV0dXJuIHRoaXMuZW50aXRsZW1lbnRzX1tzZXJ2aWNlSWRdO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgZW50aXRsZW1lbnQgZm9yIGEgcGxhdGZvcm0gb25jZSBpdCdzIHJlc29sdmVkLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gc2VydmljZUlkXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuL2VudGl0bGVtZW50LkVudGl0bGVtZW50Pn0gZW50aXRsZW1lbnRcbiAgICovXG4gIGdldEVudGl0bGVtZW50UHJvbWlzZUZvcihzZXJ2aWNlSWQpIHtcbiAgICBkZXYoKS5hc3NlcnQodGhpcy5lbnRpdGxlbWVudERlZmVycmVkTWFwX1tzZXJ2aWNlSWRdLFxuICAgICAgICBgUGxhdGZvcm0gJHtzZXJ2aWNlSWR9IGlzIG5vdCBkZWNsYXJlZGApO1xuICAgIHJldHVybiB0aGlzLmVudGl0bGVtZW50RGVmZXJyZWRNYXBfW3NlcnZpY2VJZF0ucHJvbWlzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gc2VydmljZUlkXG4gICAqL1xuICByZXNldEVudGl0bGVtZW50Rm9yKHNlcnZpY2VJZCkge1xuICAgIGRldigpLmFzc2VydCh0aGlzLmVudGl0bGVtZW50RGVmZXJyZWRNYXBfW3NlcnZpY2VJZF0sXG4gICAgICAgIGBQbGF0Zm9ybSAke3NlcnZpY2VJZH0gaXMgbm90IGRlY2xhcmVkYCk7XG4gICAgdGhpcy5lbnRpdGxlbWVudERlZmVycmVkTWFwX1tzZXJ2aWNlSWRdID0gbmV3IERlZmVycmVkKCk7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IVByb21pc2U8Ym9vbGVhbj59XG4gICAqL1xuICBnZXRHcmFudFN0YXR1cygpIHtcbiAgICBpZiAodGhpcy5ncmFudFN0YXR1c1Byb21pc2VfICE9PSBudWxsKSB7XG4gICAgICByZXR1cm4gdGhpcy5ncmFudFN0YXR1c1Byb21pc2VfLnByb21pc2U7XG4gICAgfVxuXG4gICAgdGhpcy5ncmFudFN0YXR1c1Byb21pc2VfID0gbmV3IERlZmVycmVkKCk7XG5cbiAgICAvLyBDaGVjayBpZiBjdXJyZW50IGVudGl0bGVtZW50cyB1bmJsb2NrcyB0aGUgcmVhZGVyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5lbnRpdGxlbWVudHNfKSB7XG4gICAgICBjb25zdCBlbnRpdGxlbWVudCA9ICh0aGlzLmVudGl0bGVtZW50c19ba2V5XSk7XG4gICAgICBpZiAoZW50aXRsZW1lbnQuZ3JhbnRlZCkge1xuICAgICAgICB0aGlzLnNhdmVHcmFudEVudGl0bGVtZW50XyhlbnRpdGxlbWVudCk7XG4gICAgICAgIHRoaXMuZ3JhbnRTdGF0dXNQcm9taXNlXy5yZXNvbHZlKHRydWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLmFyZUFsbFBsYXRmb3Jtc1Jlc29sdmVkXygpKSB7XG4gICAgICAvLyBSZXNvbHZlIHdpdGggbnVsbCBpZiBub24gb2YgdGhlIGVudGl0bGVtZW50cyB1bmJsb2NrcyB0aGUgcmVhZGVyXG4gICAgICB0aGlzLmdyYW50U3RhdHVzUHJvbWlzZV8ucmVzb2x2ZShmYWxzZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIExpc3RlbiBpZiBhbnkgdXBjb21pbmcgZW50aXRsZW1lbnRzIHVuYmxvY2sgdGhlIHJlYWRlclxuICAgICAgdGhpcy5vbkNoYW5nZSgoe2VudGl0bGVtZW50fSkgPT4ge1xuICAgICAgICBpZiAoZW50aXRsZW1lbnQuZ3JhbnRlZCkge1xuICAgICAgICAgIHRoaXMuc2F2ZUdyYW50RW50aXRsZW1lbnRfKGVudGl0bGVtZW50KTtcbiAgICAgICAgICB0aGlzLmdyYW50U3RhdHVzUHJvbWlzZV8ucmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFyZUFsbFBsYXRmb3Jtc1Jlc29sdmVkXygpKSB7XG4gICAgICAgICAgdGhpcy5ncmFudFN0YXR1c1Byb21pc2VfLnJlc29sdmUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5ncmFudFN0YXR1c1Byb21pc2VfLnByb21pc2U7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGFuZCBzYXZlcyB0aGUgZW50aXRsZW1lbnQgZm9yIGdyYW50IHN0YXR1c1xuICAgKiBAcGFyYW0geyFFbnRpdGxlbWVudH0gZW50aXRsZW1lbnRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHNhdmVHcmFudEVudGl0bGVtZW50XyhlbnRpdGxlbWVudCkge1xuICAgIC8vIFRoZSBlbnRpdGxlbWVudCB3aWxsIGJlIHN0b3JlZCBlaXRoZXIgaWYgaXRzIHRoZSBmaXJzdCBvbmUgdG8gZ3JhbnRcbiAgICAvLyBvciB0aGUgbmV3IG9uZSBoYXMgZnVsbCBzdWJzY3JpcHRpb24gYnV0IHRoZSBsYXN0IG9uZSBkaWRuJ3QuXG4gICAgaWYgKCghdGhpcy5ncmFudFN0YXR1c0VudGl0bGVtZW50XyAmJiBlbnRpdGxlbWVudC5ncmFudGVkKVxuICAgICAgICB8fCAodGhpcy5ncmFudFN0YXR1c0VudGl0bGVtZW50X1xuICAgICAgICAgICYmICF0aGlzLmdyYW50U3RhdHVzRW50aXRsZW1lbnRfLmlzU3Vic2NyaWJlcigpXG4gICAgICAgICAgJiYgZW50aXRsZW1lbnQuaXNTdWJzY3JpYmVyKCkpKSB7XG4gICAgICB0aGlzLmdyYW50U3RhdHVzRW50aXRsZW1lbnRfID0gZW50aXRsZW1lbnQ7XG4gICAgICB0aGlzLm9uR3JhbnRTdGF0ZVJlc29sdmVkQ2FsbGJhY2tzXy5maXJlKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGVudGl0bGVtZW50IHdoaWNoIHVubG9ja2VkIHRoZSBkb2N1bWVudFxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/RW50aXRsZW1lbnQ+fVxuICAgKi9cbiAgZ2V0R3JhbnRFbnRpdGxlbWVudCgpIHtcbiAgICBpZiAodGhpcy5ncmFudFN0YXR1c0VudGl0bGVtZW50UHJvbWlzZV8pIHtcbiAgICAgIHJldHVybiAodGhpcy5ncmFudFN0YXR1c0VudGl0bGVtZW50UHJvbWlzZV8ucHJvbWlzZSk7XG4gICAgfVxuICAgIHRoaXMuZ3JhbnRTdGF0dXNFbnRpdGxlbWVudFByb21pc2VfID0gbmV3IERlZmVycmVkKCk7XG4gICAgaWYgKCh0aGlzLmdyYW50U3RhdHVzRW50aXRsZW1lbnRfXG4gICAgICAgICYmIHRoaXMuZ3JhbnRTdGF0dXNFbnRpdGxlbWVudF8uaXNTdWJzY3JpYmVyKCkpXG4gICAgICAgICAgfHwgdGhpcy5hcmVBbGxQbGF0Zm9ybXNSZXNvbHZlZF8oKSkge1xuICAgICAgdGhpcy5ncmFudFN0YXR1c0VudGl0bGVtZW50UHJvbWlzZV8ucmVzb2x2ZSh0aGlzLmdyYW50U3RhdHVzRW50aXRsZW1lbnRfKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5vbkdyYW50U3RhdGVSZXNvbHZlZENhbGxiYWNrc18uYWRkKCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuZ3JhbnRTdGF0dXNFbnRpdGxlbWVudF8uZ3JhbnRlZFxuICAgICAgICAgICAgfHwgdGhpcy5hcmVBbGxQbGF0Zm9ybXNSZXNvbHZlZF8oKSkge1xuICAgICAgICAgIHRoaXMuZ3JhbnRTdGF0dXNFbnRpdGxlbWVudFByb21pc2VfLnJlc29sdmUoXG4gICAgICAgICAgICAgIHRoaXMuZ3JhbnRTdGF0dXNFbnRpdGxlbWVudF8pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuZ3JhbnRTdGF0dXNFbnRpdGxlbWVudFByb21pc2VfLnByb21pc2U7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXJzIHRoZSBncmFudCBzdGF0dXNcbiAgICovXG4gIHJlc2V0KCkge1xuICAgIHRoaXMuZ3JhbnRTdGF0dXNQcm9taXNlXyA9IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBlbnRpdGxlbWVudHMgd2hlbiBhbGwgc2VydmljZXMgYXJlIGRvbmUgZmV0Y2hpbmcgdGhlbS5cbiAgICogQHByaXZhdGVcbiAgICogQHJldHVybiB7IVByb21pc2U8IUFycmF5PCEuL2VudGl0bGVtZW50LkVudGl0bGVtZW50Pj59XG4gICAqL1xuICBnZXRBbGxQbGF0Zm9ybXNFbnRpdGxlbWVudHNfKCkge1xuICAgIGlmICh0aGlzLmFsbFJlc29sdmVkUHJvbWlzZV8pIHtcbiAgICAgIHJldHVybiB0aGlzLmFsbFJlc29sdmVkUHJvbWlzZV8ucHJvbWlzZTtcbiAgICB9XG4gICAgdGhpcy5hbGxSZXNvbHZlZFByb21pc2VfID0gbmV3IERlZmVycmVkKCk7XG4gICAgaWYgKHRoaXMuYXJlQWxsUGxhdGZvcm1zUmVzb2x2ZWRfKCkpIHtcbiAgICAgIC8vIFJlc29sdmUgd2l0aCBudWxsIGlmIG5vbiBvZiB0aGUgZW50aXRsZW1lbnRzIHVuYmxvY2tzIHRoZSByZWFkZXJcbiAgICAgIHRoaXMuYWxsUmVzb2x2ZWRQcm9taXNlXy5yZXNvbHZlKFxuICAgICAgICAgIHRoaXMuZ2V0QXZhaWxhYmxlUGxhdGZvcm1zRW50aXRsZW1lbnRzXygpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gTGlzdGVuIGlmIGFueSB1cGNvbWluZyBlbnRpdGxlbWVudHMgdW5ibG9jayB0aGUgcmVhZGVyXG4gICAgICB0aGlzLm9uQ2hhbmdlKCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuYXJlQWxsUGxhdGZvcm1zUmVzb2x2ZWRfKCkpIHtcbiAgICAgICAgICB0aGlzLmFsbFJlc29sdmVkUHJvbWlzZV8ucmVzb2x2ZShcbiAgICAgICAgICAgICAgdGhpcy5nZXRBdmFpbGFibGVQbGF0Zm9ybXNFbnRpdGxlbWVudHNfKCkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuYWxsUmVzb2x2ZWRQcm9taXNlXy5wcm9taXNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgZW50aXRsZW1lbnRzIGZvciByZXNvbHZlZCBwbGF0Zm9ybXMuXG4gICAqIEBwcml2YXRlXG4gICAqIEByZXR1cm4geyFBcnJheTwhLi9lbnRpdGxlbWVudC5FbnRpdGxlbWVudD59XG4gICAqL1xuICBnZXRBdmFpbGFibGVQbGF0Zm9ybXNFbnRpdGxlbWVudHNfKCkge1xuICAgIGNvbnN0IGVudGl0bGVtZW50cyA9IFtdO1xuICAgIGZvciAoY29uc3QgcGxhdGZvcm0gaW4gdGhpcy5lbnRpdGxlbWVudHNfKSB7XG4gICAgICBpZiAoaGFzT3duKHRoaXMuZW50aXRsZW1lbnRzXywgcGxhdGZvcm0pKSB7XG4gICAgICAgIGVudGl0bGVtZW50cy5wdXNoKHRoaXMuZW50aXRsZW1lbnRzX1twbGF0Zm9ybV0pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZW50aXRsZW1lbnRzO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgZW50aXRsZW1lbnRzIHdoZW4gYWxsIHNlcnZpY2VzIGFyZSBkb25lIGZldGNoaW5nIHRoZW0uXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuL3N1YnNjcmlwdGlvbi1wbGF0Zm9ybS5TdWJzY3JpcHRpb25QbGF0Zm9ybT59XG4gICAqL1xuICBzZWxlY3RQbGF0Zm9ybSgpIHtcblxuICAgIHJldHVybiB0aGlzLmdldEFsbFBsYXRmb3Jtc0VudGl0bGVtZW50c18oKS50aGVuKCgpID0+IHtcbiAgICAgIC8vIFRPRE8oQHByYXRlZWtiaCk6IGV4cGxhaW4gd2h5IHNvbWV0aW1lcyBhIHF1aWNrIHJlc29sdmUgaXMgcG9zc2libGUgdnNcbiAgICAgIC8vIHdhaXRpbmcgZm9yIGFsbCBlbnRpdGxlbWVudC5cbiAgICAgIHJldHVybiB0aGlzLnNlbGVjdEFwcGxpY2FibGVQbGF0Zm9ybV8oKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgZW50aXRsZW1lbnRzIHJlc29sdmVkXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBhcmVBbGxQbGF0Zm9ybXNSZXNvbHZlZF8oKSB7XG4gICAgY29uc3QgZW50aXRsZW1lbnRzUmVzb2x2ZWQgPSBPYmplY3Qua2V5cyh0aGlzLmVudGl0bGVtZW50c18pLmxlbmd0aDtcbiAgICByZXR1cm4gZW50aXRsZW1lbnRzUmVzb2x2ZWQgPT09IHRoaXMuc2VydmljZUlkc18ubGVuZ3RoO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgbW9zdCBxdWFsaWZpZWQgcGxhdGZvcm0uIFF1YWxpZmljYXRpb24gb2YgYSBwbGF0Zm9ybSBpcyBiYXNlZCBvbiBhblxuICAgKiBpbnRlZ2VyIHdlaWdodC4gRXZlcnkgcGxhdGZvcm0gc3RhcnRzIHdpdGggd2VpZ2h0IDAgYW5kIGV2YWx1YXRlZCBhZ2FpbnN0XG4gICAqIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVycyxcbiAgICogLSB1c2VyIGlzIHN1YnNjcmliZWQgd2l0aCBwbGF0Zm9ybSAoR2l2ZXMgd2VpZ2h0IDEwKVxuICAgKiAtIHN1cHBvcnRzIHRoZSBjdXJyZW50IHZpZXdlciAoR2l2ZXMgd2VpZ2h0IDkpXG4gICAqXG4gICAqIEluIHRoZSBlbmQgY2FuZGlkYXRlIHdpdGggbWF4IHdlaWdodCBpcyBzZWxlY3RlZC4gSG93ZXZlciBpZiBjYW5kaWRhdGUnc1xuICAgKiB3ZWlnaHQgaXMgZXF1YWwgdG8gbG9jYWwgcGxhdGZvcm0sIHRoZW4gbG9jYWwgcGxhdGZvcm0gaXMgc2VsZWN0ZWQuXG4gICAqIEByZXR1cm4geyEuL3N1YnNjcmlwdGlvbi1wbGF0Zm9ybS5TdWJzY3JpcHRpb25QbGF0Zm9ybX1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHNlbGVjdEFwcGxpY2FibGVQbGF0Zm9ybV8oKSB7XG4gICAgY29uc3QgbG9jYWxQbGF0Zm9ybSA9IHRoaXMuZ2V0TG9jYWxQbGF0Zm9ybSgpO1xuICAgIGxldCBsb2NhbFdlaWdodCA9IDA7XG4gICAgLyoqIEB0eXBlIHshQXJyYXk8IU9iamVjdDwhLi9zdWJzY3JpcHRpb24tcGxhdGZvcm0uU3Vic2NyaXB0aW9uUGxhdGZvcm0sIG51bWJlcj4+fSAqL1xuICAgIGNvbnN0IHBsYXRmb3JtV2VpZ2h0cyA9IFtdO1xuXG4gICAgZGV2KCkuYXNzZXJ0KHRoaXMuYXJlQWxsUGxhdGZvcm1zUmVzb2x2ZWRfKCksXG4gICAgICAgICdBbGwgcGxhdGZvcm1zIGFyZSBub3QgcmVzb2x2ZWQgeWV0Jyk7XG5cbiAgICB0aGlzLmdldEF2YWlsYWJsZVBsYXRmb3JtcygpLmZvckVhY2gocGxhdGZvcm0gPT4ge1xuICAgICAgbGV0IHdlaWdodCA9IDA7XG4gICAgICBjb25zdCBlbnRpdGxlbWVudCA9XG4gICAgICAgICAgdGhpcy5nZXRSZXNvbHZlZEVudGl0bGVtZW50Rm9yKHBsYXRmb3JtLmdldFNlcnZpY2VJZCgpKTtcblxuICAgICAgLy8gU3Vic2NyaWJlciB3aW5zIGltbWVkaWF0bHkuXG4gICAgICBpZiAoZW50aXRsZW1lbnQuaXNTdWJzY3JpYmVyKCkpIHtcbiAgICAgICAgd2VpZ2h0ICs9IDEwMDAwMDtcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIHRoZSBiYXNlIHNjb3JlXG4gICAgICB3ZWlnaHQgKz0gcGxhdGZvcm0uZ2V0QmFzZVNjb3JlKCk7XG5cbiAgICAgIC8vIElmIHN1cHBvcnRzIHRoZSBjdXJyZW50IHZpZXdlciwgZ2FpbnMgd2VpZ2h0IDlcbiAgICAgIGlmIChwbGF0Zm9ybS5zdXBwb3J0c0N1cnJlbnRWaWV3ZXIoKSkge1xuICAgICAgICB3ZWlnaHQgKz0gdGhpcy5zY29yZUNvbmZpZ19bJ3N1cHBvcnRzVmlld2VyJ107XG4gICAgICB9XG5cbiAgICAgIHBsYXRmb3JtV2VpZ2h0cy5wdXNoKHtcbiAgICAgICAgcGxhdGZvcm0sXG4gICAgICAgIHdlaWdodCxcbiAgICAgIH0pO1xuICAgICAgaWYgKHBsYXRmb3JtLmdldFNlcnZpY2VJZCgpID09PSAnbG9jYWwnKSB7XG4gICAgICAgIGxvY2FsV2VpZ2h0ID0gd2VpZ2h0O1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcGxhdGZvcm1XZWlnaHRzLnNvcnQoZnVuY3Rpb24ocGxhdGZvcm0xLCBwbGF0Zm9ybTIpIHtcbiAgICAgIHJldHVybiBwbGF0Zm9ybTIud2VpZ2h0IC0gcGxhdGZvcm0xLndlaWdodDtcbiAgICB9KTtcbiAgICAvLyBOb2JvZHkgc3VwcG9ydHMgY3VycmVudCB2aWV3ZXIsIG5vciBpcyBhbnlib2R5IHN1YnNjcmliZWRcbiAgICBpZiAocGxhdGZvcm1XZWlnaHRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGxvY2FsUGxhdGZvcm07XG4gICAgfVxuXG4gICAgY29uc3Qgd2lubmluZ1dlaWdodCA9IHBsYXRmb3JtV2VpZ2h0c1swXS53ZWlnaHQ7XG5cbiAgICBpZiAod2lubmluZ1dlaWdodCA+IGxvY2FsV2VpZ2h0KSB7XG4gICAgICByZXR1cm4gcGxhdGZvcm1XZWlnaHRzWzBdLnBsYXRmb3JtO1xuICAgIH1cblxuICAgIHJldHVybiBsb2NhbFBsYXRmb3JtO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlY29yZHMgYSBwbGF0Zm9ybSBmYWlsdXJlIGFuZCBsb2dzIGVycm9yIGlmIGFsbCBwbGF0Zm9ybXMgaGF2ZSBmYWlsZWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlSWRcbiAgICovXG4gIHJlcG9ydFBsYXRmb3JtRmFpbHVyZShzZXJ2aWNlSWQpIHtcbiAgICBpZiAodGhpcy5mYWlsZWRQbGF0Zm9ybXNfLmluZGV4T2Yoc2VydmljZUlkKSA9PSAtMSkge1xuICAgICAgY29uc3QgZW50aXRsZW1lbnQgPSBFbnRpdGxlbWVudC5lbXB0eShzZXJ2aWNlSWQpO1xuICAgICAgdGhpcy5yZXNvbHZlRW50aXRsZW1lbnQoc2VydmljZUlkLCBlbnRpdGxlbWVudCk7XG4gICAgICB0aGlzLmZhaWxlZFBsYXRmb3Jtc18ucHVzaChzZXJ2aWNlSWQpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmZhaWxlZFBsYXRmb3Jtc18ubGVuZ3RoID09IHRoaXMuc2VydmljZUlkc18ubGVuZ3RoKSB7XG4gICAgICB1c2VyKCkud2FybihUQUcsICdBbGwgcGxhdGZvcm1zIGhhdmUgZmFpbGVkIHRvIHJlc29sdmUsICdcbiAgICAgICAgICArICd1c2luZyBmYWxsYmFjayBlbnRpdGxlbWVudCBmb3IgbG9jYWwgcGxhdGZvcm0nKTtcbiAgICAgIHRoaXMucmVzb2x2ZUVudGl0bGVtZW50KHRoaXMuZ2V0TG9jYWxQbGF0Zm9ybSgpLmdldFNlcnZpY2VJZCgpLFxuICAgICAgICAgIHRoaXMuZmFsbGJhY2tFbnRpdGxlbWVudF8pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBFdmFsdWF0ZXMgcGxhdGZvcm1zIGFuZCBzZWxlY3QgdGhlIG9uZSB0byBiZSBzZWxlY3RlZCBmb3IgbG9naW4uXG4gICAqIEByZXR1cm4geyEuL3N1YnNjcmlwdGlvbi1wbGF0Zm9ybS5TdWJzY3JpcHRpb25QbGF0Zm9ybX1cbiAgICovXG4gIHNlbGVjdFBsYXRmb3JtRm9yTG9naW4oKSB7XG4gICAgY29uc3QgcGxhdGZvcm1TY29yZXMgPSBbXTtcbiAgICB0aGlzLmdldEF2YWlsYWJsZVBsYXRmb3JtcygpLmZvckVhY2gocGxhdGZvcm0gPT4ge1xuICAgICAgbGV0IHNjb3JlID0gMDtcbiAgICAgIGlmIChwbGF0Zm9ybS5zdXBwb3J0c0N1cnJlbnRWaWV3ZXIoKSkge1xuICAgICAgICBzY29yZSArPSAxMDAwO1xuICAgICAgfVxuICAgICAgcGxhdGZvcm1TY29yZXMucHVzaCh7XG4gICAgICAgIHBsYXRmb3JtLFxuICAgICAgICBzY29yZSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgcGxhdGZvcm1TY29yZXMuc29ydChmdW5jdGlvbihwbGF0Zm9ybTEsIHBsYXRmb3JtMikge1xuICAgICAgcmV0dXJuIHBsYXRmb3JtMi53ZWlnaHQgLSBwbGF0Zm9ybTEud2VpZ2h0O1xuICAgIH0pO1xuXG4gICAgaWYgKHBsYXRmb3JtU2NvcmVzLmxlbmd0aCA9PT0gMCB8fCBwbGF0Zm9ybVNjb3Jlc1swXS5zY29yZSA9PT0gMCkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0TG9jYWxQbGF0Zm9ybSgpO1xuICAgIH1cblxuICAgIHJldHVybiBwbGF0Zm9ybVNjb3Jlc1swXS5wbGF0Zm9ybTtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4uLy4uLy4uL3NyYy9zZXJ2aWNlcyc7XG5pbXBvcnQge2NyZWF0ZUVsZW1lbnRXaXRoQXR0cmlidXRlc30gZnJvbSAnLi4vLi4vLi4vc3JjL2RvbSc7XG5pbXBvcnQge2RpY3R9IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9vYmplY3QnO1xuXG5jb25zdCBDU1NfUFJFRklYID0gJ2ktYW1waHRtbC1zdWJzJztcblxuXG5leHBvcnQgY2xhc3MgUmVuZGVyZXIge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0geyEuLi8uLi8uLi9zcmMvc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICAgKi9cbiAgY29uc3RydWN0b3IoYW1wZG9jKSB7XG4gICAgLyoqIEBjb25zdCBAcHJpdmF0ZSAqL1xuICAgIHRoaXMuYW1wZG9jXyA9IGFtcGRvYztcblxuICAgIC8qKiBAY29uc3QgQHByaXZhdGUgeyEuLi8uLi8uLi9zcmMvc2VydmljZS9yZXNvdXJjZXMtaW1wbC5SZXNvdXJjZXN9ICovXG4gICAgdGhpcy5yZXNvdXJjZXNfID0gU2VydmljZXMucmVzb3VyY2VzRm9yRG9jKGFtcGRvYyk7XG5cbiAgICAvLyBJbml0aWFsIHN0YXRlIGlzIFwidW5rbm93blwiLlxuICAgIHRoaXMuc2V0R3JhbnRTdGF0ZShudWxsKTtcbiAgICB0aGlzLmdldEJvZHlFbGVtZW50XygpLmNsYXNzTGlzdC5hZGQoYCR7Q1NTX1BSRUZJWH0tcmVhZHlgKTtcblxuICAgIC8vIENoZWNrIGFuZCBhZGQgcHJvZ3Jlc3MgYmFyLlxuICAgIHRoaXMuYWRkTG9hZGluZ0JhcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFFbGVtZW50fVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0Qm9keUVsZW1lbnRfKCkge1xuICAgIHJldHVybiB0aGlzLmFtcGRvY18uZ2V0Qm9keSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlXG4gICAqIEBwYXJhbSB7P2Jvb2xlYW59IHN0YXRlXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzZXRTdGF0ZV8odHlwZSwgc3RhdGUpIHtcbiAgICB0aGlzLnJlc291cmNlc18ubXV0YXRlRWxlbWVudCh0aGlzLmFtcGRvY18uZ2V0Qm9keSgpICwgKCkgPT4ge1xuICAgICAgdGhpcy5nZXRCb2R5RWxlbWVudF8oKS5jbGFzc0xpc3QudG9nZ2xlKFxuICAgICAgICAgIGAke0NTU19QUkVGSVh9LSR7dHlwZX0tdW5rYCxcbiAgICAgICAgICBzdGF0ZSA9PT0gbnVsbCk7XG4gICAgICB0aGlzLmdldEJvZHlFbGVtZW50XygpLmNsYXNzTGlzdC50b2dnbGUoXG4gICAgICAgICAgYCR7Q1NTX1BSRUZJWH0tJHt0eXBlfS15ZXNgLFxuICAgICAgICAgIHN0YXRlID09PSB0cnVlKTtcbiAgICAgIHRoaXMuZ2V0Qm9keUVsZW1lbnRfKCkuY2xhc3NMaXN0LnRvZ2dsZShcbiAgICAgICAgICBgJHtDU1NfUFJFRklYfS0ke3R5cGV9LW5vYCxcbiAgICAgICAgICBzdGF0ZSA9PT0gZmFsc2UpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYSBsb2FkaW5nIGJhci5cbiAgICpcbiAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAqL1xuICBhZGRMb2FkaW5nQmFyKCkge1xuICAgIHJldHVybiB0aGlzLmFtcGRvY18ud2hlblJlYWR5KCkudGhlbigoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuYW1wZG9jXy5nZXRCb2R5KCkucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAnW3N1YnNjcmlwdGlvbnMtc2VjdGlvbj1sb2FkaW5nXScpKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBjcmVhdGVFbGVtZW50V2l0aEF0dHJpYnV0ZXModGhpcy5hbXBkb2NfLndpbi5kb2N1bWVudCxcbiAgICAgICAgICAgICdkaXYnICxcbiAgICAgICAgICAgIGRpY3Qoe1xuICAgICAgICAgICAgICAnY2xhc3MnOiAnaS1hbXBodG1sLXN1YnMtcHJvZ3Jlc3MnLFxuICAgICAgICAgICAgICAnc3Vic2NyaXB0aW9ucy1zZWN0aW9uJzogJ2xvYWRpbmcnLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5hbXBkb2NfLmdldEJvZHkoKS5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHN0YXRlXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB0b2dnbGVTdGF0ZV8odHlwZSwgc3RhdGUpIHtcbiAgICB0aGlzLnJlc291cmNlc18ubXV0YXRlRWxlbWVudCh0aGlzLmFtcGRvY18uZ2V0Qm9keSgpLCAoKSA9PiB7XG4gICAgICB0aGlzLmdldEJvZHlFbGVtZW50XygpLmNsYXNzTGlzdC50b2dnbGUoYCR7Q1NTX1BSRUZJWH0tJHt0eXBlfWAsIHN0YXRlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gez9ib29sZWFufSBzdGF0ZVxuICAgKi9cbiAgc2V0R3JhbnRTdGF0ZShzdGF0ZSkge1xuICAgIHRoaXMuc2V0U3RhdGVfKCdncmFudCcsIHN0YXRlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGxvYWRpbmdcbiAgICovXG4gIHRvZ2dsZUxvYWRpbmcobG9hZGluZykge1xuICAgIHRoaXMudG9nZ2xlU3RhdGVfKCdsb2FkaW5nJywgbG9hZGluZyk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1BhZ2VDb25maWd9IGZyb20gJy4uLy4uLy4uL3RoaXJkX3BhcnR5L3N1YnNjcmlwdGlvbnMtcHJvamVjdC9jb25maWcnO1xuXG5leHBvcnQgY2xhc3MgU2VydmljZUFkYXB0ZXIge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0gey4vYW1wLXN1YnNjcmlwdGlvbnMuU3Vic2NyaXB0aW9uU2VydmljZX0gc3Vic2NyaXB0aW9uU2VydmljZVxuICAgKi9cbiAgY29uc3RydWN0b3Ioc3Vic2NyaXB0aW9uU2VydmljZSkge1xuICAgIHRoaXMuc3Vic2NyaXB0aW9uU2VydmljZV8gPSBzdWJzY3JpcHRpb25TZXJ2aWNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHBhZ2UgY29uZmlnLlxuICAgKiBAcmV0dXJuIHshUGFnZUNvbmZpZ31cbiAgICovXG4gIGdldFBhZ2VDb25maWcoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3Vic2NyaXB0aW9uU2VydmljZV8uZ2V0UGFnZUNvbmZpZygpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHJlYWRlciBJRCBmb3IgdGhlIHNwZWNpZmllZCBzZXJ2aWNlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gc2VydmljZUlkXG4gICAqIEByZXR1cm4geyFQcm9taXNlPHN0cmluZz59XG4gICAqL1xuICBnZXRSZWFkZXJJZChzZXJ2aWNlSWQpIHtcbiAgICByZXR1cm4gdGhpcy5zdWJzY3JpcHRpb25TZXJ2aWNlXy5nZXRSZWFkZXJJZChzZXJ2aWNlSWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIERlbGVnYXRlcyBhY3Rpb25zIHRvIGxvY2FsIHBsYXRmb3JtLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gYWN0aW9uXG4gICAqIEByZXR1cm4geyFQcm9taXNlPGJvb2xlYW4+fVxuICAgKi9cbiAgZGVsZWdhdGVBY3Rpb25Ub0xvY2FsKGFjdGlvbikge1xuICAgIHJldHVybiB0aGlzLmRlbGVnYXRlQWN0aW9uVG9TZXJ2aWNlKGFjdGlvbiwgJ2xvY2FsJyk7XG4gIH1cblxuICAvKipcbiAgICogRGVsZWdhdGVzIGFjdGlvbnMgdG8gYSBnaXZlbiBzZXJ2aWNlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gYWN0aW9uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlSWRcbiAgICogQHJldHVybiB7IVByb21pc2U8Ym9vbGVhbj59XG4gICAqL1xuICBkZWxlZ2F0ZUFjdGlvblRvU2VydmljZShhY3Rpb24sIHNlcnZpY2VJZCkge1xuICAgIHJldHVybiB0aGlzLnN1YnNjcmlwdGlvblNlcnZpY2VfLmRlbGVnYXRlQWN0aW9uVG9TZXJ2aWNlKGFjdGlvbiwgc2VydmljZUlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxlZ2F0ZSBVSSBkZWNvcmF0aW9uIHRvIGFub3RoZXIgc2VydmljZS5cbiAgICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICAgKiBAcGFyYW0ge3N0cmluZ30gc2VydmljZUlkXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpb25cbiAgICogQHBhcmFtIHs/SnNvbk9iamVjdH0gb3B0aW9uc1xuICAgKi9cbiAgZGVjb3JhdGVTZXJ2aWNlQWN0aW9uKGVsZW1lbnQsIHNlcnZpY2VJZCwgYWN0aW9uLCBvcHRpb25zKSB7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25TZXJ2aWNlXy5kZWNvcmF0ZVNlcnZpY2VBY3Rpb24oZWxlbWVudCwgc2VydmljZUlkLFxuICAgICAgICBhY3Rpb24sIG9wdGlvbnMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlYXV0aG9yaXplIHBsYXRmb3Jtc1xuICAgKiBAcGFyYW0geyEuL3N1YnNjcmlwdGlvbi1wbGF0Zm9ybS5TdWJzY3JpcHRpb25QbGF0Zm9ybX0gc3Vic2NyaXB0aW9uUGxhdGZvcm1cbiAgICovXG4gIHJlQXV0aG9yaXplUGxhdGZvcm0oc3Vic2NyaXB0aW9uUGxhdGZvcm0pIHtcbiAgICB0aGlzLnN1YnNjcmlwdGlvblNlcnZpY2VfLnJlQXV0aG9yaXplUGxhdGZvcm0oc3Vic2NyaXB0aW9uUGxhdGZvcm0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHNpbmdsZXRvbiBEaWFsb2cgaW5zdGFuY2VcbiAgICogQHJldHVybiB7IS4vZGlhbG9nLkRpYWxvZ31cbiAgICovXG4gIGdldERpYWxvZygpIHtcbiAgICByZXR1cm4gdGhpcy5zdWJzY3JpcHRpb25TZXJ2aWNlXy5nZXREaWFsb2coKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGxvZ2luIHBsYXRmb3JtIGJhc2VkIG9uIHBsYXRmb3JtIHNlbGVjdGlvblxuICAgKlxuICAgKiBAcmV0dXJuIHshLi9zdWJzY3JpcHRpb24tcGxhdGZvcm0uU3Vic2NyaXB0aW9uUGxhdGZvcm19XG4gICAqL1xuICBzZWxlY3RQbGF0Zm9ybUZvckxvZ2luKCkge1xuICAgIHJldHVybiB0aGlzLnN1YnNjcmlwdGlvblNlcnZpY2VfLnNlbGVjdFBsYXRmb3JtRm9yTG9naW4oKTtcbiAgfVxufVxuXG4vKiogQHBhY2thZ2UgQFZpc2libGVGb3JUZXN0aW5nICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGFnZUNvbmZpZ0ZvclRlc3RpbmcoKSB7XG4gIHJldHVybiBQYWdlQ29uZmlnO1xufVxuXG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtQYWdlQ29uZmlnfSBmcm9tICcuLi8uLi8uLi90aGlyZF9wYXJ0eS9zdWJzY3JpcHRpb25zLXByb2plY3QvY29uZmlnJztcblxuLyoqXG4gKiBUaGlzIGludGVyZmFjZSBpcyBpbnRlbmRlZCB0byBiZSBpbXBsZW1lbnRlZCBieSBTdWJzY3JpcHRpb24gcGxhdGZvcm1zIHRvXG4gKiBwcm92aWRlIG1ldGhvZCBvZiBnZXR0aW5nIGVudGl0bGVtZW50cy5cbiAqXG4gKiBAaW50ZXJmYWNlXG4gKi9cbmV4cG9ydCBjbGFzcyBTdWJzY3JpcHRpb25QbGF0Zm9ybSB7XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHNlcnZpY2UgSWQuXG4gICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICovXG4gIGdldFNlcnZpY2VJZCgpIHt9XG5cbiAgLyoqXG4gICAqIFJlcXVlc3RzIGVudGl0bGVtZW50IGZvciBhIHN1YnNjcmlwdGlvbiBwbGF0Zm9ybS5cbiAgICogQHJldHVybiB7IVByb21pc2U8Py4vZW50aXRsZW1lbnQuRW50aXRsZW1lbnQ+fVxuICAgKi9cbiAgZ2V0RW50aXRsZW1lbnRzKCkge31cblxuICAvKipcbiAgICogQWN0aXZhdGVzIHRoZSBzdWJzY3JpcHRpb24gcGxhdGZvcm0gYW5kIGhhbmRzIG92ZXIgdGhlIGNvbnRyb2wgZm9yXG4gICAqIHJlbmRlcmluZy5cbiAgICogQHBhcmFtIHshLi9lbnRpdGxlbWVudC5FbnRpdGxlbWVudH0gdW51c2VkRW50aXRsZW1lbnRcbiAgICovXG4gIGFjdGl2YXRlKHVudXNlZEVudGl0bGVtZW50KSB7fVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGlmIHBpbmdiYWNrIGlzIGVuYWJsZWQgZm9yIHRoaXMgcGxhdGZvcm0uXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBpc1BpbmdiYWNrRW5hYmxlZCgpIHt9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIHRoZSBwaW5nYmFjayB0byB0aGUgc3Vic2NyaXB0aW9uIHBsYXRmb3JtLlxuICAgKiBAcGFyYW0geyEuL2VudGl0bGVtZW50LkVudGl0bGVtZW50fSB1bnVzZWRTZWxlY3RlZFBsYXRmb3JtXG4gICAqIEByZXR1cm4geyFQcm9taXNlfHVuZGVmaW5lZH1cbiAgICovXG4gIHBpbmdiYWNrKHVudXNlZFNlbGVjdGVkUGxhdGZvcm0pIHt9XG5cbiAgLyoqXG4gICAqIFRlbGxzIGlmIHRoaXMgcGxhdGZvcm0gc3VwcG9ydHMgdGhlIGN1cnJlbnQgdmlld2VyLlxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgc3VwcG9ydHNDdXJyZW50Vmlld2VyKCkge31cblxuICAvKipcbiAgICogRXhlY3V0ZXMgYWN0aW9uIGZvciB0aGUgbG9jYWwgcGxhdGZvcm0uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB1bnVzZWRBY3Rpb25cbiAgICogQHJldHVybiB7IVByb21pc2U8Ym9vbGVhbj59XG4gICAqL1xuICBleGVjdXRlQWN0aW9uKHVudXNlZEFjdGlvbikge31cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgYmFzZSBzY29yZSBjb25maWd1cmVkIGZvciB0aGUgcGxhdGZvcm0uXG4gICAqIEByZXR1cm4ge251bWJlcn1cbiAgICovXG4gIGdldEJhc2VTY29yZSgpIHt9XG5cbiAgLyoqXG4gICAqIERlY29yYXRlIHRoZSBEb21Ob2RlIGFjY29yZGluZyB0byB5b3VyIHBsYXRmb3JtXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IHVudXNlZEVsZW1lbnRcbiAgICogQHBhcmFtIHtzdHJpbmd9IHVudXNlZEFjdGlvblxuICAgKiBAcGFyYW0gez9Kc29uT2JqZWN0fSB1bnVzZWRPcHRpb25zXG4gICAqL1xuICBkZWNvcmF0ZVVJKHVudXNlZEVsZW1lbnQsIHVudXNlZEFjdGlvbiwgdW51c2VkT3B0aW9ucykge31cbn1cblxuLyoqXG4gKiBUT0RPKGR2b3l0ZW5rbyk6IHJlbW92ZSBvbmNlIGNvbXBpbGVyIHR5cGUgY2hlY2tpbmcgaXMgZml4ZWQgZm9yIHRoaXJkX3BhcnR5LlxuICogQHBhY2thZ2UgQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYWdlQ29uZmlnQ2xhc3NGb3JUZXN0aW5nKCkge1xuICByZXR1cm4gUGFnZUNvbmZpZztcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZXMnO1xuaW1wb3J0IHtnZXRWYWx1ZUZvckV4cHJ9IGZyb20gJy4uLy4uLy4uL3NyYy9qc29uJztcblxuXG5leHBvcnQgY2xhc3MgVXJsQnVpbGRlciB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gICAqIEBwYXJhbSB7IVByb21pc2U8c3RyaW5nPn0gcmVhZGVySWRQcm9taXNlXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhbXBkb2MsIHJlYWRlcklkUHJvbWlzZSkge1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyEuLi8uLi8uLi9zcmMvc2VydmljZS91cmwtcmVwbGFjZW1lbnRzLWltcGwuVXJsUmVwbGFjZW1lbnRzfSAqL1xuICAgIHRoaXMudXJsUmVwbGFjZW1lbnRzXyA9IFNlcnZpY2VzLnVybFJlcGxhY2VtZW50c0ZvckRvYyhhbXBkb2MpO1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFQcm9taXNlPHN0cmluZz59ICovXG4gICAgdGhpcy5yZWFkZXJJZFByb21pc2VfID0gcmVhZGVySWRQcm9taXNlO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/SnNvbk9iamVjdH0gKi9cbiAgICB0aGlzLmF1dGhSZXNwb25zZV8gPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUpzb25PYmplY3R9IGF1dGhSZXNwb25zZVxuICAgKi9cbiAgc2V0QXV0aFJlc3BvbnNlKGF1dGhSZXNwb25zZSkge1xuICAgIHRoaXMuYXV0aFJlc3BvbnNlXyA9IGF1dGhSZXNwb25zZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gdXNlQXV0aERhdGEgQWxsb3dzIGBBVVRIKGZpZWxkKWAgVVJMIHZhciBzdWJzdGl0dXRpb25zLlxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTxzdHJpbmc+fVxuICAgKi9cbiAgYnVpbGRVcmwodXJsLCB1c2VBdXRoRGF0YSkge1xuICAgIHJldHVybiB0aGlzLnByZXBhcmVVcmxWYXJzXyh1c2VBdXRoRGF0YSkudGhlbih2YXJzID0+IHtcbiAgICAgIHJldHVybiB0aGlzLnVybFJlcGxhY2VtZW50c18uZXhwYW5kVXJsQXN5bmModXJsLCB2YXJzKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gdXNlQXV0aERhdGEgQWxsb3dzIGBBVVRIKGZpZWxkKWAgVVJMIHZhciBzdWJzdGl0dXRpb25zLlxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhT2JqZWN0PHN0cmluZywgKj4+fVxuICAgKi9cbiAgY29sbGVjdFVybFZhcnModXJsLCB1c2VBdXRoRGF0YSkge1xuICAgIHJldHVybiB0aGlzLnByZXBhcmVVcmxWYXJzXyh1c2VBdXRoRGF0YSkudGhlbih2YXJzID0+IHtcbiAgICAgIHJldHVybiB0aGlzLnVybFJlcGxhY2VtZW50c18uY29sbGVjdFZhcnModXJsLCB2YXJzKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHVzZUF1dGhEYXRhIEFsbG93cyBgQVVUSChmaWVsZClgIFVSTCB2YXIgc3Vic3RpdHV0aW9ucy5cbiAgICogQHJldHVybiB7IVByb21pc2U8IU9iamVjdDxzdHJpbmcsICo+Pn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHByZXBhcmVVcmxWYXJzXyh1c2VBdXRoRGF0YSkge1xuICAgIHJldHVybiB0aGlzLnJlYWRlcklkUHJvbWlzZV8udGhlbihyZWFkZXJJZCA9PiB7XG4gICAgICBjb25zdCB2YXJzID0ge1xuICAgICAgICAnUkVBREVSX0lEJzogcmVhZGVySWQsXG4gICAgICAgICdBQ0NFU1NfUkVBREVSX0lEJzogcmVhZGVySWQsIC8vIEEgc3lub255bS5cbiAgICAgIH07XG4gICAgICBpZiAodXNlQXV0aERhdGEpIHtcbiAgICAgICAgdmFyc1snQVVUSERBVEEnXSA9IGZpZWxkID0+IHtcbiAgICAgICAgICBpZiAodGhpcy5hdXRoUmVzcG9uc2VfKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0VmFsdWVGb3JFeHByKHRoaXMuYXV0aFJlc3BvbnNlXywgZmllbGQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhcnM7XG4gICAgfSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbmltcG9ydCB7RW50aXRsZW1lbnQsIEdyYW50UmVhc29ufSBmcm9tICcuL2VudGl0bGVtZW50JztcbmltcG9ydCB7Snd0SGVscGVyfSBmcm9tICcuLi8uLi9hbXAtYWNjZXNzLzAuMS9qd3QnO1xuaW1wb3J0IHtMb2NhbFN1YnNjcmlwdGlvblBsYXRmb3JtfSBmcm9tICcuL2xvY2FsLXN1YnNjcmlwdGlvbi1wbGF0Zm9ybSc7XG5pbXBvcnQge1BhZ2VDb25maWd9IGZyb20gJy4uLy4uLy4uL3RoaXJkX3BhcnR5L3N1YnNjcmlwdGlvbnMtcHJvamVjdC9jb25maWcnO1xuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi4vLi4vLi4vc3JjL3NlcnZpY2VzJztcbmltcG9ydCB7ZGV2LCB1c2VyfSBmcm9tICcuLi8uLi8uLi9zcmMvbG9nJztcbmltcG9ydCB7ZGljdH0gZnJvbSAnLi4vLi4vLi4vc3JjL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge2dldFNvdXJjZU9yaWdpbiwgZ2V0V2luT3JpZ2lufSBmcm9tICcuLi8uLi8uLi9zcmMvdXJsJztcblxuXG4vKipcbiAqIFRoaXMgaW1wbGVtZW50cyB0aGUgbWV0aG9kcyB0byBpbnRlcmFjdCB3aXRoIHZpZXdlciBzdWJzY3JpcHRpb24gcGxhdGZvcm0uXG4gKiBAaW1wbGVtZW50cyB7Li9zdWJzY3JpcHRpb24tcGxhdGZvcm0uU3Vic2NyaXB0aW9uUGxhdGZvcm19XG4gKi9cbmV4cG9ydCBjbGFzcyBWaWV3ZXJTdWJzY3JpcHRpb25QbGF0Zm9ybSB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gICAqIEBwYXJhbSB7IUpzb25PYmplY3R9IHBsYXRmb3JtQ29uZmlnXG4gICAqIEBwYXJhbSB7IS4vc2VydmljZS1hZGFwdGVyLlNlcnZpY2VBZGFwdGVyfSBzZXJ2aWNlQWRhcHRlclxuICAgKiBAcGFyYW0ge3N0cmluZ30gb3JpZ2luXG4gICAqIEBwYXJhbSB7IS4vYW5hbHl0aWNzLlN1YnNjcmlwdGlvbkFuYWx5dGljc30gc3Vic2NyaXB0aW9uQW5hbHl0aWNzXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhbXBkb2MsIHBsYXRmb3JtQ29uZmlnLCBzZXJ2aWNlQWRhcHRlciwgb3JpZ2luLFxuICAgIHN1YnNjcmlwdGlvbkFuYWx5dGljcykge1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgKi9cbiAgICB0aGlzLmFtcGRvY18gPSBhbXBkb2M7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshUGFnZUNvbmZpZ30gKi9cbiAgICB0aGlzLnBhZ2VDb25maWdfID0gc2VydmljZUFkYXB0ZXIuZ2V0UGFnZUNvbmZpZygpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IUxvY2FsU3Vic2NyaXB0aW9uUGxhdGZvcm19ICovXG4gICAgdGhpcy5wbGF0Zm9ybV8gPSBuZXcgTG9jYWxTdWJzY3JpcHRpb25QbGF0Zm9ybShcbiAgICAgICAgYW1wZG9jLCBwbGF0Zm9ybUNvbmZpZywgc2VydmljZUFkYXB0ZXIsIHN1YnNjcmlwdGlvbkFuYWx5dGljcyk7XG5cbiAgICAvKiogQGNvbnN0IEBwcml2YXRlIHshLi4vLi4vLi4vc3JjL3NlcnZpY2Uvdmlld2VyLWltcGwuVmlld2VyfSAqL1xuICAgIHRoaXMudmlld2VyXyA9IFNlcnZpY2VzLnZpZXdlckZvckRvYyh0aGlzLmFtcGRvY18pO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IUp3dEhlbHBlcn0gKi9cbiAgICB0aGlzLmp3dEhlbHBlcl8gPSBuZXcgSnd0SGVscGVyKGFtcGRvYy53aW4pO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7c3RyaW5nfSAqL1xuICAgIHRoaXMucHVibGljYXRpb25JZF8gPSB0aGlzLnBhZ2VDb25maWdfLmdldFB1YmxpY2F0aW9uSWQoKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qgez9zdHJpbmd9ICovXG4gICAgdGhpcy5jdXJyZW50UHJvZHVjdElkXyA9IHRoaXMucGFnZUNvbmZpZ18uZ2V0UHJvZHVjdElkKCk7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtzdHJpbmd9ICovXG4gICAgdGhpcy5vcmlnaW5fID0gb3JpZ2luO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBnZXRFbnRpdGxlbWVudHMoKSB7XG4gICAgZGV2KCkuYXNzZXJ0KHRoaXMuY3VycmVudFByb2R1Y3RJZF8sICdDdXJyZW50IHByb2R1Y3QgaXMgbm90IHNldCcpO1xuXG4gICAgY29uc3QgZW50aXRsZW1lbnRQcm9taXNlID0gdGhpcy52aWV3ZXJfLnNlbmRNZXNzYWdlQXdhaXRSZXNwb25zZShcbiAgICAgICAgJ2F1dGgnLFxuICAgICAgICBkaWN0KHtcbiAgICAgICAgICAncHVibGljYXRpb25JZCc6IHRoaXMucHVibGljYXRpb25JZF8sXG4gICAgICAgICAgJ3Byb2R1Y3RJZCc6IHRoaXMuY3VycmVudFByb2R1Y3RJZF8sXG4gICAgICAgICAgJ29yaWdpbic6IHRoaXMub3JpZ2luXyxcbiAgICAgICAgfSlcbiAgICApLnRoZW4oZW50aXRsZW1lbnREYXRhID0+IHtcbiAgICAgIGNvbnN0IGF1dGhEYXRhID0gKGVudGl0bGVtZW50RGF0YSB8fCB7fSlbJ2F1dGhvcml6YXRpb24nXTtcbiAgICAgIGlmICghYXV0aERhdGEpIHtcbiAgICAgICAgcmV0dXJuIEVudGl0bGVtZW50LmVtcHR5KCdsb2NhbCcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMudmVyaWZ5QXV0aFRva2VuXyhhdXRoRGF0YSk7XG4gICAgfSkuY2F0Y2gocmVhc29uID0+IHtcbiAgICAgIHRoaXMuc2VuZEF1dGhUb2tlbkVycm9yVG9WaWV3ZXJfKHJlYXNvbi5tZXNzYWdlKTtcbiAgICAgIHRocm93IHJlYXNvbjtcbiAgICB9KTtcbiAgICByZXR1cm4gLyoqIEB0eXBleyFQcm9taXNlPEVudGl0bGVtZW50Pn0gKi8gKGVudGl0bGVtZW50UHJvbWlzZSk7XG4gIH1cblxuICAvKipcbiAgICogTG9ncyBlcnJvciBhbmQgc2VuZHMgbWVzc2FnZSB0byB2aWV3ZXJcbiAgICogQHBhcmFtIHtzdHJpbmd9IHRva2VuXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCFFbnRpdGxlbWVudD59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB2ZXJpZnlBdXRoVG9rZW5fKHRva2VuKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgY29uc3Qgb3JpZ2luID0gZ2V0V2luT3JpZ2luKHRoaXMuYW1wZG9jXy53aW4pO1xuICAgICAgY29uc3Qgc291cmNlT3JpZ2luID0gZ2V0U291cmNlT3JpZ2luKHRoaXMuYW1wZG9jXy53aW4ubG9jYXRpb24pO1xuICAgICAgY29uc3QgZGVjb2RlZERhdGEgPSB0aGlzLmp3dEhlbHBlcl8uZGVjb2RlKHRva2VuKTtcbiAgICAgIGNvbnN0IGN1cnJlbnRQcm9kdWN0SWQgPSAvKiogQHR5cGUge3N0cmluZ30gKi8gKHVzZXIoKS5hc3NlcnQoXG4gICAgICAgICAgdGhpcy5wYWdlQ29uZmlnXy5nZXRQcm9kdWN0SWQoKSxcbiAgICAgICAgICAnUHJvZHVjdCBpZCBpcyBudWxsJ1xuICAgICAgKSk7XG4gICAgICBpZiAoZGVjb2RlZERhdGFbJ2F1ZCddICE9IG9yaWdpbiAmJiBkZWNvZGVkRGF0YVsnYXVkJ10gIT0gc291cmNlT3JpZ2luKSB7XG4gICAgICAgIHRocm93IHVzZXIoKS5jcmVhdGVFcnJvcihcbiAgICAgICAgICAgIGBUaGUgbWlzbWF0Y2hpbmcgXCJhdWRcIiBmaWVsZDogJHtkZWNvZGVkRGF0YVsnYXVkJ119YCk7XG4gICAgICB9XG4gICAgICBpZiAoZGVjb2RlZERhdGFbJ2V4cCddIDwgTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCkpIHtcbiAgICAgICAgdGhyb3cgdXNlcigpLmNyZWF0ZUVycm9yKCdQYXlsb2FkIGlzIGV4cGlyZWQnKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGVudGl0bGVtZW50cyA9IGRlY29kZWREYXRhWydlbnRpdGxlbWVudHMnXTtcbiAgICAgIGxldCBlbnRpdGxlbWVudCA9IEVudGl0bGVtZW50LmVtcHR5KCdsb2NhbCcpO1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZW50aXRsZW1lbnRzKSkge1xuICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgZW50aXRsZW1lbnRzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgIGlmIChlbnRpdGxlbWVudHNbaW5kZXhdWydwcm9kdWN0cyddLmluZGV4T2YoY3VycmVudFByb2R1Y3RJZClcbiAgICAgICAgICAgICAgIT09IC0xKSB7XG4gICAgICAgICAgICBjb25zdCBlbnRpdGxlbWVudE9iamVjdCA9IGVudGl0bGVtZW50c1tpbmRleF07XG4gICAgICAgICAgICBlbnRpdGxlbWVudCA9IG5ldyBFbnRpdGxlbWVudCh7XG4gICAgICAgICAgICAgIHNvdXJjZTogJ3ZpZXdlcicsXG4gICAgICAgICAgICAgIHJhdzogdG9rZW4sXG4gICAgICAgICAgICAgIGdyYW50ZWQ6IHRydWUsXG4gICAgICAgICAgICAgIGdyYW50UmVhc29uOiBlbnRpdGxlbWVudE9iamVjdC5zdWJzY3JpcHRpb25Ub2tlbiA/XG4gICAgICAgICAgICAgICAgR3JhbnRSZWFzb24uU1VCU0NSSUJFUiA6ICcnLFxuICAgICAgICAgICAgICBkYXRhT2JqZWN0OiBlbnRpdGxlbWVudE9iamVjdCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGRlY29kZWREYXRhWydtZXRlcmluZyddICYmICFkZWNvZGVkRGF0YVsnZW50aXRsZW1lbnRzJ10pIHtcbiAgICAgICAgLy8gU3BlY2lhbCBjYXNlIHdoZXJlIHZpZXdlciBnaXZlcyBtZXRlcmluZyBidXQgbm8gZW50aXRsZW1lbnRcbiAgICAgICAgZW50aXRsZW1lbnQgPSBuZXcgRW50aXRsZW1lbnQoe1xuICAgICAgICAgIHNvdXJjZTogZGVjb2RlZERhdGFbJ2lzcyddIHx8ICcnLFxuICAgICAgICAgIHJhdzogdG9rZW4sXG4gICAgICAgICAgZ3JhbnRlZDogdHJ1ZSxcbiAgICAgICAgICBncmFudFJlYXNvbjogR3JhbnRSZWFzb24uTUVURVJJTkcsXG4gICAgICAgICAgZGF0YU9iamVjdDogZGVjb2RlZERhdGFbJ21ldGVyaW5nJ10sXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChlbnRpdGxlbWVudHMpIHsgLy8gTm90IG51bGxcbiAgICAgICAgZW50aXRsZW1lbnQgPSBuZXcgRW50aXRsZW1lbnQoe1xuICAgICAgICAgIHNvdXJjZTogJ3ZpZXdlcicsXG4gICAgICAgICAgcmF3OiB0b2tlbixcbiAgICAgICAgICBncmFudGVkOiBlbnRpdGxlbWVudHMuZ3JhbnRlZCxcbiAgICAgICAgICBncmFudFJlYXNvbjogZW50aXRsZW1lbnRzLnN1YnNjcmlwdGlvblRva2VuID9cbiAgICAgICAgICAgIEdyYW50UmVhc29uLlNVQlNDUklCRVIgOiAnJyxcbiAgICAgICAgICBkYXRhT2JqZWN0OiBlbnRpdGxlbWVudHMsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBlbnRpdGxlbWVudC5zZXJ2aWNlID0gJ2xvY2FsJztcbiAgICAgIHJlc29sdmUoZW50aXRsZW1lbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIExvZ3MgZXJyb3IgYW5kIHNlbmRzIG1lc3NhZ2UgdG8gdmlld2VyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBlcnJvclN0cmluZ1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc2VuZEF1dGhUb2tlbkVycm9yVG9WaWV3ZXJfKGVycm9yU3RyaW5nKSB7XG4gICAgdGhpcy52aWV3ZXJfLnNlbmRNZXNzYWdlKCdhdXRoLXJlamVjdGVkJywgZGljdCh7XG4gICAgICAncmVhc29uJzogZXJyb3JTdHJpbmcsXG4gICAgfSkpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBnZXRTZXJ2aWNlSWQoKSB7XG4gICAgcmV0dXJuIHRoaXMucGxhdGZvcm1fLmdldFNlcnZpY2VJZCgpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBhY3RpdmF0ZSgpIHtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgaXNQaW5nYmFja0VuYWJsZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMucGxhdGZvcm1fLmlzUGluZ2JhY2tFbmFibGVkKCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHBpbmdiYWNrKHNlbGVjdGVkUGxhdGZvcm0pIHtcbiAgICB0aGlzLnBsYXRmb3JtXy5waW5nYmFjayhzZWxlY3RlZFBsYXRmb3JtKTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgc3VwcG9ydHNDdXJyZW50Vmlld2VyKCkge1xuICAgIHJldHVybiB0aGlzLnBsYXRmb3JtXy5zdXBwb3J0c0N1cnJlbnRWaWV3ZXIoKTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgZ2V0QmFzZVNjb3JlKCkge1xuICAgIHJldHVybiAwO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBleGVjdXRlQWN0aW9uKGFjdGlvbikge1xuICAgIHJldHVybiB0aGlzLnBsYXRmb3JtXy5leGVjdXRlQWN0aW9uKGFjdGlvbik7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGRlY29yYXRlVUkoZWxlbWVudCwgYWN0aW9uLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMucGxhdGZvcm1fLmRlY29yYXRlVUkoZWxlbWVudCwgYWN0aW9uLCBvcHRpb25zKTtcbiAgfVxufVxuXG4vKipcbiAqIFRPRE8oZHZveXRlbmtvKTogcmVtb3ZlIG9uY2UgY29tcGlsZXIgdHlwZSBjaGVja2luZyBpcyBmaXhlZCBmb3IgdGhpcmRfcGFydHkuXG4gKiBAcGFja2FnZSBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFBhZ2VDb25maWdDbGFzc0ZvclRlc3RpbmcoKSB7XG4gIHJldHVybiBQYWdlQ29uZmlnO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4uLy4uLy4uL3NyYy9zZXJ2aWNlcyc7XG5pbXBvcnQge2NhbmNlbGxhdGlvbn0gZnJvbSAnLi4vLi4vLi4vc3JjL2Vycm9yJztcbmltcG9ydCB7ZGV2fSBmcm9tICcuLi8uLi8uLi9zcmMvbG9nJztcbmltcG9ydCB7bGlzdGVuT25jZX0gZnJvbSAnLi4vLi4vLi4vc3JjL2V2ZW50LWhlbHBlcic7XG5cbmNvbnN0IFRBRyA9ICdsb2NhbC12aWV3ZXInO1xuXG5leHBvcnQgY2xhc3MgVmlld2VyVHJhY2tlciB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyEuLi8uLi8uLi9zcmMvc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICAgKi9cbiAgY29uc3RydWN0b3IoYW1wZG9jKSB7XG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5hbXBkb2NfID0gYW1wZG9jO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcn0gKi9cbiAgICB0aGlzLnZpZXdlcl8gPSBTZXJ2aWNlcy52aWV3ZXJGb3JEb2MoYW1wZG9jKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P1Byb21pc2V9ICovXG4gICAgdGhpcy5yZXBvcnRWaWV3UHJvbWlzZV8gPSBudWxsO1xuXG4gICAgLyoqIEBjb25zdCBAcHJpdmF0ZSB7IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL3RpbWVyLWltcGwuVGltZXJ9ICovXG4gICAgdGhpcy50aW1lcl8gPSBTZXJ2aWNlcy50aW1lckZvcihhbXBkb2Mud2luKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyEuLi8uLi8uLi9zcmMvc2VydmljZS92aWV3cG9ydC92aWV3cG9ydC1pbXBsLlZpZXdwb3J0fSAqL1xuICAgIHRoaXMudmlld3BvcnRfID0gU2VydmljZXMudmlld3BvcnRGb3JEb2MoYW1wZG9jKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3RpbWV9IHRpbWVUb1ZpZXdcbiAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAqL1xuICBzY2hlZHVsZVZpZXcodGltZVRvVmlldykge1xuICAgIHRoaXMucmVwb3J0Vmlld1Byb21pc2VfID0gbnVsbDtcbiAgICByZXR1cm4gdGhpcy5hbXBkb2NfLndoZW5SZWFkeSgpLnRoZW4oKCkgPT4ge1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICBpZiAodGhpcy52aWV3ZXJfLmlzVmlzaWJsZSgpKSB7XG4gICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmlld2VyXy5vblZpc2liaWxpdHlDaGFuZ2VkKCgpID0+IHtcbiAgICAgICAgICBpZiAodGhpcy52aWV3ZXJfLmlzVmlzaWJsZSgpKSB7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pLnRoZW4oKCkgPT4gdGhpcy5yZXBvcnRXaGVuVmlld2VkXyh0aW1lVG9WaWV3KSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHt0aW1lfSB0aW1lVG9WaWV3XG4gICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcmVwb3J0V2hlblZpZXdlZF8odGltZVRvVmlldykge1xuICAgIGlmICh0aGlzLnJlcG9ydFZpZXdQcm9taXNlXykge1xuICAgICAgcmV0dXJuIHRoaXMucmVwb3J0Vmlld1Byb21pc2VfO1xuICAgIH1cbiAgICBkZXYoKS5maW5lKFRBRywgJ3N0YXJ0IHZpZXcgbW9uaXRvcmluZycpO1xuICAgIHRoaXMucmVwb3J0Vmlld1Byb21pc2VfID0gdGhpcy53aGVuVmlld2VkXyh0aW1lVG9WaWV3KVxuICAgICAgICAuY2F0Y2gocmVhc29uID0+IHtcbiAgICAgICAgICAvLyBJZ25vcmUgLSB2aWV3IGhhcyBiZWVuIGNhbmNlbGVkLlxuICAgICAgICAgIGRldigpLmZpbmUoVEFHLCAndmlldyBjYW5jZWxsZWQ6JywgcmVhc29uKTtcbiAgICAgICAgICB0aGlzLnJlcG9ydFZpZXdQcm9taXNlXyA9IG51bGw7XG4gICAgICAgICAgdGhyb3cgcmVhc29uO1xuICAgICAgICB9KTtcblxuICAgIHJldHVybiB0aGlzLnJlcG9ydFZpZXdQcm9taXNlXztcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgcHJvbWlzZSB3aWxsIGJlIHJlc29sdmVkIHdoZW4gYSB2aWV3IG9mIHRoaXMgZG9jdW1lbnQgaGFzIG9jY3VycmVkLiBJdFxuICAgKiB3aWxsIGJlIHJlamVjdGVkIGlmIHRoZSBjdXJyZW50IGltcHJlc3Npb24gc2hvdWxkIG5vdCBiZSBjb3VudGVkIGFzIGEgdmlldy5cbiAgICogQHBhcmFtIHt0aW1lfSB0aW1lVG9WaWV3IFBhc3MgdGhlIHZhbHVlIG9mIDAgd2hlbiB0aGlzIG1ldGhvZCBpcyBjYWxsZWRcbiAgICogICBhcyB0aGUgcmVzdWx0IG9mIHRoZSB1c2VyIGFjdGlvbi5cbiAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB3aGVuVmlld2VkXyh0aW1lVG9WaWV3KSB7XG4gICAgaWYgKHRpbWVUb1ZpZXcgPT0gMCkge1xuICAgICAgLy8gSW1tZWRpYXRlIHZpZXcgaGFzIGJlZW4gcmVnaXN0ZXJlZC4gVGhpcyB3aWxsIGhhcHBlbiB3aGVuIHRoaXMgbWV0aG9kXG4gICAgICAvLyBpcyBjYWxsZWQgYXMgdGhlIHJlc3VsdCBvZiB0aGUgdXNlciBhY3Rpb24uXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuXG4gICAgLy8gVmlld2luZyBraWNrIG9mZjogZG9jdW1lbnQgaXMgdmlzaWJsZS5cbiAgICBjb25zdCB1bmxpc3RlblNldCA9IFtdO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAvLyAxLiBEb2N1bWVudCBiZWNvbWVzIGludmlzaWJsZSBhZ2FpbjogY2FuY2VsLlxuICAgICAgdW5saXN0ZW5TZXQucHVzaCh0aGlzLnZpZXdlcl8ub25WaXNpYmlsaXR5Q2hhbmdlZCgoKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy52aWV3ZXJfLmlzVmlzaWJsZSgpKSB7XG4gICAgICAgICAgcmVqZWN0KGNhbmNlbGxhdGlvbigpKTtcbiAgICAgICAgfVxuICAgICAgfSkpO1xuXG4gICAgICAvLyAyLiBBZnRlciBhIGZldyBzZWNvbmRzOiByZWdpc3RlciBhIHZpZXcuXG4gICAgICBjb25zdCB0aW1lb3V0SWQgPSB0aGlzLnRpbWVyXy5kZWxheShyZXNvbHZlLCB0aW1lVG9WaWV3KTtcbiAgICAgIHVubGlzdGVuU2V0LnB1c2goKCkgPT4gdGhpcy50aW1lcl8uY2FuY2VsKHRpbWVvdXRJZCkpO1xuXG4gICAgICAvLyAzLiBJZiBzY3JvbGxlZDogcmVnaXN0ZXIgYSB2aWV3LlxuICAgICAgdW5saXN0ZW5TZXQucHVzaCh0aGlzLnZpZXdwb3J0Xy5vblNjcm9sbChyZXNvbHZlKSk7XG5cbiAgICAgIC8vIDQuIFRhcDogcmVnaXN0ZXIgYSB2aWV3LlxuICAgICAgdW5saXN0ZW5TZXQucHVzaChsaXN0ZW5PbmNlKHRoaXMuYW1wZG9jXy5nZXRSb290Tm9kZSgpLFxuICAgICAgICAgICdjbGljaycsIHJlc29sdmUpKTtcbiAgICB9KS50aGVuKCgpID0+IHtcbiAgICAgIHVubGlzdGVuU2V0LmZvckVhY2godW5saXN0ZW4gPT4gdW5saXN0ZW4oKSk7XG4gICAgfSwgcmVhc29uID0+IHtcbiAgICAgIHVubGlzdGVuU2V0LmZvckVhY2godW5saXN0ZW4gPT4gdW5saXN0ZW4oKSk7XG4gICAgICB0aHJvdyByZWFzb247XG4gICAgfSk7XG4gIH1cbn1cbiIsIi8qIVxuXG5Db3B5cmlnaHQgKEMpIDIwMTQtMjAxNiBieSBBbmRyZWEgR2lhbW1hcmNoaSAtIEBXZWJSZWZsZWN0aW9uXG5cblBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbm9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbmluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbnRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbmNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbmFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG5JTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbkZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbk9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cblRIRSBTT0ZUV0FSRS5cblxuKi9cbi8vIGdsb2JhbCB3aW5kb3cgT2JqZWN0XG4vLyBvcHRpb25hbCBwb2x5ZmlsbCBpbmZvXG4vLyAgICAnYXV0bycgdXNlZCBieSBkZWZhdWx0LCBldmVyeXRoaW5nIGlzIGZlYXR1cmUgZGV0ZWN0ZWRcbi8vICAgICdmb3JjZScgdXNlIHRoZSBwb2x5ZmlsbCBldmVuIGlmIG5vdCBmdWxseSBuZWVkZWRcbmZ1bmN0aW9uIGluc3RhbGxDdXN0b21FbGVtZW50cyh3aW5kb3csIHBvbHlmaWxsKSB7J3VzZSBzdHJpY3QnO1xuXG4gIC8vIERPIE5PVCBVU0UgVEhJUyBGSUxFIERJUkVDVExZLCBJVCBXT04nVCBXT1JLXG4gIC8vIFRISVMgSVMgQSBQUk9KRUNUIEJBU0VEIE9OIEEgQlVJTEQgU1lTVEVNXG4gIC8vIFRISVMgRklMRSBJUyBKVVNUIFdSQVBQRUQgVVAgUkVTVUxUSU5HIElOXG4gIC8vIGJ1aWxkL2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQubm9kZS5qc1xuXG4gIHZhclxuICAgIGRvY3VtZW50ID0gd2luZG93LmRvY3VtZW50LFxuICAgIE9iamVjdCA9IHdpbmRvdy5PYmplY3RcbiAgO1xuXG4gIHZhciBodG1sQ2xhc3MgPSAoZnVuY3Rpb24gKGluZm8pIHtcbiAgICAvLyAoQykgQW5kcmVhIEdpYW1tYXJjaGkgLSBAV2ViUmVmbGVjdGlvbiAtIE1JVCBTdHlsZVxuICAgIHZhclxuICAgICAgY2F0Y2hDbGFzcyA9IC9eW0EtWl0rW2Etel0vLFxuICAgICAgZmlsdGVyQnkgPSBmdW5jdGlvbiAocmUpIHtcbiAgICAgICAgdmFyIGFyciA9IFtdLCB0YWc7XG4gICAgICAgIGZvciAodGFnIGluIHJlZ2lzdGVyKSB7XG4gICAgICAgICAgaWYgKHJlLnRlc3QodGFnKSkgYXJyLnB1c2godGFnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyO1xuICAgICAgfSxcbiAgICAgIGFkZCA9IGZ1bmN0aW9uIChDbGFzcywgdGFnKSB7XG4gICAgICAgIHRhZyA9IHRhZy50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAoISh0YWcgaW4gcmVnaXN0ZXIpKSB7XG4gICAgICAgICAgcmVnaXN0ZXJbQ2xhc3NdID0gKHJlZ2lzdGVyW0NsYXNzXSB8fCBbXSkuY29uY2F0KHRhZyk7XG4gICAgICAgICAgcmVnaXN0ZXJbdGFnXSA9IChyZWdpc3Rlclt0YWcudG9VcHBlckNhc2UoKV0gPSBDbGFzcyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICByZWdpc3RlciA9IChPYmplY3QuY3JlYXRlIHx8IE9iamVjdCkobnVsbCksXG4gICAgICBodG1sQ2xhc3MgPSB7fSxcbiAgICAgIGksIHNlY3Rpb24sIHRhZ3MsIENsYXNzXG4gICAgO1xuICAgIGZvciAoc2VjdGlvbiBpbiBpbmZvKSB7XG4gICAgICBmb3IgKENsYXNzIGluIGluZm9bc2VjdGlvbl0pIHtcbiAgICAgICAgdGFncyA9IGluZm9bc2VjdGlvbl1bQ2xhc3NdO1xuICAgICAgICByZWdpc3RlcltDbGFzc10gPSB0YWdzO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGFncy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHJlZ2lzdGVyW3RhZ3NbaV0udG9Mb3dlckNhc2UoKV0gPVxuICAgICAgICAgIHJlZ2lzdGVyW3RhZ3NbaV0udG9VcHBlckNhc2UoKV0gPSBDbGFzcztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBodG1sQ2xhc3MuZ2V0ID0gZnVuY3Rpb24gZ2V0KHRhZ09yQ2xhc3MpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdGFnT3JDbGFzcyA9PT0gJ3N0cmluZycgP1xuICAgICAgICAocmVnaXN0ZXJbdGFnT3JDbGFzc10gfHwgKGNhdGNoQ2xhc3MudGVzdCh0YWdPckNsYXNzKSA/IFtdIDogJycpKSA6XG4gICAgICAgIGZpbHRlckJ5KHRhZ09yQ2xhc3MpO1xuICAgIH07XG4gICAgaHRtbENsYXNzLnNldCA9IGZ1bmN0aW9uIHNldCh0YWcsIENsYXNzKSB7XG4gICAgICByZXR1cm4gKGNhdGNoQ2xhc3MudGVzdCh0YWcpID9cbiAgICAgICAgYWRkKHRhZywgQ2xhc3MpIDpcbiAgICAgICAgYWRkKENsYXNzLCB0YWcpXG4gICAgICApLCBodG1sQ2xhc3M7XG4gICAgfTtcbiAgICByZXR1cm4gaHRtbENsYXNzO1xuICB9KHtcbiAgICBcImNvbGxlY3Rpb25zXCI6IHtcbiAgICAgIFwiSFRNTEFsbENvbGxlY3Rpb25cIjogW1xuICAgICAgICBcImFsbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQ29sbGVjdGlvblwiOiBbXG4gICAgICAgIFwiZm9ybXNcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEZvcm1Db250cm9sc0NvbGxlY3Rpb25cIjogW1xuICAgICAgICBcImVsZW1lbnRzXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxPcHRpb25zQ29sbGVjdGlvblwiOiBbXG4gICAgICAgIFwib3B0aW9uc1wiXG4gICAgICBdXG4gICAgfSxcbiAgICBcImVsZW1lbnRzXCI6IHtcbiAgICAgIFwiRWxlbWVudFwiOiBbXG4gICAgICAgIFwiZWxlbWVudFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQW5jaG9yRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQXBwbGV0RWxlbWVudFwiOiBbXG4gICAgICAgIFwiYXBwbGV0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxBcmVhRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYXJlYVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQXR0YWNobWVudEVsZW1lbnRcIjogW1xuICAgICAgICBcImF0dGFjaG1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEF1ZGlvRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYXVkaW9cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEJSRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYnJcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEJhc2VFbGVtZW50XCI6IFtcbiAgICAgICAgXCJiYXNlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxCb2R5RWxlbWVudFwiOiBbXG4gICAgICAgIFwiYm9keVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQnV0dG9uRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYnV0dG9uXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxDYW52YXNFbGVtZW50XCI6IFtcbiAgICAgICAgXCJjYW52YXNcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTENvbnRlbnRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJjb250ZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxETGlzdEVsZW1lbnRcIjogW1xuICAgICAgICBcImRsXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxEYXRhRWxlbWVudFwiOiBbXG4gICAgICAgIFwiZGF0YVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGF0YUxpc3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkYXRhbGlzdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGV0YWlsc0VsZW1lbnRcIjogW1xuICAgICAgICBcImRldGFpbHNcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERpYWxvZ0VsZW1lbnRcIjogW1xuICAgICAgICBcImRpYWxvZ1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGlyZWN0b3J5RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZGlyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxEaXZFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkaXZcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERvY3VtZW50XCI6IFtcbiAgICAgICAgXCJkb2N1bWVudFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRWxlbWVudFwiOiBbXG4gICAgICAgIFwiZWxlbWVudFwiLFxuICAgICAgICBcImFiYnJcIixcbiAgICAgICAgXCJhZGRyZXNzXCIsXG4gICAgICAgIFwiYXJ0aWNsZVwiLFxuICAgICAgICBcImFzaWRlXCIsXG4gICAgICAgIFwiYlwiLFxuICAgICAgICBcImJkaVwiLFxuICAgICAgICBcImJkb1wiLFxuICAgICAgICBcImNpdGVcIixcbiAgICAgICAgXCJjb2RlXCIsXG4gICAgICAgIFwiY29tbWFuZFwiLFxuICAgICAgICBcImRkXCIsXG4gICAgICAgIFwiZGZuXCIsXG4gICAgICAgIFwiZHRcIixcbiAgICAgICAgXCJlbVwiLFxuICAgICAgICBcImZpZ2NhcHRpb25cIixcbiAgICAgICAgXCJmaWd1cmVcIixcbiAgICAgICAgXCJmb290ZXJcIixcbiAgICAgICAgXCJoZWFkZXJcIixcbiAgICAgICAgXCJpXCIsXG4gICAgICAgIFwia2JkXCIsXG4gICAgICAgIFwibWFya1wiLFxuICAgICAgICBcIm5hdlwiLFxuICAgICAgICBcIm5vc2NyaXB0XCIsXG4gICAgICAgIFwicnBcIixcbiAgICAgICAgXCJydFwiLFxuICAgICAgICBcInJ1YnlcIixcbiAgICAgICAgXCJzXCIsXG4gICAgICAgIFwic2FtcFwiLFxuICAgICAgICBcInNlY3Rpb25cIixcbiAgICAgICAgXCJzbWFsbFwiLFxuICAgICAgICBcInN0cm9uZ1wiLFxuICAgICAgICBcInN1YlwiLFxuICAgICAgICBcInN1bW1hcnlcIixcbiAgICAgICAgXCJzdXBcIixcbiAgICAgICAgXCJ1XCIsXG4gICAgICAgIFwidmFyXCIsXG4gICAgICAgIFwid2JyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxFbWJlZEVsZW1lbnRcIjogW1xuICAgICAgICBcImVtYmVkXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGaWVsZFNldEVsZW1lbnRcIjogW1xuICAgICAgICBcImZpZWxkc2V0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGb250RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZm9udFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRm9ybUVsZW1lbnRcIjogW1xuICAgICAgICBcImZvcm1cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEZyYW1lRWxlbWVudFwiOiBbXG4gICAgICAgIFwiZnJhbWVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEZyYW1lU2V0RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZnJhbWVzZXRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEhSRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaHJcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEhlYWRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJoZWFkXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxIZWFkaW5nRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaDFcIixcbiAgICAgICAgXCJoMlwiLFxuICAgICAgICBcImgzXCIsXG4gICAgICAgIFwiaDRcIixcbiAgICAgICAgXCJoNVwiLFxuICAgICAgICBcImg2XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxIdG1sRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaHRtbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSUZyYW1lRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaWZyYW1lXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxJbWFnZUVsZW1lbnRcIjogW1xuICAgICAgICBcImltZ1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSW5wdXRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJpbnB1dFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MS2V5Z2VuRWxlbWVudFwiOiBbXG4gICAgICAgIFwia2V5Z2VuXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxMSUVsZW1lbnRcIjogW1xuICAgICAgICBcImxpXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxMYWJlbEVsZW1lbnRcIjogW1xuICAgICAgICBcImxhYmVsXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxMZWdlbmRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJsZWdlbmRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTExpbmtFbGVtZW50XCI6IFtcbiAgICAgICAgXCJsaW5rXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNYXBFbGVtZW50XCI6IFtcbiAgICAgICAgXCJtYXBcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1hcnF1ZWVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJtYXJxdWVlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNZWRpYUVsZW1lbnRcIjogW1xuICAgICAgICBcIm1lZGlhXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNZW51RWxlbWVudFwiOiBbXG4gICAgICAgIFwibWVudVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWVudUl0ZW1FbGVtZW50XCI6IFtcbiAgICAgICAgXCJtZW51aXRlbVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWV0YUVsZW1lbnRcIjogW1xuICAgICAgICBcIm1ldGFcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1ldGVyRWxlbWVudFwiOiBbXG4gICAgICAgIFwibWV0ZXJcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1vZEVsZW1lbnRcIjogW1xuICAgICAgICBcImRlbFwiLFxuICAgICAgICBcImluc1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT0xpc3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJvbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT2JqZWN0RWxlbWVudFwiOiBbXG4gICAgICAgIFwib2JqZWN0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxPcHRHcm91cEVsZW1lbnRcIjogW1xuICAgICAgICBcIm9wdGdyb3VwXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxPcHRpb25FbGVtZW50XCI6IFtcbiAgICAgICAgXCJvcHRpb25cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE91dHB1dEVsZW1lbnRcIjogW1xuICAgICAgICBcIm91dHB1dFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUGFyYWdyYXBoRWxlbWVudFwiOiBbXG4gICAgICAgIFwicFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUGFyYW1FbGVtZW50XCI6IFtcbiAgICAgICAgXCJwYXJhbVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUGljdHVyZUVsZW1lbnRcIjogW1xuICAgICAgICBcInBpY3R1cmVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFByZUVsZW1lbnRcIjogW1xuICAgICAgICBcInByZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUHJvZ3Jlc3NFbGVtZW50XCI6IFtcbiAgICAgICAgXCJwcm9ncmVzc1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUXVvdGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJibG9ja3F1b3RlXCIsXG4gICAgICAgIFwicVwiLFxuICAgICAgICBcInF1b3RlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxTY3JpcHRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJzY3JpcHRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFNlbGVjdEVsZW1lbnRcIjogW1xuICAgICAgICBcInNlbGVjdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU2hhZG93RWxlbWVudFwiOiBbXG4gICAgICAgIFwic2hhZG93XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxTbG90RWxlbWVudFwiOiBbXG4gICAgICAgIFwic2xvdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU291cmNlRWxlbWVudFwiOiBbXG4gICAgICAgIFwic291cmNlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxTcGFuRWxlbWVudFwiOiBbXG4gICAgICAgIFwic3BhblwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU3R5bGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJzdHlsZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVDYXB0aW9uRWxlbWVudFwiOiBbXG4gICAgICAgIFwiY2FwdGlvblwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVDZWxsRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGRcIixcbiAgICAgICAgXCJ0aFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVDb2xFbGVtZW50XCI6IFtcbiAgICAgICAgXCJjb2xcIixcbiAgICAgICAgXCJjb2xncm91cFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0YWJsZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVSb3dFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0clwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVTZWN0aW9uRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGhlYWRcIixcbiAgICAgICAgXCJ0Ym9keVwiLFxuICAgICAgICBcInRmb290XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxUZW1wbGF0ZUVsZW1lbnRcIjogW1xuICAgICAgICBcInRlbXBsYXRlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxUZXh0QXJlYUVsZW1lbnRcIjogW1xuICAgICAgICBcInRleHRhcmVhXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxUaW1lRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGltZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGl0bGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0aXRsZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVHJhY2tFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0cmFja1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVUxpc3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ1bFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVW5rbm93bkVsZW1lbnRcIjogW1xuICAgICAgICBcInVua25vd25cIixcbiAgICAgICAgXCJ2aGdyb3VwdlwiLFxuICAgICAgICBcInZrZXlnZW5cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFZpZGVvRWxlbWVudFwiOiBbXG4gICAgICAgIFwidmlkZW9cIlxuICAgICAgXVxuICAgIH0sXG4gICAgXCJub2Rlc1wiOiB7XG4gICAgICBcIkF0dHJcIjogW1xuICAgICAgICBcIm5vZGVcIlxuICAgICAgXSxcbiAgICAgIFwiQXVkaW9cIjogW1xuICAgICAgICBcImF1ZGlvXCJcbiAgICAgIF0sXG4gICAgICBcIkNEQVRBU2VjdGlvblwiOiBbXG4gICAgICAgIFwibm9kZVwiXG4gICAgICBdLFxuICAgICAgXCJDaGFyYWN0ZXJEYXRhXCI6IFtcbiAgICAgICAgXCJub2RlXCJcbiAgICAgIF0sXG4gICAgICBcIkNvbW1lbnRcIjogW1xuICAgICAgICBcIiNjb21tZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkRvY3VtZW50XCI6IFtcbiAgICAgICAgXCIjZG9jdW1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiRG9jdW1lbnRGcmFnbWVudFwiOiBbXG4gICAgICAgIFwiI2RvY3VtZW50LWZyYWdtZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkRvY3VtZW50VHlwZVwiOiBbXG4gICAgICAgIFwibm9kZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRG9jdW1lbnRcIjogW1xuICAgICAgICBcIiNkb2N1bWVudFwiXG4gICAgICBdLFxuICAgICAgXCJJbWFnZVwiOiBbXG4gICAgICAgIFwiaW1nXCJcbiAgICAgIF0sXG4gICAgICBcIk9wdGlvblwiOiBbXG4gICAgICAgIFwib3B0aW9uXCJcbiAgICAgIF0sXG4gICAgICBcIlByb2Nlc3NpbmdJbnN0cnVjdGlvblwiOiBbXG4gICAgICAgIFwibm9kZVwiXG4gICAgICBdLFxuICAgICAgXCJTaGFkb3dSb290XCI6IFtcbiAgICAgICAgXCIjc2hhZG93LXJvb3RcIlxuICAgICAgXSxcbiAgICAgIFwiVGV4dFwiOiBbXG4gICAgICAgIFwiI3RleHRcIlxuICAgICAgXSxcbiAgICAgIFwiWE1MRG9jdW1lbnRcIjogW1xuICAgICAgICBcInhtbFwiXG4gICAgICBdXG4gICAgfVxuICB9KSk7XG4gIFxuICBcbiAgICBcbiAgLy8gcGFzc2VkIGF0IHJ1bnRpbWUsIGNvbmZpZ3VyYWJsZVxuICAvLyB2aWEgbm9kZWpzIG1vZHVsZVxuICBpZiAoIXBvbHlmaWxsKSBwb2x5ZmlsbCA9ICdhdXRvJztcbiAgXG4gIHZhclxuICAgIC8vIFYwIHBvbHlmaWxsIGVudHJ5XG4gICAgUkVHSVNURVJfRUxFTUVOVCA9ICdyZWdpc3RlckVsZW1lbnQnLFxuICBcbiAgICAvLyBJRSA8IDExIG9ubHkgKyBvbGQgV2ViS2l0IGZvciBhdHRyaWJ1dGVzICsgZmVhdHVyZSBkZXRlY3Rpb25cbiAgICBFWFBBTkRPX1VJRCA9ICdfXycgKyBSRUdJU1RFUl9FTEVNRU5UICsgKHdpbmRvdy5NYXRoLnJhbmRvbSgpICogMTBlNCA+PiAwKSxcbiAgXG4gICAgLy8gc2hvcnRjdXRzIGFuZCBjb3N0YW50c1xuICAgIEFERF9FVkVOVF9MSVNURU5FUiA9ICdhZGRFdmVudExpc3RlbmVyJyxcbiAgICBBVFRBQ0hFRCA9ICdhdHRhY2hlZCcsXG4gICAgQ0FMTEJBQ0sgPSAnQ2FsbGJhY2snLFxuICAgIERFVEFDSEVEID0gJ2RldGFjaGVkJyxcbiAgICBFWFRFTkRTID0gJ2V4dGVuZHMnLFxuICBcbiAgICBBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDSyA9ICdhdHRyaWJ1dGVDaGFuZ2VkJyArIENBTExCQUNLLFxuICAgIEFUVEFDSEVEX0NBTExCQUNLID0gQVRUQUNIRUQgKyBDQUxMQkFDSyxcbiAgICBDT05ORUNURURfQ0FMTEJBQ0sgPSAnY29ubmVjdGVkJyArIENBTExCQUNLLFxuICAgIERJU0NPTk5FQ1RFRF9DQUxMQkFDSyA9ICdkaXNjb25uZWN0ZWQnICsgQ0FMTEJBQ0ssXG4gICAgQ1JFQVRFRF9DQUxMQkFDSyA9ICdjcmVhdGVkJyArIENBTExCQUNLLFxuICAgIERFVEFDSEVEX0NBTExCQUNLID0gREVUQUNIRUQgKyBDQUxMQkFDSyxcbiAgXG4gICAgQURESVRJT04gPSAnQURESVRJT04nLFxuICAgIE1PRElGSUNBVElPTiA9ICdNT0RJRklDQVRJT04nLFxuICAgIFJFTU9WQUwgPSAnUkVNT1ZBTCcsXG4gIFxuICAgIERPTV9BVFRSX01PRElGSUVEID0gJ0RPTUF0dHJNb2RpZmllZCcsXG4gICAgRE9NX0NPTlRFTlRfTE9BREVEID0gJ0RPTUNvbnRlbnRMb2FkZWQnLFxuICAgIERPTV9TVUJUUkVFX01PRElGSUVEID0gJ0RPTVN1YnRyZWVNb2RpZmllZCcsXG4gIFxuICAgIFBSRUZJWF9UQUcgPSAnPCcsXG4gICAgUFJFRklYX0lTID0gJz0nLFxuICBcbiAgICAvLyB2YWxpZCBhbmQgaW52YWxpZCBub2RlIG5hbWVzXG4gICAgdmFsaWROYW1lID0gL15bQS1aXVtBLVowLTldKig/Oi1bQS1aMC05XSspKyQvLFxuICAgIGludmFsaWROYW1lcyA9IFtcbiAgICAgICdBTk5PVEFUSU9OLVhNTCcsXG4gICAgICAnQ09MT1ItUFJPRklMRScsXG4gICAgICAnRk9OVC1GQUNFJyxcbiAgICAgICdGT05ULUZBQ0UtU1JDJyxcbiAgICAgICdGT05ULUZBQ0UtVVJJJyxcbiAgICAgICdGT05ULUZBQ0UtRk9STUFUJyxcbiAgICAgICdGT05ULUZBQ0UtTkFNRScsXG4gICAgICAnTUlTU0lORy1HTFlQSCdcbiAgICBdLFxuICBcbiAgICAvLyByZWdpc3RlcmVkIHR5cGVzIGFuZCB0aGVpciBwcm90b3R5cGVzXG4gICAgdHlwZXMgPSBbXSxcbiAgICBwcm90b3MgPSBbXSxcbiAgXG4gICAgLy8gdG8gcXVlcnkgc3Vibm9kZXNcbiAgICBxdWVyeSA9ICcnLFxuICBcbiAgICAvLyBodG1sIHNob3J0Y3V0IHVzZWQgdG8gZmVhdHVyZSBkZXRlY3RcbiAgICBkb2N1bWVudEVsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsXG4gIFxuICAgIC8vIEVTNSBpbmxpbmUgaGVscGVycyB8fCBiYXNpYyBwYXRjaGVzXG4gICAgaW5kZXhPZiA9IHR5cGVzLmluZGV4T2YgfHwgZnVuY3Rpb24gKHYpIHtcbiAgICAgIGZvcih2YXIgaSA9IHRoaXMubGVuZ3RoOyBpLS0gJiYgdGhpc1tpXSAhPT0gdjspe31cbiAgICAgIHJldHVybiBpO1xuICAgIH0sXG4gIFxuICAgIC8vIG90aGVyIGhlbHBlcnMgLyBzaG9ydGN1dHNcbiAgICBPUCA9IE9iamVjdC5wcm90b3R5cGUsXG4gICAgaE9QID0gT1AuaGFzT3duUHJvcGVydHksXG4gICAgaVBPID0gT1AuaXNQcm90b3R5cGVPZixcbiAgXG4gICAgZGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHksXG4gICAgZW1wdHkgPSBbXSxcbiAgICBnT1BEID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcixcbiAgICBnT1BOID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMsXG4gICAgZ1BPID0gT2JqZWN0LmdldFByb3RvdHlwZU9mLFxuICAgIHNQTyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZixcbiAgXG4gICAgLy8ganNoaW50IHByb3RvOiB0cnVlXG4gICAgaGFzUHJvdG8gPSAhIU9iamVjdC5fX3Byb3RvX18sXG4gIFxuICAgIC8vIFYxIGhlbHBlcnNcbiAgICBmaXhHZXRDbGFzcyA9IGZhbHNlLFxuICAgIERSRUNFVjEgPSAnX19kcmVDRXYxJyxcbiAgICBjdXN0b21FbGVtZW50cyA9IHdpbmRvdy5jdXN0b21FbGVtZW50cyxcbiAgICB1c2FibGVDdXN0b21FbGVtZW50cyA9IHBvbHlmaWxsICE9PSAnZm9yY2UnICYmICEhKFxuICAgICAgY3VzdG9tRWxlbWVudHMgJiZcbiAgICAgIGN1c3RvbUVsZW1lbnRzLmRlZmluZSAmJlxuICAgICAgY3VzdG9tRWxlbWVudHMuZ2V0ICYmXG4gICAgICBjdXN0b21FbGVtZW50cy53aGVuRGVmaW5lZFxuICAgICksXG4gICAgRGljdCA9IE9iamVjdC5jcmVhdGUgfHwgT2JqZWN0LFxuICAgIE1hcCA9IHdpbmRvdy5NYXAgfHwgZnVuY3Rpb24gTWFwKCkge1xuICAgICAgdmFyIEsgPSBbXSwgViA9IFtdLCBpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoaykge1xuICAgICAgICAgIHJldHVybiBWW2luZGV4T2YuY2FsbChLLCBrKV07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGssIHYpIHtcbiAgICAgICAgICBpID0gaW5kZXhPZi5jYWxsKEssIGspO1xuICAgICAgICAgIGlmIChpIDwgMCkgVltLLnB1c2goaykgLSAxXSA9IHY7XG4gICAgICAgICAgZWxzZSBWW2ldID0gdjtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9LFxuICAgIFByb21pc2UgPSB3aW5kb3cuUHJvbWlzZSB8fCBmdW5jdGlvbiAoZm4pIHtcbiAgICAgIHZhclxuICAgICAgICBub3RpZnkgPSBbXSxcbiAgICAgICAgZG9uZSA9IGZhbHNlLFxuICAgICAgICBwID0ge1xuICAgICAgICAgICdjYXRjaCc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBwO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ3RoZW4nOiBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgICAgIG5vdGlmeS5wdXNoKGNiKTtcbiAgICAgICAgICAgIGlmIChkb25lKSBzZXRUaW1lb3V0KHJlc29sdmUsIDEpO1xuICAgICAgICAgICAgcmV0dXJuIHA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICA7XG4gICAgICBmdW5jdGlvbiByZXNvbHZlKHZhbHVlKSB7XG4gICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICB3aGlsZSAobm90aWZ5Lmxlbmd0aCkgbm90aWZ5LnNoaWZ0KCkodmFsdWUpO1xuICAgICAgfVxuICAgICAgZm4ocmVzb2x2ZSk7XG4gICAgICByZXR1cm4gcDtcbiAgICB9LFxuICAgIGp1c3RDcmVhdGVkID0gZmFsc2UsXG4gICAgY29uc3RydWN0b3JzID0gRGljdChudWxsKSxcbiAgICB3YWl0aW5nTGlzdCA9IERpY3QobnVsbCksXG4gICAgbm9kZU5hbWVzID0gbmV3IE1hcCgpLFxuICAgIHNlY29uZEFyZ3VtZW50ID0gZnVuY3Rpb24gKGlzKSB7XG4gICAgICByZXR1cm4gaXMudG9Mb3dlckNhc2UoKTtcbiAgICB9LFxuICBcbiAgICAvLyB1c2VkIHRvIGNyZWF0ZSB1bmlxdWUgaW5zdGFuY2VzXG4gICAgY3JlYXRlID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiBCcmlkZ2UocHJvdG8pIHtcbiAgICAgIC8vIHNpbGx5IGJyb2tlbiBwb2x5ZmlsbCBwcm9iYWJseSBldmVyIHVzZWQgYnV0IHNob3J0IGVub3VnaCB0byB3b3JrXG4gICAgICByZXR1cm4gcHJvdG8gPyAoKEJyaWRnZS5wcm90b3R5cGUgPSBwcm90byksIG5ldyBCcmlkZ2UoKSkgOiB0aGlzO1xuICAgIH0sXG4gIFxuICAgIC8vIHdpbGwgc2V0IHRoZSBwcm90b3R5cGUgaWYgcG9zc2libGVcbiAgICAvLyBvciBjb3B5IG92ZXIgYWxsIHByb3BlcnRpZXNcbiAgICBzZXRQcm90b3R5cGUgPSBzUE8gfHwgKFxuICAgICAgaGFzUHJvdG8gP1xuICAgICAgICBmdW5jdGlvbiAobywgcCkge1xuICAgICAgICAgIG8uX19wcm90b19fID0gcDtcbiAgICAgICAgICByZXR1cm4gbztcbiAgICAgICAgfSA6IChcbiAgICAgIChnT1BOICYmIGdPUEQpID9cbiAgICAgICAgKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgZnVuY3Rpb24gc2V0UHJvcGVydGllcyhvLCBwKSB7XG4gICAgICAgICAgICBmb3IgKHZhclxuICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgIG5hbWVzID0gZ09QTihwKSxcbiAgICAgICAgICAgICAgaSA9IDAsIGxlbmd0aCA9IG5hbWVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgaSA8IGxlbmd0aDsgaSsrXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAga2V5ID0gbmFtZXNbaV07XG4gICAgICAgICAgICAgIGlmICghaE9QLmNhbGwobywga2V5KSkge1xuICAgICAgICAgICAgICAgIGRlZmluZVByb3BlcnR5KG8sIGtleSwgZ09QRChwLCBrZXkpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG8sIHApIHtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgc2V0UHJvcGVydGllcyhvLCBwKTtcbiAgICAgICAgICAgIH0gd2hpbGUgKChwID0gZ1BPKHApKSAmJiAhaVBPLmNhbGwocCwgbykpO1xuICAgICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgICAgfTtcbiAgICAgICAgfSgpKSA6XG4gICAgICAgIGZ1bmN0aW9uIChvLCBwKSB7XG4gICAgICAgICAgZm9yICh2YXIga2V5IGluIHApIHtcbiAgICAgICAgICAgIG9ba2V5XSA9IHBba2V5XTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgIH1cbiAgICApKSxcbiAgXG4gICAgLy8gRE9NIHNob3J0Y3V0cyBhbmQgaGVscGVycywgaWYgYW55XG4gIFxuICAgIE11dGF0aW9uT2JzZXJ2ZXIgPSB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fFxuICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlcixcbiAgXG4gICAgSFRNTEVsZW1lbnRQcm90b3R5cGUgPSAoXG4gICAgICB3aW5kb3cuSFRNTEVsZW1lbnQgfHxcbiAgICAgIHdpbmRvdy5FbGVtZW50IHx8XG4gICAgICB3aW5kb3cuTm9kZVxuICAgICkucHJvdG90eXBlLFxuICBcbiAgICBJRTggPSAhaVBPLmNhbGwoSFRNTEVsZW1lbnRQcm90b3R5cGUsIGRvY3VtZW50RWxlbWVudCksXG4gIFxuICAgIHNhZmVQcm9wZXJ0eSA9IElFOCA/IGZ1bmN0aW9uIChvLCBrLCBkKSB7XG4gICAgICBvW2tdID0gZC52YWx1ZTtcbiAgICAgIHJldHVybiBvO1xuICAgIH0gOiBkZWZpbmVQcm9wZXJ0eSxcbiAgXG4gICAgaXNWYWxpZE5vZGUgPSBJRTggP1xuICAgICAgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IDE7XG4gICAgICB9IDpcbiAgICAgIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHJldHVybiBpUE8uY2FsbChIVE1MRWxlbWVudFByb3RvdHlwZSwgbm9kZSk7XG4gICAgICB9LFxuICBcbiAgICB0YXJnZXRzID0gSUU4ICYmIFtdLFxuICBcbiAgICBhdHRhY2hTaGFkb3cgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5hdHRhY2hTaGFkb3csXG4gICAgY2xvbmVOb2RlID0gSFRNTEVsZW1lbnRQcm90b3R5cGUuY2xvbmVOb2RlLFxuICAgIGRpc3BhdGNoRXZlbnQgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5kaXNwYXRjaEV2ZW50LFxuICAgIGdldEF0dHJpYnV0ZSA9IEhUTUxFbGVtZW50UHJvdG90eXBlLmdldEF0dHJpYnV0ZSxcbiAgICBoYXNBdHRyaWJ1dGUgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5oYXNBdHRyaWJ1dGUsXG4gICAgcmVtb3ZlQXR0cmlidXRlID0gSFRNTEVsZW1lbnRQcm90b3R5cGUucmVtb3ZlQXR0cmlidXRlLFxuICAgIHNldEF0dHJpYnV0ZSA9IEhUTUxFbGVtZW50UHJvdG90eXBlLnNldEF0dHJpYnV0ZSxcbiAgXG4gICAgLy8gcmVwbGFjZWQgbGF0ZXIgb25cbiAgICBjcmVhdGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCxcbiAgICBwYXRjaGVkQ3JlYXRlRWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQsXG4gIFxuICAgIC8vIHNoYXJlZCBvYnNlcnZlciBmb3IgYWxsIGF0dHJpYnV0ZXNcbiAgICBhdHRyaWJ1dGVzT2JzZXJ2ZXIgPSBNdXRhdGlvbk9ic2VydmVyICYmIHtcbiAgICAgIGF0dHJpYnV0ZXM6IHRydWUsXG4gICAgICBjaGFyYWN0ZXJEYXRhOiB0cnVlLFxuICAgICAgYXR0cmlidXRlT2xkVmFsdWU6IHRydWVcbiAgICB9LFxuICBcbiAgICAvLyB1c2VmdWwgdG8gZGV0ZWN0IG9ubHkgaWYgdGhlcmUncyBubyBNdXRhdGlvbk9ic2VydmVyXG4gICAgRE9NQXR0ck1vZGlmaWVkID0gTXV0YXRpb25PYnNlcnZlciB8fCBmdW5jdGlvbihlKSB7XG4gICAgICBkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCA9IGZhbHNlO1xuICAgICAgZG9jdW1lbnRFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgIERPTV9BVFRSX01PRElGSUVELFxuICAgICAgICBET01BdHRyTW9kaWZpZWRcbiAgICAgICk7XG4gICAgfSxcbiAgXG4gICAgLy8gd2lsbCBib3RoIGJlIHVzZWQgdG8gbWFrZSBET01Ob2RlSW5zZXJ0ZWQgYXN5bmNocm9ub3VzXG4gICAgYXNhcFF1ZXVlLFxuICAgIGFzYXBUaW1lciA9IDAsXG4gIFxuICAgIC8vIGludGVybmFsIGZsYWdzXG4gICAgVjAgPSBSRUdJU1RFUl9FTEVNRU5UIGluIGRvY3VtZW50LFxuICAgIHNldExpc3RlbmVyID0gdHJ1ZSxcbiAgICBqdXN0U2V0dXAgPSBmYWxzZSxcbiAgICBkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCA9IHRydWUsXG4gICAgZHJvcERvbUNvbnRlbnRMb2FkZWQgPSB0cnVlLFxuICBcbiAgICAvLyBuZWVkZWQgZm9yIHRoZSBpbm5lckhUTUwgaGVscGVyXG4gICAgbm90RnJvbUlubmVySFRNTEhlbHBlciA9IHRydWUsXG4gIFxuICAgIC8vIG9wdGlvbmFsbHkgZGVmaW5lZCBsYXRlciBvblxuICAgIG9uU3VidHJlZU1vZGlmaWVkLFxuICAgIGNhbGxET01BdHRyTW9kaWZpZWQsXG4gICAgZ2V0QXR0cmlidXRlc01pcnJvcixcbiAgICBvYnNlcnZlcixcbiAgICBvYnNlcnZlLFxuICBcbiAgICAvLyBiYXNlZCBvbiBzZXR0aW5nIHByb3RvdHlwZSBjYXBhYmlsaXR5XG4gICAgLy8gd2lsbCBjaGVjayBwcm90byBvciB0aGUgZXhwYW5kbyBhdHRyaWJ1dGVcbiAgICAvLyBpbiBvcmRlciB0byBzZXR1cCB0aGUgbm9kZSBvbmNlXG4gICAgcGF0Y2hJZk5vdEFscmVhZHksXG4gICAgcGF0Y2hcbiAgO1xuICBcbiAgLy8gb25seSBpZiBuZWVkZWRcbiAgaWYgKCFWMCkge1xuICBcbiAgICBpZiAoc1BPIHx8IGhhc1Byb3RvKSB7XG4gICAgICAgIHBhdGNoSWZOb3RBbHJlYWR5ID0gZnVuY3Rpb24gKG5vZGUsIHByb3RvKSB7XG4gICAgICAgICAgaWYgKCFpUE8uY2FsbChwcm90bywgbm9kZSkpIHtcbiAgICAgICAgICAgIHNldHVwTm9kZShub2RlLCBwcm90byk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBwYXRjaCA9IHNldHVwTm9kZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBwYXRjaElmTm90QWxyZWFkeSA9IGZ1bmN0aW9uIChub2RlLCBwcm90bykge1xuICAgICAgICAgIGlmICghbm9kZVtFWFBBTkRPX1VJRF0pIHtcbiAgICAgICAgICAgIG5vZGVbRVhQQU5ET19VSURdID0gT2JqZWN0KHRydWUpO1xuICAgICAgICAgICAgc2V0dXBOb2RlKG5vZGUsIHByb3RvKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHBhdGNoID0gcGF0Y2hJZk5vdEFscmVhZHk7XG4gICAgfVxuICBcbiAgICBpZiAoSUU4KSB7XG4gICAgICBkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCA9IGZhbHNlO1xuICAgICAgKGZ1bmN0aW9uICgpe1xuICAgICAgICB2YXJcbiAgICAgICAgICBkZXNjcmlwdG9yID0gZ09QRChIVE1MRWxlbWVudFByb3RvdHlwZSwgQUREX0VWRU5UX0xJU1RFTkVSKSxcbiAgICAgICAgICBhZGRFdmVudExpc3RlbmVyID0gZGVzY3JpcHRvci52YWx1ZSxcbiAgICAgICAgICBwYXRjaGVkUmVtb3ZlQXR0cmlidXRlID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIHZhciBlID0gbmV3IEN1c3RvbUV2ZW50KERPTV9BVFRSX01PRElGSUVELCB7YnViYmxlczogdHJ1ZX0pO1xuICAgICAgICAgICAgZS5hdHRyTmFtZSA9IG5hbWU7XG4gICAgICAgICAgICBlLnByZXZWYWx1ZSA9IGdldEF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUpO1xuICAgICAgICAgICAgZS5uZXdWYWx1ZSA9IG51bGw7XG4gICAgICAgICAgICBlW1JFTU9WQUxdID0gZS5hdHRyQ2hhbmdlID0gMjtcbiAgICAgICAgICAgIHJlbW92ZUF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUpO1xuICAgICAgICAgICAgZGlzcGF0Y2hFdmVudC5jYWxsKHRoaXMsIGUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgcGF0Y2hlZFNldEF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICAgICAgdmFyXG4gICAgICAgICAgICAgIGhhZCA9IGhhc0F0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUpLFxuICAgICAgICAgICAgICBvbGQgPSBoYWQgJiYgZ2V0QXR0cmlidXRlLmNhbGwodGhpcywgbmFtZSksXG4gICAgICAgICAgICAgIGUgPSBuZXcgQ3VzdG9tRXZlbnQoRE9NX0FUVFJfTU9ESUZJRUQsIHtidWJibGVzOiB0cnVlfSlcbiAgICAgICAgICAgIDtcbiAgICAgICAgICAgIHNldEF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgIGUuYXR0ck5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgZS5wcmV2VmFsdWUgPSBoYWQgPyBvbGQgOiBudWxsO1xuICAgICAgICAgICAgZS5uZXdWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgaWYgKGhhZCkge1xuICAgICAgICAgICAgICBlW01PRElGSUNBVElPTl0gPSBlLmF0dHJDaGFuZ2UgPSAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZVtBRERJVElPTl0gPSBlLmF0dHJDaGFuZ2UgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGlzcGF0Y2hFdmVudC5jYWxsKHRoaXMsIGUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgb25Qcm9wZXJ0eUNoYW5nZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAvLyBqc2hpbnQgZXFudWxsOnRydWVcbiAgICAgICAgICAgIHZhclxuICAgICAgICAgICAgICBub2RlID0gZS5jdXJyZW50VGFyZ2V0LFxuICAgICAgICAgICAgICBzdXBlclNlY3JldCA9IG5vZGVbRVhQQU5ET19VSURdLFxuICAgICAgICAgICAgICBwcm9wZXJ0eU5hbWUgPSBlLnByb3BlcnR5TmFtZSxcbiAgICAgICAgICAgICAgZXZlbnRcbiAgICAgICAgICAgIDtcbiAgICAgICAgICAgIGlmIChzdXBlclNlY3JldC5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eU5hbWUpKSB7XG4gICAgICAgICAgICAgIHN1cGVyU2VjcmV0ID0gc3VwZXJTZWNyZXRbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgICAgICAgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoRE9NX0FUVFJfTU9ESUZJRUQsIHtidWJibGVzOiB0cnVlfSk7XG4gICAgICAgICAgICAgIGV2ZW50LmF0dHJOYW1lID0gc3VwZXJTZWNyZXQubmFtZTtcbiAgICAgICAgICAgICAgZXZlbnQucHJldlZhbHVlID0gc3VwZXJTZWNyZXQudmFsdWUgfHwgbnVsbDtcbiAgICAgICAgICAgICAgZXZlbnQubmV3VmFsdWUgPSAoc3VwZXJTZWNyZXQudmFsdWUgPSBub2RlW3Byb3BlcnR5TmFtZV0gfHwgbnVsbCk7XG4gICAgICAgICAgICAgIGlmIChldmVudC5wcmV2VmFsdWUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGV2ZW50W0FERElUSU9OXSA9IGV2ZW50LmF0dHJDaGFuZ2UgPSAwO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGV2ZW50W01PRElGSUNBVElPTl0gPSBldmVudC5hdHRyQ2hhbmdlID0gMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBkaXNwYXRjaEV2ZW50LmNhbGwobm9kZSwgZXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgO1xuICAgICAgICBkZXNjcmlwdG9yLnZhbHVlID0gZnVuY3Rpb24gKHR5cGUsIGhhbmRsZXIsIGNhcHR1cmUpIHtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICB0eXBlID09PSBET01fQVRUUl9NT0RJRklFRCAmJlxuICAgICAgICAgICAgdGhpc1tBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDS10gJiZcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlICE9PSBwYXRjaGVkU2V0QXR0cmlidXRlXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzW0VYUEFORE9fVUlEXSA9IHtcbiAgICAgICAgICAgICAgY2xhc3NOYW1lOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ2NsYXNzJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5jbGFzc05hbWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlID0gcGF0Y2hlZFNldEF0dHJpYnV0ZTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlID0gcGF0Y2hlZFJlbW92ZUF0dHJpYnV0ZTtcbiAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCAncHJvcGVydHljaGFuZ2UnLCBvblByb3BlcnR5Q2hhbmdlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsIHR5cGUsIGhhbmRsZXIsIGNhcHR1cmUpO1xuICAgICAgICB9O1xuICAgICAgICBkZWZpbmVQcm9wZXJ0eShIVE1MRWxlbWVudFByb3RvdHlwZSwgQUREX0VWRU5UX0xJU1RFTkVSLCBkZXNjcmlwdG9yKTtcbiAgICAgIH0oKSk7XG4gICAgfSBlbHNlIGlmICghTXV0YXRpb25PYnNlcnZlcikge1xuICAgICAgZG9jdW1lbnRFbGVtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oRE9NX0FUVFJfTU9ESUZJRUQsIERPTUF0dHJNb2RpZmllZCk7XG4gICAgICBkb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKEVYUEFORE9fVUlELCAxKTtcbiAgICAgIGRvY3VtZW50RWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoRVhQQU5ET19VSUQpO1xuICAgICAgaWYgKGRvZXNOb3RTdXBwb3J0RE9NQXR0ck1vZGlmaWVkKSB7XG4gICAgICAgIG9uU3VidHJlZU1vZGlmaWVkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICB2YXJcbiAgICAgICAgICAgIG5vZGUgPSB0aGlzLFxuICAgICAgICAgICAgb2xkQXR0cmlidXRlcyxcbiAgICAgICAgICAgIG5ld0F0dHJpYnV0ZXMsXG4gICAgICAgICAgICBrZXlcbiAgICAgICAgICA7XG4gICAgICAgICAgaWYgKG5vZGUgPT09IGUudGFyZ2V0KSB7XG4gICAgICAgICAgICBvbGRBdHRyaWJ1dGVzID0gbm9kZVtFWFBBTkRPX1VJRF07XG4gICAgICAgICAgICBub2RlW0VYUEFORE9fVUlEXSA9IChuZXdBdHRyaWJ1dGVzID0gZ2V0QXR0cmlidXRlc01pcnJvcihub2RlKSk7XG4gICAgICAgICAgICBmb3IgKGtleSBpbiBuZXdBdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgIGlmICghKGtleSBpbiBvbGRBdHRyaWJ1dGVzKSkge1xuICAgICAgICAgICAgICAgIC8vIGF0dHJpYnV0ZSB3YXMgYWRkZWRcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbERPTUF0dHJNb2RpZmllZChcbiAgICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgICBub2RlLFxuICAgICAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICAgICAgb2xkQXR0cmlidXRlc1trZXldLFxuICAgICAgICAgICAgICAgICAgbmV3QXR0cmlidXRlc1trZXldLFxuICAgICAgICAgICAgICAgICAgQURESVRJT05cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5ld0F0dHJpYnV0ZXNba2V5XSAhPT0gb2xkQXR0cmlidXRlc1trZXldKSB7XG4gICAgICAgICAgICAgICAgLy8gYXR0cmlidXRlIHdhcyBjaGFuZ2VkXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxET01BdHRyTW9kaWZpZWQoXG4gICAgICAgICAgICAgICAgICAxLFxuICAgICAgICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgIG9sZEF0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIG5ld0F0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIE1PRElGSUNBVElPTlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNoZWNraW5nIGlmIGl0IGhhcyBiZWVuIHJlbW92ZWRcbiAgICAgICAgICAgIGZvciAoa2V5IGluIG9sZEF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgaWYgKCEoa2V5IGluIG5ld0F0dHJpYnV0ZXMpKSB7XG4gICAgICAgICAgICAgICAgLy8gYXR0cmlidXRlIHJlbW92ZWRcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbERPTUF0dHJNb2RpZmllZChcbiAgICAgICAgICAgICAgICAgIDIsXG4gICAgICAgICAgICAgICAgICBub2RlLFxuICAgICAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICAgICAgb2xkQXR0cmlidXRlc1trZXldLFxuICAgICAgICAgICAgICAgICAgbmV3QXR0cmlidXRlc1trZXldLFxuICAgICAgICAgICAgICAgICAgUkVNT1ZBTFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNhbGxET01BdHRyTW9kaWZpZWQgPSBmdW5jdGlvbiAoXG4gICAgICAgICAgYXR0ckNoYW5nZSxcbiAgICAgICAgICBjdXJyZW50VGFyZ2V0LFxuICAgICAgICAgIGF0dHJOYW1lLFxuICAgICAgICAgIHByZXZWYWx1ZSxcbiAgICAgICAgICBuZXdWYWx1ZSxcbiAgICAgICAgICBhY3Rpb25cbiAgICAgICAgKSB7XG4gICAgICAgICAgdmFyIGUgPSB7XG4gICAgICAgICAgICBhdHRyQ2hhbmdlOiBhdHRyQ2hhbmdlLFxuICAgICAgICAgICAgY3VycmVudFRhcmdldDogY3VycmVudFRhcmdldCxcbiAgICAgICAgICAgIGF0dHJOYW1lOiBhdHRyTmFtZSxcbiAgICAgICAgICAgIHByZXZWYWx1ZTogcHJldlZhbHVlLFxuICAgICAgICAgICAgbmV3VmFsdWU6IG5ld1ZhbHVlXG4gICAgICAgICAgfTtcbiAgICAgICAgICBlW2FjdGlvbl0gPSBhdHRyQ2hhbmdlO1xuICAgICAgICAgIG9uRE9NQXR0ck1vZGlmaWVkKGUpO1xuICAgICAgICB9O1xuICAgICAgICBnZXRBdHRyaWJ1dGVzTWlycm9yID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICBmb3IgKHZhclxuICAgICAgICAgICAgYXR0ciwgbmFtZSxcbiAgICAgICAgICAgIHJlc3VsdCA9IHt9LFxuICAgICAgICAgICAgYXR0cmlidXRlcyA9IG5vZGUuYXR0cmlidXRlcyxcbiAgICAgICAgICAgIGkgPSAwLCBsZW5ndGggPSBhdHRyaWJ1dGVzLmxlbmd0aDtcbiAgICAgICAgICAgIGkgPCBsZW5ndGg7IGkrK1xuICAgICAgICAgICkge1xuICAgICAgICAgICAgYXR0ciA9IGF0dHJpYnV0ZXNbaV07XG4gICAgICAgICAgICBuYW1lID0gYXR0ci5uYW1lO1xuICAgICAgICAgICAgaWYgKG5hbWUgIT09ICdzZXRBdHRyaWJ1dGUnKSB7XG4gICAgICAgICAgICAgIHJlc3VsdFtuYW1lXSA9IGF0dHIudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICBcbiAgICAvLyBzZXQgYXMgZW51bWVyYWJsZSwgd3JpdGFibGUgYW5kIGNvbmZpZ3VyYWJsZVxuICAgIGRvY3VtZW50W1JFR0lTVEVSX0VMRU1FTlRdID0gZnVuY3Rpb24gcmVnaXN0ZXJFbGVtZW50KHR5cGUsIG9wdGlvbnMpIHtcbiAgICAgIHVwcGVyVHlwZSA9IHR5cGUudG9VcHBlckNhc2UoKTtcbiAgICAgIGlmIChzZXRMaXN0ZW5lcikge1xuICAgICAgICAvLyBvbmx5IGZpcnN0IHRpbWUgZG9jdW1lbnQucmVnaXN0ZXJFbGVtZW50IGlzIHVzZWRcbiAgICAgICAgLy8gd2UgbmVlZCB0byBzZXQgdGhpcyBsaXN0ZW5lclxuICAgICAgICAvLyBzZXR0aW5nIGl0IGJ5IGRlZmF1bHQgbWlnaHQgc2xvdyBkb3duIGZvciBubyByZWFzb25cbiAgICAgICAgc2V0TGlzdGVuZXIgPSBmYWxzZTtcbiAgICAgICAgaWYgKE11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAgICAgICBvYnNlcnZlciA9IChmdW5jdGlvbihhdHRhY2hlZCwgZGV0YWNoZWQpe1xuICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tFbUFsbChsaXN0LCBjYWxsYmFjaykge1xuICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gbGlzdC5sZW5ndGg7IGkgPCBsZW5ndGg7IGNhbGxiYWNrKGxpc3RbaSsrXSkpe31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAocmVjb3Jkcykge1xuICAgICAgICAgICAgICBmb3IgKHZhclxuICAgICAgICAgICAgICAgIGN1cnJlbnQsIG5vZGUsIG5ld1ZhbHVlLFxuICAgICAgICAgICAgICAgIGkgPSAwLCBsZW5ndGggPSByZWNvcmRzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrXG4gICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnQgPSByZWNvcmRzW2ldO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50LnR5cGUgPT09ICdjaGlsZExpc3QnKSB7XG4gICAgICAgICAgICAgICAgICBjaGVja0VtQWxsKGN1cnJlbnQuYWRkZWROb2RlcywgYXR0YWNoZWQpO1xuICAgICAgICAgICAgICAgICAgY2hlY2tFbUFsbChjdXJyZW50LnJlbW92ZWROb2RlcywgZGV0YWNoZWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBub2RlID0gY3VycmVudC50YXJnZXQ7XG4gICAgICAgICAgICAgICAgICBpZiAobm90RnJvbUlubmVySFRNTEhlbHBlciAmJlxuICAgICAgICAgICAgICAgICAgICAgIG5vZGVbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdICYmXG4gICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5hdHRyaWJ1dGVOYW1lICE9PSAnc3R5bGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gZ2V0QXR0cmlidXRlLmNhbGwobm9kZSwgY3VycmVudC5hdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld1ZhbHVlICE9PSBjdXJyZW50Lm9sZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgbm9kZVtBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDS10oXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmF0dHJpYnV0ZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Lm9sZFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KGV4ZWN1dGVBY3Rpb24oQVRUQUNIRUQpLCBleGVjdXRlQWN0aW9uKERFVEFDSEVEKSkpO1xuICAgICAgICAgIG9ic2VydmUgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShcbiAgICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzdWJ0cmVlOiB0cnVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIG9ic2VydmUoZG9jdW1lbnQpO1xuICAgICAgICAgIGlmIChhdHRhY2hTaGFkb3cpIHtcbiAgICAgICAgICAgIEhUTUxFbGVtZW50UHJvdG90eXBlLmF0dGFjaFNoYWRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG9ic2VydmUoYXR0YWNoU2hhZG93LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXNhcFF1ZXVlID0gW107XG4gICAgICAgICAgZG9jdW1lbnRbQUREX0VWRU5UX0xJU1RFTkVSXSgnRE9NTm9kZUluc2VydGVkJywgb25ET01Ob2RlKEFUVEFDSEVEKSk7XG4gICAgICAgICAgZG9jdW1lbnRbQUREX0VWRU5UX0xJU1RFTkVSXSgnRE9NTm9kZVJlbW92ZWQnLCBvbkRPTU5vZGUoREVUQUNIRUQpKTtcbiAgICAgICAgfVxuICBcbiAgICAgICAgZG9jdW1lbnRbQUREX0VWRU5UX0xJU1RFTkVSXShET01fQ09OVEVOVF9MT0FERUQsIG9uUmVhZHlTdGF0ZUNoYW5nZSk7XG4gICAgICAgIGRvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oJ3JlYWR5c3RhdGVjaGFuZ2UnLCBvblJlYWR5U3RhdGVDaGFuZ2UpO1xuICBcbiAgICAgICAgSFRNTEVsZW1lbnRQcm90b3R5cGUuY2xvbmVOb2RlID0gZnVuY3Rpb24gKGRlZXApIHtcbiAgICAgICAgICB2YXJcbiAgICAgICAgICAgIG5vZGUgPSBjbG9uZU5vZGUuY2FsbCh0aGlzLCAhIWRlZXApLFxuICAgICAgICAgICAgaSA9IGdldFR5cGVJbmRleChub2RlKVxuICAgICAgICAgIDtcbiAgICAgICAgICBpZiAoLTEgPCBpKSBwYXRjaChub2RlLCBwcm90b3NbaV0pO1xuICAgICAgICAgIGlmIChkZWVwICYmIHF1ZXJ5Lmxlbmd0aCkgbG9vcEFuZFNldHVwKG5vZGUucXVlcnlTZWxlY3RvckFsbChxdWVyeSkpO1xuICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICB9O1xuICAgICAgfVxuICBcbiAgICAgIGlmIChqdXN0U2V0dXApIHJldHVybiAoanVzdFNldHVwID0gZmFsc2UpO1xuICBcbiAgICAgIGlmICgtMiA8IChcbiAgICAgICAgaW5kZXhPZi5jYWxsKHR5cGVzLCBQUkVGSVhfSVMgKyB1cHBlclR5cGUpICtcbiAgICAgICAgaW5kZXhPZi5jYWxsKHR5cGVzLCBQUkVGSVhfVEFHICsgdXBwZXJUeXBlKVxuICAgICAgKSkge1xuICAgICAgICB0aHJvd1R5cGVFcnJvcih0eXBlKTtcbiAgICAgIH1cbiAgXG4gICAgICBpZiAoIXZhbGlkTmFtZS50ZXN0KHVwcGVyVHlwZSkgfHwgLTEgPCBpbmRleE9mLmNhbGwoaW52YWxpZE5hbWVzLCB1cHBlclR5cGUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHR5cGUgJyArIHR5cGUgKyAnIGlzIGludmFsaWQnKTtcbiAgICAgIH1cbiAgXG4gICAgICB2YXJcbiAgICAgICAgY29uc3RydWN0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIGV4dGVuZGluZyA/XG4gICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGVOYW1lLCB1cHBlclR5cGUpIDpcbiAgICAgICAgICAgIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobm9kZU5hbWUpO1xuICAgICAgICB9LFxuICAgICAgICBvcHQgPSBvcHRpb25zIHx8IE9QLFxuICAgICAgICBleHRlbmRpbmcgPSBoT1AuY2FsbChvcHQsIEVYVEVORFMpLFxuICAgICAgICBub2RlTmFtZSA9IGV4dGVuZGluZyA/IG9wdGlvbnNbRVhURU5EU10udG9VcHBlckNhc2UoKSA6IHVwcGVyVHlwZSxcbiAgICAgICAgdXBwZXJUeXBlLFxuICAgICAgICBpXG4gICAgICA7XG4gIFxuICAgICAgaWYgKGV4dGVuZGluZyAmJiAtMSA8IChcbiAgICAgICAgaW5kZXhPZi5jYWxsKHR5cGVzLCBQUkVGSVhfVEFHICsgbm9kZU5hbWUpXG4gICAgICApKSB7XG4gICAgICAgIHRocm93VHlwZUVycm9yKG5vZGVOYW1lKTtcbiAgICAgIH1cbiAgXG4gICAgICBpID0gdHlwZXMucHVzaCgoZXh0ZW5kaW5nID8gUFJFRklYX0lTIDogUFJFRklYX1RBRykgKyB1cHBlclR5cGUpIC0gMTtcbiAgXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmNvbmNhdChcbiAgICAgICAgcXVlcnkubGVuZ3RoID8gJywnIDogJycsXG4gICAgICAgIGV4dGVuZGluZyA/IG5vZGVOYW1lICsgJ1tpcz1cIicgKyB0eXBlLnRvTG93ZXJDYXNlKCkgKyAnXCJdJyA6IG5vZGVOYW1lXG4gICAgICApO1xuICBcbiAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZSA9IChcbiAgICAgICAgcHJvdG9zW2ldID0gaE9QLmNhbGwob3B0LCAncHJvdG90eXBlJykgP1xuICAgICAgICAgIG9wdC5wcm90b3R5cGUgOlxuICAgICAgICAgIGNyZWF0ZShIVE1MRWxlbWVudFByb3RvdHlwZSlcbiAgICAgICk7XG4gIFxuICAgICAgaWYgKHF1ZXJ5Lmxlbmd0aCkgbG9vcEFuZFZlcmlmeShcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChxdWVyeSksXG4gICAgICAgIEFUVEFDSEVEXG4gICAgICApO1xuICBcbiAgICAgIHJldHVybiBjb25zdHJ1Y3RvcjtcbiAgICB9O1xuICBcbiAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50ID0gKHBhdGNoZWRDcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24gKGxvY2FsTmFtZSwgdHlwZUV4dGVuc2lvbikge1xuICAgICAgdmFyXG4gICAgICAgIGlzID0gZ2V0SXModHlwZUV4dGVuc2lvbiksXG4gICAgICAgIG5vZGUgPSBpcyA/XG4gICAgICAgICAgY3JlYXRlRWxlbWVudC5jYWxsKGRvY3VtZW50LCBsb2NhbE5hbWUsIHNlY29uZEFyZ3VtZW50KGlzKSkgOlxuICAgICAgICAgIGNyZWF0ZUVsZW1lbnQuY2FsbChkb2N1bWVudCwgbG9jYWxOYW1lKSxcbiAgICAgICAgbmFtZSA9ICcnICsgbG9jYWxOYW1lLFxuICAgICAgICBpID0gaW5kZXhPZi5jYWxsKFxuICAgICAgICAgIHR5cGVzLFxuICAgICAgICAgIChpcyA/IFBSRUZJWF9JUyA6IFBSRUZJWF9UQUcpICtcbiAgICAgICAgICAoaXMgfHwgbmFtZSkudG9VcHBlckNhc2UoKVxuICAgICAgICApLFxuICAgICAgICBzZXR1cCA9IC0xIDwgaVxuICAgICAgO1xuICAgICAgaWYgKGlzKSB7XG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdpcycsIGlzID0gaXMudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgIGlmIChzZXR1cCkge1xuICAgICAgICAgIHNldHVwID0gaXNJblFTQShuYW1lLnRvVXBwZXJDYXNlKCksIGlzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbm90RnJvbUlubmVySFRNTEhlbHBlciA9ICFkb2N1bWVudC5jcmVhdGVFbGVtZW50LmlubmVySFRNTEhlbHBlcjtcbiAgICAgIGlmIChzZXR1cCkgcGF0Y2gobm9kZSwgcHJvdG9zW2ldKTtcbiAgICAgIHJldHVybiBub2RlO1xuICAgIH0pO1xuICBcbiAgfVxuICBcbiAgZnVuY3Rpb24gQVNBUCgpIHtcbiAgICB2YXIgcXVldWUgPSBhc2FwUXVldWUuc3BsaWNlKDAsIGFzYXBRdWV1ZS5sZW5ndGgpO1xuICAgIGFzYXBUaW1lciA9IDA7XG4gICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCkge1xuICAgICAgcXVldWUuc2hpZnQoKS5jYWxsKFxuICAgICAgICBudWxsLCBxdWV1ZS5zaGlmdCgpXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gbG9vcEFuZFZlcmlmeShsaXN0LCBhY3Rpb24pIHtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gbGlzdC5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmVyaWZ5QW5kU2V0dXBBbmRBY3Rpb24obGlzdFtpXSwgYWN0aW9uKTtcbiAgICB9XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGxvb3BBbmRTZXR1cChsaXN0KSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGxpc3QubGVuZ3RoLCBub2RlOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIG5vZGUgPSBsaXN0W2ldO1xuICAgICAgcGF0Y2gobm9kZSwgcHJvdG9zW2dldFR5cGVJbmRleChub2RlKV0pO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gZXhlY3V0ZUFjdGlvbihhY3Rpb24pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgIGlmIChpc1ZhbGlkTm9kZShub2RlKSkge1xuICAgICAgICB2ZXJpZnlBbmRTZXR1cEFuZEFjdGlvbihub2RlLCBhY3Rpb24pO1xuICAgICAgICBpZiAocXVlcnkubGVuZ3RoKSBsb29wQW5kVmVyaWZ5KFxuICAgICAgICAgIG5vZGUucXVlcnlTZWxlY3RvckFsbChxdWVyeSksXG4gICAgICAgICAgYWN0aW9uXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gZ2V0VHlwZUluZGV4KHRhcmdldCkge1xuICAgIHZhclxuICAgICAgaXMgPSBnZXRBdHRyaWJ1dGUuY2FsbCh0YXJnZXQsICdpcycpLFxuICAgICAgbm9kZU5hbWUgPSB0YXJnZXQubm9kZU5hbWUudG9VcHBlckNhc2UoKSxcbiAgICAgIGkgPSBpbmRleE9mLmNhbGwoXG4gICAgICAgIHR5cGVzLFxuICAgICAgICBpcyA/XG4gICAgICAgICAgICBQUkVGSVhfSVMgKyBpcy50b1VwcGVyQ2FzZSgpIDpcbiAgICAgICAgICAgIFBSRUZJWF9UQUcgKyBub2RlTmFtZVxuICAgICAgKVxuICAgIDtcbiAgICByZXR1cm4gaXMgJiYgLTEgPCBpICYmICFpc0luUVNBKG5vZGVOYW1lLCBpcykgPyAtMSA6IGk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGlzSW5RU0EobmFtZSwgdHlwZSkge1xuICAgIHJldHVybiAtMSA8IHF1ZXJ5LmluZGV4T2YobmFtZSArICdbaXM9XCInICsgdHlwZSArICdcIl0nKTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gb25ET01BdHRyTW9kaWZpZWQoZSkge1xuICAgIHZhclxuICAgICAgbm9kZSA9IGUuY3VycmVudFRhcmdldCxcbiAgICAgIGF0dHJDaGFuZ2UgPSBlLmF0dHJDaGFuZ2UsXG4gICAgICBhdHRyTmFtZSA9IGUuYXR0ck5hbWUsXG4gICAgICB0YXJnZXQgPSBlLnRhcmdldCxcbiAgICAgIGFkZGl0aW9uID0gZVtBRERJVElPTl0gfHwgMixcbiAgICAgIHJlbW92YWwgPSBlW1JFTU9WQUxdIHx8IDNcbiAgICA7XG4gICAgaWYgKG5vdEZyb21Jbm5lckhUTUxIZWxwZXIgJiZcbiAgICAgICAgKCF0YXJnZXQgfHwgdGFyZ2V0ID09PSBub2RlKSAmJlxuICAgICAgICBub2RlW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXSAmJlxuICAgICAgICBhdHRyTmFtZSAhPT0gJ3N0eWxlJyAmJiAoXG4gICAgICAgICAgZS5wcmV2VmFsdWUgIT09IGUubmV3VmFsdWUgfHxcbiAgICAgICAgICAvLyBJRTksIElFMTAsIGFuZCBPcGVyYSAxMiBnb3RjaGFcbiAgICAgICAgICBlLm5ld1ZhbHVlID09PSAnJyAmJiAoXG4gICAgICAgICAgICBhdHRyQ2hhbmdlID09PSBhZGRpdGlvbiB8fFxuICAgICAgICAgICAgYXR0ckNoYW5nZSA9PT0gcmVtb3ZhbFxuICAgICAgICAgIClcbiAgICApKSB7XG4gICAgICBub2RlW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXShcbiAgICAgICAgYXR0ck5hbWUsXG4gICAgICAgIGF0dHJDaGFuZ2UgPT09IGFkZGl0aW9uID8gbnVsbCA6IGUucHJldlZhbHVlLFxuICAgICAgICBhdHRyQ2hhbmdlID09PSByZW1vdmFsID8gbnVsbCA6IGUubmV3VmFsdWVcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiBvbkRPTU5vZGUoYWN0aW9uKSB7XG4gICAgdmFyIGV4ZWN1dG9yID0gZXhlY3V0ZUFjdGlvbihhY3Rpb24pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xuICAgICAgYXNhcFF1ZXVlLnB1c2goZXhlY3V0b3IsIGUudGFyZ2V0KTtcbiAgICAgIGlmIChhc2FwVGltZXIpIGNsZWFyVGltZW91dChhc2FwVGltZXIpO1xuICAgICAgYXNhcFRpbWVyID0gc2V0VGltZW91dChBU0FQLCAxKTtcbiAgICB9O1xuICB9XG4gIFxuICBmdW5jdGlvbiBvblJlYWR5U3RhdGVDaGFuZ2UoZSkge1xuICAgIGlmIChkcm9wRG9tQ29udGVudExvYWRlZCkge1xuICAgICAgZHJvcERvbUNvbnRlbnRMb2FkZWQgPSBmYWxzZTtcbiAgICAgIGUuY3VycmVudFRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKERPTV9DT05URU5UX0xPQURFRCwgb25SZWFkeVN0YXRlQ2hhbmdlKTtcbiAgICB9XG4gICAgaWYgKHF1ZXJ5Lmxlbmd0aCkgbG9vcEFuZFZlcmlmeShcbiAgICAgIChlLnRhcmdldCB8fCBkb2N1bWVudCkucXVlcnlTZWxlY3RvckFsbChxdWVyeSksXG4gICAgICBlLmRldGFpbCA9PT0gREVUQUNIRUQgPyBERVRBQ0hFRCA6IEFUVEFDSEVEXG4gICAgKTtcbiAgICBpZiAoSUU4KSBwdXJnZSgpO1xuICB9XG4gIFxuICBmdW5jdGlvbiBwYXRjaGVkU2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7XG4gICAgLy8ganNoaW50IHZhbGlkdGhpczp0cnVlXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNldEF0dHJpYnV0ZS5jYWxsKHNlbGYsIG5hbWUsIHZhbHVlKTtcbiAgICBvblN1YnRyZWVNb2RpZmllZC5jYWxsKHNlbGYsIHt0YXJnZXQ6IHNlbGZ9KTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gc2V0dXBOb2RlKG5vZGUsIHByb3RvKSB7XG4gICAgc2V0UHJvdG90eXBlKG5vZGUsIHByb3RvKTtcbiAgICBpZiAob2JzZXJ2ZXIpIHtcbiAgICAgIG9ic2VydmVyLm9ic2VydmUobm9kZSwgYXR0cmlidXRlc09ic2VydmVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGRvZXNOb3RTdXBwb3J0RE9NQXR0ck1vZGlmaWVkKSB7XG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlID0gcGF0Y2hlZFNldEF0dHJpYnV0ZTtcbiAgICAgICAgbm9kZVtFWFBBTkRPX1VJRF0gPSBnZXRBdHRyaWJ1dGVzTWlycm9yKG5vZGUpO1xuICAgICAgICBub2RlW0FERF9FVkVOVF9MSVNURU5FUl0oRE9NX1NVQlRSRUVfTU9ESUZJRUQsIG9uU3VidHJlZU1vZGlmaWVkKTtcbiAgICAgIH1cbiAgICAgIG5vZGVbQUREX0VWRU5UX0xJU1RFTkVSXShET01fQVRUUl9NT0RJRklFRCwgb25ET01BdHRyTW9kaWZpZWQpO1xuICAgIH1cbiAgICBpZiAobm9kZVtDUkVBVEVEX0NBTExCQUNLXSAmJiBub3RGcm9tSW5uZXJIVE1MSGVscGVyKSB7XG4gICAgICBub2RlLmNyZWF0ZWQgPSB0cnVlO1xuICAgICAgbm9kZVtDUkVBVEVEX0NBTExCQUNLXSgpO1xuICAgICAgbm9kZS5jcmVhdGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiBwdXJnZSgpIHtcbiAgICBmb3IgKHZhclxuICAgICAgbm9kZSxcbiAgICAgIGkgPSAwLFxuICAgICAgbGVuZ3RoID0gdGFyZ2V0cy5sZW5ndGg7XG4gICAgICBpIDwgbGVuZ3RoOyBpKytcbiAgICApIHtcbiAgICAgIG5vZGUgPSB0YXJnZXRzW2ldO1xuICAgICAgaWYgKCFkb2N1bWVudEVsZW1lbnQuY29udGFpbnMobm9kZSkpIHtcbiAgICAgICAgbGVuZ3RoLS07XG4gICAgICAgIHRhcmdldHMuc3BsaWNlKGktLSwgMSk7XG4gICAgICAgIHZlcmlmeUFuZFNldHVwQW5kQWN0aW9uKG5vZGUsIERFVEFDSEVEKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHRocm93VHlwZUVycm9yKHR5cGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgJyArIHR5cGUgKyAnIHR5cGUgaXMgYWxyZWFkeSByZWdpc3RlcmVkJyk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHZlcmlmeUFuZFNldHVwQW5kQWN0aW9uKG5vZGUsIGFjdGlvbikge1xuICAgIHZhclxuICAgICAgZm4sXG4gICAgICBpID0gZ2V0VHlwZUluZGV4KG5vZGUpXG4gICAgO1xuICAgIGlmICgtMSA8IGkpIHtcbiAgICAgIHBhdGNoSWZOb3RBbHJlYWR5KG5vZGUsIHByb3Rvc1tpXSk7XG4gICAgICBpID0gMDtcbiAgICAgIGlmIChhY3Rpb24gPT09IEFUVEFDSEVEICYmICFub2RlW0FUVEFDSEVEXSkge1xuICAgICAgICBub2RlW0RFVEFDSEVEXSA9IGZhbHNlO1xuICAgICAgICBub2RlW0FUVEFDSEVEXSA9IHRydWU7XG4gICAgICAgIGkgPSAxO1xuICAgICAgICBpZiAoSUU4ICYmIGluZGV4T2YuY2FsbCh0YXJnZXRzLCBub2RlKSA8IDApIHtcbiAgICAgICAgICB0YXJnZXRzLnB1c2gobm9kZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSBERVRBQ0hFRCAmJiAhbm9kZVtERVRBQ0hFRF0pIHtcbiAgICAgICAgbm9kZVtBVFRBQ0hFRF0gPSBmYWxzZTtcbiAgICAgICAgbm9kZVtERVRBQ0hFRF0gPSB0cnVlO1xuICAgICAgICBpID0gMTtcbiAgICAgIH1cbiAgICAgIGlmIChpICYmIChmbiA9IG5vZGVbYWN0aW9uICsgQ0FMTEJBQ0tdKSkgZm4uY2FsbChub2RlKTtcbiAgICB9XG4gIH1cbiAgXG4gIFxuICBcbiAgLy8gVjEgaW4gZGEgSG91c2UhXG4gIGZ1bmN0aW9uIEN1c3RvbUVsZW1lbnRSZWdpc3RyeSgpIHt9XG4gIFxuICBDdXN0b21FbGVtZW50UmVnaXN0cnkucHJvdG90eXBlID0ge1xuICAgIGNvbnN0cnVjdG9yOiBDdXN0b21FbGVtZW50UmVnaXN0cnksXG4gICAgLy8gYSB3b3JrYXJvdW5kIGZvciB0aGUgc3R1YmJvcm4gV2ViS2l0XG4gICAgZGVmaW5lOiB1c2FibGVDdXN0b21FbGVtZW50cyA/XG4gICAgICBmdW5jdGlvbiAobmFtZSwgQ2xhc3MsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgICAgICBDRVJEZWZpbmUobmFtZSwgQ2xhc3MsIG9wdGlvbnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBOQU1FID0gbmFtZS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgIGNvbnN0cnVjdG9yc1tOQU1FXSA9IHtcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yOiBDbGFzcyxcbiAgICAgICAgICAgIGNyZWF0ZTogW05BTUVdXG4gICAgICAgICAgfTtcbiAgICAgICAgICBub2RlTmFtZXMuc2V0KENsYXNzLCBOQU1FKTtcbiAgICAgICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUobmFtZSwgQ2xhc3MpO1xuICAgICAgICB9XG4gICAgICB9IDpcbiAgICAgIENFUkRlZmluZSxcbiAgICBnZXQ6IHVzYWJsZUN1c3RvbUVsZW1lbnRzID9cbiAgICAgIGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiBjdXN0b21FbGVtZW50cy5nZXQobmFtZSkgfHwgZ2V0KG5hbWUpO1xuICAgICAgfSA6XG4gICAgICBnZXQsXG4gICAgd2hlbkRlZmluZWQ6IHVzYWJsZUN1c3RvbUVsZW1lbnRzID9cbiAgICAgIGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJhY2UoW1xuICAgICAgICAgIGN1c3RvbUVsZW1lbnRzLndoZW5EZWZpbmVkKG5hbWUpLFxuICAgICAgICAgIHdoZW5EZWZpbmVkKG5hbWUpXG4gICAgICAgIF0pO1xuICAgICAgfSA6XG4gICAgICB3aGVuRGVmaW5lZFxuICB9O1xuICBcbiAgZnVuY3Rpb24gQ0VSRGVmaW5lKG5hbWUsIENsYXNzLCBvcHRpb25zKSB7XG4gICAgdmFyXG4gICAgICBpcyA9IG9wdGlvbnMgJiYgb3B0aW9uc1tFWFRFTkRTXSB8fCAnJyxcbiAgICAgIENQcm90byA9IENsYXNzLnByb3RvdHlwZSxcbiAgICAgIHByb3RvID0gY3JlYXRlKENQcm90byksXG4gICAgICBhdHRyaWJ1dGVzID0gQ2xhc3Mub2JzZXJ2ZWRBdHRyaWJ1dGVzIHx8IGVtcHR5LFxuICAgICAgZGVmaW5pdGlvbiA9IHtwcm90b3R5cGU6IHByb3RvfVxuICAgIDtcbiAgICAvLyBUT0RPOiBpcyB0aGlzIG5lZWRlZCBhdCBhbGwgc2luY2UgaXQncyBpbmhlcml0ZWQ/XG4gICAgLy8gZGVmaW5lUHJvcGVydHkocHJvdG8sICdjb25zdHJ1Y3RvcicsIHt2YWx1ZTogQ2xhc3N9KTtcbiAgICBzYWZlUHJvcGVydHkocHJvdG8sIENSRUFURURfQ0FMTEJBQ0ssIHtcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoanVzdENyZWF0ZWQpIGp1c3RDcmVhdGVkID0gZmFsc2U7XG4gICAgICAgICAgZWxzZSBpZiAoIXRoaXNbRFJFQ0VWMV0pIHtcbiAgICAgICAgICAgIHRoaXNbRFJFQ0VWMV0gPSB0cnVlO1xuICAgICAgICAgICAgbmV3IENsYXNzKHRoaXMpO1xuICAgICAgICAgICAgaWYgKENQcm90b1tDUkVBVEVEX0NBTExCQUNLXSlcbiAgICAgICAgICAgICAgQ1Byb3RvW0NSRUFURURfQ0FMTEJBQ0tdLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB2YXIgaW5mbyA9IGNvbnN0cnVjdG9yc1tub2RlTmFtZXMuZ2V0KENsYXNzKV07XG4gICAgICAgICAgICBpZiAoIXVzYWJsZUN1c3RvbUVsZW1lbnRzIHx8IGluZm8uY3JlYXRlLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgbm90aWZ5QXR0cmlidXRlcyh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgc2FmZVByb3BlcnR5KHByb3RvLCBBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDSywge1xuICAgICAgdmFsdWU6IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIGlmICgtMSA8IGluZGV4T2YuY2FsbChhdHRyaWJ1dGVzLCBuYW1lKSlcbiAgICAgICAgICBDUHJvdG9bQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKENQcm90b1tDT05ORUNURURfQ0FMTEJBQ0tdKSB7XG4gICAgICBzYWZlUHJvcGVydHkocHJvdG8sIEFUVEFDSEVEX0NBTExCQUNLLCB7XG4gICAgICAgIHZhbHVlOiBDUHJvdG9bQ09OTkVDVEVEX0NBTExCQUNLXVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChDUHJvdG9bRElTQ09OTkVDVEVEX0NBTExCQUNLXSkge1xuICAgICAgc2FmZVByb3BlcnR5KHByb3RvLCBERVRBQ0hFRF9DQUxMQkFDSywge1xuICAgICAgICB2YWx1ZTogQ1Byb3RvW0RJU0NPTk5FQ1RFRF9DQUxMQkFDS11cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoaXMpIGRlZmluaXRpb25bRVhURU5EU10gPSBpcztcbiAgICBuYW1lID0gbmFtZS50b1VwcGVyQ2FzZSgpO1xuICAgIGNvbnN0cnVjdG9yc1tuYW1lXSA9IHtcbiAgICAgIGNvbnN0cnVjdG9yOiBDbGFzcyxcbiAgICAgIGNyZWF0ZTogaXMgPyBbaXMsIHNlY29uZEFyZ3VtZW50KG5hbWUpXSA6IFtuYW1lXVxuICAgIH07XG4gICAgbm9kZU5hbWVzLnNldChDbGFzcywgbmFtZSk7XG4gICAgZG9jdW1lbnRbUkVHSVNURVJfRUxFTUVOVF0obmFtZS50b0xvd2VyQ2FzZSgpLCBkZWZpbml0aW9uKTtcbiAgICB3aGVuRGVmaW5lZChuYW1lKTtcbiAgICB3YWl0aW5nTGlzdFtuYW1lXS5yKCk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGdldChuYW1lKSB7XG4gICAgdmFyIGluZm8gPSBjb25zdHJ1Y3RvcnNbbmFtZS50b1VwcGVyQ2FzZSgpXTtcbiAgICByZXR1cm4gaW5mbyAmJiBpbmZvLmNvbnN0cnVjdG9yO1xuICB9XG4gIFxuICBmdW5jdGlvbiBnZXRJcyhvcHRpb25zKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBvcHRpb25zID09PSAnc3RyaW5nJyA/XG4gICAgICAgIG9wdGlvbnMgOiAob3B0aW9ucyAmJiBvcHRpb25zLmlzIHx8ICcnKTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gbm90aWZ5QXR0cmlidXRlcyhzZWxmKSB7XG4gICAgdmFyXG4gICAgICBjYWxsYmFjayA9IHNlbGZbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdLFxuICAgICAgYXR0cmlidXRlcyA9IGNhbGxiYWNrID8gc2VsZi5hdHRyaWJ1dGVzIDogZW1wdHksXG4gICAgICBpID0gYXR0cmlidXRlcy5sZW5ndGgsXG4gICAgICBhdHRyaWJ1dGVcbiAgICA7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgYXR0cmlidXRlID0gIGF0dHJpYnV0ZXNbaV07IC8vIHx8IGF0dHJpYnV0ZXMuaXRlbShpKTtcbiAgICAgIGNhbGxiYWNrLmNhbGwoXG4gICAgICAgIHNlbGYsXG4gICAgICAgIGF0dHJpYnV0ZS5uYW1lIHx8IGF0dHJpYnV0ZS5ub2RlTmFtZSxcbiAgICAgICAgbnVsbCxcbiAgICAgICAgYXR0cmlidXRlLnZhbHVlIHx8IGF0dHJpYnV0ZS5ub2RlVmFsdWVcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiB3aGVuRGVmaW5lZChuYW1lKSB7XG4gICAgbmFtZSA9IG5hbWUudG9VcHBlckNhc2UoKTtcbiAgICBpZiAoIShuYW1lIGluIHdhaXRpbmdMaXN0KSkge1xuICAgICAgd2FpdGluZ0xpc3RbbmFtZV0gPSB7fTtcbiAgICAgIHdhaXRpbmdMaXN0W25hbWVdLnAgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICB3YWl0aW5nTGlzdFtuYW1lXS5yID0gcmVzb2x2ZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gd2FpdGluZ0xpc3RbbmFtZV0ucDtcbiAgfVxuICBcbiAgZnVuY3Rpb24gcG9seWZpbGxWMSgpIHtcbiAgICBpZiAoY3VzdG9tRWxlbWVudHMpIGRlbGV0ZSB3aW5kb3cuY3VzdG9tRWxlbWVudHM7XG4gICAgZGVmaW5lUHJvcGVydHkod2luZG93LCAnY3VzdG9tRWxlbWVudHMnLCB7XG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogbmV3IEN1c3RvbUVsZW1lbnRSZWdpc3RyeSgpXG4gICAgfSk7XG4gICAgZGVmaW5lUHJvcGVydHkod2luZG93LCAnQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5Jywge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IEN1c3RvbUVsZW1lbnRSZWdpc3RyeVxuICAgIH0pO1xuICAgIGZvciAodmFyXG4gICAgICBwYXRjaENsYXNzID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIENsYXNzID0gd2luZG93W25hbWVdO1xuICAgICAgICBpZiAoQ2xhc3MpIHtcbiAgICAgICAgICB3aW5kb3dbbmFtZV0gPSBmdW5jdGlvbiBDdXN0b21FbGVtZW50c1YxKHNlbGYpIHtcbiAgICAgICAgICAgIHZhciBpbmZvLCBpc05hdGl2ZTtcbiAgICAgICAgICAgIGlmICghc2VsZikgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICBpZiAoIXNlbGZbRFJFQ0VWMV0pIHtcbiAgICAgICAgICAgICAganVzdENyZWF0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICBpbmZvID0gY29uc3RydWN0b3JzW25vZGVOYW1lcy5nZXQoc2VsZi5jb25zdHJ1Y3RvcildO1xuICAgICAgICAgICAgICBpc05hdGl2ZSA9IHVzYWJsZUN1c3RvbUVsZW1lbnRzICYmIGluZm8uY3JlYXRlLmxlbmd0aCA9PT0gMTtcbiAgICAgICAgICAgICAgc2VsZiA9IGlzTmF0aXZlID9cbiAgICAgICAgICAgICAgICBSZWZsZWN0LmNvbnN0cnVjdChDbGFzcywgZW1wdHksIGluZm8uY29uc3RydWN0b3IpIDpcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50LmFwcGx5KGRvY3VtZW50LCBpbmZvLmNyZWF0ZSk7XG4gICAgICAgICAgICAgIHNlbGZbRFJFQ0VWMV0gPSB0cnVlO1xuICAgICAgICAgICAgICBqdXN0Q3JlYXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICBpZiAoIWlzTmF0aXZlKSBub3RpZnlBdHRyaWJ1dGVzKHNlbGYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHNlbGY7XG4gICAgICAgICAgfTtcbiAgICAgICAgICB3aW5kb3dbbmFtZV0ucHJvdG90eXBlID0gQ2xhc3MucHJvdG90eXBlO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSB3aW5kb3dbbmFtZV07XG4gICAgICAgICAgfSBjYXRjaChXZWJLaXQpIHtcbiAgICAgICAgICAgIGZpeEdldENsYXNzID0gdHJ1ZTtcbiAgICAgICAgICAgIGRlZmluZVByb3BlcnR5KENsYXNzLCBEUkVDRVYxLCB7dmFsdWU6IHdpbmRvd1tuYW1lXX0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIENsYXNzZXMgPSBodG1sQ2xhc3MuZ2V0KC9eSFRNTFtBLVpdKlthLXpdLyksXG4gICAgICBpID0gQ2xhc3Nlcy5sZW5ndGg7XG4gICAgICBpLS07XG4gICAgICBwYXRjaENsYXNzKENsYXNzZXNbaV0pXG4gICAgKSB7fVxuICAgIChkb2N1bWVudC5jcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24gKG5hbWUsIG9wdGlvbnMpIHtcbiAgICAgIHZhciBpcyA9IGdldElzKG9wdGlvbnMpO1xuICAgICAgcmV0dXJuIGlzID9cbiAgICAgICAgcGF0Y2hlZENyZWF0ZUVsZW1lbnQuY2FsbCh0aGlzLCBuYW1lLCBzZWNvbmRBcmd1bWVudChpcykpIDpcbiAgICAgICAgcGF0Y2hlZENyZWF0ZUVsZW1lbnQuY2FsbCh0aGlzLCBuYW1lKTtcbiAgICB9KTtcbiAgICBpZiAoIVYwKSB7XG4gICAgICBqdXN0U2V0dXAgPSB0cnVlO1xuICAgICAgZG9jdW1lbnRbUkVHSVNURVJfRUxFTUVOVF0oJycpO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gaWYgY3VzdG9tRWxlbWVudHMgaXMgbm90IHRoZXJlIGF0IGFsbFxuICBpZiAoIWN1c3RvbUVsZW1lbnRzIHx8IHBvbHlmaWxsID09PSAnZm9yY2UnKSBwb2x5ZmlsbFYxKCk7XG4gIGVsc2Uge1xuICAgIC8vIGlmIGF2YWlsYWJsZSB0ZXN0IGV4dGVuZHMgd29yayBhcyBleHBlY3RlZFxuICAgIHRyeSB7XG4gICAgICAoZnVuY3Rpb24gKERSRSwgb3B0aW9ucywgbmFtZSkge1xuICAgICAgICBvcHRpb25zW0VYVEVORFNdID0gJ2EnO1xuICAgICAgICBEUkUucHJvdG90eXBlID0gY3JlYXRlKEhUTUxBbmNob3JFbGVtZW50LnByb3RvdHlwZSk7XG4gICAgICAgIERSRS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBEUkU7XG4gICAgICAgIHdpbmRvdy5jdXN0b21FbGVtZW50cy5kZWZpbmUobmFtZSwgRFJFLCBvcHRpb25zKTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGdldEF0dHJpYnV0ZS5jYWxsKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnLCB7aXM6IG5hbWV9KSwgJ2lzJykgIT09IG5hbWUgfHxcbiAgICAgICAgICAodXNhYmxlQ3VzdG9tRWxlbWVudHMgJiYgZ2V0QXR0cmlidXRlLmNhbGwobmV3IERSRSgpLCAnaXMnKSAhPT0gbmFtZSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgdGhyb3cgb3B0aW9ucztcbiAgICAgICAgfVxuICAgICAgfShcbiAgICAgICAgZnVuY3Rpb24gRFJFKCkge1xuICAgICAgICAgIHJldHVybiBSZWZsZWN0LmNvbnN0cnVjdChIVE1MQW5jaG9yRWxlbWVudCwgW10sIERSRSk7XG4gICAgICAgIH0sXG4gICAgICAgIHt9LFxuICAgICAgICAnZG9jdW1lbnQtcmVnaXN0ZXItZWxlbWVudC1hJ1xuICAgICAgKSk7XG4gICAgfSBjYXRjaChvX08pIHtcbiAgICAgIC8vIG9yIGZvcmNlIHRoZSBwb2x5ZmlsbCBpZiBub3RcbiAgICAgIC8vIGFuZCBrZWVwIGludGVybmFsIG9yaWdpbmFsIHJlZmVyZW5jZVxuICAgICAgcG9seWZpbGxWMSgpO1xuICAgIH1cbiAgfVxuICBcbiAgdHJ5IHtcbiAgICBjcmVhdGVFbGVtZW50LmNhbGwoZG9jdW1lbnQsICdhJywgJ2EnKTtcbiAgfSBjYXRjaChGaXJlRm94KSB7XG4gICAgc2Vjb25kQXJndW1lbnQgPSBmdW5jdGlvbiAoaXMpIHtcbiAgICAgIHJldHVybiB7aXM6IGlzLnRvTG93ZXJDYXNlKCl9O1xuICAgIH07XG4gIH1cbiAgXG59XG5cbmV4cG9ydHMuaW5zdGFsbEN1c3RvbUVsZW1lbnRzID0gaW5zdGFsbEN1c3RvbUVsZW1lbnRzO1xuXG4iLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQ29uc3RydWN0cyBhIEVTNi9Qcm9taXNlcyBBKyBQcm9taXNlIGluc3RhbmNlLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICogQHBhcmFtIHtmdW5jdGlvbihmdW5jdGlvbigqPSksIGZ1bmN0aW9uICgqPSkpfSByZXNvbHZlclxuICovXG5mdW5jdGlvbiBQcm9taXNlKHJlc29sdmVyKSB7XG4gIGlmICghKHRoaXMgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0NvbnN0cnVjdG9yIFByb21pc2UgcmVxdWlyZXMgYG5ld2AnKTtcbiAgfVxuICBpZiAoIWlzRnVuY3Rpb24ocmVzb2x2ZXIpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignTXVzdCBwYXNzIHJlc29sdmVyIGZ1bmN0aW9uJyk7XG4gIH1cblxuICAvKipcbiAgICogQHR5cGUge2Z1bmN0aW9uKHRoaXM6UHJvbWlzZSwqPSxmdW5jdGlvbigqPSksZnVuY3Rpb24oKj0pLERlZmVycmVkKTohUHJvbWlzZX1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHRoaXMuX3N0YXRlID0gUGVuZGluZ1Byb21pc2U7XG5cbiAgLyoqXG4gICAqIEB0eXBlIHsqfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGhpcy5fdmFsdWUgPSBbXTtcblxuICAvKipcbiAgICogQHR5cGUge2Jvb2xlYW59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB0aGlzLl9pc0NoYWluRW5kID0gdHJ1ZTtcblxuICBkb1Jlc29sdmUoXG4gICAgdGhpcyxcbiAgICBhZG9wdGVyKHRoaXMsIEZ1bGZpbGxlZFByb21pc2UpLFxuICAgIGFkb3B0ZXIodGhpcywgUmVqZWN0ZWRQcm9taXNlKSxcbiAgICB7IHRoZW46IHJlc29sdmVyIH1cbiAgKTtcbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgUHVibGljIEluc3RhbmNlIE1ldGhvZHNcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgcHJvbWlzZSBpbnN0YW5jZSB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgcmVzdWx0IG9mIHRoaXMgcHJvbWlzZVxuICogYXMgaW5wdXRzIHRvIHRoZSBvbkZ1bGZpbGxlZCBvciBvblJlamVjdGVkIGNhbGxiYWNrcy5cbiAqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCopfSBvbkZ1bGZpbGxlZFxuICogQHBhcmFtIHtmdW5jdGlvbigqKX0gb25SZWplY3RlZFxuICovXG5Qcm9taXNlLnByb3RvdHlwZS50aGVuID0gZnVuY3Rpb24ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcbiAgb25GdWxmaWxsZWQgPSBpc0Z1bmN0aW9uKG9uRnVsZmlsbGVkKSA/IG9uRnVsZmlsbGVkIDogdm9pZCAwO1xuICBvblJlamVjdGVkID0gaXNGdW5jdGlvbihvblJlamVjdGVkKSA/IG9uUmVqZWN0ZWQgOiB2b2lkIDA7XG5cbiAgaWYgKG9uRnVsZmlsbGVkIHx8IG9uUmVqZWN0ZWQpIHtcbiAgICB0aGlzLl9pc0NoYWluRW5kID0gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gdGhpcy5fc3RhdGUoXG4gICAgdGhpcy5fdmFsdWUsXG4gICAgb25GdWxmaWxsZWQsXG4gICAgb25SZWplY3RlZFxuICApO1xufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHByb21pc2UgdGhhdCB3aWxsIGhhbmRsZSB0aGUgcmVqZWN0ZWQgc3RhdGUgb2YgdGhpcyBwcm9taXNlLlxuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKil9IG9uUmVqZWN0ZWRcbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2ggPSBmdW5jdGlvbihvblJlamVjdGVkKSB7XG4gIHJldHVybiB0aGlzLnRoZW4odm9pZCAwLCBvblJlamVjdGVkKTtcbn07XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gIFB1YmxpYyBTdGF0aWMgTWV0aG9kc1xuICoqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbi8qKlxuICogQ3JlYXRlcyBhIGZ1bGZpbGxlZCBQcm9taXNlIG9mIHZhbHVlLiBJZiB2YWx1ZSBpcyBpdHNlbGYgYSB0aGVuLWFibGUsXG4gKiByZXNvbHZlcyB3aXRoIHRoZSB0aGVuLWFibGUncyB2YWx1ZS5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9XG4gKiBAcGFyYW0geyo9fSB2YWx1ZVxuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5Qcm9taXNlLnJlc29sdmUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuICB2YXIgcHJvbWlzZTtcblxuICBpZiAoaXNPYmplY3QodmFsdWUpICYmIHZhbHVlIGluc3RhbmNlb2YgdGhpcykge1xuICAgIHByb21pc2UgPSB2YWx1ZTtcbiAgfSBlbHNlIHtcbiAgICBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2V9ICovKHByb21pc2UpO1xufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgcmVqZWN0ZWQgUHJvbWlzZSBvZiByZWFzb24uXG4gKlxuICogQHRoaXMgeyFQcm9taXNlfVxuICogQHBhcmFtIHsqPX0gcmVhc29uXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cblByb21pc2UucmVqZWN0ID0gZnVuY3Rpb24ocmVhc29uKSB7XG4gIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG4gIHZhciBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uKF8sIHJlamVjdCkge1xuICAgIHJlamVjdChyZWFzb24pO1xuICB9KTtcblxuICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZX0gKi8ocHJvbWlzZSk7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBQcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHdpdGggYW4gYXJyYXkgb2YgdGhlIHZhbHVlcyBvZiB0aGVcbiAqIHBhc3NlZCBpbiBwcm9taXNlcy4gSWYgYW55IHByb21pc2UgcmVqZWN0cywgdGhlIHJldHVybmVkIHByb21pc2Ugd2lsbFxuICogcmVqZWN0LlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX1cbiAqIEBwYXJhbSB7IUFycmF5PFByb21pc2V8Kj59IHByb21pc2VzXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cblByb21pc2UuYWxsID0gZnVuY3Rpb24ocHJvbWlzZXMpIHtcbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcbiAgdmFyIHByb21pc2UgPSBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdmFyIGxlbmd0aCA9IHByb21pc2VzLmxlbmd0aDtcbiAgICB2YXIgdmFsdWVzID0gbmV3IEFycmF5KGxlbmd0aCk7XG5cbiAgICBpZiAobGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gcmVzb2x2ZSh2YWx1ZXMpO1xuICAgIH1cblxuICAgIGVhY2gocHJvbWlzZXMsIGZ1bmN0aW9uKHByb21pc2UsIGluZGV4KSB7XG4gICAgICBDb25zdHJ1Y3Rvci5yZXNvbHZlKHByb21pc2UpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgdmFsdWVzW2luZGV4XSA9IHZhbHVlO1xuICAgICAgICBpZiAoLS1sZW5ndGggPT09IDApIHtcbiAgICAgICAgICByZXNvbHZlKHZhbHVlcyk7XG4gICAgICAgIH1cbiAgICAgIH0sIHJlamVjdCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlfSAqLyhwcm9taXNlKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIFByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgb3IgcmVqZWN0IGJhc2VkIG9uIHRoZSBmaXJzdFxuICogcmVzb2x2ZWQgb3IgcmVqZWN0ZWQgcHJvbWlzZS5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9XG4gKiBAcGFyYW0geyFBcnJheTxQcm9taXNlfCo+fSBwcm9taXNlc1xuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5Qcm9taXNlLnJhY2UgPSBmdW5jdGlvbihwcm9taXNlcykge1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb21pc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBDb25zdHJ1Y3Rvci5yZXNvbHZlKHByb21pc2VzW2ldKS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZX0gKi8ocHJvbWlzZSk7XG59O1xuXG52YXIgb25Qb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbiA9IGZ1bmN0aW9uKHJlYXNvbiwgcHJvbWlzZSkge1xuICB0aHJvdyByZWFzb247XG59O1xuXG4vKipcbiAqIEFuIGludGVybmFsIHVzZSBzdGF0aWMgZnVuY3Rpb24uXG4gKi9cblByb21pc2UuX292ZXJyaWRlVW5oYW5kbGVkRXhjZXB0aW9uSGFuZGxlciA9IGZ1bmN0aW9uKGhhbmRsZXIpIHtcbiAgb25Qb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbiA9IGhhbmRsZXI7XG59O1xuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICBQcml2YXRlIGZ1bmN0aW9uc1xuICoqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbi8qKlxuICogVGhlIEZ1bGZpbGxlZCBQcm9taXNlIHN0YXRlLiBDYWxscyBvbkZ1bGZpbGxlZCB3aXRoIHRoZSByZXNvbHZlZCB2YWx1ZSBvZlxuICogdGhpcyBwcm9taXNlLCBjcmVhdGluZyBhIG5ldyBwcm9taXNlLlxuICpcbiAqIElmIHRoZXJlIGlzIG5vIG9uRnVsZmlsbGVkLCByZXR1cm5zIHRoZSBjdXJyZW50IHByb21pc2UgdG8gYXZvaWQgYW4gcHJvbWlzZVxuICogaW5zdGFuY2UuXG4gKlxuICogQHRoaXMgeyFQcm9taXNlfSBUaGUgY3VycmVudCBwcm9taXNlXG4gKiBAcGFyYW0geyo9fSB2YWx1ZSBUaGUgY3VycmVudCBwcm9taXNlJ3MgcmVzb2x2ZWQgdmFsdWUuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IG9uRnVsZmlsbGVkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IHVudXNlZFxuICogQHBhcmFtIHtEZWZlcnJlZH0gZGVmZXJyZWQgQSBkZWZlcnJlZCBvYmplY3QgdGhhdCBob2xkcyBhIHByb21pc2UgYW5kIGl0c1xuICogICAgIHJlc29sdmUgYW5kIHJlamVjdCBmdW5jdGlvbnMuIEl0IElTIE5PVCBwYXNzZWQgd2hlbiBjYWxsZWQgZnJvbVxuICogICAgIFByb21pc2UjdGhlbiB0byBzYXZlIGFuIG9iamVjdCBpbnN0YW5jZSAoc2luY2Ugd2UgbWF5IHJldHVybiB0aGUgY3VycmVudFxuICogICAgIHByb21pc2UpLiBJdCBJUyBwYXNzZWQgaW4gd2hlbiBhZG9wdGluZyB0aGUgRnVsZmlsbGVkIHN0YXRlIGZyb20gdGhlXG4gKiAgICAgUGVuZGluZyBzdGF0ZS5cbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gRnVsZmlsbGVkUHJvbWlzZSh2YWx1ZSwgb25GdWxmaWxsZWQsIHVudXNlZCwgZGVmZXJyZWQpIHtcbiAgaWYgKCFvbkZ1bGZpbGxlZCkge1xuICAgIGRlZmVycmVkQWRvcHQoZGVmZXJyZWQsIEZ1bGZpbGxlZFByb21pc2UsIHZhbHVlKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBpZiAoIWRlZmVycmVkKSB7XG4gICAgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQodGhpcy5jb25zdHJ1Y3Rvcik7XG4gIH1cbiAgZGVmZXIodHJ5Q2F0Y2hEZWZlcnJlZChkZWZlcnJlZCwgb25GdWxmaWxsZWQsIHZhbHVlKSk7XG4gIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xufVxuXG4vKipcbiAqIFRoZSBSZWplY3RlZCBQcm9taXNlIHN0YXRlLiBDYWxscyBvblJlamVjdGVkIHdpdGggdGhlIHJlc29sdmVkIHZhbHVlIG9mXG4gKiB0aGlzIHByb21pc2UsIGNyZWF0aW5nIGEgbmV3IHByb21pc2UuXG4gKlxuICogSWYgdGhlcmUgaXMgbm8gb25SZWplY3RlZCwgcmV0dXJucyB0aGUgY3VycmVudCBwcm9taXNlIHRvIGF2b2lkIGFuIHByb21pc2VcbiAqIGluc3RhbmNlLlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX0gVGhlIGN1cnJlbnQgcHJvbWlzZVxuICogQHBhcmFtIHsqPX0gcmVhc29uIFRoZSBjdXJyZW50IHByb21pc2UncyByZWplY3Rpb24gcmVhc29uLlxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSB1bnVzZWRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0pPX0gb25SZWplY3RlZFxuICogQHBhcmFtIHtEZWZlcnJlZH0gZGVmZXJyZWQgQSBkZWZlcnJlZCBvYmplY3QgdGhhdCBob2xkcyBhIHByb21pc2UgYW5kIGl0c1xuICogICAgIHJlc29sdmUgYW5kIHJlamVjdCBmdW5jdGlvbnMuIEl0IElTIE5PVCBwYXNzZWQgd2hlbiBjYWxsZWQgZnJvbVxuICogICAgIFByb21pc2UjdGhlbiB0byBzYXZlIGFuIG9iamVjdCBpbnN0YW5jZSAoc2luY2Ugd2UgbWF5IHJldHVybiB0aGUgY3VycmVudFxuICogICAgIHByb21pc2UpLiBJdCBJUyBwYXNzZWQgaW4gd2hlbiBhZG9wdGluZyB0aGUgUmVqZWN0ZWQgc3RhdGUgZnJvbSB0aGVcbiAqICAgICBQZW5kaW5nIHN0YXRlLlxuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5mdW5jdGlvbiBSZWplY3RlZFByb21pc2UocmVhc29uLCB1bnVzZWQsIG9uUmVqZWN0ZWQsIGRlZmVycmVkKSB7XG4gIGlmICghb25SZWplY3RlZCkge1xuICAgIGRlZmVycmVkQWRvcHQoZGVmZXJyZWQsIFJlamVjdGVkUHJvbWlzZSwgcmVhc29uKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBpZiAoIWRlZmVycmVkKSB7XG4gICAgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQodGhpcy5jb25zdHJ1Y3Rvcik7XG4gIH1cbiAgZGVmZXIodHJ5Q2F0Y2hEZWZlcnJlZChkZWZlcnJlZCwgb25SZWplY3RlZCwgcmVhc29uKSk7XG4gIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xufVxuXG4vKipcbiAqIFRoZSBQZW5kaW5nIFByb21pc2Ugc3RhdGUuIEV2ZW50dWFsbHkgY2FsbHMgb25GdWxmaWxsZWQgb25jZSB0aGUgcHJvbWlzZSBoYXNcbiAqIHJlc29sdmVkLCBvciBvblJlamVjdGVkIG9uY2UgdGhlIHByb21pc2UgcmVqZWN0cy5cbiAqXG4gKiBJZiB0aGVyZSBpcyBubyBvbkZ1bGZpbGxlZCBhbmQgbm8gb25SZWplY3RlZCwgcmV0dXJucyB0aGUgY3VycmVudCBwcm9taXNlIHRvXG4gKiBhdm9pZCBhbiBwcm9taXNlIGluc3RhbmNlLlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX0gVGhlIGN1cnJlbnQgcHJvbWlzZVxuICogQHBhcmFtIHsqPX0gcXVldWUgVGhlIGN1cnJlbnQgcHJvbWlzZSdzIHBlbmRpbmcgcHJvbWlzZXMgcXVldWUuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IG9uRnVsZmlsbGVkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IG9uUmVqZWN0ZWRcbiAqIEBwYXJhbSB7RGVmZXJyZWR9IGRlZmVycmVkIEEgZGVmZXJyZWQgb2JqZWN0IHRoYXQgaG9sZHMgYSBwcm9taXNlIGFuZCBpdHNcbiAqICAgICByZXNvbHZlIGFuZCByZWplY3QgZnVuY3Rpb25zLiBJdCBJUyBOT1QgcGFzc2VkIHdoZW4gY2FsbGVkIGZyb21cbiAqICAgICBQcm9taXNlI3RoZW4gdG8gc2F2ZSBhbiBvYmplY3QgaW5zdGFuY2UgKHNpbmNlIHdlIG1heSByZXR1cm4gdGhlIGN1cnJlbnRcbiAqICAgICBwcm9taXNlKS4gSXQgSVMgcGFzc2VkIGluIHdoZW4gYWRvcHRpbmcgdGhlIFBlbmRpbmcgc3RhdGUgZnJvbSB0aGVcbiAqICAgICBQZW5kaW5nIHN0YXRlIG9mIGFub3RoZXIgcHJvbWlzZS5cbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gUGVuZGluZ1Byb21pc2UocXVldWUsIG9uRnVsZmlsbGVkLCBvblJlamVjdGVkLCBkZWZlcnJlZCkge1xuICBpZiAoIWRlZmVycmVkKSB7XG4gICAgaWYgKCFvbkZ1bGZpbGxlZCAmJiAhb25SZWplY3RlZCkgeyByZXR1cm4gdGhpczsgfVxuICAgIGRlZmVycmVkID0gbmV3IERlZmVycmVkKHRoaXMuY29uc3RydWN0b3IpO1xuICB9XG4gIHF1ZXVlLnB1c2goe1xuICAgIGRlZmVycmVkOiBkZWZlcnJlZCxcbiAgICBvbkZ1bGZpbGxlZDogb25GdWxmaWxsZWQgfHwgZGVmZXJyZWQucmVzb2x2ZSxcbiAgICBvblJlamVjdGVkOiBvblJlamVjdGVkIHx8IGRlZmVycmVkLnJlamVjdFxuICB9KTtcbiAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG59XG5cbi8qKlxuICogQ29uc3RydWN0cyBhIGRlZmVycmVkIGluc3RhbmNlIHRoYXQgaG9sZHMgYSBwcm9taXNlIGFuZCBpdHMgcmVzb2x2ZSBhbmRcbiAqIHJlamVjdCBmdW5jdGlvbnMuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIERlZmVycmVkKFByb21pc2UpIHtcbiAgdmFyIGRlZmVycmVkID0gdGhpcztcbiAgLyoqIEB0eXBlIHshUHJvbWlzZX0gKi9cbiAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgLyoqIEB0eXBlIHtmdW5jdGlvbigqPSl9ICovXG4gICAgZGVmZXJyZWQucmVzb2x2ZSA9IHJlc29sdmU7XG5cbiAgICAvKiogQHR5cGUge2Z1bmN0aW9uKCo9KX0gKi9cbiAgICBkZWZlcnJlZC5yZWplY3QgPSByZWplY3Q7XG4gIH0pO1xuICByZXR1cm4gZGVmZXJyZWQ7XG59XG5cbi8qKlxuICogVHJhbnNpdGlvbnMgdGhlIHN0YXRlIG9mIHByb21pc2UgdG8gYW5vdGhlciBzdGF0ZS4gVGhpcyBpcyBvbmx5IGV2ZXIgY2FsbGVkXG4gKiBvbiB3aXRoIGEgcHJvbWlzZSB0aGF0IGlzIGN1cnJlbnRseSBpbiB0aGUgUGVuZGluZyBzdGF0ZS5cbiAqXG4gKiBAcGFyYW0geyFQcm9taXNlfSBwcm9taXNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKHRoaXM6UHJvbWlzZSwqPSxmdW5jdGlvbigqPSksZnVuY3Rpb24oKj0pLERlZmVycmVkKTohUHJvbWlzZX0gc3RhdGVcbiAqIEBwYXJhbSB7Kj19IHZhbHVlXG4gKi9cbmZ1bmN0aW9uIGFkb3B0KHByb21pc2UsIHN0YXRlLCB2YWx1ZSwgYWRvcHRlZSkge1xuICB2YXIgcXVldWUgPSBwcm9taXNlLl92YWx1ZTtcbiAgcHJvbWlzZS5fc3RhdGUgPSBzdGF0ZTtcbiAgcHJvbWlzZS5fdmFsdWUgPSB2YWx1ZTtcblxuICBpZiAoYWRvcHRlZSAmJiBzdGF0ZSA9PT0gUGVuZGluZ1Byb21pc2UpIHtcbiAgICBhZG9wdGVlLl9zdGF0ZSh2YWx1ZSwgdm9pZCAwLCB2b2lkIDAsIHtcbiAgICAgIHByb21pc2U6IHByb21pc2UsXG4gICAgICByZXNvbHZlOiB2b2lkIDAsXG4gICAgICByZWplY3Q6IHZvaWQgMFxuICAgIH0pO1xuICB9XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWV1ZS5sZW5ndGg7IGkrKykge1xuICAgIHZhciBuZXh0ID0gcXVldWVbaV07XG4gICAgcHJvbWlzZS5fc3RhdGUoXG4gICAgICB2YWx1ZSxcbiAgICAgIG5leHQub25GdWxmaWxsZWQsXG4gICAgICBuZXh0Lm9uUmVqZWN0ZWQsXG4gICAgICBuZXh0LmRlZmVycmVkXG4gICAgKTtcbiAgfVxuICBxdWV1ZS5sZW5ndGggPSAwO1xuXG4gIC8vIERldGVybWluZSBpZiB0aGlzIHJlamVjdGVkIHByb21pc2Ugd2lsbCBiZSBcImhhbmRsZWRcIi5cbiAgaWYgKHN0YXRlID09PSBSZWplY3RlZFByb21pc2UgJiYgcHJvbWlzZS5faXNDaGFpbkVuZCkge1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBpZiAocHJvbWlzZS5faXNDaGFpbkVuZCkge1xuICAgICAgICBvblBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uKHZhbHVlLCBwcm9taXNlKTtcbiAgICAgIH1cbiAgICB9LCAwKTtcbiAgfVxufVxuXG4vKipcbiAqIEEgcGFydGlhbCBhcHBsaWNhdGlvbiBvZiBhZG9wdC5cbiAqXG4gKiBAcGFyYW0geyFQcm9taXNlfSBwcm9taXNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKHRoaXM6UHJvbWlzZSwqPSxmdW5jdGlvbigqPSksZnVuY3Rpb24oKj0pLERlZmVycmVkKTohUHJvbWlzZX0gc3RhdGVcbiAqIEByZXR1cm5zIHtmdW5jdGlvbigqPSl9XG4gKi9cbmZ1bmN0aW9uIGFkb3B0ZXIocHJvbWlzZSwgc3RhdGUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgYWRvcHQocHJvbWlzZSwgc3RhdGUsIHZhbHVlKTtcbiAgfTtcbn1cblxuLyoqXG4gKiBVcGRhdGVzIGEgZGVmZXJyZWQgcHJvbWlzZXMgc3RhdGUuIE5lY2Vzc2FyeSBmb3IgdXBkYXRpbmcgYW4gYWRvcHRpbmdcbiAqIHByb21pc2UncyBzdGF0ZSB3aGVuIHRoZSBhZG9wdGVlIHJlc29sdmVzLlxuICpcbiAqIEBwYXJhbSB7P0RlZmVycmVkfSBkZWZlcnJlZFxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlByb21pc2UsKj0sZnVuY3Rpb24oKj0pLGZ1bmN0aW9uKCo9KSxEZWZlcnJlZCk6IVByb21pc2V9IHN0YXRlXG4gKiBAcGFyYW0geyo9fSB2YWx1ZVxuICovXG5mdW5jdGlvbiBkZWZlcnJlZEFkb3B0KGRlZmVycmVkLCBzdGF0ZSwgdmFsdWUpIHtcbiAgaWYgKGRlZmVycmVkKSB7XG4gICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgIHByb21pc2UuX3N0YXRlID0gc3RhdGU7XG4gICAgcHJvbWlzZS5fdmFsdWUgPSB2YWx1ZTtcbiAgfVxufVxuXG4vKipcbiAqIEEgbm8tb3AgZnVuY3Rpb24gdG8gcHJldmVudCBkb3VibGUgcmVzb2x2aW5nLlxuICovXG5mdW5jdGlvbiBub29wKCkge31cblxuLyoqXG4gKiBUZXN0cyBpZiBmbiBpcyBhIEZ1bmN0aW9uXG4gKlxuICogQHBhcmFtIHsqfSBmblxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oZm4pIHtcbiAgcmV0dXJuIHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJztcbn1cblxuLyoqXG4gKiBUZXN0cyBpZiBmbiBpcyBhbiBPYmplY3RcbiAqXG4gKiBAcGFyYW0geyp9IG9ialxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzT2JqZWN0KG9iaikge1xuICByZXR1cm4gb2JqID09PSBPYmplY3Qob2JqKTtcbn1cblxuLyoqXG4gKiBJdGVyYXRlcyBvdmVyIGVhY2ggZWxlbWVudCBvZiBhbiBhcnJheSwgY2FsbGluZyB0aGUgaXRlcmF0b3Igd2l0aCB0aGVcbiAqIGVsZW1lbnQgYW5kIGl0cyBpbmRleC5cbiAqXG4gKiBAcGFyYW0geyFBcnJheX0gY29sbGVjdGlvblxuICogQHBhcmFtIHtmdW5jdGlvbigqPSxudW1iZXIpfSBpdGVyYXRvclxuICovXG5mdW5jdGlvbiBlYWNoKGNvbGxlY3Rpb24sIGl0ZXJhdG9yKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY29sbGVjdGlvbi5sZW5ndGg7IGkrKykge1xuICAgIGl0ZXJhdG9yKGNvbGxlY3Rpb25baV0sIGkpO1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBhdHRlbXB0IHRvIHJlc29sdmUgdGhlIGRlZmVycmVkIHdpdGggdGhlIHJldHVyblxuICogb2YgZm4uIElmIGFueSBlcnJvciBpcyByYWlzZWQsIHJlamVjdHMgaW5zdGVhZC5cbiAqXG4gKiBAcGFyYW0geyFEZWZlcnJlZH0gZGVmZXJyZWRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0pfSBmblxuICogQHBhcmFtIHsqfSBhcmdcbiAqIEByZXR1cm5zIHtmdW5jdGlvbigpfVxuICovXG5mdW5jdGlvbiB0cnlDYXRjaERlZmVycmVkKGRlZmVycmVkLCBmbiwgYXJnKSB7XG4gIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgdmFyIHJlc29sdmUgPSBkZWZlcnJlZC5yZXNvbHZlO1xuICB2YXIgcmVqZWN0ID0gZGVmZXJyZWQucmVqZWN0O1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciByZXN1bHQgPSBmbihhcmcpO1xuICAgICAgZG9SZXNvbHZlKHByb21pc2UsIHJlc29sdmUsIHJlamVjdCwgcmVzdWx0LCByZXN1bHQpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJlamVjdChlKTtcbiAgICB9XG4gIH07XG59XG5cbi8qKlxuICogUXVldWVzIGFuZCBleGVjdXRlcyBtdWx0aXBsZSBkZWZlcnJlZCBmdW5jdGlvbnMgb24gYW5vdGhlciBydW4gbG9vcC5cbiAqL1xudmFyIGRlZmVyID0gKGZ1bmN0aW9uKCkge1xuICAvKipcbiAgICogRGVmZXJzIGZuIHRvIGFub3RoZXIgcnVuIGxvb3AuXG4gICAqL1xuICB2YXIgc2NoZWR1bGVGbHVzaDtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5wb3N0TWVzc2FnZSkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZmx1c2gpO1xuICAgIHNjaGVkdWxlRmx1c2ggPSBmdW5jdGlvbigpIHtcbiAgICAgIHdpbmRvdy5wb3N0TWVzc2FnZSgnbWFjcm8tdGFzaycsICcqJyk7XG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBzY2hlZHVsZUZsdXNoID0gZnVuY3Rpb24oKSB7XG4gICAgICBzZXRUaW1lb3V0KGZsdXNoLCAwKTtcbiAgICB9O1xuICB9XG5cbiAgdmFyIHF1ZXVlID0gbmV3IEFycmF5KDE2KTtcbiAgdmFyIGxlbmd0aCA9IDA7XG5cbiAgZnVuY3Rpb24gZmx1c2goKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGZuID0gcXVldWVbaV07XG4gICAgICBxdWV1ZVtpXSA9IG51bGw7XG4gICAgICBmbigpO1xuICAgIH1cbiAgICBsZW5ndGggPSAwO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gZm5cbiAgICovXG4gIGZ1bmN0aW9uIGRlZmVyKGZuKSB7XG4gICAgaWYgKGxlbmd0aCA9PT0gMCkgeyBzY2hlZHVsZUZsdXNoKCk7IH1cbiAgICBxdWV1ZVtsZW5ndGgrK10gPSBmbjtcbiAgfVxuXG4gIHJldHVybiBkZWZlcjtcbn0pKCk7XG5cbi8qKlxuICogVGhlIFByb21pc2UgcmVzb2x1dGlvbiBwcm9jZWR1cmUuXG4gKiBodHRwczovL2dpdGh1Yi5jb20vcHJvbWlzZXMtYXBsdXMvcHJvbWlzZXMtc3BlYyN0aGUtcHJvbWlzZS1yZXNvbHV0aW9uLXByb2NlZHVyZVxuICpcbiAqIEBwYXJhbSB7IVByb21pc2V9IHByb21pc2VcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0pfSByZXNvbHZlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KX0gcmVqZWN0XG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcGFyYW0geyo9fSBjb250ZXh0XG4gKi9cbmZ1bmN0aW9uIGRvUmVzb2x2ZShwcm9taXNlLCByZXNvbHZlLCByZWplY3QsIHZhbHVlLCBjb250ZXh0KSB7XG4gIHZhciBfcmVqZWN0ID0gcmVqZWN0O1xuICB2YXIgdGhlbjtcbiAgdmFyIF9yZXNvbHZlO1xuICB0cnkge1xuICAgIGlmICh2YWx1ZSA9PT0gcHJvbWlzZSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGZ1bGZpbGwgcHJvbWlzZSB3aXRoIGl0c2VsZicpO1xuICAgIH1cbiAgICB2YXIgaXNPYmogPSBpc09iamVjdCh2YWx1ZSk7XG4gICAgaWYgKGlzT2JqICYmIHZhbHVlIGluc3RhbmNlb2YgcHJvbWlzZS5jb25zdHJ1Y3Rvcikge1xuICAgICAgYWRvcHQocHJvbWlzZSwgdmFsdWUuX3N0YXRlLCB2YWx1ZS5fdmFsdWUsIHZhbHVlKTtcbiAgICB9IGVsc2UgaWYgKGlzT2JqICYmICh0aGVuID0gdmFsdWUudGhlbikgJiYgaXNGdW5jdGlvbih0aGVuKSkge1xuICAgICAgX3Jlc29sdmUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBfcmVzb2x2ZSA9IF9yZWplY3QgPSBub29wO1xuICAgICAgICBkb1Jlc29sdmUocHJvbWlzZSwgcmVzb2x2ZSwgcmVqZWN0LCB2YWx1ZSwgdmFsdWUpO1xuICAgICAgfTtcbiAgICAgIF9yZWplY3QgPSBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgX3Jlc29sdmUgPSBfcmVqZWN0ID0gbm9vcDtcbiAgICAgICAgcmVqZWN0KHJlYXNvbik7XG4gICAgICB9O1xuICAgICAgdGhlbi5jYWxsKFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICBmdW5jdGlvbih2YWx1ZSkgeyBfcmVzb2x2ZSh2YWx1ZSk7IH0sXG4gICAgICAgIGZ1bmN0aW9uKHJlYXNvbikgeyBfcmVqZWN0KHJlYXNvbik7IH1cbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIF9yZWplY3QoZSk7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBQcm9taXNlO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQ29tbW9uIEFNUCBldmVudHMuXG4gKiBAZW51bSB7c3RyaW5nfVxuICovXG5leHBvcnQgY29uc3QgQW1wRXZlbnRzID0ge1xuICBCVUlMVDogJ2FtcDpidWlsdCcsXG4gIERPTV9VUERBVEU6ICdhbXA6ZG9tLXVwZGF0ZScsXG4gIFZJU0lCSUxJVFlfQ0hBTkdFOiAnYW1wOnZpc2liaWxpdHljaGFuZ2UnLCAvLyBodHRwczovL2dpdGh1Yi5jb20vYW1wcHJvamVjdC9hbXBodG1sL2Jsb2IvbWFzdGVyL2Fkcy9SRUFETUUubWQjcGFnZS12aXNpYmlsaXR5XG4gIC8vIFRoZSBmb2xsb3dpbmcgY29kZXMgYXJlIG9ubHkgdXNlZCBmb3IgdGVzdGluZy5cbiAgLy8gVE9ETyhjaG91bXgpOiBNb3ZlIHRoZXNlIHRvIGEgc2VwYXJhdGUgZW51bSBzbyB0aGV5IGNhbiBiZSBEQ0UnZC5cbiAgQVRUQUNIRUQ6ICdhbXA6YXR0YWNoZWQnLFxuICBTVFVCQkVEOiAnYW1wOnN0dWJiZWQnLFxuICBMT0FEX1NUQVJUOiAnYW1wOmxvYWQ6c3RhcnQnLFxuICBMT0FEX0VORDogJ2FtcDpsb2FkOmVuZCcsXG4gIEVSUk9SOiAnYW1wOmVycm9yJyxcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi9zZXJ2aWNlcyc7XG5cbi8qKlxuICogSGVscGVyIG1ldGhvZCB0byB0cmlnZ2VyIGFuYWx5dGljcyBldmVudCBpZiBhbXAtYW5hbHl0aWNzIGlzIGF2YWlsYWJsZS5cbiAqIFRPRE86IERvIG5vdCBleHBvc2UgdGhpcyBmdW5jdGlvblxuICogQHBhcmFtIHshRWxlbWVudH0gdGFyZ2V0XG4gKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+PX0gb3B0X3ZhcnMgQSBtYXAgb2YgdmFycyBhbmQgdGhlaXIgdmFsdWVzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJpZ2dlckFuYWx5dGljc0V2ZW50KHRhcmdldCwgZXZlbnRUeXBlLCBvcHRfdmFycykge1xuICBTZXJ2aWNlcy5hbmFseXRpY3NGb3JEb2NPck51bGwodGFyZ2V0KS50aGVuKGFuYWx5dGljcyA9PiB7XG4gICAgaWYgKCFhbmFseXRpY3MpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYW5hbHl0aWNzLnRyaWdnZXJFdmVudEZvclRhcmdldCh0YXJnZXQsIGV2ZW50VHlwZSwgb3B0X3ZhcnMpO1xuICB9KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEFsbG93cyBmb3IgcnVudGltZSBjb25maWd1cmF0aW9uLiBJbnRlcm5hbGx5LCB0aGUgcnVudGltZSBzaG91bGRcbiAqIHVzZSB0aGUgc3JjL2NvbmZpZy5qcyBtb2R1bGUgZm9yIHZhcmlvdXMgY29uc3RhbnRzLiBXZSBjYW4gdXNlIHRoZVxuICogQU1QX0NPTkZJRyBnbG9iYWwgdG8gdHJhbnNsYXRlIHVzZXItZGVmaW5lZCBjb25maWd1cmF0aW9ucyB0byB0aGlzXG4gKiBtb2R1bGUuXG4gKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59XG4gKi9cbmNvbnN0IGVudiA9IHNlbGYuQU1QX0NPTkZJRyB8fCB7fTtcblxuY29uc3QgdGhpcmRQYXJ0eUZyYW1lUmVnZXggPSB0eXBlb2YgZW52Wyd0aGlyZFBhcnR5RnJhbWVSZWdleCddID09ICdzdHJpbmcnID9cbiAgbmV3IFJlZ0V4cChlbnZbJ3RoaXJkUGFydHlGcmFtZVJlZ2V4J10pIDogZW52Wyd0aGlyZFBhcnR5RnJhbWVSZWdleCddO1xuXG5jb25zdCBjZG5Qcm94eVJlZ2V4ID0gdHlwZW9mIGVudlsnY2RuUHJveHlSZWdleCddID09ICdzdHJpbmcnID9cbiAgbmV3IFJlZ0V4cChlbnZbJ2NkblByb3h5UmVnZXgnXSkgOiBlbnZbJ2NkblByb3h5UmVnZXgnXTtcblxuLyoqIEB0eXBlIHshT2JqZWN0PHN0cmluZywgc3RyaW5nfGJvb2xlYW58UmVnRXhwPn0gKi9cbmV4cG9ydCBjb25zdCB1cmxzID0ge1xuICB0aGlyZFBhcnR5OiBlbnZbJ3RoaXJkUGFydHlVcmwnXSB8fCAnaHR0cHM6Ly8zcC5hbXBwcm9qZWN0Lm5ldCcsXG4gIHRoaXJkUGFydHlGcmFtZUhvc3Q6IGVudlsndGhpcmRQYXJ0eUZyYW1lSG9zdCddIHx8ICdhbXBwcm9qZWN0Lm5ldCcsXG4gIHRoaXJkUGFydHlGcmFtZVJlZ2V4OiB0aGlyZFBhcnR5RnJhbWVSZWdleCB8fCAvXmQtXFxkK1xcLmFtcHByb2plY3RcXC5uZXQkLyxcbiAgY2RuOiBlbnZbJ2NkblVybCddIHx8ICdodHRwczovL2Nkbi5hbXBwcm9qZWN0Lm9yZycsXG4gIC8qIE5vdGUgdGhhdCBjZG5Qcm94eVJlZ2V4IGlzIG9ubHkgZXZlciBjaGVja2VkIGFnYWluc3Qgb3JpZ2luc1xuICAgKiAocHJvdG86Ly9ob3N0Wzpwb3J0XSkgc28gZG9lcyBub3QgbmVlZCB0byBjb25zaWRlciBwYXRoXG4gICAqL1xuICBjZG5Qcm94eVJlZ2V4OiBjZG5Qcm94eVJlZ2V4IHx8XG4gICAgICAvXmh0dHBzOlxcL1xcLyhbYS16QS1aMC05Xy1dK1xcLik/Y2RuXFwuYW1wcHJvamVjdFxcLm9yZyQvLFxuICBsb2NhbGhvc3RSZWdleDogL15odHRwcz86XFwvXFwvbG9jYWxob3N0KDpcXGQrKT8kLyxcbiAgZXJyb3JSZXBvcnRpbmc6IGVudlsnZXJyb3JSZXBvcnRpbmdVcmwnXSB8fFxuICAgICAgJ2h0dHBzOi8vYW1wLWVycm9yLXJlcG9ydGluZy5hcHBzcG90LmNvbS9yJyxcbiAgbG9jYWxEZXY6IGVudlsnbG9jYWxEZXYnXSB8fCBmYWxzZSxcbn07XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIHVybHMsXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7ZW5kc1dpdGh9IGZyb20gJy4vc3RyaW5nJztcbmltcG9ydCB7XG4gIGlzUHJveHlPcmlnaW4sXG4gIHBhcnNlVXJsRGVwcmVjYXRlZCxcbiAgdHJ5RGVjb2RlVXJpQ29tcG9uZW50LFxufSBmcm9tICcuL3VybCc7XG5pbXBvcnQge3VybHN9IGZyb20gJy4vY29uZmlnJztcblxuXG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBjb29raWUuIFRoZSBjb29raWUgYWNjZXNzIGlzIHJlc3RyaWN0ZWQgYW5kIG11c3RcbiAqIGdvIHRocm91Z2ggdGhlIHByaXZhY3kgcmV2aWV3LiBCZWZvcmUgdXNpbmcgdGhpcyBtZXRob2QgcGxlYXNlIGZpbGUgYVxuICogR2l0SHViIGlzc3VlIHdpdGggXCJQcml2YWN5IFJldmlld1wiIGxhYmVsLlxuICpcbiAqIFJldHVybnMgdGhlIGNvb2tpZSdzIHZhbHVlIG9yIGBudWxsYC5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAqIEByZXR1cm4gez9zdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb29raWUod2luLCBuYW1lKSB7XG4gIGNvbnN0IGNvb2tpZVN0cmluZyA9IHRyeUdldERvY3VtZW50Q29va2llTm9JbmxpbmUod2luKTtcbiAgaWYgKCFjb29raWVTdHJpbmcpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBjb29raWVzID0gY29va2llU3RyaW5nLnNwbGl0KCc7Jyk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY29va2llcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGNvb2tpZSA9IGNvb2tpZXNbaV0udHJpbSgpO1xuICAgIGNvbnN0IGVxID0gY29va2llLmluZGV4T2YoJz0nKTtcbiAgICBpZiAoZXEgPT0gLTEpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAodHJ5RGVjb2RlVXJpQ29tcG9uZW50KGNvb2tpZS5zdWJzdHJpbmcoMCwgZXEpLnRyaW0oKSkgPT0gbmFtZSkge1xuICAgICAgY29uc3QgdmFsdWUgPSBjb29raWUuc3Vic3RyaW5nKGVxICsgMSkudHJpbSgpO1xuICAgICAgcmV0dXJuIHRyeURlY29kZVVyaUNvbXBvbmVudCh2YWx1ZSwgdmFsdWUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBUaGlzIG1ldGhvZCBzaG91bGQgbm90IGJlIGlubGluZWQgdG8gcHJldmVudCBUcnlDYXRjaCBkZW9wdGltaXphdGlvbi5cbiAqIE5vSW5saW5lIGtleXdvcmQgYXQgdGhlIGVuZCBvZiBmdW5jdGlvbiBuYW1lIGFsc28gcHJldmVudHMgQ2xvc3VyZSBjb21waWxlclxuICogZnJvbSBpbmxpbmluZyB0aGUgZnVuY3Rpb24uXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0cnlHZXREb2N1bWVudENvb2tpZU5vSW5saW5lKHdpbikge1xuICB0cnkge1xuICAgIHJldHVybiB3aW4uZG9jdW1lbnQuY29va2llO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gQWN0IGFzIGlmIG5vIGNvb2tpZSBpcyBhdmFpbGFibGUuIEV4Y2VwdGlvbnMgY2FuIGJlIHRocm93biB3aGVuXG4gICAgLy8gQU1QIGRvY3MgYXJlIG9wZW5lZCBvbiBvcmlnaW5zIHRoYXQgZG8gbm90IGFsbG93IHNldHRpbmdcbiAgICAvLyBjb29raWVzIHN1Y2ggYXMgbnVsbCBvcmlnaW5zLlxuICAgIHJldHVybiAnJztcbiAgfVxufVxuXG4vKipcbiAqIFNldHMgdGhlIHZhbHVlIG9mIHRoZSBjb29raWUuIFRoZSBjb29raWUgYWNjZXNzIGlzIHJlc3RyaWN0ZWQgYW5kIG11c3RcbiAqIGdvIHRocm91Z2ggdGhlIHByaXZhY3kgcmV2aWV3LiBCZWZvcmUgdXNpbmcgdGhpcyBtZXRob2QgcGxlYXNlIGZpbGUgYVxuICogR2l0SHViIGlzc3VlIHdpdGggXCJQcml2YWN5IFJldmlld1wiIGxhYmVsLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gKiBAcGFyYW0ge3RpbWV9IGV4cGlyYXRpb25UaW1lXG4gKiBAcGFyYW0ge3tcbiAqICAgaGlnaGVzdEF2YWlsYWJsZURvbWFpbjooYm9vbGVhbnx1bmRlZmluZWQpLFxuICogICBkb21haW46KHN0cmluZ3x1bmRlZmluZWQpXG4gKiB9PX0gb3B0X29wdGlvbnNcbiAqICAgICAtIGhpZ2hlc3RBdmFpbGFibGVEb21haW46IElmIHRydWUsIHNldCB0aGUgY29va2llIGF0IHRoZSB3aWRlc3QgZG9tYWluXG4gKiAgICAgICBzY29wZSBhbGxvd2VkIGJ5IHRoZSBicm93c2VyLiBFLmcuIG9uIGV4YW1wbGUuY29tIGlmIHdlIGFyZSBjdXJyZW50bHlcbiAqICAgICAgIG9uIHd3dy5leGFtcGxlLmNvbS5cbiAqICAgICAtIGRvbWFpbjogRXhwbGljaXQgZG9tYWluIHRvIHNldC5cbiAqICAgICAtIGFsbG93T25Qcm94eU9yaWdpbjogQWxsb3cgc2V0dGluZyBhIGNvb2tpZSBvbiB0aGUgQU1QIENhY2hlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0Q29va2llKHdpbiwgbmFtZSwgdmFsdWUsIGV4cGlyYXRpb25UaW1lLCBvcHRfb3B0aW9ucykge1xuICBjaGVja09yaWdpbkZvclNldHRpbmdDb29raWUod2luLCBvcHRfb3B0aW9ucywgbmFtZSk7XG4gIGlmIChvcHRfb3B0aW9ucyAmJiBvcHRfb3B0aW9ucy5oaWdoZXN0QXZhaWxhYmxlRG9tYWluKSB7XG4gICAgY29uc3QgcGFydHMgPSB3aW4ubG9jYXRpb24uaG9zdG5hbWUuc3BsaXQoJy4nKTtcbiAgICBsZXQgZG9tYWluID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMV07XG4gICAgZm9yIChsZXQgaSA9IHBhcnRzLmxlbmd0aCAtIDI7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBkb21haW4gPSBwYXJ0c1tpXSArICcuJyArIGRvbWFpbjtcbiAgICAgIHRyeVNldENvb2tpZSh3aW4sIG5hbWUsIHZhbHVlLCBleHBpcmF0aW9uVGltZSwgZG9tYWluKTtcbiAgICAgIGlmIChnZXRDb29raWUod2luLCBuYW1lKSA9PSB2YWx1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGxldCBkb21haW4gPSB1bmRlZmluZWQ7XG4gIGlmIChvcHRfb3B0aW9ucyAmJiBvcHRfb3B0aW9ucy5kb21haW4pIHtcbiAgICBkb21haW4gPSBvcHRfb3B0aW9ucy5kb21haW47XG4gIH1cbiAgdHJ5U2V0Q29va2llKHdpbiwgbmFtZSwgdmFsdWUsIGV4cGlyYXRpb25UaW1lLCBkb21haW4pO1xufVxuXG4vKipcbiAqIEF0dGVtcHQgdG8gc2V0IGEgY29va2llIHdpdGggdGhlIGdpdmVuIHBhcmFtcy5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICogQHBhcmFtIHt0aW1lfSBleHBpcmF0aW9uVGltZVxuICogQHBhcmFtIHtzdHJpbmd8dW5kZWZpbmVkfSBkb21haW5cbiAqL1xuZnVuY3Rpb24gdHJ5U2V0Q29va2llKHdpbiwgbmFtZSwgdmFsdWUsIGV4cGlyYXRpb25UaW1lLCBkb21haW4pIHtcbiAgLy8gV2UgZG8gbm90IGFsbG93IHNldHRpbmcgY29va2llcyBvbiB0aGUgZG9tYWluIHRoYXQgY29udGFpbnMgYm90aFxuICAvLyB0aGUgY2RuLiBhbmQgd3d3LiBob3N0cy5cbiAgaWYgKGRvbWFpbiA9PSAnYW1wcHJvamVjdC5vcmcnKSB7XG4gICAgLy8gQWN0aXZlbHkgZGVsZXRlIHRoZW0uXG4gICAgdmFsdWUgPSAnZGVsZXRlJztcbiAgICBleHBpcmF0aW9uVGltZSA9IDA7XG4gIH1cbiAgY29uc3QgY29va2llID0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJz0nICtcbiAgICAgIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgK1xuICAgICAgJzsgcGF0aD0vJyArXG4gICAgICAoZG9tYWluID8gJzsgZG9tYWluPScgKyBkb21haW4gOiAnJykgK1xuICAgICAgJzsgZXhwaXJlcz0nICsgbmV3IERhdGUoZXhwaXJhdGlvblRpbWUpLnRvVVRDU3RyaW5nKCk7XG4gIHRyeSB7XG4gICAgd2luLmRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZTtcbiAgfSBjYXRjaCAoaWdub3JlKSB7XG4gICAgLy8gRG8gbm90IHRocm93IGlmIHNldHRpbmcgdGhlIGNvb2tpZSBmYWlsZWQgRXhjZXB0aW9ucyBjYW4gYmUgdGhyb3duXG4gICAgLy8gd2hlbiBBTVAgZG9jcyBhcmUgb3BlbmVkIG9uIG9yaWdpbnMgdGhhdCBkbyBub3QgYWxsb3cgc2V0dGluZ1xuICAgIC8vIGNvb2tpZXMgc3VjaCBhcyBudWxsIG9yaWdpbnMuXG4gIH1cbn1cblxuLyoqXG4gKiBUaHJvd3MgaWYgYSBnaXZlbiBjb29raWUgc2hvdWxkIG5vdCBiZSBzZXQgb24gdGhlIGdpdmVuIG9yaWdpbi5cbiAqIFRoaXMgaXMgYSBkZWZlbnNlLWluLWRlcHRoLiBDYWxsZXJzIHNob3VsZCBuZXZlciBydW4gaW50byB0aGlzLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFPYmplY3R8dW5kZWZpbmVkfSBvcHRpb25zXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBGb3IgdGhlIGVycm9yIG1lc3NhZ2UuXG4gKi9cbmZ1bmN0aW9uIGNoZWNrT3JpZ2luRm9yU2V0dGluZ0Nvb2tpZSh3aW4sIG9wdGlvbnMsIG5hbWUpIHtcbiAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5hbGxvd09uUHJveHlPcmlnaW4pIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGlzUHJveHlPcmlnaW4od2luLmxvY2F0aW9uLmhyZWYpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdTaG91bGQgbmV2ZXIgYXR0ZW1wdCB0byBzZXQgY29va2llIG9uIHByb3h5IG9yaWdpbjogJ1xuICAgICAgICArIG5hbWUpO1xuICB9XG5cbiAgY29uc3QgY3VycmVudCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh3aW4ubG9jYXRpb24uaHJlZikuaG9zdG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgcHJveHkgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJscy5jZG4pLmhvc3RuYW1lLnRvTG93ZXJDYXNlKCk7XG4gIGlmIChjdXJyZW50ID09IHByb3h5IHx8IGVuZHNXaXRoKGN1cnJlbnQsICcuJyArIHByb3h5KSkge1xuICAgIHRocm93IG5ldyBFcnJvcignU2hvdWxkIG5ldmVyIGF0dGVtcHQgdG8gc2V0IGNvb2tpZSBvbiBwcm94eSBvcmlnaW4uJ1xuICAgICAgICArICcgKGluIGRlcHRoIGNoZWNrKTogJyArIG5hbWUpO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtEZWZlcnJlZH0gZnJvbSAnLi91dGlscy9wcm9taXNlJztcbmltcG9ydCB7Y3NzRXNjYXBlfSBmcm9tICcuLi90aGlyZF9wYXJ0eS9jc3MtZXNjYXBlL2Nzcy1lc2NhcGUnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7ZGljdH0gZnJvbSAnLi91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtzdGFydHNXaXRofSBmcm9tICcuL3N0cmluZyc7XG5pbXBvcnQge3RvV2lufSBmcm9tICcuL3R5cGVzJztcblxuY29uc3QgSFRNTF9FU0NBUEVfQ0hBUlMgPSB7XG4gICcmJzogJyZhbXA7JyxcbiAgJzwnOiAnJmx0OycsXG4gICc+JzogJyZndDsnLFxuICAnXCInOiAnJnF1b3Q7JyxcbiAgXCInXCI6ICcmI3gyNzsnLFxuICAnYCc6ICcmI3g2MDsnLFxufTtcbmNvbnN0IEhUTUxfRVNDQVBFX1JFR0VYID0gLygmfDx8PnxcInwnfGApL2c7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUFJPTUlTRSA9XG4gICAgJ19fQU1QX1VQR19QUk0nO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1JFU09MVkVSID1cbiAgICAnX19BTVBfVVBHX1JFUyc7XG5cbi8qKlxuICogV2FpdHMgdW50aWwgdGhlIGNoaWxkIGVsZW1lbnQgaXMgY29uc3RydWN0ZWQuIE9uY2UgdGhlIGNoaWxkIGlzIGZvdW5kLCB0aGVcbiAqIGNhbGxiYWNrIGlzIGV4ZWN1dGVkLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjaGVja0Z1bmNcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gY2FsbGJhY2tcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JDaGlsZChwYXJlbnQsIGNoZWNrRnVuYywgY2FsbGJhY2spIHtcbiAgaWYgKGNoZWNrRnVuYyhwYXJlbnQpKSB7XG4gICAgY2FsbGJhY2soKTtcbiAgICByZXR1cm47XG4gIH1cbiAgLyoqIEBjb25zdCB7IVdpbmRvd30gKi9cbiAgY29uc3Qgd2luID0gdG9XaW4ocGFyZW50Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcpO1xuICBpZiAod2luLk11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAvKiogQGNvbnN0IHtNdXRhdGlvbk9ic2VydmVyfSAqL1xuICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IHdpbi5NdXRhdGlvbk9ic2VydmVyKCgpID0+IHtcbiAgICAgIGlmIChjaGVja0Z1bmMocGFyZW50KSkge1xuICAgICAgICBvYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZShwYXJlbnQsIHtjaGlsZExpc3Q6IHRydWV9KTtcbiAgfSBlbHNlIHtcbiAgICAvKiogQGNvbnN0IHtudW1iZXJ9ICovXG4gICAgY29uc3QgaW50ZXJ2YWwgPSB3aW4uc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYgKGNoZWNrRnVuYyhwYXJlbnQpKSB7XG4gICAgICAgIHdpbi5jbGVhckludGVydmFsKGludGVydmFsKTtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH1cbiAgICB9LCAvKiBtaWxsaXNlY29uZHMgKi8gNSk7XG4gIH1cbn1cblxuLyoqXG4gKiBXYWl0cyB1bnRpbCB0aGUgY2hpbGQgZWxlbWVudCBpcyBjb25zdHJ1Y3RlZC4gT25jZSB0aGUgY2hpbGQgaXMgZm91bmQsIHRoZVxuICogcHJvbWlzZSBpcyByZXNvbHZlZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2hlY2tGdW5jXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JDaGlsZFByb21pc2UocGFyZW50LCBjaGVja0Z1bmMpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgIHdhaXRGb3JDaGlsZChwYXJlbnQsIGNoZWNrRnVuYywgcmVzb2x2ZSk7XG4gIH0pO1xufVxuXG4vKipcbiAqIFdhaXRzIGZvciBkb2N1bWVudCdzIGJvZHkgdG8gYmUgYXZhaWxhYmxlLlxuICogV2lsbCBiZSBkZXByZWNhdGVkIHNvb247IHVzZSB7QGxpbmsgQW1wRG9jI3doZW5Cb2R5QXZhaWxhYmxlfSBvclxuICogQHtsaW5rIERvY3VtZW50U3RhdGUjb25Cb2R5QXZhaWxhYmxlfSBpbnN0ZWFkLlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHBhcmFtIHtmdW5jdGlvbigpfSBjYWxsYmFja1xuICovXG5leHBvcnQgZnVuY3Rpb24gd2FpdEZvckJvZHkoZG9jLCBjYWxsYmFjaykge1xuICB3YWl0Rm9yQ2hpbGQoZG9jLmRvY3VtZW50RWxlbWVudCwgKCkgPT4gISFkb2MuYm9keSwgY2FsbGJhY2spO1xufVxuXG5cbi8qKlxuICogV2FpdHMgZm9yIGRvY3VtZW50J3MgYm9keSB0byBiZSBhdmFpbGFibGUuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JCb2R5UHJvbWlzZShkb2MpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgIHdhaXRGb3JCb2R5KGRvYywgcmVzb2x2ZSk7XG4gIH0pO1xufVxuXG5cbi8qKlxuICogUmVtb3ZlcyB0aGUgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUVsZW1lbnQoZWxlbWVudCkge1xuICBpZiAoZWxlbWVudC5wYXJlbnRFbGVtZW50KSB7XG4gICAgZWxlbWVudC5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZW1vdmVzIGFsbCBjaGlsZCBub2RlcyBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUNoaWxkcmVuKHBhcmVudCkge1xuICB3aGlsZSAocGFyZW50LmZpcnN0Q2hpbGQpIHtcbiAgICBwYXJlbnQucmVtb3ZlQ2hpbGQocGFyZW50LmZpcnN0Q2hpbGQpO1xuICB9XG59XG5cblxuLyoqXG4gKiBDb3BpZXMgYWxsIGNoaWxkcmVuIG5vZGVzIG9mIGVsZW1lbnQgXCJmcm9tXCIgdG8gZWxlbWVudCBcInRvXCIuIENoaWxkIG5vZGVzXG4gKiBhcmUgZGVlcGx5IGNsb25lZC4gTm90aWNlLCB0aGF0IHRoaXMgbWV0aG9kIHNob3VsZCBiZSB1c2VkIHdpdGggY2FyZSBhbmRcbiAqIHByZWZlcmFibHkgb24gc21hbGxlciBzdWJ0cmVlcy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGZyb21cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IURvY3VtZW50RnJhZ21lbnR9IHRvXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb3B5Q2hpbGRyZW4oZnJvbSwgdG8pIHtcbiAgY29uc3QgZnJhZyA9IHRvLm93bmVyRG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICBmb3IgKGxldCBuID0gZnJvbS5maXJzdENoaWxkOyBuOyBuID0gbi5uZXh0U2libGluZykge1xuICAgIGZyYWcuYXBwZW5kQ2hpbGQobi5jbG9uZU5vZGUodHJ1ZSkpO1xuICB9XG4gIHRvLmFwcGVuZENoaWxkKGZyYWcpO1xufVxuXG4vKipcbiAqIEluc2VydCB0aGUgZWxlbWVudCBpbiB0aGUgcm9vdCBhZnRlciB0aGUgZWxlbWVudCBuYW1lZCBhZnRlciBvclxuICogaWYgdGhhdCBpcyBudWxsIGF0IHRoZSBiZWdpbm5pbmcuXG4gKiBAcGFyYW0geyFFbGVtZW50fCFTaGFkb3dSb290fSByb290XG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0gez9Ob2RlfSBhZnRlclxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zZXJ0QWZ0ZXJPckF0U3RhcnQocm9vdCwgZWxlbWVudCwgYWZ0ZXIpIHtcbiAgY29uc3QgYmVmb3JlID0gYWZ0ZXIgPyBhZnRlci5uZXh0U2libGluZyA6IHJvb3QuZmlyc3RDaGlsZDtcbiAgcm9vdC5pbnNlcnRCZWZvcmUoZWxlbWVudCwgYmVmb3JlKTtcbn1cblxuLyoqXG4gKiBBZGQgYXR0cmlidXRlcyB0byBhbiBlbGVtZW50LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHshSnNvbk9iamVjdDxzdHJpbmcsIHN0cmluZz59IGF0dHJpYnV0ZXNcbiAqIEByZXR1cm4geyFFbGVtZW50fSBjcmVhdGVkIGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZEF0dHJpYnV0ZXNUb0VsZW1lbnQoZWxlbWVudCwgYXR0cmlidXRlcykge1xuICBmb3IgKGNvbnN0IGF0dHIgaW4gYXR0cmlidXRlcykge1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKGF0dHIsIGF0dHJpYnV0ZXNbYXR0cl0pO1xuICB9XG4gIHJldHVybiBlbGVtZW50O1xufVxuXG4vKipcbiAqIENyZWF0ZSBhIG5ldyBlbGVtZW50IG9uIGRvY3VtZW50IHdpdGggc3BlY2lmaWVkIHRhZ05hbWUgYW5kIGF0dHJpYnV0ZXMuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHBhcmFtIHshSnNvbk9iamVjdDxzdHJpbmcsIHN0cmluZz59IGF0dHJpYnV0ZXNcbiAqIEByZXR1cm4geyFFbGVtZW50fSBjcmVhdGVkIGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnRXaXRoQXR0cmlidXRlcyhkb2MsIHRhZ05hbWUsIGF0dHJpYnV0ZXMpIHtcbiAgY29uc3QgZWxlbWVudCA9IGRvYy5jcmVhdGVFbGVtZW50KHRhZ05hbWUpO1xuICByZXR1cm4gYWRkQXR0cmlidXRlc1RvRWxlbWVudChlbGVtZW50LCBhdHRyaWJ1dGVzKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgbm9kZSBpcyBjb25uZWN0ZWQgKGF0dGFjaGVkKS5cbiAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAc2VlIGh0dHBzOi8vZG9tLnNwZWMud2hhdHdnLm9yZy8jY29ubmVjdGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Nvbm5lY3RlZE5vZGUobm9kZSkge1xuICBjb25zdCBjb25uZWN0ZWQgPSBub2RlLmlzQ29ubmVjdGVkO1xuICBpZiAoY29ubmVjdGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gY29ubmVjdGVkO1xuICB9XG5cbiAgLy8gXCJBbiBlbGVtZW50IGlzIGNvbm5lY3RlZCBpZiBpdHMgc2hhZG93LWluY2x1ZGluZyByb290IGlzIGEgZG9jdW1lbnQuXCJcbiAgbGV0IG4gPSBub2RlO1xuICBkbyB7XG4gICAgbiA9IHJvb3ROb2RlRm9yKG4pO1xuICAgIGlmIChuLmhvc3QpIHtcbiAgICAgIG4gPSBuLmhvc3Q7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfSB3aGlsZSAodHJ1ZSk7XG4gIHJldHVybiBuLm5vZGVUeXBlID09PSBOb2RlLkRPQ1VNRU5UX05PREU7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgcm9vdCBmb3IgYSBnaXZlbiBub2RlLiBEb2VzIG5vdCBjcm9zcyBzaGFkb3cgRE9NIGJvdW5kYXJ5LlxuICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICogQHJldHVybiB7IU5vZGV9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByb290Tm9kZUZvcihub2RlKSB7XG4gIGlmIChOb2RlLnByb3RvdHlwZS5nZXRSb290Tm9kZSkge1xuICAgIC8vIFR5cGUgY2hlY2tlciBzYXlzIGBnZXRSb290Tm9kZWAgbWF5IHJldHVybiBudWxsLlxuICAgIHJldHVybiBub2RlLmdldFJvb3ROb2RlKCkgfHwgbm9kZTtcbiAgfVxuICBsZXQgbjtcbiAgZm9yIChuID0gbm9kZTsgISFuLnBhcmVudE5vZGU7IG4gPSBuLnBhcmVudE5vZGUpIHt9XG4gIHJldHVybiBuO1xufVxuXG4vKipcbiAqIEZpbmRzIHRoZSBjbG9zZXN0IGVsZW1lbnQgdGhhdCBzYXRpc2ZpZXMgdGhlIGNhbGxiYWNrIGZyb20gdGhpcyBlbGVtZW50XG4gKiB1cCB0aGUgRE9NIHN1YnRyZWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjYWxsYmFja1xuICogQHBhcmFtIHtFbGVtZW50PX0gb3B0X3N0b3BBdCBvcHRpb25hbCBlbGVtbnQgdG8gc3RvcCB0aGUgc2VhcmNoIGF0LlxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbG9zZXN0KGVsZW1lbnQsIGNhbGxiYWNrLCBvcHRfc3RvcEF0KSB7XG4gIGZvciAobGV0IGVsID0gZWxlbWVudDsgZWwgJiYgZWwgIT09IG9wdF9zdG9wQXQ7IGVsID0gZWwucGFyZW50RWxlbWVudCkge1xuICAgIGlmIChjYWxsYmFjayhlbCkpIHtcbiAgICAgIHJldHVybiBlbDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgY2xvc2VzdCBub2RlIHRoYXQgc2F0aXNmaWVzIHRoZSBjYWxsYmFjayBmcm9tIHRoaXMgbm9kZVxuICogdXAgdGhlIERPTSBzdWJ0cmVlLlxuICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICogQHBhcmFtIHtmdW5jdGlvbighTm9kZSk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEByZXR1cm4gez9Ob2RlfVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VzdE5vZGUobm9kZSwgY2FsbGJhY2spIHtcbiAgZm9yIChsZXQgbiA9IG5vZGU7IG47IG4gPSBuLnBhcmVudE5vZGUpIHtcbiAgICBpZiAoY2FsbGJhY2sobikpIHtcbiAgICAgIHJldHVybiBuO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBjbG9zZXN0IGVsZW1lbnQgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUgZnJvbSB0aGlzIGVsZW1lbnRcbiAqIHVwIHRoZSBET00gc3VidHJlZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsb3Nlc3RCeVRhZyhlbGVtZW50LCB0YWdOYW1lKSB7XG4gIGlmIChlbGVtZW50LmNsb3Nlc3QpIHtcbiAgICByZXR1cm4gZWxlbWVudC5jbG9zZXN0KHRhZ05hbWUpO1xuICB9XG4gIHRhZ05hbWUgPSB0YWdOYW1lLnRvVXBwZXJDYXNlKCk7XG4gIHJldHVybiBjbG9zZXN0KGVsZW1lbnQsIGVsID0+IHtcbiAgICByZXR1cm4gZWwudGFnTmFtZSA9PSB0YWdOYW1lO1xuICB9KTtcbn1cblxuLyoqXG4gKiBGaW5kcyB0aGUgY2xvc2VzdCBlbGVtZW50IHdpdGggdGhlIHNwZWNpZmllZCBzZWxlY3RvciBmcm9tIHRoaXMgZWxlbWVudFxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHNlbGVjdG9yXG4gKiBAcmV0dXJuIHs/RWxlbWVudH0gY2xvc2VzdCBhbmNlc3RvciBpZiBmb3VuZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsb3Nlc3RCeVNlbGVjdG9yKGVsZW1lbnQsIHNlbGVjdG9yKSB7XG4gIGlmIChlbGVtZW50LmNsb3Nlc3QpIHtcbiAgICByZXR1cm4gZWxlbWVudC5jbG9zZXN0KHNlbGVjdG9yKTtcbiAgfVxuXG4gIHJldHVybiBjbG9zZXN0KGVsZW1lbnQsIGVsID0+IHtcbiAgICByZXR1cm4gbWF0Y2hlcyhlbCwgc2VsZWN0b3IpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgdGhlIGdpdmVuIGVsZW1lbnQgbWF0Y2hlcyB0aGUgc2VsZWN0b3JcbiAqIEBwYXJhbSAgeyFFbGVtZW50fSBlbCBUaGUgZWxlbWVudCB0byB2ZXJpZnlcbiAqIEBwYXJhbSAge3N0cmluZ30gc2VsZWN0b3IgVGhlIHNlbGVjdG9yIHRvIGNoZWNrIGFnYWluc3RcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIGVsZW1lbnQgbWF0Y2hlZCB0aGUgc2VsZWN0b3IuIEZhbHNlIG90aGVyd2lzZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hdGNoZXMoZWwsIHNlbGVjdG9yKSB7XG4gIGNvbnN0IG1hdGNoZXIgPSBlbC5tYXRjaGVzIHx8XG4gICAgICBlbC53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHxcbiAgICAgIGVsLm1vek1hdGNoZXNTZWxlY3RvciB8fFxuICAgICAgZWwubXNNYXRjaGVzU2VsZWN0b3IgfHxcbiAgICAgIGVsLm9NYXRjaGVzU2VsZWN0b3I7XG4gIGlmIChtYXRjaGVyKSB7XG4gICAgcmV0dXJuIG1hdGNoZXIuY2FsbChlbCwgc2VsZWN0b3IpO1xuICB9XG4gIHJldHVybiBmYWxzZTsgLy8gSUU4IGFsd2F5cyByZXR1cm5zIGZhbHNlLlxufVxuXG4vKipcbiAqIEZpbmRzIHRoZSBmaXJzdCBkZXNjZW5kYW50IGVsZW1lbnQgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fCFEb2N1bWVudHwhU2hhZG93Um9vdH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWVcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZWxlbWVudEJ5VGFnKGVsZW1lbnQsIHRhZ05hbWUpIHtcbiAgbGV0IGVsZW1lbnRzO1xuICAvLyBnZXRFbGVtZW50c0J5VGFnTmFtZSgpIGlzIG5vdCBzdXBwb3J0ZWQgb24gU2hhZG93Um9vdC5cbiAgaWYgKHR5cGVvZiBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lID09PSAnZnVuY3Rpb24nKSB7XG4gICAgZWxlbWVudHMgPSBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhZ05hbWUpO1xuICB9IGVsc2Uge1xuICAgIGVsZW1lbnRzID0gZWxlbWVudC4vKk9LKi9xdWVyeVNlbGVjdG9yQWxsKHRhZ05hbWUpO1xuICB9XG4gIHJldHVybiAoZWxlbWVudHMgJiYgZWxlbWVudHNbMF0pIHx8IG51bGw7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgZmlyc3QgY2hpbGQgZWxlbWVudCB0aGF0IHNhdGlzZmllcyB0aGUgY2FsbGJhY2suXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IGNhbGxiYWNrXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudChwYXJlbnQsIGNhbGxiYWNrKSB7XG4gIGZvciAobGV0IGNoaWxkID0gcGFyZW50LmZpcnN0RWxlbWVudENoaWxkOyBjaGlsZDtcbiAgICBjaGlsZCA9IGNoaWxkLm5leHRFbGVtZW50U2libGluZykge1xuICAgIGlmIChjYWxsYmFjayhjaGlsZCkpIHtcbiAgICAgIHJldHVybiBjaGlsZDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuLyoqXG4gKiBGaW5kcyBhbGwgY2hpbGQgZWxlbWVudHMgdGhhdCBzYXRpc2Z5IHRoZSBjYWxsYmFjay5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEByZXR1cm4geyFBcnJheTwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnRzKHBhcmVudCwgY2FsbGJhY2spIHtcbiAgY29uc3QgY2hpbGRyZW4gPSBbXTtcbiAgZm9yIChsZXQgY2hpbGQgPSBwYXJlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7IGNoaWxkO1xuICAgIGNoaWxkID0gY2hpbGQubmV4dEVsZW1lbnRTaWJsaW5nKSB7XG4gICAgaWYgKGNhbGxiYWNrKGNoaWxkKSkge1xuICAgICAgY2hpbGRyZW4ucHVzaChjaGlsZCk7XG4gICAgfVxuICB9XG4gIHJldHVybiBjaGlsZHJlbjtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBsYXN0IGNoaWxkIGVsZW1lbnQgdGhhdCBzYXRpc2ZpZXMgdGhlIGNhbGxiYWNrLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjYWxsYmFja1xuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXN0Q2hpbGRFbGVtZW50KHBhcmVudCwgY2FsbGJhY2spIHtcbiAgZm9yIChsZXQgY2hpbGQgPSBwYXJlbnQubGFzdEVsZW1lbnRDaGlsZDsgY2hpbGQ7XG4gICAgY2hpbGQgPSBjaGlsZC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKSB7XG4gICAgaWYgKGNhbGxiYWNrKGNoaWxkKSkge1xuICAgICAgcmV0dXJuIGNoaWxkO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBGaW5kcyBhbGwgY2hpbGQgbm9kZXMgdGhhdCBzYXRpc2Z5IHRoZSBjYWxsYmFjay5cbiAqIFRoZXNlIG5vZGVzIGNhbiBpbmNsdWRlIFRleHQsIENvbW1lbnQgYW5kIG90aGVyIGNoaWxkIG5vZGVzLlxuICogQHBhcmFtIHshTm9kZX0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFOb2RlKTpib29sZWFufSBjYWxsYmFja1xuICogQHJldHVybiB7IUFycmF5PCFOb2RlPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkTm9kZXMocGFyZW50LCBjYWxsYmFjaykge1xuICBjb25zdCBub2RlcyA9IFtdO1xuICBmb3IgKGxldCBjaGlsZCA9IHBhcmVudC5maXJzdENoaWxkOyBjaGlsZDtcbiAgICBjaGlsZCA9IGNoaWxkLm5leHRTaWJsaW5nKSB7XG4gICAgaWYgKGNhbGxiYWNrKGNoaWxkKSkge1xuICAgICAgbm9kZXMucHVzaChjaGlsZCk7XG4gICAgfVxuICB9XG4gIHJldHVybiBub2Rlcztcbn1cblxuLyoqXG4gKiBAdHlwZSB7Ym9vbGVhbnx1bmRlZmluZWR9XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xubGV0IHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQ7XG5cbi8qKlxuICogQHBhcmFtIHtib29sZWFufHVuZGVmaW5lZH0gdmFsXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFNjb3BlU2VsZWN0b3JTdXBwb3J0ZWRGb3JUZXN0aW5nKHZhbCkge1xuICBzY29wZVNlbGVjdG9yU3VwcG9ydGVkID0gdmFsO1xufVxuXG4vKipcbiAqIFRlc3QgdGhhdCB0aGUgOnNjb3BlIHNlbGVjdG9yIGlzIHN1cHBvcnRlZCBhbmQgYmVoYXZlcyBjb3JyZWN0bHkuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzU2NvcGVTZWxlY3RvclN1cHBvcnRlZChwYXJlbnQpIHtcbiAgY29uc3QgZG9jID0gcGFyZW50Lm93bmVyRG9jdW1lbnQ7XG4gIHRyeSB7XG4gICAgY29uc3QgdGVzdEVsZW1lbnQgPSBkb2MuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgdGVzdENoaWxkID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRlc3RFbGVtZW50LmFwcGVuZENoaWxkKHRlc3RDaGlsZCk7XG4gICAgLy8gTk9URShjdmlhbGl6LCAjMTIzODMpOiBGaXJlZm94J3MgaW1wbGVtZW50YXRpb24gaXMgaW5jb21wbGV0ZSxcbiAgICAvLyB0aGVyZWZvcmUgd2UgdGVzdCBhY3R1YWwgZnVuY3Rpb25hbGl0eSBvZmA6c2NvcGVgIGFzIHdlbGwuXG4gICAgcmV0dXJuIHRlc3RFbGVtZW50Li8qT0sqL3F1ZXJ5U2VsZWN0b3IoJzpzY29wZSBkaXYnKSA9PT0gdGVzdENoaWxkO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8qKlxuICogRmluZHMgdGhlIGZpcnN0IGNoaWxkIGVsZW1lbnQgdGhhdCBoYXMgdGhlIHNwZWNpZmllZCBhdHRyaWJ1dGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudEJ5QXR0cihwYXJlbnQsIGF0dHIpIHtcbiAgcmV0dXJuIHNjb3BlZFF1ZXJ5U2VsZWN0b3IvKk9LKi8ocGFyZW50LCBgPiBbJHthdHRyfV1gKTtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBsYXN0IGNoaWxkIGVsZW1lbnQgdGhhdCBoYXMgdGhlIHNwZWNpZmllZCBhdHRyaWJ1dGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxhc3RDaGlsZEVsZW1lbnRCeUF0dHIocGFyZW50LCBhdHRyKSB7XG4gIHJldHVybiBsYXN0Q2hpbGRFbGVtZW50KHBhcmVudCwgZWwgPT4ge1xuICAgIHJldHVybiBlbC5oYXNBdHRyaWJ1dGUoYXR0cik7XG4gIH0pO1xufVxuXG5cbi8qKlxuICogRmluZHMgYWxsIGNoaWxkIGVsZW1lbnRzIHRoYXQgaGFzIHRoZSBzcGVjaWZpZWQgYXR0cmlidXRlLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gYXR0clxuICogQHJldHVybiB7IU5vZGVMaXN0PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudHNCeUF0dHIocGFyZW50LCBhdHRyKSB7XG4gIHJldHVybiBzY29wZWRRdWVyeVNlbGVjdG9yQWxsLypPSyovKHBhcmVudCwgYD4gWyR7YXR0cn1dYCk7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgZmlyc3QgY2hpbGQgZWxlbWVudCB0aGF0IGhhcyB0aGUgc3BlY2lmaWVkIHRhZyBuYW1lLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnRCeVRhZyhwYXJlbnQsIHRhZ05hbWUpIHtcbiAgcmV0dXJuIHNjb3BlZFF1ZXJ5U2VsZWN0b3IvKk9LKi8ocGFyZW50LCBgPiAke3RhZ05hbWV9YCk7XG59XG5cblxuLyoqXG4gKiBGaW5kcyBhbGwgY2hpbGQgZWxlbWVudHMgd2l0aCB0aGUgc3BlY2lmaWVkIHRhZyBuYW1lLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7IU5vZGVMaXN0PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudHNCeVRhZyhwYXJlbnQsIHRhZ05hbWUpIHtcbiAgcmV0dXJuIHNjb3BlZFF1ZXJ5U2VsZWN0b3JBbGwvKk9LKi8ocGFyZW50LCBgPiAke3RhZ05hbWV9YCk7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgZmlyc3QgZWxlbWVudCB0aGF0IG1hdGNoZXMgYHNlbGVjdG9yYCwgc2NvcGVkIGluc2lkZSBgcm9vdGAuXG4gKiBOb3RlOiBpbiBJRSwgdGhpcyBjYXVzZXMgYSBxdWljayBtdXRhdGlvbiBvZiB0aGUgZWxlbWVudCdzIGNsYXNzIGxpc3QuXG4gKiBAcGFyYW0geyFFbGVtZW50fSByb290XG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2NvcGVkUXVlcnlTZWxlY3Rvcihyb290LCBzZWxlY3Rvcikge1xuICBpZiAoc2NvcGVTZWxlY3RvclN1cHBvcnRlZCA9PSBudWxsKSB7XG4gICAgc2NvcGVTZWxlY3RvclN1cHBvcnRlZCA9IGlzU2NvcGVTZWxlY3RvclN1cHBvcnRlZChyb290KTtcbiAgfVxuICBpZiAoc2NvcGVTZWxlY3RvclN1cHBvcnRlZCkge1xuICAgIHJldHVybiByb290Li8qT0sqL3F1ZXJ5U2VsZWN0b3IoYDpzY29wZSAke3NlbGVjdG9yfWApO1xuICB9XG5cbiAgLy8gT25seSBJRS5cbiAgY29uc3QgdW5pcXVlID0gJ2ktYW1waHRtbC1zY29wZWQnO1xuICByb290LmNsYXNzTGlzdC5hZGQodW5pcXVlKTtcbiAgY29uc3QgZWxlbWVudCA9IHJvb3QuLypPSyovcXVlcnlTZWxlY3RvcihgLiR7dW5pcXVlfSAke3NlbGVjdG9yfWApO1xuICByb290LmNsYXNzTGlzdC5yZW1vdmUodW5pcXVlKTtcbiAgcmV0dXJuIGVsZW1lbnQ7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgZXZlcnkgZWxlbWVudCB0aGF0IG1hdGNoZXMgYHNlbGVjdG9yYCwgc2NvcGVkIGluc2lkZSBgcm9vdGAuXG4gKiBOb3RlOiBpbiBJRSwgdGhpcyBjYXVzZXMgYSBxdWljayBtdXRhdGlvbiBvZiB0aGUgZWxlbWVudCdzIGNsYXNzIGxpc3QuXG4gKiBAcGFyYW0geyFFbGVtZW50fSByb290XG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcbiAqIEByZXR1cm4geyFOb2RlTGlzdDwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzY29wZWRRdWVyeVNlbGVjdG9yQWxsKHJvb3QsIHNlbGVjdG9yKSB7XG4gIGlmIChzY29wZVNlbGVjdG9yU3VwcG9ydGVkID09IG51bGwpIHtcbiAgICBzY29wZVNlbGVjdG9yU3VwcG9ydGVkID0gaXNTY29wZVNlbGVjdG9yU3VwcG9ydGVkKHJvb3QpO1xuICB9XG4gIGlmIChzY29wZVNlbGVjdG9yU3VwcG9ydGVkKSB7XG4gICAgcmV0dXJuIHJvb3QuLypPSyovcXVlcnlTZWxlY3RvckFsbChgOnNjb3BlICR7c2VsZWN0b3J9YCk7XG4gIH1cblxuICAvLyBPbmx5IElFLlxuICBjb25zdCB1bmlxdWUgPSAnaS1hbXBodG1sLXNjb3BlZCc7XG4gIHJvb3QuY2xhc3NMaXN0LmFkZCh1bmlxdWUpO1xuICBjb25zdCBlbGVtZW50cyA9IHJvb3QuLypPSyovcXVlcnlTZWxlY3RvckFsbChgLiR7dW5pcXVlfSAke3NlbGVjdG9yfWApO1xuICByb290LmNsYXNzTGlzdC5yZW1vdmUodW5pcXVlKTtcbiAgcmV0dXJuIGVsZW1lbnRzO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBlbGVtZW50IGRhdGEtcGFyYW0tIGF0dHJpYnV0ZXMgYXMgdXJsIHBhcmFtZXRlcnMga2V5LXZhbHVlIHBhaXJzLlxuICogZS5nLiBkYXRhLXBhcmFtLXNvbWUtYXR0cj12YWx1ZSAtPiB7c29tZUF0dHI6IHZhbHVlfS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nKTpzdHJpbmc9fSBvcHRfY29tcHV0ZVBhcmFtTmFtZUZ1bmMgdG8gY29tcHV0ZSB0aGVcbiAqICAgIHBhcmFtZXRlciBuYW1lLCBnZXQgcGFzc2VkIHRoZSBjYW1lbC1jYXNlIHBhcmFtZXRlciBuYW1lLlxuICogQHBhcmFtIHshUmVnRXhwPX0gb3B0X3BhcmFtUGF0dGVybiBSZWdleCBwYXR0ZXJuIHRvIG1hdGNoIGRhdGEgYXR0cmlidXRlcy5cbiAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGF0YVBhcmFtc0Zyb21BdHRyaWJ1dGVzKGVsZW1lbnQsIG9wdF9jb21wdXRlUGFyYW1OYW1lRnVuYyxcbiAgb3B0X3BhcmFtUGF0dGVybikge1xuICBjb25zdCBjb21wdXRlUGFyYW1OYW1lRnVuYyA9IG9wdF9jb21wdXRlUGFyYW1OYW1lRnVuYyB8fCAoa2V5ID0+IGtleSk7XG4gIGNvbnN0IHtkYXRhc2V0fSA9IGVsZW1lbnQ7XG4gIGNvbnN0IHBhcmFtcyA9IGRpY3QoKTtcbiAgY29uc3QgcGFyYW1QYXR0ZXJuID0gb3B0X3BhcmFtUGF0dGVybiA/IG9wdF9wYXJhbVBhdHRlcm4gOiAvXnBhcmFtKC4rKS87XG4gIGZvciAoY29uc3Qga2V5IGluIGRhdGFzZXQpIHtcbiAgICBjb25zdCBtYXRjaGVzID0ga2V5Lm1hdGNoKHBhcmFtUGF0dGVybik7XG4gICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgIGNvbnN0IHBhcmFtID0gbWF0Y2hlc1sxXVswXS50b0xvd2VyQ2FzZSgpICsgbWF0Y2hlc1sxXS5zdWJzdHIoMSk7XG4gICAgICBwYXJhbXNbY29tcHV0ZVBhcmFtTmFtZUZ1bmMocGFyYW0pXSA9IGRhdGFzZXRba2V5XTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBhcmFtcztcbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBlbGVtZW50IGhhdmUgYSBuZXh0IG5vZGUgaW4gdGhlIGRvY3VtZW50IG9yZGVyLlxuICogVGhpcyBtZWFucyBlaXRoZXI6XG4gKiAgYS4gVGhlIGVsZW1lbnQgaXRzZWxmIGhhcyBhIG5leHRTaWJsaW5nLlxuICogIGIuIEFueSBvZiB0aGUgZWxlbWVudCBhbmNlc3RvcnMgaGFzIGEgbmV4dFNpYmxpbmcuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0gez9Ob2RlfSBvcHRfc3RvcE5vZGVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoYXNOZXh0Tm9kZUluRG9jdW1lbnRPcmRlcihlbGVtZW50LCBvcHRfc3RvcE5vZGUpIHtcbiAgbGV0IGN1cnJlbnRFbGVtZW50ID0gZWxlbWVudDtcbiAgZG8ge1xuICAgIGlmIChjdXJyZW50RWxlbWVudC5uZXh0U2libGluZykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9IHdoaWxlICgoY3VycmVudEVsZW1lbnQgPSBjdXJyZW50RWxlbWVudC5wYXJlbnROb2RlKSAmJlxuICAgICAgICAgICAgY3VycmVudEVsZW1lbnQgIT0gb3B0X3N0b3BOb2RlKTtcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5cbi8qKlxuICogRmluZHMgYWxsIGFuY2VzdG9yIGVsZW1lbnRzIHRoYXQgc2F0aXNmeSBwcmVkaWNhdGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBjaGlsZFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gcHJlZGljYXRlXG4gKiBAcmV0dXJuIHshQXJyYXk8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gYW5jZXN0b3JFbGVtZW50cyhjaGlsZCwgcHJlZGljYXRlKSB7XG4gIGNvbnN0IGFuY2VzdG9ycyA9IFtdO1xuICBmb3IgKGxldCBhbmNlc3RvciA9IGNoaWxkLnBhcmVudEVsZW1lbnQ7IGFuY2VzdG9yO1xuICAgIGFuY2VzdG9yID0gYW5jZXN0b3IucGFyZW50RWxlbWVudCkge1xuICAgIGlmIChwcmVkaWNhdGUoYW5jZXN0b3IpKSB7XG4gICAgICBhbmNlc3RvcnMucHVzaChhbmNlc3Rvcik7XG4gICAgfVxuICB9XG4gIHJldHVybiBhbmNlc3RvcnM7XG59XG5cblxuLyoqXG4gKiBGaW5kcyBhbGwgYW5jZXN0b3IgZWxlbWVudHMgdGhhdCBoYXMgdGhlIHNwZWNpZmllZCB0YWcgbmFtZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGNoaWxkXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7IUFycmF5PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFuY2VzdG9yRWxlbWVudHNCeVRhZyhjaGlsZCwgdGFnTmFtZSkge1xuICB0YWdOYW1lID0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xuICByZXR1cm4gYW5jZXN0b3JFbGVtZW50cyhjaGlsZCwgZWwgPT4ge1xuICAgIHJldHVybiBlbC50YWdOYW1lID09IHRhZ05hbWU7XG4gIH0pO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBjbG9uZSBvZiB0aGUgY29udGVudCBvZiBhIHRlbXBsYXRlIGVsZW1lbnQuXG4gKlxuICogUG9seWZpbGwgdG8gcmVwbGFjZSAuY29udGVudCBhY2Nlc3MgZm9yIGJyb3dzZXJzIHRoYXQgZG8gbm90IHN1cHBvcnRcbiAqIEhUTUxUZW1wbGF0ZUVsZW1lbnRzIG5hdGl2ZWx5LlxuICpcbiAqIEBwYXJhbSB7IUhUTUxUZW1wbGF0ZUVsZW1lbnR8IUVsZW1lbnR9IHRlbXBsYXRlXG4gKiBAcmV0dXJuIHshRG9jdW1lbnRGcmFnbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRlbXBsYXRlQ29udGVudENsb25lKHRlbXBsYXRlKSB7XG4gIGlmICgnY29udGVudCcgaW4gdGVtcGxhdGUpIHtcbiAgICByZXR1cm4gdGVtcGxhdGUuY29udGVudC5jbG9uZU5vZGUodHJ1ZSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgY29udGVudCA9IHRlbXBsYXRlLm93bmVyRG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIGNvcHlDaGlsZHJlbih0ZW1wbGF0ZSwgY29udGVudCk7XG4gICAgcmV0dXJuIGNvbnRlbnQ7XG4gIH1cbn1cblxuLyoqXG4gKiBJdGVyYXRlIG92ZXIgYW4gYXJyYXktbGlrZS4gU29tZSBjb2xsZWN0aW9ucyBsaWtlIE5vZGVMaXN0IGFyZVxuICogbGF6aWx5IGV2YWx1YXRlZCBpbiBzb21lIGJyb3dzZXJzLCBhbmQgYWNjZXNzaW5nIGBsZW5ndGhgIGZvcmNlcyBmdWxsXG4gKiBldmFsdWF0aW9uLiBXZSBjYW4gaW1wcm92ZSBwZXJmb3JtYW5jZSBieSBpdGVyYXRpbmcgdW50aWwgYW4gZWxlbWVudCBpc1xuICogYHVuZGVmaW5lZGAgdG8gYXZvaWQgY2hlY2tpbmcgdGhlIGBsZW5ndGhgIHByb3BlcnR5LlxuICogVGVzdCBjYXNlczogaHR0cHM6Ly9qc3BlcmYuY29tL2l0ZXJhdGluZy1vdmVyLWNvbGxlY3Rpb25zLW9mLWVsZW1lbnRzXG4gKiBAcGFyYW0geyFJQXJyYXlMaWtlPFQ+fSBpdGVyYWJsZVxuICogQHBhcmFtIHtmdW5jdGlvbihULCBudW1iZXIpfSBjYlxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGl0ZXJhdGVDdXJzb3IoaXRlcmFibGUsIGNiKSB7XG4gIGZvciAobGV0IGkgPSAwLCB2YWx1ZTsgKHZhbHVlID0gaXRlcmFibGVbaV0pICE9PSB1bmRlZmluZWQ7IGkrKykge1xuICAgIGNiKHZhbHVlLCBpKTtcbiAgfVxufVxuXG4vKipcbiAqIFRoaXMgbWV0aG9kIHdyYXBzIGFyb3VuZCB3aW5kb3cncyBvcGVuIG1ldGhvZC4gSXQgZmlyc3QgdHJpZXMgdG8gZXhlY3V0ZVxuICogYG9wZW5gIGNhbGwgd2l0aCB0aGUgcHJvdmlkZWQgdGFyZ2V0IGFuZCBpZiBpdCBmYWlscywgaXQgcmV0cmllcyB0aGUgY2FsbFxuICogd2l0aCB0aGUgYF90b3BgIHRhcmdldC4gVGhpcyBpcyBuZWNlc3NhcnkgZ2l2ZW4gdGhhdCBpbiBzb21lIGVtYmVkZGluZ1xuICogc2NlbmFyaW9zLCBzdWNoIGFzIGlPUycgV0tXZWJWaWV3LCBuYXZpZ2F0aW9uIHRvIGBfYmxhbmtgIGFuZCBvdGhlciB0YXJnZXRzXG4gKiBpcyBibG9ja2VkIGJ5IGRlZmF1bHQuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YXJnZXRcbiAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X2ZlYXR1cmVzXG4gKiBAcmV0dXJuIHs/V2luZG93fVxuICovXG5leHBvcnQgZnVuY3Rpb24gb3BlbldpbmRvd0RpYWxvZyh3aW4sIHVybCwgdGFyZ2V0LCBvcHRfZmVhdHVyZXMpIHtcbiAgLy8gVHJ5IGZpcnN0IHdpdGggdGhlIHNwZWNpZmllZCB0YXJnZXQuIElmIHdlJ3JlIGluc2lkZSB0aGUgV0tXZWJWaWV3IG9yXG4gIC8vIGEgc2ltaWxhciBlbnZpcm9ubWVudHMsIHRoaXMgbWV0aG9kIGlzIGV4cGVjdGVkIHRvIGZhaWwgYnkgZGVmYXVsdCBmb3JcbiAgLy8gYWxsIHRhcmdldHMgZXhjZXB0IGBfdG9wYC5cbiAgbGV0IHJlcztcbiAgdHJ5IHtcbiAgICByZXMgPSB3aW4ub3Blbih1cmwsIHRhcmdldCwgb3B0X2ZlYXR1cmVzKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGRldigpLmVycm9yKCdET00nLCAnRmFpbGVkIHRvIG9wZW4gdXJsIG9uIHRhcmdldDogJywgdGFyZ2V0LCBlKTtcbiAgfVxuXG4gIC8vIFRoZW4gdHJ5IHdpdGggYF90b3BgIHRhcmdldC5cbiAgaWYgKCFyZXMgJiYgdGFyZ2V0ICE9ICdfdG9wJykge1xuICAgIHJlcyA9IHdpbi5vcGVuKHVybCwgJ190b3AnKTtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGVsZW1lbnQgaXMgYSBzY3JpcHQgdGFnIHdpdGggYXBwbGljYXRpb24vanNvbiB0eXBlLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzSnNvblNjcmlwdFRhZyhlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50LnRhZ05hbWUgPT0gJ1NDUklQVCcgJiZcbiAgICAgICAgICAgIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykudG9VcHBlckNhc2UoKSA9PSAnQVBQTElDQVRJT04vSlNPTic7XG59XG5cbi8qKlxuICogV2hldGhlciB0aGUgZWxlbWVudCBpcyBhIHNjcmlwdCB0YWcgd2l0aCBhcHBsaWNhdGlvbi9qc29uIHR5cGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNKc29uTGRTY3JpcHRUYWcoZWxlbWVudCkge1xuICByZXR1cm4gZWxlbWVudC50YWdOYW1lID09ICdTQ1JJUFQnICYmXG4gICAgICBlbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpLnRvVXBwZXJDYXNlKCkgPT0gJ0FQUExJQ0FUSU9OL0xEK0pTT04nO1xufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHBhZ2UncyBkaXJlY3Rpb24gaXMgcmlnaHQgdG8gbGVmdCBvciBub3QuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNSVEwoZG9jKSB7XG4gIGNvbnN0IGRpciA9IGRvYy5ib2R5LmdldEF0dHJpYnV0ZSgnZGlyJylcbiAgICAgICAgICAgICAgICAgfHwgZG9jLmRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RpcicpXG4gICAgICAgICAgICAgICAgIHx8ICdsdHInO1xuICByZXR1cm4gZGlyID09ICdydGwnO1xufVxuXG5cbi8qKlxuICogRXNjYXBlcyBhbiBpZGVudCAoSUQgb3IgYSBjbGFzcyBuYW1lKSB0byBiZSB1c2VkIGFzIGEgQ1NTIHNlbGVjdG9yLlxuICpcbiAqIFNlZSBodHRwczovL2RyYWZ0cy5jc3N3Zy5vcmcvY3Nzb20vI3NlcmlhbGl6ZS1hbi1pZGVudGlmaWVyLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZGVudFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXNjYXBlQ3NzU2VsZWN0b3JJZGVudChpZGVudCkge1xuICByZXR1cm4gY3NzRXNjYXBlKGlkZW50KTtcbn1cblxuLyoqXG4gKiBFc2NhcGVzIGFuIGlkZW50IGluIGEgd2F5IHRoYXQgY2FuIGJlIHVzZWQgYnkgOm50aC1jaGlsZCgpIHBzdWVkby1jbGFzcy5cbiAqXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3czYy9jc3N3Zy1kcmFmdHMvaXNzdWVzLzIzMDYuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfSBpZGVudFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXNjYXBlQ3NzU2VsZWN0b3JOdGgoaWRlbnQpIHtcbiAgY29uc3QgZXNjYXBlZCA9IFN0cmluZyhpZGVudCk7XG4gIC8vIEVuc3VyZSBpdCBkb2Vzbid0IGNsb3NlIHRoZSBudGgtY2hpbGQgcHN1ZWRvIGNsYXNzLlxuICBkZXYoKS5hc3NlcnQoZXNjYXBlZC5pbmRleE9mKCcpJykgPT09IC0xKTtcbiAgcmV0dXJuIGVzY2FwZWQ7XG59XG5cbi8qKlxuICogRXNjYXBlcyBgPGAsIGA+YCBhbmQgb3RoZXIgSFRNTCBjaGFyY2F0ZXJzIHdpdGggdGhlaXIgZXNjYXBlZCBmb3Jtcy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVIdG1sKHRleHQpIHtcbiAgaWYgKCF0ZXh0KSB7XG4gICAgcmV0dXJuIHRleHQ7XG4gIH1cbiAgcmV0dXJuIHRleHQucmVwbGFjZShIVE1MX0VTQ0FQRV9SRUdFWCwgZXNjYXBlSHRtbENoYXIpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBjXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGVzY2FwZUh0bWxDaGFyKGMpIHtcbiAgcmV0dXJuIEhUTUxfRVNDQVBFX0NIQVJTW2NdO1xufVxuXG4vKipcbiAqIFRyaWVzIHRvIGZvY3VzIG9uIHRoZSBnaXZlbiBlbGVtZW50OyBmYWlscyBzaWxlbnRseSBpZiBicm93c2VyIHRocm93cyBhblxuICogZXhjZXB0aW9uLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ5Rm9jdXMoZWxlbWVudCkge1xuICB0cnkge1xuICAgIGVsZW1lbnQuLypPSyovZm9jdXMoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIC8vIElFIDw9IDcgbWF5IHRocm93IGV4Y2VwdGlvbnMgd2hlbiBmb2N1c2luZyBvbiBoaWRkZW4gaXRlbXMuXG4gIH1cbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBnaXZlbiB3aW5kb3cgaXMgaW4gYW4gaWZyYW1lIG9yIG5vdC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNJZnJhbWVkKHdpbikge1xuICByZXR1cm4gd2luLnBhcmVudCAmJiB3aW4ucGFyZW50ICE9IHdpbjtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmVzIGlmIHRoaXMgZWxlbWVudCBpcyBhbiBBTVAgZWxlbWVudFxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQW1wRWxlbWVudChlbGVtZW50KSB7XG4gIGNvbnN0IHRhZyA9IGVsZW1lbnQudGFnTmFtZTtcbiAgLy8gVXNlIHByZWZpeCB0byByZWNvZ25pemUgQU1QIGVsZW1lbnQuIFRoaXMgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugc3R1YlxuICAvLyBtYXkgbm90IGJlIGF0dGFjaGVkIHlldC5cbiAgcmV0dXJuIHN0YXJ0c1dpdGgodGFnLCAnQU1QLScpICYmXG4gICAgICAvLyBTb21lIFwiYW1wLSpcIiBlbGVtZW50cyBhcmUgbm90IHJlYWxseSBBTVAgZWxlbWVudHMuIDpzbWg6XG4gICAgICAhKHRhZyA9PSAnQU1QLVNUSUNLWS1BRC1UT1AtUEFERElORycgfHwgdGFnID09ICdBTVAtQk9EWScpO1xufVxuXG4vKipcbiAqIFJldHVybiBhIHByb21pc2UgdGhhdCByZXNvbHZlIHdoZW4gYW4gQU1QIGVsZW1lbnQgdXBncmFkZSBmcm9tIEhUTUxFbGVtZW50XG4gKiB0byBDdXN0b21FbGVtZW50XG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aGVuVXBncmFkZWRUb0N1c3RvbUVsZW1lbnQoZWxlbWVudCkge1xuICBkZXYoKS5hc3NlcnQoaXNBbXBFbGVtZW50KGVsZW1lbnQpLCAnZWxlbWVudCBpcyBub3QgQW1wRWxlbWVudCcpO1xuICBpZiAoZWxlbWVudC5jcmVhdGVkQ2FsbGJhY2spIHtcbiAgICAvLyBFbGVtZW50IGFscmVhZHkgaXMgQ3VzdG9tRWxlbWVudDtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGVsZW1lbnQpO1xuICB9XG4gIC8vIElmIEVsZW1lbnQgaXMgc3RpbGwgSFRNTEVsZW1lbnQsIHdhaXQgZm9yIGl0IHRvIHVwZ3JhZGUgdG8gY3VzdG9tRWxlbWVudFxuICAvLyBOb3RlOiB1c2UgcHVyZSBzdHJpbmcgdG8gYXZvaWQgb2JmdXNjYXRpb24gYmV0d2VlbiB2ZXJzaW9ucy5cbiAgaWYgKCFlbGVtZW50W1VQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9QUk9NSVNFXSkge1xuICAgIGNvbnN0IGRlZmVycmVkID0gbmV3IERlZmVycmVkKCk7XG4gICAgZWxlbWVudFtVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUFJPTUlTRV0gPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgIGVsZW1lbnRbVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1JFU09MVkVSXSA9IGRlZmVycmVkLnJlc29sdmU7XG5cbiAgfVxuXG4gIHJldHVybiBlbGVtZW50W1VQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9QUk9NSVNFXTtcbn1cblxuLyoqXG4gKiBSZXBsYWNlbWVudCBmb3IgYEVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4oKWAgbWV0aG9kLlxuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0VsZW1lbnQvcmVxdWVzdEZ1bGxzY3JlZW5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZ1bGxzY3JlZW5FbnRlcihlbGVtZW50KSB7XG4gIGNvbnN0IHJlcXVlc3RGcyA9IGVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW5cbiAgIHx8IGVsZW1lbnQucmVxdWVzdEZ1bGxTY3JlZW5cbiAgIHx8IGVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW5cbiAgIHx8IGVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxTY3JlZW5cbiAgIHx8IGVsZW1lbnQud2Via2l0RW50ZXJGdWxsc2NyZWVuXG4gICB8fCBlbGVtZW50LndlYmtpdEVudGVyRnVsbFNjcmVlblxuICAgfHwgZWxlbWVudC5tc1JlcXVlc3RGdWxsc2NyZWVuXG4gICB8fCBlbGVtZW50Lm1zUmVxdWVzdEZ1bGxTY3JlZW5cbiAgIHx8IGVsZW1lbnQubW96UmVxdWVzdEZ1bGxzY3JlZW5cbiAgIHx8IGVsZW1lbnQubW96UmVxdWVzdEZ1bGxTY3JlZW47XG4gIGlmIChyZXF1ZXN0RnMpIHtcbiAgICByZXF1ZXN0RnMuY2FsbChlbGVtZW50KTtcbiAgfVxufVxuXG4vKipcbiAqIFJlcGxhY2VtZW50IGZvciBgRG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4oKWAgbWV0aG9kLlxuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0RvY3VtZW50L2V4aXRGdWxsc2NyZWVuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmdWxsc2NyZWVuRXhpdChlbGVtZW50KSB7XG4gIGxldCBleGl0RnMgPSBlbGVtZW50LmNhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50LmV4aXRGdWxsc2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC5leGl0RnVsbFNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50LndlYmtpdEV4aXRGdWxsU2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC53ZWJraXRDYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC5tb3pDYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC5tc0V4aXRGdWxsc2NyZWVuO1xuICBpZiAoZXhpdEZzKSB7XG4gICAgZXhpdEZzLmNhbGwoZWxlbWVudCk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChlbGVtZW50Lm93bmVyRG9jdW1lbnQpIHtcbiAgICBleGl0RnMgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuY2FuY2VsRnVsbFNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC5leGl0RnVsbHNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC5leGl0RnVsbFNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC53ZWJraXRFeGl0RnVsbFNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC53ZWJraXRDYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlbjtcbiAgfVxuICBpZiAoZXhpdEZzKSB7XG4gICAgZXhpdEZzLmNhbGwoZWxlbWVudC5vd25lckRvY3VtZW50KTtcbiAgICByZXR1cm47XG4gIH1cbn1cblxuXG4vKipcbiAqIFJlcGxhY2VtZW50IGZvciBgRG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnRgLlxuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0RvY3VtZW50L2Z1bGxzY3JlZW5FbGVtZW50XG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNGdWxsc2NyZWVuRWxlbWVudChlbGVtZW50KSB7XG4gIGNvbnN0IGlzRnVsbHNjcmVlbiA9IGVsZW1lbnQud2Via2l0RGlzcGxheWluZ0Z1bGxzY3JlZW47XG4gIGlmIChpc0Z1bGxzY3JlZW4pIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAoZWxlbWVudC5vd25lckRvY3VtZW50KSB7XG4gICAgY29uc3QgZnVsbHNjcmVlbkVsZW1lbnQgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnRcbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVsZW1lbnRcbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQubW96RnVsbFNjcmVlbkVsZW1lbnRcbiAgICAgICAgICAgICB8fCBlbGVtZW50LndlYmtpdEN1cnJlbnRGdWxsU2NyZWVuRWxlbWVudDtcbiAgICBpZiAoZnVsbHNjcmVlbkVsZW1lbnQgPT0gZWxlbWVudCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgbm9kZSBpcyBub3QgZGlzYWJsZWQuXG4gKlxuICogSUU4IGNhbiByZXR1cm4gZmFsc2UgcG9zaXRpdmVzLCBzZWUge0BsaW5rIG1hdGNoZXN9LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEBzZWUgaHR0cHM6Ly93d3cudzMub3JnL1RSL2h0bWw1L2Zvcm1zLmh0bWwjY29uY2VwdC1mZS1kaXNhYmxlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNFbmFibGVkKGVsZW1lbnQpIHtcbiAgcmV0dXJuICEoZWxlbWVudC5kaXNhYmxlZCB8fCBtYXRjaGVzKGVsZW1lbnQsICc6ZGlzYWJsZWQnKSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0ICogYXMgZG9tIGZyb20gJy4vZG9tJztcbmltcG9ydCB7XG4gIGdldEFtcGRvYyxcbiAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlLFxuICBnZXRTZXJ2aWNlLFxuICBnZXRTZXJ2aWNlUHJvbWlzZSxcbiAgZ2V0U2VydmljZVByb21pc2VGb3JEb2MsXG4gIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsLFxuICBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEZvckRvYyxcbiAgZ2V0VG9wV2luZG93LFxufSBmcm9tICcuL3NlcnZpY2UnO1xuaW1wb3J0IHt0b1dpbn0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQge3VzZXJ9IGZyb20gJy4vbG9nJztcblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIHdpbmRvdy4gQWxzbyBleHBlY3RzIGFuXG4gKiBlbGVtZW50IHRoYXQgaGFzIHRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24uIFRoZSBwcm9taXNlIHJlc29sdmVzIHdoZW4gdGhlXG4gKiBpbXBsZW1lbnRhdGlvbiBsb2FkZWQuIFVzZXJzIHNob3VsZCB0eXBpY2FsbHkgd3JhcCB0aGlzIGFzIGEgc3BlY2lhbCBwdXJwb3NlXG4gKiBmdW5jdGlvbiAoZS5nLiBTZXJ2aWNlcy52aWV3cG9ydEZvckRvYyguLi4pKSBmb3IgdHlwZSBzYWZldHkgYW5kIGJlY2F1c2UgdGhlXG4gKiBmYWN0b3J5IHNob3VsZCBub3QgYmUgcGFzc2VkIGFyb3VuZC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uIE5hbWUgb2YgdGhlIGN1c3RvbSBleHRlbnNpb24gdGhhdCBwcm92aWRlcyB0aGVcbiAqICAgICBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZWxlbWVudCBXaGV0aGVyIHRoaXMgc2VydmljZSBpcyBwcm92aWRlZCBieSBhbiBlbGVtZW50LFxuICogICAgIG5vdCB0aGUgZXh0ZW5zaW9uLlxuICogQHJldHVybiB7IVByb21pc2U8Kj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50U2VydmljZSh3aW4sIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KSB7XG4gIHJldHVybiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpLnRoZW4oXG4gICAgICBzZXJ2aWNlID0+IGFzc2VydFNlcnZpY2Uoc2VydmljZSwgaWQsIGV4dGVuc2lvbikpO1xufVxuXG4vKipcbiAqIFNhbWUgYXMgZ2V0RWxlbWVudFNlcnZpY2UgYnV0IHByb2R1Y2VzIG51bGwgaWYgdGhlIGdpdmVuIGVsZW1lbnQgaXMgbm90XG4gKiBhY3R1YWxseSBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uIE5hbWUgb2YgdGhlIGN1c3RvbSBleHRlbnNpb24gdGhhdCBwcm92aWRlcyB0aGVcbiAqICAgICBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZWxlbWVudCBXaGV0aGVyIHRoaXMgc2VydmljZSBpcyBwcm92aWRlZCBieSBhblxuICogICAgIGVsZW1lbnQsIG5vdCB0aGUgZXh0ZW5zaW9uLlxuICogQHJldHVybiB7IVByb21pc2U8P09iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpIHtcbiAgY29uc3QgcyA9IGdldFNlcnZpY2VQcm9taXNlT3JOdWxsKHdpbiwgaWQpO1xuICBpZiAocykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAocyk7XG4gIH1cbiAgcmV0dXJuIGdldEVsZW1lbnRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGVsZW1lbnROYW1lIE5hbWUgb2YgYW4gZXh0ZW5kZWQgY3VzdG9tIGVsZW1lbnQuXG4gKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoaXMgZWxlbWVudCBpcyBzY2hlZHVsZWQgdG8gYmUgbG9hZGVkLlxuICovXG5mdW5jdGlvbiBpc0VsZW1lbnRTY2hlZHVsZWQod2luLCBlbGVtZW50TmFtZSkge1xuICAvLyBTZXQgaW4gY3VzdG9tLWVsZW1lbnQuanNcbiAgaWYgKCF3aW4uYW1wRXh0ZW5kZWRFbGVtZW50cykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gISF3aW4uYW1wRXh0ZW5kZWRFbGVtZW50c1tlbGVtZW50TmFtZV07XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIHdpbmRvdy4gQWxzbyBleHBlY3RzIGFuXG4gKiBlbGVtZW50IHRoYXQgaGFzIHRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24uIFRoZSBwcm9taXNlIHJlc29sdmVzIHdoZW4gdGhlXG4gKiBpbXBsZW1lbnRhdGlvbiBsb2FkZWQuIFVzZXJzIHNob3VsZCB0eXBpY2FsbHkgd3JhcCB0aGlzIGFzIGEgc3BlY2lhbCBwdXJwb3NlXG4gKiBmdW5jdGlvbiAoZS5nLiBTZXJ2aWNlcy52aWV3cG9ydEZvckRvYyguLi4pKSBmb3IgdHlwZSBzYWZldHkgYW5kIGJlY2F1c2UgdGhlXG4gKiBmYWN0b3J5IHNob3VsZCBub3QgYmUgcGFzc2VkIGFyb3VuZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbiBOYW1lIG9mIHRoZSBjdXN0b20gZXh0ZW5zaW9uIHRoYXQgcHJvdmlkZXMgdGhlXG4gKiAgICAgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBzZXJ2aWNlLlxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2VsZW1lbnQgV2hldGhlciB0aGlzIHNlcnZpY2UgaXMgcHJvdmlkZWQgYnkgYW4gZWxlbWVudCxcbiAqICAgICBub3QgdGhlIGV4dGVuc2lvbi5cbiAqIEByZXR1cm4geyFQcm9taXNlPCo+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCwgZXh0ZW5zaW9uLFxuICBvcHRfZWxlbWVudCkge1xuICByZXR1cm4gZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhcbiAgICAgIGVsZW1lbnRPckFtcERvYywgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpXG4gICAgICAudGhlbihzZXJ2aWNlID0+IGFzc2VydFNlcnZpY2Uoc2VydmljZSwgaWQsIGV4dGVuc2lvbikpO1xufVxuXG4vKipcbiAqIFNhbWUgYXMgZ2V0RWxlbWVudFNlcnZpY2UgYnV0IHByb2R1Y2VzIG51bGwgaWYgdGhlIGdpdmVuIGVsZW1lbnQgaXMgbm90XG4gKiBhY3R1YWxseSBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbiBOYW1lIG9mIHRoZSBjdXN0b20gZXh0ZW5zaW9uIHRoYXQgcHJvdmlkZXMgdGhlXG4gKiAgICAgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBzZXJ2aWNlLlxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2VsZW1lbnQgV2hldGhlciB0aGlzIHNlcnZpY2UgaXMgcHJvdmlkZWQgYnkgYW5cbiAqICAgICBlbGVtZW50LCBub3QgdGhlIGV4dGVuc2lvbi5cbiAqIEByZXR1cm4geyFQcm9taXNlPD9PYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhcbiAgZWxlbWVudE9yQW1wRG9jLCBpZCwgZXh0ZW5zaW9uLCBvcHRfZWxlbWVudCkge1xuICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2MoZWxlbWVudE9yQW1wRG9jKTtcbiAgY29uc3QgcyA9IGdldFNlcnZpY2VQcm9taXNlT3JOdWxsRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpO1xuICBpZiAocykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAocyk7XG4gIH1cblxuICByZXR1cm4gYW1wZG9jLndoZW5Cb2R5QXZhaWxhYmxlKClcbiAgICAgIC50aGVuKCgpID0+IHdhaXRGb3JFeHRlbnNpb25JZlByZXNlbnQoXG4gICAgICAgICAgYW1wZG9jLndpbiwgZXh0ZW5zaW9uLFxuICAgICAgICAgIGFtcGRvYy5nZXRIZWFkTm9kZSgpKSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgLy8gSWYgdGhpcyBzZXJ2aWNlIGlzIHByb3ZpZGVkIGJ5IGFuIGVsZW1lbnQsIHRoZW4gd2UgY2FuJ3QgZGVwZW5kIG9uXG4gICAgICAgIC8vIHRoZSBzZXJ2aWNlICh0aGV5IG1heSBub3QgdXNlIHRoZSBlbGVtZW50KS5cbiAgICAgICAgaWYgKG9wdF9lbGVtZW50KSB7XG4gICAgICAgICAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzRWxlbWVudFNjaGVkdWxlZChhbXBkb2Mud2luLCBleHRlbnNpb24pKSB7XG4gICAgICAgICAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgZm9yIHNlcnZpY2UgZm9yIHRoZSBnaXZlbiBpZCBpbiB0aGUgZW1iZWQgc2NvcGUgb2ZcbiAqIGEgZ2l2ZW4gbm9kZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UsIGZhbGxzIGJhY2sgdG8gYW1wZG9jIHNjb3BlIElGRlxuICogdGhlIGdpdmVuIG5vZGUgaXMgaW4gdGhlIHRvcC1sZXZlbCB3aW5kb3cuXG4gKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb24gTmFtZSBvZiB0aGUgY3VzdG9tIGVsZW1lbnQgdGhhdCBwcm92aWRlc1xuICogICAgIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTw/T2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2NJbkVtYmVkU2NvcGUoXG4gIGVsZW1lbnRPckFtcERvYywgaWQsIGV4dGVuc2lvbikge1xuICBjb25zdCBzID0gZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKGVsZW1lbnRPckFtcERvYywgaWQpO1xuICBpZiAocykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAoUHJvbWlzZS5yZXNvbHZlKHMpKTtcbiAgfVxuICAvLyBSZXR1cm4gZW1iZWQtc2NvcGUgZWxlbWVudCBzZXJ2aWNlIHByb21pc2UgaWYgc2NoZWR1bGVkLlxuICBpZiAoZWxlbWVudE9yQW1wRG9jLm5vZGVUeXBlKSB7XG4gICAgY29uc3Qgd2luID0gdG9XaW4oZWxlbWVudE9yQW1wRG9jLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcpO1xuICAgIGNvbnN0IHRvcFdpbiA9IGdldFRvcFdpbmRvdyh3aW4pO1xuICAgIC8vIEluIGVtYmVkcywgZG9jLXNjb3BlIHNlcnZpY2VzIGFyZSB3aW5kb3ctc2NvcGUuIEJ1dCBtYWtlIHN1cmUgdG9cbiAgICAvLyBvbmx5IGRvIHRoaXMgZm9yIGVtYmVkcyAobm90IHRoZSB0b3Agd2luZG93KSwgb3RoZXJ3aXNlIHdlJ2QgZ3JhYlxuICAgIC8vIGEgcHJvbWlzZSBmcm9tIHRoZSB3cm9uZyBzZXJ2aWNlIGhvbGRlciB3aGljaCB3b3VsZCBuZXZlciByZXNvbHZlLlxuICAgIGlmICh3aW4gIT09IHRvcFdpbikge1xuICAgICAgcmV0dXJuIGdldEVsZW1lbnRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkLCBleHRlbnNpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBGYWxsYmFjayB0byBhbXBkb2MgSUZGIHRoZSBnaXZlbiBub2RlIGlzIF9ub3RfIEZJRS5cbiAgICAgIHJldHVybiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQsIGV4dGVuc2lvbik7XG4gICAgfVxuICB9XG4gIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAoUHJvbWlzZS5yZXNvbHZlKG51bGwpKTtcbn1cblxuLyoqXG4gKiBUaHJvd3MgdXNlciBlcnJvciBpZiBgc2VydmljZWAgaXMgbnVsbC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBzZXJ2aWNlXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb25cbiAqIEByZXR1cm4geyFPYmplY3R9XG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBhc3NlcnRTZXJ2aWNlKHNlcnZpY2UsIGlkLCBleHRlbnNpb24pIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IU9iamVjdH0gKi8gKHVzZXIoKS5hc3NlcnQoc2VydmljZSxcbiAgICAgICdTZXJ2aWNlICVzIHdhcyByZXF1ZXN0ZWQgdG8gYmUgcHJvdmlkZWQgdGhyb3VnaCAlcywgJyArXG4gICAgICAnYnV0ICVzIGlzIG5vdCBsb2FkZWQgaW4gdGhlIGN1cnJlbnQgcGFnZS4gVG8gZml4IHRoaXMgJyArXG4gICAgICAncHJvYmxlbSBsb2FkIHRoZSBKYXZhU2NyaXB0IGZpbGUgZm9yICVzIGluIHRoaXMgcGFnZS4nLFxuICAgICAgaWQsIGV4dGVuc2lvbiwgZXh0ZW5zaW9uLCBleHRlbnNpb24pKTtcbn1cblxuLyoqXG4gKiBHZXQgbGlzdCBvZiBhbGwgdGhlIGV4dGVuc2lvbiBKUyBmaWxlc1xuICogQHBhcmFtIHtIVE1MSGVhZEVsZW1lbnR8RWxlbWVudHxTaGFkb3dSb290fSBoZWFkXG4gKiBAcmV0dXJuIHshQXJyYXk8c3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dGVuc2lvblNjcmlwdHNJbk5vZGUoaGVhZCkge1xuICAvLyBhbXBkb2MuZ2V0SGVhZE5vZGUoKSBjYW4gcmV0dXJuIG51bGxcbiAgaWYgKCFoZWFkKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGNvbnN0IHNjcmlwdHMgPSBbXTtcbiAgY29uc3QgbGlzdCA9IGhlYWQucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0W2N1c3RvbS1lbGVtZW50XScpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICBzY3JpcHRzLnB1c2gobGlzdFtpXS5nZXRBdHRyaWJ1dGUoJ2N1c3RvbS1lbGVtZW50JykpO1xuICB9XG4gIHJldHVybiBzY3JpcHRzO1xufVxuXG4vKipcbiAqIFdhaXRzIGZvciBib2R5IHRvIGJlIHByZXNlbnQgdGhlbiB2ZXJpZmllcyB0aGF0IGFuIGV4dGVuc2lvbiBzY3JpcHQgaXNcbiAqIHByZXNlbnQgaW4gaGVhZCBmb3IgaW5zdGFsbGF0aW9uLlxuICogQHBhcmFtIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uSWRcbiAqIEByZXR1cm4geyFQcm9taXNlPGJvb2xlYW4+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNFeHRlbnNpb25TY3JpcHRJbk5vZGUoYW1wZG9jLCBleHRlbnNpb25JZCkge1xuICByZXR1cm4gYW1wZG9jLndoZW5Cb2R5QXZhaWxhYmxlKClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgcmV0dXJuIGV4dGVuc2lvblNjcmlwdEluTm9kZShcbiAgICAgICAgICAgIGFtcGRvYy5nZXRIZWFkTm9kZSgpLCBleHRlbnNpb25JZCk7XG4gICAgICB9KTtcbn1cblxuLyoqXG4gKiBWZXJpZmllcyB0aGF0IGFuIGV4dGVuc2lvbiBzY3JpcHQgaXMgcHJlc2VudCBpbiBoZWFkIGZvclxuICogaW5zdGFsbGF0aW9uLlxuICogQHBhcmFtIHtIVE1MSGVhZEVsZW1lbnR8RWxlbWVudHxTaGFkb3dSb290fSBoZWFkXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uSWRcbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIGV4dGVuc2lvblNjcmlwdEluTm9kZShoZWFkLCBleHRlbnNpb25JZCkge1xuICByZXR1cm4gZXh0ZW5zaW9uU2NyaXB0c0luTm9kZShoZWFkKS5pbmNsdWRlcyhleHRlbnNpb25JZCk7XG59XG5cbi8qKlxuICogV2FpdHMgZm9yIGFuIGV4dGVuc2lvbiBpZiBpdHMgc2NyaXB0IGlzIHByZXNlbnRcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uXG4gKiBAcGFyYW0ge0hUTUxIZWFkRWxlbWVudHxFbGVtZW50fFNoYWRvd1Jvb3R9IGhlYWRcbiAqIEByZXR1cm4geyFQcm9taXNlfVxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gd2FpdEZvckV4dGVuc2lvbklmUHJlc2VudCh3aW4sIGV4dGVuc2lvbiwgaGVhZCkge1xuICAvKipcbiAgICogSWYgdGhlcmUgaXMgYW4gZXh0ZW5zaW9uIHNjcmlwdCB3YWl0IGZvciBpdCB0byBsb2FkIGJlZm9yZSB0cnlpbmdcbiAgICogdG8gZ2V0IHRoZSBzZXJ2aWNlLiBQcmV2ZW50cyBhIHJhY2UgY29uZGl0aW9uIHdoZW4gZXZlcnl0aGluZyBidXRcbiAgICogdGhlIGV4dGVuc2lvbnMgaXMgaW4gY2FjaGUuIElmIHRoZXJlIGlzIG5vIHNjcmlwdCB0aGVuIGl0J3MgZWl0aGVyXG4gICAqIG5vdCBwcmVzZW50LCBvciB0aGUgc2VydmljZSB3YXMgZGVmaW5lZCBieSBhIHRlc3QuIEluIHRob3NlIGNhc2VzXG4gICAqIHdlIGRvbid0IHdhaXQgYXJvdW5kIGZvciBhbiBleHRlbnNpb24gdGhhdCBkb2VzIG5vdCBleGlzdC5cbiAgICovXG5cbiAgLy8gVE9ETyhqcGV0dGl0dCkgaW52ZXN0aWdhdGUgcmVnaXN0ZXJFeHRlbnNpb24gdG8gc2hvcnQgY2lyY3VpdFxuICAvLyB0aGUgZG9tIGNhbGwgaW4gZXh0ZW5zaW9uU2NyaXB0c0luTm9kZSgpXG4gIGlmICghZXh0ZW5zaW9uU2NyaXB0SW5Ob2RlKGhlYWQsIGV4dGVuc2lvbikpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH1cblxuICBjb25zdCBleHRlbnNpb25zID0gZ2V0U2VydmljZSh3aW4sICdleHRlbnNpb25zJyk7XG4gIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAoXG4gICAgZXh0ZW5zaW9ucy53YWl0Rm9yRXh0ZW5zaW9uKHdpbiwgZXh0ZW5zaW9uKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgcHJvbWlzZSBmb3Igc2VydmljZSB3aXRoIGBpZGAgb24gdGhlIGdpdmVuIHdpbmRvdyBpZiBhdmFpbGFibGUuXG4gKiBPdGhlcndpc2UsIHJlc29sdmVzIHdpdGggbnVsbCAoc2VydmljZSB3YXMgbm90IHJlZ2lzdGVyZWQpLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvblxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2VsZW1lbnRcbiAqIEByZXR1cm4geyFQcm9taXNlPE9iamVjdD59XG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBnZXRFbGVtZW50U2VydmljZVByb21pc2VPck51bGwod2luLCBpZCwgZXh0ZW5zaW9uLCBvcHRfZWxlbWVudCkge1xuICByZXR1cm4gZG9tLndhaXRGb3JCb2R5UHJvbWlzZSh3aW4uZG9jdW1lbnQpXG4gICAgICAudGhlbigoKSA9PiB3YWl0Rm9yRXh0ZW5zaW9uSWZQcmVzZW50KHdpbiwgZXh0ZW5zaW9uLCB3aW4uZG9jdW1lbnQuaGVhZCkpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIC8vIElmIHRoaXMgc2VydmljZSBpcyBwcm92aWRlZCBieSBhbiBlbGVtZW50LCB0aGVuIHdlIGNhbid0IGRlcGVuZCBvblxuICAgICAgICAvLyB0aGUgc2VydmljZSAodGhleSBtYXkgbm90IHVzZSB0aGUgZWxlbWVudCkuXG4gICAgICAgIGlmIChvcHRfZWxlbWVudCkge1xuICAgICAgICAgIHJldHVybiBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkKTtcbiAgICAgICAgfSBlbHNlIGlmIChpc0VsZW1lbnRTY2hlZHVsZWQod2luLCBleHRlbnNpb24pKSB7XG4gICAgICAgICAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlKHdpbiwgaWQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG5pbXBvcnQge0FtcEV2ZW50c30gZnJvbSAnLi9hbXAtZXZlbnRzJztcbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4vc2VydmljZXMnO1xuaW1wb3J0IHtcbiAgVVNFUl9FUlJPUl9TRU5USU5FTCxcbiAgZGV2LFxuICBkdXBsaWNhdGVFcnJvcklmTmVjZXNzYXJ5LFxuICBpc1VzZXJFcnJvckVtYmVkLFxuICBpc1VzZXJFcnJvck1lc3NhZ2UsXG59IGZyb20gJy4vbG9nJztcbmltcG9ydCB7ZXhwZXJpbWVudFRvZ2dsZXNPck51bGwsIGdldEJpbmFyeVR5cGUsIGlzQ2FuYXJ5fSBmcm9tICcuL2V4cGVyaW1lbnRzJztcbmltcG9ydCB7ZXhwb25lbnRpYWxCYWNrb2ZmfSBmcm9tICcuL2V4cG9uZW50aWFsLWJhY2tvZmYnO1xuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuL21vZGUnO1xuaW1wb3J0IHtpc0V4cGVyaW1lbnRPbn0gZnJvbSAnLi9leHBlcmltZW50cyc7XG5pbXBvcnQge1xuICBpc0xvYWRFcnJvck1lc3NhZ2UsXG59IGZyb20gJy4vZXZlbnQtaGVscGVyJztcbmltcG9ydCB7aXNQcm94eU9yaWdpbn0gZnJvbSAnLi91cmwnO1xuaW1wb3J0IHttYWtlQm9keVZpc2libGV9IGZyb20gJy4vc3R5bGUtaW5zdGFsbGVyJztcbmltcG9ydCB7c3RhcnRzV2l0aH0gZnJvbSAnLi9zdHJpbmcnO1xuaW1wb3J0IHt0cmlnZ2VyQW5hbHl0aWNzRXZlbnR9IGZyb20gJy4vYW5hbHl0aWNzJztcbmltcG9ydCB7dXJsc30gZnJvbSAnLi9jb25maWcnO1xuXG4vKipcbiAqIEBjb25zdCB7c3RyaW5nfVxuICovXG5jb25zdCBDQU5DRUxMRUQgPSAnQ0FOQ0VMTEVEJztcblxuLyoqXG4gKiBAY29uc3Qge3N0cmluZ31cbiAqL1xuY29uc3QgQkxPQ0tfQllfQ09OU0VOVCA9ICdCTE9DS19CWV9DT05TRU5UJztcblxuXG4vKipcbiAqIFRoZSB0aHJlc2hvbGQgZm9yIGVycm9ycyB0aHJvdHRsZWQgYmVjYXVzZSBub3RoaW5nIGNhbiBiZSBkb25lIGFib3V0XG4gKiB0aGVtLCBidXQgd2UnZCBzdGlsbCBsaWtlIHRvIHJlcG9ydCB0aGUgcm91Z2ggbnVtYmVyLlxuICogQGNvbnN0IHtudW1iZXJ9XG4gKi9cbmNvbnN0IE5PTl9BQ1RJT05BQkxFX0VSUk9SX1RIUk9UVExFX1RIUkVTSE9MRCA9IDAuMDAxO1xuXG4vKipcbiAqIFRoZSB0aHJlc2hvbGQgZm9yIGVycm9ycyB0aHJvdHRsZWQgYmVjYXVzZSBub3RoaW5nIGNhbiBiZSBkb25lIGFib3V0XG4gKiB0aGVtLCBidXQgd2UnZCBzdGlsbCBsaWtlIHRvIHJlcG9ydCB0aGUgcm91Z2ggbnVtYmVyLlxuICogQGNvbnN0IHtudW1iZXJ9XG4gKi9cbmNvbnN0IFVTRVJfRVJST1JfVEhST1RUTEVfVEhSRVNIT0xEID0gMC4xO1xuXG5cbi8qKlxuICogQ29sbGVjdHMgZXJyb3IgbWVzc2FnZXMsIHNvIHRoZXkgY2FuIGJlIGluY2x1ZGVkIGluIHN1YnNlcXVlbnQgcmVwb3J0cy5cbiAqIFRoYXQgYWxsb3dzIGlkZW50aWZ5aW5nIGVycm9ycyB0aGF0IG1pZ2h0IGJlIGNhdXNlZCBieSBwcmV2aW91cyBlcnJvcnMuXG4gKi9cbmxldCBhY2N1bXVsYXRlZEVycm9yTWVzc2FnZXMgPSBzZWxmLkFNUEVycm9ycyB8fCBbXTtcbi8vIFVzZSBhIHRydWUgZ2xvYmFsLCB0byBhdm9pZCBtdWx0aS1tb2R1bGUgaW5jbHVzaW9uIGlzc3Vlcy5cbnNlbGYuQU1QRXJyb3JzID0gYWNjdW11bGF0ZWRFcnJvck1lc3NhZ2VzO1xuXG4vKipcbiAqIFB1c2hlcyBlbGVtZW50IGludG8gYXJyYXksIGtlZXBpbmcgYXQgbW9zdCB0aGUgbW9zdCByZWNlbnQgbGltaXQgZWxlbWVudHNcbiAqXG4gKiBAcGFyYW0geyFBcnJheTxUPn0gYXJyYXlcbiAqIEBwYXJhbSB7VH0gZWxlbWVudFxuICogQHBhcmFtIHtudW1iZXJ9IGxpbWl0XG4gKiBAdGVtcGxhdGUgVFxuICovXG5mdW5jdGlvbiBwdXNoTGltaXQoYXJyYXksIGVsZW1lbnQsIGxpbWl0KSB7XG4gIGlmIChhcnJheS5sZW5ndGggPj0gbGltaXQpIHtcbiAgICBhcnJheS5zcGxpY2UoMCwgYXJyYXkubGVuZ3RoIC0gbGltaXQgKyAxKTtcbiAgfVxuICBhcnJheS5wdXNoKGVsZW1lbnQpO1xufVxuXG4vKipcbiAqIEEgd3JhcHBlciBhcm91bmQgb3VyIGV4cG9uZW50aWFsQmFja29mZiwgdG8gbGF6eSBpbml0aWFsaXplIGl0IHRvIGF2b2lkIGFuXG4gKiB1bi1EQ0UnYWJsZSBzaWRlLWVmZmVjdC5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gd29yayB0aGUgZnVuY3Rpb24gdG8gZXhlY3V0ZSBhZnRlciBiYWNrb2ZmXG4gKiBAcmV0dXJuIHtudW1iZXJ9IHRoZSBzZXRUaW1lb3V0IGlkXG4gKi9cbmxldCByZXBvcnRpbmdCYWNrb2ZmID0gZnVuY3Rpb24od29yaykge1xuICAvLyBTZXQgcmVwb3J0aW5nQmFja29mZiBhcyB0aGUgbGF6eS1jcmVhdGVkIGZ1bmN0aW9uLiBKUyBWb29vZG9vb28uXG4gIHJlcG9ydGluZ0JhY2tvZmYgPSBleHBvbmVudGlhbEJhY2tvZmYoMS41KTtcbiAgcmV0dXJuIHJlcG9ydGluZ0JhY2tvZmYod29yayk7XG59O1xuXG4vKipcbiAqIEF0dGVtcHRzIHRvIHN0cmluZ2lmeSBhIHZhbHVlLCBmYWxsaW5nIGJhY2sgdG8gU3RyaW5nLlxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0cnlKc29uU3RyaW5naWZ5KHZhbHVlKSB7XG4gIHRyeSB7XG4gICAgLy8gQ2FzdCBpcyBmaW5lLCBiZWNhdXNlIHdlIHJlYWxseSBkb24ndCBjYXJlIGhlcmUuIEp1c3QgdHJ5aW5nLlxuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSgvKiogQHR5cGUgeyFKc29uT2JqZWN0fSAqLyAodmFsdWUpKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBTdHJpbmcodmFsdWUpO1xuICB9XG59XG5cbi8qKlxuICogVGhlIHRydWUgSlMgZW5naW5lLCBhcyBkZXRlY3RlZCBieSBpbnNwZWN0aW5nIGFuIEVycm9yIHN0YWNrLiBUaGlzIHNob3VsZCBiZVxuICogdXNlZCB3aXRoIHRoZSB1c2VyQWdlbnQgdG8gdGVsbCBkZWZpbml0ZWx5LiBJLmUuLCBDaHJvbWUgb24gaU9TIGlzIHJlYWxseSBhXG4gKiBTYWZhcmkgSlMgZW5naW5lLlxuICovXG5sZXQgZGV0ZWN0ZWRKc0VuZ2luZTtcblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHsqfSBlcnJvclxuICogQHBhcmFtIHshRWxlbWVudD19IG9wdF9hc3NvY2lhdGVkRWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVwb3J0RXJyb3JGb3JXaW4od2luLCBlcnJvciwgb3B0X2Fzc29jaWF0ZWRFbGVtZW50KSB7XG4gIHJlcG9ydEVycm9yKGVycm9yLCBvcHRfYXNzb2NpYXRlZEVsZW1lbnQpO1xuICBpZiAoZXJyb3IgJiYgISF3aW4gJiYgaXNVc2VyRXJyb3JNZXNzYWdlKGVycm9yLm1lc3NhZ2UpXG4gICAgICAmJiAhaXNVc2VyRXJyb3JFbWJlZChlcnJvci5tZXNzYWdlKSkge1xuICAgIHJlcG9ydEVycm9yVG9BbmFseXRpY3MoLyoqIEB0eXBlIHshRXJyb3J9ICovKGVycm9yKSwgd2luKTtcbiAgfVxufVxuXG4vKipcbiAqIFJlcG9ydHMgYW4gZXJyb3IuIElmIHRoZSBlcnJvciBoYXMgYW4gXCJhc3NvY2lhdGVkRWxlbWVudFwiIHByb3BlcnR5XG4gKiB0aGUgZWxlbWVudCBpcyBtYXJrZWQgd2l0aCB0aGUgYGktYW1waHRtbC1lbGVtZW50LWVycm9yYCBhbmQgZGlzcGxheXNcbiAqIHRoZSBtZXNzYWdlIGl0c2VsZi4gVGhlIG1lc3NhZ2UgaXMgYWx3YXlzIHNlbmQgdG8gdGhlIGNvbnNvbGUuXG4gKiBJZiB0aGUgZXJyb3IgaGFzIGEgXCJtZXNzYWdlQXJyYXlcIiBwcm9wZXJ0eSwgdGhhdCBhcnJheSBpcyBsb2dnZWQuXG4gKiBUaGlzIHdheSBvbmUgZ2V0cyB0aGUgbmF0aXZlIGZpZGVsaXR5IG9mIHRoZSBjb25zb2xlIGZvciB0aGluZ3MgbGlrZVxuICogZWxlbWVudHMgaW5zdGVhZCBvZiBzdHJpbmdpZmljYXRpb24uXG4gKiBAcGFyYW0geyp9IGVycm9yXG4gKiBAcGFyYW0geyFFbGVtZW50PX0gb3B0X2Fzc29jaWF0ZWRFbGVtZW50XG4gKiBAcmV0dXJuIHshRXJyb3J9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXBvcnRFcnJvcihlcnJvciwgb3B0X2Fzc29jaWF0ZWRFbGVtZW50KSB7XG4gIHRyeSB7XG4gICAgLy8gQ29udmVydCBlcnJvciB0byB0aGUgZXhwZWN0ZWQgdHlwZS5cbiAgICBsZXQgaXNWYWxpZEVycm9yO1xuICAgIGlmIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yLm1lc3NhZ2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBlcnJvciA9IGR1cGxpY2F0ZUVycm9ySWZOZWNlc3NhcnkoLyoqIEB0eXBlIHshRXJyb3J9ICovKGVycm9yKSk7XG4gICAgICAgIGlzVmFsaWRFcnJvciA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBvcmlnRXJyb3IgPSBlcnJvcjtcbiAgICAgICAgZXJyb3IgPSBuZXcgRXJyb3IodHJ5SnNvblN0cmluZ2lmeShvcmlnRXJyb3IpKTtcbiAgICAgICAgZXJyb3Iub3JpZ0Vycm9yID0gb3JpZ0Vycm9yO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBlcnJvciA9IG5ldyBFcnJvcignVW5rbm93biBlcnJvcicpO1xuICAgIH1cbiAgICAvLyBSZXBvcnQgaWYgZXJyb3IgaXMgbm90IGFuIGV4cGVjdGVkIHR5cGUuXG4gICAgaWYgKCFpc1ZhbGlkRXJyb3IgJiYgZ2V0TW9kZSgpLmxvY2FsRGV2ICYmICFnZXRNb2RlKCkudGVzdCkge1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc3QgcmV0aHJvdyA9IG5ldyBFcnJvcihcbiAgICAgICAgICAgICdfcmVwb3J0ZWRfIEVycm9yIHJlcG9ydGVkIGluY29ycmVjdGx5OiAnICsgZXJyb3IpO1xuICAgICAgICB0aHJvdyByZXRocm93O1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGVycm9yLnJlcG9ydGVkKSB7XG4gICAgICByZXR1cm4gLyoqIEB0eXBlIHshRXJyb3J9ICovIChlcnJvcik7XG4gICAgfVxuICAgIGVycm9yLnJlcG9ydGVkID0gdHJ1ZTtcblxuICAgIC8vIFVwZGF0ZSBlbGVtZW50LlxuICAgIGNvbnN0IGVsZW1lbnQgPSBvcHRfYXNzb2NpYXRlZEVsZW1lbnQgfHwgZXJyb3IuYXNzb2NpYXRlZEVsZW1lbnQ7XG4gICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudC5jbGFzc0xpc3QpIHtcbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaS1hbXBodG1sLWVycm9yJyk7XG4gICAgICBpZiAoZ2V0TW9kZSgpLmRldmVsb3BtZW50KSB7XG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaS1hbXBodG1sLWVsZW1lbnQtZXJyb3InKTtcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Vycm9yLW1lc3NhZ2UnLCBlcnJvci5tZXNzYWdlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXBvcnQgdG8gY29uc29sZS5cbiAgICBpZiAoc2VsZi5jb25zb2xlKSB7XG4gICAgICBjb25zdCBvdXRwdXQgPSAoY29uc29sZS5lcnJvciB8fCBjb25zb2xlLmxvZyk7XG4gICAgICBpZiAoZXJyb3IubWVzc2FnZUFycmF5KSB7XG4gICAgICAgIG91dHB1dC5hcHBseShjb25zb2xlLCBlcnJvci5tZXNzYWdlQXJyYXkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgICBvdXRwdXQuY2FsbChjb25zb2xlLCBlcnJvci5tZXNzYWdlLCBlbGVtZW50KTtcbiAgICAgICAgfSBlbHNlIGlmICghZ2V0TW9kZSgpLm1pbmlmaWVkKSB7XG4gICAgICAgICAgb3V0cHV0LmNhbGwoY29uc29sZSwgZXJyb3Iuc3RhY2spO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG91dHB1dC5jYWxsKGNvbnNvbGUsIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnQuZGlzcGF0Y2hDdXN0b21FdmVudEZvclRlc3RpbmcpIHtcbiAgICAgIGVsZW1lbnQuZGlzcGF0Y2hDdXN0b21FdmVudEZvclRlc3RpbmcoQW1wRXZlbnRzLkVSUk9SLCBlcnJvci5tZXNzYWdlKTtcbiAgICB9XG5cbiAgICAvLyAnY2FsbCcgdG8gbWFrZSBsaW50ZXIgaGFwcHkuIEFuZCAuY2FsbCB0byBtYWtlIGNvbXBpbGVyIGhhcHB5XG4gICAgLy8gdGhhdCBleHBlY3RzIHNvbWUgQHRoaXMuXG4gICAgcmVwb3J0RXJyb3JUb1NlcnZlclsnY2FsbCddKHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCxcbiAgICAgICAgdW5kZWZpbmVkLCBlcnJvcik7XG4gIH0gY2F0Y2ggKGVycm9yUmVwb3J0aW5nRXJyb3IpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgdGhyb3cgZXJyb3JSZXBvcnRpbmdFcnJvcjtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gLyoqIEB0eXBlIHshRXJyb3J9ICovIChlcnJvcik7XG59XG5cbi8qKlxuICogUmV0dXJucyBhbiBlcnJvciBmb3IgYSBjYW5jZWxsYXRpb24gb2YgYSBwcm9taXNlLlxuICogQHJldHVybiB7IUVycm9yfVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2FuY2VsbGF0aW9uKCkge1xuICByZXR1cm4gbmV3IEVycm9yKENBTkNFTExFRCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHsqfSBlcnJvck9yTWVzc2FnZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQ2FuY2VsbGF0aW9uKGVycm9yT3JNZXNzYWdlKSB7XG4gIGlmICghZXJyb3JPck1lc3NhZ2UpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgaWYgKHR5cGVvZiBlcnJvck9yTWVzc2FnZSA9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBzdGFydHNXaXRoKGVycm9yT3JNZXNzYWdlLCBDQU5DRUxMRUQpO1xuICB9XG4gIGlmICh0eXBlb2YgZXJyb3JPck1lc3NhZ2UubWVzc2FnZSA9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBzdGFydHNXaXRoKGVycm9yT3JNZXNzYWdlLm1lc3NhZ2UsIENBTkNFTExFRCk7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIFJldHVybnMgYW4gZXJyb3IgZm9yIGNvbXBvbmVudCBibG9ja2VkIGJ5IGNvbnNlbnRcbiAqIEByZXR1cm4geyFFcnJvcn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJsb2NrZWRCeUNvbnNlbnRFcnJvcigpIHtcbiAgcmV0dXJuIG5ldyBFcnJvcihCTE9DS19CWV9DT05TRU5UKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyp9IGVycm9yT3JNZXNzYWdlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNCbG9ja2VkQnlDb25zZW50KGVycm9yT3JNZXNzYWdlKSB7XG4gIGlmICghZXJyb3JPck1lc3NhZ2UpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgaWYgKHR5cGVvZiBlcnJvck9yTWVzc2FnZSA9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBzdGFydHNXaXRoKGVycm9yT3JNZXNzYWdlLCBCTE9DS19CWV9DT05TRU5UKTtcbiAgfVxuICBpZiAodHlwZW9mIGVycm9yT3JNZXNzYWdlLm1lc3NhZ2UgPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gc3RhcnRzV2l0aChlcnJvck9yTWVzc2FnZS5tZXNzYWdlLCBCTE9DS19CWV9DT05TRU5UKTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cblxuLyoqXG4gKiBJbnN0YWxsIGhhbmRsaW5nIG9mIGdsb2JhbCB1bmhhbmRsZWQgZXhjZXB0aW9ucy5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnN0YWxsRXJyb3JSZXBvcnRpbmcod2luKSB7XG4gIHdpbi5vbmVycm9yID0gLyoqIEB0eXBlIHshRnVuY3Rpb259ICovIChyZXBvcnRFcnJvclRvU2VydmVyKTtcbiAgd2luLmFkZEV2ZW50TGlzdGVuZXIoJ3VuaGFuZGxlZHJlamVjdGlvbicsIGV2ZW50ID0+IHtcbiAgICBpZiAoZXZlbnQucmVhc29uICYmXG4gICAgICAoZXZlbnQucmVhc29uLm1lc3NhZ2UgPT09IENBTkNFTExFRCB8fFxuICAgICAgZXZlbnQucmVhc29uLm1lc3NhZ2UgPT09IEJMT0NLX0JZX0NPTlNFTlQpKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXBvcnRFcnJvcihldmVudC5yZWFzb24gfHwgbmV3IEVycm9yKCdyZWplY3RlZCBwcm9taXNlICcgKyBldmVudCkpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBTaWduYXR1cmUgZGVzaWduZWQsIHNvIGl0IGNhbiB3b3JrIHdpdGggd2luZG93Lm9uZXJyb3JcbiAqIEBwYXJhbSB7c3RyaW5nfHVuZGVmaW5lZH0gbWVzc2FnZVxuICogQHBhcmFtIHtzdHJpbmd8dW5kZWZpbmVkfSBmaWxlbmFtZVxuICogQHBhcmFtIHtzdHJpbmd8dW5kZWZpbmVkfSBsaW5lXG4gKiBAcGFyYW0ge3N0cmluZ3x1bmRlZmluZWR9IGNvbFxuICogQHBhcmFtIHsqfHVuZGVmaW5lZH0gZXJyb3JcbiAqIEB0aGlzIHshV2luZG93fHVuZGVmaW5lZH1cbiAqL1xuZnVuY3Rpb24gcmVwb3J0RXJyb3JUb1NlcnZlcihtZXNzYWdlLCBmaWxlbmFtZSwgbGluZSwgY29sLCBlcnJvcikge1xuICAvLyBNYWtlIGFuIGF0dGVtcHQgdG8gdW5oaWRlIHRoZSBib2R5LlxuICBpZiAodGhpcyAmJiB0aGlzLmRvY3VtZW50KSB7XG4gICAgbWFrZUJvZHlWaXNpYmxlKHRoaXMuZG9jdW1lbnQpO1xuICB9XG4gIGlmIChnZXRNb2RlKCkubG9jYWxEZXYgfHwgZ2V0TW9kZSgpLmRldmVsb3BtZW50IHx8IGdldE1vZGUoKS50ZXN0KSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGxldCBoYXNOb25BbXBKcyA9IGZhbHNlO1xuICB0cnkge1xuICAgIGhhc05vbkFtcEpzID0gZGV0ZWN0Tm9uQW1wSnMoc2VsZik7XG4gIH0gY2F0Y2ggKGlnbm9yZSkge1xuICAgIC8vIElnbm9yZSBlcnJvcnMgZHVyaW5nIGVycm9yIHJlcG9ydCBnZW5lcmF0aW9uLlxuICB9XG4gIGlmIChoYXNOb25BbXBKcyAmJiBNYXRoLnJhbmRvbSgpID4gMC4wMSkge1xuICAgIC8vIE9ubHkgcmVwb3J0IDElIG9mIGVycm9ycyBvbiBwYWdlcyB3aXRoIG5vbi1BTVAgSlMuXG4gICAgLy8gVGhlc2UgZXJyb3JzIGNhbiBhbG1vc3QgbmV2ZXIgYmUgYWN0ZWQgdXBvbiwgYnV0IHNwaWtlcyBzdWNoIGFzXG4gICAgLy8gZHVlIHRvIGJ1Z2d5IGJyb3dzZXIgZXh0ZW5zaW9ucyBtYXkgYmUgaGVscGZ1bCB0byBub3RpZnkgYXV0aG9ycy5cbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgZGF0YSA9IGdldEVycm9yUmVwb3J0RGF0YShtZXNzYWdlLCBmaWxlbmFtZSwgbGluZSwgY29sLCBlcnJvcixcbiAgICAgIGhhc05vbkFtcEpzKTtcbiAgaWYgKGRhdGEpIHtcbiAgICAvLyBSZXBvcnQgdGhlIGVycm9yIHRvIHZpZXdlciBpZiBpdCBoYXMgdGhlIGNhcGFiaWxpdHkuIFRoZSBkYXRhIHBhc3NlZFxuICAgIC8vIHRvIHRoZSB2aWV3ZXIgaXMgZXhhY3RseSB0aGUgc2FtZSBhcyB0aGUgZGF0YSBwYXNzZWQgdG8gdGhlIHNlcnZlclxuICAgIC8vIGJlbG93LlxuICAgIG1heWJlUmVwb3J0RXJyb3JUb1ZpZXdlcih0aGlzLCBkYXRhKTtcbiAgICByZXBvcnRpbmdCYWNrb2ZmKCgpID0+IHtcbiAgICAgIGNvbnN0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgeGhyLm9wZW4oJ1BPU1QnLCB1cmxzLmVycm9yUmVwb3J0aW5nLCB0cnVlKTtcbiAgICAgIHhoci5zZW5kKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIFBhc3NlcyB0aGUgZ2l2ZW4gZXJyb3IgZGF0YSB0byB0aGUgdmlld2VyIGlmIHRoZSBmb2xsb3dpbmcgY3JpdGVyaWEgaXMgbWV0OlxuICogLSBUaGUgdmlld2VyIGlzIGEgdHJ1c3RlZCB2aWV3ZXJcbiAqIC0gVGhlIHZpZXdlciBoYXMgdGhlIGBlcnJvclJlcG9ydGVyYCBjYXBhYmlsaXR5XG4gKiAtIFRoZSBBTVAgZG9jIGlzIGluIHNpbmdsZSBkb2MgbW9kZVxuICogLSBUaGUgQU1QIGRvYyBpcyBvcHRlZC1pbiBmb3IgZXJyb3IgaW50ZXJjZXB0aW9uIChgPGh0bWw+YCB0YWcgaGFzIHRoZVxuICogICBgcmVwb3J0LWVycm9ycy10by12aWV3ZXJgIGF0dHJpYnV0ZSlcbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshSnNvbk9iamVjdH0gZGF0YSBEYXRhIGZyb20gYGdldEVycm9yUmVwb3J0RGF0YWAuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTxib29sZWFuPn0gYFByb21pc2U8VHJ1ZT5gIGlmIHRoZSBlcnJvciB3YXMgc2VudCB0byB0aGVcbiAqICAgICB2aWV3ZXIsIGBQcm9taXNlPEZhbHNlPmAgb3RoZXJ3aXNlLlxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXliZVJlcG9ydEVycm9yVG9WaWV3ZXIod2luLCBkYXRhKSB7XG4gIGNvbnN0IGFtcGRvY1NlcnZpY2UgPSBTZXJ2aWNlcy5hbXBkb2NTZXJ2aWNlRm9yKHdpbik7XG4gIGlmICghYW1wZG9jU2VydmljZS5pc1NpbmdsZURvYygpKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShmYWxzZSk7XG4gIH1cbiAgY29uc3QgYW1wZG9jU2luZ2xlID0gYW1wZG9jU2VydmljZS5nZXRBbXBEb2MoKTtcbiAgY29uc3QgaHRtbEVsZW1lbnQgPSBhbXBkb2NTaW5nbGUuZ2V0Um9vdE5vZGUoKS5kb2N1bWVudEVsZW1lbnQ7XG4gIGNvbnN0IGRvY09wdGVkSW4gPSBodG1sRWxlbWVudC5oYXNBdHRyaWJ1dGUoJ3JlcG9ydC1lcnJvcnMtdG8tdmlld2VyJyk7XG4gIGlmICghZG9jT3B0ZWRJbikge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZmFsc2UpO1xuICB9XG5cbiAgY29uc3Qgdmlld2VyID0gU2VydmljZXMudmlld2VyRm9yRG9jKGFtcGRvY1NpbmdsZSk7XG4gIGlmICghdmlld2VyLmhhc0NhcGFiaWxpdHkoJ2Vycm9yUmVwb3J0ZXInKSkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZmFsc2UpO1xuICB9XG5cbiAgcmV0dXJuIHZpZXdlci5pc1RydXN0ZWRWaWV3ZXIoKS50aGVuKHZpZXdlclRydXN0ZWQgPT4ge1xuICAgIGlmICghdmlld2VyVHJ1c3RlZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2aWV3ZXIuc2VuZE1lc3NhZ2UoJ2Vycm9yJywgZGF0YSk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0pO1xufVxuXG4vKipcbiAqIFNpZ25hdHVyZSBkZXNpZ25lZCwgc28gaXQgY2FuIHdvcmsgd2l0aCB3aW5kb3cub25lcnJvclxuICogQHBhcmFtIHtzdHJpbmd8dW5kZWZpbmVkfSBtZXNzYWdlXG4gKiBAcGFyYW0ge3N0cmluZ3x1bmRlZmluZWR9IGZpbGVuYW1lXG4gKiBAcGFyYW0ge3N0cmluZ3x1bmRlZmluZWR9IGxpbmVcbiAqIEBwYXJhbSB7c3RyaW5nfHVuZGVmaW5lZH0gY29sXG4gKiBAcGFyYW0geyp8dW5kZWZpbmVkfSBlcnJvclxuICogQHBhcmFtIHtib29sZWFufSBoYXNOb25BbXBKc1xuICogQHJldHVybiB7IUpzb25PYmplY3R8dW5kZWZpbmVkfSBUaGUgZGF0YSB0byBwb3N0XG4gKiB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXJyb3JSZXBvcnREYXRhKG1lc3NhZ2UsIGZpbGVuYW1lLCBsaW5lLCBjb2wsIGVycm9yLFxuICBoYXNOb25BbXBKcykge1xuICBsZXQgZXhwZWN0ZWQgPSBmYWxzZTtcbiAgaWYgKGVycm9yKSB7XG4gICAgaWYgKGVycm9yLm1lc3NhZ2UpIHtcbiAgICAgIG1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBUaGlzIHNob3VsZCBuZXZlciBiZSBhIHN0cmluZywgYnV0IHNvbWV0aW1lcyBpdCBpcy5cbiAgICAgIG1lc3NhZ2UgPSBTdHJpbmcoZXJyb3IpO1xuICAgIH1cbiAgICAvLyBBbiBcImV4cGVjdGVkXCIgZXJyb3IgaXMgc3RpbGwgYW4gZXJyb3IsIGkuZS4gc29tZSBmZWF0dXJlcyBhcmUgZGlzYWJsZWRcbiAgICAvLyBvciBub3QgZnVuY3Rpb25pbmcgZnVsbHkgYmVjYXVzZSBvZiBpdC4gSG93ZXZlciwgaXQncyBhbiBleHBlY3RlZFxuICAgIC8vIGVycm9yLiBFLmcuIGFzIGlzIHRoZSBjYXNlIHdpdGggc29tZSBicm93c2VyIEFQSSBtaXNzaW5nIChzdG9yYWdlKS5cbiAgICAvLyBUaHVzLCB0aGUgZXJyb3IgY2FuIGJlIGNsYXNzaWZpZWQgZGlmZmVyZW50bHkgYnkgbG9nIGFnZ3JlZ2F0b3JzLlxuICAgIC8vIFRoZSBtYWluIGdvYWwgaXMgdG8gbW9uaXRvciB0aGF0IGFuIFwiZXhwZWN0ZWRcIiBlcnJvciBkb2Vzbid0IGRldGVyaW9yYXRlXG4gICAgLy8gb3ZlciB0aW1lLiBJdCdzIGltcG9zc2libGUgdG8gY29tcGxldGVseSBlbGltaW5hdGUgaXQuXG4gICAgaWYgKGVycm9yLmV4cGVjdGVkKSB7XG4gICAgICBleHBlY3RlZCA9IHRydWU7XG4gICAgfVxuICB9XG4gIGlmICghbWVzc2FnZSkge1xuICAgIG1lc3NhZ2UgPSAnVW5rbm93biBlcnJvcic7XG4gIH1cbiAgaWYgKC9fcmVwb3J0ZWRfLy50ZXN0KG1lc3NhZ2UpKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChtZXNzYWdlID09IENBTkNFTExFRCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGRldGFjaGVkV2luZG93ID0gIShzZWxmICYmIHNlbGYud2luZG93KTtcbiAgY29uc3QgdGhyb3R0bGVCYXNlID0gTWF0aC5yYW5kb20oKTtcblxuICAvLyBXZSB0aHJvdHRsZSBsb2FkIGVycm9ycyBhbmQgZ2VuZXJpYyBcIlNjcmlwdCBlcnJvci5cIiBlcnJvcnNcbiAgLy8gdGhhdCBoYXZlIG5vIGluZm9ybWF0aW9uIGFuZCB0aHVzIGNhbm5vdCBiZSBhY3RlZCB1cG9uLlxuICBpZiAoaXNMb2FkRXJyb3JNZXNzYWdlKG1lc3NhZ2UpIHx8XG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9hbXBwcm9qZWN0L2FtcGh0bWwvaXNzdWVzLzczNTNcbiAgICAvLyBmb3IgY29udGV4dC5cbiAgICBtZXNzYWdlID09ICdTY3JpcHQgZXJyb3IuJyB8fFxuICAgIC8vIFdpbmRvdyBoYXMgYmVjb21lIGRldGFjaGVkLCByZWFsbHkgYW55dGhpbmcgY2FuIGhhcHBlblxuICAgIC8vIGF0IHRoaXMgcG9pbnQuXG4gICAgZGV0YWNoZWRXaW5kb3cpIHtcbiAgICBleHBlY3RlZCA9IHRydWU7XG5cbiAgICBpZiAodGhyb3R0bGVCYXNlID4gTk9OX0FDVElPTkFCTEVfRVJST1JfVEhST1RUTEVfVEhSRVNIT0xEKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgY29uc3QgaXNVc2VyRXJyb3IgPSBpc1VzZXJFcnJvck1lc3NhZ2UobWVzc2FnZSk7XG5cbiAgLy8gT25seSByZXBvcnQgYSBzdWJzZXQgb2YgdXNlciBlcnJvcnMuXG4gIGlmIChpc1VzZXJFcnJvciAmJiB0aHJvdHRsZUJhc2UgPiBVU0VSX0VSUk9SX1RIUk9UVExFX1RIUkVTSE9MRCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIFRoaXMgaXMgdGhlIEFwcCBFbmdpbmUgYXBwIGluXG4gIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hbXBwcm9qZWN0L2Vycm9yLXRyYWNrZXJcbiAgLy8gSXQgc3RvcmVzIGVycm9yIHJlcG9ydHMgdmlhIGh0dHBzOi8vY2xvdWQuZ29vZ2xlLmNvbS9lcnJvci1yZXBvcnRpbmcvXG4gIC8vIGZvciBhbmFseXppbmcgcHJvZHVjdGlvbiBpc3N1ZXMuXG4gIGNvbnN0IGRhdGEgPSAvKiogQHR5cGUgeyFKc29uT2JqZWN0fSAqLyAoT2JqZWN0LmNyZWF0ZShudWxsKSk7XG4gIGRhdGFbJ3YnXSA9IGdldE1vZGUoKS5ydHZWZXJzaW9uO1xuICBkYXRhWydub0FtcCddID0gaGFzTm9uQW1wSnMgPyAnMScgOiAnMCc7XG4gIGRhdGFbJ20nXSA9IG1lc3NhZ2UucmVwbGFjZShVU0VSX0VSUk9SX1NFTlRJTkVMLCAnJyk7XG4gIGRhdGFbJ2EnXSA9IGlzVXNlckVycm9yID8gJzEnIDogJzAnO1xuXG4gIC8vIEVycm9ycyBhcmUgdGFnZ2VkIHdpdGggXCJleFwiIChcImV4cGVjdGVkXCIpIGxhYmVsIHRvIGFsbG93IGxvZ2dlcnMgdG9cbiAgLy8gY2xhc3NpZnkgdGhlc2UgZXJyb3JzIGFzIGJlbmNobWFya3MgYW5kIG5vdCBleGNlcHRpb25zLlxuICBkYXRhWydleCddID0gZXhwZWN0ZWQgPyAnMScgOiAnMCc7XG4gIGRhdGFbJ2R3J10gPSBkZXRhY2hlZFdpbmRvdyA/ICcxJyA6ICcwJztcblxuICBsZXQgcnVudGltZSA9ICcxcCc7XG4gIGlmIChzZWxmLmNvbnRleHQgJiYgc2VsZi5jb250ZXh0LmxvY2F0aW9uKSB7XG4gICAgZGF0YVsnM3AnXSA9ICcxJztcbiAgICBydW50aW1lID0gJzNwJztcbiAgfSBlbHNlIGlmIChnZXRNb2RlKCkucnVudGltZSkge1xuICAgIHJ1bnRpbWUgPSBnZXRNb2RlKCkucnVudGltZTtcbiAgfVxuICBkYXRhWydydCddID0gcnVudGltZTtcblxuICAvLyBUT0RPKGVyd2lubSk6IFJlbW92ZSBjYSB3aGVuIGFsbCBzeXN0ZW1zIHJlYWQgYGJ0YCBpbnN0ZWFkIG9mIGBjYWAgdG9cbiAgLy8gaWRlbnRpZnkganMgYmluYXJ5IHR5cGUuXG4gIGRhdGFbJ2NhJ10gPSBpc0NhbmFyeShzZWxmKSA/ICcxJyA6ICcwJztcblxuICAvLyBQYXNzIGJpbmFyeSB0eXBlLlxuICBkYXRhWydidCddID0gZ2V0QmluYXJ5VHlwZShzZWxmKTtcblxuICBpZiAoc2VsZi5sb2NhdGlvbi5hbmNlc3Rvck9yaWdpbnMgJiYgc2VsZi5sb2NhdGlvbi5hbmNlc3Rvck9yaWdpbnNbMF0pIHtcbiAgICBkYXRhWydvciddID0gc2VsZi5sb2NhdGlvbi5hbmNlc3Rvck9yaWdpbnNbMF07XG4gIH1cbiAgaWYgKHNlbGYudmlld2VyU3RhdGUpIHtcbiAgICBkYXRhWyd2cyddID0gc2VsZi52aWV3ZXJTdGF0ZTtcbiAgfVxuICAvLyBJcyBlbWJlZGRlZD9cbiAgaWYgKHNlbGYucGFyZW50ICYmIHNlbGYucGFyZW50ICE9IHNlbGYpIHtcbiAgICBkYXRhWydpZW0nXSA9ICcxJztcbiAgfVxuXG4gIGlmIChzZWxmLkFNUCAmJiBzZWxmLkFNUC52aWV3ZXIpIHtcbiAgICBjb25zdCByZXNvbHZlZFZpZXdlclVybCA9IHNlbGYuQU1QLnZpZXdlci5nZXRSZXNvbHZlZFZpZXdlclVybCgpO1xuICAgIGNvbnN0IG1lc3NhZ2luZ09yaWdpbiA9IHNlbGYuQU1QLnZpZXdlci5tYXliZUdldE1lc3NhZ2luZ09yaWdpbigpO1xuICAgIGlmIChyZXNvbHZlZFZpZXdlclVybCkge1xuICAgICAgZGF0YVsncnZ1J10gPSByZXNvbHZlZFZpZXdlclVybDtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2luZ09yaWdpbikge1xuICAgICAgZGF0YVsnbXNvJ10gPSBtZXNzYWdpbmdPcmlnaW47XG4gICAgfVxuICB9XG5cbiAgaWYgKCFkZXRlY3RlZEpzRW5naW5lKSB7XG4gICAgZGV0ZWN0ZWRKc0VuZ2luZSA9IGRldGVjdEpzRW5naW5lRnJvbVN0YWNrKCk7XG4gIH1cbiAgZGF0YVsnanNlJ10gPSBkZXRlY3RlZEpzRW5naW5lO1xuXG4gIGNvbnN0IGV4cHMgPSBbXTtcbiAgY29uc3QgZXhwZXJpbWVudHMgPSBleHBlcmltZW50VG9nZ2xlc09yTnVsbChzZWxmKTtcbiAgZm9yIChjb25zdCBleHAgaW4gZXhwZXJpbWVudHMpIHtcbiAgICBjb25zdCBvbiA9IGV4cGVyaW1lbnRzW2V4cF07XG4gICAgZXhwcy5wdXNoKGAke2V4cH09JHtvbiA/ICcxJyA6ICcwJ31gKTtcbiAgfVxuICBkYXRhWydleHBzJ10gPSBleHBzLmpvaW4oJywnKTtcblxuICBpZiAoZXJyb3IpIHtcbiAgICBjb25zdCB0YWdOYW1lID0gZXJyb3IuYXNzb2NpYXRlZEVsZW1lbnRcbiAgICAgID8gZXJyb3IuYXNzb2NpYXRlZEVsZW1lbnQudGFnTmFtZVxuICAgICAgOiAndSc7IC8vIFVua25vd25cbiAgICBkYXRhWydlbCddID0gdGFnTmFtZTtcblxuICAgIGlmIChlcnJvci5hcmdzKSB7XG4gICAgICBkYXRhWydhcmdzJ10gPSBKU09OLnN0cmluZ2lmeShlcnJvci5hcmdzKTtcbiAgICB9XG5cbiAgICBpZiAoIWlzVXNlckVycm9yICYmICFlcnJvci5pZ25vcmVTdGFjayAmJiBlcnJvci5zdGFjaykge1xuICAgICAgZGF0YVsncyddID0gZXJyb3Iuc3RhY2s7XG4gICAgfVxuXG4gICAgZXJyb3IubWVzc2FnZSArPSAnIF9yZXBvcnRlZF8nO1xuICB9IGVsc2Uge1xuICAgIGRhdGFbJ2YnXSA9IGZpbGVuYW1lIHx8ICcnO1xuICAgIGRhdGFbJ2wnXSA9IGxpbmUgfHwgJyc7XG4gICAgZGF0YVsnYyddID0gY29sIHx8ICcnO1xuICB9XG4gIGRhdGFbJ3InXSA9IHNlbGYuZG9jdW1lbnQucmVmZXJyZXI7XG4gIGRhdGFbJ2FlJ10gPSBhY2N1bXVsYXRlZEVycm9yTWVzc2FnZXMuam9pbignLCcpO1xuICBkYXRhWydmciddID0gc2VsZi5sb2NhdGlvbi5vcmlnaW5hbEhhc2ggfHwgc2VsZi5sb2NhdGlvbi5oYXNoO1xuXG4gIHB1c2hMaW1pdChhY2N1bXVsYXRlZEVycm9yTWVzc2FnZXMsIG1lc3NhZ2UsIDI1KTtcblxuICByZXR1cm4gZGF0YTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgaXQgYXBwZWFycyBsaWtlIHRoZXJlIGlzIG5vbi1BTVAgSlMgb24gdGhlXG4gKiBjdXJyZW50IHBhZ2UuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZGV0ZWN0Tm9uQW1wSnMod2luKSB7XG4gIGNvbnN0IHNjcmlwdHMgPSB3aW4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0W3NyY10nKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzY3JpcHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKCFpc1Byb3h5T3JpZ2luKHNjcmlwdHNbaV0uc3JjLnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIFJlc2V0cyBhY2N1bXVsYXRlZCBlcnJvciBtZXNzYWdlcyBmb3IgdGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRBY2N1bXVsYXRlZEVycm9yTWVzc2FnZXNGb3JUZXN0aW5nKCkge1xuICBhY2N1bXVsYXRlZEVycm9yTWVzc2FnZXMgPSBbXTtcbn1cblxuLyoqXG4gKiBEb2VzIGEgc2VyaWVzIG9mIGNoZWNrcyBvbiB0aGUgc3RhY2sgb2YgYW4gdGhyb3duIGVycm9yIHRvIGRldGVybWluZSB0aGVcbiAqIEpTIGVuZ2luZSB0aGF0IGlzIGN1cnJlbnRseSBydW5uaW5nLiBUaGlzIGdpdmVzIGEgYml0IG1vcmUgaW5mb3JtYXRpb24gdGhhblxuICoganVzdCB0aGUgVXNlckFnZW50LCBzaW5jZSBicm93c2VycyBvZnRlbiBhbGxvdyBvdmVycmlkaW5nIGl0IHRvIFwiZW11bGF0ZVwiXG4gKiBtb2JpbGUuXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRldGVjdEpzRW5naW5lRnJvbVN0YWNrKCkge1xuICAvKiogQGNvbnN0cnVjdG9yICovXG4gIGZ1bmN0aW9uIEZuKCkge31cbiAgRm4ucHJvdG90eXBlLnQgPSBmdW5jdGlvbigpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ21lc3NhZ2UnKTtcbiAgfTtcbiAgY29uc3Qgb2JqZWN0ID0gbmV3IEZuKCk7XG4gIHRyeSB7XG4gICAgb2JqZWN0LnQoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnN0IHtzdGFja30gPSBlO1xuXG4gICAgLy8gU2FmYXJpIG9ubHkgbWVudGlvbnMgdGhlIG1ldGhvZCBuYW1lLlxuICAgIGlmIChzdGFydHNXaXRoKHN0YWNrLCAndEAnKSkge1xuICAgICAgcmV0dXJuICdTYWZhcmknO1xuICAgIH1cblxuICAgIC8vIEZpcmVmb3ggbWVudGlvbnMgXCJwcm90b3R5cGVcIi5cbiAgICBpZiAoc3RhY2suaW5kZXhPZignLnByb3RvdHlwZS50QCcpID4gLTEpIHtcbiAgICAgIHJldHVybiAnRmlyZWZveCc7XG4gICAgfVxuXG4gICAgLy8gSUUgbG9va3MgbGlrZSBDaHJvbWUsIGJ1dCBpbmNsdWRlcyBhIGNvbnRleHQgZm9yIHRoZSBiYXNlIHN0YWNrIGxpbmUuXG4gICAgLy8gRXhwbGljaXRseSwgd2UncmUgbG9va2luZyBmb3Igc29tZXRoaW5nIGxpa2U6XG4gICAgLy8gXCIgICAgYXQgR2xvYmFsIGNvZGUgKGh0dHBzOi8vZXhhbXBsZS5jb20vYXBwLmpzOjE6MjAwKVwiIG9yXG4gICAgLy8gXCIgICAgYXQgQW5vbnltb3VzIGZ1bmN0aW9uIChodHRwczovL2V4YW1wbGUuY29tL2FwcC5qczoxOjIwMClcIlxuICAgIC8vIHZzIENocm9tZSB3aGljaCBoYXM6XG4gICAgLy8gXCIgICAgYXQgaHR0cHM6Ly9leGFtcGxlLmNvbS9hcHAuanM6MToyMDBcIlxuICAgIGNvbnN0IGxhc3QgPSBzdGFjay5zcGxpdCgnXFxuJykucG9wKCk7XG4gICAgaWYgKC9cXGJhdCAuKiBcXCgvaS50ZXN0KGxhc3QpKSB7XG4gICAgICByZXR1cm4gJ0lFJztcbiAgICB9XG5cbiAgICAvLyBGaW5hbGx5LCBjaHJvbWUgaW5jbHVkZXMgdGhlIGVycm9yIG1lc3NhZ2UgaW4gdGhlIHN0YWNrLlxuICAgIGlmIChzdGFydHNXaXRoKHN0YWNrLCAnRXJyb3I6IG1lc3NhZ2UnKSkge1xuICAgICAgcmV0dXJuICdDaHJvbWUnO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiAndW5rbm93bic7XG59XG5cbi8qKlxuICogQHBhcmFtIHshRXJyb3J9IGVycm9yXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVwb3J0RXJyb3JUb0FuYWx5dGljcyhlcnJvciwgd2luKSB7XG4gIGlmIChpc0V4cGVyaW1lbnRPbih3aW4sICd1c2VyLWVycm9yLXJlcG9ydGluZycpKSB7XG4gICAgY29uc3QgdmFycyA9IHtcbiAgICAgICdlcnJvck5hbWUnOiBlcnJvci5uYW1lLFxuICAgICAgJ2Vycm9yTWVzc2FnZSc6IGVycm9yLm1lc3NhZ2UsXG4gICAgfTtcbiAgICB0cmlnZ2VyQW5hbHl0aWNzRXZlbnQoZ2V0Um9vdEVsZW1lbnRfKHdpbiksICd1c2VyLWVycm9yJywgdmFycyk7XG4gIH1cbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IUVsZW1lbnR9XG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBnZXRSb290RWxlbWVudF8od2luKSB7XG4gIGNvbnN0IHJvb3QgPSBTZXJ2aWNlcy5hbXBkb2NTZXJ2aWNlRm9yKHdpbikuZ2V0QW1wRG9jKCkuZ2V0Um9vdE5vZGUoKTtcbiAgcmV0dXJuIGRldigpLmFzc2VydEVsZW1lbnQocm9vdC5kb2N1bWVudEVsZW1lbnQgfHwgcm9vdC5ib2R5IHx8IHJvb3QpO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICAqIFdoZXRoZXIgYWRkRXZlbnRMaXN0ZW5lciBzdXBwb3J0cyBvcHRpb25zIG9yIG9ubHkgdGFrZXMgY2FwdHVyZSBhcyBhIGJvb2xlYW5cbiAgKiBAdHlwZSB7Ym9vbGVhbnx1bmRlZmluZWR9XG4gICogQHZpc2libGVGb3JUZXN0aW5nXG4gICovXG5sZXQgb3B0c1N1cHBvcnRlZDtcblxuLyoqXG4gKiBMaXN0ZW5zIGZvciB0aGUgc3BlY2lmaWVkIGV2ZW50IG9uIHRoZSBlbGVtZW50LlxuICpcbiAqIERvIG5vdCB1c2UgdGhpcyBkaXJlY3RseS4gVGhpcyBtZXRob2QgaXMgaW1wbGVtZW50ZWQgYXMgYSBzaGFyZWRcbiAqIGRlcGVuZGVuY3kuIFVzZSBgbGlzdGVuKClgIGluIGVpdGhlciBgZXZlbnQtaGVscGVyYCBvciBgM3AtZnJhbWUtbWVzc2FnaW5nYCxcbiAqIGRlcGVuZGluZyBvbiB5b3VyIHVzZSBjYXNlLlxuICpcbiAqIEBwYXJhbSB7IUV2ZW50VGFyZ2V0fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFdmVudCl9IGxpc3RlbmVyXG4gKiBAcGFyYW0ge09iamVjdD19IG9wdF9ldnRMaXN0ZW5lck9wdHNcbiAqIEByZXR1cm4geyFVbmxpc3RlbkRlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGludGVybmFsTGlzdGVuSW1wbGVtZW50YXRpb24oZWxlbWVudCwgZXZlbnRUeXBlLCBsaXN0ZW5lcixcbiAgb3B0X2V2dExpc3RlbmVyT3B0cykge1xuICBsZXQgbG9jYWxFbGVtZW50ID0gZWxlbWVudDtcbiAgbGV0IGxvY2FsTGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgLyoqXG4gICAqIEB0eXBlIHs/RnVuY3Rpb259XG4gICAqL1xuICBsZXQgd3JhcHBlZDtcblxuICB3cmFwcGVkID0gZXZlbnQgPT4ge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gbG9jYWxMaXN0ZW5lcihldmVudCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gcmVwb3J0RXJyb3IgaXMgaW5zdGFsbGVkIGdsb2JhbGx5IHBlciB3aW5kb3cgaW4gdGhlIGVudHJ5IHBvaW50LlxuICAgICAgc2VsZi5yZXBvcnRFcnJvcihlKTtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuICB9O1xuICBjb25zdCBvcHRzU3VwcG9ydGVkID0gZGV0ZWN0RXZ0TGlzdGVuZXJPcHRzU3VwcG9ydCgpO1xuICBsZXQgY2FwdHVyZSA9IGZhbHNlO1xuICBpZiAob3B0X2V2dExpc3RlbmVyT3B0cykge1xuICAgIGNhcHR1cmUgPSBvcHRfZXZ0TGlzdGVuZXJPcHRzLmNhcHR1cmU7XG4gIH1cbiAgbG9jYWxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICBldmVudFR5cGUsXG4gICAgICB3cmFwcGVkLFxuICAgICAgb3B0c1N1cHBvcnRlZCA/IG9wdF9ldnRMaXN0ZW5lck9wdHMgOiBjYXB0dXJlXG4gICk7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgaWYgKGxvY2FsRWxlbWVudCkge1xuICAgICAgbG9jYWxFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgZXZlbnRUeXBlLFxuICAgICAgICAgIHdyYXBwZWQsXG4gICAgICAgICAgb3B0c1N1cHBvcnRlZCA/IG9wdF9ldnRMaXN0ZW5lck9wdHMgOiBjYXB0dXJlXG4gICAgICApO1xuICAgIH1cbiAgICAvLyBFbnN1cmUgdGhlc2UgYXJlIEdDJ2RcbiAgICBsb2NhbExpc3RlbmVyID0gbnVsbDtcbiAgICBsb2NhbEVsZW1lbnQgPSBudWxsO1xuICAgIHdyYXBwZWQgPSBudWxsO1xuICB9O1xufVxuXG4vKipcbiAqIFRlc3RzIHdoZXRoZXIgdGhlIGJyb3dzZXIgc3VwcG9ydHMgb3B0aW9ucyBhcyBhbiBhcmd1bWVudCBvZiBhZGRFdmVudExpc3RlbmVyXG4gKiBvciBub3QuXG4gKlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRldGVjdEV2dExpc3RlbmVyT3B0c1N1cHBvcnQoKSB7XG4gIC8vIE9ubHkgcnVuIHRoZSB0ZXN0IG9uY2VcbiAgaWYgKG9wdHNTdXBwb3J0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBvcHRzU3VwcG9ydGVkO1xuICB9XG5cbiAgb3B0c1N1cHBvcnRlZCA9IGZhbHNlO1xuICB0cnkge1xuICAgIC8vIFRlc3Qgd2hldGhlciBicm93c2VyIHN1cHBvcnRzIEV2ZW50TGlzdGVuZXJPcHRpb25zIG9yIG5vdFxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBnZXQgY2FwdHVyZSgpIHtcbiAgICAgICAgb3B0c1N1cHBvcnRlZCA9IHRydWU7XG4gICAgICB9LFxuICAgIH07XG4gICAgc2VsZi5hZGRFdmVudExpc3RlbmVyKCd0ZXN0LW9wdGlvbnMnLCBudWxsLCBvcHRpb25zKTtcbiAgICBzZWxmLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Rlc3Qtb3B0aW9ucycsIG51bGwsIG9wdGlvbnMpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICAvLyBFdmVudExpc3RlbmVyT3B0aW9ucyBhcmUgbm90IHN1cHBvcnRlZFxuICB9XG4gIHJldHVybiBvcHRzU3VwcG9ydGVkO1xufVxuXG4vKipcbiAgKiBSZXNldHMgdGhlIHRlc3QgZm9yIHdoZXRoZXIgYWRkRXZlbnRMaXN0ZW5lciBzdXBwb3J0cyBvcHRpb25zIG9yIG5vdC5cbiAgKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldEV2dExpc3RlbmVyT3B0c1N1cHBvcnRGb3JUZXN0aW5nKCkge1xuICBvcHRzU3VwcG9ydGVkID0gdW5kZWZpbmVkO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7aW50ZXJuYWxMaXN0ZW5JbXBsZW1lbnRhdGlvbn0gZnJvbSAnLi9ldmVudC1oZWxwZXItbGlzdGVuJztcbmltcG9ydCB7dXNlcn0gZnJvbSAnLi9sb2cnO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICAqL1xuY29uc3QgTE9BRF9GQUlMVVJFX1BSRUZJWCA9ICdGYWlsZWQgdG8gbG9hZDonO1xuXG4vKipcbiAqIFJldHVybnMgYSBDdXN0b21FdmVudCB3aXRoIGEgZ2l2ZW4gdHlwZSBhbmQgZGV0YWlsOyBzdXBwb3J0cyBmYWxsYmFjayBmb3IgSUUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAqIEBwYXJhbSB7IUpzb25PYmplY3R8c3RyaW5nfHVuZGVmaW5lZHxudWxsfSBkZXRhaWxcbiAqIEBwYXJhbSB7RXZlbnRJbml0PX0gb3B0X2V2ZW50SW5pdFxuICogQHJldHVybiB7IUV2ZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ3VzdG9tRXZlbnQod2luLCB0eXBlLCBkZXRhaWwsIG9wdF9ldmVudEluaXQpIHtcbiAgY29uc3QgZXZlbnRJbml0ID0gLyoqIEB0eXBlIHshQ3VzdG9tRXZlbnRJbml0fSAqLyAoe2RldGFpbH0pO1xuICBPYmplY3QuYXNzaWduKGV2ZW50SW5pdCwgb3B0X2V2ZW50SW5pdCk7XG4gIC8vIHdpbi5DdXN0b21FdmVudCBpcyBhIGZ1bmN0aW9uIG9uIEVkZ2UsIENocm9tZSwgRkYsIFNhZmFyaSBidXRcbiAgLy8gaXMgYW4gb2JqZWN0IG9uIElFIDExLlxuICBpZiAodHlwZW9mIHdpbi5DdXN0b21FdmVudCA9PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIG5ldyB3aW4uQ3VzdG9tRXZlbnQodHlwZSwgZXZlbnRJbml0KTtcbiAgfSBlbHNlIHtcbiAgICAvLyBEZXByZWNhdGVkIGZhbGxiYWNrIGZvciBJRS5cbiAgICBjb25zdCBlID0gd2luLmRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgIGUuaW5pdEN1c3RvbUV2ZW50KFxuICAgICAgICB0eXBlLCAhIWV2ZW50SW5pdC5idWJibGVzLCAhIWV2ZW50SW5pdC5jYW5jZWxhYmxlLCBkZXRhaWwpO1xuICAgIHJldHVybiBlO1xuICB9XG59XG5cbi8qKlxuICogTGlzdGVucyBmb3IgdGhlIHNwZWNpZmllZCBldmVudCBvbiB0aGUgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUV2ZW50VGFyZ2V0fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFdmVudCl9IGxpc3RlbmVyXG4gKiBAcGFyYW0ge09iamVjdD19IG9wdF9ldnRMaXN0ZW5lck9wdHNcbiAqIEByZXR1cm4geyFVbmxpc3RlbkRlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxpc3RlbihlbGVtZW50LCBldmVudFR5cGUsIGxpc3RlbmVyLCBvcHRfZXZ0TGlzdGVuZXJPcHRzKSB7XG4gIHJldHVybiBpbnRlcm5hbExpc3RlbkltcGxlbWVudGF0aW9uKFxuICAgICAgZWxlbWVudCwgZXZlbnRUeXBlLCBsaXN0ZW5lciwgb3B0X2V2dExpc3RlbmVyT3B0cyk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZGF0YSBwcm9wZXJ0eSBvZiBhbiBldmVudCB3aXRoIHRoZSBjb3JyZWN0IHR5cGUuXG4gKiBAcGFyYW0geyFFdmVudHx7ZGF0YTogIUpzb25PYmplY3R9fSBldmVudFxuICogQHJldHVybiB7P0pzb25PYmplY3R8c3RyaW5nfHVuZGVmaW5lZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldERhdGEoZXZlbnQpIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7P0pzb25PYmplY3R8c3RyaW5nfHVuZGVmaW5lZH0gKi8gKGV2ZW50LmRhdGEpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGRldGFpbCBwcm9wZXJ0eSBvZiBhbiBldmVudCB3aXRoIHRoZSBjb3JyZWN0IHR5cGUuXG4gKiBAcGFyYW0geyFFdmVudHx7ZGV0YWlsOiAhSnNvbk9iamVjdH19IGV2ZW50XG4gKiBAcmV0dXJuIHs/SnNvbk9iamVjdHxzdHJpbmd8dW5kZWZpbmVkfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGV0YWlsKGV2ZW50KSB7XG4gIHJldHVybiAvKiogQHR5cGUgez9Kc29uT2JqZWN0fHN0cmluZ3x1bmRlZmluZWR9ICovIChldmVudC5kZXRhaWwpO1xufVxuXG4vKipcbiAqIExpc3RlbnMgZm9yIHRoZSBzcGVjaWZpZWQgZXZlbnQgb24gdGhlIGVsZW1lbnQgYW5kIHJlbW92ZXMgdGhlIGxpc3RlbmVyXG4gKiBhcyBzb29uIGFzIGV2ZW50IGhhcyBiZWVuIHJlY2VpdmVkLlxuICogQHBhcmFtIHshRXZlbnRUYXJnZXR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUV2ZW50KX0gbGlzdGVuZXJcbiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0X2V2dExpc3RlbmVyT3B0c1xuICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGlzdGVuT25jZShlbGVtZW50LCBldmVudFR5cGUsIGxpc3RlbmVyLCBvcHRfZXZ0TGlzdGVuZXJPcHRzKSB7XG4gIGxldCBsb2NhbExpc3RlbmVyID0gbGlzdGVuZXI7XG4gIGNvbnN0IHVubGlzdGVuID0gaW50ZXJuYWxMaXN0ZW5JbXBsZW1lbnRhdGlvbihlbGVtZW50LCBldmVudFR5cGUsIGV2ZW50ID0+IHtcbiAgICB0cnkge1xuICAgICAgbG9jYWxMaXN0ZW5lcihldmVudCk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIC8vIEVuc3VyZSBsaXN0ZW5lciBpcyBHQydkXG4gICAgICBsb2NhbExpc3RlbmVyID0gbnVsbDtcbiAgICAgIHVubGlzdGVuKCk7XG4gICAgfVxuICB9LCBvcHRfZXZ0TGlzdGVuZXJPcHRzKTtcbiAgcmV0dXJuIHVubGlzdGVuO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyAgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIGFzIHNvb24gYXMgdGhlIHNwZWNpZmllZCBldmVudCBoYXNcbiAqIGZpcmVkIG9uIHRoZSBlbGVtZW50LlxuICogQHBhcmFtIHshRXZlbnRUYXJnZXR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0X2V2dExpc3RlbmVyT3B0c1xuICogQHBhcmFtIHtmdW5jdGlvbighVW5saXN0ZW5EZWYpPX0gb3B0X2NhbmNlbCBBbiBvcHRpb25hbCBmdW5jdGlvbiB0aGF0LCB3aGVuXG4gKiAgICAgcHJvdmlkZWQsIHdpbGwgYmUgY2FsbGVkIHdpdGggdGhlIHVubGlzdGVuZXIuIFRoaXMgZ2l2ZXMgdGhlIGNhbGxlclxuICogICAgIGFjY2VzcyB0byB0aGUgdW5saXN0ZW5lciwgc28gaXQgbWF5IGJlIGNhbGxlZCBtYW51YWxseSB3aGVuIG5lY2Vzc2FyeS5cbiAqIEByZXR1cm4geyFQcm9taXNlPCFFdmVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW5PbmNlUHJvbWlzZShlbGVtZW50LCBldmVudFR5cGUsIG9wdF9ldnRMaXN0ZW5lck9wdHMsXG4gIG9wdF9jYW5jZWwpIHtcbiAgbGV0IHVubGlzdGVuO1xuICBjb25zdCBldmVudFByb21pc2UgPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICB1bmxpc3RlbiA9IGxpc3Rlbk9uY2UoZWxlbWVudCwgZXZlbnRUeXBlLCByZXNvbHZlLCBvcHRfZXZ0TGlzdGVuZXJPcHRzKTtcbiAgfSk7XG4gIGV2ZW50UHJvbWlzZS50aGVuKHVubGlzdGVuLCB1bmxpc3Rlbik7XG4gIGlmIChvcHRfY2FuY2VsKSB7XG4gICAgb3B0X2NhbmNlbCh1bmxpc3Rlbik7XG4gIH1cbiAgcmV0dXJuIGV2ZW50UHJvbWlzZTtcbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHNwZWNpZmllZCBlbGVtZW50L3dpbmRvdyBoYXMgYmVlbiBsb2FkZWQgYWxyZWFkeS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IVdpbmRvd30gZWxlT3JXaW5kb3dcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvYWRlZChlbGVPcldpbmRvdykge1xuICByZXR1cm4gISEoZWxlT3JXaW5kb3cuY29tcGxldGUgfHwgZWxlT3JXaW5kb3cucmVhZHlTdGF0ZSA9PSAnY29tcGxldGUnXG4gICAgICAvLyBJZiB0aGUgcGFzc2VkIGluIHRoaW5nIGlzIGEgV2luZG93LCBpbmZlciBsb2FkZWQgc3RhdGUgZnJvbVxuICAgICAgLy9cbiAgICAgIHx8IChlbGVPcldpbmRvdy5kb2N1bWVudFxuICAgICAgICAgICYmIGVsZU9yV2luZG93LmRvY3VtZW50LnJlYWR5U3RhdGUgPT0gJ2NvbXBsZXRlJykpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIG9yIGZhaWwgYmFzZWQgb24gdGhlIGVsZU9yV2luZG93J3MgJ2xvYWQnXG4gKiBhbmQgJ2Vycm9yJyBldmVudHMuIE9wdGlvbmFsbHkgdGhpcyBtZXRob2QgdGFrZXMgYSB0aW1lb3V0LCB3aGljaCB3aWxsIHJlamVjdFxuICogdGhlIHByb21pc2UgaWYgdGhlIHJlc291cmNlIGhhcyBub3QgbG9hZGVkIGJ5IHRoZW4uXG4gKiBAcGFyYW0ge1R9IGVsZU9yV2luZG93IFN1cHBvcnRzIGJvdGggRWxlbWVudHMgYW5kIGFzIGEgc3BlY2lhbCBjYXNlIFdpbmRvd3MuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTxUPn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsb2FkUHJvbWlzZShlbGVPcldpbmRvdykge1xuICBsZXQgdW5saXN0ZW5Mb2FkO1xuICBsZXQgdW5saXN0ZW5FcnJvcjtcbiAgaWYgKGlzTG9hZGVkKGVsZU9yV2luZG93KSkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZWxlT3JXaW5kb3cpO1xuICB9XG4gIGNvbnN0IGxvYWRpbmdQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIC8vIExpc3RlbiBvbmNlIHNpbmNlIElFIDUvNi83IGZpcmUgdGhlIG9ubG9hZCBldmVudCBjb250aW51b3VzbHkgZm9yXG4gICAgLy8gYW5pbWF0ZWQgR0lGcy5cbiAgICBjb25zdCB7dGFnTmFtZX0gPSBlbGVPcldpbmRvdztcbiAgICBpZiAodGFnTmFtZSA9PT0gJ0FVRElPJyB8fCB0YWdOYW1lID09PSAnVklERU8nKSB7XG4gICAgICB1bmxpc3RlbkxvYWQgPSBsaXN0ZW5PbmNlKGVsZU9yV2luZG93LCAnbG9hZHN0YXJ0JywgcmVzb2x2ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVubGlzdGVuTG9hZCA9IGxpc3Rlbk9uY2UoZWxlT3JXaW5kb3csICdsb2FkJywgcmVzb2x2ZSk7XG4gICAgfVxuICAgIC8vIEZvciBlbGVtZW50cywgdW5saXN0ZW4gb24gZXJyb3IgKGRvbid0IGZvciBXaW5kb3dzKS5cbiAgICBpZiAodGFnTmFtZSkge1xuICAgICAgdW5saXN0ZW5FcnJvciA9IGxpc3Rlbk9uY2UoZWxlT3JXaW5kb3csICdlcnJvcicsIHJlamVjdCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gbG9hZGluZ1Byb21pc2UudGhlbigoKSA9PiB7XG4gICAgaWYgKHVubGlzdGVuRXJyb3IpIHtcbiAgICAgIHVubGlzdGVuRXJyb3IoKTtcbiAgICB9XG4gICAgcmV0dXJuIGVsZU9yV2luZG93O1xuICB9LCAoKSA9PiB7XG4gICAgaWYgKHVubGlzdGVuTG9hZCkge1xuICAgICAgdW5saXN0ZW5Mb2FkKCk7XG4gICAgfVxuICAgIGZhaWxlZFRvTG9hZChlbGVPcldpbmRvdyk7XG4gIH0pO1xufVxuXG4vKipcbiAqIEVtaXQgZXJyb3Igb24gbG9hZCBmYWlsdXJlLlxuICogQHBhcmFtIHshRWxlbWVudHwhV2luZG93fSBlbGVPcldpbmRvdyBTdXBwb3J0cyBib3RoIEVsZW1lbnRzIGFuZCBhcyBhIHNwZWNpYWxcbiAqICAgICBjYXNlIFdpbmRvd3MuXG4gKi9cbmZ1bmN0aW9uIGZhaWxlZFRvTG9hZChlbGVPcldpbmRvdykge1xuICAvLyBSZXBvcnQgZmFpbGVkIGxvYWRzIGFzIHVzZXIgZXJyb3JzIHNvIHRoYXQgdGhleSBhdXRvbWF0aWNhbGx5IGdvXG4gIC8vIGludG8gdGhlIFwiZG9jdW1lbnQgZXJyb3JcIiBidWNrZXQuXG4gIGxldCB0YXJnZXQgPSBlbGVPcldpbmRvdztcbiAgaWYgKHRhcmdldCAmJiB0YXJnZXQuc3JjKSB7XG4gICAgdGFyZ2V0ID0gdGFyZ2V0LnNyYztcbiAgfVxuICB0aHJvdyB1c2VyKCkuY3JlYXRlRXJyb3IoTE9BRF9GQUlMVVJFX1BSRUZJWCwgdGFyZ2V0KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBlcnJvciBtZXNzYWdlIGlzIHdhcyBjcmVhdGVkIGZvciBhIGxvYWQgZXJyb3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBBbiBlcnJvciBtZXNzYWdlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNMb2FkRXJyb3JNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgcmV0dXJuIG1lc3NhZ2UuaW5kZXhPZihMT0FEX0ZBSUxVUkVfUFJFRklYKSAhPSAtMTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgRXhwZXJpbWVudHMgc3lzdGVtIGFsbG93cyBhIGRldmVsb3BlciB0byBvcHQtaW4gdG8gdGVzdFxuICogZmVhdHVyZXMgdGhhdCBhcmUgbm90IHlldCBmdWxseSB0ZXN0ZWQuXG4gKlxuICogRXhwZXJpbWVudHMgcGFnZTogaHR0cHM6Ly9jZG4uYW1wcHJvamVjdC5vcmcvZXhwZXJpbWVudHMuaHRtbCAqXG4gKi9cblxuaW1wb3J0IHtnZXRDb29raWUsIHNldENvb2tpZX0gZnJvbSAnLi9jb29raWVzJztcbmltcG9ydCB7aGFzT3dufSBmcm9tICcuL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge3BhcnNlUXVlcnlTdHJpbmd9IGZyb20gJy4vdXJsJztcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgQ09PS0lFX05BTUUgPSAnQU1QX0VYUCc7XG5cbi8qKiBAY29uc3Qge251bWJlcn0gKi9cbmNvbnN0IENPT0tJRV9NQVhfQUdFX0RBWVMgPSAxODA7IC8vIDYgbW9udGhcblxuLyoqIEBjb25zdCB7dGltZX0gKi9cbmNvbnN0IENPT0tJRV9FWFBJUkFUSU9OX0lOVEVSVkFMID0gQ09PS0lFX01BWF9BR0VfREFZUyAqIDI0ICogNjAgKiA2MCAqIDEwMDA7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmNvbnN0IFRPR0dMRVNfV0lORE9XX1BST1BFUlRZID0gJ19fQU1QX19FWFBFUklNRU5UX1RPR0dMRVMnO1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGlzVHJhZmZpY0VsaWdpYmxlOiBmdW5jdGlvbighV2luZG93KTpib29sZWFuLFxuICogICBicmFuY2hlczogIUFycmF5PHN0cmluZz5cbiAqIH19XG4gKi9cbmV4cG9ydCBsZXQgRXhwZXJpbWVudEluZm87XG5cbi8qKlxuICogV2hldGhlciB3ZSBhcmUgaW4gY2FuYXJ5LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0NhbmFyeSh3aW4pIHtcbiAgcmV0dXJuICEhKHdpbi5BTVBfQ09ORklHICYmIHdpbi5BTVBfQ09ORklHLmNhbmFyeSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBiaW5hcnkgdHlwZSwgZS5nLiwgY2FuYXJ5LCBjb250cm9sLCBvciBwcm9kdWN0aW9uLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEJpbmFyeVR5cGUod2luKSB7XG4gIHJldHVybiB3aW4uQU1QX0NPTkZJRyAmJiB3aW4uQU1QX0NPTkZJRy50eXBlID9cbiAgICB3aW4uQU1QX0NPTkZJRy50eXBlIDogJ3Vua25vd24nO1xufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHNwZWNpZmllZCBleHBlcmltZW50IGlzIG9uIG9yIG9mZi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gZXhwZXJpbWVudElkXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNFeHBlcmltZW50T24od2luLCBleHBlcmltZW50SWQpIHtcbiAgY29uc3QgdG9nZ2xlcyA9IGV4cGVyaW1lbnRUb2dnbGVzKHdpbik7XG4gIHJldHVybiAhIXRvZ2dsZXNbZXhwZXJpbWVudElkXTtcbn1cblxuLyoqXG4gKiBUb2dnbGVzIHRoZSBleHBlcmltZW50IG9uIG9yIG9mZi4gUmV0dXJucyB0aGUgYWN0dWFsIHZhbHVlIG9mIHRoZSBleHBlcmltZW50XG4gKiBhZnRlciB0b2dnbGluZyBpcyBkb25lLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHBlcmltZW50SWRcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9vblxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X3RyYW5zaWVudEV4cGVyaW1lbnQgIFdoZXRoZXIgdG8gdG9nZ2xlIHRoZVxuICogICAgIGV4cGVyaW1lbnQgc3RhdGUgXCJ0cmFuc2llbnRseVwiIChpLmUuLCBmb3IgdGhpcyBwYWdlIGxvYWQgb25seSkgb3JcbiAqICAgICBkdXJhYmx5IChieSBzYXZpbmcgdGhlIGV4cGVyaW1lbnQgSURzIHRvIHRoZSBjb29raWUgYWZ0ZXIgdG9nZ2xpbmcpLlxuICogICAgIERlZmF1bHQ6IGZhbHNlIChzYXZlIGR1cmFibHkpLlxuICogQHJldHVybiB7Ym9vbGVhbn0gTmV3IHN0YXRlIGZvciBleHBlcmltZW50SWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGVFeHBlcmltZW50KHdpbiwgZXhwZXJpbWVudElkLCBvcHRfb24sXG4gIG9wdF90cmFuc2llbnRFeHBlcmltZW50KSB7XG4gIGNvbnN0IGN1cnJlbnRseU9uID0gaXNFeHBlcmltZW50T24od2luLCAvKk9LKi9leHBlcmltZW50SWQpO1xuICBjb25zdCBvbiA9ICEhKG9wdF9vbiAhPT0gdW5kZWZpbmVkID8gb3B0X29uIDogIWN1cnJlbnRseU9uKTtcbiAgaWYgKG9uICE9IGN1cnJlbnRseU9uKSB7XG4gICAgY29uc3QgdG9nZ2xlcyA9IGV4cGVyaW1lbnRUb2dnbGVzKHdpbik7XG4gICAgdG9nZ2xlc1tleHBlcmltZW50SWRdID0gb247XG5cbiAgICBpZiAoIW9wdF90cmFuc2llbnRFeHBlcmltZW50KSB7XG4gICAgICBjb25zdCBjb29raWVUb2dnbGVzID0gZ2V0RXhwZXJpbWVudFRvZ2dsZXNGcm9tQ29va2llKHdpbik7XG4gICAgICBjb29raWVUb2dnbGVzW2V4cGVyaW1lbnRJZF0gPSBvbjtcbiAgICAgIHNhdmVFeHBlcmltZW50VG9nZ2xlc1RvQ29va2llKHdpbiwgY29va2llVG9nZ2xlcyk7XG4gICAgfVxuICB9XG4gIHJldHVybiBvbjtcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgd2hldGhlciB0aGUgZXhwZXJpbWVudCBpcyBvbiBvciBvZmYgYmFzZWQgb2ZmIG9mIHRoZVxuICogY29va2llRmxhZyBvciB0aGUgZ2xvYmFsIGNvbmZpZyBmcmVxdWVuY3kgZ2l2ZW4uXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IU9iamVjdDxzdHJpbmcsIGJvb2xlYW4+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhwZXJpbWVudFRvZ2dsZXMod2luKSB7XG4gIGlmICh3aW5bVE9HR0xFU19XSU5ET1dfUFJPUEVSVFldKSB7XG4gICAgcmV0dXJuIHdpbltUT0dHTEVTX1dJTkRPV19QUk9QRVJUWV07XG4gIH1cbiAgd2luW1RPR0dMRVNfV0lORE9XX1BST1BFUlRZXSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIGNvbnN0IHRvZ2dsZXMgPSB3aW5bVE9HR0xFU19XSU5ET1dfUFJPUEVSVFldO1xuXG4gIC8vIFJlYWQgdGhlIGRlZmF1bHQgY29uZmlnIG9mIHRoaXMgYnVpbGQuXG4gIGlmICh3aW4uQU1QX0NPTkZJRykge1xuICAgIGZvciAoY29uc3QgZXhwZXJpbWVudElkIGluIHdpbi5BTVBfQ09ORklHKSB7XG4gICAgICBjb25zdCBmcmVxdWVuY3kgPSB3aW4uQU1QX0NPTkZJR1tleHBlcmltZW50SWRdO1xuICAgICAgaWYgKHR5cGVvZiBmcmVxdWVuY3kgPT09ICdudW1iZXInICYmIGZyZXF1ZW5jeSA+PSAwICYmIGZyZXF1ZW5jeSA8PSAxKSB7XG4gICAgICAgIHRvZ2dsZXNbZXhwZXJpbWVudElkXSA9IE1hdGgucmFuZG9tKCkgPCBmcmVxdWVuY3k7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIC8vIFJlYWQgZG9jdW1lbnQgbGV2ZWwgb3ZlcnJpZGUgZnJvbSBtZXRhIHRhZy5cbiAgaWYgKHdpbi5BTVBfQ09ORklHXG4gICAgICAmJiBBcnJheS5pc0FycmF5KHdpbi5BTVBfQ09ORklHWydhbGxvdy1kb2Mtb3B0LWluJ10pXG4gICAgICAmJiB3aW4uQU1QX0NPTkZJR1snYWxsb3ctZG9jLW9wdC1pbiddLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCBhbGxvd2VkID0gd2luLkFNUF9DT05GSUdbJ2FsbG93LWRvYy1vcHQtaW4nXTtcbiAgICBjb25zdCBtZXRhID1cbiAgICAgICAgd2luLmRvY3VtZW50LmhlYWQucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPVwiYW1wLWV4cGVyaW1lbnRzLW9wdC1pblwiXScpO1xuICAgIGlmIChtZXRhKSB7XG4gICAgICBjb25zdCBvcHRlZEluRXhwZXJpbWVudHMgPSBtZXRhLmdldEF0dHJpYnV0ZSgnY29udGVudCcpLnNwbGl0KCcsJyk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wdGVkSW5FeHBlcmltZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoYWxsb3dlZC5pbmRleE9mKG9wdGVkSW5FeHBlcmltZW50c1tpXSkgIT0gLTEpIHtcbiAgICAgICAgICB0b2dnbGVzW29wdGVkSW5FeHBlcmltZW50c1tpXV0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgT2JqZWN0LmFzc2lnbih0b2dnbGVzLCBnZXRFeHBlcmltZW50VG9nZ2xlc0Zyb21Db29raWUod2luKSk7XG5cbiAgaWYgKHdpbi5BTVBfQ09ORklHXG4gICAgICAmJiBBcnJheS5pc0FycmF5KHdpbi5BTVBfQ09ORklHWydhbGxvdy11cmwtb3B0LWluJ10pXG4gICAgICAmJiB3aW4uQU1QX0NPTkZJR1snYWxsb3ctdXJsLW9wdC1pbiddLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCBhbGxvd2VkID0gd2luLkFNUF9DT05GSUdbJ2FsbG93LXVybC1vcHQtaW4nXTtcbiAgICBjb25zdCBoYXNoID0gd2luLmxvY2F0aW9uLm9yaWdpbmFsSGFzaCB8fCB3aW4ubG9jYXRpb24uaGFzaDtcbiAgICBjb25zdCBwYXJhbXMgPSBwYXJzZVF1ZXJ5U3RyaW5nKGhhc2gpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWxsb3dlZC5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgcGFyYW0gPSBwYXJhbXNbYGUtJHthbGxvd2VkW2ldfWBdO1xuICAgICAgaWYgKHBhcmFtID09ICcxJykge1xuICAgICAgICB0b2dnbGVzW2FsbG93ZWRbaV1dID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmIChwYXJhbSA9PSAnMCcpIHtcbiAgICAgICAgdG9nZ2xlc1thbGxvd2VkW2ldXSA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gdG9nZ2xlcztcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBjYWNoZWQgZXhwZXJpbWVudHMgdG9nZ2xlcywgb3IgbnVsbCBpZiB0aGV5IGhhdmUgbm90IGJlZW5cbiAqIGNvbXB1dGVkIHlldC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtPYmplY3Q8c3RyaW5nLCBib29sZWFuPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4cGVyaW1lbnRUb2dnbGVzT3JOdWxsKHdpbikge1xuICByZXR1cm4gd2luW1RPR0dMRVNfV0lORE9XX1BST1BFUlRZXSB8fCBudWxsO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBzZXQgb2YgZXhwZXJpbWVudCBJRHMgY3VycmVudGx5IG9uLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPn1cbiAqL1xuZnVuY3Rpb24gZ2V0RXhwZXJpbWVudFRvZ2dsZXNGcm9tQ29va2llKHdpbikge1xuICBjb25zdCBleHBlcmltZW50Q29va2llID0gZ2V0Q29va2llKHdpbiwgQ09PS0lFX05BTUUpO1xuICBjb25zdCB0b2tlbnMgPSBleHBlcmltZW50Q29va2llID8gZXhwZXJpbWVudENvb2tpZS5zcGxpdCgvXFxzKixcXHMqL2cpIDogW107XG5cbiAgY29uc3QgdG9nZ2xlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdG9rZW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKHRva2Vuc1tpXS5sZW5ndGggPT0gMCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmICh0b2tlbnNbaV1bMF0gPT0gJy0nKSB7XG4gICAgICB0b2dnbGVzW3Rva2Vuc1tpXS5zdWJzdHIoMSldID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRvZ2dsZXNbdG9rZW5zW2ldXSA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRvZ2dsZXM7XG59XG5cbi8qKlxuICogU2F2ZXMgYSBzZXQgb2YgZXhwZXJpbWVudCBJRHMgY3VycmVudGx5IG9uLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsIGJvb2xlYW4+fSB0b2dnbGVzXG4gKi9cbmZ1bmN0aW9uIHNhdmVFeHBlcmltZW50VG9nZ2xlc1RvQ29va2llKHdpbiwgdG9nZ2xlcykge1xuICBjb25zdCBleHBlcmltZW50SWRzID0gW107XG4gIGZvciAoY29uc3QgZXhwZXJpbWVudCBpbiB0b2dnbGVzKSB7XG4gICAgZXhwZXJpbWVudElkcy5wdXNoKCh0b2dnbGVzW2V4cGVyaW1lbnRdID09PSBmYWxzZSA/ICctJyA6ICcnKSArIGV4cGVyaW1lbnQpO1xuICB9XG5cbiAgc2V0Q29va2llKHdpbiwgQ09PS0lFX05BTUUsIGV4cGVyaW1lbnRJZHMuam9pbignLCcpLFxuICAgICAgRGF0ZS5ub3coKSArIENPT0tJRV9FWFBJUkFUSU9OX0lOVEVSVkFMLCB7XG4gICAgICAgIC8vIFNldCBleHBsaWNpdCBkb21haW4sIHNvIHRoZSBjb29raWUgZ2V0cyBzZW5kIHRvIHN1YiBkb21haW5zLlxuICAgICAgICBkb21haW46IHdpbi5sb2NhdGlvbi5ob3N0bmFtZSxcbiAgICAgICAgYWxsb3dPblByb3h5T3JpZ2luOiB0cnVlLFxuICAgICAgfSk7XG59XG5cbi8qKlxuICogU2VlIGdldEV4cGVyaW1lbnRUb2dnbGVzRnJvbUNvb2tpZSgpLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPn1cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXhwZXJpbWVudFRvZ2xlc0Zyb21Db29raWVGb3JUZXN0aW5nKHdpbikge1xuICByZXR1cm4gZ2V0RXhwZXJpbWVudFRvZ2dsZXNGcm9tQ29va2llKHdpbik7XG59XG5cbi8qKlxuICogUmVzZXRzIHRoZSBleHBlcmltZW50c1RvZ2dsZSBjYWNoZSBmb3IgdGVzdGluZyBwdXJwb3Nlcy5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0RXhwZXJpbWVudFRvZ2dsZXNGb3JUZXN0aW5nKHdpbikge1xuICBzZXRDb29raWUod2luLCBDT09LSUVfTkFNRSwgJycsIDAsIHtcbiAgICBkb21haW46IHdpbi5sb2NhdGlvbi5ob3N0bmFtZSxcbiAgfSk7XG4gIHdpbltUT0dHTEVTX1dJTkRPV19QUk9QRVJUWV0gPSBudWxsO1xufVxuXG4vKipcbiAqIEluIHNvbWUgYnJvd3NlciBpbXBsZW1lbnRhdGlvbnMgb2YgTWF0aC5yYW5kb20oKSwgc2VxdWVudGlhbCBjYWxscyBvZlxuICogTWF0aC5yYW5kb20oKSBhcmUgY29ycmVsYXRlZCBhbmQgY2FuIGNhdXNlIGEgYmlhcy4gIEluIHBhcnRpY3VsYXIsXG4gKiBpZiB0aGUgcHJldmlvdXMgcmFuZG9tKCkgY2FsbCB3YXMgPCAwLjAwMSAoYXMgaXQgd2lsbCBiZSBpZiB3ZSBzZWxlY3RcbiAqIGludG8gYW4gZXhwZXJpbWVudCksIHRoZSBuZXh0IHZhbHVlIGNvdWxkIGJlIGxlc3MgdGhhbiAwLjUgbW9yZSB0aGFuXG4gKiA1MC43JSBvZiB0aGUgdGltZS4gIFRoaXMgcHJvdmlkZXMgYW4gaW1wbGVtZW50YXRpb24gdGhhdCByb290cyBkb3duIGludG9cbiAqIHRoZSBjcnlwdG8gQVBJLCB3aGVuIGF2YWlsYWJsZSwgdG8gcHJvZHVjZSBsZXNzIGJpYXNlZCBzYW1wbGVzLlxuICpcbiAqIEByZXR1cm4ge251bWJlcn0gUHNldWRvLXJhbmRvbSBmbG9hdGluZy1wb2ludCB2YWx1ZSBvbiB0aGUgcmFuZ2UgWzAsIDEpLlxuICovXG5mdW5jdGlvbiBzbG93QnV0QWNjdXJhdGVQcm5nKCkge1xuICAvLyBUT0RPKHRkcmwpOiBJbXBsZW1lbnQuXG4gIHJldHVybiBNYXRoLnJhbmRvbSgpO1xufVxuXG4vKipcbiAqIENvbnRhaW5lciBmb3IgYWx0ZXJuYXRlIHJhbmRvbSBudW1iZXIgZ2VuZXJhdG9yIGltcGxlbWVudGF0aW9ucy4gIFRoaXNcbiAqIGFsbG93cyB1cyB0byBzZXQgYW4gXCJhY2N1cmF0ZVwiIFBSTkcgZm9yIGJyYW5jaCBzZWxlY3Rpb24sIGJ1dCB0byBtb2NrIGl0XG4gKiBvdXQgZWFzaWx5IGluIHRlc3RzLlxuICpcbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICogQGNvbnN0IHshe2FjY3VyYXRlUHJuZzogZnVuY3Rpb24oKTpudW1iZXJ9fVxuICovXG5leHBvcnQgY29uc3QgUkFORE9NX05VTUJFUl9HRU5FUkFUT1JTID0ge1xuICBhY2N1cmF0ZVBybmc6IHNsb3dCdXRBY2N1cmF0ZVBybmcsXG59O1xuXG4vKipcbiAqIFNlbGVjdHMsIHVuaWZvcm1seSBhdCByYW5kb20sIGEgc2luZ2xlIGl0ZW0gZnJvbSB0aGUgYXJyYXkuXG4gKiBAcGFyYW0geyFBcnJheTxzdHJpbmc+fSBhcnIgT2JqZWN0IHRvIHNlbGVjdCBmcm9tLlxuICogQHJldHVybiB7P3N0cmluZ30gU2luZ2xlIGl0ZW0gZnJvbSBhcnIgb3IgbnVsbCBpZiBhcnIgd2FzIGVtcHR5LlxuICovXG5mdW5jdGlvbiBzZWxlY3RSYW5kb21JdGVtKGFycikge1xuICBjb25zdCBybiA9IFJBTkRPTV9OVU1CRVJfR0VORVJBVE9SUy5hY2N1cmF0ZVBybmcoKTtcbiAgcmV0dXJuIGFycltNYXRoLmZsb29yKHJuICogYXJyLmxlbmd0aCldIHx8IG51bGw7XG59XG5cbi8qKlxuICogU2VsZWN0cyB3aGljaCBwYWdlLWxldmVsIGV4cGVyaW1lbnQgYnJhbmNoZXMgYXJlIGVuYWJsZWQuIElmIGEgZ2l2ZW5cbiAqIGV4cGVyaW1lbnQgbmFtZSBpcyBhbHJlYWR5IHNldCAoaW5jbHVkaW5nIHRvIHRoZSBudWxsIC8gbm8gYnJhbmNoZXMgc2VsZWN0ZWRcbiAqIHN0YXRlKSwgdGhpcyB3b24ndCBhbHRlciBpdHMgc3RhdGUuXG4gKlxuICogQ2hlY2sgd2hldGhlciBhIGdpdmVuIGV4cGVyaW1lbnQgaXMgc2V0IHVzaW5nIGlzRXhwZXJpbWVudE9uKHdpbixcbiAqIGV4cGVyaW1lbnROYW1lKSBhbmQsIGlmIGl0IGlzIG9uLCBsb29rIGZvciB3aGljaCBicmFuY2ggaXMgc2VsZWN0ZWQgaW5cbiAqIHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luIFdpbmRvdyBjb250ZXh0IG9uIHdoaWNoIHRvIHNhdmUgZXhwZXJpbWVudFxuICogICAgIHNlbGVjdGlvbiBzdGF0ZS5cbiAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICFFeHBlcmltZW50SW5mbz59IGV4cGVyaW1lbnRzICBTZXQgb2YgZXhwZXJpbWVudHMgdG9cbiAqICAgICBjb25maWd1cmUgZm9yIHRoaXMgcGFnZSBsb2FkLlxuICogQHJldHVybiB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59IE1hcCBvZiBleHBlcmltZW50IG5hbWVzIHRvIHNlbGVjdGVkXG4gKiAgICAgYnJhbmNoZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByYW5kb21seVNlbGVjdFVuc2V0RXhwZXJpbWVudHMod2luLCBleHBlcmltZW50cykge1xuICB3aW4uZXhwZXJpbWVudEJyYW5jaGVzID0gd2luLmV4cGVyaW1lbnRCcmFuY2hlcyB8fCB7fTtcbiAgY29uc3Qgc2VsZWN0ZWRFeHBlcmltZW50cyA9IHt9O1xuICBmb3IgKGNvbnN0IGV4cGVyaW1lbnROYW1lIGluIGV4cGVyaW1lbnRzKSB7XG4gICAgLy8gU2tpcCBleHBlcmltZW50TmFtZSBpZiBpdCBpcyBub3QgYSBrZXkgb2YgZXhwZXJpbWVudHMgb2JqZWN0IG9yIGlmIGl0XG4gICAgLy8gaGFzIGFscmVhZHkgYmVlbiBwb3B1bGF0ZWQgYnkgc29tZSBvdGhlciBwcm9wZXJ0eS5cbiAgICBpZiAoIWhhc093bihleHBlcmltZW50cywgZXhwZXJpbWVudE5hbWUpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKGhhc093bih3aW4uZXhwZXJpbWVudEJyYW5jaGVzLCBleHBlcmltZW50TmFtZSkpIHtcbiAgICAgIHNlbGVjdGVkRXhwZXJpbWVudHNbZXhwZXJpbWVudE5hbWVdID1cbiAgICAgICAgICB3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmICghZXhwZXJpbWVudHNbZXhwZXJpbWVudE5hbWVdLmlzVHJhZmZpY0VsaWdpYmxlIHx8XG4gICAgICAgICFleHBlcmltZW50c1tleHBlcmltZW50TmFtZV0uaXNUcmFmZmljRWxpZ2libGUod2luKSkge1xuICAgICAgd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV0gPSBudWxsO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgLy8gSWYgd2UncmUgaW4gdGhlIGV4cGVyaW1lbnQsIGJ1dCB3ZSBoYXZlbid0IGFscmVhZHkgZm9yY2VkIGEgc3BlY2lmaWNcbiAgICAvLyBleHBlcmltZW50IGJyYW5jaCAoZS5nLiwgdmlhIGEgdGVzdCBzZXR1cCksIHRoZW4gcmFuZG9taXplIHRoZSBicmFuY2hcbiAgICAvLyBjaG9pY2UuXG4gICAgaWYgKCF3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXSAmJlxuICAgICAgaXNFeHBlcmltZW50T24od2luLCAvKk9LKi9leHBlcmltZW50TmFtZSkpIHtcbiAgICAgIGNvbnN0IHticmFuY2hlc30gPSBleHBlcmltZW50c1tleHBlcmltZW50TmFtZV07XG4gICAgICB3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXSA9IHNlbGVjdFJhbmRvbUl0ZW0oYnJhbmNoZXMpO1xuICAgICAgc2VsZWN0ZWRFeHBlcmltZW50c1tleHBlcmltZW50TmFtZV0gPVxuICAgICAgICAgIHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdO1xuICAgIH1cbiAgfVxuICByZXR1cm4gc2VsZWN0ZWRFeHBlcmltZW50cztcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBleHBlcmltZW50IGJyYW5jaCBlbmFibGVkIGZvciB0aGUgZ2l2ZW4gZXhwZXJpbWVudCBJRC5cbiAqIEZvciBleGFtcGxlLCAnY29udHJvbCcgb3IgJ2V4cGVyaW1lbnQnLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luIFdpbmRvdyBjb250ZXh0IHRvIGNoZWNrIGZvciBleHBlcmltZW50IHN0YXRlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4cGVyaW1lbnROYW1lIE5hbWUgb2YgdGhlIGV4cGVyaW1lbnQgdG8gY2hlY2suXG4gKiBAcmV0dXJuIHs/c3RyaW5nfSBBY3RpdmUgZXhwZXJpbWVudCBicmFuY2ggSUQgZm9yIGV4cGVyaW1lbnROYW1lIChwb3NzaWJseVxuICogICAgIG51bGwgaWYgZXhwZXJpbWVudE5hbWUgaGFzIGJlZW4gdGVzdGVkIGJ1dCBubyBicmFuY2ggd2FzIGVuYWJsZWQpLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXhwZXJpbWVudEJyYW5jaCh3aW4sIGV4cGVyaW1lbnROYW1lKSB7XG4gIHJldHVybiB3aW4uZXhwZXJpbWVudEJyYW5jaGVzID8gd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV0gOiBudWxsO1xufVxuXG4vKipcbiAqIEZvcmNlIGVuYWJsZSAob3IgZGlzYWJsZSkgYSBzcGVjaWZpYyBicmFuY2ggb2YgYSBnaXZlbiBleHBlcmltZW50IG5hbWUuXG4gKiBEaXNhYmxlcyB0aGUgZXhwZXJpbWVudCBuYW1lIGFsdG9nZXRoZXIgaWYgYnJhbmNoSWQgaXMgZmFsc2Vpc2guXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW4gV2luZG93IGNvbnRleHQgdG8gY2hlY2sgZm9yIGV4cGVyaW1lbnQgc3RhdGUuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXhwZXJpbWVudE5hbWUgTmFtZSBvZiB0aGUgZXhwZXJpbWVudCB0byBjaGVjay5cbiAqIEBwYXJhbSB7P3N0cmluZ30gYnJhbmNoSWQgSUQgb2YgYnJhbmNoIHRvIGZvcmNlIG9yIG51bGwgdG8gZGlzYWJsZVxuICogICAgIGFsdG9nZXRoZXIuXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZvcmNlRXhwZXJpbWVudEJyYW5jaCh3aW4sIGV4cGVyaW1lbnROYW1lLCBicmFuY2hJZCkge1xuICB3aW4uZXhwZXJpbWVudEJyYW5jaGVzID0gd2luLmV4cGVyaW1lbnRCcmFuY2hlcyB8fCB7fTtcbiAgdG9nZ2xlRXhwZXJpbWVudCh3aW4sIGV4cGVyaW1lbnROYW1lLCAhIWJyYW5jaElkLCB0cnVlKTtcbiAgd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV0gPSBicmFuY2hJZDtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogQHBhcmFtIHtudW1iZXI9fSBvcHRfYmFzZSBFeHBvbmVudGlhbCBiYXNlLiBEZWZhdWx0cyB0byAyLlxuICogQHJldHVybiB7ZnVuY3Rpb24oZnVuY3Rpb24oKSk6IG51bWJlcn0gRnVuY3Rpb24gdGhhdCB3aGVuIGludm9rZWQgd2lsbFxuICogICAgIGNhbGwgdGhlIHBhc3NlZCBpbiBmdW5jdGlvbi4gT24gZXZlcnkgaW52b2NhdGlvbiB0aGUgbmV4dFxuICogICAgIGludm9jYXRpb24gb2YgdGhlIHBhc3NlZCBpbiBmdW5jdGlvbiB3aWxsIGJlIGV4cG9uZW50aWFsbHlcbiAqICAgICBsYXRlci4gUmV0dXJuZWQgZnVuY3Rpb24gcmV0dXJucyB0aW1lb3V0IGlkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhwb25lbnRpYWxCYWNrb2ZmKG9wdF9iYXNlKSB7XG4gIGNvbnN0IGdldFRpbWVvdXQgPSBleHBvbmVudGlhbEJhY2tvZmZDbG9jayhvcHRfYmFzZSk7XG4gIHJldHVybiB3b3JrID0+IHtcbiAgICByZXR1cm4gc2V0VGltZW91dCh3b3JrLCBnZXRUaW1lb3V0KCkpO1xuICB9O1xufVxuXG4vKipcbiAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0X2Jhc2UgRXhwb25lbnRpYWwgYmFzZS4gRGVmYXVsdHMgdG8gMi5cbiAqIEByZXR1cm4ge2Z1bmN0aW9uKCk6IG51bWJlcn0gRnVuY3Rpb24gdGhhdCB3aGVuIGludm9rZWQgd2lsbCByZXR1cm5cbiAqICAgIGEgbnVtYmVyIHRoYXQgZXhwb25lbnRpYWxseSBncm93cyBwZXIgaW52b2NhdGlvbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4cG9uZW50aWFsQmFja29mZkNsb2NrKG9wdF9iYXNlKSB7XG4gIGNvbnN0IGJhc2UgPSBvcHRfYmFzZSB8fCAyO1xuICBsZXQgY291bnQgPSAwO1xuICByZXR1cm4gKCkgPT4ge1xuICAgIGxldCB3YWl0ID0gTWF0aC5wb3coYmFzZSwgY291bnQrKyk7XG4gICAgd2FpdCArPSBnZXRKaXR0ZXIod2FpdCk7XG4gICAgcmV0dXJuIHdhaXQgKiAxMDAwO1xuICB9O1xufVxuXG4vKipcbiAqIEFkZCBqaXR0ZXIgdG8gYXZvaWQgdGhlIHRodW5kZXJpbmcgaGVyZC4gVGhpcyBjYW4gZS5nLiBoYXBwZW4gd2hlblxuICogd2UgcG9sbCBhIGJhY2tlbmQgYW5kIGl0IGZhaWxzIGZvciBldmVyeW9uZSBhdCB0aGUgc2FtZSB0aW1lLlxuICogV2UgYWRkIHVwIHRvIDMwJSAoZGVmYXVsdCkgbG9uZ2VyIG9yIHNob3J0ZXIgdGhhbiB0aGUgZ2l2ZW4gdGltZS5cbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gd2FpdCB0aGUgYW1vdW50IGlmIGJhc2UgbWlsbGlzZWNvbmRzXG4gKiBAcGFyYW0ge251bWJlcj19IG9wdF9wZXJjIHRoZSBtaW4vbWF4IHBlcmNlbnRhZ2UgdG8gYWRkIG9yIHN1dHJhY3RcbiAqIEByZXR1cm4ge251bWJlcn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEppdHRlcih3YWl0LCBvcHRfcGVyYykge1xuICBvcHRfcGVyYyA9IG9wdF9wZXJjIHx8IC4zO1xuICBsZXQgaml0dGVyID0gd2FpdCAqIG9wdF9wZXJjICogTWF0aC5yYW5kb20oKTtcbiAgaWYgKE1hdGgucmFuZG9tKCkgPiAuNSkge1xuICAgIGppdHRlciAqPSAtMTtcbiAgfVxuICByZXR1cm4gaml0dGVyO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQGZpbGVvdmVydmlldyBUaGlzIG1vZHVsZSBkZWNsYXJlcyBKU09OIHR5cGVzIGFzIGRlZmluZWQgaW4gdGhlXG4gKiB7QGxpbmsgaHR0cDovL2pzb24ub3JnL30uXG4gKi9cblxuaW1wb3J0IHtpc09iamVjdH0gZnJvbSAnLi90eXBlcyc7XG5cblxuLy8gTk9URSBUeXBlIGFyZSBjaGFuZ2VkIHRvIHsqfSBiZWNhdXNlIG9mXG4vLyBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2Nsb3N1cmUtY29tcGlsZXIvaXNzdWVzLzE5OTlcblxuLyoqXG4gKiBKU09OIHNjYWxhci4gSXQncyBlaXRoZXIgc3RyaW5nLCBudW1iZXIgb3IgYm9vbGVhbi5cbiAqIEB0eXBlZGVmIHsqfSBzaG91bGQgYmUgc3RyaW5nfG51bWJlcnxib29sZWFuXG4gKi9cbmxldCBKU09OU2NhbGFyRGVmO1xuXG5cbi8qKlxuICogSlNPTiBvYmplY3QuIEl0J3MgYSBtYXAgd2l0aCBzdHJpbmcga2V5cyBhbmQgSlNPTiB2YWx1ZXMuXG4gKiBAdHlwZWRlZiB7Kn0gc2hvdWxkIGJlICFPYmplY3Q8c3RyaW5nLCA/SlNPTlZhbHVlRGVmPlxuICovXG5sZXQgSlNPTk9iamVjdERlZjtcblxuXG4vKipcbiAqIEpTT04gYXJyYXkuIEl0J3MgYW4gYXJyYXkgd2l0aCBKU09OIHZhbHVlcy5cbiAqIEB0eXBlZGVmIHsqfSBzaG91bGQgYmUgIUFycmF5PD9KU09OVmFsdWVEZWY+XG4gKi9cbmxldCBKU09OQXJyYXlEZWY7XG5cblxuLyoqXG4gKiBKU09OIHZhbHVlLiBJdCdzIGVpdGhlciBhIHNjYWxhciwgYW4gb2JqZWN0IG9yIGFuIGFycmF5LlxuICogQHR5cGVkZWYgeyp9IHNob3VsZCBiZSAhSlNPTlNjYWxhckRlZnwhSlNPTk9iamVjdERlZnwhSlNPTkFycmF5RGVmXG4gKi9cbmxldCBKU09OVmFsdWVEZWY7XG5cbi8qKlxuICogUmVjcmVhdGVzIG9iamVjdHMgd2l0aCBwcm90b3R5cGUtbGVzcyBjb3BpZXMuXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0fSBvYmpcbiAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVjcmVhdGVOb25Qcm90b09iamVjdChvYmopIHtcbiAgY29uc3QgY29weSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIGZvciAoY29uc3QgayBpbiBvYmopIHtcbiAgICBpZiAoIWhhc093blByb3BlcnR5KG9iaiwgaykpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBjb25zdCB2ID0gb2JqW2tdO1xuICAgIGNvcHlba10gPSBpc09iamVjdCh2KSA/IHJlY3JlYXRlTm9uUHJvdG9PYmplY3QodikgOiB2O1xuICB9XG4gIHJldHVybiAvKiogQHR5cGUgeyFKc29uT2JqZWN0fSAqLyAoY29weSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHZhbHVlIGZyb20gYW4gb2JqZWN0IGZvciBhIGZpZWxkLWJhc2VkIGV4cHJlc3Npb24uIFRoZSBleHByZXNzaW9uXG4gKiBpcyBhIHNpbXBsZSBuZXN0ZWQgZG90LW5vdGF0aW9uIG9mIGZpZWxkcywgc3VjaCBhcyBgZmllbGQxLmZpZWxkMmAuIElmIGFueVxuICogZmllbGQgaW4gYSBjaGFpbiBkb2VzIG5vdCBleGlzdCBvciBpcyBub3QgYW4gb2JqZWN0IG9yIGFycmF5LCB0aGUgcmV0dXJuZWRcbiAqIHZhbHVlIHdpbGwgYmUgYHVuZGVmaW5lZGAuXG4gKlxuICogQHBhcmFtIHshSnNvbk9iamVjdH0gb2JqXG4gKiBAcGFyYW0ge3N0cmluZ30gZXhwclxuICogQHJldHVybiB7Kn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFZhbHVlRm9yRXhwcihvYmosIGV4cHIpIHtcbiAgLy8gVGhlIGAuYCBpbmRpY2F0ZXMgXCJ0aGUgb2JqZWN0IGl0c2VsZlwiLlxuICBpZiAoZXhwciA9PSAnLicpIHtcbiAgICByZXR1cm4gb2JqO1xuICB9XG4gIC8vIE90aGVyd2lzZSwgbmF2aWdhdGUgdmlhIHByb3BlcnRpZXMuXG4gIGNvbnN0IHBhcnRzID0gZXhwci5zcGxpdCgnLicpO1xuICBsZXQgdmFsdWUgPSBvYmo7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcGFydHMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBwYXJ0ID0gcGFydHNbaV07XG4gICAgaWYgKHBhcnQgJiZcbiAgICAgICAgdmFsdWUgJiZcbiAgICAgICAgdmFsdWVbcGFydF0gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICBoYXNPd25Qcm9wZXJ0eSh2YWx1ZSwgcGFydClcbiAgICApIHtcbiAgICAgIHZhbHVlID0gdmFsdWVbcGFydF07XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgdmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgYnJlYWs7XG4gIH1cbiAgcmV0dXJuIHZhbHVlO1xufVxuXG4vKipcbiAqIFNpbXBsZSB3cmFwcGVyIGFyb3VuZCBKU09OLnBhcnNlIHRoYXQgY2FzdHMgdGhlIHJldHVybiB2YWx1ZVxuICogdG8gSnNvbk9iamVjdC5cbiAqIENyZWF0ZSBhIG5ldyB3cmFwcGVyIGlmIGFuIGFycmF5IHJldHVybiB2YWx1ZSBpcyBkZXNpcmVkLlxuICogQHBhcmFtIHsqfSBqc29uIEpTT04gc3RyaW5nIHRvIHBhcnNlXG4gKiBAcmV0dXJuIHs/SnNvbk9iamVjdH0gTWF5IGJlIGV4dGVuZCB0byBwYXJzZSBhcnJheXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUpzb24oanNvbikge1xuICByZXR1cm4gLyoqIEB0eXBlIHs/SnNvbk9iamVjdH0gKi8oSlNPTi5wYXJzZSgvKiogQHR5cGUge3N0cmluZ30gKi8gKGpzb24pKSk7XG59XG5cbi8qKlxuICogUGFyc2VzIHRoZSBnaXZlbiBganNvbmAgc3RyaW5nIHdpdGhvdXQgdGhyb3dpbmcgYW4gZXhjZXB0aW9uIGlmIG5vdCB2YWxpZC5cbiAqIFJldHVybnMgYHVuZGVmaW5lZGAgaWYgcGFyc2luZyBmYWlscy5cbiAqIFJldHVybnMgdGhlIGBPYmplY3RgIGNvcnJlc3BvbmRpbmcgdG8gdGhlIEpTT04gc3RyaW5nIHdoZW4gcGFyc2luZyBzdWNjZWVkcy5cbiAqIEBwYXJhbSB7Kn0ganNvbiBKU09OIHN0cmluZyB0byBwYXJzZVxuICogQHBhcmFtIHtmdW5jdGlvbighRXJyb3IpPX0gb3B0X29uRmFpbGVkIE9wdGlvbmFsIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWRcbiAqICAgICB3aXRoIHRoZSBlcnJvciBpZiBwYXJzaW5nIGZhaWxzLlxuICogQHJldHVybiB7P0pzb25PYmplY3R8dW5kZWZpbmVkfSBNYXkgYmUgZXh0ZW5kIHRvIHBhcnNlIGFycmF5cy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyeVBhcnNlSnNvbihqc29uLCBvcHRfb25GYWlsZWQpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gcGFyc2VKc29uKGpzb24pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgaWYgKG9wdF9vbkZhaWxlZCkge1xuICAgICAgb3B0X29uRmFpbGVkKGUpO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59XG5cbi8qKlxuICogUmVjdXJzaXZlbHkgY2hlY2tzIHN0cmljdCBlcXVhbGl0eSBvZiBpdGVtcyBpbiBuZXN0ZWQgYXJyYXlzIGFuZCBvYmplY3RzLlxuICpcbiAqIEBwYXJhbSB7SlNPTlZhbHVlRGVmfSBhXG4gKiBAcGFyYW0ge0pTT05WYWx1ZURlZn0gYlxuICogQHBhcmFtIHtudW1iZXJ9IGRlcHRoIFRoZSBtYXhpbXVtIHJlY3Vyc2lvbiBkZXB0aC4gTXVzdCBiZSBmaW5pdGUuXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHRocm93cyB7RXJyb3J9IElmIGRlcHRoIGFyZ3VtZW50IGlzIG5vdCBmaW5pdGUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWN1cnNpdmVFcXVhbHMoYSwgYiwgZGVwdGggPSAzKSB7XG4gIGlmICghaXNGaW5pdGUoZGVwdGgpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdkZXB0aCBhcmcgbXVzdCBiZSBmaW5pdGU6ICcgKyBkZXB0aCk7XG4gIH1cbiAgaWYgKGEgPT09IGIpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICAvLyBPbmx5IGNoZWNrIHNoYWxsb3cgZXF1YWxpdHkgZm9yIGRlcHRoIDwgMS5cbiAgaWYgKGRlcHRoIDwgMSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBpZiAodHlwZW9mIGEgIT09IHR5cGVvZiBiKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmIChBcnJheS5pc0FycmF5KGEpICYmIEFycmF5LmlzQXJyYXkoYikpIHtcbiAgICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKCFyZWN1cnNpdmVFcXVhbHMoYVtpXSwgYltpXSwgZGVwdGggLSAxKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGlmIChhICYmIGIgJiYgdHlwZW9mIGEgPT09ICdvYmplY3QnICYmIHR5cGVvZiBiID09PSAnb2JqZWN0Jykge1xuICAgIGNvbnN0IGtleXNBID0gT2JqZWN0LmtleXMoLyoqIEB0eXBlIHshT2JqZWN0fSAqLyAoYSkpO1xuICAgIGNvbnN0IGtleXNCID0gT2JqZWN0LmtleXMoLyoqIEB0eXBlIHshT2JqZWN0fSAqLyAoYikpO1xuICAgIGlmIChrZXlzQS5sZW5ndGggIT09IGtleXNCLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtleXNBLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBrZXlBID0ga2V5c0FbaV07XG4gICAgICBjb25zdCB2YWx1ZUEgPSBhW2tleUFdO1xuICAgICAgY29uc3QgdmFsdWVCID0gYltrZXlBXTtcbiAgICAgIGlmICghcmVjdXJzaXZlRXF1YWxzKHZhbHVlQSwgdmFsdWVCLCBkZXB0aCAtIDEpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHsqfSBvYmpcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXlcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGhhc093blByb3BlcnR5KG9iaiwga2V5KSB7XG4gIGlmIChvYmogPT0gbnVsbCB8fCB0eXBlb2Ygb2JqICE9ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoXG4gICAgICAvKiogQHR5cGUgeyFPYmplY3R9ICovIChvYmopLCBrZXkpO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7Z2V0TW9kZX0gZnJvbSAnLi9tb2RlJztcbmltcG9ydCB7Z2V0TW9kZU9iamVjdH0gZnJvbSAnLi9tb2RlLW9iamVjdCc7XG5pbXBvcnQge2lzRW51bVZhbHVlfSBmcm9tICcuL3R5cGVzJztcblxuLyoqXG4gKiBUcmlwbGUgemVybyB3aWR0aCBzcGFjZS5cbiAqXG4gKiBUaGlzIGlzIGFkZGVkIHRvIHVzZXIgZXJyb3IgbWVzc2FnZXMsIHNvIHRoYXQgd2UgY2FuIGxhdGVyIGlkZW50aWZ5XG4gKiB0aGVtLCB3aGVuIHRoZSBvbmx5IHRoaW5nIHRoYXQgd2UgaGF2ZSBpcyB0aGUgbWVzc2FnZS4gVGhpcyBpcyB0aGVcbiAqIGNhc2UgaW4gbWFueSBicm93c2VycyB3aGVuIHRoZSBnbG9iYWwgZXhjZXB0aW9uIGhhbmRsZXIgaXMgaW52b2tlZC5cbiAqXG4gKiBAY29uc3Qge3N0cmluZ31cbiAqL1xuZXhwb3J0IGNvbnN0IFVTRVJfRVJST1JfU0VOVElORUwgPSAnXFx1MjAwQlxcdTIwMEJcXHUyMDBCJztcblxuXG4vKipcbiAqIEZvdXIgemVybyB3aWR0aCBzcGFjZS5cbiAqXG4gKiBAY29uc3Qge3N0cmluZ31cbiAqL1xuZXhwb3J0IGNvbnN0IFVTRVJfRVJST1JfRU1CRURfU0VOVElORUwgPSAnXFx1MjAwQlxcdTIwMEJcXHUyMDBCXFx1MjAwQic7XG5cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZVxuICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIG1lc3NhZ2Ugd2FzIGEgdXNlciBlcnJvci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVXNlckVycm9yTWVzc2FnZShtZXNzYWdlKSB7XG4gIHJldHVybiBtZXNzYWdlLmluZGV4T2YoVVNFUl9FUlJPUl9TRU5USU5FTCkgPj0gMDtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZVxuICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIG1lc3NhZ2Ugd2FzIGEgYSB1c2VyIGVycm9yIGZyb20gYW4gaWZyYW1lIGVtYmVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNVc2VyRXJyb3JFbWJlZChtZXNzYWdlKSB7XG4gIHJldHVybiBtZXNzYWdlLmluZGV4T2YoVVNFUl9FUlJPUl9FTUJFRF9TRU5USU5FTCkgPj0gMDtcbn1cblxuXG4vKipcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJpdmF0ZSBWaXNpYmxlIGZvciB0ZXN0aW5nIG9ubHkuXG4gKi9cbmV4cG9ydCBjb25zdCBMb2dMZXZlbCA9IHtcbiAgT0ZGOiAwLFxuICBFUlJPUjogMSxcbiAgV0FSTjogMixcbiAgSU5GTzogMyxcbiAgRklORTogNCxcbn07XG5cbi8qKlxuICogU2V0cyByZXBvcnRFcnJvciBmdW5jdGlvbi4gQ2FsbGVkIGZyb20gZXJyb3IuanMgdG8gYnJlYWsgY3ljbGljXG4gKiBkZXBlbmRlbmN5LlxuICogQHBhcmFtIHtmdW5jdGlvbigqLCAhRWxlbWVudD0pfHVuZGVmaW5lZH0gZm5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFJlcG9ydEVycm9yKGZuKSB7XG4gIHNlbGYucmVwb3J0RXJyb3IgPSBmbjtcbn1cblxuLyoqXG4gKiBAdHlwZSB7IUxvZ0xldmVsfHVuZGVmaW5lZH1cbiAqIEBwcml2YXRlXG4gKi9cbmxldCBsZXZlbE92ZXJyaWRlXyA9IHVuZGVmaW5lZDtcblxuLyoqXG4gKiBAcGFyYW0geyFMb2dMZXZlbH0gbGV2ZWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG92ZXJyaWRlTG9nTGV2ZWwobGV2ZWwpIHtcbiAgbGV2ZWxPdmVycmlkZV8gPSBsZXZlbDtcbn1cblxuLyoqXG4gKiBMb2dnaW5nIGNsYXNzLiBVc2Ugb2Ygc2VudGluZWwgc3RyaW5nIGluc3RlYWQgb2YgYSBib29sZWFuIHRvIGNoZWNrIHVzZXIvZGV2XG4gKiBlcnJvcnMgYmVjYXVzZSBlcnJvcnMgY291bGQgYmUgcmV0aHJvd24gYnkgc29tZSBuYXRpdmUgY29kZSBhcyBhIG5ldyBlcnJvcixcbiAqIGFuZCBvbmx5IGEgbWVzc2FnZSB3b3VsZCBzdXJ2aXZlLiBBbHNvLCBzb21lIGJyb3dzZXIgZG9u4oCZdCBzdXBwb3J0IGEgNXRoXG4gKiBlcnJvciBvYmplY3QgYXJndW1lbnQgaW4gd2luZG93Lm9uZXJyb3IuIExpc3Qgb2Ygc3VwcG9ydGluZyBicm93c2VyIGNhbiBiZVxuICogZm91bmQgaGVyZTpcbiAqIGh0dHBzOi8vYmxvZy5zZW50cnkuaW8vMjAxNi8wMS8wNC9jbGllbnQtamF2YXNjcmlwdC1yZXBvcnRpbmctd2luZG93LW9uZXJyb3IuaHRtbFxuICogQGZpbmFsXG4gKiBAcHJpdmF0ZSBWaXNpYmxlIGZvciB0ZXN0aW5nIG9ubHkuXG4gKi9cbmV4cG9ydCBjbGFzcyBMb2cge1xuICAvKipcbiAgICogb3B0X3N1ZmZpeCB3aWxsIGJlIGFwcGVuZGVkIHRvIGVycm9yIG1lc3NhZ2UgdG8gaWRlbnRpZnkgdGhlIHR5cGUgb2YgdGhlXG4gICAqIGVycm9yIG1lc3NhZ2UuIFdlIGNhbid0IHJlbHkgb24gdGhlIGVycm9yIG9iamVjdCB0byBwYXNzIGFsb25nIHRoZSB0eXBlXG4gICAqIGJlY2F1c2Ugc29tZSBicm93c2VycyBkbyBub3QgaGF2ZSB0aGlzIHBhcmFtIGluIGl0cyB3aW5kb3cub25lcnJvciBBUEkuXG4gICAqIFNlZTpcbiAgICogaHR0cHM6Ly9ibG9nLnNlbnRyeS5pby8yMDE2LzAxLzA0L2NsaWVudC1qYXZhc2NyaXB0LXJlcG9ydGluZy13aW5kb3ctb25lcnJvci5odG1sXG4gICAqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oIS4vbW9kZS5Nb2RlRGVmKTohTG9nTGV2ZWx9IGxldmVsRnVuY1xuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9zdWZmaXhcbiAgICovXG4gIGNvbnN0cnVjdG9yKHdpbiwgbGV2ZWxGdW5jLCBvcHRfc3VmZml4KSB7XG4gICAgLyoqXG4gICAgICogSW4gdGVzdHMgd2UgdXNlIHRoZSBtYWluIHRlc3Qgd2luZG93IGluc3RlYWQgb2YgdGhlIGlmcmFtZSB3aGVyZVxuICAgICAqIHRoZSB0ZXN0cyBydW5zIGJlY2F1c2Ugb25seSB0aGUgZm9ybWVyIGlzIHJlbGF5ZWQgdG8gdGhlIGNvbnNvbGUuXG4gICAgICogQGNvbnN0IHshV2luZG93fVxuICAgICAqL1xuICAgIHRoaXMud2luID0gKGdldE1vZGUoKS50ZXN0ICYmIHdpbi5BTVBfVEVTVF9JRlJBTUUpID8gd2luLnBhcmVudCA6IHdpbjtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge2Z1bmN0aW9uKCEuL21vZGUuTW9kZURlZik6IUxvZ0xldmVsfSAqL1xuICAgIHRoaXMubGV2ZWxGdW5jXyA9IGxldmVsRnVuYztcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFMb2dMZXZlbH0gKi9cbiAgICB0aGlzLmxldmVsXyA9IHRoaXMuZGVmYXVsdExldmVsXygpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7c3RyaW5nfSAqL1xuICAgIHRoaXMuc3VmZml4XyA9IG9wdF9zdWZmaXggfHwgJyc7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IUxvZ0xldmVsfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0TGV2ZWxfKCkge1xuICAgIHJldHVybiAobGV2ZWxPdmVycmlkZV8gIT09IHVuZGVmaW5lZCkgPyBsZXZlbE92ZXJyaWRlXyA6IHRoaXMubGV2ZWxfO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFMb2dMZXZlbH1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGRlZmF1bHRMZXZlbF8oKSB7XG4gICAgLy8gTm8gY29uc29sZSAtIGNhbid0IGVuYWJsZSBsb2dnaW5nLlxuICAgIGlmICghdGhpcy53aW4uY29uc29sZSB8fCAhdGhpcy53aW4uY29uc29sZS5sb2cpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5PRkY7XG4gICAgfVxuXG4gICAgLy8gTG9nZ2luZyBoYXMgYmVlbiBleHBsaWNpdGx5IGRpc2FibGVkLlxuICAgIGlmIChnZXRNb2RlKCkubG9nID09ICcwJykge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLk9GRjtcbiAgICB9XG5cbiAgICAvLyBMb2dnaW5nIGlzIGVuYWJsZWQgZm9yIHRlc3RzIGRpcmVjdGx5LlxuICAgIGlmIChnZXRNb2RlKCkudGVzdCAmJiB0aGlzLndpbi5FTkFCTEVfTE9HKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuRklORTtcbiAgICB9XG5cbiAgICAvLyBMb2NhbERldiBieSBkZWZhdWx0IGFsbG93cyBJTkZPIGxldmVsLCB1bmxlc3Mgb3ZlcnJpZGVuIGJ5IGAjbG9nYC5cbiAgICBpZiAoZ2V0TW9kZSgpLmxvY2FsRGV2ICYmICFnZXRNb2RlKCkubG9nKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuSU5GTztcbiAgICB9XG5cbiAgICAvLyBEZWxlZ2F0ZSB0byB0aGUgc3BlY2lmaWMgcmVzb2x2ZXIuXG4gICAgcmV0dXJuIHRoaXMubGV2ZWxGdW5jXyhnZXRNb2RlT2JqZWN0KCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHtzdHJpbmd9IGxldmVsXG4gICAqIEBwYXJhbSB7IUFycmF5fSBtZXNzYWdlc1xuICAgKi9cbiAgbXNnXyh0YWcsIGxldmVsLCBtZXNzYWdlcykge1xuICAgIGlmICh0aGlzLmdldExldmVsXygpICE9IExvZ0xldmVsLk9GRikge1xuICAgICAgbGV0IGZuID0gdGhpcy53aW4uY29uc29sZS5sb2c7XG4gICAgICBpZiAobGV2ZWwgPT0gJ0VSUk9SJykge1xuICAgICAgICBmbiA9IHRoaXMud2luLmNvbnNvbGUuZXJyb3IgfHwgZm47XG4gICAgICB9IGVsc2UgaWYgKGxldmVsID09ICdJTkZPJykge1xuICAgICAgICBmbiA9IHRoaXMud2luLmNvbnNvbGUuaW5mbyB8fCBmbjtcbiAgICAgIH0gZWxzZSBpZiAobGV2ZWwgPT0gJ1dBUk4nKSB7XG4gICAgICAgIGZuID0gdGhpcy53aW4uY29uc29sZS53YXJuIHx8IGZuO1xuICAgICAgfVxuICAgICAgaWYgKGdldE1vZGUoKS5sb2NhbERldikge1xuICAgICAgICBtZXNzYWdlcy51bnNoaWZ0KCdbJyArIHRhZyArICddJyk7XG4gICAgICB9XG4gICAgICBmbi5hcHBseSh0aGlzLndpbi5jb25zb2xlLCBtZXNzYWdlcyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhlIGxvZ2dpbmcgaXMgZW5hYmxlZC5cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlzRW5hYmxlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRMZXZlbF8oKSAhPSBMb2dMZXZlbC5PRkY7XG4gIH1cblxuICAvKipcbiAgICogUmVwb3J0cyBhIGZpbmUtZ3JhaW5lZCBtZXNzYWdlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICovXG4gIGZpbmUodGFnLCB2YXJfYXJncykge1xuICAgIGlmICh0aGlzLmdldExldmVsXygpID49IExvZ0xldmVsLkZJTkUpIHtcbiAgICAgIHRoaXMubXNnXyh0YWcsICdGSU5FJywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9ydHMgYSBpbmZvcm1hdGlvbmFsIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKi9cbiAgaW5mbyh0YWcsIHZhcl9hcmdzKSB7XG4gICAgaWYgKHRoaXMuZ2V0TGV2ZWxfKCkgPj0gTG9nTGV2ZWwuSU5GTykge1xuICAgICAgdGhpcy5tc2dfKHRhZywgJ0lORk8nLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVwb3J0cyBhIHdhcm5pbmcgbWVzc2FnZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqL1xuICB3YXJuKHRhZywgdmFyX2FyZ3MpIHtcbiAgICBpZiAodGhpcy5nZXRMZXZlbF8oKSA+PSBMb2dMZXZlbC5XQVJOKSB7XG4gICAgICB0aGlzLm1zZ18odGFnLCAnV0FSTicsIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGFuIGVycm9yIG1lc3NhZ2UuIElmIHRoZSBsb2dnaW5nIGlzIGRpc2FibGVkLCB0aGUgZXJyb3IgaXMgcmV0aHJvd25cbiAgICogYXN5bmNocm9ub3VzbHkuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKiBAcmV0dXJuIHshRXJyb3J8dW5kZWZpbmVkfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZXJyb3JfKHRhZywgdmFyX2FyZ3MpIHtcbiAgICBpZiAodGhpcy5nZXRMZXZlbF8oKSA+PSBMb2dMZXZlbC5FUlJPUikge1xuICAgICAgdGhpcy5tc2dfKHRhZywgJ0VSUk9SJywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGVycm9yID0gY3JlYXRlRXJyb3JWYXJncy5hcHBseShudWxsLFxuICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgICAgdGhpcy5wcmVwYXJlRXJyb3JfKGVycm9yKTtcbiAgICAgIHJldHVybiBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVwb3J0cyBhbiBlcnJvciBtZXNzYWdlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICovXG4gIGVycm9yKHRhZywgdmFyX2FyZ3MpIHtcbiAgICBjb25zdCBlcnJvciA9IHRoaXMuZXJyb3JfLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBlcnJvci5uYW1lID0gdGFnIHx8IGVycm9yLm5hbWU7XG4gICAgICAvLyByZXBvcnRFcnJvciBpcyBpbnN0YWxsZWQgZ2xvYmFsbHkgcGVyIHdpbmRvdyBpbiB0aGUgZW50cnkgcG9pbnQuXG4gICAgICBzZWxmLnJlcG9ydEVycm9yKGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVwb3J0cyBhbiBlcnJvciBtZXNzYWdlIGFuZCBtYXJrcyB3aXRoIGFuIGV4cGVjdGVkIHByb3BlcnR5LiBJZiB0aGVcbiAgICogbG9nZ2luZyBpcyBkaXNhYmxlZCwgdGhlIGVycm9yIGlzIHJldGhyb3duIGFzeW5jaHJvbm91c2x5LlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdW51c2VkVGFnXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICovXG4gIGV4cGVjdGVkRXJyb3IodW51c2VkVGFnLCB2YXJfYXJncykge1xuICAgIGNvbnN0IGVycm9yID0gdGhpcy5lcnJvcl8uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGVycm9yLmV4cGVjdGVkID0gdHJ1ZTtcbiAgICAgIC8vIHJlcG9ydEVycm9yIGlzIGluc3RhbGxlZCBnbG9iYWxseSBwZXIgd2luZG93IGluIHRoZSBlbnRyeSBwb2ludC5cbiAgICAgIHNlbGYucmVwb3J0RXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGVycm9yIG9iamVjdC5cbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKiBAcmV0dXJuIHshRXJyb3J9XG4gICAqL1xuICBjcmVhdGVFcnJvcih2YXJfYXJncykge1xuICAgIGNvbnN0IGVycm9yID0gY3JlYXRlRXJyb3JWYXJncy5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgIHRoaXMucHJlcGFyZUVycm9yXyhlcnJvcik7XG4gICAgcmV0dXJuIGVycm9yO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gZXJyb3Igb2JqZWN0IHdpdGggaXRzIGV4cGVjdGVkIHByb3BlcnR5IHNldCB0byB0cnVlLlxuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqIEByZXR1cm4geyFFcnJvcn1cbiAgICovXG4gIGNyZWF0ZUV4cGVjdGVkRXJyb3IodmFyX2FyZ3MpIHtcbiAgICBjb25zdCBlcnJvciA9IGNyZWF0ZUVycm9yVmFyZ3MuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgICB0aGlzLnByZXBhcmVFcnJvcl8oZXJyb3IpO1xuICAgIGVycm9yLmV4cGVjdGVkID0gdHJ1ZTtcbiAgICByZXR1cm4gZXJyb3I7XG4gIH1cblxuICAvKipcbiAgICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpc24ndCB0cnVlaXNoLlxuICAgKlxuICAgKiBTdXBwb3J0cyBhcmd1bWVudCBzdWJzdGl0dXRpb24gaW50byB0aGUgbWVzc2FnZSB2aWEgJXMgcGxhY2Vob2xkZXJzLlxuICAgKlxuICAgKiBUaHJvd3MgYW4gZXJyb3Igb2JqZWN0IHRoYXQgaGFzIHR3byBleHRyYSBwcm9wZXJ0aWVzOlxuICAgKiAtIGFzc29jaWF0ZWRFbGVtZW50OiBUaGlzIGlzIHRoZSBmaXJzdCBlbGVtZW50IHByb3ZpZGVkIGluIHRoZSB2YXIgYXJncy5cbiAgICogICBJdCBjYW4gYmUgdXNlZCBmb3IgaW1wcm92ZWQgZGlzcGxheSBvZiBlcnJvciBtZXNzYWdlcy5cbiAgICogLSBtZXNzYWdlQXJyYXk6IFRoZSBlbGVtZW50cyBvZiB0aGUgc3Vic3RpdHV0ZWQgbWVzc2FnZSBhcyBub24tc3RyaW5naWZpZWRcbiAgICogICBlbGVtZW50cyBpbiBhbiBhcnJheS4gV2hlbiBlLmcuIHBhc3NlZCB0byBjb25zb2xlLmVycm9yIHRoaXMgeWllbGRzXG4gICAqICAgbmF0aXZlIGRpc3BsYXlzIG9mIHRoaW5ncyBsaWtlIEhUTUwgZWxlbWVudHMuXG4gICAqXG4gICAqIEBwYXJhbSB7VH0gc2hvdWxkQmVUcnVlaXNoIFRoZSB2YWx1ZSB0byBhc3NlcnQuIFRoZSBhc3NlcnQgZmFpbHMgaWYgaXQgZG9lc1xuICAgKiAgICAgbm90IGV2YWx1YXRlIHRvIHRydWUuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X21lc3NhZ2UgVGhlIGFzc2VydGlvbiBtZXNzYWdlXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3MgQXJndW1lbnRzIHN1YnN0aXR1dGVkIGludG8gJXMgaW4gdGhlIG1lc3NhZ2UuXG4gICAqIEByZXR1cm4ge1R9IFRoZSB2YWx1ZSBvZiBzaG91bGRCZVRydWVpc2guXG4gICAqIEB0ZW1wbGF0ZSBUXG4gICAqIGVzbGludCBcImdvb2dsZS1jYW1lbGNhc2UvZ29vZ2xlLWNhbWVsY2FzZVwiOiAwXG4gICAqL1xuICBhc3NlcnQoc2hvdWxkQmVUcnVlaXNoLCBvcHRfbWVzc2FnZSwgdmFyX2FyZ3MpIHtcbiAgICBsZXQgZmlyc3RFbGVtZW50O1xuICAgIGlmICghc2hvdWxkQmVUcnVlaXNoKSB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gb3B0X21lc3NhZ2UgfHwgJ0Fzc2VydGlvbiBmYWlsZWQnO1xuICAgICAgY29uc3Qgc3BsaXRNZXNzYWdlID0gbWVzc2FnZS5zcGxpdCgnJXMnKTtcbiAgICAgIGNvbnN0IGZpcnN0ID0gc3BsaXRNZXNzYWdlLnNoaWZ0KCk7XG4gICAgICBsZXQgZm9ybWF0dGVkID0gZmlyc3Q7XG4gICAgICBjb25zdCBtZXNzYWdlQXJyYXkgPSBbXTtcbiAgICAgIHB1c2hJZk5vbkVtcHR5KG1lc3NhZ2VBcnJheSwgZmlyc3QpO1xuICAgICAgZm9yIChsZXQgaSA9IDI7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgdmFsID0gYXJndW1lbnRzW2ldO1xuICAgICAgICBpZiAodmFsICYmIHZhbC50YWdOYW1lKSB7XG4gICAgICAgICAgZmlyc3RFbGVtZW50ID0gdmFsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5leHRDb25zdGFudCA9IHNwbGl0TWVzc2FnZS5zaGlmdCgpO1xuICAgICAgICBtZXNzYWdlQXJyYXkucHVzaCh2YWwpO1xuICAgICAgICBwdXNoSWZOb25FbXB0eShtZXNzYWdlQXJyYXksIG5leHRDb25zdGFudC50cmltKCkpO1xuICAgICAgICBmb3JtYXR0ZWQgKz0gdG9TdHJpbmcodmFsKSArIG5leHRDb25zdGFudDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGUgPSBuZXcgRXJyb3IoZm9ybWF0dGVkKTtcbiAgICAgIGUuZnJvbUFzc2VydCA9IHRydWU7XG4gICAgICBlLmFzc29jaWF0ZWRFbGVtZW50ID0gZmlyc3RFbGVtZW50O1xuICAgICAgZS5tZXNzYWdlQXJyYXkgPSBtZXNzYWdlQXJyYXk7XG4gICAgICB0aGlzLnByZXBhcmVFcnJvcl8oZSk7XG4gICAgICAvLyByZXBvcnRFcnJvciBpcyBpbnN0YWxsZWQgZ2xvYmFsbHkgcGVyIHdpbmRvdyBpbiB0aGUgZW50cnkgcG9pbnQuXG4gICAgICBzZWxmLnJlcG9ydEVycm9yKGUpO1xuICAgICAgdGhyb3cgZTtcbiAgICB9XG4gICAgcmV0dXJuIHNob3VsZEJlVHJ1ZWlzaDtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzbid0IGFuIEVsZW1lbnRcbiAgICpcbiAgICogT3RoZXJ3aXNlIHNlZSBgYXNzZXJ0YCBmb3IgdXNhZ2VcbiAgICpcbiAgICogQHBhcmFtIHsqfSBzaG91bGRCZUVsZW1lbnRcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfbWVzc2FnZSBUaGUgYXNzZXJ0aW9uIG1lc3NhZ2VcbiAgICogQHJldHVybiB7IUVsZW1lbnR9IFRoZSB2YWx1ZSBvZiBzaG91bGRCZVRydWVpc2guXG4gICAqIEB0ZW1wbGF0ZSBUXG4gICAqIGVzbGludCBcImdvb2dsZS1jYW1lbGNhc2UvZ29vZ2xlLWNhbWVsY2FzZVwiOiAyXG4gICAqL1xuICBhc3NlcnRFbGVtZW50KHNob3VsZEJlRWxlbWVudCwgb3B0X21lc3NhZ2UpIHtcbiAgICBjb25zdCBzaG91bGRCZVRydWVpc2ggPSBzaG91bGRCZUVsZW1lbnQgJiYgc2hvdWxkQmVFbGVtZW50Lm5vZGVUeXBlID09IDE7XG4gICAgdGhpcy5hc3NlcnQoc2hvdWxkQmVUcnVlaXNoLCAob3B0X21lc3NhZ2UgfHwgJ0VsZW1lbnQgZXhwZWN0ZWQnKSArICc6ICVzJyxcbiAgICAgICAgc2hvdWxkQmVFbGVtZW50KTtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshRWxlbWVudH0gKi8gKHNob3VsZEJlRWxlbWVudCk7XG4gIH1cblxuICAvKipcbiAgICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpc24ndCBhIHN0cmluZy4gVGhlIHN0cmluZyBjYW5cbiAgICogYmUgZW1wdHkuXG4gICAqXG4gICAqIEZvciBtb3JlIGRldGFpbHMgc2VlIGBhc3NlcnRgLlxuICAgKlxuICAgKiBAcGFyYW0geyp9IHNob3VsZEJlU3RyaW5nXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X21lc3NhZ2UgVGhlIGFzc2VydGlvbiBtZXNzYWdlXG4gICAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHN0cmluZyB2YWx1ZS4gQ2FuIGJlIGFuIGVtcHR5IHN0cmluZy5cbiAgICogZXNsaW50IFwiZ29vZ2xlLWNhbWVsY2FzZS9nb29nbGUtY2FtZWxjYXNlXCI6IDJcbiAgICovXG4gIGFzc2VydFN0cmluZyhzaG91bGRCZVN0cmluZywgb3B0X21lc3NhZ2UpIHtcbiAgICB0aGlzLmFzc2VydCh0eXBlb2Ygc2hvdWxkQmVTdHJpbmcgPT0gJ3N0cmluZycsXG4gICAgICAgIChvcHRfbWVzc2FnZSB8fCAnU3RyaW5nIGV4cGVjdGVkJykgKyAnOiAlcycsIHNob3VsZEJlU3RyaW5nKTtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHtzdHJpbmd9ICovIChzaG91bGRCZVN0cmluZyk7XG4gIH1cblxuICAvKipcbiAgICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpc24ndCBhIG51bWJlci4gVGhlIGFsbG93ZWQgdmFsdWVzXG4gICAqIGluY2x1ZGUgYDBgIGFuZCBgTmFOYC5cbiAgICpcbiAgICogRm9yIG1vcmUgZGV0YWlscyBzZWUgYGFzc2VydGAuXG4gICAqXG4gICAqIEBwYXJhbSB7Kn0gc2hvdWxkQmVOdW1iZXJcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfbWVzc2FnZSBUaGUgYXNzZXJ0aW9uIG1lc3NhZ2VcbiAgICogQHJldHVybiB7bnVtYmVyfSBUaGUgbnVtYmVyIHZhbHVlLiBUaGUgYWxsb3dlZCB2YWx1ZXMgaW5jbHVkZSBgMGBcbiAgICogICBhbmQgYE5hTmAuXG4gICAqL1xuICBhc3NlcnROdW1iZXIoc2hvdWxkQmVOdW1iZXIsIG9wdF9tZXNzYWdlKSB7XG4gICAgdGhpcy5hc3NlcnQodHlwZW9mIHNob3VsZEJlTnVtYmVyID09ICdudW1iZXInLFxuICAgICAgICAob3B0X21lc3NhZ2UgfHwgJ051bWJlciBleHBlY3RlZCcpICsgJzogJXMnLCBzaG91bGRCZU51bWJlcik7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7bnVtYmVyfSAqLyAoc2hvdWxkQmVOdW1iZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgZmlyc3QgYXJndW1lbnQgaXNuJ3QgYSBib29sZWFuLlxuICAgKlxuICAgKiBGb3IgbW9yZSBkZXRhaWxzIHNlZSBgYXNzZXJ0YC5cbiAgICpcbiAgICogQHBhcmFtIHsqfSBzaG91bGRCZUJvb2xlYW5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfbWVzc2FnZSBUaGUgYXNzZXJ0aW9uIG1lc3NhZ2VcbiAgICogQHJldHVybiB7Ym9vbGVhbn0gVGhlIGJvb2xlYW4gdmFsdWUuXG4gICAqL1xuICBhc3NlcnRCb29sZWFuKHNob3VsZEJlQm9vbGVhbiwgb3B0X21lc3NhZ2UpIHtcbiAgICB0aGlzLmFzc2VydCghIXNob3VsZEJlQm9vbGVhbiA9PT0gc2hvdWxkQmVCb29sZWFuLFxuICAgICAgICAob3B0X21lc3NhZ2UgfHwgJ0Jvb2xlYW4gZXhwZWN0ZWQnKSArICc6ICVzJywgc2hvdWxkQmVCb29sZWFuKTtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHtib29sZWFufSAqLyAoc2hvdWxkQmVCb29sZWFuKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBc3NlcnRzIGFuZCByZXR1cm5zIHRoZSBlbnVtIHZhbHVlLiBJZiB0aGUgZW51bSBkb2Vzbid0IGNvbnRhaW4gc3VjaCBhXG4gICAqIHZhbHVlLCB0aGUgZXJyb3IgaXMgdGhyb3duLlxuICAgKlxuICAgKiBAcGFyYW0geyFPYmplY3Q8VD59IGVudW1PYmpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHNcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfZW51bU5hbWVcbiAgICogQHJldHVybiB7VH1cbiAgICogQHRlbXBsYXRlIFRcbiAgICogZXNsaW50IFwiZ29vZ2xlLWNhbWVsY2FzZS9nb29nbGUtY2FtZWxjYXNlXCI6IDJcbiAgICovXG4gIGFzc2VydEVudW1WYWx1ZShlbnVtT2JqLCBzLCBvcHRfZW51bU5hbWUpIHtcbiAgICBpZiAoaXNFbnVtVmFsdWUoZW51bU9iaiwgcykpIHtcbiAgICAgIHJldHVybiBzO1xuICAgIH1cbiAgICB0aGlzLmFzc2VydChmYWxzZSxcbiAgICAgICAgJ1Vua25vd24gJXMgdmFsdWU6IFwiJXNcIicsXG4gICAgICAgIG9wdF9lbnVtTmFtZSB8fCAnZW51bScsIHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVycm9yfSBlcnJvclxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJlcGFyZUVycm9yXyhlcnJvcikge1xuICAgIGVycm9yID0gZHVwbGljYXRlRXJyb3JJZk5lY2Vzc2FyeShlcnJvcik7XG4gICAgaWYgKHRoaXMuc3VmZml4Xykge1xuICAgICAgaWYgKCFlcnJvci5tZXNzYWdlKSB7XG4gICAgICAgIGVycm9yLm1lc3NhZ2UgPSB0aGlzLnN1ZmZpeF87XG4gICAgICB9IGVsc2UgaWYgKGVycm9yLm1lc3NhZ2UuaW5kZXhPZih0aGlzLnN1ZmZpeF8pID09IC0xKSB7XG4gICAgICAgIGVycm9yLm1lc3NhZ2UgKz0gdGhpcy5zdWZmaXhfO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoaXNVc2VyRXJyb3JNZXNzYWdlKGVycm9yLm1lc3NhZ2UpKSB7XG4gICAgICBlcnJvci5tZXNzYWdlID0gZXJyb3IubWVzc2FnZS5yZXBsYWNlKFVTRVJfRVJST1JfU0VOVElORUwsICcnKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ3whRWxlbWVudH0gdmFsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHRvU3RyaW5nKHZhbCkge1xuICAvLyBEbyBjaGVjayBlcXVpdmFsZW50IHRvIGB2YWwgaW5zdGFuY2VvZiBFbGVtZW50YCB3aXRob3V0IGNyb3NzLXdpbmRvdyBidWdcbiAgaWYgKHZhbCAmJiB2YWwubm9kZVR5cGUgPT0gMSkge1xuICAgIHJldHVybiB2YWwudGFnTmFtZS50b0xvd2VyQ2FzZSgpICsgKHZhbC5pZCA/ICcjJyArIHZhbC5pZCA6ICcnKTtcbiAgfVxuICByZXR1cm4gLyoqIEB0eXBlIHtzdHJpbmd9ICovICh2YWwpO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshQXJyYXl9IGFycmF5XG4gKiBAcGFyYW0geyp9IHZhbFxuICovXG5mdW5jdGlvbiBwdXNoSWZOb25FbXB0eShhcnJheSwgdmFsKSB7XG4gIGlmICh2YWwgIT0gJycpIHtcbiAgICBhcnJheS5wdXNoKHZhbCk7XG4gIH1cbn1cblxuLyoqXG4gKiBTb21lIGV4Y2VwdGlvbnMgKERPTUV4Y2VwdGlvbiwgbmFtZWx5KSBoYXZlIHJlYWQtb25seSBtZXNzYWdlLlxuICogQHBhcmFtIHshRXJyb3J9IGVycm9yXG4gKiBAcmV0dXJuIHshRXJyb3J9O1xuICovXG5leHBvcnQgZnVuY3Rpb24gZHVwbGljYXRlRXJyb3JJZk5lY2Vzc2FyeShlcnJvcikge1xuICBjb25zdCB7bWVzc2FnZX0gPSBlcnJvcjtcbiAgY29uc3QgdGVzdCA9IFN0cmluZyhNYXRoLnJhbmRvbSgpKTtcbiAgZXJyb3IubWVzc2FnZSA9IHRlc3Q7XG5cbiAgaWYgKGVycm9yLm1lc3NhZ2UgPT09IHRlc3QpIHtcbiAgICBlcnJvci5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICByZXR1cm4gZXJyb3I7XG4gIH1cblxuICBjb25zdCBlID0gbmV3IEVycm9yKGVycm9yLm1lc3NhZ2UpO1xuICAvLyBDb3B5IGFsbCB0aGUgZXh0cmFuZW91cyB0aGluZ3Mgd2UgYXR0YWNoLlxuICBmb3IgKGNvbnN0IHByb3AgaW4gZXJyb3IpIHtcbiAgICBlW3Byb3BdID0gZXJyb3JbcHJvcF07XG4gIH1cbiAgLy8gRW5zdXJlIHRoZXNlIGFyZSBjb3BpZWQuXG4gIGUuc3RhY2sgPSBlcnJvci5zdGFjaztcbiAgcmV0dXJuIGU7XG59XG5cbi8qKlxuICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICogQHJldHVybiB7IUVycm9yfVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFcnJvclZhcmdzKHZhcl9hcmdzKSB7XG4gIGxldCBlcnJvciA9IG51bGw7XG4gIGxldCBtZXNzYWdlID0gJyc7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgYXJnID0gYXJndW1lbnRzW2ldO1xuICAgIGlmIChhcmcgaW5zdGFuY2VvZiBFcnJvciAmJiAhZXJyb3IpIHtcbiAgICAgIGVycm9yID0gZHVwbGljYXRlRXJyb3JJZk5lY2Vzc2FyeShhcmcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAobWVzc2FnZSkge1xuICAgICAgICBtZXNzYWdlICs9ICcgJztcbiAgICAgIH1cbiAgICAgIG1lc3NhZ2UgKz0gYXJnO1xuICAgIH1cbiAgfVxuXG4gIGlmICghZXJyb3IpIHtcbiAgICBlcnJvciA9IG5ldyBFcnJvcihtZXNzYWdlKTtcbiAgfSBlbHNlIGlmIChtZXNzYWdlKSB7XG4gICAgZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2UgKyAnOiAnICsgZXJyb3IubWVzc2FnZTtcbiAgfVxuICByZXR1cm4gZXJyb3I7XG59XG5cblxuLyoqXG4gKiBSZXRocm93cyB0aGUgZXJyb3Igd2l0aG91dCB0ZXJtaW5hdGluZyB0aGUgY3VycmVudCBjb250ZXh0LiBUaGlzIHByZXNlcnZlc1xuICogd2hldGhlciB0aGUgb3JpZ2luYWwgZXJyb3IgZGVzaWduYXRpb24gaXMgYSB1c2VyIGVycm9yIG9yIGEgZGV2IGVycm9yLlxuICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmV0aHJvd0FzeW5jKHZhcl9hcmdzKSB7XG4gIGNvbnN0IGVycm9yID0gY3JlYXRlRXJyb3JWYXJncy5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAvLyByZXBvcnRFcnJvciBpcyBpbnN0YWxsZWQgZ2xvYmFsbHkgcGVyIHdpbmRvdyBpbiB0aGUgZW50cnkgcG9pbnQuXG4gICAgc2VsZi5yZXBvcnRFcnJvcihlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH0pO1xufVxuXG5cbi8qKlxuICogQ2FjaGUgZm9yIGxvZ3MuIFdlIGRvIG5vdCB1c2UgYSBTZXJ2aWNlIHNpbmNlIHRoZSBzZXJ2aWNlIG1vZHVsZSBkZXBlbmRzXG4gKiBvbiBMb2cgYW5kIGNsb3N1cmUgbGl0ZXJhbGx5IGNhbid0IGV2ZW4uXG4gKiBAdHlwZSB7e3VzZXI6ID9Mb2csIGRldjogP0xvZywgdXNlckZvckVtYmVkOiA/TG9nfX1cbiAqL1xuc2VsZi5sb2cgPSAoc2VsZi5sb2cgfHwge1xuICB1c2VyOiBudWxsLFxuICBkZXY6IG51bGwsXG4gIHVzZXJGb3JFbWJlZDogbnVsbCxcbn0pO1xuXG5jb25zdCBsb2dzID0gc2VsZi5sb2c7XG5cbi8qKlxuICogRXZlbnR1YWxseSBob2xkcyBhIGNvbnN0cnVjdG9yIGZvciBMb2cgb2JqZWN0cy4gTGF6aWx5IGluaXRpYWxpemVkLCBzbyB3ZVxuICogY2FuIGF2b2lkIGV2ZXIgcmVmZXJlbmNpbmcgdGhlIHJlYWwgY29uc3RydWN0b3IgZXhjZXB0IGluIEpTIGJpbmFyaWVzXG4gKiB0aGF0IGFjdHVhbGx5IHdhbnQgdG8gaW5jbHVkZSB0aGUgaW1wbGVtZW50YXRpb24uXG4gKiBAdHlwZSB7P0Z1bmN0aW9ufVxuICovXG5sZXQgbG9nQ29uc3RydWN0b3IgPSBudWxsO1xuXG4vKipcbiAqIEluaXRpYWxpemVzIGxvZyBjb250cnVjdG9yLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdExvZ0NvbnN0cnVjdG9yKCkge1xuICBsb2dDb25zdHJ1Y3RvciA9IExvZztcbiAgLy8gSW5pdGlhbGl6ZSBpbnN0YW5jZXMgZm9yIHVzZS4gSWYgYSBiaW5hcnkgKGFuIGV4dGVuc2lvbiBmb3IgZXhhbXBsZSkgdGhhdFxuICAvLyBkb2VzIG5vdCBjYWxsIGBpbml0TG9nQ29uc3RydWN0b3JgIGludm9rZXMgYGRldigpYCBvciBgdXNlcigpYCBlYXJsaWVyIHRoYW5cbiAgLy8gdGhlIGJpbmFyeSB0aGF0IGRvZXMgY2FsbCBgaW5pdExvZ0NvbnN0cnVjdG9yYCAoYW1wLmpzKSwgdGhlIGV4dGVuc2lvbiB3aWxsXG4gIC8vIHRocm93IGFuIGVycm9yIGFzIHRoYXQgZXh0ZW5zaW9uIHdpbGwgbmV2ZXIgYmUgYWJsZSB0byBpbml0aWFsaXplIHRoZSBsb2dcbiAgLy8gaW5zdGFuY2VzIGFuZCB3ZSBhbHNvIGRvbid0IHdhbnQgaXQgdG8gY2FsbCBgaW5pdExvZ0NvbnN0cnVjdG9yYCBlaXRoZXJcbiAgLy8gKHNpbmNlIHRoYXQgd2lsbCBjYXVzZSB0aGUgTG9nIGltcGxlbWVudGF0aW9uIHRvIGJlIGJ1bmRsZWQgaW50byB0aGF0XG4gIC8vIGJpbmFyeSkuIFNvIHdlIG11c3QgaW5pdGlhbGl6ZSB0aGUgaW5zdGFuY2VzIGVhZ2VybHkgc28gdGhhdCB0aGV5IGFyZSByZWFkeVxuICAvLyBmb3IgdXNlIChzdG9yZWQgZ2xvYmFsbHkpIGFmdGVyIHRoZSBtYWluIGJpbmFyeSBjYWxscyBgaW5pdExvZ0NvbnN0cnVjdG9yYC5cbiAgZGV2KCk7XG4gIHVzZXIoKTtcbn1cblxuLyoqXG4gKiBSZXNldHMgbG9nIGNvbnRydWN0b3IgZm9yIHRlc3RpbmcuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldExvZ0NvbnN0cnVjdG9yRm9yVGVzdGluZygpIHtcbiAgbG9nQ29uc3RydWN0b3IgPSBudWxsO1xufVxuXG4vKipcbiAqIFB1Ymxpc2hlciBsZXZlbCBsb2cuXG4gKlxuICogRW5hYmxlZCBpbiB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gKiAgMS4gTm90IGRpc2FibGVkIHVzaW5nIGAjbG9nPTBgLlxuICogIDIuIERldmVsb3BtZW50IG1vZGUgaXMgZW5hYmxlZCB2aWEgYCNkZXZlbG9wbWVudD0xYCBvciBsb2dnaW5nIGlzIGV4cGxpY2l0bHlcbiAqICAgICBlbmFibGVkIHZpYSBgI2xvZz1EYCB3aGVyZSBEID49IDEuXG4gKiAgMy4gQU1QLnNldExvZ0xldmVsKEQpIGlzIGNhbGxlZCwgd2hlcmUgRCA+PSAxLlxuICpcbiAqIEBwYXJhbSB7IUVsZW1lbnQ9fSBvcHRfZWxlbWVudFxuICogQHJldHVybiB7IUxvZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZXIob3B0X2VsZW1lbnQpIHtcbiAgaWYgKCFsb2dzLnVzZXIpIHtcbiAgICBsb2dzLnVzZXIgPSBnZXRVc2VyTG9nZ2VyKFVTRVJfRVJST1JfU0VOVElORUwpO1xuICB9XG4gIGlmICghaXNGcm9tRW1iZWQobG9ncy51c2VyLndpbiwgb3B0X2VsZW1lbnQpKSB7XG4gICAgcmV0dXJuIGxvZ3MudXNlcjtcbiAgfSBlbHNlIHtcbiAgICBpZiAobG9ncy51c2VyRm9yRW1iZWQpIHtcbiAgICAgIHJldHVybiBsb2dzLnVzZXJGb3JFbWJlZDtcbiAgICB9XG4gICAgcmV0dXJuIGxvZ3MudXNlckZvckVtYmVkID0gZ2V0VXNlckxvZ2dlcihVU0VSX0VSUk9SX0VNQkVEX1NFTlRJTkVMKTtcbiAgfVxufVxuXG4vKipcbiAqIEdldHRlciBmb3IgdXNlciBsb2dnZXJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gc3VmZml4XG4gKiBAcmV0dXJuIHshTG9nfVxuICovXG5mdW5jdGlvbiBnZXRVc2VyTG9nZ2VyKHN1ZmZpeCkge1xuICBpZiAoIWxvZ0NvbnN0cnVjdG9yKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdmYWlsZWQgdG8gY2FsbCBpbml0TG9nQ29uc3RydWN0b3InKTtcbiAgfVxuICByZXR1cm4gbmV3IGxvZ0NvbnN0cnVjdG9yKHNlbGYsIG1vZGUgPT4ge1xuICAgIGNvbnN0IGxvZ051bSA9IHBhcnNlSW50KG1vZGUubG9nLCAxMCk7XG4gICAgaWYgKG1vZGUuZGV2ZWxvcG1lbnQgfHwgbG9nTnVtID49IDEpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5GSU5FO1xuICAgIH1cbiAgICByZXR1cm4gTG9nTGV2ZWwuV0FSTjtcbiAgfSwgc3VmZml4KTtcbn1cblxuLyoqXG4gKiBBTVAgZGV2ZWxvcG1lbnQgbG9nLiBDYWxscyB0byBgZGV2TG9nKCkuYXNzZXJ0YCBhbmQgYGRldi5maW5lYCBhcmUgc3RyaXBwZWRcbiAqIGluIHRoZSBQUk9EIGJpbmFyeS4gSG93ZXZlciwgYGRldkxvZygpLmFzc2VydGAgcmVzdWx0IGlzIHByZXNlcnZlZCBpbiBlaXRoZXJcbiAqIGNhc2UuXG4gKlxuICogRW5hYmxlZCBpbiB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gKiAgMS4gTm90IGRpc2FibGVkIHVzaW5nIGAjbG9nPTBgLlxuICogIDIuIExvZ2dpbmcgaXMgZXhwbGljaXRseSBlbmFibGVkIHZpYSBgI2xvZz1EYCwgd2hlcmUgRCA+PSAyLlxuICogIDMuIEFNUC5zZXRMb2dMZXZlbChEKSBpcyBjYWxsZWQsIHdoZXJlIEQgPj0gMi5cbiAqXG4gKiBAcmV0dXJuIHshTG9nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGV2KCkge1xuICBpZiAobG9ncy5kZXYpIHtcbiAgICByZXR1cm4gbG9ncy5kZXY7XG4gIH1cbiAgaWYgKCFsb2dDb25zdHJ1Y3Rvcikge1xuICAgIHRocm93IG5ldyBFcnJvcignZmFpbGVkIHRvIGNhbGwgaW5pdExvZ0NvbnN0cnVjdG9yJyk7XG4gIH1cbiAgcmV0dXJuIGxvZ3MuZGV2ID0gbmV3IGxvZ0NvbnN0cnVjdG9yKHNlbGYsIG1vZGUgPT4ge1xuICAgIGNvbnN0IGxvZ051bSA9IHBhcnNlSW50KG1vZGUubG9nLCAxMCk7XG4gICAgaWYgKGxvZ051bSA+PSAzKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuRklORTtcbiAgICB9XG4gICAgaWYgKGxvZ051bSA+PSAyKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuSU5GTztcbiAgICB9XG4gICAgcmV0dXJuIExvZ0xldmVsLk9GRjtcbiAgfSk7XG59XG5cbi8qKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IUVsZW1lbnQ9fSBvcHRfZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn0gaXNFbWJlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNGcm9tRW1iZWQod2luLCBvcHRfZWxlbWVudCkge1xuICBpZiAoIW9wdF9lbGVtZW50KSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiBvcHRfZWxlbWVudC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3ICE9IHdpbjtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4vbW9kZSc7XG5cbi8qKlxuICogUHJvdmlkZXMgaW5mbyBhYm91dCB0aGUgY3VycmVudCBhcHAuIFRoaXMgcmV0dXJuIHZhbHVlIG1heSBiZSBjYWNoZWQgYW5kXG4gKiBwYXNzZWQgYXJvdW5kIGFzIGl0IHdpbGwgYWx3YXlzIGJlIERDRSdkLlxuICogQHBhcmFtIHs/V2luZG93PX0gb3B0X3dpblxuICogQHJldHVybiB7IS4vbW9kZS5Nb2RlRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW9kZU9iamVjdChvcHRfd2luKSB7XG4gIHJldHVybiB7XG4gICAgbG9jYWxEZXY6IGdldE1vZGUob3B0X3dpbikubG9jYWxEZXYsXG4gICAgZGV2ZWxvcG1lbnQ6IGdldE1vZGUob3B0X3dpbikuZGV2ZWxvcG1lbnQsXG4gICAgZmlsdGVyOiBnZXRNb2RlKG9wdF93aW4pLmZpbHRlcixcbiAgICBtaW5pZmllZDogZ2V0TW9kZShvcHRfd2luKS5taW5pZmllZCxcbiAgICBsaXRlOiBnZXRNb2RlKG9wdF93aW4pLmxpdGUsXG4gICAgdGVzdDogZ2V0TW9kZShvcHRfd2luKS50ZXN0LFxuICAgIGxvZzogZ2V0TW9kZShvcHRfd2luKS5sb2csXG4gICAgdmVyc2lvbjogZ2V0TW9kZShvcHRfd2luKS52ZXJzaW9uLFxuICAgIHJ0dlZlcnNpb246IGdldE1vZGUob3B0X3dpbikucnR2VmVyc2lvbixcbiAgfTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge3BhcnNlUXVlcnlTdHJpbmdffSBmcm9tICcuL3VybC1wYXJzZS1xdWVyeS1zdHJpbmcnO1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGxvY2FsRGV2OiBib29sZWFuLFxuICogICBkZXZlbG9wbWVudDogYm9vbGVhbixcbiAqICAgZmlsdGVyOiAoc3RyaW5nfHVuZGVmaW5lZCksXG4gKiAgIG1pbmlmaWVkOiBib29sZWFuLFxuICogICBsaXRlOiBib29sZWFuLFxuICogICB0ZXN0OiBib29sZWFuLFxuICogICBsb2c6IChzdHJpbmd8dW5kZWZpbmVkKSxcbiAqICAgdmVyc2lvbjogc3RyaW5nLFxuICogICBydHZWZXJzaW9uOiBzdHJpbmcsXG4gKiB9fVxuICovXG5leHBvcnQgbGV0IE1vZGVEZWY7XG5cbi8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuY29uc3QgdmVyc2lvbiA9ICckaW50ZXJuYWxSdW50aW1lVmVyc2lvbiQnO1xuXG4vKipcbiAqIGBydHZWZXJzaW9uYCBpcyB0aGUgcHJlZml4ZWQgdmVyc2lvbiB3ZSBzZXJ2ZSBvZmYgb2YgdGhlIGNkbi5cbiAqIFRoZSBwcmVmaXggZGVub3RlcyBjYW5hcnkoMDApIG9yIHByb2QoMDEpIG9yIGFuIGV4cGVyaW1lbnQgdmVyc2lvbiAoID4gMDEpLlxuICogQHR5cGUge3N0cmluZ31cbiAqL1xubGV0IHJ0dlZlcnNpb24gPSAnJztcblxuLyoqXG4gKiBQcm92aWRlcyBpbmZvIGFib3V0IHRoZSBjdXJyZW50IGFwcC5cbiAqIEBwYXJhbSB7P1dpbmRvdz19IG9wdF93aW5cbiAqIEByZXR1cm4geyFNb2RlRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW9kZShvcHRfd2luKSB7XG4gIGNvbnN0IHdpbiA9IG9wdF93aW4gfHwgc2VsZjtcbiAgaWYgKHdpbi5BTVBfTU9ERSkge1xuICAgIHJldHVybiB3aW4uQU1QX01PREU7XG4gIH1cbiAgcmV0dXJuIHdpbi5BTVBfTU9ERSA9IGdldE1vZGVfKHdpbik7XG59XG5cbi8qKlxuICogUHJvdmlkZXMgaW5mbyBhYm91dCB0aGUgY3VycmVudCBhcHAuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IU1vZGVEZWZ9XG4gKi9cbmZ1bmN0aW9uIGdldE1vZGVfKHdpbikge1xuICAvLyBNYWdpYyBjb25zdGFudHMgdGhhdCBhcmUgcmVwbGFjZWQgYnkgY2xvc3VyZSBjb21waWxlci5cbiAgLy8gSVNfTUlOSUZJRUQgaXMgYWx3YXlzIHJlcGxhY2VkIHdpdGggdHJ1ZSB3aGVuIGNsb3N1cmUgY29tcGlsZXIgaXMgdXNlZFxuICAvLyB3aGlsZSBJU19ERVYgaXMgb25seSByZXBsYWNlZCB3aGVuIGBndWxwIGRpc3RgIGlzIGNhbGxlZCB3aXRob3V0IHRoZVxuICAvLyAtLWZvcnRlc3RpbmcgZmxhZy5cbiAgY29uc3QgSVNfREVWID0gdHJ1ZTtcbiAgY29uc3QgSVNfTUlOSUZJRUQgPSBmYWxzZTtcblxuICBjb25zdCBsb2NhbERldkVuYWJsZWQgPSAhIShzZWxmLkFNUF9DT05GSUcgJiYgc2VsZi5BTVBfQ09ORklHLmxvY2FsRGV2KTtcbiAgY29uc3QgcnVubmluZ1Rlc3RzID0gSVNfREVWICYmICEhKHdpbi5BTVBfVEVTVCB8fCB3aW4uX19rYXJtYV9fKTtcbiAgY29uc3QgaXNMb2NhbERldiA9IElTX0RFViAmJiAobG9jYWxEZXZFbmFibGVkIHx8IHJ1bm5pbmdUZXN0cyk7XG4gIGNvbnN0IGhhc2hRdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmdfKFxuICAgICAgLy8gbG9jYXRpb24ub3JpZ2luYWxIYXNoIGlzIHNldCBieSB0aGUgdmlld2VyIHdoZW4gaXQgcmVtb3ZlcyB0aGUgZnJhZ21lbnRcbiAgICAgIC8vIGZyb20gdGhlIFVSTC5cbiAgICAgIHdpbi5sb2NhdGlvbi5vcmlnaW5hbEhhc2ggfHwgd2luLmxvY2F0aW9uLmhhc2gpO1xuXG4gIGNvbnN0IHNlYXJjaFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZ18od2luLmxvY2F0aW9uLnNlYXJjaCk7XG5cbiAgaWYgKCFydHZWZXJzaW9uKSB7XG4gICAgcnR2VmVyc2lvbiA9IGdldFJ0dlZlcnNpb24od2luLCBpc0xvY2FsRGV2KTtcbiAgfVxuXG4gIC8vIFRoZSBgbWluaWZpZWRgLCBgdGVzdGAgYW5kIGBsb2NhbERldmAgcHJvcGVydGllcyBhcmUgcmVwbGFjZWRcbiAgLy8gYXMgYm9vbGVhbiBsaXRlcmFscyB3aGVuIHdlIHJ1biBgZ3VscCBkaXN0YCB3aXRob3V0IHRoZSBgLS1mb3J0ZXN0aW5nYFxuICAvLyBmbGFncy4gVGhpcyBpbXByb3ZlZCBEQ0Ugb24gdGhlIHByb2R1Y3Rpb24gZmlsZSB3ZSBkZXBsb3kgYXMgdGhlIGNvZGVcbiAgLy8gcGF0aHMgZm9yIGxvY2FsaG9zdC90ZXN0aW5nL2RldmVsb3BtZW50IGFyZSBlbGltaW5hdGVkLlxuICByZXR1cm4ge1xuICAgIGxvY2FsRGV2OiBpc0xvY2FsRGV2LFxuICAgIC8vIFRyaWdnZXJzIHZhbGlkYXRpb24gb3IgZW5hYmxlIHB1YiBsZXZlbCBsb2dnaW5nLiBWYWxpZGF0aW9uIGNhbiBiZVxuICAgIC8vIGJ5cGFzc2VkIHZpYSAjdmFsaWRhdGU9MC5cbiAgICAvLyBOb3RlIHRoYXQgQU1QX0RFVl9NT0RFIGZsYWcgaXMgdXNlZCBmb3IgdGVzdGluZyBwdXJwb3Nlcy5cbiAgICBkZXZlbG9wbWVudDogISEoaGFzaFF1ZXJ5WydkZXZlbG9wbWVudCddID09ICcxJyB8fCB3aW4uQU1QX0RFVl9NT0RFKSxcbiAgICBleGFtaW5lcjogaGFzaFF1ZXJ5WydkZXZlbG9wbWVudCddID09ICcyJyxcbiAgICAvLyBBbGxvd3MgZmlsdGVyaW5nIHZhbGlkYXRpb24gZXJyb3JzIGJ5IGVycm9yIGNhdGVnb3J5LiBGb3IgdGhlXG4gICAgLy8gYXZhaWxhYmxlIGNhdGVnb3JpZXMsIHNlZSBFcnJvckNhdGVnb3J5IGluIHZhbGlkYXRvci92YWxpZGF0b3IucHJvdG8uXG4gICAgZmlsdGVyOiBoYXNoUXVlcnlbJ2ZpbHRlciddLFxuICAgIC8vIGFtcC1nZW8gb3ZlcnJpZGVcbiAgICBnZW9PdmVycmlkZTogaGFzaFF1ZXJ5WydhbXAtZ2VvJ10sXG4gICAgbWluaWZpZWQ6IElTX01JTklGSUVELFxuICAgIC8vIFdoZXRoZXIgZG9jdW1lbnQgaXMgaW4gYW4gYW1wLWxpdGUgdmlld2VyLiBJdCBzaWduYWwgdGhhdCB0aGUgdXNlclxuICAgIC8vIHdvdWxkIHByZWZlciB0byB1c2UgbGVzcyBiYW5kd2lkdGguXG4gICAgbGl0ZTogc2VhcmNoUXVlcnlbJ2FtcF9saXRlJ10gIT0gdW5kZWZpbmVkLFxuICAgIHRlc3Q6IHJ1bm5pbmdUZXN0cyxcbiAgICBsb2c6IGhhc2hRdWVyeVsnbG9nJ10sXG4gICAgdmVyc2lvbixcbiAgICBydHZWZXJzaW9uLFxuICB9O1xufVxuXG4vKipcbiAqIFJldHJpZXZlIHRoZSBgcnR2VmVyc2lvbmAgd2hpY2ggd2lsbCBoYXZlIGEgbnVtZXJpYyBwcmVmaXhcbiAqIGRlbm90aW5nIGNhbmFyeS9wcm9kL2V4cGVyaW1lbnQgKHVubGVzcyBgaXNMb2NhbERldmAgaXMgdHJ1ZSkuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNMb2NhbERldlxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBnZXRSdHZWZXJzaW9uKHdpbiwgaXNMb2NhbERldikge1xuICAvLyBJZiBpdCdzIGxvY2FsIGRldiB0aGVuIHdlIHdvbid0IGFjdHVhbGx5IGhhdmUgYSBmdWxsIHZlcnNpb24gc29cbiAgLy8ganVzdCB1c2UgdGhlIHZlcnNpb24uXG4gIGlmIChpc0xvY2FsRGV2KSB7XG4gICAgcmV0dXJuIHZlcnNpb247XG4gIH1cblxuICBpZiAod2luLkFNUF9DT05GSUcgJiYgd2luLkFNUF9DT05GSUcudikge1xuICAgIHJldHVybiB3aW4uQU1QX0NPTkZJRy52O1xuICB9XG5cbiAgLy8gQ3VycmVudGx5IGAkaW50ZXJuYWxSdW50aW1lVmVyc2lvbiRgIGFuZCB0aHVzIGBtb2RlLnZlcnNpb25gIGNvbnRhaW4gb25seVxuICAvLyBtYWpvciB2ZXJzaW9uLiBUaGUgZnVsbCB2ZXJzaW9uIGhvd2V2ZXIgbXVzdCBhbHNvIGNhcnJ5IHRoZSBtaW5vciB2ZXJzaW9uLlxuICAvLyBXZSB3aWxsIGRlZmF1bHQgdG8gcHJvZHVjdGlvbiBkZWZhdWx0IGAwMWAgbWlub3IgdmVyc2lvbiBmb3Igbm93LlxuICAvLyBUT0RPKGVyd2lubW9tYmF5KTogZGVjaWRlIHdoZXRoZXIgJGludGVybmFsUnVudGltZVZlcnNpb24kIHNob3VsZCBjb250YWluXG4gIC8vIG1pbm9yIHZlcnNpb24uXG4gIHJldHVybiBgMDEke3ZlcnNpb259YDtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGlzTG9jYWxEZXZcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UnR2VmVyc2lvbkZvclRlc3Rpbmcod2luLCBpc0xvY2FsRGV2KSB7XG4gIHJldHVybiBnZXRSdHZWZXJzaW9uKHdpbiwgaXNMb2NhbERldik7XG59XG5cblxuLyoqIEB2aXNpYmxlRm9yVGVzdGluZyAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0UnR2VmVyc2lvbkZvclRlc3RpbmcoKSB7XG4gIHJ0dlZlcnNpb24gPSAnJztcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cblxuLyoqXG4gKiBUaGlzIGNsYXNzIGhlbHBzIHRvIG1hbmFnZSBvYnNlcnZlcnMuIE9ic2VydmVycyBjYW4gYmUgYWRkZWQsIHJlbW92ZWQgb3JcbiAqIGZpcmVkIHRocm91Z2ggYW5kIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gKiBAdGVtcGxhdGUgVFlQRVxuICovXG5leHBvcnQgY2xhc3MgT2JzZXJ2YWJsZSB7XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgT2JzZXJ2YWJsZS5cbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIC8qKiBAdHlwZSB7P0FycmF5PGZ1bmN0aW9uKFRZUEUpPn0gKi9cbiAgICB0aGlzLmhhbmRsZXJzXyA9IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyB0aGUgb2JzZXJ2ZXIgdG8gdGhpcyBpbnN0YW5jZS5cbiAgICogQHBhcmFtIHtmdW5jdGlvbihUWVBFKX0gaGFuZGxlciBPYnNlcnZlcidzIGhhbmRsZXIuXG4gICAqIEByZXR1cm4geyFVbmxpc3RlbkRlZn1cbiAgICovXG4gIGFkZChoYW5kbGVyKSB7XG4gICAgaWYgKCF0aGlzLmhhbmRsZXJzXykge1xuICAgICAgdGhpcy5oYW5kbGVyc18gPSBbXTtcbiAgICB9XG4gICAgdGhpcy5oYW5kbGVyc18ucHVzaChoYW5kbGVyKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgdGhpcy5yZW1vdmUoaGFuZGxlcik7XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmVzIHRoZSBvYnNlcnZlciBmcm9tIHRoaXMgaW5zdGFuY2UuXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oVFlQRSl9IGhhbmRsZXIgT2JzZXJ2ZXIncyBpbnN0YW5jZS5cbiAgICovXG4gIHJlbW92ZShoYW5kbGVyKSB7XG4gICAgaWYgKCF0aGlzLmhhbmRsZXJzXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBpbmRleCA9IHRoaXMuaGFuZGxlcnNfLmluZGV4T2YoaGFuZGxlcik7XG4gICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgIHRoaXMuaGFuZGxlcnNfLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgYWxsIG9ic2VydmVycy5cbiAgICovXG4gIHJlbW92ZUFsbCgpIHtcbiAgICBpZiAoIXRoaXMuaGFuZGxlcnNfKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaGFuZGxlcnNfLmxlbmd0aCA9IDA7XG4gIH1cblxuICAvKipcbiAgICogRmlyZXMgYW4gZXZlbnQuIEFsbCBvYnNlcnZlcnMgYXJlIGNhbGxlZC5cbiAgICogQHBhcmFtIHtUWVBFPX0gb3B0X2V2ZW50XG4gICAqL1xuICBmaXJlKG9wdF9ldmVudCkge1xuICAgIGlmICghdGhpcy5oYW5kbGVyc18pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgaGFuZGxlcnMgPSB0aGlzLmhhbmRsZXJzXztcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhhbmRsZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBoYW5kbGVyID0gaGFuZGxlcnNbaV07XG4gICAgICBoYW5kbGVyKG9wdF9ldmVudCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgbnVtYmVyIG9mIGhhbmRsZXJzLiBNb3N0bHkgbmVlZGVkIGZvciB0ZXN0cy5cbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKi9cbiAgZ2V0SGFuZGxlckNvdW50KCkge1xuICAgIGlmICghdGhpcy5oYW5kbGVyc18pIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5oYW5kbGVyc18ubGVuZ3RoO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuL21vZGUnO1xuaW1wb3J0IHtpbnN0YWxsIGFzIGluc3RhbGxBcnJheUluY2x1ZGVzfSBmcm9tICcuL3BvbHlmaWxscy9hcnJheS1pbmNsdWRlcyc7XG5pbXBvcnQge2luc3RhbGwgYXMgaW5zdGFsbEN1c3RvbUVsZW1lbnRzfSBmcm9tICcuL3BvbHlmaWxscy9jdXN0b20tZWxlbWVudHMnO1xuaW1wb3J0IHtcbiAgaW5zdGFsbCBhcyBpbnN0YWxsRE9NVG9rZW5MaXN0VG9nZ2xlLFxufSBmcm9tICcuL3BvbHlmaWxscy9kb210b2tlbmxpc3QtdG9nZ2xlJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsRG9jQ29udGFpbnN9IGZyb20gJy4vcG9seWZpbGxzL2RvY3VtZW50LWNvbnRhaW5zJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsTWF0aFNpZ259IGZyb20gJy4vcG9seWZpbGxzL21hdGgtc2lnbic7XG5pbXBvcnQge2luc3RhbGwgYXMgaW5zdGFsbE9iamVjdEFzc2lnbn0gZnJvbSAnLi9wb2x5ZmlsbHMvb2JqZWN0LWFzc2lnbic7XG5pbXBvcnQge2luc3RhbGwgYXMgaW5zdGFsbFByb21pc2V9IGZyb20gJy4vcG9seWZpbGxzL3Byb21pc2UnO1xuaW1wb3J0IHtpbnN0YWxsQ3VzdG9tRWxlbWVudHMgYXMgaW5zdGFsbFJlZ2lzdGVyRWxlbWVudH0gZnJvbVxuICAnZG9jdW1lbnQtcmVnaXN0ZXItZWxlbWVudC9idWlsZC9kb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50LnBhdGNoZWQnO1xuaW1wb3J0IHtpc0V4cGVyaW1lbnRPbn0gZnJvbSAnLi9leHBlcmltZW50cyc7XG5cbmlmIChpc0V4cGVyaW1lbnRPbihzZWxmLCAnY3VzdG9tLWVsZW1lbnRzLXYxJykgfHwgZ2V0TW9kZSgpLnRlc3QpIHtcbiAgaW5zdGFsbEN1c3RvbUVsZW1lbnRzKHNlbGYsIGNsYXNzIHt9KTtcbn0gZWxzZSB7XG4gIGluc3RhbGxSZWdpc3RlckVsZW1lbnQoc2VsZiwgJ2F1dG8nKTtcbn1cbmluc3RhbGxET01Ub2tlbkxpc3RUb2dnbGUoc2VsZik7XG5pbnN0YWxsTWF0aFNpZ24oc2VsZik7XG5pbnN0YWxsT2JqZWN0QXNzaWduKHNlbGYpO1xuaW5zdGFsbFByb21pc2Uoc2VsZik7XG5pbnN0YWxsRG9jQ29udGFpbnMoc2VsZik7XG5pbnN0YWxsQXJyYXlJbmNsdWRlcyhzZWxmKTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBlbGVtZW50IGlzIGluIHRoZSBhcnJheSBhbmQgZmFsc2Ugb3RoZXJ3aXNlLlxuICpcbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0X2Zyb21JbmRleFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0aGlzIHtBcnJheX1cbiAqL1xuZnVuY3Rpb24gaW5jbHVkZXModmFsdWUsIG9wdF9mcm9tSW5kZXgpIHtcbiAgY29uc3QgZnJvbUluZGV4ID0gb3B0X2Zyb21JbmRleCB8fCAwO1xuICBjb25zdCBsZW4gPSB0aGlzLmxlbmd0aDtcbiAgbGV0IGkgPSBmcm9tSW5kZXggPj0gMCA/IGZyb21JbmRleCA6IE1hdGgubWF4KGxlbiArIGZyb21JbmRleCwgMCk7XG4gIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICBjb25zdCBvdGhlciA9IHRoaXNbaV07XG4gICAgLy8gSWYgdmFsdWUgaGFzIGJlZW4gZm91bmQgT1IgKHZhbHVlIGlzIE5hTiBBTkQgb3RoZXIgaXMgTmFOKVxuICAgIC8qZXNsaW50IFwibm8tc2VsZi1jb21wYXJlXCI6IDAqL1xuICAgIGlmIChvdGhlciA9PT0gdmFsdWUgfHwgKHZhbHVlICE9PSB2YWx1ZSAmJiBvdGhlciAhPT0gb3RoZXIpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiogU2V0cyB0aGUgQXJyYXkuY29udGFpbnMgcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4qIEBwYXJhbSB7IVdpbmRvd30gd2luXG4qL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIGlmICghd2luLkFycmF5LnByb3RvdHlwZS5pbmNsdWRlcykge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnaW5jbHVkZXMnLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IGluY2x1ZGVzLFxuICAgIH0pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBwcm9taXNlOiAhUHJvbWlzZTx1bmRlZmluZWQ+LFxuICogICByZXNvbHZlOiBmdW5jdGlvbigpLFxuICogfX1cbiAqL1xubGV0IERlZmVycmVkRGVmO1xuXG4vKipcbiAqIEB0eXBlZGVmIHshRnVuY3Rpb259XG4gKi9cbmxldCBDdXN0b21FbGVtZW50Q29uc3RydWN0b3JEZWY7XG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICBuYW1lOiBzdHJpbmcsXG4gKiAgY3RvcjogIUN1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZixcbiAqIH19XG4gKi9cbmxldCBDdXN0b21FbGVtZW50RGVmO1xuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGUgY3VzdG9tIGVsZW1lbnQncyBuYW1lLlxuICogVGhpcyBpbnRlbnRpb25hbGx5IGlnbm9yZXMgXCJ2YWxpZFwiIGhpZ2hlciBVbmljb2RlIENvZGUgUG9pbnRzLlxuICogaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvY3VzdG9tLWVsZW1lbnRzLmh0bWwjdmFsaWQtY3VzdG9tLWVsZW1lbnQtbmFtZVxuICovXG5jb25zdCBWQUxJRF9OQU1FID0gL15bYS16XVthLXowLTkuX10qLVthLXowLTkuXy1dKiQvO1xuY29uc3QgSU5WQUxJRF9OQU1FUyA9IFtcbiAgJ2Fubm90YXRpb24teG1sJyxcbiAgJ2NvbG9yLXByb2ZpbGUnLFxuICAnZm9udC1mYWNlJyxcbiAgJ2ZvbnQtZmFjZS1zcmMnLFxuICAnZm9udC1mYWNlLXVyaScsXG4gICdmb250LWZhY2UtZm9ybWF0JyxcbiAgJ2ZvbnQtZmFjZS1uYW1lJyxcbiAgJ21pc3NpbmctZ2x5cGgnLFxuXTtcblxuLyoqXG4gKiBBc3NlcnRzIHRoYXQgdGhlIGN1c3RvbSBlbGVtZW50IG5hbWUgY29uZm9ybXMgdG8gdGhlIHNwZWMuXG4gKlxuICogQHBhcmFtIHshRnVuY3Rpb259IFN5bnRheEVycm9yXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICovXG5mdW5jdGlvbiBhc3NlcnRWYWxpZE5hbWUoU3ludGF4RXJyb3IsIG5hbWUpIHtcbiAgaWYgKCFWQUxJRF9OQU1FLnRlc3QobmFtZSkgfHwgSU5WQUxJRF9OQU1FUy5pbmRleE9mKG5hbWUpID49IDApIHtcbiAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoYGludmFsaWQgY3VzdG9tIGVsZW1lbnQgbmFtZSBcIiR7bmFtZX1cImApO1xuICB9XG59XG5cbi8qKlxuICogRG9lcyB3aW4gaGF2ZSBhIGZ1bGwgQ3VzdG9tIEVsZW1lbnRzIHJlZ2lzdHJ5P1xuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBoYXNDdXN0b21FbGVtZW50cyh3aW4pIHtcbiAgY29uc3Qge2N1c3RvbUVsZW1lbnRzfSA9IHdpbjtcblxuICByZXR1cm4gISEoXG4gICAgY3VzdG9tRWxlbWVudHMgJiZcbiAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUgJiZcbiAgICBjdXN0b21FbGVtZW50cy5nZXQgJiZcbiAgICBjdXN0b21FbGVtZW50cy53aGVuRGVmaW5lZCk7XG59XG5cbi8qKlxuICogV2FzIEhUTUxFbGVtZW50IGFscmVhZHkgcGF0Y2hlZCBmb3IgdGhpcyB3aW5kb3c/XG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzUGF0Y2hlZCh3aW4pIHtcbiAgY29uc3QgdGFnID0gd2luLkhUTUxFbGVtZW50LnRvU3RyaW5nKCk7XG4gIHJldHVybiB0YWcuaW5kZXhPZignW25hdGl2ZSBjb2RlXScpID09PSAtMTtcbn1cblxuLyoqXG4gKiBUaGUgcHVibGljIEN1c3RvbSBFbGVtZW50cyBBUEkuXG4gKi9cbmNsYXNzIEN1c3RvbUVsZW1lbnRSZWdpc3RyeSB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcGFyYW0geyFSZWdpc3RyeX0gcmVnaXN0cnlcbiAgICovXG4gIGNvbnN0cnVjdG9yKHdpbiwgcmVnaXN0cnkpIHtcbiAgICAvKipcbiAgICAgKiBAY29uc3QgQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLndpbl8gPSB3aW47XG5cbiAgICAvKipcbiAgICAgKiBAY29uc3QgQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLnJlZ2lzdHJ5XyA9IHJlZ2lzdHJ5O1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCBEZWZlcnJlZERlZj59XG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAY29uc3RcbiAgICAgKi9cbiAgICB0aGlzLnBlbmRpbmdEZWZpbmVzXyA9IHRoaXMud2luXy5PYmplY3QuY3JlYXRlKG51bGwpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIHRoZSBjdXN0b20gZWxlbWVudC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICogQHBhcmFtIHshQ3VzdG9tRWxlbWVudENvbnN0cnVjdG9yRGVmfSBjdG9yXG4gICAqIEBwYXJhbSB7IU9iamVjdD19IG9wdGlvbnNcbiAgICovXG4gIGRlZmluZShuYW1lLCBjdG9yLCBvcHRpb25zKSB7XG4gICAgdGhpcy5yZWdpc3RyeV8uZGVmaW5lKG5hbWUsIGN0b3IsIG9wdGlvbnMpO1xuXG4gICAgLy8gSWYgYW55b25lIGlzIHdhaXRpbmcgZm9yIHRoaXMgY3VzdG9tIGVsZW1lbnQgdG8gYmUgZGVmaW5lZCwgcmVzb2x2ZVxuICAgIC8vIHRoZWlyIHByb21pc2UuXG4gICAgY29uc3QgcGVuZGluZyA9IHRoaXMucGVuZGluZ0RlZmluZXNfO1xuICAgIGNvbnN0IGRlZmVycmVkID0gcGVuZGluZ1tuYW1lXTtcbiAgICBpZiAoZGVmZXJyZWQpIHtcbiAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgIGRlbGV0ZSBwZW5kaW5nW25hbWVdO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGNvbnN0cnVjdG9yIG9mIHRoZSAoYWxyZWFkeSBkZWZpbmVkKSBjdXN0b20gZWxlbWVudC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICogQHJldHVybiB7IUN1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZnx1bmRlZmluZWR9XG4gICAqL1xuICBnZXQobmFtZSkge1xuICAgIGNvbnN0IGRlZiA9IHRoaXMucmVnaXN0cnlfLmdldEJ5TmFtZShuYW1lKTtcbiAgICBpZiAoZGVmKSB7XG4gICAgICByZXR1cm4gZGVmLmN0b3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2FpdHMgdW50aWwgdGhlIGN1c3RvbSBlbGVtZW50IGlzIGRlZmluZWQuXG4gICAqIElmIHRoZSBjdXN0b20gZWxlbWVudCBpcyBhbHJlYWR5IGRlZmluZWQsIHJldHVybnMgYSByZXNvbHZlZCBwcm9taXNlLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTx1bmRlZmluZWQ+fVxuICAgKi9cbiAgd2hlbkRlZmluZWQobmFtZSkge1xuICAgIGNvbnN0IHtQcm9taXNlLCBTeW50YXhFcnJvcn0gPSB0aGlzLndpbl87XG4gICAgYXNzZXJ0VmFsaWROYW1lKFN5bnRheEVycm9yLCBuYW1lKTtcblxuICAgIGlmICh0aGlzLnJlZ2lzdHJ5Xy5nZXRCeU5hbWUobmFtZSkpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG5cbiAgICBjb25zdCBwZW5kaW5nID0gdGhpcy5wZW5kaW5nRGVmaW5lc187XG4gICAgY29uc3QgZGVmZXJyZWQgPSBwZW5kaW5nW25hbWVdO1xuICAgIGlmIChkZWZlcnJlZCkge1xuICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgfVxuXG4gICAgbGV0IHJlc29sdmU7XG4gICAgY29uc3QgcHJvbWlzZSA9IG5ldyAvKk9LKi9Qcm9taXNlKHJlcyA9PiByZXNvbHZlID0gcmVzKTtcbiAgICBwZW5kaW5nW25hbWVdID0ge1xuICAgICAgcHJvbWlzZSxcbiAgICAgIHJlc29sdmUsXG4gICAgfTtcblxuICAgIHJldHVybiBwcm9taXNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZ3JhZGUgYWxsIGN1c3RvbSBlbGVtZW50cyBpbnNpZGUgcm9vdC5cbiAgICpcbiAgICogQHBhcmFtIHshTm9kZX0gcm9vdFxuICAgKi9cbiAgdXBncmFkZShyb290KSB7XG4gICAgdGhpcy5yZWdpc3RyeV8udXBncmFkZShyb290KTtcbiAgfVxufVxuXG4vKipcbiAqIFRoaXMgaW50ZXJuYWwgQVBJcyBuZWNlc3NhcnkgdG8gcnVuIHRoZSBDdXN0b21FbGVtZW50UmVnaXN0cnkuXG4gKiBTaW5jZSBSZWdpc3RyeSBpcyBuZXZlciBleHBvc2VkIGV4dGVybmFsbHksIGFsbCBtZXRob2RzIGFyZSBhY3R1YWxseVxuICogYXZhaWxhYmxlIG9uIHRoZSBpbnN0YW5jZS5cbiAqL1xuY2xhc3MgUmVnaXN0cnkge1xuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHdpbikge1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlIEBjb25zdFxuICAgICAqL1xuICAgIHRoaXMud2luXyA9IHdpbjtcblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlIEBjb25zdFxuICAgICAqL1xuICAgIHRoaXMuZG9jXyA9IHdpbi5kb2N1bWVudDtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHshT2JqZWN0PHN0cmluZywgIUN1c3RvbUVsZW1lbnREZWY+fVxuICAgICAqIEBwcml2YXRlXG4gICAgICogQGNvbnN0XG4gICAgICovXG4gICAgdGhpcy5kZWZpbml0aW9uc18gPSB3aW4uT2JqZWN0LmNyZWF0ZShudWxsKTtcblxuICAgIC8qKlxuICAgICAqIEEgdXAtdG8tZGF0ZSBET00gc2VsZWN0b3IgZm9yIGFsbCBjdXN0b20gZWxlbWVudHMuXG4gICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgKi9cbiAgICB0aGlzLnF1ZXJ5XyA9ICcnO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGN1cnJlbnRseSB1cGdyYWRpbmcgZWxlbWVudC5cbiAgICAgKiBAcHJpdmF0ZSB7RWxlbWVudH1cbiAgICAgKi9cbiAgICB0aGlzLmN1cnJlbnRfID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgY3VycmVudGx5LWJlaW5nLXVwZ3JhZGVkIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBXaGVuIGFuIGFscmVhZHkgY3JlYXRlZCAodGhyb3VnaCB0aGUgRE9NIHBhcnNpbmcgQVBJcywgb3IgaW5uZXJIVE1MKVxuICAgKiBjdXN0b20gZWxlbWVudCBub2RlIGlzIGJlaW5nIHVwZ3JhZGVkLCB3ZSBjYW4ndCBqdXN0IGNyZWF0ZSBhIG5ldyBub2RlXG4gICAqIChpdCdzIGlsbGVnYWwgaW4gdGhlIHNwZWMpLiBCdXQgd2Ugc3RpbGwgbmVlZCB0byBydW4gdGhlIGN1c3RvbSBlbGVtZW50J3NcbiAgICogY29uc3RydWN0b3IgY29kZSBvbiB0aGUgbm9kZS4gV2UgYXZvaWQgdGhpcyBjb251bmRydW0gYnkgcnVubmluZyB0aGVcbiAgICogY29uc3RydWN0b3Igd2hpbGUgcmV0dXJuaW5nIHRoaXMgY3VycmVudCBub2RlIGluIHRoZSBIVE1MRWxlbWVudFxuICAgKiBjbGFzcyBjb25zdHJ1Y3RvciAodGhlIGJhc2UgY2xhc3Mgb2YgYWxsIGN1c3RvbSBlbGVtZW50cykuXG4gICAqXG4gICAqIEByZXR1cm4ge0VsZW1lbnR9XG4gICAqL1xuICBjdXJyZW50KCkge1xuICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLmN1cnJlbnRfO1xuICAgIHRoaXMuY3VycmVudF8gPSBudWxsO1xuICAgIHJldHVybiBjdXJyZW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEZpbmRzIHRoZSBjdXN0b20gZWxlbWVudCBkZWZpbml0aW9uIGJ5IG5hbWUuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAqIEByZXR1cm4ge0N1c3RvbUVsZW1lbnREZWZ8dW5kZWZpbmVkfVxuICAgKi9cbiAgZ2V0QnlOYW1lKG5hbWUpIHtcbiAgICBjb25zdCBkZWZpbml0aW9uID0gdGhpcy5kZWZpbml0aW9uc19bbmFtZV07XG4gICAgaWYgKGRlZmluaXRpb24pIHtcbiAgICAgIHJldHVybiBkZWZpbml0aW9uO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGaW5kcyB0aGUgY3VzdG9tIGVsZW1lbnQgZGVmaW5pdGlvbiBieSBjb25zdHJ1Y3RvciBpbnN0YW5jZS5cbiAgICpcbiAgICogQHBhcmFtIHtDdXN0b21FbGVtZW50Q29uc3RydWN0b3JEZWZ9IGN0b3JcbiAgICogQHJldHVybiB7Q3VzdG9tRWxlbWVudERlZnx1bmRlZmluZWR9XG4gICAqL1xuICBnZXRCeUNvbnN0cnVjdG9yKGN0b3IpIHtcbiAgICBjb25zdCBkZWZpbml0aW9ucyA9IHRoaXMuZGVmaW5pdGlvbnNfO1xuXG4gICAgZm9yIChjb25zdCBuYW1lIGluIGRlZmluaXRpb25zKSB7XG4gICAgICBjb25zdCBkZWYgPSBkZWZpbml0aW9uc1tuYW1lXTtcbiAgICAgIGlmIChkZWYuY3RvciA9PT0gY3Rvcikge1xuICAgICAgICByZXR1cm4gZGVmO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlcnMgdGhlIGN1c3RvbSBlbGVtZW50IGRlZmluaXRpb24sIGFuZCB1cGdyYWRlcyBhbGwgZWxlbWVudHMgYnkgdGhhdFxuICAgKiBuYW1lIGluIHRoZSByb290IGRvY3VtZW50LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcGFyYW0geyFDdXN0b21FbGVtZW50Q29uc3RydWN0b3JEZWZ9IGN0b3JcbiAgICogQHBhcmFtIHshT2JqZWN0fHVuZGVmaW5lZH0gb3B0aW9uc1xuICAgKi9cbiAgZGVmaW5lKG5hbWUsIGN0b3IsIG9wdGlvbnMpIHtcbiAgICBjb25zdCB7RXJyb3IsIFN5bnRheEVycm9yfSA9IHRoaXMud2luXztcblxuICAgIGlmIChvcHRpb25zKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4dGVuZGluZyBuYXRpdmUgY3VzdG9tIGVsZW1lbnRzIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbiAgICB9XG5cbiAgICBhc3NlcnRWYWxpZE5hbWUoU3ludGF4RXJyb3IsIG5hbWUpO1xuXG4gICAgaWYgKHRoaXMuZ2V0QnlOYW1lKG5hbWUpIHx8XG4gICAgICAgIHRoaXMuZ2V0QnlDb25zdHJ1Y3RvcihjdG9yKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBkdXBsaWNhdGUgZGVmaW5pdGlvbiBcIiR7bmFtZX1cImApO1xuICAgIH1cblxuICAgIC8vIFRPRE8oanJpZGdld2VsbCk6IFJlY29yZCBjb25uZWN0ZWRDYWxsYmFjaywgZGlzY29ubmVjdGVkQ2FsbGJhY2ssXG4gICAgLy8gYWRvcHRlZENhbGxiYWNrLCBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2ssIGFuZCBvYnNlcnZlZEF0dHJpYnV0ZXMuXG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogSWYgYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrLCBnYXRoZXIgb2JzZXJ2ZWRBdHRyaWJ1dGVzXG4gICAgdGhpcy5kZWZpbml0aW9uc19bbmFtZV0gPSB7XG4gICAgICBuYW1lLFxuICAgICAgY3RvcixcbiAgICB9O1xuXG4gICAgdGhpcy5vYnNlcnZlXyhuYW1lKTtcbiAgICB0aGlzLnVwZ3JhZGUodGhpcy5kb2NfLCBuYW1lKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGdyYWRlcyBjdXN0b20gZWxlbWVudHMgZGVzY2VuZGFudHMgb2Ygcm9vdCAoYnV0IG5vdCBpbmNsdWRpbmcgcm9vdCkuXG4gICAqXG4gICAqIFdoZW4gY2FsbGVkIHdpdGggYW4gb3B0X3F1ZXJ5LCBpdCBib3RoIHVwZ3JhZGVzIGFuZCBjb25uZWN0cyB0aGUgY3VzdG9tXG4gICAqIGVsZW1lbnRzICh0aGlzIGlzIHVzZWQgZHVyaW5nIHRoZSBjdXN0b20gZWxlbWVudCBkZWZpbmUgYWxnb3JpdGhtKS5cbiAgICpcbiAgICogQHBhcmFtIHshTm9kZX0gcm9vdFxuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9xdWVyeVxuICAgKi9cbiAgdXBncmFkZShyb290LCBvcHRfcXVlcnkpIHtcbiAgICAvLyBPbmx5IEN1c3RvbUVsZW1lbnRSZWdpc3RyeS5wLmRlZmluZSBwcm92aWRlcyBhIHF1ZXJ5ICh0aGUgbmV3bHkgZGVmaW5lZFxuICAgIC8vIGN1c3RvbSBlbGVtZW50KS4gSW4gdGhpcyBjYXNlLCB3ZSBhcmUgYm90aCB1cGdyYWRpbmcgX2FuZF8gY29ubmVjdGluZ1xuICAgIC8vIHRoZSBjdXN0b20gZWxlbWVudHMuXG4gICAgY29uc3QgbmV3bHlEZWZpbmVkID0gISFvcHRfcXVlcnk7XG4gICAgY29uc3QgcXVlcnkgPSBvcHRfcXVlcnkgfHwgdGhpcy5xdWVyeV87XG4gICAgY29uc3QgdXBncmFkZUNhbmRpZGF0ZXMgPSB0aGlzLnF1ZXJ5QWxsXyhyb290LCBxdWVyeSk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHVwZ3JhZGVDYW5kaWRhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBjYW5kaWRhdGUgPSB1cGdyYWRlQ2FuZGlkYXRlc1tpXTtcbiAgICAgIGlmIChuZXdseURlZmluZWQpIHtcbiAgICAgICAgdGhpcy5jb25uZWN0ZWRDYWxsYmFja18oY2FuZGlkYXRlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMudXBncmFkZVNlbGYoY2FuZGlkYXRlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBncmFkZXMgdGhlIGN1c3RvbSBlbGVtZW50IG5vZGUsIGlmIGEgY3VzdG9tIGVsZW1lbnQgaGFzIGJlZW4gcmVnaXN0ZXJlZFxuICAgKiBieSB0aGlzIG5hbWUuXG4gICAqXG4gICAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAgICovXG4gIHVwZ3JhZGVTZWxmKG5vZGUpIHtcbiAgICBjb25zdCBkZWYgPSB0aGlzLmdldEJ5TmFtZShub2RlLmxvY2FsTmFtZSk7XG4gICAgaWYgKCFkZWYpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnVwZ3JhZGVTZWxmXygvKiogQHR5cGUgeyFFbGVtZW50fSAqLyhub2RlKSwgZGVmKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFOb2RlfSByb290XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBxdWVyeVxuICAgKiBAcmV0dXJuIHshQXJyYXl8IU5vZGVMaXN0fVxuICAgKi9cbiAgcXVlcnlBbGxfKHJvb3QsIHF1ZXJ5KSB7XG4gICAgaWYgKCFxdWVyeSB8fCAhcm9vdC5xdWVyeVNlbGVjdG9yQWxsKSB7XG4gICAgICAvLyBOb3RoaW5nIHRvIGRvLi4uXG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgcmV0dXJuIHJvb3QucXVlcnlTZWxlY3RvckFsbChxdWVyeSk7XG4gIH1cblxuICAvKipcbiAgICogVXBncmFkZXMgdGhlIChhbHJlYWR5IGNyZWF0ZWQgdmlhIERPTSBwYXJzaW5nKSBjdXN0b20gZWxlbWVudC5cbiAgICpcbiAgICogQHBhcmFtIHshRWxlbWVudH0gbm9kZVxuICAgKiBAcGFyYW0geyFDdXN0b21FbGVtZW50RGVmfSBkZWZcbiAgICovXG4gIHVwZ3JhZGVTZWxmXyhub2RlLCBkZWYpIHtcbiAgICBjb25zdCB7Y3Rvcn0gPSBkZWY7XG4gICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBjdG9yKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gRGVzcGl0ZSBob3cgaXQgbG9va3MsIHRoaXMgaXMgbm90IGEgdXNlbGVzcyBjb25zdHJ1Y3Rpb24uXG4gICAgLy8gSFRNTEVsZW1lbnRQb2x5ZmlsbCAodGhlIGJhc2UgY2xhc3Mgb2YgYWxsIGN1c3RvbSBlbGVtZW50cykgd2lsbCByZXR1cm5cbiAgICAvLyB0aGUgY3VycmVudCBub2RlLCBhbGxvd2luZyB0aGUgY3VzdG9tIGVsZW1lbnQncyBzdWJjbGFzcyBjb25zdHJ1Y3RvciB0b1xuICAgIC8vIHJ1biBvbiB0aGUgbm9kZS4gVGhlIG5vZGUgaXRzZWxmIGlzIGFscmVhZHkgY29uc3RydWN0ZWQsIHNvIHRoZSByZXR1cm5cbiAgICAvLyB2YWx1ZSBpcyBqdXN0IHRoZSBub2RlLlxuICAgIHRoaXMuY3VycmVudF8gPSBub2RlO1xuICAgIGNvbnN0IGVsID0gbmV3IGN0b3IoKTtcblxuICAgIGlmIChlbCAhPT0gbm9kZSkge1xuICAgICAgdGhyb3cgbmV3IHRoaXMud2luXy5FcnJvcihcbiAgICAgICAgICAnQ29uc3RydWN0b3IgaWxsZWdhbGx5IHJldHVybmVkIGEgZGlmZmVyZW50IGluc3RhbmNlLicpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGaXJlcyBjb25uZWN0ZWRDYWxsYmFjayBvbiB0aGUgY3VzdG9tIGVsZW1lbnQsIGlmIGl0IGhhcyBvbmUuXG4gICAqIFRoaXMgYWxzbyB1cGdyYWRlcyB0aGUgY3VzdG9tIGVsZW1lbnQsIHNpbmNlIGl0IG1heSBub3QgaGF2ZSBiZWVuXG4gICAqIGFjY2Vzc2libGUgdmlhIHRoZSByb290IGRvY3VtZW50IGJlZm9yZSAoYSBkZXRhY2hlZCBET00gdHJlZSkuXG4gICAqXG4gICAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAgICovXG4gIGNvbm5lY3RlZENhbGxiYWNrXyhub2RlKSB7XG4gICAgY29uc3QgZGVmID0gdGhpcy5nZXRCeU5hbWUobm9kZS5sb2NhbE5hbWUpO1xuICAgIGlmICghZGVmKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMudXBncmFkZVNlbGZfKC8qKiBAdHlwZSB7IUVsZW1lbnR9ICovKG5vZGUpLCBkZWYpO1xuICAgIC8vIFRPRE8oanJpZGdld2VsbCk6IEl0IG1heSBiZSBhcHByb3ByaWF0ZSB0byBhZG9wdENhbGxiYWNrLCBpZiB0aGUgbm9kZVxuICAgIC8vIHVzZWQgdG8gYmUgaW4gYW5vdGhlciBkb2MuXG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogSSBzaG91bGQgYmUgY2FsbGluZyB0aGUgZGVmaW5pdGlvbnMgY29ubmVjdGVkQ2FsbGJhY2tcbiAgICAvLyB3aXRoIG5vZGUgYXMgdGhlIGNvbnRleHQuXG4gICAgaWYgKG5vZGUuY29ubmVjdGVkQ2FsbGJhY2spIHtcbiAgICAgIG5vZGUuY29ubmVjdGVkQ2FsbGJhY2soKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRmlyZXMgZGlzY29ubmVjdGVkQ2FsbGJhY2sgb24gdGhlIGN1c3RvbSBlbGVtZW50LCBpZiBpdCBoYXMgb25lLlxuICAgKlxuICAgKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gICAqL1xuICBkaXNjb25uZWN0ZWRDYWxsYmFja18obm9kZSkge1xuICAgIC8vIFRPRE8oanJpZGdld2VsbCk6IEkgc2hvdWxkIGJlIGNhbGxpbmcgdGhlIGRlZmluaXRpb25zIGNvbm5lY3RlZENhbGxiYWNrXG4gICAgLy8gd2l0aCBub2RlIGFzIHRoZSBjb250ZXh0LlxuICAgIGlmIChub2RlLmRpc2Nvbm5lY3RlZENhbGxiYWNrKSB7XG4gICAgICBub2RlLmRpc2Nvbm5lY3RlZENhbGxiYWNrKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlY29yZHMgbmFtZSBhcyBhIHJlZ2lzdGVyZWQgY3VzdG9tIGVsZW1lbnQgdG8gb2JzZXJ2ZS5cbiAgICpcbiAgICogU3RhcnRzIHRoZSBNdXRhdGlvbiBPYnNlcnZlciBpZiB0aGlzIGlzIHRoZSBmaXJzdCByZWdpc3RlcmVkIGN1c3RvbVxuICAgKiBlbGVtZW50LiBUaGlzIGlzIGRlZmVycmVkIHVudGlsIHRoZSBmaXJzdCBjdXN0b20gZWxlbWVudCBpcyBkZWZpbmVkIHRvXG4gICAqIHNwZWVkIHVwIGluaXRpYWwgcmVuZGVyaW5nIG9mIHRoZSBwYWdlLlxuICAgKlxuICAgKiBNdXRhdGlvbiBPYnNlcnZlcnMgYXJlIGNvbnZlbmllbnRseSBhdmFpbGFibGUgaW4gZXZlcnkgYnJvd3NlciB3ZSBjYXJlXG4gICAqIGFib3V0LiBXaGVuIGEgbm9kZSBpcyBjb25uZWN0ZWQgdG8gdGhlIHJvb3QgZG9jdW1lbnQsIGFsbCBjdXN0b21cbiAgICogZWxlbWVudHMgKGluY2x1ZGluZyB0aGF0IG5vZGUgaXRlc2VsZikgd2lsbCBiZSB1cGdyYWRlZCBhbmQgY2FsbFxuICAgKiBjb25uZWN0ZWRDYWxsYmFjay4gV2hlbiBhIG5vZGUgaXMgZGlzY29ubmVjdGVkQ2FsbGJhY2sgZnJvbSB0aGUgcm9vdFxuICAgKiBkb2N1bWVudCwgYWxsIGN1c3RvbSBlbGVtZW50cyB3aWxsIGNhbGwgZGlzY29ubmVjdGVkQ2FsbGJhY2suXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAqL1xuICBvYnNlcnZlXyhuYW1lKSB7XG4gICAgaWYgKHRoaXMucXVlcnlfKSB7XG4gICAgICB0aGlzLnF1ZXJ5XyArPSBgLCR7bmFtZX1gO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMucXVlcnlfID0gbmFtZTtcblxuICAgIC8vIFRoZSBmaXJzdCByZWdpc3RlcmVkIG5hbWUgc3RhcnRzIHRoZSBtdXRhdGlvbiBvYnNlcnZlci5cbiAgICBjb25zdCBvYnNlcnZlciA9IG5ldyB0aGlzLndpbl8uTXV0YXRpb25PYnNlcnZlcihyZWNvcmRzID0+IHtcbiAgICAgIGlmIChyZWNvcmRzKSB7XG4gICAgICAgIHRoaXMuaGFuZGxlUmVjb3Jkc18ocmVjb3Jkcyk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmRvY18sIHtcbiAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgIHN1YnRyZWU6IHRydWUsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIGFsbCB0aGUgTXV0YXRpb24gT2JzZXJ2ZXIncyBNdXRhdGlvbiBSZWNvcmRzLlxuICAgKiBBbGwgYWRkZWQgY3VzdG9tIGVsZW1lbnRzIHdpbGwgYmUgdXBncmFkZWQgKGlmIG5vdCBhbHJlYWR5KSBhbmQgY2FsbFxuICAgKiBjb25uZWN0ZWRDYWxsYmFjay4gQWxsIHJlbW92ZWQgY3VzdG9tIGVsZW1lbnRzIHdpbGwgY2FsbFxuICAgKiBkaXNjb25uZWN0ZWRDYWxsYmFjay5cbiAgICpcbiAgICogQHBhcmFtIHshQXJyYXk8IU11dGF0aW9uUmVjb3JkPn0gcmVjb3Jkc1xuICAgKi9cbiAgaGFuZGxlUmVjb3Jkc18ocmVjb3Jkcykge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVjb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgcmVjb3JkID0gcmVjb3Jkc1tpXTtcbiAgICAgIGlmICghcmVjb3JkKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB7YWRkZWROb2RlcywgcmVtb3ZlZE5vZGVzfSA9IHJlY29yZDtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWRkZWROb2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBub2RlID0gYWRkZWROb2Rlc1tpXTtcbiAgICAgICAgY29uc3QgY29ubmVjdGVkQ2FuZGlkYXRlcyA9IHRoaXMucXVlcnlBbGxfKG5vZGUsIHRoaXMucXVlcnlfKTtcbiAgICAgICAgdGhpcy5jb25uZWN0ZWRDYWxsYmFja18obm9kZSk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29ubmVjdGVkQ2FuZGlkYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuY29ubmVjdGVkQ2FsbGJhY2tfKGNvbm5lY3RlZENhbmRpZGF0ZXNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVtb3ZlZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSByZW1vdmVkTm9kZXNbaV07XG4gICAgICAgIGNvbnN0IGRpc2Nvbm5lY3RlZENhbmRpZGF0ZXMgPSB0aGlzLnF1ZXJ5QWxsXyhub2RlLCB0aGlzLnF1ZXJ5Xyk7XG4gICAgICAgIHRoaXMuZGlzY29ubmVjdGVkQ2FsbGJhY2tfKG5vZGUpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpc2Nvbm5lY3RlZENhbmRpZGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RlZENhbGxiYWNrXyhkaXNjb25uZWN0ZWRDYW5kaWRhdGVzW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIERvZXMgdGhlIHBvbHlmaWxsaW5nLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZnVuY3Rpb24gcG9seWZpbGwod2luKSB7XG4gIGNvbnN0IHtIVE1MRWxlbWVudCwgRWxlbWVudCwgTm9kZSwgRG9jdW1lbnQsIE9iamVjdCwgZG9jdW1lbnR9ID0gd2luO1xuICBjb25zdCB7Y3JlYXRlRWxlbWVudCwgY2xvbmVOb2RlLCBpbXBvcnROb2RlfSA9IGRvY3VtZW50O1xuXG4gIGNvbnN0IHJlZ2lzdHJ5ID0gbmV3IFJlZ2lzdHJ5KHdpbik7XG4gIGNvbnN0IGN1c3RvbUVsZW1lbnRzID0gbmV3IEN1c3RvbUVsZW1lbnRSZWdpc3RyeSh3aW4sIHJlZ2lzdHJ5KTtcblxuICAvLyBFeHBvc2UgdGhlIGN1c3RvbSBlbGVtZW50IHJlZ2lzdHJ5LlxuICAvLyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHdpbmRvdywgJ2N1c3RvbUVsZW1lbnRzJylcbiAgLy8ge2dldDogxpIsIHNldDogdW5kZWZpbmVkLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWV9XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW4sICdjdXN0b21FbGVtZW50cycsIHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAvLyB3cml0YWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGN1c3RvbUVsZW1lbnRzLFxuICB9KTtcblxuICAvLyBQYXRjaCBjcmVhdGVFbGVtZW50IHRvIGltbWVkaWF0ZWx5IHVwZ3JhZGUgdGhlIGN1c3RvbSBlbGVtZW50LlxuICAvLyBUaGlzIGhhcyB0aGUgYWRkZWQgYmVuZWZpdCB0aGF0IGl0IGF2b2lkcyB0aGUgXCJhbHJlYWR5IGNyZWF0ZWQgYnV0IG5lZWRzXG4gIC8vIGNvbnN0cnVjdG9yIGNvZGUgcnVuXCIgY2hpY2tlbi1hbmQtZWdnIHByb2JsZW0uXG4gIERvY3VtZW50LnByb3RvdHlwZS5jcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24gY3JlYXRlRWxlbWVudFBvbHlmaWxsKG5hbWUpIHtcbiAgICBjb25zdCBkZWYgPSByZWdpc3RyeS5nZXRCeU5hbWUobmFtZSk7XG4gICAgaWYgKGRlZikge1xuICAgICAgcmV0dXJuIG5ldyBkZWYuY3RvcigpO1xuICAgIH1cbiAgICByZXR1cm4gY3JlYXRlRWxlbWVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIC8vIFBhdGNoIGltcG9ydE5vZGUgdG8gaW1tZWRpYXRlbHkgdXBncmFkZSBjdXN0b20gZWxlbWVudHMuXG4gIC8vIFRPRE8oanJpZGdld2VsbCk6IENhbiBmaXJlIGFkb3B0ZWRDYWxsYmFjayBmb3IgY3Jvc3MgZG9jIGltcG9ydHMuXG4gIERvY3VtZW50LnByb3RvdHlwZS5pbXBvcnROb2RlID0gZnVuY3Rpb24gaW1wb3J0Tm9kZVBvbHlmaWxsKCkge1xuICAgIGNvbnN0IGltcG9ydGVkID0gaW1wb3J0Tm9kZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmIChpbXBvcnRlZCkge1xuICAgICAgcmVnaXN0cnkudXBncmFkZVNlbGYoaW1wb3J0ZWQpO1xuICAgICAgcmVnaXN0cnkudXBncmFkZShpbXBvcnRlZCk7XG4gICAgfVxuICAgIHJldHVybiBpbXBvcnRlZDtcbiAgfTtcblxuICAvLyBQYXRjaCBjbG9uZU5vZGUgdG8gaW1tZWRpYXRlbHkgdXBncmFkZSBjdXN0b20gZWxlbWVudHMuXG4gIE5vZGUucHJvdG90eXBlLmNsb25lTm9kZSA9IGZ1bmN0aW9uIGNsb25lTm9kZVBvbHlmaWxsKCkge1xuICAgIGNvbnN0IGNsb25lZCA9IGNsb25lTm9kZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIHJlZ2lzdHJ5LnVwZ3JhZGVTZWxmKGNsb25lZCk7XG4gICAgcmVnaXN0cnkudXBncmFkZShjbG9uZWQpO1xuICAgIHJldHVybiBjbG9uZWQ7XG4gIH07XG5cbiAgLy8gUGF0Y2ggdGhlIGlubmVySFRNTCBzZXR0ZXIgdG8gaW1tZWRpYXRlbHkgdXBncmFkZSBjdXN0b20gZWxlbWVudHMuXG4gIC8vIE5vdGUsIHRoaXMgY291bGQgdGVjaG5pY2FsbHkgZmlyZSBjb25uZWN0ZWRDYWxsYmFja3MgaWYgdGhpcyBub2RlIHdhc1xuICAvLyBjb25uZWN0ZWQsIGJ1dCB3ZSBsZWF2ZSB0aGF0IHRvIHRoZSBNdXRhdGlvbiBPYnNlcnZlci5cbiAgY29uc3QgaW5uZXJIVE1MRGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoRWxlbWVudC5wcm90b3R5cGUsXG4gICAgICAnaW5uZXJIVE1MJyk7XG4gIGNvbnN0IGlubmVySFRNTFNldHRlciA9IGlubmVySFRNTERlc2Muc2V0O1xuICBpbm5lckhUTUxEZXNjLnNldCA9IGZ1bmN0aW9uKGh0bWwpIHtcbiAgICBpbm5lckhUTUxTZXR0ZXIuY2FsbCh0aGlzLCBodG1sKTtcbiAgICByZWdpc3RyeS51cGdyYWRlKHRoaXMpO1xuICB9O1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRWxlbWVudC5wcm90b3R5cGUsICdpbm5lckhUTUwnLCBpbm5lckhUTUxEZXNjKTtcblxuICAvKipcbiAgICogWW91IGNhbid0IHVzZSB0aGUgcmVhbCBIVE1MRWxlbWVudCBjb25zdHJ1Y3RvciwgYmVjYXVzZSB5b3UgY2FuJ3Qgc3ViY2xhc3NcbiAgICogaXQgd2l0aG91dCB1c2luZyBuYXRpdmUgY2xhc3Nlcy4gU28sIG1vY2sgaXRzIGFwcHJveGltYXRpb24gdXNpbmdcbiAgICogY3JlYXRlRWxlbWVudC5cbiAgICovXG4gIGZ1bmN0aW9uIEhUTUxFbGVtZW50UG9seWZpbGwoKSB7XG4gICAgY29uc3Qge2NvbnN0cnVjdG9yfSA9IHRoaXM7XG5cbiAgICAvLyBJZiB3ZSdyZSB1cGdyYWRpbmcgYW4gYWxyZWFkeSBjcmVhdGVkIGN1c3RvbSBlbGVtZW50LCB3ZSBjYW4ndCBjcmVhdGVcbiAgICAvLyBhbm90aGVyIG5ldyBub2RlIChieSB0aGUgc3BlYywgaXQgbXVzdCBiZSB0aGUgc2FtZSBub2RlKS5cbiAgICBsZXQgZWwgPSByZWdpc3RyeS5jdXJyZW50KCk7XG5cbiAgICAvLyBJZiB0aGVyZSdzIG5vdCBhIGFscmVhZHkgY3JlYXRlZCBjdXN0b20gZWxlbWVudCwgd2UncmUgYmVpbmcgaW52b2tlZCB2aWFcbiAgICAvLyBgbmV3YGluZyB0aGUgY29uc3RydWN0b3IuXG4gICAgLy9cbiAgICAvLyBUZWNobmljYWxseSwgd2UgY291bGQgZ2V0IGhlcmUgdmlhIGNyZWF0ZUVsZW1lbnQsIGJ1dCB3ZSBwYXRjaGVkIHRoYXQuXG4gICAgLy8gSWYgaXQgdGhlIGN1c3RvbSBlbGVtZW50IHdhcyByZWdpc3RlcmVkLCB0aGUgcGF0Y2ggdHVybmVkIGl0IGludG8gYVxuICAgIC8vIGBuZXdgIGNhbGwuXG4gICAgLy8gSWYgaXQgd2FzIG5vdCByZWdpc3RlcmVkLCB0aGUgbmF0aXZlIGNyZWF0ZUVsZW1lbnQgaXMgdXNlZC4gQW5kIGlmXG4gICAgLy8gbmF0aXZlIGNyZWF0ZUVsZW1lbnQgaXMgYmVpbmcgdXNlZCBhbmQgd2UgZ290IHRvIHRoaXMgY29kZSwgd2UncmUgcmVhbGx5XG4gICAgLy8gaW4gYW4gaW5maW5pdGUgbG9vcCAoYSBuYXRpdmUgY3JlYXRlRWxlbWVudCBjYWxsIGp1c3QgYmVsb3cpIHNvIHdlJ3ZlXG4gICAgLy8gZ290IGJpZ2dlciBwcm9ibGVtcy5cbiAgICAvL1xuICAgIC8vIFNvIGp1c3QgdGFrZSBteSB3b3JkIHdlIGdvdCBoZXJlIHZpYSBgbmV3YC5cbiAgICBpZiAoIWVsKSB7XG4gICAgICAvLyBUaGUgY3VzdG9tIGVsZW1lbnQgZGVmaW5pdGlvbiBpcyBhbiBpbnZhcmlhbnQuIElmIHRoZSBjdXN0b20gZWxlbWVudFxuICAgICAgLy8gaXMgcmVnaXN0ZXJlZCwgZXZlcnl0aGluZyB3b3Jrcy4gSWYgaXQncyBub3QsIGl0IHRocm93cyBpbiB0aGUgbWVtYmVyXG4gICAgICAvLyBwcm9wZXJ0eSBhY2Nlc3MgKG9ubHkgZGVmaW5lZCBjdXN0b20gZWxlbWVudHMgY2FuIGJlIGRpcmVjdGx5XG4gICAgICAvLyBjb25zdHJ1Y3RlZCB2aWEgYG5ld2ApLlxuICAgICAgY29uc3QgZGVmID0gcmVnaXN0cnkuZ2V0QnlDb25zdHJ1Y3Rvcihjb25zdHJ1Y3Rvcik7XG4gICAgICBlbCA9IGNyZWF0ZUVsZW1lbnQuY2FsbChkb2N1bWVudCwgZGVmLm5hbWUpO1xuICAgIH1cblxuICAgIC8vIEZpbmFsbHksIGlmIHRoZSBub2RlIHdhcyBhbHJlYWR5IGNvbnN0cnVjdGVkLCB3ZSBuZWVkIHRvIHJlc2V0IGl0J3NcbiAgICAvLyBwcm90b3R5cGUgdG8gdGhlIGN1c3RvbSBlbGVtZW50IHByb3RvdHlwZS4gQW5kIGlmIGl0IHdhc24ndCBhbHJlYWR5XG4gICAgLy8gY29uc3RydWN0ZWQsIHdlIGNyZWF0ZWQgYSBuZXcgbm9kZSB2aWEgbmF0aXZlIGNyZWF0ZUVsZW1lbnQsIGFuZCB3ZSBuZWVkXG4gICAgLy8gdG8gcmVzZXQgaXQncyBwcm90b3R5cGUuIEJhc2ljYWxseSBhbHdheXMgcmVzZXQgdGhlIHByb3RvdHlwZS5cbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoZWwsIGNvbnN0cnVjdG9yLnByb3RvdHlwZSk7XG4gICAgcmV0dXJuIGVsO1xuICB9XG4gIHN1YkNsYXNzKE9iamVjdCwgSFRNTEVsZW1lbnQsIEhUTUxFbGVtZW50UG9seWZpbGwpO1xuXG4gIC8vIEV4cG9zZSB0aGUgcG9seWZpbGxlZCBIVE1MRWxlbWVudCBjb25zdHJ1Y3RvciBmb3IgZXZlcnlvbmUgdG8gZXh0ZW5kIGZyb20uXG4gIHdpbi5IVE1MRWxlbWVudCA9IEhUTUxFbGVtZW50UG9seWZpbGw7XG59XG5cbi8qKlxuICogV3JhcHMgSFRNTEVsZW1lbnQgaW4gYSBSZWZsZWN0LmNvbnN0cnVjdCBjb25zdHJ1Y3Rvciwgc28gdGhhdCB0cmFuc3BpbGVkXG4gKiBjbGFzc2VzIGNhbiBgX3RoaXMgPSBzdXBlckNsYXNzLmNhbGwodGhpcylgIGR1cmluZyB0aGVpciBjb25zdHJ1Y3Rpb24uXG4gKlxuICogVGhpcyBpcyBvbmx5IHVzZWQgd2hlbiBDdXN0b20gRWxlbWVudHMgdjEgaXMgYWxyZWFkeSBhdmFpbGFibGUgX2FuZF8gd2UncmVcbiAqIHVzaW5nIHRyYW5zcGlsZWQgY2xhc3NlcyAod2hpY2ggdXNlIEVTNSBjb25zdHJ1Y3Rpb24gaWRpb21zKS5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5mdW5jdGlvbiB3cmFwSFRNTEVsZW1lbnQod2luKSB7XG4gIGNvbnN0IHtIVE1MRWxlbWVudCwgUmVmbGVjdCwgT2JqZWN0fSA9IHdpbjtcbiAgLyoqXG4gICAqL1xuICBmdW5jdGlvbiBIVE1MRWxlbWVudFdyYXBwZXIoKSB7XG4gICAgY29uc3QgY3RvciA9IC8qKiBAdHlwZSB7ZnVuY3Rpb24oLi4uPyk6P3x1bmRlZmluZWR9ICovKFxuICAgICAgLyoqIEB0eXBlIHshSFRNTEVsZW1lbnR9ICovKHRoaXMpLmNvbnN0cnVjdG9yKTtcblxuICAgIC8vIFJlZmxlY3QuY29uc3RydWN0IGFsbG93cyB1cyB0byBjb25zdHJ1Y3QgYSBuZXcgSFRNTEVsZW1lbnQgd2l0aG91dCB1c2luZ1xuICAgIC8vIGBuZXdgICh3aGljaCB3aWxsIGFsd2F5cyBmYWlsIGJlY2F1c2UgbmF0aXZlIEhUTUxFbGVtZW50IGlzIGEgcmVzdHJpY3RlZFxuICAgIC8vIGNvbnN0cnVjdG9yKS5cbiAgICByZXR1cm4gUmVmbGVjdC5jb25zdHJ1Y3QoSFRNTEVsZW1lbnQsIFtdLCBjdG9yKTtcbiAgfVxuICBzdWJDbGFzcyhPYmplY3QsIEhUTUxFbGVtZW50LCBIVE1MRWxlbWVudFdyYXBwZXIpO1xuXG4gIC8vIEV4cG9zZSB0aGUgd3JhcHBlZCBIVE1MRWxlbWVudCBjb25zdHJ1Y3RvciBmb3IgZXZlcnlvbmUgdG8gZXh0ZW5kIGZyb20uXG4gIHdpbi5IVE1MRWxlbWVudCA9IEhUTUxFbGVtZW50V3JhcHBlcjtcbn1cblxuLyoqXG4gKiBTZXR1cHMgdXAgcHJvdG90eXBlIGluaGVyaXRhbmNlXG4gKlxuICogQHBhcmFtIHshT2JqZWN0fSBPYmplY3RcbiAqIEBwYXJhbSB7IUZ1bmN0aW9ufSBzdXBlckNsYXNzXG4gKiBAcGFyYW0geyFGdW5jdGlvbn0gc3ViQ2xhc3NcbiAqL1xuZnVuY3Rpb24gc3ViQ2xhc3MoT2JqZWN0LCBzdXBlckNsYXNzLCBzdWJDbGFzcykge1xuICAvLyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHN1cGVyQ2xhc3MucHJvdG90eXBlLCAnY29uc3RydWN0b3InKVxuICAvLyB7dmFsdWU6IMaSLCB3cml0YWJsZTogdHJ1ZSwgZW51bWVyYWJsZTogZmFsc2UsIGNvbmZpZ3VyYWJsZTogdHJ1ZX1cbiAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSwge1xuICAgIGNvbnN0cnVjdG9yOiB7XG4gICAgICAvLyBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IHN1YkNsYXNzLFxuICAgIH0sXG4gIH0pO1xufVxuXG4vKipcbiAqIFBvbHlmaWxscyBDdXN0b20gRWxlbWVudHMgdjEgQVBJLiBUaGlzIGhhcyA0IG1vZGVzOlxuICpcbiAqIDEuIEN1c3RvbSBlbGVtZW50cyB2MSBhbHJlYWR5IHN1cHBvcnRlZCwgdXNpbmcgbmF0aXZlIGNsYXNzZXNcbiAqIDIuIEN1c3RvbSBlbGVtZW50cyB2MSBhbHJlYWR5IHN1cHBvcnRlZCwgdXNpbmcgdHJhbnNwaWxlZCBjbGFzc2VzXG4gKiAzLiBDdXN0b20gZWxlbWVudHMgdjEgbm90IHN1cHBvcnRlZCwgdXNpbmcgbmF0aXZlIGNsYXNzZXNcbiAqIDQuIEN1c3RvbSBlbGVtZW50cyB2MSBub3Qgc3VwcG9ydGVkLCB1c2luZyB0cmFuc3BpbGVkIGNsYXNzZXNcbiAqXG4gKiBJbiBtb2RlIDEsIG5vdGhpbmcgaXMgZG9uZS4gSW4gbW9kZSAyLCBhIG1pbmltYWwgcG9seWZpbGwgaXMgdXNlZCB0byBzdXBwb3J0XG4gKiBleHRlbmRpbmcgdGhlIEhUTUxFbGVtZW50IGJhc2UgY2xhc3MuIEluIG1vZGUgMyBhbmQgNCwgYSBmdWxsIHBvbHlmaWxsIGlzXG4gKiBkb25lLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFGdW5jdGlvbn0gY3RvclxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4sIGN0b3IpIHtcbiAgaWYgKGlzUGF0Y2hlZCh3aW4pKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IGluc3RhbGwgPSB0cnVlO1xuICBsZXQgaW5zdGFsbFdyYXBwZXIgPSBmYWxzZTtcblxuICBpZiAoaGFzQ3VzdG9tRWxlbWVudHMod2luKSkge1xuICAgIC8vIElmIGN0b3IgaXMgY29uc3RydWN0YWJsZSB3aXRob3V0IG5ldywgaXQncyBhIGZ1bmN0aW9uLiBUaGF0IG1lYW5zIGl0IHdhc1xuICAgIC8vIGNvbXBpbGVkIGRvd24sIGFuZCB3ZSBuZWVkIHRvIGRvIHRoZSBtaW5pbWFsIHBvbHlmaWxsIGJlY2F1c2UgYWxsIHlvdVxuICAgIC8vIGNhbm5vdCBleHRlbmQgSFRNTEVsZW1lbnQgd2l0aG91dCBuYXRpdmUgY2xhc3Nlcy5cbiAgICB0cnkge1xuICAgICAgY29uc3Qge09iamVjdCwgUmVmbGVjdH0gPSB3aW47XG5cbiAgICAgIC8vIFwiQ29uc3RydWN0XCIgY3RvciB1c2luZyBFUzUgaWRpb21zXG4gICAgICBjb25zdCBpbnN0YW5jZSA9IE9iamVjdC5jcmVhdGUoY3Rvci5wcm90b3R5cGUpO1xuICAgICAgY3Rvci5jYWxsKGluc3RhbmNlKTtcblxuICAgICAgLy8gSWYgdGhhdCBzdWNjZWVkZWQsIHdlJ3JlIGluIGEgdHJhbnNwaWxlZCBlbnZpcm9ubWVudFxuICAgICAgLy8gTGV0J3MgZmluZCBvdXQgaWYgd2UgY2FuIHdyYXAgSFRNTEVsZW1lbnQgYW5kIGF2b2lkIGEgZnVsbCBwYXRjaC5cbiAgICAgIGluc3RhbGxXcmFwcGVyID0gISEoUmVmbGVjdCAmJiBSZWZsZWN0LmNvbnN0cnVjdCk7XG4gICAgfSBjYXRjaCAoZSkge1xuXG4gICAgICAvLyBUaGUgY3RvciB0aHJldyB3aGVuIHdlIGNvbnN0cnVjdGVkIGlzIHZpYSBFUzUsIHNvIGl0J3MgYSByZWFsIGNsYXNzLlxuICAgICAgLy8gV2UncmUgb2sgdG8gbm90IGluc3RhbGwgdGhlIHBvbHlmaWxsLlxuICAgICAgaW5zdGFsbCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGlmIChpbnN0YWxsV3JhcHBlcikge1xuICAgIHdyYXBIVE1MRWxlbWVudCh3aW4pO1xuICB9IGVsc2UgaWYgKGluc3RhbGwpIHtcbiAgICBwb2x5ZmlsbCh3aW4pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBgZG9jdW1lbnQuY29udGFpbnMoKWAgbWV0aG9kLiBOb3RpY2UgdGhhdCBhY2NvcmRpbmcgdG8gc3BlY1xuICogYGRvY3VtZW50LmNvbnRhaW5zYCBpcyBpbmNsdXNpb25hcnkuXG4gKiBTZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL05vZGUvY29udGFpbnNcbiAqIEBwYXJhbSB7P05vZGV9IG5vZGVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAdGhpcyB7Tm9kZX1cbiAqL1xuZnVuY3Rpb24gZG9jdW1lbnRDb250YWluc1BvbHlmaWxsKG5vZGUpIHtcbiAgLy8gUGVyIHNwZWMsIFwiY29udGFpbnNcIiBtZXRob2QgaXMgaW5jbHVzaW9uYXJ5XG4gIC8vIGkuZS4gYG5vZGUuY29udGFpbnMobm9kZSkgPT0gdHJ1ZWAuIEhvd2V2ZXIsIHdlIHN0aWxsIG5lZWQgdG8gdGVzdFxuICAvLyBlcXVhbGl0eSB0byB0aGUgZG9jdW1lbnQgaXRzZWxmLlxuICByZXR1cm4gbm9kZSA9PSB0aGlzIHx8IHRoaXMuZG9jdW1lbnRFbGVtZW50LmNvbnRhaW5zKG5vZGUpO1xufVxuXG5cbi8qKlxuICogUG9seWZpbGxzIGBIVE1MRG9jdW1lbnQuY29udGFpbnNgIEFQSS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnN0YWxsKHdpbikge1xuICAvLyBIVE1MRG9jdW1lbnQgaXMgdW5kZWZpbmVkIGluIEludGVybmV0IEV4cGxvcmVyIDEwLCBidXQgaXQgaGFzIERvY3VtZW50LFxuICAvLyBzbyB3ZSB1c2UgdGhhdCBhcyBhIGZhbGxiYWNrLlxuICBjb25zdCBkb2N1bWVudENsYXNzID0gd2luLkhUTUxEb2N1bWVudCB8fCB3aW4uRG9jdW1lbnQ7XG4gIGlmICghZG9jdW1lbnRDbGFzcy5wcm90b3R5cGUuY29udGFpbnMpIHtcbiAgICB3aW4uT2JqZWN0LmRlZmluZVByb3BlcnR5KGRvY3VtZW50Q2xhc3MucHJvdG90eXBlLCAnY29udGFpbnMnLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IGRvY3VtZW50Q29udGFpbnNQb2x5ZmlsbCxcbiAgICB9KTtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuLyoqXG4gKiBQb2x5ZmlsbCBmb3IgYERPTVRva2VuTGlzdC5wcm90b3R5cGUudG9nZ2xlKHRva2VuLCBvcHRfZm9yY2UpYCBtZXRob2QuIFRoaXNcbiAqIGlzIHNwZWNpYWxseSBpbXBvcnRhbnQgYmVjYXVzZSBJRSBkb2VzIG5vdCBzdXBwb3J0IGBvcHRfZm9yY2VgIGF0dHJpYnV0ZS4gU2VlXG4gKiBodHRwczovL2dvby5nbC9oZ0tOWVkgZm9yIGRldGFpbHMuXG4gKiBAcGFyYW0ge3N0cmluZ30gdG9rZW5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9mb3JjZVxuICogQHRoaXMge0RPTVRva2VuTGlzdH1cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGRvbVRva2VuTGlzdFRvZ2dsZVBvbHlmaWxsKHRva2VuLCBvcHRfZm9yY2UpIHtcbiAgY29uc3QgcmVtb3ZlID0gb3B0X2ZvcmNlID09PSB1bmRlZmluZWQgPyB0aGlzLmNvbnRhaW5zKHRva2VuKSA6ICFvcHRfZm9yY2U7XG4gIGlmIChyZW1vdmUpIHtcbiAgICB0aGlzLnJlbW92ZSh0b2tlbik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuYWRkKHRva2VuKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufVxuXG5cbi8qKlxuICogUG9seWZpbGxzIGBET01Ub2tlbkxpc3QucHJvdG90eXBlLnRvZ2dsZWAgQVBJIGluIElFLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIGlmIChpc0llKHdpbikgJiYgd2luLkRPTVRva2VuTGlzdCkge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkod2luLkRPTVRva2VuTGlzdC5wcm90b3R5cGUsICd0b2dnbGUnLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IGRvbVRva2VuTGlzdFRvZ2dsZVBvbHlmaWxsLFxuICAgIH0pO1xuICB9XG59XG5cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBjdXJyZW50IGJyb3dzZXIgaXMgYSBJRSBicm93c2VyLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzSWUod2luKSB7XG4gIHJldHVybiAvVHJpZGVudHxNU0lFfElFTW9iaWxlL2kudGVzdCh3aW4ubmF2aWdhdG9yLnVzZXJBZ2VudCk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBQYXJzZXMgdGhlIG51bWJlciB4IGFuZCByZXR1cm5zIGl0cyBzaWduLiBGb3IgcG9zaXRpdmUgeCByZXR1cm5zIDEsIGZvclxuICogbmVnYXRpdmUsIC0xLiBGb3IgMCBhbmQgLTAsIHJldHVybnMgMCBhbmQgLTAgcmVzcGVjdGl2ZWx5LiBGb3IgYW55IG51bWJlclxuICogdGhhdCBwYXJzZXMgdG8gTmFOLCByZXR1cm5zIE5hTi5cbiAqXG4gKiBAcGFyYW0ge251bWJlcn0geFxuICogQHJldHVybiB7bnVtYmVyfVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2lnbih4KSB7XG4gIHggPSBOdW1iZXIoeCk7XG5cbiAgLy8gSWYgeCBpcyAwLCAtMCwgb3IgTmFOLCByZXR1cm4gaXQuXG4gIGlmICgheCkge1xuICAgIHJldHVybiB4O1xuICB9XG5cbiAgcmV0dXJuIHggPiAwID8gMSA6IC0xO1xufVxuXG5cbi8qKlxuICogU2V0cyB0aGUgTWF0aC5zaWduIHBvbHlmaWxsIGlmIGl0IGRvZXMgbm90IGV4aXN0LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIGlmICghd2luLk1hdGguc2lnbikge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkod2luLk1hdGgsICdzaWduJywge1xuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgIHZhbHVlOiBzaWduLFxuICAgIH0pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuY29uc3Qge2hhc093blByb3BlcnR5fSA9IE9iamVjdC5wcm90b3R5cGU7XG5cbi8qKlxuICogQ29waWVzIHZhbHVlcyBvZiBhbGwgZW51bWVyYWJsZSBvd24gcHJvcGVydGllcyBmcm9tIG9uZSBvciBtb3JlIHNvdXJjZVxuICogb2JqZWN0cyAocHJvdmlkZWQgYXMgZXh0ZW5kZWQgYXJndW1lbnRzIHRvIHRoZSBmdW5jdGlvbikgdG8gYSB0YXJnZXQgb2JqZWN0LlxuICpcbiAqIEBwYXJhbSB7IU9iamVjdH0gdGFyZ2V0XG4gKiBAcGFyYW0gey4uLk9iamVjdH0gdmFyX2FyZ3NcbiAqIEByZXR1cm4geyFPYmplY3R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0LCB2YXJfYXJncykge1xuICBpZiAodGFyZ2V0ID09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29udmVydCB1bmRlZmluZWQgb3IgbnVsbCB0byBvYmplY3QnKTtcbiAgfVxuXG4gIGNvbnN0IG91dHB1dCA9IE9iamVjdCh0YXJnZXQpO1xuICBmb3IgKGxldCBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcbiAgICBpZiAoc291cmNlICE9IG51bGwpIHtcbiAgICAgIGZvciAoY29uc3Qga2V5IGluIHNvdXJjZSkge1xuICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHtcbiAgICAgICAgICBvdXRwdXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBvdXRwdXQ7XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBPYmplY3QuYXNzaWduIHBvbHlmaWxsIGlmIGl0IGRvZXMgbm90IGV4aXN0LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIGlmICghd2luLk9iamVjdC5hc3NpZ24pIHtcbiAgICB3aW4uT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbi5PYmplY3QsICdhc3NpZ24nLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IGFzc2lnbixcbiAgICB9KTtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuaW1wb3J0ICogYXMgUHJvbWlzZSBmcm9tICdwcm9taXNlLXBqcy9wcm9taXNlJztcblxuLyoqXG4gKiBTZXRzIHRoZSBQcm9taXNlIHBvbHlmaWxsIGlmIGl0IGRvZXMgbm90IGV4aXN0LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIGlmICghd2luLlByb21pc2UpIHtcbiAgICB3aW4uUHJvbWlzZSA9IC8qKiBAdHlwZSB7P30gKi8gKFByb21pc2UpO1xuICAgIC8vIEluIGJhYmVsIHRoZSAqIGV4cG9ydCBpcyBhbiBPYmplY3Qgd2l0aCBhIGRlZmF1bHQgcHJvcGVydHkuXG4gICAgLy8gSW4gY2xvc3VyZSBjb21waWxlciBpdCBpcyB0aGUgUHJvbWlzZSBmdW5jdGlvbiBpdHNlbGYuXG4gICAgaWYgKFByb21pc2UuZGVmYXVsdCkge1xuICAgICAgd2luLlByb21pc2UgPSBQcm9taXNlLmRlZmF1bHQ7XG4gICAgfVxuICAgIC8vIFdlIGNvcHkgdGhlIGluZGl2aWR1YWwgc3RhdGljIG1ldGhvZHMsIGJlY2F1c2UgY2xvc3VyZVxuICAgIC8vIGNvbXBpbGVyIGZsYXR0ZW5zIHRoZSBwb2x5ZmlsbCBuYW1lc3BhY2UuXG4gICAgd2luLlByb21pc2UucmVzb2x2ZSA9IFByb21pc2UucmVzb2x2ZTtcbiAgICB3aW4uUHJvbWlzZS5yZWplY3QgPSBQcm9taXNlLnJlamVjdDtcbiAgICB3aW4uUHJvbWlzZS5hbGwgPSBQcm9taXNlLmFsbDtcbiAgICB3aW4uUHJvbWlzZS5yYWNlID0gUHJvbWlzZS5yYWNlO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi9zZXJ2aWNlcyc7XG5pbXBvcnQge2Rldn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtnZXRTZXJ2aWNlUHJvbWlzZX0gZnJvbSAnLi9zZXJ2aWNlJztcblxuLyoqXG4gKiBBIG1hcCBvZiBzZXJ2aWNlcyB0aGF0IGRlbGF5IHJlbmRlcmluZy4gVGhlIGtleSBpcyB0aGUgbmFtZSBvZiB0aGUgc2VydmljZVxuICogYW5kIHRoZSB2YWx1ZSBpcyBhIERPTSBxdWVyeSB3aGljaCBpcyB1c2VkIHRvIGNoZWNrIGlmIHRoZSBzZXJ2aWNlIGlzIG5lZWRlZFxuICogaW4gdGhlIGN1cnJlbnQgZG9jdW1lbnQuXG4gKiBEbyBub3QgYWRkIGEgc2VydmljZSB1bmxlc3MgYWJzb2x1dGVseSBuZWNlc3NhcnkuXG4gKlxuICogXFwgICBcXCAgLyAgXFwgIC8gICAvIC8gICBcXCAgICAgfCAgIF8gIFxcICAgICB8ICBcXCB8ICB8IHwgIHwgfCAgXFwgfCAgfCAgLyBfX19fX3xcbiAqICBcXCAgIFxcLyAgICBcXC8gICAvIC8gIF4gIFxcICAgIHwgIHxfKSAgfCAgICB8ICAgXFx8ICB8IHwgIHwgfCAgIFxcfCAgfCB8ICB8ICBfX1xuICogICBcXCAgICAgICAgICAgIC8gLyAgL19cXCAgXFwgICB8ICAgICAgLyAgICAgfCAgLiBgICB8IHwgIHwgfCAgLiBgICB8IHwgIHwgfF8gfFxuICogICAgXFwgICAgL1xcICAgIC8gLyAgX19fX18gIFxcICB8ICB8XFwgIFxcLS0tLS58ICB8XFwgICB8IHwgIHwgfCAgfFxcICAgfCB8ICB8X198IHxcbiAqICAgICBcXF9fLyAgXFxfXy8gL19fLyAgICAgXFxfX1xcIHwgX3wgYC5fX19fX3x8X198IFxcX198IHxfX3wgfF9ffCBcXF9ffCAgXFxfX19fX198XG4gKlxuICogVGhlIGVxdWl2YWxlbnQgb2YgdGhpcyBsaXN0IGlzIHVzZWQgZm9yIHNlcnZlci1zaWRlIHJlbmRlcmluZyAoU1NSKSBhbmQgYW55XG4gKiBjaGFuZ2VzIG1hZGUgdG8gaXQgbXVzdCBiZSBtYWRlIGluIGNvb3JkaW5hdGlvbiB3aXRoIGNhY2hlcyB0aGF0IGltcGxlbWVudFxuICogU1NSLiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBvbiBTU1Igc2VlIGJpdC5seS9hbXAtc3NyLlxuICpcbiAqIEBjb25zdCB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59XG4gKi9cbmNvbnN0IFNFUlZJQ0VTID0ge1xuICAnYW1wLWR5bmFtaWMtY3NzLWNsYXNzZXMnOiAnW2N1c3RvbS1lbGVtZW50PWFtcC1keW5hbWljLWNzcy1jbGFzc2VzXScsXG4gICd2YXJpYW50JzogJ2FtcC1leHBlcmltZW50JyxcbiAgJ2FtcC1zdG9yeSc6ICdhbXAtc3Rvcnlbc3RhbmRhbG9uZV0nLFxufTtcblxuLyoqXG4gKiBNYXhpbXVtIG1pbGxpc2Vjb25kcyB0byB3YWl0IGZvciBhbGwgZXh0ZW5zaW9ucyB0byBsb2FkIGJlZm9yZSBlcnJvcmluZy5cbiAqIEBjb25zdFxuICovXG5jb25zdCBMT0FEX1RJTUVPVVQgPSAzMDAwO1xuXG4vKipcbiAqIERldGVjdHMgYW55IHJlbmRlciBkZWxheWluZyBzZXJ2aWNlcyB0aGF0IGFyZSByZXF1aXJlZCBvbiB0aGUgcGFnZSwgYW5kXG4gKiByZXR1cm5zIGEgcHJvbWlzZSB3aXRoIGEgdGltZW91dC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhQXJyYXk8Kj4+fSByZXNvbHZlcyB0byBhbiBBcnJheSB0aGF0IGhhcyB0aGUgc2FtZSBsZW5ndGhcbiAqICAgICBhcyB0aGUgZGV0ZWN0ZWQgcmVuZGVyIGRlbGF5aW5nIHNlcnZpY2VzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3YWl0Rm9yU2VydmljZXMod2luKSB7XG4gIGNvbnN0IHByb21pc2VzID0gaW5jbHVkZWRTZXJ2aWNlcyh3aW4pLm1hcChzZXJ2aWNlID0+IHtcbiAgICByZXR1cm4gU2VydmljZXMudGltZXJGb3Iod2luKS50aW1lb3V0UHJvbWlzZShcbiAgICAgICAgTE9BRF9USU1FT1VULFxuICAgICAgICBnZXRTZXJ2aWNlUHJvbWlzZSh3aW4sIHNlcnZpY2UpLFxuICAgICAgICBgUmVuZGVyIHRpbWVvdXQgd2FpdGluZyBmb3Igc2VydmljZSAke3NlcnZpY2V9IHRvIGJlIHJlYWR5LmBcbiAgICApO1xuICB9KTtcbiAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIHBhZ2UgaGFzIGEgcmVuZGVyIGRlbGF5aW5nIHNlcnZpY2UuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc1JlbmRlckRlbGF5aW5nU2VydmljZXMod2luKSB7XG4gIHJldHVybiBpbmNsdWRlZFNlcnZpY2VzKHdpbikubGVuZ3RoID4gMDtcbn1cblxuLyoqXG4gKiBEZXRlY3RzIHdoaWNoLCBpZiBhbnksIHJlbmRlci1kZWxheWluZyBleHRlbnNpb25zIGFyZSBpbmNsdWRlZCBvbiB0aGUgcGFnZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshQXJyYXk8c3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluY2x1ZGVkU2VydmljZXMod2luKSB7XG4gIC8qKiBAY29uc3QgeyFEb2N1bWVudH0gKi9cbiAgY29uc3QgZG9jID0gd2luLmRvY3VtZW50O1xuICBkZXYoKS5hc3NlcnQoZG9jLmJvZHkpO1xuXG4gIHJldHVybiBPYmplY3Qua2V5cyhTRVJWSUNFUykuZmlsdGVyKHNlcnZpY2UgPT4ge1xuICAgIHJldHVybiBkb2MucXVlcnlTZWxlY3RvcihTRVJWSUNFU1tzZXJ2aWNlXSk7XG4gIH0pO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQGZpbGVvdmVydmlldyBSZWdpc3RyYXRpb24gYW5kIGdldHRlciBmdW5jdGlvbnMgZm9yIEFNUCBzZXJ2aWNlcy5cbiAqXG4gKiBJbnZhcmlhbnQ6IFNlcnZpY2UgZ2V0dGVycyBuZXZlciByZXR1cm4gbnVsbCBmb3IgcmVnaXN0ZXJlZCBzZXJ2aWNlcy5cbiAqL1xuXG4vLyBzcmMvcG9seWZpbGxzLmpzIG11c3QgYmUgdGhlIGZpcnN0IGltcG9ydC5cbmltcG9ydCAnLi9wb2x5ZmlsbHMnOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHNvcnQtaW1wb3J0cy1lczYtYXV0b2ZpeC9zb3J0LWltcG9ydHMtZXM2XG5cbmltcG9ydCB7RGVmZXJyZWR9IGZyb20gJy4vdXRpbHMvcHJvbWlzZSc7XG5pbXBvcnQge2Rldn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHt0b1dpbn0gZnJvbSAnLi90eXBlcyc7XG5cblxuLyoqXG4gKiBIb2xkcyBpbmZvIGFib3V0IGEgc2VydmljZS5cbiAqIC0gb2JqOiBBY3R1YWwgc2VydmljZSBpbXBsZW1lbnRhdGlvbiB3aGVuIGF2YWlsYWJsZS5cbiAqIC0gcHJvbWlzZTogUHJvbWlzZSBmb3IgdGhlIG9iai5cbiAqIC0gcmVzb2x2ZTogRnVuY3Rpb24gdG8gcmVzb2x2ZSB0aGUgcHJvbWlzZSB3aXRoIHRoZSBvYmplY3QuXG4gKiAtIGNvbnRleHQ6IEFyZ3VtZW50IGZvciBjdG9yLCBlaXRoZXIgYSB3aW5kb3cgb3IgYW4gYW1wZG9jLlxuICogLSBjdG9yOiBGdW5jdGlvbiB0aGF0IGNvbnN0cnVjdHMgYW5kIHJldHVybnMgdGhlIHNlcnZpY2UuXG4gKiBAdHlwZWRlZiB7e1xuICogICBvYmo6ICg/T2JqZWN0KSxcbiAqICAgcHJvbWlzZTogKD9Qcm9taXNlKSxcbiAqICAgcmVzb2x2ZTogKD9mdW5jdGlvbighT2JqZWN0KSksXG4gKiAgIGNvbnRleHQ6ICg/V2luZG93fD8uL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jKSxcbiAqICAgY3RvcjogKD9mdW5jdGlvbihuZXc6T2JqZWN0LCAhV2luZG93KXxcbiAqICAgICAgICAgID9mdW5jdGlvbihuZXc6T2JqZWN0LCAhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvYykpLFxuICogfX1cbiAqL1xubGV0IFNlcnZpY2VIb2xkZXJEZWY7XG5cblxuLyoqXG4gKiBUaGlzIGludGVyZmFjZSBwcm92aWRlcyBhIGBkaXNwb3NlYCBtZXRob2QgdGhhdCB3aWxsIGJlIGNhbGxlZCBieVxuICogcnVudGltZSB3aGVuIGEgc2VydmljZSBuZWVkcyB0byBiZSBkaXNwb3NlZCBvZi5cbiAqIEBpbnRlcmZhY2VcbiAqL1xuZXhwb3J0IGNsYXNzIERpc3Bvc2FibGUge1xuXG4gIC8qKlxuICAgKiBJbnN0cnVjdHMgdGhlIHNlcnZpY2UgdG8gcmVsZWFzZSBhbnkgcmVzb3VyY2VzIGl0IG1pZ2h0IGJlIGhvbGRpbmcuIENhblxuICAgKiBiZSBjYWxsZWQgb25seSBvbmNlIGluIHRoZSBsaWZlY3ljbGUgb2YgYSBzZXJ2aWNlLlxuICAgKi9cbiAgZGlzcG9zZSgpIHt9XG59XG5cblxuLyoqXG4gKiBUaGlzIGludGVyZmFjZSBwcm92aWRlcyBhIGBhZG9wdEVtYmVkV2luZG93YCBtZXRob2QgdGhhdCB3aWxsIGJlIGNhbGxlZCBieVxuICogcnVudGltZSBmb3IgYSBuZXcgZW1iZWQgd2luZG93LlxuICogQGludGVyZmFjZVxuICovXG5leHBvcnQgY2xhc3MgRW1iZWRkYWJsZVNlcnZpY2Uge1xuXG4gIC8qKlxuICAgKiBJbnN0cnVjdHMgdGhlIHNlcnZpY2UgdG8gYWRvcHQgdGhlIGVtYmVkIHdpbmRvdyBhbmQgYWRkIGFueSBuZWNlc3NhcnlcbiAgICogbGlzdGVuZXJzIGFuZCByZXNvdXJjZXMuXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gdW51c2VkRW1iZWRXaW5cbiAgICovXG4gIGFkb3B0RW1iZWRXaW5kb3codW51c2VkRW1iZWRXaW4pIHt9XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VydmljZSB3aXRoIHRoZSBnaXZlbiBpZC4gQXNzdW1lcyB0aGF0IGl0IGhhcyBiZWVuIHJlZ2lzdGVyZWRcbiAqIGFscmVhZHkuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZmFsbGJhY2tUb1RvcFdpblxuICogQHJldHVybiB7T2JqZWN0fSBUaGUgc2VydmljZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4aXN0aW5nU2VydmljZUluRW1iZWRTY29wZSh3aW4sIGlkLCBvcHRfZmFsbGJhY2tUb1RvcFdpbikge1xuICAvLyBGaXJzdCwgdHJ5IHRvIHJlc29sdmUgdmlhIGxvY2FsIChlbWJlZCkgd2luZG93LlxuICBjb25zdCBsb2NhbCA9IGdldExvY2FsRXhpc3RpbmdTZXJ2aWNlRm9yRW1iZWRXaW5Pck51bGwod2luLCBpZCk7XG4gIGlmIChsb2NhbCkge1xuICAgIHJldHVybiBsb2NhbDtcbiAgfVxuICBpZiAob3B0X2ZhbGxiYWNrVG9Ub3BXaW4pIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZSh3aW4sIGlkKTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VydmljZSB3aXRoIHRoZSBnaXZlbiBpZC4gQXNzdW1lcyB0aGF0IGl0IGhhcyBiZWVuIGNvbnN0cnVjdGVkXG4gKiBhbHJlYWR5LlxuICpcbiAqIFVubGlrZSBtb3N0IHNlcnZpY2UgZ2V0dGVycywgcGFzc2luZyBgTm9kZWAgaXMgbmVjZXNzYXJ5IGZvciBzb21lIEZJRS1zY29wZVxuICogc2VydmljZXMgc2luY2Ugc29tZXRpbWVzIHdlIG9ubHkgaGF2ZSB0aGUgRklFIERvY3VtZW50IGZvciBjb250ZXh0LlxuICpcbiAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZmFsbGJhY2tUb1RvcFdpblxuICogQHJldHVybiB7T2JqZWN0fSBUaGUgc2VydmljZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4aXN0aW5nU2VydmljZUZvckRvY0luRW1iZWRTY29wZShcbiAgbm9kZU9yRG9jLCBpZCwgb3B0X2ZhbGxiYWNrVG9Ub3BXaW4pIHtcbiAgLy8gRmlyc3QsIHRyeSB0byByZXNvbHZlIHZpYSBsb2NhbCAoZW1iZWQpIHdpbmRvdy5cbiAgaWYgKG5vZGVPckRvYy5ub2RlVHlwZSkge1xuICAgIC8vIElmIGEgbm9kZSBpcyBwYXNzZWQsIHRyeSB0byByZXNvbHZlIHZpYSB0aGlzIG5vZGUuXG4gICAgY29uc3Qgd2luID0gdG9XaW4oLyoqIEB0eXBlIHshRG9jdW1lbnR9ICovIChcbiAgICAgIG5vZGVPckRvYy5vd25lckRvY3VtZW50IHx8IG5vZGVPckRvYykuZGVmYXVsdFZpZXcpO1xuICAgIGNvbnN0IGxvY2FsID0gZ2V0TG9jYWxFeGlzdGluZ1NlcnZpY2VGb3JFbWJlZFdpbk9yTnVsbCh3aW4sIGlkKTtcbiAgICBpZiAobG9jYWwpIHtcbiAgICAgIHJldHVybiBsb2NhbDtcbiAgICB9XG4gIH1cbiAgLy8gSWYgYW4gYW1wZG9jIGlzIHBhc3NlZCBvciBmYWxsYmFjayBpcyBhbGxvd2VkLCBjb250aW51ZSByZXNvbHZpbmcuXG4gIGlmICghbm9kZU9yRG9jLm5vZGVUeXBlIHx8IG9wdF9mYWxsYmFja1RvVG9wV2luKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKG5vZGVPckRvYywgaWQpO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIEluc3RhbGxzIGEgc2VydmljZSBvdmVycmlkZSBvbiBhbXAtZG9jIGxldmVsLlxuICogQHBhcmFtIHshV2luZG93fSBlbWJlZFdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcGFyYW0geyFPYmplY3R9IHNlcnZpY2UgVGhlIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnN0YWxsU2VydmljZUluRW1iZWRTY29wZShlbWJlZFdpbiwgaWQsIHNlcnZpY2UpIHtcbiAgY29uc3QgdG9wV2luID0gZ2V0VG9wV2luZG93KGVtYmVkV2luKTtcbiAgZGV2KCkuYXNzZXJ0KGVtYmVkV2luICE9IHRvcFdpbixcbiAgICAgICdTZXJ2aWNlIG92ZXJyaWRlIGNhbiBvbmx5IGJlIGluc3RhbGxlZCBpbiBlbWJlZCB3aW5kb3c6ICVzJywgaWQpO1xuICBkZXYoKS5hc3NlcnQoIWdldExvY2FsRXhpc3RpbmdTZXJ2aWNlRm9yRW1iZWRXaW5Pck51bGwoZW1iZWRXaW4sIGlkKSxcbiAgICAgICdTZXJ2aWNlIG92ZXJyaWRlIGhhcyBhbHJlYWR5IGJlZW4gaW5zdGFsbGVkOiAlcycsIGlkKTtcbiAgcmVnaXN0ZXJTZXJ2aWNlSW50ZXJuYWwoZW1iZWRXaW4sIGVtYmVkV2luLCBpZCwgKCkgPT4gc2VydmljZSk7XG4gIGdldFNlcnZpY2VJbnRlcm5hbChlbWJlZFdpbiwgaWQpOyAvLyBGb3JjZSBzZXJ2aWNlIHRvIGJ1aWxkLlxufVxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gZW1iZWRXaW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybiB7P09iamVjdH1cbiAqL1xuZnVuY3Rpb24gZ2V0TG9jYWxFeGlzdGluZ1NlcnZpY2VGb3JFbWJlZFdpbk9yTnVsbChlbWJlZFdpbiwgaWQpIHtcbiAgLy8gTm90ZSB0aGF0IHRoaXMgbWV0aG9kIGN1cnJlbnRseSBvbmx5IHJlc29sdmVzIGFnYWluc3QgdGhlIGdpdmVuIHdpbmRvdy5cbiAgLy8gSXQgZG9lcyBub3QgdHJ5IHRvIGdvIGFsbCB0aGUgd2F5IHVwIHRoZSBwYXJlbnQgd2luZG93IGNoYWluLiBXZSBjYW4gY2hhbmdlXG4gIC8vIHRoaXMgaW4gdGhlIGZ1dHVyZSwgYnV0IGZvciBub3cgdGhpcyBnaXZlcyB1cyBhIGJldHRlciBwZXJmb3JtYW5jZS5cbiAgY29uc3QgdG9wV2luID0gZ2V0VG9wV2luZG93KGVtYmVkV2luKTtcbiAgaWYgKGVtYmVkV2luICE9IHRvcFdpbiAmJiBpc1NlcnZpY2VSZWdpc3RlcmVkKGVtYmVkV2luLCBpZCkpIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZUludGVybmFsKGVtYmVkV2luLCBpZCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLyoqXG4gKiBSZWdpc3RlcnMgYSBzZXJ2aWNlIGdpdmVuIGEgY2xhc3MgdG8gYmUgdXNlZCBhcyBpbXBsZW1lbnRhdGlvbi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKG5ldzpPYmplY3QsICFXaW5kb3cpfSBjb25zdHJ1Y3RvclxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2luc3RhbnRpYXRlIFdoZXRoZXIgdG8gaW1tZWRpYXRlbHkgY3JlYXRlIHRoZSBzZXJ2aWNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlclNlcnZpY2VCdWlsZGVyKHdpbixcbiAgaWQsXG4gIGNvbnN0cnVjdG9yLFxuICBvcHRfaW5zdGFudGlhdGUpIHtcbiAgd2luID0gZ2V0VG9wV2luZG93KHdpbik7XG4gIHJlZ2lzdGVyU2VydmljZUludGVybmFsKHdpbiwgd2luLCBpZCwgY29uc3RydWN0b3IpO1xuICBpZiAob3B0X2luc3RhbnRpYXRlKSB7XG4gICAgZ2V0U2VydmljZUludGVybmFsKHdpbiwgaWQpO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VydmljZSBhbmQgcmVnaXN0ZXJzIGl0IGdpdmVuIGEgY2xhc3MgdG8gYmUgdXNlZCBhc1xuICogaW1wbGVtZW50YXRpb24uXG4gKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24obmV3Ok9iamVjdCwgIS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2MpfSBjb25zdHJ1Y3RvclxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2luc3RhbnRpYXRlIFdoZXRoZXIgdG8gaW1tZWRpYXRlbHkgY3JlYXRlIHRoZSBzZXJ2aWNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlclNlcnZpY2VCdWlsZGVyRm9yRG9jKG5vZGVPckRvYyxcbiAgaWQsXG4gIGNvbnN0cnVjdG9yLFxuICBvcHRfaW5zdGFudGlhdGUpIHtcbiAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKG5vZGVPckRvYyk7XG4gIGNvbnN0IGhvbGRlciA9IGdldEFtcGRvY1NlcnZpY2VIb2xkZXIoYW1wZG9jKTtcbiAgcmVnaXN0ZXJTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBhbXBkb2MsIGlkLCBjb25zdHJ1Y3Rvcik7XG4gIGlmIChvcHRfaW5zdGFudGlhdGUpIHtcbiAgICBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIHdpbmRvdyAoYSBwZXItd2luZG93IHNpbmdsZXRvbikuIFVzZXJzXG4gKiBzaG91bGQgdHlwaWNhbGx5IHdyYXAgdGhpcyBhcyBhIHNwZWNpYWwgcHVycG9zZSBmdW5jdGlvbiAoZS5nLlxuICogYFNlcnZpY2VzLnZzeW5jRm9yKHdpbilgKSBmb3IgdHlwZSBzYWZldHkgYW5kIGJlY2F1c2UgdGhlIGZhY3Rvcnkgc2hvdWxkIG5vdFxuICogYmUgcGFzc2VkIGFyb3VuZC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAdGVtcGxhdGUgVFxuICogQHJldHVybiB7VH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNlcnZpY2Uod2luLCBpZCkge1xuICB3aW4gPSBnZXRUb3BXaW5kb3cod2luKTtcbiAgcmV0dXJuIGdldFNlcnZpY2VJbnRlcm5hbCh3aW4sIGlkKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIGZvciBhIHNlcnZpY2UgZm9yIHRoZSBnaXZlbiBpZCBhbmQgd2luZG93LiBBbHNvIGV4cGVjdHMgYW5cbiAqIGVsZW1lbnQgdGhhdCBoYXMgdGhlIGFjdHVhbCBpbXBsZW1lbnRhdGlvbi4gVGhlIHByb21pc2UgcmVzb2x2ZXMgd2hlbiB0aGVcbiAqIGltcGxlbWVudGF0aW9uIGxvYWRlZC4gVXNlcnMgc2hvdWxkIHR5cGljYWxseSB3cmFwIHRoaXMgYXMgYSBzcGVjaWFsIHB1cnBvc2VcbiAqIGZ1bmN0aW9uIChlLmcuIGBTZXJ2aWNlcy52c3luY0Zvcih3aW4pYCkgZm9yIHR5cGUgc2FmZXR5IGFuZCBiZWNhdXNlIHRoZVxuICogZmFjdG9yeSBzaG91bGQgbm90IGJlIHBhc3NlZCBhcm91bmQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHJldHVybiB7IVByb21pc2U8IU9iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlUHJvbWlzZSh3aW4sIGlkKSB7XG4gIHJldHVybiBnZXRTZXJ2aWNlUHJvbWlzZUludGVybmFsKHdpbiwgaWQpO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2Ugb3IgbnVsbCB3aXRoIHRoZSBnaXZlbiBpZC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4gez9PYmplY3R9IFRoZSBzZXJ2aWNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXhpc3RpbmdTZXJ2aWNlT3JOdWxsKHdpbiwgaWQpIHtcbiAgd2luID0gZ2V0VG9wV2luZG93KHdpbik7XG4gIGlmIChpc1NlcnZpY2VSZWdpc3RlcmVkKHdpbiwgaWQpKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2VJbnRlcm5hbCh3aW4sIGlkKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5cbi8qKlxuICogTGlrZSBnZXRTZXJ2aWNlUHJvbWlzZSBidXQgcmV0dXJucyBudWxsIGlmIHRoZSBzZXJ2aWNlIHdhcyBuZXZlciByZWdpc3RlcmVkLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybiB7P1Byb21pc2U8IU9iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkKSB7XG4gIHJldHVybiBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEludGVybmFsKHdpbiwgaWQpO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2UgZm9yIHRoZSBnaXZlbiBpZCBhbmQgYW1wZG9jIChhIHBlci1hbXBkb2Mgc2luZ2xldG9uKS5cbiAqIEV4cGVjdHMgc2VydmljZSBgaWRgIHRvIGJlIHJlZ2lzdGVyZWQuXG4gKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybiB7VH1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpIHtcbiAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKGVsZW1lbnRPckFtcERvYyk7XG4gIGNvbnN0IGhvbGRlciA9IGdldEFtcGRvY1NlcnZpY2VIb2xkZXIoYW1wZG9jKTtcbiAgcmV0dXJuIGdldFNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGlkKTtcbn1cblxuXG4vKipcbiAqIHRsO2RyIC0tIFVzZSBnZXRTZXJ2aWNlRm9yRG9jKCkgaW5zdGVhZCBvZiB0aGlzLlxuICpcbiAqIFByaXZpbGVnZWQgdmFyaWFudCBvZiBnZXRTZXJ2aWNlRm9yRG9jKCkgdGhhdCBhY2NlcHRzIG5vbi1lbGVtZW50IHBhcmFtcyxcbiAqIGUuZy4gd2luZG93LmRvY3VtZW50LiBUaGlzIGlzIGN1cnJlbnRseSBuZWNlc3NhcnkgZm9yIGRvYy1sZXZlbCBzZXJ2aWNlc1xuICogdXNlZCBpbiBzdGFydHVwLCBlLmcuIENodW5rcy4gRXZlbnR1YWxseSB3ZSB3YW50IHRvIHJlbW92ZSB0aGlzIGZ1bmN0aW9uXG4gKiBhbmQgaGF2ZSBjYWxsZXJzIGZpbmQgdGhlIGFwcHJvcHJpYXRlIEFtcERvYyBhbmQgdXNlIGdldFNlcnZpY2VGb3JEb2MoKS5cbiAqXG4gKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybiB7VH1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZChub2RlT3JEb2MsIGlkKSB7XG4gIGNvbnN0IGFtcGRvYyA9IGdldEFtcGRvYyhub2RlT3JEb2MpO1xuICBjb25zdCBob2xkZXIgPSBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGFtcGRvYyk7XG4gIHJldHVybiBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCk7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIGFtcGRvYy4gQWxzbyBleHBlY3RzXG4gKiBhIHNlcnZpY2UgdGhhdCBoYXMgdGhlIGFjdHVhbCBpbXBsZW1lbnRhdGlvbi4gVGhlIHByb21pc2UgcmVzb2x2ZXMgd2hlblxuICogdGhlIGltcGxlbWVudGF0aW9uIGxvYWRlZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhT2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpIHtcbiAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlSW50ZXJuYWwoXG4gICAgICBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGVsZW1lbnRPckFtcERvYyksIGlkKTtcbn1cblxuXG4vKipcbiAqIExpa2UgZ2V0U2VydmljZVByb21pc2VGb3JEb2MgYnV0IHJldHVybnMgbnVsbCBpZiB0aGUgc2VydmljZSB3YXMgbmV2ZXJcbiAqIHJlZ2lzdGVyZWQgZm9yIHRoaXMgYW1wZG9jLlxuICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4gez9Qcm9taXNlPCFPYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2VPck51bGxGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCkge1xuICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VPck51bGxJbnRlcm5hbChcbiAgICAgIGdldEFtcGRvY1NlcnZpY2VIb2xkZXIoZWxlbWVudE9yQW1wRG9jKSwgaWQpO1xufVxuXG4vKipcbiAqIFNldCB0aGUgcGFyZW50IGFuZCB0b3Agd2luZG93cyBvbiBhIGNoaWxkIHdpbmRvdyAoZnJpZW5kbHkgaWZyYW1lKS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFXaW5kb3d9IHBhcmVudFdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0UGFyZW50V2luZG93KHdpbiwgcGFyZW50V2luKSB7XG4gIHdpbi5fX0FNUF9QQVJFTlQgPSBwYXJlbnRXaW47XG4gIHdpbi5fX0FNUF9UT1AgPSBnZXRUb3BXaW5kb3cocGFyZW50V2luKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIHBhcmVudCB3aW5kb3cgZm9yIGEgY2hpbGQgd2luZG93IChmcmllbmRseSBpZnJhbWUpLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFXaW5kb3d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYXJlbnRXaW5kb3cod2luKSB7XG4gIHJldHVybiB3aW4uX19BTVBfUEFSRU5UIHx8IHdpbjtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIHRvcCB3aW5kb3cgd2hlcmUgQU1QIFJ1bnRpbWUgaXMgaW5zdGFsbGVkIGZvciBhIGNoaWxkIHdpbmRvd1xuICogKGZyaWVuZGx5IGlmcmFtZSkuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IVdpbmRvd31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRvcFdpbmRvdyh3aW4pIHtcbiAgcmV0dXJuIHdpbi5fX0FNUF9UT1AgfHwgd2luO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyB0aGUgcGFyZW50IFwiZnJpZW5kbHlcIiBpZnJhbWUgaWYgdGhlIG5vZGUgYmVsb25ncyB0byBhIGNoaWxkIHdpbmRvdy5cbiAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAqIEBwYXJhbSB7IVdpbmRvd30gdG9wV2luXG4gKiBAcmV0dXJuIHs/SFRNTElGcmFtZUVsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYXJlbnRXaW5kb3dGcmFtZUVsZW1lbnQobm9kZSwgdG9wV2luKSB7XG4gIGNvbnN0IGNoaWxkV2luID0gKG5vZGUub3duZXJEb2N1bWVudCB8fCBub2RlKS5kZWZhdWx0VmlldztcbiAgaWYgKGNoaWxkV2luICYmIGNoaWxkV2luICE9IHRvcFdpbiAmJiBnZXRUb3BXaW5kb3coY2hpbGRXaW4pID09IHRvcFdpbikge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gLyoqIEB0eXBlIHs/SFRNTElGcmFtZUVsZW1lbnR9ICovIChjaGlsZFdpbi5mcmFtZUVsZW1lbnQpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIElnbm9yZSB0aGUgZXJyb3IuXG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFtcGRvYyhub2RlT3JEb2MpIHtcbiAgaWYgKG5vZGVPckRvYy5ub2RlVHlwZSkge1xuICAgIGNvbnN0IHdpbiA9IHRvV2luKC8qKiBAdHlwZSB7IURvY3VtZW50fSAqLyAoXG4gICAgICBub2RlT3JEb2Mub3duZXJEb2N1bWVudCB8fCBub2RlT3JEb2MpLmRlZmF1bHRWaWV3KTtcbiAgICByZXR1cm4gZ2V0QW1wZG9jU2VydmljZSh3aW4pLmdldEFtcERvYygvKiogQHR5cGUgeyFOb2RlfSAqLyAobm9kZU9yRG9jKSk7XG4gIH1cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9ICovIChub2RlT3JEb2MpO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY3whV2luZG93fVxuICovXG5mdW5jdGlvbiBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKG5vZGVPckRvYykge1xuICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2Mobm9kZU9yRG9jKTtcbiAgcmV0dXJuIGFtcGRvYy5pc1NpbmdsZURvYygpID8gYW1wZG9jLndpbiA6IGFtcGRvYztcbn1cblxuXG4vKipcbiAqIFRoaXMgaXMgZXNzZW50aWFsbHkgYSBkdXBsaWNhdGUgb2YgYGFtcGRvYy5qc2AsIGJ1dCBuZWNlc3NhcnkgdG8gYXZvaWRcbiAqIGNpcmN1bGFyIGRlcGVuZGVuY2llcy5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY1NlcnZpY2V9XG4gKi9cbmZ1bmN0aW9uIGdldEFtcGRvY1NlcnZpY2Uod2luKSB7XG4gIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jU2VydmljZX0gKi8gKFxuICAgIGdldFNlcnZpY2Uod2luLCAnYW1wZG9jJykpO1xufVxuXG5cbi8qKlxuICogR2V0IHNlcnZpY2UgYGlkYCBmcm9tIGBob2xkZXJgLiBBc3N1bWVzIHRoZSBzZXJ2aWNlXG4gKiBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQuXG4gKiBAcGFyYW0geyFPYmplY3R9IGhvbGRlciBPYmplY3QgaG9sZGluZyB0aGUgc2VydmljZSBpbnN0YW5jZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEByZXR1cm4ge09iamVjdH1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmZ1bmN0aW9uIGdldFNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGlkKSB7XG4gIGRldigpLmFzc2VydChpc1NlcnZpY2VSZWdpc3RlcmVkKGhvbGRlciwgaWQpLFxuICAgICAgYEV4cGVjdGVkIHNlcnZpY2UgJHtpZH0gdG8gYmUgcmVnaXN0ZXJlZGApO1xuICBjb25zdCBzZXJ2aWNlcyA9IGdldFNlcnZpY2VzKGhvbGRlcik7XG4gIGNvbnN0IHMgPSBzZXJ2aWNlc1tpZF07XG4gIGlmICghcy5vYmopIHtcbiAgICBkZXYoKS5hc3NlcnQocy5jdG9yLCBgU2VydmljZSAke2lkfSByZWdpc3RlcmVkIHdpdGhvdXQgY3RvciBub3IgaW1wbC5gKTtcbiAgICBkZXYoKS5hc3NlcnQocy5jb250ZXh0LCBgU2VydmljZSAke2lkfSByZWdpc3RlcmVkIHdpdGhvdXQgY29udGV4dC5gKTtcbiAgICBzLm9iaiA9IG5ldyBzLmN0b3Iocy5jb250ZXh0KTtcbiAgICBkZXYoKS5hc3NlcnQocy5vYmosIGBTZXJ2aWNlICR7aWR9IGNvbnN0cnVjdGVkIHRvIG51bGwuYCk7XG4gICAgcy5jdG9yID0gbnVsbDtcbiAgICBzLmNvbnRleHQgPSBudWxsO1xuICAgIC8vIFRoZSBzZXJ2aWNlIG1heSBoYXZlIGJlZW4gcmVxdWVzdGVkIGFscmVhZHksIGluIHdoaWNoIGNhc2Ugd2UgaGF2ZSBhXG4gICAgLy8gcGVuZGluZyBwcm9taXNlIHdlIG5lZWQgdG8gZnVsZmlsbC5cbiAgICBpZiAocy5yZXNvbHZlKSB7XG4gICAgICBzLnJlc29sdmUocy5vYmopO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcy5vYmo7XG59XG5cbi8qKlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXIgT2JqZWN0IGhvbGRpbmcgdGhlIHNlcnZpY2UgaW5zdGFuY2UuXG4gKiBAcGFyYW0geyFXaW5kb3d8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGNvbnRleHQgV2luIG9yIEFtcERvYy5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7P2Z1bmN0aW9uKG5ldzpPYmplY3QsICFXaW5kb3cpfD9mdW5jdGlvbihuZXc6T2JqZWN0LCAhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvYyl9IGN0b3IgQ29uc3RydWN0b3IgZnVuY3Rpb24gdG8gbmV3IHRoZSBzZXJ2aWNlLiBDYWxsZWQgd2l0aCBjb250ZXh0LlxuICovXG5mdW5jdGlvbiByZWdpc3RlclNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGNvbnRleHQsIGlkLCBjdG9yKSB7XG4gIGNvbnN0IHNlcnZpY2VzID0gZ2V0U2VydmljZXMoaG9sZGVyKTtcbiAgbGV0IHMgPSBzZXJ2aWNlc1tpZF07XG5cbiAgaWYgKCFzKSB7XG4gICAgcyA9IHNlcnZpY2VzW2lkXSA9IHtcbiAgICAgIG9iajogbnVsbCxcbiAgICAgIHByb21pc2U6IG51bGwsXG4gICAgICByZXNvbHZlOiBudWxsLFxuICAgICAgY29udGV4dDogbnVsbCxcbiAgICAgIGN0b3I6IG51bGwsXG4gICAgfTtcbiAgfVxuXG4gIGlmIChzLmN0b3IgfHwgcy5vYmopIHtcbiAgICAvLyBTZXJ2aWNlIGFscmVhZHkgcmVnaXN0ZXJlZC5cbiAgICByZXR1cm47XG4gIH1cblxuICBzLmN0b3IgPSBjdG9yO1xuICBzLmNvbnRleHQgPSBjb250ZXh0O1xuXG4gIC8vIFRoZSBzZXJ2aWNlIG1heSBoYXZlIGJlZW4gcmVxdWVzdGVkIGFscmVhZHksIGluIHdoaWNoIGNhc2UgdGhlcmUgaXMgYVxuICAvLyBwZW5kaW5nIHByb21pc2UgdGhhdCBuZWVkcyB0byBmdWxmaWxsZWQuXG4gIGlmIChzLnJlc29sdmUpIHtcbiAgICAvLyBnZXRTZXJ2aWNlSW50ZXJuYWwgd2lsbCByZXNvbHZlIHRoZSBwcm9taXNlLlxuICAgIGdldFNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGlkKTtcbiAgfVxufVxuXG4vKipcbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhT2JqZWN0Pn1cbiAqL1xuZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2VJbnRlcm5hbChob2xkZXIsIGlkKSB7XG4gIGNvbnN0IGNhY2hlZCA9IGdldFNlcnZpY2VQcm9taXNlT3JOdWxsSW50ZXJuYWwoaG9sZGVyLCBpZCk7XG4gIGlmIChjYWNoZWQpIHtcbiAgICByZXR1cm4gY2FjaGVkO1xuICB9XG4gIC8vIFNlcnZpY2UgaXMgbm90IHJlZ2lzdGVyZWQuXG5cbiAgLy8gVE9ETyhAY3JhbWZvcmNlKTogQWRkIGEgY2hlY2sgdGhhdCBpZiB0aGUgZWxlbWVudCBpcyBldmVudHVhbGx5IHJlZ2lzdGVyZWRcbiAgLy8gdGhhdCB0aGUgc2VydmljZSBpcyBhY3R1YWxseSBwcm92aWRlZCBhbmQgdGhpcyBwcm9taXNlIHJlc29sdmVzLlxuICBjb25zdCBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICBjb25zdCB7cHJvbWlzZSwgcmVzb2x2ZX0gPSBkZWZlcnJlZDtcblxuICBjb25zdCBzZXJ2aWNlcyA9IGdldFNlcnZpY2VzKGhvbGRlcik7XG4gIHNlcnZpY2VzW2lkXSA9IHtcbiAgICBvYmo6IG51bGwsXG4gICAgcHJvbWlzZSxcbiAgICByZXNvbHZlLFxuICAgIGNvbnRleHQ6IG51bGwsXG4gICAgY3RvcjogbnVsbCxcbiAgfTtcbiAgcmV0dXJuIHByb21pc2U7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3Igc2VydmljZSBgaWRgIGlmIHRoZSBzZXJ2aWNlIGhhcyBiZWVuIHJlZ2lzdGVyZWRcbiAqIG9uIGBob2xkZXJgLlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEByZXR1cm4gez9Qcm9taXNlPCFPYmplY3Q+fVxuICovXG5mdW5jdGlvbiBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEludGVybmFsKGhvbGRlciwgaWQpIHtcbiAgY29uc3Qgc2VydmljZXMgPSBnZXRTZXJ2aWNlcyhob2xkZXIpO1xuICBjb25zdCBzID0gc2VydmljZXNbaWRdO1xuICBpZiAocykge1xuICAgIGlmIChzLnByb21pc2UpIHtcbiAgICAgIHJldHVybiBzLnByb21pc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEluc3RhbnRpYXRlIHNlcnZpY2UgaWYgbm90IGFscmVhZHkgaW5zdGFudGlhdGVkLlxuICAgICAgZ2V0U2VydmljZUludGVybmFsKGhvbGRlciwgaWQpO1xuICAgICAgcmV0dXJuIHMucHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgvKiogQHR5cGUgeyFPYmplY3R9ICovIChzLm9iaikpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIG9iamVjdCB0aGF0IGhvbGRzIHRoZSBzZXJ2aWNlcyByZWdpc3RlcmVkIGluIGEgaG9sZGVyLlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXJcbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCFTZXJ2aWNlSG9sZGVyRGVmPn1cbiAqL1xuZnVuY3Rpb24gZ2V0U2VydmljZXMoaG9sZGVyKSB7XG4gIGxldCB7c2VydmljZXN9ID0gaG9sZGVyO1xuICBpZiAoIXNlcnZpY2VzKSB7XG4gICAgc2VydmljZXMgPSBob2xkZXIuc2VydmljZXMgPSB7fTtcbiAgfVxuICByZXR1cm4gc2VydmljZXM7XG59XG5cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBzcGVjaWZpZWQgc2VydmljZSBpbXBsZW1lbnRzIGBEaXNwb3NhYmxlYCBpbnRlcmZhY2UuXG4gKiBAcGFyYW0geyFPYmplY3R9IHNlcnZpY2VcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Rpc3Bvc2FibGUoc2VydmljZSkge1xuICByZXR1cm4gdHlwZW9mIHNlcnZpY2UuZGlzcG9zZSA9PSAnZnVuY3Rpb24nO1xufVxuXG5cbi8qKlxuICogQXNzZXJ0cyB0aGF0IHRoZSBzcGVjaWZpZWQgc2VydmljZSBpbXBsZW1lbnRzIGBEaXNwb3NhYmxlYCBpbnRlcmZhY2UgYW5kXG4gKiB0eXBlY2FzdHMgdGhlIGluc3RhbmNlIHRvIGBEaXNwb3NhYmxlYC5cbiAqIEBwYXJhbSB7IU9iamVjdH0gc2VydmljZVxuICogQHJldHVybiB7IURpc3Bvc2FibGV9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnREaXNwb3NhYmxlKHNlcnZpY2UpIHtcbiAgZGV2KCkuYXNzZXJ0KGlzRGlzcG9zYWJsZShzZXJ2aWNlKSwgJ3JlcXVpcmVkIHRvIGltcGxlbWVudCBEaXNwb3NhYmxlJyk7XG4gIHJldHVybiAvKiogQHR5cGUgeyFEaXNwb3NhYmxlfSAqLyAoc2VydmljZSk7XG59XG5cblxuLyoqXG4gKiBEaXNwb3NlcyBhbGwgZGlzcG9zYWJsZSAoaW1wbGVtZW50cyBgRGlzcG9zYWJsZWAgaW50ZXJmYWNlKSBzZXJ2aWNlcyBpblxuICogYW1wZG9jIHNjb3BlLlxuICogQHBhcmFtIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkaXNwb3NlU2VydmljZXNGb3JEb2MoYW1wZG9jKSB7XG4gIGRpc3Bvc2VTZXJ2aWNlc0ludGVybmFsKGFtcGRvYyk7XG59XG5cblxuLyoqXG4gKiBEaXNwb3NlcyBhbGwgZGlzcG9zYWJsZSAoaW1wbGVtZW50cyBgRGlzcG9zYWJsZWAgaW50ZXJmYWNlKSBzZXJ2aWNlcyBpblxuICogZW1iZWQgc2NvcGUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IGVtYmVkV2luXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkaXNwb3NlU2VydmljZXNGb3JFbWJlZChlbWJlZFdpbikge1xuICBkaXNwb3NlU2VydmljZXNJbnRlcm5hbChlbWJlZFdpbik7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFPYmplY3R9IGhvbGRlciBPYmplY3QgaG9sZGluZyB0aGUgc2VydmljZSBpbnN0YW5jZXMuXG4gKi9cbmZ1bmN0aW9uIGRpc3Bvc2VTZXJ2aWNlc0ludGVybmFsKGhvbGRlcikge1xuICAvLyBUT0RPKGR2b3l0ZW5rbyk6IENvbnNpZGVyIG1hcmtpbmcgaG9sZGVyIGFzIGRlc3Ryb3llZCBmb3IgbGF0ZXItYXJyaXZpbmdcbiAgLy8gc2VydmljZSB0byBiZSBjYW5jZWxlZCBhdXRvbWF0aWNhbGx5LlxuICBjb25zdCBzZXJ2aWNlcyA9IGdldFNlcnZpY2VzKGhvbGRlcik7XG4gIGZvciAoY29uc3QgaWQgaW4gc2VydmljZXMpIHtcbiAgICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzZXJ2aWNlcywgaWQpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3Qgc2VydmljZUhvbGRlciA9IHNlcnZpY2VzW2lkXTtcbiAgICBpZiAoc2VydmljZUhvbGRlci5vYmopIHtcbiAgICAgIGRpc3Bvc2VTZXJ2aWNlSW50ZXJuYWwoaWQsIHNlcnZpY2VIb2xkZXIub2JqKTtcbiAgICB9IGVsc2UgaWYgKHNlcnZpY2VIb2xkZXIucHJvbWlzZSkge1xuICAgICAgc2VydmljZUhvbGRlci5wcm9taXNlLnRoZW4oXG4gICAgICAgICAgaW5zdGFuY2UgPT4gZGlzcG9zZVNlcnZpY2VJbnRlcm5hbChpZCwgaW5zdGFuY2UpKTtcbiAgICB9XG4gIH1cbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHshT2JqZWN0fSBzZXJ2aWNlXG4gKi9cbmZ1bmN0aW9uIGRpc3Bvc2VTZXJ2aWNlSW50ZXJuYWwoaWQsIHNlcnZpY2UpIHtcbiAgaWYgKCFpc0Rpc3Bvc2FibGUoc2VydmljZSkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdHJ5IHtcbiAgICBhc3NlcnREaXNwb3NhYmxlKHNlcnZpY2UpLmRpc3Bvc2UoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIC8vIEVuc3VyZSB0aGF0IGEgZmFpbHVyZSB0byBkaXNwb3NlIGEgc2VydmljZSBkb2VzIG5vdCBkaXNydXB0IG90aGVyXG4gICAgLy8gc2VydmljZXMuXG4gICAgZGV2KCkuZXJyb3IoJ1NFUlZJQ0UnLCAnZmFpbGVkIHRvIGRpc3Bvc2Ugc2VydmljZScsIGlkLCBlKTtcbiAgfVxufVxuXG5cbi8qKlxuICogV2hldGhlciB0aGUgc3BlY2lmaWVkIHNlcnZpY2UgaW1wbGVtZW50cyBgRW1iZWRkYWJsZVNlcnZpY2VgIGludGVyZmFjZS5cbiAqIEBwYXJhbSB7IU9iamVjdH0gc2VydmljZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRW1iZWRkYWJsZShzZXJ2aWNlKSB7XG4gIHJldHVybiB0eXBlb2Ygc2VydmljZS5hZG9wdEVtYmVkV2luZG93ID09ICdmdW5jdGlvbic7XG59XG5cblxuLyoqXG4gKiBBZG9wdHMgYW4gZW1iZWRkYWJsZSAoaW1wbGVtZW50cyBgRW1iZWRkYWJsZVNlcnZpY2VgIGludGVyZmFjZSkgc2VydmljZVxuICogaW4gZW1iZWQgc2NvcGUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IGVtYmVkV2luXG4gKiBAcGFyYW0ge3N0cmluZ30gc2VydmljZUlkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZG9wdFNlcnZpY2VGb3JFbWJlZChlbWJlZFdpbiwgc2VydmljZUlkKSB7XG4gIGNvbnN0IGFkb3B0ZWQgPSBhZG9wdFNlcnZpY2VGb3JFbWJlZElmRW1iZWRkYWJsZShlbWJlZFdpbiwgc2VydmljZUlkKTtcbiAgZGV2KCkuYXNzZXJ0KGFkb3B0ZWQsIGBTZXJ2aWNlICR7c2VydmljZUlkfSBub3QgZm91bmQgb24gcGFyZW50IGAgK1xuICAgICAgJ29yIGRvZXNuXFwndCBpbXBsZW1lbnQgRW1iZWRkYWJsZVNlcnZpY2UuJyk7XG59XG5cblxuLyoqXG4gKiBBZG9wdHMgYW4gZW1iZWRkYWJsZSAoaW1wbGVtZW50cyBgRW1iZWRkYWJsZVNlcnZpY2VgIGludGVyZmFjZSkgc2VydmljZVxuICogaW4gZW1iZWQgc2NvcGUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IGVtYmVkV2luXG4gKiBAcGFyYW0ge3N0cmluZ30gc2VydmljZUlkXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRvcHRTZXJ2aWNlRm9yRW1iZWRJZkVtYmVkZGFibGUoZW1iZWRXaW4sIHNlcnZpY2VJZCkge1xuICBjb25zdCBmcmFtZUVsZW1lbnQgPSAvKiogQHR5cGUgeyFOb2RlfSAqLyAoZGV2KCkuYXNzZXJ0KFxuICAgICAgZW1iZWRXaW4uZnJhbWVFbGVtZW50LFxuICAgICAgJ2ZyYW1lRWxlbWVudCBub3QgZm91bmQgZm9yIGVtYmVkJykpO1xuICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2MoZnJhbWVFbGVtZW50KTtcbiAgY29uc3QgaG9sZGVyID0gZ2V0QW1wZG9jU2VydmljZUhvbGRlcihhbXBkb2MpO1xuICBpZiAoIWlzU2VydmljZVJlZ2lzdGVyZWQoaG9sZGVyLCBzZXJ2aWNlSWQpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGNvbnN0IHNlcnZpY2UgPSBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZChmcmFtZUVsZW1lbnQsIHNlcnZpY2VJZCk7XG4gIGlmICghaXNFbWJlZGRhYmxlKHNlcnZpY2UpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHNlcnZpY2UuYWRvcHRFbWJlZFdpbmRvdyhlbWJlZFdpbik7XG4gIHJldHVybiB0cnVlO1xufVxuXG5cbi8qKlxuICogUmVzZXRzIGEgc2luZ2xlIHNlcnZpY2UsIHNvIGl0IGdldHMgcmVjcmVhdGVkIG9uIG5leHQgZ2V0U2VydmljZSBpbnZvY2F0aW9uLlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0U2VydmljZUZvclRlc3RpbmcoaG9sZGVyLCBpZCkge1xuICBpZiAoaG9sZGVyLnNlcnZpY2VzKSB7XG4gICAgaG9sZGVyLnNlcnZpY2VzW2lkXSA9IG51bGw7XG4gIH1cbn1cblxuLyoqXG4gKiBAcGFyYW0geyFPYmplY3R9IGhvbGRlciBPYmplY3QgaG9sZGluZyB0aGUgc2VydmljZSBpbnN0YW5jZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzU2VydmljZVJlZ2lzdGVyZWQoaG9sZGVyLCBpZCkge1xuICBjb25zdCBzZXJ2aWNlID0gaG9sZGVyLnNlcnZpY2VzICYmIGhvbGRlci5zZXJ2aWNlc1tpZF07XG4gIC8vIEFsbCByZWdpc3RlcmVkIHNlcnZpY2VzIG11c3QgaGF2ZSBhbiBpbXBsZW1lbnRhdGlvbiBvciBhIGNvbnN0cnVjdG9yLlxuICByZXR1cm4gISEoc2VydmljZSAmJiAoc2VydmljZS5jdG9yIHx8IHNlcnZpY2Uub2JqKSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgZ2V0QW1wZG9jLFxuICBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUsXG4gIGdldEV4aXN0aW5nU2VydmljZU9yTnVsbCxcbiAgZ2V0U2VydmljZSxcbiAgZ2V0U2VydmljZUZvckRvYyxcbiAgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQsXG4gIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jLFxufSBmcm9tICcuL3NlcnZpY2UnO1xuaW1wb3J0IHtcbiAgZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MsXG4gIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUsXG4gIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MsXG4gIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2NJbkVtYmVkU2NvcGUsXG59IGZyb20gJy4vZWxlbWVudC1zZXJ2aWNlJztcblxuLyoqIEB0eXBlZGVmIHshLi4vZXh0ZW5zaW9ucy9hbXAtc3Vic2NyaXB0aW9ucy8wLjEvYW1wLXN1YnNjcmlwdGlvbnMuU3Vic2NyaXB0aW9uU2VydmljZX0gKi9cbmV4cG9ydCBsZXQgU3Vic2NyaXB0aW9uU2VydmljZTtcblxuZXhwb3J0IGNsYXNzIFNlcnZpY2VzIHtcbiAgLyoqXG4gICAqIEhpbnQ6IEFkZCBleHRlbnNpb25zIGZvbGRlciBwYXRoIHRvIGNvbXBpbGUuanMgd2l0aFxuICAgKiB3YXJuaW5ncyBjYW5ub3QgZmluZCBtb2R1bGVzLlxuICAgKi9cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBBY2Nlc3Mgc2VydmljZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hY2Nlc3MvMC4xL2FtcC1hY2Nlc3MuQWNjZXNzU2VydmljZT59XG4gICAqL1xuICBzdGF0aWMgYWNjZXNzU2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8IS4uL2V4dGVuc2lvbnMvYW1wLWFjY2Vzcy8wLjEvYW1wLWFjY2Vzcy5BY2Nlc3NTZXJ2aWNlPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnYWNjZXNzJywgJ2FtcC1hY2Nlc3MnKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIGZvciB0aGUgQWNjZXNzIHNlcnZpY2Ugb3IgYSBwcm9taXNlIGZvciBudWxsIGlmIHRoZVxuICAgKiBzZXJ2aWNlIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1hY2Nlc3MvMC4xL2FtcC1hY2Nlc3MuQWNjZXNzU2VydmljZT59XG4gICAqL1xuICBzdGF0aWMgYWNjZXNzU2VydmljZUZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWFjY2Vzcy8wLjEvYW1wLWFjY2Vzcy5BY2Nlc3NTZXJ2aWNlPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdhY2Nlc3MnLFxuICAgICAgICAgICdhbXAtYWNjZXNzJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIFN1YnNjcmlwdGlvbnMgc2VydmljZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCFTdWJzY3JpcHRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBzdWJzY3JpcHRpb25zU2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8IVN1YnNjcmlwdGlvblNlcnZpY2U+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdzdWJzY3JpcHRpb25zJyxcbiAgICAgICAgICAnYW1wLXN1YnNjcmlwdGlvbnMnKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIGZvciB0aGUgU3Vic2NyaXB0aW9ucyBzZXJ2aWNlLlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8P1N1YnNjcmlwdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIHN1YnNjcmlwdGlvbnNTZXJ2aWNlRm9yRG9jT3JOdWxsKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAoLyoqIEB0eXBlIHshUHJvbWlzZTw/U3Vic2NyaXB0aW9uU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnc3Vic2NyaXB0aW9ucycsXG4gICAgICAgICAgJ2FtcC1zdWJzY3JpcHRpb25zJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVbmxpa2UgbW9zdCBzZXJ2aWNlIGdldHRlcnMsIHBhc3NpbmcgYE5vZGVgIGlzIG5lY2Vzc2FyeSBmb3Igc29tZSBGSUUtc2NvcGVcbiAgICogc2VydmljZXMgc2luY2Ugc29tZXRpbWVzIHdlIG9ubHkgaGF2ZSB0aGUgRklFIERvY3VtZW50IGZvciBjb250ZXh0LlxuICAgKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9hY3Rpb24taW1wbC5BY3Rpb25TZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIGFjdGlvblNlcnZpY2VGb3JEb2Mobm9kZU9yRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9hY3Rpb24taW1wbC5BY3Rpb25TZXJ2aWNlfSAqLyAoXG4gICAgICBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUoXG4gICAgICAgICAgbm9kZU9yRG9jLCAnYWN0aW9uJywgLyogb3B0X2ZhbGxiYWNrVG9Ub3BXaW4gKi8gdHJ1ZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhQWN0aXZpdHk+fVxuICAgKi9cbiAgc3RhdGljIGFjdGl2aXR5Rm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPCFBY3Rpdml0eT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2FjdGl2aXR5JywgJ2FtcC1hbmFseXRpY3MnKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgZ2xvYmFsIGluc3RhbmNlIG9mIHRoZSBgQW1wRG9jU2VydmljZWAgc2VydmljZSB0aGF0IGNhbiBiZVxuICAgKiB1c2VkIHRvIHJlc29sdmUgYW4gYW1wZG9jIGZvciBhbnkgbm9kZTogZWl0aGVyIGluIHRoZSBzaW5nbGUtZG9jIG9yXG4gICAqIHNoYWRvdy1kb2MgZW52aXJvbm1lbnQuXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBhbXBkb2NTZXJ2aWNlRm9yKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jU2VydmljZX0gKi8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdhbXBkb2MnKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgQW1wRG9jIGZvciB0aGUgc3BlY2lmaWVkIGNvbnRleHQgbm9kZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfVxuICAgKi9cbiAgc3RhdGljIGFtcGRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gZ2V0QW1wZG9jKGVsZW1lbnRPckFtcERvYyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IGxvYWRBbmFseXRpY3NcbiAgICogQHJldHVybiB7IVByb21pc2U8IS4uL2V4dGVuc2lvbnMvYW1wLWFuYWx5dGljcy8wLjEvaW5zdHJ1bWVudGF0aW9uLkluc3RydW1lbnRhdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFuYWx5dGljc0ZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGxvYWRBbmFseXRpY3MgPSBmYWxzZSkge1xuICAgIGlmIChsb2FkQW5hbHl0aWNzKSB7XG4gICAgICAvLyBHZXQgRXh0ZW5zaW9ucyBzZXJ2aWNlIGFuZCBmb3JjZSBsb2FkIGFuYWx5dGljcyBleHRlbnNpb24uXG4gICAgICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2MoZWxlbWVudE9yQW1wRG9jKTtcbiAgICAgIFNlcnZpY2VzLmV4dGVuc2lvbnNGb3IoYW1wZG9jLndpbikuLypPSyovaW5zdGFsbEV4dGVuc2lvbkZvckRvYyhcbiAgICAgICAgICBhbXBkb2MsICdhbXAtYW5hbHl0aWNzJyk7XG4gICAgfVxuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hbmFseXRpY3MvMC4xL2luc3RydW1lbnRhdGlvbi5JbnN0cnVtZW50YXRpb25TZXJ2aWNlPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnYW1wLWFuYWx5dGljcy1pbnN0cnVtZW50YXRpb24nLFxuICAgICAgICAgICdhbXAtYW5hbHl0aWNzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYW5hbHl0aWNzLzAuMS9pbnN0cnVtZW50YXRpb24uSW5zdHJ1bWVudGF0aW9uU2VydmljZT59XG4gICAqL1xuICBzdGF0aWMgYW5hbHl0aWNzRm9yRG9jT3JOdWxsKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1hbmFseXRpY3MvMC4xL2luc3RydW1lbnRhdGlvbi5JbnN0cnVtZW50YXRpb25TZXJ2aWNlPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsXG4gICAgICAgICAgJ2FtcC1hbmFseXRpY3MtaW5zdHJ1bWVudGF0aW9uJywgJ2FtcC1hbmFseXRpY3MnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9iYXRjaGVkLXhoci1pbXBsLkJhdGNoZWRYaHJ9XG4gICAqL1xuICBzdGF0aWMgYmF0Y2hlZFhockZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2JhdGNoZWQteGhyLWltcGwuQmF0Y2hlZFhocn0gKi8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdiYXRjaGVkLXhocicpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWJpbmQvMC4xL2JpbmQtaW1wbC5CaW5kPn1cbiAgICovXG4gIHN0YXRpYyBiaW5kRm9yRG9jT3JOdWxsKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1iaW5kLzAuMS9iaW5kLWltcGwuQmluZD59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2NJbkVtYmVkU2NvcGUoXG4gICAgICAgICAgZWxlbWVudE9yQW1wRG9jLCAnYmluZCcsICdhbXAtYmluZCcpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8IS4vc2VydmljZS9jaWQtaW1wbC5DaWQ+fVxuICAgKi9cbiAgc3RhdGljIGNpZEZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi9zZXJ2aWNlL2NpZC1pbXBsLkNpZD59ICovIChcbiAgICAgIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2NpZCcpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9uYXZpZ2F0aW9uLk5hdmlnYXRpb259XG4gICAqL1xuICBzdGF0aWMgbmF2aWdhdGlvbkZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL25hdmlnYXRpb24uTmF2aWdhdGlvbn0gKi8gKFxuICAgICAgZ2V0U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICduYXZpZ2F0aW9uJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvY3J5cHRvLWltcGwuQ3J5cHRvfVxuICAgKi9cbiAgc3RhdGljIGNyeXB0b0Zvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IS4vc2VydmljZS9jcnlwdG8taW1wbC5DcnlwdG99ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAnY3J5cHRvJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9kb2N1bWVudC1pbmZvLWltcGwuRG9jdW1lbnRJbmZvRGVmfSBJbmZvIGFib3V0IHRoZSBkb2NcbiAgICovXG4gIHN0YXRpYyBkb2N1bWVudEluZm9Gb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9kb2N1bWVudC1pbmZvLWltcGwuRG9jSW5mb30gKi8gKFxuICAgICAgZ2V0U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdkb2N1bWVudEluZm8nKSkuZ2V0KCk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9kb2N1bWVudC1zdGF0ZS5Eb2N1bWVudFN0YXRlfVxuICAgKi9cbiAgc3RhdGljIGRvY3VtZW50U3RhdGVGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2Uod2luZG93LCAnZG9jdW1lbnRTdGF0ZScpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvZXh0ZW5zaW9ucy1pbXBsLkV4dGVuc2lvbnN9XG4gICAqL1xuICBzdGF0aWMgZXh0ZW5zaW9uc0Zvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2V4dGVuc2lvbnMtaW1wbC5FeHRlbnNpb25zfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ2V4dGVuc2lvbnMnKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBzZXJ2aWNlIGltcGxlbWVudGVkIGluIHNlcnZpY2UvaGlzdG9yeS1pbXBsLlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9oaXN0b3J5LWltcGwuSGlzdG9yeX1cbiAgICovXG4gIHN0YXRpYyBoaXN0b3J5Rm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvaGlzdG9yeS1pbXBsLkhpc3Rvcnl9ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnaGlzdG9yeScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshLi9pbnB1dC5JbnB1dH1cbiAgICovXG4gIHN0YXRpYyBpbnB1dEZvcih3aW4pIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZSh3aW4sICdpbnB1dCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2xheWVycy1pbXBsLkxheW91dExheWVyc31cbiAgICovXG4gIHN0YXRpYyBsYXllcnNGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9sYXllcnMtaW1wbC5MYXlvdXRMYXllcnN9ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnbGF5ZXJzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvcGVyZm9ybWFuY2UtaW1wbC5QZXJmb3JtYW5jZX1cbiAgICovXG4gIHN0YXRpYyBwZXJmb3JtYW5jZUZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3BlcmZvcm1hbmNlLWltcGwuUGVyZm9ybWFuY2V9Ki8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdwZXJmb3JtYW5jZScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3BlcmZvcm1hbmNlLWltcGwuUGVyZm9ybWFuY2V9XG4gICAqL1xuICBzdGF0aWMgcGVyZm9ybWFuY2VGb3JPck51bGwod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9wZXJmb3JtYW5jZS1pbXBsLlBlcmZvcm1hbmNlfSovIChcbiAgICAgIGdldEV4aXN0aW5nU2VydmljZU9yTnVsbCh3aW5kb3csICdwZXJmb3JtYW5jZScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3BsYXRmb3JtLWltcGwuUGxhdGZvcm19XG4gICAqL1xuICBzdGF0aWMgcGxhdGZvcm1Gb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9wbGF0Zm9ybS1pbXBsLlBsYXRmb3JtfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3BsYXRmb3JtJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZXMgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQoKSBzaW5jZSBSZXNvdXJjZXMgaXMgYSBzdGFydHVwIHNlcnZpY2UuXG4gICAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3Jlc291cmNlcy1pbXBsLlJlc291cmNlc31cbiAgICovXG4gIHN0YXRpYyByZXNvdXJjZXNGb3JEb2Mobm9kZU9yRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9yZXNvdXJjZXMtaW1wbC5SZXNvdXJjZXN9ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKG5vZGVPckRvYywgJ3Jlc291cmNlcycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHs/UHJvbWlzZTw/e2luY29taW5nRnJhZ21lbnQ6IHN0cmluZywgb3V0Z29pbmdGcmFnbWVudDogc3RyaW5nfT59XG4gICAqL1xuICBzdGF0aWMgc2hhcmVUcmFja2luZ0Zvck9yTnVsbCh3aW4pIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8P3tpbmNvbWluZ0ZyYWdtZW50OiBzdHJpbmcsIG91dGdvaW5nRnJhZ21lbnQ6IHN0cmluZ30+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgJ3NoYXJlLXRyYWNraW5nJyxcbiAgICAgICAgICAnYW1wLXNoYXJlLXRyYWNraW5nJywgdHJ1ZSkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHs/UHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL3ZhcmlhYmxlLXNlcnZpY2UuU3RvcnlWYXJpYWJsZURlZj59XG4gICAqL1xuICBzdGF0aWMgc3RvcnlWYXJpYWJsZVNlcnZpY2VGb3JPck51bGwod2luKSB7XG4gICAgcmV0dXJuIChcbiAgICAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvdmFyaWFibGUtc2VydmljZS5TdG9yeVZhcmlhYmxlRGVmPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgJ3N0b3J5LXZhcmlhYmxlJywgJ2FtcC1zdG9yeScsXG4gICAgICAgICAgdHJ1ZSkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJzaW9uIG9mIHRoZSBzdG9yeSBzdG9yZSBzZXJ2aWNlIGRlcGVuZHMgb24gd2hpY2ggdmVyc2lvbiBvZiBhbXAtc3RvcnlcbiAgICogdGhlIHB1Ymxpc2hlciBpcyBsb2FkaW5nLiBUaGV5IGFsbCBoYXZlIHRoZSBzYW1lIGltcGxlbWVudGF0aW9uLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHs/UHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvYW1wLXN0b3J5LXN0b3JlLXNlcnZpY2UuQW1wU3RvcnlTdG9yZVNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIHN0b3J5U3RvcmVTZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvYW1wLXN0b3J5LXN0b3JlLXNlcnZpY2UuQW1wU3RvcnlTdG9yZVNlcnZpY2U+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAnc3Rvcnktc3RvcmUnLCAnYW1wLXN0b3J5JykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHs/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIHN0b3J5U3RvcmVTZXJ2aWNlKHdpbikge1xuICAgIHJldHVybiAoLyoqIEB0eXBlIHs/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfSAqL1xuICAgICAgKGdldEV4aXN0aW5nU2VydmljZU9yTnVsbCh3aW4sICdzdG9yeS1zdG9yZScpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3RvcnktcmVxdWVzdC1zZXJ2aWNlLkFtcFN0b3J5UmVxdWVzdFNlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgc3RvcnlSZXF1ZXN0U2VydmljZSh3aW4pIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3RvcnktcmVxdWVzdC1zZXJ2aWNlLkFtcFN0b3J5UmVxdWVzdFNlcnZpY2V9ICovXG4gICAgICAoZ2V0RXhpc3RpbmdTZXJ2aWNlT3JOdWxsKHdpbiwgJ3N0b3J5LXJlcXVlc3QnKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGxvY2FsaXphdGlvblNlcnZpY2VGb3JPck51bGwod2luKSB7XG4gICAgcmV0dXJuIChcbiAgICAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2U+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAnbG9jYWxpemF0aW9uJywgJ2FtcC1zdG9yeScsIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9sb2NhbGl6YXRpb24uTG9jYWxpemF0aW9uU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBsb2NhbGl6YXRpb25TZXJ2aWNlKHdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbiwgJ2xvY2FsaXphdGlvbicpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRPRE8oIzE0MzU3KTogUmVtb3ZlIHRoaXMgd2hlbiBhbXAtc3Rvcnk6MC4xIGlzIGRlcHJlY2F0ZWQuXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4geyEuLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvYW1wLXN0b3J5LXN0b3JlLXNlcnZpY2UuQW1wU3RvcnlTdG9yZVNlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgc3RvcnlTdG9yZVNlcnZpY2VWMDEod2luKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2Uod2luLCAnc3Rvcnktc3RvcmUnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUT0RPKCMxNDM1Nyk6IFJlbW92ZSB0aGlzIHdoZW4gYW1wLXN0b3J5OjAuMSBpcyBkZXByZWNhdGVkLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshLi4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1yZXF1ZXN0LXNlcnZpY2UuQW1wU3RvcnlSZXF1ZXN0U2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBzdG9yeVJlcXVlc3RTZXJ2aWNlVjAxKHdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbiwgJ3N0b3J5LXJlcXVlc3QtdjAxJyk7XG4gIH1cblxuICAvKipcbiAgICogVE9ETygjMTQzNTcpOiBSZW1vdmUgdGhpcyB3aGVuIGFtcC1zdG9yeTowLjEgaXMgZGVwcmVjYXRlZC5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzAuMS9sb2NhbGl6YXRpb24uTG9jYWxpemF0aW9uU2VydmljZT59XG4gICAqL1xuICBzdGF0aWMgbG9jYWxpemF0aW9uU2VydmljZUZvck9yTnVsbFYwMSh3aW4pIHtcbiAgICByZXR1cm4gKFxuICAgIC8qKiBAdHlwZSB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzAuMS9sb2NhbGl6YXRpb24uTG9jYWxpemF0aW9uU2VydmljZT59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICdsb2NhbGl6YXRpb24tdjAxJywgJ2FtcC1zdG9yeScsXG4gICAgICAgICAgdHJ1ZSkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUT0RPKCMxNDM1Nyk6IFJlbW92ZSB0aGlzIHdoZW4gYW1wLXN0b3J5OjAuMSBpcyBkZXByZWNhdGVkLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshLi4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2xvY2FsaXphdGlvbi5Mb2NhbGl6YXRpb25TZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIGxvY2FsaXphdGlvblNlcnZpY2VWMDEod2luKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2Uod2luLCAnbG9jYWxpemF0aW9uLXYwMScpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4gez9Qcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC12aWV3ZXItaW50ZWdyYXRpb24vMC4xL3ZhcmlhYmxlLXNlcnZpY2UuVmlld2VySW50ZWdyYXRpb25WYXJpYWJsZURlZj59XG4gICAqL1xuICBzdGF0aWMgdmlld2VySW50ZWdyYXRpb25WYXJpYWJsZVNlcnZpY2VGb3JPck51bGwod2luKSB7XG4gICAgcmV0dXJuIChcbiAgICAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC12aWV3ZXItaW50ZWdyYXRpb24vMC4xL3ZhcmlhYmxlLXNlcnZpY2UuVmlld2VySW50ZWdyYXRpb25WYXJpYWJsZURlZj59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICd2aWV3ZXItaW50ZWdyYXRpb24tdmFyaWFibGUnLFxuICAgICAgICAgICdhbXAtdmlld2VyLWludGVncmF0aW9uJywgdHJ1ZSkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8IS4uL2V4dGVuc2lvbnMvYW1wLWFuaW1hdGlvbi8wLjEvd2ViLWFuaW1hdGlvbi1zZXJ2aWNlLldlYkFuaW1hdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIHdlYkFuaW1hdGlvblNlcnZpY2VGb3IoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hbmltYXRpb24vMC4xL3dlYi1hbmltYXRpb24tc2VydmljZS5XZWJBbmltYXRpb25TZXJ2aWNlPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUZvckRvYyhcbiAgICAgICAgICBlbGVtZW50T3JBbXBEb2MsICd3ZWItYW5pbWF0aW9uJywgJ2FtcC1hbmltYXRpb24nKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3N0b3JhZ2UtaW1wbC5TdG9yYWdlPn1cbiAgICovXG4gIHN0YXRpYyBzdG9yYWdlRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPCEuL3NlcnZpY2Uvc3RvcmFnZS1pbXBsLlN0b3JhZ2U+fSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdzdG9yYWdlJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvdGVtcGxhdGUtaW1wbC5UZW1wbGF0ZXN9XG4gICAqL1xuICBzdGF0aWMgdGVtcGxhdGVzRm9yKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvdGVtcGxhdGUtaW1wbC5UZW1wbGF0ZXN9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAndGVtcGxhdGVzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvdGltZXItaW1wbC5UaW1lcn1cbiAgICovXG4gIHN0YXRpYyB0aW1lckZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3RpbWVyLWltcGwuVGltZXJ9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAndGltZXInKSk7XG4gIH1cblxuICAvKipcbiAgICogVW5saWtlIG1vc3Qgc2VydmljZSBnZXR0ZXJzLCBwYXNzaW5nIGBOb2RlYCBpcyBuZWNlc3NhcnkgZm9yIHNvbWUgRklFLXNjb3BlXG4gICAqIHNlcnZpY2VzIHNpbmNlIHNvbWV0aW1lcyB3ZSBvbmx5IGhhdmUgdGhlIEZJRSBEb2N1bWVudCBmb3IgY29udGV4dC5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvdXJsLXJlcGxhY2VtZW50cy1pbXBsLlVybFJlcGxhY2VtZW50c31cbiAgICovXG4gIHN0YXRpYyB1cmxSZXBsYWNlbWVudHNGb3JEb2Mobm9kZU9yRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS91cmwtcmVwbGFjZW1lbnRzLWltcGwuVXJsUmVwbGFjZW1lbnRzfSAqLyAoXG4gICAgICBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUoXG4gICAgICAgICAgbm9kZU9yRG9jLCAndXJsLXJlcGxhY2UnLCAvKiBvcHRfZmFsbGJhY2tUb1RvcFdpbiAqLyB0cnVlKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC11c2VyLW5vdGlmaWNhdGlvbi8wLjEvYW1wLXVzZXItbm90aWZpY2F0aW9uLlVzZXJOb3RpZmljYXRpb25NYW5hZ2VyPn1cbiAgICovXG4gIHN0YXRpYyB1c2VyTm90aWZpY2F0aW9uTWFuYWdlckZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8IS4uL2V4dGVuc2lvbnMvYW1wLXVzZXItbm90aWZpY2F0aW9uLzAuMS9hbXAtdXNlci1ub3RpZmljYXRpb24uVXNlck5vdGlmaWNhdGlvbk1hbmFnZXI+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ3VzZXJOb3RpZmljYXRpb25NYW5hZ2VyJyxcbiAgICAgICAgICAnYW1wLXVzZXItbm90aWZpY2F0aW9uJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIGNvbnNlbnRQb2xpY3kgU2VydmljZSBvciBhIHByb21pc2UgZm9yIG51bGwgaWZcbiAgICogdGhlIHNlcnZpY2UgaXMgbm90IGF2YWlsYWJsZSBvbiB0aGUgY3VycmVudCBwYWdlLlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWNvbnNlbnQvMC4xL2NvbnNlbnQtcG9saWN5LW1hbmFnZXIuQ29uc2VudFBvbGljeU1hbmFnZXI+fVxuICAgKi9cbiAgc3RhdGljIGNvbnNlbnRQb2xpY3lTZXJ2aWNlRm9yRG9jT3JOdWxsKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAoLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtY29uc2VudC8wLjEvY29uc2VudC1wb2xpY3ktbWFuYWdlci5Db25zZW50UG9saWN5TWFuYWdlcj59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsXG4gICAgICAgICAgJ2NvbnNlbnRQb2xpY3lNYW5hZ2VyJywgJ2FtcC1jb25zZW50JykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIGdlbyBzZXJ2aWNlIG9yIGEgcHJvbWlzZSBmb3IgbnVsbCBpZlxuICAgKiB0aGUgc2VydmljZSBpcyBub3QgYXZhaWxhYmxlIG9uIHRoZSBjdXJyZW50IHBhZ2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtZ2VvLzAuMS9hbXAtZ2VvLkdlb0RlZj59XG4gICAqL1xuICBzdGF0aWMgZ2VvRm9yRG9jT3JOdWxsKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1nZW8vMC4xL2FtcC1nZW8uR2VvRGVmPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhcbiAgICAgICAgICBlbGVtZW50T3JBbXBEb2MsICdnZW8nLCAnYW1wLWdlbycsIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVbmxpa2UgbW9zdCBzZXJ2aWNlIGdldHRlcnMsIHBhc3NpbmcgYE5vZGVgIGlzIG5lY2Vzc2FyeSBmb3Igc29tZSBGSUUtc2NvcGVcbiAgICogc2VydmljZXMgc2luY2Ugc29tZXRpbWVzIHdlIG9ubHkgaGF2ZSB0aGUgRklFIERvY3VtZW50IGZvciBjb250ZXh0LlxuICAgKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS91cmwtaW1wbC5Vcmx9XG4gICAqL1xuICBzdGF0aWMgdXJsRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvdXJsLWltcGwuVXJsfSAqLyAoXG4gICAgICBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUoXG4gICAgICAgICAgbm9kZU9yRG9jLCAndXJsJywgLyogb3B0X2ZhbGxiYWNrVG9Ub3BXaW4gKi8gdHJ1ZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIGZvciB0aGUgZXhwZXJpbWVudCB2YXJpYW50cyBvciBhIHByb21pc2UgZm9yIG51bGwgaWYgaXRcbiAgICogaXMgbm90IGF2YWlsYWJsZSBvbiB0aGUgY3VycmVudCBwYWdlLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/T2JqZWN0PHN0cmluZz4+fVxuICAgKi9cbiAgc3RhdGljIHZhcmlhbnRGb3JPck51bGwod2luKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8P09iamVjdDxzdHJpbmc+Pn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICd2YXJpYW50JywgJ2FtcC1leHBlcmltZW50JywgdHJ1ZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3ZpZGVvLXNlcnZpY2UtaW50ZXJmYWNlLlZpZGVvU2VydmljZUludGVyZmFjZX1cbiAgICovXG4gIHN0YXRpYyB2aWRlb01hbmFnZXJGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIC8qKiBAdHlwZSB7IS4vc2VydmljZS92aWRlby1zZXJ2aWNlLWludGVyZmFjZS5WaWRlb1NlcnZpY2VJbnRlcmZhY2V9ICovIChcbiAgICAgICAgZ2V0U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICd2aWRlby1tYW5hZ2VyJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VzIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKCkgc2luY2UgVmlld2VyIGlzIGEgc3RhcnR1cCBzZXJ2aWNlLlxuICAgKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS92aWV3ZXItaW1wbC5WaWV3ZXJ9XG4gICAqL1xuICBzdGF0aWMgdmlld2VyRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2Uvdmlld2VyLWltcGwuVmlld2VyfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZChub2RlT3JEb2MsICd2aWV3ZXInKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBwcm9taXNlIGZvciB0aGUgdmlld2VyLiBUaGlzIGlzIGFuIHVudXN1YWwgY2FzZSBhbmQgbmVjZXNzYXJ5IG9ubHlcbiAgICogZm9yIHNlcnZpY2VzIHRoYXQgbmVlZCByZWZlcmVuY2UgdG8gdGhlIHZpZXdlciBiZWZvcmUgaXQgaGFzIGJlZW5cbiAgICogaW5pdGlhbGl6ZWQuIE1vc3Qgb2YgdGhlIGNvZGUsIGhvd2V2ZXIsIGp1c3Qgc2hvdWxkIHVzZSBgdmlld2VyRm9yRG9jYC5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuL3NlcnZpY2Uvdmlld2VyLWltcGwuVmlld2VyPn1cbiAgICovXG4gIHN0YXRpYyB2aWV3ZXJQcm9taXNlRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPCEuL3NlcnZpY2Uvdmlld2VyLWltcGwuVmlld2VyPn0gKi8gKFxuICAgICAgZ2V0U2VydmljZVByb21pc2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAndmlld2VyJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvdnN5bmMtaW1wbC5Wc3luY31cbiAgICovXG4gIHN0YXRpYyB2c3luY0Zvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3ZzeW5jLWltcGwuVnN5bmN9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAndnN5bmMnKSk7XG4gIH1cblxuICAvKipcbiAgICogVXNlcyBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZCgpIHNpbmNlIFZpZXdwb3J0IGlzIGEgc3RhcnR1cCBzZXJ2aWNlLlxuICAgKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS92aWV3cG9ydC92aWV3cG9ydC1pbXBsLlZpZXdwb3J0fVxuICAgKi9cbiAgc3RhdGljIHZpZXdwb3J0Rm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2Uvdmlld3BvcnQvdmlld3BvcnQtaW1wbC5WaWV3cG9ydH0gKi8gKFxuICAgICAgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQobm9kZU9yRG9jLCAndmlld3BvcnQnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS94aHItaW1wbC5YaHJ9XG4gICAqL1xuICBzdGF0aWMgeGhyRm9yKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UveGhyLWltcGwuWGhyfSAqLyAoZ2V0U2VydmljZSh3aW5kb3csICd4aHInKSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBfbWF0Y2hcbiAqIEBwYXJhbSB7c3RyaW5nfSBjaGFyYWN0ZXJcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gdG9VcHBlckNhc2UoX21hdGNoLCBjaGFyYWN0ZXIpIHtcbiAgcmV0dXJuIGNoYXJhY3Rlci50b1VwcGVyQ2FzZSgpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBtYXRjaFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBwcmVwZW5kRGFzaEFuZFRvTG93ZXJDYXNlKG1hdGNoKSB7XG4gIHJldHVybiAnLScgKyBtYXRjaC50b0xvd2VyQ2FzZSgpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIEF0dHJpYnV0ZSBuYW1lIGNvbnRhaW5pbmcgZGFzaGVzLlxuICogQHJldHVybiB7c3RyaW5nfSBEYXNoZXMgcmVtb3ZlZCBhbmQgc3VjY2Vzc2l2ZSBjaGFyYWN0ZXIgc2VudCB0byB1cHBlciBjYXNlLlxuICogdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRhc2hUb0NhbWVsQ2FzZShuYW1lKSB7XG4gIHJldHVybiBuYW1lLnJlcGxhY2UoLy0oW2Etel0pL2csIHRvVXBwZXJDYXNlKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIHN0cmluZyB0aGF0IGlzIGluIGNhbWVsQ2FzZSB0byBvbmUgdGhhdCBpcyBpbiBkYXNoLWNhc2UuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZyBUaGUgc3RyaW5nIHRvIGNvbnZlcnQuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBzdHJpbmcgaW4gZGFzaC1jYXNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY2FtZWxDYXNlVG9EYXNoKHN0cmluZykge1xuICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoLyg/IV4pW0EtWl0vZywgcHJlcGVuZERhc2hBbmRUb0xvd2VyQ2FzZSk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgQXR0cmlidXRlIG5hbWUgd2l0aCBkYXNoZXNcbiAqIEByZXR1cm4ge3N0cmluZ30gRGFzaGVzIHJlcGxhY2VkIGJ5IHVuZGVybGluZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkYXNoVG9VbmRlcmxpbmUobmFtZSkge1xuICByZXR1cm4gbmFtZS5yZXBsYWNlKCctJywgJ18nKTtcbn1cblxuLyoqXG4gKiBQb2x5ZmlsbCBmb3IgU3RyaW5nLnByb3RvdHlwZS5lbmRzV2l0aC5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJpbmdcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWZmaXhcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlbmRzV2l0aChzdHJpbmcsIHN1ZmZpeCkge1xuICBjb25zdCBpbmRleCA9IHN0cmluZy5sZW5ndGggLSBzdWZmaXgubGVuZ3RoO1xuICByZXR1cm4gaW5kZXggPj0gMCAmJiBzdHJpbmcuaW5kZXhPZihzdWZmaXgsIGluZGV4KSA9PSBpbmRleDtcbn1cblxuLyoqXG4gKiBQb2x5ZmlsbCBmb3IgU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZ1xuICogQHBhcmFtIHtzdHJpbmd9IHByZWZpeFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0YXJ0c1dpdGgoc3RyaW5nLCBwcmVmaXgpIHtcbiAgaWYgKHByZWZpeC5sZW5ndGggPiBzdHJpbmcubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiBzdHJpbmcubGFzdEluZGV4T2YocHJlZml4LCAwKSA9PSAwO1xufVxuXG4vKipcbiAqIEV4cGFuZHMgcGxhY2Vob2xkZXJzIGluIGEgZ2l2ZW4gdGVtcGxhdGUgc3RyaW5nIHdpdGggdmFsdWVzLlxuICpcbiAqIFBsYWNlaG9sZGVycyB1c2UgJHtrZXktbmFtZX0gc3ludGF4IGFuZCBhcmUgcmVwbGFjZWQgd2l0aCB0aGUgdmFsdWVcbiAqIHJldHVybmVkIGZyb20gdGhlIGdpdmVuIGdldHRlciBmdW5jdGlvbi5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdGVtcGxhdGUgVGhlIHRlbXBsYXRlIHN0cmluZyB0byBleHBhbmQuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKHN0cmluZyk6Kn0gZ2V0dGVyIEZ1bmN0aW9uIHVzZWQgdG8gcmV0cmlldmUgYSB2YWx1ZSBmb3IgYVxuICogICBwbGFjZWhvbGRlci4gUmV0dXJucyB2YWx1ZXMgd2lsbCBiZSBjb2VyY2VkIGludG8gc3RyaW5ncy5cbiAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0X21heEl0ZXJhdGlvbnMgTnVtYmVyIG9mIHRpbWVzIHRvIGV4cGFuZCB0aGUgdGVtcGxhdGUuXG4gKiAgIERlZmF1bHRzIHRvIDEsIGJ1dCBzaG91bGQgYmUgc2V0IHRvIGEgbGFyZ2VyIHZhbHVlIHlvdXIgcGxhY2Vob2xkZXIgdG9rZW5zXG4gKiAgIGNhbiBiZSBleHBhbmRlZCB0byBvdGhlciBwbGFjZWhvbGRlciB0b2tlbnMuIFRha2UgY2F1dGlvbiB3aXRoIGxhcmdlIHZhbHVlc1xuICogICBhcyByZWN1cnNpdmVseSBleHBhbmRpbmcgYSBzdHJpbmcgY2FuIGJlIGV4cG9uZW50aWFsbHkgZXhwZW5zaXZlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhwYW5kVGVtcGxhdGUodGVtcGxhdGUsIGdldHRlciwgb3B0X21heEl0ZXJhdGlvbnMpIHtcbiAgY29uc3QgbWF4SXRlcmF0aW9ucyA9IG9wdF9tYXhJdGVyYXRpb25zIHx8IDE7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbWF4SXRlcmF0aW9uczsgaSsrKSB7XG4gICAgbGV0IG1hdGNoZXMgPSAwO1xuICAgIHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZSgvXFwkeyhbXn1dKil9L2csIChfYSwgYikgPT4ge1xuICAgICAgbWF0Y2hlcysrO1xuICAgICAgcmV0dXJuIGdldHRlcihiKTtcbiAgICB9KTtcbiAgICBpZiAoIW1hdGNoZXMpIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdGVtcGxhdGU7XG59XG5cbi8qKlxuICogSGFzaCBmdW5jdGlvbiBkamIyYVxuICogVGhpcyBpcyBpbnRlbmRlZCB0byBiZSBhIHNpbXBsZSwgZmFzdCBoYXNoaW5nIGZ1bmN0aW9uIHVzaW5nIG1pbmltYWwgY29kZS5cbiAqIEl0IGRvZXMgKm5vdCogaGF2ZSBnb29kIGNyeXB0b2dyYXBoaWMgcHJvcGVydGllcy5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcbiAqIEByZXR1cm4ge3N0cmluZ30gMzItYml0IHVuc2lnbmVkIGhhc2ggb2YgdGhlIHN0cmluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gc3RyaW5nSGFzaDMyKHN0cikge1xuICBjb25zdCB7bGVuZ3RofSA9IHN0cjtcbiAgbGV0IGhhc2ggPSA1MzgxO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgaGFzaCA9IGhhc2ggKiAzMyBeIHN0ci5jaGFyQ29kZUF0KGkpO1xuICB9XG4gIC8vIENvbnZlcnQgZnJvbSAzMi1iaXQgc2lnbmVkIHRvIHVuc2lnbmVkLlxuICByZXR1cm4gU3RyaW5nKGhhc2ggPj4+IDApO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4vc2VydmljZXMnO1xuaW1wb3J0IHtkZXYsIHJldGhyb3dBc3luY30gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtpbnNlcnRBZnRlck9yQXRTdGFydCwgd2FpdEZvckJvZHl9IGZyb20gJy4vZG9tJztcbmltcG9ydCB7bWFwfSBmcm9tICcuL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge3NldFN0eWxlc30gZnJvbSAnLi9zdHlsZSc7XG5pbXBvcnQge3dhaXRGb3JTZXJ2aWNlc30gZnJvbSAnLi9yZW5kZXItZGVsYXlpbmctc2VydmljZXMnO1xuXG5jb25zdCBUUkFOU0ZPUk1FUl9QUk9QID0gJ19fQU1QX0NTU19UUic7XG5jb25zdCBTVFlMRV9NQVBfUFJPUCA9ICdfX0FNUF9DU1NfU00nO1xuY29uc3QgYm9keVZpc2libGVTZW50aW5lbCA9ICdfX0FNUF9CT0RZX1ZJU0lCTEUnO1xuXG5cbi8qKlxuICogQWRkcyB0aGUgZ2l2ZW4gY3NzIHRleHQgdG8gdGhlIGdpdmVuIGFtcGRvYy5cbiAqXG4gKiBUaGUgc3R5bGUgdGFncyB3aWxsIGJlIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIGhlYWQgYmVmb3JlIGFsbCBhdXRob3JcbiAqIHN0eWxlcy4gT25lIGVsZW1lbnQgY2FuIGJlIHRoZSBtYWluIHJ1bnRpbWUgQ1NTLiBUaGlzIGlzIGd1YXJhbnRlZWRcbiAqIHRvIGFsd2F5cyBiZSB0aGUgZmlyc3Qgc3R5bGVzaGVldCBpbiB0aGUgZG9jLlxuICpcbiAqIEBwYXJhbSB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvYyBUaGUgYW1wZG9jIHRoYXQgc2hvdWxkIGdldCB0aGUgbmV3IHN0eWxlcy5cbiAqIEBwYXJhbSB7c3RyaW5nfSBjc3NUZXh0XG4gKiBAcGFyYW0gez9mdW5jdGlvbighRWxlbWVudCl8dW5kZWZpbmVkfSBjYiBDYWxsZWQgd2hlbiB0aGUgbmV3IHN0eWxlcyBhcmUgYXZhaWxhYmxlLlxuICogICAgIE5vdCB1c2luZyBhIHByb21pc2UsIGJlY2F1c2UgdGhpcyBpcyBzeW5jaHJvbm91cyB3aGVuIHBvc3NpYmxlLlxuICogICAgIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2UuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfaXNSdW50aW1lQ3NzIElmIHRydWUsIHRoaXMgc3R5bGUgdGFnIHdpbGwgYmUgaW5zZXJ0ZWRcbiAqICAgICBhcyB0aGUgZmlyc3QgZWxlbWVudCBpbiBoZWFkIGFuZCBhbGwgc3R5bGUgZWxlbWVudHMgd2lsbCBiZSBwb3NpdGlvbmVkXG4gKiAgICAgYWZ0ZXIuXG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF9leHRcbiAqIEByZXR1cm4geyFFbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbFN0eWxlc0ZvckRvYyhcbiAgYW1wZG9jLCBjc3NUZXh0LCBjYiwgb3B0X2lzUnVudGltZUNzcywgb3B0X2V4dCkge1xuICBjb25zdCBjc3NSb290ID0gYW1wZG9jLmdldEhlYWROb2RlKCk7XG4gIGNvbnN0IHN0eWxlID0gaW5zZXJ0U3R5bGVFbGVtZW50KFxuICAgICAgY3NzUm9vdCxcbiAgICAgIG1heWJlVHJhbnNmb3JtKGNzc1Jvb3QsIGNzc1RleHQpLFxuICAgICAgb3B0X2lzUnVudGltZUNzcyB8fCBmYWxzZSxcbiAgICAgIG9wdF9leHQgfHwgbnVsbCk7XG5cbiAgaWYgKGNiKSB7XG4gICAgY29uc3Qgcm9vdE5vZGUgPSBhbXBkb2MuZ2V0Um9vdE5vZGUoKTtcbiAgICAvLyBTdHlsZXMgYXJlbid0IGFsd2F5cyBhdmFpbGFibGUgc3luY2hyb25vdXNseS4gRS5nLiBpZiB0aGVyZSBpcyBhXG4gICAgLy8gcGVuZGluZyBzdHlsZSBkb3dubG9hZCwgaXQgd2lsbCBoYXZlIHRvIGZpbmlzaCBiZWZvcmUgdGhlIG5ld1xuICAgIC8vIHN0eWxlIGlzIHZpc2libGUuXG4gICAgLy8gRm9yIHRoaXMgcmVhc29uIHdlIHBvbGwgdW50aWwgdGhlIHN0eWxlIGJlY29tZXMgYXZhaWxhYmxlLlxuICAgIC8vIFN5bmMgY2FzZS5cbiAgICBpZiAoc3R5bGVMb2FkZWQocm9vdE5vZGUsIHN0eWxlKSkge1xuICAgICAgY2Ioc3R5bGUpO1xuICAgICAgcmV0dXJuIHN0eWxlO1xuICAgIH1cbiAgICAvLyBQb2xsIHVudGlsIHN0eWxlcyBhcmUgYXZhaWxhYmxlLlxuICAgIGNvbnN0IGludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYgKHN0eWxlTG9hZGVkKHJvb3ROb2RlLCBzdHlsZSkpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gICAgICAgIGNiKHN0eWxlKTtcbiAgICAgIH1cbiAgICB9LCA0KTtcbiAgfVxuICByZXR1cm4gc3R5bGU7XG59XG5cblxuLyoqXG4gKiBBZGRzIHRoZSBnaXZlbiBjc3MgdGV4dCB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQuXG4gKiBUT0RPKGR2b3l0ZW5rbywgIzEwNzA1KTogUmVtb3ZlIHRoaXMgbWV0aG9kIG9uY2UgRklFL2FtcGRvYyBtaWdyYXRpb24gaXNcbiAqIGRvbmUuXG4gKlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvYyBUaGUgZG9jdW1lbnQgdGhhdCBzaG91bGQgZ2V0IHRoZSBuZXcgc3R5bGVzLlxuICogQHBhcmFtIHtzdHJpbmd9IGNzc1RleHRcbiAqIEBwYXJhbSB7P2Z1bmN0aW9uKCFFbGVtZW50KXx1bmRlZmluZWR9IGNiIENhbGxlZCB3aGVuIHRoZSBuZXcgc3R5bGVzIGFyZVxuICogICAgIGF2YWlsYWJsZS4gTm90IHVzaW5nIGEgcHJvbWlzZSwgYmVjYXVzZSB0aGlzIGlzIHN5bmNocm9ub3VzIHdoZW5cbiAqICAgICBwb3NzaWJsZS4gZm9yIGJldHRlciBwZXJmb3JtYW5jZS5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pc1J1bnRpbWVDc3MgSWYgdHJ1ZSwgdGhpcyBzdHlsZSB0YWcgd2lsbCBiZSBpbnNlcnRlZFxuICogICAgIGFzIHRoZSBmaXJzdCBlbGVtZW50IGluIGhlYWQgYW5kIGFsbCBzdHlsZSBlbGVtZW50cyB3aWxsIGJlIHBvc2l0aW9uZWRcbiAqICAgICBhZnRlci5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X2V4dFxuICogQHJldHVybiB7IUVsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnN0YWxsU3R5bGVzTGVnYWN5KFxuICBkb2MsIGNzc1RleHQsIGNiLCBvcHRfaXNSdW50aW1lQ3NzLCBvcHRfZXh0KSB7XG4gIGNvbnN0IHN0eWxlID0gaW5zZXJ0U3R5bGVFbGVtZW50KFxuICAgICAgZGV2KCkuYXNzZXJ0RWxlbWVudChkb2MuaGVhZCksXG4gICAgICBjc3NUZXh0LFxuICAgICAgb3B0X2lzUnVudGltZUNzcyB8fCBmYWxzZSxcbiAgICAgIG9wdF9leHQgfHwgbnVsbCk7XG5cbiAgaWYgKGNiKSB7XG4gICAgLy8gU3R5bGVzIGFyZW4ndCBhbHdheXMgYXZhaWxhYmxlIHN5bmNocm9ub3VzbHkuIEUuZy4gaWYgdGhlcmUgaXMgYVxuICAgIC8vIHBlbmRpbmcgc3R5bGUgZG93bmxvYWQsIGl0IHdpbGwgaGF2ZSB0byBmaW5pc2ggYmVmb3JlIHRoZSBuZXdcbiAgICAvLyBzdHlsZSBpcyB2aXNpYmxlLlxuICAgIC8vIEZvciB0aGlzIHJlYXNvbiB3ZSBwb2xsIHVudGlsIHRoZSBzdHlsZSBiZWNvbWVzIGF2YWlsYWJsZS5cbiAgICAvLyBTeW5jIGNhc2UuXG4gICAgaWYgKHN0eWxlTG9hZGVkKGRvYywgc3R5bGUpKSB7XG4gICAgICBjYihzdHlsZSk7XG4gICAgICByZXR1cm4gc3R5bGU7XG4gICAgfVxuICAgIC8vIFBvbGwgdW50aWwgc3R5bGVzIGFyZSBhdmFpbGFibGUuXG4gICAgY29uc3QgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBpZiAoc3R5bGVMb2FkZWQoZG9jLCBzdHlsZSkpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gICAgICAgIGNiKHN0eWxlKTtcbiAgICAgIH1cbiAgICB9LCA0KTtcbiAgfVxuICByZXR1cm4gc3R5bGU7XG59XG5cblxuLyoqXG4gKiBDcmVhdGVzIHRoZSBwcm9wZXJseSBjb25maWd1cmVkIHN0eWxlIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFbGVtZW50fCFTaGFkb3dSb290fSBjc3NSb290XG4gKiBAcGFyYW0ge3N0cmluZ30gY3NzVGV4dFxuICogQHBhcmFtIHtib29sZWFufSBpc1J1bnRpbWVDc3NcbiAqIEBwYXJhbSB7P3N0cmluZ30gZXh0XG4gKiBAcmV0dXJuIHshRWxlbWVudH1cbiAqL1xuZnVuY3Rpb24gaW5zZXJ0U3R5bGVFbGVtZW50KGNzc1Jvb3QsIGNzc1RleHQsIGlzUnVudGltZUNzcywgZXh0KSB7XG4gIGxldCBzdHlsZU1hcCA9IGNzc1Jvb3RbU1RZTEVfTUFQX1BST1BdO1xuICBpZiAoIXN0eWxlTWFwKSB7XG4gICAgc3R5bGVNYXAgPSBjc3NSb290W1NUWUxFX01BUF9QUk9QXSA9IG1hcCgpO1xuICB9XG5cbiAgY29uc3QgaXNFeHRDc3MgPSAhaXNSdW50aW1lQ3NzICYmXG4gICAgICAoZXh0ICYmIGV4dCAhPSAnYW1wLWN1c3RvbScgJiYgZXh0ICE9ICdhbXAta2V5ZnJhbWVzJyk7XG4gIGNvbnN0IGtleSA9XG4gICAgICBpc1J1bnRpbWVDc3MgPyAnYW1wLXJ1bnRpbWUnIDpcbiAgICAgICAgaXNFeHRDc3MgPyBgYW1wLWV4dGVuc2lvbj0ke2V4dH1gIDogbnVsbDtcblxuICAvLyBDaGVjayBpZiBpdCBoYXMgYWxyZWFkeSBiZWVuIGNyZWF0ZWQgb3IgZGlzY292ZXJlZC5cbiAgaWYgKGtleSkge1xuICAgIGNvbnN0IGV4aXN0aW5nID0gZ2V0RXhpc3RpbmdTdHlsZUVsZW1lbnQoY3NzUm9vdCwgc3R5bGVNYXAsIGtleSk7XG4gICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICByZXR1cm4gZXhpc3Rpbmc7XG4gICAgfVxuICB9XG5cbiAgLy8gQ3JlYXRlIHRoZSBuZXcgc3R5bGUgZWxlbWVudCBhbmQgYXBwZW5kIHRvIGNzc1Jvb3QuXG4gIGNvbnN0IGRvYyA9IChjc3NSb290Lm93bmVyRG9jdW1lbnQgfHwgY3NzUm9vdCk7XG4gIGNvbnN0IHN0eWxlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gIHN0eWxlLi8qT0sqL3RleHRDb250ZW50ID0gY3NzVGV4dDtcbiAgbGV0IGFmdGVyRWxlbWVudCA9IG51bGw7XG4gIC8vIE1ha2Ugc3VyZSB0aGF0IHdlIHBsYWNlIHN0eWxlIHRhZ3MgYWZ0ZXIgdGhlIG1haW4gcnVudGltZSBDU1MuIE90aGVyd2lzZVxuICAvLyB0aGUgb3JkZXIgaXMgcmFuZG9tLlxuICBpZiAoaXNSdW50aW1lQ3NzKSB7XG4gICAgc3R5bGUuc2V0QXR0cmlidXRlKCdhbXAtcnVudGltZScsICcnKTtcbiAgfSBlbHNlIGlmIChpc0V4dENzcykge1xuICAgIHN0eWxlLnNldEF0dHJpYnV0ZSgnYW1wLWV4dGVuc2lvbicsIGV4dCB8fCAnJyk7XG4gICAgYWZ0ZXJFbGVtZW50ID0gZGV2KCkuYXNzZXJ0RWxlbWVudChnZXRFeGlzdGluZ1N0eWxlRWxlbWVudChcbiAgICAgICAgY3NzUm9vdCwgc3R5bGVNYXAsICdhbXAtcnVudGltZScpKTtcbiAgfSBlbHNlIHtcbiAgICBpZiAoZXh0KSB7XG4gICAgICBzdHlsZS5zZXRBdHRyaWJ1dGUoZXh0LCAnJyk7XG4gICAgfVxuICAgIGFmdGVyRWxlbWVudCA9IGNzc1Jvb3QubGFzdENoaWxkO1xuICB9XG4gIGluc2VydEFmdGVyT3JBdFN0YXJ0KGNzc1Jvb3QsIHN0eWxlLCBhZnRlckVsZW1lbnQpO1xuICBpZiAoa2V5KSB7XG4gICAgc3R5bGVNYXBba2V5XSA9IHN0eWxlO1xuICB9XG4gIHJldHVybiBzdHlsZTtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IUVsZW1lbnR8IVNoYWRvd1Jvb3R9IGNzc1Jvb3RcbiAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICFFbGVtZW50Pn0gc3R5bGVNYXBcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXlcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5mdW5jdGlvbiBnZXRFeGlzdGluZ1N0eWxlRWxlbWVudChjc3NSb290LCBzdHlsZU1hcCwga2V5KSB7XG4gIC8vIEFscmVhZHkgY2FjaGVkLlxuICBpZiAoc3R5bGVNYXBba2V5XSkge1xuICAgIHJldHVybiBzdHlsZU1hcFtrZXldO1xuICB9XG4gIC8vIENoZWNrIGlmIHRoZSBzdHlsZSBoYXMgYWxyZWFkeSBiZWVuIGFkZGVkIGJ5IHRoZSBzZXJ2ZXIgbGF5b3V0LlxuICBjb25zdCBleGlzdGluZyA9IGNzc1Jvb3QuLypPSyovcXVlcnlTZWxlY3Rvcihgc3R5bGVbJHtrZXl9XWApO1xuICBpZiAoZXhpc3RpbmcpIHtcbiAgICBzdHlsZU1hcFtrZXldID0gZXhpc3Rpbmc7XG4gICAgcmV0dXJuIGV4aXN0aW5nO1xuICB9XG4gIC8vIE5vdGhpbmcgZm91bmQuXG4gIHJldHVybiBudWxsO1xufVxuXG5cbi8qKlxuICogQXBwbGllcyBhIHRyYW5zZm9ybWVyIHRvIHRoZSBDU1MgdGV4dCBpZiBpdCBoYXMgYmVlbiByZWdpc3RlcmVkLlxuICogQHBhcmFtIHshRWxlbWVudHwhU2hhZG93Um9vdH0gY3NzUm9vdFxuICogQHBhcmFtIHtmdW5jdGlvbihzdHJpbmcpOnN0cmluZ30gdHJhbnNmb3JtZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGxDc3NUcmFuc2Zvcm1lcihjc3NSb290LCB0cmFuc2Zvcm1lcikge1xuICBjc3NSb290W1RSQU5TRk9STUVSX1BST1BdID0gdHJhbnNmb3JtZXI7XG59XG5cblxuLyoqXG4gKiBBcHBsaWVzIGEgdHJhbnNmb3JtZXIgdG8gdGhlIENTUyB0ZXh0IGlmIGl0IGhhcyBiZWVuIHJlZ2lzdGVyZWQuXG4gKiBAcGFyYW0geyFFbGVtZW50fCFTaGFkb3dSb290fSBjc3NSb290XG4gKiBAcGFyYW0ge3N0cmluZ30gY3NzVGV4dFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBtYXliZVRyYW5zZm9ybShjc3NSb290LCBjc3NUZXh0KSB7XG4gIGNvbnN0IHRyYW5zZm9ybWVyID0gY3NzUm9vdFtUUkFOU0ZPUk1FUl9QUk9QXTtcbiAgcmV0dXJuIHRyYW5zZm9ybWVyID8gdHJhbnNmb3JtZXIoY3NzVGV4dCkgOiBjc3NUZXh0O1xufVxuXG5cbi8qKlxuICogU2V0cyB0aGUgZG9jdW1lbnQncyBib2R5IG9wYWNpdHkgdG8gMS5cbiAqIElmIHRoZSBib2R5IGlzIG5vdCB5ZXQgYXZhaWxhYmxlIChiZWNhdXNlIG91ciBzY3JpcHQgd2FzIGxvYWRlZFxuICogc3luY2hyb25vdXNseSksIHBvbGxzIHVudGlsIGl0IGlzLlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvYyBUaGUgZG9jdW1lbnQgd2hvJ3MgYm9keSB3ZSBzaG91bGQgbWFrZSB2aXNpYmxlLlxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X3dhaXRGb3JTZXJ2aWNlcyBXaGV0aGVyIHRoZSBib2R5IHZpc2liaWxpdHkgc2hvdWxkXG4gKiAgICAgYmUgYmxvY2tlZCBvbiBrZXkgc2VydmljZXMgYmVpbmcgbG9hZGVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFrZUJvZHlWaXNpYmxlKGRvYywgb3B0X3dhaXRGb3JTZXJ2aWNlcykge1xuICBkZXYoKS5hc3NlcnQoZG9jLmRlZmF1bHRWaWV3LCAnUGFzc2VkIGluIGRvY3VtZW50IG11c3QgaGF2ZSBhIGRlZmF1bHRWaWV3Jyk7XG4gIGNvbnN0IHdpbiA9IC8qKiBAdHlwZSB7IVdpbmRvd30gKi8gKGRvYy5kZWZhdWx0Vmlldyk7XG4gIGlmICh3aW5bYm9keVZpc2libGVTZW50aW5lbF0pIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3Qgc2V0ID0gKCkgPT4ge1xuICAgIHdpbltib2R5VmlzaWJsZVNlbnRpbmVsXSA9IHRydWU7XG4gICAgc2V0U3R5bGVzKGRldigpLmFzc2VydEVsZW1lbnQoZG9jLmJvZHkpLCB7XG4gICAgICBvcGFjaXR5OiAxLFxuICAgICAgdmlzaWJpbGl0eTogJ3Zpc2libGUnLFxuICAgICAgJ2FuaW1hdGlvbic6ICdub25lJyxcbiAgICB9KTtcbiAgICByZW5kZXJTdGFydGVkTm9JbmxpbmUoZG9jKTtcbiAgfTtcbiAgdHJ5IHtcbiAgICB3YWl0Rm9yQm9keShkb2MsICgpID0+IHtcbiAgICAgIGlmICh3aW5bYm9keVZpc2libGVTZW50aW5lbF0pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgd2luW2JvZHlWaXNpYmxlU2VudGluZWxdID0gdHJ1ZTtcbiAgICAgIGlmIChvcHRfd2FpdEZvclNlcnZpY2VzKSB7XG4gICAgICAgIHdhaXRGb3JTZXJ2aWNlcyh3aW4pLmNhdGNoKHJlYXNvbiA9PiB7XG4gICAgICAgICAgcmV0aHJvd0FzeW5jKHJlYXNvbik7XG4gICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9KS50aGVuKHNlcnZpY2VzID0+IHtcbiAgICAgICAgICBzZXQoKTtcbiAgICAgICAgICBpZiAoc2VydmljZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgU2VydmljZXMucmVzb3VyY2VzRm9yRG9jKGRvYykuLypPSyovc2NoZWR1bGVQYXNzKFxuICAgICAgICAgICAgICAgIDEsIC8qIHJlbGF5b3V0QWxsICovIHRydWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcGVyZiA9IFNlcnZpY2VzLnBlcmZvcm1hbmNlRm9yKHdpbik7XG4gICAgICAgICAgICBwZXJmLnRpY2soJ21idicpO1xuICAgICAgICAgICAgcGVyZi5mbHVzaCgpO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2V0KCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBJZiB0aGVyZSB3YXMgYW4gZXJyb3IgZHVyaW5nIHRoZSBsb2dpYyBhYm92ZSAoc3VjaCBhcyBzZXJ2aWNlIG5vdFxuICAgIC8vIHlldCBpbnN0YWxsZWQsIGRlZmluaXRlbHkgdHJ5IHRvIG1ha2UgdGhlIGJvZHkgdmlzaWJsZS5cbiAgICBzZXQoKTtcbiAgICAvLyBBdm9pZCBlcnJvcnMgaW4gdGhlIGZ1bmN0aW9uIHRvIGJyZWFrIGV4ZWN1dGlvbiBmbG93IGFzIHRoaXMgaXNcbiAgICAvLyBvZnRlbiBjYWxsZWQgYXMgYSBsYXN0IHJlc29ydC5cbiAgICByZXRocm93QXN5bmMoZSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2NcbiAqL1xuZnVuY3Rpb24gcmVuZGVyU3RhcnRlZE5vSW5saW5lKGRvYykge1xuICB0cnkge1xuICAgIFNlcnZpY2VzLnJlc291cmNlc0ZvckRvYyhkb2MpLnJlbmRlclN0YXJ0ZWQoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIC8vIGBtYWtlQm9keVZpc2libGVgIGlzIGNhbGxlZCBpbiB0aGUgZXJyb3ItcHJvY2Vzc2luZyBjeWNsZSBhbmQgdGh1c1xuICAgIC8vIGNvdWxkIGJlIHRyaWdnZXJlZCB3aGVuIHJ1bnRpbWUncyBpbml0aWFsaXphdGlvbiBpcyBpbmNvbXBsZXRlIHdoaWNoXG4gICAgLy8gd291bGQgY2F1c2UgdW5yZWxhdGVkIGVycm9ycyB0byBiZSB0aHJvd24gaGVyZS5cbiAgfVxufVxuXG5cbi8qKlxuICogSW5kaWNhdGVzIHRoYXQgdGhlIGJvZHkgaXMgYWx3YXlzIHZpc2libGUuIEZvciBpbnN0YW5jZSwgaW4gY2FzZSBvZiBQV0EuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gYm9keUFsd2F5c1Zpc2libGUod2luKSB7XG4gIHdpbltib2R5VmlzaWJsZVNlbnRpbmVsXSA9IHRydWU7XG59XG5cblxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciBhIHN0eWxlIGVsZW1lbnQgd2FzIHJlZ2lzdGVyZWQgaW4gdGhlIERPTS5cbiAqIEBwYXJhbSB7IURvY3VtZW50fCFTaGFkb3dSb290fSBkb2NcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHN0eWxlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBzdHlsZUxvYWRlZChkb2MsIHN0eWxlKSB7XG4gIGNvbnN0IHNoZWV0cyA9IGRvYy5zdHlsZVNoZWV0cztcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGVldHMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBzaGVldCA9IHNoZWV0c1tpXTtcbiAgICBpZiAoc2hlZXQub3duZXJOb2RlID09IHN0eWxlKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8vIE5vdGU6IGxvYWRlZCBieSAzcCBzeXN0ZW0uIENhbm5vdCByZWx5IG9uIGJhYmVsIHBvbHlmaWxscy5cbmltcG9ydCB7bWFwfSBmcm9tICcuL3V0aWxzL29iamVjdC5qcyc7XG5pbXBvcnQge3N0YXJ0c1dpdGh9IGZyb20gJy4vc3RyaW5nJztcblxuXG4vKiogQHR5cGUge09iamVjdDxzdHJpbmcsIHN0cmluZz59ICovXG5sZXQgcHJvcGVydHlOYW1lQ2FjaGU7XG5cbi8qKiBAY29uc3QgeyFBcnJheTxzdHJpbmc+fSAqL1xuY29uc3QgdmVuZG9yUHJlZml4ZXMgPSBbJ1dlYmtpdCcsICd3ZWJraXQnLCAnTW96JywgJ21veicsICdtcycsICdPJywgJ28nXTtcblxuXG4vKipcbiAqIEBleHBvcnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBjYW1lbENhc2UgY2FtZWwgY2FzZWQgc3RyaW5nXG4gKiBAcmV0dXJuIHtzdHJpbmd9IHRpdGxlIGNhc2VkIHN0cmluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gY2FtZWxDYXNlVG9UaXRsZUNhc2UoY2FtZWxDYXNlKSB7XG4gIHJldHVybiBjYW1lbENhc2UuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBjYW1lbENhc2Uuc2xpY2UoMSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIHRoZSBzdHlsZSBpZiBhIHByZWZpeGVkIHZlcnNpb24gb2YgYSBwcm9wZXJ0eSBleGlzdHMgYW5kIHJldHVybnNcbiAqIGl0IG9yIHJldHVybnMgYW4gZW1wdHkgc3RyaW5nLlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7IU9iamVjdH0gc3R5bGVcbiAqIEBwYXJhbSB7c3RyaW5nfSB0aXRsZUNhc2UgdGhlIHRpdGxlIGNhc2UgdmVyc2lvbiBvZiBhIGNzcyBwcm9wZXJ0eSBuYW1lXG4gKiBAcmV0dXJuIHtzdHJpbmd9IHRoZSBwcmVmaXhlZCBwcm9wZXJ0eSBuYW1lIG9yIG51bGwuXG4gKi9cbmZ1bmN0aW9uIGdldFZlbmRvckpzUHJvcGVydHlOYW1lXyhzdHlsZSwgdGl0bGVDYXNlKSB7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdmVuZG9yUHJlZml4ZXMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBwcm9wZXJ0eU5hbWUgPSB2ZW5kb3JQcmVmaXhlc1tpXSArIHRpdGxlQ2FzZTtcbiAgICBpZiAoc3R5bGVbcHJvcGVydHlOYW1lXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gcHJvcGVydHlOYW1lO1xuICAgIH1cbiAgfVxuICByZXR1cm4gJyc7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgcG9zc2libHkgcHJlZml4ZWQgSmF2YVNjcmlwdCBwcm9wZXJ0eSBuYW1lIG9mIGEgc3R5bGUgcHJvcGVydHlcbiAqIChleC4gV2Via2l0VHJhbnNpdGlvbkR1cmF0aW9uKSBnaXZlbiBhIGNhbWVsQ2FzZSdkIHZlcnNpb24gb2YgdGhlIHByb3BlcnR5XG4gKiAoZXguIHRyYW5zaXRpb25EdXJhdGlvbikuXG4gKiBAZXhwb3J0XG4gKiBAcGFyYW0geyFPYmplY3R9IHN0eWxlXG4gKiBAcGFyYW0ge3N0cmluZ30gY2FtZWxDYXNlIHRoZSBjYW1lbCBjYXNlZCB2ZXJzaW9uIG9mIGEgY3NzIHByb3BlcnR5IG5hbWVcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9ieXBhc3NDYWNoZSBieXBhc3MgdGhlIG1lbW9pemVkIGNhY2hlIG9mIHByb3BlcnR5XG4gKiAgIG1hcHBpbmdcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFZlbmRvckpzUHJvcGVydHlOYW1lKHN0eWxlLCBjYW1lbENhc2UsIG9wdF9ieXBhc3NDYWNoZSkge1xuICBpZiAoc3RhcnRzV2l0aChjYW1lbENhc2UsICctLScpKSB7XG4gICAgLy8gQ1NTIHZhcnMgYXJlIHJldHVybmVkIGFzIGlzLlxuICAgIHJldHVybiBjYW1lbENhc2U7XG4gIH1cbiAgaWYgKCFwcm9wZXJ0eU5hbWVDYWNoZSkge1xuICAgIHByb3BlcnR5TmFtZUNhY2hlID0gbWFwKCk7XG4gIH1cbiAgbGV0IHByb3BlcnR5TmFtZSA9IHByb3BlcnR5TmFtZUNhY2hlW2NhbWVsQ2FzZV07XG4gIGlmICghcHJvcGVydHlOYW1lIHx8IG9wdF9ieXBhc3NDYWNoZSkge1xuICAgIHByb3BlcnR5TmFtZSA9IGNhbWVsQ2FzZTtcbiAgICBpZiAoc3R5bGVbY2FtZWxDYXNlXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCB0aXRsZUNhc2UgPSBjYW1lbENhc2VUb1RpdGxlQ2FzZShjYW1lbENhc2UpO1xuICAgICAgY29uc3QgcHJlZml4ZWRQcm9wZXJ0eU5hbWUgPSBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZV8oc3R5bGUsIHRpdGxlQ2FzZSk7XG5cbiAgICAgIGlmIChzdHlsZVtwcmVmaXhlZFByb3BlcnR5TmFtZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBwcm9wZXJ0eU5hbWUgPSBwcmVmaXhlZFByb3BlcnR5TmFtZTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFvcHRfYnlwYXNzQ2FjaGUpIHtcbiAgICAgIHByb3BlcnR5TmFtZUNhY2hlW2NhbWVsQ2FzZV0gPSBwcm9wZXJ0eU5hbWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBwcm9wZXJ0eU5hbWU7XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBDU1Mgc3R5bGVzIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudCB3aXRoICFpbXBvcnRhbnQuIFRoZSBzdHlsZXNcbiAqIGFyZSBzcGVjaWZpZWQgYXMgYSBtYXAgZnJvbSBDU1MgcHJvcGVydHkgbmFtZXMgdG8gdGhlaXIgdmFsdWVzLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgKj59IHN0eWxlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0SW1wb3J0YW50U3R5bGVzKGVsZW1lbnQsIHN0eWxlcykge1xuICBmb3IgKGNvbnN0IGsgaW4gc3R5bGVzKSB7XG4gICAgZWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShcbiAgICAgICAgZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWUoc3R5bGVzLCBrKSwgc3R5bGVzW2tdLnRvU3RyaW5nKCksICdpbXBvcnRhbnQnKTtcbiAgfVxufVxuXG5cbi8qKlxuICogU2V0cyB0aGUgQ1NTIHN0eWxlIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudCB3aXRoIG9wdGlvbmFsIHVuaXRzLCBlLmcuIFwicHhcIi5cbiAqIEBwYXJhbSB7P0VsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wZXJ0eVxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfdW5pdHNcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9ieXBhc3NDYWNoZVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0U3R5bGUoZWxlbWVudCwgcHJvcGVydHksIHZhbHVlLCBvcHRfdW5pdHMsIG9wdF9ieXBhc3NDYWNoZSkge1xuICBjb25zdCBwcm9wZXJ0eU5hbWUgPSBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZShlbGVtZW50LnN0eWxlLCBwcm9wZXJ0eSxcbiAgICAgIG9wdF9ieXBhc3NDYWNoZSk7XG4gIGlmIChwcm9wZXJ0eU5hbWUpIHtcbiAgICBlbGVtZW50LnN0eWxlW3Byb3BlcnR5TmFtZV0gPVxuICAgICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovIChvcHRfdW5pdHMgPyB2YWx1ZSArIG9wdF91bml0cyA6IHZhbHVlKTtcbiAgfVxufVxuXG5cbi8qKlxuICogUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIENTUyBzdHlsZSBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvcGVydHlcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9ieXBhc3NDYWNoZVxuICogQHJldHVybiB7Kn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFN0eWxlKGVsZW1lbnQsIHByb3BlcnR5LCBvcHRfYnlwYXNzQ2FjaGUpIHtcbiAgY29uc3QgcHJvcGVydHlOYW1lID0gZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWUoZWxlbWVudC5zdHlsZSwgcHJvcGVydHksXG4gICAgICBvcHRfYnlwYXNzQ2FjaGUpO1xuICBpZiAoIXByb3BlcnR5TmFtZSkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgcmV0dXJuIGVsZW1lbnQuc3R5bGVbcHJvcGVydHlOYW1lXTtcbn1cblxuXG4vKipcbiAqIFNldHMgdGhlIENTUyBzdHlsZXMgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50LiBUaGUgc3R5bGVzXG4gKiBhIHNwZWNpZmllZCBhcyBhIG1hcCBmcm9tIENTUyBwcm9wZXJ0eSBuYW1lcyB0byB0aGVpciB2YWx1ZXMuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPn0gc3R5bGVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRTdHlsZXMoZWxlbWVudCwgc3R5bGVzKSB7XG4gIGZvciAoY29uc3QgayBpbiBzdHlsZXMpIHtcbiAgICBzZXRTdHlsZShlbGVtZW50LCBrLCBzdHlsZXNba10pO1xuICB9XG59XG5cblxuLyoqXG4gKiBTaG93cyBvciBoaWRlcyB0aGUgc3BlY2lmaWVkIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZGlzcGxheVxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlKGVsZW1lbnQsIG9wdF9kaXNwbGF5KSB7XG4gIGlmIChvcHRfZGlzcGxheSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgb3B0X2Rpc3BsYXkgPSBnZXRTdHlsZShlbGVtZW50LCAnZGlzcGxheScpID09ICdub25lJztcbiAgfVxuICBzZXRTdHlsZShlbGVtZW50LCAnZGlzcGxheScsIG9wdF9kaXNwbGF5ID8gJycgOiAnbm9uZScpO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHBpeGVsIHZhbHVlLlxuICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBweCh2YWx1ZSkge1xuICByZXR1cm4gYCR7dmFsdWV9cHhgO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBkZWdyZWUgdmFsdWUuXG4gKiBAcGFyYW0ge251bWJlcn0gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlZyh2YWx1ZSkge1xuICByZXR1cm4gYCR7dmFsdWV9ZGVnYDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgXCJ0cmFuc2xhdGVYXCIgZm9yIENTUyBcInRyYW5zZm9ybVwiIHByb3BlcnR5LlxuICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJhbnNsYXRlWCh2YWx1ZSkge1xuICBpZiAodHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGB0cmFuc2xhdGVYKCR7dmFsdWV9KWA7XG4gIH1cbiAgcmV0dXJuIGB0cmFuc2xhdGVYKCR7cHgodmFsdWUpfSlgO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIFwidHJhbnNsYXRlWFwiIGZvciBDU1MgXCJ0cmFuc2Zvcm1cIiBwcm9wZXJ0eS5cbiAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30geFxuICogQHBhcmFtIHsobnVtYmVyfHN0cmluZyk9fSBvcHRfeVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJhbnNsYXRlKHgsIG9wdF95KSB7XG4gIGlmICh0eXBlb2YgeCA9PSAnbnVtYmVyJykge1xuICAgIHggPSBweCh4KTtcbiAgfVxuICBpZiAob3B0X3kgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBgdHJhbnNsYXRlKCR7eH0pYDtcbiAgfVxuICBpZiAodHlwZW9mIG9wdF95ID09ICdudW1iZXInKSB7XG4gICAgb3B0X3kgPSBweChvcHRfeSk7XG4gIH1cbiAgcmV0dXJuIGB0cmFuc2xhdGUoJHt4fSwgJHtvcHRfeX0pYDtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBcInNjYWxlXCIgZm9yIENTUyBcInRyYW5zZm9ybVwiIHByb3BlcnR5LlxuICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2NhbGUodmFsdWUpIHtcbiAgcmV0dXJuIGBzY2FsZSgke3ZhbHVlfSlgO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBcInJvdGF0ZVwiIGZvciBDU1MgXCJ0cmFuc2Zvcm1cIiBwcm9wZXJ0eS5cbiAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJvdGF0ZSh2YWx1ZSkge1xuICBpZiAodHlwZW9mIHZhbHVlID09ICdudW1iZXInKSB7XG4gICAgdmFsdWUgPSBkZWcodmFsdWUpO1xuICB9XG4gIHJldHVybiBgcm90YXRlKCR7dmFsdWV9KWA7XG59XG5cbi8qKlxuICogUmVtb3ZlIGFscGhhIHZhbHVlIGZyb20gYSByZ2JhIGNvbG9yIHZhbHVlLlxuICogUmV0dXJuIHRoZSBuZXcgY29sb3IgcHJvcGVydHkgd2l0aCBhbHBoYSBlcXVhbHMgaWYgaGFzIHRoZSBhbHBoYSB2YWx1ZS5cbiAqIENhbGxlciBuZWVkcyB0byBtYWtlIHN1cmUgdGhlIGlucHV0IGNvbG9yIHZhbHVlIGlzIGEgdmFsaWQgcmdiYS9yZ2IgdmFsdWVcbiAqIEBwYXJhbSB7c3RyaW5nfSByZ2JhQ29sb3JcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUFscGhhRnJvbUNvbG9yKHJnYmFDb2xvcikge1xuICByZXR1cm4gcmdiYUNvbG9yLnJlcGxhY2UoXG4gICAgICAvXFwoKFteLF0rKSwoW14sXSspLChbXiwpXSspLFteKV0rXFwpL2csICcoJDEsJDIsJDMsIDEpJyk7XG59XG5cbi8qKlxuICogR2V0cyB0aGUgY29tcHV0ZWQgc3R5bGUgb2YgdGhlIGVsZW1lbnQuIFRoZSBoZWxwZXIgaXMgbmVjZXNzYXJ5IHRvIGVuZm9yY2VcbiAqIHRoZSBwb3NzaWJsZSBgbnVsbGAgdmFsdWUgcmV0dXJuZWQgYnkgYSBidWdneSBGaXJlZm94LlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbFxuICogQHJldHVybiB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb21wdXRlZFN0eWxlKHdpbiwgZWwpIHtcbiAgY29uc3Qgc3R5bGUgPSAvKiogQHR5cGUgez9DU1NTdHlsZURlY2xhcmF0aW9ufSAqLyh3aW4uZ2V0Q29tcHV0ZWRTdHlsZShlbCkpO1xuICByZXR1cm4gLyoqIEB0eXBlIHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn0gKi8oc3R5bGUpIHx8IG1hcCgpO1xufVxuXG5cbi8qKlxuICogUmVzZXRzIHN0eWxlcyB0aGF0IHdlcmUgc2V0IGR5bmFtaWNhbGx5IChpLmUuIGlubGluZSlcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHByb3BlcnRpZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0U3R5bGVzKGVsZW1lbnQsIHByb3BlcnRpZXMpIHtcbiAgY29uc3Qgc3R5bGVPYmogPSB7fTtcbiAgcHJvcGVydGllcy5mb3JFYWNoKHByb3AgPT4ge1xuICAgIHN0eWxlT2JqW3Byb3BdID0gbnVsbDtcbiAgfSk7XG4gIHNldFN0eWxlcyhlbGVtZW50LCBzdHlsZU9iaik7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyogQGNvbnN0ICovXG5jb25zdCB0b1N0cmluZ18gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXG4vKipcbiAqIFJldHVybnMgdGhlIEVDTUEgW1tDbGFzc11dIG9mIGEgdmFsdWVcbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gdG9TdHJpbmcodmFsdWUpIHtcbiAgcmV0dXJuIHRvU3RyaW5nXy5jYWxsKHZhbHVlKTtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmVzIGlmIHZhbHVlIGlzIGFjdHVhbGx5IGFuIEFycmF5LlxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQXJyYXkodmFsdWUpIHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkodmFsdWUpO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGFuIGFycmF5LWxpa2Ugb2JqZWN0IHRvIGFuIGFycmF5LlxuICogQHBhcmFtIHs/SUFycmF5TGlrZTxUPnxzdHJpbmd9IGFycmF5TGlrZVxuICogQHJldHVybiB7IUFycmF5PFQ+fVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvQXJyYXkoYXJyYXlMaWtlKSB7XG4gIGlmICghYXJyYXlMaWtlKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGNvbnN0IGFycmF5ID0gbmV3IEFycmF5KGFycmF5TGlrZS5sZW5ndGgpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5TGlrZS5sZW5ndGg7IGkrKykge1xuICAgIGFycmF5W2ldID0gYXJyYXlMaWtlW2ldO1xuICB9XG4gIHJldHVybiBhcnJheTtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmVzIGlmIHZhbHVlIGlzIGFjdHVhbGx5IGFuIE9iamVjdC5cbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc09iamVjdCh2YWx1ZSkge1xuICByZXR1cm4gdG9TdHJpbmcodmFsdWUpID09PSAnW29iamVjdCBPYmplY3RdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmVzIGlmIHZhbHVlIGlzIG9mIG51bWJlciB0eXBlIGFuZCBmaW5pdGUuXG4gKiBOYU4gYW5kIEluZmluaXR5IGFyZSBub3QgY29uc2lkZXJlZCBhIGZpbml0ZSBudW1iZXIuXG4gKiBTdHJpbmcgbnVtYmVycyBhcmUgbm90IGNvbnNpZGVyZWQgbnVtYmVycy5cbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Zpbml0ZU51bWJlcih2YWx1ZSkge1xuICByZXR1cm4gKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgJiYgaXNGaW5pdGUodmFsdWUpKTtcbn1cblxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciBgc2AgaXMgYSB2YWxpZCB2YWx1ZSBvZiBgZW51bU9iamAuXG4gKlxuICogQHBhcmFtIHshT2JqZWN0PFQ+fSBlbnVtT2JqXG4gKiBAcGFyYW0ge1R9IHNcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNFbnVtVmFsdWUoZW51bU9iaiwgcykge1xuICBmb3IgKGNvbnN0IGsgaW4gZW51bU9iaikge1xuICAgIGlmIChlbnVtT2JqW2tdID09PSBzKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIEV4dGVybnMgZGVjbGFyZSB0aGF0IGFjY2VzcyBgZGVmYXVsdFZpZXdgIGZyb20gYGRvY3VtZW50YCBvclxuICogYG93bmVyRG9jdW1lbnRgIGlzIG9mIHR5cGUgYChXaW5kb3d8bnVsbClgIGJ1dCBtb3N0IG9mIG91ciBwYXJhbWV0ZXIgdHlwZXNcbiAqIGFzc3VtZSB0aGF0IGl0IGlzIG5ldmVyIG51bGwuIFRoaXMgaXMgT0sgaW4gcHJhY3RpY2UgYXMgd2UgZXZlciBvbmx5IGdldFxuICogbnVsbCBvbiBkaXNjb25uZWN0ZWQgZG9jdW1lbnRzIG9yIG9sZCBJRS5cbiAqIFRoaXMgaGVscGVyIGZ1bmN0aW9uIGNhc3RzIGl0IGludG8ganVzdCBhIHNpbXBsZSBXaW5kb3cgcmV0dXJuIHR5cGUuXG4gKlxuICogQHBhcmFtIHshV2luZG93fG51bGx9IHdpbk9yTnVsbFxuICogQHJldHVybiB7IVdpbmRvd31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvV2luKHdpbk9yTnVsbCkge1xuICByZXR1cm4gLyoqIEB0eXBlIHshV2luZG93fSAqLyAod2luT3JOdWxsKTtcbn1cblxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7dHJ5RGVjb2RlVXJpQ29tcG9uZW50X30gZnJvbSAnLi91cmwtdHJ5LWRlY29kZS11cmktY29tcG9uZW50JztcblxuY29uc3QgcmVnZXggPSAvKD86XlsjP10/fCYpKFtePSZdKykoPzo9KFteJl0qKSk/L2c7XG5cbi8qKlxuICogUGFyc2VzIHRoZSBxdWVyeSBzdHJpbmcgb2YgYW4gVVJMLiBUaGlzIG1ldGhvZCByZXR1cm5zIGEgc2ltcGxlIGtleS92YWx1ZVxuICogbWFwLiBJZiB0aGVyZSBhcmUgZHVwbGljYXRlIGtleXMgdGhlIGxhdGVzdCB2YWx1ZSBpcyByZXR1cm5lZC5cbiAqXG4gKiBETyBOT1QgaW1wb3J0IHRoZSBmdW5jdGlvbiBmcm9tIHRoaXMgZmlsZS4gSW5zdGVhZCwgaW1wb3J0IHBhcnNlUXVlcnlTdHJpbmdcbiAqIGZyb20gYHNyYy91cmwuanNgLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBxdWVyeVN0cmluZ1xuICogQHJldHVybiB7IUpzb25PYmplY3R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVF1ZXJ5U3RyaW5nXyhxdWVyeVN0cmluZykge1xuICBjb25zdCBwYXJhbXMgPSAvKiogQHR5cGUgeyFKc29uT2JqZWN0fSAqLyAoT2JqZWN0LmNyZWF0ZShudWxsKSk7XG4gIGlmICghcXVlcnlTdHJpbmcpIHtcbiAgICByZXR1cm4gcGFyYW1zO1xuICB9XG5cbiAgbGV0IG1hdGNoO1xuICB3aGlsZSAoKG1hdGNoID0gcmVnZXguZXhlYyhxdWVyeVN0cmluZykpKSB7XG4gICAgY29uc3QgbmFtZSA9IHRyeURlY29kZVVyaUNvbXBvbmVudF8obWF0Y2hbMV0sIG1hdGNoWzFdKTtcbiAgICBjb25zdCB2YWx1ZSA9IG1hdGNoWzJdID8gdHJ5RGVjb2RlVXJpQ29tcG9uZW50XyhtYXRjaFsyXSwgbWF0Y2hbMl0pIDogJyc7XG4gICAgcGFyYW1zW25hbWVdID0gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIHBhcmFtcztcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIFRyaWVzIHRvIGRlY29kZSBhIFVSSSBjb21wb25lbnQsIGZhbGxpbmcgYmFjayB0byBvcHRfZmFsbGJhY2sgKG9yIGFuIGVtcHR5XG4gKiBzdHJpbmcpXG4gKlxuICogRE8gTk9UIGltcG9ydCB0aGUgZnVuY3Rpb24gZnJvbSB0aGlzIGZpbGUuIEluc3RlYWQsIGltcG9ydFxuICogdHJ5RGVjb2RlVXJpQ29tcG9uZW50IGZyb20gYHNyYy91cmwuanNgLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb21wb25lbnRcbiAqIEBwYXJhbSB7c3RyaW5nPX0gZmFsbGJhY2tcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyeURlY29kZVVyaUNvbXBvbmVudF8oY29tcG9uZW50LCBmYWxsYmFjayA9ICcnKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChjb21wb25lbnQpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbGxiYWNrO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtMcnVDYWNoZX0gZnJvbSAnLi91dGlscy9scnUtY2FjaGUnO1xuaW1wb3J0IHtkaWN0fSBmcm9tICcuL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge2VuZHNXaXRoLCBzdGFydHNXaXRofSBmcm9tICcuL3N0cmluZyc7XG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4vbW9kZSc7XG5pbXBvcnQge2lzQXJyYXl9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHtwYXJzZVF1ZXJ5U3RyaW5nX30gZnJvbSAnLi91cmwtcGFyc2UtcXVlcnktc3RyaW5nJztcbmltcG9ydCB7dHJ5RGVjb2RlVXJpQ29tcG9uZW50X30gZnJvbSAnLi91cmwtdHJ5LWRlY29kZS11cmktY29tcG9uZW50JztcbmltcG9ydCB7dXJsc30gZnJvbSAnLi9jb25maWcnO1xuaW1wb3J0IHt1c2VyfSBmcm9tICcuL2xvZyc7XG5cbi8qKlxuICogQHR5cGUgeyFKc29uT2JqZWN0fVxuICovXG5jb25zdCBTRVJWSU5HX1RZUEVfUFJFRklYID0gZGljdCh7XG4gIC8vIE5vIHZpZXdlclxuICAnYyc6IHRydWUsXG4gIC8vIEluIHZpZXdlclxuICAndic6IHRydWUsXG4gIC8vIEFkIGxhbmRpbmcgcGFnZVxuICAnYSc6IHRydWUsXG4gIC8vIEFkXG4gICdhZCc6IHRydWUsXG59KTtcblxuLyoqXG4gKiBDYWNoZWQgYS10YWcgdG8gYXZvaWQgbWVtb3J5IGFsbG9jYXRpb24gZHVyaW5nIFVSTCBwYXJzaW5nLlxuICogQHR5cGUge0hUTUxBbmNob3JFbGVtZW50fVxuICovXG5sZXQgYTtcblxuLyoqXG4gKiBXZSBjYWNoZWQgYWxsIHBhcnNlZCBVUkxzLiBBcyBvZiBub3cgdGhlcmUgYXJlIG5vIHVzZSBjYXNlc1xuICogb2YgQU1QIGRvY3MgdGhhdCB3b3VsZCBldmVyIHBhcnNlIGFuIGFjdHVhbCBsYXJnZSBudW1iZXIgb2YgVVJMcyxcbiAqIGJ1dCB3ZSBvZnRlbiBwYXJzZSB0aGUgc2FtZSBvbmUgb3ZlciBhbmQgb3ZlciBhZ2Fpbi5cbiAqIEB0eXBlIHtMcnVDYWNoZX1cbiAqL1xubGV0IGNhY2hlO1xuXG4vKiogQHByaXZhdGUgQGNvbnN0IE1hdGNoZXMgYW1wX2pzXyogcGFyYW1ldGVycyBpbiBxdWVyeSBzdHJpbmcuICovXG5jb25zdCBBTVBfSlNfUEFSQU1TX1JFR0VYID0gL1s/Jl1hbXBfanNbXiZdKi87XG5cbi8qKiBAcHJpdmF0ZSBAY29uc3QgTWF0Y2hlcyBhbXBfZ3NhIHBhcmFtZXRlcnMgaW4gcXVlcnkgc3RyaW5nLiAqL1xuY29uc3QgQU1QX0dTQV9QQVJBTVNfUkVHRVggPSAvWz8mXWFtcF9nc2FbXiZdKi87XG5cbi8qKiBAcHJpdmF0ZSBAY29uc3QgTWF0Y2hlcyBhbXBfciBwYXJhbWV0ZXJzIGluIHF1ZXJ5IHN0cmluZy4gKi9cbmNvbnN0IEFNUF9SX1BBUkFNU19SRUdFWCA9IC9bPyZdYW1wX3JbXiZdKi87XG5cbi8qKiBAcHJpdmF0ZSBAY29uc3QgTWF0Y2hlcyB1c3FwIHBhcmFtZXRlcnMgZnJvbSBnb29nIGV4cGVyaW1lbnQgaW4gcXVlcnkgc3RyaW5nLiAqL1xuY29uc3QgR09PR0xFX0VYUEVSSU1FTlRfUEFSQU1TX1JFR0VYID0gL1s/Jl11c3FwW14mXSovO1xuXG5jb25zdCBJTlZBTElEX1BST1RPQ09MUyA9IFtcbiAgLyplc2xpbnQgbm8tc2NyaXB0LXVybDogMCovICdqYXZhc2NyaXB0OicsXG4gIC8qZXNsaW50IG5vLXNjcmlwdC11cmw6IDAqLyAnZGF0YTonLFxuICAvKmVzbGludCBuby1zY3JpcHQtdXJsOiAwKi8gJ3Zic2NyaXB0OicsXG5dO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgU09VUkNFX09SSUdJTl9QQVJBTSA9ICdfX2FtcF9zb3VyY2Vfb3JpZ2luJztcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBjb3JyZWN0IG9yaWdpbiBmb3IgYSBnaXZlbiB3aW5kb3cuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7c3RyaW5nfSBvcmlnaW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFdpbk9yaWdpbih3aW4pIHtcbiAgcmV0dXJuIHdpbi5vcmlnaW4gfHwgcGFyc2VVcmxEZXByZWNhdGVkKHdpbi5sb2NhdGlvbi5ocmVmKS5vcmlnaW47XG59XG5cbi8qKlxuICogUmV0dXJucyBhIExvY2F0aW9uLWxpa2Ugb2JqZWN0IGZvciB0aGUgZ2l2ZW4gVVJMLiBJZiBpdCBpcyByZWxhdGl2ZSxcbiAqIHRoZSBVUkwgZ2V0cyByZXNvbHZlZC5cbiAqIENvbnNpZGVyIHRoZSByZXR1cm5lZCBvYmplY3QgaW1tdXRhYmxlLiBUaGlzIGlzIGVuZm9yY2VkIGR1cmluZ1xuICogdGVzdGluZyBieSBmcmVlemluZyB0aGUgb2JqZWN0LlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X25vY2FjaGVcbiAqIEByZXR1cm4geyFMb2NhdGlvbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwsIG9wdF9ub2NhY2hlKSB7XG4gIGlmICghYSkge1xuICAgIGEgPSAvKiogQHR5cGUgeyFIVE1MQW5jaG9yRWxlbWVudH0gKi8gKHNlbGYuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpKTtcbiAgICBjYWNoZSA9IHNlbGYuVXJsQ2FjaGUgfHwgKHNlbGYuVXJsQ2FjaGUgPSBuZXcgTHJ1Q2FjaGUoMTAwKSk7XG4gIH1cblxuICByZXR1cm4gcGFyc2VVcmxXaXRoQShhLCB1cmwsIG9wdF9ub2NhY2hlID8gbnVsbCA6IGNhY2hlKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgTG9jYXRpb24tbGlrZSBvYmplY3QgZm9yIHRoZSBnaXZlbiBVUkwuIElmIGl0IGlzIHJlbGF0aXZlLFxuICogdGhlIFVSTCBnZXRzIHJlc29sdmVkLlxuICogQ29uc2lkZXIgdGhlIHJldHVybmVkIG9iamVjdCBpbW11dGFibGUuIFRoaXMgaXMgZW5mb3JjZWQgZHVyaW5nXG4gKiB0ZXN0aW5nIGJ5IGZyZWV6aW5nIHRoZSBvYmplY3QuXG4gKiBAcGFyYW0geyFIVE1MQW5jaG9yRWxlbWVudH0gYVxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHBhcmFtIHtMcnVDYWNoZT19IG9wdF9jYWNoZVxuICogQHJldHVybiB7IUxvY2F0aW9ufVxuICogQHJlc3RyaWN0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlVXJsV2l0aEEoYSwgdXJsLCBvcHRfY2FjaGUpIHtcbiAgaWYgKG9wdF9jYWNoZSAmJiBvcHRfY2FjaGUuaGFzKHVybCkpIHtcbiAgICByZXR1cm4gb3B0X2NhY2hlLmdldCh1cmwpO1xuICB9XG5cbiAgYS5ocmVmID0gdXJsO1xuXG4gIC8vIElFMTEgZG9lc24ndCBwcm92aWRlIGZ1bGwgVVJMIGNvbXBvbmVudHMgd2hlbiBwYXJzaW5nIHJlbGF0aXZlIFVSTHMuXG4gIC8vIEFzc2lnbmluZyB0byBpdHNlbGYgYWdhaW4gZG9lcyB0aGUgdHJpY2sgIzM0NDkuXG4gIGlmICghYS5wcm90b2NvbCkge1xuICAgIGEuaHJlZiA9IGEuaHJlZjtcbiAgfVxuXG4gIGNvbnN0IGluZm8gPSAvKiogQHR5cGUgeyFMb2NhdGlvbn0gKi8oe1xuICAgIGhyZWY6IGEuaHJlZixcbiAgICBwcm90b2NvbDogYS5wcm90b2NvbCxcbiAgICBob3N0OiBhLmhvc3QsXG4gICAgaG9zdG5hbWU6IGEuaG9zdG5hbWUsXG4gICAgcG9ydDogYS5wb3J0ID09ICcwJyA/ICcnIDogYS5wb3J0LFxuICAgIHBhdGhuYW1lOiBhLnBhdGhuYW1lLFxuICAgIHNlYXJjaDogYS5zZWFyY2gsXG4gICAgaGFzaDogYS5oYXNoLFxuICAgIG9yaWdpbjogbnVsbCwgLy8gU2V0IGJlbG93LlxuICB9KTtcblxuICAvLyBTb21lIElFMTEgc3BlY2lmaWMgcG9seWZpbGxzLlxuICAvLyAxKSBJRTExIHN0cmlwcyBvdXQgdGhlIGxlYWRpbmcgJy8nIGluIHRoZSBwYXRobmFtZS5cbiAgaWYgKGluZm8ucGF0aG5hbWVbMF0gIT09ICcvJykge1xuICAgIGluZm8ucGF0aG5hbWUgPSAnLycgKyBpbmZvLnBhdGhuYW1lO1xuICB9XG5cbiAgLy8gMikgRm9yIFVSTHMgd2l0aCBpbXBsaWNpdCBwb3J0cywgSUUxMSBwYXJzZXMgdG8gZGVmYXVsdCBwb3J0cyB3aGlsZVxuICAvLyBvdGhlciBicm93c2VycyBsZWF2ZSB0aGUgcG9ydCBmaWVsZCBlbXB0eS5cbiAgaWYgKChpbmZvLnByb3RvY29sID09ICdodHRwOicgJiYgaW5mby5wb3J0ID09IDgwKVxuICAgICAgfHwgKGluZm8ucHJvdG9jb2wgPT0gJ2h0dHBzOicgJiYgaW5mby5wb3J0ID09IDQ0MykpIHtcbiAgICBpbmZvLnBvcnQgPSAnJztcbiAgICBpbmZvLmhvc3QgPSBpbmZvLmhvc3RuYW1lO1xuICB9XG5cbiAgLy8gRm9yIGRhdGEgVVJJIGEub3JpZ2luIGlzIGVxdWFsIHRvIHRoZSBzdHJpbmcgJ251bGwnIHdoaWNoIGlzIG5vdCB1c2VmdWwuXG4gIC8vIFdlIGluc3RlYWQgcmV0dXJuIHRoZSBhY3R1YWwgb3JpZ2luIHdoaWNoIGlzIHRoZSBmdWxsIFVSTC5cbiAgaWYgKGEub3JpZ2luICYmIGEub3JpZ2luICE9ICdudWxsJykge1xuICAgIGluZm8ub3JpZ2luID0gYS5vcmlnaW47XG4gIH0gZWxzZSBpZiAoaW5mby5wcm90b2NvbCA9PSAnZGF0YTonIHx8ICFpbmZvLmhvc3QpIHtcbiAgICBpbmZvLm9yaWdpbiA9IGluZm8uaHJlZjtcbiAgfSBlbHNlIHtcbiAgICBpbmZvLm9yaWdpbiA9IGluZm8ucHJvdG9jb2wgKyAnLy8nICsgaW5mby5ob3N0O1xuICB9XG5cbiAgLy8gRnJlZXplIGR1cmluZyB0ZXN0aW5nIHRvIGF2b2lkIGFjY2lkZW50YWwgbXV0YXRpb24uXG4gIGNvbnN0IGZyb3plbiA9IChnZXRNb2RlKCkudGVzdCAmJiBPYmplY3QuZnJlZXplKSA/IE9iamVjdC5mcmVlemUoaW5mbykgOiBpbmZvO1xuXG4gIGlmIChvcHRfY2FjaGUpIHtcbiAgICBvcHRfY2FjaGUucHV0KHVybCwgZnJvemVuKTtcbiAgfVxuXG4gIHJldHVybiBmcm96ZW47XG59XG5cbi8qKlxuICogQXBwZW5kcyB0aGUgc3RyaW5nIGp1c3QgYmVmb3JlIHRoZSBmcmFnbWVudCBwYXJ0IChvciBvcHRpb25hbGx5XG4gKiB0byB0aGUgZnJvbnQgb2YgdGhlIHF1ZXJ5IHN0cmluZykgb2YgdGhlIFVSTC5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXJhbVN0cmluZ1xuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2FkZFRvRnJvbnRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGVuZEVuY29kZWRQYXJhbVN0cmluZ1RvVXJsKHVybCwgcGFyYW1TdHJpbmcsXG4gIG9wdF9hZGRUb0Zyb250KSB7XG4gIGlmICghcGFyYW1TdHJpbmcpIHtcbiAgICByZXR1cm4gdXJsO1xuICB9XG4gIGNvbnN0IG1haW5BbmRGcmFnbWVudCA9IHVybC5zcGxpdCgnIycsIDIpO1xuICBjb25zdCBtYWluQW5kUXVlcnkgPSBtYWluQW5kRnJhZ21lbnRbMF0uc3BsaXQoJz8nLCAyKTtcblxuICBsZXQgbmV3VXJsID0gbWFpbkFuZFF1ZXJ5WzBdICsgKFxuICAgIG1haW5BbmRRdWVyeVsxXVxuICAgICAgPyAob3B0X2FkZFRvRnJvbnRcbiAgICAgICAgPyBgPyR7cGFyYW1TdHJpbmd9JiR7bWFpbkFuZFF1ZXJ5WzFdfWBcbiAgICAgICAgOiBgPyR7bWFpbkFuZFF1ZXJ5WzFdfSYke3BhcmFtU3RyaW5nfWApXG4gICAgICA6IGA/JHtwYXJhbVN0cmluZ31gKTtcbiAgbmV3VXJsICs9IG1haW5BbmRGcmFnbWVudFsxXSA/IGAjJHttYWluQW5kRnJhZ21lbnRbMV19YCA6ICcnO1xuICByZXR1cm4gbmV3VXJsO1xufVxuLyoqXG4gKiBBcHBlbmRzIGEgcXVlcnkgc3RyaW5nIGZpZWxkIGFuZCB2YWx1ZSB0byBhIHVybC4gYGtleWAgYW5kIGB2YWx1ZWBcbiAqIHdpbGwgYmUgcmFuIHRocm91Z2ggYGVuY29kZVVSSUNvbXBvbmVudGAgYmVmb3JlIGFwcGVuZGluZy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXlcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2FkZFRvRnJvbnRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZFBhcmFtVG9VcmwodXJsLCBrZXksIHZhbHVlLCBvcHRfYWRkVG9Gcm9udCkge1xuICBjb25zdCBmaWVsZCA9IGAke2VuY29kZVVSSUNvbXBvbmVudChrZXkpfT0ke2VuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSl9YDtcbiAgcmV0dXJuIGFwcGVuZEVuY29kZWRQYXJhbVN0cmluZ1RvVXJsKHVybCwgZmllbGQsIG9wdF9hZGRUb0Zyb250KTtcbn1cblxuLyoqXG4gKiBBcHBlbmRzIHF1ZXJ5IHN0cmluZyBmaWVsZHMgYW5kIHZhbHVlcyB0byBhIHVybC4gVGhlIGBwYXJhbXNgIG9iamVjdHMnXG4gKiBga2V5YHMgYW5kIGB2YWx1ZWBzIHdpbGwgYmUgdHJhbnNmb3JtZWQgaW50byBxdWVyeSBzdHJpbmcga2V5cy92YWx1ZXMuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0PHN0cmluZywgc3RyaW5nfCFBcnJheTxzdHJpbmc+Pn0gcGFyYW1zXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGRQYXJhbXNUb1VybCh1cmwsIHBhcmFtcykge1xuICByZXR1cm4gYXBwZW5kRW5jb2RlZFBhcmFtU3RyaW5nVG9VcmwodXJsLCBzZXJpYWxpemVRdWVyeVN0cmluZyhwYXJhbXMpKTtcbn1cblxuLyoqXG4gKiBTZXJpYWxpemVzIHRoZSBwYXNzZWQgcGFyYW1ldGVyIG1hcCBpbnRvIGEgcXVlcnkgc3RyaW5nIHdpdGggYm90aCBrZXlzXG4gKiBhbmQgdmFsdWVzIGVuY29kZWQuXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0PHN0cmluZywgc3RyaW5nfCFBcnJheTxzdHJpbmc+Pn0gcGFyYW1zXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXJpYWxpemVRdWVyeVN0cmluZyhwYXJhbXMpIHtcbiAgY29uc3QgcyA9IFtdO1xuICBmb3IgKGNvbnN0IGsgaW4gcGFyYW1zKSB7XG4gICAgY29uc3QgdiA9IHBhcmFtc1trXTtcbiAgICBpZiAodiA9PSBudWxsKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9IGVsc2UgaWYgKGlzQXJyYXkodikpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdi5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBzdiA9IC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAodltpXSk7XG4gICAgICAgIHMucHVzaChgJHtlbmNvZGVVUklDb21wb25lbnQoayl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHN2KX1gKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgc3YgPSAvKiogQHR5cGUge3N0cmluZ30gKi8gKHYpO1xuICAgICAgcy5wdXNoKGAke2VuY29kZVVSSUNvbXBvbmVudChrKX09JHtlbmNvZGVVUklDb21wb25lbnQoc3YpfWApO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcy5qb2luKCcmJyk7XG59XG5cbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIFVSTCBpcyBzZWN1cmU6IGVpdGhlciBIVFRQUyBvciBsb2NhbGhvc3QgKGZvciB0ZXN0aW5nKS5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNTZWN1cmVVcmxEZXByZWNhdGVkKHVybCkge1xuICBpZiAodHlwZW9mIHVybCA9PSAnc3RyaW5nJykge1xuICAgIHVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICB9XG4gIHJldHVybiAodXJsLnByb3RvY29sID09ICdodHRwczonIHx8XG4gICAgICB1cmwuaG9zdG5hbWUgPT0gJ2xvY2FsaG9zdCcgfHxcbiAgICAgIGVuZHNXaXRoKHVybC5ob3N0bmFtZSwgJy5sb2NhbGhvc3QnKSk7XG59XG5cbi8qKlxuICogQXNzZXJ0cyB0aGF0IGEgZ2l2ZW4gdXJsIGlzIEhUVFBTIG9yIHByb3RvY29sIHJlbGF0aXZlLiBJdCdzIGEgdXNlci1sZXZlbFxuICogYXNzZXJ0LlxuICpcbiAqIFByb3ZpZGVzIGFuIGV4Y2VwdGlvbiBmb3IgbG9jYWxob3N0LlxuICpcbiAqIEBwYXJhbSB7P3N0cmluZ3x1bmRlZmluZWR9IHVybFN0cmluZ1xuICogQHBhcmFtIHshRWxlbWVudHxzdHJpbmd9IGVsZW1lbnRDb250ZXh0IEVsZW1lbnQgd2hlcmUgdGhlIHVybCB3YXMgZm91bmQuXG4gKiBAcGFyYW0ge3N0cmluZz19IHNvdXJjZU5hbWUgVXNlZCBmb3IgZXJyb3IgbWVzc2FnZXMuXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRIdHRwc1VybChcbiAgdXJsU3RyaW5nLCBlbGVtZW50Q29udGV4dCwgc291cmNlTmFtZSA9ICdzb3VyY2UnKSB7XG4gIHVzZXIoKS5hc3NlcnQodXJsU3RyaW5nICE9IG51bGwsICclcyAlcyBtdXN0IGJlIGF2YWlsYWJsZScsXG4gICAgICBlbGVtZW50Q29udGV4dCwgc291cmNlTmFtZSk7XG4gIC8vIChlcndpbm0sICM0NTYwKTogdHlwZSBjYXN0IG5lY2Vzc2FyeSB1bnRpbCAjNDU2MCBpcyBmaXhlZC5cbiAgY29uc3QgdGhlVXJsU3RyaW5nID0gLyoqIEB0eXBlIHtzdHJpbmd9ICovICh1cmxTdHJpbmcpO1xuICB1c2VyKCkuYXNzZXJ0KGlzU2VjdXJlVXJsRGVwcmVjYXRlZCh0aGVVcmxTdHJpbmcpIHx8IC9eKFxcL1xcLykvLnRlc3QodGhlVXJsU3RyaW5nKSxcbiAgICAgICclcyAlcyBtdXN0IHN0YXJ0IHdpdGggJyArXG4gICAgICAnXCJodHRwczovL1wiIG9yIFwiLy9cIiBvciBiZSByZWxhdGl2ZSBhbmQgc2VydmVkIGZyb20gJyArXG4gICAgICAnZWl0aGVyIGh0dHBzIG9yIGZyb20gbG9jYWxob3N0LiBJbnZhbGlkIHZhbHVlOiAlcycsXG4gICAgICBlbGVtZW50Q29udGV4dCwgc291cmNlTmFtZSwgdGhlVXJsU3RyaW5nKTtcbiAgcmV0dXJuIHRoZVVybFN0cmluZztcbn1cblxuLyoqXG4gKiBBc3NlcnRzIHRoYXQgYSBnaXZlbiB1cmwgaXMgYW4gYWJzb2x1dGUgSFRUUCBvciBIVFRQUyBVUkwuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsU3RyaW5nXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRBYnNvbHV0ZUh0dHBPckh0dHBzVXJsKHVybFN0cmluZykge1xuICB1c2VyKCkuYXNzZXJ0KC9eaHR0cHM/XFw6L2kudGVzdCh1cmxTdHJpbmcpLFxuICAgICAgJ1VSTCBtdXN0IHN0YXJ0IHdpdGggXCJodHRwOi8vXCIgb3IgXCJodHRwczovL1wiLiBJbnZhbGlkIHZhbHVlOiAlcycsXG4gICAgICB1cmxTdHJpbmcpO1xuICByZXR1cm4gcGFyc2VVcmxEZXByZWNhdGVkKHVybFN0cmluZykuaHJlZjtcbn1cblxuXG4vKipcbiAqIFBhcnNlcyB0aGUgcXVlcnkgc3RyaW5nIG9mIGFuIFVSTC4gVGhpcyBtZXRob2QgcmV0dXJucyBhIHNpbXBsZSBrZXkvdmFsdWVcbiAqIG1hcC4gSWYgdGhlcmUgYXJlIGR1cGxpY2F0ZSBrZXlzIHRoZSBsYXRlc3QgdmFsdWUgaXMgcmV0dXJuZWQuXG4gKlxuICogVGhpcyBmdW5jdGlvbiBpcyBpbXBsZW1lbnRlZCBpbiBhIHNlcGFyYXRlIGZpbGUgdG8gYXZvaWQgYSBjaXJjdWxhclxuICogZGVwZW5kZW5jeS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcXVlcnlTdHJpbmdcbiAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VRdWVyeVN0cmluZyhxdWVyeVN0cmluZykge1xuICByZXR1cm4gcGFyc2VRdWVyeVN0cmluZ18ocXVlcnlTdHJpbmcpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIFVSTCB3aXRob3V0IGZyYWdtZW50LiBJZiBVUkwgZG9lc24ndCBjb250YWluIGZyYWdtZW50LCB0aGUgc2FtZVxuICogc3RyaW5nIGlzIHJldHVybmVkLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlRnJhZ21lbnQodXJsKSB7XG4gIGNvbnN0IGluZGV4ID0gdXJsLmluZGV4T2YoJyMnKTtcbiAgaWYgKGluZGV4ID09IC0xKSB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxuICByZXR1cm4gdXJsLnN1YnN0cmluZygwLCBpbmRleCk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZnJhZ21lbnQgZnJvbSB0aGUgVVJMLiBJZiB0aGUgVVJMIGRvZXNuJ3QgY29udGFpbiBmcmFnbWVudCxcbiAqIHRoZSBlbXB0eSBzdHJpbmcgaXMgcmV0dXJuZWQuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRGcmFnbWVudCh1cmwpIHtcbiAgY29uc3QgaW5kZXggPSB1cmwuaW5kZXhPZignIycpO1xuICBpZiAoaW5kZXggPT0gLTEpIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbiAgcmV0dXJuIHVybC5zdWJzdHJpbmcoaW5kZXgpO1xufVxuXG4vKipcbiAqIFJldHVybnMgd2hldGhlciB0aGUgVVJMIGhhcyB0aGUgb3JpZ2luIG9mIGEgcHJveHkuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybCBVUkwgb2YgYW4gQU1QIGRvY3VtZW50LlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzUHJveHlPcmlnaW4odXJsKSB7XG4gIGlmICh0eXBlb2YgdXJsID09ICdzdHJpbmcnKSB7XG4gICAgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIH1cbiAgcmV0dXJuIHVybHMuY2RuUHJveHlSZWdleC50ZXN0KHVybC5vcmlnaW4pO1xufVxuXG4vKipcbiAqIEZvciBwcm94eS1vcmlnaW4gVVJMcywgcmV0dXJucyB0aGUgc2VydmluZyB0eXBlLiBPdGhlcndpc2UsIHJldHVybnMgbnVsbC5cbiAqIEUuZy4sICdodHRwczovL2FtcC1jb20uY2RuLmFtcHByb2plY3Qub3JnL2Evcy9hbXAuY29tL2FtcF9kb2N1bWVudC5odG1sJ1xuICogcmV0dXJucyAnYScuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybCBVUkwgb2YgYW4gQU1QIGRvY3VtZW50LlxuICogQHJldHVybiB7P3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFByb3h5U2VydmluZ1R5cGUodXJsKSB7XG4gIGlmICh0eXBlb2YgdXJsID09ICdzdHJpbmcnKSB7XG4gICAgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIH1cbiAgaWYgKCFpc1Byb3h5T3JpZ2luKHVybCkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBwYXRoID0gdXJsLnBhdGhuYW1lLnNwbGl0KCcvJywgMik7XG4gIHJldHVybiBwYXRoWzFdO1xufVxuXG4vKipcbiAqIFJldHVybnMgd2hldGhlciB0aGUgVVJMIG9yaWdpbiBpcyBsb2NhbGhvc3QuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybCBVUkwgb2YgYW4gQU1QIGRvY3VtZW50LlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTG9jYWxob3N0T3JpZ2luKHVybCkge1xuICBpZiAodHlwZW9mIHVybCA9PSAnc3RyaW5nJykge1xuICAgIHVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICB9XG4gIHJldHVybiB1cmxzLmxvY2FsaG9zdFJlZ2V4LnRlc3QodXJsLm9yaWdpbik7XG59XG5cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBVUkwgaGFzIHZhbGlkIHByb3RvY29sLlxuICogRGVlcCBsaW5rIHByb3RvY29sIGlzIHZhbGlkLCBidXQgbm90IGphdmFzY3JpcHQgZXRjLlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmxcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1Byb3RvY29sVmFsaWQodXJsKSB7XG4gIGlmICghdXJsKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgaWYgKHR5cGVvZiB1cmwgPT0gJ3N0cmluZycpIHtcbiAgICB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgfVxuICByZXR1cm4gIUlOVkFMSURfUFJPVE9DT0xTLmluY2x1ZGVzKHVybC5wcm90b2NvbCk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIFVSTCB3aXRob3V0IEFNUCBKUyBwYXJhbWV0ZXJzLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlQW1wSnNQYXJhbXNGcm9tVXJsKHVybCkge1xuICBjb25zdCBwYXJzZWQgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgY29uc3Qgc2VhcmNoID0gcmVtb3ZlQW1wSnNQYXJhbXNGcm9tU2VhcmNoKHBhcnNlZC5zZWFyY2gpO1xuICByZXR1cm4gcGFyc2VkLm9yaWdpbiArIHBhcnNlZC5wYXRobmFtZSArIHNlYXJjaCArIHBhcnNlZC5oYXNoO1xuXG59XG5cbi8qKlxuICogUmV0dXJucyBhIFVSTCB3aXRob3V0IGEgcXVlcnkgc3RyaW5nLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlU2VhcmNoKHVybCkge1xuICBjb25zdCBpbmRleCA9IHVybC5pbmRleE9mKCc/Jyk7XG4gIGlmIChpbmRleCA9PSAtMSkge1xuICAgIHJldHVybiB1cmw7XG4gIH1cbiAgY29uc3QgZnJhZ21lbnQgPSBnZXRGcmFnbWVudCh1cmwpO1xuICByZXR1cm4gdXJsLnN1YnN0cmluZygwLCBpbmRleCkgKyBmcmFnbWVudDtcbn1cblxuLyoqXG4gKiBSZW1vdmVzIHBhcmFtZXRlcnMgdGhhdCBzdGFydCB3aXRoIGFtcCBqcyBwYXJhbWV0ZXIgcGF0dGVybiBhbmQgcmV0dXJucyB0aGVcbiAqIG5ldyBzZWFyY2ggc3RyaW5nLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFNlYXJjaFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiByZW1vdmVBbXBKc1BhcmFtc0Zyb21TZWFyY2godXJsU2VhcmNoKSB7XG4gIGlmICghdXJsU2VhcmNoIHx8IHVybFNlYXJjaCA9PSAnPycpIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbiAgY29uc3Qgc2VhcmNoID0gdXJsU2VhcmNoXG4gICAgICAucmVwbGFjZShBTVBfSlNfUEFSQU1TX1JFR0VYLCAnJylcbiAgICAgIC5yZXBsYWNlKEFNUF9HU0FfUEFSQU1TX1JFR0VYLCAnJylcbiAgICAgIC5yZXBsYWNlKEFNUF9SX1BBUkFNU19SRUdFWCwgJycpXG4gICAgICAucmVwbGFjZShHT09HTEVfRVhQRVJJTUVOVF9QQVJBTVNfUkVHRVgsICcnKVxuICAgICAgLnJlcGxhY2UoL15bPyZdLywgJycpOyAvLyBSZW1vdmVzIGZpcnN0ID8gb3IgJi5cbiAgcmV0dXJuIHNlYXJjaCA/ICc/JyArIHNlYXJjaCA6ICcnO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHNvdXJjZSBVUkwgb2YgYW4gQU1QIGRvY3VtZW50IGZvciBkb2N1bWVudHMgc2VydmVkXG4gKiBvbiBhIHByb3h5IG9yaWdpbiBvciBkaXJlY3RseS5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsIFVSTCBvZiBhbiBBTVAgZG9jdW1lbnQuXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTb3VyY2VVcmwodXJsKSB7XG4gIGlmICh0eXBlb2YgdXJsID09ICdzdHJpbmcnKSB7XG4gICAgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIH1cblxuICAvLyBOb3QgYSBwcm94eSBVUkwgLSByZXR1cm4gdGhlIFVSTCBpdHNlbGYuXG4gIGlmICghaXNQcm94eU9yaWdpbih1cmwpKSB7XG4gICAgcmV0dXJuIHVybC5ocmVmO1xuICB9XG5cbiAgLy8gQSBwcm94eSBVUkwuXG4gIC8vIEV4YW1wbGUgcGF0aCB0aGF0IGlzIGJlaW5nIG1hdGNoZWQgaGVyZS5cbiAgLy8gaHR0cHM6Ly9jZG4uYW1wcHJvamVjdC5vcmcvYy9zL3d3dy5vcmlnaW4uY29tL2Zvby9cbiAgLy8gVGhlIC9zLyBpcyBvcHRpb25hbCBhbmQgc2lnbmFscyBhIHNlY3VyZSBvcmlnaW4uXG4gIGNvbnN0IHBhdGggPSB1cmwucGF0aG5hbWUuc3BsaXQoJy8nKTtcbiAgY29uc3QgcHJlZml4ID0gcGF0aFsxXTtcbiAgdXNlcigpLmFzc2VydChTRVJWSU5HX1RZUEVfUFJFRklYW3ByZWZpeF0sXG4gICAgICAnVW5rbm93biBwYXRoIHByZWZpeCBpbiB1cmwgJXMnLCB1cmwuaHJlZik7XG4gIGNvbnN0IGRvbWFpbk9ySHR0cHNTaWduYWwgPSBwYXRoWzJdO1xuICBjb25zdCBvcmlnaW4gPSBkb21haW5Pckh0dHBzU2lnbmFsID09ICdzJ1xuICAgID8gJ2h0dHBzOi8vJyArIGRlY29kZVVSSUNvbXBvbmVudChwYXRoWzNdKVxuICAgIDogJ2h0dHA6Ly8nICsgZGVjb2RlVVJJQ29tcG9uZW50KGRvbWFpbk9ySHR0cHNTaWduYWwpO1xuICAvLyBTYW5pdHkgdGVzdCB0aGF0IHdoYXQgd2UgZm91bmQgbG9va3MgbGlrZSBhIGRvbWFpbi5cbiAgdXNlcigpLmFzc2VydChvcmlnaW4uaW5kZXhPZignLicpID4gMCwgJ0V4cGVjdGVkIGEgLiBpbiBvcmlnaW4gJXMnLCBvcmlnaW4pO1xuICBwYXRoLnNwbGljZSgxLCBkb21haW5Pckh0dHBzU2lnbmFsID09ICdzJyA/IDMgOiAyKTtcbiAgcmV0dXJuIG9yaWdpbiArIHBhdGguam9pbignLycpICtcbiAgICAgIHJlbW92ZUFtcEpzUGFyYW1zRnJvbVNlYXJjaCh1cmwuc2VhcmNoKSArICh1cmwuaGFzaCB8fCAnJyk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgc291cmNlIG9yaWdpbiBvZiBhbiBBTVAgZG9jdW1lbnQgZm9yIGRvY3VtZW50cyBzZXJ2ZWRcbiAqIG9uIGEgcHJveHkgb3JpZ2luIG9yIGRpcmVjdGx5LlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmwgVVJMIG9mIGFuIEFNUCBkb2N1bWVudC5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHNvdXJjZSBvcmlnaW4gb2YgdGhlIFVSTC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNvdXJjZU9yaWdpbih1cmwpIHtcbiAgcmV0dXJuIHBhcnNlVXJsRGVwcmVjYXRlZChnZXRTb3VyY2VVcmwodXJsKSkub3JpZ2luO1xufVxuXG4vKipcbiAqIFJldHVybnMgYWJzb2x1dGUgVVJMIHJlc29sdmVkIGJhc2VkIG9uIHRoZSByZWxhdGl2ZSBVUkwgYW5kIHRoZSBiYXNlLlxuICogQHBhcmFtIHtzdHJpbmd9IHJlbGF0aXZlVXJsU3RyaW5nXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IGJhc2VVcmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVSZWxhdGl2ZVVybChyZWxhdGl2ZVVybFN0cmluZywgYmFzZVVybCkge1xuICBpZiAodHlwZW9mIGJhc2VVcmwgPT0gJ3N0cmluZycpIHtcbiAgICBiYXNlVXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKGJhc2VVcmwpO1xuICB9XG4gIGlmICh0eXBlb2YgVVJMID09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm4gbmV3IFVSTChyZWxhdGl2ZVVybFN0cmluZywgYmFzZVVybC5ocmVmKS50b1N0cmluZygpO1xuICB9XG4gIHJldHVybiByZXNvbHZlUmVsYXRpdmVVcmxGYWxsYmFja18ocmVsYXRpdmVVcmxTdHJpbmcsIGJhc2VVcmwpO1xufVxuXG4vKipcbiAqIEZhbGxiYWNrIGZvciBVUkwgcmVzb2x2ZXIgd2hlbiBVUkwgY2xhc3MgaXMgbm90IGF2YWlsYWJsZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSByZWxhdGl2ZVVybFN0cmluZ1xuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSBiYXNlVXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKiBAcHJpdmF0ZSBWaXNpYmxlIGZvciB0ZXN0aW5nLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZVJlbGF0aXZlVXJsRmFsbGJhY2tfKHJlbGF0aXZlVXJsU3RyaW5nLCBiYXNlVXJsKSB7XG4gIGlmICh0eXBlb2YgYmFzZVVybCA9PSAnc3RyaW5nJykge1xuICAgIGJhc2VVcmwgPSBwYXJzZVVybERlcHJlY2F0ZWQoYmFzZVVybCk7XG4gIH1cbiAgcmVsYXRpdmVVcmxTdHJpbmcgPSByZWxhdGl2ZVVybFN0cmluZy5yZXBsYWNlKC9cXFxcL2csICcvJyk7XG4gIGNvbnN0IHJlbGF0aXZlVXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHJlbGF0aXZlVXJsU3RyaW5nKTtcblxuICAvLyBBYnNvbHV0ZSBVUkwuXG4gIGlmIChzdGFydHNXaXRoKHJlbGF0aXZlVXJsU3RyaW5nLnRvTG93ZXJDYXNlKCksIHJlbGF0aXZlVXJsLnByb3RvY29sKSkge1xuICAgIHJldHVybiByZWxhdGl2ZVVybC5ocmVmO1xuICB9XG5cbiAgLy8gUHJvdG9jb2wtcmVsYXRpdmUgVVJMLlxuICBpZiAoc3RhcnRzV2l0aChyZWxhdGl2ZVVybFN0cmluZywgJy8vJykpIHtcbiAgICByZXR1cm4gYmFzZVVybC5wcm90b2NvbCArIHJlbGF0aXZlVXJsU3RyaW5nO1xuICB9XG5cbiAgLy8gQWJzb2x1dGUgcGF0aC5cbiAgaWYgKHN0YXJ0c1dpdGgocmVsYXRpdmVVcmxTdHJpbmcsICcvJykpIHtcbiAgICByZXR1cm4gYmFzZVVybC5vcmlnaW4gKyByZWxhdGl2ZVVybFN0cmluZztcbiAgfVxuXG4gIC8vIFJlbGF0aXZlIHBhdGguXG4gIHJldHVybiBiYXNlVXJsLm9yaWdpbiArIGJhc2VVcmwucGF0aG5hbWUucmVwbGFjZSgvXFwvW14vXSokLywgJy8nKVxuICAgICAgKyByZWxhdGl2ZVVybFN0cmluZztcbn1cblxuXG4vKipcbiAqIEFkZCBcIl9fYW1wX3NvdXJjZV9vcmlnaW5cIiBxdWVyeSBwYXJhbWV0ZXIgdG8gdGhlIFVSTC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb3JzVXJsKHdpbiwgdXJsKSB7XG4gIGNoZWNrQ29yc1VybCh1cmwpO1xuICBjb25zdCBzb3VyY2VPcmlnaW4gPSBnZXRTb3VyY2VPcmlnaW4od2luLmxvY2F0aW9uLmhyZWYpO1xuICByZXR1cm4gYWRkUGFyYW1Ub1VybCh1cmwsIFNPVVJDRV9PUklHSU5fUEFSQU0sIHNvdXJjZU9yaWdpbik7XG59XG5cblxuLyoqXG4gKiBDaGVja3MgaWYgdGhlIHVybCBoYXMgX19hbXBfc291cmNlX29yaWdpbiBhbmQgdGhyb3dzIGlmIGl0IGRvZXMuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGVja0NvcnNVcmwodXJsKSB7XG4gIGNvbnN0IHBhcnNlZFVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICBjb25zdCBxdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmcocGFyc2VkVXJsLnNlYXJjaCk7XG4gIHVzZXIoKS5hc3NlcnQoIShTT1VSQ0VfT1JJR0lOX1BBUkFNIGluIHF1ZXJ5KSxcbiAgICAgICdTb3VyY2Ugb3JpZ2luIGlzIG5vdCBhbGxvd2VkIGluICVzJywgdXJsKTtcbn1cblxuLyoqXG4gKiBUcmllcyB0byBkZWNvZGUgYSBVUkkgY29tcG9uZW50LCBmYWxsaW5nIGJhY2sgdG8gb3B0X2ZhbGxiYWNrIChvciBhbiBlbXB0eVxuICogc3RyaW5nKVxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb21wb25lbnRcbiAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X2ZhbGxiYWNrXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnlEZWNvZGVVcmlDb21wb25lbnQoY29tcG9uZW50LCBvcHRfZmFsbGJhY2spIHtcbiAgcmV0dXJuIHRyeURlY29kZVVyaUNvbXBvbmVudF8oY29tcG9uZW50LCBvcHRfZmFsbGJhY2spO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7Ynl0ZXNUb1N0cmluZywgc3RyaW5nVG9CeXRlcywgdXRmOEVuY29kZX0gZnJvbSAnLi9ieXRlcyc7XG5cbi8qKlxuICogQ2hhcmFjdGVyIG1hcHBpbmcgZnJvbSBiYXNlNjR1cmwgdG8gYmFzZTY0LlxuICogQGNvbnN0IHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn1cbiAqL1xuY29uc3QgYmFzZTY0VXJsRGVjb2RlU3VicyA9IHsnLSc6ICcrJywgJ18nOiAnLycsICcuJzogJz0nfTtcblxuLyoqXG4gKiBDaGFyYWN0ZXIgbWFwcGluZyBmcm9tIGJhc2U2NCB0byBiYXNlNjR1cmwuXG4gKiBAY29uc3QgeyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fVxuICovXG5jb25zdCBiYXNlNjRVcmxFbmNvZGVTdWJzID0geycrJzogJy0nLCAnLyc6ICdfJywgJz0nOiAnLid9O1xuXG4vKipcbiAqIENvbnZlcnRzIGEgc3RyaW5nIHdoaWNoIGlzIGluIGJhc2U2NHVybCBlbmNvZGluZyBpbnRvIGEgVWludDhBcnJheVxuICogY29udGFpbmluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcbiAqIEByZXR1cm4geyFVaW50OEFycmF5fVxuICovXG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0VXJsRGVjb2RlVG9CeXRlcyhzdHIpIHtcbiAgY29uc3QgZW5jb2RlZCA9IGF0b2Ioc3RyLnJlcGxhY2UoL1stXy5dL2csIGNoID0+IGJhc2U2NFVybERlY29kZVN1YnNbY2hdKSk7XG4gIHJldHVybiBzdHJpbmdUb0J5dGVzKGVuY29kZWQpO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgc3RyaW5nIHdoaWNoIGlzIGluIGJhc2U2NCBlbmNvZGluZyBpbnRvIGEgVWludDhBcnJheVxuICogY29udGFpbmluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcbiAqIEByZXR1cm4geyFVaW50OEFycmF5fVxuICovXG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0RGVjb2RlVG9CeXRlcyhzdHIpIHtcbiAgcmV0dXJuIHN0cmluZ1RvQnl0ZXMoYXRvYihzdHIpKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIGJ5dGVzIGFycmF5IGludG8gYmFzZTY0dXJsIGVuY29kZWQgc3RyaW5nLlxuICogYmFzZTY0dXJsIGlzIGRlZmluZWQgaW4gUkZDIDQ2NDguIEl0IGlzIHNvbWV0aW1lcyByZWZlcnJlZCB0byBhcyBcIndlYiBzYWZlXCIuXG4gKiBAcGFyYW0geyFVaW50OEFycmF5fSBieXRlc1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0VXJsRW5jb2RlRnJvbUJ5dGVzKGJ5dGVzKSB7XG4gIGNvbnN0IHN0ciA9IGJ5dGVzVG9TdHJpbmcoYnl0ZXMpO1xuICByZXR1cm4gYnRvYShzdHIpLnJlcGxhY2UoL1srLz1dL2csIGNoID0+IGJhc2U2NFVybEVuY29kZVN1YnNbY2hdKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIHN0cmluZyBpbnRvIGJhc2U2NHVybCBlbmNvZGVkIHN0cmluZy5cbiAqIGJhc2U2NHVybCBpcyBkZWZpbmVkIGluIFJGQyA0NjQ4LiBJdCBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgXCJ3ZWIgc2FmZVwiLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0VXJsRW5jb2RlRnJvbVN0cmluZyhzdHIpIHtcbiAgY29uc3QgYnl0ZXMgPSB1dGY4RW5jb2RlKHN0cik7XG4gIHJldHVybiBiYXNlNjRVcmxFbmNvZGVGcm9tQnl0ZXMoYnl0ZXMpO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgYnl0ZXMgYXJyYXkgaW50byBiYXNlNjQgZW5jb2RlZCBzdHJpbmcuXG4gKiBAcGFyYW0geyFVaW50OEFycmF5fSBieXRlc1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0RW5jb2RlRnJvbUJ5dGVzKGJ5dGVzKSB7XG4gIHJldHVybiBidG9hKGJ5dGVzVG9TdHJpbmcoYnl0ZXMpKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2Rldn0gZnJvbSAnLi4vbG9nJztcblxuLyoqXG4gKiBJbnRlcnByZXQgYSBieXRlIGFycmF5IGFzIGEgVVRGLTggc3RyaW5nLlxuICogQHBhcmFtIHshQnVmZmVyU291cmNlfSBieXRlc1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdXRmOERlY29kZShieXRlcykge1xuICBpZiAodHlwZW9mIFRleHREZWNvZGVyICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoJ3V0Zi04JykuZGVjb2RlKGJ5dGVzKTtcbiAgfVxuICBjb25zdCBhc2NpaVN0cmluZyA9IGJ5dGVzVG9TdHJpbmcobmV3IFVpbnQ4QXJyYXkoYnl0ZXMuYnVmZmVyIHx8IGJ5dGVzKSk7XG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGFzY2lpU3RyaW5nKSk7XG59XG5cbi8qKlxuICogVHVybiBhIHN0cmluZyBpbnRvIFVURi04IGJ5dGVzLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZ1xuICogQHJldHVybiB7IVVpbnQ4QXJyYXl9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1dGY4RW5jb2RlKHN0cmluZykge1xuICBpZiAodHlwZW9mIFRleHRFbmNvZGVyICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBuZXcgVGV4dEVuY29kZXIoJ3V0Zi04JykuZW5jb2RlKHN0cmluZyk7XG4gIH1cbiAgcmV0dXJuIHN0cmluZ1RvQnl0ZXModW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZykpKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIHN0cmluZyB3aGljaCBob2xkcyA4LWJpdCBjb2RlIHBvaW50cywgc3VjaCBhcyB0aGUgcmVzdWx0IG9mIGF0b2IsXG4gKiBpbnRvIGEgVWludDhBcnJheSB3aXRoIHRoZSBjb3JyZXNwb25kaW5nIGJ5dGVzLlxuICogSWYgeW91IGhhdmUgYSBzdHJpbmcgb2YgY2hhcmFjdGVycywgeW91IHByb2JhYmx5IHdhbnQgdG8gYmUgdXNpbmcgdXRmOEVuY29kZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcbiAqIEByZXR1cm4geyFVaW50OEFycmF5fVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RyaW5nVG9CeXRlcyhzdHIpIHtcbiAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheShzdHIubGVuZ3RoKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBjaGFyQ29kZSA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgIGRldigpLmFzc2VydChjaGFyQ29kZSA8PSAyNTUsICdDaGFyYWN0ZXJzIG11c3QgYmUgaW4gcmFuZ2UgWzAsMjU1XScpO1xuICAgIGJ5dGVzW2ldID0gY2hhckNvZGU7XG4gIH1cbiAgcmV0dXJuIGJ5dGVzO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgOC1iaXQgYnl0ZXMgYXJyYXkgaW50byBhIHN0cmluZ1xuICogQHBhcmFtIHshVWludDhBcnJheX0gYnl0ZXNcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJ5dGVzVG9TdHJpbmcoYnl0ZXMpIHtcbiAgLy8gSW50ZW50aW9uYWxseSBhdm9pZHMgU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseSBzbyB3ZSBkb24ndCBzdWZmZXIgYVxuICAvLyBzdGFjayBvdmVyZmxvdy4gIzEwNDk1LCBodHRwczovL2pzcGVyZi5jb20vYnl0ZXNUb1N0cmluZy0yXG4gIGNvbnN0IGFycmF5ID0gbmV3IEFycmF5KGJ5dGVzLmxlbmd0aCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICBhcnJheVtpXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0pO1xuICB9XG4gIHJldHVybiBhcnJheS5qb2luKCcnKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIDQtaXRlbSBieXRlIGFycmF5IHRvIGFuIHVuc2lnbmVkIGludGVnZXIuXG4gKiBBc3N1bWVzIGJ5dGVzIGFyZSBiaWcgZW5kaWFuLlxuICogQHBhcmFtIHshVWludDhBcnJheX0gYnl0ZXNcbiAqIEByZXR1cm4ge251bWJlcn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJ5dGVzVG9VSW50MzIoYnl0ZXMpIHtcbiAgaWYgKGJ5dGVzLmxlbmd0aCAhPSA0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdSZWNlaXZlZCBieXRlIGFycmF5IHdpdGggbGVuZ3RoICE9IDQnKTtcbiAgfVxuICBjb25zdCB2YWwgPSAoYnl0ZXNbMF0gJiAweEZGKSA8PCAyNCB8XG4gICAgIChieXRlc1sxXSAmIDB4RkYpIDw8IDE2IHxcbiAgICAgKGJ5dGVzWzJdICYgMHhGRikgPDwgOCB8XG4gICAgIChieXRlc1szXSAmIDB4RkYpO1xuICAvLyBDb252ZXJ0IHRvIHVuc2lnbmVkLlxuICByZXR1cm4gdmFsID4+PiAwO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIGEgcmFuZG9tIGJ5dGVzIGFycmF5IHdpdGggc3BlY2lmaWMgbGVuZ3RoIHVzaW5nXG4gKiB3aW4uY3J5cHRvLmdldFJhbmRvbVZhbHVlcy4gUmV0dXJuIG51bGwgaWYgaXQgaXMgbm90IGF2YWlsYWJsZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge251bWJlcn0gbGVuZ3RoXG4gKiBAcmV0dXJuIHs/VWludDhBcnJheX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENyeXB0b1JhbmRvbUJ5dGVzQXJyYXkod2luLCBsZW5ndGgpIHtcbiAgaWYgKCF3aW4uY3J5cHRvIHx8ICF3aW4uY3J5cHRvLmdldFJhbmRvbVZhbHVlcykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLy8gV2lkZWx5IGF2YWlsYWJsZSBpbiBicm93c2VycyB3ZSBzdXBwb3J0OlxuICAvLyBodHRwOi8vY2FuaXVzZS5jb20vI3NlYXJjaD1nZXRSYW5kb21WYWx1ZXNcbiAgY29uc3QgdWludDhhcnJheSA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7XG4gIHdpbi5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKHVpbnQ4YXJyYXkpO1xuICByZXR1cm4gdWludDhhcnJheTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2Rldn0gZnJvbSAnLi4vbG9nJztcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgVEFHID0gJ2xydS1jYWNoZSc7XG5cbi8qKlxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGNsYXNzIExydUNhY2hlIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBjYXBhY2l0eVxuICAgKi9cbiAgY29uc3RydWN0b3IoY2FwYWNpdHkpIHtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtudW1iZXJ9ICovXG4gICAgdGhpcy5jYXBhY2l0eV8gPSBjYXBhY2l0eTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMuc2l6ZV8gPSAwO1xuXG4gICAgLyoqXG4gICAgICogQW4gaW5jcmVtZW50aW5nIGNvdW50ZXIgdG8gZGVmaW5lIHRoZSBsYXN0IGFjY2Vzcy5cbiAgICAgKiBAcHJpdmF0ZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHRoaXMuYWNjZXNzXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUgeyFPYmplY3Q8KG51bWJlcnxzdHJpbmcpLCB7cGF5bG9hZDogVCwgYWNjZXNzOiBudW1iZXJ9Pn0gKi9cbiAgICB0aGlzLmNhY2hlXyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB3aGV0aGVyIGtleSBpcyBjYWNoZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30ga2V5XG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBoYXMoa2V5KSB7XG4gICAgcmV0dXJuICEhdGhpcy5jYWNoZV9ba2V5XTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IGtleVxuICAgKiBAcmV0dXJuIHtUfSBUaGUgY2FjaGVkIHBheWxvYWQuXG4gICAqL1xuICBnZXQoa2V5KSB7XG4gICAgY29uc3QgY2FjaGVhYmxlID0gdGhpcy5jYWNoZV9ba2V5XTtcbiAgICBpZiAoY2FjaGVhYmxlKSB7XG4gICAgICBjYWNoZWFibGUuYWNjZXNzID0gKyt0aGlzLmFjY2Vzc187XG4gICAgICByZXR1cm4gY2FjaGVhYmxlLnBheWxvYWQ7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSBrZXlcbiAgICogQHBhcmFtIHtUfSBwYXlsb2FkIFRoZSBwYXlsb2FkIHRvIGNhY2hlLlxuICAgKi9cbiAgcHV0KGtleSwgcGF5bG9hZCkge1xuICAgIGlmICghdGhpcy5oYXMoa2V5KSkge1xuICAgICAgdGhpcy5zaXplXysrO1xuICAgIH1cbiAgICB0aGlzLmNhY2hlX1trZXldID0ge3BheWxvYWQsIGFjY2VzczogdGhpcy5hY2Nlc3NffTtcbiAgICB0aGlzLmV2aWN0XygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEV2aWN0cyB0aGUgb2xkZXN0IGNhY2hlIGVudHJ5LCBpZiB3ZSd2ZSBleGNlZWRlZCBjYXBhY2l0eS5cbiAgICovXG4gIGV2aWN0XygpIHtcbiAgICBpZiAodGhpcy5zaXplXyA8PSB0aGlzLmNhcGFjaXR5Xykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGRldigpLndhcm4oVEFHLCAnVHJpbW1pbmcgTFJVIGNhY2hlJyk7XG4gICAgY29uc3QgY2FjaGUgPSB0aGlzLmNhY2hlXztcbiAgICBsZXQgb2xkZXN0ID0gdGhpcy5hY2Nlc3NfICsgMTtcbiAgICBsZXQgb2xkZXN0S2V5O1xuICAgIGZvciAoY29uc3Qga2V5IGluIGNhY2hlKSB7XG4gICAgICBjb25zdCB7YWNjZXNzfSA9IGNhY2hlW2tleV07XG4gICAgICBpZiAoYWNjZXNzIDwgb2xkZXN0KSB7XG4gICAgICAgIG9sZGVzdCA9IGFjY2VzcztcbiAgICAgICAgb2xkZXN0S2V5ID0ga2V5O1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvbGRlc3RLZXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZGVsZXRlIGNhY2hlW29sZGVzdEtleV07XG4gICAgICB0aGlzLnNpemVfLS07XG4gICAgfVxuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtpc09iamVjdH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKiBAY29uc3QgKi9cbmNvbnN0IGhhc093bl8gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuXG4vKipcbiAqIFJldHVybnMgYSBtYXAtbGlrZSBvYmplY3QuXG4gKiBJZiBvcHRfaW5pdGlhbCBpcyBwcm92aWRlZCwgY29waWVzIGl0cyBvd24gcHJvcGVydGllcyBpbnRvIHRoZVxuICogbmV3bHkgY3JlYXRlZCBvYmplY3QuXG4gKiBAcGFyYW0ge1Q9fSBvcHRfaW5pdGlhbCBUaGlzIHNob3VsZCB0eXBpY2FsbHkgYmUgYW4gb2JqZWN0IGxpdGVyYWwuXG4gKiBAcmV0dXJuIHtUfVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hcChvcHRfaW5pdGlhbCkge1xuICBjb25zdCBvYmogPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBpZiAob3B0X2luaXRpYWwpIHtcbiAgICBPYmplY3QuYXNzaWduKG9iaiwgb3B0X2luaXRpYWwpO1xuICB9XG4gIHJldHVybiBvYmo7XG59XG5cbi8qKlxuICogUmV0dXJuIGFuIGVtcHR5IEpzb25PYmplY3Qgb3IgbWFrZXMgdGhlIHBhc3NlZCBpbiBvYmplY3QgbGl0ZXJhbFxuICogYW4gSnNvbk9iamVjdC5cbiAqIFRoZSBKc29uT2JqZWN0IHR5cGUgaXMganVzdCBhIHNpbXBsZSBvYmplY3QgdGhhdCBpcyBhdC1kaWN0LlxuICogU2VlXG4gKiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2Nsb3N1cmUtY29tcGlsZXIvd2lraS9Ac3RydWN0LWFuZC1AZGljdC1Bbm5vdGF0aW9uc1xuICogZm9yIHdoYXQgYSBkaWN0IGlzIHR5cGUtd2lzZS5cbiAqIFRoZSBsaW50ZXIgZW5mb3JjZXMgdGhhdCB0aGUgYXJndW1lbnQgaXMsIGluIGZhY3QsIGF0LWRpY3QgbGlrZS5cbiAqIEBwYXJhbSB7IU9iamVjdD19IG9wdF9pbml0aWFsXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpY3Qob3B0X2luaXRpYWwpIHtcbiAgLy8gV2UgZG8gbm90IGNvcHkuIFRoZSBsaW50ZXIgZW5mb3JjZXMgdGhhdCB0aGUgcGFzc2VkIGluIG9iamVjdCBpcyBhIGxpdGVyYWxcbiAgLy8gYW5kIHRodXMgdGhlIGNhbGxlciBjYW5ub3QgaGF2ZSBhIHJlZmVyZW5jZSB0byBpdC5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovIChvcHRfaW5pdGlhbCB8fCB7fSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIHRoZSBnaXZlbiBrZXkgaXMgYSBwcm9wZXJ0eSBpbiB0aGUgbWFwLlxuICpcbiAqIEBwYXJhbSB7VH0gIG9iaiBhIG1hcCBsaWtlIHByb3BlcnR5LlxuICogQHBhcmFtIHtzdHJpbmd9ICBrZXlcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzT3duKG9iaiwga2V5KSB7XG4gIHJldHVybiBoYXNPd25fLmNhbGwob2JqLCBrZXkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgb2JqW2tleV0gaWZmIGtleSBpcyBvYmoncyBvd24gcHJvcGVydHkgKGlzIG5vdCBpbmhlcml0ZWQpLlxuICogT3RoZXJ3aXNlLCByZXR1cm5zIHVuZGVmaW5lZC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5XG4gKiBAcmV0dXJuIHsqfVxuICovXG5leHBvcnQgZnVuY3Rpb24gb3duUHJvcGVydHkob2JqLCBrZXkpIHtcbiAgaWYgKGhhc093bihvYmosIGtleSkpIHtcbiAgICByZXR1cm4gb2JqW2tleV07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG4vKipcbiAqIERlZXAgbWVyZ2VzIHNvdXJjZSBpbnRvIHRhcmdldC5cbiAqXG4gKiBAcGFyYW0geyFPYmplY3R9IHRhcmdldFxuICogQHBhcmFtIHshT2JqZWN0fSBzb3VyY2VcbiAqIEBwYXJhbSB7bnVtYmVyfSBkZXB0aCBUaGUgbWF4aW11bSBtZXJnZSBkZXB0aC4gSWYgZXhjZWVkZWQsIE9iamVjdC5hc3NpZ25cbiAqICAgICAgICAgICAgICAgICAgICAgICB3aWxsIGJlIHVzZWQgaW5zdGVhZC5cbiAqIEByZXR1cm4geyFPYmplY3R9XG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgc291cmNlIGNvbnRhaW5zIGEgY2lyY3VsYXIgcmVmZXJlbmNlLlxuICogTm90ZTogT25seSBuZXN0ZWQgb2JqZWN0cyBhcmUgZGVlcC1tZXJnZWQsIHByaW1pdGl2ZXMgYW5kIGFycmF5cyBhcmUgbm90LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVlcE1lcmdlKHRhcmdldCwgc291cmNlLCBkZXB0aCA9IDEwKSB7XG4gIC8vIEtlZXAgdHJhY2sgb2Ygc2VlbiBvYmplY3RzIHRvIGRldGVjdCByZWN1cnNpdmUgcmVmZXJlbmNlcy5cbiAgY29uc3Qgc2VlbiA9IFtdO1xuXG4gIC8qKiBAdHlwZSB7IUFycmF5PHt0OiAhT2JqZWN0LCBzOiAhT2JqZWN0LCBkOiBudW1iZXJ9Pn0gKi9cbiAgY29uc3QgcXVldWUgPSBbXTtcbiAgcXVldWUucHVzaCh7dDogdGFyZ2V0LCBzOiBzb3VyY2UsIGQ6IDB9KTtcblxuICAvLyBCRlMgdG8gZW5zdXJlIG9iamVjdHMgZG9uJ3QgaGF2ZSByZWN1cnNpdmUgcmVmZXJlbmNlcyBhdCBzaGFsbG93ZXIgZGVwdGhzLlxuICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IHt0LCBzLCBkfSA9IHF1ZXVlLnNoaWZ0KCk7XG4gICAgaWYgKHNlZW4uaW5jbHVkZXMocykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignU291cmNlIG9iamVjdCBoYXMgYSBjaXJjdWxhciByZWZlcmVuY2UuJyk7XG4gICAgfVxuICAgIHNlZW4ucHVzaChzKTtcbiAgICBpZiAodCA9PT0gcykge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChkID4gZGVwdGgpIHtcbiAgICAgIE9iamVjdC5hc3NpZ24odCwgcyk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgT2JqZWN0LmtleXMocykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgY29uc3QgbmV3VmFsdWUgPSBzW2tleV07XG4gICAgICAvLyBQZXJmb3JtIGEgZGVlcCBtZXJnZSBJRkYgYm90aCB0YXJnZXQgYW5kIHNvdXJjZSBoYXZlIHRoZSBzYW1lIGtleVxuICAgICAgLy8gd2hvc2UgY29ycmVzcG9uZGluZyB2YWx1ZXMgYXJlIG9iamVjdHMuXG4gICAgICBpZiAoaGFzT3duKHQsIGtleSkpIHtcbiAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0W2tleV07XG4gICAgICAgIGlmIChpc09iamVjdChuZXdWYWx1ZSkgJiYgaXNPYmplY3Qob2xkVmFsdWUpKSB7XG4gICAgICAgICAgcXVldWUucHVzaCh7dDogb2xkVmFsdWUsIHM6IG5ld1ZhbHVlLCBkOiBkICsgMX0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdFtrZXldID0gbmV3VmFsdWU7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHRhcmdldDtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFPYmplY3R9IG8gQW4gb2JqZWN0IHRvIHJlbW92ZSBwcm9wZXJ0aWVzIGZyb21cbiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHByb3BzIEEgbGlzdCBvZiBwcm9wZXJ0aWVzIHRvIHJlbW92ZSBmcm9tIHRoZSBPYmplY3RcbiAqIEByZXR1cm4geyFPYmplY3R9IEFuIG9iamVjdCB3aXRoIHRoZSBnaXZlbiBwcm9wZXJ0aWVzIHJlbW92ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9taXQobywgcHJvcHMpIHtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG8pLnJlZHVjZSgoYWNjLCBrZXkpID0+IHtcbiAgICBpZiAoIXByb3BzLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgIGFjY1trZXldID0gb1trZXldO1xuICAgIH1cbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtiYXNlNjREZWNvZGVUb0J5dGVzfSBmcm9tICcuL2Jhc2U2NCc7XG5cblxuLyoqXG4gKiBDb252ZXJ0cyBhIHRleHQgaW4gUEVNIGZvcm1hdCBpbnRvIGEgYmluYXJ5IGFycmF5IGJ1ZmZlci5cbiAqIEBwYXJhbSB7c3RyaW5nfSBwZW1cbiAqIEByZXR1cm4geyFVaW50OEFycmF5fVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwZW1Ub0J5dGVzKHBlbSkge1xuICBwZW0gPSBwZW0udHJpbSgpO1xuXG4gIC8vIFJlbW92ZSBwZW0gcHJlZml4LCBlLmcuIFwiLS0tLUJFR0lOIFBVQkxJQyBLRVktLS0tXCIuXG4gIHBlbSA9IHBlbS5yZXBsYWNlKC9eXFwtK0JFR0lOW14tXSpcXC0rLywgJycpO1xuXG4gIC8vIFJlbW92ZSBwZW0gc3VmZml4LCBlLmcuIFwiLS0tLUVORCBQVUJMSUMgS0VZLS0tLVwiLlxuICBwZW0gPSBwZW0ucmVwbGFjZSgvXFwtK0VORFteLV0qXFwtKyQvLCAnJyk7XG5cbiAgLy8gUmVtb3ZlIGxpbmUgYnJlYWtzLlxuICBwZW0gPSBwZW0ucmVwbGFjZSgvW1xcclxcbl0vZywgJycpLnRyaW0oKTtcblxuICByZXR1cm4gYmFzZTY0RGVjb2RlVG9CeXRlcyhwZW0pO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogUmV0dXJucyBhIERlZmVycmVkIHN0cnVjdCwgd2hpY2ggaG9sZHMgYSBwZW5kaW5nIHByb21pc2UgYW5kIGl0cyBhc3NvY2lhdGVkXG4gKiByZXNvbHZlIGFuZCByZWplY3QgZnVuY3Rpb25zLlxuICpcbiAqIFRoaXMgaXMgcHJlZmVycmVkIGluc3RlYWQgb2YgY3JlYXRpbmcgYSBQcm9taXNlIGluc3RhbmNlIHRvIGV4dHJhY3QgdGhlXG4gKiByZXNvbHZlL3JlamVjdCBmdW5jdGlvbnMgeW91cnNlbGY6XG4gKlxuICogYGBgXG4gKiAvLyBBdm9pZCBkb2luZ1xuICogbGV0IHJlc29sdmU7XG4gKiBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2UocmVzID0+IHtcbiAqICAgcmVzb2x2ZSA9IHJlcztcbiAqIH0pO1xuICpcbiAqIC8vIEdvb2RcbiAqIGNvbnN0IGRlZmVycmVkID0gbmV3IERlZmVycmVkKCk7XG4gKiBjb25zdCB7IHByb21pc2UsIHJlc29sdmUgfSA9IGRlZmVycmVkO1xuICogYGBgXG4gKlxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGNsYXNzIERlZmVycmVkIHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgRGVmZXJyZWQuXG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBsZXQgcmVzb2x2ZSwgcmVqZWN0O1xuXG4gICAgLyoqXG4gICAgICogQGNvbnN0IHshUHJvbWlzZTxUPn1cbiAgICAgKi9cbiAgICB0aGlzLnByb21pc2UgPSBuZXcgLypPSyovUHJvbWlzZSgocmVzLCByZWopID0+IHtcbiAgICAgIHJlc29sdmUgPSByZXM7XG4gICAgICByZWplY3QgPSByZWo7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBAY29uc3Qge2Z1bmN0aW9uKFQ9KX1cbiAgICAgKi9cbiAgICB0aGlzLnJlc29sdmUgPSByZXNvbHZlO1xuXG4gICAgLyoqXG4gICAgICogQGNvbnN0IHtmdW5jdGlvbigqPSl9XG4gICAgICovXG4gICAgdGhpcy5yZWplY3QgPSByZWplY3Q7XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgcHJvbWlzZSByZXNvbHZlZCB0byB0aGUgcmV0dXJuIHZhbHVlIG9mIGZuLlxuICogSWYgZm4gc3luYyB0aHJvd3MsIGl0IHdpbGwgY2F1c2UgdGhlIHByb21pc2UgdG8gcmVqZWN0LlxuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKTpUfSBmblxuICogQHJldHVybiB7IVByb21pc2U8VD59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ5UmVzb2x2ZShmbikge1xuICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgcmVzb2x2ZShmbigpKTtcbiAgfSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2Ugd2hpY2ggcmVzb2x2ZXMgaWYgYSB0aHJlc2hvbGQgYW1vdW50IG9mIHRoZSBnaXZlbiBwcm9taXNlc1xuICogcmVzb2x2ZSwgYW5kIHJlamVjdHMgb3RoZXJ3aXNlLlxuICogQHBhcmFtIHshQXJyYXk8IVByb21pc2U+fSBwcm9taXNlcyBUaGUgYXJyYXkgb2YgcHJvbWlzZXMgdG8gdGVzdC5cbiAqIEBwYXJhbSB7bnVtYmVyfSBjb3VudCBUaGUgbnVtYmVyIG9mIHByb21pc2VzIHRoYXQgbXVzdCByZXNvbHZlIGZvciB0aGVcbiAqICAgICByZXR1cm5lZCBwcm9taXNlIHRvIHJlc29sdmUuXG4gKiBAcmV0dXJuIHshUHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgaWYgYW55IG9mIHRoZSBnaXZlbiBwcm9taXNlc1xuICogICAgIHJlc29sdmUsIGFuZCB3aGljaCByZWplY3RzIG90aGVyd2lzZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNvbWUocHJvbWlzZXMsIGNvdW50ID0gMSkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGNvdW50ID0gTWF0aC5tYXgoY291bnQsIDApO1xuICAgIGNvbnN0IGV4dHJhID0gcHJvbWlzZXMubGVuZ3RoIC0gY291bnQ7XG4gICAgaWYgKGV4dHJhIDwgMCkge1xuICAgICAgcmVqZWN0KG5ldyBFcnJvcignbm90IGVub3VnaCBwcm9taXNlcyB0byByZXNvbHZlJykpO1xuICAgIH1cbiAgICBpZiAocHJvbWlzZXMubGVuZ3RoID09IDApIHtcbiAgICAgIHJlc29sdmUoW10pO1xuICAgIH1cbiAgICBjb25zdCB2YWx1ZXMgPSBbXTtcbiAgICBjb25zdCByZWFzb25zID0gW107XG5cbiAgICBjb25zdCBvbkZ1bGZpbGxlZCA9IHZhbHVlID0+IHtcbiAgICAgIGlmICh2YWx1ZXMubGVuZ3RoIDwgY291bnQpIHtcbiAgICAgICAgdmFsdWVzLnB1c2godmFsdWUpO1xuICAgICAgfVxuICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPT0gY291bnQpIHtcbiAgICAgICAgcmVzb2x2ZSh2YWx1ZXMpO1xuICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgb25SZWplY3RlZCA9IHJlYXNvbiA9PiB7XG4gICAgICBpZiAocmVhc29ucy5sZW5ndGggPD0gZXh0cmEpIHtcbiAgICAgICAgcmVhc29ucy5wdXNoKHJlYXNvbik7XG4gICAgICB9XG4gICAgICBpZiAocmVhc29ucy5sZW5ndGggPiBleHRyYSkge1xuICAgICAgICByZWplY3QocmVhc29ucyk7XG4gICAgICB9XG4gICAgfTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb21pc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBQcm9taXNlLnJlc29sdmUocHJvbWlzZXNbaV0pLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpO1xuICAgIH1cbiAgfSk7XG59XG5cbi8qKlxuICogUmVzb2x2ZXMgd2l0aCB0aGUgcmVzdWx0IG9mIHRoZSBsYXN0IHByb21pc2UgYWRkZWQuXG4gKiBAaW1wbGVtZW50cyB7SVRoZW5hYmxlfVxuICovXG5leHBvcnQgY2xhc3MgTGFzdEFkZGVkUmVzb2x2ZXIge1xuICAvKipcbiAgICogQHBhcmFtIHshQXJyYXk8IVByb21pc2U+PX0gb3B0X3Byb21pc2VzXG4gICAqL1xuICBjb25zdHJ1Y3RvcihvcHRfcHJvbWlzZXMpIHtcbiAgICBsZXQgcmVzb2x2ZV8sIHJlamVjdF87XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IVByb21pc2V9ICovXG4gICAgdGhpcy5wcm9taXNlXyA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHJlc29sdmVfID0gcmVzb2x2ZTtcbiAgICAgIHJlamVjdF8gPSByZWplY3Q7XG4gICAgfSk7XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICB0aGlzLnJlc29sdmVfID0gcmVzb2x2ZV87XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICB0aGlzLnJlamVjdF8gPSByZWplY3RfO1xuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5jb3VudF8gPSAwO1xuXG4gICAgaWYgKG9wdF9wcm9taXNlcykge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcHRfcHJvbWlzZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy5hZGQob3B0X3Byb21pc2VzW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWRkIGEgcHJvbWlzZSB0byBwb3NzaWJseSBiZSByZXNvbHZlZC5cbiAgICogQHBhcmFtIHshUHJvbWlzZX0gcHJvbWlzZVxuICAgKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAgICovXG4gIGFkZChwcm9taXNlKSB7XG4gICAgY29uc3QgY291bnRBdEFkZCA9ICsrdGhpcy5jb3VudF87XG4gICAgUHJvbWlzZS5yZXNvbHZlKHByb21pc2UpLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgIGlmICh0aGlzLmNvdW50XyA9PT0gY291bnRBdEFkZCkge1xuICAgICAgICB0aGlzLnJlc29sdmVfKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSwgZXJyb3IgPT4ge1xuICAgICAgLy8gRG9uJ3QgZm9sbG93IGJlaGF2aW9yIG9mIFByb21pc2UuYWxsIGFuZCBQcm9taXNlLnJhY2UgZXJyb3Igc28gdGhhdFxuICAgICAgLy8gdGhpcyB3aWxsIG9ubHkgcmVqZWN0IHdoZW4gbW9zdCByZWNlbnRseSBhZGRlZCBwcm9taXNlIGZhaWxzLlxuICAgICAgaWYgKHRoaXMuY291bnRfID09PSBjb3VudEF0QWRkKSB7XG4gICAgICAgIHRoaXMucmVqZWN0XyhlcnJvcik7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMucHJvbWlzZV87XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHRoZW4ob3B0X3Jlc29sdmUsIG9wdF9yZWplY3QpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9taXNlXy50aGVuKG9wdF9yZXNvbHZlLCBvcHRfcmVqZWN0KTtcbiAgfVxufVxuIiwiLyohIGh0dHBzOi8vbXRocy5iZS9jc3Nlc2NhcGUgdjEuNS4xIGJ5IEBtYXRoaWFzIHwgTUlUIGxpY2Vuc2UgKi9cblxuXG4vKipcbiAqIFRoaXMgcmVnZXggY29uc2lzdHMgb2YgNCBtYXRjaGluZyBjYXB0dXJlIGdyb3VwcyBhbmQgb25lIChub24tbWF0Y2hpbmcpIGZhbGxiYWNrOlxuICpcbiAqIC0gKFxcMCksIGNhdGNoIHRoZSBudWxsIHRlcm1pbmF0b3IgY2hhcmFjdGVyIHNvIGl0IG1heSBiZSByZXBsYWNlZCBieSBVVEZcbiAqICAgUmVwbGFjZW1lbnQgQ2hhclxuICogLSBeKC0pJCwgY2F0Y2ggYSBzb2xpdGFyeSBkYXNoIGNoYXIsIHNvIHRoYXQgaXQgbWF5IGJlIGJhY2tzbGFzaCBlc2NhcGVkLlxuICogICBUaGlzIGlzIGEgc2VwYXJhdGUgY2FwdHVyZSBncm91cCBzbyB0aGF0IHRoZSBsZWdhbC1jaGFycyAoZ3JvdXAgNCkgZG9lc24ndFxuICogICBjYXB0dXJlIGl0IGZpcnN0LCBzaW5jZSB0aGF0IGdyb3VwIGRvZXNuJ3QgbmVlZCB0byBlc2NhcGUgaXRzIGRhc2guXG4gKiAtIChbXFx4MDEtXFx4MWZcXHg3Zl18Xi0/WzAtOV0pLCBjYXRjaCBhIFVURiBjb250cm9sIGNoYXIsIG9yIGFueSBsZWFkaW5nXG4gKiAgIG51bWJlciAod2l0aCBhbiBvcHRpb25hbCBsZWFkaW5nIGRhc2gpLiBUaGUgY29udHJvbCBvciB0aGUgbnVtYmVyIChidXQgbm90XG4gKiAgIHRoZSBsZWFkaW5nIGRhc2gpIG11c3QgYmUgaGV4LWVzY2FwZWQsLlxuICogLSAoW1xceDgwLVxcdWZmZmYwLTlhLXpBLVpfLV0rKSwgY2F0Y2ggbGVnYWwtY2hhcnMsIHdpdGggdGhlIGV4Y2VwdGlvbiBvZiBhXG4gKiAgIHNvbGl0YXJ5IGRhc2gsIHdoaWNoIHdpbGwgYWxyZWFkeSBoYXZlIG1hdGNoZWQgaW4gZ3JvdXAgMS5cbiAqIC0gW15dLCBmaW5hbGx5LCBhIGNhdGNoLWFsbCB0aGF0IGFsbG93cyB1cyB0byBiYWNrc2xhc2ggZXNjYXBlIHRoZSBjaGFyLlxuICpcbiAqIFRvZ2V0aGVyLCB0aGlzIG1hdGNoZXMgZXZlcnl0aGluZyBuZWNlc3NhcnkgZm9yIENTUy5lc2NhcGUuXG4gKi9cbnZhciByZWdleCA9IC8oXFwwKXxeKC0pJHwoW1xceDAxLVxceDFmXFx4N2ZdfF4tP1swLTldKXwoW1xceDgwLVxcdWZmZmYwLTlhLXpBLVpfLV0rKXxbXl0vZztcblxuZnVuY3Rpb24gZXNjYXBlcihtYXRjaCwgbmlsLCBkYXNoLCBoZXhFc2NhcGUsIGNoYXJzKSB7XG4gIC8vIENoYXJzIGlzIHRoZSBsZWdhbC1jaGFycyAoZ3JvdXAgNCkgY2FwdHVyZVxuICBpZiAoY2hhcnMpIHtcbiAgICByZXR1cm4gY2hhcnM7XG4gIH1cbiAgLy8gTmlsIGlzIHRoZSBudWxsIHRlcm1pbmF0b3IgKGdyb3VwIDEpIGNhcHR1cmVcbiAgaWYgKG5pbCkge1xuICAgIHJldHVybiAnXFx1RkZGRCc7XG4gIH1cbiAgLy8gQm90aCBVVEYgY29udHJvbCBjaGFycywgYW5kIGxlYWRpbmcgbnVtYmVycyAod2l0aCBvcHRpb25hbCBsZWFkaW5nIGRhc2gpXG4gIC8vIChncm91cCAzKSBtdXN0IGJlIGJhY2tzbGFzaCBlc2NhcGVkIHdpdGggYSB0cmFpbGluZyBzcGFjZS4gIEZ1bm5pbHksIHRoZVxuICAvLyBsZWFkaW5nIGRhc2ggbXVzdCBub3QgYmUgZXNjYXBlZCwgYnV0IHRoZSBudW1iZXIuIDpzaHJ1ZzpcbiAgaWYgKGhleEVzY2FwZSkge1xuICAgIHJldHVybiBtYXRjaC5zbGljZSgwLCAtMSkgKyAnXFxcXCcgKyBtYXRjaC5zbGljZSgtMSkuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikgKyAnICdcbiAgfVxuICAvLyBGaW5hbGx5LCB0aGUgc29saXRhcnkgZGFzaCBhbmQgdGhlIGNhdGNoLWFsbCBjaGFycyByZXF1aXJlIGJhY2tzbGFzaFxuICAvLyBlc2NhcGluZy5cbiAgcmV0dXJuICdcXFxcJyArIG1hdGNoO1xufVxuXG4vKipcbiAqIGh0dHBzOi8vZHJhZnRzLmNzc3dnLm9yZy9jc3NvbS8jc2VyaWFsaXplLWFuLWlkZW50aWZpZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3NzRXNjYXBlKHZhbHVlKSB7XG4gIHJldHVybiBTdHJpbmcodmFsdWUpLnJlcGxhY2UocmVnZXgsIGVzY2FwZXIpO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgU3Vic2NyaWJlIHdpdGggR29vZ2xlIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIFZlcnNpb246IDAuMS4yMi4yMyAqL1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgU3Vic2NyaWJlIHdpdGggR29vZ2xlIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBnZXRSZWFkeVN0YXRlKGRvYykge1xuICByZXR1cm4gLyoqIEB0eXBlIHtzdHJpbmd9ICovIChkb2NbJ3JlYWR5U3RhdGUnXSk7XG59XG5cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBkb2N1bWVudCBpcyByZWFkeS5cbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2NcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzRG9jdW1lbnRSZWFkeShkb2MpIHtcbiAgY29uc3QgcmVhZHlTdGF0ZSA9IGdldFJlYWR5U3RhdGUoZG9jKTtcbiAgcmV0dXJuIHJlYWR5U3RhdGUgIT0gJ2xvYWRpbmcnICYmIHJlYWR5U3RhdGUgIT0gJ3VuaW5pdGlhbGl6ZWQnO1xufVxuXG4vKipcbiAqIENhbGxzIHRoZSBjYWxsYmFjayB3aGVuIGRvY3VtZW50IGlzIHJlYWR5LlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHBhcmFtIHtmdW5jdGlvbighRG9jdW1lbnQpfSBjYWxsYmFja1xuICovXG5mdW5jdGlvbiBvbkRvY3VtZW50UmVhZHkoZG9jLCBjYWxsYmFjaykge1xuICBvbkRvY3VtZW50U3RhdGUoZG9jLCBpc0RvY3VtZW50UmVhZHksIGNhbGxiYWNrKTtcbn1cblxuLyoqXG4gKiBDYWxscyB0aGUgY2FsbGJhY2sgd2hlbiBkb2N1bWVudCdzIHN0YXRlIHNhdGlzZmllcyB0aGUgc3RhdGVGbi5cbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2NcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIURvY3VtZW50KTpib29sZWFufSBzdGF0ZUZuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFEb2N1bWVudCl9IGNhbGxiYWNrXG4gKi9cbmZ1bmN0aW9uIG9uRG9jdW1lbnRTdGF0ZShkb2MsIHN0YXRlRm4sIGNhbGxiYWNrKSB7XG4gIGxldCByZWFkeSA9IHN0YXRlRm4oZG9jKTtcbiAgaWYgKHJlYWR5KSB7XG4gICAgY2FsbGJhY2soZG9jKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCByZWFkeUxpc3RlbmVyID0gKCkgPT4ge1xuICAgICAgaWYgKHN0YXRlRm4oZG9jKSkge1xuICAgICAgICBpZiAoIXJlYWR5KSB7XG4gICAgICAgICAgcmVhZHkgPSB0cnVlO1xuICAgICAgICAgIGNhbGxiYWNrKGRvYyk7XG4gICAgICAgIH1cbiAgICAgICAgZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3JlYWR5c3RhdGVjaGFuZ2UnLCByZWFkeUxpc3RlbmVyKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGRvYy5hZGRFdmVudExpc3RlbmVyKCdyZWFkeXN0YXRlY2hhbmdlJywgcmVhZHlMaXN0ZW5lcik7XG4gIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IGlzIHJlc29sdmVkIHdoZW4gZG9jdW1lbnQgaXMgcmVhZHkuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhRG9jdW1lbnQ+fVxuICovXG5mdW5jdGlvbiB3aGVuRG9jdW1lbnRSZWFkeShkb2MpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgIG9uRG9jdW1lbnRSZWFkeShkb2MsIHJlc29sdmUpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgU3Vic2NyaWJlIHdpdGggR29vZ2xlIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogQGludGVyZmFjZVxuICovXG5jbGFzcyBEb2Mge1xuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshV2luZG93fVxuICAgKi9cbiAgZ2V0V2luKCkge31cblxuICAvKipcbiAgICogVGhlIGBEb2N1bWVudGAgbm9kZSBvciBhbmFsb2cuXG4gICAqIEByZXR1cm4geyFOb2RlfVxuICAgKi9cbiAgZ2V0Um9vdE5vZGUoKSB7fVxuXG4gIC8qKlxuICAgKiBUaGUgYERvY3VtZW50LmRvY3VtZW50RWxlbWVudGAgZWxlbWVudCBvciBhbmFsb2cuXG4gICAqIEByZXR1cm4geyFFbGVtZW50fVxuICAgKi9cbiAgZ2V0Um9vdEVsZW1lbnQoKSB7fVxuXG4gIC8qKlxuICAgKiBUaGUgYERvY3VtZW50LmhlYWRgIGVsZW1lbnQgb3IgYW5hbG9nLiBSZXR1cm5zIGBudWxsYCBpZiBub3QgYXZhaWxhYmxlXG4gICAqIHlldC5cbiAgICogQHJldHVybiB7IUVsZW1lbnR9XG4gICAqL1xuICBnZXRIZWFkKCkge31cblxuICAvKipcbiAgICogVGhlIGBEb2N1bWVudC5ib2R5YCBlbGVtZW50IG9yIGFuYWxvZy4gUmV0dXJucyBgbnVsbGAgaWYgbm90IGF2YWlsYWJsZVxuICAgKiB5ZXQuXG4gICAqIEByZXR1cm4gez9FbGVtZW50fVxuICAgKi9cbiAgZ2V0Qm9keSgpIHt9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhlIGRvY3VtZW50IGhhcyBiZWVuIGZ1bGx5IGNvbnN0cnVjdGVkLlxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgaXNSZWFkeSgpIHt9XG5cbiAgLyoqXG4gICAqIFJlc29sdmVkIHdoZW4gZG9jdW1lbnQgaGFzIGJlZW4gZnVsbHkgY29uc3RydWN0ZWQuXG4gICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgKi9cbiAgd2hlblJlYWR5KCkge31cbn1cblxuXG4vKiogQGltcGxlbWVudHMge0RvY30gKi9cbmNsYXNzIEdsb2JhbERvYyB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd3whRG9jdW1lbnR9IHdpbk9yRG9jXG4gICAqL1xuICBjb25zdHJ1Y3Rvcih3aW5PckRvYykge1xuICAgIGNvbnN0IGlzV2luID0gISF3aW5PckRvYy5kb2N1bWVudDtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshV2luZG93fSAqL1xuICAgIHRoaXMud2luXyA9IGlzV2luID9cbiAgICAgICAgLyoqIEB0eXBlIHshV2luZG93fSAqLyAod2luT3JEb2MpIDpcbiAgICAgICAgLyoqIEB0eXBlIHshV2luZG93fSAqLyAoXG4gICAgICAgICAgICAoLyoqIEB0eXBlIHshRG9jdW1lbnR9ICovICh3aW5PckRvYykpLmRlZmF1bHRWaWV3KTtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshRG9jdW1lbnR9ICovXG4gICAgdGhpcy5kb2NfID0gaXNXaW4gP1xuICAgICAgICAvKiogQHR5cGUgeyFXaW5kb3d9ICovICh3aW5PckRvYykuZG9jdW1lbnQgOlxuICAgICAgICAvKiogQHR5cGUgeyFEb2N1bWVudH0gKi8gKHdpbk9yRG9jKTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgZ2V0V2luKCkge1xuICAgIHJldHVybiB0aGlzLndpbl87XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGdldFJvb3ROb2RlKCkge1xuICAgIHJldHVybiB0aGlzLmRvY187XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGdldFJvb3RFbGVtZW50KCkge1xuICAgIHJldHVybiB0aGlzLmRvY18uZG9jdW1lbnRFbGVtZW50O1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBnZXRIZWFkKCkge1xuICAgIC8vIGBkb2N1bWVudC5oZWFkYCBhbHdheXMgaGFzIGEgY2hhbmNlIHRvIGJlIHBhcnNlZCwgYXQgbGVhc3QgcGFydGlhbGx5LlxuICAgIHJldHVybiAvKiogQHR5cGUgeyFFbGVtZW50fSAqLyAodGhpcy5kb2NfLmhlYWQpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBnZXRCb2R5KCkge1xuICAgIHJldHVybiB0aGlzLmRvY18uYm9keTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgaXNSZWFkeSgpIHtcbiAgICByZXR1cm4gaXNEb2N1bWVudFJlYWR5KHRoaXMuZG9jXyk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHdoZW5SZWFkeSgpIHtcbiAgICByZXR1cm4gd2hlbkRvY3VtZW50UmVhZHkodGhpcy5kb2NfKTtcbiAgfVxufVxuXG5cbi8qKlxuICogQHBhcmFtIHshRG9jdW1lbnR8IVdpbmRvd3whRG9jfSBpbnB1dFxuICogQHJldHVybiB7IURvY31cbiAqL1xuZnVuY3Rpb24gcmVzb2x2ZURvYyhpbnB1dCkge1xuICAvLyBJcyBpdCBhIGBEb2N1bWVudGBcbiAgaWYgKCgvKiogQHR5cGUgeyFEb2N1bWVudH0gKi8gKGlucHV0KSkubm9kZVR5cGUgPT09IC8qIERPQ1VNRU5UICovIDkpIHtcbiAgICByZXR1cm4gbmV3IEdsb2JhbERvYygvKiogQHR5cGUgeyFEb2N1bWVudH0gKi8gKGlucHV0KSk7XG4gIH1cbiAgLy8gSXMgaXQgYSBgV2luZG93YD9cbiAgaWYgKCgvKiogQHR5cGUgeyFXaW5kb3d9ICovIChpbnB1dCkpLmRvY3VtZW50KSB7XG4gICAgcmV0dXJuIG5ldyBHbG9iYWxEb2MoLyoqIEB0eXBlIHshV2luZG93fSAqLyAoaW5wdXQpKTtcbiAgfVxuICByZXR1cm4gLyoqIEB0eXBlIHshRG9jfSAqLyAoaW5wdXQpO1xufVxuXG4vKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBTdWJzY3JpYmUgd2l0aCBHb29nbGUgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuLyoqXG4gKi9cbmNsYXNzIFBhZ2VDb25maWcge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvZHVjdE9yUHVibGljYXRpb25JZFxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGxvY2tlZFxuICAgKi9cbiAgY29uc3RydWN0b3IocHJvZHVjdE9yUHVibGljYXRpb25JZCwgbG9ja2VkKSB7XG4gICAgbGV0IHB1YmxpY2F0aW9uSWQsIHByb2R1Y3RJZCwgbGFiZWw7XG4gICAgY29uc3QgZGl2ID0gcHJvZHVjdE9yUHVibGljYXRpb25JZC5pbmRleE9mKCc6Jyk7XG4gICAgaWYgKGRpdiAhPSAtMSkge1xuICAgICAgLy8gVGhlIGFyZ3VtZW50IGlzIGEgcHJvZHVjdCBpZC5cbiAgICAgIHByb2R1Y3RJZCA9IHByb2R1Y3RPclB1YmxpY2F0aW9uSWQ7XG4gICAgICBwdWJsaWNhdGlvbklkID0gcHJvZHVjdElkLnN1YnN0cmluZygwLCBkaXYpO1xuICAgICAgbGFiZWwgPSBwcm9kdWN0SWQuc3Vic3RyaW5nKGRpdiArIDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBUaGUgYXJndW1lbnQgaXMgYSBwdWJsaWNhdGlvbiBpZC5cbiAgICAgIHB1YmxpY2F0aW9uSWQgPSBwcm9kdWN0T3JQdWJsaWNhdGlvbklkO1xuICAgICAgcHJvZHVjdElkID0gbnVsbDtcbiAgICAgIGxhYmVsID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtzdHJpbmd9ICovXG4gICAgdGhpcy5wdWJsaWNhdGlvbklkXyA9IHB1YmxpY2F0aW9uSWQ7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7P3N0cmluZ30gKi9cbiAgICB0aGlzLnByb2R1Y3RJZF8gPSBwcm9kdWN0SWQ7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7P3N0cmluZ30gKi9cbiAgICB0aGlzLmxhYmVsXyA9IGxhYmVsO1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge2Jvb2xlYW59ICovXG4gICAgdGhpcy5sb2NrZWRfID0gbG9ja2VkO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICovXG4gIGdldFB1YmxpY2F0aW9uSWQoKSB7XG4gICAgcmV0dXJuIHRoaXMucHVibGljYXRpb25JZF87XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7P3N0cmluZ31cbiAgICovXG4gIGdldFByb2R1Y3RJZCgpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9kdWN0SWRfO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4gez9zdHJpbmd9XG4gICAqL1xuICBnZXRMYWJlbCgpIHtcbiAgICByZXR1cm4gdGhpcy5sYWJlbF87XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlzTG9ja2VkKCkge1xuICAgIHJldHVybiB0aGlzLmxvY2tlZF87XG4gIH1cbn1cblxuLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgU3Vic2NyaWJlIHdpdGggR29vZ2xlIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBTdWJzY3JpYmUgd2l0aCBHb29nbGUgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIFN1YnNjcmliZSB3aXRoIEdvb2dsZSBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgU3Vic2NyaWJlIHdpdGggR29vZ2xlIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBTdWJzY3JpYmUgd2l0aCBHb29nbGUgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBlbGVtZW50IGhhdmUgYSBuZXh0IG5vZGUgaW4gdGhlIGRvY3VtZW50IG9yZGVyLlxuICogVGhpcyBtZWFucyBlaXRoZXI6XG4gKiAgYS4gVGhlIGVsZW1lbnQgaXRzZWxmIGhhcyBhIG5leHRTaWJsaW5nLlxuICogIGIuIEFueSBvZiB0aGUgZWxlbWVudCBhbmNlc3RvcnMgaGFzIGEgbmV4dFNpYmxpbmcuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0gez9Ob2RlPX0gb3B0X3N0b3BOb2RlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBoYXNOZXh0Tm9kZUluRG9jdW1lbnRPcmRlcihlbGVtZW50LCBvcHRfc3RvcE5vZGUpIHtcbiAgbGV0IGN1cnJlbnRFbGVtZW50ID0gZWxlbWVudDtcbiAgZG8ge1xuICAgIGlmIChjdXJyZW50RWxlbWVudC5uZXh0U2libGluZykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9IHdoaWxlICgoY3VycmVudEVsZW1lbnQgPSBjdXJyZW50RWxlbWVudC5wYXJlbnROb2RlKSAmJlxuICAgICAgICAgICAgY3VycmVudEVsZW1lbnQgIT0gb3B0X3N0b3BOb2RlKTtcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBTdWJzY3JpYmUgd2l0aCBHb29nbGUgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogRGV0ZXJtaW5lcyBpZiB2YWx1ZSBpcyBhY3R1YWxseSBhbiBBcnJheS5cbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzQXJyYXkodmFsdWUpIHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkodmFsdWUpO1xufVxuXG4vKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBTdWJzY3JpYmUgd2l0aCBHb29nbGUgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogU2ltcGxlIHdyYXBwZXIgYXJvdW5kIEpTT04ucGFyc2UgdGhhdCBjYXN0cyB0aGUgcmV0dXJuIHZhbHVlXG4gKiB0byBKc29uT2JqZWN0LlxuICogQ3JlYXRlIGEgbmV3IHdyYXBwZXIgaWYgYW4gYXJyYXkgcmV0dXJuIHZhbHVlIGlzIGRlc2lyZWQuXG4gKiBAcGFyYW0geyp9IGpzb24gSlNPTiBzdHJpbmcgdG8gcGFyc2VcbiAqIEByZXR1cm4gez9Kc29uT2JqZWN0fHVuZGVmaW5lZH0gTWF5IGJlIGV4dGVuZCB0byBwYXJzZSBhcnJheXMuXG4gKi9cbmZ1bmN0aW9uIHBhcnNlSnNvbihqc29uKSB7XG4gIHJldHVybiAvKiogQHR5cGUgez9Kc29uT2JqZWN0fSAqLyhKU09OLnBhcnNlKC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAoanNvbikpKTtcbn1cblxuLyoqXG4gKiBQYXJzZXMgdGhlIGdpdmVuIGBqc29uYCBzdHJpbmcgd2l0aG91dCB0aHJvd2luZyBhbiBleGNlcHRpb24gaWYgbm90IHZhbGlkLlxuICogUmV0dXJucyBgdW5kZWZpbmVkYCBpZiBwYXJzaW5nIGZhaWxzLlxuICogUmV0dXJucyB0aGUgYE9iamVjdGAgY29ycmVzcG9uZGluZyB0byB0aGUgSlNPTiBzdHJpbmcgd2hlbiBwYXJzaW5nIHN1Y2NlZWRzLlxuICogQHBhcmFtIHsqfSBqc29uIEpTT04gc3RyaW5nIHRvIHBhcnNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFcnJvcik9fSBvcHRfb25GYWlsZWQgT3B0aW9uYWwgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZFxuICogICAgIHdpdGggdGhlIGVycm9yIGlmIHBhcnNpbmcgZmFpbHMuXG4gKiBAcmV0dXJuIHs/SnNvbk9iamVjdHx1bmRlZmluZWR9IE1heSBiZSBleHRlbmQgdG8gcGFyc2UgYXJyYXlzLlxuICovXG5mdW5jdGlvbiB0cnlQYXJzZUpzb24oanNvbiwgb3B0X29uRmFpbGVkKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHBhcnNlSnNvbihqc29uKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGlmIChvcHRfb25GYWlsZWQpIHtcbiAgICAgIG9wdF9vbkZhaWxlZChlKTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG4vKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBTdWJzY3JpYmUgd2l0aCBHb29nbGUgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmNvbnN0IEFMUkVBRFlfU0VFTiA9ICdfX1NXRy1TRUVOX18nO1xuXG5cbi8qKlxuICovXG5jbGFzcyBQYWdlQ29uZmlnUmVzb2x2ZXIge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d8IURvY3VtZW50fCFEb2N9IHdpbk9yRG9jXG4gICAqL1xuICBjb25zdHJ1Y3Rvcih3aW5PckRvYykge1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFEb2N9ICovXG4gICAgdGhpcy5kb2NfID0gcmVzb2x2ZURvYyh3aW5PckRvYyk7XG5cbiAgICAvKiogQHByaXZhdGUgez9mdW5jdGlvbigoIVBhZ2VDb25maWd8IVByb21pc2UpKX0gKi9cbiAgICB0aGlzLmNvbmZpZ1Jlc29sdmVyXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshUHJvbWlzZTwhUGFnZUNvbmZpZz59ICovXG4gICAgdGhpcy5jb25maWdQcm9taXNlXyA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgdGhpcy5jb25maWdSZXNvbHZlcl8gPSByZXNvbHZlO1xuICAgIH0pO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IU1ldGFQYXJzZXJ9ICovXG4gICAgdGhpcy5tZXRhUGFyc2VyXyA9IG5ldyBNZXRhUGFyc2VyKHRoaXMuZG9jXyk7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IUpzb25MZFBhcnNlcn0gKi9cbiAgICB0aGlzLmxkUGFyc2VyXyA9IG5ldyBKc29uTGRQYXJzZXIodGhpcy5kb2NfKTtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshTWljcm9kYXRhUGFyc2VyfSAqL1xuICAgIHRoaXMubWljcm9kYXRhUGFyc2VyXyA9IG5ldyBNaWNyb2RhdGFQYXJzZXIodGhpcy5kb2NfKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhUGFnZUNvbmZpZz59XG4gICAqL1xuICByZXNvbHZlQ29uZmlnKCkge1xuICAgIC8vIFRyeSByZXNvbHZlIHRoZSBjb25maWcgYXQgZGlmZmVyZW50IHRpbWVzLlxuICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4odGhpcy5jaGVjay5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmRvY18ud2hlblJlYWR5KCkudGhlbih0aGlzLmNoZWNrLmJpbmQodGhpcykpO1xuICAgIHJldHVybiB0aGlzLmNvbmZpZ1Byb21pc2VfO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4gez9QYWdlQ29uZmlnfVxuICAgKi9cbiAgY2hlY2soKSB7XG4gICAgLy8gQWxyZWFkeSByZXNvbHZlZC5cbiAgICBpZiAoIXRoaXMuY29uZmlnUmVzb2x2ZXJfKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgbGV0IGNvbmZpZyA9IHRoaXMubWV0YVBhcnNlcl8uY2hlY2soKTtcbiAgICBpZiAoIWNvbmZpZykge1xuICAgICAgY29uZmlnID0gdGhpcy5sZFBhcnNlcl8uY2hlY2soKTtcbiAgICB9XG4gICAgaWYgKCFjb25maWcpIHtcbiAgICAgIGNvbmZpZyA9IHRoaXMubWljcm9kYXRhUGFyc2VyXy5jaGVjaygpO1xuICAgIH1cbiAgICBpZiAoY29uZmlnKSB7XG4gICAgICAvLyBQcm9kdWN0IElEIGhhcyBiZWVuIGZvdW5kOiBpbml0aWFsaXplIHRoZSByZXN0IG9mIHRoZSBjb25maWcuXG4gICAgICB0aGlzLmNvbmZpZ1Jlc29sdmVyXyhjb25maWcpO1xuICAgICAgdGhpcy5jb25maWdSZXNvbHZlcl8gPSBudWxsO1xuICAgIH0gZWxzZSBpZiAodGhpcy5kb2NfLmlzUmVhZHkoKSkge1xuICAgICAgdGhpcy5jb25maWdSZXNvbHZlcl8oUHJvbWlzZS5yZWplY3QoXG4gICAgICAgICAgbmV3IEVycm9yKCdObyBjb25maWcgY291bGQgYmUgZGlzY292ZXJlZCBpbiB0aGUgcGFnZScpKSk7XG4gICAgICB0aGlzLmNvbmZpZ1Jlc29sdmVyXyA9IG51bGw7XG4gICAgfVxuICAgIHJldHVybiBjb25maWc7XG4gIH1cbn1cblxuXG5jbGFzcyBNZXRhUGFyc2VyIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IURvY30gZG9jXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihkb2MpIHtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshRG9jfSAqL1xuICAgIHRoaXMuZG9jXyA9IGRvYztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHs/UGFnZUNvbmZpZ31cbiAgICovXG4gIGNoZWNrKCkge1xuICAgIGlmICghdGhpcy5kb2NfLmdldEJvZHkoKSkge1xuICAgICAgLy8gV2FpdCB1bnRpbCB0aGUgd2hvbGUgYDxoZWFkPmAgaXMgcGFyc2VkLlxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLy8gVHJ5IHRvIGZpbmQgcHJvZHVjdCBpZC5cbiAgICBjb25zdCBwcm9kdWN0SWQgPSBnZXRNZXRhVGFnKHRoaXMuZG9jXy5nZXRSb290Tm9kZSgpLFxuICAgICAgICAnc3Vic2NyaXB0aW9ucy1wcm9kdWN0LWlkJyk7XG4gICAgaWYgKCFwcm9kdWN0SWQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIElzIGxvY2tlZD9cbiAgICBjb25zdCBhY2Nlc3NpYmxlRm9yRnJlZSA9IGdldE1ldGFUYWcodGhpcy5kb2NfLmdldFJvb3ROb2RlKCksXG4gICAgICAgICdzdWJzY3JpcHRpb25zLWFjY2Vzc2libGUtZm9yLWZyZWUnKTtcbiAgICBjb25zdCBsb2NrZWQgPSAoYWNjZXNzaWJsZUZvckZyZWUgJiZcbiAgICAgICAgYWNjZXNzaWJsZUZvckZyZWUudG9Mb3dlckNhc2UoKSA9PSAnZmFsc2UnKSB8fCBmYWxzZTtcblxuICAgIHJldHVybiBuZXcgUGFnZUNvbmZpZyhwcm9kdWN0SWQsIGxvY2tlZCk7XG4gIH1cbn1cblxuXG5jbGFzcyBKc29uTGRQYXJzZXIge1xuICAvKipcbiAgICogQHBhcmFtIHshRG9jfSBkb2NcbiAgICovXG4gIGNvbnN0cnVjdG9yKGRvYykge1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFEb2N9ICovXG4gICAgdGhpcy5kb2NfID0gZG9jO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4gez9QYWdlQ29uZmlnfVxuICAgKi9cbiAgY2hlY2soKSB7XG4gICAgaWYgKCF0aGlzLmRvY18uZ2V0Qm9keSgpKSB7XG4gICAgICAvLyBXYWl0IHVudGlsIHRoZSB3aG9sZSBgPGhlYWQ+YCBpcyBwYXJzZWQuXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBkb21SZWFkeSA9IHRoaXMuZG9jXy5pc1JlYWR5KCk7XG5cbiAgICAvLyB0eXBlOiAnYXBwbGljYXRpb24vbGQranNvbidcbiAgICBjb25zdCBlbGVtZW50cyA9IHRoaXMuZG9jXy5nZXRSb290Tm9kZSgpLnF1ZXJ5U2VsZWN0b3JBbGwoXG4gICAgICAgICdzY3JpcHRbdHlwZT1cImFwcGxpY2F0aW9uL2xkK2pzb25cIl0nKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBlbGVtZW50ID0gZWxlbWVudHNbaV07XG4gICAgICBpZiAoZWxlbWVudFtBTFJFQURZX1NFRU5dIHx8XG4gICAgICAgICAgIWVsZW1lbnQudGV4dENvbnRlbnQgfHxcbiAgICAgICAgICAhZG9tUmVhZHkgJiYgIWhhc05leHROb2RlSW5Eb2N1bWVudE9yZGVyKGVsZW1lbnQpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgZWxlbWVudFtBTFJFQURZX1NFRU5dID0gdHJ1ZTtcbiAgICAgIGlmIChlbGVtZW50LnRleHRDb250ZW50LmluZGV4T2YoJ05ld3NBcnRpY2xlJykgPT0gLTEpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBjb25zdCBwb3NzaWJsZUNvbmZpZyA9IHRoaXMudHJ5RXh0cmFjdENvbmZpZ18oZWxlbWVudCk7XG4gICAgICBpZiAocG9zc2libGVDb25maWcpIHtcbiAgICAgICAgcmV0dXJuIHBvc3NpYmxlQ29uZmlnO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gICAqIEByZXR1cm4gez9QYWdlQ29uZmlnfVxuICAgKi9cbiAgdHJ5RXh0cmFjdENvbmZpZ18oZWxlbWVudCkge1xuICAgIGNvbnN0IGpzb24gPSB0cnlQYXJzZUpzb24oZWxlbWVudC50ZXh0Q29udGVudCk7XG4gICAgaWYgKCFqc29uKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBNdXN0IGJlIGEgTmV3c0FydGljbGUuXG4gICAgaWYgKCF0aGlzLmNoZWNrVHlwZV8oanNvbiwgJ05ld3NBcnRpY2xlJykpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIE11c3QgaGF2ZSBhIGlzUGFydE9mW0B0eXBlPVByb2R1Y3RdLlxuICAgIGxldCBwcm9kdWN0SWQgPSBudWxsO1xuICAgIGNvbnN0IHBhcnRPZkFycmF5ID0gdGhpcy52YWx1ZUFycmF5Xyhqc29uLCAnaXNQYXJ0T2YnKTtcbiAgICBpZiAocGFydE9mQXJyYXkpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFydE9mQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgcHJvZHVjdElkID0gdGhpcy5kaXNjb3ZlclByb2R1Y3RJZF8ocGFydE9mQXJyYXlbaV0pO1xuICAgICAgICBpZiAocHJvZHVjdElkKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFwcm9kdWN0SWQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIEZvdW5kIHByb2R1Y3QgaWQsIGp1c3QgY2hlY2sgZm9yIHRoZSBhY2Nlc3MgZmxhZy5cbiAgICBjb25zdCBpc0FjY2Vzc2libGVGb3JGcmVlID0gdGhpcy5ib29sXyhcbiAgICAgICAgdGhpcy5zaW5nbGVWYWx1ZV8oanNvbiwgJ2lzQWNjZXNzaWJsZUZvckZyZWUnKSxcbiAgICAgICAgLyogZGVmYXVsdCAqLyB0cnVlKTtcblxuICAgIHJldHVybiBuZXcgUGFnZUNvbmZpZyhwcm9kdWN0SWQsICFpc0FjY2Vzc2libGVGb3JGcmVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyp9IHZhbHVlXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gZGVmXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBib29sXyh2YWx1ZSwgZGVmKSB7XG4gICAgaWYgKHZhbHVlID09IG51bGwgfHwgdmFsdWUgPT09ICcnKSB7XG4gICAgICByZXR1cm4gZGVmO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHZhbHVlID09ICdib29sZWFuJykge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKSB7XG4gICAgICBjb25zdCBsb3dlcmNhc2UgPSB2YWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgaWYgKGxvd2VyY2FzZSA9PSAnZmFsc2UnKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChsb3dlcmNhc2UgPT0gJ3RydWUnKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZGVmO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IU9iamVjdH0ganNvblxuICAgKiBAcmV0dXJuIHs/c3RyaW5nfVxuICAgKi9cbiAgZGlzY292ZXJQcm9kdWN0SWRfKGpzb24pIHtcbiAgICAvLyBNdXN0IGhhdmUgdHlwZSBgUHJvZHVjdGAuXG4gICAgaWYgKCF0aGlzLmNoZWNrVHlwZV8oanNvbiwgJ1Byb2R1Y3QnKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiAvKiogQHR5cGUgez9zdHJpbmd9ICovICh0aGlzLnNpbmdsZVZhbHVlXyhqc29uLCAncHJvZHVjdElEJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IU9iamVjdH0ganNvblxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcmV0dXJuIHs/QXJyYXl9XG4gICAqL1xuICB2YWx1ZUFycmF5Xyhqc29uLCBuYW1lKSB7XG4gICAgY29uc3QgdmFsdWUgPSBqc29uW25hbWVdO1xuICAgIGlmICh2YWx1ZSA9PSBudWxsIHx8IHZhbHVlID09PSAnJykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiBpc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFPYmplY3R9IGpzb25cbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICogQHJldHVybiB7Kn1cbiAgICovXG4gIHNpbmdsZVZhbHVlXyhqc29uLCBuYW1lKSB7XG4gICAgY29uc3QgdmFsdWVBcnJheSA9IHRoaXMudmFsdWVBcnJheV8oanNvbiwgbmFtZSk7XG4gICAgY29uc3QgdmFsdWUgPSB2YWx1ZUFycmF5ICYmIHZhbHVlQXJyYXlbMF07XG4gICAgcmV0dXJuICh2YWx1ZSA9PSBudWxsIHx8IHZhbHVlID09PSAnJykgPyBudWxsIDogdmFsdWU7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshT2JqZWN0fSBqc29uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBleHBlY3RlZFR5cGVcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGNoZWNrVHlwZV8oanNvbiwgZXhwZWN0ZWRUeXBlKSB7XG4gICAgY29uc3QgdHlwZUFycmF5ID0gdGhpcy52YWx1ZUFycmF5Xyhqc29uLCAnQHR5cGUnKTtcbiAgICBpZiAoIXR5cGVBcnJheSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gKHR5cGVBcnJheS5pbmNsdWRlcyhleHBlY3RlZFR5cGUpIHx8XG4gICAgICAgIHR5cGVBcnJheS5pbmNsdWRlcygnaHR0cDovL3NjaGVtYS5vcmcvJyArIGV4cGVjdGVkVHlwZSkpO1xuICB9XG59XG5cbmNsYXNzIE1pY3JvZGF0YVBhcnNlciB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFEb2N9IGRvY1xuICAgKi9cbiAgY29uc3RydWN0b3IoZG9jKSB7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IURvY30gKi9cbiAgICB0aGlzLmRvY18gPSBkb2M7XG4gICAgLyoqIEBwcml2YXRlIHs/Ym9vbGVhbn0gKi9cbiAgICB0aGlzLmFjY2Vzc18gPSBudWxsO1xuICAgIC8qKiBAcHJpdmF0ZSB7P3N0cmluZ30gKi9cbiAgICB0aGlzLnByb2R1Y3RJZF8gPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgZmFsc2UgaWYgYWNjZXNzIGlzIHJlc3RyaWN0ZWQsIG90aGVyd2lzZSB0cnVlXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IHJvb3QgQW4gZWxlbWVudCB0aGF0IGlzIGFuIGl0ZW0gb2YgdHlwZSAnTmV3c0FydGljbGUnXG4gICAqIEByZXR1cm4gez9ib29sZWFufSBsb2NrZWQgYWNjZXNzXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBkaXNjb3ZlckFjY2Vzc18ocm9vdCkge1xuICAgIGNvbnN0IEFMUkVBRFlfU0VFTiA9ICdhbHJlYWR5U2VlbkZvckFjY2Vzc0luZm8nO1xuICAgIGNvbnN0IG5vZGVMaXN0ID0gcm9vdFxuICAgICAgICAucXVlcnlTZWxlY3RvckFsbChcIltpdGVtcHJvcD0naXNBY2Nlc3NpYmxlRm9yRnJlZSddXCIpO1xuICAgIGZvciAobGV0IGkgPSAwOyBub2RlTGlzdFtpXTsgaSsrKSB7XG4gICAgICBjb25zdCBlbGVtZW50ID0gbm9kZUxpc3RbaV07XG4gICAgICBjb25zdCBjb250ZW50ID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKSB8fCBlbGVtZW50LnRleHRDb250ZW50O1xuICAgICAgaWYgKCFjb250ZW50KSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuaXNWYWxpZEVsZW1lbnRfKGVsZW1lbnQsIHJvb3QsIEFMUkVBRFlfU0VFTikpIHtcbiAgICAgICAgbGV0IGFjY2Vzc0ZvckZyZWUgPSBudWxsO1xuICAgICAgICBpZiAoY29udGVudC50b0xvd2VyQ2FzZSgpID09ICd0cnVlJykge1xuICAgICAgICAgIGFjY2Vzc0ZvckZyZWUgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKGNvbnRlbnQudG9Mb3dlckNhc2UoKSA9PSAnZmFsc2UnKSB7XG4gICAgICAgICAgYWNjZXNzRm9yRnJlZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhY2Nlc3NGb3JGcmVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmllcyBpZiBhbiBlbGVtZW50IGlzIHZhbGlkIGJhc2VkIG9uIHRoZSBmb2xsb3dpbmdcbiAgICogLSBjaGlsZCBvZiBhbiBpdGVtIG9mIHR5cGUgJ05ld3NBcnRpY2xlJ1xuICAgKiAtIG5vdCBhIGNoaWxkIG9mIGFuIGl0ZW0gb2YgYW55IG90aGVyIHR5cGVcbiAgICogLSBub3Qgc2VlbiBiZWZvcmUsIG1hcmtlZCB1c2luZyB0aGUgYWxyZWFkeVNlZW4gdGFnXG4gICAqIEBwYXJhbSB7P0VsZW1lbnR9IGN1cnJlbnQgdGhlIGVsZW1lbnQgdG8gYmUgdmVyaWZpZWRcbiAgICogQHBhcmFtIHshRWxlbWVudH0gcm9vdCB0aGUgcGFyZW50IHRvIHRyYWNrIHVwIHRvXG4gICAqIEBwYXJhbSB7IXN0cmluZ30gYWxyZWFkeVNlZW4gdXNlZCB0byB0YWcgYWxyZWFkeSB2aXNpdGVkIG5vZGVzXG4gICAqIEByZXR1cm4geyFib29sZWFufSB2YWxpZCBub2RlXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBpc1ZhbGlkRWxlbWVudF8oY3VycmVudCwgcm9vdCwgYWxyZWFkeVNlZW4pIHtcbiAgICBmb3IgKGxldCBub2RlID0gY3VycmVudDtcbiAgICAgICAgbm9kZSAmJiAhbm9kZVthbHJlYWR5U2Vlbl07IG5vZGUgPSBub2RlLnBhcmVudE5vZGUpIHtcbiAgICAgIG5vZGVbYWxyZWFkeVNlZW5dID0gdHJ1ZTtcbiAgICAgIGlmIChub2RlLmhhc0F0dHJpYnV0ZSgnaXRlbXNjb3BlJykpIHtcbiAgICAgICAgLyoqez9zdHJpbmd9ICovXG4gICAgICAgIGNvbnN0IHR5cGUgPSBub2RlLmdldEF0dHJpYnV0ZSgnaXRlbXR5cGUnKTtcbiAgICAgICAgaWYgKHR5cGUuaW5kZXhPZignaHR0cDovL3NjaGVtYS5vcmcvTmV3c0FydGljbGUnKSA+PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnRhaW5zIHRoZSBwcm9kdWN0IElEIHRoYXQgbWVldHMgdGhlIHJlcXVpcmVtZW50c1xuICAgKiAtIGNoaWxkIG9mIGFuIGl0ZW0gb2YgdHlwZSAnTmV3c0FydGljbGUnXG4gICAqIC0gTm90IGEgY2hpbGQgb2YgYW4gaXRlbSBvZiB0eXBlICdTZWN0aW9uJ1xuICAgKiAtIGNoaWxkIG9mIGFuIGl0ZW0gb2YgdHlwZSAncHJvZHVjdElEJ1xuICAgKiBAcGFyYW0geyFFbGVtZW50fSByb290IEFuIGVsZW1lbnQgdGhhdCBpcyBhbiBpdGVtIG9mIHR5cGUgJ05ld3NBcnRpY2xlJ1xuICAgKiBAcmV0dXJuIHs/c3RyaW5nfSBwcm9kdWN0IElELCBpZiBmb3VuZFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZGlzY292ZXJQcm9kdWN0SWRfKHJvb3QpIHtcbiAgICBjb25zdCBBTFJFQURZX1NFRU4gPSAnYWxyZWFkeVNlZW5Gb3JQcm9kdWN0SW5mbyc7XG4gICAgY29uc3Qgbm9kZUxpc3QgPSByb290XG4gICAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKCdbaXRlbXByb3A9XCJwcm9kdWN0SURcIl0nKTtcbiAgICBmb3IgKGxldCBpID0gMDsgbm9kZUxpc3RbaV07IGkrKykge1xuICAgICAgY29uc3QgZWxlbWVudCA9IG5vZGVMaXN0W2ldO1xuICAgICAgY29uc3QgY29udGVudCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdjb250ZW50JykgfHwgZWxlbWVudC50ZXh0Q29udGVudDtcbiAgICAgIGNvbnN0IGl0ZW0gPSBlbGVtZW50LmNsb3Nlc3QoJ1tpdGVtdHlwZV1baXRlbXNjb3BlXScpO1xuICAgICAgY29uc3QgdHlwZSA9IGl0ZW0uZ2V0QXR0cmlidXRlKCdpdGVtdHlwZScpO1xuICAgICAgaWYgKHR5cGUuaW5kZXhPZignaHR0cDovL3NjaGVtYS5vcmcvUHJvZHVjdCcpIDw9IC0xKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuaXNWYWxpZEVsZW1lbnRfKGl0ZW0ucGFyZW50RWxlbWVudCwgcm9vdCwgQUxSRUFEWV9TRUVOKSkge1xuICAgICAgICByZXR1cm4gY29udGVudDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBQYWdlQ29uZmlnIGlmIGF2YWlsYWJsZVxuICAgKiBAcmV0dXJuIHs/UGFnZUNvbmZpZ30gUGFnZUNvbmZpZyBmb3VuZCBzbyBmYXJcbiAgICovXG4gIGdldFBhZ2VDb25maWdfKCkge1xuICAgIGxldCBsb2NrZWQgPSBudWxsO1xuICAgIGlmICh0aGlzLmFjY2Vzc18gIT0gbnVsbCkge1xuICAgICAgbG9ja2VkID0gIXRoaXMuYWNjZXNzXztcbiAgICB9IGVsc2UgaWYgKHRoaXMuZG9jXy5pc1JlYWR5KCkpIHtcbiAgICAgIC8vIERlZmF1bHQgdG8gdW5sb2NrZWRcbiAgICAgIGxvY2tlZCA9IGZhbHNlO1xuICAgIH1cbiAgICBpZiAodGhpcy5wcm9kdWN0SWRfICE9IG51bGwgJiYgbG9ja2VkICE9IG51bGwpIHtcbiAgICAgIHJldHVybiBuZXcgUGFnZUNvbmZpZyh0aGlzLnByb2R1Y3RJZF8sIGxvY2tlZCk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3RzIHBhZ2UgY29uZmlnIGZyb20gTWljcm9kYXRhIGluIHRoZSBET01cbiAgICogQHJldHVybiB7P1BhZ2VDb25maWd9IFBhZ2VDb25maWcgZm91bmRcbiAgICovXG4gIHRyeUV4dHJhY3RDb25maWdfKCkge1xuICAgIGxldCBjb25maWcgPSB0aGlzLmdldFBhZ2VDb25maWdfKCk7XG4gICAgaWYgKGNvbmZpZykge1xuICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICB9XG4gICAgY29uc3Qgbm9kZUxpc3QgPSB0aGlzLmRvY18uZ2V0Um9vdE5vZGUoKS5xdWVyeVNlbGVjdG9yQWxsKFxuICAgICAgICAnW2l0ZW1zY29wZV1baXRlbXR5cGUqPVwiaHR0cDovL3NjaGVtYS5vcmcvTmV3c0FydGljbGVcIl0nKTtcbiAgICBmb3IgKGxldCBpID0gMDsgbm9kZUxpc3RbaV0gJiYgY29uZmlnID09IG51bGw7IGkrKykge1xuICAgICAgY29uc3QgZWxlbWVudCA9IG5vZGVMaXN0W2ldO1xuICAgICAgaWYgKHRoaXMuYWNjZXNzXyA9PSBudWxsKSB7XG4gICAgICAgIHRoaXMuYWNjZXNzXyA9IHRoaXMuZGlzY292ZXJBY2Nlc3NfKGVsZW1lbnQpO1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLnByb2R1Y3RJZF8pIHtcbiAgICAgICAgdGhpcy5wcm9kdWN0SWRfID0gdGhpcy5kaXNjb3ZlclByb2R1Y3RJZF8oZWxlbWVudCk7XG4gICAgICB9XG4gICAgICBjb25maWcgPSB0aGlzLmdldFBhZ2VDb25maWdfKCk7XG4gICAgfVxuICAgIHJldHVybiBjb25maWc7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7P1BhZ2VDb25maWd9XG4gICAqL1xuICBjaGVjaygpIHtcbiAgICBpZiAoIXRoaXMuZG9jXy5nZXRCb2R5KCkpIHtcbiAgICAgIC8vIFdhaXQgdW50aWwgdGhlIHdob2xlIGA8aGVhZD5gIGlzIHBhcnNlZC5cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy50cnlFeHRyYWN0Q29uZmlnXygpO1xuICB9XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgdmFsdWUgZnJvbSBjb250ZW50IGF0dHJpYnV0ZSBvZiBhIG1ldGEgdGFnIHdpdGggZ2l2ZW4gbmFtZS5cbiAqXG4gKiBJZiBtdWx0aXBsZSB0YWdzIGFyZSBmb3VuZCwgdGhlIGZpcnN0IHZhbHVlIGlzIHJldHVybmVkLlxuICpcbiAqIEBwYXJhbSB7IU5vZGV9IHJvb3ROb2RlXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBUaGUgdGFnIG5hbWUgdG8gbG9vayBmb3IuXG4gKiBAcmV0dXJuIHs/c3RyaW5nfSBhdHRyaWJ1dGUgdmFsdWUgb3IgZW1wdHkgc3RyaW5nLlxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gZ2V0TWV0YVRhZyhyb290Tm9kZSwgbmFtZSkge1xuICBjb25zdCBlbCA9IHJvb3ROb2RlLnF1ZXJ5U2VsZWN0b3IoYG1ldGFbbmFtZT1cIiR7bmFtZX1cIl1gKTtcbiAgaWYgKGVsKSB7XG4gICAgcmV0dXJuIGVsLmdldEF0dHJpYnV0ZSgnY29udGVudCcpO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBTdWJzY3JpYmUgd2l0aCBHb29nbGUgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuZXhwb3J0IHtcbiAgRG9jLFxuICBQYWdlQ29uZmlnLFxuICBQYWdlQ29uZmlnUmVzb2x2ZXIsXG59O1xuIl19"}