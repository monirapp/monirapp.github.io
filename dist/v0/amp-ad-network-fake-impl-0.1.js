(self.AMP=self.AMP||[]).push({n:"amp-ad-network-fake-impl",v:"0",f:(function(AMP,_){
var g;function aa(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]}function p(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(c){return b}};var ba=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function t(a){var b=Object.create(null);if(!a)return b;for(var c;c=ba.exec(a);){var d=p(c[1],c[1]),e=c[2]?p(c[2],c[2]):"";b[d]=e}return b};var ca="";
function w(a){var b=a||self,c;if(b.AMP_MODE)c=b.AMP_MODE;else{c=b;var d=!!(self.AMP_CONFIG||{}).test||!1,e=t(c.location.originalHash||c.location.hash),f=t(c.location.search);ca||(ca=c.AMP_CONFIG&&c.AMP_CONFIG.v?c.AMP_CONFIG.v:"010");c=b.AMP_MODE={localDev:!1,development:!("1"!=e.development&&!c.AMP_DEV_MODE),examiner:"2"==e.development,filter:e.filter,geoOverride:e["amp-geo"],minified:!0,lite:void 0!=f.amp_lite,test:d,log:e.log,version:"0",rtvVersion:ca}}return c};var da=Object.prototype.toString;function ea(a){return"number"===typeof a&&isFinite(a)};function fa(a){var b=a.message,c=String(Math.random());a.message=c;if(a.message===c)return a.message=b,a;var b=Error(a.message),d;for(d in a)b[d]=a[d];b.stack=a.stack;return b}function ga(a){for(var b=null,c="",d=0;d<arguments.length;d++){var e=arguments[d];e instanceof Error&&!b?b=fa(e):(c&&(c+=" "),c+=e)}b?c&&(b.message=c+": "+b.message):b=Error(c);return b}function y(a){var b=ga.apply(null,arguments);setTimeout(function(){self.reportError(b);throw b;})}self.log=self.log||{user:null,dev:null,userForEmbed:null};
var A=self.log;function B(){if(!A.user)throw Error("failed to call initLogConstructor");return A.user}function C(){if(A.dev)return A.dev;throw Error("failed to call initLogConstructor");};var D=Object.prototype.hasOwnProperty;function E(){var a,b=Object.create(null);a&&Object.assign(b,a);return b}function F(a){return a||{}};function ia(){var a,b;this.promise=new Promise(function(c,d){a=c;b=d});this.resolve=a;this.reject=b}function ja(a){return new Promise(function(b){b(a())})};function ka(a,b){if(a.nodeType){var c=la((a.ownerDocument||a).defaultView,b);if(c)return c}return G(a,b)}function ma(a,b){var c=I(a);la(a,"url-replace");na(a,a,function(){return b});M(a,"url-replace")}function la(a,b){var c=I(a);return a!=c&&oa(a,b)?M(a,b):null}function N(a,b){a=I(a);return M(a,b)}function pa(a){var b=O(a),b=qa(b);return M(b,"documentInfo")}function G(a,b){a=O(a);a=qa(a);return M(a,b)}function ra(a,b){return sa(qa(a),b)}function I(a){return a.__AMP_TOP||a}
function O(a){return a.nodeType?N((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function qa(a){a=O(a);return a.isSingleDoc()?a.win:a}function M(a,b){oa(a,b);var c=P(a);a=c[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function na(a,b,c){var d=P(a),e=d["url-replace"];e||(e=d["url-replace"]={obj:null,promise:null,resolve:null,context:null,ctor:null});e.ctor||e.obj||(e.ctor=c,e.context=b,e.resolve&&M(a,"url-replace"))}
function sa(a,b){var c=P(a)[b];if(c){if(c.promise)return c.promise;M(a,b);return c.promise=Promise.resolve(c.obj)}return null}function P(a){var b=a.services;b||(b=a.services={});return b}function ta(a){a=P(a);var b={},c;for(c in a)if(b.id=c,Object.prototype.hasOwnProperty.call(a,b.id)){var d=a[b.id];d.obj?ua(b.id,d.obj):d.promise&&d.promise.then(function(a){return function(b){return ua(a.id,b)}}(b));b={id:b.id}}}
function ua(a,b){if("function"==typeof b.dispose)try{b.dispose()}catch(c){C().error("SERVICE","failed to dispose service",a,c)}}function oa(a,b){a=a.services&&a.services[b];return!(!a||!a.ctor&&!a.obj)};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function va(a,b){return b.length>a.length?!1:0==a.lastIndexOf(b,0)};var wa={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},xa=/(&|<|>|"|'|`)/g;function ya(a,b,c){a=a.createElement(b);for(var d in c)a.setAttribute(d,c[d]);return a}function za(a){return a?a.replace(xa,Aa):a}function Aa(a){return wa[a]};function Ba(a,b,c){var d=O(a),e=ra(a,b);return e?e:d.whenBodyAvailable().then(function(){var a;a=d.win;var b=d.getHeadNode(),e;if(b){e=[];for(var b=b.querySelectorAll("script[custom-element]"),l=0;l<b.length;l++)e.push(b[l].getAttribute("custom-element"))}else e=[];a=e.includes(c)?N(a,"extensions").waitForExtension(a,c):Promise.resolve();return a}).then(function(){var e=d.win;if(e.ampExtendedElements&&e.ampExtendedElements[c]){var e=qa(a),h=sa(e,b);if(!h){var k=new ia,h=k.promise,k=k.resolve;P(e)[b]=
{obj:null,promise:h,resolve:k,context:null,ctor:null}}e=h}else e=null;return e})};function Ca(a){return Ba(a,"amp-analytics-instrumentation","amp-analytics")}function Da(a){return G(a,"resources")};function Ea(a){this.ba=a;this.U=this.W=0;this.P=Object.create(null)}Ea.prototype.has=function(a){return!!this.P[a]};Ea.prototype.get=function(a){var b=this.P[a];if(b)return b.access=++this.U,b.payload};Ea.prototype.put=function(a,b){this.has(a)||this.W++;this.P[a]={payload:b,access:this.U};if(!(this.W<=this.ba)){C().warn("lru-cache","Trimming LRU cache");a=this.P;var c=this.U+1,d,e;for(e in a){var f=a[e].access;f<c&&(c=f,d=e)}void 0!==d&&(delete a[d],this.W--)}};var Q=self.AMP_CONFIG||{},Fa={thirdParty:Q.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:Q.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:("string"==typeof Q.thirdPartyFrameRegex?new RegExp(Q.thirdPartyFrameRegex):Q.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,cdn:Q.cdnUrl||"https://cdn.ampproject.org",cdnProxyRegex:("string"==typeof Q.cdnProxyRegex?new RegExp(Q.cdnProxyRegex):Q.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,
errorReporting:Q.errorReportingUrl||"https://amp-error-reporting.appspot.com/r",localDev:Q.localDev||!1};F({c:!0,v:!0,a:!0,ad:!0});var Ga,Ha,Ia=["javascript:","data:","vbscript:"];
function R(a,b){Ga||(Ga=self.document.createElement("a"),Ha=self.UrlCache||(self.UrlCache=new Ea(100)));var c=b?null:Ha,d=Ga;if(c&&c.has(a))a=c.get(a);else{d.href=a;d.protocol||(d.href=d.href);var e={href:d.href,protocol:d.protocol,host:d.host,hostname:d.hostname,port:"0"==d.port?"":d.port,pathname:d.pathname,search:d.search,hash:d.hash,origin:null};"/"!==e.pathname[0]&&(e.pathname="/"+e.pathname);if("http:"==e.protocol&&80==e.port||"https:"==e.protocol&&443==e.port)e.port="",e.host=e.hostname;e.origin=
d.origin&&"null"!=d.origin?d.origin:"data:"!=e.protocol&&e.host?e.protocol+"//"+e.host:e.href;c&&c.put(a,e);a=e}return a}function Ja(a,b){var c;if(!b)return a;var d=a.split("#",2),e=d[0].split("?",2),f=e[0]+(e[1]?c?"?"+b+"&"+e[1]:"?"+e[1]+"&"+b:"?"+b);return f+=d[1]?"#"+d[1]:""}
function Ka(a){var b=[],c;for(c in a){var d=a[c];if(null!=d)if(Array.isArray(d))for(var e=0;e<d.length;e++){var f=d[e];b.push(encodeURIComponent(c)+"="+encodeURIComponent(f))}else b.push(encodeURIComponent(c)+"="+encodeURIComponent(d))}return b.join("&")}function La(a){"string"==typeof a&&(a=R(a));var b;(b="https:"==a.protocol||"localhost"==a.hostname)||(a=a.hostname,b=a.length-10,b=0<=b&&a.indexOf(".localhost",b)==b);return b}
function Ma(a,b){var c;c=void 0===c?"source":c;B().assert(null!=a,"%s %s must be available",b,c);var d=a;B().assert(La(d)||/^(\/\/)/.test(d),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',b,c,d)}function Na(a){if(!a)return!0;"string"==typeof a&&(a=R(a));return!Ia.includes(a.protocol)};function Oa(a){for(var b=a.nodeName,c=0,d=0,e=a.previousElementSibling;e&&25>d&&100>c;)e.nodeName==b&&d++,c++,e=e.previousElementSibling;return 25>d&&100>c?"."+d:""};function Pa(a,b){return Ba(a,"consentPolicyManager","amp-consent").then(function(a){return a?a.whenPolicyResolved(b):null})};var S;function Qa(a,b,c){var d=void 0,e=a,f=c,h;h=function(a){try{return f(a)}catch(n){throw self.reportError(n),n;}};var k=Ra(),l=!1;d&&(l=d.capture);e.addEventListener(b,h,k?d:l);return function(){e&&e.removeEventListener(b,h,k?d:l);h=e=f=null}}function Ra(){if(void 0!==S)return S;S=!1;try{var a={get capture(){S=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(b){}return S};function Sa(a,b,c){var d=c,e=Qa(a,b,function(a){try{d(a)}finally{d=null,e()}});return e}function Ta(a){var b,c;if(a.complete||"complete"==a.readyState||a.document&&"complete"==a.document.readyState)return Promise.resolve(a);var d=new Promise(function(d,f){var e=a.tagName;b="AUDIO"===e||"VIDEO"===e?Sa(a,"loadstart",d):Sa(a,"load",d);e&&(c=Sa(a,"error",f))});return d.then(function(){c&&c();return a},function(){b&&b();var c=a;c&&c.src&&(c=c.src);throw B().createError("Failed to load:",c);})};function Ua(a,b,c){return Ta(a).then(function(){return Va(a,b,c)})}function Va(a,b,c){var d=a.performance&&a.performance.timing;if(d&&0!=d.navigationStart){var e=void 0===c?d[b]:d[c]-d[b];if(ea(e)&&!(0>e))return e}}function Wa(a,b){var c=a.performance&&a.performance.navigation;if(c&&void 0!==c[b])return c[b]}function Xa(a){this.ampdoc=a;this.K=this.L=void 0;this.m=Object.create(null);this.R=!1;Ya(this)}g=Xa.prototype;g.initialize=function(){};
g.get=function(a){this.R||(this.initialize(),this.R=!0);return this.m[a]};g.set=function(a,b){this.m[a]=this.m[a]||{sync:void 0,async:void 0};this.m[a].sync=b;this.K=this.L=void 0;return this};g.setAsync=function(a,b){this.m[a]=this.m[a]||{sync:void 0,async:void 0};this.m[a].async=b;this.K=this.L=void 0;return this};g.setBoth=function(a,b,c){return this.set(a,b).setAsync(a,c)};
g.getExpr=function(a,b,c){var d=this;this.R||(this.initialize(),this.R=!0);var e=a?Object.keys(a):null;if(e&&0<e.length){var f=Object.keys(this.m);e.forEach(function(a){void 0===d.m[a]&&f.push(a)});return Za(this,f,b,c)}this.L||b||(this.L=Za(this,Object.keys(this.m)));!this.K&&b&&(this.K=Za(this,Object.keys(this.m),b,c));return b?this.K:this.L};
function Za(a,b,c,d){Ya(a)&&(b=b.filter(function(b){return Ya(a).includes(b)}));d&&(b=b.filter(function(a){return d[a]}));if(0===b.length){var e=/_^/g;return e}b.sort(function(a,b){return b.length-a.length});var f=b.map(function(a){return"$"===a[0]?"\\"+a:a}).join("|"),h="\\$?("+f+")";c||(h+="(?:\\(((?:\\s*[0-9a-zA-Z-_.]*\\s*(?=,|\\)),?)*)\\s*\\))?");return new RegExp(h,"g")}
function Ya(a){if(a.X)return a.X;var b=a.ampdoc.getRootNode().head;if(!b)return null;var c=b.querySelector('meta[name="amp-allowed-url-macros"]');if(!c)return null;a.X=c.getAttribute("content").split(",").map(function(a){return a.trim()});return a.X};function $a(a,b){var c=bb(a);return!!c[b]}
function bb(a){if(a.__AMP__EXPERIMENT_TOGGLES)return a.__AMP__EXPERIMENT_TOGGLES;a.__AMP__EXPERIMENT_TOGGLES=Object.create(null);var b=a.__AMP__EXPERIMENT_TOGGLES;if(a.AMP_CONFIG)for(var c in a.AMP_CONFIG){var d=a.AMP_CONFIG[c];"number"===typeof d&&0<=d&&1>=d&&(b[c]=Math.random()<d)}if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-doc-opt-in"])&&0<a.AMP_CONFIG["allow-doc-opt-in"].length){var e=a.AMP_CONFIG["allow-doc-opt-in"];if(c=a.document.head.querySelector('meta[name="amp-experiments-opt-in"]')){var f=c.getAttribute("content").split(",");
for(c=0;c<f.length;c++)-1!=e.indexOf(f[c])&&(b[f[c]]=!0)}}Object.assign(b,cb(a));if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-url-opt-in"])&&0<a.AMP_CONFIG["allow-url-opt-in"].length){c=a.AMP_CONFIG["allow-url-opt-in"];a=t(a.location.originalHash||a.location.hash);for(var h=0;h<c.length;h++){var k=a["e-"+c[h]];"1"==k&&(b[c[h]]=!0);"0"==k&&(b[c[h]]=!1)}}return b}
function cb(a){a:{var b;try{b=a.document.cookie}catch(h){b=""}if(a=b)for(a=a.split(";"),b=0;b<a.length;b++){var c=a[b].trim(),d=c.indexOf("=");if(-1!=d&&"AMP_EXP"==p(c.substring(0,d).trim(),void 0)){a=c.substring(d+1).trim();a=p(a,a);break a}}a=null}var e=a,f=e?e.split(/\s*,\s*/g):[];a=Object.create(null);for(b=0;b<f.length;b++)0!=f[b].length&&("-"==f[b][0]?a[f[b].substr(1)]=!1:a[f[b]]=!0);return a}
function db(a,b){a.experimentBranches=a.experimentBranches||{};var c={},d;for(d in b)if(D.call(b,d))if(D.call(a.experimentBranches,d))c[d]=a.experimentBranches[d];else if(!b[d].isTrafficEligible||!b[d].isTrafficEligible(a))a.experimentBranches[d]=null;else if(!a.experimentBranches[d]&&$a(a,d)){var e=b[d].branches,f=e;a.experimentBranches[d]=f[Math.floor(Math.random()*f.length)]||null;c[d]=a.experimentBranches[d]}};function eb(){}eb.prototype.maybeSelectExperiment=function(a,b,c,d){var e={};e[d]={isTrafficEligible:function(){return!0},branches:c};db(a,e);return a.experimentBranches?a.experimentBranches[d]:null};new eb;var fb={google:"https://cdn.ampproject.org/amp-ad-verifying-keyset.json","google-dev":"https://cdn.ampproject.org/amp-ad-verifying-keyset-dev.json",cloudflare:"https://amp.cloudflare.com/amp-ad-verifying-keyset.json","cloudflare-dev":"https://amp.cloudflare.com/amp-ad-verifying-keyset-dev.json"};var gb,hb="Webkit webkit Moz moz ms O o".split(" ");function ib(a,b,c){if(va(b,"--"))return b;gb||(gb=E());var d=gb[b];if(!d||c){d=b;if(void 0===a[b]){var e=b.charAt(0).toUpperCase()+b.slice(1);a:{for(var f=0;f<hb.length;f++){var h=hb[f]+e;if(void 0!==a[h]){e=h;break a}}e=""}var k=e;void 0!==a[k]&&(d=k)}c||(gb[b]=d)}return d}function jb(a,b){a=a.style;for(var c in b)a.setProperty(ib(a,c),b[c].toString(),"important")}function T(a,b,c){var d;(b=ib(a.style,b,void 0))&&(a.style[b]=d?c+d:c)}
function kb(a){var b={opacity:1,visibility:"visible",animation:"none"},c;for(c in b)T(a,c,b[c])}function lb(a,b){for(var c=0;c<b.length;c++)T(a,b[c],null)};function mb(a,b,c){Ca(a).then(function(d){d&&d.triggerEventForTarget(a,b,c)})};self.AMPErrors=self.AMPErrors||[];function nb(a,b,c,d){return{left:a,top:b,width:c,height:d,bottom:b+d,right:a+c,x:a,y:b}};function ob(){this.j=null}g=ob.prototype;g.add=function(a){var b=this;this.j||(this.j=[]);this.j.push(a);return function(){b.remove(a)}};g.remove=function(a){this.j&&(a=this.j.indexOf(a),-1<a&&this.j.splice(a,1))};g.removeAll=function(){this.j&&(this.j.length=0)};g.fire=function(a){if(this.j)for(var b=this.j,c=0;c<b.length;c++)(0,b[c])(a)};g.getHandlerCount=function(){return this.j?this.j.length:0};var pb={"AMP-FX-FLYING-CARPET":!0,"AMP-LIGHTBOX":!0,"AMP-STICKY-AD":!0,"AMP-LIGHTBOX-GALLERY":!0};function qb(a){a=parseFloat(a);return ea(a)?a:void 0};function rb(a,b,c,d){var e=Date.now(),f=b.getAttribute("width"),h=b.getAttribute("height");d=d?d:{};d.width=qb(f);d.height=qb(h);b.getAttribute("title")&&(d.title=b.getAttribute("title"));var k=a.location.href;"about:srcdoc"==k&&(k=a.parent.location.href);var l=pa(b).get(),m=G(b,"viewer"),f=m.getUnconfirmedReferrerUrl(),n=b.getPageLayoutBox(),h=d,v=Fa.thirdParty+"/0/ampcontext-v0.js",u=l.sourceUrl,z=l.canonicalUrl,q=l.pageViewId,r={href:k},H=b.tagName,U={localDev:!1,development:w(void 0).development,
filter:w(void 0).filter,minified:!0,lite:w(void 0).lite,test:!1,log:w(void 0).log,version:w(void 0).version,rtvVersion:w(void 0).rtvVersion},J=a,J=!(!J.AMP_CONFIG||!J.AMP_CONFIG.canary),m=!m.isVisible(),Vb=n?{left:n.left,top:n.top,width:n.width,height:n.height}:null,Wb=b.getIntersectionChangeEntry(),x;x=b;for(var ha=[],K=0;x&&1==x.nodeType&&25>K;){var L="";x.id&&(L="/"+x.id);ha.push(""+x.nodeName.toLowerCase()+L+Oa(x));K++;x=x.parentElement}x=ha.join();ha=x.length;K=5381;for(L=0;L<ha;L++)K=33*K^x.charCodeAt(L);
h._context=F({ampcontextVersion:"0",ampcontextFilepath:v,sourceUrl:u,referrer:f,canonicalUrl:z,pageViewId:q,location:r,startTime:e,tagName:H,mode:U,canary:J,hidden:m,initialLayoutRect:Vb,initialIntersection:Wb,domFingerprint:String(K>>>0),experimentToggles:bb(a),sentinel:c});var ab=b.getAttribute("src");ab&&(d.src=ab);return d};function sb(a){var b="nameframe",c=b||"frame";a.defaultBootstrapSubDomain=a.defaultBootstrapSubDomain||"d-"+tb(a);return"https://"+a.defaultBootstrapSubDomain+("."+Fa.thirdPartyFrameHost+"/0/")+(c+".html")}function tb(a){var b;if(a.crypto&&a.crypto.getRandomValues){var c=new Uint32Array(2);a.crypto.getRandomValues(c);b=String(c[0])+c[1]}else b=String(a.Math.random()).substr(2)+"0";return b}
function ub(a){if(a.sandbox&&a.sandbox.supports){for(var b=["allow-top-navigation-by-user-activation","allow-popups-to-escape-sandbox"],c="allow-forms allow-modals allow-pointer-lock allow-popups allow-same-origin allow-scripts".split(" "),d=0;d<b.length;d++){var e=b[d];if(!a.sandbox.supports(e)){C().info("3p-frame","Iframe doesn't support "+e);return}}a.sandbox=b.join(" ")+" "+c.join(" ")}};var vb=null,wb=null;function xb(a,b){void 0===a["3pla"]&&(a["3pla"]=0);a["3pla"]++;if(!vb){var c=new ia;vb=c.promise;wb=c.resolve}N(a,"timer").timeoutPromise(1E3,b).catch(function(){}).then(function(){--a["3pla"]||(wb(),wb=vb=null)})};var yb="AMPDOC_HOST AMPDOC_HOSTNAME AMPDOC_URL AMP_VERSION AVAILABLE_SCREEN_HEIGHT AVAILABLE_SCREEN_WIDTH BACKGROUND_STATE BROWSER_LANGUAGE CANONICAL_HOST CANONICAL_HOSTNAME CANONICAL_PATH CANONICAL_URL COUNTER DOCUMENT_CHARSET DOCUMENT_REFERRER FIRST_CONTENTFUL_PAINT FIRST_VIEWPORT_READY MAKE_BODY_VISIBLE PAGE_VIEW_ID RANDOM SCREEN_COLOR_DEPTH SCREEN_HEIGHT SCREEN_WIDTH SCROLL_HEIGHT SCROLL_LEFT SCROLL_TOP SCROLL_WIDTH SHARE_TRACKING_INCOMING SHARE_TRACKING_OUTGOING SOURCE_HOST SOURCE_HOSTNAME SOURCE_PATH SOURCE_URL TIMESTAMP TIMEZONE TIMEZONE_CODE TITLE TOTAL_ENGAGED_TIME USER_AGENT VARIANT VARIANTS VIEWER VIEWPORT_HEIGHT VIEWPORT_WIDTH".split(" ");
function zb(a,b){Xa.call(this,a);this.da=ka(a,"url-replace").getVariableSource();this.o=b}aa(zb,Xa);
zb.prototype.initialize=function(){var a=this;this.set("AD_NAV_TIMING",function(b,c){B().assert(b,"The first argument to AD_NAV_TIMING, the start attribute name, is required");return Va(a.o,b,c)}).setAsync("AD_NAV_TIMING",function(b,c){B().assert(b,"The first argument to AD_NAV_TIMING, the start attribute name, is required");return Ua(a.o,b,c)});this.set("AD_NAV_TYPE",function(){return Wa(a.o,"type")});this.set("AD_NAV_REDIRECT_COUNT",function(){return Wa(a.o,"redirectCount")});this.set("HTML_ATTR",
this.ea.bind(this));this.set("CLIENT_ID",function(){return null});for(var b=0;b<yb.length;b++){var c=yb[b],d=this.da.get(c);this.set(c,d.sync).setAsync(c,d.async)}};
zb.prototype.ea=function(a,b){var c=20,d=10,e=10,f="A4AVariableSource",h=Array.prototype.slice.call(arguments,1);if(!a||!h.length)return"[]";if(h.length>e)return B().error(f,"At most "+e+" may be requested."),"[]";a=decodeURI(a);var k;try{k=this.o.document.querySelectorAll(a)}catch(q){return B().error(f,"Invalid selector: "+a),"[]"}if(k.length>c)return B().error(f,"CSS selector may match at most "+(c+" elements.")),"[]";for(var l=[],m=0;m<k.length&&l.length<d;++m){for(var n={},v=!1,u=0;u<h.length;++u){var z=
h[u];k[m].hasAttribute(z)&&(n[z]=k[m].getAttribute(z),v=!0)}v&&l.push(n)}return JSON.stringify(l)};function Ab(a){if("undefined"!==typeof TextDecoder)return(new TextDecoder("utf-8")).decode(a);for(var b=new Uint8Array(a.buffer||a),c=Array(b.length),d=0;d<b.length;d++)c[d]=String.fromCharCode(b[d]);var e=c.join("");return decodeURIComponent(escape(e))}function Bb(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++){var d=a.charCodeAt(c);b[c]=d}return b};function Cb(a,b){this.o=a;this.fa=b;this.N=N(a,"crypto").isPkcsAvailable()?{}:null;this.Y=a.performance&&a.performance.now?a.performance.now.bind(a.performance):Date.now}Cb.prototype.loadKeyset=function(a){if(this.N&&!this.N[a]){var b={},c=Db(this,b,a,null);this.N[a]={promise:c,keys:b}}};
Cb.prototype.verify=function(a,b){var c=/^([A-Za-z0-9._-]+):([A-Za-z0-9._-]+):([A-Za-z0-9+/]{341}[AQgw]==)$/;if(!b.has("AMP-Fast-Fetch-Signature"))return Promise.resolve(1);var d=b.get("AMP-Fast-Fetch-Signature");b=c.exec(d);return b?this.verifyCreativeAndSignature(b[1],b[2],Bb(atob(b[3])),a):(B().error("AMP-A4A","Invalid signature header: "+d.split(":")[0]),Promise.resolve(3))};
Cb.prototype.verifyCreativeAndSignature=function(a,b,c,d){var e=this;if(!this.N)return Promise.resolve(4);var f=this.N[a];return f.promise.then(function(h){if(!h)return 1;var k=f.keys[b];return void 0===k?(f.promise=Db(e,f.keys,a,b).then(function(a){void 0===f.keys[b]&&(f.keys[b]=null);return a}),e.verifyCreativeAndSignature(a,b,c,d)):null===k?2:k.then(function(a){if(!a)return 1;var b=N(e.o,"crypto");return b.verifyPkcs(a,c,d).then(function(a){return a?0:3},function(a){a=a&&a.message;C().error("AMP-A4A",
"Failed to verify signature: "+a);return 1})})})};
function Db(a,b,c,d){var e=a.fa[c];null!=d&&(e+="?kid="+encodeURIComponent(d));return N(a.o,"xhr").fetchJson(e,{mode:"cors",method:"GET",ampCors:!1,credentials:"omit"}).then(function(d){d.headers.get("Content-Type");return d.json().then(function(d){var e=d;if(!e||!Array.isArray(e.keys))return V(c,"Key set ("+JSON.stringify(e)+') has no "keys"'),!1;e.keys.forEach(function(d){d&&"string"==typeof d.kid?void 0===b[d.kid]&&(b[d.kid]=N(a.o,"crypto").importPkcsKey(d).catch(function(a){var b=JSON.stringify(d);
V(c,"Failed to import key ("+b+"): "+(a&&a.message));return null})):V(c,"Key ("+JSON.stringify(d)+') has no "kid"')});return!0},function(a){V(c,"Failed to parse JSON: "+(a&&a.response));return!1})},function(a){a&&a.response&&V(c,"Status code "+a.response.status);return!1})}function V(a,b){C().error("AMP-A4A","Signing service error for "+a+": "+b)};function Eb(a,b){var c,d=!0,d=void 0===d?!1:d;c=void 0===c?!1:c;var e=a.ownerDocument,f=ya(e,"amp-analytics",F({sandbox:"true",trigger:c?"":"immediate"})),h=ya(e,"script",F({type:"application/json"}));h.textContent=JSON.stringify(b);f.appendChild(h);f.CONFIG=b;d?(b=N(a.ownerDocument.defaultView,"extensions"),d=O(a),b.installExtensionForDoc(d,"amp-analytics")):Ca(a).then(function(){});a.appendChild(f);return f};function Fb(){this.C=E();this.l=null}g=Fb.prototype;g.get=function(a){return this.C[a]||null};g.whenSignal=function(a){var b=this.l&&this.l[a];if(!b){var c=this.C[a];null!=c?b={promise:"number"==typeof c?Promise.resolve(c):Promise.reject(c)}:(c=new ia,b={promise:c.promise,resolve:c.resolve,reject:c.reject});this.l||(this.l=E());this.l[a]=b}return b.promise};
g.signal=function(a,b){if(null==this.C[a]){var c=b||Date.now();this.C[a]=c;(a=this.l&&this.l[a])&&a.resolve&&(a.resolve(c),a.resolve=void 0,a.reject=void 0)}};g.rejectSignal=function(a,b){null==this.C[a]&&(this.C[a]=b,(a=this.l&&this.l[a])&&a.reject&&(a.reject(b),a.resolve=void 0,a.reject=void 0))};g.reset=function(a){this.C[a]&&delete this.C[a];var b=this.l&&this.l[a];b&&!b.resolve&&delete this.l[a]};var Gb=["AMP-AD","AMP-ANALYTICS","AMP-PIXEL","AMP-AD-EXIT"],Hb;function Ib(a,b){Jb(a,b)}
function Kb(a,b,c,d){function e(){a.contentWindow.addEventListener("securitypolicyviolation",function(a){C().warn("FIE","security policy violation",a)})}var f=I(a.ownerDocument.defaultView),h=N(f,"extensions");T(a,"visibility","hidden");a.setAttribute("referrerpolicy","unsafe-url");c.extensionIds&&c.extensionIds.forEach(function(a){return h.preloadExtension(a)});var k=Lb(c);a.onload=function(){a.readyState="complete"};var l;void 0===Hb&&(Hb="srcdoc"in HTMLIFrameElement.prototype);if(Hb)a.srcdoc=k,
l=Ta(a),b.appendChild(a),e();else{a.src="about:blank";b.appendChild(a);var m=a.contentWindow.document;m.open();e();m.write(k);l=Ta(a.contentWindow);m.close()}var n;n=Mb(a)?Promise.resolve():new Promise(function(b){var c=f.setInterval(function(){Mb(a)&&(b(),f.clearInterval(c))},5);l.catch(function(a){y(a)}).then(function(){b();f.clearInterval(c)})});return n.then(function(){var b=new Nb(a,c,l);a.__AMP_EMBED__=b;h.installExtensionsInChildWindow(a.contentWindow,c.extensionIds||[],d);Ob(b);return b})}
function Mb(a){a=a.contentWindow&&a.contentWindow.document;return!!(a&&"loading"!=a.readyState&&"uninitialized"!=a.readyState&&a.body&&a.body.firstChild)}
function Lb(a){var b=a.html,c=b.toUpperCase(),d=c.indexOf("<HEAD");-1!=d&&(d=c.indexOf(">",d+1)+1);-1==d&&(d=c.indexOf("<BODY"));-1==d&&(d=c.indexOf("<HTML"),-1!=d&&(d=c.indexOf(">",d+1)+1));var e=[];0<d&&e.push(b.substring(0,d));e.push('<base href="'+za(a.url)+'">');a.fonts&&a.fonts.forEach(function(a){e.push('<link href="'+za(a)+'" rel="stylesheet" type="text/css">')});e.push("<meta http-equiv=Content-Security-Policy content=\"script-src 'none';object-src 'none';child-src 'none'\">");0<d?e.push(b.substring(d)):
e.push(b);return e.join("")}function Nb(a,b,c){this.iframe=a;this.win=a.contentWindow;this.spec=b;this.host=b.host||null;this.ga=Date.now();this.T=!1;this.$=new ob;this.M=this.host?this.host.signals():new Fb;this.ha=Promise.all([c,this.whenReady()])}g=Nb.prototype;g.destroy=function(){Da(this.iframe).removeForChildWindow(this.win);ta(this.win)};g.getStartTime=function(){return this.ga};g.getUrl=function(){return this.spec.url};g.signals=function(){return this.M};g.whenReady=function(){return this.M.whenSignal("render-start")};
g.whenWindowLoaded=function(){return this.ha};g.whenIniLoaded=function(){return this.M.whenSignal("ini-load")};
function Ob(a){a.host?a.host.renderStarted():a.M.signal("render-start");T(a.iframe,"visibility","");a.win.document&&a.win.document.body&&(a.win.document.documentElement.classList.add("i-amphtml-fie"),kb(a.win.document.body));var b;b=a.host?a.host.getLayoutBox():nb(0,0,a.win.innerWidth,a.win.innerHeight);Promise.all([a.whenReady(),Pb(a.iframe,a.win,b)]).then(function(){a.M.signal("ini-load")})}g.isVisible=function(){return this.T};g.onVisibilityChanged=function(a){return this.$.add(a)};
function Jb(a,b){a.T!=b&&(a.T=b,a.$.fire(a.T))}g.getBodyElement=function(){return(this.iframe.contentDocument||this.iframe.contentWindow.document).body};function Qb(a,b){return Da(a.iframe).measureMutateElement(a.iframe,b.measure||null,b.mutate)}
g.enterFullOverlayMode=function(){var a=this,b=this.iframe.parentNode;B().assert("amp-ad"==b.tagName.toLowerCase(),"Only <amp-ad> is allowed to enter lightbox mode.");var c;return Qb(this,{measure:function(){var b=a.host?a.host.getLayoutBox():a.iframe.getBoundingClientRect(),e=-G(a.iframe,"viewport").getScrollTop(),b=0==e||0==b.width&&0==b.height?b:nb(b.left+0,b.top+e,b.width,b.height);c={top:b.top+"px",left:b.left+"px",width:b.width+"px",height:b.height+"px"}},mutate:function(){jb(a.iframe,{position:"fixed",
left:0,right:0,bottom:0,width:"100vw",top:0,height:"100vh"});jb(a.getBodyElement(),{background:"transparent",position:"absolute",bottom:"auto",right:"auto",top:c.top,left:c.left,width:c.width,height:c.height})}})};g.leaveFullOverlayMode=function(){var a=this;return Qb(this,{mutate:function(){lb(a.iframe,"position left right top bottom width height".split(" "));lb(a.getBodyElement(),"position top left width height bottom right".split(" "))}})};
function Pb(a,b,c){return Da(a).getResourcesInRect(b,c).then(function(a){var b=[];a.forEach(function(a){Gb.includes(a.element.tagName)||b.push(a.loadedOnce())});return Promise.all(b)})};var Rb={ANCESTOR_ORIGIN:!0};function Sb(a){this.H=a}Sb.prototype.expand=function(a,b,c,d,e){if(!a.length)return d?a:Promise.resolve(a);e=this.H.getExpr(b,!0,e);e=Tb(a,e);return e.length?Ub(this,a,e,b,c,d):d?a:Promise.resolve(a)};function Tb(a,b){var c=[];a.replace(b,function(a,b,f){a=a.length;var d=a+f-1;c.push({start:f,stop:d,name:b,length:a})});return c}
function Ub(a,b,c,d,e,f){function h(){for(var q="",r=[];l<b.length&&m<=c.length;){if(n&&l===n.start){var H=void 0;d&&D.call(d,n.name)?H={name:n.name,prioritized:d[n.name]}:(H=a.H.get(n.name),H.name=n.name);l=n.stop+1;n=c[++m];"("===b[l]?(l++,v++,k.push(H),q.trim().length&&r.push(q),r.push(h())):(q.length&&r.push(q),r.push(Xb(H,void 0,e,f)));q=""}else{if("`"===b[l])u?u=!1:(z=u=!0,B().assert(""===q.trim(),'The substring "'+q+'" was lost during url-replacement. Please ensure the url syntax is correct'),
q="");else if(v&&","===b[l]&&!u){if(q.length){var U=z?q:q.trim();r.push(U);z=!1}","===b[l+1]&&(r.push(""),l++);q=""}else{if(v&&")"===b[l]&&!u){l++;v--;var J=k.pop();r.push(z?q:q.trim());z=!1;return Xb(J,r,e,f)}q+=b[l]}l++}l===b.length&&q.length&&r.push(q)}return f?r.join(""):Promise.all(r).then(function(a){return a.join("")}).catch(function(a){y(a);return""})}var k=[],l=0,m=0,n=c[m],v=0,u=!1,z=!1;return h()}
function Xb(a,b,c,d){var e=a.name,f;D.call(a,"prioritized")?f=a.prioritized:d&&D.call(a,"sync")?f=a.sync:d?(B().error("Expander","ignoring async replacement key: ",a.name),f=""):f=a.async||a.sync;var h;if(d){d=f;try{var k="function"===typeof d?d.apply(null,b):d,l;k&&k.then?(B().error("Expander","ignoring async macro resolution"),l=""):l="string"===typeof k||"number"===typeof k?Rb[e]?k.toString():encodeURIComponent(k):"";c&&(c[e]=l);h=l}catch(m){y(m),c&&(c[e]=""),h=""}}else h=Yb(f,e,b,c);return h}
function Yb(a,b,c,d){var e;try{return e="function"===typeof a?c?Promise.all(c).then(function(b){return a.apply(null,b)}):ja(a):Promise.resolve(a),e.then(function(a){a=null==a?"":Rb[b]?a:encodeURIComponent(a);d&&(d[b]=a);return a}).catch(function(a){y(a);d&&(d[b]="");return Promise.resolve("")})}catch(f){return y(f),d&&(d[b]=""),Promise.resolve("")}};function Zb(a,b){this.ampdoc=a;this.H=b;this.ca=new Sb(this.H)}g=Zb.prototype;g.expandStringSync=function(a,b,c,d){return W(this,a,b,c,!0,d)};g.expandStringAsync=function(a,b){return W(this,a,b)};g.expandUrlSync=function(a,b,c,d){return $b(a,W(this,a,b,c,!0,d))};g.expandUrlAsync=function(a,b,c){return W(this,a,b,void 0,void 0,c).then(function(b){return $b(a,b)})};g.expandInputValueAsync=function(a){return ac(this,a,!1)};g.expandInputValueSync=function(a){return ac(this,a,!0)};
function ac(a,b,c){"INPUT"==b.tagName&&b.getAttribute("type");var d=bc(b);if(!d)return c?b.value:Promise.resolve(b.value);void 0===b["amp-original-value"]&&(b["amp-original-value"]=b.value);a=W(a,b["amp-original-value"]||b.value,void 0,void 0,c,d);return c?b.value=a:a.then(function(a){return b.value=a})}
function bc(a,b){if(a=a.getAttribute("data-amp-replace")){var c={};a.trim().split(/\s+/).forEach(function(a){!b||D.call(b,a)?c[a]=!0:B().warn("URL","Ignoring unsupported replacement",a)});return c}}
g.maybeExpandLink=function(a,b){var c={CLIENT_ID:!0,QUERY_PARAM:!0},d=a.getAttribute("data-amp-addparams")||"",e=bc(a,c);if(e||d||b){var f=a["amp-original-href"]||a.getAttribute("href"),h=R(f);null==a["amp-original-href"]&&(a["amp-original-href"]=f);if(d)var k=t(d),f=Ja(f,Ka(k));a:if(k=pa(this.ampdoc).get(),h.origin==R(k.canonicalUrl).origin||h.origin==R(k.sourceUrl).origin)h=!0;else{if((k=this.ampdoc.getRootNode().querySelector("meta[name=amp-link-variable-allowed-origin]"))&&k.hasAttribute("content"))for(var k=
k.getAttribute("content").trim().split(/\s+/),l=0;l<k.length;l++)if(h.origin==R(k[l]).origin){h=!0;break a}h=!1}var m=h;if(!m)return e&&B().warn("URL","Ignoring link replacement",f," because the link does not go to the document's source, canonical, or whitelisted origin."),a.href=f;if(b){if(!e||!e.QUERY_PARAM){var n={QUERY_PARAM:!0};b=this.expandUrlSync(b,void 0,void 0,n)}h=t(b);f=Ja(f,Ka(h))}e&&(f=this.expandUrlSync(f,void 0,void 0,e));return a.href=f}};
function W(a,b,c,d,e,f){var h=$a(a.ampdoc.win,"url-replacement-v2");if(h)return a.ca.expand(b,c,d,e,f);var k=a.H.getExpr(c),l,m=b.replace(k,function(b,h,k){var n=[];"string"==typeof k&&(n=k.split(/,\s*/));if(f&&!f[h])return b;var q;if(c&&h in c)q=c[h];else if(q=a.H.get(h))if(e){if(q=q.sync,!q)return B().error("UrlReplacements","ignoring async replacement key: ",h),""}else q=q.async||q.sync;var r;try{r="function"==typeof q?q.apply(null,n):q}catch(U){e&&(r=""),y(U)}if(r&&r.then){if(e)return B().error("UrlReplacements",
"ignoring promise value for key: ",h),"";var u=r.catch(function(a){y(a)}).then(function(a){m=m.replace(b,Rb[b]?a:null==a?"":encodeURIComponent(a));d&&(d[b]=a)});l=l?l.then(function(){return u}):u;return b}d&&(d[b]=r);return Rb[b]?r:null==r?"":encodeURIComponent(r)});l&&(l=l.then(function(){return m}));return e?m:l||Promise.resolve(m)}g.collectVars=function(a,b){var c=Object.create(null);return W(this,a,b,c).then(function(){return c})};
g.collectUnwhitelistedVarsSync=function(a){var b=a.getAttribute("src"),c=Object.create(null);this.expandStringSync(b,void 0,c);var d=Object.keys(c),e=bc(a);return e?d.filter(function(a){return!e[a]}):d};function $b(a,b){var c=R(b,!0).protocol,d=R(a,!0).protocol;if(c!=d)return B().error("UrlReplacements","Illegal replacement of the protocol: ",a),a;B().assert(Na(b),"The replacement url has invalid protocol: %s",b);return b}g.getVariableSource=function(){return this.H};var cc=["<script amp-ad-metadata type=application/json>",'<script type="application/json" amp-ad-metadata>',"<script type=application/json amp-ad-metadata>"],dc={CLIENT_CACHE:"client_cache",SAFEFRAME:"safeframe",NAMEFRAME:"nameframe",IFRAME_GET:"iframe_get"},ec=F({frameborder:"0",allowfullscreen:"",allowtransparency:"",scrolling:"no",marginwidth:"0",marginheight:"0"}),fc={adRequestStart:"ad-request-start",adRequestEnd:"ad-response-end",renderFriendlyStart:"ad-render-start",renderCrossDomainStart:"ad-render-start",
renderSafeFrameStart:"ad-render-start",renderFriendlyEnd:"ad-render-end",renderCrossDomainEnd:"ad-render-end",friendlyIframeIniLoad:"ad-iframe-loaded",crossDomainIframeLoaded:"ad-iframe-loaded"};function gc(a,b,c){return function(d){for(var e=[],f=0;f<arguments.length;++f)e[f-0]=arguments[f];try{return a.apply(b,e)}catch(h){if(c)try{return e.unshift(h),c.apply(b,e)}catch(k){}}}}
function X(a){a=AMP.BaseElement.call(this,a)||this;a.Z=null;a.A=null;a.I=0;a.h=null;a.G=null;a.uiHandler=null;a.w=null;a.S=!1;a.J=null;a.B=null;a.D=null;a.F=a.getNonAmpCreativeRenderingMethod();a.Y=a.win.performance&&a.win.performance.now?a.win.performance.now.bind(a.win.performance):Date.now;var b;b=window;for(var c=0,d=b;d&&d!=d.parent;d=d.parent)c++;b=String(c)+"-"+tb(b);a.sentinel=b;a.V=!1;a.iframe=null;a.fromResumeCallback=!1;a.safeframeVersion="1-0-23";a.isRefreshing=!1;a.isRelayoutNeededFlag=
!1;b=a.win;a.ia={production:"0",control:"1",canary:"2"}[b.AMP_CONFIG&&b.AMP_CONFIG.type?b.AMP_CONFIG.type:"unknown"]||null||"-1";a.postAdResponseExperimentFeatures={};a.O=null;a.aa=null;a.isSinglePageStoryAd=!1;return a}aa(X,AMP.BaseElement);g=X.prototype;g.getLayoutPriority=function(){var a=!this.element.getAmpDoc().isSingleDoc();return a?1:2};g.isLayoutSupported=function(a){return"fixed"==a||"fixed-height"==a||"responsive"==a||"fill"==a||"flex-item"==a||"fluid"==a||"intrinsic"==a};
g.isRelayoutNeeded=function(){return this.isRelayoutNeededFlag};
g.buildCallback=function(){var a=this;this.B={width:this.element.getAttribute("width"),height:this.element.getAttribute("height")};var b=Math.round(this.getResource().getUpgradeDelayMs());C().info("amp-a4a","upgradeDelay "+this.element.getAttribute("type")+": "+b);this.uiHandler=new AMP.AmpAdUIHandler(this);var c=hc(this.win);this.Z=G(this.getAmpDoc(),"viewer").whenFirstVisible().then(function(){a.getSigningServiceNames().forEach(function(a){c.loadKeyset(a)})});if(this.O=this.getA4aAnalyticsConfig())this.aa=
Eb(this.element,this.O);this.isSinglePageStoryAd=this.element.hasAttribute("amp-story")};
g.renderOutsideViewport=function(){if(!this.S&&this.win["3pla"]&&!this.inNonAmpPreferenceExp())return!1;var a;var b=this.element.getAttribute("data-loading-strategy");null==b?a=null:"prefer-viewability-over-views"==b||""==b?a=1.25:(a="Value of data-loading-strategy should be a float number in range of [0, 3], but got "+b,b=B().assertNumber(parseFloat(b),a),B().assert(0<=b&&3>=b,a),a=b);var c=a;return null!==c?c:AMP.BaseElement.prototype.renderOutsideViewport.call(this)};g.isValidElement=function(){return!0};
g.getCreativeSize=function(){return this.B};g.delayAdRequestEnabled=function(){return!1};g.getPreconnectUrls=function(){return[]};g.getPrefetchUrls=function(){return[]};g.isAmpAdElement=function(){return"AMP-AD"==this.element.tagName||"AMP-EMBED"==this.element.tagName};g.preconnectCallback=function(){var a=this,b=this.getPreconnectUrls();b&&b.forEach(function(b){a.preconnect.url(b,!0)})};
g.resumeCallback=function(){if(!this.G){this.fromResumeCallback=!0;var a=this.getResource();if(a.hasBeenMeasured()&&!a.isMeasureRequested())this.onLayoutMeasure()}};g.getResource=function(){return this.element.getResources().getResourceForElement(this.element)};g.hasAdPromise=function(){return!!this.A};g.inNonAmpPreferenceExp=function(){return!!this.postAdResponseExperimentFeatures.pref_neutral_enabled&&["adsense","doubleclick"].includes(this.element.getAttribute("type"))};
function ic(a){var b=a.getIntersectionElementLayoutBox();if("fluid"!=a.getLayout()&&(0==b.height||0==b.width))return!1;var b=a.win,c=!1,d=0,e=a.element;do{if(pb[e.tagName])d++,c=!1;else{var f=(b.getComputedStyle(e)||E()).position;"fixed"!=f&&"sticky"!=f||(c=!0)}e=e.parentElement}while(e&&"BODY"!=e.tagName);return!c&&1>=d?a.isValidElement()?!0:(B().warn("amp-a4a",a.element.getAttribute("type"),"Amp ad element ignored as invalid",a.element),!1):(B().warn("amp-a4a","<"+a.element.tagName+"> is not allowed to be "+
("placed in elements with position:fixed: "+a.element)),!1)}g.onLayoutMeasure=function(){this.initiateAdRequest()};
g.initiateAdRequest=function(){var a=this;if(this.w)this.w.onLayoutMeasure();if(!this.A&&ic(this)){++this.I;var b=this.verifyStillCurrent();this.A=G(this.getAmpDoc(),"viewer").whenFirstVisible().then(function(){b();var c=a.delayAdRequestEnabled();if(c)return a.getResource().whenWithinViewport("number"==typeof c?c:a.renderOutsideViewport())}).then(function(){b();var c=AMP.BaseElement.prototype.getConsentPolicy.call(a);return c?Pa(a.getAmpDoc(),c).catch(function(a){B().error("amp-a4a","Error determining consent state",
a);return 4}):Promise.resolve(null)}).then(function(c){b();return a.getAdUrl(c,jc(a,c))}).then(function(c){b();a.h=c;return!a.isXhrAllowed()&&a.h?(a.F="iframe_get",Promise.reject("IFRAME-GET")):c&&a.sendXhrRequest(c)}).then(function(c){b();Y(a,"adRequestEnd");if(!c||!c.arrayBuffer||c.headers.has("amp-ff-empty-creative"))return a.forceCollapse(),Promise.reject("NO-CONTENT-RESPONSE");c.headers&&c.headers.has("amp-ff-exps")&&kc(a,c.headers.get("amp-ff-exps"));var d=a.getNonAmpCreativeRenderingMethod(c.headers.get("X-AmpAdRender"));
a.F=d;"nameframe"==a.F&&a.preconnect.preload(sb(a.win));var e=c.headers.get("X-AmpSafeFrameVersion");/^[0-9-]+$/.test(e)&&"1-0-23"!=e&&(a.safeframeVersion=e,a.preconnect.preload(a.getSafeframePath()));return c.arrayBuffer().then(function(b){return 0==b.byteLength?(a.forceCollapse(),Promise.reject("NO-CONTENT-RESPONSE")):{bytes:b,headers:c.headers}})}).then(function(c){b();if(!c)return Promise.resolve();var d=c,e=d.bytes,d=d.headers,f=a.extractSize(c.headers);a.B=f||a.B;"client_cache"!=a.F&&e&&(a.J=
e);return a.maybeValidateAmpCreative(e,d)}).then(function(c){b();a.S=!!c;return c&&Ab(c)}).then(function(c){b();var d;if(!c||!(d=a.getAmpAdMetadata(c)))return a.inNonAmpPreferenceExp()&&a.updateLayoutPriority(0),null;a.updateLayoutPriority(0);var e=N(a.win,"extensions");d.customElementExtensions.forEach(function(a){return e.preloadExtension(a)});(d.customStylesheets||[]).forEach(function(b){return a.preconnect.preload(b.href)});var f=ka(a.getAmpDoc(),"url");(d.images||[]).forEach(function(b){return f.isSecure(b)&&
a.preconnect.preload(b)});return d}).catch(function(b){switch(b.message||b){case "IFRAME-GET":case "NETWORK-FAILURE":return null;case "INVALID-SPSA-RESPONSE":case "NO-CONTENT-RESPONSE":return{minifiedCreative:"",customElementExtensions:[],customStylesheets:[]}}lc(a,b);return null})}};
g.maybeValidateAmpCreative=function(a,b){var c=this,d=this.verifyStillCurrent();return this.Z.then(function(){return"fake"!=c.element.getAttribute("type")||c.element.getAttribute("checksig")?hc(c.win).verify(a,b):Promise.resolve(0)}).then(function(b){d();var e=null;switch(b){case 0:e=a;break;case 4:e=c.shouldPreferentialRenderWithoutCrypto()?a:null;break;case 2:case 3:B().error("amp-a4a",c.element.getAttribute("type"),"Signature verification failed")}if(c.isSinglePageStoryAd&&!e)throw Error("INVALID-SPSA-RESPONSE");
return e})};function kc(a,b){b.split(",").forEach(function(b){if(b){var c=b.split("=");2==c.length&&c[0]?a.postAdResponseExperimentFeatures[c[0]]=c[1]:C().warn("amp-a4a","invalid experiment feature "+b)}})}
g.refresh=function(a){var b=this;this.isRefreshing=!0;this.tearDownSlot();this.initiateAdRequest();if(!this.A)return Promise.resolve();var c=this.I;return this.A.then(function(){if(b.isRefreshing&&c==b.I)return b.mutateElement(function(){mb(b.element,"ad-refresh");b.togglePlaceholder(!0);return N(b.win,"timer").promise(1E3).then(function(){b.isRelayoutNeededFlag=!0;b.getResource().layoutCanceled();G(b.getAmpDoc(),"viewer").whenNextVisible().then(function(){Da(b.getAmpDoc()).requireLayout(b.element)})})});
a()})};
function lc(a,b){var c,d=b;if(d&&("string"==typeof d?va(d,"CANCELLED"):"string"==typeof d.message&&va(d.message,"CANCELLED")))throw b;b=b&&b.message?fa(b):Error("unknown error "+b);c&&(b.ignoreStack=c);d=a.element.getAttribute("type")||"notype";0!=b.message.indexOf("amp-a4a: "+d+":")&&(b.message="amp-a4a: "+d+": "+b.message);a=a.h;!a||b.args&&b.args.au||(d=a.indexOf("?"),-1!=d&&((b.args||(b.args={})).au=a.substring(d+1,d+251)));w().development||w().log?B().error("amp-a4a",b):(B().warn("amp-a4a",b),
.01>Math.random()&&C().expectedError("amp-a4a",b))}g.layoutCallback=function(){this.isRefreshing&&this.destroyFrame(!0);return this.attemptToRenderCreative()};
g.attemptToRenderCreative=function(){var a=this;if(!this.A)return ic(this)&&C().error("amp-a4a","Null promise in layoutCallback"),Promise.resolve();var b=this.verifyStillCurrent();return this.A.then(function(c){b();return a.V||a.iframe&&!a.isRefreshing?Promise.resolve():c?mc(a,c).catch(function(c){b();B().warn("amp-a4a",a.element.getAttribute("type"),"Error injecting creative in friendly frame",c);return a.renderNonAmpCreative()}):a.renderNonAmpCreative()}).catch(function(b){lc(a,b);throw Error("CANCELLED");
})};g.isXhrAllowed=function(){return!0};g.attemptChangeSize=function(a,b){this.D=this.D||this.getLayoutBox();return AMP.BaseElement.prototype.attemptChangeSize.call(this,a,b)};g.unlayoutCallback=function(){this.tearDownSlot();return!0};
g.tearDownSlot=function(){var a=this;this.I++;this.uiHandler.applyUnlayoutUI();this.D&&AMP.BaseElement.prototype.attemptChangeSize.call(this,this.D.height,this.D.width).then(function(){a.D=null}).catch(function(a){C().warn("amp-a4a","unable to revert to original size",a)});this.V=!1;this.destroyFrame();this.J=this.h=this.A=null;this.fromResumeCallback=this.S=!1;this.F=this.getNonAmpCreativeRenderingMethod();this.postAdResponseExperimentFeatures={}};
g.destroyFrame=function(a){if((a=void 0===a?!1:a)||!this.isRefreshing)this.G&&(this.G.destroy(),this.G=null),this.iframe&&this.iframe.parentElement&&(this.iframe.parentElement.removeChild(this.iframe),this.iframe=null),this.w&&(this.w.freeXOriginIframe(),this.w=null)};g.viewportCallback=function(a){this.G&&Jb(this.G,a);this.w&&this.w.viewportCallback(a)};g.createPlaceholderCallback=function(){return this.uiHandler.createPlaceholder()};
g.getAdUrl=function(){throw Error("getAdUrl not implemented!");};g.resetAdUrl=function(){this.h=null};g.verifyStillCurrent=function(){var a=this,b=this.I;return function(){if(b!=a.I)throw Error("CANCELLED");}};g.extractSize=function(a){a=a.get("X-CreativeSize");if(!a)return null;var b=/^([0-9]+)x([0-9]+)$/.exec(a);return b?{width:Number(b[1]),height:Number(b[2])}:(B().error("amp-a4a","Invalid size header: "+a),null)};
g.forceCollapse=function(){this.isRefreshing?this.isRefreshing=!1:(this.D=this.D||this.getLayoutBox(),this.uiHandler.applyNoContentUI(),this.V=!0)};g.onCreativeRender=function(a){Y(this,a?"renderFriendlyEnd":"renderCrossDomainEnd")};g.onCrossDomainIframeCreated=function(a){C().info("amp-a4a",this.element.getAttribute("type"),"onCrossDomainIframeCreated "+a)};g.sandboxHTMLCreativeFrame=function(){return $a(this.win,"sandbox-ads")};
g.sendXhrRequest=function(a){var b=this;Y(this,"adRequestStart");var c={mode:"cors",method:"GET",credentials:"include"};return N(this.win,"xhr").fetch(a,c).catch(function(a){if(a.response&&200<a.response.status)return null;var c=b.onNetworkFailure(a,b.h);if(c.frameGetDisabled)C().info("amp-a4a","frame get disabled as part of network failure handler"),b.resetAdUrl();else return b.h=c.adUrl||b.h,Promise.reject("NETWORK-FAILURE");return null})};g.onNetworkFailure=function(){return{}};
g.getSigningServiceNames=function(){return["google"]};
g.renderNonAmpCreative=function(a){var b=this;if("true"==this.element.getAttribute("disable3pfallback"))return B().warn("amp-a4a",this.element.getAttribute("type"),"fallback to 3p disabled"),Promise.resolve(!1);C().warn("amp-a4a","fallback to 3p");var c=this.F,d=Promise.resolve(!1);"safeframe"!=c&&"nameframe"!=c||!this.J?this.h?(Ma(this.h,this.element),d=nc(this,this.h)):B().warn("amp-a4a",this.element.getAttribute("type"),"No creative or URL available -- A4A can't render any ad"):(d=oc(this,this.J),
this.J=null);a||this.inNonAmpPreferenceExp()||xb(this.win,d);return d.then(function(a){Y(b,"crossDomainIframeLoaded");return a})};
function mc(a,b){Y(a,"renderFriendlyStart");a.iframe=ya(a.element.ownerDocument,"iframe",F({height:a.B.height,width:a.B.width,frameborder:"0",allowfullscreen:"",allowtransparency:"",scrolling:"no"}));a.applyFillContent(a.iframe);var c=[];b.customStylesheets&&b.customStylesheets.forEach(function(a){(a=a.href)&&c.push(a)});var d=a.verifyStillCurrent();return Kb(a.iframe,a.element,{host:a.element,url:a.h,html:b.minifiedCreative,extensionIds:b.customElementExtensions||[],fonts:c},function(b){var c=a.getAmpDoc(),
d=new zb(a.getAmpDoc(),b);ma(b,new Zb(c,d))}).then(function(c){d();a.G=c;Ib(c,a.isInViewport());var e=c.iframe.contentDocument||c.win.document;T(e.body,"visibility","visible");gc(a.onCreativeRender,a,function(b){C().error("amp-a4a",a.element.getAttribute("type"),"Error executing onCreativeRender",b)})(b);return c.whenIniLoaded()}).then(function(){d();Y(a,"friendlyIframeIniLoad")})}
function pc(a,b){var c=Object.assign(b,F({height:a.B.height,width:a.B.width}));a.sentinel&&(c["data-amp-3p-sentinel"]=a.sentinel);$a(a.win,"no-sync-xhr-in-ads")&&(c.allow="sync-xhr 'none';");a.iframe=ya(a.element.ownerDocument,"iframe",Object.assign(c,ec));a.sandboxHTMLCreativeFrame()&&ub(a.iframe);a.w=new AMP.AmpAdXOriginIframeHandler(a);var d=a.w.init(a.iframe,!0);gc(a.onCreativeRender,a,function(b){C().error("amp-a4a",a.element.getAttribute("type"),"Error executing onCreativeRender",b)})(null);
return d}function nc(a,b){Y(a,"renderCrossDomainStart");return pc(a,F({src:N(a.win,"xhr").getCorsUrl(a.win,b),name:JSON.stringify(rb(a.win,a.element,a.sentinel))}))}
function oc(a,b){var c=a.F;Y(a,"renderSafeFrameStart");var d=a.verifyStillCurrent();return ja(function(){return Ab(b)}).then(function(b){d();var e,h="";switch(c){case "safeframe":e=a.getSafeframePath()+"?n=0";break;case "nameframe":e=sb(a.win);break;default:return B().error("A4A","A4A received unrecognized cross-domain name attribute iframe rendering mode request: %s.  Unable to render a creative for slot %s.",c,a.element.getAttribute("id")),Promise.reject("Unrecognized rendering mode request")}var k=
rb(a.win,a.element,a.sentinel,a.getAdditionalContextMetadata("safeframe"==c));"nameframe"==c?(k.creative=b,h=JSON.stringify(k)):"safeframe"==c&&(k=JSON.stringify(k),h=a.safeframeVersion+";"+b.length+";"+b+(""+k));return pc(a,F({src:e,name:h}))})}
g.getAmpAdMetadata=function(a){for(var b=-1,c,d=0;d<cc.length&&!(c=cc[d],b=a.lastIndexOf(c),0<=b);d++);if(0>b)return C().warn("amp-a4a",this.element.getAttribute("type"),"Could not locate start index for amp meta data in: %s",a),null;var e=a.lastIndexOf("\x3c/script>");if(0>e)return C().warn("amp-a4a",this.element.getAttribute("type"),"Could not locate closing script tag for amp meta data in: %s",a),null;try{var f=JSON.parse(a.slice(b+c.length,e)),h=f.ampRuntimeUtf16CharOffsets;if(!Array.isArray(h)||
2!=h.length||"number"!==typeof h[0]||"number"!==typeof h[1])throw Error("Invalid runtime offsets");var k={};if(f.customElementExtensions){if(k.customElementExtensions=f.customElementExtensions,!Array.isArray(k.customElementExtensions))throw Error("Invalid extensions",k.customElementExtensions);}else k.customElementExtensions=[];if(f.customStylesheets){k.customStylesheets=f.customStylesheets;var l="Invalid custom stylesheets";if(!Array.isArray(k.customStylesheets))throw Error(l);var m=ka(this.getAmpDoc(),
"url");k.customStylesheets.forEach(function(a){if("[object Object]"!==da.call(a)||!a.href||"string"!==typeof a.href||!m.isSecure(a.href))throw Error(l);})}Array.isArray(f.images)&&(k.images=f.images.splice(0,5));if(this.isSinglePageStoryAd){if(!f.ctaUrl||!f.ctaType)throw Error("INVALID-SPSA-RESPONSE");this.element.setAttribute("data-vars-ctatype",f.ctaType);this.element.setAttribute("data-vars-ctaurl",f.ctaUrl)}k.minifiedCreative=a.slice(0,h[0])+a.slice(h[1],b)+a.slice(e+9);return k}catch(n){C().warn("amp-a4a",
this.element.getAttribute("type"),"Invalid amp metadata: %s",a.slice(b+c.length,e));if(this.isSinglePageStoryAd)throw n;return null}};g.getSafeframePath=function(){return"https://tpc.googlesyndication.com/safeframe/"+(this.safeframeVersion+"/html/container.html")};function Y(a,b){if(a.O){var c=fc[b],d=Object.assign({time:Math.round(a.Y())},a.getA4aAnalyticsVars(c));mb(a.element,c,d)}}g.getA4aAnalyticsVars=function(){return{}};g.getA4aAnalyticsConfig=function(){return null};
function jc(a,b){if(AMP.RealTimeConfigManager)try{return(new AMP.RealTimeConfigManager(a)).maybeExecuteRealTimeConfig({},b)}catch(c){B().error("amp-a4a","Could not perform Real Time Config.",c)}else a.element.getAttribute("rtc-config")&&B().error("amp-a4a","RTC not supported for ad network "+a.element.getAttribute("type"))}g.shouldPreferentialRenderWithoutCrypto=function(){return!1};
g.getNonAmpCreativeRenderingMethod=function(a){if(a){var b;a:{for(b in dc)if(dc[b]===a){b=!0;break a}b=!1}if(b)return a;C().error("AMP-A4A","cross-origin render mode header "+a)}return N(this.win,"platform").isIos()?"nameframe":null};g.getAdditionalContextMetadata=function(){};g.isVerifiedAmpCreative=function(){return this.S};function hc(a){return a.AMP_FAST_FETCH_SIGNATURE_VERIFIER_||(a.AMP_FAST_FETCH_SIGNATURE_VERIFIER_=new Cb(a,fb))};function Z(a){return X.call(this,a)||this}aa(Z,X);Z.prototype.buildCallback=function(){B().assert(this.element.hasAttribute("src"),'Attribute src required for <amp-ad type="fake">: %s',this.element);X.prototype.buildCallback.call(this)};Z.prototype.isValidElement=function(){var a=this.element.getAttribute("id");return a&&va(a,"i-amphtml-demo-")?!0:(B().warn("AMP-AD-NETWORK-FAKE-IMPL","Only works with id starts with i-amphtml-demo-"),!1)};Z.prototype.getAdUrl=function(){return this.element.getAttribute("src")};
Z.prototype.sendXhrRequest=function(a){var b=this;return X.prototype.sendXhrRequest.call(this,a).then(function(a){if(!a)return null;var c=a.status,e=a.headers;return"true"==b.element.getAttribute("a4a-conversion")?a.text().then(function(a){var b=Response,d=a,f=(new DOMParser).parseFromString(d,"text/html"),m=f.documentElement;m.hasAttribute("\u26a1")?m.removeAttribute("\u26a1"):m.hasAttribute("amp")?m.removeAttribute("amp"):m.hasAttribute("AMP")&&m.removeAttribute("AMP");m.hasAttribute("\u26a14ads")||
m.hasAttribute("\u26a14ADS")||m.setAttribute("amp4ads","");for(var d=[],n=f.head.querySelectorAll("script[src]"),v=0;v<n.length;v++){var u=n[v];u.hasAttribute("custom-element")?d.push(u.getAttribute("custom-element")):u.hasAttribute("custom-template")&&d.push(u.getAttribute("custom-template"));f.head.removeChild(u)}f=f.head.querySelectorAll("style[amp-boilerplate]");for(n=0;n<f.length;n++)v=f[n],v.parentNode.removeChild(v);m=m.outerHTML;m+='<script type="application/json" amp-ad-metadata>{"ampRuntimeUtf16CharOffsets": [0, 0],"customElementExtensions": [';
for(f=0;f<d.length;f++)0<f&&(m+=","),m+='"'+d[f]+'"';return new b(m+"]}\x3c/script>",{status:c,headers:e})}):a})};(function(a){a.registerElement("amp-ad-network-fake-impl",Z)})(self.AMP);
})});
//# sourceMappingURL=amp-ad-network-fake-impl-0.1.js.map

