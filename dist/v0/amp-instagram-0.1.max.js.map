{"version":3,"sources":["node_modules/browser-pack/_prelude.js","build/amp-instagram-0.1.css.js","extensions/amp-instagram/0.1/amp-instagram.js","src/dom.js","src/event-helper-listen.js","src/event-helper.js","src/json.js","src/layout.js","src/log.js","src/mode-object.js","src/mode.js","src/static-template.js","src/string.js","src/style.js","src/types.js","src/url-parse-query-string.js","src/url-try-decode-uri-component.js","src/utils/object.js","src/utils/promise.js","third_party/css-escape/css-escape.js"],"names":[],"mappings":"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","file":"amp-instagram-0.1.max.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","export const CSS = \"amp-instagram.amp-instagram-default-framing{border:1px solid #dbdbdb!important}\\n/*# sourceURL=/extensions/amp-instagram/0.1/amp-instagram.css*/\";\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * @fileoverview Embeds an instagram photo. The data-shortcode attribute can be\n * easily copied from a normal instagram URL. Example: <code> <amp-instagram\n * data-shortcode=\"fBwFP\" data-captioned data-default-framing alt=\"Fastest page\n * in the west.\" width=\"320\" height=\"392\" layout=\"responsive\"> </amp-instagram>\n * </code>\n *\n * For responsive embedding the width and height can be left unchanged from the\n * example above and should produce the correct aspect ratio. amp-instagram will\n * attempt to resize on load based on the height reported by the embedded frame.\n * If captions are specified (data-captioned) then a resize will be requested\n * every time due to the fact that it's not possible to know the height of the\n * caption in advance.\n *\n * If captions are included it is stringly reccomended that an overflow element\n * is also included.  See description of overflow in amp-iframe.\n *\n * If data-default-framing is present will apply the default instagram frame\n * style without changing the layout/size.\n */\n\nimport {CSS} from '../../../build/amp-instagram-0.1.css';\nimport {getData, listen} from '../../../src/event-helper';\nimport {isLayoutSizeDefined} from '../../../src/layout';\nimport {isObject} from '../../../src/types';\nimport {removeElement} from '../../../src/dom';\nimport {setStyles} from '../../../src/style';\nimport {startsWith} from '../../../src/string';\nimport {tryParseJson} from '../../../src/json';\nimport {user} from '../../../src/log';\n\nclass AmpInstagram extends AMP.BaseElement {\n\n  /** @param {!AmpElement} element */\n  constructor(element) {\n    super(element);\n\n    /** @private {?Element} */\n    this.iframe_ = null;\n\n    /** @private {?string} */\n    this.shortcode_ = '';\n\n    /** @private {?Function} */\n    this.unlistenMessage_ = null;\n\n    /** @private {string}  */\n    this.captioned_ = '';\n\n    /**\n    * @private {?Promise}\n    * @visibleForTesting\n    */\n    this.iframePromise_ = null;\n  }\n  /**\n  * @param {boolean=} opt_onLayout\n  * @override\n  */\n  preconnectCallback(opt_onLayout) {\n    // See\n    // https://instagram.com/developer/embedding/?hl=en\n    this.preconnect.url('https://www.instagram.com', opt_onLayout);\n    // Host instagram used for image serving. While the host name is\n    // funky this appears to be stable in the post-domain sharding era.\n    this.preconnect.url('https://instagram.fsnc1-1.fna.fbcdn.net',\n        opt_onLayout);\n  }\n\n  /** @override */\n  renderOutsideViewport() {\n    return false;\n  }\n\n  /** @override */\n  buildCallback() {\n    this.shortcode_ = user().assert(\n        (this.element.getAttribute('data-shortcode') ||\n        this.element.getAttribute('shortcode')),\n        'The data-shortcode attribute is required for <amp-instagram> %s',\n        this.element);\n    this.captioned_ = this.element.hasAttribute('data-captioned') ?\n      'captioned/' : '';\n  }\n\n  /** @override */\n  createPlaceholderCallback() {\n    const placeholder = this.win.document.createElement('div');\n    placeholder.setAttribute('placeholder', '');\n    const image = this.win.document.createElement('amp-img');\n    image.setAttribute('noprerender', '');\n    // This will redirect to the image URL. By experimentation this is\n    // always the same URL that is actually used inside of the embed.\n    image.setAttribute('src', 'https://www.instagram.com/p/' +\n        encodeURIComponent(this.shortcode_) + '/media/?size=l');\n    image.setAttribute('layout', 'fill');\n    image.setAttribute('referrerpolicy', 'origin');\n\n    this.propagateAttributes(['alt'], image);\n    /*\n     * Add instagram default styling\n     */\n    if (this.element.hasAttribute('data-default-framing')) {\n      this.element.classList.add('amp-instagram-default-framing');\n    }\n\n    // This makes the non-iframe image appear in the exact same spot\n    // where it will be inside of the iframe.\n    setStyles(image, {\n      'top': '0 px',\n      'bottom': '0 px',\n      'left': '0 px',\n      'right': '0 px',\n    });\n    placeholder.appendChild(image);\n    return placeholder;\n  }\n\n  /** @override */\n  isLayoutSupported(layout) {\n    return isLayoutSizeDefined(layout);\n  }\n\n  /** @override */\n  layoutCallback() {\n    const iframe = this.element.ownerDocument.createElement('iframe');\n    this.iframe_ = iframe;\n\n    this.unlistenMessage_ = listen(\n        this.win,\n        'message',\n        this.handleInstagramMessages_.bind(this)\n    );\n\n    iframe.setAttribute('scrolling', 'no');\n    iframe.setAttribute('frameborder', '0');\n    iframe.setAttribute('allowtransparency', 'true');\n    //Add title to the iframe for better accessibility.\n    iframe.setAttribute('title', 'Instagram: ' +\n        this.element.getAttribute('alt'));\n    iframe.src = 'https://www.instagram.com/p/' +\n        encodeURIComponent(this.shortcode_) + '/embed/' +\n        this.captioned_ + '?cr=1&v=7';\n    this.applyFillContent(iframe);\n    this.element.appendChild(iframe);\n    setStyles(iframe, {\n      'opacity': 0,\n    });\n    return this.iframePromise_ = this.loadPromise(iframe).then(() => {\n      this.getVsync().mutate(() => {\n        setStyles(iframe, {\n          'opacity': 1,\n        });\n      });\n    });\n  }\n\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  handleInstagramMessages_(event) {\n    if (event.origin != 'https://www.instagram.com' ||\n        event.source != this.iframe_.contentWindow) {\n      return;\n    }\n    const eventData = getData(event);\n    if (!eventData || !(isObject(eventData)\n        || startsWith(/** @type {string} */ (eventData), '{'))) {\n      return; // Doesn't look like JSON.\n    }\n    const data = isObject(eventData) ? eventData : tryParseJson(eventData);\n    if (data === undefined) {\n      return; // We only process valid JSON.\n    }\n    if (data['type'] == 'MEASURE' && data['details']) {\n      const height = data['details']['height'];\n      this.getVsync().measure(() => {\n        if (this.iframe_ && this.iframe_./*OK*/offsetHeight !== height) {\n          this./*OK*/changeHeight(height);\n        }\n      });\n    }\n  }\n\n  /** @override */\n  unlayoutOnPause() {\n    return true;\n  }\n\n  /** @override */\n  unlayoutCallback() {\n    if (this.iframe_) {\n      removeElement(this.iframe_);\n      this.iframe_ = null;\n      this.iframePromise_ = null;\n    }\n    if (this.unlistenMessage_) {\n      this.unlistenMessage_();\n    }\n    return true; // Call layoutCallback again.\n  }\n}\n\n\nAMP.extension('amp-instagram', '0.1', AMP => {\n  AMP.registerElement('amp-instagram', AmpInstagram, CSS);\n});\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Deferred} from './utils/promise';\nimport {cssEscape} from '../third_party/css-escape/css-escape';\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {startsWith} from './string';\nimport {toWin} from './types';\n\nconst HTML_ESCAPE_CHARS = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;',\n};\nconst HTML_ESCAPE_REGEX = /(&|<|>|\"|'|`)/g;\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_PROMISE =\n    '__AMP_UPG_PRM';\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_RESOLVER =\n    '__AMP_UPG_RES';\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * callback is executed.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @param {function()} callback\n */\nexport function waitForChild(parent, checkFunc, callback) {\n  if (checkFunc(parent)) {\n    callback();\n    return;\n  }\n  /** @const {!Window} */\n  const win = toWin(parent.ownerDocument.defaultView);\n  if (win.MutationObserver) {\n    /** @const {MutationObserver} */\n    const observer = new win.MutationObserver(() => {\n      if (checkFunc(parent)) {\n        observer.disconnect();\n        callback();\n      }\n    });\n    observer.observe(parent, {childList: true});\n  } else {\n    /** @const {number} */\n    const interval = win.setInterval(() => {\n      if (checkFunc(parent)) {\n        win.clearInterval(interval);\n        callback();\n      }\n    }, /* milliseconds */ 5);\n  }\n}\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * promise is resolved.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @return {!Promise}\n */\nexport function waitForChildPromise(parent, checkFunc) {\n  return new Promise(resolve => {\n    waitForChild(parent, checkFunc, resolve);\n  });\n}\n\n/**\n * Waits for document's body to be available.\n * Will be deprecated soon; use {@link AmpDoc#whenBodyAvailable} or\n * @{link DocumentState#onBodyAvailable} instead.\n * @param {!Document} doc\n * @param {function()} callback\n */\nexport function waitForBody(doc, callback) {\n  waitForChild(doc.documentElement, () => !!doc.body, callback);\n}\n\n\n/**\n * Waits for document's body to be available.\n * @param {!Document} doc\n * @return {!Promise}\n */\nexport function waitForBodyPromise(doc) {\n  return new Promise(resolve => {\n    waitForBody(doc, resolve);\n  });\n}\n\n\n/**\n * Removes the element.\n * @param {!Element} element\n */\nexport function removeElement(element) {\n  if (element.parentElement) {\n    element.parentElement.removeChild(element);\n  }\n}\n\n\n/**\n * Removes all child nodes of the specified element.\n * @param {!Element} parent\n */\nexport function removeChildren(parent) {\n  while (parent.firstChild) {\n    parent.removeChild(parent.firstChild);\n  }\n}\n\n\n/**\n * Copies all children nodes of element \"from\" to element \"to\". Child nodes\n * are deeply cloned. Notice, that this method should be used with care and\n * preferably on smaller subtrees.\n * @param {!Element} from\n * @param {!Element|!DocumentFragment} to\n */\nexport function copyChildren(from, to) {\n  const frag = to.ownerDocument.createDocumentFragment();\n  for (let n = from.firstChild; n; n = n.nextSibling) {\n    frag.appendChild(n.cloneNode(true));\n  }\n  to.appendChild(frag);\n}\n\n/**\n * Insert the element in the root after the element named after or\n * if that is null at the beginning.\n * @param {!Element|!ShadowRoot} root\n * @param {!Element} element\n * @param {?Node} after\n */\nexport function insertAfterOrAtStart(root, element, after) {\n  const before = after ? after.nextSibling : root.firstChild;\n  root.insertBefore(element, before);\n}\n\n/**\n * Add attributes to an element.\n * @param {!Element} element\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function addAttributesToElement(element, attributes) {\n  for (const attr in attributes) {\n    element.setAttribute(attr, attributes[attr]);\n  }\n  return element;\n}\n\n/**\n * Create a new element on document with specified tagName and attributes.\n * @param {!Document} doc\n * @param {string} tagName\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function createElementWithAttributes(doc, tagName, attributes) {\n  const element = doc.createElement(tagName);\n  return addAttributesToElement(element, attributes);\n}\n\n/**\n * Returns true if node is connected (attached).\n * @param {!Node} node\n * @return {boolean}\n * @see https://dom.spec.whatwg.org/#connected\n */\nexport function isConnectedNode(node) {\n  const connected = node.isConnected;\n  if (connected !== undefined) {\n    return connected;\n  }\n\n  // \"An element is connected if its shadow-including root is a document.\"\n  let n = node;\n  do {\n    n = rootNodeFor(n);\n    if (n.host) {\n      n = n.host;\n    } else {\n      break;\n    }\n  } while (true);\n  return n.nodeType === Node.DOCUMENT_NODE;\n}\n\n/**\n * Returns the root for a given node. Does not cross shadow DOM boundary.\n * @param {!Node} node\n * @return {!Node}\n */\nexport function rootNodeFor(node) {\n  if (Node.prototype.getRootNode) {\n    // Type checker says `getRootNode` may return null.\n    return node.getRootNode() || node;\n  }\n  let n;\n  for (n = node; !!n.parentNode; n = n.parentNode) {}\n  return n;\n}\n\n/**\n * Finds the closest element that satisfies the callback from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {function(!Element):boolean} callback\n * @param {Element=} opt_stopAt optional elemnt to stop the search at.\n * @return {?Element}\n */\nexport function closest(element, callback, opt_stopAt) {\n  for (let el = element; el && el !== opt_stopAt; el = el.parentElement) {\n    if (callback(el)) {\n      return el;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest node that satisfies the callback from this node\n * up the DOM subtree.\n * @param {!Node} node\n * @param {function(!Node):boolean} callback\n * @return {?Node}\n */\nexport function closestNode(node, callback) {\n  for (let n = node; n; n = n.parentNode) {\n    if (callback(n)) {\n      return n;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest element with the specified name from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function closestByTag(element, tagName) {\n  if (element.closest) {\n    return element.closest(tagName);\n  }\n  tagName = tagName.toUpperCase();\n  return closest(element, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Finds the closest element with the specified selector from this element\n * @param {!Element} element\n * @param {string} selector\n * @return {?Element} closest ancestor if found.\n */\nexport function closestBySelector(element, selector) {\n  if (element.closest) {\n    return element.closest(selector);\n  }\n\n  return closest(element, el => {\n    return matches(el, selector);\n  });\n}\n\n/**\n * Checks if the given element matches the selector\n * @param  {!Element} el The element to verify\n * @param  {string} selector The selector to check against\n * @return {boolean} True if the element matched the selector. False otherwise.\n */\nexport function matches(el, selector) {\n  const matcher = el.matches ||\n      el.webkitMatchesSelector ||\n      el.mozMatchesSelector ||\n      el.msMatchesSelector ||\n      el.oMatchesSelector;\n  if (matcher) {\n    return matcher.call(el, selector);\n  }\n  return false; // IE8 always returns false.\n}\n\n/**\n * Finds the first descendant element with the specified name.\n * @param {!Element|!Document|!ShadowRoot} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function elementByTag(element, tagName) {\n  let elements;\n  // getElementsByTagName() is not supported on ShadowRoot.\n  if (typeof element.getElementsByTagName === 'function') {\n    elements = element.getElementsByTagName(tagName);\n  } else {\n    elements = element./*OK*/querySelectorAll(tagName);\n  }\n  return (elements && elements[0]) || null;\n}\n\n\n/**\n * Finds the first child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function childElement(parent, callback) {\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds all child elements that satisfy the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {!Array<!Element>}\n */\nexport function childElements(parent, callback) {\n  const children = [];\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      children.push(child);\n    }\n  }\n  return children;\n}\n\n\n/**\n * Finds the last child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function lastChildElement(parent, callback) {\n  for (let child = parent.lastElementChild; child;\n    child = child.previousElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n/**\n * Finds all child nodes that satisfy the callback.\n * These nodes can include Text, Comment and other child nodes.\n * @param {!Node} parent\n * @param {function(!Node):boolean} callback\n * @return {!Array<!Node>}\n */\nexport function childNodes(parent, callback) {\n  const nodes = [];\n  for (let child = parent.firstChild; child;\n    child = child.nextSibling) {\n    if (callback(child)) {\n      nodes.push(child);\n    }\n  }\n  return nodes;\n}\n\n/**\n * @type {boolean|undefined}\n * @visibleForTesting\n */\nlet scopeSelectorSupported;\n\n/**\n * @param {boolean|undefined} val\n * @visibleForTesting\n */\nexport function setScopeSelectorSupportedForTesting(val) {\n  scopeSelectorSupported = val;\n}\n\n/**\n * Test that the :scope selector is supported and behaves correctly.\n * @param {!Element} parent\n * @return {boolean}\n */\nfunction isScopeSelectorSupported(parent) {\n  const doc = parent.ownerDocument;\n  try {\n    const testElement = doc.createElement('div');\n    const testChild = doc.createElement('div');\n    testElement.appendChild(testChild);\n    // NOTE(cvializ, #12383): Firefox's implementation is incomplete,\n    // therefore we test actual functionality of`:scope` as well.\n    return testElement./*OK*/querySelector(':scope div') === testChild;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Finds the first child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function childElementByAttr(parent, attr) {\n  return scopedQuerySelector/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the last child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function lastChildElementByAttr(parent, attr) {\n  return lastChildElement(parent, el => {\n    return el.hasAttribute(attr);\n  });\n}\n\n\n/**\n * Finds all child elements that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByAttr(parent, attr) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the first child element that has the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {?Element}\n */\nexport function childElementByTag(parent, tagName) {\n  return scopedQuerySelector/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds all child elements with the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByTag(parent, tagName) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds the first element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {?Element}\n */\nexport function scopedQuerySelector(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelector(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const element = root./*OK*/querySelector(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return element;\n}\n\n\n/**\n * Finds the every element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {!NodeList<!Element>}\n */\nexport function scopedQuerySelectorAll(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelectorAll(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const elements = root./*OK*/querySelectorAll(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return elements;\n}\n\n\n/**\n * Returns element data-param- attributes as url parameters key-value pairs.\n * e.g. data-param-some-attr=value -> {someAttr: value}.\n * @param {!Element} element\n * @param {function(string):string=} opt_computeParamNameFunc to compute the\n *    parameter name, get passed the camel-case parameter name.\n * @param {!RegExp=} opt_paramPattern Regex pattern to match data attributes.\n * @return {!JsonObject}\n */\nexport function getDataParamsFromAttributes(element, opt_computeParamNameFunc,\n  opt_paramPattern) {\n  const computeParamNameFunc = opt_computeParamNameFunc || (key => key);\n  const {dataset} = element;\n  const params = dict();\n  const paramPattern = opt_paramPattern ? opt_paramPattern : /^param(.+)/;\n  for (const key in dataset) {\n    const matches = key.match(paramPattern);\n    if (matches) {\n      const param = matches[1][0].toLowerCase() + matches[1].substr(1);\n      params[computeParamNameFunc(param)] = dataset[key];\n    }\n  }\n  return params;\n}\n\n/**\n * Whether the element have a next node in the document order.\n * This means either:\n *  a. The element itself has a nextSibling.\n *  b. Any of the element ancestors has a nextSibling.\n * @param {!Element} element\n * @param {?Node} opt_stopNode\n * @return {boolean}\n */\nexport function hasNextNodeInDocumentOrder(element, opt_stopNode) {\n  let currentElement = element;\n  do {\n    if (currentElement.nextSibling) {\n      return true;\n    }\n  } while ((currentElement = currentElement.parentNode) &&\n            currentElement != opt_stopNode);\n  return false;\n}\n\n\n/**\n * Finds all ancestor elements that satisfy predicate.\n * @param {!Element} child\n * @param {function(!Element):boolean} predicate\n * @return {!Array<!Element>}\n */\nexport function ancestorElements(child, predicate) {\n  const ancestors = [];\n  for (let ancestor = child.parentElement; ancestor;\n    ancestor = ancestor.parentElement) {\n    if (predicate(ancestor)) {\n      ancestors.push(ancestor);\n    }\n  }\n  return ancestors;\n}\n\n\n/**\n * Finds all ancestor elements that has the specified tag name.\n * @param {!Element} child\n * @param {string} tagName\n * @return {!Array<!Element>}\n */\nexport function ancestorElementsByTag(child, tagName) {\n  tagName = tagName.toUpperCase();\n  return ancestorElements(child, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Returns a clone of the content of a template element.\n *\n * Polyfill to replace .content access for browsers that do not support\n * HTMLTemplateElements natively.\n *\n * @param {!HTMLTemplateElement|!Element} template\n * @return {!DocumentFragment}\n */\nexport function templateContentClone(template) {\n  if ('content' in template) {\n    return template.content.cloneNode(true);\n  } else {\n    const content = template.ownerDocument.createDocumentFragment();\n    copyChildren(template, content);\n    return content;\n  }\n}\n\n/**\n * Iterate over an array-like. Some collections like NodeList are\n * lazily evaluated in some browsers, and accessing `length` forces full\n * evaluation. We can improve performance by iterating until an element is\n * `undefined` to avoid checking the `length` property.\n * Test cases: https://jsperf.com/iterating-over-collections-of-elements\n * @param {!IArrayLike<T>} iterable\n * @param {function(T, number)} cb\n * @template T\n */\nexport function iterateCursor(iterable, cb) {\n  for (let i = 0, value; (value = iterable[i]) !== undefined; i++) {\n    cb(value, i);\n  }\n}\n\n/**\n * This method wraps around window's open method. It first tries to execute\n * `open` call with the provided target and if it fails, it retries the call\n * with the `_top` target. This is necessary given that in some embedding\n * scenarios, such as iOS' WKWebView, navigation to `_blank` and other targets\n * is blocked by default.\n *\n * @param {!Window} win\n * @param {string} url\n * @param {string} target\n * @param {string=} opt_features\n * @return {?Window}\n */\nexport function openWindowDialog(win, url, target, opt_features) {\n  // Try first with the specified target. If we're inside the WKWebView or\n  // a similar environments, this method is expected to fail by default for\n  // all targets except `_top`.\n  let res;\n  try {\n    res = win.open(url, target, opt_features);\n  } catch (e) {\n    dev().error('DOM', 'Failed to open url on target: ', target, e);\n  }\n\n  // Then try with `_top` target.\n  if (!res && target != '_top') {\n    res = win.open(url, '_top');\n  }\n  return res;\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n            element.getAttribute('type').toUpperCase() == 'APPLICATION/JSON';\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonLdScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n      element.getAttribute('type').toUpperCase() == 'APPLICATION/LD+JSON';\n}\n\n/**\n * Whether the page's direction is right to left or not.\n * @param {!Document} doc\n * @return {boolean}\n */\nexport function isRTL(doc) {\n  const dir = doc.body.getAttribute('dir')\n                 || doc.documentElement.getAttribute('dir')\n                 || 'ltr';\n  return dir == 'rtl';\n}\n\n\n/**\n * Escapes an ident (ID or a class name) to be used as a CSS selector.\n *\n * See https://drafts.csswg.org/cssom/#serialize-an-identifier.\n *\n * @param {string} ident\n * @return {string}\n */\nexport function escapeCssSelectorIdent(ident) {\n  return cssEscape(ident);\n}\n\n/**\n * Escapes an ident in a way that can be used by :nth-child() psuedo-class.\n *\n * See https://github.com/w3c/csswg-drafts/issues/2306.\n *\n * @param {string|number} ident\n * @return {string}\n */\nexport function escapeCssSelectorNth(ident) {\n  const escaped = String(ident);\n  // Ensure it doesn't close the nth-child psuedo class.\n  dev().assert(escaped.indexOf(')') === -1);\n  return escaped;\n}\n\n/**\n * Escapes `<`, `>` and other HTML charcaters with their escaped forms.\n * @param {string} text\n * @return {string}\n */\nexport function escapeHtml(text) {\n  if (!text) {\n    return text;\n  }\n  return text.replace(HTML_ESCAPE_REGEX, escapeHtmlChar);\n}\n\n/**\n * @param {string} c\n * @return {string}\n */\nfunction escapeHtmlChar(c) {\n  return HTML_ESCAPE_CHARS[c];\n}\n\n/**\n * Tries to focus on the given element; fails silently if browser throws an\n * exception.\n * @param {!Element} element\n */\nexport function tryFocus(element) {\n  try {\n    element./*OK*/focus();\n  } catch (e) {\n    // IE <= 7 may throw exceptions when focusing on hidden items.\n  }\n}\n\n/**\n * Whether the given window is in an iframe or not.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isIframed(win) {\n  return win.parent && win.parent != win;\n}\n\n/**\n * Determines if this element is an AMP element\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isAmpElement(element) {\n  const tag = element.tagName;\n  // Use prefix to recognize AMP element. This is necessary because stub\n  // may not be attached yet.\n  return startsWith(tag, 'AMP-') &&\n      // Some \"amp-*\" elements are not really AMP elements. :smh:\n      !(tag == 'AMP-STICKY-AD-TOP-PADDING' || tag == 'AMP-BODY');\n}\n\n/**\n * Return a promise that resolve when an AMP element upgrade from HTMLElement\n * to CustomElement\n * @param {!Element} element\n * @return {!Promise<!Element>}\n */\nexport function whenUpgradedToCustomElement(element) {\n  dev().assert(isAmpElement(element), 'element is not AmpElement');\n  if (element.createdCallback) {\n    // Element already is CustomElement;\n    return Promise.resolve(element);\n  }\n  // If Element is still HTMLElement, wait for it to upgrade to customElement\n  // Note: use pure string to avoid obfuscation between versions.\n  if (!element[UPGRADE_TO_CUSTOMELEMENT_PROMISE]) {\n    const deferred = new Deferred();\n    element[UPGRADE_TO_CUSTOMELEMENT_PROMISE] = deferred.promise;\n    element[UPGRADE_TO_CUSTOMELEMENT_RESOLVER] = deferred.resolve;\n\n  }\n\n  return element[UPGRADE_TO_CUSTOMELEMENT_PROMISE];\n}\n\n/**\n * Replacement for `Element.requestFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Element/requestFullscreen\n * @param {!Element} element\n */\nexport function fullscreenEnter(element) {\n  const requestFs = element.requestFullscreen\n   || element.requestFullScreen\n   || element.webkitRequestFullscreen\n   || element.webkitRequestFullScreen\n   || element.webkitEnterFullscreen\n   || element.webkitEnterFullScreen\n   || element.msRequestFullscreen\n   || element.msRequestFullScreen\n   || element.mozRequestFullscreen\n   || element.mozRequestFullScreen;\n  if (requestFs) {\n    requestFs.call(element);\n  }\n}\n\n/**\n * Replacement for `Document.exitFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/exitFullscreen\n * @param {!Element} element\n */\nexport function fullscreenExit(element) {\n  let exitFs = element.cancelFullScreen\n              || element.exitFullscreen\n              || element.exitFullScreen\n              || element.webkitExitFullscreen\n              || element.webkitExitFullScreen\n              || element.webkitCancelFullScreen\n              || element.mozCancelFullScreen\n              || element.msExitFullscreen;\n  if (exitFs) {\n    exitFs.call(element);\n    return;\n  }\n  if (element.ownerDocument) {\n    exitFs = element.ownerDocument.cancelFullScreen\n             || element.ownerDocument.exitFullscreen\n             || element.ownerDocument.exitFullScreen\n             || element.ownerDocument.webkitExitFullscreen\n             || element.ownerDocument.webkitExitFullScreen\n             || element.ownerDocument.webkitCancelFullScreen\n             || element.ownerDocument.mozCancelFullScreen\n             || element.ownerDocument.msExitFullscreen;\n  }\n  if (exitFs) {\n    exitFs.call(element.ownerDocument);\n    return;\n  }\n}\n\n\n/**\n * Replacement for `Document.fullscreenElement`.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/fullscreenElement\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isFullscreenElement(element) {\n  const isFullscreen = element.webkitDisplayingFullscreen;\n  if (isFullscreen) {\n    return true;\n  }\n  if (element.ownerDocument) {\n    const fullscreenElement = element.ownerDocument.fullscreenElement\n             || element.ownerDocument.webkitFullscreenElement\n             || element.ownerDocument.mozFullScreenElement\n             || element.webkitCurrentFullScreenElement;\n    if (fullscreenElement == element) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Returns true if node is not disabled.\n *\n * IE8 can return false positives, see {@link matches}.\n * @param {!Element} element\n * @return {boolean}\n * @see https://www.w3.org/TR/html5/forms.html#concept-fe-disabled\n */\nexport function isEnabled(element) {\n  return !(element.disabled || matches(element, ':disabled'));\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n  * Whether addEventListener supports options or only takes capture as a boolean\n  * @type {boolean|undefined}\n  * @visibleForTesting\n  */\nlet optsSupported;\n\n/**\n * Listens for the specified event on the element.\n *\n * Do not use this directly. This method is implemented as a shared\n * dependency. Use `listen()` in either `event-helper` or `3p-frame-messaging`,\n * depending on your use case.\n *\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function internalListenImplementation(element, eventType, listener,\n  opt_evtListenerOpts) {\n  let localElement = element;\n  let localListener = listener;\n  /**\n   * @type {?Function}\n   */\n  let wrapped;\n\n  wrapped = event => {\n    try {\n      return localListener(event);\n    } catch (e) {\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n  };\n  const optsSupported = detectEvtListenerOptsSupport();\n  let capture = false;\n  if (opt_evtListenerOpts) {\n    capture = opt_evtListenerOpts.capture;\n  }\n  localElement.addEventListener(\n      eventType,\n      wrapped,\n      optsSupported ? opt_evtListenerOpts : capture\n  );\n  return () => {\n    if (localElement) {\n      localElement.removeEventListener(\n          eventType,\n          wrapped,\n          optsSupported ? opt_evtListenerOpts : capture\n      );\n    }\n    // Ensure these are GC'd\n    localListener = null;\n    localElement = null;\n    wrapped = null;\n  };\n}\n\n/**\n * Tests whether the browser supports options as an argument of addEventListener\n * or not.\n *\n * @return {boolean}\n */\nexport function detectEvtListenerOptsSupport() {\n  // Only run the test once\n  if (optsSupported !== undefined) {\n    return optsSupported;\n  }\n\n  optsSupported = false;\n  try {\n    // Test whether browser supports EventListenerOptions or not\n    const options = {\n      get capture() {\n        optsSupported = true;\n      },\n    };\n    self.addEventListener('test-options', null, options);\n    self.removeEventListener('test-options', null, options);\n  } catch (err) {\n    // EventListenerOptions are not supported\n  }\n  return optsSupported;\n}\n\n/**\n  * Resets the test for whether addEventListener supports options or not.\n  */\nexport function resetEvtListenerOptsSupportForTesting() {\n  optsSupported = undefined;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {internalListenImplementation} from './event-helper-listen';\nimport {user} from './log';\n\n/** @const {string}  */\nconst LOAD_FAILURE_PREFIX = 'Failed to load:';\n\n/**\n * Returns a CustomEvent with a given type and detail; supports fallback for IE.\n * @param {!Window} win\n * @param {string} type\n * @param {!JsonObject|string|undefined|null} detail\n * @param {EventInit=} opt_eventInit\n * @return {!Event}\n */\nexport function createCustomEvent(win, type, detail, opt_eventInit) {\n  const eventInit = /** @type {!CustomEventInit} */ ({detail});\n  Object.assign(eventInit, opt_eventInit);\n  // win.CustomEvent is a function on Edge, Chrome, FF, Safari but\n  // is an object on IE 11.\n  if (typeof win.CustomEvent == 'function') {\n    return new win.CustomEvent(type, eventInit);\n  } else {\n    // Deprecated fallback for IE.\n    const e = win.document.createEvent('CustomEvent');\n    e.initCustomEvent(\n        type, !!eventInit.bubbles, !!eventInit.cancelable, detail);\n    return e;\n  }\n}\n\n/**\n * Listens for the specified event on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listen(element, eventType, listener, opt_evtListenerOpts) {\n  return internalListenImplementation(\n      element, eventType, listener, opt_evtListenerOpts);\n}\n\n/**\n * Returns the data property of an event with the correct type.\n * @param {!Event|{data: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getData(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.data);\n}\n\n/**\n * Returns the detail property of an event with the correct type.\n * @param {!Event|{detail: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getDetail(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.detail);\n}\n\n/**\n * Listens for the specified event on the element and removes the listener\n * as soon as event has been received.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listenOnce(element, eventType, listener, opt_evtListenerOpts) {\n  let localListener = listener;\n  const unlisten = internalListenImplementation(element, eventType, event => {\n    try {\n      localListener(event);\n    } finally {\n      // Ensure listener is GC'd\n      localListener = null;\n      unlisten();\n    }\n  }, opt_evtListenerOpts);\n  return unlisten;\n}\n\n\n/**\n * Returns  a promise that will resolve as soon as the specified event has\n * fired on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {Object=} opt_evtListenerOpts\n * @param {function(!UnlistenDef)=} opt_cancel An optional function that, when\n *     provided, will be called with the unlistener. This gives the caller\n *     access to the unlistener, so it may be called manually when necessary.\n * @return {!Promise<!Event>}\n */\nexport function listenOncePromise(element, eventType, opt_evtListenerOpts,\n  opt_cancel) {\n  let unlisten;\n  const eventPromise = new Promise(resolve => {\n    unlisten = listenOnce(element, eventType, resolve, opt_evtListenerOpts);\n  });\n  eventPromise.then(unlisten, unlisten);\n  if (opt_cancel) {\n    opt_cancel(unlisten);\n  }\n  return eventPromise;\n}\n\n\n/**\n * Whether the specified element/window has been loaded already.\n * @param {!Element|!Window} eleOrWindow\n * @return {boolean}\n */\nexport function isLoaded(eleOrWindow) {\n  return !!(eleOrWindow.complete || eleOrWindow.readyState == 'complete'\n      // If the passed in thing is a Window, infer loaded state from\n      //\n      || (eleOrWindow.document\n          && eleOrWindow.document.readyState == 'complete'));\n}\n\n/**\n * Returns a promise that will resolve or fail based on the eleOrWindow's 'load'\n * and 'error' events. Optionally this method takes a timeout, which will reject\n * the promise if the resource has not loaded by then.\n * @param {T} eleOrWindow Supports both Elements and as a special case Windows.\n * @return {!Promise<T>}\n * @template T\n */\nexport function loadPromise(eleOrWindow) {\n  let unlistenLoad;\n  let unlistenError;\n  if (isLoaded(eleOrWindow)) {\n    return Promise.resolve(eleOrWindow);\n  }\n  const loadingPromise = new Promise((resolve, reject) => {\n    // Listen once since IE 5/6/7 fire the onload event continuously for\n    // animated GIFs.\n    const {tagName} = eleOrWindow;\n    if (tagName === 'AUDIO' || tagName === 'VIDEO') {\n      unlistenLoad = listenOnce(eleOrWindow, 'loadstart', resolve);\n    } else {\n      unlistenLoad = listenOnce(eleOrWindow, 'load', resolve);\n    }\n    // For elements, unlisten on error (don't for Windows).\n    if (tagName) {\n      unlistenError = listenOnce(eleOrWindow, 'error', reject);\n    }\n  });\n\n  return loadingPromise.then(() => {\n    if (unlistenError) {\n      unlistenError();\n    }\n    return eleOrWindow;\n  }, () => {\n    if (unlistenLoad) {\n      unlistenLoad();\n    }\n    failedToLoad(eleOrWindow);\n  });\n}\n\n/**\n * Emit error on load failure.\n * @param {!Element|!Window} eleOrWindow Supports both Elements and as a special\n *     case Windows.\n */\nfunction failedToLoad(eleOrWindow) {\n  // Report failed loads as user errors so that they automatically go\n  // into the \"document error\" bucket.\n  let target = eleOrWindow;\n  if (target && target.src) {\n    target = target.src;\n  }\n  throw user().createError(LOAD_FAILURE_PREFIX, target);\n}\n\n/**\n * Returns true if this error message is was created for a load error.\n * @param {string} message An error message\n * @return {boolean}\n */\nexport function isLoadErrorMessage(message) {\n  return message.indexOf(LOAD_FAILURE_PREFIX) != -1;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview This module declares JSON types as defined in the\n * {@link http://json.org/}.\n */\n\nimport {isObject} from './types';\n\n\n// NOTE Type are changed to {*} because of\n// https://github.com/google/closure-compiler/issues/1999\n\n/**\n * JSON scalar. It's either string, number or boolean.\n * @typedef {*} should be string|number|boolean\n */\nlet JSONScalarDef;\n\n\n/**\n * JSON object. It's a map with string keys and JSON values.\n * @typedef {*} should be !Object<string, ?JSONValueDef>\n */\nlet JSONObjectDef;\n\n\n/**\n * JSON array. It's an array with JSON values.\n * @typedef {*} should be !Array<?JSONValueDef>\n */\nlet JSONArrayDef;\n\n\n/**\n * JSON value. It's either a scalar, an object or an array.\n * @typedef {*} should be !JSONScalarDef|!JSONObjectDef|!JSONArrayDef\n */\nlet JSONValueDef;\n\n/**\n * Recreates objects with prototype-less copies.\n * @param {!JsonObject} obj\n * @return {!JsonObject}\n */\nexport function recreateNonProtoObject(obj) {\n  const copy = Object.create(null);\n  for (const k in obj) {\n    if (!hasOwnProperty(obj, k)) {\n      continue;\n    }\n    const v = obj[k];\n    copy[k] = isObject(v) ? recreateNonProtoObject(v) : v;\n  }\n  return /** @type {!JsonObject} */ (copy);\n}\n\n/**\n * Returns a value from an object for a field-based expression. The expression\n * is a simple nested dot-notation of fields, such as `field1.field2`. If any\n * field in a chain does not exist or is not an object or array, the returned\n * value will be `undefined`.\n *\n * @param {!JsonObject} obj\n * @param {string} expr\n * @return {*}\n */\nexport function getValueForExpr(obj, expr) {\n  // The `.` indicates \"the object itself\".\n  if (expr == '.') {\n    return obj;\n  }\n  // Otherwise, navigate via properties.\n  const parts = expr.split('.');\n  let value = obj;\n  for (let i = 0; i < parts.length; i++) {\n    const part = parts[i];\n    if (part &&\n        value &&\n        value[part] !== undefined &&\n        hasOwnProperty(value, part)\n    ) {\n      value = value[part];\n      continue;\n    }\n    value = undefined;\n    break;\n  }\n  return value;\n}\n\n/**\n * Simple wrapper around JSON.parse that casts the return value\n * to JsonObject.\n * Create a new wrapper if an array return value is desired.\n * @param {*} json JSON string to parse\n * @return {?JsonObject} May be extend to parse arrays.\n */\nexport function parseJson(json) {\n  return /** @type {?JsonObject} */(JSON.parse(/** @type {string} */ (json)));\n}\n\n/**\n * Parses the given `json` string without throwing an exception if not valid.\n * Returns `undefined` if parsing fails.\n * Returns the `Object` corresponding to the JSON string when parsing succeeds.\n * @param {*} json JSON string to parse\n * @param {function(!Error)=} opt_onFailed Optional function that will be called\n *     with the error if parsing fails.\n * @return {?JsonObject|undefined} May be extend to parse arrays.\n */\nexport function tryParseJson(json, opt_onFailed) {\n  try {\n    return parseJson(json);\n  } catch (e) {\n    if (opt_onFailed) {\n      opt_onFailed(e);\n    }\n    return undefined;\n  }\n}\n\n/**\n * Recursively checks strict equality of items in nested arrays and objects.\n *\n * @param {JSONValueDef} a\n * @param {JSONValueDef} b\n * @param {number} depth The maximum recursion depth. Must be finite.\n * @return {boolean}\n * @throws {Error} If depth argument is not finite.\n */\nexport function recursiveEquals(a, b, depth = 3) {\n  if (!isFinite(depth)) {\n    throw new Error('depth arg must be finite: ' + depth);\n  }\n  if (a === b) {\n    return true;\n  }\n  // Only check shallow equality for depth < 1.\n  if (depth < 1) {\n    return false;\n  }\n  if (typeof a !== typeof b) {\n    return false;\n  }\n  if (Array.isArray(a) && Array.isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n    for (let i = 0; i < a.length; i++) {\n      if (!recursiveEquals(a[i], b[i], depth - 1)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\n    const keysA = Object.keys(/** @type {!Object} */ (a));\n    const keysB = Object.keys(/** @type {!Object} */ (b));\n    if (keysA.length !== keysB.length) {\n      return false;\n    }\n    for (let i = 0; i < keysA.length; i++) {\n      const keyA = keysA[i];\n      const valueA = a[keyA];\n      const valueB = b[keyA];\n      if (!recursiveEquals(valueA, valueB, depth - 1)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {*} obj\n * @param {string} key\n * @return {boolean}\n */\nfunction hasOwnProperty(obj, key) {\n  if (obj == null || typeof obj != 'object') {\n    return false;\n  }\n  return Object.prototype.hasOwnProperty.call(\n      /** @type {!Object} */ (obj), key);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Implements element layout. See https://goo.gl/9avXuT for\n * details.\n */\n\nimport {dev, user} from './log';\nimport {htmlFor} from './static-template';\nimport {isFiniteNumber} from './types';\nimport {setStyle, setStyles} from './style';\nimport {startsWith} from './string';\n\n/**\n * @enum {string}\n */\nexport const Layout = {\n  NODISPLAY: 'nodisplay',\n  FIXED: 'fixed',\n  FIXED_HEIGHT: 'fixed-height',\n  RESPONSIVE: 'responsive',\n  CONTAINER: 'container',\n  FILL: 'fill',\n  FLEX_ITEM: 'flex-item',\n  FLUID: 'fluid',\n  INTRINSIC: 'intrinsic',\n};\n\n\n/**\n * Layout priorities to use with BaseElement#getLayoutPriority() and\n * BaseElement#updateLayoutPriority().\n * @enum {number}\n */\nexport const LayoutPriority = {\n  CONTENT: 0,\n  METADATA: 1,\n  ADS: 2,\n  BACKGROUND: 3,\n};\n\n\n/**\n * CSS Length type. E.g. \"1px\" or \"20vh\".\n * @typedef {string}\n */\nexport let LengthDef;\n\n\n/**\n * @typedef {{\n *   width: string,\n *   height: string\n * }}\n */\nlet DimensionsDef;\n\n\n/**\n * The set of elements with natural dimensions, that is, elements\n * which have a known dimension either based on their value specified here,\n * or, if the value is null, a dimension specific to the browser.\n * `hasNaturalDimensions` checks for membership in this set.\n * `getNaturalDimensions` determines the dimensions for an element in the\n *    set and caches it.\n * @type {!Object<string, ?DimensionsDef>}\n * @private  Visible for testing only!\n */\nexport const naturalDimensions_ = {\n  'AMP-PIXEL': {width: '0px', height: '0px'},\n  'AMP-ANALYTICS': {width: '1px', height: '1px'},\n  // TODO(dvoytenko): audio should have width:auto.\n  'AMP-AUDIO': null,\n  'AMP-SOCIAL-SHARE': {width: '60px', height: '44px'},\n};\n\n\n/**\n * Elements that the progess can be shown for. This set has to be externalized\n * since the element's implementation may not be downloaded yet.\n * @enum {boolean}\n * @private  Visible for testing only!\n */\nexport const LOADING_ELEMENTS_ = {\n  'AMP-ANIM': true,\n  'AMP-BRIGHTCOVE': true,\n  'AMP-GOOGLE-DOCUMENT-EMBED': true,\n  'AMP-EMBED': true,\n  'AMP-FACEBOOK': true,\n  'AMP-FACEBOOK-COMMENTS': true,\n  'AMP-FACEBOOK-LIKE': true,\n  'AMP-FACEBOOK-PAGE': true,\n  'AMP-IFRAME': true,\n  'AMP-IMG': true,\n  'AMP-INSTAGRAM': true,\n  'AMP-LIST': true,\n  'AMP-OOYALA-PLAYER': true,\n  'AMP-PINTEREST': true,\n  'AMP-PLAYBUZZ': true,\n  'AMP-VIDEO': true,\n  'AMP-YOUTUBE': true,\n};\n\n\n/**\n * @param {string} s\n * @return {Layout|undefined} Returns undefined in case of failure to parse\n *   the layout string.\n */\nexport function parseLayout(s) {\n  for (const k in Layout) {\n    if (Layout[k] == s) {\n      return Layout[k];\n    }\n  }\n  return undefined;\n}\n\n\n/**\n * @param {!Layout} layout\n * @return {string}\n */\nexport function getLayoutClass(layout) {\n  return 'i-amphtml-layout-' + layout;\n}\n\n\n/**\n * Whether an element with this layout inherently defines the size.\n * @param {!Layout} layout\n * @return {boolean}\n */\nexport function isLayoutSizeDefined(layout) {\n  return (layout == Layout.FIXED ||\n      layout == Layout.FIXED_HEIGHT ||\n      layout == Layout.RESPONSIVE ||\n      layout == Layout.FILL ||\n      layout == Layout.FLEX_ITEM ||\n      layout == Layout.FLUID ||\n      layout == Layout.INTRINSIC);\n}\n\n\n/**\n * Whether the tag is an internal (service) AMP tag.\n * @param {!Node|string} tag\n * @return {boolean}\n */\nexport function isInternalElement(tag) {\n  const tagName = (typeof tag == 'string') ? tag : tag.tagName;\n  return tagName && startsWith(tagName.toLowerCase(), 'i-');\n}\n\n\n/**\n * Parses the CSS length value. If no units specified, the assumed value is\n * \"px\". Returns undefined in case of parsing error.\n * @param {string|undefined|null} s\n * @return {!LengthDef|undefined}\n */\nexport function parseLength(s) {\n  if (typeof s == 'number') {\n    return s + 'px';\n  }\n  if (!s) {\n    return undefined;\n  }\n  if (!/^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)?$/.test(s)) {\n    return undefined;\n  }\n  if (/^\\d+(\\.\\d+)?$/.test(s)) {\n    return s + 'px';\n  }\n  return s;\n}\n\n\n\n/**\n * Asserts that the supplied value is a non-percent CSS Length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {!LengthDef}\n */\nexport function assertLength(length) {\n  user().assert(\n      /^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)$/.test(length),\n      'Invalid length value: %s', length);\n  return /** @type {!LengthDef} */ (length);\n}\n\n\n\n\n/**\n * Asserts that the supplied value is a CSS Length value\n * (including percent unit).\n * @param {!LengthDef|string} length\n * @return {!LengthDef}\n */\nexport function assertLengthOrPercent(length) {\n  user().assert(/^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|%)$/.test(length),\n      'Invalid length or percent value: %s', length);\n  return length;\n}\n\n\n/**\n * Returns units from the CSS length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {string}\n */\nexport function getLengthUnits(length) {\n  assertLength(length);\n  dev().assertString(length);\n  const m = user().assert(length.match(/[a-z]+/i),\n      'Failed to read units from %s', length);\n  return m[0];\n}\n\n\n/**\n * Returns the numeric value of a CSS length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {number|undefined}\n */\nexport function getLengthNumeral(length) {\n  const res = parseFloat(length);\n  return isFiniteNumber(res) ? res : undefined;\n}\n\n\n/**\n * Determines whether the tagName is a known element that has natural dimensions\n * in our runtime or the browser.\n * @param {string} tagName The element tag name.\n * @return {boolean}\n */\nexport function hasNaturalDimensions(tagName) {\n  tagName = tagName.toUpperCase();\n  return naturalDimensions_[tagName] !== undefined;\n}\n\n\n/**\n * Determines the default dimensions for an element which could vary across\n * different browser implementations, like <audio> for instance.\n * This operation can only be completed for an element whitelisted by\n * `hasNaturalDimensions`.\n * @param {!Element} element\n * @return {DimensionsDef}\n */\nexport function getNaturalDimensions(element) {\n  const tagName = element.tagName.toUpperCase();\n  dev().assert(naturalDimensions_[tagName] !== undefined);\n  if (!naturalDimensions_[tagName]) {\n    const doc = element.ownerDocument;\n    const naturalTagName = tagName.replace(/^AMP\\-/, '');\n    const temp = doc.createElement(naturalTagName);\n    // For audio, should no-op elsewhere.\n    temp.controls = true;\n    setStyles(temp, {\n      position: 'absolute',\n      visibility: 'hidden',\n    });\n    doc.body.appendChild(temp);\n    naturalDimensions_[tagName] = {\n      width: (temp./*OK*/offsetWidth || 1) + 'px',\n      height: (temp./*OK*/offsetHeight || 1) + 'px',\n    };\n    doc.body.removeChild(temp);\n  }\n  return /** @type {DimensionsDef} */ (naturalDimensions_[tagName]);\n}\n\n\n/**\n * Whether the loading can be shown for the specified elemeent. This set has\n * to be externalized since the element's implementation may not be\n * downloaded yet.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isLoadingAllowed(element) {\n  const tagName = element.tagName.toUpperCase();\n  if (tagName == 'AMP-AD' || tagName == 'AMP-EMBED') {\n    return true;\n  }\n  return LOADING_ELEMENTS_[tagName] || false;\n}\n\n\n/**\n * Applies layout to the element. Visible for testing only.\n *\n * \\   \\  /  \\  /   / /   \\     |   _  \\     |  \\ |  | |  | |  \\ |  |  / _____|\n *  \\   \\/    \\/   / /  ^  \\    |  |_)  |    |   \\|  | |  | |   \\|  | |  |  __\n *   \\            / /  /_\\  \\   |      /     |  . `  | |  | |  . `  | |  | |_ |\n *    \\    /\\    / /  _____  \\  |  |\\  \\----.|  |\\   | |  | |  |\\   | |  |__| |\n *     \\__/  \\__/ /__/     \\__\\ | _| `._____||__| \\__| |__| |__| \\__|  \\______|\n *\n * The equivalent of this method is used for server-side rendering (SSR) and\n * any changes made to it must be made in coordination with caches that\n * implement SSR. For more information on SSR see bit.ly/amp-ssr.\n *\n * @param {!Element} element\n * @return {!Layout}\n */\nexport function applyStaticLayout(element) {\n  // Check if the layout has already been done by server-side rendering. The\n  // document may be visible to the user if the boilerplate was removed so\n  // please take care in making changes here.\n  const completedLayoutAttr = element.getAttribute('i-amphtml-layout');\n  if (completedLayoutAttr) {\n    const layout = /** @type {!Layout} */ (dev().assert(\n        parseLayout(completedLayoutAttr)));\n    if ((layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC)\n      && element.firstElementChild) {\n      // Find sizer, but assume that it might not have been parsed yet.\n      element.sizerElement =\n          element.querySelector('i-amphtml-sizer') || undefined;\n    } else if (layout == Layout.NODISPLAY) {\n      applyNoDisplayLayout(element);\n    }\n    return layout;\n  }\n\n  // If the layout was already done by server-side rendering (SSR), then the\n  // code below will not run. Any changes below will necessitate a change to SSR\n  // and must be coordinated with caches that implement SSR. See bit.ly/amp-ssr.\n\n  // Parse layout from the element.\n  const layoutAttr = element.getAttribute('layout');\n  const widthAttr = element.getAttribute('width');\n  const heightAttr = element.getAttribute('height');\n  const sizesAttr = element.getAttribute('sizes');\n  const heightsAttr = element.getAttribute('heights');\n\n  // Input layout attributes.\n  const inputLayout = layoutAttr ? parseLayout(layoutAttr) : null;\n  user().assert(inputLayout !== undefined, 'Unknown layout: %s', layoutAttr);\n  /** @const {string|null|undefined} */\n  const inputWidth = (widthAttr && widthAttr != 'auto') ?\n    parseLength(widthAttr) : widthAttr;\n  user().assert(inputWidth !== undefined, 'Invalid width value: %s', widthAttr);\n  /** @const {string|null|undefined} */\n  const inputHeight = (heightAttr && heightAttr != 'fluid') ?\n    parseLength(heightAttr) : heightAttr;\n  user().assert(inputHeight !== undefined, 'Invalid height value: %s',\n      heightAttr);\n\n  // Effective layout attributes. These are effectively constants.\n  let width;\n  let height;\n  let layout;\n\n  // Calculate effective width and height.\n  if ((!inputLayout || inputLayout == Layout.FIXED ||\n      inputLayout == Layout.FIXED_HEIGHT) &&\n      (!inputWidth || !inputHeight) && hasNaturalDimensions(element.tagName)) {\n    // Default width and height: handle elements that do not specify a\n    // width/height and are defined to have natural browser dimensions.\n    const dimensions = getNaturalDimensions(element);\n    width = (inputWidth || inputLayout == Layout.FIXED_HEIGHT) ? inputWidth :\n      dimensions.width;\n    height = inputHeight || dimensions.height;\n  } else {\n    width = inputWidth;\n    height = inputHeight;\n  }\n\n  // Calculate effective layout.\n  if (inputLayout) {\n    layout = inputLayout;\n  } else if (!width && !height) {\n    layout = Layout.CONTAINER;\n  } else if (height == 'fluid') {\n    layout = Layout.FLUID;\n  } else if (height && (!width || width == 'auto')) {\n    layout = Layout.FIXED_HEIGHT;\n  } else if (height && width && (sizesAttr || heightsAttr)) {\n    layout = Layout.RESPONSIVE;\n  } else {\n    layout = Layout.FIXED;\n  }\n\n  // Verify layout attributes.\n  if (layout == Layout.FIXED || layout == Layout.FIXED_HEIGHT ||\n      layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC) {\n    user().assert(height, 'Expected height to be available: %s', heightAttr);\n  }\n  if (layout == Layout.FIXED_HEIGHT) {\n    user().assert(!width || width == 'auto',\n        'Expected width to be either absent or equal \"auto\" ' +\n        'for fixed-height layout: %s', widthAttr);\n  }\n  if (layout == Layout.FIXED || layout == Layout.RESPONSIVE ||\n      layout == Layout.INTRINSIC) {\n    user().assert(width && width != 'auto',\n        'Expected width to be available and not equal to \"auto\": %s',\n        widthAttr);\n  }\n\n  if (layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC) {\n    user().assert(getLengthUnits(width) == getLengthUnits(height),\n        'Length units should be the same for width and height: %s, %s',\n        widthAttr, heightAttr);\n  } else {\n    user().assert(heightsAttr === null,\n        'Unexpected \"heights\" attribute for none-responsive layout');\n  }\n\n  // Apply UI.\n  element.classList.add(getLayoutClass(layout));\n  if (isLayoutSizeDefined(layout)) {\n    element.classList.add('i-amphtml-layout-size-defined');\n  }\n  if (layout == Layout.NODISPLAY) {\n    // CSS defines layout=nodisplay automatically with `display:none`. Thus\n    // no additional styling is needed.\n    applyNoDisplayLayout(element);\n  } else if (layout == Layout.FIXED) {\n    setStyles(element, {\n      width: dev().assertString(width),\n      height: dev().assertString(height),\n    });\n  } else if (layout == Layout.FIXED_HEIGHT) {\n    setStyle(element, 'height', dev().assertString(height));\n  } else if (layout == Layout.RESPONSIVE) {\n    const sizer = element.ownerDocument.createElement('i-amphtml-sizer');\n    setStyles(sizer, {\n      display: 'block',\n      paddingTop:\n        ((getLengthNumeral(height) / getLengthNumeral(width)) * 100) + '%',\n    });\n    element.insertBefore(sizer, element.firstChild);\n    element.sizerElement = sizer;\n  } else if (layout == Layout.INTRINSIC) {\n    // Intrinsic uses an svg inside the sizer element rather than the padding\n    // trick Note a naked svg won't work becasue other thing expect the\n    // i-amphtml-sizer element\n    const sizer = htmlFor(element)`\n      <i-amphtml-sizer class=\"i-amphtml-sizer\">\n        <img class=\"i-amphtml-intrinsic-sizer\" />\n      </i-amphtml-sizer>`;\n    const intrinsicSizer = sizer.firstElementChild;\n    intrinsicSizer.setAttribute('src',\n        `data:image/svg+xml;charset=utf-8,<svg height=\"${height}\" width=\"${width}\" xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\"/>`);\n    element.insertBefore(sizer, element.firstChild);\n    // TODO(jpettitt): sizer is leaked and can't be cleaned up.\n    element.sizerElement = intrinsicSizer;\n  } else if (layout == Layout.FILL) {\n    // Do nothing.\n  } else if (layout == Layout.CONTAINER) {\n    // Do nothing. Elements themselves will check whether the supplied\n    // layout value is acceptable. In particular container is only OK\n    // sometimes.\n  } else if (layout == Layout.FLEX_ITEM) {\n    // Set height and width to a flex item if they exist.\n    // The size set to a flex item could be overridden by `display: flex` later.\n    if (width) {\n      setStyle(element, 'width', width);\n    }\n    if (height) {\n      setStyle(element, 'height', height);\n    }\n  } else if (layout == Layout.FLUID) {\n    element.classList.add('i-amphtml-layout-awaiting-size');\n    if (width) {\n      setStyle(element, 'width', width);\n    }\n    setStyle(element, 'height', 0);\n  }\n  return layout;\n}\n\n\n/**\n * @param {!Element} element\n */\nfunction applyNoDisplayLayout(element) {\n  // TODO(dvoytenko, #9353): once `toggleLayoutDisplay` API has been deployed\n  // everywhere, switch all relevant elements to this API. In the meantime,\n  // simply unblock display toggling via `style=\"display: ...\"`.\n  setStyle(element, 'display', 'none');\n  element.classList.add('i-amphtml-display');\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {getModeObject} from './mode-object';\nimport {isEnumValue} from './types';\n\n/**\n * Triple zero width space.\n *\n * This is added to user error messages, so that we can later identify\n * them, when the only thing that we have is the message. This is the\n * case in many browsers when the global exception handler is invoked.\n *\n * @const {string}\n */\nexport const USER_ERROR_SENTINEL = '\\u200B\\u200B\\u200B';\n\n\n/**\n * Four zero width space.\n *\n * @const {string}\n */\nexport const USER_ERROR_EMBED_SENTINEL = '\\u200B\\u200B\\u200B\\u200B';\n\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a user error.\n */\nexport function isUserErrorMessage(message) {\n  return message.indexOf(USER_ERROR_SENTINEL) >= 0;\n}\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a a user error from an iframe embed.\n */\nexport function isUserErrorEmbed(message) {\n  return message.indexOf(USER_ERROR_EMBED_SENTINEL) >= 0;\n}\n\n\n/**\n * @enum {number}\n * @private Visible for testing only.\n */\nexport const LogLevel = {\n  OFF: 0,\n  ERROR: 1,\n  WARN: 2,\n  INFO: 3,\n  FINE: 4,\n};\n\n/**\n * Sets reportError function. Called from error.js to break cyclic\n * dependency.\n * @param {function(*, !Element=)|undefined} fn\n */\nexport function setReportError(fn) {\n  self.reportError = fn;\n}\n\n/**\n * @type {!LogLevel|undefined}\n * @private\n */\nlet levelOverride_ = undefined;\n\n/**\n * @param {!LogLevel} level\n */\nexport function overrideLogLevel(level) {\n  levelOverride_ = level;\n}\n\n/**\n * Logging class. Use of sentinel string instead of a boolean to check user/dev\n * errors because errors could be rethrown by some native code as a new error,\n * and only a message would survive. Also, some browser dont support a 5th\n * error object argument in window.onerror. List of supporting browser can be\n * found here:\n * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n * @final\n * @private Visible for testing only.\n */\nexport class Log {\n  /**\n   * opt_suffix will be appended to error message to identify the type of the\n   * error message. We can't rely on the error object to pass along the type\n   * because some browsers do not have this param in its window.onerror API.\n   * See:\n   * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n   *\n   * @param {!Window} win\n   * @param {function(!./mode.ModeDef):!LogLevel} levelFunc\n   * @param {string=} opt_suffix\n   */\n  constructor(win, levelFunc, opt_suffix) {\n    /**\n     * In tests we use the main test window instead of the iframe where\n     * the tests runs because only the former is relayed to the console.\n     * @const {!Window}\n     */\n    this.win = (getMode().test && win.AMP_TEST_IFRAME) ? win.parent : win;\n\n    /** @private @const {function(!./mode.ModeDef):!LogLevel} */\n    this.levelFunc_ = levelFunc;\n\n    /** @private @const {!LogLevel} */\n    this.level_ = this.defaultLevel_();\n\n    /** @private @const {string} */\n    this.suffix_ = opt_suffix || '';\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  getLevel_() {\n    return (levelOverride_ !== undefined) ? levelOverride_ : this.level_;\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  defaultLevel_() {\n    // No console - can't enable logging.\n    if (!this.win.console || !this.win.console.log) {\n      return LogLevel.OFF;\n    }\n\n    // Logging has been explicitly disabled.\n    if (getMode().log == '0') {\n      return LogLevel.OFF;\n    }\n\n    // Logging is enabled for tests directly.\n    if (getMode().test && this.win.ENABLE_LOG) {\n      return LogLevel.FINE;\n    }\n\n    // LocalDev by default allows INFO level, unless overriden by `#log`.\n    if (getMode().localDev && !getMode().log) {\n      return LogLevel.INFO;\n    }\n\n    // Delegate to the specific resolver.\n    return this.levelFunc_(getModeObject());\n  }\n\n  /**\n   * @param {string} tag\n   * @param {string} level\n   * @param {!Array} messages\n   */\n  msg_(tag, level, messages) {\n    if (this.getLevel_() != LogLevel.OFF) {\n      let fn = this.win.console.log;\n      if (level == 'ERROR') {\n        fn = this.win.console.error || fn;\n      } else if (level == 'INFO') {\n        fn = this.win.console.info || fn;\n      } else if (level == 'WARN') {\n        fn = this.win.console.warn || fn;\n      }\n      if (getMode().localDev) {\n        messages.unshift('[' + tag + ']');\n      }\n      fn.apply(this.win.console, messages);\n    }\n  }\n\n  /**\n   * Whether the logging is enabled.\n   * @return {boolean}\n   */\n  isEnabled() {\n    return this.getLevel_() != LogLevel.OFF;\n  }\n\n  /**\n   * Reports a fine-grained message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  fine(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.FINE) {\n      this.msg_(tag, 'FINE', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a informational message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  info(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.INFO) {\n      this.msg_(tag, 'INFO', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a warning message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  warn(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.WARN) {\n      this.msg_(tag, 'WARN', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports an error message. If the logging is disabled, the error is rethrown\n   * asynchronously.\n   * @param {string} tag\n   * @param {...*} var_args\n   * @return {!Error|undefined}\n   * @private\n   */\n  error_(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.ERROR) {\n      this.msg_(tag, 'ERROR', Array.prototype.slice.call(arguments, 1));\n    } else {\n      const error = createErrorVargs.apply(null,\n          Array.prototype.slice.call(arguments, 1));\n      this.prepareError_(error);\n      return error;\n    }\n  }\n\n  /**\n   * Reports an error message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  error(tag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.name = tag || error.name;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Reports an error message and marks with an expected property. If the\n   * logging is disabled, the error is rethrown asynchronously.\n   * @param {string} unusedTag\n   * @param {...*} var_args\n   */\n  expectedError(unusedTag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.expected = true;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Creates an error object.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    return error;\n  }\n\n  /**\n   * Creates an error object with its expected property set to true.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createExpectedError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    error.expected = true;\n    return error;\n  }\n\n  /**\n   * Throws an error if the first argument isn't trueish.\n   *\n   * Supports argument substitution into the message via %s placeholders.\n   *\n   * Throws an error object that has two extra properties:\n   * - associatedElement: This is the first element provided in the var args.\n   *   It can be used for improved display of error messages.\n   * - messageArray: The elements of the substituted message as non-stringified\n   *   elements in an array. When e.g. passed to console.error this yields\n   *   native displays of things like HTML elements.\n   *\n   * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n   *     not evaluate to true.\n   * @param {string=} opt_message The assertion message\n   * @param {...*} var_args Arguments substituted into %s in the message.\n   * @return {T} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 0\n   */\n  assert(shouldBeTrueish, opt_message, var_args) {\n    let firstElement;\n    if (!shouldBeTrueish) {\n      const message = opt_message || 'Assertion failed';\n      const splitMessage = message.split('%s');\n      const first = splitMessage.shift();\n      let formatted = first;\n      const messageArray = [];\n      pushIfNonEmpty(messageArray, first);\n      for (let i = 2; i < arguments.length; i++) {\n        const val = arguments[i];\n        if (val && val.tagName) {\n          firstElement = val;\n        }\n        const nextConstant = splitMessage.shift();\n        messageArray.push(val);\n        pushIfNonEmpty(messageArray, nextConstant.trim());\n        formatted += toString(val) + nextConstant;\n      }\n      const e = new Error(formatted);\n      e.fromAssert = true;\n      e.associatedElement = firstElement;\n      e.messageArray = messageArray;\n      this.prepareError_(e);\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n    return shouldBeTrueish;\n  }\n\n  /**\n   * Throws an error if the first argument isn't an Element\n   *\n   * Otherwise see `assert` for usage\n   *\n   * @param {*} shouldBeElement\n   * @param {string=} opt_message The assertion message\n   * @return {!Element} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertElement(shouldBeElement, opt_message) {\n    const shouldBeTrueish = shouldBeElement && shouldBeElement.nodeType == 1;\n    this.assert(shouldBeTrueish, (opt_message || 'Element expected') + ': %s',\n        shouldBeElement);\n    return /** @type {!Element} */ (shouldBeElement);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a string. The string can\n   * be empty.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeString\n   * @param {string=} opt_message The assertion message\n   * @return {string} The string value. Can be an empty string.\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertString(shouldBeString, opt_message) {\n    this.assert(typeof shouldBeString == 'string',\n        (opt_message || 'String expected') + ': %s', shouldBeString);\n    return /** @type {string} */ (shouldBeString);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a number. The allowed values\n   * include `0` and `NaN`.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeNumber\n   * @param {string=} opt_message The assertion message\n   * @return {number} The number value. The allowed values include `0`\n   *   and `NaN`.\n   */\n  assertNumber(shouldBeNumber, opt_message) {\n    this.assert(typeof shouldBeNumber == 'number',\n        (opt_message || 'Number expected') + ': %s', shouldBeNumber);\n    return /** @type {number} */ (shouldBeNumber);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a boolean.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeBoolean\n   * @param {string=} opt_message The assertion message\n   * @return {boolean} The boolean value.\n   */\n  assertBoolean(shouldBeBoolean, opt_message) {\n    this.assert(!!shouldBeBoolean === shouldBeBoolean,\n        (opt_message || 'Boolean expected') + ': %s', shouldBeBoolean);\n    return /** @type {boolean} */ (shouldBeBoolean);\n  }\n\n  /**\n   * Asserts and returns the enum value. If the enum doesn't contain such a\n   * value, the error is thrown.\n   *\n   * @param {!Object<T>} enumObj\n   * @param {string} s\n   * @param {string=} opt_enumName\n   * @return {T}\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertEnumValue(enumObj, s, opt_enumName) {\n    if (isEnumValue(enumObj, s)) {\n      return s;\n    }\n    this.assert(false,\n        'Unknown %s value: \"%s\"',\n        opt_enumName || 'enum', s);\n  }\n\n  /**\n   * @param {!Error} error\n   * @private\n   */\n  prepareError_(error) {\n    error = duplicateErrorIfNecessary(error);\n    if (this.suffix_) {\n      if (!error.message) {\n        error.message = this.suffix_;\n      } else if (error.message.indexOf(this.suffix_) == -1) {\n        error.message += this.suffix_;\n      }\n    } else if (isUserErrorMessage(error.message)) {\n      error.message = error.message.replace(USER_ERROR_SENTINEL, '');\n    }\n  }\n}\n\n/**\n * @param {string|!Element} val\n * @return {string}\n */\nfunction toString(val) {\n  // Do check equivalent to `val instanceof Element` without cross-window bug\n  if (val && val.nodeType == 1) {\n    return val.tagName.toLowerCase() + (val.id ? '#' + val.id : '');\n  }\n  return /** @type {string} */ (val);\n}\n\n\n/**\n * @param {!Array} array\n * @param {*} val\n */\nfunction pushIfNonEmpty(array, val) {\n  if (val != '') {\n    array.push(val);\n  }\n}\n\n/**\n * Some exceptions (DOMException, namely) have read-only message.\n * @param {!Error} error\n * @return {!Error};\n */\nexport function duplicateErrorIfNecessary(error) {\n  const {message} = error;\n  const test = String(Math.random());\n  error.message = test;\n\n  if (error.message === test) {\n    error.message = message;\n    return error;\n  }\n\n  const e = new Error(error.message);\n  // Copy all the extraneous things we attach.\n  for (const prop in error) {\n    e[prop] = error[prop];\n  }\n  // Ensure these are copied.\n  e.stack = error.stack;\n  return e;\n}\n\n/**\n * @param {...*} var_args\n * @return {!Error}\n * @visibleForTesting\n */\nexport function createErrorVargs(var_args) {\n  let error = null;\n  let message = '';\n  for (let i = 0; i < arguments.length; i++) {\n    const arg = arguments[i];\n    if (arg instanceof Error && !error) {\n      error = duplicateErrorIfNecessary(arg);\n    } else {\n      if (message) {\n        message += ' ';\n      }\n      message += arg;\n    }\n  }\n\n  if (!error) {\n    error = new Error(message);\n  } else if (message) {\n    error.message = message + ': ' + error.message;\n  }\n  return error;\n}\n\n\n/**\n * Rethrows the error without terminating the current context. This preserves\n * whether the original error designation is a user error or a dev error.\n * @param {...*} var_args\n */\nexport function rethrowAsync(var_args) {\n  const error = createErrorVargs.apply(null, arguments);\n  setTimeout(() => {\n    // reportError is installed globally per window in the entry point.\n    self.reportError(error);\n    throw error;\n  });\n}\n\n\n/**\n * Cache for logs. We do not use a Service since the service module depends\n * on Log and closure literally can't even.\n * @type {{user: ?Log, dev: ?Log, userForEmbed: ?Log}}\n */\nself.log = (self.log || {\n  user: null,\n  dev: null,\n  userForEmbed: null,\n});\n\nconst logs = self.log;\n\n/**\n * Eventually holds a constructor for Log objects. Lazily initialized, so we\n * can avoid ever referencing the real constructor except in JS binaries\n * that actually want to include the implementation.\n * @type {?Function}\n */\nlet logConstructor = null;\n\n/**\n * Initializes log contructor.\n */\nexport function initLogConstructor() {\n  logConstructor = Log;\n  // Initialize instances for use. If a binary (an extension for example) that\n  // does not call `initLogConstructor` invokes `dev()` or `user()` earlier than\n  // the binary that does call `initLogConstructor` (amp.js), the extension will\n  // throw an error as that extension will never be able to initialize the log\n  // instances and we also don't want it to call `initLogConstructor` either\n  // (since that will cause the Log implementation to be bundled into that\n  // binary). So we must initialize the instances eagerly so that they are ready\n  // for use (stored globally) after the main binary calls `initLogConstructor`.\n  dev();\n  user();\n}\n\n/**\n * Resets log contructor for testing.\n */\nexport function resetLogConstructorForTesting() {\n  logConstructor = null;\n}\n\n/**\n * Publisher level log.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Development mode is enabled via `#development=1` or logging is explicitly\n *     enabled via `#log=D` where D >= 1.\n *  3. AMP.setLogLevel(D) is called, where D >= 1.\n *\n * @param {!Element=} opt_element\n * @return {!Log}\n */\nexport function user(opt_element) {\n  if (!logs.user) {\n    logs.user = getUserLogger(USER_ERROR_SENTINEL);\n  }\n  if (!isFromEmbed(logs.user.win, opt_element)) {\n    return logs.user;\n  } else {\n    if (logs.userForEmbed) {\n      return logs.userForEmbed;\n    }\n    return logs.userForEmbed = getUserLogger(USER_ERROR_EMBED_SENTINEL);\n  }\n}\n\n/**\n * Getter for user logger\n * @param {string=} suffix\n * @return {!Log}\n */\nfunction getUserLogger(suffix) {\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (mode.development || logNum >= 1) {\n      return LogLevel.FINE;\n    }\n    return LogLevel.WARN;\n  }, suffix);\n}\n\n/**\n * AMP development log. Calls to `devLog().assert` and `dev.fine` are stripped\n * in the PROD binary. However, `devLog().assert` result is preserved in either\n * case.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Logging is explicitly enabled via `#log=D`, where D >= 2.\n *  3. AMP.setLogLevel(D) is called, where D >= 2.\n *\n * @return {!Log}\n */\nexport function dev() {\n  if (logs.dev) {\n    return logs.dev;\n  }\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return logs.dev = new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (logNum >= 3) {\n      return LogLevel.FINE;\n    }\n    if (logNum >= 2) {\n      return LogLevel.INFO;\n    }\n    return LogLevel.OFF;\n  });\n}\n\n/**\n * @param {!Window} win\n * @param {!Element=} opt_element\n * @return {boolean} isEmbed\n */\nexport function isFromEmbed(win, opt_element) {\n  if (!opt_element) {\n    return false;\n  }\n  return opt_element.ownerDocument.defaultView != win;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\n\n/**\n * Provides info about the current app. This return value may be cached and\n * passed around as it will always be DCE'd.\n * @param {?Window=} opt_win\n * @return {!./mode.ModeDef}\n */\nexport function getModeObject(opt_win) {\n  return {\n    localDev: getMode(opt_win).localDev,\n    development: getMode(opt_win).development,\n    filter: getMode(opt_win).filter,\n    minified: getMode(opt_win).minified,\n    lite: getMode(opt_win).lite,\n    test: getMode(opt_win).test,\n    log: getMode(opt_win).log,\n    version: getMode(opt_win).version,\n    rtvVersion: getMode(opt_win).rtvVersion,\n  };\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {parseQueryString_} from './url-parse-query-string';\n\n/**\n * @typedef {{\n *   localDev: boolean,\n *   development: boolean,\n *   filter: (string|undefined),\n *   minified: boolean,\n *   lite: boolean,\n *   test: boolean,\n *   log: (string|undefined),\n *   version: string,\n *   rtvVersion: string,\n * }}\n */\nexport let ModeDef;\n\n/** @type {string} */\nconst version = '$internalRuntimeVersion$';\n\n/**\n * `rtvVersion` is the prefixed version we serve off of the cdn.\n * The prefix denotes canary(00) or prod(01) or an experiment version ( > 01).\n * @type {string}\n */\nlet rtvVersion = '';\n\n/**\n * Provides info about the current app.\n * @param {?Window=} opt_win\n * @return {!ModeDef}\n */\nexport function getMode(opt_win) {\n  const win = opt_win || self;\n  if (win.AMP_MODE) {\n    return win.AMP_MODE;\n  }\n  return win.AMP_MODE = getMode_(win);\n}\n\n/**\n * Provides info about the current app.\n * @param {!Window} win\n * @return {!ModeDef}\n */\nfunction getMode_(win) {\n  // Magic constants that are replaced by closure compiler.\n  // IS_MINIFIED is always replaced with true when closure compiler is used\n  // while IS_DEV is only replaced when `gulp dist` is called without the\n  // --fortesting flag.\n  const IS_DEV = true;\n  const IS_MINIFIED = false;\n\n  const localDevEnabled = !!(self.AMP_CONFIG && self.AMP_CONFIG.localDev);\n  const runningTests = IS_DEV && !!(win.AMP_TEST || win.__karma__);\n  const isLocalDev = IS_DEV && (localDevEnabled || runningTests);\n  const hashQuery = parseQueryString_(\n      // location.originalHash is set by the viewer when it removes the fragment\n      // from the URL.\n      win.location.originalHash || win.location.hash);\n\n  const searchQuery = parseQueryString_(win.location.search);\n\n  if (!rtvVersion) {\n    rtvVersion = getRtvVersion(win, isLocalDev);\n  }\n\n  // The `minified`, `test` and `localDev` properties are replaced\n  // as boolean literals when we run `gulp dist` without the `--fortesting`\n  // flags. This improved DCE on the production file we deploy as the code\n  // paths for localhost/testing/development are eliminated.\n  return {\n    localDev: isLocalDev,\n    // Triggers validation or enable pub level logging. Validation can be\n    // bypassed via #validate=0.\n    // Note that AMP_DEV_MODE flag is used for testing purposes.\n    development: !!(hashQuery['development'] == '1' || win.AMP_DEV_MODE),\n    examiner: hashQuery['development'] == '2',\n    // Allows filtering validation errors by error category. For the\n    // available categories, see ErrorCategory in validator/validator.proto.\n    filter: hashQuery['filter'],\n    // amp-geo override\n    geoOverride: hashQuery['amp-geo'],\n    minified: IS_MINIFIED,\n    // Whether document is in an amp-lite viewer. It signal that the user\n    // would prefer to use less bandwidth.\n    lite: searchQuery['amp_lite'] != undefined,\n    test: runningTests,\n    log: hashQuery['log'],\n    version,\n    rtvVersion,\n  };\n}\n\n/**\n * Retrieve the `rtvVersion` which will have a numeric prefix\n * denoting canary/prod/experiment (unless `isLocalDev` is true).\n *\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n */\nfunction getRtvVersion(win, isLocalDev) {\n  // If it's local dev then we won't actually have a full version so\n  // just use the version.\n  if (isLocalDev) {\n    return version;\n  }\n\n  if (win.AMP_CONFIG && win.AMP_CONFIG.v) {\n    return win.AMP_CONFIG.v;\n  }\n\n  // Currently `$internalRuntimeVersion$` and thus `mode.version` contain only\n  // major version. The full version however must also carry the minor version.\n  // We will default to production default `01` minor version for now.\n  // TODO(erwinmombay): decide whether $internalRuntimeVersion$ should contain\n  // minor version.\n  return `01${version}`;\n}\n\n\n/**\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n * @visibleForTesting\n */\nexport function getRtvVersionForTesting(win, isLocalDev) {\n  return getRtvVersion(win, isLocalDev);\n}\n\n\n/** @visibleForTesting */\nexport function resetRtvVersionForTesting() {\n  rtvVersion = '';\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from './log';\nimport {map} from './utils/object.js';\n\nlet container;\n\n/**\n * Creates the html helper for the doc.\n *\n * @param {!Element|!Document} nodeOrDoc\n * @return {function(!Array<string>):!Element}\n */\nexport function htmlFor(nodeOrDoc) {\n  const doc = nodeOrDoc.ownerDocument || nodeOrDoc;\n  if (!container || container.ownerDocument !== doc) {\n    container = doc.createElement('div');\n  }\n\n  return html;\n}\n\n/**\n * A tagged template literal helper to generate static DOM trees.\n * This must be used as a tagged template, ie\n *\n * ```\n * const div = html`<div><span></span></div>`;\n * ```\n *\n * Only the root element and its subtree will be returned. DO NOT use this to\n * render subtree's with dynamic content, it WILL result in an error!\n *\n * @param {!Array<string>} strings\n * @return {!Element}\n */\nfunction html(strings) {\n  dev().assert(strings.length === 1, 'Improper html template tag usage.');\n  container./*OK*/innerHTML = strings[0];\n\n  const el = container.firstElementChild;\n  dev().assert(el, 'No elements in template');\n  dev().assert(!el.nextElementSibling, 'Too many root elements in template');\n\n  // Clear to free memory.\n  container./*OK*/innerHTML = '';\n\n  return el;\n}\n\n/**\n * Queries an element for all elements with a \"ref\" attribute, removing\n * the attribute afterwards.\n * Returns a named map of all ref elements.\n *\n * @param {!Element} root\n * @return {!Object<string, !Element>}\n */\nexport function htmlRefs(root) {\n  const elements = root.querySelectorAll('[ref]');\n  const refs = map();\n\n  for (let i = 0; i < elements.length; i++) {\n    const element = elements[i];\n    const ref = dev().assert(element.getAttribute('ref'), 'Empty ref attr');\n    element.removeAttribute('ref');\n    dev().assert(refs[ref] === undefined, 'Duplicate ref');\n    refs[ref] = element;\n  }\n\n  return refs;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {string} _match\n * @param {string} character\n * @return {string}\n */\nfunction toUpperCase(_match, character) {\n  return character.toUpperCase();\n}\n\n/**\n * @param {string} match\n * @return {string}\n */\nfunction prependDashAndToLowerCase(match) {\n  return '-' + match.toLowerCase();\n}\n\n/**\n * @param {string} name Attribute name containing dashes.\n * @return {string} Dashes removed and successive character sent to upper case.\n * visibleForTesting\n */\nexport function dashToCamelCase(name) {\n  return name.replace(/-([a-z])/g, toUpperCase);\n}\n\n/**\n * Converts a string that is in camelCase to one that is in dash-case.\n *\n * @param {string} string The string to convert.\n * @return {string} The string in dash-case.\n */\nexport function camelCaseToDash(string) {\n  return string.replace(/(?!^)[A-Z]/g, prependDashAndToLowerCase);\n}\n\n/**\n * @param {string} name Attribute name with dashes\n * @return {string} Dashes replaced by underlines.\n */\nexport function dashToUnderline(name) {\n  return name.replace('-', '_');\n}\n\n/**\n * Polyfill for String.prototype.endsWith.\n * @param {string} string\n * @param {string} suffix\n * @return {boolean}\n */\nexport function endsWith(string, suffix) {\n  const index = string.length - suffix.length;\n  return index >= 0 && string.indexOf(suffix, index) == index;\n}\n\n/**\n * Polyfill for String.prototype.startsWith.\n * @param {string} string\n * @param {string} prefix\n * @return {boolean}\n */\nexport function startsWith(string, prefix) {\n  if (prefix.length > string.length) {\n    return false;\n  }\n  return string.lastIndexOf(prefix, 0) == 0;\n}\n\n/**\n * Expands placeholders in a given template string with values.\n *\n * Placeholders use ${key-name} syntax and are replaced with the value\n * returned from the given getter function.\n *\n * @param {string} template The template string to expand.\n * @param {function(string):*} getter Function used to retrieve a value for a\n *   placeholder. Returns values will be coerced into strings.\n * @param {number=} opt_maxIterations Number of times to expand the template.\n *   Defaults to 1, but should be set to a larger value your placeholder tokens\n *   can be expanded to other placeholder tokens. Take caution with large values\n *   as recursively expanding a string can be exponentially expensive.\n */\nexport function expandTemplate(template, getter, opt_maxIterations) {\n  const maxIterations = opt_maxIterations || 1;\n  for (let i = 0; i < maxIterations; i++) {\n    let matches = 0;\n    template = template.replace(/\\${([^}]*)}/g, (_a, b) => {\n      matches++;\n      return getter(b);\n    });\n    if (!matches) {\n      break;\n    }\n  }\n  return template;\n}\n\n/**\n * Hash function djb2a\n * This is intended to be a simple, fast hashing function using minimal code.\n * It does *not* have good cryptographic properties.\n * @param {string} str\n * @return {string} 32-bit unsigned hash of the string\n */\nexport function stringHash32(str) {\n  const {length} = str;\n  let hash = 5381;\n  for (let i = 0; i < length; i++) {\n    hash = hash * 33 ^ str.charCodeAt(i);\n  }\n  // Convert from 32-bit signed to unsigned.\n  return String(hash >>> 0);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Note: loaded by 3p system. Cannot rely on babel polyfills.\nimport {map} from './utils/object.js';\nimport {startsWith} from './string';\n\n\n/** @type {Object<string, string>} */\nlet propertyNameCache;\n\n/** @const {!Array<string>} */\nconst vendorPrefixes = ['Webkit', 'webkit', 'Moz', 'moz', 'ms', 'O', 'o'];\n\n\n/**\n * @export\n * @param {string} camelCase camel cased string\n * @return {string} title cased string\n */\nexport function camelCaseToTitleCase(camelCase) {\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n}\n\n/**\n * Checks the style if a prefixed version of a property exists and returns\n * it or returns an empty string.\n * @private\n * @param {!Object} style\n * @param {string} titleCase the title case version of a css property name\n * @return {string} the prefixed property name or null.\n */\nfunction getVendorJsPropertyName_(style, titleCase) {\n  for (let i = 0; i < vendorPrefixes.length; i++) {\n    const propertyName = vendorPrefixes[i] + titleCase;\n    if (style[propertyName] !== undefined) {\n      return propertyName;\n    }\n  }\n  return '';\n}\n\n/**\n * Returns the possibly prefixed JavaScript property name of a style property\n * (ex. WebkitTransitionDuration) given a camelCase'd version of the property\n * (ex. transitionDuration).\n * @export\n * @param {!Object} style\n * @param {string} camelCase the camel cased version of a css property name\n * @param {boolean=} opt_bypassCache bypass the memoized cache of property\n *   mapping\n * @return {string}\n */\nexport function getVendorJsPropertyName(style, camelCase, opt_bypassCache) {\n  if (startsWith(camelCase, '--')) {\n    // CSS vars are returned as is.\n    return camelCase;\n  }\n  if (!propertyNameCache) {\n    propertyNameCache = map();\n  }\n  let propertyName = propertyNameCache[camelCase];\n  if (!propertyName || opt_bypassCache) {\n    propertyName = camelCase;\n    if (style[camelCase] === undefined) {\n      const titleCase = camelCaseToTitleCase(camelCase);\n      const prefixedPropertyName = getVendorJsPropertyName_(style, titleCase);\n\n      if (style[prefixedPropertyName] !== undefined) {\n        propertyName = prefixedPropertyName;\n      }\n    }\n    if (!opt_bypassCache) {\n      propertyNameCache[camelCase] = propertyName;\n    }\n  }\n  return propertyName;\n}\n\n\n/**\n * Sets the CSS styles of the specified element with !important. The styles\n * are specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setImportantStyles(element, styles) {\n  for (const k in styles) {\n    element.style.setProperty(\n        getVendorJsPropertyName(styles, k), styles[k].toString(), 'important');\n  }\n}\n\n\n/**\n * Sets the CSS style of the specified element with optional units, e.g. \"px\".\n * @param {?Element} element\n * @param {string} property\n * @param {*} value\n * @param {string=} opt_units\n * @param {boolean=} opt_bypassCache\n */\nexport function setStyle(element, property, value, opt_units, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (propertyName) {\n    element.style[propertyName] =\n      /** @type {string} */ (opt_units ? value + opt_units : value);\n  }\n}\n\n\n/**\n * Returns the value of the CSS style of the specified element.\n * @param {!Element} element\n * @param {string} property\n * @param {boolean=} opt_bypassCache\n * @return {*}\n */\nexport function getStyle(element, property, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (!propertyName) {\n    return undefined;\n  }\n  return element.style[propertyName];\n}\n\n\n/**\n * Sets the CSS styles of the specified element. The styles\n * a specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setStyles(element, styles) {\n  for (const k in styles) {\n    setStyle(element, k, styles[k]);\n  }\n}\n\n\n/**\n * Shows or hides the specified element.\n * @param {!Element} element\n * @param {boolean=} opt_display\n */\nexport function toggle(element, opt_display) {\n  if (opt_display === undefined) {\n    opt_display = getStyle(element, 'display') == 'none';\n  }\n  setStyle(element, 'display', opt_display ? '' : 'none');\n}\n\n\n/**\n * Returns a pixel value.\n * @param {number} value\n * @return {string}\n */\nexport function px(value) {\n  return `${value}px`;\n}\n\n/**\n * Returns a degree value.\n * @param {number} value\n * @return {string}\n */\nexport function deg(value) {\n  return `${value}deg`;\n}\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function translateX(value) {\n  if (typeof value == 'string') {\n    return `translateX(${value})`;\n  }\n  return `translateX(${px(value)})`;\n}\n\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} x\n * @param {(number|string)=} opt_y\n * @return {string}\n */\nexport function translate(x, opt_y) {\n  if (typeof x == 'number') {\n    x = px(x);\n  }\n  if (opt_y === undefined) {\n    return `translate(${x})`;\n  }\n  if (typeof opt_y == 'number') {\n    opt_y = px(opt_y);\n  }\n  return `translate(${x}, ${opt_y})`;\n}\n\n\n/**\n * Returns a \"scale\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function scale(value) {\n  return `scale(${value})`;\n}\n\n/**\n * Returns a \"rotate\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function rotate(value) {\n  if (typeof value == 'number') {\n    value = deg(value);\n  }\n  return `rotate(${value})`;\n}\n\n/**\n * Remove alpha value from a rgba color value.\n * Return the new color property with alpha equals if has the alpha value.\n * Caller needs to make sure the input color value is a valid rgba/rgb value\n * @param {string} rgbaColor\n * @return {string}\n */\nexport function removeAlphaFromColor(rgbaColor) {\n  return rgbaColor.replace(\n      /\\(([^,]+),([^,]+),([^,)]+),[^)]+\\)/g, '($1,$2,$3, 1)');\n}\n\n/**\n * Gets the computed style of the element. The helper is necessary to enforce\n * the possible `null` value returned by a buggy Firefox.\n *\n * @param {!Window} win\n * @param {!Element} el\n * @return {!Object<string, string>}\n */\nexport function computedStyle(win, el) {\n  const style = /** @type {?CSSStyleDeclaration} */(win.getComputedStyle(el));\n  return /** @type {!Object<string, string>} */(style) || map();\n}\n\n\n/**\n * Resets styles that were set dynamically (i.e. inline)\n * @param {!Element} element\n * @param {!Array<string>} properties\n */\nexport function resetStyles(element, properties) {\n  const styleObj = {};\n  properties.forEach(prop => {\n    styleObj[prop] = null;\n  });\n  setStyles(element, styleObj);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* @const */\nconst toString_ = Object.prototype.toString;\n\n/**\n * Returns the ECMA [[Class]] of a value\n * @param {*} value\n * @return {string}\n */\nfunction toString(value) {\n  return toString_.call(value);\n}\n\n/**\n * Determines if value is actually an Array.\n * @param {*} value\n * @return {boolean}\n */\nexport function isArray(value) {\n  return Array.isArray(value);\n}\n\n/**\n * Converts an array-like object to an array.\n * @param {?IArrayLike<T>|string} arrayLike\n * @return {!Array<T>}\n * @template T\n */\nexport function toArray(arrayLike) {\n  if (!arrayLike) {\n    return [];\n  }\n  const array = new Array(arrayLike.length);\n  for (let i = 0; i < arrayLike.length; i++) {\n    array[i] = arrayLike[i];\n  }\n  return array;\n}\n\n/**\n * Determines if value is actually an Object.\n * @param {*} value\n * @return {boolean}\n */\nexport function isObject(value) {\n  return toString(value) === '[object Object]';\n}\n\n/**\n * Determines if value is of number type and finite.\n * NaN and Infinity are not considered a finite number.\n * String numbers are not considered numbers.\n * @param {*} value\n * @return {boolean}\n */\nexport function isFiniteNumber(value) {\n  return (typeof value === 'number' && isFinite(value));\n}\n\n/**\n * Checks whether `s` is a valid value of `enumObj`.\n *\n * @param {!Object<T>} enumObj\n * @param {T} s\n * @return {boolean}\n * @template T\n */\nexport function isEnumValue(enumObj, s) {\n  for (const k in enumObj) {\n    if (enumObj[k] === s) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Externs declare that access `defaultView` from `document` or\n * `ownerDocument` is of type `(Window|null)` but most of our parameter types\n * assume that it is never null. This is OK in practice as we ever only get\n * null on disconnected documents or old IE.\n * This helper function casts it into just a simple Window return type.\n *\n * @param {!Window|null} winOrNull\n * @return {!Window}\n */\nexport function toWin(winOrNull) {\n  return /** @type {!Window} */ (winOrNull);\n}\n\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {tryDecodeUriComponent_} from './url-try-decode-uri-component';\n\nconst regex = /(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * DO NOT import the function from this file. Instead, import parseQueryString\n * from `src/url.js`.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString_(queryString) {\n  const params = /** @type {!JsonObject} */ (Object.create(null));\n  if (!queryString) {\n    return params;\n  }\n\n  let match;\n  while ((match = regex.exec(queryString))) {\n    const name = tryDecodeUriComponent_(match[1], match[1]);\n    const value = match[2] ? tryDecodeUriComponent_(match[2], match[2]) : '';\n    params[name] = value;\n  }\n  return params;\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * DO NOT import the function from this file. Instead, import\n * tryDecodeUriComponent from `src/url.js`.\n *\n * @param {string} component\n * @param {string=} fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent_(component, fallback = '') {\n  try {\n    return decodeURIComponent(component);\n  } catch (e) {\n    return fallback;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {isObject} from '../types';\n\n/* @const */\nconst hasOwn_ = Object.prototype.hasOwnProperty;\n\n/**\n * Returns a map-like object.\n * If opt_initial is provided, copies its own properties into the\n * newly created object.\n * @param {T=} opt_initial This should typically be an object literal.\n * @return {T}\n * @template T\n */\nexport function map(opt_initial) {\n  const obj = Object.create(null);\n  if (opt_initial) {\n    Object.assign(obj, opt_initial);\n  }\n  return obj;\n}\n\n/**\n * Return an empty JsonObject or makes the passed in object literal\n * an JsonObject.\n * The JsonObject type is just a simple object that is at-dict.\n * See\n * https://github.com/google/closure-compiler/wiki/@struct-and-@dict-Annotations\n * for what a dict is type-wise.\n * The linter enforces that the argument is, in fact, at-dict like.\n * @param {!Object=} opt_initial\n * @return {!JsonObject}\n */\nexport function dict(opt_initial) {\n  // We do not copy. The linter enforces that the passed in object is a literal\n  // and thus the caller cannot have a reference to it.\n  return /** @type {!JsonObject} */ (opt_initial || {});\n}\n\n/**\n * Checks if the given key is a property in the map.\n *\n * @param {T}  obj a map like property.\n * @param {string}  key\n * @return {boolean}\n * @template T\n */\nexport function hasOwn(obj, key) {\n  return hasOwn_.call(obj, key);\n}\n\n/**\n * Returns obj[key] iff key is obj's own property (is not inherited).\n * Otherwise, returns undefined.\n *\n * @param {Object} obj\n * @param {string} key\n * @return {*}\n */\nexport function ownProperty(obj, key) {\n  if (hasOwn(obj, key)) {\n    return obj[key];\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Deep merges source into target.\n *\n * @param {!Object} target\n * @param {!Object} source\n * @param {number} depth The maximum merge depth. If exceeded, Object.assign\n *                       will be used instead.\n * @return {!Object}\n * @throws {Error} If source contains a circular reference.\n * Note: Only nested objects are deep-merged, primitives and arrays are not.\n */\nexport function deepMerge(target, source, depth = 10) {\n  // Keep track of seen objects to detect recursive references.\n  const seen = [];\n\n  /** @type {!Array<{t: !Object, s: !Object, d: number}>} */\n  const queue = [];\n  queue.push({t: target, s: source, d: 0});\n\n  // BFS to ensure objects don't have recursive references at shallower depths.\n  while (queue.length > 0) {\n    const {t, s, d} = queue.shift();\n    if (seen.includes(s)) {\n      throw new Error('Source object has a circular reference.');\n    }\n    seen.push(s);\n    if (t === s) {\n      continue;\n    }\n    if (d > depth) {\n      Object.assign(t, s);\n      continue;\n    }\n    Object.keys(s).forEach(key => {\n      const newValue = s[key];\n      // Perform a deep merge IFF both target and source have the same key\n      // whose corresponding values are objects.\n      if (hasOwn(t, key)) {\n        const oldValue = t[key];\n        if (isObject(newValue) && isObject(oldValue)) {\n          queue.push({t: oldValue, s: newValue, d: d + 1});\n          return;\n        }\n      }\n      t[key] = newValue;\n    });\n  }\n  return target;\n}\n\n/**\n * @param {!Object} o An object to remove properties from\n * @param {!Array<string>} props A list of properties to remove from the Object\n * @return {!Object} An object with the given properties removed\n */\nexport function omit(o, props) {\n  return Object.keys(o).reduce((acc, key) => {\n    if (!props.includes(key)) {\n      acc[key] = o[key];\n    }\n    return acc;\n  }, {});\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns a Deferred struct, which holds a pending promise and its associated\n * resolve and reject functions.\n *\n * This is preferred instead of creating a Promise instance to extract the\n * resolve/reject functions yourself:\n *\n * ```\n * // Avoid doing\n * let resolve;\n * const promise = new Promise(res => {\n *   resolve = res;\n * });\n *\n * // Good\n * const deferred = new Deferred();\n * const { promise, resolve } = deferred;\n * ```\n *\n * @template T\n */\nexport class Deferred {\n  /**\n   * Creates an instance of Deferred.\n   */\n  constructor() {\n    let resolve, reject;\n\n    /**\n     * @const {!Promise<T>}\n     */\n    this.promise = new /*OK*/Promise((res, rej) => {\n      resolve = res;\n      reject = rej;\n    });\n\n    /**\n     * @const {function(T=)}\n     */\n    this.resolve = resolve;\n\n    /**\n     * @const {function(*=)}\n     */\n    this.reject = reject;\n  }\n}\n\n/**\n * Creates a promise resolved to the return value of fn.\n * If fn sync throws, it will cause the promise to reject.\n *\n * @param {function():T} fn\n * @return {!Promise<T>}\n * @template T\n */\nexport function tryResolve(fn) {\n  return new Promise(resolve => {\n    resolve(fn());\n  });\n}\n\n/**\n * Returns a promise which resolves if a threshold amount of the given promises\n * resolve, and rejects otherwise.\n * @param {!Array<!Promise>} promises The array of promises to test.\n * @param {number} count The number of promises that must resolve for the\n *     returned promise to resolve.\n * @return {!Promise} A promise that resolves if any of the given promises\n *     resolve, and which rejects otherwise.\n */\nexport function some(promises, count = 1) {\n  return new Promise((resolve, reject) => {\n    count = Math.max(count, 0);\n    const extra = promises.length - count;\n    if (extra < 0) {\n      reject(new Error('not enough promises to resolve'));\n    }\n    if (promises.length == 0) {\n      resolve([]);\n    }\n    const values = [];\n    const reasons = [];\n\n    const onFulfilled = value => {\n      if (values.length < count) {\n        values.push(value);\n      }\n      if (values.length == count) {\n        resolve(values);\n      }\n    };\n    const onRejected = reason => {\n      if (reasons.length <= extra) {\n        reasons.push(reason);\n      }\n      if (reasons.length > extra) {\n        reject(reasons);\n      }\n    };\n    for (let i = 0; i < promises.length; i++) {\n      Promise.resolve(promises[i]).then(onFulfilled, onRejected);\n    }\n  });\n}\n\n/**\n * Resolves with the result of the last promise added.\n * @implements {IThenable}\n */\nexport class LastAddedResolver {\n  /**\n   * @param {!Array<!Promise>=} opt_promises\n   */\n  constructor(opt_promises) {\n    let resolve_, reject_;\n    /** @private @const {!Promise} */\n    this.promise_ = new Promise((resolve, reject) => {\n      resolve_ = resolve;\n      reject_ = reject;\n    });\n\n    /** @private */\n    this.resolve_ = resolve_;\n\n    /** @private */\n    this.reject_ = reject_;\n\n    /** @private */\n    this.count_ = 0;\n\n    if (opt_promises) {\n      for (let i = 0; i < opt_promises.length; i++) {\n        this.add(opt_promises[i]);\n      }\n    }\n  }\n\n  /**\n   * Add a promise to possibly be resolved.\n   * @param {!Promise} promise\n   * @return {!Promise}\n   */\n  add(promise) {\n    const countAtAdd = ++this.count_;\n    Promise.resolve(promise).then(result => {\n      if (this.count_ === countAtAdd) {\n        this.resolve_(result);\n      }\n    }, error => {\n      // Don't follow behavior of Promise.all and Promise.race error so that\n      // this will only reject when most recently added promise fails.\n      if (this.count_ === countAtAdd) {\n        this.reject_(error);\n      }\n    });\n    return this.promise_;\n  }\n\n  /** @override */\n  then(opt_resolve, opt_reject) {\n    return this.promise_.then(opt_resolve, opt_reject);\n  }\n}\n","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n\n\n/**\n * This regex consists of 4 matching capture groups and one (non-matching) fallback:\n *\n * - (\\0), catch the null terminator character so it may be replaced by UTF\n *   Replacement Char\n * - ^(-)$, catch a solitary dash char, so that it may be backslash escaped.\n *   This is a separate capture group so that the legal-chars (group 4) doesn't\n *   capture it first, since that group doesn't need to escape its dash.\n * - ([\\x01-\\x1f\\x7f]|^-?[0-9]), catch a UTF control char, or any leading\n *   number (with an optional leading dash). The control or the number (but not\n *   the leading dash) must be hex-escaped,.\n * - ([\\x80-\\uffff0-9a-zA-Z_-]+), catch legal-chars, with the exception of a\n *   solitary dash, which will already have matched in group 1.\n * - [^], finally, a catch-all that allows us to backslash escape the char.\n *\n * Together, this matches everything necessary for CSS.escape.\n */\nvar regex = /(\\0)|^(-)$|([\\x01-\\x1f\\x7f]|^-?[0-9])|([\\x80-\\uffff0-9a-zA-Z_-]+)|[^]/g;\n\nfunction escaper(match, nil, dash, hexEscape, chars) {\n  // Chars is the legal-chars (group 4) capture\n  if (chars) {\n    return chars;\n  }\n  // Nil is the null terminator (group 1) capture\n  if (nil) {\n    return '\\uFFFD';\n  }\n  // Both UTF control chars, and leading numbers (with optional leading dash)\n  // (group 3) must be backslash escaped with a trailing space.  Funnily, the\n  // leading dash must not be escaped, but the number. :shrug:\n  if (hexEscape) {\n    return match.slice(0, -1) + '\\\\' + match.slice(-1).charCodeAt(0).toString(16) + ' '\n  }\n  // Finally, the solitary dash and the catch-all chars require backslash\n  // escaping.\n  return '\\\\' + match;\n}\n\n/**\n * https://drafts.csswg.org/cssom/#serialize-an-identifier\n * @param {string} value\n * @return {string}\n */\nexport function cssEscape(value) {\n  return String(value).replace(regex, escaper);\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJidWlsZC9hbXAtaW5zdGFncmFtLTAuMS5jc3MuanMiLCJleHRlbnNpb25zL2FtcC1pbnN0YWdyYW0vMC4xL2FtcC1pbnN0YWdyYW0uanMiLCJzcmMvZG9tLmpzIiwic3JjL2V2ZW50LWhlbHBlci1saXN0ZW4uanMiLCJzcmMvZXZlbnQtaGVscGVyLmpzIiwic3JjL2pzb24uanMiLCJzcmMvbGF5b3V0LmpzIiwic3JjL2xvZy5qcyIsInNyYy9tb2RlLW9iamVjdC5qcyIsInNyYy9tb2RlLmpzIiwic3JjL3N0YXRpYy10ZW1wbGF0ZS5qcyIsInNyYy9zdHJpbmcuanMiLCJzcmMvc3R5bGUuanMiLCJzcmMvdHlwZXMuanMiLCJzcmMvdXJsLXBhcnNlLXF1ZXJ5LXN0cmluZy5qcyIsInNyYy91cmwtdHJ5LWRlY29kZS11cmktY29tcG9uZW50LmpzIiwic3JjL3V0aWxzL29iamVjdC5qcyIsInNyYy91dGlscy9wcm9taXNlLmpzIiwidGhpcmRfcGFydHkvY3NzLWVzY2FwZS9jc3MtZXNjYXBlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FDQU8sSUFBTSxvQkFBTSxrSkFBWjs7Ozs7QUNzQ1A7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7OzsrZUE5Q0E7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpQkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQStCTSxZOzs7QUFFSjtBQUNBLHdCQUFZLE9BQVosRUFBcUI7QUFBQTs7QUFHbkI7QUFIbUIsNEhBQ2IsT0FEYTs7QUFJbkIsVUFBSyxPQUFMLEdBQWUsSUFBZjs7QUFFQTtBQUNBLFVBQUssVUFBTCxHQUFrQixFQUFsQjs7QUFFQTtBQUNBLFVBQUssZ0JBQUwsR0FBd0IsSUFBeEI7O0FBRUE7QUFDQSxVQUFLLFVBQUwsR0FBa0IsRUFBbEI7O0FBRUE7Ozs7QUFJQSxVQUFLLGNBQUwsR0FBc0IsSUFBdEI7QUFuQm1CO0FBb0JwQjtBQUNEOzs7Ozs7Ozt1Q0FJbUIsWSxFQUFjO0FBQy9CO0FBQ0E7QUFDQSxXQUFLLFVBQUwsQ0FBZ0IsR0FBaEIsQ0FBb0IsMkJBQXBCLEVBQWlELFlBQWpEO0FBQ0E7QUFDQTtBQUNBLFdBQUssVUFBTCxDQUFnQixHQUFoQixDQUFvQix5Q0FBcEIsRUFDSSxZQURKO0FBRUQ7O0FBRUQ7Ozs7NENBQ3dCO0FBQ3RCLGFBQU8sS0FBUDtBQUNEOztBQUVEOzs7O29DQUNnQjtBQUNkLFdBQUssVUFBTCxHQUFrQixpQkFBTyxNQUFQLENBQ2IsS0FBSyxPQUFMLENBQWEsWUFBYixDQUEwQixnQkFBMUIsS0FDRCxLQUFLLE9BQUwsQ0FBYSxZQUFiLENBQTBCLFdBQTFCLENBRmMsRUFHZCxpRUFIYyxFQUlkLEtBQUssT0FKUyxDQUFsQjtBQUtBLFdBQUssVUFBTCxHQUFrQixLQUFLLE9BQUwsQ0FBYSxZQUFiLENBQTBCLGdCQUExQixJQUNoQixZQURnQixHQUNELEVBRGpCO0FBRUQ7O0FBRUQ7Ozs7Z0RBQzRCO0FBQzFCLFVBQU0sY0FBYyxLQUFLLEdBQUwsQ0FBUyxRQUFULENBQWtCLGFBQWxCLENBQWdDLEtBQWhDLENBQXBCO0FBQ0Esa0JBQVksWUFBWixDQUF5QixhQUF6QixFQUF3QyxFQUF4QztBQUNBLFVBQU0sUUFBUSxLQUFLLEdBQUwsQ0FBUyxRQUFULENBQWtCLGFBQWxCLENBQWdDLFNBQWhDLENBQWQ7QUFDQSxZQUFNLFlBQU4sQ0FBbUIsYUFBbkIsRUFBa0MsRUFBbEM7QUFDQTtBQUNBO0FBQ0EsWUFBTSxZQUFOLENBQW1CLEtBQW5CLEVBQTBCLGlDQUN0QixtQkFBbUIsS0FBSyxVQUF4QixDQURzQixHQUNnQixnQkFEMUM7QUFFQSxZQUFNLFlBQU4sQ0FBbUIsUUFBbkIsRUFBNkIsTUFBN0I7QUFDQSxZQUFNLFlBQU4sQ0FBbUIsZ0JBQW5CLEVBQXFDLFFBQXJDOztBQUVBLFdBQUssbUJBQUwsQ0FBeUIsQ0FBQyxLQUFELENBQXpCLEVBQWtDLEtBQWxDO0FBQ0E7OztBQUdBLFVBQUksS0FBSyxPQUFMLENBQWEsWUFBYixDQUEwQixzQkFBMUIsQ0FBSixFQUF1RDtBQUNyRCxhQUFLLE9BQUwsQ0FBYSxTQUFiLENBQXVCLEdBQXZCLENBQTJCLCtCQUEzQjtBQUNEOztBQUVEO0FBQ0E7QUFDQSw0QkFBVSxLQUFWLEVBQWlCO0FBQ2YsZUFBTyxNQURRO0FBRWYsa0JBQVUsTUFGSztBQUdmLGdCQUFRLE1BSE87QUFJZixpQkFBUztBQUpNLE9BQWpCO0FBTUEsa0JBQVksV0FBWixDQUF3QixLQUF4QjtBQUNBLGFBQU8sV0FBUDtBQUNEOztBQUVEOzs7O3NDQUNrQixNLEVBQVE7QUFDeEIsYUFBTyxpQ0FBb0IsTUFBcEIsQ0FBUDtBQUNEOztBQUVEOzs7O3FDQUNpQjtBQUFBOztBQUNmLFVBQU0sU0FBUyxLQUFLLE9BQUwsQ0FBYSxhQUFiLENBQTJCLGFBQTNCLENBQXlDLFFBQXpDLENBQWY7QUFDQSxXQUFLLE9BQUwsR0FBZSxNQUFmOztBQUVBLFdBQUssZ0JBQUwsR0FBd0IseUJBQ3BCLEtBQUssR0FEZSxFQUVwQixTQUZvQixFQUdwQixLQUFLLHdCQUFMLENBQThCLElBQTlCLENBQW1DLElBQW5DLENBSG9CLENBQXhCOztBQU1BLGFBQU8sWUFBUCxDQUFvQixXQUFwQixFQUFpQyxJQUFqQztBQUNBLGFBQU8sWUFBUCxDQUFvQixhQUFwQixFQUFtQyxHQUFuQztBQUNBLGFBQU8sWUFBUCxDQUFvQixtQkFBcEIsRUFBeUMsTUFBekM7QUFDQTtBQUNBLGFBQU8sWUFBUCxDQUFvQixPQUFwQixFQUE2QixnQkFDekIsS0FBSyxPQUFMLENBQWEsWUFBYixDQUEwQixLQUExQixDQURKO0FBRUEsYUFBTyxHQUFQLEdBQWEsaUNBQ1QsbUJBQW1CLEtBQUssVUFBeEIsQ0FEUyxHQUM2QixTQUQ3QixHQUVULEtBQUssVUFGSSxHQUVTLFdBRnRCO0FBR0EsV0FBSyxnQkFBTCxDQUFzQixNQUF0QjtBQUNBLFdBQUssT0FBTCxDQUFhLFdBQWIsQ0FBeUIsTUFBekI7QUFDQSw0QkFBVSxNQUFWLEVBQWtCO0FBQ2hCLG1CQUFXO0FBREssT0FBbEI7QUFHQSxhQUFPLEtBQUssY0FBTCxHQUFzQixLQUFLLFdBQUwsQ0FBaUIsTUFBakIsRUFBeUIsSUFBekIsQ0FBOEIsWUFBTTtBQUMvRCxlQUFLLFFBQUwsR0FBZ0IsTUFBaEIsQ0FBdUIsWUFBTTtBQUMzQixnQ0FBVSxNQUFWLEVBQWtCO0FBQ2hCLHVCQUFXO0FBREssV0FBbEI7QUFHRCxTQUpEO0FBS0QsT0FONEIsQ0FBN0I7QUFPRDs7QUFFRDs7Ozs7Ozs2Q0FJeUIsSyxFQUFPO0FBQUE7O0FBQzlCLFVBQUksTUFBTSxNQUFOLElBQWdCLDJCQUFoQixJQUNBLE1BQU0sTUFBTixJQUFnQixLQUFLLE9BQUwsQ0FBYSxhQURqQyxFQUNnRDtBQUM5QztBQUNEO0FBQ0QsVUFBTSxZQUFZLDBCQUFRLEtBQVIsQ0FBbEI7QUFDQSxVQUFJLENBQUMsU0FBRCxJQUFjLEVBQUUscUJBQVMsU0FBVCxLQUNiLHlCQUFXLHFCQUF1QixTQUFsQyxFQUE4QyxHQUE5QyxDQURXLENBQWxCLEVBQzREO0FBQzFELGVBRDBELENBQ2xEO0FBQ1Q7QUFDRCxVQUFNLE9BQU8scUJBQVMsU0FBVCxJQUFzQixTQUF0QixHQUFrQyx3QkFBYSxTQUFiLENBQS9DO0FBQ0EsVUFBSSxTQUFTLFNBQWIsRUFBd0I7QUFDdEIsZUFEc0IsQ0FDZDtBQUNUO0FBQ0QsVUFBSSxLQUFLLE1BQUwsS0FBZ0IsU0FBaEIsSUFBNkIsS0FBSyxTQUFMLENBQWpDLEVBQWtEO0FBQ2hELFlBQU0sU0FBUyxLQUFLLFNBQUwsRUFBZ0IsUUFBaEIsQ0FBZjtBQUNBLGFBQUssUUFBTCxHQUFnQixPQUFoQixDQUF3QixZQUFNO0FBQzVCLGNBQUksT0FBSyxPQUFMLElBQWdCLE9BQUssT0FBTCxFQUFhLE1BQU0sWUFBbkIsS0FBb0MsTUFBeEQsRUFBZ0U7QUFDOUQsb0JBQUssTUFBTSxZQUFYLENBQXdCLE1BQXhCO0FBQ0Q7QUFDRixTQUpEO0FBS0Q7QUFDRjs7QUFFRDs7OztzQ0FDa0I7QUFDaEIsYUFBTyxJQUFQO0FBQ0Q7O0FBRUQ7Ozs7dUNBQ21CO0FBQ2pCLFVBQUksS0FBSyxPQUFULEVBQWtCO0FBQ2hCLGdDQUFjLEtBQUssT0FBbkI7QUFDQSxhQUFLLE9BQUwsR0FBZSxJQUFmO0FBQ0EsYUFBSyxjQUFMLEdBQXNCLElBQXRCO0FBQ0Q7QUFDRCxVQUFJLEtBQUssZ0JBQVQsRUFBMkI7QUFDekIsYUFBSyxnQkFBTDtBQUNEO0FBQ0QsYUFBTyxJQUFQLENBVGlCLENBU0o7QUFDZDs7OztFQTFLd0IsSUFBSSxXOztBQThLL0IsSUFBSSxTQUFKLENBQWMsZUFBZCxFQUErQixLQUEvQixFQUFzQyxlQUFPO0FBQzNDLE1BQUksZUFBSixDQUFvQixlQUFwQixFQUFxQyxZQUFyQztBQUNELENBRkQ7Ozs7Ozs7UUM5S2dCLFksR0FBQSxZO1FBa0NBLG1CLEdBQUEsbUI7UUFhQSxXLEdBQUEsVztRQVVBLGtCLEdBQUEsa0I7UUFXQSxhLEdBQUEsYTtRQVdBLGMsR0FBQSxjO1FBY0EsWSxHQUFBLFk7UUFlQSxvQixHQUFBLG9CO1FBV0Esc0IsR0FBQSxzQjtRQWNBLDJCLEdBQUEsMkI7UUFXQSxlLEdBQUEsZTtRQXdCQSxXLEdBQUEsVztRQWtCQSxPLEdBQUEsTztRQWlCQSxXLEdBQUEsVztRQWlCQSxZLEdBQUEsWTtRQWdCQSxpQixHQUFBLGlCO1FBZ0JBLE8sR0FBQSxPO1FBa0JBLFksR0FBQSxZO1FBa0JBLFksR0FBQSxZO1FBaUJBLGEsR0FBQSxhO1FBa0JBLGdCLEdBQUEsZ0I7UUFpQkEsVSxHQUFBLFU7UUFxQkEsbUMsR0FBQSxtQztRQTZCQSxrQixHQUFBLGtCO1FBV0Esc0IsR0FBQSxzQjtRQWFBLG1CLEdBQUEsbUI7UUFXQSxpQixHQUFBLGlCO1FBV0Esa0IsR0FBQSxrQjtRQVlBLG1CLEdBQUEsbUI7UUF3QkEsc0IsR0FBQSxzQjtRQTBCQSwyQixHQUFBLDJCO1FBeUJBLDBCLEdBQUEsMEI7UUFrQkEsZ0IsR0FBQSxnQjtRQWtCQSxxQixHQUFBLHFCO1FBZ0JBLG9CLEdBQUEsb0I7UUFvQkEsYSxHQUFBLGE7UUFtQkEsZ0IsR0FBQSxnQjtRQXVCQSxlLEdBQUEsZTtRQVVBLGlCLEdBQUEsaUI7UUFVQSxLLEdBQUEsSztRQWdCQSxzQixHQUFBLHNCO1FBWUEsb0IsR0FBQSxvQjtRQVlBLFUsR0FBQSxVO1FBb0JBLFEsR0FBQSxRO1FBYUEsUyxHQUFBLFM7UUFTQSxZLEdBQUEsWTtRQWVBLDJCLEdBQUEsMkI7UUF1QkEsZSxHQUFBLGU7UUFxQkEsYyxHQUFBLGM7UUFvQ0EsbUIsR0FBQSxtQjtRQXlCQSxTLEdBQUEsUzs7QUEzM0JoQjs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFyQkE7Ozs7Ozs7Ozs7Ozs7Ozs7QUF1QkEsSUFBTSxvQkFBb0I7QUFDeEIsT0FBSyxPQURtQjtBQUV4QixPQUFLLE1BRm1CO0FBR3hCLE9BQUssTUFIbUI7QUFJeEIsT0FBSyxRQUptQjtBQUt4QixPQUFLLFFBTG1CO0FBTXhCLE9BQUs7QUFObUIsQ0FBMUI7QUFRQSxJQUFNLG9CQUFvQixnQkFBMUI7O0FBRUE7QUFDTyxJQUFNLDhFQUNULGVBREc7O0FBR1A7QUFDTyxJQUFNLGdGQUNULGVBREc7O0FBR1A7Ozs7Ozs7QUFPTyxTQUFTLFlBQVQsQ0FBc0IsTUFBdEIsRUFBOEIsU0FBOUIsRUFBeUMsUUFBekMsRUFBbUQ7QUFDeEQsTUFBSSxVQUFVLE1BQVYsQ0FBSixFQUF1QjtBQUNyQjtBQUNBO0FBQ0Q7QUFDRDtBQUNBLE1BQU0sTUFBTSxrQkFBTSxPQUFPLGFBQVAsQ0FBcUIsV0FBM0IsQ0FBWjtBQUNBLE1BQUksSUFBSSxnQkFBUixFQUEwQjtBQUN4QjtBQUNBLFFBQU0sV0FBVyxJQUFJLElBQUksZ0JBQVIsQ0FBeUIsWUFBTTtBQUM5QyxVQUFJLFVBQVUsTUFBVixDQUFKLEVBQXVCO0FBQ3JCLGlCQUFTLFVBQVQ7QUFDQTtBQUNEO0FBQ0YsS0FMZ0IsQ0FBakI7QUFNQSxhQUFTLE9BQVQsQ0FBaUIsTUFBakIsRUFBeUIsRUFBQyxXQUFXLElBQVosRUFBekI7QUFDRCxHQVRELE1BU087QUFDTDtBQUNBLFFBQU0sV0FBVyxJQUFJLFdBQUosQ0FBZ0IsWUFBTTtBQUNyQyxVQUFJLFVBQVUsTUFBVixDQUFKLEVBQXVCO0FBQ3JCLFlBQUksYUFBSixDQUFrQixRQUFsQjtBQUNBO0FBQ0Q7QUFDRixLQUxnQixFQUtkLGtCQUFtQixDQUxMLENBQWpCO0FBTUQ7QUFDRjs7QUFFRDs7Ozs7OztBQU9PLFNBQVMsbUJBQVQsQ0FBNkIsTUFBN0IsRUFBcUMsU0FBckMsRUFBZ0Q7QUFDckQsU0FBTyxJQUFJLE9BQUosQ0FBWSxtQkFBVztBQUM1QixpQkFBYSxNQUFiLEVBQXFCLFNBQXJCLEVBQWdDLE9BQWhDO0FBQ0QsR0FGTSxDQUFQO0FBR0Q7O0FBRUQ7Ozs7Ozs7QUFPTyxTQUFTLFdBQVQsQ0FBcUIsR0FBckIsRUFBMEIsUUFBMUIsRUFBb0M7QUFDekMsZUFBYSxJQUFJLGVBQWpCLEVBQWtDO0FBQUEsV0FBTSxDQUFDLENBQUMsSUFBSSxJQUFaO0FBQUEsR0FBbEMsRUFBb0QsUUFBcEQ7QUFDRDs7QUFHRDs7Ozs7QUFLTyxTQUFTLGtCQUFULENBQTRCLEdBQTVCLEVBQWlDO0FBQ3RDLFNBQU8sSUFBSSxPQUFKLENBQVksbUJBQVc7QUFDNUIsZ0JBQVksR0FBWixFQUFpQixPQUFqQjtBQUNELEdBRk0sQ0FBUDtBQUdEOztBQUdEOzs7O0FBSU8sU0FBUyxhQUFULENBQXVCLE9BQXZCLEVBQWdDO0FBQ3JDLE1BQUksUUFBUSxhQUFaLEVBQTJCO0FBQ3pCLFlBQVEsYUFBUixDQUFzQixXQUF0QixDQUFrQyxPQUFsQztBQUNEO0FBQ0Y7O0FBR0Q7Ozs7QUFJTyxTQUFTLGNBQVQsQ0FBd0IsTUFBeEIsRUFBZ0M7QUFDckMsU0FBTyxPQUFPLFVBQWQsRUFBMEI7QUFDeEIsV0FBTyxXQUFQLENBQW1CLE9BQU8sVUFBMUI7QUFDRDtBQUNGOztBQUdEOzs7Ozs7O0FBT08sU0FBUyxZQUFULENBQXNCLElBQXRCLEVBQTRCLEVBQTVCLEVBQWdDO0FBQ3JDLE1BQU0sT0FBTyxHQUFHLGFBQUgsQ0FBaUIsc0JBQWpCLEVBQWI7QUFDQSxPQUFLLElBQUksSUFBSSxLQUFLLFVBQWxCLEVBQThCLENBQTlCLEVBQWlDLElBQUksRUFBRSxXQUF2QyxFQUFvRDtBQUNsRCxTQUFLLFdBQUwsQ0FBaUIsRUFBRSxTQUFGLENBQVksSUFBWixDQUFqQjtBQUNEO0FBQ0QsS0FBRyxXQUFILENBQWUsSUFBZjtBQUNEOztBQUVEOzs7Ozs7O0FBT08sU0FBUyxvQkFBVCxDQUE4QixJQUE5QixFQUFvQyxPQUFwQyxFQUE2QyxLQUE3QyxFQUFvRDtBQUN6RCxNQUFNLFNBQVMsUUFBUSxNQUFNLFdBQWQsR0FBNEIsS0FBSyxVQUFoRDtBQUNBLE9BQUssWUFBTCxDQUFrQixPQUFsQixFQUEyQixNQUEzQjtBQUNEOztBQUVEOzs7Ozs7QUFNTyxTQUFTLHNCQUFULENBQWdDLE9BQWhDLEVBQXlDLFVBQXpDLEVBQXFEO0FBQzFELE9BQUssSUFBTSxJQUFYLElBQW1CLFVBQW5CLEVBQStCO0FBQzdCLFlBQVEsWUFBUixDQUFxQixJQUFyQixFQUEyQixXQUFXLElBQVgsQ0FBM0I7QUFDRDtBQUNELFNBQU8sT0FBUDtBQUNEOztBQUVEOzs7Ozs7O0FBT08sU0FBUywyQkFBVCxDQUFxQyxHQUFyQyxFQUEwQyxPQUExQyxFQUFtRCxVQUFuRCxFQUErRDtBQUNwRSxNQUFNLFVBQVUsSUFBSSxhQUFKLENBQWtCLE9BQWxCLENBQWhCO0FBQ0EsU0FBTyx1QkFBdUIsT0FBdkIsRUFBZ0MsVUFBaEMsQ0FBUDtBQUNEOztBQUVEOzs7Ozs7QUFNTyxTQUFTLGVBQVQsQ0FBeUIsSUFBekIsRUFBK0I7QUFDcEMsTUFBTSxZQUFZLEtBQUssV0FBdkI7QUFDQSxNQUFJLGNBQWMsU0FBbEIsRUFBNkI7QUFDM0IsV0FBTyxTQUFQO0FBQ0Q7O0FBRUQ7QUFDQSxNQUFJLElBQUksSUFBUjtBQUNBLEtBQUc7QUFDRCxRQUFJLFlBQVksQ0FBWixDQUFKO0FBQ0EsUUFBSSxFQUFFLElBQU4sRUFBWTtBQUNWLFVBQUksRUFBRSxJQUFOO0FBQ0QsS0FGRCxNQUVPO0FBQ0w7QUFDRDtBQUNGLEdBUEQsUUFPUyxJQVBUO0FBUUEsU0FBTyxFQUFFLFFBQUYsS0FBZSxLQUFLLGFBQTNCO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxXQUFULENBQXFCLElBQXJCLEVBQTJCO0FBQ2hDLE1BQUksS0FBSyxTQUFMLENBQWUsV0FBbkIsRUFBZ0M7QUFDOUI7QUFDQSxXQUFPLEtBQUssV0FBTCxNQUFzQixJQUE3QjtBQUNEO0FBQ0QsTUFBSSxVQUFKO0FBQ0EsT0FBSyxJQUFJLElBQVQsRUFBZSxDQUFDLENBQUMsRUFBRSxVQUFuQixFQUErQixJQUFJLEVBQUUsVUFBckMsRUFBaUQsQ0FBRTtBQUNuRCxTQUFPLENBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7QUFRTyxTQUFTLE9BQVQsQ0FBaUIsT0FBakIsRUFBMEIsUUFBMUIsRUFBb0MsVUFBcEMsRUFBZ0Q7QUFDckQsT0FBSyxJQUFJLEtBQUssT0FBZCxFQUF1QixNQUFNLE9BQU8sVUFBcEMsRUFBZ0QsS0FBSyxHQUFHLGFBQXhELEVBQXVFO0FBQ3JFLFFBQUksU0FBUyxFQUFULENBQUosRUFBa0I7QUFDaEIsYUFBTyxFQUFQO0FBQ0Q7QUFDRjtBQUNELFNBQU8sSUFBUDtBQUNEOztBQUdEOzs7Ozs7O0FBT08sU0FBUyxXQUFULENBQXFCLElBQXJCLEVBQTJCLFFBQTNCLEVBQXFDO0FBQzFDLE9BQUssSUFBSSxJQUFJLElBQWIsRUFBbUIsQ0FBbkIsRUFBc0IsSUFBSSxFQUFFLFVBQTVCLEVBQXdDO0FBQ3RDLFFBQUksU0FBUyxDQUFULENBQUosRUFBaUI7QUFDZixhQUFPLENBQVA7QUFDRDtBQUNGO0FBQ0QsU0FBTyxJQUFQO0FBQ0Q7O0FBR0Q7Ozs7Ozs7QUFPTyxTQUFTLFlBQVQsQ0FBc0IsT0FBdEIsRUFBK0IsT0FBL0IsRUFBd0M7QUFDN0MsTUFBSSxRQUFRLE9BQVosRUFBcUI7QUFDbkIsV0FBTyxRQUFRLE9BQVIsQ0FBZ0IsT0FBaEIsQ0FBUDtBQUNEO0FBQ0QsWUFBVSxRQUFRLFdBQVIsRUFBVjtBQUNBLFNBQU8sUUFBUSxPQUFSLEVBQWlCLGNBQU07QUFDNUIsV0FBTyxHQUFHLE9BQUgsSUFBYyxPQUFyQjtBQUNELEdBRk0sQ0FBUDtBQUdEOztBQUVEOzs7Ozs7QUFNTyxTQUFTLGlCQUFULENBQTJCLE9BQTNCLEVBQW9DLFFBQXBDLEVBQThDO0FBQ25ELE1BQUksUUFBUSxPQUFaLEVBQXFCO0FBQ25CLFdBQU8sUUFBUSxPQUFSLENBQWdCLFFBQWhCLENBQVA7QUFDRDs7QUFFRCxTQUFPLFFBQVEsT0FBUixFQUFpQixjQUFNO0FBQzVCLFdBQU8sUUFBUSxFQUFSLEVBQVksUUFBWixDQUFQO0FBQ0QsR0FGTSxDQUFQO0FBR0Q7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsT0FBVCxDQUFpQixFQUFqQixFQUFxQixRQUFyQixFQUErQjtBQUNwQyxNQUFNLFVBQVUsR0FBRyxPQUFILElBQ1osR0FBRyxxQkFEUyxJQUVaLEdBQUcsa0JBRlMsSUFHWixHQUFHLGlCQUhTLElBSVosR0FBRyxnQkFKUDtBQUtBLE1BQUksT0FBSixFQUFhO0FBQ1gsV0FBTyxRQUFRLElBQVIsQ0FBYSxFQUFiLEVBQWlCLFFBQWpCLENBQVA7QUFDRDtBQUNELFNBQU8sS0FBUCxDQVRvQyxDQVN0QjtBQUNmOztBQUVEOzs7Ozs7QUFNTyxTQUFTLFlBQVQsQ0FBc0IsT0FBdEIsRUFBK0IsT0FBL0IsRUFBd0M7QUFDN0MsTUFBSSxpQkFBSjtBQUNBO0FBQ0EsTUFBSSxPQUFPLFFBQVEsb0JBQWYsS0FBd0MsVUFBNUMsRUFBd0Q7QUFDdEQsZUFBVyxRQUFRLG9CQUFSLENBQTZCLE9BQTdCLENBQVg7QUFDRCxHQUZELE1BRU87QUFDTCxlQUFXLFNBQVEsTUFBTSxnQkFBZCxDQUErQixPQUEvQixDQUFYO0FBQ0Q7QUFDRCxTQUFRLFlBQVksU0FBUyxDQUFULENBQWIsSUFBNkIsSUFBcEM7QUFDRDs7QUFHRDs7Ozs7O0FBTU8sU0FBUyxZQUFULENBQXNCLE1BQXRCLEVBQThCLFFBQTlCLEVBQXdDO0FBQzdDLE9BQUssSUFBSSxRQUFRLE9BQU8saUJBQXhCLEVBQTJDLEtBQTNDLEVBQ0UsUUFBUSxNQUFNLGtCQURoQixFQUNvQztBQUNsQyxRQUFJLFNBQVMsS0FBVCxDQUFKLEVBQXFCO0FBQ25CLGFBQU8sS0FBUDtBQUNEO0FBQ0Y7QUFDRCxTQUFPLElBQVA7QUFDRDs7QUFHRDs7Ozs7O0FBTU8sU0FBUyxhQUFULENBQXVCLE1BQXZCLEVBQStCLFFBQS9CLEVBQXlDO0FBQzlDLE1BQU0sV0FBVyxFQUFqQjtBQUNBLE9BQUssSUFBSSxRQUFRLE9BQU8saUJBQXhCLEVBQTJDLEtBQTNDLEVBQ0UsUUFBUSxNQUFNLGtCQURoQixFQUNvQztBQUNsQyxRQUFJLFNBQVMsS0FBVCxDQUFKLEVBQXFCO0FBQ25CLGVBQVMsSUFBVCxDQUFjLEtBQWQ7QUFDRDtBQUNGO0FBQ0QsU0FBTyxRQUFQO0FBQ0Q7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsZ0JBQVQsQ0FBMEIsTUFBMUIsRUFBa0MsUUFBbEMsRUFBNEM7QUFDakQsT0FBSyxJQUFJLFFBQVEsT0FBTyxnQkFBeEIsRUFBMEMsS0FBMUMsRUFDRSxRQUFRLE1BQU0sc0JBRGhCLEVBQ3dDO0FBQ3RDLFFBQUksU0FBUyxLQUFULENBQUosRUFBcUI7QUFDbkIsYUFBTyxLQUFQO0FBQ0Q7QUFDRjtBQUNELFNBQU8sSUFBUDtBQUNEOztBQUVEOzs7Ozs7O0FBT08sU0FBUyxVQUFULENBQW9CLE1BQXBCLEVBQTRCLFFBQTVCLEVBQXNDO0FBQzNDLE1BQU0sUUFBUSxFQUFkO0FBQ0EsT0FBSyxJQUFJLFFBQVEsT0FBTyxVQUF4QixFQUFvQyxLQUFwQyxFQUNFLFFBQVEsTUFBTSxXQURoQixFQUM2QjtBQUMzQixRQUFJLFNBQVMsS0FBVCxDQUFKLEVBQXFCO0FBQ25CLFlBQU0sSUFBTixDQUFXLEtBQVg7QUFDRDtBQUNGO0FBQ0QsU0FBTyxLQUFQO0FBQ0Q7O0FBRUQ7Ozs7QUFJQSxJQUFJLCtCQUFKOztBQUVBOzs7O0FBSU8sU0FBUyxtQ0FBVCxDQUE2QyxHQUE3QyxFQUFrRDtBQUN2RCwyQkFBeUIsR0FBekI7QUFDRDs7QUFFRDs7Ozs7QUFLQSxTQUFTLHdCQUFULENBQWtDLE1BQWxDLEVBQTBDO0FBQ3hDLE1BQU0sTUFBTSxPQUFPLGFBQW5CO0FBQ0EsTUFBSTtBQUNGLFFBQU0sY0FBYyxJQUFJLGFBQUosQ0FBa0IsS0FBbEIsQ0FBcEI7QUFDQSxRQUFNLFlBQVksSUFBSSxhQUFKLENBQWtCLEtBQWxCLENBQWxCO0FBQ0EsZ0JBQVksV0FBWixDQUF3QixTQUF4QjtBQUNBO0FBQ0E7QUFDQSxXQUFPLGFBQVksTUFBTSxhQUFsQixDQUFnQyxZQUFoQyxNQUFrRCxTQUF6RDtBQUNELEdBUEQsQ0FPRSxPQUFPLENBQVAsRUFBVTtBQUNWLFdBQU8sS0FBUDtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsa0JBQVQsQ0FBNEIsTUFBNUIsRUFBb0MsSUFBcEMsRUFBMEM7QUFDL0MsU0FBTyxvQkFBbUIsTUFBbkIsQ0FBMEIsTUFBMUIsVUFBd0MsSUFBeEMsT0FBUDtBQUNEOztBQUdEOzs7Ozs7QUFNTyxTQUFTLHNCQUFULENBQWdDLE1BQWhDLEVBQXdDLElBQXhDLEVBQThDO0FBQ25ELFNBQU8saUJBQWlCLE1BQWpCLEVBQXlCLGNBQU07QUFDcEMsV0FBTyxHQUFHLFlBQUgsQ0FBZ0IsSUFBaEIsQ0FBUDtBQUNELEdBRk0sQ0FBUDtBQUdEOztBQUdEOzs7Ozs7QUFNTyxTQUFTLG1CQUFULENBQTZCLE1BQTdCLEVBQXFDLElBQXJDLEVBQTJDO0FBQ2hELFNBQU8sdUJBQXNCLE1BQXRCLENBQTZCLE1BQTdCLFVBQTJDLElBQTNDLE9BQVA7QUFDRDs7QUFHRDs7Ozs7O0FBTU8sU0FBUyxpQkFBVCxDQUEyQixNQUEzQixFQUFtQyxPQUFuQyxFQUE0QztBQUNqRCxTQUFPLG9CQUFtQixNQUFuQixDQUEwQixNQUExQixTQUF1QyxPQUF2QyxDQUFQO0FBQ0Q7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsa0JBQVQsQ0FBNEIsTUFBNUIsRUFBb0MsT0FBcEMsRUFBNkM7QUFDbEQsU0FBTyx1QkFBc0IsTUFBdEIsQ0FBNkIsTUFBN0IsU0FBMEMsT0FBMUMsQ0FBUDtBQUNEOztBQUdEOzs7Ozs7O0FBT08sU0FBUyxtQkFBVCxDQUE2QixJQUE3QixFQUFtQyxRQUFuQyxFQUE2QztBQUNsRCxNQUFJLDBCQUEwQixJQUE5QixFQUFvQztBQUNsQyw2QkFBeUIseUJBQXlCLElBQXpCLENBQXpCO0FBQ0Q7QUFDRCxNQUFJLHNCQUFKLEVBQTRCO0FBQzFCLFdBQU8sTUFBSyxNQUFNLGFBQVgsYUFBbUMsUUFBbkMsQ0FBUDtBQUNEOztBQUVEO0FBQ0EsTUFBTSxTQUFTLGtCQUFmO0FBQ0EsT0FBSyxTQUFMLENBQWUsR0FBZixDQUFtQixNQUFuQjtBQUNBLE1BQU0sVUFBVSxNQUFLLE1BQU0sYUFBWCxPQUE2QixNQUE3QixTQUF1QyxRQUF2QyxDQUFoQjtBQUNBLE9BQUssU0FBTCxDQUFlLE1BQWYsQ0FBc0IsTUFBdEI7QUFDQSxTQUFPLE9BQVA7QUFDRDs7QUFHRDs7Ozs7OztBQU9PLFNBQVMsc0JBQVQsQ0FBZ0MsSUFBaEMsRUFBc0MsUUFBdEMsRUFBZ0Q7QUFDckQsTUFBSSwwQkFBMEIsSUFBOUIsRUFBb0M7QUFDbEMsNkJBQXlCLHlCQUF5QixJQUF6QixDQUF6QjtBQUNEO0FBQ0QsTUFBSSxzQkFBSixFQUE0QjtBQUMxQixXQUFPLE1BQUssTUFBTSxnQkFBWCxhQUFzQyxRQUF0QyxDQUFQO0FBQ0Q7O0FBRUQ7QUFDQSxNQUFNLFNBQVMsa0JBQWY7QUFDQSxPQUFLLFNBQUwsQ0FBZSxHQUFmLENBQW1CLE1BQW5CO0FBQ0EsTUFBTSxXQUFXLE1BQUssTUFBTSxnQkFBWCxPQUFnQyxNQUFoQyxTQUEwQyxRQUExQyxDQUFqQjtBQUNBLE9BQUssU0FBTCxDQUFlLE1BQWYsQ0FBc0IsTUFBdEI7QUFDQSxTQUFPLFFBQVA7QUFDRDs7QUFHRDs7Ozs7Ozs7O0FBU08sU0FBUywyQkFBVCxDQUFxQyxPQUFyQyxFQUE4Qyx3QkFBOUMsRUFDTCxnQkFESyxFQUNhO0FBQ2xCLE1BQU0sdUJBQXVCLDRCQUE2QjtBQUFBLFdBQU8sR0FBUDtBQUFBLEdBQTFEO0FBRGtCLE1BRVgsT0FGVyxHQUVBLE9BRkEsQ0FFWCxPQUZXOztBQUdsQixNQUFNLFNBQVMsbUJBQWY7QUFDQSxNQUFNLGVBQWUsbUJBQW1CLGdCQUFuQixHQUFzQyxZQUEzRDtBQUNBLE9BQUssSUFBTSxHQUFYLElBQWtCLE9BQWxCLEVBQTJCO0FBQ3pCLFFBQU0sV0FBVSxJQUFJLEtBQUosQ0FBVSxZQUFWLENBQWhCO0FBQ0EsUUFBSSxRQUFKLEVBQWE7QUFDWCxVQUFNLFFBQVEsU0FBUSxDQUFSLEVBQVcsQ0FBWCxFQUFjLFdBQWQsS0FBOEIsU0FBUSxDQUFSLEVBQVcsTUFBWCxDQUFrQixDQUFsQixDQUE1QztBQUNBLGFBQU8scUJBQXFCLEtBQXJCLENBQVAsSUFBc0MsUUFBUSxHQUFSLENBQXRDO0FBQ0Q7QUFDRjtBQUNELFNBQU8sTUFBUDtBQUNEOztBQUVEOzs7Ozs7Ozs7QUFTTyxTQUFTLDBCQUFULENBQW9DLE9BQXBDLEVBQTZDLFlBQTdDLEVBQTJEO0FBQ2hFLE1BQUksaUJBQWlCLE9BQXJCO0FBQ0EsS0FBRztBQUNELFFBQUksZUFBZSxXQUFuQixFQUFnQztBQUM5QixhQUFPLElBQVA7QUFDRDtBQUNGLEdBSkQsUUFJUyxDQUFDLGlCQUFpQixlQUFlLFVBQWpDLEtBQ0Msa0JBQWtCLFlBTDVCO0FBTUEsU0FBTyxLQUFQO0FBQ0Q7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsZ0JBQVQsQ0FBMEIsS0FBMUIsRUFBaUMsU0FBakMsRUFBNEM7QUFDakQsTUFBTSxZQUFZLEVBQWxCO0FBQ0EsT0FBSyxJQUFJLFdBQVcsTUFBTSxhQUExQixFQUF5QyxRQUF6QyxFQUNFLFdBQVcsU0FBUyxhQUR0QixFQUNxQztBQUNuQyxRQUFJLFVBQVUsUUFBVixDQUFKLEVBQXlCO0FBQ3ZCLGdCQUFVLElBQVYsQ0FBZSxRQUFmO0FBQ0Q7QUFDRjtBQUNELFNBQU8sU0FBUDtBQUNEOztBQUdEOzs7Ozs7QUFNTyxTQUFTLHFCQUFULENBQStCLEtBQS9CLEVBQXNDLE9BQXRDLEVBQStDO0FBQ3BELFlBQVUsUUFBUSxXQUFSLEVBQVY7QUFDQSxTQUFPLGlCQUFpQixLQUFqQixFQUF3QixjQUFNO0FBQ25DLFdBQU8sR0FBRyxPQUFILElBQWMsT0FBckI7QUFDRCxHQUZNLENBQVA7QUFHRDs7QUFFRDs7Ozs7Ozs7O0FBU08sU0FBUyxvQkFBVCxDQUE4QixRQUE5QixFQUF3QztBQUM3QyxNQUFJLGFBQWEsUUFBakIsRUFBMkI7QUFDekIsV0FBTyxTQUFTLE9BQVQsQ0FBaUIsU0FBakIsQ0FBMkIsSUFBM0IsQ0FBUDtBQUNELEdBRkQsTUFFTztBQUNMLFFBQU0sVUFBVSxTQUFTLGFBQVQsQ0FBdUIsc0JBQXZCLEVBQWhCO0FBQ0EsaUJBQWEsUUFBYixFQUF1QixPQUF2QjtBQUNBLFdBQU8sT0FBUDtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7Ozs7QUFVTyxTQUFTLGFBQVQsQ0FBdUIsUUFBdkIsRUFBaUMsRUFBakMsRUFBcUM7QUFDMUMsT0FBSyxJQUFJLElBQUksQ0FBUixFQUFXLEtBQWhCLEVBQXVCLENBQUMsUUFBUSxTQUFTLENBQVQsQ0FBVCxNQUEwQixTQUFqRCxFQUE0RCxHQUE1RCxFQUFpRTtBQUMvRCxPQUFHLEtBQUgsRUFBVSxDQUFWO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7Ozs7Ozs7OztBQWFPLFNBQVMsZ0JBQVQsQ0FBMEIsR0FBMUIsRUFBK0IsR0FBL0IsRUFBb0MsTUFBcEMsRUFBNEMsWUFBNUMsRUFBMEQ7QUFDL0Q7QUFDQTtBQUNBO0FBQ0EsTUFBSSxZQUFKO0FBQ0EsTUFBSTtBQUNGLFVBQU0sSUFBSSxJQUFKLENBQVMsR0FBVCxFQUFjLE1BQWQsRUFBc0IsWUFBdEIsQ0FBTjtBQUNELEdBRkQsQ0FFRSxPQUFPLENBQVAsRUFBVTtBQUNWLG9CQUFNLEtBQU4sQ0FBWSxLQUFaLEVBQW1CLGdDQUFuQixFQUFxRCxNQUFyRCxFQUE2RCxDQUE3RDtBQUNEOztBQUVEO0FBQ0EsTUFBSSxDQUFDLEdBQUQsSUFBUSxVQUFVLE1BQXRCLEVBQThCO0FBQzVCLFVBQU0sSUFBSSxJQUFKLENBQVMsR0FBVCxFQUFjLE1BQWQsQ0FBTjtBQUNEO0FBQ0QsU0FBTyxHQUFQO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxlQUFULENBQXlCLE9BQXpCLEVBQWtDO0FBQ3ZDLFNBQU8sUUFBUSxPQUFSLElBQW1CLFFBQW5CLElBQ0csUUFBUSxZQUFSLENBQXFCLE1BQXJCLEVBQTZCLFdBQTdCLE1BQThDLGtCQUR4RDtBQUVEOztBQUVEOzs7OztBQUtPLFNBQVMsaUJBQVQsQ0FBMkIsT0FBM0IsRUFBb0M7QUFDekMsU0FBTyxRQUFRLE9BQVIsSUFBbUIsUUFBbkIsSUFDSCxRQUFRLFlBQVIsQ0FBcUIsTUFBckIsRUFBNkIsV0FBN0IsTUFBOEMscUJBRGxEO0FBRUQ7O0FBRUQ7Ozs7O0FBS08sU0FBUyxLQUFULENBQWUsR0FBZixFQUFvQjtBQUN6QixNQUFNLE1BQU0sSUFBSSxJQUFKLENBQVMsWUFBVCxDQUFzQixLQUF0QixLQUNNLElBQUksZUFBSixDQUFvQixZQUFwQixDQUFpQyxLQUFqQyxDQUROLElBRU0sS0FGbEI7QUFHQSxTQUFPLE9BQU8sS0FBZDtBQUNEOztBQUdEOzs7Ozs7OztBQVFPLFNBQVMsc0JBQVQsQ0FBZ0MsS0FBaEMsRUFBdUM7QUFDNUMsU0FBTywwQkFBVSxLQUFWLENBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7QUFRTyxTQUFTLG9CQUFULENBQThCLEtBQTlCLEVBQXFDO0FBQzFDLE1BQU0sVUFBVSxPQUFPLEtBQVAsQ0FBaEI7QUFDQTtBQUNBLGtCQUFNLE1BQU4sQ0FBYSxRQUFRLE9BQVIsQ0FBZ0IsR0FBaEIsTUFBeUIsQ0FBQyxDQUF2QztBQUNBLFNBQU8sT0FBUDtBQUNEOztBQUVEOzs7OztBQUtPLFNBQVMsVUFBVCxDQUFvQixJQUFwQixFQUEwQjtBQUMvQixNQUFJLENBQUMsSUFBTCxFQUFXO0FBQ1QsV0FBTyxJQUFQO0FBQ0Q7QUFDRCxTQUFPLEtBQUssT0FBTCxDQUFhLGlCQUFiLEVBQWdDLGNBQWhDLENBQVA7QUFDRDs7QUFFRDs7OztBQUlBLFNBQVMsY0FBVCxDQUF3QixDQUF4QixFQUEyQjtBQUN6QixTQUFPLGtCQUFrQixDQUFsQixDQUFQO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxRQUFULENBQWtCLE9BQWxCLEVBQTJCO0FBQ2hDLE1BQUk7QUFDRixhQUFRLE1BQU0sS0FBZDtBQUNELEdBRkQsQ0FFRSxPQUFPLENBQVAsRUFBVTtBQUNWO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7QUFLTyxTQUFTLFNBQVQsQ0FBbUIsR0FBbkIsRUFBd0I7QUFDN0IsU0FBTyxJQUFJLE1BQUosSUFBYyxJQUFJLE1BQUosSUFBYyxHQUFuQztBQUNEOztBQUVEOzs7OztBQUtPLFNBQVMsWUFBVCxDQUFzQixPQUF0QixFQUErQjtBQUNwQyxNQUFNLE1BQU0sUUFBUSxPQUFwQjtBQUNBO0FBQ0E7QUFDQSxTQUFPLHdCQUFXLEdBQVgsRUFBZ0IsTUFBaEI7QUFDSDtBQUNBLElBQUUsT0FBTywyQkFBUCxJQUFzQyxPQUFPLFVBQS9DLENBRko7QUFHRDs7QUFFRDs7Ozs7O0FBTU8sU0FBUywyQkFBVCxDQUFxQyxPQUFyQyxFQUE4QztBQUNuRCxrQkFBTSxNQUFOLENBQWEsYUFBYSxPQUFiLENBQWIsRUFBb0MsMkJBQXBDO0FBQ0EsTUFBSSxRQUFRLGVBQVosRUFBNkI7QUFDM0I7QUFDQSxXQUFPLFFBQVEsT0FBUixDQUFnQixPQUFoQixDQUFQO0FBQ0Q7QUFDRDtBQUNBO0FBQ0EsTUFBSSxDQUFDLFFBQVEsZ0NBQVIsQ0FBTCxFQUFnRDtBQUM5QyxRQUFNLFdBQVcsdUJBQWpCO0FBQ0EsWUFBUSxnQ0FBUixJQUE0QyxTQUFTLE9BQXJEO0FBQ0EsWUFBUSxpQ0FBUixJQUE2QyxTQUFTLE9BQXREO0FBRUQ7O0FBRUQsU0FBTyxRQUFRLGdDQUFSLENBQVA7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLGVBQVQsQ0FBeUIsT0FBekIsRUFBa0M7QUFDdkMsTUFBTSxZQUFZLFFBQVEsaUJBQVIsSUFDZCxRQUFRLGlCQURNLElBRWQsUUFBUSx1QkFGTSxJQUdkLFFBQVEsdUJBSE0sSUFJZCxRQUFRLHFCQUpNLElBS2QsUUFBUSxxQkFMTSxJQU1kLFFBQVEsbUJBTk0sSUFPZCxRQUFRLG1CQVBNLElBUWQsUUFBUSxvQkFSTSxJQVNkLFFBQVEsb0JBVFo7QUFVQSxNQUFJLFNBQUosRUFBZTtBQUNiLGNBQVUsSUFBVixDQUFlLE9BQWY7QUFDRDtBQUNGOztBQUVEOzs7OztBQUtPLFNBQVMsY0FBVCxDQUF3QixPQUF4QixFQUFpQztBQUN0QyxNQUFJLFNBQVMsUUFBUSxnQkFBUixJQUNHLFFBQVEsY0FEWCxJQUVHLFFBQVEsY0FGWCxJQUdHLFFBQVEsb0JBSFgsSUFJRyxRQUFRLG9CQUpYLElBS0csUUFBUSxzQkFMWCxJQU1HLFFBQVEsbUJBTlgsSUFPRyxRQUFRLGdCQVB4QjtBQVFBLE1BQUksTUFBSixFQUFZO0FBQ1YsV0FBTyxJQUFQLENBQVksT0FBWjtBQUNBO0FBQ0Q7QUFDRCxNQUFJLFFBQVEsYUFBWixFQUEyQjtBQUN6QixhQUFTLFFBQVEsYUFBUixDQUFzQixnQkFBdEIsSUFDRyxRQUFRLGFBQVIsQ0FBc0IsY0FEekIsSUFFRyxRQUFRLGFBQVIsQ0FBc0IsY0FGekIsSUFHRyxRQUFRLGFBQVIsQ0FBc0Isb0JBSHpCLElBSUcsUUFBUSxhQUFSLENBQXNCLG9CQUp6QixJQUtHLFFBQVEsYUFBUixDQUFzQixzQkFMekIsSUFNRyxRQUFRLGFBQVIsQ0FBc0IsbUJBTnpCLElBT0csUUFBUSxhQUFSLENBQXNCLGdCQVBsQztBQVFEO0FBQ0QsTUFBSSxNQUFKLEVBQVk7QUFDVixXQUFPLElBQVAsQ0FBWSxRQUFRLGFBQXBCO0FBQ0E7QUFDRDtBQUNGOztBQUdEOzs7Ozs7QUFNTyxTQUFTLG1CQUFULENBQTZCLE9BQTdCLEVBQXNDO0FBQzNDLE1BQU0sZUFBZSxRQUFRLDBCQUE3QjtBQUNBLE1BQUksWUFBSixFQUFrQjtBQUNoQixXQUFPLElBQVA7QUFDRDtBQUNELE1BQUksUUFBUSxhQUFaLEVBQTJCO0FBQ3pCLFFBQU0sb0JBQW9CLFFBQVEsYUFBUixDQUFzQixpQkFBdEIsSUFDZCxRQUFRLGFBQVIsQ0FBc0IsdUJBRFIsSUFFZCxRQUFRLGFBQVIsQ0FBc0Isb0JBRlIsSUFHZCxRQUFRLDhCQUhwQjtBQUlBLFFBQUkscUJBQXFCLE9BQXpCLEVBQWtDO0FBQ2hDLGFBQU8sSUFBUDtBQUNEO0FBQ0Y7QUFDRCxTQUFPLEtBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7QUFRTyxTQUFTLFNBQVQsQ0FBbUIsT0FBbkIsRUFBNEI7QUFDakMsU0FBTyxFQUFFLFFBQVEsUUFBUixJQUFvQixRQUFRLE9BQVIsRUFBaUIsV0FBakIsQ0FBdEIsQ0FBUDtBQUNEOzs7Ozs7UUN6MkJlLDRCLEdBQUEsNEI7UUFpREEsNEIsR0FBQSw0QjtRQXlCQSxxQyxHQUFBLHFDO0FBOUdoQjs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQTs7Ozs7QUFLQSxJQUFJLHNCQUFKOztBQUVBOzs7Ozs7Ozs7Ozs7O0FBYU8sU0FBUyw0QkFBVCxDQUFzQyxPQUF0QyxFQUErQyxTQUEvQyxFQUEwRCxRQUExRCxFQUNMLG1CQURLLEVBQ2dCO0FBQ3JCLE1BQUksZUFBZSxPQUFuQjtBQUNBLE1BQUksZ0JBQWdCLFFBQXBCO0FBQ0E7OztBQUdBLE1BQUksZ0JBQUo7O0FBRUEsWUFBVSx3QkFBUztBQUNqQixRQUFJO0FBQ0YsYUFBTyxjQUFjLEtBQWQsQ0FBUDtBQUNELEtBRkQsQ0FFRSxPQUFPLENBQVAsRUFBVTtBQUNWO0FBQ0EsV0FBSyxXQUFMLENBQWlCLENBQWpCO0FBQ0EsWUFBTSxDQUFOO0FBQ0Q7QUFDRixHQVJEO0FBU0EsTUFBTSxnQkFBZ0IsOEJBQXRCO0FBQ0EsTUFBSSxVQUFVLEtBQWQ7QUFDQSxNQUFJLG1CQUFKLEVBQXlCO0FBQ3ZCLGNBQVUsb0JBQW9CLE9BQTlCO0FBQ0Q7QUFDRCxlQUFhLGdCQUFiLENBQ0ksU0FESixFQUVJLE9BRkosRUFHSSxnQkFBZ0IsbUJBQWhCLEdBQXNDLE9BSDFDO0FBS0EsU0FBTyxZQUFNO0FBQ1gsUUFBSSxZQUFKLEVBQWtCO0FBQ2hCLG1CQUFhLG1CQUFiLENBQ0ksU0FESixFQUVJLE9BRkosRUFHSSxnQkFBZ0IsbUJBQWhCLEdBQXNDLE9BSDFDO0FBS0Q7QUFDRDtBQUNBLG9CQUFnQixJQUFoQjtBQUNBLG1CQUFlLElBQWY7QUFDQSxjQUFVLElBQVY7QUFDRCxHQVpEO0FBYUQ7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsNEJBQVQsR0FBd0M7QUFDN0M7QUFDQSxNQUFJLGtCQUFrQixTQUF0QixFQUFpQztBQUMvQixXQUFPLGFBQVA7QUFDRDs7QUFFRCxrQkFBZ0IsS0FBaEI7QUFDQSxNQUFJO0FBQ0Y7QUFDQSxRQUFNLFVBQVU7QUFDZCxVQUFJLE9BQUosR0FBYztBQUNaLHdCQUFnQixJQUFoQjtBQUNEO0FBSGEsS0FBaEI7QUFLQSxTQUFLLGdCQUFMLENBQXNCLGNBQXRCLEVBQXNDLElBQXRDLEVBQTRDLE9BQTVDO0FBQ0EsU0FBSyxtQkFBTCxDQUF5QixjQUF6QixFQUF5QyxJQUF6QyxFQUErQyxPQUEvQztBQUNELEdBVEQsQ0FTRSxPQUFPLEdBQVAsRUFBWTtBQUNaO0FBQ0Q7QUFDRCxTQUFPLGFBQVA7QUFDRDs7QUFFRDs7O0FBR08sU0FBUyxxQ0FBVCxHQUFpRDtBQUN0RCxrQkFBZ0IsU0FBaEI7QUFDRDs7Ozs7O1FDbEZlLGlCLEdBQUEsaUI7UUF3QkEsTSxHQUFBLE07UUFVQSxPLEdBQUEsTztRQVNBLFMsR0FBQSxTO1FBYUEsVSxHQUFBLFU7UUEwQkEsaUIsR0FBQSxpQjtRQW1CQSxRLEdBQUEsUTtRQWdCQSxXLEdBQUEsVztRQXNEQSxrQixHQUFBLGtCOztBQXpMaEI7O0FBQ0E7O0FBRUE7QUFuQkE7Ozs7Ozs7Ozs7Ozs7Ozs7QUFvQkEsSUFBTSxzQkFBc0IsaUJBQTVCOztBQUVBOzs7Ozs7OztBQVFPLFNBQVMsaUJBQVQsQ0FBMkIsR0FBM0IsRUFBZ0MsSUFBaEMsRUFBc0MsTUFBdEMsRUFBOEMsYUFBOUMsRUFBNkQ7QUFDbEUsTUFBTSxZQUFZLCtCQUFpQyxFQUFDLGNBQUQsRUFBbkQ7QUFDQSxTQUFPLE1BQVAsQ0FBYyxTQUFkLEVBQXlCLGFBQXpCO0FBQ0E7QUFDQTtBQUNBLE1BQUksT0FBTyxJQUFJLFdBQVgsSUFBMEIsVUFBOUIsRUFBMEM7QUFDeEMsV0FBTyxJQUFJLElBQUksV0FBUixDQUFvQixJQUFwQixFQUEwQixTQUExQixDQUFQO0FBQ0QsR0FGRCxNQUVPO0FBQ0w7QUFDQSxRQUFNLElBQUksSUFBSSxRQUFKLENBQWEsV0FBYixDQUF5QixhQUF6QixDQUFWO0FBQ0EsTUFBRSxlQUFGLENBQ0ksSUFESixFQUNVLENBQUMsQ0FBQyxVQUFVLE9BRHRCLEVBQytCLENBQUMsQ0FBQyxVQUFVLFVBRDNDLEVBQ3VELE1BRHZEO0FBRUEsV0FBTyxDQUFQO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7Ozs7QUFRTyxTQUFTLE1BQVQsQ0FBZ0IsT0FBaEIsRUFBeUIsU0FBekIsRUFBb0MsUUFBcEMsRUFBOEMsbUJBQTlDLEVBQW1FO0FBQ3hFLFNBQU8scURBQ0gsT0FERyxFQUNNLFNBRE4sRUFDaUIsUUFEakIsRUFDMkIsbUJBRDNCLENBQVA7QUFFRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLE9BQVQsQ0FBaUIsS0FBakIsRUFBd0I7QUFDN0IsU0FBTyw0Q0FBNkMsTUFBTTtBQUExRDtBQUNEOztBQUVEOzs7OztBQUtPLFNBQVMsU0FBVCxDQUFtQixLQUFuQixFQUEwQjtBQUMvQixTQUFPLDRDQUE2QyxNQUFNO0FBQTFEO0FBQ0Q7O0FBRUQ7Ozs7Ozs7OztBQVNPLFNBQVMsVUFBVCxDQUFvQixPQUFwQixFQUE2QixTQUE3QixFQUF3QyxRQUF4QyxFQUFrRCxtQkFBbEQsRUFBdUU7QUFDNUUsTUFBSSxnQkFBZ0IsUUFBcEI7QUFDQSxNQUFNLFdBQVcscURBQTZCLE9BQTdCLEVBQXNDLFNBQXRDLEVBQWlELGlCQUFTO0FBQ3pFLFFBQUk7QUFDRixvQkFBYyxLQUFkO0FBQ0QsS0FGRCxTQUVVO0FBQ1I7QUFDQSxzQkFBZ0IsSUFBaEI7QUFDQTtBQUNEO0FBQ0YsR0FSZ0IsRUFRZCxtQkFSYyxDQUFqQjtBQVNBLFNBQU8sUUFBUDtBQUNEOztBQUdEOzs7Ozs7Ozs7OztBQVdPLFNBQVMsaUJBQVQsQ0FBMkIsT0FBM0IsRUFBb0MsU0FBcEMsRUFBK0MsbUJBQS9DLEVBQ0wsVUFESyxFQUNPO0FBQ1osTUFBSSxpQkFBSjtBQUNBLE1BQU0sZUFBZSxJQUFJLE9BQUosQ0FBWSxtQkFBVztBQUMxQyxlQUFXLFdBQVcsT0FBWCxFQUFvQixTQUFwQixFQUErQixPQUEvQixFQUF3QyxtQkFBeEMsQ0FBWDtBQUNELEdBRm9CLENBQXJCO0FBR0EsZUFBYSxJQUFiLENBQWtCLFFBQWxCLEVBQTRCLFFBQTVCO0FBQ0EsTUFBSSxVQUFKLEVBQWdCO0FBQ2QsZUFBVyxRQUFYO0FBQ0Q7QUFDRCxTQUFPLFlBQVA7QUFDRDs7QUFHRDs7Ozs7QUFLTyxTQUFTLFFBQVQsQ0FBa0IsV0FBbEIsRUFBK0I7QUFDcEMsU0FBTyxDQUFDLEVBQUUsWUFBWSxRQUFaLElBQXdCLFlBQVksVUFBWixJQUEwQjtBQUN4RDtBQUNBO0FBRk0sS0FHRixZQUFZLFFBQVosSUFDRyxZQUFZLFFBQVosQ0FBcUIsVUFBckIsSUFBbUMsVUFKdEMsQ0FBUjtBQUtEOztBQUVEOzs7Ozs7OztBQVFPLFNBQVMsV0FBVCxDQUFxQixXQUFyQixFQUFrQztBQUN2QyxNQUFJLHFCQUFKO0FBQ0EsTUFBSSxzQkFBSjtBQUNBLE1BQUksU0FBUyxXQUFULENBQUosRUFBMkI7QUFDekIsV0FBTyxRQUFRLE9BQVIsQ0FBZ0IsV0FBaEIsQ0FBUDtBQUNEO0FBQ0QsTUFBTSxpQkFBaUIsSUFBSSxPQUFKLENBQVksVUFBQyxPQUFELEVBQVUsTUFBVixFQUFxQjtBQUN0RDtBQUNBO0FBRnNELFFBRy9DLE9BSCtDLEdBR3BDLFdBSG9DLENBRy9DLE9BSCtDOztBQUl0RCxRQUFJLFlBQVksT0FBWixJQUF1QixZQUFZLE9BQXZDLEVBQWdEO0FBQzlDLHFCQUFlLFdBQVcsV0FBWCxFQUF3QixXQUF4QixFQUFxQyxPQUFyQyxDQUFmO0FBQ0QsS0FGRCxNQUVPO0FBQ0wscUJBQWUsV0FBVyxXQUFYLEVBQXdCLE1BQXhCLEVBQWdDLE9BQWhDLENBQWY7QUFDRDtBQUNEO0FBQ0EsUUFBSSxPQUFKLEVBQWE7QUFDWCxzQkFBZ0IsV0FBVyxXQUFYLEVBQXdCLE9BQXhCLEVBQWlDLE1BQWpDLENBQWhCO0FBQ0Q7QUFDRixHQWJzQixDQUF2Qjs7QUFlQSxTQUFPLGVBQWUsSUFBZixDQUFvQixZQUFNO0FBQy9CLFFBQUksYUFBSixFQUFtQjtBQUNqQjtBQUNEO0FBQ0QsV0FBTyxXQUFQO0FBQ0QsR0FMTSxFQUtKLFlBQU07QUFDUCxRQUFJLFlBQUosRUFBa0I7QUFDaEI7QUFDRDtBQUNELGlCQUFhLFdBQWI7QUFDRCxHQVZNLENBQVA7QUFXRDs7QUFFRDs7Ozs7QUFLQSxTQUFTLFlBQVQsQ0FBc0IsV0FBdEIsRUFBbUM7QUFDakM7QUFDQTtBQUNBLE1BQUksU0FBUyxXQUFiO0FBQ0EsTUFBSSxVQUFVLE9BQU8sR0FBckIsRUFBMEI7QUFDeEIsYUFBUyxPQUFPLEdBQWhCO0FBQ0Q7QUFDRCxRQUFNLGlCQUFPLFdBQVAsQ0FBbUIsbUJBQW5CLEVBQXdDLE1BQXhDLENBQU47QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLGtCQUFULENBQTRCLE9BQTVCLEVBQXFDO0FBQzFDLFNBQU8sUUFBUSxPQUFSLENBQWdCLG1CQUFoQixLQUF3QyxDQUFDLENBQWhEO0FBQ0Q7Ozs7Ozs7OFFDM01EOzs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JBOzs7OztRQTJDZ0Isc0IsR0FBQSxzQjtRQXNCQSxlLEdBQUEsZTtRQStCQSxTLEdBQUEsUztRQWFBLFksR0FBQSxZO1FBb0JBLGUsR0FBQSxlOztBQTVIaEI7O0FBR0E7QUFDQTs7QUFFQTs7OztBQUlBLElBQUksc0JBQUo7O0FBR0E7Ozs7QUFJQSxJQUFJLHNCQUFKOztBQUdBOzs7O0FBSUEsSUFBSSxxQkFBSjs7QUFHQTs7OztBQUlBLElBQUkscUJBQUo7O0FBRUE7Ozs7O0FBS08sU0FBUyxzQkFBVCxDQUFnQyxHQUFoQyxFQUFxQztBQUMxQyxNQUFNLE9BQU8sT0FBTyxNQUFQLENBQWMsSUFBZCxDQUFiO0FBQ0EsT0FBSyxJQUFNLENBQVgsSUFBZ0IsR0FBaEIsRUFBcUI7QUFDbkIsUUFBSSxDQUFDLGVBQWUsR0FBZixFQUFvQixDQUFwQixDQUFMLEVBQTZCO0FBQzNCO0FBQ0Q7QUFDRCxRQUFNLElBQUksSUFBSSxDQUFKLENBQVY7QUFDQSxTQUFLLENBQUwsSUFBVSxxQkFBUyxDQUFULElBQWMsdUJBQXVCLENBQXZCLENBQWQsR0FBMEMsQ0FBcEQ7QUFDRDtBQUNELFNBQU8sMkJBQTRCO0FBQW5DO0FBQ0Q7O0FBRUQ7Ozs7Ozs7Ozs7QUFVTyxTQUFTLGVBQVQsQ0FBeUIsR0FBekIsRUFBOEIsSUFBOUIsRUFBb0M7QUFDekM7QUFDQSxNQUFJLFFBQVEsR0FBWixFQUFpQjtBQUNmLFdBQU8sR0FBUDtBQUNEO0FBQ0Q7QUFDQSxNQUFNLFFBQVEsS0FBSyxLQUFMLENBQVcsR0FBWCxDQUFkO0FBQ0EsTUFBSSxRQUFRLEdBQVo7QUFDQSxPQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksTUFBTSxNQUExQixFQUFrQyxHQUFsQyxFQUF1QztBQUNyQyxRQUFNLE9BQU8sTUFBTSxDQUFOLENBQWI7QUFDQSxRQUFJLFFBQ0EsS0FEQSxJQUVBLE1BQU0sSUFBTixNQUFnQixTQUZoQixJQUdBLGVBQWUsS0FBZixFQUFzQixJQUF0QixDQUhKLEVBSUU7QUFDQSxjQUFRLE1BQU0sSUFBTixDQUFSO0FBQ0E7QUFDRDtBQUNELFlBQVEsU0FBUjtBQUNBO0FBQ0Q7QUFDRCxTQUFPLEtBQVA7QUFDRDs7QUFFRDs7Ozs7OztBQU9PLFNBQVMsU0FBVCxDQUFtQixJQUFuQixFQUF5QjtBQUM5QixTQUFPLDJCQUEyQixLQUFLLEtBQUwsRUFBVyxxQkFBdUIsSUFBbEM7QUFBbEM7QUFDRDs7QUFFRDs7Ozs7Ozs7O0FBU08sU0FBUyxZQUFULENBQXNCLElBQXRCLEVBQTRCLFlBQTVCLEVBQTBDO0FBQy9DLE1BQUk7QUFDRixXQUFPLFVBQVUsSUFBVixDQUFQO0FBQ0QsR0FGRCxDQUVFLE9BQU8sQ0FBUCxFQUFVO0FBQ1YsUUFBSSxZQUFKLEVBQWtCO0FBQ2hCLG1CQUFhLENBQWI7QUFDRDtBQUNELFdBQU8sU0FBUDtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7OztBQVNPLFNBQVMsZUFBVCxDQUF5QixDQUF6QixFQUE0QixDQUE1QixFQUEwQztBQUFBLE1BQVgsS0FBVyx1RUFBSCxDQUFHOztBQUMvQyxNQUFJLENBQUMsU0FBUyxLQUFULENBQUwsRUFBc0I7QUFDcEIsVUFBTSxJQUFJLEtBQUosQ0FBVSwrQkFBK0IsS0FBekMsQ0FBTjtBQUNEO0FBQ0QsTUFBSSxNQUFNLENBQVYsRUFBYTtBQUNYLFdBQU8sSUFBUDtBQUNEO0FBQ0Q7QUFDQSxNQUFJLFFBQVEsQ0FBWixFQUFlO0FBQ2IsV0FBTyxLQUFQO0FBQ0Q7QUFDRCxNQUFJLFFBQU8sQ0FBUCx5Q0FBTyxDQUFQLGVBQW9CLENBQXBCLHlDQUFvQixDQUFwQixFQUFKLEVBQTJCO0FBQ3pCLFdBQU8sS0FBUDtBQUNEO0FBQ0QsTUFBSSxNQUFNLE9BQU4sQ0FBYyxDQUFkLEtBQW9CLE1BQU0sT0FBTixDQUFjLENBQWQsQ0FBeEIsRUFBMEM7QUFDeEMsUUFBSSxFQUFFLE1BQUYsS0FBYSxFQUFFLE1BQW5CLEVBQTJCO0FBQ3pCLGFBQU8sS0FBUDtBQUNEO0FBQ0QsU0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLEVBQUUsTUFBdEIsRUFBOEIsR0FBOUIsRUFBbUM7QUFDakMsVUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUYsQ0FBaEIsRUFBc0IsRUFBRSxDQUFGLENBQXRCLEVBQTRCLFFBQVEsQ0FBcEMsQ0FBTCxFQUE2QztBQUMzQyxlQUFPLEtBQVA7QUFDRDtBQUNGO0FBQ0QsV0FBTyxJQUFQO0FBQ0Q7QUFDRCxNQUFJLEtBQUssQ0FBTCxJQUFVLFFBQU8sQ0FBUCx5Q0FBTyxDQUFQLE9BQWEsUUFBdkIsSUFBbUMsUUFBTyxDQUFQLHlDQUFPLENBQVAsT0FBYSxRQUFwRCxFQUE4RDtBQUM1RCxRQUFNLFFBQVEsT0FBTyxJQUFQLEVBQVksc0JBQXdCLENBQXBDLENBQWQ7QUFDQSxRQUFNLFFBQVEsT0FBTyxJQUFQLEVBQVksc0JBQXdCLENBQXBDLENBQWQ7QUFDQSxRQUFJLE1BQU0sTUFBTixLQUFpQixNQUFNLE1BQTNCLEVBQW1DO0FBQ2pDLGFBQU8sS0FBUDtBQUNEO0FBQ0QsU0FBSyxJQUFJLEtBQUksQ0FBYixFQUFnQixLQUFJLE1BQU0sTUFBMUIsRUFBa0MsSUFBbEMsRUFBdUM7QUFDckMsVUFBTSxPQUFPLE1BQU0sRUFBTixDQUFiO0FBQ0EsVUFBTSxTQUFTLEVBQUUsSUFBRixDQUFmO0FBQ0EsVUFBTSxTQUFTLEVBQUUsSUFBRixDQUFmO0FBQ0EsVUFBSSxDQUFDLGdCQUFnQixNQUFoQixFQUF3QixNQUF4QixFQUFnQyxRQUFRLENBQXhDLENBQUwsRUFBaUQ7QUFDL0MsZUFBTyxLQUFQO0FBQ0Q7QUFDRjtBQUNELFdBQU8sSUFBUDtBQUNEO0FBQ0QsU0FBTyxLQUFQO0FBQ0Q7O0FBR0Q7Ozs7O0FBS0EsU0FBUyxjQUFULENBQXdCLEdBQXhCLEVBQTZCLEdBQTdCLEVBQWtDO0FBQ2hDLE1BQUksT0FBTyxJQUFQLElBQWUsUUFBTyxHQUFQLHlDQUFPLEdBQVAsTUFBYyxRQUFqQyxFQUEyQztBQUN6QyxXQUFPLEtBQVA7QUFDRDtBQUNELFNBQU8sT0FBTyxTQUFQLENBQWlCLGNBQWpCLENBQWdDLElBQWhDO0FBQ0gsd0JBQXdCLEdBRHJCLEVBQzJCLEdBRDNCLENBQVA7QUFFRDs7Ozs7Ozs7OztRQzlFZSxXLEdBQUEsVztRQWNBLGMsR0FBQSxjO1FBVUEsbUIsR0FBQSxtQjtRQWdCQSxpQixHQUFBLGlCO1FBWUEsVyxHQUFBLFc7UUF1QkEsWSxHQUFBLFk7UUFnQkEscUIsR0FBQSxxQjtRQVlBLGMsR0FBQSxjO1FBY0EsZ0IsR0FBQSxnQjtRQVlBLG9CLEdBQUEsb0I7UUFjQSxvQixHQUFBLG9CO1FBK0JBLGdCLEdBQUEsZ0I7UUF5QkEsaUIsR0FBQSxpQjs7QUE3U2hCOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztrSkF6QkE7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7Ozs7O0FBV0E7OztBQUdPLElBQU0sMEJBQVM7QUFDcEIsYUFBVyxXQURTO0FBRXBCLFNBQU8sT0FGYTtBQUdwQixnQkFBYyxjQUhNO0FBSXBCLGNBQVksWUFKUTtBQUtwQixhQUFXLFdBTFM7QUFNcEIsUUFBTSxNQU5jO0FBT3BCLGFBQVcsV0FQUztBQVFwQixTQUFPLE9BUmE7QUFTcEIsYUFBVztBQVRTLENBQWY7O0FBYVA7Ozs7O0FBS08sSUFBTSwwQ0FBaUI7QUFDNUIsV0FBUyxDQURtQjtBQUU1QixZQUFVLENBRmtCO0FBRzVCLE9BQUssQ0FIdUI7QUFJNUIsY0FBWTtBQUpnQixDQUF2Qjs7QUFRUDs7OztBQUlPLElBQUksc0NBQUo7O0FBR1A7Ozs7OztBQU1BLElBQUksc0JBQUo7O0FBR0E7Ozs7Ozs7Ozs7QUFVTyxJQUFNLGtEQUFxQjtBQUNoQyxlQUFhLEVBQUMsT0FBTyxLQUFSLEVBQWUsUUFBUSxLQUF2QixFQURtQjtBQUVoQyxtQkFBaUIsRUFBQyxPQUFPLEtBQVIsRUFBZSxRQUFRLEtBQXZCLEVBRmU7QUFHaEM7QUFDQSxlQUFhLElBSm1CO0FBS2hDLHNCQUFvQixFQUFDLE9BQU8sTUFBUixFQUFnQixRQUFRLE1BQXhCO0FBTFksQ0FBM0I7O0FBU1A7Ozs7OztBQU1PLElBQU0sZ0RBQW9CO0FBQy9CLGNBQVksSUFEbUI7QUFFL0Isb0JBQWtCLElBRmE7QUFHL0IsK0JBQTZCLElBSEU7QUFJL0IsZUFBYSxJQUprQjtBQUsvQixrQkFBZ0IsSUFMZTtBQU0vQiwyQkFBeUIsSUFOTTtBQU8vQix1QkFBcUIsSUFQVTtBQVEvQix1QkFBcUIsSUFSVTtBQVMvQixnQkFBYyxJQVRpQjtBQVUvQixhQUFXLElBVm9CO0FBVy9CLG1CQUFpQixJQVhjO0FBWS9CLGNBQVksSUFabUI7QUFhL0IsdUJBQXFCLElBYlU7QUFjL0IsbUJBQWlCLElBZGM7QUFlL0Isa0JBQWdCLElBZmU7QUFnQi9CLGVBQWEsSUFoQmtCO0FBaUIvQixpQkFBZTtBQWpCZ0IsQ0FBMUI7O0FBcUJQOzs7OztBQUtPLFNBQVMsV0FBVCxDQUFxQixDQUFyQixFQUF3QjtBQUM3QixPQUFLLElBQU0sQ0FBWCxJQUFnQixNQUFoQixFQUF3QjtBQUN0QixRQUFJLE9BQU8sQ0FBUCxLQUFhLENBQWpCLEVBQW9CO0FBQ2xCLGFBQU8sT0FBTyxDQUFQLENBQVA7QUFDRDtBQUNGO0FBQ0QsU0FBTyxTQUFQO0FBQ0Q7O0FBR0Q7Ozs7QUFJTyxTQUFTLGNBQVQsQ0FBd0IsTUFBeEIsRUFBZ0M7QUFDckMsU0FBTyxzQkFBc0IsTUFBN0I7QUFDRDs7QUFHRDs7Ozs7QUFLTyxTQUFTLG1CQUFULENBQTZCLE1BQTdCLEVBQXFDO0FBQzFDLFNBQVEsVUFBVSxPQUFPLEtBQWpCLElBQ0osVUFBVSxPQUFPLFlBRGIsSUFFSixVQUFVLE9BQU8sVUFGYixJQUdKLFVBQVUsT0FBTyxJQUhiLElBSUosVUFBVSxPQUFPLFNBSmIsSUFLSixVQUFVLE9BQU8sS0FMYixJQU1KLFVBQVUsT0FBTyxTQU5yQjtBQU9EOztBQUdEOzs7OztBQUtPLFNBQVMsaUJBQVQsQ0FBMkIsR0FBM0IsRUFBZ0M7QUFDckMsTUFBTSxVQUFXLE9BQU8sR0FBUCxJQUFjLFFBQWYsR0FBMkIsR0FBM0IsR0FBaUMsSUFBSSxPQUFyRDtBQUNBLFNBQU8sV0FBVyx3QkFBVyxRQUFRLFdBQVIsRUFBWCxFQUFrQyxJQUFsQyxDQUFsQjtBQUNEOztBQUdEOzs7Ozs7QUFNTyxTQUFTLFdBQVQsQ0FBcUIsQ0FBckIsRUFBd0I7QUFDN0IsTUFBSSxPQUFPLENBQVAsSUFBWSxRQUFoQixFQUEwQjtBQUN4QixXQUFPLElBQUksSUFBWDtBQUNEO0FBQ0QsTUFBSSxDQUFDLENBQUwsRUFBUTtBQUNOLFdBQU8sU0FBUDtBQUNEO0FBQ0QsTUFBSSxDQUFDLDZEQUE2RCxJQUE3RCxDQUFrRSxDQUFsRSxDQUFMLEVBQTJFO0FBQ3pFLFdBQU8sU0FBUDtBQUNEO0FBQ0QsTUFBSSxnQkFBZ0IsSUFBaEIsQ0FBcUIsQ0FBckIsQ0FBSixFQUE2QjtBQUMzQixXQUFPLElBQUksSUFBWDtBQUNEO0FBQ0QsU0FBTyxDQUFQO0FBQ0Q7O0FBSUQ7Ozs7O0FBS08sU0FBUyxZQUFULENBQXNCLE1BQXRCLEVBQThCO0FBQ25DLG1CQUFPLE1BQVAsQ0FDSSw0REFBNEQsSUFBNUQsQ0FBaUUsTUFBakUsQ0FESixFQUVJLDBCQUZKLEVBRWdDLE1BRmhDO0FBR0EsU0FBTywwQkFBMkI7QUFBbEM7QUFDRDs7QUFLRDs7Ozs7O0FBTU8sU0FBUyxxQkFBVCxDQUErQixNQUEvQixFQUF1QztBQUM1QyxtQkFBTyxNQUFQLENBQWMsNkNBQTZDLElBQTdDLENBQWtELE1BQWxELENBQWQsRUFDSSxxQ0FESixFQUMyQyxNQUQzQztBQUVBLFNBQU8sTUFBUDtBQUNEOztBQUdEOzs7OztBQUtPLFNBQVMsY0FBVCxDQUF3QixNQUF4QixFQUFnQztBQUNyQyxlQUFhLE1BQWI7QUFDQSxrQkFBTSxZQUFOLENBQW1CLE1BQW5CO0FBQ0EsTUFBTSxJQUFJLGlCQUFPLE1BQVAsQ0FBYyxPQUFPLEtBQVAsQ0FBYSxTQUFiLENBQWQsRUFDTiw4QkFETSxFQUMwQixNQUQxQixDQUFWO0FBRUEsU0FBTyxFQUFFLENBQUYsQ0FBUDtBQUNEOztBQUdEOzs7OztBQUtPLFNBQVMsZ0JBQVQsQ0FBMEIsTUFBMUIsRUFBa0M7QUFDdkMsTUFBTSxNQUFNLFdBQVcsTUFBWCxDQUFaO0FBQ0EsU0FBTywyQkFBZSxHQUFmLElBQXNCLEdBQXRCLEdBQTRCLFNBQW5DO0FBQ0Q7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsb0JBQVQsQ0FBOEIsT0FBOUIsRUFBdUM7QUFDNUMsWUFBVSxRQUFRLFdBQVIsRUFBVjtBQUNBLFNBQU8sbUJBQW1CLE9BQW5CLE1BQWdDLFNBQXZDO0FBQ0Q7O0FBR0Q7Ozs7Ozs7O0FBUU8sU0FBUyxvQkFBVCxDQUE4QixPQUE5QixFQUF1QztBQUM1QyxNQUFNLFVBQVUsUUFBUSxPQUFSLENBQWdCLFdBQWhCLEVBQWhCO0FBQ0Esa0JBQU0sTUFBTixDQUFhLG1CQUFtQixPQUFuQixNQUFnQyxTQUE3QztBQUNBLE1BQUksQ0FBQyxtQkFBbUIsT0FBbkIsQ0FBTCxFQUFrQztBQUNoQyxRQUFNLE1BQU0sUUFBUSxhQUFwQjtBQUNBLFFBQU0saUJBQWlCLFFBQVEsT0FBUixDQUFnQixRQUFoQixFQUEwQixFQUExQixDQUF2QjtBQUNBLFFBQU0sT0FBTyxJQUFJLGFBQUosQ0FBa0IsY0FBbEIsQ0FBYjtBQUNBO0FBQ0EsU0FBSyxRQUFMLEdBQWdCLElBQWhCO0FBQ0EsMEJBQVUsSUFBVixFQUFnQjtBQUNkLGdCQUFVLFVBREk7QUFFZCxrQkFBWTtBQUZFLEtBQWhCO0FBSUEsUUFBSSxJQUFKLENBQVMsV0FBVCxDQUFxQixJQUFyQjtBQUNBLHVCQUFtQixPQUFuQixJQUE4QjtBQUM1QixhQUFPLENBQUMsTUFBSyxNQUFNLFdBQVgsSUFBMEIsQ0FBM0IsSUFBZ0MsSUFEWDtBQUU1QixjQUFRLENBQUMsTUFBSyxNQUFNLFlBQVgsSUFBMkIsQ0FBNUIsSUFBaUM7QUFGYixLQUE5QjtBQUlBLFFBQUksSUFBSixDQUFTLFdBQVQsQ0FBcUIsSUFBckI7QUFDRDtBQUNELFNBQU8sNkJBQThCLG1CQUFtQixPQUFuQjtBQUFyQztBQUNEOztBQUdEOzs7Ozs7O0FBT08sU0FBUyxnQkFBVCxDQUEwQixPQUExQixFQUFtQztBQUN4QyxNQUFNLFVBQVUsUUFBUSxPQUFSLENBQWdCLFdBQWhCLEVBQWhCO0FBQ0EsTUFBSSxXQUFXLFFBQVgsSUFBdUIsV0FBVyxXQUF0QyxFQUFtRDtBQUNqRCxXQUFPLElBQVA7QUFDRDtBQUNELFNBQU8sa0JBQWtCLE9BQWxCLEtBQThCLEtBQXJDO0FBQ0Q7O0FBR0Q7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQk8sU0FBUyxpQkFBVCxDQUEyQixPQUEzQixFQUFvQztBQUN6QztBQUNBO0FBQ0E7QUFDQSxNQUFNLHNCQUFzQixRQUFRLFlBQVIsQ0FBcUIsa0JBQXJCLENBQTVCO0FBQ0EsTUFBSSxtQkFBSixFQUF5QjtBQUN2QixRQUFNLFVBQVMsc0JBQXdCLGdCQUFNLE1BQU4sQ0FDbkMsWUFBWSxtQkFBWixDQURtQyxDQUF2QztBQUVBLFFBQUksQ0FBQyxXQUFVLE9BQU8sVUFBakIsSUFBK0IsV0FBVSxPQUFPLFNBQWpELEtBQ0MsUUFBUSxpQkFEYixFQUNnQztBQUM5QjtBQUNBLGNBQVEsWUFBUixHQUNJLFFBQVEsYUFBUixDQUFzQixpQkFBdEIsS0FBNEMsU0FEaEQ7QUFFRCxLQUxELE1BS08sSUFBSSxXQUFVLE9BQU8sU0FBckIsRUFBZ0M7QUFDckMsMkJBQXFCLE9BQXJCO0FBQ0Q7QUFDRCxXQUFPLE9BQVA7QUFDRDs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxNQUFNLGFBQWEsUUFBUSxZQUFSLENBQXFCLFFBQXJCLENBQW5CO0FBQ0EsTUFBTSxZQUFZLFFBQVEsWUFBUixDQUFxQixPQUFyQixDQUFsQjtBQUNBLE1BQU0sYUFBYSxRQUFRLFlBQVIsQ0FBcUIsUUFBckIsQ0FBbkI7QUFDQSxNQUFNLFlBQVksUUFBUSxZQUFSLENBQXFCLE9BQXJCLENBQWxCO0FBQ0EsTUFBTSxjQUFjLFFBQVEsWUFBUixDQUFxQixTQUFyQixDQUFwQjs7QUFFQTtBQUNBLE1BQU0sY0FBYyxhQUFhLFlBQVksVUFBWixDQUFiLEdBQXVDLElBQTNEO0FBQ0EsbUJBQU8sTUFBUCxDQUFjLGdCQUFnQixTQUE5QixFQUF5QyxvQkFBekMsRUFBK0QsVUFBL0Q7QUFDQTtBQUNBLE1BQU0sYUFBYyxhQUFhLGFBQWEsTUFBM0IsR0FDakIsWUFBWSxTQUFaLENBRGlCLEdBQ1EsU0FEM0I7QUFFQSxtQkFBTyxNQUFQLENBQWMsZUFBZSxTQUE3QixFQUF3Qyx5QkFBeEMsRUFBbUUsU0FBbkU7QUFDQTtBQUNBLE1BQU0sY0FBZSxjQUFjLGNBQWMsT0FBN0IsR0FDbEIsWUFBWSxVQUFaLENBRGtCLEdBQ1EsVUFENUI7QUFFQSxtQkFBTyxNQUFQLENBQWMsZ0JBQWdCLFNBQTlCLEVBQXlDLDBCQUF6QyxFQUNJLFVBREo7O0FBR0E7QUFDQSxNQUFJLGNBQUo7QUFDQSxNQUFJLGVBQUo7QUFDQSxNQUFJLGVBQUo7O0FBRUE7QUFDQSxNQUFJLENBQUMsQ0FBQyxXQUFELElBQWdCLGVBQWUsT0FBTyxLQUF0QyxJQUNELGVBQWUsT0FBTyxZQUR0QixNQUVDLENBQUMsVUFBRCxJQUFlLENBQUMsV0FGakIsS0FFaUMscUJBQXFCLFFBQVEsT0FBN0IsQ0FGckMsRUFFNEU7QUFDMUU7QUFDQTtBQUNBLFFBQU0sYUFBYSxxQkFBcUIsT0FBckIsQ0FBbkI7QUFDQSxZQUFTLGNBQWMsZUFBZSxPQUFPLFlBQXJDLEdBQXFELFVBQXJELEdBQ04sV0FBVyxLQURiO0FBRUEsYUFBUyxlQUFlLFdBQVcsTUFBbkM7QUFDRCxHQVRELE1BU087QUFDTCxZQUFRLFVBQVI7QUFDQSxhQUFTLFdBQVQ7QUFDRDs7QUFFRDtBQUNBLE1BQUksV0FBSixFQUFpQjtBQUNmLGFBQVMsV0FBVDtBQUNELEdBRkQsTUFFTyxJQUFJLENBQUMsS0FBRCxJQUFVLENBQUMsTUFBZixFQUF1QjtBQUM1QixhQUFTLE9BQU8sU0FBaEI7QUFDRCxHQUZNLE1BRUEsSUFBSSxVQUFVLE9BQWQsRUFBdUI7QUFDNUIsYUFBUyxPQUFPLEtBQWhCO0FBQ0QsR0FGTSxNQUVBLElBQUksV0FBVyxDQUFDLEtBQUQsSUFBVSxTQUFTLE1BQTlCLENBQUosRUFBMkM7QUFDaEQsYUFBUyxPQUFPLFlBQWhCO0FBQ0QsR0FGTSxNQUVBLElBQUksVUFBVSxLQUFWLEtBQW9CLGFBQWEsV0FBakMsQ0FBSixFQUFtRDtBQUN4RCxhQUFTLE9BQU8sVUFBaEI7QUFDRCxHQUZNLE1BRUE7QUFDTCxhQUFTLE9BQU8sS0FBaEI7QUFDRDs7QUFFRDtBQUNBLE1BQUksVUFBVSxPQUFPLEtBQWpCLElBQTBCLFVBQVUsT0FBTyxZQUEzQyxJQUNBLFVBQVUsT0FBTyxVQURqQixJQUMrQixVQUFVLE9BQU8sU0FEcEQsRUFDK0Q7QUFDN0QscUJBQU8sTUFBUCxDQUFjLE1BQWQsRUFBc0IscUNBQXRCLEVBQTZELFVBQTdEO0FBQ0Q7QUFDRCxNQUFJLFVBQVUsT0FBTyxZQUFyQixFQUFtQztBQUNqQyxxQkFBTyxNQUFQLENBQWMsQ0FBQyxLQUFELElBQVUsU0FBUyxNQUFqQyxFQUNJLHdEQUNBLDZCQUZKLEVBRW1DLFNBRm5DO0FBR0Q7QUFDRCxNQUFJLFVBQVUsT0FBTyxLQUFqQixJQUEwQixVQUFVLE9BQU8sVUFBM0MsSUFDQSxVQUFVLE9BQU8sU0FEckIsRUFDZ0M7QUFDOUIscUJBQU8sTUFBUCxDQUFjLFNBQVMsU0FBUyxNQUFoQyxFQUNJLDREQURKLEVBRUksU0FGSjtBQUdEOztBQUVELE1BQUksVUFBVSxPQUFPLFVBQWpCLElBQStCLFVBQVUsT0FBTyxTQUFwRCxFQUErRDtBQUM3RCxxQkFBTyxNQUFQLENBQWMsZUFBZSxLQUFmLEtBQXlCLGVBQWUsTUFBZixDQUF2QyxFQUNJLDhEQURKLEVBRUksU0FGSixFQUVlLFVBRmY7QUFHRCxHQUpELE1BSU87QUFDTCxxQkFBTyxNQUFQLENBQWMsZ0JBQWdCLElBQTlCLEVBQ0ksMkRBREo7QUFFRDs7QUFFRDtBQUNBLFVBQVEsU0FBUixDQUFrQixHQUFsQixDQUFzQixlQUFlLE1BQWYsQ0FBdEI7QUFDQSxNQUFJLG9CQUFvQixNQUFwQixDQUFKLEVBQWlDO0FBQy9CLFlBQVEsU0FBUixDQUFrQixHQUFsQixDQUFzQiwrQkFBdEI7QUFDRDtBQUNELE1BQUksVUFBVSxPQUFPLFNBQXJCLEVBQWdDO0FBQzlCO0FBQ0E7QUFDQSx5QkFBcUIsT0FBckI7QUFDRCxHQUpELE1BSU8sSUFBSSxVQUFVLE9BQU8sS0FBckIsRUFBNEI7QUFDakMsMEJBQVUsT0FBVixFQUFtQjtBQUNqQixhQUFPLGdCQUFNLFlBQU4sQ0FBbUIsS0FBbkIsQ0FEVTtBQUVqQixjQUFRLGdCQUFNLFlBQU4sQ0FBbUIsTUFBbkI7QUFGUyxLQUFuQjtBQUlELEdBTE0sTUFLQSxJQUFJLFVBQVUsT0FBTyxZQUFyQixFQUFtQztBQUN4Qyx5QkFBUyxPQUFULEVBQWtCLFFBQWxCLEVBQTRCLGdCQUFNLFlBQU4sQ0FBbUIsTUFBbkIsQ0FBNUI7QUFDRCxHQUZNLE1BRUEsSUFBSSxVQUFVLE9BQU8sVUFBckIsRUFBaUM7QUFDdEMsUUFBTSxRQUFRLFFBQVEsYUFBUixDQUFzQixhQUF0QixDQUFvQyxpQkFBcEMsQ0FBZDtBQUNBLDBCQUFVLEtBQVYsRUFBaUI7QUFDZixlQUFTLE9BRE07QUFFZixrQkFDSSxpQkFBaUIsTUFBakIsSUFBMkIsaUJBQWlCLEtBQWpCLENBQTVCLEdBQXVELEdBQXhELEdBQStEO0FBSGxELEtBQWpCO0FBS0EsWUFBUSxZQUFSLENBQXFCLEtBQXJCLEVBQTRCLFFBQVEsVUFBcEM7QUFDQSxZQUFRLFlBQVIsR0FBdUIsS0FBdkI7QUFDRCxHQVRNLE1BU0EsSUFBSSxVQUFVLE9BQU8sU0FBckIsRUFBZ0M7QUFDckM7QUFDQTtBQUNBO0FBQ0EsUUFBTSxTQUFRLDZCQUFRLE9BQVIsQ0FBUixpQkFBTjtBQUlBLFFBQU0saUJBQWlCLE9BQU0saUJBQTdCO0FBQ0EsbUJBQWUsWUFBZixDQUE0QixLQUE1QixxREFDcUQsTUFEckQsaUJBQ3VFLEtBRHZFO0FBRUEsWUFBUSxZQUFSLENBQXFCLE1BQXJCLEVBQTRCLFFBQVEsVUFBcEM7QUFDQTtBQUNBLFlBQVEsWUFBUixHQUF1QixjQUF2QjtBQUNELEdBZE0sTUFjQSxJQUFJLFVBQVUsT0FBTyxJQUFyQixFQUEyQjtBQUNoQztBQUNELEdBRk0sTUFFQSxJQUFJLFVBQVUsT0FBTyxTQUFyQixFQUFnQztBQUNyQztBQUNBO0FBQ0E7QUFDRCxHQUpNLE1BSUEsSUFBSSxVQUFVLE9BQU8sU0FBckIsRUFBZ0M7QUFDckM7QUFDQTtBQUNBLFFBQUksS0FBSixFQUFXO0FBQ1QsMkJBQVMsT0FBVCxFQUFrQixPQUFsQixFQUEyQixLQUEzQjtBQUNEO0FBQ0QsUUFBSSxNQUFKLEVBQVk7QUFDViwyQkFBUyxPQUFULEVBQWtCLFFBQWxCLEVBQTRCLE1BQTVCO0FBQ0Q7QUFDRixHQVRNLE1BU0EsSUFBSSxVQUFVLE9BQU8sS0FBckIsRUFBNEI7QUFDakMsWUFBUSxTQUFSLENBQWtCLEdBQWxCLENBQXNCLGdDQUF0QjtBQUNBLFFBQUksS0FBSixFQUFXO0FBQ1QsMkJBQVMsT0FBVCxFQUFrQixPQUFsQixFQUEyQixLQUEzQjtBQUNEO0FBQ0QseUJBQVMsT0FBVCxFQUFrQixRQUFsQixFQUE0QixDQUE1QjtBQUNEO0FBQ0QsU0FBTyxNQUFQO0FBQ0Q7O0FBR0Q7OztBQUdBLFNBQVMsb0JBQVQsQ0FBOEIsT0FBOUIsRUFBdUM7QUFDckM7QUFDQTtBQUNBO0FBQ0EsdUJBQVMsT0FBVCxFQUFrQixTQUFsQixFQUE2QixNQUE3QjtBQUNBLFVBQVEsU0FBUixDQUFrQixHQUFsQixDQUFzQixtQkFBdEI7QUFDRDs7Ozs7Ozs7cWpCQ3BmRDs7Ozs7Ozs7Ozs7Ozs7OztRQTRDZ0Isa0IsR0FBQSxrQjtRQVFBLGdCLEdBQUEsZ0I7UUFzQkEsYyxHQUFBLGM7UUFhQSxnQixHQUFBLGdCO1FBK1lBLHlCLEdBQUEseUI7UUF5QkEsZ0IsR0FBQSxnQjtRQTZCQSxZLEdBQUEsWTtRQWtDQSxrQixHQUFBLGtCO1FBaUJBLDZCLEdBQUEsNkI7UUFnQkEsSSxHQUFBLEk7UUE0Q0EsRyxHQUFBLEc7UUF3QkEsVyxHQUFBLFc7O0FBbnBCaEI7O0FBQ0E7O0FBQ0E7Ozs7QUFFQTs7Ozs7Ozs7O0FBU08sSUFBTSxvREFBc0Isb0JBQTVCOztBQUdQOzs7OztBQUtPLElBQU0sZ0VBQTRCLDBCQUFsQzs7QUFHUDs7OztBQUlPLFNBQVMsa0JBQVQsQ0FBNEIsT0FBNUIsRUFBcUM7QUFDMUMsU0FBTyxRQUFRLE9BQVIsQ0FBZ0IsbUJBQWhCLEtBQXdDLENBQS9DO0FBQ0Q7O0FBRUQ7Ozs7QUFJTyxTQUFTLGdCQUFULENBQTBCLE9BQTFCLEVBQW1DO0FBQ3hDLFNBQU8sUUFBUSxPQUFSLENBQWdCLHlCQUFoQixLQUE4QyxDQUFyRDtBQUNEOztBQUdEOzs7O0FBSU8sSUFBTSw4QkFBVztBQUN0QixPQUFLLENBRGlCO0FBRXRCLFNBQU8sQ0FGZTtBQUd0QixRQUFNLENBSGdCO0FBSXRCLFFBQU0sQ0FKZ0I7QUFLdEIsUUFBTTtBQUxnQixDQUFqQjs7QUFRUDs7Ozs7QUFLTyxTQUFTLGNBQVQsQ0FBd0IsRUFBeEIsRUFBNEI7QUFDakMsT0FBSyxXQUFMLEdBQW1CLEVBQW5CO0FBQ0Q7O0FBRUQ7Ozs7QUFJQSxJQUFJLGlCQUFpQixTQUFyQjs7QUFFQTs7O0FBR08sU0FBUyxnQkFBVCxDQUEwQixLQUExQixFQUFpQztBQUN0QyxtQkFBaUIsS0FBakI7QUFDRDs7QUFFRDs7Ozs7Ozs7Ozs7SUFVYSxHLFdBQUEsRztBQUNYOzs7Ozs7Ozs7OztBQVdBLGVBQVksR0FBWixFQUFpQixTQUFqQixFQUE0QixVQUE1QixFQUF3QztBQUFBOztBQUN0Qzs7Ozs7QUFLQSxTQUFLLEdBQUwsR0FBWSxxQkFBVSxJQUFWLElBQWtCLElBQUksZUFBdkIsR0FBMEMsSUFBSSxNQUE5QyxHQUF1RCxHQUFsRTs7QUFFQTtBQUNBLFNBQUssVUFBTCxHQUFrQixTQUFsQjs7QUFFQTtBQUNBLFNBQUssTUFBTCxHQUFjLEtBQUssYUFBTCxFQUFkOztBQUVBO0FBQ0EsU0FBSyxPQUFMLEdBQWUsY0FBYyxFQUE3QjtBQUNEOztBQUVEOzs7Ozs7OztnQ0FJWTtBQUNWLGFBQVEsbUJBQW1CLFNBQXBCLEdBQWlDLGNBQWpDLEdBQWtELEtBQUssTUFBOUQ7QUFDRDs7QUFFRDs7Ozs7OztvQ0FJZ0I7QUFDZDtBQUNBLFVBQUksQ0FBQyxLQUFLLEdBQUwsQ0FBUyxPQUFWLElBQXFCLENBQUMsS0FBSyxHQUFMLENBQVMsT0FBVCxDQUFpQixHQUEzQyxFQUFnRDtBQUM5QyxlQUFPLFNBQVMsR0FBaEI7QUFDRDs7QUFFRDtBQUNBLFVBQUkscUJBQVUsR0FBVixJQUFpQixHQUFyQixFQUEwQjtBQUN4QixlQUFPLFNBQVMsR0FBaEI7QUFDRDs7QUFFRDtBQUNBLFVBQUkscUJBQVUsSUFBVixJQUFrQixLQUFLLEdBQUwsQ0FBUyxVQUEvQixFQUEyQztBQUN6QyxlQUFPLFNBQVMsSUFBaEI7QUFDRDs7QUFFRDtBQUNBLFVBQUkscUJBQVUsUUFBVixJQUFzQixDQUFDLHFCQUFVLEdBQXJDLEVBQTBDO0FBQ3hDLGVBQU8sU0FBUyxJQUFoQjtBQUNEOztBQUVEO0FBQ0EsYUFBTyxLQUFLLFVBQUwsQ0FBZ0IsZ0NBQWhCLENBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7eUJBS0ssRyxFQUFLLEssRUFBTyxRLEVBQVU7QUFDekIsVUFBSSxLQUFLLFNBQUwsTUFBb0IsU0FBUyxHQUFqQyxFQUFzQztBQUNwQyxZQUFJLEtBQUssS0FBSyxHQUFMLENBQVMsT0FBVCxDQUFpQixHQUExQjtBQUNBLFlBQUksU0FBUyxPQUFiLEVBQXNCO0FBQ3BCLGVBQUssS0FBSyxHQUFMLENBQVMsT0FBVCxDQUFpQixLQUFqQixJQUEwQixFQUEvQjtBQUNELFNBRkQsTUFFTyxJQUFJLFNBQVMsTUFBYixFQUFxQjtBQUMxQixlQUFLLEtBQUssR0FBTCxDQUFTLE9BQVQsQ0FBaUIsSUFBakIsSUFBeUIsRUFBOUI7QUFDRCxTQUZNLE1BRUEsSUFBSSxTQUFTLE1BQWIsRUFBcUI7QUFDMUIsZUFBSyxLQUFLLEdBQUwsQ0FBUyxPQUFULENBQWlCLElBQWpCLElBQXlCLEVBQTlCO0FBQ0Q7QUFDRCxZQUFJLHFCQUFVLFFBQWQsRUFBd0I7QUFDdEIsbUJBQVMsT0FBVCxDQUFpQixNQUFNLEdBQU4sR0FBWSxHQUE3QjtBQUNEO0FBQ0QsV0FBRyxLQUFILENBQVMsS0FBSyxHQUFMLENBQVMsT0FBbEIsRUFBMkIsUUFBM0I7QUFDRDtBQUNGOztBQUVEOzs7Ozs7O2dDQUlZO0FBQ1YsYUFBTyxLQUFLLFNBQUwsTUFBb0IsU0FBUyxHQUFwQztBQUNEOztBQUVEOzs7Ozs7Ozt5QkFLSyxHLEVBQUssUSxFQUFVO0FBQ2xCLFVBQUksS0FBSyxTQUFMLE1BQW9CLFNBQVMsSUFBakMsRUFBdUM7QUFDckMsYUFBSyxJQUFMLENBQVUsR0FBVixFQUFlLE1BQWYsRUFBdUIsTUFBTSxTQUFOLENBQWdCLEtBQWhCLENBQXNCLElBQXRCLENBQTJCLFNBQTNCLEVBQXNDLENBQXRDLENBQXZCO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7Ozs7eUJBS0ssRyxFQUFLLFEsRUFBVTtBQUNsQixVQUFJLEtBQUssU0FBTCxNQUFvQixTQUFTLElBQWpDLEVBQXVDO0FBQ3JDLGFBQUssSUFBTCxDQUFVLEdBQVYsRUFBZSxNQUFmLEVBQXVCLE1BQU0sU0FBTixDQUFnQixLQUFoQixDQUFzQixJQUF0QixDQUEyQixTQUEzQixFQUFzQyxDQUF0QyxDQUF2QjtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7O3lCQUtLLEcsRUFBSyxRLEVBQVU7QUFDbEIsVUFBSSxLQUFLLFNBQUwsTUFBb0IsU0FBUyxJQUFqQyxFQUF1QztBQUNyQyxhQUFLLElBQUwsQ0FBVSxHQUFWLEVBQWUsTUFBZixFQUF1QixNQUFNLFNBQU4sQ0FBZ0IsS0FBaEIsQ0FBc0IsSUFBdEIsQ0FBMkIsU0FBM0IsRUFBc0MsQ0FBdEMsQ0FBdkI7QUFDRDtBQUNGOztBQUVEOzs7Ozs7Ozs7OzsyQkFRTyxHLEVBQUssUSxFQUFVO0FBQ3BCLFVBQUksS0FBSyxTQUFMLE1BQW9CLFNBQVMsS0FBakMsRUFBd0M7QUFDdEMsYUFBSyxJQUFMLENBQVUsR0FBVixFQUFlLE9BQWYsRUFBd0IsTUFBTSxTQUFOLENBQWdCLEtBQWhCLENBQXNCLElBQXRCLENBQTJCLFNBQTNCLEVBQXNDLENBQXRDLENBQXhCO0FBQ0QsT0FGRCxNQUVPO0FBQ0wsWUFBTSxRQUFRLGlCQUFpQixLQUFqQixDQUF1QixJQUF2QixFQUNWLE1BQU0sU0FBTixDQUFnQixLQUFoQixDQUFzQixJQUF0QixDQUEyQixTQUEzQixFQUFzQyxDQUF0QyxDQURVLENBQWQ7QUFFQSxhQUFLLGFBQUwsQ0FBbUIsS0FBbkI7QUFDQSxlQUFPLEtBQVA7QUFDRDtBQUNGOztBQUVEOzs7Ozs7OzswQkFLTSxHLEVBQUssUSxFQUFVO0FBQ25CLFVBQU0sUUFBUSxLQUFLLE1BQUwsQ0FBWSxLQUFaLENBQWtCLElBQWxCLEVBQXdCLFNBQXhCLENBQWQ7QUFDQSxVQUFJLEtBQUosRUFBVztBQUNULGNBQU0sSUFBTixHQUFhLE9BQU8sTUFBTSxJQUExQjtBQUNBO0FBQ0EsYUFBSyxXQUFMLENBQWlCLEtBQWpCO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7Ozs7O2tDQU1jLFMsRUFBVyxRLEVBQVU7QUFDakMsVUFBTSxRQUFRLEtBQUssTUFBTCxDQUFZLEtBQVosQ0FBa0IsSUFBbEIsRUFBd0IsU0FBeEIsQ0FBZDtBQUNBLFVBQUksS0FBSixFQUFXO0FBQ1QsY0FBTSxRQUFOLEdBQWlCLElBQWpCO0FBQ0E7QUFDQSxhQUFLLFdBQUwsQ0FBaUIsS0FBakI7QUFDRDtBQUNGOztBQUVEOzs7Ozs7OztnQ0FLWSxRLEVBQVU7QUFDcEIsVUFBTSxRQUFRLGlCQUFpQixLQUFqQixDQUF1QixJQUF2QixFQUE2QixTQUE3QixDQUFkO0FBQ0EsV0FBSyxhQUFMLENBQW1CLEtBQW5CO0FBQ0EsYUFBTyxLQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O3dDQUtvQixRLEVBQVU7QUFDNUIsVUFBTSxRQUFRLGlCQUFpQixLQUFqQixDQUF1QixJQUF2QixFQUE2QixTQUE3QixDQUFkO0FBQ0EsV0FBSyxhQUFMLENBQW1CLEtBQW5CO0FBQ0EsWUFBTSxRQUFOLEdBQWlCLElBQWpCO0FBQ0EsYUFBTyxLQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzJCQW9CTyxlLEVBQWlCLFcsRUFBYSxRLEVBQVU7QUFDN0MsVUFBSSxxQkFBSjtBQUNBLFVBQUksQ0FBQyxlQUFMLEVBQXNCO0FBQ3BCLFlBQU0sVUFBVSxlQUFlLGtCQUEvQjtBQUNBLFlBQU0sZUFBZSxRQUFRLEtBQVIsQ0FBYyxJQUFkLENBQXJCO0FBQ0EsWUFBTSxRQUFRLGFBQWEsS0FBYixFQUFkO0FBQ0EsWUFBSSxZQUFZLEtBQWhCO0FBQ0EsWUFBTSxlQUFlLEVBQXJCO0FBQ0EsdUJBQWUsWUFBZixFQUE2QixLQUE3QjtBQUNBLGFBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxVQUFVLE1BQTlCLEVBQXNDLEdBQXRDLEVBQTJDO0FBQ3pDLGNBQU0sTUFBTSxVQUFVLENBQVYsQ0FBWjtBQUNBLGNBQUksT0FBTyxJQUFJLE9BQWYsRUFBd0I7QUFDdEIsMkJBQWUsR0FBZjtBQUNEO0FBQ0QsY0FBTSxlQUFlLGFBQWEsS0FBYixFQUFyQjtBQUNBLHVCQUFhLElBQWIsQ0FBa0IsR0FBbEI7QUFDQSx5QkFBZSxZQUFmLEVBQTZCLGFBQWEsSUFBYixFQUE3QjtBQUNBLHVCQUFhLFNBQVMsR0FBVCxJQUFnQixZQUE3QjtBQUNEO0FBQ0QsWUFBTSxJQUFJLElBQUksS0FBSixDQUFVLFNBQVYsQ0FBVjtBQUNBLFVBQUUsVUFBRixHQUFlLElBQWY7QUFDQSxVQUFFLGlCQUFGLEdBQXNCLFlBQXRCO0FBQ0EsVUFBRSxZQUFGLEdBQWlCLFlBQWpCO0FBQ0EsYUFBSyxhQUFMLENBQW1CLENBQW5CO0FBQ0E7QUFDQSxhQUFLLFdBQUwsQ0FBaUIsQ0FBakI7QUFDQSxjQUFNLENBQU47QUFDRDtBQUNELGFBQU8sZUFBUDtBQUNEOztBQUVEOzs7Ozs7Ozs7Ozs7OztrQ0FXYyxlLEVBQWlCLFcsRUFBYTtBQUMxQyxVQUFNLGtCQUFrQixtQkFBbUIsZ0JBQWdCLFFBQWhCLElBQTRCLENBQXZFO0FBQ0EsV0FBSyxNQUFMLENBQVksZUFBWixFQUE2QixDQUFDLGVBQWUsa0JBQWhCLElBQXNDLE1BQW5FLEVBQ0ksZUFESjtBQUVBLGFBQU8sd0JBQXlCO0FBQWhDO0FBQ0Q7O0FBRUQ7Ozs7Ozs7Ozs7Ozs7O2lDQVdhLGMsRUFBZ0IsVyxFQUFhO0FBQ3hDLFdBQUssTUFBTCxDQUFZLE9BQU8sY0FBUCxJQUF5QixRQUFyQyxFQUNJLENBQUMsZUFBZSxpQkFBaEIsSUFBcUMsTUFEekMsRUFDaUQsY0FEakQ7QUFFQSxhQUFPLHNCQUF1QjtBQUE5QjtBQUNEOztBQUVEOzs7Ozs7Ozs7Ozs7OztpQ0FXYSxjLEVBQWdCLFcsRUFBYTtBQUN4QyxXQUFLLE1BQUwsQ0FBWSxPQUFPLGNBQVAsSUFBeUIsUUFBckMsRUFDSSxDQUFDLGVBQWUsaUJBQWhCLElBQXFDLE1BRHpDLEVBQ2lELGNBRGpEO0FBRUEsYUFBTyxzQkFBdUI7QUFBOUI7QUFDRDs7QUFFRDs7Ozs7Ozs7Ozs7O2tDQVNjLGUsRUFBaUIsVyxFQUFhO0FBQzFDLFdBQUssTUFBTCxDQUFZLENBQUMsQ0FBQyxlQUFGLEtBQXNCLGVBQWxDLEVBQ0ksQ0FBQyxlQUFlLGtCQUFoQixJQUFzQyxNQUQxQyxFQUNrRCxlQURsRDtBQUVBLGFBQU8sdUJBQXdCO0FBQS9CO0FBQ0Q7O0FBRUQ7Ozs7Ozs7Ozs7Ozs7O29DQVdnQixPLEVBQVMsQyxFQUFHLFksRUFBYztBQUN4QyxVQUFJLHdCQUFZLE9BQVosRUFBcUIsQ0FBckIsQ0FBSixFQUE2QjtBQUMzQixlQUFPLENBQVA7QUFDRDtBQUNELFdBQUssTUFBTCxDQUFZLEtBQVosRUFDSSx3QkFESixFQUVJLGdCQUFnQixNQUZwQixFQUU0QixDQUY1QjtBQUdEOztBQUVEOzs7Ozs7O2tDQUljLEssRUFBTztBQUNuQixjQUFRLDBCQUEwQixLQUExQixDQUFSO0FBQ0EsVUFBSSxLQUFLLE9BQVQsRUFBa0I7QUFDaEIsWUFBSSxDQUFDLE1BQU0sT0FBWCxFQUFvQjtBQUNsQixnQkFBTSxPQUFOLEdBQWdCLEtBQUssT0FBckI7QUFDRCxTQUZELE1BRU8sSUFBSSxNQUFNLE9BQU4sQ0FBYyxPQUFkLENBQXNCLEtBQUssT0FBM0IsS0FBdUMsQ0FBQyxDQUE1QyxFQUErQztBQUNwRCxnQkFBTSxPQUFOLElBQWlCLEtBQUssT0FBdEI7QUFDRDtBQUNGLE9BTkQsTUFNTyxJQUFJLG1CQUFtQixNQUFNLE9BQXpCLENBQUosRUFBdUM7QUFDNUMsY0FBTSxPQUFOLEdBQWdCLE1BQU0sT0FBTixDQUFjLE9BQWQsQ0FBc0IsbUJBQXRCLEVBQTJDLEVBQTNDLENBQWhCO0FBQ0Q7QUFDRjs7Ozs7O0FBR0g7Ozs7OztBQUlBLFNBQVMsUUFBVCxDQUFrQixHQUFsQixFQUF1QjtBQUNyQjtBQUNBLE1BQUksT0FBTyxJQUFJLFFBQUosSUFBZ0IsQ0FBM0IsRUFBOEI7QUFDNUIsV0FBTyxJQUFJLE9BQUosQ0FBWSxXQUFaLE1BQTZCLElBQUksRUFBSixHQUFTLE1BQU0sSUFBSSxFQUFuQixHQUF3QixFQUFyRCxDQUFQO0FBQ0Q7QUFDRCxTQUFPLHNCQUF1QjtBQUE5QjtBQUNEOztBQUdEOzs7O0FBSUEsU0FBUyxjQUFULENBQXdCLEtBQXhCLEVBQStCLEdBQS9CLEVBQW9DO0FBQ2xDLE1BQUksT0FBTyxFQUFYLEVBQWU7QUFDYixVQUFNLElBQU4sQ0FBVyxHQUFYO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7QUFLTyxTQUFTLHlCQUFULENBQW1DLEtBQW5DLEVBQTBDO0FBQUEsTUFDeEMsT0FEd0MsR0FDN0IsS0FENkIsQ0FDeEMsT0FEd0M7O0FBRS9DLE1BQU0sT0FBTyxPQUFPLEtBQUssTUFBTCxFQUFQLENBQWI7QUFDQSxRQUFNLE9BQU4sR0FBZ0IsSUFBaEI7O0FBRUEsTUFBSSxNQUFNLE9BQU4sS0FBa0IsSUFBdEIsRUFBNEI7QUFDMUIsVUFBTSxPQUFOLEdBQWdCLE9BQWhCO0FBQ0EsV0FBTyxLQUFQO0FBQ0Q7O0FBRUQsTUFBTSxJQUFJLElBQUksS0FBSixDQUFVLE1BQU0sT0FBaEIsQ0FBVjtBQUNBO0FBQ0EsT0FBSyxJQUFNLElBQVgsSUFBbUIsS0FBbkIsRUFBMEI7QUFDeEIsTUFBRSxJQUFGLElBQVUsTUFBTSxJQUFOLENBQVY7QUFDRDtBQUNEO0FBQ0EsSUFBRSxLQUFGLEdBQVUsTUFBTSxLQUFoQjtBQUNBLFNBQU8sQ0FBUDtBQUNEOztBQUVEOzs7OztBQUtPLFNBQVMsZ0JBQVQsQ0FBMEIsUUFBMUIsRUFBb0M7QUFDekMsTUFBSSxRQUFRLElBQVo7QUFDQSxNQUFJLFVBQVUsRUFBZDtBQUNBLE9BQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxVQUFVLE1BQTlCLEVBQXNDLEdBQXRDLEVBQTJDO0FBQ3pDLFFBQU0sTUFBTSxVQUFVLENBQVYsQ0FBWjtBQUNBLFFBQUksZUFBZSxLQUFmLElBQXdCLENBQUMsS0FBN0IsRUFBb0M7QUFDbEMsY0FBUSwwQkFBMEIsR0FBMUIsQ0FBUjtBQUNELEtBRkQsTUFFTztBQUNMLFVBQUksT0FBSixFQUFhO0FBQ1gsbUJBQVcsR0FBWDtBQUNEO0FBQ0QsaUJBQVcsR0FBWDtBQUNEO0FBQ0Y7O0FBRUQsTUFBSSxDQUFDLEtBQUwsRUFBWTtBQUNWLFlBQVEsSUFBSSxLQUFKLENBQVUsT0FBVixDQUFSO0FBQ0QsR0FGRCxNQUVPLElBQUksT0FBSixFQUFhO0FBQ2xCLFVBQU0sT0FBTixHQUFnQixVQUFVLElBQVYsR0FBaUIsTUFBTSxPQUF2QztBQUNEO0FBQ0QsU0FBTyxLQUFQO0FBQ0Q7O0FBR0Q7Ozs7O0FBS08sU0FBUyxZQUFULENBQXNCLFFBQXRCLEVBQWdDO0FBQ3JDLE1BQU0sUUFBUSxpQkFBaUIsS0FBakIsQ0FBdUIsSUFBdkIsRUFBNkIsU0FBN0IsQ0FBZDtBQUNBLGFBQVcsWUFBTTtBQUNmO0FBQ0EsU0FBSyxXQUFMLENBQWlCLEtBQWpCO0FBQ0EsVUFBTSxLQUFOO0FBQ0QsR0FKRDtBQUtEOztBQUdEOzs7OztBQUtBLEtBQUssR0FBTCxHQUFZLEtBQUssR0FBTCxJQUFZO0FBQ3RCLFFBQU0sSUFEZ0I7QUFFdEIsT0FBSyxJQUZpQjtBQUd0QixnQkFBYztBQUhRLENBQXhCOztBQU1BLElBQU0sT0FBTyxLQUFLLEdBQWxCOztBQUVBOzs7Ozs7QUFNQSxJQUFJLGlCQUFpQixJQUFyQjs7QUFFQTs7O0FBR08sU0FBUyxrQkFBVCxHQUE4QjtBQUNuQyxtQkFBaUIsR0FBakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNEOztBQUVEOzs7QUFHTyxTQUFTLDZCQUFULEdBQXlDO0FBQzlDLG1CQUFpQixJQUFqQjtBQUNEOztBQUVEOzs7Ozs7Ozs7Ozs7QUFZTyxTQUFTLElBQVQsQ0FBYyxXQUFkLEVBQTJCO0FBQ2hDLE1BQUksQ0FBQyxLQUFLLElBQVYsRUFBZ0I7QUFDZCxTQUFLLElBQUwsR0FBWSxjQUFjLG1CQUFkLENBQVo7QUFDRDtBQUNELE1BQUksQ0FBQyxZQUFZLEtBQUssSUFBTCxDQUFVLEdBQXRCLEVBQTJCLFdBQTNCLENBQUwsRUFBOEM7QUFDNUMsV0FBTyxLQUFLLElBQVo7QUFDRCxHQUZELE1BRU87QUFDTCxRQUFJLEtBQUssWUFBVCxFQUF1QjtBQUNyQixhQUFPLEtBQUssWUFBWjtBQUNEO0FBQ0QsV0FBTyxLQUFLLFlBQUwsR0FBb0IsY0FBYyx5QkFBZCxDQUEzQjtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7O0FBS0EsU0FBUyxhQUFULENBQXVCLE1BQXZCLEVBQStCO0FBQzdCLE1BQUksQ0FBQyxjQUFMLEVBQXFCO0FBQ25CLFVBQU0sSUFBSSxLQUFKLENBQVUsbUNBQVYsQ0FBTjtBQUNEO0FBQ0QsU0FBTyxJQUFJLGNBQUosQ0FBbUIsSUFBbkIsRUFBeUIsZ0JBQVE7QUFDdEMsUUFBTSxTQUFTLFNBQVMsS0FBSyxHQUFkLEVBQW1CLEVBQW5CLENBQWY7QUFDQSxRQUFJLEtBQUssV0FBTCxJQUFvQixVQUFVLENBQWxDLEVBQXFDO0FBQ25DLGFBQU8sU0FBUyxJQUFoQjtBQUNEO0FBQ0QsV0FBTyxTQUFTLElBQWhCO0FBQ0QsR0FOTSxFQU1KLE1BTkksQ0FBUDtBQU9EOztBQUVEOzs7Ozs7Ozs7Ozs7QUFZTyxTQUFTLEdBQVQsR0FBZTtBQUNwQixNQUFJLEtBQUssR0FBVCxFQUFjO0FBQ1osV0FBTyxLQUFLLEdBQVo7QUFDRDtBQUNELE1BQUksQ0FBQyxjQUFMLEVBQXFCO0FBQ25CLFVBQU0sSUFBSSxLQUFKLENBQVUsbUNBQVYsQ0FBTjtBQUNEO0FBQ0QsU0FBTyxLQUFLLEdBQUwsR0FBVyxJQUFJLGNBQUosQ0FBbUIsSUFBbkIsRUFBeUIsZ0JBQVE7QUFDakQsUUFBTSxTQUFTLFNBQVMsS0FBSyxHQUFkLEVBQW1CLEVBQW5CLENBQWY7QUFDQSxRQUFJLFVBQVUsQ0FBZCxFQUFpQjtBQUNmLGFBQU8sU0FBUyxJQUFoQjtBQUNEO0FBQ0QsUUFBSSxVQUFVLENBQWQsRUFBaUI7QUFDZixhQUFPLFNBQVMsSUFBaEI7QUFDRDtBQUNELFdBQU8sU0FBUyxHQUFoQjtBQUNELEdBVGlCLENBQWxCO0FBVUQ7O0FBRUQ7Ozs7O0FBS08sU0FBUyxXQUFULENBQXFCLEdBQXJCLEVBQTBCLFdBQTFCLEVBQXVDO0FBQzVDLE1BQUksQ0FBQyxXQUFMLEVBQWtCO0FBQ2hCLFdBQU8sS0FBUDtBQUNEO0FBQ0QsU0FBTyxZQUFZLGFBQVosQ0FBMEIsV0FBMUIsSUFBeUMsR0FBaEQ7QUFDRDs7Ozs7O1FDaHBCZSxhLEdBQUEsYTs7QUFSaEI7O0FBRUE7Ozs7OztBQU1PLFNBQVMsYUFBVCxDQUF1QixPQUF2QixFQUFnQztBQUNyQyxTQUFPO0FBQ0wsY0FBVSxtQkFBUSxPQUFSLEVBQWlCLFFBRHRCO0FBRUwsaUJBQWEsbUJBQVEsT0FBUixFQUFpQixXQUZ6QjtBQUdMLFlBQVEsbUJBQVEsT0FBUixFQUFpQixNQUhwQjtBQUlMLGNBQVUsbUJBQVEsT0FBUixFQUFpQixRQUp0QjtBQUtMLFVBQU0sbUJBQVEsT0FBUixFQUFpQixJQUxsQjtBQU1MLFVBQU0sbUJBQVEsT0FBUixFQUFpQixJQU5sQjtBQU9MLFNBQUssbUJBQVEsT0FBUixFQUFpQixHQVBqQjtBQVFMLGFBQVMsbUJBQVEsT0FBUixFQUFpQixPQVJyQjtBQVNMLGdCQUFZLG1CQUFRLE9BQVIsRUFBaUI7QUFUeEIsR0FBUDtBQVdELEMsQ0FwQ0Q7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztRQ2dEZ0IsTyxHQUFBLE87UUFnR0EsdUIsR0FBQSx1QjtRQU1BLHlCLEdBQUEseUI7O0FBdEloQjs7QUFFQTs7Ozs7Ozs7Ozs7OztBQWFPLElBQUksa0NBQUo7O0FBRVA7QUFqQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7QUFrQ0EsSUFBTSxVQUFVLDBCQUFoQjs7QUFFQTs7Ozs7QUFLQSxJQUFJLGFBQWEsRUFBakI7O0FBRUE7Ozs7O0FBS08sU0FBUyxPQUFULENBQWlCLE9BQWpCLEVBQTBCO0FBQy9CLE1BQU0sTUFBTSxXQUFXLElBQXZCO0FBQ0EsTUFBSSxJQUFJLFFBQVIsRUFBa0I7QUFDaEIsV0FBTyxJQUFJLFFBQVg7QUFDRDtBQUNELFNBQU8sSUFBSSxRQUFKLEdBQWUsU0FBUyxHQUFULENBQXRCO0FBQ0Q7O0FBRUQ7Ozs7O0FBS0EsU0FBUyxRQUFULENBQWtCLEdBQWxCLEVBQXVCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxTQUFTLElBQWY7QUFDQSxNQUFNLGNBQWMsS0FBcEI7O0FBRUEsTUFBTSxrQkFBa0IsQ0FBQyxFQUFFLEtBQUssVUFBTCxJQUFtQixLQUFLLFVBQUwsQ0FBZ0IsUUFBckMsQ0FBekI7QUFDQSxNQUFNLGVBQWUsVUFBVSxDQUFDLEVBQUUsSUFBSSxRQUFKLElBQWdCLElBQUksU0FBdEIsQ0FBaEM7QUFDQSxNQUFNLGFBQWEsV0FBVyxtQkFBbUIsWUFBOUIsQ0FBbkI7QUFDQSxNQUFNLFlBQVk7QUFDZDtBQUNBO0FBQ0EsTUFBSSxRQUFKLENBQWEsWUFBYixJQUE2QixJQUFJLFFBQUosQ0FBYSxJQUg1QixDQUFsQjs7QUFLQSxNQUFNLGNBQWMsNENBQWtCLElBQUksUUFBSixDQUFhLE1BQS9CLENBQXBCOztBQUVBLE1BQUksQ0FBQyxVQUFMLEVBQWlCO0FBQ2YsaUJBQWEsY0FBYyxHQUFkLEVBQW1CLFVBQW5CLENBQWI7QUFDRDs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQU87QUFDTCxjQUFVLFVBREw7QUFFTDtBQUNBO0FBQ0E7QUFDQSxpQkFBYSxDQUFDLEVBQUUsVUFBVSxhQUFWLEtBQTRCLEdBQTVCLElBQW1DLElBQUksWUFBekMsQ0FMVDtBQU1MLGNBQVUsVUFBVSxhQUFWLEtBQTRCLEdBTmpDO0FBT0w7QUFDQTtBQUNBLFlBQVEsVUFBVSxRQUFWLENBVEg7QUFVTDtBQUNBLGlCQUFhLFVBQVUsU0FBVixDQVhSO0FBWUwsY0FBVSxXQVpMO0FBYUw7QUFDQTtBQUNBLFVBQU0sWUFBWSxVQUFaLEtBQTJCLFNBZjVCO0FBZ0JMLFVBQU0sWUFoQkQ7QUFpQkwsU0FBSyxVQUFVLEtBQVYsQ0FqQkE7QUFrQkwsb0JBbEJLO0FBbUJMO0FBbkJLLEdBQVA7QUFxQkQ7O0FBRUQ7Ozs7Ozs7O0FBUUEsU0FBUyxhQUFULENBQXVCLEdBQXZCLEVBQTRCLFVBQTVCLEVBQXdDO0FBQ3RDO0FBQ0E7QUFDQSxNQUFJLFVBQUosRUFBZ0I7QUFDZCxXQUFPLE9BQVA7QUFDRDs7QUFFRCxNQUFJLElBQUksVUFBSixJQUFrQixJQUFJLFVBQUosQ0FBZSxDQUFyQyxFQUF3QztBQUN0QyxXQUFPLElBQUksVUFBSixDQUFlLENBQXRCO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFZLE9BQVo7QUFDRDs7QUFHRDs7Ozs7O0FBTU8sU0FBUyx1QkFBVCxDQUFpQyxHQUFqQyxFQUFzQyxVQUF0QyxFQUFrRDtBQUN2RCxTQUFPLGNBQWMsR0FBZCxFQUFtQixVQUFuQixDQUFQO0FBQ0Q7O0FBR0Q7QUFDTyxTQUFTLHlCQUFULEdBQXFDO0FBQzFDLGVBQWEsRUFBYjtBQUNEOzs7Ozs7UUM3SGUsTyxHQUFBLE87UUE2Q0EsUSxHQUFBLFE7O0FBeERoQjs7QUFDQTs7QUFqQkE7Ozs7Ozs7Ozs7Ozs7Ozs7QUFtQkEsSUFBSSxrQkFBSjs7QUFFQTs7Ozs7O0FBTU8sU0FBUyxPQUFULENBQWlCLFNBQWpCLEVBQTRCO0FBQ2pDLE1BQU0sTUFBTSxVQUFVLGFBQVYsSUFBMkIsU0FBdkM7QUFDQSxNQUFJLENBQUMsU0FBRCxJQUFjLFVBQVUsYUFBVixLQUE0QixHQUE5QyxFQUFtRDtBQUNqRCxnQkFBWSxJQUFJLGFBQUosQ0FBa0IsS0FBbEIsQ0FBWjtBQUNEOztBQUVELFNBQU8sSUFBUDtBQUNEOztBQUVEOzs7Ozs7Ozs7Ozs7OztBQWNBLFNBQVMsSUFBVCxDQUFjLE9BQWQsRUFBdUI7QUFDckIsa0JBQU0sTUFBTixDQUFhLFFBQVEsTUFBUixLQUFtQixDQUFoQyxFQUFtQyxtQ0FBbkM7QUFDQSxhQUFVLE1BQU0sU0FBaEIsR0FBNEIsUUFBUSxDQUFSLENBQTVCOztBQUVBLE1BQU0sS0FBSyxVQUFVLGlCQUFyQjtBQUNBLGtCQUFNLE1BQU4sQ0FBYSxFQUFiLEVBQWlCLHlCQUFqQjtBQUNBLGtCQUFNLE1BQU4sQ0FBYSxDQUFDLEdBQUcsa0JBQWpCLEVBQXFDLG9DQUFyQzs7QUFFQTtBQUNBLGFBQVUsTUFBTSxTQUFoQixHQUE0QixFQUE1Qjs7QUFFQSxTQUFPLEVBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7QUFRTyxTQUFTLFFBQVQsQ0FBa0IsSUFBbEIsRUFBd0I7QUFDN0IsTUFBTSxXQUFXLEtBQUssZ0JBQUwsQ0FBc0IsT0FBdEIsQ0FBakI7QUFDQSxNQUFNLE9BQU8sa0JBQWI7O0FBRUEsT0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLFNBQVMsTUFBN0IsRUFBcUMsR0FBckMsRUFBMEM7QUFDeEMsUUFBTSxVQUFVLFNBQVMsQ0FBVCxDQUFoQjtBQUNBLFFBQU0sTUFBTSxnQkFBTSxNQUFOLENBQWEsUUFBUSxZQUFSLENBQXFCLEtBQXJCLENBQWIsRUFBMEMsZ0JBQTFDLENBQVo7QUFDQSxZQUFRLGVBQVIsQ0FBd0IsS0FBeEI7QUFDQSxvQkFBTSxNQUFOLENBQWEsS0FBSyxHQUFMLE1BQWMsU0FBM0IsRUFBc0MsZUFBdEM7QUFDQSxTQUFLLEdBQUwsSUFBWSxPQUFaO0FBQ0Q7O0FBRUQsU0FBTyxJQUFQO0FBQ0Q7Ozs7OztRQy9DZSxlLEdBQUEsZTtRQVVBLGUsR0FBQSxlO1FBUUEsZSxHQUFBLGU7UUFVQSxRLEdBQUEsUTtRQVdBLFUsR0FBQSxVO1FBcUJBLGMsR0FBQSxjO1FBc0JBLFksR0FBQSxZO0FBeEhoQjs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQTs7Ozs7QUFLQSxTQUFTLFdBQVQsQ0FBcUIsTUFBckIsRUFBNkIsU0FBN0IsRUFBd0M7QUFDdEMsU0FBTyxVQUFVLFdBQVYsRUFBUDtBQUNEOztBQUVEOzs7O0FBSUEsU0FBUyx5QkFBVCxDQUFtQyxLQUFuQyxFQUEwQztBQUN4QyxTQUFPLE1BQU0sTUFBTSxXQUFOLEVBQWI7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLGVBQVQsQ0FBeUIsSUFBekIsRUFBK0I7QUFDcEMsU0FBTyxLQUFLLE9BQUwsQ0FBYSxXQUFiLEVBQTBCLFdBQTFCLENBQVA7QUFDRDs7QUFFRDs7Ozs7O0FBTU8sU0FBUyxlQUFULENBQXlCLE1BQXpCLEVBQWlDO0FBQ3RDLFNBQU8sT0FBTyxPQUFQLENBQWUsYUFBZixFQUE4Qix5QkFBOUIsQ0FBUDtBQUNEOztBQUVEOzs7O0FBSU8sU0FBUyxlQUFULENBQXlCLElBQXpCLEVBQStCO0FBQ3BDLFNBQU8sS0FBSyxPQUFMLENBQWEsR0FBYixFQUFrQixHQUFsQixDQUFQO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsUUFBVCxDQUFrQixNQUFsQixFQUEwQixNQUExQixFQUFrQztBQUN2QyxNQUFNLFFBQVEsT0FBTyxNQUFQLEdBQWdCLE9BQU8sTUFBckM7QUFDQSxTQUFPLFNBQVMsQ0FBVCxJQUFjLE9BQU8sT0FBUCxDQUFlLE1BQWYsRUFBdUIsS0FBdkIsS0FBaUMsS0FBdEQ7QUFDRDs7QUFFRDs7Ozs7O0FBTU8sU0FBUyxVQUFULENBQW9CLE1BQXBCLEVBQTRCLE1BQTVCLEVBQW9DO0FBQ3pDLE1BQUksT0FBTyxNQUFQLEdBQWdCLE9BQU8sTUFBM0IsRUFBbUM7QUFDakMsV0FBTyxLQUFQO0FBQ0Q7QUFDRCxTQUFPLE9BQU8sV0FBUCxDQUFtQixNQUFuQixFQUEyQixDQUEzQixLQUFpQyxDQUF4QztBQUNEOztBQUVEOzs7Ozs7Ozs7Ozs7OztBQWNPLFNBQVMsY0FBVCxDQUF3QixRQUF4QixFQUFrQyxNQUFsQyxFQUEwQyxpQkFBMUMsRUFBNkQ7QUFDbEUsTUFBTSxnQkFBZ0IscUJBQXFCLENBQTNDOztBQURrRSw2QkFFekQsQ0FGeUQ7QUFHaEUsUUFBSSxVQUFVLENBQWQ7QUFDQSxlQUFXLFNBQVMsT0FBVCxDQUFpQixjQUFqQixFQUFpQyxVQUFDLEVBQUQsRUFBSyxDQUFMLEVBQVc7QUFDckQ7QUFDQSxhQUFPLE9BQU8sQ0FBUCxDQUFQO0FBQ0QsS0FIVSxDQUFYO0FBSUEsUUFBSSxDQUFDLE9BQUwsRUFBYztBQUNaO0FBQ0Q7QUFWK0Q7O0FBRWxFLE9BQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxhQUFwQixFQUFtQyxHQUFuQyxFQUF3QztBQUFBLHFCQUEvQixDQUErQjs7QUFBQSwwQkFPcEM7QUFFSDtBQUNELFNBQU8sUUFBUDtBQUNEOztBQUVEOzs7Ozs7O0FBT08sU0FBUyxZQUFULENBQXNCLEdBQXRCLEVBQTJCO0FBQUEsTUFDekIsTUFEeUIsR0FDZixHQURlLENBQ3pCLE1BRHlCOztBQUVoQyxNQUFJLE9BQU8sSUFBWDtBQUNBLE9BQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxNQUFwQixFQUE0QixHQUE1QixFQUFpQztBQUMvQixXQUFPLE9BQU8sRUFBUCxHQUFZLElBQUksVUFBSixDQUFlLENBQWYsQ0FBbkI7QUFDRDtBQUNEO0FBQ0EsU0FBTyxPQUFPLFNBQVMsQ0FBaEIsQ0FBUDtBQUNEOzs7Ozs7UUMvRmUsb0IsR0FBQSxvQjtRQWlDQSx1QixHQUFBLHVCO1FBaUNBLGtCLEdBQUEsa0I7UUFnQkEsUSxHQUFBLFE7UUFpQkEsUSxHQUFBLFE7UUFnQkEsUyxHQUFBLFM7UUFZQSxNLEdBQUEsTTtRQWFBLEUsR0FBQSxFO1FBU0EsRyxHQUFBLEc7UUFTQSxVLEdBQUEsVTtRQWNBLFMsR0FBQSxTO1FBbUJBLEssR0FBQSxLO1FBU0EsTSxHQUFBLE07UUFjQSxvQixHQUFBLG9CO1FBYUEsYSxHQUFBLGE7UUFXQSxXLEdBQUEsVzs7QUE5UGhCOztBQUNBOztBQUdBO0FBckJBOzs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JBO0FBTUEsSUFBSSwwQkFBSjs7QUFFQTtBQUNBLElBQU0saUJBQWlCLENBQUMsUUFBRCxFQUFXLFFBQVgsRUFBcUIsS0FBckIsRUFBNEIsS0FBNUIsRUFBbUMsSUFBbkMsRUFBeUMsR0FBekMsRUFBOEMsR0FBOUMsQ0FBdkI7O0FBR0E7Ozs7O0FBS08sU0FBUyxvQkFBVCxDQUE4QixTQUE5QixFQUF5QztBQUM5QyxTQUFPLFVBQVUsTUFBVixDQUFpQixDQUFqQixFQUFvQixXQUFwQixLQUFvQyxVQUFVLEtBQVYsQ0FBZ0IsQ0FBaEIsQ0FBM0M7QUFDRDs7QUFFRDs7Ozs7Ozs7QUFRQSxTQUFTLHdCQUFULENBQWtDLEtBQWxDLEVBQXlDLFNBQXpDLEVBQW9EO0FBQ2xELE9BQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxlQUFlLE1BQW5DLEVBQTJDLEdBQTNDLEVBQWdEO0FBQzlDLFFBQU0sZUFBZSxlQUFlLENBQWYsSUFBb0IsU0FBekM7QUFDQSxRQUFJLE1BQU0sWUFBTixNQUF3QixTQUE1QixFQUF1QztBQUNyQyxhQUFPLFlBQVA7QUFDRDtBQUNGO0FBQ0QsU0FBTyxFQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7Ozs7O0FBV08sU0FBUyx1QkFBVCxDQUFpQyxLQUFqQyxFQUF3QyxTQUF4QyxFQUFtRCxlQUFuRCxFQUFvRTtBQUN6RSxNQUFJLHdCQUFXLFNBQVgsRUFBc0IsSUFBdEIsQ0FBSixFQUFpQztBQUMvQjtBQUNBLFdBQU8sU0FBUDtBQUNEO0FBQ0QsTUFBSSxDQUFDLGlCQUFMLEVBQXdCO0FBQ3RCLHdCQUFvQixrQkFBcEI7QUFDRDtBQUNELE1BQUksZUFBZSxrQkFBa0IsU0FBbEIsQ0FBbkI7QUFDQSxNQUFJLENBQUMsWUFBRCxJQUFpQixlQUFyQixFQUFzQztBQUNwQyxtQkFBZSxTQUFmO0FBQ0EsUUFBSSxNQUFNLFNBQU4sTUFBcUIsU0FBekIsRUFBb0M7QUFDbEMsVUFBTSxZQUFZLHFCQUFxQixTQUFyQixDQUFsQjtBQUNBLFVBQU0sdUJBQXVCLHlCQUF5QixLQUF6QixFQUFnQyxTQUFoQyxDQUE3Qjs7QUFFQSxVQUFJLE1BQU0sb0JBQU4sTUFBZ0MsU0FBcEMsRUFBK0M7QUFDN0MsdUJBQWUsb0JBQWY7QUFDRDtBQUNGO0FBQ0QsUUFBSSxDQUFDLGVBQUwsRUFBc0I7QUFDcEIsd0JBQWtCLFNBQWxCLElBQStCLFlBQS9CO0FBQ0Q7QUFDRjtBQUNELFNBQU8sWUFBUDtBQUNEOztBQUdEOzs7Ozs7QUFNTyxTQUFTLGtCQUFULENBQTRCLE9BQTVCLEVBQXFDLE1BQXJDLEVBQTZDO0FBQ2xELE9BQUssSUFBTSxDQUFYLElBQWdCLE1BQWhCLEVBQXdCO0FBQ3RCLFlBQVEsS0FBUixDQUFjLFdBQWQsQ0FDSSx3QkFBd0IsTUFBeEIsRUFBZ0MsQ0FBaEMsQ0FESixFQUN3QyxPQUFPLENBQVAsRUFBVSxRQUFWLEVBRHhDLEVBQzhELFdBRDlEO0FBRUQ7QUFDRjs7QUFHRDs7Ozs7Ozs7QUFRTyxTQUFTLFFBQVQsQ0FBa0IsT0FBbEIsRUFBMkIsUUFBM0IsRUFBcUMsS0FBckMsRUFBNEMsU0FBNUMsRUFBdUQsZUFBdkQsRUFBd0U7QUFDN0UsTUFBTSxlQUFlLHdCQUF3QixRQUFRLEtBQWhDLEVBQXVDLFFBQXZDLEVBQ2pCLGVBRGlCLENBQXJCO0FBRUEsTUFBSSxZQUFKLEVBQWtCO0FBQ2hCLFlBQVEsS0FBUixDQUFjLFlBQWQ7QUFDRSx5QkFBdUIsWUFBWSxRQUFRLFNBQXBCLEdBQWdDLEtBRHpEO0FBRUQ7QUFDRjs7QUFHRDs7Ozs7OztBQU9PLFNBQVMsUUFBVCxDQUFrQixPQUFsQixFQUEyQixRQUEzQixFQUFxQyxlQUFyQyxFQUFzRDtBQUMzRCxNQUFNLGVBQWUsd0JBQXdCLFFBQVEsS0FBaEMsRUFBdUMsUUFBdkMsRUFDakIsZUFEaUIsQ0FBckI7QUFFQSxNQUFJLENBQUMsWUFBTCxFQUFtQjtBQUNqQixXQUFPLFNBQVA7QUFDRDtBQUNELFNBQU8sUUFBUSxLQUFSLENBQWMsWUFBZCxDQUFQO0FBQ0Q7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsU0FBVCxDQUFtQixPQUFuQixFQUE0QixNQUE1QixFQUFvQztBQUN6QyxPQUFLLElBQU0sQ0FBWCxJQUFnQixNQUFoQixFQUF3QjtBQUN0QixhQUFTLE9BQVQsRUFBa0IsQ0FBbEIsRUFBcUIsT0FBTyxDQUFQLENBQXJCO0FBQ0Q7QUFDRjs7QUFHRDs7Ozs7QUFLTyxTQUFTLE1BQVQsQ0FBZ0IsT0FBaEIsRUFBeUIsV0FBekIsRUFBc0M7QUFDM0MsTUFBSSxnQkFBZ0IsU0FBcEIsRUFBK0I7QUFDN0Isa0JBQWMsU0FBUyxPQUFULEVBQWtCLFNBQWxCLEtBQWdDLE1BQTlDO0FBQ0Q7QUFDRCxXQUFTLE9BQVQsRUFBa0IsU0FBbEIsRUFBNkIsY0FBYyxFQUFkLEdBQW1CLE1BQWhEO0FBQ0Q7O0FBR0Q7Ozs7O0FBS08sU0FBUyxFQUFULENBQVksS0FBWixFQUFtQjtBQUN4QixTQUFVLEtBQVY7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLEdBQVQsQ0FBYSxLQUFiLEVBQW9CO0FBQ3pCLFNBQVUsS0FBVjtBQUNEOztBQUVEOzs7OztBQUtPLFNBQVMsVUFBVCxDQUFvQixLQUFwQixFQUEyQjtBQUNoQyxNQUFJLE9BQU8sS0FBUCxJQUFnQixRQUFwQixFQUE4QjtBQUM1QiwyQkFBcUIsS0FBckI7QUFDRDtBQUNELHlCQUFxQixHQUFHLEtBQUgsQ0FBckI7QUFDRDs7QUFHRDs7Ozs7O0FBTU8sU0FBUyxTQUFULENBQW1CLENBQW5CLEVBQXNCLEtBQXRCLEVBQTZCO0FBQ2xDLE1BQUksT0FBTyxDQUFQLElBQVksUUFBaEIsRUFBMEI7QUFDeEIsUUFBSSxHQUFHLENBQUgsQ0FBSjtBQUNEO0FBQ0QsTUFBSSxVQUFVLFNBQWQsRUFBeUI7QUFDdkIsMEJBQW9CLENBQXBCO0FBQ0Q7QUFDRCxNQUFJLE9BQU8sS0FBUCxJQUFnQixRQUFwQixFQUE4QjtBQUM1QixZQUFRLEdBQUcsS0FBSCxDQUFSO0FBQ0Q7QUFDRCx3QkFBb0IsQ0FBcEIsVUFBMEIsS0FBMUI7QUFDRDs7QUFHRDs7Ozs7QUFLTyxTQUFTLEtBQVQsQ0FBZSxLQUFmLEVBQXNCO0FBQzNCLG9CQUFnQixLQUFoQjtBQUNEOztBQUVEOzs7OztBQUtPLFNBQVMsTUFBVCxDQUFnQixLQUFoQixFQUF1QjtBQUM1QixNQUFJLE9BQU8sS0FBUCxJQUFnQixRQUFwQixFQUE4QjtBQUM1QixZQUFRLElBQUksS0FBSixDQUFSO0FBQ0Q7QUFDRCxxQkFBaUIsS0FBakI7QUFDRDs7QUFFRDs7Ozs7OztBQU9PLFNBQVMsb0JBQVQsQ0FBOEIsU0FBOUIsRUFBeUM7QUFDOUMsU0FBTyxVQUFVLE9BQVYsQ0FDSCxxQ0FERyxFQUNvQyxlQURwQyxDQUFQO0FBRUQ7O0FBRUQ7Ozs7Ozs7O0FBUU8sU0FBUyxhQUFULENBQXVCLEdBQXZCLEVBQTRCLEVBQTVCLEVBQWdDO0FBQ3JDLE1BQU0sUUFBUSxtQ0FBb0MsSUFBSSxnQkFBSixDQUFxQixFQUFyQixDQUFsRDtBQUNBLFNBQU8sdUNBQXVDLEtBQUQsSUFBVztBQUF4RDtBQUNEOztBQUdEOzs7OztBQUtPLFNBQVMsV0FBVCxDQUFxQixPQUFyQixFQUE4QixVQUE5QixFQUEwQztBQUMvQyxNQUFNLFdBQVcsRUFBakI7QUFDQSxhQUFXLE9BQVgsQ0FBbUIsZ0JBQVE7QUFDekIsYUFBUyxJQUFULElBQWlCLElBQWpCO0FBQ0QsR0FGRDtBQUdBLFlBQVUsT0FBVixFQUFtQixRQUFuQjtBQUNEOzs7Ozs7UUNwUGUsTyxHQUFBLE87UUFVQSxPLEdBQUEsTztRQWdCQSxRLEdBQUEsUTtRQVdBLGMsR0FBQSxjO1FBWUEsVyxHQUFBLFc7UUFtQkEsSyxHQUFBLEs7QUFyR2hCOzs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JBO0FBQ0EsSUFBTSxZQUFZLE9BQU8sU0FBUCxDQUFpQixRQUFuQzs7QUFFQTs7Ozs7QUFLQSxTQUFTLFFBQVQsQ0FBa0IsS0FBbEIsRUFBeUI7QUFDdkIsU0FBTyxVQUFVLElBQVYsQ0FBZSxLQUFmLENBQVA7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLE9BQVQsQ0FBaUIsS0FBakIsRUFBd0I7QUFDN0IsU0FBTyxNQUFNLE9BQU4sQ0FBYyxLQUFkLENBQVA7QUFDRDs7QUFFRDs7Ozs7O0FBTU8sU0FBUyxPQUFULENBQWlCLFNBQWpCLEVBQTRCO0FBQ2pDLE1BQUksQ0FBQyxTQUFMLEVBQWdCO0FBQ2QsV0FBTyxFQUFQO0FBQ0Q7QUFDRCxNQUFNLFFBQVEsSUFBSSxLQUFKLENBQVUsVUFBVSxNQUFwQixDQUFkO0FBQ0EsT0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLFVBQVUsTUFBOUIsRUFBc0MsR0FBdEMsRUFBMkM7QUFDekMsVUFBTSxDQUFOLElBQVcsVUFBVSxDQUFWLENBQVg7QUFDRDtBQUNELFNBQU8sS0FBUDtBQUNEOztBQUVEOzs7OztBQUtPLFNBQVMsUUFBVCxDQUFrQixLQUFsQixFQUF5QjtBQUM5QixTQUFPLFNBQVMsS0FBVCxNQUFvQixpQkFBM0I7QUFDRDs7QUFFRDs7Ozs7OztBQU9PLFNBQVMsY0FBVCxDQUF3QixLQUF4QixFQUErQjtBQUNwQyxTQUFRLE9BQU8sS0FBUCxLQUFpQixRQUFqQixJQUE2QixTQUFTLEtBQVQsQ0FBckM7QUFDRDs7QUFFRDs7Ozs7Ozs7QUFRTyxTQUFTLFdBQVQsQ0FBcUIsT0FBckIsRUFBOEIsQ0FBOUIsRUFBaUM7QUFDdEMsT0FBSyxJQUFNLENBQVgsSUFBZ0IsT0FBaEIsRUFBeUI7QUFDdkIsUUFBSSxRQUFRLENBQVIsTUFBZSxDQUFuQixFQUFzQjtBQUNwQixhQUFPLElBQVA7QUFDRDtBQUNGO0FBQ0QsU0FBTyxLQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7Ozs7QUFVTyxTQUFTLEtBQVQsQ0FBZSxTQUFmLEVBQTBCO0FBQy9CLFNBQU8sdUJBQXdCO0FBQS9CO0FBQ0Q7Ozs7OztRQ3pFZSxpQixHQUFBLGlCOztBQWRoQjs7QUFFQSxJQUFNLFFBQVEsb0NBQWQ7O0FBRUE7Ozs7Ozs7Ozs7QUFwQkE7Ozs7Ozs7Ozs7Ozs7Ozs7QUE4Qk8sU0FBUyxpQkFBVCxDQUEyQixXQUEzQixFQUF3QztBQUM3QyxNQUFNLFNBQVMsMEJBQTRCLE9BQU8sTUFBUCxDQUFjLElBQWQsQ0FBM0M7QUFDQSxNQUFJLENBQUMsV0FBTCxFQUFrQjtBQUNoQixXQUFPLE1BQVA7QUFDRDs7QUFFRCxNQUFJLGNBQUo7QUFDQSxTQUFRLFFBQVEsTUFBTSxJQUFOLENBQVcsV0FBWCxDQUFoQixFQUEwQztBQUN4QyxRQUFNLE9BQU8sc0RBQXVCLE1BQU0sQ0FBTixDQUF2QixFQUFpQyxNQUFNLENBQU4sQ0FBakMsQ0FBYjtBQUNBLFFBQU0sUUFBUSxNQUFNLENBQU4sSUFBVyxzREFBdUIsTUFBTSxDQUFOLENBQXZCLEVBQWlDLE1BQU0sQ0FBTixDQUFqQyxDQUFYLEdBQXdELEVBQXRFO0FBQ0EsV0FBTyxJQUFQLElBQWUsS0FBZjtBQUNEO0FBQ0QsU0FBTyxNQUFQO0FBQ0Q7Ozs7OztRQ2hCZSxzQixHQUFBLHNCO0FBM0JoQjs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQTs7Ozs7Ozs7Ozs7QUFXTyxTQUFTLHNCQUFULENBQWdDLFNBQWhDLEVBQTBEO0FBQUEsTUFBZixRQUFlLHVFQUFKLEVBQUk7O0FBQy9ELE1BQUk7QUFDRixXQUFPLG1CQUFtQixTQUFuQixDQUFQO0FBQ0QsR0FGRCxDQUVFLE9BQU8sQ0FBUCxFQUFVO0FBQ1YsV0FBTyxRQUFQO0FBQ0Q7QUFDRjs7Ozs7O1FDSmUsRyxHQUFBLEc7UUFtQkEsSSxHQUFBLEk7UUFjQSxNLEdBQUEsTTtRQVlBLFcsR0FBQSxXO1FBbUJBLFMsR0FBQSxTO1FBNENBLEksR0FBQSxJOztBQXpIaEI7O0FBRUE7QUFDQSxJQUFNLFVBQVUsT0FBTyxTQUFQLENBQWlCLGNBQWpDOztBQUVBOzs7Ozs7OztBQXJCQTs7Ozs7Ozs7Ozs7Ozs7OztBQTZCTyxTQUFTLEdBQVQsQ0FBYSxXQUFiLEVBQTBCO0FBQy9CLE1BQU0sTUFBTSxPQUFPLE1BQVAsQ0FBYyxJQUFkLENBQVo7QUFDQSxNQUFJLFdBQUosRUFBaUI7QUFDZixXQUFPLE1BQVAsQ0FBYyxHQUFkLEVBQW1CLFdBQW5CO0FBQ0Q7QUFDRCxTQUFPLEdBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7Ozs7QUFXTyxTQUFTLElBQVQsQ0FBYyxXQUFkLEVBQTJCO0FBQ2hDO0FBQ0E7QUFDQSxTQUFPLDJCQUE0QixlQUFlO0FBQWxEO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUU8sU0FBUyxNQUFULENBQWdCLEdBQWhCLEVBQXFCLEdBQXJCLEVBQTBCO0FBQy9CLFNBQU8sUUFBUSxJQUFSLENBQWEsR0FBYixFQUFrQixHQUFsQixDQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUU8sU0FBUyxXQUFULENBQXFCLEdBQXJCLEVBQTBCLEdBQTFCLEVBQStCO0FBQ3BDLE1BQUksT0FBTyxHQUFQLEVBQVksR0FBWixDQUFKLEVBQXNCO0FBQ3BCLFdBQU8sSUFBSSxHQUFKLENBQVA7QUFDRCxHQUZELE1BRU87QUFDTCxXQUFPLFNBQVA7QUFDRDtBQUNGOztBQUVEOzs7Ozs7Ozs7OztBQVdPLFNBQVMsU0FBVCxDQUFtQixNQUFuQixFQUEyQixNQUEzQixFQUErQztBQUFBLE1BQVosS0FBWSx1RUFBSixFQUFJOztBQUNwRDtBQUNBLE1BQU0sT0FBTyxFQUFiOztBQUVBO0FBQ0EsTUFBTSxRQUFRLEVBQWQ7QUFDQSxRQUFNLElBQU4sQ0FBVyxFQUFDLEdBQUcsTUFBSixFQUFZLEdBQUcsTUFBZixFQUF1QixHQUFHLENBQTFCLEVBQVg7O0FBRUE7O0FBUm9EO0FBQUEsdUJBVWhDLE1BQU0sS0FBTixFQVZnQztBQUFBLFFBVTNDLENBVjJDLGdCQVUzQyxDQVYyQztBQUFBLFFBVXhDLENBVndDLGdCQVV4QyxDQVZ3QztBQUFBLFFBVXJDLENBVnFDLGdCQVVyQyxDQVZxQzs7QUFXbEQsUUFBSSxLQUFLLFFBQUwsQ0FBYyxDQUFkLENBQUosRUFBc0I7QUFDcEIsWUFBTSxJQUFJLEtBQUosQ0FBVSx5Q0FBVixDQUFOO0FBQ0Q7QUFDRCxTQUFLLElBQUwsQ0FBVSxDQUFWO0FBQ0EsUUFBSSxNQUFNLENBQVYsRUFBYTtBQUNYO0FBQ0Q7QUFDRCxRQUFJLElBQUksS0FBUixFQUFlO0FBQ2IsYUFBTyxNQUFQLENBQWMsQ0FBZCxFQUFpQixDQUFqQjtBQUNBO0FBQ0Q7QUFDRCxXQUFPLElBQVAsQ0FBWSxDQUFaLEVBQWUsT0FBZixDQUF1QixlQUFPO0FBQzVCLFVBQU0sV0FBVyxFQUFFLEdBQUYsQ0FBakI7QUFDQTtBQUNBO0FBQ0EsVUFBSSxPQUFPLENBQVAsRUFBVSxHQUFWLENBQUosRUFBb0I7QUFDbEIsWUFBTSxXQUFXLEVBQUUsR0FBRixDQUFqQjtBQUNBLFlBQUkscUJBQVMsUUFBVCxLQUFzQixxQkFBUyxRQUFULENBQTFCLEVBQThDO0FBQzVDLGdCQUFNLElBQU4sQ0FBVyxFQUFDLEdBQUcsUUFBSixFQUFjLEdBQUcsUUFBakIsRUFBMkIsR0FBRyxJQUFJLENBQWxDLEVBQVg7QUFDQTtBQUNEO0FBQ0Y7QUFDRCxRQUFFLEdBQUYsSUFBUyxRQUFUO0FBQ0QsS0FaRDtBQXRCa0Q7O0FBU3BELFNBQU8sTUFBTSxNQUFOLEdBQWUsQ0FBdEIsRUFBeUI7QUFBQTs7QUFBQSw2QkFXckI7QUFlSDtBQUNELFNBQU8sTUFBUDtBQUNEOztBQUVEOzs7OztBQUtPLFNBQVMsSUFBVCxDQUFjLENBQWQsRUFBaUIsS0FBakIsRUFBd0I7QUFDN0IsU0FBTyxPQUFPLElBQVAsQ0FBWSxDQUFaLEVBQWUsTUFBZixDQUFzQixVQUFDLEdBQUQsRUFBTSxHQUFOLEVBQWM7QUFDekMsUUFBSSxDQUFDLE1BQU0sUUFBTixDQUFlLEdBQWYsQ0FBTCxFQUEwQjtBQUN4QixVQUFJLEdBQUosSUFBVyxFQUFFLEdBQUYsQ0FBWDtBQUNEO0FBQ0QsV0FBTyxHQUFQO0FBQ0QsR0FMTSxFQUtKLEVBTEksQ0FBUDtBQU1EOzs7Ozs7Ozs7UUN4RWUsVSxHQUFBLFU7UUFlQSxJLEdBQUEsSTs7OztBQXZGaEI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQXFCYSxRO0FBQ1g7OztRQURXLFEsR0FJWCxvQkFBYztBQUFBOztBQUNaLE1BQUksZ0JBQUo7QUFBQSxNQUFhLGVBQWI7O0FBRUE7OztBQUdBLE9BQUssT0FBTCxHQUFlLElBQUksTUFBTSxPQUFWLENBQWtCLFVBQUMsR0FBRCxFQUFNLEdBQU4sRUFBYztBQUM3QyxjQUFVLEdBQVY7QUFDQSxhQUFTLEdBQVQ7QUFDRCxHQUhjLENBQWY7O0FBS0E7OztBQUdBLE9BQUssT0FBTCxHQUFlLE9BQWY7O0FBRUE7OztBQUdBLE9BQUssTUFBTCxHQUFjLE1BQWQ7QUFDRCxDOztBQUdIOzs7Ozs7Ozs7O0FBUU8sU0FBUyxVQUFULENBQW9CLEVBQXBCLEVBQXdCO0FBQzdCLFNBQU8sSUFBSSxPQUFKLENBQVksbUJBQVc7QUFDNUIsWUFBUSxJQUFSO0FBQ0QsR0FGTSxDQUFQO0FBR0Q7O0FBRUQ7Ozs7Ozs7OztBQVNPLFNBQVMsSUFBVCxDQUFjLFFBQWQsRUFBbUM7QUFBQSxNQUFYLEtBQVcsdUVBQUgsQ0FBRzs7QUFDeEMsU0FBTyxJQUFJLE9BQUosQ0FBWSxVQUFDLE9BQUQsRUFBVSxNQUFWLEVBQXFCO0FBQ3RDLFlBQVEsS0FBSyxHQUFMLENBQVMsS0FBVCxFQUFnQixDQUFoQixDQUFSO0FBQ0EsUUFBTSxRQUFRLFNBQVMsTUFBVCxHQUFrQixLQUFoQztBQUNBLFFBQUksUUFBUSxDQUFaLEVBQWU7QUFDYixhQUFPLElBQUksS0FBSixDQUFVLGdDQUFWLENBQVA7QUFDRDtBQUNELFFBQUksU0FBUyxNQUFULElBQW1CLENBQXZCLEVBQTBCO0FBQ3hCLGNBQVEsRUFBUjtBQUNEO0FBQ0QsUUFBTSxTQUFTLEVBQWY7QUFDQSxRQUFNLFVBQVUsRUFBaEI7O0FBRUEsUUFBTSxjQUFjLFNBQWQsV0FBYyxRQUFTO0FBQzNCLFVBQUksT0FBTyxNQUFQLEdBQWdCLEtBQXBCLEVBQTJCO0FBQ3pCLGVBQU8sSUFBUCxDQUFZLEtBQVo7QUFDRDtBQUNELFVBQUksT0FBTyxNQUFQLElBQWlCLEtBQXJCLEVBQTRCO0FBQzFCLGdCQUFRLE1BQVI7QUFDRDtBQUNGLEtBUEQ7QUFRQSxRQUFNLGFBQWEsU0FBYixVQUFhLFNBQVU7QUFDM0IsVUFBSSxRQUFRLE1BQVIsSUFBa0IsS0FBdEIsRUFBNkI7QUFDM0IsZ0JBQVEsSUFBUixDQUFhLE1BQWI7QUFDRDtBQUNELFVBQUksUUFBUSxNQUFSLEdBQWlCLEtBQXJCLEVBQTRCO0FBQzFCLGVBQU8sT0FBUDtBQUNEO0FBQ0YsS0FQRDtBQVFBLFNBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxTQUFTLE1BQTdCLEVBQXFDLEdBQXJDLEVBQTBDO0FBQ3hDLGNBQVEsT0FBUixDQUFnQixTQUFTLENBQVQsQ0FBaEIsRUFBNkIsSUFBN0IsQ0FBa0MsV0FBbEMsRUFBK0MsVUFBL0M7QUFDRDtBQUNGLEdBL0JNLENBQVA7QUFnQ0Q7O0FBRUQ7Ozs7O0lBSWEsaUIsV0FBQSxpQjtBQUNYOzs7QUFHQSw2QkFBWSxZQUFaLEVBQTBCO0FBQUE7O0FBQ3hCLFFBQUksaUJBQUo7QUFBQSxRQUFjLGdCQUFkO0FBQ0E7QUFDQSxTQUFLLFFBQUwsR0FBZ0IsSUFBSSxPQUFKLENBQVksVUFBQyxPQUFELEVBQVUsTUFBVixFQUFxQjtBQUMvQyxpQkFBVyxPQUFYO0FBQ0EsZ0JBQVUsTUFBVjtBQUNELEtBSGUsQ0FBaEI7O0FBS0E7QUFDQSxTQUFLLFFBQUwsR0FBZ0IsUUFBaEI7O0FBRUE7QUFDQSxTQUFLLE9BQUwsR0FBZSxPQUFmOztBQUVBO0FBQ0EsU0FBSyxNQUFMLEdBQWMsQ0FBZDs7QUFFQSxRQUFJLFlBQUosRUFBa0I7QUFDaEIsV0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLGFBQWEsTUFBakMsRUFBeUMsR0FBekMsRUFBOEM7QUFDNUMsYUFBSyxHQUFMLENBQVMsYUFBYSxDQUFiLENBQVQ7QUFDRDtBQUNGO0FBQ0Y7O0FBRUQ7Ozs7Ozs7Ozt3QkFLSSxPLEVBQVM7QUFBQTs7QUFDWCxVQUFNLGFBQWEsRUFBRSxLQUFLLE1BQTFCO0FBQ0EsY0FBUSxPQUFSLENBQWdCLE9BQWhCLEVBQXlCLElBQXpCLENBQThCLGtCQUFVO0FBQ3RDLFlBQUksTUFBSyxNQUFMLEtBQWdCLFVBQXBCLEVBQWdDO0FBQzlCLGdCQUFLLFFBQUwsQ0FBYyxNQUFkO0FBQ0Q7QUFDRixPQUpELEVBSUcsaUJBQVM7QUFDVjtBQUNBO0FBQ0EsWUFBSSxNQUFLLE1BQUwsS0FBZ0IsVUFBcEIsRUFBZ0M7QUFDOUIsZ0JBQUssT0FBTCxDQUFhLEtBQWI7QUFDRDtBQUNGLE9BVkQ7QUFXQSxhQUFPLEtBQUssUUFBWjtBQUNEOztBQUVEOzs7O3lCQUNLLFcsRUFBYSxVLEVBQVk7QUFDNUIsYUFBTyxLQUFLLFFBQUwsQ0FBYyxJQUFkLENBQW1CLFdBQW5CLEVBQWdDLFVBQWhDLENBQVA7QUFDRDs7Ozs7Ozs7OztRQ25JYSxTLEdBQUEsUztBQS9DaEI7O0FBR0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBLElBQUksUUFBUSx3RUFBWjs7QUFFQSxTQUFTLE9BQVQsQ0FBaUIsS0FBakIsRUFBd0IsR0FBeEIsRUFBNkIsSUFBN0IsRUFBbUMsU0FBbkMsRUFBOEMsS0FBOUMsRUFBcUQ7QUFDbkQ7QUFDQSxNQUFJLEtBQUosRUFBVztBQUNULFdBQU8sS0FBUDtBQUNEO0FBQ0Q7QUFDQSxNQUFJLEdBQUosRUFBUztBQUNQLFdBQU8sUUFBUDtBQUNEO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsTUFBSSxTQUFKLEVBQWU7QUFDYixXQUFPLE1BQU0sS0FBTixDQUFZLENBQVosRUFBZSxDQUFDLENBQWhCLElBQXFCLElBQXJCLEdBQTRCLE1BQU0sS0FBTixDQUFZLENBQUMsQ0FBYixFQUFnQixVQUFoQixDQUEyQixDQUEzQixFQUE4QixRQUE5QixDQUF1QyxFQUF2QyxDQUE1QixHQUF5RSxHQUFoRjtBQUNEO0FBQ0Q7QUFDQTtBQUNBLFNBQU8sT0FBTyxLQUFkO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxTQUFULENBQW1CLEtBQW5CLEVBQTBCO0FBQy9CLFNBQU8sT0FBTyxLQUFQLEVBQWMsT0FBZCxDQUFzQixLQUF0QixFQUE2QixPQUE3QixDQUFQO0FBQ0QiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiZXhwb3J0IGNvbnN0IENTUyA9IFwiYW1wLWluc3RhZ3JhbS5hbXAtaW5zdGFncmFtLWRlZmF1bHQtZnJhbWluZ3tib3JkZXI6MXB4IHNvbGlkICNkYmRiZGIhaW1wb3J0YW50fVxcbi8qIyBzb3VyY2VVUkw9L2V4dGVuc2lvbnMvYW1wLWluc3RhZ3JhbS8wLjEvYW1wLWluc3RhZ3JhbS5jc3MqL1wiO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IEVtYmVkcyBhbiBpbnN0YWdyYW0gcGhvdG8uIFRoZSBkYXRhLXNob3J0Y29kZSBhdHRyaWJ1dGUgY2FuIGJlXG4gKiBlYXNpbHkgY29waWVkIGZyb20gYSBub3JtYWwgaW5zdGFncmFtIFVSTC4gRXhhbXBsZTogPGNvZGU+IDxhbXAtaW5zdGFncmFtXG4gKiBkYXRhLXNob3J0Y29kZT1cImZCd0ZQXCIgZGF0YS1jYXB0aW9uZWQgZGF0YS1kZWZhdWx0LWZyYW1pbmcgYWx0PVwiRmFzdGVzdCBwYWdlXG4gKiBpbiB0aGUgd2VzdC5cIiB3aWR0aD1cIjMyMFwiIGhlaWdodD1cIjM5MlwiIGxheW91dD1cInJlc3BvbnNpdmVcIj4gPC9hbXAtaW5zdGFncmFtPlxuICogPC9jb2RlPlxuICpcbiAqIEZvciByZXNwb25zaXZlIGVtYmVkZGluZyB0aGUgd2lkdGggYW5kIGhlaWdodCBjYW4gYmUgbGVmdCB1bmNoYW5nZWQgZnJvbSB0aGVcbiAqIGV4YW1wbGUgYWJvdmUgYW5kIHNob3VsZCBwcm9kdWNlIHRoZSBjb3JyZWN0IGFzcGVjdCByYXRpby4gYW1wLWluc3RhZ3JhbSB3aWxsXG4gKiBhdHRlbXB0IHRvIHJlc2l6ZSBvbiBsb2FkIGJhc2VkIG9uIHRoZSBoZWlnaHQgcmVwb3J0ZWQgYnkgdGhlIGVtYmVkZGVkIGZyYW1lLlxuICogSWYgY2FwdGlvbnMgYXJlIHNwZWNpZmllZCAoZGF0YS1jYXB0aW9uZWQpIHRoZW4gYSByZXNpemUgd2lsbCBiZSByZXF1ZXN0ZWRcbiAqIGV2ZXJ5IHRpbWUgZHVlIHRvIHRoZSBmYWN0IHRoYXQgaXQncyBub3QgcG9zc2libGUgdG8ga25vdyB0aGUgaGVpZ2h0IG9mIHRoZVxuICogY2FwdGlvbiBpbiBhZHZhbmNlLlxuICpcbiAqIElmIGNhcHRpb25zIGFyZSBpbmNsdWRlZCBpdCBpcyBzdHJpbmdseSByZWNjb21lbmRlZCB0aGF0IGFuIG92ZXJmbG93IGVsZW1lbnRcbiAqIGlzIGFsc28gaW5jbHVkZWQuICBTZWUgZGVzY3JpcHRpb24gb2Ygb3ZlcmZsb3cgaW4gYW1wLWlmcmFtZS5cbiAqXG4gKiBJZiBkYXRhLWRlZmF1bHQtZnJhbWluZyBpcyBwcmVzZW50IHdpbGwgYXBwbHkgdGhlIGRlZmF1bHQgaW5zdGFncmFtIGZyYW1lXG4gKiBzdHlsZSB3aXRob3V0IGNoYW5naW5nIHRoZSBsYXlvdXQvc2l6ZS5cbiAqL1xuXG5pbXBvcnQge0NTU30gZnJvbSAnLi4vLi4vLi4vYnVpbGQvYW1wLWluc3RhZ3JhbS0wLjEuY3NzJztcbmltcG9ydCB7Z2V0RGF0YSwgbGlzdGVufSBmcm9tICcuLi8uLi8uLi9zcmMvZXZlbnQtaGVscGVyJztcbmltcG9ydCB7aXNMYXlvdXRTaXplRGVmaW5lZH0gZnJvbSAnLi4vLi4vLi4vc3JjL2xheW91dCc7XG5pbXBvcnQge2lzT2JqZWN0fSBmcm9tICcuLi8uLi8uLi9zcmMvdHlwZXMnO1xuaW1wb3J0IHtyZW1vdmVFbGVtZW50fSBmcm9tICcuLi8uLi8uLi9zcmMvZG9tJztcbmltcG9ydCB7c2V0U3R5bGVzfSBmcm9tICcuLi8uLi8uLi9zcmMvc3R5bGUnO1xuaW1wb3J0IHtzdGFydHNXaXRofSBmcm9tICcuLi8uLi8uLi9zcmMvc3RyaW5nJztcbmltcG9ydCB7dHJ5UGFyc2VKc29ufSBmcm9tICcuLi8uLi8uLi9zcmMvanNvbic7XG5pbXBvcnQge3VzZXJ9IGZyb20gJy4uLy4uLy4uL3NyYy9sb2cnO1xuXG5jbGFzcyBBbXBJbnN0YWdyYW0gZXh0ZW5kcyBBTVAuQmFzZUVsZW1lbnQge1xuXG4gIC8qKiBAcGFyYW0geyFBbXBFbGVtZW50fSBlbGVtZW50ICovXG4gIGNvbnN0cnVjdG9yKGVsZW1lbnQpIHtcbiAgICBzdXBlcihlbGVtZW50KTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P0VsZW1lbnR9ICovXG4gICAgdGhpcy5pZnJhbWVfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P3N0cmluZ30gKi9cbiAgICB0aGlzLnNob3J0Y29kZV8gPSAnJztcblxuICAgIC8qKiBAcHJpdmF0ZSB7P0Z1bmN0aW9ufSAqL1xuICAgIHRoaXMudW5saXN0ZW5NZXNzYWdlXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUge3N0cmluZ30gICovXG4gICAgdGhpcy5jYXB0aW9uZWRfID0gJyc7XG5cbiAgICAvKipcbiAgICAqIEBwcml2YXRlIHs/UHJvbWlzZX1cbiAgICAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICAgICovXG4gICAgdGhpcy5pZnJhbWVQcm9taXNlXyA9IG51bGw7XG4gIH1cbiAgLyoqXG4gICogQHBhcmFtIHtib29sZWFuPX0gb3B0X29uTGF5b3V0XG4gICogQG92ZXJyaWRlXG4gICovXG4gIHByZWNvbm5lY3RDYWxsYmFjayhvcHRfb25MYXlvdXQpIHtcbiAgICAvLyBTZWVcbiAgICAvLyBodHRwczovL2luc3RhZ3JhbS5jb20vZGV2ZWxvcGVyL2VtYmVkZGluZy8/aGw9ZW5cbiAgICB0aGlzLnByZWNvbm5lY3QudXJsKCdodHRwczovL3d3dy5pbnN0YWdyYW0uY29tJywgb3B0X29uTGF5b3V0KTtcbiAgICAvLyBIb3N0IGluc3RhZ3JhbSB1c2VkIGZvciBpbWFnZSBzZXJ2aW5nLiBXaGlsZSB0aGUgaG9zdCBuYW1lIGlzXG4gICAgLy8gZnVua3kgdGhpcyBhcHBlYXJzIHRvIGJlIHN0YWJsZSBpbiB0aGUgcG9zdC1kb21haW4gc2hhcmRpbmcgZXJhLlxuICAgIHRoaXMucHJlY29ubmVjdC51cmwoJ2h0dHBzOi8vaW5zdGFncmFtLmZzbmMxLTEuZm5hLmZiY2RuLm5ldCcsXG4gICAgICAgIG9wdF9vbkxheW91dCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHJlbmRlck91dHNpZGVWaWV3cG9ydCgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGJ1aWxkQ2FsbGJhY2soKSB7XG4gICAgdGhpcy5zaG9ydGNvZGVfID0gdXNlcigpLmFzc2VydChcbiAgICAgICAgKHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2hvcnRjb2RlJykgfHxcbiAgICAgICAgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnc2hvcnRjb2RlJykpLFxuICAgICAgICAnVGhlIGRhdGEtc2hvcnRjb2RlIGF0dHJpYnV0ZSBpcyByZXF1aXJlZCBmb3IgPGFtcC1pbnN0YWdyYW0+ICVzJyxcbiAgICAgICAgdGhpcy5lbGVtZW50KTtcbiAgICB0aGlzLmNhcHRpb25lZF8gPSB0aGlzLmVsZW1lbnQuaGFzQXR0cmlidXRlKCdkYXRhLWNhcHRpb25lZCcpID9cbiAgICAgICdjYXB0aW9uZWQvJyA6ICcnO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBjcmVhdGVQbGFjZWhvbGRlckNhbGxiYWNrKCkge1xuICAgIGNvbnN0IHBsYWNlaG9sZGVyID0gdGhpcy53aW4uZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgcGxhY2Vob2xkZXIuc2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicsICcnKTtcbiAgICBjb25zdCBpbWFnZSA9IHRoaXMud2luLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FtcC1pbWcnKTtcbiAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ25vcHJlcmVuZGVyJywgJycpO1xuICAgIC8vIFRoaXMgd2lsbCByZWRpcmVjdCB0byB0aGUgaW1hZ2UgVVJMLiBCeSBleHBlcmltZW50YXRpb24gdGhpcyBpc1xuICAgIC8vIGFsd2F5cyB0aGUgc2FtZSBVUkwgdGhhdCBpcyBhY3R1YWxseSB1c2VkIGluc2lkZSBvZiB0aGUgZW1iZWQuXG4gICAgaW1hZ2Uuc2V0QXR0cmlidXRlKCdzcmMnLCAnaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9wLycgK1xuICAgICAgICBlbmNvZGVVUklDb21wb25lbnQodGhpcy5zaG9ydGNvZGVfKSArICcvbWVkaWEvP3NpemU9bCcpO1xuICAgIGltYWdlLnNldEF0dHJpYnV0ZSgnbGF5b3V0JywgJ2ZpbGwnKTtcbiAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ3JlZmVycmVycG9saWN5JywgJ29yaWdpbicpO1xuXG4gICAgdGhpcy5wcm9wYWdhdGVBdHRyaWJ1dGVzKFsnYWx0J10sIGltYWdlKTtcbiAgICAvKlxuICAgICAqIEFkZCBpbnN0YWdyYW0gZGVmYXVsdCBzdHlsaW5nXG4gICAgICovXG4gICAgaWYgKHRoaXMuZWxlbWVudC5oYXNBdHRyaWJ1dGUoJ2RhdGEtZGVmYXVsdC1mcmFtaW5nJykpIHtcbiAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhbXAtaW5zdGFncmFtLWRlZmF1bHQtZnJhbWluZycpO1xuICAgIH1cblxuICAgIC8vIFRoaXMgbWFrZXMgdGhlIG5vbi1pZnJhbWUgaW1hZ2UgYXBwZWFyIGluIHRoZSBleGFjdCBzYW1lIHNwb3RcbiAgICAvLyB3aGVyZSBpdCB3aWxsIGJlIGluc2lkZSBvZiB0aGUgaWZyYW1lLlxuICAgIHNldFN0eWxlcyhpbWFnZSwge1xuICAgICAgJ3RvcCc6ICcwIHB4JyxcbiAgICAgICdib3R0b20nOiAnMCBweCcsXG4gICAgICAnbGVmdCc6ICcwIHB4JyxcbiAgICAgICdyaWdodCc6ICcwIHB4JyxcbiAgICB9KTtcbiAgICBwbGFjZWhvbGRlci5hcHBlbmRDaGlsZChpbWFnZSk7XG4gICAgcmV0dXJuIHBsYWNlaG9sZGVyO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBpc0xheW91dFN1cHBvcnRlZChsYXlvdXQpIHtcbiAgICByZXR1cm4gaXNMYXlvdXRTaXplRGVmaW5lZChsYXlvdXQpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBsYXlvdXRDYWxsYmFjaygpIHtcbiAgICBjb25zdCBpZnJhbWUgPSB0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgICB0aGlzLmlmcmFtZV8gPSBpZnJhbWU7XG5cbiAgICB0aGlzLnVubGlzdGVuTWVzc2FnZV8gPSBsaXN0ZW4oXG4gICAgICAgIHRoaXMud2luLFxuICAgICAgICAnbWVzc2FnZScsXG4gICAgICAgIHRoaXMuaGFuZGxlSW5zdGFncmFtTWVzc2FnZXNfLmJpbmQodGhpcylcbiAgICApO1xuXG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnc2Nyb2xsaW5nJywgJ25vJyk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnZnJhbWVib3JkZXInLCAnMCcpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2FsbG93dHJhbnNwYXJlbmN5JywgJ3RydWUnKTtcbiAgICAvL0FkZCB0aXRsZSB0byB0aGUgaWZyYW1lIGZvciBiZXR0ZXIgYWNjZXNzaWJpbGl0eS5cbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCd0aXRsZScsICdJbnN0YWdyYW06ICcgK1xuICAgICAgICB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdhbHQnKSk7XG4gICAgaWZyYW1lLnNyYyA9ICdodHRwczovL3d3dy5pbnN0YWdyYW0uY29tL3AvJyArXG4gICAgICAgIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLnNob3J0Y29kZV8pICsgJy9lbWJlZC8nICtcbiAgICAgICAgdGhpcy5jYXB0aW9uZWRfICsgJz9jcj0xJnY9Nyc7XG4gICAgdGhpcy5hcHBseUZpbGxDb250ZW50KGlmcmFtZSk7XG4gICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKGlmcmFtZSk7XG4gICAgc2V0U3R5bGVzKGlmcmFtZSwge1xuICAgICAgJ29wYWNpdHknOiAwLFxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLmlmcmFtZVByb21pc2VfID0gdGhpcy5sb2FkUHJvbWlzZShpZnJhbWUpLnRoZW4oKCkgPT4ge1xuICAgICAgdGhpcy5nZXRWc3luYygpLm11dGF0ZSgoKSA9PiB7XG4gICAgICAgIHNldFN0eWxlcyhpZnJhbWUsIHtcbiAgICAgICAgICAnb3BhY2l0eSc6IDEsXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRXZlbnR9IGV2ZW50XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBoYW5kbGVJbnN0YWdyYW1NZXNzYWdlc18oZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQub3JpZ2luICE9ICdodHRwczovL3d3dy5pbnN0YWdyYW0uY29tJyB8fFxuICAgICAgICBldmVudC5zb3VyY2UgIT0gdGhpcy5pZnJhbWVfLmNvbnRlbnRXaW5kb3cpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZXZlbnREYXRhID0gZ2V0RGF0YShldmVudCk7XG4gICAgaWYgKCFldmVudERhdGEgfHwgIShpc09iamVjdChldmVudERhdGEpXG4gICAgICAgIHx8IHN0YXJ0c1dpdGgoLyoqIEB0eXBlIHtzdHJpbmd9ICovIChldmVudERhdGEpLCAneycpKSkge1xuICAgICAgcmV0dXJuOyAvLyBEb2Vzbid0IGxvb2sgbGlrZSBKU09OLlxuICAgIH1cbiAgICBjb25zdCBkYXRhID0gaXNPYmplY3QoZXZlbnREYXRhKSA/IGV2ZW50RGF0YSA6IHRyeVBhcnNlSnNvbihldmVudERhdGEpO1xuICAgIGlmIChkYXRhID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybjsgLy8gV2Ugb25seSBwcm9jZXNzIHZhbGlkIEpTT04uXG4gICAgfVxuICAgIGlmIChkYXRhWyd0eXBlJ10gPT0gJ01FQVNVUkUnICYmIGRhdGFbJ2RldGFpbHMnXSkge1xuICAgICAgY29uc3QgaGVpZ2h0ID0gZGF0YVsnZGV0YWlscyddWydoZWlnaHQnXTtcbiAgICAgIHRoaXMuZ2V0VnN5bmMoKS5tZWFzdXJlKCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuaWZyYW1lXyAmJiB0aGlzLmlmcmFtZV8uLypPSyovb2Zmc2V0SGVpZ2h0ICE9PSBoZWlnaHQpIHtcbiAgICAgICAgICB0aGlzLi8qT0sqL2NoYW5nZUhlaWdodChoZWlnaHQpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHVubGF5b3V0T25QYXVzZSgpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgdW5sYXlvdXRDYWxsYmFjaygpIHtcbiAgICBpZiAodGhpcy5pZnJhbWVfKSB7XG4gICAgICByZW1vdmVFbGVtZW50KHRoaXMuaWZyYW1lXyk7XG4gICAgICB0aGlzLmlmcmFtZV8gPSBudWxsO1xuICAgICAgdGhpcy5pZnJhbWVQcm9taXNlXyA9IG51bGw7XG4gICAgfVxuICAgIGlmICh0aGlzLnVubGlzdGVuTWVzc2FnZV8pIHtcbiAgICAgIHRoaXMudW5saXN0ZW5NZXNzYWdlXygpO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTsgLy8gQ2FsbCBsYXlvdXRDYWxsYmFjayBhZ2Fpbi5cbiAgfVxufVxuXG5cbkFNUC5leHRlbnNpb24oJ2FtcC1pbnN0YWdyYW0nLCAnMC4xJywgQU1QID0+IHtcbiAgQU1QLnJlZ2lzdGVyRWxlbWVudCgnYW1wLWluc3RhZ3JhbScsIEFtcEluc3RhZ3JhbSwgQ1NTKTtcbn0pO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7RGVmZXJyZWR9IGZyb20gJy4vdXRpbHMvcHJvbWlzZSc7XG5pbXBvcnQge2Nzc0VzY2FwZX0gZnJvbSAnLi4vdGhpcmRfcGFydHkvY3NzLWVzY2FwZS9jc3MtZXNjYXBlJztcbmltcG9ydCB7ZGV2fSBmcm9tICcuL2xvZyc7XG5pbXBvcnQge2RpY3R9IGZyb20gJy4vdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7c3RhcnRzV2l0aH0gZnJvbSAnLi9zdHJpbmcnO1xuaW1wb3J0IHt0b1dpbn0gZnJvbSAnLi90eXBlcyc7XG5cbmNvbnN0IEhUTUxfRVNDQVBFX0NIQVJTID0ge1xuICAnJic6ICcmYW1wOycsXG4gICc8JzogJyZsdDsnLFxuICAnPic6ICcmZ3Q7JyxcbiAgJ1wiJzogJyZxdW90OycsXG4gIFwiJ1wiOiAnJiN4Mjc7JyxcbiAgJ2AnOiAnJiN4NjA7Jyxcbn07XG5jb25zdCBIVE1MX0VTQ0FQRV9SRUdFWCA9IC8oJnw8fD58XCJ8J3xgKS9nO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1BST01JU0UgPVxuICAgICdfX0FNUF9VUEdfUFJNJztcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuZXhwb3J0IGNvbnN0IFVQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9SRVNPTFZFUiA9XG4gICAgJ19fQU1QX1VQR19SRVMnO1xuXG4vKipcbiAqIFdhaXRzIHVudGlsIHRoZSBjaGlsZCBlbGVtZW50IGlzIGNvbnN0cnVjdGVkLiBPbmNlIHRoZSBjaGlsZCBpcyBmb3VuZCwgdGhlXG4gKiBjYWxsYmFjayBpcyBleGVjdXRlZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2hlY2tGdW5jXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGNhbGxiYWNrXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3YWl0Rm9yQ2hpbGQocGFyZW50LCBjaGVja0Z1bmMsIGNhbGxiYWNrKSB7XG4gIGlmIChjaGVja0Z1bmMocGFyZW50KSkge1xuICAgIGNhbGxiYWNrKCk7XG4gICAgcmV0dXJuO1xuICB9XG4gIC8qKiBAY29uc3QgeyFXaW5kb3d9ICovXG4gIGNvbnN0IHdpbiA9IHRvV2luKHBhcmVudC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3KTtcbiAgaWYgKHdpbi5NdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgLyoqIEBjb25zdCB7TXV0YXRpb25PYnNlcnZlcn0gKi9cbiAgICBjb25zdCBvYnNlcnZlciA9IG5ldyB3aW4uTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XG4gICAgICBpZiAoY2hlY2tGdW5jKHBhcmVudCkpIHtcbiAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIG9ic2VydmVyLm9ic2VydmUocGFyZW50LCB7Y2hpbGRMaXN0OiB0cnVlfSk7XG4gIH0gZWxzZSB7XG4gICAgLyoqIEBjb25zdCB7bnVtYmVyfSAqL1xuICAgIGNvbnN0IGludGVydmFsID0gd2luLnNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGlmIChjaGVja0Z1bmMocGFyZW50KSkge1xuICAgICAgICB3aW4uY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICB9XG4gICAgfSwgLyogbWlsbGlzZWNvbmRzICovIDUpO1xuICB9XG59XG5cbi8qKlxuICogV2FpdHMgdW50aWwgdGhlIGNoaWxkIGVsZW1lbnQgaXMgY29uc3RydWN0ZWQuIE9uY2UgdGhlIGNoaWxkIGlzIGZvdW5kLCB0aGVcbiAqIHByb21pc2UgaXMgcmVzb2x2ZWQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IGNoZWNrRnVuY1xuICogQHJldHVybiB7IVByb21pc2V9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3YWl0Rm9yQ2hpbGRQcm9taXNlKHBhcmVudCwgY2hlY2tGdW5jKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICB3YWl0Rm9yQ2hpbGQocGFyZW50LCBjaGVja0Z1bmMsIHJlc29sdmUpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBXYWl0cyBmb3IgZG9jdW1lbnQncyBib2R5IHRvIGJlIGF2YWlsYWJsZS5cbiAqIFdpbGwgYmUgZGVwcmVjYXRlZCBzb29uOyB1c2Uge0BsaW5rIEFtcERvYyN3aGVuQm9keUF2YWlsYWJsZX0gb3JcbiAqIEB7bGluayBEb2N1bWVudFN0YXRlI29uQm9keUF2YWlsYWJsZX0gaW5zdGVhZC5cbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2NcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gY2FsbGJhY2tcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JCb2R5KGRvYywgY2FsbGJhY2spIHtcbiAgd2FpdEZvckNoaWxkKGRvYy5kb2N1bWVudEVsZW1lbnQsICgpID0+ICEhZG9jLmJvZHksIGNhbGxiYWNrKTtcbn1cblxuXG4vKipcbiAqIFdhaXRzIGZvciBkb2N1bWVudCdzIGJvZHkgdG8gYmUgYXZhaWxhYmxlLlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHJldHVybiB7IVByb21pc2V9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3YWl0Rm9yQm9keVByb21pc2UoZG9jKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICB3YWl0Rm9yQm9keShkb2MsIHJlc29sdmUpO1xuICB9KTtcbn1cblxuXG4vKipcbiAqIFJlbW92ZXMgdGhlIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVFbGVtZW50KGVsZW1lbnQpIHtcbiAgaWYgKGVsZW1lbnQucGFyZW50RWxlbWVudCkge1xuICAgIGVsZW1lbnQucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChlbGVtZW50KTtcbiAgfVxufVxuXG5cbi8qKlxuICogUmVtb3ZlcyBhbGwgY2hpbGQgbm9kZXMgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50LlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVDaGlsZHJlbihwYXJlbnQpIHtcbiAgd2hpbGUgKHBhcmVudC5maXJzdENoaWxkKSB7XG4gICAgcGFyZW50LnJlbW92ZUNoaWxkKHBhcmVudC5maXJzdENoaWxkKTtcbiAgfVxufVxuXG5cbi8qKlxuICogQ29waWVzIGFsbCBjaGlsZHJlbiBub2RlcyBvZiBlbGVtZW50IFwiZnJvbVwiIHRvIGVsZW1lbnQgXCJ0b1wiLiBDaGlsZCBub2Rlc1xuICogYXJlIGRlZXBseSBjbG9uZWQuIE5vdGljZSwgdGhhdCB0aGlzIG1ldGhvZCBzaG91bGQgYmUgdXNlZCB3aXRoIGNhcmUgYW5kXG4gKiBwcmVmZXJhYmx5IG9uIHNtYWxsZXIgc3VidHJlZXMuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBmcm9tXG4gKiBAcGFyYW0geyFFbGVtZW50fCFEb2N1bWVudEZyYWdtZW50fSB0b1xuICovXG5leHBvcnQgZnVuY3Rpb24gY29weUNoaWxkcmVuKGZyb20sIHRvKSB7XG4gIGNvbnN0IGZyYWcgPSB0by5vd25lckRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgZm9yIChsZXQgbiA9IGZyb20uZmlyc3RDaGlsZDsgbjsgbiA9IG4ubmV4dFNpYmxpbmcpIHtcbiAgICBmcmFnLmFwcGVuZENoaWxkKG4uY2xvbmVOb2RlKHRydWUpKTtcbiAgfVxuICB0by5hcHBlbmRDaGlsZChmcmFnKTtcbn1cblxuLyoqXG4gKiBJbnNlcnQgdGhlIGVsZW1lbnQgaW4gdGhlIHJvb3QgYWZ0ZXIgdGhlIGVsZW1lbnQgbmFtZWQgYWZ0ZXIgb3JcbiAqIGlmIHRoYXQgaXMgbnVsbCBhdCB0aGUgYmVnaW5uaW5nLlxuICogQHBhcmFtIHshRWxlbWVudHwhU2hhZG93Um9vdH0gcm9vdFxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHs/Tm9kZX0gYWZ0ZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc2VydEFmdGVyT3JBdFN0YXJ0KHJvb3QsIGVsZW1lbnQsIGFmdGVyKSB7XG4gIGNvbnN0IGJlZm9yZSA9IGFmdGVyID8gYWZ0ZXIubmV4dFNpYmxpbmcgOiByb290LmZpcnN0Q2hpbGQ7XG4gIHJvb3QuaW5zZXJ0QmVmb3JlKGVsZW1lbnQsIGJlZm9yZSk7XG59XG5cbi8qKlxuICogQWRkIGF0dHJpYnV0ZXMgdG8gYW4gZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7IUpzb25PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBhdHRyaWJ1dGVzXG4gKiBAcmV0dXJuIHshRWxlbWVudH0gY3JlYXRlZCBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGRBdHRyaWJ1dGVzVG9FbGVtZW50KGVsZW1lbnQsIGF0dHJpYnV0ZXMpIHtcbiAgZm9yIChjb25zdCBhdHRyIGluIGF0dHJpYnV0ZXMpIHtcbiAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShhdHRyLCBhdHRyaWJ1dGVzW2F0dHJdKTtcbiAgfVxuICByZXR1cm4gZWxlbWVudDtcbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBuZXcgZWxlbWVudCBvbiBkb2N1bWVudCB3aXRoIHNwZWNpZmllZCB0YWdOYW1lIGFuZCBhdHRyaWJ1dGVzLlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWVcbiAqIEBwYXJhbSB7IUpzb25PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBhdHRyaWJ1dGVzXG4gKiBAcmV0dXJuIHshRWxlbWVudH0gY3JlYXRlZCBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFbGVtZW50V2l0aEF0dHJpYnV0ZXMoZG9jLCB0YWdOYW1lLCBhdHRyaWJ1dGVzKSB7XG4gIGNvbnN0IGVsZW1lbnQgPSBkb2MuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTtcbiAgcmV0dXJuIGFkZEF0dHJpYnV0ZXNUb0VsZW1lbnQoZWxlbWVudCwgYXR0cmlidXRlcyk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIG5vZGUgaXMgY29ubmVjdGVkIChhdHRhY2hlZCkuXG4gKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHNlZSBodHRwczovL2RvbS5zcGVjLndoYXR3Zy5vcmcvI2Nvbm5lY3RlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNDb25uZWN0ZWROb2RlKG5vZGUpIHtcbiAgY29uc3QgY29ubmVjdGVkID0gbm9kZS5pc0Nvbm5lY3RlZDtcbiAgaWYgKGNvbm5lY3RlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIGNvbm5lY3RlZDtcbiAgfVxuXG4gIC8vIFwiQW4gZWxlbWVudCBpcyBjb25uZWN0ZWQgaWYgaXRzIHNoYWRvdy1pbmNsdWRpbmcgcm9vdCBpcyBhIGRvY3VtZW50LlwiXG4gIGxldCBuID0gbm9kZTtcbiAgZG8ge1xuICAgIG4gPSByb290Tm9kZUZvcihuKTtcbiAgICBpZiAobi5ob3N0KSB7XG4gICAgICBuID0gbi5ob3N0O1xuICAgIH0gZWxzZSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH0gd2hpbGUgKHRydWUpO1xuICByZXR1cm4gbi5ub2RlVHlwZSA9PT0gTm9kZS5ET0NVTUVOVF9OT0RFO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHJvb3QgZm9yIGEgZ2l2ZW4gbm9kZS4gRG9lcyBub3QgY3Jvc3Mgc2hhZG93IERPTSBib3VuZGFyeS5cbiAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAqIEByZXR1cm4geyFOb2RlfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcm9vdE5vZGVGb3Iobm9kZSkge1xuICBpZiAoTm9kZS5wcm90b3R5cGUuZ2V0Um9vdE5vZGUpIHtcbiAgICAvLyBUeXBlIGNoZWNrZXIgc2F5cyBgZ2V0Um9vdE5vZGVgIG1heSByZXR1cm4gbnVsbC5cbiAgICByZXR1cm4gbm9kZS5nZXRSb290Tm9kZSgpIHx8IG5vZGU7XG4gIH1cbiAgbGV0IG47XG4gIGZvciAobiA9IG5vZGU7ICEhbi5wYXJlbnROb2RlOyBuID0gbi5wYXJlbnROb2RlKSB7fVxuICByZXR1cm4gbjtcbn1cblxuLyoqXG4gKiBGaW5kcyB0aGUgY2xvc2VzdCBlbGVtZW50IHRoYXQgc2F0aXNmaWVzIHRoZSBjYWxsYmFjayBmcm9tIHRoaXMgZWxlbWVudFxuICogdXAgdGhlIERPTSBzdWJ0cmVlLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7RWxlbWVudD19IG9wdF9zdG9wQXQgb3B0aW9uYWwgZWxlbW50IHRvIHN0b3AgdGhlIHNlYXJjaCBhdC5cbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VzdChlbGVtZW50LCBjYWxsYmFjaywgb3B0X3N0b3BBdCkge1xuICBmb3IgKGxldCBlbCA9IGVsZW1lbnQ7IGVsICYmIGVsICE9PSBvcHRfc3RvcEF0OyBlbCA9IGVsLnBhcmVudEVsZW1lbnQpIHtcbiAgICBpZiAoY2FsbGJhY2soZWwpKSB7XG4gICAgICByZXR1cm4gZWw7XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGNsb3Nlc3Qgbm9kZSB0aGF0IHNhdGlzZmllcyB0aGUgY2FsbGJhY2sgZnJvbSB0aGlzIG5vZGVcbiAqIHVwIHRoZSBET00gc3VidHJlZS5cbiAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIU5vZGUpOmJvb2xlYW59IGNhbGxiYWNrXG4gKiBAcmV0dXJuIHs/Tm9kZX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsb3Nlc3ROb2RlKG5vZGUsIGNhbGxiYWNrKSB7XG4gIGZvciAobGV0IG4gPSBub2RlOyBuOyBuID0gbi5wYXJlbnROb2RlKSB7XG4gICAgaWYgKGNhbGxiYWNrKG4pKSB7XG4gICAgICByZXR1cm4gbjtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgY2xvc2VzdCBlbGVtZW50IHdpdGggdGhlIHNwZWNpZmllZCBuYW1lIGZyb20gdGhpcyBlbGVtZW50XG4gKiB1cCB0aGUgRE9NIHN1YnRyZWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbG9zZXN0QnlUYWcoZWxlbWVudCwgdGFnTmFtZSkge1xuICBpZiAoZWxlbWVudC5jbG9zZXN0KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQuY2xvc2VzdCh0YWdOYW1lKTtcbiAgfVxuICB0YWdOYW1lID0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xuICByZXR1cm4gY2xvc2VzdChlbGVtZW50LCBlbCA9PiB7XG4gICAgcmV0dXJuIGVsLnRhZ05hbWUgPT0gdGFnTmFtZTtcbiAgfSk7XG59XG5cbi8qKlxuICogRmluZHMgdGhlIGNsb3Nlc3QgZWxlbWVudCB3aXRoIHRoZSBzcGVjaWZpZWQgc2VsZWN0b3IgZnJvbSB0aGlzIGVsZW1lbnRcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBzZWxlY3RvclxuICogQHJldHVybiB7P0VsZW1lbnR9IGNsb3Nlc3QgYW5jZXN0b3IgaWYgZm91bmQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbG9zZXN0QnlTZWxlY3RvcihlbGVtZW50LCBzZWxlY3Rvcikge1xuICBpZiAoZWxlbWVudC5jbG9zZXN0KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQuY2xvc2VzdChzZWxlY3Rvcik7XG4gIH1cblxuICByZXR1cm4gY2xvc2VzdChlbGVtZW50LCBlbCA9PiB7XG4gICAgcmV0dXJuIG1hdGNoZXMoZWwsIHNlbGVjdG9yKTtcbiAgfSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIHRoZSBnaXZlbiBlbGVtZW50IG1hdGNoZXMgdGhlIHNlbGVjdG9yXG4gKiBAcGFyYW0gIHshRWxlbWVudH0gZWwgVGhlIGVsZW1lbnQgdG8gdmVyaWZ5XG4gKiBAcGFyYW0gIHtzdHJpbmd9IHNlbGVjdG9yIFRoZSBzZWxlY3RvciB0byBjaGVjayBhZ2FpbnN0XG4gKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHRoZSBlbGVtZW50IG1hdGNoZWQgdGhlIHNlbGVjdG9yLiBGYWxzZSBvdGhlcndpc2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXRjaGVzKGVsLCBzZWxlY3Rvcikge1xuICBjb25zdCBtYXRjaGVyID0gZWwubWF0Y2hlcyB8fFxuICAgICAgZWwud2Via2l0TWF0Y2hlc1NlbGVjdG9yIHx8XG4gICAgICBlbC5tb3pNYXRjaGVzU2VsZWN0b3IgfHxcbiAgICAgIGVsLm1zTWF0Y2hlc1NlbGVjdG9yIHx8XG4gICAgICBlbC5vTWF0Y2hlc1NlbGVjdG9yO1xuICBpZiAobWF0Y2hlcikge1xuICAgIHJldHVybiBtYXRjaGVyLmNhbGwoZWwsIHNlbGVjdG9yKTtcbiAgfVxuICByZXR1cm4gZmFsc2U7IC8vIElFOCBhbHdheXMgcmV0dXJucyBmYWxzZS5cbn1cblxuLyoqXG4gKiBGaW5kcyB0aGUgZmlyc3QgZGVzY2VuZGFudCBlbGVtZW50IHdpdGggdGhlIHNwZWNpZmllZCBuYW1lLlxuICogQHBhcmFtIHshRWxlbWVudHwhRG9jdW1lbnR8IVNoYWRvd1Jvb3R9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVsZW1lbnRCeVRhZyhlbGVtZW50LCB0YWdOYW1lKSB7XG4gIGxldCBlbGVtZW50cztcbiAgLy8gZ2V0RWxlbWVudHNCeVRhZ05hbWUoKSBpcyBub3Qgc3VwcG9ydGVkIG9uIFNoYWRvd1Jvb3QuXG4gIGlmICh0eXBlb2YgZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGVsZW1lbnRzID0gZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWdOYW1lKTtcbiAgfSBlbHNlIHtcbiAgICBlbGVtZW50cyA9IGVsZW1lbnQuLypPSyovcXVlcnlTZWxlY3RvckFsbCh0YWdOYW1lKTtcbiAgfVxuICByZXR1cm4gKGVsZW1lbnRzICYmIGVsZW1lbnRzWzBdKSB8fCBudWxsO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGZpcnN0IGNoaWxkIGVsZW1lbnQgdGhhdCBzYXRpc2ZpZXMgdGhlIGNhbGxiYWNrLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjYWxsYmFja1xuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnQocGFyZW50LCBjYWxsYmFjaykge1xuICBmb3IgKGxldCBjaGlsZCA9IHBhcmVudC5maXJzdEVsZW1lbnRDaGlsZDsgY2hpbGQ7XG4gICAgY2hpbGQgPSBjaGlsZC5uZXh0RWxlbWVudFNpYmxpbmcpIHtcbiAgICBpZiAoY2FsbGJhY2soY2hpbGQpKSB7XG4gICAgICByZXR1cm4gY2hpbGQ7XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5cbi8qKlxuICogRmluZHMgYWxsIGNoaWxkIGVsZW1lbnRzIHRoYXQgc2F0aXNmeSB0aGUgY2FsbGJhY2suXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IGNhbGxiYWNrXG4gKiBAcmV0dXJuIHshQXJyYXk8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGRFbGVtZW50cyhwYXJlbnQsIGNhbGxiYWNrKSB7XG4gIGNvbnN0IGNoaWxkcmVuID0gW107XG4gIGZvciAobGV0IGNoaWxkID0gcGFyZW50LmZpcnN0RWxlbWVudENoaWxkOyBjaGlsZDtcbiAgICBjaGlsZCA9IGNoaWxkLm5leHRFbGVtZW50U2libGluZykge1xuICAgIGlmIChjYWxsYmFjayhjaGlsZCkpIHtcbiAgICAgIGNoaWxkcmVuLnB1c2goY2hpbGQpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gY2hpbGRyZW47XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgbGFzdCBjaGlsZCBlbGVtZW50IHRoYXQgc2F0aXNmaWVzIHRoZSBjYWxsYmFjay5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGFzdENoaWxkRWxlbWVudChwYXJlbnQsIGNhbGxiYWNrKSB7XG4gIGZvciAobGV0IGNoaWxkID0gcGFyZW50Lmxhc3RFbGVtZW50Q2hpbGQ7IGNoaWxkO1xuICAgIGNoaWxkID0gY2hpbGQucHJldmlvdXNFbGVtZW50U2libGluZykge1xuICAgIGlmIChjYWxsYmFjayhjaGlsZCkpIHtcbiAgICAgIHJldHVybiBjaGlsZDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogRmluZHMgYWxsIGNoaWxkIG5vZGVzIHRoYXQgc2F0aXNmeSB0aGUgY2FsbGJhY2suXG4gKiBUaGVzZSBub2RlcyBjYW4gaW5jbHVkZSBUZXh0LCBDb21tZW50IGFuZCBvdGhlciBjaGlsZCBub2Rlcy5cbiAqIEBwYXJhbSB7IU5vZGV9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighTm9kZSk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEByZXR1cm4geyFBcnJheTwhTm9kZT59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZE5vZGVzKHBhcmVudCwgY2FsbGJhY2spIHtcbiAgY29uc3Qgbm9kZXMgPSBbXTtcbiAgZm9yIChsZXQgY2hpbGQgPSBwYXJlbnQuZmlyc3RDaGlsZDsgY2hpbGQ7XG4gICAgY2hpbGQgPSBjaGlsZC5uZXh0U2libGluZykge1xuICAgIGlmIChjYWxsYmFjayhjaGlsZCkpIHtcbiAgICAgIG5vZGVzLnB1c2goY2hpbGQpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbm9kZXM7XG59XG5cbi8qKlxuICogQHR5cGUge2Jvb2xlYW58dW5kZWZpbmVkfVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmxldCBzY29wZVNlbGVjdG9yU3VwcG9ydGVkO1xuXG4vKipcbiAqIEBwYXJhbSB7Ym9vbGVhbnx1bmRlZmluZWR9IHZhbFxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRTY29wZVNlbGVjdG9yU3VwcG9ydGVkRm9yVGVzdGluZyh2YWwpIHtcbiAgc2NvcGVTZWxlY3RvclN1cHBvcnRlZCA9IHZhbDtcbn1cblxuLyoqXG4gKiBUZXN0IHRoYXQgdGhlIDpzY29wZSBzZWxlY3RvciBpcyBzdXBwb3J0ZWQgYW5kIGJlaGF2ZXMgY29ycmVjdGx5LlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc1Njb3BlU2VsZWN0b3JTdXBwb3J0ZWQocGFyZW50KSB7XG4gIGNvbnN0IGRvYyA9IHBhcmVudC5vd25lckRvY3VtZW50O1xuICB0cnkge1xuICAgIGNvbnN0IHRlc3RFbGVtZW50ID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnN0IHRlc3RDaGlsZCA9IGRvYy5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0ZXN0RWxlbWVudC5hcHBlbmRDaGlsZCh0ZXN0Q2hpbGQpO1xuICAgIC8vIE5PVEUoY3ZpYWxpeiwgIzEyMzgzKTogRmlyZWZveCdzIGltcGxlbWVudGF0aW9uIGlzIGluY29tcGxldGUsXG4gICAgLy8gdGhlcmVmb3JlIHdlIHRlc3QgYWN0dWFsIGZ1bmN0aW9uYWxpdHkgb2ZgOnNjb3BlYCBhcyB3ZWxsLlxuICAgIHJldHVybiB0ZXN0RWxlbWVudC4vKk9LKi9xdWVyeVNlbGVjdG9yKCc6c2NvcGUgZGl2JykgPT09IHRlc3RDaGlsZDtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vKipcbiAqIEZpbmRzIHRoZSBmaXJzdCBjaGlsZCBlbGVtZW50IHRoYXQgaGFzIHRoZSBzcGVjaWZpZWQgYXR0cmlidXRlLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gYXR0clxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnRCeUF0dHIocGFyZW50LCBhdHRyKSB7XG4gIHJldHVybiBzY29wZWRRdWVyeVNlbGVjdG9yLypPSyovKHBhcmVudCwgYD4gWyR7YXR0cn1dYCk7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgbGFzdCBjaGlsZCBlbGVtZW50IHRoYXQgaGFzIHRoZSBzcGVjaWZpZWQgYXR0cmlidXRlLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gYXR0clxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXN0Q2hpbGRFbGVtZW50QnlBdHRyKHBhcmVudCwgYXR0cikge1xuICByZXR1cm4gbGFzdENoaWxkRWxlbWVudChwYXJlbnQsIGVsID0+IHtcbiAgICByZXR1cm4gZWwuaGFzQXR0cmlidXRlKGF0dHIpO1xuICB9KTtcbn1cblxuXG4vKipcbiAqIEZpbmRzIGFsbCBjaGlsZCBlbGVtZW50cyB0aGF0IGhhcyB0aGUgc3BlY2lmaWVkIGF0dHJpYnV0ZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtzdHJpbmd9IGF0dHJcbiAqIEByZXR1cm4geyFOb2RlTGlzdDwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnRzQnlBdHRyKHBhcmVudCwgYXR0cikge1xuICByZXR1cm4gc2NvcGVkUXVlcnlTZWxlY3RvckFsbC8qT0sqLyhwYXJlbnQsIGA+IFske2F0dHJ9XWApO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGZpcnN0IGNoaWxkIGVsZW1lbnQgdGhhdCBoYXMgdGhlIHNwZWNpZmllZCB0YWcgbmFtZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWVcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGRFbGVtZW50QnlUYWcocGFyZW50LCB0YWdOYW1lKSB7XG4gIHJldHVybiBzY29wZWRRdWVyeVNlbGVjdG9yLypPSyovKHBhcmVudCwgYD4gJHt0YWdOYW1lfWApO1xufVxuXG5cbi8qKlxuICogRmluZHMgYWxsIGNoaWxkIGVsZW1lbnRzIHdpdGggdGhlIHNwZWNpZmllZCB0YWcgbmFtZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWVcbiAqIEByZXR1cm4geyFOb2RlTGlzdDwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnRzQnlUYWcocGFyZW50LCB0YWdOYW1lKSB7XG4gIHJldHVybiBzY29wZWRRdWVyeVNlbGVjdG9yQWxsLypPSyovKHBhcmVudCwgYD4gJHt0YWdOYW1lfWApO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGZpcnN0IGVsZW1lbnQgdGhhdCBtYXRjaGVzIGBzZWxlY3RvcmAsIHNjb3BlZCBpbnNpZGUgYHJvb3RgLlxuICogTm90ZTogaW4gSUUsIHRoaXMgY2F1c2VzIGEgcXVpY2sgbXV0YXRpb24gb2YgdGhlIGVsZW1lbnQncyBjbGFzcyBsaXN0LlxuICogQHBhcmFtIHshRWxlbWVudH0gcm9vdFxuICogQHBhcmFtIHtzdHJpbmd9IHNlbGVjdG9yXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNjb3BlZFF1ZXJ5U2VsZWN0b3Iocm9vdCwgc2VsZWN0b3IpIHtcbiAgaWYgKHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQgPT0gbnVsbCkge1xuICAgIHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQgPSBpc1Njb3BlU2VsZWN0b3JTdXBwb3J0ZWQocm9vdCk7XG4gIH1cbiAgaWYgKHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQpIHtcbiAgICByZXR1cm4gcm9vdC4vKk9LKi9xdWVyeVNlbGVjdG9yKGA6c2NvcGUgJHtzZWxlY3Rvcn1gKTtcbiAgfVxuXG4gIC8vIE9ubHkgSUUuXG4gIGNvbnN0IHVuaXF1ZSA9ICdpLWFtcGh0bWwtc2NvcGVkJztcbiAgcm9vdC5jbGFzc0xpc3QuYWRkKHVuaXF1ZSk7XG4gIGNvbnN0IGVsZW1lbnQgPSByb290Li8qT0sqL3F1ZXJ5U2VsZWN0b3IoYC4ke3VuaXF1ZX0gJHtzZWxlY3Rvcn1gKTtcbiAgcm9vdC5jbGFzc0xpc3QucmVtb3ZlKHVuaXF1ZSk7XG4gIHJldHVybiBlbGVtZW50O1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGV2ZXJ5IGVsZW1lbnQgdGhhdCBtYXRjaGVzIGBzZWxlY3RvcmAsIHNjb3BlZCBpbnNpZGUgYHJvb3RgLlxuICogTm90ZTogaW4gSUUsIHRoaXMgY2F1c2VzIGEgcXVpY2sgbXV0YXRpb24gb2YgdGhlIGVsZW1lbnQncyBjbGFzcyBsaXN0LlxuICogQHBhcmFtIHshRWxlbWVudH0gcm9vdFxuICogQHBhcmFtIHtzdHJpbmd9IHNlbGVjdG9yXG4gKiBAcmV0dXJuIHshTm9kZUxpc3Q8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2NvcGVkUXVlcnlTZWxlY3RvckFsbChyb290LCBzZWxlY3Rvcikge1xuICBpZiAoc2NvcGVTZWxlY3RvclN1cHBvcnRlZCA9PSBudWxsKSB7XG4gICAgc2NvcGVTZWxlY3RvclN1cHBvcnRlZCA9IGlzU2NvcGVTZWxlY3RvclN1cHBvcnRlZChyb290KTtcbiAgfVxuICBpZiAoc2NvcGVTZWxlY3RvclN1cHBvcnRlZCkge1xuICAgIHJldHVybiByb290Li8qT0sqL3F1ZXJ5U2VsZWN0b3JBbGwoYDpzY29wZSAke3NlbGVjdG9yfWApO1xuICB9XG5cbiAgLy8gT25seSBJRS5cbiAgY29uc3QgdW5pcXVlID0gJ2ktYW1waHRtbC1zY29wZWQnO1xuICByb290LmNsYXNzTGlzdC5hZGQodW5pcXVlKTtcbiAgY29uc3QgZWxlbWVudHMgPSByb290Li8qT0sqL3F1ZXJ5U2VsZWN0b3JBbGwoYC4ke3VuaXF1ZX0gJHtzZWxlY3Rvcn1gKTtcbiAgcm9vdC5jbGFzc0xpc3QucmVtb3ZlKHVuaXF1ZSk7XG4gIHJldHVybiBlbGVtZW50cztcbn1cblxuXG4vKipcbiAqIFJldHVybnMgZWxlbWVudCBkYXRhLXBhcmFtLSBhdHRyaWJ1dGVzIGFzIHVybCBwYXJhbWV0ZXJzIGtleS12YWx1ZSBwYWlycy5cbiAqIGUuZy4gZGF0YS1wYXJhbS1zb21lLWF0dHI9dmFsdWUgLT4ge3NvbWVBdHRyOiB2YWx1ZX0uXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKHN0cmluZyk6c3RyaW5nPX0gb3B0X2NvbXB1dGVQYXJhbU5hbWVGdW5jIHRvIGNvbXB1dGUgdGhlXG4gKiAgICBwYXJhbWV0ZXIgbmFtZSwgZ2V0IHBhc3NlZCB0aGUgY2FtZWwtY2FzZSBwYXJhbWV0ZXIgbmFtZS5cbiAqIEBwYXJhbSB7IVJlZ0V4cD19IG9wdF9wYXJhbVBhdHRlcm4gUmVnZXggcGF0dGVybiB0byBtYXRjaCBkYXRhIGF0dHJpYnV0ZXMuXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldERhdGFQYXJhbXNGcm9tQXR0cmlidXRlcyhlbGVtZW50LCBvcHRfY29tcHV0ZVBhcmFtTmFtZUZ1bmMsXG4gIG9wdF9wYXJhbVBhdHRlcm4pIHtcbiAgY29uc3QgY29tcHV0ZVBhcmFtTmFtZUZ1bmMgPSBvcHRfY29tcHV0ZVBhcmFtTmFtZUZ1bmMgfHwgKGtleSA9PiBrZXkpO1xuICBjb25zdCB7ZGF0YXNldH0gPSBlbGVtZW50O1xuICBjb25zdCBwYXJhbXMgPSBkaWN0KCk7XG4gIGNvbnN0IHBhcmFtUGF0dGVybiA9IG9wdF9wYXJhbVBhdHRlcm4gPyBvcHRfcGFyYW1QYXR0ZXJuIDogL15wYXJhbSguKykvO1xuICBmb3IgKGNvbnN0IGtleSBpbiBkYXRhc2V0KSB7XG4gICAgY29uc3QgbWF0Y2hlcyA9IGtleS5tYXRjaChwYXJhbVBhdHRlcm4pO1xuICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICBjb25zdCBwYXJhbSA9IG1hdGNoZXNbMV1bMF0udG9Mb3dlckNhc2UoKSArIG1hdGNoZXNbMV0uc3Vic3RyKDEpO1xuICAgICAgcGFyYW1zW2NvbXB1dGVQYXJhbU5hbWVGdW5jKHBhcmFtKV0gPSBkYXRhc2V0W2tleV07XG4gICAgfVxuICB9XG4gIHJldHVybiBwYXJhbXM7XG59XG5cbi8qKlxuICogV2hldGhlciB0aGUgZWxlbWVudCBoYXZlIGEgbmV4dCBub2RlIGluIHRoZSBkb2N1bWVudCBvcmRlci5cbiAqIFRoaXMgbWVhbnMgZWl0aGVyOlxuICogIGEuIFRoZSBlbGVtZW50IGl0c2VsZiBoYXMgYSBuZXh0U2libGluZy5cbiAqICBiLiBBbnkgb2YgdGhlIGVsZW1lbnQgYW5jZXN0b3JzIGhhcyBhIG5leHRTaWJsaW5nLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHs/Tm9kZX0gb3B0X3N0b3BOb2RlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzTmV4dE5vZGVJbkRvY3VtZW50T3JkZXIoZWxlbWVudCwgb3B0X3N0b3BOb2RlKSB7XG4gIGxldCBjdXJyZW50RWxlbWVudCA9IGVsZW1lbnQ7XG4gIGRvIHtcbiAgICBpZiAoY3VycmVudEVsZW1lbnQubmV4dFNpYmxpbmcpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfSB3aGlsZSAoKGN1cnJlbnRFbGVtZW50ID0gY3VycmVudEVsZW1lbnQucGFyZW50Tm9kZSkgJiZcbiAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50ICE9IG9wdF9zdG9wTm9kZSk7XG4gIHJldHVybiBmYWxzZTtcbn1cblxuXG4vKipcbiAqIEZpbmRzIGFsbCBhbmNlc3RvciBlbGVtZW50cyB0aGF0IHNhdGlzZnkgcHJlZGljYXRlLlxuICogQHBhcmFtIHshRWxlbWVudH0gY2hpbGRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IHByZWRpY2F0ZVxuICogQHJldHVybiB7IUFycmF5PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFuY2VzdG9yRWxlbWVudHMoY2hpbGQsIHByZWRpY2F0ZSkge1xuICBjb25zdCBhbmNlc3RvcnMgPSBbXTtcbiAgZm9yIChsZXQgYW5jZXN0b3IgPSBjaGlsZC5wYXJlbnRFbGVtZW50OyBhbmNlc3RvcjtcbiAgICBhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudEVsZW1lbnQpIHtcbiAgICBpZiAocHJlZGljYXRlKGFuY2VzdG9yKSkge1xuICAgICAgYW5jZXN0b3JzLnB1c2goYW5jZXN0b3IpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gYW5jZXN0b3JzO1xufVxuXG5cbi8qKlxuICogRmluZHMgYWxsIGFuY2VzdG9yIGVsZW1lbnRzIHRoYXQgaGFzIHRoZSBzcGVjaWZpZWQgdGFnIG5hbWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBjaGlsZFxuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWVcbiAqIEByZXR1cm4geyFBcnJheTwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhbmNlc3RvckVsZW1lbnRzQnlUYWcoY2hpbGQsIHRhZ05hbWUpIHtcbiAgdGFnTmFtZSA9IHRhZ05hbWUudG9VcHBlckNhc2UoKTtcbiAgcmV0dXJuIGFuY2VzdG9yRWxlbWVudHMoY2hpbGQsIGVsID0+IHtcbiAgICByZXR1cm4gZWwudGFnTmFtZSA9PSB0YWdOYW1lO1xuICB9KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgY2xvbmUgb2YgdGhlIGNvbnRlbnQgb2YgYSB0ZW1wbGF0ZSBlbGVtZW50LlxuICpcbiAqIFBvbHlmaWxsIHRvIHJlcGxhY2UgLmNvbnRlbnQgYWNjZXNzIGZvciBicm93c2VycyB0aGF0IGRvIG5vdCBzdXBwb3J0XG4gKiBIVE1MVGVtcGxhdGVFbGVtZW50cyBuYXRpdmVseS5cbiAqXG4gKiBAcGFyYW0geyFIVE1MVGVtcGxhdGVFbGVtZW50fCFFbGVtZW50fSB0ZW1wbGF0ZVxuICogQHJldHVybiB7IURvY3VtZW50RnJhZ21lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0ZW1wbGF0ZUNvbnRlbnRDbG9uZSh0ZW1wbGF0ZSkge1xuICBpZiAoJ2NvbnRlbnQnIGluIHRlbXBsYXRlKSB7XG4gICAgcmV0dXJuIHRlbXBsYXRlLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGNvbnRlbnQgPSB0ZW1wbGF0ZS5vd25lckRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICBjb3B5Q2hpbGRyZW4odGVtcGxhdGUsIGNvbnRlbnQpO1xuICAgIHJldHVybiBjb250ZW50O1xuICB9XG59XG5cbi8qKlxuICogSXRlcmF0ZSBvdmVyIGFuIGFycmF5LWxpa2UuIFNvbWUgY29sbGVjdGlvbnMgbGlrZSBOb2RlTGlzdCBhcmVcbiAqIGxhemlseSBldmFsdWF0ZWQgaW4gc29tZSBicm93c2VycywgYW5kIGFjY2Vzc2luZyBgbGVuZ3RoYCBmb3JjZXMgZnVsbFxuICogZXZhbHVhdGlvbi4gV2UgY2FuIGltcHJvdmUgcGVyZm9ybWFuY2UgYnkgaXRlcmF0aW5nIHVudGlsIGFuIGVsZW1lbnQgaXNcbiAqIGB1bmRlZmluZWRgIHRvIGF2b2lkIGNoZWNraW5nIHRoZSBgbGVuZ3RoYCBwcm9wZXJ0eS5cbiAqIFRlc3QgY2FzZXM6IGh0dHBzOi8vanNwZXJmLmNvbS9pdGVyYXRpbmctb3Zlci1jb2xsZWN0aW9ucy1vZi1lbGVtZW50c1xuICogQHBhcmFtIHshSUFycmF5TGlrZTxUPn0gaXRlcmFibGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oVCwgbnVtYmVyKX0gY2JcbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpdGVyYXRlQ3Vyc29yKGl0ZXJhYmxlLCBjYikge1xuICBmb3IgKGxldCBpID0gMCwgdmFsdWU7ICh2YWx1ZSA9IGl0ZXJhYmxlW2ldKSAhPT0gdW5kZWZpbmVkOyBpKyspIHtcbiAgICBjYih2YWx1ZSwgaSk7XG4gIH1cbn1cblxuLyoqXG4gKiBUaGlzIG1ldGhvZCB3cmFwcyBhcm91bmQgd2luZG93J3Mgb3BlbiBtZXRob2QuIEl0IGZpcnN0IHRyaWVzIHRvIGV4ZWN1dGVcbiAqIGBvcGVuYCBjYWxsIHdpdGggdGhlIHByb3ZpZGVkIHRhcmdldCBhbmQgaWYgaXQgZmFpbHMsIGl0IHJldHJpZXMgdGhlIGNhbGxcbiAqIHdpdGggdGhlIGBfdG9wYCB0YXJnZXQuIFRoaXMgaXMgbmVjZXNzYXJ5IGdpdmVuIHRoYXQgaW4gc29tZSBlbWJlZGRpbmdcbiAqIHNjZW5hcmlvcywgc3VjaCBhcyBpT1MnIFdLV2ViVmlldywgbmF2aWdhdGlvbiB0byBgX2JsYW5rYCBhbmQgb3RoZXIgdGFyZ2V0c1xuICogaXMgYmxvY2tlZCBieSBkZWZhdWx0LlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFyZ2V0XG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF9mZWF0dXJlc1xuICogQHJldHVybiB7P1dpbmRvd31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9wZW5XaW5kb3dEaWFsb2cod2luLCB1cmwsIHRhcmdldCwgb3B0X2ZlYXR1cmVzKSB7XG4gIC8vIFRyeSBmaXJzdCB3aXRoIHRoZSBzcGVjaWZpZWQgdGFyZ2V0LiBJZiB3ZSdyZSBpbnNpZGUgdGhlIFdLV2ViVmlldyBvclxuICAvLyBhIHNpbWlsYXIgZW52aXJvbm1lbnRzLCB0aGlzIG1ldGhvZCBpcyBleHBlY3RlZCB0byBmYWlsIGJ5IGRlZmF1bHQgZm9yXG4gIC8vIGFsbCB0YXJnZXRzIGV4Y2VwdCBgX3RvcGAuXG4gIGxldCByZXM7XG4gIHRyeSB7XG4gICAgcmVzID0gd2luLm9wZW4odXJsLCB0YXJnZXQsIG9wdF9mZWF0dXJlcyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBkZXYoKS5lcnJvcignRE9NJywgJ0ZhaWxlZCB0byBvcGVuIHVybCBvbiB0YXJnZXQ6ICcsIHRhcmdldCwgZSk7XG4gIH1cblxuICAvLyBUaGVuIHRyeSB3aXRoIGBfdG9wYCB0YXJnZXQuXG4gIGlmICghcmVzICYmIHRhcmdldCAhPSAnX3RvcCcpIHtcbiAgICByZXMgPSB3aW4ub3Blbih1cmwsICdfdG9wJyk7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBlbGVtZW50IGlzIGEgc2NyaXB0IHRhZyB3aXRoIGFwcGxpY2F0aW9uL2pzb24gdHlwZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0pzb25TY3JpcHRUYWcoZWxlbWVudCkge1xuICByZXR1cm4gZWxlbWVudC50YWdOYW1lID09ICdTQ1JJUFQnICYmXG4gICAgICAgICAgICBlbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpLnRvVXBwZXJDYXNlKCkgPT0gJ0FQUExJQ0FUSU9OL0pTT04nO1xufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGVsZW1lbnQgaXMgYSBzY3JpcHQgdGFnIHdpdGggYXBwbGljYXRpb24vanNvbiB0eXBlLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzSnNvbkxkU2NyaXB0VGFnKGVsZW1lbnQpIHtcbiAgcmV0dXJuIGVsZW1lbnQudGFnTmFtZSA9PSAnU0NSSVBUJyAmJlxuICAgICAgZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKS50b1VwcGVyQ2FzZSgpID09ICdBUFBMSUNBVElPTi9MRCtKU09OJztcbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBwYWdlJ3MgZGlyZWN0aW9uIGlzIHJpZ2h0IHRvIGxlZnQgb3Igbm90LlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzUlRMKGRvYykge1xuICBjb25zdCBkaXIgPSBkb2MuYm9keS5nZXRBdHRyaWJ1dGUoJ2RpcicpXG4gICAgICAgICAgICAgICAgIHx8IGRvYy5kb2N1bWVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkaXInKVxuICAgICAgICAgICAgICAgICB8fCAnbHRyJztcbiAgcmV0dXJuIGRpciA9PSAncnRsJztcbn1cblxuXG4vKipcbiAqIEVzY2FwZXMgYW4gaWRlbnQgKElEIG9yIGEgY2xhc3MgbmFtZSkgdG8gYmUgdXNlZCBhcyBhIENTUyBzZWxlY3Rvci5cbiAqXG4gKiBTZWUgaHR0cHM6Ly9kcmFmdHMuY3Nzd2cub3JnL2Nzc29tLyNzZXJpYWxpemUtYW4taWRlbnRpZmllci5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRlbnRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVzY2FwZUNzc1NlbGVjdG9ySWRlbnQoaWRlbnQpIHtcbiAgcmV0dXJuIGNzc0VzY2FwZShpZGVudCk7XG59XG5cbi8qKlxuICogRXNjYXBlcyBhbiBpZGVudCBpbiBhIHdheSB0aGF0IGNhbiBiZSB1c2VkIGJ5IDpudGgtY2hpbGQoKSBwc3VlZG8tY2xhc3MuXG4gKlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS93M2MvY3Nzd2ctZHJhZnRzL2lzc3Vlcy8yMzA2LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gaWRlbnRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVzY2FwZUNzc1NlbGVjdG9yTnRoKGlkZW50KSB7XG4gIGNvbnN0IGVzY2FwZWQgPSBTdHJpbmcoaWRlbnQpO1xuICAvLyBFbnN1cmUgaXQgZG9lc24ndCBjbG9zZSB0aGUgbnRoLWNoaWxkIHBzdWVkbyBjbGFzcy5cbiAgZGV2KCkuYXNzZXJ0KGVzY2FwZWQuaW5kZXhPZignKScpID09PSAtMSk7XG4gIHJldHVybiBlc2NhcGVkO1xufVxuXG4vKipcbiAqIEVzY2FwZXMgYDxgLCBgPmAgYW5kIG90aGVyIEhUTUwgY2hhcmNhdGVycyB3aXRoIHRoZWlyIGVzY2FwZWQgZm9ybXMuXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXNjYXBlSHRtbCh0ZXh0KSB7XG4gIGlmICghdGV4dCkge1xuICAgIHJldHVybiB0ZXh0O1xuICB9XG4gIHJldHVybiB0ZXh0LnJlcGxhY2UoSFRNTF9FU0NBUEVfUkVHRVgsIGVzY2FwZUh0bWxDaGFyKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gY1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBlc2NhcGVIdG1sQ2hhcihjKSB7XG4gIHJldHVybiBIVE1MX0VTQ0FQRV9DSEFSU1tjXTtcbn1cblxuLyoqXG4gKiBUcmllcyB0byBmb2N1cyBvbiB0aGUgZ2l2ZW4gZWxlbWVudDsgZmFpbHMgc2lsZW50bHkgaWYgYnJvd3NlciB0aHJvd3MgYW5cbiAqIGV4Y2VwdGlvbi5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyeUZvY3VzKGVsZW1lbnQpIHtcbiAgdHJ5IHtcbiAgICBlbGVtZW50Li8qT0sqL2ZvY3VzKCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBJRSA8PSA3IG1heSB0aHJvdyBleGNlcHRpb25zIHdoZW4gZm9jdXNpbmcgb24gaGlkZGVuIGl0ZW1zLlxuICB9XG59XG5cbi8qKlxuICogV2hldGhlciB0aGUgZ2l2ZW4gd2luZG93IGlzIGluIGFuIGlmcmFtZSBvciBub3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzSWZyYW1lZCh3aW4pIHtcbiAgcmV0dXJuIHdpbi5wYXJlbnQgJiYgd2luLnBhcmVudCAhPSB3aW47XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lcyBpZiB0aGlzIGVsZW1lbnQgaXMgYW4gQU1QIGVsZW1lbnRcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0FtcEVsZW1lbnQoZWxlbWVudCkge1xuICBjb25zdCB0YWcgPSBlbGVtZW50LnRhZ05hbWU7XG4gIC8vIFVzZSBwcmVmaXggdG8gcmVjb2duaXplIEFNUCBlbGVtZW50LiBUaGlzIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHN0dWJcbiAgLy8gbWF5IG5vdCBiZSBhdHRhY2hlZCB5ZXQuXG4gIHJldHVybiBzdGFydHNXaXRoKHRhZywgJ0FNUC0nKSAmJlxuICAgICAgLy8gU29tZSBcImFtcC0qXCIgZWxlbWVudHMgYXJlIG5vdCByZWFsbHkgQU1QIGVsZW1lbnRzLiA6c21oOlxuICAgICAgISh0YWcgPT0gJ0FNUC1TVElDS1ktQUQtVE9QLVBBRERJTkcnIHx8IHRhZyA9PSAnQU1QLUJPRFknKTtcbn1cblxuLyoqXG4gKiBSZXR1cm4gYSBwcm9taXNlIHRoYXQgcmVzb2x2ZSB3aGVuIGFuIEFNUCBlbGVtZW50IHVwZ3JhZGUgZnJvbSBIVE1MRWxlbWVudFxuICogdG8gQ3VzdG9tRWxlbWVudFxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7IVByb21pc2U8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gd2hlblVwZ3JhZGVkVG9DdXN0b21FbGVtZW50KGVsZW1lbnQpIHtcbiAgZGV2KCkuYXNzZXJ0KGlzQW1wRWxlbWVudChlbGVtZW50KSwgJ2VsZW1lbnQgaXMgbm90IEFtcEVsZW1lbnQnKTtcbiAgaWYgKGVsZW1lbnQuY3JlYXRlZENhbGxiYWNrKSB7XG4gICAgLy8gRWxlbWVudCBhbHJlYWR5IGlzIEN1c3RvbUVsZW1lbnQ7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShlbGVtZW50KTtcbiAgfVxuICAvLyBJZiBFbGVtZW50IGlzIHN0aWxsIEhUTUxFbGVtZW50LCB3YWl0IGZvciBpdCB0byB1cGdyYWRlIHRvIGN1c3RvbUVsZW1lbnRcbiAgLy8gTm90ZTogdXNlIHB1cmUgc3RyaW5nIHRvIGF2b2lkIG9iZnVzY2F0aW9uIGJldHdlZW4gdmVyc2lvbnMuXG4gIGlmICghZWxlbWVudFtVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUFJPTUlTRV0pIHtcbiAgICBjb25zdCBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgIGVsZW1lbnRbVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1BST01JU0VdID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICBlbGVtZW50W1VQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9SRVNPTFZFUl0gPSBkZWZlcnJlZC5yZXNvbHZlO1xuXG4gIH1cblxuICByZXR1cm4gZWxlbWVudFtVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUFJPTUlTRV07XG59XG5cbi8qKlxuICogUmVwbGFjZW1lbnQgZm9yIGBFbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKClgIG1ldGhvZC5cbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9FbGVtZW50L3JlcXVlc3RGdWxsc2NyZWVuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmdWxsc2NyZWVuRW50ZXIoZWxlbWVudCkge1xuICBjb25zdCByZXF1ZXN0RnMgPSBlbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuXG4gICB8fCBlbGVtZW50LnJlcXVlc3RGdWxsU2NyZWVuXG4gICB8fCBlbGVtZW50LndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuXG4gICB8fCBlbGVtZW50LndlYmtpdFJlcXVlc3RGdWxsU2NyZWVuXG4gICB8fCBlbGVtZW50LndlYmtpdEVudGVyRnVsbHNjcmVlblxuICAgfHwgZWxlbWVudC53ZWJraXRFbnRlckZ1bGxTY3JlZW5cbiAgIHx8IGVsZW1lbnQubXNSZXF1ZXN0RnVsbHNjcmVlblxuICAgfHwgZWxlbWVudC5tc1JlcXVlc3RGdWxsU2NyZWVuXG4gICB8fCBlbGVtZW50Lm1velJlcXVlc3RGdWxsc2NyZWVuXG4gICB8fCBlbGVtZW50Lm1velJlcXVlc3RGdWxsU2NyZWVuO1xuICBpZiAocmVxdWVzdEZzKSB7XG4gICAgcmVxdWVzdEZzLmNhbGwoZWxlbWVudCk7XG4gIH1cbn1cblxuLyoqXG4gKiBSZXBsYWNlbWVudCBmb3IgYERvY3VtZW50LmV4aXRGdWxsc2NyZWVuKClgIG1ldGhvZC5cbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9Eb2N1bWVudC9leGl0RnVsbHNjcmVlblxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gZnVsbHNjcmVlbkV4aXQoZWxlbWVudCkge1xuICBsZXQgZXhpdEZzID0gZWxlbWVudC5jYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC5leGl0RnVsbHNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQuZXhpdEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50LndlYmtpdEV4aXRGdWxsc2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC53ZWJraXRFeGl0RnVsbFNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQud2Via2l0Q2FuY2VsRnVsbFNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQubW96Q2FuY2VsRnVsbFNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQubXNFeGl0RnVsbHNjcmVlbjtcbiAgaWYgKGV4aXRGcykge1xuICAgIGV4aXRGcy5jYWxsKGVsZW1lbnQpO1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoZWxlbWVudC5vd25lckRvY3VtZW50KSB7XG4gICAgZXhpdEZzID0gZWxlbWVudC5vd25lckRvY3VtZW50LmNhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQuZXhpdEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQud2Via2l0RXhpdEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQud2Via2l0Q2FuY2VsRnVsbFNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC5tb3pDYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50Lm1zRXhpdEZ1bGxzY3JlZW47XG4gIH1cbiAgaWYgKGV4aXRGcykge1xuICAgIGV4aXRGcy5jYWxsKGVsZW1lbnQub3duZXJEb2N1bWVudCk7XG4gICAgcmV0dXJuO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZXBsYWNlbWVudCBmb3IgYERvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50YC5cbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9Eb2N1bWVudC9mdWxsc2NyZWVuRWxlbWVudFxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRnVsbHNjcmVlbkVsZW1lbnQoZWxlbWVudCkge1xuICBjb25zdCBpc0Z1bGxzY3JlZW4gPSBlbGVtZW50LndlYmtpdERpc3BsYXlpbmdGdWxsc2NyZWVuO1xuICBpZiAoaXNGdWxsc2NyZWVuKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgaWYgKGVsZW1lbnQub3duZXJEb2N1bWVudCkge1xuICAgIGNvbnN0IGZ1bGxzY3JlZW5FbGVtZW50ID0gZWxlbWVudC5vd25lckRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50XG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50LndlYmtpdEZ1bGxzY3JlZW5FbGVtZW50XG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50Lm1vekZ1bGxTY3JlZW5FbGVtZW50XG4gICAgICAgICAgICAgfHwgZWxlbWVudC53ZWJraXRDdXJyZW50RnVsbFNjcmVlbkVsZW1lbnQ7XG4gICAgaWYgKGZ1bGxzY3JlZW5FbGVtZW50ID09IGVsZW1lbnQpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIG5vZGUgaXMgbm90IGRpc2FibGVkLlxuICpcbiAqIElFOCBjYW4gcmV0dXJuIGZhbHNlIHBvc2l0aXZlcywgc2VlIHtAbGluayBtYXRjaGVzfS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAc2VlIGh0dHBzOi8vd3d3LnczLm9yZy9UUi9odG1sNS9mb3Jtcy5odG1sI2NvbmNlcHQtZmUtZGlzYWJsZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRW5hYmxlZChlbGVtZW50KSB7XG4gIHJldHVybiAhKGVsZW1lbnQuZGlzYWJsZWQgfHwgbWF0Y2hlcyhlbGVtZW50LCAnOmRpc2FibGVkJykpO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICAqIFdoZXRoZXIgYWRkRXZlbnRMaXN0ZW5lciBzdXBwb3J0cyBvcHRpb25zIG9yIG9ubHkgdGFrZXMgY2FwdHVyZSBhcyBhIGJvb2xlYW5cbiAgKiBAdHlwZSB7Ym9vbGVhbnx1bmRlZmluZWR9XG4gICogQHZpc2libGVGb3JUZXN0aW5nXG4gICovXG5sZXQgb3B0c1N1cHBvcnRlZDtcblxuLyoqXG4gKiBMaXN0ZW5zIGZvciB0aGUgc3BlY2lmaWVkIGV2ZW50IG9uIHRoZSBlbGVtZW50LlxuICpcbiAqIERvIG5vdCB1c2UgdGhpcyBkaXJlY3RseS4gVGhpcyBtZXRob2QgaXMgaW1wbGVtZW50ZWQgYXMgYSBzaGFyZWRcbiAqIGRlcGVuZGVuY3kuIFVzZSBgbGlzdGVuKClgIGluIGVpdGhlciBgZXZlbnQtaGVscGVyYCBvciBgM3AtZnJhbWUtbWVzc2FnaW5nYCxcbiAqIGRlcGVuZGluZyBvbiB5b3VyIHVzZSBjYXNlLlxuICpcbiAqIEBwYXJhbSB7IUV2ZW50VGFyZ2V0fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFdmVudCl9IGxpc3RlbmVyXG4gKiBAcGFyYW0ge09iamVjdD19IG9wdF9ldnRMaXN0ZW5lck9wdHNcbiAqIEByZXR1cm4geyFVbmxpc3RlbkRlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGludGVybmFsTGlzdGVuSW1wbGVtZW50YXRpb24oZWxlbWVudCwgZXZlbnRUeXBlLCBsaXN0ZW5lcixcbiAgb3B0X2V2dExpc3RlbmVyT3B0cykge1xuICBsZXQgbG9jYWxFbGVtZW50ID0gZWxlbWVudDtcbiAgbGV0IGxvY2FsTGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgLyoqXG4gICAqIEB0eXBlIHs/RnVuY3Rpb259XG4gICAqL1xuICBsZXQgd3JhcHBlZDtcblxuICB3cmFwcGVkID0gZXZlbnQgPT4ge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gbG9jYWxMaXN0ZW5lcihldmVudCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gcmVwb3J0RXJyb3IgaXMgaW5zdGFsbGVkIGdsb2JhbGx5IHBlciB3aW5kb3cgaW4gdGhlIGVudHJ5IHBvaW50LlxuICAgICAgc2VsZi5yZXBvcnRFcnJvcihlKTtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuICB9O1xuICBjb25zdCBvcHRzU3VwcG9ydGVkID0gZGV0ZWN0RXZ0TGlzdGVuZXJPcHRzU3VwcG9ydCgpO1xuICBsZXQgY2FwdHVyZSA9IGZhbHNlO1xuICBpZiAob3B0X2V2dExpc3RlbmVyT3B0cykge1xuICAgIGNhcHR1cmUgPSBvcHRfZXZ0TGlzdGVuZXJPcHRzLmNhcHR1cmU7XG4gIH1cbiAgbG9jYWxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICBldmVudFR5cGUsXG4gICAgICB3cmFwcGVkLFxuICAgICAgb3B0c1N1cHBvcnRlZCA/IG9wdF9ldnRMaXN0ZW5lck9wdHMgOiBjYXB0dXJlXG4gICk7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgaWYgKGxvY2FsRWxlbWVudCkge1xuICAgICAgbG9jYWxFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgZXZlbnRUeXBlLFxuICAgICAgICAgIHdyYXBwZWQsXG4gICAgICAgICAgb3B0c1N1cHBvcnRlZCA/IG9wdF9ldnRMaXN0ZW5lck9wdHMgOiBjYXB0dXJlXG4gICAgICApO1xuICAgIH1cbiAgICAvLyBFbnN1cmUgdGhlc2UgYXJlIEdDJ2RcbiAgICBsb2NhbExpc3RlbmVyID0gbnVsbDtcbiAgICBsb2NhbEVsZW1lbnQgPSBudWxsO1xuICAgIHdyYXBwZWQgPSBudWxsO1xuICB9O1xufVxuXG4vKipcbiAqIFRlc3RzIHdoZXRoZXIgdGhlIGJyb3dzZXIgc3VwcG9ydHMgb3B0aW9ucyBhcyBhbiBhcmd1bWVudCBvZiBhZGRFdmVudExpc3RlbmVyXG4gKiBvciBub3QuXG4gKlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRldGVjdEV2dExpc3RlbmVyT3B0c1N1cHBvcnQoKSB7XG4gIC8vIE9ubHkgcnVuIHRoZSB0ZXN0IG9uY2VcbiAgaWYgKG9wdHNTdXBwb3J0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBvcHRzU3VwcG9ydGVkO1xuICB9XG5cbiAgb3B0c1N1cHBvcnRlZCA9IGZhbHNlO1xuICB0cnkge1xuICAgIC8vIFRlc3Qgd2hldGhlciBicm93c2VyIHN1cHBvcnRzIEV2ZW50TGlzdGVuZXJPcHRpb25zIG9yIG5vdFxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBnZXQgY2FwdHVyZSgpIHtcbiAgICAgICAgb3B0c1N1cHBvcnRlZCA9IHRydWU7XG4gICAgICB9LFxuICAgIH07XG4gICAgc2VsZi5hZGRFdmVudExpc3RlbmVyKCd0ZXN0LW9wdGlvbnMnLCBudWxsLCBvcHRpb25zKTtcbiAgICBzZWxmLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Rlc3Qtb3B0aW9ucycsIG51bGwsIG9wdGlvbnMpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICAvLyBFdmVudExpc3RlbmVyT3B0aW9ucyBhcmUgbm90IHN1cHBvcnRlZFxuICB9XG4gIHJldHVybiBvcHRzU3VwcG9ydGVkO1xufVxuXG4vKipcbiAgKiBSZXNldHMgdGhlIHRlc3QgZm9yIHdoZXRoZXIgYWRkRXZlbnRMaXN0ZW5lciBzdXBwb3J0cyBvcHRpb25zIG9yIG5vdC5cbiAgKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldEV2dExpc3RlbmVyT3B0c1N1cHBvcnRGb3JUZXN0aW5nKCkge1xuICBvcHRzU3VwcG9ydGVkID0gdW5kZWZpbmVkO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7aW50ZXJuYWxMaXN0ZW5JbXBsZW1lbnRhdGlvbn0gZnJvbSAnLi9ldmVudC1oZWxwZXItbGlzdGVuJztcbmltcG9ydCB7dXNlcn0gZnJvbSAnLi9sb2cnO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICAqL1xuY29uc3QgTE9BRF9GQUlMVVJFX1BSRUZJWCA9ICdGYWlsZWQgdG8gbG9hZDonO1xuXG4vKipcbiAqIFJldHVybnMgYSBDdXN0b21FdmVudCB3aXRoIGEgZ2l2ZW4gdHlwZSBhbmQgZGV0YWlsOyBzdXBwb3J0cyBmYWxsYmFjayBmb3IgSUUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAqIEBwYXJhbSB7IUpzb25PYmplY3R8c3RyaW5nfHVuZGVmaW5lZHxudWxsfSBkZXRhaWxcbiAqIEBwYXJhbSB7RXZlbnRJbml0PX0gb3B0X2V2ZW50SW5pdFxuICogQHJldHVybiB7IUV2ZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ3VzdG9tRXZlbnQod2luLCB0eXBlLCBkZXRhaWwsIG9wdF9ldmVudEluaXQpIHtcbiAgY29uc3QgZXZlbnRJbml0ID0gLyoqIEB0eXBlIHshQ3VzdG9tRXZlbnRJbml0fSAqLyAoe2RldGFpbH0pO1xuICBPYmplY3QuYXNzaWduKGV2ZW50SW5pdCwgb3B0X2V2ZW50SW5pdCk7XG4gIC8vIHdpbi5DdXN0b21FdmVudCBpcyBhIGZ1bmN0aW9uIG9uIEVkZ2UsIENocm9tZSwgRkYsIFNhZmFyaSBidXRcbiAgLy8gaXMgYW4gb2JqZWN0IG9uIElFIDExLlxuICBpZiAodHlwZW9mIHdpbi5DdXN0b21FdmVudCA9PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIG5ldyB3aW4uQ3VzdG9tRXZlbnQodHlwZSwgZXZlbnRJbml0KTtcbiAgfSBlbHNlIHtcbiAgICAvLyBEZXByZWNhdGVkIGZhbGxiYWNrIGZvciBJRS5cbiAgICBjb25zdCBlID0gd2luLmRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgIGUuaW5pdEN1c3RvbUV2ZW50KFxuICAgICAgICB0eXBlLCAhIWV2ZW50SW5pdC5idWJibGVzLCAhIWV2ZW50SW5pdC5jYW5jZWxhYmxlLCBkZXRhaWwpO1xuICAgIHJldHVybiBlO1xuICB9XG59XG5cbi8qKlxuICogTGlzdGVucyBmb3IgdGhlIHNwZWNpZmllZCBldmVudCBvbiB0aGUgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUV2ZW50VGFyZ2V0fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFdmVudCl9IGxpc3RlbmVyXG4gKiBAcGFyYW0ge09iamVjdD19IG9wdF9ldnRMaXN0ZW5lck9wdHNcbiAqIEByZXR1cm4geyFVbmxpc3RlbkRlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxpc3RlbihlbGVtZW50LCBldmVudFR5cGUsIGxpc3RlbmVyLCBvcHRfZXZ0TGlzdGVuZXJPcHRzKSB7XG4gIHJldHVybiBpbnRlcm5hbExpc3RlbkltcGxlbWVudGF0aW9uKFxuICAgICAgZWxlbWVudCwgZXZlbnRUeXBlLCBsaXN0ZW5lciwgb3B0X2V2dExpc3RlbmVyT3B0cyk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZGF0YSBwcm9wZXJ0eSBvZiBhbiBldmVudCB3aXRoIHRoZSBjb3JyZWN0IHR5cGUuXG4gKiBAcGFyYW0geyFFdmVudHx7ZGF0YTogIUpzb25PYmplY3R9fSBldmVudFxuICogQHJldHVybiB7P0pzb25PYmplY3R8c3RyaW5nfHVuZGVmaW5lZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldERhdGEoZXZlbnQpIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7P0pzb25PYmplY3R8c3RyaW5nfHVuZGVmaW5lZH0gKi8gKGV2ZW50LmRhdGEpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGRldGFpbCBwcm9wZXJ0eSBvZiBhbiBldmVudCB3aXRoIHRoZSBjb3JyZWN0IHR5cGUuXG4gKiBAcGFyYW0geyFFdmVudHx7ZGV0YWlsOiAhSnNvbk9iamVjdH19IGV2ZW50XG4gKiBAcmV0dXJuIHs/SnNvbk9iamVjdHxzdHJpbmd8dW5kZWZpbmVkfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGV0YWlsKGV2ZW50KSB7XG4gIHJldHVybiAvKiogQHR5cGUgez9Kc29uT2JqZWN0fHN0cmluZ3x1bmRlZmluZWR9ICovIChldmVudC5kZXRhaWwpO1xufVxuXG4vKipcbiAqIExpc3RlbnMgZm9yIHRoZSBzcGVjaWZpZWQgZXZlbnQgb24gdGhlIGVsZW1lbnQgYW5kIHJlbW92ZXMgdGhlIGxpc3RlbmVyXG4gKiBhcyBzb29uIGFzIGV2ZW50IGhhcyBiZWVuIHJlY2VpdmVkLlxuICogQHBhcmFtIHshRXZlbnRUYXJnZXR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUV2ZW50KX0gbGlzdGVuZXJcbiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0X2V2dExpc3RlbmVyT3B0c1xuICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGlzdGVuT25jZShlbGVtZW50LCBldmVudFR5cGUsIGxpc3RlbmVyLCBvcHRfZXZ0TGlzdGVuZXJPcHRzKSB7XG4gIGxldCBsb2NhbExpc3RlbmVyID0gbGlzdGVuZXI7XG4gIGNvbnN0IHVubGlzdGVuID0gaW50ZXJuYWxMaXN0ZW5JbXBsZW1lbnRhdGlvbihlbGVtZW50LCBldmVudFR5cGUsIGV2ZW50ID0+IHtcbiAgICB0cnkge1xuICAgICAgbG9jYWxMaXN0ZW5lcihldmVudCk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIC8vIEVuc3VyZSBsaXN0ZW5lciBpcyBHQydkXG4gICAgICBsb2NhbExpc3RlbmVyID0gbnVsbDtcbiAgICAgIHVubGlzdGVuKCk7XG4gICAgfVxuICB9LCBvcHRfZXZ0TGlzdGVuZXJPcHRzKTtcbiAgcmV0dXJuIHVubGlzdGVuO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyAgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIGFzIHNvb24gYXMgdGhlIHNwZWNpZmllZCBldmVudCBoYXNcbiAqIGZpcmVkIG9uIHRoZSBlbGVtZW50LlxuICogQHBhcmFtIHshRXZlbnRUYXJnZXR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0X2V2dExpc3RlbmVyT3B0c1xuICogQHBhcmFtIHtmdW5jdGlvbighVW5saXN0ZW5EZWYpPX0gb3B0X2NhbmNlbCBBbiBvcHRpb25hbCBmdW5jdGlvbiB0aGF0LCB3aGVuXG4gKiAgICAgcHJvdmlkZWQsIHdpbGwgYmUgY2FsbGVkIHdpdGggdGhlIHVubGlzdGVuZXIuIFRoaXMgZ2l2ZXMgdGhlIGNhbGxlclxuICogICAgIGFjY2VzcyB0byB0aGUgdW5saXN0ZW5lciwgc28gaXQgbWF5IGJlIGNhbGxlZCBtYW51YWxseSB3aGVuIG5lY2Vzc2FyeS5cbiAqIEByZXR1cm4geyFQcm9taXNlPCFFdmVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW5PbmNlUHJvbWlzZShlbGVtZW50LCBldmVudFR5cGUsIG9wdF9ldnRMaXN0ZW5lck9wdHMsXG4gIG9wdF9jYW5jZWwpIHtcbiAgbGV0IHVubGlzdGVuO1xuICBjb25zdCBldmVudFByb21pc2UgPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICB1bmxpc3RlbiA9IGxpc3Rlbk9uY2UoZWxlbWVudCwgZXZlbnRUeXBlLCByZXNvbHZlLCBvcHRfZXZ0TGlzdGVuZXJPcHRzKTtcbiAgfSk7XG4gIGV2ZW50UHJvbWlzZS50aGVuKHVubGlzdGVuLCB1bmxpc3Rlbik7XG4gIGlmIChvcHRfY2FuY2VsKSB7XG4gICAgb3B0X2NhbmNlbCh1bmxpc3Rlbik7XG4gIH1cbiAgcmV0dXJuIGV2ZW50UHJvbWlzZTtcbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHNwZWNpZmllZCBlbGVtZW50L3dpbmRvdyBoYXMgYmVlbiBsb2FkZWQgYWxyZWFkeS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IVdpbmRvd30gZWxlT3JXaW5kb3dcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvYWRlZChlbGVPcldpbmRvdykge1xuICByZXR1cm4gISEoZWxlT3JXaW5kb3cuY29tcGxldGUgfHwgZWxlT3JXaW5kb3cucmVhZHlTdGF0ZSA9PSAnY29tcGxldGUnXG4gICAgICAvLyBJZiB0aGUgcGFzc2VkIGluIHRoaW5nIGlzIGEgV2luZG93LCBpbmZlciBsb2FkZWQgc3RhdGUgZnJvbVxuICAgICAgLy9cbiAgICAgIHx8IChlbGVPcldpbmRvdy5kb2N1bWVudFxuICAgICAgICAgICYmIGVsZU9yV2luZG93LmRvY3VtZW50LnJlYWR5U3RhdGUgPT0gJ2NvbXBsZXRlJykpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIG9yIGZhaWwgYmFzZWQgb24gdGhlIGVsZU9yV2luZG93J3MgJ2xvYWQnXG4gKiBhbmQgJ2Vycm9yJyBldmVudHMuIE9wdGlvbmFsbHkgdGhpcyBtZXRob2QgdGFrZXMgYSB0aW1lb3V0LCB3aGljaCB3aWxsIHJlamVjdFxuICogdGhlIHByb21pc2UgaWYgdGhlIHJlc291cmNlIGhhcyBub3QgbG9hZGVkIGJ5IHRoZW4uXG4gKiBAcGFyYW0ge1R9IGVsZU9yV2luZG93IFN1cHBvcnRzIGJvdGggRWxlbWVudHMgYW5kIGFzIGEgc3BlY2lhbCBjYXNlIFdpbmRvd3MuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTxUPn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsb2FkUHJvbWlzZShlbGVPcldpbmRvdykge1xuICBsZXQgdW5saXN0ZW5Mb2FkO1xuICBsZXQgdW5saXN0ZW5FcnJvcjtcbiAgaWYgKGlzTG9hZGVkKGVsZU9yV2luZG93KSkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZWxlT3JXaW5kb3cpO1xuICB9XG4gIGNvbnN0IGxvYWRpbmdQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIC8vIExpc3RlbiBvbmNlIHNpbmNlIElFIDUvNi83IGZpcmUgdGhlIG9ubG9hZCBldmVudCBjb250aW51b3VzbHkgZm9yXG4gICAgLy8gYW5pbWF0ZWQgR0lGcy5cbiAgICBjb25zdCB7dGFnTmFtZX0gPSBlbGVPcldpbmRvdztcbiAgICBpZiAodGFnTmFtZSA9PT0gJ0FVRElPJyB8fCB0YWdOYW1lID09PSAnVklERU8nKSB7XG4gICAgICB1bmxpc3RlbkxvYWQgPSBsaXN0ZW5PbmNlKGVsZU9yV2luZG93LCAnbG9hZHN0YXJ0JywgcmVzb2x2ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVubGlzdGVuTG9hZCA9IGxpc3Rlbk9uY2UoZWxlT3JXaW5kb3csICdsb2FkJywgcmVzb2x2ZSk7XG4gICAgfVxuICAgIC8vIEZvciBlbGVtZW50cywgdW5saXN0ZW4gb24gZXJyb3IgKGRvbid0IGZvciBXaW5kb3dzKS5cbiAgICBpZiAodGFnTmFtZSkge1xuICAgICAgdW5saXN0ZW5FcnJvciA9IGxpc3Rlbk9uY2UoZWxlT3JXaW5kb3csICdlcnJvcicsIHJlamVjdCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gbG9hZGluZ1Byb21pc2UudGhlbigoKSA9PiB7XG4gICAgaWYgKHVubGlzdGVuRXJyb3IpIHtcbiAgICAgIHVubGlzdGVuRXJyb3IoKTtcbiAgICB9XG4gICAgcmV0dXJuIGVsZU9yV2luZG93O1xuICB9LCAoKSA9PiB7XG4gICAgaWYgKHVubGlzdGVuTG9hZCkge1xuICAgICAgdW5saXN0ZW5Mb2FkKCk7XG4gICAgfVxuICAgIGZhaWxlZFRvTG9hZChlbGVPcldpbmRvdyk7XG4gIH0pO1xufVxuXG4vKipcbiAqIEVtaXQgZXJyb3Igb24gbG9hZCBmYWlsdXJlLlxuICogQHBhcmFtIHshRWxlbWVudHwhV2luZG93fSBlbGVPcldpbmRvdyBTdXBwb3J0cyBib3RoIEVsZW1lbnRzIGFuZCBhcyBhIHNwZWNpYWxcbiAqICAgICBjYXNlIFdpbmRvd3MuXG4gKi9cbmZ1bmN0aW9uIGZhaWxlZFRvTG9hZChlbGVPcldpbmRvdykge1xuICAvLyBSZXBvcnQgZmFpbGVkIGxvYWRzIGFzIHVzZXIgZXJyb3JzIHNvIHRoYXQgdGhleSBhdXRvbWF0aWNhbGx5IGdvXG4gIC8vIGludG8gdGhlIFwiZG9jdW1lbnQgZXJyb3JcIiBidWNrZXQuXG4gIGxldCB0YXJnZXQgPSBlbGVPcldpbmRvdztcbiAgaWYgKHRhcmdldCAmJiB0YXJnZXQuc3JjKSB7XG4gICAgdGFyZ2V0ID0gdGFyZ2V0LnNyYztcbiAgfVxuICB0aHJvdyB1c2VyKCkuY3JlYXRlRXJyb3IoTE9BRF9GQUlMVVJFX1BSRUZJWCwgdGFyZ2V0KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBlcnJvciBtZXNzYWdlIGlzIHdhcyBjcmVhdGVkIGZvciBhIGxvYWQgZXJyb3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBBbiBlcnJvciBtZXNzYWdlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNMb2FkRXJyb3JNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgcmV0dXJuIG1lc3NhZ2UuaW5kZXhPZihMT0FEX0ZBSUxVUkVfUFJFRklYKSAhPSAtMTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgVGhpcyBtb2R1bGUgZGVjbGFyZXMgSlNPTiB0eXBlcyBhcyBkZWZpbmVkIGluIHRoZVxuICoge0BsaW5rIGh0dHA6Ly9qc29uLm9yZy99LlxuICovXG5cbmltcG9ydCB7aXNPYmplY3R9IGZyb20gJy4vdHlwZXMnO1xuXG5cbi8vIE5PVEUgVHlwZSBhcmUgY2hhbmdlZCB0byB7Kn0gYmVjYXVzZSBvZlxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9jbG9zdXJlLWNvbXBpbGVyL2lzc3Vlcy8xOTk5XG5cbi8qKlxuICogSlNPTiBzY2FsYXIuIEl0J3MgZWl0aGVyIHN0cmluZywgbnVtYmVyIG9yIGJvb2xlYW4uXG4gKiBAdHlwZWRlZiB7Kn0gc2hvdWxkIGJlIHN0cmluZ3xudW1iZXJ8Ym9vbGVhblxuICovXG5sZXQgSlNPTlNjYWxhckRlZjtcblxuXG4vKipcbiAqIEpTT04gb2JqZWN0LiBJdCdzIGEgbWFwIHdpdGggc3RyaW5nIGtleXMgYW5kIEpTT04gdmFsdWVzLlxuICogQHR5cGVkZWYgeyp9IHNob3VsZCBiZSAhT2JqZWN0PHN0cmluZywgP0pTT05WYWx1ZURlZj5cbiAqL1xubGV0IEpTT05PYmplY3REZWY7XG5cblxuLyoqXG4gKiBKU09OIGFycmF5LiBJdCdzIGFuIGFycmF5IHdpdGggSlNPTiB2YWx1ZXMuXG4gKiBAdHlwZWRlZiB7Kn0gc2hvdWxkIGJlICFBcnJheTw/SlNPTlZhbHVlRGVmPlxuICovXG5sZXQgSlNPTkFycmF5RGVmO1xuXG5cbi8qKlxuICogSlNPTiB2YWx1ZS4gSXQncyBlaXRoZXIgYSBzY2FsYXIsIGFuIG9iamVjdCBvciBhbiBhcnJheS5cbiAqIEB0eXBlZGVmIHsqfSBzaG91bGQgYmUgIUpTT05TY2FsYXJEZWZ8IUpTT05PYmplY3REZWZ8IUpTT05BcnJheURlZlxuICovXG5sZXQgSlNPTlZhbHVlRGVmO1xuXG4vKipcbiAqIFJlY3JlYXRlcyBvYmplY3RzIHdpdGggcHJvdG90eXBlLWxlc3MgY29waWVzLlxuICogQHBhcmFtIHshSnNvbk9iamVjdH0gb2JqXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlY3JlYXRlTm9uUHJvdG9PYmplY3Qob2JqKSB7XG4gIGNvbnN0IGNvcHkgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBmb3IgKGNvbnN0IGsgaW4gb2JqKSB7XG4gICAgaWYgKCFoYXNPd25Qcm9wZXJ0eShvYmosIGspKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3QgdiA9IG9ialtrXTtcbiAgICBjb3B5W2tdID0gaXNPYmplY3QodikgPyByZWNyZWF0ZU5vblByb3RvT2JqZWN0KHYpIDogdjtcbiAgfVxuICByZXR1cm4gLyoqIEB0eXBlIHshSnNvbk9iamVjdH0gKi8gKGNvcHkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmcm9tIGFuIG9iamVjdCBmb3IgYSBmaWVsZC1iYXNlZCBleHByZXNzaW9uLiBUaGUgZXhwcmVzc2lvblxuICogaXMgYSBzaW1wbGUgbmVzdGVkIGRvdC1ub3RhdGlvbiBvZiBmaWVsZHMsIHN1Y2ggYXMgYGZpZWxkMS5maWVsZDJgLiBJZiBhbnlcbiAqIGZpZWxkIGluIGEgY2hhaW4gZG9lcyBub3QgZXhpc3Qgb3IgaXMgbm90IGFuIG9iamVjdCBvciBhcnJheSwgdGhlIHJldHVybmVkXG4gKiB2YWx1ZSB3aWxsIGJlIGB1bmRlZmluZWRgLlxuICpcbiAqIEBwYXJhbSB7IUpzb25PYmplY3R9IG9ialxuICogQHBhcmFtIHtzdHJpbmd9IGV4cHJcbiAqIEByZXR1cm4geyp9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRWYWx1ZUZvckV4cHIob2JqLCBleHByKSB7XG4gIC8vIFRoZSBgLmAgaW5kaWNhdGVzIFwidGhlIG9iamVjdCBpdHNlbGZcIi5cbiAgaWYgKGV4cHIgPT0gJy4nKSB7XG4gICAgcmV0dXJuIG9iajtcbiAgfVxuICAvLyBPdGhlcndpc2UsIG5hdmlnYXRlIHZpYSBwcm9wZXJ0aWVzLlxuICBjb25zdCBwYXJ0cyA9IGV4cHIuc3BsaXQoJy4nKTtcbiAgbGV0IHZhbHVlID0gb2JqO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgcGFydCA9IHBhcnRzW2ldO1xuICAgIGlmIChwYXJ0ICYmXG4gICAgICAgIHZhbHVlICYmXG4gICAgICAgIHZhbHVlW3BhcnRdICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgaGFzT3duUHJvcGVydHkodmFsdWUsIHBhcnQpXG4gICAgKSB7XG4gICAgICB2YWx1ZSA9IHZhbHVlW3BhcnRdO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHZhbHVlID0gdW5kZWZpbmVkO1xuICAgIGJyZWFrO1xuICB9XG4gIHJldHVybiB2YWx1ZTtcbn1cblxuLyoqXG4gKiBTaW1wbGUgd3JhcHBlciBhcm91bmQgSlNPTi5wYXJzZSB0aGF0IGNhc3RzIHRoZSByZXR1cm4gdmFsdWVcbiAqIHRvIEpzb25PYmplY3QuXG4gKiBDcmVhdGUgYSBuZXcgd3JhcHBlciBpZiBhbiBhcnJheSByZXR1cm4gdmFsdWUgaXMgZGVzaXJlZC5cbiAqIEBwYXJhbSB7Kn0ganNvbiBKU09OIHN0cmluZyB0byBwYXJzZVxuICogQHJldHVybiB7P0pzb25PYmplY3R9IE1heSBiZSBleHRlbmQgdG8gcGFyc2UgYXJyYXlzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VKc29uKGpzb24pIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7P0pzb25PYmplY3R9ICovKEpTT04ucGFyc2UoLyoqIEB0eXBlIHtzdHJpbmd9ICovIChqc29uKSkpO1xufVxuXG4vKipcbiAqIFBhcnNlcyB0aGUgZ2l2ZW4gYGpzb25gIHN0cmluZyB3aXRob3V0IHRocm93aW5nIGFuIGV4Y2VwdGlvbiBpZiBub3QgdmFsaWQuXG4gKiBSZXR1cm5zIGB1bmRlZmluZWRgIGlmIHBhcnNpbmcgZmFpbHMuXG4gKiBSZXR1cm5zIHRoZSBgT2JqZWN0YCBjb3JyZXNwb25kaW5nIHRvIHRoZSBKU09OIHN0cmluZyB3aGVuIHBhcnNpbmcgc3VjY2VlZHMuXG4gKiBAcGFyYW0geyp9IGpzb24gSlNPTiBzdHJpbmcgdG8gcGFyc2VcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVycm9yKT19IG9wdF9vbkZhaWxlZCBPcHRpb25hbCBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkXG4gKiAgICAgd2l0aCB0aGUgZXJyb3IgaWYgcGFyc2luZyBmYWlscy5cbiAqIEByZXR1cm4gez9Kc29uT2JqZWN0fHVuZGVmaW5lZH0gTWF5IGJlIGV4dGVuZCB0byBwYXJzZSBhcnJheXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnlQYXJzZUpzb24oanNvbiwgb3B0X29uRmFpbGVkKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHBhcnNlSnNvbihqc29uKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGlmIChvcHRfb25GYWlsZWQpIHtcbiAgICAgIG9wdF9vbkZhaWxlZChlKTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG4vKipcbiAqIFJlY3Vyc2l2ZWx5IGNoZWNrcyBzdHJpY3QgZXF1YWxpdHkgb2YgaXRlbXMgaW4gbmVzdGVkIGFycmF5cyBhbmQgb2JqZWN0cy5cbiAqXG4gKiBAcGFyYW0ge0pTT05WYWx1ZURlZn0gYVxuICogQHBhcmFtIHtKU09OVmFsdWVEZWZ9IGJcbiAqIEBwYXJhbSB7bnVtYmVyfSBkZXB0aCBUaGUgbWF4aW11bSByZWN1cnNpb24gZGVwdGguIE11c3QgYmUgZmluaXRlLlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBkZXB0aCBhcmd1bWVudCBpcyBub3QgZmluaXRlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVjdXJzaXZlRXF1YWxzKGEsIGIsIGRlcHRoID0gMykge1xuICBpZiAoIWlzRmluaXRlKGRlcHRoKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignZGVwdGggYXJnIG11c3QgYmUgZmluaXRlOiAnICsgZGVwdGgpO1xuICB9XG4gIGlmIChhID09PSBiKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgLy8gT25seSBjaGVjayBzaGFsbG93IGVxdWFsaXR5IGZvciBkZXB0aCA8IDEuXG4gIGlmIChkZXB0aCA8IDEpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgaWYgKHR5cGVvZiBhICE9PSB0eXBlb2YgYikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBpZiAoQXJyYXkuaXNBcnJheShhKSAmJiBBcnJheS5pc0FycmF5KGIpKSB7XG4gICAgaWYgKGEubGVuZ3RoICE9PSBiLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghcmVjdXJzaXZlRXF1YWxzKGFbaV0sIGJbaV0sIGRlcHRoIC0gMSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAoYSAmJiBiICYmIHR5cGVvZiBhID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgYiA9PT0gJ29iamVjdCcpIHtcbiAgICBjb25zdCBrZXlzQSA9IE9iamVjdC5rZXlzKC8qKiBAdHlwZSB7IU9iamVjdH0gKi8gKGEpKTtcbiAgICBjb25zdCBrZXlzQiA9IE9iamVjdC5rZXlzKC8qKiBAdHlwZSB7IU9iamVjdH0gKi8gKGIpKTtcbiAgICBpZiAoa2V5c0EubGVuZ3RoICE9PSBrZXlzQi5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzQS5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qga2V5QSA9IGtleXNBW2ldO1xuICAgICAgY29uc3QgdmFsdWVBID0gYVtrZXlBXTtcbiAgICAgIGNvbnN0IHZhbHVlQiA9IGJba2V5QV07XG4gICAgICBpZiAoIXJlY3Vyc2l2ZUVxdWFscyh2YWx1ZUEsIHZhbHVlQiwgZGVwdGggLSAxKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7Kn0gb2JqXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBoYXNPd25Qcm9wZXJ0eShvYmosIGtleSkge1xuICBpZiAob2JqID09IG51bGwgfHwgdHlwZW9mIG9iaiAhPSAnb2JqZWN0Jykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKFxuICAgICAgLyoqIEB0eXBlIHshT2JqZWN0fSAqLyAob2JqKSwga2V5KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgSW1wbGVtZW50cyBlbGVtZW50IGxheW91dC4gU2VlIGh0dHBzOi8vZ29vLmdsLzlhdlh1VCBmb3JcbiAqIGRldGFpbHMuXG4gKi9cblxuaW1wb3J0IHtkZXYsIHVzZXJ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7aHRtbEZvcn0gZnJvbSAnLi9zdGF0aWMtdGVtcGxhdGUnO1xuaW1wb3J0IHtpc0Zpbml0ZU51bWJlcn0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQge3NldFN0eWxlLCBzZXRTdHlsZXN9IGZyb20gJy4vc3R5bGUnO1xuaW1wb3J0IHtzdGFydHNXaXRofSBmcm9tICcuL3N0cmluZyc7XG5cbi8qKlxuICogQGVudW0ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGNvbnN0IExheW91dCA9IHtcbiAgTk9ESVNQTEFZOiAnbm9kaXNwbGF5JyxcbiAgRklYRUQ6ICdmaXhlZCcsXG4gIEZJWEVEX0hFSUdIVDogJ2ZpeGVkLWhlaWdodCcsXG4gIFJFU1BPTlNJVkU6ICdyZXNwb25zaXZlJyxcbiAgQ09OVEFJTkVSOiAnY29udGFpbmVyJyxcbiAgRklMTDogJ2ZpbGwnLFxuICBGTEVYX0lURU06ICdmbGV4LWl0ZW0nLFxuICBGTFVJRDogJ2ZsdWlkJyxcbiAgSU5UUklOU0lDOiAnaW50cmluc2ljJyxcbn07XG5cblxuLyoqXG4gKiBMYXlvdXQgcHJpb3JpdGllcyB0byB1c2Ugd2l0aCBCYXNlRWxlbWVudCNnZXRMYXlvdXRQcmlvcml0eSgpIGFuZFxuICogQmFzZUVsZW1lbnQjdXBkYXRlTGF5b3V0UHJpb3JpdHkoKS5cbiAqIEBlbnVtIHtudW1iZXJ9XG4gKi9cbmV4cG9ydCBjb25zdCBMYXlvdXRQcmlvcml0eSA9IHtcbiAgQ09OVEVOVDogMCxcbiAgTUVUQURBVEE6IDEsXG4gIEFEUzogMixcbiAgQkFDS0dST1VORDogMyxcbn07XG5cblxuLyoqXG4gKiBDU1MgTGVuZ3RoIHR5cGUuIEUuZy4gXCIxcHhcIiBvciBcIjIwdmhcIi5cbiAqIEB0eXBlZGVmIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBsZXQgTGVuZ3RoRGVmO1xuXG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgd2lkdGg6IHN0cmluZyxcbiAqICAgaGVpZ2h0OiBzdHJpbmdcbiAqIH19XG4gKi9cbmxldCBEaW1lbnNpb25zRGVmO1xuXG5cbi8qKlxuICogVGhlIHNldCBvZiBlbGVtZW50cyB3aXRoIG5hdHVyYWwgZGltZW5zaW9ucywgdGhhdCBpcywgZWxlbWVudHNcbiAqIHdoaWNoIGhhdmUgYSBrbm93biBkaW1lbnNpb24gZWl0aGVyIGJhc2VkIG9uIHRoZWlyIHZhbHVlIHNwZWNpZmllZCBoZXJlLFxuICogb3IsIGlmIHRoZSB2YWx1ZSBpcyBudWxsLCBhIGRpbWVuc2lvbiBzcGVjaWZpYyB0byB0aGUgYnJvd3Nlci5cbiAqIGBoYXNOYXR1cmFsRGltZW5zaW9uc2AgY2hlY2tzIGZvciBtZW1iZXJzaGlwIGluIHRoaXMgc2V0LlxuICogYGdldE5hdHVyYWxEaW1lbnNpb25zYCBkZXRlcm1pbmVzIHRoZSBkaW1lbnNpb25zIGZvciBhbiBlbGVtZW50IGluIHRoZVxuICogICAgc2V0IGFuZCBjYWNoZXMgaXQuXG4gKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsID9EaW1lbnNpb25zRGVmPn1cbiAqIEBwcml2YXRlICBWaXNpYmxlIGZvciB0ZXN0aW5nIG9ubHkhXG4gKi9cbmV4cG9ydCBjb25zdCBuYXR1cmFsRGltZW5zaW9uc18gPSB7XG4gICdBTVAtUElYRUwnOiB7d2lkdGg6ICcwcHgnLCBoZWlnaHQ6ICcwcHgnfSxcbiAgJ0FNUC1BTkFMWVRJQ1MnOiB7d2lkdGg6ICcxcHgnLCBoZWlnaHQ6ICcxcHgnfSxcbiAgLy8gVE9ETyhkdm95dGVua28pOiBhdWRpbyBzaG91bGQgaGF2ZSB3aWR0aDphdXRvLlxuICAnQU1QLUFVRElPJzogbnVsbCxcbiAgJ0FNUC1TT0NJQUwtU0hBUkUnOiB7d2lkdGg6ICc2MHB4JywgaGVpZ2h0OiAnNDRweCd9LFxufTtcblxuXG4vKipcbiAqIEVsZW1lbnRzIHRoYXQgdGhlIHByb2dlc3MgY2FuIGJlIHNob3duIGZvci4gVGhpcyBzZXQgaGFzIHRvIGJlIGV4dGVybmFsaXplZFxuICogc2luY2UgdGhlIGVsZW1lbnQncyBpbXBsZW1lbnRhdGlvbiBtYXkgbm90IGJlIGRvd25sb2FkZWQgeWV0LlxuICogQGVudW0ge2Jvb2xlYW59XG4gKiBAcHJpdmF0ZSAgVmlzaWJsZSBmb3IgdGVzdGluZyBvbmx5IVxuICovXG5leHBvcnQgY29uc3QgTE9BRElOR19FTEVNRU5UU18gPSB7XG4gICdBTVAtQU5JTSc6IHRydWUsXG4gICdBTVAtQlJJR0hUQ09WRSc6IHRydWUsXG4gICdBTVAtR09PR0xFLURPQ1VNRU5ULUVNQkVEJzogdHJ1ZSxcbiAgJ0FNUC1FTUJFRCc6IHRydWUsXG4gICdBTVAtRkFDRUJPT0snOiB0cnVlLFxuICAnQU1QLUZBQ0VCT09LLUNPTU1FTlRTJzogdHJ1ZSxcbiAgJ0FNUC1GQUNFQk9PSy1MSUtFJzogdHJ1ZSxcbiAgJ0FNUC1GQUNFQk9PSy1QQUdFJzogdHJ1ZSxcbiAgJ0FNUC1JRlJBTUUnOiB0cnVlLFxuICAnQU1QLUlNRyc6IHRydWUsXG4gICdBTVAtSU5TVEFHUkFNJzogdHJ1ZSxcbiAgJ0FNUC1MSVNUJzogdHJ1ZSxcbiAgJ0FNUC1PT1lBTEEtUExBWUVSJzogdHJ1ZSxcbiAgJ0FNUC1QSU5URVJFU1QnOiB0cnVlLFxuICAnQU1QLVBMQVlCVVpaJzogdHJ1ZSxcbiAgJ0FNUC1WSURFTyc6IHRydWUsXG4gICdBTVAtWU9VVFVCRSc6IHRydWUsXG59O1xuXG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IHNcbiAqIEByZXR1cm4ge0xheW91dHx1bmRlZmluZWR9IFJldHVybnMgdW5kZWZpbmVkIGluIGNhc2Ugb2YgZmFpbHVyZSB0byBwYXJzZVxuICogICB0aGUgbGF5b3V0IHN0cmluZy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlTGF5b3V0KHMpIHtcbiAgZm9yIChjb25zdCBrIGluIExheW91dCkge1xuICAgIGlmIChMYXlvdXRba10gPT0gcykge1xuICAgICAgcmV0dXJuIExheW91dFtrXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IUxheW91dH0gbGF5b3V0XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRMYXlvdXRDbGFzcyhsYXlvdXQpIHtcbiAgcmV0dXJuICdpLWFtcGh0bWwtbGF5b3V0LScgKyBsYXlvdXQ7XG59XG5cblxuLyoqXG4gKiBXaGV0aGVyIGFuIGVsZW1lbnQgd2l0aCB0aGlzIGxheW91dCBpbmhlcmVudGx5IGRlZmluZXMgdGhlIHNpemUuXG4gKiBAcGFyYW0geyFMYXlvdXR9IGxheW91dFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTGF5b3V0U2l6ZURlZmluZWQobGF5b3V0KSB7XG4gIHJldHVybiAobGF5b3V0ID09IExheW91dC5GSVhFRCB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5GSVhFRF9IRUlHSFQgfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuUkVTUE9OU0lWRSB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5GSUxMIHx8XG4gICAgICBsYXlvdXQgPT0gTGF5b3V0LkZMRVhfSVRFTSB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5GTFVJRCB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5JTlRSSU5TSUMpO1xufVxuXG5cbi8qKlxuICogV2hldGhlciB0aGUgdGFnIGlzIGFuIGludGVybmFsIChzZXJ2aWNlKSBBTVAgdGFnLlxuICogQHBhcmFtIHshTm9kZXxzdHJpbmd9IHRhZ1xuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzSW50ZXJuYWxFbGVtZW50KHRhZykge1xuICBjb25zdCB0YWdOYW1lID0gKHR5cGVvZiB0YWcgPT0gJ3N0cmluZycpID8gdGFnIDogdGFnLnRhZ05hbWU7XG4gIHJldHVybiB0YWdOYW1lICYmIHN0YXJ0c1dpdGgodGFnTmFtZS50b0xvd2VyQ2FzZSgpLCAnaS0nKTtcbn1cblxuXG4vKipcbiAqIFBhcnNlcyB0aGUgQ1NTIGxlbmd0aCB2YWx1ZS4gSWYgbm8gdW5pdHMgc3BlY2lmaWVkLCB0aGUgYXNzdW1lZCB2YWx1ZSBpc1xuICogXCJweFwiLiBSZXR1cm5zIHVuZGVmaW5lZCBpbiBjYXNlIG9mIHBhcnNpbmcgZXJyb3IuXG4gKiBAcGFyYW0ge3N0cmluZ3x1bmRlZmluZWR8bnVsbH0gc1xuICogQHJldHVybiB7IUxlbmd0aERlZnx1bmRlZmluZWR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUxlbmd0aChzKSB7XG4gIGlmICh0eXBlb2YgcyA9PSAnbnVtYmVyJykge1xuICAgIHJldHVybiBzICsgJ3B4JztcbiAgfVxuICBpZiAoIXMpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIGlmICghL15cXGQrKFxcLlxcZCspPyhweHxlbXxyZW18dmh8dnd8dm1pbnx2bWF4fGNtfG1tfHF8aW58cGN8cHQpPyQvLnRlc3QocykpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIGlmICgvXlxcZCsoXFwuXFxkKyk/JC8udGVzdChzKSkge1xuICAgIHJldHVybiBzICsgJ3B4JztcbiAgfVxuICByZXR1cm4gcztcbn1cblxuXG5cbi8qKlxuICogQXNzZXJ0cyB0aGF0IHRoZSBzdXBwbGllZCB2YWx1ZSBpcyBhIG5vbi1wZXJjZW50IENTUyBMZW5ndGggdmFsdWUuXG4gKiBAcGFyYW0geyFMZW5ndGhEZWZ8c3RyaW5nfG51bGx8dW5kZWZpbmVkfSBsZW5ndGhcbiAqIEByZXR1cm4geyFMZW5ndGhEZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRMZW5ndGgobGVuZ3RoKSB7XG4gIHVzZXIoKS5hc3NlcnQoXG4gICAgICAvXlxcZCsoXFwuXFxkKyk/KHB4fGVtfHJlbXx2aHx2d3x2bWlufHZtYXh8Y218bW18cXxpbnxwY3xwdCkkLy50ZXN0KGxlbmd0aCksXG4gICAgICAnSW52YWxpZCBsZW5ndGggdmFsdWU6ICVzJywgbGVuZ3RoKTtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IUxlbmd0aERlZn0gKi8gKGxlbmd0aCk7XG59XG5cblxuXG5cbi8qKlxuICogQXNzZXJ0cyB0aGF0IHRoZSBzdXBwbGllZCB2YWx1ZSBpcyBhIENTUyBMZW5ndGggdmFsdWVcbiAqIChpbmNsdWRpbmcgcGVyY2VudCB1bml0KS5cbiAqIEBwYXJhbSB7IUxlbmd0aERlZnxzdHJpbmd9IGxlbmd0aFxuICogQHJldHVybiB7IUxlbmd0aERlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydExlbmd0aE9yUGVyY2VudChsZW5ndGgpIHtcbiAgdXNlcigpLmFzc2VydCgvXlxcZCsoXFwuXFxkKyk/KHB4fGVtfHJlbXx2aHx2d3x2bWlufHZtYXh8JSkkLy50ZXN0KGxlbmd0aCksXG4gICAgICAnSW52YWxpZCBsZW5ndGggb3IgcGVyY2VudCB2YWx1ZTogJXMnLCBsZW5ndGgpO1xuICByZXR1cm4gbGVuZ3RoO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyB1bml0cyBmcm9tIHRoZSBDU1MgbGVuZ3RoIHZhbHVlLlxuICogQHBhcmFtIHshTGVuZ3RoRGVmfHN0cmluZ3xudWxsfHVuZGVmaW5lZH0gbGVuZ3RoXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRMZW5ndGhVbml0cyhsZW5ndGgpIHtcbiAgYXNzZXJ0TGVuZ3RoKGxlbmd0aCk7XG4gIGRldigpLmFzc2VydFN0cmluZyhsZW5ndGgpO1xuICBjb25zdCBtID0gdXNlcigpLmFzc2VydChsZW5ndGgubWF0Y2goL1thLXpdKy9pKSxcbiAgICAgICdGYWlsZWQgdG8gcmVhZCB1bml0cyBmcm9tICVzJywgbGVuZ3RoKTtcbiAgcmV0dXJuIG1bMF07XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBudW1lcmljIHZhbHVlIG9mIGEgQ1NTIGxlbmd0aCB2YWx1ZS5cbiAqIEBwYXJhbSB7IUxlbmd0aERlZnxzdHJpbmd8bnVsbHx1bmRlZmluZWR9IGxlbmd0aFxuICogQHJldHVybiB7bnVtYmVyfHVuZGVmaW5lZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExlbmd0aE51bWVyYWwobGVuZ3RoKSB7XG4gIGNvbnN0IHJlcyA9IHBhcnNlRmxvYXQobGVuZ3RoKTtcbiAgcmV0dXJuIGlzRmluaXRlTnVtYmVyKHJlcykgPyByZXMgOiB1bmRlZmluZWQ7XG59XG5cblxuLyoqXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIHRhZ05hbWUgaXMgYSBrbm93biBlbGVtZW50IHRoYXQgaGFzIG5hdHVyYWwgZGltZW5zaW9uc1xuICogaW4gb3VyIHJ1bnRpbWUgb3IgdGhlIGJyb3dzZXIuXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZSBUaGUgZWxlbWVudCB0YWcgbmFtZS5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoYXNOYXR1cmFsRGltZW5zaW9ucyh0YWdOYW1lKSB7XG4gIHRhZ05hbWUgPSB0YWdOYW1lLnRvVXBwZXJDYXNlKCk7XG4gIHJldHVybiBuYXR1cmFsRGltZW5zaW9uc19bdGFnTmFtZV0gIT09IHVuZGVmaW5lZDtcbn1cblxuXG4vKipcbiAqIERldGVybWluZXMgdGhlIGRlZmF1bHQgZGltZW5zaW9ucyBmb3IgYW4gZWxlbWVudCB3aGljaCBjb3VsZCB2YXJ5IGFjcm9zc1xuICogZGlmZmVyZW50IGJyb3dzZXIgaW1wbGVtZW50YXRpb25zLCBsaWtlIDxhdWRpbz4gZm9yIGluc3RhbmNlLlxuICogVGhpcyBvcGVyYXRpb24gY2FuIG9ubHkgYmUgY29tcGxldGVkIGZvciBhbiBlbGVtZW50IHdoaXRlbGlzdGVkIGJ5XG4gKiBgaGFzTmF0dXJhbERpbWVuc2lvbnNgLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7RGltZW5zaW9uc0RlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE5hdHVyYWxEaW1lbnNpb25zKGVsZW1lbnQpIHtcbiAgY29uc3QgdGFnTmFtZSA9IGVsZW1lbnQudGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xuICBkZXYoKS5hc3NlcnQobmF0dXJhbERpbWVuc2lvbnNfW3RhZ05hbWVdICE9PSB1bmRlZmluZWQpO1xuICBpZiAoIW5hdHVyYWxEaW1lbnNpb25zX1t0YWdOYW1lXSkge1xuICAgIGNvbnN0IGRvYyA9IGVsZW1lbnQub3duZXJEb2N1bWVudDtcbiAgICBjb25zdCBuYXR1cmFsVGFnTmFtZSA9IHRhZ05hbWUucmVwbGFjZSgvXkFNUFxcLS8sICcnKTtcbiAgICBjb25zdCB0ZW1wID0gZG9jLmNyZWF0ZUVsZW1lbnQobmF0dXJhbFRhZ05hbWUpO1xuICAgIC8vIEZvciBhdWRpbywgc2hvdWxkIG5vLW9wIGVsc2V3aGVyZS5cbiAgICB0ZW1wLmNvbnRyb2xzID0gdHJ1ZTtcbiAgICBzZXRTdHlsZXModGVtcCwge1xuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICB2aXNpYmlsaXR5OiAnaGlkZGVuJyxcbiAgICB9KTtcbiAgICBkb2MuYm9keS5hcHBlbmRDaGlsZCh0ZW1wKTtcbiAgICBuYXR1cmFsRGltZW5zaW9uc19bdGFnTmFtZV0gPSB7XG4gICAgICB3aWR0aDogKHRlbXAuLypPSyovb2Zmc2V0V2lkdGggfHwgMSkgKyAncHgnLFxuICAgICAgaGVpZ2h0OiAodGVtcC4vKk9LKi9vZmZzZXRIZWlnaHQgfHwgMSkgKyAncHgnLFxuICAgIH07XG4gICAgZG9jLmJvZHkucmVtb3ZlQ2hpbGQodGVtcCk7XG4gIH1cbiAgcmV0dXJuIC8qKiBAdHlwZSB7RGltZW5zaW9uc0RlZn0gKi8gKG5hdHVyYWxEaW1lbnNpb25zX1t0YWdOYW1lXSk7XG59XG5cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBsb2FkaW5nIGNhbiBiZSBzaG93biBmb3IgdGhlIHNwZWNpZmllZCBlbGVtZWVudC4gVGhpcyBzZXQgaGFzXG4gKiB0byBiZSBleHRlcm5hbGl6ZWQgc2luY2UgdGhlIGVsZW1lbnQncyBpbXBsZW1lbnRhdGlvbiBtYXkgbm90IGJlXG4gKiBkb3dubG9hZGVkIHlldC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvYWRpbmdBbGxvd2VkKGVsZW1lbnQpIHtcbiAgY29uc3QgdGFnTmFtZSA9IGVsZW1lbnQudGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xuICBpZiAodGFnTmFtZSA9PSAnQU1QLUFEJyB8fCB0YWdOYW1lID09ICdBTVAtRU1CRUQnKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIExPQURJTkdfRUxFTUVOVFNfW3RhZ05hbWVdIHx8IGZhbHNlO1xufVxuXG5cbi8qKlxuICogQXBwbGllcyBsYXlvdXQgdG8gdGhlIGVsZW1lbnQuIFZpc2libGUgZm9yIHRlc3Rpbmcgb25seS5cbiAqXG4gKiBcXCAgIFxcICAvICBcXCAgLyAgIC8gLyAgIFxcICAgICB8ICAgXyAgXFwgICAgIHwgIFxcIHwgIHwgfCAgfCB8ICBcXCB8ICB8ICAvIF9fX19ffFxuICogIFxcICAgXFwvICAgIFxcLyAgIC8gLyAgXiAgXFwgICAgfCAgfF8pICB8ICAgIHwgICBcXHwgIHwgfCAgfCB8ICAgXFx8ICB8IHwgIHwgIF9fXG4gKiAgIFxcICAgICAgICAgICAgLyAvICAvX1xcICBcXCAgIHwgICAgICAvICAgICB8ICAuIGAgIHwgfCAgfCB8ICAuIGAgIHwgfCAgfCB8XyB8XG4gKiAgICBcXCAgICAvXFwgICAgLyAvICBfX19fXyAgXFwgIHwgIHxcXCAgXFwtLS0tLnwgIHxcXCAgIHwgfCAgfCB8ICB8XFwgICB8IHwgIHxfX3wgfFxuICogICAgIFxcX18vICBcXF9fLyAvX18vICAgICBcXF9fXFwgfCBffCBgLl9fX19ffHxfX3wgXFxfX3wgfF9ffCB8X198IFxcX198ICBcXF9fX19fX3xcbiAqXG4gKiBUaGUgZXF1aXZhbGVudCBvZiB0aGlzIG1ldGhvZCBpcyB1c2VkIGZvciBzZXJ2ZXItc2lkZSByZW5kZXJpbmcgKFNTUikgYW5kXG4gKiBhbnkgY2hhbmdlcyBtYWRlIHRvIGl0IG11c3QgYmUgbWFkZSBpbiBjb29yZGluYXRpb24gd2l0aCBjYWNoZXMgdGhhdFxuICogaW1wbGVtZW50IFNTUi4gRm9yIG1vcmUgaW5mb3JtYXRpb24gb24gU1NSIHNlZSBiaXQubHkvYW1wLXNzci5cbiAqXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHshTGF5b3V0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlTdGF0aWNMYXlvdXQoZWxlbWVudCkge1xuICAvLyBDaGVjayBpZiB0aGUgbGF5b3V0IGhhcyBhbHJlYWR5IGJlZW4gZG9uZSBieSBzZXJ2ZXItc2lkZSByZW5kZXJpbmcuIFRoZVxuICAvLyBkb2N1bWVudCBtYXkgYmUgdmlzaWJsZSB0byB0aGUgdXNlciBpZiB0aGUgYm9pbGVycGxhdGUgd2FzIHJlbW92ZWQgc29cbiAgLy8gcGxlYXNlIHRha2UgY2FyZSBpbiBtYWtpbmcgY2hhbmdlcyBoZXJlLlxuICBjb25zdCBjb21wbGV0ZWRMYXlvdXRBdHRyID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2ktYW1waHRtbC1sYXlvdXQnKTtcbiAgaWYgKGNvbXBsZXRlZExheW91dEF0dHIpIHtcbiAgICBjb25zdCBsYXlvdXQgPSAvKiogQHR5cGUgeyFMYXlvdXR9ICovIChkZXYoKS5hc3NlcnQoXG4gICAgICAgIHBhcnNlTGF5b3V0KGNvbXBsZXRlZExheW91dEF0dHIpKSk7XG4gICAgaWYgKChsYXlvdXQgPT0gTGF5b3V0LlJFU1BPTlNJVkUgfHwgbGF5b3V0ID09IExheW91dC5JTlRSSU5TSUMpXG4gICAgICAmJiBlbGVtZW50LmZpcnN0RWxlbWVudENoaWxkKSB7XG4gICAgICAvLyBGaW5kIHNpemVyLCBidXQgYXNzdW1lIHRoYXQgaXQgbWlnaHQgbm90IGhhdmUgYmVlbiBwYXJzZWQgeWV0LlxuICAgICAgZWxlbWVudC5zaXplckVsZW1lbnQgPVxuICAgICAgICAgIGVsZW1lbnQucXVlcnlTZWxlY3RvcignaS1hbXBodG1sLXNpemVyJykgfHwgdW5kZWZpbmVkO1xuICAgIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5OT0RJU1BMQVkpIHtcbiAgICAgIGFwcGx5Tm9EaXNwbGF5TGF5b3V0KGVsZW1lbnQpO1xuICAgIH1cbiAgICByZXR1cm4gbGF5b3V0O1xuICB9XG5cbiAgLy8gSWYgdGhlIGxheW91dCB3YXMgYWxyZWFkeSBkb25lIGJ5IHNlcnZlci1zaWRlIHJlbmRlcmluZyAoU1NSKSwgdGhlbiB0aGVcbiAgLy8gY29kZSBiZWxvdyB3aWxsIG5vdCBydW4uIEFueSBjaGFuZ2VzIGJlbG93IHdpbGwgbmVjZXNzaXRhdGUgYSBjaGFuZ2UgdG8gU1NSXG4gIC8vIGFuZCBtdXN0IGJlIGNvb3JkaW5hdGVkIHdpdGggY2FjaGVzIHRoYXQgaW1wbGVtZW50IFNTUi4gU2VlIGJpdC5seS9hbXAtc3NyLlxuXG4gIC8vIFBhcnNlIGxheW91dCBmcm9tIHRoZSBlbGVtZW50LlxuICBjb25zdCBsYXlvdXRBdHRyID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2xheW91dCcpO1xuICBjb25zdCB3aWR0aEF0dHIgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnd2lkdGgnKTtcbiAgY29uc3QgaGVpZ2h0QXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdoZWlnaHQnKTtcbiAgY29uc3Qgc2l6ZXNBdHRyID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3NpemVzJyk7XG4gIGNvbnN0IGhlaWdodHNBdHRyID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2hlaWdodHMnKTtcblxuICAvLyBJbnB1dCBsYXlvdXQgYXR0cmlidXRlcy5cbiAgY29uc3QgaW5wdXRMYXlvdXQgPSBsYXlvdXRBdHRyID8gcGFyc2VMYXlvdXQobGF5b3V0QXR0cikgOiBudWxsO1xuICB1c2VyKCkuYXNzZXJ0KGlucHV0TGF5b3V0ICE9PSB1bmRlZmluZWQsICdVbmtub3duIGxheW91dDogJXMnLCBsYXlvdXRBdHRyKTtcbiAgLyoqIEBjb25zdCB7c3RyaW5nfG51bGx8dW5kZWZpbmVkfSAqL1xuICBjb25zdCBpbnB1dFdpZHRoID0gKHdpZHRoQXR0ciAmJiB3aWR0aEF0dHIgIT0gJ2F1dG8nKSA/XG4gICAgcGFyc2VMZW5ndGgod2lkdGhBdHRyKSA6IHdpZHRoQXR0cjtcbiAgdXNlcigpLmFzc2VydChpbnB1dFdpZHRoICE9PSB1bmRlZmluZWQsICdJbnZhbGlkIHdpZHRoIHZhbHVlOiAlcycsIHdpZHRoQXR0cik7XG4gIC8qKiBAY29uc3Qge3N0cmluZ3xudWxsfHVuZGVmaW5lZH0gKi9cbiAgY29uc3QgaW5wdXRIZWlnaHQgPSAoaGVpZ2h0QXR0ciAmJiBoZWlnaHRBdHRyICE9ICdmbHVpZCcpID9cbiAgICBwYXJzZUxlbmd0aChoZWlnaHRBdHRyKSA6IGhlaWdodEF0dHI7XG4gIHVzZXIoKS5hc3NlcnQoaW5wdXRIZWlnaHQgIT09IHVuZGVmaW5lZCwgJ0ludmFsaWQgaGVpZ2h0IHZhbHVlOiAlcycsXG4gICAgICBoZWlnaHRBdHRyKTtcblxuICAvLyBFZmZlY3RpdmUgbGF5b3V0IGF0dHJpYnV0ZXMuIFRoZXNlIGFyZSBlZmZlY3RpdmVseSBjb25zdGFudHMuXG4gIGxldCB3aWR0aDtcbiAgbGV0IGhlaWdodDtcbiAgbGV0IGxheW91dDtcblxuICAvLyBDYWxjdWxhdGUgZWZmZWN0aXZlIHdpZHRoIGFuZCBoZWlnaHQuXG4gIGlmICgoIWlucHV0TGF5b3V0IHx8IGlucHV0TGF5b3V0ID09IExheW91dC5GSVhFRCB8fFxuICAgICAgaW5wdXRMYXlvdXQgPT0gTGF5b3V0LkZJWEVEX0hFSUdIVCkgJiZcbiAgICAgICghaW5wdXRXaWR0aCB8fCAhaW5wdXRIZWlnaHQpICYmIGhhc05hdHVyYWxEaW1lbnNpb25zKGVsZW1lbnQudGFnTmFtZSkpIHtcbiAgICAvLyBEZWZhdWx0IHdpZHRoIGFuZCBoZWlnaHQ6IGhhbmRsZSBlbGVtZW50cyB0aGF0IGRvIG5vdCBzcGVjaWZ5IGFcbiAgICAvLyB3aWR0aC9oZWlnaHQgYW5kIGFyZSBkZWZpbmVkIHRvIGhhdmUgbmF0dXJhbCBicm93c2VyIGRpbWVuc2lvbnMuXG4gICAgY29uc3QgZGltZW5zaW9ucyA9IGdldE5hdHVyYWxEaW1lbnNpb25zKGVsZW1lbnQpO1xuICAgIHdpZHRoID0gKGlucHV0V2lkdGggfHwgaW5wdXRMYXlvdXQgPT0gTGF5b3V0LkZJWEVEX0hFSUdIVCkgPyBpbnB1dFdpZHRoIDpcbiAgICAgIGRpbWVuc2lvbnMud2lkdGg7XG4gICAgaGVpZ2h0ID0gaW5wdXRIZWlnaHQgfHwgZGltZW5zaW9ucy5oZWlnaHQ7XG4gIH0gZWxzZSB7XG4gICAgd2lkdGggPSBpbnB1dFdpZHRoO1xuICAgIGhlaWdodCA9IGlucHV0SGVpZ2h0O1xuICB9XG5cbiAgLy8gQ2FsY3VsYXRlIGVmZmVjdGl2ZSBsYXlvdXQuXG4gIGlmIChpbnB1dExheW91dCkge1xuICAgIGxheW91dCA9IGlucHV0TGF5b3V0O1xuICB9IGVsc2UgaWYgKCF3aWR0aCAmJiAhaGVpZ2h0KSB7XG4gICAgbGF5b3V0ID0gTGF5b3V0LkNPTlRBSU5FUjtcbiAgfSBlbHNlIGlmIChoZWlnaHQgPT0gJ2ZsdWlkJykge1xuICAgIGxheW91dCA9IExheW91dC5GTFVJRDtcbiAgfSBlbHNlIGlmIChoZWlnaHQgJiYgKCF3aWR0aCB8fCB3aWR0aCA9PSAnYXV0bycpKSB7XG4gICAgbGF5b3V0ID0gTGF5b3V0LkZJWEVEX0hFSUdIVDtcbiAgfSBlbHNlIGlmIChoZWlnaHQgJiYgd2lkdGggJiYgKHNpemVzQXR0ciB8fCBoZWlnaHRzQXR0cikpIHtcbiAgICBsYXlvdXQgPSBMYXlvdXQuUkVTUE9OU0lWRTtcbiAgfSBlbHNlIHtcbiAgICBsYXlvdXQgPSBMYXlvdXQuRklYRUQ7XG4gIH1cblxuICAvLyBWZXJpZnkgbGF5b3V0IGF0dHJpYnV0ZXMuXG4gIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZJWEVEIHx8IGxheW91dCA9PSBMYXlvdXQuRklYRURfSEVJR0hUIHx8XG4gICAgICBsYXlvdXQgPT0gTGF5b3V0LlJFU1BPTlNJVkUgfHwgbGF5b3V0ID09IExheW91dC5JTlRSSU5TSUMpIHtcbiAgICB1c2VyKCkuYXNzZXJ0KGhlaWdodCwgJ0V4cGVjdGVkIGhlaWdodCB0byBiZSBhdmFpbGFibGU6ICVzJywgaGVpZ2h0QXR0cik7XG4gIH1cbiAgaWYgKGxheW91dCA9PSBMYXlvdXQuRklYRURfSEVJR0hUKSB7XG4gICAgdXNlcigpLmFzc2VydCghd2lkdGggfHwgd2lkdGggPT0gJ2F1dG8nLFxuICAgICAgICAnRXhwZWN0ZWQgd2lkdGggdG8gYmUgZWl0aGVyIGFic2VudCBvciBlcXVhbCBcImF1dG9cIiAnICtcbiAgICAgICAgJ2ZvciBmaXhlZC1oZWlnaHQgbGF5b3V0OiAlcycsIHdpZHRoQXR0cik7XG4gIH1cbiAgaWYgKGxheW91dCA9PSBMYXlvdXQuRklYRUQgfHwgbGF5b3V0ID09IExheW91dC5SRVNQT05TSVZFIHx8XG4gICAgICBsYXlvdXQgPT0gTGF5b3V0LklOVFJJTlNJQykge1xuICAgIHVzZXIoKS5hc3NlcnQod2lkdGggJiYgd2lkdGggIT0gJ2F1dG8nLFxuICAgICAgICAnRXhwZWN0ZWQgd2lkdGggdG8gYmUgYXZhaWxhYmxlIGFuZCBub3QgZXF1YWwgdG8gXCJhdXRvXCI6ICVzJyxcbiAgICAgICAgd2lkdGhBdHRyKTtcbiAgfVxuXG4gIGlmIChsYXlvdXQgPT0gTGF5b3V0LlJFU1BPTlNJVkUgfHwgbGF5b3V0ID09IExheW91dC5JTlRSSU5TSUMpIHtcbiAgICB1c2VyKCkuYXNzZXJ0KGdldExlbmd0aFVuaXRzKHdpZHRoKSA9PSBnZXRMZW5ndGhVbml0cyhoZWlnaHQpLFxuICAgICAgICAnTGVuZ3RoIHVuaXRzIHNob3VsZCBiZSB0aGUgc2FtZSBmb3Igd2lkdGggYW5kIGhlaWdodDogJXMsICVzJyxcbiAgICAgICAgd2lkdGhBdHRyLCBoZWlnaHRBdHRyKTtcbiAgfSBlbHNlIHtcbiAgICB1c2VyKCkuYXNzZXJ0KGhlaWdodHNBdHRyID09PSBudWxsLFxuICAgICAgICAnVW5leHBlY3RlZCBcImhlaWdodHNcIiBhdHRyaWJ1dGUgZm9yIG5vbmUtcmVzcG9uc2l2ZSBsYXlvdXQnKTtcbiAgfVxuXG4gIC8vIEFwcGx5IFVJLlxuICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoZ2V0TGF5b3V0Q2xhc3MobGF5b3V0KSk7XG4gIGlmIChpc0xheW91dFNpemVEZWZpbmVkKGxheW91dCkpIHtcbiAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2ktYW1waHRtbC1sYXlvdXQtc2l6ZS1kZWZpbmVkJyk7XG4gIH1cbiAgaWYgKGxheW91dCA9PSBMYXlvdXQuTk9ESVNQTEFZKSB7XG4gICAgLy8gQ1NTIGRlZmluZXMgbGF5b3V0PW5vZGlzcGxheSBhdXRvbWF0aWNhbGx5IHdpdGggYGRpc3BsYXk6bm9uZWAuIFRodXNcbiAgICAvLyBubyBhZGRpdGlvbmFsIHN0eWxpbmcgaXMgbmVlZGVkLlxuICAgIGFwcGx5Tm9EaXNwbGF5TGF5b3V0KGVsZW1lbnQpO1xuICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuRklYRUQpIHtcbiAgICBzZXRTdHlsZXMoZWxlbWVudCwge1xuICAgICAgd2lkdGg6IGRldigpLmFzc2VydFN0cmluZyh3aWR0aCksXG4gICAgICBoZWlnaHQ6IGRldigpLmFzc2VydFN0cmluZyhoZWlnaHQpLFxuICAgIH0pO1xuICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuRklYRURfSEVJR0hUKSB7XG4gICAgc2V0U3R5bGUoZWxlbWVudCwgJ2hlaWdodCcsIGRldigpLmFzc2VydFN0cmluZyhoZWlnaHQpKTtcbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LlJFU1BPTlNJVkUpIHtcbiAgICBjb25zdCBzaXplciA9IGVsZW1lbnQub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpLWFtcGh0bWwtc2l6ZXInKTtcbiAgICBzZXRTdHlsZXMoc2l6ZXIsIHtcbiAgICAgIGRpc3BsYXk6ICdibG9jaycsXG4gICAgICBwYWRkaW5nVG9wOlxuICAgICAgICAoKGdldExlbmd0aE51bWVyYWwoaGVpZ2h0KSAvIGdldExlbmd0aE51bWVyYWwod2lkdGgpKSAqIDEwMCkgKyAnJScsXG4gICAgfSk7XG4gICAgZWxlbWVudC5pbnNlcnRCZWZvcmUoc2l6ZXIsIGVsZW1lbnQuZmlyc3RDaGlsZCk7XG4gICAgZWxlbWVudC5zaXplckVsZW1lbnQgPSBzaXplcjtcbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LklOVFJJTlNJQykge1xuICAgIC8vIEludHJpbnNpYyB1c2VzIGFuIHN2ZyBpbnNpZGUgdGhlIHNpemVyIGVsZW1lbnQgcmF0aGVyIHRoYW4gdGhlIHBhZGRpbmdcbiAgICAvLyB0cmljayBOb3RlIGEgbmFrZWQgc3ZnIHdvbid0IHdvcmsgYmVjYXN1ZSBvdGhlciB0aGluZyBleHBlY3QgdGhlXG4gICAgLy8gaS1hbXBodG1sLXNpemVyIGVsZW1lbnRcbiAgICBjb25zdCBzaXplciA9IGh0bWxGb3IoZWxlbWVudClgXG4gICAgICA8aS1hbXBodG1sLXNpemVyIGNsYXNzPVwiaS1hbXBodG1sLXNpemVyXCI+XG4gICAgICAgIDxpbWcgY2xhc3M9XCJpLWFtcGh0bWwtaW50cmluc2ljLXNpemVyXCIgLz5cbiAgICAgIDwvaS1hbXBodG1sLXNpemVyPmA7XG4gICAgY29uc3QgaW50cmluc2ljU2l6ZXIgPSBzaXplci5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICBpbnRyaW5zaWNTaXplci5zZXRBdHRyaWJ1dGUoJ3NyYycsXG4gICAgICAgIGBkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCw8c3ZnIGhlaWdodD1cIiR7aGVpZ2h0fVwiIHdpZHRoPVwiJHt3aWR0aH1cIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmVyc2lvbj1cIjEuMVwiLz5gKTtcbiAgICBlbGVtZW50Lmluc2VydEJlZm9yZShzaXplciwgZWxlbWVudC5maXJzdENoaWxkKTtcbiAgICAvLyBUT0RPKGpwZXR0aXR0KTogc2l6ZXIgaXMgbGVha2VkIGFuZCBjYW4ndCBiZSBjbGVhbmVkIHVwLlxuICAgIGVsZW1lbnQuc2l6ZXJFbGVtZW50ID0gaW50cmluc2ljU2l6ZXI7XG4gIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5GSUxMKSB7XG4gICAgLy8gRG8gbm90aGluZy5cbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LkNPTlRBSU5FUikge1xuICAgIC8vIERvIG5vdGhpbmcuIEVsZW1lbnRzIHRoZW1zZWx2ZXMgd2lsbCBjaGVjayB3aGV0aGVyIHRoZSBzdXBwbGllZFxuICAgIC8vIGxheW91dCB2YWx1ZSBpcyBhY2NlcHRhYmxlLiBJbiBwYXJ0aWN1bGFyIGNvbnRhaW5lciBpcyBvbmx5IE9LXG4gICAgLy8gc29tZXRpbWVzLlxuICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuRkxFWF9JVEVNKSB7XG4gICAgLy8gU2V0IGhlaWdodCBhbmQgd2lkdGggdG8gYSBmbGV4IGl0ZW0gaWYgdGhleSBleGlzdC5cbiAgICAvLyBUaGUgc2l6ZSBzZXQgdG8gYSBmbGV4IGl0ZW0gY291bGQgYmUgb3ZlcnJpZGRlbiBieSBgZGlzcGxheTogZmxleGAgbGF0ZXIuXG4gICAgaWYgKHdpZHRoKSB7XG4gICAgICBzZXRTdHlsZShlbGVtZW50LCAnd2lkdGgnLCB3aWR0aCk7XG4gICAgfVxuICAgIGlmIChoZWlnaHQpIHtcbiAgICAgIHNldFN0eWxlKGVsZW1lbnQsICdoZWlnaHQnLCBoZWlnaHQpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZMVUlEKSB7XG4gICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdpLWFtcGh0bWwtbGF5b3V0LWF3YWl0aW5nLXNpemUnKTtcbiAgICBpZiAod2lkdGgpIHtcbiAgICAgIHNldFN0eWxlKGVsZW1lbnQsICd3aWR0aCcsIHdpZHRoKTtcbiAgICB9XG4gICAgc2V0U3R5bGUoZWxlbWVudCwgJ2hlaWdodCcsIDApO1xuICB9XG4gIHJldHVybiBsYXlvdXQ7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKi9cbmZ1bmN0aW9uIGFwcGx5Tm9EaXNwbGF5TGF5b3V0KGVsZW1lbnQpIHtcbiAgLy8gVE9ETyhkdm95dGVua28sICM5MzUzKTogb25jZSBgdG9nZ2xlTGF5b3V0RGlzcGxheWAgQVBJIGhhcyBiZWVuIGRlcGxveWVkXG4gIC8vIGV2ZXJ5d2hlcmUsIHN3aXRjaCBhbGwgcmVsZXZhbnQgZWxlbWVudHMgdG8gdGhpcyBBUEkuIEluIHRoZSBtZWFudGltZSxcbiAgLy8gc2ltcGx5IHVuYmxvY2sgZGlzcGxheSB0b2dnbGluZyB2aWEgYHN0eWxlPVwiZGlzcGxheTogLi4uXCJgLlxuICBzZXRTdHlsZShlbGVtZW50LCAnZGlzcGxheScsICdub25lJyk7XG4gIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaS1hbXBodG1sLWRpc3BsYXknKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4vbW9kZSc7XG5pbXBvcnQge2dldE1vZGVPYmplY3R9IGZyb20gJy4vbW9kZS1vYmplY3QnO1xuaW1wb3J0IHtpc0VudW1WYWx1ZX0gZnJvbSAnLi90eXBlcyc7XG5cbi8qKlxuICogVHJpcGxlIHplcm8gd2lkdGggc3BhY2UuXG4gKlxuICogVGhpcyBpcyBhZGRlZCB0byB1c2VyIGVycm9yIG1lc3NhZ2VzLCBzbyB0aGF0IHdlIGNhbiBsYXRlciBpZGVudGlmeVxuICogdGhlbSwgd2hlbiB0aGUgb25seSB0aGluZyB0aGF0IHdlIGhhdmUgaXMgdGhlIG1lc3NhZ2UuIFRoaXMgaXMgdGhlXG4gKiBjYXNlIGluIG1hbnkgYnJvd3NlcnMgd2hlbiB0aGUgZ2xvYmFsIGV4Y2VwdGlvbiBoYW5kbGVyIGlzIGludm9rZWQuXG4gKlxuICogQGNvbnN0IHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBjb25zdCBVU0VSX0VSUk9SX1NFTlRJTkVMID0gJ1xcdTIwMEJcXHUyMDBCXFx1MjAwQic7XG5cblxuLyoqXG4gKiBGb3VyIHplcm8gd2lkdGggc3BhY2UuXG4gKlxuICogQGNvbnN0IHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBjb25zdCBVU0VSX0VSUk9SX0VNQkVEX1NFTlRJTkVMID0gJ1xcdTIwMEJcXHUyMDBCXFx1MjAwQlxcdTIwMEInO1xuXG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhpcyBtZXNzYWdlIHdhcyBhIHVzZXIgZXJyb3IuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1VzZXJFcnJvck1lc3NhZ2UobWVzc2FnZSkge1xuICByZXR1cm4gbWVzc2FnZS5pbmRleE9mKFVTRVJfRVJST1JfU0VOVElORUwpID49IDA7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhpcyBtZXNzYWdlIHdhcyBhIGEgdXNlciBlcnJvciBmcm9tIGFuIGlmcmFtZSBlbWJlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVXNlckVycm9yRW1iZWQobWVzc2FnZSkge1xuICByZXR1cm4gbWVzc2FnZS5pbmRleE9mKFVTRVJfRVJST1JfRU1CRURfU0VOVElORUwpID49IDA7XG59XG5cblxuLyoqXG4gKiBAZW51bSB7bnVtYmVyfVxuICogQHByaXZhdGUgVmlzaWJsZSBmb3IgdGVzdGluZyBvbmx5LlxuICovXG5leHBvcnQgY29uc3QgTG9nTGV2ZWwgPSB7XG4gIE9GRjogMCxcbiAgRVJST1I6IDEsXG4gIFdBUk46IDIsXG4gIElORk86IDMsXG4gIEZJTkU6IDQsXG59O1xuXG4vKipcbiAqIFNldHMgcmVwb3J0RXJyb3IgZnVuY3Rpb24uIENhbGxlZCBmcm9tIGVycm9yLmpzIHRvIGJyZWFrIGN5Y2xpY1xuICogZGVwZW5kZW5jeS5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKiwgIUVsZW1lbnQ9KXx1bmRlZmluZWR9IGZuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRSZXBvcnRFcnJvcihmbikge1xuICBzZWxmLnJlcG9ydEVycm9yID0gZm47XG59XG5cbi8qKlxuICogQHR5cGUgeyFMb2dMZXZlbHx1bmRlZmluZWR9XG4gKiBAcHJpdmF0ZVxuICovXG5sZXQgbGV2ZWxPdmVycmlkZV8gPSB1bmRlZmluZWQ7XG5cbi8qKlxuICogQHBhcmFtIHshTG9nTGV2ZWx9IGxldmVsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvdmVycmlkZUxvZ0xldmVsKGxldmVsKSB7XG4gIGxldmVsT3ZlcnJpZGVfID0gbGV2ZWw7XG59XG5cbi8qKlxuICogTG9nZ2luZyBjbGFzcy4gVXNlIG9mIHNlbnRpbmVsIHN0cmluZyBpbnN0ZWFkIG9mIGEgYm9vbGVhbiB0byBjaGVjayB1c2VyL2RldlxuICogZXJyb3JzIGJlY2F1c2UgZXJyb3JzIGNvdWxkIGJlIHJldGhyb3duIGJ5IHNvbWUgbmF0aXZlIGNvZGUgYXMgYSBuZXcgZXJyb3IsXG4gKiBhbmQgb25seSBhIG1lc3NhZ2Ugd291bGQgc3Vydml2ZS4gQWxzbywgc29tZSBicm93c2VyIGRvbuKAmXQgc3VwcG9ydCBhIDV0aFxuICogZXJyb3Igb2JqZWN0IGFyZ3VtZW50IGluIHdpbmRvdy5vbmVycm9yLiBMaXN0IG9mIHN1cHBvcnRpbmcgYnJvd3NlciBjYW4gYmVcbiAqIGZvdW5kIGhlcmU6XG4gKiBodHRwczovL2Jsb2cuc2VudHJ5LmlvLzIwMTYvMDEvMDQvY2xpZW50LWphdmFzY3JpcHQtcmVwb3J0aW5nLXdpbmRvdy1vbmVycm9yLmh0bWxcbiAqIEBmaW5hbFxuICogQHByaXZhdGUgVmlzaWJsZSBmb3IgdGVzdGluZyBvbmx5LlxuICovXG5leHBvcnQgY2xhc3MgTG9nIHtcbiAgLyoqXG4gICAqIG9wdF9zdWZmaXggd2lsbCBiZSBhcHBlbmRlZCB0byBlcnJvciBtZXNzYWdlIHRvIGlkZW50aWZ5IHRoZSB0eXBlIG9mIHRoZVxuICAgKiBlcnJvciBtZXNzYWdlLiBXZSBjYW4ndCByZWx5IG9uIHRoZSBlcnJvciBvYmplY3QgdG8gcGFzcyBhbG9uZyB0aGUgdHlwZVxuICAgKiBiZWNhdXNlIHNvbWUgYnJvd3NlcnMgZG8gbm90IGhhdmUgdGhpcyBwYXJhbSBpbiBpdHMgd2luZG93Lm9uZXJyb3IgQVBJLlxuICAgKiBTZWU6XG4gICAqIGh0dHBzOi8vYmxvZy5zZW50cnkuaW8vMjAxNi8wMS8wNC9jbGllbnQtamF2YXNjcmlwdC1yZXBvcnRpbmctd2luZG93LW9uZXJyb3IuaHRtbFxuICAgKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCEuL21vZGUuTW9kZURlZik6IUxvZ0xldmVsfSBsZXZlbEZ1bmNcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfc3VmZml4XG4gICAqL1xuICBjb25zdHJ1Y3Rvcih3aW4sIGxldmVsRnVuYywgb3B0X3N1ZmZpeCkge1xuICAgIC8qKlxuICAgICAqIEluIHRlc3RzIHdlIHVzZSB0aGUgbWFpbiB0ZXN0IHdpbmRvdyBpbnN0ZWFkIG9mIHRoZSBpZnJhbWUgd2hlcmVcbiAgICAgKiB0aGUgdGVzdHMgcnVucyBiZWNhdXNlIG9ubHkgdGhlIGZvcm1lciBpcyByZWxheWVkIHRvIHRoZSBjb25zb2xlLlxuICAgICAqIEBjb25zdCB7IVdpbmRvd31cbiAgICAgKi9cbiAgICB0aGlzLndpbiA9IChnZXRNb2RlKCkudGVzdCAmJiB3aW4uQU1QX1RFU1RfSUZSQU1FKSA/IHdpbi5wYXJlbnQgOiB3aW47XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtmdW5jdGlvbighLi9tb2RlLk1vZGVEZWYpOiFMb2dMZXZlbH0gKi9cbiAgICB0aGlzLmxldmVsRnVuY18gPSBsZXZlbEZ1bmM7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshTG9nTGV2ZWx9ICovXG4gICAgdGhpcy5sZXZlbF8gPSB0aGlzLmRlZmF1bHRMZXZlbF8oKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge3N0cmluZ30gKi9cbiAgICB0aGlzLnN1ZmZpeF8gPSBvcHRfc3VmZml4IHx8ICcnO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFMb2dMZXZlbH1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdldExldmVsXygpIHtcbiAgICByZXR1cm4gKGxldmVsT3ZlcnJpZGVfICE9PSB1bmRlZmluZWQpID8gbGV2ZWxPdmVycmlkZV8gOiB0aGlzLmxldmVsXztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshTG9nTGV2ZWx9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBkZWZhdWx0TGV2ZWxfKCkge1xuICAgIC8vIE5vIGNvbnNvbGUgLSBjYW4ndCBlbmFibGUgbG9nZ2luZy5cbiAgICBpZiAoIXRoaXMud2luLmNvbnNvbGUgfHwgIXRoaXMud2luLmNvbnNvbGUubG9nKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuT0ZGO1xuICAgIH1cblxuICAgIC8vIExvZ2dpbmcgaGFzIGJlZW4gZXhwbGljaXRseSBkaXNhYmxlZC5cbiAgICBpZiAoZ2V0TW9kZSgpLmxvZyA9PSAnMCcpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5PRkY7XG4gICAgfVxuXG4gICAgLy8gTG9nZ2luZyBpcyBlbmFibGVkIGZvciB0ZXN0cyBkaXJlY3RseS5cbiAgICBpZiAoZ2V0TW9kZSgpLnRlc3QgJiYgdGhpcy53aW4uRU5BQkxFX0xPRykge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLkZJTkU7XG4gICAgfVxuXG4gICAgLy8gTG9jYWxEZXYgYnkgZGVmYXVsdCBhbGxvd3MgSU5GTyBsZXZlbCwgdW5sZXNzIG92ZXJyaWRlbiBieSBgI2xvZ2AuXG4gICAgaWYgKGdldE1vZGUoKS5sb2NhbERldiAmJiAhZ2V0TW9kZSgpLmxvZykge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLklORk87XG4gICAgfVxuXG4gICAgLy8gRGVsZWdhdGUgdG8gdGhlIHNwZWNpZmljIHJlc29sdmVyLlxuICAgIHJldHVybiB0aGlzLmxldmVsRnVuY18oZ2V0TW9kZU9iamVjdCgpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBsZXZlbFxuICAgKiBAcGFyYW0geyFBcnJheX0gbWVzc2FnZXNcbiAgICovXG4gIG1zZ18odGFnLCBsZXZlbCwgbWVzc2FnZXMpIHtcbiAgICBpZiAodGhpcy5nZXRMZXZlbF8oKSAhPSBMb2dMZXZlbC5PRkYpIHtcbiAgICAgIGxldCBmbiA9IHRoaXMud2luLmNvbnNvbGUubG9nO1xuICAgICAgaWYgKGxldmVsID09ICdFUlJPUicpIHtcbiAgICAgICAgZm4gPSB0aGlzLndpbi5jb25zb2xlLmVycm9yIHx8IGZuO1xuICAgICAgfSBlbHNlIGlmIChsZXZlbCA9PSAnSU5GTycpIHtcbiAgICAgICAgZm4gPSB0aGlzLndpbi5jb25zb2xlLmluZm8gfHwgZm47XG4gICAgICB9IGVsc2UgaWYgKGxldmVsID09ICdXQVJOJykge1xuICAgICAgICBmbiA9IHRoaXMud2luLmNvbnNvbGUud2FybiB8fCBmbjtcbiAgICAgIH1cbiAgICAgIGlmIChnZXRNb2RlKCkubG9jYWxEZXYpIHtcbiAgICAgICAgbWVzc2FnZXMudW5zaGlmdCgnWycgKyB0YWcgKyAnXScpO1xuICAgICAgfVxuICAgICAgZm4uYXBwbHkodGhpcy53aW4uY29uc29sZSwgbWVzc2FnZXMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBsb2dnaW5nIGlzIGVuYWJsZWQuXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBpc0VuYWJsZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0TGV2ZWxfKCkgIT0gTG9nTGV2ZWwuT0ZGO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9ydHMgYSBmaW5lLWdyYWluZWQgbWVzc2FnZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqL1xuICBmaW5lKHRhZywgdmFyX2FyZ3MpIHtcbiAgICBpZiAodGhpcy5nZXRMZXZlbF8oKSA+PSBMb2dMZXZlbC5GSU5FKSB7XG4gICAgICB0aGlzLm1zZ18odGFnLCAnRklORScsIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGEgaW5mb3JtYXRpb25hbCBtZXNzYWdlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICovXG4gIGluZm8odGFnLCB2YXJfYXJncykge1xuICAgIGlmICh0aGlzLmdldExldmVsXygpID49IExvZ0xldmVsLklORk8pIHtcbiAgICAgIHRoaXMubXNnXyh0YWcsICdJTkZPJywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9ydHMgYSB3YXJuaW5nIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKi9cbiAgd2Fybih0YWcsIHZhcl9hcmdzKSB7XG4gICAgaWYgKHRoaXMuZ2V0TGV2ZWxfKCkgPj0gTG9nTGV2ZWwuV0FSTikge1xuICAgICAgdGhpcy5tc2dfKHRhZywgJ1dBUk4nLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVwb3J0cyBhbiBlcnJvciBtZXNzYWdlLiBJZiB0aGUgbG9nZ2luZyBpcyBkaXNhYmxlZCwgdGhlIGVycm9yIGlzIHJldGhyb3duXG4gICAqIGFzeW5jaHJvbm91c2x5LlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICogQHJldHVybiB7IUVycm9yfHVuZGVmaW5lZH1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGVycm9yXyh0YWcsIHZhcl9hcmdzKSB7XG4gICAgaWYgKHRoaXMuZ2V0TGV2ZWxfKCkgPj0gTG9nTGV2ZWwuRVJST1IpIHtcbiAgICAgIHRoaXMubXNnXyh0YWcsICdFUlJPUicsIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBlcnJvciA9IGNyZWF0ZUVycm9yVmFyZ3MuYXBwbHkobnVsbCxcbiAgICAgICAgICBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICAgIHRoaXMucHJlcGFyZUVycm9yXyhlcnJvcik7XG4gICAgICByZXR1cm4gZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9ydHMgYW4gZXJyb3IgbWVzc2FnZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqL1xuICBlcnJvcih0YWcsIHZhcl9hcmdzKSB7XG4gICAgY29uc3QgZXJyb3IgPSB0aGlzLmVycm9yXy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmIChlcnJvcikge1xuICAgICAgZXJyb3IubmFtZSA9IHRhZyB8fCBlcnJvci5uYW1lO1xuICAgICAgLy8gcmVwb3J0RXJyb3IgaXMgaW5zdGFsbGVkIGdsb2JhbGx5IHBlciB3aW5kb3cgaW4gdGhlIGVudHJ5IHBvaW50LlxuICAgICAgc2VsZi5yZXBvcnRFcnJvcihlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9ydHMgYW4gZXJyb3IgbWVzc2FnZSBhbmQgbWFya3Mgd2l0aCBhbiBleHBlY3RlZCBwcm9wZXJ0eS4gSWYgdGhlXG4gICAqIGxvZ2dpbmcgaXMgZGlzYWJsZWQsIHRoZSBlcnJvciBpcyByZXRocm93biBhc3luY2hyb25vdXNseS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHVudXNlZFRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqL1xuICBleHBlY3RlZEVycm9yKHVudXNlZFRhZywgdmFyX2FyZ3MpIHtcbiAgICBjb25zdCBlcnJvciA9IHRoaXMuZXJyb3JfLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBlcnJvci5leHBlY3RlZCA9IHRydWU7XG4gICAgICAvLyByZXBvcnRFcnJvciBpcyBpbnN0YWxsZWQgZ2xvYmFsbHkgcGVyIHdpbmRvdyBpbiB0aGUgZW50cnkgcG9pbnQuXG4gICAgICBzZWxmLnJlcG9ydEVycm9yKGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBlcnJvciBvYmplY3QuXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICogQHJldHVybiB7IUVycm9yfVxuICAgKi9cbiAgY3JlYXRlRXJyb3IodmFyX2FyZ3MpIHtcbiAgICBjb25zdCBlcnJvciA9IGNyZWF0ZUVycm9yVmFyZ3MuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgICB0aGlzLnByZXBhcmVFcnJvcl8oZXJyb3IpO1xuICAgIHJldHVybiBlcnJvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGVycm9yIG9iamVjdCB3aXRoIGl0cyBleHBlY3RlZCBwcm9wZXJ0eSBzZXQgdG8gdHJ1ZS5cbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKiBAcmV0dXJuIHshRXJyb3J9XG4gICAqL1xuICBjcmVhdGVFeHBlY3RlZEVycm9yKHZhcl9hcmdzKSB7XG4gICAgY29uc3QgZXJyb3IgPSBjcmVhdGVFcnJvclZhcmdzLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgdGhpcy5wcmVwYXJlRXJyb3JfKGVycm9yKTtcbiAgICBlcnJvci5leHBlY3RlZCA9IHRydWU7XG4gICAgcmV0dXJuIGVycm9yO1xuICB9XG5cbiAgLyoqXG4gICAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgZmlyc3QgYXJndW1lbnQgaXNuJ3QgdHJ1ZWlzaC5cbiAgICpcbiAgICogU3VwcG9ydHMgYXJndW1lbnQgc3Vic3RpdHV0aW9uIGludG8gdGhlIG1lc3NhZ2UgdmlhICVzIHBsYWNlaG9sZGVycy5cbiAgICpcbiAgICogVGhyb3dzIGFuIGVycm9yIG9iamVjdCB0aGF0IGhhcyB0d28gZXh0cmEgcHJvcGVydGllczpcbiAgICogLSBhc3NvY2lhdGVkRWxlbWVudDogVGhpcyBpcyB0aGUgZmlyc3QgZWxlbWVudCBwcm92aWRlZCBpbiB0aGUgdmFyIGFyZ3MuXG4gICAqICAgSXQgY2FuIGJlIHVzZWQgZm9yIGltcHJvdmVkIGRpc3BsYXkgb2YgZXJyb3IgbWVzc2FnZXMuXG4gICAqIC0gbWVzc2FnZUFycmF5OiBUaGUgZWxlbWVudHMgb2YgdGhlIHN1YnN0aXR1dGVkIG1lc3NhZ2UgYXMgbm9uLXN0cmluZ2lmaWVkXG4gICAqICAgZWxlbWVudHMgaW4gYW4gYXJyYXkuIFdoZW4gZS5nLiBwYXNzZWQgdG8gY29uc29sZS5lcnJvciB0aGlzIHlpZWxkc1xuICAgKiAgIG5hdGl2ZSBkaXNwbGF5cyBvZiB0aGluZ3MgbGlrZSBIVE1MIGVsZW1lbnRzLlxuICAgKlxuICAgKiBAcGFyYW0ge1R9IHNob3VsZEJlVHJ1ZWlzaCBUaGUgdmFsdWUgdG8gYXNzZXJ0LiBUaGUgYXNzZXJ0IGZhaWxzIGlmIGl0IGRvZXNcbiAgICogICAgIG5vdCBldmFsdWF0ZSB0byB0cnVlLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9tZXNzYWdlIFRoZSBhc3NlcnRpb24gbWVzc2FnZVxuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzIEFyZ3VtZW50cyBzdWJzdGl0dXRlZCBpbnRvICVzIGluIHRoZSBtZXNzYWdlLlxuICAgKiBAcmV0dXJuIHtUfSBUaGUgdmFsdWUgb2Ygc2hvdWxkQmVUcnVlaXNoLlxuICAgKiBAdGVtcGxhdGUgVFxuICAgKiBlc2xpbnQgXCJnb29nbGUtY2FtZWxjYXNlL2dvb2dsZS1jYW1lbGNhc2VcIjogMFxuICAgKi9cbiAgYXNzZXJ0KHNob3VsZEJlVHJ1ZWlzaCwgb3B0X21lc3NhZ2UsIHZhcl9hcmdzKSB7XG4gICAgbGV0IGZpcnN0RWxlbWVudDtcbiAgICBpZiAoIXNob3VsZEJlVHJ1ZWlzaCkge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IG9wdF9tZXNzYWdlIHx8ICdBc3NlcnRpb24gZmFpbGVkJztcbiAgICAgIGNvbnN0IHNwbGl0TWVzc2FnZSA9IG1lc3NhZ2Uuc3BsaXQoJyVzJyk7XG4gICAgICBjb25zdCBmaXJzdCA9IHNwbGl0TWVzc2FnZS5zaGlmdCgpO1xuICAgICAgbGV0IGZvcm1hdHRlZCA9IGZpcnN0O1xuICAgICAgY29uc3QgbWVzc2FnZUFycmF5ID0gW107XG4gICAgICBwdXNoSWZOb25FbXB0eShtZXNzYWdlQXJyYXksIGZpcnN0KTtcbiAgICAgIGZvciAobGV0IGkgPSAyOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHZhbCA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgaWYgKHZhbCAmJiB2YWwudGFnTmFtZSkge1xuICAgICAgICAgIGZpcnN0RWxlbWVudCA9IHZhbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuZXh0Q29uc3RhbnQgPSBzcGxpdE1lc3NhZ2Uuc2hpZnQoKTtcbiAgICAgICAgbWVzc2FnZUFycmF5LnB1c2godmFsKTtcbiAgICAgICAgcHVzaElmTm9uRW1wdHkobWVzc2FnZUFycmF5LCBuZXh0Q29uc3RhbnQudHJpbSgpKTtcbiAgICAgICAgZm9ybWF0dGVkICs9IHRvU3RyaW5nKHZhbCkgKyBuZXh0Q29uc3RhbnQ7XG4gICAgICB9XG4gICAgICBjb25zdCBlID0gbmV3IEVycm9yKGZvcm1hdHRlZCk7XG4gICAgICBlLmZyb21Bc3NlcnQgPSB0cnVlO1xuICAgICAgZS5hc3NvY2lhdGVkRWxlbWVudCA9IGZpcnN0RWxlbWVudDtcbiAgICAgIGUubWVzc2FnZUFycmF5ID0gbWVzc2FnZUFycmF5O1xuICAgICAgdGhpcy5wcmVwYXJlRXJyb3JfKGUpO1xuICAgICAgLy8gcmVwb3J0RXJyb3IgaXMgaW5zdGFsbGVkIGdsb2JhbGx5IHBlciB3aW5kb3cgaW4gdGhlIGVudHJ5IHBvaW50LlxuICAgICAgc2VsZi5yZXBvcnRFcnJvcihlKTtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuICAgIHJldHVybiBzaG91bGRCZVRydWVpc2g7XG4gIH1cblxuICAvKipcbiAgICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpc24ndCBhbiBFbGVtZW50XG4gICAqXG4gICAqIE90aGVyd2lzZSBzZWUgYGFzc2VydGAgZm9yIHVzYWdlXG4gICAqXG4gICAqIEBwYXJhbSB7Kn0gc2hvdWxkQmVFbGVtZW50XG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X21lc3NhZ2UgVGhlIGFzc2VydGlvbiBtZXNzYWdlXG4gICAqIEByZXR1cm4geyFFbGVtZW50fSBUaGUgdmFsdWUgb2Ygc2hvdWxkQmVUcnVlaXNoLlxuICAgKiBAdGVtcGxhdGUgVFxuICAgKiBlc2xpbnQgXCJnb29nbGUtY2FtZWxjYXNlL2dvb2dsZS1jYW1lbGNhc2VcIjogMlxuICAgKi9cbiAgYXNzZXJ0RWxlbWVudChzaG91bGRCZUVsZW1lbnQsIG9wdF9tZXNzYWdlKSB7XG4gICAgY29uc3Qgc2hvdWxkQmVUcnVlaXNoID0gc2hvdWxkQmVFbGVtZW50ICYmIHNob3VsZEJlRWxlbWVudC5ub2RlVHlwZSA9PSAxO1xuICAgIHRoaXMuYXNzZXJ0KHNob3VsZEJlVHJ1ZWlzaCwgKG9wdF9tZXNzYWdlIHx8ICdFbGVtZW50IGV4cGVjdGVkJykgKyAnOiAlcycsXG4gICAgICAgIHNob3VsZEJlRWxlbWVudCk7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IUVsZW1lbnR9ICovIChzaG91bGRCZUVsZW1lbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgZmlyc3QgYXJndW1lbnQgaXNuJ3QgYSBzdHJpbmcuIFRoZSBzdHJpbmcgY2FuXG4gICAqIGJlIGVtcHR5LlxuICAgKlxuICAgKiBGb3IgbW9yZSBkZXRhaWxzIHNlZSBgYXNzZXJ0YC5cbiAgICpcbiAgICogQHBhcmFtIHsqfSBzaG91bGRCZVN0cmluZ1xuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9tZXNzYWdlIFRoZSBhc3NlcnRpb24gbWVzc2FnZVxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBzdHJpbmcgdmFsdWUuIENhbiBiZSBhbiBlbXB0eSBzdHJpbmcuXG4gICAqIGVzbGludCBcImdvb2dsZS1jYW1lbGNhc2UvZ29vZ2xlLWNhbWVsY2FzZVwiOiAyXG4gICAqL1xuICBhc3NlcnRTdHJpbmcoc2hvdWxkQmVTdHJpbmcsIG9wdF9tZXNzYWdlKSB7XG4gICAgdGhpcy5hc3NlcnQodHlwZW9mIHNob3VsZEJlU3RyaW5nID09ICdzdHJpbmcnLFxuICAgICAgICAob3B0X21lc3NhZ2UgfHwgJ1N0cmluZyBleHBlY3RlZCcpICsgJzogJXMnLCBzaG91bGRCZVN0cmluZyk7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAoc2hvdWxkQmVTdHJpbmcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgZmlyc3QgYXJndW1lbnQgaXNuJ3QgYSBudW1iZXIuIFRoZSBhbGxvd2VkIHZhbHVlc1xuICAgKiBpbmNsdWRlIGAwYCBhbmQgYE5hTmAuXG4gICAqXG4gICAqIEZvciBtb3JlIGRldGFpbHMgc2VlIGBhc3NlcnRgLlxuICAgKlxuICAgKiBAcGFyYW0geyp9IHNob3VsZEJlTnVtYmVyXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X21lc3NhZ2UgVGhlIGFzc2VydGlvbiBtZXNzYWdlXG4gICAqIEByZXR1cm4ge251bWJlcn0gVGhlIG51bWJlciB2YWx1ZS4gVGhlIGFsbG93ZWQgdmFsdWVzIGluY2x1ZGUgYDBgXG4gICAqICAgYW5kIGBOYU5gLlxuICAgKi9cbiAgYXNzZXJ0TnVtYmVyKHNob3VsZEJlTnVtYmVyLCBvcHRfbWVzc2FnZSkge1xuICAgIHRoaXMuYXNzZXJ0KHR5cGVvZiBzaG91bGRCZU51bWJlciA9PSAnbnVtYmVyJyxcbiAgICAgICAgKG9wdF9tZXNzYWdlIHx8ICdOdW1iZXIgZXhwZWN0ZWQnKSArICc6ICVzJywgc2hvdWxkQmVOdW1iZXIpO1xuICAgIHJldHVybiAvKiogQHR5cGUge251bWJlcn0gKi8gKHNob3VsZEJlTnVtYmVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzbid0IGEgYm9vbGVhbi5cbiAgICpcbiAgICogRm9yIG1vcmUgZGV0YWlscyBzZWUgYGFzc2VydGAuXG4gICAqXG4gICAqIEBwYXJhbSB7Kn0gc2hvdWxkQmVCb29sZWFuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X21lc3NhZ2UgVGhlIGFzc2VydGlvbiBtZXNzYWdlXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IFRoZSBib29sZWFuIHZhbHVlLlxuICAgKi9cbiAgYXNzZXJ0Qm9vbGVhbihzaG91bGRCZUJvb2xlYW4sIG9wdF9tZXNzYWdlKSB7XG4gICAgdGhpcy5hc3NlcnQoISFzaG91bGRCZUJvb2xlYW4gPT09IHNob3VsZEJlQm9vbGVhbixcbiAgICAgICAgKG9wdF9tZXNzYWdlIHx8ICdCb29sZWFuIGV4cGVjdGVkJykgKyAnOiAlcycsIHNob3VsZEJlQm9vbGVhbik7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi8gKHNob3VsZEJlQm9vbGVhbik7XG4gIH1cblxuICAvKipcbiAgICogQXNzZXJ0cyBhbmQgcmV0dXJucyB0aGUgZW51bSB2YWx1ZS4gSWYgdGhlIGVudW0gZG9lc24ndCBjb250YWluIHN1Y2ggYVxuICAgKiB2YWx1ZSwgdGhlIGVycm9yIGlzIHRocm93bi5cbiAgICpcbiAgICogQHBhcmFtIHshT2JqZWN0PFQ+fSBlbnVtT2JqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X2VudW1OYW1lXG4gICAqIEByZXR1cm4ge1R9XG4gICAqIEB0ZW1wbGF0ZSBUXG4gICAqIGVzbGludCBcImdvb2dsZS1jYW1lbGNhc2UvZ29vZ2xlLWNhbWVsY2FzZVwiOiAyXG4gICAqL1xuICBhc3NlcnRFbnVtVmFsdWUoZW51bU9iaiwgcywgb3B0X2VudW1OYW1lKSB7XG4gICAgaWYgKGlzRW51bVZhbHVlKGVudW1PYmosIHMpKSB7XG4gICAgICByZXR1cm4gcztcbiAgICB9XG4gICAgdGhpcy5hc3NlcnQoZmFsc2UsXG4gICAgICAgICdVbmtub3duICVzIHZhbHVlOiBcIiVzXCInLFxuICAgICAgICBvcHRfZW51bU5hbWUgfHwgJ2VudW0nLCBzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFcnJvcn0gZXJyb3JcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHByZXBhcmVFcnJvcl8oZXJyb3IpIHtcbiAgICBlcnJvciA9IGR1cGxpY2F0ZUVycm9ySWZOZWNlc3NhcnkoZXJyb3IpO1xuICAgIGlmICh0aGlzLnN1ZmZpeF8pIHtcbiAgICAgIGlmICghZXJyb3IubWVzc2FnZSkge1xuICAgICAgICBlcnJvci5tZXNzYWdlID0gdGhpcy5zdWZmaXhfO1xuICAgICAgfSBlbHNlIGlmIChlcnJvci5tZXNzYWdlLmluZGV4T2YodGhpcy5zdWZmaXhfKSA9PSAtMSkge1xuICAgICAgICBlcnJvci5tZXNzYWdlICs9IHRoaXMuc3VmZml4XztcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGlzVXNlckVycm9yTWVzc2FnZShlcnJvci5tZXNzYWdlKSkge1xuICAgICAgZXJyb3IubWVzc2FnZSA9IGVycm9yLm1lc3NhZ2UucmVwbGFjZShVU0VSX0VSUk9SX1NFTlRJTkVMLCAnJyk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd8IUVsZW1lbnR9IHZhbFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0b1N0cmluZyh2YWwpIHtcbiAgLy8gRG8gY2hlY2sgZXF1aXZhbGVudCB0byBgdmFsIGluc3RhbmNlb2YgRWxlbWVudGAgd2l0aG91dCBjcm9zcy13aW5kb3cgYnVnXG4gIGlmICh2YWwgJiYgdmFsLm5vZGVUeXBlID09IDEpIHtcbiAgICByZXR1cm4gdmFsLnRhZ05hbWUudG9Mb3dlckNhc2UoKSArICh2YWwuaWQgPyAnIycgKyB2YWwuaWQgOiAnJyk7XG4gIH1cbiAgcmV0dXJuIC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAodmFsKTtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IUFycmF5fSBhcnJheVxuICogQHBhcmFtIHsqfSB2YWxcbiAqL1xuZnVuY3Rpb24gcHVzaElmTm9uRW1wdHkoYXJyYXksIHZhbCkge1xuICBpZiAodmFsICE9ICcnKSB7XG4gICAgYXJyYXkucHVzaCh2YWwpO1xuICB9XG59XG5cbi8qKlxuICogU29tZSBleGNlcHRpb25zIChET01FeGNlcHRpb24sIG5hbWVseSkgaGF2ZSByZWFkLW9ubHkgbWVzc2FnZS5cbiAqIEBwYXJhbSB7IUVycm9yfSBlcnJvclxuICogQHJldHVybiB7IUVycm9yfTtcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGR1cGxpY2F0ZUVycm9ySWZOZWNlc3NhcnkoZXJyb3IpIHtcbiAgY29uc3Qge21lc3NhZ2V9ID0gZXJyb3I7XG4gIGNvbnN0IHRlc3QgPSBTdHJpbmcoTWF0aC5yYW5kb20oKSk7XG4gIGVycm9yLm1lc3NhZ2UgPSB0ZXN0O1xuXG4gIGlmIChlcnJvci5tZXNzYWdlID09PSB0ZXN0KSB7XG4gICAgZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgcmV0dXJuIGVycm9yO1xuICB9XG5cbiAgY29uc3QgZSA9IG5ldyBFcnJvcihlcnJvci5tZXNzYWdlKTtcbiAgLy8gQ29weSBhbGwgdGhlIGV4dHJhbmVvdXMgdGhpbmdzIHdlIGF0dGFjaC5cbiAgZm9yIChjb25zdCBwcm9wIGluIGVycm9yKSB7XG4gICAgZVtwcm9wXSA9IGVycm9yW3Byb3BdO1xuICB9XG4gIC8vIEVuc3VyZSB0aGVzZSBhcmUgY29waWVkLlxuICBlLnN0YWNrID0gZXJyb3Iuc3RhY2s7XG4gIHJldHVybiBlO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAqIEByZXR1cm4geyFFcnJvcn1cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRXJyb3JWYXJncyh2YXJfYXJncykge1xuICBsZXQgZXJyb3IgPSBudWxsO1xuICBsZXQgbWVzc2FnZSA9ICcnO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGFyZyA9IGFyZ3VtZW50c1tpXTtcbiAgICBpZiAoYXJnIGluc3RhbmNlb2YgRXJyb3IgJiYgIWVycm9yKSB7XG4gICAgICBlcnJvciA9IGR1cGxpY2F0ZUVycm9ySWZOZWNlc3NhcnkoYXJnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKG1lc3NhZ2UpIHtcbiAgICAgICAgbWVzc2FnZSArPSAnICc7XG4gICAgICB9XG4gICAgICBtZXNzYWdlICs9IGFyZztcbiAgICB9XG4gIH1cblxuICBpZiAoIWVycm9yKSB7XG4gICAgZXJyb3IgPSBuZXcgRXJyb3IobWVzc2FnZSk7XG4gIH0gZWxzZSBpZiAobWVzc2FnZSkge1xuICAgIGVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlICsgJzogJyArIGVycm9yLm1lc3NhZ2U7XG4gIH1cbiAgcmV0dXJuIGVycm9yO1xufVxuXG5cbi8qKlxuICogUmV0aHJvd3MgdGhlIGVycm9yIHdpdGhvdXQgdGVybWluYXRpbmcgdGhlIGN1cnJlbnQgY29udGV4dC4gVGhpcyBwcmVzZXJ2ZXNcbiAqIHdoZXRoZXIgdGhlIG9yaWdpbmFsIGVycm9yIGRlc2lnbmF0aW9uIGlzIGEgdXNlciBlcnJvciBvciBhIGRldiBlcnJvci5cbiAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJldGhyb3dBc3luYyh2YXJfYXJncykge1xuICBjb25zdCBlcnJvciA9IGNyZWF0ZUVycm9yVmFyZ3MuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgLy8gcmVwb3J0RXJyb3IgaXMgaW5zdGFsbGVkIGdsb2JhbGx5IHBlciB3aW5kb3cgaW4gdGhlIGVudHJ5IHBvaW50LlxuICAgIHNlbGYucmVwb3J0RXJyb3IoZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9KTtcbn1cblxuXG4vKipcbiAqIENhY2hlIGZvciBsb2dzLiBXZSBkbyBub3QgdXNlIGEgU2VydmljZSBzaW5jZSB0aGUgc2VydmljZSBtb2R1bGUgZGVwZW5kc1xuICogb24gTG9nIGFuZCBjbG9zdXJlIGxpdGVyYWxseSBjYW4ndCBldmVuLlxuICogQHR5cGUge3t1c2VyOiA/TG9nLCBkZXY6ID9Mb2csIHVzZXJGb3JFbWJlZDogP0xvZ319XG4gKi9cbnNlbGYubG9nID0gKHNlbGYubG9nIHx8IHtcbiAgdXNlcjogbnVsbCxcbiAgZGV2OiBudWxsLFxuICB1c2VyRm9yRW1iZWQ6IG51bGwsXG59KTtcblxuY29uc3QgbG9ncyA9IHNlbGYubG9nO1xuXG4vKipcbiAqIEV2ZW50dWFsbHkgaG9sZHMgYSBjb25zdHJ1Y3RvciBmb3IgTG9nIG9iamVjdHMuIExhemlseSBpbml0aWFsaXplZCwgc28gd2VcbiAqIGNhbiBhdm9pZCBldmVyIHJlZmVyZW5jaW5nIHRoZSByZWFsIGNvbnN0cnVjdG9yIGV4Y2VwdCBpbiBKUyBiaW5hcmllc1xuICogdGhhdCBhY3R1YWxseSB3YW50IHRvIGluY2x1ZGUgdGhlIGltcGxlbWVudGF0aW9uLlxuICogQHR5cGUgez9GdW5jdGlvbn1cbiAqL1xubGV0IGxvZ0NvbnN0cnVjdG9yID0gbnVsbDtcblxuLyoqXG4gKiBJbml0aWFsaXplcyBsb2cgY29udHJ1Y3Rvci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluaXRMb2dDb25zdHJ1Y3RvcigpIHtcbiAgbG9nQ29uc3RydWN0b3IgPSBMb2c7XG4gIC8vIEluaXRpYWxpemUgaW5zdGFuY2VzIGZvciB1c2UuIElmIGEgYmluYXJ5IChhbiBleHRlbnNpb24gZm9yIGV4YW1wbGUpIHRoYXRcbiAgLy8gZG9lcyBub3QgY2FsbCBgaW5pdExvZ0NvbnN0cnVjdG9yYCBpbnZva2VzIGBkZXYoKWAgb3IgYHVzZXIoKWAgZWFybGllciB0aGFuXG4gIC8vIHRoZSBiaW5hcnkgdGhhdCBkb2VzIGNhbGwgYGluaXRMb2dDb25zdHJ1Y3RvcmAgKGFtcC5qcyksIHRoZSBleHRlbnNpb24gd2lsbFxuICAvLyB0aHJvdyBhbiBlcnJvciBhcyB0aGF0IGV4dGVuc2lvbiB3aWxsIG5ldmVyIGJlIGFibGUgdG8gaW5pdGlhbGl6ZSB0aGUgbG9nXG4gIC8vIGluc3RhbmNlcyBhbmQgd2UgYWxzbyBkb24ndCB3YW50IGl0IHRvIGNhbGwgYGluaXRMb2dDb25zdHJ1Y3RvcmAgZWl0aGVyXG4gIC8vIChzaW5jZSB0aGF0IHdpbGwgY2F1c2UgdGhlIExvZyBpbXBsZW1lbnRhdGlvbiB0byBiZSBidW5kbGVkIGludG8gdGhhdFxuICAvLyBiaW5hcnkpLiBTbyB3ZSBtdXN0IGluaXRpYWxpemUgdGhlIGluc3RhbmNlcyBlYWdlcmx5IHNvIHRoYXQgdGhleSBhcmUgcmVhZHlcbiAgLy8gZm9yIHVzZSAoc3RvcmVkIGdsb2JhbGx5KSBhZnRlciB0aGUgbWFpbiBiaW5hcnkgY2FsbHMgYGluaXRMb2dDb25zdHJ1Y3RvcmAuXG4gIGRldigpO1xuICB1c2VyKCk7XG59XG5cbi8qKlxuICogUmVzZXRzIGxvZyBjb250cnVjdG9yIGZvciB0ZXN0aW5nLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRMb2dDb25zdHJ1Y3RvckZvclRlc3RpbmcoKSB7XG4gIGxvZ0NvbnN0cnVjdG9yID0gbnVsbDtcbn1cblxuLyoqXG4gKiBQdWJsaXNoZXIgbGV2ZWwgbG9nLlxuICpcbiAqIEVuYWJsZWQgaW4gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICogIDEuIE5vdCBkaXNhYmxlZCB1c2luZyBgI2xvZz0wYC5cbiAqICAyLiBEZXZlbG9wbWVudCBtb2RlIGlzIGVuYWJsZWQgdmlhIGAjZGV2ZWxvcG1lbnQ9MWAgb3IgbG9nZ2luZyBpcyBleHBsaWNpdGx5XG4gKiAgICAgZW5hYmxlZCB2aWEgYCNsb2c9RGAgd2hlcmUgRCA+PSAxLlxuICogIDMuIEFNUC5zZXRMb2dMZXZlbChEKSBpcyBjYWxsZWQsIHdoZXJlIEQgPj0gMS5cbiAqXG4gKiBAcGFyYW0geyFFbGVtZW50PX0gb3B0X2VsZW1lbnRcbiAqIEByZXR1cm4geyFMb2d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VyKG9wdF9lbGVtZW50KSB7XG4gIGlmICghbG9ncy51c2VyKSB7XG4gICAgbG9ncy51c2VyID0gZ2V0VXNlckxvZ2dlcihVU0VSX0VSUk9SX1NFTlRJTkVMKTtcbiAgfVxuICBpZiAoIWlzRnJvbUVtYmVkKGxvZ3MudXNlci53aW4sIG9wdF9lbGVtZW50KSkge1xuICAgIHJldHVybiBsb2dzLnVzZXI7XG4gIH0gZWxzZSB7XG4gICAgaWYgKGxvZ3MudXNlckZvckVtYmVkKSB7XG4gICAgICByZXR1cm4gbG9ncy51c2VyRm9yRW1iZWQ7XG4gICAgfVxuICAgIHJldHVybiBsb2dzLnVzZXJGb3JFbWJlZCA9IGdldFVzZXJMb2dnZXIoVVNFUl9FUlJPUl9FTUJFRF9TRU5USU5FTCk7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXR0ZXIgZm9yIHVzZXIgbG9nZ2VyXG4gKiBAcGFyYW0ge3N0cmluZz19IHN1ZmZpeFxuICogQHJldHVybiB7IUxvZ31cbiAqL1xuZnVuY3Rpb24gZ2V0VXNlckxvZ2dlcihzdWZmaXgpIHtcbiAgaWYgKCFsb2dDb25zdHJ1Y3Rvcikge1xuICAgIHRocm93IG5ldyBFcnJvcignZmFpbGVkIHRvIGNhbGwgaW5pdExvZ0NvbnN0cnVjdG9yJyk7XG4gIH1cbiAgcmV0dXJuIG5ldyBsb2dDb25zdHJ1Y3RvcihzZWxmLCBtb2RlID0+IHtcbiAgICBjb25zdCBsb2dOdW0gPSBwYXJzZUludChtb2RlLmxvZywgMTApO1xuICAgIGlmIChtb2RlLmRldmVsb3BtZW50IHx8IGxvZ051bSA+PSAxKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuRklORTtcbiAgICB9XG4gICAgcmV0dXJuIExvZ0xldmVsLldBUk47XG4gIH0sIHN1ZmZpeCk7XG59XG5cbi8qKlxuICogQU1QIGRldmVsb3BtZW50IGxvZy4gQ2FsbHMgdG8gYGRldkxvZygpLmFzc2VydGAgYW5kIGBkZXYuZmluZWAgYXJlIHN0cmlwcGVkXG4gKiBpbiB0aGUgUFJPRCBiaW5hcnkuIEhvd2V2ZXIsIGBkZXZMb2coKS5hc3NlcnRgIHJlc3VsdCBpcyBwcmVzZXJ2ZWQgaW4gZWl0aGVyXG4gKiBjYXNlLlxuICpcbiAqIEVuYWJsZWQgaW4gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICogIDEuIE5vdCBkaXNhYmxlZCB1c2luZyBgI2xvZz0wYC5cbiAqICAyLiBMb2dnaW5nIGlzIGV4cGxpY2l0bHkgZW5hYmxlZCB2aWEgYCNsb2c9RGAsIHdoZXJlIEQgPj0gMi5cbiAqICAzLiBBTVAuc2V0TG9nTGV2ZWwoRCkgaXMgY2FsbGVkLCB3aGVyZSBEID49IDIuXG4gKlxuICogQHJldHVybiB7IUxvZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRldigpIHtcbiAgaWYgKGxvZ3MuZGV2KSB7XG4gICAgcmV0dXJuIGxvZ3MuZGV2O1xuICB9XG4gIGlmICghbG9nQ29uc3RydWN0b3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2ZhaWxlZCB0byBjYWxsIGluaXRMb2dDb25zdHJ1Y3RvcicpO1xuICB9XG4gIHJldHVybiBsb2dzLmRldiA9IG5ldyBsb2dDb25zdHJ1Y3RvcihzZWxmLCBtb2RlID0+IHtcbiAgICBjb25zdCBsb2dOdW0gPSBwYXJzZUludChtb2RlLmxvZywgMTApO1xuICAgIGlmIChsb2dOdW0gPj0gMykge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLkZJTkU7XG4gICAgfVxuICAgIGlmIChsb2dOdW0gPj0gMikge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLklORk87XG4gICAgfVxuICAgIHJldHVybiBMb2dMZXZlbC5PRkY7XG4gIH0pO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFFbGVtZW50PX0gb3B0X2VsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59IGlzRW1iZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRnJvbUVtYmVkKHdpbiwgb3B0X2VsZW1lbnQpIHtcbiAgaWYgKCFvcHRfZWxlbWVudCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gb3B0X2VsZW1lbnQub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldyAhPSB3aW47XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuL21vZGUnO1xuXG4vKipcbiAqIFByb3ZpZGVzIGluZm8gYWJvdXQgdGhlIGN1cnJlbnQgYXBwLiBUaGlzIHJldHVybiB2YWx1ZSBtYXkgYmUgY2FjaGVkIGFuZFxuICogcGFzc2VkIGFyb3VuZCBhcyBpdCB3aWxsIGFsd2F5cyBiZSBEQ0UnZC5cbiAqIEBwYXJhbSB7P1dpbmRvdz19IG9wdF93aW5cbiAqIEByZXR1cm4geyEuL21vZGUuTW9kZURlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE1vZGVPYmplY3Qob3B0X3dpbikge1xuICByZXR1cm4ge1xuICAgIGxvY2FsRGV2OiBnZXRNb2RlKG9wdF93aW4pLmxvY2FsRGV2LFxuICAgIGRldmVsb3BtZW50OiBnZXRNb2RlKG9wdF93aW4pLmRldmVsb3BtZW50LFxuICAgIGZpbHRlcjogZ2V0TW9kZShvcHRfd2luKS5maWx0ZXIsXG4gICAgbWluaWZpZWQ6IGdldE1vZGUob3B0X3dpbikubWluaWZpZWQsXG4gICAgbGl0ZTogZ2V0TW9kZShvcHRfd2luKS5saXRlLFxuICAgIHRlc3Q6IGdldE1vZGUob3B0X3dpbikudGVzdCxcbiAgICBsb2c6IGdldE1vZGUob3B0X3dpbikubG9nLFxuICAgIHZlcnNpb246IGdldE1vZGUob3B0X3dpbikudmVyc2lvbixcbiAgICBydHZWZXJzaW9uOiBnZXRNb2RlKG9wdF93aW4pLnJ0dlZlcnNpb24sXG4gIH07XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtwYXJzZVF1ZXJ5U3RyaW5nX30gZnJvbSAnLi91cmwtcGFyc2UtcXVlcnktc3RyaW5nJztcblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBsb2NhbERldjogYm9vbGVhbixcbiAqICAgZGV2ZWxvcG1lbnQ6IGJvb2xlYW4sXG4gKiAgIGZpbHRlcjogKHN0cmluZ3x1bmRlZmluZWQpLFxuICogICBtaW5pZmllZDogYm9vbGVhbixcbiAqICAgbGl0ZTogYm9vbGVhbixcbiAqICAgdGVzdDogYm9vbGVhbixcbiAqICAgbG9nOiAoc3RyaW5nfHVuZGVmaW5lZCksXG4gKiAgIHZlcnNpb246IHN0cmluZyxcbiAqICAgcnR2VmVyc2lvbjogc3RyaW5nLFxuICogfX1cbiAqL1xuZXhwb3J0IGxldCBNb2RlRGVmO1xuXG4vKiogQHR5cGUge3N0cmluZ30gKi9cbmNvbnN0IHZlcnNpb24gPSAnJGludGVybmFsUnVudGltZVZlcnNpb24kJztcblxuLyoqXG4gKiBgcnR2VmVyc2lvbmAgaXMgdGhlIHByZWZpeGVkIHZlcnNpb24gd2Ugc2VydmUgb2ZmIG9mIHRoZSBjZG4uXG4gKiBUaGUgcHJlZml4IGRlbm90ZXMgY2FuYXJ5KDAwKSBvciBwcm9kKDAxKSBvciBhbiBleHBlcmltZW50IHZlcnNpb24gKCA+IDAxKS5cbiAqIEB0eXBlIHtzdHJpbmd9XG4gKi9cbmxldCBydHZWZXJzaW9uID0gJyc7XG5cbi8qKlxuICogUHJvdmlkZXMgaW5mbyBhYm91dCB0aGUgY3VycmVudCBhcHAuXG4gKiBAcGFyYW0gez9XaW5kb3c9fSBvcHRfd2luXG4gKiBAcmV0dXJuIHshTW9kZURlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE1vZGUob3B0X3dpbikge1xuICBjb25zdCB3aW4gPSBvcHRfd2luIHx8IHNlbGY7XG4gIGlmICh3aW4uQU1QX01PREUpIHtcbiAgICByZXR1cm4gd2luLkFNUF9NT0RFO1xuICB9XG4gIHJldHVybiB3aW4uQU1QX01PREUgPSBnZXRNb2RlXyh3aW4pO1xufVxuXG4vKipcbiAqIFByb3ZpZGVzIGluZm8gYWJvdXQgdGhlIGN1cnJlbnQgYXBwLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFNb2RlRGVmfVxuICovXG5mdW5jdGlvbiBnZXRNb2RlXyh3aW4pIHtcbiAgLy8gTWFnaWMgY29uc3RhbnRzIHRoYXQgYXJlIHJlcGxhY2VkIGJ5IGNsb3N1cmUgY29tcGlsZXIuXG4gIC8vIElTX01JTklGSUVEIGlzIGFsd2F5cyByZXBsYWNlZCB3aXRoIHRydWUgd2hlbiBjbG9zdXJlIGNvbXBpbGVyIGlzIHVzZWRcbiAgLy8gd2hpbGUgSVNfREVWIGlzIG9ubHkgcmVwbGFjZWQgd2hlbiBgZ3VscCBkaXN0YCBpcyBjYWxsZWQgd2l0aG91dCB0aGVcbiAgLy8gLS1mb3J0ZXN0aW5nIGZsYWcuXG4gIGNvbnN0IElTX0RFViA9IHRydWU7XG4gIGNvbnN0IElTX01JTklGSUVEID0gZmFsc2U7XG5cbiAgY29uc3QgbG9jYWxEZXZFbmFibGVkID0gISEoc2VsZi5BTVBfQ09ORklHICYmIHNlbGYuQU1QX0NPTkZJRy5sb2NhbERldik7XG4gIGNvbnN0IHJ1bm5pbmdUZXN0cyA9IElTX0RFViAmJiAhISh3aW4uQU1QX1RFU1QgfHwgd2luLl9fa2FybWFfXyk7XG4gIGNvbnN0IGlzTG9jYWxEZXYgPSBJU19ERVYgJiYgKGxvY2FsRGV2RW5hYmxlZCB8fCBydW5uaW5nVGVzdHMpO1xuICBjb25zdCBoYXNoUXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nXyhcbiAgICAgIC8vIGxvY2F0aW9uLm9yaWdpbmFsSGFzaCBpcyBzZXQgYnkgdGhlIHZpZXdlciB3aGVuIGl0IHJlbW92ZXMgdGhlIGZyYWdtZW50XG4gICAgICAvLyBmcm9tIHRoZSBVUkwuXG4gICAgICB3aW4ubG9jYXRpb24ub3JpZ2luYWxIYXNoIHx8IHdpbi5sb2NhdGlvbi5oYXNoKTtcblxuICBjb25zdCBzZWFyY2hRdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmdfKHdpbi5sb2NhdGlvbi5zZWFyY2gpO1xuXG4gIGlmICghcnR2VmVyc2lvbikge1xuICAgIHJ0dlZlcnNpb24gPSBnZXRSdHZWZXJzaW9uKHdpbiwgaXNMb2NhbERldik7XG4gIH1cblxuICAvLyBUaGUgYG1pbmlmaWVkYCwgYHRlc3RgIGFuZCBgbG9jYWxEZXZgIHByb3BlcnRpZXMgYXJlIHJlcGxhY2VkXG4gIC8vIGFzIGJvb2xlYW4gbGl0ZXJhbHMgd2hlbiB3ZSBydW4gYGd1bHAgZGlzdGAgd2l0aG91dCB0aGUgYC0tZm9ydGVzdGluZ2BcbiAgLy8gZmxhZ3MuIFRoaXMgaW1wcm92ZWQgRENFIG9uIHRoZSBwcm9kdWN0aW9uIGZpbGUgd2UgZGVwbG95IGFzIHRoZSBjb2RlXG4gIC8vIHBhdGhzIGZvciBsb2NhbGhvc3QvdGVzdGluZy9kZXZlbG9wbWVudCBhcmUgZWxpbWluYXRlZC5cbiAgcmV0dXJuIHtcbiAgICBsb2NhbERldjogaXNMb2NhbERldixcbiAgICAvLyBUcmlnZ2VycyB2YWxpZGF0aW9uIG9yIGVuYWJsZSBwdWIgbGV2ZWwgbG9nZ2luZy4gVmFsaWRhdGlvbiBjYW4gYmVcbiAgICAvLyBieXBhc3NlZCB2aWEgI3ZhbGlkYXRlPTAuXG4gICAgLy8gTm90ZSB0aGF0IEFNUF9ERVZfTU9ERSBmbGFnIGlzIHVzZWQgZm9yIHRlc3RpbmcgcHVycG9zZXMuXG4gICAgZGV2ZWxvcG1lbnQ6ICEhKGhhc2hRdWVyeVsnZGV2ZWxvcG1lbnQnXSA9PSAnMScgfHwgd2luLkFNUF9ERVZfTU9ERSksXG4gICAgZXhhbWluZXI6IGhhc2hRdWVyeVsnZGV2ZWxvcG1lbnQnXSA9PSAnMicsXG4gICAgLy8gQWxsb3dzIGZpbHRlcmluZyB2YWxpZGF0aW9uIGVycm9ycyBieSBlcnJvciBjYXRlZ29yeS4gRm9yIHRoZVxuICAgIC8vIGF2YWlsYWJsZSBjYXRlZ29yaWVzLCBzZWUgRXJyb3JDYXRlZ29yeSBpbiB2YWxpZGF0b3IvdmFsaWRhdG9yLnByb3RvLlxuICAgIGZpbHRlcjogaGFzaFF1ZXJ5WydmaWx0ZXInXSxcbiAgICAvLyBhbXAtZ2VvIG92ZXJyaWRlXG4gICAgZ2VvT3ZlcnJpZGU6IGhhc2hRdWVyeVsnYW1wLWdlbyddLFxuICAgIG1pbmlmaWVkOiBJU19NSU5JRklFRCxcbiAgICAvLyBXaGV0aGVyIGRvY3VtZW50IGlzIGluIGFuIGFtcC1saXRlIHZpZXdlci4gSXQgc2lnbmFsIHRoYXQgdGhlIHVzZXJcbiAgICAvLyB3b3VsZCBwcmVmZXIgdG8gdXNlIGxlc3MgYmFuZHdpZHRoLlxuICAgIGxpdGU6IHNlYXJjaFF1ZXJ5WydhbXBfbGl0ZSddICE9IHVuZGVmaW5lZCxcbiAgICB0ZXN0OiBydW5uaW5nVGVzdHMsXG4gICAgbG9nOiBoYXNoUXVlcnlbJ2xvZyddLFxuICAgIHZlcnNpb24sXG4gICAgcnR2VmVyc2lvbixcbiAgfTtcbn1cblxuLyoqXG4gKiBSZXRyaWV2ZSB0aGUgYHJ0dlZlcnNpb25gIHdoaWNoIHdpbGwgaGF2ZSBhIG51bWVyaWMgcHJlZml4XG4gKiBkZW5vdGluZyBjYW5hcnkvcHJvZC9leHBlcmltZW50ICh1bmxlc3MgYGlzTG9jYWxEZXZgIGlzIHRydWUpLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGlzTG9jYWxEZXZcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gZ2V0UnR2VmVyc2lvbih3aW4sIGlzTG9jYWxEZXYpIHtcbiAgLy8gSWYgaXQncyBsb2NhbCBkZXYgdGhlbiB3ZSB3b24ndCBhY3R1YWxseSBoYXZlIGEgZnVsbCB2ZXJzaW9uIHNvXG4gIC8vIGp1c3QgdXNlIHRoZSB2ZXJzaW9uLlxuICBpZiAoaXNMb2NhbERldikge1xuICAgIHJldHVybiB2ZXJzaW9uO1xuICB9XG5cbiAgaWYgKHdpbi5BTVBfQ09ORklHICYmIHdpbi5BTVBfQ09ORklHLnYpIHtcbiAgICByZXR1cm4gd2luLkFNUF9DT05GSUcudjtcbiAgfVxuXG4gIC8vIEN1cnJlbnRseSBgJGludGVybmFsUnVudGltZVZlcnNpb24kYCBhbmQgdGh1cyBgbW9kZS52ZXJzaW9uYCBjb250YWluIG9ubHlcbiAgLy8gbWFqb3IgdmVyc2lvbi4gVGhlIGZ1bGwgdmVyc2lvbiBob3dldmVyIG11c3QgYWxzbyBjYXJyeSB0aGUgbWlub3IgdmVyc2lvbi5cbiAgLy8gV2Ugd2lsbCBkZWZhdWx0IHRvIHByb2R1Y3Rpb24gZGVmYXVsdCBgMDFgIG1pbm9yIHZlcnNpb24gZm9yIG5vdy5cbiAgLy8gVE9ETyhlcndpbm1vbWJheSk6IGRlY2lkZSB3aGV0aGVyICRpbnRlcm5hbFJ1bnRpbWVWZXJzaW9uJCBzaG91bGQgY29udGFpblxuICAvLyBtaW5vciB2ZXJzaW9uLlxuICByZXR1cm4gYDAxJHt2ZXJzaW9ufWA7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtib29sZWFufSBpc0xvY2FsRGV2XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJ0dlZlcnNpb25Gb3JUZXN0aW5nKHdpbiwgaXNMb2NhbERldikge1xuICByZXR1cm4gZ2V0UnR2VmVyc2lvbih3aW4sIGlzTG9jYWxEZXYpO1xufVxuXG5cbi8qKiBAdmlzaWJsZUZvclRlc3RpbmcgKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldFJ0dlZlcnNpb25Gb3JUZXN0aW5nKCkge1xuICBydHZWZXJzaW9uID0gJyc7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7bWFwfSBmcm9tICcuL3V0aWxzL29iamVjdC5qcyc7XG5cbmxldCBjb250YWluZXI7XG5cbi8qKlxuICogQ3JlYXRlcyB0aGUgaHRtbCBoZWxwZXIgZm9yIHRoZSBkb2MuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudHwhRG9jdW1lbnR9IG5vZGVPckRvY1xuICogQHJldHVybiB7ZnVuY3Rpb24oIUFycmF5PHN0cmluZz4pOiFFbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gaHRtbEZvcihub2RlT3JEb2MpIHtcbiAgY29uc3QgZG9jID0gbm9kZU9yRG9jLm93bmVyRG9jdW1lbnQgfHwgbm9kZU9yRG9jO1xuICBpZiAoIWNvbnRhaW5lciB8fCBjb250YWluZXIub3duZXJEb2N1bWVudCAhPT0gZG9jKSB7XG4gICAgY29udGFpbmVyID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB9XG5cbiAgcmV0dXJuIGh0bWw7XG59XG5cbi8qKlxuICogQSB0YWdnZWQgdGVtcGxhdGUgbGl0ZXJhbCBoZWxwZXIgdG8gZ2VuZXJhdGUgc3RhdGljIERPTSB0cmVlcy5cbiAqIFRoaXMgbXVzdCBiZSB1c2VkIGFzIGEgdGFnZ2VkIHRlbXBsYXRlLCBpZVxuICpcbiAqIGBgYFxuICogY29uc3QgZGl2ID0gaHRtbGA8ZGl2PjxzcGFuPjwvc3Bhbj48L2Rpdj5gO1xuICogYGBgXG4gKlxuICogT25seSB0aGUgcm9vdCBlbGVtZW50IGFuZCBpdHMgc3VidHJlZSB3aWxsIGJlIHJldHVybmVkLiBETyBOT1QgdXNlIHRoaXMgdG9cbiAqIHJlbmRlciBzdWJ0cmVlJ3Mgd2l0aCBkeW5hbWljIGNvbnRlbnQsIGl0IFdJTEwgcmVzdWx0IGluIGFuIGVycm9yIVxuICpcbiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHN0cmluZ3NcbiAqIEByZXR1cm4geyFFbGVtZW50fVxuICovXG5mdW5jdGlvbiBodG1sKHN0cmluZ3MpIHtcbiAgZGV2KCkuYXNzZXJ0KHN0cmluZ3MubGVuZ3RoID09PSAxLCAnSW1wcm9wZXIgaHRtbCB0ZW1wbGF0ZSB0YWcgdXNhZ2UuJyk7XG4gIGNvbnRhaW5lci4vKk9LKi9pbm5lckhUTUwgPSBzdHJpbmdzWzBdO1xuXG4gIGNvbnN0IGVsID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkO1xuICBkZXYoKS5hc3NlcnQoZWwsICdObyBlbGVtZW50cyBpbiB0ZW1wbGF0ZScpO1xuICBkZXYoKS5hc3NlcnQoIWVsLm5leHRFbGVtZW50U2libGluZywgJ1RvbyBtYW55IHJvb3QgZWxlbWVudHMgaW4gdGVtcGxhdGUnKTtcblxuICAvLyBDbGVhciB0byBmcmVlIG1lbW9yeS5cbiAgY29udGFpbmVyLi8qT0sqL2lubmVySFRNTCA9ICcnO1xuXG4gIHJldHVybiBlbDtcbn1cblxuLyoqXG4gKiBRdWVyaWVzIGFuIGVsZW1lbnQgZm9yIGFsbCBlbGVtZW50cyB3aXRoIGEgXCJyZWZcIiBhdHRyaWJ1dGUsIHJlbW92aW5nXG4gKiB0aGUgYXR0cmlidXRlIGFmdGVyd2FyZHMuXG4gKiBSZXR1cm5zIGEgbmFtZWQgbWFwIG9mIGFsbCByZWYgZWxlbWVudHMuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudH0gcm9vdFxuICogQHJldHVybiB7IU9iamVjdDxzdHJpbmcsICFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGh0bWxSZWZzKHJvb3QpIHtcbiAgY29uc3QgZWxlbWVudHMgPSByb290LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tyZWZdJyk7XG4gIGNvbnN0IHJlZnMgPSBtYXAoKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgZWxlbWVudCA9IGVsZW1lbnRzW2ldO1xuICAgIGNvbnN0IHJlZiA9IGRldigpLmFzc2VydChlbGVtZW50LmdldEF0dHJpYnV0ZSgncmVmJyksICdFbXB0eSByZWYgYXR0cicpO1xuICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdyZWYnKTtcbiAgICBkZXYoKS5hc3NlcnQocmVmc1tyZWZdID09PSB1bmRlZmluZWQsICdEdXBsaWNhdGUgcmVmJyk7XG4gICAgcmVmc1tyZWZdID0gZWxlbWVudDtcbiAgfVxuXG4gIHJldHVybiByZWZzO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IF9tYXRjaFxuICogQHBhcmFtIHtzdHJpbmd9IGNoYXJhY3RlclxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0b1VwcGVyQ2FzZShfbWF0Y2gsIGNoYXJhY3Rlcikge1xuICByZXR1cm4gY2hhcmFjdGVyLnRvVXBwZXJDYXNlKCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG1hdGNoXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHByZXBlbmREYXNoQW5kVG9Mb3dlckNhc2UobWF0Y2gpIHtcbiAgcmV0dXJuICctJyArIG1hdGNoLnRvTG93ZXJDYXNlKCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgQXR0cmlidXRlIG5hbWUgY29udGFpbmluZyBkYXNoZXMuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IERhc2hlcyByZW1vdmVkIGFuZCBzdWNjZXNzaXZlIGNoYXJhY3RlciBzZW50IHRvIHVwcGVyIGNhc2UuXG4gKiB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZGFzaFRvQ2FtZWxDYXNlKG5hbWUpIHtcbiAgcmV0dXJuIG5hbWUucmVwbGFjZSgvLShbYS16XSkvZywgdG9VcHBlckNhc2UpO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgc3RyaW5nIHRoYXQgaXMgaW4gY2FtZWxDYXNlIHRvIG9uZSB0aGF0IGlzIGluIGRhc2gtY2FzZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nIFRoZSBzdHJpbmcgdG8gY29udmVydC5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHN0cmluZyBpbiBkYXNoLWNhc2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW1lbENhc2VUb0Rhc2goc3RyaW5nKSB7XG4gIHJldHVybiBzdHJpbmcucmVwbGFjZSgvKD8hXilbQS1aXS9nLCBwcmVwZW5kRGFzaEFuZFRvTG93ZXJDYXNlKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBBdHRyaWJ1dGUgbmFtZSB3aXRoIGRhc2hlc1xuICogQHJldHVybiB7c3RyaW5nfSBEYXNoZXMgcmVwbGFjZWQgYnkgdW5kZXJsaW5lcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRhc2hUb1VuZGVybGluZShuYW1lKSB7XG4gIHJldHVybiBuYW1lLnJlcGxhY2UoJy0nLCAnXycpO1xufVxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBTdHJpbmcucHJvdG90eXBlLmVuZHNXaXRoLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZ1xuICogQHBhcmFtIHtzdHJpbmd9IHN1ZmZpeFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVuZHNXaXRoKHN0cmluZywgc3VmZml4KSB7XG4gIGNvbnN0IGluZGV4ID0gc3RyaW5nLmxlbmd0aCAtIHN1ZmZpeC5sZW5ndGg7XG4gIHJldHVybiBpbmRleCA+PSAwICYmIHN0cmluZy5pbmRleE9mKHN1ZmZpeCwgaW5kZXgpID09IGluZGV4O1xufVxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGguXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJlZml4XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RhcnRzV2l0aChzdHJpbmcsIHByZWZpeCkge1xuICBpZiAocHJlZml4Lmxlbmd0aCA+IHN0cmluZy5sZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHN0cmluZy5sYXN0SW5kZXhPZihwcmVmaXgsIDApID09IDA7XG59XG5cbi8qKlxuICogRXhwYW5kcyBwbGFjZWhvbGRlcnMgaW4gYSBnaXZlbiB0ZW1wbGF0ZSBzdHJpbmcgd2l0aCB2YWx1ZXMuXG4gKlxuICogUGxhY2Vob2xkZXJzIHVzZSAke2tleS1uYW1lfSBzeW50YXggYW5kIGFyZSByZXBsYWNlZCB3aXRoIHRoZSB2YWx1ZVxuICogcmV0dXJuZWQgZnJvbSB0aGUgZ2l2ZW4gZ2V0dGVyIGZ1bmN0aW9uLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZW1wbGF0ZSBUaGUgdGVtcGxhdGUgc3RyaW5nIHRvIGV4cGFuZC5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nKToqfSBnZXR0ZXIgRnVuY3Rpb24gdXNlZCB0byByZXRyaWV2ZSBhIHZhbHVlIGZvciBhXG4gKiAgIHBsYWNlaG9sZGVyLiBSZXR1cm5zIHZhbHVlcyB3aWxsIGJlIGNvZXJjZWQgaW50byBzdHJpbmdzLlxuICogQHBhcmFtIHtudW1iZXI9fSBvcHRfbWF4SXRlcmF0aW9ucyBOdW1iZXIgb2YgdGltZXMgdG8gZXhwYW5kIHRoZSB0ZW1wbGF0ZS5cbiAqICAgRGVmYXVsdHMgdG8gMSwgYnV0IHNob3VsZCBiZSBzZXQgdG8gYSBsYXJnZXIgdmFsdWUgeW91ciBwbGFjZWhvbGRlciB0b2tlbnNcbiAqICAgY2FuIGJlIGV4cGFuZGVkIHRvIG90aGVyIHBsYWNlaG9sZGVyIHRva2Vucy4gVGFrZSBjYXV0aW9uIHdpdGggbGFyZ2UgdmFsdWVzXG4gKiAgIGFzIHJlY3Vyc2l2ZWx5IGV4cGFuZGluZyBhIHN0cmluZyBjYW4gYmUgZXhwb25lbnRpYWxseSBleHBlbnNpdmUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHBhbmRUZW1wbGF0ZSh0ZW1wbGF0ZSwgZ2V0dGVyLCBvcHRfbWF4SXRlcmF0aW9ucykge1xuICBjb25zdCBtYXhJdGVyYXRpb25zID0gb3B0X21heEl0ZXJhdGlvbnMgfHwgMTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhJdGVyYXRpb25zOyBpKyspIHtcbiAgICBsZXQgbWF0Y2hlcyA9IDA7XG4gICAgdGVtcGxhdGUgPSB0ZW1wbGF0ZS5yZXBsYWNlKC9cXCR7KFtefV0qKX0vZywgKF9hLCBiKSA9PiB7XG4gICAgICBtYXRjaGVzKys7XG4gICAgICByZXR1cm4gZ2V0dGVyKGIpO1xuICAgIH0pO1xuICAgIGlmICghbWF0Y2hlcykge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIHJldHVybiB0ZW1wbGF0ZTtcbn1cblxuLyoqXG4gKiBIYXNoIGZ1bmN0aW9uIGRqYjJhXG4gKiBUaGlzIGlzIGludGVuZGVkIHRvIGJlIGEgc2ltcGxlLCBmYXN0IGhhc2hpbmcgZnVuY3Rpb24gdXNpbmcgbWluaW1hbCBjb2RlLlxuICogSXQgZG9lcyAqbm90KiBoYXZlIGdvb2QgY3J5cHRvZ3JhcGhpYyBwcm9wZXJ0aWVzLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxuICogQHJldHVybiB7c3RyaW5nfSAzMi1iaXQgdW5zaWduZWQgaGFzaCBvZiB0aGUgc3RyaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdHJpbmdIYXNoMzIoc3RyKSB7XG4gIGNvbnN0IHtsZW5ndGh9ID0gc3RyO1xuICBsZXQgaGFzaCA9IDUzODE7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICBoYXNoID0gaGFzaCAqIDMzIF4gc3RyLmNoYXJDb2RlQXQoaSk7XG4gIH1cbiAgLy8gQ29udmVydCBmcm9tIDMyLWJpdCBzaWduZWQgdG8gdW5zaWduZWQuXG4gIHJldHVybiBTdHJpbmcoaGFzaCA+Pj4gMCk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLy8gTm90ZTogbG9hZGVkIGJ5IDNwIHN5c3RlbS4gQ2Fubm90IHJlbHkgb24gYmFiZWwgcG9seWZpbGxzLlxuaW1wb3J0IHttYXB9IGZyb20gJy4vdXRpbHMvb2JqZWN0LmpzJztcbmltcG9ydCB7c3RhcnRzV2l0aH0gZnJvbSAnLi9zdHJpbmcnO1xuXG5cbi8qKiBAdHlwZSB7T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gKi9cbmxldCBwcm9wZXJ0eU5hbWVDYWNoZTtcblxuLyoqIEBjb25zdCB7IUFycmF5PHN0cmluZz59ICovXG5jb25zdCB2ZW5kb3JQcmVmaXhlcyA9IFsnV2Via2l0JywgJ3dlYmtpdCcsICdNb3onLCAnbW96JywgJ21zJywgJ08nLCAnbyddO1xuXG5cbi8qKlxuICogQGV4cG9ydFxuICogQHBhcmFtIHtzdHJpbmd9IGNhbWVsQ2FzZSBjYW1lbCBjYXNlZCBzdHJpbmdcbiAqIEByZXR1cm4ge3N0cmluZ30gdGl0bGUgY2FzZWQgc3RyaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW1lbENhc2VUb1RpdGxlQ2FzZShjYW1lbENhc2UpIHtcbiAgcmV0dXJuIGNhbWVsQ2FzZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGNhbWVsQ2FzZS5zbGljZSgxKTtcbn1cblxuLyoqXG4gKiBDaGVja3MgdGhlIHN0eWxlIGlmIGEgcHJlZml4ZWQgdmVyc2lvbiBvZiBhIHByb3BlcnR5IGV4aXN0cyBhbmQgcmV0dXJuc1xuICogaXQgb3IgcmV0dXJucyBhbiBlbXB0eSBzdHJpbmcuXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHshT2JqZWN0fSBzdHlsZVxuICogQHBhcmFtIHtzdHJpbmd9IHRpdGxlQ2FzZSB0aGUgdGl0bGUgY2FzZSB2ZXJzaW9uIG9mIGEgY3NzIHByb3BlcnR5IG5hbWVcbiAqIEByZXR1cm4ge3N0cmluZ30gdGhlIHByZWZpeGVkIHByb3BlcnR5IG5hbWUgb3IgbnVsbC5cbiAqL1xuZnVuY3Rpb24gZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWVfKHN0eWxlLCB0aXRsZUNhc2UpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB2ZW5kb3JQcmVmaXhlcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHByb3BlcnR5TmFtZSA9IHZlbmRvclByZWZpeGVzW2ldICsgdGl0bGVDYXNlO1xuICAgIGlmIChzdHlsZVtwcm9wZXJ0eU5hbWVdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBwcm9wZXJ0eU5hbWU7XG4gICAgfVxuICB9XG4gIHJldHVybiAnJztcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwb3NzaWJseSBwcmVmaXhlZCBKYXZhU2NyaXB0IHByb3BlcnR5IG5hbWUgb2YgYSBzdHlsZSBwcm9wZXJ0eVxuICogKGV4LiBXZWJraXRUcmFuc2l0aW9uRHVyYXRpb24pIGdpdmVuIGEgY2FtZWxDYXNlJ2QgdmVyc2lvbiBvZiB0aGUgcHJvcGVydHlcbiAqIChleC4gdHJhbnNpdGlvbkR1cmF0aW9uKS5cbiAqIEBleHBvcnRcbiAqIEBwYXJhbSB7IU9iamVjdH0gc3R5bGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBjYW1lbENhc2UgdGhlIGNhbWVsIGNhc2VkIHZlcnNpb24gb2YgYSBjc3MgcHJvcGVydHkgbmFtZVxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2J5cGFzc0NhY2hlIGJ5cGFzcyB0aGUgbWVtb2l6ZWQgY2FjaGUgb2YgcHJvcGVydHlcbiAqICAgbWFwcGluZ1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWUoc3R5bGUsIGNhbWVsQ2FzZSwgb3B0X2J5cGFzc0NhY2hlKSB7XG4gIGlmIChzdGFydHNXaXRoKGNhbWVsQ2FzZSwgJy0tJykpIHtcbiAgICAvLyBDU1MgdmFycyBhcmUgcmV0dXJuZWQgYXMgaXMuXG4gICAgcmV0dXJuIGNhbWVsQ2FzZTtcbiAgfVxuICBpZiAoIXByb3BlcnR5TmFtZUNhY2hlKSB7XG4gICAgcHJvcGVydHlOYW1lQ2FjaGUgPSBtYXAoKTtcbiAgfVxuICBsZXQgcHJvcGVydHlOYW1lID0gcHJvcGVydHlOYW1lQ2FjaGVbY2FtZWxDYXNlXTtcbiAgaWYgKCFwcm9wZXJ0eU5hbWUgfHwgb3B0X2J5cGFzc0NhY2hlKSB7XG4gICAgcHJvcGVydHlOYW1lID0gY2FtZWxDYXNlO1xuICAgIGlmIChzdHlsZVtjYW1lbENhc2VdID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnN0IHRpdGxlQ2FzZSA9IGNhbWVsQ2FzZVRvVGl0bGVDYXNlKGNhbWVsQ2FzZSk7XG4gICAgICBjb25zdCBwcmVmaXhlZFByb3BlcnR5TmFtZSA9IGdldFZlbmRvckpzUHJvcGVydHlOYW1lXyhzdHlsZSwgdGl0bGVDYXNlKTtcblxuICAgICAgaWYgKHN0eWxlW3ByZWZpeGVkUHJvcGVydHlOYW1lXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHByb3BlcnR5TmFtZSA9IHByZWZpeGVkUHJvcGVydHlOYW1lO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIW9wdF9ieXBhc3NDYWNoZSkge1xuICAgICAgcHJvcGVydHlOYW1lQ2FjaGVbY2FtZWxDYXNlXSA9IHByb3BlcnR5TmFtZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHByb3BlcnR5TmFtZTtcbn1cblxuXG4vKipcbiAqIFNldHMgdGhlIENTUyBzdHlsZXMgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IHdpdGggIWltcG9ydGFudC4gVGhlIHN0eWxlc1xuICogYXJlIHNwZWNpZmllZCBhcyBhIG1hcCBmcm9tIENTUyBwcm9wZXJ0eSBuYW1lcyB0byB0aGVpciB2YWx1ZXMuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPn0gc3R5bGVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRJbXBvcnRhbnRTdHlsZXMoZWxlbWVudCwgc3R5bGVzKSB7XG4gIGZvciAoY29uc3QgayBpbiBzdHlsZXMpIHtcbiAgICBlbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KFxuICAgICAgICBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZShzdHlsZXMsIGspLCBzdHlsZXNba10udG9TdHJpbmcoKSwgJ2ltcG9ydGFudCcpO1xuICB9XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBDU1Mgc3R5bGUgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IHdpdGggb3B0aW9uYWwgdW5pdHMsIGUuZy4gXCJweFwiLlxuICogQHBhcmFtIHs/RWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5XG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF91bml0c1xuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2J5cGFzc0NhY2hlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRTdHlsZShlbGVtZW50LCBwcm9wZXJ0eSwgdmFsdWUsIG9wdF91bml0cywgb3B0X2J5cGFzc0NhY2hlKSB7XG4gIGNvbnN0IHByb3BlcnR5TmFtZSA9IGdldFZlbmRvckpzUHJvcGVydHlOYW1lKGVsZW1lbnQuc3R5bGUsIHByb3BlcnR5LFxuICAgICAgb3B0X2J5cGFzc0NhY2hlKTtcbiAgaWYgKHByb3BlcnR5TmFtZSkge1xuICAgIGVsZW1lbnQuc3R5bGVbcHJvcGVydHlOYW1lXSA9XG4gICAgICAvKiogQHR5cGUge3N0cmluZ30gKi8gKG9wdF91bml0cyA/IHZhbHVlICsgb3B0X3VuaXRzIDogdmFsdWUpO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgQ1NTIHN0eWxlIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wZXJ0eVxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2J5cGFzc0NhY2hlXG4gKiBAcmV0dXJuIHsqfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3R5bGUoZWxlbWVudCwgcHJvcGVydHksIG9wdF9ieXBhc3NDYWNoZSkge1xuICBjb25zdCBwcm9wZXJ0eU5hbWUgPSBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZShlbGVtZW50LnN0eWxlLCBwcm9wZXJ0eSxcbiAgICAgIG9wdF9ieXBhc3NDYWNoZSk7XG4gIGlmICghcHJvcGVydHlOYW1lKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICByZXR1cm4gZWxlbWVudC5zdHlsZVtwcm9wZXJ0eU5hbWVdO1xufVxuXG5cbi8qKlxuICogU2V0cyB0aGUgQ1NTIHN0eWxlcyBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQuIFRoZSBzdHlsZXNcbiAqIGEgc3BlY2lmaWVkIGFzIGEgbWFwIGZyb20gQ1NTIHByb3BlcnR5IG5hbWVzIHRvIHRoZWlyIHZhbHVlcy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICo+fSBzdHlsZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFN0eWxlcyhlbGVtZW50LCBzdHlsZXMpIHtcbiAgZm9yIChjb25zdCBrIGluIHN0eWxlcykge1xuICAgIHNldFN0eWxlKGVsZW1lbnQsIGssIHN0eWxlc1trXSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFNob3dzIG9yIGhpZGVzIHRoZSBzcGVjaWZpZWQgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9kaXNwbGF5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGUoZWxlbWVudCwgb3B0X2Rpc3BsYXkpIHtcbiAgaWYgKG9wdF9kaXNwbGF5ID09PSB1bmRlZmluZWQpIHtcbiAgICBvcHRfZGlzcGxheSA9IGdldFN0eWxlKGVsZW1lbnQsICdkaXNwbGF5JykgPT0gJ25vbmUnO1xuICB9XG4gIHNldFN0eWxlKGVsZW1lbnQsICdkaXNwbGF5Jywgb3B0X2Rpc3BsYXkgPyAnJyA6ICdub25lJyk7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcGl4ZWwgdmFsdWUuXG4gKiBAcGFyYW0ge251bWJlcn0gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHB4KHZhbHVlKSB7XG4gIHJldHVybiBgJHt2YWx1ZX1weGA7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGRlZ3JlZSB2YWx1ZS5cbiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVnKHZhbHVlKSB7XG4gIHJldHVybiBgJHt2YWx1ZX1kZWdgO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBcInRyYW5zbGF0ZVhcIiBmb3IgQ1NTIFwidHJhbnNmb3JtXCIgcHJvcGVydHkuXG4gKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2xhdGVYKHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gYHRyYW5zbGF0ZVgoJHt2YWx1ZX0pYDtcbiAgfVxuICByZXR1cm4gYHRyYW5zbGF0ZVgoJHtweCh2YWx1ZSl9KWA7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgXCJ0cmFuc2xhdGVYXCIgZm9yIENTUyBcInRyYW5zZm9ybVwiIHByb3BlcnR5LlxuICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSB4XG4gKiBAcGFyYW0geyhudW1iZXJ8c3RyaW5nKT19IG9wdF95XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2xhdGUoeCwgb3B0X3kpIHtcbiAgaWYgKHR5cGVvZiB4ID09ICdudW1iZXInKSB7XG4gICAgeCA9IHB4KHgpO1xuICB9XG4gIGlmIChvcHRfeSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIGB0cmFuc2xhdGUoJHt4fSlgO1xuICB9XG4gIGlmICh0eXBlb2Ygb3B0X3kgPT0gJ251bWJlcicpIHtcbiAgICBvcHRfeSA9IHB4KG9wdF95KTtcbiAgfVxuICByZXR1cm4gYHRyYW5zbGF0ZSgke3h9LCAke29wdF95fSlgO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIFwic2NhbGVcIiBmb3IgQ1NTIFwidHJhbnNmb3JtXCIgcHJvcGVydHkuXG4gKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzY2FsZSh2YWx1ZSkge1xuICByZXR1cm4gYHNjYWxlKCR7dmFsdWV9KWA7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIFwicm90YXRlXCIgZm9yIENTUyBcInRyYW5zZm9ybVwiIHByb3BlcnR5LlxuICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcm90YXRlKHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT0gJ251bWJlcicpIHtcbiAgICB2YWx1ZSA9IGRlZyh2YWx1ZSk7XG4gIH1cbiAgcmV0dXJuIGByb3RhdGUoJHt2YWx1ZX0pYDtcbn1cblxuLyoqXG4gKiBSZW1vdmUgYWxwaGEgdmFsdWUgZnJvbSBhIHJnYmEgY29sb3IgdmFsdWUuXG4gKiBSZXR1cm4gdGhlIG5ldyBjb2xvciBwcm9wZXJ0eSB3aXRoIGFscGhhIGVxdWFscyBpZiBoYXMgdGhlIGFscGhhIHZhbHVlLlxuICogQ2FsbGVyIG5lZWRzIHRvIG1ha2Ugc3VyZSB0aGUgaW5wdXQgY29sb3IgdmFsdWUgaXMgYSB2YWxpZCByZ2JhL3JnYiB2YWx1ZVxuICogQHBhcmFtIHtzdHJpbmd9IHJnYmFDb2xvclxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlQWxwaGFGcm9tQ29sb3IocmdiYUNvbG9yKSB7XG4gIHJldHVybiByZ2JhQ29sb3IucmVwbGFjZShcbiAgICAgIC9cXCgoW14sXSspLChbXixdKyksKFteLCldKyksW14pXStcXCkvZywgJygkMSwkMiwkMywgMSknKTtcbn1cblxuLyoqXG4gKiBHZXRzIHRoZSBjb21wdXRlZCBzdHlsZSBvZiB0aGUgZWxlbWVudC4gVGhlIGhlbHBlciBpcyBuZWNlc3NhcnkgdG8gZW5mb3JjZVxuICogdGhlIHBvc3NpYmxlIGBudWxsYCB2YWx1ZSByZXR1cm5lZCBieSBhIGJ1Z2d5IEZpcmVmb3guXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVkU3R5bGUod2luLCBlbCkge1xuICBjb25zdCBzdHlsZSA9IC8qKiBAdHlwZSB7P0NTU1N0eWxlRGVjbGFyYXRpb259ICovKHdpbi5nZXRDb21wdXRlZFN0eWxlKGVsKSk7XG4gIHJldHVybiAvKiogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSAqLyhzdHlsZSkgfHwgbWFwKCk7XG59XG5cblxuLyoqXG4gKiBSZXNldHMgc3R5bGVzIHRoYXQgd2VyZSBzZXQgZHluYW1pY2FsbHkgKGkuZS4gaW5saW5lKVxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHshQXJyYXk8c3RyaW5nPn0gcHJvcGVydGllc1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRTdHlsZXMoZWxlbWVudCwgcHJvcGVydGllcykge1xuICBjb25zdCBzdHlsZU9iaiA9IHt9O1xuICBwcm9wZXJ0aWVzLmZvckVhY2gocHJvcCA9PiB7XG4gICAgc3R5bGVPYmpbcHJvcF0gPSBudWxsO1xuICB9KTtcbiAgc2V0U3R5bGVzKGVsZW1lbnQsIHN0eWxlT2JqKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKiBAY29uc3QgKi9cbmNvbnN0IHRvU3RyaW5nXyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG5cbi8qKlxuICogUmV0dXJucyB0aGUgRUNNQSBbW0NsYXNzXV0gb2YgYSB2YWx1ZVxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0b1N0cmluZyh2YWx1ZSkge1xuICByZXR1cm4gdG9TdHJpbmdfLmNhbGwodmFsdWUpO1xufVxuXG4vKipcbiAqIERldGVybWluZXMgaWYgdmFsdWUgaXMgYWN0dWFsbHkgYW4gQXJyYXkuXG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBcnJheSh2YWx1ZSkge1xuICByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG59XG5cbi8qKlxuICogQ29udmVydHMgYW4gYXJyYXktbGlrZSBvYmplY3QgdG8gYW4gYXJyYXkuXG4gKiBAcGFyYW0gez9JQXJyYXlMaWtlPFQ+fHN0cmluZ30gYXJyYXlMaWtlXG4gKiBAcmV0dXJuIHshQXJyYXk8VD59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9BcnJheShhcnJheUxpa2UpIHtcbiAgaWYgKCFhcnJheUxpa2UpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgY29uc3QgYXJyYXkgPSBuZXcgQXJyYXkoYXJyYXlMaWtlLmxlbmd0aCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXlMaWtlLmxlbmd0aDsgaSsrKSB7XG4gICAgYXJyYXlbaV0gPSBhcnJheUxpa2VbaV07XG4gIH1cbiAgcmV0dXJuIGFycmF5O1xufVxuXG4vKipcbiAqIERldGVybWluZXMgaWYgdmFsdWUgaXMgYWN0dWFsbHkgYW4gT2JqZWN0LlxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlKSB7XG4gIHJldHVybiB0b1N0cmluZyh2YWx1ZSkgPT09ICdbb2JqZWN0IE9iamVjdF0nO1xufVxuXG4vKipcbiAqIERldGVybWluZXMgaWYgdmFsdWUgaXMgb2YgbnVtYmVyIHR5cGUgYW5kIGZpbml0ZS5cbiAqIE5hTiBhbmQgSW5maW5pdHkgYXJlIG5vdCBjb25zaWRlcmVkIGEgZmluaXRlIG51bWJlci5cbiAqIFN0cmluZyBudW1iZXJzIGFyZSBub3QgY29uc2lkZXJlZCBudW1iZXJzLlxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRmluaXRlTnVtYmVyKHZhbHVlKSB7XG4gIHJldHVybiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiBpc0Zpbml0ZSh2YWx1ZSkpO1xufVxuXG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIGBzYCBpcyBhIHZhbGlkIHZhbHVlIG9mIGBlbnVtT2JqYC5cbiAqXG4gKiBAcGFyYW0geyFPYmplY3Q8VD59IGVudW1PYmpcbiAqIEBwYXJhbSB7VH0gc1xuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0VudW1WYWx1ZShlbnVtT2JqLCBzKSB7XG4gIGZvciAoY29uc3QgayBpbiBlbnVtT2JqKSB7XG4gICAgaWYgKGVudW1PYmpba10gPT09IHMpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogRXh0ZXJucyBkZWNsYXJlIHRoYXQgYWNjZXNzIGBkZWZhdWx0Vmlld2AgZnJvbSBgZG9jdW1lbnRgIG9yXG4gKiBgb3duZXJEb2N1bWVudGAgaXMgb2YgdHlwZSBgKFdpbmRvd3xudWxsKWAgYnV0IG1vc3Qgb2Ygb3VyIHBhcmFtZXRlciB0eXBlc1xuICogYXNzdW1lIHRoYXQgaXQgaXMgbmV2ZXIgbnVsbC4gVGhpcyBpcyBPSyBpbiBwcmFjdGljZSBhcyB3ZSBldmVyIG9ubHkgZ2V0XG4gKiBudWxsIG9uIGRpc2Nvbm5lY3RlZCBkb2N1bWVudHMgb3Igb2xkIElFLlxuICogVGhpcyBoZWxwZXIgZnVuY3Rpb24gY2FzdHMgaXQgaW50byBqdXN0IGEgc2ltcGxlIFdpbmRvdyByZXR1cm4gdHlwZS5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d8bnVsbH0gd2luT3JOdWxsXG4gKiBAcmV0dXJuIHshV2luZG93fVxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9XaW4od2luT3JOdWxsKSB7XG4gIHJldHVybiAvKiogQHR5cGUgeyFXaW5kb3d9ICovICh3aW5Pck51bGwpO1xufVxuXG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHt0cnlEZWNvZGVVcmlDb21wb25lbnRffSBmcm9tICcuL3VybC10cnktZGVjb2RlLXVyaS1jb21wb25lbnQnO1xuXG5jb25zdCByZWdleCA9IC8oPzpeWyM/XT98JikoW149Jl0rKSg/Oj0oW14mXSopKT8vZztcblxuLyoqXG4gKiBQYXJzZXMgdGhlIHF1ZXJ5IHN0cmluZyBvZiBhbiBVUkwuIFRoaXMgbWV0aG9kIHJldHVybnMgYSBzaW1wbGUga2V5L3ZhbHVlXG4gKiBtYXAuIElmIHRoZXJlIGFyZSBkdXBsaWNhdGUga2V5cyB0aGUgbGF0ZXN0IHZhbHVlIGlzIHJldHVybmVkLlxuICpcbiAqIERPIE5PVCBpbXBvcnQgdGhlIGZ1bmN0aW9uIGZyb20gdGhpcyBmaWxlLiBJbnN0ZWFkLCBpbXBvcnQgcGFyc2VRdWVyeVN0cmluZ1xuICogZnJvbSBgc3JjL3VybC5qc2AuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5U3RyaW5nXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlUXVlcnlTdHJpbmdfKHF1ZXJ5U3RyaW5nKSB7XG4gIGNvbnN0IHBhcmFtcyA9IC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovIChPYmplY3QuY3JlYXRlKG51bGwpKTtcbiAgaWYgKCFxdWVyeVN0cmluZykge1xuICAgIHJldHVybiBwYXJhbXM7XG4gIH1cblxuICBsZXQgbWF0Y2g7XG4gIHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKHF1ZXJ5U3RyaW5nKSkpIHtcbiAgICBjb25zdCBuYW1lID0gdHJ5RGVjb2RlVXJpQ29tcG9uZW50XyhtYXRjaFsxXSwgbWF0Y2hbMV0pO1xuICAgIGNvbnN0IHZhbHVlID0gbWF0Y2hbMl0gPyB0cnlEZWNvZGVVcmlDb21wb25lbnRfKG1hdGNoWzJdLCBtYXRjaFsyXSkgOiAnJztcbiAgICBwYXJhbXNbbmFtZV0gPSB2YWx1ZTtcbiAgfVxuICByZXR1cm4gcGFyYW1zO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogVHJpZXMgdG8gZGVjb2RlIGEgVVJJIGNvbXBvbmVudCwgZmFsbGluZyBiYWNrIHRvIG9wdF9mYWxsYmFjayAob3IgYW4gZW1wdHlcbiAqIHN0cmluZylcbiAqXG4gKiBETyBOT1QgaW1wb3J0IHRoZSBmdW5jdGlvbiBmcm9tIHRoaXMgZmlsZS4gSW5zdGVhZCwgaW1wb3J0XG4gKiB0cnlEZWNvZGVVcmlDb21wb25lbnQgZnJvbSBgc3JjL3VybC5qc2AuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGNvbXBvbmVudFxuICogQHBhcmFtIHtzdHJpbmc9fSBmYWxsYmFja1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ5RGVjb2RlVXJpQ29tcG9uZW50Xyhjb21wb25lbnQsIGZhbGxiYWNrID0gJycpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGNvbXBvbmVudCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZmFsbGJhY2s7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2lzT2JqZWN0fSBmcm9tICcuLi90eXBlcyc7XG5cbi8qIEBjb25zdCAqL1xuY29uc3QgaGFzT3duXyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cbi8qKlxuICogUmV0dXJucyBhIG1hcC1saWtlIG9iamVjdC5cbiAqIElmIG9wdF9pbml0aWFsIGlzIHByb3ZpZGVkLCBjb3BpZXMgaXRzIG93biBwcm9wZXJ0aWVzIGludG8gdGhlXG4gKiBuZXdseSBjcmVhdGVkIG9iamVjdC5cbiAqIEBwYXJhbSB7VD19IG9wdF9pbml0aWFsIFRoaXMgc2hvdWxkIHR5cGljYWxseSBiZSBhbiBvYmplY3QgbGl0ZXJhbC5cbiAqIEByZXR1cm4ge1R9XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFwKG9wdF9pbml0aWFsKSB7XG4gIGNvbnN0IG9iaiA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIGlmIChvcHRfaW5pdGlhbCkge1xuICAgIE9iamVjdC5hc3NpZ24ob2JqLCBvcHRfaW5pdGlhbCk7XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cblxuLyoqXG4gKiBSZXR1cm4gYW4gZW1wdHkgSnNvbk9iamVjdCBvciBtYWtlcyB0aGUgcGFzc2VkIGluIG9iamVjdCBsaXRlcmFsXG4gKiBhbiBKc29uT2JqZWN0LlxuICogVGhlIEpzb25PYmplY3QgdHlwZSBpcyBqdXN0IGEgc2ltcGxlIG9iamVjdCB0aGF0IGlzIGF0LWRpY3QuXG4gKiBTZWVcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvY2xvc3VyZS1jb21waWxlci93aWtpL0BzdHJ1Y3QtYW5kLUBkaWN0LUFubm90YXRpb25zXG4gKiBmb3Igd2hhdCBhIGRpY3QgaXMgdHlwZS13aXNlLlxuICogVGhlIGxpbnRlciBlbmZvcmNlcyB0aGF0IHRoZSBhcmd1bWVudCBpcywgaW4gZmFjdCwgYXQtZGljdCBsaWtlLlxuICogQHBhcmFtIHshT2JqZWN0PX0gb3B0X2luaXRpYWxcbiAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGljdChvcHRfaW5pdGlhbCkge1xuICAvLyBXZSBkbyBub3QgY29weS4gVGhlIGxpbnRlciBlbmZvcmNlcyB0aGF0IHRoZSBwYXNzZWQgaW4gb2JqZWN0IGlzIGEgbGl0ZXJhbFxuICAvLyBhbmQgdGh1cyB0aGUgY2FsbGVyIGNhbm5vdCBoYXZlIGEgcmVmZXJlbmNlIHRvIGl0LlxuICByZXR1cm4gLyoqIEB0eXBlIHshSnNvbk9iamVjdH0gKi8gKG9wdF9pbml0aWFsIHx8IHt9KTtcbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgdGhlIGdpdmVuIGtleSBpcyBhIHByb3BlcnR5IGluIHRoZSBtYXAuXG4gKlxuICogQHBhcmFtIHtUfSAgb2JqIGEgbWFwIGxpa2UgcHJvcGVydHkuXG4gKiBAcGFyYW0ge3N0cmluZ30gIGtleVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoYXNPd24ob2JqLCBrZXkpIHtcbiAgcmV0dXJuIGhhc093bl8uY2FsbChvYmosIGtleSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBvYmpba2V5XSBpZmYga2V5IGlzIG9iaidzIG93biBwcm9wZXJ0eSAoaXMgbm90IGluaGVyaXRlZCkuXG4gKiBPdGhlcndpc2UsIHJldHVybnMgdW5kZWZpbmVkLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmpcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXlcbiAqIEByZXR1cm4geyp9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvd25Qcm9wZXJ0eShvYmosIGtleSkge1xuICBpZiAoaGFzT3duKG9iaiwga2V5KSkge1xuICAgIHJldHVybiBvYmpba2V5XTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59XG5cbi8qKlxuICogRGVlcCBtZXJnZXMgc291cmNlIGludG8gdGFyZ2V0LlxuICpcbiAqIEBwYXJhbSB7IU9iamVjdH0gdGFyZ2V0XG4gKiBAcGFyYW0geyFPYmplY3R9IHNvdXJjZVxuICogQHBhcmFtIHtudW1iZXJ9IGRlcHRoIFRoZSBtYXhpbXVtIG1lcmdlIGRlcHRoLiBJZiBleGNlZWRlZCwgT2JqZWN0LmFzc2lnblxuICogICAgICAgICAgICAgICAgICAgICAgIHdpbGwgYmUgdXNlZCBpbnN0ZWFkLlxuICogQHJldHVybiB7IU9iamVjdH1cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBzb3VyY2UgY29udGFpbnMgYSBjaXJjdWxhciByZWZlcmVuY2UuXG4gKiBOb3RlOiBPbmx5IG5lc3RlZCBvYmplY3RzIGFyZSBkZWVwLW1lcmdlZCwgcHJpbWl0aXZlcyBhbmQgYXJyYXlzIGFyZSBub3QuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWVwTWVyZ2UodGFyZ2V0LCBzb3VyY2UsIGRlcHRoID0gMTApIHtcbiAgLy8gS2VlcCB0cmFjayBvZiBzZWVuIG9iamVjdHMgdG8gZGV0ZWN0IHJlY3Vyc2l2ZSByZWZlcmVuY2VzLlxuICBjb25zdCBzZWVuID0gW107XG5cbiAgLyoqIEB0eXBlIHshQXJyYXk8e3Q6ICFPYmplY3QsIHM6ICFPYmplY3QsIGQ6IG51bWJlcn0+fSAqL1xuICBjb25zdCBxdWV1ZSA9IFtdO1xuICBxdWV1ZS5wdXNoKHt0OiB0YXJnZXQsIHM6IHNvdXJjZSwgZDogMH0pO1xuXG4gIC8vIEJGUyB0byBlbnN1cmUgb2JqZWN0cyBkb24ndCBoYXZlIHJlY3Vyc2l2ZSByZWZlcmVuY2VzIGF0IHNoYWxsb3dlciBkZXB0aHMuXG4gIHdoaWxlIChxdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgY29uc3Qge3QsIHMsIGR9ID0gcXVldWUuc2hpZnQoKTtcbiAgICBpZiAoc2Vlbi5pbmNsdWRlcyhzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdTb3VyY2Ugb2JqZWN0IGhhcyBhIGNpcmN1bGFyIHJlZmVyZW5jZS4nKTtcbiAgICB9XG4gICAgc2Vlbi5wdXNoKHMpO1xuICAgIGlmICh0ID09PSBzKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKGQgPiBkZXB0aCkge1xuICAgICAgT2JqZWN0LmFzc2lnbih0LCBzKTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBPYmplY3Qua2V5cyhzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICBjb25zdCBuZXdWYWx1ZSA9IHNba2V5XTtcbiAgICAgIC8vIFBlcmZvcm0gYSBkZWVwIG1lcmdlIElGRiBib3RoIHRhcmdldCBhbmQgc291cmNlIGhhdmUgdGhlIHNhbWUga2V5XG4gICAgICAvLyB3aG9zZSBjb3JyZXNwb25kaW5nIHZhbHVlcyBhcmUgb2JqZWN0cy5cbiAgICAgIGlmIChoYXNPd24odCwga2V5KSkge1xuICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IHRba2V5XTtcbiAgICAgICAgaWYgKGlzT2JqZWN0KG5ld1ZhbHVlKSAmJiBpc09iamVjdChvbGRWYWx1ZSkpIHtcbiAgICAgICAgICBxdWV1ZS5wdXNoKHt0OiBvbGRWYWx1ZSwgczogbmV3VmFsdWUsIGQ6IGQgKyAxfSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0W2tleV0gPSBuZXdWYWx1ZTtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gdGFyZ2V0O1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IU9iamVjdH0gbyBBbiBvYmplY3QgdG8gcmVtb3ZlIHByb3BlcnRpZXMgZnJvbVxuICogQHBhcmFtIHshQXJyYXk8c3RyaW5nPn0gcHJvcHMgQSBsaXN0IG9mIHByb3BlcnRpZXMgdG8gcmVtb3ZlIGZyb20gdGhlIE9iamVjdFxuICogQHJldHVybiB7IU9iamVjdH0gQW4gb2JqZWN0IHdpdGggdGhlIGdpdmVuIHByb3BlcnRpZXMgcmVtb3ZlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gb21pdChvLCBwcm9wcykge1xuICByZXR1cm4gT2JqZWN0LmtleXMobykucmVkdWNlKChhY2MsIGtleSkgPT4ge1xuICAgIGlmICghcHJvcHMuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgYWNjW2tleV0gPSBvW2tleV07XG4gICAgfVxuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIFJldHVybnMgYSBEZWZlcnJlZCBzdHJ1Y3QsIHdoaWNoIGhvbGRzIGEgcGVuZGluZyBwcm9taXNlIGFuZCBpdHMgYXNzb2NpYXRlZFxuICogcmVzb2x2ZSBhbmQgcmVqZWN0IGZ1bmN0aW9ucy5cbiAqXG4gKiBUaGlzIGlzIHByZWZlcnJlZCBpbnN0ZWFkIG9mIGNyZWF0aW5nIGEgUHJvbWlzZSBpbnN0YW5jZSB0byBleHRyYWN0IHRoZVxuICogcmVzb2x2ZS9yZWplY3QgZnVuY3Rpb25zIHlvdXJzZWxmOlxuICpcbiAqIGBgYFxuICogLy8gQXZvaWQgZG9pbmdcbiAqIGxldCByZXNvbHZlO1xuICogY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKHJlcyA9PiB7XG4gKiAgIHJlc29sdmUgPSByZXM7XG4gKiB9KTtcbiAqXG4gKiAvLyBHb29kXG4gKiBjb25zdCBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICogY29uc3QgeyBwcm9taXNlLCByZXNvbHZlIH0gPSBkZWZlcnJlZDtcbiAqIGBgYFxuICpcbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBjbGFzcyBEZWZlcnJlZCB7XG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIERlZmVycmVkLlxuICAgKi9cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgbGV0IHJlc29sdmUsIHJlamVjdDtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdCB7IVByb21pc2U8VD59XG4gICAgICovXG4gICAgdGhpcy5wcm9taXNlID0gbmV3IC8qT0sqL1Byb21pc2UoKHJlcywgcmVqKSA9PiB7XG4gICAgICByZXNvbHZlID0gcmVzO1xuICAgICAgcmVqZWN0ID0gcmVqO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQGNvbnN0IHtmdW5jdGlvbihUPSl9XG4gICAgICovXG4gICAgdGhpcy5yZXNvbHZlID0gcmVzb2x2ZTtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdCB7ZnVuY3Rpb24oKj0pfVxuICAgICAqL1xuICAgIHRoaXMucmVqZWN0ID0gcmVqZWN0O1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIHByb21pc2UgcmVzb2x2ZWQgdG8gdGhlIHJldHVybiB2YWx1ZSBvZiBmbi5cbiAqIElmIGZuIHN5bmMgdGhyb3dzLCBpdCB3aWxsIGNhdXNlIHRoZSBwcm9taXNlIHRvIHJlamVjdC5cbiAqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCk6VH0gZm5cbiAqIEByZXR1cm4geyFQcm9taXNlPFQ+fVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyeVJlc29sdmUoZm4pIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgIHJlc29sdmUoZm4oKSk7XG4gIH0pO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIHdoaWNoIHJlc29sdmVzIGlmIGEgdGhyZXNob2xkIGFtb3VudCBvZiB0aGUgZ2l2ZW4gcHJvbWlzZXNcbiAqIHJlc29sdmUsIGFuZCByZWplY3RzIG90aGVyd2lzZS5cbiAqIEBwYXJhbSB7IUFycmF5PCFQcm9taXNlPn0gcHJvbWlzZXMgVGhlIGFycmF5IG9mIHByb21pc2VzIHRvIHRlc3QuXG4gKiBAcGFyYW0ge251bWJlcn0gY291bnQgVGhlIG51bWJlciBvZiBwcm9taXNlcyB0aGF0IG11c3QgcmVzb2x2ZSBmb3IgdGhlXG4gKiAgICAgcmV0dXJuZWQgcHJvbWlzZSB0byByZXNvbHZlLlxuICogQHJldHVybiB7IVByb21pc2V9IEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIGlmIGFueSBvZiB0aGUgZ2l2ZW4gcHJvbWlzZXNcbiAqICAgICByZXNvbHZlLCBhbmQgd2hpY2ggcmVqZWN0cyBvdGhlcndpc2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzb21lKHByb21pc2VzLCBjb3VudCA9IDEpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb3VudCA9IE1hdGgubWF4KGNvdW50LCAwKTtcbiAgICBjb25zdCBleHRyYSA9IHByb21pc2VzLmxlbmd0aCAtIGNvdW50O1xuICAgIGlmIChleHRyYSA8IDApIHtcbiAgICAgIHJlamVjdChuZXcgRXJyb3IoJ25vdCBlbm91Z2ggcHJvbWlzZXMgdG8gcmVzb2x2ZScpKTtcbiAgICB9XG4gICAgaWYgKHByb21pc2VzLmxlbmd0aCA9PSAwKSB7XG4gICAgICByZXNvbHZlKFtdKTtcbiAgICB9XG4gICAgY29uc3QgdmFsdWVzID0gW107XG4gICAgY29uc3QgcmVhc29ucyA9IFtdO1xuXG4gICAgY29uc3Qgb25GdWxmaWxsZWQgPSB2YWx1ZSA9PiB7XG4gICAgICBpZiAodmFsdWVzLmxlbmd0aCA8IGNvdW50KSB7XG4gICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIGlmICh2YWx1ZXMubGVuZ3RoID09IGNvdW50KSB7XG4gICAgICAgIHJlc29sdmUodmFsdWVzKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IG9uUmVqZWN0ZWQgPSByZWFzb24gPT4ge1xuICAgICAgaWYgKHJlYXNvbnMubGVuZ3RoIDw9IGV4dHJhKSB7XG4gICAgICAgIHJlYXNvbnMucHVzaChyZWFzb24pO1xuICAgICAgfVxuICAgICAgaWYgKHJlYXNvbnMubGVuZ3RoID4gZXh0cmEpIHtcbiAgICAgICAgcmVqZWN0KHJlYXNvbnMpO1xuICAgICAgfVxuICAgIH07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9taXNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgUHJvbWlzZS5yZXNvbHZlKHByb21pc2VzW2ldKS50aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIFJlc29sdmVzIHdpdGggdGhlIHJlc3VsdCBvZiB0aGUgbGFzdCBwcm9taXNlIGFkZGVkLlxuICogQGltcGxlbWVudHMge0lUaGVuYWJsZX1cbiAqL1xuZXhwb3J0IGNsYXNzIExhc3RBZGRlZFJlc29sdmVyIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IUFycmF5PCFQcm9taXNlPj19IG9wdF9wcm9taXNlc1xuICAgKi9cbiAgY29uc3RydWN0b3Iob3B0X3Byb21pc2VzKSB7XG4gICAgbGV0IHJlc29sdmVfLCByZWplY3RfO1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFQcm9taXNlfSAqL1xuICAgIHRoaXMucHJvbWlzZV8gPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZXNvbHZlXyA9IHJlc29sdmU7XG4gICAgICByZWplY3RfID0gcmVqZWN0O1xuICAgIH0pO1xuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5yZXNvbHZlXyA9IHJlc29sdmVfO1xuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5yZWplY3RfID0gcmVqZWN0XztcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMuY291bnRfID0gMDtcblxuICAgIGlmIChvcHRfcHJvbWlzZXMpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb3B0X3Byb21pc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuYWRkKG9wdF9wcm9taXNlc1tpXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBhIHByb21pc2UgdG8gcG9zc2libHkgYmUgcmVzb2x2ZWQuXG4gICAqIEBwYXJhbSB7IVByb21pc2V9IHByb21pc2VcbiAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAqL1xuICBhZGQocHJvbWlzZSkge1xuICAgIGNvbnN0IGNvdW50QXRBZGQgPSArK3RoaXMuY291bnRfO1xuICAgIFByb21pc2UucmVzb2x2ZShwcm9taXNlKS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICBpZiAodGhpcy5jb3VudF8gPT09IGNvdW50QXRBZGQpIHtcbiAgICAgICAgdGhpcy5yZXNvbHZlXyhyZXN1bHQpO1xuICAgICAgfVxuICAgIH0sIGVycm9yID0+IHtcbiAgICAgIC8vIERvbid0IGZvbGxvdyBiZWhhdmlvciBvZiBQcm9taXNlLmFsbCBhbmQgUHJvbWlzZS5yYWNlIGVycm9yIHNvIHRoYXRcbiAgICAgIC8vIHRoaXMgd2lsbCBvbmx5IHJlamVjdCB3aGVuIG1vc3QgcmVjZW50bHkgYWRkZWQgcHJvbWlzZSBmYWlscy5cbiAgICAgIGlmICh0aGlzLmNvdW50XyA9PT0gY291bnRBdEFkZCkge1xuICAgICAgICB0aGlzLnJlamVjdF8oZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLnByb21pc2VfO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICB0aGVuKG9wdF9yZXNvbHZlLCBvcHRfcmVqZWN0KSB7XG4gICAgcmV0dXJuIHRoaXMucHJvbWlzZV8udGhlbihvcHRfcmVzb2x2ZSwgb3B0X3JlamVjdCk7XG4gIH1cbn1cbiIsIi8qISBodHRwczovL210aHMuYmUvY3NzZXNjYXBlIHYxLjUuMSBieSBAbWF0aGlhcyB8IE1JVCBsaWNlbnNlICovXG5cblxuLyoqXG4gKiBUaGlzIHJlZ2V4IGNvbnNpc3RzIG9mIDQgbWF0Y2hpbmcgY2FwdHVyZSBncm91cHMgYW5kIG9uZSAobm9uLW1hdGNoaW5nKSBmYWxsYmFjazpcbiAqXG4gKiAtIChcXDApLCBjYXRjaCB0aGUgbnVsbCB0ZXJtaW5hdG9yIGNoYXJhY3RlciBzbyBpdCBtYXkgYmUgcmVwbGFjZWQgYnkgVVRGXG4gKiAgIFJlcGxhY2VtZW50IENoYXJcbiAqIC0gXigtKSQsIGNhdGNoIGEgc29saXRhcnkgZGFzaCBjaGFyLCBzbyB0aGF0IGl0IG1heSBiZSBiYWNrc2xhc2ggZXNjYXBlZC5cbiAqICAgVGhpcyBpcyBhIHNlcGFyYXRlIGNhcHR1cmUgZ3JvdXAgc28gdGhhdCB0aGUgbGVnYWwtY2hhcnMgKGdyb3VwIDQpIGRvZXNuJ3RcbiAqICAgY2FwdHVyZSBpdCBmaXJzdCwgc2luY2UgdGhhdCBncm91cCBkb2Vzbid0IG5lZWQgdG8gZXNjYXBlIGl0cyBkYXNoLlxuICogLSAoW1xceDAxLVxceDFmXFx4N2ZdfF4tP1swLTldKSwgY2F0Y2ggYSBVVEYgY29udHJvbCBjaGFyLCBvciBhbnkgbGVhZGluZ1xuICogICBudW1iZXIgKHdpdGggYW4gb3B0aW9uYWwgbGVhZGluZyBkYXNoKS4gVGhlIGNvbnRyb2wgb3IgdGhlIG51bWJlciAoYnV0IG5vdFxuICogICB0aGUgbGVhZGluZyBkYXNoKSBtdXN0IGJlIGhleC1lc2NhcGVkLC5cbiAqIC0gKFtcXHg4MC1cXHVmZmZmMC05YS16QS1aXy1dKyksIGNhdGNoIGxlZ2FsLWNoYXJzLCB3aXRoIHRoZSBleGNlcHRpb24gb2YgYVxuICogICBzb2xpdGFyeSBkYXNoLCB3aGljaCB3aWxsIGFscmVhZHkgaGF2ZSBtYXRjaGVkIGluIGdyb3VwIDEuXG4gKiAtIFteXSwgZmluYWxseSwgYSBjYXRjaC1hbGwgdGhhdCBhbGxvd3MgdXMgdG8gYmFja3NsYXNoIGVzY2FwZSB0aGUgY2hhci5cbiAqXG4gKiBUb2dldGhlciwgdGhpcyBtYXRjaGVzIGV2ZXJ5dGhpbmcgbmVjZXNzYXJ5IGZvciBDU1MuZXNjYXBlLlxuICovXG52YXIgcmVnZXggPSAvKFxcMCl8XigtKSR8KFtcXHgwMS1cXHgxZlxceDdmXXxeLT9bMC05XSl8KFtcXHg4MC1cXHVmZmZmMC05YS16QS1aXy1dKyl8W15dL2c7XG5cbmZ1bmN0aW9uIGVzY2FwZXIobWF0Y2gsIG5pbCwgZGFzaCwgaGV4RXNjYXBlLCBjaGFycykge1xuICAvLyBDaGFycyBpcyB0aGUgbGVnYWwtY2hhcnMgKGdyb3VwIDQpIGNhcHR1cmVcbiAgaWYgKGNoYXJzKSB7XG4gICAgcmV0dXJuIGNoYXJzO1xuICB9XG4gIC8vIE5pbCBpcyB0aGUgbnVsbCB0ZXJtaW5hdG9yIChncm91cCAxKSBjYXB0dXJlXG4gIGlmIChuaWwpIHtcbiAgICByZXR1cm4gJ1xcdUZGRkQnO1xuICB9XG4gIC8vIEJvdGggVVRGIGNvbnRyb2wgY2hhcnMsIGFuZCBsZWFkaW5nIG51bWJlcnMgKHdpdGggb3B0aW9uYWwgbGVhZGluZyBkYXNoKVxuICAvLyAoZ3JvdXAgMykgbXVzdCBiZSBiYWNrc2xhc2ggZXNjYXBlZCB3aXRoIGEgdHJhaWxpbmcgc3BhY2UuICBGdW5uaWx5LCB0aGVcbiAgLy8gbGVhZGluZyBkYXNoIG11c3Qgbm90IGJlIGVzY2FwZWQsIGJ1dCB0aGUgbnVtYmVyLiA6c2hydWc6XG4gIGlmIChoZXhFc2NhcGUpIHtcbiAgICByZXR1cm4gbWF0Y2guc2xpY2UoMCwgLTEpICsgJ1xcXFwnICsgbWF0Y2guc2xpY2UoLTEpLmNoYXJDb2RlQXQoMCkudG9TdHJpbmcoMTYpICsgJyAnXG4gIH1cbiAgLy8gRmluYWxseSwgdGhlIHNvbGl0YXJ5IGRhc2ggYW5kIHRoZSBjYXRjaC1hbGwgY2hhcnMgcmVxdWlyZSBiYWNrc2xhc2hcbiAgLy8gZXNjYXBpbmcuXG4gIHJldHVybiAnXFxcXCcgKyBtYXRjaDtcbn1cblxuLyoqXG4gKiBodHRwczovL2RyYWZ0cy5jc3N3Zy5vcmcvY3Nzb20vI3NlcmlhbGl6ZS1hbi1pZGVudGlmaWVyXG4gKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNzc0VzY2FwZSh2YWx1ZSkge1xuICByZXR1cm4gU3RyaW5nKHZhbHVlKS5yZXBsYWNlKHJlZ2V4LCBlc2NhcGVyKTtcbn1cbiJdfQ=="}