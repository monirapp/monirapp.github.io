(self.AMP=self.AMP||[]).push({n:"amp-access-scroll",v:"0",f:(function(AMP,_){
var k;function m(a,c){function b(){}b.prototype=c.prototype;a.prototype=new b;a.prototype.constructor=a;for(var d in c)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(c,d);e&&Object.defineProperty(a,d,e)}else a[d]=c[d]}function n(a,c){c=void 0===c?"":c;try{return decodeURIComponent(a)}catch(b){return c}};var p=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function q(a){var c=Object.create(null);if(!a)return c;for(var b;b=p.exec(a);){var d=n(b[1],b[1]),e=b[2]?n(b[2],b[2]):"";c[d]=e}return c};var r="";
function t(){var a,c=a||self,b;if(c.AMP_MODE)b=c.AMP_MODE;else{b=c;var d=!!(self.AMP_CONFIG||{}).test||!1,e=q(b.location.originalHash||b.location.hash),f=q(b.location.search);r||(r=b.AMP_CONFIG&&b.AMP_CONFIG.v?b.AMP_CONFIG.v:"010");b=c.AMP_MODE={localDev:!1,development:!("1"!=e.development&&!b.AMP_DEV_MODE),examiner:"2"==e.development,filter:e.filter,geoOverride:e["amp-geo"],minified:!0,lite:void 0!=f.amp_lite,test:d,log:e.log,version:"0",rtvVersion:r}}return b};self.log=self.log||{user:null,dev:null,userForEmbed:null};var u=self.log;function v(){if(!u.user)throw Error("failed to call initLogConstructor");return u.user};function w(a){return a||{}};function x(){var a,c;this.promise=new Promise(function(b,d){a=b;c=d});this.resolve=a;this.reject=c};function y(a,c){a=a.__AMP_TOP||a;return z(a,c)}function B(a){var c=C(a),c=D(c);return z(c,"documentInfo")}function E(a){a=C(a);a=D(a);return z(a,"viewport")}function C(a){return a.nodeType?y((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function D(a){a=C(a);return a.isSingleDoc()?a.win:a}function z(a,c){var b=F(a);a=b[c];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}
function G(a){var c=F(a).access;if(c){if(c.promise)return c.promise;z(a,"access");return c.promise=Promise.resolve(c.obj)}return null}function F(a){var c=a.services;c||(c=a.services={});return c};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function H(a,c){for(var b in c)a.setAttribute(b,c[b]);return a};function I(a){return J(a).then(function(a){return v().assert(a,"Service %s was requested to be provided through %s, but %s is not loaded in the current page. To fix this problem load the JavaScript file for %s in this page.","access","amp-access","amp-access","amp-access")})}
function J(a){var c=C(a),b=G(D(a));return b?b:c.whenBodyAvailable().then(function(){var a;a=c.win;var b=c.getHeadNode(),f;if(b){f=[];for(var b=b.querySelectorAll("script[custom-element]"),g=0;g<b.length;g++)f.push(b[g].getAttribute("custom-element"))}else f=[];a=f.includes("amp-access")?y(a,"extensions").waitForExtension(a,"amp-access"):Promise.resolve();return a}).then(function(){var b=c.win;if(b.ampExtendedElements&&b.ampExtendedElements["amp-access"]){var b=D(a),e=G(b);if(!e){var f=new x,e=f.promise,
f=f.resolve;F(b).access={obj:null,promise:e,resolve:f,context:null,ctor:null}}b=e}else b=null;return b})};function K(a){this.K=a;this.B=this.F=0;this.o=Object.create(null)}K.prototype.has=function(a){return!!this.o[a]};K.prototype.get=function(a){var c=this.o[a];if(c)return c.access=++this.B,c.payload};
K.prototype.put=function(a,c){this.has(a)||this.F++;this.o[a]={payload:c,access:this.B};if(!(this.F<=this.K)){if(u.dev)a=u.dev;else throw Error("failed to call initLogConstructor");a.warn("lru-cache","Trimming LRU cache");a=this.o;var b=this.B+1,d,e;for(e in a){var f=a[e].access;f<b&&(b=f,d=e)}void 0!==d&&(delete a[d],this.F--)}};w({c:!0,v:!0,a:!0,ad:!0});var L,M;
function N(a){if("string"==typeof a){L||(L=self.document.createElement("a"),M=self.UrlCache||(self.UrlCache=new K(100)));var c=M,b=L;if(c&&c.has(a))a=c.get(a);else{b.href=a;b.protocol||(b.href=b.href);var d={href:b.href,protocol:b.protocol,host:b.host,hostname:b.hostname,port:"0"==b.port?"":b.port,pathname:b.pathname,search:b.search,hash:b.hash,origin:null};"/"!==d.pathname[0]&&(d.pathname="/"+d.pathname);if("http:"==d.protocol&&80==d.port||"https:"==d.protocol&&443==d.port)d.port="",d.host=d.hostname;
d.origin=b.origin&&"null"!=b.origin?b.origin:"data:"!=d.protocol&&d.host?d.protocol+"//"+d.host:d.href;c&&c.put(a,d);a=d}}(c="https:"==a.protocol||"localhost"==a.hostname)||(a=a.hostname,c=a.length-10,c=0<=c&&a.indexOf(".localhost",c)==c);return c}
function O(a,c){var b;b=void 0===b?"source":b;v().assert(null!=a,"%s %s must be available",c,b);var d=a;v().assert(N(d)||/^(\/\/)/.test(d),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',c,b,d)};function P(a,c){var b=".amp-access-scroll-bar{height:44px;position:fixed;left:0;width:100%;background:transparent;z-index:2147483647;bottom:0}.amp-access-scroll-placeholder{padding-top:7px;padding-left:8px;background-color:#fff;border-top:1px solid #eee;border-bottom:1px solid #eee;box-sizing:border-box}\n/*# sourceURL=/extensions/amp-access-scroll/0.1/amp-access-scroll.css*/",d=!1,e="amp-access-scroll-elt",f=a.getHeadNode(),g=Q(f,R(f,b),d||!1,e||null);if(c){var h=a.getRootNode();if(S(h,g))c(g);else var l=
setInterval(function(){S(h,g)&&(clearInterval(l),c(g))},4)}}
function Q(a,c,b,d){var e=a.__AMP_CSS_SM;if(!e)var f=Object.create(null),e=a.__AMP_CSS_SM=f;var g=!b&&d&&"amp-custom"!=d&&"amp-keyframes"!=d;if(f=b?"amp-runtime":g?"amp-extension="+d:null){var h=T(a,e,f);if(h)return h.textContent!==c&&(h.textContent=c),h}var l=(a.ownerDocument||a).createElement("style");l.textContent=c;var A=null;b?l.setAttribute("amp-runtime",""):g?(l.setAttribute("amp-extension",d||""),A=T(a,e,"amp-runtime")):(d&&l.setAttribute(d,""),A=a.lastChild);c=A;a.insertBefore(l,c?c.nextSibling:
a.firstChild);f&&(e[f]=l);return l}function T(a,c,b){return c[b]?c[b]:(a=a.querySelector("style["+b+"]"))?c[b]=a:null}function R(a,c){return(a=a.__AMP_CSS_TR)?a(c):c}function S(a,c){var b=a.styleSheets;for(a=0;a<b.length;a++){var d=b[a];if(d.ownerNode==c)return!0}return!1};function U(a,c,b){this.ampdoc=a;this.G=b;this.m=v().assert(c.authorization,'"authorization" URL must be specified');O(this.m,'"authorization"');this.D=!c.noPingback;this.w=c.pingback;this.D&&(v().assert(this.w,'"pingback" URL must be specified'),O(this.w,'"pingback"'));b=c;b.authorizationTimeout?(b=b.authorizationTimeout,v().assert("number"==typeof b,'"authorizationTimeout" must be a number'),t().development||(b=Math.min(b,3E3))):b=3E3;this.C=b;this.H=y(a.win,"xhr");this.L=y(a.win,"timer")}k=U.prototype;
k.getConfig=function(){return{authorizationUrl:this.m,pingbackEnabled:this.D,pingbackUrl:this.w,authorizationTimeout:this.C}};k.getAuthorizationUrl=function(){return this.m};k.isAuthorizationEnabled=function(){return!0};k.getAuthorizationTimeout=function(){return this.C};k.authorize=function(){var a=this,c=this.G.buildUrl(this.m,!1);return c.then(function(b){return a.L.timeoutPromise(a.C,a.H.fetchJson(b,{credentials:"include"})).then(function(a){return a.json()})})};k.isPingbackEnabled=function(){return this.D};
k.pingback=function(){var a=this;return this.G.buildUrl(this.w,!0).then(function(c){return a.H.sendSignal(c,{method:"POST",credentials:"include",headers:w({"Content-Type":"application/x-www-form-urlencoded"}),body:""})})};k.postAction=function(){};function V(a){var c={authorization:a+"/amp/access?rid=READER_ID&cid=CLIENT_ID(scroll1)&c=CANONICAL_URL&o=AMPDOC_URL&x=QUERY_PARAM(scrollx)",pingback:a+"/amp/pingback?rid=READER_ID&cid=CLIENT_ID(scroll1)&c=CANONICAL_URL&o=AMPDOC_URL&r=DOCUMENT_REFERRER&x=QUERY_PARAM(scrollx)&d=AUTHDATA(scroll)&v=AUTHDATA(visitId)",namespace:"scroll"};return c}function W(a){return"https://connect"+(t().development&&a.tld?a.tld:".scroll.com")}
function X(a,c,b){var d=b.getAdapterConfig();U.call(this,a,V(W(d)),{buildUrl:b.buildUrl.bind(b),collectUrlVars:b.collectUrlVars.bind(b)});this.I=c;this.J=b}m(X,U);
X.prototype.authorize=function(){var a=this;return U.prototype.authorize.call(this).then(function(c){var b=a.ampdoc.getRootNode().querySelector("amp-story[standalone]");if(c&&c.scroll&&!b){var d=a.J.getAdapterConfig();(new Y(a.ampdoc)).show(a.I,d);var e=a.ampdoc;if(!d.disableAnalytics){var f=e.win.document,g=w({trigger:"immediate"});d.dataConsentId&&(g["data-block-on-consent"]="");var h=f.createElement("amp-analytics"),g=H(h,g),h=w({type:"application/json"}),f=f.createElement("script"),f=H(f,h),d=
{requests:{scroll:W(d)+"/amp/analytics?rid=ACCESS_READER_ID&cid=CLIENT_ID(scroll1)&c=CANONICAL_URL&o=AMPDOC_URL&r=DOCUMENT_REFERRER&x=QUERY_PARAM(scrollx)&d=AUTHDATA(scroll.scroll)&v=AUTHDATA(scroll.visitId)&h=SOURCE_HOSTNAME&s=${totalEngagedTime}"},triggers:{trackInterval:{on:"timer",timerSpec:{interval:15,maxTimerLength:7200},request:"scroll"}}};f.textContent=JSON.stringify(d);g.appendChild(f);g.CONFIG=d;y(e.win,"extensions").installExtensionForDoc(e,"amp-analytics");e.getBody().appendChild(g)}}return c})};
function Y(a){P(a,function(){});this.l=a;this.j=document.createElement("div");this.j.classList.add("amp-access-scroll-bar");this.j.classList.add("amp-access-scroll-placeholder");var c=document.createElement("img");c.setAttribute("src","https://static.scroll.com/assets/icn-scroll-logo.svg");c.setAttribute("layout","fixed");c.setAttribute("width",26);c.setAttribute("height",26);this.j.appendChild(c);a.getBody().appendChild(this.j);this.A=document.createElement("div");this.A.classList.add("amp-access-scroll-bar");
this.h=document.createElement("iframe");this.h.setAttribute("scrolling","no");this.h.setAttribute("frameborder","0");this.h.setAttribute("allowtransparency","true");this.h.setAttribute("title","Scroll");this.h.setAttribute("width","100%");this.h.setAttribute("height","100%");this.h.setAttribute("sandbox","allow-scripts allow-same-origin allow-top-navigation allow-popups allow-popups-to-escape-sandbox");this.A.appendChild(this.h);a.getBody().appendChild(this.A)}
Y.prototype.show=function(a,c){var b=this;E(this.l).addToFixedLayer(this.A).then(function(){return a.getAccessReaderId()}).then(function(a){b.h.onload=function(){b.l.getBody().removeChild(b.j)};var d=B(b.l).get();b.h.setAttribute("src",W(c)+"/amp/scrollbar?rid="+encodeURIComponent(a)+"&o="+encodeURIComponent(b.l.getUrl())+"&c="+encodeURIComponent(d.canonicalUrl))})};(function(a){a.registerServiceForDoc("scroll",function(a){return I(a).then(function(b){var c=b.getVendorSource("scroll"),e=new X(a,b,c),f=c.getAdapter();f.registerVendor(e);return e})})})(self.AMP);
})});
//# sourceMappingURL=amp-access-scroll-0.1.js.map

