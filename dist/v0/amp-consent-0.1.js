(self.AMP=self.AMP||[]).push({n:"amp-consent",v:"0",f:(function(AMP,_){
var g;function aa(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]}function k(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(c){return b}};var ba=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;var ca=Object.prototype.toString;function l(a){return"[object Object]"===ca.call(a)}function da(a){return"number"===typeof a&&isFinite(a)}function m(a,b){for(var c in a)if(a[c]===b)return!0;return!1};self.log=self.log||{user:null,dev:null,userForEmbed:null};var n=self.log;function r(){if(!n.user)throw Error("failed to call initLogConstructor");return n.user}function t(){if(n.dev)return n.dev;throw Error("failed to call initLogConstructor");};var u=Object.prototype.hasOwnProperty;function v(){var a,b=Object.create(null);a&&Object.assign(b,a);return b}function w(a){return a||{}}
function ea(a,b){var c=1,c=void 0===c?10:c,d=[],e=[];e.push({t:a,s:b,d:0});for(b={};0<e.length;){var f=e.shift();b.t=f.t;b.s=f.s;b.d=f.d;if(d.includes(b.s))throw Error("Source object has a circular reference.");d.push(b.s);b.t!==b.s&&(b.d>c?Object.assign(b.t,b.s):(Object.keys(b.s).forEach(function(a){return function(b){var c=a.s[b];if(u.call(a.t,b)){var d=a.t[b];if(l(c)&&l(d)){e.push({t:d,s:c,d:a.d+1});return}}a.t[b]=c}}(b)),b={s:b.s,t:b.t,d:b.d}))}return a};function x(){var a,b;this.promise=new Promise(function(c,d){a=c;b=d});this.resolve=a;this.reject=b};function y(a,b){a=a.__AMP_TOP||a;return A(a,b)}function B(a){a=C(a);a=D(a);return A(a,"viewer")}function E(a,b){a=D(a);var c=F(a,b);if(!c){var d=new x,c=d.promise,d=d.resolve;G(a)[b]={obj:null,promise:c,resolve:d,context:null,ctor:null}}b=c;return b}function C(a){return a.nodeType?y((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function D(a){a=C(a);return a.isSingleDoc()?a.win:a}
function A(a,b){var c=G(a);a=c[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function F(a,b){var c=G(a)[b];if(c){if(c.promise)return c.promise;A(a,b);return c.promise=Promise.resolve(c.obj)}return null}function G(a){var b=a.services;b||(b=a.services={});return b};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function H(a,b){return b.length>a.length?!1:0==a.lastIndexOf(b,0)};var I;function fa(a){var b=C(a),c=F(D(a),"geo");return c?c:b.whenBodyAvailable().then(function(){var a;a=b.win;var c=b.getHeadNode(),f;if(c){f=[];for(var c=c.querySelectorAll("script[custom-element]"),h=0;h<c.length;h++)f.push(c[h].getAttribute("custom-element"))}else f=[];a=f.includes("amp-geo")?y(a,"extensions").waitForExtension(a,"amp-geo"):Promise.resolve();return a}).then(function(){return F(D(a),"geo")})};function J(a){this.la=a;this.U=this.ba=0;this.J=Object.create(null)}J.prototype.has=function(a){return!!this.J[a]};J.prototype.get=function(a){var b=this.J[a];if(b)return b.access=++this.U,b.payload};J.prototype.put=function(a,b){this.has(a)||this.ba++;this.J[a]={payload:b,access:this.U};if(!(this.ba<=this.la)){t().warn("lru-cache","Trimming LRU cache");a=this.J;var c=this.U+1,d,e;for(e in a){var f=a[e].access;f<c&&(c=f,d=e)}void 0!==d&&(delete a[d],this.ba--)}};var K=self.AMP_CONFIG||{},ga={thirdParty:K.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:K.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:("string"==typeof K.thirdPartyFrameRegex?new RegExp(K.thirdPartyFrameRegex):K.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,cdn:K.cdnUrl||"https://cdn.ampproject.org",cdnProxyRegex:("string"==typeof K.cdnProxyRegex?new RegExp(K.cdnProxyRegex):K.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,
errorReporting:K.errorReportingUrl||"https://amp-error-reporting.appspot.com/r",localDev:K.localDev||!1};var ha=w({c:!0,v:!0,a:!0,ad:!0}),L,M,ia=/[?&]amp_js[^&]*/,ja=/[?&]amp_gsa[^&]*/,ka=/[?&]amp_r[^&]*/,la=/[?&]usqp[^&]*/;
function N(a){var b;L||(L=self.document.createElement("a"),M=self.UrlCache||(self.UrlCache=new J(100)));var c=b?null:M,d=L;if(c&&c.has(a))a=c.get(a);else{d.href=a;d.protocol||(d.href=d.href);var e={href:d.href,protocol:d.protocol,host:d.host,hostname:d.hostname,port:"0"==d.port?"":d.port,pathname:d.pathname,search:d.search,hash:d.hash,origin:null};"/"!==e.pathname[0]&&(e.pathname="/"+e.pathname);if("http:"==e.protocol&&80==e.port||"https:"==e.protocol&&443==e.port)e.port="",e.host=e.hostname;e.origin=
d.origin&&"null"!=d.origin?d.origin:"data:"!=e.protocol&&e.host?e.protocol+"//"+e.host:e.href;c&&c.put(a,e);a=e}return a}function ma(a){"string"==typeof a&&(a=N(a));var b;(b="https:"==a.protocol||"localhost"==a.hostname)||(a=a.hostname,b=a.length-10,b=0<=b&&a.indexOf(".localhost",b)==b);return b}
function O(a,b){var c;c=void 0===c?"source":c;r().assert(null!=a,"%s %s must be available",b,c);var d=a;r().assert(ma(d)||/^(\/\/)/.test(d),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',b,c,d);return d}
function na(a){"string"==typeof a&&(a=N(a));var b=a;"string"==typeof b&&(b=N(b));if(!ga.cdnProxyRegex.test(b.origin))return a.href;var b=a.pathname.split("/"),c=b[1];r().assert(ha[c],"Unknown path prefix in url %s",a.href);var d=b[2],e="s"==d?"https://"+decodeURIComponent(b[3]):"http://"+decodeURIComponent(d);r().assert(0<e.indexOf("."),"Expected a . in origin %s",e);b.splice(1,"s"==d?3:2);b=e+b.join("/");c=(c=a.search)&&"?"!=c?(c=c.replace(ia,"").replace(ja,"").replace(ka,"").replace(la,"").replace(/^[?&]/,
""))?"?"+c:"":"";return b+c+(a.hash||"")}function oa(a,b){"string"==typeof b&&(b=N(b));var c;if("function"==typeof URL)c=(new URL(a,b.href)).toString();else{c=a;var d=b;"string"==typeof d&&(d=N(d));c=c.replace(/\\/g,"/");var e=N(c);c=H(c.toLowerCase(),e.protocol)?e.href:H(c,"//")?d.protocol+c:H(c,"/")?d.origin+c:d.origin+d.pathname.replace(/\/[^/]*$/,"/")+c}return c};function pa(a){if(null==I){var b=a.ownerDocument;try{var c=b.createElement("div"),d=b.createElement("div");c.appendChild(d);I=c.querySelector(":scope div")===d}catch(f){I=!1}}I?a=a.querySelectorAll(":scope > script"):(a.classList.add("i-amphtml-scoped"),b=a.querySelectorAll(".i-amphtml-scoped > script"),a.classList.remove("i-amphtml-scoped"),a=b);if(1!==a.length)throw Error("Found "+a.length+" <script> children. Expected 1.");var e=a[0];a=e;if("SCRIPT"!=a.tagName||!a.hasAttribute("type")||"APPLICATION/JSON"!=
a.getAttribute("type").toUpperCase())throw Error('<script> child must have type="application/json"');try{return JSON.parse(e.textContent)}catch(f){throw Error("Failed to parse <script> contents. Is it valid JSON?");}};function P(a,b){var c;if(a.__AMP__EXPERIMENT_TOGGLES)c=a.__AMP__EXPERIMENT_TOGGLES;else{a.__AMP__EXPERIMENT_TOGGLES=Object.create(null);c=a.__AMP__EXPERIMENT_TOGGLES;if(a.AMP_CONFIG)for(var d in a.AMP_CONFIG){var e=a.AMP_CONFIG[d];"number"===typeof e&&0<=e&&1>=e&&(c[d]=Math.random()<e)}if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-doc-opt-in"])&&0<a.AMP_CONFIG["allow-doc-opt-in"].length&&(d=a.AMP_CONFIG["allow-doc-opt-in"],e=a.document.head.querySelector('meta[name="amp-experiments-opt-in"]')))for(var e=
e.getAttribute("content").split(","),f=0;f<e.length;f++)-1!=d.indexOf(e[f])&&(c[e[f]]=!0);Object.assign(c,qa(a));if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-url-opt-in"])&&0<a.AMP_CONFIG["allow-url-opt-in"].length){d=a.AMP_CONFIG["allow-url-opt-in"];e=a.location.originalHash||a.location.hash;a=Object.create(null);if(e)for(var h;h=ba.exec(e);)f=k(h[1],h[1]),h=h[2]?k(h[2],h[2]):"",a[f]=h;for(e=0;e<d.length;e++)f=a["e-"+d[e]],"1"==f&&(c[d[e]]=!0),"0"==f&&(c[d[e]]=!1)}}var p=c;return!!p[b]}
function qa(a){a:{var b;try{b=a.document.cookie}catch(h){b=""}if(a=b)for(a=a.split(";"),b=0;b<a.length;b++){var c=a[b].trim(),d=c.indexOf("=");if(-1!=d&&"AMP_EXP"==k(c.substring(0,d).trim(),void 0)){a=c.substring(d+1).trim();a=k(a,a);break a}}a=null}var e=a,f=e?e.split(/\s*,\s*/g):[];a=Object.create(null);for(b=0;b<f.length;b++)0!=f[b].length&&("-"==f[b][0]?a[f[b].substr(1)]=!1:a[f[b]]=!0);return a};var Q,R="Webkit webkit Moz moz ms O o".split(" ");function S(a){var b=void 0;if(H("display","--"))return"display";Q||(Q=v());var c=Q.display;if(!c||b){c="display";if(void 0===a.display){var d;a:{for(d=0;d<R.length;d++){var e=R[d]+"Display";if(void 0!==a[e]){d=e;break a}}d=""}var f=d;void 0!==a[f]&&(c=f)}b||(Q.display=c)}return c}function T(a,b){if(void 0===b){var c;c=(c=S(a.style))?a.style[c]:void 0;b="none"==c}c=b?"":"none";var d=S(a.style);d&&(a.style[d]=c)};function U(){this.o=null}g=U.prototype;g.add=function(a){var b=this;this.o||(this.o=[]);this.o.push(a);return function(){b.remove(a)}};g.remove=function(a){this.o&&(a=this.o.indexOf(a),-1<a&&this.o.splice(a,1))};g.removeAll=function(){this.o&&(this.o.length=0)};g.fire=function(a){if(this.o)for(var b=this.o,c=0;c<b.length;c++)(0,b[c])(a)};g.getHandlerCount=function(){return this.o?this.o.length:0};function V(){this.F=0;this.ha=Promise.resolve();this.fa=function(){};this.ga=function(){}}V.prototype.onQueueEmpty=function(a){this.fa=a;0==this.F&&a()};V.prototype.onQueueNotEmpty=function(a){this.ga=a;0<this.F&&a()};V.prototype.registerUI=function(a){var b=this;0==this.F&&this.ga();this.F++;var c=this.ha.then(function(){return a().then(function(){b.F--;0==b.F&&b.fa()})});return this.ha=c};var ra={};var sa={ACCEPTED:1,REJECTED:2,DISMISSED:3,NOT_REQUIRED:4,UNKNOWN:5};function ta(a){this.A=a;this.h={};this.K={};this.M={};this.L={}}g=ta.prototype;g.registerConsentInstance=function(a,b){this.h[a]?t().error("CONSENT-STATE-MANAGER","instance "+a+" already registered"):(this.h[a]=new W(this.A,a,b),this.K[a]=new U,this.M[a]&&(this.M[a](),this.L[a]=null,this.M[a]=null))};
g.updateConsentInstanceState=function(a,b){this.h[a]&&this.K[a]?(this.K[a].fire(b),this.h[a].update(b)):t().error("CONSENT-STATE-MANAGER","instance "+a+" not registered")};g.getConsentInstanceState=function(a){return this.h[a].get()};g.onConsentStateChange=function(a,b){var c=this.K[a].add(b);this.getConsentInstanceState(a).then(function(a){b(a)});return c};g.setConsentInstanceSharedData=function(a,b){this.h[a].sharedDataPromise=b};g.getConsentInstanceSharedData=function(a){return this.h[a].sharedDataPromise};
g.whenConsentReady=function(a){if(this.h[a])return Promise.resolve();if(!this.L[a]){var b=new x;this.L[a]=b.promise;this.M[a]=b.resolve}return this.L[a]};function W(a,b,c){this.A=a;this.na=b;this.sharedDataPromise=null;this.ja=E(a,"storage");this.m=null;this.ia="amp-consent:"+b;(this.O=c.onUpdateHref||null)&&O(this.O,"AMP-CONSENT")}
W.prototype.update=function(a){var b=this;m(sa,a)||(a=5);if(3==a)this.m=this.m||5;else if(4==a)this.m&&5!=this.m||(this.m=4);else if(a!==this.m&&(this.m=a,5!=a)){var c=1==a;this.ja.then(function(d){a==b.m&&(d.set(b.ia,c),ua(b,c))})}};
W.prototype.get=function(){var a=this;return this.m?Promise.resolve(this.m):this.ja.then(function(b){return b.get(a.ia)}).then(function(b){if(a.m)return a.m;a.m=void 0===b?5:b?1:2;return a.m}).catch(function(a){t().error("CONSENT-STATE-MANAGER","Failed to read storage",a);return 5})};
function ua(a,b){if(a.O){var c=E(a.A,"cid").then(function(a){return a.get({scope:"AMP-CONSENT",createCookieIfNotPresent:!0},Promise.resolve())});c.then(function(c){var d={credentials:"include",method:"POST",body:{consentInstanceId:a.na,ampUserId:c,consentState:b},ampCors:!1};B(a.A).whenFirstVisible().then(function(){y(a.A.win,"xhr").fetchJson(a.O,d)})})}};var va={"default":!0,_till_responded:!0,_till_accepted:!0,_auto_reject:!0};function wa(a){this.A=a;this.R=v();this.P=v();this.h=v();this.da=E(this.A,"consentStateManager");a=new x;this.ka=a.promise;this.V=a.resolve}function X(a){return P(a,"multi-consent")}g=wa.prototype;
g.registerConsentPolicyInstance=function(a,b){var c=this;this.h[a]&&t().error("consent-policy-manager","policy "+a+" already registered");var d=Object.keys(b.waitFor||{}),e=new xa(b);this.h[a]=e;this.P[a]&&(this.P[a](),this.P[a]=null,this.R[a]=null);var f=[];this.da.then(function(a){for(var b={},h=0;h<d.length;b={consentId:b.consentId,resolver:b.resolver},h++){b.consentId=d[h];var z=new x,Ca=z.promise;b.resolver=z.resolve;a.whenConsentReady(b.consentId).then(function(b){return function(){a.onConsentStateChange(b.consentId,
function(a){b.resolver&&(b.resolver(),b.resolver=null);e.consentStateChangeHandler(b.consentId,a)})}}(b));f.push(Ca)}c.ka.then(function(){Promise.all(f).then(function(){e.startTimeout(c.A.win)})})})};g.enableTimeout=function(){this.V&&this.V();this.V=null};
g.whenPolicyResolved=function(a){var b=this;return X(this.A.win)||va[a]?ya(this,a).then(function(){return b.h[a].getReadyPromise().then(function(){return b.h[a].getCurrentPolicyStatus()})}):(r().error("consent-policy-manager","can not find defined policy "+a+", only supported predefined policy supported now"),Promise.resolve(4))};
g.whenPolicyUnblock=function(a){var b=this;return X(this.A.win)||va[a]?ya(this,a).then(function(){return b.h[a].getReadyPromise().then(function(){return b.h[a].shouldBlock()})}):(r().error("consent-policy-manager","can not find defined policy "+a+", only supported predefined policy supported now"),Promise.resolve(!1))};
g.getMergedSharedData=function(a){var b=this;return this.whenPolicyResolved(a).then(function(){return b.da}).then(function(c){var d=b.h[a].getConsentInstanceIds().map(function(a){return c.getConsentInstanceSharedData(a)});return Promise.all(d)}).then(function(a){a.unshift({});return Object.assign.apply(null,a)})};function ya(a,b){if(a.h[b])return Promise.resolve();if(!a.R[b]){var c=new x;a.R[b]=c.promise;a.P[b]=c.resolve}return a.R[b]}
function xa(a){var b=Object.keys(a.waitFor||{});this.ma=a;this.l=v();var c=new x;this.oa=c.promise;this.aa=c.resolve;this.ca=4;this.qa=a.unblockOn||[1,3];this.Y(b)}g=xa.prototype;g.Y=function(a){for(var b=0;b<a.length;b++)this.l[a[b]]=null};g.getConsentInstanceIds=function(){return Object.keys(this.l)};
g.startTimeout=function(a){var b=this,c=this.ma.timeout,d=null,e;void 0!=c&&(l(c)?(c.fallbackAction&&"reject"==c.fallbackAction?e=2:c.fallbackAction&&"dismiss"!=c.fallbackAction&&r().error("consent-policy-manager","unsupported fallbackAction "+c.fallbackAction),d=c.seconds):d=c,r().assert(da(d),"invalid timeout value "+d));null!=d&&a.setTimeout(function(){za(b,!0,e)},1E3*d)};
g.consentStateChangeHandler=function(a,b){if(!u.call(this.l,a))t().error("consent-policy-manager","cannot find "+a+" in policy state");else if(5!=b){if(4==b){var c=1!=this.l[a]&&2!=this.l[a];c&&(this.l[a]=4)}else 3==b?null===this.l[a]&&(this.l[a]=5):this.l[a]=b;za(this)}};
function za(a,b,c){b=void 0===b?!1:b;for(var d=!0,e=!0,f=!1,h=Object.keys(a.l),p=0;p<h.length;p++){var q=h[p];if(null===a.l[q])if(b)a.l[q]=c||5;else return;4==a.l[q]&&(d=!1);2==a.l[q]&&(e=d=!1);5==a.l[q]&&(e=d=!1,f=!0)}a.ca=d?1:e?3:f?4:2;a.aa&&(a.aa(),a.aa=null)}g.getReadyPromise=function(){return this.oa};g.getCurrentPolicyStatus=function(){return this.ca};g.shouldBlock=function(){return-1<this.qa.indexOf(this.ca)};var Aa={ACCEPT:"accept",REJECT:"reject",DISMISS:"dismiss"};function Y(a){a=AMP.BaseElement.call(this,a)||this;a.C=null;a.W=null;a.H=null;a.G=v();a.w={};a.B={};a.ea=v();a.S=!1;a.j=null;a.D=null;a.N=v();a.X=v();a.Z=!1;a.T=a.getVsync();a.$=!1;a.I=v();return a}aa(Y,AMP.BaseElement);Y.prototype.getConsentPolicy=function(){return null};
Y.prototype.buildCallback=function(){var a=this;this.Z=X(this.win);r().assert(this.element.getAttribute("id"),"amp-consent should have an id");var b;try{b=pa(this.element)}catch(z){throw this.user().createError("amp-consent",z);}var c=b,d=Ba(this);b=ea(d||{},c||{});Da(this,b);b=this.getRealChildren();for(var e=0;e<b.length;e++){var f=b[e];T(f,!1);this.setAsOwner(f)}var h=E(this.getAmpDoc(),"consentPolicyManager").then(function(b){a.W=b;var c=Object.keys(a.w);b={};for(var d=0;d<c.length;d++)b[c[d]]=
void 0;var c={waitFor:b},d=[4,1,2,3],e={waitFor:b,timeout:{seconds:0,fallbackAction:"reject"},unblockOn:d};a.B._till_responded={waitFor:b,unblockOn:d};a.B._till_accepted=c;a.B._auto_reject=e;a.B&&a.B["default"]||(a.B["default"]=c);var f=Object.keys(a.B);for(b=0;b<f.length;b++)a.W.registerConsentPolicyInstance(f[b],a.B[f[b]])}),p=E(this.getAmpDoc(),"consentStateManager").then(function(b){a.C=b}),q=E(this.getAmpDoc(),"notificationUIManager").then(function(b){a.H=b});Promise.all([p,q,h]).then(function(){a.Y()})};
function Ea(a){a.registerAction("accept",function(){return Z(a,"accept")});a.registerAction("reject",function(){return Z(a,"reject")});a.registerAction("dismiss",function(){return Z(a,"dismiss")});a.registerAction("prompt",function(b){var c=b.args,d=c&&c.consent;a.Z||(d=Object.keys(a.w)[0]);d=d||"";r().assert(a.w[d],"consent with id "+d+" not found");Fa(a,d)});Ga(a)}
function Ga(a){a.win.addEventListener("message",function(b){if(a.j){var c=b.data;if(c&&"consent-response"==c.type)if(c.action)for(var d=a.element.querySelectorAll("iframe"),e=0;e<d.length;e++){if(d[e].contentWindow===b.source){var f=c.action;Z(a,f);break}}else r().error("amp-consent","consent-response message missing required info")}})}function Fa(a,b){a.H||t().error("amp-consent","notification ui manager not found");!a.X[b]&&a.G[b]&&(a.X[b]=!0,a.H.registerUI(a.pa.bind(a,b)))}
Y.prototype.pa=function(a){var b=this;this.j&&t().error("amp-consent","other consent instance on display "+this.j);this.T.mutate(function(){b.S||(b.S=!0,T(b.element,!0));b.element.classList.remove("amp-hidden");b.element.classList.add("amp-active");b.getViewport().addToFixedLayer(b.element);b.j=a;var c=b.G[b.j];T(c,!0);if("IFRAME"==c.tagName){var e=b.element;e.insertBefore(c,e.firstChild)}else b.scheduleLayout(c)});var c=new x;this.N[a]=c.resolve;return c.promise};
function Ha(a){var b=a.j&&a.G[a.j];a.T.mutate(function(){a.element.classList.add("amp-hidden");a.element.classList.remove("amp-active");a.getViewport().removeFromFixedLayer(a.element);b||t().error("amp-consent",a.j+" no consent ui to hide");T(b,!1);if("IFRAME"==b.tagName){var c=b;c.parentElement&&c.parentElement.removeChild(c)}});var c=a.j;a.N[c]&&(a.N[c](),a.N[c]=null);a.X[c]=!1;a.j=null}
function Z(a,b){m(Aa,b)&&a.j&&(a.C?("accept"==b?a.C.updateConsentInstanceState(a.j,1):"reject"==b?a.C.updateConsentInstanceState(a.j,2):"dismiss"==b&&a.C.updateConsentInstanceState(a.j,3),Ha(a)):t().error("amp-consent","No consent state manager"))}
Y.prototype.Y=function(){for(var a=this,b=Object.keys(this.w),c=[],d={},e=0;e<b.length;d={instanceId:d.instanceId},e++){d.instanceId=b[e];this.C.registerConsentInstance(d.instanceId,this.w[d.instanceId]);Ia(this,d.instanceId);var f=Ja(this,d.instanceId,this.w[d.instanceId]),h=f.then(function(b){return function(){return Ka(a,b.instanceId)}}(d)).catch(function(){});c.push(h)}Promise.all(c).then(function(){La(a);a.W.enableTimeout()});Ea(this)};
function Ja(a,b,c){r().assert(c.checkConsentHref||c.promptIfUnknownForGeoGroup,"neither checkConsentHref nor promptIfUnknownForGeoGroup is defined");var d=null;if(c.promptIfUnknownForGeoGroup)var e=c.promptIfUnknownForGeoGroup,d=Ma(a,e);else d=Na(a,b).then(function(b){return b&&b.promptIfUnknown?!!b.promptIfUnknown:(a.user().error("amp-consent","Expecting promptIfUnknown from checkConsentHref when promptIfUnknownForGeoGroup is not specified"),!1)});return d.then(function(c){a.ea[b]=!!c})}
function Ia(a,b){var c=Na(a,b),d=c.then(function(a){return a&&void 0!==a.sharedData?a.sharedData:null});a.C.setConsentInstanceSharedData(b,d)}function Ma(a,b){return fa(a.element).then(function(a){r().assert(a,"requires <amp-geo> to use promptIfUnknownForGeoGroup");return 0<=a.ISOCountryGroups.indexOf(b)})}
function Na(a,b){if(a.I[b])return a.I[b];if(a.w[b].checkConsentHref){var c={credentials:"include",method:"POST",body:{consentInstanceId:b},requireAmpResponseSourceOrigin:!1},d=a.w[b].checkConsentHref;O(d,a.element);var e=a.getAmpDoc(),f=na(e.getUrl()),h=oa(d,f),p=B(e);a.I[b]=p.whenFirstVisible().then(function(){return y(a.win,"xhr").fetchJson(h,c).then(function(a){return a.json()})})}else a.I[b]=Promise.resolve(null);return a.I[b]}
function Da(a,b){var c=b.consents;r().assert(c,"amp-consent: consents config is required");r().assert(0!=Object.keys(c).length,"amp-consent: can't find consent instance");if(!a.Z&&(r().assert(1>=Object.keys(c).length,"amp-consent: only single consent instance is supported"),b.policy))for(var d=Object.keys(b.policy),e=0;e<d.length;e++)"default"!=d[e]&&(r().warn("amp-consent","policy "+d[e]+" is currently not supportedand will be ignored"),delete b.policy[d[e]]);a.w=c;if(b.postPromptUI){var f=b.postPromptUI;
a.D=a.getAmpDoc().getElementById(f);a.D||a.user().error("amp-consent","postPromptUI element with "+("id="+f+" not found"))}a.B=b.policy||a.B}
function Ba(a){if(!P(a.win,"amp-consent-v2"))return null;a=a.element.getAttribute("type");if(!a)return null;r().assert(ra[a],"invalid CMP type "+a);var b=ra[a];a=["consentInstanceId","checkConsentHref","promptUISrc"];for(var c=0;c<a.length;c++);var d=b.consentInstanceId;a=w({consents:w({})});c=Object.assign({},b);delete c.consentInstanceId;a.consents[d]=c;return a}
function Ka(a,b){var c=a.w[b].promptUI,d=a.w[b].promptUISrc;if(c){var e=a.getAmpDoc().getElementById(c);e&&a.element.contains(e)||(e=null,a.user().error("amp-consent","child element of <amp-consent> with "+("promptUI id "+c+" not found")));a.G[b]=e}else d&&P(a.win,"amp-consent-v2")&&(a.G[b]=Oa(a,d));return a.C.getConsentInstanceState(b).then(function(c){if(1==c||2==c)a.$=!0;5==c&&(a.ea[b]?(a.$=!0,Fa(a,b)):a.C.updateConsentInstanceState(b,4))})}
function Oa(a,b){var c=a.element.ownerDocument.createElement("iframe");c.src=O(b,a.element);c.setAttribute("sandbox","allow-scripts");return c}
function La(a){if(a.$){var b=a.element.classList;a.H.onQueueEmpty(function(){a.D&&a.T.mutate(function(){a.S||(a.S=!0,T(a.element,!0));b.add("amp-active");b.remove("amp-hidden");a.getViewport().addToFixedLayer(a.element);T(a.D,!0)})});a.H.onQueueNotEmpty(function(){a.D&&a.T.mutate(function(){a.j||(b.add("amp-hidden"),b.remove("amp-active"));a.getViewport().removeFromFixedLayer(a.element);T(a.D,!1)})})}}
(function(a){a.registerElement("amp-consent",Y,"amp-consent{position:fixed;bottom:0;left:0;overflow:hidden!important;background:hsla(0,0%,100%,0.7);z-index:1000;width:100%}amp-consent[i-amphtml-notbuilt]>*{display:none!important}amp-consent>*{max-height:100vh!important}amp-consent.amp-active{visibility:visible}amp-consent.amp-hidden{visibility:hidden}\n/*# sourceURL=/extensions/amp-consent/0.1/amp-consent.css*/");a.registerServiceForDoc("notificationUIManager",V);a.registerServiceForDoc("consentStateManager",
ta);a.registerServiceForDoc("consentPolicyManager",wa)})(self.AMP);
})});
//# sourceMappingURL=amp-consent-0.1.js.map

