(self.AMP=self.AMP||[]).push({n:"amp-ad-network-doubleclick-impl",v:"0",f:(function(AMP,_){
var g;function aa(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]}(function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a})(this);function ba(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(c){return b}};var ca=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function q(a){var b=Object.create(null);if(!a)return b;for(var c;c=ca.exec(a);){var d=ba(c[1],c[1]),e=c[2]?ba(c[2],c[2]):"";b[d]=e}return b};var da="";
function r(a){var b=a||self,c;if(b.AMP_MODE)c=b.AMP_MODE;else{c=b;var d=!!(self.AMP_CONFIG||{}).test||!1,e=q(c.location.originalHash||c.location.hash),f=q(c.location.search);da||(da=c.AMP_CONFIG&&c.AMP_CONFIG.v?c.AMP_CONFIG.v:"010");c=b.AMP_MODE={localDev:!1,development:!("1"!=e.development&&!c.AMP_DEV_MODE),examiner:"2"==e.development,filter:e.filter,geoOverride:e["amp-geo"],minified:!0,lite:void 0!=f.amp_lite,test:d,log:e.log,version:"0",rtvVersion:da}}return c};var ea=Object.prototype.toString;function v(a){return"[object Object]"===ea.call(a)}function fa(a){return"number"===typeof a&&isFinite(a)};function ha(a){var b=a.message,c=String(Math.random());a.message=c;if(a.message===c)return a.message=b,a;var b=Error(a.message),d;for(d in a)b[d]=a[d];b.stack=a.stack;return b}function ia(a){for(var b=null,c="",d=0;d<arguments.length;d++){var e=arguments[d];e instanceof Error&&!b?b=ha(e):(c&&(c+=" "),c+=e)}b?c&&(b.message=c+": "+b.message):b=Error(c);return b}function x(a){var b=ia.apply(null,arguments);setTimeout(function(){self.reportError(b);throw b;})}self.log=self.log||{user:null,dev:null,userForEmbed:null};
var ja=self.log;function z(){if(!ja.user)throw Error("failed to call initLogConstructor");return ja.user}function B(){if(ja.dev)return ja.dev;throw Error("failed to call initLogConstructor");};var C=Object.prototype.hasOwnProperty;function ka(){var a,b=Object.create(null);a&&Object.assign(b,a);return b}function D(a){return a||{}}
function la(a,b){var c;c=void 0===c?10:c;var d=[],e=[];e.push({t:a,s:b,d:0});for(b={};0<e.length;){var f=e.shift();b.t=f.t;b.s=f.s;b.d=f.d;if(d.includes(b.s))throw Error("Source object has a circular reference.");d.push(b.s);b.t!==b.s&&(b.d>c?Object.assign(b.t,b.s):(Object.keys(b.s).forEach(function(a){return function(b){var c=a.s[b];if(C.call(a.t,b)){var d=a.t[b];if(v(c)&&v(d)){e.push({t:d,s:c,d:a.d+1});return}}a.t[b]=c}}(b)),b={s:b.s,t:b.t,d:b.d}))}return a};function E(){var a,b;this.promise=new Promise(function(c,d){a=c;b=d});this.resolve=a;this.reject=b}function ma(a){return new Promise(function(b){b(a())})};function F(a,b){if(a.nodeType){var c=na((a.ownerDocument||a).defaultView,b);if(c)return c}return G(a,b)}function oa(a,b){var c=pa(a);na(a,"url-replace");qa(a,a,function(){return b});H(a,"url-replace")}function na(a,b){var c=pa(a);return a!=c&&ra(a,b)?H(a,b):null}function I(a,b){a=pa(a);return H(a,b)}function G(a,b){a=sa(a);a=ta(a);return H(a,b)}function wa(a,b){return xa(ta(a),b)}function pa(a){return a.__AMP_TOP||a}
function sa(a){return a.nodeType?I((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function ta(a){a=sa(a);return a.isSingleDoc()?a.win:a}function H(a,b){ra(a,b);var c=ya(a);a=c[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function qa(a,b,c){var d=ya(a),e=d["url-replace"];e||(e=d["url-replace"]={obj:null,promise:null,resolve:null,context:null,ctor:null});e.ctor||e.obj||(e.ctor=c,e.context=b,e.resolve&&H(a,"url-replace"))}
function za(a,b){var c=xa(a,b);if(c)return c;var d=new E,e=d,f=e.promise,e=e.resolve;ya(a)[b]={obj:null,promise:f,resolve:e,context:null,ctor:null};return f}function xa(a,b){var c=ya(a)[b];if(c){if(c.promise)return c.promise;H(a,b);return c.promise=Promise.resolve(c.obj)}return null}function ya(a){var b=a.services;b||(b=a.services={});return b}
function Aa(a){a=ya(a);var b={},c;for(c in a)if(b.id=c,Object.prototype.hasOwnProperty.call(a,b.id)){var d=a[b.id];d.obj?Ba(b.id,d.obj):d.promise&&d.promise.then(function(a){return function(b){return Ba(a.id,b)}}(b));b={id:b.id}}}function Ba(a,b){if("function"==typeof b.dispose)try{b.dispose()}catch(c){B().error("SERVICE","failed to dispose service",a,c)}}function ra(a,b){a=a.services&&a.services[b];return!(!a||!a.ctor&&!a.obj)};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function Ca(a,b){return b.length>a.length?!1:0==a.lastIndexOf(b,0)}function Da(a){for(var b=a.length,c=5381,d=0;d<b;d++)c=33*c^a.charCodeAt(d);return String(c>>>0)};var Ea={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Fa=/(&|<|>|"|'|`)/g;function J(a,b,c){a=a.createElement(b);for(var d in c)a.setAttribute(d,c[d]);return a}function Ga(a,b){for(var c,d=a;d&&d!==c;d=d.parentElement)if(b(d))return d;return null}function Ha(a){var b="A";if(a.closest)return a.closest(b);b=b.toUpperCase();return Ga(a,function(a){return a.tagName==b})}function Ia(a){return a?a.replace(Fa,Ja):a}function Ja(a){return Ea[a]};function Ka(a,b,c){var d=sa(a),e=wa(a,b);return e?e:d.whenBodyAvailable().then(function(){var a;a=d.win;var b=d.getHeadNode(),e;if(b){e=[];for(var b=b.querySelectorAll("script[custom-element]"),l=0;l<b.length;l++)e.push(b[l].getAttribute("custom-element"))}else e=[];a=e.includes(c)?I(a,"extensions").waitForExtension(a,c):Promise.resolve();return a}).then(function(){var e=d.win;return e.ampExtendedElements&&e.ampExtendedElements[c]?za(ta(a),b):null})};function La(a){return Ka(a,"amp-analytics-instrumentation","amp-analytics")}function K(a){a=sa(a);a=ta(a);return H(a,"documentInfo").get()}function Ma(a){return I(a,"extensions")}function Na(a){return G(a,"resources")}function L(a){return I(a,"timer")}function Oa(a){return F(a,"url-replace")}function M(a){return G(a,"viewer")};function Pa(a){this.bb=a;this.xa=this.Fa=0;this.pa=Object.create(null)}Pa.prototype.has=function(a){return!!this.pa[a]};Pa.prototype.get=function(a){var b=this.pa[a];if(b)return b.access=++this.xa,b.payload};Pa.prototype.put=function(a,b){this.has(a)||this.Fa++;this.pa[a]={payload:b,access:this.xa};if(!(this.Fa<=this.bb)){B().warn("lru-cache","Trimming LRU cache");a=this.pa;var c=this.xa+1,d,e;for(e in a){var f=a[e].access;f<c&&(c=f,d=e)}void 0!==d&&(delete a[d],this.Fa--)}};var N=self.AMP_CONFIG||{},Qa={thirdParty:N.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:N.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:("string"==typeof N.thirdPartyFrameRegex?new RegExp(N.thirdPartyFrameRegex):N.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,cdn:N.cdnUrl||"https://cdn.ampproject.org",cdnProxyRegex:("string"==typeof N.cdnProxyRegex?new RegExp(N.cdnProxyRegex):N.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,
errorReporting:N.errorReportingUrl||"https://amp-error-reporting.appspot.com/r",localDev:N.localDev||!1};D({c:!0,v:!0,a:!0,ad:!0});var Ra,Sa,Ta=["javascript:","data:","vbscript:"];
function O(a,b){Ra||(Ra=self.document.createElement("a"),Sa=self.UrlCache||(self.UrlCache=new Pa(100)));var c=b?null:Sa,d=Ra;if(c&&c.has(a))a=c.get(a);else{d.href=a;d.protocol||(d.href=d.href);var e={href:d.href,protocol:d.protocol,host:d.host,hostname:d.hostname,port:"0"==d.port?"":d.port,pathname:d.pathname,search:d.search,hash:d.hash,origin:null};"/"!==e.pathname[0]&&(e.pathname="/"+e.pathname);if("http:"==e.protocol&&80==e.port||"https:"==e.protocol&&443==e.port)e.port="",e.host=e.hostname;e.origin=
d.origin&&"null"!=d.origin?d.origin:"data:"!=e.protocol&&e.host?e.protocol+"//"+e.host:e.href;c&&c.put(a,e);a=e}return a}function Ua(a,b){var c;if(!b)return a;var d=a.split("#",2),e=d[0].split("?",2),f=e[0]+(e[1]?c?"?"+b+"&"+e[1]:"?"+e[1]+"&"+b:"?"+b);return f+=d[1]?"#"+d[1]:""}
function Va(a){var b=[],c;for(c in a){var d=a[c];if(null!=d)if(Array.isArray(d))for(var e=0;e<d.length;e++){var f=d[e];b.push(encodeURIComponent(c)+"="+encodeURIComponent(f))}else b.push(encodeURIComponent(c)+"="+encodeURIComponent(d))}return b.join("&")}function Wa(a){"string"==typeof a&&(a=O(a));var b;(b="https:"==a.protocol||"localhost"==a.hostname)||(a=a.hostname,b=a.length-10,b=0<=b&&a.indexOf(".localhost",b)==b);return b}
function Xa(a,b){var c;c=void 0===c?"source":c;z().assert(null!=a,"%s %s must be available",b,c);var d=a;z().assert(Wa(d)||/^(\/\/)/.test(d),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',b,c,d)}function Za(a){if(!a)return!0;"string"==typeof a&&(a=O(a));return!Ta.includes(a.protocol)};var $a={SUFFICIENT:1,INSUFFICIENT:2,UNKNOWN_NOT_REQUIRED:3,UNKNOWN:4};function ab(a){for(var b=[],c=0;a&&1==a.nodeType&&25>c;){var d="";a.id&&(d="/"+a.id);var e=a.nodeName.toLowerCase();b.push(""+e+d+bb(a));c++;a=a.parentElement}return b.join()}function bb(a){for(var b=a.nodeName,c=0,d=0,e=a.previousElementSibling;e&&25>d&&100>c;)e.nodeName==b&&d++,c++,e=e.previousElementSibling;return 25>d&&100>c?"."+d:""};function cb(a){var b=16374,c=db,d=[],e=c&&null!=c.value&&""!==c.value?encodeURIComponent(c.name)+"="+encodeURIComponent(String(c.value)):null,f=b-49;e&&(f-=e.length+1);for(var h=Object.keys(a),k=0;k<h.length;k++){var l=h[k],m=a[l];if(null!=m&&""!==m){var n=encodeURIComponent(l)+"=",p=encodeURIComponent(String(m)),t=n.length+p.length+1;if(t>f){var w=p.substr(0,f-n.length-1).replace(/%\w?$/,"");w&&d.push(n+w);e&&d.push(e);break}d.push(n+p);f-=t}}return d.length?"https://securepubads.g.doubleclick.net/gampad/ads?"+
d.join("&"):"https://securepubads.g.doubleclick.net/gampad/ads"};function eb(a,b){return Ka(a,"consentPolicyManager","amp-consent").then(function(a){return a?a.whenPolicyResolved(b):null})};function fb(a,b){var c="AMP_ECID_GOOGLE",d="_ga",e=isNaN(b)||null==b?1E3:b,f=za(ta(a),"cid").then(function(a){if(a)return a.get({scope:c,createCookieIfNotPresent:!0,cookieName:d},Promise.resolve(void 0)).catch(function(a){B().error("AD-CID",a)})});return L(a.win).timeoutPromise(e,f,"cid timeout").catch(function(a){B().warn("AD-CID",a)})};var gb;function hb(a,b,c){var d=void 0,e=a,f=c,h;h=function(a){try{return f(a)}catch(n){throw self.reportError(n),n;}};var k=ib(),l=!1;d&&(l=d.capture);e.addEventListener(b,h,k?d:l);return function(){e&&e.removeEventListener(b,h,k?d:l);h=e=f=null}}function ib(){if(void 0!==gb)return gb;gb=!1;try{var a={get capture(){gb=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(b){}return gb};function jb(a,b,c){var d=c,e=hb(a,b,function(a){try{d(a)}finally{d=null,e()}});return e}function kb(a){var b,c;if(a.complete||"complete"==a.readyState||a.document&&"complete"==a.document.readyState)return Promise.resolve(a);var d=new Promise(function(d,f){var e=a.tagName;b="AUDIO"===e||"VIDEO"===e?jb(a,"loadstart",d):jb(a,"load",d);e&&(c=jb(a,"error",f))});return d.then(function(){c&&c();return a},function(){b&&b();var c=a;c&&c.src&&(c=c.src);throw z().createError("Failed to load:",c);})};function lb(a,b,c){return kb(a).then(function(){return mb(a,b,c)})}function mb(a,b,c){var d=a.performance&&a.performance.timing;if(d&&0!=d.navigationStart){var e=void 0===c?d[b]:d[c]-d[b];if(fa(e)&&!(0>e))return e}}function nb(a,b){var c=a.performance&&a.performance.navigation;if(c&&void 0!==c[b])return c[b]}function ob(a){this.ampdoc=a;this.ia=this.ja=void 0;this.F=Object.create(null);this.ta=!1;pb(this)}g=ob.prototype;g.initialize=function(){};
g.get=function(a){this.ta||(this.initialize(),this.ta=!0);return this.F[a]};g.set=function(a,b){this.F[a]=this.F[a]||{sync:void 0,async:void 0};this.F[a].sync=b;this.ia=this.ja=void 0;return this};g.setAsync=function(a,b){this.F[a]=this.F[a]||{sync:void 0,async:void 0};this.F[a].async=b;this.ia=this.ja=void 0;return this};g.setBoth=function(a,b,c){return this.set(a,b).setAsync(a,c)};
g.getExpr=function(a,b,c){var d=this;this.ta||(this.initialize(),this.ta=!0);var e=a?Object.keys(a):null;if(e&&0<e.length){var f=Object.keys(this.F);e.forEach(function(a){void 0===d.F[a]&&f.push(a)});return qb(this,f,b,c)}this.ja||b||(this.ja=qb(this,Object.keys(this.F)));!this.ia&&b&&(this.ia=qb(this,Object.keys(this.F),b,c));return b?this.ia:this.ja};
function qb(a,b,c,d){pb(a)&&(b=b.filter(function(b){return pb(a).includes(b)}));d&&(b=b.filter(function(a){return d[a]}));if(0===b.length){var e=/_^/g;return e}b.sort(function(a,b){return b.length-a.length});var f=b.map(function(a){return"$"===a[0]?"\\"+a:a}).join("|"),h="\\$?("+f+")";c||(h+="(?:\\(((?:\\s*[0-9a-zA-Z-_.]*\\s*(?=,|\\)),?)*)\\s*\\))?");return new RegExp(h,"g")}
function pb(a){if(a.Ka)return a.Ka;var b=a.ampdoc.getRootNode().head;if(!b)return null;var c=b.querySelector('meta[name="amp-allowed-url-macros"]');if(!c)return null;a.Ka=c.getAttribute("content").split(",").map(function(a){return a.trim()});return a.Ka};function P(a){var b;try{return JSON.parse(a)}catch(c){b&&b(c)}};function rb(a){return a.AMP_CONFIG&&a.AMP_CONFIG.type?a.AMP_CONFIG.type:"unknown"}function S(a,b){var c=sb(a);return!!c[b]}
function sb(a){if(a.__AMP__EXPERIMENT_TOGGLES)return a.__AMP__EXPERIMENT_TOGGLES;a.__AMP__EXPERIMENT_TOGGLES=Object.create(null);var b=a.__AMP__EXPERIMENT_TOGGLES;if(a.AMP_CONFIG)for(var c in a.AMP_CONFIG){var d=a.AMP_CONFIG[c];"number"===typeof d&&0<=d&&1>=d&&(b[c]=Math.random()<d)}if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-doc-opt-in"])&&0<a.AMP_CONFIG["allow-doc-opt-in"].length){var e=a.AMP_CONFIG["allow-doc-opt-in"];if(c=a.document.head.querySelector('meta[name="amp-experiments-opt-in"]')){var f=
c.getAttribute("content").split(",");for(c=0;c<f.length;c++)-1!=e.indexOf(f[c])&&(b[f[c]]=!0)}}Object.assign(b,tb(a));if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-url-opt-in"])&&0<a.AMP_CONFIG["allow-url-opt-in"].length){c=a.AMP_CONFIG["allow-url-opt-in"];a=q(a.location.originalHash||a.location.hash);for(var h=0;h<c.length;h++){var k=a["e-"+c[h]];"1"==k&&(b[c[h]]=!0);"0"==k&&(b[c[h]]=!1)}}return b}
function tb(a){a:{var b;try{b=a.document.cookie}catch(h){b=""}if(a=b)for(a=a.split(";"),b=0;b<a.length;b++){var c=a[b].trim(),d=c.indexOf("=");if(-1!=d&&"AMP_EXP"==ba(c.substring(0,d).trim(),void 0)){a=c.substring(d+1).trim();a=ba(a,a);break a}}a=null}var e=a,f=e?e.split(/\s*,\s*/g):[];a=Object.create(null);for(b=0;b<f.length;b++)0!=f[b].length&&("-"==f[b][0]?a[f[b].substr(1)]=!1:a[f[b]]=!0);return a}
function ub(a,b){a.experimentBranches=a.experimentBranches||{};var c={},d;for(d in b)if(C.call(b,d))if(C.call(a.experimentBranches,d))c[d]=a.experimentBranches[d];else if(!b[d].isTrafficEligible||!b[d].isTrafficEligible(a))a.experimentBranches[d]=null;else if(!a.experimentBranches[d]&&S(a,d)){var e=b[d].branches,f=e;a.experimentBranches[d]=f[Math.floor(Math.random()*f.length)]||null;c[d]=a.experimentBranches[d]}return c};var vb={"AMP-CAROUSEL":"ac","AMP-FX-FLYING-CARPET":"fc","AMP-LIGHTBOX":"lb","AMP-STICKY-AD":"sa"},wb={visible:"1",hidden:"2",prerender:"3",unloaded:"5"},db={name:"trunc",value:"1"},xb=/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org((\/.*)|($))+/;function yb(a){var b=a.element.getAttribute("type"),c=a.win;return("doubleclick"==b||"adsense"==b)&&S(c,"a4aProfilingRate")}
function zb(a,b){for(var c=a,d=c.element,c=c.win,e=a.getPageLayoutBox(),f=0;c!=c.parent&&100>f;)c=c.parent,f++;var h=f,k=Ab(d),l=d.getAttribute("data-experiment-id");b&&(l=Bb(b,l));return{adf:Da(ab(d)),nhd:h,eid:l,adx:e.left,ady:e.top,oid:"2",act:k.length?k.join():null}}
function Cb(a,b){function c(a){return a.element.querySelector("amp-ad[type="+b+"]")}var d=Db;return Na(a.document).getMeasuredResources(a,function(a){var d="AMP-AD"==a.element.tagName&&a.element.getAttribute("type")==b;if(d)return!0;var e=Object.keys(vb).includes(a.element.tagName)&&!!c(a);return e}).then(function(a){return Promise.all(a.map(function(a){var b;if("AMP-AD"==a.element.tagName)b=a.element;else if(b=c(a),Ca(b.tagName,"AMP-"),b.createdCallback)b=Promise.resolve(b);else{if(!b.__AMP_UPG_PRM){var d=
new E;b.__AMP_UPG_PRM=d.promise;b.__AMP_UPG_RES=d.resolve}b=b.__AMP_UPG_PRM}return b}))}).then(function(a){return a.reduce(function(a,b){var c=d(b);(a[c]||(a[c]=[])).push(b.getImpl());return a},{})})}
function Eb(a,b){var c=a.win,d=a.getAmpDoc(),e=L(c).timeoutPromise(1E3,M(d).getReferrerUrl()).catch(function(){B().error("AMP-A4A","Referrer timeout!");return""});return Promise.all([fb(d),e]).then(function(e){var f=e[0],k=e[1],l=K(d),m=l.pageViewId,n=l.canonicalUrl;c.gaGlobal=c.gaGlobal||{cid:f,hid:m};var p=c.screen,t=G(d,"viewport"),w=t.getRect(),u=t.getSize(),y=M(d).getVisibilityState(),l=a.isXhrAllowed()?"3":"5",A=Fb(c,d,f),Q=c.gaGlobal.cid||null,V=c.gaGlobal.hid||null,ua=w.width,kd=w.height,
ld=p?p.availWidth:null,md=p?p.availHeight:null,nd=p?p.colorDepth:null,od=p?p.width:null,p=p?p.height:null,pd=-(new Date).getTimezoneOffset(),Ya;try{Ya=c.history.length}catch(Pe){Ya=0}var qd=c!=c.top?u.width:null,rd=c!=c.top?u.height:null,ga;ga=Gb(rb(c));ga=xb.test(c.location.origin)&&"0"!=ga?ga:null;var sd=wb[y]||"0",td=t.getScrollLeft(),ud=t.getScrollTop(),va=0,R=c.document;c.SVGElement&&R.createElementNS&&(va|=Hb);R=R.createElement("iframe");R.sandbox&&R.sandbox.supports&&(R.sandbox.supports("allow-top-navigation-by-user-activation")&&
(va|=Ib),R.sandbox.supports("allow-popups-to-escape-sandbox")&&(va|=Jb));return{is_amp:l,amp_v:"0",d_imp:"1",c:A,ga_cid:Q,ga_hid:V,dt:b,biw:ua,bih:kd,u_aw:ld,u_ah:md,u_cd:nd,u_w:od,u_h:p,u_tz:pd,u_his:Ya,isw:qd,ish:rd,art:ga,vis:sd,scr_x:td,scr_y:ud,bc:va||null,debug_experiment_id:(/(?:#|,)deid=([\d,]+)/i.exec(c.location.hash)||[])[1]||null,url:n||null,top:c!=c.top?Kb(c):null,loc:c.location.href==n?null:c.location.href,ref:k||null}})}
function Lb(a,b,c,d){var e=zb(a,d);return Eb(a,b).then(function(a){Object.assign(c,e,a);return cb(c)+"&dtd="+Mb(b)})}function Nb(a){return(/^(?:https?:\/\/)?([^\/\?:]+)/i.exec(a)||[])[1]||a}
function Kb(a){var b=a.location.ancestorOrigins;if(b){var c=a.location.origin,d=b[b.length-1];if(c==d)return a.top.location.hostname;var e=Ob(a);return e==a||c==b[b.length-2]?Nb(e.document.referrer):Nb(d)}try{return a.top.location.hostname}catch(f){}a=Ob(a);try{return Nb(a.document.referrer)}catch(f){}return null}function Ob(a){for(var b=0;a.parent!=a.parent.parent&&100>b;)a=a.parent,b++;return a}function Mb(a){a=Date.now()-a;return 1E6<=a?"M":0<=a?a:"-M"}
function Fb(a,b,c){if(!a.ampAdPageCorrelator){if(S(a,"exp-new-correlator"))b=Math.floor(4503599627370496*Math.random());else{var d=K(b).pageViewId;b=c;d=Number(d||0);b=b?d+b.replace(/\D/g,"")%1E6*1E6:Math.floor(4503599627370496*Math.random())}a.ampAdPageCorrelator=b}return a.ampAdPageCorrelator}function Pb(a,b){return D({on:a,request:"csi",sampleSpec:{sampleOn:"a4a-csi-${pageViewId}",threshold:1},selector:"amp-ad",selectionMethod:"closest",extraUrlParams:b})}
function Qb(a){if(!a.has("X-AmpAnalytics"))return null;try{var b=JSON.parse(a.get("X-AmpAnalytics")),c=b.url;if(!c.length)return null;for(var d={transport:{beacon:!1,xhrpost:!1},triggers:{continuousVisible:{on:"visible",visibilitySpec:{selector:"amp-ad",selectionMethod:"closest",visiblePercentageMin:50,continuousTimeMin:1E3}}}},e={},f=1;f<=c.length;f++)e["visibility"+f]=""+c[f-1];d.requests=e;d.triggers.continuousVisible.request=Object.keys(e);return d}catch(h){B().error("AMP-A4A","Invalid analytics",
h,a.get("X-AmpAnalytics"))}return null}function Bb(a,b){var c=a.filter(function(a){return Number(a)}).join(",");b=b||"";return b+(b&&c?",":"")+c}
function Rb(a,b,c,d,e){var f=Fb(a,b),h=Number(b.getAttribute("data-amp-slot-index")),k=encodeURIComponent(b.getAttribute("data-experiment-id")),l=b.getAttribute("type"),m=Number(mb(a,"navigationStart")||Date.now()),n=Math.round(a.performance&&a.performance.now?a.performance.now():Date.now()-m),p="https://csi.gstatic.com/csi?s=a4a"+("&c="+f+"&slotId="+h+"&qqid."+h+"="+d)+("&dt="+m)+("null"!=k?"&e."+h+"="+k:"")+("&rls=0&adt."+h+"="+l),t=e?"Friendly":"CrossDomain";c.triggers.continuousVisibleIniLoad=
{on:"ini-load",selector:"amp-ad",selectionMethod:"closest",request:"iniLoadCsi"};c.triggers.continuousVisibleRenderStart={on:"render-start",selector:"amp-ad",selectionMethod:"closest",request:"renderStartCsi"};c.requests.iniLoadCsi=p+("&met.a4a."+h+"=iniLoadCsi"+t+"."+n);c.requests.renderStartCsi=p+("&met.a4a."+h+"=renderStartCsi"+t+"."+n);c.requests.visibilityCsi=p+("&met.a4a."+h+"=visibilityCsi."+n);c.triggers.continuousVisible.request.push("visibilityCsi")}
function Ab(a){var b={};a=a.parentElement;for(var c=0;a&&20>c;a=a.parentElement,c++){var d=a.tagName.toUpperCase();vb[d]&&(b[vb[d]]=!0)}return Object.keys(b)}function Gb(a){return{production:"0",control:"1",canary:"2"}[a]||null}var Sb=/\.google\.(?:com?\.)?[a-z]{2,3}$/;function Tb(a,b,c){a.goog_identity_prom=a.goog_identity_prom||(c?eb(b,c):Promise.resolve(3)).then(function(c){return 2==c||4==c?{}:Ub(a,b)});return a.goog_identity_prom}
function Ub(a,b,c,d,e){c=void 0===c?1:c;e=void 0===e?Date.now():e;d=Vb(a,b,d);return I(a,"xhr").fetchJson(d,{mode:"cors",method:"GET",ampCors:!1,credentials:"include"}).then(function(a){return a.json()}).then(function(d){var f=d.newToken,k=d["1p_jar"]||"",l=d.pucrd||"",m=parseInt(d.freshLifetimeSecs||"",10),n=parseInt(d.validLifetimeSecs||"",10),p=d.altDomain,t=Date.now()-e;return Sb.test(p)?c--?Ub(a,b,c,p,e):{fetchTimeMs:t}:0<m&&0<n&&"string"==typeof f?{token:f,jar:k,pucrd:l,freshLifetimeSecs:m,
validLifetimeSecs:n,fetchTimeMs:t}:{fetchTimeMs:t}}).catch(function(){return{}})}function Vb(a,b,c){!c&&a!=a.top&&a.location.ancestorOrigins&&(c=(a=Sb.exec(a.location.ancestorOrigins[a.location.ancestorOrigins.length-1]))&&a[0]||void 0);c=c||".google.com";var d=Nb(K(b).canonicalUrl);return"https://adservice"+c+"/adsid/integrator.json?domain="+d}var Hb=1,Ib=2,Jb=4;function Wb(a){return a?a.split(","):[]}function Xb(a){return Wb(a.getAttribute("data-experiment-id")).some(function(a){return"117152632"===a})};function Yb(){}Yb.prototype.maybeSelectExperiment=function(a,b,c,d){var e={};e[d]={isTrafficEligible:function(){return!0},branches:c};ub(a,e);return a.experimentBranches?a.experimentBranches[d]:null};new Yb;var Zb={google:"https://cdn.ampproject.org/amp-ad-verifying-keyset.json","google-dev":"https://cdn.ampproject.org/amp-ad-verifying-keyset-dev.json",cloudflare:"https://amp.cloudflare.com/amp-ad-verifying-keyset.json","cloudflare-dev":"https://amp.cloudflare.com/amp-ad-verifying-keyset-dev.json"};var $b,ac="Webkit webkit Moz moz ms O o".split(" ");function bc(a,b,c){if(Ca(b,"--"))return b;$b||($b=ka());var d=$b[b];if(!d||c){d=b;if(void 0===a[b]){var e=b.charAt(0).toUpperCase()+b.slice(1);a:{for(var f=0;f<ac.length;f++){var h=ac[f]+e;if(void 0!==a[h]){e=h;break a}}e=""}var k=e;void 0!==a[k]&&(d=k)}c||($b[b]=d)}return d}function cc(a,b){a=a.style;for(var c in b)a.setProperty(bc(a,c),b[c].toString(),"important")}function dc(a,b,c){var d;(b=bc(a.style,b,void 0))&&(a.style[b]=d?c+d:c)}
function ec(a,b){if(b=bc(a.style,b,void 0))return a.style[b]}function fc(a,b){for(var c in b)dc(a,c,b[c])}function gc(a,b){for(var c=0;c<b.length;c++)dc(a,b[c],null)};function hc(a,b,c){La(a).then(function(d){d&&d.triggerEventForTarget(a,b,c)})};self.AMPErrors=self.AMPErrors||[];function ic(a){return a?"string"==typeof a?Ca(a,"CANCELLED"):"string"==typeof a.message?Ca(a.message,"CANCELLED"):!1:!1};function jc(a,b,c){function d(a,b){for(var d=/([^\n]*)(\n)?/g,f;(f=d.exec(a))&&(e+=f[1],f[2]&&(c(e,b&&d.lastIndex===a.length),e=""),d.lastIndex!==a.length););}var e="";if(b.body&&a.TextDecoder){var f=new TextDecoder("utf-8"),h=b.body.getReader();h.read().then(function l(a){a.value&&d(f.decode(a.value,{stream:!0}),a.done);a.done||h.read().then(l)})}else b.text().then(function(a){return d(a,!0)})}
function kc(a){var b;return function(c,d){if(b){var e=P(b)||{},f=Object.keys(e).reduce(function(a,b){a[b.toLowerCase()]=e[b];return a},{});a(lc(c),f,d);b=null}else b=c}}function lc(a){return a.replace(/\\(n|r|\\)/g,function(a,c){return"n"==c?"\n":"r"==c?"\r":"\\"})};var mc=["320","50"].map(function(a){return Number(a)});
function nc(a,b,c,d,e){e=void 0===e?!1:e;for(var f=[],h=a.split(","),k={},l=0;l<h.length;k={minWidth:k.minWidth,minHeight:k.minHeight},l++){var m=h[l];if("fluid"==m.toLowerCase())e||f.push(mc);else{var n=m.split("x");if(2!=n.length)z().error("AMP-AD","Invalid multi-size data format '"+m+"'.");else{var p=Number(n[0]),n=Number(n[1]);if(oc(p,n,function(a){return isNaN(a)||0>=a},function(a){return isNaN(a)||0>=a},function(a){return a.map(function(a){return"Invalid "+a.dim+" of "+a.val+" given for secondary size."}).join(" ")})&&
(e||oc(p,n,function(a){return a>b},function(a){return a>c},function(a){return a.map(function(a){return"Secondary "+a.dim+" "+a.val+" "+("can't be larger than the primary "+a.dim+".")}).join(" ")}))){if(d){var t=2/3;k.minWidth=t*b;k.minHeight=t*c;if(!oc(p,n,function(a){return function(b){return b<a.minWidth}}(k),function(a){return function(b){return b<a.minHeight}}(k),function(a){return a.map(function(a){return"Secondary "+a.dim+" "+a.val+" is "+("smaller than 2/3rds of the primary "+a.dim+".")}).join(" ")}))continue}f.push([p,
n])}}}}return f}function oc(a,b,c,d,e){var f=[];c(a)&&f.push({dim:"width",val:a});d(b)&&f.push({dim:"height",val:b});f.length&&z().warn("AMP-AD",e(f));return!f.length};function pc(a,b,c,d){return{left:a,top:b,width:c,height:d,bottom:b+d,right:a+c,x:a,y:b}}function qc(a){for(var b=-Infinity,c=Infinity,d=-Infinity,e=Infinity,f=0;f<arguments.length;f++){var h=arguments[f];if(h&&(b=Math.max(b,h.left),c=Math.min(c,h.left+h.width),d=Math.max(d,h.top),e=Math.min(e,h.top+h.height),c<b||e<d))return null}return Infinity==c?null:pc(b,d,c-b,e-d)}function T(a,b,c){return 0==b&&0==c||0==a.width&&0==a.height?a:pc(a.left+b,a.top+c,a.width,a.height)};function rc(){this.A=null}g=rc.prototype;g.add=function(a){var b=this;this.A||(this.A=[]);this.A.push(a);return function(){b.remove(a)}};g.remove=function(a){this.A&&(a=this.A.indexOf(a),-1<a&&this.A.splice(a,1))};g.removeAll=function(){this.A&&(this.A.length=0)};g.fire=function(a){if(this.A)for(var b=this.A,c=0;c<b.length;c++)(0,b[c])(a)};g.getHandlerCount=function(){return this.A?this.A.length:0};function sc(a,b){var c=1E3;function d(d){h=null;f=a.setTimeout(e,c);b.apply(null,d)}function e(){f=0;h&&d(h)}var f=0,h=null;return function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];f?h=b:d(b)}};var tc={"AMP-FX-FLYING-CARPET":!0,"AMP-LIGHTBOX":!0,"AMP-STICKY-AD":!0,"AMP-LIGHTBOX-GALLERY":!0};function uc(a){return"fixed"==a||"fixed-height"==a||"responsive"==a||"fill"==a||"flex-item"==a||"fluid"==a||"intrinsic"==a}function vc(a){a=parseFloat(a);return fa(a)?a:void 0};function wc(a,b,c,d){var e=Date.now(),f=b.getAttribute("width"),h=b.getAttribute("height");d=d?d:{};d.width=vc(f);d.height=vc(h);b.getAttribute("title")&&(d.title=b.getAttribute("title"));var k=a.location.href;"about:srcdoc"==k&&(k=a.parent.location.href);var l=K(b),f=M(b),h=f.getUnconfirmedReferrerUrl(),m=b.getPageLayoutBox(),n=d,p=Qa.thirdParty+"/0/ampcontext-v0.js",t=l.sourceUrl,w=l.canonicalUrl,u=l.pageViewId,y={href:k},A=b.tagName,Q={localDev:!1,development:r(void 0).development,
filter:r(void 0).filter,minified:!0,lite:r(void 0).lite,test:!1,log:r(void 0).log,version:r(void 0).version,rtvVersion:r(void 0).rtvVersion},V=a;n._context=D({ampcontextVersion:"0",ampcontextFilepath:p,sourceUrl:t,referrer:h,canonicalUrl:w,pageViewId:u,location:y,startTime:e,tagName:A,mode:Q,canary:!(!V.AMP_CONFIG||!V.AMP_CONFIG.canary),hidden:!f.isVisible(),initialLayoutRect:m?{left:m.left,top:m.top,width:m.width,height:m.height}:null,initialIntersection:b.getIntersectionChangeEntry(),
domFingerprint:Da(ab(b)),experimentToggles:sb(a),sentinel:c});var ua=b.getAttribute("src");ua&&(d.src=ua);return d};function xc(a){var b="nameframe",c=b||"frame";a.defaultBootstrapSubDomain=a.defaultBootstrapSubDomain||"d-"+yc(a);return"https://"+a.defaultBootstrapSubDomain+("."+Qa.thirdPartyFrameHost+"/0/")+(c+".html")}function yc(a){var b;if(a.crypto&&a.crypto.getRandomValues){var c=new Uint32Array(2);a.crypto.getRandomValues(c);b=String(c[0])+c[1]}else b=String(a.Math.random()).substr(2)+"0";return b}
function zc(a){if(a.sandbox&&a.sandbox.supports){for(var b=["allow-top-navigation-by-user-activation","allow-popups-to-escape-sandbox"],c="allow-forms allow-modals allow-pointer-lock allow-popups allow-same-origin allow-scripts".split(" "),d=0;d<b.length;d++){var e=b[d];if(!a.sandbox.supports(e)){B().info("3p-frame","Iframe doesn't support "+e);return}}a.sandbox=b.join(" ")+" "+c.join(" ")}};var Ac=null,Bc=null;function Cc(a,b){void 0===a["3pla"]&&(a["3pla"]=0);a["3pla"]++;if(!Ac){var c=new E;Ac=c.promise;Bc=c.resolve}L(a).timeoutPromise(1E3,b).catch(function(){}).then(function(){--a["3pla"]||(Bc(),Bc=Ac=null)})};var Dc="AMPDOC_HOST AMPDOC_HOSTNAME AMPDOC_URL AMP_VERSION AVAILABLE_SCREEN_HEIGHT AVAILABLE_SCREEN_WIDTH BACKGROUND_STATE BROWSER_LANGUAGE CANONICAL_HOST CANONICAL_HOSTNAME CANONICAL_PATH CANONICAL_URL COUNTER DOCUMENT_CHARSET DOCUMENT_REFERRER FIRST_CONTENTFUL_PAINT FIRST_VIEWPORT_READY MAKE_BODY_VISIBLE PAGE_VIEW_ID RANDOM SCREEN_COLOR_DEPTH SCREEN_HEIGHT SCREEN_WIDTH SCROLL_HEIGHT SCROLL_LEFT SCROLL_TOP SCROLL_WIDTH SHARE_TRACKING_INCOMING SHARE_TRACKING_OUTGOING SOURCE_HOST SOURCE_HOSTNAME SOURCE_PATH SOURCE_URL TIMESTAMP TIMEZONE TIMEZONE_CODE TITLE TOTAL_ENGAGED_TIME USER_AGENT VARIANT VARIANTS VIEWER VIEWPORT_HEIGHT VIEWPORT_WIDTH".split(" ");
function Ec(a,b){ob.call(this,a);this.gb=Oa(a).getVariableSource();this.h=b}aa(Ec,ob);
Ec.prototype.initialize=function(){var a=this;this.set("AD_NAV_TIMING",function(b,c){z().assert(b,"The first argument to AD_NAV_TIMING, the start attribute name, is required");return mb(a.h,b,c)}).setAsync("AD_NAV_TIMING",function(b,c){z().assert(b,"The first argument to AD_NAV_TIMING, the start attribute name, is required");return lb(a.h,b,c)});this.set("AD_NAV_TYPE",function(){return nb(a.h,"type")});this.set("AD_NAV_REDIRECT_COUNT",function(){return nb(a.h,"redirectCount")});this.set("HTML_ATTR",
this.hb.bind(this));this.set("CLIENT_ID",function(){return null});for(var b=0;b<Dc.length;b++){var c=Dc[b],d=this.gb.get(c);this.set(c,d.sync).setAsync(c,d.async)}};
Ec.prototype.hb=function(a,b){var c=20,d=10,e=10,f="A4AVariableSource",h=Array.prototype.slice.call(arguments,1);if(!a||!h.length)return"[]";if(h.length>e)return z().error(f,"At most "+e+" may be requested."),"[]";a=decodeURI(a);var k;try{k=this.h.document.querySelectorAll(a)}catch(u){return z().error(f,"Invalid selector: "+a),"[]"}if(k.length>c)return z().error(f,"CSS selector may match at most "+(c+" elements.")),"[]";for(var l=[],m=0;m<k.length&&l.length<d;++m){for(var n={},p=!1,t=0;t<h.length;++t){var w=
h[t];k[m].hasAttribute(w)&&(n[w]=k[m].getAttribute(w),p=!0)}p&&l.push(n)}return JSON.stringify(l)};function Fc(a){if("undefined"!==typeof TextDecoder)return(new TextDecoder("utf-8")).decode(a);for(var b=new Uint8Array(a.buffer||a),c=Array(b.length),d=0;d<b.length;d++)c[d]=String.fromCharCode(b[d]);var e=c.join("");return decodeURIComponent(escape(e))}function Gc(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++){var d=a.charCodeAt(c);b[c]=d}return b};function Hc(a,b){this.h=a;this.lb=b;this.ma=I(a,"crypto").isPkcsAvailable()?{}:null;this.Sa=a.performance&&a.performance.now?a.performance.now.bind(a.performance):Date.now}Hc.prototype.loadKeyset=function(a){if(this.ma&&!this.ma[a]){var b={},c=Ic(this,b,a,null);this.ma[a]={promise:c,keys:b}}};
Hc.prototype.verify=function(a,b){var c=/^([A-Za-z0-9._-]+):([A-Za-z0-9._-]+):([A-Za-z0-9+/]{341}[AQgw]==)$/;if(!b.has("AMP-Fast-Fetch-Signature"))return Promise.resolve(1);var d=b.get("AMP-Fast-Fetch-Signature");b=c.exec(d);return b?this.verifyCreativeAndSignature(b[1],b[2],Gc(atob(b[3])),a):(z().error("AMP-A4A","Invalid signature header: "+d.split(":")[0]),Promise.resolve(3))};
Hc.prototype.verifyCreativeAndSignature=function(a,b,c,d){var e=this;if(!this.ma)return Promise.resolve(4);var f=this.ma[a];return f.promise.then(function(h){if(!h)return 1;var k=f.keys[b];return void 0===k?(f.promise=Ic(e,f.keys,a,b).then(function(a){void 0===f.keys[b]&&(f.keys[b]=null);return a}),e.verifyCreativeAndSignature(a,b,c,d)):null===k?2:k.then(function(a){if(!a)return 1;var b=I(e.h,"crypto");return b.verifyPkcs(a,c,d).then(function(a){return a?0:3},function(a){a=a&&a.message;B().error("AMP-A4A",
"Failed to verify signature: "+a);return 1})})})};
function Ic(a,b,c,d){var e=a.lb[c];null!=d&&(e+="?kid="+encodeURIComponent(d));return I(a.h,"xhr").fetchJson(e,{mode:"cors",method:"GET",ampCors:!1,credentials:"omit"}).then(function(d){d.headers.get("Content-Type");return d.json().then(function(d){var e=d;if(!e||!Array.isArray(e.keys))return Jc(c,"Key set ("+JSON.stringify(e)+') has no "keys"'),!1;e.keys.forEach(function(d){d&&"string"==typeof d.kid?void 0===b[d.kid]&&(b[d.kid]=I(a.h,"crypto").importPkcsKey(d).catch(function(a){var b=JSON.stringify(d);
Jc(c,"Failed to import key ("+b+"): "+(a&&a.message));return null})):Jc(c,"Key ("+JSON.stringify(d)+') has no "kid"')});return!0},function(a){Jc(c,"Failed to parse JSON: "+(a&&a.response));return!1})},function(a){a&&a.response&&Jc(c,"Status code "+a.response.status);return!1})}function Jc(a,b){B().error("AMP-A4A","Signing service error for "+a+": "+b)};function Kc(a,b,c){var d=!0,d=void 0===d?!1:d;c=void 0===c?!1:c;var e=a.ownerDocument,f=J(e,"amp-analytics",D({sandbox:"true",trigger:c?"":"immediate"})),h=J(e,"script",D({type:"application/json"}));h.textContent=JSON.stringify(b);f.appendChild(h);f.CONFIG=b;d?(b=Ma(a.ownerDocument.defaultView),d=sa(a),b.installExtensionForDoc(d,"amp-analytics")):La(a).then(function(){});a.appendChild(f);return f};function Lc(){this.M=ka();this.D=null}g=Lc.prototype;g.get=function(a){return this.M[a]||null};g.whenSignal=function(a){var b=this.D&&this.D[a];if(!b){var c=this.M[a];null!=c?b={promise:"number"==typeof c?Promise.resolve(c):Promise.reject(c)}:(c=new E,b={promise:c.promise,resolve:c.resolve,reject:c.reject});this.D||(this.D=ka());this.D[a]=b}return b.promise};
g.signal=function(a,b){if(null==this.M[a]){var c=b||Date.now();this.M[a]=c;(a=this.D&&this.D[a])&&a.resolve&&(a.resolve(c),a.resolve=void 0,a.reject=void 0)}};g.rejectSignal=function(a,b){null==this.M[a]&&(this.M[a]=b,(a=this.D&&this.D[a])&&a.reject&&(a.reject(b),a.resolve=void 0,a.reject=void 0))};g.reset=function(a){this.M[a]&&delete this.M[a];var b=this.D&&this.D[a];b&&!b.resolve&&delete this.D[a]};var Mc=["AMP-AD","AMP-ANALYTICS","AMP-PIXEL","AMP-AD-EXIT"],Nc;function Oc(a,b){Pc(a,b)}
function Qc(a,b,c,d){function e(){a.contentWindow.addEventListener("securitypolicyviolation",function(a){B().warn("FIE","security policy violation",a)})}var f=pa(a.ownerDocument.defaultView),h=Ma(f);dc(a,"visibility","hidden");a.setAttribute("referrerpolicy","unsafe-url");c.extensionIds&&c.extensionIds.forEach(function(a){return h.preloadExtension(a)});var k=Rc(c);a.onload=function(){a.readyState="complete"};var l;void 0===Nc&&(Nc="srcdoc"in HTMLIFrameElement.prototype);if(Nc)a.srcdoc=k,l=kb(a),b.appendChild(a),
e();else{a.src="about:blank";b.appendChild(a);var m=a.contentWindow.document;m.open();e();m.write(k);l=kb(a.contentWindow);m.close()}var n;n=Sc(a)?Promise.resolve():new Promise(function(b){var c=f.setInterval(function(){Sc(a)&&(b(),f.clearInterval(c))},5);l.catch(function(a){x(a)}).then(function(){b();f.clearInterval(c)})});return n.then(function(){var b=new Tc(a,c,l);a.__AMP_EMBED__=b;h.installExtensionsInChildWindow(a.contentWindow,c.extensionIds||[],d);Uc(b);return b})}
function Sc(a){a=a.contentWindow&&a.contentWindow.document;return!!(a&&"loading"!=a.readyState&&"uninitialized"!=a.readyState&&a.body&&a.body.firstChild)}
function Rc(a){var b=a.html,c=b.toUpperCase(),d=c.indexOf("<HEAD");-1!=d&&(d=c.indexOf(">",d+1)+1);-1==d&&(d=c.indexOf("<BODY"));-1==d&&(d=c.indexOf("<HTML"),-1!=d&&(d=c.indexOf(">",d+1)+1));var e=[];0<d&&e.push(b.substring(0,d));e.push('<base href="'+Ia(a.url)+'">');a.fonts&&a.fonts.forEach(function(a){e.push('<link href="'+Ia(a)+'" rel="stylesheet" type="text/css">')});e.push("<meta http-equiv=Content-Security-Policy content=\"script-src 'none';object-src 'none';child-src 'none'\">");0<d?e.push(b.substring(d)):
e.push(b);return e.join("")}function Tc(a,b,c){this.iframe=a;this.win=a.contentWindow;this.spec=b;this.host=b.host||null;this.mb=Date.now();this.wa=!1;this.$a=new rc;this.la=this.host?this.host.signals():new Lc;this.ob=Promise.all([c,this.whenReady()])}g=Tc.prototype;g.destroy=function(){Na(this.iframe).removeForChildWindow(this.win);Aa(this.win)};g.getStartTime=function(){return this.mb};g.getUrl=function(){return this.spec.url};g.signals=function(){return this.la};g.whenReady=function(){return this.la.whenSignal("render-start")};
g.whenWindowLoaded=function(){return this.ob};g.whenIniLoaded=function(){return this.la.whenSignal("ini-load")};
function Uc(a){a.host?a.host.renderStarted():a.la.signal("render-start");dc(a.iframe,"visibility","");a.win.document&&a.win.document.body&&(a.win.document.documentElement.classList.add("i-amphtml-fie"),fc(a.win.document.body,{opacity:1,visibility:"visible",animation:"none"}));var b;b=a.host?a.host.getLayoutBox():pc(0,0,a.win.innerWidth,a.win.innerHeight);Promise.all([a.whenReady(),Vc(a.iframe,a.win,b)]).then(function(){a.la.signal("ini-load")})}g.isVisible=function(){return this.wa};
g.onVisibilityChanged=function(a){return this.$a.add(a)};function Pc(a,b){a.wa!=b&&(a.wa=b,a.$a.fire(a.wa))}g.getBodyElement=function(){return(this.iframe.contentDocument||this.iframe.contentWindow.document).body};function Wc(a,b){return Na(a.iframe).measureMutateElement(a.iframe,b.measure||null,b.mutate)}
g.enterFullOverlayMode=function(){var a=this,b=this.iframe.parentNode;z().assert("amp-ad"==b.tagName.toLowerCase(),"Only <amp-ad> is allowed to enter lightbox mode.");var c;return Wc(this,{measure:function(){var b=a.host?a.host.getLayoutBox():a.iframe.getBoundingClientRect(),e=-G(a.iframe,"viewport").getScrollTop(),b=T(b,0,e);c={top:b.top+"px",left:b.left+"px",width:b.width+"px",height:b.height+"px"}},mutate:function(){cc(a.iframe,{position:"fixed",left:0,right:0,bottom:0,width:"100vw",top:0,height:"100vh"});
cc(a.getBodyElement(),{background:"transparent",position:"absolute",bottom:"auto",right:"auto",top:c.top,left:c.left,width:c.width,height:c.height})}})};g.leaveFullOverlayMode=function(){var a=this;return Wc(this,{mutate:function(){gc(a.iframe,"position left right top bottom width height".split(" "));gc(a.getBodyElement(),"position top left width height bottom right".split(" "))}})};
function Vc(a,b,c){return Na(a).getResourcesInRect(b,c).then(function(a){var b=[];a.forEach(function(a){Mc.includes(a.element.tagName)||b.push(a.loadedOnce())});return Promise.all(b)})};var Xc={ANCESTOR_ORIGIN:!0};function Yc(a){this.S=a}Yc.prototype.expand=function(a,b,c,d,e){if(!a.length)return d?a:Promise.resolve(a);e=this.S.getExpr(b,!0,e);e=Zc(a,e);return e.length?$c(this,a,e,b,c,d):d?a:Promise.resolve(a)};function Zc(a,b){var c=[];a.replace(b,function(a,b,f){a=a.length;var d=a+f-1;c.push({start:f,stop:d,name:b,length:a})});return c}
function $c(a,b,c,d,e,f){function h(){for(var u="",y=[];l<b.length&&m<=c.length;){if(n&&l===n.start){var A=void 0;d&&C.call(d,n.name)?A={name:n.name,prioritized:d[n.name]}:(A=a.S.get(n.name),A.name=n.name);l=n.stop+1;n=c[++m];"("===b[l]?(l++,p++,k.push(A),u.trim().length&&y.push(u),y.push(h())):(u.length&&y.push(u),y.push(ad(A,void 0,e,f)));u=""}else{if("`"===b[l])t?t=!1:(w=t=!0,z().assert(""===u.trim(),'The substring "'+u+'" was lost during url-replacement. Please ensure the url syntax is correct'),
u="");else if(p&&","===b[l]&&!t){if(u.length){var Q=w?u:u.trim();y.push(Q);w=!1}","===b[l+1]&&(y.push(""),l++);u=""}else{if(p&&")"===b[l]&&!t){l++;p--;var V=k.pop();y.push(w?u:u.trim());w=!1;return ad(V,y,e,f)}u+=b[l]}l++}l===b.length&&u.length&&y.push(u)}return f?y.join(""):Promise.all(y).then(function(a){return a.join("")}).catch(function(a){x(a);return""})}var k=[],l=0,m=0,n=c[m],p=0,t=!1,w=!1;return h()}
function ad(a,b,c,d){var e=a.name,f;C.call(a,"prioritized")?f=a.prioritized:d&&C.call(a,"sync")?f=a.sync:d?(z().error("Expander","ignoring async replacement key: ",a.name),f=""):f=a.async||a.sync;var h;if(d){d=f;try{var k="function"===typeof d?d.apply(null,b):d,l;k&&k.then?(z().error("Expander","ignoring async macro resolution"),l=""):l="string"===typeof k||"number"===typeof k?Xc[e]?k.toString():encodeURIComponent(k):"";c&&(c[e]=l);h=l}catch(m){x(m),c&&(c[e]=""),h=""}}else h=bd(f,e,b,c);return h}
function bd(a,b,c,d){var e;try{return e="function"===typeof a?c?Promise.all(c).then(function(b){return a.apply(null,b)}):ma(a):Promise.resolve(a),e.then(function(a){a=null==a?"":Xc[b]?a:encodeURIComponent(a);d&&(d[b]=a);return a}).catch(function(a){x(a);d&&(d[b]="");return Promise.resolve("")})}catch(f){return x(f),d&&(d[b]=""),Promise.resolve("")}};function cd(a,b){this.ampdoc=a;this.S=b;this.eb=new Yc(this.S)}g=cd.prototype;g.expandStringSync=function(a,b,c,d){return U(this,a,b,c,!0,d)};g.expandStringAsync=function(a,b){return U(this,a,b)};g.expandUrlSync=function(a,b,c,d){return dd(a,U(this,a,b,c,!0,d))};g.expandUrlAsync=function(a,b,c){return U(this,a,b,void 0,void 0,c).then(function(b){return dd(a,b)})};g.expandInputValueAsync=function(a){return ed(this,a,!1)};g.expandInputValueSync=function(a){return ed(this,a,!0)};
function ed(a,b,c){"INPUT"==b.tagName&&b.getAttribute("type");var d=fd(b);if(!d)return c?b.value:Promise.resolve(b.value);void 0===b["amp-original-value"]&&(b["amp-original-value"]=b.value);a=U(a,b["amp-original-value"]||b.value,void 0,void 0,c,d);return c?b.value=a:a.then(function(a){return b.value=a})}
function fd(a,b){if(a=a.getAttribute("data-amp-replace")){var c={};a.trim().split(/\s+/).forEach(function(a){!b||C.call(b,a)?c[a]=!0:z().warn("URL","Ignoring unsupported replacement",a)});return c}}
g.maybeExpandLink=function(a,b){var c={CLIENT_ID:!0,QUERY_PARAM:!0},d=a.getAttribute("data-amp-addparams")||"",e=fd(a,c);if(e||d||b){var f=a["amp-original-href"]||a.getAttribute("href"),h=O(f);null==a["amp-original-href"]&&(a["amp-original-href"]=f);if(d)var k=q(d),f=Ua(f,Va(k));a:if(k=K(this.ampdoc),h.origin==O(k.canonicalUrl).origin||h.origin==O(k.sourceUrl).origin)h=!0;else{if((k=this.ampdoc.getRootNode().querySelector("meta[name=amp-link-variable-allowed-origin]"))&&k.hasAttribute("content"))for(var k=
k.getAttribute("content").trim().split(/\s+/),l=0;l<k.length;l++)if(h.origin==O(k[l]).origin){h=!0;break a}h=!1}var m=h;if(!m)return e&&z().warn("URL","Ignoring link replacement",f," because the link does not go to the document's source, canonical, or whitelisted origin."),a.href=f;if(b){if(!e||!e.QUERY_PARAM){var n={QUERY_PARAM:!0};b=this.expandUrlSync(b,void 0,void 0,n)}h=q(b);f=Ua(f,Va(h))}e&&(f=this.expandUrlSync(f,void 0,void 0,e));return a.href=f}};
function U(a,b,c,d,e,f){var h=S(a.ampdoc.win,"url-replacement-v2");if(h)return a.eb.expand(b,c,d,e,f);var k=a.S.getExpr(c),l,m=b.replace(k,function(b,h,k){var n=[];"string"==typeof k&&(n=k.split(/,\s*/));if(f&&!f[h])return b;var p;if(c&&h in c)p=c[h];else if(p=a.S.get(h))if(e){if(p=p.sync,!p)return z().error("UrlReplacements","ignoring async replacement key: ",h),""}else p=p.async||p.sync;var t;try{t="function"==typeof p?p.apply(null,n):p}catch(Q){e&&(t=""),x(Q)}if(t&&t.then){if(e)return z().error("UrlReplacements",
"ignoring promise value for key: ",h),"";var A=t.catch(function(a){x(a)}).then(function(a){m=m.replace(b,Xc[b]?a:null==a?"":encodeURIComponent(a));d&&(d[b]=a)});l=l?l.then(function(){return A}):A;return b}d&&(d[b]=t);return Xc[b]?t:null==t?"":encodeURIComponent(t)});l&&(l=l.then(function(){return m}));return e?m:l||Promise.resolve(m)}g.collectVars=function(a,b){var c=Object.create(null);return U(this,a,b,c).then(function(){return c})};
g.collectUnwhitelistedVarsSync=function(a){var b=a.getAttribute("src"),c=Object.create(null);this.expandStringSync(b,void 0,c);var d=Object.keys(c),e=fd(a);return e?d.filter(function(a){return!e[a]}):d};function dd(a,b){var c=O(b,!0).protocol,d=O(a,!0).protocol;if(c!=d)return z().error("UrlReplacements","Illegal replacement of the protocol: ",a),a;z().assert(Za(b),"The replacement url has invalid protocol: %s",b);return b}g.getVariableSource=function(){return this.S};var gd=["<script amp-ad-metadata type=application/json>",'<script type="application/json" amp-ad-metadata>',"<script type=application/json amp-ad-metadata>"],hd={CLIENT_CACHE:"client_cache",SAFEFRAME:"safeframe",NAMEFRAME:"nameframe",IFRAME_GET:"iframe_get"},id=D({frameborder:"0",allowfullscreen:"",allowtransparency:"",scrolling:"no",marginwidth:"0",marginheight:"0"}),jd={adRequestStart:"ad-request-start",adRequestEnd:"ad-response-end",renderFriendlyStart:"ad-render-start",renderCrossDomainStart:"ad-render-start",
renderSafeFrameStart:"ad-render-start",renderFriendlyEnd:"ad-render-end",renderCrossDomainEnd:"ad-render-end",friendlyIframeIniLoad:"ad-iframe-loaded",crossDomainIframeLoaded:"ad-iframe-loaded"};function vd(a,b,c){return function(d){for(var e=[],f=0;f<arguments.length;++f)e[f-0]=arguments[f];try{return a.apply(b,e)}catch(h){if(c)try{return e.unshift(h),c.apply(b,e)}catch(k){}}}}
function W(a){a=AMP.BaseElement.call(this,a)||this;a.Va=null;a.L=null;a.Z=0;a.w=null;a.P=null;a.uiHandler=null;a.J=null;a.va=!1;a.da=null;a.l=null;a.N=null;a.O=a.getNonAmpCreativeRenderingMethod();a.Sa=a.win.performance&&a.win.performance.now?a.win.performance.now.bind(a.win.performance):Date.now;var b;b=window;for(var c=0,d=b;d&&d!=d.parent;d=d.parent)c++;b=String(c)+"-"+yc(b);a.sentinel=b;a.W=!1;a.iframe=null;a.fromResumeCallback=!1;a.safeframeVersion="1-0-23";a.isRefreshing=!1;a.isRelayoutNeededFlag=
!1;a.rb=Gb(rb(a.win))||"-1";a.postAdResponseExperimentFeatures={};a.na=null;a.ab=null;a.isSinglePageStoryAd=!1;return a}aa(W,AMP.BaseElement);g=W.prototype;g.getLayoutPriority=function(){var a=!this.element.getAmpDoc().isSingleDoc();return a?1:2};g.isLayoutSupported=function(a){return uc(a)};g.isRelayoutNeeded=function(){return this.isRelayoutNeededFlag};
g.buildCallback=function(){var a=this;this.l={width:this.element.getAttribute("width"),height:this.element.getAttribute("height")};var b=Math.round(this.getResource().getUpgradeDelayMs());B().info("amp-a4a","upgradeDelay "+this.element.getAttribute("type")+": "+b);this.uiHandler=new AMP.AmpAdUIHandler(this);var c=wd(this.win);this.Va=M(this.getAmpDoc()).whenFirstVisible().then(function(){a.getSigningServiceNames().forEach(function(a){c.loadKeyset(a)})});if(this.na=this.getA4aAnalyticsConfig())this.ab=
Kc(this.element,this.na);this.isSinglePageStoryAd=this.element.hasAttribute("amp-story")};
g.renderOutsideViewport=function(){if(!this.va&&this.win["3pla"]&&!this.inNonAmpPreferenceExp())return!1;var a;var b=this.element.getAttribute("data-loading-strategy");null==b?a=null:"prefer-viewability-over-views"==b||""==b?a=1.25:(a="Value of data-loading-strategy should be a float number in range of [0, 3], but got "+b,b=z().assertNumber(parseFloat(b),a),z().assert(0<=b&&3>=b,a),a=b);var c=a;return null!==c?c:AMP.BaseElement.prototype.renderOutsideViewport.call(this)};g.isValidElement=function(){return!0};
g.getCreativeSize=function(){return this.l};g.delayAdRequestEnabled=function(){return!1};g.getPreconnectUrls=function(){return[]};g.getPrefetchUrls=function(){return[]};g.isAmpAdElement=function(){return"AMP-AD"==this.element.tagName||"AMP-EMBED"==this.element.tagName};g.preconnectCallback=function(){var a=this,b=this.getPreconnectUrls();b&&b.forEach(function(b){a.preconnect.url(b,!0)})};
g.resumeCallback=function(){if(!this.P){this.fromResumeCallback=!0;var a=this.getResource();if(a.hasBeenMeasured()&&!a.isMeasureRequested())this.onLayoutMeasure()}};g.getResource=function(){return this.element.getResources().getResourceForElement(this.element)};g.hasAdPromise=function(){return!!this.L};g.inNonAmpPreferenceExp=function(){return!!this.postAdResponseExperimentFeatures.pref_neutral_enabled&&["adsense","doubleclick"].includes(this.element.getAttribute("type"))};
function xd(a){var b=a.getIntersectionElementLayoutBox();if("fluid"!=a.getLayout()&&(0==b.height||0==b.width))return!1;var b=a.win,c=!1,d=0,e=a.element;do{if(tc[e.tagName])d++,c=!1;else{var f=(b.getComputedStyle(e)||ka()).position;"fixed"!=f&&"sticky"!=f||(c=!0)}e=e.parentElement}while(e&&"BODY"!=e.tagName);return!c&&1>=d?a.isValidElement()?!0:(z().warn("amp-a4a",a.element.getAttribute("type"),"Amp ad element ignored as invalid",a.element),!1):(z().warn("amp-a4a","<"+a.element.tagName+"> is not allowed to be "+
("placed in elements with position:fixed: "+a.element)),!1)}g.onLayoutMeasure=function(){this.initiateAdRequest()};
g.initiateAdRequest=function(){var a=this;if(this.J)this.J.onLayoutMeasure();if(!this.L&&xd(this)){++this.Z;var b=this.verifyStillCurrent();this.L=M(this.getAmpDoc()).whenFirstVisible().then(function(){b();var c=a.delayAdRequestEnabled();if(c)return a.getResource().whenWithinViewport("number"==typeof c?c:a.renderOutsideViewport())}).then(function(){b();var c=AMP.BaseElement.prototype.getConsentPolicy.call(a);return c?eb(a.getAmpDoc(),c).catch(function(a){z().error("amp-a4a","Error determining consent state",
a);return 4}):Promise.resolve(null)}).then(function(c){b();return a.getAdUrl(c,yd(a,c))}).then(function(c){b();a.w=c;return!a.isXhrAllowed()&&a.w?(a.O="iframe_get",Promise.reject("IFRAME-GET")):c&&a.sendXhrRequest(c)}).then(function(c){b();X(a,"adRequestEnd");if(!c||!c.arrayBuffer||c.headers.has("amp-ff-empty-creative"))return a.forceCollapse(),Promise.reject("NO-CONTENT-RESPONSE");c.headers&&c.headers.has("amp-ff-exps")&&zd(a,c.headers.get("amp-ff-exps"));var d=a.getNonAmpCreativeRenderingMethod(c.headers.get("X-AmpAdRender"));
a.O=d;"nameframe"==a.O&&a.preconnect.preload(xc(a.win));var e=c.headers.get("X-AmpSafeFrameVersion");/^[0-9-]+$/.test(e)&&"1-0-23"!=e&&(a.safeframeVersion=e,a.preconnect.preload(a.getSafeframePath()));return c.arrayBuffer().then(function(b){return 0==b.byteLength?(a.forceCollapse(),Promise.reject("NO-CONTENT-RESPONSE")):{bytes:b,headers:c.headers}})}).then(function(c){b();if(!c)return Promise.resolve();var d=c,e=d.bytes,d=d.headers,f=a.extractSize(c.headers);a.l=f||a.l;"client_cache"!=a.O&&e&&(a.da=
e);return a.maybeValidateAmpCreative(e,d)}).then(function(c){b();a.va=!!c;return c&&Fc(c)}).then(function(c){b();var d;if(!c||!(d=a.getAmpAdMetadata(c)))return a.inNonAmpPreferenceExp()&&a.updateLayoutPriority(0),null;a.updateLayoutPriority(0);var e=Ma(a.win);d.customElementExtensions.forEach(function(a){return e.preloadExtension(a)});(d.customStylesheets||[]).forEach(function(b){return a.preconnect.preload(b.href)});var f=F(a.getAmpDoc(),"url");(d.images||[]).forEach(function(b){return f.isSecure(b)&&
a.preconnect.preload(b)});return d}).catch(function(b){switch(b.message||b){case "IFRAME-GET":case "NETWORK-FAILURE":return null;case "INVALID-SPSA-RESPONSE":case "NO-CONTENT-RESPONSE":return{minifiedCreative:"",customElementExtensions:[],customStylesheets:[]}}Ad(a,b);return null})}};
g.maybeValidateAmpCreative=function(a,b){var c=this,d=this.verifyStillCurrent();return this.Va.then(function(){return"fake"!=c.element.getAttribute("type")||c.element.getAttribute("checksig")?wd(c.win).verify(a,b):Promise.resolve(0)}).then(function(b){d();var e=null;switch(b){case 0:e=a;break;case 4:e=c.shouldPreferentialRenderWithoutCrypto()?a:null;break;case 2:case 3:z().error("amp-a4a",c.element.getAttribute("type"),"Signature verification failed")}if(c.isSinglePageStoryAd&&!e)throw Error("INVALID-SPSA-RESPONSE");
return e})};function zd(a,b){b.split(",").forEach(function(b){if(b){var c=b.split("=");2==c.length&&c[0]?a.postAdResponseExperimentFeatures[c[0]]=c[1]:B().warn("amp-a4a","invalid experiment feature "+b)}})}
g.refresh=function(a){var b=this;this.isRefreshing=!0;this.tearDownSlot();this.initiateAdRequest();if(!this.L)return Promise.resolve();var c=this.Z;return this.L.then(function(){if(b.isRefreshing&&c==b.Z)return b.mutateElement(function(){hc(b.element,"ad-refresh");b.togglePlaceholder(!0);return L(b.win).promise(1E3).then(function(){b.isRelayoutNeededFlag=!0;b.getResource().layoutCanceled();M(b.getAmpDoc()).whenNextVisible().then(function(){Na(b.getAmpDoc()).requireLayout(b.element)})})});a()})};
function Ad(a,b){var c;if(ic(b))throw b;b=b&&b.message?ha(b):Error("unknown error "+b);c&&(b.ignoreStack=c);var d=a.element.getAttribute("type")||"notype";0!=b.message.indexOf("amp-a4a: "+d+":")&&(b.message="amp-a4a: "+d+": "+b.message);Bd(b,a.w);r().development||r().log?z().error("amp-a4a",b):(z().warn("amp-a4a",b),.01>Math.random()&&B().expectedError("amp-a4a",b))}g.layoutCallback=function(){this.isRefreshing&&this.destroyFrame(!0);return this.attemptToRenderCreative()};
g.attemptToRenderCreative=function(){var a=this;if(!this.L)return xd(this)&&B().error("amp-a4a","Null promise in layoutCallback"),Promise.resolve();var b=this.verifyStillCurrent();return this.L.then(function(c){b();return a.W||a.iframe&&!a.isRefreshing?Promise.resolve():c?Cd(a,c).catch(function(c){b();z().warn("amp-a4a",a.element.getAttribute("type"),"Error injecting creative in friendly frame",c);return a.renderNonAmpCreative()}):a.renderNonAmpCreative()}).catch(function(b){Ad(a,b);throw Error("CANCELLED");
})};g.isXhrAllowed=function(){return!0};g.attemptChangeSize=function(a,b){this.N=this.N||this.getLayoutBox();return AMP.BaseElement.prototype.attemptChangeSize.call(this,a,b)};g.unlayoutCallback=function(){this.tearDownSlot();return!0};
g.tearDownSlot=function(){var a=this;this.Z++;this.uiHandler.applyUnlayoutUI();this.N&&AMP.BaseElement.prototype.attemptChangeSize.call(this,this.N.height,this.N.width).then(function(){a.N=null}).catch(function(a){B().warn("amp-a4a","unable to revert to original size",a)});this.W=!1;this.destroyFrame();this.da=this.w=this.L=null;this.fromResumeCallback=this.va=!1;this.O=this.getNonAmpCreativeRenderingMethod();this.postAdResponseExperimentFeatures={}};
g.destroyFrame=function(a){if((a=void 0===a?!1:a)||!this.isRefreshing)this.P&&(this.P.destroy(),this.P=null),this.iframe&&this.iframe.parentElement&&(this.iframe.parentElement.removeChild(this.iframe),this.iframe=null),this.J&&(this.J.freeXOriginIframe(),this.J=null)};g.viewportCallback=function(a){this.P&&Pc(this.P,a);this.J&&this.J.viewportCallback(a)};g.createPlaceholderCallback=function(){return this.uiHandler.createPlaceholder()};
g.getAdUrl=function(){throw Error("getAdUrl not implemented!");};g.resetAdUrl=function(){this.w=null};g.verifyStillCurrent=function(){var a=this,b=this.Z;return function(){if(b!=a.Z)throw Error("CANCELLED");}};g.extractSize=function(a){a=a.get("X-CreativeSize");if(!a)return null;var b=/^([0-9]+)x([0-9]+)$/.exec(a);return b?{width:Number(b[1]),height:Number(b[2])}:(z().error("amp-a4a","Invalid size header: "+a),null)};
g.forceCollapse=function(){this.isRefreshing?this.isRefreshing=!1:(this.N=this.N||this.getLayoutBox(),this.uiHandler.applyNoContentUI(),this.W=!0)};g.onCreativeRender=function(a){X(this,a?"renderFriendlyEnd":"renderCrossDomainEnd")};g.onCrossDomainIframeCreated=function(a){B().info("amp-a4a",this.element.getAttribute("type"),"onCrossDomainIframeCreated "+a)};g.sandboxHTMLCreativeFrame=function(){return S(this.win,"sandbox-ads")};
g.sendXhrRequest=function(a){var b=this;X(this,"adRequestStart");var c={mode:"cors",method:"GET",credentials:"include"};return I(this.win,"xhr").fetch(a,c).catch(function(a){if(a.response&&200<a.response.status)return null;var c=b.onNetworkFailure(a,b.w);if(c.frameGetDisabled)B().info("amp-a4a","frame get disabled as part of network failure handler"),b.resetAdUrl();else return b.w=c.adUrl||b.w,Promise.reject("NETWORK-FAILURE");return null})};g.onNetworkFailure=function(){return{}};
g.getSigningServiceNames=function(){return["google"]};
g.renderNonAmpCreative=function(a){var b=this;if("true"==this.element.getAttribute("disable3pfallback"))return z().warn("amp-a4a",this.element.getAttribute("type"),"fallback to 3p disabled"),Promise.resolve(!1);B().warn("amp-a4a","fallback to 3p");var c=this.O,d=Promise.resolve(!1);"safeframe"!=c&&"nameframe"!=c||!this.da?this.w?(Xa(this.w,this.element),d=Dd(this,this.w)):z().warn("amp-a4a",this.element.getAttribute("type"),"No creative or URL available -- A4A can't render any ad"):(d=Ed(this,this.da),
this.da=null);a||this.inNonAmpPreferenceExp()||Cc(this.win,d);return d.then(function(a){X(b,"crossDomainIframeLoaded");return a})};
function Cd(a,b){X(a,"renderFriendlyStart");a.iframe=J(a.element.ownerDocument,"iframe",D({height:a.l.height,width:a.l.width,frameborder:"0",allowfullscreen:"",allowtransparency:"",scrolling:"no"}));a.applyFillContent(a.iframe);var c=[];b.customStylesheets&&b.customStylesheets.forEach(function(a){(a=a.href)&&c.push(a)});var d=a.verifyStillCurrent();return Qc(a.iframe,a.element,{host:a.element,url:a.w,html:b.minifiedCreative,extensionIds:b.customElementExtensions||[],fonts:c},function(b){var c=a.getAmpDoc(),
d=new Ec(a.getAmpDoc(),b);oa(b,new cd(c,d))}).then(function(c){d();a.P=c;Oc(c,a.isInViewport());var e=c.iframe.contentDocument||c.win.document;dc(e.body,"visibility","visible");vd(a.onCreativeRender,a,function(b){B().error("amp-a4a",a.element.getAttribute("type"),"Error executing onCreativeRender",b)})(b);return c.whenIniLoaded()}).then(function(){d();X(a,"friendlyIframeIniLoad")})}
function Fd(a,b){var c=Object.assign(b,D({height:a.l.height,width:a.l.width}));a.sentinel&&(c["data-amp-3p-sentinel"]=a.sentinel);S(a.win,"no-sync-xhr-in-ads")&&(c.allow="sync-xhr 'none';");a.iframe=J(a.element.ownerDocument,"iframe",Object.assign(c,id));a.sandboxHTMLCreativeFrame()&&zc(a.iframe);a.J=new AMP.AmpAdXOriginIframeHandler(a);var d=a.J.init(a.iframe,!0);vd(a.onCreativeRender,a,function(b){B().error("amp-a4a",a.element.getAttribute("type"),"Error executing onCreativeRender",b)})(null);return d}
function Dd(a,b){X(a,"renderCrossDomainStart");return Fd(a,D({src:I(a.win,"xhr").getCorsUrl(a.win,b),name:JSON.stringify(wc(a.win,a.element,a.sentinel))}))}
function Ed(a,b){var c=a.O;X(a,"renderSafeFrameStart");var d=a.verifyStillCurrent();return ma(function(){return Fc(b)}).then(function(b){d();var e,h="";switch(c){case "safeframe":e=a.getSafeframePath()+"?n=0";break;case "nameframe":e=xc(a.win);break;default:return z().error("A4A","A4A received unrecognized cross-domain name attribute iframe rendering mode request: %s.  Unable to render a creative for slot %s.",c,a.element.getAttribute("id")),Promise.reject("Unrecognized rendering mode request")}var k=
wc(a.win,a.element,a.sentinel,a.getAdditionalContextMetadata("safeframe"==c));"nameframe"==c?(k.creative=b,h=JSON.stringify(k)):"safeframe"==c&&(k=JSON.stringify(k),h=a.safeframeVersion+";"+b.length+";"+b+(""+k));return Fd(a,D({src:e,name:h}))})}
g.getAmpAdMetadata=function(a){for(var b=-1,c,d=0;d<gd.length&&!(c=gd[d],b=a.lastIndexOf(c),0<=b);d++);if(0>b)return B().warn("amp-a4a",this.element.getAttribute("type"),"Could not locate start index for amp meta data in: %s",a),null;var e=a.lastIndexOf("\x3c/script>");if(0>e)return B().warn("amp-a4a",this.element.getAttribute("type"),"Could not locate closing script tag for amp meta data in: %s",a),null;try{var f=JSON.parse(a.slice(b+c.length,e)),h=f.ampRuntimeUtf16CharOffsets;if(!Array.isArray(h)||
2!=h.length||"number"!==typeof h[0]||"number"!==typeof h[1])throw Error("Invalid runtime offsets");var k={};if(f.customElementExtensions){if(k.customElementExtensions=f.customElementExtensions,!Array.isArray(k.customElementExtensions))throw Error("Invalid extensions",k.customElementExtensions);}else k.customElementExtensions=[];if(f.customStylesheets){k.customStylesheets=f.customStylesheets;var l="Invalid custom stylesheets";if(!Array.isArray(k.customStylesheets))throw Error(l);var m=F(this.getAmpDoc(),
"url");k.customStylesheets.forEach(function(a){if(!v(a)||!a.href||"string"!==typeof a.href||!m.isSecure(a.href))throw Error(l);})}Array.isArray(f.images)&&(k.images=f.images.splice(0,5));if(this.isSinglePageStoryAd){if(!f.ctaUrl||!f.ctaType)throw Error("INVALID-SPSA-RESPONSE");this.element.setAttribute("data-vars-ctatype",f.ctaType);this.element.setAttribute("data-vars-ctaurl",f.ctaUrl)}k.minifiedCreative=a.slice(0,h[0])+a.slice(h[1],b)+a.slice(e+9);return k}catch(n){B().warn("amp-a4a",this.element.getAttribute("type"),
"Invalid amp metadata: %s",a.slice(b+c.length,e));if(this.isSinglePageStoryAd)throw n;return null}};g.getSafeframePath=function(){return"https://tpc.googlesyndication.com/safeframe/"+(this.safeframeVersion+"/html/container.html")};function X(a,b){if(a.na){var c=jd[b],d=Object.assign({time:Math.round(a.Sa())},a.getA4aAnalyticsVars(c));hc(a.element,c,d)}}g.getA4aAnalyticsVars=function(){return{}};g.getA4aAnalyticsConfig=function(){return null};
function yd(a,b){if(AMP.RealTimeConfigManager)try{return(new AMP.RealTimeConfigManager(a)).maybeExecuteRealTimeConfig(a.Ra(),b)}catch(c){z().error("amp-a4a","Could not perform Real Time Config.",c)}else a.element.getAttribute("rtc-config")&&z().error("amp-a4a","RTC not supported for ad network "+a.element.getAttribute("type"))}g.Ra=function(){return{}};g.shouldPreferentialRenderWithoutCrypto=function(){return!1};
g.getNonAmpCreativeRenderingMethod=function(a){if(a){var b;a:{for(b in hd)if(hd[b]===a){b=!0;break a}b=!1}if(b)return a;B().error("AMP-A4A","cross-origin render mode header "+a)}return I(this.win,"platform").isIos()?"nameframe":null};g.getAdditionalContextMetadata=function(){};g.isVerifiedAmpCreative=function(){return this.va};function Bd(a,b){if(!(!b||a.args&&a.args.au)){var c=b.indexOf("?");-1!=c&&((a.args||(a.args={})).au=b.substring(c+1,c+251))}}
function wd(a){return a.AMP_FAST_FETCH_SIGNATURE_VERIFIER_||(a.AMP_FAST_FETCH_SIGNATURE_VERIFIER_=new Hc(a,Zb))};var Gd={medianet:{url:"https://amprtc.media.net/rtb/getrtc?cid=CID&w=ATTR(width)&h=ATTR(height)&ow=ATTR(data-override-width)&oh=ATTR(data-override-height)&ms=ATTR(data-multi-size)&slot=ATTR(data-slot)&tgt=TGT&curl=CANONICAL_URL&to=TIMEOUT&purl=HREF",macros:["CID"],errorReportingUrl:"https://qsearch-a.akamaihd.net/log?logid=kfk&evtid=projectevents&project=amprtc_error&error=ERROR_TYPE&rd=HREF",disableKeyAppend:!0},prebidappnexus:{url:"https://prebid.adnxs.com/pbs/v1/openrtb2/amp?tag_id=PLACEMENT_ID&w=ATTR(width)&h=ATTR(height)&ow=ATTR(data-override-width)&oh=ATTR(data-override-height)&ms=ATTR(data-multi-size)&slot=ATTR(data-slot)&targeting=TGT&curl=CANONICAL_URL&timeout=TIMEOUT&adcid=ADCID&purl=HREF",
macros:["PLACEMENT_ID"],disableKeyAppend:!0},prebidrubicon:{url:"https://prebid-server.rubiconproject.com/openrtb2/amp?tag_id=REQUEST_ID&w=ATTR(width)&h=ATTR(height)&ow=ATTR(data-override-width)&oh=ATTR(data-override-height)&ms=ATTR(data-multi-size)&slot=ATTR(data-slot)&targeting=TGT&curl=CANONICAL_URL&timeout=TIMEOUT&adc=ADCID&purl=HREF",macros:["REQUEST_ID"],disableKeyAppend:!0},indexexchange:{url:"https://amp.casalemedia.com/amprtc?v=1&w=ATTR(width)&h=ATTR(height)&ow=ATTR(data-override-width)&oh=ATTR(data-override-height)&ms=ATTR(data-multi-size)&s=SITE_ID&p=CANONICAL_URL",
macros:["SITE_ID"],disableKeyAppend:!0},lotame:{url:"https://ad.crwdcntrl.net/5/pe=y/c=CLIENT_ID/an=AD_NETWORK",macros:["CLIENT_ID","AD_NETWORK"]},yieldbot:{url:"https://i.yldbt.com/m/YB_PSN/v1/amp/init?curl=CANONICAL_URL&sn=YB_SLOT&w=ATTR(width)&h=ATTR(height)&ow=ATTR(data-override-width)&oh=ATTR(data-override-height)&ms=ATTR(data-multi-size)&aup=ATTR(data-slot)&pvi=PAGEVIEWID&tgt=TGT&adcid=ADCID&href=HREF",macros:["YB_PSN","YB_SLOT"],disableKeyAppend:!0},salesforcedmp:{url:"https://cdn.krxd.net/userdata/v2/amp/ORGANIZATION_ID?segments_key=SEGMENTS_KEY&kuid_key=USER_KEY",
macros:["ORGANIZATION_ID","SEGMENTS_KEY","USER_KEY"],disableKeyAppend:!0},purch:{url:"https://ads.servebom.com/tmntag.js?v=1.2&fmt=amp&o={%22p%22%3APLACEMENT_ID}&div_id=DIV_ID",macros:["PLACEMENT_ID","DIV_ID"],disableKeyAppend:!0},aps:{url:"https://aax.amazon-adsystem.com/e/dtb/bid?src=PUB_ID&amp=1&u=CANONICAL_URL&slots=%5B%7B%22sd%22%3A%22ATTR(data-slot)%22%2C%22s%22%3A%5B%22ATTR(width)xATTR(height)%22%5D%7D%5D&pj=PARAMS",macros:["PUB_ID","PARAMS"],disableKeyAppend:!0},openwrap:{url:"https://ow.pubmatic.com/amp?v=1&w=ATTR(width)&h=ATTR(height)&ms=ATTR(data-multi-size)&auId=ATTR(data-slot)&purl=HREF&pubId=PUB_ID&profId=PROFILE_ID",
macros:["PUB_ID","PROFILE_ID"],errorReportingUrl:"https://ow.pubmatic.com/amp_error?e=ERROR_TYPE&h=HREF",disableKeyAppend:!0},criteo:{url:"https://bidder.criteo.com/amp/rtc?zid=ZONE_ID&nid=NETWORK_ID&psubid=PUBLISHER_SUB_ID&lir=LINE_ITEM_RANGES&w=ATTR(width)&h=ATTR(height)&ow=ATTR(data-override-width)&oh=ATTR(data-override-height)&ms=ATTR(data-multi-size)&slot=ATTR(data-slot)&timeout=TIMEOUT&href=HREF",macros:["ZONE_ID","NETWORK_ID","PUBLISHER_SUB_ID","LINE_ITEM_RANGES"],disableKeyAppend:!0}};var Hd=.01>Math.random();function Id(a){this.K=a;this.h=this.K.win;this.Da={};this.Ca=null;this.Aa=[];this.m=null;this.Na=this.K.getAmpDoc();this.U=null}function Y(a,b,c,d,e){B().warn("real-time-config","RTC callout to "+c+" caused "+b);d&&a.sendErrorMessage(b,d);return Promise.resolve({error:b,callout:c,rtcTime:e||0})}g=Id.prototype;
g.sendErrorMessage=function(a,b){if(Hd){var c={ERROR_TYPE:a,HREF:this.h.location.href};b=Oa(this.Na).expandUrlSync(b,c,{ERROR_TYPE:!0,HREF:!0});(new this.h.Image).src=b}};function Jd(a,b){a=F(a.K.getAmpDoc(),"url").parse(b);return(a.hostname+a.pathname).substr(0,50)}
g.maybeExecuteRealTimeConfig=function(a,b){if(Kd(this,this.K.element))return this.U=b,this.modifyRtcConfigForConsentStateSettings(),a=this.assignMacros(a),this.Ca=Date.now(),this.handleRtcForCustomUrls(a),this.handleRtcForVendorUrls(a),Promise.all(this.Aa)};
g.isValidCalloutForConsentState=function(a,b){var c=a.sendRegardlessOfConsentState;if(!v(a)||!c)return!!b;if("boolean"==typeof c)return c;if(Array.isArray(c)){for(var d=0;d<c.length;d++){if(this.U==$a[c[d]])return!0;$a[c[d]]||B().warn("real-time-config","Invalid RTC consent state given: "+c[d])}return!1}z().warn("real-time-config","Invalid value for sendRegardlessOfConsentState:"+c);return!!b};
g.modifyRtcConfigForConsentStateSettings=function(){var a=this;if(void 0!=this.U&&1!=this.U&&3!=this.U){var b=this.isValidCalloutForConsentState(this.m);this.m.urls=(this.m.urls||[]).filter(function(c){return a.isValidCalloutForConsentState(c,b)});Object.keys(this.m.vendors||{}).forEach(function(c){a.isValidCalloutForConsentState(a.m.vendors[c],b)||delete a.m.vendors[c]})}};
g.assignMacros=function(a){var b=this;a.TIMEOUT=function(){return b.m.timeoutMillis};a.CONSENT_STATE=function(){return b.U};return a};g.handleRtcForCustomUrls=function(a){var b=this;(this.m.urls||[]).forEach(function(c){var d,e;v(c)?(d=c.url,e=c.errorReportingUrl):"string"==typeof c?d=c:B().warn("real-time-config","Invalid url: "+c);Ld(b,d,a,e)})};
g.handleRtcForVendorUrls=function(a){var b=this;Object.keys(this.m.vendors||[]).forEach(function(c){var d=Gd[c.toLowerCase()],e=d?d.url:"",f=d&&d.errorReportingUrl?d.errorReportingUrl:"";if(!e)return b.Aa.push(Y(b,"9",c,f));var h=v(b.m.vendors[c].macros)?b.m.vendors[c].macros:b.m.vendors[c],k={};Object.keys(h).forEach(function(a){if(d.macros&&d.macros.includes(a)){var b=h[a];k[a]=v(b)||Array.isArray(b)?JSON.stringify(b):b}else z().error("real-time-config","Unknown macro: "+a+" for vendor: "+c)});
var l=Object.assign(k,a);Ld(b,e,l,f,c.toLowerCase())})};
function Ld(a,b,c,d,e){function f(b){if(5==Object.keys(a.Da).length)return Y(a,"7",k,d);if(!F(a.K.getAmpDoc(),"url").isSecure(b))return Y(a,"6",k,d);if(a.Da[b])return Y(a,"5",k,d);a.Da[b]=!0;16384<b.length&&(b=b.substr(0,16372).replace(/%\w?$/,""),b+="&__trunc__=1");return Md(a,b,h,k,l,d)}var h=a.m.timeoutMillis,k=e||Jd(a,b),l=a.K.verifyStillCurrent.bind(a.K)(),m={};Object.keys(c).forEach(function(a){return m[a]=!0});var n=Date.now();a.Aa.push(L(a.h).timeoutPromise(h,Oa(a.Na).expandUrlAsync(b,c,m)).then(function(a){l();
h-=n-Date.now();return f(a)}).catch(function(b){return ic(b)?void 0:Y(a,"11",k,d)}))}function Md(a,b,c,d,e,f){return L(a.h).timeoutPromise(c,I(a.h,"xhr").fetchJson(b,{credentials:"include"}).then(function(b){e();return b.text().then(function(b){e();var c=Date.now()-a.Ca;return b?(b=P(b))?{response:b,rtcTime:c,callout:d}:Y(a,"4",d,f,c):{rtcTime:c,callout:d}})})).catch(function(b){return ic(b)?void 0:Y(a,/^timeout/.test(b.message)?"10":"8",d,f,Date.now()-a.Ca)})}
function Kd(a,b){var c=1E3,d=b.getAttribute("rtc-config");if(!d)return!1;var e=P(d);if(!e)return z().warn("real-time-config","Could not JSON parse rtc-config attribute"),!1;var f;try{z().assert(e.vendors||e.urls,"RTC Config must specify vendors or urls");Object.keys(e).forEach(function(a){switch(a){case "vendors":z().assert(v(e[a]),"RTC invalid vendors");break;case "urls":z().assert(Array.isArray(e[a]),"RTC invalid urls");break;case "timeoutMillis":f=parseInt(e[a],10);if(isNaN(f))z().warn("real-time-config",
"Invalid RTC timeout is NaN, "+("using default timeout "+c+"ms")),f=void 0;else if(f>=c||0>f)z().warn("real-time-config","Invalid RTC timeout: "+f+"ms, "+("using default timeout "+c+"ms")),f=void 0;break;default:z().warn("real-time-config","Unknown RTC Config key: "+a)}});if(!Object.keys(e.vendors||{}).length&&!(e.urls||[]).length)return!1;var h=function(b){var c=b.errorReportingUrl;c&&!F(a.K.getAmpDoc(),"url").isSecure(c)&&(B().warn("real-time-config","Insecure RTC errorReportingUrl: "+c),b.errorReportingUrl=
void 0)};(e.urls||[]).forEach(function(a){v(a)&&h(a)});h(e)}catch(k){return!1}e.timeoutMillis=void 0!==f?f:c;a.m=e;return!0}AMP.RealTimeConfigManager=Id;var Nd=Date.now();function Od(a,b){this.Oa=a;var c=b&&b.threshold,c=c?Array.isArray(c)?c:[c]:[0];for(a=0;a<c.length;a++)fa(c[a]);this.nb=c.sort();this.za=null;this.Wa=void 0;this.H=[]}Od.prototype.disconnect=function(){this.H.length=0};Od.prototype.observe=function(a){for(var b=0;b<this.H.length;b++)if(this.H[b].element===a){B().warn("INTERSECTION-OBSERVER","should observe same element once");return}var c={element:a,currentThresholdSlot:0};this.za&&(a=Pd(this,c,this.za,this.Wa))&&this.Oa([a]);this.H.push(c)};
Od.prototype.unobserve=function(a){for(var b=0;b<this.H.length;b++)if(this.H[b].element===a){this.H.splice(b,1);return}B().warn("INTERSECTION-OBSERVER","unobserve non-observed element")};Od.prototype.tick=function(a,b){b&&(a=T(a,-b.left,-b.top),b=T(b,-b.left,-b.top));this.za=a;this.Wa=b;for(var c=[],d=0;d<this.H.length;d++){var e=Pd(this,this.H[d],a,b);e&&c.push(e)}c.length&&this.Oa(c)};
function Pd(a,b,c,d){var e=b.element,f=null,h=e.getLayoutBox(),k=e.getOwner(),f=k&&k.getLayoutBox(),l=qc(h,f,c,d)||pc(0,0,0,0),k=l,m=h,k=k.width*k.height/(m.width*m.height);a=a.nb;var m=0,n=a.length;if(0==k)a=0;else{for(var p=(m+n)/2|0;m<p;)k<a[p]?n=p:m=p,p=(m+n)/2|0;a=n}var t=a;if(t==b.currentThresholdSlot)return null;b.currentThresholdSlot=t;c=d?null:c;d=l;a=h;if(m=c)d=T(d,-c.left,-c.top),a=T(a,-c.left,-c.top),m=T(m,-c.left,-c.top);var w={time:"undefined"!==typeof performance&&performance.now?performance.now():
Date.now()-Nd,rootBounds:m,boundingClientRect:a,intersectionRect:d,intersectionRatio:k,target:e};return w};function Qd(a,b,c){this.ga=new Od(a,c);this.Za={};this.o=b.getViewport();this.Ja=!1}Qd.prototype.observe=function(a){var b=this,c=a.getAttribute("data-amp-ad-refresh-id");if(!this.Za[c]){var d=a.viewportCallback.bind(a);this.Za[c]=d;a.viewportCallback=function(a){b.Ja&&b.ga.tick(b.o.getRect());d(a)}}this.Ja=!0;this.ga.observe(a);this.ga.tick(this.o.getRect())};Qd.prototype.unobserve=function(a){this.ga.tick(this.o.getRect());this.ga.unobserve(a);this.Ja=!1};function Rd(a,b){var c=a.getAttribute("data-enable-refresh");if(c)return Sd(c);var d,e=(d=b.document.getElementsByName("amp-ad-enable-refresh"))&&d[0]&&d[0].getAttribute("content");if(!e)return null;var f=e.split(",");for(b=0;b<f.length;b++){var h=f[b].split("=");z().assert(2==h.length,"refresh metadata config must be of the form `network_type=refresh_interval`");if(h[0].toLowerCase()==a.getAttribute("type").toLowerCase())return Sd(h[1])}return null}
function Sd(a){var b=Number(a);return isNaN(b)||30>b?(z().warn("AMP-AD","invalid refresh interval, must be a number no less than 30: "+a),null):1E3*b}var Td={},Ud={},Vd=0;function Wd(a,b){var c=Rd(a.element,a.win);return!c||b&&!b()?null:new Xd(a,{visiblePercentageMin:50,continuousTimeMin:1},c)}
function Xd(a,b,c){this.ba="initial";this.Ma=a;this.h=a.win;this.fa=a.element;this.pb=this.fa.getAttribute("type").toLowerCase();this.jb=c;b.continuousTimeMin*=1E3;b.visiblePercentageMin/=100;this.ca=b;this.Ga=L(this.h);this.La=this.kb=null;var d=String(Vd++);this.fa.setAttribute("data-amp-ad-refresh-id",d);Ud[d]=this;this.initiateRefreshCycle()}
function Yd(a,b){var c=String(b);return Td[c]||(Td[c]="IntersectionObserver"in a.h?new a.h.IntersectionObserver(a.Ua,{threshold:b}):new Qd(a.Ua,a.Ma,{threshold:b}))}
Xd.prototype.Ua=function(a){a.forEach(function(a){var b=a.target.getAttribute("data-amp-ad-refresh-id"),d=Ud[b];if(a.target==d.fa)switch(d.ba){case "initial":a.intersectionRatio>=d.ca.visiblePercentageMin&&(d.ba="view_pending",d.La=d.Ga.delay(function(){d.ba="refresh_pending";Zd(d)},d.ca.continuousTimeMin));break;case "view_pending":a.intersectionRatio<d.ca.visiblePercentageMin&&(d.Ga.cancel(d.La),d.La=null,d.ba="initial")}})};
Xd.prototype.initiateRefreshCycle=function(){switch(this.ba){case "initial":Yd(this,this.ca.visiblePercentageMin).observe(this.fa)}};function Zd(a){new Promise(function(b){a.kb=a.Ga.delay(function(){a.ba="initial";a.unobserve();a.Ma.refresh(function(){return a.initiateRefreshCycle()});b(!0)},a.jb)})}Xd.prototype.unobserve=function(){Yd(this,this.ca.visiblePercentageMin).unobserve(this.fa)};function $d(a,b){b.document.documentElement.addEventListener("click",ae.bind(null,a),!0)}function ae(a,b){var c=Ha(b.target);if(c&&c.href){var d=c.getAttribute("data-a4a-orig-href")||c.getAttribute("href");d&&(a=Oa(a).expandUrlSync(d,{CLICK_X:function(){return b.pageX},CLICK_Y:function(){return b.pageY}},void 0,{CLICK_X:!0,CLICK_Y:!0}),a!=d&&(c.getAttribute("data-a4a-orig-href")||c.setAttribute("data-a4a-orig-href",d),c.setAttribute("href",a)))}};var be={},ce=!1;function de(a){var b=P(a.data);if("https://tpc.googlesyndication.com"==a.origin&&b){a=P(b.p)||{};var c=b.e||a.sentinel,d=be[c];d?d.channel?a&&d.processMessage(a,b.s):d.connectMessagingChannel(b.c):B().warn("AMP-DOUBLECLICK-SAFEFRAME","Safeframe Host for sentinel: "+c+" not found.")}}
function ee(a,b,c){this.j=a;this.qa=this.j.verifyStillCurrent.bind(this.j)();this.h=this.j.win;this.ka=this.j.sentinel;this.ea=this.channel=this.B=null;this.cb=Math.random();this.Ha=Math.random();this.ib=b;this.l=c;this.sa=Object.assign({},c);this.qb=null;this.o=this.j.getViewport();this.W=!0;this.ua=!1;var d=Object(P(this.j.element.getAttribute("data-safeframe-config"))||{});this.Pa=C.call(d,"expandByOverlay")?d.expandByOverlay:!0;this.Qa=C.call(d,"expandByPush")?d.expandByPush:!0;this.Ia=null;this.registerSafeframeHost()}
g=ee.prototype;
g.getSafeframeNameAttr=function(){var a=D({});a.uid=this.Ha;a.hostPeerName=this.h.location.origin;a.initialGeometry=this.getInitialGeometry();a.permissions=JSON.stringify(D({expandByOverlay:this.Pa,expandByPush:this.Qa,readCookie:!1,writeCookie:!1}));a.metadata=JSON.stringify(D({shared:{sf_ver:this.j.safeframeVersion,ck_on:1,flash_ver:"26.0.0",canonical_url:this.maybeGetCanonicalUrl(),amp:{canonical_url:this.maybeGetCanonicalUrl()}}}));a.reportCreativeGeometry=this.ib;a.isDifferentSourceWindow=!1;
a.sentinel=this.ka;return a};g.maybeGetCanonicalUrl=function(){var a=K(this.j.getAmpDoc()).canonicalUrl,b=this.h.document.querySelector("meta[name='referrer']");if(!b)return a;switch(b.getAttribute("content")){case "same-origin":return;case "no-referrer":return;case "origin":return O(a).origin}return a};
g.getInitialGeometry=function(){var a=this.j.getPageLayoutBox(),b=(a.height-this.l.height)/2,c=(a.width-this.l.width)/2,d={top:a.top+b,bottom:a.bottom-b,left:a.left+c,right:a.right-c,height:this.sa.height,width:this.sa.width};return fe(this,d)};g.registerSafeframeHost=function(){be[this.ka]=be[this.ka]||this;ce||(ce=!0,this.h.addEventListener("message",de,!1))};g.connectMessagingChannel=function(a){this.B=this.j.iframe;this.channel=a;ge(this);he(this,{message:"connect",c:this.channel},"")};
function ge(a){var b=sc(a.h,a.Ya.bind(a)),c=a.o.onScroll(b),d=a.o.onChanged(b);a.Ia=function(){c();d()};a.Ya()}g.Ya=function(){var a=this;this.B&&this.o.getClientRectAsync(this.B).then(function(b){a.qa();var c=fe(a,b);he(a,{newGeometry:c,uid:a.Ha},"geometry_update")}).catch(function(a){return B().error("AMP-DOUBLECLICK-SAFEFRAME",a)})};
function fe(a,b){var c=a.o.getSize(),d=a.o.getScrollLeft(),e=a.o.getScrollTop(),f={windowCoords_t:0,windowCoords_r:c.width,windowCoords_b:c.height,windowCoords_l:0,frameCoords_t:b.top+e,frameCoords_r:b.right+d,frameCoords_b:b.bottom+e,frameCoords_l:b.left+d,posCoords_t:b.top,posCoords_b:b.bottom,posCoords_r:b.right,posCoords_l:b.left,styleZIndex:ec(a.j.element,"zIndex"),allowedExpansion_r:c.width-b.width,allowedExpansion_b:c.height-b.height,allowedExpansion_t:0,allowedExpansion_l:0,yInView:a.getPercInView(c.height,
b.top,b.bottom),xInView:a.getPercInView(c.width,b.left,b.right)};a.ea=f;return JSON.stringify(f)}g.getPercInView=function(a,b,c){var d=c>=a?a-b:c,e=d/(c-b);return Math.max(0,Math.min(1,e))||0};function he(a,b,c){if(a.B.contentWindow){var d={};d.c=a.channel;d.p=JSON.stringify(b);d.s=c;d.e=a.ka;d.i=a.cb;a.B.contentWindow.postMessage(JSON.stringify(d),"https://tpc.googlesyndication.com")}else B().error("AMP-DOUBLECLICK-SAFEFRAME","Frame contentWindow unavailable.")}
g.processMessage=function(a,b){switch(b){case "creative_geometry_update":ie(this,a);break;case "expand_request":if(this.ua){b=Number(this.l.height)+a.expand_b+a.expand_t;var c=Number(this.l.width)+a.expand_r+a.expand_l;isNaN(b)||isNaN(c)||a.push&&!this.Qa||!a.push&&!this.Pa&&(c>this.l.width||b>this.l.height)?(B().error("AMP-DOUBLECLICK-SAFEFRAME","Invalid expand values."),this.sendResizeResponse(!1,"expand_response")):b>this.o.getSize().height||c>this.o.getSize().width?this.sendResizeResponse(!1,
"expand_response"):this.handleSizeChange(b,c,"expand_response")}break;case "register_done":this.ua=!0;break;case "collapse_request":this.W||!this.ua?this.sendResizeResponse(!1,"collapse_response"):this.handleSizeChange(this.sa.height,this.sa.width,"collapse_response",!0);break;case "resize_request":this.ua&&(b=Number(this.l.height)+(a.resize_b+a.resize_t),a=Number(this.l.width)+(a.resize_r+a.resize_l),isNaN(a)||isNaN(b)||a>this.l.width||b>this.l.height?B().error("AMP-DOUBLECLICK-SAFEFRAME","Invalid resize values."):
this.resizeAmpAdAndSafeframe(b,a,"resize_response",!0))}};g.resizeSafeframe=function(a,b,c){var d=this;this.W="collapse_response"==c;this.j.measureMutateElement(function(){d.j.getResource().measure()},function(){d.B&&(fc(d.B,{height:a+"px",width:b+"px"}),d.l.height=a,d.l.width=b);d.sendResizeResponse(!0,c)},this.B)};
g.handleSizeChange=function(a,b,c,d){var e=this;return this.o.getClientRectAsync(this.j.element).then(function(f){!d&&b<=f.width&&a<=f.height?e.resizeSafeframe(a,b,c):e.resizeAmpAdAndSafeframe(a,b,c,d)})};
g.sendResizeResponse=function(a,b){var c=this;this.B&&this.o.getClientRectAsync(this.B).then(function(d){c.qa();d=fe(c,d);he(c,{uid:c.Ha,success:a,newGeometry:d,expand_t:c.ea.allowedExpansion_t,expand_b:c.ea.allowedExpansion_b,expand_r:c.ea.allowedExpansion_r,expand_l:c.ea.allowedExpansion_l,push:!0},b)}).catch(function(a){return B().error("AMP-DOUBLECLICK-SAFEFRAME",a)})};
g.resizeAmpAdAndSafeframe=function(a,b,c,d){var e=this;this.j.attemptChangeSize(a,b).then(function(){e.qa();e.resizeSafeframe(a,b,c)},function(){e.j.getResource().resetPendingChangeSize();d?e.resizeSafeframe(a,b,c):e.sendResizeResponse(!1,c)}).catch(function(a){"CANCELLED"==a.message?B().error("AMP-DOUBLECLICK-SAFEFRAME",a):(B().error("AMP-DOUBLECLICK-SAFEFRAME","Resizing failed: "+a),e.sendResizeResponse(!1,c))})};
function ie(a,b){var c;b&&(c=parseInt(b.height,10))?a.j.attemptChangeHeight(c).then(function(){a.qa();var b=c,e=a.j.iframe;(parseInt(ec(e,"height"),10)||0)!=b&&fc(e,{height:b+"px"});a.j.fireFluidDelayedImpression();a.B.contentWindow.postMessage(JSON.stringify(D({message:"resize-complete",c:a.channel})),"https://tpc.googlesyndication.com")}).catch(function(b){"CANCELLED"==b.message?B().error("AMP-DOUBLECLICK-SAFEFRAME",b):a.j.forceCollapse()}):a.j.forceCollapse()}
g.destroy=function(){this.B=null;delete be[this.ka];this.Ia&&this.Ia();0==Object.keys(be).length&&(window.removeEventListener("message",de,!1),ce=!1)};var ve=[je,ke,le,me,ne,oe,pe,qe,re,se,te,ue];function we(a){var b={output:"ldjh",impl:"fifs"};ve.forEach(function(c){return Object.assign(b,c(a))});return b}function xe(a,b){for(var c=0;c<a.length;c++){var d=b(a[c]);if(d)return d}return null}
function je(a){var b={},c=[],d=0,e=[];a.forEach(function(a){var f=a.element.getAttribute("data-slot"),k=f.split("/"),l=[];for(a=0;a<k.length;a++)if(""!=k[a]){var m=b[k[a]];void 0==m&&(c.push(k[a]),b[k[a]]=m=d++);l.push(m)}e.push(l.join("/"))});return{iu_parts:c.join(),enc_prev_ius:e.join()}}function ke(a){return xe(a,function(a){return a.jsonTargeting&&a.jsonTargeting.cookieOptOut?{co:"1"}:null})}function le(a){return{adks:a.map(function(a){return a.adKey}).join()}}
function me(a){return{prev_iu_szs:a.map(function(a){return a.parameterSize}).join()}}function ne(a){return xe(a,function(a){return a.jsonTargeting&&a.jsonTargeting.tagForChildDirectedTreatment?{tfcd:a.jsonTargeting.tagForChildDirectedTreatment}:null})}function oe(a){return xe(a,function(a){return Xb(a.element)?{adtest:"on"}:null})}
function pe(a){var b=!1,c=[];a.forEach(function(a){a.jsonTargeting&&(a.jsonTargeting.targeting||a.jsonTargeting.categoryExclusions)?(b=!0,c.push(ye(a.jsonTargeting.targeting||null,a.jsonTargeting.categoryExclusions||null))):c.push("")});return b?{prev_scp:c.join("|")}:null}
function qe(a){var b={},c=a.length&&/(?:#|,)deid=([\d,]+)/i.exec(a[0].win.location.hash)||[];(c[1]||"").split(",").forEach(function(a){return a&&(b[a]=1)});a.forEach(function(a){return a.experimentIds.forEach(function(a){return b[a]=1})});var d=Object.keys(b).join();return d?{eid:d}:null}function re(a){return xe(a,function(a){return a.buildIdentityParams()})}function se(a){var b=!1,c=[];a.forEach(function(a){b=b||a.forceSafeframe;c.push(Number(a.forceSafeframe))});return b?{fsfs:c.join()}:null}
function te(a){var b=[],c=[];a.forEach(function(a){var d=a.getPageLayoutBox();b.push(d.left);c.push(d.top)});return{adxs:b.join(),adys:c.join()}}function ue(a){var b=!1,c=[];a.forEach(function(a){a=Ab(a.element);c.push(a.join());b=b||!!a.length});return b?{acts:c.join("|")}:null}function ye(a,b){var c=a?Object.keys(a).map(function(b){return ze(b,a[b])}):[];b&&c.push(ze("excl_cat",b));return c.length?c.join("&"):null}
function ze(a,b){var c=(Array.isArray(b)?b:[b]).map(encodeURIComponent).join();return encodeURIComponent(a)+"="+c}
function Ae(a,b,c,d,e){var f=Object.keys(b);1==f.length&&v(b[f[0]])&&(b=b[f[0]],b=Object.keys(b).reduce(function(a,c){a[c.toLowerCase()]=b[c];return a},{}));b["x-ampadrender"]="safeframe";d.shift()({headers:{get:function(a){(a=b[a.toLowerCase()])&&"string"!=typeof a&&(a=JSON.stringify(a));return a},has:function(a){return!!b[a.toLowerCase()]}},arrayBuffer:function(){return ma(function(){return"undefined"!==typeof TextEncoder?(new TextEncoder("utf-8")).encode(a):Gc(unescape(encodeURIComponent(a)))})}});
c&&d.length&&B().warn("amp-ad-network-doubleclick-impl","Premature end of SRA response",d.length,e)};var Be={SRA_CONTROL:"117152666",SRA:"117152667",SRA_NO_RECOVER:"21062235"},Z={},Ce=null,De;
function Ee(a){a=W.call(this,a)||this;a.T=null;a.fb=Ma(a.win);a.$=null;a.R=null;a.parameterSize=null;a.aa=null;a.oa=null;a.jsonTargeting=null;a.adKey=0;a.experimentIds=[];a.useSra=!1;a.sraDeferred=new E;a.ha=null;a.Xa=0;a.V=0;a.C=!1;a.X=!1;a.ra=null;a.Ta=null;a.identityToken=null;a.G={};a.ya=null;a.Y=!1;a.I=null;a.forceSafeframe=!1;"forceSafeframe"in a.element.dataset&&(/^(1|(true))$/i.test(a.element.dataset.forceSafeframe)?a.forceSafeframe=!0:z().warn("amp-ad-network-doubleclick-impl","Ignoring invalid data-force-safeframe attribute: "+
a.element.dataset.forceSafeframe));a.consentState=null;a.getAdUrlDeferred=new E;a.Ba=!1;a.Ea=!1;return a}aa(Ee,W);function Fe(a){if(a.Y)return a.Y;if(a.element.getAttribute("data-loading-strategy"))return!1;var b=a.postAdResponseExperimentFeatures["render-idle-vp"],c=parseInt(b,10);return b&&isNaN(c)?!1:c||12}g=Ee.prototype;
g.idleRenderOutsideViewport=function(){var a=this,b=Fe(this);if(!1===b)return b;this.Y=!0;this.getResource().whenWithinViewport(this.renderOutsideViewport()).then(function(){return a.Y=!1});return b};g.isLayoutSupported=function(a){this.X="fluid"==a;this.C=this.C||this.X;return this.X||uc(a)};g.isValidElement=function(){return this.isAmpAdElement()};
g.setPageLevelExperiments=function(){var a=this;xb.test(this.win.location.origin)||S(this.win,"expDfpInvOrigDeprecated")||this.experimentIds.push("21060933");var b={},b=(b.doubleclickSraExp={isTrafficEligible:function(){return!a.win.document.querySelector("meta[name=amp-ad-enable-refresh], amp-ad[type=doubleclick][data-enable-refresh], meta[name=amp-ad-doubleclick-sra]")},branches:Object.keys(Be).map(function(a){return Be[a]})},b),c=ub(this.win,b);Object.keys(c).forEach(function(b){return c[b]&&a.experimentIds.push(c[b])})};
function Ge(a){function b(a){return z().warn("amp-ad-network-doubleclick-impl",a+" is no longer supported for DoubleClick.Please refer to https://github.com/ampproject/amphtml/issues/11834 for more information")}var c="useSameDomainRenderingUntilDeprecated",d=c in a.element.dataset||(P(a.element.getAttribute("json"))||{})[c];d&&b(c);a.win.document.querySelector("meta[name=amp-3p-iframe-src]")&&b("remote.html")}
g.buildCallback=function(){var a=this;W.prototype.buildCallback.call(this);Ge(this);this.setPageLevelExperiments();this.useSra=!!this.win.document.querySelector("meta[name=amp-ad-doubleclick-sra]")||!!this.experimentIds.filter(function(a){return"117152667"==a||"21062235"==a}).length;this.Ta=M(this.getAmpDoc()).whenFirstVisible().then(function(){return Tb(a.win,a.getAmpDoc(),W.prototype.getConsentPolicy.call(a))});this.G.slotId=this.element.getAttribute("data-slot");this.G.slotIndex=this.element.getAttribute("data-amp-slot-index");
if(!this.C){var b=this.element.getAttribute("data-multi-size");this.C=!!b&&-1!=b.indexOf("fluid")}};g.shouldPreferentialRenderWithoutCrypto=function(){xb.test(this.win.location.origin);return!0};g.getPageParameters=function(a,b){b=b||[this];var c=this.win.devicePixelRatio,d=this.getLocationQueryParameterValue("google_preview")||null,e=b,f=[],h;for(h in Z)e.includes(Z[h])||f.push(h);return{npa:2==a||4==a?1:null,gdfp_req:"1",sfv:"1-0-23",u_sd:c,gct:d,psts:f}};
function He(a){var b=a.jsonTargeting&&a.jsonTargeting.tagForChildDirectedTreatment;a.win.ampAdGoogleIfiCounter=a.win.ampAdGoogleIfiCounter||1;a.V=a.isRefreshing&&a.V||a.win.ampAdGoogleIfiCounter++;var c=a.isSinglePageStoryAd?a.element.getPageLayoutBox():null;return Object.assign({iu:a.element.getAttribute("data-slot"),co:a.jsonTargeting&&a.jsonTargeting.cookieOptOut?"1":null,adk:a.adKey,sz:a.isSinglePageStoryAd?"1x1":a.parameterSize,output:"html",impl:"ifr",tfcd:void 0==b?null:b,adtest:Xb(a.element)?
"on":null,ifi:a.V,rc:a.Xa||null,frc:Number(a.fromResumeCallback)||null,fluid:a.C?"height":null,fsf:a.forceSafeframe?"1":null,scp:ye(a.jsonTargeting&&a.jsonTargeting.targeting||null,a.jsonTargeting&&a.jsonTargeting.categoryExclusions||null),spsa:a.isSinglePageStoryAd?c.width+"x"+c.height:null},zb(a))}
g.populateAdUrlState=function(a){this.consentState=a;a=Number(this.element.getAttribute("data-override-width"))||Number(this.element.getAttribute("width"));var b=Number(this.element.getAttribute("data-override-height"))||Number(this.element.getAttribute("height"));this.R=this.X?{width:0,height:0}:a&&b?{width:a,height:b}:this.getIntersectionElementLayoutBox();this.jsonTargeting=P(this.element.getAttribute("json"))||{};this.adKey=Ie(this,this.R.width+"x"+this.R.height);this.parameterSize=this.X?"320x50":
this.R.width+"x"+this.R.height;if(a=this.element.getAttribute("data-multi-size"))"responsive"==this.element.getAttribute("layout")&&(z().warn("amp-ad-network-doubleclick-impl","Behavior of multi-size and responsive layout is currently not well defined. Forcefully overriding layout to `fixed`."),this.element.setAttribute("layout","fixed")),b=this.element.getAttribute("data-multi-size-validation")||"true",a=nc(a,this.R.width,this.R.height,"true"==b,this.X),a.length&&(this.parameterSize+="|"+a.map(function(a){return a.join("x")}).join("|"))};
g.getConsentPolicy=function(){return null};
g.getAdUrl=function(a,b){var c=this;if(4==a&&"true"!=this.element.getAttribute("data-npa-on-unknown-consent"))return z().info("amp-ad-network-doubleclick-impl","Ad request suppressed due to unknown consent"),this.getAdUrlDeferred.resolve(""),Promise.resolve("");if(this.iframe&&!this.isRefreshing)return B().warn("amp-ad-network-doubleclick-impl","Frame already exists, sra: "+this.useSra),this.getAdUrlDeferred.resolve(""),Promise.resolve("");b=b||Promise.resolve();this.populateAdUrlState(a);var d=Date.now(),
e=L(this.win).timeoutPromise(1E3,this.Ta).catch(function(){return{}}),f=this.verifyStillCurrent();Promise.all([b,e]).then(function(b){f();var e=Je(c,b[0]);c.identityToken=b[1];Lb(c,d,Object.assign(He(c),c.buildIdentityParams(),c.getPageParameters(a),e),c.experimentIds).then(function(a){return c.getAdUrlDeferred.resolve(a)})});return this.G.adUrl=this.getAdUrlDeferred.promise};
g.buildIdentityParams=function(){return this.identityToken?{adsid:this.identityToken.token||null,jar:this.identityToken.jar||null,pucrd:this.identityToken.pucrd||null}:{}};
function Je(a,b){if(!b)return null;var c=[],d=[],e=[],f;b.forEach(function(b){if(b&&(c.push(b.rtcTime),d.push(b.error||"2"),e.push(b.callout),b.response)){if(b.response.targeting){var h=Ke(b.response.targeting,b.callout);a.jsonTargeting.targeting=a.jsonTargeting.targeting?la(a.jsonTargeting.targeting,h):h}b.response.categoryExclusions&&(f||(f={},a.jsonTargeting.categoryExclusions&&a.jsonTargeting.categoryExclusions.forEach(function(a){f[a]=!0})),b.response.categoryExclusions.forEach(function(a){f[a]=
!0}))}});f&&(a.jsonTargeting.categoryExclusions=Object.keys(f));return{artc:c.join()||null,ati:d.join(),ard:e.join()}}
g.Ra=function(){var a=this,b={height:!0,width:!0,"data-slot":!0,"data-multi-size":!0,"data-multi-size-validation":!0,"data-override-width":!0,"data-override-height":!0};return{PAGEVIEWID:function(){return K(a.element).pageViewId},HREF:function(){return a.win.location.href},REFERRER:function(b){return Le(a,b)},TGT:function(){return JSON.stringify((P(a.element.getAttribute("json"))||{}).targeting)},ADCID:function(b){return fb(a.getAmpDoc(),parseInt(b,10))},ATTR:function(c){if(b[c.toLowerCase()])return a.element.getAttribute(c);
B().warn("TAG","Invalid attribute "+c)},CANONICAL_URL:function(){return K(a.element).canonicalUrl}}};function Le(a,b){var c=parseInt(b,10);b=M(a.getAmpDoc()).getReferrerUrl();return isNaN(c)||0>c?b:L(a.win).timeoutPromise(c,b).catch(function(){})}function Ke(a,b){if(!Gd[b]||Gd[b].disableKeyAppend)return a;var c={};Object.keys(a).forEach(function(d){c[d+"_"+b]=a[d]});return c}
g.onNetworkFailure=function(a,b){B().info("amp-ad-network-doubleclick-impl","network error, attempt adding of error parameter",a);a=(new RegExp("[?|&]("+encodeURIComponent(db.name)+"="+(encodeURIComponent(String(db.value))+"|aet=[^&]*)$"))).test(b)?void 0:b+"&aet=n";return{adUrl:a}};
g.extractSize=function(a){this.T=Qb(a);this.$=a.get("X-QQID");this.Ea="true"==a.get("amp-ff-sandbox");this.G.creativeId=a.get("google-creative-id")||"-1";this.G.lineItemId=a.get("google-lineitem-id")||"-1";this.T&&this.fb.installExtensionForDoc(this.getAmpDoc(),"amp-analytics");var b=W.prototype.extractSize.call(this,a);b?(this.aa=b,Me(this,b.width,b.height)):b=this.getSlotSize();this.C&&!this.aa&&(this.ra=a.get("X-AmpImps"));a.get("amp-ff-pageview-tokens")&&(this.removePageviewStateToken(),this.setPageviewStateToken(a.get("amp-ff-pageview-tokens")));
return b};g.sandboxHTMLCreativeFrame=function(){return this.Ea};g.getSlotSize=function(){var a=Number(this.element.getAttribute("width")),b=Number(this.element.getAttribute("height"));return a&&b?{width:a,height:b}:this.getIntersectionElementLayoutBox()};
g.tearDownSlot=function(){W.prototype.tearDownSlot.call(this);this.element.setAttribute("data-amp-slot-index",this.win.ampAdSlotIdCounter++);if(this.oa){var a=this.oa;a.parentElement&&a.parentElement.removeChild(a);this.oa=null}this.ya=this.jsonTargeting=this.T=null;this.Y=!1;this.$=this.sraDeferred=Ce=this.aa=this.parameterSize=null;this.Ea=!1;this.consentState=null;this.getAdUrlDeferred=new E;this.removePageviewStateToken()};
g.renderNonAmpCreative=function(){var a=this;if(this.postAdResponseExperimentFeatures["render-idle-throttle"]&&this.Y){if(this.win["3pla"])return(Ac||Promise.resolve()).then(function(){return W.prototype.renderNonAmpCreative.call(a)});Cc(this.win);return W.prototype.renderNonAmpCreative.call(this,!0)}return W.prototype.renderNonAmpCreative.call(this)};g.layoutCallback=function(){var a=this;return W.prototype.layoutCallback.call(this).then(function(b){Ne(a);return b})};
g.viewportCallback=function(a){W.prototype.viewportCallback.call(this,a);this.Ba&&!a&&Ne(this)};g.unlayoutCallback=function(){this.ha&&this.ha.unobserve();if(!this.useSra&&this.ya)return!1;this.I&&(this.I.destroy(),this.I=null);return W.prototype.unlayoutCallback.call(this)};g.cleanupAfterTest=function(){this.I&&(this.I.destroy(),this.I=null)};g.refresh=function(a){this.Xa++;return W.prototype.refresh.call(this,a)};
g.onCreativeRender=function(a){var b=this;W.prototype.onCreativeRender.call(this,a);this.ya=!!a;a&&!a.customElementExtensions.includes("amp-ad-exit")&&$d(this.getAmpDoc(),this.iframe.contentWindow);this.T&&(yb(this)&&Rb(this.win,this.element,this.T,this.$,!!a),this.oa=Kc(this.element,this.T,!!this.postAdResponseExperimentFeatures.avr_disable_immediate));this.isRefreshing&&(this.ha.initiateRefreshCycle(),this.isRelayoutNeededFlag=this.isRefreshing=!1);a=this.aa||this.getSlotSize();var c=this.C&&this.aa&&
!(0==a.width&&0==a.height);fc(this.iframe,{width:a.width+"px",height:a.height+"px",position:c?"relative":null});this.$&&this.element.setAttribute("data-google-query-id",this.$);this.iframe.id="google_ads_iframe_"+this.V;c&&(this.element.removeAttribute("height"),fc(this.element,{width:a.width+"px"}));this.ha=this.ha||Wd(this,function(){return b.useSra?(z().warn("amp-ad-network-doubleclick-impl","Refresh not compatible with SRA."),!1):Ab(b.element).filter(function(a){return a!=vb["AMP-CAROUSEL"]&&
a!=vb["AMP-STICKY-AD"]}).length?(z().warn("amp-ad-network-doubleclick-impl","Refresh not compatible with ad-containers, except for AMP-CAROUSEL and AMP-STICKY-AD"),!1):!0});this.postTroubleshootMessage()};
function Ne(a){a.C&&!a.aa&&a.isVerifiedAmpCreative()?a.iframe&&a.iframe.contentWindow&&a.iframe.contentWindow.document&&a.iframe.contentWindow.document.body?a.attemptChangeHeight(a.iframe.contentWindow.document.body.scrollHeight).then(function(){a.fireFluidDelayedImpression();a.Ba=!1}).catch(function(){a.Ba=!0}):(B().error("amp-ad-network-doubleclick-impl","Attempting to expand fluid creative without a properly set up friendly frame. Slot id: "+a.element.getAttribute("data-amp-slot-index")),Promise.reject("Cannot access body of friendly frame")):
Promise.resolve()}function Ie(a,b){a=a.element;var c=ab(a),d=a.getAttribute("data-slot")||"",e=a.getAttribute("data-multi-size")||"";return Da(d+":"+b+":"+e+":"+c)}function Me(a,b,c){var d=a.element.getAttribute("width"),e=a.element.getAttribute("height");(a.C&&b&&c||(b!=d||c!=e)&&b<=d&&c<=e)&&a.attemptChangeSize(c,b).catch(function(){})}
g.sendXhrRequest=function(a){var b=this;if(!this.useSra)return W.prototype.sendXhrRequest.call(this,a);this.sraDeferred=new E;var c=this.verifyStillCurrent();this.initiateSraRequests().then(function(){c();b.sraDeferred||(B().warn("amp-ad-network-doubleclick-impl","SRA failed to include element "+b.V),S(b.win,"doubleclickSraReportExcludedBlock")&&b.getAmpDoc().getBody().appendChild(J(b.win.document,"amp-pixel",D({src:"https://pagead2.googlesyndication.com/pagead/gen_204?"+("id="+encodeURIComponent("a4a::sra")+
"&ifi="+b.V)}))))});return this.sraDeferred.promise.then(function(d){c();b.sraDeferred=null;return d||W.prototype.sendXhrRequest.call(b,a)})};g.fireDelayedImpressions=function(a,b){var c=this;a&&a.split(",").forEach(function(a){try{F(c.getAmpDoc(),"url").isSecure(a)?c.win.document.body.appendChild(J(c.win.document,"amp-pixel",D({src:a,referrerpolicy:b?"no-referrer":""}))):B().warn("amp-ad-network-doubleclick-impl","insecure impression url: "+a)}catch(e){}})};
g.fireFluidDelayedImpression=function(){this.ra&&(this.fireDelayedImpressions(this.ra),this.ra=null)};g.groupSlotsForSra=function(){return Cb(this.win,this.element.getAttribute("type"))};
g.initiateSraRequests=function(){var a=this,b=this.verifyStillCurrent(),c=this.experimentIds.includes("21062235");return Ce=Ce||this.groupSlotsForSra().then(function(d){b();var e=[];Object.keys(d).forEach(function(f){var h=d[f];e.push(Promise.all(h).then(function(d){b();var e=d.filter(function(a){var b=a.hasAdPromise();b||B().info("amp-ad-network-doubleclick-impl","Ignoring instance without ad promise as likely invalid",a.element);return b});if(e.length){if(c||1!=e.length){var h,k=e.map(function(a){return a.sraDeferred.resolve}),
p=kc(function(a,c,d){b();Ae(a,c,d,k,h)});return Oe(a,e).then(function(c){b();h=c;return I(a.win,"xhr").fetch(h,{mode:"cors",method:"GET",credentials:"include"})}).then(function(c){b();jc(a.win,c,p);return Promise.all(e.map(function(a){return a.sraDeferred.promise}))}).catch(function(b){ic(b)?e.forEach(function(a){return a.sraDeferred&&a.sraDeferred.reject(b)}):c||a.win.document.querySelector("meta[name=amp-ad-doubleclick-sra]")?(Bd(b,h),a.warnOnError("SRA request failure",b),e.forEach(function(a){a.resetAdUrl();
a.attemptCollapse();a.sraDeferred.reject(b)})):e.forEach(function(a){return a.sraDeferred.resolve(null)})})}B().info("amp-ad-network-doubleclick-impl","single block in network "+f);e[0].sraDeferred.resolve(null)}}))});return Promise.all(e)})};g.warnOnError=function(a,b){B().warn("amp-ad-network-doubleclick-impl",a,b)};g.getPreconnectUrls=function(){return["https://securepubads.g.doubleclick.net/"]};
g.getNonAmpCreativeRenderingMethod=function(a){return this.forceSafeframe||this.C?"safeframe":W.prototype.getNonAmpCreativeRenderingMethod.call(this,a)};g.getLocationQueryParameterValue=function(a){De=De||q(this.win.location&&this.win.location.search||"");return De[a]};g.getAdditionalContextMetadata=function(a){a=void 0===a?!1:a;if(this.C||a){var b=this.getCreativeSize();this.I=this.I||new ee(this,this.C,b);return this.I.getSafeframeNameAttr()}};
g.postTroubleshootMessage=function(){var a=this;return this.win.opener&&/[?|&]dfpdeb/.test(this.win.location.search)?this.G.adUrl.then(function(b){var c=a.G.slotId+"_"+a.G.slotIndex;b=D({gutData:JSON.stringify(D({events:[{timestamp:Date.now(),slotid:c,messageId:4}],slots:[{contentUrl:b||"",id:c,leafAdUnitName:a.G.slotId,domId:c,lineItemId:a.G.lineItemId,creativeId:a.G.creativeId}]})),userAgent:navigator.userAgent,referrer:a.win.location.href,messageType:"LOAD"});a.win.opener.postMessage(b,"*")}):
null};g.setPageviewStateToken=function(a){Z[a]=this};g.removePageviewStateToken=function(){for(var a in Z)if(Z[a]==this){delete Z[a];break}};
g.getA4aAnalyticsVars=function(a){var b=this.$,c=this.win,d=this.getAmpDoc(),e=M(d),f=c.performance&&c.performance.timing&&c.performance.timing.navigationStart||0,c={correlator:Fb(c,d),slotId:this.element.getAttribute("data-amp-slot-index"),viewerLastVisibleTime:e.getLastVisibleTime()-f};b&&(c.qqid=b);"ad-render-start"==a&&(c.scheduleTime=this.element.layoutScheduleTime-f);return c};
g.getA4aAnalyticsConfig=function(){return D({requests:{csi:"https://csi.gstatic.com/csi?"},transport:{xhrpost:!1},triggers:{adRequestStart:Pb("ad-request-start",{"met.a4a":"afs_lvt.${viewerLastVisibleTime}~afs.${time}"}),adResponseEnd:Pb("ad-response-end",{"met.a4a":"afe.${time}"}),adRenderStart:Pb("ad-render-start",{"met.a4a":"ast.${scheduleTime}~ars_lvt.${viewerLastVisibleTime}~ars.${time}",qqid:"${qqid}"}),adIframeLoaded:Pb("ad-iframe-loaded",{"met.a4a":"ail.${time}"})},extraUrlParams:{s:"ampad",
ctx:"2",c:"${correlator}",slotId:"${slotId}",puid:"${requestCount}~${timestamp}"}})};(function(a){a.registerElement("amp-ad-network-doubleclick-impl",Ee)})(self.AMP);function Db(a){return(a=/^(?:\/)?(\d+)/.exec(a.getAttribute("data-slot")))?a[1]:""}
function Oe(a,b){var c=Date.now();return Promise.all(b.map(function(a){return a.getAdUrlDeferred.promise})).then(function(){return Eb(a,c)}).then(function(a){var d=we(b),f=Object.assign(d,a,b[0].getPageParameters(b[0].consentState,b));return cb(f)+"&dtd="+Mb(c)})};
})});
//# sourceMappingURL=amp-ad-network-doubleclick-impl-0.1.js.map

