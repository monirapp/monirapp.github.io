{"version":3,"sources":["node_modules/browser-pack/_prelude.js","build/video-autoplay.css.js","build/video-docking.css.js","extensions/amp-video-iframe/0.1/amp-video-iframe.js","node_modules/document-register-element/build/document-register-element.patched.js","node_modules/promise-pjs/promise.js","src/3p-frame-messaging.js","src/action-constants.js","src/config.js","src/cookies.js","src/dom.js","src/element-service.js","src/event-helper-listen.js","src/event-helper.js","src/experiments.js","src/iframe-helper.js","src/iframe-video.js","src/json.js","src/layout-rect.js","src/layout.js","src/log.js","src/mediasession-helper.js","src/mode-object.js","src/mode.js","src/observable.js","src/polyfills.js","src/polyfills/array-includes.js","src/polyfills/custom-elements.js","src/polyfills/document-contains.js","src/polyfills/domtokenlist-toggle.js","src/polyfills/math-sign.js","src/polyfills/object-assign.js","src/polyfills/promise.js","src/render-delaying-services.js","src/service.js","src/service/position-observer/position-observer-impl.js","src/service/position-observer/position-observer-worker.js","src/service/video-manager-impl.js","src/service/video-service-interface.js","src/service/video-service-sync-impl.js","src/service/video-session-manager.js","src/service/video/autoplay.js","src/service/video/docking.js","src/service/video/install-autoplay-styles.js","src/services.js","src/static-template.js","src/string.js","src/style-installer.js","src/style.js","src/types.js","src/url-parse-query-string.js","src/url-try-decode-uri-component.js","src/url.js","src/utils/array.js","src/utils/function.js","src/utils/lru-cache.js","src/utils/math.js","src/utils/object.js","src/utils/promise.js","src/utils/rate-limit.js","src/utils/video.js","src/video-interface.js","third_party/css-escape/css-escape.js"],"names":[],"mappings":"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AP;AACD;;AAED;;;;sCACkB;AAChB,WAAK,OAAL,CAAa,iBAAb;AACD;;AAED;;;;qCACiB;AACf,WAAK,OAAL,CAAa,gBAAb;AACD;;AAED;;;;mCACe;AACb;AACA,UAAI,CAAC,KAAK,OAAV,EAAmB;AACjB,eAAO,KAAP;AACD;AACD,aAAO,8BAAoB,gBAAM,aAAN,CAAoB,KAAK,OAAzB,CAApB,CAAP;AACD;;AAED;;;;mCACe;AACb,WAAK,OAAL,CAAa,cAAb;AACD;;AAED;;;;mCACe;AACb,WAAK,OAAL,CAAa,cAAb;AACD;;AAED;;;;kCACc,CAEb;AADC;;;AAGF;;;;kCACc;AACZ;AACA,aAAO,CAAP;AACD;;AAED;;;;qCACiB;AACf;AACA,aAAO,CAAP;AACD;;AAED;;;;sCACkB;AAChB;AACA,aAAO,EAAP;AACD;;;;EAhW0B,IAAI,W;;AAmWjC,IAAI,SAAJ,CAAc,GAAd,EAAmB,KAAnB,EAA0B,eAAO;AAC/B,MAAI,eAAJ,CAAoB,GAApB,EAAyB,cAAzB;AACD,CAFD;;;ACpaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACn6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;QCzbgB,M,GAAA,M;QAeA,gB,GAAA,gB;QAiBA,kB,GAAA,kB;QAoBA,Y,GAAA,Y;;AA9GhB;;AACA;;AACA;;AACA;;AAGA;AAtBA;;;;;;;;;;;;;;;;AAuBA,IAAM,qBAAqB,MAA3B;AACO,IAAM,gCAAY;AACvB,sBAAoB,SADG;AAEvB,sBAAoB,WAFG;AAGvB,oBAAkB,SAHK;AAIvB,oBAAkB;AAJK,CAAlB;;AAOP;AACO,IAAM,oCAAc;AACzB;AACA,oBAAkB,kBAFO;AAGzB,eAAa,aAHY;AAIzB,sBAAoB,oBAJK;AAKzB,iBAAe,eALU;AAMzB,sBAAoB,oBANK;AAOzB,gBAAc,cAPW;AAQzB,cAAY,YARa;AASzB,sBAAo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","file":"amp-video-iframe-0.1.max.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","export const cssText = \"i-amphtml-video-mask{z-index:1}.amp-video-eq{display:none}.i-amphtml-video-component:not(amp-video) .amp-video-eq,amp-story .amp-video-eq,amp-video[controls] .amp-video-eq{display:-webkit-box;display:-ms-flexbox;display:flex}[noaudio] .amp-video-eq{display:none!important}.amp-video-eq{pointer-events:none!important;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;bottom:7px;height:12px;opacity:0.8;overflow:hidden;position:absolute;right:7px;width:20px;z-index:1}.amp-video-eq .amp-video-eq-col{-webkit-box-flex:1;-ms-flex:1;flex:1;height:100%;margin-right:1px;position:relative}.amp-video-eq .amp-video-eq-col div{-webkit-animation-name:amp-video-eq-animation;animation-name:amp-video-eq-animation;-webkit-animation-timing-function:linear;animation-timing-function:linear;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-direction:alternate;animation-direction:alternate;background-color:#fafafa;height:100%;position:absolute;width:100%;will-change:transform;-webkit-animation-play-state:paused;animation-play-state:paused}.amp-video-eq[unpausable] .amp-video-eq-col div{-webkit-animation-name:none;animation-name:none}.amp-video-eq[unpausable].amp-video-eq-play .amp-video-eq-col div{-webkit-animation-name:amp-video-eq-animation;animation-name:amp-video-eq-animation}.amp-video-eq.amp-video-eq-play .amp-video-eq-col div{-webkit-animation-play-state:running;animation-play-state:running}.amp-video-eq-1-1{-webkit-animation-duration:0.3s;animation-duration:0.3s}.amp-video-eq-1-1,.amp-video-eq-1-2{-webkit-transform:translateY(60%);transform:translateY(60%)}.amp-video-eq-1-2{-webkit-animation-duration:0.45s;animation-duration:0.45s}.amp-video-eq-2-1{-webkit-animation-duration:0.5s;animation-duration:0.5s}.amp-video-eq-2-1,.amp-video-eq-2-2{-webkit-transform:translateY(30%);transform:translateY(30%)}.amp-video-eq-2-2{-webkit-animation-duration:0.4s;animation-duration:0.4s}.amp-video-eq-3-1{-webkit-animation-duration:0.3s;animation-duration:0.3s}.amp-video-eq-3-1,.amp-video-eq-3-2{-webkit-transform:translateY(70%);transform:translateY(70%)}.amp-video-eq-3-2{-webkit-animation-duration:0.35s;animation-duration:0.35s}.amp-video-eq-4-1{-webkit-animation-duration:0.4s;animation-duration:0.4s}.amp-video-eq-4-1,.amp-video-eq-4-2{-webkit-transform:translateY(50%);transform:translateY(50%)}.amp-video-eq-4-2{-webkit-animation-duration:0.25s;animation-duration:0.25s}@-webkit-keyframes amp-video-eq-animation{0%{-webkit-transform:translateY(100%);transform:translateY(100%)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes amp-video-eq-animation{0%{-webkit-transform:translateY(100%);transform:translateY(100%)}to{-webkit-transform:translateY(0);transform:translateY(0)}}\\n/*# sourceURL=/css/video-autoplay.css*/\"","export const cssText = \".amp-video-docked-controls{opacity:0;pointer-events:none!important;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;height:120px}.amp-video-docked-main-button-group{height:40px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:-20px 0 0 -60px}.amp-video-docked-controls-shown{opacity:1;pointer-events:initial!important}.amp-video-docked-button-group{margin:0}.amp-video-docked-button-dismiss-group,.amp-video-docked-button-dismiss-group>div[role=button],.amp-video-docked-button-group,.amp-video-docked-button-group>div[role=button]{min-width:40px;height:40px;border-radius:40px}.amp-video-docked-button-dismiss-group:active,.amp-video-docked-button-group:active{background-color:hsla(0,0%,100%,0.7)}.amp-video-docked-button-dismiss-group>div[role=button],.amp-video-docked-button-group,.amp-video-docked-button-group>div[role=button],.amp-video-docked-controls,.i-amphtml-video-docked-overlay{-webkit-tap-highlight-color:rgba(0,0,0,0)!important}.amp-video-docked-button-dismiss-group>div[role=button],.amp-video-docked-button-group>div[role=button]{background-repeat:no-repeat;background-position:50%}.amp-video-docked-shadow{box-shadow:0px 0 20px 6px rgba(0,0,0,0.2)}.amp-video-docked-controls-bg{background:hsla(0,0%,90.2%,0.6)}.amp-video-docked-mute{background-image:url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M3 9v6h4l5 5V4L7 9H3zm13.5 3A4.5 4.5 0 0 0 14 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\\\")}.amp-video-docked-unmute{background-image:url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M16.5 12A4.5 4.5 0 0 0 14 7.97v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51A8.796 8.796 0 0 0 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06a8.99 8.99 0 0 0 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\\\")}.amp-video-docked-pause{background-image:url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M6 19h4V5H6v14zm8-14v14h4V5h-4z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\\\")}.amp-video-docked-play{background-image:url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M8 5v14l11-7z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\\\")}.amp-video-docked-fullscreen{background-image:url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z'/%3E%3C/svg%3E\\\")}.amp-video-docked-dismiss{background-image:url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\\\")}.amp-video-docked-shadow,.i-amphtml-video-docked,.i-amphtml-video-docked-overlay{margin:0!important}.amp-video-docked-controls,.amp-video-docked-shadow,.i-amphtml-video-docked,.i-amphtml-video-docked-overlay{position:fixed!important;top:0!important;left:0!important;right:auto!important;bottom:auto!important;padding:0!important;min-width:0!important;min-height:0!important;max-width:auto!important;max-height:auto!important;-webkit-transform-origin:left top!important;transform-origin:left top!important;will-change:width,height,transition,transform,opacity}.i-amphtml-video-docked-overlay{opacity:0;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;contain:strict!important}.amp-video-docked-controls-bg{opacity:1}.i-amphtml-video-docked-overlay.amp-video-docked-almost-dismissed{opacity:1;background:hsla(0,0%,39.2%,0.1)}.i-amphtml-video-docked-shadow.amp-video-docked-almost-dismissed,.i-amphtml-video-docked.amp-video-docked-almost-dismissed{opacity:0.3}.amp-video-docked-button-dismiss-group{position:absolute;top:-40px}.amp-video-docked-controls{z-index:2147483646!important}.i-amphtml-video-docked-overlay{z-index:2147483645!important}.i-amphtml-video-docked{z-index:2147483644!important}.amp-video-docked-shadow{z-index:2147483643!important}\\n/*# sourceURL=/css/video-docking.css*/\"","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {Deferred} from '../../../src/utils/promise';\nimport {MIN_VISIBILITY_RATIO_FOR_AUTOPLAY} from '../../../src/video-interface';\nimport {\n  SandboxOptions,\n  createFrameFor,\n  isJsonOrObj,\n  objOrParseJson,\n  originMatches,\n} from '../../../src/iframe-video';\nimport {Services} from '../../../src/services';\nimport {VideoEvents} from '../../../src/video-interface';\nimport {dev} from '../../../src/log';\nimport {dict} from '../../../src/utils/object';\nimport {\n  disableScrollingOnIframe,\n  isAdLike,\n  looksLikeTrackingIframe,\n} from '../../../src/iframe-helper';\nimport {getData, listen} from '../../../src/event-helper';\nimport {htmlFor} from '../../../src/static-template';\nimport {\n  installVideoManagerForDoc,\n} from '../../../src/service/video-manager-impl';\nimport {isFullscreenElement, removeElement} from '../../../src/dom';\nimport {isLayoutSizeDefined} from '../../../src/layout';\n\n/** @private @const */\nconst TAG = 'amp-video-iframe';\n\n/** @private @const */\nconst SANDBOX = [\n  SandboxOptions.ALLOW_SCRIPTS,\n  SandboxOptions.ALLOW_SAME_ORIGIN,\n];\n\n/**\n * Events allowed to be dispatched from messages.\n * @private @const\n */\nconst ALLOWED_EVENTS = [\n  VideoEvents.PLAYING,\n  VideoEvents.PAUSE,\n  VideoEvents.ENDED,\n  VideoEvents.MUTED,\n  VideoEvents.UNMUTED,\n  VideoEvents.AD_START,\n  VideoEvents.AD_END,\n];\n\n/** @implements {../../../src/video-interface.VideoInterface} */\nclass AmpVideoIframe extends AMP.BaseElement {\n\n  /** @param {!AmpElement} element */\n  constructor(element) {\n    super(element);\n\n    /** @private {?Element} */\n    this.iframe_ = null;\n\n    /** @private {!UnlistenDef|null} */\n    this.unlistenFrame_ = null;\n\n    /** @private {?function()} */\n    this.readyPromise_ = null;\n\n    /** @private {?function()} */\n    this.readyResolver_ = null;\n\n    /** @private {?function()} */\n    this.readyRejecter_ = null;\n\n    /** @private {boolean} */\n    this.canPlay_ = false;\n\n    /**\n     * @param {!Event} e\n     * @private\n     */\n    this.boundOnMessage_ = e => this.onMessage_(e);\n  }\n\n  /** @override */\n  isLayoutSupported(layout) {\n    return isLayoutSizeDefined(layout);\n  }\n\n  /** @override */\n  buildCallback() {\n    const {element} = this;\n\n    this.user().assert(!isAdLike(element),\n        '<amp-video-iframe> does not allow ad iframes. ',\n        'Please use amp-ad instead.');\n\n    this.user().assert(!looksLikeTrackingIframe(element),\n        '<amp-video-iframe> does not allow tracking iframes. ',\n        'Please use amp-analytics instead.');\n\n    installVideoManagerForDoc(element);\n  }\n\n  /** @override */\n  layoutCallback() {\n    const name = JSON.stringify(this.getMetadata_());\n\n    this.iframe_ =\n        disableScrollingOnIframe(\n            createFrameFor(this, this.getSrc_(), name, SANDBOX));\n\n    this.unlistenFrame_ = listen(this.win, 'message', this.boundOnMessage_);\n    return this.createReadyPromise_().then(() => this.onReady_());\n  }\n\n  /**\n   * @return {!JsonObject}\n   * @private\n   */\n  getMetadata_() {\n    const {sourceUrl, canonicalUrl} = Services.documentInfoForDoc(this.element);\n\n    return dict({\n      'sourceUrl': sourceUrl,\n      'canonicalUrl': canonicalUrl,\n    });\n  }\n\n  /** @private */\n  onReady_() {\n    const {element} = this;\n    Services.videoManagerForDoc(element).register(this);\n    element.dispatchCustomEvent(VideoEvents.LOAD);\n  }\n\n  /** @override */\n  createPlaceholderCallback() {\n    const {element} = this;\n    const poster =\n        htmlFor(element)`<amp-img layout=fill placeholder></amp-img>`;\n\n    poster.setAttribute('src',\n        this.user().assertString(element.getAttribute('poster')));\n\n    return poster;\n  }\n\n  /** @override */\n  unlayoutCallback() {\n    this.canPlay_ = false;\n    this.removeIframe_();\n    return true; // layout again.\n  }\n\n  /** @private */\n  removeIframe_() {\n    this.canPlay_ = false;\n\n    if (this.iframe_) {\n      removeElement(this.iframe_);\n      this.iframe_ = null;\n    }\n    if (this.unlistenFrame_) {\n      this.unlistenFrame_();\n      this.unlistenFrame_ = null;\n    }\n  }\n\n  /** @private */\n  getSrc_() {\n    const {element} = this;\n    const urlService = Services.urlForDoc(element);\n    const src = urlService.assertHttpsUrl(element.getAttribute('src'), element);\n\n    if (urlService.getSourceOrigin(src) === urlService.getWinOrigin(this.win)) {\n      this.user().warn(TAG,\n          'Origins of document inside amp-video-iframe and the host are the ' +\n          'same, which allows for same-origin behavior. However in AMP ' +\n          'cache, origins won\\'t match. Please ensure you do not rely on any ' +\n          'same-origin privileges.',\n          element);\n    }\n\n    return src;\n  }\n\n  /**\n   * @return {!Promise}\n   * @private\n   */\n  createReadyPromise_() {\n    const {promise, resolve, reject} = new Deferred();\n    this.readyPromise_ = promise;\n    this.readyResolver_ = resolve;\n    this.readyRejecter_ = reject;\n    return promise;\n  }\n\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  originMatches_(event) {\n    return originMatches(event, this.iframe_, /.*/);\n  }\n\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  onMessage_(event) {\n    if (!this.iframe_) {\n      return;\n    }\n\n    if (!this.originMatches_(event)) {\n      return;\n    }\n\n    const eventData = getData(event);\n    if (!isJsonOrObj(eventData)) {\n      return;\n    }\n\n    const data = objOrParseJson(eventData);\n\n    const messageId = data['id'];\n    const methodReceived = data['method'];\n\n    if (methodReceived) {\n      if (methodReceived == 'getIntersection') {\n        this.postIntersection_(messageId);\n        return;\n      }\n      dev().assert(false, `Unknown method '${methodReceived}`);\n      return;\n    }\n\n    const eventReceived = data['event'];\n    const isCanPlayEvent = eventReceived == 'canplay';\n\n    this.canPlay_ = this.canPlay_ || isCanPlayEvent;\n\n    if (isCanPlayEvent) {\n      dev().assert(this.readyResolver_).call();\n      return;\n    }\n\n    if (eventReceived == 'error' && !this.canPlay_) {\n      dev().assert(this.readyRejecter_).call();\n      return;\n    }\n\n    if (ALLOWED_EVENTS.indexOf(eventReceived) > -1) {\n      this.element.dispatchCustomEvent(eventReceived);\n      return;\n    }\n  }\n\n  /**\n   * @param {number} messageId\n   * @private\n   */\n  postIntersection_(messageId) {\n    const {time, intersectionRatio} = this.element.getIntersectionChangeEntry();\n\n    // Only post ratio > 0 when in autoplay range to prevent internal autoplay\n    // implementations that differ from ours.\n    const postedRatio =\n        intersectionRatio < MIN_VISIBILITY_RATIO_FOR_AUTOPLAY ?\n          0 : intersectionRatio;\n\n    this.postMessage_(dict({\n      'id': messageId,\n      'args': {\n        'intersectionRatio': postedRatio,\n        'time': time,\n      },\n    }));\n  }\n\n  /**\n   * @param {string} method\n   * @private\n   */\n  method_(method) {\n    this.postMessage_(dict({\n      'event': 'method',\n      'method': method,\n    }));\n  }\n\n  /**\n   * @param {!JsonObject} message\n   * @private\n   */\n  postMessage_(message) {\n    if (!this.iframe_ || !this.iframe_.contentWindow) {\n      return;\n    }\n    if (!this.readyPromise_) {\n      return;\n    }\n    this.readyPromise_.then(() => {\n      this.iframe_.contentWindow./*OK*/postMessage(\n          JSON.stringify(message), '*');\n    });\n  }\n\n  /** @override */\n  pauseCallback() {\n    this.pause();\n  }\n\n  /** @override */\n  pause() {\n    this.method_('pause');\n  }\n\n  /** @override */\n  play() {\n    this.method_('play');\n  }\n\n  /** @override */\n  mute() {\n    this.method_('mute');\n  }\n\n  /** @override */\n  unmute() {\n    this.method_('unmute');\n  }\n\n  /** @override */\n  isInteractive() {\n    return true;\n  }\n\n  /** @override */\n  supportsPlatform() {\n    return true;\n  }\n\n  /** @override */\n  preimplementsMediaSessionAPI() {\n    return this.element.hasAttribute('implements-media-session');\n  }\n\n  /** @override */\n  preimplementsAutoFullscreen() {\n    return this.element.hasAttribute('implements-rotate-to-fullscreen');\n  }\n\n  /** @override */\n  fullscreenEnter() {\n    this.method_('fullscreenenter');\n  }\n\n  /** @override */\n  fullscreenExit() {\n    this.method_('fullscreenexit');\n  }\n\n  /** @override */\n  isFullscreen() {\n    // TODO(alanorozco): Make this accurate on iOS (i.e. async API).\n    if (!this.iframe_) {\n      return false;\n    }\n    return isFullscreenElement(dev().assertElement(this.iframe_));\n  }\n\n  /** @override */\n  showControls() {\n    this.method_('showcontrols');\n  }\n\n  /** @override */\n  hideControls() {\n    this.method_('hidecontrols');\n  }\n\n  /** @override */\n  getMetadata() {\n    // TODO(alanorozco)\n  }\n\n  /** @override */\n  getDuration() {\n    // TODO(alanorozco)\n    return 0;\n  }\n\n  /** @override */\n  getCurrentTime() {\n    // TODO(alanorozco)\n    return 0;\n  }\n\n  /** @override */\n  getPlayedRanges() {\n    // TODO(alanorozco)\n    return [];\n  }\n}\n\nAMP.extension(TAG, '0.1', AMP => {\n  AMP.registerElement(TAG, AmpVideoIframe);\n});\n","/*!\n\nCopyright (C) 2014-2016 by Andrea Giammarchi - @WebReflection\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n\n*/\n// global window Object\n// optional polyfill info\n//    'auto' used by default, everything is feature detected\n//    'force' use the polyfill even if not fully needed\nfunction installCustomElements(window, polyfill) {'use strict';\n\n  // DO NOT USE THIS FILE DIRECTLY, IT WON'T WORK\n  // THIS IS A PROJECT BASED ON A BUILD SYSTEM\n  // THIS FILE IS JUST WRAPPED UP RESULTING IN\n  // build/document-register-element.node.js\n\n  var\n    document = window.document,\n    Object = window.Object\n  ;\n\n  var htmlClass = (function (info) {\n    // (C) Andrea Giammarchi - @WebReflection - MIT Style\n    var\n      catchClass = /^[A-Z]+[a-z]/,\n      filterBy = function (re) {\n        var arr = [], tag;\n        for (tag in register) {\n          if (re.test(tag)) arr.push(tag);\n        }\n        return arr;\n      },\n      add = function (Class, tag) {\n        tag = tag.toLowerCase();\n        if (!(tag in register)) {\n          register[Class] = (register[Class] || []).concat(tag);\n          register[tag] = (register[tag.toUpperCase()] = Class);\n        }\n      },\n      register = (Object.create || Object)(null),\n      htmlClass = {},\n      i, section, tags, Class\n    ;\n    for (section in info) {\n      for (Class in info[section]) {\n        tags = info[section][Class];\n        register[Class] = tags;\n        for (i = 0; i < tags.length; i++) {\n          register[tags[i].toLowerCase()] =\n          register[tags[i].toUpperCase()] = Class;\n        }\n      }\n    }\n    htmlClass.get = function get(tagOrClass) {\n      return typeof tagOrClass === 'string' ?\n        (register[tagOrClass] || (catchClass.test(tagOrClass) ? [] : '')) :\n        filterBy(tagOrClass);\n    };\n    htmlClass.set = function set(tag, Class) {\n      return (catchClass.test(tag) ?\n        add(tag, Class) :\n        add(Class, tag)\n      ), htmlClass;\n    };\n    return htmlClass;\n  }({\n    \"collections\": {\n      \"HTMLAllCollection\": [\n        \"all\"\n      ],\n      \"HTMLCollection\": [\n        \"forms\"\n      ],\n      \"HTMLFormControlsCollection\": [\n        \"elements\"\n      ],\n      \"HTMLOptionsCollection\": [\n        \"options\"\n      ]\n    },\n    \"elements\": {\n      \"Element\": [\n        \"element\"\n      ],\n      \"HTMLAnchorElement\": [\n        \"a\"\n      ],\n      \"HTMLAppletElement\": [\n        \"applet\"\n      ],\n      \"HTMLAreaElement\": [\n        \"area\"\n      ],\n      \"HTMLAttachmentElement\": [\n        \"attachment\"\n      ],\n      \"HTMLAudioElement\": [\n        \"audio\"\n      ],\n      \"HTMLBRElement\": [\n        \"br\"\n      ],\n      \"HTMLBaseElement\": [\n        \"base\"\n      ],\n      \"HTMLBodyElement\": [\n        \"body\"\n      ],\n      \"HTMLButtonElement\": [\n        \"button\"\n      ],\n      \"HTMLCanvasElement\": [\n        \"canvas\"\n      ],\n      \"HTMLContentElement\": [\n        \"content\"\n      ],\n      \"HTMLDListElement\": [\n        \"dl\"\n      ],\n      \"HTMLDataElement\": [\n        \"data\"\n      ],\n      \"HTMLDataListElement\": [\n        \"datalist\"\n      ],\n      \"HTMLDetailsElement\": [\n        \"details\"\n      ],\n      \"HTMLDialogElement\": [\n        \"dialog\"\n      ],\n      \"HTMLDirectoryElement\": [\n        \"dir\"\n      ],\n      \"HTMLDivElement\": [\n        \"div\"\n      ],\n      \"HTMLDocument\": [\n        \"document\"\n      ],\n      \"HTMLElement\": [\n        \"element\",\n        \"abbr\",\n        \"address\",\n        \"article\",\n        \"aside\",\n        \"b\",\n        \"bdi\",\n        \"bdo\",\n        \"cite\",\n        \"code\",\n        \"command\",\n        \"dd\",\n        \"dfn\",\n        \"dt\",\n        \"em\",\n        \"figcaption\",\n        \"figure\",\n        \"footer\",\n        \"header\",\n        \"i\",\n        \"kbd\",\n        \"mark\",\n        \"nav\",\n        \"noscript\",\n        \"rp\",\n        \"rt\",\n        \"ruby\",\n        \"s\",\n        \"samp\",\n        \"section\",\n        \"small\",\n        \"strong\",\n        \"sub\",\n        \"summary\",\n        \"sup\",\n        \"u\",\n        \"var\",\n        \"wbr\"\n      ],\n      \"HTMLEmbedElement\": [\n        \"embed\"\n      ],\n      \"HTMLFieldSetElement\": [\n        \"fieldset\"\n      ],\n      \"HTMLFontElement\": [\n        \"font\"\n      ],\n      \"HTMLFormElement\": [\n        \"form\"\n      ],\n      \"HTMLFrameElement\": [\n        \"frame\"\n      ],\n      \"HTMLFrameSetElement\": [\n        \"frameset\"\n      ],\n      \"HTMLHRElement\": [\n        \"hr\"\n      ],\n      \"HTMLHeadElement\": [\n        \"head\"\n      ],\n      \"HTMLHeadingElement\": [\n        \"h1\",\n        \"h2\",\n        \"h3\",\n        \"h4\",\n        \"h5\",\n        \"h6\"\n      ],\n      \"HTMLHtmlElement\": [\n        \"html\"\n      ],\n      \"HTMLIFrameElement\": [\n        \"iframe\"\n      ],\n      \"HTMLImageElement\": [\n        \"img\"\n      ],\n      \"HTMLInputElement\": [\n        \"input\"\n      ],\n      \"HTMLKeygenElement\": [\n        \"keygen\"\n      ],\n      \"HTMLLIElement\": [\n        \"li\"\n      ],\n      \"HTMLLabelElement\": [\n        \"label\"\n      ],\n      \"HTMLLegendElement\": [\n        \"legend\"\n      ],\n      \"HTMLLinkElement\": [\n        \"link\"\n      ],\n      \"HTMLMapElement\": [\n        \"map\"\n      ],\n      \"HTMLMarqueeElement\": [\n        \"marquee\"\n      ],\n      \"HTMLMediaElement\": [\n        \"media\"\n      ],\n      \"HTMLMenuElement\": [\n        \"menu\"\n      ],\n      \"HTMLMenuItemElement\": [\n        \"menuitem\"\n      ],\n      \"HTMLMetaElement\": [\n        \"meta\"\n      ],\n      \"HTMLMeterElement\": [\n        \"meter\"\n      ],\n      \"HTMLModElement\": [\n        \"del\",\n        \"ins\"\n      ],\n      \"HTMLOListElement\": [\n        \"ol\"\n      ],\n      \"HTMLObjectElement\": [\n        \"object\"\n      ],\n      \"HTMLOptGroupElement\": [\n        \"optgroup\"\n      ],\n      \"HTMLOptionElement\": [\n        \"option\"\n      ],\n      \"HTMLOutputElement\": [\n        \"output\"\n      ],\n      \"HTMLParagraphElement\": [\n        \"p\"\n      ],\n      \"HTMLParamElement\": [\n        \"param\"\n      ],\n      \"HTMLPictureElement\": [\n        \"picture\"\n      ],\n      \"HTMLPreElement\": [\n        \"pre\"\n      ],\n      \"HTMLProgressElement\": [\n        \"progress\"\n      ],\n      \"HTMLQuoteElement\": [\n        \"blockquote\",\n        \"q\",\n        \"quote\"\n      ],\n      \"HTMLScriptElement\": [\n        \"script\"\n      ],\n      \"HTMLSelectElement\": [\n        \"select\"\n      ],\n      \"HTMLShadowElement\": [\n        \"shadow\"\n      ],\n      \"HTMLSlotElement\": [\n        \"slot\"\n      ],\n      \"HTMLSourceElement\": [\n        \"source\"\n      ],\n      \"HTMLSpanElement\": [\n        \"span\"\n      ],\n      \"HTMLStyleElement\": [\n        \"style\"\n      ],\n      \"HTMLTableCaptionElement\": [\n        \"caption\"\n      ],\n      \"HTMLTableCellElement\": [\n        \"td\",\n        \"th\"\n      ],\n      \"HTMLTableColElement\": [\n        \"col\",\n        \"colgroup\"\n      ],\n      \"HTMLTableElement\": [\n        \"table\"\n      ],\n      \"HTMLTableRowElement\": [\n        \"tr\"\n      ],\n      \"HTMLTableSectionElement\": [\n        \"thead\",\n        \"tbody\",\n        \"tfoot\"\n      ],\n      \"HTMLTemplateElement\": [\n        \"template\"\n      ],\n      \"HTMLTextAreaElement\": [\n        \"textarea\"\n      ],\n      \"HTMLTimeElement\": [\n        \"time\"\n      ],\n      \"HTMLTitleElement\": [\n        \"title\"\n      ],\n      \"HTMLTrackElement\": [\n        \"track\"\n      ],\n      \"HTMLUListElement\": [\n        \"ul\"\n      ],\n      \"HTMLUnknownElement\": [\n        \"unknown\",\n        \"vhgroupv\",\n        \"vkeygen\"\n      ],\n      \"HTMLVideoElement\": [\n        \"video\"\n      ]\n    },\n    \"nodes\": {\n      \"Attr\": [\n        \"node\"\n      ],\n      \"Audio\": [\n        \"audio\"\n      ],\n      \"CDATASection\": [\n        \"node\"\n      ],\n      \"CharacterData\": [\n        \"node\"\n      ],\n      \"Comment\": [\n        \"#comment\"\n      ],\n      \"Document\": [\n        \"#document\"\n      ],\n      \"DocumentFragment\": [\n        \"#document-fragment\"\n      ],\n      \"DocumentType\": [\n        \"node\"\n      ],\n      \"HTMLDocument\": [\n        \"#document\"\n      ],\n      \"Image\": [\n        \"img\"\n      ],\n      \"Option\": [\n        \"option\"\n      ],\n      \"ProcessingInstruction\": [\n        \"node\"\n      ],\n      \"ShadowRoot\": [\n        \"#shadow-root\"\n      ],\n      \"Text\": [\n        \"#text\"\n      ],\n      \"XMLDocument\": [\n        \"xml\"\n      ]\n    }\n  }));\n  \n  \n    \n  // passed at runtime, configurable\n  // via nodejs module\n  if (!polyfill) polyfill = 'auto';\n  \n  var\n    // V0 polyfill entry\n    REGISTER_ELEMENT = 'registerElement',\n  \n    // IE < 11 only + old WebKit for attributes + feature detection\n    EXPANDO_UID = '__' + REGISTER_ELEMENT + (window.Math.random() * 10e4 >> 0),\n  \n    // shortcuts and costants\n    ADD_EVENT_LISTENER = 'addEventListener',\n    ATTACHED = 'attached',\n    CALLBACK = 'Callback',\n    DETACHED = 'detached',\n    EXTENDS = 'extends',\n  \n    ATTRIBUTE_CHANGED_CALLBACK = 'attributeChanged' + CALLBACK,\n    ATTACHED_CALLBACK = ATTACHED + CALLBACK,\n    CONNECTED_CALLBACK = 'connected' + CALLBACK,\n    DISCONNECTED_CALLBACK = 'disconnected' + CALLBACK,\n    CREATED_CALLBACK = 'created' + CALLBACK,\n    DETACHED_CALLBACK = DETACHED + CALLBACK,\n  \n    ADDITION = 'ADDITION',\n    MODIFICATION = 'MODIFICATION',\n    REMOVAL = 'REMOVAL',\n  \n    DOM_ATTR_MODIFIED = 'DOMAttrModified',\n    DOM_CONTENT_LOADED = 'DOMContentLoaded',\n    DOM_SUBTREE_MODIFIED = 'DOMSubtreeModified',\n  \n    PREFIX_TAG = '<',\n    PREFIX_IS = '=',\n  \n    // valid and invalid node names\n    validName = /^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,\n    invalidNames = [\n      'ANNOTATION-XML',\n      'COLOR-PROFILE',\n      'FONT-FACE',\n      'FONT-FACE-SRC',\n      'FONT-FACE-URI',\n      'FONT-FACE-FORMAT',\n      'FONT-FACE-NAME',\n      'MISSING-GLYPH'\n    ],\n  \n    // registered types and their prototypes\n    types = [],\n    protos = [],\n  \n    // to query subnodes\n    query = '',\n  \n    // html shortcut used to feature detect\n    documentElement = document.documentElement,\n  \n    // ES5 inline helpers || basic patches\n    indexOf = types.indexOf || function (v) {\n      for(var i = this.length; i-- && this[i] !== v;){}\n      return i;\n    },\n  \n    // other helpers / shortcuts\n    OP = Object.prototype,\n    hOP = OP.hasOwnProperty,\n    iPO = OP.isPrototypeOf,\n  \n    defineProperty = Object.defineProperty,\n    empty = [],\n    gOPD = Object.getOwnPropertyDescriptor,\n    gOPN = Object.getOwnPropertyNames,\n    gPO = Object.getPrototypeOf,\n    sPO = Object.setPrototypeOf,\n  \n    // jshint proto: true\n    hasProto = !!Object.__proto__,\n  \n    // V1 helpers\n    fixGetClass = false,\n    DRECEV1 = '__dreCEv1',\n    customElements = window.customElements,\n    usableCustomElements = polyfill !== 'force' && !!(\n      customElements &&\n      customElements.define &&\n      customElements.get &&\n      customElements.whenDefined\n    ),\n    Dict = Object.create || Object,\n    Map = window.Map || function Map() {\n      var K = [], V = [], i;\n      return {\n        get: function (k) {\n          return V[indexOf.call(K, k)];\n        },\n        set: function (k, v) {\n          i = indexOf.call(K, k);\n          if (i < 0) V[K.push(k) - 1] = v;\n          else V[i] = v;\n        }\n      };\n    },\n    Promise = window.Promise || function (fn) {\n      var\n        notify = [],\n        done = false,\n        p = {\n          'catch': function () {\n            return p;\n          },\n          'then': function (cb) {\n            notify.push(cb);\n            if (done) setTimeout(resolve, 1);\n            return p;\n          }\n        }\n      ;\n      function resolve(value) {\n        done = true;\n        while (notify.length) notify.shift()(value);\n      }\n      fn(resolve);\n      return p;\n    },\n    justCreated = false,\n    constructors = Dict(null),\n    waitingList = Dict(null),\n    nodeNames = new Map(),\n    secondArgument = function (is) {\n      return is.toLowerCase();\n    },\n  \n    // used to create unique instances\n    create = Object.create || function Bridge(proto) {\n      // silly broken polyfill probably ever used but short enough to work\n      return proto ? ((Bridge.prototype = proto), new Bridge()) : this;\n    },\n  \n    // will set the prototype if possible\n    // or copy over all properties\n    setPrototype = sPO || (\n      hasProto ?\n        function (o, p) {\n          o.__proto__ = p;\n          return o;\n        } : (\n      (gOPN && gOPD) ?\n        (function(){\n          function setProperties(o, p) {\n            for (var\n              key,\n              names = gOPN(p),\n              i = 0, length = names.length;\n              i < length; i++\n            ) {\n              key = names[i];\n              if (!hOP.call(o, key)) {\n                defineProperty(o, key, gOPD(p, key));\n              }\n            }\n          }\n          return function (o, p) {\n            do {\n              setProperties(o, p);\n            } while ((p = gPO(p)) && !iPO.call(p, o));\n            return o;\n          };\n        }()) :\n        function (o, p) {\n          for (var key in p) {\n            o[key] = p[key];\n          }\n          return o;\n        }\n    )),\n  \n    // DOM shortcuts and helpers, if any\n  \n    MutationObserver = window.MutationObserver ||\n                       window.WebKitMutationObserver,\n  \n    HTMLElementPrototype = (\n      window.HTMLElement ||\n      window.Element ||\n      window.Node\n    ).prototype,\n  \n    IE8 = !iPO.call(HTMLElementPrototype, documentElement),\n  \n    safeProperty = IE8 ? function (o, k, d) {\n      o[k] = d.value;\n      return o;\n    } : defineProperty,\n  \n    isValidNode = IE8 ?\n      function (node) {\n        return node.nodeType === 1;\n      } :\n      function (node) {\n        return iPO.call(HTMLElementPrototype, node);\n      },\n  \n    targets = IE8 && [],\n  \n    attachShadow = HTMLElementPrototype.attachShadow,\n    cloneNode = HTMLElementPrototype.cloneNode,\n    dispatchEvent = HTMLElementPrototype.dispatchEvent,\n    getAttribute = HTMLElementPrototype.getAttribute,\n    hasAttribute = HTMLElementPrototype.hasAttribute,\n    removeAttribute = HTMLElementPrototype.removeAttribute,\n    setAttribute = HTMLElementPrototype.setAttribute,\n  \n    // replaced later on\n    createElement = document.createElement,\n    patchedCreateElement = createElement,\n  \n    // shared observer for all attributes\n    attributesObserver = MutationObserver && {\n      attributes: true,\n      characterData: true,\n      attributeOldValue: true\n    },\n  \n    // useful to detect only if there's no MutationObserver\n    DOMAttrModified = MutationObserver || function(e) {\n      doesNotSupportDOMAttrModified = false;\n      documentElement.removeEventListener(\n        DOM_ATTR_MODIFIED,\n        DOMAttrModified\n      );\n    },\n  \n    // will both be used to make DOMNodeInserted asynchronous\n    asapQueue,\n    asapTimer = 0,\n  \n    // internal flags\n    V0 = REGISTER_ELEMENT in document,\n    setListener = true,\n    justSetup = false,\n    doesNotSupportDOMAttrModified = true,\n    dropDomContentLoaded = true,\n  \n    // needed for the innerHTML helper\n    notFromInnerHTMLHelper = true,\n  \n    // optionally defined later on\n    onSubtreeModified,\n    callDOMAttrModified,\n    getAttributesMirror,\n    observer,\n    observe,\n  \n    // based on setting prototype capability\n    // will check proto or the expando attribute\n    // in order to setup the node once\n    patchIfNotAlready,\n    patch\n  ;\n  \n  // only if needed\n  if (!V0) {\n  \n    if (sPO || hasProto) {\n        patchIfNotAlready = function (node, proto) {\n          if (!iPO.call(proto, node)) {\n            setupNode(node, proto);\n          }\n        };\n        patch = setupNode;\n    } else {\n        patchIfNotAlready = function (node, proto) {\n          if (!node[EXPANDO_UID]) {\n            node[EXPANDO_UID] = Object(true);\n            setupNode(node, proto);\n          }\n        };\n        patch = patchIfNotAlready;\n    }\n  \n    if (IE8) {\n      doesNotSupportDOMAttrModified = false;\n      (function (){\n        var\n          descriptor = gOPD(HTMLElementPrototype, ADD_EVENT_LISTENER),\n          addEventListener = descriptor.value,\n          patchedRemoveAttribute = function (name) {\n            var e = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true});\n            e.attrName = name;\n            e.prevValue = getAttribute.call(this, name);\n            e.newValue = null;\n            e[REMOVAL] = e.attrChange = 2;\n            removeAttribute.call(this, name);\n            dispatchEvent.call(this, e);\n          },\n          patchedSetAttribute = function (name, value) {\n            var\n              had = hasAttribute.call(this, name),\n              old = had && getAttribute.call(this, name),\n              e = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true})\n            ;\n            setAttribute.call(this, name, value);\n            e.attrName = name;\n            e.prevValue = had ? old : null;\n            e.newValue = value;\n            if (had) {\n              e[MODIFICATION] = e.attrChange = 1;\n            } else {\n              e[ADDITION] = e.attrChange = 0;\n            }\n            dispatchEvent.call(this, e);\n          },\n          onPropertyChange = function (e) {\n            // jshint eqnull:true\n            var\n              node = e.currentTarget,\n              superSecret = node[EXPANDO_UID],\n              propertyName = e.propertyName,\n              event\n            ;\n            if (superSecret.hasOwnProperty(propertyName)) {\n              superSecret = superSecret[propertyName];\n              event = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true});\n              event.attrName = superSecret.name;\n              event.prevValue = superSecret.value || null;\n              event.newValue = (superSecret.value = node[propertyName] || null);\n              if (event.prevValue == null) {\n                event[ADDITION] = event.attrChange = 0;\n              } else {\n                event[MODIFICATION] = event.attrChange = 1;\n              }\n              dispatchEvent.call(node, event);\n            }\n          }\n        ;\n        descriptor.value = function (type, handler, capture) {\n          if (\n            type === DOM_ATTR_MODIFIED &&\n            this[ATTRIBUTE_CHANGED_CALLBACK] &&\n            this.setAttribute !== patchedSetAttribute\n          ) {\n            this[EXPANDO_UID] = {\n              className: {\n                name: 'class',\n                value: this.className\n              }\n            };\n            this.setAttribute = patchedSetAttribute;\n            this.removeAttribute = patchedRemoveAttribute;\n            addEventListener.call(this, 'propertychange', onPropertyChange);\n          }\n          addEventListener.call(this, type, handler, capture);\n        };\n        defineProperty(HTMLElementPrototype, ADD_EVENT_LISTENER, descriptor);\n      }());\n    } else if (!MutationObserver) {\n      documentElement[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED, DOMAttrModified);\n      documentElement.setAttribute(EXPANDO_UID, 1);\n      documentElement.removeAttribute(EXPANDO_UID);\n      if (doesNotSupportDOMAttrModified) {\n        onSubtreeModified = function (e) {\n          var\n            node = this,\n            oldAttributes,\n            newAttributes,\n            key\n          ;\n          if (node === e.target) {\n            oldAttributes = node[EXPANDO_UID];\n            node[EXPANDO_UID] = (newAttributes = getAttributesMirror(node));\n            for (key in newAttributes) {\n              if (!(key in oldAttributes)) {\n                // attribute was added\n                return callDOMAttrModified(\n                  0,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  ADDITION\n                );\n              } else if (newAttributes[key] !== oldAttributes[key]) {\n                // attribute was changed\n                return callDOMAttrModified(\n                  1,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  MODIFICATION\n                );\n              }\n            }\n            // checking if it has been removed\n            for (key in oldAttributes) {\n              if (!(key in newAttributes)) {\n                // attribute removed\n                return callDOMAttrModified(\n                  2,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  REMOVAL\n                );\n              }\n            }\n          }\n        };\n        callDOMAttrModified = function (\n          attrChange,\n          currentTarget,\n          attrName,\n          prevValue,\n          newValue,\n          action\n        ) {\n          var e = {\n            attrChange: attrChange,\n            currentTarget: currentTarget,\n            attrName: attrName,\n            prevValue: prevValue,\n            newValue: newValue\n          };\n          e[action] = attrChange;\n          onDOMAttrModified(e);\n        };\n        getAttributesMirror = function (node) {\n          for (var\n            attr, name,\n            result = {},\n            attributes = node.attributes,\n            i = 0, length = attributes.length;\n            i < length; i++\n          ) {\n            attr = attributes[i];\n            name = attr.name;\n            if (name !== 'setAttribute') {\n              result[name] = attr.value;\n            }\n          }\n          return result;\n        };\n      }\n    }\n  \n    // set as enumerable, writable and configurable\n    document[REGISTER_ELEMENT] = function registerElement(type, options) {\n      upperType = type.toUpperCase();\n      if (setListener) {\n        // only first time document.registerElement is used\n        // we need to set this listener\n        // setting it by default might slow down for no reason\n        setListener = false;\n        if (MutationObserver) {\n          observer = (function(attached, detached){\n            function checkEmAll(list, callback) {\n              for (var i = 0, length = list.length; i < length; callback(list[i++])){}\n            }\n            return new MutationObserver(function (records) {\n              for (var\n                current, node, newValue,\n                i = 0, length = records.length; i < length; i++\n              ) {\n                current = records[i];\n                if (current.type === 'childList') {\n                  checkEmAll(current.addedNodes, attached);\n                  checkEmAll(current.removedNodes, detached);\n                } else {\n                  node = current.target;\n                  if (notFromInnerHTMLHelper &&\n                      node[ATTRIBUTE_CHANGED_CALLBACK] &&\n                      current.attributeName !== 'style') {\n                    newValue = getAttribute.call(node, current.attributeName);\n                    if (newValue !== current.oldValue) {\n                      node[ATTRIBUTE_CHANGED_CALLBACK](\n                        current.attributeName,\n                        current.oldValue,\n                        newValue\n                      );\n                    }\n                  }\n                }\n              }\n            });\n          }(executeAction(ATTACHED), executeAction(DETACHED)));\n          observe = function (node) {\n            observer.observe(\n              node,\n              {\n                childList: true,\n                subtree: true\n              }\n            );\n            return node;\n          };\n          observe(document);\n          if (attachShadow) {\n            HTMLElementPrototype.attachShadow = function () {\n              return observe(attachShadow.apply(this, arguments));\n            };\n          }\n        } else {\n          asapQueue = [];\n          document[ADD_EVENT_LISTENER]('DOMNodeInserted', onDOMNode(ATTACHED));\n          document[ADD_EVENT_LISTENER]('DOMNodeRemoved', onDOMNode(DETACHED));\n        }\n  \n        document[ADD_EVENT_LISTENER](DOM_CONTENT_LOADED, onReadyStateChange);\n        document[ADD_EVENT_LISTENER]('readystatechange', onReadyStateChange);\n  \n        HTMLElementPrototype.cloneNode = function (deep) {\n          var\n            node = cloneNode.call(this, !!deep),\n            i = getTypeIndex(node)\n          ;\n          if (-1 < i) patch(node, protos[i]);\n          if (deep && query.length) loopAndSetup(node.querySelectorAll(query));\n          return node;\n        };\n      }\n  \n      if (justSetup) return (justSetup = false);\n  \n      if (-2 < (\n        indexOf.call(types, PREFIX_IS + upperType) +\n        indexOf.call(types, PREFIX_TAG + upperType)\n      )) {\n        throwTypeError(type);\n      }\n  \n      if (!validName.test(upperType) || -1 < indexOf.call(invalidNames, upperType)) {\n        throw new Error('The type ' + type + ' is invalid');\n      }\n  \n      var\n        constructor = function () {\n          return extending ?\n            document.createElement(nodeName, upperType) :\n            document.createElement(nodeName);\n        },\n        opt = options || OP,\n        extending = hOP.call(opt, EXTENDS),\n        nodeName = extending ? options[EXTENDS].toUpperCase() : upperType,\n        upperType,\n        i\n      ;\n  \n      if (extending && -1 < (\n        indexOf.call(types, PREFIX_TAG + nodeName)\n      )) {\n        throwTypeError(nodeName);\n      }\n  \n      i = types.push((extending ? PREFIX_IS : PREFIX_TAG) + upperType) - 1;\n  \n      query = query.concat(\n        query.length ? ',' : '',\n        extending ? nodeName + '[is=\"' + type.toLowerCase() + '\"]' : nodeName\n      );\n  \n      constructor.prototype = (\n        protos[i] = hOP.call(opt, 'prototype') ?\n          opt.prototype :\n          create(HTMLElementPrototype)\n      );\n  \n      if (query.length) loopAndVerify(\n        document.querySelectorAll(query),\n        ATTACHED\n      );\n  \n      return constructor;\n    };\n  \n    document.createElement = (patchedCreateElement = function (localName, typeExtension) {\n      var\n        is = getIs(typeExtension),\n        node = is ?\n          createElement.call(document, localName, secondArgument(is)) :\n          createElement.call(document, localName),\n        name = '' + localName,\n        i = indexOf.call(\n          types,\n          (is ? PREFIX_IS : PREFIX_TAG) +\n          (is || name).toUpperCase()\n        ),\n        setup = -1 < i\n      ;\n      if (is) {\n        node.setAttribute('is', is = is.toLowerCase());\n        if (setup) {\n          setup = isInQSA(name.toUpperCase(), is);\n        }\n      }\n      notFromInnerHTMLHelper = !document.createElement.innerHTMLHelper;\n      if (setup) patch(node, protos[i]);\n      return node;\n    });\n  \n  }\n  \n  function ASAP() {\n    var queue = asapQueue.splice(0, asapQueue.length);\n    asapTimer = 0;\n    while (queue.length) {\n      queue.shift().call(\n        null, queue.shift()\n      );\n    }\n  }\n  \n  function loopAndVerify(list, action) {\n    for (var i = 0, length = list.length; i < length; i++) {\n      verifyAndSetupAndAction(list[i], action);\n    }\n  }\n  \n  function loopAndSetup(list) {\n    for (var i = 0, length = list.length, node; i < length; i++) {\n      node = list[i];\n      patch(node, protos[getTypeIndex(node)]);\n    }\n  }\n  \n  function executeAction(action) {\n    return function (node) {\n      if (isValidNode(node)) {\n        verifyAndSetupAndAction(node, action);\n        if (query.length) loopAndVerify(\n          node.querySelectorAll(query),\n          action\n        );\n      }\n    };\n  }\n  \n  function getTypeIndex(target) {\n    var\n      is = getAttribute.call(target, 'is'),\n      nodeName = target.nodeName.toUpperCase(),\n      i = indexOf.call(\n        types,\n        is ?\n            PREFIX_IS + is.toUpperCase() :\n            PREFIX_TAG + nodeName\n      )\n    ;\n    return is && -1 < i && !isInQSA(nodeName, is) ? -1 : i;\n  }\n  \n  function isInQSA(name, type) {\n    return -1 < query.indexOf(name + '[is=\"' + type + '\"]');\n  }\n  \n  function onDOMAttrModified(e) {\n    var\n      node = e.currentTarget,\n      attrChange = e.attrChange,\n      attrName = e.attrName,\n      target = e.target,\n      addition = e[ADDITION] || 2,\n      removal = e[REMOVAL] || 3\n    ;\n    if (notFromInnerHTMLHelper &&\n        (!target || target === node) &&\n        node[ATTRIBUTE_CHANGED_CALLBACK] &&\n        attrName !== 'style' && (\n          e.prevValue !== e.newValue ||\n          // IE9, IE10, and Opera 12 gotcha\n          e.newValue === '' && (\n            attrChange === addition ||\n            attrChange === removal\n          )\n    )) {\n      node[ATTRIBUTE_CHANGED_CALLBACK](\n        attrName,\n        attrChange === addition ? null : e.prevValue,\n        attrChange === removal ? null : e.newValue\n      );\n    }\n  }\n  \n  function onDOMNode(action) {\n    var executor = executeAction(action);\n    return function (e) {\n      asapQueue.push(executor, e.target);\n      if (asapTimer) clearTimeout(asapTimer);\n      asapTimer = setTimeout(ASAP, 1);\n    };\n  }\n  \n  function onReadyStateChange(e) {\n    if (dropDomContentLoaded) {\n      dropDomContentLoaded = false;\n      e.currentTarget.removeEventListener(DOM_CONTENT_LOADED, onReadyStateChange);\n    }\n    if (query.length) loopAndVerify(\n      (e.target || document).querySelectorAll(query),\n      e.detail === DETACHED ? DETACHED : ATTACHED\n    );\n    if (IE8) purge();\n  }\n  \n  function patchedSetAttribute(name, value) {\n    // jshint validthis:true\n    var self = this;\n    setAttribute.call(self, name, value);\n    onSubtreeModified.call(self, {target: self});\n  }\n  \n  function setupNode(node, proto) {\n    setPrototype(node, proto);\n    if (observer) {\n      observer.observe(node, attributesObserver);\n    } else {\n      if (doesNotSupportDOMAttrModified) {\n        node.setAttribute = patchedSetAttribute;\n        node[EXPANDO_UID] = getAttributesMirror(node);\n        node[ADD_EVENT_LISTENER](DOM_SUBTREE_MODIFIED, onSubtreeModified);\n      }\n      node[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED, onDOMAttrModified);\n    }\n    if (node[CREATED_CALLBACK] && notFromInnerHTMLHelper) {\n      node.created = true;\n      node[CREATED_CALLBACK]();\n      node.created = false;\n    }\n  }\n  \n  function purge() {\n    for (var\n      node,\n      i = 0,\n      length = targets.length;\n      i < length; i++\n    ) {\n      node = targets[i];\n      if (!documentElement.contains(node)) {\n        length--;\n        targets.splice(i--, 1);\n        verifyAndSetupAndAction(node, DETACHED);\n      }\n    }\n  }\n  \n  function throwTypeError(type) {\n    throw new Error('A ' + type + ' type is already registered');\n  }\n  \n  function verifyAndSetupAndAction(node, action) {\n    var\n      fn,\n      i = getTypeIndex(node)\n    ;\n    if (-1 < i) {\n      patchIfNotAlready(node, protos[i]);\n      i = 0;\n      if (action === ATTACHED && !node[ATTACHED]) {\n        node[DETACHED] = false;\n        node[ATTACHED] = true;\n        i = 1;\n        if (IE8 && indexOf.call(targets, node) < 0) {\n          targets.push(node);\n        }\n      } else if (action === DETACHED && !node[DETACHED]) {\n        node[ATTACHED] = false;\n        node[DETACHED] = true;\n        i = 1;\n      }\n      if (i && (fn = node[action + CALLBACK])) fn.call(node);\n    }\n  }\n  \n  \n  \n  // V1 in da House!\n  function CustomElementRegistry() {}\n  \n  CustomElementRegistry.prototype = {\n    constructor: CustomElementRegistry,\n    // a workaround for the stubborn WebKit\n    define: usableCustomElements ?\n      function (name, Class, options) {\n        if (options) {\n          CERDefine(name, Class, options);\n        } else {\n          var NAME = name.toUpperCase();\n          constructors[NAME] = {\n            constructor: Class,\n            create: [NAME]\n          };\n          nodeNames.set(Class, NAME);\n          customElements.define(name, Class);\n        }\n      } :\n      CERDefine,\n    get: usableCustomElements ?\n      function (name) {\n        return customElements.get(name) || get(name);\n      } :\n      get,\n    whenDefined: usableCustomElements ?\n      function (name) {\n        return Promise.race([\n          customElements.whenDefined(name),\n          whenDefined(name)\n        ]);\n      } :\n      whenDefined\n  };\n  \n  function CERDefine(name, Class, options) {\n    var\n      is = options && options[EXTENDS] || '',\n      CProto = Class.prototype,\n      proto = create(CProto),\n      attributes = Class.observedAttributes || empty,\n      definition = {prototype: proto}\n    ;\n    // TODO: is this needed at all since it's inherited?\n    // defineProperty(proto, 'constructor', {value: Class});\n    safeProperty(proto, CREATED_CALLBACK, {\n        value: function () {\n          if (justCreated) justCreated = false;\n          else if (!this[DRECEV1]) {\n            this[DRECEV1] = true;\n            new Class(this);\n            if (CProto[CREATED_CALLBACK])\n              CProto[CREATED_CALLBACK].call(this);\n            var info = constructors[nodeNames.get(Class)];\n            if (!usableCustomElements || info.create.length > 1) {\n              notifyAttributes(this);\n            }\n          }\n      }\n    });\n    safeProperty(proto, ATTRIBUTE_CHANGED_CALLBACK, {\n      value: function (name) {\n        if (-1 < indexOf.call(attributes, name))\n          CProto[ATTRIBUTE_CHANGED_CALLBACK].apply(this, arguments);\n      }\n    });\n    if (CProto[CONNECTED_CALLBACK]) {\n      safeProperty(proto, ATTACHED_CALLBACK, {\n        value: CProto[CONNECTED_CALLBACK]\n      });\n    }\n    if (CProto[DISCONNECTED_CALLBACK]) {\n      safeProperty(proto, DETACHED_CALLBACK, {\n        value: CProto[DISCONNECTED_CALLBACK]\n      });\n    }\n    if (is) definition[EXTENDS] = is;\n    name = name.toUpperCase();\n    constructors[name] = {\n      constructor: Class,\n      create: is ? [is, secondArgument(name)] : [name]\n    };\n    nodeNames.set(Class, name);\n    document[REGISTER_ELEMENT](name.toLowerCase(), definition);\n    whenDefined(name);\n    waitingList[name].r();\n  }\n  \n  function get(name) {\n    var info = constructors[name.toUpperCase()];\n    return info && info.constructor;\n  }\n  \n  function getIs(options) {\n    return typeof options === 'string' ?\n        options : (options && options.is || '');\n  }\n  \n  function notifyAttributes(self) {\n    var\n      callback = self[ATTRIBUTE_CHANGED_CALLBACK],\n      attributes = callback ? self.attributes : empty,\n      i = attributes.length,\n      attribute\n    ;\n    while (i--) {\n      attribute =  attributes[i]; // || attributes.item(i);\n      callback.call(\n        self,\n        attribute.name || attribute.nodeName,\n        null,\n        attribute.value || attribute.nodeValue\n      );\n    }\n  }\n  \n  function whenDefined(name) {\n    name = name.toUpperCase();\n    if (!(name in waitingList)) {\n      waitingList[name] = {};\n      waitingList[name].p = new Promise(function (resolve) {\n        waitingList[name].r = resolve;\n      });\n    }\n    return waitingList[name].p;\n  }\n  \n  function polyfillV1() {\n    if (customElements) delete window.customElements;\n    defineProperty(window, 'customElements', {\n      configurable: true,\n      value: new CustomElementRegistry()\n    });\n    defineProperty(window, 'CustomElementRegistry', {\n      configurable: true,\n      value: CustomElementRegistry\n    });\n    for (var\n      patchClass = function (name) {\n        var Class = window[name];\n        if (Class) {\n          window[name] = function CustomElementsV1(self) {\n            var info, isNative;\n            if (!self) self = this;\n            if (!self[DRECEV1]) {\n              justCreated = true;\n              info = constructors[nodeNames.get(self.constructor)];\n              isNative = usableCustomElements && info.create.length === 1;\n              self = isNative ?\n                Reflect.construct(Class, empty, info.constructor) :\n                document.createElement.apply(document, info.create);\n              self[DRECEV1] = true;\n              justCreated = false;\n              if (!isNative) notifyAttributes(self);\n            }\n            return self;\n          };\n          window[name].prototype = Class.prototype;\n          try {\n            Class.prototype.constructor = window[name];\n          } catch(WebKit) {\n            fixGetClass = true;\n            defineProperty(Class, DRECEV1, {value: window[name]});\n          }\n        }\n      },\n      Classes = htmlClass.get(/^HTML[A-Z]*[a-z]/),\n      i = Classes.length;\n      i--;\n      patchClass(Classes[i])\n    ) {}\n    (document.createElement = function (name, options) {\n      var is = getIs(options);\n      return is ?\n        patchedCreateElement.call(this, name, secondArgument(is)) :\n        patchedCreateElement.call(this, name);\n    });\n    if (!V0) {\n      justSetup = true;\n      document[REGISTER_ELEMENT]('');\n    }\n  }\n  \n  // if customElements is not there at all\n  if (!customElements || polyfill === 'force') polyfillV1();\n  else {\n    // if available test extends work as expected\n    try {\n      (function (DRE, options, name) {\n        options[EXTENDS] = 'a';\n        DRE.prototype = create(HTMLAnchorElement.prototype);\n        DRE.prototype.constructor = DRE;\n        window.customElements.define(name, DRE, options);\n        if (\n          getAttribute.call(document.createElement('a', {is: name}), 'is') !== name ||\n          (usableCustomElements && getAttribute.call(new DRE(), 'is') !== name)\n        ) {\n          throw options;\n        }\n      }(\n        function DRE() {\n          return Reflect.construct(HTMLAnchorElement, [], DRE);\n        },\n        {},\n        'document-register-element-a'\n      ));\n    } catch(o_O) {\n      // or force the polyfill if not\n      // and keep internal original reference\n      polyfillV1();\n    }\n  }\n  \n  try {\n    createElement.call(document, 'a', 'a');\n  } catch(FireFox) {\n    secondArgument = function (is) {\n      return {is: is.toLowerCase()};\n    };\n  }\n  \n}\n\nexports.installCustomElements = installCustomElements;\n\n","'use strict';\n\n/**\n * Constructs a ES6/Promises A+ Promise instance.\n *\n * @constructor\n * @param {function(function(*=), function (*=))} resolver\n */\nfunction Promise(resolver) {\n  if (!(this instanceof Promise)) {\n    throw new TypeError('Constructor Promise requires `new`');\n  }\n  if (!isFunction(resolver)) {\n    throw new TypeError('Must pass resolver function');\n  }\n\n  /**\n   * @type {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise}\n   * @private\n   */\n  this._state = PendingPromise;\n\n  /**\n   * @type {*}\n   * @private\n   */\n  this._value = [];\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this._isChainEnd = true;\n\n  doResolve(\n    this,\n    adopter(this, FulfilledPromise),\n    adopter(this, RejectedPromise),\n    { then: resolver }\n  );\n}\n\n/****************************\n  Public Instance Methods\n ****************************/\n\n/**\n * Creates a new promise instance that will receive the result of this promise\n * as inputs to the onFulfilled or onRejected callbacks.\n *\n * @param {function(*)} onFulfilled\n * @param {function(*)} onRejected\n */\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  onFulfilled = isFunction(onFulfilled) ? onFulfilled : void 0;\n  onRejected = isFunction(onRejected) ? onRejected : void 0;\n\n  if (onFulfilled || onRejected) {\n    this._isChainEnd = false;\n  }\n\n  return this._state(\n    this._value,\n    onFulfilled,\n    onRejected\n  );\n};\n\n/**\n * Creates a new promise that will handle the rejected state of this promise.\n *\n * @param {function(*)} onRejected\n * @returns {!Promise}\n */\nPromise.prototype.catch = function(onRejected) {\n  return this.then(void 0, onRejected);\n};\n\n/****************************\n  Public Static Methods\n ****************************/\n\n/**\n * Creates a fulfilled Promise of value. If value is itself a then-able,\n * resolves with the then-able's value.\n *\n * @this {!Promise}\n * @param {*=} value\n * @returns {!Promise}\n */\nPromise.resolve = function(value) {\n  var Constructor = this;\n  var promise;\n\n  if (isObject(value) && value instanceof this) {\n    promise = value;\n  } else {\n    promise = new Constructor(function(resolve) {\n      resolve(value);\n    });\n  }\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a rejected Promise of reason.\n *\n * @this {!Promise}\n * @param {*=} reason\n * @returns {!Promise}\n */\nPromise.reject = function(reason) {\n  var Constructor = this;\n  var promise = new Constructor(function(_, reject) {\n    reject(reason);\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve with an array of the values of the\n * passed in promises. If any promise rejects, the returned promise will\n * reject.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.all = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    var length = promises.length;\n    var values = new Array(length);\n\n    if (length === 0) {\n      return resolve(values);\n    }\n\n    each(promises, function(promise, index) {\n      Constructor.resolve(promise).then(function(value) {\n        values[index] = value;\n        if (--length === 0) {\n          resolve(values);\n        }\n      }, reject);\n    });\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve or reject based on the first\n * resolved or rejected promise.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.race = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    for (var i = 0; i < promises.length; i++) {\n      Constructor.resolve(promises[i]).then(resolve, reject);\n    }\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\nvar onPossiblyUnhandledRejection = function(reason, promise) {\n  throw reason;\n};\n\n/**\n * An internal use static function.\n */\nPromise._overrideUnhandledExceptionHandler = function(handler) {\n  onPossiblyUnhandledRejection = handler;\n};\n\n/****************************\n  Private functions\n ****************************/\n\n/**\n * The Fulfilled Promise state. Calls onFulfilled with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onFulfilled, returns the current promise to avoid an promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} value The current promise's resolved value.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} unused\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Fulfilled state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction FulfilledPromise(value, onFulfilled, unused, deferred) {\n  if (!onFulfilled) {\n    deferredAdopt(deferred, FulfilledPromise, value);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onFulfilled, value));\n  return deferred.promise;\n}\n\n/**\n * The Rejected Promise state. Calls onRejected with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onRejected, returns the current promise to avoid an promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} reason The current promise's rejection reason.\n * @param {function(*=)=} unused\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Rejected state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction RejectedPromise(reason, unused, onRejected, deferred) {\n  if (!onRejected) {\n    deferredAdopt(deferred, RejectedPromise, reason);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onRejected, reason));\n  return deferred.promise;\n}\n\n/**\n * The Pending Promise state. Eventually calls onFulfilled once the promise has\n * resolved, or onRejected once the promise rejects.\n *\n * If there is no onFulfilled and no onRejected, returns the current promise to\n * avoid an promise instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} queue The current promise's pending promises queue.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Pending state from the\n *     Pending state of another promise.\n * @returns {!Promise}\n */\nfunction PendingPromise(queue, onFulfilled, onRejected, deferred) {\n  if (!deferred) {\n    if (!onFulfilled && !onRejected) { return this; }\n    deferred = new Deferred(this.constructor);\n  }\n  queue.push({\n    deferred: deferred,\n    onFulfilled: onFulfilled || deferred.resolve,\n    onRejected: onRejected || deferred.reject\n  });\n  return deferred.promise;\n}\n\n/**\n * Constructs a deferred instance that holds a promise and its resolve and\n * reject functions.\n *\n * @constructor\n */\nfunction Deferred(Promise) {\n  var deferred = this;\n  /** @type {!Promise} */\n  this.promise = new Promise(function(resolve, reject) {\n    /** @type {function(*=)} */\n    deferred.resolve = resolve;\n\n    /** @type {function(*=)} */\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n\n/**\n * Transitions the state of promise to another state. This is only ever called\n * on with a promise that is currently in the Pending state.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction adopt(promise, state, value, adoptee) {\n  var queue = promise._value;\n  promise._state = state;\n  promise._value = value;\n\n  if (adoptee && state === PendingPromise) {\n    adoptee._state(value, void 0, void 0, {\n      promise: promise,\n      resolve: void 0,\n      reject: void 0\n    });\n  }\n\n  for (var i = 0; i < queue.length; i++) {\n    var next = queue[i];\n    promise._state(\n      value,\n      next.onFulfilled,\n      next.onRejected,\n      next.deferred\n    );\n  }\n  queue.length = 0;\n\n  // Determine if this rejected promise will be \"handled\".\n  if (state === RejectedPromise && promise._isChainEnd) {\n    setTimeout(function() {\n      if (promise._isChainEnd) {\n        onPossiblyUnhandledRejection(value, promise);\n      }\n    }, 0);\n  }\n}\n\n/**\n * A partial application of adopt.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @returns {function(*=)}\n */\nfunction adopter(promise, state) {\n  return function(value) {\n    adopt(promise, state, value);\n  };\n}\n\n/**\n * Updates a deferred promises state. Necessary for updating an adopting\n * promise's state when the adoptee resolves.\n *\n * @param {?Deferred} deferred\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction deferredAdopt(deferred, state, value) {\n  if (deferred) {\n    var promise = deferred.promise;\n    promise._state = state;\n    promise._value = value;\n  }\n}\n\n/**\n * A no-op function to prevent double resolving.\n */\nfunction noop() {}\n\n/**\n * Tests if fn is a Function\n *\n * @param {*} fn\n * @returns {boolean}\n */\nfunction isFunction(fn) {\n  return typeof fn === 'function';\n}\n\n/**\n * Tests if fn is an Object\n *\n * @param {*} obj\n * @returns {boolean}\n */\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n/**\n * Iterates over each element of an array, calling the iterator with the\n * element and its index.\n *\n * @param {!Array} collection\n * @param {function(*=,number)} iterator\n */\nfunction each(collection, iterator) {\n  for (var i = 0; i < collection.length; i++) {\n    iterator(collection[i], i);\n  }\n}\n\n/**\n * Creates a function that will attempt to resolve the deferred with the return\n * of fn. If any error is raised, rejects instead.\n *\n * @param {!Deferred} deferred\n * @param {function(*=)} fn\n * @param {*} arg\n * @returns {function()}\n */\nfunction tryCatchDeferred(deferred, fn, arg) {\n  var promise = deferred.promise;\n  var resolve = deferred.resolve;\n  var reject = deferred.reject;\n  return function() {\n    try {\n      var result = fn(arg);\n      doResolve(promise, resolve, reject, result, result);\n    } catch (e) {\n      reject(e);\n    }\n  };\n}\n\n/**\n * Queues and executes multiple deferred functions on another run loop.\n */\nvar defer = (function() {\n  /**\n   * Defers fn to another run loop.\n   */\n  var scheduleFlush;\n  if (typeof window !== 'undefined' && window.postMessage) {\n    window.addEventListener('message', flush);\n    scheduleFlush = function() {\n      window.postMessage('macro-task', '*');\n    };\n  } else {\n    scheduleFlush = function() {\n      setTimeout(flush, 0);\n    };\n  }\n\n  var queue = new Array(16);\n  var length = 0;\n\n  function flush() {\n    for (var i = 0; i < length; i++) {\n      var fn = queue[i];\n      queue[i] = null;\n      fn();\n    }\n    length = 0;\n  }\n\n  /**\n   * @param {function()} fn\n   */\n  function defer(fn) {\n    if (length === 0) { scheduleFlush(); }\n    queue[length++] = fn;\n  }\n\n  return defer;\n})();\n\n/**\n * The Promise resolution procedure.\n * https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n *\n * @param {!Promise} promise\n * @param {function(*=)} resolve\n * @param {function(*=)} reject\n * @param {*} value\n * @param {*=} context\n */\nfunction doResolve(promise, resolve, reject, value, context) {\n  var _reject = reject;\n  var then;\n  var _resolve;\n  try {\n    if (value === promise) {\n      throw new TypeError('Cannot fulfill promise with itself');\n    }\n    var isObj = isObject(value);\n    if (isObj && value instanceof promise.constructor) {\n      adopt(promise, value._state, value._value, value);\n    } else if (isObj && (then = value.then) && isFunction(then)) {\n      _resolve = function(value) {\n        _resolve = _reject = noop;\n        doResolve(promise, resolve, reject, value, value);\n      };\n      _reject = function(reason) {\n        _resolve = _reject = noop;\n        reject(reason);\n      };\n      then.call(\n        context,\n        function(value) { _resolve(value); },\n        function(reason) { _reject(reason); }\n      );\n    } else {\n      resolve(value);\n    }\n  } catch (e) {\n    _reject(e);\n  }\n}\n\nmodule.exports = Promise;\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {internalListenImplementation} from './event-helper-listen';\nimport {parseJson} from './json';\n\n\n/** @const */\nconst AMP_MESSAGE_PREFIX = 'amp-';\nexport const CONSTANTS = {\n  responseTypeSuffix: '-result',\n  messageIdFieldName: 'messageId',\n  payloadFieldName: 'payload',\n  contentFieldName: 'content',\n};\n\n/** @enum {string} */\nexport const MessageType = {\n  // For amp-ad\n  SEND_EMBED_STATE: 'send-embed-state',\n  EMBED_STATE: 'embed-state',\n  SEND_EMBED_CONTEXT: 'send-embed-context',\n  EMBED_CONTEXT: 'embed-context',\n  SEND_INTERSECTIONS: 'send-intersections',\n  INTERSECTION: 'intersection',\n  EMBED_SIZE: 'embed-size',\n  EMBED_SIZE_CHANGED: 'embed-size-changed',\n  EMBED_SIZE_DENIED: 'embed-size-denied',\n  NO_CONTENT: 'no-content',\n  GET_HTML: 'get-html',\n  GET_CONSENT_STATE: 'get-consent-state',\n\n  // For the frame to be placed in full overlay mode for lightboxes\n  FULL_OVERLAY_FRAME: 'full-overlay-frame',\n  FULL_OVERLAY_FRAME_RESPONSE: 'full-overlay-frame-response',\n  CANCEL_FULL_OVERLAY_FRAME: 'cancel-full-overlay-frame',\n  CANCEL_FULL_OVERLAY_FRAME_RESPONSE: 'cancel-full-overlay-frame-response',\n\n  // For amp-inabox\n  SEND_POSITIONS: 'send-positions',\n  POSITION: 'position',\n\n  // For amp-analytics' iframe-transport\n  SEND_IFRAME_TRANSPORT_EVENTS: 'send-iframe-transport-events',\n  IFRAME_TRANSPORT_EVENTS: 'iframe-transport-events',\n  IFRAME_TRANSPORT_RESPONSE: 'iframe-transport-response',\n\n  // For user-error-in-iframe\n  USER_ERROR_IN_IFRAME: 'user-error-in-iframe',\n};\n\n/**\n * Listens for the specified event on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listen(element, eventType, listener, opt_evtListenerOpts) {\n  return internalListenImplementation(\n      element, eventType, listener, opt_evtListenerOpts);\n}\n\n\n/**\n * Serialize an AMP post message. Output looks like:\n * 'amp-011481323099490{\"type\":\"position\",\"sentinel\":\"12345\",\"foo\":\"bar\"}'\n * @param {string} type\n * @param {string} sentinel\n * @param {JsonObject=} data\n * @param {?string=} rtvVersion\n * @return {string}\n */\nexport function serializeMessage(type, sentinel, data = dict(),\n  rtvVersion = null) {\n  // TODO: consider wrap the data in a \"data\" field. { type, sentinal, data }\n  const message = data;\n  message['type'] = type;\n  message['sentinel'] = sentinel;\n  return AMP_MESSAGE_PREFIX + (rtvVersion || '') + JSON.stringify(message);\n}\n\n\n/**\n * Deserialize an AMP post message.\n * Returns null if it's not valid AMP message format.\n *\n * @param {*} message\n * @return {?JsonObject|undefined}\n */\nexport function deserializeMessage(message) {\n  if (!isAmpMessage(message)) {\n    return null;\n  }\n  const startPos = message.indexOf('{');\n  dev().assert(startPos != -1, 'JSON missing in %s', message);\n  try {\n    return parseJson(message.substr(startPos));\n  } catch (e) {\n    dev().error('MESSAGING', 'Failed to parse message: ' + message, e);\n    return null;\n  }\n}\n\n\n/**\n *  Returns true if message looks like it is an AMP postMessage\n *  @param {*} message\n *  @return {boolean}\n */\nexport function isAmpMessage(message) {\n  return (typeof message == 'string' &&\n      message.indexOf(AMP_MESSAGE_PREFIX) == 0 &&\n      message.indexOf('{') != -1);\n}\n\n/** @typedef {{creativeId: string, message: string}} */\nexport let IframeTransportEvent;\n// An event, and the transport ID of the amp-analytics tags that\n// generated it. For instance if the creative with transport\n// ID 2 sends \"hi\", then an IframeTransportEvent would look like:\n// { creativeId: \"2\", message: \"hi\" }\n// If the creative with transport ID 2 sent that, and also sent \"hello\",\n// and the creative with transport ID 3 sends \"goodbye\" then an *array* of 3\n// AmpAnalyticsIframeTransportEvent would be sent to the 3p frame like so:\n// [\n//   { creativeId: \"2\", message: \"hi\" }, // An AmpAnalyticsIframeTransportEvent\n//   { creativeId: \"2\", message: \"hello\" }, // Another\n//   { creativeId: \"3\", message: \"goodbye\" } // And another\n// ]\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Key string in an action arguments map for an unparsed object literal string.\n *\n * E.g. for the action in <p on=\"tap:AMP.setState({foo: 'bar'})\",\n * then `args[RAW_OBJECT_ARGS_KEY]` is the string \"{foo: 'bar'}\".\n *\n * The action service delegates parsing of object literals to the corresponding\n * extension (in the example above, amp-bind).\n *\n * @see ./service/action-impl.ActionInfoDef\n * @const {string}\n */\nexport const RAW_OBJECT_ARGS_KEY = '__AMP_OBJECT_STRING__';\n\n/**\n * Trust level of an action.\n *\n * Corresponds to degree of user intent, i.e. events triggered with strong\n * user intent have high trust.\n *\n * @enum {number}\n */\nexport const ActionTrust = {\n  LOW: 1,\n  HIGH: 100,\n};\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Allows for runtime configuration. Internally, the runtime should\n * use the src/config.js module for various constants. We can use the\n * AMP_CONFIG global to translate user-defined configurations to this\n * module.\n * @type {!Object<string, string>}\n */\nconst env = self.AMP_CONFIG || {};\n\nconst thirdPartyFrameRegex = typeof env['thirdPartyFrameRegex'] == 'string' ?\n  new RegExp(env['thirdPartyFrameRegex']) : env['thirdPartyFrameRegex'];\n\nconst cdnProxyRegex = typeof env['cdnProxyRegex'] == 'string' ?\n  new RegExp(env['cdnProxyRegex']) : env['cdnProxyRegex'];\n\n/** @type {!Object<string, string|boolean|RegExp>} */\nexport const urls = {\n  thirdParty: env['thirdPartyUrl'] || 'https://3p.ampproject.net',\n  thirdPartyFrameHost: env['thirdPartyFrameHost'] || 'ampproject.net',\n  thirdPartyFrameRegex: thirdPartyFrameRegex || /^d-\\d+\\.ampproject\\.net$/,\n  cdn: env['cdnUrl'] || 'https://cdn.ampproject.org',\n  /* Note that cdnProxyRegex is only ever checked against origins\n   * (proto://host[:port]) so does not need to consider path\n   */\n  cdnProxyRegex: cdnProxyRegex ||\n      /^https:\\/\\/([a-zA-Z0-9_-]+\\.)?cdn\\.ampproject\\.org$/,\n  localhostRegex: /^https?:\\/\\/localhost(:\\d+)?$/,\n  errorReporting: env['errorReportingUrl'] ||\n      'https://amp-error-reporting.appspot.com/r',\n  localDev: env['localDev'] || false,\n};\n\nexport const config = {\n  urls,\n};\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {endsWith} from './string';\nimport {\n  isProxyOrigin,\n  parseUrlDeprecated,\n  tryDecodeUriComponent,\n} from './url';\nimport {urls} from './config';\n\n\n/**\n * Returns the value of the cookie. The cookie access is restricted and must\n * go through the privacy review. Before using this method please file a\n * GitHub issue with \"Privacy Review\" label.\n *\n * Returns the cookie's value or `null`.\n *\n * @param {!Window} win\n * @param {string} name\n * @return {?string}\n */\nexport function getCookie(win, name) {\n  const cookieString = tryGetDocumentCookieNoInline(win);\n  if (!cookieString) {\n    return null;\n  }\n  const cookies = cookieString.split(';');\n  for (let i = 0; i < cookies.length; i++) {\n    const cookie = cookies[i].trim();\n    const eq = cookie.indexOf('=');\n    if (eq == -1) {\n      continue;\n    }\n    if (tryDecodeUriComponent(cookie.substring(0, eq).trim()) == name) {\n      const value = cookie.substring(eq + 1).trim();\n      return tryDecodeUriComponent(value, value);\n    }\n  }\n  return null;\n}\n\n/**\n * This method should not be inlined to prevent TryCatch deoptimization.\n * NoInline keyword at the end of function name also prevents Closure compiler\n * from inlining the function.\n * @param {!Window} win\n * @return {string}\n */\nfunction tryGetDocumentCookieNoInline(win) {\n  try {\n    return win.document.cookie;\n  } catch (e) {\n    // Act as if no cookie is available. Exceptions can be thrown when\n    // AMP docs are opened on origins that do not allow setting\n    // cookies such as null origins.\n    return '';\n  }\n}\n\n/**\n * Sets the value of the cookie. The cookie access is restricted and must\n * go through the privacy review. Before using this method please file a\n * GitHub issue with \"Privacy Review\" label.\n *\n * @param {!Window} win\n * @param {string} name\n * @param {string} value\n * @param {time} expirationTime\n * @param {{\n *   highestAvailableDomain:(boolean|undefined),\n *   domain:(string|undefined)\n * }=} opt_options\n *     - highestAvailableDomain: If true, set the cookie at the widest domain\n *       scope allowed by the browser. E.g. on example.com if we are currently\n *       on www.example.com.\n *     - domain: Explicit domain to set.\n *     - allowOnProxyOrigin: Allow setting a cookie on the AMP Cache.\n */\nexport function setCookie(win, name, value, expirationTime, opt_options) {\n  checkOriginForSettingCookie(win, opt_options, name);\n  if (opt_options && opt_options.highestAvailableDomain) {\n    const parts = win.location.hostname.split('.');\n    let domain = parts[parts.length - 1];\n    for (let i = parts.length - 2; i >= 0; i--) {\n      domain = parts[i] + '.' + domain;\n      trySetCookie(win, name, value, expirationTime, domain);\n      if (getCookie(win, name) == value) {\n        return;\n      }\n    }\n  }\n  let domain = undefined;\n  if (opt_options && opt_options.domain) {\n    domain = opt_options.domain;\n  }\n  trySetCookie(win, name, value, expirationTime, domain);\n}\n\n/**\n * Attempt to set a cookie with the given params.\n *\n * @param {!Window} win\n * @param {string} name\n * @param {string} value\n * @param {time} expirationTime\n * @param {string|undefined} domain\n */\nfunction trySetCookie(win, name, value, expirationTime, domain) {\n  // We do not allow setting cookies on the domain that contains both\n  // the cdn. and www. hosts.\n  if (domain == 'ampproject.org') {\n    // Actively delete them.\n    value = 'delete';\n    expirationTime = 0;\n  }\n  const cookie = encodeURIComponent(name) + '=' +\n      encodeURIComponent(value) +\n      '; path=/' +\n      (domain ? '; domain=' + domain : '') +\n      '; expires=' + new Date(expirationTime).toUTCString();\n  try {\n    win.document.cookie = cookie;\n  } catch (ignore) {\n    // Do not throw if setting the cookie failed Exceptions can be thrown\n    // when AMP docs are opened on origins that do not allow setting\n    // cookies such as null origins.\n  }\n}\n\n/**\n * Throws if a given cookie should not be set on the given origin.\n * This is a defense-in-depth. Callers should never run into this.\n *\n * @param {!Window} win\n * @param {!Object|undefined} options\n * @param {string} name For the error message.\n */\nfunction checkOriginForSettingCookie(win, options, name) {\n  if (options && options.allowOnProxyOrigin) {\n    return;\n  }\n  if (isProxyOrigin(win.location.href)) {\n    throw new Error('Should never attempt to set cookie on proxy origin: '\n        + name);\n  }\n\n  const current = parseUrlDeprecated(win.location.href).hostname.toLowerCase();\n  const proxy = parseUrlDeprecated(urls.cdn).hostname.toLowerCase();\n  if (current == proxy || endsWith(current, '.' + proxy)) {\n    throw new Error('Should never attempt to set cookie on proxy origin.'\n        + ' (in depth check): ' + name);\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Deferred} from './utils/promise';\nimport {cssEscape} from '../third_party/css-escape/css-escape';\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {startsWith} from './string';\nimport {toWin} from './types';\n\nconst HTML_ESCAPE_CHARS = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;',\n};\nconst HTML_ESCAPE_REGEX = /(&|<|>|\"|'|`)/g;\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_PROMISE =\n    '__AMP_UPG_PRM';\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_RESOLVER =\n    '__AMP_UPG_RES';\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * callback is executed.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @param {function()} callback\n */\nexport function waitForChild(parent, checkFunc, callback) {\n  if (checkFunc(parent)) {\n    callback();\n    return;\n  }\n  /** @const {!Window} */\n  const win = toWin(parent.ownerDocument.defaultView);\n  if (win.MutationObserver) {\n    /** @const {MutationObserver} */\n    const observer = new win.MutationObserver(() => {\n      if (checkFunc(parent)) {\n        observer.disconnect();\n        callback();\n      }\n    });\n    observer.observe(parent, {childList: true});\n  } else {\n    /** @const {number} */\n    const interval = win.setInterval(() => {\n      if (checkFunc(parent)) {\n        win.clearInterval(interval);\n        callback();\n      }\n    }, /* milliseconds */ 5);\n  }\n}\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * promise is resolved.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @return {!Promise}\n */\nexport function waitForChildPromise(parent, checkFunc) {\n  return new Promise(resolve => {\n    waitForChild(parent, checkFunc, resolve);\n  });\n}\n\n/**\n * Waits for document's body to be available.\n * Will be deprecated soon; use {@link AmpDoc#whenBodyAvailable} or\n * @{link DocumentState#onBodyAvailable} instead.\n * @param {!Document} doc\n * @param {function()} callback\n */\nexport function waitForBody(doc, callback) {\n  waitForChild(doc.documentElement, () => !!doc.body, callback);\n}\n\n\n/**\n * Waits for document's body to be available.\n * @param {!Document} doc\n * @return {!Promise}\n */\nexport function waitForBodyPromise(doc) {\n  return new Promise(resolve => {\n    waitForBody(doc, resolve);\n  });\n}\n\n\n/**\n * Removes the element.\n * @param {!Element} element\n */\nexport function removeElement(element) {\n  if (element.parentElement) {\n    element.parentElement.removeChild(element);\n  }\n}\n\n\n/**\n * Removes all child nodes of the specified element.\n * @param {!Element} parent\n */\nexport function removeChildren(parent) {\n  while (parent.firstChild) {\n    parent.removeChild(parent.firstChild);\n  }\n}\n\n\n/**\n * Copies all children nodes of element \"from\" to element \"to\". Child nodes\n * are deeply cloned. Notice, that this method should be used with care and\n * preferably on smaller subtrees.\n * @param {!Element} from\n * @param {!Element|!DocumentFragment} to\n */\nexport function copyChildren(from, to) {\n  const frag = to.ownerDocument.createDocumentFragment();\n  for (let n = from.firstChild; n; n = n.nextSibling) {\n    frag.appendChild(n.cloneNode(true));\n  }\n  to.appendChild(frag);\n}\n\n/**\n * Insert the element in the root after the element named after or\n * if that is null at the beginning.\n * @param {!Element|!ShadowRoot} root\n * @param {!Element} element\n * @param {?Node} after\n */\nexport function insertAfterOrAtStart(root, element, after) {\n  const before = after ? after.nextSibling : root.firstChild;\n  root.insertBefore(element, before);\n}\n\n/**\n * Add attributes to an element.\n * @param {!Element} element\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function addAttributesToElement(element, attributes) {\n  for (const attr in attributes) {\n    element.setAttribute(attr, attributes[attr]);\n  }\n  return element;\n}\n\n/**\n * Create a new element on document with specified tagName and attributes.\n * @param {!Document} doc\n * @param {string} tagName\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function createElementWithAttributes(doc, tagName, attributes) {\n  const element = doc.createElement(tagName);\n  return addAttributesToElement(element, attributes);\n}\n\n/**\n * Returns true if node is connected (attached).\n * @param {!Node} node\n * @return {boolean}\n * @see https://dom.spec.whatwg.org/#connected\n */\nexport function isConnectedNode(node) {\n  const connected = node.isConnected;\n  if (connected !== undefined) {\n    return connected;\n  }\n\n  // \"An element is connected if its shadow-including root is a document.\"\n  let n = node;\n  do {\n    n = rootNodeFor(n);\n    if (n.host) {\n      n = n.host;\n    } else {\n      break;\n    }\n  } while (true);\n  return n.nodeType === Node.DOCUMENT_NODE;\n}\n\n/**\n * Returns the root for a given node. Does not cross shadow DOM boundary.\n * @param {!Node} node\n * @return {!Node}\n */\nexport function rootNodeFor(node) {\n  if (Node.prototype.getRootNode) {\n    // Type checker says `getRootNode` may return null.\n    return node.getRootNode() || node;\n  }\n  let n;\n  for (n = node; !!n.parentNode; n = n.parentNode) {}\n  return n;\n}\n\n/**\n * Finds the closest element that satisfies the callback from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {function(!Element):boolean} callback\n * @param {Element=} opt_stopAt optional elemnt to stop the search at.\n * @return {?Element}\n */\nexport function closest(element, callback, opt_stopAt) {\n  for (let el = element; el && el !== opt_stopAt; el = el.parentElement) {\n    if (callback(el)) {\n      return el;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest node that satisfies the callback from this node\n * up the DOM subtree.\n * @param {!Node} node\n * @param {function(!Node):boolean} callback\n * @return {?Node}\n */\nexport function closestNode(node, callback) {\n  for (let n = node; n; n = n.parentNode) {\n    if (callback(n)) {\n      return n;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest element with the specified name from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function closestByTag(element, tagName) {\n  if (element.closest) {\n    return element.closest(tagName);\n  }\n  tagName = tagName.toUpperCase();\n  return closest(element, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Finds the closest element with the specified selector from this element\n * @param {!Element} element\n * @param {string} selector\n * @return {?Element} closest ancestor if found.\n */\nexport function closestBySelector(element, selector) {\n  if (element.closest) {\n    return element.closest(selector);\n  }\n\n  return closest(element, el => {\n    return matches(el, selector);\n  });\n}\n\n/**\n * Checks if the given element matches the selector\n * @param  {!Element} el The element to verify\n * @param  {string} selector The selector to check against\n * @return {boolean} True if the element matched the selector. False otherwise.\n */\nexport function matches(el, selector) {\n  const matcher = el.matches ||\n      el.webkitMatchesSelector ||\n      el.mozMatchesSelector ||\n      el.msMatchesSelector ||\n      el.oMatchesSelector;\n  if (matcher) {\n    return matcher.call(el, selector);\n  }\n  return false; // IE8 always returns false.\n}\n\n/**\n * Finds the first descendant element with the specified name.\n * @param {!Element|!Document|!ShadowRoot} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function elementByTag(element, tagName) {\n  let elements;\n  // getElementsByTagName() is not supported on ShadowRoot.\n  if (typeof element.getElementsByTagName === 'function') {\n    elements = element.getElementsByTagName(tagName);\n  } else {\n    elements = element./*OK*/querySelectorAll(tagName);\n  }\n  return (elements && elements[0]) || null;\n}\n\n\n/**\n * Finds the first child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function childElement(parent, callback) {\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds all child elements that satisfy the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {!Array<!Element>}\n */\nexport function childElements(parent, callback) {\n  const children = [];\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      children.push(child);\n    }\n  }\n  return children;\n}\n\n\n/**\n * Finds the last child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function lastChildElement(parent, callback) {\n  for (let child = parent.lastElementChild; child;\n    child = child.previousElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n/**\n * Finds all child nodes that satisfy the callback.\n * These nodes can include Text, Comment and other child nodes.\n * @param {!Node} parent\n * @param {function(!Node):boolean} callback\n * @return {!Array<!Node>}\n */\nexport function childNodes(parent, callback) {\n  const nodes = [];\n  for (let child = parent.firstChild; child;\n    child = child.nextSibling) {\n    if (callback(child)) {\n      nodes.push(child);\n    }\n  }\n  return nodes;\n}\n\n/**\n * @type {boolean|undefined}\n * @visibleForTesting\n */\nlet scopeSelectorSupported;\n\n/**\n * @param {boolean|undefined} val\n * @visibleForTesting\n */\nexport function setScopeSelectorSupportedForTesting(val) {\n  scopeSelectorSupported = val;\n}\n\n/**\n * Test that the :scope selector is supported and behaves correctly.\n * @param {!Element} parent\n * @return {boolean}\n */\nfunction isScopeSelectorSupported(parent) {\n  const doc = parent.ownerDocument;\n  try {\n    const testElement = doc.createElement('div');\n    const testChild = doc.createElement('div');\n    testElement.appendChild(testChild);\n    // NOTE(cvializ, #12383): Firefox's implementation is incomplete,\n    // therefore we test actual functionality of`:scope` as well.\n    return testElement./*OK*/querySelector(':scope div') === testChild;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Finds the first child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function childElementByAttr(parent, attr) {\n  return scopedQuerySelector/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the last child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function lastChildElementByAttr(parent, attr) {\n  return lastChildElement(parent, el => {\n    return el.hasAttribute(attr);\n  });\n}\n\n\n/**\n * Finds all child elements that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByAttr(parent, attr) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the first child element that has the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {?Element}\n */\nexport function childElementByTag(parent, tagName) {\n  return scopedQuerySelector/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds all child elements with the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByTag(parent, tagName) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds the first element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {?Element}\n */\nexport function scopedQuerySelector(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelector(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const element = root./*OK*/querySelector(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return element;\n}\n\n\n/**\n * Finds the every element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {!NodeList<!Element>}\n */\nexport function scopedQuerySelectorAll(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelectorAll(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const elements = root./*OK*/querySelectorAll(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return elements;\n}\n\n\n/**\n * Returns element data-param- attributes as url parameters key-value pairs.\n * e.g. data-param-some-attr=value -> {someAttr: value}.\n * @param {!Element} element\n * @param {function(string):string=} opt_computeParamNameFunc to compute the\n *    parameter name, get passed the camel-case parameter name.\n * @param {!RegExp=} opt_paramPattern Regex pattern to match data attributes.\n * @return {!JsonObject}\n */\nexport function getDataParamsFromAttributes(element, opt_computeParamNameFunc,\n  opt_paramPattern) {\n  const computeParamNameFunc = opt_computeParamNameFunc || (key => key);\n  const {dataset} = element;\n  const params = dict();\n  const paramPattern = opt_paramPattern ? opt_paramPattern : /^param(.+)/;\n  for (const key in dataset) {\n    const matches = key.match(paramPattern);\n    if (matches) {\n      const param = matches[1][0].toLowerCase() + matches[1].substr(1);\n      params[computeParamNameFunc(param)] = dataset[key];\n    }\n  }\n  return params;\n}\n\n/**\n * Whether the element have a next node in the document order.\n * This means either:\n *  a. The element itself has a nextSibling.\n *  b. Any of the element ancestors has a nextSibling.\n * @param {!Element} element\n * @param {?Node} opt_stopNode\n * @return {boolean}\n */\nexport function hasNextNodeInDocumentOrder(element, opt_stopNode) {\n  let currentElement = element;\n  do {\n    if (currentElement.nextSibling) {\n      return true;\n    }\n  } while ((currentElement = currentElement.parentNode) &&\n            currentElement != opt_stopNode);\n  return false;\n}\n\n\n/**\n * Finds all ancestor elements that satisfy predicate.\n * @param {!Element} child\n * @param {function(!Element):boolean} predicate\n * @return {!Array<!Element>}\n */\nexport function ancestorElements(child, predicate) {\n  const ancestors = [];\n  for (let ancestor = child.parentElement; ancestor;\n    ancestor = ancestor.parentElement) {\n    if (predicate(ancestor)) {\n      ancestors.push(ancestor);\n    }\n  }\n  return ancestors;\n}\n\n\n/**\n * Finds all ancestor elements that has the specified tag name.\n * @param {!Element} child\n * @param {string} tagName\n * @return {!Array<!Element>}\n */\nexport function ancestorElementsByTag(child, tagName) {\n  tagName = tagName.toUpperCase();\n  return ancestorElements(child, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Returns a clone of the content of a template element.\n *\n * Polyfill to replace .content access for browsers that do not support\n * HTMLTemplateElements natively.\n *\n * @param {!HTMLTemplateElement|!Element} template\n * @return {!DocumentFragment}\n */\nexport function templateContentClone(template) {\n  if ('content' in template) {\n    return template.content.cloneNode(true);\n  } else {\n    const content = template.ownerDocument.createDocumentFragment();\n    copyChildren(template, content);\n    return content;\n  }\n}\n\n/**\n * Iterate over an array-like. Some collections like NodeList are\n * lazily evaluated in some browsers, and accessing `length` forces full\n * evaluation. We can improve performance by iterating until an element is\n * `undefined` to avoid checking the `length` property.\n * Test cases: https://jsperf.com/iterating-over-collections-of-elements\n * @param {!IArrayLike<T>} iterable\n * @param {function(T, number)} cb\n * @template T\n */\nexport function iterateCursor(iterable, cb) {\n  for (let i = 0, value; (value = iterable[i]) !== undefined; i++) {\n    cb(value, i);\n  }\n}\n\n/**\n * This method wraps around window's open method. It first tries to execute\n * `open` call with the provided target and if it fails, it retries the call\n * with the `_top` target. This is necessary given that in some embedding\n * scenarios, such as iOS' WKWebView, navigation to `_blank` and other targets\n * is blocked by default.\n *\n * @param {!Window} win\n * @param {string} url\n * @param {string} target\n * @param {string=} opt_features\n * @return {?Window}\n */\nexport function openWindowDialog(win, url, target, opt_features) {\n  // Try first with the specified target. If we're inside the WKWebView or\n  // a similar environments, this method is expected to fail by default for\n  // all targets except `_top`.\n  let res;\n  try {\n    res = win.open(url, target, opt_features);\n  } catch (e) {\n    dev().error('DOM', 'Failed to open url on target: ', target, e);\n  }\n\n  // Then try with `_top` target.\n  if (!res && target != '_top') {\n    res = win.open(url, '_top');\n  }\n  return res;\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n            element.getAttribute('type').toUpperCase() == 'APPLICATION/JSON';\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonLdScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n      element.getAttribute('type').toUpperCase() == 'APPLICATION/LD+JSON';\n}\n\n/**\n * Whether the page's direction is right to left or not.\n * @param {!Document} doc\n * @return {boolean}\n */\nexport function isRTL(doc) {\n  const dir = doc.body.getAttribute('dir')\n                 || doc.documentElement.getAttribute('dir')\n                 || 'ltr';\n  return dir == 'rtl';\n}\n\n\n/**\n * Escapes an ident (ID or a class name) to be used as a CSS selector.\n *\n * See https://drafts.csswg.org/cssom/#serialize-an-identifier.\n *\n * @param {string} ident\n * @return {string}\n */\nexport function escapeCssSelectorIdent(ident) {\n  return cssEscape(ident);\n}\n\n/**\n * Escapes an ident in a way that can be used by :nth-child() psuedo-class.\n *\n * See https://github.com/w3c/csswg-drafts/issues/2306.\n *\n * @param {string|number} ident\n * @return {string}\n */\nexport function escapeCssSelectorNth(ident) {\n  const escaped = String(ident);\n  // Ensure it doesn't close the nth-child psuedo class.\n  dev().assert(escaped.indexOf(')') === -1);\n  return escaped;\n}\n\n/**\n * Escapes `<`, `>` and other HTML charcaters with their escaped forms.\n * @param {string} text\n * @return {string}\n */\nexport function escapeHtml(text) {\n  if (!text) {\n    return text;\n  }\n  return text.replace(HTML_ESCAPE_REGEX, escapeHtmlChar);\n}\n\n/**\n * @param {string} c\n * @return {string}\n */\nfunction escapeHtmlChar(c) {\n  return HTML_ESCAPE_CHARS[c];\n}\n\n/**\n * Tries to focus on the given element; fails silently if browser throws an\n * exception.\n * @param {!Element} element\n */\nexport function tryFocus(element) {\n  try {\n    element./*OK*/focus();\n  } catch (e) {\n    // IE <= 7 may throw exceptions when focusing on hidden items.\n  }\n}\n\n/**\n * Whether the given window is in an iframe or not.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isIframed(win) {\n  return win.parent && win.parent != win;\n}\n\n/**\n * Determines if this element is an AMP element\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isAmpElement(element) {\n  const tag = element.tagName;\n  // Use prefix to recognize AMP element. This is necessary because stub\n  // may not be attached yet.\n  return startsWith(tag, 'AMP-') &&\n      // Some \"amp-*\" elements are not really AMP elements. :smh:\n      !(tag == 'AMP-STICKY-AD-TOP-PADDING' || tag == 'AMP-BODY');\n}\n\n/**\n * Return a promise that resolve when an AMP element upgrade from HTMLElement\n * to CustomElement\n * @param {!Element} element\n * @return {!Promise<!Element>}\n */\nexport function whenUpgradedToCustomElement(element) {\n  dev().assert(isAmpElement(element), 'element is not AmpElement');\n  if (element.createdCallback) {\n    // Element already is CustomElement;\n    return Promise.resolve(element);\n  }\n  // If Element is still HTMLElement, wait for it to upgrade to customElement\n  // Note: use pure string to avoid obfuscation between versions.\n  if (!element[UPGRADE_TO_CUSTOMELEMENT_PROMISE]) {\n    const deferred = new Deferred();\n    element[UPGRADE_TO_CUSTOMELEMENT_PROMISE] = deferred.promise;\n    element[UPGRADE_TO_CUSTOMELEMENT_RESOLVER] = deferred.resolve;\n\n  }\n\n  return element[UPGRADE_TO_CUSTOMELEMENT_PROMISE];\n}\n\n/**\n * Replacement for `Element.requestFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Element/requestFullscreen\n * @param {!Element} element\n */\nexport function fullscreenEnter(element) {\n  const requestFs = element.requestFullscreen\n   || element.requestFullScreen\n   || element.webkitRequestFullscreen\n   || element.webkitRequestFullScreen\n   || element.webkitEnterFullscreen\n   || element.webkitEnterFullScreen\n   || element.msRequestFullscreen\n   || element.msRequestFullScreen\n   || element.mozRequestFullscreen\n   || element.mozRequestFullScreen;\n  if (requestFs) {\n    requestFs.call(element);\n  }\n}\n\n/**\n * Replacement for `Document.exitFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/exitFullscreen\n * @param {!Element} element\n */\nexport function fullscreenExit(element) {\n  let exitFs = element.cancelFullScreen\n              || element.exitFullscreen\n              || element.exitFullScreen\n              || element.webkitExitFullscreen\n              || element.webkitExitFullScreen\n              || element.webkitCancelFullScreen\n              || element.mozCancelFullScreen\n              || element.msExitFullscreen;\n  if (exitFs) {\n    exitFs.call(element);\n    return;\n  }\n  if (element.ownerDocument) {\n    exitFs = element.ownerDocument.cancelFullScreen\n             || element.ownerDocument.exitFullscreen\n             || element.ownerDocument.exitFullScreen\n             || element.ownerDocument.webkitExitFullscreen\n             || element.ownerDocument.webkitExitFullScreen\n             || element.ownerDocument.webkitCancelFullScreen\n             || element.ownerDocument.mozCancelFullScreen\n             || element.ownerDocument.msExitFullscreen;\n  }\n  if (exitFs) {\n    exitFs.call(element.ownerDocument);\n    return;\n  }\n}\n\n\n/**\n * Replacement for `Document.fullscreenElement`.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/fullscreenElement\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isFullscreenElement(element) {\n  const isFullscreen = element.webkitDisplayingFullscreen;\n  if (isFullscreen) {\n    return true;\n  }\n  if (element.ownerDocument) {\n    const fullscreenElement = element.ownerDocument.fullscreenElement\n             || element.ownerDocument.webkitFullscreenElement\n             || element.ownerDocument.mozFullScreenElement\n             || element.webkitCurrentFullScreenElement;\n    if (fullscreenElement == element) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Returns true if node is not disabled.\n *\n * IE8 can return false positives, see {@link matches}.\n * @param {!Element} element\n * @return {boolean}\n * @see https://www.w3.org/TR/html5/forms.html#concept-fe-disabled\n */\nexport function isEnabled(element) {\n  return !(element.disabled || matches(element, ':disabled'));\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as dom from './dom';\nimport {\n  getAmpdoc,\n  getExistingServiceForDocInEmbedScope,\n  getService,\n  getServicePromise,\n  getServicePromiseForDoc,\n  getServicePromiseOrNull,\n  getServicePromiseOrNullForDoc,\n  getTopWindow,\n} from './service';\nimport {toWin} from './types';\nimport {user} from './log';\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. Services.viewportForDoc(...)) for type safety and because the\n * factory should not be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an element,\n *     not the extension.\n * @return {!Promise<*>}\n */\nexport function getElementService(win, id, extension, opt_element) {\n  return getElementServiceIfAvailable(win, id, extension, opt_element).then(\n      service => assertService(service, id, extension));\n}\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailable(win, id, extension, opt_element) {\n  const s = getServicePromiseOrNull(win, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n  return getElementServicePromiseOrNull(win, id, extension, opt_element);\n}\n\n/**\n * @param {!Window} win\n * @param {string} elementName Name of an extended custom element.\n * @return {boolean} Whether this element is scheduled to be loaded.\n */\nfunction isElementScheduled(win, elementName) {\n  // Set in custom-element.js\n  if (!win.ampExtendedElements) {\n    return false;\n  }\n  return !!win.ampExtendedElements[elementName];\n}\n\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. Services.viewportForDoc(...)) for type safety and because the\n * factory should not be passed around.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an element,\n *     not the extension.\n * @return {!Promise<*>}\n */\nexport function getElementServiceForDoc(elementOrAmpDoc, id, extension,\n  opt_element) {\n  return getElementServiceIfAvailableForDoc(\n      elementOrAmpDoc, id, extension, opt_element)\n      .then(service => assertService(service, id, extension));\n}\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDoc(\n  elementOrAmpDoc, id, extension, opt_element) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const s = getServicePromiseOrNullForDoc(elementOrAmpDoc, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n\n  return ampdoc.whenBodyAvailable()\n      .then(() => waitForExtensionIfPresent(\n          ampdoc.win, extension,\n          ampdoc.getHeadNode()))\n      .then(() => {\n        // If this service is provided by an element, then we can't depend on\n        // the service (they may not use the element).\n        if (opt_element) {\n          return getServicePromiseOrNullForDoc(elementOrAmpDoc, id);\n        } else if (isElementScheduled(ampdoc.win, extension)) {\n          return getServicePromiseForDoc(elementOrAmpDoc, id);\n        }\n        return null;\n      });\n}\n\n/**\n * Returns a promise for service for the given id in the embed scope of\n * a given node, if it exists. Otherwise, falls back to ampdoc scope IFF\n * the given node is in the top-level window.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom element that provides\n *     the implementation of this service.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDocInEmbedScope(\n  elementOrAmpDoc, id, extension) {\n  const s = getExistingServiceForDocInEmbedScope(elementOrAmpDoc, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (Promise.resolve(s));\n  }\n  // Return embed-scope element service promise if scheduled.\n  if (elementOrAmpDoc.nodeType) {\n    const win = toWin(elementOrAmpDoc.ownerDocument.defaultView);\n    const topWin = getTopWindow(win);\n    // In embeds, doc-scope services are window-scope. But make sure to\n    // only do this for embeds (not the top window), otherwise we'd grab\n    // a promise from the wrong service holder which would never resolve.\n    if (win !== topWin) {\n      return getElementServicePromiseOrNull(win, id, extension);\n    } else {\n      // Fallback to ampdoc IFF the given node is _not_ FIE.\n      return getElementServiceIfAvailableForDoc(elementOrAmpDoc, id, extension);\n    }\n  }\n  return /** @type {!Promise<?Object>} */ (Promise.resolve(null));\n}\n\n/**\n * Throws user error if `service` is null.\n * @param {Object} service\n * @param {string} id\n * @param {string} extension\n * @return {!Object}\n * @private\n */\nfunction assertService(service, id, extension) {\n  return /** @type {!Object} */ (user().assert(service,\n      'Service %s was requested to be provided through %s, ' +\n      'but %s is not loaded in the current page. To fix this ' +\n      'problem load the JavaScript file for %s in this page.',\n      id, extension, extension, extension));\n}\n\n/**\n * Get list of all the extension JS files\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @return {!Array<string>}\n */\nexport function extensionScriptsInNode(head) {\n  // ampdoc.getHeadNode() can return null\n  if (!head) {\n    return [];\n  }\n  const scripts = [];\n  const list = head.querySelectorAll('script[custom-element]');\n  for (let i = 0; i < list.length; i++) {\n    scripts.push(list[i].getAttribute('custom-element'));\n  }\n  return scripts;\n}\n\n/**\n * Waits for body to be present then verifies that an extension script is\n * present in head for installation.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n * @param {string} extensionId\n * @return {!Promise<boolean>}\n */\nexport function isExtensionScriptInNode(ampdoc, extensionId) {\n  return ampdoc.whenBodyAvailable()\n      .then(() => {\n        return extensionScriptInNode(\n            ampdoc.getHeadNode(), extensionId);\n      });\n}\n\n/**\n * Verifies that an extension script is present in head for\n * installation.\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @param {string} extensionId\n * @private\n */\nfunction extensionScriptInNode(head, extensionId) {\n  return extensionScriptsInNode(head).includes(extensionId);\n}\n\n/**\n * Waits for an extension if its script is present\n * @param {!Window} win\n * @param {string} extension\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @return {!Promise}\n * @private\n */\nfunction waitForExtensionIfPresent(win, extension, head) {\n  /**\n   * If there is an extension script wait for it to load before trying\n   * to get the service. Prevents a race condition when everything but\n   * the extensions is in cache. If there is no script then it's either\n   * not present, or the service was defined by a test. In those cases\n   * we don't wait around for an extension that does not exist.\n   */\n\n  // TODO(jpettitt) investigate registerExtension to short circuit\n  // the dom call in extensionScriptsInNode()\n  if (!extensionScriptInNode(head, extension)) {\n    return Promise.resolve();\n  }\n\n  const extensions = getService(win, 'extensions');\n  return /** @type {!Promise<?Object>} */ (\n    extensions.waitForExtension(win, extension));\n}\n\n/**\n * Returns the promise for service with `id` on the given window if available.\n * Otherwise, resolves with null (service was not registered).\n * @param {!Window} win\n * @param {string} id\n * @param {string} extension\n * @param {boolean=} opt_element\n * @return {!Promise<Object>}\n * @private\n */\nfunction getElementServicePromiseOrNull(win, id, extension, opt_element) {\n  return dom.waitForBodyPromise(win.document)\n      .then(() => waitForExtensionIfPresent(win, extension, win.document.head))\n      .then(() => {\n        // If this service is provided by an element, then we can't depend on\n        // the service (they may not use the element).\n        if (opt_element) {\n          return getServicePromiseOrNull(win, id);\n        } else if (isElementScheduled(win, extension)) {\n          return getServicePromise(win, id);\n        }\n        return null;\n      });\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n  * Whether addEventListener supports options or only takes capture as a boolean\n  * @type {boolean|undefined}\n  * @visibleForTesting\n  */\nlet optsSupported;\n\n/**\n * Listens for the specified event on the element.\n *\n * Do not use this directly. This method is implemented as a shared\n * dependency. Use `listen()` in either `event-helper` or `3p-frame-messaging`,\n * depending on your use case.\n *\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function internalListenImplementation(element, eventType, listener,\n  opt_evtListenerOpts) {\n  let localElement = element;\n  let localListener = listener;\n  /**\n   * @type {?Function}\n   */\n  let wrapped;\n\n  wrapped = event => {\n    try {\n      return localListener(event);\n    } catch (e) {\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n  };\n  const optsSupported = detectEvtListenerOptsSupport();\n  let capture = false;\n  if (opt_evtListenerOpts) {\n    capture = opt_evtListenerOpts.capture;\n  }\n  localElement.addEventListener(\n      eventType,\n      wrapped,\n      optsSupported ? opt_evtListenerOpts : capture\n  );\n  return () => {\n    if (localElement) {\n      localElement.removeEventListener(\n          eventType,\n          wrapped,\n          optsSupported ? opt_evtListenerOpts : capture\n      );\n    }\n    // Ensure these are GC'd\n    localListener = null;\n    localElement = null;\n    wrapped = null;\n  };\n}\n\n/**\n * Tests whether the browser supports options as an argument of addEventListener\n * or not.\n *\n * @return {boolean}\n */\nexport function detectEvtListenerOptsSupport() {\n  // Only run the test once\n  if (optsSupported !== undefined) {\n    return optsSupported;\n  }\n\n  optsSupported = false;\n  try {\n    // Test whether browser supports EventListenerOptions or not\n    const options = {\n      get capture() {\n        optsSupported = true;\n      },\n    };\n    self.addEventListener('test-options', null, options);\n    self.removeEventListener('test-options', null, options);\n  } catch (err) {\n    // EventListenerOptions are not supported\n  }\n  return optsSupported;\n}\n\n/**\n  * Resets the test for whether addEventListener supports options or not.\n  */\nexport function resetEvtListenerOptsSupportForTesting() {\n  optsSupported = undefined;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {internalListenImplementation} from './event-helper-listen';\nimport {user} from './log';\n\n/** @const {string}  */\nconst LOAD_FAILURE_PREFIX = 'Failed to load:';\n\n/**\n * Returns a CustomEvent with a given type and detail; supports fallback for IE.\n * @param {!Window} win\n * @param {string} type\n * @param {!JsonObject|string|undefined|null} detail\n * @param {EventInit=} opt_eventInit\n * @return {!Event}\n */\nexport function createCustomEvent(win, type, detail, opt_eventInit) {\n  const eventInit = /** @type {!CustomEventInit} */ ({detail});\n  Object.assign(eventInit, opt_eventInit);\n  // win.CustomEvent is a function on Edge, Chrome, FF, Safari but\n  // is an object on IE 11.\n  if (typeof win.CustomEvent == 'function') {\n    return new win.CustomEvent(type, eventInit);\n  } else {\n    // Deprecated fallback for IE.\n    const e = win.document.createEvent('CustomEvent');\n    e.initCustomEvent(\n        type, !!eventInit.bubbles, !!eventInit.cancelable, detail);\n    return e;\n  }\n}\n\n/**\n * Listens for the specified event on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listen(element, eventType, listener, opt_evtListenerOpts) {\n  return internalListenImplementation(\n      element, eventType, listener, opt_evtListenerOpts);\n}\n\n/**\n * Returns the data property of an event with the correct type.\n * @param {!Event|{data: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getData(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.data);\n}\n\n/**\n * Returns the detail property of an event with the correct type.\n * @param {!Event|{detail: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getDetail(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.detail);\n}\n\n/**\n * Listens for the specified event on the element and removes the listener\n * as soon as event has been received.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listenOnce(element, eventType, listener, opt_evtListenerOpts) {\n  let localListener = listener;\n  const unlisten = internalListenImplementation(element, eventType, event => {\n    try {\n      localListener(event);\n    } finally {\n      // Ensure listener is GC'd\n      localListener = null;\n      unlisten();\n    }\n  }, opt_evtListenerOpts);\n  return unlisten;\n}\n\n\n/**\n * Returns  a promise that will resolve as soon as the specified event has\n * fired on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {Object=} opt_evtListenerOpts\n * @param {function(!UnlistenDef)=} opt_cancel An optional function that, when\n *     provided, will be called with the unlistener. This gives the caller\n *     access to the unlistener, so it may be called manually when necessary.\n * @return {!Promise<!Event>}\n */\nexport function listenOncePromise(element, eventType, opt_evtListenerOpts,\n  opt_cancel) {\n  let unlisten;\n  const eventPromise = new Promise(resolve => {\n    unlisten = listenOnce(element, eventType, resolve, opt_evtListenerOpts);\n  });\n  eventPromise.then(unlisten, unlisten);\n  if (opt_cancel) {\n    opt_cancel(unlisten);\n  }\n  return eventPromise;\n}\n\n\n/**\n * Whether the specified element/window has been loaded already.\n * @param {!Element|!Window} eleOrWindow\n * @return {boolean}\n */\nexport function isLoaded(eleOrWindow) {\n  return !!(eleOrWindow.complete || eleOrWindow.readyState == 'complete'\n      // If the passed in thing is a Window, infer loaded state from\n      //\n      || (eleOrWindow.document\n          && eleOrWindow.document.readyState == 'complete'));\n}\n\n/**\n * Returns a promise that will resolve or fail based on the eleOrWindow's 'load'\n * and 'error' events. Optionally this method takes a timeout, which will reject\n * the promise if the resource has not loaded by then.\n * @param {T} eleOrWindow Supports both Elements and as a special case Windows.\n * @return {!Promise<T>}\n * @template T\n */\nexport function loadPromise(eleOrWindow) {\n  let unlistenLoad;\n  let unlistenError;\n  if (isLoaded(eleOrWindow)) {\n    return Promise.resolve(eleOrWindow);\n  }\n  const loadingPromise = new Promise((resolve, reject) => {\n    // Listen once since IE 5/6/7 fire the onload event continuously for\n    // animated GIFs.\n    const {tagName} = eleOrWindow;\n    if (tagName === 'AUDIO' || tagName === 'VIDEO') {\n      unlistenLoad = listenOnce(eleOrWindow, 'loadstart', resolve);\n    } else {\n      unlistenLoad = listenOnce(eleOrWindow, 'load', resolve);\n    }\n    // For elements, unlisten on error (don't for Windows).\n    if (tagName) {\n      unlistenError = listenOnce(eleOrWindow, 'error', reject);\n    }\n  });\n\n  return loadingPromise.then(() => {\n    if (unlistenError) {\n      unlistenError();\n    }\n    return eleOrWindow;\n  }, () => {\n    if (unlistenLoad) {\n      unlistenLoad();\n    }\n    failedToLoad(eleOrWindow);\n  });\n}\n\n/**\n * Emit error on load failure.\n * @param {!Element|!Window} eleOrWindow Supports both Elements and as a special\n *     case Windows.\n */\nfunction failedToLoad(eleOrWindow) {\n  // Report failed loads as user errors so that they automatically go\n  // into the \"document error\" bucket.\n  let target = eleOrWindow;\n  if (target && target.src) {\n    target = target.src;\n  }\n  throw user().createError(LOAD_FAILURE_PREFIX, target);\n}\n\n/**\n * Returns true if this error message is was created for a load error.\n * @param {string} message An error message\n * @return {boolean}\n */\nexport function isLoadErrorMessage(message) {\n  return message.indexOf(LOAD_FAILURE_PREFIX) != -1;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Experiments system allows a developer to opt-in to test\n * features that are not yet fully tested.\n *\n * Experiments page: https://cdn.ampproject.org/experiments.html *\n */\n\nimport {getCookie, setCookie} from './cookies';\nimport {hasOwn} from './utils/object';\nimport {parseQueryString} from './url';\n\n/** @const {string} */\nconst COOKIE_NAME = 'AMP_EXP';\n\n/** @const {number} */\nconst COOKIE_MAX_AGE_DAYS = 180; // 6 month\n\n/** @const {time} */\nconst COOKIE_EXPIRATION_INTERVAL = COOKIE_MAX_AGE_DAYS * 24 * 60 * 60 * 1000;\n\n/** @const {string} */\nconst TOGGLES_WINDOW_PROPERTY = '__AMP__EXPERIMENT_TOGGLES';\n\n/**\n * @typedef {{\n *   isTrafficEligible: function(!Window):boolean,\n *   branches: !Array<string>\n * }}\n */\nexport let ExperimentInfo;\n\n/**\n * Whether we are in canary.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isCanary(win) {\n  return !!(win.AMP_CONFIG && win.AMP_CONFIG.canary);\n}\n\n/**\n * Returns binary type, e.g., canary, control, or production.\n * @param {!Window} win\n * @return {string}\n */\nexport function getBinaryType(win) {\n  return win.AMP_CONFIG && win.AMP_CONFIG.type ?\n    win.AMP_CONFIG.type : 'unknown';\n}\n\n/**\n * Whether the specified experiment is on or off.\n * @param {!Window} win\n * @param {string} experimentId\n * @return {boolean}\n */\nexport function isExperimentOn(win, experimentId) {\n  const toggles = experimentToggles(win);\n  return !!toggles[experimentId];\n}\n\n/**\n * Toggles the experiment on or off. Returns the actual value of the experiment\n * after toggling is done.\n * @param {!Window} win\n * @param {string} experimentId\n * @param {boolean=} opt_on\n * @param {boolean=} opt_transientExperiment  Whether to toggle the\n *     experiment state \"transiently\" (i.e., for this page load only) or\n *     durably (by saving the experiment IDs to the cookie after toggling).\n *     Default: false (save durably).\n * @return {boolean} New state for experimentId.\n */\nexport function toggleExperiment(win, experimentId, opt_on,\n  opt_transientExperiment) {\n  const currentlyOn = isExperimentOn(win, /*OK*/experimentId);\n  const on = !!(opt_on !== undefined ? opt_on : !currentlyOn);\n  if (on != currentlyOn) {\n    const toggles = experimentToggles(win);\n    toggles[experimentId] = on;\n\n    if (!opt_transientExperiment) {\n      const cookieToggles = getExperimentTogglesFromCookie(win);\n      cookieToggles[experimentId] = on;\n      saveExperimentTogglesToCookie(win, cookieToggles);\n    }\n  }\n  return on;\n}\n\n/**\n * Calculate whether the experiment is on or off based off of the\n * cookieFlag or the global config frequency given.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nexport function experimentToggles(win) {\n  if (win[TOGGLES_WINDOW_PROPERTY]) {\n    return win[TOGGLES_WINDOW_PROPERTY];\n  }\n  win[TOGGLES_WINDOW_PROPERTY] = Object.create(null);\n  const toggles = win[TOGGLES_WINDOW_PROPERTY];\n\n  // Read the default config of this build.\n  if (win.AMP_CONFIG) {\n    for (const experimentId in win.AMP_CONFIG) {\n      const frequency = win.AMP_CONFIG[experimentId];\n      if (typeof frequency === 'number' && frequency >= 0 && frequency <= 1) {\n        toggles[experimentId] = Math.random() < frequency;\n      }\n    }\n  }\n  // Read document level override from meta tag.\n  if (win.AMP_CONFIG\n      && Array.isArray(win.AMP_CONFIG['allow-doc-opt-in'])\n      && win.AMP_CONFIG['allow-doc-opt-in'].length > 0) {\n    const allowed = win.AMP_CONFIG['allow-doc-opt-in'];\n    const meta =\n        win.document.head.querySelector('meta[name=\"amp-experiments-opt-in\"]');\n    if (meta) {\n      const optedInExperiments = meta.getAttribute('content').split(',');\n      for (let i = 0; i < optedInExperiments.length; i++) {\n        if (allowed.indexOf(optedInExperiments[i]) != -1) {\n          toggles[optedInExperiments[i]] = true;\n        }\n      }\n    }\n  }\n\n  Object.assign(toggles, getExperimentTogglesFromCookie(win));\n\n  if (win.AMP_CONFIG\n      && Array.isArray(win.AMP_CONFIG['allow-url-opt-in'])\n      && win.AMP_CONFIG['allow-url-opt-in'].length > 0) {\n    const allowed = win.AMP_CONFIG['allow-url-opt-in'];\n    const hash = win.location.originalHash || win.location.hash;\n    const params = parseQueryString(hash);\n    for (let i = 0; i < allowed.length; i++) {\n      const param = params[`e-${allowed[i]}`];\n      if (param == '1') {\n        toggles[allowed[i]] = true;\n      }\n      if (param == '0') {\n        toggles[allowed[i]] = false;\n      }\n    }\n  }\n  return toggles;\n}\n\n/**\n * Returns the cached experiments toggles, or null if they have not been\n * computed yet.\n * @param {!Window} win\n * @return {Object<string, boolean>}\n */\nexport function experimentTogglesOrNull(win) {\n  return win[TOGGLES_WINDOW_PROPERTY] || null;\n}\n\n/**\n * Returns a set of experiment IDs currently on.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nfunction getExperimentTogglesFromCookie(win) {\n  const experimentCookie = getCookie(win, COOKIE_NAME);\n  const tokens = experimentCookie ? experimentCookie.split(/\\s*,\\s*/g) : [];\n\n  const toggles = Object.create(null);\n  for (let i = 0; i < tokens.length; i++) {\n    if (tokens[i].length == 0) {\n      continue;\n    }\n    if (tokens[i][0] == '-') {\n      toggles[tokens[i].substr(1)] = false;\n    } else {\n      toggles[tokens[i]] = true;\n    }\n  }\n\n  return toggles;\n}\n\n/**\n * Saves a set of experiment IDs currently on.\n * @param {!Window} win\n * @param {!Object<string, boolean>} toggles\n */\nfunction saveExperimentTogglesToCookie(win, toggles) {\n  const experimentIds = [];\n  for (const experiment in toggles) {\n    experimentIds.push((toggles[experiment] === false ? '-' : '') + experiment);\n  }\n\n  setCookie(win, COOKIE_NAME, experimentIds.join(','),\n      Date.now() + COOKIE_EXPIRATION_INTERVAL, {\n        // Set explicit domain, so the cookie gets send to sub domains.\n        domain: win.location.hostname,\n        allowOnProxyOrigin: true,\n      });\n}\n\n/**\n * See getExperimentTogglesFromCookie().\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n * @visibleForTesting\n */\nexport function getExperimentToglesFromCookieForTesting(win) {\n  return getExperimentTogglesFromCookie(win);\n}\n\n/**\n * Resets the experimentsToggle cache for testing purposes.\n * @param {!Window} win\n * @visibleForTesting\n */\nexport function resetExperimentTogglesForTesting(win) {\n  setCookie(win, COOKIE_NAME, '', 0, {\n    domain: win.location.hostname,\n  });\n  win[TOGGLES_WINDOW_PROPERTY] = null;\n}\n\n/**\n * In some browser implementations of Math.random(), sequential calls of\n * Math.random() are correlated and can cause a bias.  In particular,\n * if the previous random() call was < 0.001 (as it will be if we select\n * into an experiment), the next value could be less than 0.5 more than\n * 50.7% of the time.  This provides an implementation that roots down into\n * the crypto API, when available, to produce less biased samples.\n *\n * @return {number} Pseudo-random floating-point value on the range [0, 1).\n */\nfunction slowButAccuratePrng() {\n  // TODO(tdrl): Implement.\n  return Math.random();\n}\n\n/**\n * Container for alternate random number generator implementations.  This\n * allows us to set an \"accurate\" PRNG for branch selection, but to mock it\n * out easily in tests.\n *\n * @visibleForTesting\n * @const {!{accuratePrng: function():number}}\n */\nexport const RANDOM_NUMBER_GENERATORS = {\n  accuratePrng: slowButAccuratePrng,\n};\n\n/**\n * Selects, uniformly at random, a single item from the array.\n * @param {!Array<string>} arr Object to select from.\n * @return {?string} Single item from arr or null if arr was empty.\n */\nfunction selectRandomItem(arr) {\n  const rn = RANDOM_NUMBER_GENERATORS.accuratePrng();\n  return arr[Math.floor(rn * arr.length)] || null;\n}\n\n/**\n * Selects which page-level experiment branches are enabled. If a given\n * experiment name is already set (including to the null / no branches selected\n * state), this won't alter its state.\n *\n * Check whether a given experiment is set using isExperimentOn(win,\n * experimentName) and, if it is on, look for which branch is selected in\n * win.experimentBranches[experimentName].\n *\n * @param {!Window} win Window context on which to save experiment\n *     selection state.\n * @param {!Object<string, !ExperimentInfo>} experiments  Set of experiments to\n *     configure for this page load.\n * @return {!Object<string, string>} Map of experiment names to selected\n *     branches.\n */\nexport function randomlySelectUnsetExperiments(win, experiments) {\n  win.experimentBranches = win.experimentBranches || {};\n  const selectedExperiments = {};\n  for (const experimentName in experiments) {\n    // Skip experimentName if it is not a key of experiments object or if it\n    // has already been populated by some other property.\n    if (!hasOwn(experiments, experimentName)) {\n      continue;\n    }\n    if (hasOwn(win.experimentBranches, experimentName)) {\n      selectedExperiments[experimentName] =\n          win.experimentBranches[experimentName];\n      continue;\n    }\n\n    if (!experiments[experimentName].isTrafficEligible ||\n        !experiments[experimentName].isTrafficEligible(win)) {\n      win.experimentBranches[experimentName] = null;\n      continue;\n    }\n\n    // If we're in the experiment, but we haven't already forced a specific\n    // experiment branch (e.g., via a test setup), then randomize the branch\n    // choice.\n    if (!win.experimentBranches[experimentName] &&\n      isExperimentOn(win, /*OK*/experimentName)) {\n      const {branches} = experiments[experimentName];\n      win.experimentBranches[experimentName] = selectRandomItem(branches);\n      selectedExperiments[experimentName] =\n          win.experimentBranches[experimentName];\n    }\n  }\n  return selectedExperiments;\n}\n\n/**\n * Returns the experiment branch enabled for the given experiment ID.\n * For example, 'control' or 'experiment'.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @return {?string} Active experiment branch ID for experimentName (possibly\n *     null if experimentName has been tested but no branch was enabled).\n */\nexport function getExperimentBranch(win, experimentName) {\n  return win.experimentBranches ? win.experimentBranches[experimentName] : null;\n}\n\n/**\n * Force enable (or disable) a specific branch of a given experiment name.\n * Disables the experiment name altogether if branchId is falseish.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @param {?string} branchId ID of branch to force or null to disable\n *     altogether.\n * @visibleForTesting\n */\nexport function forceExperimentBranch(win, experimentName, branchId) {\n  win.experimentBranches = win.experimentBranches || {};\n  toggleExperiment(win, experimentName, !!branchId, true);\n  win.experimentBranches[experimentName] = branchId;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {addAttributesToElement, closestBySelector} from './dom';\nimport {deserializeMessage, isAmpMessage} from './3p-frame-messaging';\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {filterSplice} from './utils/array';\nimport {getData} from './event-helper';\nimport {parseUrlDeprecated} from './url';\nimport {setStyle} from './style';\nimport {tryParseJson} from './json';\n\n/**\n * Sentinel used to force unlistening after a iframe is detached.\n * @type {string}\n */\nconst UNLISTEN_SENTINEL = 'unlisten';\n\n/**\n * @typedef {{\n *   frame: !Element,\n *   events: !Object<string, !Array<function(!JsonObject)>>\n * }}\n */\nlet WindowEventsDef;\n\n/**\n * Returns a mapping from a URL's origin to an array of windows and their\n * listenFor listeners.\n * @param {?Window} parentWin the window that created the iframe\n * @param {boolean=} opt_create create the mapping if it does not exist\n * @return {?Object<string, !Array<!WindowEventsDef>>}\n */\nfunction getListenFors(parentWin, opt_create) {\n  let {listeningFors} = parentWin;\n\n  if (!listeningFors && opt_create) {\n    listeningFors = parentWin.listeningFors = Object.create(null);\n  }\n  return listeningFors || null;\n}\n\n/**\n * Returns an array of WindowEventsDef that have had any listenFor listeners\n * registered for this sentinel.\n * @param {?Window} parentWin the window that created the iframe\n * @param {string} sentinel the sentinel of the message\n * @param {boolean=} opt_create create the array if it does not exist\n * @return {?Array<!WindowEventsDef>}\n */\nfunction getListenForSentinel(parentWin, sentinel, opt_create) {\n  const listeningFors = getListenFors(parentWin, opt_create);\n  if (!listeningFors) {\n    return listeningFors;\n  }\n\n  let listenSentinel = listeningFors[sentinel];\n  if (!listenSentinel && opt_create) {\n    listenSentinel = listeningFors[sentinel] = [];\n  }\n  return listenSentinel || null;\n}\n\n/**\n * Returns an mapping of event names to listenFor listeners.\n * @param {?Window} parentWin the window that created the iframe\n * @param {!Element} iframe the iframe element who's context will trigger the\n *     event\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n * @return {?Object<string, !Array<function(!JsonObject, !Window, string)>>}\n */\nfunction getOrCreateListenForEvents(parentWin, iframe, opt_is3P) {\n  const {origin} = parseUrlDeprecated(iframe.src);\n  const sentinel = getSentinel_(iframe, opt_is3P);\n  const listenSentinel = getListenForSentinel(parentWin, sentinel, true);\n\n  let windowEvents;\n  for (let i = 0; i < listenSentinel.length; i++) {\n    const we = listenSentinel[i];\n    if (we.frame === iframe) {\n      windowEvents = we;\n      break;\n    }\n  }\n\n  if (!windowEvents) {\n    windowEvents = {\n      frame: iframe,\n      origin,\n      events: Object.create(null),\n    };\n    listenSentinel.push(windowEvents);\n  }\n\n  return windowEvents.events;\n}\n\n/**\n * Returns an mapping of event names to listenFor listeners.\n * @param {?Window} parentWin the window that created the iframe\n * @param {string} sentinel the sentinel of the message\n * @param {string} origin the source window's origin\n * @param {?Window} triggerWin the window that triggered the event\n * @return {?Object<string, !Array<function(!JsonObject, !Window, string)>>}\n */\nfunction getListenForEvents(parentWin, sentinel, origin, triggerWin) {\n  const listenSentinel = getListenForSentinel(parentWin, sentinel);\n\n  if (!listenSentinel) {\n    return listenSentinel;\n  }\n\n  // Find the entry for the frame.\n  // TODO(@nekodo): Add a WeakMap<Window, WindowEventsDef> cache to\n  //     speed up this process.\n  let windowEvents;\n  for (let i = 0; i < listenSentinel.length; i++) {\n    const we = listenSentinel[i];\n    const {contentWindow} = we.frame;\n    if (!contentWindow) {\n      setTimeout(dropListenSentinel, 0, listenSentinel);\n    } else if (sentinel === 'amp') {\n      // A non-3P code path, origin must match.\n      if (we.origin === origin && contentWindow == triggerWin) {\n        windowEvents = we;\n        break;\n      }\n    } else if (triggerWin == contentWindow ||\n        isDescendantWindow(contentWindow, triggerWin)) {\n      // 3p code path, we may accept messages from nested frames.\n      windowEvents = we;\n      break;\n    }\n  }\n\n  return windowEvents ? windowEvents.events : null;\n}\n\n/**\n * Checks whether one window is a descendant of another by climbing\n * the parent chain.\n * @param {?Window} ancestor potential ancestor window\n * @param {?Window} descendant potential descendant window\n * @return {boolean}\n */\nfunction isDescendantWindow(ancestor, descendant) {\n  for (let win = descendant; win && win != win.parent; win = win.parent) {\n    if (win == ancestor) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Removes any listenFors registed on listenSentinel that do not have\n * a contentWindow (the frame was removed from the DOM tree).\n * @param {!Array<!WindowEventsDef>} listenSentinel\n */\nfunction dropListenSentinel(listenSentinel) {\n  const noopData = dict({'sentinel': UNLISTEN_SENTINEL});\n\n  for (let i = listenSentinel.length - 1; i >= 0; i--) {\n    const windowEvents = listenSentinel[i];\n\n    if (!windowEvents.frame.contentWindow) {\n      listenSentinel.splice(i, 1);\n\n      const {events} = windowEvents;\n      for (const name in events) {\n        // Splice here, so that each unlisten does not shift the array\n        events[name].splice(0, Infinity).forEach(event => {\n          event(noopData);\n        });\n      }\n    }\n  }\n}\n\n/**\n * Registers the global listenFor event listener if it has yet to be.\n * @param {?Window} parentWin\n */\nfunction registerGlobalListenerIfNeeded(parentWin) {\n  if (parentWin.listeningFors) {\n    return;\n  }\n  const listenForListener = function(event) {\n    if (!getData(event)) {\n      return;\n    }\n    const data = parseIfNeeded(getData(event));\n    if (!data || !data['sentinel']) {\n      return;\n    }\n\n    const listenForEvents = getListenForEvents(\n        parentWin,\n        data['sentinel'],\n        event.origin,\n        event.source\n    );\n    if (!listenForEvents) {\n      return;\n    }\n\n    let listeners = listenForEvents[data['type']];\n    if (!listeners) {\n      return;\n    }\n\n    // We slice to avoid issues with adding another listener or unlistening\n    // during iteration. We could move to a Doubly Linked List with\n    // backtracking, but that's overly complicated.\n    listeners = listeners.slice();\n    for (let i = 0; i < listeners.length; i++) {\n      const listener = listeners[i];\n      listener(data, event.source, event.origin);\n    }\n  };\n\n  parentWin.addEventListener('message', listenForListener);\n}\n\n/**\n * Allows listening for message from the iframe. Returns an unlisten\n * function to remove the listener.\n *\n * @param {?Element} iframe\n * @param {string} typeOfMessage\n * @param {?function(!JsonObject, !Window, string)} callback Called when a\n *     message of this type arrives for this iframe.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n * @param {boolean=} opt_includingNestedWindows set to true if a messages from\n *     nested frames should also be accepted.\n * @return {!UnlistenDef}\n */\nexport function listenFor(\n  iframe, typeOfMessage, callback, opt_is3P, opt_includingNestedWindows) {\n  dev().assert(iframe.src, 'only iframes with src supported');\n  dev().assert(!iframe.parentNode, 'cannot register events on an attached ' +\n      'iframe. It will cause hair-pulling bugs like #2942');\n  dev().assert(callback);\n  const parentWin = iframe.ownerDocument.defaultView;\n\n  registerGlobalListenerIfNeeded(parentWin);\n\n  const listenForEvents = getOrCreateListenForEvents(\n      parentWin,\n      iframe,\n      opt_is3P\n  );\n\n\n  let events = listenForEvents[typeOfMessage] ||\n    (listenForEvents[typeOfMessage] = []);\n\n  let unlisten;\n  let listener = function(data, source, origin) {\n    // Exclude nested frames if necessary.\n    // Note that the source was already verified to be either the contentWindow\n    // of the iframe itself or a descendant window within it.\n    if (!opt_includingNestedWindows && source != iframe.contentWindow) {\n      return;\n    }\n\n    if (data.sentinel == UNLISTEN_SENTINEL) {\n      unlisten();\n      return;\n    }\n    callback(data, source, origin);\n  };\n\n  events.push(listener);\n\n  return unlisten = function() {\n    if (listener) {\n      const index = events.indexOf(listener);\n      if (index > -1) {\n        events.splice(index, 1);\n      }\n      // Make sure references to the unlisten function do not keep\n      // alive too much.\n      listener = null;\n      events = null;\n      callback = null;\n    }\n  };\n}\n\n/**\n * Returns a promise that resolves when one of given messages has been observed\n * for the first time. And remove listener for all other messages.\n * @param {!Element} iframe\n * @param {string|!Array<string>} typeOfMessages\n * @param {boolean=} opt_is3P\n * @return {!Promise<!{data: !JsonObject, source: !Window, origin: string}>}\n */\nexport function listenForOncePromise(iframe, typeOfMessages, opt_is3P) {\n  const unlistenList = [];\n  if (typeof typeOfMessages == 'string') {\n    typeOfMessages = [typeOfMessages];\n  }\n  return new Promise(resolve => {\n    for (let i = 0; i < typeOfMessages.length; i++) {\n      const message = typeOfMessages[i];\n      const unlisten = listenFor(iframe, message, (data, source, origin) => {\n        for (let i = 0; i < unlistenList.length; i++) {\n          unlistenList[i]();\n        }\n        resolve({data, source, origin});\n      }, opt_is3P);\n      unlistenList.push(unlisten);\n    }\n  });\n}\n\n/**\n * Posts a message to the iframe.\n * @param {!Element} iframe The iframe.\n * @param {string} type Type of the message.\n * @param {!JsonObject} object Message payload.\n * @param {string} targetOrigin origin of the target.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n */\nexport function postMessage(iframe, type, object, targetOrigin, opt_is3P) {\n  postMessageToWindows(iframe,\n      [{win: iframe.contentWindow, origin: targetOrigin}], type, object,\n      opt_is3P);\n}\n\n/**\n * Posts an identical message to multiple target windows with the same\n * sentinel.\n * The message is serialized only once.\n * @param {!Element} iframe The iframe.\n * @param {!Array<{win: !Window, origin: string}>} targets to send the message\n *     to, pairs of window and its origin.\n * @param {string} type Type of the message.\n * @param {!JsonObject} object Message payload.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n */\nexport function postMessageToWindows(iframe, targets, type, object, opt_is3P) {\n  if (!iframe.contentWindow) {\n    return;\n  }\n  object['type'] = type;\n  object['sentinel'] = getSentinel_(iframe, opt_is3P);\n  let payload = object;\n  if (opt_is3P) {\n    // Serialize ourselves because that is much faster in Chrome.\n    payload = 'amp-' + JSON.stringify(object);\n  }\n  for (let i = 0; i < targets.length; i++) {\n    const target = targets[i];\n    target.win./*OK*/postMessage(payload, target.origin);\n  }\n}\n\n/**\n * Gets the sentinel string.\n * @param {!Element} iframe The iframe.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n * @return {string} Sentinel string.\n * @private\n */\nfunction getSentinel_(iframe, opt_is3P) {\n  return opt_is3P ? iframe.getAttribute('data-amp-3p-sentinel') : 'amp';\n}\n\n/**\n * JSON parses event.data if it needs to be\n * @param {*} data\n * @return {?JsonObject} object message\n * @private\n * @visibleForTesting\n */\nexport function parseIfNeeded(data) {\n  if (typeof data == 'string') {\n    if (data.charAt(0) == '{') {\n      data = tryParseJson(data, e => {\n        dev().warn('IFRAME-HELPER',\n            'Postmessage could not be parsed. ' +\n            'Is it in a valid JSON format?', e);\n      }) || null;\n    } else if (isAmpMessage(data)) {\n      data = deserializeMessage(data);\n    } else {\n      data = null;\n    }\n  }\n  return /** @type {?JsonObject} */ (data);\n}\n\n\n\n/**\n * Manages a postMessage API for an iframe with a subscription message and\n * a way to broadcast messages to all subscribed windows, which\n * in turn must all be descendants of the contentWindow of the iframe.\n */\nexport class SubscriptionApi {\n  /**\n   * @param {!Element} iframe The iframe.\n   * @param {string} type Type of the subscription message.\n   * @param {boolean} is3p set to true if the iframe is 3p.\n   * @param {function(!JsonObject, !Window, string)} requestCallback Callback\n   *     invoked whenever a new window subscribes.\n   */\n  constructor(iframe, type, is3p, requestCallback) {\n    /** @private @const {!Element} */\n    this.iframe_ = iframe;\n    /** @private @const {boolean} */\n    this.is3p_ = is3p;\n    /** @private @const {!Array<{win: !Window, origin: string}>} */\n    this.clientWindows_ = [];\n\n    /** @private @const {!UnlistenDef} */\n    this.unlisten_ = listenFor(this.iframe_, type, (data, source, origin) => {\n      // This message might be from any window within the iframe, we need\n      // to keep track of which windows want to be sent updates.\n      if (!this.clientWindows_.some(entry => entry.win == source)) {\n        this.clientWindows_.push({win: source, origin});\n      }\n      requestCallback(data, source, origin);\n    }, this.is3p_,\n        // For 3P frames we also allow nested frames within them to subscribe..\n    this.is3p_ /* opt_includingNestedWindows */);\n  }\n\n  /**\n   * Sends a message to all subscribed windows.\n   * @param {string} type Type of the message.\n   * @param {!JsonObject} data Message payload.\n   */\n  send(type, data) {\n    // Remove clients that have been removed from the DOM.\n    filterSplice(this.clientWindows_, client => !!client.win.parent);\n    postMessageToWindows(\n        this.iframe_,\n        this.clientWindows_,\n        type,\n        data,\n        this.is3p_);\n  }\n\n  /**\n   * Destroys iframe.\n   */\n  destroy() {\n    this.unlisten_();\n    this.clientWindows_.length = 0;\n  }\n}\n\n/**\n * @param {!Element} element\n * @return {boolean}\n */\nexport function looksLikeTrackingIframe(element) {\n  const box = element.getLayoutBox();\n  // This heuristic is subject to change.\n  if (box.width > 10 || box.height > 10) {\n    return false;\n  }\n  // Iframe is not tracking iframe if open with user interaction\n  return !closestBySelector(element, '.i-amphtml-overlay');\n}\n\n// Most common ad sizes\n// Array of [width, height] pairs.\nconst adSizes = [\n  [300, 250],\n  [320, 50],\n  [300, 50],\n  [320, 100],\n];\n\n/**\n * Guess whether this element might be an ad.\n * @param {!Element} element An amp-iframe element.\n * @return {boolean}\n * @visibleForTesting\n */\nexport function isAdLike(element) {\n  const box = element.getLayoutBox();\n  const {height, width} = box;\n  for (let i = 0; i < adSizes.length; i++) {\n    const refWidth = adSizes[i][0];\n    const refHeight = adSizes[i][1];\n    if (refHeight > height) {\n      continue;\n    }\n    if (refWidth > width) {\n      continue;\n    }\n    // Fuzzy matching to account for padding.\n    if (height - refHeight <= 20 && width - refWidth <= 20) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * @param {!Element} iframe\n * @private\n */\nexport function disableScrollingOnIframe(iframe) {\n  addAttributesToElement(iframe, dict({'scrolling': 'no'}));\n\n  // This shouldn't work, but it does on Firefox.\n  // https://stackoverflow.com/a/15494969\n  setStyle(iframe, 'overflow', 'hidden');\n\n  return iframe;\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {Services} from './services';\nimport {VideoEvents} from './video-interface';\nimport {dev} from './log';\nimport {htmlFor} from './static-template';\nimport {isArray, isObject} from './types';\nimport {startsWith} from './string';\nimport {tryParseJson} from './json';\n\n\n/** @enum {string} */\nexport const SandboxOptions = {\n  ALLOW_SCRIPTS: 'allow-scripts',\n  ALLOW_SAME_ORIGIN: 'allow-same-origin',\n};\n\n\n/**\n * @param {!Event} event\n * @param {?Element} iframe\n * @param {string|!RegExp} host\n * @return {boolean}\n */\nexport function originMatches(event, iframe, host) {\n  if (!iframe || event.source != iframe.contentWindow) {\n    return false;\n  }\n  if (typeof host === 'string') {\n    return host == event.origin;\n  }\n  return host.test(event.origin);\n}\n\n\n/**\n * Re-dispatches an event received from postMessage as an event in the host\n * document.\n *\n * @param {!AmpElement} element\n * @param {string} event\n * @param {!Object<string, (string|?Array<string>)>} events\n * @return {boolean}\n */\nexport function redispatch(element, event, events) {\n  if (events[event] == null) {\n    return false;\n  }\n  const dispatchEvent = events[event];\n  (isArray(dispatchEvent) ? dispatchEvent : [dispatchEvent]).forEach(e => {\n    element.dispatchCustomEvent(dev().assertString(e));\n  });\n  return true;\n}\n\n\n/**\n * @param {!./base-element.BaseElement} video\n * @param {string} src\n * @param {string=} opt_name\n * @param {!Array<!SandboxOptions>=} opt_sandbox\n * @return {!Element}\n */\nexport function createFrameFor(video, src, opt_name, opt_sandbox) {\n  const {element} = video;\n  const frame =\n      htmlFor(element)`<iframe frameborder=0 allowfullscreen></iframe>`;\n\n  if (opt_name) {\n    frame.setAttribute('name', opt_name);\n  }\n\n  if (opt_sandbox) {\n    frame.setAttribute('sandbox', opt_sandbox.join(' '));\n  }\n\n  frame.src = Services.urlForDoc(element).assertHttpsUrl(src, element);\n\n  video.applyFillContent(frame);\n  element.appendChild(frame);\n\n  return frame;\n}\n\n\n/**\n * @param {?} anything\n * @return {boolean}\n */\nexport function isJsonOrObj(anything) {\n  if (!anything) {\n    return false;\n  }\n  return isObject(anything) ||\n    startsWith(/** @type {string} */ (anything), '{');\n}\n\n\n/**\n * @param {?JsonObject|string|undefined} objOrStr\n * @return {?JsonObject|undefined}\n */\nexport function objOrParseJson(objOrStr) {\n  if (isObject(objOrStr)) {\n    return /** @type {!JsonObject} */ (objOrStr);\n  }\n  return tryParseJson(objOrStr);\n}\n\n\n/**\n * @param {boolean} isMuted\n * @return {string}\n */\nexport function mutedOrUnmutedEvent(isMuted) {\n  return isMuted ? VideoEvents.MUTED : VideoEvents.UNMUTED;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview This module declares JSON types as defined in the\n * {@link http://json.org/}.\n */\n\nimport {isObject} from './types';\n\n\n// NOTE Type are changed to {*} because of\n// https://github.com/google/closure-compiler/issues/1999\n\n/**\n * JSON scalar. It's either string, number or boolean.\n * @typedef {*} should be string|number|boolean\n */\nlet JSONScalarDef;\n\n\n/**\n * JSON object. It's a map with string keys and JSON values.\n * @typedef {*} should be !Object<string, ?JSONValueDef>\n */\nlet JSONObjectDef;\n\n\n/**\n * JSON array. It's an array with JSON values.\n * @typedef {*} should be !Array<?JSONValueDef>\n */\nlet JSONArrayDef;\n\n\n/**\n * JSON value. It's either a scalar, an object or an array.\n * @typedef {*} should be !JSONScalarDef|!JSONObjectDef|!JSONArrayDef\n */\nlet JSONValueDef;\n\n/**\n * Recreates objects with prototype-less copies.\n * @param {!JsonObject} obj\n * @return {!JsonObject}\n */\nexport function recreateNonProtoObject(obj) {\n  const copy = Object.create(null);\n  for (const k in obj) {\n    if (!hasOwnProperty(obj, k)) {\n      continue;\n    }\n    const v = obj[k];\n    copy[k] = isObject(v) ? recreateNonProtoObject(v) : v;\n  }\n  return /** @type {!JsonObject} */ (copy);\n}\n\n/**\n * Returns a value from an object for a field-based expression. The expression\n * is a simple nested dot-notation of fields, such as `field1.field2`. If any\n * field in a chain does not exist or is not an object or array, the returned\n * value will be `undefined`.\n *\n * @param {!JsonObject} obj\n * @param {string} expr\n * @return {*}\n */\nexport function getValueForExpr(obj, expr) {\n  // The `.` indicates \"the object itself\".\n  if (expr == '.') {\n    return obj;\n  }\n  // Otherwise, navigate via properties.\n  const parts = expr.split('.');\n  let value = obj;\n  for (let i = 0; i < parts.length; i++) {\n    const part = parts[i];\n    if (part &&\n        value &&\n        value[part] !== undefined &&\n        hasOwnProperty(value, part)\n    ) {\n      value = value[part];\n      continue;\n    }\n    value = undefined;\n    break;\n  }\n  return value;\n}\n\n/**\n * Simple wrapper around JSON.parse that casts the return value\n * to JsonObject.\n * Create a new wrapper if an array return value is desired.\n * @param {*} json JSON string to parse\n * @return {?JsonObject} May be extend to parse arrays.\n */\nexport function parseJson(json) {\n  return /** @type {?JsonObject} */(JSON.parse(/** @type {string} */ (json)));\n}\n\n/**\n * Parses the given `json` string without throwing an exception if not valid.\n * Returns `undefined` if parsing fails.\n * Returns the `Object` corresponding to the JSON string when parsing succeeds.\n * @param {*} json JSON string to parse\n * @param {function(!Error)=} opt_onFailed Optional function that will be called\n *     with the error if parsing fails.\n * @return {?JsonObject|undefined} May be extend to parse arrays.\n */\nexport function tryParseJson(json, opt_onFailed) {\n  try {\n    return parseJson(json);\n  } catch (e) {\n    if (opt_onFailed) {\n      opt_onFailed(e);\n    }\n    return undefined;\n  }\n}\n\n/**\n * Recursively checks strict equality of items in nested arrays and objects.\n *\n * @param {JSONValueDef} a\n * @param {JSONValueDef} b\n * @param {number} depth The maximum recursion depth. Must be finite.\n * @return {boolean}\n * @throws {Error} If depth argument is not finite.\n */\nexport function recursiveEquals(a, b, depth = 3) {\n  if (!isFinite(depth)) {\n    throw new Error('depth arg must be finite: ' + depth);\n  }\n  if (a === b) {\n    return true;\n  }\n  // Only check shallow equality for depth < 1.\n  if (depth < 1) {\n    return false;\n  }\n  if (typeof a !== typeof b) {\n    return false;\n  }\n  if (Array.isArray(a) && Array.isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n    for (let i = 0; i < a.length; i++) {\n      if (!recursiveEquals(a[i], b[i], depth - 1)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\n    const keysA = Object.keys(/** @type {!Object} */ (a));\n    const keysB = Object.keys(/** @type {!Object} */ (b));\n    if (keysA.length !== keysB.length) {\n      return false;\n    }\n    for (let i = 0; i < keysA.length; i++) {\n      const keyA = keysA[i];\n      const valueA = a[keyA];\n      const valueB = b[keyA];\n      if (!recursiveEquals(valueA, valueB, depth - 1)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {*} obj\n * @param {string} key\n * @return {boolean}\n */\nfunction hasOwnProperty(obj, key) {\n  if (obj == null || typeof obj != 'object') {\n    return false;\n  }\n  return Object.prototype.hasOwnProperty.call(\n      /** @type {!Object} */ (obj), key);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * The structure that combines position and size for an element. The exact\n * interpretation of position and size depends on the use case.\n *\n * @typedef {{\n *   top: number,\n *   bottom: number,\n *   left: number,\n *   right: number,\n *   width: number,\n *   height: number,\n *   x: number,\n *   y: number\n * }}\n */\nexport let LayoutRectDef;\n\n\n/**\n * The structure that represents the margins of an Element.\n *\n * @typedef {{\n *   top: number,\n *   right: number,\n *   bottom: number,\n *   left: number\n * }}\n */\nexport let LayoutMarginsDef;\n\n\n/**\n * The structure that represents a requested change to the margins of an\n * Element. Any new values specified will replace existing ones (rather than\n * being additive).\n *\n * @typedef {{\n *   top: (number|undefined),\n *   right: (number|undefined),\n *   bottom: (number|undefined),\n *   left: (number|undefined)\n * }}\n */\nexport let LayoutMarginsChangeDef;\n\n/**\n* RelativePositions\n*\n* Describes the relative position of an element to another (whether the\n* first is inside the second, on top of the second or on the bottom\n* @enum {string}\n*/\nexport const RelativePositions = {\n  INSIDE: 'inside',\n  TOP: 'top',\n  BOTTOM: 'bottom',\n};\n\n/**\n * Creates a layout rect based on the left, top, width and height parameters\n * in that order.\n * @param {number} left\n * @param {number} top\n * @param {number} width\n * @param {number} height\n * @return {!LayoutRectDef}\n */\nexport function layoutRectLtwh(left, top, width, height) {\n  return {\n    left,\n    top,\n    width,\n    height,\n    bottom: top + height,\n    right: left + width,\n    x: left,\n    y: top,\n  };\n}\n\n\n/**\n * Creates a layout rect based on the DOMRect, e.g. obtained from calling\n * getBoundingClientRect.\n * @param {!ClientRect} rect\n * @return {!LayoutRectDef}\n */\nexport function layoutRectFromDomRect(rect) {\n  return layoutRectLtwh(Number(rect.left), Number(rect.top),\n      Number(rect.width), Number(rect.height));\n}\n\n/**\n * Returns true if the specified two rects overlap by a single pixel.\n * @param {!LayoutRectDef} r1\n * @param {!LayoutRectDef} r2\n * @return {boolean}\n */\nexport function layoutRectsOverlap(r1, r2) {\n  return (r1.top <= r2.bottom && r2.top <= r1.bottom &&\n      r1.left <= r2.right && r2.left <= r1.right);\n}\n\n\n/**\n * Returns the intersection between a, b or null if there is none.\n * @param {...?LayoutRectDef|undefined} var_args\n * @return {?LayoutRectDef}\n */\nexport function rectIntersection(var_args) {\n  let x0 = -Infinity;\n  let x1 = Infinity;\n  let y0 = -Infinity;\n  let y1 = Infinity;\n  for (let i = 0; i < arguments.length; i++) {\n    const current = arguments[i];\n    if (!current) {\n      continue;\n    }\n    x0 = Math.max(x0, current.left);\n    x1 = Math.min(x1, current.left + current.width);\n    y0 = Math.max(y0, current.top);\n    y1 = Math.min(y1, current.top + current.height);\n    if (x1 < x0 || y1 < y0) {\n      return null;\n    }\n  }\n  if (x1 == Infinity) {\n    return null;\n  }\n  return layoutRectLtwh(x0, y0, x1 - x0, y1 - y0);\n}\n\n/**\n * Returns the position of r2 relative to r1\n * @param {!LayoutRectDef} r1\n * @param {!LayoutRectDef} r2\n * @return {RelativePositions}\n */\nexport function layoutRectsRelativePos(r1, r2) {\n  if (r1.top < r2.top) {\n    return RelativePositions.TOP;\n  } else if (r1.bottom > r2.bottom) {\n    return RelativePositions.BOTTOM;\n  } else {\n    return RelativePositions.INSIDE;\n  }\n}\n\n/**\n * Expand the layout rect using multiples of width and height.\n * @param {!LayoutRectDef} rect Original rect.\n * @param {number} dw Expansion in width, specified as a multiple of width.\n * @param {number} dh Expansion in height, specified as a multiple of height.\n * @return {!LayoutRectDef}\n */\nexport function expandLayoutRect(rect, dw, dh) {\n  return layoutRectLtwh(rect.left - rect.width * dw,\n      rect.top - rect.height * dh,\n      rect.width * (1 + dw * 2),\n      rect.height * (1 + dh * 2));\n}\n\n/**\n * Moves the layout rect using dx and dy.\n * @param {!LayoutRectDef} rect Original rect.\n * @param {number} dx Move horizontally with this value.\n * @param {number} dy Move vertically with this value.\n * @return {!LayoutRectDef}\n */\nexport function moveLayoutRect(rect, dx, dy) {\n  if ((dx == 0 && dy == 0) ||\n      (rect.width == 0 && rect.height == 0)) {\n    return rect;\n  }\n  return layoutRectLtwh(rect.left + dx, rect.top + dy,\n      rect.width, rect.height);\n}\n\n\n/**\n * @param {!LayoutMarginsDef} margins\n * @param {!LayoutMarginsChangeDef} change\n * @return {boolean}\n */\nexport function areMarginsChanged(margins, change) {\n  return (change.top !== undefined && change.top != margins.top) ||\n      (change.right !== undefined && change.right != margins.right) ||\n      (change.bottom !== undefined && change.bottom != margins.bottom) ||\n      (change.left !== undefined && change.left != margins.left);\n}\n\n/**\n * @param {!LayoutRectDef} from\n * @param {!LayoutRectDef} to\n * @return {boolean}\n */\nexport function layoutRectSizeEquals(from, to) {\n  return from.width == to.width &&\n      from.height === to.height;\n}\n\n/**\n * @param {?LayoutRectDef} r1\n * @param {?LayoutRectDef} r2\n * @return {boolean}\n */\nexport function layoutRectEquals(r1, r2) {\n  if (!r1 || !r2) {\n    return false;\n  }\n  return r1.left == r2.left && r1.top == r2.top &&\n      r1.width == r2.width && r1.height == r2.height;\n}\n\n/**\n * @param {LayoutMarginsChangeDef|undefined} marginsChange\n * @return {LayoutMarginsChangeDef|undefined}\n */\nexport function cloneLayoutMarginsChangeDef(marginsChange) {\n  if (!marginsChange) {\n    return marginsChange;\n  }\n  return {\n    top: marginsChange.top,\n    bottom: marginsChange.bottom,\n    left: marginsChange.left,\n    right: marginsChange.right,\n  };\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Implements element layout. See https://goo.gl/9avXuT for\n * details.\n */\n\nimport {dev, user} from './log';\nimport {htmlFor} from './static-template';\nimport {isFiniteNumber} from './types';\nimport {setStyle, setStyles} from './style';\nimport {startsWith} from './string';\n\n/**\n * @enum {string}\n */\nexport const Layout = {\n  NODISPLAY: 'nodisplay',\n  FIXED: 'fixed',\n  FIXED_HEIGHT: 'fixed-height',\n  RESPONSIVE: 'responsive',\n  CONTAINER: 'container',\n  FILL: 'fill',\n  FLEX_ITEM: 'flex-item',\n  FLUID: 'fluid',\n  INTRINSIC: 'intrinsic',\n};\n\n\n/**\n * Layout priorities to use with BaseElement#getLayoutPriority() and\n * BaseElement#updateLayoutPriority().\n * @enum {number}\n */\nexport const LayoutPriority = {\n  CONTENT: 0,\n  METADATA: 1,\n  ADS: 2,\n  BACKGROUND: 3,\n};\n\n\n/**\n * CSS Length type. E.g. \"1px\" or \"20vh\".\n * @typedef {string}\n */\nexport let LengthDef;\n\n\n/**\n * @typedef {{\n *   width: string,\n *   height: string\n * }}\n */\nlet DimensionsDef;\n\n\n/**\n * The set of elements with natural dimensions, that is, elements\n * which have a known dimension either based on their value specified here,\n * or, if the value is null, a dimension specific to the browser.\n * `hasNaturalDimensions` checks for membership in this set.\n * `getNaturalDimensions` determines the dimensions for an element in the\n *    set and caches it.\n * @type {!Object<string, ?DimensionsDef>}\n * @private  Visible for testing only!\n */\nexport const naturalDimensions_ = {\n  'AMP-PIXEL': {width: '0px', height: '0px'},\n  'AMP-ANALYTICS': {width: '1px', height: '1px'},\n  // TODO(dvoytenko): audio should have width:auto.\n  'AMP-AUDIO': null,\n  'AMP-SOCIAL-SHARE': {width: '60px', height: '44px'},\n};\n\n\n/**\n * Elements that the progess can be shown for. This set has to be externalized\n * since the element's implementation may not be downloaded yet.\n * @enum {boolean}\n * @private  Visible for testing only!\n */\nexport const LOADING_ELEMENTS_ = {\n  'AMP-ANIM': true,\n  'AMP-BRIGHTCOVE': true,\n  'AMP-GOOGLE-DOCUMENT-EMBED': true,\n  'AMP-EMBED': true,\n  'AMP-FACEBOOK': true,\n  'AMP-FACEBOOK-COMMENTS': true,\n  'AMP-FACEBOOK-LIKE': true,\n  'AMP-FACEBOOK-PAGE': true,\n  'AMP-IFRAME': true,\n  'AMP-IMG': true,\n  'AMP-INSTAGRAM': true,\n  'AMP-LIST': true,\n  'AMP-OOYALA-PLAYER': true,\n  'AMP-PINTEREST': true,\n  'AMP-PLAYBUZZ': true,\n  'AMP-VIDEO': true,\n  'AMP-YOUTUBE': true,\n};\n\n\n/**\n * @param {string} s\n * @return {Layout|undefined} Returns undefined in case of failure to parse\n *   the layout string.\n */\nexport function parseLayout(s) {\n  for (const k in Layout) {\n    if (Layout[k] == s) {\n      return Layout[k];\n    }\n  }\n  return undefined;\n}\n\n\n/**\n * @param {!Layout} layout\n * @return {string}\n */\nexport function getLayoutClass(layout) {\n  return 'i-amphtml-layout-' + layout;\n}\n\n\n/**\n * Whether an element with this layout inherently defines the size.\n * @param {!Layout} layout\n * @return {boolean}\n */\nexport function isLayoutSizeDefined(layout) {\n  return (layout == Layout.FIXED ||\n      layout == Layout.FIXED_HEIGHT ||\n      layout == Layout.RESPONSIVE ||\n      layout == Layout.FILL ||\n      layout == Layout.FLEX_ITEM ||\n      layout == Layout.FLUID ||\n      layout == Layout.INTRINSIC);\n}\n\n\n/**\n * Whether the tag is an internal (service) AMP tag.\n * @param {!Node|string} tag\n * @return {boolean}\n */\nexport function isInternalElement(tag) {\n  const tagName = (typeof tag == 'string') ? tag : tag.tagName;\n  return tagName && startsWith(tagName.toLowerCase(), 'i-');\n}\n\n\n/**\n * Parses the CSS length value. If no units specified, the assumed value is\n * \"px\". Returns undefined in case of parsing error.\n * @param {string|undefined|null} s\n * @return {!LengthDef|undefined}\n */\nexport function parseLength(s) {\n  if (typeof s == 'number') {\n    return s + 'px';\n  }\n  if (!s) {\n    return undefined;\n  }\n  if (!/^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)?$/.test(s)) {\n    return undefined;\n  }\n  if (/^\\d+(\\.\\d+)?$/.test(s)) {\n    return s + 'px';\n  }\n  return s;\n}\n\n\n\n/**\n * Asserts that the supplied value is a non-percent CSS Length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {!LengthDef}\n */\nexport function assertLength(length) {\n  user().assert(\n      /^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)$/.test(length),\n      'Invalid length value: %s', length);\n  return /** @type {!LengthDef} */ (length);\n}\n\n\n\n\n/**\n * Asserts that the supplied value is a CSS Length value\n * (including percent unit).\n * @param {!LengthDef|string} length\n * @return {!LengthDef}\n */\nexport function assertLengthOrPercent(length) {\n  user().assert(/^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|%)$/.test(length),\n      'Invalid length or percent value: %s', length);\n  return length;\n}\n\n\n/**\n * Returns units from the CSS length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {string}\n */\nexport function getLengthUnits(length) {\n  assertLength(length);\n  dev().assertString(length);\n  const m = user().assert(length.match(/[a-z]+/i),\n      'Failed to read units from %s', length);\n  return m[0];\n}\n\n\n/**\n * Returns the numeric value of a CSS length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {number|undefined}\n */\nexport function getLengthNumeral(length) {\n  const res = parseFloat(length);\n  return isFiniteNumber(res) ? res : undefined;\n}\n\n\n/**\n * Determines whether the tagName is a known element that has natural dimensions\n * in our runtime or the browser.\n * @param {string} tagName The element tag name.\n * @return {boolean}\n */\nexport function hasNaturalDimensions(tagName) {\n  tagName = tagName.toUpperCase();\n  return naturalDimensions_[tagName] !== undefined;\n}\n\n\n/**\n * Determines the default dimensions for an element which could vary across\n * different browser implementations, like <audio> for instance.\n * This operation can only be completed for an element whitelisted by\n * `hasNaturalDimensions`.\n * @param {!Element} element\n * @return {DimensionsDef}\n */\nexport function getNaturalDimensions(element) {\n  const tagName = element.tagName.toUpperCase();\n  dev().assert(naturalDimensions_[tagName] !== undefined);\n  if (!naturalDimensions_[tagName]) {\n    const doc = element.ownerDocument;\n    const naturalTagName = tagName.replace(/^AMP\\-/, '');\n    const temp = doc.createElement(naturalTagName);\n    // For audio, should no-op elsewhere.\n    temp.controls = true;\n    setStyles(temp, {\n      position: 'absolute',\n      visibility: 'hidden',\n    });\n    doc.body.appendChild(temp);\n    naturalDimensions_[tagName] = {\n      width: (temp./*OK*/offsetWidth || 1) + 'px',\n      height: (temp./*OK*/offsetHeight || 1) + 'px',\n    };\n    doc.body.removeChild(temp);\n  }\n  return /** @type {DimensionsDef} */ (naturalDimensions_[tagName]);\n}\n\n\n/**\n * Whether the loading can be shown for the specified elemeent. This set has\n * to be externalized since the element's implementation may not be\n * downloaded yet.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isLoadingAllowed(element) {\n  const tagName = element.tagName.toUpperCase();\n  if (tagName == 'AMP-AD' || tagName == 'AMP-EMBED') {\n    return true;\n  }\n  return LOADING_ELEMENTS_[tagName] || false;\n}\n\n\n/**\n * Applies layout to the element. Visible for testing only.\n *\n * \\   \\  /  \\  /   / /   \\     |   _  \\     |  \\ |  | |  | |  \\ |  |  / _____|\n *  \\   \\/    \\/   / /  ^  \\    |  |_)  |    |   \\|  | |  | |   \\|  | |  |  __\n *   \\            / /  /_\\  \\   |      /     |  . `  | |  | |  . `  | |  | |_ |\n *    \\    /\\    / /  _____  \\  |  |\\  \\----.|  |\\   | |  | |  |\\   | |  |__| |\n *     \\__/  \\__/ /__/     \\__\\ | _| `._____||__| \\__| |__| |__| \\__|  \\______|\n *\n * The equivalent of this method is used for server-side rendering (SSR) and\n * any changes made to it must be made in coordination with caches that\n * implement SSR. For more information on SSR see bit.ly/amp-ssr.\n *\n * @param {!Element} element\n * @return {!Layout}\n */\nexport function applyStaticLayout(element) {\n  // Check if the layout has already been done by server-side rendering. The\n  // document may be visible to the user if the boilerplate was removed so\n  // please take care in making changes here.\n  const completedLayoutAttr = element.getAttribute('i-amphtml-layout');\n  if (completedLayoutAttr) {\n    const layout = /** @type {!Layout} */ (dev().assert(\n        parseLayout(completedLayoutAttr)));\n    if ((layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC)\n      && element.firstElementChild) {\n      // Find sizer, but assume that it might not have been parsed yet.\n      element.sizerElement =\n          element.querySelector('i-amphtml-sizer') || undefined;\n    } else if (layout == Layout.NODISPLAY) {\n      applyNoDisplayLayout(element);\n    }\n    return layout;\n  }\n\n  // If the layout was already done by server-side rendering (SSR), then the\n  // code below will not run. Any changes below will necessitate a change to SSR\n  // and must be coordinated with caches that implement SSR. See bit.ly/amp-ssr.\n\n  // Parse layout from the element.\n  const layoutAttr = element.getAttribute('layout');\n  const widthAttr = element.getAttribute('width');\n  const heightAttr = element.getAttribute('height');\n  const sizesAttr = element.getAttribute('sizes');\n  const heightsAttr = element.getAttribute('heights');\n\n  // Input layout attributes.\n  const inputLayout = layoutAttr ? parseLayout(layoutAttr) : null;\n  user().assert(inputLayout !== undefined, 'Unknown layout: %s', layoutAttr);\n  /** @const {string|null|undefined} */\n  const inputWidth = (widthAttr && widthAttr != 'auto') ?\n    parseLength(widthAttr) : widthAttr;\n  user().assert(inputWidth !== undefined, 'Invalid width value: %s', widthAttr);\n  /** @const {string|null|undefined} */\n  const inputHeight = (heightAttr && heightAttr != 'fluid') ?\n    parseLength(heightAttr) : heightAttr;\n  user().assert(inputHeight !== undefined, 'Invalid height value: %s',\n      heightAttr);\n\n  // Effective layout attributes. These are effectively constants.\n  let width;\n  let height;\n  let layout;\n\n  // Calculate effective width and height.\n  if ((!inputLayout || inputLayout == Layout.FIXED ||\n      inputLayout == Layout.FIXED_HEIGHT) &&\n      (!inputWidth || !inputHeight) && hasNaturalDimensions(element.tagName)) {\n    // Default width and height: handle elements that do not specify a\n    // width/height and are defined to have natural browser dimensions.\n    const dimensions = getNaturalDimensions(element);\n    width = (inputWidth || inputLayout == Layout.FIXED_HEIGHT) ? inputWidth :\n      dimensions.width;\n    height = inputHeight || dimensions.height;\n  } else {\n    width = inputWidth;\n    height = inputHeight;\n  }\n\n  // Calculate effective layout.\n  if (inputLayout) {\n    layout = inputLayout;\n  } else if (!width && !height) {\n    layout = Layout.CONTAINER;\n  } else if (height == 'fluid') {\n    layout = Layout.FLUID;\n  } else if (height && (!width || width == 'auto')) {\n    layout = Layout.FIXED_HEIGHT;\n  } else if (height && width && (sizesAttr || heightsAttr)) {\n    layout = Layout.RESPONSIVE;\n  } else {\n    layout = Layout.FIXED;\n  }\n\n  // Verify layout attributes.\n  if (layout == Layout.FIXED || layout == Layout.FIXED_HEIGHT ||\n      layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC) {\n    user().assert(height, 'Expected height to be available: %s', heightAttr);\n  }\n  if (layout == Layout.FIXED_HEIGHT) {\n    user().assert(!width || width == 'auto',\n        'Expected width to be either absent or equal \"auto\" ' +\n        'for fixed-height layout: %s', widthAttr);\n  }\n  if (layout == Layout.FIXED || layout == Layout.RESPONSIVE ||\n      layout == Layout.INTRINSIC) {\n    user().assert(width && width != 'auto',\n        'Expected width to be available and not equal to \"auto\": %s',\n        widthAttr);\n  }\n\n  if (layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC) {\n    user().assert(getLengthUnits(width) == getLengthUnits(height),\n        'Length units should be the same for width and height: %s, %s',\n        widthAttr, heightAttr);\n  } else {\n    user().assert(heightsAttr === null,\n        'Unexpected \"heights\" attribute for none-responsive layout');\n  }\n\n  // Apply UI.\n  element.classList.add(getLayoutClass(layout));\n  if (isLayoutSizeDefined(layout)) {\n    element.classList.add('i-amphtml-layout-size-defined');\n  }\n  if (layout == Layout.NODISPLAY) {\n    // CSS defines layout=nodisplay automatically with `display:none`. Thus\n    // no additional styling is needed.\n    applyNoDisplayLayout(element);\n  } else if (layout == Layout.FIXED) {\n    setStyles(element, {\n      width: dev().assertString(width),\n      height: dev().assertString(height),\n    });\n  } else if (layout == Layout.FIXED_HEIGHT) {\n    setStyle(element, 'height', dev().assertString(height));\n  } else if (layout == Layout.RESPONSIVE) {\n    const sizer = element.ownerDocument.createElement('i-amphtml-sizer');\n    setStyles(sizer, {\n      display: 'block',\n      paddingTop:\n        ((getLengthNumeral(height) / getLengthNumeral(width)) * 100) + '%',\n    });\n    element.insertBefore(sizer, element.firstChild);\n    element.sizerElement = sizer;\n  } else if (layout == Layout.INTRINSIC) {\n    // Intrinsic uses an svg inside the sizer element rather than the padding\n    // trick Note a naked svg won't work becasue other thing expect the\n    // i-amphtml-sizer element\n    const sizer = htmlFor(element)`\n      <i-amphtml-sizer class=\"i-amphtml-sizer\">\n        <img class=\"i-amphtml-intrinsic-sizer\" />\n      </i-amphtml-sizer>`;\n    const intrinsicSizer = sizer.firstElementChild;\n    intrinsicSizer.setAttribute('src',\n        `data:image/svg+xml;charset=utf-8,<svg height=\"${height}\" width=\"${width}\" xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\"/>`);\n    element.insertBefore(sizer, element.firstChild);\n    // TODO(jpettitt): sizer is leaked and can't be cleaned up.\n    element.sizerElement = intrinsicSizer;\n  } else if (layout == Layout.FILL) {\n    // Do nothing.\n  } else if (layout == Layout.CONTAINER) {\n    // Do nothing. Elements themselves will check whether the supplied\n    // layout value is acceptable. In particular container is only OK\n    // sometimes.\n  } else if (layout == Layout.FLEX_ITEM) {\n    // Set height and width to a flex item if they exist.\n    // The size set to a flex item could be overridden by `display: flex` later.\n    if (width) {\n      setStyle(element, 'width', width);\n    }\n    if (height) {\n      setStyle(element, 'height', height);\n    }\n  } else if (layout == Layout.FLUID) {\n    element.classList.add('i-amphtml-layout-awaiting-size');\n    if (width) {\n      setStyle(element, 'width', width);\n    }\n    setStyle(element, 'height', 0);\n  }\n  return layout;\n}\n\n\n/**\n * @param {!Element} element\n */\nfunction applyNoDisplayLayout(element) {\n  // TODO(dvoytenko, #9353): once `toggleLayoutDisplay` API has been deployed\n  // everywhere, switch all relevant elements to this API. In the meantime,\n  // simply unblock display toggling via `style=\"display: ...\"`.\n  setStyle(element, 'display', 'none');\n  element.classList.add('i-amphtml-display');\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {getModeObject} from './mode-object';\nimport {isEnumValue} from './types';\n\n/**\n * Triple zero width space.\n *\n * This is added to user error messages, so that we can later identify\n * them, when the only thing that we have is the message. This is the\n * case in many browsers when the global exception handler is invoked.\n *\n * @const {string}\n */\nexport const USER_ERROR_SENTINEL = '\\u200B\\u200B\\u200B';\n\n\n/**\n * Four zero width space.\n *\n * @const {string}\n */\nexport const USER_ERROR_EMBED_SENTINEL = '\\u200B\\u200B\\u200B\\u200B';\n\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a user error.\n */\nexport function isUserErrorMessage(message) {\n  return message.indexOf(USER_ERROR_SENTINEL) >= 0;\n}\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a a user error from an iframe embed.\n */\nexport function isUserErrorEmbed(message) {\n  return message.indexOf(USER_ERROR_EMBED_SENTINEL) >= 0;\n}\n\n\n/**\n * @enum {number}\n * @private Visible for testing only.\n */\nexport const LogLevel = {\n  OFF: 0,\n  ERROR: 1,\n  WARN: 2,\n  INFO: 3,\n  FINE: 4,\n};\n\n/**\n * Sets reportError function. Called from error.js to break cyclic\n * dependency.\n * @param {function(*, !Element=)|undefined} fn\n */\nexport function setReportError(fn) {\n  self.reportError = fn;\n}\n\n/**\n * @type {!LogLevel|undefined}\n * @private\n */\nlet levelOverride_ = undefined;\n\n/**\n * @param {!LogLevel} level\n */\nexport function overrideLogLevel(level) {\n  levelOverride_ = level;\n}\n\n/**\n * Logging class. Use of sentinel string instead of a boolean to check user/dev\n * errors because errors could be rethrown by some native code as a new error,\n * and only a message would survive. Also, some browser dont support a 5th\n * error object argument in window.onerror. List of supporting browser can be\n * found here:\n * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n * @final\n * @private Visible for testing only.\n */\nexport class Log {\n  /**\n   * opt_suffix will be appended to error message to identify the type of the\n   * error message. We can't rely on the error object to pass along the type\n   * because some browsers do not have this param in its window.onerror API.\n   * See:\n   * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n   *\n   * @param {!Window} win\n   * @param {function(!./mode.ModeDef):!LogLevel} levelFunc\n   * @param {string=} opt_suffix\n   */\n  constructor(win, levelFunc, opt_suffix) {\n    /**\n     * In tests we use the main test window instead of the iframe where\n     * the tests runs because only the former is relayed to the console.\n     * @const {!Window}\n     */\n    this.win = (getMode().test && win.AMP_TEST_IFRAME) ? win.parent : win;\n\n    /** @private @const {function(!./mode.ModeDef):!LogLevel} */\n    this.levelFunc_ = levelFunc;\n\n    /** @private @const {!LogLevel} */\n    this.level_ = this.defaultLevel_();\n\n    /** @private @const {string} */\n    this.suffix_ = opt_suffix || '';\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  getLevel_() {\n    return (levelOverride_ !== undefined) ? levelOverride_ : this.level_;\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  defaultLevel_() {\n    // No console - can't enable logging.\n    if (!this.win.console || !this.win.console.log) {\n      return LogLevel.OFF;\n    }\n\n    // Logging has been explicitly disabled.\n    if (getMode().log == '0') {\n      return LogLevel.OFF;\n    }\n\n    // Logging is enabled for tests directly.\n    if (getMode().test && this.win.ENABLE_LOG) {\n      return LogLevel.FINE;\n    }\n\n    // LocalDev by default allows INFO level, unless overriden by `#log`.\n    if (getMode().localDev && !getMode().log) {\n      return LogLevel.INFO;\n    }\n\n    // Delegate to the specific resolver.\n    return this.levelFunc_(getModeObject());\n  }\n\n  /**\n   * @param {string} tag\n   * @param {string} level\n   * @param {!Array} messages\n   */\n  msg_(tag, level, messages) {\n    if (this.getLevel_() != LogLevel.OFF) {\n      let fn = this.win.console.log;\n      if (level == 'ERROR') {\n        fn = this.win.console.error || fn;\n      } else if (level == 'INFO') {\n        fn = this.win.console.info || fn;\n      } else if (level == 'WARN') {\n        fn = this.win.console.warn || fn;\n      }\n      if (getMode().localDev) {\n        messages.unshift('[' + tag + ']');\n      }\n      fn.apply(this.win.console, messages);\n    }\n  }\n\n  /**\n   * Whether the logging is enabled.\n   * @return {boolean}\n   */\n  isEnabled() {\n    return this.getLevel_() != LogLevel.OFF;\n  }\n\n  /**\n   * Reports a fine-grained message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  fine(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.FINE) {\n      this.msg_(tag, 'FINE', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a informational message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  info(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.INFO) {\n      this.msg_(tag, 'INFO', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a warning message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  warn(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.WARN) {\n      this.msg_(tag, 'WARN', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports an error message. If the logging is disabled, the error is rethrown\n   * asynchronously.\n   * @param {string} tag\n   * @param {...*} var_args\n   * @return {!Error|undefined}\n   * @private\n   */\n  error_(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.ERROR) {\n      this.msg_(tag, 'ERROR', Array.prototype.slice.call(arguments, 1));\n    } else {\n      const error = createErrorVargs.apply(null,\n          Array.prototype.slice.call(arguments, 1));\n      this.prepareError_(error);\n      return error;\n    }\n  }\n\n  /**\n   * Reports an error message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  error(tag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.name = tag || error.name;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Reports an error message and marks with an expected property. If the\n   * logging is disabled, the error is rethrown asynchronously.\n   * @param {string} unusedTag\n   * @param {...*} var_args\n   */\n  expectedError(unusedTag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.expected = true;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Creates an error object.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    return error;\n  }\n\n  /**\n   * Creates an error object with its expected property set to true.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createExpectedError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    error.expected = true;\n    return error;\n  }\n\n  /**\n   * Throws an error if the first argument isn't trueish.\n   *\n   * Supports argument substitution into the message via %s placeholders.\n   *\n   * Throws an error object that has two extra properties:\n   * - associatedElement: This is the first element provided in the var args.\n   *   It can be used for improved display of error messages.\n   * - messageArray: The elements of the substituted message as non-stringified\n   *   elements in an array. When e.g. passed to console.error this yields\n   *   native displays of things like HTML elements.\n   *\n   * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n   *     not evaluate to true.\n   * @param {string=} opt_message The assertion message\n   * @param {...*} var_args Arguments substituted into %s in the message.\n   * @return {T} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 0\n   */\n  assert(shouldBeTrueish, opt_message, var_args) {\n    let firstElement;\n    if (!shouldBeTrueish) {\n      const message = opt_message || 'Assertion failed';\n      const splitMessage = message.split('%s');\n      const first = splitMessage.shift();\n      let formatted = first;\n      const messageArray = [];\n      pushIfNonEmpty(messageArray, first);\n      for (let i = 2; i < arguments.length; i++) {\n        const val = arguments[i];\n        if (val && val.tagName) {\n          firstElement = val;\n        }\n        const nextConstant = splitMessage.shift();\n        messageArray.push(val);\n        pushIfNonEmpty(messageArray, nextConstant.trim());\n        formatted += toString(val) + nextConstant;\n      }\n      const e = new Error(formatted);\n      e.fromAssert = true;\n      e.associatedElement = firstElement;\n      e.messageArray = messageArray;\n      this.prepareError_(e);\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n    return shouldBeTrueish;\n  }\n\n  /**\n   * Throws an error if the first argument isn't an Element\n   *\n   * Otherwise see `assert` for usage\n   *\n   * @param {*} shouldBeElement\n   * @param {string=} opt_message The assertion message\n   * @return {!Element} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertElement(shouldBeElement, opt_message) {\n    const shouldBeTrueish = shouldBeElement && shouldBeElement.nodeType == 1;\n    this.assert(shouldBeTrueish, (opt_message || 'Element expected') + ': %s',\n        shouldBeElement);\n    return /** @type {!Element} */ (shouldBeElement);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a string. The string can\n   * be empty.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeString\n   * @param {string=} opt_message The assertion message\n   * @return {string} The string value. Can be an empty string.\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertString(shouldBeString, opt_message) {\n    this.assert(typeof shouldBeString == 'string',\n        (opt_message || 'String expected') + ': %s', shouldBeString);\n    return /** @type {string} */ (shouldBeString);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a number. The allowed values\n   * include `0` and `NaN`.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeNumber\n   * @param {string=} opt_message The assertion message\n   * @return {number} The number value. The allowed values include `0`\n   *   and `NaN`.\n   */\n  assertNumber(shouldBeNumber, opt_message) {\n    this.assert(typeof shouldBeNumber == 'number',\n        (opt_message || 'Number expected') + ': %s', shouldBeNumber);\n    return /** @type {number} */ (shouldBeNumber);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a boolean.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeBoolean\n   * @param {string=} opt_message The assertion message\n   * @return {boolean} The boolean value.\n   */\n  assertBoolean(shouldBeBoolean, opt_message) {\n    this.assert(!!shouldBeBoolean === shouldBeBoolean,\n        (opt_message || 'Boolean expected') + ': %s', shouldBeBoolean);\n    return /** @type {boolean} */ (shouldBeBoolean);\n  }\n\n  /**\n   * Asserts and returns the enum value. If the enum doesn't contain such a\n   * value, the error is thrown.\n   *\n   * @param {!Object<T>} enumObj\n   * @param {string} s\n   * @param {string=} opt_enumName\n   * @return {T}\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertEnumValue(enumObj, s, opt_enumName) {\n    if (isEnumValue(enumObj, s)) {\n      return s;\n    }\n    this.assert(false,\n        'Unknown %s value: \"%s\"',\n        opt_enumName || 'enum', s);\n  }\n\n  /**\n   * @param {!Error} error\n   * @private\n   */\n  prepareError_(error) {\n    error = duplicateErrorIfNecessary(error);\n    if (this.suffix_) {\n      if (!error.message) {\n        error.message = this.suffix_;\n      } else if (error.message.indexOf(this.suffix_) == -1) {\n        error.message += this.suffix_;\n      }\n    } else if (isUserErrorMessage(error.message)) {\n      error.message = error.message.replace(USER_ERROR_SENTINEL, '');\n    }\n  }\n}\n\n/**\n * @param {string|!Element} val\n * @return {string}\n */\nfunction toString(val) {\n  // Do check equivalent to `val instanceof Element` without cross-window bug\n  if (val && val.nodeType == 1) {\n    return val.tagName.toLowerCase() + (val.id ? '#' + val.id : '');\n  }\n  return /** @type {string} */ (val);\n}\n\n\n/**\n * @param {!Array} array\n * @param {*} val\n */\nfunction pushIfNonEmpty(array, val) {\n  if (val != '') {\n    array.push(val);\n  }\n}\n\n/**\n * Some exceptions (DOMException, namely) have read-only message.\n * @param {!Error} error\n * @return {!Error};\n */\nexport function duplicateErrorIfNecessary(error) {\n  const {message} = error;\n  const test = String(Math.random());\n  error.message = test;\n\n  if (error.message === test) {\n    error.message = message;\n    return error;\n  }\n\n  const e = new Error(error.message);\n  // Copy all the extraneous things we attach.\n  for (const prop in error) {\n    e[prop] = error[prop];\n  }\n  // Ensure these are copied.\n  e.stack = error.stack;\n  return e;\n}\n\n/**\n * @param {...*} var_args\n * @return {!Error}\n * @visibleForTesting\n */\nexport function createErrorVargs(var_args) {\n  let error = null;\n  let message = '';\n  for (let i = 0; i < arguments.length; i++) {\n    const arg = arguments[i];\n    if (arg instanceof Error && !error) {\n      error = duplicateErrorIfNecessary(arg);\n    } else {\n      if (message) {\n        message += ' ';\n      }\n      message += arg;\n    }\n  }\n\n  if (!error) {\n    error = new Error(message);\n  } else if (message) {\n    error.message = message + ': ' + error.message;\n  }\n  return error;\n}\n\n\n/**\n * Rethrows the error without terminating the current context. This preserves\n * whether the original error designation is a user error or a dev error.\n * @param {...*} var_args\n */\nexport function rethrowAsync(var_args) {\n  const error = createErrorVargs.apply(null, arguments);\n  setTimeout(() => {\n    // reportError is installed globally per window in the entry point.\n    self.reportError(error);\n    throw error;\n  });\n}\n\n\n/**\n * Cache for logs. We do not use a Service since the service module depends\n * on Log and closure literally can't even.\n * @type {{user: ?Log, dev: ?Log, userForEmbed: ?Log}}\n */\nself.log = (self.log || {\n  user: null,\n  dev: null,\n  userForEmbed: null,\n});\n\nconst logs = self.log;\n\n/**\n * Eventually holds a constructor for Log objects. Lazily initialized, so we\n * can avoid ever referencing the real constructor except in JS binaries\n * that actually want to include the implementation.\n * @type {?Function}\n */\nlet logConstructor = null;\n\n/**\n * Initializes log contructor.\n */\nexport function initLogConstructor() {\n  logConstructor = Log;\n  // Initialize instances for use. If a binary (an extension for example) that\n  // does not call `initLogConstructor` invokes `dev()` or `user()` earlier than\n  // the binary that does call `initLogConstructor` (amp.js), the extension will\n  // throw an error as that extension will never be able to initialize the log\n  // instances and we also don't want it to call `initLogConstructor` either\n  // (since that will cause the Log implementation to be bundled into that\n  // binary). So we must initialize the instances eagerly so that they are ready\n  // for use (stored globally) after the main binary calls `initLogConstructor`.\n  dev();\n  user();\n}\n\n/**\n * Resets log contructor for testing.\n */\nexport function resetLogConstructorForTesting() {\n  logConstructor = null;\n}\n\n/**\n * Publisher level log.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Development mode is enabled via `#development=1` or logging is explicitly\n *     enabled via `#log=D` where D >= 1.\n *  3. AMP.setLogLevel(D) is called, where D >= 1.\n *\n * @param {!Element=} opt_element\n * @return {!Log}\n */\nexport function user(opt_element) {\n  if (!logs.user) {\n    logs.user = getUserLogger(USER_ERROR_SENTINEL);\n  }\n  if (!isFromEmbed(logs.user.win, opt_element)) {\n    return logs.user;\n  } else {\n    if (logs.userForEmbed) {\n      return logs.userForEmbed;\n    }\n    return logs.userForEmbed = getUserLogger(USER_ERROR_EMBED_SENTINEL);\n  }\n}\n\n/**\n * Getter for user logger\n * @param {string=} suffix\n * @return {!Log}\n */\nfunction getUserLogger(suffix) {\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (mode.development || logNum >= 1) {\n      return LogLevel.FINE;\n    }\n    return LogLevel.WARN;\n  }, suffix);\n}\n\n/**\n * AMP development log. Calls to `devLog().assert` and `dev.fine` are stripped\n * in the PROD binary. However, `devLog().assert` result is preserved in either\n * case.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Logging is explicitly enabled via `#log=D`, where D >= 2.\n *  3. AMP.setLogLevel(D) is called, where D >= 2.\n *\n * @return {!Log}\n */\nexport function dev() {\n  if (logs.dev) {\n    return logs.dev;\n  }\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return logs.dev = new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (logNum >= 3) {\n      return LogLevel.FINE;\n    }\n    if (logNum >= 2) {\n      return LogLevel.INFO;\n    }\n    return LogLevel.OFF;\n  });\n}\n\n/**\n * @param {!Window} win\n * @param {!Element=} opt_element\n * @return {boolean} isEmbed\n */\nexport function isFromEmbed(win, opt_element) {\n  if (!opt_element) {\n    return false;\n  }\n  return opt_element.ownerDocument.defaultView != win;\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {Services} from './services';\nimport {dev, user} from './log';\nimport {isArray, isObject} from './types';\nimport {tryParseJson} from './json';\n\n/**\n * @typedef {{\n *   artwork: Array,\n *   title: string,\n *   album: string,\n *   artist: string,\n * }}\n */\nexport let MetadataDef;\n\n/** @const {MetadataDef} Dummy metadata used to fix a bug */\nexport const EMPTY_METADATA = {\n  'title': '',\n  'artist': '',\n  'album': '',\n  'artwork': [\n    {'src': ''},\n  ],\n};\n\n/**\n * Updates the Media Session API's metadata\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n * @param {!MetadataDef} metadata\n * @param {function()=} playHandler\n * @param {function()=} pauseHandler\n */\nexport function setMediaSession(ampdoc, metadata, playHandler, pauseHandler) {\n  const {win} = ampdoc;\n  const {navigator} = win;\n  if ('mediaSession' in navigator && win.MediaMetadata) {\n    // Clear mediaSession (required to fix a bug when switching between two\n    // videos)\n    navigator.mediaSession.metadata = new win.MediaMetadata(EMPTY_METADATA);\n\n    // Add metadata\n    validateMetadata(ampdoc, metadata);\n    navigator.mediaSession.metadata = new win.MediaMetadata(metadata);\n\n    navigator.mediaSession.setActionHandler('play', playHandler);\n    navigator.mediaSession.setActionHandler('pause', pauseHandler);\n\n    // TODO(@wassgha) Implement seek & next/previous\n  }\n}\n\n\n/**\n * Parses the schema.org json-ld formatted meta-data, looks for the page's\n * featured image and returns it\n * @param {!Document} doc\n * @return {string|undefined}\n */\nexport function parseSchemaImage(doc) {\n  const schema = doc.querySelector('script[type=\"application/ld+json\"]');\n  if (!schema) {\n    // No schema element found\n    return;\n  }\n  const schemaJson = tryParseJson(schema.textContent);\n  if (!schemaJson || !schemaJson['image']) {\n    // No image found in the schema\n    return;\n  }\n\n  // Image definition in schema could be one of :\n  if (typeof schemaJson['image'] === 'string') {\n    // 1. \"image\": \"http://..\",\n    return schemaJson['image'];\n  } else if (schemaJson['image']['@list']\n      && typeof schemaJson['image']['@list'][0] === 'string') {\n    // 2. \"image\": {.., \"@list\": [\"http://..\"], ..}\n    return schemaJson['image']['@list'][0];\n  } else if (typeof schemaJson['image']['url'] === 'string') {\n    // 3. \"image\": {.., \"url\": \"http://..\", ..}\n    return schemaJson['image']['url'];\n  } else if (typeof schemaJson['image'][0] === 'string') {\n    // 4. \"image\": [\"http://.. \"]\n    return schemaJson['image'][0];\n  } else {\n    return;\n  }\n}\n\n/**\n * Parses the og:image if it exists and returns it\n * @param {!Document} doc\n * @return {string|undefined}\n */\nexport function parseOgImage(doc) {\n  const metaTag = doc.querySelector('meta[property=\"og:image\"]');\n  if (metaTag) {\n    return metaTag.getAttribute('content');\n  } else {\n    return;\n  }\n}\n\n/**\n * Parses the website's Favicon and returns it\n * @param {!Document} doc\n * @return {string|undefined}\n */\nexport function parseFavicon(doc) {\n  const linkTag = doc.querySelector('link[rel=\"shortcut icon\"]')\n                  || doc.querySelector('link[rel=\"icon\"]');\n  if (linkTag) {\n    return linkTag.getAttribute('href');\n  } else {\n    return;\n  }\n}\n\n/**\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n * @param {!MetadataDef} metadata\n * @private\n */\nfunction validateMetadata(ampdoc, metadata) {\n  const urlService = Services.urlForDoc(ampdoc);\n  // Ensure src of artwork has valid protocol\n  if (metadata && metadata.artwork) {\n    const {artwork} = metadata;\n    dev().assert(isArray(artwork));\n    artwork.forEach(item => {\n      if (item) {\n        const src = isObject(item) ? item.src : item;\n        user().assert(urlService.isProtocolValid(src));\n      }\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\n\n/**\n * Provides info about the current app. This return value may be cached and\n * passed around as it will always be DCE'd.\n * @param {?Window=} opt_win\n * @return {!./mode.ModeDef}\n */\nexport function getModeObject(opt_win) {\n  return {\n    localDev: getMode(opt_win).localDev,\n    development: getMode(opt_win).development,\n    filter: getMode(opt_win).filter,\n    minified: getMode(opt_win).minified,\n    lite: getMode(opt_win).lite,\n    test: getMode(opt_win).test,\n    log: getMode(opt_win).log,\n    version: getMode(opt_win).version,\n    rtvVersion: getMode(opt_win).rtvVersion,\n  };\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {parseQueryString_} from './url-parse-query-string';\n\n/**\n * @typedef {{\n *   localDev: boolean,\n *   development: boolean,\n *   filter: (string|undefined),\n *   minified: boolean,\n *   lite: boolean,\n *   test: boolean,\n *   log: (string|undefined),\n *   version: string,\n *   rtvVersion: string,\n * }}\n */\nexport let ModeDef;\n\n/** @type {string} */\nconst version = '$internalRuntimeVersion$';\n\n/**\n * `rtvVersion` is the prefixed version we serve off of the cdn.\n * The prefix denotes canary(00) or prod(01) or an experiment version ( > 01).\n * @type {string}\n */\nlet rtvVersion = '';\n\n/**\n * Provides info about the current app.\n * @param {?Window=} opt_win\n * @return {!ModeDef}\n */\nexport function getMode(opt_win) {\n  const win = opt_win || self;\n  if (win.AMP_MODE) {\n    return win.AMP_MODE;\n  }\n  return win.AMP_MODE = getMode_(win);\n}\n\n/**\n * Provides info about the current app.\n * @param {!Window} win\n * @return {!ModeDef}\n */\nfunction getMode_(win) {\n  // Magic constants that are replaced by closure compiler.\n  // IS_MINIFIED is always replaced with true when closure compiler is used\n  // while IS_DEV is only replaced when `gulp dist` is called without the\n  // --fortesting flag.\n  const IS_DEV = true;\n  const IS_MINIFIED = false;\n\n  const localDevEnabled = !!(self.AMP_CONFIG && self.AMP_CONFIG.localDev);\n  const runningTests = IS_DEV && !!(win.AMP_TEST || win.__karma__);\n  const isLocalDev = IS_DEV && (localDevEnabled || runningTests);\n  const hashQuery = parseQueryString_(\n      // location.originalHash is set by the viewer when it removes the fragment\n      // from the URL.\n      win.location.originalHash || win.location.hash);\n\n  const searchQuery = parseQueryString_(win.location.search);\n\n  if (!rtvVersion) {\n    rtvVersion = getRtvVersion(win, isLocalDev);\n  }\n\n  // The `minified`, `test` and `localDev` properties are replaced\n  // as boolean literals when we run `gulp dist` without the `--fortesting`\n  // flags. This improved DCE on the production file we deploy as the code\n  // paths for localhost/testing/development are eliminated.\n  return {\n    localDev: isLocalDev,\n    // Triggers validation or enable pub level logging. Validation can be\n    // bypassed via #validate=0.\n    // Note that AMP_DEV_MODE flag is used for testing purposes.\n    development: !!(hashQuery['development'] == '1' || win.AMP_DEV_MODE),\n    examiner: hashQuery['development'] == '2',\n    // Allows filtering validation errors by error category. For the\n    // available categories, see ErrorCategory in validator/validator.proto.\n    filter: hashQuery['filter'],\n    // amp-geo override\n    geoOverride: hashQuery['amp-geo'],\n    minified: IS_MINIFIED,\n    // Whether document is in an amp-lite viewer. It signal that the user\n    // would prefer to use less bandwidth.\n    lite: searchQuery['amp_lite'] != undefined,\n    test: runningTests,\n    log: hashQuery['log'],\n    version,\n    rtvVersion,\n  };\n}\n\n/**\n * Retrieve the `rtvVersion` which will have a numeric prefix\n * denoting canary/prod/experiment (unless `isLocalDev` is true).\n *\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n */\nfunction getRtvVersion(win, isLocalDev) {\n  // If it's local dev then we won't actually have a full version so\n  // just use the version.\n  if (isLocalDev) {\n    return version;\n  }\n\n  if (win.AMP_CONFIG && win.AMP_CONFIG.v) {\n    return win.AMP_CONFIG.v;\n  }\n\n  // Currently `$internalRuntimeVersion$` and thus `mode.version` contain only\n  // major version. The full version however must also carry the minor version.\n  // We will default to production default `01` minor version for now.\n  // TODO(erwinmombay): decide whether $internalRuntimeVersion$ should contain\n  // minor version.\n  return `01${version}`;\n}\n\n\n/**\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n * @visibleForTesting\n */\nexport function getRtvVersionForTesting(win, isLocalDev) {\n  return getRtvVersion(win, isLocalDev);\n}\n\n\n/** @visibleForTesting */\nexport function resetRtvVersionForTesting() {\n  rtvVersion = '';\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n\n/**\n * This class helps to manage observers. Observers can be added, removed or\n * fired through and instance of this class.\n * @template TYPE\n */\nexport class Observable {\n\n  /**\n   * Creates an instance of Observable.\n   */\n  constructor() {\n    /** @type {?Array<function(TYPE)>} */\n    this.handlers_ = null;\n  }\n\n  /**\n   * Adds the observer to this instance.\n   * @param {function(TYPE)} handler Observer's handler.\n   * @return {!UnlistenDef}\n   */\n  add(handler) {\n    if (!this.handlers_) {\n      this.handlers_ = [];\n    }\n    this.handlers_.push(handler);\n    return () => {\n      this.remove(handler);\n    };\n  }\n\n  /**\n   * Removes the observer from this instance.\n   * @param {function(TYPE)} handler Observer's instance.\n   */\n  remove(handler) {\n    if (!this.handlers_) {\n      return;\n    }\n    const index = this.handlers_.indexOf(handler);\n    if (index > -1) {\n      this.handlers_.splice(index, 1);\n    }\n  }\n\n  /**\n   * Removes all observers.\n   */\n  removeAll() {\n    if (!this.handlers_) {\n      return;\n    }\n    this.handlers_.length = 0;\n  }\n\n  /**\n   * Fires an event. All observers are called.\n   * @param {TYPE=} opt_event\n   */\n  fire(opt_event) {\n    if (!this.handlers_) {\n      return;\n    }\n    const handlers = this.handlers_;\n    for (let i = 0; i < handlers.length; i++) {\n      const handler = handlers[i];\n      handler(opt_event);\n    }\n  }\n\n  /**\n   * Returns number of handlers. Mostly needed for tests.\n   * @return {number}\n   */\n  getHandlerCount() {\n    if (!this.handlers_) {\n      return 0;\n    }\n    return this.handlers_.length;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {install as installArrayIncludes} from './polyfills/array-includes';\nimport {install as installCustomElements} from './polyfills/custom-elements';\nimport {\n  install as installDOMTokenListToggle,\n} from './polyfills/domtokenlist-toggle';\nimport {install as installDocContains} from './polyfills/document-contains';\nimport {install as installMathSign} from './polyfills/math-sign';\nimport {install as installObjectAssign} from './polyfills/object-assign';\nimport {install as installPromise} from './polyfills/promise';\nimport {installCustomElements as installRegisterElement} from\n  'document-register-element/build/document-register-element.patched';\nimport {isExperimentOn} from './experiments';\n\nif (isExperimentOn(self, 'custom-elements-v1') || getMode().test) {\n  installCustomElements(self, class {});\n} else {\n  installRegisterElement(self, 'auto');\n}\ninstallDOMTokenListToggle(self);\ninstallMathSign(self);\ninstallObjectAssign(self);\ninstallPromise(self);\ninstallDocContains(self);\ninstallArrayIncludes(self);\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Returns true if the element is in the array and false otherwise.\n *\n * @param {*} value\n * @param {number=} opt_fromIndex\n * @return {boolean}\n * @this {Array}\n */\nfunction includes(value, opt_fromIndex) {\n  const fromIndex = opt_fromIndex || 0;\n  const len = this.length;\n  let i = fromIndex >= 0 ? fromIndex : Math.max(len + fromIndex, 0);\n  for (; i < len; i++) {\n    const other = this[i];\n    // If value has been found OR (value is NaN AND other is NaN)\n    /*eslint \"no-self-compare\": 0*/\n    if (other === value || (value !== value && other !== other)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n* Sets the Array.contains polyfill if it does not exist.\n* @param {!Window} win\n*/\nexport function install(win) {\n  if (!win.Array.prototype.includes) {\n    win.Object.defineProperty(Array.prototype, 'includes', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: includes,\n    });\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @typedef {{\n *   promise: !Promise<undefined>,\n *   resolve: function(),\n * }}\n */\nlet DeferredDef;\n\n/**\n * @typedef {!Function}\n */\nlet CustomElementConstructorDef;\n\n/**\n * @typedef {{\n *  name: string,\n *  ctor: !CustomElementConstructorDef,\n * }}\n */\nlet CustomElementDef;\n\n/**\n * Validates the custom element's name.\n * This intentionally ignores \"valid\" higher Unicode Code Points.\n * https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name\n */\nconst VALID_NAME = /^[a-z][a-z0-9._]*-[a-z0-9._-]*$/;\nconst INVALID_NAMES = [\n  'annotation-xml',\n  'color-profile',\n  'font-face',\n  'font-face-src',\n  'font-face-uri',\n  'font-face-format',\n  'font-face-name',\n  'missing-glyph',\n];\n\n/**\n * Asserts that the custom element name conforms to the spec.\n *\n * @param {!Function} SyntaxError\n * @param {string} name\n */\nfunction assertValidName(SyntaxError, name) {\n  if (!VALID_NAME.test(name) || INVALID_NAMES.indexOf(name) >= 0) {\n    throw new SyntaxError(`invalid custom element name \"${name}\"`);\n  }\n}\n\n/**\n * Does win have a full Custom Elements registry?\n *\n * @param {!Window} win\n * @return {boolean}\n */\nfunction hasCustomElements(win) {\n  const {customElements} = win;\n\n  return !!(\n    customElements &&\n    customElements.define &&\n    customElements.get &&\n    customElements.whenDefined);\n}\n\n/**\n * Was HTMLElement already patched for this window?\n *\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isPatched(win) {\n  const tag = win.HTMLElement.toString();\n  return tag.indexOf('[native code]') === -1;\n}\n\n/**\n * The public Custom Elements API.\n */\nclass CustomElementRegistry {\n  /**\n   * @param {!Window} win\n   * @param {!Registry} registry\n   */\n  constructor(win, registry) {\n    /**\n     * @const @private\n     */\n    this.win_ = win;\n\n    /**\n     * @const @private\n     */\n    this.registry_ = registry;\n\n    /**\n     * @type {!Object<string, DeferredDef>}\n     * @private\n     * @const\n     */\n    this.pendingDefines_ = this.win_.Object.create(null);\n  }\n\n  /**\n   * Register the custom element.\n   *\n   * @param {string} name\n   * @param {!CustomElementConstructorDef} ctor\n   * @param {!Object=} options\n   */\n  define(name, ctor, options) {\n    this.registry_.define(name, ctor, options);\n\n    // If anyone is waiting for this custom element to be defined, resolve\n    // their promise.\n    const pending = this.pendingDefines_;\n    const deferred = pending[name];\n    if (deferred) {\n      deferred.resolve();\n      delete pending[name];\n    }\n  }\n\n  /**\n   * Get the constructor of the (already defined) custom element.\n   *\n   * @param {string} name\n   * @return {!CustomElementConstructorDef|undefined}\n   */\n  get(name) {\n    const def = this.registry_.getByName(name);\n    if (def) {\n      return def.ctor;\n    }\n  }\n\n  /**\n   * Returns a promise that waits until the custom element is defined.\n   * If the custom element is already defined, returns a resolved promise.\n   *\n   * @param {string} name\n   * @return {!Promise<undefined>}\n   */\n  whenDefined(name) {\n    const {Promise, SyntaxError} = this.win_;\n    assertValidName(SyntaxError, name);\n\n    if (this.registry_.getByName(name)) {\n      return Promise.resolve();\n    }\n\n    const pending = this.pendingDefines_;\n    const deferred = pending[name];\n    if (deferred) {\n      return deferred.promise;\n    }\n\n    let resolve;\n    const promise = new /*OK*/Promise(res => resolve = res);\n    pending[name] = {\n      promise,\n      resolve,\n    };\n\n    return promise;\n  }\n\n  /**\n   * Upgrade all custom elements inside root.\n   *\n   * @param {!Node} root\n   */\n  upgrade(root) {\n    this.registry_.upgrade(root);\n  }\n}\n\n/**\n * This internal APIs necessary to run the CustomElementRegistry.\n * Since Registry is never exposed externally, all methods are actually\n * available on the instance.\n */\nclass Registry {\n  /**\n   * @param {!Window} win\n   */\n  constructor(win) {\n    /**\n     * @private @const\n     */\n    this.win_ = win;\n\n    /**\n     * @private @const\n     */\n    this.doc_ = win.document;\n\n    /**\n     * @type {!Object<string, !CustomElementDef>}\n     * @private\n     * @const\n     */\n    this.definitions_ = win.Object.create(null);\n\n    /**\n     * A up-to-date DOM selector for all custom elements.\n     * @type {string}\n     */\n    this.query_ = '';\n\n    /**\n     * The currently upgrading element.\n     * @private {Element}\n     */\n    this.current_ = null;\n  }\n\n  /**\n   * The currently-being-upgraded custom element.\n   *\n   * When an already created (through the DOM parsing APIs, or innerHTML)\n   * custom element node is being upgraded, we can't just create a new node\n   * (it's illegal in the spec). But we still need to run the custom element's\n   * constructor code on the node. We avoid this conundrum by running the\n   * constructor while returning this current node in the HTMLElement\n   * class constructor (the base class of all custom elements).\n   *\n   * @return {Element}\n   */\n  current() {\n    const current = this.current_;\n    this.current_ = null;\n    return current;\n  }\n\n  /**\n   * Finds the custom element definition by name.\n   *\n   * @param {string} name\n   * @return {CustomElementDef|undefined}\n   */\n  getByName(name) {\n    const definition = this.definitions_[name];\n    if (definition) {\n      return definition;\n    }\n  }\n\n  /**\n   * Finds the custom element definition by constructor instance.\n   *\n   * @param {CustomElementConstructorDef} ctor\n   * @return {CustomElementDef|undefined}\n   */\n  getByConstructor(ctor) {\n    const definitions = this.definitions_;\n\n    for (const name in definitions) {\n      const def = definitions[name];\n      if (def.ctor === ctor) {\n        return def;\n      }\n    }\n  }\n\n  /**\n   * Registers the custom element definition, and upgrades all elements by that\n   * name in the root document.\n   *\n   * @param {string} name\n   * @param {!CustomElementConstructorDef} ctor\n   * @param {!Object|undefined} options\n   */\n  define(name, ctor, options) {\n    const {Error, SyntaxError} = this.win_;\n\n    if (options) {\n      throw new Error('Extending native custom elements is not supported');\n    }\n\n    assertValidName(SyntaxError, name);\n\n    if (this.getByName(name) ||\n        this.getByConstructor(ctor)) {\n      throw new Error(`duplicate definition \"${name}\"`);\n    }\n\n    // TODO(jridgewell): Record connectedCallback, disconnectedCallback,\n    // adoptedCallback, attributeChangedCallback, and observedAttributes.\n    // TODO(jridgewell): If attributeChangedCallback, gather observedAttributes\n    this.definitions_[name] = {\n      name,\n      ctor,\n    };\n\n    this.observe_(name);\n    this.upgrade(this.doc_, name);\n  }\n\n  /**\n   * Upgrades custom elements descendants of root (but not including root).\n   *\n   * When called with an opt_query, it both upgrades and connects the custom\n   * elements (this is used during the custom element define algorithm).\n   *\n   * @param {!Node} root\n   * @param {string=} opt_query\n   */\n  upgrade(root, opt_query) {\n    // Only CustomElementRegistry.p.define provides a query (the newly defined\n    // custom element). In this case, we are both upgrading _and_ connecting\n    // the custom elements.\n    const newlyDefined = !!opt_query;\n    const query = opt_query || this.query_;\n    const upgradeCandidates = this.queryAll_(root, query);\n\n    for (let i = 0; i < upgradeCandidates.length; i++) {\n      const candidate = upgradeCandidates[i];\n      if (newlyDefined) {\n        this.connectedCallback_(candidate);\n      } else {\n        this.upgradeSelf(candidate);\n      }\n    }\n  }\n\n  /**\n   * Upgrades the custom element node, if a custom element has been registered\n   * by this name.\n   *\n   * @param {!Node} node\n   */\n  upgradeSelf(node) {\n    const def = this.getByName(node.localName);\n    if (!def) {\n      return;\n    }\n\n    this.upgradeSelf_(/** @type {!Element} */(node), def);\n  }\n\n  /**\n   * @param {!Node} root\n   * @param {string} query\n   * @return {!Array|!NodeList}\n   */\n  queryAll_(root, query) {\n    if (!query || !root.querySelectorAll) {\n      // Nothing to do...\n      return [];\n    }\n\n    return root.querySelectorAll(query);\n  }\n\n  /**\n   * Upgrades the (already created via DOM parsing) custom element.\n   *\n   * @param {!Element} node\n   * @param {!CustomElementDef} def\n   */\n  upgradeSelf_(node, def) {\n    const {ctor} = def;\n    if (node instanceof ctor) {\n      return;\n    }\n\n    // Despite how it looks, this is not a useless construction.\n    // HTMLElementPolyfill (the base class of all custom elements) will return\n    // the current node, allowing the custom element's subclass constructor to\n    // run on the node. The node itself is already constructed, so the return\n    // value is just the node.\n    this.current_ = node;\n    const el = new ctor();\n\n    if (el !== node) {\n      throw new this.win_.Error(\n          'Constructor illegally returned a different instance.');\n    }\n  }\n\n  /**\n   * Fires connectedCallback on the custom element, if it has one.\n   * This also upgrades the custom element, since it may not have been\n   * accessible via the root document before (a detached DOM tree).\n   *\n   * @param {!Node} node\n   */\n  connectedCallback_(node) {\n    const def = this.getByName(node.localName);\n    if (!def) {\n      return;\n    }\n    this.upgradeSelf_(/** @type {!Element} */(node), def);\n    // TODO(jridgewell): It may be appropriate to adoptCallback, if the node\n    // used to be in another doc.\n    // TODO(jridgewell): I should be calling the definitions connectedCallback\n    // with node as the context.\n    if (node.connectedCallback) {\n      node.connectedCallback();\n    }\n  }\n\n  /**\n   * Fires disconnectedCallback on the custom element, if it has one.\n   *\n   * @param {!Node} node\n   */\n  disconnectedCallback_(node) {\n    // TODO(jridgewell): I should be calling the definitions connectedCallback\n    // with node as the context.\n    if (node.disconnectedCallback) {\n      node.disconnectedCallback();\n    }\n  }\n\n  /**\n   * Records name as a registered custom element to observe.\n   *\n   * Starts the Mutation Observer if this is the first registered custom\n   * element. This is deferred until the first custom element is defined to\n   * speed up initial rendering of the page.\n   *\n   * Mutation Observers are conveniently available in every browser we care\n   * about. When a node is connected to the root document, all custom\n   * elements (including that node iteself) will be upgraded and call\n   * connectedCallback. When a node is disconnectedCallback from the root\n   * document, all custom elements will call disconnectedCallback.\n   *\n   * @param {string} name\n   */\n  observe_(name) {\n    if (this.query_) {\n      this.query_ += `,${name}`;\n      return;\n    }\n\n    this.query_ = name;\n\n    // The first registered name starts the mutation observer.\n    const observer = new this.win_.MutationObserver(records => {\n      if (records) {\n        this.handleRecords_(records);\n      }\n    });\n    observer.observe(this.doc_, {\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  /**\n   * Handle all the Mutation Observer's Mutation Records.\n   * All added custom elements will be upgraded (if not already) and call\n   * connectedCallback. All removed custom elements will call\n   * disconnectedCallback.\n   *\n   * @param {!Array<!MutationRecord>} records\n   */\n  handleRecords_(records) {\n    for (let i = 0; i < records.length; i++) {\n      const record = records[i];\n      if (!record) {\n        continue;\n      }\n\n      const {addedNodes, removedNodes} = record;\n      for (let i = 0; i < addedNodes.length; i++) {\n        const node = addedNodes[i];\n        const connectedCandidates = this.queryAll_(node, this.query_);\n        this.connectedCallback_(node);\n        for (let i = 0; i < connectedCandidates.length; i++) {\n          this.connectedCallback_(connectedCandidates[i]);\n        }\n      }\n\n      for (let i = 0; i < removedNodes.length; i++) {\n        const node = removedNodes[i];\n        const disconnectedCandidates = this.queryAll_(node, this.query_);\n        this.disconnectedCallback_(node);\n        for (let i = 0; i < disconnectedCandidates.length; i++) {\n          this.disconnectedCallback_(disconnectedCandidates[i]);\n        }\n      }\n    }\n  }\n}\n\n/**\n * Does the polyfilling.\n * @param {!Window} win\n */\nfunction polyfill(win) {\n  const {HTMLElement, Element, Node, Document, Object, document} = win;\n  const {createElement, cloneNode, importNode} = document;\n\n  const registry = new Registry(win);\n  const customElements = new CustomElementRegistry(win, registry);\n\n  // Expose the custom element registry.\n  // Object.getOwnPropertyDescriptor(window, 'customElements')\n  // {get: , set: undefined, enumerable: true, configurable: true}\n  Object.defineProperty(win, 'customElements', {\n    enumerable: true,\n    configurable: true,\n    // writable: false,\n    value: customElements,\n  });\n\n  // Patch createElement to immediately upgrade the custom element.\n  // This has the added benefit that it avoids the \"already created but needs\n  // constructor code run\" chicken-and-egg problem.\n  Document.prototype.createElement = function createElementPolyfill(name) {\n    const def = registry.getByName(name);\n    if (def) {\n      return new def.ctor();\n    }\n    return createElement.apply(this, arguments);\n  };\n\n  // Patch importNode to immediately upgrade custom elements.\n  // TODO(jridgewell): Can fire adoptedCallback for cross doc imports.\n  Document.prototype.importNode = function importNodePolyfill() {\n    const imported = importNode.apply(this, arguments);\n    if (imported) {\n      registry.upgradeSelf(imported);\n      registry.upgrade(imported);\n    }\n    return imported;\n  };\n\n  // Patch cloneNode to immediately upgrade custom elements.\n  Node.prototype.cloneNode = function cloneNodePolyfill() {\n    const cloned = cloneNode.apply(this, arguments);\n    registry.upgradeSelf(cloned);\n    registry.upgrade(cloned);\n    return cloned;\n  };\n\n  // Patch the innerHTML setter to immediately upgrade custom elements.\n  // Note, this could technically fire connectedCallbacks if this node was\n  // connected, but we leave that to the Mutation Observer.\n  const innerHTMLDesc = Object.getOwnPropertyDescriptor(Element.prototype,\n      'innerHTML');\n  const innerHTMLSetter = innerHTMLDesc.set;\n  innerHTMLDesc.set = function(html) {\n    innerHTMLSetter.call(this, html);\n    registry.upgrade(this);\n  };\n  Object.defineProperty(Element.prototype, 'innerHTML', innerHTMLDesc);\n\n  /**\n   * You can't use the real HTMLElement constructor, because you can't subclass\n   * it without using native classes. So, mock its approximation using\n   * createElement.\n   */\n  function HTMLElementPolyfill() {\n    const {constructor} = this;\n\n    // If we're upgrading an already created custom element, we can't create\n    // another new node (by the spec, it must be the same node).\n    let el = registry.current();\n\n    // If there's not a already created custom element, we're being invoked via\n    // `new`ing the constructor.\n    //\n    // Technically, we could get here via createElement, but we patched that.\n    // If it the custom element was registered, the patch turned it into a\n    // `new` call.\n    // If it was not registered, the native createElement is used. And if\n    // native createElement is being used and we got to this code, we're really\n    // in an infinite loop (a native createElement call just below) so we've\n    // got bigger problems.\n    //\n    // So just take my word we got here via `new`.\n    if (!el) {\n      // The custom element definition is an invariant. If the custom element\n      // is registered, everything works. If it's not, it throws in the member\n      // property access (only defined custom elements can be directly\n      // constructed via `new`).\n      const def = registry.getByConstructor(constructor);\n      el = createElement.call(document, def.name);\n    }\n\n    // Finally, if the node was already constructed, we need to reset it's\n    // prototype to the custom element prototype. And if it wasn't already\n    // constructed, we created a new node via native createElement, and we need\n    // to reset it's prototype. Basically always reset the prototype.\n    Object.setPrototypeOf(el, constructor.prototype);\n    return el;\n  }\n  subClass(Object, HTMLElement, HTMLElementPolyfill);\n\n  // Expose the polyfilled HTMLElement constructor for everyone to extend from.\n  win.HTMLElement = HTMLElementPolyfill;\n}\n\n/**\n * Wraps HTMLElement in a Reflect.construct constructor, so that transpiled\n * classes can `_this = superClass.call(this)` during their construction.\n *\n * This is only used when Custom Elements v1 is already available _and_ we're\n * using transpiled classes (which use ES5 construction idioms).\n *\n * @param {!Window} win\n */\nfunction wrapHTMLElement(win) {\n  const {HTMLElement, Reflect, Object} = win;\n  /**\n   */\n  function HTMLElementWrapper() {\n    const ctor = /** @type {function(...?):?|undefined} */(\n      /** @type {!HTMLElement} */(this).constructor);\n\n    // Reflect.construct allows us to construct a new HTMLElement without using\n    // `new` (which will always fail because native HTMLElement is a restricted\n    // constructor).\n    return Reflect.construct(HTMLElement, [], ctor);\n  }\n  subClass(Object, HTMLElement, HTMLElementWrapper);\n\n  // Expose the wrapped HTMLElement constructor for everyone to extend from.\n  win.HTMLElement = HTMLElementWrapper;\n}\n\n/**\n * Setups up prototype inheritance\n *\n * @param {!Object} Object\n * @param {!Function} superClass\n * @param {!Function} subClass\n */\nfunction subClass(Object, superClass, subClass) {\n  // Object.getOwnPropertyDescriptor(superClass.prototype, 'constructor')\n  // {value: , writable: true, enumerable: false, configurable: true}\n  subClass.prototype = Object.create(superClass.prototype, {\n    constructor: {\n      // enumerable: false,\n      configurable: true,\n      writable: true,\n      value: subClass,\n    },\n  });\n}\n\n/**\n * Polyfills Custom Elements v1 API. This has 4 modes:\n *\n * 1. Custom elements v1 already supported, using native classes\n * 2. Custom elements v1 already supported, using transpiled classes\n * 3. Custom elements v1 not supported, using native classes\n * 4. Custom elements v1 not supported, using transpiled classes\n *\n * In mode 1, nothing is done. In mode 2, a minimal polyfill is used to support\n * extending the HTMLElement base class. In mode 3 and 4, a full polyfill is\n * done.\n *\n * @param {!Window} win\n * @param {!Function} ctor\n */\nexport function install(win, ctor) {\n  if (isPatched(win)) {\n    return;\n  }\n\n  let install = true;\n  let installWrapper = false;\n\n  if (hasCustomElements(win)) {\n    // If ctor is constructable without new, it's a function. That means it was\n    // compiled down, and we need to do the minimal polyfill because all you\n    // cannot extend HTMLElement without native classes.\n    try {\n      const {Object, Reflect} = win;\n\n      // \"Construct\" ctor using ES5 idioms\n      const instance = Object.create(ctor.prototype);\n      ctor.call(instance);\n\n      // If that succeeded, we're in a transpiled environment\n      // Let's find out if we can wrap HTMLElement and avoid a full patch.\n      installWrapper = !!(Reflect && Reflect.construct);\n    } catch (e) {\n\n      // The ctor threw when we constructed is via ES5, so it's a real class.\n      // We're ok to not install the polyfill.\n      install = false;\n    }\n  }\n\n  if (installWrapper) {\n    wrapHTMLElement(win);\n  } else if (install) {\n    polyfill(win);\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Polyfill for `document.contains()` method. Notice that according to spec\n * `document.contains` is inclusionary.\n * See https://developer.mozilla.org/en-US/docs/Web/API/Node/contains\n * @param {?Node} node\n * @return {boolean}\n * @this {Node}\n */\nfunction documentContainsPolyfill(node) {\n  // Per spec, \"contains\" method is inclusionary\n  // i.e. `node.contains(node) == true`. However, we still need to test\n  // equality to the document itself.\n  return node == this || this.documentElement.contains(node);\n}\n\n\n/**\n * Polyfills `HTMLDocument.contains` API.\n * @param {!Window} win\n */\nexport function install(win) {\n  // HTMLDocument is undefined in Internet Explorer 10, but it has Document,\n  // so we use that as a fallback.\n  const documentClass = win.HTMLDocument || win.Document;\n  if (!documentClass.prototype.contains) {\n    win.Object.defineProperty(documentClass.prototype, 'contains', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: documentContainsPolyfill,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Polyfill for `DOMTokenList.prototype.toggle(token, opt_force)` method. This\n * is specially important because IE does not support `opt_force` attribute. See\n * https://goo.gl/hgKNYY for details.\n * @param {string} token\n * @param {boolean=} opt_force\n * @this {DOMTokenList}\n * @return {boolean}\n */\nfunction domTokenListTogglePolyfill(token, opt_force) {\n  const remove = opt_force === undefined ? this.contains(token) : !opt_force;\n  if (remove) {\n    this.remove(token);\n    return false;\n  } else {\n    this.add(token);\n    return true;\n  }\n}\n\n\n/**\n * Polyfills `DOMTokenList.prototype.toggle` API in IE.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (isIe(win) && win.DOMTokenList) {\n    win.Object.defineProperty(win.DOMTokenList.prototype, 'toggle', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: domTokenListTogglePolyfill,\n    });\n  }\n}\n\n\n/**\n * Whether the current browser is a IE browser.\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isIe(win) {\n  return /Trident|MSIE|IEMobile/i.test(win.navigator.userAgent);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Parses the number x and returns its sign. For positive x returns 1, for\n * negative, -1. For 0 and -0, returns 0 and -0 respectively. For any number\n * that parses to NaN, returns NaN.\n *\n * @param {number} x\n * @return {number}\n */\nexport function sign(x) {\n  x = Number(x);\n\n  // If x is 0, -0, or NaN, return it.\n  if (!x) {\n    return x;\n  }\n\n  return x > 0 ? 1 : -1;\n}\n\n\n/**\n * Sets the Math.sign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Math.sign) {\n    win.Object.defineProperty(win.Math, 'sign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: sign,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst {hasOwnProperty} = Object.prototype;\n\n/**\n * Copies values of all enumerable own properties from one or more source\n * objects (provided as extended arguments to the function) to a target object.\n *\n * @param {!Object} target\n * @param {...Object} var_args\n * @return {!Object}\n */\nexport function assign(target, var_args) {\n  if (target == null) {\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  const output = Object(target);\n  for (let i = 1; i < arguments.length; i++) {\n    const source = arguments[i];\n    if (source != null) {\n      for (const key in source) {\n        if (hasOwnProperty.call(source, key)) {\n          output[key] = source[key];\n        }\n      }\n    }\n  }\n  return output;\n}\n\n\n/**\n * Sets the Object.assign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Object.assign) {\n    win.Object.defineProperty(win.Object, 'assign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: assign,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nimport * as Promise from 'promise-pjs/promise';\n\n/**\n * Sets the Promise polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Promise) {\n    win.Promise = /** @type {?} */ (Promise);\n    // In babel the * export is an Object with a default property.\n    // In closure compiler it is the Promise function itself.\n    if (Promise.default) {\n      win.Promise = Promise.default;\n    }\n    // We copy the individual static methods, because closure\n    // compiler flattens the polyfill namespace.\n    win.Promise.resolve = Promise.resolve;\n    win.Promise.reject = Promise.reject;\n    win.Promise.all = Promise.all;\n    win.Promise.race = Promise.race;\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from './services';\nimport {dev} from './log';\nimport {getServicePromise} from './service';\n\n/**\n * A map of services that delay rendering. The key is the name of the service\n * and the value is a DOM query which is used to check if the service is needed\n * in the current document.\n * Do not add a service unless absolutely necessary.\n *\n * \\   \\  /  \\  /   / /   \\     |   _  \\     |  \\ |  | |  | |  \\ |  |  / _____|\n *  \\   \\/    \\/   / /  ^  \\    |  |_)  |    |   \\|  | |  | |   \\|  | |  |  __\n *   \\            / /  /_\\  \\   |      /     |  . `  | |  | |  . `  | |  | |_ |\n *    \\    /\\    / /  _____  \\  |  |\\  \\----.|  |\\   | |  | |  |\\   | |  |__| |\n *     \\__/  \\__/ /__/     \\__\\ | _| `._____||__| \\__| |__| |__| \\__|  \\______|\n *\n * The equivalent of this list is used for server-side rendering (SSR) and any\n * changes made to it must be made in coordination with caches that implement\n * SSR. For more information on SSR see bit.ly/amp-ssr.\n *\n * @const {!Object<string, string>}\n */\nconst SERVICES = {\n  'amp-dynamic-css-classes': '[custom-element=amp-dynamic-css-classes]',\n  'variant': 'amp-experiment',\n  'amp-story': 'amp-story[standalone]',\n};\n\n/**\n * Maximum milliseconds to wait for all extensions to load before erroring.\n * @const\n */\nconst LOAD_TIMEOUT = 3000;\n\n/**\n * Detects any render delaying services that are required on the page, and\n * returns a promise with a timeout.\n * @param {!Window} win\n * @return {!Promise<!Array<*>>} resolves to an Array that has the same length\n *     as the detected render delaying services\n */\nexport function waitForServices(win) {\n  const promises = includedServices(win).map(service => {\n    return Services.timerFor(win).timeoutPromise(\n        LOAD_TIMEOUT,\n        getServicePromise(win, service),\n        `Render timeout waiting for service ${service} to be ready.`\n    );\n  });\n  return Promise.all(promises);\n}\n\n/**\n * Returns true if the page has a render delaying service.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function hasRenderDelayingServices(win) {\n  return includedServices(win).length > 0;\n}\n\n/**\n * Detects which, if any, render-delaying extensions are included on the page.\n * @param {!Window} win\n * @return {!Array<string>}\n */\nexport function includedServices(win) {\n  /** @const {!Document} */\n  const doc = win.document;\n  dev().assert(doc.body);\n\n  return Object.keys(SERVICES).filter(service => {\n    return doc.querySelector(SERVICES[service]);\n  });\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Registration and getter functions for AMP services.\n *\n * Invariant: Service getters never return null for registered services.\n */\n\n// src/polyfills.js must be the first import.\nimport './polyfills'; // eslint-disable-line sort-imports-es6-autofix/sort-imports-es6\n\nimport {Deferred} from './utils/promise';\nimport {dev} from './log';\nimport {toWin} from './types';\n\n\n/**\n * Holds info about a service.\n * - obj: Actual service implementation when available.\n * - promise: Promise for the obj.\n * - resolve: Function to resolve the promise with the object.\n * - context: Argument for ctor, either a window or an ampdoc.\n * - ctor: Function that constructs and returns the service.\n * @typedef {{\n *   obj: (?Object),\n *   promise: (?Promise),\n *   resolve: (?function(!Object)),\n *   context: (?Window|?./service/ampdoc-impl.AmpDoc),\n *   ctor: (?function(new:Object, !Window)|\n *          ?function(new:Object, !./service/ampdoc-impl.AmpDoc)),\n * }}\n */\nlet ServiceHolderDef;\n\n\n/**\n * This interface provides a `dispose` method that will be called by\n * runtime when a service needs to be disposed of.\n * @interface\n */\nexport class Disposable {\n\n  /**\n   * Instructs the service to release any resources it might be holding. Can\n   * be called only once in the lifecycle of a service.\n   */\n  dispose() {}\n}\n\n\n/**\n * This interface provides a `adoptEmbedWindow` method that will be called by\n * runtime for a new embed window.\n * @interface\n */\nexport class EmbeddableService {\n\n  /**\n   * Instructs the service to adopt the embed window and add any necessary\n   * listeners and resources.\n   * @param {!Window} unusedEmbedWin\n   */\n  adoptEmbedWindow(unusedEmbedWin) {}\n}\n\n\n/**\n * Returns a service with the given id. Assumes that it has been registered\n * already.\n * @param {!Window} win\n * @param {string} id\n * @param {boolean=} opt_fallbackToTopWin\n * @return {Object} The service.\n */\nexport function getExistingServiceInEmbedScope(win, id, opt_fallbackToTopWin) {\n  // First, try to resolve via local (embed) window.\n  const local = getLocalExistingServiceForEmbedWinOrNull(win, id);\n  if (local) {\n    return local;\n  }\n  if (opt_fallbackToTopWin) {\n    return getService(win, id);\n  }\n  return null;\n}\n\n/**\n * Returns a service with the given id. Assumes that it has been constructed\n * already.\n *\n * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n * services since sometimes we only have the FIE Document for context.\n *\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id\n * @param {boolean=} opt_fallbackToTopWin\n * @return {Object} The service.\n */\nexport function getExistingServiceForDocInEmbedScope(\n  nodeOrDoc, id, opt_fallbackToTopWin) {\n  // First, try to resolve via local (embed) window.\n  if (nodeOrDoc.nodeType) {\n    // If a node is passed, try to resolve via this node.\n    const win = toWin(/** @type {!Document} */ (\n      nodeOrDoc.ownerDocument || nodeOrDoc).defaultView);\n    const local = getLocalExistingServiceForEmbedWinOrNull(win, id);\n    if (local) {\n      return local;\n    }\n  }\n  // If an ampdoc is passed or fallback is allowed, continue resolving.\n  if (!nodeOrDoc.nodeType || opt_fallbackToTopWin) {\n    return getServiceForDocDeprecated(nodeOrDoc, id);\n  }\n  return null;\n}\n\n/**\n * Installs a service override on amp-doc level.\n * @param {!Window} embedWin\n * @param {string} id\n * @param {!Object} service The service.\n */\nexport function installServiceInEmbedScope(embedWin, id, service) {\n  const topWin = getTopWindow(embedWin);\n  dev().assert(embedWin != topWin,\n      'Service override can only be installed in embed window: %s', id);\n  dev().assert(!getLocalExistingServiceForEmbedWinOrNull(embedWin, id),\n      'Service override has already been installed: %s', id);\n  registerServiceInternal(embedWin, embedWin, id, () => service);\n  getServiceInternal(embedWin, id); // Force service to build.\n}\n\n/**\n * @param {!Window} embedWin\n * @param {string} id\n * @return {?Object}\n */\nfunction getLocalExistingServiceForEmbedWinOrNull(embedWin, id) {\n  // Note that this method currently only resolves against the given window.\n  // It does not try to go all the way up the parent window chain. We can change\n  // this in the future, but for now this gives us a better performance.\n  const topWin = getTopWindow(embedWin);\n  if (embedWin != topWin && isServiceRegistered(embedWin, id)) {\n    return getServiceInternal(embedWin, id);\n  } else {\n    return null;\n  }\n}\n\n/**\n * Registers a service given a class to be used as implementation.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {function(new:Object, !Window)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilder(win,\n  id,\n  constructor,\n  opt_instantiate) {\n  win = getTopWindow(win);\n  registerServiceInternal(win, win, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(win, id);\n  }\n}\n\n\n/**\n * Returns a service and registers it given a class to be used as\n * implementation.\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id of the service.\n * @param {function(new:Object, !./service/ampdoc-impl.AmpDoc)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilderForDoc(nodeOrDoc,\n  id,\n  constructor,\n  opt_instantiate) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  registerServiceInternal(holder, ampdoc, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(holder, id);\n  }\n}\n\n\n/**\n * Returns a service for the given id and window (a per-window singleton). Users\n * should typically wrap this as a special purpose function (e.g.\n * `Services.vsyncFor(win)`) for type safety and because the factory should not\n * be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @template T\n * @return {T}\n */\nexport function getService(win, id) {\n  win = getTopWindow(win);\n  return getServiceInternal(win, id);\n}\n\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. `Services.vsyncFor(win)`) for type safety and because the\n * factory should not be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nexport function getServicePromise(win, id) {\n  return getServicePromiseInternal(win, id);\n}\n\n\n/**\n * Returns a service or null with the given id.\n * @param {!Window} win\n * @param {string} id\n * @return {?Object} The service.\n */\nexport function getExistingServiceOrNull(win, id) {\n  win = getTopWindow(win);\n  if (isServiceRegistered(win, id)) {\n    return getServiceInternal(win, id);\n  } else {\n    return null;\n  }\n}\n\n\n/**\n * Like getServicePromise but returns null if the service was never registered.\n * @param {!Window} win\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNull(win, id) {\n  return getServicePromiseOrNullInternal(win, id);\n}\n\n\n/**\n * Returns a service for the given id and ampdoc (a per-ampdoc singleton).\n * Expects service `id` to be registered.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {T}\n * @template T\n */\nexport function getServiceForDoc(elementOrAmpDoc, id) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  return getServiceInternal(holder, id);\n}\n\n\n/**\n * tl;dr -- Use getServiceForDoc() instead of this.\n *\n * Privileged variant of getServiceForDoc() that accepts non-element params,\n * e.g. window.document. This is currently necessary for doc-level services\n * used in startup, e.g. Chunks. Eventually we want to remove this function\n * and have callers find the appropriate AmpDoc and use getServiceForDoc().\n *\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id\n * @return {T}\n * @template T\n */\nexport function getServiceForDocDeprecated(nodeOrDoc, id) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  return getServiceInternal(holder, id);\n}\n\n\n/**\n * Returns a promise for a service for the given id and ampdoc. Also expects\n * a service that has the actual implementation. The promise resolves when\n * the implementation loaded.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {!Promise<!Object>}\n */\nexport function getServicePromiseForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseInternal(\n      getAmpdocServiceHolder(elementOrAmpDoc), id);\n}\n\n\n/**\n * Like getServicePromiseForDoc but returns null if the service was never\n * registered for this ampdoc.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNullForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseOrNullInternal(\n      getAmpdocServiceHolder(elementOrAmpDoc), id);\n}\n\n/**\n * Set the parent and top windows on a child window (friendly iframe).\n * @param {!Window} win\n * @param {!Window} parentWin\n */\nexport function setParentWindow(win, parentWin) {\n  win.__AMP_PARENT = parentWin;\n  win.__AMP_TOP = getTopWindow(parentWin);\n}\n\n\n/**\n * Returns the parent window for a child window (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getParentWindow(win) {\n  return win.__AMP_PARENT || win;\n}\n\n\n/**\n * Returns the top window where AMP Runtime is installed for a child window\n * (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getTopWindow(win) {\n  return win.__AMP_TOP || win;\n}\n\n\n/**\n * Returns the parent \"friendly\" iframe if the node belongs to a child window.\n * @param {!Node} node\n * @param {!Window} topWin\n * @return {?HTMLIFrameElement}\n */\nexport function getParentWindowFrameElement(node, topWin) {\n  const childWin = (node.ownerDocument || node).defaultView;\n  if (childWin && childWin != topWin && getTopWindow(childWin) == topWin) {\n    try {\n      return /** @type {?HTMLIFrameElement} */ (childWin.frameElement);\n    } catch (e) {\n      // Ignore the error.\n    }\n  }\n  return null;\n}\n\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc}\n */\nexport function getAmpdoc(nodeOrDoc) {\n  if (nodeOrDoc.nodeType) {\n    const win = toWin(/** @type {!Document} */ (\n      nodeOrDoc.ownerDocument || nodeOrDoc).defaultView);\n    return getAmpdocService(win).getAmpDoc(/** @type {!Node} */ (nodeOrDoc));\n  }\n  return /** @type {!./service/ampdoc-impl.AmpDoc} */ (nodeOrDoc);\n}\n\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc|!Window}\n */\nfunction getAmpdocServiceHolder(nodeOrDoc) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  return ampdoc.isSingleDoc() ? ampdoc.win : ampdoc;\n}\n\n\n/**\n * This is essentially a duplicate of `ampdoc.js`, but necessary to avoid\n * circular dependencies.\n * @param {!Window} win\n * @return {!./service/ampdoc-impl.AmpDocService}\n */\nfunction getAmpdocService(win) {\n  return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n    getService(win, 'ampdoc'));\n}\n\n\n/**\n * Get service `id` from `holder`. Assumes the service\n * has already been registered.\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {Object}\n * @template T\n */\nfunction getServiceInternal(holder, id) {\n  dev().assert(isServiceRegistered(holder, id),\n      `Expected service ${id} to be registered`);\n  const services = getServices(holder);\n  const s = services[id];\n  if (!s.obj) {\n    dev().assert(s.ctor, `Service ${id} registered without ctor nor impl.`);\n    dev().assert(s.context, `Service ${id} registered without context.`);\n    s.obj = new s.ctor(s.context);\n    dev().assert(s.obj, `Service ${id} constructed to null.`);\n    s.ctor = null;\n    s.context = null;\n    // The service may have been requested already, in which case we have a\n    // pending promise we need to fulfill.\n    if (s.resolve) {\n      s.resolve(s.obj);\n    }\n  }\n  return s.obj;\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {!Window|!./service/ampdoc-impl.AmpDoc} context Win or AmpDoc.\n * @param {string} id of the service.\n * @param {?function(new:Object, !Window)|?function(new:Object, !./service/ampdoc-impl.AmpDoc)} ctor Constructor function to new the service. Called with context.\n */\nfunction registerServiceInternal(holder, context, id, ctor) {\n  const services = getServices(holder);\n  let s = services[id];\n\n  if (!s) {\n    s = services[id] = {\n      obj: null,\n      promise: null,\n      resolve: null,\n      context: null,\n      ctor: null,\n    };\n  }\n\n  if (s.ctor || s.obj) {\n    // Service already registered.\n    return;\n  }\n\n  s.ctor = ctor;\n  s.context = context;\n\n  // The service may have been requested already, in which case there is a\n  // pending promise that needs to fulfilled.\n  if (s.resolve) {\n    // getServiceInternal will resolve the promise.\n    getServiceInternal(holder, id);\n  }\n}\n\n/**\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nfunction getServicePromiseInternal(holder, id) {\n  const cached = getServicePromiseOrNullInternal(holder, id);\n  if (cached) {\n    return cached;\n  }\n  // Service is not registered.\n\n  // TODO(@cramforce): Add a check that if the element is eventually registered\n  // that the service is actually provided and this promise resolves.\n  const deferred = new Deferred();\n  const {promise, resolve} = deferred;\n\n  const services = getServices(holder);\n  services[id] = {\n    obj: null,\n    promise,\n    resolve,\n    context: null,\n    ctor: null,\n  };\n  return promise;\n}\n\n\n/**\n * Returns a promise for service `id` if the service has been registered\n * on `holder`.\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {?Promise<!Object>}\n */\nfunction getServicePromiseOrNullInternal(holder, id) {\n  const services = getServices(holder);\n  const s = services[id];\n  if (s) {\n    if (s.promise) {\n      return s.promise;\n    } else {\n      // Instantiate service if not already instantiated.\n      getServiceInternal(holder, id);\n      return s.promise = Promise.resolve(/** @type {!Object} */ (s.obj));\n    }\n  }\n  return null;\n}\n\n\n/**\n * Returns the object that holds the services registered in a holder.\n * @param {!Object} holder\n * @return {!Object<string,!ServiceHolderDef>}\n */\nfunction getServices(holder) {\n  let {services} = holder;\n  if (!services) {\n    services = holder.services = {};\n  }\n  return services;\n}\n\n\n/**\n * Whether the specified service implements `Disposable` interface.\n * @param {!Object} service\n * @return {boolean}\n */\nexport function isDisposable(service) {\n  return typeof service.dispose == 'function';\n}\n\n\n/**\n * Asserts that the specified service implements `Disposable` interface and\n * typecasts the instance to `Disposable`.\n * @param {!Object} service\n * @return {!Disposable}\n */\nexport function assertDisposable(service) {\n  dev().assert(isDisposable(service), 'required to implement Disposable');\n  return /** @type {!Disposable} */ (service);\n}\n\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * ampdoc scope.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n */\nexport function disposeServicesForDoc(ampdoc) {\n  disposeServicesInternal(ampdoc);\n}\n\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * embed scope.\n * @param {!Window} embedWin\n */\nexport function disposeServicesForEmbed(embedWin) {\n  disposeServicesInternal(embedWin);\n}\n\n\n/**\n * @param {!Object} holder Object holding the service instances.\n */\nfunction disposeServicesInternal(holder) {\n  // TODO(dvoytenko): Consider marking holder as destroyed for later-arriving\n  // service to be canceled automatically.\n  const services = getServices(holder);\n  for (const id in services) {\n    if (!Object.prototype.hasOwnProperty.call(services, id)) {\n      continue;\n    }\n    const serviceHolder = services[id];\n    if (serviceHolder.obj) {\n      disposeServiceInternal(id, serviceHolder.obj);\n    } else if (serviceHolder.promise) {\n      serviceHolder.promise.then(\n          instance => disposeServiceInternal(id, instance));\n    }\n  }\n}\n\n\n/**\n * @param {string} id\n * @param {!Object} service\n */\nfunction disposeServiceInternal(id, service) {\n  if (!isDisposable(service)) {\n    return;\n  }\n  try {\n    assertDisposable(service).dispose();\n  } catch (e) {\n    // Ensure that a failure to dispose a service does not disrupt other\n    // services.\n    dev().error('SERVICE', 'failed to dispose service', id, e);\n  }\n}\n\n\n/**\n * Whether the specified service implements `EmbeddableService` interface.\n * @param {!Object} service\n * @return {boolean}\n */\nexport function isEmbeddable(service) {\n  return typeof service.adoptEmbedWindow == 'function';\n}\n\n\n/**\n * Adopts an embeddable (implements `EmbeddableService` interface) service\n * in embed scope.\n * @param {!Window} embedWin\n * @param {string} serviceId\n */\nexport function adoptServiceForEmbed(embedWin, serviceId) {\n  const adopted = adoptServiceForEmbedIfEmbeddable(embedWin, serviceId);\n  dev().assert(adopted, `Service ${serviceId} not found on parent ` +\n      'or doesn\\'t implement EmbeddableService.');\n}\n\n\n/**\n * Adopts an embeddable (implements `EmbeddableService` interface) service\n * in embed scope.\n * @param {!Window} embedWin\n * @param {string} serviceId\n * @return {boolean}\n */\nexport function adoptServiceForEmbedIfEmbeddable(embedWin, serviceId) {\n  const frameElement = /** @type {!Node} */ (dev().assert(\n      embedWin.frameElement,\n      'frameElement not found for embed'));\n  const ampdoc = getAmpdoc(frameElement);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  if (!isServiceRegistered(holder, serviceId)) {\n    return false;\n  }\n  const service = getServiceForDocDeprecated(frameElement, serviceId);\n  if (!isEmbeddable(service)) {\n    return false;\n  }\n  service.adoptEmbedWindow(embedWin);\n  return true;\n}\n\n\n/**\n * Resets a single service, so it gets recreated on next getService invocation.\n * @param {!Object} holder\n * @param {string} id of the service.\n */\nexport function resetServiceForTesting(holder, id) {\n  if (holder.services) {\n    holder.services[id] = null;\n  }\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {boolean}\n */\nfunction isServiceRegistered(holder, id) {\n  const service = holder.services && holder.services[id];\n  // All registered services must have an implementation or a constructor.\n  return !!(service && (service.ctor || service.obj));\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use baseInstance file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  PositionObserverFidelity, // eslint-disable-line no-unused-vars\n  PositionObserverWorker, // eslint-disable-line no-unused-vars\n} from './position-observer-worker';\nimport {Services} from '../../services';\nimport {debounce} from '../../utils/rate-limit';\nimport {dev} from '../../log';\nimport {registerServiceBuilderForDoc} from '../../service';\n\n/** @const @private */\nconst TAG = 'POSITION_OBSERVER';\n\n/** @const @private */\nconst SCROLL_TIMEOUT = 500;\n\n\nexport class PositionObserver {\n  /**\n   * @param {!../ampdoc-impl.AmpDoc} ampdoc\n   */\n  constructor(ampdoc) {\n    /** @private {!../ampdoc-impl.AmpDoc} */\n    this.ampdoc_ = ampdoc;\n\n    /** @private {!Window} */\n    this.win_ = ampdoc.win;\n\n    /** @private {!Array<!PositionObserverWorker>} */\n    this.workers_ = [];\n\n    /** @private {!../vsync-impl.Vsync} */\n    this.vsync_ = Services.vsyncFor(this.win_);\n\n    /** @private {!../viewport/viewport-impl.Viewport} */\n    this.viewport_ = Services.viewportForDoc(ampdoc);\n\n    /** @private {Array<function()>} */\n    this.unlisteners_ = [];\n\n    /** @private {boolean} */\n    this.inScroll_ = false;\n\n    /** @private {boolean} */\n    this.measure_ = false;\n\n    /** @private {boolean} */\n    this.callbackStarted_ = false;\n\n    /** @private {function()} */\n    this.boundStopScroll_ = debounce(this.win_, () => {\n      this.inScroll_ = false;\n    }, SCROLL_TIMEOUT);\n  }\n\n  /**\n   * @param {!Element} element\n   * @param {!PositionObserverFidelity} fidelity\n   * @param {function(?./position-observer-worker.PositionInViewportEntryDef)} handler\n   * @return {!UnlistenDef}\n   */\n  observe(element, fidelity, handler) {\n    const worker =\n        new PositionObserverWorker(this.ampdoc_, element, fidelity, handler);\n\n    this.workers_.push(worker);\n\n    if (!this.callbackStarted_) {\n      this.startCallback_();\n    }\n\n    worker.update();\n\n    return () => {\n      for (let i = 0; i < this.workers_.length; i++) {\n        if (this.workers_[i] == worker) {\n          this.removeWorker_(i);\n          return;\n        }\n      }\n    };\n  }\n\n  /**\n   * @param {!Element} element\n   */\n  unobserve(element) {\n    for (let i = 0; i < this.workers_.length; i++) {\n      if (this.workers_[i].element == element) {\n        this.removeWorker_(i);\n        return;\n      }\n    }\n    dev().error(TAG, 'cannot unobserve unobserved element');\n  }\n\n  /**\n   * @param {number} index\n   * @private\n   */\n  removeWorker_(index) {\n    this.workers_.splice(index, 1);\n    if (this.workers_.length == 0) {\n      this.stopCallback_();\n    }\n  }\n\n  /**\n   * Callback function that gets called when start to observe the first element.\n   * @private\n   */\n  startCallback_() {\n    this.callbackStarted_ = true;\n    // listen to viewport scroll event to help pass determine if need to\n    this.unlisteners_.push(this.viewport_.onScroll(() => {\n      this.onScrollHandler_();\n    }));\n    this.unlisteners_.push(this.viewport_.onResize(() => {\n      this.onResizeHandler_();\n    }));\n  }\n\n  /**\n   * Callback function that gets called when unobserve last observed element.\n   * @private\n   */\n  stopCallback_() {\n    this.callbackStarted_ = false;\n    while (this.unlisteners_.length) {\n      const unlisten = this.unlisteners_.pop();\n      unlisten();\n    }\n  }\n\n  /**\n   * This should always be called in vsync.\n   * @param {boolean=} opt_force\n   * @visibleForTesting\n  */\n  updateAllEntries(opt_force) {\n    for (let i = 0; i < this.workers_.length; i++) {\n      const worker = this.workers_[i];\n      worker.update(opt_force);\n    }\n  }\n\n  /**\n   * Handle viewport scroll event\n   * @private\n   */\n  onScrollHandler_() {\n    this.boundStopScroll_();\n    this.inScroll_ = true;\n    if (!this.measure_) {\n      this.schedulePass_();\n    }\n  }\n\n  /**\n   * Handle viewport resize event\n   * @private\n   */\n  onResizeHandler_() {\n    this.updateAllEntries(true);\n  }\n\n  /**\n   * Update all entries during scroll\n   * @private\n   */\n  schedulePass_() {\n    // TODO (@zhouyx, #9208):\n    // P1: account for effective fidelity using this.effectiveFidelity\n    // P2: do passes on onDomMutation (if available using MutationObserver\n    // mostly for in-a-box host, since most DOM mutations are constraint to the\n    // AMP elements).\n    this.updateAllEntries();\n    this.measure_ = true;\n    if (!this.inScroll_) {\n      // Stop measure if viewport is no longer scrolling\n      this.measure_ = false;\n      return;\n    }\n    this.vsync_.measure(() => {\n      this.schedulePass_();\n    });\n  }\n}\n\n/**\n * @param {!../ampdoc-impl.AmpDoc} ampdoc\n */\nexport function installPositionObserverServiceForDoc(ampdoc) {\n  registerServiceBuilderForDoc(ampdoc, 'position-observer', () => {\n    return new PositionObserver(ampdoc);\n  });\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use baseInstance file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from '../../services';\nimport {dev} from '../../log';\nimport {\n  layoutRectEquals,\n  layoutRectLtwh,\n  layoutRectsOverlap,\n  layoutRectsRelativePos,\n} from '../../layout-rect';\n\n/** @enum {number} */\nexport const PositionObserverFidelity = {\n  HIGH: 1,\n  LOW: 0,\n};\n\n/** @const @private */\nconst LOW_FIDELITY_FRAME_COUNT = 4;\n\n/**\n * TODO (@zhouyx): rename relativePos to relativePositions\n * The positionObserver returned position value which includes the position rect\n * relative to viewport. And viewport rect which always has top 0, left 0, and\n * viewport width and height.\n * @typedef {{\n *  positionRect: ?../../layout-rect.LayoutRectDef,\n *  viewportRect: !../../layout-rect.LayoutRectDef,\n *  relativePos: string,\n * }}\n */\nexport let PositionInViewportEntryDef;\n\nexport class PositionObserverWorker {\n  /**\n   * @param {!../ampdoc-impl.AmpDoc} ampdoc\n   * @param {!Element} element\n   * @param {!PositionObserverFidelity} fidelity\n   * @param {function(?PositionInViewportEntryDef)} handler\n   */\n  constructor(ampdoc, element, fidelity, handler) {\n    /** @const {!Element} */\n    this.element = element;\n\n    /** @const {function(?PositionInViewportEntryDef)} */\n    this.handler_ = handler;\n\n    /** @type {!PositionObserverFidelity} */\n    this.fidelity = fidelity;\n\n    /** @type {number} */\n    this.turn = (fidelity == PositionObserverFidelity.LOW) ?\n      Math.floor(Math.random() * LOW_FIDELITY_FRAME_COUNT) : 0;\n\n    /** @type {?PositionInViewportEntryDef} */\n    this.prevPosition_ = null;\n\n    /** @private {!../viewport/viewport-impl.Viewport} */\n    this.viewport_ = Services.viewportForDoc(ampdoc);\n  }\n\n  /**\n   * Call to trigger an entry handler\n   * @param {!PositionInViewportEntryDef} position\n   * @private\n   */\n  trigger_(position) {\n    const prevPos = this.prevPosition_;\n    if (prevPos\n        && layoutRectEquals(prevPos.positionRect, position.positionRect)\n        && layoutRectEquals(prevPos.viewportRect, position.viewportRect)) {\n      // position didn't change, do nothing.\n      return;\n    }\n\n    dev().assert(position.positionRect,\n        'PositionObserver should always trigger entry with clientRect');\n    const positionRect =\n    /** @type {!../../layout-rect.LayoutRectDef} */ (position.positionRect);\n    // Add the relative position of the element to its viewport\n    position.relativePos = layoutRectsRelativePos(positionRect,\n        position.viewportRect);\n\n    if (layoutRectsOverlap(positionRect, position.viewportRect)) {\n      // Update position\n      this.prevPosition_ = position;\n      // Only call handler if entry element overlap with viewport.\n      this.handler_(position);\n    } else if (this.prevPosition_) {\n      // Need to notify that element gets outside viewport\n      // NOTE: This is required for inabox position observer.\n      this.prevPosition_ = null;\n      position.positionRect = null;\n      this.handler_(position);\n    }\n  }\n\n  /**\n   * To update the position of entry element when it is ready.\n   * Called when updateAllEntries, or when first observe an element.\n   * @param {boolean=} opt_force\n   */\n  update(opt_force) {\n    if (!opt_force) {\n      if (this.turn != 0) {\n        this.turn--;\n        return;\n      }\n\n      if (this.fidelity == PositionObserverFidelity.LOW) {\n        this.turn = LOW_FIDELITY_FRAME_COUNT;\n      }\n    }\n\n    const viewportSize = this.viewport_.getSize();\n    const viewportBox =\n        layoutRectLtwh(0, 0, viewportSize.width, viewportSize.height);\n    this.viewport_.getClientRectAsync(this.element).then(elementBox => {\n      this.trigger_(\n      /** @type {./position-observer-worker.PositionInViewportEntryDef}*/ ({\n            positionRect: elementBox,\n            viewportRect: viewportBox,\n            relativePos: '',\n          }));\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ActionTrust} from '../action-constants';\nimport {\n  EMPTY_METADATA,\n  parseFavicon,\n  parseOgImage,\n  parseSchemaImage,\n  setMediaSession,\n} from '../mediasession-helper';\nimport {\n  MIN_VISIBILITY_RATIO_FOR_AUTOPLAY,\n  PlayingStates,\n  VideoAnalyticsEvents,\n  VideoAttributes,\n  VideoEvents,\n} from '../video-interface';\nimport {Services} from '../services';\nimport {VideoDocking} from './video/docking';\nimport {\n  VideoServiceInterface,\n  VideoServiceSignals,\n} from './video-service-interface';\nimport {\n  VideoServiceSync,\n  setVideoComponentClassname,\n} from './video-service-sync-impl';\nimport {VideoSessionManager} from './video-session-manager';\nimport {VideoUtils, getInternalVideoElementFor} from '../utils/video';\nimport {\n  createCustomEvent,\n  getData,\n  listen,\n  listenOncePromise,\n} from '../event-helper';\nimport {dev, user} from '../log';\nimport {dict, map} from '../utils/object';\nimport {getMode} from '../mode';\nimport {installAutoplayStylesForDoc} from './video/install-autoplay-styles';\nimport {isFiniteNumber} from '../types';\nimport {once} from '../utils/function';\nimport {registerServiceBuilderForDoc} from '../service';\nimport {removeElement} from '../dom';\nimport {renderIcon, renderInteractionOverlay} from './video/autoplay';\nimport {setStyle} from '../style';\nimport {startsWith} from '../string';\n\n\n/** @private @const {string} */\nconst TAG = 'video-manager';\n\n\n/**\n * @private {number} The minimum number of milliseconds to wait between each\n * video-seconds-played analytics event.\n */\nconst SECONDS_PLAYED_MIN_DELAY = 1000;\n\n\n/**\n * @param {!../video-interface.VideoOrBaseElementDef} video\n * @private\n */\nfunction userInteractedWith(video) {\n  video.signals().signal(VideoServiceSignals.USER_INTERACTED);\n}\n\n\n/**\n * VideoManager keeps track of all AMP video players that implement\n * the common Video API {@see ../video-interface.VideoInterface}.\n *\n * It is responsible for providing a unified user experience and analytics for\n * all videos within a document.\n *\n * @implements {VideoServiceInterface}\n */\nexport class VideoManager {\n\n  /**\n   * @param {!./ampdoc-impl.AmpDoc} ampdoc\n   */\n  constructor(ampdoc) {\n\n    /** @const {!./ampdoc-impl.AmpDoc}  */\n    this.ampdoc = ampdoc;\n\n    /** @const */\n    this.installAutoplayStyles = once(() =>\n      installAutoplayStylesForDoc(this.ampdoc));\n\n    /** @private {!../service/viewport/viewport-impl.Viewport} */\n    this.viewport_ = Services.viewportForDoc(this.ampdoc);\n\n    /** @private {?Array<!VideoEntry>} */\n    this.entries_ = null;\n\n    /** @private {boolean} */\n    this.scrollListenerInstalled_ = false;\n\n    /** @private @const */\n    this.timer_ = Services.timerFor(ampdoc.win);\n\n    /** @private @const */\n    this.actions_ = Services.actionServiceForDoc(ampdoc);\n\n    /** @private @const */\n    this.boundSecondsPlaying_ = () => this.secondsPlaying_();\n\n    /** @private @const {function():!AutoFullscreenManager} */\n    this.getAutoFullscreenManager_ =\n        once(() => new AutoFullscreenManager(this.ampdoc, this));\n\n    /** @private @const {function():!VideoDocking} */\n    this.getDocking_ = once(() => new VideoDocking(this.ampdoc, this));\n\n    // TODO(cvializ, #10599): It would be nice to only create the timer\n    // if video analytics are present, since the timer is not needed if\n    // video analytics are not present.\n    this.timer_.delay(this.boundSecondsPlaying_, SECONDS_PLAYED_MIN_DELAY);\n  }\n\n  /**\n   * Each second, trigger video-seconds-played for videos that are playing\n   * at trigger time.\n   * @private\n   */\n  secondsPlaying_() {\n    for (let i = 0; i < this.entries_.length; i++) {\n      const entry = this.entries_[i];\n      if (entry.getPlayingState() !== PlayingStates.PAUSED) {\n        analyticsEvent(entry, VideoAnalyticsEvents.SECONDS_PLAYED);\n        this.timeUpdateActionEvent_(entry);\n      }\n    }\n    this.timer_.delay(this.boundSecondsPlaying_, SECONDS_PLAYED_MIN_DELAY);\n  }\n\n  /**\n   * Triggers a LOW-TRUST timeupdate event consumable by AMP actions.\n   * Frequency of this event is controlled by SECONDS_PLAYED_MIN_DELAY and is\n   * every 1 second for now.\n   * @param {!VideoEntry} entry\n   * @private\n   */\n  timeUpdateActionEvent_(entry) {\n    const name = 'timeUpdate';\n    const currentTime = entry.video.getCurrentTime();\n    const duration = entry.video.getDuration();\n    if (isFiniteNumber(currentTime) &&\n        isFiniteNumber(duration) &&\n        duration > 0) {\n      const perc = currentTime / duration;\n      const event = createCustomEvent(this.ampdoc.win, `${TAG}.${name}`,\n          dict({'time': currentTime, 'percent': perc}));\n      this.actions_.trigger(entry.video.element, name, event, ActionTrust.LOW);\n    }\n  }\n\n  /** @override */\n  register(video) {\n    dev().assert(video);\n\n    this.registerCommonActions_(video);\n\n    if (!video.supportsPlatform()) {\n      return;\n    }\n\n    this.entries_ = this.entries_ || [];\n    const entry = new VideoEntry(this, video);\n    this.maybeInstallVisibilityObserver_(entry);\n    this.entries_.push(entry);\n\n    const {element} = entry.video;\n    element.dispatchCustomEvent(VideoEvents.REGISTERED);\n\n    setVideoComponentClassname(element);\n\n    // Unlike events, signals are permanent. We can wait for `REGISTERED` at any\n    // moment in the element's lifecycle and the promise will resolve\n    // appropriately each time.\n    const signals =\n        (/** @type {!../base-element.BaseElement} */ (video)).signals();\n\n    signals.signal(VideoEvents.REGISTERED);\n\n    // Add a class to element to indicate it implements the video interface.\n    element.classList.add('i-amphtml-video-interface');\n  }\n\n  /**\n   * Register common actions such as play, pause, etc... on the video element\n   * so they can be called using AMP Actions.\n   * For example: <button on=\"tap:myVideo.play\">\n   *\n   * @param {!../video-interface.VideoOrBaseElementDef} video\n   * @private\n   */\n  registerCommonActions_(video) {\n    // Only require ActionTrust.LOW for video actions to defer to platform\n    // specific handling (e.g. user gesture requirement for unmuted playback).\n    const trust = ActionTrust.LOW;\n\n    registerAction('play', () => video.play(/* isAutoplay */ false));\n    registerAction('pause', () => video.pause());\n    registerAction('mute', () => video.mute());\n    registerAction('unmute', () => video.unmute());\n    registerAction('fullscreen', () => video.fullscreenEnter());\n\n    /**\n     * @param {string} action\n     * @param {function()} fn\n     */\n    function registerAction(action, fn) {\n      video.registerAction(action, () => {\n        userInteractedWith(video);\n        fn();\n      }, trust);\n    }\n  }\n\n  /**\n   * Install the necessary listeners to be notified when a video becomes visible\n   * in the viewport.\n   *\n   * Visibility of a video is defined by being in the viewport AND having\n   * {@link MIN_VISIBILITY_RATIO_FOR_AUTOPLAY} of the video element visible.\n   *\n   * @param {VideoEntry} entry\n   * @private\n   */\n  maybeInstallVisibilityObserver_(entry) {\n    const {element} = entry.video;\n\n    listen(element, VideoEvents.VISIBILITY, details => {\n      const data = getData(details);\n      if (data && data['visible'] == true) {\n        entry.updateVisibility(/* opt_forceVisible */ true);\n      } else {\n        entry.updateVisibility();\n      }\n    });\n\n    listen(element, VideoEvents.RELOAD, () => {\n      entry.videoLoaded();\n    });\n\n    // TODO(aghassemi, #6425): Use IntersectionObserver\n    if (!this.scrollListenerInstalled_) {\n      const scrollListener = () => {\n        for (let i = 0; i < this.entries_.length; i++) {\n          this.entries_[i].updateVisibility();\n        }\n      };\n      this.viewport_.onScroll(scrollListener);\n      this.viewport_.onChanged(scrollListener);\n      this.scrollListenerInstalled_ = true;\n    }\n  }\n\n  /**\n   * Returns the entry in the video manager corresponding to the video\n   * provided\n   *\n   * @param {!../video-interface.VideoInterface} video\n   * @return {VideoEntry} entry\n   * @private\n   */\n  getEntryForVideo_(video) {\n    for (let i = 0; i < this.entries_.length; i++) {\n      if (this.entries_[i].video === video) {\n        return this.entries_[i];\n      }\n    }\n    dev().error(TAG, 'video is not registered to this video manager');\n    return null;\n  }\n\n  /**\n   * Returns the entry in the video manager corresponding to the element\n   * provided\n   *\n   * @param {!AmpElement} element\n   * @return {VideoEntry} entry\n   * @private\n   */\n  getEntryForElement_(element) {\n    for (let i = 0; i < this.entries_.length; i++) {\n      const entry = this.entries_[i];\n      if (entry.video.element === element) {\n        return entry;\n      }\n    }\n    dev().error(TAG, 'video is not registered to this video manager');\n    return null;\n  }\n\n  /** @override */\n  getAnalyticsDetails(videoElement) {\n    const entry = this.getEntryForElement_(videoElement);\n    return entry ? entry.getAnalyticsDetails() : Promise.resolve();\n  }\n\n  /**\n   * Returns whether the video is paused or playing after the user interacted\n   * with it or playing through autoplay\n   *\n   * @param {!../video-interface.VideoInterface} video\n   * @return {!../video-interface.VideoInterface} PlayingStates\n   */\n  getPlayingState(video) {\n    return this.getEntryForVideo_(video).getPlayingState();\n  }\n\n  /**\n   * @param {!../video-interface.VideoInterface} video\n   * @return {boolean}\n   */\n  isMuted(video) {\n    return this.getEntryForVideo_(video).isMuted();\n  }\n\n  /**\n   * @param {!../video-interface.VideoInterface} video\n   * @return {boolean}\n   */\n  userInteracted(video) {\n    return this.getEntryForVideo_(video).userInteracted();\n  }\n\n  /** @param {!VideoEntry} entry */\n  registerForAutoFullscreen(entry) {\n    this.getAutoFullscreenManager_().register(entry);\n  }\n\n  /** @param {!VideoEntry} entry */\n  registerForDocking(entry) {\n    this.getDocking_().register(entry.video);\n  }\n\n  /**\n   * @return {!AutoFullscreenManager}\n   * @visibleForTesting\n   */\n  getAutoFullscreenManagerForTesting_() {\n    return this.getAutoFullscreenManager_();\n  }\n}\n\n\n/**\n * VideoEntry represents an entry in the VideoManager's list.\n */\nclass VideoEntry {\n  /**\n   * @param {!VideoManager} manager\n   * @param {!../video-interface.VideoOrBaseElementDef} video\n   */\n  constructor(manager, video) {\n    /** @private @const {!VideoManager} */\n    this.manager_ = manager;\n\n    /** @private @const {!./ampdoc-impl.AmpDoc}  */\n    this.ampdoc_ = manager.ampdoc;\n\n    /** @package @const {!../video-interface.VideoOrBaseElementDef} */\n    this.video = video;\n\n    /** @private {boolean} */\n    this.allowAutoplay_ = true;\n\n    /** @private {boolean} */\n    this.loaded_ = false;\n\n    /** @private {boolean} */\n    this.isPlaying_ = false;\n\n    /** @private {boolean} */\n    this.isVisible_ = false;\n\n    /** @private @const */\n    this.actionSessionManager_ = new VideoSessionManager();\n\n    this.actionSessionManager_.onSessionEnd(\n        () => analyticsEvent(this, VideoAnalyticsEvents.SESSION));\n\n    /** @private @const */\n    this.visibilitySessionManager_ = new VideoSessionManager();\n\n    this.visibilitySessionManager_.onSessionEnd(\n        () => analyticsEvent(this, VideoAnalyticsEvents.SESSION_VISIBLE));\n\n    /** @private @const {function(): !Promise<boolean>} */\n    this.supportsAutoplay_ = () => {\n      const {win} = this.ampdoc_;\n      return VideoUtils.isAutoplaySupported(win, getMode(win).lite);\n    };\n\n    // Autoplay Variables\n\n    /** @private {boolean} */\n    this.playCalledByAutoplay_ = false;\n\n    /** @private {boolean} */\n    this.pauseCalledByAutoplay_ = false;\n\n    /** @private {?Element} */\n    this.internalElement_ = null;\n\n    /** @private {boolean} */\n    this.muted_ = false;\n\n    this.hasAutoplay = video.element.hasAttribute(VideoAttributes.AUTOPLAY);\n\n    if (this.hasAutoplay) {\n      this.manager_.installAutoplayStyles();\n    }\n\n    // Media Session API Variables\n\n    /** @private {!../mediasession-helper.MetadataDef} */\n    this.metadata_ = EMPTY_METADATA;\n\n    listenOncePromise(video.element, VideoEvents.LOAD)\n        .then(() => this.videoLoaded());\n    listen(video.element, VideoEvents.PAUSE, () => this.videoPaused_());\n    listen(video.element, VideoEvents.PLAYING, () => this.videoPlayed_());\n    listen(video.element, VideoEvents.MUTED, () => this.muted_ = true);\n    listen(video.element, VideoEvents.UNMUTED, () => this.muted_ = false);\n    listen(video.element, VideoEvents.ENDED, () => this.videoEnded_());\n\n    video.signals().whenSignal(VideoEvents.REGISTERED)\n        .then(() => this.onRegister_());\n\n    /**\n     * Trigger event for first manual play.\n     * @private @const {!function()}\n     */\n    this.firstPlayEventOrNoop_ = once(() => {\n      const firstPlay = 'firstPlay';\n      const trust = ActionTrust.LOW;\n      const event = createCustomEvent(this.ampdoc_.win, firstPlay,\n          /* detail */ dict({}));\n      const actions = Services.actionServiceForDoc(this.ampdoc_);\n      actions.trigger(this.video.element, firstPlay, event, trust);\n    });\n\n    this.listenForAutoplayDelegation_();\n  }\n\n  /** Listens for signals to delegate autoplay to a different module. */\n  listenForAutoplayDelegation_() {\n    const signals = this.video.signals();\n    signals.whenSignal(VideoServiceSignals.AUTOPLAY_DELEGATED).then(() => {\n      this.allowAutoplay_ = false;\n\n      if (this.isPlaying_) {\n        this.video.pause();\n      }\n    });\n  }\n\n  /** @return {boolean} */\n  isMuted() {\n    return this.muted_;\n  }\n\n  /** @private */\n  onRegister_() {\n    if (this.requiresAutoFullscreen_()) {\n      this.manager_.registerForAutoFullscreen(this);\n    }\n\n    if (this.isDockable_()) {\n      this.manager_.registerForDocking(this);\n    }\n\n    this.updateVisibility();\n    if (this.hasAutoplay) {\n      this.autoplayVideoBuilt_();\n    }\n  }\n\n  /**\n   * @return {boolean}\n   * @private\n   */\n  isDockable_() {\n    return this.video.element.hasAttribute(VideoAttributes.DOCK);\n  }\n\n  /**\n   * @return {boolean}\n   * @private\n   */\n  requiresAutoFullscreen_() {\n    const {element} = this.video;\n    if (this.video.preimplementsAutoFullscreen() ||\n        !element.hasAttribute(VideoAttributes.ROTATE_TO_FULLSCREEN)) {\n      return false;\n    }\n    return user().assert(this.video.isInteractive(),\n        'Only interactive videos are allowed to enter fullscreen on rotate. ' +\n        'Set the `controls` attribute on %s to enable.',\n        element);\n  }\n\n  /**\n   * Callback for when the video starts playing\n   * @private\n   */\n  videoPlayed_() {\n    this.isPlaying_ = true;\n\n    if (this.getPlayingState() == PlayingStates.PLAYING_MANUAL) {\n      this.firstPlayEventOrNoop_();\n    }\n\n    if (!this.video.preimplementsMediaSessionAPI()) {\n      const playHandler = () => {\n        this.video.play(/*isAutoplay*/ false);\n      };\n      const pauseHandler = () => {\n        this.video.pause();\n      };\n      // Update the media session\n      setMediaSession(this.ampdoc_, this.metadata_, playHandler, pauseHandler);\n    }\n\n    this.actionSessionManager_.beginSession();\n    if (this.isVisible_) {\n      this.visibilitySessionManager_.beginSession();\n    }\n    analyticsEvent(this, VideoAnalyticsEvents.PLAY);\n  }\n\n  /**\n   * Callback for when the video has been paused\n   * @private\n   */\n  videoPaused_() {\n    analyticsEvent(this, VideoAnalyticsEvents.PAUSE);\n    this.isPlaying_ = false;\n\n    // Prevent double-trigger of session if video is autoplay and the video\n    // is paused by a the user scrolling the video out of view.\n    if (!this.pauseCalledByAutoplay_) {\n      this.actionSessionManager_.endSession();\n    } else {\n      // reset the flag\n      this.pauseCalledByAutoplay_ = false;\n    }\n  }\n\n  /**\n   * Callback for when the video has ended\n   * @private\n   */\n  videoEnded_() {\n    analyticsEvent(this, VideoAnalyticsEvents.ENDED);\n  }\n\n  /**\n   * Called when the video is loaded and can play.\n   */\n  videoLoaded() {\n    this.loaded_ = true;\n\n    this.internalElement_ = getInternalVideoElementFor(this.video.element);\n\n    this.fillMediaSessionMetadata_();\n\n    this.updateVisibility();\n    if (this.isVisible_) {\n      // Handles the case when the video becomes visible before loading\n      this.loadedVideoVisibilityChanged_();\n    }\n  }\n\n  /**\n   * Gets the provided metadata and fills in missing fields\n   * @private\n   */\n  fillMediaSessionMetadata_() {\n    if (this.video.preimplementsMediaSessionAPI()) {\n      return;\n    }\n\n    if (this.video.getMetadata()) {\n      this.metadata_ = map(\n          /** @type {!../mediasession-helper.MetadataDef} */\n          (this.video.getMetadata())\n      );\n    }\n\n    const doc = this.ampdoc_.win.document;\n\n    if (!this.metadata_.artwork || this.metadata_.artwork.length == 0) {\n      const posterUrl = parseSchemaImage(doc)\n                        || parseOgImage(doc)\n                        || parseFavicon(doc);\n\n      if (posterUrl) {\n        this.metadata_.artwork = [{\n          'src': posterUrl,\n        }];\n      }\n    }\n\n    if (!this.metadata_.title) {\n      const title = this.video.element.getAttribute('title')\n                    || this.video.element.getAttribute('aria-label')\n                    || this.internalElement_.getAttribute('title')\n                    || this.internalElement_.getAttribute('aria-label')\n                    || doc.title;\n      if (title) {\n        this.metadata_.title = title;\n      }\n    }\n  }\n\n  /**\n   * Called when visibility of a video changes.\n   * @private\n   */\n  videoVisibilityChanged_() {\n    if (this.loaded_) {\n      this.loadedVideoVisibilityChanged_();\n    }\n  }\n\n  /**\n   * Only called when visibility of a loaded video changes.\n   * @private\n   */\n  loadedVideoVisibilityChanged_() {\n    if (!Services.viewerForDoc(this.ampdoc_).isVisible()) {\n      return;\n    }\n    this.supportsAutoplay_().then(supportsAutoplay => {\n      const canAutoplay = this.hasAutoplay &&\n          !this.userInteracted();\n\n      if (canAutoplay && supportsAutoplay) {\n        this.autoplayLoadedVideoVisibilityChanged_();\n      } else {\n        this.nonAutoplayLoadedVideoVisibilityChanged_();\n      }\n    });\n  }\n\n  /* Autoplay Behaviour */\n\n  /**\n   * Called when an autoplay video is built.\n   * @private\n   */\n  autoplayVideoBuilt_() {\n\n    // Hide controls until we know if autoplay is supported, otherwise hiding\n    // and showing the controls quickly becomes a bad user experience for the\n    // common case where autoplay is supported.\n    if (this.video.isInteractive()) {\n      this.video.hideControls();\n    }\n\n    this.supportsAutoplay_().then(supportsAutoplay => {\n      if (!supportsAutoplay && this.video.isInteractive()) {\n        // Autoplay is not supported, show the controls so user can manually\n        // initiate playback.\n        this.video.showControls();\n        return;\n      }\n\n      // Only muted videos are allowed to autoplay\n      this.video.mute();\n\n      this.installAutoplayArtifacts_();\n    });\n  }\n\n  /**\n   * Installs autoplay animation and interaction mask when interactive.\n   * The animated icon is appended always, but only displayed by CSS when\n   * `controls` is set. See `video-autoplay.css`.\n   * @private\n   */\n  installAutoplayArtifacts_() {\n    const {video} = this;\n    const {element, win} = this.video;\n\n    if (element.hasAttribute(VideoAttributes.NO_AUDIO) ||\n        element.signals().get(VideoServiceSignals.USER_INTERACTED)) {\n      return;\n    }\n\n    const animation = renderIcon(win, element);\n\n    /** @param {boolean} isPlaying */\n    const toggleAnimation = isPlaying => {\n      video.mutateElement(() => {\n        animation.classList.toggle('amp-video-eq-play', isPlaying);\n      });\n    };\n\n    video.mutateElement(() => {\n      element.appendChild(animation);\n    });\n\n    const unlisteners = [\n      listen(element, VideoEvents.PAUSE, () => toggleAnimation(false)),\n      listen(element, VideoEvents.PLAYING, () => toggleAnimation(true)),\n    ];\n\n    video.signals().whenSignal(VideoServiceSignals.USER_INTERACTED).then(() => {\n      const {video} = this;\n      const {element} = video;\n      this.firstPlayEventOrNoop_();\n      if (video.isInteractive()) {\n        video.showControls();\n      }\n      video.unmute();\n      unlisteners.forEach(unlistener => {\n        unlistener();\n      });\n      const animation = element.querySelector('.amp-video-eq');\n      const mask = element.querySelector('i-amphtml-video-mask');\n      if (animation) {\n        removeElement(animation);\n      }\n      if (mask) {\n        removeElement(mask);\n      }\n    });\n\n    if (!video.isInteractive()) {\n      return;\n    }\n\n    const mask = renderInteractionOverlay(win, element);\n\n    /** @param {string} display */\n    const setMaskDisplay = display => {\n      video.mutateElement(() => {\n        setStyle(mask, 'display', display);\n      });\n    };\n\n    video.hideControls();\n\n    video.mutateElement(() => {\n      element.appendChild(mask);\n    });\n\n    [\n      listen(mask, 'click', () => userInteractedWith(video)),\n      listen(element, VideoEvents.AD_START, () => setMaskDisplay('none')),\n      listen(element, VideoEvents.AD_END, () => setMaskDisplay('block')),\n    ].forEach(unlistener => unlisteners.push(unlistener));\n  }\n\n  /**\n   * Called when visibility of a loaded autoplay video changes.\n   * @private\n   */\n  autoplayLoadedVideoVisibilityChanged_() {\n    if (!this.allowAutoplay_) {\n      return;\n    }\n    if (this.isVisible_) {\n      this.visibilitySessionManager_.beginSession();\n      this.video.play(/*autoplay*/ true);\n      this.playCalledByAutoplay_ = true;\n    } else {\n      if (this.isPlaying_) {\n        this.visibilitySessionManager_.endSession();\n      }\n      this.video.pause();\n      this.pauseCalledByAutoplay_ = true;\n    }\n  }\n\n  /**\n   * Called when visibility of a loaded non-autoplay video changes.\n   * @private\n   */\n  nonAutoplayLoadedVideoVisibilityChanged_() {\n    if (this.isVisible_) {\n      this.visibilitySessionManager_.beginSession();\n    } else if (this.isPlaying_) {\n      this.visibilitySessionManager_.endSession();\n    }\n  }\n\n  /**\n   * Called by all possible events that might change the visibility of the video\n   * such as scrolling or {@link ../video-interface.VideoEvents#VISIBILITY}.\n   * @param {?boolean=} opt_forceVisible\n   * @package\n   */\n  updateVisibility(opt_forceVisible) {\n    const wasVisible = this.isVisible_;\n\n    if (opt_forceVisible) {\n      this.isVisible_ = true;\n    } else {\n      const {element} = this.video;\n      const ratio = element.getIntersectionChangeEntry().intersectionRatio;\n      this.isVisible_ =\n          (!isFiniteNumber(ratio) ? 0 : ratio) >=\n            MIN_VISIBILITY_RATIO_FOR_AUTOPLAY;\n    }\n\n    if (this.isVisible_ != wasVisible) {\n      this.videoVisibilityChanged_();\n    }\n  }\n\n  /**\n   * Returns whether the video is paused or playing after the user interacted\n   * with it or playing through autoplay\n   * @return {!../video-interface.VideoInterface} PlayingStates\n   */\n  getPlayingState() {\n    if (!this.isPlaying_) {\n      return PlayingStates.PAUSED;\n    }\n\n    if (this.isPlaying_\n       && this.playCalledByAutoplay_\n       && !this.userInteracted()) {\n      return PlayingStates.PLAYING_AUTO;\n    }\n\n    return PlayingStates.PLAYING_MANUAL;\n  }\n\n  /**\n   * Returns whether the video was interacted with or not\n   * @return {boolean}\n   */\n  userInteracted() {\n    return (\n      this.video.signals().get(VideoServiceSignals.USER_INTERACTED) != null);\n  }\n\n  /**\n   * Collects a snapshot of the current video state for video analytics\n   * @return {!Promise<!../video-interface.VideoAnalyticsDetailsDef>}\n   */\n  getAnalyticsDetails() {\n    const {video} = this;\n    return this.supportsAutoplay_().then(supportsAutoplay => {\n      const {width, height} = video.element.getLayoutBox();\n      const autoplay = this.hasAutoplay && supportsAutoplay;\n      const playedRanges = video.getPlayedRanges();\n      const playedTotal = playedRanges.reduce(\n          (acc, range) => acc + range[1] - range[0], 0);\n\n      return {\n        'autoplay': autoplay,\n        'currentTime': video.getCurrentTime(),\n        'duration': video.getDuration(),\n        // TODO(cvializ): add fullscreen\n        'height': height,\n        'id': video.element.id,\n        'muted': this.muted_,\n        'playedTotal': playedTotal,\n        'playedRangesJson': JSON.stringify(playedRanges),\n        'state': this.getPlayingState(),\n        'width': width,\n      };\n    });\n  }\n}\n\n\n/**\n * @param {!AmpElement} video\n * @return {boolean}\n * @restricted\n */\nfunction supportsFullscreenViaApi(video) {\n  // TODO(alanorozco): Determine this via a flag in the component itself.\n  return !!({\n    'amp-dailymotion': true,\n    'amp-ima-video': true,\n  }[video.tagName.toLowerCase()]);\n}\n\n\n/** Manages rotate-to-fullscreen video. */\nexport class AutoFullscreenManager {\n\n  /**\n   * @param {!./ampdoc-impl.AmpDoc} ampdoc\n   * @param {!./video-service-interface.VideoServiceInterface} manager\n   */\n  constructor(ampdoc, manager) {\n\n    /** @private @const {!./video-service-interface.VideoServiceInterface} */\n    this.manager_ = manager;\n\n    /** @private @const {!./ampdoc-impl.AmpDoc} */\n    this.ampdoc_ = ampdoc;\n\n    /** @private {?../video-interface.VideoOrBaseElementDef} */\n    this.currentlyInFullscreen_ = null;\n\n    /** @private {?../video-interface.VideoOrBaseElementDef} */\n    this.currentlyCentered_ = null;\n\n    /** @private @const {!Array<!../video-interface.VideoOrBaseElementDef>} */\n    this.entries_ = [];\n\n    /** @private @const {function()} */\n    this.boundSelectBestCentered_ = () => this.selectBestCenteredInPortrait_();\n\n    /**\n     * @param {!../video-interface.VideoOrBaseElementDef} video\n     * @return {boolean}\n     */\n    this.boundIncludeOnlyPlaying_ = video =>\n      this.getPlayingState_(video) == PlayingStates.PLAYING_MANUAL;\n\n    /**\n     * @param {!../video-interface.VideoOrBaseElementDef} a\n     * @param {!../video-interface.VideoOrBaseElementDef} b\n     * @return {number}\n     */\n    this.boundCompareEntries_ = (a, b) => this.compareEntries_(a, b);\n\n    this.installOrientationObserver_();\n    this.installFullscreenListener_();\n  }\n\n  /** @param {!VideoEntry} entry */\n  register(entry) {\n    const {video} = entry;\n    const {element} = video;\n\n    if (!this.canFullscreen_(element)) {\n      return;\n    }\n\n    this.entries_.push(video);\n\n    listen(element, VideoEvents.PAUSE, this.boundSelectBestCentered_);\n    listen(element, VideoEvents.PLAYING, this.boundSelectBestCentered_);\n    listen(element, VideoEvents.ENDED, this.boundSelectBestCentered_);\n\n    video.signals().whenSignal(VideoServiceSignals.USER_INTERACTED)\n        .then(this.boundSelectBestCentered_);\n\n    // Set always\n    this.selectBestCenteredInPortrait_();\n  }\n\n  /** @private */\n  installFullscreenListener_() {\n    const root = this.ampdoc_.getRootNode();\n    const exitHandler = () => this.onFullscreenExit_();\n    listen(root, 'webkitfullscreenchange', exitHandler);\n    listen(root, 'mozfullscreenchange', exitHandler);\n    listen(root, 'fullscreenchange', exitHandler);\n    listen(root, 'MSFullscreenChange', exitHandler);\n  }\n\n  /**\n   * @return {boolean}\n   * @visibleForTesting\n   */\n  isInLandscape() {\n    return isLandscape(this.ampdoc_.win);\n  }\n\n  /**\n   * @param {!AmpElement} video\n   * @return {boolean}\n   * @private\n   */\n  canFullscreen_(video) {\n    // Safari and iOS can only fullscreen <video> elements directly. In cases\n    // where the player component is implemented via an <iframe>, we need to\n    // rely on a postMessage API to fullscreen. Such an API is not necessarily\n    // provided by every player.\n    const internalElement = getInternalVideoElementFor(video);\n    if (internalElement.tagName.toLowerCase() == 'video') {\n      return true;\n    }\n    const platform = Services.platformFor(this.ampdoc_.win);\n    if (!(platform.isIos() || platform.isSafari())) {\n      return true;\n    }\n    return supportsFullscreenViaApi(video);\n  }\n\n  /** @private */\n  onFullscreenExit_() {\n    this.currentlyInFullscreen_ = null;\n  }\n\n  /** @private */\n  installOrientationObserver_() {\n    // TODO(alanorozco) Update based on support\n    const {win} = this.ampdoc_;\n    const {screen} = win;\n    // Chrome considers 'orientationchange' to be an untrusted event, but\n    // 'change' on screen.orientation is considered a user interaction.\n    // We still need to listen to 'orientationchange' on Chrome in order to\n    // exit fullscreen since 'change' does not fire in this case.\n    if (screen && 'orientation' in screen) {\n      const orient = /** @type {!ScreenOrientation} */ (screen.orientation);\n      listen(orient, 'change', () => this.onRotation_());\n    }\n    // iOS Safari does not have screen.orientation but classifies\n    // 'orientationchange' as a user interaction.\n    listen(win, 'orientationchange', () => this.onRotation_());\n  }\n\n  /** @private */\n  onRotation_() {\n    if (this.isInLandscape()) {\n      if (this.currentlyCentered_ != null) {\n        this.enter_(this.currentlyCentered_);\n      }\n      return;\n    }\n    if (this.currentlyInFullscreen_) {\n      this.exit_(this.currentlyInFullscreen_);\n    }\n  }\n\n  /**\n   * @param {!../video-interface.VideoOrBaseElementDef} video\n   * @private\n   */\n  enter_(video) {\n    const platform = Services.platformFor(this.ampdoc_.win);\n\n    this.currentlyInFullscreen_ = video;\n\n    if (platform.isAndroid() && platform.isChrome()) {\n      // Chrome on Android somehow knows what we're doing and executes a nice\n      // transition by default. Delegating to browser.\n      video.fullscreenEnter();\n      return;\n    }\n\n    this.scrollIntoIfNotVisible_(video)\n        .then(() => video.fullscreenEnter());\n  }\n\n  /**\n   * @param {!../video-interface.VideoOrBaseElementDef} video\n   * @private\n   */\n  exit_(video) {\n    this.currentlyInFullscreen_ = null;\n\n    this.scrollIntoIfNotVisible_(video, 'center')\n        .then(() => video.fullscreenExit());\n  }\n\n  /**\n   * Scrolls to a video if it's not in view.\n   * @param {!../video-interface.VideoOrBaseElementDef} video\n   * @param {?string=} optPos\n   * @private\n   */\n  scrollIntoIfNotVisible_(video, optPos = null) {\n    const {element} = video;\n    const viewport = this.getViewport_();\n\n    const duration = 300;\n    const curve = 'ease-in';\n\n    return this.onceOrientationChanges_().then(() => {\n      const {boundingClientRect} = element.getIntersectionChangeEntry();\n      const {top, bottom} = boundingClientRect;\n      const vh = viewport.getSize().height;\n      const fullyVisible = top >= 0 && bottom <= vh;\n      if (fullyVisible) {\n        return Promise.resolve();\n      }\n      const pos = optPos ? dev().assertString(optPos) :\n        bottom > vh ? 'bottom' : 'top';\n      return viewport.animateScrollIntoView(element, duration, curve, pos);\n    });\n  }\n\n  /** @private */\n  getViewport_() {\n    return Services.viewportForDoc(this.ampdoc_);\n  }\n\n  /** @private @return {!Promise} */\n  onceOrientationChanges_() {\n    const magicNumber = 330;\n    return Services.timerFor(this.ampdoc_.win).promise(magicNumber);\n  }\n\n  /** @private */\n  selectBestCenteredInPortrait_() {\n    if (this.isInLandscape()) {\n      return this.currentlyCentered_;\n    }\n\n    this.currentlyCentered_ = null;\n\n    const selected = this.entries_\n        .filter(this.boundIncludeOnlyPlaying_)\n        .sort(this.boundCompareEntries_)[0];\n\n    if (selected) {\n      const {intersectionRatio} = selected.element.getIntersectionChangeEntry();\n      if (intersectionRatio >= MIN_VISIBILITY_RATIO_FOR_AUTOPLAY) {\n        this.currentlyCentered_ = selected;\n      }\n    }\n\n    return this.currentlyCentered_;\n  }\n\n  /**\n   * Compares two videos in order to sort them by \"best centered\".\n   * @param {!../video-interface.VideoOrBaseElementDef} a\n   * @param {!../video-interface.VideoOrBaseElementDef} b\n   * @return {number}\n   */\n  compareEntries_(a, b) {\n    const {\n      intersectionRatio: ratioA,\n      boundingClientRect: rectA,\n    } = a.element.getIntersectionChangeEntry();\n    const {\n      intersectionRatio: ratioB,\n      boundingClientRect: rectB,\n    } = b.element.getIntersectionChangeEntry();\n\n    // Prioritize by how visible they are, with a tolerance of 10%\n    const ratioTolerance = 0.1;\n    const ratioDelta = ratioA - ratioB;\n    if (Math.abs(ratioDelta) > ratioTolerance) {\n      return ratioDelta;\n    }\n\n    // Prioritize by distance from center.\n    const viewport = Services.viewportForDoc(this.ampdoc_);\n    const centerA = centerDist(viewport, rectA);\n    const centerB = centerDist(viewport, rectB);\n    if (centerA < centerB ||\n        centerA > centerB) {\n      return centerA - centerB;\n    }\n\n    // Everything else failing, choose the highest element.\n    return rectA.top - rectB.top;\n  }\n\n  /**\n   * @param {!../video-interface.VideoOrBaseElementDef} video\n   * @return {!../video-interface.VideoInterface} PlayingStates\n   * @private\n   */\n  getPlayingState_(video) {\n    return this.manager_.getPlayingState(\n        /** @type {!../video-interface.VideoInterface} */ (video));\n  }\n}\n\n\n/**\n * @param {!./viewport/viewport-impl.Viewport} viewport\n * @param {{top: number, height: number}} rect\n * @return {number}\n */\nfunction centerDist(viewport, rect) {\n  const centerY = rect.top + (rect.height / 2);\n  const centerViewport = viewport.getSize().height / 2;\n  return Math.abs(centerY - centerViewport);\n}\n\n\n/**\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isLandscape(win) {\n  if (win.screen && 'orientation' in win.screen) {\n    return startsWith(win.screen.orientation.type, 'landscape');\n  }\n  return Math.abs(win.orientation) == 90;\n}\n\n\n\n/**\n * @param {!VideoEntry} entry\n * @param {!VideoAnalyticsEvents} eventType\n * @param {!Object<string, string>=} opt_vars A map of vars and their values.\n * @private\n */\nfunction analyticsEvent(entry, eventType, opt_vars) {\n  const {video} = entry;\n  const detailsPromise = opt_vars ? Promise.resolve(opt_vars) :\n    entry.getAnalyticsDetails();\n\n  detailsPromise.then(details => {\n    video.element.dispatchCustomEvent(\n        eventType, details);\n  });\n}\n\n\n/** @param {!Node|!./ampdoc-impl.AmpDoc} nodeOrDoc */\nexport function installVideoManagerForDoc(nodeOrDoc) {\n  // TODO(alanorozco, #13674): Rename to `installVideoServiceForDoc`\n  // TODO(alanorozco, #13674): Rename to `video-service`\n  registerServiceBuilderForDoc(nodeOrDoc, 'video-manager', ampdoc => {\n    const {win} = ampdoc;\n    if (VideoServiceSync.shouldBeUsedIn(win)) {\n      return new VideoServiceSync(ampdoc);\n    }\n    return new VideoManager(ampdoc);\n  });\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/** @typedef {../video-interface.VideoAnalyticsDetailsDef} */\nlet VideoAnalyticsDetailsDef; // alias for line length\n\n\n/** @interface */\nexport class VideoServiceInterface {\n\n  /** @param {!../video-interface.VideoInterface} unusedVideo */\n  register(unusedVideo) {}\n\n  /**\n   * Gets the current analytics details for the given video.\n   * Fails silently if the video is not registered.\n   * @param {!AmpElement} unusedVideo\n   * @return {!Promise<!VideoAnalyticsDetailsDef>|!Promise<void>}\n   */\n  getAnalyticsDetails(unusedVideo) {}\n\n  /**\n   * @param {!../video-interface.VideoInterface} unusedVideo\n   * @return {boolean}\n   */\n  isMuted(unusedVideo) {}\n\n  /**\n   * @param {!../video-interface.VideoInterface} unusedVideo\n   * @return {!../video-interface.VideoInterface} PlayingStates\n   */\n  getPlayingState(unusedVideo) {}\n}\n\n\n/** @enum {string} */\nexport const VideoServiceSignals = {\n  USER_INTERACTED: 'user-interacted',\n  AUTOPLAY_DELEGATED: 'autoplay-delegated',\n};\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Autoplay, AutoplayEvents} from './video/autoplay';\nimport {PlayingStates, VideoAttributes, VideoEvents} from '../video-interface';\nimport {Services} from '../services';\nimport {VideoServiceSignals} from './video-service-interface';\nimport {dev} from '../log';\nimport {getAmpdoc} from '../service';\nimport {getElementServiceForDoc} from '../element-service';\nimport {isExperimentOn} from '../experiments';\nimport {listen, listenOncePromise} from '../event-helper';\nimport {once} from '../utils/function';\n\n\n/** @private @const {string} */\nconst EXTENSION = 'amp-video-service';\n\n\n/** @private @const {string} */\nconst TAG = 'video-service';\n\n\n/**\n * @typedef\n * {../../extensions/amp-video-service/0.1/amp-video-service.VideoService}\n */\nlet VideoServiceDef; // alias for line length.\n\n\n/**\n * Provides unified behavior for all videos regardless of implementation.\n *\n * This service is a faade around an async-loaded implementation.\n * See {@link AmpVideoService} for the underlying service.\n *\n * This co-eexists with `VideoManager` (deprecated) while the implementation\n * is migrated.\n *\n * @implements {./video-service-interface.VideoServiceInterface}\n */\nexport class VideoServiceSync {\n\n  /** @param {!./ampdoc-impl.AmpDoc} ampdoc */\n  constructor(ampdoc) {\n    const {win} = ampdoc;\n\n    /** @private @const {!./ampdoc-impl.AmpDoc} */\n    this.ampdoc_ = ampdoc;\n\n    /** @private @const {!Promise<!VideoServiceDef>}  */\n    this.asyncImpl_ = VideoServiceSync.videoServiceFor(win, ampdoc);\n\n    /**\n     * @return {!Autoplay}\n     * @private\n     */\n    this.getAutoplay_ = once(() => new Autoplay(this.ampdoc_));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {boolean}\n   * @visibleForTesting\n   */\n  static shouldBeUsedIn(win) {\n    return isExperimentOn(win, 'video-service');\n  }\n\n  /**\n   * @param {!Window} win\n   * @param {!Node|!./ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!Promise<!VideoServiceDef>}\n   * @visibleForTesting\n   */\n  static videoServiceFor(win, nodeOrDoc) {\n    // Not exposed in ../services.js since we don't want other modules to\n    // instantiate or access the service.\n    const extensions = Services.extensionsFor(win);\n    const ampdoc = getAmpdoc(nodeOrDoc);\n    return extensions.installExtensionForDoc(ampdoc, EXTENSION)\n        .then(() => /** @type {!Promise<!VideoServiceDef>} */ (\n          getElementServiceForDoc(ampdoc, 'video-service', EXTENSION)));\n  }\n\n  /** @override */\n  register(video) {\n    this.asyncImpl_.then(impl =>\n      impl.register(video));\n\n    this.maybeInstallAutoplay_(video);\n\n    new VideoEntry(video);\n  }\n\n  /**\n   * @param  {!../video-interface.VideoOrBaseElementDef} video\n   * @private\n   */\n  maybeInstallAutoplay_(video) {\n    if (!video.element.hasAttribute(VideoAttributes.AUTOPLAY)) {\n      return;\n    }\n\n    this.getAutoplay_().register(video);\n\n    const autoplayDelegated = VideoServiceSignals.AUTOPLAY_DELEGATED;\n    video.signals().whenSignal(autoplayDelegated).then(() => {\n      this.getAutoplay_().delegate(video.element);\n    });\n  }\n\n  /**\n   * @param {!AmpElement|!../base-element.BaseElement} video\n   */\n  static delegateAutoplay(video) {\n    video.signals().signal(VideoServiceSignals.AUTOPLAY_DELEGATED);\n  }\n\n  /** @override */\n  getAnalyticsDetails(video) {\n    return this.asyncImpl_.then(impl =>\n      impl.getAnalyticsDetails(video));\n  }\n\n  /** @override */\n  isMuted(unusedVideo) {\n    dev().warn(TAG, 'isMuted is not implemented');\n    return false;\n  }\n\n  /** @override */\n  getPlayingState(unusedVideo) {\n    dev().warn(TAG, 'getPlayingState is not implemented');\n    return PlayingStates.PAUSED;\n  }\n}\n\n\n/** @visibleForTesting */\nexport class VideoEntry {\n\n  /** @param {!../video-interface.VideoOrBaseElementDef} video */\n  constructor(video) {\n\n    /** @private @const {!../video-interface.VideoOrBaseElementDef} */\n    this.video_ = video;\n\n    /** @private @const {!AmpElement} */\n    this.element_ = video.element;\n\n    /** @private @const {!Promise} */\n    this.loadPromise_ = listenOncePromise(this.element_, VideoEvents.LOAD);\n\n    this.listenToAutoplayEvents_();\n\n    setVideoComponentClassname(this.element_);\n  }\n\n  /**\n   * @param {string} event\n   * @param {function(!Event)} handler\n   * @private\n   */\n  listenOnLoad_(event, handler) {\n    listen(this.element_, event, e => {\n      this.loadPromise_.then(() => {\n        handler(e);\n      });\n    });\n  }\n\n  /** @private */\n  listenToAutoplayEvents_() {\n    // TODO(alanorozco): Keep track of session\n    this.listenOnLoad_(AutoplayEvents.PLAY, () => {\n      this.video_.play(/* auto */ true);\n    });\n\n    this.listenOnLoad_(AutoplayEvents.PAUSE, () => {\n      this.video_.pause();\n    });\n  }\n}\n\n/**\n * @param {!Element} element\n */\nexport function setVideoComponentClassname(element) {\n  element.classList.add('i-amphtml-video-component');\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Observable} from '../observable';\n\n\nexport class VideoSessionManager {\n  /**\n   * Creates an instance of VideoSessionManager.\n   */\n  constructor() {\n    /** @private */\n    this.isSessionActive_ = false;\n\n    /** @private */\n    this.endSessionObservable_ = new Observable();\n  }\n\n  /**\n   * Register a listener to be notified when a session has ended\n   * @param {!Function} listener\n   */\n  onSessionEnd(listener) {\n    this.endSessionObservable_.add(listener);\n  }\n\n  /**\n   * Begin a session.\n   */\n  beginSession() {\n    this.isSessionActive_ = true;\n  }\n\n  /**\n   * End a session.\n   */\n  endSession() {\n    if (this.isSessionActive_) {\n      this.endSessionObservable_.fire();\n    }\n    this.isSessionActive_ = false;\n  }\n\n  /**\n   * Get the current session state.\n   */\n  isSessionActive() {\n    return this.isSessionActive_;\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  MIN_VISIBILITY_RATIO_FOR_AUTOPLAY,\n  VideoEvents,\n} from '../../video-interface';\nimport {\n  PositionObserverFidelity,\n} from '../position-observer/position-observer-worker';\nimport {Services} from '../../services';\nimport {VideoServiceSignals} from '../video-service-interface';\nimport {VideoUtils} from '../../utils/video';\nimport {dev} from '../../log';\nimport {getData, listen, listenOnce} from '../../event-helper';\nimport {getMode} from '../../mode';\nimport {getServiceForDoc} from '../../service';\nimport {htmlFor} from '../../static-template';\nimport {installAutoplayStylesForDoc} from './install-autoplay-styles';\nimport {\n  installPositionObserverServiceForDoc,\n} from '../position-observer/position-observer-impl';\nimport {isFiniteNumber} from '../../types';\nimport {once} from '../../utils/function';\nimport {removeElement} from '../../dom';\n\n\n/** @private @enum {string} */\nexport const AutoplayEvents = {\n  PLAY: 'amp:autoplay',\n  PAUSE: 'amp:autopause',\n};\n\n/**\n * @param {!Element} node\n * @return {!Element}\n */\nfunction cloneDeep(node) {\n  return dev().assertElement(node.cloneNode(/* deep */ true));\n}\n\n\n/**\n * @param {function(!Window, !Element):!Element} renderFn\n * @return {function(!Window, !Element):!Element}\n */\nfunction renderOrClone(renderFn) {\n  const seedFn = once(renderFn);\n  return (win, doc) => cloneDeep(seedFn(win, doc));\n}\n\n\n/**\n * @param {!Window} unusedWin\n * @param {!Element|!Document} elOrDoc\n * @return {!Element}\n */\nexport function renderInteractionOverlay(unusedWin, elOrDoc) {\n  const html = htmlFor(elOrDoc);\n  return html`<i-amphtml-video-mask class=\"i-amphtml-fill-content\" role=button>\n    </i-amphtml-video-mask>`;\n}\n\n\n/**\n * @param {!Window} win\n * @param {!Element|!Document} elOrDoc\n * @return {!Element}\n */\nexport function renderIcon(win, elOrDoc) {\n  const icon = htmlFor(elOrDoc)`<i-amphtml-video-icon class=\"amp-video-eq\">\n    <div class=\"amp-video-eq-col\">\n      <div class=\"amp-video-eq-filler\"></div>\n      <div class=\"amp-video-eq-filler\"></div>\n    </div>\n  </i-amphtml-video-icon>`;\n\n  // Copy equalizer column 4x and annotate filler positions for animation.\n  const firstCol = dev().assertElement(icon.firstElementChild);\n  for (let i = 0; i < 4; i++) {\n    const col = cloneDeep(firstCol);\n    const fillers = col.children;\n    for (let j = 0; j < fillers.length; j++) {\n      const filler = fillers[j];\n      filler.classList.add(`amp-video-eq-${i + 1}-${j + 1}`);\n    }\n    icon.appendChild(col);\n  }\n\n  // Remove seed column.\n  removeElement(firstCol);\n\n  if (Services.platformFor(win).isIos()) {\n    // iOS is unable to pause hardware accelerated animations.\n    icon.setAttribute('unpausable', '');\n  }\n\n  return icon;\n}\n\n\n/**\n * @param {!Window} unusedWin\n * @param {!Element|!Document} elOrDoc\n * @return {!Element}\n */\nconst renderOrCloneInteractionOverlay = renderOrClone(renderInteractionOverlay);\n\n\n/**\n * @param {!Window} unusedWin\n * @param {!Element|!Document} elOrDoc\n * @return {!Element}\n */\nconst renderOrCloneIcon = renderOrClone(renderIcon);\n\n\n/** Manages autoplay video. */\nexport class Autoplay {\n\n  /** @param {!../ampdoc-impl.AmpDoc} ampdoc */\n  constructor(ampdoc) {\n\n    /** @private @const {!../ampdoc-impl.AmpDoc} */\n    this.ampdoc_ = ampdoc;\n\n    /**\n     * @return {!../position-observer/position-observer-impl.PositionObserver}\n     * @restricted\n     */\n    this.getPositionObserver_ = once(() => this.installPositionObserver_());\n\n    /** @private @const {!Array<!AutoplayEntry>} */\n    this.entries_ = [];\n\n    /**\n     * @return {!Promise<boolean>}\n     * @private\n     */\n    this.isSupported_ = once(() => {\n      // Can't destructure as the compiler expects direct member access for\n      // `getMode`.\n      const {win} = this.ampdoc_;\n      const isLite = getMode(win).lite;\n      return VideoUtils.isAutoplaySupported(win, /* isLiteMode */ isLite);\n    });\n\n    installAutoplayStylesForDoc(this.ampdoc_);\n  }\n\n  /** @private */\n  installPositionObserver_() {\n    installPositionObserverServiceForDoc(this.ampdoc_);\n    // No getter in services.js.\n    return (\n      /** @type {\n       *   !../position-observer/position-observer-impl.PositionObserver\n       * } */ (getServiceForDoc(this.ampdoc_, 'position-observer')));\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @return {!Promise<?AutoplayEntry>} `null` when unsupported.\n   */\n  register(video) {\n    // Controls are hidden before support is determined to prevent visual jump\n    // for the common case where autoplay is supported.\n    if (video.isInteractive()) {\n      video.hideControls();\n    }\n\n    return this.isSupported_().then(isSupported => {\n      if (!isSupported) {\n        // Disable autoplay\n        if (video.isInteractive()) {\n          video.showControls();\n        }\n        return null;\n      }\n      const entry = AutoplayEntry.create(this, video);\n      this.entries_.push(entry);\n      return entry;\n    });\n  }\n\n  /**\n   * @param {!Element} element\n   */\n  delegate(element) {\n    const entry = this.getEntryFor_(element);\n    if (!entry) {\n      return;\n    }\n    entry.delegate();\n  }\n\n  /**\n   * @param {!Element} element\n   * @return {?AutoplayEntry}\n   * @private\n   */\n  getEntryFor_(element) {\n    for (let i = 0; i < this.entries_.length; i++) {\n      const entry = this.entries_[i];\n      if (entry.video.element == element) {\n        return entry;\n      }\n    }\n    return null;\n  }\n}\n\n\n/** @visibleForTesting */\nexport class AutoplayEntry {\n\n  /**\n   * @param {!../ampdoc-impl.AmpDoc} ampdoc\n   * @param {\n   *   !../position-observer/position-observer-impl.PositionObserver\n   * } positionObserver\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   */\n  constructor(ampdoc, positionObserver, video) {\n\n    /** @const {!../../video-interface.VideoOrBaseElementDef} */\n    this.video = video;\n\n    /** @private {!../ampdoc-impl.AmpDoc} ampdoc} */\n    this.ampdoc_ = ampdoc;\n\n    /** @private @const {!AmpElement}  */\n    this.element_ = video.element;\n\n    /** @private {boolean} */\n    this.isVisible_ = false;\n\n    /** @private {?Array<!UnlistenDef>} */\n    this.visibilityUnlisteners_ = [\n      this.observeOn_(positionObserver),\n      this.listenToVisibilityChange_(),\n    ];\n\n    // Only muted videos are allowed to autoplay\n    video.mute();\n    video.hideControls();\n\n    this.attachArtifacts_();\n  }\n\n  /**\n   * @param {!Autoplay} manager\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   */\n  static create(manager, video) {\n    return new AutoplayEntry(\n        manager.ampdoc_, manager.getPositionObserver_(), video);\n  }\n\n  /**\n   * @param {\n   *   !../position-observer/position-observer-impl.PositionObserver\n   * } positionObserver\n   * @return {!UnlistenDef}\n   * @private\n   */\n  observeOn_(positionObserver) {\n    return positionObserver.observe(\n        this.element_,\n        PositionObserverFidelity.HIGH,\n        () => this.onPositionChange_());\n  }\n\n  /**\n   * @return {!UnlistenDef}\n   * @private\n   */\n  listenToVisibilityChange_() {\n    return listen(this.element_, VideoEvents.VISIBILITY, e => {\n      const data = getData(e);\n      const enforcedByEvent = data && data['visible'];\n      if (enforcedByEvent && !this.isVisible_) {\n        this.isVisible_ = enforcedByEvent;\n        this.trigger_(/* isPlaying */ enforcedByEvent);\n        return;\n      }\n      this.triggerByVisibility_();\n    });\n  }\n\n  /**\n   * Delegates autoplay so that it's triggered by a different module.\n   * @public\n   */\n  delegate() {\n    this.disableTriggerByVisibility_();\n    this.video.pause();\n  }\n\n  /** @private */\n  onPositionChange_() {\n    this.triggerByVisibility_();\n  }\n\n  /** @private */\n  triggerByVisibility_() {\n    const ratio = this.element_.getIntersectionChangeEntry().intersectionRatio;\n    const isVisible = (!isFiniteNumber(ratio) ? 0 : ratio) >=\n        MIN_VISIBILITY_RATIO_FOR_AUTOPLAY;\n    if (this.isVisible_ == isVisible) {\n      return;\n    }\n    this.isVisible_ = isVisible;\n    this.trigger_(/* isPlaying */ isVisible);\n  }\n\n  /**\n   * @param {boolean} isPlaying\n   * @private\n   */\n  trigger_(isPlaying) {\n    this.element_.dispatchCustomEvent(\n        isPlaying ? AutoplayEvents.PLAY : AutoplayEvents.PAUSE);\n  }\n\n  /** @private */\n  attachArtifacts_() {\n    // TODO(alanorozco): AD_START, AD_END\n    const {video} = this;\n    const signals = video.signals();\n    const userInteracted = VideoServiceSignals.USER_INTERACTED;\n\n    if (signals.get(userInteracted) != null) {\n      return;\n    }\n\n    const {win} = this.ampdoc_;\n\n    const icon = renderOrCloneIcon(win, this.element_);\n\n    video.mutateElement(() => {\n      this.element_.appendChild(icon);\n    });\n\n    const {element} = video;\n    const playOrPauseIconAnim = this.playOrPauseIconAnim_.bind(this, icon);\n\n    const unlisteners = [\n      listen(element, VideoEvents.PLAYING, () => playOrPauseIconAnim(true)),\n      listen(element, VideoEvents.PAUSE, () => playOrPauseIconAnim(false)),\n    ];\n\n    signals.whenSignal(userInteracted).then(() => {\n      unlisteners.forEach(unlisten => unlisten());\n      this.onInteraction_();\n    });\n\n    if (!this.video.isInteractive()) {\n      return;\n    }\n\n    const overlay = renderOrCloneInteractionOverlay(win, this.element_);\n\n    listenOnce(overlay, 'click', () => signals.signal(userInteracted));\n\n    video.mutateElement(() => {\n      this.element_.appendChild(overlay);\n    });\n  }\n\n  /** @private */\n  onInteraction_() {\n    const mask = this.element_.querySelector('i-amphtml-video-mask');\n    this.disableTriggerByVisibility_();\n    if (mask) {\n      removeElement(mask);\n    }\n    if (this.video.isInteractive()) {\n      this.video.showControls();\n    }\n    this.video.unmute();\n  }\n\n  /** @private */\n  disableTriggerByVisibility_() {\n    if (!this.visibilityUnlisteners_) {\n      return;\n    }\n    this.visibilityUnlisteners_.forEach(unlistener => unlistener());\n    this.visibilityUnlisteners_ = null; // GC\n  }\n\n  /**\n   * @param {!Element} icon\n   * @param {boolean} isPlaying\n   * @private\n   */\n  playOrPauseIconAnim_(icon, isPlaying) {\n    this.video.mutateElement(() =>\n      icon.classList.toggle('amp-video-eq-play', isPlaying));\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {ActionTrust} from '../../action-constants';\nimport {\n  PlayingStates,\n  VideoAttributes,\n  VideoEvents,\n} from '../../video-interface';\nimport {\n  PositionObserver, // eslint-disable-line no-unused-vars\n} from '../position-observer/position-observer-impl';\nimport {\n  PositionObserverFidelity,\n} from '../position-observer/position-observer-worker';\nimport {Services} from '../../services';\nimport {closestBySelector, isRTL, removeElement} from '../../dom';\nimport {createCustomEvent} from '../../event-helper';\n// Source for this constant is css/video-docking.css:\nimport {cssText} from '../../../build/video-docking.css.js';\nimport {dev, user} from '../../log';\nimport {dict} from '../../utils/object';\nimport {getInternalVideoElementFor} from '../../utils/video';\nimport {getServiceForDoc} from '../../service';\nimport {htmlFor, htmlRefs} from '../../static-template';\nimport {\n  installPositionObserverServiceForDoc,\n} from '../position-observer/position-observer-impl';\nimport {installStylesForDoc} from '../../style-installer';\nimport {isFiniteNumber} from '../../types';\nimport {listen, listenOnce} from '../../event-helper';\nimport {mapRange} from '../../utils/math';\nimport {moveLayoutRect} from '../../layout-rect';\nimport {once} from '../../utils/function';\nimport {px, resetStyles, setImportantStyles, translate} from '../../style';\n\n\n/** @private @const {number} */\nconst MARGIN_MAX = 30;\n\n/** @private {number} */\nconst MARGIN_AREA_WIDTH_PERC = 0.04;\n\n/** @private @const {number} */\nconst MIN_WIDTH = 180;\n\n/** @private @const {number} */\nconst MIN_VIEWPORT_WIDTH = 320;\n\n/** @private @const {number} */\nconst DOCKING_TIMEOUT = 200;\n\n/** @private @const {number} */\nconst CONTROLS_TIMEOUT = 1600;\n\n/** @private @const {number} */\nconst CONTROLS_TIMEOUT_AFTER_IX = 1000;\n\n/** @private @const {number} */\nconst FLOAT_TOLERANCE = 0.02;\n\n/** @private @const {string} */\nconst BASE_CLASS_NAME = 'i-amphtml-video-docked';\n\n/** @private @const {number} */\nconst REVERT_TO_INLINE_RATIO = 0.7;\n\n/** @enum */\nexport const RelativeX = {LEFT: 0, RIGHT: 1};\n\n/** @enum */\nexport const RelativeY = {TOP: 0, BOTTOM: 1};\n\n/** @enum */\nexport const Direction = {UP: 1, DOWN: -1};\n\n/** @enum {string} */\nexport const Actions = {DOCK: 'dock', UNDOCK: 'undock'};\n\n\n/**\n * @struct @typedef {{\n *   video: !../../video-interface.VideoOrBaseElementDef,\n *   target: !DockTargetDef,\n *   step: number,\n *   triggeredDock: boolean,\n * }}\n */\nlet DockedDef;\n\n\n/**\n * @struct @typedef {{\n *   container: !Element,\n *   dismissButton: !Element,\n *   playButton: !Element,\n *   pauseButton: !Element,\n *   muteButton: !Element,\n *   unmuteButton: !Element,\n *   fullscreenButton: !Element,\n *   dismissContainer: !Element,\n * }}\n */\nlet ControlsDef;\n\n\n/** @typedef {{posX: !RelativeX, posY: !RelativeY}|!Element} */\nlet DockTargetDef;\n\n/**\n * @typedef {{\n *   x: number,\n *   y: number,\n *   targetWidth: number,\n *   targetHeight: number,\n *   initialY: number\n * }}\n */\nlet TargetAreaDef;\n\n\n/**\n * @param {number} x\n * @param {number} y\n * @param {number} scale\n * @return {string}\n */\nconst transform = (x, y, scale) => `translate(${x}px, ${y}px) scale(${scale})`;\n\n\n/**\n * @param {!Element} a\n * @param {!Element} b\n * @private\n */\nfunction swap(a, b) {\n  a.setAttribute('hidden', '');\n  b.removeAttribute('hidden');\n}\n\n\n/**\n * @param {!Window} win\n * @param {function(...*)} fn\n * @return {function(...*)}\n */\nfunction throttleByAnimationFrame(win, fn) {\n  let running = false;\n  return (...args) => {\n    if (running) {\n      return;\n    }\n    running = true;\n    win.requestAnimationFrame(() => {\n      fn.apply(null, args);\n      running = false;\n    });\n  };\n}\n\n\n/**\n * @param {!MouseEvent|!TouchEvent} e\n * @return {{x: number, y: number}}\n * @private\n */\nfunction pointerCoords(e) {\n  const coords = (e.touches) ? e.touches[0] : e;\n  return {\n    x: dev().assertNumber(('x' in coords) ? coords.x : coords.clientX),\n    y: dev().assertNumber(('y' in coords) ? coords.y : coords.clientY),\n  };\n}\n\n\n/**\n * Maps an interpolation step in [0..1] to its position in a range.\n * @param {number} step\n * @param {number} min\n * @param {number} max\n * @return {number}\n */\nfunction mapStep(step, min, max) {\n  return mapRange(step, 0, 1, min, max);\n}\n\n\n/**\n * @param {!Element} element\n * @restricted\n */\nfunction complainAboutPortrait(element) {\n  // Constant named `TAG` per lint rules.\n  const TAG = element.tagName.toUpperCase();\n  const attr = VideoAttributes.DOCK;\n  user().error(TAG,\n      `Minimize-to-corner (\\`${attr}\\`) does not support portrait video.`,\n      element);\n}\n\n\n// Function should ideally be in `dom.js`, but moving it causes a bunch of ads\n// tests to fail, for some reason.\n// TODO(alanorozco): Move.\n/**\n * @param {!Object} obj\n * @return {boolean}\n */\nexport function isElement(obj) {\n  return obj.nodeType == /* ELEMENT */ 1;\n}\n\n\n\n/** Timeout that can be postponed, repeated or cancelled. */\nclass Timeout {\n  /**\n   * @param {!Window} win\n   * @param {!Function} handler\n   */\n  constructor(win, handler) {\n    /** @private @const {!../timer-impl.Timer} */\n    this.timer_ = Services.timerFor(win);\n\n    /** @private @const {!Function} */\n    this.handler_ = handler;\n\n    /** @private {?number|?string} */\n    this.id_ = null;\n  }\n\n  /**\n   * @param {number} time\n   * @param {...*} args\n   */\n  trigger(time, ...args) {\n    this.cancel();\n    this.id_ = this.timer_.delay(() => this.handler_.apply(null, args), time);\n  }\n\n  /** @public */\n  cancel() {\n    if (this.id_ !== null) {\n      this.timer_.cancel(this.id_);\n      this.id_ = null;\n    }\n  }\n\n  /** @return {boolean} */\n  isWaiting() {\n    return this.id_ !== null;\n  }\n}\n\n\n/**\n * Manages docking (a.k.a. minimize to corner) for videos that satisfy the\n * {@see ../../video-interface.VideoInterface}.\n */\nexport class VideoDocking {\n\n  /**\n   * @param {!../ampdoc-impl.AmpDoc} ampdoc\n   * @param {!../video-service-interface.VideoServiceInterface} manager\n   */\n  constructor(ampdoc, manager) {\n\n    /** @private @const {!../ampdoc-impl.AmpDoc} */\n    this.ampdoc_ = ampdoc;\n\n    /** @private @const */\n    this.manager_ = manager;\n\n    /** @private @const {!../viewport/viewport-impl.Viewport} */\n    this.viewport_ = Services.viewportForDoc(ampdoc);\n\n    /** @private {?DockedDef} */\n    this.currentlyDocked_ = null;\n\n    /** @private @const {function():!Timeout} */\n    this.getDockingTimeout_ = this.lazyTimeout_(video =>\n      this.onDockingTimeout_(\n          /** @type {!../../video-interface.VideoOrBaseElementDef} */ (video)));\n\n    /** @private @const {function():!Timeout} */\n    this.getHideControlsTimeout_ = this.lazyTimeout_(() =>\n      this.hideControls_(/* respectSticky */ true));\n\n    /** @private @const {function():!Timeout} */\n    this.getUndockingTimeout_ = this.lazyTimeout_(video =>\n      this.undock_(\n          /** @type {!../../video-interface.VideoOrBaseElementDef} */ (video)));\n\n    /** @private {!RelativeX} */\n    // Overriden when user drags the video to a corner.\n    // Y-corner is determined based on scroll direction.\n    this.preferredCornerX_ =\n        isRTL(this.getDoc_()) ? RelativeX.LEFT : RelativeX.RIGHT;\n\n    /**\n     * Returns an element representing a shadow under the docked video.\n     * Alternatively, we could use box-shadow on the video element, but in\n     * order to animate it without jank we have to use an opacity transition.\n     * A separate layer also has the 1d benefit that authors can override its\n     * box-shadow value or any other styling without handling the transition\n     * themselves.\n     * @private @const {function():!Element}\n     */\n    this.getShadowLayer_ = once(() => this.append_(htmlFor(this.getDoc_())`\n      <div class=\"amp-video-docked-shadow\" hidden></div>`));\n\n    /**\n     * Returns an overlay to be used to capture different user events.\n     * @private @const {function():!Element}\n     */\n    this.getOverlay_ = once(() => this.installOverlay_(htmlFor(this.getDoc_())`\n      <div class=\"i-amphtml-video-docked-overlay\" hidden></div>`));\n\n    /** @private @const {function():!ControlsDef} */\n    this.getControls_ = once(() => this.installControls_(\n        // This currently bloats the resulting binary with\n        // 1. some whitespace and 2. duplicate declarations of equal strings.\n        // Upcoming fixes: #14657, #14658.\n        // TODO(alanorozco): Cleanup markup for readability once fixes land.\n        htmlFor(this.getDoc_())`\n          <div class=\"amp-video-docked-controls\" hidden>\n            <div class=\"amp-video-docked-main-button-group\">\n              <div class=\"amp-video-docked-button-group\">\n                <div role=\"button\" ref=\"playButton\"\n                    class=\"amp-video-docked-play\"></div>\n                <div role=\"button\" ref=\"pauseButton\"\n                    class=\"amp-video-docked-pause\"></div>\n              </div>\n              <div class=\"amp-video-docked-button-group\">\n                <div role=\"button\" ref=\"muteButton\"\n                    class=\"amp-video-docked-mute\"></div>\n                <div role=\"button\" ref=\"unmuteButton\"\n                    class=\"amp-video-docked-unmute\">\n                </div>\n              </div>\n              <div class=\"amp-video-docked-button-group\">\n                <div role=\"button\" ref=\"fullscreenButton\"\n                    class=\"amp-video-docked-fullscreen\">\n                </div>\n              </div>\n            </div>\n            <div class=\"amp-video-docked-button-dismiss-group\"\n                ref=\"dismissContainer\">\n              <div role=\"button\" ref=\"dismissButton\"\n                  class=\"amp-video-docked-dismiss\"></div>\n            </div>\n          </div>`));\n\n    /** @private {?../../video-interface.VideoOrBaseElementDef} */\n    this.lastDismissed_ = null;\n\n    /** @private {?RelativeY} */\n    this.lastDismissedPosY_ = null;\n\n    /**\n     * Unlisteners for the currently minimized video.\n     * @private {!Array<!UnlistenDef>}\n     */\n    this.videoUnlisteners_ = [];\n\n    /**\n     * Memoizes x, y and scale to prevent useless mutations.\n     * @private {?{x: number, y: number, scale: number}}\n     */\n    this.placedAt_ = null;\n\n    /** @private {?{width: number, height: number}} */\n    this.sizedAt_ = null;\n\n    /** @private {?Direction} */\n    this.scrollDirection_ = null;\n\n    /** @private {number} */\n    this.lastScrollTop_ = this.viewport_.getScrollTop();\n\n    /** @private {boolean} */\n    this.stickyControls_ = false;\n\n    /** @private {boolean} */\n    this.isDragging_ = false;\n\n    /** @private {!Array<!../../video-interface.VideoOrBaseElementDef>} */\n    this.observed_ = [];\n\n    /** @private @const {!function()} */\n    // Lazily invoked.\n    this.install_ = once(() => {\n      this.viewport_.onScroll(\n          throttleByAnimationFrame(this.ampdoc_.win,\n              () => this.updateScroll_()));\n\n      this.viewport_.onResize(() => this.updateAllOnResize_());\n\n      this.installStyles_();\n    });\n\n    /** @private @const {function():?Element} */\n    this.getSlot_ = once(() => this.querySlot_());\n\n    /** @private */\n    this.hideControlsOnTapOutsideOnce_ =\n        once(() => this.hideControlsOnTapOutside_());\n  }\n\n  /**\n   * @return {?Element}\n   * @private\n   */\n  querySlot_() {\n    const root = this.ampdoc_.getRootNode();\n\n    // For consistency always honor the dock attribute on the first el in page.\n    const video = root.querySelector('[dock]');\n\n    dev().assertElement(video);\n\n    user().assert(video.signals().get(VideoEvents.REGISTERED),\n        '`dock` attribute can only be set on video components.');\n\n    const slotSelector = video.getAttribute('dock').trim();\n\n    if (slotSelector == '') {\n      return null;\n    }\n\n    const el = root.querySelector(slotSelector);\n\n    if (el) {\n      user().assert(el.tagName.toLowerCase() == 'amp-layout',\n          'Dock slot must be an <amp-layout> element.');\n    }\n\n    return el;\n  }\n\n  /** @private */\n  installStyles_() {\n    installStylesForDoc(\n        this.ampdoc_,\n        cssText,\n        /* callback */ null,\n        /* opt_isRuntimeCss */ false,\n        /* opt_ext */ 'amp-video-docking');\n  }\n\n  /**\n   * @param {function(...*)} fn\n   * @return {function():!Timeout}\n   * @private\n   */\n  lazyTimeout_(fn) {\n    return once(() => new Timeout(this.ampdoc_.win, fn));\n  }\n\n  /** @private */\n  updateAllOnResize_() {\n    this.observed_.forEach(video => this.updateOnResize_(video));\n  }\n\n  /** @param {!../../video-interface.VideoOrBaseElementDef} video */\n  register(video) {\n    this.install_();\n\n    const {element} = video;\n    const fidelity = PositionObserverFidelity.HIGH;\n    this.getPositionObserver_().observe(element, fidelity,\n        () => this.updateOnPositionChange_(video));\n    this.observed_.push(video);\n  }\n\n  /** @private */\n  updateScroll_() {\n    const scrollTop = this.viewport_.getScrollTop();\n    const scrollDirection = scrollTop > this.lastScrollTop_ ?\n      Direction.UP :\n      Direction.DOWN;\n    this.scrollDirection_ = scrollDirection;\n    this.lastScrollTop_ = scrollTop;\n  }\n\n  /**\n   * @return {!Document}\n   * @private\n   */\n  getDoc_() {\n    return /** @type {!Document} */ (this.ampdoc_.getRootNode());\n  }\n\n  /**\n   * @param {!Element} element\n   * @return {!Element}\n   * @private\n   */\n  append_(element) {\n    const root = this.getDoc_().body || this.getDoc_();\n    return dev().assertElement(root.appendChild(element));\n  }\n\n  /**\n   * @param {!Element} overlay\n   * * @return {!Element}\n   * @private\n   */\n  installOverlay_(overlay) {\n    this.append_(overlay);\n    return this.showControlsOnTap_(this.addDragListeners_(overlay));\n  }\n\n  /** @private */\n  enterFullscreen_() {\n    const video = this.getDockedVideo_();\n    video.fullscreenEnter();\n  }\n\n  /**\n   * @param {!Element} element\n   * @return {!Element}\n   * @private\n   */\n  showControlsOnTap_(element) {\n    listen(element, 'mouseup', () => {\n      if (this.isDragging_) {\n        return;\n      }\n      const video = this.getDockedVideo_();\n      const {\n        container,\n        playButton,\n        pauseButton,\n        muteButton,\n        unmuteButton,\n      } = this.getControls_();\n      const overlay = this.getOverlay_();\n\n      container.removeAttribute('hidden');\n      container.classList.add('amp-video-docked-controls-shown');\n      overlay.classList.add('amp-video-docked-controls-bg');\n\n      if (this.isPlaying_()) {\n        swap(playButton, pauseButton);\n      } else {\n        swap(pauseButton, playButton);\n      }\n\n      if (this.manager_.isMuted(\n          /** @type {!../../video-interface.VideoInterface} */ (video))) {\n        swap(muteButton, unmuteButton);\n      } else {\n        swap(unmuteButton, muteButton);\n      }\n\n      this.hideControlsOnTimeout_();\n    });\n    return element;\n  }\n\n  /** @private */\n  hideControlsOnTapOutside_() {\n    listen(this.ampdoc_.getRootNode(), 'mousedown', e => {\n      if (!this.currentlyDocked_) {\n        return;\n      }\n      if (this.isControlsEventTarget_(dev().assertElement(e.target))) {\n        return;\n      }\n      this.hideControls_(/* respectSticky */ true);\n    });\n  }\n\n  /**\n   * @param {!Element} element\n   * @return {!Element}\n   * @private\n   */\n  addDragListeners_(element) {\n    const handler = e => this.drag_(/** @type {!TouchEvent} */(e));\n\n    listen(element, 'touchstart', handler);\n    listen(element, 'mousedown', handler);\n\n    return element;\n  }\n\n  /**\n   * @param {!Element} container\n   * @return {!ControlsDef}\n   * @private\n   */\n  installControls_(container) {\n    const controls = htmlRefs(container);\n\n    const {\n      dismissButton,\n      playButton,\n      pauseButton,\n      unmuteButton,\n      muteButton,\n      fullscreenButton,\n    } = controls;\n\n    Object.assign(controls, {container});\n\n    this.listenWhenNotDragging_(dismissButton, 'click', () => {\n      this.dismissOnTap_();\n    });\n\n    this.listenWhenNotDragging_(playButton, 'click', () => {\n      this.getDockedVideo_().play(/* auto */ false);\n    });\n\n    this.listenWhenNotDragging_(pauseButton, 'click', () => {\n      this.getDockedVideo_().pause();\n    });\n\n    this.listenWhenNotDragging_(muteButton, 'click', () => {\n      this.getDockedVideo_().mute();\n    });\n\n    this.listenWhenNotDragging_(unmuteButton, 'click', () => {\n      this.getDockedVideo_().unmute();\n    });\n\n    this.listenWhenNotDragging_(fullscreenButton, 'click', () => {\n      this.enterFullscreen_();\n    });\n\n    listen(container, 'mouseup', () =>\n      this.hideControlsOnTimeout_(CONTROLS_TIMEOUT_AFTER_IX));\n\n    this.addDragListeners_(container);\n    this.append_(container);\n\n    return /** @type {!ControlsDef} */ (controls);\n  }\n\n  /**\n   * @param {!Element} element\n   * @param {string} eventType\n   * @param {function(!Event)} handler\n   */\n  listenWhenNotDragging_(element, eventType, handler) {\n    listen(element, eventType, e => {\n      if (this.isDragging_) {\n        return;\n      }\n      handler(e);\n    });\n  }\n\n  /** @private */\n  dismissOnTap_() {\n    this.undock_(this.getDockedVideo_());\n  }\n\n  /**\n   * @return {!../../video-interface.VideoOrBaseElementDef}\n   * @private\n   */\n  getDockedVideo_() {\n    return dev().assert(this.currentlyDocked_).video;\n  }\n\n  /**\n   * @return {!PositionObserver}\n   * @private\n   */\n  getPositionObserver_() {\n    installPositionObserverServiceForDoc(this.ampdoc_);\n\n    // No getter in services.js.\n    return /** @type {!PositionObserver} */ (\n      getServiceForDoc(this.ampdoc_, 'position-observer'));\n  }\n\n  /**\n   * Reconciles the state of a docked or potentially dockable video when\n   * the viewport/position changes.\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @return {?DockTargetDef}\n   * @private\n   */\n  getTargetFor_(video) {\n    if (this.isDragging_ ||\n        this.ignoreDueToSize_(video) ||\n        this.ignoreBecauseAnotherDocked_(video) ||\n        this.ignoreDueToNotPlayingManually_(video) ||\n        this.undockBecauseVisible_(video)) {\n      return null;\n    }\n    if (this.canUpdateFromSlot_(video)) {\n      return this.getSlot_();\n    }\n    const posY = this.maybeGetRelativeY_(video);\n    if (posY === null) {\n      return posY;\n    }\n    return {posY, posX: this.getRelativeX_()};\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @return {boolean}\n   * @private\n   */\n  canUpdateFromSlot_(video) {\n    if (!this.slotHasDimensions_()) {\n      return false;\n    }\n    const relativeY = this.getSlotRelativeY_();\n    const {element} = video;\n    const {top, bottom} = element.getIntersectionChangeEntry().intersectionRect;\n    const {top: slotTop, height: slotHeight} = this.getFixedSlotLayoutBox_();\n    const slotBottom = this.viewport_.getSize().height - slotHeight - slotTop;\n    if (relativeY == RelativeY.TOP) {\n      return top <= slotTop;\n    }\n    return bottom >= slotBottom;\n  }\n\n  /**\n   * @return {!../../layout-rect.LayoutRectDef}\n   * @private\n   */\n  getFixedSlotLayoutBox_() {\n    const rect = dev().assertElement(this.getSlot_()).getLayoutBox();\n    const dy = -this.viewport_.getScrollTop();\n    return moveLayoutRect(rect, /* dx */ 0, dy);\n  }\n\n  /**\n   * @return {boolean}\n   * @private\n   */\n  slotHasDimensions_() {\n    const el = this.getSlot_();\n    if (!el) {\n      return false;\n    }\n    const {width, height} = this.getFixedSlotLayoutBox_();\n    return width > 0 && height > 0;\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @private\n   */\n  updateOnResize_(video) {\n    const target = this.getTargetFor_(video);\n    if (!target) {\n      return;\n    }\n    this.dock_(video, target);\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @private\n   */\n  updateOnPositionChange_(video) {\n    const target = this.getTargetFor_(video);\n    if (!target) {\n      return;\n    }\n    this.dockOnPositionChange_(video, target);\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @param {number=} ratio\n   * @param {number=} timeout\n   * @return {boolean}\n   */\n  undockBecauseVisible_(video, ratio = 1, timeout = 40) {\n    const {element} = video;\n    if (this.currentlyDocked_ && this.isVisible_(element, ratio)) {\n      if (!this.getUndockingTimeout_().isWaiting()) {\n        this.getUndockingTimeout_().trigger(timeout, video);\n      }\n      return true;\n    }\n    this.getUndockingTimeout_().cancel();\n    return false;\n  }\n\n  /**\n   * @param  {!../../video-interface.VideoOrBaseElementDef} video\n   * @return {boolean}\n   */\n  ignoreDueToNotPlayingManually_(video) {\n    return !this.currentlyDocked_ && !this.isPlaying_(video);\n  }\n\n  /**\n   * @param  {!../../video-interface.VideoOrBaseElementDef} video\n   * @return {boolean}\n   */\n  ignoreBecauseAnotherDocked_(video) {\n    return !!this.currentlyDocked_ && !this.isCurrentlyDocked_(video);\n  }\n\n  /**\n   * @param  {!../../video-interface.VideoOrBaseElementDef} video\n   * @return {boolean}\n   */\n  ignoreDueToSize_(video) {\n    const {width, height} = video.getLayoutBox();\n    if ((width / height) < 1) {\n      complainAboutPortrait(video.element);\n      return true;\n    }\n    if (this.getAreaWidth_() < MIN_VIEWPORT_WIDTH) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * @return {number}\n   * @private\n   */\n  getTopEdge_() {\n    return 0;\n  }\n\n  /**\n   * @return {number}\n   * @private\n   */\n  getBottomEdge_() {\n    return this.viewport_.getSize().height;\n  }\n\n  /**\n   * @return {number}\n   * @private\n   */\n  getLeftEdge_() {\n    return 0;\n  }\n\n  /**\n   * @return {number}\n   * @private\n   */\n  getRightEdge_() {\n    return this.viewport_.getSize().width;\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @return {?RelativeY}\n   * @private\n   */\n  maybeGetRelativeY_(video) {\n    if (this.slotHasDimensions_()) {\n      return null;\n    }\n    if (this.isCurrentlyDocked_(video)) {\n      const {posY} = dev().assert(this.currentlyDocked_).target;\n      return /** @type {!RelativeY} */ (dev().assertNumber(posY));\n    }\n    const {element} = video;\n    const {top, bottom} = element.getIntersectionChangeEntry().intersectionRect;\n    if (top <= this.getTopEdge_() &&\n        this.scrollDirection_ == Direction.UP) {\n      return RelativeY.TOP;\n    }\n    if (bottom >= this.getBottomEdge_() &&\n        this.scrollDirection_ == Direction.DOWN) {\n      return RelativeY.BOTTOM;\n    }\n    return null;\n  }\n\n  /**\n   * @return {!RelativeX}\n   * @private\n   */\n  getRelativeX_() {\n    return this.preferredCornerX_;\n  }\n\n  /**\n   * @return {number}\n   * @private\n   */\n  getMargin_() {\n    return Math.min(MARGIN_MAX, MARGIN_AREA_WIDTH_PERC * this.getAreaWidth_());\n  }\n\n  /**\n   * @return {number}\n   * @private\n   */\n  getAreaWidth_() {\n    return this.getRightEdge_() - this.getLeftEdge_();\n  }\n\n  /**\n   * @param {?../../video-interface.VideoOrBaseElementDef} optVideo\n   * @return {boolean}\n   * @private\n   */\n  isPlaying_(optVideo = null) {\n    const video = /** @type {!../../video-interface.VideoInterface} */ (\n      optVideo || this.getDockedVideo_());\n    return this.manager_.getPlayingState(video) == PlayingStates.PLAYING_MANUAL;\n  }\n\n  /**\n   * @param {number} dirX\n   * @param {number} dirY\n   * @private\n   */\n  dismiss_(dirX = 0, dirY = 0) {\n    const video = this.getDockedVideo_();\n    const {posY} = this.currentlyDocked_.target;\n    video.pause();\n    this.lastDismissed_ = video;\n    this.lastDismissedPosY_ = posY || null;\n    this.undock_(video, dirX, dirY);\n  }\n\n  /**\n   * @return {boolean}\n   * @private\n   */\n  currentPositionMatchesScroll_() {\n    if (!this.currentlyDocked_) {\n      return false;\n    }\n    if (this.isDockedToSlot_()) {\n      return this.positionMatchesScroll_(this.getSlotRelativeY_());\n    }\n    if (this.currentlyDocked_.target.posY == null) {\n      return false;\n    }\n    return this.positionMatchesScroll_(this.currentlyDocked_.target.posY);\n  }\n\n  /**\n   * @return {!RelativeY}\n   * @private\n   */\n  getSlotRelativeY_() {\n    const {top, height} = this.getFixedSlotLayoutBox_();\n    const vh = this.viewport_.getSize().height;\n    const bottom = vh - height - top;\n    return bottom > top ? RelativeY.TOP : RelativeY.BOTTOM;\n  }\n\n  /**\n   * @param {!RelativeY} posY\n   * @return {boolean}\n   * @private\n   */\n  positionMatchesScroll_(posY) {\n    const direction = this.scrollDirection_;\n    return (\n      (posY == RelativeY.TOP && direction == Direction.UP) ||\n      (posY == RelativeY.BOTTOM && direction == Direction.DOWN));\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @param {!DockTargetDef} target\n   * @private\n   */\n  dockOnPositionChange_(video, target) {\n    if (this.ignoreDueToDismissal_(video)) {\n      return;\n    }\n\n    const step = this.calculateStep_(video.element, target);\n    if (this.ignoreDueToTransitionEnd_(step)) {\n      return;\n    }\n\n    this.dock_(video, target, step);\n\n    this.getDockingTimeout_().trigger(DOCKING_TIMEOUT, video);\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @param {!DockTargetDef} target\n   * @param {?number=} opt_step\n   * @private\n   */\n  dock_(video, target, opt_step = null) {\n    const step =\n      isFiniteNumber(opt_step) ?\n        dev().assertNumber(opt_step) :\n        this.calculateStep_(video.element, target);\n\n    if (step < 0.01) {\n      return;\n    }\n\n    if (step >= REVERT_TO_INLINE_RATIO &&\n        this.currentlyDocked_ &&\n        !this.currentlyDocked_.triggeredDock) {\n      this.trigger_(video, Actions.DOCK);\n      this.currentlyDocked_.triggeredDock = true;\n    }\n\n    // Component background is now visible, so hide the poster for the Android\n    // workaround so authors can style the component container as they like.\n    // (see `AmpVideo#createPosterForAndroidBug_`).\n    this.removePosterForAndroidBug_(video.element);\n\n    const {x, y, scale} = this.getDims_(video, target, step);\n    video.hideControls();\n    this.placeAt_(video, x, y, scale, step);\n    this.setCurrentlyDocked_(video, target, step);\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @param {!Actions} action\n   * @private\n   */\n  trigger_(video, action) {\n    const trust = ActionTrust.LOW;\n    const event = createCustomEvent(this.ampdoc_.win,\n        /** @type {string} */ (action), /* detail */ dict({}));\n    const actions = Services.actionServiceForDoc(this.ampdoc_);\n    actions.trigger(video.element, action, event, trust);\n  }\n\n  /**\n   * @param  {!../../video-interface.VideoOrBaseElementDef} video\n   * @return {boolean}\n   * @private\n   */\n  ignoreDueToDismissal_(video) {\n    if (this.lastDismissed_ != video) {\n      return false;\n    }\n    if (this.lastDismissedPosY_ !== null &&\n        !this.positionMatchesScroll_(this.lastDismissedPosY_)) {\n      return false;\n    }\n    if (this.isVisible_(video.element, FLOAT_TOLERANCE)) {\n      this.resetDismissed_();\n    }\n    return true;\n  }\n\n  /** @private */\n  resetDismissed_() {\n    this.lastDismissed_ = null;\n    this.lastDismissedPosY_ = null;\n  }\n\n  /**\n   * Prevents jump when the transition was timed out before user finished\n   * scrolling component out of view.\n   * @param {number} step\n   * @return {boolean}\n   */\n  ignoreDueToTransitionEnd_(step) {\n    return this.hasTransitionCompleted_(step) &&\n        this.currentPositionMatchesScroll_();\n  }\n\n  /**\n   * @param {!AmpElement} element\n   * @param {!DockTargetDef} target\n   * @return {number}\n   * @private\n   */\n  calculateStep_(element, target) {\n    // Aggressively reduce ratio to prevent covering vertical space.\n    const ratio = this.calculateIntersectionRatio_(element, target);\n    return 1 - Math.pow(ratio, 3);\n  }\n\n  /**\n   * @param {!AmpElement} element\n   * @param {?DockTargetDef=} target\n   * @return {number}\n   * @private\n   */\n  calculateIntersectionRatio_(element, target = null) {\n    if (target == null || !isElement(target)) {\n      return element.getIntersectionChangeEntry().intersectionRatio;\n    }\n\n    const {top, bottom, height} = element.getLayoutBox();\n    const {top: slotTop, bottom: slotBottom} = this.getSlot_().getLayoutBox();\n\n    if (this.getSlotRelativeY_() == RelativeY.TOP) {\n      return (bottom - Math.max(top, slotTop)) / height;\n    } else {\n      return (slotBottom - top) / height;\n    }\n  }\n\n  /**\n   * @param {number} step\n   * @return {number}\n   */\n  calculateTransitionDuration_(step) {\n    const maxAutoTransitionDurationMs = 500;\n    if (!this.currentlyDocked_) {\n      // Don't animate first frame. Browsers sometimes behave weirdly and use\n      // a stale transform value, thus causing it to visually jump.\n      return 0;\n    }\n    const remaining = Math.abs(step - this.currentlyDocked_.step);\n    return remaining * maxAutoTransitionDurationMs;\n  }\n\n  /**\n   * @param {number} x\n   * @param {number} y\n   * @param {number} scale\n   * @return {boolean}\n   */\n  alreadyPlacedAt_(x, y, scale) {\n    return !!this.placedAt_ &&\n        this.placedAt_.x == x &&\n        this.placedAt_.y == y &&\n        this.placedAt_.scale == scale;\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @param {number} x\n   * @param {number} y\n   * @param {number} scale\n   * @param {number} step in [0..1]\n   * @param {?number} optTransitionDurationMs\n   * @private\n   */\n  placeAt_(video, x, y, scale, step, optTransitionDurationMs = null) {\n    if (this.alreadyPlacedAt_(x, y, scale)) {\n      return;\n    }\n\n    const transitionDurationMs = optTransitionDurationMs ?\n      dev().assertNumber(optTransitionDurationMs) :\n      this.calculateTransitionDuration_(step);\n\n    const {width, height} = video.getLayoutBox();\n\n    this.placedAt_ = {x, y, scale};\n\n    const transitionTiming =\n        // Auto-transitions are supposed to smooth-out PositionObserver\n        // frequency, so it makes sense to use 'linear'. When the transition\n        // duration is otherwise larger, 'ease-in' looks much nicer.\n        transitionDurationMs > 200 ? 'ease-in' : 'linear';\n\n    const positioningStyles = {\n      'transform': transform(x, y, scale),\n      'transition-duration': `${transitionDurationMs}ms`,\n      'transition-timing-function': transitionTiming,\n    };\n\n    if (this.boxNeedsSizing_(width, height)) {\n      // Setting explicit dimensions is needed to match the video's aspect\n      // ratio. However, we only do this once to prevent jank in subsequent\n      // frames.\n      Object.assign(positioningStyles, {\n        'width': px(width),\n        'height': px(height),\n      });\n    }\n\n    const internalElement = getInternalVideoElementFor(video.element);\n    const shadowLayer = this.getShadowLayer_();\n    const overlay = this.getOverlay_();\n    const {\n      container: controls,\n      dismissContainer,\n    } = this.getControls_();\n\n    video.mutateElement(() => {\n      internalElement.classList.add(BASE_CLASS_NAME);\n      shadowLayer.removeAttribute('hidden');\n      overlay.removeAttribute('hidden');\n      setImportantStyles(internalElement, positioningStyles);\n      setImportantStyles(shadowLayer, positioningStyles);\n      setImportantStyles(overlay, positioningStyles);\n      setImportantStyles(shadowLayer, {\n        'opacity': step,\n      });\n      const halfScale = scale / 2;\n      const centerX = x + (width * halfScale);\n      const centerY = y + (height * halfScale);\n      setImportantStyles(controls, {\n        'transform': translate(centerX, centerY),\n      });\n      const dismissMargin = 8;\n      const dismissWidth = 40;\n      const dismissX = width * halfScale - dismissMargin - dismissWidth;\n      const dismissY = -(height * halfScale - dismissMargin - dismissWidth);\n      setImportantStyles(dismissContainer, {\n        'transform': translate(dismissX, dismissY),\n      });\n    });\n  }\n\n  /**\n   * @param  {number} width\n   * @param  {number} height\n   * @return {boolean}\n   * @private\n   */\n  boxNeedsSizing_(width, height) {\n    const needsSizing =\n        !this.sizedAt_ ||\n        this.sizedAt_.width != width ||\n        this.sizedAt_.height != height;\n    if (needsSizing) {\n      this.sizedAt_ = {width, height};\n    }\n    return needsSizing;\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @return {boolean}\n   */\n  isCurrentlyDocked_(video) {\n    return !!this.currentlyDocked_ && this.currentlyDocked_.video == video;\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @param {!DockTargetDef} target\n   * @param {number} step\n   */\n  setCurrentlyDocked_(video, target, step) {\n    if (!this.isCurrentlyDocked_(video)) {\n      this.updateControlsBasedOn_(video.element);\n    }\n\n    const {triggeredDock} = this.currentlyDocked_ || {triggeredDock: false};\n    this.currentlyDocked_ = {video, target, step, triggeredDock};\n\n    this.hideControlsOnTapOutsideOnce_();\n  }\n\n  /**\n   * @param {!Element} video\n   * @private\n   */\n  updateControlsBasedOn_(video) {\n    while (this.videoUnlisteners_.length) {\n      this.videoUnlisteners_.pop().call();\n    }\n    this.videoUnlisteners_ = [\n      listen(video, VideoEvents.PLAYING, () => this.onPlay_()),\n      listen(video, VideoEvents.PAUSE, () => this.onPause_()),\n      listen(video, VideoEvents.MUTED, () => this.onMute_()),\n      listen(video, VideoEvents.UNMUTED, () => this.onUnmute_()),\n    ];\n  }\n\n  /** @private */\n  onPlay_() {\n    const {playButton, pauseButton} = this.getControls_();\n    this.stickyControls_ = false;\n    swap(playButton, pauseButton);\n  }\n\n  /** @private */\n  onPause_() {\n    const {pauseButton, playButton} = this.getControls_();\n    this.stickyControls_ = true;\n    swap(pauseButton, playButton);\n  }\n\n  /** @private */\n  onMute_() {\n    const {muteButton, unmuteButton} = this.getControls_();\n    swap(muteButton, unmuteButton);\n  }\n\n  /** @private */\n  onUnmute_() {\n    const {unmuteButton, muteButton} = this.getControls_();\n    swap(unmuteButton, muteButton);\n  }\n\n  /**\n   * @param {number} offsetX\n   * @param {number} offsetY\n   * @private\n   */\n  offset_(offsetX, offsetY) {\n    const video = this.getDockedVideo_();\n    const {target} = this.currentlyDocked_;\n\n    const step = 1;\n\n    const {x, y, scale} = this.getDims_(video, target, step);\n    this.placeAt_(video, x + offsetX, y + offsetY, scale, step,\n        /* transitionDurationMs */ 0);\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @private\n   */\n  onDockingTimeout_(video) {\n    if (this.isDragging_ ||\n        this.ignoreBecauseAnotherDocked_(video) ||\n        !this.currentlyDocked_ ||\n        (!this.currentPositionMatchesScroll_() &&\n            this.undockBecauseVisible_(\n                video, REVERT_TO_INLINE_RATIO, /* timeout */ 50))) {\n      return;\n    }\n    const {target} = dev().assert(this.currentlyDocked_);\n    this.dock_(video, target, /* step */ 1);\n  }\n\n  /**\n   * @param {!AmpElement} element\n   * @param {number=} minRatio\n   * @return {boolean}\n   */\n  isVisible_(element, minRatio = 1) {\n    const target = this.slotHasDimensions_() ? this.getSlot_() : null;\n    const intersectionRatio = this.calculateIntersectionRatio_(element, target);\n    return intersectionRatio > (minRatio - FLOAT_TOLERANCE);\n  }\n\n  /**\n   * @param {number} amount\n   * @return {boolean}\n   * @private\n   */\n  hasTransitionCompleted_(amount = 1) {\n    return !!this.currentlyDocked_ &&\n        this.currentlyDocked_.step >= (amount - FLOAT_TOLERANCE);\n  }\n\n  /**\n   * @param {!MouseEvent|!TouchEvent} e\n   * @private\n   */\n  drag_(e) {\n    if (!this.currentlyDocked_) {\n      return;\n    }\n\n    if (this.isDockedToSlot_()) {\n      return;\n    }\n\n    // Don't allow dragging videos that are too early in their transition phase.\n    // This allows the user to keep scrolling while touching the inline/almost\n    // inline video area.\n    if (!this.hasTransitionCompleted_(0.75)) {\n      return;\n    }\n\n    const {x: initialX, y: initialY} = pointerCoords(e);\n\n    const offset = {x: 0, y: 0};\n    const {posX: currentPosX, posY: currentPosY} = this.currentlyDocked_.target;\n\n    const onDragMove = throttleByAnimationFrame(this.ampdoc_.win,\n        e => this.onDragMove_(\n            /** @type {!TouchEvent|!MouseEvent} */ (e),\n            currentPosX, currentPosY, initialX, initialY, offset));\n\n    const onDragEnd = () => this.onDragEnd_(unlisteners, offset);\n\n    const root = this.ampdoc_.getRootNode();\n    const unlisteners = [\n      this.disableScroll_(),\n      this.disableUserSelect_(),\n      this.workaroundWebkitDragAndScrollIssue_(),\n      listen(root, 'touchmove', onDragMove),\n      listen(root, 'mousemove', onDragMove),\n      listenOnce(root, 'touchend', onDragEnd),\n      listenOnce(root, 'mouseup', onDragEnd),\n    ];\n  }\n\n  /**\n   * @return {boolean}\n   * @private\n   */\n  isDockedToSlot_() {\n    if (!this.currentlyDocked_) {\n      return false;\n    }\n    return isElement(this.currentlyDocked_.target);\n  }\n\n  /**\n   * @return {!UnlistenDef}\n   * @private\n   */\n  disableUserSelect_() {\n    const docEl = dev().assertElement(this.getDoc_().documentElement);\n    const disabledClassName = 'i-amphtml-select-disabled';\n    docEl.classList.add(disabledClassName);\n    return () => docEl.classList.remove(disabledClassName);\n  }\n\n  /**\n   * @return {!UnlistenDef}\n   * @private\n   */\n  disableScroll_() {\n    this.viewport_.disableScroll();\n    return this.viewport_.resetScroll.bind(this.viewport_);\n  }\n\n  /**\n   * @param {!MouseEvent|!TouchEvent} e\n   * @param {!RelativeX} startPosX\n   * @param {!RelativeY} startPosY\n   * @param {number} startX\n   * @param {number} startY\n   * @param {{x: number, y: number}} offset\n   * @private\n   */\n  onDragMove_(e, startPosX, startPosY, startX, startY, offset) {\n    const {posX, posY} = this.currentlyDocked_.target;\n    if (posX !== startPosX || posY !== startPosY) {\n      // stale event\n      return;\n    }\n\n    const {x, y} = pointerCoords(e);\n    offset.x = x - startX;\n    offset.y = y - startY;\n\n    // Prevents dragging misfires.\n    const offsetDist = Math.sqrt(Math.pow(offset.x, 2) + Math.pow(offset.y, 2));\n    if (offsetDist <= 10) {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.hideControls_();\n    this.isDragging_ = true;\n    this.offset_(offset.x, offset.y);\n    this.updateDismissalAreaStyling_(offset.x, offset.y);\n  }\n\n  /**\n   * @param {number} offsetX\n   * @param {number} offsetY\n   * @private\n   */\n  updateDismissalAreaStyling_(offsetX, offsetY) {\n    const video = this.getDockedVideo_();\n    const {element} = video;\n    const internalElement = getInternalVideoElementFor(element);\n    const inDismissalArea = this.inDismissalArea_(offsetX, offsetY);\n\n    video.mutateElement(() => {\n      const className = 'amp-video-docked-almost-dismissed';\n      internalElement.classList.toggle(className, inDismissalArea);\n      this.getOverlay_().classList.toggle(className, inDismissalArea);\n    });\n  }\n\n  /**\n   * Works around https://bugs.webkit.org/show_bug.cgi?id=184250\n   * @return {!UnlistenDef}\n   * @private\n   */\n  workaroundWebkitDragAndScrollIssue_() {\n    const {win} = this.ampdoc_;\n    if (!Services.platformFor(win).isIos()) {\n      return () => { /* NOOP */ };\n    }\n    const handler = e => e.preventDefault();\n    win.addEventListener('touchmove', handler, {passive: false});\n    return () => win.removeEventListener('touchmove', handler);\n  }\n\n  /**\n   * @param {!Array<!UnlistenDef>} unlisteners\n   * @param {{x: number, y: number}} offset\n   * @private\n   */\n  onDragEnd_(unlisteners, offset) {\n    unlisteners.forEach(unlisten => unlisten.call());\n\n    this.isDragging_ = false;\n\n    if (this.dismissOnDragEnd_(offset.x, offset.y)) {\n      return;\n    }\n\n    this.snapToCorner_(offset.x, offset.y);\n  }\n\n  /**\n   * @param {number} offsetX\n   * @param {number} offsetY\n   * @private\n   */\n  dismissOnDragEnd_(offsetX, offsetY) {\n    const inDimissalArea = this.inDismissalArea_(offsetX, offsetY);\n    if (inDimissalArea) {\n      this.dismiss_();\n    }\n    return inDimissalArea;\n  }\n\n  /**\n   * @param {number} offsetX\n   * @param {number} offsetY\n   * @return {boolean}\n   */\n  inDismissalArea_(offsetX, offsetY) {\n    // TODO: Use topEdge/bottomEdge\n    const dismissToleranceFromCenterPx = 20;\n    const {width: vw, height: vh} = this.viewport_.getSize();\n    const {centerX, centerY} = this.getCenter_(offsetX, offsetY);\n    return centerX >= (vw - dismissToleranceFromCenterPx) ||\n        centerX <= dismissToleranceFromCenterPx ||\n        centerY >= (vh - dismissToleranceFromCenterPx) ||\n        centerY <= dismissToleranceFromCenterPx;\n  }\n\n  /**\n   * Gets the center of the currently docked video, offset by (x, y).\n   * @param {number} offsetX\n   * @param {number} offsetY\n   * @return {{centerX: number, centerY: number}}\n   * @private\n   */\n  getCenter_(offsetX, offsetY) {\n    const {target, step} = this.currentlyDocked_;\n    const video = this.getDockedVideo_();\n    const {width, height} = video.getLayoutBox();\n    const {x, y, scale} = this.getDims_(video, target, step);\n\n    const centerX = x + offsetX + (width * scale / 2);\n    const centerY = y + offsetY + (height * scale / 2);\n\n    return {centerX, centerY};\n  }\n\n  /**\n   * @param {number} offsetX\n   * @param {number} offsetY\n   * @private\n   */\n  snapToCorner_(offsetX, offsetY) {\n    const video = this.getDockedVideo_();\n    const {step} = this.currentlyDocked_;\n\n    const {centerX, centerY} = this.getCenter_(offsetX, offsetY);\n\n    let minDistance = null;\n    let closestCornerX = null;\n    let closestCornerY = null;\n\n    [RelativeX.LEFT, RelativeX.RIGHT].forEach(posX => {\n      [RelativeY.TOP, RelativeY.BOTTOM].forEach(posY => {\n        const cornerX = posX == RelativeX.LEFT ?\n          this.getLeftEdge_() :\n          this.getRightEdge_();\n        const cornerY = posY == RelativeY.TOP ?\n          this.getTopEdge_() :\n          this.getBottomEdge_();\n        const distance = Math.sqrt(\n            Math.pow(cornerX - centerX, 2) +\n            Math.pow(cornerY - centerY, 2));\n        if (minDistance === null ||\n            distance < minDistance) {\n          minDistance = distance;\n          closestCornerY = posY;\n          closestCornerX = posX;\n        }\n      });\n    });\n\n    const target = {\n      posX: closestCornerX,\n      posY: closestCornerY,\n    };\n\n    this.currentlyDocked_.target = target;\n\n    this.preferredCornerX_ = closestCornerX;\n\n    const {x, y, scale} = this.getDims_(video, target, step);\n\n    this.placeAt_(video, x, y, scale, step, /* optTransitionDurationMs */ 200);\n  }\n\n  /**\n   * @param {!Element} target\n   * @return {boolean}\n   * @private\n   */\n  isControlsEventTarget_(target) {\n    return !!closestBySelector(target, '.amp-video-docked-controls');\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @param {!DockTargetDef} target\n   * @return {!TargetAreaDef}\n   * @private\n   */\n  getTargetArea_(video, target) {\n    return isElement(target) ?\n      this.getTargetAreaFromSlot_(video, dev().assertElement(target)) :\n      this.getTargetAreaFromPos_(video, target.posX, target.posY);\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @param {!RelativeX} posX\n   * @param {!RelativeY} posY\n   * @return {!TargetAreaDef}\n   * @private\n   */\n  getTargetAreaFromPos_(video, posX, posY) {\n    const {width, height} = video.getLayoutBox();\n    const margin = this.getMargin_();\n    const aspectRatio = width / height;\n    const targetWidth = Math.max(MIN_WIDTH, this.getAreaWidth_() * 0.3);\n    const targetHeight = targetWidth / aspectRatio;\n\n    const x =\n      (posX == RelativeX.RIGHT ?\n        this.getRightEdge_() - margin - targetWidth :\n        this.getLeftEdge_() + margin);\n\n    const y =\n      (posY == RelativeY.TOP ?\n        this.getTopEdge_() + margin :\n        this.getBottomEdge_() - margin - targetHeight);\n\n    const initialY = this.calculateInitialY_(\n        posY, this.getTopEdge_(), this.getBottomEdge_(), height);\n\n    return {x, y, targetWidth, targetHeight, initialY};\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @param {!AmpElement} slot\n   * @return {!TargetAreaDef}\n   * @private\n   */\n  getTargetAreaFromSlot_(video, slot) {\n    const {\n      width: naturalWidth,\n      height: naturalHeight,\n    } = video.getLayoutBox();\n\n    const {\n      width: slotWidth,\n      height: slotHeight,\n      left,\n    } = slot.getLayoutBox();\n\n    const {top, bottom} = this.getFixedSlotLayoutBox_();\n\n    const slotAspect = slotWidth / slotHeight;\n    const naturalAspect = naturalWidth / naturalHeight;\n\n    let x, y, scale;\n\n    if (naturalAspect > slotAspect) {\n      scale = slotWidth / naturalWidth;\n      y = top + (slotHeight / 2) - (naturalHeight * scale / 2);\n      x = left;\n    } else {\n      scale = slotHeight / naturalHeight;\n      x = left + (slotWidth / 2) - (naturalWidth * scale / 2);\n      y = top;\n    }\n\n    const initialY = this.calculateInitialY_(\n        this.getSlotRelativeY_(), top, bottom, naturalHeight);\n\n    const targetWidth = naturalWidth * scale;\n    const targetHeight = naturalHeight * scale;\n\n    return {x, y, targetWidth, targetHeight, initialY};\n  }\n\n  /**\n   * @param {!RelativeY} pos\n   * @param {number} targetTop\n   * @param {number} targetBottom\n   * @param {number} naturalHeight\n   * @return {number}\n   */\n  calculateInitialY_(pos, targetTop, targetBottom, naturalHeight) {\n    return pos == RelativeY.TOP ? targetTop : targetBottom - naturalHeight;\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @param {!DockTargetDef} target\n   * @param {number} step in [0..1]\n   * @return {{x: number, y: number, scale: number}}\n   */\n  getDims_(video, target, step) {\n    const {left, width} = video.getLayoutBox();\n    const {x, y, targetWidth, initialY} = this.getTargetArea_(video, target);\n    const currentX = mapStep(step, left, x);\n    const currentWidth = mapStep(step, width, targetWidth);\n    const currentY = mapStep(step, initialY, y);\n    const scale = currentWidth / width;\n    return {x: currentX, y: currentY, scale};\n  }\n\n  /**\n   * @param {!../../video-interface.VideoOrBaseElementDef} video\n   * @param {number=} unusedDismissDirX\n   * @param {number=} unusedDismissDirY\n   * @private\n   */\n  undock_(video, unusedDismissDirX = 0, unusedDismissDirY = 0) {\n    // TODO(alanorozco): animate dismissal\n    const internalElement = getInternalVideoElementFor(video.element);\n\n    this.trigger_(video, Actions.UNDOCK);\n\n    video.mutateElement(() => {\n      this.hideControls_();\n      video.showControls();\n      this.placedAt_ = null;\n      this.sizedAt_ = null;\n      internalElement.classList.remove(BASE_CLASS_NAME);\n      const shadowLayer = this.getShadowLayer_();\n      const overlay = this.getOverlay_();\n      const almostDismissed = 'amp-video-docked-almost-dismissed';\n      internalElement.classList.remove(almostDismissed);\n      overlay.classList.remove(almostDismissed);\n      const stylesToReset = [\n        'transform',\n        'transition',\n        'width',\n        'height',\n        'opacity',\n      ];\n      shadowLayer.setAttribute('hidden', '');\n      overlay.setAttribute('hidden', '');\n      resetStyles(internalElement, stylesToReset);\n      resetStyles(shadowLayer, stylesToReset);\n      resetStyles(overlay, stylesToReset);\n      this.currentlyDocked_ = null;\n    });\n  }\n\n  /**\n   * @param {boolean=} respectSticky\n   * @private\n   */\n  hideControls_(respectSticky = false) {\n    if (respectSticky && this.stickyControls_) {\n      return;\n    }\n    const {container} = this.getControls_();\n    const overlay = this.getOverlay_();\n    overlay.classList.remove('amp-video-docked-controls-bg');\n    container.classList.remove('amp-video-docked-controls-shown');\n  }\n\n  /**\n   * @param {number=} time\n   * @private\n   */\n  hideControlsOnTimeout_(time = CONTROLS_TIMEOUT) {\n    this.getHideControlsTimeout_().trigger(time);\n  }\n\n  /**\n   * @param {!Element} parent\n   * @private\n   */\n  removePosterForAndroidBug_(parent) {\n    const el = parent.querySelector('.i-amphtml-android-poster-bug');\n    if (!el) {\n      return;\n    }\n    removeElement(el);\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {installStylesForDoc} from '../../style-installer';\n// Source for this constant is css/video-autoplay.css\nimport {cssText} from '../../../build/video-autoplay.css.js';\n\n\n/**\n * @param  {!../ampdoc-impl.AmpDoc} ampdoc\n */\nexport function installAutoplayStylesForDoc(ampdoc) {\n  installStylesForDoc(\n      ampdoc,\n      cssText,\n      /* callback */ null,\n      /* opt_isRuntimeCss */ false,\n      /* opt_ext */ 'amp-video-autoplay');\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getAmpdoc,\n  getExistingServiceForDocInEmbedScope,\n  getExistingServiceOrNull,\n  getService,\n  getServiceForDoc,\n  getServiceForDocDeprecated,\n  getServicePromiseForDoc,\n} from './service';\nimport {\n  getElementServiceForDoc,\n  getElementServiceIfAvailable,\n  getElementServiceIfAvailableForDoc,\n  getElementServiceIfAvailableForDocInEmbedScope,\n} from './element-service';\n\n/** @typedef {!../extensions/amp-subscriptions/0.1/amp-subscriptions.SubscriptionService} */\nexport let SubscriptionService;\n\nexport class Services {\n  /**\n   * Hint: Add extensions folder path to compile.js with\n   * warnings cannot find modules.\n   */\n\n  /**\n   * Returns a promise for the Access service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'access', 'amp-access')));\n  }\n\n  /**\n   * Returns a promise for the Access service or a promise for null if the\n   * service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc, 'access',\n          'amp-access')));\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!SubscriptionService>}\n   */\n  static subscriptionsServiceForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!SubscriptionService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'subscriptions',\n          'amp-subscriptions')));\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?SubscriptionService>}\n   */\n  static subscriptionsServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?SubscriptionService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc, 'subscriptions',\n          'amp-subscriptions')));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/action-impl.ActionService}\n   */\n  static actionServiceForDoc(nodeOrDoc) {\n    return /** @type {!./service/action-impl.ActionService} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'action', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!Activity>}\n   */\n  static activityForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!Activity>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'activity', 'amp-analytics'));\n  }\n\n  /**\n   * Returns the global instance of the `AmpDocService` service that can be\n   * used to resolve an ampdoc for any node: either in the single-doc or\n   * shadow-doc environment.\n   * @param {!Window} window\n   * @return {!./service/ampdoc-impl.AmpDocService}\n   */\n  static ampdocServiceFor(window) {\n    return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n      getService(window, 'ampdoc'));\n  }\n\n  /**\n   * Returns the AmpDoc for the specified context node.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/ampdoc-impl.AmpDoc}\n   */\n  static ampdoc(elementOrAmpDoc) {\n    return getAmpdoc(elementOrAmpDoc);\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @param {boolean=} loadAnalytics\n   * @return {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDoc(elementOrAmpDoc, loadAnalytics = false) {\n    if (loadAnalytics) {\n      // Get Extensions service and force load analytics extension.\n      const ampdoc = getAmpdoc(elementOrAmpDoc);\n      Services.extensionsFor(ampdoc.win)./*OK*/installExtensionForDoc(\n          ampdoc, 'amp-analytics');\n    }\n    return /** @type {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'amp-analytics-instrumentation',\n          'amp-analytics'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc,\n          'amp-analytics-instrumentation', 'amp-analytics'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/batched-xhr-impl.BatchedXhr}\n   */\n  static batchedXhrFor(window) {\n    return /** @type {!./service/batched-xhr-impl.BatchedXhr} */ (\n      getService(window, 'batched-xhr'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>}\n   */\n  static bindForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>} */ (\n      getElementServiceIfAvailableForDocInEmbedScope(\n          elementOrAmpDoc, 'bind', 'amp-bind'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/cid-impl.Cid>}\n   */\n  static cidForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/cid-impl.Cid>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'cid'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/navigation.Navigation}\n   */\n  static navigationForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/navigation.Navigation} */ (\n      getServiceForDoc(elementOrAmpDoc, 'navigation'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/crypto-impl.Crypto}\n   */\n  static cryptoFor(window) {\n    return (/** @type {!./service/crypto-impl.Crypto} */ (\n      getService(window, 'crypto')));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/document-info-impl.DocumentInfoDef} Info about the doc\n   */\n  static documentInfoForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/document-info-impl.DocInfo} */ (\n      getServiceForDoc(elementOrAmpDoc, 'documentInfo')).get();\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/document-state.DocumentState}\n   */\n  static documentStateFor(window) {\n    return getService(window, 'documentState');\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/extensions-impl.Extensions}\n   */\n  static extensionsFor(window) {\n    return /** @type {!./service/extensions-impl.Extensions} */ (\n      getService(window, 'extensions'));\n  }\n\n  /**\n   * Returns service implemented in service/history-impl.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/history-impl.History}\n   */\n  static historyForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/history-impl.History} */ (\n      getServiceForDoc(elementOrAmpDoc, 'history'));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!./input.Input}\n   */\n  static inputFor(win) {\n    return getService(win, 'input');\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/layers-impl.LayoutLayers}\n   */\n  static layersForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/layers-impl.LayoutLayers} */ (\n      getServiceForDoc(elementOrAmpDoc, 'layers'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceFor(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getService(window, 'performance'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceForOrNull(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getExistingServiceOrNull(window, 'performance'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/platform-impl.Platform}\n   */\n  static platformFor(window) {\n    return /** @type {!./service/platform-impl.Platform} */ (\n      getService(window, 'platform'));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Resources is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/resources-impl.Resources}\n   */\n  static resourcesForDoc(nodeOrDoc) {\n    return /** @type {!./service/resources-impl.Resources} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'resources'));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?{incomingFragment: string, outgoingFragment: string}>}\n   */\n  static shareTrackingForOrNull(win) {\n    return (/** @type {!Promise<?{incomingFragment: string, outgoingFragment: string}>} */ (\n      getElementServiceIfAvailable(win, 'share-tracking',\n          'amp-share-tracking', true)));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/variable-service.StoryVariableDef>}\n   */\n  static storyVariableServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/variable-service.StoryVariableDef>} */\n      (getElementServiceIfAvailable(win, 'story-variable', 'amp-story',\n          true)));\n  }\n\n  /**\n   * Version of the story store service depends on which version of amp-story\n   * the publisher is loading. They all have the same implementation.\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService|?../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService>}\n   */\n  static storyStoreServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService|?../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService>} */\n      (getElementServiceIfAvailable(win, 'story-store', 'amp-story')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService}\n   */\n  static storyStoreService(win) {\n    return (/** @type {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService} */\n      (getExistingServiceOrNull(win, 'story-store')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService}\n   */\n  static storyRequestService(win) {\n    return (/** @type {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService} */\n      (getExistingServiceOrNull(win, 'story-request')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!Promise<?../extensions/amp-story/1.0/localization.LocalizationService>}\n   */\n  static localizationServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/localization.LocalizationService>} */\n      (getElementServiceIfAvailable(win, 'localization', 'amp-story', true)));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/1.0/localization.LocalizationService}\n   */\n  static localizationService(win) {\n    return getService(win, 'localization');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService}\n   */\n  static storyStoreServiceV01(win) {\n    return getService(win, 'story-store');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/amp-story-request-service.AmpStoryRequestService}\n   */\n  static storyRequestServiceV01(win) {\n    return getService(win, 'story-request-v01');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!Promise<?../extensions/amp-story/0.1/localization.LocalizationService>}\n   */\n  static localizationServiceForOrNullV01(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/0.1/localization.LocalizationService>} */\n      (getElementServiceIfAvailable(win, 'localization-v01', 'amp-story',\n          true)));\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/localization.LocalizationService}\n   */\n  static localizationServiceV01(win) {\n    return getService(win, 'localization-v01');\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-viewer-integration/0.1/variable-service.ViewerIntegrationVariableDef>}\n   */\n  static viewerIntegrationVariableServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-viewer-integration/0.1/variable-service.ViewerIntegrationVariableDef>} */\n      (getElementServiceIfAvailable(win, 'viewer-integration-variable',\n          'amp-viewer-integration', true)));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>}\n   */\n  static webAnimationServiceFor(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>} */\n      (getElementServiceForDoc(\n          elementOrAmpDoc, 'web-animation', 'amp-animation')));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/storage-impl.Storage>}\n   */\n  static storageForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/storage-impl.Storage>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'storage'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/template-impl.Templates}\n   */\n  static templatesFor(window) {\n    return /** @type {!./service/template-impl.Templates} */ (\n      getService(window, 'templates'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/timer-impl.Timer}\n   */\n  static timerFor(window) {\n    return /** @type {!./service/timer-impl.Timer} */ (\n      getService(window, 'timer'));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/url-replacements-impl.UrlReplacements}\n   */\n  static urlReplacementsForDoc(nodeOrDoc) {\n    return /** @type {!./service/url-replacements-impl.UrlReplacements} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'url-replace', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>}\n   */\n  static userNotificationManagerForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>} */\n      (getElementServiceForDoc(elementOrAmpDoc, 'userNotificationManager',\n          'amp-user-notification')));\n  }\n\n  /**\n   * Returns a promise for the consentPolicy Service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>}\n   */\n  static consentPolicyServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>} */\n      (getElementServiceIfAvailableForDoc(elementOrAmpDoc,\n          'consentPolicyManager', 'amp-consent')));\n  }\n\n  /**\n   * Returns a promise for the geo service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>}\n   */\n  static geoForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>} */ (\n      getElementServiceIfAvailableForDoc(\n          elementOrAmpDoc, 'geo', 'amp-geo', true));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/url-impl.Url}\n   */\n  static urlForDoc(nodeOrDoc) {\n    return /** @type {!./service/url-impl.Url} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'url', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * Returns a promise for the experiment variants or a promise for null if it\n   * is not available on the current page.\n   * @param {!Window} win\n   * @return {!Promise<?Object<string>>}\n   */\n  static variantForOrNull(win) {\n    return /** @type {!Promise<?Object<string>>} */ (\n      getElementServiceIfAvailable(win, 'variant', 'amp-experiment', true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/video-service-interface.VideoServiceInterface}\n   */\n  static videoManagerForDoc(elementOrAmpDoc) {\n    return (\n      /** @type {!./service/video-service-interface.VideoServiceInterface} */ (\n        getServiceForDoc(elementOrAmpDoc, 'video-manager')));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Viewer is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/viewer-impl.Viewer}\n   */\n  static viewerForDoc(nodeOrDoc) {\n    return /** @type {!./service/viewer-impl.Viewer} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'viewer'));\n  }\n\n  /**\n   * Returns promise for the viewer. This is an unusual case and necessary only\n   * for services that need reference to the viewer before it has been\n   * initialized. Most of the code, however, just should use `viewerForDoc`.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/viewer-impl.Viewer>}\n   */\n  static viewerPromiseForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/viewer-impl.Viewer>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'viewer'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/vsync-impl.Vsync}\n   */\n  static vsyncFor(window) {\n    return /** @type {!./service/vsync-impl.Vsync} */ (\n      getService(window, 'vsync'));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Viewport is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/viewport/viewport-impl.Viewport}\n   */\n  static viewportForDoc(nodeOrDoc) {\n    return /** @type {!./service/viewport/viewport-impl.Viewport} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'viewport'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/xhr-impl.Xhr}\n   */\n  static xhrFor(window) {\n    return /** @type {!./service/xhr-impl.Xhr} */ (getService(window, 'xhr'));\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from './log';\nimport {map} from './utils/object.js';\n\nlet container;\n\n/**\n * Creates the html helper for the doc.\n *\n * @param {!Element|!Document} nodeOrDoc\n * @return {function(!Array<string>):!Element}\n */\nexport function htmlFor(nodeOrDoc) {\n  const doc = nodeOrDoc.ownerDocument || nodeOrDoc;\n  if (!container || container.ownerDocument !== doc) {\n    container = doc.createElement('div');\n  }\n\n  return html;\n}\n\n/**\n * A tagged template literal helper to generate static DOM trees.\n * This must be used as a tagged template, ie\n *\n * ```\n * const div = html`<div><span></span></div>`;\n * ```\n *\n * Only the root element and its subtree will be returned. DO NOT use this to\n * render subtree's with dynamic content, it WILL result in an error!\n *\n * @param {!Array<string>} strings\n * @return {!Element}\n */\nfunction html(strings) {\n  dev().assert(strings.length === 1, 'Improper html template tag usage.');\n  container./*OK*/innerHTML = strings[0];\n\n  const el = container.firstElementChild;\n  dev().assert(el, 'No elements in template');\n  dev().assert(!el.nextElementSibling, 'Too many root elements in template');\n\n  // Clear to free memory.\n  container./*OK*/innerHTML = '';\n\n  return el;\n}\n\n/**\n * Queries an element for all elements with a \"ref\" attribute, removing\n * the attribute afterwards.\n * Returns a named map of all ref elements.\n *\n * @param {!Element} root\n * @return {!Object<string, !Element>}\n */\nexport function htmlRefs(root) {\n  const elements = root.querySelectorAll('[ref]');\n  const refs = map();\n\n  for (let i = 0; i < elements.length; i++) {\n    const element = elements[i];\n    const ref = dev().assert(element.getAttribute('ref'), 'Empty ref attr');\n    element.removeAttribute('ref');\n    dev().assert(refs[ref] === undefined, 'Duplicate ref');\n    refs[ref] = element;\n  }\n\n  return refs;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {string} _match\n * @param {string} character\n * @return {string}\n */\nfunction toUpperCase(_match, character) {\n  return character.toUpperCase();\n}\n\n/**\n * @param {string} match\n * @return {string}\n */\nfunction prependDashAndToLowerCase(match) {\n  return '-' + match.toLowerCase();\n}\n\n/**\n * @param {string} name Attribute name containing dashes.\n * @return {string} Dashes removed and successive character sent to upper case.\n * visibleForTesting\n */\nexport function dashToCamelCase(name) {\n  return name.replace(/-([a-z])/g, toUpperCase);\n}\n\n/**\n * Converts a string that is in camelCase to one that is in dash-case.\n *\n * @param {string} string The string to convert.\n * @return {string} The string in dash-case.\n */\nexport function camelCaseToDash(string) {\n  return string.replace(/(?!^)[A-Z]/g, prependDashAndToLowerCase);\n}\n\n/**\n * @param {string} name Attribute name with dashes\n * @return {string} Dashes replaced by underlines.\n */\nexport function dashToUnderline(name) {\n  return name.replace('-', '_');\n}\n\n/**\n * Polyfill for String.prototype.endsWith.\n * @param {string} string\n * @param {string} suffix\n * @return {boolean}\n */\nexport function endsWith(string, suffix) {\n  const index = string.length - suffix.length;\n  return index >= 0 && string.indexOf(suffix, index) == index;\n}\n\n/**\n * Polyfill for String.prototype.startsWith.\n * @param {string} string\n * @param {string} prefix\n * @return {boolean}\n */\nexport function startsWith(string, prefix) {\n  if (prefix.length > string.length) {\n    return false;\n  }\n  return string.lastIndexOf(prefix, 0) == 0;\n}\n\n/**\n * Expands placeholders in a given template string with values.\n *\n * Placeholders use ${key-name} syntax and are replaced with the value\n * returned from the given getter function.\n *\n * @param {string} template The template string to expand.\n * @param {function(string):*} getter Function used to retrieve a value for a\n *   placeholder. Returns values will be coerced into strings.\n * @param {number=} opt_maxIterations Number of times to expand the template.\n *   Defaults to 1, but should be set to a larger value your placeholder tokens\n *   can be expanded to other placeholder tokens. Take caution with large values\n *   as recursively expanding a string can be exponentially expensive.\n */\nexport function expandTemplate(template, getter, opt_maxIterations) {\n  const maxIterations = opt_maxIterations || 1;\n  for (let i = 0; i < maxIterations; i++) {\n    let matches = 0;\n    template = template.replace(/\\${([^}]*)}/g, (_a, b) => {\n      matches++;\n      return getter(b);\n    });\n    if (!matches) {\n      break;\n    }\n  }\n  return template;\n}\n\n/**\n * Hash function djb2a\n * This is intended to be a simple, fast hashing function using minimal code.\n * It does *not* have good cryptographic properties.\n * @param {string} str\n * @return {string} 32-bit unsigned hash of the string\n */\nexport function stringHash32(str) {\n  const {length} = str;\n  let hash = 5381;\n  for (let i = 0; i < length; i++) {\n    hash = hash * 33 ^ str.charCodeAt(i);\n  }\n  // Convert from 32-bit signed to unsigned.\n  return String(hash >>> 0);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from './services';\nimport {dev, rethrowAsync} from './log';\nimport {insertAfterOrAtStart, waitForBody} from './dom';\nimport {map} from './utils/object';\nimport {setStyles} from './style';\nimport {waitForServices} from './render-delaying-services';\n\nconst TRANSFORMER_PROP = '__AMP_CSS_TR';\nconst STYLE_MAP_PROP = '__AMP_CSS_SM';\nconst bodyVisibleSentinel = '__AMP_BODY_VISIBLE';\n\n\n/**\n * Adds the given css text to the given ampdoc.\n *\n * The style tags will be at the beginning of the head before all author\n * styles. One element can be the main runtime CSS. This is guaranteed\n * to always be the first stylesheet in the doc.\n *\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc The ampdoc that should get the new styles.\n * @param {string} cssText\n * @param {?function(!Element)|undefined} cb Called when the new styles are available.\n *     Not using a promise, because this is synchronous when possible.\n *     for better performance.\n * @param {boolean=} opt_isRuntimeCss If true, this style tag will be inserted\n *     as the first element in head and all style elements will be positioned\n *     after.\n * @param {string=} opt_ext\n * @return {!Element}\n */\nexport function installStylesForDoc(\n  ampdoc, cssText, cb, opt_isRuntimeCss, opt_ext) {\n  const cssRoot = ampdoc.getHeadNode();\n  const style = insertStyleElement(\n      cssRoot,\n      maybeTransform(cssRoot, cssText),\n      opt_isRuntimeCss || false,\n      opt_ext || null);\n\n  if (cb) {\n    const rootNode = ampdoc.getRootNode();\n    // Styles aren't always available synchronously. E.g. if there is a\n    // pending style download, it will have to finish before the new\n    // style is visible.\n    // For this reason we poll until the style becomes available.\n    // Sync case.\n    if (styleLoaded(rootNode, style)) {\n      cb(style);\n      return style;\n    }\n    // Poll until styles are available.\n    const interval = setInterval(() => {\n      if (styleLoaded(rootNode, style)) {\n        clearInterval(interval);\n        cb(style);\n      }\n    }, 4);\n  }\n  return style;\n}\n\n\n/**\n * Adds the given css text to the given document.\n * TODO(dvoytenko, #10705): Remove this method once FIE/ampdoc migration is\n * done.\n *\n * @param {!Document} doc The document that should get the new styles.\n * @param {string} cssText\n * @param {?function(!Element)|undefined} cb Called when the new styles are\n *     available. Not using a promise, because this is synchronous when\n *     possible. for better performance.\n * @param {boolean=} opt_isRuntimeCss If true, this style tag will be inserted\n *     as the first element in head and all style elements will be positioned\n *     after.\n * @param {string=} opt_ext\n * @return {!Element}\n */\nexport function installStylesLegacy(\n  doc, cssText, cb, opt_isRuntimeCss, opt_ext) {\n  const style = insertStyleElement(\n      dev().assertElement(doc.head),\n      cssText,\n      opt_isRuntimeCss || false,\n      opt_ext || null);\n\n  if (cb) {\n    // Styles aren't always available synchronously. E.g. if there is a\n    // pending style download, it will have to finish before the new\n    // style is visible.\n    // For this reason we poll until the style becomes available.\n    // Sync case.\n    if (styleLoaded(doc, style)) {\n      cb(style);\n      return style;\n    }\n    // Poll until styles are available.\n    const interval = setInterval(() => {\n      if (styleLoaded(doc, style)) {\n        clearInterval(interval);\n        cb(style);\n      }\n    }, 4);\n  }\n  return style;\n}\n\n\n/**\n * Creates the properly configured style element.\n * @param {!Element|!ShadowRoot} cssRoot\n * @param {string} cssText\n * @param {boolean} isRuntimeCss\n * @param {?string} ext\n * @return {!Element}\n */\nfunction insertStyleElement(cssRoot, cssText, isRuntimeCss, ext) {\n  let styleMap = cssRoot[STYLE_MAP_PROP];\n  if (!styleMap) {\n    styleMap = cssRoot[STYLE_MAP_PROP] = map();\n  }\n\n  const isExtCss = !isRuntimeCss &&\n      (ext && ext != 'amp-custom' && ext != 'amp-keyframes');\n  const key =\n      isRuntimeCss ? 'amp-runtime' :\n        isExtCss ? `amp-extension=${ext}` : null;\n\n  // Check if it has already been created or discovered.\n  if (key) {\n    const existing = getExistingStyleElement(cssRoot, styleMap, key);\n    if (existing) {\n      return existing;\n    }\n  }\n\n  // Create the new style element and append to cssRoot.\n  const doc = (cssRoot.ownerDocument || cssRoot);\n  const style = doc.createElement('style');\n  style./*OK*/textContent = cssText;\n  let afterElement = null;\n  // Make sure that we place style tags after the main runtime CSS. Otherwise\n  // the order is random.\n  if (isRuntimeCss) {\n    style.setAttribute('amp-runtime', '');\n  } else if (isExtCss) {\n    style.setAttribute('amp-extension', ext || '');\n    afterElement = dev().assertElement(getExistingStyleElement(\n        cssRoot, styleMap, 'amp-runtime'));\n  } else {\n    if (ext) {\n      style.setAttribute(ext, '');\n    }\n    afterElement = cssRoot.lastChild;\n  }\n  insertAfterOrAtStart(cssRoot, style, afterElement);\n  if (key) {\n    styleMap[key] = style;\n  }\n  return style;\n}\n\n\n/**\n * @param {!Element|!ShadowRoot} cssRoot\n * @param {!Object<string, !Element>} styleMap\n * @param {string} key\n * @return {?Element}\n */\nfunction getExistingStyleElement(cssRoot, styleMap, key) {\n  // Already cached.\n  if (styleMap[key]) {\n    return styleMap[key];\n  }\n  // Check if the style has already been added by the server layout.\n  const existing = cssRoot./*OK*/querySelector(`style[${key}]`);\n  if (existing) {\n    styleMap[key] = existing;\n    return existing;\n  }\n  // Nothing found.\n  return null;\n}\n\n\n/**\n * Applies a transformer to the CSS text if it has been registered.\n * @param {!Element|!ShadowRoot} cssRoot\n * @param {function(string):string} transformer\n */\nexport function installCssTransformer(cssRoot, transformer) {\n  cssRoot[TRANSFORMER_PROP] = transformer;\n}\n\n\n/**\n * Applies a transformer to the CSS text if it has been registered.\n * @param {!Element|!ShadowRoot} cssRoot\n * @param {string} cssText\n * @return {string}\n */\nfunction maybeTransform(cssRoot, cssText) {\n  const transformer = cssRoot[TRANSFORMER_PROP];\n  return transformer ? transformer(cssText) : cssText;\n}\n\n\n/**\n * Sets the document's body opacity to 1.\n * If the body is not yet available (because our script was loaded\n * synchronously), polls until it is.\n * @param {!Document} doc The document who's body we should make visible.\n * @param {boolean=} opt_waitForServices Whether the body visibility should\n *     be blocked on key services being loaded.\n */\nexport function makeBodyVisible(doc, opt_waitForServices) {\n  dev().assert(doc.defaultView, 'Passed in document must have a defaultView');\n  const win = /** @type {!Window} */ (doc.defaultView);\n  if (win[bodyVisibleSentinel]) {\n    return;\n  }\n  const set = () => {\n    win[bodyVisibleSentinel] = true;\n    setStyles(dev().assertElement(doc.body), {\n      opacity: 1,\n      visibility: 'visible',\n      'animation': 'none',\n    });\n    renderStartedNoInline(doc);\n  };\n  try {\n    waitForBody(doc, () => {\n      if (win[bodyVisibleSentinel]) {\n        return;\n      }\n      win[bodyVisibleSentinel] = true;\n      if (opt_waitForServices) {\n        waitForServices(win).catch(reason => {\n          rethrowAsync(reason);\n          return [];\n        }).then(services => {\n          set();\n          if (services.length > 0) {\n            Services.resourcesForDoc(doc)./*OK*/schedulePass(\n                1, /* relayoutAll */ true);\n          }\n          try {\n            const perf = Services.performanceFor(win);\n            perf.tick('mbv');\n            perf.flush();\n          } catch (e) {}\n        });\n      } else {\n        set();\n      }\n    });\n  } catch (e) {\n    // If there was an error during the logic above (such as service not\n    // yet installed, definitely try to make the body visible.\n    set();\n    // Avoid errors in the function to break execution flow as this is\n    // often called as a last resort.\n    rethrowAsync(e);\n  }\n}\n\n\n/**\n * @param {!Document} doc\n */\nfunction renderStartedNoInline(doc) {\n  try {\n    Services.resourcesForDoc(doc).renderStarted();\n  } catch (e) {\n    // `makeBodyVisible` is called in the error-processing cycle and thus\n    // could be triggered when runtime's initialization is incomplete which\n    // would cause unrelated errors to be thrown here.\n  }\n}\n\n\n/**\n * Indicates that the body is always visible. For instance, in case of PWA.\n * @param {!Window} win\n */\nexport function bodyAlwaysVisible(win) {\n  win[bodyVisibleSentinel] = true;\n}\n\n\n/**\n * Checks whether a style element was registered in the DOM.\n * @param {!Document|!ShadowRoot} doc\n * @param {!Element} style\n * @return {boolean}\n */\nfunction styleLoaded(doc, style) {\n  const sheets = doc.styleSheets;\n  for (let i = 0; i < sheets.length; i++) {\n    const sheet = sheets[i];\n    if (sheet.ownerNode == style) {\n      return true;\n    }\n  }\n  return false;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Note: loaded by 3p system. Cannot rely on babel polyfills.\nimport {map} from './utils/object.js';\nimport {startsWith} from './string';\n\n\n/** @type {Object<string, string>} */\nlet propertyNameCache;\n\n/** @const {!Array<string>} */\nconst vendorPrefixes = ['Webkit', 'webkit', 'Moz', 'moz', 'ms', 'O', 'o'];\n\n\n/**\n * @export\n * @param {string} camelCase camel cased string\n * @return {string} title cased string\n */\nexport function camelCaseToTitleCase(camelCase) {\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n}\n\n/**\n * Checks the style if a prefixed version of a property exists and returns\n * it or returns an empty string.\n * @private\n * @param {!Object} style\n * @param {string} titleCase the title case version of a css property name\n * @return {string} the prefixed property name or null.\n */\nfunction getVendorJsPropertyName_(style, titleCase) {\n  for (let i = 0; i < vendorPrefixes.length; i++) {\n    const propertyName = vendorPrefixes[i] + titleCase;\n    if (style[propertyName] !== undefined) {\n      return propertyName;\n    }\n  }\n  return '';\n}\n\n/**\n * Returns the possibly prefixed JavaScript property name of a style property\n * (ex. WebkitTransitionDuration) given a camelCase'd version of the property\n * (ex. transitionDuration).\n * @export\n * @param {!Object} style\n * @param {string} camelCase the camel cased version of a css property name\n * @param {boolean=} opt_bypassCache bypass the memoized cache of property\n *   mapping\n * @return {string}\n */\nexport function getVendorJsPropertyName(style, camelCase, opt_bypassCache) {\n  if (startsWith(camelCase, '--')) {\n    // CSS vars are returned as is.\n    return camelCase;\n  }\n  if (!propertyNameCache) {\n    propertyNameCache = map();\n  }\n  let propertyName = propertyNameCache[camelCase];\n  if (!propertyName || opt_bypassCache) {\n    propertyName = camelCase;\n    if (style[camelCase] === undefined) {\n      const titleCase = camelCaseToTitleCase(camelCase);\n      const prefixedPropertyName = getVendorJsPropertyName_(style, titleCase);\n\n      if (style[prefixedPropertyName] !== undefined) {\n        propertyName = prefixedPropertyName;\n      }\n    }\n    if (!opt_bypassCache) {\n      propertyNameCache[camelCase] = propertyName;\n    }\n  }\n  return propertyName;\n}\n\n\n/**\n * Sets the CSS styles of the specified element with !important. The styles\n * are specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setImportantStyles(element, styles) {\n  for (const k in styles) {\n    element.style.setProperty(\n        getVendorJsPropertyName(styles, k), styles[k].toString(), 'important');\n  }\n}\n\n\n/**\n * Sets the CSS style of the specified element with optional units, e.g. \"px\".\n * @param {?Element} element\n * @param {string} property\n * @param {*} value\n * @param {string=} opt_units\n * @param {boolean=} opt_bypassCache\n */\nexport function setStyle(element, property, value, opt_units, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (propertyName) {\n    element.style[propertyName] =\n      /** @type {string} */ (opt_units ? value + opt_units : value);\n  }\n}\n\n\n/**\n * Returns the value of the CSS style of the specified element.\n * @param {!Element} element\n * @param {string} property\n * @param {boolean=} opt_bypassCache\n * @return {*}\n */\nexport function getStyle(element, property, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (!propertyName) {\n    return undefined;\n  }\n  return element.style[propertyName];\n}\n\n\n/**\n * Sets the CSS styles of the specified element. The styles\n * a specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setStyles(element, styles) {\n  for (const k in styles) {\n    setStyle(element, k, styles[k]);\n  }\n}\n\n\n/**\n * Shows or hides the specified element.\n * @param {!Element} element\n * @param {boolean=} opt_display\n */\nexport function toggle(element, opt_display) {\n  if (opt_display === undefined) {\n    opt_display = getStyle(element, 'display') == 'none';\n  }\n  setStyle(element, 'display', opt_display ? '' : 'none');\n}\n\n\n/**\n * Returns a pixel value.\n * @param {number} value\n * @return {string}\n */\nexport function px(value) {\n  return `${value}px`;\n}\n\n/**\n * Returns a degree value.\n * @param {number} value\n * @return {string}\n */\nexport function deg(value) {\n  return `${value}deg`;\n}\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function translateX(value) {\n  if (typeof value == 'string') {\n    return `translateX(${value})`;\n  }\n  return `translateX(${px(value)})`;\n}\n\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} x\n * @param {(number|string)=} opt_y\n * @return {string}\n */\nexport function translate(x, opt_y) {\n  if (typeof x == 'number') {\n    x = px(x);\n  }\n  if (opt_y === undefined) {\n    return `translate(${x})`;\n  }\n  if (typeof opt_y == 'number') {\n    opt_y = px(opt_y);\n  }\n  return `translate(${x}, ${opt_y})`;\n}\n\n\n/**\n * Returns a \"scale\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function scale(value) {\n  return `scale(${value})`;\n}\n\n/**\n * Returns a \"rotate\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function rotate(value) {\n  if (typeof value == 'number') {\n    value = deg(value);\n  }\n  return `rotate(${value})`;\n}\n\n/**\n * Remove alpha value from a rgba color value.\n * Return the new color property with alpha equals if has the alpha value.\n * Caller needs to make sure the input color value is a valid rgba/rgb value\n * @param {string} rgbaColor\n * @return {string}\n */\nexport function removeAlphaFromColor(rgbaColor) {\n  return rgbaColor.replace(\n      /\\(([^,]+),([^,]+),([^,)]+),[^)]+\\)/g, '($1,$2,$3, 1)');\n}\n\n/**\n * Gets the computed style of the element. The helper is necessary to enforce\n * the possible `null` value returned by a buggy Firefox.\n *\n * @param {!Window} win\n * @param {!Element} el\n * @return {!Object<string, string>}\n */\nexport function computedStyle(win, el) {\n  const style = /** @type {?CSSStyleDeclaration} */(win.getComputedStyle(el));\n  return /** @type {!Object<string, string>} */(style) || map();\n}\n\n\n/**\n * Resets styles that were set dynamically (i.e. inline)\n * @param {!Element} element\n * @param {!Array<string>} properties\n */\nexport function resetStyles(element, properties) {\n  const styleObj = {};\n  properties.forEach(prop => {\n    styleObj[prop] = null;\n  });\n  setStyles(element, styleObj);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* @const */\nconst toString_ = Object.prototype.toString;\n\n/**\n * Returns the ECMA [[Class]] of a value\n * @param {*} value\n * @return {string}\n */\nfunction toString(value) {\n  return toString_.call(value);\n}\n\n/**\n * Determines if value is actually an Array.\n * @param {*} value\n * @return {boolean}\n */\nexport function isArray(value) {\n  return Array.isArray(value);\n}\n\n/**\n * Converts an array-like object to an array.\n * @param {?IArrayLike<T>|string} arrayLike\n * @return {!Array<T>}\n * @template T\n */\nexport function toArray(arrayLike) {\n  if (!arrayLike) {\n    return [];\n  }\n  const array = new Array(arrayLike.length);\n  for (let i = 0; i < arrayLike.length; i++) {\n    array[i] = arrayLike[i];\n  }\n  return array;\n}\n\n/**\n * Determines if value is actually an Object.\n * @param {*} value\n * @return {boolean}\n */\nexport function isObject(value) {\n  return toString(value) === '[object Object]';\n}\n\n/**\n * Determines if value is of number type and finite.\n * NaN and Infinity are not considered a finite number.\n * String numbers are not considered numbers.\n * @param {*} value\n * @return {boolean}\n */\nexport function isFiniteNumber(value) {\n  return (typeof value === 'number' && isFinite(value));\n}\n\n/**\n * Checks whether `s` is a valid value of `enumObj`.\n *\n * @param {!Object<T>} enumObj\n * @param {T} s\n * @return {boolean}\n * @template T\n */\nexport function isEnumValue(enumObj, s) {\n  for (const k in enumObj) {\n    if (enumObj[k] === s) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Externs declare that access `defaultView` from `document` or\n * `ownerDocument` is of type `(Window|null)` but most of our parameter types\n * assume that it is never null. This is OK in practice as we ever only get\n * null on disconnected documents or old IE.\n * This helper function casts it into just a simple Window return type.\n *\n * @param {!Window|null} winOrNull\n * @return {!Window}\n */\nexport function toWin(winOrNull) {\n  return /** @type {!Window} */ (winOrNull);\n}\n\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {tryDecodeUriComponent_} from './url-try-decode-uri-component';\n\nconst regex = /(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * DO NOT import the function from this file. Instead, import parseQueryString\n * from `src/url.js`.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString_(queryString) {\n  const params = /** @type {!JsonObject} */ (Object.create(null));\n  if (!queryString) {\n    return params;\n  }\n\n  let match;\n  while ((match = regex.exec(queryString))) {\n    const name = tryDecodeUriComponent_(match[1], match[1]);\n    const value = match[2] ? tryDecodeUriComponent_(match[2], match[2]) : '';\n    params[name] = value;\n  }\n  return params;\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * DO NOT import the function from this file. Instead, import\n * tryDecodeUriComponent from `src/url.js`.\n *\n * @param {string} component\n * @param {string=} fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent_(component, fallback = '') {\n  try {\n    return decodeURIComponent(component);\n  } catch (e) {\n    return fallback;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {LruCache} from './utils/lru-cache';\nimport {dict} from './utils/object';\nimport {endsWith, startsWith} from './string';\nimport {getMode} from './mode';\nimport {isArray} from './types';\nimport {parseQueryString_} from './url-parse-query-string';\nimport {tryDecodeUriComponent_} from './url-try-decode-uri-component';\nimport {urls} from './config';\nimport {user} from './log';\n\n/**\n * @type {!JsonObject}\n */\nconst SERVING_TYPE_PREFIX = dict({\n  // No viewer\n  'c': true,\n  // In viewer\n  'v': true,\n  // Ad landing page\n  'a': true,\n  // Ad\n  'ad': true,\n});\n\n/**\n * Cached a-tag to avoid memory allocation during URL parsing.\n * @type {HTMLAnchorElement}\n */\nlet a;\n\n/**\n * We cached all parsed URLs. As of now there are no use cases\n * of AMP docs that would ever parse an actual large number of URLs,\n * but we often parse the same one over and over again.\n * @type {LruCache}\n */\nlet cache;\n\n/** @private @const Matches amp_js_* parameters in query string. */\nconst AMP_JS_PARAMS_REGEX = /[?&]amp_js[^&]*/;\n\n/** @private @const Matches amp_gsa parameters in query string. */\nconst AMP_GSA_PARAMS_REGEX = /[?&]amp_gsa[^&]*/;\n\n/** @private @const Matches amp_r parameters in query string. */\nconst AMP_R_PARAMS_REGEX = /[?&]amp_r[^&]*/;\n\n/** @private @const Matches usqp parameters from goog experiment in query string. */\nconst GOOGLE_EXPERIMENT_PARAMS_REGEX = /[?&]usqp[^&]*/;\n\nconst INVALID_PROTOCOLS = [\n  /*eslint no-script-url: 0*/ 'javascript:',\n  /*eslint no-script-url: 0*/ 'data:',\n  /*eslint no-script-url: 0*/ 'vbscript:',\n];\n\n/** @const {string} */\nexport const SOURCE_ORIGIN_PARAM = '__amp_source_origin';\n\n/**\n * Returns the correct origin for a given window.\n * @param {!Window} win\n * @return {string} origin\n */\nexport function getWinOrigin(win) {\n  return win.origin || parseUrlDeprecated(win.location.href).origin;\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {string} url\n * @param {boolean=} opt_nocache\n * @return {!Location}\n */\nexport function parseUrlDeprecated(url, opt_nocache) {\n  if (!a) {\n    a = /** @type {!HTMLAnchorElement} */ (self.document.createElement('a'));\n    cache = self.UrlCache || (self.UrlCache = new LruCache(100));\n  }\n\n  return parseUrlWithA(a, url, opt_nocache ? null : cache);\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {!HTMLAnchorElement} a\n * @param {string} url\n * @param {LruCache=} opt_cache\n * @return {!Location}\n * @restricted\n */\nexport function parseUrlWithA(a, url, opt_cache) {\n  if (opt_cache && opt_cache.has(url)) {\n    return opt_cache.get(url);\n  }\n\n  a.href = url;\n\n  // IE11 doesn't provide full URL components when parsing relative URLs.\n  // Assigning to itself again does the trick #3449.\n  if (!a.protocol) {\n    a.href = a.href;\n  }\n\n  const info = /** @type {!Location} */({\n    href: a.href,\n    protocol: a.protocol,\n    host: a.host,\n    hostname: a.hostname,\n    port: a.port == '0' ? '' : a.port,\n    pathname: a.pathname,\n    search: a.search,\n    hash: a.hash,\n    origin: null, // Set below.\n  });\n\n  // Some IE11 specific polyfills.\n  // 1) IE11 strips out the leading '/' in the pathname.\n  if (info.pathname[0] !== '/') {\n    info.pathname = '/' + info.pathname;\n  }\n\n  // 2) For URLs with implicit ports, IE11 parses to default ports while\n  // other browsers leave the port field empty.\n  if ((info.protocol == 'http:' && info.port == 80)\n      || (info.protocol == 'https:' && info.port == 443)) {\n    info.port = '';\n    info.host = info.hostname;\n  }\n\n  // For data URI a.origin is equal to the string 'null' which is not useful.\n  // We instead return the actual origin which is the full URL.\n  if (a.origin && a.origin != 'null') {\n    info.origin = a.origin;\n  } else if (info.protocol == 'data:' || !info.host) {\n    info.origin = info.href;\n  } else {\n    info.origin = info.protocol + '//' + info.host;\n  }\n\n  // Freeze during testing to avoid accidental mutation.\n  const frozen = (getMode().test && Object.freeze) ? Object.freeze(info) : info;\n\n  if (opt_cache) {\n    opt_cache.put(url, frozen);\n  }\n\n  return frozen;\n}\n\n/**\n * Appends the string just before the fragment part (or optionally\n * to the front of the query string) of the URL.\n * @param {string} url\n * @param {string} paramString\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function appendEncodedParamStringToUrl(url, paramString,\n  opt_addToFront) {\n  if (!paramString) {\n    return url;\n  }\n  const mainAndFragment = url.split('#', 2);\n  const mainAndQuery = mainAndFragment[0].split('?', 2);\n\n  let newUrl = mainAndQuery[0] + (\n    mainAndQuery[1]\n      ? (opt_addToFront\n        ? `?${paramString}&${mainAndQuery[1]}`\n        : `?${mainAndQuery[1]}&${paramString}`)\n      : `?${paramString}`);\n  newUrl += mainAndFragment[1] ? `#${mainAndFragment[1]}` : '';\n  return newUrl;\n}\n/**\n * Appends a query string field and value to a url. `key` and `value`\n * will be ran through `encodeURIComponent` before appending.\n * @param {string} url\n * @param {string} key\n * @param {string} value\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function addParamToUrl(url, key, value, opt_addToFront) {\n  const field = `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\n  return appendEncodedParamStringToUrl(url, field, opt_addToFront);\n}\n\n/**\n * Appends query string fields and values to a url. The `params` objects'\n * `key`s and `value`s will be transformed into query string keys/values.\n * @param {string} url\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function addParamsToUrl(url, params) {\n  return appendEncodedParamStringToUrl(url, serializeQueryString(params));\n}\n\n/**\n * Serializes the passed parameter map into a query string with both keys\n * and values encoded.\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function serializeQueryString(params) {\n  const s = [];\n  for (const k in params) {\n    const v = params[k];\n    if (v == null) {\n      continue;\n    } else if (isArray(v)) {\n      for (let i = 0; i < v.length; i++) {\n        const sv = /** @type {string} */ (v[i]);\n        s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n      }\n    } else {\n      const sv = /** @type {string} */ (v);\n      s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n    }\n  }\n  return s.join('&');\n}\n\n/**\n * Returns `true` if the URL is secure: either HTTPS or localhost (for testing).\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isSecureUrlDeprecated(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return (url.protocol == 'https:' ||\n      url.hostname == 'localhost' ||\n      endsWith(url.hostname, '.localhost'));\n}\n\n/**\n * Asserts that a given url is HTTPS or protocol relative. It's a user-level\n * assert.\n *\n * Provides an exception for localhost.\n *\n * @param {?string|undefined} urlString\n * @param {!Element|string} elementContext Element where the url was found.\n * @param {string=} sourceName Used for error messages.\n * @return {string}\n */\nexport function assertHttpsUrl(\n  urlString, elementContext, sourceName = 'source') {\n  user().assert(urlString != null, '%s %s must be available',\n      elementContext, sourceName);\n  // (erwinm, #4560): type cast necessary until #4560 is fixed.\n  const theUrlString = /** @type {string} */ (urlString);\n  user().assert(isSecureUrlDeprecated(theUrlString) || /^(\\/\\/)/.test(theUrlString),\n      '%s %s must start with ' +\n      '\"https://\" or \"//\" or be relative and served from ' +\n      'either https or from localhost. Invalid value: %s',\n      elementContext, sourceName, theUrlString);\n  return theUrlString;\n}\n\n/**\n * Asserts that a given url is an absolute HTTP or HTTPS URL.\n * @param {string} urlString\n * @return {string}\n */\nexport function assertAbsoluteHttpOrHttpsUrl(urlString) {\n  user().assert(/^https?\\:/i.test(urlString),\n      'URL must start with \"http://\" or \"https://\". Invalid value: %s',\n      urlString);\n  return parseUrlDeprecated(urlString).href;\n}\n\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * This function is implemented in a separate file to avoid a circular\n * dependency.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString(queryString) {\n  return parseQueryString_(queryString);\n}\n\n/**\n * Returns the URL without fragment. If URL doesn't contain fragment, the same\n * string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function removeFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return url;\n  }\n  return url.substring(0, index);\n}\n\n/**\n * Returns the fragment from the URL. If the URL doesn't contain fragment,\n * the empty string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function getFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return '';\n  }\n  return url.substring(index);\n}\n\n/**\n * Returns whether the URL has the origin of a proxy.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isProxyOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.cdnProxyRegex.test(url.origin);\n}\n\n/**\n * For proxy-origin URLs, returns the serving type. Otherwise, returns null.\n * E.g., 'https://amp-com.cdn.ampproject.org/a/s/amp.com/amp_document.html'\n * returns 'a'.\n * @param {string|!Location} url URL of an AMP document.\n * @return {?string}\n */\nexport function getProxyServingType(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  if (!isProxyOrigin(url)) {\n    return null;\n  }\n  const path = url.pathname.split('/', 2);\n  return path[1];\n}\n\n/**\n * Returns whether the URL origin is localhost.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isLocalhostOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.localhostRegex.test(url.origin);\n}\n\n/**\n * Returns whether the URL has valid protocol.\n * Deep link protocol is valid, but not javascript etc.\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isProtocolValid(url) {\n  if (!url) {\n    return true;\n  }\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return !INVALID_PROTOCOLS.includes(url.protocol);\n}\n\n/**\n * Returns a URL without AMP JS parameters.\n * @param {string} url\n * @return {string}\n */\nexport function removeAmpJsParamsFromUrl(url) {\n  const parsed = parseUrlDeprecated(url);\n  const search = removeAmpJsParamsFromSearch(parsed.search);\n  return parsed.origin + parsed.pathname + search + parsed.hash;\n\n}\n\n/**\n * Returns a URL without a query string.\n * @param {string} url\n * @return {string}\n */\nexport function removeSearch(url) {\n  const index = url.indexOf('?');\n  if (index == -1) {\n    return url;\n  }\n  const fragment = getFragment(url);\n  return url.substring(0, index) + fragment;\n}\n\n/**\n * Removes parameters that start with amp js parameter pattern and returns the\n * new search string.\n * @param {string} urlSearch\n * @return {string}\n */\nfunction removeAmpJsParamsFromSearch(urlSearch) {\n  if (!urlSearch || urlSearch == '?') {\n    return '';\n  }\n  const search = urlSearch\n      .replace(AMP_JS_PARAMS_REGEX, '')\n      .replace(AMP_GSA_PARAMS_REGEX, '')\n      .replace(AMP_R_PARAMS_REGEX, '')\n      .replace(GOOGLE_EXPERIMENT_PARAMS_REGEX, '')\n      .replace(/^[?&]/, ''); // Removes first ? or &.\n  return search ? '?' + search : '';\n}\n\n/**\n * Returns the source URL of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string}\n */\nexport function getSourceUrl(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n\n  // Not a proxy URL - return the URL itself.\n  if (!isProxyOrigin(url)) {\n    return url.href;\n  }\n\n  // A proxy URL.\n  // Example path that is being matched here.\n  // https://cdn.ampproject.org/c/s/www.origin.com/foo/\n  // The /s/ is optional and signals a secure origin.\n  const path = url.pathname.split('/');\n  const prefix = path[1];\n  user().assert(SERVING_TYPE_PREFIX[prefix],\n      'Unknown path prefix in url %s', url.href);\n  const domainOrHttpsSignal = path[2];\n  const origin = domainOrHttpsSignal == 's'\n    ? 'https://' + decodeURIComponent(path[3])\n    : 'http://' + decodeURIComponent(domainOrHttpsSignal);\n  // Sanity test that what we found looks like a domain.\n  user().assert(origin.indexOf('.') > 0, 'Expected a . in origin %s', origin);\n  path.splice(1, domainOrHttpsSignal == 's' ? 3 : 2);\n  return origin + path.join('/') +\n      removeAmpJsParamsFromSearch(url.search) + (url.hash || '');\n}\n\n/**\n * Returns the source origin of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string} The source origin of the URL.\n */\nexport function getSourceOrigin(url) {\n  return parseUrlDeprecated(getSourceUrl(url)).origin;\n}\n\n/**\n * Returns absolute URL resolved based on the relative URL and the base.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n */\nexport function resolveRelativeUrl(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  if (typeof URL == 'function') {\n    return new URL(relativeUrlString, baseUrl.href).toString();\n  }\n  return resolveRelativeUrlFallback_(relativeUrlString, baseUrl);\n}\n\n/**\n * Fallback for URL resolver when URL class is not available.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n * @private Visible for testing.\n */\nexport function resolveRelativeUrlFallback_(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  relativeUrlString = relativeUrlString.replace(/\\\\/g, '/');\n  const relativeUrl = parseUrlDeprecated(relativeUrlString);\n\n  // Absolute URL.\n  if (startsWith(relativeUrlString.toLowerCase(), relativeUrl.protocol)) {\n    return relativeUrl.href;\n  }\n\n  // Protocol-relative URL.\n  if (startsWith(relativeUrlString, '//')) {\n    return baseUrl.protocol + relativeUrlString;\n  }\n\n  // Absolute path.\n  if (startsWith(relativeUrlString, '/')) {\n    return baseUrl.origin + relativeUrlString;\n  }\n\n  // Relative path.\n  return baseUrl.origin + baseUrl.pathname.replace(/\\/[^/]*$/, '/')\n      + relativeUrlString;\n}\n\n\n/**\n * Add \"__amp_source_origin\" query parameter to the URL.\n * @param {!Window} win\n * @param {string} url\n * @return {string}\n */\nexport function getCorsUrl(win, url) {\n  checkCorsUrl(url);\n  const sourceOrigin = getSourceOrigin(win.location.href);\n  return addParamToUrl(url, SOURCE_ORIGIN_PARAM, sourceOrigin);\n}\n\n\n/**\n * Checks if the url has __amp_source_origin and throws if it does.\n * @param {string} url\n */\nexport function checkCorsUrl(url) {\n  const parsedUrl = parseUrlDeprecated(url);\n  const query = parseQueryString(parsedUrl.search);\n  user().assert(!(SOURCE_ORIGIN_PARAM in query),\n      'Source origin is not allowed in %s', url);\n}\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * @param {string} component\n * @param {string=} opt_fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent(component, opt_fallback) {\n  return tryDecodeUriComponent_(component, opt_fallback);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Compares if two arrays contains exactly same elements of same number\n * of same order.\n * Notice that it does NOT handle NaN case as expected\n *\n * @param {!Array<T>} arr1\n * @param {!Array<T>} arr2\n * @return {boolean}\n * @template T\n */\nexport function areEqualOrdered(arr1, arr2) {\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n\n  for (let i = 0; i < arr1.length; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * A bit like Array#filter, but removes elements that filter false from the\n * array. Returns the filtered items.\n *\n * @param {!Array<T>} array\n * @param {function(T, number, !Array<T>):boolean} filter\n * @return {!Array<T>}\n * @template T\n */\nexport function filterSplice(array, filter) {\n  const splice = [];\n  let index = 0;\n  for (let i = 0; i < array.length; i++) {\n    const item = array[i];\n    if (filter(item, i, array)) {\n      if (index < i) {\n        array[index] = item;\n      }\n      index++;\n    } else {\n      splice.push(item);\n    }\n  }\n\n  if (index < array.length) {\n    array.length = index;\n  }\n\n  return splice;\n}\n\n/**\n * Returns the index of the first element matching the predicate.\n * Like Array#findIndex.\n *\n * @param {!Array<T>} array\n * @param {function(T, number, !Array<T>):boolean} predicate\n * @return {number}\n * @template T\n */\nexport function findIndex(array, predicate) {\n  for (let i = 0; i < array.length; i++) {\n    if (predicate(array[i], i, array)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n/**\n * Converts the given iterator to an array.\n *\n * @param {!Iterator<T>} iterator\n * @return {Array<T>}\n * @template T\n */\nexport function fromIterator(iterator) {\n  const array = [];\n  for (let e = iterator.next(); !e.done; e = iterator.next()) {\n    array.push(e.value);\n  }\n  return array;\n}\n\n/**\n * Adds item to array if it is not already present.\n *\n * @param {Array<T>} array\n * @param {T} item\n * @template T\n */\nexport function pushIfNotExist(array, item) {\n  if (array.indexOf(item) < 0) {\n    array.push(item);\n  }\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// TODO(rsimha, #15334): Enable this rule.\n/* eslint jsdoc/check-types: 0 */\n\n/**\n * Creates a function that is evaluated only once and returns the cached result\n * subsequently.\n *\n * Please note that `once` only takes the function definition into account,\n * so it will return the same cached value even when the arguments are\n * different.\n *\n * @param {function(...):T} fn\n * @return {function(...):T}\n * @template T\n */\nexport function once(fn) {\n  let evaluated = false;\n  let retValue = null;\n  let callback = fn;\n  return (...args) => {\n    if (!evaluated) {\n      retValue = callback.apply(self, args);\n      evaluated = true;\n      callback = null; // GC\n    }\n    return retValue;\n  };\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from '../log';\n\n/** @const {string} */\nconst TAG = 'lru-cache';\n\n/**\n * @template T\n */\nexport class LruCache {\n  /**\n   * @param {number} capacity\n   */\n  constructor(capacity) {\n    /** @private @const {number} */\n    this.capacity_ = capacity;\n\n    /** @private {number} */\n    this.size_ = 0;\n\n    /**\n     * An incrementing counter to define the last access.\n     * @private {number}\n     */\n    this.access_ = 0;\n\n    /** @private {!Object<(number|string), {payload: T, access: number}>} */\n    this.cache_ = Object.create(null);\n  }\n\n  /**\n   * Returns whether key is cached.\n   *\n   * @param {number|string} key\n   * @return {boolean}\n   */\n  has(key) {\n    return !!this.cache_[key];\n  }\n\n  /**\n   * @param {number|string} key\n   * @return {T} The cached payload.\n   */\n  get(key) {\n    const cacheable = this.cache_[key];\n    if (cacheable) {\n      cacheable.access = ++this.access_;\n      return cacheable.payload;\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {number|string} key\n   * @param {T} payload The payload to cache.\n   */\n  put(key, payload) {\n    if (!this.has(key)) {\n      this.size_++;\n    }\n    this.cache_[key] = {payload, access: this.access_};\n    this.evict_();\n  }\n\n  /**\n   * Evicts the oldest cache entry, if we've exceeded capacity.\n   */\n  evict_() {\n    if (this.size_ <= this.capacity_) {\n      return;\n    }\n\n    dev().warn(TAG, 'Trimming LRU cache');\n    const cache = this.cache_;\n    let oldest = this.access_ + 1;\n    let oldestKey;\n    for (const key in cache) {\n      const {access} = cache[key];\n      if (access < oldest) {\n        oldest = access;\n        oldestKey = key;\n      }\n    }\n\n    if (oldestKey !== undefined) {\n      delete cache[oldestKey];\n      this.size_--;\n    }\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Maps a value in a first range to its equivalent in a second range\n * Ex.: 5 in the range [0,10] gives 60 in the range[40,80]\n *\n * NOTE: lower/upper bounds on the source range are detected automatically,\n * however the bounds on the target range are not altered (thus the target\n * range could be decreasing).\n * Ex1: 8 in the range [0, 10] gives 2 in the range [10, 0]\n * Ex2: also, 8 in the range [10, 0] gives 2 in the range [10, 0]\n *\n * NOTE: Input value is enforced to be bounded inside the source range\n * Ex1: -2 in the range [0, 10] is interpreted as 0 and thus gives 40 in [40,80]\n * Ex2: 19 in the range [0, 5] is interpreted as 5 and thus gives 80 in [40,80]\n *\n * @param {number} val the value in the source range\n * @param {number} min1 the lower bound of the source range\n * @param {number} max1 the upper bound of the source range\n * @param {number} min2 the lower bound of the target range\n * @param {number} max2 the upper bound of the target range\n * @return {number} the equivalent value in the target range\n */\nexport function mapRange(val, min1, max1, min2, max2) {\n\n  let max1Bound = max1;\n  let min1Bound = min1;\n  if (min1 > max1) {\n    max1Bound = min1;\n    min1Bound = max1;\n  }\n\n  if (val < min1Bound) {\n    val = min1Bound;\n  } else if (val > max1Bound) {\n    val = max1Bound;\n  }\n\n  return (val - min1) * (max2 - min2) / (max1 - min1) + min2;\n}\n\n/**\n * Computes the modulus of values `a` and `b`.\n *\n * This is needed because the % operator in JavaScript doesn't implement\n * modulus behaviour as can be seen by the spec here:\n * http://www.ecma-international.org/ecma-262/5.1/#sec-11.5.3.\n * It instead is used to obtain the remainder of a division.\n * This function uses the remainder (%) operator to determine the modulus.\n * Derived from here:\n * https://stackoverflow.com/questions/25726760/javascript-modular-arithmetic/47354356#47354356\n *\n * @param {number} a\n * @param {number} b\n * @return {number} returns the modulus of the two numbers.\n * @example\n *\n * _.min(10, 5);\n * // => 0\n *\n * _.mod(-1, 5);\n * // => 4\n */\nexport function mod(a, b) {\n  return a > 0 && b > 0 ? a % b : ((a % b) + b) % b;\n}\n\n/**\n * Restricts a number to be in the given min/max range.\n *\n * Examples:\n * clamp(0.5, 0, 1) -> 0.5\n * clamp(1.5, 0, 1) -> 1\n * clamp(-0.5, 0, 1) -> 0\n *\n * @param {number} val the value to clamp.\n * @param {number} min the lower bound.\n * @param {number} max the upper bound.\n * @return {number} the clamped value.\n */\nexport function clamp(val, min, max) {\n  return Math.min(Math.max(val, min), max);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {isObject} from '../types';\n\n/* @const */\nconst hasOwn_ = Object.prototype.hasOwnProperty;\n\n/**\n * Returns a map-like object.\n * If opt_initial is provided, copies its own properties into the\n * newly created object.\n * @param {T=} opt_initial This should typically be an object literal.\n * @return {T}\n * @template T\n */\nexport function map(opt_initial) {\n  const obj = Object.create(null);\n  if (opt_initial) {\n    Object.assign(obj, opt_initial);\n  }\n  return obj;\n}\n\n/**\n * Return an empty JsonObject or makes the passed in object literal\n * an JsonObject.\n * The JsonObject type is just a simple object that is at-dict.\n * See\n * https://github.com/google/closure-compiler/wiki/@struct-and-@dict-Annotations\n * for what a dict is type-wise.\n * The linter enforces that the argument is, in fact, at-dict like.\n * @param {!Object=} opt_initial\n * @return {!JsonObject}\n */\nexport function dict(opt_initial) {\n  // We do not copy. The linter enforces that the passed in object is a literal\n  // and thus the caller cannot have a reference to it.\n  return /** @type {!JsonObject} */ (opt_initial || {});\n}\n\n/**\n * Checks if the given key is a property in the map.\n *\n * @param {T}  obj a map like property.\n * @param {string}  key\n * @return {boolean}\n * @template T\n */\nexport function hasOwn(obj, key) {\n  return hasOwn_.call(obj, key);\n}\n\n/**\n * Returns obj[key] iff key is obj's own property (is not inherited).\n * Otherwise, returns undefined.\n *\n * @param {Object} obj\n * @param {string} key\n * @return {*}\n */\nexport function ownProperty(obj, key) {\n  if (hasOwn(obj, key)) {\n    return obj[key];\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Deep merges source into target.\n *\n * @param {!Object} target\n * @param {!Object} source\n * @param {number} depth The maximum merge depth. If exceeded, Object.assign\n *                       will be used instead.\n * @return {!Object}\n * @throws {Error} If source contains a circular reference.\n * Note: Only nested objects are deep-merged, primitives and arrays are not.\n */\nexport function deepMerge(target, source, depth = 10) {\n  // Keep track of seen objects to detect recursive references.\n  const seen = [];\n\n  /** @type {!Array<{t: !Object, s: !Object, d: number}>} */\n  const queue = [];\n  queue.push({t: target, s: source, d: 0});\n\n  // BFS to ensure objects don't have recursive references at shallower depths.\n  while (queue.length > 0) {\n    const {t, s, d} = queue.shift();\n    if (seen.includes(s)) {\n      throw new Error('Source object has a circular reference.');\n    }\n    seen.push(s);\n    if (t === s) {\n      continue;\n    }\n    if (d > depth) {\n      Object.assign(t, s);\n      continue;\n    }\n    Object.keys(s).forEach(key => {\n      const newValue = s[key];\n      // Perform a deep merge IFF both target and source have the same key\n      // whose corresponding values are objects.\n      if (hasOwn(t, key)) {\n        const oldValue = t[key];\n        if (isObject(newValue) && isObject(oldValue)) {\n          queue.push({t: oldValue, s: newValue, d: d + 1});\n          return;\n        }\n      }\n      t[key] = newValue;\n    });\n  }\n  return target;\n}\n\n/**\n * @param {!Object} o An object to remove properties from\n * @param {!Array<string>} props A list of properties to remove from the Object\n * @return {!Object} An object with the given properties removed\n */\nexport function omit(o, props) {\n  return Object.keys(o).reduce((acc, key) => {\n    if (!props.includes(key)) {\n      acc[key] = o[key];\n    }\n    return acc;\n  }, {});\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns a Deferred struct, which holds a pending promise and its associated\n * resolve and reject functions.\n *\n * This is preferred instead of creating a Promise instance to extract the\n * resolve/reject functions yourself:\n *\n * ```\n * // Avoid doing\n * let resolve;\n * const promise = new Promise(res => {\n *   resolve = res;\n * });\n *\n * // Good\n * const deferred = new Deferred();\n * const { promise, resolve } = deferred;\n * ```\n *\n * @template T\n */\nexport class Deferred {\n  /**\n   * Creates an instance of Deferred.\n   */\n  constructor() {\n    let resolve, reject;\n\n    /**\n     * @const {!Promise<T>}\n     */\n    this.promise = new /*OK*/Promise((res, rej) => {\n      resolve = res;\n      reject = rej;\n    });\n\n    /**\n     * @const {function(T=)}\n     */\n    this.resolve = resolve;\n\n    /**\n     * @const {function(*=)}\n     */\n    this.reject = reject;\n  }\n}\n\n/**\n * Creates a promise resolved to the return value of fn.\n * If fn sync throws, it will cause the promise to reject.\n *\n * @param {function():T} fn\n * @return {!Promise<T>}\n * @template T\n */\nexport function tryResolve(fn) {\n  return new Promise(resolve => {\n    resolve(fn());\n  });\n}\n\n/**\n * Returns a promise which resolves if a threshold amount of the given promises\n * resolve, and rejects otherwise.\n * @param {!Array<!Promise>} promises The array of promises to test.\n * @param {number} count The number of promises that must resolve for the\n *     returned promise to resolve.\n * @return {!Promise} A promise that resolves if any of the given promises\n *     resolve, and which rejects otherwise.\n */\nexport function some(promises, count = 1) {\n  return new Promise((resolve, reject) => {\n    count = Math.max(count, 0);\n    const extra = promises.length - count;\n    if (extra < 0) {\n      reject(new Error('not enough promises to resolve'));\n    }\n    if (promises.length == 0) {\n      resolve([]);\n    }\n    const values = [];\n    const reasons = [];\n\n    const onFulfilled = value => {\n      if (values.length < count) {\n        values.push(value);\n      }\n      if (values.length == count) {\n        resolve(values);\n      }\n    };\n    const onRejected = reason => {\n      if (reasons.length <= extra) {\n        reasons.push(reason);\n      }\n      if (reasons.length > extra) {\n        reject(reasons);\n      }\n    };\n    for (let i = 0; i < promises.length; i++) {\n      Promise.resolve(promises[i]).then(onFulfilled, onRejected);\n    }\n  });\n}\n\n/**\n * Resolves with the result of the last promise added.\n * @implements {IThenable}\n */\nexport class LastAddedResolver {\n  /**\n   * @param {!Array<!Promise>=} opt_promises\n   */\n  constructor(opt_promises) {\n    let resolve_, reject_;\n    /** @private @const {!Promise} */\n    this.promise_ = new Promise((resolve, reject) => {\n      resolve_ = resolve;\n      reject_ = reject;\n    });\n\n    /** @private */\n    this.resolve_ = resolve_;\n\n    /** @private */\n    this.reject_ = reject_;\n\n    /** @private */\n    this.count_ = 0;\n\n    if (opt_promises) {\n      for (let i = 0; i < opt_promises.length; i++) {\n        this.add(opt_promises[i]);\n      }\n    }\n  }\n\n  /**\n   * Add a promise to possibly be resolved.\n   * @param {!Promise} promise\n   * @return {!Promise}\n   */\n  add(promise) {\n    const countAtAdd = ++this.count_;\n    Promise.resolve(promise).then(result => {\n      if (this.count_ === countAtAdd) {\n        this.resolve_(result);\n      }\n    }, error => {\n      // Don't follow behavior of Promise.all and Promise.race error so that\n      // this will only reject when most recently added promise fails.\n      if (this.count_ === countAtAdd) {\n        this.reject_(error);\n      }\n    });\n    return this.promise_;\n  }\n\n  /** @override */\n  then(opt_resolve, opt_reject) {\n    return this.promise_.then(opt_resolve, opt_reject);\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Wraps a given callback and applies a rate limit.\n * It throttles the calls so that no consequent calls have time interval\n * smaller than the given minimal interval.\n *\n * @param {!Window} win\n * @param {function(...*)} callback\n * @param {number} minInterval the minimum time interval in millisecond\n * @return {function(...*)}\n */\nexport function throttle(win, callback, minInterval) {\n  let locker = 0;\n  let nextCallArgs = null;\n\n  /**\n   * @param {!Object} args\n   */\n  function fire(args) {\n    nextCallArgs = null;\n    // Lock the fire for minInterval milliseconds\n    locker = win.setTimeout(waiter, minInterval);\n\n    callback.apply(null, args);\n  }\n\n  /**\n   * Waiter function\n   */\n  function waiter() {\n    locker = 0;\n    // If during the period there're invocations queued up, fire once.\n    if (nextCallArgs) {\n      fire(nextCallArgs);\n    }\n  }\n\n  return function(...args) {\n    if (locker) {\n      nextCallArgs = args;\n    } else {\n      fire(args);\n    }\n  };\n}\n\n/**\n * Wraps a given callback and applies a wait timer, so that minInterval\n * milliseconds must pass since the last call before the callback is actually\n * invoked.\n *\n * @param {!Window} win\n * @param {function(...*)} callback\n * @param {number} minInterval the minimum time interval in millisecond\n * @return {function(...*)}\n */\nexport function debounce(win, callback, minInterval) {\n  let locker = 0;\n  let timestamp = 0;\n  let nextCallArgs = null;\n\n  /**\n   * @param {?Array} args\n   */\n  function fire(args) {\n    nextCallArgs = null;\n    callback.apply(null, args);\n  }\n\n  /**\n   * Wait function for debounce\n   */\n  function waiter() {\n    locker = 0;\n    const remaining = minInterval - (win.Date.now() - timestamp);\n    if (remaining > 0) {\n      locker = win.setTimeout(waiter, remaining);\n    } else {\n      fire(nextCallArgs);\n    }\n  }\n\n  return function(...args) {\n    timestamp = win.Date.now();\n    nextCallArgs = args;\n    if (!locker) {\n      locker = win.setTimeout(waiter, minInterval);\n    }\n  };\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {dev} from '../log';\nimport {once} from './function';\nimport {setStyles} from '../style';\n\n\n/**\n * @param {!Window} win\n * @param {boolean} isLiteViewer\n * @return {!Promise<boolean>}\n */\nfunction isAutoplaySupportedImpl(win, isLiteViewer) {\n  // We do not support autoplay in amp-lite viewer regardless of platform.\n  if (isLiteViewer) {\n    return Promise.resolve(false);\n  }\n\n  // To detect autoplay, we create a video element and call play on it, if\n  // `paused` is true after `play()` call, autoplay is supported. Although\n  // this is unintuitive, it works across browsers and is currently the lightest\n  // way to detect autoplay without using a data source.\n  const detectionElement = win.document.createElement('video');\n\n  // NOTE(aghassemi): We need both attributes and properties due to Chrome and\n  // Safari differences when dealing with non-attached elements.\n  detectionElement.setAttribute('muted', '');\n  detectionElement.setAttribute('playsinline', '');\n  detectionElement.setAttribute('webkit-playsinline', '');\n  detectionElement.setAttribute('height', '0');\n  detectionElement.setAttribute('width', '0');\n\n  detectionElement.muted = true;\n  detectionElement.playsinline = true;\n  detectionElement.webkitPlaysinline = true;\n\n  setStyles(detectionElement, {\n    position: 'fixed',\n    top: '0',\n    width: '0',\n    height: '0',\n    opacity: '0',\n  });\n\n  // Promise wrapped this way to catch both sync throws and async rejections.\n  // More info: https://github.com/tc39/proposal-promise-try\n  new Promise(resolve => resolve(detectionElement.play())).catch(() => {\n    // Suppress any errors, useless to report as they are expected.\n  });\n\n  return Promise.resolve(!detectionElement.paused);\n}\n\n\n/** @private {?(function(Window, boolean):!Promise<boolean>)} */\nlet isAutoplaySupported = null;\n\n/**\n * Sets if autoplay is supported.\n */\nfunction setIsAutoplaySupported() {\n  isAutoplaySupported =\n    /** @type {function(Window, boolean):!Promise<boolean>} */ (\n      once(isAutoplaySupportedImpl));\n}\n\n\n/**\n * Wrapper around static utilities for testability.\n */\nexport class VideoUtils {\n  /**\n   * Determines autoplay support.\n   *\n   * Note that even if platfrom supports autoplay, users or browsers can disable\n   * autoplay to save data / battery. This detects both platfrom support and\n   * when autoplay has been disabled by the user.\n   *\n   * @param {!Window} win\n   * @param {boolean} isLiteViewer\n   * @return {!Promise<boolean>}\n   */\n  static isAutoplaySupported(win, isLiteViewer) {\n    if (!isAutoplaySupported) {\n      setIsAutoplaySupported();\n    }\n    return isAutoplaySupported(win, isLiteViewer);\n  }\n\n  /** @visibleForTesting */\n  static resetIsAutoplaySupported() {\n    setIsAutoplaySupported();\n  }\n}\n\n/**\n * @param {!Element} element\n * @return {!Element}\n * Note: Not included in `VideoUtils` as we don't need to test a\n * static selector.\n */\nexport function getInternalVideoElementFor(element) {\n  return dev().assertElement(element.querySelector('video, iframe'));\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const MIN_VISIBILITY_RATIO_FOR_AUTOPLAY = 0.5;\n\n/**\n * VideoInterface defines a common video API which any AMP component that plays\n * videos is expected to implement.\n *\n * AMP runtime uses this common API to provide consistent video experience and\n * analytics across all video players.\n *\n * Components implementing this interface must also extend\n * {@link ./base-element.BaseElement} and register with the\n * Video Manager {@link ./service/video-manager-impl.VideoManager} during\n * their `builtCallback`.\n *\n * @interface\n */\nexport class VideoInterface {\n\n  /**\n   * Whether the component supports video playback in the current platform.\n   * If false, component will be not treated as a video component.\n   * @return {boolean}\n   */\n  supportsPlatform() {}\n\n  /**\n   * Whether users can interact with the video such as pausing it.\n   * Example of non-interactive videos include design background videos where\n   * all controls are hidden from the user.\n   *\n   * @return {boolean}\n   */\n  isInteractive() {}\n\n  /**\n   * Current playback time in seconds at time of trigger\n   * @return {number}\n   */\n  getCurrentTime() {}\n\n  /**\n   * Total duration of the video in seconds\n   * @return {number}\n   */\n  getDuration() {}\n\n  /**\n   * Get a 2d array of start and stop times that the user has watched.\n   * @return {!Array<Array<number>>}\n   */\n  getPlayedRanges() {}\n\n  /**\n   * Plays the video..\n   *\n   * @param {boolean} unusedIsAutoplay Whether the call to the `play` method is\n   * triggered by the autoplay functionality. Video players can use this hint\n   * to make decisions such as not playing pre-roll video ads.\n   */\n  play(unusedIsAutoplay) {}\n\n  /**\n   * Pauses the video.\n   */\n  pause() {}\n\n  /**\n   * Mutes the video.\n   */\n  mute() {}\n\n  /**\n   * Unmutes the video.\n   */\n  unmute() {}\n\n  /**\n   * Makes the video UI controls visible.\n   *\n   * AMP will not call this method if `controls` attribute is not set.\n   */\n  showControls() {}\n\n  /**\n   * Hides the video UI controls.\n   *\n   * AMP will not call this method if `controls` attribute is not set.\n   */\n  hideControls() {}\n\n  /**\n   * Returns video's meta data (artwork, title, artist, album, etc.) for use\n   * with the Media Session API\n   * artwork (Array): URL to the poster image (preferably a 512x512 PNG)\n   * title (string): Name of the video\n   * artist (string): Name of the video's author/artist\n   * album (string): Name of the video's album if it exists\n   * @return {!./mediasession-helper.MetadataDef|undefined} metadata\n   */\n  getMetadata() {}\n\n  /**\n   * If this returns true then it will be assumed that the player implements\n   * a feature to enter fullscreen on device rotation internally, so that the\n   * video manager does not override it. If not, the video manager will\n   * implement this feature automatically for videos with the attribute\n   * `rotate-to-fullscreen`.\n   *\n   * @return {boolean}\n   */\n  preimplementsAutoFullscreen() {}\n\n  /**\n   * If this returns true then it will be assumed that the player implements\n   * the MediaSession API internally so that the video manager does not override\n   * it. If not, the video manager will use the metadata variable as well as\n   * inferred meta-data to update the video's Media Session notification.\n   *\n   * @return {boolean}\n   */\n  preimplementsMediaSessionAPI() {}\n\n  /**\n   * Enables fullscreen on the internal video element\n   * NOTE: While implementing, keep in mind that Safari/iOS do not allow taking\n   * any element other than <video> to fullscreen, if the player has an internal\n   * implementation of fullscreen (flash for example) then check\n   * if Services.platformFor(this.win).isSafari is true and use the internal\n   * implementation instead. If not, it is recommended to take the iframe\n   * to fullscreen using fullscreenEnter from dom.js\n   */\n  fullscreenEnter() {}\n\n  /**\n   * Quits fullscreen mode\n   */\n  fullscreenExit() {}\n\n  /**\n   * Returns whether the video is currently in fullscreen mode or not\n   * @return {boolean}\n   */\n  isFullscreen() {}\n}\n\n\n/**\n * Attributes\n *\n * Components implementing the VideoInterface are expected to support\n * the following attributes.\n *\n * @constant {!Object<string, string>}\n */\nexport const VideoAttributes = {\n  /**\n   * autoplay\n   *\n   * Whether the developer has configured autoplay on the component.\n   * This is normally done by setting `autoplay` attribute on the component.\n   *\n   * AMP runtime manages autoplay behaviour itself using methods such as `play`,\n   * `pause`, `showControls`, `hideControls`, `mute`, etc.. therefore components\n   * should not propagate the autoplay attribute to the underlying player\n   * implementation.\n   *\n   * When a video is requested to autoplay, AMP will automatically\n   * mute and hide the controls for the video, when video is 75% visible in\n   * the viewport, AMP will play the video and later pauses it when 25%\n   * or more of the video exits the viewport. If an auto-playing video also has\n   * controls, AMP will install a tap\n   * handler on the video, and when an end-user taps the video, AMP will show\n   * the controls.\n   *\n   */\n  AUTOPLAY: 'autoplay',\n  /**\n   * dock\n   *\n   * Setting the `dock` attribute on the component makes the video minimize\n   * to the corner when scrolled out of view and has been interacted with.\n   */\n  DOCK: 'dock',\n  /**\n   * rotate-to-fullscreen\n   *\n   * If enabled, this automatically expands the currently visible video and\n   * playing to fullscreen when the user changes the device's orientation to\n   * landscape if the video was started following a user interaction\n   * (not autoplay)\n   *\n   * Dependent upon browser support of\n   * http://caniuse.com/#feat=screen-orientation\n   * and http://caniuse.com/#feat=fullscreen\n   */\n  ROTATE_TO_FULLSCREEN: 'rotate-to-fullscreen',\n  /**\n   * noaudio\n   *\n   * If set and autoplay, the equalizer icon will not be displayed.\n   */\n  NO_AUDIO: 'noaudio',\n};\n\n\n/**\n * Events\n *\n * Components implementing the VideoInterface are expected to dispatch\n * the following DOM events.\n *\n * @constant {!Object<string, string>}\n */\nexport const VideoEvents = {\n  /**\n   * registered\n   *\n   * Fired when the video player element is built and has been registered with\n   * the video manager.\n   *\n   * @event registered\n   */\n  REGISTERED: 'registered',\n\n  /**\n   * load\n   *\n   * Fired when the video player is loaded and calls to methods such as `play()`\n   * are allowed.\n   *\n   * @event load\n   */\n  LOAD: 'load',\n\n  /**\n   * playing\n   *\n   * Fired when the video begins playing.\n   *\n   * @event playing\n   */\n  PLAYING: 'playing',\n\n  /**\n   * pause\n   *\n   * Fired when the video pauses.\n   *\n   * @event pause\n   */\n  PAUSE: 'pause',\n\n  /**\n   * ended\n   *\n   * Fired when the video ends.\n   *\n   * This event should be fired in addition to `pause` when video ends.\n   *\n   * @event ended\n   */\n  ENDED: 'ended',\n\n  /**\n   * muted\n   *\n   * Fired when the video is muted.\n   *\n   * @event muted\n   */\n  MUTED: 'muted',\n\n  /**\n   * unmuted\n   *\n   * Fired when the video is unmuted.\n   *\n   * @event unmuted\n   */\n  UNMUTED: 'unmuted',\n\n  /**\n   * amp:video:visibility\n   *\n   * Fired when the video's visibility changes. Normally fired\n   * from `viewportCallback`.\n   *\n   * @event amp:video:visibility\n   * @property {boolean} visible Whether the video player is visible or not.\n   */\n  VISIBILITY: 'amp:video:visibility',\n\n  /**\n   * reload\n   *\n   * Fired when the video's src changes.\n   *\n   * @event reloaded\n   */\n  RELOAD: 'reloaded',\n\n  /**\n   * pre/mid/post Ad start\n   *\n   * Fired when an Ad starts playing.\n   *\n   * This is used to remove any overlay shims during Ad play during autoplay\n   * or minimized-to-corner version of the player.\n   *\n   * @event ad_start\n   */\n  AD_START: 'ad_start',\n\n  /**\n   * pre/mid/post Ad ends\n   *\n   * Fired when an Ad ends playing.\n   *\n   * This is used to restore any overlay shims during Ad play during autoplay\n   * or minimized-to-corner version of the player.\n   *\n   * @event ad_end\n   */\n  AD_END: 'ad_end',\n};\n\n\n/**\n * Playing States\n *\n * Internal playing states used to distinguish between video playing on user's\n * command and videos playing automatically\n *\n * @constant {!Object<string, string>}\n */\nexport const PlayingStates = {\n  /**\n   * playing_manual\n   *\n   * When the video user manually interacted with the video and the video\n   * is now playing\n   *\n   * @event playing_manual\n   */\n  PLAYING_MANUAL: 'playing_manual',\n\n  /**\n   * playing_auto\n   *\n   * When the video has autoplay and the user hasn't interacted with it yet\n   *\n   * @event playing_auto\n   */\n  PLAYING_AUTO: 'playing_auto',\n\n  /**\n   * paused\n   *\n   * When the video is paused.\n   *\n   * @event paused\n   */\n  PAUSED: 'paused',\n};\n\n\n/** @enum {string} */\nexport const VideoAnalyticsEvents = {\n  /**\n   * video-ended\n   *\n   * Indicates that a video ended.\n   * @property {!VideoAnalyticsDetailsDef} details\n   * @event video-ended\n   */\n  ENDED: 'video-ended',\n\n  /**\n   * video-pause\n   *\n   * Indicates that a video paused.\n   * @property {!VideoAnalyticsDetailsDef} details\n   * @event video-pause\n   */\n  PAUSE: 'video-pause',\n\n  /**\n   * video-play\n   *\n   * Indicates that a video began to play.\n   * @property {!VideoAnalyticsDetailsDef} details\n   * @event video-play\n   */\n  PLAY: 'video-play',\n\n  /**\n   * video-session\n   *\n   * Indicates that some segment of the video played.\n   * @property {!VideoAnalyticsDetailsDef} details\n   * @event video-session\n   */\n  SESSION: 'video-session',\n\n  /**\n   * video-session-visible\n   *\n   * Indicates that some segment of the video played in the viewport.\n   * @property {!VideoAnalyticsDetailsDef} details\n   * @event video-session-visible\n   */\n  SESSION_VISIBLE: 'video-session-visible',\n\n  /**\n   * video-seconds-played\n   *\n   * Indicates that a video was playing when the\n   * video-seconds-played interval fired.\n   * @property {!VideoAnalyticsDetailsDef} details\n   * @event video-session-visible\n   */\n  SECONDS_PLAYED: 'video-seconds-played',\n};\n\n\n/**\n * @typedef {{\n *   autoplay: boolean,\n *   currentTime: number,\n *   duration: number,\n *   height: number,\n *   id: string,\n *   playedRangesJson: string,\n *   playedTotal: number,\n *   muted: boolean,\n *   state: string,\n *   width: number\n * }}\n */\nexport let VideoAnalyticsDetailsDef;\n\n\n/**\n * Helper union type to be used internally, so that the compiler treats\n * `VideoInterface` objects as `BaseElement`s, which they should be anyway.\n *\n * WARNING: Don't use this at the service level. Its `register` method should\n * only allow `VideoInterface` as a guarding measure.\n *\n * @typedef {!VideoInterface|!./base-element.BaseElement}\n */\nexport let VideoOrBaseElementDef;\n","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n\n\n/**\n * This regex consists of 4 matching capture groups and one (non-matching) fallback:\n *\n * - (\\0), catch the null terminator character so it may be replaced by UTF\n *   Replacement Char\n * - ^(-)$, catch a solitary dash char, so that it may be backslash escaped.\n *   This is a separate capture group so that the legal-chars (group 4) doesn't\n *   capture it first, since that group doesn't need to escape its dash.\n * - ([\\x01-\\x1f\\x7f]|^-?[0-9]), catch a UTF control char, or any leading\n *   number (with an optional leading dash). The control or the number (but not\n *   the leading dash) must be hex-escaped,.\n * - ([\\x80-\\uffff0-9a-zA-Z_-]+), catch legal-chars, with the exception of a\n *   solitary dash, which will already have matched in group 1.\n * - [^], finally, a catch-all that allows us to backslash escape the char.\n *\n * Together, this matches everything necessary for CSS.escape.\n */\nvar regex = /(\\0)|^(-)$|([\\x01-\\x1f\\x7f]|^-?[0-9])|([\\x80-\\uffff0-9a-zA-Z_-]+)|[^]/g;\n\nfunction escaper(match, nil, dash, hexEscape, chars) {\n  // Chars is the legal-chars (group 4) capture\n  if (chars) {\n    return chars;\n  }\n  // Nil is the null terminator (group 1) capture\n  if (nil) {\n    return '\\uFFFD';\n  }\n  // Both UTF control chars, and leading numbers (with optional leading dash)\n  // (group 3) must be backslash escaped with a trailing space.  Funnily, the\n  // leading dash must not be escaped, but the number. :shrug:\n  if (hexEscape) {\n    return match.slice(0, -1) + '\\\\' + match.slice(-1).charCodeAt(0).toString(16) + ' '\n  }\n  // Finally, the solitary dash and the catch-all chars require backslash\n  // escaping.\n  return '\\\\' + match;\n}\n\n/**\n * https://drafts.csswg.org/cssom/#serialize-an-identifier\n * @param {string} value\n * @return {string}\n */\nexport function cssEscape(value) {\n  return String(value).replace(regex, escaper);\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJidWlsZC92aWRlby1hdXRvcGxheS5jc3MuanMiLCJidWlsZC92aWRlby1kb2NraW5nLmNzcy5qcyIsImV4dGVuc2lvbnMvYW1wLXZpZGVvLWlmcmFtZS8wLjEvYW1wLXZpZGVvLWlmcmFtZS5qcyIsIm5vZGVfbW9kdWxlcy9kb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50L2J1aWxkL2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQucGF0Y2hlZC5qcyIsIm5vZGVfbW9kdWxlcy9wcm9taXNlLXBqcy9wcm9taXNlLmpzIiwic3JjLzNwLWZyYW1lLW1lc3NhZ2luZy5qcyIsInNyYy9hY3Rpb24tY29uc3RhbnRzLmpzIiwic3JjL2NvbmZpZy5qcyIsInNyYy9jb29raWVzLmpzIiwic3JjL2RvbS5qcyIsInNyYy9lbGVtZW50LXNlcnZpY2UuanMiLCJzcmMvZXZlbnQtaGVscGVyLWxpc3Rlbi5qcyIsInNyYy9ldmVudC1oZWxwZXIuanMiLCJzcmMvZXhwZXJpbWVudHMuanMiLCJzcmMvaWZyYW1lLWhlbHBlci5qcyIsInNyYy9pZnJhbWUtdmlkZW8uanMiLCJzcmMvanNvbi5qcyIsInNyYy9sYXlvdXQtcmVjdC5qcyIsInNyYy9sYXlvdXQuanMiLCJzcmMvbG9nLmpzIiwic3JjL21lZGlhc2Vzc2lvbi1oZWxwZXIuanMiLCJzcmMvbW9kZS1vYmplY3QuanMiLCJzcmMvbW9kZS5qcyIsInNyYy9vYnNlcnZhYmxlLmpzIiwic3JjL3BvbHlmaWxscy5qcyIsInNyYy9wb2x5ZmlsbHMvYXJyYXktaW5jbHVkZXMuanMiLCJzcmMvcG9seWZpbGxzL2N1c3RvbS1lbGVtZW50cy5qcyIsInNyYy9wb2x5ZmlsbHMvZG9jdW1lbnQtY29udGFpbnMuanMiLCJzcmMvcG9seWZpbGxzL2RvbXRva2VubGlzdC10b2dnbGUuanMiLCJzcmMvcG9seWZpbGxzL21hdGgtc2lnbi5qcyIsInNyYy9wb2x5ZmlsbHMvb2JqZWN0LWFzc2lnbi5qcyIsInNyYy9wb2x5ZmlsbHMvcHJvbWlzZS5qcyIsInNyYy9yZW5kZXItZGVsYXlpbmctc2VydmljZXMuanMiLCJzcmMvc2VydmljZS5qcyIsInNyYy9zZXJ2aWNlL3Bvc2l0aW9uLW9ic2VydmVyL3Bvc2l0aW9uLW9ic2VydmVyLWltcGwuanMiLCJzcmMvc2VydmljZS9wb3NpdGlvbi1vYnNlcnZlci9wb3NpdGlvbi1vYnNlcnZlci13b3JrZXIuanMiLCJzcmMvc2VydmljZS92aWRlby1tYW5hZ2VyLWltcGwuanMiLCJzcmMvc2VydmljZS92aWRlby1zZXJ2aWNlLWludGVyZmFjZS5qcyIsInNyYy9zZXJ2aWNlL3ZpZGVvLXNlcnZpY2Utc3luYy1pbXBsLmpzIiwic3JjL3NlcnZpY2UvdmlkZW8tc2Vzc2lvbi1tYW5hZ2VyLmpzIiwic3JjL3NlcnZpY2UvdmlkZW8vYXV0b3BsYXkuanMiLCJzcmMvc2VydmljZS92aWRlby9kb2NraW5nLmpzIiwic3JjL3NlcnZpY2UvdmlkZW8vaW5zdGFsbC1hdXRvcGxheS1zdHlsZXMuanMiLCJzcmMvc2VydmljZXMuanMiLCJzcmMvc3RhdGljLXRlbXBsYXRlLmpzIiwic3JjL3N0cmluZy5qcyIsInNyYy9zdHlsZS1pbnN0YWxsZXIuanMiLCJzcmMvc3R5bGUuanMiLCJzcmMvdHlwZXMuanMiLCJzcmMvdXJsLXBhcnNlLXF1ZXJ5LXN0cmluZy5qcyIsInNyYy91cmwtdHJ5LWRlY29kZS11cmktY29tcG9uZW50LmpzIiwic3JjL3VybC5qcyIsInNyYy91dGlscy9hcnJheS5qcyIsInNyYy91dGlscy9mdW5jdGlvbi5qcyIsInNyYy91dGlscy9scnUtY2FjaGUuanMiLCJzcmMvdXRpbHMvbWF0aC5qcyIsInNyYy91dGlscy9vYmplY3QuanMiLCJzcmMvdXRpbHMvcHJvbWlzZS5qcyIsInNyYy91dGlscy9yYXRlLWxpbWl0LmpzIiwic3JjL3V0aWxzL3ZpZGVvLmpzIiwic3JjL3ZpZGVvLWludGVyZmFjZS5qcyIsInRoaXJkX3BhcnR5L2Nzcy1l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QUFKLENBQW9CLEdBQXBCLEVBQXlCLGNBQXpCO0FBQ0QsQ0FGRDs7O0FDcGFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ242Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7UUN6YmdCLE0sR0FBQSxNO1FBZUEsZ0IsR0FBQSxnQjtRQWlCQSxrQixHQUFBLGtCO1FB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O0FBQ0Q7QUFDRDtBQUNBLE1BQUksR0FBSixFQUFTO0FBQ1AsV0FBTyxRQUFQO0FBQ0Q7QUFDRDtBQUNBO0FBQ0E7QUFDQSxNQUFJLFNBQUosRUFBZTtBQUNiLFdBQU8sTUFBTSxLQUFOLENBQVksQ0FBWixFQUFlLENBQUMsQ0FBaEIsSUFBcUIsSUFBckIsR0FBNEIsTUFBTSxLQUFOLENBQVksQ0FBQyxDQUFiLEVBQWdCLFVBQWhCLENBQTJCLENBQTNCLEVBQThCLFFBQTlCLENBQXVDLEVBQXZDLENBQTVCLEdBQXlFLEdBQWhGO0FBQ0Q7QUFDRDtBQUNBO0FBQ0EsU0FBTyxPQUFPLEtBQWQ7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLFNBQVQsQ0FBbUIsS0FBbkIsRUFBMEI7QUFDL0IsU0FBTyxPQUFPLEtBQVAsRUFBYyxPQUFkLENBQXNCLEtBQXRCLEVBQTZCLE9BQTdCLENBQVA7QUFDRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJleHBvcnQgY29uc3QgY3NzVGV4dCA9IFwiaS1hbXBodG1sLXZpZGVvLW1hc2t7ei1pbmRleDoxfS5hbXAtdmlkZW8tZXF7ZGlzcGxheTpub25lfS5pLWFtcGh0bWwtdmlkZW8tY29tcG9uZW50Om5vdChhbXAtdmlkZW8pIC5hbXAtdmlkZW8tZXEsYW1wLXN0b3J5IC5hbXAtdmlkZW8tZXEsYW1wLXZpZGVvW2NvbnRyb2xzXSAuYW1wLXZpZGVvLWVxe2Rpc3BsYXk6LXdlYmtpdC1ib3g7ZGlzcGxheTotbXMtZmxleGJveDtkaXNwbGF5OmZsZXh9W25vYXVkaW9dIC5hbXAtdmlkZW8tZXF7ZGlzcGxheTpub25lIWltcG9ydGFudH0uYW1wLXZpZGVvLWVxe3BvaW50ZXItZXZlbnRzOm5vbmUhaW1wb3J0YW50Oy13ZWJraXQtYm94LWFsaWduOmVuZDstbXMtZmxleC1hbGlnbjplbmQ7YWxpZ24taXRlbXM6ZmxleC1lbmQ7Ym90dG9tOjdweDtoZWlnaHQ6MTJweDtvcGFjaXR5OjAuODtvdmVyZmxvdzpoaWRkZW47cG9zaXRpb246YWJzb2x1dGU7cmlnaHQ6N3B4O3dpZHRoOjIwcHg7ei1pbmRleDoxfS5hbXAtdmlkZW8tZXEgLmFtcC12aWRlby1lcS1jb2x7LXdlYmtpdC1ib3gtZmxleDoxOy1tcy1mbGV4OjE7ZmxleDoxO2hlaWdodDoxMDAlO21hcmdpbi1yaWdodDoxcHg7cG9zaXRpb246cmVsYXRpdmV9LmFtcC12aWRlby1lcSAuYW1wLXZpZGVvLWVxLWNvbCBkaXZ7LXdlYmtpdC1hbmltYXRpb24tbmFtZTphbXAtdmlkZW8tZXEtYW5pbWF0aW9uO2FuaW1hdGlvbi1uYW1lOmFtcC12aWRlby1lcS1hbmltYXRpb247LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcjthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcjstd2Via2l0LWFuaW1hdGlvbi1pdGVyYXRpb24tY291bnQ6aW5maW5pdGU7YW5pbWF0aW9uLWl0ZXJhdGlvbi1jb3VudDppbmZpbml0ZTstd2Via2l0LWFuaW1hdGlvbi1kaXJlY3Rpb246YWx0ZXJuYXRlO2FuaW1hdGlvbi1kaXJlY3Rpb246YWx0ZXJuYXRlO2JhY2tncm91bmQtY29sb3I6I2ZhZmFmYTtoZWlnaHQ6MTAwJTtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDoxMDAlO3dpbGwtY2hhbmdlOnRyYW5zZm9ybTstd2Via2l0LWFuaW1hdGlvbi1wbGF5LXN0YXRlOnBhdXNlZDthbmltYXRpb24tcGxheS1zdGF0ZTpwYXVzZWR9LmFtcC12aWRlby1lcVt1bnBhdXNhYmxlXSAuYW1wLXZpZGVvLWVxLWNvbCBkaXZ7LXdlYmtpdC1hbmltYXRpb24tbmFtZTpub25lO2FuaW1hdGlvbi1uYW1lOm5vbmV9LmFtcC12aWRlby1lcVt1bnBhdXNhYmxlXS5hbXAtdmlkZW8tZXEtcGxheSAuYW1wLXZpZGVvLWVxLWNvbCBkaXZ7LXdlYmtpdC1hbmltYXRpb24tbmFtZTphbXAtdmlkZW8tZXEtYW5pbWF0aW9uO2FuaW1hdGlvbi1uYW1lOmFtcC12aWRlby1lcS1hbmltYXRpb259LmFtcC12aWRlby1lcS5hbXAtdmlkZW8tZXEtcGxheSAuYW1wLXZpZGVvLWVxLWNvbCBkaXZ7LXdlYmtpdC1hbmltYXRpb24tcGxheS1zdGF0ZTpydW5uaW5nO2FuaW1hdGlvbi1wbGF5LXN0YXRlOnJ1bm5pbmd9LmFtcC12aWRlby1lcS0xLTF7LXdlYmtpdC1hbmltYXRpb24tZHVyYXRpb246MC4zczthbmltYXRpb24tZHVyYXRpb246MC4zc30uYW1wLXZpZGVvLWVxLTEtMSwuYW1wLXZpZGVvLWVxLTEtMnstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKDYwJSk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoNjAlKX0uYW1wLXZpZGVvLWVxLTEtMnstd2Via2l0LWFuaW1hdGlvbi1kdXJhdGlvbjowLjQ1czthbmltYXRpb24tZHVyYXRpb246MC40NXN9LmFtcC12aWRlby1lcS0yLTF7LXdlYmtpdC1hbmltYXRpb24tZHVyYXRpb246MC41czthbmltYXRpb24tZHVyYXRpb246MC41c30uYW1wLXZpZGVvLWVxLTItMSwuYW1wLXZpZGVvLWVxLTItMnstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKDMwJSk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMzAlKX0uYW1wLXZpZGVvLWVxLTItMnstd2Via2l0LWFuaW1hdGlvbi1kdXJhdGlvbjowLjRzO2FuaW1hdGlvbi1kdXJhdGlvbjowLjRzfS5hbXAtdmlkZW8tZXEtMy0xey13ZWJraXQtYW5pbWF0aW9uLWR1cmF0aW9uOjAuM3M7YW5pbWF0aW9uLWR1cmF0aW9uOjAuM3N9LmFtcC12aWRlby1lcS0zLTEsLmFtcC12aWRlby1lcS0zLTJ7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSg3MCUpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKDcwJSl9LmFtcC12aWRlby1lcS0zLTJ7LXdlYmtpdC1hbmltYXRpb24tZHVyYXRpb246MC4zNXM7YW5pbWF0aW9uLWR1cmF0aW9uOjAuMzVzfS5hbXAtdmlkZW8tZXEtNC0xey13ZWJraXQtYW5pbWF0aW9uLWR1cmF0aW9uOjAuNHM7YW5pbWF0aW9uLWR1cmF0aW9uOjAuNHN9LmFtcC12aWRlby1lcS00LTEsLmFtcC12aWRlby1lcS00LTJ7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSg1MCUpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKDUwJSl9LmFtcC12aWRlby1lcS00LTJ7LXdlYmtpdC1hbmltYXRpb24tZHVyYXRpb246MC4yNXM7YW5pbWF0aW9uLWR1cmF0aW9uOjAuMjVzfUAtd2Via2l0LWtleWZyYW1lcyBhbXAtdmlkZW8tZXEtYW5pbWF0aW9uezAley13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTAwJSk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTAwJSl9dG97LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgwKTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgwKX19QGtleWZyYW1lcyBhbXAtdmlkZW8tZXEtYW5pbWF0aW9uezAley13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTAwJSk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTAwJSl9dG97LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgwKTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgwKX19XFxuLyojIHNvdXJjZVVSTD0vY3NzL3ZpZGVvLWF1dG9wbGF5LmNzcyovXCIiLCJleHBvcnQgY29uc3QgY3NzVGV4dCA9IFwiLmFtcC12aWRlby1kb2NrZWQtY29udHJvbHN7b3BhY2l0eTowO3BvaW50ZXItZXZlbnRzOm5vbmUhaW1wb3J0YW50Oy13ZWJraXQtdHJhbnNpdGlvbjpvcGFjaXR5IDAuM3MgZWFzZTt0cmFuc2l0aW9uOm9wYWNpdHkgMC4zcyBlYXNlO2hlaWdodDoxMjBweH0uYW1wLXZpZGVvLWRvY2tlZC1tYWluLWJ1dHRvbi1ncm91cHtoZWlnaHQ6NDBweDtkaXNwbGF5Oi13ZWJraXQtYm94O2Rpc3BsYXk6LW1zLWZsZXhib3g7ZGlzcGxheTpmbGV4Oy13ZWJraXQtYm94LWFsaWduOmNlbnRlcjstbXMtZmxleC1hbGlnbjpjZW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyOy13ZWJraXQtYm94LXBhY2s6Y2VudGVyOy1tcy1mbGV4LXBhY2s6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7bWFyZ2luOi0yMHB4IDAgMCAtNjBweH0uYW1wLXZpZGVvLWRvY2tlZC1jb250cm9scy1zaG93bntvcGFjaXR5OjE7cG9pbnRlci1ldmVudHM6aW5pdGlhbCFpbXBvcnRhbnR9LmFtcC12aWRlby1kb2NrZWQtYnV0dG9uLWdyb3Vwe21hcmdpbjowfS5hbXAtdmlkZW8tZG9ja2VkLWJ1dHRvbi1kaXNtaXNzLWdyb3VwLC5hbXAtdmlkZW8tZG9ja2VkLWJ1dHRvbi1kaXNtaXNzLWdyb3VwPmRpdltyb2xlPWJ1dHRvbl0sLmFtcC12aWRlby1kb2NrZWQtYnV0dG9uLWdyb3VwLC5hbXAtdmlkZW8tZG9ja2VkLWJ1dHRvbi1ncm91cD5kaXZbcm9sZT1idXR0b25de21pbi13aWR0aDo0MHB4O2hlaWdodDo0MHB4O2JvcmRlci1yYWRpdXM6NDBweH0uYW1wLXZpZGVvLWRvY2tlZC1idXR0b24tZGlzbWlzcy1ncm91cDphY3RpdmUsLmFtcC12aWRlby1kb2NrZWQtYnV0dG9uLWdyb3VwOmFjdGl2ZXtiYWNrZ3JvdW5kLWNvbG9yOmhzbGEoMCwwJSwxMDAlLDAuNyl9LmFtcC12aWRlby1kb2NrZWQtYnV0dG9uLWRpc21pc3MtZ3JvdXA+ZGl2W3JvbGU9YnV0dG9uXSwuYW1wLXZpZGVvLWRvY2tlZC1idXR0b24tZ3JvdXAsLmFtcC12aWRlby1kb2NrZWQtYnV0dG9uLWdyb3VwPmRpdltyb2xlPWJ1dHRvbl0sLmFtcC12aWRlby1kb2NrZWQtY29udHJvbHMsLmktYW1waHRtbC12aWRlby1kb2NrZWQtb3ZlcmxheXstd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6cmdiYSgwLDAsMCwwKSFpbXBvcnRhbnR9LmFtcC12aWRlby1kb2NrZWQtYnV0dG9uLWRpc21pc3MtZ3JvdXA+ZGl2W3JvbGU9YnV0dG9uXSwuYW1wLXZpZGVvLWRvY2tlZC1idXR0b24tZ3JvdXA+ZGl2W3JvbGU9YnV0dG9uXXtiYWNrZ3JvdW5kLXJlcGVhdDpuby1yZXBlYXQ7YmFja2dyb3VuZC1wb3NpdGlvbjo1MCV9LmFtcC12aWRlby1kb2NrZWQtc2hhZG93e2JveC1zaGFkb3c6MHB4IDAgMjBweCA2cHggcmdiYSgwLDAsMCwwLjIpfS5hbXAtdmlkZW8tZG9ja2VkLWNvbnRyb2xzLWJne2JhY2tncm91bmQ6aHNsYSgwLDAlLDkwLjIlLDAuNil9LmFtcC12aWRlby1kb2NrZWQtbXV0ZXtiYWNrZ3JvdW5kLWltYWdlOnVybChcXFwiZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgsJTNDc3ZnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zycgd2lkdGg9JzI0JyBoZWlnaHQ9JzI0JyUzRSUzQ3BhdGggZD0nTTMgOXY2aDRsNSA1VjRMNyA5SDN6bTEzLjUgM0E0LjUgNC41IDAgMCAwIDE0IDcuOTd2OC4wNWMxLjQ4LS43MyAyLjUtMi4yNSAyLjUtNC4wMnpNMTQgMy4yM3YyLjA2YzIuODkuODYgNSAzLjU0IDUgNi43MXMtMi4xMSA1Ljg1LTUgNi43MXYyLjA2YzQuMDEtLjkxIDctNC40OSA3LTguNzdzLTIuOTktNy44Ni03LTguNzd6Jy8lM0UlM0NwYXRoIGQ9J00wIDBoMjR2MjRIMHonIGZpbGw9J25vbmUnLyUzRSUzQy9zdmclM0VcXFwiKX0uYW1wLXZpZGVvLWRvY2tlZC11bm11dGV7YmFja2dyb3VuZC1pbWFnZTp1cmwoXFxcImRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PXV0Zi04LCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCclM0UlM0NwYXRoIGQ9J00xNi41IDEyQTQuNSA0LjUgMCAwIDAgMTQgNy45N3YyLjIxbDIuNDUgMi40NWMuMDMtLjIuMDUtLjQxLjA1LS42M3ptMi41IDBjMCAuOTQtLjIgMS44Mi0uNTQgMi42NGwxLjUxIDEuNTFBOC43OTYgOC43OTYgMCAwIDAgMjEgMTJjMC00LjI4LTIuOTktNy44Ni03LTguNzd2Mi4wNmMyLjg5Ljg2IDUgMy41NCA1IDYuNzF6TTQuMjcgM0wzIDQuMjcgNy43MyA5SDN2Nmg0bDUgNXYtNi43M2w0LjI1IDQuMjVjLS42Ny41Mi0xLjQyLjkzLTIuMjUgMS4xOHYyLjA2YTguOTkgOC45OSAwIDAgMCAzLjY5LTEuODFMMTkuNzMgMjEgMjEgMTkuNzNsLTktOUw0LjI3IDN6TTEyIDRMOS45MSA2LjA5IDEyIDguMThWNHonLyUzRSUzQ3BhdGggZD0nTTAgMGgyNHYyNEgweicgZmlsbD0nbm9uZScvJTNFJTNDL3N2ZyUzRVxcXCIpfS5hbXAtdmlkZW8tZG9ja2VkLXBhdXNle2JhY2tncm91bmQtaW1hZ2U6dXJsKFxcXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCwlM0NzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB3aWR0aD0nMjQnIGhlaWdodD0nMjQnJTNFJTNDcGF0aCBkPSdNNiAxOWg0VjVINnYxNHptOC0xNHYxNGg0VjVoLTR6Jy8lM0UlM0NwYXRoIGQ9J00wIDBoMjR2MjRIMHonIGZpbGw9J25vbmUnLyUzRSUzQy9zdmclM0VcXFwiKX0uYW1wLXZpZGVvLWRvY2tlZC1wbGF5e2JhY2tncm91bmQtaW1hZ2U6dXJsKFxcXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCwlM0NzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB3aWR0aD0nMjQnIGhlaWdodD0nMjQnJTNFJTNDcGF0aCBkPSdNOCA1djE0bDExLTd6Jy8lM0UlM0NwYXRoIGQ9J00wIDBoMjR2MjRIMHonIGZpbGw9J25vbmUnLyUzRSUzQy9zdmclM0VcXFwiKX0uYW1wLXZpZGVvLWRvY2tlZC1mdWxsc2NyZWVue2JhY2tncm91bmQtaW1hZ2U6dXJsKFxcXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCwlM0NzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB3aWR0aD0nMjQnIGhlaWdodD0nMjQnJTNFJTNDcGF0aCBkPSdNMCAwaDI0djI0SDB6JyBmaWxsPSdub25lJy8lM0UlM0NwYXRoIGQ9J003IDE0SDV2NWg1di0ySDd2LTN6bS0yLTRoMlY3aDNWNUg1djV6bTEyIDdoLTN2Mmg1di01aC0ydjN6TTE0IDV2MmgzdjNoMlY1aC01eicvJTNFJTNDL3N2ZyUzRVxcXCIpfS5hbXAtdmlkZW8tZG9ja2VkLWRpc21pc3N7YmFja2dyb3VuZC1pbWFnZTp1cmwoXFxcImRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PXV0Zi04LCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCclM0UlM0NwYXRoIGQ9J00xOSA2LjQxTDE3LjU5IDUgMTIgMTAuNTkgNi40MSA1IDUgNi40MSAxMC41OSAxMiA1IDE3LjU5IDYuNDEgMTkgMTIgMTMuNDEgMTcuNTkgMTkgMTkgMTcuNTkgMTMuNDEgMTJ6Jy8lM0UlM0NwYXRoIGQ9J00wIDBoMjR2MjRIMHonIGZpbGw9J25vbmUnLyUzRSUzQy9zdmclM0VcXFwiKX0uYW1wLXZpZGVvLWRvY2tlZC1zaGFkb3csLmktYW1waHRtbC12aWRlby1kb2NrZWQsLmktYW1waHRtbC12aWRlby1kb2NrZWQtb3ZlcmxheXttYXJnaW46MCFpbXBvcnRhbnR9LmFtcC12aWRlby1kb2NrZWQtY29udHJvbHMsLmFtcC12aWRlby1kb2NrZWQtc2hhZG93LC5pLWFtcGh0bWwtdmlkZW8tZG9ja2VkLC5pLWFtcGh0bWwtdmlkZW8tZG9ja2VkLW92ZXJsYXl7cG9zaXRpb246Zml4ZWQhaW1wb3J0YW50O3RvcDowIWltcG9ydGFudDtsZWZ0OjAhaW1wb3J0YW50O3JpZ2h0OmF1dG8haW1wb3J0YW50O2JvdHRvbTphdXRvIWltcG9ydGFudDtwYWRkaW5nOjAhaW1wb3J0YW50O21pbi13aWR0aDowIWltcG9ydGFudDttaW4taGVpZ2h0OjAhaW1wb3J0YW50O21heC13aWR0aDphdXRvIWltcG9ydGFudDttYXgtaGVpZ2h0OmF1dG8haW1wb3J0YW50Oy13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjpsZWZ0IHRvcCFpbXBvcnRhbnQ7dHJhbnNmb3JtLW9yaWdpbjpsZWZ0IHRvcCFpbXBvcnRhbnQ7d2lsbC1jaGFuZ2U6d2lkdGgsaGVpZ2h0LHRyYW5zaXRpb24sdHJhbnNmb3JtLG9wYWNpdHl9LmktYW1waHRtbC12aWRlby1kb2NrZWQtb3ZlcmxheXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2l0aW9uOm9wYWNpdHkgMC4zcyBlYXNlO3RyYW5zaXRpb246b3BhY2l0eSAwLjNzIGVhc2U7Y29udGFpbjpzdHJpY3QhaW1wb3J0YW50fS5hbXAtdmlkZW8tZG9ja2VkLWNvbnRyb2xzLWJne29wYWNpdHk6MX0uaS1hbXBodG1sLXZpZGVvLWRvY2tlZC1vdmVybGF5LmFtcC12aWRlby1kb2NrZWQtYWxtb3N0LWRpc21pc3NlZHtvcGFjaXR5OjE7YmFja2dyb3VuZDpoc2xhKDAsMCUsMzkuMiUsMC4xKX0uaS1hbXBodG1sLXZpZGVvLWRvY2tlZC1zaGFkb3cuYW1wLXZpZGVvLWRvY2tlZC1hbG1vc3QtZGlzbWlzc2VkLC5pLWFtcGh0bWwtdmlkZW8tZG9ja2VkLmFtcC12aWRlby1kb2NrZWQtYWxtb3N0LWRpc21pc3NlZHtvcGFjaXR5OjAuM30uYW1wLXZpZGVvLWRvY2tlZC1idXR0b24tZGlzbWlzcy1ncm91cHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6LTQwcHh9LmFtcC12aWRlby1kb2NrZWQtY29udHJvbHN7ei1pbmRleDoyMTQ3NDgzNjQ2IWltcG9ydGFudH0uaS1hbXBodG1sLXZpZGVvLWRvY2tlZC1vdmVybGF5e3otaW5kZXg6MjE0NzQ4MzY0NSFpbXBvcnRhbnR9LmktYW1waHRtbC12aWRlby1kb2NrZWR7ei1pbmRleDoyMTQ3NDgzNjQ0IWltcG9ydGFudH0uYW1wLXZpZGVvLWRvY2tlZC1zaGFkb3d7ei1pbmRleDoyMTQ3NDgzNjQzIWltcG9ydGFudH1cXG4vKiMgc291cmNlVVJMPS9jc3MvdmlkZW8tZG9ja2luZy5jc3MqL1wiIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQge0RlZmVycmVkfSBmcm9tICcuLi8uLi8uLi9zcmMvdXRpbHMvcHJvbWlzZSc7XG5pbXBvcnQge01JTl9WSVNJQklMSVRZX1JBVElPX0ZPUl9BVVRPUExBWX0gZnJvbSAnLi4vLi4vLi4vc3JjL3ZpZGVvLWludGVyZmFjZSc7XG5pbXBvcnQge1xuICBTYW5kYm94T3B0aW9ucyxcbiAgY3JlYXRlRnJhbWVGb3IsXG4gIGlzSnNvbk9yT2JqLFxuICBvYmpPclBhcnNlSnNvbixcbiAgb3JpZ2luTWF0Y2hlcyxcbn0gZnJvbSAnLi4vLi4vLi4vc3JjL2lmcmFtZS12aWRlbyc7XG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZXMnO1xuaW1wb3J0IHtWaWRlb0V2ZW50c30gZnJvbSAnLi4vLi4vLi4vc3JjL3ZpZGVvLWludGVyZmFjZSc7XG5pbXBvcnQge2Rldn0gZnJvbSAnLi4vLi4vLi4vc3JjL2xvZyc7XG5pbXBvcnQge2RpY3R9IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtcbiAgZGlzYWJsZVNjcm9sbGluZ09uSWZyYW1lLFxuICBpc0FkTGlrZSxcbiAgbG9va3NMaWtlVHJhY2tpbmdJZnJhbWUsXG59IGZyb20gJy4uLy4uLy4uL3NyYy9pZnJhbWUtaGVscGVyJztcbmltcG9ydCB7Z2V0RGF0YSwgbGlzdGVufSBmcm9tICcuLi8uLi8uLi9zcmMvZXZlbnQtaGVscGVyJztcbmltcG9ydCB7aHRtbEZvcn0gZnJvbSAnLi4vLi4vLi4vc3JjL3N0YXRpYy10ZW1wbGF0ZSc7XG5pbXBvcnQge1xuICBpbnN0YWxsVmlkZW9NYW5hZ2VyRm9yRG9jLFxufSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZS92aWRlby1tYW5hZ2VyLWltcGwnO1xuaW1wb3J0IHtpc0Z1bGxzY3JlZW5FbGVtZW50LCByZW1vdmVFbGVtZW50fSBmcm9tICcuLi8uLi8uLi9zcmMvZG9tJztcbmltcG9ydCB7aXNMYXlvdXRTaXplRGVmaW5lZH0gZnJvbSAnLi4vLi4vLi4vc3JjL2xheW91dCc7XG5cbi8qKiBAcHJpdmF0ZSBAY29uc3QgKi9cbmNvbnN0IFRBRyA9ICdhbXAtdmlkZW8taWZyYW1lJztcblxuLyoqIEBwcml2YXRlIEBjb25zdCAqL1xuY29uc3QgU0FOREJPWCA9IFtcbiAgU2FuZGJveE9wdGlvbnMuQUxMT1dfU0NSSVBUUyxcbiAgU2FuZGJveE9wdGlvbnMuQUxMT1dfU0FNRV9PUklHSU4sXG5dO1xuXG4vKipcbiAqIEV2ZW50cyBhbGxvd2VkIHRvIGJlIGRpc3BhdGNoZWQgZnJvbSBtZXNzYWdlcy5cbiAqIEBwcml2YXRlIEBjb25zdFxuICovXG5jb25zdCBBTExPV0VEX0VWRU5UUyA9IFtcbiAgVmlkZW9FdmVudHMuUExBWUlORyxcbiAgVmlkZW9FdmVudHMuUEFVU0UsXG4gIFZpZGVvRXZlbnRzLkVOREVELFxuICBWaWRlb0V2ZW50cy5NVVRFRCxcbiAgVmlkZW9FdmVudHMuVU5NVVRFRCxcbiAgVmlkZW9FdmVudHMuQURfU1RBUlQsXG4gIFZpZGVvRXZlbnRzLkFEX0VORCxcbl07XG5cbi8qKiBAaW1wbGVtZW50cyB7Li4vLi4vLi4vc3JjL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0gKi9cbmNsYXNzIEFtcFZpZGVvSWZyYW1lIGV4dGVuZHMgQU1QLkJhc2VFbGVtZW50IHtcblxuICAvKiogQHBhcmFtIHshQW1wRWxlbWVudH0gZWxlbWVudCAqL1xuICBjb25zdHJ1Y3RvcihlbGVtZW50KSB7XG4gICAgc3VwZXIoZWxlbWVudCk7XG5cbiAgICAvKiogQHByaXZhdGUgez9FbGVtZW50fSAqL1xuICAgIHRoaXMuaWZyYW1lXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUgeyFVbmxpc3RlbkRlZnxudWxsfSAqL1xuICAgIHRoaXMudW5saXN0ZW5GcmFtZV8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/ZnVuY3Rpb24oKX0gKi9cbiAgICB0aGlzLnJlYWR5UHJvbWlzZV8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/ZnVuY3Rpb24oKX0gKi9cbiAgICB0aGlzLnJlYWR5UmVzb2x2ZXJfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P2Z1bmN0aW9uKCl9ICovXG4gICAgdGhpcy5yZWFkeVJlamVjdGVyXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy5jYW5QbGF5XyA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshRXZlbnR9IGVcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMuYm91bmRPbk1lc3NhZ2VfID0gZSA9PiB0aGlzLm9uTWVzc2FnZV8oZSk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGlzTGF5b3V0U3VwcG9ydGVkKGxheW91dCkge1xuICAgIHJldHVybiBpc0xheW91dFNpemVEZWZpbmVkKGxheW91dCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGJ1aWxkQ2FsbGJhY2soKSB7XG4gICAgY29uc3Qge2VsZW1lbnR9ID0gdGhpcztcblxuICAgIHRoaXMudXNlcigpLmFzc2VydCghaXNBZExpa2UoZWxlbWVudCksXG4gICAgICAgICc8YW1wLXZpZGVvLWlmcmFtZT4gZG9lcyBub3QgYWxsb3cgYWQgaWZyYW1lcy4gJyxcbiAgICAgICAgJ1BsZWFzZSB1c2UgYW1wLWFkIGluc3RlYWQuJyk7XG5cbiAgICB0aGlzLnVzZXIoKS5hc3NlcnQoIWxvb2tzTGlrZVRyYWNraW5nSWZyYW1lKGVsZW1lbnQpLFxuICAgICAgICAnPGFtcC12aWRlby1pZnJhbWU+IGRvZXMgbm90IGFsbG93IHRyYWNraW5nIGlmcmFtZXMuICcsXG4gICAgICAgICdQbGVhc2UgdXNlIGFtcC1hbmFseXRpY3MgaW5zdGVhZC4nKTtcblxuICAgIGluc3RhbGxWaWRlb01hbmFnZXJGb3JEb2MoZWxlbWVudCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGxheW91dENhbGxiYWNrKCkge1xuICAgIGNvbnN0IG5hbWUgPSBKU09OLnN0cmluZ2lmeSh0aGlzLmdldE1ldGFkYXRhXygpKTtcblxuICAgIHRoaXMuaWZyYW1lXyA9XG4gICAgICAgIGRpc2FibGVTY3JvbGxpbmdPbklmcmFtZShcbiAgICAgICAgICAgIGNyZWF0ZUZyYW1lRm9yKHRoaXMsIHRoaXMuZ2V0U3JjXygpLCBuYW1lLCBTQU5EQk9YKSk7XG5cbiAgICB0aGlzLnVubGlzdGVuRnJhbWVfID0gbGlzdGVuKHRoaXMud2luLCAnbWVzc2FnZScsIHRoaXMuYm91bmRPbk1lc3NhZ2VfKTtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVSZWFkeVByb21pc2VfKCkudGhlbigoKSA9PiB0aGlzLm9uUmVhZHlfKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0TWV0YWRhdGFfKCkge1xuICAgIGNvbnN0IHtzb3VyY2VVcmwsIGNhbm9uaWNhbFVybH0gPSBTZXJ2aWNlcy5kb2N1bWVudEluZm9Gb3JEb2ModGhpcy5lbGVtZW50KTtcblxuICAgIHJldHVybiBkaWN0KHtcbiAgICAgICdzb3VyY2VVcmwnOiBzb3VyY2VVcmwsXG4gICAgICAnY2Fub25pY2FsVXJsJzogY2Fub25pY2FsVXJsLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIG9uUmVhZHlfKCkge1xuICAgIGNvbnN0IHtlbGVtZW50fSA9IHRoaXM7XG4gICAgU2VydmljZXMudmlkZW9NYW5hZ2VyRm9yRG9jKGVsZW1lbnQpLnJlZ2lzdGVyKHRoaXMpO1xuICAgIGVsZW1lbnQuZGlzcGF0Y2hDdXN0b21FdmVudChWaWRlb0V2ZW50cy5MT0FEKTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgY3JlYXRlUGxhY2Vob2xkZXJDYWxsYmFjaygpIHtcbiAgICBjb25zdCB7ZWxlbWVudH0gPSB0aGlzO1xuICAgIGNvbnN0IHBvc3RlciA9XG4gICAgICAgIGh0bWxGb3IoZWxlbWVudClgPGFtcC1pbWcgbGF5b3V0PWZpbGwgcGxhY2Vob2xkZXI+PC9hbXAtaW1nPmA7XG5cbiAgICBwb3N0ZXIuc2V0QXR0cmlidXRlKCdzcmMnLFxuICAgICAgICB0aGlzLnVzZXIoKS5hc3NlcnRTdHJpbmcoZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3Bvc3RlcicpKSk7XG5cbiAgICByZXR1cm4gcG9zdGVyO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICB1bmxheW91dENhbGxiYWNrKCkge1xuICAgIHRoaXMuY2FuUGxheV8gPSBmYWxzZTtcbiAgICB0aGlzLnJlbW92ZUlmcmFtZV8oKTtcbiAgICByZXR1cm4gdHJ1ZTsgLy8gbGF5b3V0IGFnYWluLlxuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIHJlbW92ZUlmcmFtZV8oKSB7XG4gICAgdGhpcy5jYW5QbGF5XyA9IGZhbHNlO1xuXG4gICAgaWYgKHRoaXMuaWZyYW1lXykge1xuICAgICAgcmVtb3ZlRWxlbWVudCh0aGlzLmlmcmFtZV8pO1xuICAgICAgdGhpcy5pZnJhbWVfID0gbnVsbDtcbiAgICB9XG4gICAgaWYgKHRoaXMudW5saXN0ZW5GcmFtZV8pIHtcbiAgICAgIHRoaXMudW5saXN0ZW5GcmFtZV8oKTtcbiAgICAgIHRoaXMudW5saXN0ZW5GcmFtZV8gPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAcHJpdmF0ZSAqL1xuICBnZXRTcmNfKCkge1xuICAgIGNvbnN0IHtlbGVtZW50fSA9IHRoaXM7XG4gICAgY29uc3QgdXJsU2VydmljZSA9IFNlcnZpY2VzLnVybEZvckRvYyhlbGVtZW50KTtcbiAgICBjb25zdCBzcmMgPSB1cmxTZXJ2aWNlLmFzc2VydEh0dHBzVXJsKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdzcmMnKSwgZWxlbWVudCk7XG5cbiAgICBpZiAodXJsU2VydmljZS5nZXRTb3VyY2VPcmlnaW4oc3JjKSA9PT0gdXJsU2VydmljZS5nZXRXaW5PcmlnaW4odGhpcy53aW4pKSB7XG4gICAgICB0aGlzLnVzZXIoKS53YXJuKFRBRyxcbiAgICAgICAgICAnT3JpZ2lucyBvZiBkb2N1bWVudCBpbnNpZGUgYW1wLXZpZGVvLWlmcmFtZSBhbmQgdGhlIGhvc3QgYXJlIHRoZSAnICtcbiAgICAgICAgICAnc2FtZSwgd2hpY2ggYWxsb3dzIGZvciBzYW1lLW9yaWdpbiBiZWhhdmlvci4gSG93ZXZlciBpbiBBTVAgJyArXG4gICAgICAgICAgJ2NhY2hlLCBvcmlnaW5zIHdvblxcJ3QgbWF0Y2guIFBsZWFzZSBlbnN1cmUgeW91IGRvIG5vdCByZWx5IG9uIGFueSAnICtcbiAgICAgICAgICAnc2FtZS1vcmlnaW4gcHJpdmlsZWdlcy4nLFxuICAgICAgICAgIGVsZW1lbnQpO1xuICAgIH1cblxuICAgIHJldHVybiBzcmM7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBjcmVhdGVSZWFkeVByb21pc2VfKCkge1xuICAgIGNvbnN0IHtwcm9taXNlLCByZXNvbHZlLCByZWplY3R9ID0gbmV3IERlZmVycmVkKCk7XG4gICAgdGhpcy5yZWFkeVByb21pc2VfID0gcHJvbWlzZTtcbiAgICB0aGlzLnJlYWR5UmVzb2x2ZXJfID0gcmVzb2x2ZTtcbiAgICB0aGlzLnJlYWR5UmVqZWN0ZXJfID0gcmVqZWN0O1xuICAgIHJldHVybiBwcm9taXNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUV2ZW50fSBldmVudFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgb3JpZ2luTWF0Y2hlc18oZXZlbnQpIHtcbiAgICByZXR1cm4gb3JpZ2luTWF0Y2hlcyhldmVudCwgdGhpcy5pZnJhbWVfLCAvLiovKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFdmVudH0gZXZlbnRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIG9uTWVzc2FnZV8oZXZlbnQpIHtcbiAgICBpZiAoIXRoaXMuaWZyYW1lXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5vcmlnaW5NYXRjaGVzXyhldmVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBldmVudERhdGEgPSBnZXREYXRhKGV2ZW50KTtcbiAgICBpZiAoIWlzSnNvbk9yT2JqKGV2ZW50RGF0YSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gb2JqT3JQYXJzZUpzb24oZXZlbnREYXRhKTtcblxuICAgIGNvbnN0IG1lc3NhZ2VJZCA9IGRhdGFbJ2lkJ107XG4gICAgY29uc3QgbWV0aG9kUmVjZWl2ZWQgPSBkYXRhWydtZXRob2QnXTtcblxuICAgIGlmIChtZXRob2RSZWNlaXZlZCkge1xuICAgICAgaWYgKG1ldGhvZFJlY2VpdmVkID09ICdnZXRJbnRlcnNlY3Rpb24nKSB7XG4gICAgICAgIHRoaXMucG9zdEludGVyc2VjdGlvbl8obWVzc2FnZUlkKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZGV2KCkuYXNzZXJ0KGZhbHNlLCBgVW5rbm93biBtZXRob2QgJyR7bWV0aG9kUmVjZWl2ZWR9YCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgZXZlbnRSZWNlaXZlZCA9IGRhdGFbJ2V2ZW50J107XG4gICAgY29uc3QgaXNDYW5QbGF5RXZlbnQgPSBldmVudFJlY2VpdmVkID09ICdjYW5wbGF5JztcblxuICAgIHRoaXMuY2FuUGxheV8gPSB0aGlzLmNhblBsYXlfIHx8IGlzQ2FuUGxheUV2ZW50O1xuXG4gICAgaWYgKGlzQ2FuUGxheUV2ZW50KSB7XG4gICAgICBkZXYoKS5hc3NlcnQodGhpcy5yZWFkeVJlc29sdmVyXykuY2FsbCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChldmVudFJlY2VpdmVkID09ICdlcnJvcicgJiYgIXRoaXMuY2FuUGxheV8pIHtcbiAgICAgIGRldigpLmFzc2VydCh0aGlzLnJlYWR5UmVqZWN0ZXJfKS5jYWxsKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKEFMTE9XRURfRVZFTlRTLmluZGV4T2YoZXZlbnRSZWNlaXZlZCkgPiAtMSkge1xuICAgICAgdGhpcy5lbGVtZW50LmRpc3BhdGNoQ3VzdG9tRXZlbnQoZXZlbnRSZWNlaXZlZCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBtZXNzYWdlSWRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHBvc3RJbnRlcnNlY3Rpb25fKG1lc3NhZ2VJZCkge1xuICAgIGNvbnN0IHt0aW1lLCBpbnRlcnNlY3Rpb25SYXRpb30gPSB0aGlzLmVsZW1lbnQuZ2V0SW50ZXJzZWN0aW9uQ2hhbmdlRW50cnkoKTtcblxuICAgIC8vIE9ubHkgcG9zdCByYXRpbyA+IDAgd2hlbiBpbiBhdXRvcGxheSByYW5nZSB0byBwcmV2ZW50IGludGVybmFsIGF1dG9wbGF5XG4gICAgLy8gaW1wbGVtZW50YXRpb25zIHRoYXQgZGlmZmVyIGZyb20gb3Vycy5cbiAgICBjb25zdCBwb3N0ZWRSYXRpbyA9XG4gICAgICAgIGludGVyc2VjdGlvblJhdGlvIDwgTUlOX1ZJU0lCSUxJVFlfUkFUSU9fRk9SX0FVVE9QTEFZID9cbiAgICAgICAgICAwIDogaW50ZXJzZWN0aW9uUmF0aW87XG5cbiAgICB0aGlzLnBvc3RNZXNzYWdlXyhkaWN0KHtcbiAgICAgICdpZCc6IG1lc3NhZ2VJZCxcbiAgICAgICdhcmdzJzoge1xuICAgICAgICAnaW50ZXJzZWN0aW9uUmF0aW8nOiBwb3N0ZWRSYXRpbyxcbiAgICAgICAgJ3RpbWUnOiB0aW1lLFxuICAgICAgfSxcbiAgICB9KSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1ldGhvZFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgbWV0aG9kXyhtZXRob2QpIHtcbiAgICB0aGlzLnBvc3RNZXNzYWdlXyhkaWN0KHtcbiAgICAgICdldmVudCc6ICdtZXRob2QnLFxuICAgICAgJ21ldGhvZCc6IG1ldGhvZCxcbiAgICB9KSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshSnNvbk9iamVjdH0gbWVzc2FnZVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcG9zdE1lc3NhZ2VfKG1lc3NhZ2UpIHtcbiAgICBpZiAoIXRoaXMuaWZyYW1lXyB8fCAhdGhpcy5pZnJhbWVfLmNvbnRlbnRXaW5kb3cpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCF0aGlzLnJlYWR5UHJvbWlzZV8pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5yZWFkeVByb21pc2VfLnRoZW4oKCkgPT4ge1xuICAgICAgdGhpcy5pZnJhbWVfLmNvbnRlbnRXaW5kb3cuLypPSyovcG9zdE1lc3NhZ2UoXG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkobWVzc2FnZSksICcqJyk7XG4gICAgfSk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHBhdXNlQ2FsbGJhY2soKSB7XG4gICAgdGhpcy5wYXVzZSgpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBwYXVzZSgpIHtcbiAgICB0aGlzLm1ldGhvZF8oJ3BhdXNlJyk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHBsYXkoKSB7XG4gICAgdGhpcy5tZXRob2RfKCdwbGF5Jyk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIG11dGUoKSB7XG4gICAgdGhpcy5tZXRob2RfKCdtdXRlJyk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHVubXV0ZSgpIHtcbiAgICB0aGlzLm1ldGhvZF8oJ3VubXV0ZScpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBpc0ludGVyYWN0aXZlKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBzdXBwb3J0c1BsYXRmb3JtKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBwcmVpbXBsZW1lbnRzTWVkaWFTZXNzaW9uQVBJKCkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQuaGFzQXR0cmlidXRlKCdpbXBsZW1lbnRzLW1lZGlhLXNlc3Npb24nKTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgcHJlaW1wbGVtZW50c0F1dG9GdWxsc2NyZWVuKCkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQuaGFzQXR0cmlidXRlKCdpbXBsZW1lbnRzLXJvdGF0ZS10by1mdWxsc2NyZWVuJyk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGZ1bGxzY3JlZW5FbnRlcigpIHtcbiAgICB0aGlzLm1ldGhvZF8oJ2Z1bGxzY3JlZW5lbnRlcicpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBmdWxsc2NyZWVuRXhpdCgpIHtcbiAgICB0aGlzLm1ldGhvZF8oJ2Z1bGxzY3JlZW5leGl0Jyk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGlzRnVsbHNjcmVlbigpIHtcbiAgICAvLyBUT0RPKGFsYW5vcm96Y28pOiBNYWtlIHRoaXMgYWNjdXJhdGUgb24gaU9TIChpLmUuIGFzeW5jIEFQSSkuXG4gICAgaWYgKCF0aGlzLmlmcmFtZV8pIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIGlzRnVsbHNjcmVlbkVsZW1lbnQoZGV2KCkuYXNzZXJ0RWxlbWVudCh0aGlzLmlmcmFtZV8pKTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgc2hvd0NvbnRyb2xzKCkge1xuICAgIHRoaXMubWV0aG9kXygnc2hvd2NvbnRyb2xzJyk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGhpZGVDb250cm9scygpIHtcbiAgICB0aGlzLm1ldGhvZF8oJ2hpZGVjb250cm9scycpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBnZXRNZXRhZGF0YSgpIHtcbiAgICAvLyBUT0RPKGFsYW5vcm96Y28pXG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGdldER1cmF0aW9uKCkge1xuICAgIC8vIFRPRE8oYWxhbm9yb3pjbylcbiAgICByZXR1cm4gMDtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgZ2V0Q3VycmVudFRpbWUoKSB7XG4gICAgLy8gVE9ETyhhbGFub3JvemNvKVxuICAgIHJldHVybiAwO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBnZXRQbGF5ZWRSYW5nZXMoKSB7XG4gICAgLy8gVE9ETyhhbGFub3JvemNvKVxuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG5BTVAuZXh0ZW5zaW9uKFRBRywgJzAuMScsIEFNUCA9PiB7XG4gIEFNUC5yZWdpc3RlckVsZW1lbnQoVEFHLCBBbXBWaWRlb0lmcmFtZSk7XG59KTtcbiIsIi8qIVxuXG5Db3B5cmlnaHQgKEMpIDIwMTQtMjAxNiBieSBBbmRyZWEgR2lhbW1hcmNoaSAtIEBXZWJSZWZsZWN0aW9uXG5cblBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbm9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbmluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbnRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbmNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbmFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG5JTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbkZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbk9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cblRIRSBTT0ZUV0FSRS5cblxuKi9cbi8vIGdsb2JhbCB3aW5kb3cgT2JqZWN0XG4vLyBvcHRpb25hbCBwb2x5ZmlsbCBpbmZvXG4vLyAgICAnYXV0bycgdXNlZCBieSBkZWZhdWx0LCBldmVyeXRoaW5nIGlzIGZlYXR1cmUgZGV0ZWN0ZWRcbi8vICAgICdmb3JjZScgdXNlIHRoZSBwb2x5ZmlsbCBldmVuIGlmIG5vdCBmdWxseSBuZWVkZWRcbmZ1bmN0aW9uIGluc3RhbGxDdXN0b21FbGVtZW50cyh3aW5kb3csIHBvbHlmaWxsKSB7J3VzZSBzdHJpY3QnO1xuXG4gIC8vIERPIE5PVCBVU0UgVEhJUyBGSUxFIERJUkVDVExZLCBJVCBXT04nVCBXT1JLXG4gIC8vIFRISVMgSVMgQSBQUk9KRUNUIEJBU0VEIE9OIEEgQlVJTEQgU1lTVEVNXG4gIC8vIFRISVMgRklMRSBJUyBKVVNUIFdSQVBQRUQgVVAgUkVTVUxUSU5HIElOXG4gIC8vIGJ1aWxkL2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQubm9kZS5qc1xuXG4gIHZhclxuICAgIGRvY3VtZW50ID0gd2luZG93LmRvY3VtZW50LFxuICAgIE9iamVjdCA9IHdpbmRvdy5PYmplY3RcbiAgO1xuXG4gIHZhciBodG1sQ2xhc3MgPSAoZnVuY3Rpb24gKGluZm8pIHtcbiAgICAvLyAoQykgQW5kcmVhIEdpYW1tYXJjaGkgLSBAV2ViUmVmbGVjdGlvbiAtIE1JVCBTdHlsZVxuICAgIHZhclxuICAgICAgY2F0Y2hDbGFzcyA9IC9eW0EtWl0rW2Etel0vLFxuICAgICAgZmlsdGVyQnkgPSBmdW5jdGlvbiAocmUpIHtcbiAgICAgICAgdmFyIGFyciA9IFtdLCB0YWc7XG4gICAgICAgIGZvciAodGFnIGluIHJlZ2lzdGVyKSB7XG4gICAgICAgICAgaWYgKHJlLnRlc3QodGFnKSkgYXJyLnB1c2godGFnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyO1xuICAgICAgfSxcbiAgICAgIGFkZCA9IGZ1bmN0aW9uIChDbGFzcywgdGFnKSB7XG4gICAgICAgIHRhZyA9IHRhZy50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAoISh0YWcgaW4gcmVnaXN0ZXIpKSB7XG4gICAgICAgICAgcmVnaXN0ZXJbQ2xhc3NdID0gKHJlZ2lzdGVyW0NsYXNzXSB8fCBbXSkuY29uY2F0KHRhZyk7XG4gICAgICAgICAgcmVnaXN0ZXJbdGFnXSA9IChyZWdpc3Rlclt0YWcudG9VcHBlckNhc2UoKV0gPSBDbGFzcyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICByZWdpc3RlciA9IChPYmplY3QuY3JlYXRlIHx8IE9iamVjdCkobnVsbCksXG4gICAgICBodG1sQ2xhc3MgPSB7fSxcbiAgICAgIGksIHNlY3Rpb24sIHRhZ3MsIENsYXNzXG4gICAgO1xuICAgIGZvciAoc2VjdGlvbiBpbiBpbmZvKSB7XG4gICAgICBmb3IgKENsYXNzIGluIGluZm9bc2VjdGlvbl0pIHtcbiAgICAgICAgdGFncyA9IGluZm9bc2VjdGlvbl1bQ2xhc3NdO1xuICAgICAgICByZWdpc3RlcltDbGFzc10gPSB0YWdzO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGFncy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHJlZ2lzdGVyW3RhZ3NbaV0udG9Mb3dlckNhc2UoKV0gPVxuICAgICAgICAgIHJlZ2lzdGVyW3RhZ3NbaV0udG9VcHBlckNhc2UoKV0gPSBDbGFzcztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBodG1sQ2xhc3MuZ2V0ID0gZnVuY3Rpb24gZ2V0KHRhZ09yQ2xhc3MpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdGFnT3JDbGFzcyA9PT0gJ3N0cmluZycgP1xuICAgICAgICAocmVnaXN0ZXJbdGFnT3JDbGFzc10gfHwgKGNhdGNoQ2xhc3MudGVzdCh0YWdPckNsYXNzKSA/IFtdIDogJycpKSA6XG4gICAgICAgIGZpbHRlckJ5KHRhZ09yQ2xhc3MpO1xuICAgIH07XG4gICAgaHRtbENsYXNzLnNldCA9IGZ1bmN0aW9uIHNldCh0YWcsIENsYXNzKSB7XG4gICAgICByZXR1cm4gKGNhdGNoQ2xhc3MudGVzdCh0YWcpID9cbiAgICAgICAgYWRkKHRhZywgQ2xhc3MpIDpcbiAgICAgICAgYWRkKENsYXNzLCB0YWcpXG4gICAgICApLCBodG1sQ2xhc3M7XG4gICAgfTtcbiAgICByZXR1cm4gaHRtbENsYXNzO1xuICB9KHtcbiAgICBcImNvbGxlY3Rpb25zXCI6IHtcbiAgICAgIFwiSFRNTEFsbENvbGxlY3Rpb25cIjogW1xuICAgICAgICBcImFsbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQ29sbGVjdGlvblwiOiBbXG4gICAgICAgIFwiZm9ybXNcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEZvcm1Db250cm9sc0NvbGxlY3Rpb25cIjogW1xuICAgICAgICBcImVsZW1lbnRzXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxPcHRpb25zQ29sbGVjdGlvblwiOiBbXG4gICAgICAgIFwib3B0aW9uc1wiXG4gICAgICBdXG4gICAgfSxcbiAgICBcImVsZW1lbnRzXCI6IHtcbiAgICAgIFwiRWxlbWVudFwiOiBbXG4gICAgICAgIFwiZWxlbWVudFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQW5jaG9yRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQXBwbGV0RWxlbWVudFwiOiBbXG4gICAgICAgIFwiYXBwbGV0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxBcmVhRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYXJlYVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQXR0YWNobWVudEVsZW1lbnRcIjogW1xuICAgICAgICBcImF0dGFjaG1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEF1ZGlvRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYXVkaW9cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEJSRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYnJcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEJhc2VFbGVtZW50XCI6IFtcbiAgICAgICAgXCJiYXNlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxCb2R5RWxlbWVudFwiOiBbXG4gICAgICAgIFwiYm9keVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQnV0dG9uRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYnV0dG9uXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxDYW52YXNFbGVtZW50XCI6IFtcbiAgICAgICAgXCJjYW52YXNcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTENvbnRlbnRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJjb250ZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxETGlzdEVsZW1lbnRcIjogW1xuICAgICAgICBcImRsXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxEYXRhRWxlbWVudFwiOiBbXG4gICAgICAgIFwiZGF0YVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGF0YUxpc3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkYXRhbGlzdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGV0YWlsc0VsZW1lbnRcIjogW1xuICAgICAgICBcImRldGFpbHNcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERpYWxvZ0VsZW1lbnRcIjogW1xuICAgICAgICBcImRpYWxvZ1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGlyZWN0b3J5RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZGlyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxEaXZFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkaXZcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERvY3VtZW50XCI6IFtcbiAgICAgICAgXCJkb2N1bWVudFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRWxlbWVudFwiOiBbXG4gICAgICAgIFwiZWxlbWVudFwiLFxuICAgICAgICBcImFiYnJcIixcbiAgICAgICAgXCJhZGRyZXNzXCIsXG4gICAgICAgIFwiYXJ0aWNsZVwiLFxuICAgICAgICBcImFzaWRlXCIsXG4gICAgICAgIFwiYlwiLFxuICAgICAgICBcImJkaVwiLFxuICAgICAgICBcImJkb1wiLFxuICAgICAgICBcImNpdGVcIixcbiAgICAgICAgXCJjb2RlXCIsXG4gICAgICAgIFwiY29tbWFuZFwiLFxuICAgICAgICBcImRkXCIsXG4gICAgICAgIFwiZGZuXCIsXG4gICAgICAgIFwiZHRcIixcbiAgICAgICAgXCJlbVwiLFxuICAgICAgICBcImZpZ2NhcHRpb25cIixcbiAgICAgICAgXCJmaWd1cmVcIixcbiAgICAgICAgXCJmb290ZXJcIixcbiAgICAgICAgXCJoZWFkZXJcIixcbiAgICAgICAgXCJpXCIsXG4gICAgICAgIFwia2JkXCIsXG4gICAgICAgIFwibWFya1wiLFxuICAgICAgICBcIm5hdlwiLFxuICAgICAgICBcIm5vc2NyaXB0XCIsXG4gICAgICAgIFwicnBcIixcbiAgICAgICAgXCJydFwiLFxuICAgICAgICBcInJ1YnlcIixcbiAgICAgICAgXCJzXCIsXG4gICAgICAgIFwic2FtcFwiLFxuICAgICAgICBcInNlY3Rpb25cIixcbiAgICAgICAgXCJzbWFsbFwiLFxuICAgICAgICBcInN0cm9uZ1wiLFxuICAgICAgICBcInN1YlwiLFxuICAgICAgICBcInN1bW1hcnlcIixcbiAgICAgICAgXCJzdXBcIixcbiAgICAgICAgXCJ1XCIsXG4gICAgICAgIFwidmFyXCIsXG4gICAgICAgIFwid2JyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxFbWJlZEVsZW1lbnRcIjogW1xuICAgICAgICBcImVtYmVkXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGaWVsZFNldEVsZW1lbnRcIjogW1xuICAgICAgICBcImZpZWxkc2V0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGb250RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZm9udFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRm9ybUVsZW1lbnRcIjogW1xuICAgICAgICBcImZvcm1cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEZyYW1lRWxlbWVudFwiOiBbXG4gICAgICAgIFwiZnJhbWVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEZyYW1lU2V0RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZnJhbWVzZXRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEhSRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaHJcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEhlYWRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJoZWFkXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxIZWFkaW5nRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaDFcIixcbiAgICAgICAgXCJoMlwiLFxuICAgICAgICBcImgzXCIsXG4gICAgICAgIFwiaDRcIixcbiAgICAgICAgXCJoNVwiLFxuICAgICAgICBcImg2XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxIdG1sRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaHRtbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSUZyYW1lRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaWZyYW1lXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxJbWFnZUVsZW1lbnRcIjogW1xuICAgICAgICBcImltZ1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSW5wdXRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJpbnB1dFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MS2V5Z2VuRWxlbWVudFwiOiBbXG4gICAgICAgIFwia2V5Z2VuXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxMSUVsZW1lbnRcIjogW1xuICAgICAgICBcImxpXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxMYWJlbEVsZW1lbnRcIjogW1xuICAgICAgICBcImxhYmVsXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxMZWdlbmRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJsZWdlbmRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTExpbmtFbGVtZW50XCI6IFtcbiAgICAgICAgXCJsaW5rXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNYXBFbGVtZW50XCI6IFtcbiAgICAgICAgXCJtYXBcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1hcnF1ZWVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJtYXJxdWVlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNZWRpYUVsZW1lbnRcIjogW1xuICAgICAgICBcIm1lZGlhXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNZW51RWxlbWVudFwiOiBbXG4gICAgICAgIFwibWVudVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWVudUl0ZW1FbGVtZW50XCI6IFtcbiAgICAgICAgXCJtZW51aXRlbVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWV0YUVsZW1lbnRcIjogW1xuICAgICAgICBcIm1ldGFcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1ldGVyRWxlbWVudFwiOiBbXG4gICAgICAgIFwibWV0ZXJcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1vZEVsZW1lbnRcIjogW1xuICAgICAgICBcImRlbFwiLFxuICAgICAgICBcImluc1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT0xpc3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJvbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT2JqZWN0RWxlbWVudFwiOiBbXG4gICAgICAgIFwib2JqZWN0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxPcHRHcm91cEVsZW1lbnRcIjogW1xuICAgICAgICBcIm9wdGdyb3VwXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxPcHRpb25FbGVtZW50XCI6IFtcbiAgICAgICAgXCJvcHRpb25cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE91dHB1dEVsZW1lbnRcIjogW1xuICAgICAgICBcIm91dHB1dFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUGFyYWdyYXBoRWxlbWVudFwiOiBbXG4gICAgICAgIFwicFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUGFyYW1FbGVtZW50XCI6IFtcbiAgICAgICAgXCJwYXJhbVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUGljdHVyZUVsZW1lbnRcIjogW1xuICAgICAgICBcInBpY3R1cmVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFByZUVsZW1lbnRcIjogW1xuICAgICAgICBcInByZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUHJvZ3Jlc3NFbGVtZW50XCI6IFtcbiAgICAgICAgXCJwcm9ncmVzc1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUXVvdGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJibG9ja3F1b3RlXCIsXG4gICAgICAgIFwicVwiLFxuICAgICAgICBcInF1b3RlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxTY3JpcHRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJzY3JpcHRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFNlbGVjdEVsZW1lbnRcIjogW1xuICAgICAgICBcInNlbGVjdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU2hhZG93RWxlbWVudFwiOiBbXG4gICAgICAgIFwic2hhZG93XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxTbG90RWxlbWVudFwiOiBbXG4gICAgICAgIFwic2xvdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU291cmNlRWxlbWVudFwiOiBbXG4gICAgICAgIFwic291cmNlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxTcGFuRWxlbWVudFwiOiBbXG4gICAgICAgIFwic3BhblwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU3R5bGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJzdHlsZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVDYXB0aW9uRWxlbWVudFwiOiBbXG4gICAgICAgIFwiY2FwdGlvblwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVDZWxsRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGRcIixcbiAgICAgICAgXCJ0aFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVDb2xFbGVtZW50XCI6IFtcbiAgICAgICAgXCJjb2xcIixcbiAgICAgICAgXCJjb2xncm91cFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0YWJsZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVSb3dFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0clwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVTZWN0aW9uRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGhlYWRcIixcbiAgICAgICAgXCJ0Ym9keVwiLFxuICAgICAgICBcInRmb290XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxUZW1wbGF0ZUVsZW1lbnRcIjogW1xuICAgICAgICBcInRlbXBsYXRlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxUZXh0QXJlYUVsZW1lbnRcIjogW1xuICAgICAgICBcInRleHRhcmVhXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxUaW1lRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGltZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGl0bGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0aXRsZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVHJhY2tFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0cmFja1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVUxpc3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ1bFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVW5rbm93bkVsZW1lbnRcIjogW1xuICAgICAgICBcInVua25vd25cIixcbiAgICAgICAgXCJ2aGdyb3VwdlwiLFxuICAgICAgICBcInZrZXlnZW5cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFZpZGVvRWxlbWVudFwiOiBbXG4gICAgICAgIFwidmlkZW9cIlxuICAgICAgXVxuICAgIH0sXG4gICAgXCJub2Rlc1wiOiB7XG4gICAgICBcIkF0dHJcIjogW1xuICAgICAgICBcIm5vZGVcIlxuICAgICAgXSxcbiAgICAgIFwiQXVkaW9cIjogW1xuICAgICAgICBcImF1ZGlvXCJcbiAgICAgIF0sXG4gICAgICBcIkNEQVRBU2VjdGlvblwiOiBbXG4gICAgICAgIFwibm9kZVwiXG4gICAgICBdLFxuICAgICAgXCJDaGFyYWN0ZXJEYXRhXCI6IFtcbiAgICAgICAgXCJub2RlXCJcbiAgICAgIF0sXG4gICAgICBcIkNvbW1lbnRcIjogW1xuICAgICAgICBcIiNjb21tZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkRvY3VtZW50XCI6IFtcbiAgICAgICAgXCIjZG9jdW1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiRG9jdW1lbnRGcmFnbWVudFwiOiBbXG4gICAgICAgIFwiI2RvY3VtZW50LWZyYWdtZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkRvY3VtZW50VHlwZVwiOiBbXG4gICAgICAgIFwibm9kZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRG9jdW1lbnRcIjogW1xuICAgICAgICBcIiNkb2N1bWVudFwiXG4gICAgICBdLFxuICAgICAgXCJJbWFnZVwiOiBbXG4gICAgICAgIFwiaW1nXCJcbiAgICAgIF0sXG4gICAgICBcIk9wdGlvblwiOiBbXG4gICAgICAgIFwib3B0aW9uXCJcbiAgICAgIF0sXG4gICAgICBcIlByb2Nlc3NpbmdJbnN0cnVjdGlvblwiOiBbXG4gICAgICAgIFwibm9kZVwiXG4gICAgICBdLFxuICAgICAgXCJTaGFkb3dSb290XCI6IFtcbiAgICAgICAgXCIjc2hhZG93LXJvb3RcIlxuICAgICAgXSxcbiAgICAgIFwiVGV4dFwiOiBbXG4gICAgICAgIFwiI3RleHRcIlxuICAgICAgXSxcbiAgICAgIFwiWE1MRG9jdW1lbnRcIjogW1xuICAgICAgICBcInhtbFwiXG4gICAgICBdXG4gICAgfVxuICB9KSk7XG4gIFxuICBcbiAgICBcbiAgLy8gcGFzc2VkIGF0IHJ1bnRpbWUsIGNvbmZpZ3VyYWJsZVxuICAvLyB2aWEgbm9kZWpzIG1vZHVsZVxuICBpZiAoIXBvbHlmaWxsKSBwb2x5ZmlsbCA9ICdhdXRvJztcbiAgXG4gIHZhclxuICAgIC8vIFYwIHBvbHlmaWxsIGVudHJ5XG4gICAgUkVHSVNURVJfRUxFTUVOVCA9ICdyZWdpc3RlckVsZW1lbnQnLFxuICBcbiAgICAvLyBJRSA8IDExIG9ubHkgKyBvbGQgV2ViS2l0IGZvciBhdHRyaWJ1dGVzICsgZmVhdHVyZSBkZXRlY3Rpb25cbiAgICBFWFBBTkRPX1VJRCA9ICdfXycgKyBSRUdJU1RFUl9FTEVNRU5UICsgKHdpbmRvdy5NYXRoLnJhbmRvbSgpICogMTBlNCA+PiAwKSxcbiAgXG4gICAgLy8gc2hvcnRjdXRzIGFuZCBjb3N0YW50c1xuICAgIEFERF9FVkVOVF9MSVNURU5FUiA9ICdhZGRFdmVudExpc3RlbmVyJyxcbiAgICBBVFRBQ0hFRCA9ICdhdHRhY2hlZCcsXG4gICAgQ0FMTEJBQ0sgPSAnQ2FsbGJhY2snLFxuICAgIERFVEFDSEVEID0gJ2RldGFjaGVkJyxcbiAgICBFWFRFTkRTID0gJ2V4dGVuZHMnLFxuICBcbiAgICBBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDSyA9ICdhdHRyaWJ1dGVDaGFuZ2VkJyArIENBTExCQUNLLFxuICAgIEFUVEFDSEVEX0NBTExCQUNLID0gQVRUQUNIRUQgKyBDQUxMQkFDSyxcbiAgICBDT05ORUNURURfQ0FMTEJBQ0sgPSAnY29ubmVjdGVkJyArIENBTExCQUNLLFxuICAgIERJU0NPTk5FQ1RFRF9DQUxMQkFDSyA9ICdkaXNjb25uZWN0ZWQnICsgQ0FMTEJBQ0ssXG4gICAgQ1JFQVRFRF9DQUxMQkFDSyA9ICdjcmVhdGVkJyArIENBTExCQUNLLFxuICAgIERFVEFDSEVEX0NBTExCQUNLID0gREVUQUNIRUQgKyBDQUxMQkFDSyxcbiAgXG4gICAgQURESVRJT04gPSAnQURESVRJT04nLFxuICAgIE1PRElGSUNBVElPTiA9ICdNT0RJRklDQVRJT04nLFxuICAgIFJFTU9WQUwgPSAnUkVNT1ZBTCcsXG4gIFxuICAgIERPTV9BVFRSX01PRElGSUVEID0gJ0RPTUF0dHJNb2RpZmllZCcsXG4gICAgRE9NX0NPTlRFTlRfTE9BREVEID0gJ0RPTUNvbnRlbnRMb2FkZWQnLFxuICAgIERPTV9TVUJUUkVFX01PRElGSUVEID0gJ0RPTVN1YnRyZWVNb2RpZmllZCcsXG4gIFxuICAgIFBSRUZJWF9UQUcgPSAnPCcsXG4gICAgUFJFRklYX0lTID0gJz0nLFxuICBcbiAgICAvLyB2YWxpZCBhbmQgaW52YWxpZCBub2RlIG5hbWVzXG4gICAgdmFsaWROYW1lID0gL15bQS1aXVtBLVowLTldKig/Oi1bQS1aMC05XSspKyQvLFxuICAgIGludmFsaWROYW1lcyA9IFtcbiAgICAgICdBTk5PVEFUSU9OLVhNTCcsXG4gICAgICAnQ09MT1ItUFJPRklMRScsXG4gICAgICAnRk9OVC1GQUNFJyxcbiAgICAgICdGT05ULUZBQ0UtU1JDJyxcbiAgICAgICdGT05ULUZBQ0UtVVJJJyxcbiAgICAgICdGT05ULUZBQ0UtRk9STUFUJyxcbiAgICAgICdGT05ULUZBQ0UtTkFNRScsXG4gICAgICAnTUlTU0lORy1HTFlQSCdcbiAgICBdLFxuICBcbiAgICAvLyByZWdpc3RlcmVkIHR5cGVzIGFuZCB0aGVpciBwcm90b3R5cGVzXG4gICAgdHlwZXMgPSBbXSxcbiAgICBwcm90b3MgPSBbXSxcbiAgXG4gICAgLy8gdG8gcXVlcnkgc3Vibm9kZXNcbiAgICBxdWVyeSA9ICcnLFxuICBcbiAgICAvLyBodG1sIHNob3J0Y3V0IHVzZWQgdG8gZmVhdHVyZSBkZXRlY3RcbiAgICBkb2N1bWVudEVsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsXG4gIFxuICAgIC8vIEVTNSBpbmxpbmUgaGVscGVycyB8fCBiYXNpYyBwYXRjaGVzXG4gICAgaW5kZXhPZiA9IHR5cGVzLmluZGV4T2YgfHwgZnVuY3Rpb24gKHYpIHtcbiAgICAgIGZvcih2YXIgaSA9IHRoaXMubGVuZ3RoOyBpLS0gJiYgdGhpc1tpXSAhPT0gdjspe31cbiAgICAgIHJldHVybiBpO1xuICAgIH0sXG4gIFxuICAgIC8vIG90aGVyIGhlbHBlcnMgLyBzaG9ydGN1dHNcbiAgICBPUCA9IE9iamVjdC5wcm90b3R5cGUsXG4gICAgaE9QID0gT1AuaGFzT3duUHJvcGVydHksXG4gICAgaVBPID0gT1AuaXNQcm90b3R5cGVPZixcbiAgXG4gICAgZGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHksXG4gICAgZW1wdHkgPSBbXSxcbiAgICBnT1BEID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcixcbiAgICBnT1BOID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMsXG4gICAgZ1BPID0gT2JqZWN0LmdldFByb3RvdHlwZU9mLFxuICAgIHNQTyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZixcbiAgXG4gICAgLy8ganNoaW50IHByb3RvOiB0cnVlXG4gICAgaGFzUHJvdG8gPSAhIU9iamVjdC5fX3Byb3RvX18sXG4gIFxuICAgIC8vIFYxIGhlbHBlcnNcbiAgICBmaXhHZXRDbGFzcyA9IGZhbHNlLFxuICAgIERSRUNFVjEgPSAnX19kcmVDRXYxJyxcbiAgICBjdXN0b21FbGVtZW50cyA9IHdpbmRvdy5jdXN0b21FbGVtZW50cyxcbiAgICB1c2FibGVDdXN0b21FbGVtZW50cyA9IHBvbHlmaWxsICE9PSAnZm9yY2UnICYmICEhKFxuICAgICAgY3VzdG9tRWxlbWVudHMgJiZcbiAgICAgIGN1c3RvbUVsZW1lbnRzLmRlZmluZSAmJlxuICAgICAgY3VzdG9tRWxlbWVudHMuZ2V0ICYmXG4gICAgICBjdXN0b21FbGVtZW50cy53aGVuRGVmaW5lZFxuICAgICksXG4gICAgRGljdCA9IE9iamVjdC5jcmVhdGUgfHwgT2JqZWN0LFxuICAgIE1hcCA9IHdpbmRvdy5NYXAgfHwgZnVuY3Rpb24gTWFwKCkge1xuICAgICAgdmFyIEsgPSBbXSwgViA9IFtdLCBpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoaykge1xuICAgICAgICAgIHJldHVybiBWW2luZGV4T2YuY2FsbChLLCBrKV07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGssIHYpIHtcbiAgICAgICAgICBpID0gaW5kZXhPZi5jYWxsKEssIGspO1xuICAgICAgICAgIGlmIChpIDwgMCkgVltLLnB1c2goaykgLSAxXSA9IHY7XG4gICAgICAgICAgZWxzZSBWW2ldID0gdjtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9LFxuICAgIFByb21pc2UgPSB3aW5kb3cuUHJvbWlzZSB8fCBmdW5jdGlvbiAoZm4pIHtcbiAgICAgIHZhclxuICAgICAgICBub3RpZnkgPSBbXSxcbiAgICAgICAgZG9uZSA9IGZhbHNlLFxuICAgICAgICBwID0ge1xuICAgICAgICAgICdjYXRjaCc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBwO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ3RoZW4nOiBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgICAgIG5vdGlmeS5wdXNoKGNiKTtcbiAgICAgICAgICAgIGlmIChkb25lKSBzZXRUaW1lb3V0KHJlc29sdmUsIDEpO1xuICAgICAgICAgICAgcmV0dXJuIHA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICA7XG4gICAgICBmdW5jdGlvbiByZXNvbHZlKHZhbHVlKSB7XG4gICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICB3aGlsZSAobm90aWZ5Lmxlbmd0aCkgbm90aWZ5LnNoaWZ0KCkodmFsdWUpO1xuICAgICAgfVxuICAgICAgZm4ocmVzb2x2ZSk7XG4gICAgICByZXR1cm4gcDtcbiAgICB9LFxuICAgIGp1c3RDcmVhdGVkID0gZmFsc2UsXG4gICAgY29uc3RydWN0b3JzID0gRGljdChudWxsKSxcbiAgICB3YWl0aW5nTGlzdCA9IERpY3QobnVsbCksXG4gICAgbm9kZU5hbWVzID0gbmV3IE1hcCgpLFxuICAgIHNlY29uZEFyZ3VtZW50ID0gZnVuY3Rpb24gKGlzKSB7XG4gICAgICByZXR1cm4gaXMudG9Mb3dlckNhc2UoKTtcbiAgICB9LFxuICBcbiAgICAvLyB1c2VkIHRvIGNyZWF0ZSB1bmlxdWUgaW5zdGFuY2VzXG4gICAgY3JlYXRlID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiBCcmlkZ2UocHJvdG8pIHtcbiAgICAgIC8vIHNpbGx5IGJyb2tlbiBwb2x5ZmlsbCBwcm9iYWJseSBldmVyIHVzZWQgYnV0IHNob3J0IGVub3VnaCB0byB3b3JrXG4gICAgICByZXR1cm4gcHJvdG8gPyAoKEJyaWRnZS5wcm90b3R5cGUgPSBwcm90byksIG5ldyBCcmlkZ2UoKSkgOiB0aGlzO1xuICAgIH0sXG4gIFxuICAgIC8vIHdpbGwgc2V0IHRoZSBwcm90b3R5cGUgaWYgcG9zc2libGVcbiAgICAvLyBvciBjb3B5IG92ZXIgYWxsIHByb3BlcnRpZXNcbiAgICBzZXRQcm90b3R5cGUgPSBzUE8gfHwgKFxuICAgICAgaGFzUHJvdG8gP1xuICAgICAgICBmdW5jdGlvbiAobywgcCkge1xuICAgICAgICAgIG8uX19wcm90b19fID0gcDtcbiAgICAgICAgICByZXR1cm4gbztcbiAgICAgICAgfSA6IChcbiAgICAgIChnT1BOICYmIGdPUEQpID9cbiAgICAgICAgKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgZnVuY3Rpb24gc2V0UHJvcGVydGllcyhvLCBwKSB7XG4gICAgICAgICAgICBmb3IgKHZhclxuICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgIG5hbWVzID0gZ09QTihwKSxcbiAgICAgICAgICAgICAgaSA9IDAsIGxlbmd0aCA9IG5hbWVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgaSA8IGxlbmd0aDsgaSsrXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAga2V5ID0gbmFtZXNbaV07XG4gICAgICAgICAgICAgIGlmICghaE9QLmNhbGwobywga2V5KSkge1xuICAgICAgICAgICAgICAgIGRlZmluZVByb3BlcnR5KG8sIGtleSwgZ09QRChwLCBrZXkpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG8sIHApIHtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgc2V0UHJvcGVydGllcyhvLCBwKTtcbiAgICAgICAgICAgIH0gd2hpbGUgKChwID0gZ1BPKHApKSAmJiAhaVBPLmNhbGwocCwgbykpO1xuICAgICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgICAgfTtcbiAgICAgICAgfSgpKSA6XG4gICAgICAgIGZ1bmN0aW9uIChvLCBwKSB7XG4gICAgICAgICAgZm9yICh2YXIga2V5IGluIHApIHtcbiAgICAgICAgICAgIG9ba2V5XSA9IHBba2V5XTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgIH1cbiAgICApKSxcbiAgXG4gICAgLy8gRE9NIHNob3J0Y3V0cyBhbmQgaGVscGVycywgaWYgYW55XG4gIFxuICAgIE11dGF0aW9uT2JzZXJ2ZXIgPSB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fFxuICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlcixcbiAgXG4gICAgSFRNTEVsZW1lbnRQcm90b3R5cGUgPSAoXG4gICAgICB3aW5kb3cuSFRNTEVsZW1lbnQgfHxcbiAgICAgIHdpbmRvdy5FbGVtZW50IHx8XG4gICAgICB3aW5kb3cuTm9kZVxuICAgICkucHJvdG90eXBlLFxuICBcbiAgICBJRTggPSAhaVBPLmNhbGwoSFRNTEVsZW1lbnRQcm90b3R5cGUsIGRvY3VtZW50RWxlbWVudCksXG4gIFxuICAgIHNhZmVQcm9wZXJ0eSA9IElFOCA/IGZ1bmN0aW9uIChvLCBrLCBkKSB7XG4gICAgICBvW2tdID0gZC52YWx1ZTtcbiAgICAgIHJldHVybiBvO1xuICAgIH0gOiBkZWZpbmVQcm9wZXJ0eSxcbiAgXG4gICAgaXNWYWxpZE5vZGUgPSBJRTggP1xuICAgICAgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IDE7XG4gICAgICB9IDpcbiAgICAgIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHJldHVybiBpUE8uY2FsbChIVE1MRWxlbWVudFByb3RvdHlwZSwgbm9kZSk7XG4gICAgICB9LFxuICBcbiAgICB0YXJnZXRzID0gSUU4ICYmIFtdLFxuICBcbiAgICBhdHRhY2hTaGFkb3cgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5hdHRhY2hTaGFkb3csXG4gICAgY2xvbmVOb2RlID0gSFRNTEVsZW1lbnRQcm90b3R5cGUuY2xvbmVOb2RlLFxuICAgIGRpc3BhdGNoRXZlbnQgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5kaXNwYXRjaEV2ZW50LFxuICAgIGdldEF0dHJpYnV0ZSA9IEhUTUxFbGVtZW50UHJvdG90eXBlLmdldEF0dHJpYnV0ZSxcbiAgICBoYXNBdHRyaWJ1dGUgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5oYXNBdHRyaWJ1dGUsXG4gICAgcmVtb3ZlQXR0cmlidXRlID0gSFRNTEVsZW1lbnRQcm90b3R5cGUucmVtb3ZlQXR0cmlidXRlLFxuICAgIHNldEF0dHJpYnV0ZSA9IEhUTUxFbGVtZW50UHJvdG90eXBlLnNldEF0dHJpYnV0ZSxcbiAgXG4gICAgLy8gcmVwbGFjZWQgbGF0ZXIgb25cbiAgICBjcmVhdGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCxcbiAgICBwYXRjaGVkQ3JlYXRlRWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQsXG4gIFxuICAgIC8vIHNoYXJlZCBvYnNlcnZlciBmb3IgYWxsIGF0dHJpYnV0ZXNcbiAgICBhdHRyaWJ1dGVzT2JzZXJ2ZXIgPSBNdXRhdGlvbk9ic2VydmVyICYmIHtcbiAgICAgIGF0dHJpYnV0ZXM6IHRydWUsXG4gICAgICBjaGFyYWN0ZXJEYXRhOiB0cnVlLFxuICAgICAgYXR0cmlidXRlT2xkVmFsdWU6IHRydWVcbiAgICB9LFxuICBcbiAgICAvLyB1c2VmdWwgdG8gZGV0ZWN0IG9ubHkgaWYgdGhlcmUncyBubyBNdXRhdGlvbk9ic2VydmVyXG4gICAgRE9NQXR0ck1vZGlmaWVkID0gTXV0YXRpb25PYnNlcnZlciB8fCBmdW5jdGlvbihlKSB7XG4gICAgICBkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCA9IGZhbHNlO1xuICAgICAgZG9jdW1lbnRFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgIERPTV9BVFRSX01PRElGSUVELFxuICAgICAgICBET01BdHRyTW9kaWZpZWRcbiAgICAgICk7XG4gICAgfSxcbiAgXG4gICAgLy8gd2lsbCBib3RoIGJlIHVzZWQgdG8gbWFrZSBET01Ob2RlSW5zZXJ0ZWQgYXN5bmNocm9ub3VzXG4gICAgYXNhcFF1ZXVlLFxuICAgIGFzYXBUaW1lciA9IDAsXG4gIFxuICAgIC8vIGludGVybmFsIGZsYWdzXG4gICAgVjAgPSBSRUdJU1RFUl9FTEVNRU5UIGluIGRvY3VtZW50LFxuICAgIHNldExpc3RlbmVyID0gdHJ1ZSxcbiAgICBqdXN0U2V0dXAgPSBmYWxzZSxcbiAgICBkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCA9IHRydWUsXG4gICAgZHJvcERvbUNvbnRlbnRMb2FkZWQgPSB0cnVlLFxuICBcbiAgICAvLyBuZWVkZWQgZm9yIHRoZSBpbm5lckhUTUwgaGVscGVyXG4gICAgbm90RnJvbUlubmVySFRNTEhlbHBlciA9IHRydWUsXG4gIFxuICAgIC8vIG9wdGlvbmFsbHkgZGVmaW5lZCBsYXRlciBvblxuICAgIG9uU3VidHJlZU1vZGlmaWVkLFxuICAgIGNhbGxET01BdHRyTW9kaWZpZWQsXG4gICAgZ2V0QXR0cmlidXRlc01pcnJvcixcbiAgICBvYnNlcnZlcixcbiAgICBvYnNlcnZlLFxuICBcbiAgICAvLyBiYXNlZCBvbiBzZXR0aW5nIHByb3RvdHlwZSBjYXBhYmlsaXR5XG4gICAgLy8gd2lsbCBjaGVjayBwcm90byBvciB0aGUgZXhwYW5kbyBhdHRyaWJ1dGVcbiAgICAvLyBpbiBvcmRlciB0byBzZXR1cCB0aGUgbm9kZSBvbmNlXG4gICAgcGF0Y2hJZk5vdEFscmVhZHksXG4gICAgcGF0Y2hcbiAgO1xuICBcbiAgLy8gb25seSBpZiBuZWVkZWRcbiAgaWYgKCFWMCkge1xuICBcbiAgICBpZiAoc1BPIHx8IGhhc1Byb3RvKSB7XG4gICAgICAgIHBhdGNoSWZOb3RBbHJlYWR5ID0gZnVuY3Rpb24gKG5vZGUsIHByb3RvKSB7XG4gICAgICAgICAgaWYgKCFpUE8uY2FsbChwcm90bywgbm9kZSkpIHtcbiAgICAgICAgICAgIHNldHVwTm9kZShub2RlLCBwcm90byk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBwYXRjaCA9IHNldHVwTm9kZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBwYXRjaElmTm90QWxyZWFkeSA9IGZ1bmN0aW9uIChub2RlLCBwcm90bykge1xuICAgICAgICAgIGlmICghbm9kZVtFWFBBTkRPX1VJRF0pIHtcbiAgICAgICAgICAgIG5vZGVbRVhQQU5ET19VSURdID0gT2JqZWN0KHRydWUpO1xuICAgICAgICAgICAgc2V0dXBOb2RlKG5vZGUsIHByb3RvKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHBhdGNoID0gcGF0Y2hJZk5vdEFscmVhZHk7XG4gICAgfVxuICBcbiAgICBpZiAoSUU4KSB7XG4gICAgICBkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCA9IGZhbHNlO1xuICAgICAgKGZ1bmN0aW9uICgpe1xuICAgICAgICB2YXJcbiAgICAgICAgICBkZXNjcmlwdG9yID0gZ09QRChIVE1MRWxlbWVudFByb3RvdHlwZSwgQUREX0VWRU5UX0xJU1RFTkVSKSxcbiAgICAgICAgICBhZGRFdmVudExpc3RlbmVyID0gZGVzY3JpcHRvci52YWx1ZSxcbiAgICAgICAgICBwYXRjaGVkUmVtb3ZlQXR0cmlidXRlID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIHZhciBlID0gbmV3IEN1c3RvbUV2ZW50KERPTV9BVFRSX01PRElGSUVELCB7YnViYmxlczogdHJ1ZX0pO1xuICAgICAgICAgICAgZS5hdHRyTmFtZSA9IG5hbWU7XG4gICAgICAgICAgICBlLnByZXZWYWx1ZSA9IGdldEF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUpO1xuICAgICAgICAgICAgZS5uZXdWYWx1ZSA9IG51bGw7XG4gICAgICAgICAgICBlW1JFTU9WQUxdID0gZS5hdHRyQ2hhbmdlID0gMjtcbiAgICAgICAgICAgIHJlbW92ZUF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUpO1xuICAgICAgICAgICAgZGlzcGF0Y2hFdmVudC5jYWxsKHRoaXMsIGUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgcGF0Y2hlZFNldEF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICAgICAgdmFyXG4gICAgICAgICAgICAgIGhhZCA9IGhhc0F0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUpLFxuICAgICAgICAgICAgICBvbGQgPSBoYWQgJiYgZ2V0QXR0cmlidXRlLmNhbGwodGhpcywgbmFtZSksXG4gICAgICAgICAgICAgIGUgPSBuZXcgQ3VzdG9tRXZlbnQoRE9NX0FUVFJfTU9ESUZJRUQsIHtidWJibGVzOiB0cnVlfSlcbiAgICAgICAgICAgIDtcbiAgICAgICAgICAgIHNldEF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgIGUuYXR0ck5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgZS5wcmV2VmFsdWUgPSBoYWQgPyBvbGQgOiBudWxsO1xuICAgICAgICAgICAgZS5uZXdWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgaWYgKGhhZCkge1xuICAgICAgICAgICAgICBlW01PRElGSUNBVElPTl0gPSBlLmF0dHJDaGFuZ2UgPSAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZVtBRERJVElPTl0gPSBlLmF0dHJDaGFuZ2UgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGlzcGF0Y2hFdmVudC5jYWxsKHRoaXMsIGUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgb25Qcm9wZXJ0eUNoYW5nZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAvLyBqc2hpbnQgZXFudWxsOnRydWVcbiAgICAgICAgICAgIHZhclxuICAgICAgICAgICAgICBub2RlID0gZS5jdXJyZW50VGFyZ2V0LFxuICAgICAgICAgICAgICBzdXBlclNlY3JldCA9IG5vZGVbRVhQQU5ET19VSURdLFxuICAgICAgICAgICAgICBwcm9wZXJ0eU5hbWUgPSBlLnByb3BlcnR5TmFtZSxcbiAgICAgICAgICAgICAgZXZlbnRcbiAgICAgICAgICAgIDtcbiAgICAgICAgICAgIGlmIChzdXBlclNlY3JldC5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eU5hbWUpKSB7XG4gICAgICAgICAgICAgIHN1cGVyU2VjcmV0ID0gc3VwZXJTZWNyZXRbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgICAgICAgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoRE9NX0FUVFJfTU9ESUZJRUQsIHtidWJibGVzOiB0cnVlfSk7XG4gICAgICAgICAgICAgIGV2ZW50LmF0dHJOYW1lID0gc3VwZXJTZWNyZXQubmFtZTtcbiAgICAgICAgICAgICAgZXZlbnQucHJldlZhbHVlID0gc3VwZXJTZWNyZXQudmFsdWUgfHwgbnVsbDtcbiAgICAgICAgICAgICAgZXZlbnQubmV3VmFsdWUgPSAoc3VwZXJTZWNyZXQudmFsdWUgPSBub2RlW3Byb3BlcnR5TmFtZV0gfHwgbnVsbCk7XG4gICAgICAgICAgICAgIGlmIChldmVudC5wcmV2VmFsdWUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGV2ZW50W0FERElUSU9OXSA9IGV2ZW50LmF0dHJDaGFuZ2UgPSAwO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGV2ZW50W01PRElGSUNBVElPTl0gPSBldmVudC5hdHRyQ2hhbmdlID0gMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBkaXNwYXRjaEV2ZW50LmNhbGwobm9kZSwgZXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgO1xuICAgICAgICBkZXNjcmlwdG9yLnZhbHVlID0gZnVuY3Rpb24gKHR5cGUsIGhhbmRsZXIsIGNhcHR1cmUpIHtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICB0eXBlID09PSBET01fQVRUUl9NT0RJRklFRCAmJlxuICAgICAgICAgICAgdGhpc1tBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDS10gJiZcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlICE9PSBwYXRjaGVkU2V0QXR0cmlidXRlXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzW0VYUEFORE9fVUlEXSA9IHtcbiAgICAgICAgICAgICAgY2xhc3NOYW1lOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ2NsYXNzJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5jbGFzc05hbWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlID0gcGF0Y2hlZFNldEF0dHJpYnV0ZTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlID0gcGF0Y2hlZFJlbW92ZUF0dHJpYnV0ZTtcbiAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCAncHJvcGVydHljaGFuZ2UnLCBvblByb3BlcnR5Q2hhbmdlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsIHR5cGUsIGhhbmRsZXIsIGNhcHR1cmUpO1xuICAgICAgICB9O1xuICAgICAgICBkZWZpbmVQcm9wZXJ0eShIVE1MRWxlbWVudFByb3RvdHlwZSwgQUREX0VWRU5UX0xJU1RFTkVSLCBkZXNjcmlwdG9yKTtcbiAgICAgIH0oKSk7XG4gICAgfSBlbHNlIGlmICghTXV0YXRpb25PYnNlcnZlcikge1xuICAgICAgZG9jdW1lbnRFbGVtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oRE9NX0FUVFJfTU9ESUZJRUQsIERPTUF0dHJNb2RpZmllZCk7XG4gICAgICBkb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKEVYUEFORE9fVUlELCAxKTtcbiAgICAgIGRvY3VtZW50RWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoRVhQQU5ET19VSUQpO1xuICAgICAgaWYgKGRvZXNOb3RTdXBwb3J0RE9NQXR0ck1vZGlmaWVkKSB7XG4gICAgICAgIG9uU3VidHJlZU1vZGlmaWVkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICB2YXJcbiAgICAgICAgICAgIG5vZGUgPSB0aGlzLFxuICAgICAgICAgICAgb2xkQXR0cmlidXRlcyxcbiAgICAgICAgICAgIG5ld0F0dHJpYnV0ZXMsXG4gICAgICAgICAgICBrZXlcbiAgICAgICAgICA7XG4gICAgICAgICAgaWYgKG5vZGUgPT09IGUudGFyZ2V0KSB7XG4gICAgICAgICAgICBvbGRBdHRyaWJ1dGVzID0gbm9kZVtFWFBBTkRPX1VJRF07XG4gICAgICAgICAgICBub2RlW0VYUEFORE9fVUlEXSA9IChuZXdBdHRyaWJ1dGVzID0gZ2V0QXR0cmlidXRlc01pcnJvcihub2RlKSk7XG4gICAgICAgICAgICBmb3IgKGtleSBpbiBuZXdBdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgIGlmICghKGtleSBpbiBvbGRBdHRyaWJ1dGVzKSkge1xuICAgICAgICAgICAgICAgIC8vIGF0dHJpYnV0ZSB3YXMgYWRkZWRcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbERPTUF0dHJNb2RpZmllZChcbiAgICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgICBub2RlLFxuICAgICAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICAgICAgb2xkQXR0cmlidXRlc1trZXldLFxuICAgICAgICAgICAgICAgICAgbmV3QXR0cmlidXRlc1trZXldLFxuICAgICAgICAgICAgICAgICAgQURESVRJT05cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5ld0F0dHJpYnV0ZXNba2V5XSAhPT0gb2xkQXR0cmlidXRlc1trZXldKSB7XG4gICAgICAgICAgICAgICAgLy8gYXR0cmlidXRlIHdhcyBjaGFuZ2VkXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxET01BdHRyTW9kaWZpZWQoXG4gICAgICAgICAgICAgICAgICAxLFxuICAgICAgICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgIG9sZEF0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIG5ld0F0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIE1PRElGSUNBVElPTlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNoZWNraW5nIGlmIGl0IGhhcyBiZWVuIHJlbW92ZWRcbiAgICAgICAgICAgIGZvciAoa2V5IGluIG9sZEF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgaWYgKCEoa2V5IGluIG5ld0F0dHJpYnV0ZXMpKSB7XG4gICAgICAgICAgICAgICAgLy8gYXR0cmlidXRlIHJlbW92ZWRcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbERPTUF0dHJNb2RpZmllZChcbiAgICAgICAgICAgICAgICAgIDIsXG4gICAgICAgICAgICAgICAgICBub2RlLFxuICAgICAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICAgICAgb2xkQXR0cmlidXRlc1trZXldLFxuICAgICAgICAgICAgICAgICAgbmV3QXR0cmlidXRlc1trZXldLFxuICAgICAgICAgICAgICAgICAgUkVNT1ZBTFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNhbGxET01BdHRyTW9kaWZpZWQgPSBmdW5jdGlvbiAoXG4gICAgICAgICAgYXR0ckNoYW5nZSxcbiAgICAgICAgICBjdXJyZW50VGFyZ2V0LFxuICAgICAgICAgIGF0dHJOYW1lLFxuICAgICAgICAgIHByZXZWYWx1ZSxcbiAgICAgICAgICBuZXdWYWx1ZSxcbiAgICAgICAgICBhY3Rpb25cbiAgICAgICAgKSB7XG4gICAgICAgICAgdmFyIGUgPSB7XG4gICAgICAgICAgICBhdHRyQ2hhbmdlOiBhdHRyQ2hhbmdlLFxuICAgICAgICAgICAgY3VycmVudFRhcmdldDogY3VycmVudFRhcmdldCxcbiAgICAgICAgICAgIGF0dHJOYW1lOiBhdHRyTmFtZSxcbiAgICAgICAgICAgIHByZXZWYWx1ZTogcHJldlZhbHVlLFxuICAgICAgICAgICAgbmV3VmFsdWU6IG5ld1ZhbHVlXG4gICAgICAgICAgfTtcbiAgICAgICAgICBlW2FjdGlvbl0gPSBhdHRyQ2hhbmdlO1xuICAgICAgICAgIG9uRE9NQXR0ck1vZGlmaWVkKGUpO1xuICAgICAgICB9O1xuICAgICAgICBnZXRBdHRyaWJ1dGVzTWlycm9yID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICBmb3IgKHZhclxuICAgICAgICAgICAgYXR0ciwgbmFtZSxcbiAgICAgICAgICAgIHJlc3VsdCA9IHt9LFxuICAgICAgICAgICAgYXR0cmlidXRlcyA9IG5vZGUuYXR0cmlidXRlcyxcbiAgICAgICAgICAgIGkgPSAwLCBsZW5ndGggPSBhdHRyaWJ1dGVzLmxlbmd0aDtcbiAgICAgICAgICAgIGkgPCBsZW5ndGg7IGkrK1xuICAgICAgICAgICkge1xuICAgICAgICAgICAgYXR0ciA9IGF0dHJpYnV0ZXNbaV07XG4gICAgICAgICAgICBuYW1lID0gYXR0ci5uYW1lO1xuICAgICAgICAgICAgaWYgKG5hbWUgIT09ICdzZXRBdHRyaWJ1dGUnKSB7XG4gICAgICAgICAgICAgIHJlc3VsdFtuYW1lXSA9IGF0dHIudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICBcbiAgICAvLyBzZXQgYXMgZW51bWVyYWJsZSwgd3JpdGFibGUgYW5kIGNvbmZpZ3VyYWJsZVxuICAgIGRvY3VtZW50W1JFR0lTVEVSX0VMRU1FTlRdID0gZnVuY3Rpb24gcmVnaXN0ZXJFbGVtZW50KHR5cGUsIG9wdGlvbnMpIHtcbiAgICAgIHVwcGVyVHlwZSA9IHR5cGUudG9VcHBlckNhc2UoKTtcbiAgICAgIGlmIChzZXRMaXN0ZW5lcikge1xuICAgICAgICAvLyBvbmx5IGZpcnN0IHRpbWUgZG9jdW1lbnQucmVnaXN0ZXJFbGVtZW50IGlzIHVzZWRcbiAgICAgICAgLy8gd2UgbmVlZCB0byBzZXQgdGhpcyBsaXN0ZW5lclxuICAgICAgICAvLyBzZXR0aW5nIGl0IGJ5IGRlZmF1bHQgbWlnaHQgc2xvdyBkb3duIGZvciBubyByZWFzb25cbiAgICAgICAgc2V0TGlzdGVuZXIgPSBmYWxzZTtcbiAgICAgICAgaWYgKE11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAgICAgICBvYnNlcnZlciA9IChmdW5jdGlvbihhdHRhY2hlZCwgZGV0YWNoZWQpe1xuICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tFbUFsbChsaXN0LCBjYWxsYmFjaykge1xuICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gbGlzdC5sZW5ndGg7IGkgPCBsZW5ndGg7IGNhbGxiYWNrKGxpc3RbaSsrXSkpe31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAocmVjb3Jkcykge1xuICAgICAgICAgICAgICBmb3IgKHZhclxuICAgICAgICAgICAgICAgIGN1cnJlbnQsIG5vZGUsIG5ld1ZhbHVlLFxuICAgICAgICAgICAgICAgIGkgPSAwLCBsZW5ndGggPSByZWNvcmRzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrXG4gICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnQgPSByZWNvcmRzW2ldO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50LnR5cGUgPT09ICdjaGlsZExpc3QnKSB7XG4gICAgICAgICAgICAgICAgICBjaGVja0VtQWxsKGN1cnJlbnQuYWRkZWROb2RlcywgYXR0YWNoZWQpO1xuICAgICAgICAgICAgICAgICAgY2hlY2tFbUFsbChjdXJyZW50LnJlbW92ZWROb2RlcywgZGV0YWNoZWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBub2RlID0gY3VycmVudC50YXJnZXQ7XG4gICAgICAgICAgICAgICAgICBpZiAobm90RnJvbUlubmVySFRNTEhlbHBlciAmJlxuICAgICAgICAgICAgICAgICAgICAgIG5vZGVbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdICYmXG4gICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5hdHRyaWJ1dGVOYW1lICE9PSAnc3R5bGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gZ2V0QXR0cmlidXRlLmNhbGwobm9kZSwgY3VycmVudC5hdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld1ZhbHVlICE9PSBjdXJyZW50Lm9sZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgbm9kZVtBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDS10oXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmF0dHJpYnV0ZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Lm9sZFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KGV4ZWN1dGVBY3Rpb24oQVRUQUNIRUQpLCBleGVjdXRlQWN0aW9uKERFVEFDSEVEKSkpO1xuICAgICAgICAgIG9ic2VydmUgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShcbiAgICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzdWJ0cmVlOiB0cnVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIG9ic2VydmUoZG9jdW1lbnQpO1xuICAgICAgICAgIGlmIChhdHRhY2hTaGFkb3cpIHtcbiAgICAgICAgICAgIEhUTUxFbGVtZW50UHJvdG90eXBlLmF0dGFjaFNoYWRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG9ic2VydmUoYXR0YWNoU2hhZG93LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXNhcFF1ZXVlID0gW107XG4gICAgICAgICAgZG9jdW1lbnRbQUREX0VWRU5UX0xJU1RFTkVSXSgnRE9NTm9kZUluc2VydGVkJywgb25ET01Ob2RlKEFUVEFDSEVEKSk7XG4gICAgICAgICAgZG9jdW1lbnRbQUREX0VWRU5UX0xJU1RFTkVSXSgnRE9NTm9kZVJlbW92ZWQnLCBvbkRPTU5vZGUoREVUQUNIRUQpKTtcbiAgICAgICAgfVxuICBcbiAgICAgICAgZG9jdW1lbnRbQUREX0VWRU5UX0xJU1RFTkVSXShET01fQ09OVEVOVF9MT0FERUQsIG9uUmVhZHlTdGF0ZUNoYW5nZSk7XG4gICAgICAgIGRvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oJ3JlYWR5c3RhdGVjaGFuZ2UnLCBvblJlYWR5U3RhdGVDaGFuZ2UpO1xuICBcbiAgICAgICAgSFRNTEVsZW1lbnRQcm90b3R5cGUuY2xvbmVOb2RlID0gZnVuY3Rpb24gKGRlZXApIHtcbiAgICAgICAgICB2YXJcbiAgICAgICAgICAgIG5vZGUgPSBjbG9uZU5vZGUuY2FsbCh0aGlzLCAhIWRlZXApLFxuICAgICAgICAgICAgaSA9IGdldFR5cGVJbmRleChub2RlKVxuICAgICAgICAgIDtcbiAgICAgICAgICBpZiAoLTEgPCBpKSBwYXRjaChub2RlLCBwcm90b3NbaV0pO1xuICAgICAgICAgIGlmIChkZWVwICYmIHF1ZXJ5Lmxlbmd0aCkgbG9vcEFuZFNldHVwKG5vZGUucXVlcnlTZWxlY3RvckFsbChxdWVyeSkpO1xuICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICB9O1xuICAgICAgfVxuICBcbiAgICAgIGlmIChqdXN0U2V0dXApIHJldHVybiAoanVzdFNldHVwID0gZmFsc2UpO1xuICBcbiAgICAgIGlmICgtMiA8IChcbiAgICAgICAgaW5kZXhPZi5jYWxsKHR5cGVzLCBQUkVGSVhfSVMgKyB1cHBlclR5cGUpICtcbiAgICAgICAgaW5kZXhPZi5jYWxsKHR5cGVzLCBQUkVGSVhfVEFHICsgdXBwZXJUeXBlKVxuICAgICAgKSkge1xuICAgICAgICB0aHJvd1R5cGVFcnJvcih0eXBlKTtcbiAgICAgIH1cbiAgXG4gICAgICBpZiAoIXZhbGlkTmFtZS50ZXN0KHVwcGVyVHlwZSkgfHwgLTEgPCBpbmRleE9mLmNhbGwoaW52YWxpZE5hbWVzLCB1cHBlclR5cGUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHR5cGUgJyArIHR5cGUgKyAnIGlzIGludmFsaWQnKTtcbiAgICAgIH1cbiAgXG4gICAgICB2YXJcbiAgICAgICAgY29uc3RydWN0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIGV4dGVuZGluZyA/XG4gICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGVOYW1lLCB1cHBlclR5cGUpIDpcbiAgICAgICAgICAgIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobm9kZU5hbWUpO1xuICAgICAgICB9LFxuICAgICAgICBvcHQgPSBvcHRpb25zIHx8IE9QLFxuICAgICAgICBleHRlbmRpbmcgPSBoT1AuY2FsbChvcHQsIEVYVEVORFMpLFxuICAgICAgICBub2RlTmFtZSA9IGV4dGVuZGluZyA/IG9wdGlvbnNbRVhURU5EU10udG9VcHBlckNhc2UoKSA6IHVwcGVyVHlwZSxcbiAgICAgICAgdXBwZXJUeXBlLFxuICAgICAgICBpXG4gICAgICA7XG4gIFxuICAgICAgaWYgKGV4dGVuZGluZyAmJiAtMSA8IChcbiAgICAgICAgaW5kZXhPZi5jYWxsKHR5cGVzLCBQUkVGSVhfVEFHICsgbm9kZU5hbWUpXG4gICAgICApKSB7XG4gICAgICAgIHRocm93VHlwZUVycm9yKG5vZGVOYW1lKTtcbiAgICAgIH1cbiAgXG4gICAgICBpID0gdHlwZXMucHVzaCgoZXh0ZW5kaW5nID8gUFJFRklYX0lTIDogUFJFRklYX1RBRykgKyB1cHBlclR5cGUpIC0gMTtcbiAgXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmNvbmNhdChcbiAgICAgICAgcXVlcnkubGVuZ3RoID8gJywnIDogJycsXG4gICAgICAgIGV4dGVuZGluZyA/IG5vZGVOYW1lICsgJ1tpcz1cIicgKyB0eXBlLnRvTG93ZXJDYXNlKCkgKyAnXCJdJyA6IG5vZGVOYW1lXG4gICAgICApO1xuICBcbiAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZSA9IChcbiAgICAgICAgcHJvdG9zW2ldID0gaE9QLmNhbGwob3B0LCAncHJvdG90eXBlJykgP1xuICAgICAgICAgIG9wdC5wcm90b3R5cGUgOlxuICAgICAgICAgIGNyZWF0ZShIVE1MRWxlbWVudFByb3RvdHlwZSlcbiAgICAgICk7XG4gIFxuICAgICAgaWYgKHF1ZXJ5Lmxlbmd0aCkgbG9vcEFuZFZlcmlmeShcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChxdWVyeSksXG4gICAgICAgIEFUVEFDSEVEXG4gICAgICApO1xuICBcbiAgICAgIHJldHVybiBjb25zdHJ1Y3RvcjtcbiAgICB9O1xuICBcbiAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50ID0gKHBhdGNoZWRDcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24gKGxvY2FsTmFtZSwgdHlwZUV4dGVuc2lvbikge1xuICAgICAgdmFyXG4gICAgICAgIGlzID0gZ2V0SXModHlwZUV4dGVuc2lvbiksXG4gICAgICAgIG5vZGUgPSBpcyA/XG4gICAgICAgICAgY3JlYXRlRWxlbWVudC5jYWxsKGRvY3VtZW50LCBsb2NhbE5hbWUsIHNlY29uZEFyZ3VtZW50KGlzKSkgOlxuICAgICAgICAgIGNyZWF0ZUVsZW1lbnQuY2FsbChkb2N1bWVudCwgbG9jYWxOYW1lKSxcbiAgICAgICAgbmFtZSA9ICcnICsgbG9jYWxOYW1lLFxuICAgICAgICBpID0gaW5kZXhPZi5jYWxsKFxuICAgICAgICAgIHR5cGVzLFxuICAgICAgICAgIChpcyA/IFBSRUZJWF9JUyA6IFBSRUZJWF9UQUcpICtcbiAgICAgICAgICAoaXMgfHwgbmFtZSkudG9VcHBlckNhc2UoKVxuICAgICAgICApLFxuICAgICAgICBzZXR1cCA9IC0xIDwgaVxuICAgICAgO1xuICAgICAgaWYgKGlzKSB7XG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdpcycsIGlzID0gaXMudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgIGlmIChzZXR1cCkge1xuICAgICAgICAgIHNldHVwID0gaXNJblFTQShuYW1lLnRvVXBwZXJDYXNlKCksIGlzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbm90RnJvbUlubmVySFRNTEhlbHBlciA9ICFkb2N1bWVudC5jcmVhdGVFbGVtZW50LmlubmVySFRNTEhlbHBlcjtcbiAgICAgIGlmIChzZXR1cCkgcGF0Y2gobm9kZSwgcHJvdG9zW2ldKTtcbiAgICAgIHJldHVybiBub2RlO1xuICAgIH0pO1xuICBcbiAgfVxuICBcbiAgZnVuY3Rpb24gQVNBUCgpIHtcbiAgICB2YXIgcXVldWUgPSBhc2FwUXVldWUuc3BsaWNlKDAsIGFzYXBRdWV1ZS5sZW5ndGgpO1xuICAgIGFzYXBUaW1lciA9IDA7XG4gICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCkge1xuICAgICAgcXVldWUuc2hpZnQoKS5jYWxsKFxuICAgICAgICBudWxsLCBxdWV1ZS5zaGlmdCgpXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gbG9vcEFuZFZlcmlmeShsaXN0LCBhY3Rpb24pIHtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gbGlzdC5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmVyaWZ5QW5kU2V0dXBBbmRBY3Rpb24obGlzdFtpXSwgYWN0aW9uKTtcbiAgICB9XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGxvb3BBbmRTZXR1cChsaXN0KSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGxpc3QubGVuZ3RoLCBub2RlOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIG5vZGUgPSBsaXN0W2ldO1xuICAgICAgcGF0Y2gobm9kZSwgcHJvdG9zW2dldFR5cGVJbmRleChub2RlKV0pO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gZXhlY3V0ZUFjdGlvbihhY3Rpb24pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgIGlmIChpc1ZhbGlkTm9kZShub2RlKSkge1xuICAgICAgICB2ZXJpZnlBbmRTZXR1cEFuZEFjdGlvbihub2RlLCBhY3Rpb24pO1xuICAgICAgICBpZiAocXVlcnkubGVuZ3RoKSBsb29wQW5kVmVyaWZ5KFxuICAgICAgICAgIG5vZGUucXVlcnlTZWxlY3RvckFsbChxdWVyeSksXG4gICAgICAgICAgYWN0aW9uXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gZ2V0VHlwZUluZGV4KHRhcmdldCkge1xuICAgIHZhclxuICAgICAgaXMgPSBnZXRBdHRyaWJ1dGUuY2FsbCh0YXJnZXQsICdpcycpLFxuICAgICAgbm9kZU5hbWUgPSB0YXJnZXQubm9kZU5hbWUudG9VcHBlckNhc2UoKSxcbiAgICAgIGkgPSBpbmRleE9mLmNhbGwoXG4gICAgICAgIHR5cGVzLFxuICAgICAgICBpcyA/XG4gICAgICAgICAgICBQUkVGSVhfSVMgKyBpcy50b1VwcGVyQ2FzZSgpIDpcbiAgICAgICAgICAgIFBSRUZJWF9UQUcgKyBub2RlTmFtZVxuICAgICAgKVxuICAgIDtcbiAgICByZXR1cm4gaXMgJiYgLTEgPCBpICYmICFpc0luUVNBKG5vZGVOYW1lLCBpcykgPyAtMSA6IGk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGlzSW5RU0EobmFtZSwgdHlwZSkge1xuICAgIHJldHVybiAtMSA8IHF1ZXJ5LmluZGV4T2YobmFtZSArICdbaXM9XCInICsgdHlwZSArICdcIl0nKTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gb25ET01BdHRyTW9kaWZpZWQoZSkge1xuICAgIHZhclxuICAgICAgbm9kZSA9IGUuY3VycmVudFRhcmdldCxcbiAgICAgIGF0dHJDaGFuZ2UgPSBlLmF0dHJDaGFuZ2UsXG4gICAgICBhdHRyTmFtZSA9IGUuYXR0ck5hbWUsXG4gICAgICB0YXJnZXQgPSBlLnRhcmdldCxcbiAgICAgIGFkZGl0aW9uID0gZVtBRERJVElPTl0gfHwgMixcbiAgICAgIHJlbW92YWwgPSBlW1JFTU9WQUxdIHx8IDNcbiAgICA7XG4gICAgaWYgKG5vdEZyb21Jbm5lckhUTUxIZWxwZXIgJiZcbiAgICAgICAgKCF0YXJnZXQgfHwgdGFyZ2V0ID09PSBub2RlKSAmJlxuICAgICAgICBub2RlW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXSAmJlxuICAgICAgICBhdHRyTmFtZSAhPT0gJ3N0eWxlJyAmJiAoXG4gICAgICAgICAgZS5wcmV2VmFsdWUgIT09IGUubmV3VmFsdWUgfHxcbiAgICAgICAgICAvLyBJRTksIElFMTAsIGFuZCBPcGVyYSAxMiBnb3RjaGFcbiAgICAgICAgICBlLm5ld1ZhbHVlID09PSAnJyAmJiAoXG4gICAgICAgICAgICBhdHRyQ2hhbmdlID09PSBhZGRpdGlvbiB8fFxuICAgICAgICAgICAgYXR0ckNoYW5nZSA9PT0gcmVtb3ZhbFxuICAgICAgICAgIClcbiAgICApKSB7XG4gICAgICBub2RlW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXShcbiAgICAgICAgYXR0ck5hbWUsXG4gICAgICAgIGF0dHJDaGFuZ2UgPT09IGFkZGl0aW9uID8gbnVsbCA6IGUucHJldlZhbHVlLFxuICAgICAgICBhdHRyQ2hhbmdlID09PSByZW1vdmFsID8gbnVsbCA6IGUubmV3VmFsdWVcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiBvbkRPTU5vZGUoYWN0aW9uKSB7XG4gICAgdmFyIGV4ZWN1dG9yID0gZXhlY3V0ZUFjdGlvbihhY3Rpb24pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xuICAgICAgYXNhcFF1ZXVlLnB1c2goZXhlY3V0b3IsIGUudGFyZ2V0KTtcbiAgICAgIGlmIChhc2FwVGltZXIpIGNsZWFyVGltZW91dChhc2FwVGltZXIpO1xuICAgICAgYXNhcFRpbWVyID0gc2V0VGltZW91dChBU0FQLCAxKTtcbiAgICB9O1xuICB9XG4gIFxuICBmdW5jdGlvbiBvblJlYWR5U3RhdGVDaGFuZ2UoZSkge1xuICAgIGlmIChkcm9wRG9tQ29udGVudExvYWRlZCkge1xuICAgICAgZHJvcERvbUNvbnRlbnRMb2FkZWQgPSBmYWxzZTtcbiAgICAgIGUuY3VycmVudFRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKERPTV9DT05URU5UX0xPQURFRCwgb25SZWFkeVN0YXRlQ2hhbmdlKTtcbiAgICB9XG4gICAgaWYgKHF1ZXJ5Lmxlbmd0aCkgbG9vcEFuZFZlcmlmeShcbiAgICAgIChlLnRhcmdldCB8fCBkb2N1bWVudCkucXVlcnlTZWxlY3RvckFsbChxdWVyeSksXG4gICAgICBlLmRldGFpbCA9PT0gREVUQUNIRUQgPyBERVRBQ0hFRCA6IEFUVEFDSEVEXG4gICAgKTtcbiAgICBpZiAoSUU4KSBwdXJnZSgpO1xuICB9XG4gIFxuICBmdW5jdGlvbiBwYXRjaGVkU2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7XG4gICAgLy8ganNoaW50IHZhbGlkdGhpczp0cnVlXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNldEF0dHJpYnV0ZS5jYWxsKHNlbGYsIG5hbWUsIHZhbHVlKTtcbiAgICBvblN1YnRyZWVNb2RpZmllZC5jYWxsKHNlbGYsIHt0YXJnZXQ6IHNlbGZ9KTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gc2V0dXBOb2RlKG5vZGUsIHByb3RvKSB7XG4gICAgc2V0UHJvdG90eXBlKG5vZGUsIHByb3RvKTtcbiAgICBpZiAob2JzZXJ2ZXIpIHtcbiAgICAgIG9ic2VydmVyLm9ic2VydmUobm9kZSwgYXR0cmlidXRlc09ic2VydmVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGRvZXNOb3RTdXBwb3J0RE9NQXR0ck1vZGlmaWVkKSB7XG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlID0gcGF0Y2hlZFNldEF0dHJpYnV0ZTtcbiAgICAgICAgbm9kZVtFWFBBTkRPX1VJRF0gPSBnZXRBdHRyaWJ1dGVzTWlycm9yKG5vZGUpO1xuICAgICAgICBub2RlW0FERF9FVkVOVF9MSVNURU5FUl0oRE9NX1NVQlRSRUVfTU9ESUZJRUQsIG9uU3VidHJlZU1vZGlmaWVkKTtcbiAgICAgIH1cbiAgICAgIG5vZGVbQUREX0VWRU5UX0xJU1RFTkVSXShET01fQVRUUl9NT0RJRklFRCwgb25ET01BdHRyTW9kaWZpZWQpO1xuICAgIH1cbiAgICBpZiAobm9kZVtDUkVBVEVEX0NBTExCQUNLXSAmJiBub3RGcm9tSW5uZXJIVE1MSGVscGVyKSB7XG4gICAgICBub2RlLmNyZWF0ZWQgPSB0cnVlO1xuICAgICAgbm9kZVtDUkVBVEVEX0NBTExCQUNLXSgpO1xuICAgICAgbm9kZS5jcmVhdGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiBwdXJnZSgpIHtcbiAgICBmb3IgKHZhclxuICAgICAgbm9kZSxcbiAgICAgIGkgPSAwLFxuICAgICAgbGVuZ3RoID0gdGFyZ2V0cy5sZW5ndGg7XG4gICAgICBpIDwgbGVuZ3RoOyBpKytcbiAgICApIHtcbiAgICAgIG5vZGUgPSB0YXJnZXRzW2ldO1xuICAgICAgaWYgKCFkb2N1bWVudEVsZW1lbnQuY29udGFpbnMobm9kZSkpIHtcbiAgICAgICAgbGVuZ3RoLS07XG4gICAgICAgIHRhcmdldHMuc3BsaWNlKGktLSwgMSk7XG4gICAgICAgIHZlcmlmeUFuZFNldHVwQW5kQWN0aW9uKG5vZGUsIERFVEFDSEVEKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHRocm93VHlwZUVycm9yKHR5cGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgJyArIHR5cGUgKyAnIHR5cGUgaXMgYWxyZWFkeSByZWdpc3RlcmVkJyk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHZlcmlmeUFuZFNldHVwQW5kQWN0aW9uKG5vZGUsIGFjdGlvbikge1xuICAgIHZhclxuICAgICAgZm4sXG4gICAgICBpID0gZ2V0VHlwZUluZGV4KG5vZGUpXG4gICAgO1xuICAgIGlmICgtMSA8IGkpIHtcbiAgICAgIHBhdGNoSWZOb3RBbHJlYWR5KG5vZGUsIHByb3Rvc1tpXSk7XG4gICAgICBpID0gMDtcbiAgICAgIGlmIChhY3Rpb24gPT09IEFUVEFDSEVEICYmICFub2RlW0FUVEFDSEVEXSkge1xuICAgICAgICBub2RlW0RFVEFDSEVEXSA9IGZhbHNlO1xuICAgICAgICBub2RlW0FUVEFDSEVEXSA9IHRydWU7XG4gICAgICAgIGkgPSAxO1xuICAgICAgICBpZiAoSUU4ICYmIGluZGV4T2YuY2FsbCh0YXJnZXRzLCBub2RlKSA8IDApIHtcbiAgICAgICAgICB0YXJnZXRzLnB1c2gobm9kZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSBERVRBQ0hFRCAmJiAhbm9kZVtERVRBQ0hFRF0pIHtcbiAgICAgICAgbm9kZVtBVFRBQ0hFRF0gPSBmYWxzZTtcbiAgICAgICAgbm9kZVtERVRBQ0hFRF0gPSB0cnVlO1xuICAgICAgICBpID0gMTtcbiAgICAgIH1cbiAgICAgIGlmIChpICYmIChmbiA9IG5vZGVbYWN0aW9uICsgQ0FMTEJBQ0tdKSkgZm4uY2FsbChub2RlKTtcbiAgICB9XG4gIH1cbiAgXG4gIFxuICBcbiAgLy8gVjEgaW4gZGEgSG91c2UhXG4gIGZ1bmN0aW9uIEN1c3RvbUVsZW1lbnRSZWdpc3RyeSgpIHt9XG4gIFxuICBDdXN0b21FbGVtZW50UmVnaXN0cnkucHJvdG90eXBlID0ge1xuICAgIGNvbnN0cnVjdG9yOiBDdXN0b21FbGVtZW50UmVnaXN0cnksXG4gICAgLy8gYSB3b3JrYXJvdW5kIGZvciB0aGUgc3R1YmJvcm4gV2ViS2l0XG4gICAgZGVmaW5lOiB1c2FibGVDdXN0b21FbGVtZW50cyA/XG4gICAgICBmdW5jdGlvbiAobmFtZSwgQ2xhc3MsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgICAgICBDRVJEZWZpbmUobmFtZSwgQ2xhc3MsIG9wdGlvbnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBOQU1FID0gbmFtZS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgIGNvbnN0cnVjdG9yc1tOQU1FXSA9IHtcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yOiBDbGFzcyxcbiAgICAgICAgICAgIGNyZWF0ZTogW05BTUVdXG4gICAgICAgICAgfTtcbiAgICAgICAgICBub2RlTmFtZXMuc2V0KENsYXNzLCBOQU1FKTtcbiAgICAgICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUobmFtZSwgQ2xhc3MpO1xuICAgICAgICB9XG4gICAgICB9IDpcbiAgICAgIENFUkRlZmluZSxcbiAgICBnZXQ6IHVzYWJsZUN1c3RvbUVsZW1lbnRzID9cbiAgICAgIGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiBjdXN0b21FbGVtZW50cy5nZXQobmFtZSkgfHwgZ2V0KG5hbWUpO1xuICAgICAgfSA6XG4gICAgICBnZXQsXG4gICAgd2hlbkRlZmluZWQ6IHVzYWJsZUN1c3RvbUVsZW1lbnRzID9cbiAgICAgIGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJhY2UoW1xuICAgICAgICAgIGN1c3RvbUVsZW1lbnRzLndoZW5EZWZpbmVkKG5hbWUpLFxuICAgICAgICAgIHdoZW5EZWZpbmVkKG5hbWUpXG4gICAgICAgIF0pO1xuICAgICAgfSA6XG4gICAgICB3aGVuRGVmaW5lZFxuICB9O1xuICBcbiAgZnVuY3Rpb24gQ0VSRGVmaW5lKG5hbWUsIENsYXNzLCBvcHRpb25zKSB7XG4gICAgdmFyXG4gICAgICBpcyA9IG9wdGlvbnMgJiYgb3B0aW9uc1tFWFRFTkRTXSB8fCAnJyxcbiAgICAgIENQcm90byA9IENsYXNzLnByb3RvdHlwZSxcbiAgICAgIHByb3RvID0gY3JlYXRlKENQcm90byksXG4gICAgICBhdHRyaWJ1dGVzID0gQ2xhc3Mub2JzZXJ2ZWRBdHRyaWJ1dGVzIHx8IGVtcHR5LFxuICAgICAgZGVmaW5pdGlvbiA9IHtwcm90b3R5cGU6IHByb3RvfVxuICAgIDtcbiAgICAvLyBUT0RPOiBpcyB0aGlzIG5lZWRlZCBhdCBhbGwgc2luY2UgaXQncyBpbmhlcml0ZWQ/XG4gICAgLy8gZGVmaW5lUHJvcGVydHkocHJvdG8sICdjb25zdHJ1Y3RvcicsIHt2YWx1ZTogQ2xhc3N9KTtcbiAgICBzYWZlUHJvcGVydHkocHJvdG8sIENSRUFURURfQ0FMTEJBQ0ssIHtcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoanVzdENyZWF0ZWQpIGp1c3RDcmVhdGVkID0gZmFsc2U7XG4gICAgICAgICAgZWxzZSBpZiAoIXRoaXNbRFJFQ0VWMV0pIHtcbiAgICAgICAgICAgIHRoaXNbRFJFQ0VWMV0gPSB0cnVlO1xuICAgICAgICAgICAgbmV3IENsYXNzKHRoaXMpO1xuICAgICAgICAgICAgaWYgKENQcm90b1tDUkVBVEVEX0NBTExCQUNLXSlcbiAgICAgICAgICAgICAgQ1Byb3RvW0NSRUFURURfQ0FMTEJBQ0tdLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB2YXIgaW5mbyA9IGNvbnN0cnVjdG9yc1tub2RlTmFtZXMuZ2V0KENsYXNzKV07XG4gICAgICAgICAgICBpZiAoIXVzYWJsZUN1c3RvbUVsZW1lbnRzIHx8IGluZm8uY3JlYXRlLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgbm90aWZ5QXR0cmlidXRlcyh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgc2FmZVByb3BlcnR5KHByb3RvLCBBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDSywge1xuICAgICAgdmFsdWU6IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIGlmICgtMSA8IGluZGV4T2YuY2FsbChhdHRyaWJ1dGVzLCBuYW1lKSlcbiAgICAgICAgICBDUHJvdG9bQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKENQcm90b1tDT05ORUNURURfQ0FMTEJBQ0tdKSB7XG4gICAgICBzYWZlUHJvcGVydHkocHJvdG8sIEFUVEFDSEVEX0NBTExCQUNLLCB7XG4gICAgICAgIHZhbHVlOiBDUHJvdG9bQ09OTkVDVEVEX0NBTExCQUNLXVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChDUHJvdG9bRElTQ09OTkVDVEVEX0NBTExCQUNLXSkge1xuICAgICAgc2FmZVByb3BlcnR5KHByb3RvLCBERVRBQ0hFRF9DQUxMQkFDSywge1xuICAgICAgICB2YWx1ZTogQ1Byb3RvW0RJU0NPTk5FQ1RFRF9DQUxMQkFDS11cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoaXMpIGRlZmluaXRpb25bRVhURU5EU10gPSBpcztcbiAgICBuYW1lID0gbmFtZS50b1VwcGVyQ2FzZSgpO1xuICAgIGNvbnN0cnVjdG9yc1tuYW1lXSA9IHtcbiAgICAgIGNvbnN0cnVjdG9yOiBDbGFzcyxcbiAgICAgIGNyZWF0ZTogaXMgPyBbaXMsIHNlY29uZEFyZ3VtZW50KG5hbWUpXSA6IFtuYW1lXVxuICAgIH07XG4gICAgbm9kZU5hbWVzLnNldChDbGFzcywgbmFtZSk7XG4gICAgZG9jdW1lbnRbUkVHSVNURVJfRUxFTUVOVF0obmFtZS50b0xvd2VyQ2FzZSgpLCBkZWZpbml0aW9uKTtcbiAgICB3aGVuRGVmaW5lZChuYW1lKTtcbiAgICB3YWl0aW5nTGlzdFtuYW1lXS5yKCk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGdldChuYW1lKSB7XG4gICAgdmFyIGluZm8gPSBjb25zdHJ1Y3RvcnNbbmFtZS50b1VwcGVyQ2FzZSgpXTtcbiAgICByZXR1cm4gaW5mbyAmJiBpbmZvLmNvbnN0cnVjdG9yO1xuICB9XG4gIFxuICBmdW5jdGlvbiBnZXRJcyhvcHRpb25zKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBvcHRpb25zID09PSAnc3RyaW5nJyA/XG4gICAgICAgIG9wdGlvbnMgOiAob3B0aW9ucyAmJiBvcHRpb25zLmlzIHx8ICcnKTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gbm90aWZ5QXR0cmlidXRlcyhzZWxmKSB7XG4gICAgdmFyXG4gICAgICBjYWxsYmFjayA9IHNlbGZbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdLFxuICAgICAgYXR0cmlidXRlcyA9IGNhbGxiYWNrID8gc2VsZi5hdHRyaWJ1dGVzIDogZW1wdHksXG4gICAgICBpID0gYXR0cmlidXRlcy5sZW5ndGgsXG4gICAgICBhdHRyaWJ1dGVcbiAgICA7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgYXR0cmlidXRlID0gIGF0dHJpYnV0ZXNbaV07IC8vIHx8IGF0dHJpYnV0ZXMuaXRlbShpKTtcbiAgICAgIGNhbGxiYWNrLmNhbGwoXG4gICAgICAgIHNlbGYsXG4gICAgICAgIGF0dHJpYnV0ZS5uYW1lIHx8IGF0dHJpYnV0ZS5ub2RlTmFtZSxcbiAgICAgICAgbnVsbCxcbiAgICAgICAgYXR0cmlidXRlLnZhbHVlIHx8IGF0dHJpYnV0ZS5ub2RlVmFsdWVcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiB3aGVuRGVmaW5lZChuYW1lKSB7XG4gICAgbmFtZSA9IG5hbWUudG9VcHBlckNhc2UoKTtcbiAgICBpZiAoIShuYW1lIGluIHdhaXRpbmdMaXN0KSkge1xuICAgICAgd2FpdGluZ0xpc3RbbmFtZV0gPSB7fTtcbiAgICAgIHdhaXRpbmdMaXN0W25hbWVdLnAgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICB3YWl0aW5nTGlzdFtuYW1lXS5yID0gcmVzb2x2ZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gd2FpdGluZ0xpc3RbbmFtZV0ucDtcbiAgfVxuICBcbiAgZnVuY3Rpb24gcG9seWZpbGxWMSgpIHtcbiAgICBpZiAoY3VzdG9tRWxlbWVudHMpIGRlbGV0ZSB3aW5kb3cuY3VzdG9tRWxlbWVudHM7XG4gICAgZGVmaW5lUHJvcGVydHkod2luZG93LCAnY3VzdG9tRWxlbWVudHMnLCB7XG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogbmV3IEN1c3RvbUVsZW1lbnRSZWdpc3RyeSgpXG4gICAgfSk7XG4gICAgZGVmaW5lUHJvcGVydHkod2luZG93LCAnQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5Jywge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IEN1c3RvbUVsZW1lbnRSZWdpc3RyeVxuICAgIH0pO1xuICAgIGZvciAodmFyXG4gICAgICBwYXRjaENsYXNzID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIENsYXNzID0gd2luZG93W25hbWVdO1xuICAgICAgICBpZiAoQ2xhc3MpIHtcbiAgICAgICAgICB3aW5kb3dbbmFtZV0gPSBmdW5jdGlvbiBDdXN0b21FbGVtZW50c1YxKHNlbGYpIHtcbiAgICAgICAgICAgIHZhciBpbmZvLCBpc05hdGl2ZTtcbiAgICAgICAgICAgIGlmICghc2VsZikgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICBpZiAoIXNlbGZbRFJFQ0VWMV0pIHtcbiAgICAgICAgICAgICAganVzdENyZWF0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICBpbmZvID0gY29uc3RydWN0b3JzW25vZGVOYW1lcy5nZXQoc2VsZi5jb25zdHJ1Y3RvcildO1xuICAgICAgICAgICAgICBpc05hdGl2ZSA9IHVzYWJsZUN1c3RvbUVsZW1lbnRzICYmIGluZm8uY3JlYXRlLmxlbmd0aCA9PT0gMTtcbiAgICAgICAgICAgICAgc2VsZiA9IGlzTmF0aXZlID9cbiAgICAgICAgICAgICAgICBSZWZsZWN0LmNvbnN0cnVjdChDbGFzcywgZW1wdHksIGluZm8uY29uc3RydWN0b3IpIDpcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50LmFwcGx5KGRvY3VtZW50LCBpbmZvLmNyZWF0ZSk7XG4gICAgICAgICAgICAgIHNlbGZbRFJFQ0VWMV0gPSB0cnVlO1xuICAgICAgICAgICAgICBqdXN0Q3JlYXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICBpZiAoIWlzTmF0aXZlKSBub3RpZnlBdHRyaWJ1dGVzKHNlbGYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHNlbGY7XG4gICAgICAgICAgfTtcbiAgICAgICAgICB3aW5kb3dbbmFtZV0ucHJvdG90eXBlID0gQ2xhc3MucHJvdG90eXBlO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSB3aW5kb3dbbmFtZV07XG4gICAgICAgICAgfSBjYXRjaChXZWJLaXQpIHtcbiAgICAgICAgICAgIGZpeEdldENsYXNzID0gdHJ1ZTtcbiAgICAgICAgICAgIGRlZmluZVByb3BlcnR5KENsYXNzLCBEUkVDRVYxLCB7dmFsdWU6IHdpbmRvd1tuYW1lXX0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIENsYXNzZXMgPSBodG1sQ2xhc3MuZ2V0KC9eSFRNTFtBLVpdKlthLXpdLyksXG4gICAgICBpID0gQ2xhc3Nlcy5sZW5ndGg7XG4gICAgICBpLS07XG4gICAgICBwYXRjaENsYXNzKENsYXNzZXNbaV0pXG4gICAgKSB7fVxuICAgIChkb2N1bWVudC5jcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24gKG5hbWUsIG9wdGlvbnMpIHtcbiAgICAgIHZhciBpcyA9IGdldElzKG9wdGlvbnMpO1xuICAgICAgcmV0dXJuIGlzID9cbiAgICAgICAgcGF0Y2hlZENyZWF0ZUVsZW1lbnQuY2FsbCh0aGlzLCBuYW1lLCBzZWNvbmRBcmd1bWVudChpcykpIDpcbiAgICAgICAgcGF0Y2hlZENyZWF0ZUVsZW1lbnQuY2FsbCh0aGlzLCBuYW1lKTtcbiAgICB9KTtcbiAgICBpZiAoIVYwKSB7XG4gICAgICBqdXN0U2V0dXAgPSB0cnVlO1xuICAgICAgZG9jdW1lbnRbUkVHSVNURVJfRUxFTUVOVF0oJycpO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gaWYgY3VzdG9tRWxlbWVudHMgaXMgbm90IHRoZXJlIGF0IGFsbFxuICBpZiAoIWN1c3RvbUVsZW1lbnRzIHx8IHBvbHlmaWxsID09PSAnZm9yY2UnKSBwb2x5ZmlsbFYxKCk7XG4gIGVsc2Uge1xuICAgIC8vIGlmIGF2YWlsYWJsZSB0ZXN0IGV4dGVuZHMgd29yayBhcyBleHBlY3RlZFxuICAgIHRyeSB7XG4gICAgICAoZnVuY3Rpb24gKERSRSwgb3B0aW9ucywgbmFtZSkge1xuICAgICAgICBvcHRpb25zW0VYVEVORFNdID0gJ2EnO1xuICAgICAgICBEUkUucHJvdG90eXBlID0gY3JlYXRlKEhUTUxBbmNob3JFbGVtZW50LnByb3RvdHlwZSk7XG4gICAgICAgIERSRS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBEUkU7XG4gICAgICAgIHdpbmRvdy5jdXN0b21FbGVtZW50cy5kZWZpbmUobmFtZSwgRFJFLCBvcHRpb25zKTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGdldEF0dHJpYnV0ZS5jYWxsKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnLCB7aXM6IG5hbWV9KSwgJ2lzJykgIT09IG5hbWUgfHxcbiAgICAgICAgICAodXNhYmxlQ3VzdG9tRWxlbWVudHMgJiYgZ2V0QXR0cmlidXRlLmNhbGwobmV3IERSRSgpLCAnaXMnKSAhPT0gbmFtZSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgdGhyb3cgb3B0aW9ucztcbiAgICAgICAgfVxuICAgICAgfShcbiAgICAgICAgZnVuY3Rpb24gRFJFKCkge1xuICAgICAgICAgIHJldHVybiBSZWZsZWN0LmNvbnN0cnVjdChIVE1MQW5jaG9yRWxlbWVudCwgW10sIERSRSk7XG4gICAgICAgIH0sXG4gICAgICAgIHt9LFxuICAgICAgICAnZG9jdW1lbnQtcmVnaXN0ZXItZWxlbWVudC1hJ1xuICAgICAgKSk7XG4gICAgfSBjYXRjaChvX08pIHtcbiAgICAgIC8vIG9yIGZvcmNlIHRoZSBwb2x5ZmlsbCBpZiBub3RcbiAgICAgIC8vIGFuZCBrZWVwIGludGVybmFsIG9yaWdpbmFsIHJlZmVyZW5jZVxuICAgICAgcG9seWZpbGxWMSgpO1xuICAgIH1cbiAgfVxuICBcbiAgdHJ5IHtcbiAgICBjcmVhdGVFbGVtZW50LmNhbGwoZG9jdW1lbnQsICdhJywgJ2EnKTtcbiAgfSBjYXRjaChGaXJlRm94KSB7XG4gICAgc2Vjb25kQXJndW1lbnQgPSBmdW5jdGlvbiAoaXMpIHtcbiAgICAgIHJldHVybiB7aXM6IGlzLnRvTG93ZXJDYXNlKCl9O1xuICAgIH07XG4gIH1cbiAgXG59XG5cbmV4cG9ydHMuaW5zdGFsbEN1c3RvbUVsZW1lbnRzID0gaW5zdGFsbEN1c3RvbUVsZW1lbnRzO1xuXG4iLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQ29uc3RydWN0cyBhIEVTNi9Qcm9taXNlcyBBKyBQcm9taXNlIGluc3RhbmNlLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICogQHBhcmFtIHtmdW5jdGlvbihmdW5jdGlvbigqPSksIGZ1bmN0aW9uICgqPSkpfSByZXNvbHZlclxuICovXG5mdW5jdGlvbiBQcm9taXNlKHJlc29sdmVyKSB7XG4gIGlmICghKHRoaXMgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0NvbnN0cnVjdG9yIFByb21pc2UgcmVxdWlyZXMgYG5ld2AnKTtcbiAgfVxuICBpZiAoIWlzRnVuY3Rpb24ocmVzb2x2ZXIpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignTXVzdCBwYXNzIHJlc29sdmVyIGZ1bmN0aW9uJyk7XG4gIH1cblxuICAvKipcbiAgICogQHR5cGUge2Z1bmN0aW9uKHRoaXM6UHJvbWlzZSwqPSxmdW5jdGlvbigqPSksZnVuY3Rpb24oKj0pLERlZmVycmVkKTohUHJvbWlzZX1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHRoaXMuX3N0YXRlID0gUGVuZGluZ1Byb21pc2U7XG5cbiAgLyoqXG4gICAqIEB0eXBlIHsqfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGhpcy5fdmFsdWUgPSBbXTtcblxuICAvKipcbiAgICogQHR5cGUge2Jvb2xlYW59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB0aGlzLl9pc0NoYWluRW5kID0gdHJ1ZTtcblxuICBkb1Jlc29sdmUoXG4gICAgdGhpcyxcbiAgICBhZG9wdGVyKHRoaXMsIEZ1bGZpbGxlZFByb21pc2UpLFxuICAgIGFkb3B0ZXIodGhpcywgUmVqZWN0ZWRQcm9taXNlKSxcbiAgICB7IHRoZW46IHJlc29sdmVyIH1cbiAgKTtcbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgUHVibGljIEluc3RhbmNlIE1ldGhvZHNcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgcHJvbWlzZSBpbnN0YW5jZSB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgcmVzdWx0IG9mIHRoaXMgcHJvbWlzZVxuICogYXMgaW5wdXRzIHRvIHRoZSBvbkZ1bGZpbGxlZCBvciBvblJlamVjdGVkIGNhbGxiYWNrcy5cbiAqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCopfSBvbkZ1bGZpbGxlZFxuICogQHBhcmFtIHtmdW5jdGlvbigqKX0gb25SZWplY3RlZFxuICovXG5Qcm9taXNlLnByb3RvdHlwZS50aGVuID0gZnVuY3Rpb24ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcbiAgb25GdWxmaWxsZWQgPSBpc0Z1bmN0aW9uKG9uRnVsZmlsbGVkKSA/IG9uRnVsZmlsbGVkIDogdm9pZCAwO1xuICBvblJlamVjdGVkID0gaXNGdW5jdGlvbihvblJlamVjdGVkKSA/IG9uUmVqZWN0ZWQgOiB2b2lkIDA7XG5cbiAgaWYgKG9uRnVsZmlsbGVkIHx8IG9uUmVqZWN0ZWQpIHtcbiAgICB0aGlzLl9pc0NoYWluRW5kID0gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gdGhpcy5fc3RhdGUoXG4gICAgdGhpcy5fdmFsdWUsXG4gICAgb25GdWxmaWxsZWQsXG4gICAgb25SZWplY3RlZFxuICApO1xufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHByb21pc2UgdGhhdCB3aWxsIGhhbmRsZSB0aGUgcmVqZWN0ZWQgc3RhdGUgb2YgdGhpcyBwcm9taXNlLlxuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKil9IG9uUmVqZWN0ZWRcbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2ggPSBmdW5jdGlvbihvblJlamVjdGVkKSB7XG4gIHJldHVybiB0aGlzLnRoZW4odm9pZCAwLCBvblJlamVjdGVkKTtcbn07XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gIFB1YmxpYyBTdGF0aWMgTWV0aG9kc1xuICoqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbi8qKlxuICogQ3JlYXRlcyBhIGZ1bGZpbGxlZCBQcm9taXNlIG9mIHZhbHVlLiBJZiB2YWx1ZSBpcyBpdHNlbGYgYSB0aGVuLWFibGUsXG4gKiByZXNvbHZlcyB3aXRoIHRoZSB0aGVuLWFibGUncyB2YWx1ZS5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9XG4gKiBAcGFyYW0geyo9fSB2YWx1ZVxuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5Qcm9taXNlLnJlc29sdmUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuICB2YXIgcHJvbWlzZTtcblxuICBpZiAoaXNPYmplY3QodmFsdWUpICYmIHZhbHVlIGluc3RhbmNlb2YgdGhpcykge1xuICAgIHByb21pc2UgPSB2YWx1ZTtcbiAgfSBlbHNlIHtcbiAgICBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2V9ICovKHByb21pc2UpO1xufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgcmVqZWN0ZWQgUHJvbWlzZSBvZiByZWFzb24uXG4gKlxuICogQHRoaXMgeyFQcm9taXNlfVxuICogQHBhcmFtIHsqPX0gcmVhc29uXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cblByb21pc2UucmVqZWN0ID0gZnVuY3Rpb24ocmVhc29uKSB7XG4gIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG4gIHZhciBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uKF8sIHJlamVjdCkge1xuICAgIHJlamVjdChyZWFzb24pO1xuICB9KTtcblxuICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZX0gKi8ocHJvbWlzZSk7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBQcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHdpdGggYW4gYXJyYXkgb2YgdGhlIHZhbHVlcyBvZiB0aGVcbiAqIHBhc3NlZCBpbiBwcm9taXNlcy4gSWYgYW55IHByb21pc2UgcmVqZWN0cywgdGhlIHJldHVybmVkIHByb21pc2Ugd2lsbFxuICogcmVqZWN0LlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX1cbiAqIEBwYXJhbSB7IUFycmF5PFByb21pc2V8Kj59IHByb21pc2VzXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cblByb21pc2UuYWxsID0gZnVuY3Rpb24ocHJvbWlzZXMpIHtcbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcbiAgdmFyIHByb21pc2UgPSBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdmFyIGxlbmd0aCA9IHByb21pc2VzLmxlbmd0aDtcbiAgICB2YXIgdmFsdWVzID0gbmV3IEFycmF5KGxlbmd0aCk7XG5cbiAgICBpZiAobGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gcmVzb2x2ZSh2YWx1ZXMpO1xuICAgIH1cblxuICAgIGVhY2gocHJvbWlzZXMsIGZ1bmN0aW9uKHByb21pc2UsIGluZGV4KSB7XG4gICAgICBDb25zdHJ1Y3Rvci5yZXNvbHZlKHByb21pc2UpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgdmFsdWVzW2luZGV4XSA9IHZhbHVlO1xuICAgICAgICBpZiAoLS1sZW5ndGggPT09IDApIHtcbiAgICAgICAgICByZXNvbHZlKHZhbHVlcyk7XG4gICAgICAgIH1cbiAgICAgIH0sIHJlamVjdCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlfSAqLyhwcm9taXNlKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIFByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgb3IgcmVqZWN0IGJhc2VkIG9uIHRoZSBmaXJzdFxuICogcmVzb2x2ZWQgb3IgcmVqZWN0ZWQgcHJvbWlzZS5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9XG4gKiBAcGFyYW0geyFBcnJheTxQcm9taXNlfCo+fSBwcm9taXNlc1xuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5Qcm9taXNlLnJhY2UgPSBmdW5jdGlvbihwcm9taXNlcykge1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb21pc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBDb25zdHJ1Y3Rvci5yZXNvbHZlKHByb21pc2VzW2ldKS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZX0gKi8ocHJvbWlzZSk7XG59O1xuXG52YXIgb25Qb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbiA9IGZ1bmN0aW9uKHJlYXNvbiwgcHJvbWlzZSkge1xuICB0aHJvdyByZWFzb247XG59O1xuXG4vKipcbiAqIEFuIGludGVybmFsIHVzZSBzdGF0aWMgZnVuY3Rpb24uXG4gKi9cblByb21pc2UuX292ZXJyaWRlVW5oYW5kbGVkRXhjZXB0aW9uSGFuZGxlciA9IGZ1bmN0aW9uKGhhbmRsZXIpIHtcbiAgb25Qb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbiA9IGhhbmRsZXI7XG59O1xuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICBQcml2YXRlIGZ1bmN0aW9uc1xuICoqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbi8qKlxuICogVGhlIEZ1bGZpbGxlZCBQcm9taXNlIHN0YXRlLiBDYWxscyBvbkZ1bGZpbGxlZCB3aXRoIHRoZSByZXNvbHZlZCB2YWx1ZSBvZlxuICogdGhpcyBwcm9taXNlLCBjcmVhdGluZyBhIG5ldyBwcm9taXNlLlxuICpcbiAqIElmIHRoZXJlIGlzIG5vIG9uRnVsZmlsbGVkLCByZXR1cm5zIHRoZSBjdXJyZW50IHByb21pc2UgdG8gYXZvaWQgYW4gcHJvbWlzZVxuICogaW5zdGFuY2UuXG4gKlxuICogQHRoaXMgeyFQcm9taXNlfSBUaGUgY3VycmVudCBwcm9taXNlXG4gKiBAcGFyYW0geyo9fSB2YWx1ZSBUaGUgY3VycmVudCBwcm9taXNlJ3MgcmVzb2x2ZWQgdmFsdWUuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IG9uRnVsZmlsbGVkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IHVudXNlZFxuICogQHBhcmFtIHtEZWZlcnJlZH0gZGVmZXJyZWQgQSBkZWZlcnJlZCBvYmplY3QgdGhhdCBob2xkcyBhIHByb21pc2UgYW5kIGl0c1xuICogICAgIHJlc29sdmUgYW5kIHJlamVjdCBmdW5jdGlvbnMuIEl0IElTIE5PVCBwYXNzZWQgd2hlbiBjYWxsZWQgZnJvbVxuICogICAgIFByb21pc2UjdGhlbiB0byBzYXZlIGFuIG9iamVjdCBpbnN0YW5jZSAoc2luY2Ugd2UgbWF5IHJldHVybiB0aGUgY3VycmVudFxuICogICAgIHByb21pc2UpLiBJdCBJUyBwYXNzZWQgaW4gd2hlbiBhZG9wdGluZyB0aGUgRnVsZmlsbGVkIHN0YXRlIGZyb20gdGhlXG4gKiAgICAgUGVuZGluZyBzdGF0ZS5cbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gRnVsZmlsbGVkUHJvbWlzZSh2YWx1ZSwgb25GdWxmaWxsZWQsIHVudXNlZCwgZGVmZXJyZWQpIHtcbiAgaWYgKCFvbkZ1bGZpbGxlZCkge1xuICAgIGRlZmVycmVkQWRvcHQoZGVmZXJyZWQsIEZ1bGZpbGxlZFByb21pc2UsIHZhbHVlKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBpZiAoIWRlZmVycmVkKSB7XG4gICAgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQodGhpcy5jb25zdHJ1Y3Rvcik7XG4gIH1cbiAgZGVmZXIodHJ5Q2F0Y2hEZWZlcnJlZChkZWZlcnJlZCwgb25GdWxmaWxsZWQsIHZhbHVlKSk7XG4gIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xufVxuXG4vKipcbiAqIFRoZSBSZWplY3RlZCBQcm9taXNlIHN0YXRlLiBDYWxscyBvblJlamVjdGVkIHdpdGggdGhlIHJlc29sdmVkIHZhbHVlIG9mXG4gKiB0aGlzIHByb21pc2UsIGNyZWF0aW5nIGEgbmV3IHByb21pc2UuXG4gKlxuICogSWYgdGhlcmUgaXMgbm8gb25SZWplY3RlZCwgcmV0dXJucyB0aGUgY3VycmVudCBwcm9taXNlIHRvIGF2b2lkIGFuIHByb21pc2VcbiAqIGluc3RhbmNlLlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX0gVGhlIGN1cnJlbnQgcHJvbWlzZVxuICogQHBhcmFtIHsqPX0gcmVhc29uIFRoZSBjdXJyZW50IHByb21pc2UncyByZWplY3Rpb24gcmVhc29uLlxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSB1bnVzZWRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0pPX0gb25SZWplY3RlZFxuICogQHBhcmFtIHtEZWZlcnJlZH0gZGVmZXJyZWQgQSBkZWZlcnJlZCBvYmplY3QgdGhhdCBob2xkcyBhIHByb21pc2UgYW5kIGl0c1xuICogICAgIHJlc29sdmUgYW5kIHJlamVjdCBmdW5jdGlvbnMuIEl0IElTIE5PVCBwYXNzZWQgd2hlbiBjYWxsZWQgZnJvbVxuICogICAgIFByb21pc2UjdGhlbiB0byBzYXZlIGFuIG9iamVjdCBpbnN0YW5jZSAoc2luY2Ugd2UgbWF5IHJldHVybiB0aGUgY3VycmVudFxuICogICAgIHByb21pc2UpLiBJdCBJUyBwYXNzZWQgaW4gd2hlbiBhZG9wdGluZyB0aGUgUmVqZWN0ZWQgc3RhdGUgZnJvbSB0aGVcbiAqICAgICBQZW5kaW5nIHN0YXRlLlxuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5mdW5jdGlvbiBSZWplY3RlZFByb21pc2UocmVhc29uLCB1bnVzZWQsIG9uUmVqZWN0ZWQsIGRlZmVycmVkKSB7XG4gIGlmICghb25SZWplY3RlZCkge1xuICAgIGRlZmVycmVkQWRvcHQoZGVmZXJyZWQsIFJlamVjdGVkUHJvbWlzZSwgcmVhc29uKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBpZiAoIWRlZmVycmVkKSB7XG4gICAgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQodGhpcy5jb25zdHJ1Y3Rvcik7XG4gIH1cbiAgZGVmZXIodHJ5Q2F0Y2hEZWZlcnJlZChkZWZlcnJlZCwgb25SZWplY3RlZCwgcmVhc29uKSk7XG4gIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xufVxuXG4vKipcbiAqIFRoZSBQZW5kaW5nIFByb21pc2Ugc3RhdGUuIEV2ZW50dWFsbHkgY2FsbHMgb25GdWxmaWxsZWQgb25jZSB0aGUgcHJvbWlzZSBoYXNcbiAqIHJlc29sdmVkLCBvciBvblJlamVjdGVkIG9uY2UgdGhlIHByb21pc2UgcmVqZWN0cy5cbiAqXG4gKiBJZiB0aGVyZSBpcyBubyBvbkZ1bGZpbGxlZCBhbmQgbm8gb25SZWplY3RlZCwgcmV0dXJucyB0aGUgY3VycmVudCBwcm9taXNlIHRvXG4gKiBhdm9pZCBhbiBwcm9taXNlIGluc3RhbmNlLlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX0gVGhlIGN1cnJlbnQgcHJvbWlzZVxuICogQHBhcmFtIHsqPX0gcXVldWUgVGhlIGN1cnJlbnQgcHJvbWlzZSdzIHBlbmRpbmcgcHJvbWlzZXMgcXVldWUuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IG9uRnVsZmlsbGVkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IG9uUmVqZWN0ZWRcbiAqIEBwYXJhbSB7RGVmZXJyZWR9IGRlZmVycmVkIEEgZGVmZXJyZWQgb2JqZWN0IHRoYXQgaG9sZHMgYSBwcm9taXNlIGFuZCBpdHNcbiAqICAgICByZXNvbHZlIGFuZCByZWplY3QgZnVuY3Rpb25zLiBJdCBJUyBOT1QgcGFzc2VkIHdoZW4gY2FsbGVkIGZyb21cbiAqICAgICBQcm9taXNlI3RoZW4gdG8gc2F2ZSBhbiBvYmplY3QgaW5zdGFuY2UgKHNpbmNlIHdlIG1heSByZXR1cm4gdGhlIGN1cnJlbnRcbiAqICAgICBwcm9taXNlKS4gSXQgSVMgcGFzc2VkIGluIHdoZW4gYWRvcHRpbmcgdGhlIFBlbmRpbmcgc3RhdGUgZnJvbSB0aGVcbiAqICAgICBQZW5kaW5nIHN0YXRlIG9mIGFub3RoZXIgcHJvbWlzZS5cbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gUGVuZGluZ1Byb21pc2UocXVldWUsIG9uRnVsZmlsbGVkLCBvblJlamVjdGVkLCBkZWZlcnJlZCkge1xuICBpZiAoIWRlZmVycmVkKSB7XG4gICAgaWYgKCFvbkZ1bGZpbGxlZCAmJiAhb25SZWplY3RlZCkgeyByZXR1cm4gdGhpczsgfVxuICAgIGRlZmVycmVkID0gbmV3IERlZmVycmVkKHRoaXMuY29uc3RydWN0b3IpO1xuICB9XG4gIHF1ZXVlLnB1c2goe1xuICAgIGRlZmVycmVkOiBkZWZlcnJlZCxcbiAgICBvbkZ1bGZpbGxlZDogb25GdWxmaWxsZWQgfHwgZGVmZXJyZWQucmVzb2x2ZSxcbiAgICBvblJlamVjdGVkOiBvblJlamVjdGVkIHx8IGRlZmVycmVkLnJlamVjdFxuICB9KTtcbiAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG59XG5cbi8qKlxuICogQ29uc3RydWN0cyBhIGRlZmVycmVkIGluc3RhbmNlIHRoYXQgaG9sZHMgYSBwcm9taXNlIGFuZCBpdHMgcmVzb2x2ZSBhbmRcbiAqIHJlamVjdCBmdW5jdGlvbnMuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIERlZmVycmVkKFByb21pc2UpIHtcbiAgdmFyIGRlZmVycmVkID0gdGhpcztcbiAgLyoqIEB0eXBlIHshUHJvbWlzZX0gKi9cbiAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgLyoqIEB0eXBlIHtmdW5jdGlvbigqPSl9ICovXG4gICAgZGVmZXJyZWQucmVzb2x2ZSA9IHJlc29sdmU7XG5cbiAgICAvKiogQHR5cGUge2Z1bmN0aW9uKCo9KX0gKi9cbiAgICBkZWZlcnJlZC5yZWplY3QgPSByZWplY3Q7XG4gIH0pO1xuICByZXR1cm4gZGVmZXJyZWQ7XG59XG5cbi8qKlxuICogVHJhbnNpdGlvbnMgdGhlIHN0YXRlIG9mIHByb21pc2UgdG8gYW5vdGhlciBzdGF0ZS4gVGhpcyBpcyBvbmx5IGV2ZXIgY2FsbGVkXG4gKiBvbiB3aXRoIGEgcHJvbWlzZSB0aGF0IGlzIGN1cnJlbnRseSBpbiB0aGUgUGVuZGluZyBzdGF0ZS5cbiAqXG4gKiBAcGFyYW0geyFQcm9taXNlfSBwcm9taXNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKHRoaXM6UHJvbWlzZSwqPSxmdW5jdGlvbigqPSksZnVuY3Rpb24oKj0pLERlZmVycmVkKTohUHJvbWlzZX0gc3RhdGVcbiAqIEBwYXJhbSB7Kj19IHZhbHVlXG4gKi9cbmZ1bmN0aW9uIGFkb3B0KHByb21pc2UsIHN0YXRlLCB2YWx1ZSwgYWRvcHRlZSkge1xuICB2YXIgcXVldWUgPSBwcm9taXNlLl92YWx1ZTtcbiAgcHJvbWlzZS5fc3RhdGUgPSBzdGF0ZTtcbiAgcHJvbWlzZS5fdmFsdWUgPSB2YWx1ZTtcblxuICBpZiAoYWRvcHRlZSAmJiBzdGF0ZSA9PT0gUGVuZGluZ1Byb21pc2UpIHtcbiAgICBhZG9wdGVlLl9zdGF0ZSh2YWx1ZSwgdm9pZCAwLCB2b2lkIDAsIHtcbiAgICAgIHByb21pc2U6IHByb21pc2UsXG4gICAgICByZXNvbHZlOiB2b2lkIDAsXG4gICAgICByZWplY3Q6IHZvaWQgMFxuICAgIH0pO1xuICB9XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWV1ZS5sZW5ndGg7IGkrKykge1xuICAgIHZhciBuZXh0ID0gcXVldWVbaV07XG4gICAgcHJvbWlzZS5fc3RhdGUoXG4gICAgICB2YWx1ZSxcbiAgICAgIG5leHQub25GdWxmaWxsZWQsXG4gICAgICBuZXh0Lm9uUmVqZWN0ZWQsXG4gICAgICBuZXh0LmRlZmVycmVkXG4gICAgKTtcbiAgfVxuICBxdWV1ZS5sZW5ndGggPSAwO1xuXG4gIC8vIERldGVybWluZSBpZiB0aGlzIHJlamVjdGVkIHByb21pc2Ugd2lsbCBiZSBcImhhbmRsZWRcIi5cbiAgaWYgKHN0YXRlID09PSBSZWplY3RlZFByb21pc2UgJiYgcHJvbWlzZS5faXNDaGFpbkVuZCkge1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBpZiAocHJvbWlzZS5faXNDaGFpbkVuZCkge1xuICAgICAgICBvblBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uKHZhbHVlLCBwcm9taXNlKTtcbiAgICAgIH1cbiAgICB9LCAwKTtcbiAgfVxufVxuXG4vKipcbiAqIEEgcGFydGlhbCBhcHBsaWNhdGlvbiBvZiBhZG9wdC5cbiAqXG4gKiBAcGFyYW0geyFQcm9taXNlfSBwcm9taXNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKHRoaXM6UHJvbWlzZSwqPSxmdW5jdGlvbigqPSksZnVuY3Rpb24oKj0pLERlZmVycmVkKTohUHJvbWlzZX0gc3RhdGVcbiAqIEByZXR1cm5zIHtmdW5jdGlvbigqPSl9XG4gKi9cbmZ1bmN0aW9uIGFkb3B0ZXIocHJvbWlzZSwgc3RhdGUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgYWRvcHQocHJvbWlzZSwgc3RhdGUsIHZhbHVlKTtcbiAgfTtcbn1cblxuLyoqXG4gKiBVcGRhdGVzIGEgZGVmZXJyZWQgcHJvbWlzZXMgc3RhdGUuIE5lY2Vzc2FyeSBmb3IgdXBkYXRpbmcgYW4gYWRvcHRpbmdcbiAqIHByb21pc2UncyBzdGF0ZSB3aGVuIHRoZSBhZG9wdGVlIHJlc29sdmVzLlxuICpcbiAqIEBwYXJhbSB7P0RlZmVycmVkfSBkZWZlcnJlZFxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlByb21pc2UsKj0sZnVuY3Rpb24oKj0pLGZ1bmN0aW9uKCo9KSxEZWZlcnJlZCk6IVByb21pc2V9IHN0YXRlXG4gKiBAcGFyYW0geyo9fSB2YWx1ZVxuICovXG5mdW5jdGlvbiBkZWZlcnJlZEFkb3B0KGRlZmVycmVkLCBzdGF0ZSwgdmFsdWUpIHtcbiAgaWYgKGRlZmVycmVkKSB7XG4gICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgIHByb21pc2UuX3N0YXRlID0gc3RhdGU7XG4gICAgcHJvbWlzZS5fdmFsdWUgPSB2YWx1ZTtcbiAgfVxufVxuXG4vKipcbiAqIEEgbm8tb3AgZnVuY3Rpb24gdG8gcHJldmVudCBkb3VibGUgcmVzb2x2aW5nLlxuICovXG5mdW5jdGlvbiBub29wKCkge31cblxuLyoqXG4gKiBUZXN0cyBpZiBmbiBpcyBhIEZ1bmN0aW9uXG4gKlxuICogQHBhcmFtIHsqfSBmblxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oZm4pIHtcbiAgcmV0dXJuIHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJztcbn1cblxuLyoqXG4gKiBUZXN0cyBpZiBmbiBpcyBhbiBPYmplY3RcbiAqXG4gKiBAcGFyYW0geyp9IG9ialxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzT2JqZWN0KG9iaikge1xuICByZXR1cm4gb2JqID09PSBPYmplY3Qob2JqKTtcbn1cblxuLyoqXG4gKiBJdGVyYXRlcyBvdmVyIGVhY2ggZWxlbWVudCBvZiBhbiBhcnJheSwgY2FsbGluZyB0aGUgaXRlcmF0b3Igd2l0aCB0aGVcbiAqIGVsZW1lbnQgYW5kIGl0cyBpbmRleC5cbiAqXG4gKiBAcGFyYW0geyFBcnJheX0gY29sbGVjdGlvblxuICogQHBhcmFtIHtmdW5jdGlvbigqPSxudW1iZXIpfSBpdGVyYXRvclxuICovXG5mdW5jdGlvbiBlYWNoKGNvbGxlY3Rpb24sIGl0ZXJhdG9yKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY29sbGVjdGlvbi5sZW5ndGg7IGkrKykge1xuICAgIGl0ZXJhdG9yKGNvbGxlY3Rpb25baV0sIGkpO1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBhdHRlbXB0IHRvIHJlc29sdmUgdGhlIGRlZmVycmVkIHdpdGggdGhlIHJldHVyblxuICogb2YgZm4uIElmIGFueSBlcnJvciBpcyByYWlzZWQsIHJlamVjdHMgaW5zdGVhZC5cbiAqXG4gKiBAcGFyYW0geyFEZWZlcnJlZH0gZGVmZXJyZWRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0pfSBmblxuICogQHBhcmFtIHsqfSBhcmdcbiAqIEByZXR1cm5zIHtmdW5jdGlvbigpfVxuICovXG5mdW5jdGlvbiB0cnlDYXRjaERlZmVycmVkKGRlZmVycmVkLCBmbiwgYXJnKSB7XG4gIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgdmFyIHJlc29sdmUgPSBkZWZlcnJlZC5yZXNvbHZlO1xuICB2YXIgcmVqZWN0ID0gZGVmZXJyZWQucmVqZWN0O1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciByZXN1bHQgPSBmbihhcmcpO1xuICAgICAgZG9SZXNvbHZlKHByb21pc2UsIHJlc29sdmUsIHJlamVjdCwgcmVzdWx0LCByZXN1bHQpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJlamVjdChlKTtcbiAgICB9XG4gIH07XG59XG5cbi8qKlxuICogUXVldWVzIGFuZCBleGVjdXRlcyBtdWx0aXBsZSBkZWZlcnJlZCBmdW5jdGlvbnMgb24gYW5vdGhlciBydW4gbG9vcC5cbiAqL1xudmFyIGRlZmVyID0gKGZ1bmN0aW9uKCkge1xuICAvKipcbiAgICogRGVmZXJzIGZuIHRvIGFub3RoZXIgcnVuIGxvb3AuXG4gICAqL1xuICB2YXIgc2NoZWR1bGVGbHVzaDtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5wb3N0TWVzc2FnZSkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZmx1c2gpO1xuICAgIHNjaGVkdWxlRmx1c2ggPSBmdW5jdGlvbigpIHtcbiAgICAgIHdpbmRvdy5wb3N0TWVzc2FnZSgnbWFjcm8tdGFzaycsICcqJyk7XG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBzY2hlZHVsZUZsdXNoID0gZnVuY3Rpb24oKSB7XG4gICAgICBzZXRUaW1lb3V0KGZsdXNoLCAwKTtcbiAgICB9O1xuICB9XG5cbiAgdmFyIHF1ZXVlID0gbmV3IEFycmF5KDE2KTtcbiAgdmFyIGxlbmd0aCA9IDA7XG5cbiAgZnVuY3Rpb24gZmx1c2goKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGZuID0gcXVldWVbaV07XG4gICAgICBxdWV1ZVtpXSA9IG51bGw7XG4gICAgICBmbigpO1xuICAgIH1cbiAgICBsZW5ndGggPSAwO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gZm5cbiAgICovXG4gIGZ1bmN0aW9uIGRlZmVyKGZuKSB7XG4gICAgaWYgKGxlbmd0aCA9PT0gMCkgeyBzY2hlZHVsZUZsdXNoKCk7IH1cbiAgICBxdWV1ZVtsZW5ndGgrK10gPSBmbjtcbiAgfVxuXG4gIHJldHVybiBkZWZlcjtcbn0pKCk7XG5cbi8qKlxuICogVGhlIFByb21pc2UgcmVzb2x1dGlvbiBwcm9jZWR1cmUuXG4gKiBodHRwczovL2dpdGh1Yi5jb20vcHJvbWlzZXMtYXBsdXMvcHJvbWlzZXMtc3BlYyN0aGUtcHJvbWlzZS1yZXNvbHV0aW9uLXByb2NlZHVyZVxuICpcbiAqIEBwYXJhbSB7IVByb21pc2V9IHByb21pc2VcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0pfSByZXNvbHZlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KX0gcmVqZWN0XG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcGFyYW0geyo9fSBjb250ZXh0XG4gKi9cbmZ1bmN0aW9uIGRvUmVzb2x2ZShwcm9taXNlLCByZXNvbHZlLCByZWplY3QsIHZhbHVlLCBjb250ZXh0KSB7XG4gIHZhciBfcmVqZWN0ID0gcmVqZWN0O1xuICB2YXIgdGhlbjtcbiAgdmFyIF9yZXNvbHZlO1xuICB0cnkge1xuICAgIGlmICh2YWx1ZSA9PT0gcHJvbWlzZSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGZ1bGZpbGwgcHJvbWlzZSB3aXRoIGl0c2VsZicpO1xuICAgIH1cbiAgICB2YXIgaXNPYmogPSBpc09iamVjdCh2YWx1ZSk7XG4gICAgaWYgKGlzT2JqICYmIHZhbHVlIGluc3RhbmNlb2YgcHJvbWlzZS5jb25zdHJ1Y3Rvcikge1xuICAgICAgYWRvcHQocHJvbWlzZSwgdmFsdWUuX3N0YXRlLCB2YWx1ZS5fdmFsdWUsIHZhbHVlKTtcbiAgICB9IGVsc2UgaWYgKGlzT2JqICYmICh0aGVuID0gdmFsdWUudGhlbikgJiYgaXNGdW5jdGlvbih0aGVuKSkge1xuICAgICAgX3Jlc29sdmUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBfcmVzb2x2ZSA9IF9yZWplY3QgPSBub29wO1xuICAgICAgICBkb1Jlc29sdmUocHJvbWlzZSwgcmVzb2x2ZSwgcmVqZWN0LCB2YWx1ZSwgdmFsdWUpO1xuICAgICAgfTtcbiAgICAgIF9yZWplY3QgPSBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgX3Jlc29sdmUgPSBfcmVqZWN0ID0gbm9vcDtcbiAgICAgICAgcmVqZWN0KHJlYXNvbik7XG4gICAgICB9O1xuICAgICAgdGhlbi5jYWxsKFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICBmdW5jdGlvbih2YWx1ZSkgeyBfcmVzb2x2ZSh2YWx1ZSk7IH0sXG4gICAgICAgIGZ1bmN0aW9uKHJlYXNvbikgeyBfcmVqZWN0KHJlYXNvbik7IH1cbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIF9yZWplY3QoZSk7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBQcm9taXNlO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7ZGV2fSBmcm9tICcuL2xvZyc7XG5pbXBvcnQge2RpY3R9IGZyb20gJy4vdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7aW50ZXJuYWxMaXN0ZW5JbXBsZW1lbnRhdGlvbn0gZnJvbSAnLi9ldmVudC1oZWxwZXItbGlzdGVuJztcbmltcG9ydCB7cGFyc2VKc29ufSBmcm9tICcuL2pzb24nO1xuXG5cbi8qKiBAY29uc3QgKi9cbmNvbnN0IEFNUF9NRVNTQUdFX1BSRUZJWCA9ICdhbXAtJztcbmV4cG9ydCBjb25zdCBDT05TVEFOVFMgPSB7XG4gIHJlc3BvbnNlVHlwZVN1ZmZpeDogJy1yZXN1bHQnLFxuICBtZXNzYWdlSWRGaWVsZE5hbWU6ICdtZXNzYWdlSWQnLFxuICBwYXlsb2FkRmllbGROYW1lOiAncGF5bG9hZCcsXG4gIGNvbnRlbnRGaWVsZE5hbWU6ICdjb250ZW50Jyxcbn07XG5cbi8qKiBAZW51bSB7c3RyaW5nfSAqL1xuZXhwb3J0IGNvbnN0IE1lc3NhZ2VUeXBlID0ge1xuICAvLyBGb3IgYW1wLWFkXG4gIFNFTkRfRU1CRURfU1RBVEU6ICdzZW5kLWVtYmVkLXN0YXRlJyxcbiAgRU1CRURfU1RBVEU6ICdlbWJlZC1zdGF0ZScsXG4gIFNFTkRfRU1CRURfQ09OVEVYVDogJ3NlbmQtZW1iZWQtY29udGV4dCcsXG4gIEVNQkVEX0NPTlRFWFQ6ICdlbWJlZC1jb250ZXh0JyxcbiAgU0VORF9JTlRFUlNFQ1RJT05TOiAnc2VuZC1pbnRlcnNlY3Rpb25zJyxcbiAgSU5URVJTRUNUSU9OOiAnaW50ZXJzZWN0aW9uJyxcbiAgRU1CRURfU0laRTogJ2VtYmVkLXNpemUnLFxuICBFTUJFRF9TSVpFX0NIQU5HRUQ6ICdlbWJlZC1zaXplLWNoYW5nZWQnLFxuICBFTUJFRF9TSVpFX0RFTklFRDogJ2VtYmVkLXNpemUtZGVuaWVkJyxcbiAgTk9fQ09OVEVOVDogJ25vLWNvbnRlbnQnLFxuICBHRVRfSFRNTDogJ2dldC1odG1sJyxcbiAgR0VUX0NPTlNFTlRfU1RBVEU6ICdnZXQtY29uc2VudC1zdGF0ZScsXG5cbiAgLy8gRm9yIHRoZSBmcmFtZSB0byBiZSBwbGFjZWQgaW4gZnVsbCBvdmVybGF5IG1vZGUgZm9yIGxpZ2h0Ym94ZXNcbiAgRlVMTF9PVkVSTEFZX0ZSQU1FOiAnZnVsbC1vdmVybGF5LWZyYW1lJyxcbiAgRlVMTF9PVkVSTEFZX0ZSQU1FX1JFU1BPTlNFOiAnZnVsbC1vdmVybGF5LWZyYW1lLXJlc3BvbnNlJyxcbiAgQ0FOQ0VMX0ZVTExfT1ZFUkxBWV9GUkFNRTogJ2NhbmNlbC1mdWxsLW92ZXJsYXktZnJhbWUnLFxuICBDQU5DRUxfRlVMTF9PVkVSTEFZX0ZSQU1FX1JFU1BPTlNFOiAnY2FuY2VsLWZ1bGwtb3ZlcmxheS1mcmFtZS1yZXNwb25zZScsXG5cbiAgLy8gRm9yIGFtcC1pbmFib3hcbiAgU0VORF9QT1NJVElPTlM6ICdzZW5kLXBvc2l0aW9ucycsXG4gIFBPU0lUSU9OOiAncG9zaXRpb24nLFxuXG4gIC8vIEZvciBhbXAtYW5hbHl0aWNzJyBpZnJhbWUtdHJhbnNwb3J0XG4gIFNFTkRfSUZSQU1FX1RSQU5TUE9SVF9FVkVOVFM6ICdzZW5kLWlmcmFtZS10cmFuc3BvcnQtZXZlbnRzJyxcbiAgSUZSQU1FX1RSQU5TUE9SVF9FVkVOVFM6ICdpZnJhbWUtdHJhbnNwb3J0LWV2ZW50cycsXG4gIElGUkFNRV9UUkFOU1BPUlRfUkVTUE9OU0U6ICdpZnJhbWUtdHJhbnNwb3J0LXJlc3BvbnNlJyxcblxuICAvLyBGb3IgdXNlci1lcnJvci1pbi1pZnJhbWVcbiAgVVNFUl9FUlJPUl9JTl9JRlJBTUU6ICd1c2VyLWVycm9yLWluLWlmcmFtZScsXG59O1xuXG4vKipcbiAqIExpc3RlbnMgZm9yIHRoZSBzcGVjaWZpZWQgZXZlbnQgb24gdGhlIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFdmVudFRhcmdldH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50VHlwZVxuICogQHBhcmFtIHtmdW5jdGlvbighRXZlbnQpfSBsaXN0ZW5lclxuICogQHBhcmFtIHtPYmplY3Q9fSBvcHRfZXZ0TGlzdGVuZXJPcHRzXG4gKiBAcmV0dXJuIHshVW5saXN0ZW5EZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW4oZWxlbWVudCwgZXZlbnRUeXBlLCBsaXN0ZW5lciwgb3B0X2V2dExpc3RlbmVyT3B0cykge1xuICByZXR1cm4gaW50ZXJuYWxMaXN0ZW5JbXBsZW1lbnRhdGlvbihcbiAgICAgIGVsZW1lbnQsIGV2ZW50VHlwZSwgbGlzdGVuZXIsIG9wdF9ldnRMaXN0ZW5lck9wdHMpO1xufVxuXG5cbi8qKlxuICogU2VyaWFsaXplIGFuIEFNUCBwb3N0IG1lc3NhZ2UuIE91dHB1dCBsb29rcyBsaWtlOlxuICogJ2FtcC0wMTE0ODEzMjMwOTk0OTB7XCJ0eXBlXCI6XCJwb3NpdGlvblwiLFwic2VudGluZWxcIjpcIjEyMzQ1XCIsXCJmb29cIjpcImJhclwifSdcbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlXG4gKiBAcGFyYW0ge3N0cmluZ30gc2VudGluZWxcbiAqIEBwYXJhbSB7SnNvbk9iamVjdD19IGRhdGFcbiAqIEBwYXJhbSB7P3N0cmluZz19IHJ0dlZlcnNpb25cbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNlcmlhbGl6ZU1lc3NhZ2UodHlwZSwgc2VudGluZWwsIGRhdGEgPSBkaWN0KCksXG4gIHJ0dlZlcnNpb24gPSBudWxsKSB7XG4gIC8vIFRPRE86IGNvbnNpZGVyIHdyYXAgdGhlIGRhdGEgaW4gYSBcImRhdGFcIiBmaWVsZC4geyB0eXBlLCBzZW50aW5hbCwgZGF0YSB9XG4gIGNvbnN0IG1lc3NhZ2UgPSBkYXRhO1xuICBtZXNzYWdlWyd0eXBlJ10gPSB0eXBlO1xuICBtZXNzYWdlWydzZW50aW5lbCddID0gc2VudGluZWw7XG4gIHJldHVybiBBTVBfTUVTU0FHRV9QUkVGSVggKyAocnR2VmVyc2lvbiB8fCAnJykgKyBKU09OLnN0cmluZ2lmeShtZXNzYWdlKTtcbn1cblxuXG4vKipcbiAqIERlc2VyaWFsaXplIGFuIEFNUCBwb3N0IG1lc3NhZ2UuXG4gKiBSZXR1cm5zIG51bGwgaWYgaXQncyBub3QgdmFsaWQgQU1QIG1lc3NhZ2UgZm9ybWF0LlxuICpcbiAqIEBwYXJhbSB7Kn0gbWVzc2FnZVxuICogQHJldHVybiB7P0pzb25PYmplY3R8dW5kZWZpbmVkfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVzZXJpYWxpemVNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgaWYgKCFpc0FtcE1lc3NhZ2UobWVzc2FnZSkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBzdGFydFBvcyA9IG1lc3NhZ2UuaW5kZXhPZigneycpO1xuICBkZXYoKS5hc3NlcnQoc3RhcnRQb3MgIT0gLTEsICdKU09OIG1pc3NpbmcgaW4gJXMnLCBtZXNzYWdlKTtcbiAgdHJ5IHtcbiAgICByZXR1cm4gcGFyc2VKc29uKG1lc3NhZ2Uuc3Vic3RyKHN0YXJ0UG9zKSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBkZXYoKS5lcnJvcignTUVTU0FHSU5HJywgJ0ZhaWxlZCB0byBwYXJzZSBtZXNzYWdlOiAnICsgbWVzc2FnZSwgZSk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuXG4vKipcbiAqICBSZXR1cm5zIHRydWUgaWYgbWVzc2FnZSBsb29rcyBsaWtlIGl0IGlzIGFuIEFNUCBwb3N0TWVzc2FnZVxuICogIEBwYXJhbSB7Kn0gbWVzc2FnZVxuICogIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0FtcE1lc3NhZ2UobWVzc2FnZSkge1xuICByZXR1cm4gKHR5cGVvZiBtZXNzYWdlID09ICdzdHJpbmcnICYmXG4gICAgICBtZXNzYWdlLmluZGV4T2YoQU1QX01FU1NBR0VfUFJFRklYKSA9PSAwICYmXG4gICAgICBtZXNzYWdlLmluZGV4T2YoJ3snKSAhPSAtMSk7XG59XG5cbi8qKiBAdHlwZWRlZiB7e2NyZWF0aXZlSWQ6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nfX0gKi9cbmV4cG9ydCBsZXQgSWZyYW1lVHJhbnNwb3J0RXZlbnQ7XG4vLyBBbiBldmVudCwgYW5kIHRoZSB0cmFuc3BvcnQgSUQgb2YgdGhlIGFtcC1hbmFseXRpY3MgdGFncyB0aGF0XG4vLyBnZW5lcmF0ZWQgaXQuIEZvciBpbnN0YW5jZSBpZiB0aGUgY3JlYXRpdmUgd2l0aCB0cmFuc3BvcnRcbi8vIElEIDIgc2VuZHMgXCJoaVwiLCB0aGVuIGFuIElmcmFtZVRyYW5zcG9ydEV2ZW50IHdvdWxkIGxvb2sgbGlrZTpcbi8vIHsgY3JlYXRpdmVJZDogXCIyXCIsIG1lc3NhZ2U6IFwiaGlcIiB9XG4vLyBJZiB0aGUgY3JlYXRpdmUgd2l0aCB0cmFuc3BvcnQgSUQgMiBzZW50IHRoYXQsIGFuZCBhbHNvIHNlbnQgXCJoZWxsb1wiLFxuLy8gYW5kIHRoZSBjcmVhdGl2ZSB3aXRoIHRyYW5zcG9ydCBJRCAzIHNlbmRzIFwiZ29vZGJ5ZVwiIHRoZW4gYW4gKmFycmF5KiBvZiAzXG4vLyBBbXBBbmFseXRpY3NJZnJhbWVUcmFuc3BvcnRFdmVudCB3b3VsZCBiZSBzZW50IHRvIHRoZSAzcCBmcmFtZSBsaWtlIHNvOlxuLy8gW1xuLy8gICB7IGNyZWF0aXZlSWQ6IFwiMlwiLCBtZXNzYWdlOiBcImhpXCIgfSwgLy8gQW4gQW1wQW5hbHl0aWNzSWZyYW1lVHJhbnNwb3J0RXZlbnRcbi8vICAgeyBjcmVhdGl2ZUlkOiBcIjJcIiwgbWVzc2FnZTogXCJoZWxsb1wiIH0sIC8vIEFub3RoZXJcbi8vICAgeyBjcmVhdGl2ZUlkOiBcIjNcIiwgbWVzc2FnZTogXCJnb29kYnllXCIgfSAvLyBBbmQgYW5vdGhlclxuLy8gXVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogS2V5IHN0cmluZyBpbiBhbiBhY3Rpb24gYXJndW1lbnRzIG1hcCBmb3IgYW4gdW5wYXJzZWQgb2JqZWN0IGxpdGVyYWwgc3RyaW5nLlxuICpcbiAqIEUuZy4gZm9yIHRoZSBhY3Rpb24gaW4gPHAgb249XCJ0YXA6QU1QLnNldFN0YXRlKHtmb286ICdiYXInfSlcIixcbiAqIHRoZW4gYGFyZ3NbUkFXX09CSkVDVF9BUkdTX0tFWV1gIGlzIHRoZSBzdHJpbmcgXCJ7Zm9vOiAnYmFyJ31cIi5cbiAqXG4gKiBUaGUgYWN0aW9uIHNlcnZpY2UgZGVsZWdhdGVzIHBhcnNpbmcgb2Ygb2JqZWN0IGxpdGVyYWxzIHRvIHRoZSBjb3JyZXNwb25kaW5nXG4gKiBleHRlbnNpb24gKGluIHRoZSBleGFtcGxlIGFib3ZlLCBhbXAtYmluZCkuXG4gKlxuICogQHNlZSAuL3NlcnZpY2UvYWN0aW9uLWltcGwuQWN0aW9uSW5mb0RlZlxuICogQGNvbnN0IHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBjb25zdCBSQVdfT0JKRUNUX0FSR1NfS0VZID0gJ19fQU1QX09CSkVDVF9TVFJJTkdfXyc7XG5cbi8qKlxuICogVHJ1c3QgbGV2ZWwgb2YgYW4gYWN0aW9uLlxuICpcbiAqIENvcnJlc3BvbmRzIHRvIGRlZ3JlZSBvZiB1c2VyIGludGVudCwgaS5lLiBldmVudHMgdHJpZ2dlcmVkIHdpdGggc3Ryb25nXG4gKiB1c2VyIGludGVudCBoYXZlIGhpZ2ggdHJ1c3QuXG4gKlxuICogQGVudW0ge251bWJlcn1cbiAqL1xuZXhwb3J0IGNvbnN0IEFjdGlvblRydXN0ID0ge1xuICBMT1c6IDEsXG4gIEhJR0g6IDEwMCxcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBBbGxvd3MgZm9yIHJ1bnRpbWUgY29uZmlndXJhdGlvbi4gSW50ZXJuYWxseSwgdGhlIHJ1bnRpbWUgc2hvdWxkXG4gKiB1c2UgdGhlIHNyYy9jb25maWcuanMgbW9kdWxlIGZvciB2YXJpb3VzIGNvbnN0YW50cy4gV2UgY2FuIHVzZSB0aGVcbiAqIEFNUF9DT05GSUcgZ2xvYmFsIHRvIHRyYW5zbGF0ZSB1c2VyLWRlZmluZWQgY29uZmlndXJhdGlvbnMgdG8gdGhpc1xuICogbW9kdWxlLlxuICogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fVxuICovXG5jb25zdCBlbnYgPSBzZWxmLkFNUF9DT05GSUcgfHwge307XG5cbmNvbnN0IHRoaXJkUGFydHlGcmFtZVJlZ2V4ID0gdHlwZW9mIGVudlsndGhpcmRQYXJ0eUZyYW1lUmVnZXgnXSA9PSAnc3RyaW5nJyA/XG4gIG5ldyBSZWdFeHAoZW52Wyd0aGlyZFBhcnR5RnJhbWVSZWdleCddKSA6IGVudlsndGhpcmRQYXJ0eUZyYW1lUmVnZXgnXTtcblxuY29uc3QgY2RuUHJveHlSZWdleCA9IHR5cGVvZiBlbnZbJ2NkblByb3h5UmVnZXgnXSA9PSAnc3RyaW5nJyA/XG4gIG5ldyBSZWdFeHAoZW52WydjZG5Qcm94eVJlZ2V4J10pIDogZW52WydjZG5Qcm94eVJlZ2V4J107XG5cbi8qKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsIHN0cmluZ3xib29sZWFufFJlZ0V4cD59ICovXG5leHBvcnQgY29uc3QgdXJscyA9IHtcbiAgdGhpcmRQYXJ0eTogZW52Wyd0aGlyZFBhcnR5VXJsJ10gfHwgJ2h0dHBzOi8vM3AuYW1wcHJvamVjdC5uZXQnLFxuICB0aGlyZFBhcnR5RnJhbWVIb3N0OiBlbnZbJ3RoaXJkUGFydHlGcmFtZUhvc3QnXSB8fCAnYW1wcHJvamVjdC5uZXQnLFxuICB0aGlyZFBhcnR5RnJhbWVSZWdleDogdGhpcmRQYXJ0eUZyYW1lUmVnZXggfHwgL15kLVxcZCtcXC5hbXBwcm9qZWN0XFwubmV0JC8sXG4gIGNkbjogZW52WydjZG5VcmwnXSB8fCAnaHR0cHM6Ly9jZG4uYW1wcHJvamVjdC5vcmcnLFxuICAvKiBOb3RlIHRoYXQgY2RuUHJveHlSZWdleCBpcyBvbmx5IGV2ZXIgY2hlY2tlZCBhZ2FpbnN0IG9yaWdpbnNcbiAgICogKHByb3RvOi8vaG9zdFs6cG9ydF0pIHNvIGRvZXMgbm90IG5lZWQgdG8gY29uc2lkZXIgcGF0aFxuICAgKi9cbiAgY2RuUHJveHlSZWdleDogY2RuUHJveHlSZWdleCB8fFxuICAgICAgL15odHRwczpcXC9cXC8oW2EtekEtWjAtOV8tXStcXC4pP2NkblxcLmFtcHByb2plY3RcXC5vcmckLyxcbiAgbG9jYWxob3N0UmVnZXg6IC9eaHR0cHM/OlxcL1xcL2xvY2FsaG9zdCg6XFxkKyk/JC8sXG4gIGVycm9yUmVwb3J0aW5nOiBlbnZbJ2Vycm9yUmVwb3J0aW5nVXJsJ10gfHxcbiAgICAgICdodHRwczovL2FtcC1lcnJvci1yZXBvcnRpbmcuYXBwc3BvdC5jb20vcicsXG4gIGxvY2FsRGV2OiBlbnZbJ2xvY2FsRGV2J10gfHwgZmFsc2UsXG59O1xuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICB1cmxzLFxufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2VuZHNXaXRofSBmcm9tICcuL3N0cmluZyc7XG5pbXBvcnQge1xuICBpc1Byb3h5T3JpZ2luLFxuICBwYXJzZVVybERlcHJlY2F0ZWQsXG4gIHRyeURlY29kZVVyaUNvbXBvbmVudCxcbn0gZnJvbSAnLi91cmwnO1xuaW1wb3J0IHt1cmxzfSBmcm9tICcuL2NvbmZpZyc7XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgY29va2llLiBUaGUgY29va2llIGFjY2VzcyBpcyByZXN0cmljdGVkIGFuZCBtdXN0XG4gKiBnbyB0aHJvdWdoIHRoZSBwcml2YWN5IHJldmlldy4gQmVmb3JlIHVzaW5nIHRoaXMgbWV0aG9kIHBsZWFzZSBmaWxlIGFcbiAqIEdpdEh1YiBpc3N1ZSB3aXRoIFwiUHJpdmFjeSBSZXZpZXdcIiBsYWJlbC5cbiAqXG4gKiBSZXR1cm5zIHRoZSBjb29raWUncyB2YWx1ZSBvciBgbnVsbGAuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gKiBAcmV0dXJuIHs/c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29va2llKHdpbiwgbmFtZSkge1xuICBjb25zdCBjb29raWVTdHJpbmcgPSB0cnlHZXREb2N1bWVudENvb2tpZU5vSW5saW5lKHdpbik7XG4gIGlmICghY29va2llU3RyaW5nKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgY29va2llcyA9IGNvb2tpZVN0cmluZy5zcGxpdCgnOycpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGNvb2tpZXMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBjb29raWUgPSBjb29raWVzW2ldLnRyaW0oKTtcbiAgICBjb25zdCBlcSA9IGNvb2tpZS5pbmRleE9mKCc9Jyk7XG4gICAgaWYgKGVxID09IC0xKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKHRyeURlY29kZVVyaUNvbXBvbmVudChjb29raWUuc3Vic3RyaW5nKDAsIGVxKS50cmltKCkpID09IG5hbWUpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gY29va2llLnN1YnN0cmluZyhlcSArIDEpLnRyaW0oKTtcbiAgICAgIHJldHVybiB0cnlEZWNvZGVVcmlDb21wb25lbnQodmFsdWUsIHZhbHVlKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogVGhpcyBtZXRob2Qgc2hvdWxkIG5vdCBiZSBpbmxpbmVkIHRvIHByZXZlbnQgVHJ5Q2F0Y2ggZGVvcHRpbWl6YXRpb24uXG4gKiBOb0lubGluZSBrZXl3b3JkIGF0IHRoZSBlbmQgb2YgZnVuY3Rpb24gbmFtZSBhbHNvIHByZXZlbnRzIENsb3N1cmUgY29tcGlsZXJcbiAqIGZyb20gaW5saW5pbmcgdGhlIGZ1bmN0aW9uLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gdHJ5R2V0RG9jdW1lbnRDb29raWVOb0lubGluZSh3aW4pIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gd2luLmRvY3VtZW50LmNvb2tpZTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIC8vIEFjdCBhcyBpZiBubyBjb29raWUgaXMgYXZhaWxhYmxlLiBFeGNlcHRpb25zIGNhbiBiZSB0aHJvd24gd2hlblxuICAgIC8vIEFNUCBkb2NzIGFyZSBvcGVuZWQgb24gb3JpZ2lucyB0aGF0IGRvIG5vdCBhbGxvdyBzZXR0aW5nXG4gICAgLy8gY29va2llcyBzdWNoIGFzIG51bGwgb3JpZ2lucy5cbiAgICByZXR1cm4gJyc7XG4gIH1cbn1cblxuLyoqXG4gKiBTZXRzIHRoZSB2YWx1ZSBvZiB0aGUgY29va2llLiBUaGUgY29va2llIGFjY2VzcyBpcyByZXN0cmljdGVkIGFuZCBtdXN0XG4gKiBnbyB0aHJvdWdoIHRoZSBwcml2YWN5IHJldmlldy4gQmVmb3JlIHVzaW5nIHRoaXMgbWV0aG9kIHBsZWFzZSBmaWxlIGFcbiAqIEdpdEh1YiBpc3N1ZSB3aXRoIFwiUHJpdmFjeSBSZXZpZXdcIiBsYWJlbC5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICogQHBhcmFtIHt0aW1lfSBleHBpcmF0aW9uVGltZVxuICogQHBhcmFtIHt7XG4gKiAgIGhpZ2hlc3RBdmFpbGFibGVEb21haW46KGJvb2xlYW58dW5kZWZpbmVkKSxcbiAqICAgZG9tYWluOihzdHJpbmd8dW5kZWZpbmVkKVxuICogfT19IG9wdF9vcHRpb25zXG4gKiAgICAgLSBoaWdoZXN0QXZhaWxhYmxlRG9tYWluOiBJZiB0cnVlLCBzZXQgdGhlIGNvb2tpZSBhdCB0aGUgd2lkZXN0IGRvbWFpblxuICogICAgICAgc2NvcGUgYWxsb3dlZCBieSB0aGUgYnJvd3Nlci4gRS5nLiBvbiBleGFtcGxlLmNvbSBpZiB3ZSBhcmUgY3VycmVudGx5XG4gKiAgICAgICBvbiB3d3cuZXhhbXBsZS5jb20uXG4gKiAgICAgLSBkb21haW46IEV4cGxpY2l0IGRvbWFpbiB0byBzZXQuXG4gKiAgICAgLSBhbGxvd09uUHJveHlPcmlnaW46IEFsbG93IHNldHRpbmcgYSBjb29raWUgb24gdGhlIEFNUCBDYWNoZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldENvb2tpZSh3aW4sIG5hbWUsIHZhbHVlLCBleHBpcmF0aW9uVGltZSwgb3B0X29wdGlvbnMpIHtcbiAgY2hlY2tPcmlnaW5Gb3JTZXR0aW5nQ29va2llKHdpbiwgb3B0X29wdGlvbnMsIG5hbWUpO1xuICBpZiAob3B0X29wdGlvbnMgJiYgb3B0X29wdGlvbnMuaGlnaGVzdEF2YWlsYWJsZURvbWFpbikge1xuICAgIGNvbnN0IHBhcnRzID0gd2luLmxvY2F0aW9uLmhvc3RuYW1lLnNwbGl0KCcuJyk7XG4gICAgbGV0IGRvbWFpbiA9IHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdO1xuICAgIGZvciAobGV0IGkgPSBwYXJ0cy5sZW5ndGggLSAyOyBpID49IDA7IGktLSkge1xuICAgICAgZG9tYWluID0gcGFydHNbaV0gKyAnLicgKyBkb21haW47XG4gICAgICB0cnlTZXRDb29raWUod2luLCBuYW1lLCB2YWx1ZSwgZXhwaXJhdGlvblRpbWUsIGRvbWFpbik7XG4gICAgICBpZiAoZ2V0Q29va2llKHdpbiwgbmFtZSkgPT0gdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBsZXQgZG9tYWluID0gdW5kZWZpbmVkO1xuICBpZiAob3B0X29wdGlvbnMgJiYgb3B0X29wdGlvbnMuZG9tYWluKSB7XG4gICAgZG9tYWluID0gb3B0X29wdGlvbnMuZG9tYWluO1xuICB9XG4gIHRyeVNldENvb2tpZSh3aW4sIG5hbWUsIHZhbHVlLCBleHBpcmF0aW9uVGltZSwgZG9tYWluKTtcbn1cblxuLyoqXG4gKiBBdHRlbXB0IHRvIHNldCBhIGNvb2tpZSB3aXRoIHRoZSBnaXZlbiBwYXJhbXMuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcbiAqIEBwYXJhbSB7dGltZX0gZXhwaXJhdGlvblRpbWVcbiAqIEBwYXJhbSB7c3RyaW5nfHVuZGVmaW5lZH0gZG9tYWluXG4gKi9cbmZ1bmN0aW9uIHRyeVNldENvb2tpZSh3aW4sIG5hbWUsIHZhbHVlLCBleHBpcmF0aW9uVGltZSwgZG9tYWluKSB7XG4gIC8vIFdlIGRvIG5vdCBhbGxvdyBzZXR0aW5nIGNvb2tpZXMgb24gdGhlIGRvbWFpbiB0aGF0IGNvbnRhaW5zIGJvdGhcbiAgLy8gdGhlIGNkbi4gYW5kIHd3dy4gaG9zdHMuXG4gIGlmIChkb21haW4gPT0gJ2FtcHByb2plY3Qub3JnJykge1xuICAgIC8vIEFjdGl2ZWx5IGRlbGV0ZSB0aGVtLlxuICAgIHZhbHVlID0gJ2RlbGV0ZSc7XG4gICAgZXhwaXJhdGlvblRpbWUgPSAwO1xuICB9XG4gIGNvbnN0IGNvb2tpZSA9IGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSArICc9JyArXG4gICAgICBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpICtcbiAgICAgICc7IHBhdGg9LycgK1xuICAgICAgKGRvbWFpbiA/ICc7IGRvbWFpbj0nICsgZG9tYWluIDogJycpICtcbiAgICAgICc7IGV4cGlyZXM9JyArIG5ldyBEYXRlKGV4cGlyYXRpb25UaW1lKS50b1VUQ1N0cmluZygpO1xuICB0cnkge1xuICAgIHdpbi5kb2N1bWVudC5jb29raWUgPSBjb29raWU7XG4gIH0gY2F0Y2ggKGlnbm9yZSkge1xuICAgIC8vIERvIG5vdCB0aHJvdyBpZiBzZXR0aW5nIHRoZSBjb29raWUgZmFpbGVkIEV4Y2VwdGlvbnMgY2FuIGJlIHRocm93blxuICAgIC8vIHdoZW4gQU1QIGRvY3MgYXJlIG9wZW5lZCBvbiBvcmlnaW5zIHRoYXQgZG8gbm90IGFsbG93IHNldHRpbmdcbiAgICAvLyBjb29raWVzIHN1Y2ggYXMgbnVsbCBvcmlnaW5zLlxuICB9XG59XG5cbi8qKlxuICogVGhyb3dzIGlmIGEgZ2l2ZW4gY29va2llIHNob3VsZCBub3QgYmUgc2V0IG9uIHRoZSBnaXZlbiBvcmlnaW4uXG4gKiBUaGlzIGlzIGEgZGVmZW5zZS1pbi1kZXB0aC4gQ2FsbGVycyBzaG91bGQgbmV2ZXIgcnVuIGludG8gdGhpcy5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshT2JqZWN0fHVuZGVmaW5lZH0gb3B0aW9uc1xuICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgRm9yIHRoZSBlcnJvciBtZXNzYWdlLlxuICovXG5mdW5jdGlvbiBjaGVja09yaWdpbkZvclNldHRpbmdDb29raWUod2luLCBvcHRpb25zLCBuYW1lKSB7XG4gIGlmIChvcHRpb25zICYmIG9wdGlvbnMuYWxsb3dPblByb3h5T3JpZ2luKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChpc1Byb3h5T3JpZ2luKHdpbi5sb2NhdGlvbi5ocmVmKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignU2hvdWxkIG5ldmVyIGF0dGVtcHQgdG8gc2V0IGNvb2tpZSBvbiBwcm94eSBvcmlnaW46ICdcbiAgICAgICAgKyBuYW1lKTtcbiAgfVxuXG4gIGNvbnN0IGN1cnJlbnQgPSBwYXJzZVVybERlcHJlY2F0ZWQod2luLmxvY2F0aW9uLmhyZWYpLmhvc3RuYW1lLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IHByb3h5ID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybHMuY2RuKS5ob3N0bmFtZS50b0xvd2VyQ2FzZSgpO1xuICBpZiAoY3VycmVudCA9PSBwcm94eSB8fCBlbmRzV2l0aChjdXJyZW50LCAnLicgKyBwcm94eSkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1Nob3VsZCBuZXZlciBhdHRlbXB0IHRvIHNldCBjb29raWUgb24gcHJveHkgb3JpZ2luLidcbiAgICAgICAgKyAnIChpbiBkZXB0aCBjaGVjayk6ICcgKyBuYW1lKTtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7RGVmZXJyZWR9IGZyb20gJy4vdXRpbHMvcHJvbWlzZSc7XG5pbXBvcnQge2Nzc0VzY2FwZX0gZnJvbSAnLi4vdGhpcmRfcGFydHkvY3NzLWVzY2FwZS9jc3MtZXNjYXBlJztcbmltcG9ydCB7ZGV2fSBmcm9tICcuL2xvZyc7XG5pbXBvcnQge2RpY3R9IGZyb20gJy4vdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7c3RhcnRzV2l0aH0gZnJvbSAnLi9zdHJpbmcnO1xuaW1wb3J0IHt0b1dpbn0gZnJvbSAnLi90eXBlcyc7XG5cbmNvbnN0IEhUTUxfRVNDQVBFX0NIQVJTID0ge1xuICAnJic6ICcmYW1wOycsXG4gICc8JzogJyZsdDsnLFxuICAnPic6ICcmZ3Q7JyxcbiAgJ1wiJzogJyZxdW90OycsXG4gIFwiJ1wiOiAnJiN4Mjc7JyxcbiAgJ2AnOiAnJiN4NjA7Jyxcbn07XG5jb25zdCBIVE1MX0VTQ0FQRV9SRUdFWCA9IC8oJnw8fD58XCJ8J3xgKS9nO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1BST01JU0UgPVxuICAgICdfX0FNUF9VUEdfUFJNJztcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuZXhwb3J0IGNvbnN0IFVQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9SRVNPTFZFUiA9XG4gICAgJ19fQU1QX1VQR19SRVMnO1xuXG4vKipcbiAqIFdhaXRzIHVudGlsIHRoZSBjaGlsZCBlbGVtZW50IGlzIGNvbnN0cnVjdGVkLiBPbmNlIHRoZSBjaGlsZCBpcyBmb3VuZCwgdGhlXG4gKiBjYWxsYmFjayBpcyBleGVjdXRlZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2hlY2tGdW5jXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGNhbGxiYWNrXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3YWl0Rm9yQ2hpbGQocGFyZW50LCBjaGVja0Z1bmMsIGNhbGxiYWNrKSB7XG4gIGlmIChjaGVja0Z1bmMocGFyZW50KSkge1xuICAgIGNhbGxiYWNrKCk7XG4gICAgcmV0dXJuO1xuICB9XG4gIC8qKiBAY29uc3QgeyFXaW5kb3d9ICovXG4gIGNvbnN0IHdpbiA9IHRvV2luKHBhcmVudC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3KTtcbiAgaWYgKHdpbi5NdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgLyoqIEBjb25zdCB7TXV0YXRpb25PYnNlcnZlcn0gKi9cbiAgICBjb25zdCBvYnNlcnZlciA9IG5ldyB3aW4uTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XG4gICAgICBpZiAoY2hlY2tGdW5jKHBhcmVudCkpIHtcbiAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIG9ic2VydmVyLm9ic2VydmUocGFyZW50LCB7Y2hpbGRMaXN0OiB0cnVlfSk7XG4gIH0gZWxzZSB7XG4gICAgLyoqIEBjb25zdCB7bnVtYmVyfSAqL1xuICAgIGNvbnN0IGludGVydmFsID0gd2luLnNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGlmIChjaGVja0Z1bmMocGFyZW50KSkge1xuICAgICAgICB3aW4uY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICB9XG4gICAgfSwgLyogbWlsbGlzZWNvbmRzICovIDUpO1xuICB9XG59XG5cbi8qKlxuICogV2FpdHMgdW50aWwgdGhlIGNoaWxkIGVsZW1lbnQgaXMgY29uc3RydWN0ZWQuIE9uY2UgdGhlIGNoaWxkIGlzIGZvdW5kLCB0aGVcbiAqIHByb21pc2UgaXMgcmVzb2x2ZWQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IGNoZWNrRnVuY1xuICogQHJldHVybiB7IVByb21pc2V9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3YWl0Rm9yQ2hpbGRQcm9taXNlKHBhcmVudCwgY2hlY2tGdW5jKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICB3YWl0Rm9yQ2hpbGQocGFyZW50LCBjaGVja0Z1bmMsIHJlc29sdmUpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBXYWl0cyBmb3IgZG9jdW1lbnQncyBib2R5IHRvIGJlIGF2YWlsYWJsZS5cbiAqIFdpbGwgYmUgZGVwcmVjYXRlZCBzb29uOyB1c2Uge0BsaW5rIEFtcERvYyN3aGVuQm9keUF2YWlsYWJsZX0gb3JcbiAqIEB7bGluayBEb2N1bWVudFN0YXRlI29uQm9keUF2YWlsYWJsZX0gaW5zdGVhZC5cbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2NcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gY2FsbGJhY2tcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JCb2R5KGRvYywgY2FsbGJhY2spIHtcbiAgd2FpdEZvckNoaWxkKGRvYy5kb2N1bWVudEVsZW1lbnQsICgpID0+ICEhZG9jLmJvZHksIGNhbGxiYWNrKTtcbn1cblxuXG4vKipcbiAqIFdhaXRzIGZvciBkb2N1bWVudCdzIGJvZHkgdG8gYmUgYXZhaWxhYmxlLlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHJldHVybiB7IVByb21pc2V9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3YWl0Rm9yQm9keVByb21pc2UoZG9jKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICB3YWl0Rm9yQm9keShkb2MsIHJlc29sdmUpO1xuICB9KTtcbn1cblxuXG4vKipcbiAqIFJlbW92ZXMgdGhlIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVFbGVtZW50KGVsZW1lbnQpIHtcbiAgaWYgKGVsZW1lbnQucGFyZW50RWxlbWVudCkge1xuICAgIGVsZW1lbnQucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChlbGVtZW50KTtcbiAgfVxufVxuXG5cbi8qKlxuICogUmVtb3ZlcyBhbGwgY2hpbGQgbm9kZXMgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50LlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVDaGlsZHJlbihwYXJlbnQpIHtcbiAgd2hpbGUgKHBhcmVudC5maXJzdENoaWxkKSB7XG4gICAgcGFyZW50LnJlbW92ZUNoaWxkKHBhcmVudC5maXJzdENoaWxkKTtcbiAgfVxufVxuXG5cbi8qKlxuICogQ29waWVzIGFsbCBjaGlsZHJlbiBub2RlcyBvZiBlbGVtZW50IFwiZnJvbVwiIHRvIGVsZW1lbnQgXCJ0b1wiLiBDaGlsZCBub2Rlc1xuICogYXJlIGRlZXBseSBjbG9uZWQuIE5vdGljZSwgdGhhdCB0aGlzIG1ldGhvZCBzaG91bGQgYmUgdXNlZCB3aXRoIGNhcmUgYW5kXG4gKiBwcmVmZXJhYmx5IG9uIHNtYWxsZXIgc3VidHJlZXMuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBmcm9tXG4gKiBAcGFyYW0geyFFbGVtZW50fCFEb2N1bWVudEZyYWdtZW50fSB0b1xuICovXG5leHBvcnQgZnVuY3Rpb24gY29weUNoaWxkcmVuKGZyb20sIHRvKSB7XG4gIGNvbnN0IGZyYWcgPSB0by5vd25lckRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgZm9yIChsZXQgbiA9IGZyb20uZmlyc3RDaGlsZDsgbjsgbiA9IG4ubmV4dFNpYmxpbmcpIHtcbiAgICBmcmFnLmFwcGVuZENoaWxkKG4uY2xvbmVOb2RlKHRydWUpKTtcbiAgfVxuICB0by5hcHBlbmRDaGlsZChmcmFnKTtcbn1cblxuLyoqXG4gKiBJbnNlcnQgdGhlIGVsZW1lbnQgaW4gdGhlIHJvb3QgYWZ0ZXIgdGhlIGVsZW1lbnQgbmFtZWQgYWZ0ZXIgb3JcbiAqIGlmIHRoYXQgaXMgbnVsbCBhdCB0aGUgYmVnaW5uaW5nLlxuICogQHBhcmFtIHshRWxlbWVudHwhU2hhZG93Um9vdH0gcm9vdFxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHs/Tm9kZX0gYWZ0ZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc2VydEFmdGVyT3JBdFN0YXJ0KHJvb3QsIGVsZW1lbnQsIGFmdGVyKSB7XG4gIGNvbnN0IGJlZm9yZSA9IGFmdGVyID8gYWZ0ZXIubmV4dFNpYmxpbmcgOiByb290LmZpcnN0Q2hpbGQ7XG4gIHJvb3QuaW5zZXJ0QmVmb3JlKGVsZW1lbnQsIGJlZm9yZSk7XG59XG5cbi8qKlxuICogQWRkIGF0dHJpYnV0ZXMgdG8gYW4gZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7IUpzb25PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBhdHRyaWJ1dGVzXG4gKiBAcmV0dXJuIHshRWxlbWVudH0gY3JlYXRlZCBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGRBdHRyaWJ1dGVzVG9FbGVtZW50KGVsZW1lbnQsIGF0dHJpYnV0ZXMpIHtcbiAgZm9yIChjb25zdCBhdHRyIGluIGF0dHJpYnV0ZXMpIHtcbiAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShhdHRyLCBhdHRyaWJ1dGVzW2F0dHJdKTtcbiAgfVxuICByZXR1cm4gZWxlbWVudDtcbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBuZXcgZWxlbWVudCBvbiBkb2N1bWVudCB3aXRoIHNwZWNpZmllZCB0YWdOYW1lIGFuZCBhdHRyaWJ1dGVzLlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWVcbiAqIEBwYXJhbSB7IUpzb25PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBhdHRyaWJ1dGVzXG4gKiBAcmV0dXJuIHshRWxlbWVudH0gY3JlYXRlZCBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFbGVtZW50V2l0aEF0dHJpYnV0ZXMoZG9jLCB0YWdOYW1lLCBhdHRyaWJ1dGVzKSB7XG4gIGNvbnN0IGVsZW1lbnQgPSBkb2MuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTtcbiAgcmV0dXJuIGFkZEF0dHJpYnV0ZXNUb0VsZW1lbnQoZWxlbWVudCwgYXR0cmlidXRlcyk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIG5vZGUgaXMgY29ubmVjdGVkIChhdHRhY2hlZCkuXG4gKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHNlZSBodHRwczovL2RvbS5zcGVjLndoYXR3Zy5vcmcvI2Nvbm5lY3RlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNDb25uZWN0ZWROb2RlKG5vZGUpIHtcbiAgY29uc3QgY29ubmVjdGVkID0gbm9kZS5pc0Nvbm5lY3RlZDtcbiAgaWYgKGNvbm5lY3RlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIGNvbm5lY3RlZDtcbiAgfVxuXG4gIC8vIFwiQW4gZWxlbWVudCBpcyBjb25uZWN0ZWQgaWYgaXRzIHNoYWRvdy1pbmNsdWRpbmcgcm9vdCBpcyBhIGRvY3VtZW50LlwiXG4gIGxldCBuID0gbm9kZTtcbiAgZG8ge1xuICAgIG4gPSByb290Tm9kZUZvcihuKTtcbiAgICBpZiAobi5ob3N0KSB7XG4gICAgICBuID0gbi5ob3N0O1xuICAgIH0gZWxzZSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH0gd2hpbGUgKHRydWUpO1xuICByZXR1cm4gbi5ub2RlVHlwZSA9PT0gTm9kZS5ET0NVTUVOVF9OT0RFO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHJvb3QgZm9yIGEgZ2l2ZW4gbm9kZS4gRG9lcyBub3QgY3Jvc3Mgc2hhZG93IERPTSBib3VuZGFyeS5cbiAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAqIEByZXR1cm4geyFOb2RlfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcm9vdE5vZGVGb3Iobm9kZSkge1xuICBpZiAoTm9kZS5wcm90b3R5cGUuZ2V0Um9vdE5vZGUpIHtcbiAgICAvLyBUeXBlIGNoZWNrZXIgc2F5cyBgZ2V0Um9vdE5vZGVgIG1heSByZXR1cm4gbnVsbC5cbiAgICByZXR1cm4gbm9kZS5nZXRSb290Tm9kZSgpIHx8IG5vZGU7XG4gIH1cbiAgbGV0IG47XG4gIGZvciAobiA9IG5vZGU7ICEhbi5wYXJlbnROb2RlOyBuID0gbi5wYXJlbnROb2RlKSB7fVxuICByZXR1cm4gbjtcbn1cblxuLyoqXG4gKiBGaW5kcyB0aGUgY2xvc2VzdCBlbGVtZW50IHRoYXQgc2F0aXNmaWVzIHRoZSBjYWxsYmFjayBmcm9tIHRoaXMgZWxlbWVudFxuICogdXAgdGhlIERPTSBzdWJ0cmVlLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7RWxlbWVudD19IG9wdF9zdG9wQXQgb3B0aW9uYWwgZWxlbW50IHRvIHN0b3AgdGhlIHNlYXJjaCBhdC5cbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VzdChlbGVtZW50LCBjYWxsYmFjaywgb3B0X3N0b3BBdCkge1xuICBmb3IgKGxldCBlbCA9IGVsZW1lbnQ7IGVsICYmIGVsICE9PSBvcHRfc3RvcEF0OyBlbCA9IGVsLnBhcmVudEVsZW1lbnQpIHtcbiAgICBpZiAoY2FsbGJhY2soZWwpKSB7XG4gICAgICByZXR1cm4gZWw7XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGNsb3Nlc3Qgbm9kZSB0aGF0IHNhdGlzZmllcyB0aGUgY2FsbGJhY2sgZnJvbSB0aGlzIG5vZGVcbiAqIHVwIHRoZSBET00gc3VidHJlZS5cbiAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIU5vZGUpOmJvb2xlYW59IGNhbGxiYWNrXG4gKiBAcmV0dXJuIHs/Tm9kZX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsb3Nlc3ROb2RlKG5vZGUsIGNhbGxiYWNrKSB7XG4gIGZvciAobGV0IG4gPSBub2RlOyBuOyBuID0gbi5wYXJlbnROb2RlKSB7XG4gICAgaWYgKGNhbGxiYWNrKG4pKSB7XG4gICAgICByZXR1cm4gbjtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgY2xvc2VzdCBlbGVtZW50IHdpdGggdGhlIHNwZWNpZmllZCBuYW1lIGZyb20gdGhpcyBlbGVtZW50XG4gKiB1cCB0aGUgRE9NIHN1YnRyZWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbG9zZXN0QnlUYWcoZWxlbWVudCwgdGFnTmFtZSkge1xuICBpZiAoZWxlbWVudC5jbG9zZXN0KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQuY2xvc2VzdCh0YWdOYW1lKTtcbiAgfVxuICB0YWdOYW1lID0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xuICByZXR1cm4gY2xvc2VzdChlbGVtZW50LCBlbCA9PiB7XG4gICAgcmV0dXJuIGVsLnRhZ05hbWUgPT0gdGFnTmFtZTtcbiAgfSk7XG59XG5cbi8qKlxuICogRmluZHMgdGhlIGNsb3Nlc3QgZWxlbWVudCB3aXRoIHRoZSBzcGVjaWZpZWQgc2VsZWN0b3IgZnJvbSB0aGlzIGVsZW1lbnRcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBzZWxlY3RvclxuICogQHJldHVybiB7P0VsZW1lbnR9IGNsb3Nlc3QgYW5jZXN0b3IgaWYgZm91bmQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbG9zZXN0QnlTZWxlY3RvcihlbGVtZW50LCBzZWxlY3Rvcikge1xuICBpZiAoZWxlbWVudC5jbG9zZXN0KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQuY2xvc2VzdChzZWxlY3Rvcik7XG4gIH1cblxuICByZXR1cm4gY2xvc2VzdChlbGVtZW50LCBlbCA9PiB7XG4gICAgcmV0dXJuIG1hdGNoZXMoZWwsIHNlbGVjdG9yKTtcbiAgfSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIHRoZSBnaXZlbiBlbGVtZW50IG1hdGNoZXMgdGhlIHNlbGVjdG9yXG4gKiBAcGFyYW0gIHshRWxlbWVudH0gZWwgVGhlIGVsZW1lbnQgdG8gdmVyaWZ5XG4gKiBAcGFyYW0gIHtzdHJpbmd9IHNlbGVjdG9yIFRoZSBzZWxlY3RvciB0byBjaGVjayBhZ2FpbnN0XG4gKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHRoZSBlbGVtZW50IG1hdGNoZWQgdGhlIHNlbGVjdG9yLiBGYWxzZSBvdGhlcndpc2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXRjaGVzKGVsLCBzZWxlY3Rvcikge1xuICBjb25zdCBtYXRjaGVyID0gZWwubWF0Y2hlcyB8fFxuICAgICAgZWwud2Via2l0TWF0Y2hlc1NlbGVjdG9yIHx8XG4gICAgICBlbC5tb3pNYXRjaGVzU2VsZWN0b3IgfHxcbiAgICAgIGVsLm1zTWF0Y2hlc1NlbGVjdG9yIHx8XG4gICAgICBlbC5vTWF0Y2hlc1NlbGVjdG9yO1xuICBpZiAobWF0Y2hlcikge1xuICAgIHJldHVybiBtYXRjaGVyLmNhbGwoZWwsIHNlbGVjdG9yKTtcbiAgfVxuICByZXR1cm4gZmFsc2U7IC8vIElFOCBhbHdheXMgcmV0dXJucyBmYWxzZS5cbn1cblxuLyoqXG4gKiBGaW5kcyB0aGUgZmlyc3QgZGVzY2VuZGFudCBlbGVtZW50IHdpdGggdGhlIHNwZWNpZmllZCBuYW1lLlxuICogQHBhcmFtIHshRWxlbWVudHwhRG9jdW1lbnR8IVNoYWRvd1Jvb3R9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVsZW1lbnRCeVRhZyhlbGVtZW50LCB0YWdOYW1lKSB7XG4gIGxldCBlbGVtZW50cztcbiAgLy8gZ2V0RWxlbWVudHNCeVRhZ05hbWUoKSBpcyBub3Qgc3VwcG9ydGVkIG9uIFNoYWRvd1Jvb3QuXG4gIGlmICh0eXBlb2YgZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGVsZW1lbnRzID0gZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWdOYW1lKTtcbiAgfSBlbHNlIHtcbiAgICBlbGVtZW50cyA9IGVsZW1lbnQuLypPSyovcXVlcnlTZWxlY3RvckFsbCh0YWdOYW1lKTtcbiAgfVxuICByZXR1cm4gKGVsZW1lbnRzICYmIGVsZW1lbnRzWzBdKSB8fCBudWxsO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGZpcnN0IGNoaWxkIGVsZW1lbnQgdGhhdCBzYXRpc2ZpZXMgdGhlIGNhbGxiYWNrLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjYWxsYmFja1xuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnQocGFyZW50LCBjYWxsYmFjaykge1xuICBmb3IgKGxldCBjaGlsZCA9IHBhcmVudC5maXJzdEVsZW1lbnRDaGlsZDsgY2hpbGQ7XG4gICAgY2hpbGQgPSBjaGlsZC5uZXh0RWxlbWVudFNpYmxpbmcpIHtcbiAgICBpZiAoY2FsbGJhY2soY2hpbGQpKSB7XG4gICAgICByZXR1cm4gY2hpbGQ7XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5cbi8qKlxuICogRmluZHMgYWxsIGNoaWxkIGVsZW1lbnRzIHRoYXQgc2F0aXNmeSB0aGUgY2FsbGJhY2suXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IGNhbGxiYWNrXG4gKiBAcmV0dXJuIHshQXJyYXk8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGRFbGVtZW50cyhwYXJlbnQsIGNhbGxiYWNrKSB7XG4gIGNvbnN0IGNoaWxkcmVuID0gW107XG4gIGZvciAobGV0IGNoaWxkID0gcGFyZW50LmZpcnN0RWxlbWVudENoaWxkOyBjaGlsZDtcbiAgICBjaGlsZCA9IGNoaWxkLm5leHRFbGVtZW50U2libGluZykge1xuICAgIGlmIChjYWxsYmFjayhjaGlsZCkpIHtcbiAgICAgIGNoaWxkcmVuLnB1c2goY2hpbGQpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gY2hpbGRyZW47XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgbGFzdCBjaGlsZCBlbGVtZW50IHRoYXQgc2F0aXNmaWVzIHRoZSBjYWxsYmFjay5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGFzdENoaWxkRWxlbWVudChwYXJlbnQsIGNhbGxiYWNrKSB7XG4gIGZvciAobGV0IGNoaWxkID0gcGFyZW50Lmxhc3RFbGVtZW50Q2hpbGQ7IGNoaWxkO1xuICAgIGNoaWxkID0gY2hpbGQucHJldmlvdXNFbGVtZW50U2libGluZykge1xuICAgIGlmIChjYWxsYmFjayhjaGlsZCkpIHtcbiAgICAgIHJldHVybiBjaGlsZDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogRmluZHMgYWxsIGNoaWxkIG5vZGVzIHRoYXQgc2F0aXNmeSB0aGUgY2FsbGJhY2suXG4gKiBUaGVzZSBub2RlcyBjYW4gaW5jbHVkZSBUZXh0LCBDb21tZW50IGFuZCBvdGhlciBjaGlsZCBub2Rlcy5cbiAqIEBwYXJhbSB7IU5vZGV9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighTm9kZSk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEByZXR1cm4geyFBcnJheTwhTm9kZT59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZE5vZGVzKHBhcmVudCwgY2FsbGJhY2spIHtcbiAgY29uc3Qgbm9kZXMgPSBbXTtcbiAgZm9yIChsZXQgY2hpbGQgPSBwYXJlbnQuZmlyc3RDaGlsZDsgY2hpbGQ7XG4gICAgY2hpbGQgPSBjaGlsZC5uZXh0U2libGluZykge1xuICAgIGlmIChjYWxsYmFjayhjaGlsZCkpIHtcbiAgICAgIG5vZGVzLnB1c2goY2hpbGQpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbm9kZXM7XG59XG5cbi8qKlxuICogQHR5cGUge2Jvb2xlYW58dW5kZWZpbmVkfVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmxldCBzY29wZVNlbGVjdG9yU3VwcG9ydGVkO1xuXG4vKipcbiAqIEBwYXJhbSB7Ym9vbGVhbnx1bmRlZmluZWR9IHZhbFxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRTY29wZVNlbGVjdG9yU3VwcG9ydGVkRm9yVGVzdGluZyh2YWwpIHtcbiAgc2NvcGVTZWxlY3RvclN1cHBvcnRlZCA9IHZhbDtcbn1cblxuLyoqXG4gKiBUZXN0IHRoYXQgdGhlIDpzY29wZSBzZWxlY3RvciBpcyBzdXBwb3J0ZWQgYW5kIGJlaGF2ZXMgY29ycmVjdGx5LlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc1Njb3BlU2VsZWN0b3JTdXBwb3J0ZWQocGFyZW50KSB7XG4gIGNvbnN0IGRvYyA9IHBhcmVudC5vd25lckRvY3VtZW50O1xuICB0cnkge1xuICAgIGNvbnN0IHRlc3RFbGVtZW50ID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnN0IHRlc3RDaGlsZCA9IGRvYy5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0ZXN0RWxlbWVudC5hcHBlbmRDaGlsZCh0ZXN0Q2hpbGQpO1xuICAgIC8vIE5PVEUoY3ZpYWxpeiwgIzEyMzgzKTogRmlyZWZveCdzIGltcGxlbWVudGF0aW9uIGlzIGluY29tcGxldGUsXG4gICAgLy8gdGhlcmVmb3JlIHdlIHRlc3QgYWN0dWFsIGZ1bmN0aW9uYWxpdHkgb2ZgOnNjb3BlYCBhcyB3ZWxsLlxuICAgIHJldHVybiB0ZXN0RWxlbWVudC4vKk9LKi9xdWVyeVNlbGVjdG9yKCc6c2NvcGUgZGl2JykgPT09IHRlc3RDaGlsZDtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vKipcbiAqIEZpbmRzIHRoZSBmaXJzdCBjaGlsZCBlbGVtZW50IHRoYXQgaGFzIHRoZSBzcGVjaWZpZWQgYXR0cmlidXRlLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gYXR0clxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnRCeUF0dHIocGFyZW50LCBhdHRyKSB7XG4gIHJldHVybiBzY29wZWRRdWVyeVNlbGVjdG9yLypPSyovKHBhcmVudCwgYD4gWyR7YXR0cn1dYCk7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgbGFzdCBjaGlsZCBlbGVtZW50IHRoYXQgaGFzIHRoZSBzcGVjaWZpZWQgYXR0cmlidXRlLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gYXR0clxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXN0Q2hpbGRFbGVtZW50QnlBdHRyKHBhcmVudCwgYXR0cikge1xuICByZXR1cm4gbGFzdENoaWxkRWxlbWVudChwYXJlbnQsIGVsID0+IHtcbiAgICByZXR1cm4gZWwuaGFzQXR0cmlidXRlKGF0dHIpO1xuICB9KTtcbn1cblxuXG4vKipcbiAqIEZpbmRzIGFsbCBjaGlsZCBlbGVtZW50cyB0aGF0IGhhcyB0aGUgc3BlY2lmaWVkIGF0dHJpYnV0ZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtzdHJpbmd9IGF0dHJcbiAqIEByZXR1cm4geyFOb2RlTGlzdDwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnRzQnlBdHRyKHBhcmVudCwgYXR0cikge1xuICByZXR1cm4gc2NvcGVkUXVlcnlTZWxlY3RvckFsbC8qT0sqLyhwYXJlbnQsIGA+IFske2F0dHJ9XWApO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGZpcnN0IGNoaWxkIGVsZW1lbnQgdGhhdCBoYXMgdGhlIHNwZWNpZmllZCB0YWcgbmFtZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWVcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGRFbGVtZW50QnlUYWcocGFyZW50LCB0YWdOYW1lKSB7XG4gIHJldHVybiBzY29wZWRRdWVyeVNlbGVjdG9yLypPSyovKHBhcmVudCwgYD4gJHt0YWdOYW1lfWApO1xufVxuXG5cbi8qKlxuICogRmluZHMgYWxsIGNoaWxkIGVsZW1lbnRzIHdpdGggdGhlIHNwZWNpZmllZCB0YWcgbmFtZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWVcbiAqIEByZXR1cm4geyFOb2RlTGlzdDwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnRzQnlUYWcocGFyZW50LCB0YWdOYW1lKSB7XG4gIHJldHVybiBzY29wZWRRdWVyeVNlbGVjdG9yQWxsLypPSyovKHBhcmVudCwgYD4gJHt0YWdOYW1lfWApO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGZpcnN0IGVsZW1lbnQgdGhhdCBtYXRjaGVzIGBzZWxlY3RvcmAsIHNjb3BlZCBpbnNpZGUgYHJvb3RgLlxuICogTm90ZTogaW4gSUUsIHRoaXMgY2F1c2VzIGEgcXVpY2sgbXV0YXRpb24gb2YgdGhlIGVsZW1lbnQncyBjbGFzcyBsaXN0LlxuICogQHBhcmFtIHshRWxlbWVudH0gcm9vdFxuICogQHBhcmFtIHtzdHJpbmd9IHNlbGVjdG9yXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNjb3BlZFF1ZXJ5U2VsZWN0b3Iocm9vdCwgc2VsZWN0b3IpIHtcbiAgaWYgKHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQgPT0gbnVsbCkge1xuICAgIHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQgPSBpc1Njb3BlU2VsZWN0b3JTdXBwb3J0ZWQocm9vdCk7XG4gIH1cbiAgaWYgKHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQpIHtcbiAgICByZXR1cm4gcm9vdC4vKk9LKi9xdWVyeVNlbGVjdG9yKGA6c2NvcGUgJHtzZWxlY3Rvcn1gKTtcbiAgfVxuXG4gIC8vIE9ubHkgSUUuXG4gIGNvbnN0IHVuaXF1ZSA9ICdpLWFtcGh0bWwtc2NvcGVkJztcbiAgcm9vdC5jbGFzc0xpc3QuYWRkKHVuaXF1ZSk7XG4gIGNvbnN0IGVsZW1lbnQgPSByb290Li8qT0sqL3F1ZXJ5U2VsZWN0b3IoYC4ke3VuaXF1ZX0gJHtzZWxlY3Rvcn1gKTtcbiAgcm9vdC5jbGFzc0xpc3QucmVtb3ZlKHVuaXF1ZSk7XG4gIHJldHVybiBlbGVtZW50O1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGV2ZXJ5IGVsZW1lbnQgdGhhdCBtYXRjaGVzIGBzZWxlY3RvcmAsIHNjb3BlZCBpbnNpZGUgYHJvb3RgLlxuICogTm90ZTogaW4gSUUsIHRoaXMgY2F1c2VzIGEgcXVpY2sgbXV0YXRpb24gb2YgdGhlIGVsZW1lbnQncyBjbGFzcyBsaXN0LlxuICogQHBhcmFtIHshRWxlbWVudH0gcm9vdFxuICogQHBhcmFtIHtzdHJpbmd9IHNlbGVjdG9yXG4gKiBAcmV0dXJuIHshTm9kZUxpc3Q8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2NvcGVkUXVlcnlTZWxlY3RvckFsbChyb290LCBzZWxlY3Rvcikge1xuICBpZiAoc2NvcGVTZWxlY3RvclN1cHBvcnRlZCA9PSBudWxsKSB7XG4gICAgc2NvcGVTZWxlY3RvclN1cHBvcnRlZCA9IGlzU2NvcGVTZWxlY3RvclN1cHBvcnRlZChyb290KTtcbiAgfVxuICBpZiAoc2NvcGVTZWxlY3RvclN1cHBvcnRlZCkge1xuICAgIHJldHVybiByb290Li8qT0sqL3F1ZXJ5U2VsZWN0b3JBbGwoYDpzY29wZSAke3NlbGVjdG9yfWApO1xuICB9XG5cbiAgLy8gT25seSBJRS5cbiAgY29uc3QgdW5pcXVlID0gJ2ktYW1waHRtbC1zY29wZWQnO1xuICByb290LmNsYXNzTGlzdC5hZGQodW5pcXVlKTtcbiAgY29uc3QgZWxlbWVudHMgPSByb290Li8qT0sqL3F1ZXJ5U2VsZWN0b3JBbGwoYC4ke3VuaXF1ZX0gJHtzZWxlY3Rvcn1gKTtcbiAgcm9vdC5jbGFzc0xpc3QucmVtb3ZlKHVuaXF1ZSk7XG4gIHJldHVybiBlbGVtZW50cztcbn1cblxuXG4vKipcbiAqIFJldHVybnMgZWxlbWVudCBkYXRhLXBhcmFtLSBhdHRyaWJ1dGVzIGFzIHVybCBwYXJhbWV0ZXJzIGtleS12YWx1ZSBwYWlycy5cbiAqIGUuZy4gZGF0YS1wYXJhbS1zb21lLWF0dHI9dmFsdWUgLT4ge3NvbWVBdHRyOiB2YWx1ZX0uXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKHN0cmluZyk6c3RyaW5nPX0gb3B0X2NvbXB1dGVQYXJhbU5hbWVGdW5jIHRvIGNvbXB1dGUgdGhlXG4gKiAgICBwYXJhbWV0ZXIgbmFtZSwgZ2V0IHBhc3NlZCB0aGUgY2FtZWwtY2FzZSBwYXJhbWV0ZXIgbmFtZS5cbiAqIEBwYXJhbSB7IVJlZ0V4cD19IG9wdF9wYXJhbVBhdHRlcm4gUmVnZXggcGF0dGVybiB0byBtYXRjaCBkYXRhIGF0dHJpYnV0ZXMuXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldERhdGFQYXJhbXNGcm9tQXR0cmlidXRlcyhlbGVtZW50LCBvcHRfY29tcHV0ZVBhcmFtTmFtZUZ1bmMsXG4gIG9wdF9wYXJhbVBhdHRlcm4pIHtcbiAgY29uc3QgY29tcHV0ZVBhcmFtTmFtZUZ1bmMgPSBvcHRfY29tcHV0ZVBhcmFtTmFtZUZ1bmMgfHwgKGtleSA9PiBrZXkpO1xuICBjb25zdCB7ZGF0YXNldH0gPSBlbGVtZW50O1xuICBjb25zdCBwYXJhbXMgPSBkaWN0KCk7XG4gIGNvbnN0IHBhcmFtUGF0dGVybiA9IG9wdF9wYXJhbVBhdHRlcm4gPyBvcHRfcGFyYW1QYXR0ZXJuIDogL15wYXJhbSguKykvO1xuICBmb3IgKGNvbnN0IGtleSBpbiBkYXRhc2V0KSB7XG4gICAgY29uc3QgbWF0Y2hlcyA9IGtleS5tYXRjaChwYXJhbVBhdHRlcm4pO1xuICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICBjb25zdCBwYXJhbSA9IG1hdGNoZXNbMV1bMF0udG9Mb3dlckNhc2UoKSArIG1hdGNoZXNbMV0uc3Vic3RyKDEpO1xuICAgICAgcGFyYW1zW2NvbXB1dGVQYXJhbU5hbWVGdW5jKHBhcmFtKV0gPSBkYXRhc2V0W2tleV07XG4gICAgfVxuICB9XG4gIHJldHVybiBwYXJhbXM7XG59XG5cbi8qKlxuICogV2hldGhlciB0aGUgZWxlbWVudCBoYXZlIGEgbmV4dCBub2RlIGluIHRoZSBkb2N1bWVudCBvcmRlci5cbiAqIFRoaXMgbWVhbnMgZWl0aGVyOlxuICogIGEuIFRoZSBlbGVtZW50IGl0c2VsZiBoYXMgYSBuZXh0U2libGluZy5cbiAqICBiLiBBbnkgb2YgdGhlIGVsZW1lbnQgYW5jZXN0b3JzIGhhcyBhIG5leHRTaWJsaW5nLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHs/Tm9kZX0gb3B0X3N0b3BOb2RlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzTmV4dE5vZGVJbkRvY3VtZW50T3JkZXIoZWxlbWVudCwgb3B0X3N0b3BOb2RlKSB7XG4gIGxldCBjdXJyZW50RWxlbWVudCA9IGVsZW1lbnQ7XG4gIGRvIHtcbiAgICBpZiAoY3VycmVudEVsZW1lbnQubmV4dFNpYmxpbmcpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfSB3aGlsZSAoKGN1cnJlbnRFbGVtZW50ID0gY3VycmVudEVsZW1lbnQucGFyZW50Tm9kZSkgJiZcbiAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50ICE9IG9wdF9zdG9wTm9kZSk7XG4gIHJldHVybiBmYWxzZTtcbn1cblxuXG4vKipcbiAqIEZpbmRzIGFsbCBhbmNlc3RvciBlbGVtZW50cyB0aGF0IHNhdGlzZnkgcHJlZGljYXRlLlxuICogQHBhcmFtIHshRWxlbWVudH0gY2hpbGRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IHByZWRpY2F0ZVxuICogQHJldHVybiB7IUFycmF5PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFuY2VzdG9yRWxlbWVudHMoY2hpbGQsIHByZWRpY2F0ZSkge1xuICBjb25zdCBhbmNlc3RvcnMgPSBbXTtcbiAgZm9yIChsZXQgYW5jZXN0b3IgPSBjaGlsZC5wYXJlbnRFbGVtZW50OyBhbmNlc3RvcjtcbiAgICBhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudEVsZW1lbnQpIHtcbiAgICBpZiAocHJlZGljYXRlKGFuY2VzdG9yKSkge1xuICAgICAgYW5jZXN0b3JzLnB1c2goYW5jZXN0b3IpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gYW5jZXN0b3JzO1xufVxuXG5cbi8qKlxuICogRmluZHMgYWxsIGFuY2VzdG9yIGVsZW1lbnRzIHRoYXQgaGFzIHRoZSBzcGVjaWZpZWQgdGFnIG5hbWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBjaGlsZFxuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWVcbiAqIEByZXR1cm4geyFBcnJheTwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhbmNlc3RvckVsZW1lbnRzQnlUYWcoY2hpbGQsIHRhZ05hbWUpIHtcbiAgdGFnTmFtZSA9IHRhZ05hbWUudG9VcHBlckNhc2UoKTtcbiAgcmV0dXJuIGFuY2VzdG9yRWxlbWVudHMoY2hpbGQsIGVsID0+IHtcbiAgICByZXR1cm4gZWwudGFnTmFtZSA9PSB0YWdOYW1lO1xuICB9KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgY2xvbmUgb2YgdGhlIGNvbnRlbnQgb2YgYSB0ZW1wbGF0ZSBlbGVtZW50LlxuICpcbiAqIFBvbHlmaWxsIHRvIHJlcGxhY2UgLmNvbnRlbnQgYWNjZXNzIGZvciBicm93c2VycyB0aGF0IGRvIG5vdCBzdXBwb3J0XG4gKiBIVE1MVGVtcGxhdGVFbGVtZW50cyBuYXRpdmVseS5cbiAqXG4gKiBAcGFyYW0geyFIVE1MVGVtcGxhdGVFbGVtZW50fCFFbGVtZW50fSB0ZW1wbGF0ZVxuICogQHJldHVybiB7IURvY3VtZW50RnJhZ21lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0ZW1wbGF0ZUNvbnRlbnRDbG9uZSh0ZW1wbGF0ZSkge1xuICBpZiAoJ2NvbnRlbnQnIGluIHRlbXBsYXRlKSB7XG4gICAgcmV0dXJuIHRlbXBsYXRlLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGNvbnRlbnQgPSB0ZW1wbGF0ZS5vd25lckRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICBjb3B5Q2hpbGRyZW4odGVtcGxhdGUsIGNvbnRlbnQpO1xuICAgIHJldHVybiBjb250ZW50O1xuICB9XG59XG5cbi8qKlxuICogSXRlcmF0ZSBvdmVyIGFuIGFycmF5LWxpa2UuIFNvbWUgY29sbGVjdGlvbnMgbGlrZSBOb2RlTGlzdCBhcmVcbiAqIGxhemlseSBldmFsdWF0ZWQgaW4gc29tZSBicm93c2VycywgYW5kIGFjY2Vzc2luZyBgbGVuZ3RoYCBmb3JjZXMgZnVsbFxuICogZXZhbHVhdGlvbi4gV2UgY2FuIGltcHJvdmUgcGVyZm9ybWFuY2UgYnkgaXRlcmF0aW5nIHVudGlsIGFuIGVsZW1lbnQgaXNcbiAqIGB1bmRlZmluZWRgIHRvIGF2b2lkIGNoZWNraW5nIHRoZSBgbGVuZ3RoYCBwcm9wZXJ0eS5cbiAqIFRlc3QgY2FzZXM6IGh0dHBzOi8vanNwZXJmLmNvbS9pdGVyYXRpbmctb3Zlci1jb2xsZWN0aW9ucy1vZi1lbGVtZW50c1xuICogQHBhcmFtIHshSUFycmF5TGlrZTxUPn0gaXRlcmFibGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oVCwgbnVtYmVyKX0gY2JcbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpdGVyYXRlQ3Vyc29yKGl0ZXJhYmxlLCBjYikge1xuICBmb3IgKGxldCBpID0gMCwgdmFsdWU7ICh2YWx1ZSA9IGl0ZXJhYmxlW2ldKSAhPT0gdW5kZWZpbmVkOyBpKyspIHtcbiAgICBjYih2YWx1ZSwgaSk7XG4gIH1cbn1cblxuLyoqXG4gKiBUaGlzIG1ldGhvZCB3cmFwcyBhcm91bmQgd2luZG93J3Mgb3BlbiBtZXRob2QuIEl0IGZpcnN0IHRyaWVzIHRvIGV4ZWN1dGVcbiAqIGBvcGVuYCBjYWxsIHdpdGggdGhlIHByb3ZpZGVkIHRhcmdldCBhbmQgaWYgaXQgZmFpbHMsIGl0IHJldHJpZXMgdGhlIGNhbGxcbiAqIHdpdGggdGhlIGBfdG9wYCB0YXJnZXQuIFRoaXMgaXMgbmVjZXNzYXJ5IGdpdmVuIHRoYXQgaW4gc29tZSBlbWJlZGRpbmdcbiAqIHNjZW5hcmlvcywgc3VjaCBhcyBpT1MnIFdLV2ViVmlldywgbmF2aWdhdGlvbiB0byBgX2JsYW5rYCBhbmQgb3RoZXIgdGFyZ2V0c1xuICogaXMgYmxvY2tlZCBieSBkZWZhdWx0LlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFyZ2V0XG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF9mZWF0dXJlc1xuICogQHJldHVybiB7P1dpbmRvd31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9wZW5XaW5kb3dEaWFsb2cod2luLCB1cmwsIHRhcmdldCwgb3B0X2ZlYXR1cmVzKSB7XG4gIC8vIFRyeSBmaXJzdCB3aXRoIHRoZSBzcGVjaWZpZWQgdGFyZ2V0LiBJZiB3ZSdyZSBpbnNpZGUgdGhlIFdLV2ViVmlldyBvclxuICAvLyBhIHNpbWlsYXIgZW52aXJvbm1lbnRzLCB0aGlzIG1ldGhvZCBpcyBleHBlY3RlZCB0byBmYWlsIGJ5IGRlZmF1bHQgZm9yXG4gIC8vIGFsbCB0YXJnZXRzIGV4Y2VwdCBgX3RvcGAuXG4gIGxldCByZXM7XG4gIHRyeSB7XG4gICAgcmVzID0gd2luLm9wZW4odXJsLCB0YXJnZXQsIG9wdF9mZWF0dXJlcyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBkZXYoKS5lcnJvcignRE9NJywgJ0ZhaWxlZCB0byBvcGVuIHVybCBvbiB0YXJnZXQ6ICcsIHRhcmdldCwgZSk7XG4gIH1cblxuICAvLyBUaGVuIHRyeSB3aXRoIGBfdG9wYCB0YXJnZXQuXG4gIGlmICghcmVzICYmIHRhcmdldCAhPSAnX3RvcCcpIHtcbiAgICByZXMgPSB3aW4ub3Blbih1cmwsICdfdG9wJyk7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBlbGVtZW50IGlzIGEgc2NyaXB0IHRhZyB3aXRoIGFwcGxpY2F0aW9uL2pzb24gdHlwZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0pzb25TY3JpcHRUYWcoZWxlbWVudCkge1xuICByZXR1cm4gZWxlbWVudC50YWdOYW1lID09ICdTQ1JJUFQnICYmXG4gICAgICAgICAgICBlbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpLnRvVXBwZXJDYXNlKCkgPT0gJ0FQUExJQ0FUSU9OL0pTT04nO1xufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGVsZW1lbnQgaXMgYSBzY3JpcHQgdGFnIHdpdGggYXBwbGljYXRpb24vanNvbiB0eXBlLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzSnNvbkxkU2NyaXB0VGFnKGVsZW1lbnQpIHtcbiAgcmV0dXJuIGVsZW1lbnQudGFnTmFtZSA9PSAnU0NSSVBUJyAmJlxuICAgICAgZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKS50b1VwcGVyQ2FzZSgpID09ICdBUFBMSUNBVElPTi9MRCtKU09OJztcbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBwYWdlJ3MgZGlyZWN0aW9uIGlzIHJpZ2h0IHRvIGxlZnQgb3Igbm90LlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzUlRMKGRvYykge1xuICBjb25zdCBkaXIgPSBkb2MuYm9keS5nZXRBdHRyaWJ1dGUoJ2RpcicpXG4gICAgICAgICAgICAgICAgIHx8IGRvYy5kb2N1bWVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkaXInKVxuICAgICAgICAgICAgICAgICB8fCAnbHRyJztcbiAgcmV0dXJuIGRpciA9PSAncnRsJztcbn1cblxuXG4vKipcbiAqIEVzY2FwZXMgYW4gaWRlbnQgKElEIG9yIGEgY2xhc3MgbmFtZSkgdG8gYmUgdXNlZCBhcyBhIENTUyBzZWxlY3Rvci5cbiAqXG4gKiBTZWUgaHR0cHM6Ly9kcmFmdHMuY3Nzd2cub3JnL2Nzc29tLyNzZXJpYWxpemUtYW4taWRlbnRpZmllci5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRlbnRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVzY2FwZUNzc1NlbGVjdG9ySWRlbnQoaWRlbnQpIHtcbiAgcmV0dXJuIGNzc0VzY2FwZShpZGVudCk7XG59XG5cbi8qKlxuICogRXNjYXBlcyBhbiBpZGVudCBpbiBhIHdheSB0aGF0IGNhbiBiZSB1c2VkIGJ5IDpudGgtY2hpbGQoKSBwc3VlZG8tY2xhc3MuXG4gKlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS93M2MvY3Nzd2ctZHJhZnRzL2lzc3Vlcy8yMzA2LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gaWRlbnRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVzY2FwZUNzc1NlbGVjdG9yTnRoKGlkZW50KSB7XG4gIGNvbnN0IGVzY2FwZWQgPSBTdHJpbmcoaWRlbnQpO1xuICAvLyBFbnN1cmUgaXQgZG9lc24ndCBjbG9zZSB0aGUgbnRoLWNoaWxkIHBzdWVkbyBjbGFzcy5cbiAgZGV2KCkuYXNzZXJ0KGVzY2FwZWQuaW5kZXhPZignKScpID09PSAtMSk7XG4gIHJldHVybiBlc2NhcGVkO1xufVxuXG4vKipcbiAqIEVzY2FwZXMgYDxgLCBgPmAgYW5kIG90aGVyIEhUTUwgY2hhcmNhdGVycyB3aXRoIHRoZWlyIGVzY2FwZWQgZm9ybXMuXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXNjYXBlSHRtbCh0ZXh0KSB7XG4gIGlmICghdGV4dCkge1xuICAgIHJldHVybiB0ZXh0O1xuICB9XG4gIHJldHVybiB0ZXh0LnJlcGxhY2UoSFRNTF9FU0NBUEVfUkVHRVgsIGVzY2FwZUh0bWxDaGFyKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gY1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBlc2NhcGVIdG1sQ2hhcihjKSB7XG4gIHJldHVybiBIVE1MX0VTQ0FQRV9DSEFSU1tjXTtcbn1cblxuLyoqXG4gKiBUcmllcyB0byBmb2N1cyBvbiB0aGUgZ2l2ZW4gZWxlbWVudDsgZmFpbHMgc2lsZW50bHkgaWYgYnJvd3NlciB0aHJvd3MgYW5cbiAqIGV4Y2VwdGlvbi5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyeUZvY3VzKGVsZW1lbnQpIHtcbiAgdHJ5IHtcbiAgICBlbGVtZW50Li8qT0sqL2ZvY3VzKCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBJRSA8PSA3IG1heSB0aHJvdyBleGNlcHRpb25zIHdoZW4gZm9jdXNpbmcgb24gaGlkZGVuIGl0ZW1zLlxuICB9XG59XG5cbi8qKlxuICogV2hldGhlciB0aGUgZ2l2ZW4gd2luZG93IGlzIGluIGFuIGlmcmFtZSBvciBub3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzSWZyYW1lZCh3aW4pIHtcbiAgcmV0dXJuIHdpbi5wYXJlbnQgJiYgd2luLnBhcmVudCAhPSB3aW47XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lcyBpZiB0aGlzIGVsZW1lbnQgaXMgYW4gQU1QIGVsZW1lbnRcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0FtcEVsZW1lbnQoZWxlbWVudCkge1xuICBjb25zdCB0YWcgPSBlbGVtZW50LnRhZ05hbWU7XG4gIC8vIFVzZSBwcmVmaXggdG8gcmVjb2duaXplIEFNUCBlbGVtZW50LiBUaGlzIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHN0dWJcbiAgLy8gbWF5IG5vdCBiZSBhdHRhY2hlZCB5ZXQuXG4gIHJldHVybiBzdGFydHNXaXRoKHRhZywgJ0FNUC0nKSAmJlxuICAgICAgLy8gU29tZSBcImFtcC0qXCIgZWxlbWVudHMgYXJlIG5vdCByZWFsbHkgQU1QIGVsZW1lbnRzLiA6c21oOlxuICAgICAgISh0YWcgPT0gJ0FNUC1TVElDS1ktQUQtVE9QLVBBRERJTkcnIHx8IHRhZyA9PSAnQU1QLUJPRFknKTtcbn1cblxuLyoqXG4gKiBSZXR1cm4gYSBwcm9taXNlIHRoYXQgcmVzb2x2ZSB3aGVuIGFuIEFNUCBlbGVtZW50IHVwZ3JhZGUgZnJvbSBIVE1MRWxlbWVudFxuICogdG8gQ3VzdG9tRWxlbWVudFxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7IVByb21pc2U8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gd2hlblVwZ3JhZGVkVG9DdXN0b21FbGVtZW50KGVsZW1lbnQpIHtcbiAgZGV2KCkuYXNzZXJ0KGlzQW1wRWxlbWVudChlbGVtZW50KSwgJ2VsZW1lbnQgaXMgbm90IEFtcEVsZW1lbnQnKTtcbiAgaWYgKGVsZW1lbnQuY3JlYXRlZENhbGxiYWNrKSB7XG4gICAgLy8gRWxlbWVudCBhbHJlYWR5IGlzIEN1c3RvbUVsZW1lbnQ7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShlbGVtZW50KTtcbiAgfVxuICAvLyBJZiBFbGVtZW50IGlzIHN0aWxsIEhUTUxFbGVtZW50LCB3YWl0IGZvciBpdCB0byB1cGdyYWRlIHRvIGN1c3RvbUVsZW1lbnRcbiAgLy8gTm90ZTogdXNlIHB1cmUgc3RyaW5nIHRvIGF2b2lkIG9iZnVzY2F0aW9uIGJldHdlZW4gdmVyc2lvbnMuXG4gIGlmICghZWxlbWVudFtVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUFJPTUlTRV0pIHtcbiAgICBjb25zdCBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgIGVsZW1lbnRbVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1BST01JU0VdID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICBlbGVtZW50W1VQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9SRVNPTFZFUl0gPSBkZWZlcnJlZC5yZXNvbHZlO1xuXG4gIH1cblxuICByZXR1cm4gZWxlbWVudFtVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUFJPTUlTRV07XG59XG5cbi8qKlxuICogUmVwbGFjZW1lbnQgZm9yIGBFbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKClgIG1ldGhvZC5cbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9FbGVtZW50L3JlcXVlc3RGdWxsc2NyZWVuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmdWxsc2NyZWVuRW50ZXIoZWxlbWVudCkge1xuICBjb25zdCByZXF1ZXN0RnMgPSBlbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuXG4gICB8fCBlbGVtZW50LnJlcXVlc3RGdWxsU2NyZWVuXG4gICB8fCBlbGVtZW50LndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuXG4gICB8fCBlbGVtZW50LndlYmtpdFJlcXVlc3RGdWxsU2NyZWVuXG4gICB8fCBlbGVtZW50LndlYmtpdEVudGVyRnVsbHNjcmVlblxuICAgfHwgZWxlbWVudC53ZWJraXRFbnRlckZ1bGxTY3JlZW5cbiAgIHx8IGVsZW1lbnQubXNSZXF1ZXN0RnVsbHNjcmVlblxuICAgfHwgZWxlbWVudC5tc1JlcXVlc3RGdWxsU2NyZWVuXG4gICB8fCBlbGVtZW50Lm1velJlcXVlc3RGdWxsc2NyZWVuXG4gICB8fCBlbGVtZW50Lm1velJlcXVlc3RGdWxsU2NyZWVuO1xuICBpZiAocmVxdWVzdEZzKSB7XG4gICAgcmVxdWVzdEZzLmNhbGwoZWxlbWVudCk7XG4gIH1cbn1cblxuLyoqXG4gKiBSZXBsYWNlbWVudCBmb3IgYERvY3VtZW50LmV4aXRGdWxsc2NyZWVuKClgIG1ldGhvZC5cbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9Eb2N1bWVudC9leGl0RnVsbHNjcmVlblxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gZnVsbHNjcmVlbkV4aXQoZWxlbWVudCkge1xuICBsZXQgZXhpdEZzID0gZWxlbWVudC5jYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC5leGl0RnVsbHNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQuZXhpdEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50LndlYmtpdEV4aXRGdWxsc2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC53ZWJraXRFeGl0RnVsbFNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQud2Via2l0Q2FuY2VsRnVsbFNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQubW96Q2FuY2VsRnVsbFNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQubXNFeGl0RnVsbHNjcmVlbjtcbiAgaWYgKGV4aXRGcykge1xuICAgIGV4aXRGcy5jYWxsKGVsZW1lbnQpO1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoZWxlbWVudC5vd25lckRvY3VtZW50KSB7XG4gICAgZXhpdEZzID0gZWxlbWVudC5vd25lckRvY3VtZW50LmNhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQuZXhpdEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQud2Via2l0RXhpdEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQud2Via2l0Q2FuY2VsRnVsbFNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC5tb3pDYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50Lm1zRXhpdEZ1bGxzY3JlZW47XG4gIH1cbiAgaWYgKGV4aXRGcykge1xuICAgIGV4aXRGcy5jYWxsKGVsZW1lbnQub3duZXJEb2N1bWVudCk7XG4gICAgcmV0dXJuO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZXBsYWNlbWVudCBmb3IgYERvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50YC5cbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9Eb2N1bWVudC9mdWxsc2NyZWVuRWxlbWVudFxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRnVsbHNjcmVlbkVsZW1lbnQoZWxlbWVudCkge1xuICBjb25zdCBpc0Z1bGxzY3JlZW4gPSBlbGVtZW50LndlYmtpdERpc3BsYXlpbmdGdWxsc2NyZWVuO1xuICBpZiAoaXNGdWxsc2NyZWVuKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgaWYgKGVsZW1lbnQub3duZXJEb2N1bWVudCkge1xuICAgIGNvbnN0IGZ1bGxzY3JlZW5FbGVtZW50ID0gZWxlbWVudC5vd25lckRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50XG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50LndlYmtpdEZ1bGxzY3JlZW5FbGVtZW50XG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50Lm1vekZ1bGxTY3JlZW5FbGVtZW50XG4gICAgICAgICAgICAgfHwgZWxlbWVudC53ZWJraXRDdXJyZW50RnVsbFNjcmVlbkVsZW1lbnQ7XG4gICAgaWYgKGZ1bGxzY3JlZW5FbGVtZW50ID09IGVsZW1lbnQpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIG5vZGUgaXMgbm90IGRpc2FibGVkLlxuICpcbiAqIElFOCBjYW4gcmV0dXJuIGZhbHNlIHBvc2l0aXZlcywgc2VlIHtAbGluayBtYXRjaGVzfS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAc2VlIGh0dHBzOi8vd3d3LnczLm9yZy9UUi9odG1sNS9mb3Jtcy5odG1sI2NvbmNlcHQtZmUtZGlzYWJsZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRW5hYmxlZChlbGVtZW50KSB7XG4gIHJldHVybiAhKGVsZW1lbnQuZGlzYWJsZWQgfHwgbWF0Y2hlcyhlbGVtZW50LCAnOmRpc2FibGVkJykpO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCAqIGFzIGRvbSBmcm9tICcuL2RvbSc7XG5pbXBvcnQge1xuICBnZXRBbXBkb2MsXG4gIGdldEV4aXN0aW5nU2VydmljZUZvckRvY0luRW1iZWRTY29wZSxcbiAgZ2V0U2VydmljZSxcbiAgZ2V0U2VydmljZVByb21pc2UsXG4gIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jLFxuICBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbCxcbiAgZ2V0U2VydmljZVByb21pc2VPck51bGxGb3JEb2MsXG4gIGdldFRvcFdpbmRvdyxcbn0gZnJvbSAnLi9zZXJ2aWNlJztcbmltcG9ydCB7dG9XaW59IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHt1c2VyfSBmcm9tICcuL2xvZyc7XG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgZm9yIGEgc2VydmljZSBmb3IgdGhlIGdpdmVuIGlkIGFuZCB3aW5kb3cuIEFsc28gZXhwZWN0cyBhblxuICogZWxlbWVudCB0aGF0IGhhcyB0aGUgYWN0dWFsIGltcGxlbWVudGF0aW9uLiBUaGUgcHJvbWlzZSByZXNvbHZlcyB3aGVuIHRoZVxuICogaW1wbGVtZW50YXRpb24gbG9hZGVkLiBVc2VycyBzaG91bGQgdHlwaWNhbGx5IHdyYXAgdGhpcyBhcyBhIHNwZWNpYWwgcHVycG9zZVxuICogZnVuY3Rpb24gKGUuZy4gU2VydmljZXMudmlld3BvcnRGb3JEb2MoLi4uKSkgZm9yIHR5cGUgc2FmZXR5IGFuZCBiZWNhdXNlIHRoZVxuICogZmFjdG9yeSBzaG91bGQgbm90IGJlIHBhc3NlZCBhcm91bmQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbiBOYW1lIG9mIHRoZSBjdXN0b20gZXh0ZW5zaW9uIHRoYXQgcHJvdmlkZXMgdGhlXG4gKiAgICAgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBzZXJ2aWNlLlxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2VsZW1lbnQgV2hldGhlciB0aGlzIHNlcnZpY2UgaXMgcHJvdmlkZWQgYnkgYW4gZWxlbWVudCxcbiAqICAgICBub3QgdGhlIGV4dGVuc2lvbi5cbiAqIEByZXR1cm4geyFQcm9taXNlPCo+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWxlbWVudFNlcnZpY2Uod2luLCBpZCwgZXh0ZW5zaW9uLCBvcHRfZWxlbWVudCkge1xuICByZXR1cm4gZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KS50aGVuKFxuICAgICAgc2VydmljZSA9PiBhc3NlcnRTZXJ2aWNlKHNlcnZpY2UsIGlkLCBleHRlbnNpb24pKTtcbn1cblxuLyoqXG4gKiBTYW1lIGFzIGdldEVsZW1lbnRTZXJ2aWNlIGJ1dCBwcm9kdWNlcyBudWxsIGlmIHRoZSBnaXZlbiBlbGVtZW50IGlzIG5vdFxuICogYWN0dWFsbHkgYXZhaWxhYmxlIG9uIHRoZSBjdXJyZW50IHBhZ2UuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbiBOYW1lIG9mIHRoZSBjdXN0b20gZXh0ZW5zaW9uIHRoYXQgcHJvdmlkZXMgdGhlXG4gKiAgICAgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBzZXJ2aWNlLlxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2VsZW1lbnQgV2hldGhlciB0aGlzIHNlcnZpY2UgaXMgcHJvdmlkZWQgYnkgYW5cbiAqICAgICBlbGVtZW50LCBub3QgdGhlIGV4dGVuc2lvbi5cbiAqIEByZXR1cm4geyFQcm9taXNlPD9PYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KSB7XG4gIGNvbnN0IHMgPSBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkKTtcbiAgaWYgKHMpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/T2JqZWN0Pn0gKi8gKHMpO1xuICB9XG4gIHJldHVybiBnZXRFbGVtZW50U2VydmljZVByb21pc2VPck51bGwod2luLCBpZCwgZXh0ZW5zaW9uLCBvcHRfZWxlbWVudCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBlbGVtZW50TmFtZSBOYW1lIG9mIGFuIGV4dGVuZGVkIGN1c3RvbSBlbGVtZW50LlxuICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIGVsZW1lbnQgaXMgc2NoZWR1bGVkIHRvIGJlIGxvYWRlZC5cbiAqL1xuZnVuY3Rpb24gaXNFbGVtZW50U2NoZWR1bGVkKHdpbiwgZWxlbWVudE5hbWUpIHtcbiAgLy8gU2V0IGluIGN1c3RvbS1lbGVtZW50LmpzXG4gIGlmICghd2luLmFtcEV4dGVuZGVkRWxlbWVudHMpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuICEhd2luLmFtcEV4dGVuZGVkRWxlbWVudHNbZWxlbWVudE5hbWVdO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgZm9yIGEgc2VydmljZSBmb3IgdGhlIGdpdmVuIGlkIGFuZCB3aW5kb3cuIEFsc28gZXhwZWN0cyBhblxuICogZWxlbWVudCB0aGF0IGhhcyB0aGUgYWN0dWFsIGltcGxlbWVudGF0aW9uLiBUaGUgcHJvbWlzZSByZXNvbHZlcyB3aGVuIHRoZVxuICogaW1wbGVtZW50YXRpb24gbG9hZGVkLiBVc2VycyBzaG91bGQgdHlwaWNhbGx5IHdyYXAgdGhpcyBhcyBhIHNwZWNpYWwgcHVycG9zZVxuICogZnVuY3Rpb24gKGUuZy4gU2VydmljZXMudmlld3BvcnRGb3JEb2MoLi4uKSkgZm9yIHR5cGUgc2FmZXR5IGFuZCBiZWNhdXNlIHRoZVxuICogZmFjdG9yeSBzaG91bGQgbm90IGJlIHBhc3NlZCBhcm91bmQuXG4gKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb24gTmFtZSBvZiB0aGUgY3VzdG9tIGV4dGVuc2lvbiB0aGF0IHByb3ZpZGVzIHRoZVxuICogICAgIGltcGxlbWVudGF0aW9uIG9mIHRoaXMgc2VydmljZS5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9lbGVtZW50IFdoZXRoZXIgdGhpcyBzZXJ2aWNlIGlzIHByb3ZpZGVkIGJ5IGFuIGVsZW1lbnQsXG4gKiAgICAgbm90IHRoZSBleHRlbnNpb24uXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwqPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQsIGV4dGVuc2lvbixcbiAgb3B0X2VsZW1lbnQpIHtcbiAgcmV0dXJuIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoXG4gICAgICBlbGVtZW50T3JBbXBEb2MsIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KVxuICAgICAgLnRoZW4oc2VydmljZSA9PiBhc3NlcnRTZXJ2aWNlKHNlcnZpY2UsIGlkLCBleHRlbnNpb24pKTtcbn1cblxuLyoqXG4gKiBTYW1lIGFzIGdldEVsZW1lbnRTZXJ2aWNlIGJ1dCBwcm9kdWNlcyBudWxsIGlmIHRoZSBnaXZlbiBlbGVtZW50IGlzIG5vdFxuICogYWN0dWFsbHkgYXZhaWxhYmxlIG9uIHRoZSBjdXJyZW50IHBhZ2UuXG4gKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb24gTmFtZSBvZiB0aGUgY3VzdG9tIGV4dGVuc2lvbiB0aGF0IHByb3ZpZGVzIHRoZVxuICogICAgIGltcGxlbWVudGF0aW9uIG9mIHRoaXMgc2VydmljZS5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9lbGVtZW50IFdoZXRoZXIgdGhpcyBzZXJ2aWNlIGlzIHByb3ZpZGVkIGJ5IGFuXG4gKiAgICAgZWxlbWVudCwgbm90IHRoZSBleHRlbnNpb24uXG4gKiBAcmV0dXJuIHshUHJvbWlzZTw/T2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoXG4gIGVsZW1lbnRPckFtcERvYywgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpIHtcbiAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKGVsZW1lbnRPckFtcERvYyk7XG4gIGNvbnN0IHMgPSBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGlkKTtcbiAgaWYgKHMpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/T2JqZWN0Pn0gKi8gKHMpO1xuICB9XG5cbiAgcmV0dXJuIGFtcGRvYy53aGVuQm9keUF2YWlsYWJsZSgpXG4gICAgICAudGhlbigoKSA9PiB3YWl0Rm9yRXh0ZW5zaW9uSWZQcmVzZW50KFxuICAgICAgICAgIGFtcGRvYy53aW4sIGV4dGVuc2lvbixcbiAgICAgICAgICBhbXBkb2MuZ2V0SGVhZE5vZGUoKSkpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIC8vIElmIHRoaXMgc2VydmljZSBpcyBwcm92aWRlZCBieSBhbiBlbGVtZW50LCB0aGVuIHdlIGNhbid0IGRlcGVuZCBvblxuICAgICAgICAvLyB0aGUgc2VydmljZSAodGhleSBtYXkgbm90IHVzZSB0aGUgZWxlbWVudCkuXG4gICAgICAgIGlmIChvcHRfZWxlbWVudCkge1xuICAgICAgICAgIHJldHVybiBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGlkKTtcbiAgICAgICAgfSBlbHNlIGlmIChpc0VsZW1lbnRTY2hlZHVsZWQoYW1wZG9jLndpbiwgZXh0ZW5zaW9uKSkge1xuICAgICAgICAgIHJldHVybiBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGlkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0pO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIGZvciBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgaW4gdGhlIGVtYmVkIHNjb3BlIG9mXG4gKiBhIGdpdmVuIG5vZGUsIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlLCBmYWxscyBiYWNrIHRvIGFtcGRvYyBzY29wZSBJRkZcbiAqIHRoZSBnaXZlbiBub2RlIGlzIGluIHRoZSB0b3AtbGV2ZWwgd2luZG93LlxuICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uIE5hbWUgb2YgdGhlIGN1c3RvbSBlbGVtZW50IHRoYXQgcHJvdmlkZXNcbiAqICAgICB0aGUgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBzZXJ2aWNlLlxuICogQHJldHVybiB7IVByb21pc2U8P09iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICBlbGVtZW50T3JBbXBEb2MsIGlkLCBleHRlbnNpb24pIHtcbiAgY29uc3QgcyA9IGdldEV4aXN0aW5nU2VydmljZUZvckRvY0luRW1iZWRTY29wZShlbGVtZW50T3JBbXBEb2MsIGlkKTtcbiAgaWYgKHMpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/T2JqZWN0Pn0gKi8gKFByb21pc2UucmVzb2x2ZShzKSk7XG4gIH1cbiAgLy8gUmV0dXJuIGVtYmVkLXNjb3BlIGVsZW1lbnQgc2VydmljZSBwcm9taXNlIGlmIHNjaGVkdWxlZC5cbiAgaWYgKGVsZW1lbnRPckFtcERvYy5ub2RlVHlwZSkge1xuICAgIGNvbnN0IHdpbiA9IHRvV2luKGVsZW1lbnRPckFtcERvYy5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3KTtcbiAgICBjb25zdCB0b3BXaW4gPSBnZXRUb3BXaW5kb3cod2luKTtcbiAgICAvLyBJbiBlbWJlZHMsIGRvYy1zY29wZSBzZXJ2aWNlcyBhcmUgd2luZG93LXNjb3BlLiBCdXQgbWFrZSBzdXJlIHRvXG4gICAgLy8gb25seSBkbyB0aGlzIGZvciBlbWJlZHMgKG5vdCB0aGUgdG9wIHdpbmRvdyksIG90aGVyd2lzZSB3ZSdkIGdyYWJcbiAgICAvLyBhIHByb21pc2UgZnJvbSB0aGUgd3Jvbmcgc2VydmljZSBob2xkZXIgd2hpY2ggd291bGQgbmV2ZXIgcmVzb2x2ZS5cbiAgICBpZiAod2luICE9PSB0b3BXaW4pIHtcbiAgICAgIHJldHVybiBnZXRFbGVtZW50U2VydmljZVByb21pc2VPck51bGwod2luLCBpZCwgZXh0ZW5zaW9uKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRmFsbGJhY2sgdG8gYW1wZG9jIElGRiB0aGUgZ2l2ZW4gbm9kZSBpcyBfbm90XyBGSUUuXG4gICAgICByZXR1cm4gZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGlkLCBleHRlbnNpb24pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/T2JqZWN0Pn0gKi8gKFByb21pc2UucmVzb2x2ZShudWxsKSk7XG59XG5cbi8qKlxuICogVGhyb3dzIHVzZXIgZXJyb3IgaWYgYHNlcnZpY2VgIGlzIG51bGwuXG4gKiBAcGFyYW0ge09iamVjdH0gc2VydmljZVxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uXG4gKiBAcmV0dXJuIHshT2JqZWN0fVxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gYXNzZXJ0U2VydmljZShzZXJ2aWNlLCBpZCwgZXh0ZW5zaW9uKSB7XG4gIHJldHVybiAvKiogQHR5cGUgeyFPYmplY3R9ICovICh1c2VyKCkuYXNzZXJ0KHNlcnZpY2UsXG4gICAgICAnU2VydmljZSAlcyB3YXMgcmVxdWVzdGVkIHRvIGJlIHByb3ZpZGVkIHRocm91Z2ggJXMsICcgK1xuICAgICAgJ2J1dCAlcyBpcyBub3QgbG9hZGVkIGluIHRoZSBjdXJyZW50IHBhZ2UuIFRvIGZpeCB0aGlzICcgK1xuICAgICAgJ3Byb2JsZW0gbG9hZCB0aGUgSmF2YVNjcmlwdCBmaWxlIGZvciAlcyBpbiB0aGlzIHBhZ2UuJyxcbiAgICAgIGlkLCBleHRlbnNpb24sIGV4dGVuc2lvbiwgZXh0ZW5zaW9uKSk7XG59XG5cbi8qKlxuICogR2V0IGxpc3Qgb2YgYWxsIHRoZSBleHRlbnNpb24gSlMgZmlsZXNcbiAqIEBwYXJhbSB7SFRNTEhlYWRFbGVtZW50fEVsZW1lbnR8U2hhZG93Um9vdH0gaGVhZFxuICogQHJldHVybiB7IUFycmF5PHN0cmluZz59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHRlbnNpb25TY3JpcHRzSW5Ob2RlKGhlYWQpIHtcbiAgLy8gYW1wZG9jLmdldEhlYWROb2RlKCkgY2FuIHJldHVybiBudWxsXG4gIGlmICghaGVhZCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBjb25zdCBzY3JpcHRzID0gW107XG4gIGNvbnN0IGxpc3QgPSBoZWFkLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NjcmlwdFtjdXN0b20tZWxlbWVudF0nKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgc2NyaXB0cy5wdXNoKGxpc3RbaV0uZ2V0QXR0cmlidXRlKCdjdXN0b20tZWxlbWVudCcpKTtcbiAgfVxuICByZXR1cm4gc2NyaXB0cztcbn1cblxuLyoqXG4gKiBXYWl0cyBmb3IgYm9keSB0byBiZSBwcmVzZW50IHRoZW4gdmVyaWZpZXMgdGhhdCBhbiBleHRlbnNpb24gc2NyaXB0IGlzXG4gKiBwcmVzZW50IGluIGhlYWQgZm9yIGluc3RhbGxhdGlvbi5cbiAqIEBwYXJhbSB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbklkXG4gKiBAcmV0dXJuIHshUHJvbWlzZTxib29sZWFuPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRXh0ZW5zaW9uU2NyaXB0SW5Ob2RlKGFtcGRvYywgZXh0ZW5zaW9uSWQpIHtcbiAgcmV0dXJuIGFtcGRvYy53aGVuQm9keUF2YWlsYWJsZSgpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIHJldHVybiBleHRlbnNpb25TY3JpcHRJbk5vZGUoXG4gICAgICAgICAgICBhbXBkb2MuZ2V0SGVhZE5vZGUoKSwgZXh0ZW5zaW9uSWQpO1xuICAgICAgfSk7XG59XG5cbi8qKlxuICogVmVyaWZpZXMgdGhhdCBhbiBleHRlbnNpb24gc2NyaXB0IGlzIHByZXNlbnQgaW4gaGVhZCBmb3JcbiAqIGluc3RhbGxhdGlvbi5cbiAqIEBwYXJhbSB7SFRNTEhlYWRFbGVtZW50fEVsZW1lbnR8U2hhZG93Um9vdH0gaGVhZFxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbklkXG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBleHRlbnNpb25TY3JpcHRJbk5vZGUoaGVhZCwgZXh0ZW5zaW9uSWQpIHtcbiAgcmV0dXJuIGV4dGVuc2lvblNjcmlwdHNJbk5vZGUoaGVhZCkuaW5jbHVkZXMoZXh0ZW5zaW9uSWQpO1xufVxuXG4vKipcbiAqIFdhaXRzIGZvciBhbiBleHRlbnNpb24gaWYgaXRzIHNjcmlwdCBpcyBwcmVzZW50XG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvblxuICogQHBhcmFtIHtIVE1MSGVhZEVsZW1lbnR8RWxlbWVudHxTaGFkb3dSb290fSBoZWFkXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIHdhaXRGb3JFeHRlbnNpb25JZlByZXNlbnQod2luLCBleHRlbnNpb24sIGhlYWQpIHtcbiAgLyoqXG4gICAqIElmIHRoZXJlIGlzIGFuIGV4dGVuc2lvbiBzY3JpcHQgd2FpdCBmb3IgaXQgdG8gbG9hZCBiZWZvcmUgdHJ5aW5nXG4gICAqIHRvIGdldCB0aGUgc2VydmljZS4gUHJldmVudHMgYSByYWNlIGNvbmRpdGlvbiB3aGVuIGV2ZXJ5dGhpbmcgYnV0XG4gICAqIHRoZSBleHRlbnNpb25zIGlzIGluIGNhY2hlLiBJZiB0aGVyZSBpcyBubyBzY3JpcHQgdGhlbiBpdCdzIGVpdGhlclxuICAgKiBub3QgcHJlc2VudCwgb3IgdGhlIHNlcnZpY2Ugd2FzIGRlZmluZWQgYnkgYSB0ZXN0LiBJbiB0aG9zZSBjYXNlc1xuICAgKiB3ZSBkb24ndCB3YWl0IGFyb3VuZCBmb3IgYW4gZXh0ZW5zaW9uIHRoYXQgZG9lcyBub3QgZXhpc3QuXG4gICAqL1xuXG4gIC8vIFRPRE8oanBldHRpdHQpIGludmVzdGlnYXRlIHJlZ2lzdGVyRXh0ZW5zaW9uIHRvIHNob3J0IGNpcmN1aXRcbiAgLy8gdGhlIGRvbSBjYWxsIGluIGV4dGVuc2lvblNjcmlwdHNJbk5vZGUoKVxuICBpZiAoIWV4dGVuc2lvblNjcmlwdEluTm9kZShoZWFkLCBleHRlbnNpb24pKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICB9XG5cbiAgY29uc3QgZXh0ZW5zaW9ucyA9IGdldFNlcnZpY2Uod2luLCAnZXh0ZW5zaW9ucycpO1xuICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/T2JqZWN0Pn0gKi8gKFxuICAgIGV4dGVuc2lvbnMud2FpdEZvckV4dGVuc2lvbih3aW4sIGV4dGVuc2lvbikpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHByb21pc2UgZm9yIHNlcnZpY2Ugd2l0aCBgaWRgIG9uIHRoZSBnaXZlbiB3aW5kb3cgaWYgYXZhaWxhYmxlLlxuICogT3RoZXJ3aXNlLCByZXNvbHZlcyB3aXRoIG51bGwgKHNlcnZpY2Ugd2FzIG5vdCByZWdpc3RlcmVkKS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb25cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9lbGVtZW50XG4gKiBAcmV0dXJuIHshUHJvbWlzZTxPYmplY3Q+fVxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gZ2V0RWxlbWVudFNlcnZpY2VQcm9taXNlT3JOdWxsKHdpbiwgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpIHtcbiAgcmV0dXJuIGRvbS53YWl0Rm9yQm9keVByb21pc2Uod2luLmRvY3VtZW50KVxuICAgICAgLnRoZW4oKCkgPT4gd2FpdEZvckV4dGVuc2lvbklmUHJlc2VudCh3aW4sIGV4dGVuc2lvbiwgd2luLmRvY3VtZW50LmhlYWQpKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAvLyBJZiB0aGlzIHNlcnZpY2UgaXMgcHJvdmlkZWQgYnkgYW4gZWxlbWVudCwgdGhlbiB3ZSBjYW4ndCBkZXBlbmQgb25cbiAgICAgICAgLy8gdGhlIHNlcnZpY2UgKHRoZXkgbWF5IG5vdCB1c2UgdGhlIGVsZW1lbnQpLlxuICAgICAgICBpZiAob3B0X2VsZW1lbnQpIHtcbiAgICAgICAgICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VPck51bGwod2luLCBpZCk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNFbGVtZW50U2NoZWR1bGVkKHdpbiwgZXh0ZW5zaW9uKSkge1xuICAgICAgICAgIHJldHVybiBnZXRTZXJ2aWNlUHJvbWlzZSh3aW4sIGlkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0pO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICAqIFdoZXRoZXIgYWRkRXZlbnRMaXN0ZW5lciBzdXBwb3J0cyBvcHRpb25zIG9yIG9ubHkgdGFrZXMgY2FwdHVyZSBhcyBhIGJvb2xlYW5cbiAgKiBAdHlwZSB7Ym9vbGVhbnx1bmRlZmluZWR9XG4gICogQHZpc2libGVGb3JUZXN0aW5nXG4gICovXG5sZXQgb3B0c1N1cHBvcnRlZDtcblxuLyoqXG4gKiBMaXN0ZW5zIGZvciB0aGUgc3BlY2lmaWVkIGV2ZW50IG9uIHRoZSBlbGVtZW50LlxuICpcbiAqIERvIG5vdCB1c2UgdGhpcyBkaXJlY3RseS4gVGhpcyBtZXRob2QgaXMgaW1wbGVtZW50ZWQgYXMgYSBzaGFyZWRcbiAqIGRlcGVuZGVuY3kuIFVzZSBgbGlzdGVuKClgIGluIGVpdGhlciBgZXZlbnQtaGVscGVyYCBvciBgM3AtZnJhbWUtbWVzc2FnaW5nYCxcbiAqIGRlcGVuZGluZyBvbiB5b3VyIHVzZSBjYXNlLlxuICpcbiAqIEBwYXJhbSB7IUV2ZW50VGFyZ2V0fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFdmVudCl9IGxpc3RlbmVyXG4gKiBAcGFyYW0ge09iamVjdD19IG9wdF9ldnRMaXN0ZW5lck9wdHNcbiAqIEByZXR1cm4geyFVbmxpc3RlbkRlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGludGVybmFsTGlzdGVuSW1wbGVtZW50YXRpb24oZWxlbWVudCwgZXZlbnRUeXBlLCBsaXN0ZW5lcixcbiAgb3B0X2V2dExpc3RlbmVyT3B0cykge1xuICBsZXQgbG9jYWxFbGVtZW50ID0gZWxlbWVudDtcbiAgbGV0IGxvY2FsTGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgLyoqXG4gICAqIEB0eXBlIHs/RnVuY3Rpb259XG4gICAqL1xuICBsZXQgd3JhcHBlZDtcblxuICB3cmFwcGVkID0gZXZlbnQgPT4ge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gbG9jYWxMaXN0ZW5lcihldmVudCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gcmVwb3J0RXJyb3IgaXMgaW5zdGFsbGVkIGdsb2JhbGx5IHBlciB3aW5kb3cgaW4gdGhlIGVudHJ5IHBvaW50LlxuICAgICAgc2VsZi5yZXBvcnRFcnJvcihlKTtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuICB9O1xuICBjb25zdCBvcHRzU3VwcG9ydGVkID0gZGV0ZWN0RXZ0TGlzdGVuZXJPcHRzU3VwcG9ydCgpO1xuICBsZXQgY2FwdHVyZSA9IGZhbHNlO1xuICBpZiAob3B0X2V2dExpc3RlbmVyT3B0cykge1xuICAgIGNhcHR1cmUgPSBvcHRfZXZ0TGlzdGVuZXJPcHRzLmNhcHR1cmU7XG4gIH1cbiAgbG9jYWxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICBldmVudFR5cGUsXG4gICAgICB3cmFwcGVkLFxuICAgICAgb3B0c1N1cHBvcnRlZCA/IG9wdF9ldnRMaXN0ZW5lck9wdHMgOiBjYXB0dXJlXG4gICk7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgaWYgKGxvY2FsRWxlbWVudCkge1xuICAgICAgbG9jYWxFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgZXZlbnRUeXBlLFxuICAgICAgICAgIHdyYXBwZWQsXG4gICAgICAgICAgb3B0c1N1cHBvcnRlZCA/IG9wdF9ldnRMaXN0ZW5lck9wdHMgOiBjYXB0dXJlXG4gICAgICApO1xuICAgIH1cbiAgICAvLyBFbnN1cmUgdGhlc2UgYXJlIEdDJ2RcbiAgICBsb2NhbExpc3RlbmVyID0gbnVsbDtcbiAgICBsb2NhbEVsZW1lbnQgPSBudWxsO1xuICAgIHdyYXBwZWQgPSBudWxsO1xuICB9O1xufVxuXG4vKipcbiAqIFRlc3RzIHdoZXRoZXIgdGhlIGJyb3dzZXIgc3VwcG9ydHMgb3B0aW9ucyBhcyBhbiBhcmd1bWVudCBvZiBhZGRFdmVudExpc3RlbmVyXG4gKiBvciBub3QuXG4gKlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRldGVjdEV2dExpc3RlbmVyT3B0c1N1cHBvcnQoKSB7XG4gIC8vIE9ubHkgcnVuIHRoZSB0ZXN0IG9uY2VcbiAgaWYgKG9wdHNTdXBwb3J0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBvcHRzU3VwcG9ydGVkO1xuICB9XG5cbiAgb3B0c1N1cHBvcnRlZCA9IGZhbHNlO1xuICB0cnkge1xuICAgIC8vIFRlc3Qgd2hldGhlciBicm93c2VyIHN1cHBvcnRzIEV2ZW50TGlzdGVuZXJPcHRpb25zIG9yIG5vdFxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBnZXQgY2FwdHVyZSgpIHtcbiAgICAgICAgb3B0c1N1cHBvcnRlZCA9IHRydWU7XG4gICAgICB9LFxuICAgIH07XG4gICAgc2VsZi5hZGRFdmVudExpc3RlbmVyKCd0ZXN0LW9wdGlvbnMnLCBudWxsLCBvcHRpb25zKTtcbiAgICBzZWxmLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Rlc3Qtb3B0aW9ucycsIG51bGwsIG9wdGlvbnMpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICAvLyBFdmVudExpc3RlbmVyT3B0aW9ucyBhcmUgbm90IHN1cHBvcnRlZFxuICB9XG4gIHJldHVybiBvcHRzU3VwcG9ydGVkO1xufVxuXG4vKipcbiAgKiBSZXNldHMgdGhlIHRlc3QgZm9yIHdoZXRoZXIgYWRkRXZlbnRMaXN0ZW5lciBzdXBwb3J0cyBvcHRpb25zIG9yIG5vdC5cbiAgKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldEV2dExpc3RlbmVyT3B0c1N1cHBvcnRGb3JUZXN0aW5nKCkge1xuICBvcHRzU3VwcG9ydGVkID0gdW5kZWZpbmVkO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7aW50ZXJuYWxMaXN0ZW5JbXBsZW1lbnRhdGlvbn0gZnJvbSAnLi9ldmVudC1oZWxwZXItbGlzdGVuJztcbmltcG9ydCB7dXNlcn0gZnJvbSAnLi9sb2cnO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICAqL1xuY29uc3QgTE9BRF9GQUlMVVJFX1BSRUZJWCA9ICdGYWlsZWQgdG8gbG9hZDonO1xuXG4vKipcbiAqIFJldHVybnMgYSBDdXN0b21FdmVudCB3aXRoIGEgZ2l2ZW4gdHlwZSBhbmQgZGV0YWlsOyBzdXBwb3J0cyBmYWxsYmFjayBmb3IgSUUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAqIEBwYXJhbSB7IUpzb25PYmplY3R8c3RyaW5nfHVuZGVmaW5lZHxudWxsfSBkZXRhaWxcbiAqIEBwYXJhbSB7RXZlbnRJbml0PX0gb3B0X2V2ZW50SW5pdFxuICogQHJldHVybiB7IUV2ZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ3VzdG9tRXZlbnQod2luLCB0eXBlLCBkZXRhaWwsIG9wdF9ldmVudEluaXQpIHtcbiAgY29uc3QgZXZlbnRJbml0ID0gLyoqIEB0eXBlIHshQ3VzdG9tRXZlbnRJbml0fSAqLyAoe2RldGFpbH0pO1xuICBPYmplY3QuYXNzaWduKGV2ZW50SW5pdCwgb3B0X2V2ZW50SW5pdCk7XG4gIC8vIHdpbi5DdXN0b21FdmVudCBpcyBhIGZ1bmN0aW9uIG9uIEVkZ2UsIENocm9tZSwgRkYsIFNhZmFyaSBidXRcbiAgLy8gaXMgYW4gb2JqZWN0IG9uIElFIDExLlxuICBpZiAodHlwZW9mIHdpbi5DdXN0b21FdmVudCA9PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIG5ldyB3aW4uQ3VzdG9tRXZlbnQodHlwZSwgZXZlbnRJbml0KTtcbiAgfSBlbHNlIHtcbiAgICAvLyBEZXByZWNhdGVkIGZhbGxiYWNrIGZvciBJRS5cbiAgICBjb25zdCBlID0gd2luLmRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgIGUuaW5pdEN1c3RvbUV2ZW50KFxuICAgICAgICB0eXBlLCAhIWV2ZW50SW5pdC5idWJibGVzLCAhIWV2ZW50SW5pdC5jYW5jZWxhYmxlLCBkZXRhaWwpO1xuICAgIHJldHVybiBlO1xuICB9XG59XG5cbi8qKlxuICogTGlzdGVucyBmb3IgdGhlIHNwZWNpZmllZCBldmVudCBvbiB0aGUgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUV2ZW50VGFyZ2V0fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFdmVudCl9IGxpc3RlbmVyXG4gKiBAcGFyYW0ge09iamVjdD19IG9wdF9ldnRMaXN0ZW5lck9wdHNcbiAqIEByZXR1cm4geyFVbmxpc3RlbkRlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxpc3RlbihlbGVtZW50LCBldmVudFR5cGUsIGxpc3RlbmVyLCBvcHRfZXZ0TGlzdGVuZXJPcHRzKSB7XG4gIHJldHVybiBpbnRlcm5hbExpc3RlbkltcGxlbWVudGF0aW9uKFxuICAgICAgZWxlbWVudCwgZXZlbnRUeXBlLCBsaXN0ZW5lciwgb3B0X2V2dExpc3RlbmVyT3B0cyk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZGF0YSBwcm9wZXJ0eSBvZiBhbiBldmVudCB3aXRoIHRoZSBjb3JyZWN0IHR5cGUuXG4gKiBAcGFyYW0geyFFdmVudHx7ZGF0YTogIUpzb25PYmplY3R9fSBldmVudFxuICogQHJldHVybiB7P0pzb25PYmplY3R8c3RyaW5nfHVuZGVmaW5lZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldERhdGEoZXZlbnQpIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7P0pzb25PYmplY3R8c3RyaW5nfHVuZGVmaW5lZH0gKi8gKGV2ZW50LmRhdGEpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGRldGFpbCBwcm9wZXJ0eSBvZiBhbiBldmVudCB3aXRoIHRoZSBjb3JyZWN0IHR5cGUuXG4gKiBAcGFyYW0geyFFdmVudHx7ZGV0YWlsOiAhSnNvbk9iamVjdH19IGV2ZW50XG4gKiBAcmV0dXJuIHs/SnNvbk9iamVjdHxzdHJpbmd8dW5kZWZpbmVkfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGV0YWlsKGV2ZW50KSB7XG4gIHJldHVybiAvKiogQHR5cGUgez9Kc29uT2JqZWN0fHN0cmluZ3x1bmRlZmluZWR9ICovIChldmVudC5kZXRhaWwpO1xufVxuXG4vKipcbiAqIExpc3RlbnMgZm9yIHRoZSBzcGVjaWZpZWQgZXZlbnQgb24gdGhlIGVsZW1lbnQgYW5kIHJlbW92ZXMgdGhlIGxpc3RlbmVyXG4gKiBhcyBzb29uIGFzIGV2ZW50IGhhcyBiZWVuIHJlY2VpdmVkLlxuICogQHBhcmFtIHshRXZlbnRUYXJnZXR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUV2ZW50KX0gbGlzdGVuZXJcbiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0X2V2dExpc3RlbmVyT3B0c1xuICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGlzdGVuT25jZShlbGVtZW50LCBldmVudFR5cGUsIGxpc3RlbmVyLCBvcHRfZXZ0TGlzdGVuZXJPcHRzKSB7XG4gIGxldCBsb2NhbExpc3RlbmVyID0gbGlzdGVuZXI7XG4gIGNvbnN0IHVubGlzdGVuID0gaW50ZXJuYWxMaXN0ZW5JbXBsZW1lbnRhdGlvbihlbGVtZW50LCBldmVudFR5cGUsIGV2ZW50ID0+IHtcbiAgICB0cnkge1xuICAgICAgbG9jYWxMaXN0ZW5lcihldmVudCk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIC8vIEVuc3VyZSBsaXN0ZW5lciBpcyBHQydkXG4gICAgICBsb2NhbExpc3RlbmVyID0gbnVsbDtcbiAgICAgIHVubGlzdGVuKCk7XG4gICAgfVxuICB9LCBvcHRfZXZ0TGlzdGVuZXJPcHRzKTtcbiAgcmV0dXJuIHVubGlzdGVuO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyAgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIGFzIHNvb24gYXMgdGhlIHNwZWNpZmllZCBldmVudCBoYXNcbiAqIGZpcmVkIG9uIHRoZSBlbGVtZW50LlxuICogQHBhcmFtIHshRXZlbnRUYXJnZXR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0X2V2dExpc3RlbmVyT3B0c1xuICogQHBhcmFtIHtmdW5jdGlvbighVW5saXN0ZW5EZWYpPX0gb3B0X2NhbmNlbCBBbiBvcHRpb25hbCBmdW5jdGlvbiB0aGF0LCB3aGVuXG4gKiAgICAgcHJvdmlkZWQsIHdpbGwgYmUgY2FsbGVkIHdpdGggdGhlIHVubGlzdGVuZXIuIFRoaXMgZ2l2ZXMgdGhlIGNhbGxlclxuICogICAgIGFjY2VzcyB0byB0aGUgdW5saXN0ZW5lciwgc28gaXQgbWF5IGJlIGNhbGxlZCBtYW51YWxseSB3aGVuIG5lY2Vzc2FyeS5cbiAqIEByZXR1cm4geyFQcm9taXNlPCFFdmVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW5PbmNlUHJvbWlzZShlbGVtZW50LCBldmVudFR5cGUsIG9wdF9ldnRMaXN0ZW5lck9wdHMsXG4gIG9wdF9jYW5jZWwpIHtcbiAgbGV0IHVubGlzdGVuO1xuICBjb25zdCBldmVudFByb21pc2UgPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICB1bmxpc3RlbiA9IGxpc3Rlbk9uY2UoZWxlbWVudCwgZXZlbnRUeXBlLCByZXNvbHZlLCBvcHRfZXZ0TGlzdGVuZXJPcHRzKTtcbiAgfSk7XG4gIGV2ZW50UHJvbWlzZS50aGVuKHVubGlzdGVuLCB1bmxpc3Rlbik7XG4gIGlmIChvcHRfY2FuY2VsKSB7XG4gICAgb3B0X2NhbmNlbCh1bmxpc3Rlbik7XG4gIH1cbiAgcmV0dXJuIGV2ZW50UHJvbWlzZTtcbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHNwZWNpZmllZCBlbGVtZW50L3dpbmRvdyBoYXMgYmVlbiBsb2FkZWQgYWxyZWFkeS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IVdpbmRvd30gZWxlT3JXaW5kb3dcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvYWRlZChlbGVPcldpbmRvdykge1xuICByZXR1cm4gISEoZWxlT3JXaW5kb3cuY29tcGxldGUgfHwgZWxlT3JXaW5kb3cucmVhZHlTdGF0ZSA9PSAnY29tcGxldGUnXG4gICAgICAvLyBJZiB0aGUgcGFzc2VkIGluIHRoaW5nIGlzIGEgV2luZG93LCBpbmZlciBsb2FkZWQgc3RhdGUgZnJvbVxuICAgICAgLy9cbiAgICAgIHx8IChlbGVPcldpbmRvdy5kb2N1bWVudFxuICAgICAgICAgICYmIGVsZU9yV2luZG93LmRvY3VtZW50LnJlYWR5U3RhdGUgPT0gJ2NvbXBsZXRlJykpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIG9yIGZhaWwgYmFzZWQgb24gdGhlIGVsZU9yV2luZG93J3MgJ2xvYWQnXG4gKiBhbmQgJ2Vycm9yJyBldmVudHMuIE9wdGlvbmFsbHkgdGhpcyBtZXRob2QgdGFrZXMgYSB0aW1lb3V0LCB3aGljaCB3aWxsIHJlamVjdFxuICogdGhlIHByb21pc2UgaWYgdGhlIHJlc291cmNlIGhhcyBub3QgbG9hZGVkIGJ5IHRoZW4uXG4gKiBAcGFyYW0ge1R9IGVsZU9yV2luZG93IFN1cHBvcnRzIGJvdGggRWxlbWVudHMgYW5kIGFzIGEgc3BlY2lhbCBjYXNlIFdpbmRvd3MuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTxUPn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsb2FkUHJvbWlzZShlbGVPcldpbmRvdykge1xuICBsZXQgdW5saXN0ZW5Mb2FkO1xuICBsZXQgdW5saXN0ZW5FcnJvcjtcbiAgaWYgKGlzTG9hZGVkKGVsZU9yV2luZG93KSkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZWxlT3JXaW5kb3cpO1xuICB9XG4gIGNvbnN0IGxvYWRpbmdQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIC8vIExpc3RlbiBvbmNlIHNpbmNlIElFIDUvNi83IGZpcmUgdGhlIG9ubG9hZCBldmVudCBjb250aW51b3VzbHkgZm9yXG4gICAgLy8gYW5pbWF0ZWQgR0lGcy5cbiAgICBjb25zdCB7dGFnTmFtZX0gPSBlbGVPcldpbmRvdztcbiAgICBpZiAodGFnTmFtZSA9PT0gJ0FVRElPJyB8fCB0YWdOYW1lID09PSAnVklERU8nKSB7XG4gICAgICB1bmxpc3RlbkxvYWQgPSBsaXN0ZW5PbmNlKGVsZU9yV2luZG93LCAnbG9hZHN0YXJ0JywgcmVzb2x2ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVubGlzdGVuTG9hZCA9IGxpc3Rlbk9uY2UoZWxlT3JXaW5kb3csICdsb2FkJywgcmVzb2x2ZSk7XG4gICAgfVxuICAgIC8vIEZvciBlbGVtZW50cywgdW5saXN0ZW4gb24gZXJyb3IgKGRvbid0IGZvciBXaW5kb3dzKS5cbiAgICBpZiAodGFnTmFtZSkge1xuICAgICAgdW5saXN0ZW5FcnJvciA9IGxpc3Rlbk9uY2UoZWxlT3JXaW5kb3csICdlcnJvcicsIHJlamVjdCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gbG9hZGluZ1Byb21pc2UudGhlbigoKSA9PiB7XG4gICAgaWYgKHVubGlzdGVuRXJyb3IpIHtcbiAgICAgIHVubGlzdGVuRXJyb3IoKTtcbiAgICB9XG4gICAgcmV0dXJuIGVsZU9yV2luZG93O1xuICB9LCAoKSA9PiB7XG4gICAgaWYgKHVubGlzdGVuTG9hZCkge1xuICAgICAgdW5saXN0ZW5Mb2FkKCk7XG4gICAgfVxuICAgIGZhaWxlZFRvTG9hZChlbGVPcldpbmRvdyk7XG4gIH0pO1xufVxuXG4vKipcbiAqIEVtaXQgZXJyb3Igb24gbG9hZCBmYWlsdXJlLlxuICogQHBhcmFtIHshRWxlbWVudHwhV2luZG93fSBlbGVPcldpbmRvdyBTdXBwb3J0cyBib3RoIEVsZW1lbnRzIGFuZCBhcyBhIHNwZWNpYWxcbiAqICAgICBjYXNlIFdpbmRvd3MuXG4gKi9cbmZ1bmN0aW9uIGZhaWxlZFRvTG9hZChlbGVPcldpbmRvdykge1xuICAvLyBSZXBvcnQgZmFpbGVkIGxvYWRzIGFzIHVzZXIgZXJyb3JzIHNvIHRoYXQgdGhleSBhdXRvbWF0aWNhbGx5IGdvXG4gIC8vIGludG8gdGhlIFwiZG9jdW1lbnQgZXJyb3JcIiBidWNrZXQuXG4gIGxldCB0YXJnZXQgPSBlbGVPcldpbmRvdztcbiAgaWYgKHRhcmdldCAmJiB0YXJnZXQuc3JjKSB7XG4gICAgdGFyZ2V0ID0gdGFyZ2V0LnNyYztcbiAgfVxuICB0aHJvdyB1c2VyKCkuY3JlYXRlRXJyb3IoTE9BRF9GQUlMVVJFX1BSRUZJWCwgdGFyZ2V0KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBlcnJvciBtZXNzYWdlIGlzIHdhcyBjcmVhdGVkIGZvciBhIGxvYWQgZXJyb3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBBbiBlcnJvciBtZXNzYWdlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNMb2FkRXJyb3JNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgcmV0dXJuIG1lc3NhZ2UuaW5kZXhPZihMT0FEX0ZBSUxVUkVfUFJFRklYKSAhPSAtMTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgRXhwZXJpbWVudHMgc3lzdGVtIGFsbG93cyBhIGRldmVsb3BlciB0byBvcHQtaW4gdG8gdGVzdFxuICogZmVhdHVyZXMgdGhhdCBhcmUgbm90IHlldCBmdWxseSB0ZXN0ZWQuXG4gKlxuICogRXhwZXJpbWVudHMgcGFnZTogaHR0cHM6Ly9jZG4uYW1wcHJvamVjdC5vcmcvZXhwZXJpbWVudHMuaHRtbCAqXG4gKi9cblxuaW1wb3J0IHtnZXRDb29raWUsIHNldENvb2tpZX0gZnJvbSAnLi9jb29raWVzJztcbmltcG9ydCB7aGFzT3dufSBmcm9tICcuL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge3BhcnNlUXVlcnlTdHJpbmd9IGZyb20gJy4vdXJsJztcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgQ09PS0lFX05BTUUgPSAnQU1QX0VYUCc7XG5cbi8qKiBAY29uc3Qge251bWJlcn0gKi9cbmNvbnN0IENPT0tJRV9NQVhfQUdFX0RBWVMgPSAxODA7IC8vIDYgbW9udGhcblxuLyoqIEBjb25zdCB7dGltZX0gKi9cbmNvbnN0IENPT0tJRV9FWFBJUkFUSU9OX0lOVEVSVkFMID0gQ09PS0lFX01BWF9BR0VfREFZUyAqIDI0ICogNjAgKiA2MCAqIDEwMDA7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmNvbnN0IFRPR0dMRVNfV0lORE9XX1BST1BFUlRZID0gJ19fQU1QX19FWFBFUklNRU5UX1RPR0dMRVMnO1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGlzVHJhZmZpY0VsaWdpYmxlOiBmdW5jdGlvbighV2luZG93KTpib29sZWFuLFxuICogICBicmFuY2hlczogIUFycmF5PHN0cmluZz5cbiAqIH19XG4gKi9cbmV4cG9ydCBsZXQgRXhwZXJpbWVudEluZm87XG5cbi8qKlxuICogV2hldGhlciB3ZSBhcmUgaW4gY2FuYXJ5LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0NhbmFyeSh3aW4pIHtcbiAgcmV0dXJuICEhKHdpbi5BTVBfQ09ORklHICYmIHdpbi5BTVBfQ09ORklHLmNhbmFyeSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBiaW5hcnkgdHlwZSwgZS5nLiwgY2FuYXJ5LCBjb250cm9sLCBvciBwcm9kdWN0aW9uLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEJpbmFyeVR5cGUod2luKSB7XG4gIHJldHVybiB3aW4uQU1QX0NPTkZJRyAmJiB3aW4uQU1QX0NPTkZJRy50eXBlID9cbiAgICB3aW4uQU1QX0NPTkZJRy50eXBlIDogJ3Vua25vd24nO1xufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHNwZWNpZmllZCBleHBlcmltZW50IGlzIG9uIG9yIG9mZi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gZXhwZXJpbWVudElkXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNFeHBlcmltZW50T24od2luLCBleHBlcmltZW50SWQpIHtcbiAgY29uc3QgdG9nZ2xlcyA9IGV4cGVyaW1lbnRUb2dnbGVzKHdpbik7XG4gIHJldHVybiAhIXRvZ2dsZXNbZXhwZXJpbWVudElkXTtcbn1cblxuLyoqXG4gKiBUb2dnbGVzIHRoZSBleHBlcmltZW50IG9uIG9yIG9mZi4gUmV0dXJucyB0aGUgYWN0dWFsIHZhbHVlIG9mIHRoZSBleHBlcmltZW50XG4gKiBhZnRlciB0b2dnbGluZyBpcyBkb25lLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHBlcmltZW50SWRcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9vblxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X3RyYW5zaWVudEV4cGVyaW1lbnQgIFdoZXRoZXIgdG8gdG9nZ2xlIHRoZVxuICogICAgIGV4cGVyaW1lbnQgc3RhdGUgXCJ0cmFuc2llbnRseVwiIChpLmUuLCBmb3IgdGhpcyBwYWdlIGxvYWQgb25seSkgb3JcbiAqICAgICBkdXJhYmx5IChieSBzYXZpbmcgdGhlIGV4cGVyaW1lbnQgSURzIHRvIHRoZSBjb29raWUgYWZ0ZXIgdG9nZ2xpbmcpLlxuICogICAgIERlZmF1bHQ6IGZhbHNlIChzYXZlIGR1cmFibHkpLlxuICogQHJldHVybiB7Ym9vbGVhbn0gTmV3IHN0YXRlIGZvciBleHBlcmltZW50SWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGVFeHBlcmltZW50KHdpbiwgZXhwZXJpbWVudElkLCBvcHRfb24sXG4gIG9wdF90cmFuc2llbnRFeHBlcmltZW50KSB7XG4gIGNvbnN0IGN1cnJlbnRseU9uID0gaXNFeHBlcmltZW50T24od2luLCAvKk9LKi9leHBlcmltZW50SWQpO1xuICBjb25zdCBvbiA9ICEhKG9wdF9vbiAhPT0gdW5kZWZpbmVkID8gb3B0X29uIDogIWN1cnJlbnRseU9uKTtcbiAgaWYgKG9uICE9IGN1cnJlbnRseU9uKSB7XG4gICAgY29uc3QgdG9nZ2xlcyA9IGV4cGVyaW1lbnRUb2dnbGVzKHdpbik7XG4gICAgdG9nZ2xlc1tleHBlcmltZW50SWRdID0gb247XG5cbiAgICBpZiAoIW9wdF90cmFuc2llbnRFeHBlcmltZW50KSB7XG4gICAgICBjb25zdCBjb29raWVUb2dnbGVzID0gZ2V0RXhwZXJpbWVudFRvZ2dsZXNGcm9tQ29va2llKHdpbik7XG4gICAgICBjb29raWVUb2dnbGVzW2V4cGVyaW1lbnRJZF0gPSBvbjtcbiAgICAgIHNhdmVFeHBlcmltZW50VG9nZ2xlc1RvQ29va2llKHdpbiwgY29va2llVG9nZ2xlcyk7XG4gICAgfVxuICB9XG4gIHJldHVybiBvbjtcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgd2hldGhlciB0aGUgZXhwZXJpbWVudCBpcyBvbiBvciBvZmYgYmFzZWQgb2ZmIG9mIHRoZVxuICogY29va2llRmxhZyBvciB0aGUgZ2xvYmFsIGNvbmZpZyBmcmVxdWVuY3kgZ2l2ZW4uXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IU9iamVjdDxzdHJpbmcsIGJvb2xlYW4+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhwZXJpbWVudFRvZ2dsZXMod2luKSB7XG4gIGlmICh3aW5bVE9HR0xFU19XSU5ET1dfUFJPUEVSVFldKSB7XG4gICAgcmV0dXJuIHdpbltUT0dHTEVTX1dJTkRPV19QUk9QRVJUWV07XG4gIH1cbiAgd2luW1RPR0dMRVNfV0lORE9XX1BST1BFUlRZXSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIGNvbnN0IHRvZ2dsZXMgPSB3aW5bVE9HR0xFU19XSU5ET1dfUFJPUEVSVFldO1xuXG4gIC8vIFJlYWQgdGhlIGRlZmF1bHQgY29uZmlnIG9mIHRoaXMgYnVpbGQuXG4gIGlmICh3aW4uQU1QX0NPTkZJRykge1xuICAgIGZvciAoY29uc3QgZXhwZXJpbWVudElkIGluIHdpbi5BTVBfQ09ORklHKSB7XG4gICAgICBjb25zdCBmcmVxdWVuY3kgPSB3aW4uQU1QX0NPTkZJR1tleHBlcmltZW50SWRdO1xuICAgICAgaWYgKHR5cGVvZiBmcmVxdWVuY3kgPT09ICdudW1iZXInICYmIGZyZXF1ZW5jeSA+PSAwICYmIGZyZXF1ZW5jeSA8PSAxKSB7XG4gICAgICAgIHRvZ2dsZXNbZXhwZXJpbWVudElkXSA9IE1hdGgucmFuZG9tKCkgPCBmcmVxdWVuY3k7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIC8vIFJlYWQgZG9jdW1lbnQgbGV2ZWwgb3ZlcnJpZGUgZnJvbSBtZXRhIHRhZy5cbiAgaWYgKHdpbi5BTVBfQ09ORklHXG4gICAgICAmJiBBcnJheS5pc0FycmF5KHdpbi5BTVBfQ09ORklHWydhbGxvdy1kb2Mtb3B0LWluJ10pXG4gICAgICAmJiB3aW4uQU1QX0NPTkZJR1snYWxsb3ctZG9jLW9wdC1pbiddLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCBhbGxvd2VkID0gd2luLkFNUF9DT05GSUdbJ2FsbG93LWRvYy1vcHQtaW4nXTtcbiAgICBjb25zdCBtZXRhID1cbiAgICAgICAgd2luLmRvY3VtZW50LmhlYWQucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPVwiYW1wLWV4cGVyaW1lbnRzLW9wdC1pblwiXScpO1xuICAgIGlmIChtZXRhKSB7XG4gICAgICBjb25zdCBvcHRlZEluRXhwZXJpbWVudHMgPSBtZXRhLmdldEF0dHJpYnV0ZSgnY29udGVudCcpLnNwbGl0KCcsJyk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wdGVkSW5FeHBlcmltZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoYWxsb3dlZC5pbmRleE9mKG9wdGVkSW5FeHBlcmltZW50c1tpXSkgIT0gLTEpIHtcbiAgICAgICAgICB0b2dnbGVzW29wdGVkSW5FeHBlcmltZW50c1tpXV0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgT2JqZWN0LmFzc2lnbih0b2dnbGVzLCBnZXRFeHBlcmltZW50VG9nZ2xlc0Zyb21Db29raWUod2luKSk7XG5cbiAgaWYgKHdpbi5BTVBfQ09ORklHXG4gICAgICAmJiBBcnJheS5pc0FycmF5KHdpbi5BTVBfQ09ORklHWydhbGxvdy11cmwtb3B0LWluJ10pXG4gICAgICAmJiB3aW4uQU1QX0NPTkZJR1snYWxsb3ctdXJsLW9wdC1pbiddLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCBhbGxvd2VkID0gd2luLkFNUF9DT05GSUdbJ2FsbG93LXVybC1vcHQtaW4nXTtcbiAgICBjb25zdCBoYXNoID0gd2luLmxvY2F0aW9uLm9yaWdpbmFsSGFzaCB8fCB3aW4ubG9jYXRpb24uaGFzaDtcbiAgICBjb25zdCBwYXJhbXMgPSBwYXJzZVF1ZXJ5U3RyaW5nKGhhc2gpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWxsb3dlZC5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgcGFyYW0gPSBwYXJhbXNbYGUtJHthbGxvd2VkW2ldfWBdO1xuICAgICAgaWYgKHBhcmFtID09ICcxJykge1xuICAgICAgICB0b2dnbGVzW2FsbG93ZWRbaV1dID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmIChwYXJhbSA9PSAnMCcpIHtcbiAgICAgICAgdG9nZ2xlc1thbGxvd2VkW2ldXSA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gdG9nZ2xlcztcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBjYWNoZWQgZXhwZXJpbWVudHMgdG9nZ2xlcywgb3IgbnVsbCBpZiB0aGV5IGhhdmUgbm90IGJlZW5cbiAqIGNvbXB1dGVkIHlldC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtPYmplY3Q8c3RyaW5nLCBib29sZWFuPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4cGVyaW1lbnRUb2dnbGVzT3JOdWxsKHdpbikge1xuICByZXR1cm4gd2luW1RPR0dMRVNfV0lORE9XX1BST1BFUlRZXSB8fCBudWxsO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBzZXQgb2YgZXhwZXJpbWVudCBJRHMgY3VycmVudGx5IG9uLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPn1cbiAqL1xuZnVuY3Rpb24gZ2V0RXhwZXJpbWVudFRvZ2dsZXNGcm9tQ29va2llKHdpbikge1xuICBjb25zdCBleHBlcmltZW50Q29va2llID0gZ2V0Q29va2llKHdpbiwgQ09PS0lFX05BTUUpO1xuICBjb25zdCB0b2tlbnMgPSBleHBlcmltZW50Q29va2llID8gZXhwZXJpbWVudENvb2tpZS5zcGxpdCgvXFxzKixcXHMqL2cpIDogW107XG5cbiAgY29uc3QgdG9nZ2xlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdG9rZW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKHRva2Vuc1tpXS5sZW5ndGggPT0gMCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmICh0b2tlbnNbaV1bMF0gPT0gJy0nKSB7XG4gICAgICB0b2dnbGVzW3Rva2Vuc1tpXS5zdWJzdHIoMSldID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRvZ2dsZXNbdG9rZW5zW2ldXSA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRvZ2dsZXM7XG59XG5cbi8qKlxuICogU2F2ZXMgYSBzZXQgb2YgZXhwZXJpbWVudCBJRHMgY3VycmVudGx5IG9uLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsIGJvb2xlYW4+fSB0b2dnbGVzXG4gKi9cbmZ1bmN0aW9uIHNhdmVFeHBlcmltZW50VG9nZ2xlc1RvQ29va2llKHdpbiwgdG9nZ2xlcykge1xuICBjb25zdCBleHBlcmltZW50SWRzID0gW107XG4gIGZvciAoY29uc3QgZXhwZXJpbWVudCBpbiB0b2dnbGVzKSB7XG4gICAgZXhwZXJpbWVudElkcy5wdXNoKCh0b2dnbGVzW2V4cGVyaW1lbnRdID09PSBmYWxzZSA/ICctJyA6ICcnKSArIGV4cGVyaW1lbnQpO1xuICB9XG5cbiAgc2V0Q29va2llKHdpbiwgQ09PS0lFX05BTUUsIGV4cGVyaW1lbnRJZHMuam9pbignLCcpLFxuICAgICAgRGF0ZS5ub3coKSArIENPT0tJRV9FWFBJUkFUSU9OX0lOVEVSVkFMLCB7XG4gICAgICAgIC8vIFNldCBleHBsaWNpdCBkb21haW4sIHNvIHRoZSBjb29raWUgZ2V0cyBzZW5kIHRvIHN1YiBkb21haW5zLlxuICAgICAgICBkb21haW46IHdpbi5sb2NhdGlvbi5ob3N0bmFtZSxcbiAgICAgICAgYWxsb3dPblByb3h5T3JpZ2luOiB0cnVlLFxuICAgICAgfSk7XG59XG5cbi8qKlxuICogU2VlIGdldEV4cGVyaW1lbnRUb2dnbGVzRnJvbUNvb2tpZSgpLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPn1cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXhwZXJpbWVudFRvZ2xlc0Zyb21Db29raWVGb3JUZXN0aW5nKHdpbikge1xuICByZXR1cm4gZ2V0RXhwZXJpbWVudFRvZ2dsZXNGcm9tQ29va2llKHdpbik7XG59XG5cbi8qKlxuICogUmVzZXRzIHRoZSBleHBlcmltZW50c1RvZ2dsZSBjYWNoZSBmb3IgdGVzdGluZyBwdXJwb3Nlcy5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0RXhwZXJpbWVudFRvZ2dsZXNGb3JUZXN0aW5nKHdpbikge1xuICBzZXRDb29raWUod2luLCBDT09LSUVfTkFNRSwgJycsIDAsIHtcbiAgICBkb21haW46IHdpbi5sb2NhdGlvbi5ob3N0bmFtZSxcbiAgfSk7XG4gIHdpbltUT0dHTEVTX1dJTkRPV19QUk9QRVJUWV0gPSBudWxsO1xufVxuXG4vKipcbiAqIEluIHNvbWUgYnJvd3NlciBpbXBsZW1lbnRhdGlvbnMgb2YgTWF0aC5yYW5kb20oKSwgc2VxdWVudGlhbCBjYWxscyBvZlxuICogTWF0aC5yYW5kb20oKSBhcmUgY29ycmVsYXRlZCBhbmQgY2FuIGNhdXNlIGEgYmlhcy4gIEluIHBhcnRpY3VsYXIsXG4gKiBpZiB0aGUgcHJldmlvdXMgcmFuZG9tKCkgY2FsbCB3YXMgPCAwLjAwMSAoYXMgaXQgd2lsbCBiZSBpZiB3ZSBzZWxlY3RcbiAqIGludG8gYW4gZXhwZXJpbWVudCksIHRoZSBuZXh0IHZhbHVlIGNvdWxkIGJlIGxlc3MgdGhhbiAwLjUgbW9yZSB0aGFuXG4gKiA1MC43JSBvZiB0aGUgdGltZS4gIFRoaXMgcHJvdmlkZXMgYW4gaW1wbGVtZW50YXRpb24gdGhhdCByb290cyBkb3duIGludG9cbiAqIHRoZSBjcnlwdG8gQVBJLCB3aGVuIGF2YWlsYWJsZSwgdG8gcHJvZHVjZSBsZXNzIGJpYXNlZCBzYW1wbGVzLlxuICpcbiAqIEByZXR1cm4ge251bWJlcn0gUHNldWRvLXJhbmRvbSBmbG9hdGluZy1wb2ludCB2YWx1ZSBvbiB0aGUgcmFuZ2UgWzAsIDEpLlxuICovXG5mdW5jdGlvbiBzbG93QnV0QWNjdXJhdGVQcm5nKCkge1xuICAvLyBUT0RPKHRkcmwpOiBJbXBsZW1lbnQuXG4gIHJldHVybiBNYXRoLnJhbmRvbSgpO1xufVxuXG4vKipcbiAqIENvbnRhaW5lciBmb3IgYWx0ZXJuYXRlIHJhbmRvbSBudW1iZXIgZ2VuZXJhdG9yIGltcGxlbWVudGF0aW9ucy4gIFRoaXNcbiAqIGFsbG93cyB1cyB0byBzZXQgYW4gXCJhY2N1cmF0ZVwiIFBSTkcgZm9yIGJyYW5jaCBzZWxlY3Rpb24sIGJ1dCB0byBtb2NrIGl0XG4gKiBvdXQgZWFzaWx5IGluIHRlc3RzLlxuICpcbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICogQGNvbnN0IHshe2FjY3VyYXRlUHJuZzogZnVuY3Rpb24oKTpudW1iZXJ9fVxuICovXG5leHBvcnQgY29uc3QgUkFORE9NX05VTUJFUl9HRU5FUkFUT1JTID0ge1xuICBhY2N1cmF0ZVBybmc6IHNsb3dCdXRBY2N1cmF0ZVBybmcsXG59O1xuXG4vKipcbiAqIFNlbGVjdHMsIHVuaWZvcm1seSBhdCByYW5kb20sIGEgc2luZ2xlIGl0ZW0gZnJvbSB0aGUgYXJyYXkuXG4gKiBAcGFyYW0geyFBcnJheTxzdHJpbmc+fSBhcnIgT2JqZWN0IHRvIHNlbGVjdCBmcm9tLlxuICogQHJldHVybiB7P3N0cmluZ30gU2luZ2xlIGl0ZW0gZnJvbSBhcnIgb3IgbnVsbCBpZiBhcnIgd2FzIGVtcHR5LlxuICovXG5mdW5jdGlvbiBzZWxlY3RSYW5kb21JdGVtKGFycikge1xuICBjb25zdCBybiA9IFJBTkRPTV9OVU1CRVJfR0VORVJBVE9SUy5hY2N1cmF0ZVBybmcoKTtcbiAgcmV0dXJuIGFycltNYXRoLmZsb29yKHJuICogYXJyLmxlbmd0aCldIHx8IG51bGw7XG59XG5cbi8qKlxuICogU2VsZWN0cyB3aGljaCBwYWdlLWxldmVsIGV4cGVyaW1lbnQgYnJhbmNoZXMgYXJlIGVuYWJsZWQuIElmIGEgZ2l2ZW5cbiAqIGV4cGVyaW1lbnQgbmFtZSBpcyBhbHJlYWR5IHNldCAoaW5jbHVkaW5nIHRvIHRoZSBudWxsIC8gbm8gYnJhbmNoZXMgc2VsZWN0ZWRcbiAqIHN0YXRlKSwgdGhpcyB3b24ndCBhbHRlciBpdHMgc3RhdGUuXG4gKlxuICogQ2hlY2sgd2hldGhlciBhIGdpdmVuIGV4cGVyaW1lbnQgaXMgc2V0IHVzaW5nIGlzRXhwZXJpbWVudE9uKHdpbixcbiAqIGV4cGVyaW1lbnROYW1lKSBhbmQsIGlmIGl0IGlzIG9uLCBsb29rIGZvciB3aGljaCBicmFuY2ggaXMgc2VsZWN0ZWQgaW5cbiAqIHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luIFdpbmRvdyBjb250ZXh0IG9uIHdoaWNoIHRvIHNhdmUgZXhwZXJpbWVudFxuICogICAgIHNlbGVjdGlvbiBzdGF0ZS5cbiAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICFFeHBlcmltZW50SW5mbz59IGV4cGVyaW1lbnRzICBTZXQgb2YgZXhwZXJpbWVudHMgdG9cbiAqICAgICBjb25maWd1cmUgZm9yIHRoaXMgcGFnZSBsb2FkLlxuICogQHJldHVybiB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59IE1hcCBvZiBleHBlcmltZW50IG5hbWVzIHRvIHNlbGVjdGVkXG4gKiAgICAgYnJhbmNoZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByYW5kb21seVNlbGVjdFVuc2V0RXhwZXJpbWVudHMod2luLCBleHBlcmltZW50cykge1xuICB3aW4uZXhwZXJpbWVudEJyYW5jaGVzID0gd2luLmV4cGVyaW1lbnRCcmFuY2hlcyB8fCB7fTtcbiAgY29uc3Qgc2VsZWN0ZWRFeHBlcmltZW50cyA9IHt9O1xuICBmb3IgKGNvbnN0IGV4cGVyaW1lbnROYW1lIGluIGV4cGVyaW1lbnRzKSB7XG4gICAgLy8gU2tpcCBleHBlcmltZW50TmFtZSBpZiBpdCBpcyBub3QgYSBrZXkgb2YgZXhwZXJpbWVudHMgb2JqZWN0IG9yIGlmIGl0XG4gICAgLy8gaGFzIGFscmVhZHkgYmVlbiBwb3B1bGF0ZWQgYnkgc29tZSBvdGhlciBwcm9wZXJ0eS5cbiAgICBpZiAoIWhhc093bihleHBlcmltZW50cywgZXhwZXJpbWVudE5hbWUpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKGhhc093bih3aW4uZXhwZXJpbWVudEJyYW5jaGVzLCBleHBlcmltZW50TmFtZSkpIHtcbiAgICAgIHNlbGVjdGVkRXhwZXJpbWVudHNbZXhwZXJpbWVudE5hbWVdID1cbiAgICAgICAgICB3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmICghZXhwZXJpbWVudHNbZXhwZXJpbWVudE5hbWVdLmlzVHJhZmZpY0VsaWdpYmxlIHx8XG4gICAgICAgICFleHBlcmltZW50c1tleHBlcmltZW50TmFtZV0uaXNUcmFmZmljRWxpZ2libGUod2luKSkge1xuICAgICAgd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV0gPSBudWxsO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgLy8gSWYgd2UncmUgaW4gdGhlIGV4cGVyaW1lbnQsIGJ1dCB3ZSBoYXZlbid0IGFscmVhZHkgZm9yY2VkIGEgc3BlY2lmaWNcbiAgICAvLyBleHBlcmltZW50IGJyYW5jaCAoZS5nLiwgdmlhIGEgdGVzdCBzZXR1cCksIHRoZW4gcmFuZG9taXplIHRoZSBicmFuY2hcbiAgICAvLyBjaG9pY2UuXG4gICAgaWYgKCF3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXSAmJlxuICAgICAgaXNFeHBlcmltZW50T24od2luLCAvKk9LKi9leHBlcmltZW50TmFtZSkpIHtcbiAgICAgIGNvbnN0IHticmFuY2hlc30gPSBleHBlcmltZW50c1tleHBlcmltZW50TmFtZV07XG4gICAgICB3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXSA9IHNlbGVjdFJhbmRvbUl0ZW0oYnJhbmNoZXMpO1xuICAgICAgc2VsZWN0ZWRFeHBlcmltZW50c1tleHBlcmltZW50TmFtZV0gPVxuICAgICAgICAgIHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdO1xuICAgIH1cbiAgfVxuICByZXR1cm4gc2VsZWN0ZWRFeHBlcmltZW50cztcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBleHBlcmltZW50IGJyYW5jaCBlbmFibGVkIGZvciB0aGUgZ2l2ZW4gZXhwZXJpbWVudCBJRC5cbiAqIEZvciBleGFtcGxlLCAnY29udHJvbCcgb3IgJ2V4cGVyaW1lbnQnLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luIFdpbmRvdyBjb250ZXh0IHRvIGNoZWNrIGZvciBleHBlcmltZW50IHN0YXRlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4cGVyaW1lbnROYW1lIE5hbWUgb2YgdGhlIGV4cGVyaW1lbnQgdG8gY2hlY2suXG4gKiBAcmV0dXJuIHs/c3RyaW5nfSBBY3RpdmUgZXhwZXJpbWVudCBicmFuY2ggSUQgZm9yIGV4cGVyaW1lbnROYW1lIChwb3NzaWJseVxuICogICAgIG51bGwgaWYgZXhwZXJpbWVudE5hbWUgaGFzIGJlZW4gdGVzdGVkIGJ1dCBubyBicmFuY2ggd2FzIGVuYWJsZWQpLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXhwZXJpbWVudEJyYW5jaCh3aW4sIGV4cGVyaW1lbnROYW1lKSB7XG4gIHJldHVybiB3aW4uZXhwZXJpbWVudEJyYW5jaGVzID8gd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV0gOiBudWxsO1xufVxuXG4vKipcbiAqIEZvcmNlIGVuYWJsZSAob3IgZGlzYWJsZSkgYSBzcGVjaWZpYyBicmFuY2ggb2YgYSBnaXZlbiBleHBlcmltZW50IG5hbWUuXG4gKiBEaXNhYmxlcyB0aGUgZXhwZXJpbWVudCBuYW1lIGFsdG9nZXRoZXIgaWYgYnJhbmNoSWQgaXMgZmFsc2Vpc2guXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW4gV2luZG93IGNvbnRleHQgdG8gY2hlY2sgZm9yIGV4cGVyaW1lbnQgc3RhdGUuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXhwZXJpbWVudE5hbWUgTmFtZSBvZiB0aGUgZXhwZXJpbWVudCB0byBjaGVjay5cbiAqIEBwYXJhbSB7P3N0cmluZ30gYnJhbmNoSWQgSUQgb2YgYnJhbmNoIHRvIGZvcmNlIG9yIG51bGwgdG8gZGlzYWJsZVxuICogICAgIGFsdG9nZXRoZXIuXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZvcmNlRXhwZXJpbWVudEJyYW5jaCh3aW4sIGV4cGVyaW1lbnROYW1lLCBicmFuY2hJZCkge1xuICB3aW4uZXhwZXJpbWVudEJyYW5jaGVzID0gd2luLmV4cGVyaW1lbnRCcmFuY2hlcyB8fCB7fTtcbiAgdG9nZ2xlRXhwZXJpbWVudCh3aW4sIGV4cGVyaW1lbnROYW1lLCAhIWJyYW5jaElkLCB0cnVlKTtcbiAgd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV0gPSBicmFuY2hJZDtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2FkZEF0dHJpYnV0ZXNUb0VsZW1lbnQsIGNsb3Nlc3RCeVNlbGVjdG9yfSBmcm9tICcuL2RvbSc7XG5pbXBvcnQge2Rlc2VyaWFsaXplTWVzc2FnZSwgaXNBbXBNZXNzYWdlfSBmcm9tICcuLzNwLWZyYW1lLW1lc3NhZ2luZyc7XG5pbXBvcnQge2Rldn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtkaWN0fSBmcm9tICcuL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge2ZpbHRlclNwbGljZX0gZnJvbSAnLi91dGlscy9hcnJheSc7XG5pbXBvcnQge2dldERhdGF9IGZyb20gJy4vZXZlbnQtaGVscGVyJztcbmltcG9ydCB7cGFyc2VVcmxEZXByZWNhdGVkfSBmcm9tICcuL3VybCc7XG5pbXBvcnQge3NldFN0eWxlfSBmcm9tICcuL3N0eWxlJztcbmltcG9ydCB7dHJ5UGFyc2VKc29ufSBmcm9tICcuL2pzb24nO1xuXG4vKipcbiAqIFNlbnRpbmVsIHVzZWQgdG8gZm9yY2UgdW5saXN0ZW5pbmcgYWZ0ZXIgYSBpZnJhbWUgaXMgZGV0YWNoZWQuXG4gKiBAdHlwZSB7c3RyaW5nfVxuICovXG5jb25zdCBVTkxJU1RFTl9TRU5USU5FTCA9ICd1bmxpc3Rlbic7XG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgZnJhbWU6ICFFbGVtZW50LFxuICogICBldmVudHM6ICFPYmplY3Q8c3RyaW5nLCAhQXJyYXk8ZnVuY3Rpb24oIUpzb25PYmplY3QpPj5cbiAqIH19XG4gKi9cbmxldCBXaW5kb3dFdmVudHNEZWY7XG5cbi8qKlxuICogUmV0dXJucyBhIG1hcHBpbmcgZnJvbSBhIFVSTCdzIG9yaWdpbiB0byBhbiBhcnJheSBvZiB3aW5kb3dzIGFuZCB0aGVpclxuICogbGlzdGVuRm9yIGxpc3RlbmVycy5cbiAqIEBwYXJhbSB7P1dpbmRvd30gcGFyZW50V2luIHRoZSB3aW5kb3cgdGhhdCBjcmVhdGVkIHRoZSBpZnJhbWVcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9jcmVhdGUgY3JlYXRlIHRoZSBtYXBwaW5nIGlmIGl0IGRvZXMgbm90IGV4aXN0XG4gKiBAcmV0dXJuIHs/T2JqZWN0PHN0cmluZywgIUFycmF5PCFXaW5kb3dFdmVudHNEZWY+Pn1cbiAqL1xuZnVuY3Rpb24gZ2V0TGlzdGVuRm9ycyhwYXJlbnRXaW4sIG9wdF9jcmVhdGUpIHtcbiAgbGV0IHtsaXN0ZW5pbmdGb3JzfSA9IHBhcmVudFdpbjtcblxuICBpZiAoIWxpc3RlbmluZ0ZvcnMgJiYgb3B0X2NyZWF0ZSkge1xuICAgIGxpc3RlbmluZ0ZvcnMgPSBwYXJlbnRXaW4ubGlzdGVuaW5nRm9ycyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIH1cbiAgcmV0dXJuIGxpc3RlbmluZ0ZvcnMgfHwgbnVsbDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFuIGFycmF5IG9mIFdpbmRvd0V2ZW50c0RlZiB0aGF0IGhhdmUgaGFkIGFueSBsaXN0ZW5Gb3IgbGlzdGVuZXJzXG4gKiByZWdpc3RlcmVkIGZvciB0aGlzIHNlbnRpbmVsLlxuICogQHBhcmFtIHs/V2luZG93fSBwYXJlbnRXaW4gdGhlIHdpbmRvdyB0aGF0IGNyZWF0ZWQgdGhlIGlmcmFtZVxuICogQHBhcmFtIHtzdHJpbmd9IHNlbnRpbmVsIHRoZSBzZW50aW5lbCBvZiB0aGUgbWVzc2FnZVxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2NyZWF0ZSBjcmVhdGUgdGhlIGFycmF5IGlmIGl0IGRvZXMgbm90IGV4aXN0XG4gKiBAcmV0dXJuIHs/QXJyYXk8IVdpbmRvd0V2ZW50c0RlZj59XG4gKi9cbmZ1bmN0aW9uIGdldExpc3RlbkZvclNlbnRpbmVsKHBhcmVudFdpbiwgc2VudGluZWwsIG9wdF9jcmVhdGUpIHtcbiAgY29uc3QgbGlzdGVuaW5nRm9ycyA9IGdldExpc3RlbkZvcnMocGFyZW50V2luLCBvcHRfY3JlYXRlKTtcbiAgaWYgKCFsaXN0ZW5pbmdGb3JzKSB7XG4gICAgcmV0dXJuIGxpc3RlbmluZ0ZvcnM7XG4gIH1cblxuICBsZXQgbGlzdGVuU2VudGluZWwgPSBsaXN0ZW5pbmdGb3JzW3NlbnRpbmVsXTtcbiAgaWYgKCFsaXN0ZW5TZW50aW5lbCAmJiBvcHRfY3JlYXRlKSB7XG4gICAgbGlzdGVuU2VudGluZWwgPSBsaXN0ZW5pbmdGb3JzW3NlbnRpbmVsXSA9IFtdO1xuICB9XG4gIHJldHVybiBsaXN0ZW5TZW50aW5lbCB8fCBudWxsO1xufVxuXG4vKipcbiAqIFJldHVybnMgYW4gbWFwcGluZyBvZiBldmVudCBuYW1lcyB0byBsaXN0ZW5Gb3IgbGlzdGVuZXJzLlxuICogQHBhcmFtIHs/V2luZG93fSBwYXJlbnRXaW4gdGhlIHdpbmRvdyB0aGF0IGNyZWF0ZWQgdGhlIGlmcmFtZVxuICogQHBhcmFtIHshRWxlbWVudH0gaWZyYW1lIHRoZSBpZnJhbWUgZWxlbWVudCB3aG8ncyBjb250ZXh0IHdpbGwgdHJpZ2dlciB0aGVcbiAqICAgICBldmVudFxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2lzM1Agc2V0IHRvIHRydWUgaWYgdGhlIGlmcmFtZSBpcyAzcC5cbiAqIEByZXR1cm4gez9PYmplY3Q8c3RyaW5nLCAhQXJyYXk8ZnVuY3Rpb24oIUpzb25PYmplY3QsICFXaW5kb3csIHN0cmluZyk+Pn1cbiAqL1xuZnVuY3Rpb24gZ2V0T3JDcmVhdGVMaXN0ZW5Gb3JFdmVudHMocGFyZW50V2luLCBpZnJhbWUsIG9wdF9pczNQKSB7XG4gIGNvbnN0IHtvcmlnaW59ID0gcGFyc2VVcmxEZXByZWNhdGVkKGlmcmFtZS5zcmMpO1xuICBjb25zdCBzZW50aW5lbCA9IGdldFNlbnRpbmVsXyhpZnJhbWUsIG9wdF9pczNQKTtcbiAgY29uc3QgbGlzdGVuU2VudGluZWwgPSBnZXRMaXN0ZW5Gb3JTZW50aW5lbChwYXJlbnRXaW4sIHNlbnRpbmVsLCB0cnVlKTtcblxuICBsZXQgd2luZG93RXZlbnRzO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3RlblNlbnRpbmVsLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qgd2UgPSBsaXN0ZW5TZW50aW5lbFtpXTtcbiAgICBpZiAod2UuZnJhbWUgPT09IGlmcmFtZSkge1xuICAgICAgd2luZG93RXZlbnRzID0gd2U7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICBpZiAoIXdpbmRvd0V2ZW50cykge1xuICAgIHdpbmRvd0V2ZW50cyA9IHtcbiAgICAgIGZyYW1lOiBpZnJhbWUsXG4gICAgICBvcmlnaW4sXG4gICAgICBldmVudHM6IE9iamVjdC5jcmVhdGUobnVsbCksXG4gICAgfTtcbiAgICBsaXN0ZW5TZW50aW5lbC5wdXNoKHdpbmRvd0V2ZW50cyk7XG4gIH1cblxuICByZXR1cm4gd2luZG93RXZlbnRzLmV2ZW50cztcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFuIG1hcHBpbmcgb2YgZXZlbnQgbmFtZXMgdG8gbGlzdGVuRm9yIGxpc3RlbmVycy5cbiAqIEBwYXJhbSB7P1dpbmRvd30gcGFyZW50V2luIHRoZSB3aW5kb3cgdGhhdCBjcmVhdGVkIHRoZSBpZnJhbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSBzZW50aW5lbCB0aGUgc2VudGluZWwgb2YgdGhlIG1lc3NhZ2VcbiAqIEBwYXJhbSB7c3RyaW5nfSBvcmlnaW4gdGhlIHNvdXJjZSB3aW5kb3cncyBvcmlnaW5cbiAqIEBwYXJhbSB7P1dpbmRvd30gdHJpZ2dlcldpbiB0aGUgd2luZG93IHRoYXQgdHJpZ2dlcmVkIHRoZSBldmVudFxuICogQHJldHVybiB7P09iamVjdDxzdHJpbmcsICFBcnJheTxmdW5jdGlvbighSnNvbk9iamVjdCwgIVdpbmRvdywgc3RyaW5nKT4+fVxuICovXG5mdW5jdGlvbiBnZXRMaXN0ZW5Gb3JFdmVudHMocGFyZW50V2luLCBzZW50aW5lbCwgb3JpZ2luLCB0cmlnZ2VyV2luKSB7XG4gIGNvbnN0IGxpc3RlblNlbnRpbmVsID0gZ2V0TGlzdGVuRm9yU2VudGluZWwocGFyZW50V2luLCBzZW50aW5lbCk7XG5cbiAgaWYgKCFsaXN0ZW5TZW50aW5lbCkge1xuICAgIHJldHVybiBsaXN0ZW5TZW50aW5lbDtcbiAgfVxuXG4gIC8vIEZpbmQgdGhlIGVudHJ5IGZvciB0aGUgZnJhbWUuXG4gIC8vIFRPRE8oQG5la29kbyk6IEFkZCBhIFdlYWtNYXA8V2luZG93LCBXaW5kb3dFdmVudHNEZWY+IGNhY2hlIHRvXG4gIC8vICAgICBzcGVlZCB1cCB0aGlzIHByb2Nlc3MuXG4gIGxldCB3aW5kb3dFdmVudHM7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdGVuU2VudGluZWwubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCB3ZSA9IGxpc3RlblNlbnRpbmVsW2ldO1xuICAgIGNvbnN0IHtjb250ZW50V2luZG93fSA9IHdlLmZyYW1lO1xuICAgIGlmICghY29udGVudFdpbmRvdykge1xuICAgICAgc2V0VGltZW91dChkcm9wTGlzdGVuU2VudGluZWwsIDAsIGxpc3RlblNlbnRpbmVsKTtcbiAgICB9IGVsc2UgaWYgKHNlbnRpbmVsID09PSAnYW1wJykge1xuICAgICAgLy8gQSBub24tM1AgY29kZSBwYXRoLCBvcmlnaW4gbXVzdCBtYXRjaC5cbiAgICAgIGlmICh3ZS5vcmlnaW4gPT09IG9yaWdpbiAmJiBjb250ZW50V2luZG93ID09IHRyaWdnZXJXaW4pIHtcbiAgICAgICAgd2luZG93RXZlbnRzID0gd2U7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHJpZ2dlcldpbiA9PSBjb250ZW50V2luZG93IHx8XG4gICAgICAgIGlzRGVzY2VuZGFudFdpbmRvdyhjb250ZW50V2luZG93LCB0cmlnZ2VyV2luKSkge1xuICAgICAgLy8gM3AgY29kZSBwYXRoLCB3ZSBtYXkgYWNjZXB0IG1lc3NhZ2VzIGZyb20gbmVzdGVkIGZyYW1lcy5cbiAgICAgIHdpbmRvd0V2ZW50cyA9IHdlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHdpbmRvd0V2ZW50cyA/IHdpbmRvd0V2ZW50cy5ldmVudHMgOiBudWxsO1xufVxuXG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIG9uZSB3aW5kb3cgaXMgYSBkZXNjZW5kYW50IG9mIGFub3RoZXIgYnkgY2xpbWJpbmdcbiAqIHRoZSBwYXJlbnQgY2hhaW4uXG4gKiBAcGFyYW0gez9XaW5kb3d9IGFuY2VzdG9yIHBvdGVudGlhbCBhbmNlc3RvciB3aW5kb3dcbiAqIEBwYXJhbSB7P1dpbmRvd30gZGVzY2VuZGFudCBwb3RlbnRpYWwgZGVzY2VuZGFudCB3aW5kb3dcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzRGVzY2VuZGFudFdpbmRvdyhhbmNlc3RvciwgZGVzY2VuZGFudCkge1xuICBmb3IgKGxldCB3aW4gPSBkZXNjZW5kYW50OyB3aW4gJiYgd2luICE9IHdpbi5wYXJlbnQ7IHdpbiA9IHdpbi5wYXJlbnQpIHtcbiAgICBpZiAod2luID09IGFuY2VzdG9yKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIFJlbW92ZXMgYW55IGxpc3RlbkZvcnMgcmVnaXN0ZWQgb24gbGlzdGVuU2VudGluZWwgdGhhdCBkbyBub3QgaGF2ZVxuICogYSBjb250ZW50V2luZG93ICh0aGUgZnJhbWUgd2FzIHJlbW92ZWQgZnJvbSB0aGUgRE9NIHRyZWUpLlxuICogQHBhcmFtIHshQXJyYXk8IVdpbmRvd0V2ZW50c0RlZj59IGxpc3RlblNlbnRpbmVsXG4gKi9cbmZ1bmN0aW9uIGRyb3BMaXN0ZW5TZW50aW5lbChsaXN0ZW5TZW50aW5lbCkge1xuICBjb25zdCBub29wRGF0YSA9IGRpY3QoeydzZW50aW5lbCc6IFVOTElTVEVOX1NFTlRJTkVMfSk7XG5cbiAgZm9yIChsZXQgaSA9IGxpc3RlblNlbnRpbmVsLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgY29uc3Qgd2luZG93RXZlbnRzID0gbGlzdGVuU2VudGluZWxbaV07XG5cbiAgICBpZiAoIXdpbmRvd0V2ZW50cy5mcmFtZS5jb250ZW50V2luZG93KSB7XG4gICAgICBsaXN0ZW5TZW50aW5lbC5zcGxpY2UoaSwgMSk7XG5cbiAgICAgIGNvbnN0IHtldmVudHN9ID0gd2luZG93RXZlbnRzO1xuICAgICAgZm9yIChjb25zdCBuYW1lIGluIGV2ZW50cykge1xuICAgICAgICAvLyBTcGxpY2UgaGVyZSwgc28gdGhhdCBlYWNoIHVubGlzdGVuIGRvZXMgbm90IHNoaWZ0IHRoZSBhcnJheVxuICAgICAgICBldmVudHNbbmFtZV0uc3BsaWNlKDAsIEluZmluaXR5KS5mb3JFYWNoKGV2ZW50ID0+IHtcbiAgICAgICAgICBldmVudChub29wRGF0YSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIFJlZ2lzdGVycyB0aGUgZ2xvYmFsIGxpc3RlbkZvciBldmVudCBsaXN0ZW5lciBpZiBpdCBoYXMgeWV0IHRvIGJlLlxuICogQHBhcmFtIHs/V2luZG93fSBwYXJlbnRXaW5cbiAqL1xuZnVuY3Rpb24gcmVnaXN0ZXJHbG9iYWxMaXN0ZW5lcklmTmVlZGVkKHBhcmVudFdpbikge1xuICBpZiAocGFyZW50V2luLmxpc3RlbmluZ0ZvcnMpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgbGlzdGVuRm9yTGlzdGVuZXIgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGlmICghZ2V0RGF0YShldmVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZGF0YSA9IHBhcnNlSWZOZWVkZWQoZ2V0RGF0YShldmVudCkpO1xuICAgIGlmICghZGF0YSB8fCAhZGF0YVsnc2VudGluZWwnXSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGxpc3RlbkZvckV2ZW50cyA9IGdldExpc3RlbkZvckV2ZW50cyhcbiAgICAgICAgcGFyZW50V2luLFxuICAgICAgICBkYXRhWydzZW50aW5lbCddLFxuICAgICAgICBldmVudC5vcmlnaW4sXG4gICAgICAgIGV2ZW50LnNvdXJjZVxuICAgICk7XG4gICAgaWYgKCFsaXN0ZW5Gb3JFdmVudHMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsZXQgbGlzdGVuZXJzID0gbGlzdGVuRm9yRXZlbnRzW2RhdGFbJ3R5cGUnXV07XG4gICAgaWYgKCFsaXN0ZW5lcnMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBXZSBzbGljZSB0byBhdm9pZCBpc3N1ZXMgd2l0aCBhZGRpbmcgYW5vdGhlciBsaXN0ZW5lciBvciB1bmxpc3RlbmluZ1xuICAgIC8vIGR1cmluZyBpdGVyYXRpb24uIFdlIGNvdWxkIG1vdmUgdG8gYSBEb3VibHkgTGlua2VkIExpc3Qgd2l0aFxuICAgIC8vIGJhY2t0cmFja2luZywgYnV0IHRoYXQncyBvdmVybHkgY29tcGxpY2F0ZWQuXG4gICAgbGlzdGVuZXJzID0gbGlzdGVuZXJzLnNsaWNlKCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0ZW5lcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGxpc3RlbmVyID0gbGlzdGVuZXJzW2ldO1xuICAgICAgbGlzdGVuZXIoZGF0YSwgZXZlbnQuc291cmNlLCBldmVudC5vcmlnaW4pO1xuICAgIH1cbiAgfTtcblxuICBwYXJlbnRXaW4uYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGxpc3RlbkZvckxpc3RlbmVyKTtcbn1cblxuLyoqXG4gKiBBbGxvd3MgbGlzdGVuaW5nIGZvciBtZXNzYWdlIGZyb20gdGhlIGlmcmFtZS4gUmV0dXJucyBhbiB1bmxpc3RlblxuICogZnVuY3Rpb24gdG8gcmVtb3ZlIHRoZSBsaXN0ZW5lci5cbiAqXG4gKiBAcGFyYW0gez9FbGVtZW50fSBpZnJhbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlT2ZNZXNzYWdlXG4gKiBAcGFyYW0gez9mdW5jdGlvbighSnNvbk9iamVjdCwgIVdpbmRvdywgc3RyaW5nKX0gY2FsbGJhY2sgQ2FsbGVkIHdoZW4gYVxuICogICAgIG1lc3NhZ2Ugb2YgdGhpcyB0eXBlIGFycml2ZXMgZm9yIHRoaXMgaWZyYW1lLlxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2lzM1Agc2V0IHRvIHRydWUgaWYgdGhlIGlmcmFtZSBpcyAzcC5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pbmNsdWRpbmdOZXN0ZWRXaW5kb3dzIHNldCB0byB0cnVlIGlmIGEgbWVzc2FnZXMgZnJvbVxuICogICAgIG5lc3RlZCBmcmFtZXMgc2hvdWxkIGFsc28gYmUgYWNjZXB0ZWQuXG4gKiBAcmV0dXJuIHshVW5saXN0ZW5EZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW5Gb3IoXG4gIGlmcmFtZSwgdHlwZU9mTWVzc2FnZSwgY2FsbGJhY2ssIG9wdF9pczNQLCBvcHRfaW5jbHVkaW5nTmVzdGVkV2luZG93cykge1xuICBkZXYoKS5hc3NlcnQoaWZyYW1lLnNyYywgJ29ubHkgaWZyYW1lcyB3aXRoIHNyYyBzdXBwb3J0ZWQnKTtcbiAgZGV2KCkuYXNzZXJ0KCFpZnJhbWUucGFyZW50Tm9kZSwgJ2Nhbm5vdCByZWdpc3RlciBldmVudHMgb24gYW4gYXR0YWNoZWQgJyArXG4gICAgICAnaWZyYW1lLiBJdCB3aWxsIGNhdXNlIGhhaXItcHVsbGluZyBidWdzIGxpa2UgIzI5NDInKTtcbiAgZGV2KCkuYXNzZXJ0KGNhbGxiYWNrKTtcbiAgY29uc3QgcGFyZW50V2luID0gaWZyYW1lLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc7XG5cbiAgcmVnaXN0ZXJHbG9iYWxMaXN0ZW5lcklmTmVlZGVkKHBhcmVudFdpbik7XG5cbiAgY29uc3QgbGlzdGVuRm9yRXZlbnRzID0gZ2V0T3JDcmVhdGVMaXN0ZW5Gb3JFdmVudHMoXG4gICAgICBwYXJlbnRXaW4sXG4gICAgICBpZnJhbWUsXG4gICAgICBvcHRfaXMzUFxuICApO1xuXG5cbiAgbGV0IGV2ZW50cyA9IGxpc3RlbkZvckV2ZW50c1t0eXBlT2ZNZXNzYWdlXSB8fFxuICAgIChsaXN0ZW5Gb3JFdmVudHNbdHlwZU9mTWVzc2FnZV0gPSBbXSk7XG5cbiAgbGV0IHVubGlzdGVuO1xuICBsZXQgbGlzdGVuZXIgPSBmdW5jdGlvbihkYXRhLCBzb3VyY2UsIG9yaWdpbikge1xuICAgIC8vIEV4Y2x1ZGUgbmVzdGVkIGZyYW1lcyBpZiBuZWNlc3NhcnkuXG4gICAgLy8gTm90ZSB0aGF0IHRoZSBzb3VyY2Ugd2FzIGFscmVhZHkgdmVyaWZpZWQgdG8gYmUgZWl0aGVyIHRoZSBjb250ZW50V2luZG93XG4gICAgLy8gb2YgdGhlIGlmcmFtZSBpdHNlbGYgb3IgYSBkZXNjZW5kYW50IHdpbmRvdyB3aXRoaW4gaXQuXG4gICAgaWYgKCFvcHRfaW5jbHVkaW5nTmVzdGVkV2luZG93cyAmJiBzb3VyY2UgIT0gaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoZGF0YS5zZW50aW5lbCA9PSBVTkxJU1RFTl9TRU5USU5FTCkge1xuICAgICAgdW5saXN0ZW4oKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY2FsbGJhY2soZGF0YSwgc291cmNlLCBvcmlnaW4pO1xuICB9O1xuXG4gIGV2ZW50cy5wdXNoKGxpc3RlbmVyKTtcblxuICByZXR1cm4gdW5saXN0ZW4gPSBmdW5jdGlvbigpIHtcbiAgICBpZiAobGlzdGVuZXIpIHtcbiAgICAgIGNvbnN0IGluZGV4ID0gZXZlbnRzLmluZGV4T2YobGlzdGVuZXIpO1xuICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgZXZlbnRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICB9XG4gICAgICAvLyBNYWtlIHN1cmUgcmVmZXJlbmNlcyB0byB0aGUgdW5saXN0ZW4gZnVuY3Rpb24gZG8gbm90IGtlZXBcbiAgICAgIC8vIGFsaXZlIHRvbyBtdWNoLlxuICAgICAgbGlzdGVuZXIgPSBudWxsO1xuICAgICAgZXZlbnRzID0gbnVsbDtcbiAgICAgIGNhbGxiYWNrID0gbnVsbDtcbiAgICB9XG4gIH07XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgdGhhdCByZXNvbHZlcyB3aGVuIG9uZSBvZiBnaXZlbiBtZXNzYWdlcyBoYXMgYmVlbiBvYnNlcnZlZFxuICogZm9yIHRoZSBmaXJzdCB0aW1lLiBBbmQgcmVtb3ZlIGxpc3RlbmVyIGZvciBhbGwgb3RoZXIgbWVzc2FnZXMuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBpZnJhbWVcbiAqIEBwYXJhbSB7c3RyaW5nfCFBcnJheTxzdHJpbmc+fSB0eXBlT2ZNZXNzYWdlc1xuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2lzM1BcbiAqIEByZXR1cm4geyFQcm9taXNlPCF7ZGF0YTogIUpzb25PYmplY3QsIHNvdXJjZTogIVdpbmRvdywgb3JpZ2luOiBzdHJpbmd9Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxpc3RlbkZvck9uY2VQcm9taXNlKGlmcmFtZSwgdHlwZU9mTWVzc2FnZXMsIG9wdF9pczNQKSB7XG4gIGNvbnN0IHVubGlzdGVuTGlzdCA9IFtdO1xuICBpZiAodHlwZW9mIHR5cGVPZk1lc3NhZ2VzID09ICdzdHJpbmcnKSB7XG4gICAgdHlwZU9mTWVzc2FnZXMgPSBbdHlwZU9mTWVzc2FnZXNdO1xuICB9XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHR5cGVPZk1lc3NhZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gdHlwZU9mTWVzc2FnZXNbaV07XG4gICAgICBjb25zdCB1bmxpc3RlbiA9IGxpc3RlbkZvcihpZnJhbWUsIG1lc3NhZ2UsIChkYXRhLCBzb3VyY2UsIG9yaWdpbikgPT4ge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHVubGlzdGVuTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHVubGlzdGVuTGlzdFtpXSgpO1xuICAgICAgICB9XG4gICAgICAgIHJlc29sdmUoe2RhdGEsIHNvdXJjZSwgb3JpZ2lufSk7XG4gICAgICB9LCBvcHRfaXMzUCk7XG4gICAgICB1bmxpc3Rlbkxpc3QucHVzaCh1bmxpc3Rlbik7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiBQb3N0cyBhIG1lc3NhZ2UgdG8gdGhlIGlmcmFtZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGlmcmFtZSBUaGUgaWZyYW1lLlxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgVHlwZSBvZiB0aGUgbWVzc2FnZS5cbiAqIEBwYXJhbSB7IUpzb25PYmplY3R9IG9iamVjdCBNZXNzYWdlIHBheWxvYWQuXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFyZ2V0T3JpZ2luIG9yaWdpbiBvZiB0aGUgdGFyZ2V0LlxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2lzM1Agc2V0IHRvIHRydWUgaWYgdGhlIGlmcmFtZSBpcyAzcC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBvc3RNZXNzYWdlKGlmcmFtZSwgdHlwZSwgb2JqZWN0LCB0YXJnZXRPcmlnaW4sIG9wdF9pczNQKSB7XG4gIHBvc3RNZXNzYWdlVG9XaW5kb3dzKGlmcmFtZSxcbiAgICAgIFt7d2luOiBpZnJhbWUuY29udGVudFdpbmRvdywgb3JpZ2luOiB0YXJnZXRPcmlnaW59XSwgdHlwZSwgb2JqZWN0LFxuICAgICAgb3B0X2lzM1ApO1xufVxuXG4vKipcbiAqIFBvc3RzIGFuIGlkZW50aWNhbCBtZXNzYWdlIHRvIG11bHRpcGxlIHRhcmdldCB3aW5kb3dzIHdpdGggdGhlIHNhbWVcbiAqIHNlbnRpbmVsLlxuICogVGhlIG1lc3NhZ2UgaXMgc2VyaWFsaXplZCBvbmx5IG9uY2UuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBpZnJhbWUgVGhlIGlmcmFtZS5cbiAqIEBwYXJhbSB7IUFycmF5PHt3aW46ICFXaW5kb3csIG9yaWdpbjogc3RyaW5nfT59IHRhcmdldHMgdG8gc2VuZCB0aGUgbWVzc2FnZVxuICogICAgIHRvLCBwYWlycyBvZiB3aW5kb3cgYW5kIGl0cyBvcmlnaW4uXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBUeXBlIG9mIHRoZSBtZXNzYWdlLlxuICogQHBhcmFtIHshSnNvbk9iamVjdH0gb2JqZWN0IE1lc3NhZ2UgcGF5bG9hZC5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pczNQIHNldCB0byB0cnVlIGlmIHRoZSBpZnJhbWUgaXMgM3AuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwb3N0TWVzc2FnZVRvV2luZG93cyhpZnJhbWUsIHRhcmdldHMsIHR5cGUsIG9iamVjdCwgb3B0X2lzM1ApIHtcbiAgaWYgKCFpZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgIHJldHVybjtcbiAgfVxuICBvYmplY3RbJ3R5cGUnXSA9IHR5cGU7XG4gIG9iamVjdFsnc2VudGluZWwnXSA9IGdldFNlbnRpbmVsXyhpZnJhbWUsIG9wdF9pczNQKTtcbiAgbGV0IHBheWxvYWQgPSBvYmplY3Q7XG4gIGlmIChvcHRfaXMzUCkge1xuICAgIC8vIFNlcmlhbGl6ZSBvdXJzZWx2ZXMgYmVjYXVzZSB0aGF0IGlzIG11Y2ggZmFzdGVyIGluIENocm9tZS5cbiAgICBwYXlsb2FkID0gJ2FtcC0nICsgSlNPTi5zdHJpbmdpZnkob2JqZWN0KTtcbiAgfVxuICBmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldHMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCB0YXJnZXQgPSB0YXJnZXRzW2ldO1xuICAgIHRhcmdldC53aW4uLypPSyovcG9zdE1lc3NhZ2UocGF5bG9hZCwgdGFyZ2V0Lm9yaWdpbik7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXRzIHRoZSBzZW50aW5lbCBzdHJpbmcuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBpZnJhbWUgVGhlIGlmcmFtZS5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pczNQIHNldCB0byB0cnVlIGlmIHRoZSBpZnJhbWUgaXMgM3AuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFNlbnRpbmVsIHN0cmluZy5cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIGdldFNlbnRpbmVsXyhpZnJhbWUsIG9wdF9pczNQKSB7XG4gIHJldHVybiBvcHRfaXMzUCA/IGlmcmFtZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtYW1wLTNwLXNlbnRpbmVsJykgOiAnYW1wJztcbn1cblxuLyoqXG4gKiBKU09OIHBhcnNlcyBldmVudC5kYXRhIGlmIGl0IG5lZWRzIHRvIGJlXG4gKiBAcGFyYW0geyp9IGRhdGFcbiAqIEByZXR1cm4gez9Kc29uT2JqZWN0fSBvYmplY3QgbWVzc2FnZVxuICogQHByaXZhdGVcbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VJZk5lZWRlZChkYXRhKSB7XG4gIGlmICh0eXBlb2YgZGF0YSA9PSAnc3RyaW5nJykge1xuICAgIGlmIChkYXRhLmNoYXJBdCgwKSA9PSAneycpIHtcbiAgICAgIGRhdGEgPSB0cnlQYXJzZUpzb24oZGF0YSwgZSA9PiB7XG4gICAgICAgIGRldigpLndhcm4oJ0lGUkFNRS1IRUxQRVInLFxuICAgICAgICAgICAgJ1Bvc3RtZXNzYWdlIGNvdWxkIG5vdCBiZSBwYXJzZWQuICcgK1xuICAgICAgICAgICAgJ0lzIGl0IGluIGEgdmFsaWQgSlNPTiBmb3JtYXQ/JywgZSk7XG4gICAgICB9KSB8fCBudWxsO1xuICAgIH0gZWxzZSBpZiAoaXNBbXBNZXNzYWdlKGRhdGEpKSB7XG4gICAgICBkYXRhID0gZGVzZXJpYWxpemVNZXNzYWdlKGRhdGEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkYXRhID0gbnVsbDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIC8qKiBAdHlwZSB7P0pzb25PYmplY3R9ICovIChkYXRhKTtcbn1cblxuXG5cbi8qKlxuICogTWFuYWdlcyBhIHBvc3RNZXNzYWdlIEFQSSBmb3IgYW4gaWZyYW1lIHdpdGggYSBzdWJzY3JpcHRpb24gbWVzc2FnZSBhbmRcbiAqIGEgd2F5IHRvIGJyb2FkY2FzdCBtZXNzYWdlcyB0byBhbGwgc3Vic2NyaWJlZCB3aW5kb3dzLCB3aGljaFxuICogaW4gdHVybiBtdXN0IGFsbCBiZSBkZXNjZW5kYW50cyBvZiB0aGUgY29udGVudFdpbmRvdyBvZiB0aGUgaWZyYW1lLlxuICovXG5leHBvcnQgY2xhc3MgU3Vic2NyaXB0aW9uQXBpIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGlmcmFtZSBUaGUgaWZyYW1lLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBUeXBlIG9mIHRoZSBzdWJzY3JpcHRpb24gbWVzc2FnZS5cbiAgICogQHBhcmFtIHtib29sZWFufSBpczNwIHNldCB0byB0cnVlIGlmIHRoZSBpZnJhbWUgaXMgM3AuXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oIUpzb25PYmplY3QsICFXaW5kb3csIHN0cmluZyl9IHJlcXVlc3RDYWxsYmFjayBDYWxsYmFja1xuICAgKiAgICAgaW52b2tlZCB3aGVuZXZlciBhIG5ldyB3aW5kb3cgc3Vic2NyaWJlcy5cbiAgICovXG4gIGNvbnN0cnVjdG9yKGlmcmFtZSwgdHlwZSwgaXMzcCwgcmVxdWVzdENhbGxiYWNrKSB7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IUVsZW1lbnR9ICovXG4gICAgdGhpcy5pZnJhbWVfID0gaWZyYW1lO1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge2Jvb2xlYW59ICovXG4gICAgdGhpcy5pczNwXyA9IGlzM3A7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IUFycmF5PHt3aW46ICFXaW5kb3csIG9yaWdpbjogc3RyaW5nfT59ICovXG4gICAgdGhpcy5jbGllbnRXaW5kb3dzXyA9IFtdO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IVVubGlzdGVuRGVmfSAqL1xuICAgIHRoaXMudW5saXN0ZW5fID0gbGlzdGVuRm9yKHRoaXMuaWZyYW1lXywgdHlwZSwgKGRhdGEsIHNvdXJjZSwgb3JpZ2luKSA9PiB7XG4gICAgICAvLyBUaGlzIG1lc3NhZ2UgbWlnaHQgYmUgZnJvbSBhbnkgd2luZG93IHdpdGhpbiB0aGUgaWZyYW1lLCB3ZSBuZWVkXG4gICAgICAvLyB0byBrZWVwIHRyYWNrIG9mIHdoaWNoIHdpbmRvd3Mgd2FudCB0byBiZSBzZW50IHVwZGF0ZXMuXG4gICAgICBpZiAoIXRoaXMuY2xpZW50V2luZG93c18uc29tZShlbnRyeSA9PiBlbnRyeS53aW4gPT0gc291cmNlKSkge1xuICAgICAgICB0aGlzLmNsaWVudFdpbmRvd3NfLnB1c2goe3dpbjogc291cmNlLCBvcmlnaW59KTtcbiAgICAgIH1cbiAgICAgIHJlcXVlc3RDYWxsYmFjayhkYXRhLCBzb3VyY2UsIG9yaWdpbik7XG4gICAgfSwgdGhpcy5pczNwXyxcbiAgICAgICAgLy8gRm9yIDNQIGZyYW1lcyB3ZSBhbHNvIGFsbG93IG5lc3RlZCBmcmFtZXMgd2l0aGluIHRoZW0gdG8gc3Vic2NyaWJlLi5cbiAgICB0aGlzLmlzM3BfIC8qIG9wdF9pbmNsdWRpbmdOZXN0ZWRXaW5kb3dzICovKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZW5kcyBhIG1lc3NhZ2UgdG8gYWxsIHN1YnNjcmliZWQgd2luZG93cy5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgVHlwZSBvZiB0aGUgbWVzc2FnZS5cbiAgICogQHBhcmFtIHshSnNvbk9iamVjdH0gZGF0YSBNZXNzYWdlIHBheWxvYWQuXG4gICAqL1xuICBzZW5kKHR5cGUsIGRhdGEpIHtcbiAgICAvLyBSZW1vdmUgY2xpZW50cyB0aGF0IGhhdmUgYmVlbiByZW1vdmVkIGZyb20gdGhlIERPTS5cbiAgICBmaWx0ZXJTcGxpY2UodGhpcy5jbGllbnRXaW5kb3dzXywgY2xpZW50ID0+ICEhY2xpZW50Lndpbi5wYXJlbnQpO1xuICAgIHBvc3RNZXNzYWdlVG9XaW5kb3dzKFxuICAgICAgICB0aGlzLmlmcmFtZV8sXG4gICAgICAgIHRoaXMuY2xpZW50V2luZG93c18sXG4gICAgICAgIHR5cGUsXG4gICAgICAgIGRhdGEsXG4gICAgICAgIHRoaXMuaXMzcF8pO1xuICB9XG5cbiAgLyoqXG4gICAqIERlc3Ryb3lzIGlmcmFtZS5cbiAgICovXG4gIGRlc3Ryb3koKSB7XG4gICAgdGhpcy51bmxpc3Rlbl8oKTtcbiAgICB0aGlzLmNsaWVudFdpbmRvd3NfLmxlbmd0aCA9IDA7XG4gIH1cbn1cblxuLyoqXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9va3NMaWtlVHJhY2tpbmdJZnJhbWUoZWxlbWVudCkge1xuICBjb25zdCBib3ggPSBlbGVtZW50LmdldExheW91dEJveCgpO1xuICAvLyBUaGlzIGhldXJpc3RpYyBpcyBzdWJqZWN0IHRvIGNoYW5nZS5cbiAgaWYgKGJveC53aWR0aCA+IDEwIHx8IGJveC5oZWlnaHQgPiAxMCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICAvLyBJZnJhbWUgaXMgbm90IHRyYWNraW5nIGlmcmFtZSBpZiBvcGVuIHdpdGggdXNlciBpbnRlcmFjdGlvblxuICByZXR1cm4gIWNsb3Nlc3RCeVNlbGVjdG9yKGVsZW1lbnQsICcuaS1hbXBodG1sLW92ZXJsYXknKTtcbn1cblxuLy8gTW9zdCBjb21tb24gYWQgc2l6ZXNcbi8vIEFycmF5IG9mIFt3aWR0aCwgaGVpZ2h0XSBwYWlycy5cbmNvbnN0IGFkU2l6ZXMgPSBbXG4gIFszMDAsIDI1MF0sXG4gIFszMjAsIDUwXSxcbiAgWzMwMCwgNTBdLFxuICBbMzIwLCAxMDBdLFxuXTtcblxuLyoqXG4gKiBHdWVzcyB3aGV0aGVyIHRoaXMgZWxlbWVudCBtaWdodCBiZSBhbiBhZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnQgQW4gYW1wLWlmcmFtZSBlbGVtZW50LlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBZExpa2UoZWxlbWVudCkge1xuICBjb25zdCBib3ggPSBlbGVtZW50LmdldExheW91dEJveCgpO1xuICBjb25zdCB7aGVpZ2h0LCB3aWR0aH0gPSBib3g7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYWRTaXplcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHJlZldpZHRoID0gYWRTaXplc1tpXVswXTtcbiAgICBjb25zdCByZWZIZWlnaHQgPSBhZFNpemVzW2ldWzFdO1xuICAgIGlmIChyZWZIZWlnaHQgPiBoZWlnaHQpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAocmVmV2lkdGggPiB3aWR0aCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIC8vIEZ1enp5IG1hdGNoaW5nIHRvIGFjY291bnQgZm9yIHBhZGRpbmcuXG4gICAgaWYgKGhlaWdodCAtIHJlZkhlaWdodCA8PSAyMCAmJiB3aWR0aCAtIHJlZldpZHRoIDw9IDIwKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGlmcmFtZVxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpc2FibGVTY3JvbGxpbmdPbklmcmFtZShpZnJhbWUpIHtcbiAgYWRkQXR0cmlidXRlc1RvRWxlbWVudChpZnJhbWUsIGRpY3QoeydzY3JvbGxpbmcnOiAnbm8nfSkpO1xuXG4gIC8vIFRoaXMgc2hvdWxkbid0IHdvcmssIGJ1dCBpdCBkb2VzIG9uIEZpcmVmb3guXG4gIC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNTQ5NDk2OVxuICBzZXRTdHlsZShpZnJhbWUsICdvdmVyZmxvdycsICdoaWRkZW4nKTtcblxuICByZXR1cm4gaWZyYW1lO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuL3NlcnZpY2VzJztcbmltcG9ydCB7VmlkZW9FdmVudHN9IGZyb20gJy4vdmlkZW8taW50ZXJmYWNlJztcbmltcG9ydCB7ZGV2fSBmcm9tICcuL2xvZyc7XG5pbXBvcnQge2h0bWxGb3J9IGZyb20gJy4vc3RhdGljLXRlbXBsYXRlJztcbmltcG9ydCB7aXNBcnJheSwgaXNPYmplY3R9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHtzdGFydHNXaXRofSBmcm9tICcuL3N0cmluZyc7XG5pbXBvcnQge3RyeVBhcnNlSnNvbn0gZnJvbSAnLi9qc29uJztcblxuXG4vKiogQGVudW0ge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBTYW5kYm94T3B0aW9ucyA9IHtcbiAgQUxMT1dfU0NSSVBUUzogJ2FsbG93LXNjcmlwdHMnLFxuICBBTExPV19TQU1FX09SSUdJTjogJ2FsbG93LXNhbWUtb3JpZ2luJyxcbn07XG5cblxuLyoqXG4gKiBAcGFyYW0geyFFdmVudH0gZXZlbnRcbiAqIEBwYXJhbSB7P0VsZW1lbnR9IGlmcmFtZVxuICogQHBhcmFtIHtzdHJpbmd8IVJlZ0V4cH0gaG9zdFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9yaWdpbk1hdGNoZXMoZXZlbnQsIGlmcmFtZSwgaG9zdCkge1xuICBpZiAoIWlmcmFtZSB8fCBldmVudC5zb3VyY2UgIT0gaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgaWYgKHR5cGVvZiBob3N0ID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBob3N0ID09IGV2ZW50Lm9yaWdpbjtcbiAgfVxuICByZXR1cm4gaG9zdC50ZXN0KGV2ZW50Lm9yaWdpbik7XG59XG5cblxuLyoqXG4gKiBSZS1kaXNwYXRjaGVzIGFuIGV2ZW50IHJlY2VpdmVkIGZyb20gcG9zdE1lc3NhZ2UgYXMgYW4gZXZlbnQgaW4gdGhlIGhvc3RcbiAqIGRvY3VtZW50LlxuICpcbiAqIEBwYXJhbSB7IUFtcEVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFxuICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgKHN0cmluZ3w/QXJyYXk8c3RyaW5nPik+fSBldmVudHNcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWRpc3BhdGNoKGVsZW1lbnQsIGV2ZW50LCBldmVudHMpIHtcbiAgaWYgKGV2ZW50c1tldmVudF0gPT0gbnVsbCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBjb25zdCBkaXNwYXRjaEV2ZW50ID0gZXZlbnRzW2V2ZW50XTtcbiAgKGlzQXJyYXkoZGlzcGF0Y2hFdmVudCkgPyBkaXNwYXRjaEV2ZW50IDogW2Rpc3BhdGNoRXZlbnRdKS5mb3JFYWNoKGUgPT4ge1xuICAgIGVsZW1lbnQuZGlzcGF0Y2hDdXN0b21FdmVudChkZXYoKS5hc3NlcnRTdHJpbmcoZSkpO1xuICB9KTtcbiAgcmV0dXJuIHRydWU7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyEuL2Jhc2UtZWxlbWVudC5CYXNlRWxlbWVudH0gdmlkZW9cbiAqIEBwYXJhbSB7c3RyaW5nfSBzcmNcbiAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X25hbWVcbiAqIEBwYXJhbSB7IUFycmF5PCFTYW5kYm94T3B0aW9ucz49fSBvcHRfc2FuZGJveFxuICogQHJldHVybiB7IUVsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVGcmFtZUZvcih2aWRlbywgc3JjLCBvcHRfbmFtZSwgb3B0X3NhbmRib3gpIHtcbiAgY29uc3Qge2VsZW1lbnR9ID0gdmlkZW87XG4gIGNvbnN0IGZyYW1lID1cbiAgICAgIGh0bWxGb3IoZWxlbWVudClgPGlmcmFtZSBmcmFtZWJvcmRlcj0wIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT5gO1xuXG4gIGlmIChvcHRfbmFtZSkge1xuICAgIGZyYW1lLnNldEF0dHJpYnV0ZSgnbmFtZScsIG9wdF9uYW1lKTtcbiAgfVxuXG4gIGlmIChvcHRfc2FuZGJveCkge1xuICAgIGZyYW1lLnNldEF0dHJpYnV0ZSgnc2FuZGJveCcsIG9wdF9zYW5kYm94LmpvaW4oJyAnKSk7XG4gIH1cblxuICBmcmFtZS5zcmMgPSBTZXJ2aWNlcy51cmxGb3JEb2MoZWxlbWVudCkuYXNzZXJ0SHR0cHNVcmwoc3JjLCBlbGVtZW50KTtcblxuICB2aWRlby5hcHBseUZpbGxDb250ZW50KGZyYW1lKTtcbiAgZWxlbWVudC5hcHBlbmRDaGlsZChmcmFtZSk7XG5cbiAgcmV0dXJuIGZyYW1lO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHs/fSBhbnl0aGluZ1xuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzSnNvbk9yT2JqKGFueXRoaW5nKSB7XG4gIGlmICghYW55dGhpbmcpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIGlzT2JqZWN0KGFueXRoaW5nKSB8fFxuICAgIHN0YXJ0c1dpdGgoLyoqIEB0eXBlIHtzdHJpbmd9ICovIChhbnl0aGluZyksICd7Jyk7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0gez9Kc29uT2JqZWN0fHN0cmluZ3x1bmRlZmluZWR9IG9iak9yU3RyXG4gKiBAcmV0dXJuIHs/SnNvbk9iamVjdHx1bmRlZmluZWR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvYmpPclBhcnNlSnNvbihvYmpPclN0cikge1xuICBpZiAoaXNPYmplY3Qob2JqT3JTdHIpKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovIChvYmpPclN0cik7XG4gIH1cbiAgcmV0dXJuIHRyeVBhcnNlSnNvbihvYmpPclN0cik7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGlzTXV0ZWRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG11dGVkT3JVbm11dGVkRXZlbnQoaXNNdXRlZCkge1xuICByZXR1cm4gaXNNdXRlZCA/IFZpZGVvRXZlbnRzLk1VVEVEIDogVmlkZW9FdmVudHMuVU5NVVRFRDtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgVGhpcyBtb2R1bGUgZGVjbGFyZXMgSlNPTiB0eXBlcyBhcyBkZWZpbmVkIGluIHRoZVxuICoge0BsaW5rIGh0dHA6Ly9qc29uLm9yZy99LlxuICovXG5cbmltcG9ydCB7aXNPYmplY3R9IGZyb20gJy4vdHlwZXMnO1xuXG5cbi8vIE5PVEUgVHlwZSBhcmUgY2hhbmdlZCB0byB7Kn0gYmVjYXVzZSBvZlxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9jbG9zdXJlLWNvbXBpbGVyL2lzc3Vlcy8xOTk5XG5cbi8qKlxuICogSlNPTiBzY2FsYXIuIEl0J3MgZWl0aGVyIHN0cmluZywgbnVtYmVyIG9yIGJvb2xlYW4uXG4gKiBAdHlwZWRlZiB7Kn0gc2hvdWxkIGJlIHN0cmluZ3xudW1iZXJ8Ym9vbGVhblxuICovXG5sZXQgSlNPTlNjYWxhckRlZjtcblxuXG4vKipcbiAqIEpTT04gb2JqZWN0LiBJdCdzIGEgbWFwIHdpdGggc3RyaW5nIGtleXMgYW5kIEpTT04gdmFsdWVzLlxuICogQHR5cGVkZWYgeyp9IHNob3VsZCBiZSAhT2JqZWN0PHN0cmluZywgP0pTT05WYWx1ZURlZj5cbiAqL1xubGV0IEpTT05PYmplY3REZWY7XG5cblxuLyoqXG4gKiBKU09OIGFycmF5LiBJdCdzIGFuIGFycmF5IHdpdGggSlNPTiB2YWx1ZXMuXG4gKiBAdHlwZWRlZiB7Kn0gc2hvdWxkIGJlICFBcnJheTw/SlNPTlZhbHVlRGVmPlxuICovXG5sZXQgSlNPTkFycmF5RGVmO1xuXG5cbi8qKlxuICogSlNPTiB2YWx1ZS4gSXQncyBlaXRoZXIgYSBzY2FsYXIsIGFuIG9iamVjdCBvciBhbiBhcnJheS5cbiAqIEB0eXBlZGVmIHsqfSBzaG91bGQgYmUgIUpTT05TY2FsYXJEZWZ8IUpTT05PYmplY3REZWZ8IUpTT05BcnJheURlZlxuICovXG5sZXQgSlNPTlZhbHVlRGVmO1xuXG4vKipcbiAqIFJlY3JlYXRlcyBvYmplY3RzIHdpdGggcHJvdG90eXBlLWxlc3MgY29waWVzLlxuICogQHBhcmFtIHshSnNvbk9iamVjdH0gb2JqXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlY3JlYXRlTm9uUHJvdG9PYmplY3Qob2JqKSB7XG4gIGNvbnN0IGNvcHkgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBmb3IgKGNvbnN0IGsgaW4gb2JqKSB7XG4gICAgaWYgKCFoYXNPd25Qcm9wZXJ0eShvYmosIGspKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3QgdiA9IG9ialtrXTtcbiAgICBjb3B5W2tdID0gaXNPYmplY3QodikgPyByZWNyZWF0ZU5vblByb3RvT2JqZWN0KHYpIDogdjtcbiAgfVxuICByZXR1cm4gLyoqIEB0eXBlIHshSnNvbk9iamVjdH0gKi8gKGNvcHkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmcm9tIGFuIG9iamVjdCBmb3IgYSBmaWVsZC1iYXNlZCBleHByZXNzaW9uLiBUaGUgZXhwcmVzc2lvblxuICogaXMgYSBzaW1wbGUgbmVzdGVkIGRvdC1ub3RhdGlvbiBvZiBmaWVsZHMsIHN1Y2ggYXMgYGZpZWxkMS5maWVsZDJgLiBJZiBhbnlcbiAqIGZpZWxkIGluIGEgY2hhaW4gZG9lcyBub3QgZXhpc3Qgb3IgaXMgbm90IGFuIG9iamVjdCBvciBhcnJheSwgdGhlIHJldHVybmVkXG4gKiB2YWx1ZSB3aWxsIGJlIGB1bmRlZmluZWRgLlxuICpcbiAqIEBwYXJhbSB7IUpzb25PYmplY3R9IG9ialxuICogQHBhcmFtIHtzdHJpbmd9IGV4cHJcbiAqIEByZXR1cm4geyp9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRWYWx1ZUZvckV4cHIob2JqLCBleHByKSB7XG4gIC8vIFRoZSBgLmAgaW5kaWNhdGVzIFwidGhlIG9iamVjdCBpdHNlbGZcIi5cbiAgaWYgKGV4cHIgPT0gJy4nKSB7XG4gICAgcmV0dXJuIG9iajtcbiAgfVxuICAvLyBPdGhlcndpc2UsIG5hdmlnYXRlIHZpYSBwcm9wZXJ0aWVzLlxuICBjb25zdCBwYXJ0cyA9IGV4cHIuc3BsaXQoJy4nKTtcbiAgbGV0IHZhbHVlID0gb2JqO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgcGFydCA9IHBhcnRzW2ldO1xuICAgIGlmIChwYXJ0ICYmXG4gICAgICAgIHZhbHVlICYmXG4gICAgICAgIHZhbHVlW3BhcnRdICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgaGFzT3duUHJvcGVydHkodmFsdWUsIHBhcnQpXG4gICAgKSB7XG4gICAgICB2YWx1ZSA9IHZhbHVlW3BhcnRdO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHZhbHVlID0gdW5kZWZpbmVkO1xuICAgIGJyZWFrO1xuICB9XG4gIHJldHVybiB2YWx1ZTtcbn1cblxuLyoqXG4gKiBTaW1wbGUgd3JhcHBlciBhcm91bmQgSlNPTi5wYXJzZSB0aGF0IGNhc3RzIHRoZSByZXR1cm4gdmFsdWVcbiAqIHRvIEpzb25PYmplY3QuXG4gKiBDcmVhdGUgYSBuZXcgd3JhcHBlciBpZiBhbiBhcnJheSByZXR1cm4gdmFsdWUgaXMgZGVzaXJlZC5cbiAqIEBwYXJhbSB7Kn0ganNvbiBKU09OIHN0cmluZyB0byBwYXJzZVxuICogQHJldHVybiB7P0pzb25PYmplY3R9IE1heSBiZSBleHRlbmQgdG8gcGFyc2UgYXJyYXlzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VKc29uKGpzb24pIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7P0pzb25PYmplY3R9ICovKEpTT04ucGFyc2UoLyoqIEB0eXBlIHtzdHJpbmd9ICovIChqc29uKSkpO1xufVxuXG4vKipcbiAqIFBhcnNlcyB0aGUgZ2l2ZW4gYGpzb25gIHN0cmluZyB3aXRob3V0IHRocm93aW5nIGFuIGV4Y2VwdGlvbiBpZiBub3QgdmFsaWQuXG4gKiBSZXR1cm5zIGB1bmRlZmluZWRgIGlmIHBhcnNpbmcgZmFpbHMuXG4gKiBSZXR1cm5zIHRoZSBgT2JqZWN0YCBjb3JyZXNwb25kaW5nIHRvIHRoZSBKU09OIHN0cmluZyB3aGVuIHBhcnNpbmcgc3VjY2VlZHMuXG4gKiBAcGFyYW0geyp9IGpzb24gSlNPTiBzdHJpbmcgdG8gcGFyc2VcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVycm9yKT19IG9wdF9vbkZhaWxlZCBPcHRpb25hbCBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkXG4gKiAgICAgd2l0aCB0aGUgZXJyb3IgaWYgcGFyc2luZyBmYWlscy5cbiAqIEByZXR1cm4gez9Kc29uT2JqZWN0fHVuZGVmaW5lZH0gTWF5IGJlIGV4dGVuZCB0byBwYXJzZSBhcnJheXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnlQYXJzZUpzb24oanNvbiwgb3B0X29uRmFpbGVkKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHBhcnNlSnNvbihqc29uKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGlmIChvcHRfb25GYWlsZWQpIHtcbiAgICAgIG9wdF9vbkZhaWxlZChlKTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG4vKipcbiAqIFJlY3Vyc2l2ZWx5IGNoZWNrcyBzdHJpY3QgZXF1YWxpdHkgb2YgaXRlbXMgaW4gbmVzdGVkIGFycmF5cyBhbmQgb2JqZWN0cy5cbiAqXG4gKiBAcGFyYW0ge0pTT05WYWx1ZURlZn0gYVxuICogQHBhcmFtIHtKU09OVmFsdWVEZWZ9IGJcbiAqIEBwYXJhbSB7bnVtYmVyfSBkZXB0aCBUaGUgbWF4aW11bSByZWN1cnNpb24gZGVwdGguIE11c3QgYmUgZmluaXRlLlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBkZXB0aCBhcmd1bWVudCBpcyBub3QgZmluaXRlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVjdXJzaXZlRXF1YWxzKGEsIGIsIGRlcHRoID0gMykge1xuICBpZiAoIWlzRmluaXRlKGRlcHRoKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignZGVwdGggYXJnIG11c3QgYmUgZmluaXRlOiAnICsgZGVwdGgpO1xuICB9XG4gIGlmIChhID09PSBiKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgLy8gT25seSBjaGVjayBzaGFsbG93IGVxdWFsaXR5IGZvciBkZXB0aCA8IDEuXG4gIGlmIChkZXB0aCA8IDEpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgaWYgKHR5cGVvZiBhICE9PSB0eXBlb2YgYikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBpZiAoQXJyYXkuaXNBcnJheShhKSAmJiBBcnJheS5pc0FycmF5KGIpKSB7XG4gICAgaWYgKGEubGVuZ3RoICE9PSBiLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghcmVjdXJzaXZlRXF1YWxzKGFbaV0sIGJbaV0sIGRlcHRoIC0gMSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAoYSAmJiBiICYmIHR5cGVvZiBhID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgYiA9PT0gJ29iamVjdCcpIHtcbiAgICBjb25zdCBrZXlzQSA9IE9iamVjdC5rZXlzKC8qKiBAdHlwZSB7IU9iamVjdH0gKi8gKGEpKTtcbiAgICBjb25zdCBrZXlzQiA9IE9iamVjdC5rZXlzKC8qKiBAdHlwZSB7IU9iamVjdH0gKi8gKGIpKTtcbiAgICBpZiAoa2V5c0EubGVuZ3RoICE9PSBrZXlzQi5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzQS5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qga2V5QSA9IGtleXNBW2ldO1xuICAgICAgY29uc3QgdmFsdWVBID0gYVtrZXlBXTtcbiAgICAgIGNvbnN0IHZhbHVlQiA9IGJba2V5QV07XG4gICAgICBpZiAoIXJlY3Vyc2l2ZUVxdWFscyh2YWx1ZUEsIHZhbHVlQiwgZGVwdGggLSAxKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7Kn0gb2JqXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBoYXNPd25Qcm9wZXJ0eShvYmosIGtleSkge1xuICBpZiAob2JqID09IG51bGwgfHwgdHlwZW9mIG9iaiAhPSAnb2JqZWN0Jykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKFxuICAgICAgLyoqIEB0eXBlIHshT2JqZWN0fSAqLyAob2JqKSwga2V5KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogVGhlIHN0cnVjdHVyZSB0aGF0IGNvbWJpbmVzIHBvc2l0aW9uIGFuZCBzaXplIGZvciBhbiBlbGVtZW50LiBUaGUgZXhhY3RcbiAqIGludGVycHJldGF0aW9uIG9mIHBvc2l0aW9uIGFuZCBzaXplIGRlcGVuZHMgb24gdGhlIHVzZSBjYXNlLlxuICpcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHRvcDogbnVtYmVyLFxuICogICBib3R0b206IG51bWJlcixcbiAqICAgbGVmdDogbnVtYmVyLFxuICogICByaWdodDogbnVtYmVyLFxuICogICB3aWR0aDogbnVtYmVyLFxuICogICBoZWlnaHQ6IG51bWJlcixcbiAqICAgeDogbnVtYmVyLFxuICogICB5OiBudW1iZXJcbiAqIH19XG4gKi9cbmV4cG9ydCBsZXQgTGF5b3V0UmVjdERlZjtcblxuXG4vKipcbiAqIFRoZSBzdHJ1Y3R1cmUgdGhhdCByZXByZXNlbnRzIHRoZSBtYXJnaW5zIG9mIGFuIEVsZW1lbnQuXG4gKlxuICogQHR5cGVkZWYge3tcbiAqICAgdG9wOiBudW1iZXIsXG4gKiAgIHJpZ2h0OiBudW1iZXIsXG4gKiAgIGJvdHRvbTogbnVtYmVyLFxuICogICBsZWZ0OiBudW1iZXJcbiAqIH19XG4gKi9cbmV4cG9ydCBsZXQgTGF5b3V0TWFyZ2luc0RlZjtcblxuXG4vKipcbiAqIFRoZSBzdHJ1Y3R1cmUgdGhhdCByZXByZXNlbnRzIGEgcmVxdWVzdGVkIGNoYW5nZSB0byB0aGUgbWFyZ2lucyBvZiBhblxuICogRWxlbWVudC4gQW55IG5ldyB2YWx1ZXMgc3BlY2lmaWVkIHdpbGwgcmVwbGFjZSBleGlzdGluZyBvbmVzIChyYXRoZXIgdGhhblxuICogYmVpbmcgYWRkaXRpdmUpLlxuICpcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHRvcDogKG51bWJlcnx1bmRlZmluZWQpLFxuICogICByaWdodDogKG51bWJlcnx1bmRlZmluZWQpLFxuICogICBib3R0b206IChudW1iZXJ8dW5kZWZpbmVkKSxcbiAqICAgbGVmdDogKG51bWJlcnx1bmRlZmluZWQpXG4gKiB9fVxuICovXG5leHBvcnQgbGV0IExheW91dE1hcmdpbnNDaGFuZ2VEZWY7XG5cbi8qKlxuKiBSZWxhdGl2ZVBvc2l0aW9uc1xuKlxuKiBEZXNjcmliZXMgdGhlIHJlbGF0aXZlIHBvc2l0aW9uIG9mIGFuIGVsZW1lbnQgdG8gYW5vdGhlciAod2hldGhlciB0aGVcbiogZmlyc3QgaXMgaW5zaWRlIHRoZSBzZWNvbmQsIG9uIHRvcCBvZiB0aGUgc2Vjb25kIG9yIG9uIHRoZSBib3R0b21cbiogQGVudW0ge3N0cmluZ31cbiovXG5leHBvcnQgY29uc3QgUmVsYXRpdmVQb3NpdGlvbnMgPSB7XG4gIElOU0lERTogJ2luc2lkZScsXG4gIFRPUDogJ3RvcCcsXG4gIEJPVFRPTTogJ2JvdHRvbScsXG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBsYXlvdXQgcmVjdCBiYXNlZCBvbiB0aGUgbGVmdCwgdG9wLCB3aWR0aCBhbmQgaGVpZ2h0IHBhcmFtZXRlcnNcbiAqIGluIHRoYXQgb3JkZXIuXG4gKiBAcGFyYW0ge251bWJlcn0gbGVmdFxuICogQHBhcmFtIHtudW1iZXJ9IHRvcFxuICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoXG4gKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0XG4gKiBAcmV0dXJuIHshTGF5b3V0UmVjdERlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxheW91dFJlY3RMdHdoKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkge1xuICByZXR1cm4ge1xuICAgIGxlZnQsXG4gICAgdG9wLFxuICAgIHdpZHRoLFxuICAgIGhlaWdodCxcbiAgICBib3R0b206IHRvcCArIGhlaWdodCxcbiAgICByaWdodDogbGVmdCArIHdpZHRoLFxuICAgIHg6IGxlZnQsXG4gICAgeTogdG9wLFxuICB9O1xufVxuXG5cbi8qKlxuICogQ3JlYXRlcyBhIGxheW91dCByZWN0IGJhc2VkIG9uIHRoZSBET01SZWN0LCBlLmcuIG9idGFpbmVkIGZyb20gY2FsbGluZ1xuICogZ2V0Qm91bmRpbmdDbGllbnRSZWN0LlxuICogQHBhcmFtIHshQ2xpZW50UmVjdH0gcmVjdFxuICogQHJldHVybiB7IUxheW91dFJlY3REZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXlvdXRSZWN0RnJvbURvbVJlY3QocmVjdCkge1xuICByZXR1cm4gbGF5b3V0UmVjdEx0d2goTnVtYmVyKHJlY3QubGVmdCksIE51bWJlcihyZWN0LnRvcCksXG4gICAgICBOdW1iZXIocmVjdC53aWR0aCksIE51bWJlcihyZWN0LmhlaWdodCkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgc3BlY2lmaWVkIHR3byByZWN0cyBvdmVybGFwIGJ5IGEgc2luZ2xlIHBpeGVsLlxuICogQHBhcmFtIHshTGF5b3V0UmVjdERlZn0gcjFcbiAqIEBwYXJhbSB7IUxheW91dFJlY3REZWZ9IHIyXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGF5b3V0UmVjdHNPdmVybGFwKHIxLCByMikge1xuICByZXR1cm4gKHIxLnRvcCA8PSByMi5ib3R0b20gJiYgcjIudG9wIDw9IHIxLmJvdHRvbSAmJlxuICAgICAgcjEubGVmdCA8PSByMi5yaWdodCAmJiByMi5sZWZ0IDw9IHIxLnJpZ2h0KTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIGludGVyc2VjdGlvbiBiZXR3ZWVuIGEsIGIgb3IgbnVsbCBpZiB0aGVyZSBpcyBub25lLlxuICogQHBhcmFtIHsuLi4/TGF5b3V0UmVjdERlZnx1bmRlZmluZWR9IHZhcl9hcmdzXG4gKiBAcmV0dXJuIHs/TGF5b3V0UmVjdERlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlY3RJbnRlcnNlY3Rpb24odmFyX2FyZ3MpIHtcbiAgbGV0IHgwID0gLUluZmluaXR5O1xuICBsZXQgeDEgPSBJbmZpbml0eTtcbiAgbGV0IHkwID0gLUluZmluaXR5O1xuICBsZXQgeTEgPSBJbmZpbml0eTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBjdXJyZW50ID0gYXJndW1lbnRzW2ldO1xuICAgIGlmICghY3VycmVudCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHgwID0gTWF0aC5tYXgoeDAsIGN1cnJlbnQubGVmdCk7XG4gICAgeDEgPSBNYXRoLm1pbih4MSwgY3VycmVudC5sZWZ0ICsgY3VycmVudC53aWR0aCk7XG4gICAgeTAgPSBNYXRoLm1heCh5MCwgY3VycmVudC50b3ApO1xuICAgIHkxID0gTWF0aC5taW4oeTEsIGN1cnJlbnQudG9wICsgY3VycmVudC5oZWlnaHQpO1xuICAgIGlmICh4MSA8IHgwIHx8IHkxIDwgeTApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuICBpZiAoeDEgPT0gSW5maW5pdHkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICByZXR1cm4gbGF5b3V0UmVjdEx0d2goeDAsIHkwLCB4MSAtIHgwLCB5MSAtIHkwKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwb3NpdGlvbiBvZiByMiByZWxhdGl2ZSB0byByMVxuICogQHBhcmFtIHshTGF5b3V0UmVjdERlZn0gcjFcbiAqIEBwYXJhbSB7IUxheW91dFJlY3REZWZ9IHIyXG4gKiBAcmV0dXJuIHtSZWxhdGl2ZVBvc2l0aW9uc31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxheW91dFJlY3RzUmVsYXRpdmVQb3MocjEsIHIyKSB7XG4gIGlmIChyMS50b3AgPCByMi50b3ApIHtcbiAgICByZXR1cm4gUmVsYXRpdmVQb3NpdGlvbnMuVE9QO1xuICB9IGVsc2UgaWYgKHIxLmJvdHRvbSA+IHIyLmJvdHRvbSkge1xuICAgIHJldHVybiBSZWxhdGl2ZVBvc2l0aW9ucy5CT1RUT007XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIFJlbGF0aXZlUG9zaXRpb25zLklOU0lERTtcbiAgfVxufVxuXG4vKipcbiAqIEV4cGFuZCB0aGUgbGF5b3V0IHJlY3QgdXNpbmcgbXVsdGlwbGVzIG9mIHdpZHRoIGFuZCBoZWlnaHQuXG4gKiBAcGFyYW0geyFMYXlvdXRSZWN0RGVmfSByZWN0IE9yaWdpbmFsIHJlY3QuXG4gKiBAcGFyYW0ge251bWJlcn0gZHcgRXhwYW5zaW9uIGluIHdpZHRoLCBzcGVjaWZpZWQgYXMgYSBtdWx0aXBsZSBvZiB3aWR0aC5cbiAqIEBwYXJhbSB7bnVtYmVyfSBkaCBFeHBhbnNpb24gaW4gaGVpZ2h0LCBzcGVjaWZpZWQgYXMgYSBtdWx0aXBsZSBvZiBoZWlnaHQuXG4gKiBAcmV0dXJuIHshTGF5b3V0UmVjdERlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4cGFuZExheW91dFJlY3QocmVjdCwgZHcsIGRoKSB7XG4gIHJldHVybiBsYXlvdXRSZWN0THR3aChyZWN0LmxlZnQgLSByZWN0LndpZHRoICogZHcsXG4gICAgICByZWN0LnRvcCAtIHJlY3QuaGVpZ2h0ICogZGgsXG4gICAgICByZWN0LndpZHRoICogKDEgKyBkdyAqIDIpLFxuICAgICAgcmVjdC5oZWlnaHQgKiAoMSArIGRoICogMikpO1xufVxuXG4vKipcbiAqIE1vdmVzIHRoZSBsYXlvdXQgcmVjdCB1c2luZyBkeCBhbmQgZHkuXG4gKiBAcGFyYW0geyFMYXlvdXRSZWN0RGVmfSByZWN0IE9yaWdpbmFsIHJlY3QuXG4gKiBAcGFyYW0ge251bWJlcn0gZHggTW92ZSBob3Jpem9udGFsbHkgd2l0aCB0aGlzIHZhbHVlLlxuICogQHBhcmFtIHtudW1iZXJ9IGR5IE1vdmUgdmVydGljYWxseSB3aXRoIHRoaXMgdmFsdWUuXG4gKiBAcmV0dXJuIHshTGF5b3V0UmVjdERlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1vdmVMYXlvdXRSZWN0KHJlY3QsIGR4LCBkeSkge1xuICBpZiAoKGR4ID09IDAgJiYgZHkgPT0gMCkgfHxcbiAgICAgIChyZWN0LndpZHRoID09IDAgJiYgcmVjdC5oZWlnaHQgPT0gMCkpIHtcbiAgICByZXR1cm4gcmVjdDtcbiAgfVxuICByZXR1cm4gbGF5b3V0UmVjdEx0d2gocmVjdC5sZWZ0ICsgZHgsIHJlY3QudG9wICsgZHksXG4gICAgICByZWN0LndpZHRoLCByZWN0LmhlaWdodCk7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFMYXlvdXRNYXJnaW5zRGVmfSBtYXJnaW5zXG4gKiBAcGFyYW0geyFMYXlvdXRNYXJnaW5zQ2hhbmdlRGVmfSBjaGFuZ2VcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcmVNYXJnaW5zQ2hhbmdlZChtYXJnaW5zLCBjaGFuZ2UpIHtcbiAgcmV0dXJuIChjaGFuZ2UudG9wICE9PSB1bmRlZmluZWQgJiYgY2hhbmdlLnRvcCAhPSBtYXJnaW5zLnRvcCkgfHxcbiAgICAgIChjaGFuZ2UucmlnaHQgIT09IHVuZGVmaW5lZCAmJiBjaGFuZ2UucmlnaHQgIT0gbWFyZ2lucy5yaWdodCkgfHxcbiAgICAgIChjaGFuZ2UuYm90dG9tICE9PSB1bmRlZmluZWQgJiYgY2hhbmdlLmJvdHRvbSAhPSBtYXJnaW5zLmJvdHRvbSkgfHxcbiAgICAgIChjaGFuZ2UubGVmdCAhPT0gdW5kZWZpbmVkICYmIGNoYW5nZS5sZWZ0ICE9IG1hcmdpbnMubGVmdCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHshTGF5b3V0UmVjdERlZn0gZnJvbVxuICogQHBhcmFtIHshTGF5b3V0UmVjdERlZn0gdG9cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXlvdXRSZWN0U2l6ZUVxdWFscyhmcm9tLCB0bykge1xuICByZXR1cm4gZnJvbS53aWR0aCA9PSB0by53aWR0aCAmJlxuICAgICAgZnJvbS5oZWlnaHQgPT09IHRvLmhlaWdodDtcbn1cblxuLyoqXG4gKiBAcGFyYW0gez9MYXlvdXRSZWN0RGVmfSByMVxuICogQHBhcmFtIHs/TGF5b3V0UmVjdERlZn0gcjJcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXlvdXRSZWN0RXF1YWxzKHIxLCByMikge1xuICBpZiAoIXIxIHx8ICFyMikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gcjEubGVmdCA9PSByMi5sZWZ0ICYmIHIxLnRvcCA9PSByMi50b3AgJiZcbiAgICAgIHIxLndpZHRoID09IHIyLndpZHRoICYmIHIxLmhlaWdodCA9PSByMi5oZWlnaHQ7XG59XG5cbi8qKlxuICogQHBhcmFtIHtMYXlvdXRNYXJnaW5zQ2hhbmdlRGVmfHVuZGVmaW5lZH0gbWFyZ2luc0NoYW5nZVxuICogQHJldHVybiB7TGF5b3V0TWFyZ2luc0NoYW5nZURlZnx1bmRlZmluZWR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbG9uZUxheW91dE1hcmdpbnNDaGFuZ2VEZWYobWFyZ2luc0NoYW5nZSkge1xuICBpZiAoIW1hcmdpbnNDaGFuZ2UpIHtcbiAgICByZXR1cm4gbWFyZ2luc0NoYW5nZTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHRvcDogbWFyZ2luc0NoYW5nZS50b3AsXG4gICAgYm90dG9tOiBtYXJnaW5zQ2hhbmdlLmJvdHRvbSxcbiAgICBsZWZ0OiBtYXJnaW5zQ2hhbmdlLmxlZnQsXG4gICAgcmlnaHQ6IG1hcmdpbnNDaGFuZ2UucmlnaHQsXG4gIH07XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IEltcGxlbWVudHMgZWxlbWVudCBsYXlvdXQuIFNlZSBodHRwczovL2dvby5nbC85YXZYdVQgZm9yXG4gKiBkZXRhaWxzLlxuICovXG5cbmltcG9ydCB7ZGV2LCB1c2VyfSBmcm9tICcuL2xvZyc7XG5pbXBvcnQge2h0bWxGb3J9IGZyb20gJy4vc3RhdGljLXRlbXBsYXRlJztcbmltcG9ydCB7aXNGaW5pdGVOdW1iZXJ9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHtzZXRTdHlsZSwgc2V0U3R5bGVzfSBmcm9tICcuL3N0eWxlJztcbmltcG9ydCB7c3RhcnRzV2l0aH0gZnJvbSAnLi9zdHJpbmcnO1xuXG4vKipcbiAqIEBlbnVtIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBjb25zdCBMYXlvdXQgPSB7XG4gIE5PRElTUExBWTogJ25vZGlzcGxheScsXG4gIEZJWEVEOiAnZml4ZWQnLFxuICBGSVhFRF9IRUlHSFQ6ICdmaXhlZC1oZWlnaHQnLFxuICBSRVNQT05TSVZFOiAncmVzcG9uc2l2ZScsXG4gIENPTlRBSU5FUjogJ2NvbnRhaW5lcicsXG4gIEZJTEw6ICdmaWxsJyxcbiAgRkxFWF9JVEVNOiAnZmxleC1pdGVtJyxcbiAgRkxVSUQ6ICdmbHVpZCcsXG4gIElOVFJJTlNJQzogJ2ludHJpbnNpYycsXG59O1xuXG5cbi8qKlxuICogTGF5b3V0IHByaW9yaXRpZXMgdG8gdXNlIHdpdGggQmFzZUVsZW1lbnQjZ2V0TGF5b3V0UHJpb3JpdHkoKSBhbmRcbiAqIEJhc2VFbGVtZW50I3VwZGF0ZUxheW91dFByaW9yaXR5KCkuXG4gKiBAZW51bSB7bnVtYmVyfVxuICovXG5leHBvcnQgY29uc3QgTGF5b3V0UHJpb3JpdHkgPSB7XG4gIENPTlRFTlQ6IDAsXG4gIE1FVEFEQVRBOiAxLFxuICBBRFM6IDIsXG4gIEJBQ0tHUk9VTkQ6IDMsXG59O1xuXG5cbi8qKlxuICogQ1NTIExlbmd0aCB0eXBlLiBFLmcuIFwiMXB4XCIgb3IgXCIyMHZoXCIuXG4gKiBAdHlwZWRlZiB7c3RyaW5nfVxuICovXG5leHBvcnQgbGV0IExlbmd0aERlZjtcblxuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHdpZHRoOiBzdHJpbmcsXG4gKiAgIGhlaWdodDogc3RyaW5nXG4gKiB9fVxuICovXG5sZXQgRGltZW5zaW9uc0RlZjtcblxuXG4vKipcbiAqIFRoZSBzZXQgb2YgZWxlbWVudHMgd2l0aCBuYXR1cmFsIGRpbWVuc2lvbnMsIHRoYXQgaXMsIGVsZW1lbnRzXG4gKiB3aGljaCBoYXZlIGEga25vd24gZGltZW5zaW9uIGVpdGhlciBiYXNlZCBvbiB0aGVpciB2YWx1ZSBzcGVjaWZpZWQgaGVyZSxcbiAqIG9yLCBpZiB0aGUgdmFsdWUgaXMgbnVsbCwgYSBkaW1lbnNpb24gc3BlY2lmaWMgdG8gdGhlIGJyb3dzZXIuXG4gKiBgaGFzTmF0dXJhbERpbWVuc2lvbnNgIGNoZWNrcyBmb3IgbWVtYmVyc2hpcCBpbiB0aGlzIHNldC5cbiAqIGBnZXROYXR1cmFsRGltZW5zaW9uc2AgZGV0ZXJtaW5lcyB0aGUgZGltZW5zaW9ucyBmb3IgYW4gZWxlbWVudCBpbiB0aGVcbiAqICAgIHNldCBhbmQgY2FjaGVzIGl0LlxuICogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCA/RGltZW5zaW9uc0RlZj59XG4gKiBAcHJpdmF0ZSAgVmlzaWJsZSBmb3IgdGVzdGluZyBvbmx5IVxuICovXG5leHBvcnQgY29uc3QgbmF0dXJhbERpbWVuc2lvbnNfID0ge1xuICAnQU1QLVBJWEVMJzoge3dpZHRoOiAnMHB4JywgaGVpZ2h0OiAnMHB4J30sXG4gICdBTVAtQU5BTFlUSUNTJzoge3dpZHRoOiAnMXB4JywgaGVpZ2h0OiAnMXB4J30sXG4gIC8vIFRPRE8oZHZveXRlbmtvKTogYXVkaW8gc2hvdWxkIGhhdmUgd2lkdGg6YXV0by5cbiAgJ0FNUC1BVURJTyc6IG51bGwsXG4gICdBTVAtU09DSUFMLVNIQVJFJzoge3dpZHRoOiAnNjBweCcsIGhlaWdodDogJzQ0cHgnfSxcbn07XG5cblxuLyoqXG4gKiBFbGVtZW50cyB0aGF0IHRoZSBwcm9nZXNzIGNhbiBiZSBzaG93biBmb3IuIFRoaXMgc2V0IGhhcyB0byBiZSBleHRlcm5hbGl6ZWRcbiAqIHNpbmNlIHRoZSBlbGVtZW50J3MgaW1wbGVtZW50YXRpb24gbWF5IG5vdCBiZSBkb3dubG9hZGVkIHlldC5cbiAqIEBlbnVtIHtib29sZWFufVxuICogQHByaXZhdGUgIFZpc2libGUgZm9yIHRlc3Rpbmcgb25seSFcbiAqL1xuZXhwb3J0IGNvbnN0IExPQURJTkdfRUxFTUVOVFNfID0ge1xuICAnQU1QLUFOSU0nOiB0cnVlLFxuICAnQU1QLUJSSUdIVENPVkUnOiB0cnVlLFxuICAnQU1QLUdPT0dMRS1ET0NVTUVOVC1FTUJFRCc6IHRydWUsXG4gICdBTVAtRU1CRUQnOiB0cnVlLFxuICAnQU1QLUZBQ0VCT09LJzogdHJ1ZSxcbiAgJ0FNUC1GQUNFQk9PSy1DT01NRU5UUyc6IHRydWUsXG4gICdBTVAtRkFDRUJPT0stTElLRSc6IHRydWUsXG4gICdBTVAtRkFDRUJPT0stUEFHRSc6IHRydWUsXG4gICdBTVAtSUZSQU1FJzogdHJ1ZSxcbiAgJ0FNUC1JTUcnOiB0cnVlLFxuICAnQU1QLUlOU1RBR1JBTSc6IHRydWUsXG4gICdBTVAtTElTVCc6IHRydWUsXG4gICdBTVAtT09ZQUxBLVBMQVlFUic6IHRydWUsXG4gICdBTVAtUElOVEVSRVNUJzogdHJ1ZSxcbiAgJ0FNUC1QTEFZQlVaWic6IHRydWUsXG4gICdBTVAtVklERU8nOiB0cnVlLFxuICAnQU1QLVlPVVRVQkUnOiB0cnVlLFxufTtcblxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBzXG4gKiBAcmV0dXJuIHtMYXlvdXR8dW5kZWZpbmVkfSBSZXR1cm5zIHVuZGVmaW5lZCBpbiBjYXNlIG9mIGZhaWx1cmUgdG8gcGFyc2VcbiAqICAgdGhlIGxheW91dCBzdHJpbmcuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUxheW91dChzKSB7XG4gIGZvciAoY29uc3QgayBpbiBMYXlvdXQpIHtcbiAgICBpZiAoTGF5b3V0W2tdID09IHMpIHtcbiAgICAgIHJldHVybiBMYXlvdXRba107XG4gICAgfVxuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFMYXlvdXR9IGxheW91dFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGF5b3V0Q2xhc3MobGF5b3V0KSB7XG4gIHJldHVybiAnaS1hbXBodG1sLWxheW91dC0nICsgbGF5b3V0O1xufVxuXG5cbi8qKlxuICogV2hldGhlciBhbiBlbGVtZW50IHdpdGggdGhpcyBsYXlvdXQgaW5oZXJlbnRseSBkZWZpbmVzIHRoZSBzaXplLlxuICogQHBhcmFtIHshTGF5b3V0fSBsYXlvdXRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xheW91dFNpemVEZWZpbmVkKGxheW91dCkge1xuICByZXR1cm4gKGxheW91dCA9PSBMYXlvdXQuRklYRUQgfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuRklYRURfSEVJR0hUIHx8XG4gICAgICBsYXlvdXQgPT0gTGF5b3V0LlJFU1BPTlNJVkUgfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuRklMTCB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5GTEVYX0lURU0gfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuRkxVSUQgfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuSU5UUklOU0lDKTtcbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHRhZyBpcyBhbiBpbnRlcm5hbCAoc2VydmljZSkgQU1QIHRhZy5cbiAqIEBwYXJhbSB7IU5vZGV8c3RyaW5nfSB0YWdcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0ludGVybmFsRWxlbWVudCh0YWcpIHtcbiAgY29uc3QgdGFnTmFtZSA9ICh0eXBlb2YgdGFnID09ICdzdHJpbmcnKSA/IHRhZyA6IHRhZy50YWdOYW1lO1xuICByZXR1cm4gdGFnTmFtZSAmJiBzdGFydHNXaXRoKHRhZ05hbWUudG9Mb3dlckNhc2UoKSwgJ2ktJyk7XG59XG5cblxuLyoqXG4gKiBQYXJzZXMgdGhlIENTUyBsZW5ndGggdmFsdWUuIElmIG5vIHVuaXRzIHNwZWNpZmllZCwgdGhlIGFzc3VtZWQgdmFsdWUgaXNcbiAqIFwicHhcIi4gUmV0dXJucyB1bmRlZmluZWQgaW4gY2FzZSBvZiBwYXJzaW5nIGVycm9yLlxuICogQHBhcmFtIHtzdHJpbmd8dW5kZWZpbmVkfG51bGx9IHNcbiAqIEByZXR1cm4geyFMZW5ndGhEZWZ8dW5kZWZpbmVkfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VMZW5ndGgocykge1xuICBpZiAodHlwZW9mIHMgPT0gJ251bWJlcicpIHtcbiAgICByZXR1cm4gcyArICdweCc7XG4gIH1cbiAgaWYgKCFzKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIS9eXFxkKyhcXC5cXGQrKT8ocHh8ZW18cmVtfHZofHZ3fHZtaW58dm1heHxjbXxtbXxxfGlufHBjfHB0KT8kLy50ZXN0KHMpKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoL15cXGQrKFxcLlxcZCspPyQvLnRlc3QocykpIHtcbiAgICByZXR1cm4gcyArICdweCc7XG4gIH1cbiAgcmV0dXJuIHM7XG59XG5cblxuXG4vKipcbiAqIEFzc2VydHMgdGhhdCB0aGUgc3VwcGxpZWQgdmFsdWUgaXMgYSBub24tcGVyY2VudCBDU1MgTGVuZ3RoIHZhbHVlLlxuICogQHBhcmFtIHshTGVuZ3RoRGVmfHN0cmluZ3xudWxsfHVuZGVmaW5lZH0gbGVuZ3RoXG4gKiBAcmV0dXJuIHshTGVuZ3RoRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0TGVuZ3RoKGxlbmd0aCkge1xuICB1c2VyKCkuYXNzZXJ0KFxuICAgICAgL15cXGQrKFxcLlxcZCspPyhweHxlbXxyZW18dmh8dnd8dm1pbnx2bWF4fGNtfG1tfHF8aW58cGN8cHQpJC8udGVzdChsZW5ndGgpLFxuICAgICAgJ0ludmFsaWQgbGVuZ3RoIHZhbHVlOiAlcycsIGxlbmd0aCk7XG4gIHJldHVybiAvKiogQHR5cGUgeyFMZW5ndGhEZWZ9ICovIChsZW5ndGgpO1xufVxuXG5cblxuXG4vKipcbiAqIEFzc2VydHMgdGhhdCB0aGUgc3VwcGxpZWQgdmFsdWUgaXMgYSBDU1MgTGVuZ3RoIHZhbHVlXG4gKiAoaW5jbHVkaW5nIHBlcmNlbnQgdW5pdCkuXG4gKiBAcGFyYW0geyFMZW5ndGhEZWZ8c3RyaW5nfSBsZW5ndGhcbiAqIEByZXR1cm4geyFMZW5ndGhEZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRMZW5ndGhPclBlcmNlbnQobGVuZ3RoKSB7XG4gIHVzZXIoKS5hc3NlcnQoL15cXGQrKFxcLlxcZCspPyhweHxlbXxyZW18dmh8dnd8dm1pbnx2bWF4fCUpJC8udGVzdChsZW5ndGgpLFxuICAgICAgJ0ludmFsaWQgbGVuZ3RoIG9yIHBlcmNlbnQgdmFsdWU6ICVzJywgbGVuZ3RoKTtcbiAgcmV0dXJuIGxlbmd0aDtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdW5pdHMgZnJvbSB0aGUgQ1NTIGxlbmd0aCB2YWx1ZS5cbiAqIEBwYXJhbSB7IUxlbmd0aERlZnxzdHJpbmd8bnVsbHx1bmRlZmluZWR9IGxlbmd0aFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGVuZ3RoVW5pdHMobGVuZ3RoKSB7XG4gIGFzc2VydExlbmd0aChsZW5ndGgpO1xuICBkZXYoKS5hc3NlcnRTdHJpbmcobGVuZ3RoKTtcbiAgY29uc3QgbSA9IHVzZXIoKS5hc3NlcnQobGVuZ3RoLm1hdGNoKC9bYS16XSsvaSksXG4gICAgICAnRmFpbGVkIHRvIHJlYWQgdW5pdHMgZnJvbSAlcycsIGxlbmd0aCk7XG4gIHJldHVybiBtWzBdO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyB0aGUgbnVtZXJpYyB2YWx1ZSBvZiBhIENTUyBsZW5ndGggdmFsdWUuXG4gKiBAcGFyYW0geyFMZW5ndGhEZWZ8c3RyaW5nfG51bGx8dW5kZWZpbmVkfSBsZW5ndGhcbiAqIEByZXR1cm4ge251bWJlcnx1bmRlZmluZWR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRMZW5ndGhOdW1lcmFsKGxlbmd0aCkge1xuICBjb25zdCByZXMgPSBwYXJzZUZsb2F0KGxlbmd0aCk7XG4gIHJldHVybiBpc0Zpbml0ZU51bWJlcihyZXMpID8gcmVzIDogdW5kZWZpbmVkO1xufVxuXG5cbi8qKlxuICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSB0YWdOYW1lIGlzIGEga25vd24gZWxlbWVudCB0aGF0IGhhcyBuYXR1cmFsIGRpbWVuc2lvbnNcbiAqIGluIG91ciBydW50aW1lIG9yIHRoZSBicm93c2VyLlxuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWUgVGhlIGVsZW1lbnQgdGFnIG5hbWUuXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzTmF0dXJhbERpbWVuc2lvbnModGFnTmFtZSkge1xuICB0YWdOYW1lID0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xuICByZXR1cm4gbmF0dXJhbERpbWVuc2lvbnNfW3RhZ05hbWVdICE9PSB1bmRlZmluZWQ7XG59XG5cblxuLyoqXG4gKiBEZXRlcm1pbmVzIHRoZSBkZWZhdWx0IGRpbWVuc2lvbnMgZm9yIGFuIGVsZW1lbnQgd2hpY2ggY291bGQgdmFyeSBhY3Jvc3NcbiAqIGRpZmZlcmVudCBicm93c2VyIGltcGxlbWVudGF0aW9ucywgbGlrZSA8YXVkaW8+IGZvciBpbnN0YW5jZS5cbiAqIFRoaXMgb3BlcmF0aW9uIGNhbiBvbmx5IGJlIGNvbXBsZXRlZCBmb3IgYW4gZWxlbWVudCB3aGl0ZWxpc3RlZCBieVxuICogYGhhc05hdHVyYWxEaW1lbnNpb25zYC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge0RpbWVuc2lvbnNEZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXROYXR1cmFsRGltZW5zaW9ucyhlbGVtZW50KSB7XG4gIGNvbnN0IHRhZ05hbWUgPSBlbGVtZW50LnRhZ05hbWUudG9VcHBlckNhc2UoKTtcbiAgZGV2KCkuYXNzZXJ0KG5hdHVyYWxEaW1lbnNpb25zX1t0YWdOYW1lXSAhPT0gdW5kZWZpbmVkKTtcbiAgaWYgKCFuYXR1cmFsRGltZW5zaW9uc19bdGFnTmFtZV0pIHtcbiAgICBjb25zdCBkb2MgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQ7XG4gICAgY29uc3QgbmF0dXJhbFRhZ05hbWUgPSB0YWdOYW1lLnJlcGxhY2UoL15BTVBcXC0vLCAnJyk7XG4gICAgY29uc3QgdGVtcCA9IGRvYy5jcmVhdGVFbGVtZW50KG5hdHVyYWxUYWdOYW1lKTtcbiAgICAvLyBGb3IgYXVkaW8sIHNob3VsZCBuby1vcCBlbHNld2hlcmUuXG4gICAgdGVtcC5jb250cm9scyA9IHRydWU7XG4gICAgc2V0U3R5bGVzKHRlbXAsIHtcbiAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgdmlzaWJpbGl0eTogJ2hpZGRlbicsXG4gICAgfSk7XG4gICAgZG9jLmJvZHkuYXBwZW5kQ2hpbGQodGVtcCk7XG4gICAgbmF0dXJhbERpbWVuc2lvbnNfW3RhZ05hbWVdID0ge1xuICAgICAgd2lkdGg6ICh0ZW1wLi8qT0sqL29mZnNldFdpZHRoIHx8IDEpICsgJ3B4JyxcbiAgICAgIGhlaWdodDogKHRlbXAuLypPSyovb2Zmc2V0SGVpZ2h0IHx8IDEpICsgJ3B4JyxcbiAgICB9O1xuICAgIGRvYy5ib2R5LnJlbW92ZUNoaWxkKHRlbXApO1xuICB9XG4gIHJldHVybiAvKiogQHR5cGUge0RpbWVuc2lvbnNEZWZ9ICovIChuYXR1cmFsRGltZW5zaW9uc19bdGFnTmFtZV0pO1xufVxuXG5cbi8qKlxuICogV2hldGhlciB0aGUgbG9hZGluZyBjYW4gYmUgc2hvd24gZm9yIHRoZSBzcGVjaWZpZWQgZWxlbWVlbnQuIFRoaXMgc2V0IGhhc1xuICogdG8gYmUgZXh0ZXJuYWxpemVkIHNpbmNlIHRoZSBlbGVtZW50J3MgaW1wbGVtZW50YXRpb24gbWF5IG5vdCBiZVxuICogZG93bmxvYWRlZCB5ZXQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNMb2FkaW5nQWxsb3dlZChlbGVtZW50KSB7XG4gIGNvbnN0IHRhZ05hbWUgPSBlbGVtZW50LnRhZ05hbWUudG9VcHBlckNhc2UoKTtcbiAgaWYgKHRhZ05hbWUgPT0gJ0FNUC1BRCcgfHwgdGFnTmFtZSA9PSAnQU1QLUVNQkVEJykge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBMT0FESU5HX0VMRU1FTlRTX1t0YWdOYW1lXSB8fCBmYWxzZTtcbn1cblxuXG4vKipcbiAqIEFwcGxpZXMgbGF5b3V0IHRvIHRoZSBlbGVtZW50LiBWaXNpYmxlIGZvciB0ZXN0aW5nIG9ubHkuXG4gKlxuICogXFwgICBcXCAgLyAgXFwgIC8gICAvIC8gICBcXCAgICAgfCAgIF8gIFxcICAgICB8ICBcXCB8ICB8IHwgIHwgfCAgXFwgfCAgfCAgLyBfX19fX3xcbiAqICBcXCAgIFxcLyAgICBcXC8gICAvIC8gIF4gIFxcICAgIHwgIHxfKSAgfCAgICB8ICAgXFx8ICB8IHwgIHwgfCAgIFxcfCAgfCB8ICB8ICBfX1xuICogICBcXCAgICAgICAgICAgIC8gLyAgL19cXCAgXFwgICB8ICAgICAgLyAgICAgfCAgLiBgICB8IHwgIHwgfCAgLiBgICB8IHwgIHwgfF8gfFxuICogICAgXFwgICAgL1xcICAgIC8gLyAgX19fX18gIFxcICB8ICB8XFwgIFxcLS0tLS58ICB8XFwgICB8IHwgIHwgfCAgfFxcICAgfCB8ICB8X198IHxcbiAqICAgICBcXF9fLyAgXFxfXy8gL19fLyAgICAgXFxfX1xcIHwgX3wgYC5fX19fX3x8X198IFxcX198IHxfX3wgfF9ffCBcXF9ffCAgXFxfX19fX198XG4gKlxuICogVGhlIGVxdWl2YWxlbnQgb2YgdGhpcyBtZXRob2QgaXMgdXNlZCBmb3Igc2VydmVyLXNpZGUgcmVuZGVyaW5nIChTU1IpIGFuZFxuICogYW55IGNoYW5nZXMgbWFkZSB0byBpdCBtdXN0IGJlIG1hZGUgaW4gY29vcmRpbmF0aW9uIHdpdGggY2FjaGVzIHRoYXRcbiAqIGltcGxlbWVudCBTU1IuIEZvciBtb3JlIGluZm9ybWF0aW9uIG9uIFNTUiBzZWUgYml0Lmx5L2FtcC1zc3IuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7IUxheW91dH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5U3RhdGljTGF5b3V0KGVsZW1lbnQpIHtcbiAgLy8gQ2hlY2sgaWYgdGhlIGxheW91dCBoYXMgYWxyZWFkeSBiZWVuIGRvbmUgYnkgc2VydmVyLXNpZGUgcmVuZGVyaW5nLiBUaGVcbiAgLy8gZG9jdW1lbnQgbWF5IGJlIHZpc2libGUgdG8gdGhlIHVzZXIgaWYgdGhlIGJvaWxlcnBsYXRlIHdhcyByZW1vdmVkIHNvXG4gIC8vIHBsZWFzZSB0YWtlIGNhcmUgaW4gbWFraW5nIGNoYW5nZXMgaGVyZS5cbiAgY29uc3QgY29tcGxldGVkTGF5b3V0QXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdpLWFtcGh0bWwtbGF5b3V0Jyk7XG4gIGlmIChjb21wbGV0ZWRMYXlvdXRBdHRyKSB7XG4gICAgY29uc3QgbGF5b3V0ID0gLyoqIEB0eXBlIHshTGF5b3V0fSAqLyAoZGV2KCkuYXNzZXJ0KFxuICAgICAgICBwYXJzZUxheW91dChjb21wbGV0ZWRMYXlvdXRBdHRyKSkpO1xuICAgIGlmICgobGF5b3V0ID09IExheW91dC5SRVNQT05TSVZFIHx8IGxheW91dCA9PSBMYXlvdXQuSU5UUklOU0lDKVxuICAgICAgJiYgZWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZCkge1xuICAgICAgLy8gRmluZCBzaXplciwgYnV0IGFzc3VtZSB0aGF0IGl0IG1pZ2h0IG5vdCBoYXZlIGJlZW4gcGFyc2VkIHlldC5cbiAgICAgIGVsZW1lbnQuc2l6ZXJFbGVtZW50ID1cbiAgICAgICAgICBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2ktYW1waHRtbC1zaXplcicpIHx8IHVuZGVmaW5lZDtcbiAgICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuTk9ESVNQTEFZKSB7XG4gICAgICBhcHBseU5vRGlzcGxheUxheW91dChlbGVtZW50KTtcbiAgICB9XG4gICAgcmV0dXJuIGxheW91dDtcbiAgfVxuXG4gIC8vIElmIHRoZSBsYXlvdXQgd2FzIGFscmVhZHkgZG9uZSBieSBzZXJ2ZXItc2lkZSByZW5kZXJpbmcgKFNTUiksIHRoZW4gdGhlXG4gIC8vIGNvZGUgYmVsb3cgd2lsbCBub3QgcnVuLiBBbnkgY2hhbmdlcyBiZWxvdyB3aWxsIG5lY2Vzc2l0YXRlIGEgY2hhbmdlIHRvIFNTUlxuICAvLyBhbmQgbXVzdCBiZSBjb29yZGluYXRlZCB3aXRoIGNhY2hlcyB0aGF0IGltcGxlbWVudCBTU1IuIFNlZSBiaXQubHkvYW1wLXNzci5cblxuICAvLyBQYXJzZSBsYXlvdXQgZnJvbSB0aGUgZWxlbWVudC5cbiAgY29uc3QgbGF5b3V0QXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdsYXlvdXQnKTtcbiAgY29uc3Qgd2lkdGhBdHRyID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3dpZHRoJyk7XG4gIGNvbnN0IGhlaWdodEF0dHIgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnaGVpZ2h0Jyk7XG4gIGNvbnN0IHNpemVzQXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdzaXplcycpO1xuICBjb25zdCBoZWlnaHRzQXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdoZWlnaHRzJyk7XG5cbiAgLy8gSW5wdXQgbGF5b3V0IGF0dHJpYnV0ZXMuXG4gIGNvbnN0IGlucHV0TGF5b3V0ID0gbGF5b3V0QXR0ciA/IHBhcnNlTGF5b3V0KGxheW91dEF0dHIpIDogbnVsbDtcbiAgdXNlcigpLmFzc2VydChpbnB1dExheW91dCAhPT0gdW5kZWZpbmVkLCAnVW5rbm93biBsYXlvdXQ6ICVzJywgbGF5b3V0QXR0cik7XG4gIC8qKiBAY29uc3Qge3N0cmluZ3xudWxsfHVuZGVmaW5lZH0gKi9cbiAgY29uc3QgaW5wdXRXaWR0aCA9ICh3aWR0aEF0dHIgJiYgd2lkdGhBdHRyICE9ICdhdXRvJykgP1xuICAgIHBhcnNlTGVuZ3RoKHdpZHRoQXR0cikgOiB3aWR0aEF0dHI7XG4gIHVzZXIoKS5hc3NlcnQoaW5wdXRXaWR0aCAhPT0gdW5kZWZpbmVkLCAnSW52YWxpZCB3aWR0aCB2YWx1ZTogJXMnLCB3aWR0aEF0dHIpO1xuICAvKiogQGNvbnN0IHtzdHJpbmd8bnVsbHx1bmRlZmluZWR9ICovXG4gIGNvbnN0IGlucHV0SGVpZ2h0ID0gKGhlaWdodEF0dHIgJiYgaGVpZ2h0QXR0ciAhPSAnZmx1aWQnKSA/XG4gICAgcGFyc2VMZW5ndGgoaGVpZ2h0QXR0cikgOiBoZWlnaHRBdHRyO1xuICB1c2VyKCkuYXNzZXJ0KGlucHV0SGVpZ2h0ICE9PSB1bmRlZmluZWQsICdJbnZhbGlkIGhlaWdodCB2YWx1ZTogJXMnLFxuICAgICAgaGVpZ2h0QXR0cik7XG5cbiAgLy8gRWZmZWN0aXZlIGxheW91dCBhdHRyaWJ1dGVzLiBUaGVzZSBhcmUgZWZmZWN0aXZlbHkgY29uc3RhbnRzLlxuICBsZXQgd2lkdGg7XG4gIGxldCBoZWlnaHQ7XG4gIGxldCBsYXlvdXQ7XG5cbiAgLy8gQ2FsY3VsYXRlIGVmZmVjdGl2ZSB3aWR0aCBhbmQgaGVpZ2h0LlxuICBpZiAoKCFpbnB1dExheW91dCB8fCBpbnB1dExheW91dCA9PSBMYXlvdXQuRklYRUQgfHxcbiAgICAgIGlucHV0TGF5b3V0ID09IExheW91dC5GSVhFRF9IRUlHSFQpICYmXG4gICAgICAoIWlucHV0V2lkdGggfHwgIWlucHV0SGVpZ2h0KSAmJiBoYXNOYXR1cmFsRGltZW5zaW9ucyhlbGVtZW50LnRhZ05hbWUpKSB7XG4gICAgLy8gRGVmYXVsdCB3aWR0aCBhbmQgaGVpZ2h0OiBoYW5kbGUgZWxlbWVudHMgdGhhdCBkbyBub3Qgc3BlY2lmeSBhXG4gICAgLy8gd2lkdGgvaGVpZ2h0IGFuZCBhcmUgZGVmaW5lZCB0byBoYXZlIG5hdHVyYWwgYnJvd3NlciBkaW1lbnNpb25zLlxuICAgIGNvbnN0IGRpbWVuc2lvbnMgPSBnZXROYXR1cmFsRGltZW5zaW9ucyhlbGVtZW50KTtcbiAgICB3aWR0aCA9IChpbnB1dFdpZHRoIHx8IGlucHV0TGF5b3V0ID09IExheW91dC5GSVhFRF9IRUlHSFQpID8gaW5wdXRXaWR0aCA6XG4gICAgICBkaW1lbnNpb25zLndpZHRoO1xuICAgIGhlaWdodCA9IGlucHV0SGVpZ2h0IHx8IGRpbWVuc2lvbnMuaGVpZ2h0O1xuICB9IGVsc2Uge1xuICAgIHdpZHRoID0gaW5wdXRXaWR0aDtcbiAgICBoZWlnaHQgPSBpbnB1dEhlaWdodDtcbiAgfVxuXG4gIC8vIENhbGN1bGF0ZSBlZmZlY3RpdmUgbGF5b3V0LlxuICBpZiAoaW5wdXRMYXlvdXQpIHtcbiAgICBsYXlvdXQgPSBpbnB1dExheW91dDtcbiAgfSBlbHNlIGlmICghd2lkdGggJiYgIWhlaWdodCkge1xuICAgIGxheW91dCA9IExheW91dC5DT05UQUlORVI7XG4gIH0gZWxzZSBpZiAoaGVpZ2h0ID09ICdmbHVpZCcpIHtcbiAgICBsYXlvdXQgPSBMYXlvdXQuRkxVSUQ7XG4gIH0gZWxzZSBpZiAoaGVpZ2h0ICYmICghd2lkdGggfHwgd2lkdGggPT0gJ2F1dG8nKSkge1xuICAgIGxheW91dCA9IExheW91dC5GSVhFRF9IRUlHSFQ7XG4gIH0gZWxzZSBpZiAoaGVpZ2h0ICYmIHdpZHRoICYmIChzaXplc0F0dHIgfHwgaGVpZ2h0c0F0dHIpKSB7XG4gICAgbGF5b3V0ID0gTGF5b3V0LlJFU1BPTlNJVkU7XG4gIH0gZWxzZSB7XG4gICAgbGF5b3V0ID0gTGF5b3V0LkZJWEVEO1xuICB9XG5cbiAgLy8gVmVyaWZ5IGxheW91dCBhdHRyaWJ1dGVzLlxuICBpZiAobGF5b3V0ID09IExheW91dC5GSVhFRCB8fCBsYXlvdXQgPT0gTGF5b3V0LkZJWEVEX0hFSUdIVCB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5SRVNQT05TSVZFIHx8IGxheW91dCA9PSBMYXlvdXQuSU5UUklOU0lDKSB7XG4gICAgdXNlcigpLmFzc2VydChoZWlnaHQsICdFeHBlY3RlZCBoZWlnaHQgdG8gYmUgYXZhaWxhYmxlOiAlcycsIGhlaWdodEF0dHIpO1xuICB9XG4gIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZJWEVEX0hFSUdIVCkge1xuICAgIHVzZXIoKS5hc3NlcnQoIXdpZHRoIHx8IHdpZHRoID09ICdhdXRvJyxcbiAgICAgICAgJ0V4cGVjdGVkIHdpZHRoIHRvIGJlIGVpdGhlciBhYnNlbnQgb3IgZXF1YWwgXCJhdXRvXCIgJyArXG4gICAgICAgICdmb3IgZml4ZWQtaGVpZ2h0IGxheW91dDogJXMnLCB3aWR0aEF0dHIpO1xuICB9XG4gIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZJWEVEIHx8IGxheW91dCA9PSBMYXlvdXQuUkVTUE9OU0lWRSB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5JTlRSSU5TSUMpIHtcbiAgICB1c2VyKCkuYXNzZXJ0KHdpZHRoICYmIHdpZHRoICE9ICdhdXRvJyxcbiAgICAgICAgJ0V4cGVjdGVkIHdpZHRoIHRvIGJlIGF2YWlsYWJsZSBhbmQgbm90IGVxdWFsIHRvIFwiYXV0b1wiOiAlcycsXG4gICAgICAgIHdpZHRoQXR0cik7XG4gIH1cblxuICBpZiAobGF5b3V0ID09IExheW91dC5SRVNQT05TSVZFIHx8IGxheW91dCA9PSBMYXlvdXQuSU5UUklOU0lDKSB7XG4gICAgdXNlcigpLmFzc2VydChnZXRMZW5ndGhVbml0cyh3aWR0aCkgPT0gZ2V0TGVuZ3RoVW5pdHMoaGVpZ2h0KSxcbiAgICAgICAgJ0xlbmd0aCB1bml0cyBzaG91bGQgYmUgdGhlIHNhbWUgZm9yIHdpZHRoIGFuZCBoZWlnaHQ6ICVzLCAlcycsXG4gICAgICAgIHdpZHRoQXR0ciwgaGVpZ2h0QXR0cik7XG4gIH0gZWxzZSB7XG4gICAgdXNlcigpLmFzc2VydChoZWlnaHRzQXR0ciA9PT0gbnVsbCxcbiAgICAgICAgJ1VuZXhwZWN0ZWQgXCJoZWlnaHRzXCIgYXR0cmlidXRlIGZvciBub25lLXJlc3BvbnNpdmUgbGF5b3V0Jyk7XG4gIH1cblxuICAvLyBBcHBseSBVSS5cbiAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGdldExheW91dENsYXNzKGxheW91dCkpO1xuICBpZiAoaXNMYXlvdXRTaXplRGVmaW5lZChsYXlvdXQpKSB7XG4gICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdpLWFtcGh0bWwtbGF5b3V0LXNpemUtZGVmaW5lZCcpO1xuICB9XG4gIGlmIChsYXlvdXQgPT0gTGF5b3V0Lk5PRElTUExBWSkge1xuICAgIC8vIENTUyBkZWZpbmVzIGxheW91dD1ub2Rpc3BsYXkgYXV0b21hdGljYWxseSB3aXRoIGBkaXNwbGF5Om5vbmVgLiBUaHVzXG4gICAgLy8gbm8gYWRkaXRpb25hbCBzdHlsaW5nIGlzIG5lZWRlZC5cbiAgICBhcHBseU5vRGlzcGxheUxheW91dChlbGVtZW50KTtcbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZJWEVEKSB7XG4gICAgc2V0U3R5bGVzKGVsZW1lbnQsIHtcbiAgICAgIHdpZHRoOiBkZXYoKS5hc3NlcnRTdHJpbmcod2lkdGgpLFxuICAgICAgaGVpZ2h0OiBkZXYoKS5hc3NlcnRTdHJpbmcoaGVpZ2h0KSxcbiAgICB9KTtcbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZJWEVEX0hFSUdIVCkge1xuICAgIHNldFN0eWxlKGVsZW1lbnQsICdoZWlnaHQnLCBkZXYoKS5hc3NlcnRTdHJpbmcoaGVpZ2h0KSk7XG4gIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5SRVNQT05TSVZFKSB7XG4gICAgY29uc3Qgc2l6ZXIgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaS1hbXBodG1sLXNpemVyJyk7XG4gICAgc2V0U3R5bGVzKHNpemVyLCB7XG4gICAgICBkaXNwbGF5OiAnYmxvY2snLFxuICAgICAgcGFkZGluZ1RvcDpcbiAgICAgICAgKChnZXRMZW5ndGhOdW1lcmFsKGhlaWdodCkgLyBnZXRMZW5ndGhOdW1lcmFsKHdpZHRoKSkgKiAxMDApICsgJyUnLFxuICAgIH0pO1xuICAgIGVsZW1lbnQuaW5zZXJ0QmVmb3JlKHNpemVyLCBlbGVtZW50LmZpcnN0Q2hpbGQpO1xuICAgIGVsZW1lbnQuc2l6ZXJFbGVtZW50ID0gc2l6ZXI7XG4gIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5JTlRSSU5TSUMpIHtcbiAgICAvLyBJbnRyaW5zaWMgdXNlcyBhbiBzdmcgaW5zaWRlIHRoZSBzaXplciBlbGVtZW50IHJhdGhlciB0aGFuIHRoZSBwYWRkaW5nXG4gICAgLy8gdHJpY2sgTm90ZSBhIG5ha2VkIHN2ZyB3b24ndCB3b3JrIGJlY2FzdWUgb3RoZXIgdGhpbmcgZXhwZWN0IHRoZVxuICAgIC8vIGktYW1waHRtbC1zaXplciBlbGVtZW50XG4gICAgY29uc3Qgc2l6ZXIgPSBodG1sRm9yKGVsZW1lbnQpYFxuICAgICAgPGktYW1waHRtbC1zaXplciBjbGFzcz1cImktYW1waHRtbC1zaXplclwiPlxuICAgICAgICA8aW1nIGNsYXNzPVwiaS1hbXBodG1sLWludHJpbnNpYy1zaXplclwiIC8+XG4gICAgICA8L2ktYW1waHRtbC1zaXplcj5gO1xuICAgIGNvbnN0IGludHJpbnNpY1NpemVyID0gc2l6ZXIuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgaW50cmluc2ljU2l6ZXIuc2V0QXR0cmlidXRlKCdzcmMnLFxuICAgICAgICBgZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgsPHN2ZyBoZWlnaHQ9XCIke2hlaWdodH1cIiB3aWR0aD1cIiR7d2lkdGh9XCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZlcnNpb249XCIxLjFcIi8+YCk7XG4gICAgZWxlbWVudC5pbnNlcnRCZWZvcmUoc2l6ZXIsIGVsZW1lbnQuZmlyc3RDaGlsZCk7XG4gICAgLy8gVE9ETyhqcGV0dGl0dCk6IHNpemVyIGlzIGxlYWtlZCBhbmQgY2FuJ3QgYmUgY2xlYW5lZCB1cC5cbiAgICBlbGVtZW50LnNpemVyRWxlbWVudCA9IGludHJpbnNpY1NpemVyO1xuICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuRklMTCkge1xuICAgIC8vIERvIG5vdGhpbmcuXG4gIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5DT05UQUlORVIpIHtcbiAgICAvLyBEbyBub3RoaW5nLiBFbGVtZW50cyB0aGVtc2VsdmVzIHdpbGwgY2hlY2sgd2hldGhlciB0aGUgc3VwcGxpZWRcbiAgICAvLyBsYXlvdXQgdmFsdWUgaXMgYWNjZXB0YWJsZS4gSW4gcGFydGljdWxhciBjb250YWluZXIgaXMgb25seSBPS1xuICAgIC8vIHNvbWV0aW1lcy5cbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZMRVhfSVRFTSkge1xuICAgIC8vIFNldCBoZWlnaHQgYW5kIHdpZHRoIHRvIGEgZmxleCBpdGVtIGlmIHRoZXkgZXhpc3QuXG4gICAgLy8gVGhlIHNpemUgc2V0IHRvIGEgZmxleCBpdGVtIGNvdWxkIGJlIG92ZXJyaWRkZW4gYnkgYGRpc3BsYXk6IGZsZXhgIGxhdGVyLlxuICAgIGlmICh3aWR0aCkge1xuICAgICAgc2V0U3R5bGUoZWxlbWVudCwgJ3dpZHRoJywgd2lkdGgpO1xuICAgIH1cbiAgICBpZiAoaGVpZ2h0KSB7XG4gICAgICBzZXRTdHlsZShlbGVtZW50LCAnaGVpZ2h0JywgaGVpZ2h0KTtcbiAgICB9XG4gIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5GTFVJRCkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaS1hbXBodG1sLWxheW91dC1hd2FpdGluZy1zaXplJyk7XG4gICAgaWYgKHdpZHRoKSB7XG4gICAgICBzZXRTdHlsZShlbGVtZW50LCAnd2lkdGgnLCB3aWR0aCk7XG4gICAgfVxuICAgIHNldFN0eWxlKGVsZW1lbnQsICdoZWlnaHQnLCAwKTtcbiAgfVxuICByZXR1cm4gbGF5b3V0O1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICovXG5mdW5jdGlvbiBhcHBseU5vRGlzcGxheUxheW91dChlbGVtZW50KSB7XG4gIC8vIFRPRE8oZHZveXRlbmtvLCAjOTM1Myk6IG9uY2UgYHRvZ2dsZUxheW91dERpc3BsYXlgIEFQSSBoYXMgYmVlbiBkZXBsb3llZFxuICAvLyBldmVyeXdoZXJlLCBzd2l0Y2ggYWxsIHJlbGV2YW50IGVsZW1lbnRzIHRvIHRoaXMgQVBJLiBJbiB0aGUgbWVhbnRpbWUsXG4gIC8vIHNpbXBseSB1bmJsb2NrIGRpc3BsYXkgdG9nZ2xpbmcgdmlhIGBzdHlsZT1cImRpc3BsYXk6IC4uLlwiYC5cbiAgc2V0U3R5bGUoZWxlbWVudCwgJ2Rpc3BsYXknLCAnbm9uZScpO1xuICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2ktYW1waHRtbC1kaXNwbGF5Jyk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuL21vZGUnO1xuaW1wb3J0IHtnZXRNb2RlT2JqZWN0fSBmcm9tICcuL21vZGUtb2JqZWN0JztcbmltcG9ydCB7aXNFbnVtVmFsdWV9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIFRyaXBsZSB6ZXJvIHdpZHRoIHNwYWNlLlxuICpcbiAqIFRoaXMgaXMgYWRkZWQgdG8gdXNlciBlcnJvciBtZXNzYWdlcywgc28gdGhhdCB3ZSBjYW4gbGF0ZXIgaWRlbnRpZnlcbiAqIHRoZW0sIHdoZW4gdGhlIG9ubHkgdGhpbmcgdGhhdCB3ZSBoYXZlIGlzIHRoZSBtZXNzYWdlLiBUaGlzIGlzIHRoZVxuICogY2FzZSBpbiBtYW55IGJyb3dzZXJzIHdoZW4gdGhlIGdsb2JhbCBleGNlcHRpb24gaGFuZGxlciBpcyBpbnZva2VkLlxuICpcbiAqIEBjb25zdCB7c3RyaW5nfVxuICovXG5leHBvcnQgY29uc3QgVVNFUl9FUlJPUl9TRU5USU5FTCA9ICdcXHUyMDBCXFx1MjAwQlxcdTIwMEInO1xuXG5cbi8qKlxuICogRm91ciB6ZXJvIHdpZHRoIHNwYWNlLlxuICpcbiAqIEBjb25zdCB7c3RyaW5nfVxuICovXG5leHBvcnQgY29uc3QgVVNFUl9FUlJPUl9FTUJFRF9TRU5USU5FTCA9ICdcXHUyMDBCXFx1MjAwQlxcdTIwMEJcXHUyMDBCJztcblxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoaXMgbWVzc2FnZSB3YXMgYSB1c2VyIGVycm9yLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNVc2VyRXJyb3JNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgcmV0dXJuIG1lc3NhZ2UuaW5kZXhPZihVU0VSX0VSUk9SX1NFTlRJTkVMKSA+PSAwO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoaXMgbWVzc2FnZSB3YXMgYSBhIHVzZXIgZXJyb3IgZnJvbSBhbiBpZnJhbWUgZW1iZWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1VzZXJFcnJvckVtYmVkKG1lc3NhZ2UpIHtcbiAgcmV0dXJuIG1lc3NhZ2UuaW5kZXhPZihVU0VSX0VSUk9SX0VNQkVEX1NFTlRJTkVMKSA+PSAwO1xufVxuXG5cbi8qKlxuICogQGVudW0ge251bWJlcn1cbiAqIEBwcml2YXRlIFZpc2libGUgZm9yIHRlc3Rpbmcgb25seS5cbiAqL1xuZXhwb3J0IGNvbnN0IExvZ0xldmVsID0ge1xuICBPRkY6IDAsXG4gIEVSUk9SOiAxLFxuICBXQVJOOiAyLFxuICBJTkZPOiAzLFxuICBGSU5FOiA0LFxufTtcblxuLyoqXG4gKiBTZXRzIHJlcG9ydEVycm9yIGZ1bmN0aW9uLiBDYWxsZWQgZnJvbSBlcnJvci5qcyB0byBicmVhayBjeWNsaWNcbiAqIGRlcGVuZGVuY3kuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCosICFFbGVtZW50PSl8dW5kZWZpbmVkfSBmblxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0UmVwb3J0RXJyb3IoZm4pIHtcbiAgc2VsZi5yZXBvcnRFcnJvciA9IGZuO1xufVxuXG4vKipcbiAqIEB0eXBlIHshTG9nTGV2ZWx8dW5kZWZpbmVkfVxuICogQHByaXZhdGVcbiAqL1xubGV0IGxldmVsT3ZlcnJpZGVfID0gdW5kZWZpbmVkO1xuXG4vKipcbiAqIEBwYXJhbSB7IUxvZ0xldmVsfSBsZXZlbFxuICovXG5leHBvcnQgZnVuY3Rpb24gb3ZlcnJpZGVMb2dMZXZlbChsZXZlbCkge1xuICBsZXZlbE92ZXJyaWRlXyA9IGxldmVsO1xufVxuXG4vKipcbiAqIExvZ2dpbmcgY2xhc3MuIFVzZSBvZiBzZW50aW5lbCBzdHJpbmcgaW5zdGVhZCBvZiBhIGJvb2xlYW4gdG8gY2hlY2sgdXNlci9kZXZcbiAqIGVycm9ycyBiZWNhdXNlIGVycm9ycyBjb3VsZCBiZSByZXRocm93biBieSBzb21lIG5hdGl2ZSBjb2RlIGFzIGEgbmV3IGVycm9yLFxuICogYW5kIG9ubHkgYSBtZXNzYWdlIHdvdWxkIHN1cnZpdmUuIEFsc28sIHNvbWUgYnJvd3NlciBkb27igJl0IHN1cHBvcnQgYSA1dGhcbiAqIGVycm9yIG9iamVjdCBhcmd1bWVudCBpbiB3aW5kb3cub25lcnJvci4gTGlzdCBvZiBzdXBwb3J0aW5nIGJyb3dzZXIgY2FuIGJlXG4gKiBmb3VuZCBoZXJlOlxuICogaHR0cHM6Ly9ibG9nLnNlbnRyeS5pby8yMDE2LzAxLzA0L2NsaWVudC1qYXZhc2NyaXB0LXJlcG9ydGluZy13aW5kb3ctb25lcnJvci5odG1sXG4gKiBAZmluYWxcbiAqIEBwcml2YXRlIFZpc2libGUgZm9yIHRlc3Rpbmcgb25seS5cbiAqL1xuZXhwb3J0IGNsYXNzIExvZyB7XG4gIC8qKlxuICAgKiBvcHRfc3VmZml4IHdpbGwgYmUgYXBwZW5kZWQgdG8gZXJyb3IgbWVzc2FnZSB0byBpZGVudGlmeSB0aGUgdHlwZSBvZiB0aGVcbiAgICogZXJyb3IgbWVzc2FnZS4gV2UgY2FuJ3QgcmVseSBvbiB0aGUgZXJyb3Igb2JqZWN0IHRvIHBhc3MgYWxvbmcgdGhlIHR5cGVcbiAgICogYmVjYXVzZSBzb21lIGJyb3dzZXJzIGRvIG5vdCBoYXZlIHRoaXMgcGFyYW0gaW4gaXRzIHdpbmRvdy5vbmVycm9yIEFQSS5cbiAgICogU2VlOlxuICAgKiBodHRwczovL2Jsb2cuc2VudHJ5LmlvLzIwMTYvMDEvMDQvY2xpZW50LWphdmFzY3JpcHQtcmVwb3J0aW5nLXdpbmRvdy1vbmVycm9yLmh0bWxcbiAgICpcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHBhcmFtIHtmdW5jdGlvbighLi9tb2RlLk1vZGVEZWYpOiFMb2dMZXZlbH0gbGV2ZWxGdW5jXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X3N1ZmZpeFxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luLCBsZXZlbEZ1bmMsIG9wdF9zdWZmaXgpIHtcbiAgICAvKipcbiAgICAgKiBJbiB0ZXN0cyB3ZSB1c2UgdGhlIG1haW4gdGVzdCB3aW5kb3cgaW5zdGVhZCBvZiB0aGUgaWZyYW1lIHdoZXJlXG4gICAgICogdGhlIHRlc3RzIHJ1bnMgYmVjYXVzZSBvbmx5IHRoZSBmb3JtZXIgaXMgcmVsYXllZCB0byB0aGUgY29uc29sZS5cbiAgICAgKiBAY29uc3QgeyFXaW5kb3d9XG4gICAgICovXG4gICAgdGhpcy53aW4gPSAoZ2V0TW9kZSgpLnRlc3QgJiYgd2luLkFNUF9URVNUX0lGUkFNRSkgPyB3aW4ucGFyZW50IDogd2luO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7ZnVuY3Rpb24oIS4vbW9kZS5Nb2RlRGVmKTohTG9nTGV2ZWx9ICovXG4gICAgdGhpcy5sZXZlbEZ1bmNfID0gbGV2ZWxGdW5jO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IUxvZ0xldmVsfSAqL1xuICAgIHRoaXMubGV2ZWxfID0gdGhpcy5kZWZhdWx0TGV2ZWxfKCk7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtzdHJpbmd9ICovXG4gICAgdGhpcy5zdWZmaXhfID0gb3B0X3N1ZmZpeCB8fCAnJztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshTG9nTGV2ZWx9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRMZXZlbF8oKSB7XG4gICAgcmV0dXJuIChsZXZlbE92ZXJyaWRlXyAhPT0gdW5kZWZpbmVkKSA/IGxldmVsT3ZlcnJpZGVfIDogdGhpcy5sZXZlbF87XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IUxvZ0xldmVsfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZGVmYXVsdExldmVsXygpIHtcbiAgICAvLyBObyBjb25zb2xlIC0gY2FuJ3QgZW5hYmxlIGxvZ2dpbmcuXG4gICAgaWYgKCF0aGlzLndpbi5jb25zb2xlIHx8ICF0aGlzLndpbi5jb25zb2xlLmxvZykge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLk9GRjtcbiAgICB9XG5cbiAgICAvLyBMb2dnaW5nIGhhcyBiZWVuIGV4cGxpY2l0bHkgZGlzYWJsZWQuXG4gICAgaWYgKGdldE1vZGUoKS5sb2cgPT0gJzAnKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuT0ZGO1xuICAgIH1cblxuICAgIC8vIExvZ2dpbmcgaXMgZW5hYmxlZCBmb3IgdGVzdHMgZGlyZWN0bHkuXG4gICAgaWYgKGdldE1vZGUoKS50ZXN0ICYmIHRoaXMud2luLkVOQUJMRV9MT0cpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5GSU5FO1xuICAgIH1cblxuICAgIC8vIExvY2FsRGV2IGJ5IGRlZmF1bHQgYWxsb3dzIElORk8gbGV2ZWwsIHVubGVzcyBvdmVycmlkZW4gYnkgYCNsb2dgLlxuICAgIGlmIChnZXRNb2RlKCkubG9jYWxEZXYgJiYgIWdldE1vZGUoKS5sb2cpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5JTkZPO1xuICAgIH1cblxuICAgIC8vIERlbGVnYXRlIHRvIHRoZSBzcGVjaWZpYyByZXNvbHZlci5cbiAgICByZXR1cm4gdGhpcy5sZXZlbEZ1bmNfKGdldE1vZGVPYmplY3QoKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0ge3N0cmluZ30gbGV2ZWxcbiAgICogQHBhcmFtIHshQXJyYXl9IG1lc3NhZ2VzXG4gICAqL1xuICBtc2dfKHRhZywgbGV2ZWwsIG1lc3NhZ2VzKSB7XG4gICAgaWYgKHRoaXMuZ2V0TGV2ZWxfKCkgIT0gTG9nTGV2ZWwuT0ZGKSB7XG4gICAgICBsZXQgZm4gPSB0aGlzLndpbi5jb25zb2xlLmxvZztcbiAgICAgIGlmIChsZXZlbCA9PSAnRVJST1InKSB7XG4gICAgICAgIGZuID0gdGhpcy53aW4uY29uc29sZS5lcnJvciB8fCBmbjtcbiAgICAgIH0gZWxzZSBpZiAobGV2ZWwgPT0gJ0lORk8nKSB7XG4gICAgICAgIGZuID0gdGhpcy53aW4uY29uc29sZS5pbmZvIHx8IGZuO1xuICAgICAgfSBlbHNlIGlmIChsZXZlbCA9PSAnV0FSTicpIHtcbiAgICAgICAgZm4gPSB0aGlzLndpbi5jb25zb2xlLndhcm4gfHwgZm47XG4gICAgICB9XG4gICAgICBpZiAoZ2V0TW9kZSgpLmxvY2FsRGV2KSB7XG4gICAgICAgIG1lc3NhZ2VzLnVuc2hpZnQoJ1snICsgdGFnICsgJ10nKTtcbiAgICAgIH1cbiAgICAgIGZuLmFwcGx5KHRoaXMud2luLmNvbnNvbGUsIG1lc3NhZ2VzKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciB0aGUgbG9nZ2luZyBpcyBlbmFibGVkLlxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgaXNFbmFibGVkKCkge1xuICAgIHJldHVybiB0aGlzLmdldExldmVsXygpICE9IExvZ0xldmVsLk9GRjtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGEgZmluZS1ncmFpbmVkIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKi9cbiAgZmluZSh0YWcsIHZhcl9hcmdzKSB7XG4gICAgaWYgKHRoaXMuZ2V0TGV2ZWxfKCkgPj0gTG9nTGV2ZWwuRklORSkge1xuICAgICAgdGhpcy5tc2dfKHRhZywgJ0ZJTkUnLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVwb3J0cyBhIGluZm9ybWF0aW9uYWwgbWVzc2FnZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqL1xuICBpbmZvKHRhZywgdmFyX2FyZ3MpIHtcbiAgICBpZiAodGhpcy5nZXRMZXZlbF8oKSA+PSBMb2dMZXZlbC5JTkZPKSB7XG4gICAgICB0aGlzLm1zZ18odGFnLCAnSU5GTycsIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGEgd2FybmluZyBtZXNzYWdlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICovXG4gIHdhcm4odGFnLCB2YXJfYXJncykge1xuICAgIGlmICh0aGlzLmdldExldmVsXygpID49IExvZ0xldmVsLldBUk4pIHtcbiAgICAgIHRoaXMubXNnXyh0YWcsICdXQVJOJywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9ydHMgYW4gZXJyb3IgbWVzc2FnZS4gSWYgdGhlIGxvZ2dpbmcgaXMgZGlzYWJsZWQsIHRoZSBlcnJvciBpcyByZXRocm93blxuICAgKiBhc3luY2hyb25vdXNseS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqIEByZXR1cm4geyFFcnJvcnx1bmRlZmluZWR9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBlcnJvcl8odGFnLCB2YXJfYXJncykge1xuICAgIGlmICh0aGlzLmdldExldmVsXygpID49IExvZ0xldmVsLkVSUk9SKSB7XG4gICAgICB0aGlzLm1zZ18odGFnLCAnRVJST1InLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZXJyb3IgPSBjcmVhdGVFcnJvclZhcmdzLmFwcGx5KG51bGwsXG4gICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgICB0aGlzLnByZXBhcmVFcnJvcl8oZXJyb3IpO1xuICAgICAgcmV0dXJuIGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGFuIGVycm9yIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKi9cbiAgZXJyb3IodGFnLCB2YXJfYXJncykge1xuICAgIGNvbnN0IGVycm9yID0gdGhpcy5lcnJvcl8uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGVycm9yLm5hbWUgPSB0YWcgfHwgZXJyb3IubmFtZTtcbiAgICAgIC8vIHJlcG9ydEVycm9yIGlzIGluc3RhbGxlZCBnbG9iYWxseSBwZXIgd2luZG93IGluIHRoZSBlbnRyeSBwb2ludC5cbiAgICAgIHNlbGYucmVwb3J0RXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGFuIGVycm9yIG1lc3NhZ2UgYW5kIG1hcmtzIHdpdGggYW4gZXhwZWN0ZWQgcHJvcGVydHkuIElmIHRoZVxuICAgKiBsb2dnaW5nIGlzIGRpc2FibGVkLCB0aGUgZXJyb3IgaXMgcmV0aHJvd24gYXN5bmNocm9ub3VzbHkuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB1bnVzZWRUYWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKi9cbiAgZXhwZWN0ZWRFcnJvcih1bnVzZWRUYWcsIHZhcl9hcmdzKSB7XG4gICAgY29uc3QgZXJyb3IgPSB0aGlzLmVycm9yXy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmIChlcnJvcikge1xuICAgICAgZXJyb3IuZXhwZWN0ZWQgPSB0cnVlO1xuICAgICAgLy8gcmVwb3J0RXJyb3IgaXMgaW5zdGFsbGVkIGdsb2JhbGx5IHBlciB3aW5kb3cgaW4gdGhlIGVudHJ5IHBvaW50LlxuICAgICAgc2VsZi5yZXBvcnRFcnJvcihlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gZXJyb3Igb2JqZWN0LlxuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqIEByZXR1cm4geyFFcnJvcn1cbiAgICovXG4gIGNyZWF0ZUVycm9yKHZhcl9hcmdzKSB7XG4gICAgY29uc3QgZXJyb3IgPSBjcmVhdGVFcnJvclZhcmdzLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgdGhpcy5wcmVwYXJlRXJyb3JfKGVycm9yKTtcbiAgICByZXR1cm4gZXJyb3I7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBlcnJvciBvYmplY3Qgd2l0aCBpdHMgZXhwZWN0ZWQgcHJvcGVydHkgc2V0IHRvIHRydWUuXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICogQHJldHVybiB7IUVycm9yfVxuICAgKi9cbiAgY3JlYXRlRXhwZWN0ZWRFcnJvcih2YXJfYXJncykge1xuICAgIGNvbnN0IGVycm9yID0gY3JlYXRlRXJyb3JWYXJncy5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgIHRoaXMucHJlcGFyZUVycm9yXyhlcnJvcik7XG4gICAgZXJyb3IuZXhwZWN0ZWQgPSB0cnVlO1xuICAgIHJldHVybiBlcnJvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzbid0IHRydWVpc2guXG4gICAqXG4gICAqIFN1cHBvcnRzIGFyZ3VtZW50IHN1YnN0aXR1dGlvbiBpbnRvIHRoZSBtZXNzYWdlIHZpYSAlcyBwbGFjZWhvbGRlcnMuXG4gICAqXG4gICAqIFRocm93cyBhbiBlcnJvciBvYmplY3QgdGhhdCBoYXMgdHdvIGV4dHJhIHByb3BlcnRpZXM6XG4gICAqIC0gYXNzb2NpYXRlZEVsZW1lbnQ6IFRoaXMgaXMgdGhlIGZpcnN0IGVsZW1lbnQgcHJvdmlkZWQgaW4gdGhlIHZhciBhcmdzLlxuICAgKiAgIEl0IGNhbiBiZSB1c2VkIGZvciBpbXByb3ZlZCBkaXNwbGF5IG9mIGVycm9yIG1lc3NhZ2VzLlxuICAgKiAtIG1lc3NhZ2VBcnJheTogVGhlIGVsZW1lbnRzIG9mIHRoZSBzdWJzdGl0dXRlZCBtZXNzYWdlIGFzIG5vbi1zdHJpbmdpZmllZFxuICAgKiAgIGVsZW1lbnRzIGluIGFuIGFycmF5LiBXaGVuIGUuZy4gcGFzc2VkIHRvIGNvbnNvbGUuZXJyb3IgdGhpcyB5aWVsZHNcbiAgICogICBuYXRpdmUgZGlzcGxheXMgb2YgdGhpbmdzIGxpa2UgSFRNTCBlbGVtZW50cy5cbiAgICpcbiAgICogQHBhcmFtIHtUfSBzaG91bGRCZVRydWVpc2ggVGhlIHZhbHVlIHRvIGFzc2VydC4gVGhlIGFzc2VydCBmYWlscyBpZiBpdCBkb2VzXG4gICAqICAgICBub3QgZXZhbHVhdGUgdG8gdHJ1ZS5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfbWVzc2FnZSBUaGUgYXNzZXJ0aW9uIG1lc3NhZ2VcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJncyBBcmd1bWVudHMgc3Vic3RpdHV0ZWQgaW50byAlcyBpbiB0aGUgbWVzc2FnZS5cbiAgICogQHJldHVybiB7VH0gVGhlIHZhbHVlIG9mIHNob3VsZEJlVHJ1ZWlzaC5cbiAgICogQHRlbXBsYXRlIFRcbiAgICogZXNsaW50IFwiZ29vZ2xlLWNhbWVsY2FzZS9nb29nbGUtY2FtZWxjYXNlXCI6IDBcbiAgICovXG4gIGFzc2VydChzaG91bGRCZVRydWVpc2gsIG9wdF9tZXNzYWdlLCB2YXJfYXJncykge1xuICAgIGxldCBmaXJzdEVsZW1lbnQ7XG4gICAgaWYgKCFzaG91bGRCZVRydWVpc2gpIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBvcHRfbWVzc2FnZSB8fCAnQXNzZXJ0aW9uIGZhaWxlZCc7XG4gICAgICBjb25zdCBzcGxpdE1lc3NhZ2UgPSBtZXNzYWdlLnNwbGl0KCclcycpO1xuICAgICAgY29uc3QgZmlyc3QgPSBzcGxpdE1lc3NhZ2Uuc2hpZnQoKTtcbiAgICAgIGxldCBmb3JtYXR0ZWQgPSBmaXJzdDtcbiAgICAgIGNvbnN0IG1lc3NhZ2VBcnJheSA9IFtdO1xuICAgICAgcHVzaElmTm9uRW1wdHkobWVzc2FnZUFycmF5LCBmaXJzdCk7XG4gICAgICBmb3IgKGxldCBpID0gMjsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCB2YWwgPSBhcmd1bWVudHNbaV07XG4gICAgICAgIGlmICh2YWwgJiYgdmFsLnRhZ05hbWUpIHtcbiAgICAgICAgICBmaXJzdEVsZW1lbnQgPSB2YWw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmV4dENvbnN0YW50ID0gc3BsaXRNZXNzYWdlLnNoaWZ0KCk7XG4gICAgICAgIG1lc3NhZ2VBcnJheS5wdXNoKHZhbCk7XG4gICAgICAgIHB1c2hJZk5vbkVtcHR5KG1lc3NhZ2VBcnJheSwgbmV4dENvbnN0YW50LnRyaW0oKSk7XG4gICAgICAgIGZvcm1hdHRlZCArPSB0b1N0cmluZyh2YWwpICsgbmV4dENvbnN0YW50O1xuICAgICAgfVxuICAgICAgY29uc3QgZSA9IG5ldyBFcnJvcihmb3JtYXR0ZWQpO1xuICAgICAgZS5mcm9tQXNzZXJ0ID0gdHJ1ZTtcbiAgICAgIGUuYXNzb2NpYXRlZEVsZW1lbnQgPSBmaXJzdEVsZW1lbnQ7XG4gICAgICBlLm1lc3NhZ2VBcnJheSA9IG1lc3NhZ2VBcnJheTtcbiAgICAgIHRoaXMucHJlcGFyZUVycm9yXyhlKTtcbiAgICAgIC8vIHJlcG9ydEVycm9yIGlzIGluc3RhbGxlZCBnbG9iYWxseSBwZXIgd2luZG93IGluIHRoZSBlbnRyeSBwb2ludC5cbiAgICAgIHNlbGYucmVwb3J0RXJyb3IoZSk7XG4gICAgICB0aHJvdyBlO1xuICAgIH1cbiAgICByZXR1cm4gc2hvdWxkQmVUcnVlaXNoO1xuICB9XG5cbiAgLyoqXG4gICAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgZmlyc3QgYXJndW1lbnQgaXNuJ3QgYW4gRWxlbWVudFxuICAgKlxuICAgKiBPdGhlcndpc2Ugc2VlIGBhc3NlcnRgIGZvciB1c2FnZVxuICAgKlxuICAgKiBAcGFyYW0geyp9IHNob3VsZEJlRWxlbWVudFxuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9tZXNzYWdlIFRoZSBhc3NlcnRpb24gbWVzc2FnZVxuICAgKiBAcmV0dXJuIHshRWxlbWVudH0gVGhlIHZhbHVlIG9mIHNob3VsZEJlVHJ1ZWlzaC5cbiAgICogQHRlbXBsYXRlIFRcbiAgICogZXNsaW50IFwiZ29vZ2xlLWNhbWVsY2FzZS9nb29nbGUtY2FtZWxjYXNlXCI6IDJcbiAgICovXG4gIGFzc2VydEVsZW1lbnQoc2hvdWxkQmVFbGVtZW50LCBvcHRfbWVzc2FnZSkge1xuICAgIGNvbnN0IHNob3VsZEJlVHJ1ZWlzaCA9IHNob3VsZEJlRWxlbWVudCAmJiBzaG91bGRCZUVsZW1lbnQubm9kZVR5cGUgPT0gMTtcbiAgICB0aGlzLmFzc2VydChzaG91bGRCZVRydWVpc2gsIChvcHRfbWVzc2FnZSB8fCAnRWxlbWVudCBleHBlY3RlZCcpICsgJzogJXMnLFxuICAgICAgICBzaG91bGRCZUVsZW1lbnQpO1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFFbGVtZW50fSAqLyAoc2hvdWxkQmVFbGVtZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzbid0IGEgc3RyaW5nLiBUaGUgc3RyaW5nIGNhblxuICAgKiBiZSBlbXB0eS5cbiAgICpcbiAgICogRm9yIG1vcmUgZGV0YWlscyBzZWUgYGFzc2VydGAuXG4gICAqXG4gICAqIEBwYXJhbSB7Kn0gc2hvdWxkQmVTdHJpbmdcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfbWVzc2FnZSBUaGUgYXNzZXJ0aW9uIG1lc3NhZ2VcbiAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgc3RyaW5nIHZhbHVlLiBDYW4gYmUgYW4gZW1wdHkgc3RyaW5nLlxuICAgKiBlc2xpbnQgXCJnb29nbGUtY2FtZWxjYXNlL2dvb2dsZS1jYW1lbGNhc2VcIjogMlxuICAgKi9cbiAgYXNzZXJ0U3RyaW5nKHNob3VsZEJlU3RyaW5nLCBvcHRfbWVzc2FnZSkge1xuICAgIHRoaXMuYXNzZXJ0KHR5cGVvZiBzaG91bGRCZVN0cmluZyA9PSAnc3RyaW5nJyxcbiAgICAgICAgKG9wdF9tZXNzYWdlIHx8ICdTdHJpbmcgZXhwZWN0ZWQnKSArICc6ICVzJywgc2hvdWxkQmVTdHJpbmcpO1xuICAgIHJldHVybiAvKiogQHR5cGUge3N0cmluZ30gKi8gKHNob3VsZEJlU3RyaW5nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzbid0IGEgbnVtYmVyLiBUaGUgYWxsb3dlZCB2YWx1ZXNcbiAgICogaW5jbHVkZSBgMGAgYW5kIGBOYU5gLlxuICAgKlxuICAgKiBGb3IgbW9yZSBkZXRhaWxzIHNlZSBgYXNzZXJ0YC5cbiAgICpcbiAgICogQHBhcmFtIHsqfSBzaG91bGRCZU51bWJlclxuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9tZXNzYWdlIFRoZSBhc3NlcnRpb24gbWVzc2FnZVxuICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBudW1iZXIgdmFsdWUuIFRoZSBhbGxvd2VkIHZhbHVlcyBpbmNsdWRlIGAwYFxuICAgKiAgIGFuZCBgTmFOYC5cbiAgICovXG4gIGFzc2VydE51bWJlcihzaG91bGRCZU51bWJlciwgb3B0X21lc3NhZ2UpIHtcbiAgICB0aGlzLmFzc2VydCh0eXBlb2Ygc2hvdWxkQmVOdW1iZXIgPT0gJ251bWJlcicsXG4gICAgICAgIChvcHRfbWVzc2FnZSB8fCAnTnVtYmVyIGV4cGVjdGVkJykgKyAnOiAlcycsIHNob3VsZEJlTnVtYmVyKTtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHtudW1iZXJ9ICovIChzaG91bGRCZU51bWJlcik7XG4gIH1cblxuICAvKipcbiAgICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpc24ndCBhIGJvb2xlYW4uXG4gICAqXG4gICAqIEZvciBtb3JlIGRldGFpbHMgc2VlIGBhc3NlcnRgLlxuICAgKlxuICAgKiBAcGFyYW0geyp9IHNob3VsZEJlQm9vbGVhblxuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9tZXNzYWdlIFRoZSBhc3NlcnRpb24gbWVzc2FnZVxuICAgKiBAcmV0dXJuIHtib29sZWFufSBUaGUgYm9vbGVhbiB2YWx1ZS5cbiAgICovXG4gIGFzc2VydEJvb2xlYW4oc2hvdWxkQmVCb29sZWFuLCBvcHRfbWVzc2FnZSkge1xuICAgIHRoaXMuYXNzZXJ0KCEhc2hvdWxkQmVCb29sZWFuID09PSBzaG91bGRCZUJvb2xlYW4sXG4gICAgICAgIChvcHRfbWVzc2FnZSB8fCAnQm9vbGVhbiBleHBlY3RlZCcpICsgJzogJXMnLCBzaG91bGRCZUJvb2xlYW4pO1xuICAgIHJldHVybiAvKiogQHR5cGUge2Jvb2xlYW59ICovIChzaG91bGRCZUJvb2xlYW4pO1xuICB9XG5cbiAgLyoqXG4gICAqIEFzc2VydHMgYW5kIHJldHVybnMgdGhlIGVudW0gdmFsdWUuIElmIHRoZSBlbnVtIGRvZXNuJ3QgY29udGFpbiBzdWNoIGFcbiAgICogdmFsdWUsIHRoZSBlcnJvciBpcyB0aHJvd24uXG4gICAqXG4gICAqIEBwYXJhbSB7IU9iamVjdDxUPn0gZW51bU9ialxuICAgKiBAcGFyYW0ge3N0cmluZ30gc1xuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9lbnVtTmFtZVxuICAgKiBAcmV0dXJuIHtUfVxuICAgKiBAdGVtcGxhdGUgVFxuICAgKiBlc2xpbnQgXCJnb29nbGUtY2FtZWxjYXNlL2dvb2dsZS1jYW1lbGNhc2VcIjogMlxuICAgKi9cbiAgYXNzZXJ0RW51bVZhbHVlKGVudW1PYmosIHMsIG9wdF9lbnVtTmFtZSkge1xuICAgIGlmIChpc0VudW1WYWx1ZShlbnVtT2JqLCBzKSkge1xuICAgICAgcmV0dXJuIHM7XG4gICAgfVxuICAgIHRoaXMuYXNzZXJ0KGZhbHNlLFxuICAgICAgICAnVW5rbm93biAlcyB2YWx1ZTogXCIlc1wiJyxcbiAgICAgICAgb3B0X2VudW1OYW1lIHx8ICdlbnVtJywgcyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRXJyb3J9IGVycm9yXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcmVwYXJlRXJyb3JfKGVycm9yKSB7XG4gICAgZXJyb3IgPSBkdXBsaWNhdGVFcnJvcklmTmVjZXNzYXJ5KGVycm9yKTtcbiAgICBpZiAodGhpcy5zdWZmaXhfKSB7XG4gICAgICBpZiAoIWVycm9yLm1lc3NhZ2UpIHtcbiAgICAgICAgZXJyb3IubWVzc2FnZSA9IHRoaXMuc3VmZml4XztcbiAgICAgIH0gZWxzZSBpZiAoZXJyb3IubWVzc2FnZS5pbmRleE9mKHRoaXMuc3VmZml4XykgPT0gLTEpIHtcbiAgICAgICAgZXJyb3IubWVzc2FnZSArPSB0aGlzLnN1ZmZpeF87XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChpc1VzZXJFcnJvck1lc3NhZ2UoZXJyb3IubWVzc2FnZSkpIHtcbiAgICAgIGVycm9yLm1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlLnJlcGxhY2UoVVNFUl9FUlJPUl9TRU5USU5FTCwgJycpO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfCFFbGVtZW50fSB2YWxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gdG9TdHJpbmcodmFsKSB7XG4gIC8vIERvIGNoZWNrIGVxdWl2YWxlbnQgdG8gYHZhbCBpbnN0YW5jZW9mIEVsZW1lbnRgIHdpdGhvdXQgY3Jvc3Mtd2luZG93IGJ1Z1xuICBpZiAodmFsICYmIHZhbC5ub2RlVHlwZSA9PSAxKSB7XG4gICAgcmV0dXJuIHZhbC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgKyAodmFsLmlkID8gJyMnICsgdmFsLmlkIDogJycpO1xuICB9XG4gIHJldHVybiAvKiogQHR5cGUge3N0cmluZ30gKi8gKHZhbCk7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFBcnJheX0gYXJyYXlcbiAqIEBwYXJhbSB7Kn0gdmFsXG4gKi9cbmZ1bmN0aW9uIHB1c2hJZk5vbkVtcHR5KGFycmF5LCB2YWwpIHtcbiAgaWYgKHZhbCAhPSAnJykge1xuICAgIGFycmF5LnB1c2godmFsKTtcbiAgfVxufVxuXG4vKipcbiAqIFNvbWUgZXhjZXB0aW9ucyAoRE9NRXhjZXB0aW9uLCBuYW1lbHkpIGhhdmUgcmVhZC1vbmx5IG1lc3NhZ2UuXG4gKiBAcGFyYW0geyFFcnJvcn0gZXJyb3JcbiAqIEByZXR1cm4geyFFcnJvcn07XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkdXBsaWNhdGVFcnJvcklmTmVjZXNzYXJ5KGVycm9yKSB7XG4gIGNvbnN0IHttZXNzYWdlfSA9IGVycm9yO1xuICBjb25zdCB0ZXN0ID0gU3RyaW5nKE1hdGgucmFuZG9tKCkpO1xuICBlcnJvci5tZXNzYWdlID0gdGVzdDtcblxuICBpZiAoZXJyb3IubWVzc2FnZSA9PT0gdGVzdCkge1xuICAgIGVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIHJldHVybiBlcnJvcjtcbiAgfVxuXG4gIGNvbnN0IGUgPSBuZXcgRXJyb3IoZXJyb3IubWVzc2FnZSk7XG4gIC8vIENvcHkgYWxsIHRoZSBleHRyYW5lb3VzIHRoaW5ncyB3ZSBhdHRhY2guXG4gIGZvciAoY29uc3QgcHJvcCBpbiBlcnJvcikge1xuICAgIGVbcHJvcF0gPSBlcnJvcltwcm9wXTtcbiAgfVxuICAvLyBFbnN1cmUgdGhlc2UgYXJlIGNvcGllZC5cbiAgZS5zdGFjayA9IGVycm9yLnN0YWNrO1xuICByZXR1cm4gZTtcbn1cblxuLyoqXG4gKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gKiBAcmV0dXJuIHshRXJyb3J9XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVycm9yVmFyZ3ModmFyX2FyZ3MpIHtcbiAgbGV0IGVycm9yID0gbnVsbDtcbiAgbGV0IG1lc3NhZ2UgPSAnJztcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBhcmcgPSBhcmd1bWVudHNbaV07XG4gICAgaWYgKGFyZyBpbnN0YW5jZW9mIEVycm9yICYmICFlcnJvcikge1xuICAgICAgZXJyb3IgPSBkdXBsaWNhdGVFcnJvcklmTmVjZXNzYXJ5KGFyZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICAgIG1lc3NhZ2UgKz0gJyAnO1xuICAgICAgfVxuICAgICAgbWVzc2FnZSArPSBhcmc7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFlcnJvcikge1xuICAgIGVycm9yID0gbmV3IEVycm9yKG1lc3NhZ2UpO1xuICB9IGVsc2UgaWYgKG1lc3NhZ2UpIHtcbiAgICBlcnJvci5tZXNzYWdlID0gbWVzc2FnZSArICc6ICcgKyBlcnJvci5tZXNzYWdlO1xuICB9XG4gIHJldHVybiBlcnJvcjtcbn1cblxuXG4vKipcbiAqIFJldGhyb3dzIHRoZSBlcnJvciB3aXRob3V0IHRlcm1pbmF0aW5nIHRoZSBjdXJyZW50IGNvbnRleHQuIFRoaXMgcHJlc2VydmVzXG4gKiB3aGV0aGVyIHRoZSBvcmlnaW5hbCBlcnJvciBkZXNpZ25hdGlvbiBpcyBhIHVzZXIgZXJyb3Igb3IgYSBkZXYgZXJyb3IuXG4gKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXRocm93QXN5bmModmFyX2FyZ3MpIHtcbiAgY29uc3QgZXJyb3IgPSBjcmVhdGVFcnJvclZhcmdzLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIC8vIHJlcG9ydEVycm9yIGlzIGluc3RhbGxlZCBnbG9iYWxseSBwZXIgd2luZG93IGluIHRoZSBlbnRyeSBwb2ludC5cbiAgICBzZWxmLnJlcG9ydEVycm9yKGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfSk7XG59XG5cblxuLyoqXG4gKiBDYWNoZSBmb3IgbG9ncy4gV2UgZG8gbm90IHVzZSBhIFNlcnZpY2Ugc2luY2UgdGhlIHNlcnZpY2UgbW9kdWxlIGRlcGVuZHNcbiAqIG9uIExvZyBhbmQgY2xvc3VyZSBsaXRlcmFsbHkgY2FuJ3QgZXZlbi5cbiAqIEB0eXBlIHt7dXNlcjogP0xvZywgZGV2OiA/TG9nLCB1c2VyRm9yRW1iZWQ6ID9Mb2d9fVxuICovXG5zZWxmLmxvZyA9IChzZWxmLmxvZyB8fCB7XG4gIHVzZXI6IG51bGwsXG4gIGRldjogbnVsbCxcbiAgdXNlckZvckVtYmVkOiBudWxsLFxufSk7XG5cbmNvbnN0IGxvZ3MgPSBzZWxmLmxvZztcblxuLyoqXG4gKiBFdmVudHVhbGx5IGhvbGRzIGEgY29uc3RydWN0b3IgZm9yIExvZyBvYmplY3RzLiBMYXppbHkgaW5pdGlhbGl6ZWQsIHNvIHdlXG4gKiBjYW4gYXZvaWQgZXZlciByZWZlcmVuY2luZyB0aGUgcmVhbCBjb25zdHJ1Y3RvciBleGNlcHQgaW4gSlMgYmluYXJpZXNcbiAqIHRoYXQgYWN0dWFsbHkgd2FudCB0byBpbmNsdWRlIHRoZSBpbXBsZW1lbnRhdGlvbi5cbiAqIEB0eXBlIHs/RnVuY3Rpb259XG4gKi9cbmxldCBsb2dDb25zdHJ1Y3RvciA9IG51bGw7XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgbG9nIGNvbnRydWN0b3IuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbml0TG9nQ29uc3RydWN0b3IoKSB7XG4gIGxvZ0NvbnN0cnVjdG9yID0gTG9nO1xuICAvLyBJbml0aWFsaXplIGluc3RhbmNlcyBmb3IgdXNlLiBJZiBhIGJpbmFyeSAoYW4gZXh0ZW5zaW9uIGZvciBleGFtcGxlKSB0aGF0XG4gIC8vIGRvZXMgbm90IGNhbGwgYGluaXRMb2dDb25zdHJ1Y3RvcmAgaW52b2tlcyBgZGV2KClgIG9yIGB1c2VyKClgIGVhcmxpZXIgdGhhblxuICAvLyB0aGUgYmluYXJ5IHRoYXQgZG9lcyBjYWxsIGBpbml0TG9nQ29uc3RydWN0b3JgIChhbXAuanMpLCB0aGUgZXh0ZW5zaW9uIHdpbGxcbiAgLy8gdGhyb3cgYW4gZXJyb3IgYXMgdGhhdCBleHRlbnNpb24gd2lsbCBuZXZlciBiZSBhYmxlIHRvIGluaXRpYWxpemUgdGhlIGxvZ1xuICAvLyBpbnN0YW5jZXMgYW5kIHdlIGFsc28gZG9uJ3Qgd2FudCBpdCB0byBjYWxsIGBpbml0TG9nQ29uc3RydWN0b3JgIGVpdGhlclxuICAvLyAoc2luY2UgdGhhdCB3aWxsIGNhdXNlIHRoZSBMb2cgaW1wbGVtZW50YXRpb24gdG8gYmUgYnVuZGxlZCBpbnRvIHRoYXRcbiAgLy8gYmluYXJ5KS4gU28gd2UgbXVzdCBpbml0aWFsaXplIHRoZSBpbnN0YW5jZXMgZWFnZXJseSBzbyB0aGF0IHRoZXkgYXJlIHJlYWR5XG4gIC8vIGZvciB1c2UgKHN0b3JlZCBnbG9iYWxseSkgYWZ0ZXIgdGhlIG1haW4gYmluYXJ5IGNhbGxzIGBpbml0TG9nQ29uc3RydWN0b3JgLlxuICBkZXYoKTtcbiAgdXNlcigpO1xufVxuXG4vKipcbiAqIFJlc2V0cyBsb2cgY29udHJ1Y3RvciBmb3IgdGVzdGluZy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0TG9nQ29uc3RydWN0b3JGb3JUZXN0aW5nKCkge1xuICBsb2dDb25zdHJ1Y3RvciA9IG51bGw7XG59XG5cbi8qKlxuICogUHVibGlzaGVyIGxldmVsIGxvZy5cbiAqXG4gKiBFbmFibGVkIGluIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAqICAxLiBOb3QgZGlzYWJsZWQgdXNpbmcgYCNsb2c9MGAuXG4gKiAgMi4gRGV2ZWxvcG1lbnQgbW9kZSBpcyBlbmFibGVkIHZpYSBgI2RldmVsb3BtZW50PTFgIG9yIGxvZ2dpbmcgaXMgZXhwbGljaXRseVxuICogICAgIGVuYWJsZWQgdmlhIGAjbG9nPURgIHdoZXJlIEQgPj0gMS5cbiAqICAzLiBBTVAuc2V0TG9nTGV2ZWwoRCkgaXMgY2FsbGVkLCB3aGVyZSBEID49IDEuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudD19IG9wdF9lbGVtZW50XG4gKiBAcmV0dXJuIHshTG9nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlcihvcHRfZWxlbWVudCkge1xuICBpZiAoIWxvZ3MudXNlcikge1xuICAgIGxvZ3MudXNlciA9IGdldFVzZXJMb2dnZXIoVVNFUl9FUlJPUl9TRU5USU5FTCk7XG4gIH1cbiAgaWYgKCFpc0Zyb21FbWJlZChsb2dzLnVzZXIud2luLCBvcHRfZWxlbWVudCkpIHtcbiAgICByZXR1cm4gbG9ncy51c2VyO1xuICB9IGVsc2Uge1xuICAgIGlmIChsb2dzLnVzZXJGb3JFbWJlZCkge1xuICAgICAgcmV0dXJuIGxvZ3MudXNlckZvckVtYmVkO1xuICAgIH1cbiAgICByZXR1cm4gbG9ncy51c2VyRm9yRW1iZWQgPSBnZXRVc2VyTG9nZ2VyKFVTRVJfRVJST1JfRU1CRURfU0VOVElORUwpO1xuICB9XG59XG5cbi8qKlxuICogR2V0dGVyIGZvciB1c2VyIGxvZ2dlclxuICogQHBhcmFtIHtzdHJpbmc9fSBzdWZmaXhcbiAqIEByZXR1cm4geyFMb2d9XG4gKi9cbmZ1bmN0aW9uIGdldFVzZXJMb2dnZXIoc3VmZml4KSB7XG4gIGlmICghbG9nQ29uc3RydWN0b3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2ZhaWxlZCB0byBjYWxsIGluaXRMb2dDb25zdHJ1Y3RvcicpO1xuICB9XG4gIHJldHVybiBuZXcgbG9nQ29uc3RydWN0b3Ioc2VsZiwgbW9kZSA9PiB7XG4gICAgY29uc3QgbG9nTnVtID0gcGFyc2VJbnQobW9kZS5sb2csIDEwKTtcbiAgICBpZiAobW9kZS5kZXZlbG9wbWVudCB8fCBsb2dOdW0gPj0gMSkge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLkZJTkU7XG4gICAgfVxuICAgIHJldHVybiBMb2dMZXZlbC5XQVJOO1xuICB9LCBzdWZmaXgpO1xufVxuXG4vKipcbiAqIEFNUCBkZXZlbG9wbWVudCBsb2cuIENhbGxzIHRvIGBkZXZMb2coKS5hc3NlcnRgIGFuZCBgZGV2LmZpbmVgIGFyZSBzdHJpcHBlZFxuICogaW4gdGhlIFBST0QgYmluYXJ5LiBIb3dldmVyLCBgZGV2TG9nKCkuYXNzZXJ0YCByZXN1bHQgaXMgcHJlc2VydmVkIGluIGVpdGhlclxuICogY2FzZS5cbiAqXG4gKiBFbmFibGVkIGluIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAqICAxLiBOb3QgZGlzYWJsZWQgdXNpbmcgYCNsb2c9MGAuXG4gKiAgMi4gTG9nZ2luZyBpcyBleHBsaWNpdGx5IGVuYWJsZWQgdmlhIGAjbG9nPURgLCB3aGVyZSBEID49IDIuXG4gKiAgMy4gQU1QLnNldExvZ0xldmVsKEQpIGlzIGNhbGxlZCwgd2hlcmUgRCA+PSAyLlxuICpcbiAqIEByZXR1cm4geyFMb2d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZXYoKSB7XG4gIGlmIChsb2dzLmRldikge1xuICAgIHJldHVybiBsb2dzLmRldjtcbiAgfVxuICBpZiAoIWxvZ0NvbnN0cnVjdG9yKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdmYWlsZWQgdG8gY2FsbCBpbml0TG9nQ29uc3RydWN0b3InKTtcbiAgfVxuICByZXR1cm4gbG9ncy5kZXYgPSBuZXcgbG9nQ29uc3RydWN0b3Ioc2VsZiwgbW9kZSA9PiB7XG4gICAgY29uc3QgbG9nTnVtID0gcGFyc2VJbnQobW9kZS5sb2csIDEwKTtcbiAgICBpZiAobG9nTnVtID49IDMpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5GSU5FO1xuICAgIH1cbiAgICBpZiAobG9nTnVtID49IDIpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5JTkZPO1xuICAgIH1cbiAgICByZXR1cm4gTG9nTGV2ZWwuT0ZGO1xuICB9KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshRWxlbWVudD19IG9wdF9lbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufSBpc0VtYmVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Zyb21FbWJlZCh3aW4sIG9wdF9lbGVtZW50KSB7XG4gIGlmICghb3B0X2VsZW1lbnQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIG9wdF9lbGVtZW50Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcgIT0gd2luO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuL3NlcnZpY2VzJztcbmltcG9ydCB7ZGV2LCB1c2VyfSBmcm9tICcuL2xvZyc7XG5pbXBvcnQge2lzQXJyYXksIGlzT2JqZWN0fSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7dHJ5UGFyc2VKc29ufSBmcm9tICcuL2pzb24nO1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGFydHdvcms6IEFycmF5LFxuICogICB0aXRsZTogc3RyaW5nLFxuICogICBhbGJ1bTogc3RyaW5nLFxuICogICBhcnRpc3Q6IHN0cmluZyxcbiAqIH19XG4gKi9cbmV4cG9ydCBsZXQgTWV0YWRhdGFEZWY7XG5cbi8qKiBAY29uc3Qge01ldGFkYXRhRGVmfSBEdW1teSBtZXRhZGF0YSB1c2VkIHRvIGZpeCBhIGJ1ZyAqL1xuZXhwb3J0IGNvbnN0IEVNUFRZX01FVEFEQVRBID0ge1xuICAndGl0bGUnOiAnJyxcbiAgJ2FydGlzdCc6ICcnLFxuICAnYWxidW0nOiAnJyxcbiAgJ2FydHdvcmsnOiBbXG4gICAgeydzcmMnOiAnJ30sXG4gIF0sXG59O1xuXG4vKipcbiAqIFVwZGF0ZXMgdGhlIE1lZGlhIFNlc3Npb24gQVBJJ3MgbWV0YWRhdGFcbiAqIEBwYXJhbSB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICogQHBhcmFtIHshTWV0YWRhdGFEZWZ9IG1ldGFkYXRhXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCk9fSBwbGF5SGFuZGxlclxuICogQHBhcmFtIHtmdW5jdGlvbigpPX0gcGF1c2VIYW5kbGVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRNZWRpYVNlc3Npb24oYW1wZG9jLCBtZXRhZGF0YSwgcGxheUhhbmRsZXIsIHBhdXNlSGFuZGxlcikge1xuICBjb25zdCB7d2lufSA9IGFtcGRvYztcbiAgY29uc3Qge25hdmlnYXRvcn0gPSB3aW47XG4gIGlmICgnbWVkaWFTZXNzaW9uJyBpbiBuYXZpZ2F0b3IgJiYgd2luLk1lZGlhTWV0YWRhdGEpIHtcbiAgICAvLyBDbGVhciBtZWRpYVNlc3Npb24gKHJlcXVpcmVkIHRvIGZpeCBhIGJ1ZyB3aGVuIHN3aXRjaGluZyBiZXR3ZWVuIHR3b1xuICAgIC8vIHZpZGVvcylcbiAgICBuYXZpZ2F0b3IubWVkaWFTZXNzaW9uLm1ldGFkYXRhID0gbmV3IHdpbi5NZWRpYU1ldGFkYXRhKEVNUFRZX01FVEFEQVRBKTtcblxuICAgIC8vIEFkZCBtZXRhZGF0YVxuICAgIHZhbGlkYXRlTWV0YWRhdGEoYW1wZG9jLCBtZXRhZGF0YSk7XG4gICAgbmF2aWdhdG9yLm1lZGlhU2Vzc2lvbi5tZXRhZGF0YSA9IG5ldyB3aW4uTWVkaWFNZXRhZGF0YShtZXRhZGF0YSk7XG5cbiAgICBuYXZpZ2F0b3IubWVkaWFTZXNzaW9uLnNldEFjdGlvbkhhbmRsZXIoJ3BsYXknLCBwbGF5SGFuZGxlcik7XG4gICAgbmF2aWdhdG9yLm1lZGlhU2Vzc2lvbi5zZXRBY3Rpb25IYW5kbGVyKCdwYXVzZScsIHBhdXNlSGFuZGxlcik7XG5cbiAgICAvLyBUT0RPKEB3YXNzZ2hhKSBJbXBsZW1lbnQgc2VlayAmIG5leHQvcHJldmlvdXNcbiAgfVxufVxuXG5cbi8qKlxuICogUGFyc2VzIHRoZSBzY2hlbWEub3JnIGpzb24tbGQgZm9ybWF0dGVkIG1ldGEtZGF0YSwgbG9va3MgZm9yIHRoZSBwYWdlJ3NcbiAqIGZlYXR1cmVkIGltYWdlIGFuZCByZXR1cm5zIGl0XG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcmV0dXJuIHtzdHJpbmd8dW5kZWZpbmVkfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VTY2hlbWFJbWFnZShkb2MpIHtcbiAgY29uc3Qgc2NoZW1hID0gZG9jLnF1ZXJ5U2VsZWN0b3IoJ3NjcmlwdFt0eXBlPVwiYXBwbGljYXRpb24vbGQranNvblwiXScpO1xuICBpZiAoIXNjaGVtYSkge1xuICAgIC8vIE5vIHNjaGVtYSBlbGVtZW50IGZvdW5kXG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IHNjaGVtYUpzb24gPSB0cnlQYXJzZUpzb24oc2NoZW1hLnRleHRDb250ZW50KTtcbiAgaWYgKCFzY2hlbWFKc29uIHx8ICFzY2hlbWFKc29uWydpbWFnZSddKSB7XG4gICAgLy8gTm8gaW1hZ2UgZm91bmQgaW4gdGhlIHNjaGVtYVxuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIEltYWdlIGRlZmluaXRpb24gaW4gc2NoZW1hIGNvdWxkIGJlIG9uZSBvZiA6XG4gIGlmICh0eXBlb2Ygc2NoZW1hSnNvblsnaW1hZ2UnXSA9PT0gJ3N0cmluZycpIHtcbiAgICAvLyAxLiBcImltYWdlXCI6IFwiaHR0cDovLy4uXCIsXG4gICAgcmV0dXJuIHNjaGVtYUpzb25bJ2ltYWdlJ107XG4gIH0gZWxzZSBpZiAoc2NoZW1hSnNvblsnaW1hZ2UnXVsnQGxpc3QnXVxuICAgICAgJiYgdHlwZW9mIHNjaGVtYUpzb25bJ2ltYWdlJ11bJ0BsaXN0J11bMF0gPT09ICdzdHJpbmcnKSB7XG4gICAgLy8gMi4gXCJpbWFnZVwiOiB7Li4sIFwiQGxpc3RcIjogW1wiaHR0cDovLy4uXCJdLCAuLn1cbiAgICByZXR1cm4gc2NoZW1hSnNvblsnaW1hZ2UnXVsnQGxpc3QnXVswXTtcbiAgfSBlbHNlIGlmICh0eXBlb2Ygc2NoZW1hSnNvblsnaW1hZ2UnXVsndXJsJ10gPT09ICdzdHJpbmcnKSB7XG4gICAgLy8gMy4gXCJpbWFnZVwiOiB7Li4sIFwidXJsXCI6IFwiaHR0cDovLy4uXCIsIC4ufVxuICAgIHJldHVybiBzY2hlbWFKc29uWydpbWFnZSddWyd1cmwnXTtcbiAgfSBlbHNlIGlmICh0eXBlb2Ygc2NoZW1hSnNvblsnaW1hZ2UnXVswXSA9PT0gJ3N0cmluZycpIHtcbiAgICAvLyA0LiBcImltYWdlXCI6IFtcImh0dHA6Ly8uLiBcIl1cbiAgICByZXR1cm4gc2NoZW1hSnNvblsnaW1hZ2UnXVswXTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm47XG4gIH1cbn1cblxuLyoqXG4gKiBQYXJzZXMgdGhlIG9nOmltYWdlIGlmIGl0IGV4aXN0cyBhbmQgcmV0dXJucyBpdFxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHJldHVybiB7c3RyaW5nfHVuZGVmaW5lZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlT2dJbWFnZShkb2MpIHtcbiAgY29uc3QgbWV0YVRhZyA9IGRvYy5xdWVyeVNlbGVjdG9yKCdtZXRhW3Byb3BlcnR5PVwib2c6aW1hZ2VcIl0nKTtcbiAgaWYgKG1ldGFUYWcpIHtcbiAgICByZXR1cm4gbWV0YVRhZy5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm47XG4gIH1cbn1cblxuLyoqXG4gKiBQYXJzZXMgdGhlIHdlYnNpdGUncyBGYXZpY29uIGFuZCByZXR1cm5zIGl0XG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcmV0dXJuIHtzdHJpbmd8dW5kZWZpbmVkfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VGYXZpY29uKGRvYykge1xuICBjb25zdCBsaW5rVGFnID0gZG9jLnF1ZXJ5U2VsZWN0b3IoJ2xpbmtbcmVsPVwic2hvcnRjdXQgaWNvblwiXScpXG4gICAgICAgICAgICAgICAgICB8fCBkb2MucXVlcnlTZWxlY3RvcignbGlua1tyZWw9XCJpY29uXCJdJyk7XG4gIGlmIChsaW5rVGFnKSB7XG4gICAgcmV0dXJuIGxpbmtUYWcuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuO1xuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gKiBAcGFyYW0geyFNZXRhZGF0YURlZn0gbWV0YWRhdGFcbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIHZhbGlkYXRlTWV0YWRhdGEoYW1wZG9jLCBtZXRhZGF0YSkge1xuICBjb25zdCB1cmxTZXJ2aWNlID0gU2VydmljZXMudXJsRm9yRG9jKGFtcGRvYyk7XG4gIC8vIEVuc3VyZSBzcmMgb2YgYXJ0d29yayBoYXMgdmFsaWQgcHJvdG9jb2xcbiAgaWYgKG1ldGFkYXRhICYmIG1ldGFkYXRhLmFydHdvcmspIHtcbiAgICBjb25zdCB7YXJ0d29ya30gPSBtZXRhZGF0YTtcbiAgICBkZXYoKS5hc3NlcnQoaXNBcnJheShhcnR3b3JrKSk7XG4gICAgYXJ0d29yay5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgaWYgKGl0ZW0pIHtcbiAgICAgICAgY29uc3Qgc3JjID0gaXNPYmplY3QoaXRlbSkgPyBpdGVtLnNyYyA6IGl0ZW07XG4gICAgICAgIHVzZXIoKS5hc3NlcnQodXJsU2VydmljZS5pc1Byb3RvY29sVmFsaWQoc3JjKSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4vbW9kZSc7XG5cbi8qKlxuICogUHJvdmlkZXMgaW5mbyBhYm91dCB0aGUgY3VycmVudCBhcHAuIFRoaXMgcmV0dXJuIHZhbHVlIG1heSBiZSBjYWNoZWQgYW5kXG4gKiBwYXNzZWQgYXJvdW5kIGFzIGl0IHdpbGwgYWx3YXlzIGJlIERDRSdkLlxuICogQHBhcmFtIHs/V2luZG93PX0gb3B0X3dpblxuICogQHJldHVybiB7IS4vbW9kZS5Nb2RlRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW9kZU9iamVjdChvcHRfd2luKSB7XG4gIHJldHVybiB7XG4gICAgbG9jYWxEZXY6IGdldE1vZGUob3B0X3dpbikubG9jYWxEZXYsXG4gICAgZGV2ZWxvcG1lbnQ6IGdldE1vZGUob3B0X3dpbikuZGV2ZWxvcG1lbnQsXG4gICAgZmlsdGVyOiBnZXRNb2RlKG9wdF93aW4pLmZpbHRlcixcbiAgICBtaW5pZmllZDogZ2V0TW9kZShvcHRfd2luKS5taW5pZmllZCxcbiAgICBsaXRlOiBnZXRNb2RlKG9wdF93aW4pLmxpdGUsXG4gICAgdGVzdDogZ2V0TW9kZShvcHRfd2luKS50ZXN0LFxuICAgIGxvZzogZ2V0TW9kZShvcHRfd2luKS5sb2csXG4gICAgdmVyc2lvbjogZ2V0TW9kZShvcHRfd2luKS52ZXJzaW9uLFxuICAgIHJ0dlZlcnNpb246IGdldE1vZGUob3B0X3dpbikucnR2VmVyc2lvbixcbiAgfTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge3BhcnNlUXVlcnlTdHJpbmdffSBmcm9tICcuL3VybC1wYXJzZS1xdWVyeS1zdHJpbmcnO1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGxvY2FsRGV2OiBib29sZWFuLFxuICogICBkZXZlbG9wbWVudDogYm9vbGVhbixcbiAqICAgZmlsdGVyOiAoc3RyaW5nfHVuZGVmaW5lZCksXG4gKiAgIG1pbmlmaWVkOiBib29sZWFuLFxuICogICBsaXRlOiBib29sZWFuLFxuICogICB0ZXN0OiBib29sZWFuLFxuICogICBsb2c6IChzdHJpbmd8dW5kZWZpbmVkKSxcbiAqICAgdmVyc2lvbjogc3RyaW5nLFxuICogICBydHZWZXJzaW9uOiBzdHJpbmcsXG4gKiB9fVxuICovXG5leHBvcnQgbGV0IE1vZGVEZWY7XG5cbi8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuY29uc3QgdmVyc2lvbiA9ICckaW50ZXJuYWxSdW50aW1lVmVyc2lvbiQnO1xuXG4vKipcbiAqIGBydHZWZXJzaW9uYCBpcyB0aGUgcHJlZml4ZWQgdmVyc2lvbiB3ZSBzZXJ2ZSBvZmYgb2YgdGhlIGNkbi5cbiAqIFRoZSBwcmVmaXggZGVub3RlcyBjYW5hcnkoMDApIG9yIHByb2QoMDEpIG9yIGFuIGV4cGVyaW1lbnQgdmVyc2lvbiAoID4gMDEpLlxuICogQHR5cGUge3N0cmluZ31cbiAqL1xubGV0IHJ0dlZlcnNpb24gPSAnJztcblxuLyoqXG4gKiBQcm92aWRlcyBpbmZvIGFib3V0IHRoZSBjdXJyZW50IGFwcC5cbiAqIEBwYXJhbSB7P1dpbmRvdz19IG9wdF93aW5cbiAqIEByZXR1cm4geyFNb2RlRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW9kZShvcHRfd2luKSB7XG4gIGNvbnN0IHdpbiA9IG9wdF93aW4gfHwgc2VsZjtcbiAgaWYgKHdpbi5BTVBfTU9ERSkge1xuICAgIHJldHVybiB3aW4uQU1QX01PREU7XG4gIH1cbiAgcmV0dXJuIHdpbi5BTVBfTU9ERSA9IGdldE1vZGVfKHdpbik7XG59XG5cbi8qKlxuICogUHJvdmlkZXMgaW5mbyBhYm91dCB0aGUgY3VycmVudCBhcHAuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IU1vZGVEZWZ9XG4gKi9cbmZ1bmN0aW9uIGdldE1vZGVfKHdpbikge1xuICAvLyBNYWdpYyBjb25zdGFudHMgdGhhdCBhcmUgcmVwbGFjZWQgYnkgY2xvc3VyZSBjb21waWxlci5cbiAgLy8gSVNfTUlOSUZJRUQgaXMgYWx3YXlzIHJlcGxhY2VkIHdpdGggdHJ1ZSB3aGVuIGNsb3N1cmUgY29tcGlsZXIgaXMgdXNlZFxuICAvLyB3aGlsZSBJU19ERVYgaXMgb25seSByZXBsYWNlZCB3aGVuIGBndWxwIGRpc3RgIGlzIGNhbGxlZCB3aXRob3V0IHRoZVxuICAvLyAtLWZvcnRlc3RpbmcgZmxhZy5cbiAgY29uc3QgSVNfREVWID0gdHJ1ZTtcbiAgY29uc3QgSVNfTUlOSUZJRUQgPSBmYWxzZTtcblxuICBjb25zdCBsb2NhbERldkVuYWJsZWQgPSAhIShzZWxmLkFNUF9DT05GSUcgJiYgc2VsZi5BTVBfQ09ORklHLmxvY2FsRGV2KTtcbiAgY29uc3QgcnVubmluZ1Rlc3RzID0gSVNfREVWICYmICEhKHdpbi5BTVBfVEVTVCB8fCB3aW4uX19rYXJtYV9fKTtcbiAgY29uc3QgaXNMb2NhbERldiA9IElTX0RFViAmJiAobG9jYWxEZXZFbmFibGVkIHx8IHJ1bm5pbmdUZXN0cyk7XG4gIGNvbnN0IGhhc2hRdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmdfKFxuICAgICAgLy8gbG9jYXRpb24ub3JpZ2luYWxIYXNoIGlzIHNldCBieSB0aGUgdmlld2VyIHdoZW4gaXQgcmVtb3ZlcyB0aGUgZnJhZ21lbnRcbiAgICAgIC8vIGZyb20gdGhlIFVSTC5cbiAgICAgIHdpbi5sb2NhdGlvbi5vcmlnaW5hbEhhc2ggfHwgd2luLmxvY2F0aW9uLmhhc2gpO1xuXG4gIGNvbnN0IHNlYXJjaFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZ18od2luLmxvY2F0aW9uLnNlYXJjaCk7XG5cbiAgaWYgKCFydHZWZXJzaW9uKSB7XG4gICAgcnR2VmVyc2lvbiA9IGdldFJ0dlZlcnNpb24od2luLCBpc0xvY2FsRGV2KTtcbiAgfVxuXG4gIC8vIFRoZSBgbWluaWZpZWRgLCBgdGVzdGAgYW5kIGBsb2NhbERldmAgcHJvcGVydGllcyBhcmUgcmVwbGFjZWRcbiAgLy8gYXMgYm9vbGVhbiBsaXRlcmFscyB3aGVuIHdlIHJ1biBgZ3VscCBkaXN0YCB3aXRob3V0IHRoZSBgLS1mb3J0ZXN0aW5nYFxuICAvLyBmbGFncy4gVGhpcyBpbXByb3ZlZCBEQ0Ugb24gdGhlIHByb2R1Y3Rpb24gZmlsZSB3ZSBkZXBsb3kgYXMgdGhlIGNvZGVcbiAgLy8gcGF0aHMgZm9yIGxvY2FsaG9zdC90ZXN0aW5nL2RldmVsb3BtZW50IGFyZSBlbGltaW5hdGVkLlxuICByZXR1cm4ge1xuICAgIGxvY2FsRGV2OiBpc0xvY2FsRGV2LFxuICAgIC8vIFRyaWdnZXJzIHZhbGlkYXRpb24gb3IgZW5hYmxlIHB1YiBsZXZlbCBsb2dnaW5nLiBWYWxpZGF0aW9uIGNhbiBiZVxuICAgIC8vIGJ5cGFzc2VkIHZpYSAjdmFsaWRhdGU9MC5cbiAgICAvLyBOb3RlIHRoYXQgQU1QX0RFVl9NT0RFIGZsYWcgaXMgdXNlZCBmb3IgdGVzdGluZyBwdXJwb3Nlcy5cbiAgICBkZXZlbG9wbWVudDogISEoaGFzaFF1ZXJ5WydkZXZlbG9wbWVudCddID09ICcxJyB8fCB3aW4uQU1QX0RFVl9NT0RFKSxcbiAgICBleGFtaW5lcjogaGFzaFF1ZXJ5WydkZXZlbG9wbWVudCddID09ICcyJyxcbiAgICAvLyBBbGxvd3MgZmlsdGVyaW5nIHZhbGlkYXRpb24gZXJyb3JzIGJ5IGVycm9yIGNhdGVnb3J5LiBGb3IgdGhlXG4gICAgLy8gYXZhaWxhYmxlIGNhdGVnb3JpZXMsIHNlZSBFcnJvckNhdGVnb3J5IGluIHZhbGlkYXRvci92YWxpZGF0b3IucHJvdG8uXG4gICAgZmlsdGVyOiBoYXNoUXVlcnlbJ2ZpbHRlciddLFxuICAgIC8vIGFtcC1nZW8gb3ZlcnJpZGVcbiAgICBnZW9PdmVycmlkZTogaGFzaFF1ZXJ5WydhbXAtZ2VvJ10sXG4gICAgbWluaWZpZWQ6IElTX01JTklGSUVELFxuICAgIC8vIFdoZXRoZXIgZG9jdW1lbnQgaXMgaW4gYW4gYW1wLWxpdGUgdmlld2VyLiBJdCBzaWduYWwgdGhhdCB0aGUgdXNlclxuICAgIC8vIHdvdWxkIHByZWZlciB0byB1c2UgbGVzcyBiYW5kd2lkdGguXG4gICAgbGl0ZTogc2VhcmNoUXVlcnlbJ2FtcF9saXRlJ10gIT0gdW5kZWZpbmVkLFxuICAgIHRlc3Q6IHJ1bm5pbmdUZXN0cyxcbiAgICBsb2c6IGhhc2hRdWVyeVsnbG9nJ10sXG4gICAgdmVyc2lvbixcbiAgICBydHZWZXJzaW9uLFxuICB9O1xufVxuXG4vKipcbiAqIFJldHJpZXZlIHRoZSBgcnR2VmVyc2lvbmAgd2hpY2ggd2lsbCBoYXZlIGEgbnVtZXJpYyBwcmVmaXhcbiAqIGRlbm90aW5nIGNhbmFyeS9wcm9kL2V4cGVyaW1lbnQgKHVubGVzcyBgaXNMb2NhbERldmAgaXMgdHJ1ZSkuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNMb2NhbERldlxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBnZXRSdHZWZXJzaW9uKHdpbiwgaXNMb2NhbERldikge1xuICAvLyBJZiBpdCdzIGxvY2FsIGRldiB0aGVuIHdlIHdvbid0IGFjdHVhbGx5IGhhdmUgYSBmdWxsIHZlcnNpb24gc29cbiAgLy8ganVzdCB1c2UgdGhlIHZlcnNpb24uXG4gIGlmIChpc0xvY2FsRGV2KSB7XG4gICAgcmV0dXJuIHZlcnNpb247XG4gIH1cblxuICBpZiAod2luLkFNUF9DT05GSUcgJiYgd2luLkFNUF9DT05GSUcudikge1xuICAgIHJldHVybiB3aW4uQU1QX0NPTkZJRy52O1xuICB9XG5cbiAgLy8gQ3VycmVudGx5IGAkaW50ZXJuYWxSdW50aW1lVmVyc2lvbiRgIGFuZCB0aHVzIGBtb2RlLnZlcnNpb25gIGNvbnRhaW4gb25seVxuICAvLyBtYWpvciB2ZXJzaW9uLiBUaGUgZnVsbCB2ZXJzaW9uIGhvd2V2ZXIgbXVzdCBhbHNvIGNhcnJ5IHRoZSBtaW5vciB2ZXJzaW9uLlxuICAvLyBXZSB3aWxsIGRlZmF1bHQgdG8gcHJvZHVjdGlvbiBkZWZhdWx0IGAwMWAgbWlub3IgdmVyc2lvbiBmb3Igbm93LlxuICAvLyBUT0RPKGVyd2lubW9tYmF5KTogZGVjaWRlIHdoZXRoZXIgJGludGVybmFsUnVudGltZVZlcnNpb24kIHNob3VsZCBjb250YWluXG4gIC8vIG1pbm9yIHZlcnNpb24uXG4gIHJldHVybiBgMDEke3ZlcnNpb259YDtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGlzTG9jYWxEZXZcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UnR2VmVyc2lvbkZvclRlc3Rpbmcod2luLCBpc0xvY2FsRGV2KSB7XG4gIHJldHVybiBnZXRSdHZWZXJzaW9uKHdpbiwgaXNMb2NhbERldik7XG59XG5cblxuLyoqIEB2aXNpYmxlRm9yVGVzdGluZyAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0UnR2VmVyc2lvbkZvclRlc3RpbmcoKSB7XG4gIHJ0dlZlcnNpb24gPSAnJztcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cblxuLyoqXG4gKiBUaGlzIGNsYXNzIGhlbHBzIHRvIG1hbmFnZSBvYnNlcnZlcnMuIE9ic2VydmVycyBjYW4gYmUgYWRkZWQsIHJlbW92ZWQgb3JcbiAqIGZpcmVkIHRocm91Z2ggYW5kIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gKiBAdGVtcGxhdGUgVFlQRVxuICovXG5leHBvcnQgY2xhc3MgT2JzZXJ2YWJsZSB7XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgT2JzZXJ2YWJsZS5cbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIC8qKiBAdHlwZSB7P0FycmF5PGZ1bmN0aW9uKFRZUEUpPn0gKi9cbiAgICB0aGlzLmhhbmRsZXJzXyA9IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyB0aGUgb2JzZXJ2ZXIgdG8gdGhpcyBpbnN0YW5jZS5cbiAgICogQHBhcmFtIHtmdW5jdGlvbihUWVBFKX0gaGFuZGxlciBPYnNlcnZlcidzIGhhbmRsZXIuXG4gICAqIEByZXR1cm4geyFVbmxpc3RlbkRlZn1cbiAgICovXG4gIGFkZChoYW5kbGVyKSB7XG4gICAgaWYgKCF0aGlzLmhhbmRsZXJzXykge1xuICAgICAgdGhpcy5oYW5kbGVyc18gPSBbXTtcbiAgICB9XG4gICAgdGhpcy5oYW5kbGVyc18ucHVzaChoYW5kbGVyKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgdGhpcy5yZW1vdmUoaGFuZGxlcik7XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmVzIHRoZSBvYnNlcnZlciBmcm9tIHRoaXMgaW5zdGFuY2UuXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oVFlQRSl9IGhhbmRsZXIgT2JzZXJ2ZXIncyBpbnN0YW5jZS5cbiAgICovXG4gIHJlbW92ZShoYW5kbGVyKSB7XG4gICAgaWYgKCF0aGlzLmhhbmRsZXJzXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBpbmRleCA9IHRoaXMuaGFuZGxlcnNfLmluZGV4T2YoaGFuZGxlcik7XG4gICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgIHRoaXMuaGFuZGxlcnNfLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgYWxsIG9ic2VydmVycy5cbiAgICovXG4gIHJlbW92ZUFsbCgpIHtcbiAgICBpZiAoIXRoaXMuaGFuZGxlcnNfKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaGFuZGxlcnNfLmxlbmd0aCA9IDA7XG4gIH1cblxuICAvKipcbiAgICogRmlyZXMgYW4gZXZlbnQuIEFsbCBvYnNlcnZlcnMgYXJlIGNhbGxlZC5cbiAgICogQHBhcmFtIHtUWVBFPX0gb3B0X2V2ZW50XG4gICAqL1xuICBmaXJlKG9wdF9ldmVudCkge1xuICAgIGlmICghdGhpcy5oYW5kbGVyc18pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgaGFuZGxlcnMgPSB0aGlzLmhhbmRsZXJzXztcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhhbmRsZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBoYW5kbGVyID0gaGFuZGxlcnNbaV07XG4gICAgICBoYW5kbGVyKG9wdF9ldmVudCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgbnVtYmVyIG9mIGhhbmRsZXJzLiBNb3N0bHkgbmVlZGVkIGZvciB0ZXN0cy5cbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKi9cbiAgZ2V0SGFuZGxlckNvdW50KCkge1xuICAgIGlmICghdGhpcy5oYW5kbGVyc18pIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5oYW5kbGVyc18ubGVuZ3RoO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuL21vZGUnO1xuaW1wb3J0IHtpbnN0YWxsIGFzIGluc3RhbGxBcnJheUluY2x1ZGVzfSBmcm9tICcuL3BvbHlmaWxscy9hcnJheS1pbmNsdWRlcyc7XG5pbXBvcnQge2luc3RhbGwgYXMgaW5zdGFsbEN1c3RvbUVsZW1lbnRzfSBmcm9tICcuL3BvbHlmaWxscy9jdXN0b20tZWxlbWVudHMnO1xuaW1wb3J0IHtcbiAgaW5zdGFsbCBhcyBpbnN0YWxsRE9NVG9rZW5MaXN0VG9nZ2xlLFxufSBmcm9tICcuL3BvbHlmaWxscy9kb210b2tlbmxpc3QtdG9nZ2xlJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsRG9jQ29udGFpbnN9IGZyb20gJy4vcG9seWZpbGxzL2RvY3VtZW50LWNvbnRhaW5zJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsTWF0aFNpZ259IGZyb20gJy4vcG9seWZpbGxzL21hdGgtc2lnbic7XG5pbXBvcnQge2luc3RhbGwgYXMgaW5zdGFsbE9iamVjdEFzc2lnbn0gZnJvbSAnLi9wb2x5ZmlsbHMvb2JqZWN0LWFzc2lnbic7XG5pbXBvcnQge2luc3RhbGwgYXMgaW5zdGFsbFByb21pc2V9IGZyb20gJy4vcG9seWZpbGxzL3Byb21pc2UnO1xuaW1wb3J0IHtpbnN0YWxsQ3VzdG9tRWxlbWVudHMgYXMgaW5zdGFsbFJlZ2lzdGVyRWxlbWVudH0gZnJvbVxuICAnZG9jdW1lbnQtcmVnaXN0ZXItZWxlbWVudC9idWlsZC9kb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50LnBhdGNoZWQnO1xuaW1wb3J0IHtpc0V4cGVyaW1lbnRPbn0gZnJvbSAnLi9leHBlcmltZW50cyc7XG5cbmlmIChpc0V4cGVyaW1lbnRPbihzZWxmLCAnY3VzdG9tLWVsZW1lbnRzLXYxJykgfHwgZ2V0TW9kZSgpLnRlc3QpIHtcbiAgaW5zdGFsbEN1c3RvbUVsZW1lbnRzKHNlbGYsIGNsYXNzIHt9KTtcbn0gZWxzZSB7XG4gIGluc3RhbGxSZWdpc3RlckVsZW1lbnQoc2VsZiwgJ2F1dG8nKTtcbn1cbmluc3RhbGxET01Ub2tlbkxpc3RUb2dnbGUoc2VsZik7XG5pbnN0YWxsTWF0aFNpZ24oc2VsZik7XG5pbnN0YWxsT2JqZWN0QXNzaWduKHNlbGYpO1xuaW5zdGFsbFByb21pc2Uoc2VsZik7XG5pbnN0YWxsRG9jQ29udGFpbnMoc2VsZik7XG5pbnN0YWxsQXJyYXlJbmNsdWRlcyhzZWxmKTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBlbGVtZW50IGlzIGluIHRoZSBhcnJheSBhbmQgZmFsc2Ugb3RoZXJ3aXNlLlxuICpcbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0X2Zyb21JbmRleFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0aGlzIHtBcnJheX1cbiAqL1xuZnVuY3Rpb24gaW5jbHVkZXModmFsdWUsIG9wdF9mcm9tSW5kZXgpIHtcbiAgY29uc3QgZnJvbUluZGV4ID0gb3B0X2Zyb21JbmRleCB8fCAwO1xuICBjb25zdCBsZW4gPSB0aGlzLmxlbmd0aDtcbiAgbGV0IGkgPSBmcm9tSW5kZXggPj0gMCA/IGZyb21JbmRleCA6IE1hdGgubWF4KGxlbiArIGZyb21JbmRleCwgMCk7XG4gIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICBjb25zdCBvdGhlciA9IHRoaXNbaV07XG4gICAgLy8gSWYgdmFsdWUgaGFzIGJlZW4gZm91bmQgT1IgKHZhbHVlIGlzIE5hTiBBTkQgb3RoZXIgaXMgTmFOKVxuICAgIC8qZXNsaW50IFwibm8tc2VsZi1jb21wYXJlXCI6IDAqL1xuICAgIGlmIChvdGhlciA9PT0gdmFsdWUgfHwgKHZhbHVlICE9PSB2YWx1ZSAmJiBvdGhlciAhPT0gb3RoZXIpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiogU2V0cyB0aGUgQXJyYXkuY29udGFpbnMgcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4qIEBwYXJhbSB7IVdpbmRvd30gd2luXG4qL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIGlmICghd2luLkFycmF5LnByb3RvdHlwZS5pbmNsdWRlcykge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnaW5jbHVkZXMnLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IGluY2x1ZGVzLFxuICAgIH0pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBwcm9taXNlOiAhUHJvbWlzZTx1bmRlZmluZWQ+LFxuICogICByZXNvbHZlOiBmdW5jdGlvbigpLFxuICogfX1cbiAqL1xubGV0IERlZmVycmVkRGVmO1xuXG4vKipcbiAqIEB0eXBlZGVmIHshRnVuY3Rpb259XG4gKi9cbmxldCBDdXN0b21FbGVtZW50Q29uc3RydWN0b3JEZWY7XG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICBuYW1lOiBzdHJpbmcsXG4gKiAgY3RvcjogIUN1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZixcbiAqIH19XG4gKi9cbmxldCBDdXN0b21FbGVtZW50RGVmO1xuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGUgY3VzdG9tIGVsZW1lbnQncyBuYW1lLlxuICogVGhpcyBpbnRlbnRpb25hbGx5IGlnbm9yZXMgXCJ2YWxpZFwiIGhpZ2hlciBVbmljb2RlIENvZGUgUG9pbnRzLlxuICogaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvY3VzdG9tLWVsZW1lbnRzLmh0bWwjdmFsaWQtY3VzdG9tLWVsZW1lbnQtbmFtZVxuICovXG5jb25zdCBWQUxJRF9OQU1FID0gL15bYS16XVthLXowLTkuX10qLVthLXowLTkuXy1dKiQvO1xuY29uc3QgSU5WQUxJRF9OQU1FUyA9IFtcbiAgJ2Fubm90YXRpb24teG1sJyxcbiAgJ2NvbG9yLXByb2ZpbGUnLFxuICAnZm9udC1mYWNlJyxcbiAgJ2ZvbnQtZmFjZS1zcmMnLFxuICAnZm9udC1mYWNlLXVyaScsXG4gICdmb250LWZhY2UtZm9ybWF0JyxcbiAgJ2ZvbnQtZmFjZS1uYW1lJyxcbiAgJ21pc3NpbmctZ2x5cGgnLFxuXTtcblxuLyoqXG4gKiBBc3NlcnRzIHRoYXQgdGhlIGN1c3RvbSBlbGVtZW50IG5hbWUgY29uZm9ybXMgdG8gdGhlIHNwZWMuXG4gKlxuICogQHBhcmFtIHshRnVuY3Rpb259IFN5bnRheEVycm9yXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICovXG5mdW5jdGlvbiBhc3NlcnRWYWxpZE5hbWUoU3ludGF4RXJyb3IsIG5hbWUpIHtcbiAgaWYgKCFWQUxJRF9OQU1FLnRlc3QobmFtZSkgfHwgSU5WQUxJRF9OQU1FUy5pbmRleE9mKG5hbWUpID49IDApIHtcbiAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoYGludmFsaWQgY3VzdG9tIGVsZW1lbnQgbmFtZSBcIiR7bmFtZX1cImApO1xuICB9XG59XG5cbi8qKlxuICogRG9lcyB3aW4gaGF2ZSBhIGZ1bGwgQ3VzdG9tIEVsZW1lbnRzIHJlZ2lzdHJ5P1xuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBoYXNDdXN0b21FbGVtZW50cyh3aW4pIHtcbiAgY29uc3Qge2N1c3RvbUVsZW1lbnRzfSA9IHdpbjtcblxuICByZXR1cm4gISEoXG4gICAgY3VzdG9tRWxlbWVudHMgJiZcbiAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUgJiZcbiAgICBjdXN0b21FbGVtZW50cy5nZXQgJiZcbiAgICBjdXN0b21FbGVtZW50cy53aGVuRGVmaW5lZCk7XG59XG5cbi8qKlxuICogV2FzIEhUTUxFbGVtZW50IGFscmVhZHkgcGF0Y2hlZCBmb3IgdGhpcyB3aW5kb3c/XG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzUGF0Y2hlZCh3aW4pIHtcbiAgY29uc3QgdGFnID0gd2luLkhUTUxFbGVtZW50LnRvU3RyaW5nKCk7XG4gIHJldHVybiB0YWcuaW5kZXhPZignW25hdGl2ZSBjb2RlXScpID09PSAtMTtcbn1cblxuLyoqXG4gKiBUaGUgcHVibGljIEN1c3RvbSBFbGVtZW50cyBBUEkuXG4gKi9cbmNsYXNzIEN1c3RvbUVsZW1lbnRSZWdpc3RyeSB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcGFyYW0geyFSZWdpc3RyeX0gcmVnaXN0cnlcbiAgICovXG4gIGNvbnN0cnVjdG9yKHdpbiwgcmVnaXN0cnkpIHtcbiAgICAvKipcbiAgICAgKiBAY29uc3QgQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLndpbl8gPSB3aW47XG5cbiAgICAvKipcbiAgICAgKiBAY29uc3QgQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLnJlZ2lzdHJ5XyA9IHJlZ2lzdHJ5O1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCBEZWZlcnJlZERlZj59XG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAY29uc3RcbiAgICAgKi9cbiAgICB0aGlzLnBlbmRpbmdEZWZpbmVzXyA9IHRoaXMud2luXy5PYmplY3QuY3JlYXRlKG51bGwpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIHRoZSBjdXN0b20gZWxlbWVudC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICogQHBhcmFtIHshQ3VzdG9tRWxlbWVudENvbnN0cnVjdG9yRGVmfSBjdG9yXG4gICAqIEBwYXJhbSB7IU9iamVjdD19IG9wdGlvbnNcbiAgICovXG4gIGRlZmluZShuYW1lLCBjdG9yLCBvcHRpb25zKSB7XG4gICAgdGhpcy5yZWdpc3RyeV8uZGVmaW5lKG5hbWUsIGN0b3IsIG9wdGlvbnMpO1xuXG4gICAgLy8gSWYgYW55b25lIGlzIHdhaXRpbmcgZm9yIHRoaXMgY3VzdG9tIGVsZW1lbnQgdG8gYmUgZGVmaW5lZCwgcmVzb2x2ZVxuICAgIC8vIHRoZWlyIHByb21pc2UuXG4gICAgY29uc3QgcGVuZGluZyA9IHRoaXMucGVuZGluZ0RlZmluZXNfO1xuICAgIGNvbnN0IGRlZmVycmVkID0gcGVuZGluZ1tuYW1lXTtcbiAgICBpZiAoZGVmZXJyZWQpIHtcbiAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgIGRlbGV0ZSBwZW5kaW5nW25hbWVdO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGNvbnN0cnVjdG9yIG9mIHRoZSAoYWxyZWFkeSBkZWZpbmVkKSBjdXN0b20gZWxlbWVudC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICogQHJldHVybiB7IUN1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZnx1bmRlZmluZWR9XG4gICAqL1xuICBnZXQobmFtZSkge1xuICAgIGNvbnN0IGRlZiA9IHRoaXMucmVnaXN0cnlfLmdldEJ5TmFtZShuYW1lKTtcbiAgICBpZiAoZGVmKSB7XG4gICAgICByZXR1cm4gZGVmLmN0b3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2FpdHMgdW50aWwgdGhlIGN1c3RvbSBlbGVtZW50IGlzIGRlZmluZWQuXG4gICAqIElmIHRoZSBjdXN0b20gZWxlbWVudCBpcyBhbHJlYWR5IGRlZmluZWQsIHJldHVybnMgYSByZXNvbHZlZCBwcm9taXNlLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTx1bmRlZmluZWQ+fVxuICAgKi9cbiAgd2hlbkRlZmluZWQobmFtZSkge1xuICAgIGNvbnN0IHtQcm9taXNlLCBTeW50YXhFcnJvcn0gPSB0aGlzLndpbl87XG4gICAgYXNzZXJ0VmFsaWROYW1lKFN5bnRheEVycm9yLCBuYW1lKTtcblxuICAgIGlmICh0aGlzLnJlZ2lzdHJ5Xy5nZXRCeU5hbWUobmFtZSkpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG5cbiAgICBjb25zdCBwZW5kaW5nID0gdGhpcy5wZW5kaW5nRGVmaW5lc187XG4gICAgY29uc3QgZGVmZXJyZWQgPSBwZW5kaW5nW25hbWVdO1xuICAgIGlmIChkZWZlcnJlZCkge1xuICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgfVxuXG4gICAgbGV0IHJlc29sdmU7XG4gICAgY29uc3QgcHJvbWlzZSA9IG5ldyAvKk9LKi9Qcm9taXNlKHJlcyA9PiByZXNvbHZlID0gcmVzKTtcbiAgICBwZW5kaW5nW25hbWVdID0ge1xuICAgICAgcHJvbWlzZSxcbiAgICAgIHJlc29sdmUsXG4gICAgfTtcblxuICAgIHJldHVybiBwcm9taXNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZ3JhZGUgYWxsIGN1c3RvbSBlbGVtZW50cyBpbnNpZGUgcm9vdC5cbiAgICpcbiAgICogQHBhcmFtIHshTm9kZX0gcm9vdFxuICAgKi9cbiAgdXBncmFkZShyb290KSB7XG4gICAgdGhpcy5yZWdpc3RyeV8udXBncmFkZShyb290KTtcbiAgfVxufVxuXG4vKipcbiAqIFRoaXMgaW50ZXJuYWwgQVBJcyBuZWNlc3NhcnkgdG8gcnVuIHRoZSBDdXN0b21FbGVtZW50UmVnaXN0cnkuXG4gKiBTaW5jZSBSZWdpc3RyeSBpcyBuZXZlciBleHBvc2VkIGV4dGVybmFsbHksIGFsbCBtZXRob2RzIGFyZSBhY3R1YWxseVxuICogYXZhaWxhYmxlIG9uIHRoZSBpbnN0YW5jZS5cbiAqL1xuY2xhc3MgUmVnaXN0cnkge1xuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHdpbikge1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlIEBjb25zdFxuICAgICAqL1xuICAgIHRoaXMud2luXyA9IHdpbjtcblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlIEBjb25zdFxuICAgICAqL1xuICAgIHRoaXMuZG9jXyA9IHdpbi5kb2N1bWVudDtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHshT2JqZWN0PHN0cmluZywgIUN1c3RvbUVsZW1lbnREZWY+fVxuICAgICAqIEBwcml2YXRlXG4gICAgICogQGNvbnN0XG4gICAgICovXG4gICAgdGhpcy5kZWZpbml0aW9uc18gPSB3aW4uT2JqZWN0LmNyZWF0ZShudWxsKTtcblxuICAgIC8qKlxuICAgICAqIEEgdXAtdG8tZGF0ZSBET00gc2VsZWN0b3IgZm9yIGFsbCBjdXN0b20gZWxlbWVudHMuXG4gICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgKi9cbiAgICB0aGlzLnF1ZXJ5XyA9ICcnO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGN1cnJlbnRseSB1cGdyYWRpbmcgZWxlbWVudC5cbiAgICAgKiBAcHJpdmF0ZSB7RWxlbWVudH1cbiAgICAgKi9cbiAgICB0aGlzLmN1cnJlbnRfID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgY3VycmVudGx5LWJlaW5nLXVwZ3JhZGVkIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBXaGVuIGFuIGFscmVhZHkgY3JlYXRlZCAodGhyb3VnaCB0aGUgRE9NIHBhcnNpbmcgQVBJcywgb3IgaW5uZXJIVE1MKVxuICAgKiBjdXN0b20gZWxlbWVudCBub2RlIGlzIGJlaW5nIHVwZ3JhZGVkLCB3ZSBjYW4ndCBqdXN0IGNyZWF0ZSBhIG5ldyBub2RlXG4gICAqIChpdCdzIGlsbGVnYWwgaW4gdGhlIHNwZWMpLiBCdXQgd2Ugc3RpbGwgbmVlZCB0byBydW4gdGhlIGN1c3RvbSBlbGVtZW50J3NcbiAgICogY29uc3RydWN0b3IgY29kZSBvbiB0aGUgbm9kZS4gV2UgYXZvaWQgdGhpcyBjb251bmRydW0gYnkgcnVubmluZyB0aGVcbiAgICogY29uc3RydWN0b3Igd2hpbGUgcmV0dXJuaW5nIHRoaXMgY3VycmVudCBub2RlIGluIHRoZSBIVE1MRWxlbWVudFxuICAgKiBjbGFzcyBjb25zdHJ1Y3RvciAodGhlIGJhc2UgY2xhc3Mgb2YgYWxsIGN1c3RvbSBlbGVtZW50cykuXG4gICAqXG4gICAqIEByZXR1cm4ge0VsZW1lbnR9XG4gICAqL1xuICBjdXJyZW50KCkge1xuICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLmN1cnJlbnRfO1xuICAgIHRoaXMuY3VycmVudF8gPSBudWxsO1xuICAgIHJldHVybiBjdXJyZW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEZpbmRzIHRoZSBjdXN0b20gZWxlbWVudCBkZWZpbml0aW9uIGJ5IG5hbWUuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAqIEByZXR1cm4ge0N1c3RvbUVsZW1lbnREZWZ8dW5kZWZpbmVkfVxuICAgKi9cbiAgZ2V0QnlOYW1lKG5hbWUpIHtcbiAgICBjb25zdCBkZWZpbml0aW9uID0gdGhpcy5kZWZpbml0aW9uc19bbmFtZV07XG4gICAgaWYgKGRlZmluaXRpb24pIHtcbiAgICAgIHJldHVybiBkZWZpbml0aW9uO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGaW5kcyB0aGUgY3VzdG9tIGVsZW1lbnQgZGVmaW5pdGlvbiBieSBjb25zdHJ1Y3RvciBpbnN0YW5jZS5cbiAgICpcbiAgICogQHBhcmFtIHtDdXN0b21FbGVtZW50Q29uc3RydWN0b3JEZWZ9IGN0b3JcbiAgICogQHJldHVybiB7Q3VzdG9tRWxlbWVudERlZnx1bmRlZmluZWR9XG4gICAqL1xuICBnZXRCeUNvbnN0cnVjdG9yKGN0b3IpIHtcbiAgICBjb25zdCBkZWZpbml0aW9ucyA9IHRoaXMuZGVmaW5pdGlvbnNfO1xuXG4gICAgZm9yIChjb25zdCBuYW1lIGluIGRlZmluaXRpb25zKSB7XG4gICAgICBjb25zdCBkZWYgPSBkZWZpbml0aW9uc1tuYW1lXTtcbiAgICAgIGlmIChkZWYuY3RvciA9PT0gY3Rvcikge1xuICAgICAgICByZXR1cm4gZGVmO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlcnMgdGhlIGN1c3RvbSBlbGVtZW50IGRlZmluaXRpb24sIGFuZCB1cGdyYWRlcyBhbGwgZWxlbWVudHMgYnkgdGhhdFxuICAgKiBuYW1lIGluIHRoZSByb290IGRvY3VtZW50LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcGFyYW0geyFDdXN0b21FbGVtZW50Q29uc3RydWN0b3JEZWZ9IGN0b3JcbiAgICogQHBhcmFtIHshT2JqZWN0fHVuZGVmaW5lZH0gb3B0aW9uc1xuICAgKi9cbiAgZGVmaW5lKG5hbWUsIGN0b3IsIG9wdGlvbnMpIHtcbiAgICBjb25zdCB7RXJyb3IsIFN5bnRheEVycm9yfSA9IHRoaXMud2luXztcblxuICAgIGlmIChvcHRpb25zKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4dGVuZGluZyBuYXRpdmUgY3VzdG9tIGVsZW1lbnRzIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbiAgICB9XG5cbiAgICBhc3NlcnRWYWxpZE5hbWUoU3ludGF4RXJyb3IsIG5hbWUpO1xuXG4gICAgaWYgKHRoaXMuZ2V0QnlOYW1lKG5hbWUpIHx8XG4gICAgICAgIHRoaXMuZ2V0QnlDb25zdHJ1Y3RvcihjdG9yKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBkdXBsaWNhdGUgZGVmaW5pdGlvbiBcIiR7bmFtZX1cImApO1xuICAgIH1cblxuICAgIC8vIFRPRE8oanJpZGdld2VsbCk6IFJlY29yZCBjb25uZWN0ZWRDYWxsYmFjaywgZGlzY29ubmVjdGVkQ2FsbGJhY2ssXG4gICAgLy8gYWRvcHRlZENhbGxiYWNrLCBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2ssIGFuZCBvYnNlcnZlZEF0dHJpYnV0ZXMuXG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogSWYgYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrLCBnYXRoZXIgb2JzZXJ2ZWRBdHRyaWJ1dGVzXG4gICAgdGhpcy5kZWZpbml0aW9uc19bbmFtZV0gPSB7XG4gICAgICBuYW1lLFxuICAgICAgY3RvcixcbiAgICB9O1xuXG4gICAgdGhpcy5vYnNlcnZlXyhuYW1lKTtcbiAgICB0aGlzLnVwZ3JhZGUodGhpcy5kb2NfLCBuYW1lKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGdyYWRlcyBjdXN0b20gZWxlbWVudHMgZGVzY2VuZGFudHMgb2Ygcm9vdCAoYnV0IG5vdCBpbmNsdWRpbmcgcm9vdCkuXG4gICAqXG4gICAqIFdoZW4gY2FsbGVkIHdpdGggYW4gb3B0X3F1ZXJ5LCBpdCBib3RoIHVwZ3JhZGVzIGFuZCBjb25uZWN0cyB0aGUgY3VzdG9tXG4gICAqIGVsZW1lbnRzICh0aGlzIGlzIHVzZWQgZHVyaW5nIHRoZSBjdXN0b20gZWxlbWVudCBkZWZpbmUgYWxnb3JpdGhtKS5cbiAgICpcbiAgICogQHBhcmFtIHshTm9kZX0gcm9vdFxuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9xdWVyeVxuICAgKi9cbiAgdXBncmFkZShyb290LCBvcHRfcXVlcnkpIHtcbiAgICAvLyBPbmx5IEN1c3RvbUVsZW1lbnRSZWdpc3RyeS5wLmRlZmluZSBwcm92aWRlcyBhIHF1ZXJ5ICh0aGUgbmV3bHkgZGVmaW5lZFxuICAgIC8vIGN1c3RvbSBlbGVtZW50KS4gSW4gdGhpcyBjYXNlLCB3ZSBhcmUgYm90aCB1cGdyYWRpbmcgX2FuZF8gY29ubmVjdGluZ1xuICAgIC8vIHRoZSBjdXN0b20gZWxlbWVudHMuXG4gICAgY29uc3QgbmV3bHlEZWZpbmVkID0gISFvcHRfcXVlcnk7XG4gICAgY29uc3QgcXVlcnkgPSBvcHRfcXVlcnkgfHwgdGhpcy5xdWVyeV87XG4gICAgY29uc3QgdXBncmFkZUNhbmRpZGF0ZXMgPSB0aGlzLnF1ZXJ5QWxsXyhyb290LCBxdWVyeSk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHVwZ3JhZGVDYW5kaWRhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBjYW5kaWRhdGUgPSB1cGdyYWRlQ2FuZGlkYXRlc1tpXTtcbiAgICAgIGlmIChuZXdseURlZmluZWQpIHtcbiAgICAgICAgdGhpcy5jb25uZWN0ZWRDYWxsYmFja18oY2FuZGlkYXRlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMudXBncmFkZVNlbGYoY2FuZGlkYXRlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBncmFkZXMgdGhlIGN1c3RvbSBlbGVtZW50IG5vZGUsIGlmIGEgY3VzdG9tIGVsZW1lbnQgaGFzIGJlZW4gcmVnaXN0ZXJlZFxuICAgKiBieSB0aGlzIG5hbWUuXG4gICAqXG4gICAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAgICovXG4gIHVwZ3JhZGVTZWxmKG5vZGUpIHtcbiAgICBjb25zdCBkZWYgPSB0aGlzLmdldEJ5TmFtZShub2RlLmxvY2FsTmFtZSk7XG4gICAgaWYgKCFkZWYpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnVwZ3JhZGVTZWxmXygvKiogQHR5cGUgeyFFbGVtZW50fSAqLyhub2RlKSwgZGVmKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFOb2RlfSByb290XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBxdWVyeVxuICAgKiBAcmV0dXJuIHshQXJyYXl8IU5vZGVMaXN0fVxuICAgKi9cbiAgcXVlcnlBbGxfKHJvb3QsIHF1ZXJ5KSB7XG4gICAgaWYgKCFxdWVyeSB8fCAhcm9vdC5xdWVyeVNlbGVjdG9yQWxsKSB7XG4gICAgICAvLyBOb3RoaW5nIHRvIGRvLi4uXG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgcmV0dXJuIHJvb3QucXVlcnlTZWxlY3RvckFsbChxdWVyeSk7XG4gIH1cblxuICAvKipcbiAgICogVXBncmFkZXMgdGhlIChhbHJlYWR5IGNyZWF0ZWQgdmlhIERPTSBwYXJzaW5nKSBjdXN0b20gZWxlbWVudC5cbiAgICpcbiAgICogQHBhcmFtIHshRWxlbWVudH0gbm9kZVxuICAgKiBAcGFyYW0geyFDdXN0b21FbGVtZW50RGVmfSBkZWZcbiAgICovXG4gIHVwZ3JhZGVTZWxmXyhub2RlLCBkZWYpIHtcbiAgICBjb25zdCB7Y3Rvcn0gPSBkZWY7XG4gICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBjdG9yKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gRGVzcGl0ZSBob3cgaXQgbG9va3MsIHRoaXMgaXMgbm90IGEgdXNlbGVzcyBjb25zdHJ1Y3Rpb24uXG4gICAgLy8gSFRNTEVsZW1lbnRQb2x5ZmlsbCAodGhlIGJhc2UgY2xhc3Mgb2YgYWxsIGN1c3RvbSBlbGVtZW50cykgd2lsbCByZXR1cm5cbiAgICAvLyB0aGUgY3VycmVudCBub2RlLCBhbGxvd2luZyB0aGUgY3VzdG9tIGVsZW1lbnQncyBzdWJjbGFzcyBjb25zdHJ1Y3RvciB0b1xuICAgIC8vIHJ1biBvbiB0aGUgbm9kZS4gVGhlIG5vZGUgaXRzZWxmIGlzIGFscmVhZHkgY29uc3RydWN0ZWQsIHNvIHRoZSByZXR1cm5cbiAgICAvLyB2YWx1ZSBpcyBqdXN0IHRoZSBub2RlLlxuICAgIHRoaXMuY3VycmVudF8gPSBub2RlO1xuICAgIGNvbnN0IGVsID0gbmV3IGN0b3IoKTtcblxuICAgIGlmIChlbCAhPT0gbm9kZSkge1xuICAgICAgdGhyb3cgbmV3IHRoaXMud2luXy5FcnJvcihcbiAgICAgICAgICAnQ29uc3RydWN0b3IgaWxsZWdhbGx5IHJldHVybmVkIGEgZGlmZmVyZW50IGluc3RhbmNlLicpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGaXJlcyBjb25uZWN0ZWRDYWxsYmFjayBvbiB0aGUgY3VzdG9tIGVsZW1lbnQsIGlmIGl0IGhhcyBvbmUuXG4gICAqIFRoaXMgYWxzbyB1cGdyYWRlcyB0aGUgY3VzdG9tIGVsZW1lbnQsIHNpbmNlIGl0IG1heSBub3QgaGF2ZSBiZWVuXG4gICAqIGFjY2Vzc2libGUgdmlhIHRoZSByb290IGRvY3VtZW50IGJlZm9yZSAoYSBkZXRhY2hlZCBET00gdHJlZSkuXG4gICAqXG4gICAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAgICovXG4gIGNvbm5lY3RlZENhbGxiYWNrXyhub2RlKSB7XG4gICAgY29uc3QgZGVmID0gdGhpcy5nZXRCeU5hbWUobm9kZS5sb2NhbE5hbWUpO1xuICAgIGlmICghZGVmKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMudXBncmFkZVNlbGZfKC8qKiBAdHlwZSB7IUVsZW1lbnR9ICovKG5vZGUpLCBkZWYpO1xuICAgIC8vIFRPRE8oanJpZGdld2VsbCk6IEl0IG1heSBiZSBhcHByb3ByaWF0ZSB0byBhZG9wdENhbGxiYWNrLCBpZiB0aGUgbm9kZVxuICAgIC8vIHVzZWQgdG8gYmUgaW4gYW5vdGhlciBkb2MuXG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogSSBzaG91bGQgYmUgY2FsbGluZyB0aGUgZGVmaW5pdGlvbnMgY29ubmVjdGVkQ2FsbGJhY2tcbiAgICAvLyB3aXRoIG5vZGUgYXMgdGhlIGNvbnRleHQuXG4gICAgaWYgKG5vZGUuY29ubmVjdGVkQ2FsbGJhY2spIHtcbiAgICAgIG5vZGUuY29ubmVjdGVkQ2FsbGJhY2soKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRmlyZXMgZGlzY29ubmVjdGVkQ2FsbGJhY2sgb24gdGhlIGN1c3RvbSBlbGVtZW50LCBpZiBpdCBoYXMgb25lLlxuICAgKlxuICAgKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gICAqL1xuICBkaXNjb25uZWN0ZWRDYWxsYmFja18obm9kZSkge1xuICAgIC8vIFRPRE8oanJpZGdld2VsbCk6IEkgc2hvdWxkIGJlIGNhbGxpbmcgdGhlIGRlZmluaXRpb25zIGNvbm5lY3RlZENhbGxiYWNrXG4gICAgLy8gd2l0aCBub2RlIGFzIHRoZSBjb250ZXh0LlxuICAgIGlmIChub2RlLmRpc2Nvbm5lY3RlZENhbGxiYWNrKSB7XG4gICAgICBub2RlLmRpc2Nvbm5lY3RlZENhbGxiYWNrKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlY29yZHMgbmFtZSBhcyBhIHJlZ2lzdGVyZWQgY3VzdG9tIGVsZW1lbnQgdG8gb2JzZXJ2ZS5cbiAgICpcbiAgICogU3RhcnRzIHRoZSBNdXRhdGlvbiBPYnNlcnZlciBpZiB0aGlzIGlzIHRoZSBmaXJzdCByZWdpc3RlcmVkIGN1c3RvbVxuICAgKiBlbGVtZW50LiBUaGlzIGlzIGRlZmVycmVkIHVudGlsIHRoZSBmaXJzdCBjdXN0b20gZWxlbWVudCBpcyBkZWZpbmVkIHRvXG4gICAqIHNwZWVkIHVwIGluaXRpYWwgcmVuZGVyaW5nIG9mIHRoZSBwYWdlLlxuICAgKlxuICAgKiBNdXRhdGlvbiBPYnNlcnZlcnMgYXJlIGNvbnZlbmllbnRseSBhdmFpbGFibGUgaW4gZXZlcnkgYnJvd3NlciB3ZSBjYXJlXG4gICAqIGFib3V0LiBXaGVuIGEgbm9kZSBpcyBjb25uZWN0ZWQgdG8gdGhlIHJvb3QgZG9jdW1lbnQsIGFsbCBjdXN0b21cbiAgICogZWxlbWVudHMgKGluY2x1ZGluZyB0aGF0IG5vZGUgaXRlc2VsZikgd2lsbCBiZSB1cGdyYWRlZCBhbmQgY2FsbFxuICAgKiBjb25uZWN0ZWRDYWxsYmFjay4gV2hlbiBhIG5vZGUgaXMgZGlzY29ubmVjdGVkQ2FsbGJhY2sgZnJvbSB0aGUgcm9vdFxuICAgKiBkb2N1bWVudCwgYWxsIGN1c3RvbSBlbGVtZW50cyB3aWxsIGNhbGwgZGlzY29ubmVjdGVkQ2FsbGJhY2suXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAqL1xuICBvYnNlcnZlXyhuYW1lKSB7XG4gICAgaWYgKHRoaXMucXVlcnlfKSB7XG4gICAgICB0aGlzLnF1ZXJ5XyArPSBgLCR7bmFtZX1gO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMucXVlcnlfID0gbmFtZTtcblxuICAgIC8vIFRoZSBmaXJzdCByZWdpc3RlcmVkIG5hbWUgc3RhcnRzIHRoZSBtdXRhdGlvbiBvYnNlcnZlci5cbiAgICBjb25zdCBvYnNlcnZlciA9IG5ldyB0aGlzLndpbl8uTXV0YXRpb25PYnNlcnZlcihyZWNvcmRzID0+IHtcbiAgICAgIGlmIChyZWNvcmRzKSB7XG4gICAgICAgIHRoaXMuaGFuZGxlUmVjb3Jkc18ocmVjb3Jkcyk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmRvY18sIHtcbiAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgIHN1YnRyZWU6IHRydWUsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIGFsbCB0aGUgTXV0YXRpb24gT2JzZXJ2ZXIncyBNdXRhdGlvbiBSZWNvcmRzLlxuICAgKiBBbGwgYWRkZWQgY3VzdG9tIGVsZW1lbnRzIHdpbGwgYmUgdXBncmFkZWQgKGlmIG5vdCBhbHJlYWR5KSBhbmQgY2FsbFxuICAgKiBjb25uZWN0ZWRDYWxsYmFjay4gQWxsIHJlbW92ZWQgY3VzdG9tIGVsZW1lbnRzIHdpbGwgY2FsbFxuICAgKiBkaXNjb25uZWN0ZWRDYWxsYmFjay5cbiAgICpcbiAgICogQHBhcmFtIHshQXJyYXk8IU11dGF0aW9uUmVjb3JkPn0gcmVjb3Jkc1xuICAgKi9cbiAgaGFuZGxlUmVjb3Jkc18ocmVjb3Jkcykge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVjb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgcmVjb3JkID0gcmVjb3Jkc1tpXTtcbiAgICAgIGlmICghcmVjb3JkKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB7YWRkZWROb2RlcywgcmVtb3ZlZE5vZGVzfSA9IHJlY29yZDtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWRkZWROb2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBub2RlID0gYWRkZWROb2Rlc1tpXTtcbiAgICAgICAgY29uc3QgY29ubmVjdGVkQ2FuZGlkYXRlcyA9IHRoaXMucXVlcnlBbGxfKG5vZGUsIHRoaXMucXVlcnlfKTtcbiAgICAgICAgdGhpcy5jb25uZWN0ZWRDYWxsYmFja18obm9kZSk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29ubmVjdGVkQ2FuZGlkYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuY29ubmVjdGVkQ2FsbGJhY2tfKGNvbm5lY3RlZENhbmRpZGF0ZXNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVtb3ZlZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSByZW1vdmVkTm9kZXNbaV07XG4gICAgICAgIGNvbnN0IGRpc2Nvbm5lY3RlZENhbmRpZGF0ZXMgPSB0aGlzLnF1ZXJ5QWxsXyhub2RlLCB0aGlzLnF1ZXJ5Xyk7XG4gICAgICAgIHRoaXMuZGlzY29ubmVjdGVkQ2FsbGJhY2tfKG5vZGUpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpc2Nvbm5lY3RlZENhbmRpZGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RlZENhbGxiYWNrXyhkaXNjb25uZWN0ZWRDYW5kaWRhdGVzW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIERvZXMgdGhlIHBvbHlmaWxsaW5nLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZnVuY3Rpb24gcG9seWZpbGwod2luKSB7XG4gIGNvbnN0IHtIVE1MRWxlbWVudCwgRWxlbWVudCwgTm9kZSwgRG9jdW1lbnQsIE9iamVjdCwgZG9jdW1lbnR9ID0gd2luO1xuICBjb25zdCB7Y3JlYXRlRWxlbWVudCwgY2xvbmVOb2RlLCBpbXBvcnROb2RlfSA9IGRvY3VtZW50O1xuXG4gIGNvbnN0IHJlZ2lzdHJ5ID0gbmV3IFJlZ2lzdHJ5KHdpbik7XG4gIGNvbnN0IGN1c3RvbUVsZW1lbnRzID0gbmV3IEN1c3RvbUVsZW1lbnRSZWdpc3RyeSh3aW4sIHJlZ2lzdHJ5KTtcblxuICAvLyBFeHBvc2UgdGhlIGN1c3RvbSBlbGVtZW50IHJlZ2lzdHJ5LlxuICAvLyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHdpbmRvdywgJ2N1c3RvbUVsZW1lbnRzJylcbiAgLy8ge2dldDogxpIsIHNldDogdW5kZWZpbmVkLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWV9XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW4sICdjdXN0b21FbGVtZW50cycsIHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAvLyB3cml0YWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGN1c3RvbUVsZW1lbnRzLFxuICB9KTtcblxuICAvLyBQYXRjaCBjcmVhdGVFbGVtZW50IHRvIGltbWVkaWF0ZWx5IHVwZ3JhZGUgdGhlIGN1c3RvbSBlbGVtZW50LlxuICAvLyBUaGlzIGhhcyB0aGUgYWRkZWQgYmVuZWZpdCB0aGF0IGl0IGF2b2lkcyB0aGUgXCJhbHJlYWR5IGNyZWF0ZWQgYnV0IG5lZWRzXG4gIC8vIGNvbnN0cnVjdG9yIGNvZGUgcnVuXCIgY2hpY2tlbi1hbmQtZWdnIHByb2JsZW0uXG4gIERvY3VtZW50LnByb3RvdHlwZS5jcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24gY3JlYXRlRWxlbWVudFBvbHlmaWxsKG5hbWUpIHtcbiAgICBjb25zdCBkZWYgPSByZWdpc3RyeS5nZXRCeU5hbWUobmFtZSk7XG4gICAgaWYgKGRlZikge1xuICAgICAgcmV0dXJuIG5ldyBkZWYuY3RvcigpO1xuICAgIH1cbiAgICByZXR1cm4gY3JlYXRlRWxlbWVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIC8vIFBhdGNoIGltcG9ydE5vZGUgdG8gaW1tZWRpYXRlbHkgdXBncmFkZSBjdXN0b20gZWxlbWVudHMuXG4gIC8vIFRPRE8oanJpZGdld2VsbCk6IENhbiBmaXJlIGFkb3B0ZWRDYWxsYmFjayBmb3IgY3Jvc3MgZG9jIGltcG9ydHMuXG4gIERvY3VtZW50LnByb3RvdHlwZS5pbXBvcnROb2RlID0gZnVuY3Rpb24gaW1wb3J0Tm9kZVBvbHlmaWxsKCkge1xuICAgIGNvbnN0IGltcG9ydGVkID0gaW1wb3J0Tm9kZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmIChpbXBvcnRlZCkge1xuICAgICAgcmVnaXN0cnkudXBncmFkZVNlbGYoaW1wb3J0ZWQpO1xuICAgICAgcmVnaXN0cnkudXBncmFkZShpbXBvcnRlZCk7XG4gICAgfVxuICAgIHJldHVybiBpbXBvcnRlZDtcbiAgfTtcblxuICAvLyBQYXRjaCBjbG9uZU5vZGUgdG8gaW1tZWRpYXRlbHkgdXBncmFkZSBjdXN0b20gZWxlbWVudHMuXG4gIE5vZGUucHJvdG90eXBlLmNsb25lTm9kZSA9IGZ1bmN0aW9uIGNsb25lTm9kZVBvbHlmaWxsKCkge1xuICAgIGNvbnN0IGNsb25lZCA9IGNsb25lTm9kZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIHJlZ2lzdHJ5LnVwZ3JhZGVTZWxmKGNsb25lZCk7XG4gICAgcmVnaXN0cnkudXBncmFkZShjbG9uZWQpO1xuICAgIHJldHVybiBjbG9uZWQ7XG4gIH07XG5cbiAgLy8gUGF0Y2ggdGhlIGlubmVySFRNTCBzZXR0ZXIgdG8gaW1tZWRpYXRlbHkgdXBncmFkZSBjdXN0b20gZWxlbWVudHMuXG4gIC8vIE5vdGUsIHRoaXMgY291bGQgdGVjaG5pY2FsbHkgZmlyZSBjb25uZWN0ZWRDYWxsYmFja3MgaWYgdGhpcyBub2RlIHdhc1xuICAvLyBjb25uZWN0ZWQsIGJ1dCB3ZSBsZWF2ZSB0aGF0IHRvIHRoZSBNdXRhdGlvbiBPYnNlcnZlci5cbiAgY29uc3QgaW5uZXJIVE1MRGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoRWxlbWVudC5wcm90b3R5cGUsXG4gICAgICAnaW5uZXJIVE1MJyk7XG4gIGNvbnN0IGlubmVySFRNTFNldHRlciA9IGlubmVySFRNTERlc2Muc2V0O1xuICBpbm5lckhUTUxEZXNjLnNldCA9IGZ1bmN0aW9uKGh0bWwpIHtcbiAgICBpbm5lckhUTUxTZXR0ZXIuY2FsbCh0aGlzLCBodG1sKTtcbiAgICByZWdpc3RyeS51cGdyYWRlKHRoaXMpO1xuICB9O1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRWxlbWVudC5wcm90b3R5cGUsICdpbm5lckhUTUwnLCBpbm5lckhUTUxEZXNjKTtcblxuICAvKipcbiAgICogWW91IGNhbid0IHVzZSB0aGUgcmVhbCBIVE1MRWxlbWVudCBjb25zdHJ1Y3RvciwgYmVjYXVzZSB5b3UgY2FuJ3Qgc3ViY2xhc3NcbiAgICogaXQgd2l0aG91dCB1c2luZyBuYXRpdmUgY2xhc3Nlcy4gU28sIG1vY2sgaXRzIGFwcHJveGltYXRpb24gdXNpbmdcbiAgICogY3JlYXRlRWxlbWVudC5cbiAgICovXG4gIGZ1bmN0aW9uIEhUTUxFbGVtZW50UG9seWZpbGwoKSB7XG4gICAgY29uc3Qge2NvbnN0cnVjdG9yfSA9IHRoaXM7XG5cbiAgICAvLyBJZiB3ZSdyZSB1cGdyYWRpbmcgYW4gYWxyZWFkeSBjcmVhdGVkIGN1c3RvbSBlbGVtZW50LCB3ZSBjYW4ndCBjcmVhdGVcbiAgICAvLyBhbm90aGVyIG5ldyBub2RlIChieSB0aGUgc3BlYywgaXQgbXVzdCBiZSB0aGUgc2FtZSBub2RlKS5cbiAgICBsZXQgZWwgPSByZWdpc3RyeS5jdXJyZW50KCk7XG5cbiAgICAvLyBJZiB0aGVyZSdzIG5vdCBhIGFscmVhZHkgY3JlYXRlZCBjdXN0b20gZWxlbWVudCwgd2UncmUgYmVpbmcgaW52b2tlZCB2aWFcbiAgICAvLyBgbmV3YGluZyB0aGUgY29uc3RydWN0b3IuXG4gICAgLy9cbiAgICAvLyBUZWNobmljYWxseSwgd2UgY291bGQgZ2V0IGhlcmUgdmlhIGNyZWF0ZUVsZW1lbnQsIGJ1dCB3ZSBwYXRjaGVkIHRoYXQuXG4gICAgLy8gSWYgaXQgdGhlIGN1c3RvbSBlbGVtZW50IHdhcyByZWdpc3RlcmVkLCB0aGUgcGF0Y2ggdHVybmVkIGl0IGludG8gYVxuICAgIC8vIGBuZXdgIGNhbGwuXG4gICAgLy8gSWYgaXQgd2FzIG5vdCByZWdpc3RlcmVkLCB0aGUgbmF0aXZlIGNyZWF0ZUVsZW1lbnQgaXMgdXNlZC4gQW5kIGlmXG4gICAgLy8gbmF0aXZlIGNyZWF0ZUVsZW1lbnQgaXMgYmVpbmcgdXNlZCBhbmQgd2UgZ290IHRvIHRoaXMgY29kZSwgd2UncmUgcmVhbGx5XG4gICAgLy8gaW4gYW4gaW5maW5pdGUgbG9vcCAoYSBuYXRpdmUgY3JlYXRlRWxlbWVudCBjYWxsIGp1c3QgYmVsb3cpIHNvIHdlJ3ZlXG4gICAgLy8gZ290IGJpZ2dlciBwcm9ibGVtcy5cbiAgICAvL1xuICAgIC8vIFNvIGp1c3QgdGFrZSBteSB3b3JkIHdlIGdvdCBoZXJlIHZpYSBgbmV3YC5cbiAgICBpZiAoIWVsKSB7XG4gICAgICAvLyBUaGUgY3VzdG9tIGVsZW1lbnQgZGVmaW5pdGlvbiBpcyBhbiBpbnZhcmlhbnQuIElmIHRoZSBjdXN0b20gZWxlbWVudFxuICAgICAgLy8gaXMgcmVnaXN0ZXJlZCwgZXZlcnl0aGluZyB3b3Jrcy4gSWYgaXQncyBub3QsIGl0IHRocm93cyBpbiB0aGUgbWVtYmVyXG4gICAgICAvLyBwcm9wZXJ0eSBhY2Nlc3MgKG9ubHkgZGVmaW5lZCBjdXN0b20gZWxlbWVudHMgY2FuIGJlIGRpcmVjdGx5XG4gICAgICAvLyBjb25zdHJ1Y3RlZCB2aWEgYG5ld2ApLlxuICAgICAgY29uc3QgZGVmID0gcmVnaXN0cnkuZ2V0QnlDb25zdHJ1Y3Rvcihjb25zdHJ1Y3Rvcik7XG4gICAgICBlbCA9IGNyZWF0ZUVsZW1lbnQuY2FsbChkb2N1bWVudCwgZGVmLm5hbWUpO1xuICAgIH1cblxuICAgIC8vIEZpbmFsbHksIGlmIHRoZSBub2RlIHdhcyBhbHJlYWR5IGNvbnN0cnVjdGVkLCB3ZSBuZWVkIHRvIHJlc2V0IGl0J3NcbiAgICAvLyBwcm90b3R5cGUgdG8gdGhlIGN1c3RvbSBlbGVtZW50IHByb3RvdHlwZS4gQW5kIGlmIGl0IHdhc24ndCBhbHJlYWR5XG4gICAgLy8gY29uc3RydWN0ZWQsIHdlIGNyZWF0ZWQgYSBuZXcgbm9kZSB2aWEgbmF0aXZlIGNyZWF0ZUVsZW1lbnQsIGFuZCB3ZSBuZWVkXG4gICAgLy8gdG8gcmVzZXQgaXQncyBwcm90b3R5cGUuIEJhc2ljYWxseSBhbHdheXMgcmVzZXQgdGhlIHByb3RvdHlwZS5cbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoZWwsIGNvbnN0cnVjdG9yLnByb3RvdHlwZSk7XG4gICAgcmV0dXJuIGVsO1xuICB9XG4gIHN1YkNsYXNzKE9iamVjdCwgSFRNTEVsZW1lbnQsIEhUTUxFbGVtZW50UG9seWZpbGwpO1xuXG4gIC8vIEV4cG9zZSB0aGUgcG9seWZpbGxlZCBIVE1MRWxlbWVudCBjb25zdHJ1Y3RvciBmb3IgZXZlcnlvbmUgdG8gZXh0ZW5kIGZyb20uXG4gIHdpbi5IVE1MRWxlbWVudCA9IEhUTUxFbGVtZW50UG9seWZpbGw7XG59XG5cbi8qKlxuICogV3JhcHMgSFRNTEVsZW1lbnQgaW4gYSBSZWZsZWN0LmNvbnN0cnVjdCBjb25zdHJ1Y3Rvciwgc28gdGhhdCB0cmFuc3BpbGVkXG4gKiBjbGFzc2VzIGNhbiBgX3RoaXMgPSBzdXBlckNsYXNzLmNhbGwodGhpcylgIGR1cmluZyB0aGVpciBjb25zdHJ1Y3Rpb24uXG4gKlxuICogVGhpcyBpcyBvbmx5IHVzZWQgd2hlbiBDdXN0b20gRWxlbWVudHMgdjEgaXMgYWxyZWFkeSBhdmFpbGFibGUgX2FuZF8gd2UncmVcbiAqIHVzaW5nIHRyYW5zcGlsZWQgY2xhc3NlcyAod2hpY2ggdXNlIEVTNSBjb25zdHJ1Y3Rpb24gaWRpb21zKS5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5mdW5jdGlvbiB3cmFwSFRNTEVsZW1lbnQod2luKSB7XG4gIGNvbnN0IHtIVE1MRWxlbWVudCwgUmVmbGVjdCwgT2JqZWN0fSA9IHdpbjtcbiAgLyoqXG4gICAqL1xuICBmdW5jdGlvbiBIVE1MRWxlbWVudFdyYXBwZXIoKSB7XG4gICAgY29uc3QgY3RvciA9IC8qKiBAdHlwZSB7ZnVuY3Rpb24oLi4uPyk6P3x1bmRlZmluZWR9ICovKFxuICAgICAgLyoqIEB0eXBlIHshSFRNTEVsZW1lbnR9ICovKHRoaXMpLmNvbnN0cnVjdG9yKTtcblxuICAgIC8vIFJlZmxlY3QuY29uc3RydWN0IGFsbG93cyB1cyB0byBjb25zdHJ1Y3QgYSBuZXcgSFRNTEVsZW1lbnQgd2l0aG91dCB1c2luZ1xuICAgIC8vIGBuZXdgICh3aGljaCB3aWxsIGFsd2F5cyBmYWlsIGJlY2F1c2UgbmF0aXZlIEhUTUxFbGVtZW50IGlzIGEgcmVzdHJpY3RlZFxuICAgIC8vIGNvbnN0cnVjdG9yKS5cbiAgICByZXR1cm4gUmVmbGVjdC5jb25zdHJ1Y3QoSFRNTEVsZW1lbnQsIFtdLCBjdG9yKTtcbiAgfVxuICBzdWJDbGFzcyhPYmplY3QsIEhUTUxFbGVtZW50LCBIVE1MRWxlbWVudFdyYXBwZXIpO1xuXG4gIC8vIEV4cG9zZSB0aGUgd3JhcHBlZCBIVE1MRWxlbWVudCBjb25zdHJ1Y3RvciBmb3IgZXZlcnlvbmUgdG8gZXh0ZW5kIGZyb20uXG4gIHdpbi5IVE1MRWxlbWVudCA9IEhUTUxFbGVtZW50V3JhcHBlcjtcbn1cblxuLyoqXG4gKiBTZXR1cHMgdXAgcHJvdG90eXBlIGluaGVyaXRhbmNlXG4gKlxuICogQHBhcmFtIHshT2JqZWN0fSBPYmplY3RcbiAqIEBwYXJhbSB7IUZ1bmN0aW9ufSBzdXBlckNsYXNzXG4gKiBAcGFyYW0geyFGdW5jdGlvbn0gc3ViQ2xhc3NcbiAqL1xuZnVuY3Rpb24gc3ViQ2xhc3MoT2JqZWN0LCBzdXBlckNsYXNzLCBzdWJDbGFzcykge1xuICAvLyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHN1cGVyQ2xhc3MucHJvdG90eXBlLCAnY29uc3RydWN0b3InKVxuICAvLyB7dmFsdWU6IMaSLCB3cml0YWJsZTogdHJ1ZSwgZW51bWVyYWJsZTogZmFsc2UsIGNvbmZpZ3VyYWJsZTogdHJ1ZX1cbiAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSwge1xuICAgIGNvbnN0cnVjdG9yOiB7XG4gICAgICAvLyBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IHN1YkNsYXNzLFxuICAgIH0sXG4gIH0pO1xufVxuXG4vKipcbiAqIFBvbHlmaWxscyBDdXN0b20gRWxlbWVudHMgdjEgQVBJLiBUaGlzIGhhcyA0IG1vZGVzOlxuICpcbiAqIDEuIEN1c3RvbSBlbGVtZW50cyB2MSBhbHJlYWR5IHN1cHBvcnRlZCwgdXNpbmcgbmF0aXZlIGNsYXNzZXNcbiAqIDIuIEN1c3RvbSBlbGVtZW50cyB2MSBhbHJlYWR5IHN1cHBvcnRlZCwgdXNpbmcgdHJhbnNwaWxlZCBjbGFzc2VzXG4gKiAzLiBDdXN0b20gZWxlbWVudHMgdjEgbm90IHN1cHBvcnRlZCwgdXNpbmcgbmF0aXZlIGNsYXNzZXNcbiAqIDQuIEN1c3RvbSBlbGVtZW50cyB2MSBub3Qgc3VwcG9ydGVkLCB1c2luZyB0cmFuc3BpbGVkIGNsYXNzZXNcbiAqXG4gKiBJbiBtb2RlIDEsIG5vdGhpbmcgaXMgZG9uZS4gSW4gbW9kZSAyLCBhIG1pbmltYWwgcG9seWZpbGwgaXMgdXNlZCB0byBzdXBwb3J0XG4gKiBleHRlbmRpbmcgdGhlIEhUTUxFbGVtZW50IGJhc2UgY2xhc3MuIEluIG1vZGUgMyBhbmQgNCwgYSBmdWxsIHBvbHlmaWxsIGlzXG4gKiBkb25lLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFGdW5jdGlvbn0gY3RvclxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4sIGN0b3IpIHtcbiAgaWYgKGlzUGF0Y2hlZCh3aW4pKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IGluc3RhbGwgPSB0cnVlO1xuICBsZXQgaW5zdGFsbFdyYXBwZXIgPSBmYWxzZTtcblxuICBpZiAoaGFzQ3VzdG9tRWxlbWVudHMod2luKSkge1xuICAgIC8vIElmIGN0b3IgaXMgY29uc3RydWN0YWJsZSB3aXRob3V0IG5ldywgaXQncyBhIGZ1bmN0aW9uLiBUaGF0IG1lYW5zIGl0IHdhc1xuICAgIC8vIGNvbXBpbGVkIGRvd24sIGFuZCB3ZSBuZWVkIHRvIGRvIHRoZSBtaW5pbWFsIHBvbHlmaWxsIGJlY2F1c2UgYWxsIHlvdVxuICAgIC8vIGNhbm5vdCBleHRlbmQgSFRNTEVsZW1lbnQgd2l0aG91dCBuYXRpdmUgY2xhc3Nlcy5cbiAgICB0cnkge1xuICAgICAgY29uc3Qge09iamVjdCwgUmVmbGVjdH0gPSB3aW47XG5cbiAgICAgIC8vIFwiQ29uc3RydWN0XCIgY3RvciB1c2luZyBFUzUgaWRpb21zXG4gICAgICBjb25zdCBpbnN0YW5jZSA9IE9iamVjdC5jcmVhdGUoY3Rvci5wcm90b3R5cGUpO1xuICAgICAgY3Rvci5jYWxsKGluc3RhbmNlKTtcblxuICAgICAgLy8gSWYgdGhhdCBzdWNjZWVkZWQsIHdlJ3JlIGluIGEgdHJhbnNwaWxlZCBlbnZpcm9ubWVudFxuICAgICAgLy8gTGV0J3MgZmluZCBvdXQgaWYgd2UgY2FuIHdyYXAgSFRNTEVsZW1lbnQgYW5kIGF2b2lkIGEgZnVsbCBwYXRjaC5cbiAgICAgIGluc3RhbGxXcmFwcGVyID0gISEoUmVmbGVjdCAmJiBSZWZsZWN0LmNvbnN0cnVjdCk7XG4gICAgfSBjYXRjaCAoZSkge1xuXG4gICAgICAvLyBUaGUgY3RvciB0aHJldyB3aGVuIHdlIGNvbnN0cnVjdGVkIGlzIHZpYSBFUzUsIHNvIGl0J3MgYSByZWFsIGNsYXNzLlxuICAgICAgLy8gV2UncmUgb2sgdG8gbm90IGluc3RhbGwgdGhlIHBvbHlmaWxsLlxuICAgICAgaW5zdGFsbCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGlmIChpbnN0YWxsV3JhcHBlcikge1xuICAgIHdyYXBIVE1MRWxlbWVudCh3aW4pO1xuICB9IGVsc2UgaWYgKGluc3RhbGwpIHtcbiAgICBwb2x5ZmlsbCh3aW4pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBgZG9jdW1lbnQuY29udGFpbnMoKWAgbWV0aG9kLiBOb3RpY2UgdGhhdCBhY2NvcmRpbmcgdG8gc3BlY1xuICogYGRvY3VtZW50LmNvbnRhaW5zYCBpcyBpbmNsdXNpb25hcnkuXG4gKiBTZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL05vZGUvY29udGFpbnNcbiAqIEBwYXJhbSB7P05vZGV9IG5vZGVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAdGhpcyB7Tm9kZX1cbiAqL1xuZnVuY3Rpb24gZG9jdW1lbnRDb250YWluc1BvbHlmaWxsKG5vZGUpIHtcbiAgLy8gUGVyIHNwZWMsIFwiY29udGFpbnNcIiBtZXRob2QgaXMgaW5jbHVzaW9uYXJ5XG4gIC8vIGkuZS4gYG5vZGUuY29udGFpbnMobm9kZSkgPT0gdHJ1ZWAuIEhvd2V2ZXIsIHdlIHN0aWxsIG5lZWQgdG8gdGVzdFxuICAvLyBlcXVhbGl0eSB0byB0aGUgZG9jdW1lbnQgaXRzZWxmLlxuICByZXR1cm4gbm9kZSA9PSB0aGlzIHx8IHRoaXMuZG9jdW1lbnRFbGVtZW50LmNvbnRhaW5zKG5vZGUpO1xufVxuXG5cbi8qKlxuICogUG9seWZpbGxzIGBIVE1MRG9jdW1lbnQuY29udGFpbnNgIEFQSS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnN0YWxsKHdpbikge1xuICAvLyBIVE1MRG9jdW1lbnQgaXMgdW5kZWZpbmVkIGluIEludGVybmV0IEV4cGxvcmVyIDEwLCBidXQgaXQgaGFzIERvY3VtZW50LFxuICAvLyBzbyB3ZSB1c2UgdGhhdCBhcyBhIGZhbGxiYWNrLlxuICBjb25zdCBkb2N1bWVudENsYXNzID0gd2luLkhUTUxEb2N1bWVudCB8fCB3aW4uRG9jdW1lbnQ7XG4gIGlmICghZG9jdW1lbnRDbGFzcy5wcm90b3R5cGUuY29udGFpbnMpIHtcbiAgICB3aW4uT2JqZWN0LmRlZmluZVByb3BlcnR5KGRvY3VtZW50Q2xhc3MucHJvdG90eXBlLCAnY29udGFpbnMnLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IGRvY3VtZW50Q29udGFpbnNQb2x5ZmlsbCxcbiAgICB9KTtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuLyoqXG4gKiBQb2x5ZmlsbCBmb3IgYERPTVRva2VuTGlzdC5wcm90b3R5cGUudG9nZ2xlKHRva2VuLCBvcHRfZm9yY2UpYCBtZXRob2QuIFRoaXNcbiAqIGlzIHNwZWNpYWxseSBpbXBvcnRhbnQgYmVjYXVzZSBJRSBkb2VzIG5vdCBzdXBwb3J0IGBvcHRfZm9yY2VgIGF0dHJpYnV0ZS4gU2VlXG4gKiBodHRwczovL2dvby5nbC9oZ0tOWVkgZm9yIGRldGFpbHMuXG4gKiBAcGFyYW0ge3N0cmluZ30gdG9rZW5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9mb3JjZVxuICogQHRoaXMge0RPTVRva2VuTGlzdH1cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGRvbVRva2VuTGlzdFRvZ2dsZVBvbHlmaWxsKHRva2VuLCBvcHRfZm9yY2UpIHtcbiAgY29uc3QgcmVtb3ZlID0gb3B0X2ZvcmNlID09PSB1bmRlZmluZWQgPyB0aGlzLmNvbnRhaW5zKHRva2VuKSA6ICFvcHRfZm9yY2U7XG4gIGlmIChyZW1vdmUpIHtcbiAgICB0aGlzLnJlbW92ZSh0b2tlbik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuYWRkKHRva2VuKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufVxuXG5cbi8qKlxuICogUG9seWZpbGxzIGBET01Ub2tlbkxpc3QucHJvdG90eXBlLnRvZ2dsZWAgQVBJIGluIElFLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIGlmIChpc0llKHdpbikgJiYgd2luLkRPTVRva2VuTGlzdCkge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkod2luLkRPTVRva2VuTGlzdC5wcm90b3R5cGUsICd0b2dnbGUnLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IGRvbVRva2VuTGlzdFRvZ2dsZVBvbHlmaWxsLFxuICAgIH0pO1xuICB9XG59XG5cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBjdXJyZW50IGJyb3dzZXIgaXMgYSBJRSBicm93c2VyLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzSWUod2luKSB7XG4gIHJldHVybiAvVHJpZGVudHxNU0lFfElFTW9iaWxlL2kudGVzdCh3aW4ubmF2aWdhdG9yLnVzZXJBZ2VudCk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBQYXJzZXMgdGhlIG51bWJlciB4IGFuZCByZXR1cm5zIGl0cyBzaWduLiBGb3IgcG9zaXRpdmUgeCByZXR1cm5zIDEsIGZvclxuICogbmVnYXRpdmUsIC0xLiBGb3IgMCBhbmQgLTAsIHJldHVybnMgMCBhbmQgLTAgcmVzcGVjdGl2ZWx5LiBGb3IgYW55IG51bWJlclxuICogdGhhdCBwYXJzZXMgdG8gTmFOLCByZXR1cm5zIE5hTi5cbiAqXG4gKiBAcGFyYW0ge251bWJlcn0geFxuICogQHJldHVybiB7bnVtYmVyfVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2lnbih4KSB7XG4gIHggPSBOdW1iZXIoeCk7XG5cbiAgLy8gSWYgeCBpcyAwLCAtMCwgb3IgTmFOLCByZXR1cm4gaXQuXG4gIGlmICgheCkge1xuICAgIHJldHVybiB4O1xuICB9XG5cbiAgcmV0dXJuIHggPiAwID8gMSA6IC0xO1xufVxuXG5cbi8qKlxuICogU2V0cyB0aGUgTWF0aC5zaWduIHBvbHlmaWxsIGlmIGl0IGRvZXMgbm90IGV4aXN0LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIGlmICghd2luLk1hdGguc2lnbikge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkod2luLk1hdGgsICdzaWduJywge1xuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgIHZhbHVlOiBzaWduLFxuICAgIH0pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuY29uc3Qge2hhc093blByb3BlcnR5fSA9IE9iamVjdC5wcm90b3R5cGU7XG5cbi8qKlxuICogQ29waWVzIHZhbHVlcyBvZiBhbGwgZW51bWVyYWJsZSBvd24gcHJvcGVydGllcyBmcm9tIG9uZSBvciBtb3JlIHNvdXJjZVxuICogb2JqZWN0cyAocHJvdmlkZWQgYXMgZXh0ZW5kZWQgYXJndW1lbnRzIHRvIHRoZSBmdW5jdGlvbikgdG8gYSB0YXJnZXQgb2JqZWN0LlxuICpcbiAqIEBwYXJhbSB7IU9iamVjdH0gdGFyZ2V0XG4gKiBAcGFyYW0gey4uLk9iamVjdH0gdmFyX2FyZ3NcbiAqIEByZXR1cm4geyFPYmplY3R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0LCB2YXJfYXJncykge1xuICBpZiAodGFyZ2V0ID09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29udmVydCB1bmRlZmluZWQgb3IgbnVsbCB0byBvYmplY3QnKTtcbiAgfVxuXG4gIGNvbnN0IG91dHB1dCA9IE9iamVjdCh0YXJnZXQpO1xuICBmb3IgKGxldCBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcbiAgICBpZiAoc291cmNlICE9IG51bGwpIHtcbiAgICAgIGZvciAoY29uc3Qga2V5IGluIHNvdXJjZSkge1xuICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHtcbiAgICAgICAgICBvdXRwdXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBvdXRwdXQ7XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBPYmplY3QuYXNzaWduIHBvbHlmaWxsIGlmIGl0IGRvZXMgbm90IGV4aXN0LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIGlmICghd2luLk9iamVjdC5hc3NpZ24pIHtcbiAgICB3aW4uT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbi5PYmplY3QsICdhc3NpZ24nLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IGFzc2lnbixcbiAgICB9KTtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuaW1wb3J0ICogYXMgUHJvbWlzZSBmcm9tICdwcm9taXNlLXBqcy9wcm9taXNlJztcblxuLyoqXG4gKiBTZXRzIHRoZSBQcm9taXNlIHBvbHlmaWxsIGlmIGl0IGRvZXMgbm90IGV4aXN0LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIGlmICghd2luLlByb21pc2UpIHtcbiAgICB3aW4uUHJvbWlzZSA9IC8qKiBAdHlwZSB7P30gKi8gKFByb21pc2UpO1xuICAgIC8vIEluIGJhYmVsIHRoZSAqIGV4cG9ydCBpcyBhbiBPYmplY3Qgd2l0aCBhIGRlZmF1bHQgcHJvcGVydHkuXG4gICAgLy8gSW4gY2xvc3VyZSBjb21waWxlciBpdCBpcyB0aGUgUHJvbWlzZSBmdW5jdGlvbiBpdHNlbGYuXG4gICAgaWYgKFByb21pc2UuZGVmYXVsdCkge1xuICAgICAgd2luLlByb21pc2UgPSBQcm9taXNlLmRlZmF1bHQ7XG4gICAgfVxuICAgIC8vIFdlIGNvcHkgdGhlIGluZGl2aWR1YWwgc3RhdGljIG1ldGhvZHMsIGJlY2F1c2UgY2xvc3VyZVxuICAgIC8vIGNvbXBpbGVyIGZsYXR0ZW5zIHRoZSBwb2x5ZmlsbCBuYW1lc3BhY2UuXG4gICAgd2luLlByb21pc2UucmVzb2x2ZSA9IFByb21pc2UucmVzb2x2ZTtcbiAgICB3aW4uUHJvbWlzZS5yZWplY3QgPSBQcm9taXNlLnJlamVjdDtcbiAgICB3aW4uUHJvbWlzZS5hbGwgPSBQcm9taXNlLmFsbDtcbiAgICB3aW4uUHJvbWlzZS5yYWNlID0gUHJvbWlzZS5yYWNlO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi9zZXJ2aWNlcyc7XG5pbXBvcnQge2Rldn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtnZXRTZXJ2aWNlUHJvbWlzZX0gZnJvbSAnLi9zZXJ2aWNlJztcblxuLyoqXG4gKiBBIG1hcCBvZiBzZXJ2aWNlcyB0aGF0IGRlbGF5IHJlbmRlcmluZy4gVGhlIGtleSBpcyB0aGUgbmFtZSBvZiB0aGUgc2VydmljZVxuICogYW5kIHRoZSB2YWx1ZSBpcyBhIERPTSBxdWVyeSB3aGljaCBpcyB1c2VkIHRvIGNoZWNrIGlmIHRoZSBzZXJ2aWNlIGlzIG5lZWRlZFxuICogaW4gdGhlIGN1cnJlbnQgZG9jdW1lbnQuXG4gKiBEbyBub3QgYWRkIGEgc2VydmljZSB1bmxlc3MgYWJzb2x1dGVseSBuZWNlc3NhcnkuXG4gKlxuICogXFwgICBcXCAgLyAgXFwgIC8gICAvIC8gICBcXCAgICAgfCAgIF8gIFxcICAgICB8ICBcXCB8ICB8IHwgIHwgfCAgXFwgfCAgfCAgLyBfX19fX3xcbiAqICBcXCAgIFxcLyAgICBcXC8gICAvIC8gIF4gIFxcICAgIHwgIHxfKSAgfCAgICB8ICAgXFx8ICB8IHwgIHwgfCAgIFxcfCAgfCB8ICB8ICBfX1xuICogICBcXCAgICAgICAgICAgIC8gLyAgL19cXCAgXFwgICB8ICAgICAgLyAgICAgfCAgLiBgICB8IHwgIHwgfCAgLiBgICB8IHwgIHwgfF8gfFxuICogICAgXFwgICAgL1xcICAgIC8gLyAgX19fX18gIFxcICB8ICB8XFwgIFxcLS0tLS58ICB8XFwgICB8IHwgIHwgfCAgfFxcICAgfCB8ICB8X198IHxcbiAqICAgICBcXF9fLyAgXFxfXy8gL19fLyAgICAgXFxfX1xcIHwgX3wgYC5fX19fX3x8X198IFxcX198IHxfX3wgfF9ffCBcXF9ffCAgXFxfX19fX198XG4gKlxuICogVGhlIGVxdWl2YWxlbnQgb2YgdGhpcyBsaXN0IGlzIHVzZWQgZm9yIHNlcnZlci1zaWRlIHJlbmRlcmluZyAoU1NSKSBhbmQgYW55XG4gKiBjaGFuZ2VzIG1hZGUgdG8gaXQgbXVzdCBiZSBtYWRlIGluIGNvb3JkaW5hdGlvbiB3aXRoIGNhY2hlcyB0aGF0IGltcGxlbWVudFxuICogU1NSLiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBvbiBTU1Igc2VlIGJpdC5seS9hbXAtc3NyLlxuICpcbiAqIEBjb25zdCB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59XG4gKi9cbmNvbnN0IFNFUlZJQ0VTID0ge1xuICAnYW1wLWR5bmFtaWMtY3NzLWNsYXNzZXMnOiAnW2N1c3RvbS1lbGVtZW50PWFtcC1keW5hbWljLWNzcy1jbGFzc2VzXScsXG4gICd2YXJpYW50JzogJ2FtcC1leHBlcmltZW50JyxcbiAgJ2FtcC1zdG9yeSc6ICdhbXAtc3Rvcnlbc3RhbmRhbG9uZV0nLFxufTtcblxuLyoqXG4gKiBNYXhpbXVtIG1pbGxpc2Vjb25kcyB0byB3YWl0IGZvciBhbGwgZXh0ZW5zaW9ucyB0byBsb2FkIGJlZm9yZSBlcnJvcmluZy5cbiAqIEBjb25zdFxuICovXG5jb25zdCBMT0FEX1RJTUVPVVQgPSAzMDAwO1xuXG4vKipcbiAqIERldGVjdHMgYW55IHJlbmRlciBkZWxheWluZyBzZXJ2aWNlcyB0aGF0IGFyZSByZXF1aXJlZCBvbiB0aGUgcGFnZSwgYW5kXG4gKiByZXR1cm5zIGEgcHJvbWlzZSB3aXRoIGEgdGltZW91dC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhQXJyYXk8Kj4+fSByZXNvbHZlcyB0byBhbiBBcnJheSB0aGF0IGhhcyB0aGUgc2FtZSBsZW5ndGhcbiAqICAgICBhcyB0aGUgZGV0ZWN0ZWQgcmVuZGVyIGRlbGF5aW5nIHNlcnZpY2VzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3YWl0Rm9yU2VydmljZXMod2luKSB7XG4gIGNvbnN0IHByb21pc2VzID0gaW5jbHVkZWRTZXJ2aWNlcyh3aW4pLm1hcChzZXJ2aWNlID0+IHtcbiAgICByZXR1cm4gU2VydmljZXMudGltZXJGb3Iod2luKS50aW1lb3V0UHJvbWlzZShcbiAgICAgICAgTE9BRF9USU1FT1VULFxuICAgICAgICBnZXRTZXJ2aWNlUHJvbWlzZSh3aW4sIHNlcnZpY2UpLFxuICAgICAgICBgUmVuZGVyIHRpbWVvdXQgd2FpdGluZyBmb3Igc2VydmljZSAke3NlcnZpY2V9IHRvIGJlIHJlYWR5LmBcbiAgICApO1xuICB9KTtcbiAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIHBhZ2UgaGFzIGEgcmVuZGVyIGRlbGF5aW5nIHNlcnZpY2UuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc1JlbmRlckRlbGF5aW5nU2VydmljZXMod2luKSB7XG4gIHJldHVybiBpbmNsdWRlZFNlcnZpY2VzKHdpbikubGVuZ3RoID4gMDtcbn1cblxuLyoqXG4gKiBEZXRlY3RzIHdoaWNoLCBpZiBhbnksIHJlbmRlci1kZWxheWluZyBleHRlbnNpb25zIGFyZSBpbmNsdWRlZCBvbiB0aGUgcGFnZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshQXJyYXk8c3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluY2x1ZGVkU2VydmljZXMod2luKSB7XG4gIC8qKiBAY29uc3QgeyFEb2N1bWVudH0gKi9cbiAgY29uc3QgZG9jID0gd2luLmRvY3VtZW50O1xuICBkZXYoKS5hc3NlcnQoZG9jLmJvZHkpO1xuXG4gIHJldHVybiBPYmplY3Qua2V5cyhTRVJWSUNFUykuZmlsdGVyKHNlcnZpY2UgPT4ge1xuICAgIHJldHVybiBkb2MucXVlcnlTZWxlY3RvcihTRVJWSUNFU1tzZXJ2aWNlXSk7XG4gIH0pO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQGZpbGVvdmVydmlldyBSZWdpc3RyYXRpb24gYW5kIGdldHRlciBmdW5jdGlvbnMgZm9yIEFNUCBzZXJ2aWNlcy5cbiAqXG4gKiBJbnZhcmlhbnQ6IFNlcnZpY2UgZ2V0dGVycyBuZXZlciByZXR1cm4gbnVsbCBmb3IgcmVnaXN0ZXJlZCBzZXJ2aWNlcy5cbiAqL1xuXG4vLyBzcmMvcG9seWZpbGxzLmpzIG11c3QgYmUgdGhlIGZpcnN0IGltcG9ydC5cbmltcG9ydCAnLi9wb2x5ZmlsbHMnOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHNvcnQtaW1wb3J0cy1lczYtYXV0b2ZpeC9zb3J0LWltcG9ydHMtZXM2XG5cbmltcG9ydCB7RGVmZXJyZWR9IGZyb20gJy4vdXRpbHMvcHJvbWlzZSc7XG5pbXBvcnQge2Rldn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHt0b1dpbn0gZnJvbSAnLi90eXBlcyc7XG5cblxuLyoqXG4gKiBIb2xkcyBpbmZvIGFib3V0IGEgc2VydmljZS5cbiAqIC0gb2JqOiBBY3R1YWwgc2VydmljZSBpbXBsZW1lbnRhdGlvbiB3aGVuIGF2YWlsYWJsZS5cbiAqIC0gcHJvbWlzZTogUHJvbWlzZSBmb3IgdGhlIG9iai5cbiAqIC0gcmVzb2x2ZTogRnVuY3Rpb24gdG8gcmVzb2x2ZSB0aGUgcHJvbWlzZSB3aXRoIHRoZSBvYmplY3QuXG4gKiAtIGNvbnRleHQ6IEFyZ3VtZW50IGZvciBjdG9yLCBlaXRoZXIgYSB3aW5kb3cgb3IgYW4gYW1wZG9jLlxuICogLSBjdG9yOiBGdW5jdGlvbiB0aGF0IGNvbnN0cnVjdHMgYW5kIHJldHVybnMgdGhlIHNlcnZpY2UuXG4gKiBAdHlwZWRlZiB7e1xuICogICBvYmo6ICg/T2JqZWN0KSxcbiAqICAgcHJvbWlzZTogKD9Qcm9taXNlKSxcbiAqICAgcmVzb2x2ZTogKD9mdW5jdGlvbighT2JqZWN0KSksXG4gKiAgIGNvbnRleHQ6ICg/V2luZG93fD8uL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jKSxcbiAqICAgY3RvcjogKD9mdW5jdGlvbihuZXc6T2JqZWN0LCAhV2luZG93KXxcbiAqICAgICAgICAgID9mdW5jdGlvbihuZXc6T2JqZWN0LCAhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvYykpLFxuICogfX1cbiAqL1xubGV0IFNlcnZpY2VIb2xkZXJEZWY7XG5cblxuLyoqXG4gKiBUaGlzIGludGVyZmFjZSBwcm92aWRlcyBhIGBkaXNwb3NlYCBtZXRob2QgdGhhdCB3aWxsIGJlIGNhbGxlZCBieVxuICogcnVudGltZSB3aGVuIGEgc2VydmljZSBuZWVkcyB0byBiZSBkaXNwb3NlZCBvZi5cbiAqIEBpbnRlcmZhY2VcbiAqL1xuZXhwb3J0IGNsYXNzIERpc3Bvc2FibGUge1xuXG4gIC8qKlxuICAgKiBJbnN0cnVjdHMgdGhlIHNlcnZpY2UgdG8gcmVsZWFzZSBhbnkgcmVzb3VyY2VzIGl0IG1pZ2h0IGJlIGhvbGRpbmcuIENhblxuICAgKiBiZSBjYWxsZWQgb25seSBvbmNlIGluIHRoZSBsaWZlY3ljbGUgb2YgYSBzZXJ2aWNlLlxuICAgKi9cbiAgZGlzcG9zZSgpIHt9XG59XG5cblxuLyoqXG4gKiBUaGlzIGludGVyZmFjZSBwcm92aWRlcyBhIGBhZG9wdEVtYmVkV2luZG93YCBtZXRob2QgdGhhdCB3aWxsIGJlIGNhbGxlZCBieVxuICogcnVudGltZSBmb3IgYSBuZXcgZW1iZWQgd2luZG93LlxuICogQGludGVyZmFjZVxuICovXG5leHBvcnQgY2xhc3MgRW1iZWRkYWJsZVNlcnZpY2Uge1xuXG4gIC8qKlxuICAgKiBJbnN0cnVjdHMgdGhlIHNlcnZpY2UgdG8gYWRvcHQgdGhlIGVtYmVkIHdpbmRvdyBhbmQgYWRkIGFueSBuZWNlc3NhcnlcbiAgICogbGlzdGVuZXJzIGFuZCByZXNvdXJjZXMuXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gdW51c2VkRW1iZWRXaW5cbiAgICovXG4gIGFkb3B0RW1iZWRXaW5kb3codW51c2VkRW1iZWRXaW4pIHt9XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VydmljZSB3aXRoIHRoZSBnaXZlbiBpZC4gQXNzdW1lcyB0aGF0IGl0IGhhcyBiZWVuIHJlZ2lzdGVyZWRcbiAqIGFscmVhZHkuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZmFsbGJhY2tUb1RvcFdpblxuICogQHJldHVybiB7T2JqZWN0fSBUaGUgc2VydmljZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4aXN0aW5nU2VydmljZUluRW1iZWRTY29wZSh3aW4sIGlkLCBvcHRfZmFsbGJhY2tUb1RvcFdpbikge1xuICAvLyBGaXJzdCwgdHJ5IHRvIHJlc29sdmUgdmlhIGxvY2FsIChlbWJlZCkgd2luZG93LlxuICBjb25zdCBsb2NhbCA9IGdldExvY2FsRXhpc3RpbmdTZXJ2aWNlRm9yRW1iZWRXaW5Pck51bGwod2luLCBpZCk7XG4gIGlmIChsb2NhbCkge1xuICAgIHJldHVybiBsb2NhbDtcbiAgfVxuICBpZiAob3B0X2ZhbGxiYWNrVG9Ub3BXaW4pIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZSh3aW4sIGlkKTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VydmljZSB3aXRoIHRoZSBnaXZlbiBpZC4gQXNzdW1lcyB0aGF0IGl0IGhhcyBiZWVuIGNvbnN0cnVjdGVkXG4gKiBhbHJlYWR5LlxuICpcbiAqIFVubGlrZSBtb3N0IHNlcnZpY2UgZ2V0dGVycywgcGFzc2luZyBgTm9kZWAgaXMgbmVjZXNzYXJ5IGZvciBzb21lIEZJRS1zY29wZVxuICogc2VydmljZXMgc2luY2Ugc29tZXRpbWVzIHdlIG9ubHkgaGF2ZSB0aGUgRklFIERvY3VtZW50IGZvciBjb250ZXh0LlxuICpcbiAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZmFsbGJhY2tUb1RvcFdpblxuICogQHJldHVybiB7T2JqZWN0fSBUaGUgc2VydmljZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4aXN0aW5nU2VydmljZUZvckRvY0luRW1iZWRTY29wZShcbiAgbm9kZU9yRG9jLCBpZCwgb3B0X2ZhbGxiYWNrVG9Ub3BXaW4pIHtcbiAgLy8gRmlyc3QsIHRyeSB0byByZXNvbHZlIHZpYSBsb2NhbCAoZW1iZWQpIHdpbmRvdy5cbiAgaWYgKG5vZGVPckRvYy5ub2RlVHlwZSkge1xuICAgIC8vIElmIGEgbm9kZSBpcyBwYXNzZWQsIHRyeSB0byByZXNvbHZlIHZpYSB0aGlzIG5vZGUuXG4gICAgY29uc3Qgd2luID0gdG9XaW4oLyoqIEB0eXBlIHshRG9jdW1lbnR9ICovIChcbiAgICAgIG5vZGVPckRvYy5vd25lckRvY3VtZW50IHx8IG5vZGVPckRvYykuZGVmYXVsdFZpZXcpO1xuICAgIGNvbnN0IGxvY2FsID0gZ2V0TG9jYWxFeGlzdGluZ1NlcnZpY2VGb3JFbWJlZFdpbk9yTnVsbCh3aW4sIGlkKTtcbiAgICBpZiAobG9jYWwpIHtcbiAgICAgIHJldHVybiBsb2NhbDtcbiAgICB9XG4gIH1cbiAgLy8gSWYgYW4gYW1wZG9jIGlzIHBhc3NlZCBvciBmYWxsYmFjayBpcyBhbGxvd2VkLCBjb250aW51ZSByZXNvbHZpbmcuXG4gIGlmICghbm9kZU9yRG9jLm5vZGVUeXBlIHx8IG9wdF9mYWxsYmFja1RvVG9wV2luKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKG5vZGVPckRvYywgaWQpO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIEluc3RhbGxzIGEgc2VydmljZSBvdmVycmlkZSBvbiBhbXAtZG9jIGxldmVsLlxuICogQHBhcmFtIHshV2luZG93fSBlbWJlZFdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcGFyYW0geyFPYmplY3R9IHNlcnZpY2UgVGhlIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnN0YWxsU2VydmljZUluRW1iZWRTY29wZShlbWJlZFdpbiwgaWQsIHNlcnZpY2UpIHtcbiAgY29uc3QgdG9wV2luID0gZ2V0VG9wV2luZG93KGVtYmVkV2luKTtcbiAgZGV2KCkuYXNzZXJ0KGVtYmVkV2luICE9IHRvcFdpbixcbiAgICAgICdTZXJ2aWNlIG92ZXJyaWRlIGNhbiBvbmx5IGJlIGluc3RhbGxlZCBpbiBlbWJlZCB3aW5kb3c6ICVzJywgaWQpO1xuICBkZXYoKS5hc3NlcnQoIWdldExvY2FsRXhpc3RpbmdTZXJ2aWNlRm9yRW1iZWRXaW5Pck51bGwoZW1iZWRXaW4sIGlkKSxcbiAgICAgICdTZXJ2aWNlIG92ZXJyaWRlIGhhcyBhbHJlYWR5IGJlZW4gaW5zdGFsbGVkOiAlcycsIGlkKTtcbiAgcmVnaXN0ZXJTZXJ2aWNlSW50ZXJuYWwoZW1iZWRXaW4sIGVtYmVkV2luLCBpZCwgKCkgPT4gc2VydmljZSk7XG4gIGdldFNlcnZpY2VJbnRlcm5hbChlbWJlZFdpbiwgaWQpOyAvLyBGb3JjZSBzZXJ2aWNlIHRvIGJ1aWxkLlxufVxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gZW1iZWRXaW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybiB7P09iamVjdH1cbiAqL1xuZnVuY3Rpb24gZ2V0TG9jYWxFeGlzdGluZ1NlcnZpY2VGb3JFbWJlZFdpbk9yTnVsbChlbWJlZFdpbiwgaWQpIHtcbiAgLy8gTm90ZSB0aGF0IHRoaXMgbWV0aG9kIGN1cnJlbnRseSBvbmx5IHJlc29sdmVzIGFnYWluc3QgdGhlIGdpdmVuIHdpbmRvdy5cbiAgLy8gSXQgZG9lcyBub3QgdHJ5IHRvIGdvIGFsbCB0aGUgd2F5IHVwIHRoZSBwYXJlbnQgd2luZG93IGNoYWluLiBXZSBjYW4gY2hhbmdlXG4gIC8vIHRoaXMgaW4gdGhlIGZ1dHVyZSwgYnV0IGZvciBub3cgdGhpcyBnaXZlcyB1cyBhIGJldHRlciBwZXJmb3JtYW5jZS5cbiAgY29uc3QgdG9wV2luID0gZ2V0VG9wV2luZG93KGVtYmVkV2luKTtcbiAgaWYgKGVtYmVkV2luICE9IHRvcFdpbiAmJiBpc1NlcnZpY2VSZWdpc3RlcmVkKGVtYmVkV2luLCBpZCkpIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZUludGVybmFsKGVtYmVkV2luLCBpZCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLyoqXG4gKiBSZWdpc3RlcnMgYSBzZXJ2aWNlIGdpdmVuIGEgY2xhc3MgdG8gYmUgdXNlZCBhcyBpbXBsZW1lbnRhdGlvbi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKG5ldzpPYmplY3QsICFXaW5kb3cpfSBjb25zdHJ1Y3RvclxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2luc3RhbnRpYXRlIFdoZXRoZXIgdG8gaW1tZWRpYXRlbHkgY3JlYXRlIHRoZSBzZXJ2aWNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlclNlcnZpY2VCdWlsZGVyKHdpbixcbiAgaWQsXG4gIGNvbnN0cnVjdG9yLFxuICBvcHRfaW5zdGFudGlhdGUpIHtcbiAgd2luID0gZ2V0VG9wV2luZG93KHdpbik7XG4gIHJlZ2lzdGVyU2VydmljZUludGVybmFsKHdpbiwgd2luLCBpZCwgY29uc3RydWN0b3IpO1xuICBpZiAob3B0X2luc3RhbnRpYXRlKSB7XG4gICAgZ2V0U2VydmljZUludGVybmFsKHdpbiwgaWQpO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VydmljZSBhbmQgcmVnaXN0ZXJzIGl0IGdpdmVuIGEgY2xhc3MgdG8gYmUgdXNlZCBhc1xuICogaW1wbGVtZW50YXRpb24uXG4gKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24obmV3Ok9iamVjdCwgIS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2MpfSBjb25zdHJ1Y3RvclxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2luc3RhbnRpYXRlIFdoZXRoZXIgdG8gaW1tZWRpYXRlbHkgY3JlYXRlIHRoZSBzZXJ2aWNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlclNlcnZpY2VCdWlsZGVyRm9yRG9jKG5vZGVPckRvYyxcbiAgaWQsXG4gIGNvbnN0cnVjdG9yLFxuICBvcHRfaW5zdGFudGlhdGUpIHtcbiAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKG5vZGVPckRvYyk7XG4gIGNvbnN0IGhvbGRlciA9IGdldEFtcGRvY1NlcnZpY2VIb2xkZXIoYW1wZG9jKTtcbiAgcmVnaXN0ZXJTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBhbXBkb2MsIGlkLCBjb25zdHJ1Y3Rvcik7XG4gIGlmIChvcHRfaW5zdGFudGlhdGUpIHtcbiAgICBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIHdpbmRvdyAoYSBwZXItd2luZG93IHNpbmdsZXRvbikuIFVzZXJzXG4gKiBzaG91bGQgdHlwaWNhbGx5IHdyYXAgdGhpcyBhcyBhIHNwZWNpYWwgcHVycG9zZSBmdW5jdGlvbiAoZS5nLlxuICogYFNlcnZpY2VzLnZzeW5jRm9yKHdpbilgKSBmb3IgdHlwZSBzYWZldHkgYW5kIGJlY2F1c2UgdGhlIGZhY3Rvcnkgc2hvdWxkIG5vdFxuICogYmUgcGFzc2VkIGFyb3VuZC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAdGVtcGxhdGUgVFxuICogQHJldHVybiB7VH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNlcnZpY2Uod2luLCBpZCkge1xuICB3aW4gPSBnZXRUb3BXaW5kb3cod2luKTtcbiAgcmV0dXJuIGdldFNlcnZpY2VJbnRlcm5hbCh3aW4sIGlkKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIGZvciBhIHNlcnZpY2UgZm9yIHRoZSBnaXZlbiBpZCBhbmQgd2luZG93LiBBbHNvIGV4cGVjdHMgYW5cbiAqIGVsZW1lbnQgdGhhdCBoYXMgdGhlIGFjdHVhbCBpbXBsZW1lbnRhdGlvbi4gVGhlIHByb21pc2UgcmVzb2x2ZXMgd2hlbiB0aGVcbiAqIGltcGxlbWVudGF0aW9uIGxvYWRlZC4gVXNlcnMgc2hvdWxkIHR5cGljYWxseSB3cmFwIHRoaXMgYXMgYSBzcGVjaWFsIHB1cnBvc2VcbiAqIGZ1bmN0aW9uIChlLmcuIGBTZXJ2aWNlcy52c3luY0Zvcih3aW4pYCkgZm9yIHR5cGUgc2FmZXR5IGFuZCBiZWNhdXNlIHRoZVxuICogZmFjdG9yeSBzaG91bGQgbm90IGJlIHBhc3NlZCBhcm91bmQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHJldHVybiB7IVByb21pc2U8IU9iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlUHJvbWlzZSh3aW4sIGlkKSB7XG4gIHJldHVybiBnZXRTZXJ2aWNlUHJvbWlzZUludGVybmFsKHdpbiwgaWQpO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2Ugb3IgbnVsbCB3aXRoIHRoZSBnaXZlbiBpZC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4gez9PYmplY3R9IFRoZSBzZXJ2aWNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXhpc3RpbmdTZXJ2aWNlT3JOdWxsKHdpbiwgaWQpIHtcbiAgd2luID0gZ2V0VG9wV2luZG93KHdpbik7XG4gIGlmIChpc1NlcnZpY2VSZWdpc3RlcmVkKHdpbiwgaWQpKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2VJbnRlcm5hbCh3aW4sIGlkKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5cbi8qKlxuICogTGlrZSBnZXRTZXJ2aWNlUHJvbWlzZSBidXQgcmV0dXJucyBudWxsIGlmIHRoZSBzZXJ2aWNlIHdhcyBuZXZlciByZWdpc3RlcmVkLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybiB7P1Byb21pc2U8IU9iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkKSB7XG4gIHJldHVybiBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEludGVybmFsKHdpbiwgaWQpO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2UgZm9yIHRoZSBnaXZlbiBpZCBhbmQgYW1wZG9jIChhIHBlci1hbXBkb2Mgc2luZ2xldG9uKS5cbiAqIEV4cGVjdHMgc2VydmljZSBgaWRgIHRvIGJlIHJlZ2lzdGVyZWQuXG4gKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybiB7VH1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpIHtcbiAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKGVsZW1lbnRPckFtcERvYyk7XG4gIGNvbnN0IGhvbGRlciA9IGdldEFtcGRvY1NlcnZpY2VIb2xkZXIoYW1wZG9jKTtcbiAgcmV0dXJuIGdldFNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGlkKTtcbn1cblxuXG4vKipcbiAqIHRsO2RyIC0tIFVzZSBnZXRTZXJ2aWNlRm9yRG9jKCkgaW5zdGVhZCBvZiB0aGlzLlxuICpcbiAqIFByaXZpbGVnZWQgdmFyaWFudCBvZiBnZXRTZXJ2aWNlRm9yRG9jKCkgdGhhdCBhY2NlcHRzIG5vbi1lbGVtZW50IHBhcmFtcyxcbiAqIGUuZy4gd2luZG93LmRvY3VtZW50LiBUaGlzIGlzIGN1cnJlbnRseSBuZWNlc3NhcnkgZm9yIGRvYy1sZXZlbCBzZXJ2aWNlc1xuICogdXNlZCBpbiBzdGFydHVwLCBlLmcuIENodW5rcy4gRXZlbnR1YWxseSB3ZSB3YW50IHRvIHJlbW92ZSB0aGlzIGZ1bmN0aW9uXG4gKiBhbmQgaGF2ZSBjYWxsZXJzIGZpbmQgdGhlIGFwcHJvcHJpYXRlIEFtcERvYyBhbmQgdXNlIGdldFNlcnZpY2VGb3JEb2MoKS5cbiAqXG4gKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybiB7VH1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZChub2RlT3JEb2MsIGlkKSB7XG4gIGNvbnN0IGFtcGRvYyA9IGdldEFtcGRvYyhub2RlT3JEb2MpO1xuICBjb25zdCBob2xkZXIgPSBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGFtcGRvYyk7XG4gIHJldHVybiBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCk7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIGFtcGRvYy4gQWxzbyBleHBlY3RzXG4gKiBhIHNlcnZpY2UgdGhhdCBoYXMgdGhlIGFjdHVhbCBpbXBsZW1lbnRhdGlvbi4gVGhlIHByb21pc2UgcmVzb2x2ZXMgd2hlblxuICogdGhlIGltcGxlbWVudGF0aW9uIGxvYWRlZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhT2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpIHtcbiAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlSW50ZXJuYWwoXG4gICAgICBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGVsZW1lbnRPckFtcERvYyksIGlkKTtcbn1cblxuXG4vKipcbiAqIExpa2UgZ2V0U2VydmljZVByb21pc2VGb3JEb2MgYnV0IHJldHVybnMgbnVsbCBpZiB0aGUgc2VydmljZSB3YXMgbmV2ZXJcbiAqIHJlZ2lzdGVyZWQgZm9yIHRoaXMgYW1wZG9jLlxuICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4gez9Qcm9taXNlPCFPYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2VPck51bGxGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCkge1xuICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VPck51bGxJbnRlcm5hbChcbiAgICAgIGdldEFtcGRvY1NlcnZpY2VIb2xkZXIoZWxlbWVudE9yQW1wRG9jKSwgaWQpO1xufVxuXG4vKipcbiAqIFNldCB0aGUgcGFyZW50IGFuZCB0b3Agd2luZG93cyBvbiBhIGNoaWxkIHdpbmRvdyAoZnJpZW5kbHkgaWZyYW1lKS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFXaW5kb3d9IHBhcmVudFdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0UGFyZW50V2luZG93KHdpbiwgcGFyZW50V2luKSB7XG4gIHdpbi5fX0FNUF9QQVJFTlQgPSBwYXJlbnRXaW47XG4gIHdpbi5fX0FNUF9UT1AgPSBnZXRUb3BXaW5kb3cocGFyZW50V2luKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIHBhcmVudCB3aW5kb3cgZm9yIGEgY2hpbGQgd2luZG93IChmcmllbmRseSBpZnJhbWUpLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFXaW5kb3d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYXJlbnRXaW5kb3cod2luKSB7XG4gIHJldHVybiB3aW4uX19BTVBfUEFSRU5UIHx8IHdpbjtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIHRvcCB3aW5kb3cgd2hlcmUgQU1QIFJ1bnRpbWUgaXMgaW5zdGFsbGVkIGZvciBhIGNoaWxkIHdpbmRvd1xuICogKGZyaWVuZGx5IGlmcmFtZSkuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IVdpbmRvd31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRvcFdpbmRvdyh3aW4pIHtcbiAgcmV0dXJuIHdpbi5fX0FNUF9UT1AgfHwgd2luO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyB0aGUgcGFyZW50IFwiZnJpZW5kbHlcIiBpZnJhbWUgaWYgdGhlIG5vZGUgYmVsb25ncyB0byBhIGNoaWxkIHdpbmRvdy5cbiAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAqIEBwYXJhbSB7IVdpbmRvd30gdG9wV2luXG4gKiBAcmV0dXJuIHs/SFRNTElGcmFtZUVsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYXJlbnRXaW5kb3dGcmFtZUVsZW1lbnQobm9kZSwgdG9wV2luKSB7XG4gIGNvbnN0IGNoaWxkV2luID0gKG5vZGUub3duZXJEb2N1bWVudCB8fCBub2RlKS5kZWZhdWx0VmlldztcbiAgaWYgKGNoaWxkV2luICYmIGNoaWxkV2luICE9IHRvcFdpbiAmJiBnZXRUb3BXaW5kb3coY2hpbGRXaW4pID09IHRvcFdpbikge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gLyoqIEB0eXBlIHs/SFRNTElGcmFtZUVsZW1lbnR9ICovIChjaGlsZFdpbi5mcmFtZUVsZW1lbnQpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIElnbm9yZSB0aGUgZXJyb3IuXG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFtcGRvYyhub2RlT3JEb2MpIHtcbiAgaWYgKG5vZGVPckRvYy5ub2RlVHlwZSkge1xuICAgIGNvbnN0IHdpbiA9IHRvV2luKC8qKiBAdHlwZSB7IURvY3VtZW50fSAqLyAoXG4gICAgICBub2RlT3JEb2Mub3duZXJEb2N1bWVudCB8fCBub2RlT3JEb2MpLmRlZmF1bHRWaWV3KTtcbiAgICByZXR1cm4gZ2V0QW1wZG9jU2VydmljZSh3aW4pLmdldEFtcERvYygvKiogQHR5cGUgeyFOb2RlfSAqLyAobm9kZU9yRG9jKSk7XG4gIH1cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9ICovIChub2RlT3JEb2MpO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY3whV2luZG93fVxuICovXG5mdW5jdGlvbiBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKG5vZGVPckRvYykge1xuICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2Mobm9kZU9yRG9jKTtcbiAgcmV0dXJuIGFtcGRvYy5pc1NpbmdsZURvYygpID8gYW1wZG9jLndpbiA6IGFtcGRvYztcbn1cblxuXG4vKipcbiAqIFRoaXMgaXMgZXNzZW50aWFsbHkgYSBkdXBsaWNhdGUgb2YgYGFtcGRvYy5qc2AsIGJ1dCBuZWNlc3NhcnkgdG8gYXZvaWRcbiAqIGNpcmN1bGFyIGRlcGVuZGVuY2llcy5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY1NlcnZpY2V9XG4gKi9cbmZ1bmN0aW9uIGdldEFtcGRvY1NlcnZpY2Uod2luKSB7XG4gIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jU2VydmljZX0gKi8gKFxuICAgIGdldFNlcnZpY2Uod2luLCAnYW1wZG9jJykpO1xufVxuXG5cbi8qKlxuICogR2V0IHNlcnZpY2UgYGlkYCBmcm9tIGBob2xkZXJgLiBBc3N1bWVzIHRoZSBzZXJ2aWNlXG4gKiBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQuXG4gKiBAcGFyYW0geyFPYmplY3R9IGhvbGRlciBPYmplY3QgaG9sZGluZyB0aGUgc2VydmljZSBpbnN0YW5jZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEByZXR1cm4ge09iamVjdH1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmZ1bmN0aW9uIGdldFNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGlkKSB7XG4gIGRldigpLmFzc2VydChpc1NlcnZpY2VSZWdpc3RlcmVkKGhvbGRlciwgaWQpLFxuICAgICAgYEV4cGVjdGVkIHNlcnZpY2UgJHtpZH0gdG8gYmUgcmVnaXN0ZXJlZGApO1xuICBjb25zdCBzZXJ2aWNlcyA9IGdldFNlcnZpY2VzKGhvbGRlcik7XG4gIGNvbnN0IHMgPSBzZXJ2aWNlc1tpZF07XG4gIGlmICghcy5vYmopIHtcbiAgICBkZXYoKS5hc3NlcnQocy5jdG9yLCBgU2VydmljZSAke2lkfSByZWdpc3RlcmVkIHdpdGhvdXQgY3RvciBub3IgaW1wbC5gKTtcbiAgICBkZXYoKS5hc3NlcnQocy5jb250ZXh0LCBgU2VydmljZSAke2lkfSByZWdpc3RlcmVkIHdpdGhvdXQgY29udGV4dC5gKTtcbiAgICBzLm9iaiA9IG5ldyBzLmN0b3Iocy5jb250ZXh0KTtcbiAgICBkZXYoKS5hc3NlcnQocy5vYmosIGBTZXJ2aWNlICR7aWR9IGNvbnN0cnVjdGVkIHRvIG51bGwuYCk7XG4gICAgcy5jdG9yID0gbnVsbDtcbiAgICBzLmNvbnRleHQgPSBudWxsO1xuICAgIC8vIFRoZSBzZXJ2aWNlIG1heSBoYXZlIGJlZW4gcmVxdWVzdGVkIGFscmVhZHksIGluIHdoaWNoIGNhc2Ugd2UgaGF2ZSBhXG4gICAgLy8gcGVuZGluZyBwcm9taXNlIHdlIG5lZWQgdG8gZnVsZmlsbC5cbiAgICBpZiAocy5yZXNvbHZlKSB7XG4gICAgICBzLnJlc29sdmUocy5vYmopO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcy5vYmo7XG59XG5cbi8qKlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXIgT2JqZWN0IGhvbGRpbmcgdGhlIHNlcnZpY2UgaW5zdGFuY2UuXG4gKiBAcGFyYW0geyFXaW5kb3d8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGNvbnRleHQgV2luIG9yIEFtcERvYy5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7P2Z1bmN0aW9uKG5ldzpPYmplY3QsICFXaW5kb3cpfD9mdW5jdGlvbihuZXc6T2JqZWN0LCAhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvYyl9IGN0b3IgQ29uc3RydWN0b3IgZnVuY3Rpb24gdG8gbmV3IHRoZSBzZXJ2aWNlLiBDYWxsZWQgd2l0aCBjb250ZXh0LlxuICovXG5mdW5jdGlvbiByZWdpc3RlclNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGNvbnRleHQsIGlkLCBjdG9yKSB7XG4gIGNvbnN0IHNlcnZpY2VzID0gZ2V0U2VydmljZXMoaG9sZGVyKTtcbiAgbGV0IHMgPSBzZXJ2aWNlc1tpZF07XG5cbiAgaWYgKCFzKSB7XG4gICAgcyA9IHNlcnZpY2VzW2lkXSA9IHtcbiAgICAgIG9iajogbnVsbCxcbiAgICAgIHByb21pc2U6IG51bGwsXG4gICAgICByZXNvbHZlOiBudWxsLFxuICAgICAgY29udGV4dDogbnVsbCxcbiAgICAgIGN0b3I6IG51bGwsXG4gICAgfTtcbiAgfVxuXG4gIGlmIChzLmN0b3IgfHwgcy5vYmopIHtcbiAgICAvLyBTZXJ2aWNlIGFscmVhZHkgcmVnaXN0ZXJlZC5cbiAgICByZXR1cm47XG4gIH1cblxuICBzLmN0b3IgPSBjdG9yO1xuICBzLmNvbnRleHQgPSBjb250ZXh0O1xuXG4gIC8vIFRoZSBzZXJ2aWNlIG1heSBoYXZlIGJlZW4gcmVxdWVzdGVkIGFscmVhZHksIGluIHdoaWNoIGNhc2UgdGhlcmUgaXMgYVxuICAvLyBwZW5kaW5nIHByb21pc2UgdGhhdCBuZWVkcyB0byBmdWxmaWxsZWQuXG4gIGlmIChzLnJlc29sdmUpIHtcbiAgICAvLyBnZXRTZXJ2aWNlSW50ZXJuYWwgd2lsbCByZXNvbHZlIHRoZSBwcm9taXNlLlxuICAgIGdldFNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGlkKTtcbiAgfVxufVxuXG4vKipcbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhT2JqZWN0Pn1cbiAqL1xuZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2VJbnRlcm5hbChob2xkZXIsIGlkKSB7XG4gIGNvbnN0IGNhY2hlZCA9IGdldFNlcnZpY2VQcm9taXNlT3JOdWxsSW50ZXJuYWwoaG9sZGVyLCBpZCk7XG4gIGlmIChjYWNoZWQpIHtcbiAgICByZXR1cm4gY2FjaGVkO1xuICB9XG4gIC8vIFNlcnZpY2UgaXMgbm90IHJlZ2lzdGVyZWQuXG5cbiAgLy8gVE9ETyhAY3JhbWZvcmNlKTogQWRkIGEgY2hlY2sgdGhhdCBpZiB0aGUgZWxlbWVudCBpcyBldmVudHVhbGx5IHJlZ2lzdGVyZWRcbiAgLy8gdGhhdCB0aGUgc2VydmljZSBpcyBhY3R1YWxseSBwcm92aWRlZCBhbmQgdGhpcyBwcm9taXNlIHJlc29sdmVzLlxuICBjb25zdCBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICBjb25zdCB7cHJvbWlzZSwgcmVzb2x2ZX0gPSBkZWZlcnJlZDtcblxuICBjb25zdCBzZXJ2aWNlcyA9IGdldFNlcnZpY2VzKGhvbGRlcik7XG4gIHNlcnZpY2VzW2lkXSA9IHtcbiAgICBvYmo6IG51bGwsXG4gICAgcHJvbWlzZSxcbiAgICByZXNvbHZlLFxuICAgIGNvbnRleHQ6IG51bGwsXG4gICAgY3RvcjogbnVsbCxcbiAgfTtcbiAgcmV0dXJuIHByb21pc2U7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3Igc2VydmljZSBgaWRgIGlmIHRoZSBzZXJ2aWNlIGhhcyBiZWVuIHJlZ2lzdGVyZWRcbiAqIG9uIGBob2xkZXJgLlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEByZXR1cm4gez9Qcm9taXNlPCFPYmplY3Q+fVxuICovXG5mdW5jdGlvbiBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEludGVybmFsKGhvbGRlciwgaWQpIHtcbiAgY29uc3Qgc2VydmljZXMgPSBnZXRTZXJ2aWNlcyhob2xkZXIpO1xuICBjb25zdCBzID0gc2VydmljZXNbaWRdO1xuICBpZiAocykge1xuICAgIGlmIChzLnByb21pc2UpIHtcbiAgICAgIHJldHVybiBzLnByb21pc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEluc3RhbnRpYXRlIHNlcnZpY2UgaWYgbm90IGFscmVhZHkgaW5zdGFudGlhdGVkLlxuICAgICAgZ2V0U2VydmljZUludGVybmFsKGhvbGRlciwgaWQpO1xuICAgICAgcmV0dXJuIHMucHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgvKiogQHR5cGUgeyFPYmplY3R9ICovIChzLm9iaikpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIG9iamVjdCB0aGF0IGhvbGRzIHRoZSBzZXJ2aWNlcyByZWdpc3RlcmVkIGluIGEgaG9sZGVyLlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXJcbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCFTZXJ2aWNlSG9sZGVyRGVmPn1cbiAqL1xuZnVuY3Rpb24gZ2V0U2VydmljZXMoaG9sZGVyKSB7XG4gIGxldCB7c2VydmljZXN9ID0gaG9sZGVyO1xuICBpZiAoIXNlcnZpY2VzKSB7XG4gICAgc2VydmljZXMgPSBob2xkZXIuc2VydmljZXMgPSB7fTtcbiAgfVxuICByZXR1cm4gc2VydmljZXM7XG59XG5cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBzcGVjaWZpZWQgc2VydmljZSBpbXBsZW1lbnRzIGBEaXNwb3NhYmxlYCBpbnRlcmZhY2UuXG4gKiBAcGFyYW0geyFPYmplY3R9IHNlcnZpY2VcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Rpc3Bvc2FibGUoc2VydmljZSkge1xuICByZXR1cm4gdHlwZW9mIHNlcnZpY2UuZGlzcG9zZSA9PSAnZnVuY3Rpb24nO1xufVxuXG5cbi8qKlxuICogQXNzZXJ0cyB0aGF0IHRoZSBzcGVjaWZpZWQgc2VydmljZSBpbXBsZW1lbnRzIGBEaXNwb3NhYmxlYCBpbnRlcmZhY2UgYW5kXG4gKiB0eXBlY2FzdHMgdGhlIGluc3RhbmNlIHRvIGBEaXNwb3NhYmxlYC5cbiAqIEBwYXJhbSB7IU9iamVjdH0gc2VydmljZVxuICogQHJldHVybiB7IURpc3Bvc2FibGV9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnREaXNwb3NhYmxlKHNlcnZpY2UpIHtcbiAgZGV2KCkuYXNzZXJ0KGlzRGlzcG9zYWJsZShzZXJ2aWNlKSwgJ3JlcXVpcmVkIHRvIGltcGxlbWVudCBEaXNwb3NhYmxlJyk7XG4gIHJldHVybiAvKiogQHR5cGUgeyFEaXNwb3NhYmxlfSAqLyAoc2VydmljZSk7XG59XG5cblxuLyoqXG4gKiBEaXNwb3NlcyBhbGwgZGlzcG9zYWJsZSAoaW1wbGVtZW50cyBgRGlzcG9zYWJsZWAgaW50ZXJmYWNlKSBzZXJ2aWNlcyBpblxuICogYW1wZG9jIHNjb3BlLlxuICogQHBhcmFtIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkaXNwb3NlU2VydmljZXNGb3JEb2MoYW1wZG9jKSB7XG4gIGRpc3Bvc2VTZXJ2aWNlc0ludGVybmFsKGFtcGRvYyk7XG59XG5cblxuLyoqXG4gKiBEaXNwb3NlcyBhbGwgZGlzcG9zYWJsZSAoaW1wbGVtZW50cyBgRGlzcG9zYWJsZWAgaW50ZXJmYWNlKSBzZXJ2aWNlcyBpblxuICogZW1iZWQgc2NvcGUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IGVtYmVkV2luXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkaXNwb3NlU2VydmljZXNGb3JFbWJlZChlbWJlZFdpbikge1xuICBkaXNwb3NlU2VydmljZXNJbnRlcm5hbChlbWJlZFdpbik7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFPYmplY3R9IGhvbGRlciBPYmplY3QgaG9sZGluZyB0aGUgc2VydmljZSBpbnN0YW5jZXMuXG4gKi9cbmZ1bmN0aW9uIGRpc3Bvc2VTZXJ2aWNlc0ludGVybmFsKGhvbGRlcikge1xuICAvLyBUT0RPKGR2b3l0ZW5rbyk6IENvbnNpZGVyIG1hcmtpbmcgaG9sZGVyIGFzIGRlc3Ryb3llZCBmb3IgbGF0ZXItYXJyaXZpbmdcbiAgLy8gc2VydmljZSB0byBiZSBjYW5jZWxlZCBhdXRvbWF0aWNhbGx5LlxuICBjb25zdCBzZXJ2aWNlcyA9IGdldFNlcnZpY2VzKGhvbGRlcik7XG4gIGZvciAoY29uc3QgaWQgaW4gc2VydmljZXMpIHtcbiAgICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzZXJ2aWNlcywgaWQpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3Qgc2VydmljZUhvbGRlciA9IHNlcnZpY2VzW2lkXTtcbiAgICBpZiAoc2VydmljZUhvbGRlci5vYmopIHtcbiAgICAgIGRpc3Bvc2VTZXJ2aWNlSW50ZXJuYWwoaWQsIHNlcnZpY2VIb2xkZXIub2JqKTtcbiAgICB9IGVsc2UgaWYgKHNlcnZpY2VIb2xkZXIucHJvbWlzZSkge1xuICAgICAgc2VydmljZUhvbGRlci5wcm9taXNlLnRoZW4oXG4gICAgICAgICAgaW5zdGFuY2UgPT4gZGlzcG9zZVNlcnZpY2VJbnRlcm5hbChpZCwgaW5zdGFuY2UpKTtcbiAgICB9XG4gIH1cbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHshT2JqZWN0fSBzZXJ2aWNlXG4gKi9cbmZ1bmN0aW9uIGRpc3Bvc2VTZXJ2aWNlSW50ZXJuYWwoaWQsIHNlcnZpY2UpIHtcbiAgaWYgKCFpc0Rpc3Bvc2FibGUoc2VydmljZSkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdHJ5IHtcbiAgICBhc3NlcnREaXNwb3NhYmxlKHNlcnZpY2UpLmRpc3Bvc2UoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIC8vIEVuc3VyZSB0aGF0IGEgZmFpbHVyZSB0byBkaXNwb3NlIGEgc2VydmljZSBkb2VzIG5vdCBkaXNydXB0IG90aGVyXG4gICAgLy8gc2VydmljZXMuXG4gICAgZGV2KCkuZXJyb3IoJ1NFUlZJQ0UnLCAnZmFpbGVkIHRvIGRpc3Bvc2Ugc2VydmljZScsIGlkLCBlKTtcbiAgfVxufVxuXG5cbi8qKlxuICogV2hldGhlciB0aGUgc3BlY2lmaWVkIHNlcnZpY2UgaW1wbGVtZW50cyBgRW1iZWRkYWJsZVNlcnZpY2VgIGludGVyZmFjZS5cbiAqIEBwYXJhbSB7IU9iamVjdH0gc2VydmljZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRW1iZWRkYWJsZShzZXJ2aWNlKSB7XG4gIHJldHVybiB0eXBlb2Ygc2VydmljZS5hZG9wdEVtYmVkV2luZG93ID09ICdmdW5jdGlvbic7XG59XG5cblxuLyoqXG4gKiBBZG9wdHMgYW4gZW1iZWRkYWJsZSAoaW1wbGVtZW50cyBgRW1iZWRkYWJsZVNlcnZpY2VgIGludGVyZmFjZSkgc2VydmljZVxuICogaW4gZW1iZWQgc2NvcGUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IGVtYmVkV2luXG4gKiBAcGFyYW0ge3N0cmluZ30gc2VydmljZUlkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZG9wdFNlcnZpY2VGb3JFbWJlZChlbWJlZFdpbiwgc2VydmljZUlkKSB7XG4gIGNvbnN0IGFkb3B0ZWQgPSBhZG9wdFNlcnZpY2VGb3JFbWJlZElmRW1iZWRkYWJsZShlbWJlZFdpbiwgc2VydmljZUlkKTtcbiAgZGV2KCkuYXNzZXJ0KGFkb3B0ZWQsIGBTZXJ2aWNlICR7c2VydmljZUlkfSBub3QgZm91bmQgb24gcGFyZW50IGAgK1xuICAgICAgJ29yIGRvZXNuXFwndCBpbXBsZW1lbnQgRW1iZWRkYWJsZVNlcnZpY2UuJyk7XG59XG5cblxuLyoqXG4gKiBBZG9wdHMgYW4gZW1iZWRkYWJsZSAoaW1wbGVtZW50cyBgRW1iZWRkYWJsZVNlcnZpY2VgIGludGVyZmFjZSkgc2VydmljZVxuICogaW4gZW1iZWQgc2NvcGUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IGVtYmVkV2luXG4gKiBAcGFyYW0ge3N0cmluZ30gc2VydmljZUlkXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRvcHRTZXJ2aWNlRm9yRW1iZWRJZkVtYmVkZGFibGUoZW1iZWRXaW4sIHNlcnZpY2VJZCkge1xuICBjb25zdCBmcmFtZUVsZW1lbnQgPSAvKiogQHR5cGUgeyFOb2RlfSAqLyAoZGV2KCkuYXNzZXJ0KFxuICAgICAgZW1iZWRXaW4uZnJhbWVFbGVtZW50LFxuICAgICAgJ2ZyYW1lRWxlbWVudCBub3QgZm91bmQgZm9yIGVtYmVkJykpO1xuICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2MoZnJhbWVFbGVtZW50KTtcbiAgY29uc3QgaG9sZGVyID0gZ2V0QW1wZG9jU2VydmljZUhvbGRlcihhbXBkb2MpO1xuICBpZiAoIWlzU2VydmljZVJlZ2lzdGVyZWQoaG9sZGVyLCBzZXJ2aWNlSWQpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGNvbnN0IHNlcnZpY2UgPSBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZChmcmFtZUVsZW1lbnQsIHNlcnZpY2VJZCk7XG4gIGlmICghaXNFbWJlZGRhYmxlKHNlcnZpY2UpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHNlcnZpY2UuYWRvcHRFbWJlZFdpbmRvdyhlbWJlZFdpbik7XG4gIHJldHVybiB0cnVlO1xufVxuXG5cbi8qKlxuICogUmVzZXRzIGEgc2luZ2xlIHNlcnZpY2UsIHNvIGl0IGdldHMgcmVjcmVhdGVkIG9uIG5leHQgZ2V0U2VydmljZSBpbnZvY2F0aW9uLlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0U2VydmljZUZvclRlc3RpbmcoaG9sZGVyLCBpZCkge1xuICBpZiAoaG9sZGVyLnNlcnZpY2VzKSB7XG4gICAgaG9sZGVyLnNlcnZpY2VzW2lkXSA9IG51bGw7XG4gIH1cbn1cblxuLyoqXG4gKiBAcGFyYW0geyFPYmplY3R9IGhvbGRlciBPYmplY3QgaG9sZGluZyB0aGUgc2VydmljZSBpbnN0YW5jZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzU2VydmljZVJlZ2lzdGVyZWQoaG9sZGVyLCBpZCkge1xuICBjb25zdCBzZXJ2aWNlID0gaG9sZGVyLnNlcnZpY2VzICYmIGhvbGRlci5zZXJ2aWNlc1tpZF07XG4gIC8vIEFsbCByZWdpc3RlcmVkIHNlcnZpY2VzIG11c3QgaGF2ZSBhbiBpbXBsZW1lbnRhdGlvbiBvciBhIGNvbnN0cnVjdG9yLlxuICByZXR1cm4gISEoc2VydmljZSAmJiAoc2VydmljZS5jdG9yIHx8IHNlcnZpY2Uub2JqKSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgYmFzZUluc3RhbmNlIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1xuICBQb3NpdGlvbk9ic2VydmVyRmlkZWxpdHksIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgUG9zaXRpb25PYnNlcnZlcldvcmtlciwgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xufSBmcm9tICcuL3Bvc2l0aW9uLW9ic2VydmVyLXdvcmtlcic7XG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi8uLi9zZXJ2aWNlcyc7XG5pbXBvcnQge2RlYm91bmNlfSBmcm9tICcuLi8uLi91dGlscy9yYXRlLWxpbWl0JztcbmltcG9ydCB7ZGV2fSBmcm9tICcuLi8uLi9sb2cnO1xuaW1wb3J0IHtyZWdpc3RlclNlcnZpY2VCdWlsZGVyRm9yRG9jfSBmcm9tICcuLi8uLi9zZXJ2aWNlJztcblxuLyoqIEBjb25zdCBAcHJpdmF0ZSAqL1xuY29uc3QgVEFHID0gJ1BPU0lUSU9OX09CU0VSVkVSJztcblxuLyoqIEBjb25zdCBAcHJpdmF0ZSAqL1xuY29uc3QgU0NST0xMX1RJTUVPVVQgPSA1MDA7XG5cblxuZXhwb3J0IGNsYXNzIFBvc2l0aW9uT2JzZXJ2ZXIge1xuICAvKipcbiAgICogQHBhcmFtIHshLi4vYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAgICovXG4gIGNvbnN0cnVjdG9yKGFtcGRvYykge1xuICAgIC8qKiBAcHJpdmF0ZSB7IS4uL2FtcGRvYy1pbXBsLkFtcERvY30gKi9cbiAgICB0aGlzLmFtcGRvY18gPSBhbXBkb2M7XG5cbiAgICAvKiogQHByaXZhdGUgeyFXaW5kb3d9ICovXG4gICAgdGhpcy53aW5fID0gYW1wZG9jLndpbjtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IUFycmF5PCFQb3NpdGlvbk9ic2VydmVyV29ya2VyPn0gKi9cbiAgICB0aGlzLndvcmtlcnNfID0gW107XG5cbiAgICAvKiogQHByaXZhdGUgeyEuLi92c3luYy1pbXBsLlZzeW5jfSAqL1xuICAgIHRoaXMudnN5bmNfID0gU2VydmljZXMudnN5bmNGb3IodGhpcy53aW5fKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IS4uL3ZpZXdwb3J0L3ZpZXdwb3J0LWltcGwuVmlld3BvcnR9ICovXG4gICAgdGhpcy52aWV3cG9ydF8gPSBTZXJ2aWNlcy52aWV3cG9ydEZvckRvYyhhbXBkb2MpO1xuXG4gICAgLyoqIEBwcml2YXRlIHtBcnJheTxmdW5jdGlvbigpPn0gKi9cbiAgICB0aGlzLnVubGlzdGVuZXJzXyA9IFtdO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuaW5TY3JvbGxfID0gZmFsc2U7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy5tZWFzdXJlXyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuY2FsbGJhY2tTdGFydGVkXyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcml2YXRlIHtmdW5jdGlvbigpfSAqL1xuICAgIHRoaXMuYm91bmRTdG9wU2Nyb2xsXyA9IGRlYm91bmNlKHRoaXMud2luXywgKCkgPT4ge1xuICAgICAgdGhpcy5pblNjcm9sbF8gPSBmYWxzZTtcbiAgICB9LCBTQ1JPTExfVElNRU9VVCk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICAgKiBAcGFyYW0geyFQb3NpdGlvbk9ic2VydmVyRmlkZWxpdHl9IGZpZGVsaXR5XG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oPy4vcG9zaXRpb24tb2JzZXJ2ZXItd29ya2VyLlBvc2l0aW9uSW5WaWV3cG9ydEVudHJ5RGVmKX0gaGFuZGxlclxuICAgKiBAcmV0dXJuIHshVW5saXN0ZW5EZWZ9XG4gICAqL1xuICBvYnNlcnZlKGVsZW1lbnQsIGZpZGVsaXR5LCBoYW5kbGVyKSB7XG4gICAgY29uc3Qgd29ya2VyID1cbiAgICAgICAgbmV3IFBvc2l0aW9uT2JzZXJ2ZXJXb3JrZXIodGhpcy5hbXBkb2NfLCBlbGVtZW50LCBmaWRlbGl0eSwgaGFuZGxlcik7XG5cbiAgICB0aGlzLndvcmtlcnNfLnB1c2god29ya2VyKTtcblxuICAgIGlmICghdGhpcy5jYWxsYmFja1N0YXJ0ZWRfKSB7XG4gICAgICB0aGlzLnN0YXJ0Q2FsbGJhY2tfKCk7XG4gICAgfVxuXG4gICAgd29ya2VyLnVwZGF0ZSgpO1xuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy53b3JrZXJzXy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAodGhpcy53b3JrZXJzX1tpXSA9PSB3b3JrZXIpIHtcbiAgICAgICAgICB0aGlzLnJlbW92ZVdvcmtlcl8oaSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gICAqL1xuICB1bm9ic2VydmUoZWxlbWVudCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy53b3JrZXJzXy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMud29ya2Vyc19baV0uZWxlbWVudCA9PSBlbGVtZW50KSB7XG4gICAgICAgIHRoaXMucmVtb3ZlV29ya2VyXyhpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICBkZXYoKS5lcnJvcihUQUcsICdjYW5ub3QgdW5vYnNlcnZlIHVub2JzZXJ2ZWQgZWxlbWVudCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcmVtb3ZlV29ya2VyXyhpbmRleCkge1xuICAgIHRoaXMud29ya2Vyc18uc3BsaWNlKGluZGV4LCAxKTtcbiAgICBpZiAodGhpcy53b3JrZXJzXy5sZW5ndGggPT0gMCkge1xuICAgICAgdGhpcy5zdG9wQ2FsbGJhY2tfKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgZ2V0cyBjYWxsZWQgd2hlbiBzdGFydCB0byBvYnNlcnZlIHRoZSBmaXJzdCBlbGVtZW50LlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc3RhcnRDYWxsYmFja18oKSB7XG4gICAgdGhpcy5jYWxsYmFja1N0YXJ0ZWRfID0gdHJ1ZTtcbiAgICAvLyBsaXN0ZW4gdG8gdmlld3BvcnQgc2Nyb2xsIGV2ZW50IHRvIGhlbHAgcGFzcyBkZXRlcm1pbmUgaWYgbmVlZCB0b1xuICAgIHRoaXMudW5saXN0ZW5lcnNfLnB1c2godGhpcy52aWV3cG9ydF8ub25TY3JvbGwoKCkgPT4ge1xuICAgICAgdGhpcy5vblNjcm9sbEhhbmRsZXJfKCk7XG4gICAgfSkpO1xuICAgIHRoaXMudW5saXN0ZW5lcnNfLnB1c2godGhpcy52aWV3cG9ydF8ub25SZXNpemUoKCkgPT4ge1xuICAgICAgdGhpcy5vblJlc2l6ZUhhbmRsZXJfKCk7XG4gICAgfSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgZ2V0cyBjYWxsZWQgd2hlbiB1bm9ic2VydmUgbGFzdCBvYnNlcnZlZCBlbGVtZW50LlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc3RvcENhbGxiYWNrXygpIHtcbiAgICB0aGlzLmNhbGxiYWNrU3RhcnRlZF8gPSBmYWxzZTtcbiAgICB3aGlsZSAodGhpcy51bmxpc3RlbmVyc18ubGVuZ3RoKSB7XG4gICAgICBjb25zdCB1bmxpc3RlbiA9IHRoaXMudW5saXN0ZW5lcnNfLnBvcCgpO1xuICAgICAgdW5saXN0ZW4oKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVGhpcyBzaG91bGQgYWx3YXlzIGJlIGNhbGxlZCBpbiB2c3luYy5cbiAgICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2ZvcmNlXG4gICAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICAqL1xuICB1cGRhdGVBbGxFbnRyaWVzKG9wdF9mb3JjZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy53b3JrZXJzXy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qgd29ya2VyID0gdGhpcy53b3JrZXJzX1tpXTtcbiAgICAgIHdvcmtlci51cGRhdGUob3B0X2ZvcmNlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIHZpZXdwb3J0IHNjcm9sbCBldmVudFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgb25TY3JvbGxIYW5kbGVyXygpIHtcbiAgICB0aGlzLmJvdW5kU3RvcFNjcm9sbF8oKTtcbiAgICB0aGlzLmluU2Nyb2xsXyA9IHRydWU7XG4gICAgaWYgKCF0aGlzLm1lYXN1cmVfKSB7XG4gICAgICB0aGlzLnNjaGVkdWxlUGFzc18oKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIHZpZXdwb3J0IHJlc2l6ZSBldmVudFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgb25SZXNpemVIYW5kbGVyXygpIHtcbiAgICB0aGlzLnVwZGF0ZUFsbEVudHJpZXModHJ1ZSk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIGFsbCBlbnRyaWVzIGR1cmluZyBzY3JvbGxcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHNjaGVkdWxlUGFzc18oKSB7XG4gICAgLy8gVE9ETyAoQHpob3V5eCwgIzkyMDgpOlxuICAgIC8vIFAxOiBhY2NvdW50IGZvciBlZmZlY3RpdmUgZmlkZWxpdHkgdXNpbmcgdGhpcy5lZmZlY3RpdmVGaWRlbGl0eVxuICAgIC8vIFAyOiBkbyBwYXNzZXMgb24gb25Eb21NdXRhdGlvbiAoaWYgYXZhaWxhYmxlIHVzaW5nIE11dGF0aW9uT2JzZXJ2ZXJcbiAgICAvLyBtb3N0bHkgZm9yIGluLWEtYm94IGhvc3QsIHNpbmNlIG1vc3QgRE9NIG11dGF0aW9ucyBhcmUgY29uc3RyYWludCB0byB0aGVcbiAgICAvLyBBTVAgZWxlbWVudHMpLlxuICAgIHRoaXMudXBkYXRlQWxsRW50cmllcygpO1xuICAgIHRoaXMubWVhc3VyZV8gPSB0cnVlO1xuICAgIGlmICghdGhpcy5pblNjcm9sbF8pIHtcbiAgICAgIC8vIFN0b3AgbWVhc3VyZSBpZiB2aWV3cG9ydCBpcyBubyBsb25nZXIgc2Nyb2xsaW5nXG4gICAgICB0aGlzLm1lYXN1cmVfID0gZmFsc2U7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMudnN5bmNfLm1lYXN1cmUoKCkgPT4ge1xuICAgICAgdGhpcy5zY2hlZHVsZVBhc3NfKCk7XG4gICAgfSk7XG4gIH1cbn1cblxuLyoqXG4gKiBAcGFyYW0geyEuLi9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbFBvc2l0aW9uT2JzZXJ2ZXJTZXJ2aWNlRm9yRG9jKGFtcGRvYykge1xuICByZWdpc3RlclNlcnZpY2VCdWlsZGVyRm9yRG9jKGFtcGRvYywgJ3Bvc2l0aW9uLW9ic2VydmVyJywgKCkgPT4ge1xuICAgIHJldHVybiBuZXcgUG9zaXRpb25PYnNlcnZlcihhbXBkb2MpO1xuICB9KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSBiYXNlSW5zdGFuY2UgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4uLy4uL3NlcnZpY2VzJztcbmltcG9ydCB7ZGV2fSBmcm9tICcuLi8uLi9sb2cnO1xuaW1wb3J0IHtcbiAgbGF5b3V0UmVjdEVxdWFscyxcbiAgbGF5b3V0UmVjdEx0d2gsXG4gIGxheW91dFJlY3RzT3ZlcmxhcCxcbiAgbGF5b3V0UmVjdHNSZWxhdGl2ZVBvcyxcbn0gZnJvbSAnLi4vLi4vbGF5b3V0LXJlY3QnO1xuXG4vKiogQGVudW0ge251bWJlcn0gKi9cbmV4cG9ydCBjb25zdCBQb3NpdGlvbk9ic2VydmVyRmlkZWxpdHkgPSB7XG4gIEhJR0g6IDEsXG4gIExPVzogMCxcbn07XG5cbi8qKiBAY29uc3QgQHByaXZhdGUgKi9cbmNvbnN0IExPV19GSURFTElUWV9GUkFNRV9DT1VOVCA9IDQ7XG5cbi8qKlxuICogVE9ETyAoQHpob3V5eCk6IHJlbmFtZSByZWxhdGl2ZVBvcyB0byByZWxhdGl2ZVBvc2l0aW9uc1xuICogVGhlIHBvc2l0aW9uT2JzZXJ2ZXIgcmV0dXJuZWQgcG9zaXRpb24gdmFsdWUgd2hpY2ggaW5jbHVkZXMgdGhlIHBvc2l0aW9uIHJlY3RcbiAqIHJlbGF0aXZlIHRvIHZpZXdwb3J0LiBBbmQgdmlld3BvcnQgcmVjdCB3aGljaCBhbHdheXMgaGFzIHRvcCAwLCBsZWZ0IDAsIGFuZFxuICogdmlld3BvcnQgd2lkdGggYW5kIGhlaWdodC5cbiAqIEB0eXBlZGVmIHt7XG4gKiAgcG9zaXRpb25SZWN0OiA/Li4vLi4vbGF5b3V0LXJlY3QuTGF5b3V0UmVjdERlZixcbiAqICB2aWV3cG9ydFJlY3Q6ICEuLi8uLi9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmLFxuICogIHJlbGF0aXZlUG9zOiBzdHJpbmcsXG4gKiB9fVxuICovXG5leHBvcnQgbGV0IFBvc2l0aW9uSW5WaWV3cG9ydEVudHJ5RGVmO1xuXG5leHBvcnQgY2xhc3MgUG9zaXRpb25PYnNlcnZlcldvcmtlciB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyEuLi9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICAgKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gICAqIEBwYXJhbSB7IVBvc2l0aW9uT2JzZXJ2ZXJGaWRlbGl0eX0gZmlkZWxpdHlcbiAgICogQHBhcmFtIHtmdW5jdGlvbig/UG9zaXRpb25JblZpZXdwb3J0RW50cnlEZWYpfSBoYW5kbGVyXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhbXBkb2MsIGVsZW1lbnQsIGZpZGVsaXR5LCBoYW5kbGVyKSB7XG4gICAgLyoqIEBjb25zdCB7IUVsZW1lbnR9ICovXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcblxuICAgIC8qKiBAY29uc3Qge2Z1bmN0aW9uKD9Qb3NpdGlvbkluVmlld3BvcnRFbnRyeURlZil9ICovXG4gICAgdGhpcy5oYW5kbGVyXyA9IGhhbmRsZXI7XG5cbiAgICAvKiogQHR5cGUgeyFQb3NpdGlvbk9ic2VydmVyRmlkZWxpdHl9ICovXG4gICAgdGhpcy5maWRlbGl0eSA9IGZpZGVsaXR5O1xuXG4gICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovXG4gICAgdGhpcy50dXJuID0gKGZpZGVsaXR5ID09IFBvc2l0aW9uT2JzZXJ2ZXJGaWRlbGl0eS5MT1cpID9cbiAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIExPV19GSURFTElUWV9GUkFNRV9DT1VOVCkgOiAwO1xuXG4gICAgLyoqIEB0eXBlIHs/UG9zaXRpb25JblZpZXdwb3J0RW50cnlEZWZ9ICovXG4gICAgdGhpcy5wcmV2UG9zaXRpb25fID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IS4uL3ZpZXdwb3J0L3ZpZXdwb3J0LWltcGwuVmlld3BvcnR9ICovXG4gICAgdGhpcy52aWV3cG9ydF8gPSBTZXJ2aWNlcy52aWV3cG9ydEZvckRvYyhhbXBkb2MpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGwgdG8gdHJpZ2dlciBhbiBlbnRyeSBoYW5kbGVyXG4gICAqIEBwYXJhbSB7IVBvc2l0aW9uSW5WaWV3cG9ydEVudHJ5RGVmfSBwb3NpdGlvblxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdHJpZ2dlcl8ocG9zaXRpb24pIHtcbiAgICBjb25zdCBwcmV2UG9zID0gdGhpcy5wcmV2UG9zaXRpb25fO1xuICAgIGlmIChwcmV2UG9zXG4gICAgICAgICYmIGxheW91dFJlY3RFcXVhbHMocHJldlBvcy5wb3NpdGlvblJlY3QsIHBvc2l0aW9uLnBvc2l0aW9uUmVjdClcbiAgICAgICAgJiYgbGF5b3V0UmVjdEVxdWFscyhwcmV2UG9zLnZpZXdwb3J0UmVjdCwgcG9zaXRpb24udmlld3BvcnRSZWN0KSkge1xuICAgICAgLy8gcG9zaXRpb24gZGlkbid0IGNoYW5nZSwgZG8gbm90aGluZy5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBkZXYoKS5hc3NlcnQocG9zaXRpb24ucG9zaXRpb25SZWN0LFxuICAgICAgICAnUG9zaXRpb25PYnNlcnZlciBzaG91bGQgYWx3YXlzIHRyaWdnZXIgZW50cnkgd2l0aCBjbGllbnRSZWN0Jyk7XG4gICAgY29uc3QgcG9zaXRpb25SZWN0ID1cbiAgICAvKiogQHR5cGUgeyEuLi8uLi9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmfSAqLyAocG9zaXRpb24ucG9zaXRpb25SZWN0KTtcbiAgICAvLyBBZGQgdGhlIHJlbGF0aXZlIHBvc2l0aW9uIG9mIHRoZSBlbGVtZW50IHRvIGl0cyB2aWV3cG9ydFxuICAgIHBvc2l0aW9uLnJlbGF0aXZlUG9zID0gbGF5b3V0UmVjdHNSZWxhdGl2ZVBvcyhwb3NpdGlvblJlY3QsXG4gICAgICAgIHBvc2l0aW9uLnZpZXdwb3J0UmVjdCk7XG5cbiAgICBpZiAobGF5b3V0UmVjdHNPdmVybGFwKHBvc2l0aW9uUmVjdCwgcG9zaXRpb24udmlld3BvcnRSZWN0KSkge1xuICAgICAgLy8gVXBkYXRlIHBvc2l0aW9uXG4gICAgICB0aGlzLnByZXZQb3NpdGlvbl8gPSBwb3NpdGlvbjtcbiAgICAgIC8vIE9ubHkgY2FsbCBoYW5kbGVyIGlmIGVudHJ5IGVsZW1lbnQgb3ZlcmxhcCB3aXRoIHZpZXdwb3J0LlxuICAgICAgdGhpcy5oYW5kbGVyXyhwb3NpdGlvbik7XG4gICAgfSBlbHNlIGlmICh0aGlzLnByZXZQb3NpdGlvbl8pIHtcbiAgICAgIC8vIE5lZWQgdG8gbm90aWZ5IHRoYXQgZWxlbWVudCBnZXRzIG91dHNpZGUgdmlld3BvcnRcbiAgICAgIC8vIE5PVEU6IFRoaXMgaXMgcmVxdWlyZWQgZm9yIGluYWJveCBwb3NpdGlvbiBvYnNlcnZlci5cbiAgICAgIHRoaXMucHJldlBvc2l0aW9uXyA9IG51bGw7XG4gICAgICBwb3NpdGlvbi5wb3NpdGlvblJlY3QgPSBudWxsO1xuICAgICAgdGhpcy5oYW5kbGVyXyhwb3NpdGlvbik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRvIHVwZGF0ZSB0aGUgcG9zaXRpb24gb2YgZW50cnkgZWxlbWVudCB3aGVuIGl0IGlzIHJlYWR5LlxuICAgKiBDYWxsZWQgd2hlbiB1cGRhdGVBbGxFbnRyaWVzLCBvciB3aGVuIGZpcnN0IG9ic2VydmUgYW4gZWxlbWVudC5cbiAgICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2ZvcmNlXG4gICAqL1xuICB1cGRhdGUob3B0X2ZvcmNlKSB7XG4gICAgaWYgKCFvcHRfZm9yY2UpIHtcbiAgICAgIGlmICh0aGlzLnR1cm4gIT0gMCkge1xuICAgICAgICB0aGlzLnR1cm4tLTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5maWRlbGl0eSA9PSBQb3NpdGlvbk9ic2VydmVyRmlkZWxpdHkuTE9XKSB7XG4gICAgICAgIHRoaXMudHVybiA9IExPV19GSURFTElUWV9GUkFNRV9DT1VOVDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCB2aWV3cG9ydFNpemUgPSB0aGlzLnZpZXdwb3J0Xy5nZXRTaXplKCk7XG4gICAgY29uc3Qgdmlld3BvcnRCb3ggPVxuICAgICAgICBsYXlvdXRSZWN0THR3aCgwLCAwLCB2aWV3cG9ydFNpemUud2lkdGgsIHZpZXdwb3J0U2l6ZS5oZWlnaHQpO1xuICAgIHRoaXMudmlld3BvcnRfLmdldENsaWVudFJlY3RBc3luYyh0aGlzLmVsZW1lbnQpLnRoZW4oZWxlbWVudEJveCA9PiB7XG4gICAgICB0aGlzLnRyaWdnZXJfKFxuICAgICAgLyoqIEB0eXBlIHsuL3Bvc2l0aW9uLW9ic2VydmVyLXdvcmtlci5Qb3NpdGlvbkluVmlld3BvcnRFbnRyeURlZn0qLyAoe1xuICAgICAgICAgICAgcG9zaXRpb25SZWN0OiBlbGVtZW50Qm94LFxuICAgICAgICAgICAgdmlld3BvcnRSZWN0OiB2aWV3cG9ydEJveCxcbiAgICAgICAgICAgIHJlbGF0aXZlUG9zOiAnJyxcbiAgICAgICAgICB9KSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge0FjdGlvblRydXN0fSBmcm9tICcuLi9hY3Rpb24tY29uc3RhbnRzJztcbmltcG9ydCB7XG4gIEVNUFRZX01FVEFEQVRBLFxuICBwYXJzZUZhdmljb24sXG4gIHBhcnNlT2dJbWFnZSxcbiAgcGFyc2VTY2hlbWFJbWFnZSxcbiAgc2V0TWVkaWFTZXNzaW9uLFxufSBmcm9tICcuLi9tZWRpYXNlc3Npb24taGVscGVyJztcbmltcG9ydCB7XG4gIE1JTl9WSVNJQklMSVRZX1JBVElPX0ZPUl9BVVRPUExBWSxcbiAgUGxheWluZ1N0YXRlcyxcbiAgVmlkZW9BbmFseXRpY3NFdmVudHMsXG4gIFZpZGVvQXR0cmlidXRlcyxcbiAgVmlkZW9FdmVudHMsXG59IGZyb20gJy4uL3ZpZGVvLWludGVyZmFjZSc7XG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi9zZXJ2aWNlcyc7XG5pbXBvcnQge1ZpZGVvRG9ja2luZ30gZnJvbSAnLi92aWRlby9kb2NraW5nJztcbmltcG9ydCB7XG4gIFZpZGVvU2VydmljZUludGVyZmFjZSxcbiAgVmlkZW9TZXJ2aWNlU2lnbmFscyxcbn0gZnJvbSAnLi92aWRlby1zZXJ2aWNlLWludGVyZmFjZSc7XG5pbXBvcnQge1xuICBWaWRlb1NlcnZpY2VTeW5jLFxuICBzZXRWaWRlb0NvbXBvbmVudENsYXNzbmFtZSxcbn0gZnJvbSAnLi92aWRlby1zZXJ2aWNlLXN5bmMtaW1wbCc7XG5pbXBvcnQge1ZpZGVvU2Vzc2lvbk1hbmFnZXJ9IGZyb20gJy4vdmlkZW8tc2Vzc2lvbi1tYW5hZ2VyJztcbmltcG9ydCB7VmlkZW9VdGlscywgZ2V0SW50ZXJuYWxWaWRlb0VsZW1lbnRGb3J9IGZyb20gJy4uL3V0aWxzL3ZpZGVvJztcbmltcG9ydCB7XG4gIGNyZWF0ZUN1c3RvbUV2ZW50LFxuICBnZXREYXRhLFxuICBsaXN0ZW4sXG4gIGxpc3Rlbk9uY2VQcm9taXNlLFxufSBmcm9tICcuLi9ldmVudC1oZWxwZXInO1xuaW1wb3J0IHtkZXYsIHVzZXJ9IGZyb20gJy4uL2xvZyc7XG5pbXBvcnQge2RpY3QsIG1hcH0gZnJvbSAnLi4vdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7Z2V0TW9kZX0gZnJvbSAnLi4vbW9kZSc7XG5pbXBvcnQge2luc3RhbGxBdXRvcGxheVN0eWxlc0ZvckRvY30gZnJvbSAnLi92aWRlby9pbnN0YWxsLWF1dG9wbGF5LXN0eWxlcyc7XG5pbXBvcnQge2lzRmluaXRlTnVtYmVyfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQge29uY2V9IGZyb20gJy4uL3V0aWxzL2Z1bmN0aW9uJztcbmltcG9ydCB7cmVnaXN0ZXJTZXJ2aWNlQnVpbGRlckZvckRvY30gZnJvbSAnLi4vc2VydmljZSc7XG5pbXBvcnQge3JlbW92ZUVsZW1lbnR9IGZyb20gJy4uL2RvbSc7XG5pbXBvcnQge3JlbmRlckljb24sIHJlbmRlckludGVyYWN0aW9uT3ZlcmxheX0gZnJvbSAnLi92aWRlby9hdXRvcGxheSc7XG5pbXBvcnQge3NldFN0eWxlfSBmcm9tICcuLi9zdHlsZSc7XG5pbXBvcnQge3N0YXJ0c1dpdGh9IGZyb20gJy4uL3N0cmluZyc7XG5cblxuLyoqIEBwcml2YXRlIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgVEFHID0gJ3ZpZGVvLW1hbmFnZXInO1xuXG5cbi8qKlxuICogQHByaXZhdGUge251bWJlcn0gVGhlIG1pbmltdW0gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IGJldHdlZW4gZWFjaFxuICogdmlkZW8tc2Vjb25kcy1wbGF5ZWQgYW5hbHl0aWNzIGV2ZW50LlxuICovXG5jb25zdCBTRUNPTkRTX1BMQVlFRF9NSU5fREVMQVkgPSAxMDAwO1xuXG5cbi8qKlxuICogQHBhcmFtIHshLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIHVzZXJJbnRlcmFjdGVkV2l0aCh2aWRlbykge1xuICB2aWRlby5zaWduYWxzKCkuc2lnbmFsKFZpZGVvU2VydmljZVNpZ25hbHMuVVNFUl9JTlRFUkFDVEVEKTtcbn1cblxuXG4vKipcbiAqIFZpZGVvTWFuYWdlciBrZWVwcyB0cmFjayBvZiBhbGwgQU1QIHZpZGVvIHBsYXllcnMgdGhhdCBpbXBsZW1lbnRcbiAqIHRoZSBjb21tb24gVmlkZW8gQVBJIHtAc2VlIC4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0uXG4gKlxuICogSXQgaXMgcmVzcG9uc2libGUgZm9yIHByb3ZpZGluZyBhIHVuaWZpZWQgdXNlciBleHBlcmllbmNlIGFuZCBhbmFseXRpY3MgZm9yXG4gKiBhbGwgdmlkZW9zIHdpdGhpbiBhIGRvY3VtZW50LlxuICpcbiAqIEBpbXBsZW1lbnRzIHtWaWRlb1NlcnZpY2VJbnRlcmZhY2V9XG4gKi9cbmV4cG9ydCBjbGFzcyBWaWRlb01hbmFnZXIge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0geyEuL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhbXBkb2MpIHtcblxuICAgIC8qKiBAY29uc3QgeyEuL2FtcGRvYy1pbXBsLkFtcERvY30gICovXG4gICAgdGhpcy5hbXBkb2MgPSBhbXBkb2M7XG5cbiAgICAvKiogQGNvbnN0ICovXG4gICAgdGhpcy5pbnN0YWxsQXV0b3BsYXlTdHlsZXMgPSBvbmNlKCgpID0+XG4gICAgICBpbnN0YWxsQXV0b3BsYXlTdHlsZXNGb3JEb2ModGhpcy5hbXBkb2MpKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IS4uL3NlcnZpY2Uvdmlld3BvcnQvdmlld3BvcnQtaW1wbC5WaWV3cG9ydH0gKi9cbiAgICB0aGlzLnZpZXdwb3J0XyA9IFNlcnZpY2VzLnZpZXdwb3J0Rm9yRG9jKHRoaXMuYW1wZG9jKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P0FycmF5PCFWaWRlb0VudHJ5Pn0gKi9cbiAgICB0aGlzLmVudHJpZXNfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7Ym9vbGVhbn0gKi9cbiAgICB0aGlzLnNjcm9sbExpc3RlbmVySW5zdGFsbGVkXyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCAqL1xuICAgIHRoaXMudGltZXJfID0gU2VydmljZXMudGltZXJGb3IoYW1wZG9jLndpbik7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0ICovXG4gICAgdGhpcy5hY3Rpb25zXyA9IFNlcnZpY2VzLmFjdGlvblNlcnZpY2VGb3JEb2MoYW1wZG9jKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgKi9cbiAgICB0aGlzLmJvdW5kU2Vjb25kc1BsYXlpbmdfID0gKCkgPT4gdGhpcy5zZWNvbmRzUGxheWluZ18oKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge2Z1bmN0aW9uKCk6IUF1dG9GdWxsc2NyZWVuTWFuYWdlcn0gKi9cbiAgICB0aGlzLmdldEF1dG9GdWxsc2NyZWVuTWFuYWdlcl8gPVxuICAgICAgICBvbmNlKCgpID0+IG5ldyBBdXRvRnVsbHNjcmVlbk1hbmFnZXIodGhpcy5hbXBkb2MsIHRoaXMpKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge2Z1bmN0aW9uKCk6IVZpZGVvRG9ja2luZ30gKi9cbiAgICB0aGlzLmdldERvY2tpbmdfID0gb25jZSgoKSA9PiBuZXcgVmlkZW9Eb2NraW5nKHRoaXMuYW1wZG9jLCB0aGlzKSk7XG5cbiAgICAvLyBUT0RPKGN2aWFsaXosICMxMDU5OSk6IEl0IHdvdWxkIGJlIG5pY2UgdG8gb25seSBjcmVhdGUgdGhlIHRpbWVyXG4gICAgLy8gaWYgdmlkZW8gYW5hbHl0aWNzIGFyZSBwcmVzZW50LCBzaW5jZSB0aGUgdGltZXIgaXMgbm90IG5lZWRlZCBpZlxuICAgIC8vIHZpZGVvIGFuYWx5dGljcyBhcmUgbm90IHByZXNlbnQuXG4gICAgdGhpcy50aW1lcl8uZGVsYXkodGhpcy5ib3VuZFNlY29uZHNQbGF5aW5nXywgU0VDT05EU19QTEFZRURfTUlOX0RFTEFZKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFYWNoIHNlY29uZCwgdHJpZ2dlciB2aWRlby1zZWNvbmRzLXBsYXllZCBmb3IgdmlkZW9zIHRoYXQgYXJlIHBsYXlpbmdcbiAgICogYXQgdHJpZ2dlciB0aW1lLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc2Vjb25kc1BsYXlpbmdfKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5lbnRyaWVzXy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgZW50cnkgPSB0aGlzLmVudHJpZXNfW2ldO1xuICAgICAgaWYgKGVudHJ5LmdldFBsYXlpbmdTdGF0ZSgpICE9PSBQbGF5aW5nU3RhdGVzLlBBVVNFRCkge1xuICAgICAgICBhbmFseXRpY3NFdmVudChlbnRyeSwgVmlkZW9BbmFseXRpY3NFdmVudHMuU0VDT05EU19QTEFZRUQpO1xuICAgICAgICB0aGlzLnRpbWVVcGRhdGVBY3Rpb25FdmVudF8oZW50cnkpO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLnRpbWVyXy5kZWxheSh0aGlzLmJvdW5kU2Vjb25kc1BsYXlpbmdfLCBTRUNPTkRTX1BMQVlFRF9NSU5fREVMQVkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRyaWdnZXJzIGEgTE9XLVRSVVNUIHRpbWV1cGRhdGUgZXZlbnQgY29uc3VtYWJsZSBieSBBTVAgYWN0aW9ucy5cbiAgICogRnJlcXVlbmN5IG9mIHRoaXMgZXZlbnQgaXMgY29udHJvbGxlZCBieSBTRUNPTkRTX1BMQVlFRF9NSU5fREVMQVkgYW5kIGlzXG4gICAqIGV2ZXJ5IDEgc2Vjb25kIGZvciBub3cuXG4gICAqIEBwYXJhbSB7IVZpZGVvRW50cnl9IGVudHJ5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB0aW1lVXBkYXRlQWN0aW9uRXZlbnRfKGVudHJ5KSB7XG4gICAgY29uc3QgbmFtZSA9ICd0aW1lVXBkYXRlJztcbiAgICBjb25zdCBjdXJyZW50VGltZSA9IGVudHJ5LnZpZGVvLmdldEN1cnJlbnRUaW1lKCk7XG4gICAgY29uc3QgZHVyYXRpb24gPSBlbnRyeS52aWRlby5nZXREdXJhdGlvbigpO1xuICAgIGlmIChpc0Zpbml0ZU51bWJlcihjdXJyZW50VGltZSkgJiZcbiAgICAgICAgaXNGaW5pdGVOdW1iZXIoZHVyYXRpb24pICYmXG4gICAgICAgIGR1cmF0aW9uID4gMCkge1xuICAgICAgY29uc3QgcGVyYyA9IGN1cnJlbnRUaW1lIC8gZHVyYXRpb247XG4gICAgICBjb25zdCBldmVudCA9IGNyZWF0ZUN1c3RvbUV2ZW50KHRoaXMuYW1wZG9jLndpbiwgYCR7VEFHfS4ke25hbWV9YCxcbiAgICAgICAgICBkaWN0KHsndGltZSc6IGN1cnJlbnRUaW1lLCAncGVyY2VudCc6IHBlcmN9KSk7XG4gICAgICB0aGlzLmFjdGlvbnNfLnRyaWdnZXIoZW50cnkudmlkZW8uZWxlbWVudCwgbmFtZSwgZXZlbnQsIEFjdGlvblRydXN0LkxPVyk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICByZWdpc3Rlcih2aWRlbykge1xuICAgIGRldigpLmFzc2VydCh2aWRlbyk7XG5cbiAgICB0aGlzLnJlZ2lzdGVyQ29tbW9uQWN0aW9uc18odmlkZW8pO1xuXG4gICAgaWYgKCF2aWRlby5zdXBwb3J0c1BsYXRmb3JtKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmVudHJpZXNfID0gdGhpcy5lbnRyaWVzXyB8fCBbXTtcbiAgICBjb25zdCBlbnRyeSA9IG5ldyBWaWRlb0VudHJ5KHRoaXMsIHZpZGVvKTtcbiAgICB0aGlzLm1heWJlSW5zdGFsbFZpc2liaWxpdHlPYnNlcnZlcl8oZW50cnkpO1xuICAgIHRoaXMuZW50cmllc18ucHVzaChlbnRyeSk7XG5cbiAgICBjb25zdCB7ZWxlbWVudH0gPSBlbnRyeS52aWRlbztcbiAgICBlbGVtZW50LmRpc3BhdGNoQ3VzdG9tRXZlbnQoVmlkZW9FdmVudHMuUkVHSVNURVJFRCk7XG5cbiAgICBzZXRWaWRlb0NvbXBvbmVudENsYXNzbmFtZShlbGVtZW50KTtcblxuICAgIC8vIFVubGlrZSBldmVudHMsIHNpZ25hbHMgYXJlIHBlcm1hbmVudC4gV2UgY2FuIHdhaXQgZm9yIGBSRUdJU1RFUkVEYCBhdCBhbnlcbiAgICAvLyBtb21lbnQgaW4gdGhlIGVsZW1lbnQncyBsaWZlY3ljbGUgYW5kIHRoZSBwcm9taXNlIHdpbGwgcmVzb2x2ZVxuICAgIC8vIGFwcHJvcHJpYXRlbHkgZWFjaCB0aW1lLlxuICAgIGNvbnN0IHNpZ25hbHMgPVxuICAgICAgICAoLyoqIEB0eXBlIHshLi4vYmFzZS1lbGVtZW50LkJhc2VFbGVtZW50fSAqLyAodmlkZW8pKS5zaWduYWxzKCk7XG5cbiAgICBzaWduYWxzLnNpZ25hbChWaWRlb0V2ZW50cy5SRUdJU1RFUkVEKTtcblxuICAgIC8vIEFkZCBhIGNsYXNzIHRvIGVsZW1lbnQgdG8gaW5kaWNhdGUgaXQgaW1wbGVtZW50cyB0aGUgdmlkZW8gaW50ZXJmYWNlLlxuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaS1hbXBodG1sLXZpZGVvLWludGVyZmFjZScpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGNvbW1vbiBhY3Rpb25zIHN1Y2ggYXMgcGxheSwgcGF1c2UsIGV0Yy4uLiBvbiB0aGUgdmlkZW8gZWxlbWVudFxuICAgKiBzbyB0aGV5IGNhbiBiZSBjYWxsZWQgdXNpbmcgQU1QIEFjdGlvbnMuXG4gICAqIEZvciBleGFtcGxlOiA8YnV0dG9uIG9uPVwidGFwOm15VmlkZW8ucGxheVwiPlxuICAgKlxuICAgKiBAcGFyYW0geyEuLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSB2aWRlb1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcmVnaXN0ZXJDb21tb25BY3Rpb25zXyh2aWRlbykge1xuICAgIC8vIE9ubHkgcmVxdWlyZSBBY3Rpb25UcnVzdC5MT1cgZm9yIHZpZGVvIGFjdGlvbnMgdG8gZGVmZXIgdG8gcGxhdGZvcm1cbiAgICAvLyBzcGVjaWZpYyBoYW5kbGluZyAoZS5nLiB1c2VyIGdlc3R1cmUgcmVxdWlyZW1lbnQgZm9yIHVubXV0ZWQgcGxheWJhY2spLlxuICAgIGNvbnN0IHRydXN0ID0gQWN0aW9uVHJ1c3QuTE9XO1xuXG4gICAgcmVnaXN0ZXJBY3Rpb24oJ3BsYXknLCAoKSA9PiB2aWRlby5wbGF5KC8qIGlzQXV0b3BsYXkgKi8gZmFsc2UpKTtcbiAgICByZWdpc3RlckFjdGlvbigncGF1c2UnLCAoKSA9PiB2aWRlby5wYXVzZSgpKTtcbiAgICByZWdpc3RlckFjdGlvbignbXV0ZScsICgpID0+IHZpZGVvLm11dGUoKSk7XG4gICAgcmVnaXN0ZXJBY3Rpb24oJ3VubXV0ZScsICgpID0+IHZpZGVvLnVubXV0ZSgpKTtcbiAgICByZWdpc3RlckFjdGlvbignZnVsbHNjcmVlbicsICgpID0+IHZpZGVvLmZ1bGxzY3JlZW5FbnRlcigpKTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpb25cbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGZuXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXJBY3Rpb24oYWN0aW9uLCBmbikge1xuICAgICAgdmlkZW8ucmVnaXN0ZXJBY3Rpb24oYWN0aW9uLCAoKSA9PiB7XG4gICAgICAgIHVzZXJJbnRlcmFjdGVkV2l0aCh2aWRlbyk7XG4gICAgICAgIGZuKCk7XG4gICAgICB9LCB0cnVzdCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEluc3RhbGwgdGhlIG5lY2Vzc2FyeSBsaXN0ZW5lcnMgdG8gYmUgbm90aWZpZWQgd2hlbiBhIHZpZGVvIGJlY29tZXMgdmlzaWJsZVxuICAgKiBpbiB0aGUgdmlld3BvcnQuXG4gICAqXG4gICAqIFZpc2liaWxpdHkgb2YgYSB2aWRlbyBpcyBkZWZpbmVkIGJ5IGJlaW5nIGluIHRoZSB2aWV3cG9ydCBBTkQgaGF2aW5nXG4gICAqIHtAbGluayBNSU5fVklTSUJJTElUWV9SQVRJT19GT1JfQVVUT1BMQVl9IG9mIHRoZSB2aWRlbyBlbGVtZW50IHZpc2libGUuXG4gICAqXG4gICAqIEBwYXJhbSB7VmlkZW9FbnRyeX0gZW50cnlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIG1heWJlSW5zdGFsbFZpc2liaWxpdHlPYnNlcnZlcl8oZW50cnkpIHtcbiAgICBjb25zdCB7ZWxlbWVudH0gPSBlbnRyeS52aWRlbztcblxuICAgIGxpc3RlbihlbGVtZW50LCBWaWRlb0V2ZW50cy5WSVNJQklMSVRZLCBkZXRhaWxzID0+IHtcbiAgICAgIGNvbnN0IGRhdGEgPSBnZXREYXRhKGRldGFpbHMpO1xuICAgICAgaWYgKGRhdGEgJiYgZGF0YVsndmlzaWJsZSddID09IHRydWUpIHtcbiAgICAgICAgZW50cnkudXBkYXRlVmlzaWJpbGl0eSgvKiBvcHRfZm9yY2VWaXNpYmxlICovIHRydWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZW50cnkudXBkYXRlVmlzaWJpbGl0eSgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgbGlzdGVuKGVsZW1lbnQsIFZpZGVvRXZlbnRzLlJFTE9BRCwgKCkgPT4ge1xuICAgICAgZW50cnkudmlkZW9Mb2FkZWQoKTtcbiAgICB9KTtcblxuICAgIC8vIFRPRE8oYWdoYXNzZW1pLCAjNjQyNSk6IFVzZSBJbnRlcnNlY3Rpb25PYnNlcnZlclxuICAgIGlmICghdGhpcy5zY3JvbGxMaXN0ZW5lckluc3RhbGxlZF8pIHtcbiAgICAgIGNvbnN0IHNjcm9sbExpc3RlbmVyID0gKCkgPT4ge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZW50cmllc18ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB0aGlzLmVudHJpZXNfW2ldLnVwZGF0ZVZpc2liaWxpdHkoKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHRoaXMudmlld3BvcnRfLm9uU2Nyb2xsKHNjcm9sbExpc3RlbmVyKTtcbiAgICAgIHRoaXMudmlld3BvcnRfLm9uQ2hhbmdlZChzY3JvbGxMaXN0ZW5lcik7XG4gICAgICB0aGlzLnNjcm9sbExpc3RlbmVySW5zdGFsbGVkXyA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGVudHJ5IGluIHRoZSB2aWRlbyBtYW5hZ2VyIGNvcnJlc3BvbmRpbmcgdG8gdGhlIHZpZGVvXG4gICAqIHByb3ZpZGVkXG4gICAqXG4gICAqIEBwYXJhbSB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0gdmlkZW9cbiAgICogQHJldHVybiB7VmlkZW9FbnRyeX0gZW50cnlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdldEVudHJ5Rm9yVmlkZW9fKHZpZGVvKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmVudHJpZXNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5lbnRyaWVzX1tpXS52aWRlbyA9PT0gdmlkZW8pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZW50cmllc19baV07XG4gICAgICB9XG4gICAgfVxuICAgIGRldigpLmVycm9yKFRBRywgJ3ZpZGVvIGlzIG5vdCByZWdpc3RlcmVkIHRvIHRoaXMgdmlkZW8gbWFuYWdlcicpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGVudHJ5IGluIHRoZSB2aWRlbyBtYW5hZ2VyIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGVsZW1lbnRcbiAgICogcHJvdmlkZWRcbiAgICpcbiAgICogQHBhcmFtIHshQW1wRWxlbWVudH0gZWxlbWVudFxuICAgKiBAcmV0dXJuIHtWaWRlb0VudHJ5fSBlbnRyeVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0RW50cnlGb3JFbGVtZW50XyhlbGVtZW50KSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmVudHJpZXNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBlbnRyeSA9IHRoaXMuZW50cmllc19baV07XG4gICAgICBpZiAoZW50cnkudmlkZW8uZWxlbWVudCA9PT0gZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gZW50cnk7XG4gICAgICB9XG4gICAgfVxuICAgIGRldigpLmVycm9yKFRBRywgJ3ZpZGVvIGlzIG5vdCByZWdpc3RlcmVkIHRvIHRoaXMgdmlkZW8gbWFuYWdlcicpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBnZXRBbmFseXRpY3NEZXRhaWxzKHZpZGVvRWxlbWVudCkge1xuICAgIGNvbnN0IGVudHJ5ID0gdGhpcy5nZXRFbnRyeUZvckVsZW1lbnRfKHZpZGVvRWxlbWVudCk7XG4gICAgcmV0dXJuIGVudHJ5ID8gZW50cnkuZ2V0QW5hbHl0aWNzRGV0YWlscygpIDogUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB3aGV0aGVyIHRoZSB2aWRlbyBpcyBwYXVzZWQgb3IgcGxheWluZyBhZnRlciB0aGUgdXNlciBpbnRlcmFjdGVkXG4gICAqIHdpdGggaXQgb3IgcGxheWluZyB0aHJvdWdoIGF1dG9wbGF5XG4gICAqXG4gICAqIEBwYXJhbSB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0gdmlkZW9cbiAgICogQHJldHVybiB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0gUGxheWluZ1N0YXRlc1xuICAgKi9cbiAgZ2V0UGxheWluZ1N0YXRlKHZpZGVvKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0RW50cnlGb3JWaWRlb18odmlkZW8pLmdldFBsYXlpbmdTdGF0ZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0gdmlkZW9cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlzTXV0ZWQodmlkZW8pIHtcbiAgICByZXR1cm4gdGhpcy5nZXRFbnRyeUZvclZpZGVvXyh2aWRlbykuaXNNdXRlZCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0gdmlkZW9cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIHVzZXJJbnRlcmFjdGVkKHZpZGVvKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0RW50cnlGb3JWaWRlb18odmlkZW8pLnVzZXJJbnRlcmFjdGVkKCk7XG4gIH1cblxuICAvKiogQHBhcmFtIHshVmlkZW9FbnRyeX0gZW50cnkgKi9cbiAgcmVnaXN0ZXJGb3JBdXRvRnVsbHNjcmVlbihlbnRyeSkge1xuICAgIHRoaXMuZ2V0QXV0b0Z1bGxzY3JlZW5NYW5hZ2VyXygpLnJlZ2lzdGVyKGVudHJ5KTtcbiAgfVxuXG4gIC8qKiBAcGFyYW0geyFWaWRlb0VudHJ5fSBlbnRyeSAqL1xuICByZWdpc3RlckZvckRvY2tpbmcoZW50cnkpIHtcbiAgICB0aGlzLmdldERvY2tpbmdfKCkucmVnaXN0ZXIoZW50cnkudmlkZW8pO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFBdXRvRnVsbHNjcmVlbk1hbmFnZXJ9XG4gICAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICAgKi9cbiAgZ2V0QXV0b0Z1bGxzY3JlZW5NYW5hZ2VyRm9yVGVzdGluZ18oKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXV0b0Z1bGxzY3JlZW5NYW5hZ2VyXygpO1xuICB9XG59XG5cblxuLyoqXG4gKiBWaWRlb0VudHJ5IHJlcHJlc2VudHMgYW4gZW50cnkgaW4gdGhlIFZpZGVvTWFuYWdlcidzIGxpc3QuXG4gKi9cbmNsYXNzIFZpZGVvRW50cnkge1xuICAvKipcbiAgICogQHBhcmFtIHshVmlkZW9NYW5hZ2VyfSBtYW5hZ2VyXG4gICAqIEBwYXJhbSB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9IHZpZGVvXG4gICAqL1xuICBjb25zdHJ1Y3RvcihtYW5hZ2VyLCB2aWRlbykge1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFWaWRlb01hbmFnZXJ9ICovXG4gICAgdGhpcy5tYW5hZ2VyXyA9IG1hbmFnZXI7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshLi9hbXBkb2MtaW1wbC5BbXBEb2N9ICAqL1xuICAgIHRoaXMuYW1wZG9jXyA9IG1hbmFnZXIuYW1wZG9jO1xuXG4gICAgLyoqIEBwYWNrYWdlIEBjb25zdCB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9ICovXG4gICAgdGhpcy52aWRlbyA9IHZpZGVvO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuYWxsb3dBdXRvcGxheV8gPSB0cnVlO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMubG9hZGVkXyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuaXNQbGF5aW5nXyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuaXNWaXNpYmxlXyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCAqL1xuICAgIHRoaXMuYWN0aW9uU2Vzc2lvbk1hbmFnZXJfID0gbmV3IFZpZGVvU2Vzc2lvbk1hbmFnZXIoKTtcblxuICAgIHRoaXMuYWN0aW9uU2Vzc2lvbk1hbmFnZXJfLm9uU2Vzc2lvbkVuZChcbiAgICAgICAgKCkgPT4gYW5hbHl0aWNzRXZlbnQodGhpcywgVmlkZW9BbmFseXRpY3NFdmVudHMuU0VTU0lPTikpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCAqL1xuICAgIHRoaXMudmlzaWJpbGl0eVNlc3Npb25NYW5hZ2VyXyA9IG5ldyBWaWRlb1Nlc3Npb25NYW5hZ2VyKCk7XG5cbiAgICB0aGlzLnZpc2liaWxpdHlTZXNzaW9uTWFuYWdlcl8ub25TZXNzaW9uRW5kKFxuICAgICAgICAoKSA9PiBhbmFseXRpY3NFdmVudCh0aGlzLCBWaWRlb0FuYWx5dGljc0V2ZW50cy5TRVNTSU9OX1ZJU0lCTEUpKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge2Z1bmN0aW9uKCk6ICFQcm9taXNlPGJvb2xlYW4+fSAqL1xuICAgIHRoaXMuc3VwcG9ydHNBdXRvcGxheV8gPSAoKSA9PiB7XG4gICAgICBjb25zdCB7d2lufSA9IHRoaXMuYW1wZG9jXztcbiAgICAgIHJldHVybiBWaWRlb1V0aWxzLmlzQXV0b3BsYXlTdXBwb3J0ZWQod2luLCBnZXRNb2RlKHdpbikubGl0ZSk7XG4gICAgfTtcblxuICAgIC8vIEF1dG9wbGF5IFZhcmlhYmxlc1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMucGxheUNhbGxlZEJ5QXV0b3BsYXlfID0gZmFsc2U7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy5wYXVzZUNhbGxlZEJ5QXV0b3BsYXlfID0gZmFsc2U7XG5cbiAgICAvKiogQHByaXZhdGUgez9FbGVtZW50fSAqL1xuICAgIHRoaXMuaW50ZXJuYWxFbGVtZW50XyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy5tdXRlZF8gPSBmYWxzZTtcblxuICAgIHRoaXMuaGFzQXV0b3BsYXkgPSB2aWRlby5lbGVtZW50Lmhhc0F0dHJpYnV0ZShWaWRlb0F0dHJpYnV0ZXMuQVVUT1BMQVkpO1xuXG4gICAgaWYgKHRoaXMuaGFzQXV0b3BsYXkpIHtcbiAgICAgIHRoaXMubWFuYWdlcl8uaW5zdGFsbEF1dG9wbGF5U3R5bGVzKCk7XG4gICAgfVxuXG4gICAgLy8gTWVkaWEgU2Vzc2lvbiBBUEkgVmFyaWFibGVzXG5cbiAgICAvKiogQHByaXZhdGUgeyEuLi9tZWRpYXNlc3Npb24taGVscGVyLk1ldGFkYXRhRGVmfSAqL1xuICAgIHRoaXMubWV0YWRhdGFfID0gRU1QVFlfTUVUQURBVEE7XG5cbiAgICBsaXN0ZW5PbmNlUHJvbWlzZSh2aWRlby5lbGVtZW50LCBWaWRlb0V2ZW50cy5MT0FEKVxuICAgICAgICAudGhlbigoKSA9PiB0aGlzLnZpZGVvTG9hZGVkKCkpO1xuICAgIGxpc3Rlbih2aWRlby5lbGVtZW50LCBWaWRlb0V2ZW50cy5QQVVTRSwgKCkgPT4gdGhpcy52aWRlb1BhdXNlZF8oKSk7XG4gICAgbGlzdGVuKHZpZGVvLmVsZW1lbnQsIFZpZGVvRXZlbnRzLlBMQVlJTkcsICgpID0+IHRoaXMudmlkZW9QbGF5ZWRfKCkpO1xuICAgIGxpc3Rlbih2aWRlby5lbGVtZW50LCBWaWRlb0V2ZW50cy5NVVRFRCwgKCkgPT4gdGhpcy5tdXRlZF8gPSB0cnVlKTtcbiAgICBsaXN0ZW4odmlkZW8uZWxlbWVudCwgVmlkZW9FdmVudHMuVU5NVVRFRCwgKCkgPT4gdGhpcy5tdXRlZF8gPSBmYWxzZSk7XG4gICAgbGlzdGVuKHZpZGVvLmVsZW1lbnQsIFZpZGVvRXZlbnRzLkVOREVELCAoKSA9PiB0aGlzLnZpZGVvRW5kZWRfKCkpO1xuXG4gICAgdmlkZW8uc2lnbmFscygpLndoZW5TaWduYWwoVmlkZW9FdmVudHMuUkVHSVNURVJFRClcbiAgICAgICAgLnRoZW4oKCkgPT4gdGhpcy5vblJlZ2lzdGVyXygpKTtcblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXIgZXZlbnQgZm9yIGZpcnN0IG1hbnVhbCBwbGF5LlxuICAgICAqIEBwcml2YXRlIEBjb25zdCB7IWZ1bmN0aW9uKCl9XG4gICAgICovXG4gICAgdGhpcy5maXJzdFBsYXlFdmVudE9yTm9vcF8gPSBvbmNlKCgpID0+IHtcbiAgICAgIGNvbnN0IGZpcnN0UGxheSA9ICdmaXJzdFBsYXknO1xuICAgICAgY29uc3QgdHJ1c3QgPSBBY3Rpb25UcnVzdC5MT1c7XG4gICAgICBjb25zdCBldmVudCA9IGNyZWF0ZUN1c3RvbUV2ZW50KHRoaXMuYW1wZG9jXy53aW4sIGZpcnN0UGxheSxcbiAgICAgICAgICAvKiBkZXRhaWwgKi8gZGljdCh7fSkpO1xuICAgICAgY29uc3QgYWN0aW9ucyA9IFNlcnZpY2VzLmFjdGlvblNlcnZpY2VGb3JEb2ModGhpcy5hbXBkb2NfKTtcbiAgICAgIGFjdGlvbnMudHJpZ2dlcih0aGlzLnZpZGVvLmVsZW1lbnQsIGZpcnN0UGxheSwgZXZlbnQsIHRydXN0KTtcbiAgICB9KTtcblxuICAgIHRoaXMubGlzdGVuRm9yQXV0b3BsYXlEZWxlZ2F0aW9uXygpO1xuICB9XG5cbiAgLyoqIExpc3RlbnMgZm9yIHNpZ25hbHMgdG8gZGVsZWdhdGUgYXV0b3BsYXkgdG8gYSBkaWZmZXJlbnQgbW9kdWxlLiAqL1xuICBsaXN0ZW5Gb3JBdXRvcGxheURlbGVnYXRpb25fKCkge1xuICAgIGNvbnN0IHNpZ25hbHMgPSB0aGlzLnZpZGVvLnNpZ25hbHMoKTtcbiAgICBzaWduYWxzLndoZW5TaWduYWwoVmlkZW9TZXJ2aWNlU2lnbmFscy5BVVRPUExBWV9ERUxFR0FURUQpLnRoZW4oKCkgPT4ge1xuICAgICAgdGhpcy5hbGxvd0F1dG9wbGF5XyA9IGZhbHNlO1xuXG4gICAgICBpZiAodGhpcy5pc1BsYXlpbmdfKSB7XG4gICAgICAgIHRoaXMudmlkZW8ucGF1c2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBAcmV0dXJuIHtib29sZWFufSAqL1xuICBpc011dGVkKCkge1xuICAgIHJldHVybiB0aGlzLm11dGVkXztcbiAgfVxuXG4gIC8qKiBAcHJpdmF0ZSAqL1xuICBvblJlZ2lzdGVyXygpIHtcbiAgICBpZiAodGhpcy5yZXF1aXJlc0F1dG9GdWxsc2NyZWVuXygpKSB7XG4gICAgICB0aGlzLm1hbmFnZXJfLnJlZ2lzdGVyRm9yQXV0b0Z1bGxzY3JlZW4odGhpcyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNEb2NrYWJsZV8oKSkge1xuICAgICAgdGhpcy5tYW5hZ2VyXy5yZWdpc3RlckZvckRvY2tpbmcodGhpcyk7XG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVWaXNpYmlsaXR5KCk7XG4gICAgaWYgKHRoaXMuaGFzQXV0b3BsYXkpIHtcbiAgICAgIHRoaXMuYXV0b3BsYXlWaWRlb0J1aWx0XygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgaXNEb2NrYWJsZV8oKSB7XG4gICAgcmV0dXJuIHRoaXMudmlkZW8uZWxlbWVudC5oYXNBdHRyaWJ1dGUoVmlkZW9BdHRyaWJ1dGVzLkRPQ0spO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICByZXF1aXJlc0F1dG9GdWxsc2NyZWVuXygpIHtcbiAgICBjb25zdCB7ZWxlbWVudH0gPSB0aGlzLnZpZGVvO1xuICAgIGlmICh0aGlzLnZpZGVvLnByZWltcGxlbWVudHNBdXRvRnVsbHNjcmVlbigpIHx8XG4gICAgICAgICFlbGVtZW50Lmhhc0F0dHJpYnV0ZShWaWRlb0F0dHJpYnV0ZXMuUk9UQVRFX1RPX0ZVTExTQ1JFRU4pKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB1c2VyKCkuYXNzZXJ0KHRoaXMudmlkZW8uaXNJbnRlcmFjdGl2ZSgpLFxuICAgICAgICAnT25seSBpbnRlcmFjdGl2ZSB2aWRlb3MgYXJlIGFsbG93ZWQgdG8gZW50ZXIgZnVsbHNjcmVlbiBvbiByb3RhdGUuICcgK1xuICAgICAgICAnU2V0IHRoZSBgY29udHJvbHNgIGF0dHJpYnV0ZSBvbiAlcyB0byBlbmFibGUuJyxcbiAgICAgICAgZWxlbWVudCk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGJhY2sgZm9yIHdoZW4gdGhlIHZpZGVvIHN0YXJ0cyBwbGF5aW5nXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB2aWRlb1BsYXllZF8oKSB7XG4gICAgdGhpcy5pc1BsYXlpbmdfID0gdHJ1ZTtcblxuICAgIGlmICh0aGlzLmdldFBsYXlpbmdTdGF0ZSgpID09IFBsYXlpbmdTdGF0ZXMuUExBWUlOR19NQU5VQUwpIHtcbiAgICAgIHRoaXMuZmlyc3RQbGF5RXZlbnRPck5vb3BfKCk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnZpZGVvLnByZWltcGxlbWVudHNNZWRpYVNlc3Npb25BUEkoKSkge1xuICAgICAgY29uc3QgcGxheUhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMudmlkZW8ucGxheSgvKmlzQXV0b3BsYXkqLyBmYWxzZSk7XG4gICAgICB9O1xuICAgICAgY29uc3QgcGF1c2VIYW5kbGVyID0gKCkgPT4ge1xuICAgICAgICB0aGlzLnZpZGVvLnBhdXNlKCk7XG4gICAgICB9O1xuICAgICAgLy8gVXBkYXRlIHRoZSBtZWRpYSBzZXNzaW9uXG4gICAgICBzZXRNZWRpYVNlc3Npb24odGhpcy5hbXBkb2NfLCB0aGlzLm1ldGFkYXRhXywgcGxheUhhbmRsZXIsIHBhdXNlSGFuZGxlcik7XG4gICAgfVxuXG4gICAgdGhpcy5hY3Rpb25TZXNzaW9uTWFuYWdlcl8uYmVnaW5TZXNzaW9uKCk7XG4gICAgaWYgKHRoaXMuaXNWaXNpYmxlXykge1xuICAgICAgdGhpcy52aXNpYmlsaXR5U2Vzc2lvbk1hbmFnZXJfLmJlZ2luU2Vzc2lvbigpO1xuICAgIH1cbiAgICBhbmFseXRpY3NFdmVudCh0aGlzLCBWaWRlb0FuYWx5dGljc0V2ZW50cy5QTEFZKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBmb3Igd2hlbiB0aGUgdmlkZW8gaGFzIGJlZW4gcGF1c2VkXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB2aWRlb1BhdXNlZF8oKSB7XG4gICAgYW5hbHl0aWNzRXZlbnQodGhpcywgVmlkZW9BbmFseXRpY3NFdmVudHMuUEFVU0UpO1xuICAgIHRoaXMuaXNQbGF5aW5nXyA9IGZhbHNlO1xuXG4gICAgLy8gUHJldmVudCBkb3VibGUtdHJpZ2dlciBvZiBzZXNzaW9uIGlmIHZpZGVvIGlzIGF1dG9wbGF5IGFuZCB0aGUgdmlkZW9cbiAgICAvLyBpcyBwYXVzZWQgYnkgYSB0aGUgdXNlciBzY3JvbGxpbmcgdGhlIHZpZGVvIG91dCBvZiB2aWV3LlxuICAgIGlmICghdGhpcy5wYXVzZUNhbGxlZEJ5QXV0b3BsYXlfKSB7XG4gICAgICB0aGlzLmFjdGlvblNlc3Npb25NYW5hZ2VyXy5lbmRTZXNzaW9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIHJlc2V0IHRoZSBmbGFnXG4gICAgICB0aGlzLnBhdXNlQ2FsbGVkQnlBdXRvcGxheV8gPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGJhY2sgZm9yIHdoZW4gdGhlIHZpZGVvIGhhcyBlbmRlZFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdmlkZW9FbmRlZF8oKSB7XG4gICAgYW5hbHl0aWNzRXZlbnQodGhpcywgVmlkZW9BbmFseXRpY3NFdmVudHMuRU5ERUQpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIHRoZSB2aWRlbyBpcyBsb2FkZWQgYW5kIGNhbiBwbGF5LlxuICAgKi9cbiAgdmlkZW9Mb2FkZWQoKSB7XG4gICAgdGhpcy5sb2FkZWRfID0gdHJ1ZTtcblxuICAgIHRoaXMuaW50ZXJuYWxFbGVtZW50XyA9IGdldEludGVybmFsVmlkZW9FbGVtZW50Rm9yKHRoaXMudmlkZW8uZWxlbWVudCk7XG5cbiAgICB0aGlzLmZpbGxNZWRpYVNlc3Npb25NZXRhZGF0YV8oKTtcblxuICAgIHRoaXMudXBkYXRlVmlzaWJpbGl0eSgpO1xuICAgIGlmICh0aGlzLmlzVmlzaWJsZV8pIHtcbiAgICAgIC8vIEhhbmRsZXMgdGhlIGNhc2Ugd2hlbiB0aGUgdmlkZW8gYmVjb21lcyB2aXNpYmxlIGJlZm9yZSBsb2FkaW5nXG4gICAgICB0aGlzLmxvYWRlZFZpZGVvVmlzaWJpbGl0eUNoYW5nZWRfKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIHByb3ZpZGVkIG1ldGFkYXRhIGFuZCBmaWxscyBpbiBtaXNzaW5nIGZpZWxkc1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZmlsbE1lZGlhU2Vzc2lvbk1ldGFkYXRhXygpIHtcbiAgICBpZiAodGhpcy52aWRlby5wcmVpbXBsZW1lbnRzTWVkaWFTZXNzaW9uQVBJKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy52aWRlby5nZXRNZXRhZGF0YSgpKSB7XG4gICAgICB0aGlzLm1ldGFkYXRhXyA9IG1hcChcbiAgICAgICAgICAvKiogQHR5cGUgeyEuLi9tZWRpYXNlc3Npb24taGVscGVyLk1ldGFkYXRhRGVmfSAqL1xuICAgICAgICAgICh0aGlzLnZpZGVvLmdldE1ldGFkYXRhKCkpXG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IGRvYyA9IHRoaXMuYW1wZG9jXy53aW4uZG9jdW1lbnQ7XG5cbiAgICBpZiAoIXRoaXMubWV0YWRhdGFfLmFydHdvcmsgfHwgdGhpcy5tZXRhZGF0YV8uYXJ0d29yay5sZW5ndGggPT0gMCkge1xuICAgICAgY29uc3QgcG9zdGVyVXJsID0gcGFyc2VTY2hlbWFJbWFnZShkb2MpXG4gICAgICAgICAgICAgICAgICAgICAgICB8fCBwYXJzZU9nSW1hZ2UoZG9jKVxuICAgICAgICAgICAgICAgICAgICAgICAgfHwgcGFyc2VGYXZpY29uKGRvYyk7XG5cbiAgICAgIGlmIChwb3N0ZXJVcmwpIHtcbiAgICAgICAgdGhpcy5tZXRhZGF0YV8uYXJ0d29yayA9IFt7XG4gICAgICAgICAgJ3NyYyc6IHBvc3RlclVybCxcbiAgICAgICAgfV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLm1ldGFkYXRhXy50aXRsZSkge1xuICAgICAgY29uc3QgdGl0bGUgPSB0aGlzLnZpZGVvLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0aXRsZScpXG4gICAgICAgICAgICAgICAgICAgIHx8IHRoaXMudmlkZW8uZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnKVxuICAgICAgICAgICAgICAgICAgICB8fCB0aGlzLmludGVybmFsRWxlbWVudF8uZ2V0QXR0cmlidXRlKCd0aXRsZScpXG4gICAgICAgICAgICAgICAgICAgIHx8IHRoaXMuaW50ZXJuYWxFbGVtZW50Xy5nZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnKVxuICAgICAgICAgICAgICAgICAgICB8fCBkb2MudGl0bGU7XG4gICAgICBpZiAodGl0bGUpIHtcbiAgICAgICAgdGhpcy5tZXRhZGF0YV8udGl0bGUgPSB0aXRsZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gdmlzaWJpbGl0eSBvZiBhIHZpZGVvIGNoYW5nZXMuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB2aWRlb1Zpc2liaWxpdHlDaGFuZ2VkXygpIHtcbiAgICBpZiAodGhpcy5sb2FkZWRfKSB7XG4gICAgICB0aGlzLmxvYWRlZFZpZGVvVmlzaWJpbGl0eUNoYW5nZWRfKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE9ubHkgY2FsbGVkIHdoZW4gdmlzaWJpbGl0eSBvZiBhIGxvYWRlZCB2aWRlbyBjaGFuZ2VzLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgbG9hZGVkVmlkZW9WaXNpYmlsaXR5Q2hhbmdlZF8oKSB7XG4gICAgaWYgKCFTZXJ2aWNlcy52aWV3ZXJGb3JEb2ModGhpcy5hbXBkb2NfKS5pc1Zpc2libGUoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnN1cHBvcnRzQXV0b3BsYXlfKCkudGhlbihzdXBwb3J0c0F1dG9wbGF5ID0+IHtcbiAgICAgIGNvbnN0IGNhbkF1dG9wbGF5ID0gdGhpcy5oYXNBdXRvcGxheSAmJlxuICAgICAgICAgICF0aGlzLnVzZXJJbnRlcmFjdGVkKCk7XG5cbiAgICAgIGlmIChjYW5BdXRvcGxheSAmJiBzdXBwb3J0c0F1dG9wbGF5KSB7XG4gICAgICAgIHRoaXMuYXV0b3BsYXlMb2FkZWRWaWRlb1Zpc2liaWxpdHlDaGFuZ2VkXygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5ub25BdXRvcGxheUxvYWRlZFZpZGVvVmlzaWJpbGl0eUNoYW5nZWRfKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKiBBdXRvcGxheSBCZWhhdmlvdXIgKi9cblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gYW4gYXV0b3BsYXkgdmlkZW8gaXMgYnVpbHQuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBhdXRvcGxheVZpZGVvQnVpbHRfKCkge1xuXG4gICAgLy8gSGlkZSBjb250cm9scyB1bnRpbCB3ZSBrbm93IGlmIGF1dG9wbGF5IGlzIHN1cHBvcnRlZCwgb3RoZXJ3aXNlIGhpZGluZ1xuICAgIC8vIGFuZCBzaG93aW5nIHRoZSBjb250cm9scyBxdWlja2x5IGJlY29tZXMgYSBiYWQgdXNlciBleHBlcmllbmNlIGZvciB0aGVcbiAgICAvLyBjb21tb24gY2FzZSB3aGVyZSBhdXRvcGxheSBpcyBzdXBwb3J0ZWQuXG4gICAgaWYgKHRoaXMudmlkZW8uaXNJbnRlcmFjdGl2ZSgpKSB7XG4gICAgICB0aGlzLnZpZGVvLmhpZGVDb250cm9scygpO1xuICAgIH1cblxuICAgIHRoaXMuc3VwcG9ydHNBdXRvcGxheV8oKS50aGVuKHN1cHBvcnRzQXV0b3BsYXkgPT4ge1xuICAgICAgaWYgKCFzdXBwb3J0c0F1dG9wbGF5ICYmIHRoaXMudmlkZW8uaXNJbnRlcmFjdGl2ZSgpKSB7XG4gICAgICAgIC8vIEF1dG9wbGF5IGlzIG5vdCBzdXBwb3J0ZWQsIHNob3cgdGhlIGNvbnRyb2xzIHNvIHVzZXIgY2FuIG1hbnVhbGx5XG4gICAgICAgIC8vIGluaXRpYXRlIHBsYXliYWNrLlxuICAgICAgICB0aGlzLnZpZGVvLnNob3dDb250cm9scygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIE9ubHkgbXV0ZWQgdmlkZW9zIGFyZSBhbGxvd2VkIHRvIGF1dG9wbGF5XG4gICAgICB0aGlzLnZpZGVvLm11dGUoKTtcblxuICAgICAgdGhpcy5pbnN0YWxsQXV0b3BsYXlBcnRpZmFjdHNfKCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogSW5zdGFsbHMgYXV0b3BsYXkgYW5pbWF0aW9uIGFuZCBpbnRlcmFjdGlvbiBtYXNrIHdoZW4gaW50ZXJhY3RpdmUuXG4gICAqIFRoZSBhbmltYXRlZCBpY29uIGlzIGFwcGVuZGVkIGFsd2F5cywgYnV0IG9ubHkgZGlzcGxheWVkIGJ5IENTUyB3aGVuXG4gICAqIGBjb250cm9sc2AgaXMgc2V0LiBTZWUgYHZpZGVvLWF1dG9wbGF5LmNzc2AuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBpbnN0YWxsQXV0b3BsYXlBcnRpZmFjdHNfKCkge1xuICAgIGNvbnN0IHt2aWRlb30gPSB0aGlzO1xuICAgIGNvbnN0IHtlbGVtZW50LCB3aW59ID0gdGhpcy52aWRlbztcblxuICAgIGlmIChlbGVtZW50Lmhhc0F0dHJpYnV0ZShWaWRlb0F0dHJpYnV0ZXMuTk9fQVVESU8pIHx8XG4gICAgICAgIGVsZW1lbnQuc2lnbmFscygpLmdldChWaWRlb1NlcnZpY2VTaWduYWxzLlVTRVJfSU5URVJBQ1RFRCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBhbmltYXRpb24gPSByZW5kZXJJY29uKHdpbiwgZWxlbWVudCk7XG5cbiAgICAvKiogQHBhcmFtIHtib29sZWFufSBpc1BsYXlpbmcgKi9cbiAgICBjb25zdCB0b2dnbGVBbmltYXRpb24gPSBpc1BsYXlpbmcgPT4ge1xuICAgICAgdmlkZW8ubXV0YXRlRWxlbWVudCgoKSA9PiB7XG4gICAgICAgIGFuaW1hdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdhbXAtdmlkZW8tZXEtcGxheScsIGlzUGxheWluZyk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdmlkZW8ubXV0YXRlRWxlbWVudCgoKSA9PiB7XG4gICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGFuaW1hdGlvbik7XG4gICAgfSk7XG5cbiAgICBjb25zdCB1bmxpc3RlbmVycyA9IFtcbiAgICAgIGxpc3RlbihlbGVtZW50LCBWaWRlb0V2ZW50cy5QQVVTRSwgKCkgPT4gdG9nZ2xlQW5pbWF0aW9uKGZhbHNlKSksXG4gICAgICBsaXN0ZW4oZWxlbWVudCwgVmlkZW9FdmVudHMuUExBWUlORywgKCkgPT4gdG9nZ2xlQW5pbWF0aW9uKHRydWUpKSxcbiAgICBdO1xuXG4gICAgdmlkZW8uc2lnbmFscygpLndoZW5TaWduYWwoVmlkZW9TZXJ2aWNlU2lnbmFscy5VU0VSX0lOVEVSQUNURUQpLnRoZW4oKCkgPT4ge1xuICAgICAgY29uc3Qge3ZpZGVvfSA9IHRoaXM7XG4gICAgICBjb25zdCB7ZWxlbWVudH0gPSB2aWRlbztcbiAgICAgIHRoaXMuZmlyc3RQbGF5RXZlbnRPck5vb3BfKCk7XG4gICAgICBpZiAodmlkZW8uaXNJbnRlcmFjdGl2ZSgpKSB7XG4gICAgICAgIHZpZGVvLnNob3dDb250cm9scygpO1xuICAgICAgfVxuICAgICAgdmlkZW8udW5tdXRlKCk7XG4gICAgICB1bmxpc3RlbmVycy5mb3JFYWNoKHVubGlzdGVuZXIgPT4ge1xuICAgICAgICB1bmxpc3RlbmVyKCk7XG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGFuaW1hdGlvbiA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcignLmFtcC12aWRlby1lcScpO1xuICAgICAgY29uc3QgbWFzayA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcignaS1hbXBodG1sLXZpZGVvLW1hc2snKTtcbiAgICAgIGlmIChhbmltYXRpb24pIHtcbiAgICAgICAgcmVtb3ZlRWxlbWVudChhbmltYXRpb24pO1xuICAgICAgfVxuICAgICAgaWYgKG1hc2spIHtcbiAgICAgICAgcmVtb3ZlRWxlbWVudChtYXNrKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmICghdmlkZW8uaXNJbnRlcmFjdGl2ZSgpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgbWFzayA9IHJlbmRlckludGVyYWN0aW9uT3ZlcmxheSh3aW4sIGVsZW1lbnQpO1xuXG4gICAgLyoqIEBwYXJhbSB7c3RyaW5nfSBkaXNwbGF5ICovXG4gICAgY29uc3Qgc2V0TWFza0Rpc3BsYXkgPSBkaXNwbGF5ID0+IHtcbiAgICAgIHZpZGVvLm11dGF0ZUVsZW1lbnQoKCkgPT4ge1xuICAgICAgICBzZXRTdHlsZShtYXNrLCAnZGlzcGxheScsIGRpc3BsYXkpO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHZpZGVvLmhpZGVDb250cm9scygpO1xuXG4gICAgdmlkZW8ubXV0YXRlRWxlbWVudCgoKSA9PiB7XG4gICAgICBlbGVtZW50LmFwcGVuZENoaWxkKG1hc2spO1xuICAgIH0pO1xuXG4gICAgW1xuICAgICAgbGlzdGVuKG1hc2ssICdjbGljaycsICgpID0+IHVzZXJJbnRlcmFjdGVkV2l0aCh2aWRlbykpLFxuICAgICAgbGlzdGVuKGVsZW1lbnQsIFZpZGVvRXZlbnRzLkFEX1NUQVJULCAoKSA9PiBzZXRNYXNrRGlzcGxheSgnbm9uZScpKSxcbiAgICAgIGxpc3RlbihlbGVtZW50LCBWaWRlb0V2ZW50cy5BRF9FTkQsICgpID0+IHNldE1hc2tEaXNwbGF5KCdibG9jaycpKSxcbiAgICBdLmZvckVhY2godW5saXN0ZW5lciA9PiB1bmxpc3RlbmVycy5wdXNoKHVubGlzdGVuZXIpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiB2aXNpYmlsaXR5IG9mIGEgbG9hZGVkIGF1dG9wbGF5IHZpZGVvIGNoYW5nZXMuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBhdXRvcGxheUxvYWRlZFZpZGVvVmlzaWJpbGl0eUNoYW5nZWRfKCkge1xuICAgIGlmICghdGhpcy5hbGxvd0F1dG9wbGF5Xykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodGhpcy5pc1Zpc2libGVfKSB7XG4gICAgICB0aGlzLnZpc2liaWxpdHlTZXNzaW9uTWFuYWdlcl8uYmVnaW5TZXNzaW9uKCk7XG4gICAgICB0aGlzLnZpZGVvLnBsYXkoLyphdXRvcGxheSovIHRydWUpO1xuICAgICAgdGhpcy5wbGF5Q2FsbGVkQnlBdXRvcGxheV8gPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy5pc1BsYXlpbmdfKSB7XG4gICAgICAgIHRoaXMudmlzaWJpbGl0eVNlc3Npb25NYW5hZ2VyXy5lbmRTZXNzaW9uKCk7XG4gICAgICB9XG4gICAgICB0aGlzLnZpZGVvLnBhdXNlKCk7XG4gICAgICB0aGlzLnBhdXNlQ2FsbGVkQnlBdXRvcGxheV8gPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiB2aXNpYmlsaXR5IG9mIGEgbG9hZGVkIG5vbi1hdXRvcGxheSB2aWRlbyBjaGFuZ2VzLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgbm9uQXV0b3BsYXlMb2FkZWRWaWRlb1Zpc2liaWxpdHlDaGFuZ2VkXygpIHtcbiAgICBpZiAodGhpcy5pc1Zpc2libGVfKSB7XG4gICAgICB0aGlzLnZpc2liaWxpdHlTZXNzaW9uTWFuYWdlcl8uYmVnaW5TZXNzaW9uKCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmlzUGxheWluZ18pIHtcbiAgICAgIHRoaXMudmlzaWJpbGl0eVNlc3Npb25NYW5hZ2VyXy5lbmRTZXNzaW9uKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCBieSBhbGwgcG9zc2libGUgZXZlbnRzIHRoYXQgbWlnaHQgY2hhbmdlIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSB2aWRlb1xuICAgKiBzdWNoIGFzIHNjcm9sbGluZyBvciB7QGxpbmsgLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvRXZlbnRzI1ZJU0lCSUxJVFl9LlxuICAgKiBAcGFyYW0gez9ib29sZWFuPX0gb3B0X2ZvcmNlVmlzaWJsZVxuICAgKiBAcGFja2FnZVxuICAgKi9cbiAgdXBkYXRlVmlzaWJpbGl0eShvcHRfZm9yY2VWaXNpYmxlKSB7XG4gICAgY29uc3Qgd2FzVmlzaWJsZSA9IHRoaXMuaXNWaXNpYmxlXztcblxuICAgIGlmIChvcHRfZm9yY2VWaXNpYmxlKSB7XG4gICAgICB0aGlzLmlzVmlzaWJsZV8gPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB7ZWxlbWVudH0gPSB0aGlzLnZpZGVvO1xuICAgICAgY29uc3QgcmF0aW8gPSBlbGVtZW50LmdldEludGVyc2VjdGlvbkNoYW5nZUVudHJ5KCkuaW50ZXJzZWN0aW9uUmF0aW87XG4gICAgICB0aGlzLmlzVmlzaWJsZV8gPVxuICAgICAgICAgICghaXNGaW5pdGVOdW1iZXIocmF0aW8pID8gMCA6IHJhdGlvKSA+PVxuICAgICAgICAgICAgTUlOX1ZJU0lCSUxJVFlfUkFUSU9fRk9SX0FVVE9QTEFZO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzVmlzaWJsZV8gIT0gd2FzVmlzaWJsZSkge1xuICAgICAgdGhpcy52aWRlb1Zpc2liaWxpdHlDaGFuZ2VkXygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIHZpZGVvIGlzIHBhdXNlZCBvciBwbGF5aW5nIGFmdGVyIHRoZSB1c2VyIGludGVyYWN0ZWRcbiAgICogd2l0aCBpdCBvciBwbGF5aW5nIHRocm91Z2ggYXV0b3BsYXlcbiAgICogQHJldHVybiB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0gUGxheWluZ1N0YXRlc1xuICAgKi9cbiAgZ2V0UGxheWluZ1N0YXRlKCkge1xuICAgIGlmICghdGhpcy5pc1BsYXlpbmdfKSB7XG4gICAgICByZXR1cm4gUGxheWluZ1N0YXRlcy5QQVVTRUQ7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNQbGF5aW5nX1xuICAgICAgICYmIHRoaXMucGxheUNhbGxlZEJ5QXV0b3BsYXlfXG4gICAgICAgJiYgIXRoaXMudXNlckludGVyYWN0ZWQoKSkge1xuICAgICAgcmV0dXJuIFBsYXlpbmdTdGF0ZXMuUExBWUlOR19BVVRPO1xuICAgIH1cblxuICAgIHJldHVybiBQbGF5aW5nU3RhdGVzLlBMQVlJTkdfTUFOVUFMO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgd2hldGhlciB0aGUgdmlkZW8gd2FzIGludGVyYWN0ZWQgd2l0aCBvciBub3RcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIHVzZXJJbnRlcmFjdGVkKCkge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLnZpZGVvLnNpZ25hbHMoKS5nZXQoVmlkZW9TZXJ2aWNlU2lnbmFscy5VU0VSX0lOVEVSQUNURUQpICE9IG51bGwpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbGxlY3RzIGEgc25hcHNob3Qgb2YgdGhlIGN1cnJlbnQgdmlkZW8gc3RhdGUgZm9yIHZpZGVvIGFuYWx5dGljc1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvQW5hbHl0aWNzRGV0YWlsc0RlZj59XG4gICAqL1xuICBnZXRBbmFseXRpY3NEZXRhaWxzKCkge1xuICAgIGNvbnN0IHt2aWRlb30gPSB0aGlzO1xuICAgIHJldHVybiB0aGlzLnN1cHBvcnRzQXV0b3BsYXlfKCkudGhlbihzdXBwb3J0c0F1dG9wbGF5ID0+IHtcbiAgICAgIGNvbnN0IHt3aWR0aCwgaGVpZ2h0fSA9IHZpZGVvLmVsZW1lbnQuZ2V0TGF5b3V0Qm94KCk7XG4gICAgICBjb25zdCBhdXRvcGxheSA9IHRoaXMuaGFzQXV0b3BsYXkgJiYgc3VwcG9ydHNBdXRvcGxheTtcbiAgICAgIGNvbnN0IHBsYXllZFJhbmdlcyA9IHZpZGVvLmdldFBsYXllZFJhbmdlcygpO1xuICAgICAgY29uc3QgcGxheWVkVG90YWwgPSBwbGF5ZWRSYW5nZXMucmVkdWNlKFxuICAgICAgICAgIChhY2MsIHJhbmdlKSA9PiBhY2MgKyByYW5nZVsxXSAtIHJhbmdlWzBdLCAwKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgJ2F1dG9wbGF5JzogYXV0b3BsYXksXG4gICAgICAgICdjdXJyZW50VGltZSc6IHZpZGVvLmdldEN1cnJlbnRUaW1lKCksXG4gICAgICAgICdkdXJhdGlvbic6IHZpZGVvLmdldER1cmF0aW9uKCksXG4gICAgICAgIC8vIFRPRE8oY3ZpYWxpeik6IGFkZCBmdWxsc2NyZWVuXG4gICAgICAgICdoZWlnaHQnOiBoZWlnaHQsXG4gICAgICAgICdpZCc6IHZpZGVvLmVsZW1lbnQuaWQsXG4gICAgICAgICdtdXRlZCc6IHRoaXMubXV0ZWRfLFxuICAgICAgICAncGxheWVkVG90YWwnOiBwbGF5ZWRUb3RhbCxcbiAgICAgICAgJ3BsYXllZFJhbmdlc0pzb24nOiBKU09OLnN0cmluZ2lmeShwbGF5ZWRSYW5nZXMpLFxuICAgICAgICAnc3RhdGUnOiB0aGlzLmdldFBsYXlpbmdTdGF0ZSgpLFxuICAgICAgICAnd2lkdGgnOiB3aWR0aCxcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IUFtcEVsZW1lbnR9IHZpZGVvXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHJlc3RyaWN0ZWRcbiAqL1xuZnVuY3Rpb24gc3VwcG9ydHNGdWxsc2NyZWVuVmlhQXBpKHZpZGVvKSB7XG4gIC8vIFRPRE8oYWxhbm9yb3pjbyk6IERldGVybWluZSB0aGlzIHZpYSBhIGZsYWcgaW4gdGhlIGNvbXBvbmVudCBpdHNlbGYuXG4gIHJldHVybiAhISh7XG4gICAgJ2FtcC1kYWlseW1vdGlvbic6IHRydWUsXG4gICAgJ2FtcC1pbWEtdmlkZW8nOiB0cnVlLFxuICB9W3ZpZGVvLnRhZ05hbWUudG9Mb3dlckNhc2UoKV0pO1xufVxuXG5cbi8qKiBNYW5hZ2VzIHJvdGF0ZS10by1mdWxsc2NyZWVuIHZpZGVvLiAqL1xuZXhwb3J0IGNsYXNzIEF1dG9GdWxsc2NyZWVuTWFuYWdlciB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4vYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAgICogQHBhcmFtIHshLi92aWRlby1zZXJ2aWNlLWludGVyZmFjZS5WaWRlb1NlcnZpY2VJbnRlcmZhY2V9IG1hbmFnZXJcbiAgICovXG4gIGNvbnN0cnVjdG9yKGFtcGRvYywgbWFuYWdlcikge1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IS4vdmlkZW8tc2VydmljZS1pbnRlcmZhY2UuVmlkZW9TZXJ2aWNlSW50ZXJmYWNlfSAqL1xuICAgIHRoaXMubWFuYWdlcl8gPSBtYW5hZ2VyO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IS4vYW1wZG9jLWltcGwuQW1wRG9jfSAqL1xuICAgIHRoaXMuYW1wZG9jXyA9IGFtcGRvYztcblxuICAgIC8qKiBAcHJpdmF0ZSB7Py4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9ICovXG4gICAgdGhpcy5jdXJyZW50bHlJbkZ1bGxzY3JlZW5fID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7Py4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9ICovXG4gICAgdGhpcy5jdXJyZW50bHlDZW50ZXJlZF8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IUFycmF5PCEuLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmPn0gKi9cbiAgICB0aGlzLmVudHJpZXNfID0gW107XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtmdW5jdGlvbigpfSAqL1xuICAgIHRoaXMuYm91bmRTZWxlY3RCZXN0Q2VudGVyZWRfID0gKCkgPT4gdGhpcy5zZWxlY3RCZXN0Q2VudGVyZWRJblBvcnRyYWl0XygpO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqL1xuICAgIHRoaXMuYm91bmRJbmNsdWRlT25seVBsYXlpbmdfID0gdmlkZW8gPT5cbiAgICAgIHRoaXMuZ2V0UGxheWluZ1N0YXRlXyh2aWRlbykgPT0gUGxheWluZ1N0YXRlcy5QTEFZSU5HX01BTlVBTDtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9IGFcbiAgICAgKiBAcGFyYW0geyEuLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSBiXG4gICAgICogQHJldHVybiB7bnVtYmVyfVxuICAgICAqL1xuICAgIHRoaXMuYm91bmRDb21wYXJlRW50cmllc18gPSAoYSwgYikgPT4gdGhpcy5jb21wYXJlRW50cmllc18oYSwgYik7XG5cbiAgICB0aGlzLmluc3RhbGxPcmllbnRhdGlvbk9ic2VydmVyXygpO1xuICAgIHRoaXMuaW5zdGFsbEZ1bGxzY3JlZW5MaXN0ZW5lcl8oKTtcbiAgfVxuXG4gIC8qKiBAcGFyYW0geyFWaWRlb0VudHJ5fSBlbnRyeSAqL1xuICByZWdpc3RlcihlbnRyeSkge1xuICAgIGNvbnN0IHt2aWRlb30gPSBlbnRyeTtcbiAgICBjb25zdCB7ZWxlbWVudH0gPSB2aWRlbztcblxuICAgIGlmICghdGhpcy5jYW5GdWxsc2NyZWVuXyhlbGVtZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZW50cmllc18ucHVzaCh2aWRlbyk7XG5cbiAgICBsaXN0ZW4oZWxlbWVudCwgVmlkZW9FdmVudHMuUEFVU0UsIHRoaXMuYm91bmRTZWxlY3RCZXN0Q2VudGVyZWRfKTtcbiAgICBsaXN0ZW4oZWxlbWVudCwgVmlkZW9FdmVudHMuUExBWUlORywgdGhpcy5ib3VuZFNlbGVjdEJlc3RDZW50ZXJlZF8pO1xuICAgIGxpc3RlbihlbGVtZW50LCBWaWRlb0V2ZW50cy5FTkRFRCwgdGhpcy5ib3VuZFNlbGVjdEJlc3RDZW50ZXJlZF8pO1xuXG4gICAgdmlkZW8uc2lnbmFscygpLndoZW5TaWduYWwoVmlkZW9TZXJ2aWNlU2lnbmFscy5VU0VSX0lOVEVSQUNURUQpXG4gICAgICAgIC50aGVuKHRoaXMuYm91bmRTZWxlY3RCZXN0Q2VudGVyZWRfKTtcblxuICAgIC8vIFNldCBhbHdheXNcbiAgICB0aGlzLnNlbGVjdEJlc3RDZW50ZXJlZEluUG9ydHJhaXRfKCk7XG4gIH1cblxuICAvKiogQHByaXZhdGUgKi9cbiAgaW5zdGFsbEZ1bGxzY3JlZW5MaXN0ZW5lcl8oKSB7XG4gICAgY29uc3Qgcm9vdCA9IHRoaXMuYW1wZG9jXy5nZXRSb290Tm9kZSgpO1xuICAgIGNvbnN0IGV4aXRIYW5kbGVyID0gKCkgPT4gdGhpcy5vbkZ1bGxzY3JlZW5FeGl0XygpO1xuICAgIGxpc3Rlbihyb290LCAnd2Via2l0ZnVsbHNjcmVlbmNoYW5nZScsIGV4aXRIYW5kbGVyKTtcbiAgICBsaXN0ZW4ocm9vdCwgJ21vemZ1bGxzY3JlZW5jaGFuZ2UnLCBleGl0SGFuZGxlcik7XG4gICAgbGlzdGVuKHJvb3QsICdmdWxsc2NyZWVuY2hhbmdlJywgZXhpdEhhbmRsZXIpO1xuICAgIGxpc3Rlbihyb290LCAnTVNGdWxsc2NyZWVuQ2hhbmdlJywgZXhpdEhhbmRsZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICAgKi9cbiAgaXNJbkxhbmRzY2FwZSgpIHtcbiAgICByZXR1cm4gaXNMYW5kc2NhcGUodGhpcy5hbXBkb2NfLndpbik7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshQW1wRWxlbWVudH0gdmlkZW9cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGNhbkZ1bGxzY3JlZW5fKHZpZGVvKSB7XG4gICAgLy8gU2FmYXJpIGFuZCBpT1MgY2FuIG9ubHkgZnVsbHNjcmVlbiA8dmlkZW8+IGVsZW1lbnRzIGRpcmVjdGx5LiBJbiBjYXNlc1xuICAgIC8vIHdoZXJlIHRoZSBwbGF5ZXIgY29tcG9uZW50IGlzIGltcGxlbWVudGVkIHZpYSBhbiA8aWZyYW1lPiwgd2UgbmVlZCB0b1xuICAgIC8vIHJlbHkgb24gYSBwb3N0TWVzc2FnZSBBUEkgdG8gZnVsbHNjcmVlbi4gU3VjaCBhbiBBUEkgaXMgbm90IG5lY2Vzc2FyaWx5XG4gICAgLy8gcHJvdmlkZWQgYnkgZXZlcnkgcGxheWVyLlxuICAgIGNvbnN0IGludGVybmFsRWxlbWVudCA9IGdldEludGVybmFsVmlkZW9FbGVtZW50Rm9yKHZpZGVvKTtcbiAgICBpZiAoaW50ZXJuYWxFbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PSAndmlkZW8nKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgY29uc3QgcGxhdGZvcm0gPSBTZXJ2aWNlcy5wbGF0Zm9ybUZvcih0aGlzLmFtcGRvY18ud2luKTtcbiAgICBpZiAoIShwbGF0Zm9ybS5pc0lvcygpIHx8IHBsYXRmb3JtLmlzU2FmYXJpKCkpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHN1cHBvcnRzRnVsbHNjcmVlblZpYUFwaSh2aWRlbyk7XG4gIH1cblxuICAvKiogQHByaXZhdGUgKi9cbiAgb25GdWxsc2NyZWVuRXhpdF8oKSB7XG4gICAgdGhpcy5jdXJyZW50bHlJbkZ1bGxzY3JlZW5fID0gbnVsbDtcbiAgfVxuXG4gIC8qKiBAcHJpdmF0ZSAqL1xuICBpbnN0YWxsT3JpZW50YXRpb25PYnNlcnZlcl8oKSB7XG4gICAgLy8gVE9ETyhhbGFub3JvemNvKSBVcGRhdGUgYmFzZWQgb24gc3VwcG9ydFxuICAgIGNvbnN0IHt3aW59ID0gdGhpcy5hbXBkb2NfO1xuICAgIGNvbnN0IHtzY3JlZW59ID0gd2luO1xuICAgIC8vIENocm9tZSBjb25zaWRlcnMgJ29yaWVudGF0aW9uY2hhbmdlJyB0byBiZSBhbiB1bnRydXN0ZWQgZXZlbnQsIGJ1dFxuICAgIC8vICdjaGFuZ2UnIG9uIHNjcmVlbi5vcmllbnRhdGlvbiBpcyBjb25zaWRlcmVkIGEgdXNlciBpbnRlcmFjdGlvbi5cbiAgICAvLyBXZSBzdGlsbCBuZWVkIHRvIGxpc3RlbiB0byAnb3JpZW50YXRpb25jaGFuZ2UnIG9uIENocm9tZSBpbiBvcmRlciB0b1xuICAgIC8vIGV4aXQgZnVsbHNjcmVlbiBzaW5jZSAnY2hhbmdlJyBkb2VzIG5vdCBmaXJlIGluIHRoaXMgY2FzZS5cbiAgICBpZiAoc2NyZWVuICYmICdvcmllbnRhdGlvbicgaW4gc2NyZWVuKSB7XG4gICAgICBjb25zdCBvcmllbnQgPSAvKiogQHR5cGUgeyFTY3JlZW5PcmllbnRhdGlvbn0gKi8gKHNjcmVlbi5vcmllbnRhdGlvbik7XG4gICAgICBsaXN0ZW4ob3JpZW50LCAnY2hhbmdlJywgKCkgPT4gdGhpcy5vblJvdGF0aW9uXygpKTtcbiAgICB9XG4gICAgLy8gaU9TIFNhZmFyaSBkb2VzIG5vdCBoYXZlIHNjcmVlbi5vcmllbnRhdGlvbiBidXQgY2xhc3NpZmllc1xuICAgIC8vICdvcmllbnRhdGlvbmNoYW5nZScgYXMgYSB1c2VyIGludGVyYWN0aW9uLlxuICAgIGxpc3Rlbih3aW4sICdvcmllbnRhdGlvbmNoYW5nZScsICgpID0+IHRoaXMub25Sb3RhdGlvbl8oKSk7XG4gIH1cblxuICAvKiogQHByaXZhdGUgKi9cbiAgb25Sb3RhdGlvbl8oKSB7XG4gICAgaWYgKHRoaXMuaXNJbkxhbmRzY2FwZSgpKSB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50bHlDZW50ZXJlZF8gIT0gbnVsbCkge1xuICAgICAgICB0aGlzLmVudGVyXyh0aGlzLmN1cnJlbnRseUNlbnRlcmVkXyk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0aGlzLmN1cnJlbnRseUluRnVsbHNjcmVlbl8pIHtcbiAgICAgIHRoaXMuZXhpdF8odGhpcy5jdXJyZW50bHlJbkZ1bGxzY3JlZW5fKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGVudGVyXyh2aWRlbykge1xuICAgIGNvbnN0IHBsYXRmb3JtID0gU2VydmljZXMucGxhdGZvcm1Gb3IodGhpcy5hbXBkb2NfLndpbik7XG5cbiAgICB0aGlzLmN1cnJlbnRseUluRnVsbHNjcmVlbl8gPSB2aWRlbztcblxuICAgIGlmIChwbGF0Zm9ybS5pc0FuZHJvaWQoKSAmJiBwbGF0Zm9ybS5pc0Nocm9tZSgpKSB7XG4gICAgICAvLyBDaHJvbWUgb24gQW5kcm9pZCBzb21laG93IGtub3dzIHdoYXQgd2UncmUgZG9pbmcgYW5kIGV4ZWN1dGVzIGEgbmljZVxuICAgICAgLy8gdHJhbnNpdGlvbiBieSBkZWZhdWx0LiBEZWxlZ2F0aW5nIHRvIGJyb3dzZXIuXG4gICAgICB2aWRlby5mdWxsc2NyZWVuRW50ZXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnNjcm9sbEludG9JZk5vdFZpc2libGVfKHZpZGVvKVxuICAgICAgICAudGhlbigoKSA9PiB2aWRlby5mdWxsc2NyZWVuRW50ZXIoKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGV4aXRfKHZpZGVvKSB7XG4gICAgdGhpcy5jdXJyZW50bHlJbkZ1bGxzY3JlZW5fID0gbnVsbDtcblxuICAgIHRoaXMuc2Nyb2xsSW50b0lmTm90VmlzaWJsZV8odmlkZW8sICdjZW50ZXInKVxuICAgICAgICAudGhlbigoKSA9PiB2aWRlby5mdWxsc2NyZWVuRXhpdCgpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTY3JvbGxzIHRvIGEgdmlkZW8gaWYgaXQncyBub3QgaW4gdmlldy5cbiAgICogQHBhcmFtIHshLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICogQHBhcmFtIHs/c3RyaW5nPX0gb3B0UG9zXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzY3JvbGxJbnRvSWZOb3RWaXNpYmxlXyh2aWRlbywgb3B0UG9zID0gbnVsbCkge1xuICAgIGNvbnN0IHtlbGVtZW50fSA9IHZpZGVvO1xuICAgIGNvbnN0IHZpZXdwb3J0ID0gdGhpcy5nZXRWaWV3cG9ydF8oKTtcblxuICAgIGNvbnN0IGR1cmF0aW9uID0gMzAwO1xuICAgIGNvbnN0IGN1cnZlID0gJ2Vhc2UtaW4nO1xuXG4gICAgcmV0dXJuIHRoaXMub25jZU9yaWVudGF0aW9uQ2hhbmdlc18oKS50aGVuKCgpID0+IHtcbiAgICAgIGNvbnN0IHtib3VuZGluZ0NsaWVudFJlY3R9ID0gZWxlbWVudC5nZXRJbnRlcnNlY3Rpb25DaGFuZ2VFbnRyeSgpO1xuICAgICAgY29uc3Qge3RvcCwgYm90dG9tfSA9IGJvdW5kaW5nQ2xpZW50UmVjdDtcbiAgICAgIGNvbnN0IHZoID0gdmlld3BvcnQuZ2V0U2l6ZSgpLmhlaWdodDtcbiAgICAgIGNvbnN0IGZ1bGx5VmlzaWJsZSA9IHRvcCA+PSAwICYmIGJvdHRvbSA8PSB2aDtcbiAgICAgIGlmIChmdWxseVZpc2libGUpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgfVxuICAgICAgY29uc3QgcG9zID0gb3B0UG9zID8gZGV2KCkuYXNzZXJ0U3RyaW5nKG9wdFBvcykgOlxuICAgICAgICBib3R0b20gPiB2aCA/ICdib3R0b20nIDogJ3RvcCc7XG4gICAgICByZXR1cm4gdmlld3BvcnQuYW5pbWF0ZVNjcm9sbEludG9WaWV3KGVsZW1lbnQsIGR1cmF0aW9uLCBjdXJ2ZSwgcG9zKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBAcHJpdmF0ZSAqL1xuICBnZXRWaWV3cG9ydF8oKSB7XG4gICAgcmV0dXJuIFNlcnZpY2VzLnZpZXdwb3J0Rm9yRG9jKHRoaXMuYW1wZG9jXyk7XG4gIH1cblxuICAvKiogQHByaXZhdGUgQHJldHVybiB7IVByb21pc2V9ICovXG4gIG9uY2VPcmllbnRhdGlvbkNoYW5nZXNfKCkge1xuICAgIGNvbnN0IG1hZ2ljTnVtYmVyID0gMzMwO1xuICAgIHJldHVybiBTZXJ2aWNlcy50aW1lckZvcih0aGlzLmFtcGRvY18ud2luKS5wcm9taXNlKG1hZ2ljTnVtYmVyKTtcbiAgfVxuXG4gIC8qKiBAcHJpdmF0ZSAqL1xuICBzZWxlY3RCZXN0Q2VudGVyZWRJblBvcnRyYWl0XygpIHtcbiAgICBpZiAodGhpcy5pc0luTGFuZHNjYXBlKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRseUNlbnRlcmVkXztcbiAgICB9XG5cbiAgICB0aGlzLmN1cnJlbnRseUNlbnRlcmVkXyA9IG51bGw7XG5cbiAgICBjb25zdCBzZWxlY3RlZCA9IHRoaXMuZW50cmllc19cbiAgICAgICAgLmZpbHRlcih0aGlzLmJvdW5kSW5jbHVkZU9ubHlQbGF5aW5nXylcbiAgICAgICAgLnNvcnQodGhpcy5ib3VuZENvbXBhcmVFbnRyaWVzXylbMF07XG5cbiAgICBpZiAoc2VsZWN0ZWQpIHtcbiAgICAgIGNvbnN0IHtpbnRlcnNlY3Rpb25SYXRpb30gPSBzZWxlY3RlZC5lbGVtZW50LmdldEludGVyc2VjdGlvbkNoYW5nZUVudHJ5KCk7XG4gICAgICBpZiAoaW50ZXJzZWN0aW9uUmF0aW8gPj0gTUlOX1ZJU0lCSUxJVFlfUkFUSU9fRk9SX0FVVE9QTEFZKSB7XG4gICAgICAgIHRoaXMuY3VycmVudGx5Q2VudGVyZWRfID0gc2VsZWN0ZWQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuY3VycmVudGx5Q2VudGVyZWRfO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbXBhcmVzIHR3byB2aWRlb3MgaW4gb3JkZXIgdG8gc29ydCB0aGVtIGJ5IFwiYmVzdCBjZW50ZXJlZFwiLlxuICAgKiBAcGFyYW0geyEuLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSBhXG4gICAqIEBwYXJhbSB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9IGJcbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKi9cbiAgY29tcGFyZUVudHJpZXNfKGEsIGIpIHtcbiAgICBjb25zdCB7XG4gICAgICBpbnRlcnNlY3Rpb25SYXRpbzogcmF0aW9BLFxuICAgICAgYm91bmRpbmdDbGllbnRSZWN0OiByZWN0QSxcbiAgICB9ID0gYS5lbGVtZW50LmdldEludGVyc2VjdGlvbkNoYW5nZUVudHJ5KCk7XG4gICAgY29uc3Qge1xuICAgICAgaW50ZXJzZWN0aW9uUmF0aW86IHJhdGlvQixcbiAgICAgIGJvdW5kaW5nQ2xpZW50UmVjdDogcmVjdEIsXG4gICAgfSA9IGIuZWxlbWVudC5nZXRJbnRlcnNlY3Rpb25DaGFuZ2VFbnRyeSgpO1xuXG4gICAgLy8gUHJpb3JpdGl6ZSBieSBob3cgdmlzaWJsZSB0aGV5IGFyZSwgd2l0aCBhIHRvbGVyYW5jZSBvZiAxMCVcbiAgICBjb25zdCByYXRpb1RvbGVyYW5jZSA9IDAuMTtcbiAgICBjb25zdCByYXRpb0RlbHRhID0gcmF0aW9BIC0gcmF0aW9CO1xuICAgIGlmIChNYXRoLmFicyhyYXRpb0RlbHRhKSA+IHJhdGlvVG9sZXJhbmNlKSB7XG4gICAgICByZXR1cm4gcmF0aW9EZWx0YTtcbiAgICB9XG5cbiAgICAvLyBQcmlvcml0aXplIGJ5IGRpc3RhbmNlIGZyb20gY2VudGVyLlxuICAgIGNvbnN0IHZpZXdwb3J0ID0gU2VydmljZXMudmlld3BvcnRGb3JEb2ModGhpcy5hbXBkb2NfKTtcbiAgICBjb25zdCBjZW50ZXJBID0gY2VudGVyRGlzdCh2aWV3cG9ydCwgcmVjdEEpO1xuICAgIGNvbnN0IGNlbnRlckIgPSBjZW50ZXJEaXN0KHZpZXdwb3J0LCByZWN0Qik7XG4gICAgaWYgKGNlbnRlckEgPCBjZW50ZXJCIHx8XG4gICAgICAgIGNlbnRlckEgPiBjZW50ZXJCKSB7XG4gICAgICByZXR1cm4gY2VudGVyQSAtIGNlbnRlckI7XG4gICAgfVxuXG4gICAgLy8gRXZlcnl0aGluZyBlbHNlIGZhaWxpbmcsIGNob29zZSB0aGUgaGlnaGVzdCBlbGVtZW50LlxuICAgIHJldHVybiByZWN0QS50b3AgLSByZWN0Qi50b3A7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICogQHJldHVybiB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0gUGxheWluZ1N0YXRlc1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0UGxheWluZ1N0YXRlXyh2aWRlbykge1xuICAgIHJldHVybiB0aGlzLm1hbmFnZXJfLmdldFBsYXlpbmdTdGF0ZShcbiAgICAgICAgLyoqIEB0eXBlIHshLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvSW50ZXJmYWNlfSAqLyAodmlkZW8pKTtcbiAgfVxufVxuXG5cbi8qKlxuICogQHBhcmFtIHshLi92aWV3cG9ydC92aWV3cG9ydC1pbXBsLlZpZXdwb3J0fSB2aWV3cG9ydFxuICogQHBhcmFtIHt7dG9wOiBudW1iZXIsIGhlaWdodDogbnVtYmVyfX0gcmVjdFxuICogQHJldHVybiB7bnVtYmVyfVxuICovXG5mdW5jdGlvbiBjZW50ZXJEaXN0KHZpZXdwb3J0LCByZWN0KSB7XG4gIGNvbnN0IGNlbnRlclkgPSByZWN0LnRvcCArIChyZWN0LmhlaWdodCAvIDIpO1xuICBjb25zdCBjZW50ZXJWaWV3cG9ydCA9IHZpZXdwb3J0LmdldFNpemUoKS5oZWlnaHQgLyAyO1xuICByZXR1cm4gTWF0aC5hYnMoY2VudGVyWSAtIGNlbnRlclZpZXdwb3J0KTtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc0xhbmRzY2FwZSh3aW4pIHtcbiAgaWYgKHdpbi5zY3JlZW4gJiYgJ29yaWVudGF0aW9uJyBpbiB3aW4uc2NyZWVuKSB7XG4gICAgcmV0dXJuIHN0YXJ0c1dpdGgod2luLnNjcmVlbi5vcmllbnRhdGlvbi50eXBlLCAnbGFuZHNjYXBlJyk7XG4gIH1cbiAgcmV0dXJuIE1hdGguYWJzKHdpbi5vcmllbnRhdGlvbikgPT0gOTA7XG59XG5cblxuXG4vKipcbiAqIEBwYXJhbSB7IVZpZGVvRW50cnl9IGVudHJ5XG4gKiBAcGFyYW0geyFWaWRlb0FuYWx5dGljc0V2ZW50c30gZXZlbnRUeXBlXG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+PX0gb3B0X3ZhcnMgQSBtYXAgb2YgdmFycyBhbmQgdGhlaXIgdmFsdWVzLlxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gYW5hbHl0aWNzRXZlbnQoZW50cnksIGV2ZW50VHlwZSwgb3B0X3ZhcnMpIHtcbiAgY29uc3Qge3ZpZGVvfSA9IGVudHJ5O1xuICBjb25zdCBkZXRhaWxzUHJvbWlzZSA9IG9wdF92YXJzID8gUHJvbWlzZS5yZXNvbHZlKG9wdF92YXJzKSA6XG4gICAgZW50cnkuZ2V0QW5hbHl0aWNzRGV0YWlscygpO1xuXG4gIGRldGFpbHNQcm9taXNlLnRoZW4oZGV0YWlscyA9PiB7XG4gICAgdmlkZW8uZWxlbWVudC5kaXNwYXRjaEN1c3RvbUV2ZW50KFxuICAgICAgICBldmVudFR5cGUsIGRldGFpbHMpO1xuICB9KTtcbn1cblxuXG4vKiogQHBhcmFtIHshTm9kZXwhLi9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvYyAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGxWaWRlb01hbmFnZXJGb3JEb2Mobm9kZU9yRG9jKSB7XG4gIC8vIFRPRE8oYWxhbm9yb3pjbywgIzEzNjc0KTogUmVuYW1lIHRvIGBpbnN0YWxsVmlkZW9TZXJ2aWNlRm9yRG9jYFxuICAvLyBUT0RPKGFsYW5vcm96Y28sICMxMzY3NCk6IFJlbmFtZSB0byBgdmlkZW8tc2VydmljZWBcbiAgcmVnaXN0ZXJTZXJ2aWNlQnVpbGRlckZvckRvYyhub2RlT3JEb2MsICd2aWRlby1tYW5hZ2VyJywgYW1wZG9jID0+IHtcbiAgICBjb25zdCB7d2lufSA9IGFtcGRvYztcbiAgICBpZiAoVmlkZW9TZXJ2aWNlU3luYy5zaG91bGRCZVVzZWRJbih3aW4pKSB7XG4gICAgICByZXR1cm4gbmV3IFZpZGVvU2VydmljZVN5bmMoYW1wZG9jKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBWaWRlb01hbmFnZXIoYW1wZG9jKTtcbiAgfSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG4vKiogQHR5cGVkZWYgey4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0FuYWx5dGljc0RldGFpbHNEZWZ9ICovXG5sZXQgVmlkZW9BbmFseXRpY3NEZXRhaWxzRGVmOyAvLyBhbGlhcyBmb3IgbGluZSBsZW5ndGhcblxuXG4vKiogQGludGVyZmFjZSAqL1xuZXhwb3J0IGNsYXNzIFZpZGVvU2VydmljZUludGVyZmFjZSB7XG5cbiAgLyoqIEBwYXJhbSB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0gdW51c2VkVmlkZW8gKi9cbiAgcmVnaXN0ZXIodW51c2VkVmlkZW8pIHt9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGN1cnJlbnQgYW5hbHl0aWNzIGRldGFpbHMgZm9yIHRoZSBnaXZlbiB2aWRlby5cbiAgICogRmFpbHMgc2lsZW50bHkgaWYgdGhlIHZpZGVvIGlzIG5vdCByZWdpc3RlcmVkLlxuICAgKiBAcGFyYW0geyFBbXBFbGVtZW50fSB1bnVzZWRWaWRlb1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhVmlkZW9BbmFseXRpY3NEZXRhaWxzRGVmPnwhUHJvbWlzZTx2b2lkPn1cbiAgICovXG4gIGdldEFuYWx5dGljc0RldGFpbHModW51c2VkVmlkZW8pIHt9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0gdW51c2VkVmlkZW9cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlzTXV0ZWQodW51c2VkVmlkZW8pIHt9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0gdW51c2VkVmlkZW9cbiAgICogQHJldHVybiB7IS4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0gUGxheWluZ1N0YXRlc1xuICAgKi9cbiAgZ2V0UGxheWluZ1N0YXRlKHVudXNlZFZpZGVvKSB7fVxufVxuXG5cbi8qKiBAZW51bSB7c3RyaW5nfSAqL1xuZXhwb3J0IGNvbnN0IFZpZGVvU2VydmljZVNpZ25hbHMgPSB7XG4gIFVTRVJfSU5URVJBQ1RFRDogJ3VzZXItaW50ZXJhY3RlZCcsXG4gIEFVVE9QTEFZX0RFTEVHQVRFRDogJ2F1dG9wbGF5LWRlbGVnYXRlZCcsXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7QXV0b3BsYXksIEF1dG9wbGF5RXZlbnRzfSBmcm9tICcuL3ZpZGVvL2F1dG9wbGF5JztcbmltcG9ydCB7UGxheWluZ1N0YXRlcywgVmlkZW9BdHRyaWJ1dGVzLCBWaWRlb0V2ZW50c30gZnJvbSAnLi4vdmlkZW8taW50ZXJmYWNlJztcbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4uL3NlcnZpY2VzJztcbmltcG9ydCB7VmlkZW9TZXJ2aWNlU2lnbmFsc30gZnJvbSAnLi92aWRlby1zZXJ2aWNlLWludGVyZmFjZSc7XG5pbXBvcnQge2Rldn0gZnJvbSAnLi4vbG9nJztcbmltcG9ydCB7Z2V0QW1wZG9jfSBmcm9tICcuLi9zZXJ2aWNlJztcbmltcG9ydCB7Z2V0RWxlbWVudFNlcnZpY2VGb3JEb2N9IGZyb20gJy4uL2VsZW1lbnQtc2VydmljZSc7XG5pbXBvcnQge2lzRXhwZXJpbWVudE9ufSBmcm9tICcuLi9leHBlcmltZW50cyc7XG5pbXBvcnQge2xpc3RlbiwgbGlzdGVuT25jZVByb21pc2V9IGZyb20gJy4uL2V2ZW50LWhlbHBlcic7XG5pbXBvcnQge29uY2V9IGZyb20gJy4uL3V0aWxzL2Z1bmN0aW9uJztcblxuXG4vKiogQHByaXZhdGUgQGNvbnN0IHtzdHJpbmd9ICovXG5jb25zdCBFWFRFTlNJT04gPSAnYW1wLXZpZGVvLXNlcnZpY2UnO1xuXG5cbi8qKiBAcHJpdmF0ZSBAY29uc3Qge3N0cmluZ30gKi9cbmNvbnN0IFRBRyA9ICd2aWRlby1zZXJ2aWNlJztcblxuXG4vKipcbiAqIEB0eXBlZGVmXG4gKiB7Li4vLi4vZXh0ZW5zaW9ucy9hbXAtdmlkZW8tc2VydmljZS8wLjEvYW1wLXZpZGVvLXNlcnZpY2UuVmlkZW9TZXJ2aWNlfVxuICovXG5sZXQgVmlkZW9TZXJ2aWNlRGVmOyAvLyBhbGlhcyBmb3IgbGluZSBsZW5ndGguXG5cblxuLyoqXG4gKiBQcm92aWRlcyB1bmlmaWVkIGJlaGF2aW9yIGZvciBhbGwgdmlkZW9zIHJlZ2FyZGxlc3Mgb2YgaW1wbGVtZW50YXRpb24uXG4gKlxuICogVGhpcyBzZXJ2aWNlIGlzIGEgZmHDp2FkZSBhcm91bmQgYW4gYXN5bmMtbG9hZGVkIGltcGxlbWVudGF0aW9uLlxuICogU2VlIHtAbGluayBBbXBWaWRlb1NlcnZpY2V9IGZvciB0aGUgdW5kZXJseWluZyBzZXJ2aWNlLlxuICpcbiAqIFRoaXMgY28tZWV4aXN0cyB3aXRoIGBWaWRlb01hbmFnZXJgIChkZXByZWNhdGVkKSB3aGlsZSB0aGUgaW1wbGVtZW50YXRpb25cbiAqIGlzIG1pZ3JhdGVkLlxuICpcbiAqIEBpbXBsZW1lbnRzIHsuL3ZpZGVvLXNlcnZpY2UtaW50ZXJmYWNlLlZpZGVvU2VydmljZUludGVyZmFjZX1cbiAqL1xuZXhwb3J0IGNsYXNzIFZpZGVvU2VydmljZVN5bmMge1xuXG4gIC8qKiBAcGFyYW0geyEuL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jICovXG4gIGNvbnN0cnVjdG9yKGFtcGRvYykge1xuICAgIGNvbnN0IHt3aW59ID0gYW1wZG9jO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IS4vYW1wZG9jLWltcGwuQW1wRG9jfSAqL1xuICAgIHRoaXMuYW1wZG9jXyA9IGFtcGRvYztcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFQcm9taXNlPCFWaWRlb1NlcnZpY2VEZWY+fSAgKi9cbiAgICB0aGlzLmFzeW5jSW1wbF8gPSBWaWRlb1NlcnZpY2VTeW5jLnZpZGVvU2VydmljZUZvcih3aW4sIGFtcGRvYyk7XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHshQXV0b3BsYXl9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLmdldEF1dG9wbGF5XyA9IG9uY2UoKCkgPT4gbmV3IEF1dG9wbGF5KHRoaXMuYW1wZG9jXykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICAgKi9cbiAgc3RhdGljIHNob3VsZEJlVXNlZEluKHdpbikge1xuICAgIHJldHVybiBpc0V4cGVyaW1lbnRPbih3aW4sICd2aWRlby1zZXJ2aWNlJyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhVmlkZW9TZXJ2aWNlRGVmPn1cbiAgICogQHZpc2libGVGb3JUZXN0aW5nXG4gICAqL1xuICBzdGF0aWMgdmlkZW9TZXJ2aWNlRm9yKHdpbiwgbm9kZU9yRG9jKSB7XG4gICAgLy8gTm90IGV4cG9zZWQgaW4gLi4vc2VydmljZXMuanMgc2luY2Ugd2UgZG9uJ3Qgd2FudCBvdGhlciBtb2R1bGVzIHRvXG4gICAgLy8gaW5zdGFudGlhdGUgb3IgYWNjZXNzIHRoZSBzZXJ2aWNlLlxuICAgIGNvbnN0IGV4dGVuc2lvbnMgPSBTZXJ2aWNlcy5leHRlbnNpb25zRm9yKHdpbik7XG4gICAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKG5vZGVPckRvYyk7XG4gICAgcmV0dXJuIGV4dGVuc2lvbnMuaW5zdGFsbEV4dGVuc2lvbkZvckRvYyhhbXBkb2MsIEVYVEVOU0lPTilcbiAgICAgICAgLnRoZW4oKCkgPT4gLyoqIEB0eXBlIHshUHJvbWlzZTwhVmlkZW9TZXJ2aWNlRGVmPn0gKi8gKFxuICAgICAgICAgIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGFtcGRvYywgJ3ZpZGVvLXNlcnZpY2UnLCBFWFRFTlNJT04pKSk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHJlZ2lzdGVyKHZpZGVvKSB7XG4gICAgdGhpcy5hc3luY0ltcGxfLnRoZW4oaW1wbCA9PlxuICAgICAgaW1wbC5yZWdpc3Rlcih2aWRlbykpO1xuXG4gICAgdGhpcy5tYXliZUluc3RhbGxBdXRvcGxheV8odmlkZW8pO1xuXG4gICAgbmV3IFZpZGVvRW50cnkodmlkZW8pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSAgeyEuLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSB2aWRlb1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgbWF5YmVJbnN0YWxsQXV0b3BsYXlfKHZpZGVvKSB7XG4gICAgaWYgKCF2aWRlby5lbGVtZW50Lmhhc0F0dHJpYnV0ZShWaWRlb0F0dHJpYnV0ZXMuQVVUT1BMQVkpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5nZXRBdXRvcGxheV8oKS5yZWdpc3Rlcih2aWRlbyk7XG5cbiAgICBjb25zdCBhdXRvcGxheURlbGVnYXRlZCA9IFZpZGVvU2VydmljZVNpZ25hbHMuQVVUT1BMQVlfREVMRUdBVEVEO1xuICAgIHZpZGVvLnNpZ25hbHMoKS53aGVuU2lnbmFsKGF1dG9wbGF5RGVsZWdhdGVkKS50aGVuKCgpID0+IHtcbiAgICAgIHRoaXMuZ2V0QXV0b3BsYXlfKCkuZGVsZWdhdGUodmlkZW8uZWxlbWVudCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshQW1wRWxlbWVudHwhLi4vYmFzZS1lbGVtZW50LkJhc2VFbGVtZW50fSB2aWRlb1xuICAgKi9cbiAgc3RhdGljIGRlbGVnYXRlQXV0b3BsYXkodmlkZW8pIHtcbiAgICB2aWRlby5zaWduYWxzKCkuc2lnbmFsKFZpZGVvU2VydmljZVNpZ25hbHMuQVVUT1BMQVlfREVMRUdBVEVEKTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgZ2V0QW5hbHl0aWNzRGV0YWlscyh2aWRlbykge1xuICAgIHJldHVybiB0aGlzLmFzeW5jSW1wbF8udGhlbihpbXBsID0+XG4gICAgICBpbXBsLmdldEFuYWx5dGljc0RldGFpbHModmlkZW8pKTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgaXNNdXRlZCh1bnVzZWRWaWRlbykge1xuICAgIGRldigpLndhcm4oVEFHLCAnaXNNdXRlZCBpcyBub3QgaW1wbGVtZW50ZWQnKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGdldFBsYXlpbmdTdGF0ZSh1bnVzZWRWaWRlbykge1xuICAgIGRldigpLndhcm4oVEFHLCAnZ2V0UGxheWluZ1N0YXRlIGlzIG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgIHJldHVybiBQbGF5aW5nU3RhdGVzLlBBVVNFRDtcbiAgfVxufVxuXG5cbi8qKiBAdmlzaWJsZUZvclRlc3RpbmcgKi9cbmV4cG9ydCBjbGFzcyBWaWRlb0VudHJ5IHtcblxuICAvKiogQHBhcmFtIHshLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW8gKi9cbiAgY29uc3RydWN0b3IodmlkZW8pIHtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyEuLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSAqL1xuICAgIHRoaXMudmlkZW9fID0gdmlkZW87XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshQW1wRWxlbWVudH0gKi9cbiAgICB0aGlzLmVsZW1lbnRfID0gdmlkZW8uZWxlbWVudDtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFQcm9taXNlfSAqL1xuICAgIHRoaXMubG9hZFByb21pc2VfID0gbGlzdGVuT25jZVByb21pc2UodGhpcy5lbGVtZW50XywgVmlkZW9FdmVudHMuTE9BRCk7XG5cbiAgICB0aGlzLmxpc3RlblRvQXV0b3BsYXlFdmVudHNfKCk7XG5cbiAgICBzZXRWaWRlb0NvbXBvbmVudENsYXNzbmFtZSh0aGlzLmVsZW1lbnRfKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRcbiAgICogQHBhcmFtIHtmdW5jdGlvbighRXZlbnQpfSBoYW5kbGVyXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBsaXN0ZW5PbkxvYWRfKGV2ZW50LCBoYW5kbGVyKSB7XG4gICAgbGlzdGVuKHRoaXMuZWxlbWVudF8sIGV2ZW50LCBlID0+IHtcbiAgICAgIHRoaXMubG9hZFByb21pc2VfLnRoZW4oKCkgPT4ge1xuICAgICAgICBoYW5kbGVyKGUpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKiogQHByaXZhdGUgKi9cbiAgbGlzdGVuVG9BdXRvcGxheUV2ZW50c18oKSB7XG4gICAgLy8gVE9ETyhhbGFub3JvemNvKTogS2VlcCB0cmFjayBvZiBzZXNzaW9uXG4gICAgdGhpcy5saXN0ZW5PbkxvYWRfKEF1dG9wbGF5RXZlbnRzLlBMQVksICgpID0+IHtcbiAgICAgIHRoaXMudmlkZW9fLnBsYXkoLyogYXV0byAqLyB0cnVlKTtcbiAgICB9KTtcblxuICAgIHRoaXMubGlzdGVuT25Mb2FkXyhBdXRvcGxheUV2ZW50cy5QQVVTRSwgKCkgPT4ge1xuICAgICAgdGhpcy52aWRlb18ucGF1c2UoKTtcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFZpZGVvQ29tcG9uZW50Q2xhc3NuYW1lKGVsZW1lbnQpIHtcbiAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdpLWFtcGh0bWwtdmlkZW8tY29tcG9uZW50Jyk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtPYnNlcnZhYmxlfSBmcm9tICcuLi9vYnNlcnZhYmxlJztcblxuXG5leHBvcnQgY2xhc3MgVmlkZW9TZXNzaW9uTWFuYWdlciB7XG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIFZpZGVvU2Vzc2lvbk1hbmFnZXIuXG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICB0aGlzLmlzU2Vzc2lvbkFjdGl2ZV8gPSBmYWxzZTtcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMuZW5kU2Vzc2lvbk9ic2VydmFibGVfID0gbmV3IE9ic2VydmFibGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBhIGxpc3RlbmVyIHRvIGJlIG5vdGlmaWVkIHdoZW4gYSBzZXNzaW9uIGhhcyBlbmRlZFxuICAgKiBAcGFyYW0geyFGdW5jdGlvbn0gbGlzdGVuZXJcbiAgICovXG4gIG9uU2Vzc2lvbkVuZChsaXN0ZW5lcikge1xuICAgIHRoaXMuZW5kU2Vzc2lvbk9ic2VydmFibGVfLmFkZChsaXN0ZW5lcik7XG4gIH1cblxuICAvKipcbiAgICogQmVnaW4gYSBzZXNzaW9uLlxuICAgKi9cbiAgYmVnaW5TZXNzaW9uKCkge1xuICAgIHRoaXMuaXNTZXNzaW9uQWN0aXZlXyA9IHRydWU7XG4gIH1cblxuICAvKipcbiAgICogRW5kIGEgc2Vzc2lvbi5cbiAgICovXG4gIGVuZFNlc3Npb24oKSB7XG4gICAgaWYgKHRoaXMuaXNTZXNzaW9uQWN0aXZlXykge1xuICAgICAgdGhpcy5lbmRTZXNzaW9uT2JzZXJ2YWJsZV8uZmlyZSgpO1xuICAgIH1cbiAgICB0aGlzLmlzU2Vzc2lvbkFjdGl2ZV8gPSBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGN1cnJlbnQgc2Vzc2lvbiBzdGF0ZS5cbiAgICovXG4gIGlzU2Vzc2lvbkFjdGl2ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5pc1Nlc3Npb25BY3RpdmVfO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgTUlOX1ZJU0lCSUxJVFlfUkFUSU9fRk9SX0FVVE9QTEFZLFxuICBWaWRlb0V2ZW50cyxcbn0gZnJvbSAnLi4vLi4vdmlkZW8taW50ZXJmYWNlJztcbmltcG9ydCB7XG4gIFBvc2l0aW9uT2JzZXJ2ZXJGaWRlbGl0eSxcbn0gZnJvbSAnLi4vcG9zaXRpb24tb2JzZXJ2ZXIvcG9zaXRpb24tb2JzZXJ2ZXItd29ya2VyJztcbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4uLy4uL3NlcnZpY2VzJztcbmltcG9ydCB7VmlkZW9TZXJ2aWNlU2lnbmFsc30gZnJvbSAnLi4vdmlkZW8tc2VydmljZS1pbnRlcmZhY2UnO1xuaW1wb3J0IHtWaWRlb1V0aWxzfSBmcm9tICcuLi8uLi91dGlscy92aWRlbyc7XG5pbXBvcnQge2Rldn0gZnJvbSAnLi4vLi4vbG9nJztcbmltcG9ydCB7Z2V0RGF0YSwgbGlzdGVuLCBsaXN0ZW5PbmNlfSBmcm9tICcuLi8uLi9ldmVudC1oZWxwZXInO1xuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuLi8uLi9tb2RlJztcbmltcG9ydCB7Z2V0U2VydmljZUZvckRvY30gZnJvbSAnLi4vLi4vc2VydmljZSc7XG5pbXBvcnQge2h0bWxGb3J9IGZyb20gJy4uLy4uL3N0YXRpYy10ZW1wbGF0ZSc7XG5pbXBvcnQge2luc3RhbGxBdXRvcGxheVN0eWxlc0ZvckRvY30gZnJvbSAnLi9pbnN0YWxsLWF1dG9wbGF5LXN0eWxlcyc7XG5pbXBvcnQge1xuICBpbnN0YWxsUG9zaXRpb25PYnNlcnZlclNlcnZpY2VGb3JEb2MsXG59IGZyb20gJy4uL3Bvc2l0aW9uLW9ic2VydmVyL3Bvc2l0aW9uLW9ic2VydmVyLWltcGwnO1xuaW1wb3J0IHtpc0Zpbml0ZU51bWJlcn0gZnJvbSAnLi4vLi4vdHlwZXMnO1xuaW1wb3J0IHtvbmNlfSBmcm9tICcuLi8uLi91dGlscy9mdW5jdGlvbic7XG5pbXBvcnQge3JlbW92ZUVsZW1lbnR9IGZyb20gJy4uLy4uL2RvbSc7XG5cblxuLyoqIEBwcml2YXRlIEBlbnVtIHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgQXV0b3BsYXlFdmVudHMgPSB7XG4gIFBMQVk6ICdhbXA6YXV0b3BsYXknLFxuICBQQVVTRTogJ2FtcDphdXRvcGF1c2UnLFxufTtcblxuLyoqXG4gKiBAcGFyYW0geyFFbGVtZW50fSBub2RlXG4gKiBAcmV0dXJuIHshRWxlbWVudH1cbiAqL1xuZnVuY3Rpb24gY2xvbmVEZWVwKG5vZGUpIHtcbiAgcmV0dXJuIGRldigpLmFzc2VydEVsZW1lbnQobm9kZS5jbG9uZU5vZGUoLyogZGVlcCAqLyB0cnVlKSk7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFXaW5kb3csICFFbGVtZW50KTohRWxlbWVudH0gcmVuZGVyRm5cbiAqIEByZXR1cm4ge2Z1bmN0aW9uKCFXaW5kb3csICFFbGVtZW50KTohRWxlbWVudH1cbiAqL1xuZnVuY3Rpb24gcmVuZGVyT3JDbG9uZShyZW5kZXJGbikge1xuICBjb25zdCBzZWVkRm4gPSBvbmNlKHJlbmRlckZuKTtcbiAgcmV0dXJuICh3aW4sIGRvYykgPT4gY2xvbmVEZWVwKHNlZWRGbih3aW4sIGRvYykpO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshV2luZG93fSB1bnVzZWRXaW5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IURvY3VtZW50fSBlbE9yRG9jXG4gKiBAcmV0dXJuIHshRWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckludGVyYWN0aW9uT3ZlcmxheSh1bnVzZWRXaW4sIGVsT3JEb2MpIHtcbiAgY29uc3QgaHRtbCA9IGh0bWxGb3IoZWxPckRvYyk7XG4gIHJldHVybiBodG1sYDxpLWFtcGh0bWwtdmlkZW8tbWFzayBjbGFzcz1cImktYW1waHRtbC1maWxsLWNvbnRlbnRcIiByb2xlPWJ1dHRvbj5cbiAgICA8L2ktYW1waHRtbC12aWRlby1tYXNrPmA7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshRWxlbWVudHwhRG9jdW1lbnR9IGVsT3JEb2NcbiAqIEByZXR1cm4geyFFbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVySWNvbih3aW4sIGVsT3JEb2MpIHtcbiAgY29uc3QgaWNvbiA9IGh0bWxGb3IoZWxPckRvYylgPGktYW1waHRtbC12aWRlby1pY29uIGNsYXNzPVwiYW1wLXZpZGVvLWVxXCI+XG4gICAgPGRpdiBjbGFzcz1cImFtcC12aWRlby1lcS1jb2xcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJhbXAtdmlkZW8tZXEtZmlsbGVyXCI+PC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiYW1wLXZpZGVvLWVxLWZpbGxlclwiPjwvZGl2PlxuICAgIDwvZGl2PlxuICA8L2ktYW1waHRtbC12aWRlby1pY29uPmA7XG5cbiAgLy8gQ29weSBlcXVhbGl6ZXIgY29sdW1uIDR4IGFuZCBhbm5vdGF0ZSBmaWxsZXIgcG9zaXRpb25zIGZvciBhbmltYXRpb24uXG4gIGNvbnN0IGZpcnN0Q29sID0gZGV2KCkuYXNzZXJ0RWxlbWVudChpY29uLmZpcnN0RWxlbWVudENoaWxkKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICBjb25zdCBjb2wgPSBjbG9uZURlZXAoZmlyc3RDb2wpO1xuICAgIGNvbnN0IGZpbGxlcnMgPSBjb2wuY2hpbGRyZW47XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBmaWxsZXJzLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBmaWxsZXIgPSBmaWxsZXJzW2pdO1xuICAgICAgZmlsbGVyLmNsYXNzTGlzdC5hZGQoYGFtcC12aWRlby1lcS0ke2kgKyAxfS0ke2ogKyAxfWApO1xuICAgIH1cbiAgICBpY29uLmFwcGVuZENoaWxkKGNvbCk7XG4gIH1cblxuICAvLyBSZW1vdmUgc2VlZCBjb2x1bW4uXG4gIHJlbW92ZUVsZW1lbnQoZmlyc3RDb2wpO1xuXG4gIGlmIChTZXJ2aWNlcy5wbGF0Zm9ybUZvcih3aW4pLmlzSW9zKCkpIHtcbiAgICAvLyBpT1MgaXMgdW5hYmxlIHRvIHBhdXNlIGhhcmR3YXJlIGFjY2VsZXJhdGVkIGFuaW1hdGlvbnMuXG4gICAgaWNvbi5zZXRBdHRyaWJ1dGUoJ3VucGF1c2FibGUnLCAnJyk7XG4gIH1cblxuICByZXR1cm4gaWNvbjtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gdW51c2VkV2luXG4gKiBAcGFyYW0geyFFbGVtZW50fCFEb2N1bWVudH0gZWxPckRvY1xuICogQHJldHVybiB7IUVsZW1lbnR9XG4gKi9cbmNvbnN0IHJlbmRlck9yQ2xvbmVJbnRlcmFjdGlvbk92ZXJsYXkgPSByZW5kZXJPckNsb25lKHJlbmRlckludGVyYWN0aW9uT3ZlcmxheSk7XG5cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHVudXNlZFdpblxuICogQHBhcmFtIHshRWxlbWVudHwhRG9jdW1lbnR9IGVsT3JEb2NcbiAqIEByZXR1cm4geyFFbGVtZW50fVxuICovXG5jb25zdCByZW5kZXJPckNsb25lSWNvbiA9IHJlbmRlck9yQ2xvbmUocmVuZGVySWNvbik7XG5cblxuLyoqIE1hbmFnZXMgYXV0b3BsYXkgdmlkZW8uICovXG5leHBvcnQgY2xhc3MgQXV0b3BsYXkge1xuXG4gIC8qKiBAcGFyYW0geyEuLi9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvYyAqL1xuICBjb25zdHJ1Y3RvcihhbXBkb2MpIHtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyEuLi9hbXBkb2MtaW1wbC5BbXBEb2N9ICovXG4gICAgdGhpcy5hbXBkb2NfID0gYW1wZG9jO1xuXG4gICAgLyoqXG4gICAgICogQHJldHVybiB7IS4uL3Bvc2l0aW9uLW9ic2VydmVyL3Bvc2l0aW9uLW9ic2VydmVyLWltcGwuUG9zaXRpb25PYnNlcnZlcn1cbiAgICAgKiBAcmVzdHJpY3RlZFxuICAgICAqL1xuICAgIHRoaXMuZ2V0UG9zaXRpb25PYnNlcnZlcl8gPSBvbmNlKCgpID0+IHRoaXMuaW5zdGFsbFBvc2l0aW9uT2JzZXJ2ZXJfKCkpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IUFycmF5PCFBdXRvcGxheUVudHJ5Pn0gKi9cbiAgICB0aGlzLmVudHJpZXNfID0gW107XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHshUHJvbWlzZTxib29sZWFuPn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMuaXNTdXBwb3J0ZWRfID0gb25jZSgoKSA9PiB7XG4gICAgICAvLyBDYW4ndCBkZXN0cnVjdHVyZSBhcyB0aGUgY29tcGlsZXIgZXhwZWN0cyBkaXJlY3QgbWVtYmVyIGFjY2VzcyBmb3JcbiAgICAgIC8vIGBnZXRNb2RlYC5cbiAgICAgIGNvbnN0IHt3aW59ID0gdGhpcy5hbXBkb2NfO1xuICAgICAgY29uc3QgaXNMaXRlID0gZ2V0TW9kZSh3aW4pLmxpdGU7XG4gICAgICByZXR1cm4gVmlkZW9VdGlscy5pc0F1dG9wbGF5U3VwcG9ydGVkKHdpbiwgLyogaXNMaXRlTW9kZSAqLyBpc0xpdGUpO1xuICAgIH0pO1xuXG4gICAgaW5zdGFsbEF1dG9wbGF5U3R5bGVzRm9yRG9jKHRoaXMuYW1wZG9jXyk7XG4gIH1cblxuICAvKiogQHByaXZhdGUgKi9cbiAgaW5zdGFsbFBvc2l0aW9uT2JzZXJ2ZXJfKCkge1xuICAgIGluc3RhbGxQb3NpdGlvbk9ic2VydmVyU2VydmljZUZvckRvYyh0aGlzLmFtcGRvY18pO1xuICAgIC8vIE5vIGdldHRlciBpbiBzZXJ2aWNlcy5qcy5cbiAgICByZXR1cm4gKFxuICAgICAgLyoqIEB0eXBlIHtcbiAgICAgICAqICAgIS4uL3Bvc2l0aW9uLW9ic2VydmVyL3Bvc2l0aW9uLW9ic2VydmVyLWltcGwuUG9zaXRpb25PYnNlcnZlclxuICAgICAgICogfSAqLyAoZ2V0U2VydmljZUZvckRvYyh0aGlzLmFtcGRvY18sICdwb3NpdGlvbi1vYnNlcnZlcicpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICogQHJldHVybiB7IVByb21pc2U8P0F1dG9wbGF5RW50cnk+fSBgbnVsbGAgd2hlbiB1bnN1cHBvcnRlZC5cbiAgICovXG4gIHJlZ2lzdGVyKHZpZGVvKSB7XG4gICAgLy8gQ29udHJvbHMgYXJlIGhpZGRlbiBiZWZvcmUgc3VwcG9ydCBpcyBkZXRlcm1pbmVkIHRvIHByZXZlbnQgdmlzdWFsIGp1bXBcbiAgICAvLyBmb3IgdGhlIGNvbW1vbiBjYXNlIHdoZXJlIGF1dG9wbGF5IGlzIHN1cHBvcnRlZC5cbiAgICBpZiAodmlkZW8uaXNJbnRlcmFjdGl2ZSgpKSB7XG4gICAgICB2aWRlby5oaWRlQ29udHJvbHMoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5pc1N1cHBvcnRlZF8oKS50aGVuKGlzU3VwcG9ydGVkID0+IHtcbiAgICAgIGlmICghaXNTdXBwb3J0ZWQpIHtcbiAgICAgICAgLy8gRGlzYWJsZSBhdXRvcGxheVxuICAgICAgICBpZiAodmlkZW8uaXNJbnRlcmFjdGl2ZSgpKSB7XG4gICAgICAgICAgdmlkZW8uc2hvd0NvbnRyb2xzKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBlbnRyeSA9IEF1dG9wbGF5RW50cnkuY3JlYXRlKHRoaXMsIHZpZGVvKTtcbiAgICAgIHRoaXMuZW50cmllc18ucHVzaChlbnRyeSk7XG4gICAgICByZXR1cm4gZW50cnk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICAgKi9cbiAgZGVsZWdhdGUoZWxlbWVudCkge1xuICAgIGNvbnN0IGVudHJ5ID0gdGhpcy5nZXRFbnRyeUZvcl8oZWxlbWVudCk7XG4gICAgaWYgKCFlbnRyeSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBlbnRyeS5kZWxlZ2F0ZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAgICogQHJldHVybiB7P0F1dG9wbGF5RW50cnl9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRFbnRyeUZvcl8oZWxlbWVudCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5lbnRyaWVzXy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgZW50cnkgPSB0aGlzLmVudHJpZXNfW2ldO1xuICAgICAgaWYgKGVudHJ5LnZpZGVvLmVsZW1lbnQgPT0gZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gZW50cnk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cblxuLyoqIEB2aXNpYmxlRm9yVGVzdGluZyAqL1xuZXhwb3J0IGNsYXNzIEF1dG9wbGF5RW50cnkge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0geyEuLi9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICAgKiBAcGFyYW0ge1xuICAgKiAgICEuLi9wb3NpdGlvbi1vYnNlcnZlci9wb3NpdGlvbi1vYnNlcnZlci1pbXBsLlBvc2l0aW9uT2JzZXJ2ZXJcbiAgICogfSBwb3NpdGlvbk9ic2VydmVyXG4gICAqIEBwYXJhbSB7IS4uLy4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9IHZpZGVvXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhbXBkb2MsIHBvc2l0aW9uT2JzZXJ2ZXIsIHZpZGVvKSB7XG5cbiAgICAvKiogQGNvbnN0IHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gKi9cbiAgICB0aGlzLnZpZGVvID0gdmlkZW87XG5cbiAgICAvKiogQHByaXZhdGUgeyEuLi9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY30gKi9cbiAgICB0aGlzLmFtcGRvY18gPSBhbXBkb2M7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshQW1wRWxlbWVudH0gICovXG4gICAgdGhpcy5lbGVtZW50XyA9IHZpZGVvLmVsZW1lbnQ7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy5pc1Zpc2libGVfID0gZmFsc2U7XG5cbiAgICAvKiogQHByaXZhdGUgez9BcnJheTwhVW5saXN0ZW5EZWY+fSAqL1xuICAgIHRoaXMudmlzaWJpbGl0eVVubGlzdGVuZXJzXyA9IFtcbiAgICAgIHRoaXMub2JzZXJ2ZU9uXyhwb3NpdGlvbk9ic2VydmVyKSxcbiAgICAgIHRoaXMubGlzdGVuVG9WaXNpYmlsaXR5Q2hhbmdlXygpLFxuICAgIF07XG5cbiAgICAvLyBPbmx5IG11dGVkIHZpZGVvcyBhcmUgYWxsb3dlZCB0byBhdXRvcGxheVxuICAgIHZpZGVvLm11dGUoKTtcbiAgICB2aWRlby5oaWRlQ29udHJvbHMoKTtcblxuICAgIHRoaXMuYXR0YWNoQXJ0aWZhY3RzXygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUF1dG9wbGF5fSBtYW5hZ2VyXG4gICAqIEBwYXJhbSB7IS4uLy4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9IHZpZGVvXG4gICAqL1xuICBzdGF0aWMgY3JlYXRlKG1hbmFnZXIsIHZpZGVvKSB7XG4gICAgcmV0dXJuIG5ldyBBdXRvcGxheUVudHJ5KFxuICAgICAgICBtYW5hZ2VyLmFtcGRvY18sIG1hbmFnZXIuZ2V0UG9zaXRpb25PYnNlcnZlcl8oKSwgdmlkZW8pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7XG4gICAqICAgIS4uL3Bvc2l0aW9uLW9ic2VydmVyL3Bvc2l0aW9uLW9ic2VydmVyLWltcGwuUG9zaXRpb25PYnNlcnZlclxuICAgKiB9IHBvc2l0aW9uT2JzZXJ2ZXJcbiAgICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgb2JzZXJ2ZU9uXyhwb3NpdGlvbk9ic2VydmVyKSB7XG4gICAgcmV0dXJuIHBvc2l0aW9uT2JzZXJ2ZXIub2JzZXJ2ZShcbiAgICAgICAgdGhpcy5lbGVtZW50XyxcbiAgICAgICAgUG9zaXRpb25PYnNlcnZlckZpZGVsaXR5LkhJR0gsXG4gICAgICAgICgpID0+IHRoaXMub25Qb3NpdGlvbkNoYW5nZV8oKSk7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgbGlzdGVuVG9WaXNpYmlsaXR5Q2hhbmdlXygpIHtcbiAgICByZXR1cm4gbGlzdGVuKHRoaXMuZWxlbWVudF8sIFZpZGVvRXZlbnRzLlZJU0lCSUxJVFksIGUgPT4ge1xuICAgICAgY29uc3QgZGF0YSA9IGdldERhdGEoZSk7XG4gICAgICBjb25zdCBlbmZvcmNlZEJ5RXZlbnQgPSBkYXRhICYmIGRhdGFbJ3Zpc2libGUnXTtcbiAgICAgIGlmIChlbmZvcmNlZEJ5RXZlbnQgJiYgIXRoaXMuaXNWaXNpYmxlXykge1xuICAgICAgICB0aGlzLmlzVmlzaWJsZV8gPSBlbmZvcmNlZEJ5RXZlbnQ7XG4gICAgICAgIHRoaXMudHJpZ2dlcl8oLyogaXNQbGF5aW5nICovIGVuZm9yY2VkQnlFdmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMudHJpZ2dlckJ5VmlzaWJpbGl0eV8oKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxlZ2F0ZXMgYXV0b3BsYXkgc28gdGhhdCBpdCdzIHRyaWdnZXJlZCBieSBhIGRpZmZlcmVudCBtb2R1bGUuXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGRlbGVnYXRlKCkge1xuICAgIHRoaXMuZGlzYWJsZVRyaWdnZXJCeVZpc2liaWxpdHlfKCk7XG4gICAgdGhpcy52aWRlby5wYXVzZSgpO1xuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIG9uUG9zaXRpb25DaGFuZ2VfKCkge1xuICAgIHRoaXMudHJpZ2dlckJ5VmlzaWJpbGl0eV8oKTtcbiAgfVxuXG4gIC8qKiBAcHJpdmF0ZSAqL1xuICB0cmlnZ2VyQnlWaXNpYmlsaXR5XygpIHtcbiAgICBjb25zdCByYXRpbyA9IHRoaXMuZWxlbWVudF8uZ2V0SW50ZXJzZWN0aW9uQ2hhbmdlRW50cnkoKS5pbnRlcnNlY3Rpb25SYXRpbztcbiAgICBjb25zdCBpc1Zpc2libGUgPSAoIWlzRmluaXRlTnVtYmVyKHJhdGlvKSA/IDAgOiByYXRpbykgPj1cbiAgICAgICAgTUlOX1ZJU0lCSUxJVFlfUkFUSU9fRk9SX0FVVE9QTEFZO1xuICAgIGlmICh0aGlzLmlzVmlzaWJsZV8gPT0gaXNWaXNpYmxlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNWaXNpYmxlXyA9IGlzVmlzaWJsZTtcbiAgICB0aGlzLnRyaWdnZXJfKC8qIGlzUGxheWluZyAqLyBpc1Zpc2libGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNQbGF5aW5nXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB0cmlnZ2VyXyhpc1BsYXlpbmcpIHtcbiAgICB0aGlzLmVsZW1lbnRfLmRpc3BhdGNoQ3VzdG9tRXZlbnQoXG4gICAgICAgIGlzUGxheWluZyA/IEF1dG9wbGF5RXZlbnRzLlBMQVkgOiBBdXRvcGxheUV2ZW50cy5QQVVTRSk7XG4gIH1cblxuICAvKiogQHByaXZhdGUgKi9cbiAgYXR0YWNoQXJ0aWZhY3RzXygpIHtcbiAgICAvLyBUT0RPKGFsYW5vcm96Y28pOiBBRF9TVEFSVCwgQURfRU5EXG4gICAgY29uc3Qge3ZpZGVvfSA9IHRoaXM7XG4gICAgY29uc3Qgc2lnbmFscyA9IHZpZGVvLnNpZ25hbHMoKTtcbiAgICBjb25zdCB1c2VySW50ZXJhY3RlZCA9IFZpZGVvU2VydmljZVNpZ25hbHMuVVNFUl9JTlRFUkFDVEVEO1xuXG4gICAgaWYgKHNpZ25hbHMuZ2V0KHVzZXJJbnRlcmFjdGVkKSAhPSBudWxsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qge3dpbn0gPSB0aGlzLmFtcGRvY187XG5cbiAgICBjb25zdCBpY29uID0gcmVuZGVyT3JDbG9uZUljb24od2luLCB0aGlzLmVsZW1lbnRfKTtcblxuICAgIHZpZGVvLm11dGF0ZUVsZW1lbnQoKCkgPT4ge1xuICAgICAgdGhpcy5lbGVtZW50Xy5hcHBlbmRDaGlsZChpY29uKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHtlbGVtZW50fSA9IHZpZGVvO1xuICAgIGNvbnN0IHBsYXlPclBhdXNlSWNvbkFuaW0gPSB0aGlzLnBsYXlPclBhdXNlSWNvbkFuaW1fLmJpbmQodGhpcywgaWNvbik7XG5cbiAgICBjb25zdCB1bmxpc3RlbmVycyA9IFtcbiAgICAgIGxpc3RlbihlbGVtZW50LCBWaWRlb0V2ZW50cy5QTEFZSU5HLCAoKSA9PiBwbGF5T3JQYXVzZUljb25BbmltKHRydWUpKSxcbiAgICAgIGxpc3RlbihlbGVtZW50LCBWaWRlb0V2ZW50cy5QQVVTRSwgKCkgPT4gcGxheU9yUGF1c2VJY29uQW5pbShmYWxzZSkpLFxuICAgIF07XG5cbiAgICBzaWduYWxzLndoZW5TaWduYWwodXNlckludGVyYWN0ZWQpLnRoZW4oKCkgPT4ge1xuICAgICAgdW5saXN0ZW5lcnMuZm9yRWFjaCh1bmxpc3RlbiA9PiB1bmxpc3RlbigpKTtcbiAgICAgIHRoaXMub25JbnRlcmFjdGlvbl8oKTtcbiAgICB9KTtcblxuICAgIGlmICghdGhpcy52aWRlby5pc0ludGVyYWN0aXZlKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBvdmVybGF5ID0gcmVuZGVyT3JDbG9uZUludGVyYWN0aW9uT3ZlcmxheSh3aW4sIHRoaXMuZWxlbWVudF8pO1xuXG4gICAgbGlzdGVuT25jZShvdmVybGF5LCAnY2xpY2snLCAoKSA9PiBzaWduYWxzLnNpZ25hbCh1c2VySW50ZXJhY3RlZCkpO1xuXG4gICAgdmlkZW8ubXV0YXRlRWxlbWVudCgoKSA9PiB7XG4gICAgICB0aGlzLmVsZW1lbnRfLmFwcGVuZENoaWxkKG92ZXJsYXkpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIG9uSW50ZXJhY3Rpb25fKCkge1xuICAgIGNvbnN0IG1hc2sgPSB0aGlzLmVsZW1lbnRfLnF1ZXJ5U2VsZWN0b3IoJ2ktYW1waHRtbC12aWRlby1tYXNrJyk7XG4gICAgdGhpcy5kaXNhYmxlVHJpZ2dlckJ5VmlzaWJpbGl0eV8oKTtcbiAgICBpZiAobWFzaykge1xuICAgICAgcmVtb3ZlRWxlbWVudChtYXNrKTtcbiAgICB9XG4gICAgaWYgKHRoaXMudmlkZW8uaXNJbnRlcmFjdGl2ZSgpKSB7XG4gICAgICB0aGlzLnZpZGVvLnNob3dDb250cm9scygpO1xuICAgIH1cbiAgICB0aGlzLnZpZGVvLnVubXV0ZSgpO1xuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIGRpc2FibGVUcmlnZ2VyQnlWaXNpYmlsaXR5XygpIHtcbiAgICBpZiAoIXRoaXMudmlzaWJpbGl0eVVubGlzdGVuZXJzXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnZpc2liaWxpdHlVbmxpc3RlbmVyc18uZm9yRWFjaCh1bmxpc3RlbmVyID0+IHVubGlzdGVuZXIoKSk7XG4gICAgdGhpcy52aXNpYmlsaXR5VW5saXN0ZW5lcnNfID0gbnVsbDsgLy8gR0NcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBpY29uXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNQbGF5aW5nXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwbGF5T3JQYXVzZUljb25BbmltXyhpY29uLCBpc1BsYXlpbmcpIHtcbiAgICB0aGlzLnZpZGVvLm11dGF0ZUVsZW1lbnQoKCkgPT5cbiAgICAgIGljb24uY2xhc3NMaXN0LnRvZ2dsZSgnYW1wLXZpZGVvLWVxLXBsYXknLCBpc1BsYXlpbmcpKTtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQge0FjdGlvblRydXN0fSBmcm9tICcuLi8uLi9hY3Rpb24tY29uc3RhbnRzJztcbmltcG9ydCB7XG4gIFBsYXlpbmdTdGF0ZXMsXG4gIFZpZGVvQXR0cmlidXRlcyxcbiAgVmlkZW9FdmVudHMsXG59IGZyb20gJy4uLy4uL3ZpZGVvLWludGVyZmFjZSc7XG5pbXBvcnQge1xuICBQb3NpdGlvbk9ic2VydmVyLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXG59IGZyb20gJy4uL3Bvc2l0aW9uLW9ic2VydmVyL3Bvc2l0aW9uLW9ic2VydmVyLWltcGwnO1xuaW1wb3J0IHtcbiAgUG9zaXRpb25PYnNlcnZlckZpZGVsaXR5LFxufSBmcm9tICcuLi9wb3NpdGlvbi1vYnNlcnZlci9wb3NpdGlvbi1vYnNlcnZlci13b3JrZXInO1xuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi4vLi4vc2VydmljZXMnO1xuaW1wb3J0IHtjbG9zZXN0QnlTZWxlY3RvciwgaXNSVEwsIHJlbW92ZUVsZW1lbnR9IGZyb20gJy4uLy4uL2RvbSc7XG5pbXBvcnQge2NyZWF0ZUN1c3RvbUV2ZW50fSBmcm9tICcuLi8uLi9ldmVudC1oZWxwZXInO1xuLy8gU291cmNlIGZvciB0aGlzIGNvbnN0YW50IGlzIGNzcy92aWRlby1kb2NraW5nLmNzczpcbmltcG9ydCB7Y3NzVGV4dH0gZnJvbSAnLi4vLi4vLi4vYnVpbGQvdmlkZW8tZG9ja2luZy5jc3MuanMnO1xuaW1wb3J0IHtkZXYsIHVzZXJ9IGZyb20gJy4uLy4uL2xvZyc7XG5pbXBvcnQge2RpY3R9IGZyb20gJy4uLy4uL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge2dldEludGVybmFsVmlkZW9FbGVtZW50Rm9yfSBmcm9tICcuLi8uLi91dGlscy92aWRlbyc7XG5pbXBvcnQge2dldFNlcnZpY2VGb3JEb2N9IGZyb20gJy4uLy4uL3NlcnZpY2UnO1xuaW1wb3J0IHtodG1sRm9yLCBodG1sUmVmc30gZnJvbSAnLi4vLi4vc3RhdGljLXRlbXBsYXRlJztcbmltcG9ydCB7XG4gIGluc3RhbGxQb3NpdGlvbk9ic2VydmVyU2VydmljZUZvckRvYyxcbn0gZnJvbSAnLi4vcG9zaXRpb24tb2JzZXJ2ZXIvcG9zaXRpb24tb2JzZXJ2ZXItaW1wbCc7XG5pbXBvcnQge2luc3RhbGxTdHlsZXNGb3JEb2N9IGZyb20gJy4uLy4uL3N0eWxlLWluc3RhbGxlcic7XG5pbXBvcnQge2lzRmluaXRlTnVtYmVyfSBmcm9tICcuLi8uLi90eXBlcyc7XG5pbXBvcnQge2xpc3RlbiwgbGlzdGVuT25jZX0gZnJvbSAnLi4vLi4vZXZlbnQtaGVscGVyJztcbmltcG9ydCB7bWFwUmFuZ2V9IGZyb20gJy4uLy4uL3V0aWxzL21hdGgnO1xuaW1wb3J0IHttb3ZlTGF5b3V0UmVjdH0gZnJvbSAnLi4vLi4vbGF5b3V0LXJlY3QnO1xuaW1wb3J0IHtvbmNlfSBmcm9tICcuLi8uLi91dGlscy9mdW5jdGlvbic7XG5pbXBvcnQge3B4LCByZXNldFN0eWxlcywgc2V0SW1wb3J0YW50U3R5bGVzLCB0cmFuc2xhdGV9IGZyb20gJy4uLy4uL3N0eWxlJztcblxuXG4vKiogQHByaXZhdGUgQGNvbnN0IHtudW1iZXJ9ICovXG5jb25zdCBNQVJHSU5fTUFYID0gMzA7XG5cbi8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuY29uc3QgTUFSR0lOX0FSRUFfV0lEVEhfUEVSQyA9IDAuMDQ7XG5cbi8qKiBAcHJpdmF0ZSBAY29uc3Qge251bWJlcn0gKi9cbmNvbnN0IE1JTl9XSURUSCA9IDE4MDtcblxuLyoqIEBwcml2YXRlIEBjb25zdCB7bnVtYmVyfSAqL1xuY29uc3QgTUlOX1ZJRVdQT1JUX1dJRFRIID0gMzIwO1xuXG4vKiogQHByaXZhdGUgQGNvbnN0IHtudW1iZXJ9ICovXG5jb25zdCBET0NLSU5HX1RJTUVPVVQgPSAyMDA7XG5cbi8qKiBAcHJpdmF0ZSBAY29uc3Qge251bWJlcn0gKi9cbmNvbnN0IENPTlRST0xTX1RJTUVPVVQgPSAxNjAwO1xuXG4vKiogQHByaXZhdGUgQGNvbnN0IHtudW1iZXJ9ICovXG5jb25zdCBDT05UUk9MU19USU1FT1VUX0FGVEVSX0lYID0gMTAwMDtcblxuLyoqIEBwcml2YXRlIEBjb25zdCB7bnVtYmVyfSAqL1xuY29uc3QgRkxPQVRfVE9MRVJBTkNFID0gMC4wMjtcblxuLyoqIEBwcml2YXRlIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgQkFTRV9DTEFTU19OQU1FID0gJ2ktYW1waHRtbC12aWRlby1kb2NrZWQnO1xuXG4vKiogQHByaXZhdGUgQGNvbnN0IHtudW1iZXJ9ICovXG5jb25zdCBSRVZFUlRfVE9fSU5MSU5FX1JBVElPID0gMC43O1xuXG4vKiogQGVudW0gKi9cbmV4cG9ydCBjb25zdCBSZWxhdGl2ZVggPSB7TEVGVDogMCwgUklHSFQ6IDF9O1xuXG4vKiogQGVudW0gKi9cbmV4cG9ydCBjb25zdCBSZWxhdGl2ZVkgPSB7VE9QOiAwLCBCT1RUT006IDF9O1xuXG4vKiogQGVudW0gKi9cbmV4cG9ydCBjb25zdCBEaXJlY3Rpb24gPSB7VVA6IDEsIERPV046IC0xfTtcblxuLyoqIEBlbnVtIHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgQWN0aW9ucyA9IHtET0NLOiAnZG9jaycsIFVORE9DSzogJ3VuZG9jayd9O1xuXG5cbi8qKlxuICogQHN0cnVjdCBAdHlwZWRlZiB7e1xuICogICB2aWRlbzogIS4uLy4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWYsXG4gKiAgIHRhcmdldDogIURvY2tUYXJnZXREZWYsXG4gKiAgIHN0ZXA6IG51bWJlcixcbiAqICAgdHJpZ2dlcmVkRG9jazogYm9vbGVhbixcbiAqIH19XG4gKi9cbmxldCBEb2NrZWREZWY7XG5cblxuLyoqXG4gKiBAc3RydWN0IEB0eXBlZGVmIHt7XG4gKiAgIGNvbnRhaW5lcjogIUVsZW1lbnQsXG4gKiAgIGRpc21pc3NCdXR0b246ICFFbGVtZW50LFxuICogICBwbGF5QnV0dG9uOiAhRWxlbWVudCxcbiAqICAgcGF1c2VCdXR0b246ICFFbGVtZW50LFxuICogICBtdXRlQnV0dG9uOiAhRWxlbWVudCxcbiAqICAgdW5tdXRlQnV0dG9uOiAhRWxlbWVudCxcbiAqICAgZnVsbHNjcmVlbkJ1dHRvbjogIUVsZW1lbnQsXG4gKiAgIGRpc21pc3NDb250YWluZXI6ICFFbGVtZW50LFxuICogfX1cbiAqL1xubGV0IENvbnRyb2xzRGVmO1xuXG5cbi8qKiBAdHlwZWRlZiB7e3Bvc1g6ICFSZWxhdGl2ZVgsIHBvc1k6ICFSZWxhdGl2ZVl9fCFFbGVtZW50fSAqL1xubGV0IERvY2tUYXJnZXREZWY7XG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgeDogbnVtYmVyLFxuICogICB5OiBudW1iZXIsXG4gKiAgIHRhcmdldFdpZHRoOiBudW1iZXIsXG4gKiAgIHRhcmdldEhlaWdodDogbnVtYmVyLFxuICogICBpbml0aWFsWTogbnVtYmVyXG4gKiB9fVxuICovXG5sZXQgVGFyZ2V0QXJlYURlZjtcblxuXG4vKipcbiAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gKiBAcGFyYW0ge251bWJlcn0geVxuICogQHBhcmFtIHtudW1iZXJ9IHNjYWxlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmNvbnN0IHRyYW5zZm9ybSA9ICh4LCB5LCBzY2FsZSkgPT4gYHRyYW5zbGF0ZSgke3h9cHgsICR7eX1weCkgc2NhbGUoJHtzY2FsZX0pYDtcblxuXG4vKipcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGFcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGJcbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIHN3YXAoYSwgYikge1xuICBhLnNldEF0dHJpYnV0ZSgnaGlkZGVuJywgJycpO1xuICBiLnJlbW92ZUF0dHJpYnV0ZSgnaGlkZGVuJyk7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtmdW5jdGlvbiguLi4qKX0gZm5cbiAqIEByZXR1cm4ge2Z1bmN0aW9uKC4uLiopfVxuICovXG5mdW5jdGlvbiB0aHJvdHRsZUJ5QW5pbWF0aW9uRnJhbWUod2luLCBmbikge1xuICBsZXQgcnVubmluZyA9IGZhbHNlO1xuICByZXR1cm4gKC4uLmFyZ3MpID0+IHtcbiAgICBpZiAocnVubmluZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBydW5uaW5nID0gdHJ1ZTtcbiAgICB3aW4ucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgIGZuLmFwcGx5KG51bGwsIGFyZ3MpO1xuICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgIH0pO1xuICB9O1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshTW91c2VFdmVudHwhVG91Y2hFdmVudH0gZVxuICogQHJldHVybiB7e3g6IG51bWJlciwgeTogbnVtYmVyfX1cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIHBvaW50ZXJDb29yZHMoZSkge1xuICBjb25zdCBjb29yZHMgPSAoZS50b3VjaGVzKSA/IGUudG91Y2hlc1swXSA6IGU7XG4gIHJldHVybiB7XG4gICAgeDogZGV2KCkuYXNzZXJ0TnVtYmVyKCgneCcgaW4gY29vcmRzKSA/IGNvb3Jkcy54IDogY29vcmRzLmNsaWVudFgpLFxuICAgIHk6IGRldigpLmFzc2VydE51bWJlcigoJ3knIGluIGNvb3JkcykgPyBjb29yZHMueSA6IGNvb3Jkcy5jbGllbnRZKSxcbiAgfTtcbn1cblxuXG4vKipcbiAqIE1hcHMgYW4gaW50ZXJwb2xhdGlvbiBzdGVwIGluIFswLi4xXSB0byBpdHMgcG9zaXRpb24gaW4gYSByYW5nZS5cbiAqIEBwYXJhbSB7bnVtYmVyfSBzdGVwXG4gKiBAcGFyYW0ge251bWJlcn0gbWluXG4gKiBAcGFyYW0ge251bWJlcn0gbWF4XG4gKiBAcmV0dXJuIHtudW1iZXJ9XG4gKi9cbmZ1bmN0aW9uIG1hcFN0ZXAoc3RlcCwgbWluLCBtYXgpIHtcbiAgcmV0dXJuIG1hcFJhbmdlKHN0ZXAsIDAsIDEsIG1pbiwgbWF4KTtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXN0cmljdGVkXG4gKi9cbmZ1bmN0aW9uIGNvbXBsYWluQWJvdXRQb3J0cmFpdChlbGVtZW50KSB7XG4gIC8vIENvbnN0YW50IG5hbWVkIGBUQUdgIHBlciBsaW50IHJ1bGVzLlxuICBjb25zdCBUQUcgPSBlbGVtZW50LnRhZ05hbWUudG9VcHBlckNhc2UoKTtcbiAgY29uc3QgYXR0ciA9IFZpZGVvQXR0cmlidXRlcy5ET0NLO1xuICB1c2VyKCkuZXJyb3IoVEFHLFxuICAgICAgYE1pbmltaXplLXRvLWNvcm5lciAoXFxgJHthdHRyfVxcYCkgZG9lcyBub3Qgc3VwcG9ydCBwb3J0cmFpdCB2aWRlby5gLFxuICAgICAgZWxlbWVudCk7XG59XG5cblxuLy8gRnVuY3Rpb24gc2hvdWxkIGlkZWFsbHkgYmUgaW4gYGRvbS5qc2AsIGJ1dCBtb3ZpbmcgaXQgY2F1c2VzIGEgYnVuY2ggb2YgYWRzXG4vLyB0ZXN0cyB0byBmYWlsLCBmb3Igc29tZSByZWFzb24uXG4vLyBUT0RPKGFsYW5vcm96Y28pOiBNb3ZlLlxuLyoqXG4gKiBAcGFyYW0geyFPYmplY3R9IG9ialxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRWxlbWVudChvYmopIHtcbiAgcmV0dXJuIG9iai5ub2RlVHlwZSA9PSAvKiBFTEVNRU5UICovIDE7XG59XG5cblxuXG4vKiogVGltZW91dCB0aGF0IGNhbiBiZSBwb3N0cG9uZWQsIHJlcGVhdGVkIG9yIGNhbmNlbGxlZC4gKi9cbmNsYXNzIFRpbWVvdXQge1xuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHBhcmFtIHshRnVuY3Rpb259IGhhbmRsZXJcbiAgICovXG4gIGNvbnN0cnVjdG9yKHdpbiwgaGFuZGxlcikge1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyEuLi90aW1lci1pbXBsLlRpbWVyfSAqL1xuICAgIHRoaXMudGltZXJfID0gU2VydmljZXMudGltZXJGb3Iod2luKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFGdW5jdGlvbn0gKi9cbiAgICB0aGlzLmhhbmRsZXJfID0gaGFuZGxlcjtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P251bWJlcnw/c3RyaW5nfSAqL1xuICAgIHRoaXMuaWRfID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gdGltZVxuICAgKiBAcGFyYW0gey4uLip9IGFyZ3NcbiAgICovXG4gIHRyaWdnZXIodGltZSwgLi4uYXJncykge1xuICAgIHRoaXMuY2FuY2VsKCk7XG4gICAgdGhpcy5pZF8gPSB0aGlzLnRpbWVyXy5kZWxheSgoKSA9PiB0aGlzLmhhbmRsZXJfLmFwcGx5KG51bGwsIGFyZ3MpLCB0aW1lKTtcbiAgfVxuXG4gIC8qKiBAcHVibGljICovXG4gIGNhbmNlbCgpIHtcbiAgICBpZiAodGhpcy5pZF8gIT09IG51bGwpIHtcbiAgICAgIHRoaXMudGltZXJfLmNhbmNlbCh0aGlzLmlkXyk7XG4gICAgICB0aGlzLmlkXyA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgLyoqIEByZXR1cm4ge2Jvb2xlYW59ICovXG4gIGlzV2FpdGluZygpIHtcbiAgICByZXR1cm4gdGhpcy5pZF8gIT09IG51bGw7XG4gIH1cbn1cblxuXG4vKipcbiAqIE1hbmFnZXMgZG9ja2luZyAoYS5rLmEuIG1pbmltaXplIHRvIGNvcm5lcikgZm9yIHZpZGVvcyB0aGF0IHNhdGlzZnkgdGhlXG4gKiB7QHNlZSAuLi8uLi92aWRlby1pbnRlcmZhY2UuVmlkZW9JbnRlcmZhY2V9LlxuICovXG5leHBvcnQgY2xhc3MgVmlkZW9Eb2NraW5nIHtcblxuICAvKipcbiAgICogQHBhcmFtIHshLi4vYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAgICogQHBhcmFtIHshLi4vdmlkZW8tc2VydmljZS1pbnRlcmZhY2UuVmlkZW9TZXJ2aWNlSW50ZXJmYWNlfSBtYW5hZ2VyXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhbXBkb2MsIG1hbmFnZXIpIHtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyEuLi9hbXBkb2MtaW1wbC5BbXBEb2N9ICovXG4gICAgdGhpcy5hbXBkb2NfID0gYW1wZG9jO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCAqL1xuICAgIHRoaXMubWFuYWdlcl8gPSBtYW5hZ2VyO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IS4uL3ZpZXdwb3J0L3ZpZXdwb3J0LWltcGwuVmlld3BvcnR9ICovXG4gICAgdGhpcy52aWV3cG9ydF8gPSBTZXJ2aWNlcy52aWV3cG9ydEZvckRvYyhhbXBkb2MpO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/RG9ja2VkRGVmfSAqL1xuICAgIHRoaXMuY3VycmVudGx5RG9ja2VkXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtmdW5jdGlvbigpOiFUaW1lb3V0fSAqL1xuICAgIHRoaXMuZ2V0RG9ja2luZ1RpbWVvdXRfID0gdGhpcy5sYXp5VGltZW91dF8odmlkZW8gPT5cbiAgICAgIHRoaXMub25Eb2NraW5nVGltZW91dF8oXG4gICAgICAgICAgLyoqIEB0eXBlIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gKi8gKHZpZGVvKSkpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7ZnVuY3Rpb24oKTohVGltZW91dH0gKi9cbiAgICB0aGlzLmdldEhpZGVDb250cm9sc1RpbWVvdXRfID0gdGhpcy5sYXp5VGltZW91dF8oKCkgPT5cbiAgICAgIHRoaXMuaGlkZUNvbnRyb2xzXygvKiByZXNwZWN0U3RpY2t5ICovIHRydWUpKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge2Z1bmN0aW9uKCk6IVRpbWVvdXR9ICovXG4gICAgdGhpcy5nZXRVbmRvY2tpbmdUaW1lb3V0XyA9IHRoaXMubGF6eVRpbWVvdXRfKHZpZGVvID0+XG4gICAgICB0aGlzLnVuZG9ja18oXG4gICAgICAgICAgLyoqIEB0eXBlIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gKi8gKHZpZGVvKSkpO1xuXG4gICAgLyoqIEBwcml2YXRlIHshUmVsYXRpdmVYfSAqL1xuICAgIC8vIE92ZXJyaWRlbiB3aGVuIHVzZXIgZHJhZ3MgdGhlIHZpZGVvIHRvIGEgY29ybmVyLlxuICAgIC8vIFktY29ybmVyIGlzIGRldGVybWluZWQgYmFzZWQgb24gc2Nyb2xsIGRpcmVjdGlvbi5cbiAgICB0aGlzLnByZWZlcnJlZENvcm5lclhfID1cbiAgICAgICAgaXNSVEwodGhpcy5nZXREb2NfKCkpID8gUmVsYXRpdmVYLkxFRlQgOiBSZWxhdGl2ZVguUklHSFQ7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGVsZW1lbnQgcmVwcmVzZW50aW5nIGEgc2hhZG93IHVuZGVyIHRoZSBkb2NrZWQgdmlkZW8uXG4gICAgICogQWx0ZXJuYXRpdmVseSwgd2UgY291bGQgdXNlIGJveC1zaGFkb3cgb24gdGhlIHZpZGVvIGVsZW1lbnQsIGJ1dCBpblxuICAgICAqIG9yZGVyIHRvIGFuaW1hdGUgaXQgd2l0aG91dCBqYW5rIHdlIGhhdmUgdG8gdXNlIGFuIG9wYWNpdHkgdHJhbnNpdGlvbi5cbiAgICAgKiBBIHNlcGFyYXRlIGxheWVyIGFsc28gaGFzIHRoZSAxZCBiZW5lZml0IHRoYXQgYXV0aG9ycyBjYW4gb3ZlcnJpZGUgaXRzXG4gICAgICogYm94LXNoYWRvdyB2YWx1ZSBvciBhbnkgb3RoZXIgc3R5bGluZyB3aXRob3V0IGhhbmRsaW5nIHRoZSB0cmFuc2l0aW9uXG4gICAgICogdGhlbXNlbHZlcy5cbiAgICAgKiBAcHJpdmF0ZSBAY29uc3Qge2Z1bmN0aW9uKCk6IUVsZW1lbnR9XG4gICAgICovXG4gICAgdGhpcy5nZXRTaGFkb3dMYXllcl8gPSBvbmNlKCgpID0+IHRoaXMuYXBwZW5kXyhodG1sRm9yKHRoaXMuZ2V0RG9jXygpKWBcbiAgICAgIDxkaXYgY2xhc3M9XCJhbXAtdmlkZW8tZG9ja2VkLXNoYWRvd1wiIGhpZGRlbj48L2Rpdj5gKSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIG92ZXJsYXkgdG8gYmUgdXNlZCB0byBjYXB0dXJlIGRpZmZlcmVudCB1c2VyIGV2ZW50cy5cbiAgICAgKiBAcHJpdmF0ZSBAY29uc3Qge2Z1bmN0aW9uKCk6IUVsZW1lbnR9XG4gICAgICovXG4gICAgdGhpcy5nZXRPdmVybGF5XyA9IG9uY2UoKCkgPT4gdGhpcy5pbnN0YWxsT3ZlcmxheV8oaHRtbEZvcih0aGlzLmdldERvY18oKSlgXG4gICAgICA8ZGl2IGNsYXNzPVwiaS1hbXBodG1sLXZpZGVvLWRvY2tlZC1vdmVybGF5XCIgaGlkZGVuPjwvZGl2PmApKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge2Z1bmN0aW9uKCk6IUNvbnRyb2xzRGVmfSAqL1xuICAgIHRoaXMuZ2V0Q29udHJvbHNfID0gb25jZSgoKSA9PiB0aGlzLmluc3RhbGxDb250cm9sc18oXG4gICAgICAgIC8vIFRoaXMgY3VycmVudGx5IGJsb2F0cyB0aGUgcmVzdWx0aW5nIGJpbmFyeSB3aXRoXG4gICAgICAgIC8vIDEuIHNvbWUgd2hpdGVzcGFjZSBhbmQgMi4gZHVwbGljYXRlIGRlY2xhcmF0aW9ucyBvZiBlcXVhbCBzdHJpbmdzLlxuICAgICAgICAvLyBVcGNvbWluZyBmaXhlczogIzE0NjU3LCAjMTQ2NTguXG4gICAgICAgIC8vIFRPRE8oYWxhbm9yb3pjbyk6IENsZWFudXAgbWFya3VwIGZvciByZWFkYWJpbGl0eSBvbmNlIGZpeGVzIGxhbmQuXG4gICAgICAgIGh0bWxGb3IodGhpcy5nZXREb2NfKCkpYFxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJhbXAtdmlkZW8tZG9ja2VkLWNvbnRyb2xzXCIgaGlkZGVuPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFtcC12aWRlby1kb2NrZWQtbWFpbi1idXR0b24tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFtcC12aWRlby1kb2NrZWQtYnV0dG9uLWdyb3VwXCI+XG4gICAgICAgICAgICAgICAgPGRpdiByb2xlPVwiYnV0dG9uXCIgcmVmPVwicGxheUJ1dHRvblwiXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiYW1wLXZpZGVvLWRvY2tlZC1wbGF5XCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiByb2xlPVwiYnV0dG9uXCIgcmVmPVwicGF1c2VCdXR0b25cIlxuICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImFtcC12aWRlby1kb2NrZWQtcGF1c2VcIj48L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhbXAtdmlkZW8tZG9ja2VkLWJ1dHRvbi1ncm91cFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgcm9sZT1cImJ1dHRvblwiIHJlZj1cIm11dGVCdXR0b25cIlxuICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImFtcC12aWRlby1kb2NrZWQtbXV0ZVwiPjwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgcm9sZT1cImJ1dHRvblwiIHJlZj1cInVubXV0ZUJ1dHRvblwiXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiYW1wLXZpZGVvLWRvY2tlZC11bm11dGVcIj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhbXAtdmlkZW8tZG9ja2VkLWJ1dHRvbi1ncm91cFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgcm9sZT1cImJ1dHRvblwiIHJlZj1cImZ1bGxzY3JlZW5CdXR0b25cIlxuICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImFtcC12aWRlby1kb2NrZWQtZnVsbHNjcmVlblwiPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFtcC12aWRlby1kb2NrZWQtYnV0dG9uLWRpc21pc3MtZ3JvdXBcIlxuICAgICAgICAgICAgICAgIHJlZj1cImRpc21pc3NDb250YWluZXJcIj5cbiAgICAgICAgICAgICAgPGRpdiByb2xlPVwiYnV0dG9uXCIgcmVmPVwiZGlzbWlzc0J1dHRvblwiXG4gICAgICAgICAgICAgICAgICBjbGFzcz1cImFtcC12aWRlby1kb2NrZWQtZGlzbWlzc1wiPjwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+YCkpO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/Li4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gKi9cbiAgICB0aGlzLmxhc3REaXNtaXNzZWRfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P1JlbGF0aXZlWX0gKi9cbiAgICB0aGlzLmxhc3REaXNtaXNzZWRQb3NZXyA9IG51bGw7XG5cbiAgICAvKipcbiAgICAgKiBVbmxpc3RlbmVycyBmb3IgdGhlIGN1cnJlbnRseSBtaW5pbWl6ZWQgdmlkZW8uXG4gICAgICogQHByaXZhdGUgeyFBcnJheTwhVW5saXN0ZW5EZWY+fVxuICAgICAqL1xuICAgIHRoaXMudmlkZW9Vbmxpc3RlbmVyc18gPSBbXTtcblxuICAgIC8qKlxuICAgICAqIE1lbW9pemVzIHgsIHkgYW5kIHNjYWxlIHRvIHByZXZlbnQgdXNlbGVzcyBtdXRhdGlvbnMuXG4gICAgICogQHByaXZhdGUgez97eDogbnVtYmVyLCB5OiBudW1iZXIsIHNjYWxlOiBudW1iZXJ9fVxuICAgICAqL1xuICAgIHRoaXMucGxhY2VkQXRfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P3t3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcn19ICovXG4gICAgdGhpcy5zaXplZEF0XyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUgez9EaXJlY3Rpb259ICovXG4gICAgdGhpcy5zY3JvbGxEaXJlY3Rpb25fID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMubGFzdFNjcm9sbFRvcF8gPSB0aGlzLnZpZXdwb3J0Xy5nZXRTY3JvbGxUb3AoKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7Ym9vbGVhbn0gKi9cbiAgICB0aGlzLnN0aWNreUNvbnRyb2xzXyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuaXNEcmFnZ2luZ18gPSBmYWxzZTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IUFycmF5PCEuLi8uLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmPn0gKi9cbiAgICB0aGlzLm9ic2VydmVkXyA9IFtdO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IWZ1bmN0aW9uKCl9ICovXG4gICAgLy8gTGF6aWx5IGludm9rZWQuXG4gICAgdGhpcy5pbnN0YWxsXyA9IG9uY2UoKCkgPT4ge1xuICAgICAgdGhpcy52aWV3cG9ydF8ub25TY3JvbGwoXG4gICAgICAgICAgdGhyb3R0bGVCeUFuaW1hdGlvbkZyYW1lKHRoaXMuYW1wZG9jXy53aW4sXG4gICAgICAgICAgICAgICgpID0+IHRoaXMudXBkYXRlU2Nyb2xsXygpKSk7XG5cbiAgICAgIHRoaXMudmlld3BvcnRfLm9uUmVzaXplKCgpID0+IHRoaXMudXBkYXRlQWxsT25SZXNpemVfKCkpO1xuXG4gICAgICB0aGlzLmluc3RhbGxTdHlsZXNfKCk7XG4gICAgfSk7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtmdW5jdGlvbigpOj9FbGVtZW50fSAqL1xuICAgIHRoaXMuZ2V0U2xvdF8gPSBvbmNlKCgpID0+IHRoaXMucXVlcnlTbG90XygpKTtcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMuaGlkZUNvbnRyb2xzT25UYXBPdXRzaWRlT25jZV8gPVxuICAgICAgICBvbmNlKCgpID0+IHRoaXMuaGlkZUNvbnRyb2xzT25UYXBPdXRzaWRlXygpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHF1ZXJ5U2xvdF8oKSB7XG4gICAgY29uc3Qgcm9vdCA9IHRoaXMuYW1wZG9jXy5nZXRSb290Tm9kZSgpO1xuXG4gICAgLy8gRm9yIGNvbnNpc3RlbmN5IGFsd2F5cyBob25vciB0aGUgZG9jayBhdHRyaWJ1dGUgb24gdGhlIGZpcnN0IGVsIGluIHBhZ2UuXG4gICAgY29uc3QgdmlkZW8gPSByb290LnF1ZXJ5U2VsZWN0b3IoJ1tkb2NrXScpO1xuXG4gICAgZGV2KCkuYXNzZXJ0RWxlbWVudCh2aWRlbyk7XG5cbiAgICB1c2VyKCkuYXNzZXJ0KHZpZGVvLnNpZ25hbHMoKS5nZXQoVmlkZW9FdmVudHMuUkVHSVNURVJFRCksXG4gICAgICAgICdgZG9ja2AgYXR0cmlidXRlIGNhbiBvbmx5IGJlIHNldCBvbiB2aWRlbyBjb21wb25lbnRzLicpO1xuXG4gICAgY29uc3Qgc2xvdFNlbGVjdG9yID0gdmlkZW8uZ2V0QXR0cmlidXRlKCdkb2NrJykudHJpbSgpO1xuXG4gICAgaWYgKHNsb3RTZWxlY3RvciA9PSAnJykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgZWwgPSByb290LnF1ZXJ5U2VsZWN0b3Ioc2xvdFNlbGVjdG9yKTtcblxuICAgIGlmIChlbCkge1xuICAgICAgdXNlcigpLmFzc2VydChlbC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ2FtcC1sYXlvdXQnLFxuICAgICAgICAgICdEb2NrIHNsb3QgbXVzdCBiZSBhbiA8YW1wLWxheW91dD4gZWxlbWVudC4nKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZWw7XG4gIH1cblxuICAvKiogQHByaXZhdGUgKi9cbiAgaW5zdGFsbFN0eWxlc18oKSB7XG4gICAgaW5zdGFsbFN0eWxlc0ZvckRvYyhcbiAgICAgICAgdGhpcy5hbXBkb2NfLFxuICAgICAgICBjc3NUZXh0LFxuICAgICAgICAvKiBjYWxsYmFjayAqLyBudWxsLFxuICAgICAgICAvKiBvcHRfaXNSdW50aW1lQ3NzICovIGZhbHNlLFxuICAgICAgICAvKiBvcHRfZXh0ICovICdhbXAtdmlkZW8tZG9ja2luZycpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oLi4uKil9IGZuXG4gICAqIEByZXR1cm4ge2Z1bmN0aW9uKCk6IVRpbWVvdXR9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBsYXp5VGltZW91dF8oZm4pIHtcbiAgICByZXR1cm4gb25jZSgoKSA9PiBuZXcgVGltZW91dCh0aGlzLmFtcGRvY18ud2luLCBmbikpO1xuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIHVwZGF0ZUFsbE9uUmVzaXplXygpIHtcbiAgICB0aGlzLm9ic2VydmVkXy5mb3JFYWNoKHZpZGVvID0+IHRoaXMudXBkYXRlT25SZXNpemVfKHZpZGVvKSk7XG4gIH1cblxuICAvKiogQHBhcmFtIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW8gKi9cbiAgcmVnaXN0ZXIodmlkZW8pIHtcbiAgICB0aGlzLmluc3RhbGxfKCk7XG5cbiAgICBjb25zdCB7ZWxlbWVudH0gPSB2aWRlbztcbiAgICBjb25zdCBmaWRlbGl0eSA9IFBvc2l0aW9uT2JzZXJ2ZXJGaWRlbGl0eS5ISUdIO1xuICAgIHRoaXMuZ2V0UG9zaXRpb25PYnNlcnZlcl8oKS5vYnNlcnZlKGVsZW1lbnQsIGZpZGVsaXR5LFxuICAgICAgICAoKSA9PiB0aGlzLnVwZGF0ZU9uUG9zaXRpb25DaGFuZ2VfKHZpZGVvKSk7XG4gICAgdGhpcy5vYnNlcnZlZF8ucHVzaCh2aWRlbyk7XG4gIH1cblxuICAvKiogQHByaXZhdGUgKi9cbiAgdXBkYXRlU2Nyb2xsXygpIHtcbiAgICBjb25zdCBzY3JvbGxUb3AgPSB0aGlzLnZpZXdwb3J0Xy5nZXRTY3JvbGxUb3AoKTtcbiAgICBjb25zdCBzY3JvbGxEaXJlY3Rpb24gPSBzY3JvbGxUb3AgPiB0aGlzLmxhc3RTY3JvbGxUb3BfID9cbiAgICAgIERpcmVjdGlvbi5VUCA6XG4gICAgICBEaXJlY3Rpb24uRE9XTjtcbiAgICB0aGlzLnNjcm9sbERpcmVjdGlvbl8gPSBzY3JvbGxEaXJlY3Rpb247XG4gICAgdGhpcy5sYXN0U2Nyb2xsVG9wXyA9IHNjcm9sbFRvcDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshRG9jdW1lbnR9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXREb2NfKCkge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFEb2N1bWVudH0gKi8gKHRoaXMuYW1wZG9jXy5nZXRSb290Tm9kZSgpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gICAqIEByZXR1cm4geyFFbGVtZW50fVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgYXBwZW5kXyhlbGVtZW50KSB7XG4gICAgY29uc3Qgcm9vdCA9IHRoaXMuZ2V0RG9jXygpLmJvZHkgfHwgdGhpcy5nZXREb2NfKCk7XG4gICAgcmV0dXJuIGRldigpLmFzc2VydEVsZW1lbnQocm9vdC5hcHBlbmRDaGlsZChlbGVtZW50KSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudH0gb3ZlcmxheVxuICAgKiAqIEByZXR1cm4geyFFbGVtZW50fVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgaW5zdGFsbE92ZXJsYXlfKG92ZXJsYXkpIHtcbiAgICB0aGlzLmFwcGVuZF8ob3ZlcmxheSk7XG4gICAgcmV0dXJuIHRoaXMuc2hvd0NvbnRyb2xzT25UYXBfKHRoaXMuYWRkRHJhZ0xpc3RlbmVyc18ob3ZlcmxheSkpO1xuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIGVudGVyRnVsbHNjcmVlbl8oKSB7XG4gICAgY29uc3QgdmlkZW8gPSB0aGlzLmdldERvY2tlZFZpZGVvXygpO1xuICAgIHZpZGVvLmZ1bGxzY3JlZW5FbnRlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAgICogQHJldHVybiB7IUVsZW1lbnR9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzaG93Q29udHJvbHNPblRhcF8oZWxlbWVudCkge1xuICAgIGxpc3RlbihlbGVtZW50LCAnbW91c2V1cCcsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmlzRHJhZ2dpbmdfKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHZpZGVvID0gdGhpcy5nZXREb2NrZWRWaWRlb18oKTtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgY29udGFpbmVyLFxuICAgICAgICBwbGF5QnV0dG9uLFxuICAgICAgICBwYXVzZUJ1dHRvbixcbiAgICAgICAgbXV0ZUJ1dHRvbixcbiAgICAgICAgdW5tdXRlQnV0dG9uLFxuICAgICAgfSA9IHRoaXMuZ2V0Q29udHJvbHNfKCk7XG4gICAgICBjb25zdCBvdmVybGF5ID0gdGhpcy5nZXRPdmVybGF5XygpO1xuXG4gICAgICBjb250YWluZXIucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcbiAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdhbXAtdmlkZW8tZG9ja2VkLWNvbnRyb2xzLXNob3duJyk7XG4gICAgICBvdmVybGF5LmNsYXNzTGlzdC5hZGQoJ2FtcC12aWRlby1kb2NrZWQtY29udHJvbHMtYmcnKTtcblxuICAgICAgaWYgKHRoaXMuaXNQbGF5aW5nXygpKSB7XG4gICAgICAgIHN3YXAocGxheUJ1dHRvbiwgcGF1c2VCdXR0b24pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3dhcChwYXVzZUJ1dHRvbiwgcGxheUJ1dHRvbik7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLm1hbmFnZXJfLmlzTXV0ZWQoXG4gICAgICAgICAgLyoqIEB0eXBlIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvSW50ZXJmYWNlfSAqLyAodmlkZW8pKSkge1xuICAgICAgICBzd2FwKG11dGVCdXR0b24sIHVubXV0ZUJ1dHRvbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzd2FwKHVubXV0ZUJ1dHRvbiwgbXV0ZUJ1dHRvbik7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuaGlkZUNvbnRyb2xzT25UaW1lb3V0XygpO1xuICAgIH0pO1xuICAgIHJldHVybiBlbGVtZW50O1xuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIGhpZGVDb250cm9sc09uVGFwT3V0c2lkZV8oKSB7XG4gICAgbGlzdGVuKHRoaXMuYW1wZG9jXy5nZXRSb290Tm9kZSgpLCAnbW91c2Vkb3duJywgZSA9PiB7XG4gICAgICBpZiAoIXRoaXMuY3VycmVudGx5RG9ja2VkXykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5pc0NvbnRyb2xzRXZlbnRUYXJnZXRfKGRldigpLmFzc2VydEVsZW1lbnQoZS50YXJnZXQpKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLmhpZGVDb250cm9sc18oLyogcmVzcGVjdFN0aWNreSAqLyB0cnVlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gICAqIEByZXR1cm4geyFFbGVtZW50fVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgYWRkRHJhZ0xpc3RlbmVyc18oZWxlbWVudCkge1xuICAgIGNvbnN0IGhhbmRsZXIgPSBlID0+IHRoaXMuZHJhZ18oLyoqIEB0eXBlIHshVG91Y2hFdmVudH0gKi8oZSkpO1xuXG4gICAgbGlzdGVuKGVsZW1lbnQsICd0b3VjaHN0YXJ0JywgaGFuZGxlcik7XG4gICAgbGlzdGVuKGVsZW1lbnQsICdtb3VzZWRvd24nLCBoYW5kbGVyKTtcblxuICAgIHJldHVybiBlbGVtZW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGNvbnRhaW5lclxuICAgKiBAcmV0dXJuIHshQ29udHJvbHNEZWZ9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBpbnN0YWxsQ29udHJvbHNfKGNvbnRhaW5lcikge1xuICAgIGNvbnN0IGNvbnRyb2xzID0gaHRtbFJlZnMoY29udGFpbmVyKTtcblxuICAgIGNvbnN0IHtcbiAgICAgIGRpc21pc3NCdXR0b24sXG4gICAgICBwbGF5QnV0dG9uLFxuICAgICAgcGF1c2VCdXR0b24sXG4gICAgICB1bm11dGVCdXR0b24sXG4gICAgICBtdXRlQnV0dG9uLFxuICAgICAgZnVsbHNjcmVlbkJ1dHRvbixcbiAgICB9ID0gY29udHJvbHM7XG5cbiAgICBPYmplY3QuYXNzaWduKGNvbnRyb2xzLCB7Y29udGFpbmVyfSk7XG5cbiAgICB0aGlzLmxpc3RlbldoZW5Ob3REcmFnZ2luZ18oZGlzbWlzc0J1dHRvbiwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5kaXNtaXNzT25UYXBfKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmxpc3RlbldoZW5Ob3REcmFnZ2luZ18ocGxheUJ1dHRvbiwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5nZXREb2NrZWRWaWRlb18oKS5wbGF5KC8qIGF1dG8gKi8gZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5saXN0ZW5XaGVuTm90RHJhZ2dpbmdfKHBhdXNlQnV0dG9uLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmdldERvY2tlZFZpZGVvXygpLnBhdXNlKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmxpc3RlbldoZW5Ob3REcmFnZ2luZ18obXV0ZUJ1dHRvbiwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5nZXREb2NrZWRWaWRlb18oKS5tdXRlKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmxpc3RlbldoZW5Ob3REcmFnZ2luZ18odW5tdXRlQnV0dG9uLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmdldERvY2tlZFZpZGVvXygpLnVubXV0ZSgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5saXN0ZW5XaGVuTm90RHJhZ2dpbmdfKGZ1bGxzY3JlZW5CdXR0b24sICdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuZW50ZXJGdWxsc2NyZWVuXygpO1xuICAgIH0pO1xuXG4gICAgbGlzdGVuKGNvbnRhaW5lciwgJ21vdXNldXAnLCAoKSA9PlxuICAgICAgdGhpcy5oaWRlQ29udHJvbHNPblRpbWVvdXRfKENPTlRST0xTX1RJTUVPVVRfQUZURVJfSVgpKTtcblxuICAgIHRoaXMuYWRkRHJhZ0xpc3RlbmVyc18oY29udGFpbmVyKTtcbiAgICB0aGlzLmFwcGVuZF8oY29udGFpbmVyKTtcblxuICAgIHJldHVybiAvKiogQHR5cGUgeyFDb250cm9sc0RlZn0gKi8gKGNvbnRyb2xzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAgICogQHBhcmFtIHtmdW5jdGlvbighRXZlbnQpfSBoYW5kbGVyXG4gICAqL1xuICBsaXN0ZW5XaGVuTm90RHJhZ2dpbmdfKGVsZW1lbnQsIGV2ZW50VHlwZSwgaGFuZGxlcikge1xuICAgIGxpc3RlbihlbGVtZW50LCBldmVudFR5cGUsIGUgPT4ge1xuICAgICAgaWYgKHRoaXMuaXNEcmFnZ2luZ18pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaGFuZGxlcihlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBAcHJpdmF0ZSAqL1xuICBkaXNtaXNzT25UYXBfKCkge1xuICAgIHRoaXMudW5kb2NrXyh0aGlzLmdldERvY2tlZFZpZGVvXygpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdldERvY2tlZFZpZGVvXygpIHtcbiAgICByZXR1cm4gZGV2KCkuYXNzZXJ0KHRoaXMuY3VycmVudGx5RG9ja2VkXykudmlkZW87XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IVBvc2l0aW9uT2JzZXJ2ZXJ9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRQb3NpdGlvbk9ic2VydmVyXygpIHtcbiAgICBpbnN0YWxsUG9zaXRpb25PYnNlcnZlclNlcnZpY2VGb3JEb2ModGhpcy5hbXBkb2NfKTtcblxuICAgIC8vIE5vIGdldHRlciBpbiBzZXJ2aWNlcy5qcy5cbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUG9zaXRpb25PYnNlcnZlcn0gKi8gKFxuICAgICAgZ2V0U2VydmljZUZvckRvYyh0aGlzLmFtcGRvY18sICdwb3NpdGlvbi1vYnNlcnZlcicpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWNvbmNpbGVzIHRoZSBzdGF0ZSBvZiBhIGRvY2tlZCBvciBwb3RlbnRpYWxseSBkb2NrYWJsZSB2aWRlbyB3aGVuXG4gICAqIHRoZSB2aWV3cG9ydC9wb3NpdGlvbiBjaGFuZ2VzLlxuICAgKiBAcGFyYW0geyEuLi8uLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSB2aWRlb1xuICAgKiBAcmV0dXJuIHs/RG9ja1RhcmdldERlZn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdldFRhcmdldEZvcl8odmlkZW8pIHtcbiAgICBpZiAodGhpcy5pc0RyYWdnaW5nXyB8fFxuICAgICAgICB0aGlzLmlnbm9yZUR1ZVRvU2l6ZV8odmlkZW8pIHx8XG4gICAgICAgIHRoaXMuaWdub3JlQmVjYXVzZUFub3RoZXJEb2NrZWRfKHZpZGVvKSB8fFxuICAgICAgICB0aGlzLmlnbm9yZUR1ZVRvTm90UGxheWluZ01hbnVhbGx5Xyh2aWRlbykgfHxcbiAgICAgICAgdGhpcy51bmRvY2tCZWNhdXNlVmlzaWJsZV8odmlkZW8pKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgaWYgKHRoaXMuY2FuVXBkYXRlRnJvbVNsb3RfKHZpZGVvKSkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0U2xvdF8oKTtcbiAgICB9XG4gICAgY29uc3QgcG9zWSA9IHRoaXMubWF5YmVHZXRSZWxhdGl2ZVlfKHZpZGVvKTtcbiAgICBpZiAocG9zWSA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHBvc1k7XG4gICAgfVxuICAgIHJldHVybiB7cG9zWSwgcG9zWDogdGhpcy5nZXRSZWxhdGl2ZVhfKCl9O1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uLy4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9IHZpZGVvXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBjYW5VcGRhdGVGcm9tU2xvdF8odmlkZW8pIHtcbiAgICBpZiAoIXRoaXMuc2xvdEhhc0RpbWVuc2lvbnNfKCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY29uc3QgcmVsYXRpdmVZID0gdGhpcy5nZXRTbG90UmVsYXRpdmVZXygpO1xuICAgIGNvbnN0IHtlbGVtZW50fSA9IHZpZGVvO1xuICAgIGNvbnN0IHt0b3AsIGJvdHRvbX0gPSBlbGVtZW50LmdldEludGVyc2VjdGlvbkNoYW5nZUVudHJ5KCkuaW50ZXJzZWN0aW9uUmVjdDtcbiAgICBjb25zdCB7dG9wOiBzbG90VG9wLCBoZWlnaHQ6IHNsb3RIZWlnaHR9ID0gdGhpcy5nZXRGaXhlZFNsb3RMYXlvdXRCb3hfKCk7XG4gICAgY29uc3Qgc2xvdEJvdHRvbSA9IHRoaXMudmlld3BvcnRfLmdldFNpemUoKS5oZWlnaHQgLSBzbG90SGVpZ2h0IC0gc2xvdFRvcDtcbiAgICBpZiAocmVsYXRpdmVZID09IFJlbGF0aXZlWS5UT1ApIHtcbiAgICAgIHJldHVybiB0b3AgPD0gc2xvdFRvcDtcbiAgICB9XG4gICAgcmV0dXJuIGJvdHRvbSA+PSBzbG90Qm90dG9tO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyEuLi8uLi9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0Rml4ZWRTbG90TGF5b3V0Qm94XygpIHtcbiAgICBjb25zdCByZWN0ID0gZGV2KCkuYXNzZXJ0RWxlbWVudCh0aGlzLmdldFNsb3RfKCkpLmdldExheW91dEJveCgpO1xuICAgIGNvbnN0IGR5ID0gLXRoaXMudmlld3BvcnRfLmdldFNjcm9sbFRvcCgpO1xuICAgIHJldHVybiBtb3ZlTGF5b3V0UmVjdChyZWN0LCAvKiBkeCAqLyAwLCBkeSk7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHNsb3RIYXNEaW1lbnNpb25zXygpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZ2V0U2xvdF8oKTtcbiAgICBpZiAoIWVsKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IHt3aWR0aCwgaGVpZ2h0fSA9IHRoaXMuZ2V0Rml4ZWRTbG90TGF5b3V0Qm94XygpO1xuICAgIHJldHVybiB3aWR0aCA+IDAgJiYgaGVpZ2h0ID4gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyEuLi8uLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSB2aWRlb1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdXBkYXRlT25SZXNpemVfKHZpZGVvKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5nZXRUYXJnZXRGb3JfKHZpZGVvKTtcbiAgICBpZiAoIXRhcmdldCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmRvY2tfKHZpZGVvLCB0YXJnZXQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uLy4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9IHZpZGVvXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB1cGRhdGVPblBvc2l0aW9uQ2hhbmdlXyh2aWRlbykge1xuICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZ2V0VGFyZ2V0Rm9yXyh2aWRlbyk7XG4gICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5kb2NrT25Qb3NpdGlvbkNoYW5nZV8odmlkZW8sIHRhcmdldCk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICogQHBhcmFtIHtudW1iZXI9fSByYXRpb1xuICAgKiBAcGFyYW0ge251bWJlcj19IHRpbWVvdXRcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIHVuZG9ja0JlY2F1c2VWaXNpYmxlXyh2aWRlbywgcmF0aW8gPSAxLCB0aW1lb3V0ID0gNDApIHtcbiAgICBjb25zdCB7ZWxlbWVudH0gPSB2aWRlbztcbiAgICBpZiAodGhpcy5jdXJyZW50bHlEb2NrZWRfICYmIHRoaXMuaXNWaXNpYmxlXyhlbGVtZW50LCByYXRpbykpIHtcbiAgICAgIGlmICghdGhpcy5nZXRVbmRvY2tpbmdUaW1lb3V0XygpLmlzV2FpdGluZygpKSB7XG4gICAgICAgIHRoaXMuZ2V0VW5kb2NraW5nVGltZW91dF8oKS50cmlnZ2VyKHRpbWVvdXQsIHZpZGVvKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICB0aGlzLmdldFVuZG9ja2luZ1RpbWVvdXRfKCkuY2FuY2VsKCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSAgeyEuLi8uLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSB2aWRlb1xuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgaWdub3JlRHVlVG9Ob3RQbGF5aW5nTWFudWFsbHlfKHZpZGVvKSB7XG4gICAgcmV0dXJuICF0aGlzLmN1cnJlbnRseURvY2tlZF8gJiYgIXRoaXMuaXNQbGF5aW5nXyh2aWRlbyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtICB7IS4uLy4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9IHZpZGVvXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBpZ25vcmVCZWNhdXNlQW5vdGhlckRvY2tlZF8odmlkZW8pIHtcbiAgICByZXR1cm4gISF0aGlzLmN1cnJlbnRseURvY2tlZF8gJiYgIXRoaXMuaXNDdXJyZW50bHlEb2NrZWRfKHZpZGVvKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlnbm9yZUR1ZVRvU2l6ZV8odmlkZW8pIHtcbiAgICBjb25zdCB7d2lkdGgsIGhlaWdodH0gPSB2aWRlby5nZXRMYXlvdXRCb3goKTtcbiAgICBpZiAoKHdpZHRoIC8gaGVpZ2h0KSA8IDEpIHtcbiAgICAgIGNvbXBsYWluQWJvdXRQb3J0cmFpdCh2aWRlby5lbGVtZW50KTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAodGhpcy5nZXRBcmVhV2lkdGhfKCkgPCBNSU5fVklFV1BPUlRfV0lEVEgpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0VG9wRWRnZV8oKSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0Qm90dG9tRWRnZV8oKSB7XG4gICAgcmV0dXJuIHRoaXMudmlld3BvcnRfLmdldFNpemUoKS5oZWlnaHQ7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0TGVmdEVkZ2VfKCkge1xuICAgIHJldHVybiAwO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge251bWJlcn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdldFJpZ2h0RWRnZV8oKSB7XG4gICAgcmV0dXJuIHRoaXMudmlld3BvcnRfLmdldFNpemUoKS53aWR0aDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyEuLi8uLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSB2aWRlb1xuICAgKiBAcmV0dXJuIHs/UmVsYXRpdmVZfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgbWF5YmVHZXRSZWxhdGl2ZVlfKHZpZGVvKSB7XG4gICAgaWYgKHRoaXMuc2xvdEhhc0RpbWVuc2lvbnNfKCkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBpZiAodGhpcy5pc0N1cnJlbnRseURvY2tlZF8odmlkZW8pKSB7XG4gICAgICBjb25zdCB7cG9zWX0gPSBkZXYoKS5hc3NlcnQodGhpcy5jdXJyZW50bHlEb2NrZWRfKS50YXJnZXQ7XG4gICAgICByZXR1cm4gLyoqIEB0eXBlIHshUmVsYXRpdmVZfSAqLyAoZGV2KCkuYXNzZXJ0TnVtYmVyKHBvc1kpKTtcbiAgICB9XG4gICAgY29uc3Qge2VsZW1lbnR9ID0gdmlkZW87XG4gICAgY29uc3Qge3RvcCwgYm90dG9tfSA9IGVsZW1lbnQuZ2V0SW50ZXJzZWN0aW9uQ2hhbmdlRW50cnkoKS5pbnRlcnNlY3Rpb25SZWN0O1xuICAgIGlmICh0b3AgPD0gdGhpcy5nZXRUb3BFZGdlXygpICYmXG4gICAgICAgIHRoaXMuc2Nyb2xsRGlyZWN0aW9uXyA9PSBEaXJlY3Rpb24uVVApIHtcbiAgICAgIHJldHVybiBSZWxhdGl2ZVkuVE9QO1xuICAgIH1cbiAgICBpZiAoYm90dG9tID49IHRoaXMuZ2V0Qm90dG9tRWRnZV8oKSAmJlxuICAgICAgICB0aGlzLnNjcm9sbERpcmVjdGlvbl8gPT0gRGlyZWN0aW9uLkRPV04pIHtcbiAgICAgIHJldHVybiBSZWxhdGl2ZVkuQk9UVE9NO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshUmVsYXRpdmVYfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0UmVsYXRpdmVYXygpIHtcbiAgICByZXR1cm4gdGhpcy5wcmVmZXJyZWRDb3JuZXJYXztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRNYXJnaW5fKCkge1xuICAgIHJldHVybiBNYXRoLm1pbihNQVJHSU5fTUFYLCBNQVJHSU5fQVJFQV9XSURUSF9QRVJDICogdGhpcy5nZXRBcmVhV2lkdGhfKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge251bWJlcn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdldEFyZWFXaWR0aF8oKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0UmlnaHRFZGdlXygpIC0gdGhpcy5nZXRMZWZ0RWRnZV8oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gez8uLi8uLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSBvcHRWaWRlb1xuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgaXNQbGF5aW5nXyhvcHRWaWRlbyA9IG51bGwpIHtcbiAgICBjb25zdCB2aWRlbyA9IC8qKiBAdHlwZSB7IS4uLy4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb0ludGVyZmFjZX0gKi8gKFxuICAgICAgb3B0VmlkZW8gfHwgdGhpcy5nZXREb2NrZWRWaWRlb18oKSk7XG4gICAgcmV0dXJuIHRoaXMubWFuYWdlcl8uZ2V0UGxheWluZ1N0YXRlKHZpZGVvKSA9PSBQbGF5aW5nU3RhdGVzLlBMQVlJTkdfTUFOVUFMO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBkaXJYXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBkaXJZXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBkaXNtaXNzXyhkaXJYID0gMCwgZGlyWSA9IDApIHtcbiAgICBjb25zdCB2aWRlbyA9IHRoaXMuZ2V0RG9ja2VkVmlkZW9fKCk7XG4gICAgY29uc3Qge3Bvc1l9ID0gdGhpcy5jdXJyZW50bHlEb2NrZWRfLnRhcmdldDtcbiAgICB2aWRlby5wYXVzZSgpO1xuICAgIHRoaXMubGFzdERpc21pc3NlZF8gPSB2aWRlbztcbiAgICB0aGlzLmxhc3REaXNtaXNzZWRQb3NZXyA9IHBvc1kgfHwgbnVsbDtcbiAgICB0aGlzLnVuZG9ja18odmlkZW8sIGRpclgsIGRpclkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBjdXJyZW50UG9zaXRpb25NYXRjaGVzU2Nyb2xsXygpIHtcbiAgICBpZiAoIXRoaXMuY3VycmVudGx5RG9ja2VkXykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodGhpcy5pc0RvY2tlZFRvU2xvdF8oKSkge1xuICAgICAgcmV0dXJuIHRoaXMucG9zaXRpb25NYXRjaGVzU2Nyb2xsXyh0aGlzLmdldFNsb3RSZWxhdGl2ZVlfKCkpO1xuICAgIH1cbiAgICBpZiAodGhpcy5jdXJyZW50bHlEb2NrZWRfLnRhcmdldC5wb3NZID09IG51bGwpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMucG9zaXRpb25NYXRjaGVzU2Nyb2xsXyh0aGlzLmN1cnJlbnRseURvY2tlZF8udGFyZ2V0LnBvc1kpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFSZWxhdGl2ZVl9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRTbG90UmVsYXRpdmVZXygpIHtcbiAgICBjb25zdCB7dG9wLCBoZWlnaHR9ID0gdGhpcy5nZXRGaXhlZFNsb3RMYXlvdXRCb3hfKCk7XG4gICAgY29uc3QgdmggPSB0aGlzLnZpZXdwb3J0Xy5nZXRTaXplKCkuaGVpZ2h0O1xuICAgIGNvbnN0IGJvdHRvbSA9IHZoIC0gaGVpZ2h0IC0gdG9wO1xuICAgIHJldHVybiBib3R0b20gPiB0b3AgPyBSZWxhdGl2ZVkuVE9QIDogUmVsYXRpdmVZLkJPVFRPTTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFSZWxhdGl2ZVl9IHBvc1lcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHBvc2l0aW9uTWF0Y2hlc1Njcm9sbF8ocG9zWSkge1xuICAgIGNvbnN0IGRpcmVjdGlvbiA9IHRoaXMuc2Nyb2xsRGlyZWN0aW9uXztcbiAgICByZXR1cm4gKFxuICAgICAgKHBvc1kgPT0gUmVsYXRpdmVZLlRPUCAmJiBkaXJlY3Rpb24gPT0gRGlyZWN0aW9uLlVQKSB8fFxuICAgICAgKHBvc1kgPT0gUmVsYXRpdmVZLkJPVFRPTSAmJiBkaXJlY3Rpb24gPT0gRGlyZWN0aW9uLkRPV04pKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyEuLi8uLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSB2aWRlb1xuICAgKiBAcGFyYW0geyFEb2NrVGFyZ2V0RGVmfSB0YXJnZXRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGRvY2tPblBvc2l0aW9uQ2hhbmdlXyh2aWRlbywgdGFyZ2V0KSB7XG4gICAgaWYgKHRoaXMuaWdub3JlRHVlVG9EaXNtaXNzYWxfKHZpZGVvKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHN0ZXAgPSB0aGlzLmNhbGN1bGF0ZVN0ZXBfKHZpZGVvLmVsZW1lbnQsIHRhcmdldCk7XG4gICAgaWYgKHRoaXMuaWdub3JlRHVlVG9UcmFuc2l0aW9uRW5kXyhzdGVwKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZG9ja18odmlkZW8sIHRhcmdldCwgc3RlcCk7XG5cbiAgICB0aGlzLmdldERvY2tpbmdUaW1lb3V0XygpLnRyaWdnZXIoRE9DS0lOR19USU1FT1VULCB2aWRlbyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICogQHBhcmFtIHshRG9ja1RhcmdldERlZn0gdGFyZ2V0XG4gICAqIEBwYXJhbSB7P251bWJlcj19IG9wdF9zdGVwXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBkb2NrXyh2aWRlbywgdGFyZ2V0LCBvcHRfc3RlcCA9IG51bGwpIHtcbiAgICBjb25zdCBzdGVwID1cbiAgICAgIGlzRmluaXRlTnVtYmVyKG9wdF9zdGVwKSA/XG4gICAgICAgIGRldigpLmFzc2VydE51bWJlcihvcHRfc3RlcCkgOlxuICAgICAgICB0aGlzLmNhbGN1bGF0ZVN0ZXBfKHZpZGVvLmVsZW1lbnQsIHRhcmdldCk7XG5cbiAgICBpZiAoc3RlcCA8IDAuMDEpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoc3RlcCA+PSBSRVZFUlRfVE9fSU5MSU5FX1JBVElPICYmXG4gICAgICAgIHRoaXMuY3VycmVudGx5RG9ja2VkXyAmJlxuICAgICAgICAhdGhpcy5jdXJyZW50bHlEb2NrZWRfLnRyaWdnZXJlZERvY2spIHtcbiAgICAgIHRoaXMudHJpZ2dlcl8odmlkZW8sIEFjdGlvbnMuRE9DSyk7XG4gICAgICB0aGlzLmN1cnJlbnRseURvY2tlZF8udHJpZ2dlcmVkRG9jayA9IHRydWU7XG4gICAgfVxuXG4gICAgLy8gQ29tcG9uZW50IGJhY2tncm91bmQgaXMgbm93IHZpc2libGUsIHNvIGhpZGUgdGhlIHBvc3RlciBmb3IgdGhlIEFuZHJvaWRcbiAgICAvLyB3b3JrYXJvdW5kIHNvIGF1dGhvcnMgY2FuIHN0eWxlIHRoZSBjb21wb25lbnQgY29udGFpbmVyIGFzIHRoZXkgbGlrZS5cbiAgICAvLyAoc2VlIGBBbXBWaWRlbyNjcmVhdGVQb3N0ZXJGb3JBbmRyb2lkQnVnX2ApLlxuICAgIHRoaXMucmVtb3ZlUG9zdGVyRm9yQW5kcm9pZEJ1Z18odmlkZW8uZWxlbWVudCk7XG5cbiAgICBjb25zdCB7eCwgeSwgc2NhbGV9ID0gdGhpcy5nZXREaW1zXyh2aWRlbywgdGFyZ2V0LCBzdGVwKTtcbiAgICB2aWRlby5oaWRlQ29udHJvbHMoKTtcbiAgICB0aGlzLnBsYWNlQXRfKHZpZGVvLCB4LCB5LCBzY2FsZSwgc3RlcCk7XG4gICAgdGhpcy5zZXRDdXJyZW50bHlEb2NrZWRfKHZpZGVvLCB0YXJnZXQsIHN0ZXApO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uLy4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9IHZpZGVvXG4gICAqIEBwYXJhbSB7IUFjdGlvbnN9IGFjdGlvblxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdHJpZ2dlcl8odmlkZW8sIGFjdGlvbikge1xuICAgIGNvbnN0IHRydXN0ID0gQWN0aW9uVHJ1c3QuTE9XO1xuICAgIGNvbnN0IGV2ZW50ID0gY3JlYXRlQ3VzdG9tRXZlbnQodGhpcy5hbXBkb2NfLndpbixcbiAgICAgICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovIChhY3Rpb24pLCAvKiBkZXRhaWwgKi8gZGljdCh7fSkpO1xuICAgIGNvbnN0IGFjdGlvbnMgPSBTZXJ2aWNlcy5hY3Rpb25TZXJ2aWNlRm9yRG9jKHRoaXMuYW1wZG9jXyk7XG4gICAgYWN0aW9ucy50cmlnZ2VyKHZpZGVvLmVsZW1lbnQsIGFjdGlvbiwgZXZlbnQsIHRydXN0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGlnbm9yZUR1ZVRvRGlzbWlzc2FsXyh2aWRlbykge1xuICAgIGlmICh0aGlzLmxhc3REaXNtaXNzZWRfICE9IHZpZGVvKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmICh0aGlzLmxhc3REaXNtaXNzZWRQb3NZXyAhPT0gbnVsbCAmJlxuICAgICAgICAhdGhpcy5wb3NpdGlvbk1hdGNoZXNTY3JvbGxfKHRoaXMubGFzdERpc21pc3NlZFBvc1lfKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodGhpcy5pc1Zpc2libGVfKHZpZGVvLmVsZW1lbnQsIEZMT0FUX1RPTEVSQU5DRSkpIHtcbiAgICAgIHRoaXMucmVzZXREaXNtaXNzZWRfKCk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIHJlc2V0RGlzbWlzc2VkXygpIHtcbiAgICB0aGlzLmxhc3REaXNtaXNzZWRfID0gbnVsbDtcbiAgICB0aGlzLmxhc3REaXNtaXNzZWRQb3NZXyA9IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogUHJldmVudHMganVtcCB3aGVuIHRoZSB0cmFuc2l0aW9uIHdhcyB0aW1lZCBvdXQgYmVmb3JlIHVzZXIgZmluaXNoZWRcbiAgICogc2Nyb2xsaW5nIGNvbXBvbmVudCBvdXQgb2Ygdmlldy5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHN0ZXBcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlnbm9yZUR1ZVRvVHJhbnNpdGlvbkVuZF8oc3RlcCkge1xuICAgIHJldHVybiB0aGlzLmhhc1RyYW5zaXRpb25Db21wbGV0ZWRfKHN0ZXApICYmXG4gICAgICAgIHRoaXMuY3VycmVudFBvc2l0aW9uTWF0Y2hlc1Njcm9sbF8oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFBbXBFbGVtZW50fSBlbGVtZW50XG4gICAqIEBwYXJhbSB7IURvY2tUYXJnZXREZWZ9IHRhcmdldFxuICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBjYWxjdWxhdGVTdGVwXyhlbGVtZW50LCB0YXJnZXQpIHtcbiAgICAvLyBBZ2dyZXNzaXZlbHkgcmVkdWNlIHJhdGlvIHRvIHByZXZlbnQgY292ZXJpbmcgdmVydGljYWwgc3BhY2UuXG4gICAgY29uc3QgcmF0aW8gPSB0aGlzLmNhbGN1bGF0ZUludGVyc2VjdGlvblJhdGlvXyhlbGVtZW50LCB0YXJnZXQpO1xuICAgIHJldHVybiAxIC0gTWF0aC5wb3cocmF0aW8sIDMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUFtcEVsZW1lbnR9IGVsZW1lbnRcbiAgICogQHBhcmFtIHs/RG9ja1RhcmdldERlZj19IHRhcmdldFxuICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBjYWxjdWxhdGVJbnRlcnNlY3Rpb25SYXRpb18oZWxlbWVudCwgdGFyZ2V0ID0gbnVsbCkge1xuICAgIGlmICh0YXJnZXQgPT0gbnVsbCB8fCAhaXNFbGVtZW50KHRhcmdldCkpIHtcbiAgICAgIHJldHVybiBlbGVtZW50LmdldEludGVyc2VjdGlvbkNoYW5nZUVudHJ5KCkuaW50ZXJzZWN0aW9uUmF0aW87XG4gICAgfVxuXG4gICAgY29uc3Qge3RvcCwgYm90dG9tLCBoZWlnaHR9ID0gZWxlbWVudC5nZXRMYXlvdXRCb3goKTtcbiAgICBjb25zdCB7dG9wOiBzbG90VG9wLCBib3R0b206IHNsb3RCb3R0b219ID0gdGhpcy5nZXRTbG90XygpLmdldExheW91dEJveCgpO1xuXG4gICAgaWYgKHRoaXMuZ2V0U2xvdFJlbGF0aXZlWV8oKSA9PSBSZWxhdGl2ZVkuVE9QKSB7XG4gICAgICByZXR1cm4gKGJvdHRvbSAtIE1hdGgubWF4KHRvcCwgc2xvdFRvcCkpIC8gaGVpZ2h0O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gKHNsb3RCb3R0b20gLSB0b3ApIC8gaGVpZ2h0O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gc3RlcFxuICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAqL1xuICBjYWxjdWxhdGVUcmFuc2l0aW9uRHVyYXRpb25fKHN0ZXApIHtcbiAgICBjb25zdCBtYXhBdXRvVHJhbnNpdGlvbkR1cmF0aW9uTXMgPSA1MDA7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRseURvY2tlZF8pIHtcbiAgICAgIC8vIERvbid0IGFuaW1hdGUgZmlyc3QgZnJhbWUuIEJyb3dzZXJzIHNvbWV0aW1lcyBiZWhhdmUgd2VpcmRseSBhbmQgdXNlXG4gICAgICAvLyBhIHN0YWxlIHRyYW5zZm9ybSB2YWx1ZSwgdGh1cyBjYXVzaW5nIGl0IHRvIHZpc3VhbGx5IGp1bXAuXG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgY29uc3QgcmVtYWluaW5nID0gTWF0aC5hYnMoc3RlcCAtIHRoaXMuY3VycmVudGx5RG9ja2VkXy5zdGVwKTtcbiAgICByZXR1cm4gcmVtYWluaW5nICogbWF4QXV0b1RyYW5zaXRpb25EdXJhdGlvbk1zO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7bnVtYmVyfSBzY2FsZVxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgYWxyZWFkeVBsYWNlZEF0Xyh4LCB5LCBzY2FsZSkge1xuICAgIHJldHVybiAhIXRoaXMucGxhY2VkQXRfICYmXG4gICAgICAgIHRoaXMucGxhY2VkQXRfLnggPT0geCAmJlxuICAgICAgICB0aGlzLnBsYWNlZEF0Xy55ID09IHkgJiZcbiAgICAgICAgdGhpcy5wbGFjZWRBdF8uc2NhbGUgPT0gc2NhbGU7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICogQHBhcmFtIHtudW1iZXJ9IHNjYWxlXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBzdGVwIGluIFswLi4xXVxuICAgKiBAcGFyYW0gez9udW1iZXJ9IG9wdFRyYW5zaXRpb25EdXJhdGlvbk1zXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwbGFjZUF0Xyh2aWRlbywgeCwgeSwgc2NhbGUsIHN0ZXAsIG9wdFRyYW5zaXRpb25EdXJhdGlvbk1zID0gbnVsbCkge1xuICAgIGlmICh0aGlzLmFscmVhZHlQbGFjZWRBdF8oeCwgeSwgc2NhbGUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgdHJhbnNpdGlvbkR1cmF0aW9uTXMgPSBvcHRUcmFuc2l0aW9uRHVyYXRpb25NcyA/XG4gICAgICBkZXYoKS5hc3NlcnROdW1iZXIob3B0VHJhbnNpdGlvbkR1cmF0aW9uTXMpIDpcbiAgICAgIHRoaXMuY2FsY3VsYXRlVHJhbnNpdGlvbkR1cmF0aW9uXyhzdGVwKTtcblxuICAgIGNvbnN0IHt3aWR0aCwgaGVpZ2h0fSA9IHZpZGVvLmdldExheW91dEJveCgpO1xuXG4gICAgdGhpcy5wbGFjZWRBdF8gPSB7eCwgeSwgc2NhbGV9O1xuXG4gICAgY29uc3QgdHJhbnNpdGlvblRpbWluZyA9XG4gICAgICAgIC8vIEF1dG8tdHJhbnNpdGlvbnMgYXJlIHN1cHBvc2VkIHRvIHNtb290aC1vdXQgUG9zaXRpb25PYnNlcnZlclxuICAgICAgICAvLyBmcmVxdWVuY3ksIHNvIGl0IG1ha2VzIHNlbnNlIHRvIHVzZSAnbGluZWFyJy4gV2hlbiB0aGUgdHJhbnNpdGlvblxuICAgICAgICAvLyBkdXJhdGlvbiBpcyBvdGhlcndpc2UgbGFyZ2VyLCAnZWFzZS1pbicgbG9va3MgbXVjaCBuaWNlci5cbiAgICAgICAgdHJhbnNpdGlvbkR1cmF0aW9uTXMgPiAyMDAgPyAnZWFzZS1pbicgOiAnbGluZWFyJztcblxuICAgIGNvbnN0IHBvc2l0aW9uaW5nU3R5bGVzID0ge1xuICAgICAgJ3RyYW5zZm9ybSc6IHRyYW5zZm9ybSh4LCB5LCBzY2FsZSksXG4gICAgICAndHJhbnNpdGlvbi1kdXJhdGlvbic6IGAke3RyYW5zaXRpb25EdXJhdGlvbk1zfW1zYCxcbiAgICAgICd0cmFuc2l0aW9uLXRpbWluZy1mdW5jdGlvbic6IHRyYW5zaXRpb25UaW1pbmcsXG4gICAgfTtcblxuICAgIGlmICh0aGlzLmJveE5lZWRzU2l6aW5nXyh3aWR0aCwgaGVpZ2h0KSkge1xuICAgICAgLy8gU2V0dGluZyBleHBsaWNpdCBkaW1lbnNpb25zIGlzIG5lZWRlZCB0byBtYXRjaCB0aGUgdmlkZW8ncyBhc3BlY3RcbiAgICAgIC8vIHJhdGlvLiBIb3dldmVyLCB3ZSBvbmx5IGRvIHRoaXMgb25jZSB0byBwcmV2ZW50IGphbmsgaW4gc3Vic2VxdWVudFxuICAgICAgLy8gZnJhbWVzLlxuICAgICAgT2JqZWN0LmFzc2lnbihwb3NpdGlvbmluZ1N0eWxlcywge1xuICAgICAgICAnd2lkdGgnOiBweCh3aWR0aCksXG4gICAgICAgICdoZWlnaHQnOiBweChoZWlnaHQpLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgaW50ZXJuYWxFbGVtZW50ID0gZ2V0SW50ZXJuYWxWaWRlb0VsZW1lbnRGb3IodmlkZW8uZWxlbWVudCk7XG4gICAgY29uc3Qgc2hhZG93TGF5ZXIgPSB0aGlzLmdldFNoYWRvd0xheWVyXygpO1xuICAgIGNvbnN0IG92ZXJsYXkgPSB0aGlzLmdldE92ZXJsYXlfKCk7XG4gICAgY29uc3Qge1xuICAgICAgY29udGFpbmVyOiBjb250cm9scyxcbiAgICAgIGRpc21pc3NDb250YWluZXIsXG4gICAgfSA9IHRoaXMuZ2V0Q29udHJvbHNfKCk7XG5cbiAgICB2aWRlby5tdXRhdGVFbGVtZW50KCgpID0+IHtcbiAgICAgIGludGVybmFsRWxlbWVudC5jbGFzc0xpc3QuYWRkKEJBU0VfQ0xBU1NfTkFNRSk7XG4gICAgICBzaGFkb3dMYXllci5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpO1xuICAgICAgb3ZlcmxheS5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpO1xuICAgICAgc2V0SW1wb3J0YW50U3R5bGVzKGludGVybmFsRWxlbWVudCwgcG9zaXRpb25pbmdTdHlsZXMpO1xuICAgICAgc2V0SW1wb3J0YW50U3R5bGVzKHNoYWRvd0xheWVyLCBwb3NpdGlvbmluZ1N0eWxlcyk7XG4gICAgICBzZXRJbXBvcnRhbnRTdHlsZXMob3ZlcmxheSwgcG9zaXRpb25pbmdTdHlsZXMpO1xuICAgICAgc2V0SW1wb3J0YW50U3R5bGVzKHNoYWRvd0xheWVyLCB7XG4gICAgICAgICdvcGFjaXR5Jzogc3RlcCxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgaGFsZlNjYWxlID0gc2NhbGUgLyAyO1xuICAgICAgY29uc3QgY2VudGVyWCA9IHggKyAod2lkdGggKiBoYWxmU2NhbGUpO1xuICAgICAgY29uc3QgY2VudGVyWSA9IHkgKyAoaGVpZ2h0ICogaGFsZlNjYWxlKTtcbiAgICAgIHNldEltcG9ydGFudFN0eWxlcyhjb250cm9scywge1xuICAgICAgICAndHJhbnNmb3JtJzogdHJhbnNsYXRlKGNlbnRlclgsIGNlbnRlclkpLFxuICAgICAgfSk7XG4gICAgICBjb25zdCBkaXNtaXNzTWFyZ2luID0gODtcbiAgICAgIGNvbnN0IGRpc21pc3NXaWR0aCA9IDQwO1xuICAgICAgY29uc3QgZGlzbWlzc1ggPSB3aWR0aCAqIGhhbGZTY2FsZSAtIGRpc21pc3NNYXJnaW4gLSBkaXNtaXNzV2lkdGg7XG4gICAgICBjb25zdCBkaXNtaXNzWSA9IC0oaGVpZ2h0ICogaGFsZlNjYWxlIC0gZGlzbWlzc01hcmdpbiAtIGRpc21pc3NXaWR0aCk7XG4gICAgICBzZXRJbXBvcnRhbnRTdHlsZXMoZGlzbWlzc0NvbnRhaW5lciwge1xuICAgICAgICAndHJhbnNmb3JtJzogdHJhbnNsYXRlKGRpc21pc3NYLCBkaXNtaXNzWSksXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gIHtudW1iZXJ9IHdpZHRoXG4gICAqIEBwYXJhbSAge251bWJlcn0gaGVpZ2h0XG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBib3hOZWVkc1NpemluZ18od2lkdGgsIGhlaWdodCkge1xuICAgIGNvbnN0IG5lZWRzU2l6aW5nID1cbiAgICAgICAgIXRoaXMuc2l6ZWRBdF8gfHxcbiAgICAgICAgdGhpcy5zaXplZEF0Xy53aWR0aCAhPSB3aWR0aCB8fFxuICAgICAgICB0aGlzLnNpemVkQXRfLmhlaWdodCAhPSBoZWlnaHQ7XG4gICAgaWYgKG5lZWRzU2l6aW5nKSB7XG4gICAgICB0aGlzLnNpemVkQXRfID0ge3dpZHRoLCBoZWlnaHR9O1xuICAgIH1cbiAgICByZXR1cm4gbmVlZHNTaXppbmc7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlzQ3VycmVudGx5RG9ja2VkXyh2aWRlbykge1xuICAgIHJldHVybiAhIXRoaXMuY3VycmVudGx5RG9ja2VkXyAmJiB0aGlzLmN1cnJlbnRseURvY2tlZF8udmlkZW8gPT0gdmlkZW87XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICogQHBhcmFtIHshRG9ja1RhcmdldERlZn0gdGFyZ2V0XG4gICAqIEBwYXJhbSB7bnVtYmVyfSBzdGVwXG4gICAqL1xuICBzZXRDdXJyZW50bHlEb2NrZWRfKHZpZGVvLCB0YXJnZXQsIHN0ZXApIHtcbiAgICBpZiAoIXRoaXMuaXNDdXJyZW50bHlEb2NrZWRfKHZpZGVvKSkge1xuICAgICAgdGhpcy51cGRhdGVDb250cm9sc0Jhc2VkT25fKHZpZGVvLmVsZW1lbnQpO1xuICAgIH1cblxuICAgIGNvbnN0IHt0cmlnZ2VyZWREb2NrfSA9IHRoaXMuY3VycmVudGx5RG9ja2VkXyB8fCB7dHJpZ2dlcmVkRG9jazogZmFsc2V9O1xuICAgIHRoaXMuY3VycmVudGx5RG9ja2VkXyA9IHt2aWRlbywgdGFyZ2V0LCBzdGVwLCB0cmlnZ2VyZWREb2NrfTtcblxuICAgIHRoaXMuaGlkZUNvbnRyb2xzT25UYXBPdXRzaWRlT25jZV8oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSB2aWRlb1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdXBkYXRlQ29udHJvbHNCYXNlZE9uXyh2aWRlbykge1xuICAgIHdoaWxlICh0aGlzLnZpZGVvVW5saXN0ZW5lcnNfLmxlbmd0aCkge1xuICAgICAgdGhpcy52aWRlb1VubGlzdGVuZXJzXy5wb3AoKS5jYWxsKCk7XG4gICAgfVxuICAgIHRoaXMudmlkZW9Vbmxpc3RlbmVyc18gPSBbXG4gICAgICBsaXN0ZW4odmlkZW8sIFZpZGVvRXZlbnRzLlBMQVlJTkcsICgpID0+IHRoaXMub25QbGF5XygpKSxcbiAgICAgIGxpc3Rlbih2aWRlbywgVmlkZW9FdmVudHMuUEFVU0UsICgpID0+IHRoaXMub25QYXVzZV8oKSksXG4gICAgICBsaXN0ZW4odmlkZW8sIFZpZGVvRXZlbnRzLk1VVEVELCAoKSA9PiB0aGlzLm9uTXV0ZV8oKSksXG4gICAgICBsaXN0ZW4odmlkZW8sIFZpZGVvRXZlbnRzLlVOTVVURUQsICgpID0+IHRoaXMub25Vbm11dGVfKCkpLFxuICAgIF07XG4gIH1cblxuICAvKiogQHByaXZhdGUgKi9cbiAgb25QbGF5XygpIHtcbiAgICBjb25zdCB7cGxheUJ1dHRvbiwgcGF1c2VCdXR0b259ID0gdGhpcy5nZXRDb250cm9sc18oKTtcbiAgICB0aGlzLnN0aWNreUNvbnRyb2xzXyA9IGZhbHNlO1xuICAgIHN3YXAocGxheUJ1dHRvbiwgcGF1c2VCdXR0b24pO1xuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIG9uUGF1c2VfKCkge1xuICAgIGNvbnN0IHtwYXVzZUJ1dHRvbiwgcGxheUJ1dHRvbn0gPSB0aGlzLmdldENvbnRyb2xzXygpO1xuICAgIHRoaXMuc3RpY2t5Q29udHJvbHNfID0gdHJ1ZTtcbiAgICBzd2FwKHBhdXNlQnV0dG9uLCBwbGF5QnV0dG9uKTtcbiAgfVxuXG4gIC8qKiBAcHJpdmF0ZSAqL1xuICBvbk11dGVfKCkge1xuICAgIGNvbnN0IHttdXRlQnV0dG9uLCB1bm11dGVCdXR0b259ID0gdGhpcy5nZXRDb250cm9sc18oKTtcbiAgICBzd2FwKG11dGVCdXR0b24sIHVubXV0ZUJ1dHRvbik7XG4gIH1cblxuICAvKiogQHByaXZhdGUgKi9cbiAgb25Vbm11dGVfKCkge1xuICAgIGNvbnN0IHt1bm11dGVCdXR0b24sIG11dGVCdXR0b259ID0gdGhpcy5nZXRDb250cm9sc18oKTtcbiAgICBzd2FwKHVubXV0ZUJ1dHRvbiwgbXV0ZUJ1dHRvbik7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldFhcbiAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldFlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIG9mZnNldF8ob2Zmc2V0WCwgb2Zmc2V0WSkge1xuICAgIGNvbnN0IHZpZGVvID0gdGhpcy5nZXREb2NrZWRWaWRlb18oKTtcbiAgICBjb25zdCB7dGFyZ2V0fSA9IHRoaXMuY3VycmVudGx5RG9ja2VkXztcblxuICAgIGNvbnN0IHN0ZXAgPSAxO1xuXG4gICAgY29uc3Qge3gsIHksIHNjYWxlfSA9IHRoaXMuZ2V0RGltc18odmlkZW8sIHRhcmdldCwgc3RlcCk7XG4gICAgdGhpcy5wbGFjZUF0Xyh2aWRlbywgeCArIG9mZnNldFgsIHkgKyBvZmZzZXRZLCBzY2FsZSwgc3RlcCxcbiAgICAgICAgLyogdHJhbnNpdGlvbkR1cmF0aW9uTXMgKi8gMCk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshLi4vLi4vdmlkZW8taW50ZXJmYWNlLlZpZGVvT3JCYXNlRWxlbWVudERlZn0gdmlkZW9cbiAgICogQHByaXZhdGVcbiAgICovXG4gIG9uRG9ja2luZ1RpbWVvdXRfKHZpZGVvKSB7XG4gICAgaWYgKHRoaXMuaXNEcmFnZ2luZ18gfHxcbiAgICAgICAgdGhpcy5pZ25vcmVCZWNhdXNlQW5vdGhlckRvY2tlZF8odmlkZW8pIHx8XG4gICAgICAgICF0aGlzLmN1cnJlbnRseURvY2tlZF8gfHxcbiAgICAgICAgKCF0aGlzLmN1cnJlbnRQb3NpdGlvbk1hdGNoZXNTY3JvbGxfKCkgJiZcbiAgICAgICAgICAgIHRoaXMudW5kb2NrQmVjYXVzZVZpc2libGVfKFxuICAgICAgICAgICAgICAgIHZpZGVvLCBSRVZFUlRfVE9fSU5MSU5FX1JBVElPLCAvKiB0aW1lb3V0ICovIDUwKSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qge3RhcmdldH0gPSBkZXYoKS5hc3NlcnQodGhpcy5jdXJyZW50bHlEb2NrZWRfKTtcbiAgICB0aGlzLmRvY2tfKHZpZGVvLCB0YXJnZXQsIC8qIHN0ZXAgKi8gMSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshQW1wRWxlbWVudH0gZWxlbWVudFxuICAgKiBAcGFyYW0ge251bWJlcj19IG1pblJhdGlvXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBpc1Zpc2libGVfKGVsZW1lbnQsIG1pblJhdGlvID0gMSkge1xuICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuc2xvdEhhc0RpbWVuc2lvbnNfKCkgPyB0aGlzLmdldFNsb3RfKCkgOiBudWxsO1xuICAgIGNvbnN0IGludGVyc2VjdGlvblJhdGlvID0gdGhpcy5jYWxjdWxhdGVJbnRlcnNlY3Rpb25SYXRpb18oZWxlbWVudCwgdGFyZ2V0KTtcbiAgICByZXR1cm4gaW50ZXJzZWN0aW9uUmF0aW8gPiAobWluUmF0aW8gLSBGTE9BVF9UT0xFUkFOQ0UpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBhbW91bnRcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGhhc1RyYW5zaXRpb25Db21wbGV0ZWRfKGFtb3VudCA9IDEpIHtcbiAgICByZXR1cm4gISF0aGlzLmN1cnJlbnRseURvY2tlZF8gJiZcbiAgICAgICAgdGhpcy5jdXJyZW50bHlEb2NrZWRfLnN0ZXAgPj0gKGFtb3VudCAtIEZMT0FUX1RPTEVSQU5DRSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshTW91c2VFdmVudHwhVG91Y2hFdmVudH0gZVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZHJhZ18oZSkge1xuICAgIGlmICghdGhpcy5jdXJyZW50bHlEb2NrZWRfKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNEb2NrZWRUb1Nsb3RfKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBEb24ndCBhbGxvdyBkcmFnZ2luZyB2aWRlb3MgdGhhdCBhcmUgdG9vIGVhcmx5IGluIHRoZWlyIHRyYW5zaXRpb24gcGhhc2UuXG4gICAgLy8gVGhpcyBhbGxvd3MgdGhlIHVzZXIgdG8ga2VlcCBzY3JvbGxpbmcgd2hpbGUgdG91Y2hpbmcgdGhlIGlubGluZS9hbG1vc3RcbiAgICAvLyBpbmxpbmUgdmlkZW8gYXJlYS5cbiAgICBpZiAoIXRoaXMuaGFzVHJhbnNpdGlvbkNvbXBsZXRlZF8oMC43NSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB7eDogaW5pdGlhbFgsIHk6IGluaXRpYWxZfSA9IHBvaW50ZXJDb29yZHMoZSk7XG5cbiAgICBjb25zdCBvZmZzZXQgPSB7eDogMCwgeTogMH07XG4gICAgY29uc3Qge3Bvc1g6IGN1cnJlbnRQb3NYLCBwb3NZOiBjdXJyZW50UG9zWX0gPSB0aGlzLmN1cnJlbnRseURvY2tlZF8udGFyZ2V0O1xuXG4gICAgY29uc3Qgb25EcmFnTW92ZSA9IHRocm90dGxlQnlBbmltYXRpb25GcmFtZSh0aGlzLmFtcGRvY18ud2luLFxuICAgICAgICBlID0+IHRoaXMub25EcmFnTW92ZV8oXG4gICAgICAgICAgICAvKiogQHR5cGUgeyFUb3VjaEV2ZW50fCFNb3VzZUV2ZW50fSAqLyAoZSksXG4gICAgICAgICAgICBjdXJyZW50UG9zWCwgY3VycmVudFBvc1ksIGluaXRpYWxYLCBpbml0aWFsWSwgb2Zmc2V0KSk7XG5cbiAgICBjb25zdCBvbkRyYWdFbmQgPSAoKSA9PiB0aGlzLm9uRHJhZ0VuZF8odW5saXN0ZW5lcnMsIG9mZnNldCk7XG5cbiAgICBjb25zdCByb290ID0gdGhpcy5hbXBkb2NfLmdldFJvb3ROb2RlKCk7XG4gICAgY29uc3QgdW5saXN0ZW5lcnMgPSBbXG4gICAgICB0aGlzLmRpc2FibGVTY3JvbGxfKCksXG4gICAgICB0aGlzLmRpc2FibGVVc2VyU2VsZWN0XygpLFxuICAgICAgdGhpcy53b3JrYXJvdW5kV2Via2l0RHJhZ0FuZFNjcm9sbElzc3VlXygpLFxuICAgICAgbGlzdGVuKHJvb3QsICd0b3VjaG1vdmUnLCBvbkRyYWdNb3ZlKSxcbiAgICAgIGxpc3Rlbihyb290LCAnbW91c2Vtb3ZlJywgb25EcmFnTW92ZSksXG4gICAgICBsaXN0ZW5PbmNlKHJvb3QsICd0b3VjaGVuZCcsIG9uRHJhZ0VuZCksXG4gICAgICBsaXN0ZW5PbmNlKHJvb3QsICdtb3VzZXVwJywgb25EcmFnRW5kKSxcbiAgICBdO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBpc0RvY2tlZFRvU2xvdF8oKSB7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRseURvY2tlZF8pIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIGlzRWxlbWVudCh0aGlzLmN1cnJlbnRseURvY2tlZF8udGFyZ2V0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshVW5saXN0ZW5EZWZ9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBkaXNhYmxlVXNlclNlbGVjdF8oKSB7XG4gICAgY29uc3QgZG9jRWwgPSBkZXYoKS5hc3NlcnRFbGVtZW50KHRoaXMuZ2V0RG9jXygpLmRvY3VtZW50RWxlbWVudCk7XG4gICAgY29uc3QgZGlzYWJsZWRDbGFzc05hbWUgPSAnaS1hbXBodG1sLXNlbGVjdC1kaXNhYmxlZCc7XG4gICAgZG9jRWwuY2xhc3NMaXN0LmFkZChkaXNhYmxlZENsYXNzTmFtZSk7XG4gICAgcmV0dXJuICgpID0+IGRvY0VsLmNsYXNzTGlzdC5yZW1vdmUoZGlzYWJsZWRDbGFzc05hbWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFVbmxpc3RlbkRlZn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGRpc2FibGVTY3JvbGxfKCkge1xuICAgIHRoaXMudmlld3BvcnRfLmRpc2FibGVTY3JvbGwoKTtcbiAgICByZXR1cm4gdGhpcy52aWV3cG9ydF8ucmVzZXRTY3JvbGwuYmluZCh0aGlzLnZpZXdwb3J0Xyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshTW91c2VFdmVudHwhVG91Y2hFdmVudH0gZVxuICAgKiBAcGFyYW0geyFSZWxhdGl2ZVh9IHN0YXJ0UG9zWFxuICAgKiBAcGFyYW0geyFSZWxhdGl2ZVl9IHN0YXJ0UG9zWVxuICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnRYXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydFlcbiAgICogQHBhcmFtIHt7eDogbnVtYmVyLCB5OiBudW1iZXJ9fSBvZmZzZXRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIG9uRHJhZ01vdmVfKGUsIHN0YXJ0UG9zWCwgc3RhcnRQb3NZLCBzdGFydFgsIHN0YXJ0WSwgb2Zmc2V0KSB7XG4gICAgY29uc3Qge3Bvc1gsIHBvc1l9ID0gdGhpcy5jdXJyZW50bHlEb2NrZWRfLnRhcmdldDtcbiAgICBpZiAocG9zWCAhPT0gc3RhcnRQb3NYIHx8IHBvc1kgIT09IHN0YXJ0UG9zWSkge1xuICAgICAgLy8gc3RhbGUgZXZlbnRcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB7eCwgeX0gPSBwb2ludGVyQ29vcmRzKGUpO1xuICAgIG9mZnNldC54ID0geCAtIHN0YXJ0WDtcbiAgICBvZmZzZXQueSA9IHkgLSBzdGFydFk7XG5cbiAgICAvLyBQcmV2ZW50cyBkcmFnZ2luZyBtaXNmaXJlcy5cbiAgICBjb25zdCBvZmZzZXREaXN0ID0gTWF0aC5zcXJ0KE1hdGgucG93KG9mZnNldC54LCAyKSArIE1hdGgucG93KG9mZnNldC55LCAyKSk7XG4gICAgaWYgKG9mZnNldERpc3QgPD0gMTApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgIHRoaXMuaGlkZUNvbnRyb2xzXygpO1xuICAgIHRoaXMuaXNEcmFnZ2luZ18gPSB0cnVlO1xuICAgIHRoaXMub2Zmc2V0XyhvZmZzZXQueCwgb2Zmc2V0LnkpO1xuICAgIHRoaXMudXBkYXRlRGlzbWlzc2FsQXJlYVN0eWxpbmdfKG9mZnNldC54LCBvZmZzZXQueSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldFhcbiAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldFlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHVwZGF0ZURpc21pc3NhbEFyZWFTdHlsaW5nXyhvZmZzZXRYLCBvZmZzZXRZKSB7XG4gICAgY29uc3QgdmlkZW8gPSB0aGlzLmdldERvY2tlZFZpZGVvXygpO1xuICAgIGNvbnN0IHtlbGVtZW50fSA9IHZpZGVvO1xuICAgIGNvbnN0IGludGVybmFsRWxlbWVudCA9IGdldEludGVybmFsVmlkZW9FbGVtZW50Rm9yKGVsZW1lbnQpO1xuICAgIGNvbnN0IGluRGlzbWlzc2FsQXJlYSA9IHRoaXMuaW5EaXNtaXNzYWxBcmVhXyhvZmZzZXRYLCBvZmZzZXRZKTtcblxuICAgIHZpZGVvLm11dGF0ZUVsZW1lbnQoKCkgPT4ge1xuICAgICAgY29uc3QgY2xhc3NOYW1lID0gJ2FtcC12aWRlby1kb2NrZWQtYWxtb3N0LWRpc21pc3NlZCc7XG4gICAgICBpbnRlcm5hbEVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZShjbGFzc05hbWUsIGluRGlzbWlzc2FsQXJlYSk7XG4gICAgICB0aGlzLmdldE92ZXJsYXlfKCkuY2xhc3NMaXN0LnRvZ2dsZShjbGFzc05hbWUsIGluRGlzbWlzc2FsQXJlYSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogV29ya3MgYXJvdW5kIGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xODQyNTBcbiAgICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgd29ya2Fyb3VuZFdlYmtpdERyYWdBbmRTY3JvbGxJc3N1ZV8oKSB7XG4gICAgY29uc3Qge3dpbn0gPSB0aGlzLmFtcGRvY187XG4gICAgaWYgKCFTZXJ2aWNlcy5wbGF0Zm9ybUZvcih3aW4pLmlzSW9zKCkpIHtcbiAgICAgIHJldHVybiAoKSA9PiB7IC8qIE5PT1AgKi8gfTtcbiAgICB9XG4gICAgY29uc3QgaGFuZGxlciA9IGUgPT4gZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHdpbi5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBoYW5kbGVyLCB7cGFzc2l2ZTogZmFsc2V9KTtcbiAgICByZXR1cm4gKCkgPT4gd2luLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIGhhbmRsZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUFycmF5PCFVbmxpc3RlbkRlZj59IHVubGlzdGVuZXJzXG4gICAqIEBwYXJhbSB7e3g6IG51bWJlciwgeTogbnVtYmVyfX0gb2Zmc2V0XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBvbkRyYWdFbmRfKHVubGlzdGVuZXJzLCBvZmZzZXQpIHtcbiAgICB1bmxpc3RlbmVycy5mb3JFYWNoKHVubGlzdGVuID0+IHVubGlzdGVuLmNhbGwoKSk7XG5cbiAgICB0aGlzLmlzRHJhZ2dpbmdfID0gZmFsc2U7XG5cbiAgICBpZiAodGhpcy5kaXNtaXNzT25EcmFnRW5kXyhvZmZzZXQueCwgb2Zmc2V0LnkpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5zbmFwVG9Db3JuZXJfKG9mZnNldC54LCBvZmZzZXQueSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldFhcbiAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldFlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGRpc21pc3NPbkRyYWdFbmRfKG9mZnNldFgsIG9mZnNldFkpIHtcbiAgICBjb25zdCBpbkRpbWlzc2FsQXJlYSA9IHRoaXMuaW5EaXNtaXNzYWxBcmVhXyhvZmZzZXRYLCBvZmZzZXRZKTtcbiAgICBpZiAoaW5EaW1pc3NhbEFyZWEpIHtcbiAgICAgIHRoaXMuZGlzbWlzc18oKTtcbiAgICB9XG4gICAgcmV0dXJuIGluRGltaXNzYWxBcmVhO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBvZmZzZXRYXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBvZmZzZXRZXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBpbkRpc21pc3NhbEFyZWFfKG9mZnNldFgsIG9mZnNldFkpIHtcbiAgICAvLyBUT0RPOiBVc2UgdG9wRWRnZS9ib3R0b21FZGdlXG4gICAgY29uc3QgZGlzbWlzc1RvbGVyYW5jZUZyb21DZW50ZXJQeCA9IDIwO1xuICAgIGNvbnN0IHt3aWR0aDogdncsIGhlaWdodDogdmh9ID0gdGhpcy52aWV3cG9ydF8uZ2V0U2l6ZSgpO1xuICAgIGNvbnN0IHtjZW50ZXJYLCBjZW50ZXJZfSA9IHRoaXMuZ2V0Q2VudGVyXyhvZmZzZXRYLCBvZmZzZXRZKTtcbiAgICByZXR1cm4gY2VudGVyWCA+PSAodncgLSBkaXNtaXNzVG9sZXJhbmNlRnJvbUNlbnRlclB4KSB8fFxuICAgICAgICBjZW50ZXJYIDw9IGRpc21pc3NUb2xlcmFuY2VGcm9tQ2VudGVyUHggfHxcbiAgICAgICAgY2VudGVyWSA+PSAodmggLSBkaXNtaXNzVG9sZXJhbmNlRnJvbUNlbnRlclB4KSB8fFxuICAgICAgICBjZW50ZXJZIDw9IGRpc21pc3NUb2xlcmFuY2VGcm9tQ2VudGVyUHg7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY2VudGVyIG9mIHRoZSBjdXJyZW50bHkgZG9ja2VkIHZpZGVvLCBvZmZzZXQgYnkgKHgsIHkpLlxuICAgKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0WFxuICAgKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0WVxuICAgKiBAcmV0dXJuIHt7Y2VudGVyWDogbnVtYmVyLCBjZW50ZXJZOiBudW1iZXJ9fVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0Q2VudGVyXyhvZmZzZXRYLCBvZmZzZXRZKSB7XG4gICAgY29uc3Qge3RhcmdldCwgc3RlcH0gPSB0aGlzLmN1cnJlbnRseURvY2tlZF87XG4gICAgY29uc3QgdmlkZW8gPSB0aGlzLmdldERvY2tlZFZpZGVvXygpO1xuICAgIGNvbnN0IHt3aWR0aCwgaGVpZ2h0fSA9IHZpZGVvLmdldExheW91dEJveCgpO1xuICAgIGNvbnN0IHt4LCB5LCBzY2FsZX0gPSB0aGlzLmdldERpbXNfKHZpZGVvLCB0YXJnZXQsIHN0ZXApO1xuXG4gICAgY29uc3QgY2VudGVyWCA9IHggKyBvZmZzZXRYICsgKHdpZHRoICogc2NhbGUgLyAyKTtcbiAgICBjb25zdCBjZW50ZXJZID0geSArIG9mZnNldFkgKyAoaGVpZ2h0ICogc2NhbGUgLyAyKTtcblxuICAgIHJldHVybiB7Y2VudGVyWCwgY2VudGVyWX07XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldFhcbiAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldFlcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHNuYXBUb0Nvcm5lcl8ob2Zmc2V0WCwgb2Zmc2V0WSkge1xuICAgIGNvbnN0IHZpZGVvID0gdGhpcy5nZXREb2NrZWRWaWRlb18oKTtcbiAgICBjb25zdCB7c3RlcH0gPSB0aGlzLmN1cnJlbnRseURvY2tlZF87XG5cbiAgICBjb25zdCB7Y2VudGVyWCwgY2VudGVyWX0gPSB0aGlzLmdldENlbnRlcl8ob2Zmc2V0WCwgb2Zmc2V0WSk7XG5cbiAgICBsZXQgbWluRGlzdGFuY2UgPSBudWxsO1xuICAgIGxldCBjbG9zZXN0Q29ybmVyWCA9IG51bGw7XG4gICAgbGV0IGNsb3Nlc3RDb3JuZXJZID0gbnVsbDtcblxuICAgIFtSZWxhdGl2ZVguTEVGVCwgUmVsYXRpdmVYLlJJR0hUXS5mb3JFYWNoKHBvc1ggPT4ge1xuICAgICAgW1JlbGF0aXZlWS5UT1AsIFJlbGF0aXZlWS5CT1RUT01dLmZvckVhY2gocG9zWSA9PiB7XG4gICAgICAgIGNvbnN0IGNvcm5lclggPSBwb3NYID09IFJlbGF0aXZlWC5MRUZUID9cbiAgICAgICAgICB0aGlzLmdldExlZnRFZGdlXygpIDpcbiAgICAgICAgICB0aGlzLmdldFJpZ2h0RWRnZV8oKTtcbiAgICAgICAgY29uc3QgY29ybmVyWSA9IHBvc1kgPT0gUmVsYXRpdmVZLlRPUCA/XG4gICAgICAgICAgdGhpcy5nZXRUb3BFZGdlXygpIDpcbiAgICAgICAgICB0aGlzLmdldEJvdHRvbUVkZ2VfKCk7XG4gICAgICAgIGNvbnN0IGRpc3RhbmNlID0gTWF0aC5zcXJ0KFxuICAgICAgICAgICAgTWF0aC5wb3coY29ybmVyWCAtIGNlbnRlclgsIDIpICtcbiAgICAgICAgICAgIE1hdGgucG93KGNvcm5lclkgLSBjZW50ZXJZLCAyKSk7XG4gICAgICAgIGlmIChtaW5EaXN0YW5jZSA9PT0gbnVsbCB8fFxuICAgICAgICAgICAgZGlzdGFuY2UgPCBtaW5EaXN0YW5jZSkge1xuICAgICAgICAgIG1pbkRpc3RhbmNlID0gZGlzdGFuY2U7XG4gICAgICAgICAgY2xvc2VzdENvcm5lclkgPSBwb3NZO1xuICAgICAgICAgIGNsb3Nlc3RDb3JuZXJYID0gcG9zWDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBjb25zdCB0YXJnZXQgPSB7XG4gICAgICBwb3NYOiBjbG9zZXN0Q29ybmVyWCxcbiAgICAgIHBvc1k6IGNsb3Nlc3RDb3JuZXJZLFxuICAgIH07XG5cbiAgICB0aGlzLmN1cnJlbnRseURvY2tlZF8udGFyZ2V0ID0gdGFyZ2V0O1xuXG4gICAgdGhpcy5wcmVmZXJyZWRDb3JuZXJYXyA9IGNsb3Nlc3RDb3JuZXJYO1xuXG4gICAgY29uc3Qge3gsIHksIHNjYWxlfSA9IHRoaXMuZ2V0RGltc18odmlkZW8sIHRhcmdldCwgc3RlcCk7XG5cbiAgICB0aGlzLnBsYWNlQXRfKHZpZGVvLCB4LCB5LCBzY2FsZSwgc3RlcCwgLyogb3B0VHJhbnNpdGlvbkR1cmF0aW9uTXMgKi8gMjAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSB0YXJnZXRcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGlzQ29udHJvbHNFdmVudFRhcmdldF8odGFyZ2V0KSB7XG4gICAgcmV0dXJuICEhY2xvc2VzdEJ5U2VsZWN0b3IodGFyZ2V0LCAnLmFtcC12aWRlby1kb2NrZWQtY29udHJvbHMnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyEuLi8uLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSB2aWRlb1xuICAgKiBAcGFyYW0geyFEb2NrVGFyZ2V0RGVmfSB0YXJnZXRcbiAgICogQHJldHVybiB7IVRhcmdldEFyZWFEZWZ9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRUYXJnZXRBcmVhXyh2aWRlbywgdGFyZ2V0KSB7XG4gICAgcmV0dXJuIGlzRWxlbWVudCh0YXJnZXQpID9cbiAgICAgIHRoaXMuZ2V0VGFyZ2V0QXJlYUZyb21TbG90Xyh2aWRlbywgZGV2KCkuYXNzZXJ0RWxlbWVudCh0YXJnZXQpKSA6XG4gICAgICB0aGlzLmdldFRhcmdldEFyZWFGcm9tUG9zXyh2aWRlbywgdGFyZ2V0LnBvc1gsIHRhcmdldC5wb3NZKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyEuLi8uLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSB2aWRlb1xuICAgKiBAcGFyYW0geyFSZWxhdGl2ZVh9IHBvc1hcbiAgICogQHBhcmFtIHshUmVsYXRpdmVZfSBwb3NZXG4gICAqIEByZXR1cm4geyFUYXJnZXRBcmVhRGVmfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0VGFyZ2V0QXJlYUZyb21Qb3NfKHZpZGVvLCBwb3NYLCBwb3NZKSB7XG4gICAgY29uc3Qge3dpZHRoLCBoZWlnaHR9ID0gdmlkZW8uZ2V0TGF5b3V0Qm94KCk7XG4gICAgY29uc3QgbWFyZ2luID0gdGhpcy5nZXRNYXJnaW5fKCk7XG4gICAgY29uc3QgYXNwZWN0UmF0aW8gPSB3aWR0aCAvIGhlaWdodDtcbiAgICBjb25zdCB0YXJnZXRXaWR0aCA9IE1hdGgubWF4KE1JTl9XSURUSCwgdGhpcy5nZXRBcmVhV2lkdGhfKCkgKiAwLjMpO1xuICAgIGNvbnN0IHRhcmdldEhlaWdodCA9IHRhcmdldFdpZHRoIC8gYXNwZWN0UmF0aW87XG5cbiAgICBjb25zdCB4ID1cbiAgICAgIChwb3NYID09IFJlbGF0aXZlWC5SSUdIVCA/XG4gICAgICAgIHRoaXMuZ2V0UmlnaHRFZGdlXygpIC0gbWFyZ2luIC0gdGFyZ2V0V2lkdGggOlxuICAgICAgICB0aGlzLmdldExlZnRFZGdlXygpICsgbWFyZ2luKTtcblxuICAgIGNvbnN0IHkgPVxuICAgICAgKHBvc1kgPT0gUmVsYXRpdmVZLlRPUCA/XG4gICAgICAgIHRoaXMuZ2V0VG9wRWRnZV8oKSArIG1hcmdpbiA6XG4gICAgICAgIHRoaXMuZ2V0Qm90dG9tRWRnZV8oKSAtIG1hcmdpbiAtIHRhcmdldEhlaWdodCk7XG5cbiAgICBjb25zdCBpbml0aWFsWSA9IHRoaXMuY2FsY3VsYXRlSW5pdGlhbFlfKFxuICAgICAgICBwb3NZLCB0aGlzLmdldFRvcEVkZ2VfKCksIHRoaXMuZ2V0Qm90dG9tRWRnZV8oKSwgaGVpZ2h0KTtcblxuICAgIHJldHVybiB7eCwgeSwgdGFyZ2V0V2lkdGgsIHRhcmdldEhlaWdodCwgaW5pdGlhbFl9O1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uLy4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9IHZpZGVvXG4gICAqIEBwYXJhbSB7IUFtcEVsZW1lbnR9IHNsb3RcbiAgICogQHJldHVybiB7IVRhcmdldEFyZWFEZWZ9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRUYXJnZXRBcmVhRnJvbVNsb3RfKHZpZGVvLCBzbG90KSB7XG4gICAgY29uc3Qge1xuICAgICAgd2lkdGg6IG5hdHVyYWxXaWR0aCxcbiAgICAgIGhlaWdodDogbmF0dXJhbEhlaWdodCxcbiAgICB9ID0gdmlkZW8uZ2V0TGF5b3V0Qm94KCk7XG5cbiAgICBjb25zdCB7XG4gICAgICB3aWR0aDogc2xvdFdpZHRoLFxuICAgICAgaGVpZ2h0OiBzbG90SGVpZ2h0LFxuICAgICAgbGVmdCxcbiAgICB9ID0gc2xvdC5nZXRMYXlvdXRCb3goKTtcblxuICAgIGNvbnN0IHt0b3AsIGJvdHRvbX0gPSB0aGlzLmdldEZpeGVkU2xvdExheW91dEJveF8oKTtcblxuICAgIGNvbnN0IHNsb3RBc3BlY3QgPSBzbG90V2lkdGggLyBzbG90SGVpZ2h0O1xuICAgIGNvbnN0IG5hdHVyYWxBc3BlY3QgPSBuYXR1cmFsV2lkdGggLyBuYXR1cmFsSGVpZ2h0O1xuXG4gICAgbGV0IHgsIHksIHNjYWxlO1xuXG4gICAgaWYgKG5hdHVyYWxBc3BlY3QgPiBzbG90QXNwZWN0KSB7XG4gICAgICBzY2FsZSA9IHNsb3RXaWR0aCAvIG5hdHVyYWxXaWR0aDtcbiAgICAgIHkgPSB0b3AgKyAoc2xvdEhlaWdodCAvIDIpIC0gKG5hdHVyYWxIZWlnaHQgKiBzY2FsZSAvIDIpO1xuICAgICAgeCA9IGxlZnQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNjYWxlID0gc2xvdEhlaWdodCAvIG5hdHVyYWxIZWlnaHQ7XG4gICAgICB4ID0gbGVmdCArIChzbG90V2lkdGggLyAyKSAtIChuYXR1cmFsV2lkdGggKiBzY2FsZSAvIDIpO1xuICAgICAgeSA9IHRvcDtcbiAgICB9XG5cbiAgICBjb25zdCBpbml0aWFsWSA9IHRoaXMuY2FsY3VsYXRlSW5pdGlhbFlfKFxuICAgICAgICB0aGlzLmdldFNsb3RSZWxhdGl2ZVlfKCksIHRvcCwgYm90dG9tLCBuYXR1cmFsSGVpZ2h0KTtcblxuICAgIGNvbnN0IHRhcmdldFdpZHRoID0gbmF0dXJhbFdpZHRoICogc2NhbGU7XG4gICAgY29uc3QgdGFyZ2V0SGVpZ2h0ID0gbmF0dXJhbEhlaWdodCAqIHNjYWxlO1xuXG4gICAgcmV0dXJuIHt4LCB5LCB0YXJnZXRXaWR0aCwgdGFyZ2V0SGVpZ2h0LCBpbml0aWFsWX07XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshUmVsYXRpdmVZfSBwb3NcbiAgICogQHBhcmFtIHtudW1iZXJ9IHRhcmdldFRvcFxuICAgKiBAcGFyYW0ge251bWJlcn0gdGFyZ2V0Qm90dG9tXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBuYXR1cmFsSGVpZ2h0XG4gICAqIEByZXR1cm4ge251bWJlcn1cbiAgICovXG4gIGNhbGN1bGF0ZUluaXRpYWxZXyhwb3MsIHRhcmdldFRvcCwgdGFyZ2V0Qm90dG9tLCBuYXR1cmFsSGVpZ2h0KSB7XG4gICAgcmV0dXJuIHBvcyA9PSBSZWxhdGl2ZVkuVE9QID8gdGFyZ2V0VG9wIDogdGFyZ2V0Qm90dG9tIC0gbmF0dXJhbEhlaWdodDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyEuLi8uLi92aWRlby1pbnRlcmZhY2UuVmlkZW9PckJhc2VFbGVtZW50RGVmfSB2aWRlb1xuICAgKiBAcGFyYW0geyFEb2NrVGFyZ2V0RGVmfSB0YXJnZXRcbiAgICogQHBhcmFtIHtudW1iZXJ9IHN0ZXAgaW4gWzAuLjFdXG4gICAqIEByZXR1cm4ge3t4OiBudW1iZXIsIHk6IG51bWJlciwgc2NhbGU6IG51bWJlcn19XG4gICAqL1xuICBnZXREaW1zXyh2aWRlbywgdGFyZ2V0LCBzdGVwKSB7XG4gICAgY29uc3Qge2xlZnQsIHdpZHRofSA9IHZpZGVvLmdldExheW91dEJveCgpO1xuICAgIGNvbnN0IHt4LCB5LCB0YXJnZXRXaWR0aCwgaW5pdGlhbFl9ID0gdGhpcy5nZXRUYXJnZXRBcmVhXyh2aWRlbywgdGFyZ2V0KTtcbiAgICBjb25zdCBjdXJyZW50WCA9IG1hcFN0ZXAoc3RlcCwgbGVmdCwgeCk7XG4gICAgY29uc3QgY3VycmVudFdpZHRoID0gbWFwU3RlcChzdGVwLCB3aWR0aCwgdGFyZ2V0V2lkdGgpO1xuICAgIGNvbnN0IGN1cnJlbnRZID0gbWFwU3RlcChzdGVwLCBpbml0aWFsWSwgeSk7XG4gICAgY29uc3Qgc2NhbGUgPSBjdXJyZW50V2lkdGggLyB3aWR0aDtcbiAgICByZXR1cm4ge3g6IGN1cnJlbnRYLCB5OiBjdXJyZW50WSwgc2NhbGV9O1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4uLy4uL3ZpZGVvLWludGVyZmFjZS5WaWRlb09yQmFzZUVsZW1lbnREZWZ9IHZpZGVvXG4gICAqIEBwYXJhbSB7bnVtYmVyPX0gdW51c2VkRGlzbWlzc0RpclhcbiAgICogQHBhcmFtIHtudW1iZXI9fSB1bnVzZWREaXNtaXNzRGlyWVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdW5kb2NrXyh2aWRlbywgdW51c2VkRGlzbWlzc0RpclggPSAwLCB1bnVzZWREaXNtaXNzRGlyWSA9IDApIHtcbiAgICAvLyBUT0RPKGFsYW5vcm96Y28pOiBhbmltYXRlIGRpc21pc3NhbFxuICAgIGNvbnN0IGludGVybmFsRWxlbWVudCA9IGdldEludGVybmFsVmlkZW9FbGVtZW50Rm9yKHZpZGVvLmVsZW1lbnQpO1xuXG4gICAgdGhpcy50cmlnZ2VyXyh2aWRlbywgQWN0aW9ucy5VTkRPQ0spO1xuXG4gICAgdmlkZW8ubXV0YXRlRWxlbWVudCgoKSA9PiB7XG4gICAgICB0aGlzLmhpZGVDb250cm9sc18oKTtcbiAgICAgIHZpZGVvLnNob3dDb250cm9scygpO1xuICAgICAgdGhpcy5wbGFjZWRBdF8gPSBudWxsO1xuICAgICAgdGhpcy5zaXplZEF0XyA9IG51bGw7XG4gICAgICBpbnRlcm5hbEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShCQVNFX0NMQVNTX05BTUUpO1xuICAgICAgY29uc3Qgc2hhZG93TGF5ZXIgPSB0aGlzLmdldFNoYWRvd0xheWVyXygpO1xuICAgICAgY29uc3Qgb3ZlcmxheSA9IHRoaXMuZ2V0T3ZlcmxheV8oKTtcbiAgICAgIGNvbnN0IGFsbW9zdERpc21pc3NlZCA9ICdhbXAtdmlkZW8tZG9ja2VkLWFsbW9zdC1kaXNtaXNzZWQnO1xuICAgICAgaW50ZXJuYWxFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoYWxtb3N0RGlzbWlzc2VkKTtcbiAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZShhbG1vc3REaXNtaXNzZWQpO1xuICAgICAgY29uc3Qgc3R5bGVzVG9SZXNldCA9IFtcbiAgICAgICAgJ3RyYW5zZm9ybScsXG4gICAgICAgICd0cmFuc2l0aW9uJyxcbiAgICAgICAgJ3dpZHRoJyxcbiAgICAgICAgJ2hlaWdodCcsXG4gICAgICAgICdvcGFjaXR5JyxcbiAgICAgIF07XG4gICAgICBzaGFkb3dMYXllci5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTtcbiAgICAgIG92ZXJsYXkuc2V0QXR0cmlidXRlKCdoaWRkZW4nLCAnJyk7XG4gICAgICByZXNldFN0eWxlcyhpbnRlcm5hbEVsZW1lbnQsIHN0eWxlc1RvUmVzZXQpO1xuICAgICAgcmVzZXRTdHlsZXMoc2hhZG93TGF5ZXIsIHN0eWxlc1RvUmVzZXQpO1xuICAgICAgcmVzZXRTdHlsZXMob3ZlcmxheSwgc3R5bGVzVG9SZXNldCk7XG4gICAgICB0aGlzLmN1cnJlbnRseURvY2tlZF8gPSBudWxsO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IHJlc3BlY3RTdGlja3lcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGhpZGVDb250cm9sc18ocmVzcGVjdFN0aWNreSA9IGZhbHNlKSB7XG4gICAgaWYgKHJlc3BlY3RTdGlja3kgJiYgdGhpcy5zdGlja3lDb250cm9sc18pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qge2NvbnRhaW5lcn0gPSB0aGlzLmdldENvbnRyb2xzXygpO1xuICAgIGNvbnN0IG92ZXJsYXkgPSB0aGlzLmdldE92ZXJsYXlfKCk7XG4gICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKCdhbXAtdmlkZW8tZG9ja2VkLWNvbnRyb2xzLWJnJyk7XG4gICAgY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2FtcC12aWRlby1kb2NrZWQtY29udHJvbHMtc2hvd24nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcj19IHRpbWVcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGhpZGVDb250cm9sc09uVGltZW91dF8odGltZSA9IENPTlRST0xTX1RJTUVPVVQpIHtcbiAgICB0aGlzLmdldEhpZGVDb250cm9sc1RpbWVvdXRfKCkudHJpZ2dlcih0aW1lKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHJlbW92ZVBvc3RlckZvckFuZHJvaWRCdWdfKHBhcmVudCkge1xuICAgIGNvbnN0IGVsID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJy5pLWFtcGh0bWwtYW5kcm9pZC1wb3N0ZXItYnVnJyk7XG4gICAgaWYgKCFlbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZW1vdmVFbGVtZW50KGVsKTtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7aW5zdGFsbFN0eWxlc0ZvckRvY30gZnJvbSAnLi4vLi4vc3R5bGUtaW5zdGFsbGVyJztcbi8vIFNvdXJjZSBmb3IgdGhpcyBjb25zdGFudCBpcyBjc3MvdmlkZW8tYXV0b3BsYXkuY3NzXG5pbXBvcnQge2Nzc1RleHR9IGZyb20gJy4uLy4uLy4uL2J1aWxkL3ZpZGVvLWF1dG9wbGF5LmNzcy5qcyc7XG5cblxuLyoqXG4gKiBAcGFyYW0gIHshLi4vYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGxBdXRvcGxheVN0eWxlc0ZvckRvYyhhbXBkb2MpIHtcbiAgaW5zdGFsbFN0eWxlc0ZvckRvYyhcbiAgICAgIGFtcGRvYyxcbiAgICAgIGNzc1RleHQsXG4gICAgICAvKiBjYWxsYmFjayAqLyBudWxsLFxuICAgICAgLyogb3B0X2lzUnVudGltZUNzcyAqLyBmYWxzZSxcbiAgICAgIC8qIG9wdF9leHQgKi8gJ2FtcC12aWRlby1hdXRvcGxheScpO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIGdldEFtcGRvYyxcbiAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlLFxuICBnZXRFeGlzdGluZ1NlcnZpY2VPck51bGwsXG4gIGdldFNlcnZpY2UsXG4gIGdldFNlcnZpY2VGb3JEb2MsXG4gIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkLFxuICBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyxcbn0gZnJvbSAnLi9zZXJ2aWNlJztcbmltcG9ydCB7XG4gIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jLFxuICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlLFxuICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jLFxuICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jSW5FbWJlZFNjb3BlLFxufSBmcm9tICcuL2VsZW1lbnQtc2VydmljZSc7XG5cbi8qKiBAdHlwZWRlZiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN1YnNjcmlwdGlvbnMvMC4xL2FtcC1zdWJzY3JpcHRpb25zLlN1YnNjcmlwdGlvblNlcnZpY2V9ICovXG5leHBvcnQgbGV0IFN1YnNjcmlwdGlvblNlcnZpY2U7XG5cbmV4cG9ydCBjbGFzcyBTZXJ2aWNlcyB7XG4gIC8qKlxuICAgKiBIaW50OiBBZGQgZXh0ZW5zaW9ucyBmb2xkZXIgcGF0aCB0byBjb21waWxlLmpzIHdpdGhcbiAgICogd2FybmluZ3MgY2Fubm90IGZpbmQgbW9kdWxlcy5cbiAgICovXG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIGZvciB0aGUgQWNjZXNzIHNlcnZpY2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtYWNjZXNzLzAuMS9hbXAtYWNjZXNzLkFjY2Vzc1NlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFjY2Vzc1NlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hY2Nlc3MvMC4xL2FtcC1hY2Nlc3MuQWNjZXNzU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2FjY2VzcycsICdhbXAtYWNjZXNzJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIEFjY2VzcyBzZXJ2aWNlIG9yIGEgcHJvbWlzZSBmb3IgbnVsbCBpZiB0aGVcbiAgICogc2VydmljZSBpcyBub3QgYXZhaWxhYmxlIG9uIHRoZSBjdXJyZW50IHBhZ2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYWNjZXNzLzAuMS9hbXAtYWNjZXNzLkFjY2Vzc1NlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFjY2Vzc1NlcnZpY2VGb3JEb2NPck51bGwoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1hY2Nlc3MvMC4xL2FtcC1hY2Nlc3MuQWNjZXNzU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnYWNjZXNzJyxcbiAgICAgICAgICAnYW1wLWFjY2VzcycpKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBTdWJzY3JpcHRpb25zIHNlcnZpY2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhU3Vic2NyaXB0aW9uU2VydmljZT59XG4gICAqL1xuICBzdGF0aWMgc3Vic2NyaXB0aW9uc1NlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCFTdWJzY3JpcHRpb25TZXJ2aWNlPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnc3Vic2NyaXB0aW9ucycsXG4gICAgICAgICAgJ2FtcC1zdWJzY3JpcHRpb25zJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIFN1YnNjcmlwdGlvbnMgc2VydmljZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD9TdWJzY3JpcHRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBzdWJzY3JpcHRpb25zU2VydmljZUZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8P1N1YnNjcmlwdGlvblNlcnZpY2U+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ3N1YnNjcmlwdGlvbnMnLFxuICAgICAgICAgICdhbXAtc3Vic2NyaXB0aW9ucycpKSk7XG4gIH1cblxuICAvKipcbiAgICogVW5saWtlIG1vc3Qgc2VydmljZSBnZXR0ZXJzLCBwYXNzaW5nIGBOb2RlYCBpcyBuZWNlc3NhcnkgZm9yIHNvbWUgRklFLXNjb3BlXG4gICAqIHNlcnZpY2VzIHNpbmNlIHNvbWV0aW1lcyB3ZSBvbmx5IGhhdmUgdGhlIEZJRSBEb2N1bWVudCBmb3IgY29udGV4dC5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvYWN0aW9uLWltcGwuQWN0aW9uU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBhY3Rpb25TZXJ2aWNlRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvYWN0aW9uLWltcGwuQWN0aW9uU2VydmljZX0gKi8gKFxuICAgICAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIG5vZGVPckRvYywgJ2FjdGlvbicsIC8qIG9wdF9mYWxsYmFja1RvVG9wV2luICovIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8IUFjdGl2aXR5Pn1cbiAgICovXG4gIHN0YXRpYyBhY3Rpdml0eUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhQWN0aXZpdHk+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdhY3Rpdml0eScsICdhbXAtYW5hbHl0aWNzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGdsb2JhbCBpbnN0YW5jZSBvZiB0aGUgYEFtcERvY1NlcnZpY2VgIHNlcnZpY2UgdGhhdCBjYW4gYmVcbiAgICogdXNlZCB0byByZXNvbHZlIGFuIGFtcGRvYyBmb3IgYW55IG5vZGU6IGVpdGhlciBpbiB0aGUgc2luZ2xlLWRvYyBvclxuICAgKiBzaGFkb3ctZG9jIGVudmlyb25tZW50LlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY1NlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgYW1wZG9jU2VydmljZUZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY1NlcnZpY2V9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAnYW1wZG9jJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIEFtcERvYyBmb3IgdGhlIHNwZWNpZmllZCBjb250ZXh0IG5vZGUuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY31cbiAgICovXG4gIHN0YXRpYyBhbXBkb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIGdldEFtcGRvYyhlbGVtZW50T3JBbXBEb2MpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBsb2FkQW5hbHl0aWNzXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hbmFseXRpY3MvMC4xL2luc3RydW1lbnRhdGlvbi5JbnN0cnVtZW50YXRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBhbmFseXRpY3NGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBsb2FkQW5hbHl0aWNzID0gZmFsc2UpIHtcbiAgICBpZiAobG9hZEFuYWx5dGljcykge1xuICAgICAgLy8gR2V0IEV4dGVuc2lvbnMgc2VydmljZSBhbmQgZm9yY2UgbG9hZCBhbmFseXRpY3MgZXh0ZW5zaW9uLlxuICAgICAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKGVsZW1lbnRPckFtcERvYyk7XG4gICAgICBTZXJ2aWNlcy5leHRlbnNpb25zRm9yKGFtcGRvYy53aW4pLi8qT0sqL2luc3RhbGxFeHRlbnNpb25Gb3JEb2MoXG4gICAgICAgICAgYW1wZG9jLCAnYW1wLWFuYWx5dGljcycpO1xuICAgIH1cbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtYW5hbHl0aWNzLzAuMS9pbnN0cnVtZW50YXRpb24uSW5zdHJ1bWVudGF0aW9uU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2FtcC1hbmFseXRpY3MtaW5zdHJ1bWVudGF0aW9uJyxcbiAgICAgICAgICAnYW1wLWFuYWx5dGljcycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWFuYWx5dGljcy8wLjEvaW5zdHJ1bWVudGF0aW9uLkluc3RydW1lbnRhdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFuYWx5dGljc0ZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYW5hbHl0aWNzLzAuMS9pbnN0cnVtZW50YXRpb24uSW5zdHJ1bWVudGF0aW9uU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLFxuICAgICAgICAgICdhbXAtYW5hbHl0aWNzLWluc3RydW1lbnRhdGlvbicsICdhbXAtYW5hbHl0aWNzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvYmF0Y2hlZC14aHItaW1wbC5CYXRjaGVkWGhyfVxuICAgKi9cbiAgc3RhdGljIGJhdGNoZWRYaHJGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9iYXRjaGVkLXhoci1pbXBsLkJhdGNoZWRYaHJ9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAnYmF0Y2hlZC14aHInKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1iaW5kLzAuMS9iaW5kLWltcGwuQmluZD59XG4gICAqL1xuICBzdGF0aWMgYmluZEZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYmluZC8wLjEvYmluZC1pbXBsLkJpbmQ+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIGVsZW1lbnRPckFtcERvYywgJ2JpbmQnLCAnYW1wLWJpbmQnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuL3NlcnZpY2UvY2lkLWltcGwuQ2lkPn1cbiAgICovXG4gIHN0YXRpYyBjaWRGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8IS4vc2VydmljZS9jaWQtaW1wbC5DaWQ+fSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdjaWQnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvbmF2aWdhdGlvbi5OYXZpZ2F0aW9ufVxuICAgKi9cbiAgc3RhdGljIG5hdmlnYXRpb25Gb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9uYXZpZ2F0aW9uLk5hdmlnYXRpb259ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnbmF2aWdhdGlvbicpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2NyeXB0by1pbXBsLkNyeXB0b31cbiAgICovXG4gIHN0YXRpYyBjcnlwdG9Gb3Iod2luZG93KSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyEuL3NlcnZpY2UvY3J5cHRvLWltcGwuQ3J5cHRvfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ2NyeXB0bycpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvZG9jdW1lbnQtaW5mby1pbXBsLkRvY3VtZW50SW5mb0RlZn0gSW5mbyBhYm91dCB0aGUgZG9jXG4gICAqL1xuICBzdGF0aWMgZG9jdW1lbnRJbmZvRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvZG9jdW1lbnQtaW5mby1pbXBsLkRvY0luZm99ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnZG9jdW1lbnRJbmZvJykpLmdldCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvZG9jdW1lbnQtc3RhdGUuRG9jdW1lbnRTdGF0ZX1cbiAgICovXG4gIHN0YXRpYyBkb2N1bWVudFN0YXRlRm9yKHdpbmRvdykge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbmRvdywgJ2RvY3VtZW50U3RhdGUnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2V4dGVuc2lvbnMtaW1wbC5FeHRlbnNpb25zfVxuICAgKi9cbiAgc3RhdGljIGV4dGVuc2lvbnNGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9leHRlbnNpb25zLWltcGwuRXh0ZW5zaW9uc30gKi8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdleHRlbnNpb25zJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgc2VydmljZSBpbXBsZW1lbnRlZCBpbiBzZXJ2aWNlL2hpc3RvcnktaW1wbC5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvaGlzdG9yeS1pbXBsLkhpc3Rvcnl9XG4gICAqL1xuICBzdGF0aWMgaGlzdG9yeUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2hpc3RvcnktaW1wbC5IaXN0b3J5fSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2hpc3RvcnknKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4vaW5wdXQuSW5wdXR9XG4gICAqL1xuICBzdGF0aWMgaW5wdXRGb3Iod2luKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2Uod2luLCAnaW5wdXQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9sYXllcnMtaW1wbC5MYXlvdXRMYXllcnN9XG4gICAqL1xuICBzdGF0aWMgbGF5ZXJzRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvbGF5ZXJzLWltcGwuTGF5b3V0TGF5ZXJzfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2xheWVycycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3BlcmZvcm1hbmNlLWltcGwuUGVyZm9ybWFuY2V9XG4gICAqL1xuICBzdGF0aWMgcGVyZm9ybWFuY2VGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9wZXJmb3JtYW5jZS1pbXBsLlBlcmZvcm1hbmNlfSovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAncGVyZm9ybWFuY2UnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9wZXJmb3JtYW5jZS1pbXBsLlBlcmZvcm1hbmNlfVxuICAgKi9cbiAgc3RhdGljIHBlcmZvcm1hbmNlRm9yT3JOdWxsKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvcGVyZm9ybWFuY2UtaW1wbC5QZXJmb3JtYW5jZX0qLyAoXG4gICAgICBnZXRFeGlzdGluZ1NlcnZpY2VPck51bGwod2luZG93LCAncGVyZm9ybWFuY2UnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9wbGF0Zm9ybS1pbXBsLlBsYXRmb3JtfVxuICAgKi9cbiAgc3RhdGljIHBsYXRmb3JtRm9yKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvcGxhdGZvcm0taW1wbC5QbGF0Zm9ybX0gKi8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdwbGF0Zm9ybScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VzIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKCkgc2luY2UgUmVzb3VyY2VzIGlzIGEgc3RhcnR1cCBzZXJ2aWNlLlxuICAgKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9yZXNvdXJjZXMtaW1wbC5SZXNvdXJjZXN9XG4gICAqL1xuICBzdGF0aWMgcmVzb3VyY2VzRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvcmVzb3VyY2VzLWltcGwuUmVzb3VyY2VzfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZChub2RlT3JEb2MsICdyZXNvdXJjZXMnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7P1Byb21pc2U8P3tpbmNvbWluZ0ZyYWdtZW50OiBzdHJpbmcsIG91dGdvaW5nRnJhZ21lbnQ6IHN0cmluZ30+fVxuICAgKi9cbiAgc3RhdGljIHNoYXJlVHJhY2tpbmdGb3JPck51bGwod2luKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPD97aW5jb21pbmdGcmFnbWVudDogc3RyaW5nLCBvdXRnb2luZ0ZyYWdtZW50OiBzdHJpbmd9Pn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICdzaGFyZS10cmFja2luZycsXG4gICAgICAgICAgJ2FtcC1zaGFyZS10cmFja2luZycsIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7P1Byb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC92YXJpYWJsZS1zZXJ2aWNlLlN0b3J5VmFyaWFibGVEZWY+fVxuICAgKi9cbiAgc3RhdGljIHN0b3J5VmFyaWFibGVTZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL3ZhcmlhYmxlLXNlcnZpY2UuU3RvcnlWYXJpYWJsZURlZj59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICdzdG9yeS12YXJpYWJsZScsICdhbXAtc3RvcnknLFxuICAgICAgICAgIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogVmVyc2lvbiBvZiB0aGUgc3Rvcnkgc3RvcmUgc2VydmljZSBkZXBlbmRzIG9uIHdoaWNoIHZlcnNpb24gb2YgYW1wLXN0b3J5XG4gICAqIHRoZSBwdWJsaXNoZXIgaXMgbG9hZGluZy4gVGhleSBhbGwgaGF2ZSB0aGUgc2FtZSBpbXBsZW1lbnRhdGlvbi5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7P1Byb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZXw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBzdG9yeVN0b3JlU2VydmljZUZvck9yTnVsbCh3aW4pIHtcbiAgICByZXR1cm4gKFxuICAgIC8qKiBAdHlwZSB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZXw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgJ3N0b3J5LXN0b3JlJywgJ2FtcC1zdG9yeScpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBzdG9yeVN0b3JlU2VydmljZSh3aW4pIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZX0gKi9cbiAgICAgIChnZXRFeGlzdGluZ1NlcnZpY2VPck51bGwod2luLCAnc3Rvcnktc3RvcmUnKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4gez8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvYW1wLXN0b3J5LXJlcXVlc3Qtc2VydmljZS5BbXBTdG9yeVJlcXVlc3RTZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIHN0b3J5UmVxdWVzdFNlcnZpY2Uod2luKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgez8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvYW1wLXN0b3J5LXJlcXVlc3Qtc2VydmljZS5BbXBTdG9yeVJlcXVlc3RTZXJ2aWNlfSAqL1xuICAgICAgKGdldEV4aXN0aW5nU2VydmljZU9yTnVsbCh3aW4sICdzdG9yeS1yZXF1ZXN0JykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2xvY2FsaXphdGlvbi5Mb2NhbGl6YXRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBsb2NhbGl6YXRpb25TZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2xvY2FsaXphdGlvbi5Mb2NhbGl6YXRpb25TZXJ2aWNlPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgJ2xvY2FsaXphdGlvbicsICdhbXAtc3RvcnknLCB0cnVlKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4geyEuLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgbG9jYWxpemF0aW9uU2VydmljZSh3aW4pIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZSh3aW4sICdsb2NhbGl6YXRpb24nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUT0RPKCMxNDM1Nyk6IFJlbW92ZSB0aGlzIHdoZW4gYW1wLXN0b3J5OjAuMSBpcyBkZXByZWNhdGVkLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshLi4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIHN0b3J5U3RvcmVTZXJ2aWNlVjAxKHdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbiwgJ3N0b3J5LXN0b3JlJyk7XG4gIH1cblxuICAvKipcbiAgICogVE9ETygjMTQzNTcpOiBSZW1vdmUgdGhpcyB3aGVuIGFtcC1zdG9yeTowLjEgaXMgZGVwcmVjYXRlZC5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzAuMS9hbXAtc3RvcnktcmVxdWVzdC1zZXJ2aWNlLkFtcFN0b3J5UmVxdWVzdFNlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgc3RvcnlSZXF1ZXN0U2VydmljZVYwMSh3aW4pIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZSh3aW4sICdzdG9yeS1yZXF1ZXN0LXYwMScpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRPRE8oIzE0MzU3KTogUmVtb3ZlIHRoaXMgd2hlbiBhbXAtc3Rvcnk6MC4xIGlzIGRlcHJlY2F0ZWQuXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGxvY2FsaXphdGlvblNlcnZpY2VGb3JPck51bGxWMDEod2luKSB7XG4gICAgcmV0dXJuIChcbiAgICAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2U+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAnbG9jYWxpemF0aW9uLXYwMScsICdhbXAtc3RvcnknLFxuICAgICAgICAgIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogVE9ETygjMTQzNTcpOiBSZW1vdmUgdGhpcyB3aGVuIGFtcC1zdG9yeTowLjEgaXMgZGVwcmVjYXRlZC5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzAuMS9sb2NhbGl6YXRpb24uTG9jYWxpemF0aW9uU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBsb2NhbGl6YXRpb25TZXJ2aWNlVjAxKHdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbiwgJ2xvY2FsaXphdGlvbi12MDEnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHs/UHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtdmlld2VyLWludGVncmF0aW9uLzAuMS92YXJpYWJsZS1zZXJ2aWNlLlZpZXdlckludGVncmF0aW9uVmFyaWFibGVEZWY+fVxuICAgKi9cbiAgc3RhdGljIHZpZXdlckludGVncmF0aW9uVmFyaWFibGVTZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtdmlld2VyLWludGVncmF0aW9uLzAuMS92YXJpYWJsZS1zZXJ2aWNlLlZpZXdlckludGVncmF0aW9uVmFyaWFibGVEZWY+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAndmlld2VyLWludGVncmF0aW9uLXZhcmlhYmxlJyxcbiAgICAgICAgICAnYW1wLXZpZXdlci1pbnRlZ3JhdGlvbicsIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hbmltYXRpb24vMC4xL3dlYi1hbmltYXRpb24tc2VydmljZS5XZWJBbmltYXRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyB3ZWJBbmltYXRpb25TZXJ2aWNlRm9yKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAoLyoqIEB0eXBlIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtYW5pbWF0aW9uLzAuMS93ZWItYW5pbWF0aW9uLXNlcnZpY2UuV2ViQW5pbWF0aW9uU2VydmljZT59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoXG4gICAgICAgICAgZWxlbWVudE9yQW1wRG9jLCAnd2ViLWFuaW1hdGlvbicsICdhbXAtYW5pbWF0aW9uJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8IS4vc2VydmljZS9zdG9yYWdlLWltcGwuU3RvcmFnZT59XG4gICAqL1xuICBzdGF0aWMgc3RvcmFnZUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3N0b3JhZ2UtaW1wbC5TdG9yYWdlPn0gKi8gKFxuICAgICAgZ2V0U2VydmljZVByb21pc2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnc3RvcmFnZScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3RlbXBsYXRlLWltcGwuVGVtcGxhdGVzfVxuICAgKi9cbiAgc3RhdGljIHRlbXBsYXRlc0Zvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3RlbXBsYXRlLWltcGwuVGVtcGxhdGVzfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3RlbXBsYXRlcycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3RpbWVyLWltcGwuVGltZXJ9XG4gICAqL1xuICBzdGF0aWMgdGltZXJGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS90aW1lci1pbXBsLlRpbWVyfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3RpbWVyJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVubGlrZSBtb3N0IHNlcnZpY2UgZ2V0dGVycywgcGFzc2luZyBgTm9kZWAgaXMgbmVjZXNzYXJ5IGZvciBzb21lIEZJRS1zY29wZVxuICAgKiBzZXJ2aWNlcyBzaW5jZSBzb21ldGltZXMgd2Ugb25seSBoYXZlIHRoZSBGSUUgRG9jdW1lbnQgZm9yIGNvbnRleHQuXG4gICAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3VybC1yZXBsYWNlbWVudHMtaW1wbC5VcmxSZXBsYWNlbWVudHN9XG4gICAqL1xuICBzdGF0aWMgdXJsUmVwbGFjZW1lbnRzRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvdXJsLXJlcGxhY2VtZW50cy1pbXBsLlVybFJlcGxhY2VtZW50c30gKi8gKFxuICAgICAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIG5vZGVPckRvYywgJ3VybC1yZXBsYWNlJywgLyogb3B0X2ZhbGxiYWNrVG9Ub3BXaW4gKi8gdHJ1ZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtdXNlci1ub3RpZmljYXRpb24vMC4xL2FtcC11c2VyLW5vdGlmaWNhdGlvbi5Vc2VyTm90aWZpY2F0aW9uTWFuYWdlcj59XG4gICAqL1xuICBzdGF0aWMgdXNlck5vdGlmaWNhdGlvbk1hbmFnZXJGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC11c2VyLW5vdGlmaWNhdGlvbi8wLjEvYW1wLXVzZXItbm90aWZpY2F0aW9uLlVzZXJOb3RpZmljYXRpb25NYW5hZ2VyPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICd1c2VyTm90aWZpY2F0aW9uTWFuYWdlcicsXG4gICAgICAgICAgJ2FtcC11c2VyLW5vdGlmaWNhdGlvbicpKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBjb25zZW50UG9saWN5IFNlcnZpY2Ugb3IgYSBwcm9taXNlIGZvciBudWxsIGlmXG4gICAqIHRoZSBzZXJ2aWNlIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1jb25zZW50LzAuMS9jb25zZW50LXBvbGljeS1tYW5hZ2VyLkNvbnNlbnRQb2xpY3lNYW5hZ2VyPn1cbiAgICovXG4gIHN0YXRpYyBjb25zZW50UG9saWN5U2VydmljZUZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWNvbnNlbnQvMC4xL2NvbnNlbnQtcG9saWN5LW1hbmFnZXIuQ29uc2VudFBvbGljeU1hbmFnZXI+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLFxuICAgICAgICAgICdjb25zZW50UG9saWN5TWFuYWdlcicsICdhbXAtY29uc2VudCcpKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBnZW8gc2VydmljZSBvciBhIHByb21pc2UgZm9yIG51bGwgaWZcbiAgICogdGhlIHNlcnZpY2UgaXMgbm90IGF2YWlsYWJsZSBvbiB0aGUgY3VycmVudCBwYWdlLlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWdlby8wLjEvYW1wLWdlby5HZW9EZWY+fVxuICAgKi9cbiAgc3RhdGljIGdlb0ZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtZ2VvLzAuMS9hbXAtZ2VvLkdlb0RlZj59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoXG4gICAgICAgICAgZWxlbWVudE9yQW1wRG9jLCAnZ2VvJywgJ2FtcC1nZW8nLCB0cnVlKSk7XG4gIH1cblxuICAvKipcbiAgICogVW5saWtlIG1vc3Qgc2VydmljZSBnZXR0ZXJzLCBwYXNzaW5nIGBOb2RlYCBpcyBuZWNlc3NhcnkgZm9yIHNvbWUgRklFLXNjb3BlXG4gICAqIHNlcnZpY2VzIHNpbmNlIHNvbWV0aW1lcyB3ZSBvbmx5IGhhdmUgdGhlIEZJRSBEb2N1bWVudCBmb3IgY29udGV4dC5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvdXJsLWltcGwuVXJsfVxuICAgKi9cbiAgc3RhdGljIHVybEZvckRvYyhub2RlT3JEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3VybC1pbXBsLlVybH0gKi8gKFxuICAgICAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIG5vZGVPckRvYywgJ3VybCcsIC8qIG9wdF9mYWxsYmFja1RvVG9wV2luICovIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIGV4cGVyaW1lbnQgdmFyaWFudHMgb3IgYSBwcm9taXNlIGZvciBudWxsIGlmIGl0XG4gICAqIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IVByb21pc2U8P09iamVjdDxzdHJpbmc+Pn1cbiAgICovXG4gIHN0YXRpYyB2YXJpYW50Rm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q8c3RyaW5nPj59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAndmFyaWFudCcsICdhbXAtZXhwZXJpbWVudCcsIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS92aWRlby1zZXJ2aWNlLWludGVyZmFjZS5WaWRlb1NlcnZpY2VJbnRlcmZhY2V9XG4gICAqL1xuICBzdGF0aWMgdmlkZW9NYW5hZ2VyRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAoXG4gICAgICAvKiogQHR5cGUgeyEuL3NlcnZpY2UvdmlkZW8tc2VydmljZS1pbnRlcmZhY2UuVmlkZW9TZXJ2aWNlSW50ZXJmYWNlfSAqLyAoXG4gICAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAndmlkZW8tbWFuYWdlcicpKSk7XG4gIH1cblxuICAvKipcbiAgICogVXNlcyBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZCgpIHNpbmNlIFZpZXdlciBpcyBhIHN0YXJ0dXAgc2VydmljZS5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2Uvdmlld2VyLWltcGwuVmlld2VyfVxuICAgKi9cbiAgc3RhdGljIHZpZXdlckZvckRvYyhub2RlT3JEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcn0gKi8gKFxuICAgICAgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQobm9kZU9yRG9jLCAndmlld2VyJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgcHJvbWlzZSBmb3IgdGhlIHZpZXdlci4gVGhpcyBpcyBhbiB1bnVzdWFsIGNhc2UgYW5kIG5lY2Vzc2FyeSBvbmx5XG4gICAqIGZvciBzZXJ2aWNlcyB0aGF0IG5lZWQgcmVmZXJlbmNlIHRvIHRoZSB2aWV3ZXIgYmVmb3JlIGl0IGhhcyBiZWVuXG4gICAqIGluaXRpYWxpemVkLiBNb3N0IG9mIHRoZSBjb2RlLCBob3dldmVyLCBqdXN0IHNob3VsZCB1c2UgYHZpZXdlckZvckRvY2AuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcj59XG4gICAqL1xuICBzdGF0aWMgdmlld2VyUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcj59ICovIChcbiAgICAgIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ3ZpZXdlcicpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3ZzeW5jLWltcGwuVnN5bmN9XG4gICAqL1xuICBzdGF0aWMgdnN5bmNGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS92c3luYy1pbXBsLlZzeW5jfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3ZzeW5jJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZXMgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQoKSBzaW5jZSBWaWV3cG9ydCBpcyBhIHN0YXJ0dXAgc2VydmljZS5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2Uvdmlld3BvcnQvdmlld3BvcnQtaW1wbC5WaWV3cG9ydH1cbiAgICovXG4gIHN0YXRpYyB2aWV3cG9ydEZvckRvYyhub2RlT3JEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3ZpZXdwb3J0L3ZpZXdwb3J0LWltcGwuVmlld3BvcnR9ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKG5vZGVPckRvYywgJ3ZpZXdwb3J0JykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UveGhyLWltcGwuWGhyfVxuICAgKi9cbiAgc3RhdGljIHhockZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3hoci1pbXBsLlhocn0gKi8gKGdldFNlcnZpY2Uod2luZG93LCAneGhyJykpO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7bWFwfSBmcm9tICcuL3V0aWxzL29iamVjdC5qcyc7XG5cbmxldCBjb250YWluZXI7XG5cbi8qKlxuICogQ3JlYXRlcyB0aGUgaHRtbCBoZWxwZXIgZm9yIHRoZSBkb2MuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudHwhRG9jdW1lbnR9IG5vZGVPckRvY1xuICogQHJldHVybiB7ZnVuY3Rpb24oIUFycmF5PHN0cmluZz4pOiFFbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gaHRtbEZvcihub2RlT3JEb2MpIHtcbiAgY29uc3QgZG9jID0gbm9kZU9yRG9jLm93bmVyRG9jdW1lbnQgfHwgbm9kZU9yRG9jO1xuICBpZiAoIWNvbnRhaW5lciB8fCBjb250YWluZXIub3duZXJEb2N1bWVudCAhPT0gZG9jKSB7XG4gICAgY29udGFpbmVyID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB9XG5cbiAgcmV0dXJuIGh0bWw7XG59XG5cbi8qKlxuICogQSB0YWdnZWQgdGVtcGxhdGUgbGl0ZXJhbCBoZWxwZXIgdG8gZ2VuZXJhdGUgc3RhdGljIERPTSB0cmVlcy5cbiAqIFRoaXMgbXVzdCBiZSB1c2VkIGFzIGEgdGFnZ2VkIHRlbXBsYXRlLCBpZVxuICpcbiAqIGBgYFxuICogY29uc3QgZGl2ID0gaHRtbGA8ZGl2PjxzcGFuPjwvc3Bhbj48L2Rpdj5gO1xuICogYGBgXG4gKlxuICogT25seSB0aGUgcm9vdCBlbGVtZW50IGFuZCBpdHMgc3VidHJlZSB3aWxsIGJlIHJldHVybmVkLiBETyBOT1QgdXNlIHRoaXMgdG9cbiAqIHJlbmRlciBzdWJ0cmVlJ3Mgd2l0aCBkeW5hbWljIGNvbnRlbnQsIGl0IFdJTEwgcmVzdWx0IGluIGFuIGVycm9yIVxuICpcbiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHN0cmluZ3NcbiAqIEByZXR1cm4geyFFbGVtZW50fVxuICovXG5mdW5jdGlvbiBodG1sKHN0cmluZ3MpIHtcbiAgZGV2KCkuYXNzZXJ0KHN0cmluZ3MubGVuZ3RoID09PSAxLCAnSW1wcm9wZXIgaHRtbCB0ZW1wbGF0ZSB0YWcgdXNhZ2UuJyk7XG4gIGNvbnRhaW5lci4vKk9LKi9pbm5lckhUTUwgPSBzdHJpbmdzWzBdO1xuXG4gIGNvbnN0IGVsID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkO1xuICBkZXYoKS5hc3NlcnQoZWwsICdObyBlbGVtZW50cyBpbiB0ZW1wbGF0ZScpO1xuICBkZXYoKS5hc3NlcnQoIWVsLm5leHRFbGVtZW50U2libGluZywgJ1RvbyBtYW55IHJvb3QgZWxlbWVudHMgaW4gdGVtcGxhdGUnKTtcblxuICAvLyBDbGVhciB0byBmcmVlIG1lbW9yeS5cbiAgY29udGFpbmVyLi8qT0sqL2lubmVySFRNTCA9ICcnO1xuXG4gIHJldHVybiBlbDtcbn1cblxuLyoqXG4gKiBRdWVyaWVzIGFuIGVsZW1lbnQgZm9yIGFsbCBlbGVtZW50cyB3aXRoIGEgXCJyZWZcIiBhdHRyaWJ1dGUsIHJlbW92aW5nXG4gKiB0aGUgYXR0cmlidXRlIGFmdGVyd2FyZHMuXG4gKiBSZXR1cm5zIGEgbmFtZWQgbWFwIG9mIGFsbCByZWYgZWxlbWVudHMuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudH0gcm9vdFxuICogQHJldHVybiB7IU9iamVjdDxzdHJpbmcsICFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGh0bWxSZWZzKHJvb3QpIHtcbiAgY29uc3QgZWxlbWVudHMgPSByb290LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tyZWZdJyk7XG4gIGNvbnN0IHJlZnMgPSBtYXAoKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgZWxlbWVudCA9IGVsZW1lbnRzW2ldO1xuICAgIGNvbnN0IHJlZiA9IGRldigpLmFzc2VydChlbGVtZW50LmdldEF0dHJpYnV0ZSgncmVmJyksICdFbXB0eSByZWYgYXR0cicpO1xuICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdyZWYnKTtcbiAgICBkZXYoKS5hc3NlcnQocmVmc1tyZWZdID09PSB1bmRlZmluZWQsICdEdXBsaWNhdGUgcmVmJyk7XG4gICAgcmVmc1tyZWZdID0gZWxlbWVudDtcbiAgfVxuXG4gIHJldHVybiByZWZzO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IF9tYXRjaFxuICogQHBhcmFtIHtzdHJpbmd9IGNoYXJhY3RlclxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0b1VwcGVyQ2FzZShfbWF0Y2gsIGNoYXJhY3Rlcikge1xuICByZXR1cm4gY2hhcmFjdGVyLnRvVXBwZXJDYXNlKCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG1hdGNoXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHByZXBlbmREYXNoQW5kVG9Mb3dlckNhc2UobWF0Y2gpIHtcbiAgcmV0dXJuICctJyArIG1hdGNoLnRvTG93ZXJDYXNlKCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgQXR0cmlidXRlIG5hbWUgY29udGFpbmluZyBkYXNoZXMuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IERhc2hlcyByZW1vdmVkIGFuZCBzdWNjZXNzaXZlIGNoYXJhY3RlciBzZW50IHRvIHVwcGVyIGNhc2UuXG4gKiB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZGFzaFRvQ2FtZWxDYXNlKG5hbWUpIHtcbiAgcmV0dXJuIG5hbWUucmVwbGFjZSgvLShbYS16XSkvZywgdG9VcHBlckNhc2UpO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgc3RyaW5nIHRoYXQgaXMgaW4gY2FtZWxDYXNlIHRvIG9uZSB0aGF0IGlzIGluIGRhc2gtY2FzZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nIFRoZSBzdHJpbmcgdG8gY29udmVydC5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHN0cmluZyBpbiBkYXNoLWNhc2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW1lbENhc2VUb0Rhc2goc3RyaW5nKSB7XG4gIHJldHVybiBzdHJpbmcucmVwbGFjZSgvKD8hXilbQS1aXS9nLCBwcmVwZW5kRGFzaEFuZFRvTG93ZXJDYXNlKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBBdHRyaWJ1dGUgbmFtZSB3aXRoIGRhc2hlc1xuICogQHJldHVybiB7c3RyaW5nfSBEYXNoZXMgcmVwbGFjZWQgYnkgdW5kZXJsaW5lcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRhc2hUb1VuZGVybGluZShuYW1lKSB7XG4gIHJldHVybiBuYW1lLnJlcGxhY2UoJy0nLCAnXycpO1xufVxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBTdHJpbmcucHJvdG90eXBlLmVuZHNXaXRoLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZ1xuICogQHBhcmFtIHtzdHJpbmd9IHN1ZmZpeFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVuZHNXaXRoKHN0cmluZywgc3VmZml4KSB7XG4gIGNvbnN0IGluZGV4ID0gc3RyaW5nLmxlbmd0aCAtIHN1ZmZpeC5sZW5ndGg7XG4gIHJldHVybiBpbmRleCA+PSAwICYmIHN0cmluZy5pbmRleE9mKHN1ZmZpeCwgaW5kZXgpID09IGluZGV4O1xufVxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGguXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJlZml4XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RhcnRzV2l0aChzdHJpbmcsIHByZWZpeCkge1xuICBpZiAocHJlZml4Lmxlbmd0aCA+IHN0cmluZy5sZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHN0cmluZy5sYXN0SW5kZXhPZihwcmVmaXgsIDApID09IDA7XG59XG5cbi8qKlxuICogRXhwYW5kcyBwbGFjZWhvbGRlcnMgaW4gYSBnaXZlbiB0ZW1wbGF0ZSBzdHJpbmcgd2l0aCB2YWx1ZXMuXG4gKlxuICogUGxhY2Vob2xkZXJzIHVzZSAke2tleS1uYW1lfSBzeW50YXggYW5kIGFyZSByZXBsYWNlZCB3aXRoIHRoZSB2YWx1ZVxuICogcmV0dXJuZWQgZnJvbSB0aGUgZ2l2ZW4gZ2V0dGVyIGZ1bmN0aW9uLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZW1wbGF0ZSBUaGUgdGVtcGxhdGUgc3RyaW5nIHRvIGV4cGFuZC5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nKToqfSBnZXR0ZXIgRnVuY3Rpb24gdXNlZCB0byByZXRyaWV2ZSBhIHZhbHVlIGZvciBhXG4gKiAgIHBsYWNlaG9sZGVyLiBSZXR1cm5zIHZhbHVlcyB3aWxsIGJlIGNvZXJjZWQgaW50byBzdHJpbmdzLlxuICogQHBhcmFtIHtudW1iZXI9fSBvcHRfbWF4SXRlcmF0aW9ucyBOdW1iZXIgb2YgdGltZXMgdG8gZXhwYW5kIHRoZSB0ZW1wbGF0ZS5cbiAqICAgRGVmYXVsdHMgdG8gMSwgYnV0IHNob3VsZCBiZSBzZXQgdG8gYSBsYXJnZXIgdmFsdWUgeW91ciBwbGFjZWhvbGRlciB0b2tlbnNcbiAqICAgY2FuIGJlIGV4cGFuZGVkIHRvIG90aGVyIHBsYWNlaG9sZGVyIHRva2Vucy4gVGFrZSBjYXV0aW9uIHdpdGggbGFyZ2UgdmFsdWVzXG4gKiAgIGFzIHJlY3Vyc2l2ZWx5IGV4cGFuZGluZyBhIHN0cmluZyBjYW4gYmUgZXhwb25lbnRpYWxseSBleHBlbnNpdmUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHBhbmRUZW1wbGF0ZSh0ZW1wbGF0ZSwgZ2V0dGVyLCBvcHRfbWF4SXRlcmF0aW9ucykge1xuICBjb25zdCBtYXhJdGVyYXRpb25zID0gb3B0X21heEl0ZXJhdGlvbnMgfHwgMTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhJdGVyYXRpb25zOyBpKyspIHtcbiAgICBsZXQgbWF0Y2hlcyA9IDA7XG4gICAgdGVtcGxhdGUgPSB0ZW1wbGF0ZS5yZXBsYWNlKC9cXCR7KFtefV0qKX0vZywgKF9hLCBiKSA9PiB7XG4gICAgICBtYXRjaGVzKys7XG4gICAgICByZXR1cm4gZ2V0dGVyKGIpO1xuICAgIH0pO1xuICAgIGlmICghbWF0Y2hlcykge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIHJldHVybiB0ZW1wbGF0ZTtcbn1cblxuLyoqXG4gKiBIYXNoIGZ1bmN0aW9uIGRqYjJhXG4gKiBUaGlzIGlzIGludGVuZGVkIHRvIGJlIGEgc2ltcGxlLCBmYXN0IGhhc2hpbmcgZnVuY3Rpb24gdXNpbmcgbWluaW1hbCBjb2RlLlxuICogSXQgZG9lcyAqbm90KiBoYXZlIGdvb2QgY3J5cHRvZ3JhcGhpYyBwcm9wZXJ0aWVzLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxuICogQHJldHVybiB7c3RyaW5nfSAzMi1iaXQgdW5zaWduZWQgaGFzaCBvZiB0aGUgc3RyaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdHJpbmdIYXNoMzIoc3RyKSB7XG4gIGNvbnN0IHtsZW5ndGh9ID0gc3RyO1xuICBsZXQgaGFzaCA9IDUzODE7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICBoYXNoID0gaGFzaCAqIDMzIF4gc3RyLmNoYXJDb2RlQXQoaSk7XG4gIH1cbiAgLy8gQ29udmVydCBmcm9tIDMyLWJpdCBzaWduZWQgdG8gdW5zaWduZWQuXG4gIHJldHVybiBTdHJpbmcoaGFzaCA+Pj4gMCk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi9zZXJ2aWNlcyc7XG5pbXBvcnQge2RldiwgcmV0aHJvd0FzeW5jfSBmcm9tICcuL2xvZyc7XG5pbXBvcnQge2luc2VydEFmdGVyT3JBdFN0YXJ0LCB3YWl0Rm9yQm9keX0gZnJvbSAnLi9kb20nO1xuaW1wb3J0IHttYXB9IGZyb20gJy4vdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7c2V0U3R5bGVzfSBmcm9tICcuL3N0eWxlJztcbmltcG9ydCB7d2FpdEZvclNlcnZpY2VzfSBmcm9tICcuL3JlbmRlci1kZWxheWluZy1zZXJ2aWNlcyc7XG5cbmNvbnN0IFRSQU5TRk9STUVSX1BST1AgPSAnX19BTVBfQ1NTX1RSJztcbmNvbnN0IFNUWUxFX01BUF9QUk9QID0gJ19fQU1QX0NTU19TTSc7XG5jb25zdCBib2R5VmlzaWJsZVNlbnRpbmVsID0gJ19fQU1QX0JPRFlfVklTSUJMRSc7XG5cblxuLyoqXG4gKiBBZGRzIHRoZSBnaXZlbiBjc3MgdGV4dCB0byB0aGUgZ2l2ZW4gYW1wZG9jLlxuICpcbiAqIFRoZSBzdHlsZSB0YWdzIHdpbGwgYmUgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgaGVhZCBiZWZvcmUgYWxsIGF1dGhvclxuICogc3R5bGVzLiBPbmUgZWxlbWVudCBjYW4gYmUgdGhlIG1haW4gcnVudGltZSBDU1MuIFRoaXMgaXMgZ3VhcmFudGVlZFxuICogdG8gYWx3YXlzIGJlIHRoZSBmaXJzdCBzdHlsZXNoZWV0IGluIHRoZSBkb2MuXG4gKlxuICogQHBhcmFtIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jIFRoZSBhbXBkb2MgdGhhdCBzaG91bGQgZ2V0IHRoZSBuZXcgc3R5bGVzLlxuICogQHBhcmFtIHtzdHJpbmd9IGNzc1RleHRcbiAqIEBwYXJhbSB7P2Z1bmN0aW9uKCFFbGVtZW50KXx1bmRlZmluZWR9IGNiIENhbGxlZCB3aGVuIHRoZSBuZXcgc3R5bGVzIGFyZSBhdmFpbGFibGUuXG4gKiAgICAgTm90IHVzaW5nIGEgcHJvbWlzZSwgYmVjYXVzZSB0aGlzIGlzIHN5bmNocm9ub3VzIHdoZW4gcG9zc2libGUuXG4gKiAgICAgZm9yIGJldHRlciBwZXJmb3JtYW5jZS5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pc1J1bnRpbWVDc3MgSWYgdHJ1ZSwgdGhpcyBzdHlsZSB0YWcgd2lsbCBiZSBpbnNlcnRlZFxuICogICAgIGFzIHRoZSBmaXJzdCBlbGVtZW50IGluIGhlYWQgYW5kIGFsbCBzdHlsZSBlbGVtZW50cyB3aWxsIGJlIHBvc2l0aW9uZWRcbiAqICAgICBhZnRlci5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X2V4dFxuICogQHJldHVybiB7IUVsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnN0YWxsU3R5bGVzRm9yRG9jKFxuICBhbXBkb2MsIGNzc1RleHQsIGNiLCBvcHRfaXNSdW50aW1lQ3NzLCBvcHRfZXh0KSB7XG4gIGNvbnN0IGNzc1Jvb3QgPSBhbXBkb2MuZ2V0SGVhZE5vZGUoKTtcbiAgY29uc3Qgc3R5bGUgPSBpbnNlcnRTdHlsZUVsZW1lbnQoXG4gICAgICBjc3NSb290LFxuICAgICAgbWF5YmVUcmFuc2Zvcm0oY3NzUm9vdCwgY3NzVGV4dCksXG4gICAgICBvcHRfaXNSdW50aW1lQ3NzIHx8IGZhbHNlLFxuICAgICAgb3B0X2V4dCB8fCBudWxsKTtcblxuICBpZiAoY2IpIHtcbiAgICBjb25zdCByb290Tm9kZSA9IGFtcGRvYy5nZXRSb290Tm9kZSgpO1xuICAgIC8vIFN0eWxlcyBhcmVuJ3QgYWx3YXlzIGF2YWlsYWJsZSBzeW5jaHJvbm91c2x5LiBFLmcuIGlmIHRoZXJlIGlzIGFcbiAgICAvLyBwZW5kaW5nIHN0eWxlIGRvd25sb2FkLCBpdCB3aWxsIGhhdmUgdG8gZmluaXNoIGJlZm9yZSB0aGUgbmV3XG4gICAgLy8gc3R5bGUgaXMgdmlzaWJsZS5cbiAgICAvLyBGb3IgdGhpcyByZWFzb24gd2UgcG9sbCB1bnRpbCB0aGUgc3R5bGUgYmVjb21lcyBhdmFpbGFibGUuXG4gICAgLy8gU3luYyBjYXNlLlxuICAgIGlmIChzdHlsZUxvYWRlZChyb290Tm9kZSwgc3R5bGUpKSB7XG4gICAgICBjYihzdHlsZSk7XG4gICAgICByZXR1cm4gc3R5bGU7XG4gICAgfVxuICAgIC8vIFBvbGwgdW50aWwgc3R5bGVzIGFyZSBhdmFpbGFibGUuXG4gICAgY29uc3QgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBpZiAoc3R5bGVMb2FkZWQocm9vdE5vZGUsIHN0eWxlKSkge1xuICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsKTtcbiAgICAgICAgY2Ioc3R5bGUpO1xuICAgICAgfVxuICAgIH0sIDQpO1xuICB9XG4gIHJldHVybiBzdHlsZTtcbn1cblxuXG4vKipcbiAqIEFkZHMgdGhlIGdpdmVuIGNzcyB0ZXh0IHRvIHRoZSBnaXZlbiBkb2N1bWVudC5cbiAqIFRPRE8oZHZveXRlbmtvLCAjMTA3MDUpOiBSZW1vdmUgdGhpcyBtZXRob2Qgb25jZSBGSUUvYW1wZG9jIG1pZ3JhdGlvbiBpc1xuICogZG9uZS5cbiAqXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jIFRoZSBkb2N1bWVudCB0aGF0IHNob3VsZCBnZXQgdGhlIG5ldyBzdHlsZXMuXG4gKiBAcGFyYW0ge3N0cmluZ30gY3NzVGV4dFxuICogQHBhcmFtIHs/ZnVuY3Rpb24oIUVsZW1lbnQpfHVuZGVmaW5lZH0gY2IgQ2FsbGVkIHdoZW4gdGhlIG5ldyBzdHlsZXMgYXJlXG4gKiAgICAgYXZhaWxhYmxlLiBOb3QgdXNpbmcgYSBwcm9taXNlLCBiZWNhdXNlIHRoaXMgaXMgc3luY2hyb25vdXMgd2hlblxuICogICAgIHBvc3NpYmxlLiBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlLlxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2lzUnVudGltZUNzcyBJZiB0cnVlLCB0aGlzIHN0eWxlIHRhZyB3aWxsIGJlIGluc2VydGVkXG4gKiAgICAgYXMgdGhlIGZpcnN0IGVsZW1lbnQgaW4gaGVhZCBhbmQgYWxsIHN0eWxlIGVsZW1lbnRzIHdpbGwgYmUgcG9zaXRpb25lZFxuICogICAgIGFmdGVyLlxuICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfZXh0XG4gKiBAcmV0dXJuIHshRWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGxTdHlsZXNMZWdhY3koXG4gIGRvYywgY3NzVGV4dCwgY2IsIG9wdF9pc1J1bnRpbWVDc3MsIG9wdF9leHQpIHtcbiAgY29uc3Qgc3R5bGUgPSBpbnNlcnRTdHlsZUVsZW1lbnQoXG4gICAgICBkZXYoKS5hc3NlcnRFbGVtZW50KGRvYy5oZWFkKSxcbiAgICAgIGNzc1RleHQsXG4gICAgICBvcHRfaXNSdW50aW1lQ3NzIHx8IGZhbHNlLFxuICAgICAgb3B0X2V4dCB8fCBudWxsKTtcblxuICBpZiAoY2IpIHtcbiAgICAvLyBTdHlsZXMgYXJlbid0IGFsd2F5cyBhdmFpbGFibGUgc3luY2hyb25vdXNseS4gRS5nLiBpZiB0aGVyZSBpcyBhXG4gICAgLy8gcGVuZGluZyBzdHlsZSBkb3dubG9hZCwgaXQgd2lsbCBoYXZlIHRvIGZpbmlzaCBiZWZvcmUgdGhlIG5ld1xuICAgIC8vIHN0eWxlIGlzIHZpc2libGUuXG4gICAgLy8gRm9yIHRoaXMgcmVhc29uIHdlIHBvbGwgdW50aWwgdGhlIHN0eWxlIGJlY29tZXMgYXZhaWxhYmxlLlxuICAgIC8vIFN5bmMgY2FzZS5cbiAgICBpZiAoc3R5bGVMb2FkZWQoZG9jLCBzdHlsZSkpIHtcbiAgICAgIGNiKHN0eWxlKTtcbiAgICAgIHJldHVybiBzdHlsZTtcbiAgICB9XG4gICAgLy8gUG9sbCB1bnRpbCBzdHlsZXMgYXJlIGF2YWlsYWJsZS5cbiAgICBjb25zdCBpbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGlmIChzdHlsZUxvYWRlZChkb2MsIHN0eWxlKSkge1xuICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsKTtcbiAgICAgICAgY2Ioc3R5bGUpO1xuICAgICAgfVxuICAgIH0sIDQpO1xuICB9XG4gIHJldHVybiBzdHlsZTtcbn1cblxuXG4vKipcbiAqIENyZWF0ZXMgdGhlIHByb3Blcmx5IGNvbmZpZ3VyZWQgc3R5bGUgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IVNoYWRvd1Jvb3R9IGNzc1Jvb3RcbiAqIEBwYXJhbSB7c3RyaW5nfSBjc3NUZXh0XG4gKiBAcGFyYW0ge2Jvb2xlYW59IGlzUnVudGltZUNzc1xuICogQHBhcmFtIHs/c3RyaW5nfSBleHRcbiAqIEByZXR1cm4geyFFbGVtZW50fVxuICovXG5mdW5jdGlvbiBpbnNlcnRTdHlsZUVsZW1lbnQoY3NzUm9vdCwgY3NzVGV4dCwgaXNSdW50aW1lQ3NzLCBleHQpIHtcbiAgbGV0IHN0eWxlTWFwID0gY3NzUm9vdFtTVFlMRV9NQVBfUFJPUF07XG4gIGlmICghc3R5bGVNYXApIHtcbiAgICBzdHlsZU1hcCA9IGNzc1Jvb3RbU1RZTEVfTUFQX1BST1BdID0gbWFwKCk7XG4gIH1cblxuICBjb25zdCBpc0V4dENzcyA9ICFpc1J1bnRpbWVDc3MgJiZcbiAgICAgIChleHQgJiYgZXh0ICE9ICdhbXAtY3VzdG9tJyAmJiBleHQgIT0gJ2FtcC1rZXlmcmFtZXMnKTtcbiAgY29uc3Qga2V5ID1cbiAgICAgIGlzUnVudGltZUNzcyA/ICdhbXAtcnVudGltZScgOlxuICAgICAgICBpc0V4dENzcyA/IGBhbXAtZXh0ZW5zaW9uPSR7ZXh0fWAgOiBudWxsO1xuXG4gIC8vIENoZWNrIGlmIGl0IGhhcyBhbHJlYWR5IGJlZW4gY3JlYXRlZCBvciBkaXNjb3ZlcmVkLlxuICBpZiAoa2V5KSB7XG4gICAgY29uc3QgZXhpc3RpbmcgPSBnZXRFeGlzdGluZ1N0eWxlRWxlbWVudChjc3NSb290LCBzdHlsZU1hcCwga2V5KTtcbiAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgIHJldHVybiBleGlzdGluZztcbiAgICB9XG4gIH1cblxuICAvLyBDcmVhdGUgdGhlIG5ldyBzdHlsZSBlbGVtZW50IGFuZCBhcHBlbmQgdG8gY3NzUm9vdC5cbiAgY29uc3QgZG9jID0gKGNzc1Jvb3Qub3duZXJEb2N1bWVudCB8fCBjc3NSb290KTtcbiAgY29uc3Qgc3R5bGUgPSBkb2MuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgc3R5bGUuLypPSyovdGV4dENvbnRlbnQgPSBjc3NUZXh0O1xuICBsZXQgYWZ0ZXJFbGVtZW50ID0gbnVsbDtcbiAgLy8gTWFrZSBzdXJlIHRoYXQgd2UgcGxhY2Ugc3R5bGUgdGFncyBhZnRlciB0aGUgbWFpbiBydW50aW1lIENTUy4gT3RoZXJ3aXNlXG4gIC8vIHRoZSBvcmRlciBpcyByYW5kb20uXG4gIGlmIChpc1J1bnRpbWVDc3MpIHtcbiAgICBzdHlsZS5zZXRBdHRyaWJ1dGUoJ2FtcC1ydW50aW1lJywgJycpO1xuICB9IGVsc2UgaWYgKGlzRXh0Q3NzKSB7XG4gICAgc3R5bGUuc2V0QXR0cmlidXRlKCdhbXAtZXh0ZW5zaW9uJywgZXh0IHx8ICcnKTtcbiAgICBhZnRlckVsZW1lbnQgPSBkZXYoKS5hc3NlcnRFbGVtZW50KGdldEV4aXN0aW5nU3R5bGVFbGVtZW50KFxuICAgICAgICBjc3NSb290LCBzdHlsZU1hcCwgJ2FtcC1ydW50aW1lJykpO1xuICB9IGVsc2Uge1xuICAgIGlmIChleHQpIHtcbiAgICAgIHN0eWxlLnNldEF0dHJpYnV0ZShleHQsICcnKTtcbiAgICB9XG4gICAgYWZ0ZXJFbGVtZW50ID0gY3NzUm9vdC5sYXN0Q2hpbGQ7XG4gIH1cbiAgaW5zZXJ0QWZ0ZXJPckF0U3RhcnQoY3NzUm9vdCwgc3R5bGUsIGFmdGVyRWxlbWVudCk7XG4gIGlmIChrZXkpIHtcbiAgICBzdHlsZU1hcFtrZXldID0gc3R5bGU7XG4gIH1cbiAgcmV0dXJuIHN0eWxlO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshRWxlbWVudHwhU2hhZG93Um9vdH0gY3NzUm9vdFxuICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgIUVsZW1lbnQ+fSBzdHlsZU1hcFxuICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmZ1bmN0aW9uIGdldEV4aXN0aW5nU3R5bGVFbGVtZW50KGNzc1Jvb3QsIHN0eWxlTWFwLCBrZXkpIHtcbiAgLy8gQWxyZWFkeSBjYWNoZWQuXG4gIGlmIChzdHlsZU1hcFtrZXldKSB7XG4gICAgcmV0dXJuIHN0eWxlTWFwW2tleV07XG4gIH1cbiAgLy8gQ2hlY2sgaWYgdGhlIHN0eWxlIGhhcyBhbHJlYWR5IGJlZW4gYWRkZWQgYnkgdGhlIHNlcnZlciBsYXlvdXQuXG4gIGNvbnN0IGV4aXN0aW5nID0gY3NzUm9vdC4vKk9LKi9xdWVyeVNlbGVjdG9yKGBzdHlsZVske2tleX1dYCk7XG4gIGlmIChleGlzdGluZykge1xuICAgIHN0eWxlTWFwW2tleV0gPSBleGlzdGluZztcbiAgICByZXR1cm4gZXhpc3Rpbmc7XG4gIH1cbiAgLy8gTm90aGluZyBmb3VuZC5cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuLyoqXG4gKiBBcHBsaWVzIGEgdHJhbnNmb3JtZXIgdG8gdGhlIENTUyB0ZXh0IGlmIGl0IGhhcyBiZWVuIHJlZ2lzdGVyZWQuXG4gKiBAcGFyYW0geyFFbGVtZW50fCFTaGFkb3dSb290fSBjc3NSb290XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKHN0cmluZyk6c3RyaW5nfSB0cmFuc2Zvcm1lclxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbENzc1RyYW5zZm9ybWVyKGNzc1Jvb3QsIHRyYW5zZm9ybWVyKSB7XG4gIGNzc1Jvb3RbVFJBTlNGT1JNRVJfUFJPUF0gPSB0cmFuc2Zvcm1lcjtcbn1cblxuXG4vKipcbiAqIEFwcGxpZXMgYSB0cmFuc2Zvcm1lciB0byB0aGUgQ1NTIHRleHQgaWYgaXQgaGFzIGJlZW4gcmVnaXN0ZXJlZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IVNoYWRvd1Jvb3R9IGNzc1Jvb3RcbiAqIEBwYXJhbSB7c3RyaW5nfSBjc3NUZXh0XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIG1heWJlVHJhbnNmb3JtKGNzc1Jvb3QsIGNzc1RleHQpIHtcbiAgY29uc3QgdHJhbnNmb3JtZXIgPSBjc3NSb290W1RSQU5TRk9STUVSX1BST1BdO1xuICByZXR1cm4gdHJhbnNmb3JtZXIgPyB0cmFuc2Zvcm1lcihjc3NUZXh0KSA6IGNzc1RleHQ7XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBkb2N1bWVudCdzIGJvZHkgb3BhY2l0eSB0byAxLlxuICogSWYgdGhlIGJvZHkgaXMgbm90IHlldCBhdmFpbGFibGUgKGJlY2F1c2Ugb3VyIHNjcmlwdCB3YXMgbG9hZGVkXG4gKiBzeW5jaHJvbm91c2x5KSwgcG9sbHMgdW50aWwgaXQgaXMuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jIFRoZSBkb2N1bWVudCB3aG8ncyBib2R5IHdlIHNob3VsZCBtYWtlIHZpc2libGUuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfd2FpdEZvclNlcnZpY2VzIFdoZXRoZXIgdGhlIGJvZHkgdmlzaWJpbGl0eSBzaG91bGRcbiAqICAgICBiZSBibG9ja2VkIG9uIGtleSBzZXJ2aWNlcyBiZWluZyBsb2FkZWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYWtlQm9keVZpc2libGUoZG9jLCBvcHRfd2FpdEZvclNlcnZpY2VzKSB7XG4gIGRldigpLmFzc2VydChkb2MuZGVmYXVsdFZpZXcsICdQYXNzZWQgaW4gZG9jdW1lbnQgbXVzdCBoYXZlIGEgZGVmYXVsdFZpZXcnKTtcbiAgY29uc3Qgd2luID0gLyoqIEB0eXBlIHshV2luZG93fSAqLyAoZG9jLmRlZmF1bHRWaWV3KTtcbiAgaWYgKHdpbltib2R5VmlzaWJsZVNlbnRpbmVsXSkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBzZXQgPSAoKSA9PiB7XG4gICAgd2luW2JvZHlWaXNpYmxlU2VudGluZWxdID0gdHJ1ZTtcbiAgICBzZXRTdHlsZXMoZGV2KCkuYXNzZXJ0RWxlbWVudChkb2MuYm9keSksIHtcbiAgICAgIG9wYWNpdHk6IDEsXG4gICAgICB2aXNpYmlsaXR5OiAndmlzaWJsZScsXG4gICAgICAnYW5pbWF0aW9uJzogJ25vbmUnLFxuICAgIH0pO1xuICAgIHJlbmRlclN0YXJ0ZWROb0lubGluZShkb2MpO1xuICB9O1xuICB0cnkge1xuICAgIHdhaXRGb3JCb2R5KGRvYywgKCkgPT4ge1xuICAgICAgaWYgKHdpbltib2R5VmlzaWJsZVNlbnRpbmVsXSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB3aW5bYm9keVZpc2libGVTZW50aW5lbF0gPSB0cnVlO1xuICAgICAgaWYgKG9wdF93YWl0Rm9yU2VydmljZXMpIHtcbiAgICAgICAgd2FpdEZvclNlcnZpY2VzKHdpbikuY2F0Y2gocmVhc29uID0+IHtcbiAgICAgICAgICByZXRocm93QXN5bmMocmVhc29uKTtcbiAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH0pLnRoZW4oc2VydmljZXMgPT4ge1xuICAgICAgICAgIHNldCgpO1xuICAgICAgICAgIGlmIChzZXJ2aWNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBTZXJ2aWNlcy5yZXNvdXJjZXNGb3JEb2MoZG9jKS4vKk9LKi9zY2hlZHVsZVBhc3MoXG4gICAgICAgICAgICAgICAgMSwgLyogcmVsYXlvdXRBbGwgKi8gdHJ1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBwZXJmID0gU2VydmljZXMucGVyZm9ybWFuY2VGb3Iod2luKTtcbiAgICAgICAgICAgIHBlcmYudGljaygnbWJ2Jyk7XG4gICAgICAgICAgICBwZXJmLmZsdXNoKCk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXQoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIC8vIElmIHRoZXJlIHdhcyBhbiBlcnJvciBkdXJpbmcgdGhlIGxvZ2ljIGFib3ZlIChzdWNoIGFzIHNlcnZpY2Ugbm90XG4gICAgLy8geWV0IGluc3RhbGxlZCwgZGVmaW5pdGVseSB0cnkgdG8gbWFrZSB0aGUgYm9keSB2aXNpYmxlLlxuICAgIHNldCgpO1xuICAgIC8vIEF2b2lkIGVycm9ycyBpbiB0aGUgZnVuY3Rpb24gdG8gYnJlYWsgZXhlY3V0aW9uIGZsb3cgYXMgdGhpcyBpc1xuICAgIC8vIG9mdGVuIGNhbGxlZCBhcyBhIGxhc3QgcmVzb3J0LlxuICAgIHJldGhyb3dBc3luYyhlKTtcbiAgfVxufVxuXG5cbi8qKlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICovXG5mdW5jdGlvbiByZW5kZXJTdGFydGVkTm9JbmxpbmUoZG9jKSB7XG4gIHRyeSB7XG4gICAgU2VydmljZXMucmVzb3VyY2VzRm9yRG9jKGRvYykucmVuZGVyU3RhcnRlZCgpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gYG1ha2VCb2R5VmlzaWJsZWAgaXMgY2FsbGVkIGluIHRoZSBlcnJvci1wcm9jZXNzaW5nIGN5Y2xlIGFuZCB0aHVzXG4gICAgLy8gY291bGQgYmUgdHJpZ2dlcmVkIHdoZW4gcnVudGltZSdzIGluaXRpYWxpemF0aW9uIGlzIGluY29tcGxldGUgd2hpY2hcbiAgICAvLyB3b3VsZCBjYXVzZSB1bnJlbGF0ZWQgZXJyb3JzIHRvIGJlIHRocm93biBoZXJlLlxuICB9XG59XG5cblxuLyoqXG4gKiBJbmRpY2F0ZXMgdGhhdCB0aGUgYm9keSBpcyBhbHdheXMgdmlzaWJsZS4gRm9yIGluc3RhbmNlLCBpbiBjYXNlIG9mIFBXQS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBib2R5QWx3YXlzVmlzaWJsZSh3aW4pIHtcbiAgd2luW2JvZHlWaXNpYmxlU2VudGluZWxdID0gdHJ1ZTtcbn1cblxuXG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIGEgc3R5bGUgZWxlbWVudCB3YXMgcmVnaXN0ZXJlZCBpbiB0aGUgRE9NLlxuICogQHBhcmFtIHshRG9jdW1lbnR8IVNoYWRvd1Jvb3R9IGRvY1xuICogQHBhcmFtIHshRWxlbWVudH0gc3R5bGVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIHN0eWxlTG9hZGVkKGRvYywgc3R5bGUpIHtcbiAgY29uc3Qgc2hlZXRzID0gZG9jLnN0eWxlU2hlZXRzO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHNoZWV0cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHNoZWV0ID0gc2hlZXRzW2ldO1xuICAgIGlmIChzaGVldC5vd25lck5vZGUgPT0gc3R5bGUpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLy8gTm90ZTogbG9hZGVkIGJ5IDNwIHN5c3RlbS4gQ2Fubm90IHJlbHkgb24gYmFiZWwgcG9seWZpbGxzLlxuaW1wb3J0IHttYXB9IGZyb20gJy4vdXRpbHMvb2JqZWN0LmpzJztcbmltcG9ydCB7c3RhcnRzV2l0aH0gZnJvbSAnLi9zdHJpbmcnO1xuXG5cbi8qKiBAdHlwZSB7T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gKi9cbmxldCBwcm9wZXJ0eU5hbWVDYWNoZTtcblxuLyoqIEBjb25zdCB7IUFycmF5PHN0cmluZz59ICovXG5jb25zdCB2ZW5kb3JQcmVmaXhlcyA9IFsnV2Via2l0JywgJ3dlYmtpdCcsICdNb3onLCAnbW96JywgJ21zJywgJ08nLCAnbyddO1xuXG5cbi8qKlxuICogQGV4cG9ydFxuICogQHBhcmFtIHtzdHJpbmd9IGNhbWVsQ2FzZSBjYW1lbCBjYXNlZCBzdHJpbmdcbiAqIEByZXR1cm4ge3N0cmluZ30gdGl0bGUgY2FzZWQgc3RyaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW1lbENhc2VUb1RpdGxlQ2FzZShjYW1lbENhc2UpIHtcbiAgcmV0dXJuIGNhbWVsQ2FzZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGNhbWVsQ2FzZS5zbGljZSgxKTtcbn1cblxuLyoqXG4gKiBDaGVja3MgdGhlIHN0eWxlIGlmIGEgcHJlZml4ZWQgdmVyc2lvbiBvZiBhIHByb3BlcnR5IGV4aXN0cyBhbmQgcmV0dXJuc1xuICogaXQgb3IgcmV0dXJucyBhbiBlbXB0eSBzdHJpbmcuXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHshT2JqZWN0fSBzdHlsZVxuICogQHBhcmFtIHtzdHJpbmd9IHRpdGxlQ2FzZSB0aGUgdGl0bGUgY2FzZSB2ZXJzaW9uIG9mIGEgY3NzIHByb3BlcnR5IG5hbWVcbiAqIEByZXR1cm4ge3N0cmluZ30gdGhlIHByZWZpeGVkIHByb3BlcnR5IG5hbWUgb3IgbnVsbC5cbiAqL1xuZnVuY3Rpb24gZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWVfKHN0eWxlLCB0aXRsZUNhc2UpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB2ZW5kb3JQcmVmaXhlcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHByb3BlcnR5TmFtZSA9IHZlbmRvclByZWZpeGVzW2ldICsgdGl0bGVDYXNlO1xuICAgIGlmIChzdHlsZVtwcm9wZXJ0eU5hbWVdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBwcm9wZXJ0eU5hbWU7XG4gICAgfVxuICB9XG4gIHJldHVybiAnJztcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwb3NzaWJseSBwcmVmaXhlZCBKYXZhU2NyaXB0IHByb3BlcnR5IG5hbWUgb2YgYSBzdHlsZSBwcm9wZXJ0eVxuICogKGV4LiBXZWJraXRUcmFuc2l0aW9uRHVyYXRpb24pIGdpdmVuIGEgY2FtZWxDYXNlJ2QgdmVyc2lvbiBvZiB0aGUgcHJvcGVydHlcbiAqIChleC4gdHJhbnNpdGlvbkR1cmF0aW9uKS5cbiAqIEBleHBvcnRcbiAqIEBwYXJhbSB7IU9iamVjdH0gc3R5bGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBjYW1lbENhc2UgdGhlIGNhbWVsIGNhc2VkIHZlcnNpb24gb2YgYSBjc3MgcHJvcGVydHkgbmFtZVxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2J5cGFzc0NhY2hlIGJ5cGFzcyB0aGUgbWVtb2l6ZWQgY2FjaGUgb2YgcHJvcGVydHlcbiAqICAgbWFwcGluZ1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWUoc3R5bGUsIGNhbWVsQ2FzZSwgb3B0X2J5cGFzc0NhY2hlKSB7XG4gIGlmIChzdGFydHNXaXRoKGNhbWVsQ2FzZSwgJy0tJykpIHtcbiAgICAvLyBDU1MgdmFycyBhcmUgcmV0dXJuZWQgYXMgaXMuXG4gICAgcmV0dXJuIGNhbWVsQ2FzZTtcbiAgfVxuICBpZiAoIXByb3BlcnR5TmFtZUNhY2hlKSB7XG4gICAgcHJvcGVydHlOYW1lQ2FjaGUgPSBtYXAoKTtcbiAgfVxuICBsZXQgcHJvcGVydHlOYW1lID0gcHJvcGVydHlOYW1lQ2FjaGVbY2FtZWxDYXNlXTtcbiAgaWYgKCFwcm9wZXJ0eU5hbWUgfHwgb3B0X2J5cGFzc0NhY2hlKSB7XG4gICAgcHJvcGVydHlOYW1lID0gY2FtZWxDYXNlO1xuICAgIGlmIChzdHlsZVtjYW1lbENhc2VdID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnN0IHRpdGxlQ2FzZSA9IGNhbWVsQ2FzZVRvVGl0bGVDYXNlKGNhbWVsQ2FzZSk7XG4gICAgICBjb25zdCBwcmVmaXhlZFByb3BlcnR5TmFtZSA9IGdldFZlbmRvckpzUHJvcGVydHlOYW1lXyhzdHlsZSwgdGl0bGVDYXNlKTtcblxuICAgICAgaWYgKHN0eWxlW3ByZWZpeGVkUHJvcGVydHlOYW1lXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHByb3BlcnR5TmFtZSA9IHByZWZpeGVkUHJvcGVydHlOYW1lO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIW9wdF9ieXBhc3NDYWNoZSkge1xuICAgICAgcHJvcGVydHlOYW1lQ2FjaGVbY2FtZWxDYXNlXSA9IHByb3BlcnR5TmFtZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHByb3BlcnR5TmFtZTtcbn1cblxuXG4vKipcbiAqIFNldHMgdGhlIENTUyBzdHlsZXMgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IHdpdGggIWltcG9ydGFudC4gVGhlIHN0eWxlc1xuICogYXJlIHNwZWNpZmllZCBhcyBhIG1hcCBmcm9tIENTUyBwcm9wZXJ0eSBuYW1lcyB0byB0aGVpciB2YWx1ZXMuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPn0gc3R5bGVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRJbXBvcnRhbnRTdHlsZXMoZWxlbWVudCwgc3R5bGVzKSB7XG4gIGZvciAoY29uc3QgayBpbiBzdHlsZXMpIHtcbiAgICBlbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KFxuICAgICAgICBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZShzdHlsZXMsIGspLCBzdHlsZXNba10udG9TdHJpbmcoKSwgJ2ltcG9ydGFudCcpO1xuICB9XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBDU1Mgc3R5bGUgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IHdpdGggb3B0aW9uYWwgdW5pdHMsIGUuZy4gXCJweFwiLlxuICogQHBhcmFtIHs/RWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5XG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF91bml0c1xuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2J5cGFzc0NhY2hlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRTdHlsZShlbGVtZW50LCBwcm9wZXJ0eSwgdmFsdWUsIG9wdF91bml0cywgb3B0X2J5cGFzc0NhY2hlKSB7XG4gIGNvbnN0IHByb3BlcnR5TmFtZSA9IGdldFZlbmRvckpzUHJvcGVydHlOYW1lKGVsZW1lbnQuc3R5bGUsIHByb3BlcnR5LFxuICAgICAgb3B0X2J5cGFzc0NhY2hlKTtcbiAgaWYgKHByb3BlcnR5TmFtZSkge1xuICAgIGVsZW1lbnQuc3R5bGVbcHJvcGVydHlOYW1lXSA9XG4gICAgICAvKiogQHR5cGUge3N0cmluZ30gKi8gKG9wdF91bml0cyA/IHZhbHVlICsgb3B0X3VuaXRzIDogdmFsdWUpO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgQ1NTIHN0eWxlIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wZXJ0eVxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2J5cGFzc0NhY2hlXG4gKiBAcmV0dXJuIHsqfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3R5bGUoZWxlbWVudCwgcHJvcGVydHksIG9wdF9ieXBhc3NDYWNoZSkge1xuICBjb25zdCBwcm9wZXJ0eU5hbWUgPSBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZShlbGVtZW50LnN0eWxlLCBwcm9wZXJ0eSxcbiAgICAgIG9wdF9ieXBhc3NDYWNoZSk7XG4gIGlmICghcHJvcGVydHlOYW1lKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICByZXR1cm4gZWxlbWVudC5zdHlsZVtwcm9wZXJ0eU5hbWVdO1xufVxuXG5cbi8qKlxuICogU2V0cyB0aGUgQ1NTIHN0eWxlcyBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQuIFRoZSBzdHlsZXNcbiAqIGEgc3BlY2lmaWVkIGFzIGEgbWFwIGZyb20gQ1NTIHByb3BlcnR5IG5hbWVzIHRvIHRoZWlyIHZhbHVlcy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICo+fSBzdHlsZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFN0eWxlcyhlbGVtZW50LCBzdHlsZXMpIHtcbiAgZm9yIChjb25zdCBrIGluIHN0eWxlcykge1xuICAgIHNldFN0eWxlKGVsZW1lbnQsIGssIHN0eWxlc1trXSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFNob3dzIG9yIGhpZGVzIHRoZSBzcGVjaWZpZWQgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9kaXNwbGF5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGUoZWxlbWVudCwgb3B0X2Rpc3BsYXkpIHtcbiAgaWYgKG9wdF9kaXNwbGF5ID09PSB1bmRlZmluZWQpIHtcbiAgICBvcHRfZGlzcGxheSA9IGdldFN0eWxlKGVsZW1lbnQsICdkaXNwbGF5JykgPT0gJ25vbmUnO1xuICB9XG4gIHNldFN0eWxlKGVsZW1lbnQsICdkaXNwbGF5Jywgb3B0X2Rpc3BsYXkgPyAnJyA6ICdub25lJyk7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcGl4ZWwgdmFsdWUuXG4gKiBAcGFyYW0ge251bWJlcn0gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHB4KHZhbHVlKSB7XG4gIHJldHVybiBgJHt2YWx1ZX1weGA7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGRlZ3JlZSB2YWx1ZS5cbiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVnKHZhbHVlKSB7XG4gIHJldHVybiBgJHt2YWx1ZX1kZWdgO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBcInRyYW5zbGF0ZVhcIiBmb3IgQ1NTIFwidHJhbnNmb3JtXCIgcHJvcGVydHkuXG4gKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2xhdGVYKHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gYHRyYW5zbGF0ZVgoJHt2YWx1ZX0pYDtcbiAgfVxuICByZXR1cm4gYHRyYW5zbGF0ZVgoJHtweCh2YWx1ZSl9KWA7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgXCJ0cmFuc2xhdGVYXCIgZm9yIENTUyBcInRyYW5zZm9ybVwiIHByb3BlcnR5LlxuICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSB4XG4gKiBAcGFyYW0geyhudW1iZXJ8c3RyaW5nKT19IG9wdF95XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2xhdGUoeCwgb3B0X3kpIHtcbiAgaWYgKHR5cGVvZiB4ID09ICdudW1iZXInKSB7XG4gICAgeCA9IHB4KHgpO1xuICB9XG4gIGlmIChvcHRfeSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIGB0cmFuc2xhdGUoJHt4fSlgO1xuICB9XG4gIGlmICh0eXBlb2Ygb3B0X3kgPT0gJ251bWJlcicpIHtcbiAgICBvcHRfeSA9IHB4KG9wdF95KTtcbiAgfVxuICByZXR1cm4gYHRyYW5zbGF0ZSgke3h9LCAke29wdF95fSlgO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIFwic2NhbGVcIiBmb3IgQ1NTIFwidHJhbnNmb3JtXCIgcHJvcGVydHkuXG4gKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzY2FsZSh2YWx1ZSkge1xuICByZXR1cm4gYHNjYWxlKCR7dmFsdWV9KWA7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIFwicm90YXRlXCIgZm9yIENTUyBcInRyYW5zZm9ybVwiIHByb3BlcnR5LlxuICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcm90YXRlKHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT0gJ251bWJlcicpIHtcbiAgICB2YWx1ZSA9IGRlZyh2YWx1ZSk7XG4gIH1cbiAgcmV0dXJuIGByb3RhdGUoJHt2YWx1ZX0pYDtcbn1cblxuLyoqXG4gKiBSZW1vdmUgYWxwaGEgdmFsdWUgZnJvbSBhIHJnYmEgY29sb3IgdmFsdWUuXG4gKiBSZXR1cm4gdGhlIG5ldyBjb2xvciBwcm9wZXJ0eSB3aXRoIGFscGhhIGVxdWFscyBpZiBoYXMgdGhlIGFscGhhIHZhbHVlLlxuICogQ2FsbGVyIG5lZWRzIHRvIG1ha2Ugc3VyZSB0aGUgaW5wdXQgY29sb3IgdmFsdWUgaXMgYSB2YWxpZCByZ2JhL3JnYiB2YWx1ZVxuICogQHBhcmFtIHtzdHJpbmd9IHJnYmFDb2xvclxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlQWxwaGFGcm9tQ29sb3IocmdiYUNvbG9yKSB7XG4gIHJldHVybiByZ2JhQ29sb3IucmVwbGFjZShcbiAgICAgIC9cXCgoW14sXSspLChbXixdKyksKFteLCldKyksW14pXStcXCkvZywgJygkMSwkMiwkMywgMSknKTtcbn1cblxuLyoqXG4gKiBHZXRzIHRoZSBjb21wdXRlZCBzdHlsZSBvZiB0aGUgZWxlbWVudC4gVGhlIGhlbHBlciBpcyBuZWNlc3NhcnkgdG8gZW5mb3JjZVxuICogdGhlIHBvc3NpYmxlIGBudWxsYCB2YWx1ZSByZXR1cm5lZCBieSBhIGJ1Z2d5IEZpcmVmb3guXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVkU3R5bGUod2luLCBlbCkge1xuICBjb25zdCBzdHlsZSA9IC8qKiBAdHlwZSB7P0NTU1N0eWxlRGVjbGFyYXRpb259ICovKHdpbi5nZXRDb21wdXRlZFN0eWxlKGVsKSk7XG4gIHJldHVybiAvKiogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSAqLyhzdHlsZSkgfHwgbWFwKCk7XG59XG5cblxuLyoqXG4gKiBSZXNldHMgc3R5bGVzIHRoYXQgd2VyZSBzZXQgZHluYW1pY2FsbHkgKGkuZS4gaW5saW5lKVxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHshQXJyYXk8c3RyaW5nPn0gcHJvcGVydGllc1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRTdHlsZXMoZWxlbWVudCwgcHJvcGVydGllcykge1xuICBjb25zdCBzdHlsZU9iaiA9IHt9O1xuICBwcm9wZXJ0aWVzLmZvckVhY2gocHJvcCA9PiB7XG4gICAgc3R5bGVPYmpbcHJvcF0gPSBudWxsO1xuICB9KTtcbiAgc2V0U3R5bGVzKGVsZW1lbnQsIHN0eWxlT2JqKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKiBAY29uc3QgKi9cbmNvbnN0IHRvU3RyaW5nXyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG5cbi8qKlxuICogUmV0dXJucyB0aGUgRUNNQSBbW0NsYXNzXV0gb2YgYSB2YWx1ZVxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0b1N0cmluZyh2YWx1ZSkge1xuICByZXR1cm4gdG9TdHJpbmdfLmNhbGwodmFsdWUpO1xufVxuXG4vKipcbiAqIERldGVybWluZXMgaWYgdmFsdWUgaXMgYWN0dWFsbHkgYW4gQXJyYXkuXG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBcnJheSh2YWx1ZSkge1xuICByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG59XG5cbi8qKlxuICogQ29udmVydHMgYW4gYXJyYXktbGlrZSBvYmplY3QgdG8gYW4gYXJyYXkuXG4gKiBAcGFyYW0gez9JQXJyYXlMaWtlPFQ+fHN0cmluZ30gYXJyYXlMaWtlXG4gKiBAcmV0dXJuIHshQXJyYXk8VD59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9BcnJheShhcnJheUxpa2UpIHtcbiAgaWYgKCFhcnJheUxpa2UpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgY29uc3QgYXJyYXkgPSBuZXcgQXJyYXkoYXJyYXlMaWtlLmxlbmd0aCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXlMaWtlLmxlbmd0aDsgaSsrKSB7XG4gICAgYXJyYXlbaV0gPSBhcnJheUxpa2VbaV07XG4gIH1cbiAgcmV0dXJuIGFycmF5O1xufVxuXG4vKipcbiAqIERldGVybWluZXMgaWYgdmFsdWUgaXMgYWN0dWFsbHkgYW4gT2JqZWN0LlxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlKSB7XG4gIHJldHVybiB0b1N0cmluZyh2YWx1ZSkgPT09ICdbb2JqZWN0IE9iamVjdF0nO1xufVxuXG4vKipcbiAqIERldGVybWluZXMgaWYgdmFsdWUgaXMgb2YgbnVtYmVyIHR5cGUgYW5kIGZpbml0ZS5cbiAqIE5hTiBhbmQgSW5maW5pdHkgYXJlIG5vdCBjb25zaWRlcmVkIGEgZmluaXRlIG51bWJlci5cbiAqIFN0cmluZyBudW1iZXJzIGFyZSBub3QgY29uc2lkZXJlZCBudW1iZXJzLlxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRmluaXRlTnVtYmVyKHZhbHVlKSB7XG4gIHJldHVybiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiBpc0Zpbml0ZSh2YWx1ZSkpO1xufVxuXG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIGBzYCBpcyBhIHZhbGlkIHZhbHVlIG9mIGBlbnVtT2JqYC5cbiAqXG4gKiBAcGFyYW0geyFPYmplY3Q8VD59IGVudW1PYmpcbiAqIEBwYXJhbSB7VH0gc1xuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0VudW1WYWx1ZShlbnVtT2JqLCBzKSB7XG4gIGZvciAoY29uc3QgayBpbiBlbnVtT2JqKSB7XG4gICAgaWYgKGVudW1PYmpba10gPT09IHMpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogRXh0ZXJucyBkZWNsYXJlIHRoYXQgYWNjZXNzIGBkZWZhdWx0Vmlld2AgZnJvbSBgZG9jdW1lbnRgIG9yXG4gKiBgb3duZXJEb2N1bWVudGAgaXMgb2YgdHlwZSBgKFdpbmRvd3xudWxsKWAgYnV0IG1vc3Qgb2Ygb3VyIHBhcmFtZXRlciB0eXBlc1xuICogYXNzdW1lIHRoYXQgaXQgaXMgbmV2ZXIgbnVsbC4gVGhpcyBpcyBPSyBpbiBwcmFjdGljZSBhcyB3ZSBldmVyIG9ubHkgZ2V0XG4gKiBudWxsIG9uIGRpc2Nvbm5lY3RlZCBkb2N1bWVudHMgb3Igb2xkIElFLlxuICogVGhpcyBoZWxwZXIgZnVuY3Rpb24gY2FzdHMgaXQgaW50byBqdXN0IGEgc2ltcGxlIFdpbmRvdyByZXR1cm4gdHlwZS5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d8bnVsbH0gd2luT3JOdWxsXG4gKiBAcmV0dXJuIHshV2luZG93fVxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9XaW4od2luT3JOdWxsKSB7XG4gIHJldHVybiAvKiogQHR5cGUgeyFXaW5kb3d9ICovICh3aW5Pck51bGwpO1xufVxuXG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHt0cnlEZWNvZGVVcmlDb21wb25lbnRffSBmcm9tICcuL3VybC10cnktZGVjb2RlLXVyaS1jb21wb25lbnQnO1xuXG5jb25zdCByZWdleCA9IC8oPzpeWyM/XT98JikoW149Jl0rKSg/Oj0oW14mXSopKT8vZztcblxuLyoqXG4gKiBQYXJzZXMgdGhlIHF1ZXJ5IHN0cmluZyBvZiBhbiBVUkwuIFRoaXMgbWV0aG9kIHJldHVybnMgYSBzaW1wbGUga2V5L3ZhbHVlXG4gKiBtYXAuIElmIHRoZXJlIGFyZSBkdXBsaWNhdGUga2V5cyB0aGUgbGF0ZXN0IHZhbHVlIGlzIHJldHVybmVkLlxuICpcbiAqIERPIE5PVCBpbXBvcnQgdGhlIGZ1bmN0aW9uIGZyb20gdGhpcyBmaWxlLiBJbnN0ZWFkLCBpbXBvcnQgcGFyc2VRdWVyeVN0cmluZ1xuICogZnJvbSBgc3JjL3VybC5qc2AuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5U3RyaW5nXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlUXVlcnlTdHJpbmdfKHF1ZXJ5U3RyaW5nKSB7XG4gIGNvbnN0IHBhcmFtcyA9IC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovIChPYmplY3QuY3JlYXRlKG51bGwpKTtcbiAgaWYgKCFxdWVyeVN0cmluZykge1xuICAgIHJldHVybiBwYXJhbXM7XG4gIH1cblxuICBsZXQgbWF0Y2g7XG4gIHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKHF1ZXJ5U3RyaW5nKSkpIHtcbiAgICBjb25zdCBuYW1lID0gdHJ5RGVjb2RlVXJpQ29tcG9uZW50XyhtYXRjaFsxXSwgbWF0Y2hbMV0pO1xuICAgIGNvbnN0IHZhbHVlID0gbWF0Y2hbMl0gPyB0cnlEZWNvZGVVcmlDb21wb25lbnRfKG1hdGNoWzJdLCBtYXRjaFsyXSkgOiAnJztcbiAgICBwYXJhbXNbbmFtZV0gPSB2YWx1ZTtcbiAgfVxuICByZXR1cm4gcGFyYW1zO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogVHJpZXMgdG8gZGVjb2RlIGEgVVJJIGNvbXBvbmVudCwgZmFsbGluZyBiYWNrIHRvIG9wdF9mYWxsYmFjayAob3IgYW4gZW1wdHlcbiAqIHN0cmluZylcbiAqXG4gKiBETyBOT1QgaW1wb3J0IHRoZSBmdW5jdGlvbiBmcm9tIHRoaXMgZmlsZS4gSW5zdGVhZCwgaW1wb3J0XG4gKiB0cnlEZWNvZGVVcmlDb21wb25lbnQgZnJvbSBgc3JjL3VybC5qc2AuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGNvbXBvbmVudFxuICogQHBhcmFtIHtzdHJpbmc9fSBmYWxsYmFja1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ5RGVjb2RlVXJpQ29tcG9uZW50Xyhjb21wb25lbnQsIGZhbGxiYWNrID0gJycpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGNvbXBvbmVudCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZmFsbGJhY2s7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge0xydUNhY2hlfSBmcm9tICcuL3V0aWxzL2xydS1jYWNoZSc7XG5pbXBvcnQge2RpY3R9IGZyb20gJy4vdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7ZW5kc1dpdGgsIHN0YXJ0c1dpdGh9IGZyb20gJy4vc3RyaW5nJztcbmltcG9ydCB7Z2V0TW9kZX0gZnJvbSAnLi9tb2RlJztcbmltcG9ydCB7aXNBcnJheX0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQge3BhcnNlUXVlcnlTdHJpbmdffSBmcm9tICcuL3VybC1wYXJzZS1xdWVyeS1zdHJpbmcnO1xuaW1wb3J0IHt0cnlEZWNvZGVVcmlDb21wb25lbnRffSBmcm9tICcuL3VybC10cnktZGVjb2RlLXVyaS1jb21wb25lbnQnO1xuaW1wb3J0IHt1cmxzfSBmcm9tICcuL2NvbmZpZyc7XG5pbXBvcnQge3VzZXJ9IGZyb20gJy4vbG9nJztcblxuLyoqXG4gKiBAdHlwZSB7IUpzb25PYmplY3R9XG4gKi9cbmNvbnN0IFNFUlZJTkdfVFlQRV9QUkVGSVggPSBkaWN0KHtcbiAgLy8gTm8gdmlld2VyXG4gICdjJzogdHJ1ZSxcbiAgLy8gSW4gdmlld2VyXG4gICd2JzogdHJ1ZSxcbiAgLy8gQWQgbGFuZGluZyBwYWdlXG4gICdhJzogdHJ1ZSxcbiAgLy8gQWRcbiAgJ2FkJzogdHJ1ZSxcbn0pO1xuXG4vKipcbiAqIENhY2hlZCBhLXRhZyB0byBhdm9pZCBtZW1vcnkgYWxsb2NhdGlvbiBkdXJpbmcgVVJMIHBhcnNpbmcuXG4gKiBAdHlwZSB7SFRNTEFuY2hvckVsZW1lbnR9XG4gKi9cbmxldCBhO1xuXG4vKipcbiAqIFdlIGNhY2hlZCBhbGwgcGFyc2VkIFVSTHMuIEFzIG9mIG5vdyB0aGVyZSBhcmUgbm8gdXNlIGNhc2VzXG4gKiBvZiBBTVAgZG9jcyB0aGF0IHdvdWxkIGV2ZXIgcGFyc2UgYW4gYWN0dWFsIGxhcmdlIG51bWJlciBvZiBVUkxzLFxuICogYnV0IHdlIG9mdGVuIHBhcnNlIHRoZSBzYW1lIG9uZSBvdmVyIGFuZCBvdmVyIGFnYWluLlxuICogQHR5cGUge0xydUNhY2hlfVxuICovXG5sZXQgY2FjaGU7XG5cbi8qKiBAcHJpdmF0ZSBAY29uc3QgTWF0Y2hlcyBhbXBfanNfKiBwYXJhbWV0ZXJzIGluIHF1ZXJ5IHN0cmluZy4gKi9cbmNvbnN0IEFNUF9KU19QQVJBTVNfUkVHRVggPSAvWz8mXWFtcF9qc1teJl0qLztcblxuLyoqIEBwcml2YXRlIEBjb25zdCBNYXRjaGVzIGFtcF9nc2EgcGFyYW1ldGVycyBpbiBxdWVyeSBzdHJpbmcuICovXG5jb25zdCBBTVBfR1NBX1BBUkFNU19SRUdFWCA9IC9bPyZdYW1wX2dzYVteJl0qLztcblxuLyoqIEBwcml2YXRlIEBjb25zdCBNYXRjaGVzIGFtcF9yIHBhcmFtZXRlcnMgaW4gcXVlcnkgc3RyaW5nLiAqL1xuY29uc3QgQU1QX1JfUEFSQU1TX1JFR0VYID0gL1s/Jl1hbXBfclteJl0qLztcblxuLyoqIEBwcml2YXRlIEBjb25zdCBNYXRjaGVzIHVzcXAgcGFyYW1ldGVycyBmcm9tIGdvb2cgZXhwZXJpbWVudCBpbiBxdWVyeSBzdHJpbmcuICovXG5jb25zdCBHT09HTEVfRVhQRVJJTUVOVF9QQVJBTVNfUkVHRVggPSAvWz8mXXVzcXBbXiZdKi87XG5cbmNvbnN0IElOVkFMSURfUFJPVE9DT0xTID0gW1xuICAvKmVzbGludCBuby1zY3JpcHQtdXJsOiAwKi8gJ2phdmFzY3JpcHQ6JyxcbiAgLyplc2xpbnQgbm8tc2NyaXB0LXVybDogMCovICdkYXRhOicsXG4gIC8qZXNsaW50IG5vLXNjcmlwdC11cmw6IDAqLyAndmJzY3JpcHQ6Jyxcbl07XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBTT1VSQ0VfT1JJR0lOX1BBUkFNID0gJ19fYW1wX3NvdXJjZV9vcmlnaW4nO1xuXG4vKipcbiAqIFJldHVybnMgdGhlIGNvcnJlY3Qgb3JpZ2luIGZvciBhIGdpdmVuIHdpbmRvdy5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtzdHJpbmd9IG9yaWdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0V2luT3JpZ2luKHdpbikge1xuICByZXR1cm4gd2luLm9yaWdpbiB8fCBwYXJzZVVybERlcHJlY2F0ZWQod2luLmxvY2F0aW9uLmhyZWYpLm9yaWdpbjtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgTG9jYXRpb24tbGlrZSBvYmplY3QgZm9yIHRoZSBnaXZlbiBVUkwuIElmIGl0IGlzIHJlbGF0aXZlLFxuICogdGhlIFVSTCBnZXRzIHJlc29sdmVkLlxuICogQ29uc2lkZXIgdGhlIHJldHVybmVkIG9iamVjdCBpbW11dGFibGUuIFRoaXMgaXMgZW5mb3JjZWQgZHVyaW5nXG4gKiB0ZXN0aW5nIGJ5IGZyZWV6aW5nIHRoZSBvYmplY3QuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfbm9jYWNoZVxuICogQHJldHVybiB7IUxvY2F0aW9ufVxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VVcmxEZXByZWNhdGVkKHVybCwgb3B0X25vY2FjaGUpIHtcbiAgaWYgKCFhKSB7XG4gICAgYSA9IC8qKiBAdHlwZSB7IUhUTUxBbmNob3JFbGVtZW50fSAqLyAoc2VsZi5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJykpO1xuICAgIGNhY2hlID0gc2VsZi5VcmxDYWNoZSB8fCAoc2VsZi5VcmxDYWNoZSA9IG5ldyBMcnVDYWNoZSgxMDApKTtcbiAgfVxuXG4gIHJldHVybiBwYXJzZVVybFdpdGhBKGEsIHVybCwgb3B0X25vY2FjaGUgPyBudWxsIDogY2FjaGUpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBMb2NhdGlvbi1saWtlIG9iamVjdCBmb3IgdGhlIGdpdmVuIFVSTC4gSWYgaXQgaXMgcmVsYXRpdmUsXG4gKiB0aGUgVVJMIGdldHMgcmVzb2x2ZWQuXG4gKiBDb25zaWRlciB0aGUgcmV0dXJuZWQgb2JqZWN0IGltbXV0YWJsZS4gVGhpcyBpcyBlbmZvcmNlZCBkdXJpbmdcbiAqIHRlc3RpbmcgYnkgZnJlZXppbmcgdGhlIG9iamVjdC5cbiAqIEBwYXJhbSB7IUhUTUxBbmNob3JFbGVtZW50fSBhXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0ge0xydUNhY2hlPX0gb3B0X2NhY2hlXG4gKiBAcmV0dXJuIHshTG9jYXRpb259XG4gKiBAcmVzdHJpY3RlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VVcmxXaXRoQShhLCB1cmwsIG9wdF9jYWNoZSkge1xuICBpZiAob3B0X2NhY2hlICYmIG9wdF9jYWNoZS5oYXModXJsKSkge1xuICAgIHJldHVybiBvcHRfY2FjaGUuZ2V0KHVybCk7XG4gIH1cblxuICBhLmhyZWYgPSB1cmw7XG5cbiAgLy8gSUUxMSBkb2Vzbid0IHByb3ZpZGUgZnVsbCBVUkwgY29tcG9uZW50cyB3aGVuIHBhcnNpbmcgcmVsYXRpdmUgVVJMcy5cbiAgLy8gQXNzaWduaW5nIHRvIGl0c2VsZiBhZ2FpbiBkb2VzIHRoZSB0cmljayAjMzQ0OS5cbiAgaWYgKCFhLnByb3RvY29sKSB7XG4gICAgYS5ocmVmID0gYS5ocmVmO1xuICB9XG5cbiAgY29uc3QgaW5mbyA9IC8qKiBAdHlwZSB7IUxvY2F0aW9ufSAqLyh7XG4gICAgaHJlZjogYS5ocmVmLFxuICAgIHByb3RvY29sOiBhLnByb3RvY29sLFxuICAgIGhvc3Q6IGEuaG9zdCxcbiAgICBob3N0bmFtZTogYS5ob3N0bmFtZSxcbiAgICBwb3J0OiBhLnBvcnQgPT0gJzAnID8gJycgOiBhLnBvcnQsXG4gICAgcGF0aG5hbWU6IGEucGF0aG5hbWUsXG4gICAgc2VhcmNoOiBhLnNlYXJjaCxcbiAgICBoYXNoOiBhLmhhc2gsXG4gICAgb3JpZ2luOiBudWxsLCAvLyBTZXQgYmVsb3cuXG4gIH0pO1xuXG4gIC8vIFNvbWUgSUUxMSBzcGVjaWZpYyBwb2x5ZmlsbHMuXG4gIC8vIDEpIElFMTEgc3RyaXBzIG91dCB0aGUgbGVhZGluZyAnLycgaW4gdGhlIHBhdGhuYW1lLlxuICBpZiAoaW5mby5wYXRobmFtZVswXSAhPT0gJy8nKSB7XG4gICAgaW5mby5wYXRobmFtZSA9ICcvJyArIGluZm8ucGF0aG5hbWU7XG4gIH1cblxuICAvLyAyKSBGb3IgVVJMcyB3aXRoIGltcGxpY2l0IHBvcnRzLCBJRTExIHBhcnNlcyB0byBkZWZhdWx0IHBvcnRzIHdoaWxlXG4gIC8vIG90aGVyIGJyb3dzZXJzIGxlYXZlIHRoZSBwb3J0IGZpZWxkIGVtcHR5LlxuICBpZiAoKGluZm8ucHJvdG9jb2wgPT0gJ2h0dHA6JyAmJiBpbmZvLnBvcnQgPT0gODApXG4gICAgICB8fCAoaW5mby5wcm90b2NvbCA9PSAnaHR0cHM6JyAmJiBpbmZvLnBvcnQgPT0gNDQzKSkge1xuICAgIGluZm8ucG9ydCA9ICcnO1xuICAgIGluZm8uaG9zdCA9IGluZm8uaG9zdG5hbWU7XG4gIH1cblxuICAvLyBGb3IgZGF0YSBVUkkgYS5vcmlnaW4gaXMgZXF1YWwgdG8gdGhlIHN0cmluZyAnbnVsbCcgd2hpY2ggaXMgbm90IHVzZWZ1bC5cbiAgLy8gV2UgaW5zdGVhZCByZXR1cm4gdGhlIGFjdHVhbCBvcmlnaW4gd2hpY2ggaXMgdGhlIGZ1bGwgVVJMLlxuICBpZiAoYS5vcmlnaW4gJiYgYS5vcmlnaW4gIT0gJ251bGwnKSB7XG4gICAgaW5mby5vcmlnaW4gPSBhLm9yaWdpbjtcbiAgfSBlbHNlIGlmIChpbmZvLnByb3RvY29sID09ICdkYXRhOicgfHwgIWluZm8uaG9zdCkge1xuICAgIGluZm8ub3JpZ2luID0gaW5mby5ocmVmO1xuICB9IGVsc2Uge1xuICAgIGluZm8ub3JpZ2luID0gaW5mby5wcm90b2NvbCArICcvLycgKyBpbmZvLmhvc3Q7XG4gIH1cblxuICAvLyBGcmVlemUgZHVyaW5nIHRlc3RpbmcgdG8gYXZvaWQgYWNjaWRlbnRhbCBtdXRhdGlvbi5cbiAgY29uc3QgZnJvemVuID0gKGdldE1vZGUoKS50ZXN0ICYmIE9iamVjdC5mcmVlemUpID8gT2JqZWN0LmZyZWV6ZShpbmZvKSA6IGluZm87XG5cbiAgaWYgKG9wdF9jYWNoZSkge1xuICAgIG9wdF9jYWNoZS5wdXQodXJsLCBmcm96ZW4pO1xuICB9XG5cbiAgcmV0dXJuIGZyb3plbjtcbn1cblxuLyoqXG4gKiBBcHBlbmRzIHRoZSBzdHJpbmcganVzdCBiZWZvcmUgdGhlIGZyYWdtZW50IHBhcnQgKG9yIG9wdGlvbmFsbHlcbiAqIHRvIHRoZSBmcm9udCBvZiB0aGUgcXVlcnkgc3RyaW5nKSBvZiB0aGUgVVJMLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHBhcmFtIHtzdHJpbmd9IHBhcmFtU3RyaW5nXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfYWRkVG9Gcm9udFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXBwZW5kRW5jb2RlZFBhcmFtU3RyaW5nVG9VcmwodXJsLCBwYXJhbVN0cmluZyxcbiAgb3B0X2FkZFRvRnJvbnQpIHtcbiAgaWYgKCFwYXJhbVN0cmluZykge1xuICAgIHJldHVybiB1cmw7XG4gIH1cbiAgY29uc3QgbWFpbkFuZEZyYWdtZW50ID0gdXJsLnNwbGl0KCcjJywgMik7XG4gIGNvbnN0IG1haW5BbmRRdWVyeSA9IG1haW5BbmRGcmFnbWVudFswXS5zcGxpdCgnPycsIDIpO1xuXG4gIGxldCBuZXdVcmwgPSBtYWluQW5kUXVlcnlbMF0gKyAoXG4gICAgbWFpbkFuZFF1ZXJ5WzFdXG4gICAgICA/IChvcHRfYWRkVG9Gcm9udFxuICAgICAgICA/IGA/JHtwYXJhbVN0cmluZ30mJHttYWluQW5kUXVlcnlbMV19YFxuICAgICAgICA6IGA/JHttYWluQW5kUXVlcnlbMV19JiR7cGFyYW1TdHJpbmd9YClcbiAgICAgIDogYD8ke3BhcmFtU3RyaW5nfWApO1xuICBuZXdVcmwgKz0gbWFpbkFuZEZyYWdtZW50WzFdID8gYCMke21haW5BbmRGcmFnbWVudFsxXX1gIDogJyc7XG4gIHJldHVybiBuZXdVcmw7XG59XG4vKipcbiAqIEFwcGVuZHMgYSBxdWVyeSBzdHJpbmcgZmllbGQgYW5kIHZhbHVlIHRvIGEgdXJsLiBga2V5YCBhbmQgYHZhbHVlYFxuICogd2lsbCBiZSByYW4gdGhyb3VnaCBgZW5jb2RlVVJJQ29tcG9uZW50YCBiZWZvcmUgYXBwZW5kaW5nLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfYWRkVG9Gcm9udFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkUGFyYW1Ub1VybCh1cmwsIGtleSwgdmFsdWUsIG9wdF9hZGRUb0Zyb250KSB7XG4gIGNvbnN0IGZpZWxkID0gYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGtleSl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKX1gO1xuICByZXR1cm4gYXBwZW5kRW5jb2RlZFBhcmFtU3RyaW5nVG9VcmwodXJsLCBmaWVsZCwgb3B0X2FkZFRvRnJvbnQpO1xufVxuXG4vKipcbiAqIEFwcGVuZHMgcXVlcnkgc3RyaW5nIGZpZWxkcyBhbmQgdmFsdWVzIHRvIGEgdXJsLiBUaGUgYHBhcmFtc2Agb2JqZWN0cydcbiAqIGBrZXlgcyBhbmQgYHZhbHVlYHMgd2lsbCBiZSB0cmFuc2Zvcm1lZCBpbnRvIHF1ZXJ5IHN0cmluZyBrZXlzL3ZhbHVlcy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7IUpzb25PYmplY3Q8c3RyaW5nLCBzdHJpbmd8IUFycmF5PHN0cmluZz4+fSBwYXJhbXNcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZFBhcmFtc1RvVXJsKHVybCwgcGFyYW1zKSB7XG4gIHJldHVybiBhcHBlbmRFbmNvZGVkUGFyYW1TdHJpbmdUb1VybCh1cmwsIHNlcmlhbGl6ZVF1ZXJ5U3RyaW5nKHBhcmFtcykpO1xufVxuXG4vKipcbiAqIFNlcmlhbGl6ZXMgdGhlIHBhc3NlZCBwYXJhbWV0ZXIgbWFwIGludG8gYSBxdWVyeSBzdHJpbmcgd2l0aCBib3RoIGtleXNcbiAqIGFuZCB2YWx1ZXMgZW5jb2RlZC5cbiAqIEBwYXJhbSB7IUpzb25PYmplY3Q8c3RyaW5nLCBzdHJpbmd8IUFycmF5PHN0cmluZz4+fSBwYXJhbXNcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNlcmlhbGl6ZVF1ZXJ5U3RyaW5nKHBhcmFtcykge1xuICBjb25zdCBzID0gW107XG4gIGZvciAoY29uc3QgayBpbiBwYXJhbXMpIHtcbiAgICBjb25zdCB2ID0gcGFyYW1zW2tdO1xuICAgIGlmICh2ID09IG51bGwpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH0gZWxzZSBpZiAoaXNBcnJheSh2KSkge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHN2ID0gLyoqIEB0eXBlIHtzdHJpbmd9ICovICh2W2ldKTtcbiAgICAgICAgcy5wdXNoKGAke2VuY29kZVVSSUNvbXBvbmVudChrKX09JHtlbmNvZGVVUklDb21wb25lbnQoc3YpfWApO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBzdiA9IC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAodik7XG4gICAgICBzLnB1c2goYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGspfT0ke2VuY29kZVVSSUNvbXBvbmVudChzdil9YCk7XG4gICAgfVxuICB9XG4gIHJldHVybiBzLmpvaW4oJyYnKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgVVJMIGlzIHNlY3VyZTogZWl0aGVyIEhUVFBTIG9yIGxvY2FsaG9zdCAoZm9yIHRlc3RpbmcpLlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmxcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1NlY3VyZVVybERlcHJlY2F0ZWQodXJsKSB7XG4gIGlmICh0eXBlb2YgdXJsID09ICdzdHJpbmcnKSB7XG4gICAgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIH1cbiAgcmV0dXJuICh1cmwucHJvdG9jb2wgPT0gJ2h0dHBzOicgfHxcbiAgICAgIHVybC5ob3N0bmFtZSA9PSAnbG9jYWxob3N0JyB8fFxuICAgICAgZW5kc1dpdGgodXJsLmhvc3RuYW1lLCAnLmxvY2FsaG9zdCcpKTtcbn1cblxuLyoqXG4gKiBBc3NlcnRzIHRoYXQgYSBnaXZlbiB1cmwgaXMgSFRUUFMgb3IgcHJvdG9jb2wgcmVsYXRpdmUuIEl0J3MgYSB1c2VyLWxldmVsXG4gKiBhc3NlcnQuXG4gKlxuICogUHJvdmlkZXMgYW4gZXhjZXB0aW9uIGZvciBsb2NhbGhvc3QuXG4gKlxuICogQHBhcmFtIHs/c3RyaW5nfHVuZGVmaW5lZH0gdXJsU3RyaW5nXG4gKiBAcGFyYW0geyFFbGVtZW50fHN0cmluZ30gZWxlbWVudENvbnRleHQgRWxlbWVudCB3aGVyZSB0aGUgdXJsIHdhcyBmb3VuZC5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gc291cmNlTmFtZSBVc2VkIGZvciBlcnJvciBtZXNzYWdlcy5cbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydEh0dHBzVXJsKFxuICB1cmxTdHJpbmcsIGVsZW1lbnRDb250ZXh0LCBzb3VyY2VOYW1lID0gJ3NvdXJjZScpIHtcbiAgdXNlcigpLmFzc2VydCh1cmxTdHJpbmcgIT0gbnVsbCwgJyVzICVzIG11c3QgYmUgYXZhaWxhYmxlJyxcbiAgICAgIGVsZW1lbnRDb250ZXh0LCBzb3VyY2VOYW1lKTtcbiAgLy8gKGVyd2lubSwgIzQ1NjApOiB0eXBlIGNhc3QgbmVjZXNzYXJ5IHVudGlsICM0NTYwIGlzIGZpeGVkLlxuICBjb25zdCB0aGVVcmxTdHJpbmcgPSAvKiogQHR5cGUge3N0cmluZ30gKi8gKHVybFN0cmluZyk7XG4gIHVzZXIoKS5hc3NlcnQoaXNTZWN1cmVVcmxEZXByZWNhdGVkKHRoZVVybFN0cmluZykgfHwgL14oXFwvXFwvKS8udGVzdCh0aGVVcmxTdHJpbmcpLFxuICAgICAgJyVzICVzIG11c3Qgc3RhcnQgd2l0aCAnICtcbiAgICAgICdcImh0dHBzOi8vXCIgb3IgXCIvL1wiIG9yIGJlIHJlbGF0aXZlIGFuZCBzZXJ2ZWQgZnJvbSAnICtcbiAgICAgICdlaXRoZXIgaHR0cHMgb3IgZnJvbSBsb2NhbGhvc3QuIEludmFsaWQgdmFsdWU6ICVzJyxcbiAgICAgIGVsZW1lbnRDb250ZXh0LCBzb3VyY2VOYW1lLCB0aGVVcmxTdHJpbmcpO1xuICByZXR1cm4gdGhlVXJsU3RyaW5nO1xufVxuXG4vKipcbiAqIEFzc2VydHMgdGhhdCBhIGdpdmVuIHVybCBpcyBhbiBhYnNvbHV0ZSBIVFRQIG9yIEhUVFBTIFVSTC5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxTdHJpbmdcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydEFic29sdXRlSHR0cE9ySHR0cHNVcmwodXJsU3RyaW5nKSB7XG4gIHVzZXIoKS5hc3NlcnQoL15odHRwcz9cXDovaS50ZXN0KHVybFN0cmluZyksXG4gICAgICAnVVJMIG11c3Qgc3RhcnQgd2l0aCBcImh0dHA6Ly9cIiBvciBcImh0dHBzOi8vXCIuIEludmFsaWQgdmFsdWU6ICVzJyxcbiAgICAgIHVybFN0cmluZyk7XG4gIHJldHVybiBwYXJzZVVybERlcHJlY2F0ZWQodXJsU3RyaW5nKS5ocmVmO1xufVxuXG5cbi8qKlxuICogUGFyc2VzIHRoZSBxdWVyeSBzdHJpbmcgb2YgYW4gVVJMLiBUaGlzIG1ldGhvZCByZXR1cm5zIGEgc2ltcGxlIGtleS92YWx1ZVxuICogbWFwLiBJZiB0aGVyZSBhcmUgZHVwbGljYXRlIGtleXMgdGhlIGxhdGVzdCB2YWx1ZSBpcyByZXR1cm5lZC5cbiAqXG4gKiBUaGlzIGZ1bmN0aW9uIGlzIGltcGxlbWVudGVkIGluIGEgc2VwYXJhdGUgZmlsZSB0byBhdm9pZCBhIGNpcmN1bGFyXG4gKiBkZXBlbmRlbmN5LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBxdWVyeVN0cmluZ1xuICogQHJldHVybiB7IUpzb25PYmplY3R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVF1ZXJ5U3RyaW5nKHF1ZXJ5U3RyaW5nKSB7XG4gIHJldHVybiBwYXJzZVF1ZXJ5U3RyaW5nXyhxdWVyeVN0cmluZyk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgVVJMIHdpdGhvdXQgZnJhZ21lbnQuIElmIFVSTCBkb2Vzbid0IGNvbnRhaW4gZnJhZ21lbnQsIHRoZSBzYW1lXG4gKiBzdHJpbmcgaXMgcmV0dXJuZWQuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVGcmFnbWVudCh1cmwpIHtcbiAgY29uc3QgaW5kZXggPSB1cmwuaW5kZXhPZignIycpO1xuICBpZiAoaW5kZXggPT0gLTEpIHtcbiAgICByZXR1cm4gdXJsO1xuICB9XG4gIHJldHVybiB1cmwuc3Vic3RyaW5nKDAsIGluZGV4KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBmcmFnbWVudCBmcm9tIHRoZSBVUkwuIElmIHRoZSBVUkwgZG9lc24ndCBjb250YWluIGZyYWdtZW50LFxuICogdGhlIGVtcHR5IHN0cmluZyBpcyByZXR1cm5lZC5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEZyYWdtZW50KHVybCkge1xuICBjb25zdCBpbmRleCA9IHVybC5pbmRleE9mKCcjJyk7XG4gIGlmIChpbmRleCA9PSAtMSkge1xuICAgIHJldHVybiAnJztcbiAgfVxuICByZXR1cm4gdXJsLnN1YnN0cmluZyhpbmRleCk7XG59XG5cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBVUkwgaGFzIHRoZSBvcmlnaW4gb2YgYSBwcm94eS5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsIFVSTCBvZiBhbiBBTVAgZG9jdW1lbnQuXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNQcm94eU9yaWdpbih1cmwpIHtcbiAgaWYgKHR5cGVvZiB1cmwgPT0gJ3N0cmluZycpIHtcbiAgICB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgfVxuICByZXR1cm4gdXJscy5jZG5Qcm94eVJlZ2V4LnRlc3QodXJsLm9yaWdpbik7XG59XG5cbi8qKlxuICogRm9yIHByb3h5LW9yaWdpbiBVUkxzLCByZXR1cm5zIHRoZSBzZXJ2aW5nIHR5cGUuIE90aGVyd2lzZSwgcmV0dXJucyBudWxsLlxuICogRS5nLiwgJ2h0dHBzOi8vYW1wLWNvbS5jZG4uYW1wcHJvamVjdC5vcmcvYS9zL2FtcC5jb20vYW1wX2RvY3VtZW50Lmh0bWwnXG4gKiByZXR1cm5zICdhJy5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsIFVSTCBvZiBhbiBBTVAgZG9jdW1lbnQuXG4gKiBAcmV0dXJuIHs/c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJveHlTZXJ2aW5nVHlwZSh1cmwpIHtcbiAgaWYgKHR5cGVvZiB1cmwgPT0gJ3N0cmluZycpIHtcbiAgICB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgfVxuICBpZiAoIWlzUHJveHlPcmlnaW4odXJsKSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IHBhdGggPSB1cmwucGF0aG5hbWUuc3BsaXQoJy8nLCAyKTtcbiAgcmV0dXJuIHBhdGhbMV07XG59XG5cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBVUkwgb3JpZ2luIGlzIGxvY2FsaG9zdC5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsIFVSTCBvZiBhbiBBTVAgZG9jdW1lbnQuXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNMb2NhbGhvc3RPcmlnaW4odXJsKSB7XG4gIGlmICh0eXBlb2YgdXJsID09ICdzdHJpbmcnKSB7XG4gICAgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIH1cbiAgcmV0dXJuIHVybHMubG9jYWxob3N0UmVnZXgudGVzdCh1cmwub3JpZ2luKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgdGhlIFVSTCBoYXMgdmFsaWQgcHJvdG9jb2wuXG4gKiBEZWVwIGxpbmsgcHJvdG9jb2wgaXMgdmFsaWQsIGJ1dCBub3QgamF2YXNjcmlwdCBldGMuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzUHJvdG9jb2xWYWxpZCh1cmwpIHtcbiAgaWYgKCF1cmwpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAodHlwZW9mIHVybCA9PSAnc3RyaW5nJykge1xuICAgIHVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICB9XG4gIHJldHVybiAhSU5WQUxJRF9QUk9UT0NPTFMuaW5jbHVkZXModXJsLnByb3RvY29sKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgVVJMIHdpdGhvdXQgQU1QIEpTIHBhcmFtZXRlcnMuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVBbXBKc1BhcmFtc0Zyb21VcmwodXJsKSB7XG4gIGNvbnN0IHBhcnNlZCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICBjb25zdCBzZWFyY2ggPSByZW1vdmVBbXBKc1BhcmFtc0Zyb21TZWFyY2gocGFyc2VkLnNlYXJjaCk7XG4gIHJldHVybiBwYXJzZWQub3JpZ2luICsgcGFyc2VkLnBhdGhuYW1lICsgc2VhcmNoICsgcGFyc2VkLmhhc2g7XG5cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgVVJMIHdpdGhvdXQgYSBxdWVyeSBzdHJpbmcuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVTZWFyY2godXJsKSB7XG4gIGNvbnN0IGluZGV4ID0gdXJsLmluZGV4T2YoJz8nKTtcbiAgaWYgKGluZGV4ID09IC0xKSB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxuICBjb25zdCBmcmFnbWVudCA9IGdldEZyYWdtZW50KHVybCk7XG4gIHJldHVybiB1cmwuc3Vic3RyaW5nKDAsIGluZGV4KSArIGZyYWdtZW50O1xufVxuXG4vKipcbiAqIFJlbW92ZXMgcGFyYW1ldGVycyB0aGF0IHN0YXJ0IHdpdGggYW1wIGpzIHBhcmFtZXRlciBwYXR0ZXJuIGFuZCByZXR1cm5zIHRoZVxuICogbmV3IHNlYXJjaCBzdHJpbmcuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsU2VhcmNoXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHJlbW92ZUFtcEpzUGFyYW1zRnJvbVNlYXJjaCh1cmxTZWFyY2gpIHtcbiAgaWYgKCF1cmxTZWFyY2ggfHwgdXJsU2VhcmNoID09ICc/Jykge1xuICAgIHJldHVybiAnJztcbiAgfVxuICBjb25zdCBzZWFyY2ggPSB1cmxTZWFyY2hcbiAgICAgIC5yZXBsYWNlKEFNUF9KU19QQVJBTVNfUkVHRVgsICcnKVxuICAgICAgLnJlcGxhY2UoQU1QX0dTQV9QQVJBTVNfUkVHRVgsICcnKVxuICAgICAgLnJlcGxhY2UoQU1QX1JfUEFSQU1TX1JFR0VYLCAnJylcbiAgICAgIC5yZXBsYWNlKEdPT0dMRV9FWFBFUklNRU5UX1BBUkFNU19SRUdFWCwgJycpXG4gICAgICAucmVwbGFjZSgvXls/Jl0vLCAnJyk7IC8vIFJlbW92ZXMgZmlyc3QgPyBvciAmLlxuICByZXR1cm4gc2VhcmNoID8gJz8nICsgc2VhcmNoIDogJyc7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgc291cmNlIFVSTCBvZiBhbiBBTVAgZG9jdW1lbnQgZm9yIGRvY3VtZW50cyBzZXJ2ZWRcbiAqIG9uIGEgcHJveHkgb3JpZ2luIG9yIGRpcmVjdGx5LlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmwgVVJMIG9mIGFuIEFNUCBkb2N1bWVudC5cbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNvdXJjZVVybCh1cmwpIHtcbiAgaWYgKHR5cGVvZiB1cmwgPT0gJ3N0cmluZycpIHtcbiAgICB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgfVxuXG4gIC8vIE5vdCBhIHByb3h5IFVSTCAtIHJldHVybiB0aGUgVVJMIGl0c2VsZi5cbiAgaWYgKCFpc1Byb3h5T3JpZ2luKHVybCkpIHtcbiAgICByZXR1cm4gdXJsLmhyZWY7XG4gIH1cblxuICAvLyBBIHByb3h5IFVSTC5cbiAgLy8gRXhhbXBsZSBwYXRoIHRoYXQgaXMgYmVpbmcgbWF0Y2hlZCBoZXJlLlxuICAvLyBodHRwczovL2Nkbi5hbXBwcm9qZWN0Lm9yZy9jL3Mvd3d3Lm9yaWdpbi5jb20vZm9vL1xuICAvLyBUaGUgL3MvIGlzIG9wdGlvbmFsIGFuZCBzaWduYWxzIGEgc2VjdXJlIG9yaWdpbi5cbiAgY29uc3QgcGF0aCA9IHVybC5wYXRobmFtZS5zcGxpdCgnLycpO1xuICBjb25zdCBwcmVmaXggPSBwYXRoWzFdO1xuICB1c2VyKCkuYXNzZXJ0KFNFUlZJTkdfVFlQRV9QUkVGSVhbcHJlZml4XSxcbiAgICAgICdVbmtub3duIHBhdGggcHJlZml4IGluIHVybCAlcycsIHVybC5ocmVmKTtcbiAgY29uc3QgZG9tYWluT3JIdHRwc1NpZ25hbCA9IHBhdGhbMl07XG4gIGNvbnN0IG9yaWdpbiA9IGRvbWFpbk9ySHR0cHNTaWduYWwgPT0gJ3MnXG4gICAgPyAnaHR0cHM6Ly8nICsgZGVjb2RlVVJJQ29tcG9uZW50KHBhdGhbM10pXG4gICAgOiAnaHR0cDovLycgKyBkZWNvZGVVUklDb21wb25lbnQoZG9tYWluT3JIdHRwc1NpZ25hbCk7XG4gIC8vIFNhbml0eSB0ZXN0IHRoYXQgd2hhdCB3ZSBmb3VuZCBsb29rcyBsaWtlIGEgZG9tYWluLlxuICB1c2VyKCkuYXNzZXJ0KG9yaWdpbi5pbmRleE9mKCcuJykgPiAwLCAnRXhwZWN0ZWQgYSAuIGluIG9yaWdpbiAlcycsIG9yaWdpbik7XG4gIHBhdGguc3BsaWNlKDEsIGRvbWFpbk9ySHR0cHNTaWduYWwgPT0gJ3MnID8gMyA6IDIpO1xuICByZXR1cm4gb3JpZ2luICsgcGF0aC5qb2luKCcvJykgK1xuICAgICAgcmVtb3ZlQW1wSnNQYXJhbXNGcm9tU2VhcmNoKHVybC5zZWFyY2gpICsgKHVybC5oYXNoIHx8ICcnKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBzb3VyY2Ugb3JpZ2luIG9mIGFuIEFNUCBkb2N1bWVudCBmb3IgZG9jdW1lbnRzIHNlcnZlZFxuICogb24gYSBwcm94eSBvcmlnaW4gb3IgZGlyZWN0bHkuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybCBVUkwgb2YgYW4gQU1QIGRvY3VtZW50LlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgc291cmNlIG9yaWdpbiBvZiB0aGUgVVJMLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U291cmNlT3JpZ2luKHVybCkge1xuICByZXR1cm4gcGFyc2VVcmxEZXByZWNhdGVkKGdldFNvdXJjZVVybCh1cmwpKS5vcmlnaW47XG59XG5cbi8qKlxuICogUmV0dXJucyBhYnNvbHV0ZSBVUkwgcmVzb2x2ZWQgYmFzZWQgb24gdGhlIHJlbGF0aXZlIFVSTCBhbmQgdGhlIGJhc2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVsYXRpdmVVcmxTdHJpbmdcbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gYmFzZVVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZVJlbGF0aXZlVXJsKHJlbGF0aXZlVXJsU3RyaW5nLCBiYXNlVXJsKSB7XG4gIGlmICh0eXBlb2YgYmFzZVVybCA9PSAnc3RyaW5nJykge1xuICAgIGJhc2VVcmwgPSBwYXJzZVVybERlcHJlY2F0ZWQoYmFzZVVybCk7XG4gIH1cbiAgaWYgKHR5cGVvZiBVUkwgPT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBuZXcgVVJMKHJlbGF0aXZlVXJsU3RyaW5nLCBiYXNlVXJsLmhyZWYpLnRvU3RyaW5nKCk7XG4gIH1cbiAgcmV0dXJuIHJlc29sdmVSZWxhdGl2ZVVybEZhbGxiYWNrXyhyZWxhdGl2ZVVybFN0cmluZywgYmFzZVVybCk7XG59XG5cbi8qKlxuICogRmFsbGJhY2sgZm9yIFVSTCByZXNvbHZlciB3aGVuIFVSTCBjbGFzcyBpcyBub3QgYXZhaWxhYmxlLlxuICogQHBhcmFtIHtzdHJpbmd9IHJlbGF0aXZlVXJsU3RyaW5nXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IGJhc2VVcmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqIEBwcml2YXRlIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNvbHZlUmVsYXRpdmVVcmxGYWxsYmFja18ocmVsYXRpdmVVcmxTdHJpbmcsIGJhc2VVcmwpIHtcbiAgaWYgKHR5cGVvZiBiYXNlVXJsID09ICdzdHJpbmcnKSB7XG4gICAgYmFzZVVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZChiYXNlVXJsKTtcbiAgfVxuICByZWxhdGl2ZVVybFN0cmluZyA9IHJlbGF0aXZlVXJsU3RyaW5nLnJlcGxhY2UoL1xcXFwvZywgJy8nKTtcbiAgY29uc3QgcmVsYXRpdmVVcmwgPSBwYXJzZVVybERlcHJlY2F0ZWQocmVsYXRpdmVVcmxTdHJpbmcpO1xuXG4gIC8vIEFic29sdXRlIFVSTC5cbiAgaWYgKHN0YXJ0c1dpdGgocmVsYXRpdmVVcmxTdHJpbmcudG9Mb3dlckNhc2UoKSwgcmVsYXRpdmVVcmwucHJvdG9jb2wpKSB7XG4gICAgcmV0dXJuIHJlbGF0aXZlVXJsLmhyZWY7XG4gIH1cblxuICAvLyBQcm90b2NvbC1yZWxhdGl2ZSBVUkwuXG4gIGlmIChzdGFydHNXaXRoKHJlbGF0aXZlVXJsU3RyaW5nLCAnLy8nKSkge1xuICAgIHJldHVybiBiYXNlVXJsLnByb3RvY29sICsgcmVsYXRpdmVVcmxTdHJpbmc7XG4gIH1cblxuICAvLyBBYnNvbHV0ZSBwYXRoLlxuICBpZiAoc3RhcnRzV2l0aChyZWxhdGl2ZVVybFN0cmluZywgJy8nKSkge1xuICAgIHJldHVybiBiYXNlVXJsLm9yaWdpbiArIHJlbGF0aXZlVXJsU3RyaW5nO1xuICB9XG5cbiAgLy8gUmVsYXRpdmUgcGF0aC5cbiAgcmV0dXJuIGJhc2VVcmwub3JpZ2luICsgYmFzZVVybC5wYXRobmFtZS5yZXBsYWNlKC9cXC9bXi9dKiQvLCAnLycpXG4gICAgICArIHJlbGF0aXZlVXJsU3RyaW5nO1xufVxuXG5cbi8qKlxuICogQWRkIFwiX19hbXBfc291cmNlX29yaWdpblwiIHF1ZXJ5IHBhcmFtZXRlciB0byB0aGUgVVJMLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvcnNVcmwod2luLCB1cmwpIHtcbiAgY2hlY2tDb3JzVXJsKHVybCk7XG4gIGNvbnN0IHNvdXJjZU9yaWdpbiA9IGdldFNvdXJjZU9yaWdpbih3aW4ubG9jYXRpb24uaHJlZik7XG4gIHJldHVybiBhZGRQYXJhbVRvVXJsKHVybCwgU09VUkNFX09SSUdJTl9QQVJBTSwgc291cmNlT3JpZ2luKTtcbn1cblxuXG4vKipcbiAqIENoZWNrcyBpZiB0aGUgdXJsIGhhcyBfX2FtcF9zb3VyY2Vfb3JpZ2luIGFuZCB0aHJvd3MgaWYgaXQgZG9lcy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrQ29yc1VybCh1cmwpIHtcbiAgY29uc3QgcGFyc2VkVXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIGNvbnN0IHF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyhwYXJzZWRVcmwuc2VhcmNoKTtcbiAgdXNlcigpLmFzc2VydCghKFNPVVJDRV9PUklHSU5fUEFSQU0gaW4gcXVlcnkpLFxuICAgICAgJ1NvdXJjZSBvcmlnaW4gaXMgbm90IGFsbG93ZWQgaW4gJXMnLCB1cmwpO1xufVxuXG4vKipcbiAqIFRyaWVzIHRvIGRlY29kZSBhIFVSSSBjb21wb25lbnQsIGZhbGxpbmcgYmFjayB0byBvcHRfZmFsbGJhY2sgKG9yIGFuIGVtcHR5XG4gKiBzdHJpbmcpXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGNvbXBvbmVudFxuICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfZmFsbGJhY2tcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyeURlY29kZVVyaUNvbXBvbmVudChjb21wb25lbnQsIG9wdF9mYWxsYmFjaykge1xuICByZXR1cm4gdHJ5RGVjb2RlVXJpQ29tcG9uZW50Xyhjb21wb25lbnQsIG9wdF9mYWxsYmFjayk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG4vKipcbiAqIENvbXBhcmVzIGlmIHR3byBhcnJheXMgY29udGFpbnMgZXhhY3RseSBzYW1lIGVsZW1lbnRzIG9mIHNhbWUgbnVtYmVyXG4gKiBvZiBzYW1lIG9yZGVyLlxuICogTm90aWNlIHRoYXQgaXQgZG9lcyBOT1QgaGFuZGxlIE5hTiBjYXNlIGFzIGV4cGVjdGVkXG4gKlxuICogQHBhcmFtIHshQXJyYXk8VD59IGFycjFcbiAqIEBwYXJhbSB7IUFycmF5PFQ+fSBhcnIyXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFyZUVxdWFsT3JkZXJlZChhcnIxLCBhcnIyKSB7XG4gIGlmIChhcnIxLmxlbmd0aCAhPT0gYXJyMi5sZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGFycjEubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoYXJyMVtpXSAhPT0gYXJyMltpXSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIEEgYml0IGxpa2UgQXJyYXkjZmlsdGVyLCBidXQgcmVtb3ZlcyBlbGVtZW50cyB0aGF0IGZpbHRlciBmYWxzZSBmcm9tIHRoZVxuICogYXJyYXkuIFJldHVybnMgdGhlIGZpbHRlcmVkIGl0ZW1zLlxuICpcbiAqIEBwYXJhbSB7IUFycmF5PFQ+fSBhcnJheVxuICogQHBhcmFtIHtmdW5jdGlvbihULCBudW1iZXIsICFBcnJheTxUPik6Ym9vbGVhbn0gZmlsdGVyXG4gKiBAcmV0dXJuIHshQXJyYXk8VD59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyU3BsaWNlKGFycmF5LCBmaWx0ZXIpIHtcbiAgY29uc3Qgc3BsaWNlID0gW107XG4gIGxldCBpbmRleCA9IDA7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBpdGVtID0gYXJyYXlbaV07XG4gICAgaWYgKGZpbHRlcihpdGVtLCBpLCBhcnJheSkpIHtcbiAgICAgIGlmIChpbmRleCA8IGkpIHtcbiAgICAgICAgYXJyYXlbaW5kZXhdID0gaXRlbTtcbiAgICAgIH1cbiAgICAgIGluZGV4Kys7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNwbGljZS5wdXNoKGl0ZW0pO1xuICAgIH1cbiAgfVxuXG4gIGlmIChpbmRleCA8IGFycmF5Lmxlbmd0aCkge1xuICAgIGFycmF5Lmxlbmd0aCA9IGluZGV4O1xuICB9XG5cbiAgcmV0dXJuIHNwbGljZTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgZmlyc3QgZWxlbWVudCBtYXRjaGluZyB0aGUgcHJlZGljYXRlLlxuICogTGlrZSBBcnJheSNmaW5kSW5kZXguXG4gKlxuICogQHBhcmFtIHshQXJyYXk8VD59IGFycmF5XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKFQsIG51bWJlciwgIUFycmF5PFQ+KTpib29sZWFufSBwcmVkaWNhdGVcbiAqIEByZXR1cm4ge251bWJlcn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmaW5kSW5kZXgoYXJyYXksIHByZWRpY2F0ZSkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKHByZWRpY2F0ZShhcnJheVtpXSwgaSwgYXJyYXkpKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIC0xO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIHRoZSBnaXZlbiBpdGVyYXRvciB0byBhbiBhcnJheS5cbiAqXG4gKiBAcGFyYW0geyFJdGVyYXRvcjxUPn0gaXRlcmF0b3JcbiAqIEByZXR1cm4ge0FycmF5PFQ+fVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21JdGVyYXRvcihpdGVyYXRvcikge1xuICBjb25zdCBhcnJheSA9IFtdO1xuICBmb3IgKGxldCBlID0gaXRlcmF0b3IubmV4dCgpOyAhZS5kb25lOyBlID0gaXRlcmF0b3IubmV4dCgpKSB7XG4gICAgYXJyYXkucHVzaChlLnZhbHVlKTtcbiAgfVxuICByZXR1cm4gYXJyYXk7XG59XG5cbi8qKlxuICogQWRkcyBpdGVtIHRvIGFycmF5IGlmIGl0IGlzIG5vdCBhbHJlYWR5IHByZXNlbnQuXG4gKlxuICogQHBhcmFtIHtBcnJheTxUPn0gYXJyYXlcbiAqIEBwYXJhbSB7VH0gaXRlbVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHB1c2hJZk5vdEV4aXN0KGFycmF5LCBpdGVtKSB7XG4gIGlmIChhcnJheS5pbmRleE9mKGl0ZW0pIDwgMCkge1xuICAgIGFycmF5LnB1c2goaXRlbSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vLyBUT0RPKHJzaW1oYSwgIzE1MzM0KTogRW5hYmxlIHRoaXMgcnVsZS5cbi8qIGVzbGludCBqc2RvYy9jaGVjay10eXBlczogMCAqL1xuXG4vKipcbiAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IGlzIGV2YWx1YXRlZCBvbmx5IG9uY2UgYW5kIHJldHVybnMgdGhlIGNhY2hlZCByZXN1bHRcbiAqIHN1YnNlcXVlbnRseS5cbiAqXG4gKiBQbGVhc2Ugbm90ZSB0aGF0IGBvbmNlYCBvbmx5IHRha2VzIHRoZSBmdW5jdGlvbiBkZWZpbml0aW9uIGludG8gYWNjb3VudCxcbiAqIHNvIGl0IHdpbGwgcmV0dXJuIHRoZSBzYW1lIGNhY2hlZCB2YWx1ZSBldmVuIHdoZW4gdGhlIGFyZ3VtZW50cyBhcmVcbiAqIGRpZmZlcmVudC5cbiAqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKC4uLik6VH0gZm5cbiAqIEByZXR1cm4ge2Z1bmN0aW9uKC4uLik6VH1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvbmNlKGZuKSB7XG4gIGxldCBldmFsdWF0ZWQgPSBmYWxzZTtcbiAgbGV0IHJldFZhbHVlID0gbnVsbDtcbiAgbGV0IGNhbGxiYWNrID0gZm47XG4gIHJldHVybiAoLi4uYXJncykgPT4ge1xuICAgIGlmICghZXZhbHVhdGVkKSB7XG4gICAgICByZXRWYWx1ZSA9IGNhbGxiYWNrLmFwcGx5KHNlbGYsIGFyZ3MpO1xuICAgICAgZXZhbHVhdGVkID0gdHJ1ZTtcbiAgICAgIGNhbGxiYWNrID0gbnVsbDsgLy8gR0NcbiAgICB9XG4gICAgcmV0dXJuIHJldFZhbHVlO1xuICB9O1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7ZGV2fSBmcm9tICcuLi9sb2cnO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5jb25zdCBUQUcgPSAnbHJ1LWNhY2hlJztcblxuLyoqXG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgY2xhc3MgTHJ1Q2FjaGUge1xuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IGNhcGFjaXR5XG4gICAqL1xuICBjb25zdHJ1Y3RvcihjYXBhY2l0eSkge1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge251bWJlcn0gKi9cbiAgICB0aGlzLmNhcGFjaXR5XyA9IGNhcGFjaXR5O1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5zaXplXyA9IDA7XG5cbiAgICAvKipcbiAgICAgKiBBbiBpbmNyZW1lbnRpbmcgY291bnRlciB0byBkZWZpbmUgdGhlIGxhc3QgYWNjZXNzLlxuICAgICAqIEBwcml2YXRlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy5hY2Nlc3NfID0gMDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IU9iamVjdDwobnVtYmVyfHN0cmluZyksIHtwYXlsb2FkOiBULCBhY2Nlc3M6IG51bWJlcn0+fSAqL1xuICAgIHRoaXMuY2FjaGVfID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHdoZXRoZXIga2V5IGlzIGNhY2hlZC5cbiAgICpcbiAgICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSBrZXlcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGhhcyhrZXkpIHtcbiAgICByZXR1cm4gISF0aGlzLmNhY2hlX1trZXldO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30ga2V5XG4gICAqIEByZXR1cm4ge1R9IFRoZSBjYWNoZWQgcGF5bG9hZC5cbiAgICovXG4gIGdldChrZXkpIHtcbiAgICBjb25zdCBjYWNoZWFibGUgPSB0aGlzLmNhY2hlX1trZXldO1xuICAgIGlmIChjYWNoZWFibGUpIHtcbiAgICAgIGNhY2hlYWJsZS5hY2Nlc3MgPSArK3RoaXMuYWNjZXNzXztcbiAgICAgIHJldHVybiBjYWNoZWFibGUucGF5bG9hZDtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IGtleVxuICAgKiBAcGFyYW0ge1R9IHBheWxvYWQgVGhlIHBheWxvYWQgdG8gY2FjaGUuXG4gICAqL1xuICBwdXQoa2V5LCBwYXlsb2FkKSB7XG4gICAgaWYgKCF0aGlzLmhhcyhrZXkpKSB7XG4gICAgICB0aGlzLnNpemVfKys7XG4gICAgfVxuICAgIHRoaXMuY2FjaGVfW2tleV0gPSB7cGF5bG9hZCwgYWNjZXNzOiB0aGlzLmFjY2Vzc199O1xuICAgIHRoaXMuZXZpY3RfKCk7XG4gIH1cblxuICAvKipcbiAgICogRXZpY3RzIHRoZSBvbGRlc3QgY2FjaGUgZW50cnksIGlmIHdlJ3ZlIGV4Y2VlZGVkIGNhcGFjaXR5LlxuICAgKi9cbiAgZXZpY3RfKCkge1xuICAgIGlmICh0aGlzLnNpemVfIDw9IHRoaXMuY2FwYWNpdHlfKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZGV2KCkud2FybihUQUcsICdUcmltbWluZyBMUlUgY2FjaGUnKTtcbiAgICBjb25zdCBjYWNoZSA9IHRoaXMuY2FjaGVfO1xuICAgIGxldCBvbGRlc3QgPSB0aGlzLmFjY2Vzc18gKyAxO1xuICAgIGxldCBvbGRlc3RLZXk7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gY2FjaGUpIHtcbiAgICAgIGNvbnN0IHthY2Nlc3N9ID0gY2FjaGVba2V5XTtcbiAgICAgIGlmIChhY2Nlc3MgPCBvbGRlc3QpIHtcbiAgICAgICAgb2xkZXN0ID0gYWNjZXNzO1xuICAgICAgICBvbGRlc3RLZXkgPSBrZXk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9sZGVzdEtleSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBkZWxldGUgY2FjaGVbb2xkZXN0S2V5XTtcbiAgICAgIHRoaXMuc2l6ZV8tLTtcbiAgICB9XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIE1hcHMgYSB2YWx1ZSBpbiBhIGZpcnN0IHJhbmdlIHRvIGl0cyBlcXVpdmFsZW50IGluIGEgc2Vjb25kIHJhbmdlXG4gKiBFeC46IDUgaW4gdGhlIHJhbmdlIFswLDEwXSBnaXZlcyA2MCBpbiB0aGUgcmFuZ2VbNDAsODBdXG4gKlxuICogTk9URTogbG93ZXIvdXBwZXIgYm91bmRzIG9uIHRoZSBzb3VyY2UgcmFuZ2UgYXJlIGRldGVjdGVkIGF1dG9tYXRpY2FsbHksXG4gKiBob3dldmVyIHRoZSBib3VuZHMgb24gdGhlIHRhcmdldCByYW5nZSBhcmUgbm90IGFsdGVyZWQgKHRodXMgdGhlIHRhcmdldFxuICogcmFuZ2UgY291bGQgYmUgZGVjcmVhc2luZykuXG4gKiBFeDE6IDggaW4gdGhlIHJhbmdlIFswLCAxMF0gZ2l2ZXMgMiBpbiB0aGUgcmFuZ2UgWzEwLCAwXVxuICogRXgyOiBhbHNvLCA4IGluIHRoZSByYW5nZSBbMTAsIDBdIGdpdmVzIDIgaW4gdGhlIHJhbmdlIFsxMCwgMF1cbiAqXG4gKiBOT1RFOiBJbnB1dCB2YWx1ZSBpcyBlbmZvcmNlZCB0byBiZSBib3VuZGVkIGluc2lkZSB0aGUgc291cmNlIHJhbmdlXG4gKiBFeDE6IC0yIGluIHRoZSByYW5nZSBbMCwgMTBdIGlzIGludGVycHJldGVkIGFzIDAgYW5kIHRodXMgZ2l2ZXMgNDAgaW4gWzQwLDgwXVxuICogRXgyOiAxOSBpbiB0aGUgcmFuZ2UgWzAsIDVdIGlzIGludGVycHJldGVkIGFzIDUgYW5kIHRodXMgZ2l2ZXMgODAgaW4gWzQwLDgwXVxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSB2YWwgdGhlIHZhbHVlIGluIHRoZSBzb3VyY2UgcmFuZ2VcbiAqIEBwYXJhbSB7bnVtYmVyfSBtaW4xIHRoZSBsb3dlciBib3VuZCBvZiB0aGUgc291cmNlIHJhbmdlXG4gKiBAcGFyYW0ge251bWJlcn0gbWF4MSB0aGUgdXBwZXIgYm91bmQgb2YgdGhlIHNvdXJjZSByYW5nZVxuICogQHBhcmFtIHtudW1iZXJ9IG1pbjIgdGhlIGxvd2VyIGJvdW5kIG9mIHRoZSB0YXJnZXQgcmFuZ2VcbiAqIEBwYXJhbSB7bnVtYmVyfSBtYXgyIHRoZSB1cHBlciBib3VuZCBvZiB0aGUgdGFyZ2V0IHJhbmdlXG4gKiBAcmV0dXJuIHtudW1iZXJ9IHRoZSBlcXVpdmFsZW50IHZhbHVlIGluIHRoZSB0YXJnZXQgcmFuZ2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hcFJhbmdlKHZhbCwgbWluMSwgbWF4MSwgbWluMiwgbWF4Mikge1xuXG4gIGxldCBtYXgxQm91bmQgPSBtYXgxO1xuICBsZXQgbWluMUJvdW5kID0gbWluMTtcbiAgaWYgKG1pbjEgPiBtYXgxKSB7XG4gICAgbWF4MUJvdW5kID0gbWluMTtcbiAgICBtaW4xQm91bmQgPSBtYXgxO1xuICB9XG5cbiAgaWYgKHZhbCA8IG1pbjFCb3VuZCkge1xuICAgIHZhbCA9IG1pbjFCb3VuZDtcbiAgfSBlbHNlIGlmICh2YWwgPiBtYXgxQm91bmQpIHtcbiAgICB2YWwgPSBtYXgxQm91bmQ7XG4gIH1cblxuICByZXR1cm4gKHZhbCAtIG1pbjEpICogKG1heDIgLSBtaW4yKSAvIChtYXgxIC0gbWluMSkgKyBtaW4yO1xufVxuXG4vKipcbiAqIENvbXB1dGVzIHRoZSBtb2R1bHVzIG9mIHZhbHVlcyBgYWAgYW5kIGBiYC5cbiAqXG4gKiBUaGlzIGlzIG5lZWRlZCBiZWNhdXNlIHRoZSAlIG9wZXJhdG9yIGluIEphdmFTY3JpcHQgZG9lc24ndCBpbXBsZW1lbnRcbiAqIG1vZHVsdXMgYmVoYXZpb3VyIGFzIGNhbiBiZSBzZWVuIGJ5IHRoZSBzcGVjIGhlcmU6XG4gKiBodHRwOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTEuNS4zLlxuICogSXQgaW5zdGVhZCBpcyB1c2VkIHRvIG9idGFpbiB0aGUgcmVtYWluZGVyIG9mIGEgZGl2aXNpb24uXG4gKiBUaGlzIGZ1bmN0aW9uIHVzZXMgdGhlIHJlbWFpbmRlciAoJSkgb3BlcmF0b3IgdG8gZGV0ZXJtaW5lIHRoZSBtb2R1bHVzLlxuICogRGVyaXZlZCBmcm9tIGhlcmU6XG4gKiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yNTcyNjc2MC9qYXZhc2NyaXB0LW1vZHVsYXItYXJpdGhtZXRpYy80NzM1NDM1NiM0NzM1NDM1NlxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSBhXG4gKiBAcGFyYW0ge251bWJlcn0gYlxuICogQHJldHVybiB7bnVtYmVyfSByZXR1cm5zIHRoZSBtb2R1bHVzIG9mIHRoZSB0d28gbnVtYmVycy5cbiAqIEBleGFtcGxlXG4gKlxuICogXy5taW4oMTAsIDUpO1xuICogLy8gPT4gMFxuICpcbiAqIF8ubW9kKC0xLCA1KTtcbiAqIC8vID0+IDRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1vZChhLCBiKSB7XG4gIHJldHVybiBhID4gMCAmJiBiID4gMCA/IGEgJSBiIDogKChhICUgYikgKyBiKSAlIGI7XG59XG5cbi8qKlxuICogUmVzdHJpY3RzIGEgbnVtYmVyIHRvIGJlIGluIHRoZSBnaXZlbiBtaW4vbWF4IHJhbmdlLlxuICpcbiAqIEV4YW1wbGVzOlxuICogY2xhbXAoMC41LCAwLCAxKSAtPiAwLjVcbiAqIGNsYW1wKDEuNSwgMCwgMSkgLT4gMVxuICogY2xhbXAoLTAuNSwgMCwgMSkgLT4gMFxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSB2YWwgdGhlIHZhbHVlIHRvIGNsYW1wLlxuICogQHBhcmFtIHtudW1iZXJ9IG1pbiB0aGUgbG93ZXIgYm91bmQuXG4gKiBAcGFyYW0ge251bWJlcn0gbWF4IHRoZSB1cHBlciBib3VuZC5cbiAqIEByZXR1cm4ge251bWJlcn0gdGhlIGNsYW1wZWQgdmFsdWUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbGFtcCh2YWwsIG1pbiwgbWF4KSB7XG4gIHJldHVybiBNYXRoLm1pbihNYXRoLm1heCh2YWwsIG1pbiksIG1heCk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtpc09iamVjdH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKiBAY29uc3QgKi9cbmNvbnN0IGhhc093bl8gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuXG4vKipcbiAqIFJldHVybnMgYSBtYXAtbGlrZSBvYmplY3QuXG4gKiBJZiBvcHRfaW5pdGlhbCBpcyBwcm92aWRlZCwgY29waWVzIGl0cyBvd24gcHJvcGVydGllcyBpbnRvIHRoZVxuICogbmV3bHkgY3JlYXRlZCBvYmplY3QuXG4gKiBAcGFyYW0ge1Q9fSBvcHRfaW5pdGlhbCBUaGlzIHNob3VsZCB0eXBpY2FsbHkgYmUgYW4gb2JqZWN0IGxpdGVyYWwuXG4gKiBAcmV0dXJuIHtUfVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hcChvcHRfaW5pdGlhbCkge1xuICBjb25zdCBvYmogPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBpZiAob3B0X2luaXRpYWwpIHtcbiAgICBPYmplY3QuYXNzaWduKG9iaiwgb3B0X2luaXRpYWwpO1xuICB9XG4gIHJldHVybiBvYmo7XG59XG5cbi8qKlxuICogUmV0dXJuIGFuIGVtcHR5IEpzb25PYmplY3Qgb3IgbWFrZXMgdGhlIHBhc3NlZCBpbiBvYmplY3QgbGl0ZXJhbFxuICogYW4gSnNvbk9iamVjdC5cbiAqIFRoZSBKc29uT2JqZWN0IHR5cGUgaXMganVzdCBhIHNpbXBsZSBvYmplY3QgdGhhdCBpcyBhdC1kaWN0LlxuICogU2VlXG4gKiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2Nsb3N1cmUtY29tcGlsZXIvd2lraS9Ac3RydWN0LWFuZC1AZGljdC1Bbm5vdGF0aW9uc1xuICogZm9yIHdoYXQgYSBkaWN0IGlzIHR5cGUtd2lzZS5cbiAqIFRoZSBsaW50ZXIgZW5mb3JjZXMgdGhhdCB0aGUgYXJndW1lbnQgaXMsIGluIGZhY3QsIGF0LWRpY3QgbGlrZS5cbiAqIEBwYXJhbSB7IU9iamVjdD19IG9wdF9pbml0aWFsXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpY3Qob3B0X2luaXRpYWwpIHtcbiAgLy8gV2UgZG8gbm90IGNvcHkuIFRoZSBsaW50ZXIgZW5mb3JjZXMgdGhhdCB0aGUgcGFzc2VkIGluIG9iamVjdCBpcyBhIGxpdGVyYWxcbiAgLy8gYW5kIHRodXMgdGhlIGNhbGxlciBjYW5ub3QgaGF2ZSBhIHJlZmVyZW5jZSB0byBpdC5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovIChvcHRfaW5pdGlhbCB8fCB7fSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIHRoZSBnaXZlbiBrZXkgaXMgYSBwcm9wZXJ0eSBpbiB0aGUgbWFwLlxuICpcbiAqIEBwYXJhbSB7VH0gIG9iaiBhIG1hcCBsaWtlIHByb3BlcnR5LlxuICogQHBhcmFtIHtzdHJpbmd9ICBrZXlcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzT3duKG9iaiwga2V5KSB7XG4gIHJldHVybiBoYXNPd25fLmNhbGwob2JqLCBrZXkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgb2JqW2tleV0gaWZmIGtleSBpcyBvYmoncyBvd24gcHJvcGVydHkgKGlzIG5vdCBpbmhlcml0ZWQpLlxuICogT3RoZXJ3aXNlLCByZXR1cm5zIHVuZGVmaW5lZC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5XG4gKiBAcmV0dXJuIHsqfVxuICovXG5leHBvcnQgZnVuY3Rpb24gb3duUHJvcGVydHkob2JqLCBrZXkpIHtcbiAgaWYgKGhhc093bihvYmosIGtleSkpIHtcbiAgICByZXR1cm4gb2JqW2tleV07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG4vKipcbiAqIERlZXAgbWVyZ2VzIHNvdXJjZSBpbnRvIHRhcmdldC5cbiAqXG4gKiBAcGFyYW0geyFPYmplY3R9IHRhcmdldFxuICogQHBhcmFtIHshT2JqZWN0fSBzb3VyY2VcbiAqIEBwYXJhbSB7bnVtYmVyfSBkZXB0aCBUaGUgbWF4aW11bSBtZXJnZSBkZXB0aC4gSWYgZXhjZWVkZWQsIE9iamVjdC5hc3NpZ25cbiAqICAgICAgICAgICAgICAgICAgICAgICB3aWxsIGJlIHVzZWQgaW5zdGVhZC5cbiAqIEByZXR1cm4geyFPYmplY3R9XG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgc291cmNlIGNvbnRhaW5zIGEgY2lyY3VsYXIgcmVmZXJlbmNlLlxuICogTm90ZTogT25seSBuZXN0ZWQgb2JqZWN0cyBhcmUgZGVlcC1tZXJnZWQsIHByaW1pdGl2ZXMgYW5kIGFycmF5cyBhcmUgbm90LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVlcE1lcmdlKHRhcmdldCwgc291cmNlLCBkZXB0aCA9IDEwKSB7XG4gIC8vIEtlZXAgdHJhY2sgb2Ygc2VlbiBvYmplY3RzIHRvIGRldGVjdCByZWN1cnNpdmUgcmVmZXJlbmNlcy5cbiAgY29uc3Qgc2VlbiA9IFtdO1xuXG4gIC8qKiBAdHlwZSB7IUFycmF5PHt0OiAhT2JqZWN0LCBzOiAhT2JqZWN0LCBkOiBudW1iZXJ9Pn0gKi9cbiAgY29uc3QgcXVldWUgPSBbXTtcbiAgcXVldWUucHVzaCh7dDogdGFyZ2V0LCBzOiBzb3VyY2UsIGQ6IDB9KTtcblxuICAvLyBCRlMgdG8gZW5zdXJlIG9iamVjdHMgZG9uJ3QgaGF2ZSByZWN1cnNpdmUgcmVmZXJlbmNlcyBhdCBzaGFsbG93ZXIgZGVwdGhzLlxuICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IHt0LCBzLCBkfSA9IHF1ZXVlLnNoaWZ0KCk7XG4gICAgaWYgKHNlZW4uaW5jbHVkZXMocykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignU291cmNlIG9iamVjdCBoYXMgYSBjaXJjdWxhciByZWZlcmVuY2UuJyk7XG4gICAgfVxuICAgIHNlZW4ucHVzaChzKTtcbiAgICBpZiAodCA9PT0gcykge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChkID4gZGVwdGgpIHtcbiAgICAgIE9iamVjdC5hc3NpZ24odCwgcyk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgT2JqZWN0LmtleXMocykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgY29uc3QgbmV3VmFsdWUgPSBzW2tleV07XG4gICAgICAvLyBQZXJmb3JtIGEgZGVlcCBtZXJnZSBJRkYgYm90aCB0YXJnZXQgYW5kIHNvdXJjZSBoYXZlIHRoZSBzYW1lIGtleVxuICAgICAgLy8gd2hvc2UgY29ycmVzcG9uZGluZyB2YWx1ZXMgYXJlIG9iamVjdHMuXG4gICAgICBpZiAoaGFzT3duKHQsIGtleSkpIHtcbiAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0W2tleV07XG4gICAgICAgIGlmIChpc09iamVjdChuZXdWYWx1ZSkgJiYgaXNPYmplY3Qob2xkVmFsdWUpKSB7XG4gICAgICAgICAgcXVldWUucHVzaCh7dDogb2xkVmFsdWUsIHM6IG5ld1ZhbHVlLCBkOiBkICsgMX0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdFtrZXldID0gbmV3VmFsdWU7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHRhcmdldDtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFPYmplY3R9IG8gQW4gb2JqZWN0IHRvIHJlbW92ZSBwcm9wZXJ0aWVzIGZyb21cbiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHByb3BzIEEgbGlzdCBvZiBwcm9wZXJ0aWVzIHRvIHJlbW92ZSBmcm9tIHRoZSBPYmplY3RcbiAqIEByZXR1cm4geyFPYmplY3R9IEFuIG9iamVjdCB3aXRoIHRoZSBnaXZlbiBwcm9wZXJ0aWVzIHJlbW92ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9taXQobywgcHJvcHMpIHtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG8pLnJlZHVjZSgoYWNjLCBrZXkpID0+IHtcbiAgICBpZiAoIXByb3BzLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgIGFjY1trZXldID0gb1trZXldO1xuICAgIH1cbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBSZXR1cm5zIGEgRGVmZXJyZWQgc3RydWN0LCB3aGljaCBob2xkcyBhIHBlbmRpbmcgcHJvbWlzZSBhbmQgaXRzIGFzc29jaWF0ZWRcbiAqIHJlc29sdmUgYW5kIHJlamVjdCBmdW5jdGlvbnMuXG4gKlxuICogVGhpcyBpcyBwcmVmZXJyZWQgaW5zdGVhZCBvZiBjcmVhdGluZyBhIFByb21pc2UgaW5zdGFuY2UgdG8gZXh0cmFjdCB0aGVcbiAqIHJlc29sdmUvcmVqZWN0IGZ1bmN0aW9ucyB5b3Vyc2VsZjpcbiAqXG4gKiBgYGBcbiAqIC8vIEF2b2lkIGRvaW5nXG4gKiBsZXQgcmVzb2x2ZTtcbiAqIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZShyZXMgPT4ge1xuICogICByZXNvbHZlID0gcmVzO1xuICogfSk7XG4gKlxuICogLy8gR29vZFxuICogY29uc3QgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcbiAqIGNvbnN0IHsgcHJvbWlzZSwgcmVzb2x2ZSB9ID0gZGVmZXJyZWQ7XG4gKiBgYGBcbiAqXG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgY2xhc3MgRGVmZXJyZWQge1xuICAvKipcbiAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBEZWZlcnJlZC5cbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIGxldCByZXNvbHZlLCByZWplY3Q7XG5cbiAgICAvKipcbiAgICAgKiBAY29uc3QgeyFQcm9taXNlPFQ+fVxuICAgICAqL1xuICAgIHRoaXMucHJvbWlzZSA9IG5ldyAvKk9LKi9Qcm9taXNlKChyZXMsIHJlaikgPT4ge1xuICAgICAgcmVzb2x2ZSA9IHJlcztcbiAgICAgIHJlamVjdCA9IHJlajtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdCB7ZnVuY3Rpb24oVD0pfVxuICAgICAqL1xuICAgIHRoaXMucmVzb2x2ZSA9IHJlc29sdmU7XG5cbiAgICAvKipcbiAgICAgKiBAY29uc3Qge2Z1bmN0aW9uKCo9KX1cbiAgICAgKi9cbiAgICB0aGlzLnJlamVjdCA9IHJlamVjdDtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBwcm9taXNlIHJlc29sdmVkIHRvIHRoZSByZXR1cm4gdmFsdWUgb2YgZm4uXG4gKiBJZiBmbiBzeW5jIHRocm93cywgaXQgd2lsbCBjYXVzZSB0aGUgcHJvbWlzZSB0byByZWplY3QuXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbigpOlR9IGZuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTxUPn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnlSZXNvbHZlKGZuKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICByZXNvbHZlKGZuKCkpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSB3aGljaCByZXNvbHZlcyBpZiBhIHRocmVzaG9sZCBhbW91bnQgb2YgdGhlIGdpdmVuIHByb21pc2VzXG4gKiByZXNvbHZlLCBhbmQgcmVqZWN0cyBvdGhlcndpc2UuXG4gKiBAcGFyYW0geyFBcnJheTwhUHJvbWlzZT59IHByb21pc2VzIFRoZSBhcnJheSBvZiBwcm9taXNlcyB0byB0ZXN0LlxuICogQHBhcmFtIHtudW1iZXJ9IGNvdW50IFRoZSBudW1iZXIgb2YgcHJvbWlzZXMgdGhhdCBtdXN0IHJlc29sdmUgZm9yIHRoZVxuICogICAgIHJldHVybmVkIHByb21pc2UgdG8gcmVzb2x2ZS5cbiAqIEByZXR1cm4geyFQcm9taXNlfSBBIHByb21pc2UgdGhhdCByZXNvbHZlcyBpZiBhbnkgb2YgdGhlIGdpdmVuIHByb21pc2VzXG4gKiAgICAgcmVzb2x2ZSwgYW5kIHdoaWNoIHJlamVjdHMgb3RoZXJ3aXNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc29tZShwcm9taXNlcywgY291bnQgPSAxKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgY291bnQgPSBNYXRoLm1heChjb3VudCwgMCk7XG4gICAgY29uc3QgZXh0cmEgPSBwcm9taXNlcy5sZW5ndGggLSBjb3VudDtcbiAgICBpZiAoZXh0cmEgPCAwKSB7XG4gICAgICByZWplY3QobmV3IEVycm9yKCdub3QgZW5vdWdoIHByb21pc2VzIHRvIHJlc29sdmUnKSk7XG4gICAgfVxuICAgIGlmIChwcm9taXNlcy5sZW5ndGggPT0gMCkge1xuICAgICAgcmVzb2x2ZShbXSk7XG4gICAgfVxuICAgIGNvbnN0IHZhbHVlcyA9IFtdO1xuICAgIGNvbnN0IHJlYXNvbnMgPSBbXTtcblxuICAgIGNvbnN0IG9uRnVsZmlsbGVkID0gdmFsdWUgPT4ge1xuICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPCBjb3VudCkge1xuICAgICAgICB2YWx1ZXMucHVzaCh2YWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAodmFsdWVzLmxlbmd0aCA9PSBjb3VudCkge1xuICAgICAgICByZXNvbHZlKHZhbHVlcyk7XG4gICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBvblJlamVjdGVkID0gcmVhc29uID0+IHtcbiAgICAgIGlmIChyZWFzb25zLmxlbmd0aCA8PSBleHRyYSkge1xuICAgICAgICByZWFzb25zLnB1c2gocmVhc29uKTtcbiAgICAgIH1cbiAgICAgIGlmIChyZWFzb25zLmxlbmd0aCA+IGV4dHJhKSB7XG4gICAgICAgIHJlamVjdChyZWFzb25zKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvbWlzZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIFByb21pc2UucmVzb2x2ZShwcm9taXNlc1tpXSkudGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCk7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiBSZXNvbHZlcyB3aXRoIHRoZSByZXN1bHQgb2YgdGhlIGxhc3QgcHJvbWlzZSBhZGRlZC5cbiAqIEBpbXBsZW1lbnRzIHtJVGhlbmFibGV9XG4gKi9cbmV4cG9ydCBjbGFzcyBMYXN0QWRkZWRSZXNvbHZlciB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFBcnJheTwhUHJvbWlzZT49fSBvcHRfcHJvbWlzZXNcbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdF9wcm9taXNlcykge1xuICAgIGxldCByZXNvbHZlXywgcmVqZWN0XztcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshUHJvbWlzZX0gKi9cbiAgICB0aGlzLnByb21pc2VfID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgcmVzb2x2ZV8gPSByZXNvbHZlO1xuICAgICAgcmVqZWN0XyA9IHJlamVjdDtcbiAgICB9KTtcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMucmVzb2x2ZV8gPSByZXNvbHZlXztcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMucmVqZWN0XyA9IHJlamVjdF87XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICB0aGlzLmNvdW50XyA9IDA7XG5cbiAgICBpZiAob3B0X3Byb21pc2VzKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wdF9wcm9taXNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLmFkZChvcHRfcHJvbWlzZXNbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYSBwcm9taXNlIHRvIHBvc3NpYmx5IGJlIHJlc29sdmVkLlxuICAgKiBAcGFyYW0geyFQcm9taXNlfSBwcm9taXNlXG4gICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgKi9cbiAgYWRkKHByb21pc2UpIHtcbiAgICBjb25zdCBjb3VudEF0QWRkID0gKyt0aGlzLmNvdW50XztcbiAgICBQcm9taXNlLnJlc29sdmUocHJvbWlzZSkudGhlbihyZXN1bHQgPT4ge1xuICAgICAgaWYgKHRoaXMuY291bnRfID09PSBjb3VudEF0QWRkKSB7XG4gICAgICAgIHRoaXMucmVzb2x2ZV8ocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9LCBlcnJvciA9PiB7XG4gICAgICAvLyBEb24ndCBmb2xsb3cgYmVoYXZpb3Igb2YgUHJvbWlzZS5hbGwgYW5kIFByb21pc2UucmFjZSBlcnJvciBzbyB0aGF0XG4gICAgICAvLyB0aGlzIHdpbGwgb25seSByZWplY3Qgd2hlbiBtb3N0IHJlY2VudGx5IGFkZGVkIHByb21pc2UgZmFpbHMuXG4gICAgICBpZiAodGhpcy5jb3VudF8gPT09IGNvdW50QXRBZGQpIHtcbiAgICAgICAgdGhpcy5yZWplY3RfKGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5wcm9taXNlXztcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgdGhlbihvcHRfcmVzb2x2ZSwgb3B0X3JlamVjdCkge1xuICAgIHJldHVybiB0aGlzLnByb21pc2VfLnRoZW4ob3B0X3Jlc29sdmUsIG9wdF9yZWplY3QpO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBXcmFwcyBhIGdpdmVuIGNhbGxiYWNrIGFuZCBhcHBsaWVzIGEgcmF0ZSBsaW1pdC5cbiAqIEl0IHRocm90dGxlcyB0aGUgY2FsbHMgc28gdGhhdCBubyBjb25zZXF1ZW50IGNhbGxzIGhhdmUgdGltZSBpbnRlcnZhbFxuICogc21hbGxlciB0aGFuIHRoZSBnaXZlbiBtaW5pbWFsIGludGVydmFsLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKC4uLiopfSBjYWxsYmFja1xuICogQHBhcmFtIHtudW1iZXJ9IG1pbkludGVydmFsIHRoZSBtaW5pbXVtIHRpbWUgaW50ZXJ2YWwgaW4gbWlsbGlzZWNvbmRcbiAqIEByZXR1cm4ge2Z1bmN0aW9uKC4uLiopfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdGhyb3R0bGUod2luLCBjYWxsYmFjaywgbWluSW50ZXJ2YWwpIHtcbiAgbGV0IGxvY2tlciA9IDA7XG4gIGxldCBuZXh0Q2FsbEFyZ3MgPSBudWxsO1xuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFPYmplY3R9IGFyZ3NcbiAgICovXG4gIGZ1bmN0aW9uIGZpcmUoYXJncykge1xuICAgIG5leHRDYWxsQXJncyA9IG51bGw7XG4gICAgLy8gTG9jayB0aGUgZmlyZSBmb3IgbWluSW50ZXJ2YWwgbWlsbGlzZWNvbmRzXG4gICAgbG9ja2VyID0gd2luLnNldFRpbWVvdXQod2FpdGVyLCBtaW5JbnRlcnZhbCk7XG5cbiAgICBjYWxsYmFjay5hcHBseShudWxsLCBhcmdzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBXYWl0ZXIgZnVuY3Rpb25cbiAgICovXG4gIGZ1bmN0aW9uIHdhaXRlcigpIHtcbiAgICBsb2NrZXIgPSAwO1xuICAgIC8vIElmIGR1cmluZyB0aGUgcGVyaW9kIHRoZXJlJ3JlIGludm9jYXRpb25zIHF1ZXVlZCB1cCwgZmlyZSBvbmNlLlxuICAgIGlmIChuZXh0Q2FsbEFyZ3MpIHtcbiAgICAgIGZpcmUobmV4dENhbGxBcmdzKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24oLi4uYXJncykge1xuICAgIGlmIChsb2NrZXIpIHtcbiAgICAgIG5leHRDYWxsQXJncyA9IGFyZ3M7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZpcmUoYXJncyk7XG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIFdyYXBzIGEgZ2l2ZW4gY2FsbGJhY2sgYW5kIGFwcGxpZXMgYSB3YWl0IHRpbWVyLCBzbyB0aGF0IG1pbkludGVydmFsXG4gKiBtaWxsaXNlY29uZHMgbXVzdCBwYXNzIHNpbmNlIHRoZSBsYXN0IGNhbGwgYmVmb3JlIHRoZSBjYWxsYmFjayBpcyBhY3R1YWxseVxuICogaW52b2tlZC5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtmdW5jdGlvbiguLi4qKX0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7bnVtYmVyfSBtaW5JbnRlcnZhbCB0aGUgbWluaW11bSB0aW1lIGludGVydmFsIGluIG1pbGxpc2Vjb25kXG4gKiBAcmV0dXJuIHtmdW5jdGlvbiguLi4qKX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlYm91bmNlKHdpbiwgY2FsbGJhY2ssIG1pbkludGVydmFsKSB7XG4gIGxldCBsb2NrZXIgPSAwO1xuICBsZXQgdGltZXN0YW1wID0gMDtcbiAgbGV0IG5leHRDYWxsQXJncyA9IG51bGw7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7P0FycmF5fSBhcmdzXG4gICAqL1xuICBmdW5jdGlvbiBmaXJlKGFyZ3MpIHtcbiAgICBuZXh0Q2FsbEFyZ3MgPSBudWxsO1xuICAgIGNhbGxiYWNrLmFwcGx5KG51bGwsIGFyZ3MpO1xuICB9XG5cbiAgLyoqXG4gICAqIFdhaXQgZnVuY3Rpb24gZm9yIGRlYm91bmNlXG4gICAqL1xuICBmdW5jdGlvbiB3YWl0ZXIoKSB7XG4gICAgbG9ja2VyID0gMDtcbiAgICBjb25zdCByZW1haW5pbmcgPSBtaW5JbnRlcnZhbCAtICh3aW4uRGF0ZS5ub3coKSAtIHRpbWVzdGFtcCk7XG4gICAgaWYgKHJlbWFpbmluZyA+IDApIHtcbiAgICAgIGxvY2tlciA9IHdpbi5zZXRUaW1lb3V0KHdhaXRlciwgcmVtYWluaW5nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZmlyZShuZXh0Q2FsbEFyZ3MpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiguLi5hcmdzKSB7XG4gICAgdGltZXN0YW1wID0gd2luLkRhdGUubm93KCk7XG4gICAgbmV4dENhbGxBcmdzID0gYXJncztcbiAgICBpZiAoIWxvY2tlcikge1xuICAgICAgbG9ja2VyID0gd2luLnNldFRpbWVvdXQod2FpdGVyLCBtaW5JbnRlcnZhbCk7XG4gICAgfVxuICB9O1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQge2Rldn0gZnJvbSAnLi4vbG9nJztcbmltcG9ydCB7b25jZX0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQge3NldFN0eWxlc30gZnJvbSAnLi4vc3R5bGUnO1xuXG5cbi8qKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNMaXRlVmlld2VyXG4gKiBAcmV0dXJuIHshUHJvbWlzZTxib29sZWFuPn1cbiAqL1xuZnVuY3Rpb24gaXNBdXRvcGxheVN1cHBvcnRlZEltcGwod2luLCBpc0xpdGVWaWV3ZXIpIHtcbiAgLy8gV2UgZG8gbm90IHN1cHBvcnQgYXV0b3BsYXkgaW4gYW1wLWxpdGUgdmlld2VyIHJlZ2FyZGxlc3Mgb2YgcGxhdGZvcm0uXG4gIGlmIChpc0xpdGVWaWV3ZXIpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcbiAgfVxuXG4gIC8vIFRvIGRldGVjdCBhdXRvcGxheSwgd2UgY3JlYXRlIGEgdmlkZW8gZWxlbWVudCBhbmQgY2FsbCBwbGF5IG9uIGl0LCBpZlxuICAvLyBgcGF1c2VkYCBpcyB0cnVlIGFmdGVyIGBwbGF5KClgIGNhbGwsIGF1dG9wbGF5IGlzIHN1cHBvcnRlZC4gQWx0aG91Z2hcbiAgLy8gdGhpcyBpcyB1bmludHVpdGl2ZSwgaXQgd29ya3MgYWNyb3NzIGJyb3dzZXJzIGFuZCBpcyBjdXJyZW50bHkgdGhlIGxpZ2h0ZXN0XG4gIC8vIHdheSB0byBkZXRlY3QgYXV0b3BsYXkgd2l0aG91dCB1c2luZyBhIGRhdGEgc291cmNlLlxuICBjb25zdCBkZXRlY3Rpb25FbGVtZW50ID0gd2luLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJyk7XG5cbiAgLy8gTk9URShhZ2hhc3NlbWkpOiBXZSBuZWVkIGJvdGggYXR0cmlidXRlcyBhbmQgcHJvcGVydGllcyBkdWUgdG8gQ2hyb21lIGFuZFxuICAvLyBTYWZhcmkgZGlmZmVyZW5jZXMgd2hlbiBkZWFsaW5nIHdpdGggbm9uLWF0dGFjaGVkIGVsZW1lbnRzLlxuICBkZXRlY3Rpb25FbGVtZW50LnNldEF0dHJpYnV0ZSgnbXV0ZWQnLCAnJyk7XG4gIGRldGVjdGlvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdwbGF5c2lubGluZScsICcnKTtcbiAgZGV0ZWN0aW9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3dlYmtpdC1wbGF5c2lubGluZScsICcnKTtcbiAgZGV0ZWN0aW9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcwJyk7XG4gIGRldGVjdGlvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCd3aWR0aCcsICcwJyk7XG5cbiAgZGV0ZWN0aW9uRWxlbWVudC5tdXRlZCA9IHRydWU7XG4gIGRldGVjdGlvbkVsZW1lbnQucGxheXNpbmxpbmUgPSB0cnVlO1xuICBkZXRlY3Rpb25FbGVtZW50LndlYmtpdFBsYXlzaW5saW5lID0gdHJ1ZTtcblxuICBzZXRTdHlsZXMoZGV0ZWN0aW9uRWxlbWVudCwge1xuICAgIHBvc2l0aW9uOiAnZml4ZWQnLFxuICAgIHRvcDogJzAnLFxuICAgIHdpZHRoOiAnMCcsXG4gICAgaGVpZ2h0OiAnMCcsXG4gICAgb3BhY2l0eTogJzAnLFxuICB9KTtcblxuICAvLyBQcm9taXNlIHdyYXBwZWQgdGhpcyB3YXkgdG8gY2F0Y2ggYm90aCBzeW5jIHRocm93cyBhbmQgYXN5bmMgcmVqZWN0aW9ucy5cbiAgLy8gTW9yZSBpbmZvOiBodHRwczovL2dpdGh1Yi5jb20vdGMzOS9wcm9wb3NhbC1wcm9taXNlLXRyeVxuICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHJlc29sdmUoZGV0ZWN0aW9uRWxlbWVudC5wbGF5KCkpKS5jYXRjaCgoKSA9PiB7XG4gICAgLy8gU3VwcHJlc3MgYW55IGVycm9ycywgdXNlbGVzcyB0byByZXBvcnQgYXMgdGhleSBhcmUgZXhwZWN0ZWQuXG4gIH0pO1xuXG4gIHJldHVybiBQcm9taXNlLnJlc29sdmUoIWRldGVjdGlvbkVsZW1lbnQucGF1c2VkKTtcbn1cblxuXG4vKiogQHByaXZhdGUgez8oZnVuY3Rpb24oV2luZG93LCBib29sZWFuKTohUHJvbWlzZTxib29sZWFuPil9ICovXG5sZXQgaXNBdXRvcGxheVN1cHBvcnRlZCA9IG51bGw7XG5cbi8qKlxuICogU2V0cyBpZiBhdXRvcGxheSBpcyBzdXBwb3J0ZWQuXG4gKi9cbmZ1bmN0aW9uIHNldElzQXV0b3BsYXlTdXBwb3J0ZWQoKSB7XG4gIGlzQXV0b3BsYXlTdXBwb3J0ZWQgPVxuICAgIC8qKiBAdHlwZSB7ZnVuY3Rpb24oV2luZG93LCBib29sZWFuKTohUHJvbWlzZTxib29sZWFuPn0gKi8gKFxuICAgICAgb25jZShpc0F1dG9wbGF5U3VwcG9ydGVkSW1wbCkpO1xufVxuXG5cbi8qKlxuICogV3JhcHBlciBhcm91bmQgc3RhdGljIHV0aWxpdGllcyBmb3IgdGVzdGFiaWxpdHkuXG4gKi9cbmV4cG9ydCBjbGFzcyBWaWRlb1V0aWxzIHtcbiAgLyoqXG4gICAqIERldGVybWluZXMgYXV0b3BsYXkgc3VwcG9ydC5cbiAgICpcbiAgICogTm90ZSB0aGF0IGV2ZW4gaWYgcGxhdGZyb20gc3VwcG9ydHMgYXV0b3BsYXksIHVzZXJzIG9yIGJyb3dzZXJzIGNhbiBkaXNhYmxlXG4gICAqIGF1dG9wbGF5IHRvIHNhdmUgZGF0YSAvIGJhdHRlcnkuIFRoaXMgZGV0ZWN0cyBib3RoIHBsYXRmcm9tIHN1cHBvcnQgYW5kXG4gICAqIHdoZW4gYXV0b3BsYXkgaGFzIGJlZW4gZGlzYWJsZWQgYnkgdGhlIHVzZXIuXG4gICAqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNMaXRlVmlld2VyXG4gICAqIEByZXR1cm4geyFQcm9taXNlPGJvb2xlYW4+fVxuICAgKi9cbiAgc3RhdGljIGlzQXV0b3BsYXlTdXBwb3J0ZWQod2luLCBpc0xpdGVWaWV3ZXIpIHtcbiAgICBpZiAoIWlzQXV0b3BsYXlTdXBwb3J0ZWQpIHtcbiAgICAgIHNldElzQXV0b3BsYXlTdXBwb3J0ZWQoKTtcbiAgICB9XG4gICAgcmV0dXJuIGlzQXV0b3BsYXlTdXBwb3J0ZWQod2luLCBpc0xpdGVWaWV3ZXIpO1xuICB9XG5cbiAgLyoqIEB2aXNpYmxlRm9yVGVzdGluZyAqL1xuICBzdGF0aWMgcmVzZXRJc0F1dG9wbGF5U3VwcG9ydGVkKCkge1xuICAgIHNldElzQXV0b3BsYXlTdXBwb3J0ZWQoKTtcbiAgfVxufVxuXG4vKipcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4geyFFbGVtZW50fVxuICogTm90ZTogTm90IGluY2x1ZGVkIGluIGBWaWRlb1V0aWxzYCBhcyB3ZSBkb24ndCBuZWVkIHRvIHRlc3QgYVxuICogc3RhdGljIHNlbGVjdG9yLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0SW50ZXJuYWxWaWRlb0VsZW1lbnRGb3IoZWxlbWVudCkge1xuICByZXR1cm4gZGV2KCkuYXNzZXJ0RWxlbWVudChlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3ZpZGVvLCBpZnJhbWUnKSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuZXhwb3J0IGNvbnN0IE1JTl9WSVNJQklMSVRZX1JBVElPX0ZPUl9BVVRPUExBWSA9IDAuNTtcblxuLyoqXG4gKiBWaWRlb0ludGVyZmFjZSBkZWZpbmVzIGEgY29tbW9uIHZpZGVvIEFQSSB3aGljaCBhbnkgQU1QIGNvbXBvbmVudCB0aGF0IHBsYXlzXG4gKiB2aWRlb3MgaXMgZXhwZWN0ZWQgdG8gaW1wbGVtZW50LlxuICpcbiAqIEFNUCBydW50aW1lIHVzZXMgdGhpcyBjb21tb24gQVBJIHRvIHByb3ZpZGUgY29uc2lzdGVudCB2aWRlbyBleHBlcmllbmNlIGFuZFxuICogYW5hbHl0aWNzIGFjcm9zcyBhbGwgdmlkZW8gcGxheWVycy5cbiAqXG4gKiBDb21wb25lbnRzIGltcGxlbWVudGluZyB0aGlzIGludGVyZmFjZSBtdXN0IGFsc28gZXh0ZW5kXG4gKiB7QGxpbmsgLi9iYXNlLWVsZW1lbnQuQmFzZUVsZW1lbnR9IGFuZCByZWdpc3RlciB3aXRoIHRoZVxuICogVmlkZW8gTWFuYWdlciB7QGxpbmsgLi9zZXJ2aWNlL3ZpZGVvLW1hbmFnZXItaW1wbC5WaWRlb01hbmFnZXJ9IGR1cmluZ1xuICogdGhlaXIgYGJ1aWx0Q2FsbGJhY2tgLlxuICpcbiAqIEBpbnRlcmZhY2VcbiAqL1xuZXhwb3J0IGNsYXNzIFZpZGVvSW50ZXJmYWNlIHtcblxuICAvKipcbiAgICogV2hldGhlciB0aGUgY29tcG9uZW50IHN1cHBvcnRzIHZpZGVvIHBsYXliYWNrIGluIHRoZSBjdXJyZW50IHBsYXRmb3JtLlxuICAgKiBJZiBmYWxzZSwgY29tcG9uZW50IHdpbGwgYmUgbm90IHRyZWF0ZWQgYXMgYSB2aWRlbyBjb21wb25lbnQuXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBzdXBwb3J0c1BsYXRmb3JtKCkge31cblxuICAvKipcbiAgICogV2hldGhlciB1c2VycyBjYW4gaW50ZXJhY3Qgd2l0aCB0aGUgdmlkZW8gc3VjaCBhcyBwYXVzaW5nIGl0LlxuICAgKiBFeGFtcGxlIG9mIG5vbi1pbnRlcmFjdGl2ZSB2aWRlb3MgaW5jbHVkZSBkZXNpZ24gYmFja2dyb3VuZCB2aWRlb3Mgd2hlcmVcbiAgICogYWxsIGNvbnRyb2xzIGFyZSBoaWRkZW4gZnJvbSB0aGUgdXNlci5cbiAgICpcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlzSW50ZXJhY3RpdmUoKSB7fVxuXG4gIC8qKlxuICAgKiBDdXJyZW50IHBsYXliYWNrIHRpbWUgaW4gc2Vjb25kcyBhdCB0aW1lIG9mIHRyaWdnZXJcbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKi9cbiAgZ2V0Q3VycmVudFRpbWUoKSB7fVxuXG4gIC8qKlxuICAgKiBUb3RhbCBkdXJhdGlvbiBvZiB0aGUgdmlkZW8gaW4gc2Vjb25kc1xuICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAqL1xuICBnZXREdXJhdGlvbigpIHt9XG5cbiAgLyoqXG4gICAqIEdldCBhIDJkIGFycmF5IG9mIHN0YXJ0IGFuZCBzdG9wIHRpbWVzIHRoYXQgdGhlIHVzZXIgaGFzIHdhdGNoZWQuXG4gICAqIEByZXR1cm4geyFBcnJheTxBcnJheTxudW1iZXI+Pn1cbiAgICovXG4gIGdldFBsYXllZFJhbmdlcygpIHt9XG5cbiAgLyoqXG4gICAqIFBsYXlzIHRoZSB2aWRlby4uXG4gICAqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gdW51c2VkSXNBdXRvcGxheSBXaGV0aGVyIHRoZSBjYWxsIHRvIHRoZSBgcGxheWAgbWV0aG9kIGlzXG4gICAqIHRyaWdnZXJlZCBieSB0aGUgYXV0b3BsYXkgZnVuY3Rpb25hbGl0eS4gVmlkZW8gcGxheWVycyBjYW4gdXNlIHRoaXMgaGludFxuICAgKiB0byBtYWtlIGRlY2lzaW9ucyBzdWNoIGFzIG5vdCBwbGF5aW5nIHByZS1yb2xsIHZpZGVvIGFkcy5cbiAgICovXG4gIHBsYXkodW51c2VkSXNBdXRvcGxheSkge31cblxuICAvKipcbiAgICogUGF1c2VzIHRoZSB2aWRlby5cbiAgICovXG4gIHBhdXNlKCkge31cblxuICAvKipcbiAgICogTXV0ZXMgdGhlIHZpZGVvLlxuICAgKi9cbiAgbXV0ZSgpIHt9XG5cbiAgLyoqXG4gICAqIFVubXV0ZXMgdGhlIHZpZGVvLlxuICAgKi9cbiAgdW5tdXRlKCkge31cblxuICAvKipcbiAgICogTWFrZXMgdGhlIHZpZGVvIFVJIGNvbnRyb2xzIHZpc2libGUuXG4gICAqXG4gICAqIEFNUCB3aWxsIG5vdCBjYWxsIHRoaXMgbWV0aG9kIGlmIGBjb250cm9sc2AgYXR0cmlidXRlIGlzIG5vdCBzZXQuXG4gICAqL1xuICBzaG93Q29udHJvbHMoKSB7fVxuXG4gIC8qKlxuICAgKiBIaWRlcyB0aGUgdmlkZW8gVUkgY29udHJvbHMuXG4gICAqXG4gICAqIEFNUCB3aWxsIG5vdCBjYWxsIHRoaXMgbWV0aG9kIGlmIGBjb250cm9sc2AgYXR0cmlidXRlIGlzIG5vdCBzZXQuXG4gICAqL1xuICBoaWRlQ29udHJvbHMoKSB7fVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHZpZGVvJ3MgbWV0YSBkYXRhIChhcnR3b3JrLCB0aXRsZSwgYXJ0aXN0LCBhbGJ1bSwgZXRjLikgZm9yIHVzZVxuICAgKiB3aXRoIHRoZSBNZWRpYSBTZXNzaW9uIEFQSVxuICAgKiBhcnR3b3JrIChBcnJheSk6IFVSTCB0byB0aGUgcG9zdGVyIGltYWdlIChwcmVmZXJhYmx5IGEgNTEyeDUxMiBQTkcpXG4gICAqIHRpdGxlIChzdHJpbmcpOiBOYW1lIG9mIHRoZSB2aWRlb1xuICAgKiBhcnRpc3QgKHN0cmluZyk6IE5hbWUgb2YgdGhlIHZpZGVvJ3MgYXV0aG9yL2FydGlzdFxuICAgKiBhbGJ1bSAoc3RyaW5nKTogTmFtZSBvZiB0aGUgdmlkZW8ncyBhbGJ1bSBpZiBpdCBleGlzdHNcbiAgICogQHJldHVybiB7IS4vbWVkaWFzZXNzaW9uLWhlbHBlci5NZXRhZGF0YURlZnx1bmRlZmluZWR9IG1ldGFkYXRhXG4gICAqL1xuICBnZXRNZXRhZGF0YSgpIHt9XG5cbiAgLyoqXG4gICAqIElmIHRoaXMgcmV0dXJucyB0cnVlIHRoZW4gaXQgd2lsbCBiZSBhc3N1bWVkIHRoYXQgdGhlIHBsYXllciBpbXBsZW1lbnRzXG4gICAqIGEgZmVhdHVyZSB0byBlbnRlciBmdWxsc2NyZWVuIG9uIGRldmljZSByb3RhdGlvbiBpbnRlcm5hbGx5LCBzbyB0aGF0IHRoZVxuICAgKiB2aWRlbyBtYW5hZ2VyIGRvZXMgbm90IG92ZXJyaWRlIGl0LiBJZiBub3QsIHRoZSB2aWRlbyBtYW5hZ2VyIHdpbGxcbiAgICogaW1wbGVtZW50IHRoaXMgZmVhdHVyZSBhdXRvbWF0aWNhbGx5IGZvciB2aWRlb3Mgd2l0aCB0aGUgYXR0cmlidXRlXG4gICAqIGByb3RhdGUtdG8tZnVsbHNjcmVlbmAuXG4gICAqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBwcmVpbXBsZW1lbnRzQXV0b0Z1bGxzY3JlZW4oKSB7fVxuXG4gIC8qKlxuICAgKiBJZiB0aGlzIHJldHVybnMgdHJ1ZSB0aGVuIGl0IHdpbGwgYmUgYXNzdW1lZCB0aGF0IHRoZSBwbGF5ZXIgaW1wbGVtZW50c1xuICAgKiB0aGUgTWVkaWFTZXNzaW9uIEFQSSBpbnRlcm5hbGx5IHNvIHRoYXQgdGhlIHZpZGVvIG1hbmFnZXIgZG9lcyBub3Qgb3ZlcnJpZGVcbiAgICogaXQuIElmIG5vdCwgdGhlIHZpZGVvIG1hbmFnZXIgd2lsbCB1c2UgdGhlIG1ldGFkYXRhIHZhcmlhYmxlIGFzIHdlbGwgYXNcbiAgICogaW5mZXJyZWQgbWV0YS1kYXRhIHRvIHVwZGF0ZSB0aGUgdmlkZW8ncyBNZWRpYSBTZXNzaW9uIG5vdGlmaWNhdGlvbi5cbiAgICpcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIHByZWltcGxlbWVudHNNZWRpYVNlc3Npb25BUEkoKSB7fVxuXG4gIC8qKlxuICAgKiBFbmFibGVzIGZ1bGxzY3JlZW4gb24gdGhlIGludGVybmFsIHZpZGVvIGVsZW1lbnRcbiAgICogTk9URTogV2hpbGUgaW1wbGVtZW50aW5nLCBrZWVwIGluIG1pbmQgdGhhdCBTYWZhcmkvaU9TIGRvIG5vdCBhbGxvdyB0YWtpbmdcbiAgICogYW55IGVsZW1lbnQgb3RoZXIgdGhhbiA8dmlkZW8+IHRvIGZ1bGxzY3JlZW4sIGlmIHRoZSBwbGF5ZXIgaGFzIGFuIGludGVybmFsXG4gICAqIGltcGxlbWVudGF0aW9uIG9mIGZ1bGxzY3JlZW4gKGZsYXNoIGZvciBleGFtcGxlKSB0aGVuIGNoZWNrXG4gICAqIGlmIFNlcnZpY2VzLnBsYXRmb3JtRm9yKHRoaXMud2luKS5pc1NhZmFyaSBpcyB0cnVlIGFuZCB1c2UgdGhlIGludGVybmFsXG4gICAqIGltcGxlbWVudGF0aW9uIGluc3RlYWQuIElmIG5vdCwgaXQgaXMgcmVjb21tZW5kZWQgdG8gdGFrZSB0aGUgaWZyYW1lXG4gICAqIHRvIGZ1bGxzY3JlZW4gdXNpbmcgZnVsbHNjcmVlbkVudGVyIGZyb20gZG9tLmpzXG4gICAqL1xuICBmdWxsc2NyZWVuRW50ZXIoKSB7fVxuXG4gIC8qKlxuICAgKiBRdWl0cyBmdWxsc2NyZWVuIG1vZGVcbiAgICovXG4gIGZ1bGxzY3JlZW5FeGl0KCkge31cblxuICAvKipcbiAgICogUmV0dXJucyB3aGV0aGVyIHRoZSB2aWRlbyBpcyBjdXJyZW50bHkgaW4gZnVsbHNjcmVlbiBtb2RlIG9yIG5vdFxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgaXNGdWxsc2NyZWVuKCkge31cbn1cblxuXG4vKipcbiAqIEF0dHJpYnV0ZXNcbiAqXG4gKiBDb21wb25lbnRzIGltcGxlbWVudGluZyB0aGUgVmlkZW9JbnRlcmZhY2UgYXJlIGV4cGVjdGVkIHRvIHN1cHBvcnRcbiAqIHRoZSBmb2xsb3dpbmcgYXR0cmlidXRlcy5cbiAqXG4gKiBAY29uc3RhbnQgeyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fVxuICovXG5leHBvcnQgY29uc3QgVmlkZW9BdHRyaWJ1dGVzID0ge1xuICAvKipcbiAgICogYXV0b3BsYXlcbiAgICpcbiAgICogV2hldGhlciB0aGUgZGV2ZWxvcGVyIGhhcyBjb25maWd1cmVkIGF1dG9wbGF5IG9uIHRoZSBjb21wb25lbnQuXG4gICAqIFRoaXMgaXMgbm9ybWFsbHkgZG9uZSBieSBzZXR0aW5nIGBhdXRvcGxheWAgYXR0cmlidXRlIG9uIHRoZSBjb21wb25lbnQuXG4gICAqXG4gICAqIEFNUCBydW50aW1lIG1hbmFnZXMgYXV0b3BsYXkgYmVoYXZpb3VyIGl0c2VsZiB1c2luZyBtZXRob2RzIHN1Y2ggYXMgYHBsYXlgLFxuICAgKiBgcGF1c2VgLCBgc2hvd0NvbnRyb2xzYCwgYGhpZGVDb250cm9sc2AsIGBtdXRlYCwgZXRjLi4gdGhlcmVmb3JlIGNvbXBvbmVudHNcbiAgICogc2hvdWxkIG5vdCBwcm9wYWdhdGUgdGhlIGF1dG9wbGF5IGF0dHJpYnV0ZSB0byB0aGUgdW5kZXJseWluZyBwbGF5ZXJcbiAgICogaW1wbGVtZW50YXRpb24uXG4gICAqXG4gICAqIFdoZW4gYSB2aWRlbyBpcyByZXF1ZXN0ZWQgdG8gYXV0b3BsYXksIEFNUCB3aWxsIGF1dG9tYXRpY2FsbHlcbiAgICogbXV0ZSBhbmQgaGlkZSB0aGUgY29udHJvbHMgZm9yIHRoZSB2aWRlbywgd2hlbiB2aWRlbyBpcyA3NSUgdmlzaWJsZSBpblxuICAgKiB0aGUgdmlld3BvcnQsIEFNUCB3aWxsIHBsYXkgdGhlIHZpZGVvIGFuZCBsYXRlciBwYXVzZXMgaXQgd2hlbiAyNSVcbiAgICogb3IgbW9yZSBvZiB0aGUgdmlkZW8gZXhpdHMgdGhlIHZpZXdwb3J0LiBJZiBhbiBhdXRvLXBsYXlpbmcgdmlkZW8gYWxzbyBoYXNcbiAgICogY29udHJvbHMsIEFNUCB3aWxsIGluc3RhbGwgYSB0YXBcbiAgICogaGFuZGxlciBvbiB0aGUgdmlkZW8sIGFuZCB3aGVuIGFuIGVuZC11c2VyIHRhcHMgdGhlIHZpZGVvLCBBTVAgd2lsbCBzaG93XG4gICAqIHRoZSBjb250cm9scy5cbiAgICpcbiAgICovXG4gIEFVVE9QTEFZOiAnYXV0b3BsYXknLFxuICAvKipcbiAgICogZG9ja1xuICAgKlxuICAgKiBTZXR0aW5nIHRoZSBgZG9ja2AgYXR0cmlidXRlIG9uIHRoZSBjb21wb25lbnQgbWFrZXMgdGhlIHZpZGVvIG1pbmltaXplXG4gICAqIHRvIHRoZSBjb3JuZXIgd2hlbiBzY3JvbGxlZCBvdXQgb2YgdmlldyBhbmQgaGFzIGJlZW4gaW50ZXJhY3RlZCB3aXRoLlxuICAgKi9cbiAgRE9DSzogJ2RvY2snLFxuICAvKipcbiAgICogcm90YXRlLXRvLWZ1bGxzY3JlZW5cbiAgICpcbiAgICogSWYgZW5hYmxlZCwgdGhpcyBhdXRvbWF0aWNhbGx5IGV4cGFuZHMgdGhlIGN1cnJlbnRseSB2aXNpYmxlIHZpZGVvIGFuZFxuICAgKiBwbGF5aW5nIHRvIGZ1bGxzY3JlZW4gd2hlbiB0aGUgdXNlciBjaGFuZ2VzIHRoZSBkZXZpY2UncyBvcmllbnRhdGlvbiB0b1xuICAgKiBsYW5kc2NhcGUgaWYgdGhlIHZpZGVvIHdhcyBzdGFydGVkIGZvbGxvd2luZyBhIHVzZXIgaW50ZXJhY3Rpb25cbiAgICogKG5vdCBhdXRvcGxheSlcbiAgICpcbiAgICogRGVwZW5kZW50IHVwb24gYnJvd3NlciBzdXBwb3J0IG9mXG4gICAqIGh0dHA6Ly9jYW5pdXNlLmNvbS8jZmVhdD1zY3JlZW4tb3JpZW50YXRpb25cbiAgICogYW5kIGh0dHA6Ly9jYW5pdXNlLmNvbS8jZmVhdD1mdWxsc2NyZWVuXG4gICAqL1xuICBST1RBVEVfVE9fRlVMTFNDUkVFTjogJ3JvdGF0ZS10by1mdWxsc2NyZWVuJyxcbiAgLyoqXG4gICAqIG5vYXVkaW9cbiAgICpcbiAgICogSWYgc2V0IGFuZCBhdXRvcGxheSwgdGhlIGVxdWFsaXplciBpY29uIHdpbGwgbm90IGJlIGRpc3BsYXllZC5cbiAgICovXG4gIE5PX0FVRElPOiAnbm9hdWRpbycsXG59O1xuXG5cbi8qKlxuICogRXZlbnRzXG4gKlxuICogQ29tcG9uZW50cyBpbXBsZW1lbnRpbmcgdGhlIFZpZGVvSW50ZXJmYWNlIGFyZSBleHBlY3RlZCB0byBkaXNwYXRjaFxuICogdGhlIGZvbGxvd2luZyBET00gZXZlbnRzLlxuICpcbiAqIEBjb25zdGFudCB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59XG4gKi9cbmV4cG9ydCBjb25zdCBWaWRlb0V2ZW50cyA9IHtcbiAgLyoqXG4gICAqIHJlZ2lzdGVyZWRcbiAgICpcbiAgICogRmlyZWQgd2hlbiB0aGUgdmlkZW8gcGxheWVyIGVsZW1lbnQgaXMgYnVpbHQgYW5kIGhhcyBiZWVuIHJlZ2lzdGVyZWQgd2l0aFxuICAgKiB0aGUgdmlkZW8gbWFuYWdlci5cbiAgICpcbiAgICogQGV2ZW50IHJlZ2lzdGVyZWRcbiAgICovXG4gIFJFR0lTVEVSRUQ6ICdyZWdpc3RlcmVkJyxcblxuICAvKipcbiAgICogbG9hZFxuICAgKlxuICAgKiBGaXJlZCB3aGVuIHRoZSB2aWRlbyBwbGF5ZXIgaXMgbG9hZGVkIGFuZCBjYWxscyB0byBtZXRob2RzIHN1Y2ggYXMgYHBsYXkoKWBcbiAgICogYXJlIGFsbG93ZWQuXG4gICAqXG4gICAqIEBldmVudCBsb2FkXG4gICAqL1xuICBMT0FEOiAnbG9hZCcsXG5cbiAgLyoqXG4gICAqIHBsYXlpbmdcbiAgICpcbiAgICogRmlyZWQgd2hlbiB0aGUgdmlkZW8gYmVnaW5zIHBsYXlpbmcuXG4gICAqXG4gICAqIEBldmVudCBwbGF5aW5nXG4gICAqL1xuICBQTEFZSU5HOiAncGxheWluZycsXG5cbiAgLyoqXG4gICAqIHBhdXNlXG4gICAqXG4gICAqIEZpcmVkIHdoZW4gdGhlIHZpZGVvIHBhdXNlcy5cbiAgICpcbiAgICogQGV2ZW50IHBhdXNlXG4gICAqL1xuICBQQVVTRTogJ3BhdXNlJyxcblxuICAvKipcbiAgICogZW5kZWRcbiAgICpcbiAgICogRmlyZWQgd2hlbiB0aGUgdmlkZW8gZW5kcy5cbiAgICpcbiAgICogVGhpcyBldmVudCBzaG91bGQgYmUgZmlyZWQgaW4gYWRkaXRpb24gdG8gYHBhdXNlYCB3aGVuIHZpZGVvIGVuZHMuXG4gICAqXG4gICAqIEBldmVudCBlbmRlZFxuICAgKi9cbiAgRU5ERUQ6ICdlbmRlZCcsXG5cbiAgLyoqXG4gICAqIG11dGVkXG4gICAqXG4gICAqIEZpcmVkIHdoZW4gdGhlIHZpZGVvIGlzIG11dGVkLlxuICAgKlxuICAgKiBAZXZlbnQgbXV0ZWRcbiAgICovXG4gIE1VVEVEOiAnbXV0ZWQnLFxuXG4gIC8qKlxuICAgKiB1bm11dGVkXG4gICAqXG4gICAqIEZpcmVkIHdoZW4gdGhlIHZpZGVvIGlzIHVubXV0ZWQuXG4gICAqXG4gICAqIEBldmVudCB1bm11dGVkXG4gICAqL1xuICBVTk1VVEVEOiAndW5tdXRlZCcsXG5cbiAgLyoqXG4gICAqIGFtcDp2aWRlbzp2aXNpYmlsaXR5XG4gICAqXG4gICAqIEZpcmVkIHdoZW4gdGhlIHZpZGVvJ3MgdmlzaWJpbGl0eSBjaGFuZ2VzLiBOb3JtYWxseSBmaXJlZFxuICAgKiBmcm9tIGB2aWV3cG9ydENhbGxiYWNrYC5cbiAgICpcbiAgICogQGV2ZW50IGFtcDp2aWRlbzp2aXNpYmlsaXR5XG4gICAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gdmlzaWJsZSBXaGV0aGVyIHRoZSB2aWRlbyBwbGF5ZXIgaXMgdmlzaWJsZSBvciBub3QuXG4gICAqL1xuICBWSVNJQklMSVRZOiAnYW1wOnZpZGVvOnZpc2liaWxpdHknLFxuXG4gIC8qKlxuICAgKiByZWxvYWRcbiAgICpcbiAgICogRmlyZWQgd2hlbiB0aGUgdmlkZW8ncyBzcmMgY2hhbmdlcy5cbiAgICpcbiAgICogQGV2ZW50IHJlbG9hZGVkXG4gICAqL1xuICBSRUxPQUQ6ICdyZWxvYWRlZCcsXG5cbiAgLyoqXG4gICAqIHByZS9taWQvcG9zdCBBZCBzdGFydFxuICAgKlxuICAgKiBGaXJlZCB3aGVuIGFuIEFkIHN0YXJ0cyBwbGF5aW5nLlxuICAgKlxuICAgKiBUaGlzIGlzIHVzZWQgdG8gcmVtb3ZlIGFueSBvdmVybGF5IHNoaW1zIGR1cmluZyBBZCBwbGF5IGR1cmluZyBhdXRvcGxheVxuICAgKiBvciBtaW5pbWl6ZWQtdG8tY29ybmVyIHZlcnNpb24gb2YgdGhlIHBsYXllci5cbiAgICpcbiAgICogQGV2ZW50IGFkX3N0YXJ0XG4gICAqL1xuICBBRF9TVEFSVDogJ2FkX3N0YXJ0JyxcblxuICAvKipcbiAgICogcHJlL21pZC9wb3N0IEFkIGVuZHNcbiAgICpcbiAgICogRmlyZWQgd2hlbiBhbiBBZCBlbmRzIHBsYXlpbmcuXG4gICAqXG4gICAqIFRoaXMgaXMgdXNlZCB0byByZXN0b3JlIGFueSBvdmVybGF5IHNoaW1zIGR1cmluZyBBZCBwbGF5IGR1cmluZyBhdXRvcGxheVxuICAgKiBvciBtaW5pbWl6ZWQtdG8tY29ybmVyIHZlcnNpb24gb2YgdGhlIHBsYXllci5cbiAgICpcbiAgICogQGV2ZW50IGFkX2VuZFxuICAgKi9cbiAgQURfRU5EOiAnYWRfZW5kJyxcbn07XG5cblxuLyoqXG4gKiBQbGF5aW5nIFN0YXRlc1xuICpcbiAqIEludGVybmFsIHBsYXlpbmcgc3RhdGVzIHVzZWQgdG8gZGlzdGluZ3Vpc2ggYmV0d2VlbiB2aWRlbyBwbGF5aW5nIG9uIHVzZXInc1xuICogY29tbWFuZCBhbmQgdmlkZW9zIHBsYXlpbmcgYXV0b21hdGljYWxseVxuICpcbiAqIEBjb25zdGFudCB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59XG4gKi9cbmV4cG9ydCBjb25zdCBQbGF5aW5nU3RhdGVzID0ge1xuICAvKipcbiAgICogcGxheWluZ19tYW51YWxcbiAgICpcbiAgICogV2hlbiB0aGUgdmlkZW8gdXNlciBtYW51YWxseSBpbnRlcmFjdGVkIHdpdGggdGhlIHZpZGVvIGFuZCB0aGUgdmlkZW9cbiAgICogaXMgbm93IHBsYXlpbmdcbiAgICpcbiAgICogQGV2ZW50IHBsYXlpbmdfbWFudWFsXG4gICAqL1xuICBQTEFZSU5HX01BTlVBTDogJ3BsYXlpbmdfbWFudWFsJyxcblxuICAvKipcbiAgICogcGxheWluZ19hdXRvXG4gICAqXG4gICAqIFdoZW4gdGhlIHZpZGVvIGhhcyBhdXRvcGxheSBhbmQgdGhlIHVzZXIgaGFzbid0IGludGVyYWN0ZWQgd2l0aCBpdCB5ZXRcbiAgICpcbiAgICogQGV2ZW50IHBsYXlpbmdfYXV0b1xuICAgKi9cbiAgUExBWUlOR19BVVRPOiAncGxheWluZ19hdXRvJyxcblxuICAvKipcbiAgICogcGF1c2VkXG4gICAqXG4gICAqIFdoZW4gdGhlIHZpZGVvIGlzIHBhdXNlZC5cbiAgICpcbiAgICogQGV2ZW50IHBhdXNlZFxuICAgKi9cbiAgUEFVU0VEOiAncGF1c2VkJyxcbn07XG5cblxuLyoqIEBlbnVtIHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgVmlkZW9BbmFseXRpY3NFdmVudHMgPSB7XG4gIC8qKlxuICAgKiB2aWRlby1lbmRlZFxuICAgKlxuICAgKiBJbmRpY2F0ZXMgdGhhdCBhIHZpZGVvIGVuZGVkLlxuICAgKiBAcHJvcGVydHkgeyFWaWRlb0FuYWx5dGljc0RldGFpbHNEZWZ9IGRldGFpbHNcbiAgICogQGV2ZW50IHZpZGVvLWVuZGVkXG4gICAqL1xuICBFTkRFRDogJ3ZpZGVvLWVuZGVkJyxcblxuICAvKipcbiAgICogdmlkZW8tcGF1c2VcbiAgICpcbiAgICogSW5kaWNhdGVzIHRoYXQgYSB2aWRlbyBwYXVzZWQuXG4gICAqIEBwcm9wZXJ0eSB7IVZpZGVvQW5hbHl0aWNzRGV0YWlsc0RlZn0gZGV0YWlsc1xuICAgKiBAZXZlbnQgdmlkZW8tcGF1c2VcbiAgICovXG4gIFBBVVNFOiAndmlkZW8tcGF1c2UnLFxuXG4gIC8qKlxuICAgKiB2aWRlby1wbGF5XG4gICAqXG4gICAqIEluZGljYXRlcyB0aGF0IGEgdmlkZW8gYmVnYW4gdG8gcGxheS5cbiAgICogQHByb3BlcnR5IHshVmlkZW9BbmFseXRpY3NEZXRhaWxzRGVmfSBkZXRhaWxzXG4gICAqIEBldmVudCB2aWRlby1wbGF5XG4gICAqL1xuICBQTEFZOiAndmlkZW8tcGxheScsXG5cbiAgLyoqXG4gICAqIHZpZGVvLXNlc3Npb25cbiAgICpcbiAgICogSW5kaWNhdGVzIHRoYXQgc29tZSBzZWdtZW50IG9mIHRoZSB2aWRlbyBwbGF5ZWQuXG4gICAqIEBwcm9wZXJ0eSB7IVZpZGVvQW5hbHl0aWNzRGV0YWlsc0RlZn0gZGV0YWlsc1xuICAgKiBAZXZlbnQgdmlkZW8tc2Vzc2lvblxuICAgKi9cbiAgU0VTU0lPTjogJ3ZpZGVvLXNlc3Npb24nLFxuXG4gIC8qKlxuICAgKiB2aWRlby1zZXNzaW9uLXZpc2libGVcbiAgICpcbiAgICogSW5kaWNhdGVzIHRoYXQgc29tZSBzZWdtZW50IG9mIHRoZSB2aWRlbyBwbGF5ZWQgaW4gdGhlIHZpZXdwb3J0LlxuICAgKiBAcHJvcGVydHkgeyFWaWRlb0FuYWx5dGljc0RldGFpbHNEZWZ9IGRldGFpbHNcbiAgICogQGV2ZW50IHZpZGVvLXNlc3Npb24tdmlzaWJsZVxuICAgKi9cbiAgU0VTU0lPTl9WSVNJQkxFOiAndmlkZW8tc2Vzc2lvbi12aXNpYmxlJyxcblxuICAvKipcbiAgICogdmlkZW8tc2Vjb25kcy1wbGF5ZWRcbiAgICpcbiAgICogSW5kaWNhdGVzIHRoYXQgYSB2aWRlbyB3YXMgcGxheWluZyB3aGVuIHRoZVxuICAgKiB2aWRlby1zZWNvbmRzLXBsYXllZCBpbnRlcnZhbCBmaXJlZC5cbiAgICogQHByb3BlcnR5IHshVmlkZW9BbmFseXRpY3NEZXRhaWxzRGVmfSBkZXRhaWxzXG4gICAqIEBldmVudCB2aWRlby1zZXNzaW9uLXZpc2libGVcbiAgICovXG4gIFNFQ09ORFNfUExBWUVEOiAndmlkZW8tc2Vjb25kcy1wbGF5ZWQnLFxufTtcblxuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGF1dG9wbGF5OiBib29sZWFuLFxuICogICBjdXJyZW50VGltZTogbnVtYmVyLFxuICogICBkdXJhdGlvbjogbnVtYmVyLFxuICogICBoZWlnaHQ6IG51bWJlcixcbiAqICAgaWQ6IHN0cmluZyxcbiAqICAgcGxheWVkUmFuZ2VzSnNvbjogc3RyaW5nLFxuICogICBwbGF5ZWRUb3RhbDogbnVtYmVyLFxuICogICBtdXRlZDogYm9vbGVhbixcbiAqICAgc3RhdGU6IHN0cmluZyxcbiAqICAgd2lkdGg6IG51bWJlclxuICogfX1cbiAqL1xuZXhwb3J0IGxldCBWaWRlb0FuYWx5dGljc0RldGFpbHNEZWY7XG5cblxuLyoqXG4gKiBIZWxwZXIgdW5pb24gdHlwZSB0byBiZSB1c2VkIGludGVybmFsbHksIHNvIHRoYXQgdGhlIGNvbXBpbGVyIHRyZWF0c1xuICogYFZpZGVvSW50ZXJmYWNlYCBvYmplY3RzIGFzIGBCYXNlRWxlbWVudGBzLCB3aGljaCB0aGV5IHNob3VsZCBiZSBhbnl3YXkuXG4gKlxuICogV0FSTklORzogRG9uJ3QgdXNlIHRoaXMgYXQgdGhlIHNlcnZpY2UgbGV2ZWwuIEl0cyBgcmVnaXN0ZXJgIG1ldGhvZCBzaG91bGRcbiAqIG9ubHkgYWxsb3cgYFZpZGVvSW50ZXJmYWNlYCBhcyBhIGd1YXJkaW5nIG1lYXN1cmUuXG4gKlxuICogQHR5cGVkZWYgeyFWaWRlb0ludGVyZmFjZXwhLi9iYXNlLWVsZW1lbnQuQmFzZUVsZW1lbnR9XG4gKi9cbmV4cG9ydCBsZXQgVmlkZW9PckJhc2VFbGVtZW50RGVmO1xuIiwiLyohIGh0dHBzOi8vbXRocy5iZS9jc3Nlc2NhcGUgdjEuNS4xIGJ5IEBtYXRoaWFzIHwgTUlUIGxpY2Vuc2UgKi9cblxuXG4vKipcbiAqIFRoaXMgcmVnZXggY29uc2lzdHMgb2YgNCBtYXRjaGluZyBjYXB0dXJlIGdyb3VwcyBhbmQgb25lIChub24tbWF0Y2hpbmcpIGZhbGxiYWNrOlxuICpcbiAqIC0gKFxcMCksIGNhdGNoIHRoZSBudWxsIHRlcm1pbmF0b3IgY2hhcmFjdGVyIHNvIGl0IG1heSBiZSByZXBsYWNlZCBieSBVVEZcbiAqICAgUmVwbGFjZW1lbnQgQ2hhclxuICogLSBeKC0pJCwgY2F0Y2ggYSBzb2xpdGFyeSBkYXNoIGNoYXIsIHNvIHRoYXQgaXQgbWF5IGJlIGJhY2tzbGFzaCBlc2NhcGVkLlxuICogICBUaGlzIGlzIGEgc2VwYXJhdGUgY2FwdHVyZSBncm91cCBzbyB0aGF0IHRoZSBsZWdhbC1jaGFycyAoZ3JvdXAgNCkgZG9lc24ndFxuICogICBjYXB0dXJlIGl0IGZpcnN0LCBzaW5jZSB0aGF0IGdyb3VwIGRvZXNuJ3QgbmVlZCB0byBlc2NhcGUgaXRzIGRhc2guXG4gKiAtIChbXFx4MDEtXFx4MWZcXHg3Zl18Xi0/WzAtOV0pLCBjYXRjaCBhIFVURiBjb250cm9sIGNoYXIsIG9yIGFueSBsZWFkaW5nXG4gKiAgIG51bWJlciAod2l0aCBhbiBvcHRpb25hbCBsZWFkaW5nIGRhc2gpLiBUaGUgY29udHJvbCBvciB0aGUgbnVtYmVyIChidXQgbm90XG4gKiAgIHRoZSBsZWFkaW5nIGRhc2gpIG11c3QgYmUgaGV4LWVzY2FwZWQsLlxuICogLSAoW1xceDgwLVxcdWZmZmYwLTlhLXpBLVpfLV0rKSwgY2F0Y2ggbGVnYWwtY2hhcnMsIHdpdGggdGhlIGV4Y2VwdGlvbiBvZiBhXG4gKiAgIHNvbGl0YXJ5IGRhc2gsIHdoaWNoIHdpbGwgYWxyZWFkeSBoYXZlIG1hdGNoZWQgaW4gZ3JvdXAgMS5cbiAqIC0gW15dLCBmaW5hbGx5LCBhIGNhdGNoLWFsbCB0aGF0IGFsbG93cyB1cyB0byBiYWNrc2xhc2ggZXNjYXBlIHRoZSBjaGFyLlxuICpcbiAqIFRvZ2V0aGVyLCB0aGlzIG1hdGNoZXMgZXZlcnl0aGluZyBuZWNlc3NhcnkgZm9yIENTUy5lc2NhcGUuXG4gKi9cbnZhciByZWdleCA9IC8oXFwwKXxeKC0pJHwoW1xceDAxLVxceDFmXFx4N2ZdfF4tP1swLTldKXwoW1xceDgwLVxcdWZmZmYwLTlhLXpBLVpfLV0rKXxbXl0vZztcblxuZnVuY3Rpb24gZXNjYXBlcihtYXRjaCwgbmlsLCBkYXNoLCBoZXhFc2NhcGUsIGNoYXJzKSB7XG4gIC8vIENoYXJzIGlzIHRoZSBsZWdhbC1jaGFycyAoZ3JvdXAgNCkgY2FwdHVyZVxuICBpZiAoY2hhcnMpIHtcbiAgICByZXR1cm4gY2hhcnM7XG4gIH1cbiAgLy8gTmlsIGlzIHRoZSBudWxsIHRlcm1pbmF0b3IgKGdyb3VwIDEpIGNhcHR1cmVcbiAgaWYgKG5pbCkge1xuICAgIHJldHVybiAnXFx1RkZGRCc7XG4gIH1cbiAgLy8gQm90aCBVVEYgY29udHJvbCBjaGFycywgYW5kIGxlYWRpbmcgbnVtYmVycyAod2l0aCBvcHRpb25hbCBsZWFkaW5nIGRhc2gpXG4gIC8vIChncm91cCAzKSBtdXN0IGJlIGJhY2tzbGFzaCBlc2NhcGVkIHdpdGggYSB0cmFpbGluZyBzcGFjZS4gIEZ1bm5pbHksIHRoZVxuICAvLyBsZWFkaW5nIGRhc2ggbXVzdCBub3QgYmUgZXNjYXBlZCwgYnV0IHRoZSBudW1iZXIuIDpzaHJ1ZzpcbiAgaWYgKGhleEVzY2FwZSkge1xuICAgIHJldHVybiBtYXRjaC5zbGljZSgwLCAtMSkgKyAnXFxcXCcgKyBtYXRjaC5zbGljZSgtMSkuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikgKyAnICdcbiAgfVxuICAvLyBGaW5hbGx5LCB0aGUgc29saXRhcnkgZGFzaCBhbmQgdGhlIGNhdGNoLWFsbCBjaGFycyByZXF1aXJlIGJhY2tzbGFzaFxuICAvLyBlc2NhcGluZy5cbiAgcmV0dXJuICdcXFxcJyArIG1hdGNoO1xufVxuXG4vKipcbiAqIGh0dHBzOi8vZHJhZnRzLmNzc3dnLm9yZy9jc3NvbS8jc2VyaWFsaXplLWFuLWlkZW50aWZpZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3NzRXNjYXBlKHZhbHVlKSB7XG4gIHJldHVybiBTdHJpbmcodmFsdWUpLnJlcGxhY2UocmVnZXgsIGVzY2FwZXIpO1xufVxuIl19"}