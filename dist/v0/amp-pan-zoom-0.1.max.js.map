{"version":3,"sources":["node_modules/browser-pack/_prelude.js","build/amp-pan-zoom-0.1.css.js","extensions/amp-pan-zoom/0.1/amp-pan-zoom.js","node_modules/document-register-element/build/document-register-element.patched.js","node_modules/promise-pjs/promise.js","src/action-constants.js","src/animation.js","src/config.js","src/cookies.js","src/curve.js","src/dom.js","src/element-service.js","src/event-helper-listen.js","src/event-helper.js","src/experiments.js","src/gesture-recognizers.js","src/gesture.js","src/layout-rect.js","src/layout.js","src/log.js","src/mode-object.js","src/mode.js","src/motion.js","src/observable.js","src/pass.js","src/polyfills.js","src/polyfills/array-includes.js","src/polyfills/custom-elements.js","src/polyfills/document-contains.js","src/polyfills/domtokenlist-toggle.js","src/polyfills/math-sign.js","src/polyfills/object-assign.js","src/polyfills/promise.js","src/service.js","src/services.js","src/static-template.js","src/string.js","src/style.js","src/time.js","src/transition.js","src/types.js","src/url-parse-query-string.js","src/url-try-decode-uri-component.js","src/url.js","src/utils/array.js","src/utils/lru-cache.js","src/utils/math.js","src/utils/object.js","src/utils/promise.js","third_party/css-escape/css-escape.js"],"names":[],"mappings":"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;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACn6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACngBA;;;;;;;;;;;;;;;;AAgBA;;;;;;;;;;;;AAYO,IAAM,oDAAsB,uBAA5B;;AAEP;;;;;;;;AAQO,IAAM,oCAAc;AACzB,OAAK,CADoB;AAEzB,QAAM;AAFmB,C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","file":"amp-pan-zoom-0.1.max.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","export const CSS = \".i-amphtml-pan-zoom{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.i-amphtml-pan-zoom-child{position:absolute}\\n/*# sourceURL=/extensions/amp-pan-zoom/0.1/amp-pan-zoom.css*/\";\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ActionTrust} from '../../../src/action-constants';\nimport {Animation} from '../../../src/animation';\nimport {CSS} from '../../../build/amp-pan-zoom-0.1.css';\nimport {\n  DoubletapRecognizer,\n  PinchRecognizer,\n  SwipeXYRecognizer,\n  TapRecognizer,\n} from '../../../src/gesture-recognizers';\nimport {Gestures} from '../../../src/gesture';\nimport {Layout} from '../../../src/layout';\nimport {Services} from '../../../src/services';\nimport {bezierCurve} from '../../../src/curve';\nimport {clamp} from '../../../src/utils/math';\nimport {continueMotion} from '../../../src/motion';\nimport {createCustomEvent} from '../../../src/event-helper';\nimport {dev, user} from '../../../src/log';\nimport {\n  layoutRectFromDomRect,\n  layoutRectLtwh,\n} from '../../../src/layout-rect';\nimport {numeric} from '../../../src/transition';\n\nimport {dict} from '../../../src/utils/object';\nimport {px, scale, setStyles, translate} from '../../../src/style';\n\nconst PAN_ZOOM_CURVE_ = bezierCurve(0.4, 0, 0.2, 1.4);\nconst TAG = 'amp-pan-zoom';\nconst DEFAULT_MAX_SCALE = 3;\nconst MAX_ANIMATION_DURATION = 250;\n\n\nconst ELIGIBLE_TAGS = {\n  'svg': true,\n  'DIV': true,\n  'AMP-IMG': true,\n  'AMP-LAYOUT': true,\n};\n\nconst SUPPORT_VALIDATION_MSG = `${TAG} should\n  have its target element as the one and only child`;\n\n/**\n * @extends {AMP.BaseElement}\n */\nexport class AmpPanZoom extends AMP.BaseElement {\n  // TODO (#15685): refactor this to share code with amp-image-viewer\n\n  /** @param {!AmpElement} element */\n  constructor(element) {\n\n    super(element);\n\n    /** @private {?Element} */\n    this.content_ = null;\n\n    /** @private {?../../../src/service/action-impl.ActionService} */\n    this.action_ = null;\n\n    /** @private {number} */\n    this.sourceWidth_ = 0;\n\n    /** @private {number} */\n    this.sourceHeight_ = 0;\n\n    /** @private {?../../../src/layout-rect.LayoutRectDef} */\n    this.elementBox_ = null;\n\n    /** @private {?../../../src/layout-rect.LayoutRectDef} */\n    this.contentBox_ = null;\n\n    /** @private {?UnlistenDef} */\n    this.unlistenOnSwipePan_ = null;\n\n    /** @private */\n    this.scale_ = 1;\n\n    /** @private */\n    this.startScale_ = 1;\n\n    /** @private */\n    this.minScale_ = 1;\n\n    /** @private */\n    this.maxScale_ = DEFAULT_MAX_SCALE;\n\n    /** @private */\n    this.initialX_ = 0;\n\n    /** @private */\n    this.initialY_ = 0;\n\n    /** @private */\n    this.initialScale_ = 1;\n\n    /** @private */\n    this.startX_ = 0;\n\n    /** @private */\n    this.startY_ = 0;\n\n    /** @private */\n    this.posX_ = 0;\n\n    /** @private */\n    this.posY_ = 0;\n\n    /** @private */\n    this.minX_ = 0;\n\n    /** @private */\n    this.minY_ = 0;\n\n    /** @private */\n    this.maxX_ = 0;\n\n    /** @private */\n    this.maxY_ = 0;\n\n    /** @private {?../../../src/gesture.Gestures} */\n    this.gestures_ = null;\n\n    /** @private {?../../../src/motion.Motion} */\n    this.motion_ = null;\n\n    /** @private */\n    this.resetOnResize_ = false;\n  }\n\n  /** @override */\n  buildCallback() {\n    this.action_ = Services.actionServiceForDoc(this.element);\n    const children = this.getRealChildren();\n\n    user().assert(children.length == 1, SUPPORT_VALIDATION_MSG);\n    user().assert(\n        this.elementIsSupported_(children[0]),\n        children[0].tagName + ` is not supported by ${TAG}`\n    );\n    this.element.classList.add('i-amphtml-pan-zoom');\n    this.content_ = children[0];\n    this.content_.classList.add('i-amphtml-pan-zoom-child');\n    this.maxScale_ = this.getNumberAttributeOr_('max-scale', DEFAULT_MAX_SCALE);\n    this.initialScale_ = this.getNumberAttributeOr_('initial-scale', 1);\n    this.initialX_ = this.getNumberAttributeOr_('initial-x', 0);\n    this.initialY_ = this.getNumberAttributeOr_('initial-y', 0);\n    this.resetOnResize_ = this.element.hasAttribute('reset-on-resize');\n\n    this.registerAction('transform', invocation => {\n      const {args} = invocation;\n      if (!args) {\n        return;\n      }\n      const scale = args['scale'] || 1;\n      this.updatePanZoomBounds_(scale);\n      const x = this.boundX_(args['x'] || 0, /*allowExtent*/ false);\n      const y = this.boundY_(args['y'] || 0, /*allowExtent*/ false);\n      return this.set_(scale, x, y, /*animate*/ true)\n          .then(() => this.onZoomRelease_());\n    });\n  }\n\n  /** @override */\n  onMeasureChanged() {\n    if (this.resetOnResize_) {\n      this.resetContentDimensions_();\n    }\n  }\n\n  /** @override */\n  layoutCallback() {\n    return this.resetContentDimensions_().then(this.setupGestures_());\n  }\n\n  /** @override */\n  pauseCallback() {\n    this.resetContentDimensions_();\n    this.cleanupGestures_();\n  }\n\n  /** @override */\n  resumeCallback() {\n    if (this.content_) {\n      this.scheduleLayout(this.content_);\n    }\n    this.setupGestures_();\n  }\n\n  /** @override */\n  unlayoutCallback() {\n    this.cleanupGestures_();\n    return true;\n  }\n\n  /** @override */\n  isLayoutSupported(layout) {\n    return layout == Layout.FIXED ||\n      layout == Layout.FIXED_HEIGHT ||\n      layout == Layout.FILL ||\n      layout == Layout.RESPONSIVE;\n  }\n\n  /**\n   * Checks to see if an element is supported.\n   * @param {Element} element\n   * @return {boolean}\n   * @private\n   */\n  elementIsSupported_(element) {\n    return ELIGIBLE_TAGS[element.tagName];\n  }\n\n  /**\n   * Tries to retrieve a number attribute, returns a default value\n   * if unsuccessful.\n   * @param {string} attribute\n   * @param {number} defaultValue\n   * @return {number}\n   * @private\n   */\n  getNumberAttributeOr_(attribute, defaultValue) {\n    const {element} = this;\n    return element.hasAttribute(attribute)\n      ? parseInt(element.getAttribute(attribute), 10)\n      : defaultValue;\n  }\n\n  /**\n   * Measures the content viewer and content sizes and positioning.\n   * This must be called AFTER the source element has already been\n   * laid out.\n   * @private\n   */\n  measure_() {\n    this.sourceWidth_ = this.content_./*OK*/scrollWidth;\n    this.sourceHeight_ = this.content_./*OK*/scrollHeight;\n\n    this.elementBox_ = layoutRectFromDomRect(this.element\n        ./*OK*/getBoundingClientRect());\n\n    const sourceAspectRatio = this.sourceWidth_ / this.sourceHeight_;\n    let height = Math.min(this.elementBox_.width / sourceAspectRatio,\n        this.elementBox_.height);\n    let width = Math.min(this.elementBox_.height * sourceAspectRatio,\n        this.elementBox_.width);\n\n    if (Math.abs(width - this.sourceWidth_) <= 16\n    && Math.abs(height - this.sourceHeight_ <= 16)) {\n      width = this.sourceWidth_;\n      height = this.sourceHeight_;\n    }\n\n    this.contentBox_ = layoutRectLtwh(\n        Math.round((this.elementBox_.width - width) / 2),\n        Math.round((this.elementBox_.height - height) / 2),\n        Math.round(width),\n        Math.round(height));\n\n    // Adjust max scale to at least fit the screen.\n    const elementBoxRatio = this.elementBox_.width /\n     this.elementBox_.height;\n    const maxScale = Math.max(\n        elementBoxRatio / sourceAspectRatio,\n        sourceAspectRatio / elementBoxRatio\n    );\n    this.maxScale_ = Math.max(this.maxScale_, maxScale);\n\n    // Reset zoom and pan.\n    this.startScale_ = this.scale_ = this.initialScale_;\n    this.startX_ = this.posX_ = this.initialX_;\n    this.startY_ = this.posY_ = this.initialY_;\n    this.updatePanZoomBounds_(this.scale_);\n  }\n\n  /**\n   * Measures and resets the content dimensions, after the element\n   * dimensions changes.\n   * @return {!Promise}\n   */\n  resetContentDimensions_() {\n    const content = dev().assertElement(this.content_);\n    return this.measureElement(() => this.measure_()).then(() => {\n      return this.mutateElement(() => {\n        // Set the actual dimensions of the content\n        setStyles(content, {\n          width: px(this.contentBox_.width),\n          height: px(this.contentBox_.height),\n        });\n        // Update translation and scaling\n        this.updatePanZoom_();\n      }, content);\n    });\n  }\n\n  /** @private */\n  cleanupGestures_() {\n    if (this.gestures_) {\n      this.gestures_.cleanup();\n      this.gestures_ = null;\n    }\n  }\n\n  /**\n   * Given a x offset relative to the viewport, return the x offset\n   * relative to the amp-pan-zoom component.\n   * @param {number} clientX\n   */\n  getOffsetX_(clientX) {\n    const {left} = this.elementBox_;\n    return (left - this.getViewport().getScrollLeft()) - clientX;\n  }\n\n  /**\n   * Given a y offset relative to the viewport, return the y offset\n   * relative to the amp-pan-zoom component.\n   * @param {number} clientY\n   */\n  getOffsetY_(clientY) {\n    const {top} = this.elementBox_;\n    return (top - this.getViewport().getScrollTop()) - clientY;\n  }\n\n  /** @private */\n  setupGestures_() {\n    if (this.gestures_) {\n      return;\n    }\n    // TODO (#12881): this and the subsequent use of event.preventDefault\n    // is a temporary solution to #12362. We should revisit this problem after\n    // resolving #12881 or change the use of window.event to the specific event\n    // triggering the gesture.\n    this.gestures_ = Gestures.get(\n        this.element,\n        /* opt_shouldNotPreventDefault */ false\n    );\n\n    this.gestures_.onPointerDown(() => {\n      if (this.motion_) {\n        this.motion_.halt();\n      }\n    });\n\n    // Zoomable.\n    this.gestures_.onGesture(DoubletapRecognizer, e => {\n      const {clientX, clientY} = e.data;\n      const newScale = this.scale_ == 1 ? this.maxScale_ : this.minScale_;\n      const deltaX = (this.elementBox_.width / 2) + this.getOffsetX_(clientX);\n      const deltaY = (this.elementBox_.height / 2) + this.getOffsetY_(clientY);\n\n      this.onZoom_(newScale, deltaX, deltaY, /*animate*/ true)\n          .then(() => this.onZoomRelease_());\n    });\n\n    this.gestures_.onGesture(PinchRecognizer, e => {\n      const {\n        centerClientX,\n        centerClientY,\n        deltaX,\n        deltaY,\n        dir,\n        last,\n      } = e.data;\n\n      this.onPinchZoom_(centerClientX, centerClientY, deltaX, deltaY, dir);\n      if (last) {\n        this.onZoomRelease_();\n      }\n    });\n\n    // Override all taps to enable tap events on content\n    this.gestures_.onGesture(TapRecognizer, e => {\n      const event = createCustomEvent(this.win, 'click', null, {bubbles: true});\n      e.data.target.dispatchEvent(event);\n    });\n  }\n\n  /**\n   * Registers a Swipe gesture to handle panning when the content is zoomed.\n   * @private\n   */\n  registerPanningGesture_() {\n    // Movable.\n    this.unlistenOnSwipePan_ = this.gestures_\n        .onGesture(SwipeXYRecognizer, e => {\n          event.preventDefault();\n          const {\n            deltaX,\n            deltaY,\n            last,\n            velocityX,\n            velocityY,\n          } = e.data;\n          this.onMove_(deltaX, deltaY, /*animate*/ false);\n          if (last) {\n            this.onMoveRelease_(velocityX, velocityY);\n          }\n        });\n  }\n\n  /**\n   * Deregisters the Swipe gesture for panning when the content is zoomed out.\n   * @private\n   */\n  unregisterPanningGesture_() {\n    if (this.unlistenOnSwipePan_) {\n      this.unlistenOnSwipePan_();\n      this.unlistenOnSwipePan_ = null;\n      this.gestures_.removeGesture(SwipeXYRecognizer);\n    }\n  }\n\n  /**\n   * Returns value bound to min and max values +/- extent.\n   * @param {number} value\n   * @param {number} min\n   * @param {number} max\n   * @param {number} extent\n   * @return {number}\n   * @private\n   */\n  boundValue_(value, min, max, extent) {\n    return clamp(value, min - extent, max + extent);\n  }\n\n  /**\n   * Returns the scale within the allowed range with possible extent.\n   * @param {number} s\n   * @param {boolean} allowExtent\n   * @return {number}\n   * @private\n   */\n  boundScale_(s, allowExtent) {\n    const extent = allowExtent ? 0.25 : 0;\n    return this.boundValue_(s, this.minScale_, this.maxScale_, extent);\n  }\n\n  /**\n   * Returns the X position within the allowed range with possible extent.\n   * @param {number} x\n   * @param {boolean} allowExtent\n   * @return {number}\n   * @private\n   */\n  boundX_(x, allowExtent) {\n    const maxExtent = this.elementBox_.width * 0.25;\n    const extent = allowExtent && this.scale_ > 1 ? maxExtent : 0;\n    return this.boundValue_(x, this.minX_, this.maxX_, extent);\n  }\n\n  /**\n   * Returns the Y position within the allowed range with possible extent.\n   * @param {number} y\n   * @param {boolean} allowExtent\n   * @return {number}\n   * @private\n   */\n  boundY_(y, allowExtent) {\n    const maxExtent = this.elementBox_.height * 0.25;\n    const extent = allowExtent && this.scale_ > 1 ? maxExtent : 0;\n    return this.boundValue_(y, this.minY_, this.maxY_, extent);\n  }\n\n  /**\n   * Updates X/Y bounds based on the provided scale value. The min/max bounds\n   * are calculated to allow full pan of the content regardless of the scale\n   * value.\n   * @param {number} scale\n   * @private\n   */\n  updatePanZoomBounds_(scale) {\n    const dh = this.elementBox_.height - (this.contentBox_.height * scale);\n    const dw = this.elementBox_.width - (this.contentBox_.width * scale);\n\n    const minY = dh >= 0 ? 0 : dh / 2;\n    const maxY = dh >= 0 ? 0 : -minY;\n    const minX = dw >= 0 ? 0 : dw / 2;\n    const maxX = dw >= 0 ? 0 : -minX;\n\n    this.minX_ = minX;\n    this.minY_ = minY;\n    this.maxX_ = maxX;\n    this.maxY_ = maxY;\n  }\n\n  /**\n   * Updates pan/zoom of the content based on the current values.\n   * @private\n   */\n  updatePanZoom_() {\n    const {scale_: s, posX_: x, posY_: y, content_: content} = this;\n    this.mutateElement(() => {\n      setStyles(dev().assertElement(content), {\n        transform: translate(x, y) + ' ' + scale(s),\n      });\n    }, content);\n  }\n\n  /**\n   * @param {number} scale\n   * @param {number} x\n   * @param {number} y\n   * @private\n   */\n  triggerTransformEnd_(scale, x, y) {\n    const transformEndEvent =\n    createCustomEvent(this.win, `${TAG}.transformEnd`, dict({\n      'scale': scale,\n      'x': x,\n      'y': y,\n    }));\n    this.action_.trigger(this.element, 'transformEnd', transformEndEvent,\n        ActionTrust.HIGH);\n  }\n\n  /**\n   * Performs a one-step or an animated motion (panning).\n   * @param {number} deltaX\n   * @param {number} deltaY\n   * @param {boolean} animate\n   * @private\n   */\n  onMove_(deltaX, deltaY, animate) {\n    const newPosX = this.boundX_(this.startX_ + deltaX, false);\n    const newPosY = this.boundY_(this.startY_ + deltaY, false);\n    this.set_(this.scale_, newPosX, newPosY, animate);\n  }\n\n  /**\n   * Performs actions once the motion gesture has been complete. The motion\n   * may continue based on the final velocity.\n   * @param {number} veloX\n   * @param {number} veloY\n   * @private\n   */\n  onMoveRelease_(veloX, veloY) {\n    // Continue motion.\n    this.motion_ = continueMotion(dev().assertElement(this.content_),\n        this.posX_, this.posY_, veloX, veloY,\n        (x, y) => {\n          const newPosX = this.boundX_(x, false);\n          const newPosY = this.boundY_(y, false);\n          if (Math.abs(newPosX - this.posX_) < 1 &&\n                Math.abs(newPosY - this.posY_) < 1) {\n            // Hit the wall: stop motion.\n            return false;\n          }\n          this.set_(this.scale_, newPosX, newPosY, false);\n          return true;\n        });\n\n    // Snap back.\n    this.motion_.thenAlways(() => {\n      this.motion_ = null;\n      return this.release_();\n    });\n  }\n\n  /**\n   * Performs a one-step pinch zoom action.\n   * @param {number} centerClientX\n   * @param {number} centerClientY\n   * @param {number} deltaX\n   * @param {number} deltaY\n   *  @param {number} dir\n   * @private\n   */\n  onPinchZoom_(centerClientX, centerClientY, deltaX, deltaY, dir) {\n    this.zoomToPoint_(centerClientX, centerClientY, deltaX, deltaY, dir);\n  }\n\n  /**\n   * Given center position, zoom delta, and zoom position, computes\n   * and updates a zoom action on the content.\n   * @param {number} centerClientX\n   * @param {number} centerClientY\n   * @param {number} deltaX\n   * @param {number} deltaY\n   * @param {number} dir\n   * @private\n   */\n  zoomToPoint_(centerClientX, centerClientY, deltaX, deltaY, dir) {\n    if (dir == 0) {\n      return;\n    }\n    const dist = Math.sqrt((deltaX * deltaX) + (deltaY * deltaY));\n    const newScale = this.startScale_ * (1 + (dir * dist / 100));\n    const deltaCenterX = (this.elementBox_.width / 2) - centerClientX;\n    const deltaCenterY = (this.elementBox_.height / 2) - centerClientY;\n    deltaX = Math.min(deltaCenterX, deltaCenterX * (dist / 100));\n    deltaY = Math.min(deltaCenterY, deltaCenterY * (dist / 100));\n    this.onZoom_(newScale, deltaX, deltaY, /*animate*/ false);\n  }\n\n  /**\n   * Performs a one-step or an animated zoom action.\n   * @param {number} scale\n   * @param {number} deltaX\n   * @param {number} deltaY\n   * @param {boolean} animate\n   * @return {!Promise}\n   * @private\n   */\n  onZoom_(scale, deltaX, deltaY, animate) {\n    const newScale = this.boundScale_(scale, true);\n    if (newScale == this.scale_) {\n      return Promise.resolve();\n    }\n\n    this.updatePanZoomBounds_(newScale);\n\n    const newPosX = this.boundX_(this.startX_ + (deltaX * newScale), false);\n    const newPosY = this.boundY_(this.startY_ + (deltaY * newScale), false);\n    return this.set_(newScale, newPosX, newPosY, animate);\n  }\n\n  /**\n   * Performs actions after the gesture that was performing zooming has been\n   * released.\n   * @return {!Promise}\n   * @private\n   */\n  onZoomRelease_() {\n    return this.release_().then(() => {\n      // After the scale is updated, also register or unregister panning\n      if (this.scale_ <= 1) {\n        this.unregisterPanningGesture_();\n      } else {\n        this.registerPanningGesture_();\n      }\n    });\n  }\n\n  /**\n   * Sets or animates pan/zoom parameters.\n   * @param {number} newScale\n   * @param {number} newPosX\n   * @param {number} newPosY\n   * @param {boolean} animate\n   * @return {!Promise}\n   * @private\n   */\n  set_(newScale, newPosX, newPosY, animate) {\n    const ds = newScale - this.scale_;\n    const dx = newPosX - this.posX_;\n    const dy = newPosY - this.posY_;\n    const dist = Math.sqrt((dx * dx) + (dy * dy));\n\n    const dur = animate ?\n      Math.min(1, Math.max(\n          dist * 0.01, // Distance\n          Math.abs(ds) // Change in scale\n      )) * MAX_ANIMATION_DURATION : 0;\n\n    if (dur > 16 && animate) {\n      const scaleFunc = numeric(this.scale_, newScale);\n      const xFunc = numeric(this.posX_, newPosX);\n      const yFunc = numeric(this.posY_, newPosY);\n      return Animation.animate(dev().assertElement(this.content_), time => {\n        this.scale_ = scaleFunc(time);\n        this.posX_ = xFunc(time);\n        this.posY_ = yFunc(time);\n        this.updatePanZoom_();\n      }, dur, PAN_ZOOM_CURVE_).thenAlways(() => {\n        this.scale_ = newScale;\n        this.posX_ = newPosX;\n        this.posY_ = newPosY;\n        this.updatePanZoom_();\n        this.triggerTransformEnd_(newScale, newPosX, newPosY);\n      });\n    } else {\n      this.scale_ = newScale;\n      this.posX_ = newPosX;\n      this.posY_ = newPosY;\n      this.updatePanZoom_();\n      return Promise.resolve();\n    }\n  }\n\n  /**\n   * Sets or animates pan/zoom parameters after release of the gesture.\n   * @return {!Promise}\n   * @private\n   */\n  release_() {\n    const newScale = this.boundScale_(this.scale_, false);\n    if (newScale != this.scale_) {\n      this.updatePanZoomBounds_(newScale);\n    }\n    const newPosX = this.boundX_(this.posX_ / this.scale_ * newScale, false);\n    const newPosY = this.boundY_(this.posY_ / this.scale_ * newScale, false);\n    return this.set_(newScale, newPosX, newPosY, true).then(() => {\n      this.startScale_ = this.scale_;\n      this.startX_ = this.posX_;\n      this.startY_ = this.posY_;\n      this.triggerTransformEnd_(this.scale_, this.posX_, this.posY_);\n    });\n  }\n}\n\nAMP.extension(TAG, '0.1', AMP => {\n  AMP.registerElement(TAG, AmpPanZoom, CSS);\n});\n","/*!\n\nCopyright (C) 2014-2016 by Andrea Giammarchi - @WebReflection\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n\n*/\n// global window Object\n// optional polyfill info\n//    'auto' used by default, everything is feature detected\n//    'force' use the polyfill even if not fully needed\nfunction installCustomElements(window, polyfill) {'use strict';\n\n  // DO NOT USE THIS FILE DIRECTLY, IT WON'T WORK\n  // THIS IS A PROJECT BASED ON A BUILD SYSTEM\n  // THIS FILE IS JUST WRAPPED UP RESULTING IN\n  // build/document-register-element.node.js\n\n  var\n    document = window.document,\n    Object = window.Object\n  ;\n\n  var htmlClass = (function (info) {\n    // (C) Andrea Giammarchi - @WebReflection - MIT Style\n    var\n      catchClass = /^[A-Z]+[a-z]/,\n      filterBy = function (re) {\n        var arr = [], tag;\n        for (tag in register) {\n          if (re.test(tag)) arr.push(tag);\n        }\n        return arr;\n      },\n      add = function (Class, tag) {\n        tag = tag.toLowerCase();\n        if (!(tag in register)) {\n          register[Class] = (register[Class] || []).concat(tag);\n          register[tag] = (register[tag.toUpperCase()] = Class);\n        }\n      },\n      register = (Object.create || Object)(null),\n      htmlClass = {},\n      i, section, tags, Class\n    ;\n    for (section in info) {\n      for (Class in info[section]) {\n        tags = info[section][Class];\n        register[Class] = tags;\n        for (i = 0; i < tags.length; i++) {\n          register[tags[i].toLowerCase()] =\n          register[tags[i].toUpperCase()] = Class;\n        }\n      }\n    }\n    htmlClass.get = function get(tagOrClass) {\n      return typeof tagOrClass === 'string' ?\n        (register[tagOrClass] || (catchClass.test(tagOrClass) ? [] : '')) :\n        filterBy(tagOrClass);\n    };\n    htmlClass.set = function set(tag, Class) {\n      return (catchClass.test(tag) ?\n        add(tag, Class) :\n        add(Class, tag)\n      ), htmlClass;\n    };\n    return htmlClass;\n  }({\n    \"collections\": {\n      \"HTMLAllCollection\": [\n        \"all\"\n      ],\n      \"HTMLCollection\": [\n        \"forms\"\n      ],\n      \"HTMLFormControlsCollection\": [\n        \"elements\"\n      ],\n      \"HTMLOptionsCollection\": [\n        \"options\"\n      ]\n    },\n    \"elements\": {\n      \"Element\": [\n        \"element\"\n      ],\n      \"HTMLAnchorElement\": [\n        \"a\"\n      ],\n      \"HTMLAppletElement\": [\n        \"applet\"\n      ],\n      \"HTMLAreaElement\": [\n        \"area\"\n      ],\n      \"HTMLAttachmentElement\": [\n        \"attachment\"\n      ],\n      \"HTMLAudioElement\": [\n        \"audio\"\n      ],\n      \"HTMLBRElement\": [\n        \"br\"\n      ],\n      \"HTMLBaseElement\": [\n        \"base\"\n      ],\n      \"HTMLBodyElement\": [\n        \"body\"\n      ],\n      \"HTMLButtonElement\": [\n        \"button\"\n      ],\n      \"HTMLCanvasElement\": [\n        \"canvas\"\n      ],\n      \"HTMLContentElement\": [\n        \"content\"\n      ],\n      \"HTMLDListElement\": [\n        \"dl\"\n      ],\n      \"HTMLDataElement\": [\n        \"data\"\n      ],\n      \"HTMLDataListElement\": [\n        \"datalist\"\n      ],\n      \"HTMLDetailsElement\": [\n        \"details\"\n      ],\n      \"HTMLDialogElement\": [\n        \"dialog\"\n      ],\n      \"HTMLDirectoryElement\": [\n        \"dir\"\n      ],\n      \"HTMLDivElement\": [\n        \"div\"\n      ],\n      \"HTMLDocument\": [\n        \"document\"\n      ],\n      \"HTMLElement\": [\n        \"element\",\n        \"abbr\",\n        \"address\",\n        \"article\",\n        \"aside\",\n        \"b\",\n        \"bdi\",\n        \"bdo\",\n        \"cite\",\n        \"code\",\n        \"command\",\n        \"dd\",\n        \"dfn\",\n        \"dt\",\n        \"em\",\n        \"figcaption\",\n        \"figure\",\n        \"footer\",\n        \"header\",\n        \"i\",\n        \"kbd\",\n        \"mark\",\n        \"nav\",\n        \"noscript\",\n        \"rp\",\n        \"rt\",\n        \"ruby\",\n        \"s\",\n        \"samp\",\n        \"section\",\n        \"small\",\n        \"strong\",\n        \"sub\",\n        \"summary\",\n        \"sup\",\n        \"u\",\n        \"var\",\n        \"wbr\"\n      ],\n      \"HTMLEmbedElement\": [\n        \"embed\"\n      ],\n      \"HTMLFieldSetElement\": [\n        \"fieldset\"\n      ],\n      \"HTMLFontElement\": [\n        \"font\"\n      ],\n      \"HTMLFormElement\": [\n        \"form\"\n      ],\n      \"HTMLFrameElement\": [\n        \"frame\"\n      ],\n      \"HTMLFrameSetElement\": [\n        \"frameset\"\n      ],\n      \"HTMLHRElement\": [\n        \"hr\"\n      ],\n      \"HTMLHeadElement\": [\n        \"head\"\n      ],\n      \"HTMLHeadingElement\": [\n        \"h1\",\n        \"h2\",\n        \"h3\",\n        \"h4\",\n        \"h5\",\n        \"h6\"\n      ],\n      \"HTMLHtmlElement\": [\n        \"html\"\n      ],\n      \"HTMLIFrameElement\": [\n        \"iframe\"\n      ],\n      \"HTMLImageElement\": [\n        \"img\"\n      ],\n      \"HTMLInputElement\": [\n        \"input\"\n      ],\n      \"HTMLKeygenElement\": [\n        \"keygen\"\n      ],\n      \"HTMLLIElement\": [\n        \"li\"\n      ],\n      \"HTMLLabelElement\": [\n        \"label\"\n      ],\n      \"HTMLLegendElement\": [\n        \"legend\"\n      ],\n      \"HTMLLinkElement\": [\n        \"link\"\n      ],\n      \"HTMLMapElement\": [\n        \"map\"\n      ],\n      \"HTMLMarqueeElement\": [\n        \"marquee\"\n      ],\n      \"HTMLMediaElement\": [\n        \"media\"\n      ],\n      \"HTMLMenuElement\": [\n        \"menu\"\n      ],\n      \"HTMLMenuItemElement\": [\n        \"menuitem\"\n      ],\n      \"HTMLMetaElement\": [\n        \"meta\"\n      ],\n      \"HTMLMeterElement\": [\n        \"meter\"\n      ],\n      \"HTMLModElement\": [\n        \"del\",\n        \"ins\"\n      ],\n      \"HTMLOListElement\": [\n        \"ol\"\n      ],\n      \"HTMLObjectElement\": [\n        \"object\"\n      ],\n      \"HTMLOptGroupElement\": [\n        \"optgroup\"\n      ],\n      \"HTMLOptionElement\": [\n        \"option\"\n      ],\n      \"HTMLOutputElement\": [\n        \"output\"\n      ],\n      \"HTMLParagraphElement\": [\n        \"p\"\n      ],\n      \"HTMLParamElement\": [\n        \"param\"\n      ],\n      \"HTMLPictureElement\": [\n        \"picture\"\n      ],\n      \"HTMLPreElement\": [\n        \"pre\"\n      ],\n      \"HTMLProgressElement\": [\n        \"progress\"\n      ],\n      \"HTMLQuoteElement\": [\n        \"blockquote\",\n        \"q\",\n        \"quote\"\n      ],\n      \"HTMLScriptElement\": [\n        \"script\"\n      ],\n      \"HTMLSelectElement\": [\n        \"select\"\n      ],\n      \"HTMLShadowElement\": [\n        \"shadow\"\n      ],\n      \"HTMLSlotElement\": [\n        \"slot\"\n      ],\n      \"HTMLSourceElement\": [\n        \"source\"\n      ],\n      \"HTMLSpanElement\": [\n        \"span\"\n      ],\n      \"HTMLStyleElement\": [\n        \"style\"\n      ],\n      \"HTMLTableCaptionElement\": [\n        \"caption\"\n      ],\n      \"HTMLTableCellElement\": [\n        \"td\",\n        \"th\"\n      ],\n      \"HTMLTableColElement\": [\n        \"col\",\n        \"colgroup\"\n      ],\n      \"HTMLTableElement\": [\n        \"table\"\n      ],\n      \"HTMLTableRowElement\": [\n        \"tr\"\n      ],\n      \"HTMLTableSectionElement\": [\n        \"thead\",\n        \"tbody\",\n        \"tfoot\"\n      ],\n      \"HTMLTemplateElement\": [\n        \"template\"\n      ],\n      \"HTMLTextAreaElement\": [\n        \"textarea\"\n      ],\n      \"HTMLTimeElement\": [\n        \"time\"\n      ],\n      \"HTMLTitleElement\": [\n        \"title\"\n      ],\n      \"HTMLTrackElement\": [\n        \"track\"\n      ],\n      \"HTMLUListElement\": [\n        \"ul\"\n      ],\n      \"HTMLUnknownElement\": [\n        \"unknown\",\n        \"vhgroupv\",\n        \"vkeygen\"\n      ],\n      \"HTMLVideoElement\": [\n        \"video\"\n      ]\n    },\n    \"nodes\": {\n      \"Attr\": [\n        \"node\"\n      ],\n      \"Audio\": [\n        \"audio\"\n      ],\n      \"CDATASection\": [\n        \"node\"\n      ],\n      \"CharacterData\": [\n        \"node\"\n      ],\n      \"Comment\": [\n        \"#comment\"\n      ],\n      \"Document\": [\n        \"#document\"\n      ],\n      \"DocumentFragment\": [\n        \"#document-fragment\"\n      ],\n      \"DocumentType\": [\n        \"node\"\n      ],\n      \"HTMLDocument\": [\n        \"#document\"\n      ],\n      \"Image\": [\n        \"img\"\n      ],\n      \"Option\": [\n        \"option\"\n      ],\n      \"ProcessingInstruction\": [\n        \"node\"\n      ],\n      \"ShadowRoot\": [\n        \"#shadow-root\"\n      ],\n      \"Text\": [\n        \"#text\"\n      ],\n      \"XMLDocument\": [\n        \"xml\"\n      ]\n    }\n  }));\n  \n  \n    \n  // passed at runtime, configurable\n  // via nodejs module\n  if (!polyfill) polyfill = 'auto';\n  \n  var\n    // V0 polyfill entry\n    REGISTER_ELEMENT = 'registerElement',\n  \n    // IE < 11 only + old WebKit for attributes + feature detection\n    EXPANDO_UID = '__' + REGISTER_ELEMENT + (window.Math.random() * 10e4 >> 0),\n  \n    // shortcuts and costants\n    ADD_EVENT_LISTENER = 'addEventListener',\n    ATTACHED = 'attached',\n    CALLBACK = 'Callback',\n    DETACHED = 'detached',\n    EXTENDS = 'extends',\n  \n    ATTRIBUTE_CHANGED_CALLBACK = 'attributeChanged' + CALLBACK,\n    ATTACHED_CALLBACK = ATTACHED + CALLBACK,\n    CONNECTED_CALLBACK = 'connected' + CALLBACK,\n    DISCONNECTED_CALLBACK = 'disconnected' + CALLBACK,\n    CREATED_CALLBACK = 'created' + CALLBACK,\n    DETACHED_CALLBACK = DETACHED + CALLBACK,\n  \n    ADDITION = 'ADDITION',\n    MODIFICATION = 'MODIFICATION',\n    REMOVAL = 'REMOVAL',\n  \n    DOM_ATTR_MODIFIED = 'DOMAttrModified',\n    DOM_CONTENT_LOADED = 'DOMContentLoaded',\n    DOM_SUBTREE_MODIFIED = 'DOMSubtreeModified',\n  \n    PREFIX_TAG = '<',\n    PREFIX_IS = '=',\n  \n    // valid and invalid node names\n    validName = /^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,\n    invalidNames = [\n      'ANNOTATION-XML',\n      'COLOR-PROFILE',\n      'FONT-FACE',\n      'FONT-FACE-SRC',\n      'FONT-FACE-URI',\n      'FONT-FACE-FORMAT',\n      'FONT-FACE-NAME',\n      'MISSING-GLYPH'\n    ],\n  \n    // registered types and their prototypes\n    types = [],\n    protos = [],\n  \n    // to query subnodes\n    query = '',\n  \n    // html shortcut used to feature detect\n    documentElement = document.documentElement,\n  \n    // ES5 inline helpers || basic patches\n    indexOf = types.indexOf || function (v) {\n      for(var i = this.length; i-- && this[i] !== v;){}\n      return i;\n    },\n  \n    // other helpers / shortcuts\n    OP = Object.prototype,\n    hOP = OP.hasOwnProperty,\n    iPO = OP.isPrototypeOf,\n  \n    defineProperty = Object.defineProperty,\n    empty = [],\n    gOPD = Object.getOwnPropertyDescriptor,\n    gOPN = Object.getOwnPropertyNames,\n    gPO = Object.getPrototypeOf,\n    sPO = Object.setPrototypeOf,\n  \n    // jshint proto: true\n    hasProto = !!Object.__proto__,\n  \n    // V1 helpers\n    fixGetClass = false,\n    DRECEV1 = '__dreCEv1',\n    customElements = window.customElements,\n    usableCustomElements = polyfill !== 'force' && !!(\n      customElements &&\n      customElements.define &&\n      customElements.get &&\n      customElements.whenDefined\n    ),\n    Dict = Object.create || Object,\n    Map = window.Map || function Map() {\n      var K = [], V = [], i;\n      return {\n        get: function (k) {\n          return V[indexOf.call(K, k)];\n        },\n        set: function (k, v) {\n          i = indexOf.call(K, k);\n          if (i < 0) V[K.push(k) - 1] = v;\n          else V[i] = v;\n        }\n      };\n    },\n    Promise = window.Promise || function (fn) {\n      var\n        notify = [],\n        done = false,\n        p = {\n          'catch': function () {\n            return p;\n          },\n          'then': function (cb) {\n            notify.push(cb);\n            if (done) setTimeout(resolve, 1);\n            return p;\n          }\n        }\n      ;\n      function resolve(value) {\n        done = true;\n        while (notify.length) notify.shift()(value);\n      }\n      fn(resolve);\n      return p;\n    },\n    justCreated = false,\n    constructors = Dict(null),\n    waitingList = Dict(null),\n    nodeNames = new Map(),\n    secondArgument = function (is) {\n      return is.toLowerCase();\n    },\n  \n    // used to create unique instances\n    create = Object.create || function Bridge(proto) {\n      // silly broken polyfill probably ever used but short enough to work\n      return proto ? ((Bridge.prototype = proto), new Bridge()) : this;\n    },\n  \n    // will set the prototype if possible\n    // or copy over all properties\n    setPrototype = sPO || (\n      hasProto ?\n        function (o, p) {\n          o.__proto__ = p;\n          return o;\n        } : (\n      (gOPN && gOPD) ?\n        (function(){\n          function setProperties(o, p) {\n            for (var\n              key,\n              names = gOPN(p),\n              i = 0, length = names.length;\n              i < length; i++\n            ) {\n              key = names[i];\n              if (!hOP.call(o, key)) {\n                defineProperty(o, key, gOPD(p, key));\n              }\n            }\n          }\n          return function (o, p) {\n            do {\n              setProperties(o, p);\n            } while ((p = gPO(p)) && !iPO.call(p, o));\n            return o;\n          };\n        }()) :\n        function (o, p) {\n          for (var key in p) {\n            o[key] = p[key];\n          }\n          return o;\n        }\n    )),\n  \n    // DOM shortcuts and helpers, if any\n  \n    MutationObserver = window.MutationObserver ||\n                       window.WebKitMutationObserver,\n  \n    HTMLElementPrototype = (\n      window.HTMLElement ||\n      window.Element ||\n      window.Node\n    ).prototype,\n  \n    IE8 = !iPO.call(HTMLElementPrototype, documentElement),\n  \n    safeProperty = IE8 ? function (o, k, d) {\n      o[k] = d.value;\n      return o;\n    } : defineProperty,\n  \n    isValidNode = IE8 ?\n      function (node) {\n        return node.nodeType === 1;\n      } :\n      function (node) {\n        return iPO.call(HTMLElementPrototype, node);\n      },\n  \n    targets = IE8 && [],\n  \n    attachShadow = HTMLElementPrototype.attachShadow,\n    cloneNode = HTMLElementPrototype.cloneNode,\n    dispatchEvent = HTMLElementPrototype.dispatchEvent,\n    getAttribute = HTMLElementPrototype.getAttribute,\n    hasAttribute = HTMLElementPrototype.hasAttribute,\n    removeAttribute = HTMLElementPrototype.removeAttribute,\n    setAttribute = HTMLElementPrototype.setAttribute,\n  \n    // replaced later on\n    createElement = document.createElement,\n    patchedCreateElement = createElement,\n  \n    // shared observer for all attributes\n    attributesObserver = MutationObserver && {\n      attributes: true,\n      characterData: true,\n      attributeOldValue: true\n    },\n  \n    // useful to detect only if there's no MutationObserver\n    DOMAttrModified = MutationObserver || function(e) {\n      doesNotSupportDOMAttrModified = false;\n      documentElement.removeEventListener(\n        DOM_ATTR_MODIFIED,\n        DOMAttrModified\n      );\n    },\n  \n    // will both be used to make DOMNodeInserted asynchronous\n    asapQueue,\n    asapTimer = 0,\n  \n    // internal flags\n    V0 = REGISTER_ELEMENT in document,\n    setListener = true,\n    justSetup = false,\n    doesNotSupportDOMAttrModified = true,\n    dropDomContentLoaded = true,\n  \n    // needed for the innerHTML helper\n    notFromInnerHTMLHelper = true,\n  \n    // optionally defined later on\n    onSubtreeModified,\n    callDOMAttrModified,\n    getAttributesMirror,\n    observer,\n    observe,\n  \n    // based on setting prototype capability\n    // will check proto or the expando attribute\n    // in order to setup the node once\n    patchIfNotAlready,\n    patch\n  ;\n  \n  // only if needed\n  if (!V0) {\n  \n    if (sPO || hasProto) {\n        patchIfNotAlready = function (node, proto) {\n          if (!iPO.call(proto, node)) {\n            setupNode(node, proto);\n          }\n        };\n        patch = setupNode;\n    } else {\n        patchIfNotAlready = function (node, proto) {\n          if (!node[EXPANDO_UID]) {\n            node[EXPANDO_UID] = Object(true);\n            setupNode(node, proto);\n          }\n        };\n        patch = patchIfNotAlready;\n    }\n  \n    if (IE8) {\n      doesNotSupportDOMAttrModified = false;\n      (function (){\n        var\n          descriptor = gOPD(HTMLElementPrototype, ADD_EVENT_LISTENER),\n          addEventListener = descriptor.value,\n          patchedRemoveAttribute = function (name) {\n            var e = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true});\n            e.attrName = name;\n            e.prevValue = getAttribute.call(this, name);\n            e.newValue = null;\n            e[REMOVAL] = e.attrChange = 2;\n            removeAttribute.call(this, name);\n            dispatchEvent.call(this, e);\n          },\n          patchedSetAttribute = function (name, value) {\n            var\n              had = hasAttribute.call(this, name),\n              old = had && getAttribute.call(this, name),\n              e = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true})\n            ;\n            setAttribute.call(this, name, value);\n            e.attrName = name;\n            e.prevValue = had ? old : null;\n            e.newValue = value;\n            if (had) {\n              e[MODIFICATION] = e.attrChange = 1;\n            } else {\n              e[ADDITION] = e.attrChange = 0;\n            }\n            dispatchEvent.call(this, e);\n          },\n          onPropertyChange = function (e) {\n            // jshint eqnull:true\n            var\n              node = e.currentTarget,\n              superSecret = node[EXPANDO_UID],\n              propertyName = e.propertyName,\n              event\n            ;\n            if (superSecret.hasOwnProperty(propertyName)) {\n              superSecret = superSecret[propertyName];\n              event = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true});\n              event.attrName = superSecret.name;\n              event.prevValue = superSecret.value || null;\n              event.newValue = (superSecret.value = node[propertyName] || null);\n              if (event.prevValue == null) {\n                event[ADDITION] = event.attrChange = 0;\n              } else {\n                event[MODIFICATION] = event.attrChange = 1;\n              }\n              dispatchEvent.call(node, event);\n            }\n          }\n        ;\n        descriptor.value = function (type, handler, capture) {\n          if (\n            type === DOM_ATTR_MODIFIED &&\n            this[ATTRIBUTE_CHANGED_CALLBACK] &&\n            this.setAttribute !== patchedSetAttribute\n          ) {\n            this[EXPANDO_UID] = {\n              className: {\n                name: 'class',\n                value: this.className\n              }\n            };\n            this.setAttribute = patchedSetAttribute;\n            this.removeAttribute = patchedRemoveAttribute;\n            addEventListener.call(this, 'propertychange', onPropertyChange);\n          }\n          addEventListener.call(this, type, handler, capture);\n        };\n        defineProperty(HTMLElementPrototype, ADD_EVENT_LISTENER, descriptor);\n      }());\n    } else if (!MutationObserver) {\n      documentElement[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED, DOMAttrModified);\n      documentElement.setAttribute(EXPANDO_UID, 1);\n      documentElement.removeAttribute(EXPANDO_UID);\n      if (doesNotSupportDOMAttrModified) {\n        onSubtreeModified = function (e) {\n          var\n            node = this,\n            oldAttributes,\n            newAttributes,\n            key\n          ;\n          if (node === e.target) {\n            oldAttributes = node[EXPANDO_UID];\n            node[EXPANDO_UID] = (newAttributes = getAttributesMirror(node));\n            for (key in newAttributes) {\n              if (!(key in oldAttributes)) {\n                // attribute was added\n                return callDOMAttrModified(\n                  0,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  ADDITION\n                );\n              } else if (newAttributes[key] !== oldAttributes[key]) {\n                // attribute was changed\n                return callDOMAttrModified(\n                  1,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  MODIFICATION\n                );\n              }\n            }\n            // checking if it has been removed\n            for (key in oldAttributes) {\n              if (!(key in newAttributes)) {\n                // attribute removed\n                return callDOMAttrModified(\n                  2,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  REMOVAL\n                );\n              }\n            }\n          }\n        };\n        callDOMAttrModified = function (\n          attrChange,\n          currentTarget,\n          attrName,\n          prevValue,\n          newValue,\n          action\n        ) {\n          var e = {\n            attrChange: attrChange,\n            currentTarget: currentTarget,\n            attrName: attrName,\n            prevValue: prevValue,\n            newValue: newValue\n          };\n          e[action] = attrChange;\n          onDOMAttrModified(e);\n        };\n        getAttributesMirror = function (node) {\n          for (var\n            attr, name,\n            result = {},\n            attributes = node.attributes,\n            i = 0, length = attributes.length;\n            i < length; i++\n          ) {\n            attr = attributes[i];\n            name = attr.name;\n            if (name !== 'setAttribute') {\n              result[name] = attr.value;\n            }\n          }\n          return result;\n        };\n      }\n    }\n  \n    // set as enumerable, writable and configurable\n    document[REGISTER_ELEMENT] = function registerElement(type, options) {\n      upperType = type.toUpperCase();\n      if (setListener) {\n        // only first time document.registerElement is used\n        // we need to set this listener\n        // setting it by default might slow down for no reason\n        setListener = false;\n        if (MutationObserver) {\n          observer = (function(attached, detached){\n            function checkEmAll(list, callback) {\n              for (var i = 0, length = list.length; i < length; callback(list[i++])){}\n            }\n            return new MutationObserver(function (records) {\n              for (var\n                current, node, newValue,\n                i = 0, length = records.length; i < length; i++\n              ) {\n                current = records[i];\n                if (current.type === 'childList') {\n                  checkEmAll(current.addedNodes, attached);\n                  checkEmAll(current.removedNodes, detached);\n                } else {\n                  node = current.target;\n                  if (notFromInnerHTMLHelper &&\n                      node[ATTRIBUTE_CHANGED_CALLBACK] &&\n                      current.attributeName !== 'style') {\n                    newValue = getAttribute.call(node, current.attributeName);\n                    if (newValue !== current.oldValue) {\n                      node[ATTRIBUTE_CHANGED_CALLBACK](\n                        current.attributeName,\n                        current.oldValue,\n                        newValue\n                      );\n                    }\n                  }\n                }\n              }\n            });\n          }(executeAction(ATTACHED), executeAction(DETACHED)));\n          observe = function (node) {\n            observer.observe(\n              node,\n              {\n                childList: true,\n                subtree: true\n              }\n            );\n            return node;\n          };\n          observe(document);\n          if (attachShadow) {\n            HTMLElementPrototype.attachShadow = function () {\n              return observe(attachShadow.apply(this, arguments));\n            };\n          }\n        } else {\n          asapQueue = [];\n          document[ADD_EVENT_LISTENER]('DOMNodeInserted', onDOMNode(ATTACHED));\n          document[ADD_EVENT_LISTENER]('DOMNodeRemoved', onDOMNode(DETACHED));\n        }\n  \n        document[ADD_EVENT_LISTENER](DOM_CONTENT_LOADED, onReadyStateChange);\n        document[ADD_EVENT_LISTENER]('readystatechange', onReadyStateChange);\n  \n        HTMLElementPrototype.cloneNode = function (deep) {\n          var\n            node = cloneNode.call(this, !!deep),\n            i = getTypeIndex(node)\n          ;\n          if (-1 < i) patch(node, protos[i]);\n          if (deep && query.length) loopAndSetup(node.querySelectorAll(query));\n          return node;\n        };\n      }\n  \n      if (justSetup) return (justSetup = false);\n  \n      if (-2 < (\n        indexOf.call(types, PREFIX_IS + upperType) +\n        indexOf.call(types, PREFIX_TAG + upperType)\n      )) {\n        throwTypeError(type);\n      }\n  \n      if (!validName.test(upperType) || -1 < indexOf.call(invalidNames, upperType)) {\n        throw new Error('The type ' + type + ' is invalid');\n      }\n  \n      var\n        constructor = function () {\n          return extending ?\n            document.createElement(nodeName, upperType) :\n            document.createElement(nodeName);\n        },\n        opt = options || OP,\n        extending = hOP.call(opt, EXTENDS),\n        nodeName = extending ? options[EXTENDS].toUpperCase() : upperType,\n        upperType,\n        i\n      ;\n  \n      if (extending && -1 < (\n        indexOf.call(types, PREFIX_TAG + nodeName)\n      )) {\n        throwTypeError(nodeName);\n      }\n  \n      i = types.push((extending ? PREFIX_IS : PREFIX_TAG) + upperType) - 1;\n  \n      query = query.concat(\n        query.length ? ',' : '',\n        extending ? nodeName + '[is=\"' + type.toLowerCase() + '\"]' : nodeName\n      );\n  \n      constructor.prototype = (\n        protos[i] = hOP.call(opt, 'prototype') ?\n          opt.prototype :\n          create(HTMLElementPrototype)\n      );\n  \n      if (query.length) loopAndVerify(\n        document.querySelectorAll(query),\n        ATTACHED\n      );\n  \n      return constructor;\n    };\n  \n    document.createElement = (patchedCreateElement = function (localName, typeExtension) {\n      var\n        is = getIs(typeExtension),\n        node = is ?\n          createElement.call(document, localName, secondArgument(is)) :\n          createElement.call(document, localName),\n        name = '' + localName,\n        i = indexOf.call(\n          types,\n          (is ? PREFIX_IS : PREFIX_TAG) +\n          (is || name).toUpperCase()\n        ),\n        setup = -1 < i\n      ;\n      if (is) {\n        node.setAttribute('is', is = is.toLowerCase());\n        if (setup) {\n          setup = isInQSA(name.toUpperCase(), is);\n        }\n      }\n      notFromInnerHTMLHelper = !document.createElement.innerHTMLHelper;\n      if (setup) patch(node, protos[i]);\n      return node;\n    });\n  \n  }\n  \n  function ASAP() {\n    var queue = asapQueue.splice(0, asapQueue.length);\n    asapTimer = 0;\n    while (queue.length) {\n      queue.shift().call(\n        null, queue.shift()\n      );\n    }\n  }\n  \n  function loopAndVerify(list, action) {\n    for (var i = 0, length = list.length; i < length; i++) {\n      verifyAndSetupAndAction(list[i], action);\n    }\n  }\n  \n  function loopAndSetup(list) {\n    for (var i = 0, length = list.length, node; i < length; i++) {\n      node = list[i];\n      patch(node, protos[getTypeIndex(node)]);\n    }\n  }\n  \n  function executeAction(action) {\n    return function (node) {\n      if (isValidNode(node)) {\n        verifyAndSetupAndAction(node, action);\n        if (query.length) loopAndVerify(\n          node.querySelectorAll(query),\n          action\n        );\n      }\n    };\n  }\n  \n  function getTypeIndex(target) {\n    var\n      is = getAttribute.call(target, 'is'),\n      nodeName = target.nodeName.toUpperCase(),\n      i = indexOf.call(\n        types,\n        is ?\n            PREFIX_IS + is.toUpperCase() :\n            PREFIX_TAG + nodeName\n      )\n    ;\n    return is && -1 < i && !isInQSA(nodeName, is) ? -1 : i;\n  }\n  \n  function isInQSA(name, type) {\n    return -1 < query.indexOf(name + '[is=\"' + type + '\"]');\n  }\n  \n  function onDOMAttrModified(e) {\n    var\n      node = e.currentTarget,\n      attrChange = e.attrChange,\n      attrName = e.attrName,\n      target = e.target,\n      addition = e[ADDITION] || 2,\n      removal = e[REMOVAL] || 3\n    ;\n    if (notFromInnerHTMLHelper &&\n        (!target || target === node) &&\n        node[ATTRIBUTE_CHANGED_CALLBACK] &&\n        attrName !== 'style' && (\n          e.prevValue !== e.newValue ||\n          // IE9, IE10, and Opera 12 gotcha\n          e.newValue === '' && (\n            attrChange === addition ||\n            attrChange === removal\n          )\n    )) {\n      node[ATTRIBUTE_CHANGED_CALLBACK](\n        attrName,\n        attrChange === addition ? null : e.prevValue,\n        attrChange === removal ? null : e.newValue\n      );\n    }\n  }\n  \n  function onDOMNode(action) {\n    var executor = executeAction(action);\n    return function (e) {\n      asapQueue.push(executor, e.target);\n      if (asapTimer) clearTimeout(asapTimer);\n      asapTimer = setTimeout(ASAP, 1);\n    };\n  }\n  \n  function onReadyStateChange(e) {\n    if (dropDomContentLoaded) {\n      dropDomContentLoaded = false;\n      e.currentTarget.removeEventListener(DOM_CONTENT_LOADED, onReadyStateChange);\n    }\n    if (query.length) loopAndVerify(\n      (e.target || document).querySelectorAll(query),\n      e.detail === DETACHED ? DETACHED : ATTACHED\n    );\n    if (IE8) purge();\n  }\n  \n  function patchedSetAttribute(name, value) {\n    // jshint validthis:true\n    var self = this;\n    setAttribute.call(self, name, value);\n    onSubtreeModified.call(self, {target: self});\n  }\n  \n  function setupNode(node, proto) {\n    setPrototype(node, proto);\n    if (observer) {\n      observer.observe(node, attributesObserver);\n    } else {\n      if (doesNotSupportDOMAttrModified) {\n        node.setAttribute = patchedSetAttribute;\n        node[EXPANDO_UID] = getAttributesMirror(node);\n        node[ADD_EVENT_LISTENER](DOM_SUBTREE_MODIFIED, onSubtreeModified);\n      }\n      node[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED, onDOMAttrModified);\n    }\n    if (node[CREATED_CALLBACK] && notFromInnerHTMLHelper) {\n      node.created = true;\n      node[CREATED_CALLBACK]();\n      node.created = false;\n    }\n  }\n  \n  function purge() {\n    for (var\n      node,\n      i = 0,\n      length = targets.length;\n      i < length; i++\n    ) {\n      node = targets[i];\n      if (!documentElement.contains(node)) {\n        length--;\n        targets.splice(i--, 1);\n        verifyAndSetupAndAction(node, DETACHED);\n      }\n    }\n  }\n  \n  function throwTypeError(type) {\n    throw new Error('A ' + type + ' type is already registered');\n  }\n  \n  function verifyAndSetupAndAction(node, action) {\n    var\n      fn,\n      i = getTypeIndex(node)\n    ;\n    if (-1 < i) {\n      patchIfNotAlready(node, protos[i]);\n      i = 0;\n      if (action === ATTACHED && !node[ATTACHED]) {\n        node[DETACHED] = false;\n        node[ATTACHED] = true;\n        i = 1;\n        if (IE8 && indexOf.call(targets, node) < 0) {\n          targets.push(node);\n        }\n      } else if (action === DETACHED && !node[DETACHED]) {\n        node[ATTACHED] = false;\n        node[DETACHED] = true;\n        i = 1;\n      }\n      if (i && (fn = node[action + CALLBACK])) fn.call(node);\n    }\n  }\n  \n  \n  \n  // V1 in da House!\n  function CustomElementRegistry() {}\n  \n  CustomElementRegistry.prototype = {\n    constructor: CustomElementRegistry,\n    // a workaround for the stubborn WebKit\n    define: usableCustomElements ?\n      function (name, Class, options) {\n        if (options) {\n          CERDefine(name, Class, options);\n        } else {\n          var NAME = name.toUpperCase();\n          constructors[NAME] = {\n            constructor: Class,\n            create: [NAME]\n          };\n          nodeNames.set(Class, NAME);\n          customElements.define(name, Class);\n        }\n      } :\n      CERDefine,\n    get: usableCustomElements ?\n      function (name) {\n        return customElements.get(name) || get(name);\n      } :\n      get,\n    whenDefined: usableCustomElements ?\n      function (name) {\n        return Promise.race([\n          customElements.whenDefined(name),\n          whenDefined(name)\n        ]);\n      } :\n      whenDefined\n  };\n  \n  function CERDefine(name, Class, options) {\n    var\n      is = options && options[EXTENDS] || '',\n      CProto = Class.prototype,\n      proto = create(CProto),\n      attributes = Class.observedAttributes || empty,\n      definition = {prototype: proto}\n    ;\n    // TODO: is this needed at all since it's inherited?\n    // defineProperty(proto, 'constructor', {value: Class});\n    safeProperty(proto, CREATED_CALLBACK, {\n        value: function () {\n          if (justCreated) justCreated = false;\n          else if (!this[DRECEV1]) {\n            this[DRECEV1] = true;\n            new Class(this);\n            if (CProto[CREATED_CALLBACK])\n              CProto[CREATED_CALLBACK].call(this);\n            var info = constructors[nodeNames.get(Class)];\n            if (!usableCustomElements || info.create.length > 1) {\n              notifyAttributes(this);\n            }\n          }\n      }\n    });\n    safeProperty(proto, ATTRIBUTE_CHANGED_CALLBACK, {\n      value: function (name) {\n        if (-1 < indexOf.call(attributes, name))\n          CProto[ATTRIBUTE_CHANGED_CALLBACK].apply(this, arguments);\n      }\n    });\n    if (CProto[CONNECTED_CALLBACK]) {\n      safeProperty(proto, ATTACHED_CALLBACK, {\n        value: CProto[CONNECTED_CALLBACK]\n      });\n    }\n    if (CProto[DISCONNECTED_CALLBACK]) {\n      safeProperty(proto, DETACHED_CALLBACK, {\n        value: CProto[DISCONNECTED_CALLBACK]\n      });\n    }\n    if (is) definition[EXTENDS] = is;\n    name = name.toUpperCase();\n    constructors[name] = {\n      constructor: Class,\n      create: is ? [is, secondArgument(name)] : [name]\n    };\n    nodeNames.set(Class, name);\n    document[REGISTER_ELEMENT](name.toLowerCase(), definition);\n    whenDefined(name);\n    waitingList[name].r();\n  }\n  \n  function get(name) {\n    var info = constructors[name.toUpperCase()];\n    return info && info.constructor;\n  }\n  \n  function getIs(options) {\n    return typeof options === 'string' ?\n        options : (options && options.is || '');\n  }\n  \n  function notifyAttributes(self) {\n    var\n      callback = self[ATTRIBUTE_CHANGED_CALLBACK],\n      attributes = callback ? self.attributes : empty,\n      i = attributes.length,\n      attribute\n    ;\n    while (i--) {\n      attribute =  attributes[i]; // || attributes.item(i);\n      callback.call(\n        self,\n        attribute.name || attribute.nodeName,\n        null,\n        attribute.value || attribute.nodeValue\n      );\n    }\n  }\n  \n  function whenDefined(name) {\n    name = name.toUpperCase();\n    if (!(name in waitingList)) {\n      waitingList[name] = {};\n      waitingList[name].p = new Promise(function (resolve) {\n        waitingList[name].r = resolve;\n      });\n    }\n    return waitingList[name].p;\n  }\n  \n  function polyfillV1() {\n    if (customElements) delete window.customElements;\n    defineProperty(window, 'customElements', {\n      configurable: true,\n      value: new CustomElementRegistry()\n    });\n    defineProperty(window, 'CustomElementRegistry', {\n      configurable: true,\n      value: CustomElementRegistry\n    });\n    for (var\n      patchClass = function (name) {\n        var Class = window[name];\n        if (Class) {\n          window[name] = function CustomElementsV1(self) {\n            var info, isNative;\n            if (!self) self = this;\n            if (!self[DRECEV1]) {\n              justCreated = true;\n              info = constructors[nodeNames.get(self.constructor)];\n              isNative = usableCustomElements && info.create.length === 1;\n              self = isNative ?\n                Reflect.construct(Class, empty, info.constructor) :\n                document.createElement.apply(document, info.create);\n              self[DRECEV1] = true;\n              justCreated = false;\n              if (!isNative) notifyAttributes(self);\n            }\n            return self;\n          };\n          window[name].prototype = Class.prototype;\n          try {\n            Class.prototype.constructor = window[name];\n          } catch(WebKit) {\n            fixGetClass = true;\n            defineProperty(Class, DRECEV1, {value: window[name]});\n          }\n        }\n      },\n      Classes = htmlClass.get(/^HTML[A-Z]*[a-z]/),\n      i = Classes.length;\n      i--;\n      patchClass(Classes[i])\n    ) {}\n    (document.createElement = function (name, options) {\n      var is = getIs(options);\n      return is ?\n        patchedCreateElement.call(this, name, secondArgument(is)) :\n        patchedCreateElement.call(this, name);\n    });\n    if (!V0) {\n      justSetup = true;\n      document[REGISTER_ELEMENT]('');\n    }\n  }\n  \n  // if customElements is not there at all\n  if (!customElements || polyfill === 'force') polyfillV1();\n  else {\n    // if available test extends work as expected\n    try {\n      (function (DRE, options, name) {\n        options[EXTENDS] = 'a';\n        DRE.prototype = create(HTMLAnchorElement.prototype);\n        DRE.prototype.constructor = DRE;\n        window.customElements.define(name, DRE, options);\n        if (\n          getAttribute.call(document.createElement('a', {is: name}), 'is') !== name ||\n          (usableCustomElements && getAttribute.call(new DRE(), 'is') !== name)\n        ) {\n          throw options;\n        }\n      }(\n        function DRE() {\n          return Reflect.construct(HTMLAnchorElement, [], DRE);\n        },\n        {},\n        'document-register-element-a'\n      ));\n    } catch(o_O) {\n      // or force the polyfill if not\n      // and keep internal original reference\n      polyfillV1();\n    }\n  }\n  \n  try {\n    createElement.call(document, 'a', 'a');\n  } catch(FireFox) {\n    secondArgument = function (is) {\n      return {is: is.toLowerCase()};\n    };\n  }\n  \n}\n\nexports.installCustomElements = installCustomElements;\n\n","'use strict';\n\n/**\n * Constructs a ES6/Promises A+ Promise instance.\n *\n * @constructor\n * @param {function(function(*=), function (*=))} resolver\n */\nfunction Promise(resolver) {\n  if (!(this instanceof Promise)) {\n    throw new TypeError('Constructor Promise requires `new`');\n  }\n  if (!isFunction(resolver)) {\n    throw new TypeError('Must pass resolver function');\n  }\n\n  /**\n   * @type {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise}\n   * @private\n   */\n  this._state = PendingPromise;\n\n  /**\n   * @type {*}\n   * @private\n   */\n  this._value = [];\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this._isChainEnd = true;\n\n  doResolve(\n    this,\n    adopter(this, FulfilledPromise),\n    adopter(this, RejectedPromise),\n    { then: resolver }\n  );\n}\n\n/****************************\n  Public Instance Methods\n ****************************/\n\n/**\n * Creates a new promise instance that will receive the result of this promise\n * as inputs to the onFulfilled or onRejected callbacks.\n *\n * @param {function(*)} onFulfilled\n * @param {function(*)} onRejected\n */\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  onFulfilled = isFunction(onFulfilled) ? onFulfilled : void 0;\n  onRejected = isFunction(onRejected) ? onRejected : void 0;\n\n  if (onFulfilled || onRejected) {\n    this._isChainEnd = false;\n  }\n\n  return this._state(\n    this._value,\n    onFulfilled,\n    onRejected\n  );\n};\n\n/**\n * Creates a new promise that will handle the rejected state of this promise.\n *\n * @param {function(*)} onRejected\n * @returns {!Promise}\n */\nPromise.prototype.catch = function(onRejected) {\n  return this.then(void 0, onRejected);\n};\n\n/****************************\n  Public Static Methods\n ****************************/\n\n/**\n * Creates a fulfilled Promise of value. If value is itself a then-able,\n * resolves with the then-able's value.\n *\n * @this {!Promise}\n * @param {*=} value\n * @returns {!Promise}\n */\nPromise.resolve = function(value) {\n  var Constructor = this;\n  var promise;\n\n  if (isObject(value) && value instanceof this) {\n    promise = value;\n  } else {\n    promise = new Constructor(function(resolve) {\n      resolve(value);\n    });\n  }\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a rejected Promise of reason.\n *\n * @this {!Promise}\n * @param {*=} reason\n * @returns {!Promise}\n */\nPromise.reject = function(reason) {\n  var Constructor = this;\n  var promise = new Constructor(function(_, reject) {\n    reject(reason);\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve with an array of the values of the\n * passed in promises. If any promise rejects, the returned promise will\n * reject.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.all = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    var length = promises.length;\n    var values = new Array(length);\n\n    if (length === 0) {\n      return resolve(values);\n    }\n\n    each(promises, function(promise, index) {\n      Constructor.resolve(promise).then(function(value) {\n        values[index] = value;\n        if (--length === 0) {\n          resolve(values);\n        }\n      }, reject);\n    });\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve or reject based on the first\n * resolved or rejected promise.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.race = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    for (var i = 0; i < promises.length; i++) {\n      Constructor.resolve(promises[i]).then(resolve, reject);\n    }\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\nvar onPossiblyUnhandledRejection = function(reason, promise) {\n  throw reason;\n};\n\n/**\n * An internal use static function.\n */\nPromise._overrideUnhandledExceptionHandler = function(handler) {\n  onPossiblyUnhandledRejection = handler;\n};\n\n/****************************\n  Private functions\n ****************************/\n\n/**\n * The Fulfilled Promise state. Calls onFulfilled with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onFulfilled, returns the current promise to avoid an promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} value The current promise's resolved value.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} unused\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Fulfilled state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction FulfilledPromise(value, onFulfilled, unused, deferred) {\n  if (!onFulfilled) {\n    deferredAdopt(deferred, FulfilledPromise, value);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onFulfilled, value));\n  return deferred.promise;\n}\n\n/**\n * The Rejected Promise state. Calls onRejected with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onRejected, returns the current promise to avoid an promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} reason The current promise's rejection reason.\n * @param {function(*=)=} unused\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Rejected state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction RejectedPromise(reason, unused, onRejected, deferred) {\n  if (!onRejected) {\n    deferredAdopt(deferred, RejectedPromise, reason);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onRejected, reason));\n  return deferred.promise;\n}\n\n/**\n * The Pending Promise state. Eventually calls onFulfilled once the promise has\n * resolved, or onRejected once the promise rejects.\n *\n * If there is no onFulfilled and no onRejected, returns the current promise to\n * avoid an promise instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} queue The current promise's pending promises queue.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Pending state from the\n *     Pending state of another promise.\n * @returns {!Promise}\n */\nfunction PendingPromise(queue, onFulfilled, onRejected, deferred) {\n  if (!deferred) {\n    if (!onFulfilled && !onRejected) { return this; }\n    deferred = new Deferred(this.constructor);\n  }\n  queue.push({\n    deferred: deferred,\n    onFulfilled: onFulfilled || deferred.resolve,\n    onRejected: onRejected || deferred.reject\n  });\n  return deferred.promise;\n}\n\n/**\n * Constructs a deferred instance that holds a promise and its resolve and\n * reject functions.\n *\n * @constructor\n */\nfunction Deferred(Promise) {\n  var deferred = this;\n  /** @type {!Promise} */\n  this.promise = new Promise(function(resolve, reject) {\n    /** @type {function(*=)} */\n    deferred.resolve = resolve;\n\n    /** @type {function(*=)} */\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n\n/**\n * Transitions the state of promise to another state. This is only ever called\n * on with a promise that is currently in the Pending state.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction adopt(promise, state, value, adoptee) {\n  var queue = promise._value;\n  promise._state = state;\n  promise._value = value;\n\n  if (adoptee && state === PendingPromise) {\n    adoptee._state(value, void 0, void 0, {\n      promise: promise,\n      resolve: void 0,\n      reject: void 0\n    });\n  }\n\n  for (var i = 0; i < queue.length; i++) {\n    var next = queue[i];\n    promise._state(\n      value,\n      next.onFulfilled,\n      next.onRejected,\n      next.deferred\n    );\n  }\n  queue.length = 0;\n\n  // Determine if this rejected promise will be \"handled\".\n  if (state === RejectedPromise && promise._isChainEnd) {\n    setTimeout(function() {\n      if (promise._isChainEnd) {\n        onPossiblyUnhandledRejection(value, promise);\n      }\n    }, 0);\n  }\n}\n\n/**\n * A partial application of adopt.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @returns {function(*=)}\n */\nfunction adopter(promise, state) {\n  return function(value) {\n    adopt(promise, state, value);\n  };\n}\n\n/**\n * Updates a deferred promises state. Necessary for updating an adopting\n * promise's state when the adoptee resolves.\n *\n * @param {?Deferred} deferred\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction deferredAdopt(deferred, state, value) {\n  if (deferred) {\n    var promise = deferred.promise;\n    promise._state = state;\n    promise._value = value;\n  }\n}\n\n/**\n * A no-op function to prevent double resolving.\n */\nfunction noop() {}\n\n/**\n * Tests if fn is a Function\n *\n * @param {*} fn\n * @returns {boolean}\n */\nfunction isFunction(fn) {\n  return typeof fn === 'function';\n}\n\n/**\n * Tests if fn is an Object\n *\n * @param {*} obj\n * @returns {boolean}\n */\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n/**\n * Iterates over each element of an array, calling the iterator with the\n * element and its index.\n *\n * @param {!Array} collection\n * @param {function(*=,number)} iterator\n */\nfunction each(collection, iterator) {\n  for (var i = 0; i < collection.length; i++) {\n    iterator(collection[i], i);\n  }\n}\n\n/**\n * Creates a function that will attempt to resolve the deferred with the return\n * of fn. If any error is raised, rejects instead.\n *\n * @param {!Deferred} deferred\n * @param {function(*=)} fn\n * @param {*} arg\n * @returns {function()}\n */\nfunction tryCatchDeferred(deferred, fn, arg) {\n  var promise = deferred.promise;\n  var resolve = deferred.resolve;\n  var reject = deferred.reject;\n  return function() {\n    try {\n      var result = fn(arg);\n      doResolve(promise, resolve, reject, result, result);\n    } catch (e) {\n      reject(e);\n    }\n  };\n}\n\n/**\n * Queues and executes multiple deferred functions on another run loop.\n */\nvar defer = (function() {\n  /**\n   * Defers fn to another run loop.\n   */\n  var scheduleFlush;\n  if (typeof window !== 'undefined' && window.postMessage) {\n    window.addEventListener('message', flush);\n    scheduleFlush = function() {\n      window.postMessage('macro-task', '*');\n    };\n  } else {\n    scheduleFlush = function() {\n      setTimeout(flush, 0);\n    };\n  }\n\n  var queue = new Array(16);\n  var length = 0;\n\n  function flush() {\n    for (var i = 0; i < length; i++) {\n      var fn = queue[i];\n      queue[i] = null;\n      fn();\n    }\n    length = 0;\n  }\n\n  /**\n   * @param {function()} fn\n   */\n  function defer(fn) {\n    if (length === 0) { scheduleFlush(); }\n    queue[length++] = fn;\n  }\n\n  return defer;\n})();\n\n/**\n * The Promise resolution procedure.\n * https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n *\n * @param {!Promise} promise\n * @param {function(*=)} resolve\n * @param {function(*=)} reject\n * @param {*} value\n * @param {*=} context\n */\nfunction doResolve(promise, resolve, reject, value, context) {\n  var _reject = reject;\n  var then;\n  var _resolve;\n  try {\n    if (value === promise) {\n      throw new TypeError('Cannot fulfill promise with itself');\n    }\n    var isObj = isObject(value);\n    if (isObj && value instanceof promise.constructor) {\n      adopt(promise, value._state, value._value, value);\n    } else if (isObj && (then = value.then) && isFunction(then)) {\n      _resolve = function(value) {\n        _resolve = _reject = noop;\n        doResolve(promise, resolve, reject, value, value);\n      };\n      _reject = function(reason) {\n        _resolve = _reject = noop;\n        reject(reason);\n      };\n      then.call(\n        context,\n        function(value) { _resolve(value); },\n        function(reason) { _reject(reason); }\n      );\n    } else {\n      resolve(value);\n    }\n  } catch (e) {\n    _reject(e);\n  }\n}\n\nmodule.exports = Promise;\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Key string in an action arguments map for an unparsed object literal string.\n *\n * E.g. for the action in <p on=\"tap:AMP.setState({foo: 'bar'})\",\n * then `args[RAW_OBJECT_ARGS_KEY]` is the string \"{foo: 'bar'}\".\n *\n * The action service delegates parsing of object literals to the corresponding\n * extension (in the example above, amp-bind).\n *\n * @see ./service/action-impl.ActionInfoDef\n * @const {string}\n */\nexport const RAW_OBJECT_ARGS_KEY = '__AMP_OBJECT_STRING__';\n\n/**\n * Trust level of an action.\n *\n * Corresponds to degree of user intent, i.e. events triggered with strong\n * user intent have high trust.\n *\n * @enum {number}\n */\nexport const ActionTrust = {\n  LOW: 1,\n  HIGH: 100,\n};\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Deferred} from './utils/promise';\nimport {Services} from './services';\nimport {dev} from './log';\nimport {getCurve} from './curve';\n\nconst TAG_ = 'Animation';\n\nconst NOOP_CALLBACK = function() {};\n\n/**\n * The animation class allows construction of arbitrary animation processes.\n * The main method is \"add\" that adds a segment of animation at particular\n * time offset (delay) and duration. All animation segments are simply functions\n * of type Transition which are iterated from 0 to 1 in animation frames to\n * achieve the desired effect.\n */\nexport class Animation {\n\n  /**\n   * Creates and starts animation with a single segment. Returns AnimationPlayer\n   * object that can be used to monitor or control animation.\n   *\n   * @param {!Node} contextNode The context node.\n   * @param {!TransitionDef<?>} transition Transition to animate.\n   * @param {./time.timeDef} duration Duration in milliseconds.\n   * @param {(!./curve.CurveDef|string)=} opt_curve Optional curve to use for\n   *   animation. Default is the linear animation.\n   * @return {!AnimationPlayer}\n   */\n  static animate(contextNode, transition, duration, opt_curve) {\n    return new Animation(contextNode)\n        .setCurve(opt_curve)\n        .add(0, transition, 1)\n        .start(duration);\n  }\n\n  /**\n   * @param {!Node} contextNode\n   * @param {!./service/vsync-impl.Vsync=} opt_vsync\n   */\n  constructor(contextNode, opt_vsync) {\n    /** @private @const {!Node} */\n    this.contextNode_ = contextNode;\n\n    /** @private @const {!./service/vsync-impl.Vsync} */\n    this.vsync_ = opt_vsync || Services.vsyncFor(self);\n\n    /** @private {?./curve.CurveDef} */\n    this.curve_ = null;\n\n    /**\n     * @private @const {!Array<!SegmentDef>}\n     */\n    this.segments_ = [];\n  }\n\n  /**\n   * Sets the default curve for the animation. Each segment is allowed to have\n   * its own curve, but this curve will be used if a segment doesn't specify\n   * its own.\n   * @param {!./curve.CurveDef|string|undefined} curve\n   * @return {!Animation}\n   */\n  setCurve(curve) {\n    if (curve) {\n      this.curve_ = getCurve(curve);\n    }\n    return this;\n  }\n\n  /**\n   * Adds a segment to the animation. Each segment starts at offset (delay) and\n   * runs for a portion of the overall animation (duration). Note that both\n   * delay and duration and normtimeDef types which accept values from 0 to 1.\n   * Optionally, the time is pushed through a curve. If curve is not specified,\n   * the default animation curve will be used. The specified transition is\n   * animated over the specified duration from 0 to 1.\n   *\n   * @param {./time.normtimeDef} delay\n   * @param {!TransitionDef<?>} transition\n   * @param {./time.normtimeDef} duration\n   * @param {(!./curve.CurveDef|string)=} opt_curve\n   * @return {!Animation}\n   */\n  add(delay, transition, duration, opt_curve) {\n    this.segments_.push({\n      delay,\n      func: transition,\n      duration,\n      curve: getCurve(opt_curve),\n    });\n    return this;\n  }\n\n  /**\n   * Starts the animation and returns the AnimationPlayer object that can be\n   * used to monitor and control the animation.\n   *\n   * @param {./time.timeDef} duration Absolute time in milliseconds.\n   * @return {!AnimationPlayer}\n   */\n  start(duration) {\n    const player = new AnimationPlayer(this.vsync_, this.contextNode_,\n        this.segments_, this.curve_, duration);\n    return player;\n  }\n}\n\n\n/**\n * AnimationPlayer allows tracking and monitoring of the running animation.\n * Most importantly it exposes methods \"then\" and \"thenAlways\" that have the\n * semantics of a Promise and signal when the animation completed or failed.\n * Additionally, it exposes the method \"halt\" which allows to stop/reset the\n * animation.\n * // TODO(@cramforce) Actually fully implement.\n * implements {IThenable}\n */\nclass AnimationPlayer {\n\n  /**\n   * @param {!./service/vsync-impl.Vsync} vsync\n   * @param {!Node} contextNode\n   * @param {!Array<!SegmentDef>} segments\n   * @param {?./curve.CurveDef} defaultCurve\n   * @param {./time.timeDef} duration\n   */\n  constructor(vsync, contextNode, segments, defaultCurve, duration) {\n\n    /** @private @const {!./service/vsync-impl.Vsync} */\n    this.vsync_ = vsync;\n\n    /** @private @const {!Node} */\n    this.contextNode_ = contextNode;\n\n    /** @private @const {!Array<!SegmentRuntimeDef>} */\n    this.segments_ = [];\n    for (let i = 0; i < segments.length; i++) {\n      const segment = segments[i];\n      this.segments_.push({\n        delay: segment.delay,\n        func: segment.func,\n        duration: segment.duration,\n        curve: segment.curve || defaultCurve,\n        started: false,\n        completed: false,\n      });\n    }\n\n    /** @private @const */\n    this.duration_ = duration;\n\n    /** @private {./time.timeDef} */\n    this.startTime_ = Date.now();\n\n    /** @private {./time.normtimeDef} */\n    // this.normLinearTime_ = 0;\n\n    /** @private {./time.normtimeDef} */\n    // this.normTime_ = 0;\n\n    /** @private {boolean} */\n    this.running_ = true;\n\n    /** @private {!Object<string, *>} */\n    this.state_ = {};\n\n    const deferred = new Deferred();\n\n    /** @const @private */\n    this.promise_ = deferred.promise;\n\n    /** @const @private */\n    this.resolve_ = deferred.resolve;\n\n    /** @const @private */\n    this.reject_ = deferred.reject;\n\n    /** @const */\n    this.task_ = this.vsync_.createAnimTask(this.contextNode_, {\n      mutate: this.stepMutate_.bind(this),\n    });\n\n    if (this.vsync_.canAnimate(this.contextNode_)) {\n      this.task_(this.state_);\n    } else {\n      dev().warn(TAG_, 'cannot animate');\n      this.complete_(/* success */ false, /* dir */ 0);\n    }\n  }\n\n  /**\n   * Chains to the animation's promise that will resolve when the animation has\n   * completed or will reject if animation has failed or was interrupted.\n   * @param {!Function=} opt_resolve\n   * @param {!Function=} opt_reject\n   * @return {!Promise}\n   */\n  then(opt_resolve, opt_reject) {\n    if (!opt_resolve && !opt_reject) {\n      return this.promise_;\n    }\n    return this.promise_.then(opt_resolve, opt_reject);\n  }\n\n  /**\n   * Callback for regardless whether the animation succeeds or fails.\n   * @param {!Function=} opt_callback\n   * @return {!Promise}\n   */\n  thenAlways(opt_callback) {\n    const callback = opt_callback || NOOP_CALLBACK;\n    return this.then(callback, callback);\n  }\n\n  /**\n   * Halts the animation. Depending on the opt_dir value, the following actions\n   * can be performed:\n   * 0: No action. The state will be as at the moment of halting (default)\n   * 1: Final state. Transitionable will be set to state = 1.\n   * -1: Reset state. Transitionable will be reset to state = 0.\n   * The animation's promise will be rejected since the transition has been\n   * interrupted.\n   * @param {number=} opt_dir\n   */\n  halt(opt_dir) {\n    this.complete_(/* success */ false, /* dir */ opt_dir || 0);\n  }\n\n  /**\n   * @param {boolean} success\n   * @param {number} dir\n   * @private\n   */\n  complete_(success, dir) {\n    if (!this.running_) {\n      return;\n    }\n    this.running_ = false;\n    if (dir != 0) {\n      // Sort in the completion order.\n      if (this.segments_.length > 1) {\n        this.segments_.sort((s1, s2) => {\n          return (s1.delay + s1.duration) - (s2.delay + s2.duration);\n        });\n      }\n      try {\n        if (dir > 0) {\n          // Natural order - all set to 1.\n          for (let i = 0; i < this.segments_.length; i++) {\n            this.segments_[i].func(1, true);\n          }\n        } else {\n          // Reverse order - all set to 0.\n          for (let i = this.segments_.length - 1; i >= 0; i--) {\n            this.segments_[i].func(0, false);\n          }\n        }\n      } catch (e) {\n        dev().error(TAG_, 'completion failed: ' + e, e);\n        success = false;\n      }\n    }\n    if (success) {\n      this.resolve_();\n    } else {\n      this.reject_();\n    }\n  }\n\n  /**\n   * @param {!Object<string, *>} unusedState\n   * @private\n   */\n  stepMutate_(unusedState) {\n    if (!this.running_) {\n      return;\n    }\n    const currentTime = Date.now();\n    const normLinearTime = Math.min((currentTime - this.startTime_) /\n        this.duration_, 1);\n\n    // Start segments due to be started\n    for (let i = 0; i < this.segments_.length; i++) {\n      const segment = this.segments_[i];\n      if (!segment.started && normLinearTime >= segment.delay) {\n        segment.started = true;\n      }\n    }\n\n    // Execute all pending segments.\n    for (let i = 0; i < this.segments_.length; i++) {\n      const segment = this.segments_[i];\n      if (!segment.started || segment.completed) {\n        continue;\n      }\n      this.mutateSegment_(segment, normLinearTime);\n    }\n\n    // Complete or start next cycle.\n    if (normLinearTime == 1) {\n      this.complete_(/* success */ true, /* dir */ 0);\n    } else {\n      if (this.vsync_.canAnimate(this.contextNode_)) {\n        this.task_(this.state_);\n      } else {\n        dev().warn(TAG_, 'cancel animation');\n        this.complete_(/* success */ false, /* dir */ 0);\n      }\n    }\n  }\n\n  /**\n   * @param {!SegmentRuntimeDef} segment\n   * @param {number} totalLinearTime\n   */\n  mutateSegment_(segment, totalLinearTime) {\n    let normLinearTime;\n    let normTime;\n    if (segment.duration > 0) {\n      normLinearTime = Math.min((totalLinearTime - segment.delay) /\n          segment.duration, 1);\n      normTime = normLinearTime;\n      if (segment.curve && normTime != 1) {\n        try {\n          normTime = segment.curve(normLinearTime);\n        } catch (e) {\n          dev().error(TAG_, 'step curve failed: ' + e, e);\n          this.complete_(/* success */ false, /* dir */ 0);\n          return;\n        }\n      }\n    } else {\n      normLinearTime = 1;\n      normTime = 1;\n    }\n    if (normLinearTime == 1) {\n      segment.completed = true;\n    }\n    try {\n      segment.func(normTime, segment.completed);\n    } catch (e) {\n      dev().error(TAG_, 'step mutate failed: ' + e, e);\n      this.complete_(/* success */ false, /* dir */ 0);\n      return;\n    }\n  }\n}\n\n\n/**\n * @typedef {{\n *   delay: ./time.normtimeDef,\n *   func: !TransitionDef,\n *   duration: ./time.normtimeDef,\n *   curve: ?./curve.CurveDef\n * }}\n */\nlet SegmentDef;\n\n\n/**\n * @typedef {{\n *   delay: ./time.normtimeDef,\n *   func: !TransitionDef,\n *   duration: ./time.normtimeDef,\n *   curve: ?./curve.CurveDef,\n *   started: boolean,\n *   completed: boolean\n * }}\n */\nlet SegmentRuntimeDef;\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Allows for runtime configuration. Internally, the runtime should\n * use the src/config.js module for various constants. We can use the\n * AMP_CONFIG global to translate user-defined configurations to this\n * module.\n * @type {!Object<string, string>}\n */\nconst env = self.AMP_CONFIG || {};\n\nconst thirdPartyFrameRegex = typeof env['thirdPartyFrameRegex'] == 'string' ?\n  new RegExp(env['thirdPartyFrameRegex']) : env['thirdPartyFrameRegex'];\n\nconst cdnProxyRegex = typeof env['cdnProxyRegex'] == 'string' ?\n  new RegExp(env['cdnProxyRegex']) : env['cdnProxyRegex'];\n\n/** @type {!Object<string, string|boolean|RegExp>} */\nexport const urls = {\n  thirdParty: env['thirdPartyUrl'] || 'https://3p.ampproject.net',\n  thirdPartyFrameHost: env['thirdPartyFrameHost'] || 'ampproject.net',\n  thirdPartyFrameRegex: thirdPartyFrameRegex || /^d-\\d+\\.ampproject\\.net$/,\n  cdn: env['cdnUrl'] || 'https://cdn.ampproject.org',\n  /* Note that cdnProxyRegex is only ever checked against origins\n   * (proto://host[:port]) so does not need to consider path\n   */\n  cdnProxyRegex: cdnProxyRegex ||\n      /^https:\\/\\/([a-zA-Z0-9_-]+\\.)?cdn\\.ampproject\\.org$/,\n  localhostRegex: /^https?:\\/\\/localhost(:\\d+)?$/,\n  errorReporting: env['errorReportingUrl'] ||\n      'https://amp-error-reporting.appspot.com/r',\n  localDev: env['localDev'] || false,\n};\n\nexport const config = {\n  urls,\n};\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {endsWith} from './string';\nimport {\n  isProxyOrigin,\n  parseUrlDeprecated,\n  tryDecodeUriComponent,\n} from './url';\nimport {urls} from './config';\n\n\n/**\n * Returns the value of the cookie. The cookie access is restricted and must\n * go through the privacy review. Before using this method please file a\n * GitHub issue with \"Privacy Review\" label.\n *\n * Returns the cookie's value or `null`.\n *\n * @param {!Window} win\n * @param {string} name\n * @return {?string}\n */\nexport function getCookie(win, name) {\n  const cookieString = tryGetDocumentCookieNoInline(win);\n  if (!cookieString) {\n    return null;\n  }\n  const cookies = cookieString.split(';');\n  for (let i = 0; i < cookies.length; i++) {\n    const cookie = cookies[i].trim();\n    const eq = cookie.indexOf('=');\n    if (eq == -1) {\n      continue;\n    }\n    if (tryDecodeUriComponent(cookie.substring(0, eq).trim()) == name) {\n      const value = cookie.substring(eq + 1).trim();\n      return tryDecodeUriComponent(value, value);\n    }\n  }\n  return null;\n}\n\n/**\n * This method should not be inlined to prevent TryCatch deoptimization.\n * NoInline keyword at the end of function name also prevents Closure compiler\n * from inlining the function.\n * @param {!Window} win\n * @return {string}\n */\nfunction tryGetDocumentCookieNoInline(win) {\n  try {\n    return win.document.cookie;\n  } catch (e) {\n    // Act as if no cookie is available. Exceptions can be thrown when\n    // AMP docs are opened on origins that do not allow setting\n    // cookies such as null origins.\n    return '';\n  }\n}\n\n/**\n * Sets the value of the cookie. The cookie access is restricted and must\n * go through the privacy review. Before using this method please file a\n * GitHub issue with \"Privacy Review\" label.\n *\n * @param {!Window} win\n * @param {string} name\n * @param {string} value\n * @param {time} expirationTime\n * @param {{\n *   highestAvailableDomain:(boolean|undefined),\n *   domain:(string|undefined)\n * }=} opt_options\n *     - highestAvailableDomain: If true, set the cookie at the widest domain\n *       scope allowed by the browser. E.g. on example.com if we are currently\n *       on www.example.com.\n *     - domain: Explicit domain to set.\n *     - allowOnProxyOrigin: Allow setting a cookie on the AMP Cache.\n */\nexport function setCookie(win, name, value, expirationTime, opt_options) {\n  checkOriginForSettingCookie(win, opt_options, name);\n  if (opt_options && opt_options.highestAvailableDomain) {\n    const parts = win.location.hostname.split('.');\n    let domain = parts[parts.length - 1];\n    for (let i = parts.length - 2; i >= 0; i--) {\n      domain = parts[i] + '.' + domain;\n      trySetCookie(win, name, value, expirationTime, domain);\n      if (getCookie(win, name) == value) {\n        return;\n      }\n    }\n  }\n  let domain = undefined;\n  if (opt_options && opt_options.domain) {\n    domain = opt_options.domain;\n  }\n  trySetCookie(win, name, value, expirationTime, domain);\n}\n\n/**\n * Attempt to set a cookie with the given params.\n *\n * @param {!Window} win\n * @param {string} name\n * @param {string} value\n * @param {time} expirationTime\n * @param {string|undefined} domain\n */\nfunction trySetCookie(win, name, value, expirationTime, domain) {\n  // We do not allow setting cookies on the domain that contains both\n  // the cdn. and www. hosts.\n  if (domain == 'ampproject.org') {\n    // Actively delete them.\n    value = 'delete';\n    expirationTime = 0;\n  }\n  const cookie = encodeURIComponent(name) + '=' +\n      encodeURIComponent(value) +\n      '; path=/' +\n      (domain ? '; domain=' + domain : '') +\n      '; expires=' + new Date(expirationTime).toUTCString();\n  try {\n    win.document.cookie = cookie;\n  } catch (ignore) {\n    // Do not throw if setting the cookie failed Exceptions can be thrown\n    // when AMP docs are opened on origins that do not allow setting\n    // cookies such as null origins.\n  }\n}\n\n/**\n * Throws if a given cookie should not be set on the given origin.\n * This is a defense-in-depth. Callers should never run into this.\n *\n * @param {!Window} win\n * @param {!Object|undefined} options\n * @param {string} name For the error message.\n */\nfunction checkOriginForSettingCookie(win, options, name) {\n  if (options && options.allowOnProxyOrigin) {\n    return;\n  }\n  if (isProxyOrigin(win.location.href)) {\n    throw new Error('Should never attempt to set cookie on proxy origin: '\n        + name);\n  }\n\n  const current = parseUrlDeprecated(win.location.href).hostname.toLowerCase();\n  const proxy = parseUrlDeprecated(urls.cdn).hostname.toLowerCase();\n  if (current == proxy || endsWith(current, '.' + proxy)) {\n    throw new Error('Should never attempt to set cookie on proxy origin.'\n        + ' (in depth check): ' + name);\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Imported just for the side effect of getting the `types` it exports into\n// the type system during compile time.\nimport './time';\n\n\n/**\n * A CurveDef is a function that returns a normtime value (0 to 1) for another\n * normtime value.\n * @typedef {function(./time.normtimeDef): ./time.normtimeDef}\n */\nexport let CurveDef;\n\n\n/**\n * Returns a cubic bezier curve.\n * @param {number} x1 X coordinate of the first control point.\n * @param {number} y1 Y coordinate of the first control point.\n * @param {number} x2 X coordinate of the second control point.\n * @param {number} y2 Y coordinate of the second control point.\n * @return {!CurveDef}\n */\nexport function bezierCurve(x1, y1, x2, y2) {\n  const bezier = new Bezier(0, 0, x1, y1, x2, y2, 1, 1);\n  return bezier.solveYValueFromXValue.bind(bezier);\n}\n\n\n/**\n * Thanks to\n * https://closure-library.googlecode.com/git-history/docs/local_closure_goog_math_bezier.js.source.html\n */\nclass Bezier {\n\n  /**\n   * @param {number} x0 X coordinate of the start point.\n   * @param {number} y0 Y coordinate of the start point.\n   * @param {number} x1 X coordinate of the first control point.\n   * @param {number} y1 Y coordinate of the first control point.\n   * @param {number} x2 X coordinate of the second control point.\n   * @param {number} y2 Y coordinate of the second control point.\n   * @param {number} x3 X coordinate of the end point.\n   * @param {number} y3 Y coordinate of the end point.\n   */\n  constructor(x0, y0, x1, y1, x2, y2, x3, y3) {\n    /**\n     * X coordinate of the first point.\n     * @type {number}\n     */\n    this.x0 = x0;\n\n    /**\n     * Y coordinate of the first point.\n     * @type {number}\n     */\n    this.y0 = y0;\n\n    /**\n     * X coordinate of the first control point.\n     * @type {number}\n     */\n    this.x1 = x1;\n\n    /**\n     * Y coordinate of the first control point.\n     * @type {number}\n     */\n    this.y1 = y1;\n\n    /**\n     * X coordinate of the second control point.\n     * @type {number}\n     */\n    this.x2 = x2;\n\n    /**\n     * Y coordinate of the second control point.\n     * @type {number}\n     */\n    this.y2 = y2;\n\n    /**\n     * X coordinate of the end point.\n     * @type {number}\n     */\n    this.x3 = x3;\n\n    /**\n     * Y coordinate of the end point.\n     * @type {number}\n     */\n    this.y3 = y3;\n  }\n\n  /**\n   * Computes the y coordinate of a point on the curve given its x coordinate.\n   * @param {number} xVal The x coordinate of the point on the curve.\n   * @return {number} The y coordinate of the point on the curve.\n   */\n  solveYValueFromXValue(xVal) {\n    return this.getPointY(this.solvePositionFromXValue(xVal));\n  }\n\n  /**\n   * Computes the position t of a point on the curve given its x coordinate.\n   * That is, for an input xVal, finds t s.t. getPointX(t) = xVal.\n   * As such, the following should always be true up to some small epsilon:\n   * t ~ solvePositionFromXValue(getPointX(t)) for t in [0, 1].\n   * @param {number} xVal The x coordinate of the point to find on the curve.\n   * @return {number} The position t.\n   */\n  solvePositionFromXValue(xVal) {\n    // Desired precision on the computation.\n    const epsilon = 1e-6;\n\n    // Initial estimate of t using linear interpolation.\n    let t = (xVal - this.x0) / (this.x3 - this.x0);\n    if (t <= 0) {\n      return 0;\n    } else if (t >= 1) {\n      return 1;\n    }\n\n    // Try gradient descent to solve for t. If it works, it is very fast.\n    let tMin = 0;\n    let tMax = 1;\n    let value = 0;\n    for (let i = 0; i < 8; i++) {\n      value = this.getPointX(t);\n      const derivative = (this.getPointX(t + epsilon) - value) / epsilon;\n      if (Math.abs(value - xVal) < epsilon) {\n        return t;\n      } else if (Math.abs(derivative) < epsilon) {\n        break;\n      } else {\n        if (value < xVal) {\n          tMin = t;\n        } else {\n          tMax = t;\n        }\n        t -= (value - xVal) / derivative;\n      }\n    }\n\n    // If the gradient descent got stuck in a local minimum, e.g. because\n    // the derivative was close to 0, use a Dichotomy refinement instead.\n    // We limit the number of iterations to 8.\n    for (let i = 0; Math.abs(value - xVal) > epsilon && i < 8; i++) {\n      if (value < xVal) {\n        tMin = t;\n        t = (t + tMax) / 2;\n      } else {\n        tMax = t;\n        t = (t + tMin) / 2;\n      }\n      value = this.getPointX(t);\n    }\n    return t;\n  }\n\n  /**\n   * Computes the curve's X coordinate at a point between 0 and 1.\n   * @param {number} t The point on the curve to find.\n   * @return {number} The computed coordinate.\n   */\n  getPointX(t) {\n    // Special case start and end.\n    if (t == 0) {\n      return this.x0;\n    } else if (t == 1) {\n      return this.x3;\n    }\n\n    // Step one - from 4 points to 3\n    let ix0 = this.lerp(this.x0, this.x1, t);\n    let ix1 = this.lerp(this.x1, this.x2, t);\n    const ix2 = this.lerp(this.x2, this.x3, t);\n\n    // Step two - from 3 points to 2\n    ix0 = this.lerp(ix0, ix1, t);\n    ix1 = this.lerp(ix1, ix2, t);\n\n    // Final step - last point\n    return this.lerp(ix0, ix1, t);\n  }\n\n  /**\n   * Computes the curve's Y coordinate at a point between 0 and 1.\n   * @param {number} t The point on the curve to find.\n   * @return {number} The computed coordinate.\n   */\n  getPointY(t) {\n    // Special case start and end.\n    if (t == 0) {\n      return this.y0;\n    } else if (t == 1) {\n      return this.y3;\n    }\n\n    // Step one - from 4 points to 3\n    let iy0 = this.lerp(this.y0, this.y1, t);\n    let iy1 = this.lerp(this.y1, this.y2, t);\n    const iy2 = this.lerp(this.y2, this.y3, t);\n\n    // Step two - from 3 points to 2\n    iy0 = this.lerp(iy0, iy1, t);\n    iy1 = this.lerp(iy1, iy2, t);\n\n    // Final step - last point\n    return this.lerp(iy0, iy1, t);\n  }\n\n  /**\n   * Performs linear interpolation between values a and b. Returns the value\n   * between a and b proportional to x (when x is between 0 and 1. When x is\n   * outside this range, the return value is a linear extrapolation).\n   * @param {number} a A number.\n   * @param {number} b A number.\n   * @param {number} x The proportion between a and b.\n   * @return {number} The interpolated value between a and b.\n   */\n  lerp(a, b, x) {\n    return a + x * (b - a);\n  }\n}\n\n\n/**\n * A collection of common curves.\n * See https://developer.mozilla.org/en-US/docs/Web/CSS/timing-function\n * @enum {!CurveDef}\n */\nexport const Curves = {\n  /**\n   * linear\n   * @param {number} n\n   * @return {number}\n   */\n  LINEAR(n) {return n;},\n\n  /**\n   * ease\n   */\n  EASE: bezierCurve(0.25, 0.1, 0.25, 1.0),\n\n  /**\n   * ease-in: slow out, fast in\n   */\n  EASE_IN: bezierCurve(0.42, 0.0, 1.0, 1.0),\n\n  /**\n   * ease-out: fast out, slow in\n   */\n  EASE_OUT: bezierCurve(0.0, 0.0, 0.58, 1.0),\n\n  /**\n   * ease-in-out\n   */\n  EASE_IN_OUT: bezierCurve(0.42, 0.0, 0.58, 1.0),\n};\n\n\n/**\n * @const {!Object<string, !CurveDef>}\n */\nconst NAME_MAP = {\n  'linear': Curves.LINEAR,\n  'ease': Curves.EASE,\n  'ease-in': Curves.EASE_IN,\n  'ease-out': Curves.EASE_OUT,\n  'ease-in-out': Curves.EASE_IN_OUT,\n};\n\n\n/**\n * If the argument is a string, this methods matches an existing curve by name.\n * @param {?CurveDef|string|undefined} curve\n * @return {?CurveDef}\n */\nexport function getCurve(curve) {\n  if (!curve) {\n    return null;\n  }\n  if (typeof curve == 'string') {\n    // If the curve is a custom cubic-bezier curve\n    if (curve.indexOf('cubic-bezier') != -1) {\n      const match = curve.match(/cubic-bezier\\((.+)\\)/);\n      if (match) {\n        const values = match[1].split(',').map(parseFloat);\n        if (values.length == 4) {\n          for (let i = 0; i < 4; i++) {\n            if (isNaN(values[i])) {\n              return null;\n            }\n          }\n          return bezierCurve(values[0], values[1], values[2], values[3]);\n        }\n      }\n      return null;\n    }\n    return NAME_MAP[curve];\n  }\n  return curve;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Deferred} from './utils/promise';\nimport {cssEscape} from '../third_party/css-escape/css-escape';\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {startsWith} from './string';\nimport {toWin} from './types';\n\nconst HTML_ESCAPE_CHARS = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;',\n};\nconst HTML_ESCAPE_REGEX = /(&|<|>|\"|'|`)/g;\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_PROMISE =\n    '__AMP_UPG_PRM';\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_RESOLVER =\n    '__AMP_UPG_RES';\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * callback is executed.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @param {function()} callback\n */\nexport function waitForChild(parent, checkFunc, callback) {\n  if (checkFunc(parent)) {\n    callback();\n    return;\n  }\n  /** @const {!Window} */\n  const win = toWin(parent.ownerDocument.defaultView);\n  if (win.MutationObserver) {\n    /** @const {MutationObserver} */\n    const observer = new win.MutationObserver(() => {\n      if (checkFunc(parent)) {\n        observer.disconnect();\n        callback();\n      }\n    });\n    observer.observe(parent, {childList: true});\n  } else {\n    /** @const {number} */\n    const interval = win.setInterval(() => {\n      if (checkFunc(parent)) {\n        win.clearInterval(interval);\n        callback();\n      }\n    }, /* milliseconds */ 5);\n  }\n}\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * promise is resolved.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @return {!Promise}\n */\nexport function waitForChildPromise(parent, checkFunc) {\n  return new Promise(resolve => {\n    waitForChild(parent, checkFunc, resolve);\n  });\n}\n\n/**\n * Waits for document's body to be available.\n * Will be deprecated soon; use {@link AmpDoc#whenBodyAvailable} or\n * @{link DocumentState#onBodyAvailable} instead.\n * @param {!Document} doc\n * @param {function()} callback\n */\nexport function waitForBody(doc, callback) {\n  waitForChild(doc.documentElement, () => !!doc.body, callback);\n}\n\n\n/**\n * Waits for document's body to be available.\n * @param {!Document} doc\n * @return {!Promise}\n */\nexport function waitForBodyPromise(doc) {\n  return new Promise(resolve => {\n    waitForBody(doc, resolve);\n  });\n}\n\n\n/**\n * Removes the element.\n * @param {!Element} element\n */\nexport function removeElement(element) {\n  if (element.parentElement) {\n    element.parentElement.removeChild(element);\n  }\n}\n\n\n/**\n * Removes all child nodes of the specified element.\n * @param {!Element} parent\n */\nexport function removeChildren(parent) {\n  while (parent.firstChild) {\n    parent.removeChild(parent.firstChild);\n  }\n}\n\n\n/**\n * Copies all children nodes of element \"from\" to element \"to\". Child nodes\n * are deeply cloned. Notice, that this method should be used with care and\n * preferably on smaller subtrees.\n * @param {!Element} from\n * @param {!Element|!DocumentFragment} to\n */\nexport function copyChildren(from, to) {\n  const frag = to.ownerDocument.createDocumentFragment();\n  for (let n = from.firstChild; n; n = n.nextSibling) {\n    frag.appendChild(n.cloneNode(true));\n  }\n  to.appendChild(frag);\n}\n\n/**\n * Insert the element in the root after the element named after or\n * if that is null at the beginning.\n * @param {!Element|!ShadowRoot} root\n * @param {!Element} element\n * @param {?Node} after\n */\nexport function insertAfterOrAtStart(root, element, after) {\n  const before = after ? after.nextSibling : root.firstChild;\n  root.insertBefore(element, before);\n}\n\n/**\n * Add attributes to an element.\n * @param {!Element} element\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function addAttributesToElement(element, attributes) {\n  for (const attr in attributes) {\n    element.setAttribute(attr, attributes[attr]);\n  }\n  return element;\n}\n\n/**\n * Create a new element on document with specified tagName and attributes.\n * @param {!Document} doc\n * @param {string} tagName\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function createElementWithAttributes(doc, tagName, attributes) {\n  const element = doc.createElement(tagName);\n  return addAttributesToElement(element, attributes);\n}\n\n/**\n * Returns true if node is connected (attached).\n * @param {!Node} node\n * @return {boolean}\n * @see https://dom.spec.whatwg.org/#connected\n */\nexport function isConnectedNode(node) {\n  const connected = node.isConnected;\n  if (connected !== undefined) {\n    return connected;\n  }\n\n  // \"An element is connected if its shadow-including root is a document.\"\n  let n = node;\n  do {\n    n = rootNodeFor(n);\n    if (n.host) {\n      n = n.host;\n    } else {\n      break;\n    }\n  } while (true);\n  return n.nodeType === Node.DOCUMENT_NODE;\n}\n\n/**\n * Returns the root for a given node. Does not cross shadow DOM boundary.\n * @param {!Node} node\n * @return {!Node}\n */\nexport function rootNodeFor(node) {\n  if (Node.prototype.getRootNode) {\n    // Type checker says `getRootNode` may return null.\n    return node.getRootNode() || node;\n  }\n  let n;\n  for (n = node; !!n.parentNode; n = n.parentNode) {}\n  return n;\n}\n\n/**\n * Finds the closest element that satisfies the callback from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {function(!Element):boolean} callback\n * @param {Element=} opt_stopAt optional elemnt to stop the search at.\n * @return {?Element}\n */\nexport function closest(element, callback, opt_stopAt) {\n  for (let el = element; el && el !== opt_stopAt; el = el.parentElement) {\n    if (callback(el)) {\n      return el;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest node that satisfies the callback from this node\n * up the DOM subtree.\n * @param {!Node} node\n * @param {function(!Node):boolean} callback\n * @return {?Node}\n */\nexport function closestNode(node, callback) {\n  for (let n = node; n; n = n.parentNode) {\n    if (callback(n)) {\n      return n;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest element with the specified name from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function closestByTag(element, tagName) {\n  if (element.closest) {\n    return element.closest(tagName);\n  }\n  tagName = tagName.toUpperCase();\n  return closest(element, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Finds the closest element with the specified selector from this element\n * @param {!Element} element\n * @param {string} selector\n * @return {?Element} closest ancestor if found.\n */\nexport function closestBySelector(element, selector) {\n  if (element.closest) {\n    return element.closest(selector);\n  }\n\n  return closest(element, el => {\n    return matches(el, selector);\n  });\n}\n\n/**\n * Checks if the given element matches the selector\n * @param  {!Element} el The element to verify\n * @param  {string} selector The selector to check against\n * @return {boolean} True if the element matched the selector. False otherwise.\n */\nexport function matches(el, selector) {\n  const matcher = el.matches ||\n      el.webkitMatchesSelector ||\n      el.mozMatchesSelector ||\n      el.msMatchesSelector ||\n      el.oMatchesSelector;\n  if (matcher) {\n    return matcher.call(el, selector);\n  }\n  return false; // IE8 always returns false.\n}\n\n/**\n * Finds the first descendant element with the specified name.\n * @param {!Element|!Document|!ShadowRoot} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function elementByTag(element, tagName) {\n  let elements;\n  // getElementsByTagName() is not supported on ShadowRoot.\n  if (typeof element.getElementsByTagName === 'function') {\n    elements = element.getElementsByTagName(tagName);\n  } else {\n    elements = element./*OK*/querySelectorAll(tagName);\n  }\n  return (elements && elements[0]) || null;\n}\n\n\n/**\n * Finds the first child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function childElement(parent, callback) {\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds all child elements that satisfy the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {!Array<!Element>}\n */\nexport function childElements(parent, callback) {\n  const children = [];\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      children.push(child);\n    }\n  }\n  return children;\n}\n\n\n/**\n * Finds the last child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function lastChildElement(parent, callback) {\n  for (let child = parent.lastElementChild; child;\n    child = child.previousElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n/**\n * Finds all child nodes that satisfy the callback.\n * These nodes can include Text, Comment and other child nodes.\n * @param {!Node} parent\n * @param {function(!Node):boolean} callback\n * @return {!Array<!Node>}\n */\nexport function childNodes(parent, callback) {\n  const nodes = [];\n  for (let child = parent.firstChild; child;\n    child = child.nextSibling) {\n    if (callback(child)) {\n      nodes.push(child);\n    }\n  }\n  return nodes;\n}\n\n/**\n * @type {boolean|undefined}\n * @visibleForTesting\n */\nlet scopeSelectorSupported;\n\n/**\n * @param {boolean|undefined} val\n * @visibleForTesting\n */\nexport function setScopeSelectorSupportedForTesting(val) {\n  scopeSelectorSupported = val;\n}\n\n/**\n * Test that the :scope selector is supported and behaves correctly.\n * @param {!Element} parent\n * @return {boolean}\n */\nfunction isScopeSelectorSupported(parent) {\n  const doc = parent.ownerDocument;\n  try {\n    const testElement = doc.createElement('div');\n    const testChild = doc.createElement('div');\n    testElement.appendChild(testChild);\n    // NOTE(cvializ, #12383): Firefox's implementation is incomplete,\n    // therefore we test actual functionality of`:scope` as well.\n    return testElement./*OK*/querySelector(':scope div') === testChild;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Finds the first child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function childElementByAttr(parent, attr) {\n  return scopedQuerySelector/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the last child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function lastChildElementByAttr(parent, attr) {\n  return lastChildElement(parent, el => {\n    return el.hasAttribute(attr);\n  });\n}\n\n\n/**\n * Finds all child elements that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByAttr(parent, attr) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the first child element that has the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {?Element}\n */\nexport function childElementByTag(parent, tagName) {\n  return scopedQuerySelector/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds all child elements with the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByTag(parent, tagName) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds the first element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {?Element}\n */\nexport function scopedQuerySelector(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelector(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const element = root./*OK*/querySelector(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return element;\n}\n\n\n/**\n * Finds the every element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {!NodeList<!Element>}\n */\nexport function scopedQuerySelectorAll(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelectorAll(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const elements = root./*OK*/querySelectorAll(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return elements;\n}\n\n\n/**\n * Returns element data-param- attributes as url parameters key-value pairs.\n * e.g. data-param-some-attr=value -> {someAttr: value}.\n * @param {!Element} element\n * @param {function(string):string=} opt_computeParamNameFunc to compute the\n *    parameter name, get passed the camel-case parameter name.\n * @param {!RegExp=} opt_paramPattern Regex pattern to match data attributes.\n * @return {!JsonObject}\n */\nexport function getDataParamsFromAttributes(element, opt_computeParamNameFunc,\n  opt_paramPattern) {\n  const computeParamNameFunc = opt_computeParamNameFunc || (key => key);\n  const {dataset} = element;\n  const params = dict();\n  const paramPattern = opt_paramPattern ? opt_paramPattern : /^param(.+)/;\n  for (const key in dataset) {\n    const matches = key.match(paramPattern);\n    if (matches) {\n      const param = matches[1][0].toLowerCase() + matches[1].substr(1);\n      params[computeParamNameFunc(param)] = dataset[key];\n    }\n  }\n  return params;\n}\n\n/**\n * Whether the element have a next node in the document order.\n * This means either:\n *  a. The element itself has a nextSibling.\n *  b. Any of the element ancestors has a nextSibling.\n * @param {!Element} element\n * @param {?Node} opt_stopNode\n * @return {boolean}\n */\nexport function hasNextNodeInDocumentOrder(element, opt_stopNode) {\n  let currentElement = element;\n  do {\n    if (currentElement.nextSibling) {\n      return true;\n    }\n  } while ((currentElement = currentElement.parentNode) &&\n            currentElement != opt_stopNode);\n  return false;\n}\n\n\n/**\n * Finds all ancestor elements that satisfy predicate.\n * @param {!Element} child\n * @param {function(!Element):boolean} predicate\n * @return {!Array<!Element>}\n */\nexport function ancestorElements(child, predicate) {\n  const ancestors = [];\n  for (let ancestor = child.parentElement; ancestor;\n    ancestor = ancestor.parentElement) {\n    if (predicate(ancestor)) {\n      ancestors.push(ancestor);\n    }\n  }\n  return ancestors;\n}\n\n\n/**\n * Finds all ancestor elements that has the specified tag name.\n * @param {!Element} child\n * @param {string} tagName\n * @return {!Array<!Element>}\n */\nexport function ancestorElementsByTag(child, tagName) {\n  tagName = tagName.toUpperCase();\n  return ancestorElements(child, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Returns a clone of the content of a template element.\n *\n * Polyfill to replace .content access for browsers that do not support\n * HTMLTemplateElements natively.\n *\n * @param {!HTMLTemplateElement|!Element} template\n * @return {!DocumentFragment}\n */\nexport function templateContentClone(template) {\n  if ('content' in template) {\n    return template.content.cloneNode(true);\n  } else {\n    const content = template.ownerDocument.createDocumentFragment();\n    copyChildren(template, content);\n    return content;\n  }\n}\n\n/**\n * Iterate over an array-like. Some collections like NodeList are\n * lazily evaluated in some browsers, and accessing `length` forces full\n * evaluation. We can improve performance by iterating until an element is\n * `undefined` to avoid checking the `length` property.\n * Test cases: https://jsperf.com/iterating-over-collections-of-elements\n * @param {!IArrayLike<T>} iterable\n * @param {function(T, number)} cb\n * @template T\n */\nexport function iterateCursor(iterable, cb) {\n  for (let i = 0, value; (value = iterable[i]) !== undefined; i++) {\n    cb(value, i);\n  }\n}\n\n/**\n * This method wraps around window's open method. It first tries to execute\n * `open` call with the provided target and if it fails, it retries the call\n * with the `_top` target. This is necessary given that in some embedding\n * scenarios, such as iOS' WKWebView, navigation to `_blank` and other targets\n * is blocked by default.\n *\n * @param {!Window} win\n * @param {string} url\n * @param {string} target\n * @param {string=} opt_features\n * @return {?Window}\n */\nexport function openWindowDialog(win, url, target, opt_features) {\n  // Try first with the specified target. If we're inside the WKWebView or\n  // a similar environments, this method is expected to fail by default for\n  // all targets except `_top`.\n  let res;\n  try {\n    res = win.open(url, target, opt_features);\n  } catch (e) {\n    dev().error('DOM', 'Failed to open url on target: ', target, e);\n  }\n\n  // Then try with `_top` target.\n  if (!res && target != '_top') {\n    res = win.open(url, '_top');\n  }\n  return res;\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n            element.getAttribute('type').toUpperCase() == 'APPLICATION/JSON';\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonLdScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n      element.getAttribute('type').toUpperCase() == 'APPLICATION/LD+JSON';\n}\n\n/**\n * Whether the page's direction is right to left or not.\n * @param {!Document} doc\n * @return {boolean}\n */\nexport function isRTL(doc) {\n  const dir = doc.body.getAttribute('dir')\n                 || doc.documentElement.getAttribute('dir')\n                 || 'ltr';\n  return dir == 'rtl';\n}\n\n\n/**\n * Escapes an ident (ID or a class name) to be used as a CSS selector.\n *\n * See https://drafts.csswg.org/cssom/#serialize-an-identifier.\n *\n * @param {string} ident\n * @return {string}\n */\nexport function escapeCssSelectorIdent(ident) {\n  return cssEscape(ident);\n}\n\n/**\n * Escapes an ident in a way that can be used by :nth-child() psuedo-class.\n *\n * See https://github.com/w3c/csswg-drafts/issues/2306.\n *\n * @param {string|number} ident\n * @return {string}\n */\nexport function escapeCssSelectorNth(ident) {\n  const escaped = String(ident);\n  // Ensure it doesn't close the nth-child psuedo class.\n  dev().assert(escaped.indexOf(')') === -1);\n  return escaped;\n}\n\n/**\n * Escapes `<`, `>` and other HTML charcaters with their escaped forms.\n * @param {string} text\n * @return {string}\n */\nexport function escapeHtml(text) {\n  if (!text) {\n    return text;\n  }\n  return text.replace(HTML_ESCAPE_REGEX, escapeHtmlChar);\n}\n\n/**\n * @param {string} c\n * @return {string}\n */\nfunction escapeHtmlChar(c) {\n  return HTML_ESCAPE_CHARS[c];\n}\n\n/**\n * Tries to focus on the given element; fails silently if browser throws an\n * exception.\n * @param {!Element} element\n */\nexport function tryFocus(element) {\n  try {\n    element./*OK*/focus();\n  } catch (e) {\n    // IE <= 7 may throw exceptions when focusing on hidden items.\n  }\n}\n\n/**\n * Whether the given window is in an iframe or not.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isIframed(win) {\n  return win.parent && win.parent != win;\n}\n\n/**\n * Determines if this element is an AMP element\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isAmpElement(element) {\n  const tag = element.tagName;\n  // Use prefix to recognize AMP element. This is necessary because stub\n  // may not be attached yet.\n  return startsWith(tag, 'AMP-') &&\n      // Some \"amp-*\" elements are not really AMP elements. :smh:\n      !(tag == 'AMP-STICKY-AD-TOP-PADDING' || tag == 'AMP-BODY');\n}\n\n/**\n * Return a promise that resolve when an AMP element upgrade from HTMLElement\n * to CustomElement\n * @param {!Element} element\n * @return {!Promise<!Element>}\n */\nexport function whenUpgradedToCustomElement(element) {\n  dev().assert(isAmpElement(element), 'element is not AmpElement');\n  if (element.createdCallback) {\n    // Element already is CustomElement;\n    return Promise.resolve(element);\n  }\n  // If Element is still HTMLElement, wait for it to upgrade to customElement\n  // Note: use pure string to avoid obfuscation between versions.\n  if (!element[UPGRADE_TO_CUSTOMELEMENT_PROMISE]) {\n    const deferred = new Deferred();\n    element[UPGRADE_TO_CUSTOMELEMENT_PROMISE] = deferred.promise;\n    element[UPGRADE_TO_CUSTOMELEMENT_RESOLVER] = deferred.resolve;\n\n  }\n\n  return element[UPGRADE_TO_CUSTOMELEMENT_PROMISE];\n}\n\n/**\n * Replacement for `Element.requestFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Element/requestFullscreen\n * @param {!Element} element\n */\nexport function fullscreenEnter(element) {\n  const requestFs = element.requestFullscreen\n   || element.requestFullScreen\n   || element.webkitRequestFullscreen\n   || element.webkitRequestFullScreen\n   || element.webkitEnterFullscreen\n   || element.webkitEnterFullScreen\n   || element.msRequestFullscreen\n   || element.msRequestFullScreen\n   || element.mozRequestFullscreen\n   || element.mozRequestFullScreen;\n  if (requestFs) {\n    requestFs.call(element);\n  }\n}\n\n/**\n * Replacement for `Document.exitFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/exitFullscreen\n * @param {!Element} element\n */\nexport function fullscreenExit(element) {\n  let exitFs = element.cancelFullScreen\n               || element.exitFullscreen\n               || element.exitFullScreen\n               || element.webkitExitFullscreen\n               || element.webkitExitFullScreen\n               || element.webkitCancelFullScreen\n               || element.mozCancelFullScreen\n               || element.msExitFullscreen;\n  if (exitFs) {\n    exitFs.call(element);\n    return;\n  }\n  if (element.ownerDocument) {\n    exitFs = element.ownerDocument.cancelFullScreen\n             || element.ownerDocument.exitFullscreen\n             || element.ownerDocument.exitFullScreen\n             || element.ownerDocument.webkitExitFullscreen\n             || element.ownerDocument.webkitExitFullScreen\n             || element.ownerDocument.webkitCancelFullScreen\n             || element.ownerDocument.mozCancelFullScreen\n             || element.ownerDocument.msExitFullscreen;\n  }\n  if (exitFs) {\n    exitFs.call(element.ownerDocument);\n    return;\n  }\n}\n\n\n/**\n * Replacement for `Document.fullscreenElement`.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/fullscreenElement\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isFullscreenElement(element) {\n  const isFullscreen = element.webkitDisplayingFullscreen;\n  if (isFullscreen) {\n    return true;\n  }\n  if (element.ownerDocument) {\n    const fullscreenElement = element.ownerDocument.fullscreenElement\n             || element.ownerDocument.webkitFullscreenElement\n             || element.ownerDocument.mozFullScreenElement\n             || element.webkitCurrentFullScreenElement;\n    if (fullscreenElement == element) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Returns true if node is not disabled.\n *\n * IE8 can return false positives, see {@link matches}.\n * @param {!Element} element\n * @return {boolean}\n * @see https://www.w3.org/TR/html5/forms.html#concept-fe-disabled\n */\nexport function isEnabled(element) {\n  return !(element.disabled || matches(element, ':disabled'));\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as dom from './dom';\nimport {\n  getAmpdoc,\n  getExistingServiceForDocInEmbedScope,\n  getService,\n  getServicePromise,\n  getServicePromiseForDoc,\n  getServicePromiseOrNull,\n  getServicePromiseOrNullForDoc,\n  getTopWindow,\n} from './service';\nimport {toWin} from './types';\nimport {user} from './log';\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. Services.viewportForDoc(...)) for type safety and because the\n * factory should not be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an element,\n *     not the extension.\n * @return {!Promise<*>}\n */\nexport function getElementService(win, id, extension, opt_element) {\n  return getElementServiceIfAvailable(win, id, extension, opt_element).then(\n      service => assertService(service, id, extension));\n}\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailable(win, id, extension, opt_element) {\n  const s = getServicePromiseOrNull(win, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n  return getElementServicePromiseOrNull(win, id, extension, opt_element);\n}\n\n/**\n * @param {!Window} win\n * @param {string} elementName Name of an extended custom element.\n * @return {boolean} Whether this element is scheduled to be loaded.\n */\nfunction isElementScheduled(win, elementName) {\n  // Set in custom-element.js\n  if (!win.ampExtendedElements) {\n    return false;\n  }\n  return !!win.ampExtendedElements[elementName];\n}\n\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. Services.viewportForDoc(...)) for type safety and because the\n * factory should not be passed around.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an element,\n *     not the extension.\n * @return {!Promise<*>}\n */\nexport function getElementServiceForDoc(elementOrAmpDoc, id, extension,\n  opt_element) {\n  return getElementServiceIfAvailableForDoc(\n      elementOrAmpDoc, id, extension, opt_element)\n      .then(service => assertService(service, id, extension));\n}\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDoc(\n  elementOrAmpDoc, id, extension, opt_element) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const s = getServicePromiseOrNullForDoc(elementOrAmpDoc, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n\n  return ampdoc.whenBodyAvailable()\n      .then(() => waitForExtensionIfPresent(\n          ampdoc.win, extension,\n          ampdoc.getHeadNode()))\n      .then(() => {\n        // If this service is provided by an element, then we can't depend on\n        // the service (they may not use the element).\n        if (opt_element) {\n          return getServicePromiseOrNullForDoc(elementOrAmpDoc, id);\n        } else if (isElementScheduled(ampdoc.win, extension)) {\n          return getServicePromiseForDoc(elementOrAmpDoc, id);\n        }\n        return null;\n      });\n}\n\n/**\n * Returns a promise for service for the given id in the embed scope of\n * a given node, if it exists. Otherwise, falls back to ampdoc scope IFF\n * the given node is in the top-level window.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom element that provides\n *     the implementation of this service.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDocInEmbedScope(\n  elementOrAmpDoc, id, extension) {\n  const s = getExistingServiceForDocInEmbedScope(elementOrAmpDoc, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (Promise.resolve(s));\n  }\n  // Return embed-scope element service promise if scheduled.\n  if (elementOrAmpDoc.nodeType) {\n    const win = toWin(elementOrAmpDoc.ownerDocument.defaultView);\n    const topWin = getTopWindow(win);\n    // In embeds, doc-scope services are window-scope. But make sure to\n    // only do this for embeds (not the top window), otherwise we'd grab\n    // a promise from the wrong service holder which would never resolve.\n    if (win !== topWin) {\n      return getElementServicePromiseOrNull(win, id, extension);\n    } else {\n      // Fallback to ampdoc IFF the given node is _not_ FIE.\n      return getElementServiceIfAvailableForDoc(elementOrAmpDoc, id, extension);\n    }\n  }\n  return /** @type {!Promise<?Object>} */ (Promise.resolve(null));\n}\n\n/**\n * Throws user error if `service` is null.\n * @param {Object} service\n * @param {string} id\n * @param {string} extension\n * @return {!Object}\n * @private\n */\nfunction assertService(service, id, extension) {\n  return /** @type {!Object} */ (user().assert(service,\n      'Service %s was requested to be provided through %s, ' +\n      'but %s is not loaded in the current page. To fix this ' +\n      'problem load the JavaScript file for %s in this page.',\n      id, extension, extension, extension));\n}\n\n/**\n * Get list of all the extension JS files\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @return {!Array<string>}\n */\nexport function extensionScriptsInNode(head) {\n  // ampdoc.getHeadNode() can return null\n  if (!head) {\n    return [];\n  }\n  const scripts = [];\n  const list = head.querySelectorAll('script[custom-element]');\n  for (let i = 0; i < list.length; i++) {\n    scripts.push(list[i].getAttribute('custom-element'));\n  }\n  return scripts;\n}\n\n/**\n * Waits for body to be present then verifies that an extension script is\n * present in head for installation.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n * @param {string} extensionId\n * @return {!Promise<boolean>}\n */\nexport function isExtensionScriptInNode(ampdoc, extensionId) {\n  return ampdoc.whenBodyAvailable()\n      .then(() => {\n        return extensionScriptInNode(\n            ampdoc.getHeadNode(), extensionId);\n      });\n}\n\n/**\n * Verifies that an extension script is present in head for\n * installation.\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @param {string} extensionId\n * @private\n */\nfunction extensionScriptInNode(head, extensionId) {\n  return extensionScriptsInNode(head).includes(extensionId);\n}\n\n/**\n * Waits for an extension if its script is present\n * @param {!Window} win\n * @param {string} extension\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @return {!Promise}\n * @private\n */\nfunction waitForExtensionIfPresent(win, extension, head) {\n  /**\n   * If there is an extension script wait for it to load before trying\n   * to get the service. Prevents a race condition when everything but\n   * the extensions is in cache. If there is no script then it's either\n   * not present, or the service was defined by a test. In those cases\n   * we don't wait around for an extension that does not exist.\n   */\n\n  // TODO(jpettitt) investigate registerExtension to short circuit\n  // the dom call in extensionScriptsInNode()\n  if (!extensionScriptInNode(head, extension)) {\n    return Promise.resolve();\n  }\n\n  const extensions = getService(win, 'extensions');\n  return /** @type {!Promise<?Object>} */ (\n    extensions.waitForExtension(win, extension));\n}\n\n/**\n * Returns the promise for service with `id` on the given window if available.\n * Otherwise, resolves with null (service was not registered).\n * @param {!Window} win\n * @param {string} id\n * @param {string} extension\n * @param {boolean=} opt_element\n * @return {!Promise<Object>}\n * @private\n */\nfunction getElementServicePromiseOrNull(win, id, extension, opt_element) {\n  return dom.waitForBodyPromise(win.document)\n      .then(() => waitForExtensionIfPresent(win, extension, win.document.head))\n      .then(() => {\n        // If this service is provided by an element, then we can't depend on\n        // the service (they may not use the element).\n        if (opt_element) {\n          return getServicePromiseOrNull(win, id);\n        } else if (isElementScheduled(win, extension)) {\n          return getServicePromise(win, id);\n        }\n        return null;\n      });\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n  * Whether addEventListener supports options or only takes capture as a boolean\n  * @type {boolean|undefined}\n  * @visibleForTesting\n  */\nlet optsSupported;\n\n/**\n * Listens for the specified event on the element.\n *\n * Do not use this directly. This method is implemented as a shared\n * dependency. Use `listen()` in either `event-helper` or `3p-frame-messaging`,\n * depending on your use case.\n *\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function internalListenImplementation(element, eventType, listener,\n  opt_evtListenerOpts) {\n  let localElement = element;\n  let localListener = listener;\n  /**\n   * @type {?Function}\n   */\n  let wrapped;\n\n  wrapped = event => {\n    try {\n      return localListener(event);\n    } catch (e) {\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n  };\n  const optsSupported = detectEvtListenerOptsSupport();\n  let capture = false;\n  if (opt_evtListenerOpts) {\n    capture = opt_evtListenerOpts.capture;\n  }\n  localElement.addEventListener(\n      eventType,\n      wrapped,\n      optsSupported ? opt_evtListenerOpts : capture\n  );\n  return () => {\n    if (localElement) {\n      localElement.removeEventListener(\n          eventType,\n          wrapped,\n          optsSupported ? opt_evtListenerOpts : capture\n      );\n    }\n    // Ensure these are GC'd\n    localListener = null;\n    localElement = null;\n    wrapped = null;\n  };\n}\n\n/**\n * Tests whether the browser supports options as an argument of addEventListener\n * or not.\n *\n * @return {boolean}\n */\nexport function detectEvtListenerOptsSupport() {\n  // Only run the test once\n  if (optsSupported !== undefined) {\n    return optsSupported;\n  }\n\n  optsSupported = false;\n  try {\n    // Test whether browser supports EventListenerOptions or not\n    const options = {\n      get capture() {\n        optsSupported = true;\n      },\n    };\n    self.addEventListener('test-options', null, options);\n    self.removeEventListener('test-options', null, options);\n  } catch (err) {\n    // EventListenerOptions are not supported\n  }\n  return optsSupported;\n}\n\n/**\n  * Resets the test for whether addEventListener supports options or not.\n  */\nexport function resetEvtListenerOptsSupportForTesting() {\n  optsSupported = undefined;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {internalListenImplementation} from './event-helper-listen';\nimport {user} from './log';\n\n/** @const {string}  */\nconst LOAD_FAILURE_PREFIX = 'Failed to load:';\n\n/**\n * Returns a CustomEvent with a given type and detail; supports fallback for IE.\n * @param {!Window} win\n * @param {string} type\n * @param {!JsonObject|string|undefined|null} detail\n * @param {EventInit=} opt_eventInit\n * @return {!Event}\n */\nexport function createCustomEvent(win, type, detail, opt_eventInit) {\n  const eventInit = /** @type {!CustomEventInit} */ ({detail});\n  Object.assign(eventInit, opt_eventInit);\n  // win.CustomEvent is a function on Edge, Chrome, FF, Safari but\n  // is an object on IE 11.\n  if (typeof win.CustomEvent == 'function') {\n    return new win.CustomEvent(type, eventInit);\n  } else {\n    // Deprecated fallback for IE.\n    const e = win.document.createEvent('CustomEvent');\n    e.initCustomEvent(\n        type, !!eventInit.bubbles, !!eventInit.cancelable, detail);\n    return e;\n  }\n}\n\n/**\n * Listens for the specified event on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listen(element, eventType, listener, opt_evtListenerOpts) {\n  return internalListenImplementation(\n      element, eventType, listener, opt_evtListenerOpts);\n}\n\n/**\n * Returns the data property of an event with the correct type.\n * @param {!Event|{data: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getData(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.data);\n}\n\n/**\n * Returns the detail property of an event with the correct type.\n * @param {!Event|{detail: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getDetail(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.detail);\n}\n\n/**\n * Listens for the specified event on the element and removes the listener\n * as soon as event has been received.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listenOnce(element, eventType, listener, opt_evtListenerOpts) {\n  let localListener = listener;\n  const unlisten = internalListenImplementation(element, eventType, event => {\n    try {\n      localListener(event);\n    } finally {\n      // Ensure listener is GC'd\n      localListener = null;\n      unlisten();\n    }\n  }, opt_evtListenerOpts);\n  return unlisten;\n}\n\n\n/**\n * Returns  a promise that will resolve as soon as the specified event has\n * fired on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {Object=} opt_evtListenerOpts\n * @param {function(!UnlistenDef)=} opt_cancel An optional function that, when\n *     provided, will be called with the unlistener. This gives the caller\n *     access to the unlistener, so it may be called manually when necessary.\n * @return {!Promise<!Event>}\n */\nexport function listenOncePromise(element, eventType, opt_evtListenerOpts,\n  opt_cancel) {\n  let unlisten;\n  const eventPromise = new Promise(resolve => {\n    unlisten = listenOnce(element, eventType, resolve, opt_evtListenerOpts);\n  });\n  eventPromise.then(unlisten, unlisten);\n  if (opt_cancel) {\n    opt_cancel(unlisten);\n  }\n  return eventPromise;\n}\n\n\n/**\n * Whether the specified element/window has been loaded already.\n * @param {!Element|!Window} eleOrWindow\n * @return {boolean}\n */\nexport function isLoaded(eleOrWindow) {\n  return !!(eleOrWindow.complete || eleOrWindow.readyState == 'complete'\n      // If the passed in thing is a Window, infer loaded state from\n      //\n      || (eleOrWindow.document\n          && eleOrWindow.document.readyState == 'complete'));\n}\n\n/**\n * Returns a promise that will resolve or fail based on the eleOrWindow's 'load'\n * and 'error' events. Optionally this method takes a timeout, which will reject\n * the promise if the resource has not loaded by then.\n * @param {T} eleOrWindow Supports both Elements and as a special case Windows.\n * @return {!Promise<T>}\n * @template T\n */\nexport function loadPromise(eleOrWindow) {\n  let unlistenLoad;\n  let unlistenError;\n  if (isLoaded(eleOrWindow)) {\n    return Promise.resolve(eleOrWindow);\n  }\n  const loadingPromise = new Promise((resolve, reject) => {\n    // Listen once since IE 5/6/7 fire the onload event continuously for\n    // animated GIFs.\n    const {tagName} = eleOrWindow;\n    if (tagName === 'AUDIO' || tagName === 'VIDEO') {\n      unlistenLoad = listenOnce(eleOrWindow, 'loadstart', resolve);\n    } else {\n      unlistenLoad = listenOnce(eleOrWindow, 'load', resolve);\n    }\n    // For elements, unlisten on error (don't for Windows).\n    if (tagName) {\n      unlistenError = listenOnce(eleOrWindow, 'error', reject);\n    }\n  });\n\n  return loadingPromise.then(() => {\n    if (unlistenError) {\n      unlistenError();\n    }\n    return eleOrWindow;\n  }, () => {\n    if (unlistenLoad) {\n      unlistenLoad();\n    }\n    failedToLoad(eleOrWindow);\n  });\n}\n\n/**\n * Emit error on load failure.\n * @param {!Element|!Window} eleOrWindow Supports both Elements and as a special\n *     case Windows.\n */\nfunction failedToLoad(eleOrWindow) {\n  // Report failed loads as user errors so that they automatically go\n  // into the \"document error\" bucket.\n  let target = eleOrWindow;\n  if (target && target.src) {\n    target = target.src;\n  }\n  throw user().createError(LOAD_FAILURE_PREFIX, target);\n}\n\n/**\n * Returns true if this error message is was created for a load error.\n * @param {string} message An error message\n * @return {boolean}\n */\nexport function isLoadErrorMessage(message) {\n  return message.indexOf(LOAD_FAILURE_PREFIX) != -1;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Experiments system allows a developer to opt-in to test\n * features that are not yet fully tested.\n *\n * Experiments page: https://cdn.ampproject.org/experiments.html *\n */\n\nimport {getCookie, setCookie} from './cookies';\nimport {hasOwn} from './utils/object';\nimport {parseQueryString} from './url';\n\n/** @const {string} */\nconst COOKIE_NAME = 'AMP_EXP';\n\n/** @const {number} */\nconst COOKIE_MAX_AGE_DAYS = 180; // 6 month\n\n/** @const {time} */\nconst COOKIE_EXPIRATION_INTERVAL = COOKIE_MAX_AGE_DAYS * 24 * 60 * 60 * 1000;\n\n/** @const {string} */\nconst TOGGLES_WINDOW_PROPERTY = '__AMP__EXPERIMENT_TOGGLES';\n\n/**\n * @typedef {{\n *   isTrafficEligible: function(!Window):boolean,\n *   branches: !Array<string>\n * }}\n */\nexport let ExperimentInfo;\n\n/**\n * Whether we are in canary.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isCanary(win) {\n  return !!(win.AMP_CONFIG && win.AMP_CONFIG.canary);\n}\n\n/**\n * Returns binary type, e.g., canary, control, or production.\n * @param {!Window} win\n * @return {string}\n */\nexport function getBinaryType(win) {\n  return win.AMP_CONFIG && win.AMP_CONFIG.type ?\n    win.AMP_CONFIG.type : 'unknown';\n}\n\n/**\n * Whether the specified experiment is on or off.\n * @param {!Window} win\n * @param {string} experimentId\n * @return {boolean}\n */\nexport function isExperimentOn(win, experimentId) {\n  const toggles = experimentToggles(win);\n  return !!toggles[experimentId];\n}\n\n/**\n * Toggles the experiment on or off. Returns the actual value of the experiment\n * after toggling is done.\n * @param {!Window} win\n * @param {string} experimentId\n * @param {boolean=} opt_on\n * @param {boolean=} opt_transientExperiment  Whether to toggle the\n *     experiment state \"transiently\" (i.e., for this page load only) or\n *     durably (by saving the experiment IDs to the cookie after toggling).\n *     Default: false (save durably).\n * @return {boolean} New state for experimentId.\n */\nexport function toggleExperiment(win, experimentId, opt_on,\n  opt_transientExperiment) {\n  const currentlyOn = isExperimentOn(win, /*OK*/experimentId);\n  const on = !!(opt_on !== undefined ? opt_on : !currentlyOn);\n  if (on != currentlyOn) {\n    const toggles = experimentToggles(win);\n    toggles[experimentId] = on;\n\n    if (!opt_transientExperiment) {\n      const cookieToggles = getExperimentTogglesFromCookie(win);\n      cookieToggles[experimentId] = on;\n      saveExperimentTogglesToCookie(win, cookieToggles);\n    }\n  }\n  return on;\n}\n\n/**\n * Calculate whether the experiment is on or off based off of the\n * cookieFlag or the global config frequency given.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nexport function experimentToggles(win) {\n  if (win[TOGGLES_WINDOW_PROPERTY]) {\n    return win[TOGGLES_WINDOW_PROPERTY];\n  }\n  win[TOGGLES_WINDOW_PROPERTY] = Object.create(null);\n  const toggles = win[TOGGLES_WINDOW_PROPERTY];\n\n  // Read the default config of this build.\n  if (win.AMP_CONFIG) {\n    for (const experimentId in win.AMP_CONFIG) {\n      const frequency = win.AMP_CONFIG[experimentId];\n      if (typeof frequency === 'number' && frequency >= 0 && frequency <= 1) {\n        toggles[experimentId] = Math.random() < frequency;\n      }\n    }\n  }\n  // Read document level override from meta tag.\n  if (win.AMP_CONFIG\n      && Array.isArray(win.AMP_CONFIG['allow-doc-opt-in'])\n      && win.AMP_CONFIG['allow-doc-opt-in'].length > 0) {\n    const allowed = win.AMP_CONFIG['allow-doc-opt-in'];\n    const meta =\n        win.document.head.querySelector('meta[name=\"amp-experiments-opt-in\"]');\n    if (meta) {\n      const optedInExperiments = meta.getAttribute('content').split(',');\n      for (let i = 0; i < optedInExperiments.length; i++) {\n        if (allowed.indexOf(optedInExperiments[i]) != -1) {\n          toggles[optedInExperiments[i]] = true;\n        }\n      }\n    }\n  }\n\n  Object.assign(toggles, getExperimentTogglesFromCookie(win));\n\n  if (win.AMP_CONFIG\n      && Array.isArray(win.AMP_CONFIG['allow-url-opt-in'])\n      && win.AMP_CONFIG['allow-url-opt-in'].length > 0) {\n    const allowed = win.AMP_CONFIG['allow-url-opt-in'];\n    const hash = win.location.originalHash || win.location.hash;\n    const params = parseQueryString(hash);\n    for (let i = 0; i < allowed.length; i++) {\n      const param = params[`e-${allowed[i]}`];\n      if (param == '1') {\n        toggles[allowed[i]] = true;\n      }\n      if (param == '0') {\n        toggles[allowed[i]] = false;\n      }\n    }\n  }\n  return toggles;\n}\n\n/**\n * Returns the cached experiments toggles, or null if they have not been\n * computed yet.\n * @param {!Window} win\n * @return {Object<string, boolean>}\n */\nexport function experimentTogglesOrNull(win) {\n  return win[TOGGLES_WINDOW_PROPERTY] || null;\n}\n\n/**\n * Returns a set of experiment IDs currently on.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nfunction getExperimentTogglesFromCookie(win) {\n  const experimentCookie = getCookie(win, COOKIE_NAME);\n  const tokens = experimentCookie ? experimentCookie.split(/\\s*,\\s*/g) : [];\n\n  const toggles = Object.create(null);\n  for (let i = 0; i < tokens.length; i++) {\n    if (tokens[i].length == 0) {\n      continue;\n    }\n    if (tokens[i][0] == '-') {\n      toggles[tokens[i].substr(1)] = false;\n    } else {\n      toggles[tokens[i]] = true;\n    }\n  }\n\n  return toggles;\n}\n\n/**\n * Saves a set of experiment IDs currently on.\n * @param {!Window} win\n * @param {!Object<string, boolean>} toggles\n */\nfunction saveExperimentTogglesToCookie(win, toggles) {\n  const experimentIds = [];\n  for (const experiment in toggles) {\n    experimentIds.push((toggles[experiment] === false ? '-' : '') + experiment);\n  }\n\n  setCookie(win, COOKIE_NAME, experimentIds.join(','),\n      Date.now() + COOKIE_EXPIRATION_INTERVAL, {\n        // Set explicit domain, so the cookie gets send to sub domains.\n        domain: win.location.hostname,\n        allowOnProxyOrigin: true,\n      });\n}\n\n/**\n * See getExperimentTogglesFromCookie().\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n * @visibleForTesting\n */\nexport function getExperimentToglesFromCookieForTesting(win) {\n  return getExperimentTogglesFromCookie(win);\n}\n\n/**\n * Resets the experimentsToggle cache for testing purposes.\n * @param {!Window} win\n * @visibleForTesting\n */\nexport function resetExperimentTogglesForTesting(win) {\n  setCookie(win, COOKIE_NAME, '', 0, {\n    domain: win.location.hostname,\n  });\n  win[TOGGLES_WINDOW_PROPERTY] = null;\n}\n\n/**\n * In some browser implementations of Math.random(), sequential calls of\n * Math.random() are correlated and can cause a bias.  In particular,\n * if the previous random() call was < 0.001 (as it will be if we select\n * into an experiment), the next value could be less than 0.5 more than\n * 50.7% of the time.  This provides an implementation that roots down into\n * the crypto API, when available, to produce less biased samples.\n *\n * @return {number} Pseudo-random floating-point value on the range [0, 1).\n */\nfunction slowButAccuratePrng() {\n  // TODO(tdrl): Implement.\n  return Math.random();\n}\n\n/**\n * Container for alternate random number generator implementations.  This\n * allows us to set an \"accurate\" PRNG for branch selection, but to mock it\n * out easily in tests.\n *\n * @visibleForTesting\n * @const {!{accuratePrng: function():number}}\n */\nexport const RANDOM_NUMBER_GENERATORS = {\n  accuratePrng: slowButAccuratePrng,\n};\n\n/**\n * Selects, uniformly at random, a single item from the array.\n * @param {!Array<string>} arr Object to select from.\n * @return {?string} Single item from arr or null if arr was empty.\n */\nfunction selectRandomItem(arr) {\n  const rn = RANDOM_NUMBER_GENERATORS.accuratePrng();\n  return arr[Math.floor(rn * arr.length)] || null;\n}\n\n/**\n * Selects which page-level experiment branches are enabled. If a given\n * experiment name is already set (including to the null / no branches selected\n * state), this won't alter its state.\n *\n * Check whether a given experiment is set using isExperimentOn(win,\n * experimentName) and, if it is on, look for which branch is selected in\n * win.experimentBranches[experimentName].\n *\n * @param {!Window} win Window context on which to save experiment\n *     selection state.\n * @param {!Object<string, !ExperimentInfo>} experiments  Set of experiments to\n *     configure for this page load.\n * @return {!Object<string, string>} Map of experiment names to selected\n *     branches.\n */\nexport function randomlySelectUnsetExperiments(win, experiments) {\n  win.experimentBranches = win.experimentBranches || {};\n  const selectedExperiments = {};\n  for (const experimentName in experiments) {\n    // Skip experimentName if it is not a key of experiments object or if it\n    // has already been populated by some other property.\n    if (!hasOwn(experiments, experimentName)) {\n      continue;\n    }\n    if (hasOwn(win.experimentBranches, experimentName)) {\n      selectedExperiments[experimentName] =\n          win.experimentBranches[experimentName];\n      continue;\n    }\n\n    if (!experiments[experimentName].isTrafficEligible ||\n        !experiments[experimentName].isTrafficEligible(win)) {\n      win.experimentBranches[experimentName] = null;\n      continue;\n    }\n\n    // If we're in the experiment, but we haven't already forced a specific\n    // experiment branch (e.g., via a test setup), then randomize the branch\n    // choice.\n    if (!win.experimentBranches[experimentName] &&\n      isExperimentOn(win, /*OK*/experimentName)) {\n      const {branches} = experiments[experimentName];\n      win.experimentBranches[experimentName] = selectRandomItem(branches);\n      selectedExperiments[experimentName] =\n          win.experimentBranches[experimentName];\n    }\n  }\n  return selectedExperiments;\n}\n\n/**\n * Returns the experiment branch enabled for the given experiment ID.\n * For example, 'control' or 'experiment'.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @return {?string} Active experiment branch ID for experimentName (possibly\n *     null if experimentName has been tested but no branch was enabled).\n */\nexport function getExperimentBranch(win, experimentName) {\n  return win.experimentBranches ? win.experimentBranches[experimentName] : null;\n}\n\n/**\n * Force enable (or disable) a specific branch of a given experiment name.\n * Disables the experiment name altogether if branchId is falseish.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @param {?string} branchId ID of branch to force or null to disable\n *     altogether.\n * @visibleForTesting\n */\nexport function forceExperimentBranch(win, experimentName, branchId) {\n  win.experimentBranches = win.experimentBranches || {};\n  toggleExperiment(win, experimentName, !!branchId, true);\n  win.experimentBranches[experimentName] = branchId;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {GestureRecognizer} from './gesture';\nimport {calcVelocity} from './motion';\n\n\n/**\n * A \"tap\" gesture.\n * @typedef {{\n *   clientX: number,\n *   clientY: number\n * }}\n */\nlet TapDef;\n\n\n/**\n * Recognizes \"tap\" gestures.\n * @extends {GestureRecognizer<TapDef>}\n */\nexport class TapRecognizer extends GestureRecognizer {\n  /**\n   * @param {!./gesture.Gestures} manager\n   */\n  constructor(manager) {\n    super('tap', manager);\n\n    /** @private {number} */\n    this.startX_ = 0;\n\n    /** @private {number} */\n    this.startY_ = 0;\n\n    /** @private {number} */\n    this.lastX_ = 0;\n\n    /** @private {number} */\n    this.lastY_ = 0;\n\n    /** @private {?EventTarget} */\n    this.target_ = null;\n  }\n\n  /** @override */\n  onTouchStart(e) {\n    const {touches} = e;\n    this.target_ = e.target;\n    if (touches && touches.length == 1) {\n      this.startX_ = touches[0].clientX;\n      this.startY_ = touches[0].clientY;\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /** @override */\n  onTouchMove(e) {\n    const touches = e.changedTouches || e.touches;\n    if (touches && touches.length == 1) {\n      this.lastX_ = touches[0].clientX;\n      this.lastY_ = touches[0].clientY;\n      const dx = Math.abs(this.lastX_ - this.startX_) >= 8;\n      const dy = Math.abs(this.lastY_ - this.startY_) >= 8;\n      if (dx || dy) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /** @override */\n  onTouchEnd(unusedE) {\n    this.signalReady(0);\n  }\n\n  /** @override */\n  acceptStart() {\n    this.signalEmit({\n      clientX: this.lastX_,\n      clientY: this.lastY_,\n      target: this.target_,\n    }, null);\n    this.signalEnd();\n  }\n}\n\n\n\n/**\n * A \"doubletap\" gesture.\n * @typedef {{\n *   clientX: number,\n *   clientY: number\n * }}\n */\nlet DoubletapDef;\n\n\n/**\n * Recognizes a \"doubletap\" gesture. This gesture will block a single \"tap\"\n * for about 300ms while it's expecting the second \"tap\".\n * @extends {GestureRecognizer<DoubletapDef>}\n */\nexport class DoubletapRecognizer extends GestureRecognizer {\n  /**\n   * @param {!./gesture.Gestures} manager\n   */\n  constructor(manager) {\n    super('doubletap', manager);\n\n    /** @private {number} */\n    this.startX_ = 0;\n\n    /** @private {number} */\n    this.startY_ = 0;\n\n    /** @private {number} */\n    this.lastX_ = 0;\n\n    /** @private {number} */\n    this.lastY_ = 0;\n\n    /** @private {number} */\n    this.tapCount_ = 0;\n\n    /** @private {?Event} */\n    this.event_ = null;\n  }\n\n  /** @override */\n  onTouchStart(e) {\n    if (this.tapCount_ > 1) {\n      return false;\n    }\n    const {touches} = e;\n    if (touches && touches.length == 1) {\n      this.startX_ = touches[0].clientX;\n      this.startY_ = touches[0].clientY;\n      this.lastX_ = touches[0].clientX;\n      this.lastY_ = touches[0].clientY;\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /** @override */\n  onTouchMove(e) {\n    const {touches} = e;\n    if (touches && touches.length == 1) {\n      this.lastX_ = touches[0].clientX;\n      this.lastY_ = touches[0].clientY;\n      const dx = Math.abs(this.lastX_ - this.startX_) >= 8;\n      const dy = Math.abs(this.lastY_ - this.startY_) >= 8;\n      if (dx || dy) {\n        this.acceptCancel();\n        return false;\n      }\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /** @override */\n  onTouchEnd(e) {\n    this.tapCount_++;\n    if (this.tapCount_ < 2) {\n      this.signalPending(300);\n    } else {\n      this.event_ = e;\n      this.signalReady(0);\n    }\n  }\n\n  /** @override */\n  acceptStart() {\n    this.tapCount_ = 0;\n    this.signalEmit({clientX: this.lastX_, clientY: this.lastY_}, this.event_);\n    this.signalEnd();\n  }\n\n  /** @override */\n  acceptCancel() {\n    this.tapCount_ = 0;\n  }\n}\n\n\n\n/**\n * A \"swipe-xy\", \"swipe-x\" or \"swipe-y\" gesture. A number of these gestures\n * may be emitted for a single touch series.\n * @typedef {{\n *   first: boolean,\n *   last: boolean,\n *   deltaX: number,\n *   deltaY: number,\n *   velocityX: number,\n *   velocityY: number\n * }}\n */\nexport let SwipeDef;\n\n\n/**\n * Recognizes swipe gestures. This gesture will yield about 10ms to other\n * gestures.\n * @extends {GestureRecognizer<SwipeDef>}\n */\nclass SwipeRecognizer extends GestureRecognizer {\n  /**\n   * @param {string} type\n   * @param {!./gesture.Gestures} manager\n   * @param {boolean} horiz\n   * @param {boolean} vert\n   */\n  constructor(type, manager, horiz, vert) {\n    super(type, manager);\n\n    /** @private {boolean} */\n    this.horiz_ = horiz;\n\n    /** @private {boolean} */\n    this.vert_ = vert;\n\n    /** @private {boolean} */\n    this.eventing_ = false;\n\n    /** @private {number} */\n    this.startX_ = 0;\n\n    /** @private {number} */\n    this.startY_ = 0;\n\n    /** @private {number} */\n    this.lastX_ = 0;\n\n    /** @private {number} */\n    this.lastY_ = 0;\n\n    /** @private {number} */\n    this.prevX_ = 0;\n\n    /** @private {number} */\n    this.prevY_ = 0;\n\n    /** @private {time} */\n    this.startTime_ = 0;\n\n    /** @private {time} */\n    this.lastTime_ = 0;\n\n    /** @private {time} */\n    this.prevTime_ = 0;\n\n    /** @private {number} */\n    this.velocityX_ = 0;\n\n    /** @private {number} */\n    this.velocityY_ = 0;\n  }\n\n  /** @override */\n  onTouchStart(e) {\n    const {touches} = e;\n    if (touches && touches.length == 1) {\n      this.startTime_ = Date.now();\n      this.startX_ = touches[0].clientX;\n      this.startY_ = touches[0].clientY;\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /** @override */\n  onTouchMove(e) {\n    const {touches} = e;\n    if (touches && touches.length == 1) {\n      const {clientX: x, clientY: y} = touches[0] ;\n      this.lastX_ = x;\n      this.lastY_ = y;\n      if (this.eventing_) {\n        this.emit_(false, false, e);\n      } else {\n        const dx = Math.abs(x - this.startX_);\n        const dy = Math.abs(y - this.startY_);\n        // Swipe is penalized slightly since it's one of the least demanding\n        // gesture, thus -10 in signalReady.\n        if (this.horiz_ && this.vert_) {\n          if (dx >= 8 || dy >= 8) {\n            this.signalReady(-10);\n          }\n        } else if (this.horiz_) {\n          if (dx >= 8 && dx > dy) {\n            this.signalReady(-10);\n          } else if (dy >= 8) {\n            return false;\n          }\n        } else if (this.vert_) {\n          if (dy >= 8 && dy > dx) {\n            this.signalReady(-10);\n          } else if (dx >= 8) {\n            return false;\n          }\n        } else {\n          return false;\n        }\n      }\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /** @override */\n  onTouchEnd(e) {\n    this.end_(e);\n  }\n\n  /** @override */\n  acceptStart() {\n    this.eventing_ = true;\n    // Reset start coordinates to where the gesture began to avoid visible\n    // jump, but preserve them as \"prev\" coordinates to calculate the right\n    // velocity.\n    this.prevX_ = this.startX_;\n    this.prevY_ = this.startY_;\n    this.prevTime_ = this.startTime_;\n    this.startX_ = this.lastX_;\n    this.startY_ = this.lastY_;\n    this.emit_(true, false, null);\n  }\n\n  /** @override */\n  acceptCancel() {\n    this.eventing_ = false;\n  }\n\n  /**\n   * @param {boolean} first\n   * @param {boolean} last\n   * @param {?Event} event\n   * @private\n   */\n  emit_(first, last, event) {\n    this.lastTime_ = Date.now();\n    const deltaTime = this.lastTime_ - this.prevTime_;\n    // It's often that `touchend` arrives on the next frame. These should\n    // be ignored to avoid a significant velocity downgrade.\n    if ((!last && deltaTime > 4) || (last && deltaTime > 16)) {\n      this.velocityX_ = calcVelocity(this.lastX_ - this.prevX_, deltaTime,\n          this.velocityX_);\n      this.velocityY_ = calcVelocity(this.lastY_ - this.prevY_, deltaTime,\n          this.velocityY_);\n      this.velocityX_ = Math.abs(this.velocityX_) > 1e-4 ? this.velocityX_ : 0;\n      this.velocityY_ = Math.abs(this.velocityY_) > 1e-4 ? this.velocityY_ : 0;\n      this.prevX_ = this.lastX_;\n      this.prevY_ = this.lastY_;\n      this.prevTime_ = this.lastTime_;\n    }\n\n    this.signalEmit({\n      first,\n      last,\n      time: this.lastTime_,\n      deltaX: this.horiz_ ? this.lastX_ - this.startX_ : 0,\n      deltaY: this.vert_ ? this.lastY_ - this.startY_ : 0,\n      startX: this.startX_,\n      startY: this.startY_,\n      lastX: this.lastX_,\n      lastY: this.lastY_,\n      velocityX: this.horiz_ ? this.velocityX_ : 0,\n      velocityY: this.vert_ ? this.velocityY_ : 0,\n    }, event);\n  }\n\n  /**\n   * @param {?Event} event\n   * @private\n   */\n  end_(event) {\n    if (this.eventing_) {\n      this.eventing_ = false;\n      this.emit_(false, true, event);\n      this.signalEnd();\n    }\n  }\n}\n\n\n/**\n * Recognizes \"swipe-xy\" gesture. Yields about 10ms to other gestures.\n */\nexport class SwipeXYRecognizer extends SwipeRecognizer {\n  /**\n   * @param {!./gesture.Gestures} manager\n   */\n  constructor(manager) {\n    super('swipe-xy', manager, true, true);\n  }\n}\n\n\n/**\n * Recognizes \"swipe-x\" gesture. Yields about 10ms to other gestures.\n */\nexport class SwipeXRecognizer extends SwipeRecognizer {\n  /**\n   * @param {!./gesture.Gestures} manager\n   */\n  constructor(manager) {\n    super('swipe-x', manager, true, false);\n  }\n}\n\n\n/**\n * Recognizes \"swipe-y\" gesture. Yields about 10ms to other gestures.\n */\nexport class SwipeYRecognizer extends SwipeRecognizer {\n  /**\n   * @param {!./gesture.Gestures} manager\n   */\n  constructor(manager) {\n    super('swipe-y', manager, false, true);\n  }\n}\n\n\n\n/**\n * A \"tapzoom\" gesture. It has a center, delta off the center center and\n * the velocity of moving away from the center.\n * @typedef {{\n *   first: boolean,\n *   last: boolean,\n *   centerClientX: number,\n *   centerClientY: number,\n *   deltaX: number,\n *   deltaY: number,\n *   velocityX: number,\n *   velocityY: number\n * }}\n */\nlet TapzoomDef;\n\n\n/**\n * Recognizes a \"tapzoom\" gesture. This gesture will block other gestures\n * for about 400ms after first \"tap\" while it's expecting swipe.\n * @extends {GestureRecognizer<TapzoomDef>}\n */\nexport class TapzoomRecognizer extends GestureRecognizer {\n  /**\n   * @param {!./gesture.Gestures} manager\n   */\n  constructor(manager) {\n    super('tapzoom', manager);\n\n    /** @private {boolean} */\n    this.eventing_ = false;\n\n    /** @private {number} */\n    this.startX_ = 0;\n\n    /** @private {number} */\n    this.startY_ = 0;\n\n    /** @private {number} */\n    this.lastX_ = 0;\n\n    /** @private {number} */\n    this.lastY_ = 0;\n\n    /** @private {number} */\n    this.tapCount_ = 0;\n\n    /** @private {number} */\n    this.prevX_ = 0;\n\n    /** @private {number} */\n    this.prevY_ = 0;\n\n    /** @private {time} */\n    this.lastTime_ = 0;\n\n    /** @private {time} */\n    this.prevTime_ = 0;\n\n    /** @private {number} */\n    this.velocityX_ = 0;\n\n    /** @private {number} */\n    this.velocityY_ = 0;\n  }\n\n  /** @override */\n  onTouchStart(e) {\n    if (this.eventing_) {\n      return false;\n    }\n    const {touches} = e;\n    if (touches && touches.length == 1) {\n      this.startX_ = touches[0].clientX;\n      this.startY_ = touches[0].clientY;\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /** @override */\n  onTouchMove(e) {\n    const {touches} = e;\n    if (touches && touches.length == 1) {\n      this.lastX_ = touches[0].clientX;\n      this.lastY_ = touches[0].clientY;\n      if (this.eventing_) {\n        this.emit_(false, false, e);\n      } else {\n        const dx = Math.abs(this.lastX_ - this.startX_) >= 8;\n        const dy = Math.abs(this.lastY_ - this.startY_) >= 8;\n        if (dx || dy) {\n          if (this.tapCount_ == 0) {\n            this.acceptCancel();\n            return false;\n          } else {\n            this.signalReady(0);\n          }\n        }\n      }\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /** @override */\n  onTouchEnd(e) {\n    if (this.eventing_) {\n      this.end_(e);\n      return;\n    }\n\n    this.tapCount_++;\n    if (this.tapCount_ == 1) {\n      this.signalPending(400);\n      return;\n    }\n\n    this.acceptCancel();\n  }\n\n  /** @override */\n  acceptStart() {\n    this.tapCount_ = 0;\n    this.eventing_ = true;\n    this.emit_(true, false, null);\n  }\n\n  /** @override */\n  acceptCancel() {\n    this.tapCount_ = 0;\n    this.eventing_ = false;\n  }\n\n  /**\n   * @param {boolean} first\n   * @param {boolean} last\n   * @param {?Event} event\n   * @private\n   */\n  emit_(first, last, event) {\n    this.lastTime_ = Date.now();\n    if (first) {\n      this.velocityX_ = this.velocityY_ = 0;\n    } else if (this.lastTime_ - this.prevTime_ > 2) {\n      this.velocityX_ = calcVelocity(this.lastX_ - this.prevX_,\n          this.lastTime_ - this.prevTime_, this.velocityX_);\n      this.velocityY_ = calcVelocity(this.lastY_ - this.prevY_,\n          this.lastTime_ - this.prevTime_, this.velocityY_);\n    }\n    this.prevX_ = this.lastX_;\n    this.prevY_ = this.lastY_;\n    this.prevTime_ = this.lastTime_;\n\n    this.signalEmit({\n      first,\n      last,\n      centerClientX: this.startX_,\n      centerClientY: this.startY_,\n      deltaX: this.lastX_ - this.startX_,\n      deltaY: this.lastY_ - this.startY_,\n      velocityX: this.velocityX_,\n      velocityY: this.velocityY_,\n    }, event);\n  }\n\n  /**\n   * @param {?Event} event\n   * @private\n   */\n  end_(event) {\n    if (this.eventing_) {\n      this.eventing_ = false;\n      this.emit_(false, true, event);\n      this.signalEnd();\n    }\n  }\n}\n\n\n\n/**\n * A \"pinch\" gesture. It has a center, delta off the center center and\n * the velocity of moving away from the center. \"dir\" component of `1`\n * indicates that it's a expand motion and `-1` indicates pinch motion.\n * @typedef {{\n *   first: boolean,\n *   last: boolean,\n *   centerClientX: number,\n *   centerClientY: number,\n *   dir: number,\n *   deltaX: number,\n *   deltaY: number,\n *   velocityX: number,\n *   velocityY: number\n * }}\n */\nlet PinchDef;\n\n/**\n * Threshold in pixels for how much two touches move away from\n * each other before we recognize the gesture as a pinch.\n */\nconst PINCH_ACCEPT_THRESHOLD = 4;\n\n/**\n * Threshold in pixels for how much two touches move in the same\n * direction before we reject the gesture as a pinch.\n */\nconst PINCH_REJECT_THRESHOLD = 10;\n\n/**\n * Recognizes a \"pinch\" gesture.\n * @extends {GestureRecognizer<PinchDef>}\n */\nexport class PinchRecognizer extends GestureRecognizer {\n  /**\n   * @param {!./gesture.Gestures} manager\n   */\n  constructor(manager) {\n    super('pinch', manager);\n\n    /** @private {boolean} */\n    this.eventing_ = false;\n\n    /** @private {number} */\n    this.startX1_ = 0;\n    /** @private {number} */\n    this.startY1_ = 0;\n\n    /** @private {number} */\n    this.startX2_ = 0;\n    /** @private {number} */\n    this.startY2_ = 0;\n\n    /** @private {number} */\n    this.lastX1_ = 0;\n    /** @private {number} */\n    this.lastY1_ = 0;\n\n    /** @private {number} */\n    this.lastX2_ = 0;\n    /** @private {number} */\n    this.lastY2_ = 0;\n\n    /** @private {number} */\n    this.prevDeltaX_ = 0;\n    /** @private {number} */\n    this.prevDeltaY_ = 0;\n\n    /** @private {number} */\n    this.centerClientX_ = 0;\n    /** @private {number} */\n    this.centerClientY_ = 0;\n\n    /** @private {time} */\n    this.startTime_ = 0;\n    /** @private {time} */\n    this.lastTime_ = 0;\n    /** @private {time} */\n    this.prevTime_ = 0;\n\n    /** @private {number} */\n    this.velocityX_ = 0;\n    /** @private {number} */\n    this.velocityY_ = 0;\n  }\n\n  /** @override */\n  onTouchStart(e) {\n    const {touches} = e;\n    // Pinch touches are not always simultaneous, continue to listen\n    // for second touch.\n    if (touches && touches.length == 1) {\n      return true;\n    } else if (touches && touches.length == 2) {\n      this.startTime_ = Date.now();\n      this.startX1_ = touches[0].clientX;\n      this.startY1_ = touches[0].clientY;\n      this.startX2_ = touches[1].clientX;\n      this.startY2_ = touches[1].clientY;\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /** @override */\n  onTouchMove(e) {\n    const {touches} = e;\n    // Pinch touches are not always simultaneous, continue to listen\n    // for second touch.\n    if (touches && touches.length == 1) {\n      return true;\n    } else if (touches && touches.length == 2) {\n      this.lastX1_ = touches[0].clientX;\n      this.lastY1_ = touches[0].clientY;\n      this.lastX2_ = touches[1].clientX;\n      this.lastY2_ = touches[1].clientY;\n      if (this.eventing_) {\n        this.emit_(false, false, e);\n      } else {\n        const dx1 = this.lastX1_ - this.startX1_;\n        const dy1 = this.lastY1_ - this.startY1_;\n        const dx2 = this.lastX2_ - this.startX2_;\n        const dy2 = this.lastY2_ - this.startY2_;\n        // Fingers should move in opposite directions and go over the threshold.\n        if (dx1 * dx2 <= 0 && dy1 * dy2 <= 0) {\n          if (Math.abs(dx1 - dx2) >= PINCH_ACCEPT_THRESHOLD\n            || Math.abs(dy1 - dy2) >= PINCH_ACCEPT_THRESHOLD) {\n            this.signalReady(0);\n          }\n        } else if (Math.abs(dx1 + dx2) >= PINCH_REJECT_THRESHOLD\n          || Math.abs(dy1 + dy2) >= PINCH_REJECT_THRESHOLD) {\n          // Moving in the same direction over a threshold.\n          return false;\n        }\n      }\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /** @override */\n  onTouchEnd(e) {\n    this.end_(e);\n  }\n\n  /** @override */\n  acceptStart() {\n    this.eventing_ = true;\n    this.prevTime_ = this.startTime_;\n    this.prevDeltaX_ = 0;\n    this.prevDeltaY_ = 0;\n    this.centerClientX_ = (this.startX1_ + this.startX2_) * 0.5;\n    this.centerClientY_ = (this.startY1_ + this.startY2_) * 0.5;\n    this.emit_(true, false, null);\n  }\n\n  /** @override */\n  acceptCancel() {\n    this.eventing_ = false;\n  }\n\n  /**\n   * @param {boolean} first\n   * @param {boolean} last\n   * @param {?Event} event\n   * @private\n   */\n  emit_(first, last, event) {\n    this.lastTime_ = Date.now();\n    const deltaTime = this.lastTime_ - this.prevTime_;\n    const deltaX = this.deltaX_();\n    const deltaY = this.deltaY_();\n    // It's often that `touchend` arrives on the next frame. These should\n    // be ignored to avoid a significant velocity downgrade.\n    if ((!last && deltaTime > 4) || (last && deltaTime > 16)) {\n      this.velocityX_ = calcVelocity(deltaX - this.prevDeltaX_, deltaTime,\n          this.velocityX_);\n      this.velocityY_ = calcVelocity(deltaY - this.prevDeltaY_, deltaTime,\n          this.velocityY_);\n      this.velocityX_ = Math.abs(this.velocityX_) > 1e-4 ? this.velocityX_ : 0;\n      this.velocityY_ = Math.abs(this.velocityY_) > 1e-4 ? this.velocityY_ : 0;\n      this.prevDeltaX_ = deltaX;\n      this.prevDeltaY_ = deltaY;\n      this.prevTime_ = this.lastTime_;\n    }\n\n    const startSq = this.sqDist_(this.startX1_, this.startX2_,\n        this.startY1_, this.startY2_);\n    const lastSq = this.sqDist_(this.lastX1_, this.lastX2_,\n        this.lastY1_, this.lastY2_);\n    this.signalEmit({\n      first,\n      last,\n      time: this.lastTime_,\n      centerClientX: this.centerClientX_,\n      centerClientY: this.centerClientY_,\n      dir: Math.sign(lastSq - startSq),\n      deltaX: deltaX * 0.5,\n      deltaY: deltaY * 0.5,\n      velocityX: this.velocityX_ * 0.5,\n      velocityY: this.velocityY_ * 0.5,\n    }, event);\n  }\n\n  /**\n   * @param {?Event} event\n   * @private\n   */\n  end_(event) {\n    if (this.eventing_) {\n      this.eventing_ = false;\n      this.emit_(false, true, event);\n      this.signalEnd();\n    }\n  }\n\n  /**\n   * @param {number} x1\n   * @param {number} x2\n   * @param {number} y1\n   * @param {number} y2\n   * @return {number}\n   * @private\n   */\n  sqDist_(x1, x2, y1, y2) {\n    return (x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2);\n  }\n\n  /**\n   * @return {number}\n   * @private\n   */\n  deltaX_() {\n    return Math.abs((this.lastX1_ - this.startX1_) -\n        (this.lastX2_ - this.startX2_));\n  }\n\n  /**\n   * @return {number}\n   * @private\n   */\n  deltaY_() {\n    return Math.abs((this.lastY1_ - this.startY1_) -\n        (this.lastY2_ - this.startY2_));\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Observable} from './observable';\nimport {Pass} from './pass';\nimport {dev} from './log';\nimport {findIndex} from './utils/array';\nimport {toWin} from './types';\n\n\nconst PROP_ = '__AMP_Gestures';\n\n\n/**\n * A gesture object contains the type and data of the gesture such as\n * a tap or a double-tap or a swipe. See {@link GestureRecognizer} for\n * more details.\n * @struct\n * @const\n * @template DATA\n */\nexport class Gesture {\n  /**\n   * @param {string} type The gesture's string type.\n   * @param {DATA} data The data of the gesture.\n   * @param {time} time The time that the gesture has been emitted.\n   * @param {?Event} event An optional browser event that resulted in the\n   *   gesture.\n   */\n  constructor(type, data, time, event) {\n    /** @const {string} */\n    this.type = type;\n    /** @const {DATA} */\n    this.data = data;\n    /** @const {time} */\n    this.time = time;\n    /** @const {?Event} */\n    this.event = event;\n  }\n}\n\n\n/**\n * Gestures object manages all gestures on a particular element. It listens\n * to all pointer events and delegates them to individual gesture recognizers.\n * When a recognizer has recognized a gesture and ready to start emitting it\n * it requests permission to do so from this class which resolves conflicts\n * between competing recognizers to decide which gesture should go forward.\n */\nexport class Gestures {\n\n  /**\n   * Creates if not yet created and returns the shared Gestures instance for\n   * the specified element.\n   * @param {!Element} element\n   * @param {boolean=} opt_shouldNotPreventDefault\n   * @return {!Gestures}\n   */\n  static get(element, opt_shouldNotPreventDefault = false) {\n    let res = element[PROP_];\n    if (!res) {\n      res = new Gestures(element, opt_shouldNotPreventDefault);\n      element[PROP_] = res;\n    }\n    return res;\n  }\n\n  /**\n   * @param {!Element} element\n   * @param {boolean} shouldNotPreventDefault\n   */\n  constructor(element, shouldNotPreventDefault) {\n    /** @private {!Element} */\n    this.element_ = element;\n\n    /** @private {!Array<!GestureRecognizer>} */\n    this.recognizers_ = [];\n\n    /** @private {!Array<boolean>} */\n    this.tracking_ = [];\n\n    /** @private {!Array<time>} */\n    this.ready_ = [];\n\n    /** @private {!Array<time>} */\n    this.pending_ = [];\n\n    /** @private {?GestureRecognizer} */\n    this.eventing_ = null;\n\n    /** @private {boolean} */\n    this.shouldNotPreventDefault_ = shouldNotPreventDefault;\n\n    /**\n     * This variable indicates that the eventing has stopped on this\n     * event cycle.\n     * @private {boolean}\n     */\n    this.wasEventing_ = false;\n\n    /** @private {!Pass} */\n    this.pass_ = new Pass(toWin(element.ownerDocument.defaultView),\n        this.doPass_.bind(this));\n\n    /** @private {!Observable} */\n    this.pointerDownObservable_ = new Observable();\n\n    /**\n     * Observers for each type of registered gesture types.\n     * @private {!Object<string, !Observable<!Gesture>>}\n     */\n    this.overservers_ = Object.create(null);\n\n    /** @private @const {function(!Event)} */\n    this.boundOnTouchStart_ = this.onTouchStart_.bind(this);\n    /** @private @const {function(!Event)} */\n    this.boundOnTouchEnd_ = this.onTouchEnd_.bind(this);\n    /** @private @const {function(!Event)} */\n    this.boundOnTouchMove_ = this.onTouchMove_.bind(this);\n    /** @private @const {function(!Event)} */\n    this.boundOnTouchCancel_ = this.onTouchCancel_.bind(this);\n\n    this.element_.addEventListener('touchstart', this.boundOnTouchStart_);\n    this.element_.addEventListener('touchend', this.boundOnTouchEnd_);\n    this.element_.addEventListener('touchmove', this.boundOnTouchMove_);\n    this.element_.addEventListener('touchcancel', this.boundOnTouchCancel_);\n\n    /** @private {boolean} */\n    this.passAfterEvent_ = false;\n  }\n\n  /**\n   * Unsubscribes from all pointer events and removes the shared cache instance.\n   */\n  cleanup() {\n    this.element_.removeEventListener('touchstart', this.boundOnTouchStart_);\n    this.element_.removeEventListener('touchend', this.boundOnTouchEnd_);\n    this.element_.removeEventListener('touchmove', this.boundOnTouchMove_);\n    this.element_.removeEventListener('touchcancel', this.boundOnTouchCancel_);\n    delete this.element_[PROP_];\n    this.pass_.cancel();\n  }\n\n  /**\n   * Subscribes to a gesture emitted by the specified recognizer. For a first\n   * gesture handler registered in this method the recognizer is installed\n   * and from that point on it participates in the event processing.\n   *\n   * @param {function(new:GestureRecognizer<DATA>, !Gestures)} recognizerConstr\n   * @param {function(!Gesture<DATA>)} handler\n   * @return {!UnlistenDef}\n   * @template DATA\n   */\n  onGesture(recognizerConstr, handler) {\n    const recognizer = new recognizerConstr(this);\n    const type = recognizer.getType();\n    let overserver = this.overservers_[type];\n    if (!overserver) {\n      this.recognizers_.push(recognizer);\n      overserver = new Observable();\n      this.overservers_[type] = overserver;\n    }\n    return overserver.add(handler);\n  }\n\n  /**\n   * Unsubscribes all handlers from the given gesture recognizer. Returns\n   * true if anything was done. Returns false if there were no handlers\n   * registered on the given gesture recognizer in first place.\n   *\n   * @param {function(new:GestureRecognizer<DATA>, !Gestures)} recognizerConstr\n   * @return {boolean}\n   */\n  removeGesture(recognizerConstr) {\n    const type = new recognizerConstr(this).getType();\n    const overserver = this.overservers_[type];\n    if (overserver) {\n      overserver.removeAll();\n      const index = findIndex(this.recognizers_, e => e.getType() == type);\n      if (index < 0) {\n        return false;\n      }\n      // Remove the recognizer as well as all associated tracking state\n      this.recognizers_.splice(index, 1);\n      this.ready_.splice(index, 1);\n      this.pending_.splice(index, 1);\n      this.tracking_.splice(index, 1);\n      delete this.overservers_[type];\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /**\n   * Subscribes to pointer down events, such as \"touchstart\" or \"mousedown\".\n   * @param {!Function} handler\n   * @return {!UnlistenDef}\n   */\n  onPointerDown(handler) {\n    return this.pointerDownObservable_.add(handler);\n  }\n\n  /**\n   * Handles all \"touchstart\" events and dispatches them to the tracking\n   * recognizers.\n   * @param {!Event} event\n   * @private\n   */\n  onTouchStart_(event) {\n    const now = Date.now();\n    this.wasEventing_ = false;\n\n    this.pointerDownObservable_.fire(event);\n\n    for (let i = 0; i < this.recognizers_.length; i++) {\n      if (this.ready_[i]) {\n        // If the recognizer is in the \"ready\" state, it won't receive\n        // any more touch series until it's allowed to emit.\n        continue;\n      }\n      if (this.pending_[i] && this.pending_[i] < now) {\n        // Pending state expired. Reset.\n        this.stopTracking_(i);\n      }\n      if (this.recognizers_[i].onTouchStart(event)) {\n        // When a recognizer is interested in the touch series it returns \"true\"\n        // from its onTouchStart method. For this recognizer we start tracking\n        // the whole series of touch events from touchstart to touchend. Other\n        // recognizers will not receive them unless they return \"true\" from\n        // onTouchStart.\n        this.startTracking_(i);\n      }\n    }\n\n    this.afterEvent_(event);\n  }\n\n  /**\n   * Handles all \"touchmove\" events and dispatches them to the tracking\n   * recognizers.\n   * @param {!Event} event\n   * @private\n   */\n  onTouchMove_(event) {\n    const now = Date.now();\n\n    for (let i = 0; i < this.recognizers_.length; i++) {\n      if (!this.tracking_[i]) {\n        // The whole touch series are ignored for non-tracking recognizers.\n        continue;\n      }\n      if (this.pending_[i] && this.pending_[i] < now) {\n        // Pending state expired. Reset.\n        this.stopTracking_(i);\n        continue;\n      }\n      if (!this.recognizers_[i].onTouchMove(event)) {\n        // Recognizer lost interest in the series. Reset.\n        this.stopTracking_(i);\n      }\n    }\n\n    this.afterEvent_(event);\n  }\n\n  /**\n   * Handles all \"touchend\" events and dispatches them to the tracking\n   * recognizers.\n   * @param {!Event} event\n   * @private\n   */\n  onTouchEnd_(event) {\n    const now = Date.now();\n\n    for (let i = 0; i < this.recognizers_.length; i++) {\n      if (!this.tracking_[i]) {\n        // The whole touch series are ignored for non-tracking recognizers.\n        continue;\n      }\n      if (this.pending_[i] && this.pending_[i] < now) {\n        // Pending state expired. Reset.\n        this.stopTracking_(i);\n        continue;\n      }\n      this.recognizers_[i].onTouchEnd(event);\n      if (!this.pending_[i] || this.pending_[i] < now) {\n        this.stopTracking_(i);\n      }\n    }\n\n    this.afterEvent_(event);\n  }\n\n  /**\n   * Handles all \"touchcancel\" events. Cancels all tracking/emitting\n   * recognizers.\n   * @param {!Event} event\n   * @private\n   */\n  onTouchCancel_(event) {\n    for (let i = 0; i < this.recognizers_.length; i++) {\n      this.cancelEventing_(i);\n    }\n    this.afterEvent_(event);\n  }\n\n  /**\n   * Callback for a gesture recognizer to communicate that it's ready to\n   * start emitting gestures. Gestures instance may or may not allow the\n   * recognizer to proceed.\n   * @param {!GestureRecognizer} recognizer\n   * @param {number} offset\n   * @private\n   * @restricted\n   * @visibleForTesting\n   */\n  signalReady_(recognizer, offset) {\n    // Somebody got here first.\n    if (this.eventing_) {\n      recognizer.acceptCancel();\n      return;\n    }\n\n    // Set the recognizer as ready and wait for the pass to\n    // make the decision.\n    const now = Date.now();\n    for (let i = 0; i < this.recognizers_.length; i++) {\n      if (this.recognizers_[i] == recognizer) {\n        this.ready_[i] = now + offset;\n        this.pending_[i] = 0;\n      }\n    }\n    this.passAfterEvent_ = true;\n  }\n\n  /**\n   * Callback for a gesture recognizer to communicate that it's close to\n   * start emitting gestures, but needs more time to see more events. Once\n   * this time expires the recognizer should either signal readiness or it\n   * will be canceled.\n   * @param {!GestureRecognizer} recognizer\n   * @param {number} timeLeft\n   * @private\n   * @restricted\n   * @visibleForTesting\n   */\n  signalPending_(recognizer, timeLeft) {\n    // Somebody got here first.\n    if (this.eventing_) {\n      recognizer.acceptCancel();\n      return;\n    }\n\n    const now = Date.now();\n    for (let i = 0; i < this.recognizers_.length; i++) {\n      if (this.recognizers_[i] == recognizer) {\n        this.pending_[i] = now + timeLeft;\n      }\n    }\n  }\n\n  /**\n   * Callback for a gesture recognizer to communicate that it's done\n   * emitting gestures.\n   * @param {!GestureRecognizer} recognizer\n   * @private\n   * @restricted\n   * @visibleForTesting\n   */\n  signalEnd_(recognizer) {\n    if (this.eventing_ == recognizer) {\n      this.eventing_ = null;\n      this.wasEventing_ = true;\n    }\n  }\n\n  /**\n   * Callback for a gesture emit the gesture. Only the currently emitting\n   * recognizer is allowed to emit gestures.\n   * @param {!GestureRecognizer} recognizer\n   * @param {*} data\n   * @param {?Event} event\n   * @private\n   * @restricted\n   * @visibleForTesting\n   */\n  signalEmit_(recognizer, data, event) {\n    dev().assert(this.eventing_ == recognizer,\n        'Recognizer is not currently allowed: %s', recognizer.getType());\n    const overserver = this.overservers_[recognizer.getType()];\n    if (overserver) {\n      overserver.fire(new Gesture(recognizer.getType(), data, Date.now(),\n          event));\n    }\n  }\n\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  afterEvent_(event) {\n    let cancelEvent = !!this.eventing_ || this.wasEventing_;\n    this.wasEventing_ = false;\n    if (!cancelEvent) {\n      const now = Date.now();\n      for (let i = 0; i < this.recognizers_.length; i++) {\n        if (this.ready_[i] ||\n                (this.pending_[i] && this.pending_[i] >= now)) {\n          cancelEvent = true;\n          break;\n        }\n      }\n    }\n    if (cancelEvent) {\n      event.stopPropagation();\n      if (!this.shouldNotPreventDefault_) {\n        event.preventDefault();\n      }\n    }\n    if (this.passAfterEvent_) {\n      this.passAfterEvent_ = false;\n      this.doPass_();\n    }\n  }\n\n  /**\n   * The pass that decides which recognizers can start emitting and which\n   * are canceled.\n   * @private\n   */\n  doPass_() {\n    const now = Date.now();\n\n    // The \"most ready\" recognizer is the youngest in the \"ready\" set.\n    // Otherwise we wouldn't wait for it at all.\n    let readyIndex = -1;\n    for (let i = 0; i < this.recognizers_.length; i++) {\n      if (!this.ready_[i]) {\n        if (this.pending_[i] && this.pending_[i] < now) {\n          // Pending state expired. Reset.\n          this.stopTracking_(i);\n        }\n        continue;\n      }\n      if (readyIndex == -1 || this.ready_[i] > this.ready_[readyIndex]) {\n        readyIndex = i;\n      }\n    }\n\n    if (readyIndex == -1) {\n      // Nothing to do.\n      return;\n    }\n\n    // Look for conflicts.\n    let waitTime = 0;\n    for (let i = 0; i < this.recognizers_.length; i++) {\n      if (this.ready_[i] || !this.tracking_[i]) {\n        continue;\n      }\n      waitTime = Math.max(waitTime, this.pending_[i] - now);\n    }\n\n    if (waitTime < 2) {\n      // We waited long enough.\n      this.startEventing_(readyIndex);\n      return;\n    }\n\n    // Some conflicts: have to wait to see who wins.\n    this.pass_.schedule(waitTime);\n  }\n\n  /**\n   * This recognizer is given \"go ahead\" and all others are canceled.\n   * @param {number} index\n   * @private\n   */\n  startEventing_(index) {\n    const recognizer = this.recognizers_[index];\n    for (let i = 0; i < this.recognizers_.length; i++) {\n      if (i != index) {\n        this.cancelEventing_(i);\n      }\n    }\n    this.ready_[index] = 0;\n    this.pending_[index] = 0;\n    this.eventing_ = recognizer;\n    recognizer.acceptStart();\n  }\n\n  /**\n   * @param {number} index\n   * @private\n   */\n  startTracking_(index) {\n    this.tracking_[index] = true;\n    this.pending_[index] = 0;\n  }\n\n  /**\n   * @param {number} index\n   * @private\n   */\n  stopTracking_(index) {\n    this.tracking_[index] = false;\n    this.pending_[index] = 0;\n    if (!this.ready_[index]) {\n      this.recognizers_[index].acceptCancel();\n    }\n  }\n\n  /**\n   * @param {number} index\n   * @private\n   */\n  cancelEventing_(index) {\n    this.ready_[index] = 0;\n    this.stopTracking_(index);\n  }\n}\n\n\n/**\n * The gesture recognizer receives the pointer events from Gestures instance.\n * Based on these events, it can \"recognize\" the gesture it's responsible for,\n * request to start emitting and emit gestures. Gestures instances manages\n * several competing recognizers and decides which ones get to emit gestures\n * and which do not.\n *\n * The recognizer can be in several main states:\n * 1. Tracking state. In this state the recognizer is receiving the series of\n *    touch events from touchstart to touchend. To get into this state the\n *    recognizer has to return \"true\" from the {@link onTouchStart}.\n * 2. Pending state (optional). The recognizer matched part of the gesture,\n *    but needs more time to get track more events. It requests more time\n *    by calling {@link signalPending}, By the end of this time the recognizer\n *    has either matched the gesture or has been canceled.\n * 3. Ready state. The recognizer matched the whole gesture and ready to start\n *    emitting. It communicates to the Gestures this readiness by calling\n *    {@link signalReady}.\n * 5. Emitting state. If Gestures decides to go ahead with this recognizer, it\n *    will call {@link acceptStart} method. Otherwise, it will call\n *    {@link acceptCancel} method. Once in the emitting state, the recognizer\n *    can emit any number of events by calling {@link signalEmit}.\n * 6. Complete state. Once done, the recognizer can call {@link signalEnd} to\n *    communicate that it's done.\n *\n * @template DATA\n */\nexport class GestureRecognizer {\n\n  /**\n   * @param {string} type\n   * @param {!Gestures} manager\n   */\n  constructor(type, manager) {\n    /** @private @const {string} */\n    this.type_ = type;\n\n    /** @private @const {!Gestures} */\n    this.manager_ = manager;\n  }\n\n  /**\n   * Returns the type of the gesture emitted by the instance of this class.\n   * It has to be unique in the scope of the Gestures instance.\n   * @return {string}\n   */\n  getType() {\n    return this.type_;\n  }\n\n  /**\n   * The recognizer can call this method to communicate that it's ready to\n   * start emitting the gesture. Optionally it can pass a zero, positive or\n   * negative offset - a time on how much the gesture should be penalized or\n   * given advantage in conflict resolution. The recognizer at this point is\n   * in the \"ready\" state.\n   * @param {time} offset\n   */\n  signalReady(offset) {\n    this.manager_.signalReady_(this, offset);\n  }\n\n  /**\n   * The recognizer can call this method to communicate that it needs more\n   * time (timeLeft) to match the gesture. By the end of this time the\n   * recognizer has to either transit to the ready state using\n   * {@link signalReady} or it will be canceled. The recognizer is in the\n   * \"pending\" state.\n   * @param {time} timeLeft\n   */\n  signalPending(timeLeft) {\n    this.manager_.signalPending_(this, timeLeft);\n  }\n\n  /**\n   * The recognizer can call this method to communicate that it's done\n   * emitting the gestures. It will return to the waiting state. Recognizer\n   * can only call this method if it has previously received the\n   * {@link acceptStart} call.\n   */\n  signalEnd() {\n    this.manager_.signalEnd_(this);\n  }\n\n  /**\n   * The recognizer can call this method to emit the gestures while in the\n   * \"emitting\" state. Recognizer can only call this method if it has\n   * previously received the {@link acceptStart} call.\n   * @param {DATA} data\n   * @param {?Event} event\n   */\n  signalEmit(data, event) {\n    this.manager_.signalEmit_(this, data, event);\n  }\n\n  /**\n   * The Gestures instance calls this method to allow the recognizer to start\n   * emitting the gestures. At this point the recognizer is in the \"emitting\"\n   * state. It will be in this state until it calls {@link signalEnd} or\n   * the {@link acceptCancel} is called by the Gestures instance.\n   */\n  acceptStart() {\n  }\n\n  /**\n   * The Gestures instance calls this method to reset the recognizer. At this\n   * point the recognizer is in the initial waiting state.\n   */\n  acceptCancel() {\n  }\n\n  /**\n   * The Gestures instance calls this method for each \"touchstart\" event. If\n   * the recognizer wants to receive other touch events in the series, it has\n   * to return \"true\".\n   * @param {!Event} unusedEvent\n   * @return {boolean}\n   */\n  onTouchStart(unusedEvent) {\n    return false;\n  }\n\n  /**\n   * The Gestures instance calls this method for each \"touchmove\" event. If\n   * the recognizer wants to continue receiving touch events in the series,\n   * it has to return \"true\".\n   * @param {!Event} unusedEvent\n   * @return {boolean}\n   */\n  onTouchMove(unusedEvent) {\n    return false;\n  }\n\n  /**\n   * The Gestures instance calls this method for the \"touchend\" event.\n   * Somewhere within this touch series the recognizer has to call\n   * {@link signalReady} or {@link signalPending} or it will be reset for the\n   * next touch series.\n   * @param {!Event} unusedEvent\n   */\n  onTouchEnd(unusedEvent) {\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * The structure that combines position and size for an element. The exact\n * interpretation of position and size depends on the use case.\n *\n * @typedef {{\n *   top: number,\n *   bottom: number,\n *   left: number,\n *   right: number,\n *   width: number,\n *   height: number,\n *   x: number,\n *   y: number\n * }}\n */\nexport let LayoutRectDef;\n\n\n/**\n * The structure that represents the margins of an Element.\n *\n * @typedef {{\n *   top: number,\n *   right: number,\n *   bottom: number,\n *   left: number\n * }}\n */\nexport let LayoutMarginsDef;\n\n\n/**\n * The structure that represents a requested change to the margins of an\n * Element. Any new values specified will replace existing ones (rather than\n * being additive).\n *\n * @typedef {{\n *   top: (number|undefined),\n *   right: (number|undefined),\n *   bottom: (number|undefined),\n *   left: (number|undefined)\n * }}\n */\nexport let LayoutMarginsChangeDef;\n\n/**\n* RelativePositions\n*\n* Describes the relative position of an element to another (whether the\n* first is inside the second, on top of the second or on the bottom\n* @enum {string}\n*/\nexport const RelativePositions = {\n  INSIDE: 'inside',\n  TOP: 'top',\n  BOTTOM: 'bottom',\n};\n\n/**\n * Creates a layout rect based on the left, top, width and height parameters\n * in that order.\n * @param {number} left\n * @param {number} top\n * @param {number} width\n * @param {number} height\n * @return {!LayoutRectDef}\n */\nexport function layoutRectLtwh(left, top, width, height) {\n  return {\n    left,\n    top,\n    width,\n    height,\n    bottom: top + height,\n    right: left + width,\n    x: left,\n    y: top,\n  };\n}\n\n\n/**\n * Creates a layout rect based on the DOMRect, e.g. obtained from calling\n * getBoundingClientRect.\n * @param {!ClientRect} rect\n * @return {!LayoutRectDef}\n */\nexport function layoutRectFromDomRect(rect) {\n  return layoutRectLtwh(Number(rect.left), Number(rect.top),\n      Number(rect.width), Number(rect.height));\n}\n\n/**\n * Returns true if the specified two rects overlap by a single pixel.\n * @param {!LayoutRectDef} r1\n * @param {!LayoutRectDef} r2\n * @return {boolean}\n */\nexport function layoutRectsOverlap(r1, r2) {\n  return (r1.top <= r2.bottom && r2.top <= r1.bottom &&\n      r1.left <= r2.right && r2.left <= r1.right);\n}\n\n\n/**\n * Returns the intersection between a, b or null if there is none.\n * @param {...?LayoutRectDef|undefined} var_args\n * @return {?LayoutRectDef}\n */\nexport function rectIntersection(var_args) {\n  let x0 = -Infinity;\n  let x1 = Infinity;\n  let y0 = -Infinity;\n  let y1 = Infinity;\n  for (let i = 0; i < arguments.length; i++) {\n    const current = arguments[i];\n    if (!current) {\n      continue;\n    }\n    x0 = Math.max(x0, current.left);\n    x1 = Math.min(x1, current.left + current.width);\n    y0 = Math.max(y0, current.top);\n    y1 = Math.min(y1, current.top + current.height);\n    if (x1 < x0 || y1 < y0) {\n      return null;\n    }\n  }\n  if (x1 == Infinity) {\n    return null;\n  }\n  return layoutRectLtwh(x0, y0, x1 - x0, y1 - y0);\n}\n\n/**\n * Returns the position of r2 relative to r1\n * @param {!LayoutRectDef} r1\n * @param {!LayoutRectDef} r2\n * @return {RelativePositions}\n */\nexport function layoutRectsRelativePos(r1, r2) {\n  if (r1.top < r2.top) {\n    return RelativePositions.TOP;\n  } else if (r1.bottom > r2.bottom) {\n    return RelativePositions.BOTTOM;\n  } else {\n    return RelativePositions.INSIDE;\n  }\n}\n\n/**\n * Expand the layout rect using multiples of width and height.\n * @param {!LayoutRectDef} rect Original rect.\n * @param {number} dw Expansion in width, specified as a multiple of width.\n * @param {number} dh Expansion in height, specified as a multiple of height.\n * @return {!LayoutRectDef}\n */\nexport function expandLayoutRect(rect, dw, dh) {\n  return layoutRectLtwh(rect.left - rect.width * dw,\n      rect.top - rect.height * dh,\n      rect.width * (1 + dw * 2),\n      rect.height * (1 + dh * 2));\n}\n\n/**\n * Moves the layout rect using dx and dy.\n * @param {!LayoutRectDef} rect Original rect.\n * @param {number} dx Move horizontally with this value.\n * @param {number} dy Move vertically with this value.\n * @return {!LayoutRectDef}\n */\nexport function moveLayoutRect(rect, dx, dy) {\n  if ((dx == 0 && dy == 0) ||\n      (rect.width == 0 && rect.height == 0)) {\n    return rect;\n  }\n  return layoutRectLtwh(rect.left + dx, rect.top + dy,\n      rect.width, rect.height);\n}\n\n\n/**\n * @param {!LayoutMarginsDef} margins\n * @param {!LayoutMarginsChangeDef} change\n * @return {boolean}\n */\nexport function areMarginsChanged(margins, change) {\n  return (change.top !== undefined && change.top != margins.top) ||\n      (change.right !== undefined && change.right != margins.right) ||\n      (change.bottom !== undefined && change.bottom != margins.bottom) ||\n      (change.left !== undefined && change.left != margins.left);\n}\n\n/**\n * @param {!LayoutRectDef} from\n * @param {!LayoutRectDef} to\n * @return {boolean}\n */\nexport function layoutRectSizeEquals(from, to) {\n  return from.width == to.width &&\n      from.height === to.height;\n}\n\n/**\n * @param {?LayoutRectDef} r1\n * @param {?LayoutRectDef} r2\n * @return {boolean}\n */\nexport function layoutRectEquals(r1, r2) {\n  if (!r1 || !r2) {\n    return false;\n  }\n  return r1.left == r2.left && r1.top == r2.top &&\n      r1.width == r2.width && r1.height == r2.height;\n}\n\n/**\n * @param {LayoutMarginsChangeDef|undefined} marginsChange\n * @return {LayoutMarginsChangeDef|undefined}\n */\nexport function cloneLayoutMarginsChangeDef(marginsChange) {\n  if (!marginsChange) {\n    return marginsChange;\n  }\n  return {\n    top: marginsChange.top,\n    bottom: marginsChange.bottom,\n    left: marginsChange.left,\n    right: marginsChange.right,\n  };\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Implements element layout. See https://goo.gl/9avXuT for\n * details.\n */\n\nimport {dev, user} from './log';\nimport {htmlFor} from './static-template';\nimport {isFiniteNumber} from './types';\nimport {setStyle, setStyles} from './style';\nimport {startsWith} from './string';\n\n/**\n * @enum {string}\n */\nexport const Layout = {\n  NODISPLAY: 'nodisplay',\n  FIXED: 'fixed',\n  FIXED_HEIGHT: 'fixed-height',\n  RESPONSIVE: 'responsive',\n  CONTAINER: 'container',\n  FILL: 'fill',\n  FLEX_ITEM: 'flex-item',\n  FLUID: 'fluid',\n  INTRINSIC: 'intrinsic',\n};\n\n\n/**\n * Layout priorities to use with BaseElement#getLayoutPriority() and\n * BaseElement#updateLayoutPriority().\n * @enum {number}\n */\nexport const LayoutPriority = {\n  CONTENT: 0,\n  METADATA: 1,\n  ADS: 2,\n  BACKGROUND: 3,\n};\n\n\n/**\n * CSS Length type. E.g. \"1px\" or \"20vh\".\n * @typedef {string}\n */\nexport let LengthDef;\n\n\n/**\n * @typedef {{\n *   width: string,\n *   height: string\n * }}\n */\nlet DimensionsDef;\n\n\n/**\n * The set of elements with natural dimensions, that is, elements\n * which have a known dimension either based on their value specified here,\n * or, if the value is null, a dimension specific to the browser.\n * `hasNaturalDimensions` checks for membership in this set.\n * `getNaturalDimensions` determines the dimensions for an element in the\n *    set and caches it.\n * @type {!Object<string, ?DimensionsDef>}\n * @private  Visible for testing only!\n */\nexport const naturalDimensions_ = {\n  'AMP-PIXEL': {width: '0px', height: '0px'},\n  'AMP-ANALYTICS': {width: '1px', height: '1px'},\n  // TODO(dvoytenko): audio should have width:auto.\n  'AMP-AUDIO': null,\n  'AMP-SOCIAL-SHARE': {width: '60px', height: '44px'},\n};\n\n\n/**\n * Elements that the progess can be shown for. This set has to be externalized\n * since the element's implementation may not be downloaded yet.\n * @enum {boolean}\n * @private  Visible for testing only!\n */\nexport const LOADING_ELEMENTS_ = {\n  'AMP-ANIM': true,\n  'AMP-BRIGHTCOVE': true,\n  'AMP-GOOGLE-DOCUMENT-EMBED': true,\n  'AMP-EMBED': true,\n  'AMP-FACEBOOK': true,\n  'AMP-FACEBOOK-COMMENTS': true,\n  'AMP-FACEBOOK-LIKE': true,\n  'AMP-FACEBOOK-PAGE': true,\n  'AMP-IFRAME': true,\n  'AMP-IMG': true,\n  'AMP-INSTAGRAM': true,\n  'AMP-LIST': true,\n  'AMP-OOYALA-PLAYER': true,\n  'AMP-PINTEREST': true,\n  'AMP-PLAYBUZZ': true,\n  'AMP-VIDEO': true,\n  'AMP-YOUTUBE': true,\n};\n\n\n/**\n * @param {string} s\n * @return {Layout|undefined} Returns undefined in case of failure to parse\n *   the layout string.\n */\nexport function parseLayout(s) {\n  for (const k in Layout) {\n    if (Layout[k] == s) {\n      return Layout[k];\n    }\n  }\n  return undefined;\n}\n\n\n/**\n * @param {!Layout} layout\n * @return {string}\n */\nexport function getLayoutClass(layout) {\n  return 'i-amphtml-layout-' + layout;\n}\n\n\n/**\n * Whether an element with this layout inherently defines the size.\n * @param {!Layout} layout\n * @return {boolean}\n */\nexport function isLayoutSizeDefined(layout) {\n  return (layout == Layout.FIXED ||\n      layout == Layout.FIXED_HEIGHT ||\n      layout == Layout.RESPONSIVE ||\n      layout == Layout.FILL ||\n      layout == Layout.FLEX_ITEM ||\n      layout == Layout.FLUID ||\n      layout == Layout.INTRINSIC);\n}\n\n\n/**\n * Whether the tag is an internal (service) AMP tag.\n * @param {!Node|string} tag\n * @return {boolean}\n */\nexport function isInternalElement(tag) {\n  const tagName = (typeof tag == 'string') ? tag : tag.tagName;\n  return tagName && startsWith(tagName.toLowerCase(), 'i-');\n}\n\n\n/**\n * Parses the CSS length value. If no units specified, the assumed value is\n * \"px\". Returns undefined in case of parsing error.\n * @param {string|undefined|null} s\n * @return {!LengthDef|undefined}\n */\nexport function parseLength(s) {\n  if (typeof s == 'number') {\n    return s + 'px';\n  }\n  if (!s) {\n    return undefined;\n  }\n  if (!/^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)?$/.test(s)) {\n    return undefined;\n  }\n  if (/^\\d+(\\.\\d+)?$/.test(s)) {\n    return s + 'px';\n  }\n  return s;\n}\n\n\n\n/**\n * Asserts that the supplied value is a non-percent CSS Length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {!LengthDef}\n */\nexport function assertLength(length) {\n  user().assert(\n      /^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)$/.test(length),\n      'Invalid length value: %s', length);\n  return /** @type {!LengthDef} */ (length);\n}\n\n\n\n\n/**\n * Asserts that the supplied value is a CSS Length value\n * (including percent unit).\n * @param {!LengthDef|string} length\n * @return {!LengthDef}\n */\nexport function assertLengthOrPercent(length) {\n  user().assert(/^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|%)$/.test(length),\n      'Invalid length or percent value: %s', length);\n  return length;\n}\n\n\n/**\n * Returns units from the CSS length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {string}\n */\nexport function getLengthUnits(length) {\n  assertLength(length);\n  dev().assertString(length);\n  const m = user().assert(length.match(/[a-z]+/i),\n      'Failed to read units from %s', length);\n  return m[0];\n}\n\n\n/**\n * Returns the numeric value of a CSS length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {number|undefined}\n */\nexport function getLengthNumeral(length) {\n  const res = parseFloat(length);\n  return isFiniteNumber(res) ? res : undefined;\n}\n\n\n/**\n * Determines whether the tagName is a known element that has natural dimensions\n * in our runtime or the browser.\n * @param {string} tagName The element tag name.\n * @return {boolean}\n */\nexport function hasNaturalDimensions(tagName) {\n  tagName = tagName.toUpperCase();\n  return naturalDimensions_[tagName] !== undefined;\n}\n\n\n/**\n * Determines the default dimensions for an element which could vary across\n * different browser implementations, like <audio> for instance.\n * This operation can only be completed for an element whitelisted by\n * `hasNaturalDimensions`.\n * @param {!Element} element\n * @return {DimensionsDef}\n */\nexport function getNaturalDimensions(element) {\n  const tagName = element.tagName.toUpperCase();\n  dev().assert(naturalDimensions_[tagName] !== undefined);\n  if (!naturalDimensions_[tagName]) {\n    const doc = element.ownerDocument;\n    const naturalTagName = tagName.replace(/^AMP\\-/, '');\n    const temp = doc.createElement(naturalTagName);\n    // For audio, should no-op elsewhere.\n    temp.controls = true;\n    setStyles(temp, {\n      position: 'absolute',\n      visibility: 'hidden',\n    });\n    doc.body.appendChild(temp);\n    naturalDimensions_[tagName] = {\n      width: (temp./*OK*/offsetWidth || 1) + 'px',\n      height: (temp./*OK*/offsetHeight || 1) + 'px',\n    };\n    doc.body.removeChild(temp);\n  }\n  return /** @type {DimensionsDef} */ (naturalDimensions_[tagName]);\n}\n\n\n/**\n * Whether the loading can be shown for the specified elemeent. This set has\n * to be externalized since the element's implementation may not be\n * downloaded yet.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isLoadingAllowed(element) {\n  const tagName = element.tagName.toUpperCase();\n  if (tagName == 'AMP-AD' || tagName == 'AMP-EMBED') {\n    return true;\n  }\n  return LOADING_ELEMENTS_[tagName] || false;\n}\n\n\n/**\n * Applies layout to the element. Visible for testing only.\n *\n * \\   \\  /  \\  /   / /   \\     |   _  \\     |  \\ |  | |  | |  \\ |  |  / _____|\n *  \\   \\/    \\/   / /  ^  \\    |  |_)  |    |   \\|  | |  | |   \\|  | |  |  __\n *   \\            / /  /_\\  \\   |      /     |  . `  | |  | |  . `  | |  | |_ |\n *    \\    /\\    / /  _____  \\  |  |\\  \\----.|  |\\   | |  | |  |\\   | |  |__| |\n *     \\__/  \\__/ /__/     \\__\\ | _| `._____||__| \\__| |__| |__| \\__|  \\______|\n *\n * The equivalent of this method is used for server-side rendering (SSR) and\n * any changes made to it must be made in coordination with caches that\n * implement SSR. For more information on SSR see bit.ly/amp-ssr.\n *\n * @param {!Element} element\n * @return {!Layout}\n */\nexport function applyStaticLayout(element) {\n  // Check if the layout has already been done by server-side rendering. The\n  // document may be visible to the user if the boilerplate was removed so\n  // please take care in making changes here.\n  const completedLayoutAttr = element.getAttribute('i-amphtml-layout');\n  if (completedLayoutAttr) {\n    const layout = /** @type {!Layout} */ (dev().assert(\n        parseLayout(completedLayoutAttr)));\n    if ((layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC)\n      && element.firstElementChild) {\n      // Find sizer, but assume that it might not have been parsed yet.\n      element.sizerElement =\n          element.querySelector('i-amphtml-sizer') || undefined;\n    } else if (layout == Layout.NODISPLAY) {\n      applyNoDisplayLayout(element);\n    }\n    return layout;\n  }\n\n  // If the layout was already done by server-side rendering (SSR), then the\n  // code below will not run. Any changes below will necessitate a change to SSR\n  // and must be coordinated with caches that implement SSR. See bit.ly/amp-ssr.\n\n  // Parse layout from the element.\n  const layoutAttr = element.getAttribute('layout');\n  const widthAttr = element.getAttribute('width');\n  const heightAttr = element.getAttribute('height');\n  const sizesAttr = element.getAttribute('sizes');\n  const heightsAttr = element.getAttribute('heights');\n\n  // Input layout attributes.\n  const inputLayout = layoutAttr ? parseLayout(layoutAttr) : null;\n  user().assert(inputLayout !== undefined, 'Unknown layout: %s', layoutAttr);\n  /** @const {string|null|undefined} */\n  const inputWidth = (widthAttr && widthAttr != 'auto') ?\n    parseLength(widthAttr) : widthAttr;\n  user().assert(inputWidth !== undefined, 'Invalid width value: %s', widthAttr);\n  /** @const {string|null|undefined} */\n  const inputHeight = (heightAttr && heightAttr != 'fluid') ?\n    parseLength(heightAttr) : heightAttr;\n  user().assert(inputHeight !== undefined, 'Invalid height value: %s',\n      heightAttr);\n\n  // Effective layout attributes. These are effectively constants.\n  let width;\n  let height;\n  let layout;\n\n  // Calculate effective width and height.\n  if ((!inputLayout || inputLayout == Layout.FIXED ||\n      inputLayout == Layout.FIXED_HEIGHT) &&\n      (!inputWidth || !inputHeight) && hasNaturalDimensions(element.tagName)) {\n    // Default width and height: handle elements that do not specify a\n    // width/height and are defined to have natural browser dimensions.\n    const dimensions = getNaturalDimensions(element);\n    width = (inputWidth || inputLayout == Layout.FIXED_HEIGHT) ? inputWidth :\n      dimensions.width;\n    height = inputHeight || dimensions.height;\n  } else {\n    width = inputWidth;\n    height = inputHeight;\n  }\n\n  // Calculate effective layout.\n  if (inputLayout) {\n    layout = inputLayout;\n  } else if (!width && !height) {\n    layout = Layout.CONTAINER;\n  } else if (height == 'fluid') {\n    layout = Layout.FLUID;\n  } else if (height && (!width || width == 'auto')) {\n    layout = Layout.FIXED_HEIGHT;\n  } else if (height && width && (sizesAttr || heightsAttr)) {\n    layout = Layout.RESPONSIVE;\n  } else {\n    layout = Layout.FIXED;\n  }\n\n  // Verify layout attributes.\n  if (layout == Layout.FIXED || layout == Layout.FIXED_HEIGHT ||\n      layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC) {\n    user().assert(height, 'Expected height to be available: %s', heightAttr);\n  }\n  if (layout == Layout.FIXED_HEIGHT) {\n    user().assert(!width || width == 'auto',\n        'Expected width to be either absent or equal \"auto\" ' +\n        'for fixed-height layout: %s', widthAttr);\n  }\n  if (layout == Layout.FIXED || layout == Layout.RESPONSIVE ||\n      layout == Layout.INTRINSIC) {\n    user().assert(width && width != 'auto',\n        'Expected width to be available and not equal to \"auto\": %s',\n        widthAttr);\n  }\n\n  if (layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC) {\n    user().assert(getLengthUnits(width) == getLengthUnits(height),\n        'Length units should be the same for width and height: %s, %s',\n        widthAttr, heightAttr);\n  } else {\n    user().assert(heightsAttr === null,\n        'Unexpected \"heights\" attribute for none-responsive layout');\n  }\n\n  // Apply UI.\n  element.classList.add(getLayoutClass(layout));\n  if (isLayoutSizeDefined(layout)) {\n    element.classList.add('i-amphtml-layout-size-defined');\n  }\n  if (layout == Layout.NODISPLAY) {\n    // CSS defines layout=nodisplay automatically with `display:none`. Thus\n    // no additional styling is needed.\n    applyNoDisplayLayout(element);\n  } else if (layout == Layout.FIXED) {\n    setStyles(element, {\n      width: dev().assertString(width),\n      height: dev().assertString(height),\n    });\n  } else if (layout == Layout.FIXED_HEIGHT) {\n    setStyle(element, 'height', dev().assertString(height));\n  } else if (layout == Layout.RESPONSIVE) {\n    const sizer = element.ownerDocument.createElement('i-amphtml-sizer');\n    setStyles(sizer, {\n      display: 'block',\n      paddingTop:\n        ((getLengthNumeral(height) / getLengthNumeral(width)) * 100) + '%',\n    });\n    element.insertBefore(sizer, element.firstChild);\n    element.sizerElement = sizer;\n  } else if (layout == Layout.INTRINSIC) {\n    // Intrinsic uses an svg inside the sizer element rather than the padding\n    // trick Note a naked svg won't work becasue other thing expect the\n    // i-amphtml-sizer element\n    const sizer = htmlFor(element)`\n      <i-amphtml-sizer class=\"i-amphtml-sizer\">\n        <img class=\"i-amphtml-intrinsic-sizer\" />\n      </i-amphtml-sizer>`;\n    const intrinsicSizer = sizer.firstElementChild;\n    intrinsicSizer.setAttribute('src',\n        `data:image/svg+xml;charset=utf-8,<svg height=\"${height}\" width=\"${width}\" xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\"/>`);\n    element.insertBefore(sizer, element.firstChild);\n    // TODO(jpettitt): sizer is leaked and can't be cleaned up.\n    element.sizerElement = intrinsicSizer;\n  } else if (layout == Layout.FILL) {\n    // Do nothing.\n  } else if (layout == Layout.CONTAINER) {\n    // Do nothing. Elements themselves will check whether the supplied\n    // layout value is acceptable. In particular container is only OK\n    // sometimes.\n  } else if (layout == Layout.FLEX_ITEM) {\n    // Set height and width to a flex item if they exist.\n    // The size set to a flex item could be overridden by `display: flex` later.\n    if (width) {\n      setStyle(element, 'width', width);\n    }\n    if (height) {\n      setStyle(element, 'height', height);\n    }\n  } else if (layout == Layout.FLUID) {\n    element.classList.add('i-amphtml-layout-awaiting-size');\n    if (width) {\n      setStyle(element, 'width', width);\n    }\n    setStyle(element, 'height', 0);\n  }\n  return layout;\n}\n\n\n/**\n * @param {!Element} element\n */\nfunction applyNoDisplayLayout(element) {\n  // TODO(dvoytenko, #9353): once `toggleLayoutDisplay` API has been deployed\n  // everywhere, switch all relevant elements to this API. In the meantime,\n  // simply unblock display toggling via `style=\"display: ...\"`.\n  setStyle(element, 'display', 'none');\n  element.classList.add('i-amphtml-display');\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {getModeObject} from './mode-object';\nimport {isEnumValue} from './types';\n\n/**\n * Triple zero width space.\n *\n * This is added to user error messages, so that we can later identify\n * them, when the only thing that we have is the message. This is the\n * case in many browsers when the global exception handler is invoked.\n *\n * @const {string}\n */\nexport const USER_ERROR_SENTINEL = '\\u200B\\u200B\\u200B';\n\n\n/**\n * Four zero width space.\n *\n * @const {string}\n */\nexport const USER_ERROR_EMBED_SENTINEL = '\\u200B\\u200B\\u200B\\u200B';\n\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a user error.\n */\nexport function isUserErrorMessage(message) {\n  return message.indexOf(USER_ERROR_SENTINEL) >= 0;\n}\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a a user error from an iframe embed.\n */\nexport function isUserErrorEmbed(message) {\n  return message.indexOf(USER_ERROR_EMBED_SENTINEL) >= 0;\n}\n\n\n/**\n * @enum {number}\n * @private Visible for testing only.\n */\nexport const LogLevel = {\n  OFF: 0,\n  ERROR: 1,\n  WARN: 2,\n  INFO: 3,\n  FINE: 4,\n};\n\n/**\n * Sets reportError function. Called from error.js to break cyclic\n * dependency.\n * @param {function(*, !Element=)|undefined} fn\n */\nexport function setReportError(fn) {\n  self.reportError = fn;\n}\n\n/**\n * @type {!LogLevel|undefined}\n * @private\n */\nlet levelOverride_ = undefined;\n\n/**\n * @param {!LogLevel} level\n */\nexport function overrideLogLevel(level) {\n  levelOverride_ = level;\n}\n\n/**\n * Logging class. Use of sentinel string instead of a boolean to check user/dev\n * errors because errors could be rethrown by some native code as a new error,\n * and only a message would survive. Also, some browser don’t support a 5th\n * error object argument in window.onerror. List of supporting browser can be\n * found here:\n * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n * @final\n * @private Visible for testing only.\n */\nexport class Log {\n  /**\n   * opt_suffix will be appended to error message to identify the type of the\n   * error message. We can't rely on the error object to pass along the type\n   * because some browsers do not have this param in its window.onerror API.\n   * See:\n   * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n   *\n   * @param {!Window} win\n   * @param {function(!./mode.ModeDef):!LogLevel} levelFunc\n   * @param {string=} opt_suffix\n   */\n  constructor(win, levelFunc, opt_suffix) {\n    /**\n     * In tests we use the main test window instead of the iframe where\n     * the tests runs because only the former is relayed to the console.\n     * @const {!Window}\n     */\n    this.win = (getMode().test && win.AMP_TEST_IFRAME) ? win.parent : win;\n\n    /** @private @const {function(!./mode.ModeDef):!LogLevel} */\n    this.levelFunc_ = levelFunc;\n\n    /** @private @const {!LogLevel} */\n    this.level_ = this.defaultLevel_();\n\n    /** @private @const {string} */\n    this.suffix_ = opt_suffix || '';\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  getLevel_() {\n    return (levelOverride_ !== undefined) ? levelOverride_ : this.level_;\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  defaultLevel_() {\n    // No console - can't enable logging.\n    if (!this.win.console || !this.win.console.log) {\n      return LogLevel.OFF;\n    }\n\n    // Logging has been explicitly disabled.\n    if (getMode().log == '0') {\n      return LogLevel.OFF;\n    }\n\n    // Logging is enabled for tests directly.\n    if (getMode().test && this.win.ENABLE_LOG) {\n      return LogLevel.FINE;\n    }\n\n    // LocalDev by default allows INFO level, unless overriden by `#log`.\n    if (getMode().localDev && !getMode().log) {\n      return LogLevel.INFO;\n    }\n\n    // Delegate to the specific resolver.\n    return this.levelFunc_(getModeObject());\n  }\n\n  /**\n   * @param {string} tag\n   * @param {string} level\n   * @param {!Array} messages\n   */\n  msg_(tag, level, messages) {\n    if (this.getLevel_() != LogLevel.OFF) {\n      let fn = this.win.console.log;\n      if (level == 'ERROR') {\n        fn = this.win.console.error || fn;\n      } else if (level == 'INFO') {\n        fn = this.win.console.info || fn;\n      } else if (level == 'WARN') {\n        fn = this.win.console.warn || fn;\n      }\n      if (getMode().localDev) {\n        messages.unshift('[' + tag + ']');\n      }\n      fn.apply(this.win.console, messages);\n    }\n  }\n\n  /**\n   * Whether the logging is enabled.\n   * @return {boolean}\n   */\n  isEnabled() {\n    return this.getLevel_() != LogLevel.OFF;\n  }\n\n  /**\n   * Reports a fine-grained message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  fine(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.FINE) {\n      this.msg_(tag, 'FINE', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a informational message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  info(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.INFO) {\n      this.msg_(tag, 'INFO', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a warning message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  warn(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.WARN) {\n      this.msg_(tag, 'WARN', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports an error message. If the logging is disabled, the error is rethrown\n   * asynchronously.\n   * @param {string} tag\n   * @param {...*} var_args\n   * @return {!Error|undefined}\n   * @private\n   */\n  error_(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.ERROR) {\n      this.msg_(tag, 'ERROR', Array.prototype.slice.call(arguments, 1));\n    } else {\n      const error = createErrorVargs.apply(null,\n          Array.prototype.slice.call(arguments, 1));\n      this.prepareError_(error);\n      return error;\n    }\n  }\n\n  /**\n   * Reports an error message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  error(tag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.name = tag || error.name;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Reports an error message and marks with an expected property. If the\n   * logging is disabled, the error is rethrown asynchronously.\n   * @param {string} unusedTag\n   * @param {...*} var_args\n   */\n  expectedError(unusedTag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.expected = true;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Creates an error object.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    return error;\n  }\n\n  /**\n   * Creates an error object with its expected property set to true.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createExpectedError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    error.expected = true;\n    return error;\n  }\n\n  /**\n   * Throws an error if the first argument isn't trueish.\n   *\n   * Supports argument substitution into the message via %s placeholders.\n   *\n   * Throws an error object that has two extra properties:\n   * - associatedElement: This is the first element provided in the var args.\n   *   It can be used for improved display of error messages.\n   * - messageArray: The elements of the substituted message as non-stringified\n   *   elements in an array. When e.g. passed to console.error this yields\n   *   native displays of things like HTML elements.\n   *\n   * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n   *     not evaluate to true.\n   * @param {string=} opt_message The assertion message\n   * @param {...*} var_args Arguments substituted into %s in the message.\n   * @return {T} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 0\n   */\n  assert(shouldBeTrueish, opt_message, var_args) {\n    let firstElement;\n    if (!shouldBeTrueish) {\n      const message = opt_message || 'Assertion failed';\n      const splitMessage = message.split('%s');\n      const first = splitMessage.shift();\n      let formatted = first;\n      const messageArray = [];\n      pushIfNonEmpty(messageArray, first);\n      for (let i = 2; i < arguments.length; i++) {\n        const val = arguments[i];\n        if (val && val.tagName) {\n          firstElement = val;\n        }\n        const nextConstant = splitMessage.shift();\n        messageArray.push(val);\n        pushIfNonEmpty(messageArray, nextConstant.trim());\n        formatted += toString(val) + nextConstant;\n      }\n      const e = new Error(formatted);\n      e.fromAssert = true;\n      e.associatedElement = firstElement;\n      e.messageArray = messageArray;\n      this.prepareError_(e);\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n    return shouldBeTrueish;\n  }\n\n  /**\n   * Throws an error if the first argument isn't an Element\n   *\n   * Otherwise see `assert` for usage\n   *\n   * @param {*} shouldBeElement\n   * @param {string=} opt_message The assertion message\n   * @return {!Element} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertElement(shouldBeElement, opt_message) {\n    const shouldBeTrueish = shouldBeElement && shouldBeElement.nodeType == 1;\n    this.assert(shouldBeTrueish, (opt_message || 'Element expected') + ': %s',\n        shouldBeElement);\n    return /** @type {!Element} */ (shouldBeElement);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a string. The string can\n   * be empty.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeString\n   * @param {string=} opt_message The assertion message\n   * @return {string} The string value. Can be an empty string.\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertString(shouldBeString, opt_message) {\n    this.assert(typeof shouldBeString == 'string',\n        (opt_message || 'String expected') + ': %s', shouldBeString);\n    return /** @type {string} */ (shouldBeString);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a number. The allowed values\n   * include `0` and `NaN`.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeNumber\n   * @param {string=} opt_message The assertion message\n   * @return {number} The number value. The allowed values include `0`\n   *   and `NaN`.\n   */\n  assertNumber(shouldBeNumber, opt_message) {\n    this.assert(typeof shouldBeNumber == 'number',\n        (opt_message || 'Number expected') + ': %s', shouldBeNumber);\n    return /** @type {number} */ (shouldBeNumber);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a boolean.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeBoolean\n   * @param {string=} opt_message The assertion message\n   * @return {boolean} The boolean value.\n   */\n  assertBoolean(shouldBeBoolean, opt_message) {\n    this.assert(!!shouldBeBoolean === shouldBeBoolean,\n        (opt_message || 'Boolean expected') + ': %s', shouldBeBoolean);\n    return /** @type {boolean} */ (shouldBeBoolean);\n  }\n\n  /**\n   * Asserts and returns the enum value. If the enum doesn't contain such a\n   * value, the error is thrown.\n   *\n   * @param {!Object<T>} enumObj\n   * @param {string} s\n   * @param {string=} opt_enumName\n   * @return {T}\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertEnumValue(enumObj, s, opt_enumName) {\n    if (isEnumValue(enumObj, s)) {\n      return s;\n    }\n    this.assert(false,\n        'Unknown %s value: \"%s\"',\n        opt_enumName || 'enum', s);\n  }\n\n  /**\n   * @param {!Error} error\n   * @private\n   */\n  prepareError_(error) {\n    error = duplicateErrorIfNecessary(error);\n    if (this.suffix_) {\n      if (!error.message) {\n        error.message = this.suffix_;\n      } else if (error.message.indexOf(this.suffix_) == -1) {\n        error.message += this.suffix_;\n      }\n    } else if (isUserErrorMessage(error.message)) {\n      error.message = error.message.replace(USER_ERROR_SENTINEL, '');\n    }\n  }\n}\n\n/**\n * @param {string|!Element} val\n * @return {string}\n */\nfunction toString(val) {\n  // Do check equivalent to `val instanceof Element` without cross-window bug\n  if (val && val.nodeType == 1) {\n    return val.tagName.toLowerCase() + (val.id ? '#' + val.id : '');\n  }\n  return /** @type {string} */ (val);\n}\n\n\n/**\n * @param {!Array} array\n * @param {*} val\n */\nfunction pushIfNonEmpty(array, val) {\n  if (val != '') {\n    array.push(val);\n  }\n}\n\n/**\n * Some exceptions (DOMException, namely) have read-only message.\n * @param {!Error} error\n * @return {!Error};\n */\nexport function duplicateErrorIfNecessary(error) {\n  const {message} = error;\n  const test = String(Math.random());\n  error.message = test;\n\n  if (error.message === test) {\n    error.message = message;\n    return error;\n  }\n\n  const e = new Error(error.message);\n  // Copy all the extraneous things we attach.\n  for (const prop in error) {\n    e[prop] = error[prop];\n  }\n  // Ensure these are copied.\n  e.stack = error.stack;\n  return e;\n}\n\n/**\n * @param {...*} var_args\n * @return {!Error}\n * @visibleForTesting\n */\nexport function createErrorVargs(var_args) {\n  let error = null;\n  let message = '';\n  for (let i = 0; i < arguments.length; i++) {\n    const arg = arguments[i];\n    if (arg instanceof Error && !error) {\n      error = duplicateErrorIfNecessary(arg);\n    } else {\n      if (message) {\n        message += ' ';\n      }\n      message += arg;\n    }\n  }\n\n  if (!error) {\n    error = new Error(message);\n  } else if (message) {\n    error.message = message + ': ' + error.message;\n  }\n  return error;\n}\n\n\n/**\n * Rethrows the error without terminating the current context. This preserves\n * whether the original error designation is a user error or a dev error.\n * @param {...*} var_args\n */\nexport function rethrowAsync(var_args) {\n  const error = createErrorVargs.apply(null, arguments);\n  setTimeout(() => {\n    // reportError is installed globally per window in the entry point.\n    self.reportError(error);\n    throw error;\n  });\n}\n\n\n/**\n * Cache for logs. We do not use a Service since the service module depends\n * on Log and closure literally can't even.\n * @type {{user: ?Log, dev: ?Log, userForEmbed: ?Log}}\n */\nself.log = (self.log || {\n  user: null,\n  dev: null,\n  userForEmbed: null,\n});\n\nconst logs = self.log;\n\n/**\n * Eventually holds a constructor for Log objects. Lazily initialized, so we\n * can avoid ever referencing the real constructor except in JS binaries\n * that actually want to include the implementation.\n * @type {?Function}\n */\nlet logConstructor = null;\n\n/**\n * Initializes log contructor.\n */\nexport function initLogConstructor() {\n  logConstructor = Log;\n  // Initialize instances for use. If a binary (an extension for example) that\n  // does not call `initLogConstructor` invokes `dev()` or `user()` earlier than\n  // the binary that does call `initLogConstructor` (amp.js), the extension will\n  // throw an error as that extension will never be able to initialize the log\n  // instances and we also don't want it to call `initLogConstructor` either\n  // (since that will cause the Log implementation to be bundled into that\n  // binary). So we must initialize the instances eagerly so that they are ready\n  // for use (stored globally) after the main binary calls `initLogConstructor`.\n  dev();\n  user();\n}\n\n/**\n * Resets log contructor for testing.\n */\nexport function resetLogConstructorForTesting() {\n  logConstructor = null;\n}\n\n/**\n * Publisher level log.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Development mode is enabled via `#development=1` or logging is explicitly\n *     enabled via `#log=D` where D >= 1.\n *  3. AMP.setLogLevel(D) is called, where D >= 1.\n *\n * @param {!Element=} opt_element\n * @return {!Log}\n */\nexport function user(opt_element) {\n  if (!logs.user) {\n    logs.user = getUserLogger(USER_ERROR_SENTINEL);\n  }\n  if (!isFromEmbed(logs.user.win, opt_element)) {\n    return logs.user;\n  } else {\n    if (logs.userForEmbed) {\n      return logs.userForEmbed;\n    }\n    return logs.userForEmbed = getUserLogger(USER_ERROR_EMBED_SENTINEL);\n  }\n}\n\n/**\n * Getter for user logger\n * @param {string=} suffix\n * @return {!Log}\n */\nfunction getUserLogger(suffix) {\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (mode.development || logNum >= 1) {\n      return LogLevel.FINE;\n    }\n    return LogLevel.WARN;\n  }, suffix);\n}\n\n/**\n * AMP development log. Calls to `devLog().assert` and `dev.fine` are stripped\n * in the PROD binary. However, `devLog().assert` result is preserved in either\n * case.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Logging is explicitly enabled via `#log=D`, where D >= 2.\n *  3. AMP.setLogLevel(D) is called, where D >= 2.\n *\n * @return {!Log}\n */\nexport function dev() {\n  if (logs.dev) {\n    return logs.dev;\n  }\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return logs.dev = new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (logNum >= 3) {\n      return LogLevel.FINE;\n    }\n    if (logNum >= 2) {\n      return LogLevel.INFO;\n    }\n    return LogLevel.OFF;\n  });\n}\n\n/**\n * @param {!Window} win\n * @param {!Element=} opt_element\n * @return {boolean} isEmbed\n */\nexport function isFromEmbed(win, opt_element) {\n  if (!opt_element) {\n    return false;\n  }\n  return opt_element.ownerDocument.defaultView != win;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\n\n/**\n * Provides info about the current app. This return value may be cached and\n * passed around as it will always be DCE'd.\n * @param {?Window=} opt_win\n * @return {!./mode.ModeDef}\n */\nexport function getModeObject(opt_win) {\n  return {\n    localDev: getMode(opt_win).localDev,\n    development: getMode(opt_win).development,\n    filter: getMode(opt_win).filter,\n    minified: getMode(opt_win).minified,\n    lite: getMode(opt_win).lite,\n    test: getMode(opt_win).test,\n    log: getMode(opt_win).log,\n    version: getMode(opt_win).version,\n    rtvVersion: getMode(opt_win).rtvVersion,\n  };\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {parseQueryString_} from './url-parse-query-string';\n\n/**\n * @typedef {{\n *   localDev: boolean,\n *   development: boolean,\n *   filter: (string|undefined),\n *   minified: boolean,\n *   lite: boolean,\n *   test: boolean,\n *   log: (string|undefined),\n *   version: string,\n *   rtvVersion: string,\n * }}\n */\nexport let ModeDef;\n\n/** @type {string} */\nconst version = '$internalRuntimeVersion$';\n\n/**\n * `rtvVersion` is the prefixed version we serve off of the cdn.\n * The prefix denotes canary(00) or prod(01) or an experiment version ( > 01).\n * @type {string}\n */\nlet rtvVersion = '';\n\n/**\n * Provides info about the current app.\n * @param {?Window=} opt_win\n * @return {!ModeDef}\n */\nexport function getMode(opt_win) {\n  const win = opt_win || self;\n  if (win.AMP_MODE) {\n    return win.AMP_MODE;\n  }\n  return win.AMP_MODE = getMode_(win);\n}\n\n/**\n * Provides info about the current app.\n * @param {!Window} win\n * @return {!ModeDef}\n */\nfunction getMode_(win) {\n  // Magic constants that are replaced by closure compiler.\n  // IS_MINIFIED is always replaced with true when closure compiler is used\n  // while IS_DEV is only replaced when `gulp dist` is called without the\n  // --fortesting flag.\n  const IS_DEV = true;\n  const IS_MINIFIED = false;\n\n  const localDevEnabled = !!(self.AMP_CONFIG && self.AMP_CONFIG.localDev);\n  const runningTests = IS_DEV && !!(win.AMP_TEST || win.__karma__);\n  const isLocalDev = IS_DEV && (localDevEnabled || runningTests);\n  const hashQuery = parseQueryString_(\n      // location.originalHash is set by the viewer when it removes the fragment\n      // from the URL.\n      win.location.originalHash || win.location.hash);\n\n  const searchQuery = parseQueryString_(win.location.search);\n\n  if (!rtvVersion) {\n    rtvVersion = getRtvVersion(win, isLocalDev);\n  }\n\n  // The `minified`, `test` and `localDev` properties are replaced\n  // as boolean literals when we run `gulp dist` without the `--fortesting`\n  // flags. This improved DCE on the production file we deploy as the code\n  // paths for localhost/testing/development are eliminated.\n  return {\n    localDev: isLocalDev,\n    // Triggers validation or enable pub level logging. Validation can be\n    // bypassed via #validate=0.\n    // Note that AMP_DEV_MODE flag is used for testing purposes.\n    development: !!(hashQuery['development'] == '1' || win.AMP_DEV_MODE),\n    examiner: hashQuery['development'] == '2',\n    // Allows filtering validation errors by error category. For the\n    // available categories, see ErrorCategory in validator/validator.proto.\n    filter: hashQuery['filter'],\n    // amp-geo override\n    geoOverride: hashQuery['amp-geo'],\n    minified: IS_MINIFIED,\n    // Whether document is in an amp-lite viewer. It signal that the user\n    // would prefer to use less bandwidth.\n    lite: searchQuery['amp_lite'] != undefined,\n    test: runningTests,\n    log: hashQuery['log'],\n    version,\n    rtvVersion,\n  };\n}\n\n/**\n * Retrieve the `rtvVersion` which will have a numeric prefix\n * denoting canary/prod/experiment (unless `isLocalDev` is true).\n *\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n */\nfunction getRtvVersion(win, isLocalDev) {\n  // If it's local dev then we won't actually have a full version so\n  // just use the version.\n  if (isLocalDev) {\n    return version;\n  }\n\n  if (win.AMP_CONFIG && win.AMP_CONFIG.v) {\n    return win.AMP_CONFIG.v;\n  }\n\n  // Currently `$internalRuntimeVersion$` and thus `mode.version` contain only\n  // major version. The full version however must also carry the minor version.\n  // We will default to production default `01` minor version for now.\n  // TODO(erwinmombay): decide whether $internalRuntimeVersion$ should contain\n  // minor version.\n  return `01${version}`;\n}\n\n\n/**\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n * @visibleForTesting\n */\nexport function getRtvVersionForTesting(win, isLocalDev) {\n  return getRtvVersion(win, isLocalDev);\n}\n\n\n/** @visibleForTesting */\nexport function resetRtvVersionForTesting() {\n  rtvVersion = '';\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Deferred} from './utils/promise';\nimport {Services} from './services';\n\n/** @const {function()} */\nconst NOOP_CALLBACK_ = function() {};\n\n/** @const {number} */\nconst MIN_VELOCITY_ = 0.02;\n\n/** @const {number} */\nconst FRAME_CONST_ = 16.67;\n\n/** @const {number} */\nconst EXP_FRAME_CONST_ = Math.round(-FRAME_CONST_ / Math.log(0.95));\n\n/**\n * Depreciation factor of 1/100 of a millisecond. This is how much previous\n * velocity is depreciated when calculating the new velocity.\n * @const {number}\n */\nconst VELOCITY_DEPR_FACTOR_ = FRAME_CONST_ * 2;\n\n\n/**\n * Calculates velocity for an object traveling the distance deltaV in the\n * time deltaTime given the previous velocity prevVelocity. The calculation\n * assumes a basic informational depreciation of previous velocity.\n * @param {number} deltaV\n * @param {time} deltaTime\n * @param {number} prevVelocity\n * @return {number}\n */\nexport function calcVelocity(deltaV, deltaTime, prevVelocity) {\n  if (deltaTime < 1) {\n    deltaTime = 1;\n  }\n\n  // Calculate speed and speed depreciation.\n  const speed = deltaV / deltaTime;\n\n  // Depreciation is simply an informational quality. It basically means:\n  // we can't ignore the velocity we knew recently, but we'd only consider\n  // it proportionally to how long ago we've seen it. Currently, this\n  // depreciation factor is 1/100 of a millisecond. New average velocity is\n  // calculated by weighing toward the new velocity and away from old\n  // velocity based on the depreciation.\n  const depr = 0.5 + Math.min(deltaTime / VELOCITY_DEPR_FACTOR_, 0.5);\n  return speed * depr + prevVelocity * (1 - depr);\n}\n\n\n/**\n * Returns a motion process that will yield when the velocity has run down to\n * zerp. For each iteration, the velocity is depreciated and the coordinates\n * are advanced from start X/Y to the destination according to velocity\n * vectors. For each such iteration the callback is called with the new x and y.\n * @param {!Node} contextNode\n * @param {number} startX Start X coordinate.\n * @param {number} startY Start Y coordinate.\n * @param {number} veloX Starting X velocity.\n * @param {number} veloY Starting Y velocity.\n * @param {function(number, number):boolean} callback The callback for each\n *   step of the deceleration motion.\n * @param {!./service/vsync-impl.Vsync=} opt_vsync Mostly for testing only.\n * @return {!Motion}\n */\nexport function continueMotion(contextNode, startX, startY, veloX, veloY,\n  callback, opt_vsync) {\n  return new Motion(contextNode, startX, startY, veloX, veloY,\n      callback, opt_vsync).start();\n}\n\n\n/**\n * Motion process that allows tracking and monitoring of the running motion.\n * Most importantly it exposes methods \"then\" and \"thenAlways\" that have the\n * semantics of a Promise and signal when the motion has completed or failed.\n * Additionally, it exposes the method \"halt\" which allows to stop/reset the\n * motion.\n * @implements {IThenable}\n */\nexport class Motion {\n  /**\n   * @param {!Node} contextNode Context node.\n   * @param {number} startX Start X coordinate.\n   * @param {number} startY Start Y coordinate.\n   * @param {number} veloX Starting X velocity.\n   * @param {number} veloY Starting Y velocity.\n   * @param {function(number, number):boolean} callback The callback for each\n   *   step of the deceleration motion.\n   * @param {!./service/vsync-impl.Vsync=} opt_vsync\n   */\n  constructor(contextNode, startX, startY, veloX, veloY, callback, opt_vsync) {\n    /** @private @const {!./service/vsync-impl.Vsync} */\n    this.vsync_ = opt_vsync || Services.vsyncFor(self);\n\n    /** @private @const {!Node} */\n    this.contextNode_ = contextNode;\n\n    /** @private @const */\n    this.callback_ = callback;\n\n    /** @private {number} */\n    this.lastX_ = startX;\n\n    /** @private {number} */\n    this.lastY_ = startY;\n\n    /** @private {number} */\n    this.maxVelocityX_ = veloX;\n\n    /** @private {number} */\n    this.maxVelocityY_ = veloY;\n\n    /** @private {number} */\n    this.velocityX_ = 0;\n\n    /** @private {number} */\n    this.velocityY_ = 0;\n\n    const deferred = new Deferred();\n\n    /** @private {!Promise} */\n    this.promise_ = deferred.promise;\n\n    /** @private {!Function} */\n    this.resolve_ = deferred.resolve;\n\n    /** @private {!Function} */\n    this.reject_ = deferred.reject;\n\n    /** @private {boolean} */\n    this.continuing_ = false;\n  }\n\n  /** */\n  start() {\n    this.continuing_ = true;\n    if (Math.abs(this.maxVelocityX_) <= MIN_VELOCITY_ &&\n            Math.abs(this.maxVelocityY_) <= MIN_VELOCITY_) {\n      this.fireMove_();\n      this.completeContinue_(true);\n    } else {\n      this.runContinuing_();\n    }\n    return this;\n  }\n\n  /**\n   * Halts the motion. The motion promise will be rejected since the motion\n   * has been interrupted.\n   */\n  halt() {\n    if (this.continuing_) {\n      this.completeContinue_(false);\n    }\n  }\n\n  /**\n   * Chains to the motion's promise that will resolve when the motion has\n   * completed or will reject if motion has failed or was interrupted.\n   * @override\n   */\n  then(opt_resolve, opt_reject) {\n    if (!opt_resolve && !opt_reject) {\n      return this.promise_;\n    }\n    return this.promise_.then(opt_resolve, opt_reject);\n  }\n\n  /**\n   * Callback for regardless whether the motion succeeds or fails.\n   * @param {function()=} opt_callback\n   * @return {!Promise}\n   */\n  thenAlways(opt_callback) {\n    const callback = opt_callback || NOOP_CALLBACK_;\n    return /** @type {!Promise} */ (this.then(callback, callback));\n  }\n\n  /**\n   * @return {!Promise}\n   * @private\n   */\n  runContinuing_() {\n    this.velocityX_ = this.maxVelocityX_;\n    this.velocityY_ = this.maxVelocityY_;\n    const boundStep = this.stepContinue_.bind(this);\n    const boundComplete = this.completeContinue_.bind(this, true);\n    return this.vsync_.runAnimMutateSeries(this.contextNode_, boundStep, 5000)\n        .then(boundComplete, boundComplete);\n  }\n\n  /**\n   * Returns \"true\" to continue and \"false\" to stop motion process.\n   * @param {time} timeSinceStart\n   * @param {time} timeSincePrev\n   * @return {boolean}\n   * @private\n   */\n  stepContinue_(timeSinceStart, timeSincePrev) {\n    if (!this.continuing_) {\n      return false;\n    }\n\n    this.lastX_ += timeSincePrev * this.velocityX_;\n    this.lastY_ += timeSincePrev * this.velocityY_;\n    if (!this.fireMove_()) {\n      return false;\n    }\n\n    const decel = Math.exp(-timeSinceStart / EXP_FRAME_CONST_);\n    this.velocityX_ = this.maxVelocityX_ * decel;\n    this.velocityY_ = this.maxVelocityY_ * decel;\n    return (Math.abs(this.velocityX_) > MIN_VELOCITY_ ||\n        Math.abs(this.velocityY_) > MIN_VELOCITY_);\n  }\n\n  /**\n   * @param {boolean} success\n   * @private\n   */\n  completeContinue_(success) {\n    if (!this.continuing_) {\n      return;\n    }\n    this.continuing_ = false;\n    this.fireMove_();\n    if (success) {\n      this.resolve_();\n    } else {\n      this.reject_();\n    }\n  }\n\n  /** @private */\n  fireMove_() {\n    return this.callback_(this.lastX_, this.lastY_);\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n\n/**\n * This class helps to manage observers. Observers can be added, removed or\n * fired through and instance of this class.\n * @template TYPE\n */\nexport class Observable {\n\n  /**\n   * Creates an instance of Observable.\n   */\n  constructor() {\n    /** @type {?Array<function(TYPE)>} */\n    this.handlers_ = null;\n  }\n\n  /**\n   * Adds the observer to this instance.\n   * @param {function(TYPE)} handler Observer's handler.\n   * @return {!UnlistenDef}\n   */\n  add(handler) {\n    if (!this.handlers_) {\n      this.handlers_ = [];\n    }\n    this.handlers_.push(handler);\n    return () => {\n      this.remove(handler);\n    };\n  }\n\n  /**\n   * Removes the observer from this instance.\n   * @param {function(TYPE)} handler Observer's instance.\n   */\n  remove(handler) {\n    if (!this.handlers_) {\n      return;\n    }\n    const index = this.handlers_.indexOf(handler);\n    if (index > -1) {\n      this.handlers_.splice(index, 1);\n    }\n  }\n\n  /**\n   * Removes all observers.\n   */\n  removeAll() {\n    if (!this.handlers_) {\n      return;\n    }\n    this.handlers_.length = 0;\n  }\n\n  /**\n   * Fires an event. All observers are called.\n   * @param {TYPE=} opt_event\n   */\n  fire(opt_event) {\n    if (!this.handlers_) {\n      return;\n    }\n    const handlers = this.handlers_;\n    for (let i = 0; i < handlers.length; i++) {\n      const handler = handlers[i];\n      handler(opt_event);\n    }\n  }\n\n  /**\n   * Returns number of handlers. Mostly needed for tests.\n   * @return {number}\n   */\n  getHandlerCount() {\n    if (!this.handlers_) {\n      return 0;\n    }\n    return this.handlers_.length;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from './services';\n\n\n/**\n * Pass class helps to manage single-pass process. A pass is scheduled using\n * delay method. Only one pass can be pending at a time. If no pass is pending\n * the process is considered to be \"idle\".\n */\nexport class Pass {\n\n  /**\n   * Creates a new Pass instance.\n   * @param {!Window} win\n   * @param {function()} handler Handler to be executed when pass is triggered.\n   * @param {number=} opt_defaultDelay Default delay to be used when schedule\n   *   is called without one.\n   */\n  constructor(win, handler, opt_defaultDelay) {\n    this.timer_ = Services.timerFor(win);\n\n    /** @private @const {function()} */\n    this.handler_ = handler;\n\n    /** @private @const {number} */\n    this.defaultDelay_ = opt_defaultDelay || 0;\n\n    /** @private {number|string} */\n    this.scheduled_ = -1;\n\n    /** @private {number} */\n    this.nextTime_ = 0;\n\n    /** @private {boolean} */\n    this.running_ = false;\n\n    /** @private @const {!Function} */\n    this.boundPass_ = () => this.pass_();\n  }\n\n  /**\n   * Whether or not a pass is currently pending.\n   * @return {boolean}\n   */\n  isPending() {\n    return this.scheduled_ != -1;\n  }\n\n  /**\n   * Tries to schedule a new pass optionally with specified delay. If the new\n   * requested pass is requested before the pending pass, the pending pass is\n   * canceled. If the new pass is requested after the pending pass, the newly\n   * requested pass is ignored.\n   *\n   * Returns {@code true} if the pass has been scheduled and {@code false} if\n   * ignored.\n   *\n   * @param {number=} opt_delay Delay to schedule the pass. If not specified\n   *   the default delay is used, falling back to 0.\n   * @return {boolean}\n   */\n  schedule(opt_delay) {\n    let delay = opt_delay || this.defaultDelay_;\n    if (this.running_ && delay < 10) {\n      // If we get called recursively, wait at least 10ms for the next\n      // execution.\n      delay = 10;\n    }\n\n    const nextTime = Date.now() + delay;\n    // Schedule anew if nothing is scheduled currently or if the new time is\n    // sooner then previously requested.\n    if (!this.isPending() || nextTime - this.nextTime_ < -10) {\n      this.cancel();\n      this.nextTime_ = nextTime;\n      this.scheduled_ = this.timer_.delay(this.boundPass_, delay);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   *\n   */\n  pass_() {\n    this.scheduled_ = -1;\n    this.nextTime_ = 0;\n    this.running_ = true;\n    this.handler_();\n    this.running_ = false;\n  }\n\n  /**\n   * Cancels the pending pass if any.\n   */\n  cancel() {\n    if (this.isPending()) {\n      this.timer_.cancel(this.scheduled_);\n      this.scheduled_ = -1;\n    }\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {install as installArrayIncludes} from './polyfills/array-includes';\nimport {install as installCustomElements} from './polyfills/custom-elements';\nimport {\n  install as installDOMTokenListToggle,\n} from './polyfills/domtokenlist-toggle';\nimport {install as installDocContains} from './polyfills/document-contains';\nimport {install as installMathSign} from './polyfills/math-sign';\nimport {install as installObjectAssign} from './polyfills/object-assign';\nimport {install as installPromise} from './polyfills/promise';\nimport {installCustomElements as installRegisterElement} from\n  'document-register-element/build/document-register-element.patched';\nimport {isExperimentOn} from './experiments';\n\nif (isExperimentOn(self, 'custom-elements-v1') || getMode().test) {\n  installCustomElements(self, class {});\n} else {\n  installRegisterElement(self, 'auto');\n}\ninstallDOMTokenListToggle(self);\ninstallMathSign(self);\ninstallObjectAssign(self);\ninstallPromise(self);\ninstallDocContains(self);\ninstallArrayIncludes(self);\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Returns true if the element is in the array and false otherwise.\n *\n * @param {*} value\n * @param {number=} opt_fromIndex\n * @return {boolean}\n * @this {Array}\n */\nfunction includes(value, opt_fromIndex) {\n  const fromIndex = opt_fromIndex || 0;\n  const len = this.length;\n  let i = fromIndex >= 0 ? fromIndex : Math.max(len + fromIndex, 0);\n  for (; i < len; i++) {\n    const other = this[i];\n    // If value has been found OR (value is NaN AND other is NaN)\n    /*eslint \"no-self-compare\": 0*/\n    if (other === value || (value !== value && other !== other)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n* Sets the Array.contains polyfill if it does not exist.\n* @param {!Window} win\n*/\nexport function install(win) {\n  if (!win.Array.prototype.includes) {\n    win.Object.defineProperty(Array.prototype, 'includes', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: includes,\n    });\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @typedef {{\n *   promise: !Promise<undefined>,\n *   resolve: function(),\n * }}\n */\nlet DeferredDef;\n\n/**\n * @typedef {!Function}\n */\nlet CustomElementConstructorDef;\n\n/**\n * @typedef {{\n *  name: string,\n *  ctor: !CustomElementConstructorDef,\n * }}\n */\nlet CustomElementDef;\n\n/**\n * Validates the custom element's name.\n * This intentionally ignores \"valid\" higher Unicode Code Points.\n * https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name\n */\nconst VALID_NAME = /^[a-z][a-z0-9._]*-[a-z0-9._-]*$/;\nconst INVALID_NAMES = [\n  'annotation-xml',\n  'color-profile',\n  'font-face',\n  'font-face-src',\n  'font-face-uri',\n  'font-face-format',\n  'font-face-name',\n  'missing-glyph',\n];\n\n/**\n * Asserts that the custom element name conforms to the spec.\n *\n * @param {!Function} SyntaxError\n * @param {string} name\n */\nfunction assertValidName(SyntaxError, name) {\n  if (!VALID_NAME.test(name) || INVALID_NAMES.indexOf(name) >= 0) {\n    throw new SyntaxError(`invalid custom element name \"${name}\"`);\n  }\n}\n\n/**\n * Does win have a full Custom Elements registry?\n *\n * @param {!Window} win\n * @return {boolean}\n */\nfunction hasCustomElements(win) {\n  const {customElements} = win;\n\n  return !!(\n    customElements &&\n    customElements.define &&\n    customElements.get &&\n    customElements.whenDefined);\n}\n\n/**\n * Was HTMLElement already patched for this window?\n *\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isPatched(win) {\n  const tag = win.HTMLElement.toString();\n  return tag.indexOf('[native code]') === -1;\n}\n\n/**\n * The public Custom Elements API.\n */\nclass CustomElementRegistry {\n  /**\n   * @param {!Window} win\n   * @param {!Registry} registry\n   */\n  constructor(win, registry) {\n    /**\n     * @const @private\n     */\n    this.win_ = win;\n\n    /**\n     * @const @private\n     */\n    this.registry_ = registry;\n\n    /**\n     * @type {!Object<string, DeferredDef>}\n     * @private\n     * @const\n     */\n    this.pendingDefines_ = this.win_.Object.create(null);\n  }\n\n  /**\n   * Register the custom element.\n   *\n   * @param {string} name\n   * @param {!CustomElementConstructorDef} ctor\n   * @param {!Object=} options\n   */\n  define(name, ctor, options) {\n    this.registry_.define(name, ctor, options);\n\n    // If anyone is waiting for this custom element to be defined, resolve\n    // their promise.\n    const pending = this.pendingDefines_;\n    const deferred = pending[name];\n    if (deferred) {\n      deferred.resolve();\n      delete pending[name];\n    }\n  }\n\n  /**\n   * Get the constructor of the (already defined) custom element.\n   *\n   * @param {string} name\n   * @return {!CustomElementConstructorDef|undefined}\n   */\n  get(name) {\n    const def = this.registry_.getByName(name);\n    if (def) {\n      return def.ctor;\n    }\n  }\n\n  /**\n   * Returns a promise that waits until the custom element is defined.\n   * If the custom element is already defined, returns a resolved promise.\n   *\n   * @param {string} name\n   * @return {!Promise<undefined>}\n   */\n  whenDefined(name) {\n    const {Promise, SyntaxError} = this.win_;\n    assertValidName(SyntaxError, name);\n\n    if (this.registry_.getByName(name)) {\n      return Promise.resolve();\n    }\n\n    const pending = this.pendingDefines_;\n    const deferred = pending[name];\n    if (deferred) {\n      return deferred.promise;\n    }\n\n    let resolve;\n    const promise = new /*OK*/Promise(res => resolve = res);\n    pending[name] = {\n      promise,\n      resolve,\n    };\n\n    return promise;\n  }\n\n  /**\n   * Upgrade all custom elements inside root.\n   *\n   * @param {!Node} root\n   */\n  upgrade(root) {\n    this.registry_.upgrade(root);\n  }\n}\n\n/**\n * This internal APIs necessary to run the CustomElementRegistry.\n * Since Registry is never exposed externally, all methods are actually\n * available on the instance.\n */\nclass Registry {\n  /**\n   * @param {!Window} win\n   */\n  constructor(win) {\n    /**\n     * @private @const\n     */\n    this.win_ = win;\n\n    /**\n     * @private @const\n     */\n    this.doc_ = win.document;\n\n    /**\n     * @type {!Object<string, !CustomElementDef>}\n     * @private\n     * @const\n     */\n    this.definitions_ = win.Object.create(null);\n\n    /**\n     * A up-to-date DOM selector for all custom elements.\n     * @type {string}\n     */\n    this.query_ = '';\n\n    /**\n     * The currently upgrading element.\n     * @private {Element}\n     */\n    this.current_ = null;\n  }\n\n  /**\n   * The currently-being-upgraded custom element.\n   *\n   * When an already created (through the DOM parsing APIs, or innerHTML)\n   * custom element node is being upgraded, we can't just create a new node\n   * (it's illegal in the spec). But we still need to run the custom element's\n   * constructor code on the node. We avoid this conundrum by running the\n   * constructor while returning this current node in the HTMLElement\n   * class constructor (the base class of all custom elements).\n   *\n   * @return {Element}\n   */\n  current() {\n    const current = this.current_;\n    this.current_ = null;\n    return current;\n  }\n\n  /**\n   * Finds the custom element definition by name.\n   *\n   * @param {string} name\n   * @return {CustomElementDef|undefined}\n   */\n  getByName(name) {\n    const definition = this.definitions_[name];\n    if (definition) {\n      return definition;\n    }\n  }\n\n  /**\n   * Finds the custom element definition by constructor instance.\n   *\n   * @param {CustomElementConstructorDef} ctor\n   * @return {CustomElementDef|undefined}\n   */\n  getByConstructor(ctor) {\n    const definitions = this.definitions_;\n\n    for (const name in definitions) {\n      const def = definitions[name];\n      if (def.ctor === ctor) {\n        return def;\n      }\n    }\n  }\n\n  /**\n   * Registers the custom element definition, and upgrades all elements by that\n   * name in the root document.\n   *\n   * @param {string} name\n   * @param {!CustomElementConstructorDef} ctor\n   * @param {!Object|undefined} options\n   */\n  define(name, ctor, options) {\n    const {Error, SyntaxError} = this.win_;\n\n    if (options) {\n      throw new Error('Extending native custom elements is not supported');\n    }\n\n    assertValidName(SyntaxError, name);\n\n    if (this.getByName(name) ||\n        this.getByConstructor(ctor)) {\n      throw new Error(`duplicate definition \"${name}\"`);\n    }\n\n    // TODO(jridgewell): Record connectedCallback, disconnectedCallback,\n    // adoptedCallback, attributeChangedCallback, and observedAttributes.\n    // TODO(jridgewell): If attributeChangedCallback, gather observedAttributes\n    this.definitions_[name] = {\n      name,\n      ctor,\n    };\n\n    this.observe_(name);\n    this.upgrade(this.doc_, name);\n  }\n\n  /**\n   * Upgrades custom elements descendants of root (but not including root).\n   *\n   * When called with an opt_query, it both upgrades and connects the custom\n   * elements (this is used during the custom element define algorithm).\n   *\n   * @param {!Node} root\n   * @param {string=} opt_query\n   */\n  upgrade(root, opt_query) {\n    // Only CustomElementRegistry.p.define provides a query (the newly defined\n    // custom element). In this case, we are both upgrading _and_ connecting\n    // the custom elements.\n    const newlyDefined = !!opt_query;\n    const query = opt_query || this.query_;\n    const upgradeCandidates = this.queryAll_(root, query);\n\n    for (let i = 0; i < upgradeCandidates.length; i++) {\n      const candidate = upgradeCandidates[i];\n      if (newlyDefined) {\n        this.connectedCallback_(candidate);\n      } else {\n        this.upgradeSelf(candidate);\n      }\n    }\n  }\n\n  /**\n   * Upgrades the custom element node, if a custom element has been registered\n   * by this name.\n   *\n   * @param {!Node} node\n   */\n  upgradeSelf(node) {\n    const def = this.getByName(node.localName);\n    if (!def) {\n      return;\n    }\n\n    this.upgradeSelf_(/** @type {!Element} */(node), def);\n  }\n\n  /**\n   * @param {!Node} root\n   * @param {string} query\n   * @return {!Array|!NodeList}\n   */\n  queryAll_(root, query) {\n    if (!query || !root.querySelectorAll) {\n      // Nothing to do...\n      return [];\n    }\n\n    return root.querySelectorAll(query);\n  }\n\n  /**\n   * Upgrades the (already created via DOM parsing) custom element.\n   *\n   * @param {!Element} node\n   * @param {!CustomElementDef} def\n   */\n  upgradeSelf_(node, def) {\n    const {ctor} = def;\n    if (node instanceof ctor) {\n      return;\n    }\n\n    // Despite how it looks, this is not a useless construction.\n    // HTMLElementPolyfill (the base class of all custom elements) will return\n    // the current node, allowing the custom element's subclass constructor to\n    // run on the node. The node itself is already constructed, so the return\n    // value is just the node.\n    this.current_ = node;\n    const el = new ctor();\n\n    if (el !== node) {\n      throw new this.win_.Error(\n          'Constructor illegally returned a different instance.');\n    }\n  }\n\n  /**\n   * Fires connectedCallback on the custom element, if it has one.\n   * This also upgrades the custom element, since it may not have been\n   * accessible via the root document before (a detached DOM tree).\n   *\n   * @param {!Node} node\n   */\n  connectedCallback_(node) {\n    const def = this.getByName(node.localName);\n    if (!def) {\n      return;\n    }\n    this.upgradeSelf_(/** @type {!Element} */(node), def);\n    // TODO(jridgewell): It may be appropriate to adoptCallback, if the node\n    // used to be in another doc.\n    // TODO(jridgewell): I should be calling the definitions connectedCallback\n    // with node as the context.\n    if (node.connectedCallback) {\n      node.connectedCallback();\n    }\n  }\n\n  /**\n   * Fires disconnectedCallback on the custom element, if it has one.\n   *\n   * @param {!Node} node\n   */\n  disconnectedCallback_(node) {\n    // TODO(jridgewell): I should be calling the definitions connectedCallback\n    // with node as the context.\n    if (node.disconnectedCallback) {\n      node.disconnectedCallback();\n    }\n  }\n\n  /**\n   * Records name as a registered custom element to observe.\n   *\n   * Starts the Mutation Observer if this is the first registered custom\n   * element. This is deferred until the first custom element is defined to\n   * speed up initial rendering of the page.\n   *\n   * Mutation Observers are conveniently available in every browser we care\n   * about. When a node is connected to the root document, all custom\n   * elements (including that node iteself) will be upgraded and call\n   * connectedCallback. When a node is disconnectedCallback from the root\n   * document, all custom elements will call disconnectedCallback.\n   *\n   * @param {string} name\n   */\n  observe_(name) {\n    if (this.query_) {\n      this.query_ += `,${name}`;\n      return;\n    }\n\n    this.query_ = name;\n\n    // The first registered name starts the mutation observer.\n    const observer = new this.win_.MutationObserver(records => {\n      if (records) {\n        this.handleRecords_(records);\n      }\n    });\n    observer.observe(this.doc_, {\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  /**\n   * Handle all the Mutation Observer's Mutation Records.\n   * All added custom elements will be upgraded (if not already) and call\n   * connectedCallback. All removed custom elements will call\n   * disconnectedCallback.\n   *\n   * @param {!Array<!MutationRecord>} records\n   */\n  handleRecords_(records) {\n    for (let i = 0; i < records.length; i++) {\n      const record = records[i];\n      if (!record) {\n        continue;\n      }\n\n      const {addedNodes, removedNodes} = record;\n      for (let i = 0; i < addedNodes.length; i++) {\n        const node = addedNodes[i];\n        const connectedCandidates = this.queryAll_(node, this.query_);\n        this.connectedCallback_(node);\n        for (let i = 0; i < connectedCandidates.length; i++) {\n          this.connectedCallback_(connectedCandidates[i]);\n        }\n      }\n\n      for (let i = 0; i < removedNodes.length; i++) {\n        const node = removedNodes[i];\n        const disconnectedCandidates = this.queryAll_(node, this.query_);\n        this.disconnectedCallback_(node);\n        for (let i = 0; i < disconnectedCandidates.length; i++) {\n          this.disconnectedCallback_(disconnectedCandidates[i]);\n        }\n      }\n    }\n  }\n}\n\n/**\n * Does the polyfilling.\n * @param {!Window} win\n */\nfunction polyfill(win) {\n  const {HTMLElement, Element, Node, Document, Object, document} = win;\n  const {createElement, cloneNode, importNode} = document;\n\n  const registry = new Registry(win);\n  const customElements = new CustomElementRegistry(win, registry);\n\n  // Expose the custom element registry.\n  // Object.getOwnPropertyDescriptor(window, 'customElements')\n  // {get: ƒ, set: undefined, enumerable: true, configurable: true}\n  Object.defineProperty(win, 'customElements', {\n    enumerable: true,\n    configurable: true,\n    // writable: false,\n    value: customElements,\n  });\n\n  // Patch createElement to immediately upgrade the custom element.\n  // This has the added benefit that it avoids the \"already created but needs\n  // constructor code run\" chicken-and-egg problem.\n  Document.prototype.createElement = function createElementPolyfill(name) {\n    const def = registry.getByName(name);\n    if (def) {\n      return new def.ctor();\n    }\n    return createElement.apply(this, arguments);\n  };\n\n  // Patch importNode to immediately upgrade custom elements.\n  // TODO(jridgewell): Can fire adoptedCallback for cross doc imports.\n  Document.prototype.importNode = function importNodePolyfill() {\n    const imported = importNode.apply(this, arguments);\n    if (imported) {\n      registry.upgradeSelf(imported);\n      registry.upgrade(imported);\n    }\n    return imported;\n  };\n\n  // Patch cloneNode to immediately upgrade custom elements.\n  Node.prototype.cloneNode = function cloneNodePolyfill() {\n    const cloned = cloneNode.apply(this, arguments);\n    registry.upgradeSelf(cloned);\n    registry.upgrade(cloned);\n    return cloned;\n  };\n\n  // Patch the innerHTML setter to immediately upgrade custom elements.\n  // Note, this could technically fire connectedCallbacks if this node was\n  // connected, but we leave that to the Mutation Observer.\n  const innerHTMLDesc = Object.getOwnPropertyDescriptor(Element.prototype,\n      'innerHTML');\n  const innerHTMLSetter = innerHTMLDesc.set;\n  innerHTMLDesc.set = function(html) {\n    innerHTMLSetter.call(this, html);\n    registry.upgrade(this);\n  };\n  Object.defineProperty(Element.prototype, 'innerHTML', innerHTMLDesc);\n\n  /**\n   * You can't use the real HTMLElement constructor, because you can't subclass\n   * it without using native classes. So, mock its approximation using\n   * createElement.\n   */\n  function HTMLElementPolyfill() {\n    const {constructor} = this;\n\n    // If we're upgrading an already created custom element, we can't create\n    // another new node (by the spec, it must be the same node).\n    let el = registry.current();\n\n    // If there's not a already created custom element, we're being invoked via\n    // `new`ing the constructor.\n    //\n    // Technically, we could get here via createElement, but we patched that.\n    // If it the custom element was registered, the patch turned it into a\n    // `new` call.\n    // If it was not registered, the native createElement is used. And if\n    // native createElement is being used and we got to this code, we're really\n    // in an infinite loop (a native createElement call just below) so we've\n    // got bigger problems.\n    //\n    // So just take my word we got here via `new`.\n    if (!el) {\n      // The custom element definition is an invariant. If the custom element\n      // is registered, everything works. If it's not, it throws in the member\n      // property access (only defined custom elements can be directly\n      // constructed via `new`).\n      const def = registry.getByConstructor(constructor);\n      el = createElement.call(document, def.name);\n    }\n\n    // Finally, if the node was already constructed, we need to reset it's\n    // prototype to the custom element prototype. And if it wasn't already\n    // constructed, we created a new node via native createElement, and we need\n    // to reset it's prototype. Basically always reset the prototype.\n    Object.setPrototypeOf(el, constructor.prototype);\n    return el;\n  }\n  subClass(Object, HTMLElement, HTMLElementPolyfill);\n\n  // Expose the polyfilled HTMLElement constructor for everyone to extend from.\n  win.HTMLElement = HTMLElementPolyfill;\n}\n\n/**\n * Wraps HTMLElement in a Reflect.construct constructor, so that transpiled\n * classes can `_this = superClass.call(this)` during their construction.\n *\n * This is only used when Custom Elements v1 is already available _and_ we're\n * using transpiled classes (which use ES5 construction idioms).\n *\n * @param {!Window} win\n */\nfunction wrapHTMLElement(win) {\n  const {HTMLElement, Reflect, Object} = win;\n  /**\n   */\n  function HTMLElementWrapper() {\n    const ctor = /** @type {function(...?):?|undefined} */(\n      /** @type {!HTMLElement} */(this).constructor);\n\n    // Reflect.construct allows us to construct a new HTMLElement without using\n    // `new` (which will always fail because native HTMLElement is a restricted\n    // constructor).\n    return Reflect.construct(HTMLElement, [], ctor);\n  }\n  subClass(Object, HTMLElement, HTMLElementWrapper);\n\n  // Expose the wrapped HTMLElement constructor for everyone to extend from.\n  win.HTMLElement = HTMLElementWrapper;\n}\n\n/**\n * Setups up prototype inheritance\n *\n * @param {!Object} Object\n * @param {!Function} superClass\n * @param {!Function} subClass\n */\nfunction subClass(Object, superClass, subClass) {\n  // Object.getOwnPropertyDescriptor(superClass.prototype, 'constructor')\n  // {value: ƒ, writable: true, enumerable: false, configurable: true}\n  subClass.prototype = Object.create(superClass.prototype, {\n    constructor: {\n      // enumerable: false,\n      configurable: true,\n      writable: true,\n      value: subClass,\n    },\n  });\n}\n\n/**\n * Polyfills Custom Elements v1 API. This has 4 modes:\n *\n * 1. Custom elements v1 already supported, using native classes\n * 2. Custom elements v1 already supported, using transpiled classes\n * 3. Custom elements v1 not supported, using native classes\n * 4. Custom elements v1 not supported, using transpiled classes\n *\n * In mode 1, nothing is done. In mode 2, a minimal polyfill is used to support\n * extending the HTMLElement base class. In mode 3 and 4, a full polyfill is\n * done.\n *\n * @param {!Window} win\n * @param {!Function} ctor\n */\nexport function install(win, ctor) {\n  if (isPatched(win)) {\n    return;\n  }\n\n  let install = true;\n  let installWrapper = false;\n\n  if (hasCustomElements(win)) {\n    // If ctor is constructable without new, it's a function. That means it was\n    // compiled down, and we need to do the minimal polyfill because all you\n    // cannot extend HTMLElement without native classes.\n    try {\n      const {Object, Reflect} = win;\n\n      // \"Construct\" ctor using ES5 idioms\n      const instance = Object.create(ctor.prototype);\n      ctor.call(instance);\n\n      // If that succeeded, we're in a transpiled environment\n      // Let's find out if we can wrap HTMLElement and avoid a full patch.\n      installWrapper = !!(Reflect && Reflect.construct);\n    } catch (e) {\n\n      // The ctor threw when we constructed is via ES5, so it's a real class.\n      // We're ok to not install the polyfill.\n      install = false;\n    }\n  }\n\n  if (installWrapper) {\n    wrapHTMLElement(win);\n  } else if (install) {\n    polyfill(win);\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Polyfill for `document.contains()` method. Notice that according to spec\n * `document.contains` is inclusionary.\n * See https://developer.mozilla.org/en-US/docs/Web/API/Node/contains\n * @param {?Node} node\n * @return {boolean}\n * @this {Node}\n */\nfunction documentContainsPolyfill(node) {\n  // Per spec, \"contains\" method is inclusionary\n  // i.e. `node.contains(node) == true`. However, we still need to test\n  // equality to the document itself.\n  return node == this || this.documentElement.contains(node);\n}\n\n\n/**\n * Polyfills `HTMLDocument.contains` API.\n * @param {!Window} win\n */\nexport function install(win) {\n  // HTMLDocument is undefined in Internet Explorer 10, but it has Document,\n  // so we use that as a fallback.\n  const documentClass = win.HTMLDocument || win.Document;\n  if (!documentClass.prototype.contains) {\n    win.Object.defineProperty(documentClass.prototype, 'contains', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: documentContainsPolyfill,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Polyfill for `DOMTokenList.prototype.toggle(token, opt_force)` method. This\n * is specially important because IE does not support `opt_force` attribute. See\n * https://goo.gl/hgKNYY for details.\n * @param {string} token\n * @param {boolean=} opt_force\n * @this {DOMTokenList}\n * @return {boolean}\n */\nfunction domTokenListTogglePolyfill(token, opt_force) {\n  const remove = opt_force === undefined ? this.contains(token) : !opt_force;\n  if (remove) {\n    this.remove(token);\n    return false;\n  } else {\n    this.add(token);\n    return true;\n  }\n}\n\n\n/**\n * Polyfills `DOMTokenList.prototype.toggle` API in IE.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (isIe(win) && win.DOMTokenList) {\n    win.Object.defineProperty(win.DOMTokenList.prototype, 'toggle', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: domTokenListTogglePolyfill,\n    });\n  }\n}\n\n\n/**\n * Whether the current browser is a IE browser.\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isIe(win) {\n  return /Trident|MSIE|IEMobile/i.test(win.navigator.userAgent);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Parses the number x and returns its sign. For positive x returns 1, for\n * negative, -1. For 0 and -0, returns 0 and -0 respectively. For any number\n * that parses to NaN, returns NaN.\n *\n * @param {number} x\n * @return {number}\n */\nexport function sign(x) {\n  x = Number(x);\n\n  // If x is 0, -0, or NaN, return it.\n  if (!x) {\n    return x;\n  }\n\n  return x > 0 ? 1 : -1;\n}\n\n\n/**\n * Sets the Math.sign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Math.sign) {\n    win.Object.defineProperty(win.Math, 'sign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: sign,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst {hasOwnProperty} = Object.prototype;\n\n/**\n * Copies values of all enumerable own properties from one or more source\n * objects (provided as extended arguments to the function) to a target object.\n *\n * @param {!Object} target\n * @param {...Object} var_args\n * @return {!Object}\n */\nexport function assign(target, var_args) {\n  if (target == null) {\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  const output = Object(target);\n  for (let i = 1; i < arguments.length; i++) {\n    const source = arguments[i];\n    if (source != null) {\n      for (const key in source) {\n        if (hasOwnProperty.call(source, key)) {\n          output[key] = source[key];\n        }\n      }\n    }\n  }\n  return output;\n}\n\n\n/**\n * Sets the Object.assign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Object.assign) {\n    win.Object.defineProperty(win.Object, 'assign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: assign,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nimport * as Promise from 'promise-pjs/promise';\n\n/**\n * Sets the Promise polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Promise) {\n    win.Promise = /** @type {?} */ (Promise);\n    // In babel the * export is an Object with a default property.\n    // In closure compiler it is the Promise function itself.\n    if (Promise.default) {\n      win.Promise = Promise.default;\n    }\n    // We copy the individual static methods, because closure\n    // compiler flattens the polyfill namespace.\n    win.Promise.resolve = Promise.resolve;\n    win.Promise.reject = Promise.reject;\n    win.Promise.all = Promise.all;\n    win.Promise.race = Promise.race;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Registration and getter functions for AMP services.\n *\n * Invariant: Service getters never return null for registered services.\n */\n\n// src/polyfills.js must be the first import.\nimport './polyfills'; // eslint-disable-line sort-imports-es6-autofix/sort-imports-es6\n\nimport {Deferred} from './utils/promise';\nimport {dev} from './log';\nimport {toWin} from './types';\n\n\n/**\n * Holds info about a service.\n * - obj: Actual service implementation when available.\n * - promise: Promise for the obj.\n * - resolve: Function to resolve the promise with the object.\n * - context: Argument for ctor, either a window or an ampdoc.\n * - ctor: Function that constructs and returns the service.\n * @typedef {{\n *   obj: (?Object),\n *   promise: (?Promise),\n *   resolve: (?function(!Object)),\n *   context: (?Window|?./service/ampdoc-impl.AmpDoc),\n *   ctor: (?function(new:Object, !Window)|\n *          ?function(new:Object, !./service/ampdoc-impl.AmpDoc)),\n * }}\n */\nlet ServiceHolderDef;\n\n\n/**\n * This interface provides a `dispose` method that will be called by\n * runtime when a service needs to be disposed of.\n * @interface\n */\nexport class Disposable {\n\n  /**\n   * Instructs the service to release any resources it might be holding. Can\n   * be called only once in the lifecycle of a service.\n   */\n  dispose() {}\n}\n\n\n/**\n * This interface provides a `adoptEmbedWindow` method that will be called by\n * runtime for a new embed window.\n * @interface\n */\nexport class EmbeddableService {\n\n  /**\n   * Instructs the service to adopt the embed window and add any necessary\n   * listeners and resources.\n   * @param {!Window} unusedEmbedWin\n   */\n  adoptEmbedWindow(unusedEmbedWin) {}\n}\n\n\n/**\n * Returns a service with the given id. Assumes that it has been registered\n * already.\n * @param {!Window} win\n * @param {string} id\n * @param {boolean=} opt_fallbackToTopWin\n * @return {Object} The service.\n */\nexport function getExistingServiceInEmbedScope(win, id, opt_fallbackToTopWin) {\n  // First, try to resolve via local (embed) window.\n  const local = getLocalExistingServiceForEmbedWinOrNull(win, id);\n  if (local) {\n    return local;\n  }\n  if (opt_fallbackToTopWin) {\n    return getService(win, id);\n  }\n  return null;\n}\n\n/**\n * Returns a service with the given id. Assumes that it has been constructed\n * already.\n *\n * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n * services since sometimes we only have the FIE Document for context.\n *\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id\n * @param {boolean=} opt_fallbackToTopWin\n * @return {Object} The service.\n */\nexport function getExistingServiceForDocInEmbedScope(\n  nodeOrDoc, id, opt_fallbackToTopWin) {\n  // First, try to resolve via local (embed) window.\n  if (nodeOrDoc.nodeType) {\n    // If a node is passed, try to resolve via this node.\n    const win = toWin(/** @type {!Document} */ (\n      nodeOrDoc.ownerDocument || nodeOrDoc).defaultView);\n    const local = getLocalExistingServiceForEmbedWinOrNull(win, id);\n    if (local) {\n      return local;\n    }\n  }\n  // If an ampdoc is passed or fallback is allowed, continue resolving.\n  if (!nodeOrDoc.nodeType || opt_fallbackToTopWin) {\n    return getServiceForDocDeprecated(nodeOrDoc, id);\n  }\n  return null;\n}\n\n/**\n * Installs a service override on amp-doc level.\n * @param {!Window} embedWin\n * @param {string} id\n * @param {!Object} service The service.\n */\nexport function installServiceInEmbedScope(embedWin, id, service) {\n  const topWin = getTopWindow(embedWin);\n  dev().assert(embedWin != topWin,\n      'Service override can only be installed in embed window: %s', id);\n  dev().assert(!getLocalExistingServiceForEmbedWinOrNull(embedWin, id),\n      'Service override has already been installed: %s', id);\n  registerServiceInternal(embedWin, embedWin, id, () => service);\n  getServiceInternal(embedWin, id); // Force service to build.\n}\n\n/**\n * @param {!Window} embedWin\n * @param {string} id\n * @return {?Object}\n */\nfunction getLocalExistingServiceForEmbedWinOrNull(embedWin, id) {\n  // Note that this method currently only resolves against the given window.\n  // It does not try to go all the way up the parent window chain. We can change\n  // this in the future, but for now this gives us a better performance.\n  const topWin = getTopWindow(embedWin);\n  if (embedWin != topWin && isServiceRegistered(embedWin, id)) {\n    return getServiceInternal(embedWin, id);\n  } else {\n    return null;\n  }\n}\n\n/**\n * Registers a service given a class to be used as implementation.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {function(new:Object, !Window)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilder(win,\n  id,\n  constructor,\n  opt_instantiate) {\n  win = getTopWindow(win);\n  registerServiceInternal(win, win, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(win, id);\n  }\n}\n\n\n/**\n * Returns a service and registers it given a class to be used as\n * implementation.\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id of the service.\n * @param {function(new:Object, !./service/ampdoc-impl.AmpDoc)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilderForDoc(nodeOrDoc,\n  id,\n  constructor,\n  opt_instantiate) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  registerServiceInternal(holder, ampdoc, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(holder, id);\n  }\n}\n\n\n/**\n * Returns a service for the given id and window (a per-window singleton). Users\n * should typically wrap this as a special purpose function (e.g.\n * `Services.vsyncFor(win)`) for type safety and because the factory should not\n * be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @template T\n * @return {T}\n */\nexport function getService(win, id) {\n  win = getTopWindow(win);\n  return getServiceInternal(win, id);\n}\n\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. `Services.vsyncFor(win)`) for type safety and because the\n * factory should not be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nexport function getServicePromise(win, id) {\n  return getServicePromiseInternal(win, id);\n}\n\n\n/**\n * Returns a service or null with the given id.\n * @param {!Window} win\n * @param {string} id\n * @return {?Object} The service.\n */\nexport function getExistingServiceOrNull(win, id) {\n  win = getTopWindow(win);\n  if (isServiceRegistered(win, id)) {\n    return getServiceInternal(win, id);\n  } else {\n    return null;\n  }\n}\n\n\n/**\n * Like getServicePromise but returns null if the service was never registered.\n * @param {!Window} win\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNull(win, id) {\n  return getServicePromiseOrNullInternal(win, id);\n}\n\n\n/**\n * Returns a service for the given id and ampdoc (a per-ampdoc singleton).\n * Expects service `id` to be registered.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {T}\n * @template T\n */\nexport function getServiceForDoc(elementOrAmpDoc, id) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  return getServiceInternal(holder, id);\n}\n\n\n/**\n * tl;dr -- Use getServiceForDoc() instead of this.\n *\n * Privileged variant of getServiceForDoc() that accepts non-element params,\n * e.g. window.document. This is currently necessary for doc-level services\n * used in startup, e.g. Chunks. Eventually we want to remove this function\n * and have callers find the appropriate AmpDoc and use getServiceForDoc().\n *\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id\n * @return {T}\n * @template T\n */\nexport function getServiceForDocDeprecated(nodeOrDoc, id) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  return getServiceInternal(holder, id);\n}\n\n\n/**\n * Returns a promise for a service for the given id and ampdoc. Also expects\n * a service that has the actual implementation. The promise resolves when\n * the implementation loaded.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {!Promise<!Object>}\n */\nexport function getServicePromiseForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseInternal(\n      getAmpdocServiceHolder(elementOrAmpDoc), id);\n}\n\n\n/**\n * Like getServicePromiseForDoc but returns null if the service was never\n * registered for this ampdoc.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNullForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseOrNullInternal(\n      getAmpdocServiceHolder(elementOrAmpDoc), id);\n}\n\n/**\n * Set the parent and top windows on a child window (friendly iframe).\n * @param {!Window} win\n * @param {!Window} parentWin\n */\nexport function setParentWindow(win, parentWin) {\n  win.__AMP_PARENT = parentWin;\n  win.__AMP_TOP = getTopWindow(parentWin);\n}\n\n\n/**\n * Returns the parent window for a child window (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getParentWindow(win) {\n  return win.__AMP_PARENT || win;\n}\n\n\n/**\n * Returns the top window where AMP Runtime is installed for a child window\n * (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getTopWindow(win) {\n  return win.__AMP_TOP || win;\n}\n\n\n/**\n * Returns the parent \"friendly\" iframe if the node belongs to a child window.\n * @param {!Node} node\n * @param {!Window} topWin\n * @return {?HTMLIFrameElement}\n */\nexport function getParentWindowFrameElement(node, topWin) {\n  const childWin = (node.ownerDocument || node).defaultView;\n  if (childWin && childWin != topWin && getTopWindow(childWin) == topWin) {\n    try {\n      return /** @type {?HTMLIFrameElement} */ (childWin.frameElement);\n    } catch (e) {\n      // Ignore the error.\n    }\n  }\n  return null;\n}\n\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc}\n */\nexport function getAmpdoc(nodeOrDoc) {\n  if (nodeOrDoc.nodeType) {\n    const win = toWin(/** @type {!Document} */ (\n      nodeOrDoc.ownerDocument || nodeOrDoc).defaultView);\n    return getAmpdocService(win).getAmpDoc(/** @type {!Node} */ (nodeOrDoc));\n  }\n  return /** @type {!./service/ampdoc-impl.AmpDoc} */ (nodeOrDoc);\n}\n\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc|!Window}\n */\nfunction getAmpdocServiceHolder(nodeOrDoc) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  return ampdoc.isSingleDoc() ? ampdoc.win : ampdoc;\n}\n\n\n/**\n * This is essentially a duplicate of `ampdoc.js`, but necessary to avoid\n * circular dependencies.\n * @param {!Window} win\n * @return {!./service/ampdoc-impl.AmpDocService}\n */\nfunction getAmpdocService(win) {\n  return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n    getService(win, 'ampdoc'));\n}\n\n\n/**\n * Get service `id` from `holder`. Assumes the service\n * has already been registered.\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {Object}\n * @template T\n */\nfunction getServiceInternal(holder, id) {\n  dev().assert(isServiceRegistered(holder, id),\n      `Expected service ${id} to be registered`);\n  const services = getServices(holder);\n  const s = services[id];\n  if (!s.obj) {\n    dev().assert(s.ctor, `Service ${id} registered without ctor nor impl.`);\n    dev().assert(s.context, `Service ${id} registered without context.`);\n    s.obj = new s.ctor(s.context);\n    dev().assert(s.obj, `Service ${id} constructed to null.`);\n    s.ctor = null;\n    s.context = null;\n    // The service may have been requested already, in which case we have a\n    // pending promise we need to fulfill.\n    if (s.resolve) {\n      s.resolve(s.obj);\n    }\n  }\n  return s.obj;\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {!Window|!./service/ampdoc-impl.AmpDoc} context Win or AmpDoc.\n * @param {string} id of the service.\n * @param {?function(new:Object, !Window)|?function(new:Object, !./service/ampdoc-impl.AmpDoc)} ctor Constructor function to new the service. Called with context.\n */\nfunction registerServiceInternal(holder, context, id, ctor) {\n  const services = getServices(holder);\n  let s = services[id];\n\n  if (!s) {\n    s = services[id] = {\n      obj: null,\n      promise: null,\n      resolve: null,\n      context: null,\n      ctor: null,\n    };\n  }\n\n  if (s.ctor || s.obj) {\n    // Service already registered.\n    return;\n  }\n\n  s.ctor = ctor;\n  s.context = context;\n\n  // The service may have been requested already, in which case there is a\n  // pending promise that needs to fulfilled.\n  if (s.resolve) {\n    // getServiceInternal will resolve the promise.\n    getServiceInternal(holder, id);\n  }\n}\n\n/**\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nfunction getServicePromiseInternal(holder, id) {\n  const cached = getServicePromiseOrNullInternal(holder, id);\n  if (cached) {\n    return cached;\n  }\n  // Service is not registered.\n\n  // TODO(@cramforce): Add a check that if the element is eventually registered\n  // that the service is actually provided and this promise resolves.\n  const deferred = new Deferred();\n  const {promise, resolve} = deferred;\n\n  const services = getServices(holder);\n  services[id] = {\n    obj: null,\n    promise,\n    resolve,\n    context: null,\n    ctor: null,\n  };\n  return promise;\n}\n\n\n/**\n * Returns a promise for service `id` if the service has been registered\n * on `holder`.\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {?Promise<!Object>}\n */\nfunction getServicePromiseOrNullInternal(holder, id) {\n  const services = getServices(holder);\n  const s = services[id];\n  if (s) {\n    if (s.promise) {\n      return s.promise;\n    } else {\n      // Instantiate service if not already instantiated.\n      getServiceInternal(holder, id);\n      return s.promise = Promise.resolve(/** @type {!Object} */ (s.obj));\n    }\n  }\n  return null;\n}\n\n\n/**\n * Returns the object that holds the services registered in a holder.\n * @param {!Object} holder\n * @return {!Object<string,!ServiceHolderDef>}\n */\nfunction getServices(holder) {\n  let {services} = holder;\n  if (!services) {\n    services = holder.services = {};\n  }\n  return services;\n}\n\n\n/**\n * Whether the specified service implements `Disposable` interface.\n * @param {!Object} service\n * @return {boolean}\n */\nexport function isDisposable(service) {\n  return typeof service.dispose == 'function';\n}\n\n\n/**\n * Asserts that the specified service implements `Disposable` interface and\n * typecasts the instance to `Disposable`.\n * @param {!Object} service\n * @return {!Disposable}\n */\nexport function assertDisposable(service) {\n  dev().assert(isDisposable(service), 'required to implement Disposable');\n  return /** @type {!Disposable} */ (service);\n}\n\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * ampdoc scope.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n */\nexport function disposeServicesForDoc(ampdoc) {\n  disposeServicesInternal(ampdoc);\n}\n\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * embed scope.\n * @param {!Window} embedWin\n */\nexport function disposeServicesForEmbed(embedWin) {\n  disposeServicesInternal(embedWin);\n}\n\n\n/**\n * @param {!Object} holder Object holding the service instances.\n */\nfunction disposeServicesInternal(holder) {\n  // TODO(dvoytenko): Consider marking holder as destroyed for later-arriving\n  // service to be canceled automatically.\n  const services = getServices(holder);\n  for (const id in services) {\n    if (!Object.prototype.hasOwnProperty.call(services, id)) {\n      continue;\n    }\n    const serviceHolder = services[id];\n    if (serviceHolder.obj) {\n      disposeServiceInternal(id, serviceHolder.obj);\n    } else if (serviceHolder.promise) {\n      serviceHolder.promise.then(\n          instance => disposeServiceInternal(id, instance));\n    }\n  }\n}\n\n\n/**\n * @param {string} id\n * @param {!Object} service\n */\nfunction disposeServiceInternal(id, service) {\n  if (!isDisposable(service)) {\n    return;\n  }\n  try {\n    assertDisposable(service).dispose();\n  } catch (e) {\n    // Ensure that a failure to dispose a service does not disrupt other\n    // services.\n    dev().error('SERVICE', 'failed to dispose service', id, e);\n  }\n}\n\n\n/**\n * Whether the specified service implements `EmbeddableService` interface.\n * @param {!Object} service\n * @return {boolean}\n */\nexport function isEmbeddable(service) {\n  return typeof service.adoptEmbedWindow == 'function';\n}\n\n\n/**\n * Adopts an embeddable (implements `EmbeddableService` interface) service\n * in embed scope.\n * @param {!Window} embedWin\n * @param {string} serviceId\n */\nexport function adoptServiceForEmbed(embedWin, serviceId) {\n  const adopted = adoptServiceForEmbedIfEmbeddable(embedWin, serviceId);\n  dev().assert(adopted, `Service ${serviceId} not found on parent ` +\n      'or doesn\\'t implement EmbeddableService.');\n}\n\n\n/**\n * Adopts an embeddable (implements `EmbeddableService` interface) service\n * in embed scope.\n * @param {!Window} embedWin\n * @param {string} serviceId\n * @return {boolean}\n */\nexport function adoptServiceForEmbedIfEmbeddable(embedWin, serviceId) {\n  const frameElement = /** @type {!Node} */ (dev().assert(\n      embedWin.frameElement,\n      'frameElement not found for embed'));\n  const ampdoc = getAmpdoc(frameElement);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  if (!isServiceRegistered(holder, serviceId)) {\n    return false;\n  }\n  const service = getServiceForDocDeprecated(frameElement, serviceId);\n  if (!isEmbeddable(service)) {\n    return false;\n  }\n  service.adoptEmbedWindow(embedWin);\n  return true;\n}\n\n\n/**\n * Resets a single service, so it gets recreated on next getService invocation.\n * @param {!Object} holder\n * @param {string} id of the service.\n */\nexport function resetServiceForTesting(holder, id) {\n  if (holder.services) {\n    holder.services[id] = null;\n  }\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {boolean}\n */\nfunction isServiceRegistered(holder, id) {\n  const service = holder.services && holder.services[id];\n  // All registered services must have an implementation or a constructor.\n  return !!(service && (service.ctor || service.obj));\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getAmpdoc,\n  getExistingServiceForDocInEmbedScope,\n  getExistingServiceOrNull,\n  getService,\n  getServiceForDoc,\n  getServiceForDocDeprecated,\n  getServicePromiseForDoc,\n} from './service';\nimport {\n  getElementServiceForDoc,\n  getElementServiceIfAvailable,\n  getElementServiceIfAvailableForDoc,\n  getElementServiceIfAvailableForDocInEmbedScope,\n} from './element-service';\n\n/** @typedef {!../extensions/amp-subscriptions/0.1/amp-subscriptions.SubscriptionService} */\nexport let SubscriptionService;\n\nexport class Services {\n  /**\n   * Hint: Add extensions folder path to compile.js with\n   * warnings cannot find modules.\n   */\n\n  /**\n   * Returns a promise for the Access service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'access', 'amp-access')));\n  }\n\n  /**\n   * Returns a promise for the Access service or a promise for null if the\n   * service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc, 'access',\n          'amp-access')));\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!SubscriptionService>}\n   */\n  static subscriptionsServiceForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!SubscriptionService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'subscriptions',\n          'amp-subscriptions')));\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?SubscriptionService>}\n   */\n  static subscriptionsServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?SubscriptionService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc, 'subscriptions',\n          'amp-subscriptions')));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/action-impl.ActionService}\n   */\n  static actionServiceForDoc(nodeOrDoc) {\n    return /** @type {!./service/action-impl.ActionService} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'action', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!Activity>}\n   */\n  static activityForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!Activity>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'activity', 'amp-analytics'));\n  }\n\n  /**\n   * Returns the global instance of the `AmpDocService` service that can be\n   * used to resolve an ampdoc for any node: either in the single-doc or\n   * shadow-doc environment.\n   * @param {!Window} window\n   * @return {!./service/ampdoc-impl.AmpDocService}\n   */\n  static ampdocServiceFor(window) {\n    return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n      getService(window, 'ampdoc'));\n  }\n\n  /**\n   * Returns the AmpDoc for the specified context node.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/ampdoc-impl.AmpDoc}\n   */\n  static ampdoc(elementOrAmpDoc) {\n    return getAmpdoc(elementOrAmpDoc);\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @param {boolean=} loadAnalytics\n   * @return {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDoc(elementOrAmpDoc, loadAnalytics = false) {\n    if (loadAnalytics) {\n      // Get Extensions service and force load analytics extension.\n      const ampdoc = getAmpdoc(elementOrAmpDoc);\n      Services.extensionsFor(ampdoc.win)./*OK*/installExtensionForDoc(\n          ampdoc, 'amp-analytics');\n    }\n    return /** @type {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'amp-analytics-instrumentation',\n          'amp-analytics'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc,\n          'amp-analytics-instrumentation', 'amp-analytics'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/batched-xhr-impl.BatchedXhr}\n   */\n  static batchedXhrFor(window) {\n    return /** @type {!./service/batched-xhr-impl.BatchedXhr} */ (\n      getService(window, 'batched-xhr'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>}\n   */\n  static bindForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>} */ (\n      getElementServiceIfAvailableForDocInEmbedScope(\n          elementOrAmpDoc, 'bind', 'amp-bind'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/cid-impl.Cid>}\n   */\n  static cidForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/cid-impl.Cid>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'cid'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/navigation.Navigation}\n   */\n  static navigationForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/navigation.Navigation} */ (\n      getServiceForDoc(elementOrAmpDoc, 'navigation'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/crypto-impl.Crypto}\n   */\n  static cryptoFor(window) {\n    return (/** @type {!./service/crypto-impl.Crypto} */ (\n      getService(window, 'crypto')));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/document-info-impl.DocumentInfoDef} Info about the doc\n   */\n  static documentInfoForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/document-info-impl.DocInfo} */ (\n      getServiceForDoc(elementOrAmpDoc, 'documentInfo')).get();\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/document-state.DocumentState}\n   */\n  static documentStateFor(window) {\n    return getService(window, 'documentState');\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/extensions-impl.Extensions}\n   */\n  static extensionsFor(window) {\n    return /** @type {!./service/extensions-impl.Extensions} */ (\n      getService(window, 'extensions'));\n  }\n\n  /**\n   * Returns service implemented in service/history-impl.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/history-impl.History}\n   */\n  static historyForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/history-impl.History} */ (\n      getServiceForDoc(elementOrAmpDoc, 'history'));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!./input.Input}\n   */\n  static inputFor(win) {\n    return getService(win, 'input');\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/layers-impl.LayoutLayers}\n   */\n  static layersForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/layers-impl.LayoutLayers} */ (\n      getServiceForDoc(elementOrAmpDoc, 'layers'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceFor(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getService(window, 'performance'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceForOrNull(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getExistingServiceOrNull(window, 'performance'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/platform-impl.Platform}\n   */\n  static platformFor(window) {\n    return /** @type {!./service/platform-impl.Platform} */ (\n      getService(window, 'platform'));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Resources is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/resources-impl.Resources}\n   */\n  static resourcesForDoc(nodeOrDoc) {\n    return /** @type {!./service/resources-impl.Resources} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'resources'));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?{incomingFragment: string, outgoingFragment: string}>}\n   */\n  static shareTrackingForOrNull(win) {\n    return (/** @type {!Promise<?{incomingFragment: string, outgoingFragment: string}>} */ (\n      getElementServiceIfAvailable(win, 'share-tracking',\n          'amp-share-tracking', true)));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/variable-service.StoryVariableDef>}\n   */\n  static storyVariableServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/variable-service.StoryVariableDef>} */\n      (getElementServiceIfAvailable(win, 'story-variable', 'amp-story',\n          true)));\n  }\n\n  /**\n   * Version of the story store service depends on which version of amp-story\n   * the publisher is loading. They all have the same implementation.\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService|?../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService>}\n   */\n  static storyStoreServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService|?../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService>} */\n      (getElementServiceIfAvailable(win, 'story-store', 'amp-story')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService}\n   */\n  static storyStoreService(win) {\n    return (/** @type {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService} */\n      (getExistingServiceOrNull(win, 'story-store')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService}\n   */\n  static storyRequestService(win) {\n    return (/** @type {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService} */\n      (getExistingServiceOrNull(win, 'story-request')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!Promise<?../extensions/amp-story/1.0/localization.LocalizationService>}\n   */\n  static localizationServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/localization.LocalizationService>} */\n      (getElementServiceIfAvailable(win, 'localization', 'amp-story', true)));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/1.0/localization.LocalizationService}\n   */\n  static localizationService(win) {\n    return getService(win, 'localization');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService}\n   */\n  static storyStoreServiceV01(win) {\n    return getService(win, 'story-store');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/amp-story-request-service.AmpStoryRequestService}\n   */\n  static storyRequestServiceV01(win) {\n    return getService(win, 'story-request-v01');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!Promise<?../extensions/amp-story/0.1/localization.LocalizationService>}\n   */\n  static localizationServiceForOrNullV01(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/0.1/localization.LocalizationService>} */\n      (getElementServiceIfAvailable(win, 'localization-v01', 'amp-story',\n          true)));\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/localization.LocalizationService}\n   */\n  static localizationServiceV01(win) {\n    return getService(win, 'localization-v01');\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-viewer-integration/0.1/variable-service.ViewerIntegrationVariableDef>}\n   */\n  static viewerIntegrationVariableServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-viewer-integration/0.1/variable-service.ViewerIntegrationVariableDef>} */\n      (getElementServiceIfAvailable(win, 'viewer-integration-variable',\n          'amp-viewer-integration', true)));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>}\n   */\n  static webAnimationServiceFor(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>} */\n      (getElementServiceForDoc(\n          elementOrAmpDoc, 'web-animation', 'amp-animation')));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/storage-impl.Storage>}\n   */\n  static storageForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/storage-impl.Storage>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'storage'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/template-impl.Templates}\n   */\n  static templatesFor(window) {\n    return /** @type {!./service/template-impl.Templates} */ (\n      getService(window, 'templates'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/timer-impl.Timer}\n   */\n  static timerFor(window) {\n    return /** @type {!./service/timer-impl.Timer} */ (\n      getService(window, 'timer'));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/url-replacements-impl.UrlReplacements}\n   */\n  static urlReplacementsForDoc(nodeOrDoc) {\n    return /** @type {!./service/url-replacements-impl.UrlReplacements} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'url-replace', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>}\n   */\n  static userNotificationManagerForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>} */\n      (getElementServiceForDoc(elementOrAmpDoc, 'userNotificationManager',\n          'amp-user-notification')));\n  }\n\n  /**\n   * Returns a promise for the consentPolicy Service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>}\n   */\n  static consentPolicyServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>} */\n      (getElementServiceIfAvailableForDoc(elementOrAmpDoc,\n          'consentPolicyManager', 'amp-consent')));\n  }\n\n  /**\n   * Returns a promise for the geo service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>}\n   */\n  static geoForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>} */ (\n      getElementServiceIfAvailableForDoc(\n          elementOrAmpDoc, 'geo', 'amp-geo', true));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/url-impl.Url}\n   */\n  static urlForDoc(nodeOrDoc) {\n    return /** @type {!./service/url-impl.Url} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'url', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * Returns a promise for the experiment variants or a promise for null if it\n   * is not available on the current page.\n   * @param {!Window} win\n   * @return {!Promise<?Object<string>>}\n   */\n  static variantForOrNull(win) {\n    return /** @type {!Promise<?Object<string>>} */ (\n      getElementServiceIfAvailable(win, 'variant', 'amp-experiment', true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/video-service-interface.VideoServiceInterface}\n   */\n  static videoManagerForDoc(elementOrAmpDoc) {\n    return (\n      /** @type {!./service/video-service-interface.VideoServiceInterface} */ (\n        getServiceForDoc(elementOrAmpDoc, 'video-manager')));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Viewer is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/viewer-impl.Viewer}\n   */\n  static viewerForDoc(nodeOrDoc) {\n    return /** @type {!./service/viewer-impl.Viewer} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'viewer'));\n  }\n\n  /**\n   * Returns promise for the viewer. This is an unusual case and necessary only\n   * for services that need reference to the viewer before it has been\n   * initialized. Most of the code, however, just should use `viewerForDoc`.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/viewer-impl.Viewer>}\n   */\n  static viewerPromiseForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/viewer-impl.Viewer>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'viewer'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/vsync-impl.Vsync}\n   */\n  static vsyncFor(window) {\n    return /** @type {!./service/vsync-impl.Vsync} */ (\n      getService(window, 'vsync'));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Viewport is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/viewport/viewport-impl.Viewport}\n   */\n  static viewportForDoc(nodeOrDoc) {\n    return /** @type {!./service/viewport/viewport-impl.Viewport} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'viewport'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/xhr-impl.Xhr}\n   */\n  static xhrFor(window) {\n    return /** @type {!./service/xhr-impl.Xhr} */ (getService(window, 'xhr'));\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from './log';\nimport {map} from './utils/object.js';\n\nlet container;\n\n/**\n * Creates the html helper for the doc.\n *\n * @param {!Element|!Document} nodeOrDoc\n * @return {function(!Array<string>):!Element}\n */\nexport function htmlFor(nodeOrDoc) {\n  const doc = nodeOrDoc.ownerDocument || nodeOrDoc;\n  if (!container || container.ownerDocument !== doc) {\n    container = doc.createElement('div');\n  }\n\n  return html;\n}\n\n/**\n * A tagged template literal helper to generate static DOM trees.\n * This must be used as a tagged template, ie\n *\n * ```\n * const div = html`<div><span></span></div>`;\n * ```\n *\n * Only the root element and its subtree will be returned. DO NOT use this to\n * render subtree's with dynamic content, it WILL result in an error!\n *\n * @param {!Array<string>} strings\n * @return {!Element}\n */\nfunction html(strings) {\n  dev().assert(strings.length === 1, 'Improper html template tag usage.');\n  container./*OK*/innerHTML = strings[0];\n\n  const el = container.firstElementChild;\n  dev().assert(el, 'No elements in template');\n  dev().assert(!el.nextElementSibling, 'Too many root elements in template');\n\n  // Clear to free memory.\n  container./*OK*/innerHTML = '';\n\n  return el;\n}\n\n/**\n * Queries an element for all elements with a \"ref\" attribute, removing\n * the attribute afterwards.\n * Returns a named map of all ref elements.\n *\n * @param {!Element} root\n * @return {!Object<string, !Element>}\n */\nexport function htmlRefs(root) {\n  const elements = root.querySelectorAll('[ref]');\n  const refs = map();\n\n  for (let i = 0; i < elements.length; i++) {\n    const element = elements[i];\n    const ref = dev().assert(element.getAttribute('ref'), 'Empty ref attr');\n    element.removeAttribute('ref');\n    dev().assert(refs[ref] === undefined, 'Duplicate ref');\n    refs[ref] = element;\n  }\n\n  return refs;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {string} _match\n * @param {string} character\n * @return {string}\n */\nfunction toUpperCase(_match, character) {\n  return character.toUpperCase();\n}\n\n/**\n * @param {string} match\n * @return {string}\n */\nfunction prependDashAndToLowerCase(match) {\n  return '-' + match.toLowerCase();\n}\n\n/**\n * @param {string} name Attribute name containing dashes.\n * @return {string} Dashes removed and successive character sent to upper case.\n * visibleForTesting\n */\nexport function dashToCamelCase(name) {\n  return name.replace(/-([a-z])/g, toUpperCase);\n}\n\n/**\n * Converts a string that is in camelCase to one that is in dash-case.\n *\n * @param {string} string The string to convert.\n * @return {string} The string in dash-case.\n */\nexport function camelCaseToDash(string) {\n  return string.replace(/(?!^)[A-Z]/g, prependDashAndToLowerCase);\n}\n\n/**\n * @param {string} name Attribute name with dashes\n * @return {string} Dashes replaced by underlines.\n */\nexport function dashToUnderline(name) {\n  return name.replace('-', '_');\n}\n\n/**\n * Polyfill for String.prototype.endsWith.\n * @param {string} string\n * @param {string} suffix\n * @return {boolean}\n */\nexport function endsWith(string, suffix) {\n  const index = string.length - suffix.length;\n  return index >= 0 && string.indexOf(suffix, index) == index;\n}\n\n/**\n * Polyfill for String.prototype.startsWith.\n * @param {string} string\n * @param {string} prefix\n * @return {boolean}\n */\nexport function startsWith(string, prefix) {\n  if (prefix.length > string.length) {\n    return false;\n  }\n  return string.lastIndexOf(prefix, 0) == 0;\n}\n\n/**\n * Expands placeholders in a given template string with values.\n *\n * Placeholders use ${key-name} syntax and are replaced with the value\n * returned from the given getter function.\n *\n * @param {string} template The template string to expand.\n * @param {function(string):*} getter Function used to retrieve a value for a\n *   placeholder. Returns values will be coerced into strings.\n * @param {number=} opt_maxIterations Number of times to expand the template.\n *   Defaults to 1, but should be set to a larger value your placeholder tokens\n *   can be expanded to other placeholder tokens. Take caution with large values\n *   as recursively expanding a string can be exponentially expensive.\n */\nexport function expandTemplate(template, getter, opt_maxIterations) {\n  const maxIterations = opt_maxIterations || 1;\n  for (let i = 0; i < maxIterations; i++) {\n    let matches = 0;\n    template = template.replace(/\\${([^}]*)}/g, (_a, b) => {\n      matches++;\n      return getter(b);\n    });\n    if (!matches) {\n      break;\n    }\n  }\n  return template;\n}\n\n/**\n * Hash function djb2a\n * This is intended to be a simple, fast hashing function using minimal code.\n * It does *not* have good cryptographic properties.\n * @param {string} str\n * @return {string} 32-bit unsigned hash of the string\n */\nexport function stringHash32(str) {\n  const {length} = str;\n  let hash = 5381;\n  for (let i = 0; i < length; i++) {\n    hash = hash * 33 ^ str.charCodeAt(i);\n  }\n  // Convert from 32-bit signed to unsigned.\n  return String(hash >>> 0);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Note: loaded by 3p system. Cannot rely on babel polyfills.\nimport {map} from './utils/object.js';\nimport {startsWith} from './string';\n\n\n/** @type {Object<string, string>} */\nlet propertyNameCache;\n\n/** @const {!Array<string>} */\nconst vendorPrefixes = ['Webkit', 'webkit', 'Moz', 'moz', 'ms', 'O', 'o'];\n\n\n/**\n * @export\n * @param {string} camelCase camel cased string\n * @return {string} title cased string\n */\nexport function camelCaseToTitleCase(camelCase) {\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n}\n\n/**\n * Checks the style if a prefixed version of a property exists and returns\n * it or returns an empty string.\n * @private\n * @param {!Object} style\n * @param {string} titleCase the title case version of a css property name\n * @return {string} the prefixed property name or null.\n */\nfunction getVendorJsPropertyName_(style, titleCase) {\n  for (let i = 0; i < vendorPrefixes.length; i++) {\n    const propertyName = vendorPrefixes[i] + titleCase;\n    if (style[propertyName] !== undefined) {\n      return propertyName;\n    }\n  }\n  return '';\n}\n\n/**\n * Returns the possibly prefixed JavaScript property name of a style property\n * (ex. WebkitTransitionDuration) given a camelCase'd version of the property\n * (ex. transitionDuration).\n * @export\n * @param {!Object} style\n * @param {string} camelCase the camel cased version of a css property name\n * @param {boolean=} opt_bypassCache bypass the memoized cache of property\n *   mapping\n * @return {string}\n */\nexport function getVendorJsPropertyName(style, camelCase, opt_bypassCache) {\n  if (startsWith(camelCase, '--')) {\n    // CSS vars are returned as is.\n    return camelCase;\n  }\n  if (!propertyNameCache) {\n    propertyNameCache = map();\n  }\n  let propertyName = propertyNameCache[camelCase];\n  if (!propertyName || opt_bypassCache) {\n    propertyName = camelCase;\n    if (style[camelCase] === undefined) {\n      const titleCase = camelCaseToTitleCase(camelCase);\n      const prefixedPropertyName = getVendorJsPropertyName_(style, titleCase);\n\n      if (style[prefixedPropertyName] !== undefined) {\n        propertyName = prefixedPropertyName;\n      }\n    }\n    if (!opt_bypassCache) {\n      propertyNameCache[camelCase] = propertyName;\n    }\n  }\n  return propertyName;\n}\n\n\n/**\n * Sets the CSS styles of the specified element with !important. The styles\n * are specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setImportantStyles(element, styles) {\n  for (const k in styles) {\n    element.style.setProperty(\n        getVendorJsPropertyName(styles, k), styles[k].toString(), 'important');\n  }\n}\n\n\n/**\n * Sets the CSS style of the specified element with optional units, e.g. \"px\".\n * @param {?Element} element\n * @param {string} property\n * @param {*} value\n * @param {string=} opt_units\n * @param {boolean=} opt_bypassCache\n */\nexport function setStyle(element, property, value, opt_units, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (propertyName) {\n    element.style[propertyName] =\n      /** @type {string} */ (opt_units ? value + opt_units : value);\n  }\n}\n\n\n/**\n * Returns the value of the CSS style of the specified element.\n * @param {!Element} element\n * @param {string} property\n * @param {boolean=} opt_bypassCache\n * @return {*}\n */\nexport function getStyle(element, property, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (!propertyName) {\n    return undefined;\n  }\n  return element.style[propertyName];\n}\n\n\n/**\n * Sets the CSS styles of the specified element. The styles\n * a specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setStyles(element, styles) {\n  for (const k in styles) {\n    setStyle(element, k, styles[k]);\n  }\n}\n\n\n/**\n * Shows or hides the specified element.\n * @param {!Element} element\n * @param {boolean=} opt_display\n */\nexport function toggle(element, opt_display) {\n  if (opt_display === undefined) {\n    opt_display = getStyle(element, 'display') == 'none';\n  }\n  setStyle(element, 'display', opt_display ? '' : 'none');\n}\n\n\n/**\n * Returns a pixel value.\n * @param {number} value\n * @return {string}\n */\nexport function px(value) {\n  return `${value}px`;\n}\n\n/**\n * Returns a degree value.\n * @param {number} value\n * @return {string}\n */\nexport function deg(value) {\n  return `${value}deg`;\n}\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function translateX(value) {\n  if (typeof value == 'string') {\n    return `translateX(${value})`;\n  }\n  return `translateX(${px(value)})`;\n}\n\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} x\n * @param {(number|string)=} opt_y\n * @return {string}\n */\nexport function translate(x, opt_y) {\n  if (typeof x == 'number') {\n    x = px(x);\n  }\n  if (opt_y === undefined) {\n    return `translate(${x})`;\n  }\n  if (typeof opt_y == 'number') {\n    opt_y = px(opt_y);\n  }\n  return `translate(${x}, ${opt_y})`;\n}\n\n\n/**\n * Returns a \"scale\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function scale(value) {\n  return `scale(${value})`;\n}\n\n/**\n * Returns a \"rotate\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function rotate(value) {\n  if (typeof value == 'number') {\n    value = deg(value);\n  }\n  return `rotate(${value})`;\n}\n\n/**\n * Remove alpha value from a rgba color value.\n * Return the new color property with alpha equals if has the alpha value.\n * Caller needs to make sure the input color value is a valid rgba/rgb value\n * @param {string} rgbaColor\n * @return {string}\n */\nexport function removeAlphaFromColor(rgbaColor) {\n  return rgbaColor.replace(\n      /\\(([^,]+),([^,]+),([^,)]+),[^)]+\\)/g, '($1,$2,$3, 1)');\n}\n\n/**\n * Gets the computed style of the element. The helper is necessary to enforce\n * the possible `null` value returned by a buggy Firefox.\n *\n * @param {!Window} win\n * @param {!Element} el\n * @return {!Object<string, string>}\n */\nexport function computedStyle(win, el) {\n  const style = /** @type {?CSSStyleDeclaration} */(win.getComputedStyle(el));\n  return /** @type {!Object<string, string>} */(style) || map();\n}\n\n\n/**\n * Resets styles that were set dynamically (i.e. inline)\n * @param {!Element} element\n * @param {!Array<string>} properties\n */\nexport function resetStyles(element, properties) {\n  const styleObj = {};\n  properties.forEach(prop => {\n    styleObj[prop] = null;\n  });\n  setStyles(element, styleObj);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Absolute time in milliseconds.\n * @typedef {number}\n */\nexport let timeDef;\n\n\n/**\n * Number between 0 and 1 that designates normalized time, as in \"from start to\n * end\".\n * @typedef {number}\n */\nexport let normtimeDef;\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as st from './style';\nimport {getCurve} from './curve';\n\n\n\nexport const NOOP = function(unusedTime) {return null;};\n\n\n/**\n * Returns a transition that combines a number of other transitions and\n * invokes them all in parallel.\n * @param {!Array<!TransitionDef>} transitions\n * @return {!TransitionDef<void>}\n */\nexport function all(transitions) {\n  return (time, complete) => {\n    for (let i = 0; i < transitions.length; i++) {\n      const tr = transitions[i];\n      tr(time, complete);\n    }\n  };\n}\n\n\n/**\n * Returns a transition that combines the string result of other string-based\n * transitions such as transform and scale using the given opt_delimiter.\n * @param {!Array<!TransitionDef<string>>} transitions\n * @param {string=} opt_delimiter Defaults to a single whitespace.\n * @return {!TransitionDef<string>}\n */\nexport function concat(transitions, opt_delimiter = ' ') {\n  return (time, complete) => {\n    const results = [];\n    for (let i = 0; i < transitions.length; i++) {\n      const tr = transitions[i];\n      const result = tr(time, complete);\n      if (typeof result == 'string') {\n        results.push(result);\n      }\n    }\n    return results.join(opt_delimiter);\n  };\n}\n\n\n/**\n * Returns the specified transition with the time curved via specified curve\n * function.\n * @param {!TransitionDef<RESULT>} transition\n * @param {!./curve.CurveDef|string} curve\n * @return {!TransitionDef<RESULT>}\n * @template RESULT\n */\nexport function withCurve(transition, curve) {\n  /** @const {?./curve.CurveDef} */\n  const curveFn = getCurve(curve);\n  return (time, complete) => {\n    return transition(complete ? 1 : curveFn(time), complete);\n  };\n}\n\n\n/**\n * A transition that sets the CSS style of the specified element. The styles\n * a specified as a map from CSS property names to transition functions for\n * each of these properties.\n * @param {!Element} element\n * @param {!Object<string, !TransitionDef>} styles\n * @return {!TransitionDef<void>}\n */\nexport function setStyles(element, styles) {\n  return (time, complete) => {\n    for (const k in styles) {\n      st.setStyle(element, k, styles[k](time, complete));\n    }\n  };\n}\n\n\n/**\n * A basic numeric interpolation.\n * @param {number} start\n * @param {number} end\n * @return {!TransitionDef<number>}\n */\nexport function numeric(start, end) {\n  return time => {\n    return start + (end - start) * time;\n  };\n}\n\n\n/**\n * Spring numeric interpolation.\n * @param {number} start\n * @param {number} end\n * @param {number} extended\n * @param {number} threshold\n * @return {!TransitionDef<number>}\n */\nexport function spring(start, end, extended, threshold) {\n  if (end == extended) {\n    return time => {\n      return numeric(start, end)(time);\n    };\n  }\n  return time => {\n    if (time < threshold) {\n      return start + (extended - start) * (time / threshold);\n    }\n    return extended + (end - extended) * ((time - threshold) /\n        (1 - threshold));\n  };\n}\n\n\n/**\n * Adds \"px\" units.\n * @param {!TransitionDef<number>} transition\n * @return {!TransitionDef<string>}\n */\nexport function px(transition) {\n  return time => {\n    return transition(time) + 'px';\n  };\n}\n\n\n/**\n * A transition for \"translateX\" of CSS \"transform\" property.\n * @param {!TransitionDef<number|string>} transition\n * @return {!TransitionDef<string>}\n */\nexport function translateX(transition) {\n  return time => {\n    const res = transition(time);\n    if (typeof res == 'string') {\n      return `translateX(${res})`;\n    }\n    return `translateX(${res}px)`;\n  };\n}\n\n/**\n * A transition for \"translateY\" of CSS \"transform\" property.\n * @param {!TransitionDef<number|string>} transition\n * @return {!TransitionDef<string>}\n */\nexport function translateY(transition) {\n  return time => {\n    const res = transition(time);\n    if (typeof res == 'string') {\n      return `translateY(${res})`;\n    }\n    return `translateY(${res}px)`;\n  };\n}\n\n\n/**\n * A transition for \"translate(x, y)\" of CSS \"transform\" property.\n * @param {!TransitionDef<number|string>} transitionX\n * @param {!TransitionDef<number|string>|undefined} opt_transitionY\n * @return {!TransitionDef<string>}\n */\nexport function translate(transitionX, opt_transitionY) {\n  return time => {\n    let x = transitionX(time);\n    if (typeof x == 'number') {\n      x = st.px(x);\n    }\n    if (!opt_transitionY) {\n      return `translate(${x})`;\n    }\n\n    let y = opt_transitionY(time);\n    if (typeof y == 'number') {\n      y = st.px(y);\n    }\n    return `translate(${x},${y})`;\n  };\n}\n\n\n/**\n * A transition for \"scale\" of CSS \"transform\" property.\n * @param {!TransitionDef<number|string>} transition\n * @return {!TransitionDef<string>}\n */\nexport function scale(transition) {\n  return time => {\n    return `scale(${transition(time)})`;\n  };\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* @const */\nconst toString_ = Object.prototype.toString;\n\n/**\n * Returns the ECMA [[Class]] of a value\n * @param {*} value\n * @return {string}\n */\nfunction toString(value) {\n  return toString_.call(value);\n}\n\n/**\n * Determines if value is actually an Array.\n * @param {*} value\n * @return {boolean}\n */\nexport function isArray(value) {\n  return Array.isArray(value);\n}\n\n/**\n * Converts an array-like object to an array.\n * @param {?IArrayLike<T>|string} arrayLike\n * @return {!Array<T>}\n * @template T\n */\nexport function toArray(arrayLike) {\n  if (!arrayLike) {\n    return [];\n  }\n  const array = new Array(arrayLike.length);\n  for (let i = 0; i < arrayLike.length; i++) {\n    array[i] = arrayLike[i];\n  }\n  return array;\n}\n\n/**\n * Determines if value is actually an Object.\n * @param {*} value\n * @return {boolean}\n */\nexport function isObject(value) {\n  return toString(value) === '[object Object]';\n}\n\n/**\n * Determines if value is of number type and finite.\n * NaN and Infinity are not considered a finite number.\n * String numbers are not considered numbers.\n * @param {*} value\n * @return {boolean}\n */\nexport function isFiniteNumber(value) {\n  return (typeof value === 'number' && isFinite(value));\n}\n\n/**\n * Checks whether `s` is a valid value of `enumObj`.\n *\n * @param {!Object<T>} enumObj\n * @param {T} s\n * @return {boolean}\n * @template T\n */\nexport function isEnumValue(enumObj, s) {\n  for (const k in enumObj) {\n    if (enumObj[k] === s) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Externs declare that access `defaultView` from `document` or\n * `ownerDocument` is of type `(Window|null)` but most of our parameter types\n * assume that it is never null. This is OK in practice as we ever only get\n * null on disconnected documents or old IE.\n * This helper function casts it into just a simple Window return type.\n *\n * @param {!Window|null} winOrNull\n * @return {!Window}\n */\nexport function toWin(winOrNull) {\n  return /** @type {!Window} */ (winOrNull);\n}\n\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {tryDecodeUriComponent_} from './url-try-decode-uri-component';\n\nconst regex = /(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * DO NOT import the function from this file. Instead, import parseQueryString\n * from `src/url.js`.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString_(queryString) {\n  const params = /** @type {!JsonObject} */ (Object.create(null));\n  if (!queryString) {\n    return params;\n  }\n\n  let match;\n  while ((match = regex.exec(queryString))) {\n    const name = tryDecodeUriComponent_(match[1], match[1]);\n    const value = match[2] ? tryDecodeUriComponent_(match[2], match[2]) : '';\n    params[name] = value;\n  }\n  return params;\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * DO NOT import the function from this file. Instead, import\n * tryDecodeUriComponent from `src/url.js`.\n *\n * @param {string} component\n * @param {string=} fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent_(component, fallback = '') {\n  try {\n    return decodeURIComponent(component);\n  } catch (e) {\n    return fallback;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {LruCache} from './utils/lru-cache';\nimport {dict} from './utils/object';\nimport {endsWith, startsWith} from './string';\nimport {getMode} from './mode';\nimport {isArray} from './types';\nimport {parseQueryString_} from './url-parse-query-string';\nimport {tryDecodeUriComponent_} from './url-try-decode-uri-component';\nimport {urls} from './config';\nimport {user} from './log';\n\n/**\n * @type {!JsonObject}\n */\nconst SERVING_TYPE_PREFIX = dict({\n  // No viewer\n  'c': true,\n  // In viewer\n  'v': true,\n  // Ad landing page\n  'a': true,\n  // Ad\n  'ad': true,\n});\n\n/**\n * Cached a-tag to avoid memory allocation during URL parsing.\n * @type {HTMLAnchorElement}\n */\nlet a;\n\n/**\n * We cached all parsed URLs. As of now there are no use cases\n * of AMP docs that would ever parse an actual large number of URLs,\n * but we often parse the same one over and over again.\n * @type {LruCache}\n */\nlet cache;\n\n/** @private @const Matches amp_js_* parameters in query string. */\nconst AMP_JS_PARAMS_REGEX = /[?&]amp_js[^&]*/;\n\n/** @private @const Matches amp_gsa parameters in query string. */\nconst AMP_GSA_PARAMS_REGEX = /[?&]amp_gsa[^&]*/;\n\n/** @private @const Matches amp_r parameters in query string. */\nconst AMP_R_PARAMS_REGEX = /[?&]amp_r[^&]*/;\n\n/** @private @const Matches usqp parameters from goog experiment in query string. */\nconst GOOGLE_EXPERIMENT_PARAMS_REGEX = /[?&]usqp[^&]*/;\n\nconst INVALID_PROTOCOLS = [\n  /*eslint no-script-url: 0*/ 'javascript:',\n  /*eslint no-script-url: 0*/ 'data:',\n  /*eslint no-script-url: 0*/ 'vbscript:',\n];\n\n/** @const {string} */\nexport const SOURCE_ORIGIN_PARAM = '__amp_source_origin';\n\n/**\n * Returns the correct origin for a given window.\n * @param {!Window} win\n * @return {string} origin\n */\nexport function getWinOrigin(win) {\n  return win.origin || parseUrlDeprecated(win.location.href).origin;\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {string} url\n * @param {boolean=} opt_nocache\n * @return {!Location}\n */\nexport function parseUrlDeprecated(url, opt_nocache) {\n  if (!a) {\n    a = /** @type {!HTMLAnchorElement} */ (self.document.createElement('a'));\n    cache = self.UrlCache || (self.UrlCache = new LruCache(100));\n  }\n\n  return parseUrlWithA(a, url, opt_nocache ? null : cache);\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {!HTMLAnchorElement} a\n * @param {string} url\n * @param {LruCache=} opt_cache\n * @return {!Location}\n * @restricted\n */\nexport function parseUrlWithA(a, url, opt_cache) {\n  if (opt_cache && opt_cache.has(url)) {\n    return opt_cache.get(url);\n  }\n\n  a.href = url;\n\n  // IE11 doesn't provide full URL components when parsing relative URLs.\n  // Assigning to itself again does the trick #3449.\n  if (!a.protocol) {\n    a.href = a.href;\n  }\n\n  const info = /** @type {!Location} */({\n    href: a.href,\n    protocol: a.protocol,\n    host: a.host,\n    hostname: a.hostname,\n    port: a.port == '0' ? '' : a.port,\n    pathname: a.pathname,\n    search: a.search,\n    hash: a.hash,\n    origin: null, // Set below.\n  });\n\n  // Some IE11 specific polyfills.\n  // 1) IE11 strips out the leading '/' in the pathname.\n  if (info.pathname[0] !== '/') {\n    info.pathname = '/' + info.pathname;\n  }\n\n  // 2) For URLs with implicit ports, IE11 parses to default ports while\n  // other browsers leave the port field empty.\n  if ((info.protocol == 'http:' && info.port == 80)\n      || (info.protocol == 'https:' && info.port == 443)) {\n    info.port = '';\n    info.host = info.hostname;\n  }\n\n  // For data URI a.origin is equal to the string 'null' which is not useful.\n  // We instead return the actual origin which is the full URL.\n  if (a.origin && a.origin != 'null') {\n    info.origin = a.origin;\n  } else if (info.protocol == 'data:' || !info.host) {\n    info.origin = info.href;\n  } else {\n    info.origin = info.protocol + '//' + info.host;\n  }\n\n  // Freeze during testing to avoid accidental mutation.\n  const frozen = (getMode().test && Object.freeze) ? Object.freeze(info) : info;\n\n  if (opt_cache) {\n    opt_cache.put(url, frozen);\n  }\n\n  return frozen;\n}\n\n/**\n * Appends the string just before the fragment part (or optionally\n * to the front of the query string) of the URL.\n * @param {string} url\n * @param {string} paramString\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function appendEncodedParamStringToUrl(url, paramString,\n  opt_addToFront) {\n  if (!paramString) {\n    return url;\n  }\n  const mainAndFragment = url.split('#', 2);\n  const mainAndQuery = mainAndFragment[0].split('?', 2);\n\n  let newUrl = mainAndQuery[0] + (\n    mainAndQuery[1]\n      ? (opt_addToFront\n        ? `?${paramString}&${mainAndQuery[1]}`\n        : `?${mainAndQuery[1]}&${paramString}`)\n      : `?${paramString}`);\n  newUrl += mainAndFragment[1] ? `#${mainAndFragment[1]}` : '';\n  return newUrl;\n}\n/**\n * Appends a query string field and value to a url. `key` and `value`\n * will be ran through `encodeURIComponent` before appending.\n * @param {string} url\n * @param {string} key\n * @param {string} value\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function addParamToUrl(url, key, value, opt_addToFront) {\n  const field = `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\n  return appendEncodedParamStringToUrl(url, field, opt_addToFront);\n}\n\n/**\n * Appends query string fields and values to a url. The `params` objects'\n * `key`s and `value`s will be transformed into query string keys/values.\n * @param {string} url\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function addParamsToUrl(url, params) {\n  return appendEncodedParamStringToUrl(url, serializeQueryString(params));\n}\n\n/**\n * Serializes the passed parameter map into a query string with both keys\n * and values encoded.\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function serializeQueryString(params) {\n  const s = [];\n  for (const k in params) {\n    const v = params[k];\n    if (v == null) {\n      continue;\n    } else if (isArray(v)) {\n      for (let i = 0; i < v.length; i++) {\n        const sv = /** @type {string} */ (v[i]);\n        s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n      }\n    } else {\n      const sv = /** @type {string} */ (v);\n      s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n    }\n  }\n  return s.join('&');\n}\n\n/**\n * Returns `true` if the URL is secure: either HTTPS or localhost (for testing).\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isSecureUrlDeprecated(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return (url.protocol == 'https:' ||\n      url.hostname == 'localhost' ||\n      endsWith(url.hostname, '.localhost'));\n}\n\n/**\n * Asserts that a given url is HTTPS or protocol relative. It's a user-level\n * assert.\n *\n * Provides an exception for localhost.\n *\n * @param {?string|undefined} urlString\n * @param {!Element|string} elementContext Element where the url was found.\n * @param {string=} sourceName Used for error messages.\n * @return {string}\n */\nexport function assertHttpsUrl(\n  urlString, elementContext, sourceName = 'source') {\n  user().assert(urlString != null, '%s %s must be available',\n      elementContext, sourceName);\n  // (erwinm, #4560): type cast necessary until #4560 is fixed.\n  const theUrlString = /** @type {string} */ (urlString);\n  user().assert(isSecureUrlDeprecated(theUrlString) || /^(\\/\\/)/.test(theUrlString),\n      '%s %s must start with ' +\n      '\"https://\" or \"//\" or be relative and served from ' +\n      'either https or from localhost. Invalid value: %s',\n      elementContext, sourceName, theUrlString);\n  return theUrlString;\n}\n\n/**\n * Asserts that a given url is an absolute HTTP or HTTPS URL.\n * @param {string} urlString\n * @return {string}\n */\nexport function assertAbsoluteHttpOrHttpsUrl(urlString) {\n  user().assert(/^https?\\:/i.test(urlString),\n      'URL must start with \"http://\" or \"https://\". Invalid value: %s',\n      urlString);\n  return parseUrlDeprecated(urlString).href;\n}\n\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * This function is implemented in a separate file to avoid a circular\n * dependency.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString(queryString) {\n  return parseQueryString_(queryString);\n}\n\n/**\n * Returns the URL without fragment. If URL doesn't contain fragment, the same\n * string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function removeFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return url;\n  }\n  return url.substring(0, index);\n}\n\n/**\n * Returns the fragment from the URL. If the URL doesn't contain fragment,\n * the empty string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function getFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return '';\n  }\n  return url.substring(index);\n}\n\n/**\n * Returns whether the URL has the origin of a proxy.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isProxyOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.cdnProxyRegex.test(url.origin);\n}\n\n/**\n * For proxy-origin URLs, returns the serving type. Otherwise, returns null.\n * E.g., 'https://amp-com.cdn.ampproject.org/a/s/amp.com/amp_document.html'\n * returns 'a'.\n * @param {string|!Location} url URL of an AMP document.\n * @return {?string}\n */\nexport function getProxyServingType(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  if (!isProxyOrigin(url)) {\n    return null;\n  }\n  const path = url.pathname.split('/', 2);\n  return path[1];\n}\n\n/**\n * Returns whether the URL origin is localhost.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isLocalhostOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.localhostRegex.test(url.origin);\n}\n\n/**\n * Returns whether the URL has valid protocol.\n * Deep link protocol is valid, but not javascript etc.\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isProtocolValid(url) {\n  if (!url) {\n    return true;\n  }\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return !INVALID_PROTOCOLS.includes(url.protocol);\n}\n\n/**\n * Returns a URL without AMP JS parameters.\n * @param {string} url\n * @return {string}\n */\nexport function removeAmpJsParamsFromUrl(url) {\n  const parsed = parseUrlDeprecated(url);\n  const search = removeAmpJsParamsFromSearch(parsed.search);\n  return parsed.origin + parsed.pathname + search + parsed.hash;\n\n}\n\n/**\n * Returns a URL without a query string.\n * @param {string} url\n * @return {string}\n */\nexport function removeSearch(url) {\n  const index = url.indexOf('?');\n  if (index == -1) {\n    return url;\n  }\n  const fragment = getFragment(url);\n  return url.substring(0, index) + fragment;\n}\n\n/**\n * Removes parameters that start with amp js parameter pattern and returns the\n * new search string.\n * @param {string} urlSearch\n * @return {string}\n */\nfunction removeAmpJsParamsFromSearch(urlSearch) {\n  if (!urlSearch || urlSearch == '?') {\n    return '';\n  }\n  const search = urlSearch\n      .replace(AMP_JS_PARAMS_REGEX, '')\n      .replace(AMP_GSA_PARAMS_REGEX, '')\n      .replace(AMP_R_PARAMS_REGEX, '')\n      .replace(GOOGLE_EXPERIMENT_PARAMS_REGEX, '')\n      .replace(/^[?&]/, ''); // Removes first ? or &.\n  return search ? '?' + search : '';\n}\n\n/**\n * Returns the source URL of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string}\n */\nexport function getSourceUrl(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n\n  // Not a proxy URL - return the URL itself.\n  if (!isProxyOrigin(url)) {\n    return url.href;\n  }\n\n  // A proxy URL.\n  // Example path that is being matched here.\n  // https://cdn.ampproject.org/c/s/www.origin.com/foo/\n  // The /s/ is optional and signals a secure origin.\n  const path = url.pathname.split('/');\n  const prefix = path[1];\n  user().assert(SERVING_TYPE_PREFIX[prefix],\n      'Unknown path prefix in url %s', url.href);\n  const domainOrHttpsSignal = path[2];\n  const origin = domainOrHttpsSignal == 's'\n    ? 'https://' + decodeURIComponent(path[3])\n    : 'http://' + decodeURIComponent(domainOrHttpsSignal);\n  // Sanity test that what we found looks like a domain.\n  user().assert(origin.indexOf('.') > 0, 'Expected a . in origin %s', origin);\n  path.splice(1, domainOrHttpsSignal == 's' ? 3 : 2);\n  return origin + path.join('/') +\n      removeAmpJsParamsFromSearch(url.search) + (url.hash || '');\n}\n\n/**\n * Returns the source origin of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string} The source origin of the URL.\n */\nexport function getSourceOrigin(url) {\n  return parseUrlDeprecated(getSourceUrl(url)).origin;\n}\n\n/**\n * Returns absolute URL resolved based on the relative URL and the base.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n */\nexport function resolveRelativeUrl(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  if (typeof URL == 'function') {\n    return new URL(relativeUrlString, baseUrl.href).toString();\n  }\n  return resolveRelativeUrlFallback_(relativeUrlString, baseUrl);\n}\n\n/**\n * Fallback for URL resolver when URL class is not available.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n * @private Visible for testing.\n */\nexport function resolveRelativeUrlFallback_(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  relativeUrlString = relativeUrlString.replace(/\\\\/g, '/');\n  const relativeUrl = parseUrlDeprecated(relativeUrlString);\n\n  // Absolute URL.\n  if (startsWith(relativeUrlString.toLowerCase(), relativeUrl.protocol)) {\n    return relativeUrl.href;\n  }\n\n  // Protocol-relative URL.\n  if (startsWith(relativeUrlString, '//')) {\n    return baseUrl.protocol + relativeUrlString;\n  }\n\n  // Absolute path.\n  if (startsWith(relativeUrlString, '/')) {\n    return baseUrl.origin + relativeUrlString;\n  }\n\n  // Relative path.\n  return baseUrl.origin + baseUrl.pathname.replace(/\\/[^/]*$/, '/')\n      + relativeUrlString;\n}\n\n\n/**\n * Add \"__amp_source_origin\" query parameter to the URL.\n * @param {!Window} win\n * @param {string} url\n * @return {string}\n */\nexport function getCorsUrl(win, url) {\n  checkCorsUrl(url);\n  const sourceOrigin = getSourceOrigin(win.location.href);\n  return addParamToUrl(url, SOURCE_ORIGIN_PARAM, sourceOrigin);\n}\n\n\n/**\n * Checks if the url has __amp_source_origin and throws if it does.\n * @param {string} url\n */\nexport function checkCorsUrl(url) {\n  const parsedUrl = parseUrlDeprecated(url);\n  const query = parseQueryString(parsedUrl.search);\n  user().assert(!(SOURCE_ORIGIN_PARAM in query),\n      'Source origin is not allowed in %s', url);\n}\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * @param {string} component\n * @param {string=} opt_fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent(component, opt_fallback) {\n  return tryDecodeUriComponent_(component, opt_fallback);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Compares if two arrays contains exactly same elements of same number\n * of same order.\n * Notice that it does NOT handle NaN case as expected\n *\n * @param {!Array<T>} arr1\n * @param {!Array<T>} arr2\n * @return {boolean}\n * @template T\n */\nexport function areEqualOrdered(arr1, arr2) {\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n\n  for (let i = 0; i < arr1.length; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * A bit like Array#filter, but removes elements that filter false from the\n * array. Returns the filtered items.\n *\n * @param {!Array<T>} array\n * @param {function(T, number, !Array<T>):boolean} filter\n * @return {!Array<T>}\n * @template T\n */\nexport function filterSplice(array, filter) {\n  const splice = [];\n  let index = 0;\n  for (let i = 0; i < array.length; i++) {\n    const item = array[i];\n    if (filter(item, i, array)) {\n      if (index < i) {\n        array[index] = item;\n      }\n      index++;\n    } else {\n      splice.push(item);\n    }\n  }\n\n  if (index < array.length) {\n    array.length = index;\n  }\n\n  return splice;\n}\n\n/**\n * Returns the index of the first element matching the predicate.\n * Like Array#findIndex.\n *\n * @param {!Array<T>} array\n * @param {function(T, number, !Array<T>):boolean} predicate\n * @return {number}\n * @template T\n */\nexport function findIndex(array, predicate) {\n  for (let i = 0; i < array.length; i++) {\n    if (predicate(array[i], i, array)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n/**\n * Converts the given iterator to an array.\n *\n * @param {!Iterator<T>} iterator\n * @return {Array<T>}\n * @template T\n */\nexport function fromIterator(iterator) {\n  const array = [];\n  for (let e = iterator.next(); !e.done; e = iterator.next()) {\n    array.push(e.value);\n  }\n  return array;\n}\n\n/**\n * Adds item to array if it is not already present.\n *\n * @param {Array<T>} array\n * @param {T} item\n * @template T\n */\nexport function pushIfNotExist(array, item) {\n  if (array.indexOf(item) < 0) {\n    array.push(item);\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from '../log';\n\n/** @const {string} */\nconst TAG = 'lru-cache';\n\n/**\n * @template T\n */\nexport class LruCache {\n  /**\n   * @param {number} capacity\n   */\n  constructor(capacity) {\n    /** @private @const {number} */\n    this.capacity_ = capacity;\n\n    /** @private {number} */\n    this.size_ = 0;\n\n    /**\n     * An incrementing counter to define the last access.\n     * @private {number}\n     */\n    this.access_ = 0;\n\n    /** @private {!Object<(number|string), {payload: T, access: number}>} */\n    this.cache_ = Object.create(null);\n  }\n\n  /**\n   * Returns whether key is cached.\n   *\n   * @param {number|string} key\n   * @return {boolean}\n   */\n  has(key) {\n    return !!this.cache_[key];\n  }\n\n  /**\n   * @param {number|string} key\n   * @return {T} The cached payload.\n   */\n  get(key) {\n    const cacheable = this.cache_[key];\n    if (cacheable) {\n      cacheable.access = ++this.access_;\n      return cacheable.payload;\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {number|string} key\n   * @param {T} payload The payload to cache.\n   */\n  put(key, payload) {\n    if (!this.has(key)) {\n      this.size_++;\n    }\n    this.cache_[key] = {payload, access: this.access_};\n    this.evict_();\n  }\n\n  /**\n   * Evicts the oldest cache entry, if we've exceeded capacity.\n   */\n  evict_() {\n    if (this.size_ <= this.capacity_) {\n      return;\n    }\n\n    dev().warn(TAG, 'Trimming LRU cache');\n    const cache = this.cache_;\n    let oldest = this.access_ + 1;\n    let oldestKey;\n    for (const key in cache) {\n      const {access} = cache[key];\n      if (access < oldest) {\n        oldest = access;\n        oldestKey = key;\n      }\n    }\n\n    if (oldestKey !== undefined) {\n      delete cache[oldestKey];\n      this.size_--;\n    }\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Maps a value in a first range to its equivalent in a second range\n * Ex.: 5 in the range [0,10] gives 60 in the range[40,80]\n *\n * NOTE: lower/upper bounds on the source range are detected automatically,\n * however the bounds on the target range are not altered (thus the target\n * range could be decreasing).\n * Ex1: 8 in the range [0, 10] gives 2 in the range [10, 0]\n * Ex2: also, 8 in the range [10, 0] gives 2 in the range [10, 0]\n *\n * NOTE: Input value is enforced to be bounded inside the source range\n * Ex1: -2 in the range [0, 10] is interpreted as 0 and thus gives 40 in [40,80]\n * Ex2: 19 in the range [0, 5] is interpreted as 5 and thus gives 80 in [40,80]\n *\n * @param {number} val the value in the source range\n * @param {number} min1 the lower bound of the source range\n * @param {number} max1 the upper bound of the source range\n * @param {number} min2 the lower bound of the target range\n * @param {number} max2 the upper bound of the target range\n * @return {number} the equivalent value in the target range\n */\nexport function mapRange(val, min1, max1, min2, max2) {\n\n  let max1Bound = max1;\n  let min1Bound = min1;\n  if (min1 > max1) {\n    max1Bound = min1;\n    min1Bound = max1;\n  }\n\n  if (val < min1Bound) {\n    val = min1Bound;\n  } else if (val > max1Bound) {\n    val = max1Bound;\n  }\n\n  return (val - min1) * (max2 - min2) / (max1 - min1) + min2;\n}\n\n/**\n * Computes the modulus of values `a` and `b`.\n *\n * This is needed because the % operator in JavaScript doesn't implement\n * modulus behaviour as can be seen by the spec here:\n * http://www.ecma-international.org/ecma-262/5.1/#sec-11.5.3.\n * It instead is used to obtain the remainder of a division.\n * This function uses the remainder (%) operator to determine the modulus.\n * Derived from here:\n * https://stackoverflow.com/questions/25726760/javascript-modular-arithmetic/47354356#47354356\n *\n * @param {number} a\n * @param {number} b\n * @return {number} returns the modulus of the two numbers.\n * @example\n *\n * _.min(10, 5);\n * // => 0\n *\n * _.mod(-1, 5);\n * // => 4\n */\nexport function mod(a, b) {\n  return a > 0 && b > 0 ? a % b : ((a % b) + b) % b;\n}\n\n/**\n * Restricts a number to be in the given min/max range.\n *\n * Examples:\n * clamp(0.5, 0, 1) -> 0.5\n * clamp(1.5, 0, 1) -> 1\n * clamp(-0.5, 0, 1) -> 0\n *\n * @param {number} val the value to clamp.\n * @param {number} min the lower bound.\n * @param {number} max the upper bound.\n * @return {number} the clamped value.\n */\nexport function clamp(val, min, max) {\n  return Math.min(Math.max(val, min), max);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {isObject} from '../types';\n\n/* @const */\nconst hasOwn_ = Object.prototype.hasOwnProperty;\n\n/**\n * Returns a map-like object.\n * If opt_initial is provided, copies its own properties into the\n * newly created object.\n * @param {T=} opt_initial This should typically be an object literal.\n * @return {T}\n * @template T\n */\nexport function map(opt_initial) {\n  const obj = Object.create(null);\n  if (opt_initial) {\n    Object.assign(obj, opt_initial);\n  }\n  return obj;\n}\n\n/**\n * Return an empty JsonObject or makes the passed in object literal\n * an JsonObject.\n * The JsonObject type is just a simple object that is at-dict.\n * See\n * https://github.com/google/closure-compiler/wiki/@struct-and-@dict-Annotations\n * for what a dict is type-wise.\n * The linter enforces that the argument is, in fact, at-dict like.\n * @param {!Object=} opt_initial\n * @return {!JsonObject}\n */\nexport function dict(opt_initial) {\n  // We do not copy. The linter enforces that the passed in object is a literal\n  // and thus the caller cannot have a reference to it.\n  return /** @type {!JsonObject} */ (opt_initial || {});\n}\n\n/**\n * Checks if the given key is a property in the map.\n *\n * @param {T}  obj a map like property.\n * @param {string}  key\n * @return {boolean}\n * @template T\n */\nexport function hasOwn(obj, key) {\n  return hasOwn_.call(obj, key);\n}\n\n/**\n * Returns obj[key] iff key is obj's own property (is not inherited).\n * Otherwise, returns undefined.\n *\n * @param {Object} obj\n * @param {string} key\n * @return {*}\n */\nexport function ownProperty(obj, key) {\n  if (hasOwn(obj, key)) {\n    return obj[key];\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Deep merges source into target.\n *\n * @param {!Object} target\n * @param {!Object} source\n * @param {number} depth The maximum merge depth. If exceeded, Object.assign\n *                       will be used instead.\n * @return {!Object}\n * @throws {Error} If source contains a circular reference.\n * Note: Only nested objects are deep-merged, primitives and arrays are not.\n */\nexport function deepMerge(target, source, depth = 10) {\n  // Keep track of seen objects to detect recursive references.\n  const seen = [];\n\n  /** @type {!Array<{t: !Object, s: !Object, d: number}>} */\n  const queue = [];\n  queue.push({t: target, s: source, d: 0});\n\n  // BFS to ensure objects don't have recursive references at shallower depths.\n  while (queue.length > 0) {\n    const {t, s, d} = queue.shift();\n    if (seen.includes(s)) {\n      throw new Error('Source object has a circular reference.');\n    }\n    seen.push(s);\n    if (t === s) {\n      continue;\n    }\n    if (d > depth) {\n      Object.assign(t, s);\n      continue;\n    }\n    Object.keys(s).forEach(key => {\n      const newValue = s[key];\n      // Perform a deep merge IFF both target and source have the same key\n      // whose corresponding values are objects.\n      if (hasOwn(t, key)) {\n        const oldValue = t[key];\n        if (isObject(newValue) && isObject(oldValue)) {\n          queue.push({t: oldValue, s: newValue, d: d + 1});\n          return;\n        }\n      }\n      t[key] = newValue;\n    });\n  }\n  return target;\n}\n\n/**\n * @param {!Object} o An object to remove properties from\n * @param {!Array<string>} props A list of properties to remove from the Object\n * @return {!Object} An object with the given properties removed\n */\nexport function omit(o, props) {\n  return Object.keys(o).reduce((acc, key) => {\n    if (!props.includes(key)) {\n      acc[key] = o[key];\n    }\n    return acc;\n  }, {});\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns a Deferred struct, which holds a pending promise and its associated\n * resolve and reject functions.\n *\n * This is preferred instead of creating a Promise instance to extract the\n * resolve/reject functions yourself:\n *\n * ```\n * // Avoid doing\n * let resolve;\n * const promise = new Promise(res => {\n *   resolve = res;\n * });\n *\n * // Good\n * const deferred = new Deferred();\n * const { promise, resolve } = deferred;\n * ```\n *\n * @template T\n */\nexport class Deferred {\n  /**\n   * Creates an instance of Deferred.\n   */\n  constructor() {\n    let resolve, reject;\n\n    /**\n     * @const {!Promise<T>}\n     */\n    this.promise = new /*OK*/Promise((res, rej) => {\n      resolve = res;\n      reject = rej;\n    });\n\n    /**\n     * @const {function(T=)}\n     */\n    this.resolve = resolve;\n\n    /**\n     * @const {function(*=)}\n     */\n    this.reject = reject;\n  }\n}\n\n/**\n * Creates a promise resolved to the return value of fn.\n * If fn sync throws, it will cause the promise to reject.\n *\n * @param {function():T} fn\n * @return {!Promise<T>}\n * @template T\n */\nexport function tryResolve(fn) {\n  return new Promise(resolve => {\n    resolve(fn());\n  });\n}\n\n/**\n * Returns a promise which resolves if a threshold amount of the given promises\n * resolve, and rejects otherwise.\n * @param {!Array<!Promise>} promises The array of promises to test.\n * @param {number} count The number of promises that must resolve for the\n *     returned promise to resolve.\n * @return {!Promise} A promise that resolves if any of the given promises\n *     resolve, and which rejects otherwise.\n */\nexport function some(promises, count = 1) {\n  return new Promise((resolve, reject) => {\n    count = Math.max(count, 0);\n    const extra = promises.length - count;\n    if (extra < 0) {\n      reject(new Error('not enough promises to resolve'));\n    }\n    if (promises.length == 0) {\n      resolve([]);\n    }\n    const values = [];\n    const reasons = [];\n\n    const onFulfilled = value => {\n      if (values.length < count) {\n        values.push(value);\n      }\n      if (values.length == count) {\n        resolve(values);\n      }\n    };\n    const onRejected = reason => {\n      if (reasons.length <= extra) {\n        reasons.push(reason);\n      }\n      if (reasons.length > extra) {\n        reject(reasons);\n      }\n    };\n    for (let i = 0; i < promises.length; i++) {\n      Promise.resolve(promises[i]).then(onFulfilled, onRejected);\n    }\n  });\n}\n\n/**\n * Resolves with the result of the last promise added.\n * @implements {IThenable}\n */\nexport class LastAddedResolver {\n  /**\n   * @param {!Array<!Promise>=} opt_promises\n   */\n  constructor(opt_promises) {\n    let resolve_, reject_;\n    /** @private @const {!Promise} */\n    this.promise_ = new Promise((resolve, reject) => {\n      resolve_ = resolve;\n      reject_ = reject;\n    });\n\n    /** @private */\n    this.resolve_ = resolve_;\n\n    /** @private */\n    this.reject_ = reject_;\n\n    /** @private */\n    this.count_ = 0;\n\n    if (opt_promises) {\n      for (let i = 0; i < opt_promises.length; i++) {\n        this.add(opt_promises[i]);\n      }\n    }\n  }\n\n  /**\n   * Add a promise to possibly be resolved.\n   * @param {!Promise} promise\n   * @return {!Promise}\n   */\n  add(promise) {\n    const countAtAdd = ++this.count_;\n    Promise.resolve(promise).then(result => {\n      if (this.count_ === countAtAdd) {\n        this.resolve_(result);\n      }\n    }, error => {\n      // Don't follow behavior of Promise.all and Promise.race error so that\n      // this will only reject when most recently added promise fails.\n      if (this.count_ === countAtAdd) {\n        this.reject_(error);\n      }\n    });\n    return this.promise_;\n  }\n\n  /** @override */\n  then(opt_resolve, opt_reject) {\n    return this.promise_.then(opt_resolve, opt_reject);\n  }\n}\n","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n\n\n/**\n * This regex consists of 4 matching capture groups and one (non-matching) fallback:\n *\n * - (\\0), catch the null terminator character so it may be replaced by UTF\n *   Replacement Char\n * - ^(-)$, catch a solitary dash char, so that it may be backslash escaped.\n *   This is a separate capture group so that the legal-chars (group 4) doesn't\n *   capture it first, since that group doesn't need to escape its dash.\n * - ([\\x01-\\x1f\\x7f]|^-?[0-9]), catch a UTF control char, or any leading\n *   number (with an optional leading dash). The control or the number (but not\n *   the leading dash) must be hex-escaped,.\n * - ([\\x80-\\uffff0-9a-zA-Z_-]+), catch legal-chars, with the exception of a\n *   solitary dash, which will already have matched in group 1.\n * - [^], finally, a catch-all that allows us to backslash escape the char.\n *\n * Together, this matches everything necessary for CSS.escape.\n */\nvar regex = /(\\0)|^(-)$|([\\x01-\\x1f\\x7f]|^-?[0-9])|([\\x80-\\uffff0-9a-zA-Z_-]+)|[^]/g;\n\nfunction escaper(match, nil, dash, hexEscape, chars) {\n  // Chars is the legal-chars (group 4) capture\n  if (chars) {\n    return chars;\n  }\n  // Nil is the null terminator (group 1) capture\n  if (nil) {\n    return '\\uFFFD';\n  }\n  // Both UTF control chars, and leading numbers (with optional leading dash)\n  // (group 3) must be backslash escaped with a trailing space.  Funnily, the\n  // leading dash must not be escaped, but the number. :shrug:\n  if (hexEscape) {\n    return match.slice(0, -1) + '\\\\' + match.slice(-1).charCodeAt(0).toString(16) + ' '\n  }\n  // Finally, the solitary dash and the catch-all chars require backslash\n  // escaping.\n  return '\\\\' + match;\n}\n\n/**\n * https://drafts.csswg.org/cssom/#serialize-an-identifier\n * @param {string} value\n * @return {string}\n */\nexport function cssEscape(value) {\n  return String(value).replace(regex, escaper);\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJidWlsZC9hbXAtcGFuLXpvb20tMC4xLmNzcy5qcyIsImV4dGVuc2lvbnMvYW1wLXBhbi16b29tLzAuMS9hbXAtcGFuLXpvb20uanMiLCJub2RlX21vZHVsZXMvZG9jdW1lbnQtcmVnaXN0ZXItZWxlbWVudC9idWlsZC9kb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50LnBhdGNoZWQuanMiLCJub2RlX21vZHVsZXMvcHJvbWlzZS1wanMvcHJvbWlzZS5qcyIsInNyYy9hY3Rpb24tY29uc3RhbnRzLmpzIiwic3JjL2FuaW1hdGlvbi5qcyIsInNyYy9jb25maWcuanMiLCJzcmMvY29va2llcy5qcyIsInNyYy9jdXJ2ZS5qcyIsInNyYy9kb20uanMiLCJzcmMvZWxlbWVudC1zZXJ2aWNlLmpzIiwic3JjL2V2ZW50LWhlbHBlci1saXN0ZW4uanMiLCJzcmMvZXZlbnQtaGVscGVyLmpzIiwic3JjL2V4cGVyaW1lbnRzLmpzIiwic3JjL2dlc3R1cmUtcmVjb2duaXplcnMuanMiLCJzcmMvZ2VzdHVyZS5qcyIsInNyYy9sYXlvdXQtcmVjdC5qcyIsInNyYy9sYXlvdXQuanMiLCJzcmMvbG9nLmpzIiwic3JjL21vZGUtb2JqZWN0LmpzIiwic3JjL21vZGUuanMiLCJzcmMvbW90aW9uLmpzIiwic3JjL29ic2VydmFibGUuanMiLCJzcmMvcGFzcy5qcyIsInNyYy9wb2x5ZmlsbHMuanMiLCJzcmMvcG9seWZpbGxzL2FycmF5LWluY2x1ZGVzLmpzIiwic3JjL3BvbHlmaWxscy9jdXN0b20tZWxlbWVudHMuanMiLCJzcmMvcG9seWZpbGxzL2RvY3VtZW50LWNvbnRhaW5zLmpzIiwic3JjL3BvbHlmaWxscy9kb210b2tlbmxpc3QtdG9nZ2xlLmpzIiwic3JjL3BvbHlmaWxscy9tYXRoLXNpZ24uanMiLCJzcmMvcG9seWZpbGxzL29iamVjdC1hc3NpZ24uanMiLCJzcmMvcG9seWZpbGxzL3Byb21pc2UuanMiLCJzcmMvc2VydmljZS5qcyIsInNyYy9zZXJ2aWNlcy5qcyIsInNyYy9zdGF0aWMtdGVtcGxhdGUuanMiLCJzcmMvc3RyaW5nLmpzIiwic3JjL3N0eWxlLmpzIiwic3JjL3RpbWUuanMiLCJzcmMvdHJhbnNpdGlvbi5qcyIsInNyYy90eXBlcy5qcyIsInNyYy91cmwtcGFyc2UtcXVlcnktc3RyaW5nLmpzIiwic3JjL3VybC10cnktZGVjb2RlLXVyaS1jb21wb25lbnQuanMiLCJzcmMvdXJsLmpzIiwic3JjL3V0aWxzL2FycmF5LmpzIiwic3JjL3V0aWxzL2xydS1jYWNoZS5qcyIsInNyYy91dGlscy9tYXRoLmpzIiwic3JjL3V0aWxzL29iamVjdC5qcyIsInNyYy91dGlscy9wcm9taXNlLmpzIiwidGhpcmRfcGFydHkvY3NzLWVzY2FwZS9jc3MtZXNjYXBlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FDQU8sSUFBTSxvQkFBTSw0VEFBWjs7Ozs7Ozs7OztBQ2dCUDs7QUFDQTs7QUFDQTs7QUFDQTs7QUFNQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFJQTs7QUFFQTs7QUFDQTs7Ozs7OytlQXhDQTs7Ozs7Ozs7Ozs7Ozs7OztBQTBDQSxJQUFNLGtCQUFrQix3QkFBWSxHQUFaLEVBQWlCLENBQWpCLEVBQW9CLEdBQXBCLEVBQXlCLEdBQXpCLENBQXhCO0FBQ0EsSUFBTSxNQUFNLGNBQVo7QUFDQSxJQUFNLG9CQUFvQixDQUExQjtBQUNBLElBQU0seUJBQXlCLEdBQS9COztBQUdBLElBQU0sZ0JBQWdCO0FBQ3BCLFNBQU8sSUFEYTtBQUVwQixTQUFPLElBRmE7QUFHcEIsYUFBVyxJQUhTO0FBSXBCLGdCQUFjO0FBSk0sQ0FBdEI7O0FBT0EsSUFBTSx5QkFBNEIsR0FBNUIsaUVBQU47O0FBR0E7Ozs7SUFHYSxVLFdBQUEsVTs7O0FBQ1g7O0FBRUE7QUFDQSxzQkFBWSxPQUFaLEVBQXFCO0FBQUE7O0FBSW5CO0FBSm1CLHdIQUViLE9B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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbjZDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUE0QixNQUFNLEtBQU4sQ0FBWSxDQUFDLENBQWIsRUFBZ0IsVUFBaEIsQ0FBMkIsQ0FBM0IsRUFBOEIsUUFBOUIsQ0FBdUMsRUFBdkMsQ0FBNUIsR0FBeUUsR0FBaEY7QUFDRDtBQUNEO0FBQ0E7QUFDQSxTQUFPLE9BQU8sS0FBZDtBQUNEOztBQUVEOzs7OztBQUtPLFNBQVMsU0FBVCxDQUFtQixLQUFuQixFQUEwQjtBQUMvQixTQUFPLE9BQU8sS0FBUCxFQUFjLE9BQWQsQ0FBc0IsS0FBdEIsRUFBNkIsT0FBN0IsQ0FBUDtBQUNEIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImV4cG9ydCBjb25zdCBDU1MgPSBcIi5pLWFtcGh0bWwtcGFuLXpvb217ZGlzcGxheTotd2Via2l0LWJveDtkaXNwbGF5Oi1tcy1mbGV4Ym94O2Rpc3BsYXk6ZmxleDstd2Via2l0LWJveC1wYWNrOmNlbnRlcjstbXMtZmxleC1wYWNrOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOy13ZWJraXQtYm94LWFsaWduOmNlbnRlcjstbXMtZmxleC1hbGlnbjpjZW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyfS5pLWFtcGh0bWwtcGFuLXpvb20tY2hpbGR7cG9zaXRpb246YWJzb2x1dGV9XFxuLyojIHNvdXJjZVVSTD0vZXh0ZW5zaW9ucy9hbXAtcGFuLXpvb20vMC4xL2FtcC1wYW4tem9vbS5jc3MqL1wiO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7QWN0aW9uVHJ1c3R9IGZyb20gJy4uLy4uLy4uL3NyYy9hY3Rpb24tY29uc3RhbnRzJztcbmltcG9ydCB7QW5pbWF0aW9ufSBmcm9tICcuLi8uLi8uLi9zcmMvYW5pbWF0aW9uJztcbmltcG9ydCB7Q1NTfSBmcm9tICcuLi8uLi8uLi9idWlsZC9hbXAtcGFuLXpvb20tMC4xLmNzcyc7XG5pbXBvcnQge1xuICBEb3VibGV0YXBSZWNvZ25pemVyLFxuICBQaW5jaFJlY29nbml6ZXIsXG4gIFN3aXBlWFlSZWNvZ25pemVyLFxuICBUYXBSZWNvZ25pemVyLFxufSBmcm9tICcuLi8uLi8uLi9zcmMvZ2VzdHVyZS1yZWNvZ25pemVycyc7XG5pbXBvcnQge0dlc3R1cmVzfSBmcm9tICcuLi8uLi8uLi9zcmMvZ2VzdHVyZSc7XG5pbXBvcnQge0xheW91dH0gZnJvbSAnLi4vLi4vLi4vc3JjL2xheW91dCc7XG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZXMnO1xuaW1wb3J0IHtiZXppZXJDdXJ2ZX0gZnJvbSAnLi4vLi4vLi4vc3JjL2N1cnZlJztcbmltcG9ydCB7Y2xhbXB9IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9tYXRoJztcbmltcG9ydCB7Y29udGludWVNb3Rpb259IGZyb20gJy4uLy4uLy4uL3NyYy9tb3Rpb24nO1xuaW1wb3J0IHtjcmVhdGVDdXN0b21FdmVudH0gZnJvbSAnLi4vLi4vLi4vc3JjL2V2ZW50LWhlbHBlcic7XG5pbXBvcnQge2RldiwgdXNlcn0gZnJvbSAnLi4vLi4vLi4vc3JjL2xvZyc7XG5pbXBvcnQge1xuICBsYXlvdXRSZWN0RnJvbURvbVJlY3QsXG4gIGxheW91dFJlY3RMdHdoLFxufSBmcm9tICcuLi8uLi8uLi9zcmMvbGF5b3V0LXJlY3QnO1xuaW1wb3J0IHtudW1lcmljfSBmcm9tICcuLi8uLi8uLi9zcmMvdHJhbnNpdGlvbic7XG5cbmltcG9ydCB7ZGljdH0gZnJvbSAnLi4vLi4vLi4vc3JjL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge3B4LCBzY2FsZSwgc2V0U3R5bGVzLCB0cmFuc2xhdGV9IGZyb20gJy4uLy4uLy4uL3NyYy9zdHlsZSc7XG5cbmNvbnN0IFBBTl9aT09NX0NVUlZFXyA9IGJlemllckN1cnZlKDAuNCwgMCwgMC4yLCAxLjQpO1xuY29uc3QgVEFHID0gJ2FtcC1wYW4tem9vbSc7XG5jb25zdCBERUZBVUxUX01BWF9TQ0FMRSA9IDM7XG5jb25zdCBNQVhfQU5JTUFUSU9OX0RVUkFUSU9OID0gMjUwO1xuXG5cbmNvbnN0IEVMSUdJQkxFX1RBR1MgPSB7XG4gICdzdmcnOiB0cnVlLFxuICAnRElWJzogdHJ1ZSxcbiAgJ0FNUC1JTUcnOiB0cnVlLFxuICAnQU1QLUxBWU9VVCc6IHRydWUsXG59O1xuXG5jb25zdCBTVVBQT1JUX1ZBTElEQVRJT05fTVNHID0gYCR7VEFHfSBzaG91bGRcbiAgaGF2ZSBpdHMgdGFyZ2V0IGVsZW1lbnQgYXMgdGhlIG9uZSBhbmQgb25seSBjaGlsZGA7XG5cbi8qKlxuICogQGV4dGVuZHMge0FNUC5CYXNlRWxlbWVudH1cbiAqL1xuZXhwb3J0IGNsYXNzIEFtcFBhblpvb20gZXh0ZW5kcyBBTVAuQmFzZUVsZW1lbnQge1xuICAvLyBUT0RPICgjMTU2ODUpOiByZWZhY3RvciB0aGlzIHRvIHNoYXJlIGNvZGUgd2l0aCBhbXAtaW1hZ2Utdmlld2VyXG5cbiAgLyoqIEBwYXJhbSB7IUFtcEVsZW1lbnR9IGVsZW1lbnQgKi9cbiAgY29uc3RydWN0b3IoZWxlbWVudCkge1xuXG4gICAgc3VwZXIoZWxlbWVudCk7XG5cbiAgICAvKiogQHByaXZhdGUgez9FbGVtZW50fSAqL1xuICAgIHRoaXMuY29udGVudF8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/Li4vLi4vLi4vc3JjL3NlcnZpY2UvYWN0aW9uLWltcGwuQWN0aW9uU2VydmljZX0gKi9cbiAgICB0aGlzLmFjdGlvbl8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5zb3VyY2VXaWR0aF8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5zb3VyY2VIZWlnaHRfID0gMDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7Py4uLy4uLy4uL3NyYy9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmfSAqL1xuICAgIHRoaXMuZWxlbWVudEJveF8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/Li4vLi4vLi4vc3JjL2xheW91dC1yZWN0LkxheW91dFJlY3REZWZ9ICovXG4gICAgdGhpcy5jb250ZW50Qm94XyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUgez9Vbmxpc3RlbkRlZn0gKi9cbiAgICB0aGlzLnVubGlzdGVuT25Td2lwZVBhbl8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5zY2FsZV8gPSAxO1xuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5zdGFydFNjYWxlXyA9IDE7XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICB0aGlzLm1pblNjYWxlXyA9IDE7XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICB0aGlzLm1heFNjYWxlXyA9IERFRkFVTFRfTUFYX1NDQUxFO1xuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5pbml0aWFsWF8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5pbml0aWFsWV8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5pbml0aWFsU2NhbGVfID0gMTtcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMuc3RhcnRYXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICB0aGlzLnN0YXJ0WV8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5wb3NYXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICB0aGlzLnBvc1lfID0gMDtcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMubWluWF8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5taW5ZXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICB0aGlzLm1heFhfID0gMDtcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMubWF4WV8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/Li4vLi4vLi4vc3JjL2dlc3R1cmUuR2VzdHVyZXN9ICovXG4gICAgdGhpcy5nZXN0dXJlc18gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/Li4vLi4vLi4vc3JjL21vdGlvbi5Nb3Rpb259ICovXG4gICAgdGhpcy5tb3Rpb25fID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMucmVzZXRPblJlc2l6ZV8gPSBmYWxzZTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgYnVpbGRDYWxsYmFjaygpIHtcbiAgICB0aGlzLmFjdGlvbl8gPSBTZXJ2aWNlcy5hY3Rpb25TZXJ2aWNlRm9yRG9jKHRoaXMuZWxlbWVudCk7XG4gICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmdldFJlYWxDaGlsZHJlbigpO1xuXG4gICAgdXNlcigpLmFzc2VydChjaGlsZHJlbi5sZW5ndGggPT0gMSwgU1VQUE9SVF9WQUxJREFUSU9OX01TRyk7XG4gICAgdXNlcigpLmFzc2VydChcbiAgICAgICAgdGhpcy5lbGVtZW50SXNTdXBwb3J0ZWRfKGNoaWxkcmVuWzBdKSxcbiAgICAgICAgY2hpbGRyZW5bMF0udGFnTmFtZSArIGAgaXMgbm90IHN1cHBvcnRlZCBieSAke1RBR31gXG4gICAgKTtcbiAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaS1hbXBodG1sLXBhbi16b29tJyk7XG4gICAgdGhpcy5jb250ZW50XyA9IGNoaWxkcmVuWzBdO1xuICAgIHRoaXMuY29udGVudF8uY2xhc3NMaXN0LmFkZCgnaS1hbXBodG1sLXBhbi16b29tLWNoaWxkJyk7XG4gICAgdGhpcy5tYXhTY2FsZV8gPSB0aGlzLmdldE51bWJlckF0dHJpYnV0ZU9yXygnbWF4LXNjYWxlJywgREVGQVVMVF9NQVhfU0NBTEUpO1xuICAgIHRoaXMuaW5pdGlhbFNjYWxlXyA9IHRoaXMuZ2V0TnVtYmVyQXR0cmlidXRlT3JfKCdpbml0aWFsLXNjYWxlJywgMSk7XG4gICAgdGhpcy5pbml0aWFsWF8gPSB0aGlzLmdldE51bWJlckF0dHJpYnV0ZU9yXygnaW5pdGlhbC14JywgMCk7XG4gICAgdGhpcy5pbml0aWFsWV8gPSB0aGlzLmdldE51bWJlckF0dHJpYnV0ZU9yXygnaW5pdGlhbC15JywgMCk7XG4gICAgdGhpcy5yZXNldE9uUmVzaXplXyA9IHRoaXMuZWxlbWVudC5oYXNBdHRyaWJ1dGUoJ3Jlc2V0LW9uLXJlc2l6ZScpO1xuXG4gICAgdGhpcy5yZWdpc3RlckFjdGlvbigndHJhbnNmb3JtJywgaW52b2NhdGlvbiA9PiB7XG4gICAgICBjb25zdCB7YXJnc30gPSBpbnZvY2F0aW9uO1xuICAgICAgaWYgKCFhcmdzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNjYWxlID0gYXJnc1snc2NhbGUnXSB8fCAxO1xuICAgICAgdGhpcy51cGRhdGVQYW5ab29tQm91bmRzXyhzY2FsZSk7XG4gICAgICBjb25zdCB4ID0gdGhpcy5ib3VuZFhfKGFyZ3NbJ3gnXSB8fCAwLCAvKmFsbG93RXh0ZW50Ki8gZmFsc2UpO1xuICAgICAgY29uc3QgeSA9IHRoaXMuYm91bmRZXyhhcmdzWyd5J10gfHwgMCwgLyphbGxvd0V4dGVudCovIGZhbHNlKTtcbiAgICAgIHJldHVybiB0aGlzLnNldF8oc2NhbGUsIHgsIHksIC8qYW5pbWF0ZSovIHRydWUpXG4gICAgICAgICAgLnRoZW4oKCkgPT4gdGhpcy5vblpvb21SZWxlYXNlXygpKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgb25NZWFzdXJlQ2hhbmdlZCgpIHtcbiAgICBpZiAodGhpcy5yZXNldE9uUmVzaXplXykge1xuICAgICAgdGhpcy5yZXNldENvbnRlbnREaW1lbnNpb25zXygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgbGF5b3V0Q2FsbGJhY2soKSB7XG4gICAgcmV0dXJuIHRoaXMucmVzZXRDb250ZW50RGltZW5zaW9uc18oKS50aGVuKHRoaXMuc2V0dXBHZXN0dXJlc18oKSk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHBhdXNlQ2FsbGJhY2soKSB7XG4gICAgdGhpcy5yZXNldENvbnRlbnREaW1lbnNpb25zXygpO1xuICAgIHRoaXMuY2xlYW51cEdlc3R1cmVzXygpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICByZXN1bWVDYWxsYmFjaygpIHtcbiAgICBpZiAodGhpcy5jb250ZW50Xykge1xuICAgICAgdGhpcy5zY2hlZHVsZUxheW91dCh0aGlzLmNvbnRlbnRfKTtcbiAgICB9XG4gICAgdGhpcy5zZXR1cEdlc3R1cmVzXygpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICB1bmxheW91dENhbGxiYWNrKCkge1xuICAgIHRoaXMuY2xlYW51cEdlc3R1cmVzXygpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBpc0xheW91dFN1cHBvcnRlZChsYXlvdXQpIHtcbiAgICByZXR1cm4gbGF5b3V0ID09IExheW91dC5GSVhFRCB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5GSVhFRF9IRUlHSFQgfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuRklMTCB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5SRVNQT05TSVZFO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyB0byBzZWUgaWYgYW4gZWxlbWVudCBpcyBzdXBwb3J0ZWQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudFxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZWxlbWVudElzU3VwcG9ydGVkXyhlbGVtZW50KSB7XG4gICAgcmV0dXJuIEVMSUdJQkxFX1RBR1NbZWxlbWVudC50YWdOYW1lXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUcmllcyB0byByZXRyaWV2ZSBhIG51bWJlciBhdHRyaWJ1dGUsIHJldHVybnMgYSBkZWZhdWx0IHZhbHVlXG4gICAqIGlmIHVuc3VjY2Vzc2Z1bC5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGF0dHJpYnV0ZVxuICAgKiBAcGFyYW0ge251bWJlcn0gZGVmYXVsdFZhbHVlXG4gICAqIEByZXR1cm4ge251bWJlcn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdldE51bWJlckF0dHJpYnV0ZU9yXyhhdHRyaWJ1dGUsIGRlZmF1bHRWYWx1ZSkge1xuICAgIGNvbnN0IHtlbGVtZW50fSA9IHRoaXM7XG4gICAgcmV0dXJuIGVsZW1lbnQuaGFzQXR0cmlidXRlKGF0dHJpYnV0ZSlcbiAgICAgID8gcGFyc2VJbnQoZWxlbWVudC5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlKSwgMTApXG4gICAgICA6IGRlZmF1bHRWYWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNZWFzdXJlcyB0aGUgY29udGVudCB2aWV3ZXIgYW5kIGNvbnRlbnQgc2l6ZXMgYW5kIHBvc2l0aW9uaW5nLlxuICAgKiBUaGlzIG11c3QgYmUgY2FsbGVkIEFGVEVSIHRoZSBzb3VyY2UgZWxlbWVudCBoYXMgYWxyZWFkeSBiZWVuXG4gICAqIGxhaWQgb3V0LlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgbWVhc3VyZV8oKSB7XG4gICAgdGhpcy5zb3VyY2VXaWR0aF8gPSB0aGlzLmNvbnRlbnRfLi8qT0sqL3Njcm9sbFdpZHRoO1xuICAgIHRoaXMuc291cmNlSGVpZ2h0XyA9IHRoaXMuY29udGVudF8uLypPSyovc2Nyb2xsSGVpZ2h0O1xuXG4gICAgdGhpcy5lbGVtZW50Qm94XyA9IGxheW91dFJlY3RGcm9tRG9tUmVjdCh0aGlzLmVsZW1lbnRcbiAgICAgICAgLi8qT0sqL2dldEJvdW5kaW5nQ2xpZW50UmVjdCgpKTtcblxuICAgIGNvbnN0IHNvdXJjZUFzcGVjdFJhdGlvID0gdGhpcy5zb3VyY2VXaWR0aF8gLyB0aGlzLnNvdXJjZUhlaWdodF87XG4gICAgbGV0IGhlaWdodCA9IE1hdGgubWluKHRoaXMuZWxlbWVudEJveF8ud2lkdGggLyBzb3VyY2VBc3BlY3RSYXRpbyxcbiAgICAgICAgdGhpcy5lbGVtZW50Qm94Xy5oZWlnaHQpO1xuICAgIGxldCB3aWR0aCA9IE1hdGgubWluKHRoaXMuZWxlbWVudEJveF8uaGVpZ2h0ICogc291cmNlQXNwZWN0UmF0aW8sXG4gICAgICAgIHRoaXMuZWxlbWVudEJveF8ud2lkdGgpO1xuXG4gICAgaWYgKE1hdGguYWJzKHdpZHRoIC0gdGhpcy5zb3VyY2VXaWR0aF8pIDw9IDE2XG4gICAgJiYgTWF0aC5hYnMoaGVpZ2h0IC0gdGhpcy5zb3VyY2VIZWlnaHRfIDw9IDE2KSkge1xuICAgICAgd2lkdGggPSB0aGlzLnNvdXJjZVdpZHRoXztcbiAgICAgIGhlaWdodCA9IHRoaXMuc291cmNlSGVpZ2h0XztcbiAgICB9XG5cbiAgICB0aGlzLmNvbnRlbnRCb3hfID0gbGF5b3V0UmVjdEx0d2goXG4gICAgICAgIE1hdGgucm91bmQoKHRoaXMuZWxlbWVudEJveF8ud2lkdGggLSB3aWR0aCkgLyAyKSxcbiAgICAgICAgTWF0aC5yb3VuZCgodGhpcy5lbGVtZW50Qm94Xy5oZWlnaHQgLSBoZWlnaHQpIC8gMiksXG4gICAgICAgIE1hdGgucm91bmQod2lkdGgpLFxuICAgICAgICBNYXRoLnJvdW5kKGhlaWdodCkpO1xuXG4gICAgLy8gQWRqdXN0IG1heCBzY2FsZSB0byBhdCBsZWFzdCBmaXQgdGhlIHNjcmVlbi5cbiAgICBjb25zdCBlbGVtZW50Qm94UmF0aW8gPSB0aGlzLmVsZW1lbnRCb3hfLndpZHRoIC9cbiAgICAgdGhpcy5lbGVtZW50Qm94Xy5oZWlnaHQ7XG4gICAgY29uc3QgbWF4U2NhbGUgPSBNYXRoLm1heChcbiAgICAgICAgZWxlbWVudEJveFJhdGlvIC8gc291cmNlQXNwZWN0UmF0aW8sXG4gICAgICAgIHNvdXJjZUFzcGVjdFJhdGlvIC8gZWxlbWVudEJveFJhdGlvXG4gICAgKTtcbiAgICB0aGlzLm1heFNjYWxlXyA9IE1hdGgubWF4KHRoaXMubWF4U2NhbGVfLCBtYXhTY2FsZSk7XG5cbiAgICAvLyBSZXNldCB6b29tIGFuZCBwYW4uXG4gICAgdGhpcy5zdGFydFNjYWxlXyA9IHRoaXMuc2NhbGVfID0gdGhpcy5pbml0aWFsU2NhbGVfO1xuICAgIHRoaXMuc3RhcnRYXyA9IHRoaXMucG9zWF8gPSB0aGlzLmluaXRpYWxYXztcbiAgICB0aGlzLnN0YXJ0WV8gPSB0aGlzLnBvc1lfID0gdGhpcy5pbml0aWFsWV87XG4gICAgdGhpcy51cGRhdGVQYW5ab29tQm91bmRzXyh0aGlzLnNjYWxlXyk7XG4gIH1cblxuICAvKipcbiAgICogTWVhc3VyZXMgYW5kIHJlc2V0cyB0aGUgY29udGVudCBkaW1lbnNpb25zLCBhZnRlciB0aGUgZWxlbWVudFxuICAgKiBkaW1lbnNpb25zIGNoYW5nZXMuXG4gICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgKi9cbiAgcmVzZXRDb250ZW50RGltZW5zaW9uc18oKSB7XG4gICAgY29uc3QgY29udGVudCA9IGRldigpLmFzc2VydEVsZW1lbnQodGhpcy5jb250ZW50Xyk7XG4gICAgcmV0dXJuIHRoaXMubWVhc3VyZUVsZW1lbnQoKCkgPT4gdGhpcy5tZWFzdXJlXygpKS50aGVuKCgpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLm11dGF0ZUVsZW1lbnQoKCkgPT4ge1xuICAgICAgICAvLyBTZXQgdGhlIGFjdHVhbCBkaW1lbnNpb25zIG9mIHRoZSBjb250ZW50XG4gICAgICAgIHNldFN0eWxlcyhjb250ZW50LCB7XG4gICAgICAgICAgd2lkdGg6IHB4KHRoaXMuY29udGVudEJveF8ud2lkdGgpLFxuICAgICAgICAgIGhlaWdodDogcHgodGhpcy5jb250ZW50Qm94Xy5oZWlnaHQpLFxuICAgICAgICB9KTtcbiAgICAgICAgLy8gVXBkYXRlIHRyYW5zbGF0aW9uIGFuZCBzY2FsaW5nXG4gICAgICAgIHRoaXMudXBkYXRlUGFuWm9vbV8oKTtcbiAgICAgIH0sIGNvbnRlbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIGNsZWFudXBHZXN0dXJlc18oKSB7XG4gICAgaWYgKHRoaXMuZ2VzdHVyZXNfKSB7XG4gICAgICB0aGlzLmdlc3R1cmVzXy5jbGVhbnVwKCk7XG4gICAgICB0aGlzLmdlc3R1cmVzXyA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdpdmVuIGEgeCBvZmZzZXQgcmVsYXRpdmUgdG8gdGhlIHZpZXdwb3J0LCByZXR1cm4gdGhlIHggb2Zmc2V0XG4gICAqIHJlbGF0aXZlIHRvIHRoZSBhbXAtcGFuLXpvb20gY29tcG9uZW50LlxuICAgKiBAcGFyYW0ge251bWJlcn0gY2xpZW50WFxuICAgKi9cbiAgZ2V0T2Zmc2V0WF8oY2xpZW50WCkge1xuICAgIGNvbnN0IHtsZWZ0fSA9IHRoaXMuZWxlbWVudEJveF87XG4gICAgcmV0dXJuIChsZWZ0IC0gdGhpcy5nZXRWaWV3cG9ydCgpLmdldFNjcm9sbExlZnQoKSkgLSBjbGllbnRYO1xuICB9XG5cbiAgLyoqXG4gICAqIEdpdmVuIGEgeSBvZmZzZXQgcmVsYXRpdmUgdG8gdGhlIHZpZXdwb3J0LCByZXR1cm4gdGhlIHkgb2Zmc2V0XG4gICAqIHJlbGF0aXZlIHRvIHRoZSBhbXAtcGFuLXpvb20gY29tcG9uZW50LlxuICAgKiBAcGFyYW0ge251bWJlcn0gY2xpZW50WVxuICAgKi9cbiAgZ2V0T2Zmc2V0WV8oY2xpZW50WSkge1xuICAgIGNvbnN0IHt0b3B9ID0gdGhpcy5lbGVtZW50Qm94XztcbiAgICByZXR1cm4gKHRvcCAtIHRoaXMuZ2V0Vmlld3BvcnQoKS5nZXRTY3JvbGxUb3AoKSkgLSBjbGllbnRZO1xuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIHNldHVwR2VzdHVyZXNfKCkge1xuICAgIGlmICh0aGlzLmdlc3R1cmVzXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBUT0RPICgjMTI4ODEpOiB0aGlzIGFuZCB0aGUgc3Vic2VxdWVudCB1c2Ugb2YgZXZlbnQucHJldmVudERlZmF1bHRcbiAgICAvLyBpcyBhIHRlbXBvcmFyeSBzb2x1dGlvbiB0byAjMTIzNjIuIFdlIHNob3VsZCByZXZpc2l0IHRoaXMgcHJvYmxlbSBhZnRlclxuICAgIC8vIHJlc29sdmluZyAjMTI4ODEgb3IgY2hhbmdlIHRoZSB1c2Ugb2Ygd2luZG93LmV2ZW50IHRvIHRoZSBzcGVjaWZpYyBldmVudFxuICAgIC8vIHRyaWdnZXJpbmcgdGhlIGdlc3R1cmUuXG4gICAgdGhpcy5nZXN0dXJlc18gPSBHZXN0dXJlcy5nZXQoXG4gICAgICAgIHRoaXMuZWxlbWVudCxcbiAgICAgICAgLyogb3B0X3Nob3VsZE5vdFByZXZlbnREZWZhdWx0ICovIGZhbHNlXG4gICAgKTtcblxuICAgIHRoaXMuZ2VzdHVyZXNfLm9uUG9pbnRlckRvd24oKCkgPT4ge1xuICAgICAgaWYgKHRoaXMubW90aW9uXykge1xuICAgICAgICB0aGlzLm1vdGlvbl8uaGFsdCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gWm9vbWFibGUuXG4gICAgdGhpcy5nZXN0dXJlc18ub25HZXN0dXJlKERvdWJsZXRhcFJlY29nbml6ZXIsIGUgPT4ge1xuICAgICAgY29uc3Qge2NsaWVudFgsIGNsaWVudFl9ID0gZS5kYXRhO1xuICAgICAgY29uc3QgbmV3U2NhbGUgPSB0aGlzLnNjYWxlXyA9PSAxID8gdGhpcy5tYXhTY2FsZV8gOiB0aGlzLm1pblNjYWxlXztcbiAgICAgIGNvbnN0IGRlbHRhWCA9ICh0aGlzLmVsZW1lbnRCb3hfLndpZHRoIC8gMikgKyB0aGlzLmdldE9mZnNldFhfKGNsaWVudFgpO1xuICAgICAgY29uc3QgZGVsdGFZID0gKHRoaXMuZWxlbWVudEJveF8uaGVpZ2h0IC8gMikgKyB0aGlzLmdldE9mZnNldFlfKGNsaWVudFkpO1xuXG4gICAgICB0aGlzLm9uWm9vbV8obmV3U2NhbGUsIGRlbHRhWCwgZGVsdGFZLCAvKmFuaW1hdGUqLyB0cnVlKVxuICAgICAgICAgIC50aGVuKCgpID0+IHRoaXMub25ab29tUmVsZWFzZV8oKSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmdlc3R1cmVzXy5vbkdlc3R1cmUoUGluY2hSZWNvZ25pemVyLCBlID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgY2VudGVyQ2xpZW50WCxcbiAgICAgICAgY2VudGVyQ2xpZW50WSxcbiAgICAgICAgZGVsdGFYLFxuICAgICAgICBkZWx0YVksXG4gICAgICAgIGRpcixcbiAgICAgICAgbGFzdCxcbiAgICAgIH0gPSBlLmRhdGE7XG5cbiAgICAgIHRoaXMub25QaW5jaFpvb21fKGNlbnRlckNsaWVudFgsIGNlbnRlckNsaWVudFksIGRlbHRhWCwgZGVsdGFZLCBkaXIpO1xuICAgICAgaWYgKGxhc3QpIHtcbiAgICAgICAgdGhpcy5vblpvb21SZWxlYXNlXygpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gT3ZlcnJpZGUgYWxsIHRhcHMgdG8gZW5hYmxlIHRhcCBldmVudHMgb24gY29udGVudFxuICAgIHRoaXMuZ2VzdHVyZXNfLm9uR2VzdHVyZShUYXBSZWNvZ25pemVyLCBlID0+IHtcbiAgICAgIGNvbnN0IGV2ZW50ID0gY3JlYXRlQ3VzdG9tRXZlbnQodGhpcy53aW4sICdjbGljaycsIG51bGwsIHtidWJibGVzOiB0cnVlfSk7XG4gICAgICBlLmRhdGEudGFyZ2V0LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVycyBhIFN3aXBlIGdlc3R1cmUgdG8gaGFuZGxlIHBhbm5pbmcgd2hlbiB0aGUgY29udGVudCBpcyB6b29tZWQuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICByZWdpc3RlclBhbm5pbmdHZXN0dXJlXygpIHtcbiAgICAvLyBNb3ZhYmxlLlxuICAgIHRoaXMudW5saXN0ZW5PblN3aXBlUGFuXyA9IHRoaXMuZ2VzdHVyZXNfXG4gICAgICAgIC5vbkdlc3R1cmUoU3dpcGVYWVJlY29nbml6ZXIsIGUgPT4ge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgZGVsdGFYLFxuICAgICAgICAgICAgZGVsdGFZLFxuICAgICAgICAgICAgbGFzdCxcbiAgICAgICAgICAgIHZlbG9jaXR5WCxcbiAgICAgICAgICAgIHZlbG9jaXR5WSxcbiAgICAgICAgICB9ID0gZS5kYXRhO1xuICAgICAgICAgIHRoaXMub25Nb3ZlXyhkZWx0YVgsIGRlbHRhWSwgLyphbmltYXRlKi8gZmFsc2UpO1xuICAgICAgICAgIGlmIChsYXN0KSB7XG4gICAgICAgICAgICB0aGlzLm9uTW92ZVJlbGVhc2VfKHZlbG9jaXR5WCwgdmVsb2NpdHlZKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIERlcmVnaXN0ZXJzIHRoZSBTd2lwZSBnZXN0dXJlIGZvciBwYW5uaW5nIHdoZW4gdGhlIGNvbnRlbnQgaXMgem9vbWVkIG91dC5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHVucmVnaXN0ZXJQYW5uaW5nR2VzdHVyZV8oKSB7XG4gICAgaWYgKHRoaXMudW5saXN0ZW5PblN3aXBlUGFuXykge1xuICAgICAgdGhpcy51bmxpc3Rlbk9uU3dpcGVQYW5fKCk7XG4gICAgICB0aGlzLnVubGlzdGVuT25Td2lwZVBhbl8gPSBudWxsO1xuICAgICAgdGhpcy5nZXN0dXJlc18ucmVtb3ZlR2VzdHVyZShTd2lwZVhZUmVjb2duaXplcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdmFsdWUgYm91bmQgdG8gbWluIGFuZCBtYXggdmFsdWVzICsvLSBleHRlbnQuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZVxuICAgKiBAcGFyYW0ge251bWJlcn0gbWluXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBtYXhcbiAgICogQHBhcmFtIHtudW1iZXJ9IGV4dGVudFxuICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBib3VuZFZhbHVlXyh2YWx1ZSwgbWluLCBtYXgsIGV4dGVudCkge1xuICAgIHJldHVybiBjbGFtcCh2YWx1ZSwgbWluIC0gZXh0ZW50LCBtYXggKyBleHRlbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHNjYWxlIHdpdGhpbiB0aGUgYWxsb3dlZCByYW5nZSB3aXRoIHBvc3NpYmxlIGV4dGVudC5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHNcbiAgICogQHBhcmFtIHtib29sZWFufSBhbGxvd0V4dGVudFxuICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBib3VuZFNjYWxlXyhzLCBhbGxvd0V4dGVudCkge1xuICAgIGNvbnN0IGV4dGVudCA9IGFsbG93RXh0ZW50ID8gMC4yNSA6IDA7XG4gICAgcmV0dXJuIHRoaXMuYm91bmRWYWx1ZV8ocywgdGhpcy5taW5TY2FsZV8sIHRoaXMubWF4U2NhbGVfLCBleHRlbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIFggcG9zaXRpb24gd2l0aGluIHRoZSBhbGxvd2VkIHJhbmdlIHdpdGggcG9zc2libGUgZXh0ZW50LlxuICAgKiBAcGFyYW0ge251bWJlcn0geFxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGFsbG93RXh0ZW50XG4gICAqIEByZXR1cm4ge251bWJlcn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGJvdW5kWF8oeCwgYWxsb3dFeHRlbnQpIHtcbiAgICBjb25zdCBtYXhFeHRlbnQgPSB0aGlzLmVsZW1lbnRCb3hfLndpZHRoICogMC4yNTtcbiAgICBjb25zdCBleHRlbnQgPSBhbGxvd0V4dGVudCAmJiB0aGlzLnNjYWxlXyA+IDEgPyBtYXhFeHRlbnQgOiAwO1xuICAgIHJldHVybiB0aGlzLmJvdW5kVmFsdWVfKHgsIHRoaXMubWluWF8sIHRoaXMubWF4WF8sIGV4dGVudCk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgWSBwb3NpdGlvbiB3aXRoaW4gdGhlIGFsbG93ZWQgcmFuZ2Ugd2l0aCBwb3NzaWJsZSBleHRlbnQuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gYWxsb3dFeHRlbnRcbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgYm91bmRZXyh5LCBhbGxvd0V4dGVudCkge1xuICAgIGNvbnN0IG1heEV4dGVudCA9IHRoaXMuZWxlbWVudEJveF8uaGVpZ2h0ICogMC4yNTtcbiAgICBjb25zdCBleHRlbnQgPSBhbGxvd0V4dGVudCAmJiB0aGlzLnNjYWxlXyA+IDEgPyBtYXhFeHRlbnQgOiAwO1xuICAgIHJldHVybiB0aGlzLmJvdW5kVmFsdWVfKHksIHRoaXMubWluWV8sIHRoaXMubWF4WV8sIGV4dGVudCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyBYL1kgYm91bmRzIGJhc2VkIG9uIHRoZSBwcm92aWRlZCBzY2FsZSB2YWx1ZS4gVGhlIG1pbi9tYXggYm91bmRzXG4gICAqIGFyZSBjYWxjdWxhdGVkIHRvIGFsbG93IGZ1bGwgcGFuIG9mIHRoZSBjb250ZW50IHJlZ2FyZGxlc3Mgb2YgdGhlIHNjYWxlXG4gICAqIHZhbHVlLlxuICAgKiBAcGFyYW0ge251bWJlcn0gc2NhbGVcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHVwZGF0ZVBhblpvb21Cb3VuZHNfKHNjYWxlKSB7XG4gICAgY29uc3QgZGggPSB0aGlzLmVsZW1lbnRCb3hfLmhlaWdodCAtICh0aGlzLmNvbnRlbnRCb3hfLmhlaWdodCAqIHNjYWxlKTtcbiAgICBjb25zdCBkdyA9IHRoaXMuZWxlbWVudEJveF8ud2lkdGggLSAodGhpcy5jb250ZW50Qm94Xy53aWR0aCAqIHNjYWxlKTtcblxuICAgIGNvbnN0IG1pblkgPSBkaCA+PSAwID8gMCA6IGRoIC8gMjtcbiAgICBjb25zdCBtYXhZID0gZGggPj0gMCA/IDAgOiAtbWluWTtcbiAgICBjb25zdCBtaW5YID0gZHcgPj0gMCA/IDAgOiBkdyAvIDI7XG4gICAgY29uc3QgbWF4WCA9IGR3ID49IDAgPyAwIDogLW1pblg7XG5cbiAgICB0aGlzLm1pblhfID0gbWluWDtcbiAgICB0aGlzLm1pbllfID0gbWluWTtcbiAgICB0aGlzLm1heFhfID0gbWF4WDtcbiAgICB0aGlzLm1heFlfID0gbWF4WTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHBhbi96b29tIG9mIHRoZSBjb250ZW50IGJhc2VkIG9uIHRoZSBjdXJyZW50IHZhbHVlcy5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHVwZGF0ZVBhblpvb21fKCkge1xuICAgIGNvbnN0IHtzY2FsZV86IHMsIHBvc1hfOiB4LCBwb3NZXzogeSwgY29udGVudF86IGNvbnRlbnR9ID0gdGhpcztcbiAgICB0aGlzLm11dGF0ZUVsZW1lbnQoKCkgPT4ge1xuICAgICAgc2V0U3R5bGVzKGRldigpLmFzc2VydEVsZW1lbnQoY29udGVudCksIHtcbiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoeCwgeSkgKyAnICcgKyBzY2FsZShzKSxcbiAgICAgIH0pO1xuICAgIH0sIGNvbnRlbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBzY2FsZVxuICAgKiBAcGFyYW0ge251bWJlcn0geFxuICAgKiBAcGFyYW0ge251bWJlcn0geVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdHJpZ2dlclRyYW5zZm9ybUVuZF8oc2NhbGUsIHgsIHkpIHtcbiAgICBjb25zdCB0cmFuc2Zvcm1FbmRFdmVudCA9XG4gICAgY3JlYXRlQ3VzdG9tRXZlbnQodGhpcy53aW4sIGAke1RBR30udHJhbnNmb3JtRW5kYCwgZGljdCh7XG4gICAgICAnc2NhbGUnOiBzY2FsZSxcbiAgICAgICd4JzogeCxcbiAgICAgICd5JzogeSxcbiAgICB9KSk7XG4gICAgdGhpcy5hY3Rpb25fLnRyaWdnZXIodGhpcy5lbGVtZW50LCAndHJhbnNmb3JtRW5kJywgdHJhbnNmb3JtRW5kRXZlbnQsXG4gICAgICAgIEFjdGlvblRydXN0LkhJR0gpO1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGEgb25lLXN0ZXAgb3IgYW4gYW5pbWF0ZWQgbW90aW9uIChwYW5uaW5nKS5cbiAgICogQHBhcmFtIHtudW1iZXJ9IGRlbHRhWFxuICAgKiBAcGFyYW0ge251bWJlcn0gZGVsdGFZXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gYW5pbWF0ZVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgb25Nb3ZlXyhkZWx0YVgsIGRlbHRhWSwgYW5pbWF0ZSkge1xuICAgIGNvbnN0IG5ld1Bvc1ggPSB0aGlzLmJvdW5kWF8odGhpcy5zdGFydFhfICsgZGVsdGFYLCBmYWxzZSk7XG4gICAgY29uc3QgbmV3UG9zWSA9IHRoaXMuYm91bmRZXyh0aGlzLnN0YXJ0WV8gKyBkZWx0YVksIGZhbHNlKTtcbiAgICB0aGlzLnNldF8odGhpcy5zY2FsZV8sIG5ld1Bvc1gsIG5ld1Bvc1ksIGFuaW1hdGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGFjdGlvbnMgb25jZSB0aGUgbW90aW9uIGdlc3R1cmUgaGFzIGJlZW4gY29tcGxldGUuIFRoZSBtb3Rpb25cbiAgICogbWF5IGNvbnRpbnVlIGJhc2VkIG9uIHRoZSBmaW5hbCB2ZWxvY2l0eS5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHZlbG9YXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB2ZWxvWVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgb25Nb3ZlUmVsZWFzZV8odmVsb1gsIHZlbG9ZKSB7XG4gICAgLy8gQ29udGludWUgbW90aW9uLlxuICAgIHRoaXMubW90aW9uXyA9IGNvbnRpbnVlTW90aW9uKGRldigpLmFzc2VydEVsZW1lbnQodGhpcy5jb250ZW50XyksXG4gICAgICAgIHRoaXMucG9zWF8sIHRoaXMucG9zWV8sIHZlbG9YLCB2ZWxvWSxcbiAgICAgICAgKHgsIHkpID0+IHtcbiAgICAgICAgICBjb25zdCBuZXdQb3NYID0gdGhpcy5ib3VuZFhfKHgsIGZhbHNlKTtcbiAgICAgICAgICBjb25zdCBuZXdQb3NZID0gdGhpcy5ib3VuZFlfKHksIGZhbHNlKTtcbiAgICAgICAgICBpZiAoTWF0aC5hYnMobmV3UG9zWCAtIHRoaXMucG9zWF8pIDwgMSAmJlxuICAgICAgICAgICAgICAgIE1hdGguYWJzKG5ld1Bvc1kgLSB0aGlzLnBvc1lfKSA8IDEpIHtcbiAgICAgICAgICAgIC8vIEhpdCB0aGUgd2FsbDogc3RvcCBtb3Rpb24uXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuc2V0Xyh0aGlzLnNjYWxlXywgbmV3UG9zWCwgbmV3UG9zWSwgZmFsc2UpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcblxuICAgIC8vIFNuYXAgYmFjay5cbiAgICB0aGlzLm1vdGlvbl8udGhlbkFsd2F5cygoKSA9PiB7XG4gICAgICB0aGlzLm1vdGlvbl8gPSBudWxsO1xuICAgICAgcmV0dXJuIHRoaXMucmVsZWFzZV8oKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBhIG9uZS1zdGVwIHBpbmNoIHpvb20gYWN0aW9uLlxuICAgKiBAcGFyYW0ge251bWJlcn0gY2VudGVyQ2xpZW50WFxuICAgKiBAcGFyYW0ge251bWJlcn0gY2VudGVyQ2xpZW50WVxuICAgKiBAcGFyYW0ge251bWJlcn0gZGVsdGFYXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBkZWx0YVlcbiAgICogIEBwYXJhbSB7bnVtYmVyfSBkaXJcbiAgICogQHByaXZhdGVcbiAgICovXG4gIG9uUGluY2hab29tXyhjZW50ZXJDbGllbnRYLCBjZW50ZXJDbGllbnRZLCBkZWx0YVgsIGRlbHRhWSwgZGlyKSB7XG4gICAgdGhpcy56b29tVG9Qb2ludF8oY2VudGVyQ2xpZW50WCwgY2VudGVyQ2xpZW50WSwgZGVsdGFYLCBkZWx0YVksIGRpcik7XG4gIH1cblxuICAvKipcbiAgICogR2l2ZW4gY2VudGVyIHBvc2l0aW9uLCB6b29tIGRlbHRhLCBhbmQgem9vbSBwb3NpdGlvbiwgY29tcHV0ZXNcbiAgICogYW5kIHVwZGF0ZXMgYSB6b29tIGFjdGlvbiBvbiB0aGUgY29udGVudC5cbiAgICogQHBhcmFtIHtudW1iZXJ9IGNlbnRlckNsaWVudFhcbiAgICogQHBhcmFtIHtudW1iZXJ9IGNlbnRlckNsaWVudFlcbiAgICogQHBhcmFtIHtudW1iZXJ9IGRlbHRhWFxuICAgKiBAcGFyYW0ge251bWJlcn0gZGVsdGFZXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBkaXJcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHpvb21Ub1BvaW50XyhjZW50ZXJDbGllbnRYLCBjZW50ZXJDbGllbnRZLCBkZWx0YVgsIGRlbHRhWSwgZGlyKSB7XG4gICAgaWYgKGRpciA9PSAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGRpc3QgPSBNYXRoLnNxcnQoKGRlbHRhWCAqIGRlbHRhWCkgKyAoZGVsdGFZICogZGVsdGFZKSk7XG4gICAgY29uc3QgbmV3U2NhbGUgPSB0aGlzLnN0YXJ0U2NhbGVfICogKDEgKyAoZGlyICogZGlzdCAvIDEwMCkpO1xuICAgIGNvbnN0IGRlbHRhQ2VudGVyWCA9ICh0aGlzLmVsZW1lbnRCb3hfLndpZHRoIC8gMikgLSBjZW50ZXJDbGllbnRYO1xuICAgIGNvbnN0IGRlbHRhQ2VudGVyWSA9ICh0aGlzLmVsZW1lbnRCb3hfLmhlaWdodCAvIDIpIC0gY2VudGVyQ2xpZW50WTtcbiAgICBkZWx0YVggPSBNYXRoLm1pbihkZWx0YUNlbnRlclgsIGRlbHRhQ2VudGVyWCAqIChkaXN0IC8gMTAwKSk7XG4gICAgZGVsdGFZID0gTWF0aC5taW4oZGVsdGFDZW50ZXJZLCBkZWx0YUNlbnRlclkgKiAoZGlzdCAvIDEwMCkpO1xuICAgIHRoaXMub25ab29tXyhuZXdTY2FsZSwgZGVsdGFYLCBkZWx0YVksIC8qYW5pbWF0ZSovIGZhbHNlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBhIG9uZS1zdGVwIG9yIGFuIGFuaW1hdGVkIHpvb20gYWN0aW9uLlxuICAgKiBAcGFyYW0ge251bWJlcn0gc2NhbGVcbiAgICogQHBhcmFtIHtudW1iZXJ9IGRlbHRhWFxuICAgKiBAcGFyYW0ge251bWJlcn0gZGVsdGFZXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gYW5pbWF0ZVxuICAgKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIG9uWm9vbV8oc2NhbGUsIGRlbHRhWCwgZGVsdGFZLCBhbmltYXRlKSB7XG4gICAgY29uc3QgbmV3U2NhbGUgPSB0aGlzLmJvdW5kU2NhbGVfKHNjYWxlLCB0cnVlKTtcbiAgICBpZiAobmV3U2NhbGUgPT0gdGhpcy5zY2FsZV8pIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG5cbiAgICB0aGlzLnVwZGF0ZVBhblpvb21Cb3VuZHNfKG5ld1NjYWxlKTtcblxuICAgIGNvbnN0IG5ld1Bvc1ggPSB0aGlzLmJvdW5kWF8odGhpcy5zdGFydFhfICsgKGRlbHRhWCAqIG5ld1NjYWxlKSwgZmFsc2UpO1xuICAgIGNvbnN0IG5ld1Bvc1kgPSB0aGlzLmJvdW5kWV8odGhpcy5zdGFydFlfICsgKGRlbHRhWSAqIG5ld1NjYWxlKSwgZmFsc2UpO1xuICAgIHJldHVybiB0aGlzLnNldF8obmV3U2NhbGUsIG5ld1Bvc1gsIG5ld1Bvc1ksIGFuaW1hdGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGFjdGlvbnMgYWZ0ZXIgdGhlIGdlc3R1cmUgdGhhdCB3YXMgcGVyZm9ybWluZyB6b29taW5nIGhhcyBiZWVuXG4gICAqIHJlbGVhc2VkLlxuICAgKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIG9uWm9vbVJlbGVhc2VfKCkge1xuICAgIHJldHVybiB0aGlzLnJlbGVhc2VfKCkudGhlbigoKSA9PiB7XG4gICAgICAvLyBBZnRlciB0aGUgc2NhbGUgaXMgdXBkYXRlZCwgYWxzbyByZWdpc3RlciBvciB1bnJlZ2lzdGVyIHBhbm5pbmdcbiAgICAgIGlmICh0aGlzLnNjYWxlXyA8PSAxKSB7XG4gICAgICAgIHRoaXMudW5yZWdpc3RlclBhbm5pbmdHZXN0dXJlXygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5yZWdpc3RlclBhbm5pbmdHZXN0dXJlXygpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgb3IgYW5pbWF0ZXMgcGFuL3pvb20gcGFyYW1ldGVycy5cbiAgICogQHBhcmFtIHtudW1iZXJ9IG5ld1NjYWxlXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBuZXdQb3NYXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBuZXdQb3NZXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gYW5pbWF0ZVxuICAgKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHNldF8obmV3U2NhbGUsIG5ld1Bvc1gsIG5ld1Bvc1ksIGFuaW1hdGUpIHtcbiAgICBjb25zdCBkcyA9IG5ld1NjYWxlIC0gdGhpcy5zY2FsZV87XG4gICAgY29uc3QgZHggPSBuZXdQb3NYIC0gdGhpcy5wb3NYXztcbiAgICBjb25zdCBkeSA9IG5ld1Bvc1kgLSB0aGlzLnBvc1lfO1xuICAgIGNvbnN0IGRpc3QgPSBNYXRoLnNxcnQoKGR4ICogZHgpICsgKGR5ICogZHkpKTtcblxuICAgIGNvbnN0IGR1ciA9IGFuaW1hdGUgP1xuICAgICAgTWF0aC5taW4oMSwgTWF0aC5tYXgoXG4gICAgICAgICAgZGlzdCAqIDAuMDEsIC8vIERpc3RhbmNlXG4gICAgICAgICAgTWF0aC5hYnMoZHMpIC8vIENoYW5nZSBpbiBzY2FsZVxuICAgICAgKSkgKiBNQVhfQU5JTUFUSU9OX0RVUkFUSU9OIDogMDtcblxuICAgIGlmIChkdXIgPiAxNiAmJiBhbmltYXRlKSB7XG4gICAgICBjb25zdCBzY2FsZUZ1bmMgPSBudW1lcmljKHRoaXMuc2NhbGVfLCBuZXdTY2FsZSk7XG4gICAgICBjb25zdCB4RnVuYyA9IG51bWVyaWModGhpcy5wb3NYXywgbmV3UG9zWCk7XG4gICAgICBjb25zdCB5RnVuYyA9IG51bWVyaWModGhpcy5wb3NZXywgbmV3UG9zWSk7XG4gICAgICByZXR1cm4gQW5pbWF0aW9uLmFuaW1hdGUoZGV2KCkuYXNzZXJ0RWxlbWVudCh0aGlzLmNvbnRlbnRfKSwgdGltZSA9PiB7XG4gICAgICAgIHRoaXMuc2NhbGVfID0gc2NhbGVGdW5jKHRpbWUpO1xuICAgICAgICB0aGlzLnBvc1hfID0geEZ1bmModGltZSk7XG4gICAgICAgIHRoaXMucG9zWV8gPSB5RnVuYyh0aW1lKTtcbiAgICAgICAgdGhpcy51cGRhdGVQYW5ab29tXygpO1xuICAgICAgfSwgZHVyLCBQQU5fWk9PTV9DVVJWRV8pLnRoZW5BbHdheXMoKCkgPT4ge1xuICAgICAgICB0aGlzLnNjYWxlXyA9IG5ld1NjYWxlO1xuICAgICAgICB0aGlzLnBvc1hfID0gbmV3UG9zWDtcbiAgICAgICAgdGhpcy5wb3NZXyA9IG5ld1Bvc1k7XG4gICAgICAgIHRoaXMudXBkYXRlUGFuWm9vbV8oKTtcbiAgICAgICAgdGhpcy50cmlnZ2VyVHJhbnNmb3JtRW5kXyhuZXdTY2FsZSwgbmV3UG9zWCwgbmV3UG9zWSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zY2FsZV8gPSBuZXdTY2FsZTtcbiAgICAgIHRoaXMucG9zWF8gPSBuZXdQb3NYO1xuICAgICAgdGhpcy5wb3NZXyA9IG5ld1Bvc1k7XG4gICAgICB0aGlzLnVwZGF0ZVBhblpvb21fKCk7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgb3IgYW5pbWF0ZXMgcGFuL3pvb20gcGFyYW1ldGVycyBhZnRlciByZWxlYXNlIG9mIHRoZSBnZXN0dXJlLlxuICAgKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHJlbGVhc2VfKCkge1xuICAgIGNvbnN0IG5ld1NjYWxlID0gdGhpcy5ib3VuZFNjYWxlXyh0aGlzLnNjYWxlXywgZmFsc2UpO1xuICAgIGlmIChuZXdTY2FsZSAhPSB0aGlzLnNjYWxlXykge1xuICAgICAgdGhpcy51cGRhdGVQYW5ab29tQm91bmRzXyhuZXdTY2FsZSk7XG4gICAgfVxuICAgIGNvbnN0IG5ld1Bvc1ggPSB0aGlzLmJvdW5kWF8odGhpcy5wb3NYXyAvIHRoaXMuc2NhbGVfICogbmV3U2NhbGUsIGZhbHNlKTtcbiAgICBjb25zdCBuZXdQb3NZID0gdGhpcy5ib3VuZFlfKHRoaXMucG9zWV8gLyB0aGlzLnNjYWxlXyAqIG5ld1NjYWxlLCBmYWxzZSk7XG4gICAgcmV0dXJuIHRoaXMuc2V0XyhuZXdTY2FsZSwgbmV3UG9zWCwgbmV3UG9zWSwgdHJ1ZSkudGhlbigoKSA9PiB7XG4gICAgICB0aGlzLnN0YXJ0U2NhbGVfID0gdGhpcy5zY2FsZV87XG4gICAgICB0aGlzLnN0YXJ0WF8gPSB0aGlzLnBvc1hfO1xuICAgICAgdGhpcy5zdGFydFlfID0gdGhpcy5wb3NZXztcbiAgICAgIHRoaXMudHJpZ2dlclRyYW5zZm9ybUVuZF8odGhpcy5zY2FsZV8sIHRoaXMucG9zWF8sIHRoaXMucG9zWV8pO1xuICAgIH0pO1xuICB9XG59XG5cbkFNUC5leHRlbnNpb24oVEFHLCAnMC4xJywgQU1QID0+IHtcbiAgQU1QLnJlZ2lzdGVyRWxlbWVudChUQUcsIEFtcFBhblpvb20sIENTUyk7XG59KTtcbiIsIi8qIVxuXG5Db3B5cmlnaHQgKEMpIDIwMTQtMjAxNiBieSBBbmRyZWEgR2lhbW1hcmNoaSAtIEBXZWJSZWZsZWN0aW9uXG5cblBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbm9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbmluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbnRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbmNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbmFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG5JTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbkZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbk9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cblRIRSBTT0ZUV0FSRS5cblxuKi9cbi8vIGdsb2JhbCB3aW5kb3cgT2JqZWN0XG4vLyBvcHRpb25hbCBwb2x5ZmlsbCBpbmZvXG4vLyAgICAnYXV0bycgdXNlZCBieSBkZWZhdWx0LCBldmVyeXRoaW5nIGlzIGZlYXR1cmUgZGV0ZWN0ZWRcbi8vICAgICdmb3JjZScgdXNlIHRoZSBwb2x5ZmlsbCBldmVuIGlmIG5vdCBmdWxseSBuZWVkZWRcbmZ1bmN0aW9uIGluc3RhbGxDdXN0b21FbGVtZW50cyh3aW5kb3csIHBvbHlmaWxsKSB7J3VzZSBzdHJpY3QnO1xuXG4gIC8vIERPIE5PVCBVU0UgVEhJUyBGSUxFIERJUkVDVExZLCBJVCBXT04nVCBXT1JLXG4gIC8vIFRISVMgSVMgQSBQUk9KRUNUIEJBU0VEIE9OIEEgQlVJTEQgU1lTVEVNXG4gIC8vIFRISVMgRklMRSBJUyBKVVNUIFdSQVBQRUQgVVAgUkVTVUxUSU5HIElOXG4gIC8vIGJ1aWxkL2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQubm9kZS5qc1xuXG4gIHZhclxuICAgIGRvY3VtZW50ID0gd2luZG93LmRvY3VtZW50LFxuICAgIE9iamVjdCA9IHdpbmRvdy5PYmplY3RcbiAgO1xuXG4gIHZhciBodG1sQ2xhc3MgPSAoZnVuY3Rpb24gKGluZm8pIHtcbiAgICAvLyAoQykgQW5kcmVhIEdpYW1tYXJjaGkgLSBAV2ViUmVmbGVjdGlvbiAtIE1JVCBTdHlsZVxuICAgIHZhclxuICAgICAgY2F0Y2hDbGFzcyA9IC9eW0EtWl0rW2Etel0vLFxuICAgICAgZmlsdGVyQnkgPSBmdW5jdGlvbiAocmUpIHtcbiAgICAgICAgdmFyIGFyciA9IFtdLCB0YWc7XG4gICAgICAgIGZvciAodGFnIGluIHJlZ2lzdGVyKSB7XG4gICAgICAgICAgaWYgKHJlLnRlc3QodGFnKSkgYXJyLnB1c2godGFnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyO1xuICAgICAgfSxcbiAgICAgIGFkZCA9IGZ1bmN0aW9uIChDbGFzcywgdGFnKSB7XG4gICAgICAgIHRhZyA9IHRhZy50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAoISh0YWcgaW4gcmVnaXN0ZXIpKSB7XG4gICAgICAgICAgcmVnaXN0ZXJbQ2xhc3NdID0gKHJlZ2lzdGVyW0NsYXNzXSB8fCBbXSkuY29uY2F0KHRhZyk7XG4gICAgICAgICAgcmVnaXN0ZXJbdGFnXSA9IChyZWdpc3Rlclt0YWcudG9VcHBlckNhc2UoKV0gPSBDbGFzcyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICByZWdpc3RlciA9IChPYmplY3QuY3JlYXRlIHx8IE9iamVjdCkobnVsbCksXG4gICAgICBodG1sQ2xhc3MgPSB7fSxcbiAgICAgIGksIHNlY3Rpb24sIHRhZ3MsIENsYXNzXG4gICAgO1xuICAgIGZvciAoc2VjdGlvbiBpbiBpbmZvKSB7XG4gICAgICBmb3IgKENsYXNzIGluIGluZm9bc2VjdGlvbl0pIHtcbiAgICAgICAgdGFncyA9IGluZm9bc2VjdGlvbl1bQ2xhc3NdO1xuICAgICAgICByZWdpc3RlcltDbGFzc10gPSB0YWdzO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGFncy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHJlZ2lzdGVyW3RhZ3NbaV0udG9Mb3dlckNhc2UoKV0gPVxuICAgICAgICAgIHJlZ2lzdGVyW3RhZ3NbaV0udG9VcHBlckNhc2UoKV0gPSBDbGFzcztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBodG1sQ2xhc3MuZ2V0ID0gZnVuY3Rpb24gZ2V0KHRhZ09yQ2xhc3MpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdGFnT3JDbGFzcyA9PT0gJ3N0cmluZycgP1xuICAgICAgICAocmVnaXN0ZXJbdGFnT3JDbGFzc10gfHwgKGNhdGNoQ2xhc3MudGVzdCh0YWdPckNsYXNzKSA/IFtdIDogJycpKSA6XG4gICAgICAgIGZpbHRlckJ5KHRhZ09yQ2xhc3MpO1xuICAgIH07XG4gICAgaHRtbENsYXNzLnNldCA9IGZ1bmN0aW9uIHNldCh0YWcsIENsYXNzKSB7XG4gICAgICByZXR1cm4gKGNhdGNoQ2xhc3MudGVzdCh0YWcpID9cbiAgICAgICAgYWRkKHRhZywgQ2xhc3MpIDpcbiAgICAgICAgYWRkKENsYXNzLCB0YWcpXG4gICAgICApLCBodG1sQ2xhc3M7XG4gICAgfTtcbiAgICByZXR1cm4gaHRtbENsYXNzO1xuICB9KHtcbiAgICBcImNvbGxlY3Rpb25zXCI6IHtcbiAgICAgIFwiSFRNTEFsbENvbGxlY3Rpb25cIjogW1xuICAgICAgICBcImFsbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQ29sbGVjdGlvblwiOiBbXG4gICAgICAgIFwiZm9ybXNcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEZvcm1Db250cm9sc0NvbGxlY3Rpb25cIjogW1xuICAgICAgICBcImVsZW1lbnRzXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxPcHRpb25zQ29sbGVjdGlvblwiOiBbXG4gICAgICAgIFwib3B0aW9uc1wiXG4gICAgICBdXG4gICAgfSxcbiAgICBcImVsZW1lbnRzXCI6IHtcbiAgICAgIFwiRWxlbWVudFwiOiBbXG4gICAgICAgIFwiZWxlbWVudFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQW5jaG9yRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQXBwbGV0RWxlbWVudFwiOiBbXG4gICAgICAgIFwiYXBwbGV0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxBcmVhRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYXJlYVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQXR0YWNobWVudEVsZW1lbnRcIjogW1xuICAgICAgICBcImF0dGFjaG1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEF1ZGlvRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYXVkaW9cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEJSRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYnJcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEJhc2VFbGVtZW50XCI6IFtcbiAgICAgICAgXCJiYXNlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxCb2R5RWxlbWVudFwiOiBbXG4gICAgICAgIFwiYm9keVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQnV0dG9uRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYnV0dG9uXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxDYW52YXNFbGVtZW50XCI6IFtcbiAgICAgICAgXCJjYW52YXNcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTENvbnRlbnRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJjb250ZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxETGlzdEVsZW1lbnRcIjogW1xuICAgICAgICBcImRsXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxEYXRhRWxlbWVudFwiOiBbXG4gICAgICAgIFwiZGF0YVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGF0YUxpc3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkYXRhbGlzdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGV0YWlsc0VsZW1lbnRcIjogW1xuICAgICAgICBcImRldGFpbHNcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERpYWxvZ0VsZW1lbnRcIjogW1xuICAgICAgICBcImRpYWxvZ1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGlyZWN0b3J5RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZGlyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxEaXZFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkaXZcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERvY3VtZW50XCI6IFtcbiAgICAgICAgXCJkb2N1bWVudFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRWxlbWVudFwiOiBbXG4gICAgICAgIFwiZWxlbWVudFwiLFxuICAgICAgICBcImFiYnJcIixcbiAgICAgICAgXCJhZGRyZXNzXCIsXG4gICAgICAgIFwiYXJ0aWNsZVwiLFxuICAgICAgICBcImFzaWRlXCIsXG4gICAgICAgIFwiYlwiLFxuICAgICAgICBcImJkaVwiLFxuICAgICAgICBcImJkb1wiLFxuICAgICAgICBcImNpdGVcIixcbiAgICAgICAgXCJjb2RlXCIsXG4gICAgICAgIFwiY29tbWFuZFwiLFxuICAgICAgICBcImRkXCIsXG4gICAgICAgIFwiZGZuXCIsXG4gICAgICAgIFwiZHRcIixcbiAgICAgICAgXCJlbVwiLFxuICAgICAgICBcImZpZ2NhcHRpb25cIixcbiAgICAgICAgXCJmaWd1cmVcIixcbiAgICAgICAgXCJmb290ZXJcIixcbiAgICAgICAgXCJoZWFkZXJcIixcbiAgICAgICAgXCJpXCIsXG4gICAgICAgIFwia2JkXCIsXG4gICAgICAgIFwibWFya1wiLFxuICAgICAgICBcIm5hdlwiLFxuICAgICAgICBcIm5vc2NyaXB0XCIsXG4gICAgICAgIFwicnBcIixcbiAgICAgICAgXCJydFwiLFxuICAgICAgICBcInJ1YnlcIixcbiAgICAgICAgXCJzXCIsXG4gICAgICAgIFwic2FtcFwiLFxuICAgICAgICBcInNlY3Rpb25cIixcbiAgICAgICAgXCJzbWFsbFwiLFxuICAgICAgICBcInN0cm9uZ1wiLFxuICAgICAgICBcInN1YlwiLFxuICAgICAgICBcInN1bW1hcnlcIixcbiAgICAgICAgXCJzdXBcIixcbiAgICAgICAgXCJ1XCIsXG4gICAgICAgIFwidmFyXCIsXG4gICAgICAgIFwid2JyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxFbWJlZEVsZW1lbnRcIjogW1xuICAgICAgICBcImVtYmVkXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGaWVsZFNldEVsZW1lbnRcIjogW1xuICAgICAgICBcImZpZWxkc2V0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGb250RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZm9udFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRm9ybUVsZW1lbnRcIjogW1xuICAgICAgICBcImZvcm1cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEZyYW1lRWxlbWVudFwiOiBbXG4gICAgICAgIFwiZnJhbWVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEZyYW1lU2V0RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZnJhbWVzZXRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEhSRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaHJcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEhlYWRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJoZWFkXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxIZWFkaW5nRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaDFcIixcbiAgICAgICAgXCJoMlwiLFxuICAgICAgICBcImgzXCIsXG4gICAgICAgIFwiaDRcIixcbiAgICAgICAgXCJoNVwiLFxuICAgICAgICBcImg2XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxIdG1sRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaHRtbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSUZyYW1lRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaWZyYW1lXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxJbWFnZUVsZW1lbnRcIjogW1xuICAgICAgICBcImltZ1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSW5wdXRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJpbnB1dFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MS2V5Z2VuRWxlbWVudFwiOiBbXG4gICAgICAgIFwia2V5Z2VuXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxMSUVsZW1lbnRcIjogW1xuICAgICAgICBcImxpXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxMYWJlbEVsZW1lbnRcIjogW1xuICAgICAgICBcImxhYmVsXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxMZWdlbmRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJsZWdlbmRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTExpbmtFbGVtZW50XCI6IFtcbiAgICAgICAgXCJsaW5rXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNYXBFbGVtZW50XCI6IFtcbiAgICAgICAgXCJtYXBcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1hcnF1ZWVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJtYXJxdWVlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNZWRpYUVsZW1lbnRcIjogW1xuICAgICAgICBcIm1lZGlhXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNZW51RWxlbWVudFwiOiBbXG4gICAgICAgIFwibWVudVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWVudUl0ZW1FbGVtZW50XCI6IFtcbiAgICAgICAgXCJtZW51aXRlbVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWV0YUVsZW1lbnRcIjogW1xuICAgICAgICBcIm1ldGFcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1ldGVyRWxlbWVudFwiOiBbXG4gICAgICAgIFwibWV0ZXJcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1vZEVsZW1lbnRcIjogW1xuICAgICAgICBcImRlbFwiLFxuICAgICAgICBcImluc1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT0xpc3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJvbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT2JqZWN0RWxlbWVudFwiOiBbXG4gICAgICAgIFwib2JqZWN0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxPcHRHcm91cEVsZW1lbnRcIjogW1xuICAgICAgICBcIm9wdGdyb3VwXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxPcHRpb25FbGVtZW50XCI6IFtcbiAgICAgICAgXCJvcHRpb25cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE91dHB1dEVsZW1lbnRcIjogW1xuICAgICAgICBcIm91dHB1dFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUGFyYWdyYXBoRWxlbWVudFwiOiBbXG4gICAgICAgIFwicFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUGFyYW1FbGVtZW50XCI6IFtcbiAgICAgICAgXCJwYXJhbVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUGljdHVyZUVsZW1lbnRcIjogW1xuICAgICAgICBcInBpY3R1cmVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFByZUVsZW1lbnRcIjogW1xuICAgICAgICBcInByZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUHJvZ3Jlc3NFbGVtZW50XCI6IFtcbiAgICAgICAgXCJwcm9ncmVzc1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MUXVvdGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJibG9ja3F1b3RlXCIsXG4gICAgICAgIFwicVwiLFxuICAgICAgICBcInF1b3RlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxTY3JpcHRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJzY3JpcHRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFNlbGVjdEVsZW1lbnRcIjogW1xuICAgICAgICBcInNlbGVjdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU2hhZG93RWxlbWVudFwiOiBbXG4gICAgICAgIFwic2hhZG93XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxTbG90RWxlbWVudFwiOiBbXG4gICAgICAgIFwic2xvdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU291cmNlRWxlbWVudFwiOiBbXG4gICAgICAgIFwic291cmNlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxTcGFuRWxlbWVudFwiOiBbXG4gICAgICAgIFwic3BhblwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU3R5bGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJzdHlsZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVDYXB0aW9uRWxlbWVudFwiOiBbXG4gICAgICAgIFwiY2FwdGlvblwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVDZWxsRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGRcIixcbiAgICAgICAgXCJ0aFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVDb2xFbGVtZW50XCI6IFtcbiAgICAgICAgXCJjb2xcIixcbiAgICAgICAgXCJjb2xncm91cFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0YWJsZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVSb3dFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0clwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGFibGVTZWN0aW9uRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGhlYWRcIixcbiAgICAgICAgXCJ0Ym9keVwiLFxuICAgICAgICBcInRmb290XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxUZW1wbGF0ZUVsZW1lbnRcIjogW1xuICAgICAgICBcInRlbXBsYXRlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxUZXh0QXJlYUVsZW1lbnRcIjogW1xuICAgICAgICBcInRleHRhcmVhXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxUaW1lRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGltZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGl0bGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0aXRsZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVHJhY2tFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0cmFja1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVUxpc3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ1bFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVW5rbm93bkVsZW1lbnRcIjogW1xuICAgICAgICBcInVua25vd25cIixcbiAgICAgICAgXCJ2aGdyb3VwdlwiLFxuICAgICAgICBcInZrZXlnZW5cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFZpZGVvRWxlbWVudFwiOiBbXG4gICAgICAgIFwidmlkZW9cIlxuICAgICAgXVxuICAgIH0sXG4gICAgXCJub2Rlc1wiOiB7XG4gICAgICBcIkF0dHJcIjogW1xuICAgICAgICBcIm5vZGVcIlxuICAgICAgXSxcbiAgICAgIFwiQXVkaW9cIjogW1xuICAgICAgICBcImF1ZGlvXCJcbiAgICAgIF0sXG4gICAgICBcIkNEQVRBU2VjdGlvblwiOiBbXG4gICAgICAgIFwibm9kZVwiXG4gICAgICBdLFxuICAgICAgXCJDaGFyYWN0ZXJEYXRhXCI6IFtcbiAgICAgICAgXCJub2RlXCJcbiAgICAgIF0sXG4gICAgICBcIkNvbW1lbnRcIjogW1xuICAgICAgICBcIiNjb21tZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkRvY3VtZW50XCI6IFtcbiAgICAgICAgXCIjZG9jdW1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiRG9jdW1lbnRGcmFnbWVudFwiOiBbXG4gICAgICAgIFwiI2RvY3VtZW50LWZyYWdtZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkRvY3VtZW50VHlwZVwiOiBbXG4gICAgICAgIFwibm9kZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRG9jdW1lbnRcIjogW1xuICAgICAgICBcIiNkb2N1bWVudFwiXG4gICAgICBdLFxuICAgICAgXCJJbWFnZVwiOiBbXG4gICAgICAgIFwiaW1nXCJcbiAgICAgIF0sXG4gICAgICBcIk9wdGlvblwiOiBbXG4gICAgICAgIFwib3B0aW9uXCJcbiAgICAgIF0sXG4gICAgICBcIlByb2Nlc3NpbmdJbnN0cnVjdGlvblwiOiBbXG4gICAgICAgIFwibm9kZVwiXG4gICAgICBdLFxuICAgICAgXCJTaGFkb3dSb290XCI6IFtcbiAgICAgICAgXCIjc2hhZG93LXJvb3RcIlxuICAgICAgXSxcbiAgICAgIFwiVGV4dFwiOiBbXG4gICAgICAgIFwiI3RleHRcIlxuICAgICAgXSxcbiAgICAgIFwiWE1MRG9jdW1lbnRcIjogW1xuICAgICAgICBcInhtbFwiXG4gICAgICBdXG4gICAgfVxuICB9KSk7XG4gIFxuICBcbiAgICBcbiAgLy8gcGFzc2VkIGF0IHJ1bnRpbWUsIGNvbmZpZ3VyYWJsZVxuICAvLyB2aWEgbm9kZWpzIG1vZHVsZVxuICBpZiAoIXBvbHlmaWxsKSBwb2x5ZmlsbCA9ICdhdXRvJztcbiAgXG4gIHZhclxuICAgIC8vIFYwIHBvbHlmaWxsIGVudHJ5XG4gICAgUkVHSVNURVJfRUxFTUVOVCA9ICdyZWdpc3RlckVsZW1lbnQnLFxuICBcbiAgICAvLyBJRSA8IDExIG9ubHkgKyBvbGQgV2ViS2l0IGZvciBhdHRyaWJ1dGVzICsgZmVhdHVyZSBkZXRlY3Rpb25cbiAgICBFWFBBTkRPX1VJRCA9ICdfXycgKyBSRUdJU1RFUl9FTEVNRU5UICsgKHdpbmRvdy5NYXRoLnJhbmRvbSgpICogMTBlNCA+PiAwKSxcbiAgXG4gICAgLy8gc2hvcnRjdXRzIGFuZCBjb3N0YW50c1xuICAgIEFERF9FVkVOVF9MSVNURU5FUiA9ICdhZGRFdmVudExpc3RlbmVyJyxcbiAgICBBVFRBQ0hFRCA9ICdhdHRhY2hlZCcsXG4gICAgQ0FMTEJBQ0sgPSAnQ2FsbGJhY2snLFxuICAgIERFVEFDSEVEID0gJ2RldGFjaGVkJyxcbiAgICBFWFRFTkRTID0gJ2V4dGVuZHMnLFxuICBcbiAgICBBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDSyA9ICdhdHRyaWJ1dGVDaGFuZ2VkJyArIENBTExCQUNLLFxuICAgIEFUVEFDSEVEX0NBTExCQUNLID0gQVRUQUNIRUQgKyBDQUxMQkFDSyxcbiAgICBDT05ORUNURURfQ0FMTEJBQ0sgPSAnY29ubmVjdGVkJyArIENBTExCQUNLLFxuICAgIERJU0NPTk5FQ1RFRF9DQUxMQkFDSyA9ICdkaXNjb25uZWN0ZWQnICsgQ0FMTEJBQ0ssXG4gICAgQ1JFQVRFRF9DQUxMQkFDSyA9ICdjcmVhdGVkJyArIENBTExCQUNLLFxuICAgIERFVEFDSEVEX0NBTExCQUNLID0gREVUQUNIRUQgKyBDQUxMQkFDSyxcbiAgXG4gICAgQURESVRJT04gPSAnQURESVRJT04nLFxuICAgIE1PRElGSUNBVElPTiA9ICdNT0RJRklDQVRJT04nLFxuICAgIFJFTU9WQUwgPSAnUkVNT1ZBTCcsXG4gIFxuICAgIERPTV9BVFRSX01PRElGSUVEID0gJ0RPTUF0dHJNb2RpZmllZCcsXG4gICAgRE9NX0NPTlRFTlRfTE9BREVEID0gJ0RPTUNvbnRlbnRMb2FkZWQnLFxuICAgIERPTV9TVUJUUkVFX01PRElGSUVEID0gJ0RPTVN1YnRyZWVNb2RpZmllZCcsXG4gIFxuICAgIFBSRUZJWF9UQUcgPSAnPCcsXG4gICAgUFJFRklYX0lTID0gJz0nLFxuICBcbiAgICAvLyB2YWxpZCBhbmQgaW52YWxpZCBub2RlIG5hbWVzXG4gICAgdmFsaWROYW1lID0gL15bQS1aXVtBLVowLTldKig/Oi1bQS1aMC05XSspKyQvLFxuICAgIGludmFsaWROYW1lcyA9IFtcbiAgICAgICdBTk5PVEFUSU9OLVhNTCcsXG4gICAgICAnQ09MT1ItUFJPRklMRScsXG4gICAgICAnRk9OVC1GQUNFJyxcbiAgICAgICdGT05ULUZBQ0UtU1JDJyxcbiAgICAgICdGT05ULUZBQ0UtVVJJJyxcbiAgICAgICdGT05ULUZBQ0UtRk9STUFUJyxcbiAgICAgICdGT05ULUZBQ0UtTkFNRScsXG4gICAgICAnTUlTU0lORy1HTFlQSCdcbiAgICBdLFxuICBcbiAgICAvLyByZWdpc3RlcmVkIHR5cGVzIGFuZCB0aGVpciBwcm90b3R5cGVzXG4gICAgdHlwZXMgPSBbXSxcbiAgICBwcm90b3MgPSBbXSxcbiAgXG4gICAgLy8gdG8gcXVlcnkgc3Vibm9kZXNcbiAgICBxdWVyeSA9ICcnLFxuICBcbiAgICAvLyBodG1sIHNob3J0Y3V0IHVzZWQgdG8gZmVhdHVyZSBkZXRlY3RcbiAgICBkb2N1bWVudEVsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsXG4gIFxuICAgIC8vIEVTNSBpbmxpbmUgaGVscGVycyB8fCBiYXNpYyBwYXRjaGVzXG4gICAgaW5kZXhPZiA9IHR5cGVzLmluZGV4T2YgfHwgZnVuY3Rpb24gKHYpIHtcbiAgICAgIGZvcih2YXIgaSA9IHRoaXMubGVuZ3RoOyBpLS0gJiYgdGhpc1tpXSAhPT0gdjspe31cbiAgICAgIHJldHVybiBpO1xuICAgIH0sXG4gIFxuICAgIC8vIG90aGVyIGhlbHBlcnMgLyBzaG9ydGN1dHNcbiAgICBPUCA9IE9iamVjdC5wcm90b3R5cGUsXG4gICAgaE9QID0gT1AuaGFzT3duUHJvcGVydHksXG4gICAgaVBPID0gT1AuaXNQcm90b3R5cGVPZixcbiAgXG4gICAgZGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHksXG4gICAgZW1wdHkgPSBbXSxcbiAgICBnT1BEID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcixcbiAgICBnT1BOID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMsXG4gICAgZ1BPID0gT2JqZWN0LmdldFByb3RvdHlwZU9mLFxuICAgIHNQTyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZixcbiAgXG4gICAgLy8ganNoaW50IHByb3RvOiB0cnVlXG4gICAgaGFzUHJvdG8gPSAhIU9iamVjdC5fX3Byb3RvX18sXG4gIFxuICAgIC8vIFYxIGhlbHBlcnNcbiAgICBmaXhHZXRDbGFzcyA9IGZhbHNlLFxuICAgIERSRUNFVjEgPSAnX19kcmVDRXYxJyxcbiAgICBjdXN0b21FbGVtZW50cyA9IHdpbmRvdy5jdXN0b21FbGVtZW50cyxcbiAgICB1c2FibGVDdXN0b21FbGVtZW50cyA9IHBvbHlmaWxsICE9PSAnZm9yY2UnICYmICEhKFxuICAgICAgY3VzdG9tRWxlbWVudHMgJiZcbiAgICAgIGN1c3RvbUVsZW1lbnRzLmRlZmluZSAmJlxuICAgICAgY3VzdG9tRWxlbWVudHMuZ2V0ICYmXG4gICAgICBjdXN0b21FbGVtZW50cy53aGVuRGVmaW5lZFxuICAgICksXG4gICAgRGljdCA9IE9iamVjdC5jcmVhdGUgfHwgT2JqZWN0LFxuICAgIE1hcCA9IHdpbmRvdy5NYXAgfHwgZnVuY3Rpb24gTWFwKCkge1xuICAgICAgdmFyIEsgPSBbXSwgViA9IFtdLCBpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoaykge1xuICAgICAgICAgIHJldHVybiBWW2luZGV4T2YuY2FsbChLLCBrKV07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGssIHYpIHtcbiAgICAgICAgICBpID0gaW5kZXhPZi5jYWxsKEssIGspO1xuICAgICAgICAgIGlmIChpIDwgMCkgVltLLnB1c2goaykgLSAxXSA9IHY7XG4gICAgICAgICAgZWxzZSBWW2ldID0gdjtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9LFxuICAgIFByb21pc2UgPSB3aW5kb3cuUHJvbWlzZSB8fCBmdW5jdGlvbiAoZm4pIHtcbiAgICAgIHZhclxuICAgICAgICBub3RpZnkgPSBbXSxcbiAgICAgICAgZG9uZSA9IGZhbHNlLFxuICAgICAgICBwID0ge1xuICAgICAgICAgICdjYXRjaCc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBwO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ3RoZW4nOiBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgICAgIG5vdGlmeS5wdXNoKGNiKTtcbiAgICAgICAgICAgIGlmIChkb25lKSBzZXRUaW1lb3V0KHJlc29sdmUsIDEpO1xuICAgICAgICAgICAgcmV0dXJuIHA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICA7XG4gICAgICBmdW5jdGlvbiByZXNvbHZlKHZhbHVlKSB7XG4gICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICB3aGlsZSAobm90aWZ5Lmxlbmd0aCkgbm90aWZ5LnNoaWZ0KCkodmFsdWUpO1xuICAgICAgfVxuICAgICAgZm4ocmVzb2x2ZSk7XG4gICAgICByZXR1cm4gcDtcbiAgICB9LFxuICAgIGp1c3RDcmVhdGVkID0gZmFsc2UsXG4gICAgY29uc3RydWN0b3JzID0gRGljdChudWxsKSxcbiAgICB3YWl0aW5nTGlzdCA9IERpY3QobnVsbCksXG4gICAgbm9kZU5hbWVzID0gbmV3IE1hcCgpLFxuICAgIHNlY29uZEFyZ3VtZW50ID0gZnVuY3Rpb24gKGlzKSB7XG4gICAgICByZXR1cm4gaXMudG9Mb3dlckNhc2UoKTtcbiAgICB9LFxuICBcbiAgICAvLyB1c2VkIHRvIGNyZWF0ZSB1bmlxdWUgaW5zdGFuY2VzXG4gICAgY3JlYXRlID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiBCcmlkZ2UocHJvdG8pIHtcbiAgICAgIC8vIHNpbGx5IGJyb2tlbiBwb2x5ZmlsbCBwcm9iYWJseSBldmVyIHVzZWQgYnV0IHNob3J0IGVub3VnaCB0byB3b3JrXG4gICAgICByZXR1cm4gcHJvdG8gPyAoKEJyaWRnZS5wcm90b3R5cGUgPSBwcm90byksIG5ldyBCcmlkZ2UoKSkgOiB0aGlzO1xuICAgIH0sXG4gIFxuICAgIC8vIHdpbGwgc2V0IHRoZSBwcm90b3R5cGUgaWYgcG9zc2libGVcbiAgICAvLyBvciBjb3B5IG92ZXIgYWxsIHByb3BlcnRpZXNcbiAgICBzZXRQcm90b3R5cGUgPSBzUE8gfHwgKFxuICAgICAgaGFzUHJvdG8gP1xuICAgICAgICBmdW5jdGlvbiAobywgcCkge1xuICAgICAgICAgIG8uX19wcm90b19fID0gcDtcbiAgICAgICAgICByZXR1cm4gbztcbiAgICAgICAgfSA6IChcbiAgICAgIChnT1BOICYmIGdPUEQpID9cbiAgICAgICAgKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgZnVuY3Rpb24gc2V0UHJvcGVydGllcyhvLCBwKSB7XG4gICAgICAgICAgICBmb3IgKHZhclxuICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgIG5hbWVzID0gZ09QTihwKSxcbiAgICAgICAgICAgICAgaSA9IDAsIGxlbmd0aCA9IG5hbWVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgaSA8IGxlbmd0aDsgaSsrXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAga2V5ID0gbmFtZXNbaV07XG4gICAgICAgICAgICAgIGlmICghaE9QLmNhbGwobywga2V5KSkge1xuICAgICAgICAgICAgICAgIGRlZmluZVByb3BlcnR5KG8sIGtleSwgZ09QRChwLCBrZXkpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG8sIHApIHtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgc2V0UHJvcGVydGllcyhvLCBwKTtcbiAgICAgICAgICAgIH0gd2hpbGUgKChwID0gZ1BPKHApKSAmJiAhaVBPLmNhbGwocCwgbykpO1xuICAgICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgICAgfTtcbiAgICAgICAgfSgpKSA6XG4gICAgICAgIGZ1bmN0aW9uIChvLCBwKSB7XG4gICAgICAgICAgZm9yICh2YXIga2V5IGluIHApIHtcbiAgICAgICAgICAgIG9ba2V5XSA9IHBba2V5XTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgIH1cbiAgICApKSxcbiAgXG4gICAgLy8gRE9NIHNob3J0Y3V0cyBhbmQgaGVscGVycywgaWYgYW55XG4gIFxuICAgIE11dGF0aW9uT2JzZXJ2ZXIgPSB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fFxuICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlcixcbiAgXG4gICAgSFRNTEVsZW1lbnRQcm90b3R5cGUgPSAoXG4gICAgICB3aW5kb3cuSFRNTEVsZW1lbnQgfHxcbiAgICAgIHdpbmRvdy5FbGVtZW50IHx8XG4gICAgICB3aW5kb3cuTm9kZVxuICAgICkucHJvdG90eXBlLFxuICBcbiAgICBJRTggPSAhaVBPLmNhbGwoSFRNTEVsZW1lbnRQcm90b3R5cGUsIGRvY3VtZW50RWxlbWVudCksXG4gIFxuICAgIHNhZmVQcm9wZXJ0eSA9IElFOCA/IGZ1bmN0aW9uIChvLCBrLCBkKSB7XG4gICAgICBvW2tdID0gZC52YWx1ZTtcbiAgICAgIHJldHVybiBvO1xuICAgIH0gOiBkZWZpbmVQcm9wZXJ0eSxcbiAgXG4gICAgaXNWYWxpZE5vZGUgPSBJRTggP1xuICAgICAgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IDE7XG4gICAgICB9IDpcbiAgICAgIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHJldHVybiBpUE8uY2FsbChIVE1MRWxlbWVudFByb3RvdHlwZSwgbm9kZSk7XG4gICAgICB9LFxuICBcbiAgICB0YXJnZXRzID0gSUU4ICYmIFtdLFxuICBcbiAgICBhdHRhY2hTaGFkb3cgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5hdHRhY2hTaGFkb3csXG4gICAgY2xvbmVOb2RlID0gSFRNTEVsZW1lbnRQcm90b3R5cGUuY2xvbmVOb2RlLFxuICAgIGRpc3BhdGNoRXZlbnQgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5kaXNwYXRjaEV2ZW50LFxuICAgIGdldEF0dHJpYnV0ZSA9IEhUTUxFbGVtZW50UHJvdG90eXBlLmdldEF0dHJpYnV0ZSxcbiAgICBoYXNBdHRyaWJ1dGUgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5oYXNBdHRyaWJ1dGUsXG4gICAgcmVtb3ZlQXR0cmlidXRlID0gSFRNTEVsZW1lbnRQcm90b3R5cGUucmVtb3ZlQXR0cmlidXRlLFxuICAgIHNldEF0dHJpYnV0ZSA9IEhUTUxFbGVtZW50UHJvdG90eXBlLnNldEF0dHJpYnV0ZSxcbiAgXG4gICAgLy8gcmVwbGFjZWQgbGF0ZXIgb25cbiAgICBjcmVhdGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCxcbiAgICBwYXRjaGVkQ3JlYXRlRWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQsXG4gIFxuICAgIC8vIHNoYXJlZCBvYnNlcnZlciBmb3IgYWxsIGF0dHJpYnV0ZXNcbiAgICBhdHRyaWJ1dGVzT2JzZXJ2ZXIgPSBNdXRhdGlvbk9ic2VydmVyICYmIHtcbiAgICAgIGF0dHJpYnV0ZXM6IHRydWUsXG4gICAgICBjaGFyYWN0ZXJEYXRhOiB0cnVlLFxuICAgICAgYXR0cmlidXRlT2xkVmFsdWU6IHRydWVcbiAgICB9LFxuICBcbiAgICAvLyB1c2VmdWwgdG8gZGV0ZWN0IG9ubHkgaWYgdGhlcmUncyBubyBNdXRhdGlvbk9ic2VydmVyXG4gICAgRE9NQXR0ck1vZGlmaWVkID0gTXV0YXRpb25PYnNlcnZlciB8fCBmdW5jdGlvbihlKSB7XG4gICAgICBkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCA9IGZhbHNlO1xuICAgICAgZG9jdW1lbnRFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgIERPTV9BVFRSX01PRElGSUVELFxuICAgICAgICBET01BdHRyTW9kaWZpZWRcbiAgICAgICk7XG4gICAgfSxcbiAgXG4gICAgLy8gd2lsbCBib3RoIGJlIHVzZWQgdG8gbWFrZSBET01Ob2RlSW5zZXJ0ZWQgYXN5bmNocm9ub3VzXG4gICAgYXNhcFF1ZXVlLFxuICAgIGFzYXBUaW1lciA9IDAsXG4gIFxuICAgIC8vIGludGVybmFsIGZsYWdzXG4gICAgVjAgPSBSRUdJU1RFUl9FTEVNRU5UIGluIGRvY3VtZW50LFxuICAgIHNldExpc3RlbmVyID0gdHJ1ZSxcbiAgICBqdXN0U2V0dXAgPSBmYWxzZSxcbiAgICBkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCA9IHRydWUsXG4gICAgZHJvcERvbUNvbnRlbnRMb2FkZWQgPSB0cnVlLFxuICBcbiAgICAvLyBuZWVkZWQgZm9yIHRoZSBpbm5lckhUTUwgaGVscGVyXG4gICAgbm90RnJvbUlubmVySFRNTEhlbHBlciA9IHRydWUsXG4gIFxuICAgIC8vIG9wdGlvbmFsbHkgZGVmaW5lZCBsYXRlciBvblxuICAgIG9uU3VidHJlZU1vZGlmaWVkLFxuICAgIGNhbGxET01BdHRyTW9kaWZpZWQsXG4gICAgZ2V0QXR0cmlidXRlc01pcnJvcixcbiAgICBvYnNlcnZlcixcbiAgICBvYnNlcnZlLFxuICBcbiAgICAvLyBiYXNlZCBvbiBzZXR0aW5nIHByb3RvdHlwZSBjYXBhYmlsaXR5XG4gICAgLy8gd2lsbCBjaGVjayBwcm90byBvciB0aGUgZXhwYW5kbyBhdHRyaWJ1dGVcbiAgICAvLyBpbiBvcmRlciB0byBzZXR1cCB0aGUgbm9kZSBvbmNlXG4gICAgcGF0Y2hJZk5vdEFscmVhZHksXG4gICAgcGF0Y2hcbiAgO1xuICBcbiAgLy8gb25seSBpZiBuZWVkZWRcbiAgaWYgKCFWMCkge1xuICBcbiAgICBpZiAoc1BPIHx8IGhhc1Byb3RvKSB7XG4gICAgICAgIHBhdGNoSWZOb3RBbHJlYWR5ID0gZnVuY3Rpb24gKG5vZGUsIHByb3RvKSB7XG4gICAgICAgICAgaWYgKCFpUE8uY2FsbChwcm90bywgbm9kZSkpIHtcbiAgICAgICAgICAgIHNldHVwTm9kZShub2RlLCBwcm90byk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBwYXRjaCA9IHNldHVwTm9kZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBwYXRjaElmTm90QWxyZWFkeSA9IGZ1bmN0aW9uIChub2RlLCBwcm90bykge1xuICAgICAgICAgIGlmICghbm9kZVtFWFBBTkRPX1VJRF0pIHtcbiAgICAgICAgICAgIG5vZGVbRVhQQU5ET19VSURdID0gT2JqZWN0KHRydWUpO1xuICAgICAgICAgICAgc2V0dXBOb2RlKG5vZGUsIHByb3RvKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHBhdGNoID0gcGF0Y2hJZk5vdEFscmVhZHk7XG4gICAgfVxuICBcbiAgICBpZiAoSUU4KSB7XG4gICAgICBkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCA9IGZhbHNlO1xuICAgICAgKGZ1bmN0aW9uICgpe1xuICAgICAgICB2YXJcbiAgICAgICAgICBkZXNjcmlwdG9yID0gZ09QRChIVE1MRWxlbWVudFByb3RvdHlwZSwgQUREX0VWRU5UX0xJU1RFTkVSKSxcbiAgICAgICAgICBhZGRFdmVudExpc3RlbmVyID0gZGVzY3JpcHRvci52YWx1ZSxcbiAgICAgICAgICBwYXRjaGVkUmVtb3ZlQXR0cmlidXRlID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIHZhciBlID0gbmV3IEN1c3RvbUV2ZW50KERPTV9BVFRSX01PRElGSUVELCB7YnViYmxlczogdHJ1ZX0pO1xuICAgICAgICAgICAgZS5hdHRyTmFtZSA9IG5hbWU7XG4gICAgICAgICAgICBlLnByZXZWYWx1ZSA9IGdldEF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUpO1xuICAgICAgICAgICAgZS5uZXdWYWx1ZSA9IG51bGw7XG4gICAgICAgICAgICBlW1JFTU9WQUxdID0gZS5hdHRyQ2hhbmdlID0gMjtcbiAgICAgICAgICAgIHJlbW92ZUF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUpO1xuICAgICAgICAgICAgZGlzcGF0Y2hFdmVudC5jYWxsKHRoaXMsIGUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgcGF0Y2hlZFNldEF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICAgICAgdmFyXG4gICAgICAgICAgICAgIGhhZCA9IGhhc0F0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUpLFxuICAgICAgICAgICAgICBvbGQgPSBoYWQgJiYgZ2V0QXR0cmlidXRlLmNhbGwodGhpcywgbmFtZSksXG4gICAgICAgICAgICAgIGUgPSBuZXcgQ3VzdG9tRXZlbnQoRE9NX0FUVFJfTU9ESUZJRUQsIHtidWJibGVzOiB0cnVlfSlcbiAgICAgICAgICAgIDtcbiAgICAgICAgICAgIHNldEF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgIGUuYXR0ck5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgZS5wcmV2VmFsdWUgPSBoYWQgPyBvbGQgOiBudWxsO1xuICAgICAgICAgICAgZS5uZXdWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgaWYgKGhhZCkge1xuICAgICAgICAgICAgICBlW01PRElGSUNBVElPTl0gPSBlLmF0dHJDaGFuZ2UgPSAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZVtBRERJVElPTl0gPSBlLmF0dHJDaGFuZ2UgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGlzcGF0Y2hFdmVudC5jYWxsKHRoaXMsIGUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgb25Qcm9wZXJ0eUNoYW5nZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAvLyBqc2hpbnQgZXFudWxsOnRydWVcbiAgICAgICAgICAgIHZhclxuICAgICAgICAgICAgICBub2RlID0gZS5jdXJyZW50VGFyZ2V0LFxuICAgICAgICAgICAgICBzdXBlclNlY3JldCA9IG5vZGVbRVhQQU5ET19VSURdLFxuICAgICAgICAgICAgICBwcm9wZXJ0eU5hbWUgPSBlLnByb3BlcnR5TmFtZSxcbiAgICAgICAgICAgICAgZXZlbnRcbiAgICAgICAgICAgIDtcbiAgICAgICAgICAgIGlmIChzdXBlclNlY3JldC5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eU5hbWUpKSB7XG4gICAgICAgICAgICAgIHN1cGVyU2VjcmV0ID0gc3VwZXJTZWNyZXRbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgICAgICAgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoRE9NX0FUVFJfTU9ESUZJRUQsIHtidWJibGVzOiB0cnVlfSk7XG4gICAgICAgICAgICAgIGV2ZW50LmF0dHJOYW1lID0gc3VwZXJTZWNyZXQubmFtZTtcbiAgICAgICAgICAgICAgZXZlbnQucHJldlZhbHVlID0gc3VwZXJTZWNyZXQudmFsdWUgfHwgbnVsbDtcbiAgICAgICAgICAgICAgZXZlbnQubmV3VmFsdWUgPSAoc3VwZXJTZWNyZXQudmFsdWUgPSBub2RlW3Byb3BlcnR5TmFtZV0gfHwgbnVsbCk7XG4gICAgICAgICAgICAgIGlmIChldmVudC5wcmV2VmFsdWUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGV2ZW50W0FERElUSU9OXSA9IGV2ZW50LmF0dHJDaGFuZ2UgPSAwO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGV2ZW50W01PRElGSUNBVElPTl0gPSBldmVudC5hdHRyQ2hhbmdlID0gMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBkaXNwYXRjaEV2ZW50LmNhbGwobm9kZSwgZXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgO1xuICAgICAgICBkZXNjcmlwdG9yLnZhbHVlID0gZnVuY3Rpb24gKHR5cGUsIGhhbmRsZXIsIGNhcHR1cmUpIHtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICB0eXBlID09PSBET01fQVRUUl9NT0RJRklFRCAmJlxuICAgICAgICAgICAgdGhpc1tBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDS10gJiZcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlICE9PSBwYXRjaGVkU2V0QXR0cmlidXRlXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzW0VYUEFORE9fVUlEXSA9IHtcbiAgICAgICAgICAgICAgY2xhc3NOYW1lOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ2NsYXNzJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5jbGFzc05hbWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlID0gcGF0Y2hlZFNldEF0dHJpYnV0ZTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlID0gcGF0Y2hlZFJlbW92ZUF0dHJpYnV0ZTtcbiAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCAncHJvcGVydHljaGFuZ2UnLCBvblByb3BlcnR5Q2hhbmdlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsIHR5cGUsIGhhbmRsZXIsIGNhcHR1cmUpO1xuICAgICAgICB9O1xuICAgICAgICBkZWZpbmVQcm9wZXJ0eShIVE1MRWxlbWVudFByb3RvdHlwZSwgQUREX0VWRU5UX0xJU1RFTkVSLCBkZXNjcmlwdG9yKTtcbiAgICAgIH0oKSk7XG4gICAgfSBlbHNlIGlmICghTXV0YXRpb25PYnNlcnZlcikge1xuICAgICAgZG9jdW1lbnRFbGVtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oRE9NX0FUVFJfTU9ESUZJRUQsIERPTUF0dHJNb2RpZmllZCk7XG4gICAgICBkb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKEVYUEFORE9fVUlELCAxKTtcbiAgICAgIGRvY3VtZW50RWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoRVhQQU5ET19VSUQpO1xuICAgICAgaWYgKGRvZXNOb3RTdXBwb3J0RE9NQXR0ck1vZGlmaWVkKSB7XG4gICAgICAgIG9uU3VidHJlZU1vZGlmaWVkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICB2YXJcbiAgICAgICAgICAgIG5vZGUgPSB0aGlzLFxuICAgICAgICAgICAgb2xkQXR0cmlidXRlcyxcbiAgICAgICAgICAgIG5ld0F0dHJpYnV0ZXMsXG4gICAgICAgICAgICBrZXlcbiAgICAgICAgICA7XG4gICAgICAgICAgaWYgKG5vZGUgPT09IGUudGFyZ2V0KSB7XG4gICAgICAgICAgICBvbGRBdHRyaWJ1dGVzID0gbm9kZVtFWFBBTkRPX1VJRF07XG4gICAgICAgICAgICBub2RlW0VYUEFORE9fVUlEXSA9IChuZXdBdHRyaWJ1dGVzID0gZ2V0QXR0cmlidXRlc01pcnJvcihub2RlKSk7XG4gICAgICAgICAgICBmb3IgKGtleSBpbiBuZXdBdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgIGlmICghKGtleSBpbiBvbGRBdHRyaWJ1dGVzKSkge1xuICAgICAgICAgICAgICAgIC8vIGF0dHJpYnV0ZSB3YXMgYWRkZWRcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbERPTUF0dHJNb2RpZmllZChcbiAgICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgICBub2RlLFxuICAgICAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICAgICAgb2xkQXR0cmlidXRlc1trZXldLFxuICAgICAgICAgICAgICAgICAgbmV3QXR0cmlidXRlc1trZXldLFxuICAgICAgICAgICAgICAgICAgQURESVRJT05cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5ld0F0dHJpYnV0ZXNba2V5XSAhPT0gb2xkQXR0cmlidXRlc1trZXldKSB7XG4gICAgICAgICAgICAgICAgLy8gYXR0cmlidXRlIHdhcyBjaGFuZ2VkXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxET01BdHRyTW9kaWZpZWQoXG4gICAgICAgICAgICAgICAgICAxLFxuICAgICAgICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgIG9sZEF0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIG5ld0F0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIE1PRElGSUNBVElPTlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNoZWNraW5nIGlmIGl0IGhhcyBiZWVuIHJlbW92ZWRcbiAgICAgICAgICAgIGZvciAoa2V5IGluIG9sZEF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgaWYgKCEoa2V5IGluIG5ld0F0dHJpYnV0ZXMpKSB7XG4gICAgICAgICAgICAgICAgLy8gYXR0cmlidXRlIHJlbW92ZWRcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbERPTUF0dHJNb2RpZmllZChcbiAgICAgICAgICAgICAgICAgIDIsXG4gICAgICAgICAgICAgICAgICBub2RlLFxuICAgICAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICAgICAgb2xkQXR0cmlidXRlc1trZXldLFxuICAgICAgICAgICAgICAgICAgbmV3QXR0cmlidXRlc1trZXldLFxuICAgICAgICAgICAgICAgICAgUkVNT1ZBTFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNhbGxET01BdHRyTW9kaWZpZWQgPSBmdW5jdGlvbiAoXG4gICAgICAgICAgYXR0ckNoYW5nZSxcbiAgICAgICAgICBjdXJyZW50VGFyZ2V0LFxuICAgICAgICAgIGF0dHJOYW1lLFxuICAgICAgICAgIHByZXZWYWx1ZSxcbiAgICAgICAgICBuZXdWYWx1ZSxcbiAgICAgICAgICBhY3Rpb25cbiAgICAgICAgKSB7XG4gICAgICAgICAgdmFyIGUgPSB7XG4gICAgICAgICAgICBhdHRyQ2hhbmdlOiBhdHRyQ2hhbmdlLFxuICAgICAgICAgICAgY3VycmVudFRhcmdldDogY3VycmVudFRhcmdldCxcbiAgICAgICAgICAgIGF0dHJOYW1lOiBhdHRyTmFtZSxcbiAgICAgICAgICAgIHByZXZWYWx1ZTogcHJldlZhbHVlLFxuICAgICAgICAgICAgbmV3VmFsdWU6IG5ld1ZhbHVlXG4gICAgICAgICAgfTtcbiAgICAgICAgICBlW2FjdGlvbl0gPSBhdHRyQ2hhbmdlO1xuICAgICAgICAgIG9uRE9NQXR0ck1vZGlmaWVkKGUpO1xuICAgICAgICB9O1xuICAgICAgICBnZXRBdHRyaWJ1dGVzTWlycm9yID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICBmb3IgKHZhclxuICAgICAgICAgICAgYXR0ciwgbmFtZSxcbiAgICAgICAgICAgIHJlc3VsdCA9IHt9LFxuICAgICAgICAgICAgYXR0cmlidXRlcyA9IG5vZGUuYXR0cmlidXRlcyxcbiAgICAgICAgICAgIGkgPSAwLCBsZW5ndGggPSBhdHRyaWJ1dGVzLmxlbmd0aDtcbiAgICAgICAgICAgIGkgPCBsZW5ndGg7IGkrK1xuICAgICAgICAgICkge1xuICAgICAgICAgICAgYXR0ciA9IGF0dHJpYnV0ZXNbaV07XG4gICAgICAgICAgICBuYW1lID0gYXR0ci5uYW1lO1xuICAgICAgICAgICAgaWYgKG5hbWUgIT09ICdzZXRBdHRyaWJ1dGUnKSB7XG4gICAgICAgICAgICAgIHJlc3VsdFtuYW1lXSA9IGF0dHIudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICBcbiAgICAvLyBzZXQgYXMgZW51bWVyYWJsZSwgd3JpdGFibGUgYW5kIGNvbmZpZ3VyYWJsZVxuICAgIGRvY3VtZW50W1JFR0lTVEVSX0VMRU1FTlRdID0gZnVuY3Rpb24gcmVnaXN0ZXJFbGVtZW50KHR5cGUsIG9wdGlvbnMpIHtcbiAgICAgIHVwcGVyVHlwZSA9IHR5cGUudG9VcHBlckNhc2UoKTtcbiAgICAgIGlmIChzZXRMaXN0ZW5lcikge1xuICAgICAgICAvLyBvbmx5IGZpcnN0IHRpbWUgZG9jdW1lbnQucmVnaXN0ZXJFbGVtZW50IGlzIHVzZWRcbiAgICAgICAgLy8gd2UgbmVlZCB0byBzZXQgdGhpcyBsaXN0ZW5lclxuICAgICAgICAvLyBzZXR0aW5nIGl0IGJ5IGRlZmF1bHQgbWlnaHQgc2xvdyBkb3duIGZvciBubyByZWFzb25cbiAgICAgICAgc2V0TGlzdGVuZXIgPSBmYWxzZTtcbiAgICAgICAgaWYgKE11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAgICAgICBvYnNlcnZlciA9IChmdW5jdGlvbihhdHRhY2hlZCwgZGV0YWNoZWQpe1xuICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tFbUFsbChsaXN0LCBjYWxsYmFjaykge1xuICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gbGlzdC5sZW5ndGg7IGkgPCBsZW5ndGg7IGNhbGxiYWNrKGxpc3RbaSsrXSkpe31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAocmVjb3Jkcykge1xuICAgICAgICAgICAgICBmb3IgKHZhclxuICAgICAgICAgICAgICAgIGN1cnJlbnQsIG5vZGUsIG5ld1ZhbHVlLFxuICAgICAgICAgICAgICAgIGkgPSAwLCBsZW5ndGggPSByZWNvcmRzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrXG4gICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnQgPSByZWNvcmRzW2ldO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50LnR5cGUgPT09ICdjaGlsZExpc3QnKSB7XG4gICAgICAgICAgICAgICAgICBjaGVja0VtQWxsKGN1cnJlbnQuYWRkZWROb2RlcywgYXR0YWNoZWQpO1xuICAgICAgICAgICAgICAgICAgY2hlY2tFbUFsbChjdXJyZW50LnJlbW92ZWROb2RlcywgZGV0YWNoZWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBub2RlID0gY3VycmVudC50YXJnZXQ7XG4gICAgICAgICAgICAgICAgICBpZiAobm90RnJvbUlubmVySFRNTEhlbHBlciAmJlxuICAgICAgICAgICAgICAgICAgICAgIG5vZGVbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdICYmXG4gICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5hdHRyaWJ1dGVOYW1lICE9PSAnc3R5bGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gZ2V0QXR0cmlidXRlLmNhbGwobm9kZSwgY3VycmVudC5hdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld1ZhbHVlICE9PSBjdXJyZW50Lm9sZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgbm9kZVtBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDS10oXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmF0dHJpYnV0ZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Lm9sZFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KGV4ZWN1dGVBY3Rpb24oQVRUQUNIRUQpLCBleGVjdXRlQWN0aW9uKERFVEFDSEVEKSkpO1xuICAgICAgICAgIG9ic2VydmUgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShcbiAgICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzdWJ0cmVlOiB0cnVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIG9ic2VydmUoZG9jdW1lbnQpO1xuICAgICAgICAgIGlmIChhdHRhY2hTaGFkb3cpIHtcbiAgICAgICAgICAgIEhUTUxFbGVtZW50UHJvdG90eXBlLmF0dGFjaFNoYWRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG9ic2VydmUoYXR0YWNoU2hhZG93LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXNhcFF1ZXVlID0gW107XG4gICAgICAgICAgZG9jdW1lbnRbQUREX0VWRU5UX0xJU1RFTkVSXSgnRE9NTm9kZUluc2VydGVkJywgb25ET01Ob2RlKEFUVEFDSEVEKSk7XG4gICAgICAgICAgZG9jdW1lbnRbQUREX0VWRU5UX0xJU1RFTkVSXSgnRE9NTm9kZVJlbW92ZWQnLCBvbkRPTU5vZGUoREVUQUNIRUQpKTtcbiAgICAgICAgfVxuICBcbiAgICAgICAgZG9jdW1lbnRbQUREX0VWRU5UX0xJU1RFTkVSXShET01fQ09OVEVOVF9MT0FERUQsIG9uUmVhZHlTdGF0ZUNoYW5nZSk7XG4gICAgICAgIGRvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oJ3JlYWR5c3RhdGVjaGFuZ2UnLCBvblJlYWR5U3RhdGVDaGFuZ2UpO1xuICBcbiAgICAgICAgSFRNTEVsZW1lbnRQcm90b3R5cGUuY2xvbmVOb2RlID0gZnVuY3Rpb24gKGRlZXApIHtcbiAgICAgICAgICB2YXJcbiAgICAgICAgICAgIG5vZGUgPSBjbG9uZU5vZGUuY2FsbCh0aGlzLCAhIWRlZXApLFxuICAgICAgICAgICAgaSA9IGdldFR5cGVJbmRleChub2RlKVxuICAgICAgICAgIDtcbiAgICAgICAgICBpZiAoLTEgPCBpKSBwYXRjaChub2RlLCBwcm90b3NbaV0pO1xuICAgICAgICAgIGlmIChkZWVwICYmIHF1ZXJ5Lmxlbmd0aCkgbG9vcEFuZFNldHVwKG5vZGUucXVlcnlTZWxlY3RvckFsbChxdWVyeSkpO1xuICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICB9O1xuICAgICAgfVxuICBcbiAgICAgIGlmIChqdXN0U2V0dXApIHJldHVybiAoanVzdFNldHVwID0gZmFsc2UpO1xuICBcbiAgICAgIGlmICgtMiA8IChcbiAgICAgICAgaW5kZXhPZi5jYWxsKHR5cGVzLCBQUkVGSVhfSVMgKyB1cHBlclR5cGUpICtcbiAgICAgICAgaW5kZXhPZi5jYWxsKHR5cGVzLCBQUkVGSVhfVEFHICsgdXBwZXJUeXBlKVxuICAgICAgKSkge1xuICAgICAgICB0aHJvd1R5cGVFcnJvcih0eXBlKTtcbiAgICAgIH1cbiAgXG4gICAgICBpZiAoIXZhbGlkTmFtZS50ZXN0KHVwcGVyVHlwZSkgfHwgLTEgPCBpbmRleE9mLmNhbGwoaW52YWxpZE5hbWVzLCB1cHBlclR5cGUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHR5cGUgJyArIHR5cGUgKyAnIGlzIGludmFsaWQnKTtcbiAgICAgIH1cbiAgXG4gICAgICB2YXJcbiAgICAgICAgY29uc3RydWN0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIGV4dGVuZGluZyA/XG4gICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGVOYW1lLCB1cHBlclR5cGUpIDpcbiAgICAgICAgICAgIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobm9kZU5hbWUpO1xuICAgICAgICB9LFxuICAgICAgICBvcHQgPSBvcHRpb25zIHx8IE9QLFxuICAgICAgICBleHRlbmRpbmcgPSBoT1AuY2FsbChvcHQsIEVYVEVORFMpLFxuICAgICAgICBub2RlTmFtZSA9IGV4dGVuZGluZyA/IG9wdGlvbnNbRVhURU5EU10udG9VcHBlckNhc2UoKSA6IHVwcGVyVHlwZSxcbiAgICAgICAgdXBwZXJUeXBlLFxuICAgICAgICBpXG4gICAgICA7XG4gIFxuICAgICAgaWYgKGV4dGVuZGluZyAmJiAtMSA8IChcbiAgICAgICAgaW5kZXhPZi5jYWxsKHR5cGVzLCBQUkVGSVhfVEFHICsgbm9kZU5hbWUpXG4gICAgICApKSB7XG4gICAgICAgIHRocm93VHlwZUVycm9yKG5vZGVOYW1lKTtcbiAgICAgIH1cbiAgXG4gICAgICBpID0gdHlwZXMucHVzaCgoZXh0ZW5kaW5nID8gUFJFRklYX0lTIDogUFJFRklYX1RBRykgKyB1cHBlclR5cGUpIC0gMTtcbiAgXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmNvbmNhdChcbiAgICAgICAgcXVlcnkubGVuZ3RoID8gJywnIDogJycsXG4gICAgICAgIGV4dGVuZGluZyA/IG5vZGVOYW1lICsgJ1tpcz1cIicgKyB0eXBlLnRvTG93ZXJDYXNlKCkgKyAnXCJdJyA6IG5vZGVOYW1lXG4gICAgICApO1xuICBcbiAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZSA9IChcbiAgICAgICAgcHJvdG9zW2ldID0gaE9QLmNhbGwob3B0LCAncHJvdG90eXBlJykgP1xuICAgICAgICAgIG9wdC5wcm90b3R5cGUgOlxuICAgICAgICAgIGNyZWF0ZShIVE1MRWxlbWVudFByb3RvdHlwZSlcbiAgICAgICk7XG4gIFxuICAgICAgaWYgKHF1ZXJ5Lmxlbmd0aCkgbG9vcEFuZFZlcmlmeShcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChxdWVyeSksXG4gICAgICAgIEFUVEFDSEVEXG4gICAgICApO1xuICBcbiAgICAgIHJldHVybiBjb25zdHJ1Y3RvcjtcbiAgICB9O1xuICBcbiAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50ID0gKHBhdGNoZWRDcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24gKGxvY2FsTmFtZSwgdHlwZUV4dGVuc2lvbikge1xuICAgICAgdmFyXG4gICAgICAgIGlzID0gZ2V0SXModHlwZUV4dGVuc2lvbiksXG4gICAgICAgIG5vZGUgPSBpcyA/XG4gICAgICAgICAgY3JlYXRlRWxlbWVudC5jYWxsKGRvY3VtZW50LCBsb2NhbE5hbWUsIHNlY29uZEFyZ3VtZW50KGlzKSkgOlxuICAgICAgICAgIGNyZWF0ZUVsZW1lbnQuY2FsbChkb2N1bWVudCwgbG9jYWxOYW1lKSxcbiAgICAgICAgbmFtZSA9ICcnICsgbG9jYWxOYW1lLFxuICAgICAgICBpID0gaW5kZXhPZi5jYWxsKFxuICAgICAgICAgIHR5cGVzLFxuICAgICAgICAgIChpcyA/IFBSRUZJWF9JUyA6IFBSRUZJWF9UQUcpICtcbiAgICAgICAgICAoaXMgfHwgbmFtZSkudG9VcHBlckNhc2UoKVxuICAgICAgICApLFxuICAgICAgICBzZXR1cCA9IC0xIDwgaVxuICAgICAgO1xuICAgICAgaWYgKGlzKSB7XG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdpcycsIGlzID0gaXMudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgIGlmIChzZXR1cCkge1xuICAgICAgICAgIHNldHVwID0gaXNJblFTQShuYW1lLnRvVXBwZXJDYXNlKCksIGlzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbm90RnJvbUlubmVySFRNTEhlbHBlciA9ICFkb2N1bWVudC5jcmVhdGVFbGVtZW50LmlubmVySFRNTEhlbHBlcjtcbiAgICAgIGlmIChzZXR1cCkgcGF0Y2gobm9kZSwgcHJvdG9zW2ldKTtcbiAgICAgIHJldHVybiBub2RlO1xuICAgIH0pO1xuICBcbiAgfVxuICBcbiAgZnVuY3Rpb24gQVNBUCgpIHtcbiAgICB2YXIgcXVldWUgPSBhc2FwUXVldWUuc3BsaWNlKDAsIGFzYXBRdWV1ZS5sZW5ndGgpO1xuICAgIGFzYXBUaW1lciA9IDA7XG4gICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCkge1xuICAgICAgcXVldWUuc2hpZnQoKS5jYWxsKFxuICAgICAgICBudWxsLCBxdWV1ZS5zaGlmdCgpXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gbG9vcEFuZFZlcmlmeShsaXN0LCBhY3Rpb24pIHtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gbGlzdC5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmVyaWZ5QW5kU2V0dXBBbmRBY3Rpb24obGlzdFtpXSwgYWN0aW9uKTtcbiAgICB9XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGxvb3BBbmRTZXR1cChsaXN0KSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGxpc3QubGVuZ3RoLCBub2RlOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIG5vZGUgPSBsaXN0W2ldO1xuICAgICAgcGF0Y2gobm9kZSwgcHJvdG9zW2dldFR5cGVJbmRleChub2RlKV0pO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gZXhlY3V0ZUFjdGlvbihhY3Rpb24pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgIGlmIChpc1ZhbGlkTm9kZShub2RlKSkge1xuICAgICAgICB2ZXJpZnlBbmRTZXR1cEFuZEFjdGlvbihub2RlLCBhY3Rpb24pO1xuICAgICAgICBpZiAocXVlcnkubGVuZ3RoKSBsb29wQW5kVmVyaWZ5KFxuICAgICAgICAgIG5vZGUucXVlcnlTZWxlY3RvckFsbChxdWVyeSksXG4gICAgICAgICAgYWN0aW9uXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gZ2V0VHlwZUluZGV4KHRhcmdldCkge1xuICAgIHZhclxuICAgICAgaXMgPSBnZXRBdHRyaWJ1dGUuY2FsbCh0YXJnZXQsICdpcycpLFxuICAgICAgbm9kZU5hbWUgPSB0YXJnZXQubm9kZU5hbWUudG9VcHBlckNhc2UoKSxcbiAgICAgIGkgPSBpbmRleE9mLmNhbGwoXG4gICAgICAgIHR5cGVzLFxuICAgICAgICBpcyA/XG4gICAgICAgICAgICBQUkVGSVhfSVMgKyBpcy50b1VwcGVyQ2FzZSgpIDpcbiAgICAgICAgICAgIFBSRUZJWF9UQUcgKyBub2RlTmFtZVxuICAgICAgKVxuICAgIDtcbiAgICByZXR1cm4gaXMgJiYgLTEgPCBpICYmICFpc0luUVNBKG5vZGVOYW1lLCBpcykgPyAtMSA6IGk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGlzSW5RU0EobmFtZSwgdHlwZSkge1xuICAgIHJldHVybiAtMSA8IHF1ZXJ5LmluZGV4T2YobmFtZSArICdbaXM9XCInICsgdHlwZSArICdcIl0nKTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gb25ET01BdHRyTW9kaWZpZWQoZSkge1xuICAgIHZhclxuICAgICAgbm9kZSA9IGUuY3VycmVudFRhcmdldCxcbiAgICAgIGF0dHJDaGFuZ2UgPSBlLmF0dHJDaGFuZ2UsXG4gICAgICBhdHRyTmFtZSA9IGUuYXR0ck5hbWUsXG4gICAgICB0YXJnZXQgPSBlLnRhcmdldCxcbiAgICAgIGFkZGl0aW9uID0gZVtBRERJVElPTl0gfHwgMixcbiAgICAgIHJlbW92YWwgPSBlW1JFTU9WQUxdIHx8IDNcbiAgICA7XG4gICAgaWYgKG5vdEZyb21Jbm5lckhUTUxIZWxwZXIgJiZcbiAgICAgICAgKCF0YXJnZXQgfHwgdGFyZ2V0ID09PSBub2RlKSAmJlxuICAgICAgICBub2RlW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXSAmJlxuICAgICAgICBhdHRyTmFtZSAhPT0gJ3N0eWxlJyAmJiAoXG4gICAgICAgICAgZS5wcmV2VmFsdWUgIT09IGUubmV3VmFsdWUgfHxcbiAgICAgICAgICAvLyBJRTksIElFMTAsIGFuZCBPcGVyYSAxMiBnb3RjaGFcbiAgICAgICAgICBlLm5ld1ZhbHVlID09PSAnJyAmJiAoXG4gICAgICAgICAgICBhdHRyQ2hhbmdlID09PSBhZGRpdGlvbiB8fFxuICAgICAgICAgICAgYXR0ckNoYW5nZSA9PT0gcmVtb3ZhbFxuICAgICAgICAgIClcbiAgICApKSB7XG4gICAgICBub2RlW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXShcbiAgICAgICAgYXR0ck5hbWUsXG4gICAgICAgIGF0dHJDaGFuZ2UgPT09IGFkZGl0aW9uID8gbnVsbCA6IGUucHJldlZhbHVlLFxuICAgICAgICBhdHRyQ2hhbmdlID09PSByZW1vdmFsID8gbnVsbCA6IGUubmV3VmFsdWVcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiBvbkRPTU5vZGUoYWN0aW9uKSB7XG4gICAgdmFyIGV4ZWN1dG9yID0gZXhlY3V0ZUFjdGlvbihhY3Rpb24pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xuICAgICAgYXNhcFF1ZXVlLnB1c2goZXhlY3V0b3IsIGUudGFyZ2V0KTtcbiAgICAgIGlmIChhc2FwVGltZXIpIGNsZWFyVGltZW91dChhc2FwVGltZXIpO1xuICAgICAgYXNhcFRpbWVyID0gc2V0VGltZW91dChBU0FQLCAxKTtcbiAgICB9O1xuICB9XG4gIFxuICBmdW5jdGlvbiBvblJlYWR5U3RhdGVDaGFuZ2UoZSkge1xuICAgIGlmIChkcm9wRG9tQ29udGVudExvYWRlZCkge1xuICAgICAgZHJvcERvbUNvbnRlbnRMb2FkZWQgPSBmYWxzZTtcbiAgICAgIGUuY3VycmVudFRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKERPTV9DT05URU5UX0xPQURFRCwgb25SZWFkeVN0YXRlQ2hhbmdlKTtcbiAgICB9XG4gICAgaWYgKHF1ZXJ5Lmxlbmd0aCkgbG9vcEFuZFZlcmlmeShcbiAgICAgIChlLnRhcmdldCB8fCBkb2N1bWVudCkucXVlcnlTZWxlY3RvckFsbChxdWVyeSksXG4gICAgICBlLmRldGFpbCA9PT0gREVUQUNIRUQgPyBERVRBQ0hFRCA6IEFUVEFDSEVEXG4gICAgKTtcbiAgICBpZiAoSUU4KSBwdXJnZSgpO1xuICB9XG4gIFxuICBmdW5jdGlvbiBwYXRjaGVkU2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlKSB7XG4gICAgLy8ganNoaW50IHZhbGlkdGhpczp0cnVlXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNldEF0dHJpYnV0ZS5jYWxsKHNlbGYsIG5hbWUsIHZhbHVlKTtcbiAgICBvblN1YnRyZWVNb2RpZmllZC5jYWxsKHNlbGYsIHt0YXJnZXQ6IHNlbGZ9KTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gc2V0dXBOb2RlKG5vZGUsIHByb3RvKSB7XG4gICAgc2V0UHJvdG90eXBlKG5vZGUsIHByb3RvKTtcbiAgICBpZiAob2JzZXJ2ZXIpIHtcbiAgICAgIG9ic2VydmVyLm9ic2VydmUobm9kZSwgYXR0cmlidXRlc09ic2VydmVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGRvZXNOb3RTdXBwb3J0RE9NQXR0ck1vZGlmaWVkKSB7XG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlID0gcGF0Y2hlZFNldEF0dHJpYnV0ZTtcbiAgICAgICAgbm9kZVtFWFBBTkRPX1VJRF0gPSBnZXRBdHRyaWJ1dGVzTWlycm9yKG5vZGUpO1xuICAgICAgICBub2RlW0FERF9FVkVOVF9MSVNURU5FUl0oRE9NX1NVQlRSRUVfTU9ESUZJRUQsIG9uU3VidHJlZU1vZGlmaWVkKTtcbiAgICAgIH1cbiAgICAgIG5vZGVbQUREX0VWRU5UX0xJU1RFTkVSXShET01fQVRUUl9NT0RJRklFRCwgb25ET01BdHRyTW9kaWZpZWQpO1xuICAgIH1cbiAgICBpZiAobm9kZVtDUkVBVEVEX0NBTExCQUNLXSAmJiBub3RGcm9tSW5uZXJIVE1MSGVscGVyKSB7XG4gICAgICBub2RlLmNyZWF0ZWQgPSB0cnVlO1xuICAgICAgbm9kZVtDUkVBVEVEX0NBTExCQUNLXSgpO1xuICAgICAgbm9kZS5jcmVhdGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiBwdXJnZSgpIHtcbiAgICBmb3IgKHZhclxuICAgICAgbm9kZSxcbiAgICAgIGkgPSAwLFxuICAgICAgbGVuZ3RoID0gdGFyZ2V0cy5sZW5ndGg7XG4gICAgICBpIDwgbGVuZ3RoOyBpKytcbiAgICApIHtcbiAgICAgIG5vZGUgPSB0YXJnZXRzW2ldO1xuICAgICAgaWYgKCFkb2N1bWVudEVsZW1lbnQuY29udGFpbnMobm9kZSkpIHtcbiAgICAgICAgbGVuZ3RoLS07XG4gICAgICAgIHRhcmdldHMuc3BsaWNlKGktLSwgMSk7XG4gICAgICAgIHZlcmlmeUFuZFNldHVwQW5kQWN0aW9uKG5vZGUsIERFVEFDSEVEKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHRocm93VHlwZUVycm9yKHR5cGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgJyArIHR5cGUgKyAnIHR5cGUgaXMgYWxyZWFkeSByZWdpc3RlcmVkJyk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHZlcmlmeUFuZFNldHVwQW5kQWN0aW9uKG5vZGUsIGFjdGlvbikge1xuICAgIHZhclxuICAgICAgZm4sXG4gICAgICBpID0gZ2V0VHlwZUluZGV4KG5vZGUpXG4gICAgO1xuICAgIGlmICgtMSA8IGkpIHtcbiAgICAgIHBhdGNoSWZOb3RBbHJlYWR5KG5vZGUsIHByb3Rvc1tpXSk7XG4gICAgICBpID0gMDtcbiAgICAgIGlmIChhY3Rpb24gPT09IEFUVEFDSEVEICYmICFub2RlW0FUVEFDSEVEXSkge1xuICAgICAgICBub2RlW0RFVEFDSEVEXSA9IGZhbHNlO1xuICAgICAgICBub2RlW0FUVEFDSEVEXSA9IHRydWU7XG4gICAgICAgIGkgPSAxO1xuICAgICAgICBpZiAoSUU4ICYmIGluZGV4T2YuY2FsbCh0YXJnZXRzLCBub2RlKSA8IDApIHtcbiAgICAgICAgICB0YXJnZXRzLnB1c2gobm9kZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSBERVRBQ0hFRCAmJiAhbm9kZVtERVRBQ0hFRF0pIHtcbiAgICAgICAgbm9kZVtBVFRBQ0hFRF0gPSBmYWxzZTtcbiAgICAgICAgbm9kZVtERVRBQ0hFRF0gPSB0cnVlO1xuICAgICAgICBpID0gMTtcbiAgICAgIH1cbiAgICAgIGlmIChpICYmIChmbiA9IG5vZGVbYWN0aW9uICsgQ0FMTEJBQ0tdKSkgZm4uY2FsbChub2RlKTtcbiAgICB9XG4gIH1cbiAgXG4gIFxuICBcbiAgLy8gVjEgaW4gZGEgSG91c2UhXG4gIGZ1bmN0aW9uIEN1c3RvbUVsZW1lbnRSZWdpc3RyeSgpIHt9XG4gIFxuICBDdXN0b21FbGVtZW50UmVnaXN0cnkucHJvdG90eXBlID0ge1xuICAgIGNvbnN0cnVjdG9yOiBDdXN0b21FbGVtZW50UmVnaXN0cnksXG4gICAgLy8gYSB3b3JrYXJvdW5kIGZvciB0aGUgc3R1YmJvcm4gV2ViS2l0XG4gICAgZGVmaW5lOiB1c2FibGVDdXN0b21FbGVtZW50cyA/XG4gICAgICBmdW5jdGlvbiAobmFtZSwgQ2xhc3MsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgICAgICBDRVJEZWZpbmUobmFtZSwgQ2xhc3MsIG9wdGlvbnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBOQU1FID0gbmFtZS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgIGNvbnN0cnVjdG9yc1tOQU1FXSA9IHtcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yOiBDbGFzcyxcbiAgICAgICAgICAgIGNyZWF0ZTogW05BTUVdXG4gICAgICAgICAgfTtcbiAgICAgICAgICBub2RlTmFtZXMuc2V0KENsYXNzLCBOQU1FKTtcbiAgICAgICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUobmFtZSwgQ2xhc3MpO1xuICAgICAgICB9XG4gICAgICB9IDpcbiAgICAgIENFUkRlZmluZSxcbiAgICBnZXQ6IHVzYWJsZUN1c3RvbUVsZW1lbnRzID9cbiAgICAgIGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiBjdXN0b21FbGVtZW50cy5nZXQobmFtZSkgfHwgZ2V0KG5hbWUpO1xuICAgICAgfSA6XG4gICAgICBnZXQsXG4gICAgd2hlbkRlZmluZWQ6IHVzYWJsZUN1c3RvbUVsZW1lbnRzID9cbiAgICAgIGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJhY2UoW1xuICAgICAgICAgIGN1c3RvbUVsZW1lbnRzLndoZW5EZWZpbmVkKG5hbWUpLFxuICAgICAgICAgIHdoZW5EZWZpbmVkKG5hbWUpXG4gICAgICAgIF0pO1xuICAgICAgfSA6XG4gICAgICB3aGVuRGVmaW5lZFxuICB9O1xuICBcbiAgZnVuY3Rpb24gQ0VSRGVmaW5lKG5hbWUsIENsYXNzLCBvcHRpb25zKSB7XG4gICAgdmFyXG4gICAgICBpcyA9IG9wdGlvbnMgJiYgb3B0aW9uc1tFWFRFTkRTXSB8fCAnJyxcbiAgICAgIENQcm90byA9IENsYXNzLnByb3RvdHlwZSxcbiAgICAgIHByb3RvID0gY3JlYXRlKENQcm90byksXG4gICAgICBhdHRyaWJ1dGVzID0gQ2xhc3Mub2JzZXJ2ZWRBdHRyaWJ1dGVzIHx8IGVtcHR5LFxuICAgICAgZGVmaW5pdGlvbiA9IHtwcm90b3R5cGU6IHByb3RvfVxuICAgIDtcbiAgICAvLyBUT0RPOiBpcyB0aGlzIG5lZWRlZCBhdCBhbGwgc2luY2UgaXQncyBpbmhlcml0ZWQ/XG4gICAgLy8gZGVmaW5lUHJvcGVydHkocHJvdG8sICdjb25zdHJ1Y3RvcicsIHt2YWx1ZTogQ2xhc3N9KTtcbiAgICBzYWZlUHJvcGVydHkocHJvdG8sIENSRUFURURfQ0FMTEJBQ0ssIHtcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoanVzdENyZWF0ZWQpIGp1c3RDcmVhdGVkID0gZmFsc2U7XG4gICAgICAgICAgZWxzZSBpZiAoIXRoaXNbRFJFQ0VWMV0pIHtcbiAgICAgICAgICAgIHRoaXNbRFJFQ0VWMV0gPSB0cnVlO1xuICAgICAgICAgICAgbmV3IENsYXNzKHRoaXMpO1xuICAgICAgICAgICAgaWYgKENQcm90b1tDUkVBVEVEX0NBTExCQUNLXSlcbiAgICAgICAgICAgICAgQ1Byb3RvW0NSRUFURURfQ0FMTEJBQ0tdLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB2YXIgaW5mbyA9IGNvbnN0cnVjdG9yc1tub2RlTmFtZXMuZ2V0KENsYXNzKV07XG4gICAgICAgICAgICBpZiAoIXVzYWJsZUN1c3RvbUVsZW1lbnRzIHx8IGluZm8uY3JlYXRlLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgbm90aWZ5QXR0cmlidXRlcyh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgc2FmZVByb3BlcnR5KHByb3RvLCBBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDSywge1xuICAgICAgdmFsdWU6IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIGlmICgtMSA8IGluZGV4T2YuY2FsbChhdHRyaWJ1dGVzLCBuYW1lKSlcbiAgICAgICAgICBDUHJvdG9bQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKENQcm90b1tDT05ORUNURURfQ0FMTEJBQ0tdKSB7XG4gICAgICBzYWZlUHJvcGVydHkocHJvdG8sIEFUVEFDSEVEX0NBTExCQUNLLCB7XG4gICAgICAgIHZhbHVlOiBDUHJvdG9bQ09OTkVDVEVEX0NBTExCQUNLXVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChDUHJvdG9bRElTQ09OTkVDVEVEX0NBTExCQUNLXSkge1xuICAgICAgc2FmZVByb3BlcnR5KHByb3RvLCBERVRBQ0hFRF9DQUxMQkFDSywge1xuICAgICAgICB2YWx1ZTogQ1Byb3RvW0RJU0NPTk5FQ1RFRF9DQUxMQkFDS11cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoaXMpIGRlZmluaXRpb25bRVhURU5EU10gPSBpcztcbiAgICBuYW1lID0gbmFtZS50b1VwcGVyQ2FzZSgpO1xuICAgIGNvbnN0cnVjdG9yc1tuYW1lXSA9IHtcbiAgICAgIGNvbnN0cnVjdG9yOiBDbGFzcyxcbiAgICAgIGNyZWF0ZTogaXMgPyBbaXMsIHNlY29uZEFyZ3VtZW50KG5hbWUpXSA6IFtuYW1lXVxuICAgIH07XG4gICAgbm9kZU5hbWVzLnNldChDbGFzcywgbmFtZSk7XG4gICAgZG9jdW1lbnRbUkVHSVNURVJfRUxFTUVOVF0obmFtZS50b0xvd2VyQ2FzZSgpLCBkZWZpbml0aW9uKTtcbiAgICB3aGVuRGVmaW5lZChuYW1lKTtcbiAgICB3YWl0aW5nTGlzdFtuYW1lXS5yKCk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGdldChuYW1lKSB7XG4gICAgdmFyIGluZm8gPSBjb25zdHJ1Y3RvcnNbbmFtZS50b1VwcGVyQ2FzZSgpXTtcbiAgICByZXR1cm4gaW5mbyAmJiBpbmZvLmNvbnN0cnVjdG9yO1xuICB9XG4gIFxuICBmdW5jdGlvbiBnZXRJcyhvcHRpb25zKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBvcHRpb25zID09PSAnc3RyaW5nJyA/XG4gICAgICAgIG9wdGlvbnMgOiAob3B0aW9ucyAmJiBvcHRpb25zLmlzIHx8ICcnKTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gbm90aWZ5QXR0cmlidXRlcyhzZWxmKSB7XG4gICAgdmFyXG4gICAgICBjYWxsYmFjayA9IHNlbGZbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdLFxuICAgICAgYXR0cmlidXRlcyA9IGNhbGxiYWNrID8gc2VsZi5hdHRyaWJ1dGVzIDogZW1wdHksXG4gICAgICBpID0gYXR0cmlidXRlcy5sZW5ndGgsXG4gICAgICBhdHRyaWJ1dGVcbiAgICA7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgYXR0cmlidXRlID0gIGF0dHJpYnV0ZXNbaV07IC8vIHx8IGF0dHJpYnV0ZXMuaXRlbShpKTtcbiAgICAgIGNhbGxiYWNrLmNhbGwoXG4gICAgICAgIHNlbGYsXG4gICAgICAgIGF0dHJpYnV0ZS5uYW1lIHx8IGF0dHJpYnV0ZS5ub2RlTmFtZSxcbiAgICAgICAgbnVsbCxcbiAgICAgICAgYXR0cmlidXRlLnZhbHVlIHx8IGF0dHJpYnV0ZS5ub2RlVmFsdWVcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiB3aGVuRGVmaW5lZChuYW1lKSB7XG4gICAgbmFtZSA9IG5hbWUudG9VcHBlckNhc2UoKTtcbiAgICBpZiAoIShuYW1lIGluIHdhaXRpbmdMaXN0KSkge1xuICAgICAgd2FpdGluZ0xpc3RbbmFtZV0gPSB7fTtcbiAgICAgIHdhaXRpbmdMaXN0W25hbWVdLnAgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICB3YWl0aW5nTGlzdFtuYW1lXS5yID0gcmVzb2x2ZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gd2FpdGluZ0xpc3RbbmFtZV0ucDtcbiAgfVxuICBcbiAgZnVuY3Rpb24gcG9seWZpbGxWMSgpIHtcbiAgICBpZiAoY3VzdG9tRWxlbWVudHMpIGRlbGV0ZSB3aW5kb3cuY3VzdG9tRWxlbWVudHM7XG4gICAgZGVmaW5lUHJvcGVydHkod2luZG93LCAnY3VzdG9tRWxlbWVudHMnLCB7XG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogbmV3IEN1c3RvbUVsZW1lbnRSZWdpc3RyeSgpXG4gICAgfSk7XG4gICAgZGVmaW5lUHJvcGVydHkod2luZG93LCAnQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5Jywge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IEN1c3RvbUVsZW1lbnRSZWdpc3RyeVxuICAgIH0pO1xuICAgIGZvciAodmFyXG4gICAgICBwYXRjaENsYXNzID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIENsYXNzID0gd2luZG93W25hbWVdO1xuICAgICAgICBpZiAoQ2xhc3MpIHtcbiAgICAgICAgICB3aW5kb3dbbmFtZV0gPSBmdW5jdGlvbiBDdXN0b21FbGVtZW50c1YxKHNlbGYpIHtcbiAgICAgICAgICAgIHZhciBpbmZvLCBpc05hdGl2ZTtcbiAgICAgICAgICAgIGlmICghc2VsZikgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICBpZiAoIXNlbGZbRFJFQ0VWMV0pIHtcbiAgICAgICAgICAgICAganVzdENyZWF0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICBpbmZvID0gY29uc3RydWN0b3JzW25vZGVOYW1lcy5nZXQoc2VsZi5jb25zdHJ1Y3RvcildO1xuICAgICAgICAgICAgICBpc05hdGl2ZSA9IHVzYWJsZUN1c3RvbUVsZW1lbnRzICYmIGluZm8uY3JlYXRlLmxlbmd0aCA9PT0gMTtcbiAgICAgICAgICAgICAgc2VsZiA9IGlzTmF0aXZlID9cbiAgICAgICAgICAgICAgICBSZWZsZWN0LmNvbnN0cnVjdChDbGFzcywgZW1wdHksIGluZm8uY29uc3RydWN0b3IpIDpcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50LmFwcGx5KGRvY3VtZW50LCBpbmZvLmNyZWF0ZSk7XG4gICAgICAgICAgICAgIHNlbGZbRFJFQ0VWMV0gPSB0cnVlO1xuICAgICAgICAgICAgICBqdXN0Q3JlYXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICBpZiAoIWlzTmF0aXZlKSBub3RpZnlBdHRyaWJ1dGVzKHNlbGYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHNlbGY7XG4gICAgICAgICAgfTtcbiAgICAgICAgICB3aW5kb3dbbmFtZV0ucHJvdG90eXBlID0gQ2xhc3MucHJvdG90eXBlO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSB3aW5kb3dbbmFtZV07XG4gICAgICAgICAgfSBjYXRjaChXZWJLaXQpIHtcbiAgICAgICAgICAgIGZpeEdldENsYXNzID0gdHJ1ZTtcbiAgICAgICAgICAgIGRlZmluZVByb3BlcnR5KENsYXNzLCBEUkVDRVYxLCB7dmFsdWU6IHdpbmRvd1tuYW1lXX0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIENsYXNzZXMgPSBodG1sQ2xhc3MuZ2V0KC9eSFRNTFtBLVpdKlthLXpdLyksXG4gICAgICBpID0gQ2xhc3Nlcy5sZW5ndGg7XG4gICAgICBpLS07XG4gICAgICBwYXRjaENsYXNzKENsYXNzZXNbaV0pXG4gICAgKSB7fVxuICAgIChkb2N1bWVudC5jcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24gKG5hbWUsIG9wdGlvbnMpIHtcbiAgICAgIHZhciBpcyA9IGdldElzKG9wdGlvbnMpO1xuICAgICAgcmV0dXJuIGlzID9cbiAgICAgICAgcGF0Y2hlZENyZWF0ZUVsZW1lbnQuY2FsbCh0aGlzLCBuYW1lLCBzZWNvbmRBcmd1bWVudChpcykpIDpcbiAgICAgICAgcGF0Y2hlZENyZWF0ZUVsZW1lbnQuY2FsbCh0aGlzLCBuYW1lKTtcbiAgICB9KTtcbiAgICBpZiAoIVYwKSB7XG4gICAgICBqdXN0U2V0dXAgPSB0cnVlO1xuICAgICAgZG9jdW1lbnRbUkVHSVNURVJfRUxFTUVOVF0oJycpO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gaWYgY3VzdG9tRWxlbWVudHMgaXMgbm90IHRoZXJlIGF0IGFsbFxuICBpZiAoIWN1c3RvbUVsZW1lbnRzIHx8IHBvbHlmaWxsID09PSAnZm9yY2UnKSBwb2x5ZmlsbFYxKCk7XG4gIGVsc2Uge1xuICAgIC8vIGlmIGF2YWlsYWJsZSB0ZXN0IGV4dGVuZHMgd29yayBhcyBleHBlY3RlZFxuICAgIHRyeSB7XG4gICAgICAoZnVuY3Rpb24gKERSRSwgb3B0aW9ucywgbmFtZSkge1xuICAgICAgICBvcHRpb25zW0VYVEVORFNdID0gJ2EnO1xuICAgICAgICBEUkUucHJvdG90eXBlID0gY3JlYXRlKEhUTUxBbmNob3JFbGVtZW50LnByb3RvdHlwZSk7XG4gICAgICAgIERSRS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBEUkU7XG4gICAgICAgIHdpbmRvdy5jdXN0b21FbGVtZW50cy5kZWZpbmUobmFtZSwgRFJFLCBvcHRpb25zKTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGdldEF0dHJpYnV0ZS5jYWxsKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnLCB7aXM6IG5hbWV9KSwgJ2lzJykgIT09IG5hbWUgfHxcbiAgICAgICAgICAodXNhYmxlQ3VzdG9tRWxlbWVudHMgJiYgZ2V0QXR0cmlidXRlLmNhbGwobmV3IERSRSgpLCAnaXMnKSAhPT0gbmFtZSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgdGhyb3cgb3B0aW9ucztcbiAgICAgICAgfVxuICAgICAgfShcbiAgICAgICAgZnVuY3Rpb24gRFJFKCkge1xuICAgICAgICAgIHJldHVybiBSZWZsZWN0LmNvbnN0cnVjdChIVE1MQW5jaG9yRWxlbWVudCwgW10sIERSRSk7XG4gICAgICAgIH0sXG4gICAgICAgIHt9LFxuICAgICAgICAnZG9jdW1lbnQtcmVnaXN0ZXItZWxlbWVudC1hJ1xuICAgICAgKSk7XG4gICAgfSBjYXRjaChvX08pIHtcbiAgICAgIC8vIG9yIGZvcmNlIHRoZSBwb2x5ZmlsbCBpZiBub3RcbiAgICAgIC8vIGFuZCBrZWVwIGludGVybmFsIG9yaWdpbmFsIHJlZmVyZW5jZVxuICAgICAgcG9seWZpbGxWMSgpO1xuICAgIH1cbiAgfVxuICBcbiAgdHJ5IHtcbiAgICBjcmVhdGVFbGVtZW50LmNhbGwoZG9jdW1lbnQsICdhJywgJ2EnKTtcbiAgfSBjYXRjaChGaXJlRm94KSB7XG4gICAgc2Vjb25kQXJndW1lbnQgPSBmdW5jdGlvbiAoaXMpIHtcbiAgICAgIHJldHVybiB7aXM6IGlzLnRvTG93ZXJDYXNlKCl9O1xuICAgIH07XG4gIH1cbiAgXG59XG5cbmV4cG9ydHMuaW5zdGFsbEN1c3RvbUVsZW1lbnRzID0gaW5zdGFsbEN1c3RvbUVsZW1lbnRzO1xuXG4iLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQ29uc3RydWN0cyBhIEVTNi9Qcm9taXNlcyBBKyBQcm9taXNlIGluc3RhbmNlLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICogQHBhcmFtIHtmdW5jdGlvbihmdW5jdGlvbigqPSksIGZ1bmN0aW9uICgqPSkpfSByZXNvbHZlclxuICovXG5mdW5jdGlvbiBQcm9taXNlKHJlc29sdmVyKSB7XG4gIGlmICghKHRoaXMgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0NvbnN0cnVjdG9yIFByb21pc2UgcmVxdWlyZXMgYG5ld2AnKTtcbiAgfVxuICBpZiAoIWlzRnVuY3Rpb24ocmVzb2x2ZXIpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignTXVzdCBwYXNzIHJlc29sdmVyIGZ1bmN0aW9uJyk7XG4gIH1cblxuICAvKipcbiAgICogQHR5cGUge2Z1bmN0aW9uKHRoaXM6UHJvbWlzZSwqPSxmdW5jdGlvbigqPSksZnVuY3Rpb24oKj0pLERlZmVycmVkKTohUHJvbWlzZX1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHRoaXMuX3N0YXRlID0gUGVuZGluZ1Byb21pc2U7XG5cbiAgLyoqXG4gICAqIEB0eXBlIHsqfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGhpcy5fdmFsdWUgPSBbXTtcblxuICAvKipcbiAgICogQHR5cGUge2Jvb2xlYW59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB0aGlzLl9pc0NoYWluRW5kID0gdHJ1ZTtcblxuICBkb1Jlc29sdmUoXG4gICAgdGhpcyxcbiAgICBhZG9wdGVyKHRoaXMsIEZ1bGZpbGxlZFByb21pc2UpLFxuICAgIGFkb3B0ZXIodGhpcywgUmVqZWN0ZWRQcm9taXNlKSxcbiAgICB7IHRoZW46IHJlc29sdmVyIH1cbiAgKTtcbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgUHVibGljIEluc3RhbmNlIE1ldGhvZHNcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgcHJvbWlzZSBpbnN0YW5jZSB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgcmVzdWx0IG9mIHRoaXMgcHJvbWlzZVxuICogYXMgaW5wdXRzIHRvIHRoZSBvbkZ1bGZpbGxlZCBvciBvblJlamVjdGVkIGNhbGxiYWNrcy5cbiAqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCopfSBvbkZ1bGZpbGxlZFxuICogQHBhcmFtIHtmdW5jdGlvbigqKX0gb25SZWplY3RlZFxuICovXG5Qcm9taXNlLnByb3RvdHlwZS50aGVuID0gZnVuY3Rpb24ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcbiAgb25GdWxmaWxsZWQgPSBpc0Z1bmN0aW9uKG9uRnVsZmlsbGVkKSA/IG9uRnVsZmlsbGVkIDogdm9pZCAwO1xuICBvblJlamVjdGVkID0gaXNGdW5jdGlvbihvblJlamVjdGVkKSA/IG9uUmVqZWN0ZWQgOiB2b2lkIDA7XG5cbiAgaWYgKG9uRnVsZmlsbGVkIHx8IG9uUmVqZWN0ZWQpIHtcbiAgICB0aGlzLl9pc0NoYWluRW5kID0gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gdGhpcy5fc3RhdGUoXG4gICAgdGhpcy5fdmFsdWUsXG4gICAgb25GdWxmaWxsZWQsXG4gICAgb25SZWplY3RlZFxuICApO1xufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHByb21pc2UgdGhhdCB3aWxsIGhhbmRsZSB0aGUgcmVqZWN0ZWQgc3RhdGUgb2YgdGhpcyBwcm9taXNlLlxuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKil9IG9uUmVqZWN0ZWRcbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2ggPSBmdW5jdGlvbihvblJlamVjdGVkKSB7XG4gIHJldHVybiB0aGlzLnRoZW4odm9pZCAwLCBvblJlamVjdGVkKTtcbn07XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gIFB1YmxpYyBTdGF0aWMgTWV0aG9kc1xuICoqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbi8qKlxuICogQ3JlYXRlcyBhIGZ1bGZpbGxlZCBQcm9taXNlIG9mIHZhbHVlLiBJZiB2YWx1ZSBpcyBpdHNlbGYgYSB0aGVuLWFibGUsXG4gKiByZXNvbHZlcyB3aXRoIHRoZSB0aGVuLWFibGUncyB2YWx1ZS5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9XG4gKiBAcGFyYW0geyo9fSB2YWx1ZVxuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5Qcm9taXNlLnJlc29sdmUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuICB2YXIgcHJvbWlzZTtcblxuICBpZiAoaXNPYmplY3QodmFsdWUpICYmIHZhbHVlIGluc3RhbmNlb2YgdGhpcykge1xuICAgIHByb21pc2UgPSB2YWx1ZTtcbiAgfSBlbHNlIHtcbiAgICBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2V9ICovKHByb21pc2UpO1xufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgcmVqZWN0ZWQgUHJvbWlzZSBvZiByZWFzb24uXG4gKlxuICogQHRoaXMgeyFQcm9taXNlfVxuICogQHBhcmFtIHsqPX0gcmVhc29uXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cblByb21pc2UucmVqZWN0ID0gZnVuY3Rpb24ocmVhc29uKSB7XG4gIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG4gIHZhciBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uKF8sIHJlamVjdCkge1xuICAgIHJlamVjdChyZWFzb24pO1xuICB9KTtcblxuICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZX0gKi8ocHJvbWlzZSk7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBQcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHdpdGggYW4gYXJyYXkgb2YgdGhlIHZhbHVlcyBvZiB0aGVcbiAqIHBhc3NlZCBpbiBwcm9taXNlcy4gSWYgYW55IHByb21pc2UgcmVqZWN0cywgdGhlIHJldHVybmVkIHByb21pc2Ugd2lsbFxuICogcmVqZWN0LlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX1cbiAqIEBwYXJhbSB7IUFycmF5PFByb21pc2V8Kj59IHByb21pc2VzXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cblByb21pc2UuYWxsID0gZnVuY3Rpb24ocHJvbWlzZXMpIHtcbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcbiAgdmFyIHByb21pc2UgPSBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdmFyIGxlbmd0aCA9IHByb21pc2VzLmxlbmd0aDtcbiAgICB2YXIgdmFsdWVzID0gbmV3IEFycmF5KGxlbmd0aCk7XG5cbiAgICBpZiAobGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gcmVzb2x2ZSh2YWx1ZXMpO1xuICAgIH1cblxuICAgIGVhY2gocHJvbWlzZXMsIGZ1bmN0aW9uKHByb21pc2UsIGluZGV4KSB7XG4gICAgICBDb25zdHJ1Y3Rvci5yZXNvbHZlKHByb21pc2UpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgdmFsdWVzW2luZGV4XSA9IHZhbHVlO1xuICAgICAgICBpZiAoLS1sZW5ndGggPT09IDApIHtcbiAgICAgICAgICByZXNvbHZlKHZhbHVlcyk7XG4gICAgICAgIH1cbiAgICAgIH0sIHJlamVjdCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlfSAqLyhwcm9taXNlKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIFByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgb3IgcmVqZWN0IGJhc2VkIG9uIHRoZSBmaXJzdFxuICogcmVzb2x2ZWQgb3IgcmVqZWN0ZWQgcHJvbWlzZS5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9XG4gKiBAcGFyYW0geyFBcnJheTxQcm9taXNlfCo+fSBwcm9taXNlc1xuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5Qcm9taXNlLnJhY2UgPSBmdW5jdGlvbihwcm9taXNlcykge1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb21pc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBDb25zdHJ1Y3Rvci5yZXNvbHZlKHByb21pc2VzW2ldKS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZX0gKi8ocHJvbWlzZSk7XG59O1xuXG52YXIgb25Qb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbiA9IGZ1bmN0aW9uKHJlYXNvbiwgcHJvbWlzZSkge1xuICB0aHJvdyByZWFzb247XG59O1xuXG4vKipcbiAqIEFuIGludGVybmFsIHVzZSBzdGF0aWMgZnVuY3Rpb24uXG4gKi9cblByb21pc2UuX292ZXJyaWRlVW5oYW5kbGVkRXhjZXB0aW9uSGFuZGxlciA9IGZ1bmN0aW9uKGhhbmRsZXIpIHtcbiAgb25Qb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbiA9IGhhbmRsZXI7XG59O1xuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICBQcml2YXRlIGZ1bmN0aW9uc1xuICoqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbi8qKlxuICogVGhlIEZ1bGZpbGxlZCBQcm9taXNlIHN0YXRlLiBDYWxscyBvbkZ1bGZpbGxlZCB3aXRoIHRoZSByZXNvbHZlZCB2YWx1ZSBvZlxuICogdGhpcyBwcm9taXNlLCBjcmVhdGluZyBhIG5ldyBwcm9taXNlLlxuICpcbiAqIElmIHRoZXJlIGlzIG5vIG9uRnVsZmlsbGVkLCByZXR1cm5zIHRoZSBjdXJyZW50IHByb21pc2UgdG8gYXZvaWQgYW4gcHJvbWlzZVxuICogaW5zdGFuY2UuXG4gKlxuICogQHRoaXMgeyFQcm9taXNlfSBUaGUgY3VycmVudCBwcm9taXNlXG4gKiBAcGFyYW0geyo9fSB2YWx1ZSBUaGUgY3VycmVudCBwcm9taXNlJ3MgcmVzb2x2ZWQgdmFsdWUuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IG9uRnVsZmlsbGVkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IHVudXNlZFxuICogQHBhcmFtIHtEZWZlcnJlZH0gZGVmZXJyZWQgQSBkZWZlcnJlZCBvYmplY3QgdGhhdCBob2xkcyBhIHByb21pc2UgYW5kIGl0c1xuICogICAgIHJlc29sdmUgYW5kIHJlamVjdCBmdW5jdGlvbnMuIEl0IElTIE5PVCBwYXNzZWQgd2hlbiBjYWxsZWQgZnJvbVxuICogICAgIFByb21pc2UjdGhlbiB0byBzYXZlIGFuIG9iamVjdCBpbnN0YW5jZSAoc2luY2Ugd2UgbWF5IHJldHVybiB0aGUgY3VycmVudFxuICogICAgIHByb21pc2UpLiBJdCBJUyBwYXNzZWQgaW4gd2hlbiBhZG9wdGluZyB0aGUgRnVsZmlsbGVkIHN0YXRlIGZyb20gdGhlXG4gKiAgICAgUGVuZGluZyBzdGF0ZS5cbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gRnVsZmlsbGVkUHJvbWlzZSh2YWx1ZSwgb25GdWxmaWxsZWQsIHVudXNlZCwgZGVmZXJyZWQpIHtcbiAgaWYgKCFvbkZ1bGZpbGxlZCkge1xuICAgIGRlZmVycmVkQWRvcHQoZGVmZXJyZWQsIEZ1bGZpbGxlZFByb21pc2UsIHZhbHVlKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBpZiAoIWRlZmVycmVkKSB7XG4gICAgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQodGhpcy5jb25zdHJ1Y3Rvcik7XG4gIH1cbiAgZGVmZXIodHJ5Q2F0Y2hEZWZlcnJlZChkZWZlcnJlZCwgb25GdWxmaWxsZWQsIHZhbHVlKSk7XG4gIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xufVxuXG4vKipcbiAqIFRoZSBSZWplY3RlZCBQcm9taXNlIHN0YXRlLiBDYWxscyBvblJlamVjdGVkIHdpdGggdGhlIHJlc29sdmVkIHZhbHVlIG9mXG4gKiB0aGlzIHByb21pc2UsIGNyZWF0aW5nIGEgbmV3IHByb21pc2UuXG4gKlxuICogSWYgdGhlcmUgaXMgbm8gb25SZWplY3RlZCwgcmV0dXJucyB0aGUgY3VycmVudCBwcm9taXNlIHRvIGF2b2lkIGFuIHByb21pc2VcbiAqIGluc3RhbmNlLlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX0gVGhlIGN1cnJlbnQgcHJvbWlzZVxuICogQHBhcmFtIHsqPX0gcmVhc29uIFRoZSBjdXJyZW50IHByb21pc2UncyByZWplY3Rpb24gcmVhc29uLlxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSB1bnVzZWRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0pPX0gb25SZWplY3RlZFxuICogQHBhcmFtIHtEZWZlcnJlZH0gZGVmZXJyZWQgQSBkZWZlcnJlZCBvYmplY3QgdGhhdCBob2xkcyBhIHByb21pc2UgYW5kIGl0c1xuICogICAgIHJlc29sdmUgYW5kIHJlamVjdCBmdW5jdGlvbnMuIEl0IElTIE5PVCBwYXNzZWQgd2hlbiBjYWxsZWQgZnJvbVxuICogICAgIFByb21pc2UjdGhlbiB0byBzYXZlIGFuIG9iamVjdCBpbnN0YW5jZSAoc2luY2Ugd2UgbWF5IHJldHVybiB0aGUgY3VycmVudFxuICogICAgIHByb21pc2UpLiBJdCBJUyBwYXNzZWQgaW4gd2hlbiBhZG9wdGluZyB0aGUgUmVqZWN0ZWQgc3RhdGUgZnJvbSB0aGVcbiAqICAgICBQZW5kaW5nIHN0YXRlLlxuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5mdW5jdGlvbiBSZWplY3RlZFByb21pc2UocmVhc29uLCB1bnVzZWQsIG9uUmVqZWN0ZWQsIGRlZmVycmVkKSB7XG4gIGlmICghb25SZWplY3RlZCkge1xuICAgIGRlZmVycmVkQWRvcHQoZGVmZXJyZWQsIFJlamVjdGVkUHJvbWlzZSwgcmVhc29uKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBpZiAoIWRlZmVycmVkKSB7XG4gICAgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQodGhpcy5jb25zdHJ1Y3Rvcik7XG4gIH1cbiAgZGVmZXIodHJ5Q2F0Y2hEZWZlcnJlZChkZWZlcnJlZCwgb25SZWplY3RlZCwgcmVhc29uKSk7XG4gIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xufVxuXG4vKipcbiAqIFRoZSBQZW5kaW5nIFByb21pc2Ugc3RhdGUuIEV2ZW50dWFsbHkgY2FsbHMgb25GdWxmaWxsZWQgb25jZSB0aGUgcHJvbWlzZSBoYXNcbiAqIHJlc29sdmVkLCBvciBvblJlamVjdGVkIG9uY2UgdGhlIHByb21pc2UgcmVqZWN0cy5cbiAqXG4gKiBJZiB0aGVyZSBpcyBubyBvbkZ1bGZpbGxlZCBhbmQgbm8gb25SZWplY3RlZCwgcmV0dXJucyB0aGUgY3VycmVudCBwcm9taXNlIHRvXG4gKiBhdm9pZCBhbiBwcm9taXNlIGluc3RhbmNlLlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX0gVGhlIGN1cnJlbnQgcHJvbWlzZVxuICogQHBhcmFtIHsqPX0gcXVldWUgVGhlIGN1cnJlbnQgcHJvbWlzZSdzIHBlbmRpbmcgcHJvbWlzZXMgcXVldWUuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IG9uRnVsZmlsbGVkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IG9uUmVqZWN0ZWRcbiAqIEBwYXJhbSB7RGVmZXJyZWR9IGRlZmVycmVkIEEgZGVmZXJyZWQgb2JqZWN0IHRoYXQgaG9sZHMgYSBwcm9taXNlIGFuZCBpdHNcbiAqICAgICByZXNvbHZlIGFuZCByZWplY3QgZnVuY3Rpb25zLiBJdCBJUyBOT1QgcGFzc2VkIHdoZW4gY2FsbGVkIGZyb21cbiAqICAgICBQcm9taXNlI3RoZW4gdG8gc2F2ZSBhbiBvYmplY3QgaW5zdGFuY2UgKHNpbmNlIHdlIG1heSByZXR1cm4gdGhlIGN1cnJlbnRcbiAqICAgICBwcm9taXNlKS4gSXQgSVMgcGFzc2VkIGluIHdoZW4gYWRvcHRpbmcgdGhlIFBlbmRpbmcgc3RhdGUgZnJvbSB0aGVcbiAqICAgICBQZW5kaW5nIHN0YXRlIG9mIGFub3RoZXIgcHJvbWlzZS5cbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gUGVuZGluZ1Byb21pc2UocXVldWUsIG9uRnVsZmlsbGVkLCBvblJlamVjdGVkLCBkZWZlcnJlZCkge1xuICBpZiAoIWRlZmVycmVkKSB7XG4gICAgaWYgKCFvbkZ1bGZpbGxlZCAmJiAhb25SZWplY3RlZCkgeyByZXR1cm4gdGhpczsgfVxuICAgIGRlZmVycmVkID0gbmV3IERlZmVycmVkKHRoaXMuY29uc3RydWN0b3IpO1xuICB9XG4gIHF1ZXVlLnB1c2goe1xuICAgIGRlZmVycmVkOiBkZWZlcnJlZCxcbiAgICBvbkZ1bGZpbGxlZDogb25GdWxmaWxsZWQgfHwgZGVmZXJyZWQucmVzb2x2ZSxcbiAgICBvblJlamVjdGVkOiBvblJlamVjdGVkIHx8IGRlZmVycmVkLnJlamVjdFxuICB9KTtcbiAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG59XG5cbi8qKlxuICogQ29uc3RydWN0cyBhIGRlZmVycmVkIGluc3RhbmNlIHRoYXQgaG9sZHMgYSBwcm9taXNlIGFuZCBpdHMgcmVzb2x2ZSBhbmRcbiAqIHJlamVjdCBmdW5jdGlvbnMuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIERlZmVycmVkKFByb21pc2UpIHtcbiAgdmFyIGRlZmVycmVkID0gdGhpcztcbiAgLyoqIEB0eXBlIHshUHJvbWlzZX0gKi9cbiAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgLyoqIEB0eXBlIHtmdW5jdGlvbigqPSl9ICovXG4gICAgZGVmZXJyZWQucmVzb2x2ZSA9IHJlc29sdmU7XG5cbiAgICAvKiogQHR5cGUge2Z1bmN0aW9uKCo9KX0gKi9cbiAgICBkZWZlcnJlZC5yZWplY3QgPSByZWplY3Q7XG4gIH0pO1xuICByZXR1cm4gZGVmZXJyZWQ7XG59XG5cbi8qKlxuICogVHJhbnNpdGlvbnMgdGhlIHN0YXRlIG9mIHByb21pc2UgdG8gYW5vdGhlciBzdGF0ZS4gVGhpcyBpcyBvbmx5IGV2ZXIgY2FsbGVkXG4gKiBvbiB3aXRoIGEgcHJvbWlzZSB0aGF0IGlzIGN1cnJlbnRseSBpbiB0aGUgUGVuZGluZyBzdGF0ZS5cbiAqXG4gKiBAcGFyYW0geyFQcm9taXNlfSBwcm9taXNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKHRoaXM6UHJvbWlzZSwqPSxmdW5jdGlvbigqPSksZnVuY3Rpb24oKj0pLERlZmVycmVkKTohUHJvbWlzZX0gc3RhdGVcbiAqIEBwYXJhbSB7Kj19IHZhbHVlXG4gKi9cbmZ1bmN0aW9uIGFkb3B0KHByb21pc2UsIHN0YXRlLCB2YWx1ZSwgYWRvcHRlZSkge1xuICB2YXIgcXVldWUgPSBwcm9taXNlLl92YWx1ZTtcbiAgcHJvbWlzZS5fc3RhdGUgPSBzdGF0ZTtcbiAgcHJvbWlzZS5fdmFsdWUgPSB2YWx1ZTtcblxuICBpZiAoYWRvcHRlZSAmJiBzdGF0ZSA9PT0gUGVuZGluZ1Byb21pc2UpIHtcbiAgICBhZG9wdGVlLl9zdGF0ZSh2YWx1ZSwgdm9pZCAwLCB2b2lkIDAsIHtcbiAgICAgIHByb21pc2U6IHByb21pc2UsXG4gICAgICByZXNvbHZlOiB2b2lkIDAsXG4gICAgICByZWplY3Q6IHZvaWQgMFxuICAgIH0pO1xuICB9XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWV1ZS5sZW5ndGg7IGkrKykge1xuICAgIHZhciBuZXh0ID0gcXVldWVbaV07XG4gICAgcHJvbWlzZS5fc3RhdGUoXG4gICAgICB2YWx1ZSxcbiAgICAgIG5leHQub25GdWxmaWxsZWQsXG4gICAgICBuZXh0Lm9uUmVqZWN0ZWQsXG4gICAgICBuZXh0LmRlZmVycmVkXG4gICAgKTtcbiAgfVxuICBxdWV1ZS5sZW5ndGggPSAwO1xuXG4gIC8vIERldGVybWluZSBpZiB0aGlzIHJlamVjdGVkIHByb21pc2Ugd2lsbCBiZSBcImhhbmRsZWRcIi5cbiAgaWYgKHN0YXRlID09PSBSZWplY3RlZFByb21pc2UgJiYgcHJvbWlzZS5faXNDaGFpbkVuZCkge1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBpZiAocHJvbWlzZS5faXNDaGFpbkVuZCkge1xuICAgICAgICBvblBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uKHZhbHVlLCBwcm9taXNlKTtcbiAgICAgIH1cbiAgICB9LCAwKTtcbiAgfVxufVxuXG4vKipcbiAqIEEgcGFydGlhbCBhcHBsaWNhdGlvbiBvZiBhZG9wdC5cbiAqXG4gKiBAcGFyYW0geyFQcm9taXNlfSBwcm9taXNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKHRoaXM6UHJvbWlzZSwqPSxmdW5jdGlvbigqPSksZnVuY3Rpb24oKj0pLERlZmVycmVkKTohUHJvbWlzZX0gc3RhdGVcbiAqIEByZXR1cm5zIHtmdW5jdGlvbigqPSl9XG4gKi9cbmZ1bmN0aW9uIGFkb3B0ZXIocHJvbWlzZSwgc3RhdGUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgYWRvcHQocHJvbWlzZSwgc3RhdGUsIHZhbHVlKTtcbiAgfTtcbn1cblxuLyoqXG4gKiBVcGRhdGVzIGEgZGVmZXJyZWQgcHJvbWlzZXMgc3RhdGUuIE5lY2Vzc2FyeSBmb3IgdXBkYXRpbmcgYW4gYWRvcHRpbmdcbiAqIHByb21pc2UncyBzdGF0ZSB3aGVuIHRoZSBhZG9wdGVlIHJlc29sdmVzLlxuICpcbiAqIEBwYXJhbSB7P0RlZmVycmVkfSBkZWZlcnJlZFxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlByb21pc2UsKj0sZnVuY3Rpb24oKj0pLGZ1bmN0aW9uKCo9KSxEZWZlcnJlZCk6IVByb21pc2V9IHN0YXRlXG4gKiBAcGFyYW0geyo9fSB2YWx1ZVxuICovXG5mdW5jdGlvbiBkZWZlcnJlZEFkb3B0KGRlZmVycmVkLCBzdGF0ZSwgdmFsdWUpIHtcbiAgaWYgKGRlZmVycmVkKSB7XG4gICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgIHByb21pc2UuX3N0YXRlID0gc3RhdGU7XG4gICAgcHJvbWlzZS5fdmFsdWUgPSB2YWx1ZTtcbiAgfVxufVxuXG4vKipcbiAqIEEgbm8tb3AgZnVuY3Rpb24gdG8gcHJldmVudCBkb3VibGUgcmVzb2x2aW5nLlxuICovXG5mdW5jdGlvbiBub29wKCkge31cblxuLyoqXG4gKiBUZXN0cyBpZiBmbiBpcyBhIEZ1bmN0aW9uXG4gKlxuICogQHBhcmFtIHsqfSBmblxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oZm4pIHtcbiAgcmV0dXJuIHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJztcbn1cblxuLyoqXG4gKiBUZXN0cyBpZiBmbiBpcyBhbiBPYmplY3RcbiAqXG4gKiBAcGFyYW0geyp9IG9ialxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzT2JqZWN0KG9iaikge1xuICByZXR1cm4gb2JqID09PSBPYmplY3Qob2JqKTtcbn1cblxuLyoqXG4gKiBJdGVyYXRlcyBvdmVyIGVhY2ggZWxlbWVudCBvZiBhbiBhcnJheSwgY2FsbGluZyB0aGUgaXRlcmF0b3Igd2l0aCB0aGVcbiAqIGVsZW1lbnQgYW5kIGl0cyBpbmRleC5cbiAqXG4gKiBAcGFyYW0geyFBcnJheX0gY29sbGVjdGlvblxuICogQHBhcmFtIHtmdW5jdGlvbigqPSxudW1iZXIpfSBpdGVyYXRvclxuICovXG5mdW5jdGlvbiBlYWNoKGNvbGxlY3Rpb24sIGl0ZXJhdG9yKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY29sbGVjdGlvbi5sZW5ndGg7IGkrKykge1xuICAgIGl0ZXJhdG9yKGNvbGxlY3Rpb25baV0sIGkpO1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBhdHRlbXB0IHRvIHJlc29sdmUgdGhlIGRlZmVycmVkIHdpdGggdGhlIHJldHVyblxuICogb2YgZm4uIElmIGFueSBlcnJvciBpcyByYWlzZWQsIHJlamVjdHMgaW5zdGVhZC5cbiAqXG4gKiBAcGFyYW0geyFEZWZlcnJlZH0gZGVmZXJyZWRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0pfSBmblxuICogQHBhcmFtIHsqfSBhcmdcbiAqIEByZXR1cm5zIHtmdW5jdGlvbigpfVxuICovXG5mdW5jdGlvbiB0cnlDYXRjaERlZmVycmVkKGRlZmVycmVkLCBmbiwgYXJnKSB7XG4gIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgdmFyIHJlc29sdmUgPSBkZWZlcnJlZC5yZXNvbHZlO1xuICB2YXIgcmVqZWN0ID0gZGVmZXJyZWQucmVqZWN0O1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciByZXN1bHQgPSBmbihhcmcpO1xuICAgICAgZG9SZXNvbHZlKHByb21pc2UsIHJlc29sdmUsIHJlamVjdCwgcmVzdWx0LCByZXN1bHQpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJlamVjdChlKTtcbiAgICB9XG4gIH07XG59XG5cbi8qKlxuICogUXVldWVzIGFuZCBleGVjdXRlcyBtdWx0aXBsZSBkZWZlcnJlZCBmdW5jdGlvbnMgb24gYW5vdGhlciBydW4gbG9vcC5cbiAqL1xudmFyIGRlZmVyID0gKGZ1bmN0aW9uKCkge1xuICAvKipcbiAgICogRGVmZXJzIGZuIHRvIGFub3RoZXIgcnVuIGxvb3AuXG4gICAqL1xuICB2YXIgc2NoZWR1bGVGbHVzaDtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5wb3N0TWVzc2FnZSkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZmx1c2gpO1xuICAgIHNjaGVkdWxlRmx1c2ggPSBmdW5jdGlvbigpIHtcbiAgICAgIHdpbmRvdy5wb3N0TWVzc2FnZSgnbWFjcm8tdGFzaycsICcqJyk7XG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBzY2hlZHVsZUZsdXNoID0gZnVuY3Rpb24oKSB7XG4gICAgICBzZXRUaW1lb3V0KGZsdXNoLCAwKTtcbiAgICB9O1xuICB9XG5cbiAgdmFyIHF1ZXVlID0gbmV3IEFycmF5KDE2KTtcbiAgdmFyIGxlbmd0aCA9IDA7XG5cbiAgZnVuY3Rpb24gZmx1c2goKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGZuID0gcXVldWVbaV07XG4gICAgICBxdWV1ZVtpXSA9IG51bGw7XG4gICAgICBmbigpO1xuICAgIH1cbiAgICBsZW5ndGggPSAwO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gZm5cbiAgICovXG4gIGZ1bmN0aW9uIGRlZmVyKGZuKSB7XG4gICAgaWYgKGxlbmd0aCA9PT0gMCkgeyBzY2hlZHVsZUZsdXNoKCk7IH1cbiAgICBxdWV1ZVtsZW5ndGgrK10gPSBmbjtcbiAgfVxuXG4gIHJldHVybiBkZWZlcjtcbn0pKCk7XG5cbi8qKlxuICogVGhlIFByb21pc2UgcmVzb2x1dGlvbiBwcm9jZWR1cmUuXG4gKiBodHRwczovL2dpdGh1Yi5jb20vcHJvbWlzZXMtYXBsdXMvcHJvbWlzZXMtc3BlYyN0aGUtcHJvbWlzZS1yZXNvbHV0aW9uLXByb2NlZHVyZVxuICpcbiAqIEBwYXJhbSB7IVByb21pc2V9IHByb21pc2VcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0pfSByZXNvbHZlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KX0gcmVqZWN0XG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcGFyYW0geyo9fSBjb250ZXh0XG4gKi9cbmZ1bmN0aW9uIGRvUmVzb2x2ZShwcm9taXNlLCByZXNvbHZlLCByZWplY3QsIHZhbHVlLCBjb250ZXh0KSB7XG4gIHZhciBfcmVqZWN0ID0gcmVqZWN0O1xuICB2YXIgdGhlbjtcbiAgdmFyIF9yZXNvbHZlO1xuICB0cnkge1xuICAgIGlmICh2YWx1ZSA9PT0gcHJvbWlzZSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGZ1bGZpbGwgcHJvbWlzZSB3aXRoIGl0c2VsZicpO1xuICAgIH1cbiAgICB2YXIgaXNPYmogPSBpc09iamVjdCh2YWx1ZSk7XG4gICAgaWYgKGlzT2JqICYmIHZhbHVlIGluc3RhbmNlb2YgcHJvbWlzZS5jb25zdHJ1Y3Rvcikge1xuICAgICAgYWRvcHQocHJvbWlzZSwgdmFsdWUuX3N0YXRlLCB2YWx1ZS5fdmFsdWUsIHZhbHVlKTtcbiAgICB9IGVsc2UgaWYgKGlzT2JqICYmICh0aGVuID0gdmFsdWUudGhlbikgJiYgaXNGdW5jdGlvbih0aGVuKSkge1xuICAgICAgX3Jlc29sdmUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBfcmVzb2x2ZSA9IF9yZWplY3QgPSBub29wO1xuICAgICAgICBkb1Jlc29sdmUocHJvbWlzZSwgcmVzb2x2ZSwgcmVqZWN0LCB2YWx1ZSwgdmFsdWUpO1xuICAgICAgfTtcbiAgICAgIF9yZWplY3QgPSBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgX3Jlc29sdmUgPSBfcmVqZWN0ID0gbm9vcDtcbiAgICAgICAgcmVqZWN0KHJlYXNvbik7XG4gICAgICB9O1xuICAgICAgdGhlbi5jYWxsKFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICBmdW5jdGlvbih2YWx1ZSkgeyBfcmVzb2x2ZSh2YWx1ZSk7IH0sXG4gICAgICAgIGZ1bmN0aW9uKHJlYXNvbikgeyBfcmVqZWN0KHJlYXNvbik7IH1cbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIF9yZWplY3QoZSk7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBQcm9taXNlO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogS2V5IHN0cmluZyBpbiBhbiBhY3Rpb24gYXJndW1lbnRzIG1hcCBmb3IgYW4gdW5wYXJzZWQgb2JqZWN0IGxpdGVyYWwgc3RyaW5nLlxuICpcbiAqIEUuZy4gZm9yIHRoZSBhY3Rpb24gaW4gPHAgb249XCJ0YXA6QU1QLnNldFN0YXRlKHtmb286ICdiYXInfSlcIixcbiAqIHRoZW4gYGFyZ3NbUkFXX09CSkVDVF9BUkdTX0tFWV1gIGlzIHRoZSBzdHJpbmcgXCJ7Zm9vOiAnYmFyJ31cIi5cbiAqXG4gKiBUaGUgYWN0aW9uIHNlcnZpY2UgZGVsZWdhdGVzIHBhcnNpbmcgb2Ygb2JqZWN0IGxpdGVyYWxzIHRvIHRoZSBjb3JyZXNwb25kaW5nXG4gKiBleHRlbnNpb24gKGluIHRoZSBleGFtcGxlIGFib3ZlLCBhbXAtYmluZCkuXG4gKlxuICogQHNlZSAuL3NlcnZpY2UvYWN0aW9uLWltcGwuQWN0aW9uSW5mb0RlZlxuICogQGNvbnN0IHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBjb25zdCBSQVdfT0JKRUNUX0FSR1NfS0VZID0gJ19fQU1QX09CSkVDVF9TVFJJTkdfXyc7XG5cbi8qKlxuICogVHJ1c3QgbGV2ZWwgb2YgYW4gYWN0aW9uLlxuICpcbiAqIENvcnJlc3BvbmRzIHRvIGRlZ3JlZSBvZiB1c2VyIGludGVudCwgaS5lLiBldmVudHMgdHJpZ2dlcmVkIHdpdGggc3Ryb25nXG4gKiB1c2VyIGludGVudCBoYXZlIGhpZ2ggdHJ1c3QuXG4gKlxuICogQGVudW0ge251bWJlcn1cbiAqL1xuZXhwb3J0IGNvbnN0IEFjdGlvblRydXN0ID0ge1xuICBMT1c6IDEsXG4gIEhJR0g6IDEwMCxcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtEZWZlcnJlZH0gZnJvbSAnLi91dGlscy9wcm9taXNlJztcbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4vc2VydmljZXMnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7Z2V0Q3VydmV9IGZyb20gJy4vY3VydmUnO1xuXG5jb25zdCBUQUdfID0gJ0FuaW1hdGlvbic7XG5cbmNvbnN0IE5PT1BfQ0FMTEJBQ0sgPSBmdW5jdGlvbigpIHt9O1xuXG4vKipcbiAqIFRoZSBhbmltYXRpb24gY2xhc3MgYWxsb3dzIGNvbnN0cnVjdGlvbiBvZiBhcmJpdHJhcnkgYW5pbWF0aW9uIHByb2Nlc3Nlcy5cbiAqIFRoZSBtYWluIG1ldGhvZCBpcyBcImFkZFwiIHRoYXQgYWRkcyBhIHNlZ21lbnQgb2YgYW5pbWF0aW9uIGF0IHBhcnRpY3VsYXJcbiAqIHRpbWUgb2Zmc2V0IChkZWxheSkgYW5kIGR1cmF0aW9uLiBBbGwgYW5pbWF0aW9uIHNlZ21lbnRzIGFyZSBzaW1wbHkgZnVuY3Rpb25zXG4gKiBvZiB0eXBlIFRyYW5zaXRpb24gd2hpY2ggYXJlIGl0ZXJhdGVkIGZyb20gMCB0byAxIGluIGFuaW1hdGlvbiBmcmFtZXMgdG9cbiAqIGFjaGlldmUgdGhlIGRlc2lyZWQgZWZmZWN0LlxuICovXG5leHBvcnQgY2xhc3MgQW5pbWF0aW9uIHtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhbmQgc3RhcnRzIGFuaW1hdGlvbiB3aXRoIGEgc2luZ2xlIHNlZ21lbnQuIFJldHVybnMgQW5pbWF0aW9uUGxheWVyXG4gICAqIG9iamVjdCB0aGF0IGNhbiBiZSB1c2VkIHRvIG1vbml0b3Igb3IgY29udHJvbCBhbmltYXRpb24uXG4gICAqXG4gICAqIEBwYXJhbSB7IU5vZGV9IGNvbnRleHROb2RlIFRoZSBjb250ZXh0IG5vZGUuXG4gICAqIEBwYXJhbSB7IVRyYW5zaXRpb25EZWY8Pz59IHRyYW5zaXRpb24gVHJhbnNpdGlvbiB0byBhbmltYXRlLlxuICAgKiBAcGFyYW0gey4vdGltZS50aW1lRGVmfSBkdXJhdGlvbiBEdXJhdGlvbiBpbiBtaWxsaXNlY29uZHMuXG4gICAqIEBwYXJhbSB7KCEuL2N1cnZlLkN1cnZlRGVmfHN0cmluZyk9fSBvcHRfY3VydmUgT3B0aW9uYWwgY3VydmUgdG8gdXNlIGZvclxuICAgKiAgIGFuaW1hdGlvbi4gRGVmYXVsdCBpcyB0aGUgbGluZWFyIGFuaW1hdGlvbi5cbiAgICogQHJldHVybiB7IUFuaW1hdGlvblBsYXllcn1cbiAgICovXG4gIHN0YXRpYyBhbmltYXRlKGNvbnRleHROb2RlLCB0cmFuc2l0aW9uLCBkdXJhdGlvbiwgb3B0X2N1cnZlKSB7XG4gICAgcmV0dXJuIG5ldyBBbmltYXRpb24oY29udGV4dE5vZGUpXG4gICAgICAgIC5zZXRDdXJ2ZShvcHRfY3VydmUpXG4gICAgICAgIC5hZGQoMCwgdHJhbnNpdGlvbiwgMSlcbiAgICAgICAgLnN0YXJ0KGR1cmF0aW9uKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFOb2RlfSBjb250ZXh0Tm9kZVxuICAgKiBAcGFyYW0geyEuL3NlcnZpY2UvdnN5bmMtaW1wbC5Wc3luYz19IG9wdF92c3luY1xuICAgKi9cbiAgY29uc3RydWN0b3IoY29udGV4dE5vZGUsIG9wdF92c3luYykge1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFOb2RlfSAqL1xuICAgIHRoaXMuY29udGV4dE5vZGVfID0gY29udGV4dE5vZGU7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshLi9zZXJ2aWNlL3ZzeW5jLWltcGwuVnN5bmN9ICovXG4gICAgdGhpcy52c3luY18gPSBvcHRfdnN5bmMgfHwgU2VydmljZXMudnN5bmNGb3Ioc2VsZik7XG5cbiAgICAvKiogQHByaXZhdGUgez8uL2N1cnZlLkN1cnZlRGVmfSAqL1xuICAgIHRoaXMuY3VydmVfID0gbnVsbDtcblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlIEBjb25zdCB7IUFycmF5PCFTZWdtZW50RGVmPn1cbiAgICAgKi9cbiAgICB0aGlzLnNlZ21lbnRzXyA9IFtdO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIGRlZmF1bHQgY3VydmUgZm9yIHRoZSBhbmltYXRpb24uIEVhY2ggc2VnbWVudCBpcyBhbGxvd2VkIHRvIGhhdmVcbiAgICogaXRzIG93biBjdXJ2ZSwgYnV0IHRoaXMgY3VydmUgd2lsbCBiZSB1c2VkIGlmIGEgc2VnbWVudCBkb2Vzbid0IHNwZWNpZnlcbiAgICogaXRzIG93bi5cbiAgICogQHBhcmFtIHshLi9jdXJ2ZS5DdXJ2ZURlZnxzdHJpbmd8dW5kZWZpbmVkfSBjdXJ2ZVxuICAgKiBAcmV0dXJuIHshQW5pbWF0aW9ufVxuICAgKi9cbiAgc2V0Q3VydmUoY3VydmUpIHtcbiAgICBpZiAoY3VydmUpIHtcbiAgICAgIHRoaXMuY3VydmVfID0gZ2V0Q3VydmUoY3VydmUpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGEgc2VnbWVudCB0byB0aGUgYW5pbWF0aW9uLiBFYWNoIHNlZ21lbnQgc3RhcnRzIGF0IG9mZnNldCAoZGVsYXkpIGFuZFxuICAgKiBydW5zIGZvciBhIHBvcnRpb24gb2YgdGhlIG92ZXJhbGwgYW5pbWF0aW9uIChkdXJhdGlvbikuIE5vdGUgdGhhdCBib3RoXG4gICAqIGRlbGF5IGFuZCBkdXJhdGlvbiBhbmQgbm9ybXRpbWVEZWYgdHlwZXMgd2hpY2ggYWNjZXB0IHZhbHVlcyBmcm9tIDAgdG8gMS5cbiAgICogT3B0aW9uYWxseSwgdGhlIHRpbWUgaXMgcHVzaGVkIHRocm91Z2ggYSBjdXJ2ZS4gSWYgY3VydmUgaXMgbm90IHNwZWNpZmllZCxcbiAgICogdGhlIGRlZmF1bHQgYW5pbWF0aW9uIGN1cnZlIHdpbGwgYmUgdXNlZC4gVGhlIHNwZWNpZmllZCB0cmFuc2l0aW9uIGlzXG4gICAqIGFuaW1hdGVkIG92ZXIgdGhlIHNwZWNpZmllZCBkdXJhdGlvbiBmcm9tIDAgdG8gMS5cbiAgICpcbiAgICogQHBhcmFtIHsuL3RpbWUubm9ybXRpbWVEZWZ9IGRlbGF5XG4gICAqIEBwYXJhbSB7IVRyYW5zaXRpb25EZWY8Pz59IHRyYW5zaXRpb25cbiAgICogQHBhcmFtIHsuL3RpbWUubm9ybXRpbWVEZWZ9IGR1cmF0aW9uXG4gICAqIEBwYXJhbSB7KCEuL2N1cnZlLkN1cnZlRGVmfHN0cmluZyk9fSBvcHRfY3VydmVcbiAgICogQHJldHVybiB7IUFuaW1hdGlvbn1cbiAgICovXG4gIGFkZChkZWxheSwgdHJhbnNpdGlvbiwgZHVyYXRpb24sIG9wdF9jdXJ2ZSkge1xuICAgIHRoaXMuc2VnbWVudHNfLnB1c2goe1xuICAgICAgZGVsYXksXG4gICAgICBmdW5jOiB0cmFuc2l0aW9uLFxuICAgICAgZHVyYXRpb24sXG4gICAgICBjdXJ2ZTogZ2V0Q3VydmUob3B0X2N1cnZlKSxcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydHMgdGhlIGFuaW1hdGlvbiBhbmQgcmV0dXJucyB0aGUgQW5pbWF0aW9uUGxheWVyIG9iamVjdCB0aGF0IGNhbiBiZVxuICAgKiB1c2VkIHRvIG1vbml0b3IgYW5kIGNvbnRyb2wgdGhlIGFuaW1hdGlvbi5cbiAgICpcbiAgICogQHBhcmFtIHsuL3RpbWUudGltZURlZn0gZHVyYXRpb24gQWJzb2x1dGUgdGltZSBpbiBtaWxsaXNlY29uZHMuXG4gICAqIEByZXR1cm4geyFBbmltYXRpb25QbGF5ZXJ9XG4gICAqL1xuICBzdGFydChkdXJhdGlvbikge1xuICAgIGNvbnN0IHBsYXllciA9IG5ldyBBbmltYXRpb25QbGF5ZXIodGhpcy52c3luY18sIHRoaXMuY29udGV4dE5vZGVfLFxuICAgICAgICB0aGlzLnNlZ21lbnRzXywgdGhpcy5jdXJ2ZV8sIGR1cmF0aW9uKTtcbiAgICByZXR1cm4gcGxheWVyO1xuICB9XG59XG5cblxuLyoqXG4gKiBBbmltYXRpb25QbGF5ZXIgYWxsb3dzIHRyYWNraW5nIGFuZCBtb25pdG9yaW5nIG9mIHRoZSBydW5uaW5nIGFuaW1hdGlvbi5cbiAqIE1vc3QgaW1wb3J0YW50bHkgaXQgZXhwb3NlcyBtZXRob2RzIFwidGhlblwiIGFuZCBcInRoZW5BbHdheXNcIiB0aGF0IGhhdmUgdGhlXG4gKiBzZW1hbnRpY3Mgb2YgYSBQcm9taXNlIGFuZCBzaWduYWwgd2hlbiB0aGUgYW5pbWF0aW9uIGNvbXBsZXRlZCBvciBmYWlsZWQuXG4gKiBBZGRpdGlvbmFsbHksIGl0IGV4cG9zZXMgdGhlIG1ldGhvZCBcImhhbHRcIiB3aGljaCBhbGxvd3MgdG8gc3RvcC9yZXNldCB0aGVcbiAqIGFuaW1hdGlvbi5cbiAqIC8vIFRPRE8oQGNyYW1mb3JjZSkgQWN0dWFsbHkgZnVsbHkgaW1wbGVtZW50LlxuICogaW1wbGVtZW50cyB7SVRoZW5hYmxlfVxuICovXG5jbGFzcyBBbmltYXRpb25QbGF5ZXIge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0geyEuL3NlcnZpY2UvdnN5bmMtaW1wbC5Wc3luY30gdnN5bmNcbiAgICogQHBhcmFtIHshTm9kZX0gY29udGV4dE5vZGVcbiAgICogQHBhcmFtIHshQXJyYXk8IVNlZ21lbnREZWY+fSBzZWdtZW50c1xuICAgKiBAcGFyYW0gez8uL2N1cnZlLkN1cnZlRGVmfSBkZWZhdWx0Q3VydmVcbiAgICogQHBhcmFtIHsuL3RpbWUudGltZURlZn0gZHVyYXRpb25cbiAgICovXG4gIGNvbnN0cnVjdG9yKHZzeW5jLCBjb250ZXh0Tm9kZSwgc2VnbWVudHMsIGRlZmF1bHRDdXJ2ZSwgZHVyYXRpb24pIHtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyEuL3NlcnZpY2UvdnN5bmMtaW1wbC5Wc3luY30gKi9cbiAgICB0aGlzLnZzeW5jXyA9IHZzeW5jO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IU5vZGV9ICovXG4gICAgdGhpcy5jb250ZXh0Tm9kZV8gPSBjb250ZXh0Tm9kZTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFBcnJheTwhU2VnbWVudFJ1bnRpbWVEZWY+fSAqL1xuICAgIHRoaXMuc2VnbWVudHNfID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWdtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qgc2VnbWVudCA9IHNlZ21lbnRzW2ldO1xuICAgICAgdGhpcy5zZWdtZW50c18ucHVzaCh7XG4gICAgICAgIGRlbGF5OiBzZWdtZW50LmRlbGF5LFxuICAgICAgICBmdW5jOiBzZWdtZW50LmZ1bmMsXG4gICAgICAgIGR1cmF0aW9uOiBzZWdtZW50LmR1cmF0aW9uLFxuICAgICAgICBjdXJ2ZTogc2VnbWVudC5jdXJ2ZSB8fCBkZWZhdWx0Q3VydmUsXG4gICAgICAgIHN0YXJ0ZWQ6IGZhbHNlLFxuICAgICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCAqL1xuICAgIHRoaXMuZHVyYXRpb25fID0gZHVyYXRpb247XG5cbiAgICAvKiogQHByaXZhdGUgey4vdGltZS50aW1lRGVmfSAqL1xuICAgIHRoaXMuc3RhcnRUaW1lXyA9IERhdGUubm93KCk7XG5cbiAgICAvKiogQHByaXZhdGUgey4vdGltZS5ub3JtdGltZURlZn0gKi9cbiAgICAvLyB0aGlzLm5vcm1MaW5lYXJUaW1lXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUgey4vdGltZS5ub3JtdGltZURlZn0gKi9cbiAgICAvLyB0aGlzLm5vcm1UaW1lXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy5ydW5uaW5nXyA9IHRydWU7XG5cbiAgICAvKiogQHByaXZhdGUgeyFPYmplY3Q8c3RyaW5nLCAqPn0gKi9cbiAgICB0aGlzLnN0YXRlXyA9IHt9O1xuXG4gICAgY29uc3QgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcblxuICAgIC8qKiBAY29uc3QgQHByaXZhdGUgKi9cbiAgICB0aGlzLnByb21pc2VfID0gZGVmZXJyZWQucHJvbWlzZTtcblxuICAgIC8qKiBAY29uc3QgQHByaXZhdGUgKi9cbiAgICB0aGlzLnJlc29sdmVfID0gZGVmZXJyZWQucmVzb2x2ZTtcblxuICAgIC8qKiBAY29uc3QgQHByaXZhdGUgKi9cbiAgICB0aGlzLnJlamVjdF8gPSBkZWZlcnJlZC5yZWplY3Q7XG5cbiAgICAvKiogQGNvbnN0ICovXG4gICAgdGhpcy50YXNrXyA9IHRoaXMudnN5bmNfLmNyZWF0ZUFuaW1UYXNrKHRoaXMuY29udGV4dE5vZGVfLCB7XG4gICAgICBtdXRhdGU6IHRoaXMuc3RlcE11dGF0ZV8uYmluZCh0aGlzKSxcbiAgICB9KTtcblxuICAgIGlmICh0aGlzLnZzeW5jXy5jYW5BbmltYXRlKHRoaXMuY29udGV4dE5vZGVfKSkge1xuICAgICAgdGhpcy50YXNrXyh0aGlzLnN0YXRlXyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRldigpLndhcm4oVEFHXywgJ2Nhbm5vdCBhbmltYXRlJyk7XG4gICAgICB0aGlzLmNvbXBsZXRlXygvKiBzdWNjZXNzICovIGZhbHNlLCAvKiBkaXIgKi8gMCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENoYWlucyB0byB0aGUgYW5pbWF0aW9uJ3MgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB3aGVuIHRoZSBhbmltYXRpb24gaGFzXG4gICAqIGNvbXBsZXRlZCBvciB3aWxsIHJlamVjdCBpZiBhbmltYXRpb24gaGFzIGZhaWxlZCBvciB3YXMgaW50ZXJydXB0ZWQuXG4gICAqIEBwYXJhbSB7IUZ1bmN0aW9uPX0gb3B0X3Jlc29sdmVcbiAgICogQHBhcmFtIHshRnVuY3Rpb249fSBvcHRfcmVqZWN0XG4gICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgKi9cbiAgdGhlbihvcHRfcmVzb2x2ZSwgb3B0X3JlamVjdCkge1xuICAgIGlmICghb3B0X3Jlc29sdmUgJiYgIW9wdF9yZWplY3QpIHtcbiAgICAgIHJldHVybiB0aGlzLnByb21pc2VfO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5wcm9taXNlXy50aGVuKG9wdF9yZXNvbHZlLCBvcHRfcmVqZWN0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBmb3IgcmVnYXJkbGVzcyB3aGV0aGVyIHRoZSBhbmltYXRpb24gc3VjY2VlZHMgb3IgZmFpbHMuXG4gICAqIEBwYXJhbSB7IUZ1bmN0aW9uPX0gb3B0X2NhbGxiYWNrXG4gICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgKi9cbiAgdGhlbkFsd2F5cyhvcHRfY2FsbGJhY2spIHtcbiAgICBjb25zdCBjYWxsYmFjayA9IG9wdF9jYWxsYmFjayB8fCBOT09QX0NBTExCQUNLO1xuICAgIHJldHVybiB0aGlzLnRoZW4oY2FsbGJhY2ssIGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYWx0cyB0aGUgYW5pbWF0aW9uLiBEZXBlbmRpbmcgb24gdGhlIG9wdF9kaXIgdmFsdWUsIHRoZSBmb2xsb3dpbmcgYWN0aW9uc1xuICAgKiBjYW4gYmUgcGVyZm9ybWVkOlxuICAgKiAwOiBObyBhY3Rpb24uIFRoZSBzdGF0ZSB3aWxsIGJlIGFzIGF0IHRoZSBtb21lbnQgb2YgaGFsdGluZyAoZGVmYXVsdClcbiAgICogMTogRmluYWwgc3RhdGUuIFRyYW5zaXRpb25hYmxlIHdpbGwgYmUgc2V0IHRvIHN0YXRlID0gMS5cbiAgICogLTE6IFJlc2V0IHN0YXRlLiBUcmFuc2l0aW9uYWJsZSB3aWxsIGJlIHJlc2V0IHRvIHN0YXRlID0gMC5cbiAgICogVGhlIGFuaW1hdGlvbidzIHByb21pc2Ugd2lsbCBiZSByZWplY3RlZCBzaW5jZSB0aGUgdHJhbnNpdGlvbiBoYXMgYmVlblxuICAgKiBpbnRlcnJ1cHRlZC5cbiAgICogQHBhcmFtIHtudW1iZXI9fSBvcHRfZGlyXG4gICAqL1xuICBoYWx0KG9wdF9kaXIpIHtcbiAgICB0aGlzLmNvbXBsZXRlXygvKiBzdWNjZXNzICovIGZhbHNlLCAvKiBkaXIgKi8gb3B0X2RpciB8fCAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHN1Y2Nlc3NcbiAgICogQHBhcmFtIHtudW1iZXJ9IGRpclxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgY29tcGxldGVfKHN1Y2Nlc3MsIGRpcikge1xuICAgIGlmICghdGhpcy5ydW5uaW5nXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnJ1bm5pbmdfID0gZmFsc2U7XG4gICAgaWYgKGRpciAhPSAwKSB7XG4gICAgICAvLyBTb3J0IGluIHRoZSBjb21wbGV0aW9uIG9yZGVyLlxuICAgICAgaWYgKHRoaXMuc2VnbWVudHNfLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgdGhpcy5zZWdtZW50c18uc29ydCgoczEsIHMyKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIChzMS5kZWxheSArIHMxLmR1cmF0aW9uKSAtIChzMi5kZWxheSArIHMyLmR1cmF0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoZGlyID4gMCkge1xuICAgICAgICAgIC8vIE5hdHVyYWwgb3JkZXIgLSBhbGwgc2V0IHRvIDEuXG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnNlZ21lbnRzXy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5zZWdtZW50c19baV0uZnVuYygxLCB0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gUmV2ZXJzZSBvcmRlciAtIGFsbCBzZXQgdG8gMC5cbiAgICAgICAgICBmb3IgKGxldCBpID0gdGhpcy5zZWdtZW50c18ubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHRoaXMuc2VnbWVudHNfW2ldLmZ1bmMoMCwgZmFsc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBkZXYoKS5lcnJvcihUQUdfLCAnY29tcGxldGlvbiBmYWlsZWQ6ICcgKyBlLCBlKTtcbiAgICAgICAgc3VjY2VzcyA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgdGhpcy5yZXNvbHZlXygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlamVjdF8oKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgKj59IHVudXNlZFN0YXRlXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzdGVwTXV0YXRlXyh1bnVzZWRTdGF0ZSkge1xuICAgIGlmICghdGhpcy5ydW5uaW5nXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBjdXJyZW50VGltZSA9IERhdGUubm93KCk7XG4gICAgY29uc3Qgbm9ybUxpbmVhclRpbWUgPSBNYXRoLm1pbigoY3VycmVudFRpbWUgLSB0aGlzLnN0YXJ0VGltZV8pIC9cbiAgICAgICAgdGhpcy5kdXJhdGlvbl8sIDEpO1xuXG4gICAgLy8gU3RhcnQgc2VnbWVudHMgZHVlIHRvIGJlIHN0YXJ0ZWRcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2VnbWVudHNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBzZWdtZW50ID0gdGhpcy5zZWdtZW50c19baV07XG4gICAgICBpZiAoIXNlZ21lbnQuc3RhcnRlZCAmJiBub3JtTGluZWFyVGltZSA+PSBzZWdtZW50LmRlbGF5KSB7XG4gICAgICAgIHNlZ21lbnQuc3RhcnRlZCA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRXhlY3V0ZSBhbGwgcGVuZGluZyBzZWdtZW50cy5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2VnbWVudHNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBzZWdtZW50ID0gdGhpcy5zZWdtZW50c19baV07XG4gICAgICBpZiAoIXNlZ21lbnQuc3RhcnRlZCB8fCBzZWdtZW50LmNvbXBsZXRlZCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHRoaXMubXV0YXRlU2VnbWVudF8oc2VnbWVudCwgbm9ybUxpbmVhclRpbWUpO1xuICAgIH1cblxuICAgIC8vIENvbXBsZXRlIG9yIHN0YXJ0IG5leHQgY3ljbGUuXG4gICAgaWYgKG5vcm1MaW5lYXJUaW1lID09IDEpIHtcbiAgICAgIHRoaXMuY29tcGxldGVfKC8qIHN1Y2Nlc3MgKi8gdHJ1ZSwgLyogZGlyICovIDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy52c3luY18uY2FuQW5pbWF0ZSh0aGlzLmNvbnRleHROb2RlXykpIHtcbiAgICAgICAgdGhpcy50YXNrXyh0aGlzLnN0YXRlXyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkZXYoKS53YXJuKFRBR18sICdjYW5jZWwgYW5pbWF0aW9uJyk7XG4gICAgICAgIHRoaXMuY29tcGxldGVfKC8qIHN1Y2Nlc3MgKi8gZmFsc2UsIC8qIGRpciAqLyAwKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshU2VnbWVudFJ1bnRpbWVEZWZ9IHNlZ21lbnRcbiAgICogQHBhcmFtIHtudW1iZXJ9IHRvdGFsTGluZWFyVGltZVxuICAgKi9cbiAgbXV0YXRlU2VnbWVudF8oc2VnbWVudCwgdG90YWxMaW5lYXJUaW1lKSB7XG4gICAgbGV0IG5vcm1MaW5lYXJUaW1lO1xuICAgIGxldCBub3JtVGltZTtcbiAgICBpZiAoc2VnbWVudC5kdXJhdGlvbiA+IDApIHtcbiAgICAgIG5vcm1MaW5lYXJUaW1lID0gTWF0aC5taW4oKHRvdGFsTGluZWFyVGltZSAtIHNlZ21lbnQuZGVsYXkpIC9cbiAgICAgICAgICBzZWdtZW50LmR1cmF0aW9uLCAxKTtcbiAgICAgIG5vcm1UaW1lID0gbm9ybUxpbmVhclRpbWU7XG4gICAgICBpZiAoc2VnbWVudC5jdXJ2ZSAmJiBub3JtVGltZSAhPSAxKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgbm9ybVRpbWUgPSBzZWdtZW50LmN1cnZlKG5vcm1MaW5lYXJUaW1lKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGRldigpLmVycm9yKFRBR18sICdzdGVwIGN1cnZlIGZhaWxlZDogJyArIGUsIGUpO1xuICAgICAgICAgIHRoaXMuY29tcGxldGVfKC8qIHN1Y2Nlc3MgKi8gZmFsc2UsIC8qIGRpciAqLyAwKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgbm9ybUxpbmVhclRpbWUgPSAxO1xuICAgICAgbm9ybVRpbWUgPSAxO1xuICAgIH1cbiAgICBpZiAobm9ybUxpbmVhclRpbWUgPT0gMSkge1xuICAgICAgc2VnbWVudC5jb21wbGV0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgc2VnbWVudC5mdW5jKG5vcm1UaW1lLCBzZWdtZW50LmNvbXBsZXRlZCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgZGV2KCkuZXJyb3IoVEFHXywgJ3N0ZXAgbXV0YXRlIGZhaWxlZDogJyArIGUsIGUpO1xuICAgICAgdGhpcy5jb21wbGV0ZV8oLyogc3VjY2VzcyAqLyBmYWxzZSwgLyogZGlyICovIDApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxufVxuXG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgZGVsYXk6IC4vdGltZS5ub3JtdGltZURlZixcbiAqICAgZnVuYzogIVRyYW5zaXRpb25EZWYsXG4gKiAgIGR1cmF0aW9uOiAuL3RpbWUubm9ybXRpbWVEZWYsXG4gKiAgIGN1cnZlOiA/Li9jdXJ2ZS5DdXJ2ZURlZlxuICogfX1cbiAqL1xubGV0IFNlZ21lbnREZWY7XG5cblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBkZWxheTogLi90aW1lLm5vcm10aW1lRGVmLFxuICogICBmdW5jOiAhVHJhbnNpdGlvbkRlZixcbiAqICAgZHVyYXRpb246IC4vdGltZS5ub3JtdGltZURlZixcbiAqICAgY3VydmU6ID8uL2N1cnZlLkN1cnZlRGVmLFxuICogICBzdGFydGVkOiBib29sZWFuLFxuICogICBjb21wbGV0ZWQ6IGJvb2xlYW5cbiAqIH19XG4gKi9cbmxldCBTZWdtZW50UnVudGltZURlZjtcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEFsbG93cyBmb3IgcnVudGltZSBjb25maWd1cmF0aW9uLiBJbnRlcm5hbGx5LCB0aGUgcnVudGltZSBzaG91bGRcbiAqIHVzZSB0aGUgc3JjL2NvbmZpZy5qcyBtb2R1bGUgZm9yIHZhcmlvdXMgY29uc3RhbnRzLiBXZSBjYW4gdXNlIHRoZVxuICogQU1QX0NPTkZJRyBnbG9iYWwgdG8gdHJhbnNsYXRlIHVzZXItZGVmaW5lZCBjb25maWd1cmF0aW9ucyB0byB0aGlzXG4gKiBtb2R1bGUuXG4gKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59XG4gKi9cbmNvbnN0IGVudiA9IHNlbGYuQU1QX0NPTkZJRyB8fCB7fTtcblxuY29uc3QgdGhpcmRQYXJ0eUZyYW1lUmVnZXggPSB0eXBlb2YgZW52Wyd0aGlyZFBhcnR5RnJhbWVSZWdleCddID09ICdzdHJpbmcnID9cbiAgbmV3IFJlZ0V4cChlbnZbJ3RoaXJkUGFydHlGcmFtZVJlZ2V4J10pIDogZW52Wyd0aGlyZFBhcnR5RnJhbWVSZWdleCddO1xuXG5jb25zdCBjZG5Qcm94eVJlZ2V4ID0gdHlwZW9mIGVudlsnY2RuUHJveHlSZWdleCddID09ICdzdHJpbmcnID9cbiAgbmV3IFJlZ0V4cChlbnZbJ2NkblByb3h5UmVnZXgnXSkgOiBlbnZbJ2NkblByb3h5UmVnZXgnXTtcblxuLyoqIEB0eXBlIHshT2JqZWN0PHN0cmluZywgc3RyaW5nfGJvb2xlYW58UmVnRXhwPn0gKi9cbmV4cG9ydCBjb25zdCB1cmxzID0ge1xuICB0aGlyZFBhcnR5OiBlbnZbJ3RoaXJkUGFydHlVcmwnXSB8fCAnaHR0cHM6Ly8zcC5hbXBwcm9qZWN0Lm5ldCcsXG4gIHRoaXJkUGFydHlGcmFtZUhvc3Q6IGVudlsndGhpcmRQYXJ0eUZyYW1lSG9zdCddIHx8ICdhbXBwcm9qZWN0Lm5ldCcsXG4gIHRoaXJkUGFydHlGcmFtZVJlZ2V4OiB0aGlyZFBhcnR5RnJhbWVSZWdleCB8fCAvXmQtXFxkK1xcLmFtcHByb2plY3RcXC5uZXQkLyxcbiAgY2RuOiBlbnZbJ2NkblVybCddIHx8ICdodHRwczovL2Nkbi5hbXBwcm9qZWN0Lm9yZycsXG4gIC8qIE5vdGUgdGhhdCBjZG5Qcm94eVJlZ2V4IGlzIG9ubHkgZXZlciBjaGVja2VkIGFnYWluc3Qgb3JpZ2luc1xuICAgKiAocHJvdG86Ly9ob3N0Wzpwb3J0XSkgc28gZG9lcyBub3QgbmVlZCB0byBjb25zaWRlciBwYXRoXG4gICAqL1xuICBjZG5Qcm94eVJlZ2V4OiBjZG5Qcm94eVJlZ2V4IHx8XG4gICAgICAvXmh0dHBzOlxcL1xcLyhbYS16QS1aMC05Xy1dK1xcLik/Y2RuXFwuYW1wcHJvamVjdFxcLm9yZyQvLFxuICBsb2NhbGhvc3RSZWdleDogL15odHRwcz86XFwvXFwvbG9jYWxob3N0KDpcXGQrKT8kLyxcbiAgZXJyb3JSZXBvcnRpbmc6IGVudlsnZXJyb3JSZXBvcnRpbmdVcmwnXSB8fFxuICAgICAgJ2h0dHBzOi8vYW1wLWVycm9yLXJlcG9ydGluZy5hcHBzcG90LmNvbS9yJyxcbiAgbG9jYWxEZXY6IGVudlsnbG9jYWxEZXYnXSB8fCBmYWxzZSxcbn07XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIHVybHMsXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7ZW5kc1dpdGh9IGZyb20gJy4vc3RyaW5nJztcbmltcG9ydCB7XG4gIGlzUHJveHlPcmlnaW4sXG4gIHBhcnNlVXJsRGVwcmVjYXRlZCxcbiAgdHJ5RGVjb2RlVXJpQ29tcG9uZW50LFxufSBmcm9tICcuL3VybCc7XG5pbXBvcnQge3VybHN9IGZyb20gJy4vY29uZmlnJztcblxuXG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBjb29raWUuIFRoZSBjb29raWUgYWNjZXNzIGlzIHJlc3RyaWN0ZWQgYW5kIG11c3RcbiAqIGdvIHRocm91Z2ggdGhlIHByaXZhY3kgcmV2aWV3LiBCZWZvcmUgdXNpbmcgdGhpcyBtZXRob2QgcGxlYXNlIGZpbGUgYVxuICogR2l0SHViIGlzc3VlIHdpdGggXCJQcml2YWN5IFJldmlld1wiIGxhYmVsLlxuICpcbiAqIFJldHVybnMgdGhlIGNvb2tpZSdzIHZhbHVlIG9yIGBudWxsYC5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAqIEByZXR1cm4gez9zdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb29raWUod2luLCBuYW1lKSB7XG4gIGNvbnN0IGNvb2tpZVN0cmluZyA9IHRyeUdldERvY3VtZW50Q29va2llTm9JbmxpbmUod2luKTtcbiAgaWYgKCFjb29raWVTdHJpbmcpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBjb29raWVzID0gY29va2llU3RyaW5nLnNwbGl0KCc7Jyk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY29va2llcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGNvb2tpZSA9IGNvb2tpZXNbaV0udHJpbSgpO1xuICAgIGNvbnN0IGVxID0gY29va2llLmluZGV4T2YoJz0nKTtcbiAgICBpZiAoZXEgPT0gLTEpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAodHJ5RGVjb2RlVXJpQ29tcG9uZW50KGNvb2tpZS5zdWJzdHJpbmcoMCwgZXEpLnRyaW0oKSkgPT0gbmFtZSkge1xuICAgICAgY29uc3QgdmFsdWUgPSBjb29raWUuc3Vic3RyaW5nKGVxICsgMSkudHJpbSgpO1xuICAgICAgcmV0dXJuIHRyeURlY29kZVVyaUNvbXBvbmVudCh2YWx1ZSwgdmFsdWUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBUaGlzIG1ldGhvZCBzaG91bGQgbm90IGJlIGlubGluZWQgdG8gcHJldmVudCBUcnlDYXRjaCBkZW9wdGltaXphdGlvbi5cbiAqIE5vSW5saW5lIGtleXdvcmQgYXQgdGhlIGVuZCBvZiBmdW5jdGlvbiBuYW1lIGFsc28gcHJldmVudHMgQ2xvc3VyZSBjb21waWxlclxuICogZnJvbSBpbmxpbmluZyB0aGUgZnVuY3Rpb24uXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0cnlHZXREb2N1bWVudENvb2tpZU5vSW5saW5lKHdpbikge1xuICB0cnkge1xuICAgIHJldHVybiB3aW4uZG9jdW1lbnQuY29va2llO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gQWN0IGFzIGlmIG5vIGNvb2tpZSBpcyBhdmFpbGFibGUuIEV4Y2VwdGlvbnMgY2FuIGJlIHRocm93biB3aGVuXG4gICAgLy8gQU1QIGRvY3MgYXJlIG9wZW5lZCBvbiBvcmlnaW5zIHRoYXQgZG8gbm90IGFsbG93IHNldHRpbmdcbiAgICAvLyBjb29raWVzIHN1Y2ggYXMgbnVsbCBvcmlnaW5zLlxuICAgIHJldHVybiAnJztcbiAgfVxufVxuXG4vKipcbiAqIFNldHMgdGhlIHZhbHVlIG9mIHRoZSBjb29raWUuIFRoZSBjb29raWUgYWNjZXNzIGlzIHJlc3RyaWN0ZWQgYW5kIG11c3RcbiAqIGdvIHRocm91Z2ggdGhlIHByaXZhY3kgcmV2aWV3LiBCZWZvcmUgdXNpbmcgdGhpcyBtZXRob2QgcGxlYXNlIGZpbGUgYVxuICogR2l0SHViIGlzc3VlIHdpdGggXCJQcml2YWN5IFJldmlld1wiIGxhYmVsLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gKiBAcGFyYW0ge3RpbWV9IGV4cGlyYXRpb25UaW1lXG4gKiBAcGFyYW0ge3tcbiAqICAgaGlnaGVzdEF2YWlsYWJsZURvbWFpbjooYm9vbGVhbnx1bmRlZmluZWQpLFxuICogICBkb21haW46KHN0cmluZ3x1bmRlZmluZWQpXG4gKiB9PX0gb3B0X29wdGlvbnNcbiAqICAgICAtIGhpZ2hlc3RBdmFpbGFibGVEb21haW46IElmIHRydWUsIHNldCB0aGUgY29va2llIGF0IHRoZSB3aWRlc3QgZG9tYWluXG4gKiAgICAgICBzY29wZSBhbGxvd2VkIGJ5IHRoZSBicm93c2VyLiBFLmcuIG9uIGV4YW1wbGUuY29tIGlmIHdlIGFyZSBjdXJyZW50bHlcbiAqICAgICAgIG9uIHd3dy5leGFtcGxlLmNvbS5cbiAqICAgICAtIGRvbWFpbjogRXhwbGljaXQgZG9tYWluIHRvIHNldC5cbiAqICAgICAtIGFsbG93T25Qcm94eU9yaWdpbjogQWxsb3cgc2V0dGluZyBhIGNvb2tpZSBvbiB0aGUgQU1QIENhY2hlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0Q29va2llKHdpbiwgbmFtZSwgdmFsdWUsIGV4cGlyYXRpb25UaW1lLCBvcHRfb3B0aW9ucykge1xuICBjaGVja09yaWdpbkZvclNldHRpbmdDb29raWUod2luLCBvcHRfb3B0aW9ucywgbmFtZSk7XG4gIGlmIChvcHRfb3B0aW9ucyAmJiBvcHRfb3B0aW9ucy5oaWdoZXN0QXZhaWxhYmxlRG9tYWluKSB7XG4gICAgY29uc3QgcGFydHMgPSB3aW4ubG9jYXRpb24uaG9zdG5hbWUuc3BsaXQoJy4nKTtcbiAgICBsZXQgZG9tYWluID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMV07XG4gICAgZm9yIChsZXQgaSA9IHBhcnRzLmxlbmd0aCAtIDI7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBkb21haW4gPSBwYXJ0c1tpXSArICcuJyArIGRvbWFpbjtcbiAgICAgIHRyeVNldENvb2tpZSh3aW4sIG5hbWUsIHZhbHVlLCBleHBpcmF0aW9uVGltZSwgZG9tYWluKTtcbiAgICAgIGlmIChnZXRDb29raWUod2luLCBuYW1lKSA9PSB2YWx1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGxldCBkb21haW4gPSB1bmRlZmluZWQ7XG4gIGlmIChvcHRfb3B0aW9ucyAmJiBvcHRfb3B0aW9ucy5kb21haW4pIHtcbiAgICBkb21haW4gPSBvcHRfb3B0aW9ucy5kb21haW47XG4gIH1cbiAgdHJ5U2V0Q29va2llKHdpbiwgbmFtZSwgdmFsdWUsIGV4cGlyYXRpb25UaW1lLCBkb21haW4pO1xufVxuXG4vKipcbiAqIEF0dGVtcHQgdG8gc2V0IGEgY29va2llIHdpdGggdGhlIGdpdmVuIHBhcmFtcy5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICogQHBhcmFtIHt0aW1lfSBleHBpcmF0aW9uVGltZVxuICogQHBhcmFtIHtzdHJpbmd8dW5kZWZpbmVkfSBkb21haW5cbiAqL1xuZnVuY3Rpb24gdHJ5U2V0Q29va2llKHdpbiwgbmFtZSwgdmFsdWUsIGV4cGlyYXRpb25UaW1lLCBkb21haW4pIHtcbiAgLy8gV2UgZG8gbm90IGFsbG93IHNldHRpbmcgY29va2llcyBvbiB0aGUgZG9tYWluIHRoYXQgY29udGFpbnMgYm90aFxuICAvLyB0aGUgY2RuLiBhbmQgd3d3LiBob3N0cy5cbiAgaWYgKGRvbWFpbiA9PSAnYW1wcHJvamVjdC5vcmcnKSB7XG4gICAgLy8gQWN0aXZlbHkgZGVsZXRlIHRoZW0uXG4gICAgdmFsdWUgPSAnZGVsZXRlJztcbiAgICBleHBpcmF0aW9uVGltZSA9IDA7XG4gIH1cbiAgY29uc3QgY29va2llID0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJz0nICtcbiAgICAgIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgK1xuICAgICAgJzsgcGF0aD0vJyArXG4gICAgICAoZG9tYWluID8gJzsgZG9tYWluPScgKyBkb21haW4gOiAnJykgK1xuICAgICAgJzsgZXhwaXJlcz0nICsgbmV3IERhdGUoZXhwaXJhdGlvblRpbWUpLnRvVVRDU3RyaW5nKCk7XG4gIHRyeSB7XG4gICAgd2luLmRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZTtcbiAgfSBjYXRjaCAoaWdub3JlKSB7XG4gICAgLy8gRG8gbm90IHRocm93IGlmIHNldHRpbmcgdGhlIGNvb2tpZSBmYWlsZWQgRXhjZXB0aW9ucyBjYW4gYmUgdGhyb3duXG4gICAgLy8gd2hlbiBBTVAgZG9jcyBhcmUgb3BlbmVkIG9uIG9yaWdpbnMgdGhhdCBkbyBub3QgYWxsb3cgc2V0dGluZ1xuICAgIC8vIGNvb2tpZXMgc3VjaCBhcyBudWxsIG9yaWdpbnMuXG4gIH1cbn1cblxuLyoqXG4gKiBUaHJvd3MgaWYgYSBnaXZlbiBjb29raWUgc2hvdWxkIG5vdCBiZSBzZXQgb24gdGhlIGdpdmVuIG9yaWdpbi5cbiAqIFRoaXMgaXMgYSBkZWZlbnNlLWluLWRlcHRoLiBDYWxsZXJzIHNob3VsZCBuZXZlciBydW4gaW50byB0aGlzLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFPYmplY3R8dW5kZWZpbmVkfSBvcHRpb25zXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBGb3IgdGhlIGVycm9yIG1lc3NhZ2UuXG4gKi9cbmZ1bmN0aW9uIGNoZWNrT3JpZ2luRm9yU2V0dGluZ0Nvb2tpZSh3aW4sIG9wdGlvbnMsIG5hbWUpIHtcbiAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5hbGxvd09uUHJveHlPcmlnaW4pIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGlzUHJveHlPcmlnaW4od2luLmxvY2F0aW9uLmhyZWYpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdTaG91bGQgbmV2ZXIgYXR0ZW1wdCB0byBzZXQgY29va2llIG9uIHByb3h5IG9yaWdpbjogJ1xuICAgICAgICArIG5hbWUpO1xuICB9XG5cbiAgY29uc3QgY3VycmVudCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh3aW4ubG9jYXRpb24uaHJlZikuaG9zdG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgcHJveHkgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJscy5jZG4pLmhvc3RuYW1lLnRvTG93ZXJDYXNlKCk7XG4gIGlmIChjdXJyZW50ID09IHByb3h5IHx8IGVuZHNXaXRoKGN1cnJlbnQsICcuJyArIHByb3h5KSkge1xuICAgIHRocm93IG5ldyBFcnJvcignU2hvdWxkIG5ldmVyIGF0dGVtcHQgdG8gc2V0IGNvb2tpZSBvbiBwcm94eSBvcmlnaW4uJ1xuICAgICAgICArICcgKGluIGRlcHRoIGNoZWNrKTogJyArIG5hbWUpO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLy8gSW1wb3J0ZWQganVzdCBmb3IgdGhlIHNpZGUgZWZmZWN0IG9mIGdldHRpbmcgdGhlIGB0eXBlc2AgaXQgZXhwb3J0cyBpbnRvXG4vLyB0aGUgdHlwZSBzeXN0ZW0gZHVyaW5nIGNvbXBpbGUgdGltZS5cbmltcG9ydCAnLi90aW1lJztcblxuXG4vKipcbiAqIEEgQ3VydmVEZWYgaXMgYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBub3JtdGltZSB2YWx1ZSAoMCB0byAxKSBmb3IgYW5vdGhlclxuICogbm9ybXRpbWUgdmFsdWUuXG4gKiBAdHlwZWRlZiB7ZnVuY3Rpb24oLi90aW1lLm5vcm10aW1lRGVmKTogLi90aW1lLm5vcm10aW1lRGVmfVxuICovXG5leHBvcnQgbGV0IEN1cnZlRGVmO1xuXG5cbi8qKlxuICogUmV0dXJucyBhIGN1YmljIGJlemllciBjdXJ2ZS5cbiAqIEBwYXJhbSB7bnVtYmVyfSB4MSBYIGNvb3JkaW5hdGUgb2YgdGhlIGZpcnN0IGNvbnRyb2wgcG9pbnQuXG4gKiBAcGFyYW0ge251bWJlcn0geTEgWSBjb29yZGluYXRlIG9mIHRoZSBmaXJzdCBjb250cm9sIHBvaW50LlxuICogQHBhcmFtIHtudW1iZXJ9IHgyIFggY29vcmRpbmF0ZSBvZiB0aGUgc2Vjb25kIGNvbnRyb2wgcG9pbnQuXG4gKiBAcGFyYW0ge251bWJlcn0geTIgWSBjb29yZGluYXRlIG9mIHRoZSBzZWNvbmQgY29udHJvbCBwb2ludC5cbiAqIEByZXR1cm4geyFDdXJ2ZURlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJlemllckN1cnZlKHgxLCB5MSwgeDIsIHkyKSB7XG4gIGNvbnN0IGJlemllciA9IG5ldyBCZXppZXIoMCwgMCwgeDEsIHkxLCB4MiwgeTIsIDEsIDEpO1xuICByZXR1cm4gYmV6aWVyLnNvbHZlWVZhbHVlRnJvbVhWYWx1ZS5iaW5kKGJlemllcik7XG59XG5cblxuLyoqXG4gKiBUaGFua3MgdG9cbiAqIGh0dHBzOi8vY2xvc3VyZS1saWJyYXJ5Lmdvb2dsZWNvZGUuY29tL2dpdC1oaXN0b3J5L2RvY3MvbG9jYWxfY2xvc3VyZV9nb29nX21hdGhfYmV6aWVyLmpzLnNvdXJjZS5odG1sXG4gKi9cbmNsYXNzIEJlemllciB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4MCBYIGNvb3JkaW5hdGUgb2YgdGhlIHN0YXJ0IHBvaW50LlxuICAgKiBAcGFyYW0ge251bWJlcn0geTAgWSBjb29yZGluYXRlIG9mIHRoZSBzdGFydCBwb2ludC5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHgxIFggY29vcmRpbmF0ZSBvZiB0aGUgZmlyc3QgY29udHJvbCBwb2ludC5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHkxIFkgY29vcmRpbmF0ZSBvZiB0aGUgZmlyc3QgY29udHJvbCBwb2ludC5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHgyIFggY29vcmRpbmF0ZSBvZiB0aGUgc2Vjb25kIGNvbnRyb2wgcG9pbnQuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5MiBZIGNvb3JkaW5hdGUgb2YgdGhlIHNlY29uZCBjb250cm9sIHBvaW50LlxuICAgKiBAcGFyYW0ge251bWJlcn0geDMgWCBjb29yZGluYXRlIG9mIHRoZSBlbmQgcG9pbnQuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5MyBZIGNvb3JkaW5hdGUgb2YgdGhlIGVuZCBwb2ludC5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5Mykge1xuICAgIC8qKlxuICAgICAqIFggY29vcmRpbmF0ZSBvZiB0aGUgZmlyc3QgcG9pbnQuXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLngwID0geDA7XG5cbiAgICAvKipcbiAgICAgKiBZIGNvb3JkaW5hdGUgb2YgdGhlIGZpcnN0IHBvaW50LlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy55MCA9IHkwO1xuXG4gICAgLyoqXG4gICAgICogWCBjb29yZGluYXRlIG9mIHRoZSBmaXJzdCBjb250cm9sIHBvaW50LlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy54MSA9IHgxO1xuXG4gICAgLyoqXG4gICAgICogWSBjb29yZGluYXRlIG9mIHRoZSBmaXJzdCBjb250cm9sIHBvaW50LlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy55MSA9IHkxO1xuXG4gICAgLyoqXG4gICAgICogWCBjb29yZGluYXRlIG9mIHRoZSBzZWNvbmQgY29udHJvbCBwb2ludC5cbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHRoaXMueDIgPSB4MjtcblxuICAgIC8qKlxuICAgICAqIFkgY29vcmRpbmF0ZSBvZiB0aGUgc2Vjb25kIGNvbnRyb2wgcG9pbnQuXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLnkyID0geTI7XG5cbiAgICAvKipcbiAgICAgKiBYIGNvb3JkaW5hdGUgb2YgdGhlIGVuZCBwb2ludC5cbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHRoaXMueDMgPSB4MztcblxuICAgIC8qKlxuICAgICAqIFkgY29vcmRpbmF0ZSBvZiB0aGUgZW5kIHBvaW50LlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy55MyA9IHkzO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbXB1dGVzIHRoZSB5IGNvb3JkaW5hdGUgb2YgYSBwb2ludCBvbiB0aGUgY3VydmUgZ2l2ZW4gaXRzIHggY29vcmRpbmF0ZS5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHhWYWwgVGhlIHggY29vcmRpbmF0ZSBvZiB0aGUgcG9pbnQgb24gdGhlIGN1cnZlLlxuICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSB5IGNvb3JkaW5hdGUgb2YgdGhlIHBvaW50IG9uIHRoZSBjdXJ2ZS5cbiAgICovXG4gIHNvbHZlWVZhbHVlRnJvbVhWYWx1ZSh4VmFsKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0UG9pbnRZKHRoaXMuc29sdmVQb3NpdGlvbkZyb21YVmFsdWUoeFZhbCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbXB1dGVzIHRoZSBwb3NpdGlvbiB0IG9mIGEgcG9pbnQgb24gdGhlIGN1cnZlIGdpdmVuIGl0cyB4IGNvb3JkaW5hdGUuXG4gICAqIFRoYXQgaXMsIGZvciBhbiBpbnB1dCB4VmFsLCBmaW5kcyB0IHMudC4gZ2V0UG9pbnRYKHQpID0geFZhbC5cbiAgICogQXMgc3VjaCwgdGhlIGZvbGxvd2luZyBzaG91bGQgYWx3YXlzIGJlIHRydWUgdXAgdG8gc29tZSBzbWFsbCBlcHNpbG9uOlxuICAgKiB0IH4gc29sdmVQb3NpdGlvbkZyb21YVmFsdWUoZ2V0UG9pbnRYKHQpKSBmb3IgdCBpbiBbMCwgMV0uXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4VmFsIFRoZSB4IGNvb3JkaW5hdGUgb2YgdGhlIHBvaW50IHRvIGZpbmQgb24gdGhlIGN1cnZlLlxuICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBwb3NpdGlvbiB0LlxuICAgKi9cbiAgc29sdmVQb3NpdGlvbkZyb21YVmFsdWUoeFZhbCkge1xuICAgIC8vIERlc2lyZWQgcHJlY2lzaW9uIG9uIHRoZSBjb21wdXRhdGlvbi5cbiAgICBjb25zdCBlcHNpbG9uID0gMWUtNjtcblxuICAgIC8vIEluaXRpYWwgZXN0aW1hdGUgb2YgdCB1c2luZyBsaW5lYXIgaW50ZXJwb2xhdGlvbi5cbiAgICBsZXQgdCA9ICh4VmFsIC0gdGhpcy54MCkgLyAodGhpcy54MyAtIHRoaXMueDApO1xuICAgIGlmICh0IDw9IDApIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH0gZWxzZSBpZiAodCA+PSAxKSB7XG4gICAgICByZXR1cm4gMTtcbiAgICB9XG5cbiAgICAvLyBUcnkgZ3JhZGllbnQgZGVzY2VudCB0byBzb2x2ZSBmb3IgdC4gSWYgaXQgd29ya3MsIGl0IGlzIHZlcnkgZmFzdC5cbiAgICBsZXQgdE1pbiA9IDA7XG4gICAgbGV0IHRNYXggPSAxO1xuICAgIGxldCB2YWx1ZSA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICAgIHZhbHVlID0gdGhpcy5nZXRQb2ludFgodCk7XG4gICAgICBjb25zdCBkZXJpdmF0aXZlID0gKHRoaXMuZ2V0UG9pbnRYKHQgKyBlcHNpbG9uKSAtIHZhbHVlKSAvIGVwc2lsb247XG4gICAgICBpZiAoTWF0aC5hYnModmFsdWUgLSB4VmFsKSA8IGVwc2lsb24pIHtcbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgICB9IGVsc2UgaWYgKE1hdGguYWJzKGRlcml2YXRpdmUpIDwgZXBzaWxvbikge1xuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh2YWx1ZSA8IHhWYWwpIHtcbiAgICAgICAgICB0TWluID0gdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0TWF4ID0gdDtcbiAgICAgICAgfVxuICAgICAgICB0IC09ICh2YWx1ZSAtIHhWYWwpIC8gZGVyaXZhdGl2ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgZ3JhZGllbnQgZGVzY2VudCBnb3Qgc3R1Y2sgaW4gYSBsb2NhbCBtaW5pbXVtLCBlLmcuIGJlY2F1c2VcbiAgICAvLyB0aGUgZGVyaXZhdGl2ZSB3YXMgY2xvc2UgdG8gMCwgdXNlIGEgRGljaG90b215IHJlZmluZW1lbnQgaW5zdGVhZC5cbiAgICAvLyBXZSBsaW1pdCB0aGUgbnVtYmVyIG9mIGl0ZXJhdGlvbnMgdG8gOC5cbiAgICBmb3IgKGxldCBpID0gMDsgTWF0aC5hYnModmFsdWUgLSB4VmFsKSA+IGVwc2lsb24gJiYgaSA8IDg7IGkrKykge1xuICAgICAgaWYgKHZhbHVlIDwgeFZhbCkge1xuICAgICAgICB0TWluID0gdDtcbiAgICAgICAgdCA9ICh0ICsgdE1heCkgLyAyO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdE1heCA9IHQ7XG4gICAgICAgIHQgPSAodCArIHRNaW4pIC8gMjtcbiAgICAgIH1cbiAgICAgIHZhbHVlID0gdGhpcy5nZXRQb2ludFgodCk7XG4gICAgfVxuICAgIHJldHVybiB0O1xuICB9XG5cbiAgLyoqXG4gICAqIENvbXB1dGVzIHRoZSBjdXJ2ZSdzIFggY29vcmRpbmF0ZSBhdCBhIHBvaW50IGJldHdlZW4gMCBhbmQgMS5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHQgVGhlIHBvaW50IG9uIHRoZSBjdXJ2ZSB0byBmaW5kLlxuICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBjb21wdXRlZCBjb29yZGluYXRlLlxuICAgKi9cbiAgZ2V0UG9pbnRYKHQpIHtcbiAgICAvLyBTcGVjaWFsIGNhc2Ugc3RhcnQgYW5kIGVuZC5cbiAgICBpZiAodCA9PSAwKSB7XG4gICAgICByZXR1cm4gdGhpcy54MDtcbiAgICB9IGVsc2UgaWYgKHQgPT0gMSkge1xuICAgICAgcmV0dXJuIHRoaXMueDM7XG4gICAgfVxuXG4gICAgLy8gU3RlcCBvbmUgLSBmcm9tIDQgcG9pbnRzIHRvIDNcbiAgICBsZXQgaXgwID0gdGhpcy5sZXJwKHRoaXMueDAsIHRoaXMueDEsIHQpO1xuICAgIGxldCBpeDEgPSB0aGlzLmxlcnAodGhpcy54MSwgdGhpcy54MiwgdCk7XG4gICAgY29uc3QgaXgyID0gdGhpcy5sZXJwKHRoaXMueDIsIHRoaXMueDMsIHQpO1xuXG4gICAgLy8gU3RlcCB0d28gLSBmcm9tIDMgcG9pbnRzIHRvIDJcbiAgICBpeDAgPSB0aGlzLmxlcnAoaXgwLCBpeDEsIHQpO1xuICAgIGl4MSA9IHRoaXMubGVycChpeDEsIGl4MiwgdCk7XG5cbiAgICAvLyBGaW5hbCBzdGVwIC0gbGFzdCBwb2ludFxuICAgIHJldHVybiB0aGlzLmxlcnAoaXgwLCBpeDEsIHQpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbXB1dGVzIHRoZSBjdXJ2ZSdzIFkgY29vcmRpbmF0ZSBhdCBhIHBvaW50IGJldHdlZW4gMCBhbmQgMS5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHQgVGhlIHBvaW50IG9uIHRoZSBjdXJ2ZSB0byBmaW5kLlxuICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBjb21wdXRlZCBjb29yZGluYXRlLlxuICAgKi9cbiAgZ2V0UG9pbnRZKHQpIHtcbiAgICAvLyBTcGVjaWFsIGNhc2Ugc3RhcnQgYW5kIGVuZC5cbiAgICBpZiAodCA9PSAwKSB7XG4gICAgICByZXR1cm4gdGhpcy55MDtcbiAgICB9IGVsc2UgaWYgKHQgPT0gMSkge1xuICAgICAgcmV0dXJuIHRoaXMueTM7XG4gICAgfVxuXG4gICAgLy8gU3RlcCBvbmUgLSBmcm9tIDQgcG9pbnRzIHRvIDNcbiAgICBsZXQgaXkwID0gdGhpcy5sZXJwKHRoaXMueTAsIHRoaXMueTEsIHQpO1xuICAgIGxldCBpeTEgPSB0aGlzLmxlcnAodGhpcy55MSwgdGhpcy55MiwgdCk7XG4gICAgY29uc3QgaXkyID0gdGhpcy5sZXJwKHRoaXMueTIsIHRoaXMueTMsIHQpO1xuXG4gICAgLy8gU3RlcCB0d28gLSBmcm9tIDMgcG9pbnRzIHRvIDJcbiAgICBpeTAgPSB0aGlzLmxlcnAoaXkwLCBpeTEsIHQpO1xuICAgIGl5MSA9IHRoaXMubGVycChpeTEsIGl5MiwgdCk7XG5cbiAgICAvLyBGaW5hbCBzdGVwIC0gbGFzdCBwb2ludFxuICAgIHJldHVybiB0aGlzLmxlcnAoaXkwLCBpeTEsIHQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGxpbmVhciBpbnRlcnBvbGF0aW9uIGJldHdlZW4gdmFsdWVzIGEgYW5kIGIuIFJldHVybnMgdGhlIHZhbHVlXG4gICAqIGJldHdlZW4gYSBhbmQgYiBwcm9wb3J0aW9uYWwgdG8geCAod2hlbiB4IGlzIGJldHdlZW4gMCBhbmQgMS4gV2hlbiB4IGlzXG4gICAqIG91dHNpZGUgdGhpcyByYW5nZSwgdGhlIHJldHVybiB2YWx1ZSBpcyBhIGxpbmVhciBleHRyYXBvbGF0aW9uKS5cbiAgICogQHBhcmFtIHtudW1iZXJ9IGEgQSBudW1iZXIuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBiIEEgbnVtYmVyLlxuICAgKiBAcGFyYW0ge251bWJlcn0geCBUaGUgcHJvcG9ydGlvbiBiZXR3ZWVuIGEgYW5kIGIuXG4gICAqIEByZXR1cm4ge251bWJlcn0gVGhlIGludGVycG9sYXRlZCB2YWx1ZSBiZXR3ZWVuIGEgYW5kIGIuXG4gICAqL1xuICBsZXJwKGEsIGIsIHgpIHtcbiAgICByZXR1cm4gYSArIHggKiAoYiAtIGEpO1xuICB9XG59XG5cblxuLyoqXG4gKiBBIGNvbGxlY3Rpb24gb2YgY29tbW9uIGN1cnZlcy5cbiAqIFNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9DU1MvdGltaW5nLWZ1bmN0aW9uXG4gKiBAZW51bSB7IUN1cnZlRGVmfVxuICovXG5leHBvcnQgY29uc3QgQ3VydmVzID0ge1xuICAvKipcbiAgICogbGluZWFyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBuXG4gICAqIEByZXR1cm4ge251bWJlcn1cbiAgICovXG4gIExJTkVBUihuKSB7cmV0dXJuIG47fSxcblxuICAvKipcbiAgICogZWFzZVxuICAgKi9cbiAgRUFTRTogYmV6aWVyQ3VydmUoMC4yNSwgMC4xLCAwLjI1LCAxLjApLFxuXG4gIC8qKlxuICAgKiBlYXNlLWluOiBzbG93IG91dCwgZmFzdCBpblxuICAgKi9cbiAgRUFTRV9JTjogYmV6aWVyQ3VydmUoMC40MiwgMC4wLCAxLjAsIDEuMCksXG5cbiAgLyoqXG4gICAqIGVhc2Utb3V0OiBmYXN0IG91dCwgc2xvdyBpblxuICAgKi9cbiAgRUFTRV9PVVQ6IGJlemllckN1cnZlKDAuMCwgMC4wLCAwLjU4LCAxLjApLFxuXG4gIC8qKlxuICAgKiBlYXNlLWluLW91dFxuICAgKi9cbiAgRUFTRV9JTl9PVVQ6IGJlemllckN1cnZlKDAuNDIsIDAuMCwgMC41OCwgMS4wKSxcbn07XG5cblxuLyoqXG4gKiBAY29uc3QgeyFPYmplY3Q8c3RyaW5nLCAhQ3VydmVEZWY+fVxuICovXG5jb25zdCBOQU1FX01BUCA9IHtcbiAgJ2xpbmVhcic6IEN1cnZlcy5MSU5FQVIsXG4gICdlYXNlJzogQ3VydmVzLkVBU0UsXG4gICdlYXNlLWluJzogQ3VydmVzLkVBU0VfSU4sXG4gICdlYXNlLW91dCc6IEN1cnZlcy5FQVNFX09VVCxcbiAgJ2Vhc2UtaW4tb3V0JzogQ3VydmVzLkVBU0VfSU5fT1VULFxufTtcblxuXG4vKipcbiAqIElmIHRoZSBhcmd1bWVudCBpcyBhIHN0cmluZywgdGhpcyBtZXRob2RzIG1hdGNoZXMgYW4gZXhpc3RpbmcgY3VydmUgYnkgbmFtZS5cbiAqIEBwYXJhbSB7P0N1cnZlRGVmfHN0cmluZ3x1bmRlZmluZWR9IGN1cnZlXG4gKiBAcmV0dXJuIHs/Q3VydmVEZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJ2ZShjdXJ2ZSkge1xuICBpZiAoIWN1cnZlKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgaWYgKHR5cGVvZiBjdXJ2ZSA9PSAnc3RyaW5nJykge1xuICAgIC8vIElmIHRoZSBjdXJ2ZSBpcyBhIGN1c3RvbSBjdWJpYy1iZXppZXIgY3VydmVcbiAgICBpZiAoY3VydmUuaW5kZXhPZignY3ViaWMtYmV6aWVyJykgIT0gLTEpIHtcbiAgICAgIGNvbnN0IG1hdGNoID0gY3VydmUubWF0Y2goL2N1YmljLWJlemllclxcKCguKylcXCkvKTtcbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSBtYXRjaFsxXS5zcGxpdCgnLCcpLm1hcChwYXJzZUZsb2F0KTtcbiAgICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPT0gNCkge1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoaXNOYU4odmFsdWVzW2ldKSkge1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGJlemllckN1cnZlKHZhbHVlc1swXSwgdmFsdWVzWzFdLCB2YWx1ZXNbMl0sIHZhbHVlc1szXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gTkFNRV9NQVBbY3VydmVdO1xuICB9XG4gIHJldHVybiBjdXJ2ZTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge0RlZmVycmVkfSBmcm9tICcuL3V0aWxzL3Byb21pc2UnO1xuaW1wb3J0IHtjc3NFc2NhcGV9IGZyb20gJy4uL3RoaXJkX3BhcnR5L2Nzcy1lc2NhcGUvY3NzLWVzY2FwZSc7XG5pbXBvcnQge2Rldn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtkaWN0fSBmcm9tICcuL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge3N0YXJ0c1dpdGh9IGZyb20gJy4vc3RyaW5nJztcbmltcG9ydCB7dG9XaW59IGZyb20gJy4vdHlwZXMnO1xuXG5jb25zdCBIVE1MX0VTQ0FQRV9DSEFSUyA9IHtcbiAgJyYnOiAnJmFtcDsnLFxuICAnPCc6ICcmbHQ7JyxcbiAgJz4nOiAnJmd0OycsXG4gICdcIic6ICcmcXVvdDsnLFxuICBcIidcIjogJyYjeDI3OycsXG4gICdgJzogJyYjeDYwOycsXG59O1xuY29uc3QgSFRNTF9FU0NBUEVfUkVHRVggPSAvKCZ8PHw+fFwifCd8YCkvZztcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuZXhwb3J0IGNvbnN0IFVQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9QUk9NSVNFID1cbiAgICAnX19BTVBfVVBHX1BSTSc7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUkVTT0xWRVIgPVxuICAgICdfX0FNUF9VUEdfUkVTJztcblxuLyoqXG4gKiBXYWl0cyB1bnRpbCB0aGUgY2hpbGQgZWxlbWVudCBpcyBjb25zdHJ1Y3RlZC4gT25jZSB0aGUgY2hpbGQgaXMgZm91bmQsIHRoZVxuICogY2FsbGJhY2sgaXMgZXhlY3V0ZWQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IGNoZWNrRnVuY1xuICogQHBhcmFtIHtmdW5jdGlvbigpfSBjYWxsYmFja1xuICovXG5leHBvcnQgZnVuY3Rpb24gd2FpdEZvckNoaWxkKHBhcmVudCwgY2hlY2tGdW5jLCBjYWxsYmFjaykge1xuICBpZiAoY2hlY2tGdW5jKHBhcmVudCkpIHtcbiAgICBjYWxsYmFjaygpO1xuICAgIHJldHVybjtcbiAgfVxuICAvKiogQGNvbnN0IHshV2luZG93fSAqL1xuICBjb25zdCB3aW4gPSB0b1dpbihwYXJlbnQub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldyk7XG4gIGlmICh3aW4uTXV0YXRpb25PYnNlcnZlcikge1xuICAgIC8qKiBAY29uc3Qge011dGF0aW9uT2JzZXJ2ZXJ9ICovXG4gICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgd2luLk11dGF0aW9uT2JzZXJ2ZXIoKCkgPT4ge1xuICAgICAgaWYgKGNoZWNrRnVuYyhwYXJlbnQpKSB7XG4gICAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBvYnNlcnZlci5vYnNlcnZlKHBhcmVudCwge2NoaWxkTGlzdDogdHJ1ZX0pO1xuICB9IGVsc2Uge1xuICAgIC8qKiBAY29uc3Qge251bWJlcn0gKi9cbiAgICBjb25zdCBpbnRlcnZhbCA9IHdpbi5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBpZiAoY2hlY2tGdW5jKHBhcmVudCkpIHtcbiAgICAgICAgd2luLmNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfVxuICAgIH0sIC8qIG1pbGxpc2Vjb25kcyAqLyA1KTtcbiAgfVxufVxuXG4vKipcbiAqIFdhaXRzIHVudGlsIHRoZSBjaGlsZCBlbGVtZW50IGlzIGNvbnN0cnVjdGVkLiBPbmNlIHRoZSBjaGlsZCBpcyBmb3VuZCwgdGhlXG4gKiBwcm9taXNlIGlzIHJlc29sdmVkLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjaGVja0Z1bmNcbiAqIEByZXR1cm4geyFQcm9taXNlfVxuICovXG5leHBvcnQgZnVuY3Rpb24gd2FpdEZvckNoaWxkUHJvbWlzZShwYXJlbnQsIGNoZWNrRnVuYykge1xuICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgd2FpdEZvckNoaWxkKHBhcmVudCwgY2hlY2tGdW5jLCByZXNvbHZlKTtcbiAgfSk7XG59XG5cbi8qKlxuICogV2FpdHMgZm9yIGRvY3VtZW50J3MgYm9keSB0byBiZSBhdmFpbGFibGUuXG4gKiBXaWxsIGJlIGRlcHJlY2F0ZWQgc29vbjsgdXNlIHtAbGluayBBbXBEb2Mjd2hlbkJvZHlBdmFpbGFibGV9IG9yXG4gKiBAe2xpbmsgRG9jdW1lbnRTdGF0ZSNvbkJvZHlBdmFpbGFibGV9IGluc3RlYWQuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGNhbGxiYWNrXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3YWl0Rm9yQm9keShkb2MsIGNhbGxiYWNrKSB7XG4gIHdhaXRGb3JDaGlsZChkb2MuZG9jdW1lbnRFbGVtZW50LCAoKSA9PiAhIWRvYy5ib2R5LCBjYWxsYmFjayk7XG59XG5cblxuLyoqXG4gKiBXYWl0cyBmb3IgZG9jdW1lbnQncyBib2R5IHRvIGJlIGF2YWlsYWJsZS5cbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2NcbiAqIEByZXR1cm4geyFQcm9taXNlfVxuICovXG5leHBvcnQgZnVuY3Rpb24gd2FpdEZvckJvZHlQcm9taXNlKGRvYykge1xuICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgd2FpdEZvckJvZHkoZG9jLCByZXNvbHZlKTtcbiAgfSk7XG59XG5cblxuLyoqXG4gKiBSZW1vdmVzIHRoZSBlbGVtZW50LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlRWxlbWVudChlbGVtZW50KSB7XG4gIGlmIChlbGVtZW50LnBhcmVudEVsZW1lbnQpIHtcbiAgICBlbGVtZW50LnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFJlbW92ZXMgYWxsIGNoaWxkIG5vZGVzIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlQ2hpbGRyZW4ocGFyZW50KSB7XG4gIHdoaWxlIChwYXJlbnQuZmlyc3RDaGlsZCkge1xuICAgIHBhcmVudC5yZW1vdmVDaGlsZChwYXJlbnQuZmlyc3RDaGlsZCk7XG4gIH1cbn1cblxuXG4vKipcbiAqIENvcGllcyBhbGwgY2hpbGRyZW4gbm9kZXMgb2YgZWxlbWVudCBcImZyb21cIiB0byBlbGVtZW50IFwidG9cIi4gQ2hpbGQgbm9kZXNcbiAqIGFyZSBkZWVwbHkgY2xvbmVkLiBOb3RpY2UsIHRoYXQgdGhpcyBtZXRob2Qgc2hvdWxkIGJlIHVzZWQgd2l0aCBjYXJlIGFuZFxuICogcHJlZmVyYWJseSBvbiBzbWFsbGVyIHN1YnRyZWVzLlxuICogQHBhcmFtIHshRWxlbWVudH0gZnJvbVxuICogQHBhcmFtIHshRWxlbWVudHwhRG9jdW1lbnRGcmFnbWVudH0gdG9cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvcHlDaGlsZHJlbihmcm9tLCB0bykge1xuICBjb25zdCBmcmFnID0gdG8ub3duZXJEb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gIGZvciAobGV0IG4gPSBmcm9tLmZpcnN0Q2hpbGQ7IG47IG4gPSBuLm5leHRTaWJsaW5nKSB7XG4gICAgZnJhZy5hcHBlbmRDaGlsZChuLmNsb25lTm9kZSh0cnVlKSk7XG4gIH1cbiAgdG8uYXBwZW5kQ2hpbGQoZnJhZyk7XG59XG5cbi8qKlxuICogSW5zZXJ0IHRoZSBlbGVtZW50IGluIHRoZSByb290IGFmdGVyIHRoZSBlbGVtZW50IG5hbWVkIGFmdGVyIG9yXG4gKiBpZiB0aGF0IGlzIG51bGwgYXQgdGhlIGJlZ2lubmluZy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IVNoYWRvd1Jvb3R9IHJvb3RcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7P05vZGV9IGFmdGVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRBZnRlck9yQXRTdGFydChyb290LCBlbGVtZW50LCBhZnRlcikge1xuICBjb25zdCBiZWZvcmUgPSBhZnRlciA/IGFmdGVyLm5leHRTaWJsaW5nIDogcm9vdC5maXJzdENoaWxkO1xuICByb290Lmluc2VydEJlZm9yZShlbGVtZW50LCBiZWZvcmUpO1xufVxuXG4vKipcbiAqIEFkZCBhdHRyaWJ1dGVzIHRvIGFuIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0geyFKc29uT2JqZWN0PHN0cmluZywgc3RyaW5nPn0gYXR0cmlidXRlc1xuICogQHJldHVybiB7IUVsZW1lbnR9IGNyZWF0ZWQgZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkQXR0cmlidXRlc1RvRWxlbWVudChlbGVtZW50LCBhdHRyaWJ1dGVzKSB7XG4gIGZvciAoY29uc3QgYXR0ciBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoYXR0ciwgYXR0cmlidXRlc1thdHRyXSk7XG4gIH1cbiAgcmV0dXJuIGVsZW1lbnQ7XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgbmV3IGVsZW1lbnQgb24gZG9jdW1lbnQgd2l0aCBzcGVjaWZpZWQgdGFnTmFtZSBhbmQgYXR0cmlidXRlcy5cbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0PHN0cmluZywgc3RyaW5nPn0gYXR0cmlidXRlc1xuICogQHJldHVybiB7IUVsZW1lbnR9IGNyZWF0ZWQgZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRWxlbWVudFdpdGhBdHRyaWJ1dGVzKGRvYywgdGFnTmFtZSwgYXR0cmlidXRlcykge1xuICBjb25zdCBlbGVtZW50ID0gZG9jLmNyZWF0ZUVsZW1lbnQodGFnTmFtZSk7XG4gIHJldHVybiBhZGRBdHRyaWJ1dGVzVG9FbGVtZW50KGVsZW1lbnQsIGF0dHJpYnV0ZXMpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBub2RlIGlzIGNvbm5lY3RlZCAoYXR0YWNoZWQpLlxuICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEBzZWUgaHR0cHM6Ly9kb20uc3BlYy53aGF0d2cub3JnLyNjb25uZWN0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQ29ubmVjdGVkTm9kZShub2RlKSB7XG4gIGNvbnN0IGNvbm5lY3RlZCA9IG5vZGUuaXNDb25uZWN0ZWQ7XG4gIGlmIChjb25uZWN0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBjb25uZWN0ZWQ7XG4gIH1cblxuICAvLyBcIkFuIGVsZW1lbnQgaXMgY29ubmVjdGVkIGlmIGl0cyBzaGFkb3ctaW5jbHVkaW5nIHJvb3QgaXMgYSBkb2N1bWVudC5cIlxuICBsZXQgbiA9IG5vZGU7XG4gIGRvIHtcbiAgICBuID0gcm9vdE5vZGVGb3Iobik7XG4gICAgaWYgKG4uaG9zdCkge1xuICAgICAgbiA9IG4uaG9zdDtcbiAgICB9IGVsc2Uge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9IHdoaWxlICh0cnVlKTtcbiAgcmV0dXJuIG4ubm9kZVR5cGUgPT09IE5vZGUuRE9DVU1FTlRfTk9ERTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSByb290IGZvciBhIGdpdmVuIG5vZGUuIERvZXMgbm90IGNyb3NzIHNoYWRvdyBET00gYm91bmRhcnkuXG4gKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gKiBAcmV0dXJuIHshTm9kZX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJvb3ROb2RlRm9yKG5vZGUpIHtcbiAgaWYgKE5vZGUucHJvdG90eXBlLmdldFJvb3ROb2RlKSB7XG4gICAgLy8gVHlwZSBjaGVja2VyIHNheXMgYGdldFJvb3ROb2RlYCBtYXkgcmV0dXJuIG51bGwuXG4gICAgcmV0dXJuIG5vZGUuZ2V0Um9vdE5vZGUoKSB8fCBub2RlO1xuICB9XG4gIGxldCBuO1xuICBmb3IgKG4gPSBub2RlOyAhIW4ucGFyZW50Tm9kZTsgbiA9IG4ucGFyZW50Tm9kZSkge31cbiAgcmV0dXJuIG47XG59XG5cbi8qKlxuICogRmluZHMgdGhlIGNsb3Nlc3QgZWxlbWVudCB0aGF0IHNhdGlzZmllcyB0aGUgY2FsbGJhY2sgZnJvbSB0aGlzIGVsZW1lbnRcbiAqIHVwIHRoZSBET00gc3VidHJlZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IGNhbGxiYWNrXG4gKiBAcGFyYW0ge0VsZW1lbnQ9fSBvcHRfc3RvcEF0IG9wdGlvbmFsIGVsZW1udCB0byBzdG9wIHRoZSBzZWFyY2ggYXQuXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsb3Nlc3QoZWxlbWVudCwgY2FsbGJhY2ssIG9wdF9zdG9wQXQpIHtcbiAgZm9yIChsZXQgZWwgPSBlbGVtZW50OyBlbCAmJiBlbCAhPT0gb3B0X3N0b3BBdDsgZWwgPSBlbC5wYXJlbnRFbGVtZW50KSB7XG4gICAgaWYgKGNhbGxiYWNrKGVsKSkge1xuICAgICAgcmV0dXJuIGVsO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBjbG9zZXN0IG5vZGUgdGhhdCBzYXRpc2ZpZXMgdGhlIGNhbGxiYWNrIGZyb20gdGhpcyBub2RlXG4gKiB1cCB0aGUgRE9NIHN1YnRyZWUuXG4gKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFOb2RlKTpib29sZWFufSBjYWxsYmFja1xuICogQHJldHVybiB7P05vZGV9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbG9zZXN0Tm9kZShub2RlLCBjYWxsYmFjaykge1xuICBmb3IgKGxldCBuID0gbm9kZTsgbjsgbiA9IG4ucGFyZW50Tm9kZSkge1xuICAgIGlmIChjYWxsYmFjayhuKSkge1xuICAgICAgcmV0dXJuIG47XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGNsb3Nlc3QgZWxlbWVudCB3aXRoIHRoZSBzcGVjaWZpZWQgbmFtZSBmcm9tIHRoaXMgZWxlbWVudFxuICogdXAgdGhlIERPTSBzdWJ0cmVlLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWVcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VzdEJ5VGFnKGVsZW1lbnQsIHRhZ05hbWUpIHtcbiAgaWYgKGVsZW1lbnQuY2xvc2VzdCkge1xuICAgIHJldHVybiBlbGVtZW50LmNsb3Nlc3QodGFnTmFtZSk7XG4gIH1cbiAgdGFnTmFtZSA9IHRhZ05hbWUudG9VcHBlckNhc2UoKTtcbiAgcmV0dXJuIGNsb3Nlc3QoZWxlbWVudCwgZWwgPT4ge1xuICAgIHJldHVybiBlbC50YWdOYW1lID09IHRhZ05hbWU7XG4gIH0pO1xufVxuXG4vKipcbiAqIEZpbmRzIHRoZSBjbG9zZXN0IGVsZW1lbnQgd2l0aCB0aGUgc3BlY2lmaWVkIHNlbGVjdG9yIGZyb20gdGhpcyBlbGVtZW50XG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcbiAqIEByZXR1cm4gez9FbGVtZW50fSBjbG9zZXN0IGFuY2VzdG9yIGlmIGZvdW5kLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VzdEJ5U2VsZWN0b3IoZWxlbWVudCwgc2VsZWN0b3IpIHtcbiAgaWYgKGVsZW1lbnQuY2xvc2VzdCkge1xuICAgIHJldHVybiBlbGVtZW50LmNsb3Nlc3Qoc2VsZWN0b3IpO1xuICB9XG5cbiAgcmV0dXJuIGNsb3Nlc3QoZWxlbWVudCwgZWwgPT4ge1xuICAgIHJldHVybiBtYXRjaGVzKGVsLCBzZWxlY3Rvcik7XG4gIH0pO1xufVxuXG4vKipcbiAqIENoZWNrcyBpZiB0aGUgZ2l2ZW4gZWxlbWVudCBtYXRjaGVzIHRoZSBzZWxlY3RvclxuICogQHBhcmFtICB7IUVsZW1lbnR9IGVsIFRoZSBlbGVtZW50IHRvIHZlcmlmeVxuICogQHBhcmFtICB7c3RyaW5nfSBzZWxlY3RvciBUaGUgc2VsZWN0b3IgdG8gY2hlY2sgYWdhaW5zdFxuICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgZWxlbWVudCBtYXRjaGVkIHRoZSBzZWxlY3Rvci4gRmFsc2Ugb3RoZXJ3aXNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbWF0Y2hlcyhlbCwgc2VsZWN0b3IpIHtcbiAgY29uc3QgbWF0Y2hlciA9IGVsLm1hdGNoZXMgfHxcbiAgICAgIGVsLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fFxuICAgICAgZWwubW96TWF0Y2hlc1NlbGVjdG9yIHx8XG4gICAgICBlbC5tc01hdGNoZXNTZWxlY3RvciB8fFxuICAgICAgZWwub01hdGNoZXNTZWxlY3RvcjtcbiAgaWYgKG1hdGNoZXIpIHtcbiAgICByZXR1cm4gbWF0Y2hlci5jYWxsKGVsLCBzZWxlY3Rvcik7XG4gIH1cbiAgcmV0dXJuIGZhbHNlOyAvLyBJRTggYWx3YXlzIHJldHVybnMgZmFsc2UuXG59XG5cbi8qKlxuICogRmluZHMgdGhlIGZpcnN0IGRlc2NlbmRhbnQgZWxlbWVudCB3aXRoIHRoZSBzcGVjaWZpZWQgbmFtZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IURvY3VtZW50fCFTaGFkb3dSb290fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlbGVtZW50QnlUYWcoZWxlbWVudCwgdGFnTmFtZSkge1xuICBsZXQgZWxlbWVudHM7XG4gIC8vIGdldEVsZW1lbnRzQnlUYWdOYW1lKCkgaXMgbm90IHN1cHBvcnRlZCBvbiBTaGFkb3dSb290LlxuICBpZiAodHlwZW9mIGVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICBlbGVtZW50cyA9IGVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnTmFtZSk7XG4gIH0gZWxzZSB7XG4gICAgZWxlbWVudHMgPSBlbGVtZW50Li8qT0sqL3F1ZXJ5U2VsZWN0b3JBbGwodGFnTmFtZSk7XG4gIH1cbiAgcmV0dXJuIChlbGVtZW50cyAmJiBlbGVtZW50c1swXSkgfHwgbnVsbDtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBmaXJzdCBjaGlsZCBlbGVtZW50IHRoYXQgc2F0aXNmaWVzIHRoZSBjYWxsYmFjay5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGRFbGVtZW50KHBhcmVudCwgY2FsbGJhY2spIHtcbiAgZm9yIChsZXQgY2hpbGQgPSBwYXJlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7IGNoaWxkO1xuICAgIGNoaWxkID0gY2hpbGQubmV4dEVsZW1lbnRTaWJsaW5nKSB7XG4gICAgaWYgKGNhbGxiYWNrKGNoaWxkKSkge1xuICAgICAgcmV0dXJuIGNoaWxkO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4vKipcbiAqIEZpbmRzIGFsbCBjaGlsZCBlbGVtZW50cyB0aGF0IHNhdGlzZnkgdGhlIGNhbGxiYWNrLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjYWxsYmFja1xuICogQHJldHVybiB7IUFycmF5PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudHMocGFyZW50LCBjYWxsYmFjaykge1xuICBjb25zdCBjaGlsZHJlbiA9IFtdO1xuICBmb3IgKGxldCBjaGlsZCA9IHBhcmVudC5maXJzdEVsZW1lbnRDaGlsZDsgY2hpbGQ7XG4gICAgY2hpbGQgPSBjaGlsZC5uZXh0RWxlbWVudFNpYmxpbmcpIHtcbiAgICBpZiAoY2FsbGJhY2soY2hpbGQpKSB7XG4gICAgICBjaGlsZHJlbi5wdXNoKGNoaWxkKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGNoaWxkcmVuO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGxhc3QgY2hpbGQgZWxlbWVudCB0aGF0IHNhdGlzZmllcyB0aGUgY2FsbGJhY2suXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IGNhbGxiYWNrXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxhc3RDaGlsZEVsZW1lbnQocGFyZW50LCBjYWxsYmFjaykge1xuICBmb3IgKGxldCBjaGlsZCA9IHBhcmVudC5sYXN0RWxlbWVudENoaWxkOyBjaGlsZDtcbiAgICBjaGlsZCA9IGNoaWxkLnByZXZpb3VzRWxlbWVudFNpYmxpbmcpIHtcbiAgICBpZiAoY2FsbGJhY2soY2hpbGQpKSB7XG4gICAgICByZXR1cm4gY2hpbGQ7XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIEZpbmRzIGFsbCBjaGlsZCBub2RlcyB0aGF0IHNhdGlzZnkgdGhlIGNhbGxiYWNrLlxuICogVGhlc2Ugbm9kZXMgY2FuIGluY2x1ZGUgVGV4dCwgQ29tbWVudCBhbmQgb3RoZXIgY2hpbGQgbm9kZXMuXG4gKiBAcGFyYW0geyFOb2RlfSBwYXJlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIU5vZGUpOmJvb2xlYW59IGNhbGxiYWNrXG4gKiBAcmV0dXJuIHshQXJyYXk8IU5vZGU+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGROb2RlcyhwYXJlbnQsIGNhbGxiYWNrKSB7XG4gIGNvbnN0IG5vZGVzID0gW107XG4gIGZvciAobGV0IGNoaWxkID0gcGFyZW50LmZpcnN0Q2hpbGQ7IGNoaWxkO1xuICAgIGNoaWxkID0gY2hpbGQubmV4dFNpYmxpbmcpIHtcbiAgICBpZiAoY2FsbGJhY2soY2hpbGQpKSB7XG4gICAgICBub2Rlcy5wdXNoKGNoaWxkKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG5vZGVzO1xufVxuXG4vKipcbiAqIEB0eXBlIHtib29sZWFufHVuZGVmaW5lZH1cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5sZXQgc2NvcGVTZWxlY3RvclN1cHBvcnRlZDtcblxuLyoqXG4gKiBAcGFyYW0ge2Jvb2xlYW58dW5kZWZpbmVkfSB2YWxcbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0U2NvcGVTZWxlY3RvclN1cHBvcnRlZEZvclRlc3RpbmcodmFsKSB7XG4gIHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQgPSB2YWw7XG59XG5cbi8qKlxuICogVGVzdCB0aGF0IHRoZSA6c2NvcGUgc2VsZWN0b3IgaXMgc3VwcG9ydGVkIGFuZCBiZWhhdmVzIGNvcnJlY3RseS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNTY29wZVNlbGVjdG9yU3VwcG9ydGVkKHBhcmVudCkge1xuICBjb25zdCBkb2MgPSBwYXJlbnQub3duZXJEb2N1bWVudDtcbiAgdHJ5IHtcbiAgICBjb25zdCB0ZXN0RWxlbWVudCA9IGRvYy5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25zdCB0ZXN0Q2hpbGQgPSBkb2MuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGVzdEVsZW1lbnQuYXBwZW5kQ2hpbGQodGVzdENoaWxkKTtcbiAgICAvLyBOT1RFKGN2aWFsaXosICMxMjM4Myk6IEZpcmVmb3gncyBpbXBsZW1lbnRhdGlvbiBpcyBpbmNvbXBsZXRlLFxuICAgIC8vIHRoZXJlZm9yZSB3ZSB0ZXN0IGFjdHVhbCBmdW5jdGlvbmFsaXR5IG9mYDpzY29wZWAgYXMgd2VsbC5cbiAgICByZXR1cm4gdGVzdEVsZW1lbnQuLypPSyovcXVlcnlTZWxlY3RvcignOnNjb3BlIGRpdicpID09PSB0ZXN0Q2hpbGQ7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuLyoqXG4gKiBGaW5kcyB0aGUgZmlyc3QgY2hpbGQgZWxlbWVudCB0aGF0IGhhcyB0aGUgc3BlY2lmaWVkIGF0dHJpYnV0ZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtzdHJpbmd9IGF0dHJcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGRFbGVtZW50QnlBdHRyKHBhcmVudCwgYXR0cikge1xuICByZXR1cm4gc2NvcGVkUXVlcnlTZWxlY3Rvci8qT0sqLyhwYXJlbnQsIGA+IFske2F0dHJ9XWApO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGxhc3QgY2hpbGQgZWxlbWVudCB0aGF0IGhhcyB0aGUgc3BlY2lmaWVkIGF0dHJpYnV0ZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtzdHJpbmd9IGF0dHJcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGFzdENoaWxkRWxlbWVudEJ5QXR0cihwYXJlbnQsIGF0dHIpIHtcbiAgcmV0dXJuIGxhc3RDaGlsZEVsZW1lbnQocGFyZW50LCBlbCA9PiB7XG4gICAgcmV0dXJuIGVsLmhhc0F0dHJpYnV0ZShhdHRyKTtcbiAgfSk7XG59XG5cblxuLyoqXG4gKiBGaW5kcyBhbGwgY2hpbGQgZWxlbWVudHMgdGhhdCBoYXMgdGhlIHNwZWNpZmllZCBhdHRyaWJ1dGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyXG4gKiBAcmV0dXJuIHshTm9kZUxpc3Q8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGRFbGVtZW50c0J5QXR0cihwYXJlbnQsIGF0dHIpIHtcbiAgcmV0dXJuIHNjb3BlZFF1ZXJ5U2VsZWN0b3JBbGwvKk9LKi8ocGFyZW50LCBgPiBbJHthdHRyfV1gKTtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBmaXJzdCBjaGlsZCBlbGVtZW50IHRoYXQgaGFzIHRoZSBzcGVjaWZpZWQgdGFnIG5hbWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudEJ5VGFnKHBhcmVudCwgdGFnTmFtZSkge1xuICByZXR1cm4gc2NvcGVkUXVlcnlTZWxlY3Rvci8qT0sqLyhwYXJlbnQsIGA+ICR7dGFnTmFtZX1gKTtcbn1cblxuXG4vKipcbiAqIEZpbmRzIGFsbCBjaGlsZCBlbGVtZW50cyB3aXRoIHRoZSBzcGVjaWZpZWQgdGFnIG5hbWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lXG4gKiBAcmV0dXJuIHshTm9kZUxpc3Q8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGRFbGVtZW50c0J5VGFnKHBhcmVudCwgdGFnTmFtZSkge1xuICByZXR1cm4gc2NvcGVkUXVlcnlTZWxlY3RvckFsbC8qT0sqLyhwYXJlbnQsIGA+ICR7dGFnTmFtZX1gKTtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBmaXJzdCBlbGVtZW50IHRoYXQgbWF0Y2hlcyBgc2VsZWN0b3JgLCBzY29wZWQgaW5zaWRlIGByb290YC5cbiAqIE5vdGU6IGluIElFLCB0aGlzIGNhdXNlcyBhIHF1aWNrIG11dGF0aW9uIG9mIHRoZSBlbGVtZW50J3MgY2xhc3MgbGlzdC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHJvb3RcbiAqIEBwYXJhbSB7c3RyaW5nfSBzZWxlY3RvclxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzY29wZWRRdWVyeVNlbGVjdG9yKHJvb3QsIHNlbGVjdG9yKSB7XG4gIGlmIChzY29wZVNlbGVjdG9yU3VwcG9ydGVkID09IG51bGwpIHtcbiAgICBzY29wZVNlbGVjdG9yU3VwcG9ydGVkID0gaXNTY29wZVNlbGVjdG9yU3VwcG9ydGVkKHJvb3QpO1xuICB9XG4gIGlmIChzY29wZVNlbGVjdG9yU3VwcG9ydGVkKSB7XG4gICAgcmV0dXJuIHJvb3QuLypPSyovcXVlcnlTZWxlY3RvcihgOnNjb3BlICR7c2VsZWN0b3J9YCk7XG4gIH1cblxuICAvLyBPbmx5IElFLlxuICBjb25zdCB1bmlxdWUgPSAnaS1hbXBodG1sLXNjb3BlZCc7XG4gIHJvb3QuY2xhc3NMaXN0LmFkZCh1bmlxdWUpO1xuICBjb25zdCBlbGVtZW50ID0gcm9vdC4vKk9LKi9xdWVyeVNlbGVjdG9yKGAuJHt1bmlxdWV9ICR7c2VsZWN0b3J9YCk7XG4gIHJvb3QuY2xhc3NMaXN0LnJlbW92ZSh1bmlxdWUpO1xuICByZXR1cm4gZWxlbWVudDtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBldmVyeSBlbGVtZW50IHRoYXQgbWF0Y2hlcyBgc2VsZWN0b3JgLCBzY29wZWQgaW5zaWRlIGByb290YC5cbiAqIE5vdGU6IGluIElFLCB0aGlzIGNhdXNlcyBhIHF1aWNrIG11dGF0aW9uIG9mIHRoZSBlbGVtZW50J3MgY2xhc3MgbGlzdC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHJvb3RcbiAqIEBwYXJhbSB7c3RyaW5nfSBzZWxlY3RvclxuICogQHJldHVybiB7IU5vZGVMaXN0PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNjb3BlZFF1ZXJ5U2VsZWN0b3JBbGwocm9vdCwgc2VsZWN0b3IpIHtcbiAgaWYgKHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQgPT0gbnVsbCkge1xuICAgIHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQgPSBpc1Njb3BlU2VsZWN0b3JTdXBwb3J0ZWQocm9vdCk7XG4gIH1cbiAgaWYgKHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQpIHtcbiAgICByZXR1cm4gcm9vdC4vKk9LKi9xdWVyeVNlbGVjdG9yQWxsKGA6c2NvcGUgJHtzZWxlY3Rvcn1gKTtcbiAgfVxuXG4gIC8vIE9ubHkgSUUuXG4gIGNvbnN0IHVuaXF1ZSA9ICdpLWFtcGh0bWwtc2NvcGVkJztcbiAgcm9vdC5jbGFzc0xpc3QuYWRkKHVuaXF1ZSk7XG4gIGNvbnN0IGVsZW1lbnRzID0gcm9vdC4vKk9LKi9xdWVyeVNlbGVjdG9yQWxsKGAuJHt1bmlxdWV9ICR7c2VsZWN0b3J9YCk7XG4gIHJvb3QuY2xhc3NMaXN0LnJlbW92ZSh1bmlxdWUpO1xuICByZXR1cm4gZWxlbWVudHM7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGVsZW1lbnQgZGF0YS1wYXJhbS0gYXR0cmlidXRlcyBhcyB1cmwgcGFyYW1ldGVycyBrZXktdmFsdWUgcGFpcnMuXG4gKiBlLmcuIGRhdGEtcGFyYW0tc29tZS1hdHRyPXZhbHVlIC0+IHtzb21lQXR0cjogdmFsdWV9LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtmdW5jdGlvbihzdHJpbmcpOnN0cmluZz19IG9wdF9jb21wdXRlUGFyYW1OYW1lRnVuYyB0byBjb21wdXRlIHRoZVxuICogICAgcGFyYW1ldGVyIG5hbWUsIGdldCBwYXNzZWQgdGhlIGNhbWVsLWNhc2UgcGFyYW1ldGVyIG5hbWUuXG4gKiBAcGFyYW0geyFSZWdFeHA9fSBvcHRfcGFyYW1QYXR0ZXJuIFJlZ2V4IHBhdHRlcm4gdG8gbWF0Y2ggZGF0YSBhdHRyaWJ1dGVzLlxuICogQHJldHVybiB7IUpzb25PYmplY3R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXREYXRhUGFyYW1zRnJvbUF0dHJpYnV0ZXMoZWxlbWVudCwgb3B0X2NvbXB1dGVQYXJhbU5hbWVGdW5jLFxuICBvcHRfcGFyYW1QYXR0ZXJuKSB7XG4gIGNvbnN0IGNvbXB1dGVQYXJhbU5hbWVGdW5jID0gb3B0X2NvbXB1dGVQYXJhbU5hbWVGdW5jIHx8IChrZXkgPT4ga2V5KTtcbiAgY29uc3Qge2RhdGFzZXR9ID0gZWxlbWVudDtcbiAgY29uc3QgcGFyYW1zID0gZGljdCgpO1xuICBjb25zdCBwYXJhbVBhdHRlcm4gPSBvcHRfcGFyYW1QYXR0ZXJuID8gb3B0X3BhcmFtUGF0dGVybiA6IC9ecGFyYW0oLispLztcbiAgZm9yIChjb25zdCBrZXkgaW4gZGF0YXNldCkge1xuICAgIGNvbnN0IG1hdGNoZXMgPSBrZXkubWF0Y2gocGFyYW1QYXR0ZXJuKTtcbiAgICBpZiAobWF0Y2hlcykge1xuICAgICAgY29uc3QgcGFyYW0gPSBtYXRjaGVzWzFdWzBdLnRvTG93ZXJDYXNlKCkgKyBtYXRjaGVzWzFdLnN1YnN0cigxKTtcbiAgICAgIHBhcmFtc1tjb21wdXRlUGFyYW1OYW1lRnVuYyhwYXJhbSldID0gZGF0YXNldFtrZXldO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcGFyYW1zO1xufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGVsZW1lbnQgaGF2ZSBhIG5leHQgbm9kZSBpbiB0aGUgZG9jdW1lbnQgb3JkZXIuXG4gKiBUaGlzIG1lYW5zIGVpdGhlcjpcbiAqICBhLiBUaGUgZWxlbWVudCBpdHNlbGYgaGFzIGEgbmV4dFNpYmxpbmcuXG4gKiAgYi4gQW55IG9mIHRoZSBlbGVtZW50IGFuY2VzdG9ycyBoYXMgYSBuZXh0U2libGluZy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7P05vZGV9IG9wdF9zdG9wTm9kZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc05leHROb2RlSW5Eb2N1bWVudE9yZGVyKGVsZW1lbnQsIG9wdF9zdG9wTm9kZSkge1xuICBsZXQgY3VycmVudEVsZW1lbnQgPSBlbGVtZW50O1xuICBkbyB7XG4gICAgaWYgKGN1cnJlbnRFbGVtZW50Lm5leHRTaWJsaW5nKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH0gd2hpbGUgKChjdXJyZW50RWxlbWVudCA9IGN1cnJlbnRFbGVtZW50LnBhcmVudE5vZGUpICYmXG4gICAgICAgICAgICBjdXJyZW50RWxlbWVudCAhPSBvcHRfc3RvcE5vZGUpO1xuICByZXR1cm4gZmFsc2U7XG59XG5cblxuLyoqXG4gKiBGaW5kcyBhbGwgYW5jZXN0b3IgZWxlbWVudHMgdGhhdCBzYXRpc2Z5IHByZWRpY2F0ZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGNoaWxkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBwcmVkaWNhdGVcbiAqIEByZXR1cm4geyFBcnJheTwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhbmNlc3RvckVsZW1lbnRzKGNoaWxkLCBwcmVkaWNhdGUpIHtcbiAgY29uc3QgYW5jZXN0b3JzID0gW107XG4gIGZvciAobGV0IGFuY2VzdG9yID0gY2hpbGQucGFyZW50RWxlbWVudDsgYW5jZXN0b3I7XG4gICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnRFbGVtZW50KSB7XG4gICAgaWYgKHByZWRpY2F0ZShhbmNlc3RvcikpIHtcbiAgICAgIGFuY2VzdG9ycy5wdXNoKGFuY2VzdG9yKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGFuY2VzdG9ycztcbn1cblxuXG4vKipcbiAqIEZpbmRzIGFsbCBhbmNlc3RvciBlbGVtZW50cyB0aGF0IGhhcyB0aGUgc3BlY2lmaWVkIHRhZyBuYW1lLlxuICogQHBhcmFtIHshRWxlbWVudH0gY2hpbGRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lXG4gKiBAcmV0dXJuIHshQXJyYXk8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gYW5jZXN0b3JFbGVtZW50c0J5VGFnKGNoaWxkLCB0YWdOYW1lKSB7XG4gIHRhZ05hbWUgPSB0YWdOYW1lLnRvVXBwZXJDYXNlKCk7XG4gIHJldHVybiBhbmNlc3RvckVsZW1lbnRzKGNoaWxkLCBlbCA9PiB7XG4gICAgcmV0dXJuIGVsLnRhZ05hbWUgPT0gdGFnTmFtZTtcbiAgfSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGNsb25lIG9mIHRoZSBjb250ZW50IG9mIGEgdGVtcGxhdGUgZWxlbWVudC5cbiAqXG4gKiBQb2x5ZmlsbCB0byByZXBsYWNlIC5jb250ZW50IGFjY2VzcyBmb3IgYnJvd3NlcnMgdGhhdCBkbyBub3Qgc3VwcG9ydFxuICogSFRNTFRlbXBsYXRlRWxlbWVudHMgbmF0aXZlbHkuXG4gKlxuICogQHBhcmFtIHshSFRNTFRlbXBsYXRlRWxlbWVudHwhRWxlbWVudH0gdGVtcGxhdGVcbiAqIEByZXR1cm4geyFEb2N1bWVudEZyYWdtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gdGVtcGxhdGVDb250ZW50Q2xvbmUodGVtcGxhdGUpIHtcbiAgaWYgKCdjb250ZW50JyBpbiB0ZW1wbGF0ZSkge1xuICAgIHJldHVybiB0ZW1wbGF0ZS5jb250ZW50LmNsb25lTm9kZSh0cnVlKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBjb250ZW50ID0gdGVtcGxhdGUub3duZXJEb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgY29weUNoaWxkcmVuKHRlbXBsYXRlLCBjb250ZW50KTtcbiAgICByZXR1cm4gY29udGVudDtcbiAgfVxufVxuXG4vKipcbiAqIEl0ZXJhdGUgb3ZlciBhbiBhcnJheS1saWtlLiBTb21lIGNvbGxlY3Rpb25zIGxpa2UgTm9kZUxpc3QgYXJlXG4gKiBsYXppbHkgZXZhbHVhdGVkIGluIHNvbWUgYnJvd3NlcnMsIGFuZCBhY2Nlc3NpbmcgYGxlbmd0aGAgZm9yY2VzIGZ1bGxcbiAqIGV2YWx1YXRpb24uIFdlIGNhbiBpbXByb3ZlIHBlcmZvcm1hbmNlIGJ5IGl0ZXJhdGluZyB1bnRpbCBhbiBlbGVtZW50IGlzXG4gKiBgdW5kZWZpbmVkYCB0byBhdm9pZCBjaGVja2luZyB0aGUgYGxlbmd0aGAgcHJvcGVydHkuXG4gKiBUZXN0IGNhc2VzOiBodHRwczovL2pzcGVyZi5jb20vaXRlcmF0aW5nLW92ZXItY29sbGVjdGlvbnMtb2YtZWxlbWVudHNcbiAqIEBwYXJhbSB7IUlBcnJheUxpa2U8VD59IGl0ZXJhYmxlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKFQsIG51bWJlcil9IGNiXG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXRlcmF0ZUN1cnNvcihpdGVyYWJsZSwgY2IpIHtcbiAgZm9yIChsZXQgaSA9IDAsIHZhbHVlOyAodmFsdWUgPSBpdGVyYWJsZVtpXSkgIT09IHVuZGVmaW5lZDsgaSsrKSB7XG4gICAgY2IodmFsdWUsIGkpO1xuICB9XG59XG5cbi8qKlxuICogVGhpcyBtZXRob2Qgd3JhcHMgYXJvdW5kIHdpbmRvdydzIG9wZW4gbWV0aG9kLiBJdCBmaXJzdCB0cmllcyB0byBleGVjdXRlXG4gKiBgb3BlbmAgY2FsbCB3aXRoIHRoZSBwcm92aWRlZCB0YXJnZXQgYW5kIGlmIGl0IGZhaWxzLCBpdCByZXRyaWVzIHRoZSBjYWxsXG4gKiB3aXRoIHRoZSBgX3RvcGAgdGFyZ2V0LiBUaGlzIGlzIG5lY2Vzc2FyeSBnaXZlbiB0aGF0IGluIHNvbWUgZW1iZWRkaW5nXG4gKiBzY2VuYXJpb3MsIHN1Y2ggYXMgaU9TJyBXS1dlYlZpZXcsIG5hdmlnYXRpb24gdG8gYF9ibGFua2AgYW5kIG90aGVyIHRhcmdldHNcbiAqIGlzIGJsb2NrZWQgYnkgZGVmYXVsdC5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHBhcmFtIHtzdHJpbmd9IHRhcmdldFxuICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfZmVhdHVyZXNcbiAqIEByZXR1cm4gez9XaW5kb3d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvcGVuV2luZG93RGlhbG9nKHdpbiwgdXJsLCB0YXJnZXQsIG9wdF9mZWF0dXJlcykge1xuICAvLyBUcnkgZmlyc3Qgd2l0aCB0aGUgc3BlY2lmaWVkIHRhcmdldC4gSWYgd2UncmUgaW5zaWRlIHRoZSBXS1dlYlZpZXcgb3JcbiAgLy8gYSBzaW1pbGFyIGVudmlyb25tZW50cywgdGhpcyBtZXRob2QgaXMgZXhwZWN0ZWQgdG8gZmFpbCBieSBkZWZhdWx0IGZvclxuICAvLyBhbGwgdGFyZ2V0cyBleGNlcHQgYF90b3BgLlxuICBsZXQgcmVzO1xuICB0cnkge1xuICAgIHJlcyA9IHdpbi5vcGVuKHVybCwgdGFyZ2V0LCBvcHRfZmVhdHVyZXMpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgZGV2KCkuZXJyb3IoJ0RPTScsICdGYWlsZWQgdG8gb3BlbiB1cmwgb24gdGFyZ2V0OiAnLCB0YXJnZXQsIGUpO1xuICB9XG5cbiAgLy8gVGhlbiB0cnkgd2l0aCBgX3RvcGAgdGFyZ2V0LlxuICBpZiAoIXJlcyAmJiB0YXJnZXQgIT0gJ190b3AnKSB7XG4gICAgcmVzID0gd2luLm9wZW4odXJsLCAnX3RvcCcpO1xuICB9XG4gIHJldHVybiByZXM7XG59XG5cbi8qKlxuICogV2hldGhlciB0aGUgZWxlbWVudCBpcyBhIHNjcmlwdCB0YWcgd2l0aCBhcHBsaWNhdGlvbi9qc29uIHR5cGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNKc29uU2NyaXB0VGFnKGVsZW1lbnQpIHtcbiAgcmV0dXJuIGVsZW1lbnQudGFnTmFtZSA9PSAnU0NSSVBUJyAmJlxuICAgICAgICAgICAgZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKS50b1VwcGVyQ2FzZSgpID09ICdBUFBMSUNBVElPTi9KU09OJztcbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBlbGVtZW50IGlzIGEgc2NyaXB0IHRhZyB3aXRoIGFwcGxpY2F0aW9uL2pzb24gdHlwZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0pzb25MZFNjcmlwdFRhZyhlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50LnRhZ05hbWUgPT0gJ1NDUklQVCcgJiZcbiAgICAgIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykudG9VcHBlckNhc2UoKSA9PSAnQVBQTElDQVRJT04vTEQrSlNPTic7XG59XG5cbi8qKlxuICogV2hldGhlciB0aGUgcGFnZSdzIGRpcmVjdGlvbiBpcyByaWdodCB0byBsZWZ0IG9yIG5vdC5cbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2NcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1JUTChkb2MpIHtcbiAgY29uc3QgZGlyID0gZG9jLmJvZHkuZ2V0QXR0cmlidXRlKCdkaXInKVxuICAgICAgICAgICAgICAgICB8fCBkb2MuZG9jdW1lbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGlyJylcbiAgICAgICAgICAgICAgICAgfHwgJ2x0cic7XG4gIHJldHVybiBkaXIgPT0gJ3J0bCc7XG59XG5cblxuLyoqXG4gKiBFc2NhcGVzIGFuIGlkZW50IChJRCBvciBhIGNsYXNzIG5hbWUpIHRvIGJlIHVzZWQgYXMgYSBDU1Mgc2VsZWN0b3IuXG4gKlxuICogU2VlIGh0dHBzOi8vZHJhZnRzLmNzc3dnLm9yZy9jc3NvbS8jc2VyaWFsaXplLWFuLWlkZW50aWZpZXIuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGlkZW50XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVDc3NTZWxlY3RvcklkZW50KGlkZW50KSB7XG4gIHJldHVybiBjc3NFc2NhcGUoaWRlbnQpO1xufVxuXG4vKipcbiAqIEVzY2FwZXMgYW4gaWRlbnQgaW4gYSB3YXkgdGhhdCBjYW4gYmUgdXNlZCBieSA6bnRoLWNoaWxkKCkgcHN1ZWRvLWNsYXNzLlxuICpcbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdzNjL2Nzc3dnLWRyYWZ0cy9pc3N1ZXMvMjMwNi5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IGlkZW50XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVDc3NTZWxlY3Rvck50aChpZGVudCkge1xuICBjb25zdCBlc2NhcGVkID0gU3RyaW5nKGlkZW50KTtcbiAgLy8gRW5zdXJlIGl0IGRvZXNuJ3QgY2xvc2UgdGhlIG50aC1jaGlsZCBwc3VlZG8gY2xhc3MuXG4gIGRldigpLmFzc2VydChlc2NhcGVkLmluZGV4T2YoJyknKSA9PT0gLTEpO1xuICByZXR1cm4gZXNjYXBlZDtcbn1cblxuLyoqXG4gKiBFc2NhcGVzIGA8YCwgYD5gIGFuZCBvdGhlciBIVE1MIGNoYXJjYXRlcnMgd2l0aCB0aGVpciBlc2NhcGVkIGZvcm1zLlxuICogQHBhcmFtIHtzdHJpbmd9IHRleHRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVzY2FwZUh0bWwodGV4dCkge1xuICBpZiAoIXRleHQpIHtcbiAgICByZXR1cm4gdGV4dDtcbiAgfVxuICByZXR1cm4gdGV4dC5yZXBsYWNlKEhUTUxfRVNDQVBFX1JFR0VYLCBlc2NhcGVIdG1sQ2hhcik7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IGNcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gZXNjYXBlSHRtbENoYXIoYykge1xuICByZXR1cm4gSFRNTF9FU0NBUEVfQ0hBUlNbY107XG59XG5cbi8qKlxuICogVHJpZXMgdG8gZm9jdXMgb24gdGhlIGdpdmVuIGVsZW1lbnQ7IGZhaWxzIHNpbGVudGx5IGlmIGJyb3dzZXIgdGhyb3dzIGFuXG4gKiBleGNlcHRpb24uXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnlGb2N1cyhlbGVtZW50KSB7XG4gIHRyeSB7XG4gICAgZWxlbWVudC4vKk9LKi9mb2N1cygpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gSUUgPD0gNyBtYXkgdGhyb3cgZXhjZXB0aW9ucyB3aGVuIGZvY3VzaW5nIG9uIGhpZGRlbiBpdGVtcy5cbiAgfVxufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGdpdmVuIHdpbmRvdyBpcyBpbiBhbiBpZnJhbWUgb3Igbm90LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0lmcmFtZWQod2luKSB7XG4gIHJldHVybiB3aW4ucGFyZW50ICYmIHdpbi5wYXJlbnQgIT0gd2luO1xufVxuXG4vKipcbiAqIERldGVybWluZXMgaWYgdGhpcyBlbGVtZW50IGlzIGFuIEFNUCBlbGVtZW50XG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBbXBFbGVtZW50KGVsZW1lbnQpIHtcbiAgY29uc3QgdGFnID0gZWxlbWVudC50YWdOYW1lO1xuICAvLyBVc2UgcHJlZml4IHRvIHJlY29nbml6ZSBBTVAgZWxlbWVudC4gVGhpcyBpcyBuZWNlc3NhcnkgYmVjYXVzZSBzdHViXG4gIC8vIG1heSBub3QgYmUgYXR0YWNoZWQgeWV0LlxuICByZXR1cm4gc3RhcnRzV2l0aCh0YWcsICdBTVAtJykgJiZcbiAgICAgIC8vIFNvbWUgXCJhbXAtKlwiIGVsZW1lbnRzIGFyZSBub3QgcmVhbGx5IEFNUCBlbGVtZW50cy4gOnNtaDpcbiAgICAgICEodGFnID09ICdBTVAtU1RJQ0tZLUFELVRPUC1QQURESU5HJyB8fCB0YWcgPT0gJ0FNUC1CT0RZJyk7XG59XG5cbi8qKlxuICogUmV0dXJuIGEgcHJvbWlzZSB0aGF0IHJlc29sdmUgd2hlbiBhbiBBTVAgZWxlbWVudCB1cGdyYWRlIGZyb20gSFRNTEVsZW1lbnRcbiAqIHRvIEN1c3RvbUVsZW1lbnRcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4geyFQcm9taXNlPCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdoZW5VcGdyYWRlZFRvQ3VzdG9tRWxlbWVudChlbGVtZW50KSB7XG4gIGRldigpLmFzc2VydChpc0FtcEVsZW1lbnQoZWxlbWVudCksICdlbGVtZW50IGlzIG5vdCBBbXBFbGVtZW50Jyk7XG4gIGlmIChlbGVtZW50LmNyZWF0ZWRDYWxsYmFjaykge1xuICAgIC8vIEVsZW1lbnQgYWxyZWFkeSBpcyBDdXN0b21FbGVtZW50O1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZWxlbWVudCk7XG4gIH1cbiAgLy8gSWYgRWxlbWVudCBpcyBzdGlsbCBIVE1MRWxlbWVudCwgd2FpdCBmb3IgaXQgdG8gdXBncmFkZSB0byBjdXN0b21FbGVtZW50XG4gIC8vIE5vdGU6IHVzZSBwdXJlIHN0cmluZyB0byBhdm9pZCBvYmZ1c2NhdGlvbiBiZXR3ZWVuIHZlcnNpb25zLlxuICBpZiAoIWVsZW1lbnRbVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1BST01JU0VdKSB7XG4gICAgY29uc3QgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICBlbGVtZW50W1VQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9QUk9NSVNFXSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgZWxlbWVudFtVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUkVTT0xWRVJdID0gZGVmZXJyZWQucmVzb2x2ZTtcblxuICB9XG5cbiAgcmV0dXJuIGVsZW1lbnRbVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1BST01JU0VdO1xufVxuXG4vKipcbiAqIFJlcGxhY2VtZW50IGZvciBgRWxlbWVudC5yZXF1ZXN0RnVsbHNjcmVlbigpYCBtZXRob2QuXG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvRWxlbWVudC9yZXF1ZXN0RnVsbHNjcmVlblxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gZnVsbHNjcmVlbkVudGVyKGVsZW1lbnQpIHtcbiAgY29uc3QgcmVxdWVzdEZzID0gZWxlbWVudC5yZXF1ZXN0RnVsbHNjcmVlblxuICAgfHwgZWxlbWVudC5yZXF1ZXN0RnVsbFNjcmVlblxuICAgfHwgZWxlbWVudC53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlblxuICAgfHwgZWxlbWVudC53ZWJraXRSZXF1ZXN0RnVsbFNjcmVlblxuICAgfHwgZWxlbWVudC53ZWJraXRFbnRlckZ1bGxzY3JlZW5cbiAgIHx8IGVsZW1lbnQud2Via2l0RW50ZXJGdWxsU2NyZWVuXG4gICB8fCBlbGVtZW50Lm1zUmVxdWVzdEZ1bGxzY3JlZW5cbiAgIHx8IGVsZW1lbnQubXNSZXF1ZXN0RnVsbFNjcmVlblxuICAgfHwgZWxlbWVudC5tb3pSZXF1ZXN0RnVsbHNjcmVlblxuICAgfHwgZWxlbWVudC5tb3pSZXF1ZXN0RnVsbFNjcmVlbjtcbiAgaWYgKHJlcXVlc3RGcykge1xuICAgIHJlcXVlc3RGcy5jYWxsKGVsZW1lbnQpO1xuICB9XG59XG5cbi8qKlxuICogUmVwbGFjZW1lbnQgZm9yIGBEb2N1bWVudC5leGl0RnVsbHNjcmVlbigpYCBtZXRob2QuXG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvRG9jdW1lbnQvZXhpdEZ1bGxzY3JlZW5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZ1bGxzY3JlZW5FeGl0KGVsZW1lbnQpIHtcbiAgbGV0IGV4aXRGcyA9IGVsZW1lbnQuY2FuY2VsRnVsbFNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQuZXhpdEZ1bGxzY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50LmV4aXRGdWxsU2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC53ZWJraXRFeGl0RnVsbHNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQud2Via2l0RXhpdEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50LndlYmtpdENhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50Lm1zRXhpdEZ1bGxzY3JlZW47XG4gIGlmIChleGl0RnMpIHtcbiAgICBleGl0RnMuY2FsbChlbGVtZW50KTtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGVsZW1lbnQub3duZXJEb2N1bWVudCkge1xuICAgIGV4aXRGcyA9IGVsZW1lbnQub3duZXJEb2N1bWVudC5jYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50LmV4aXRGdWxsc2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50LmV4aXRGdWxsU2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50LndlYmtpdEV4aXRGdWxsc2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50LndlYmtpdEV4aXRGdWxsU2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50LndlYmtpdENhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQubW96Q2FuY2VsRnVsbFNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC5tc0V4aXRGdWxsc2NyZWVuO1xuICB9XG4gIGlmIChleGl0RnMpIHtcbiAgICBleGl0RnMuY2FsbChlbGVtZW50Lm93bmVyRG9jdW1lbnQpO1xuICAgIHJldHVybjtcbiAgfVxufVxuXG5cbi8qKlxuICogUmVwbGFjZW1lbnQgZm9yIGBEb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudGAuXG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvRG9jdW1lbnQvZnVsbHNjcmVlbkVsZW1lbnRcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Z1bGxzY3JlZW5FbGVtZW50KGVsZW1lbnQpIHtcbiAgY29uc3QgaXNGdWxsc2NyZWVuID0gZWxlbWVudC53ZWJraXREaXNwbGF5aW5nRnVsbHNjcmVlbjtcbiAgaWYgKGlzRnVsbHNjcmVlbikge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGlmIChlbGVtZW50Lm93bmVyRG9jdW1lbnQpIHtcbiAgICBjb25zdCBmdWxsc2NyZWVuRWxlbWVudCA9IGVsZW1lbnQub3duZXJEb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudFxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC53ZWJraXRGdWxsc2NyZWVuRWxlbWVudFxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC5tb3pGdWxsU2NyZWVuRWxlbWVudFxuICAgICAgICAgICAgIHx8IGVsZW1lbnQud2Via2l0Q3VycmVudEZ1bGxTY3JlZW5FbGVtZW50O1xuICAgIGlmIChmdWxsc2NyZWVuRWxlbWVudCA9PSBlbGVtZW50KSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBub2RlIGlzIG5vdCBkaXNhYmxlZC5cbiAqXG4gKiBJRTggY2FuIHJldHVybiBmYWxzZSBwb3NpdGl2ZXMsIHNlZSB7QGxpbmsgbWF0Y2hlc30uXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHNlZSBodHRwczovL3d3dy53My5vcmcvVFIvaHRtbDUvZm9ybXMuaHRtbCNjb25jZXB0LWZlLWRpc2FibGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0VuYWJsZWQoZWxlbWVudCkge1xuICByZXR1cm4gIShlbGVtZW50LmRpc2FibGVkIHx8IG1hdGNoZXMoZWxlbWVudCwgJzpkaXNhYmxlZCcpKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgKiBhcyBkb20gZnJvbSAnLi9kb20nO1xuaW1wb3J0IHtcbiAgZ2V0QW1wZG9jLFxuICBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUsXG4gIGdldFNlcnZpY2UsXG4gIGdldFNlcnZpY2VQcm9taXNlLFxuICBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyxcbiAgZ2V0U2VydmljZVByb21pc2VPck51bGwsXG4gIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsRm9yRG9jLFxuICBnZXRUb3BXaW5kb3csXG59IGZyb20gJy4vc2VydmljZSc7XG5pbXBvcnQge3RvV2lufSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7dXNlcn0gZnJvbSAnLi9sb2cnO1xuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIGZvciBhIHNlcnZpY2UgZm9yIHRoZSBnaXZlbiBpZCBhbmQgd2luZG93LiBBbHNvIGV4cGVjdHMgYW5cbiAqIGVsZW1lbnQgdGhhdCBoYXMgdGhlIGFjdHVhbCBpbXBsZW1lbnRhdGlvbi4gVGhlIHByb21pc2UgcmVzb2x2ZXMgd2hlbiB0aGVcbiAqIGltcGxlbWVudGF0aW9uIGxvYWRlZC4gVXNlcnMgc2hvdWxkIHR5cGljYWxseSB3cmFwIHRoaXMgYXMgYSBzcGVjaWFsIHB1cnBvc2VcbiAqIGZ1bmN0aW9uIChlLmcuIFNlcnZpY2VzLnZpZXdwb3J0Rm9yRG9jKC4uLikpIGZvciB0eXBlIHNhZmV0eSBhbmQgYmVjYXVzZSB0aGVcbiAqIGZhY3Rvcnkgc2hvdWxkIG5vdCBiZSBwYXNzZWQgYXJvdW5kLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb24gTmFtZSBvZiB0aGUgY3VzdG9tIGV4dGVuc2lvbiB0aGF0IHByb3ZpZGVzIHRoZVxuICogICAgIGltcGxlbWVudGF0aW9uIG9mIHRoaXMgc2VydmljZS5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9lbGVtZW50IFdoZXRoZXIgdGhpcyBzZXJ2aWNlIGlzIHByb3ZpZGVkIGJ5IGFuIGVsZW1lbnQsXG4gKiAgICAgbm90IHRoZSBleHRlbnNpb24uXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwqPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRTZXJ2aWNlKHdpbiwgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpIHtcbiAgcmV0dXJuIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCBpZCwgZXh0ZW5zaW9uLCBvcHRfZWxlbWVudCkudGhlbihcbiAgICAgIHNlcnZpY2UgPT4gYXNzZXJ0U2VydmljZShzZXJ2aWNlLCBpZCwgZXh0ZW5zaW9uKSk7XG59XG5cbi8qKlxuICogU2FtZSBhcyBnZXRFbGVtZW50U2VydmljZSBidXQgcHJvZHVjZXMgbnVsbCBpZiB0aGUgZ2l2ZW4gZWxlbWVudCBpcyBub3RcbiAqIGFjdHVhbGx5IGF2YWlsYWJsZSBvbiB0aGUgY3VycmVudCBwYWdlLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb24gTmFtZSBvZiB0aGUgY3VzdG9tIGV4dGVuc2lvbiB0aGF0IHByb3ZpZGVzIHRoZVxuICogICAgIGltcGxlbWVudGF0aW9uIG9mIHRoaXMgc2VydmljZS5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9lbGVtZW50IFdoZXRoZXIgdGhpcyBzZXJ2aWNlIGlzIHByb3ZpZGVkIGJ5IGFuXG4gKiAgICAgZWxlbWVudCwgbm90IHRoZSBleHRlbnNpb24uXG4gKiBAcmV0dXJuIHshUHJvbWlzZTw/T2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCBpZCwgZXh0ZW5zaW9uLCBvcHRfZWxlbWVudCkge1xuICBjb25zdCBzID0gZ2V0U2VydmljZVByb21pc2VPck51bGwod2luLCBpZCk7XG4gIGlmIChzKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8P09iamVjdD59ICovIChzKTtcbiAgfVxuICByZXR1cm4gZ2V0RWxlbWVudFNlcnZpY2VQcm9taXNlT3JOdWxsKHdpbiwgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gZWxlbWVudE5hbWUgTmFtZSBvZiBhbiBleHRlbmRlZCBjdXN0b20gZWxlbWVudC5cbiAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhpcyBlbGVtZW50IGlzIHNjaGVkdWxlZCB0byBiZSBsb2FkZWQuXG4gKi9cbmZ1bmN0aW9uIGlzRWxlbWVudFNjaGVkdWxlZCh3aW4sIGVsZW1lbnROYW1lKSB7XG4gIC8vIFNldCBpbiBjdXN0b20tZWxlbWVudC5qc1xuICBpZiAoIXdpbi5hbXBFeHRlbmRlZEVsZW1lbnRzKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiAhIXdpbi5hbXBFeHRlbmRlZEVsZW1lbnRzW2VsZW1lbnROYW1lXTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIGZvciBhIHNlcnZpY2UgZm9yIHRoZSBnaXZlbiBpZCBhbmQgd2luZG93LiBBbHNvIGV4cGVjdHMgYW5cbiAqIGVsZW1lbnQgdGhhdCBoYXMgdGhlIGFjdHVhbCBpbXBsZW1lbnRhdGlvbi4gVGhlIHByb21pc2UgcmVzb2x2ZXMgd2hlbiB0aGVcbiAqIGltcGxlbWVudGF0aW9uIGxvYWRlZC4gVXNlcnMgc2hvdWxkIHR5cGljYWxseSB3cmFwIHRoaXMgYXMgYSBzcGVjaWFsIHB1cnBvc2VcbiAqIGZ1bmN0aW9uIChlLmcuIFNlcnZpY2VzLnZpZXdwb3J0Rm9yRG9jKC4uLikpIGZvciB0eXBlIHNhZmV0eSBhbmQgYmVjYXVzZSB0aGVcbiAqIGZhY3Rvcnkgc2hvdWxkIG5vdCBiZSBwYXNzZWQgYXJvdW5kLlxuICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uIE5hbWUgb2YgdGhlIGN1c3RvbSBleHRlbnNpb24gdGhhdCBwcm92aWRlcyB0aGVcbiAqICAgICBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZWxlbWVudCBXaGV0aGVyIHRoaXMgc2VydmljZSBpcyBwcm92aWRlZCBieSBhbiBlbGVtZW50LFxuICogICAgIG5vdCB0aGUgZXh0ZW5zaW9uLlxuICogQHJldHVybiB7IVByb21pc2U8Kj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGlkLCBleHRlbnNpb24sXG4gIG9wdF9lbGVtZW50KSB7XG4gIHJldHVybiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jKFxuICAgICAgZWxlbWVudE9yQW1wRG9jLCBpZCwgZXh0ZW5zaW9uLCBvcHRfZWxlbWVudClcbiAgICAgIC50aGVuKHNlcnZpY2UgPT4gYXNzZXJ0U2VydmljZShzZXJ2aWNlLCBpZCwgZXh0ZW5zaW9uKSk7XG59XG5cbi8qKlxuICogU2FtZSBhcyBnZXRFbGVtZW50U2VydmljZSBidXQgcHJvZHVjZXMgbnVsbCBpZiB0aGUgZ2l2ZW4gZWxlbWVudCBpcyBub3RcbiAqIGFjdHVhbGx5IGF2YWlsYWJsZSBvbiB0aGUgY3VycmVudCBwYWdlLlxuICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uIE5hbWUgb2YgdGhlIGN1c3RvbSBleHRlbnNpb24gdGhhdCBwcm92aWRlcyB0aGVcbiAqICAgICBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZWxlbWVudCBXaGV0aGVyIHRoaXMgc2VydmljZSBpcyBwcm92aWRlZCBieSBhblxuICogICAgIGVsZW1lbnQsIG5vdCB0aGUgZXh0ZW5zaW9uLlxuICogQHJldHVybiB7IVByb21pc2U8P09iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jKFxuICBlbGVtZW50T3JBbXBEb2MsIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KSB7XG4gIGNvbnN0IGFtcGRvYyA9IGdldEFtcGRvYyhlbGVtZW50T3JBbXBEb2MpO1xuICBjb25zdCBzID0gZ2V0U2VydmljZVByb21pc2VPck51bGxGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCk7XG4gIGlmIChzKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8P09iamVjdD59ICovIChzKTtcbiAgfVxuXG4gIHJldHVybiBhbXBkb2Mud2hlbkJvZHlBdmFpbGFibGUoKVxuICAgICAgLnRoZW4oKCkgPT4gd2FpdEZvckV4dGVuc2lvbklmUHJlc2VudChcbiAgICAgICAgICBhbXBkb2Mud2luLCBleHRlbnNpb24sXG4gICAgICAgICAgYW1wZG9jLmdldEhlYWROb2RlKCkpKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAvLyBJZiB0aGlzIHNlcnZpY2UgaXMgcHJvdmlkZWQgYnkgYW4gZWxlbWVudCwgdGhlbiB3ZSBjYW4ndCBkZXBlbmQgb25cbiAgICAgICAgLy8gdGhlIHNlcnZpY2UgKHRoZXkgbWF5IG5vdCB1c2UgdGhlIGVsZW1lbnQpLlxuICAgICAgICBpZiAob3B0X2VsZW1lbnQpIHtcbiAgICAgICAgICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VPck51bGxGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNFbGVtZW50U2NoZWR1bGVkKGFtcGRvYy53aW4sIGV4dGVuc2lvbikpIHtcbiAgICAgICAgICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3Igc2VydmljZSBmb3IgdGhlIGdpdmVuIGlkIGluIHRoZSBlbWJlZCBzY29wZSBvZlxuICogYSBnaXZlbiBub2RlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSwgZmFsbHMgYmFjayB0byBhbXBkb2Mgc2NvcGUgSUZGXG4gKiB0aGUgZ2l2ZW4gbm9kZSBpcyBpbiB0aGUgdG9wLWxldmVsIHdpbmRvdy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbiBOYW1lIG9mIHRoZSBjdXN0b20gZWxlbWVudCB0aGF0IHByb3ZpZGVzXG4gKiAgICAgdGhlIGltcGxlbWVudGF0aW9uIG9mIHRoaXMgc2VydmljZS5cbiAqIEByZXR1cm4geyFQcm9taXNlPD9PYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvY0luRW1iZWRTY29wZShcbiAgZWxlbWVudE9yQW1wRG9jLCBpZCwgZXh0ZW5zaW9uKSB7XG4gIGNvbnN0IHMgPSBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUoZWxlbWVudE9yQW1wRG9jLCBpZCk7XG4gIGlmIChzKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8P09iamVjdD59ICovIChQcm9taXNlLnJlc29sdmUocykpO1xuICB9XG4gIC8vIFJldHVybiBlbWJlZC1zY29wZSBlbGVtZW50IHNlcnZpY2UgcHJvbWlzZSBpZiBzY2hlZHVsZWQuXG4gIGlmIChlbGVtZW50T3JBbXBEb2Mubm9kZVR5cGUpIHtcbiAgICBjb25zdCB3aW4gPSB0b1dpbihlbGVtZW50T3JBbXBEb2Mub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldyk7XG4gICAgY29uc3QgdG9wV2luID0gZ2V0VG9wV2luZG93KHdpbik7XG4gICAgLy8gSW4gZW1iZWRzLCBkb2Mtc2NvcGUgc2VydmljZXMgYXJlIHdpbmRvdy1zY29wZS4gQnV0IG1ha2Ugc3VyZSB0b1xuICAgIC8vIG9ubHkgZG8gdGhpcyBmb3IgZW1iZWRzIChub3QgdGhlIHRvcCB3aW5kb3cpLCBvdGhlcndpc2Ugd2UnZCBncmFiXG4gICAgLy8gYSBwcm9taXNlIGZyb20gdGhlIHdyb25nIHNlcnZpY2UgaG9sZGVyIHdoaWNoIHdvdWxkIG5ldmVyIHJlc29sdmUuXG4gICAgaWYgKHdpbiAhPT0gdG9wV2luKSB7XG4gICAgICByZXR1cm4gZ2V0RWxlbWVudFNlcnZpY2VQcm9taXNlT3JOdWxsKHdpbiwgaWQsIGV4dGVuc2lvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEZhbGxiYWNrIHRvIGFtcGRvYyBJRkYgdGhlIGdpdmVuIG5vZGUgaXMgX25vdF8gRklFLlxuICAgICAgcmV0dXJuIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCwgZXh0ZW5zaW9uKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8P09iamVjdD59ICovIChQcm9taXNlLnJlc29sdmUobnVsbCkpO1xufVxuXG4vKipcbiAqIFRocm93cyB1c2VyIGVycm9yIGlmIGBzZXJ2aWNlYCBpcyBudWxsLlxuICogQHBhcmFtIHtPYmplY3R9IHNlcnZpY2VcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvblxuICogQHJldHVybiB7IU9iamVjdH1cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIGFzc2VydFNlcnZpY2Uoc2VydmljZSwgaWQsIGV4dGVuc2lvbikge1xuICByZXR1cm4gLyoqIEB0eXBlIHshT2JqZWN0fSAqLyAodXNlcigpLmFzc2VydChzZXJ2aWNlLFxuICAgICAgJ1NlcnZpY2UgJXMgd2FzIHJlcXVlc3RlZCB0byBiZSBwcm92aWRlZCB0aHJvdWdoICVzLCAnICtcbiAgICAgICdidXQgJXMgaXMgbm90IGxvYWRlZCBpbiB0aGUgY3VycmVudCBwYWdlLiBUbyBmaXggdGhpcyAnICtcbiAgICAgICdwcm9ibGVtIGxvYWQgdGhlIEphdmFTY3JpcHQgZmlsZSBmb3IgJXMgaW4gdGhpcyBwYWdlLicsXG4gICAgICBpZCwgZXh0ZW5zaW9uLCBleHRlbnNpb24sIGV4dGVuc2lvbikpO1xufVxuXG4vKipcbiAqIEdldCBsaXN0IG9mIGFsbCB0aGUgZXh0ZW5zaW9uIEpTIGZpbGVzXG4gKiBAcGFyYW0ge0hUTUxIZWFkRWxlbWVudHxFbGVtZW50fFNoYWRvd1Jvb3R9IGhlYWRcbiAqIEByZXR1cm4geyFBcnJheTxzdHJpbmc+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXh0ZW5zaW9uU2NyaXB0c0luTm9kZShoZWFkKSB7XG4gIC8vIGFtcGRvYy5nZXRIZWFkTm9kZSgpIGNhbiByZXR1cm4gbnVsbFxuICBpZiAoIWhlYWQpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgY29uc3Qgc2NyaXB0cyA9IFtdO1xuICBjb25zdCBsaXN0ID0gaGVhZC5xdWVyeVNlbGVjdG9yQWxsKCdzY3JpcHRbY3VzdG9tLWVsZW1lbnRdJyk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgIHNjcmlwdHMucHVzaChsaXN0W2ldLmdldEF0dHJpYnV0ZSgnY3VzdG9tLWVsZW1lbnQnKSk7XG4gIH1cbiAgcmV0dXJuIHNjcmlwdHM7XG59XG5cbi8qKlxuICogV2FpdHMgZm9yIGJvZHkgdG8gYmUgcHJlc2VudCB0aGVuIHZlcmlmaWVzIHRoYXQgYW4gZXh0ZW5zaW9uIHNjcmlwdCBpc1xuICogcHJlc2VudCBpbiBoZWFkIGZvciBpbnN0YWxsYXRpb24uXG4gKiBAcGFyYW0geyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb25JZFxuICogQHJldHVybiB7IVByb21pc2U8Ym9vbGVhbj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0V4dGVuc2lvblNjcmlwdEluTm9kZShhbXBkb2MsIGV4dGVuc2lvbklkKSB7XG4gIHJldHVybiBhbXBkb2Mud2hlbkJvZHlBdmFpbGFibGUoKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICByZXR1cm4gZXh0ZW5zaW9uU2NyaXB0SW5Ob2RlKFxuICAgICAgICAgICAgYW1wZG9jLmdldEhlYWROb2RlKCksIGV4dGVuc2lvbklkKTtcbiAgICAgIH0pO1xufVxuXG4vKipcbiAqIFZlcmlmaWVzIHRoYXQgYW4gZXh0ZW5zaW9uIHNjcmlwdCBpcyBwcmVzZW50IGluIGhlYWQgZm9yXG4gKiBpbnN0YWxsYXRpb24uXG4gKiBAcGFyYW0ge0hUTUxIZWFkRWxlbWVudHxFbGVtZW50fFNoYWRvd1Jvb3R9IGhlYWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb25JZFxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gZXh0ZW5zaW9uU2NyaXB0SW5Ob2RlKGhlYWQsIGV4dGVuc2lvbklkKSB7XG4gIHJldHVybiBleHRlbnNpb25TY3JpcHRzSW5Ob2RlKGhlYWQpLmluY2x1ZGVzKGV4dGVuc2lvbklkKTtcbn1cblxuLyoqXG4gKiBXYWl0cyBmb3IgYW4gZXh0ZW5zaW9uIGlmIGl0cyBzY3JpcHQgaXMgcHJlc2VudFxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb25cbiAqIEBwYXJhbSB7SFRNTEhlYWRFbGVtZW50fEVsZW1lbnR8U2hhZG93Um9vdH0gaGVhZFxuICogQHJldHVybiB7IVByb21pc2V9XG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiB3YWl0Rm9yRXh0ZW5zaW9uSWZQcmVzZW50KHdpbiwgZXh0ZW5zaW9uLCBoZWFkKSB7XG4gIC8qKlxuICAgKiBJZiB0aGVyZSBpcyBhbiBleHRlbnNpb24gc2NyaXB0IHdhaXQgZm9yIGl0IHRvIGxvYWQgYmVmb3JlIHRyeWluZ1xuICAgKiB0byBnZXQgdGhlIHNlcnZpY2UuIFByZXZlbnRzIGEgcmFjZSBjb25kaXRpb24gd2hlbiBldmVyeXRoaW5nIGJ1dFxuICAgKiB0aGUgZXh0ZW5zaW9ucyBpcyBpbiBjYWNoZS4gSWYgdGhlcmUgaXMgbm8gc2NyaXB0IHRoZW4gaXQncyBlaXRoZXJcbiAgICogbm90IHByZXNlbnQsIG9yIHRoZSBzZXJ2aWNlIHdhcyBkZWZpbmVkIGJ5IGEgdGVzdC4gSW4gdGhvc2UgY2FzZXNcbiAgICogd2UgZG9uJ3Qgd2FpdCBhcm91bmQgZm9yIGFuIGV4dGVuc2lvbiB0aGF0IGRvZXMgbm90IGV4aXN0LlxuICAgKi9cblxuICAvLyBUT0RPKGpwZXR0aXR0KSBpbnZlc3RpZ2F0ZSByZWdpc3RlckV4dGVuc2lvbiB0byBzaG9ydCBjaXJjdWl0XG4gIC8vIHRoZSBkb20gY2FsbCBpbiBleHRlbnNpb25TY3JpcHRzSW5Ob2RlKClcbiAgaWYgKCFleHRlbnNpb25TY3JpcHRJbk5vZGUoaGVhZCwgZXh0ZW5zaW9uKSkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuXG4gIGNvbnN0IGV4dGVuc2lvbnMgPSBnZXRTZXJ2aWNlKHdpbiwgJ2V4dGVuc2lvbnMnKTtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8P09iamVjdD59ICovIChcbiAgICBleHRlbnNpb25zLndhaXRGb3JFeHRlbnNpb24od2luLCBleHRlbnNpb24pKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwcm9taXNlIGZvciBzZXJ2aWNlIHdpdGggYGlkYCBvbiB0aGUgZ2l2ZW4gd2luZG93IGlmIGF2YWlsYWJsZS5cbiAqIE90aGVyd2lzZSwgcmVzb2x2ZXMgd2l0aCBudWxsIChzZXJ2aWNlIHdhcyBub3QgcmVnaXN0ZXJlZCkuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZWxlbWVudFxuICogQHJldHVybiB7IVByb21pc2U8T2JqZWN0Pn1cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIGdldEVsZW1lbnRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KSB7XG4gIHJldHVybiBkb20ud2FpdEZvckJvZHlQcm9taXNlKHdpbi5kb2N1bWVudClcbiAgICAgIC50aGVuKCgpID0+IHdhaXRGb3JFeHRlbnNpb25JZlByZXNlbnQod2luLCBleHRlbnNpb24sIHdpbi5kb2N1bWVudC5oZWFkKSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgLy8gSWYgdGhpcyBzZXJ2aWNlIGlzIHByb3ZpZGVkIGJ5IGFuIGVsZW1lbnQsIHRoZW4gd2UgY2FuJ3QgZGVwZW5kIG9uXG4gICAgICAgIC8vIHRoZSBzZXJ2aWNlICh0aGV5IG1heSBub3QgdXNlIHRoZSBlbGVtZW50KS5cbiAgICAgICAgaWYgKG9wdF9lbGVtZW50KSB7XG4gICAgICAgICAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsKHdpbiwgaWQpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzRWxlbWVudFNjaGVkdWxlZCh3aW4sIGV4dGVuc2lvbikpIHtcbiAgICAgICAgICByZXR1cm4gZ2V0U2VydmljZVByb21pc2Uod2luLCBpZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAgKiBXaGV0aGVyIGFkZEV2ZW50TGlzdGVuZXIgc3VwcG9ydHMgb3B0aW9ucyBvciBvbmx5IHRha2VzIGNhcHR1cmUgYXMgYSBib29sZWFuXG4gICogQHR5cGUge2Jvb2xlYW58dW5kZWZpbmVkfVxuICAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICAqL1xubGV0IG9wdHNTdXBwb3J0ZWQ7XG5cbi8qKlxuICogTGlzdGVucyBmb3IgdGhlIHNwZWNpZmllZCBldmVudCBvbiB0aGUgZWxlbWVudC5cbiAqXG4gKiBEbyBub3QgdXNlIHRoaXMgZGlyZWN0bHkuIFRoaXMgbWV0aG9kIGlzIGltcGxlbWVudGVkIGFzIGEgc2hhcmVkXG4gKiBkZXBlbmRlbmN5LiBVc2UgYGxpc3RlbigpYCBpbiBlaXRoZXIgYGV2ZW50LWhlbHBlcmAgb3IgYDNwLWZyYW1lLW1lc3NhZ2luZ2AsXG4gKiBkZXBlbmRpbmcgb24geW91ciB1c2UgY2FzZS5cbiAqXG4gKiBAcGFyYW0geyFFdmVudFRhcmdldH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50VHlwZVxuICogQHBhcmFtIHtmdW5jdGlvbighRXZlbnQpfSBsaXN0ZW5lclxuICogQHBhcmFtIHtPYmplY3Q9fSBvcHRfZXZ0TGlzdGVuZXJPcHRzXG4gKiBAcmV0dXJuIHshVW5saXN0ZW5EZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcm5hbExpc3RlbkltcGxlbWVudGF0aW9uKGVsZW1lbnQsIGV2ZW50VHlwZSwgbGlzdGVuZXIsXG4gIG9wdF9ldnRMaXN0ZW5lck9wdHMpIHtcbiAgbGV0IGxvY2FsRWxlbWVudCA9IGVsZW1lbnQ7XG4gIGxldCBsb2NhbExpc3RlbmVyID0gbGlzdGVuZXI7XG4gIC8qKlxuICAgKiBAdHlwZSB7P0Z1bmN0aW9ufVxuICAgKi9cbiAgbGV0IHdyYXBwZWQ7XG5cbiAgd3JhcHBlZCA9IGV2ZW50ID0+IHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGxvY2FsTGlzdGVuZXIoZXZlbnQpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIHJlcG9ydEVycm9yIGlzIGluc3RhbGxlZCBnbG9iYWxseSBwZXIgd2luZG93IGluIHRoZSBlbnRyeSBwb2ludC5cbiAgICAgIHNlbGYucmVwb3J0RXJyb3IoZSk7XG4gICAgICB0aHJvdyBlO1xuICAgIH1cbiAgfTtcbiAgY29uc3Qgb3B0c1N1cHBvcnRlZCA9IGRldGVjdEV2dExpc3RlbmVyT3B0c1N1cHBvcnQoKTtcbiAgbGV0IGNhcHR1cmUgPSBmYWxzZTtcbiAgaWYgKG9wdF9ldnRMaXN0ZW5lck9wdHMpIHtcbiAgICBjYXB0dXJlID0gb3B0X2V2dExpc3RlbmVyT3B0cy5jYXB0dXJlO1xuICB9XG4gIGxvY2FsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgZXZlbnRUeXBlLFxuICAgICAgd3JhcHBlZCxcbiAgICAgIG9wdHNTdXBwb3J0ZWQgPyBvcHRfZXZ0TGlzdGVuZXJPcHRzIDogY2FwdHVyZVxuICApO1xuICByZXR1cm4gKCkgPT4ge1xuICAgIGlmIChsb2NhbEVsZW1lbnQpIHtcbiAgICAgIGxvY2FsRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgICAgIGV2ZW50VHlwZSxcbiAgICAgICAgICB3cmFwcGVkLFxuICAgICAgICAgIG9wdHNTdXBwb3J0ZWQgPyBvcHRfZXZ0TGlzdGVuZXJPcHRzIDogY2FwdHVyZVxuICAgICAgKTtcbiAgICB9XG4gICAgLy8gRW5zdXJlIHRoZXNlIGFyZSBHQydkXG4gICAgbG9jYWxMaXN0ZW5lciA9IG51bGw7XG4gICAgbG9jYWxFbGVtZW50ID0gbnVsbDtcbiAgICB3cmFwcGVkID0gbnVsbDtcbiAgfTtcbn1cblxuLyoqXG4gKiBUZXN0cyB3aGV0aGVyIHRoZSBicm93c2VyIHN1cHBvcnRzIG9wdGlvbnMgYXMgYW4gYXJndW1lbnQgb2YgYWRkRXZlbnRMaXN0ZW5lclxuICogb3Igbm90LlxuICpcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZXRlY3RFdnRMaXN0ZW5lck9wdHNTdXBwb3J0KCkge1xuICAvLyBPbmx5IHJ1biB0aGUgdGVzdCBvbmNlXG4gIGlmIChvcHRzU3VwcG9ydGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gb3B0c1N1cHBvcnRlZDtcbiAgfVxuXG4gIG9wdHNTdXBwb3J0ZWQgPSBmYWxzZTtcbiAgdHJ5IHtcbiAgICAvLyBUZXN0IHdoZXRoZXIgYnJvd3NlciBzdXBwb3J0cyBFdmVudExpc3RlbmVyT3B0aW9ucyBvciBub3RcbiAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgZ2V0IGNhcHR1cmUoKSB7XG4gICAgICAgIG9wdHNTdXBwb3J0ZWQgPSB0cnVlO1xuICAgICAgfSxcbiAgICB9O1xuICAgIHNlbGYuYWRkRXZlbnRMaXN0ZW5lcigndGVzdC1vcHRpb25zJywgbnVsbCwgb3B0aW9ucyk7XG4gICAgc2VsZi5yZW1vdmVFdmVudExpc3RlbmVyKCd0ZXN0LW9wdGlvbnMnLCBudWxsLCBvcHRpb25zKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgLy8gRXZlbnRMaXN0ZW5lck9wdGlvbnMgYXJlIG5vdCBzdXBwb3J0ZWRcbiAgfVxuICByZXR1cm4gb3B0c1N1cHBvcnRlZDtcbn1cblxuLyoqXG4gICogUmVzZXRzIHRoZSB0ZXN0IGZvciB3aGV0aGVyIGFkZEV2ZW50TGlzdGVuZXIgc3VwcG9ydHMgb3B0aW9ucyBvciBub3QuXG4gICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRFdnRMaXN0ZW5lck9wdHNTdXBwb3J0Rm9yVGVzdGluZygpIHtcbiAgb3B0c1N1cHBvcnRlZCA9IHVuZGVmaW5lZDtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2ludGVybmFsTGlzdGVuSW1wbGVtZW50YXRpb259IGZyb20gJy4vZXZlbnQtaGVscGVyLWxpc3Rlbic7XG5pbXBvcnQge3VzZXJ9IGZyb20gJy4vbG9nJztcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAgKi9cbmNvbnN0IExPQURfRkFJTFVSRV9QUkVGSVggPSAnRmFpbGVkIHRvIGxvYWQ6JztcblxuLyoqXG4gKiBSZXR1cm5zIGEgQ3VzdG9tRXZlbnQgd2l0aCBhIGdpdmVuIHR5cGUgYW5kIGRldGFpbDsgc3VwcG9ydHMgZmFsbGJhY2sgZm9yIElFLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0fHN0cmluZ3x1bmRlZmluZWR8bnVsbH0gZGV0YWlsXG4gKiBAcGFyYW0ge0V2ZW50SW5pdD19IG9wdF9ldmVudEluaXRcbiAqIEByZXR1cm4geyFFdmVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUN1c3RvbUV2ZW50KHdpbiwgdHlwZSwgZGV0YWlsLCBvcHRfZXZlbnRJbml0KSB7XG4gIGNvbnN0IGV2ZW50SW5pdCA9IC8qKiBAdHlwZSB7IUN1c3RvbUV2ZW50SW5pdH0gKi8gKHtkZXRhaWx9KTtcbiAgT2JqZWN0LmFzc2lnbihldmVudEluaXQsIG9wdF9ldmVudEluaXQpO1xuICAvLyB3aW4uQ3VzdG9tRXZlbnQgaXMgYSBmdW5jdGlvbiBvbiBFZGdlLCBDaHJvbWUsIEZGLCBTYWZhcmkgYnV0XG4gIC8vIGlzIGFuIG9iamVjdCBvbiBJRSAxMS5cbiAgaWYgKHR5cGVvZiB3aW4uQ3VzdG9tRXZlbnQgPT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBuZXcgd2luLkN1c3RvbUV2ZW50KHR5cGUsIGV2ZW50SW5pdCk7XG4gIH0gZWxzZSB7XG4gICAgLy8gRGVwcmVjYXRlZCBmYWxsYmFjayBmb3IgSUUuXG4gICAgY29uc3QgZSA9IHdpbi5kb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcbiAgICBlLmluaXRDdXN0b21FdmVudChcbiAgICAgICAgdHlwZSwgISFldmVudEluaXQuYnViYmxlcywgISFldmVudEluaXQuY2FuY2VsYWJsZSwgZGV0YWlsKTtcbiAgICByZXR1cm4gZTtcbiAgfVxufVxuXG4vKipcbiAqIExpc3RlbnMgZm9yIHRoZSBzcGVjaWZpZWQgZXZlbnQgb24gdGhlIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFdmVudFRhcmdldH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50VHlwZVxuICogQHBhcmFtIHtmdW5jdGlvbighRXZlbnQpfSBsaXN0ZW5lclxuICogQHBhcmFtIHtPYmplY3Q9fSBvcHRfZXZ0TGlzdGVuZXJPcHRzXG4gKiBAcmV0dXJuIHshVW5saXN0ZW5EZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW4oZWxlbWVudCwgZXZlbnRUeXBlLCBsaXN0ZW5lciwgb3B0X2V2dExpc3RlbmVyT3B0cykge1xuICByZXR1cm4gaW50ZXJuYWxMaXN0ZW5JbXBsZW1lbnRhdGlvbihcbiAgICAgIGVsZW1lbnQsIGV2ZW50VHlwZSwgbGlzdGVuZXIsIG9wdF9ldnRMaXN0ZW5lck9wdHMpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGRhdGEgcHJvcGVydHkgb2YgYW4gZXZlbnQgd2l0aCB0aGUgY29ycmVjdCB0eXBlLlxuICogQHBhcmFtIHshRXZlbnR8e2RhdGE6ICFKc29uT2JqZWN0fX0gZXZlbnRcbiAqIEByZXR1cm4gez9Kc29uT2JqZWN0fHN0cmluZ3x1bmRlZmluZWR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXREYXRhKGV2ZW50KSB7XG4gIHJldHVybiAvKiogQHR5cGUgez9Kc29uT2JqZWN0fHN0cmluZ3x1bmRlZmluZWR9ICovIChldmVudC5kYXRhKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBkZXRhaWwgcHJvcGVydHkgb2YgYW4gZXZlbnQgd2l0aCB0aGUgY29ycmVjdCB0eXBlLlxuICogQHBhcmFtIHshRXZlbnR8e2RldGFpbDogIUpzb25PYmplY3R9fSBldmVudFxuICogQHJldHVybiB7P0pzb25PYmplY3R8c3RyaW5nfHVuZGVmaW5lZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldERldGFpbChldmVudCkge1xuICByZXR1cm4gLyoqIEB0eXBlIHs/SnNvbk9iamVjdHxzdHJpbmd8dW5kZWZpbmVkfSAqLyAoZXZlbnQuZGV0YWlsKTtcbn1cblxuLyoqXG4gKiBMaXN0ZW5zIGZvciB0aGUgc3BlY2lmaWVkIGV2ZW50IG9uIHRoZSBlbGVtZW50IGFuZCByZW1vdmVzIHRoZSBsaXN0ZW5lclxuICogYXMgc29vbiBhcyBldmVudCBoYXMgYmVlbiByZWNlaXZlZC5cbiAqIEBwYXJhbSB7IUV2ZW50VGFyZ2V0fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFdmVudCl9IGxpc3RlbmVyXG4gKiBAcGFyYW0ge09iamVjdD19IG9wdF9ldnRMaXN0ZW5lck9wdHNcbiAqIEByZXR1cm4geyFVbmxpc3RlbkRlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxpc3Rlbk9uY2UoZWxlbWVudCwgZXZlbnRUeXBlLCBsaXN0ZW5lciwgb3B0X2V2dExpc3RlbmVyT3B0cykge1xuICBsZXQgbG9jYWxMaXN0ZW5lciA9IGxpc3RlbmVyO1xuICBjb25zdCB1bmxpc3RlbiA9IGludGVybmFsTGlzdGVuSW1wbGVtZW50YXRpb24oZWxlbWVudCwgZXZlbnRUeXBlLCBldmVudCA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGxvY2FsTGlzdGVuZXIoZXZlbnQpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICAvLyBFbnN1cmUgbGlzdGVuZXIgaXMgR0MnZFxuICAgICAgbG9jYWxMaXN0ZW5lciA9IG51bGw7XG4gICAgICB1bmxpc3RlbigpO1xuICAgIH1cbiAgfSwgb3B0X2V2dExpc3RlbmVyT3B0cyk7XG4gIHJldHVybiB1bmxpc3Rlbjtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgIGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSBhcyBzb29uIGFzIHRoZSBzcGVjaWZpZWQgZXZlbnQgaGFzXG4gKiBmaXJlZCBvbiB0aGUgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUV2ZW50VGFyZ2V0fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gKiBAcGFyYW0ge09iamVjdD19IG9wdF9ldnRMaXN0ZW5lck9wdHNcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIVVubGlzdGVuRGVmKT19IG9wdF9jYW5jZWwgQW4gb3B0aW9uYWwgZnVuY3Rpb24gdGhhdCwgd2hlblxuICogICAgIHByb3ZpZGVkLCB3aWxsIGJlIGNhbGxlZCB3aXRoIHRoZSB1bmxpc3RlbmVyLiBUaGlzIGdpdmVzIHRoZSBjYWxsZXJcbiAqICAgICBhY2Nlc3MgdG8gdGhlIHVubGlzdGVuZXIsIHNvIGl0IG1heSBiZSBjYWxsZWQgbWFudWFsbHkgd2hlbiBuZWNlc3NhcnkuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhRXZlbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGlzdGVuT25jZVByb21pc2UoZWxlbWVudCwgZXZlbnRUeXBlLCBvcHRfZXZ0TGlzdGVuZXJPcHRzLFxuICBvcHRfY2FuY2VsKSB7XG4gIGxldCB1bmxpc3RlbjtcbiAgY29uc3QgZXZlbnRQcm9taXNlID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgdW5saXN0ZW4gPSBsaXN0ZW5PbmNlKGVsZW1lbnQsIGV2ZW50VHlwZSwgcmVzb2x2ZSwgb3B0X2V2dExpc3RlbmVyT3B0cyk7XG4gIH0pO1xuICBldmVudFByb21pc2UudGhlbih1bmxpc3RlbiwgdW5saXN0ZW4pO1xuICBpZiAob3B0X2NhbmNlbCkge1xuICAgIG9wdF9jYW5jZWwodW5saXN0ZW4pO1xuICB9XG4gIHJldHVybiBldmVudFByb21pc2U7XG59XG5cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBzcGVjaWZpZWQgZWxlbWVudC93aW5kb3cgaGFzIGJlZW4gbG9hZGVkIGFscmVhZHkuXG4gKiBAcGFyYW0geyFFbGVtZW50fCFXaW5kb3d9IGVsZU9yV2luZG93XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNMb2FkZWQoZWxlT3JXaW5kb3cpIHtcbiAgcmV0dXJuICEhKGVsZU9yV2luZG93LmNvbXBsZXRlIHx8IGVsZU9yV2luZG93LnJlYWR5U3RhdGUgPT0gJ2NvbXBsZXRlJ1xuICAgICAgLy8gSWYgdGhlIHBhc3NlZCBpbiB0aGluZyBpcyBhIFdpbmRvdywgaW5mZXIgbG9hZGVkIHN0YXRlIGZyb21cbiAgICAgIC8vXG4gICAgICB8fCAoZWxlT3JXaW5kb3cuZG9jdW1lbnRcbiAgICAgICAgICAmJiBlbGVPcldpbmRvdy5kb2N1bWVudC5yZWFkeVN0YXRlID09ICdjb21wbGV0ZScpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSBvciBmYWlsIGJhc2VkIG9uIHRoZSBlbGVPcldpbmRvdydzICdsb2FkJ1xuICogYW5kICdlcnJvcicgZXZlbnRzLiBPcHRpb25hbGx5IHRoaXMgbWV0aG9kIHRha2VzIGEgdGltZW91dCwgd2hpY2ggd2lsbCByZWplY3RcbiAqIHRoZSBwcm9taXNlIGlmIHRoZSByZXNvdXJjZSBoYXMgbm90IGxvYWRlZCBieSB0aGVuLlxuICogQHBhcmFtIHtUfSBlbGVPcldpbmRvdyBTdXBwb3J0cyBib3RoIEVsZW1lbnRzIGFuZCBhcyBhIHNwZWNpYWwgY2FzZSBXaW5kb3dzLlxuICogQHJldHVybiB7IVByb21pc2U8VD59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9hZFByb21pc2UoZWxlT3JXaW5kb3cpIHtcbiAgbGV0IHVubGlzdGVuTG9hZDtcbiAgbGV0IHVubGlzdGVuRXJyb3I7XG4gIGlmIChpc0xvYWRlZChlbGVPcldpbmRvdykpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGVsZU9yV2luZG93KTtcbiAgfVxuICBjb25zdCBsb2FkaW5nUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAvLyBMaXN0ZW4gb25jZSBzaW5jZSBJRSA1LzYvNyBmaXJlIHRoZSBvbmxvYWQgZXZlbnQgY29udGludW91c2x5IGZvclxuICAgIC8vIGFuaW1hdGVkIEdJRnMuXG4gICAgY29uc3Qge3RhZ05hbWV9ID0gZWxlT3JXaW5kb3c7XG4gICAgaWYgKHRhZ05hbWUgPT09ICdBVURJTycgfHwgdGFnTmFtZSA9PT0gJ1ZJREVPJykge1xuICAgICAgdW5saXN0ZW5Mb2FkID0gbGlzdGVuT25jZShlbGVPcldpbmRvdywgJ2xvYWRzdGFydCcsIHJlc29sdmUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB1bmxpc3RlbkxvYWQgPSBsaXN0ZW5PbmNlKGVsZU9yV2luZG93LCAnbG9hZCcsIHJlc29sdmUpO1xuICAgIH1cbiAgICAvLyBGb3IgZWxlbWVudHMsIHVubGlzdGVuIG9uIGVycm9yIChkb24ndCBmb3IgV2luZG93cykuXG4gICAgaWYgKHRhZ05hbWUpIHtcbiAgICAgIHVubGlzdGVuRXJyb3IgPSBsaXN0ZW5PbmNlKGVsZU9yV2luZG93LCAnZXJyb3InLCByZWplY3QpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIGxvYWRpbmdQcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgIGlmICh1bmxpc3RlbkVycm9yKSB7XG4gICAgICB1bmxpc3RlbkVycm9yKCk7XG4gICAgfVxuICAgIHJldHVybiBlbGVPcldpbmRvdztcbiAgfSwgKCkgPT4ge1xuICAgIGlmICh1bmxpc3RlbkxvYWQpIHtcbiAgICAgIHVubGlzdGVuTG9hZCgpO1xuICAgIH1cbiAgICBmYWlsZWRUb0xvYWQoZWxlT3JXaW5kb3cpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBFbWl0IGVycm9yIG9uIGxvYWQgZmFpbHVyZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IVdpbmRvd30gZWxlT3JXaW5kb3cgU3VwcG9ydHMgYm90aCBFbGVtZW50cyBhbmQgYXMgYSBzcGVjaWFsXG4gKiAgICAgY2FzZSBXaW5kb3dzLlxuICovXG5mdW5jdGlvbiBmYWlsZWRUb0xvYWQoZWxlT3JXaW5kb3cpIHtcbiAgLy8gUmVwb3J0IGZhaWxlZCBsb2FkcyBhcyB1c2VyIGVycm9ycyBzbyB0aGF0IHRoZXkgYXV0b21hdGljYWxseSBnb1xuICAvLyBpbnRvIHRoZSBcImRvY3VtZW50IGVycm9yXCIgYnVja2V0LlxuICBsZXQgdGFyZ2V0ID0gZWxlT3JXaW5kb3c7XG4gIGlmICh0YXJnZXQgJiYgdGFyZ2V0LnNyYykge1xuICAgIHRhcmdldCA9IHRhcmdldC5zcmM7XG4gIH1cbiAgdGhyb3cgdXNlcigpLmNyZWF0ZUVycm9yKExPQURfRkFJTFVSRV9QUkVGSVgsIHRhcmdldCk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoaXMgZXJyb3IgbWVzc2FnZSBpcyB3YXMgY3JlYXRlZCBmb3IgYSBsb2FkIGVycm9yLlxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgQW4gZXJyb3IgbWVzc2FnZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTG9hZEVycm9yTWVzc2FnZShtZXNzYWdlKSB7XG4gIHJldHVybiBtZXNzYWdlLmluZGV4T2YoTE9BRF9GQUlMVVJFX1BSRUZJWCkgIT0gLTE7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IEV4cGVyaW1lbnRzIHN5c3RlbSBhbGxvd3MgYSBkZXZlbG9wZXIgdG8gb3B0LWluIHRvIHRlc3RcbiAqIGZlYXR1cmVzIHRoYXQgYXJlIG5vdCB5ZXQgZnVsbHkgdGVzdGVkLlxuICpcbiAqIEV4cGVyaW1lbnRzIHBhZ2U6IGh0dHBzOi8vY2RuLmFtcHByb2plY3Qub3JnL2V4cGVyaW1lbnRzLmh0bWwgKlxuICovXG5cbmltcG9ydCB7Z2V0Q29va2llLCBzZXRDb29raWV9IGZyb20gJy4vY29va2llcyc7XG5pbXBvcnQge2hhc093bn0gZnJvbSAnLi91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtwYXJzZVF1ZXJ5U3RyaW5nfSBmcm9tICcuL3VybCc7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmNvbnN0IENPT0tJRV9OQU1FID0gJ0FNUF9FWFAnO1xuXG4vKiogQGNvbnN0IHtudW1iZXJ9ICovXG5jb25zdCBDT09LSUVfTUFYX0FHRV9EQVlTID0gMTgwOyAvLyA2IG1vbnRoXG5cbi8qKiBAY29uc3Qge3RpbWV9ICovXG5jb25zdCBDT09LSUVfRVhQSVJBVElPTl9JTlRFUlZBTCA9IENPT0tJRV9NQVhfQUdFX0RBWVMgKiAyNCAqIDYwICogNjAgKiAxMDAwO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5jb25zdCBUT0dHTEVTX1dJTkRPV19QUk9QRVJUWSA9ICdfX0FNUF9fRVhQRVJJTUVOVF9UT0dHTEVTJztcblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBpc1RyYWZmaWNFbGlnaWJsZTogZnVuY3Rpb24oIVdpbmRvdyk6Ym9vbGVhbixcbiAqICAgYnJhbmNoZXM6ICFBcnJheTxzdHJpbmc+XG4gKiB9fVxuICovXG5leHBvcnQgbGV0IEV4cGVyaW1lbnRJbmZvO1xuXG4vKipcbiAqIFdoZXRoZXIgd2UgYXJlIGluIGNhbmFyeS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNDYW5hcnkod2luKSB7XG4gIHJldHVybiAhISh3aW4uQU1QX0NPTkZJRyAmJiB3aW4uQU1QX0NPTkZJRy5jYW5hcnkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYmluYXJ5IHR5cGUsIGUuZy4sIGNhbmFyeSwgY29udHJvbCwgb3IgcHJvZHVjdGlvbi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRCaW5hcnlUeXBlKHdpbikge1xuICByZXR1cm4gd2luLkFNUF9DT05GSUcgJiYgd2luLkFNUF9DT05GSUcudHlwZSA/XG4gICAgd2luLkFNUF9DT05GSUcudHlwZSA6ICd1bmtub3duJztcbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBzcGVjaWZpZWQgZXhwZXJpbWVudCBpcyBvbiBvciBvZmYuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGV4cGVyaW1lbnRJZFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRXhwZXJpbWVudE9uKHdpbiwgZXhwZXJpbWVudElkKSB7XG4gIGNvbnN0IHRvZ2dsZXMgPSBleHBlcmltZW50VG9nZ2xlcyh3aW4pO1xuICByZXR1cm4gISF0b2dnbGVzW2V4cGVyaW1lbnRJZF07XG59XG5cbi8qKlxuICogVG9nZ2xlcyB0aGUgZXhwZXJpbWVudCBvbiBvciBvZmYuIFJldHVybnMgdGhlIGFjdHVhbCB2YWx1ZSBvZiB0aGUgZXhwZXJpbWVudFxuICogYWZ0ZXIgdG9nZ2xpbmcgaXMgZG9uZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gZXhwZXJpbWVudElkXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfb25cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF90cmFuc2llbnRFeHBlcmltZW50ICBXaGV0aGVyIHRvIHRvZ2dsZSB0aGVcbiAqICAgICBleHBlcmltZW50IHN0YXRlIFwidHJhbnNpZW50bHlcIiAoaS5lLiwgZm9yIHRoaXMgcGFnZSBsb2FkIG9ubHkpIG9yXG4gKiAgICAgZHVyYWJseSAoYnkgc2F2aW5nIHRoZSBleHBlcmltZW50IElEcyB0byB0aGUgY29va2llIGFmdGVyIHRvZ2dsaW5nKS5cbiAqICAgICBEZWZhdWx0OiBmYWxzZSAoc2F2ZSBkdXJhYmx5KS5cbiAqIEByZXR1cm4ge2Jvb2xlYW59IE5ldyBzdGF0ZSBmb3IgZXhwZXJpbWVudElkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlRXhwZXJpbWVudCh3aW4sIGV4cGVyaW1lbnRJZCwgb3B0X29uLFxuICBvcHRfdHJhbnNpZW50RXhwZXJpbWVudCkge1xuICBjb25zdCBjdXJyZW50bHlPbiA9IGlzRXhwZXJpbWVudE9uKHdpbiwgLypPSyovZXhwZXJpbWVudElkKTtcbiAgY29uc3Qgb24gPSAhIShvcHRfb24gIT09IHVuZGVmaW5lZCA/IG9wdF9vbiA6ICFjdXJyZW50bHlPbik7XG4gIGlmIChvbiAhPSBjdXJyZW50bHlPbikge1xuICAgIGNvbnN0IHRvZ2dsZXMgPSBleHBlcmltZW50VG9nZ2xlcyh3aW4pO1xuICAgIHRvZ2dsZXNbZXhwZXJpbWVudElkXSA9IG9uO1xuXG4gICAgaWYgKCFvcHRfdHJhbnNpZW50RXhwZXJpbWVudCkge1xuICAgICAgY29uc3QgY29va2llVG9nZ2xlcyA9IGdldEV4cGVyaW1lbnRUb2dnbGVzRnJvbUNvb2tpZSh3aW4pO1xuICAgICAgY29va2llVG9nZ2xlc1tleHBlcmltZW50SWRdID0gb247XG4gICAgICBzYXZlRXhwZXJpbWVudFRvZ2dsZXNUb0Nvb2tpZSh3aW4sIGNvb2tpZVRvZ2dsZXMpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gb247XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIHdoZXRoZXIgdGhlIGV4cGVyaW1lbnQgaXMgb24gb3Igb2ZmIGJhc2VkIG9mZiBvZiB0aGVcbiAqIGNvb2tpZUZsYWcgb3IgdGhlIGdsb2JhbCBjb25maWcgZnJlcXVlbmN5IGdpdmVuLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4cGVyaW1lbnRUb2dnbGVzKHdpbikge1xuICBpZiAod2luW1RPR0dMRVNfV0lORE9XX1BST1BFUlRZXSkge1xuICAgIHJldHVybiB3aW5bVE9HR0xFU19XSU5ET1dfUFJPUEVSVFldO1xuICB9XG4gIHdpbltUT0dHTEVTX1dJTkRPV19QUk9QRVJUWV0gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBjb25zdCB0b2dnbGVzID0gd2luW1RPR0dMRVNfV0lORE9XX1BST1BFUlRZXTtcblxuICAvLyBSZWFkIHRoZSBkZWZhdWx0IGNvbmZpZyBvZiB0aGlzIGJ1aWxkLlxuICBpZiAod2luLkFNUF9DT05GSUcpIHtcbiAgICBmb3IgKGNvbnN0IGV4cGVyaW1lbnRJZCBpbiB3aW4uQU1QX0NPTkZJRykge1xuICAgICAgY29uc3QgZnJlcXVlbmN5ID0gd2luLkFNUF9DT05GSUdbZXhwZXJpbWVudElkXTtcbiAgICAgIGlmICh0eXBlb2YgZnJlcXVlbmN5ID09PSAnbnVtYmVyJyAmJiBmcmVxdWVuY3kgPj0gMCAmJiBmcmVxdWVuY3kgPD0gMSkge1xuICAgICAgICB0b2dnbGVzW2V4cGVyaW1lbnRJZF0gPSBNYXRoLnJhbmRvbSgpIDwgZnJlcXVlbmN5O1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAvLyBSZWFkIGRvY3VtZW50IGxldmVsIG92ZXJyaWRlIGZyb20gbWV0YSB0YWcuXG4gIGlmICh3aW4uQU1QX0NPTkZJR1xuICAgICAgJiYgQXJyYXkuaXNBcnJheSh3aW4uQU1QX0NPTkZJR1snYWxsb3ctZG9jLW9wdC1pbiddKVxuICAgICAgJiYgd2luLkFNUF9DT05GSUdbJ2FsbG93LWRvYy1vcHQtaW4nXS5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgYWxsb3dlZCA9IHdpbi5BTVBfQ09ORklHWydhbGxvdy1kb2Mtb3B0LWluJ107XG4gICAgY29uc3QgbWV0YSA9XG4gICAgICAgIHdpbi5kb2N1bWVudC5oZWFkLnF1ZXJ5U2VsZWN0b3IoJ21ldGFbbmFtZT1cImFtcC1leHBlcmltZW50cy1vcHQtaW5cIl0nKTtcbiAgICBpZiAobWV0YSkge1xuICAgICAgY29uc3Qgb3B0ZWRJbkV4cGVyaW1lbnRzID0gbWV0YS5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKS5zcGxpdCgnLCcpO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcHRlZEluRXhwZXJpbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGFsbG93ZWQuaW5kZXhPZihvcHRlZEluRXhwZXJpbWVudHNbaV0pICE9IC0xKSB7XG4gICAgICAgICAgdG9nZ2xlc1tvcHRlZEluRXhwZXJpbWVudHNbaV1dID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIE9iamVjdC5hc3NpZ24odG9nZ2xlcywgZ2V0RXhwZXJpbWVudFRvZ2dsZXNGcm9tQ29va2llKHdpbikpO1xuXG4gIGlmICh3aW4uQU1QX0NPTkZJR1xuICAgICAgJiYgQXJyYXkuaXNBcnJheSh3aW4uQU1QX0NPTkZJR1snYWxsb3ctdXJsLW9wdC1pbiddKVxuICAgICAgJiYgd2luLkFNUF9DT05GSUdbJ2FsbG93LXVybC1vcHQtaW4nXS5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgYWxsb3dlZCA9IHdpbi5BTVBfQ09ORklHWydhbGxvdy11cmwtb3B0LWluJ107XG4gICAgY29uc3QgaGFzaCA9IHdpbi5sb2NhdGlvbi5vcmlnaW5hbEhhc2ggfHwgd2luLmxvY2F0aW9uLmhhc2g7XG4gICAgY29uc3QgcGFyYW1zID0gcGFyc2VRdWVyeVN0cmluZyhoYXNoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbG93ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHBhcmFtID0gcGFyYW1zW2BlLSR7YWxsb3dlZFtpXX1gXTtcbiAgICAgIGlmIChwYXJhbSA9PSAnMScpIHtcbiAgICAgICAgdG9nZ2xlc1thbGxvd2VkW2ldXSA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAocGFyYW0gPT0gJzAnKSB7XG4gICAgICAgIHRvZ2dsZXNbYWxsb3dlZFtpXV0gPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRvZ2dsZXM7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgY2FjaGVkIGV4cGVyaW1lbnRzIHRvZ2dsZXMsIG9yIG51bGwgaWYgdGhleSBoYXZlIG5vdCBiZWVuXG4gKiBjb21wdXRlZCB5ZXQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7T2JqZWN0PHN0cmluZywgYm9vbGVhbj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHBlcmltZW50VG9nZ2xlc09yTnVsbCh3aW4pIHtcbiAgcmV0dXJuIHdpbltUT0dHTEVTX1dJTkRPV19QUk9QRVJUWV0gfHwgbnVsbDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2V0IG9mIGV4cGVyaW1lbnQgSURzIGN1cnJlbnRseSBvbi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgYm9vbGVhbj59XG4gKi9cbmZ1bmN0aW9uIGdldEV4cGVyaW1lbnRUb2dnbGVzRnJvbUNvb2tpZSh3aW4pIHtcbiAgY29uc3QgZXhwZXJpbWVudENvb2tpZSA9IGdldENvb2tpZSh3aW4sIENPT0tJRV9OQU1FKTtcbiAgY29uc3QgdG9rZW5zID0gZXhwZXJpbWVudENvb2tpZSA/IGV4cGVyaW1lbnRDb29raWUuc3BsaXQoL1xccyosXFxzKi9nKSA6IFtdO1xuXG4gIGNvbnN0IHRvZ2dsZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHRva2Vucy5sZW5ndGg7IGkrKykge1xuICAgIGlmICh0b2tlbnNbaV0ubGVuZ3RoID09IDApIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAodG9rZW5zW2ldWzBdID09ICctJykge1xuICAgICAgdG9nZ2xlc1t0b2tlbnNbaV0uc3Vic3RyKDEpXSA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0b2dnbGVzW3Rva2Vuc1tpXV0gPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0b2dnbGVzO1xufVxuXG4vKipcbiAqIFNhdmVzIGEgc2V0IG9mIGV4cGVyaW1lbnQgSURzIGN1cnJlbnRseSBvbi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPn0gdG9nZ2xlc1xuICovXG5mdW5jdGlvbiBzYXZlRXhwZXJpbWVudFRvZ2dsZXNUb0Nvb2tpZSh3aW4sIHRvZ2dsZXMpIHtcbiAgY29uc3QgZXhwZXJpbWVudElkcyA9IFtdO1xuICBmb3IgKGNvbnN0IGV4cGVyaW1lbnQgaW4gdG9nZ2xlcykge1xuICAgIGV4cGVyaW1lbnRJZHMucHVzaCgodG9nZ2xlc1tleHBlcmltZW50XSA9PT0gZmFsc2UgPyAnLScgOiAnJykgKyBleHBlcmltZW50KTtcbiAgfVxuXG4gIHNldENvb2tpZSh3aW4sIENPT0tJRV9OQU1FLCBleHBlcmltZW50SWRzLmpvaW4oJywnKSxcbiAgICAgIERhdGUubm93KCkgKyBDT09LSUVfRVhQSVJBVElPTl9JTlRFUlZBTCwge1xuICAgICAgICAvLyBTZXQgZXhwbGljaXQgZG9tYWluLCBzbyB0aGUgY29va2llIGdldHMgc2VuZCB0byBzdWIgZG9tYWlucy5cbiAgICAgICAgZG9tYWluOiB3aW4ubG9jYXRpb24uaG9zdG5hbWUsXG4gICAgICAgIGFsbG93T25Qcm94eU9yaWdpbjogdHJ1ZSxcbiAgICAgIH0pO1xufVxuXG4vKipcbiAqIFNlZSBnZXRFeHBlcmltZW50VG9nZ2xlc0Zyb21Db29raWUoKS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgYm9vbGVhbj59XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4cGVyaW1lbnRUb2dsZXNGcm9tQ29va2llRm9yVGVzdGluZyh3aW4pIHtcbiAgcmV0dXJuIGdldEV4cGVyaW1lbnRUb2dnbGVzRnJvbUNvb2tpZSh3aW4pO1xufVxuXG4vKipcbiAqIFJlc2V0cyB0aGUgZXhwZXJpbWVudHNUb2dnbGUgY2FjaGUgZm9yIHRlc3RpbmcgcHVycG9zZXMuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldEV4cGVyaW1lbnRUb2dnbGVzRm9yVGVzdGluZyh3aW4pIHtcbiAgc2V0Q29va2llKHdpbiwgQ09PS0lFX05BTUUsICcnLCAwLCB7XG4gICAgZG9tYWluOiB3aW4ubG9jYXRpb24uaG9zdG5hbWUsXG4gIH0pO1xuICB3aW5bVE9HR0xFU19XSU5ET1dfUFJPUEVSVFldID0gbnVsbDtcbn1cblxuLyoqXG4gKiBJbiBzb21lIGJyb3dzZXIgaW1wbGVtZW50YXRpb25zIG9mIE1hdGgucmFuZG9tKCksIHNlcXVlbnRpYWwgY2FsbHMgb2ZcbiAqIE1hdGgucmFuZG9tKCkgYXJlIGNvcnJlbGF0ZWQgYW5kIGNhbiBjYXVzZSBhIGJpYXMuICBJbiBwYXJ0aWN1bGFyLFxuICogaWYgdGhlIHByZXZpb3VzIHJhbmRvbSgpIGNhbGwgd2FzIDwgMC4wMDEgKGFzIGl0IHdpbGwgYmUgaWYgd2Ugc2VsZWN0XG4gKiBpbnRvIGFuIGV4cGVyaW1lbnQpLCB0aGUgbmV4dCB2YWx1ZSBjb3VsZCBiZSBsZXNzIHRoYW4gMC41IG1vcmUgdGhhblxuICogNTAuNyUgb2YgdGhlIHRpbWUuICBUaGlzIHByb3ZpZGVzIGFuIGltcGxlbWVudGF0aW9uIHRoYXQgcm9vdHMgZG93biBpbnRvXG4gKiB0aGUgY3J5cHRvIEFQSSwgd2hlbiBhdmFpbGFibGUsIHRvIHByb2R1Y2UgbGVzcyBiaWFzZWQgc2FtcGxlcy5cbiAqXG4gKiBAcmV0dXJuIHtudW1iZXJ9IFBzZXVkby1yYW5kb20gZmxvYXRpbmctcG9pbnQgdmFsdWUgb24gdGhlIHJhbmdlIFswLCAxKS5cbiAqL1xuZnVuY3Rpb24gc2xvd0J1dEFjY3VyYXRlUHJuZygpIHtcbiAgLy8gVE9ETyh0ZHJsKTogSW1wbGVtZW50LlxuICByZXR1cm4gTWF0aC5yYW5kb20oKTtcbn1cblxuLyoqXG4gKiBDb250YWluZXIgZm9yIGFsdGVybmF0ZSByYW5kb20gbnVtYmVyIGdlbmVyYXRvciBpbXBsZW1lbnRhdGlvbnMuICBUaGlzXG4gKiBhbGxvd3MgdXMgdG8gc2V0IGFuIFwiYWNjdXJhdGVcIiBQUk5HIGZvciBicmFuY2ggc2VsZWN0aW9uLCBidXQgdG8gbW9jayBpdFxuICogb3V0IGVhc2lseSBpbiB0ZXN0cy5cbiAqXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqIEBjb25zdCB7IXthY2N1cmF0ZVBybmc6IGZ1bmN0aW9uKCk6bnVtYmVyfX1cbiAqL1xuZXhwb3J0IGNvbnN0IFJBTkRPTV9OVU1CRVJfR0VORVJBVE9SUyA9IHtcbiAgYWNjdXJhdGVQcm5nOiBzbG93QnV0QWNjdXJhdGVQcm5nLFxufTtcblxuLyoqXG4gKiBTZWxlY3RzLCB1bmlmb3JtbHkgYXQgcmFuZG9tLCBhIHNpbmdsZSBpdGVtIGZyb20gdGhlIGFycmF5LlxuICogQHBhcmFtIHshQXJyYXk8c3RyaW5nPn0gYXJyIE9iamVjdCB0byBzZWxlY3QgZnJvbS5cbiAqIEByZXR1cm4gez9zdHJpbmd9IFNpbmdsZSBpdGVtIGZyb20gYXJyIG9yIG51bGwgaWYgYXJyIHdhcyBlbXB0eS5cbiAqL1xuZnVuY3Rpb24gc2VsZWN0UmFuZG9tSXRlbShhcnIpIHtcbiAgY29uc3Qgcm4gPSBSQU5ET01fTlVNQkVSX0dFTkVSQVRPUlMuYWNjdXJhdGVQcm5nKCk7XG4gIHJldHVybiBhcnJbTWF0aC5mbG9vcihybiAqIGFyci5sZW5ndGgpXSB8fCBudWxsO1xufVxuXG4vKipcbiAqIFNlbGVjdHMgd2hpY2ggcGFnZS1sZXZlbCBleHBlcmltZW50IGJyYW5jaGVzIGFyZSBlbmFibGVkLiBJZiBhIGdpdmVuXG4gKiBleHBlcmltZW50IG5hbWUgaXMgYWxyZWFkeSBzZXQgKGluY2x1ZGluZyB0byB0aGUgbnVsbCAvIG5vIGJyYW5jaGVzIHNlbGVjdGVkXG4gKiBzdGF0ZSksIHRoaXMgd29uJ3QgYWx0ZXIgaXRzIHN0YXRlLlxuICpcbiAqIENoZWNrIHdoZXRoZXIgYSBnaXZlbiBleHBlcmltZW50IGlzIHNldCB1c2luZyBpc0V4cGVyaW1lbnRPbih3aW4sXG4gKiBleHBlcmltZW50TmFtZSkgYW5kLCBpZiBpdCBpcyBvbiwgbG9vayBmb3Igd2hpY2ggYnJhbmNoIGlzIHNlbGVjdGVkIGluXG4gKiB3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXS5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpbiBXaW5kb3cgY29udGV4dCBvbiB3aGljaCB0byBzYXZlIGV4cGVyaW1lbnRcbiAqICAgICBzZWxlY3Rpb24gc3RhdGUuXG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAhRXhwZXJpbWVudEluZm8+fSBleHBlcmltZW50cyAgU2V0IG9mIGV4cGVyaW1lbnRzIHRvXG4gKiAgICAgY29uZmlndXJlIGZvciB0aGlzIHBhZ2UgbG9hZC5cbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBNYXAgb2YgZXhwZXJpbWVudCBuYW1lcyB0byBzZWxlY3RlZFxuICogICAgIGJyYW5jaGVzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tbHlTZWxlY3RVbnNldEV4cGVyaW1lbnRzKHdpbiwgZXhwZXJpbWVudHMpIHtcbiAgd2luLmV4cGVyaW1lbnRCcmFuY2hlcyA9IHdpbi5leHBlcmltZW50QnJhbmNoZXMgfHwge307XG4gIGNvbnN0IHNlbGVjdGVkRXhwZXJpbWVudHMgPSB7fTtcbiAgZm9yIChjb25zdCBleHBlcmltZW50TmFtZSBpbiBleHBlcmltZW50cykge1xuICAgIC8vIFNraXAgZXhwZXJpbWVudE5hbWUgaWYgaXQgaXMgbm90IGEga2V5IG9mIGV4cGVyaW1lbnRzIG9iamVjdCBvciBpZiBpdFxuICAgIC8vIGhhcyBhbHJlYWR5IGJlZW4gcG9wdWxhdGVkIGJ5IHNvbWUgb3RoZXIgcHJvcGVydHkuXG4gICAgaWYgKCFoYXNPd24oZXhwZXJpbWVudHMsIGV4cGVyaW1lbnROYW1lKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChoYXNPd24od2luLmV4cGVyaW1lbnRCcmFuY2hlcywgZXhwZXJpbWVudE5hbWUpKSB7XG4gICAgICBzZWxlY3RlZEV4cGVyaW1lbnRzW2V4cGVyaW1lbnROYW1lXSA9XG4gICAgICAgICAgd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV07XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoIWV4cGVyaW1lbnRzW2V4cGVyaW1lbnROYW1lXS5pc1RyYWZmaWNFbGlnaWJsZSB8fFxuICAgICAgICAhZXhwZXJpbWVudHNbZXhwZXJpbWVudE5hbWVdLmlzVHJhZmZpY0VsaWdpYmxlKHdpbikpIHtcbiAgICAgIHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdID0gbnVsbDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIC8vIElmIHdlJ3JlIGluIHRoZSBleHBlcmltZW50LCBidXQgd2UgaGF2ZW4ndCBhbHJlYWR5IGZvcmNlZCBhIHNwZWNpZmljXG4gICAgLy8gZXhwZXJpbWVudCBicmFuY2ggKGUuZy4sIHZpYSBhIHRlc3Qgc2V0dXApLCB0aGVuIHJhbmRvbWl6ZSB0aGUgYnJhbmNoXG4gICAgLy8gY2hvaWNlLlxuICAgIGlmICghd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV0gJiZcbiAgICAgIGlzRXhwZXJpbWVudE9uKHdpbiwgLypPSyovZXhwZXJpbWVudE5hbWUpKSB7XG4gICAgICBjb25zdCB7YnJhbmNoZXN9ID0gZXhwZXJpbWVudHNbZXhwZXJpbWVudE5hbWVdO1xuICAgICAgd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV0gPSBzZWxlY3RSYW5kb21JdGVtKGJyYW5jaGVzKTtcbiAgICAgIHNlbGVjdGVkRXhwZXJpbWVudHNbZXhwZXJpbWVudE5hbWVdID1cbiAgICAgICAgICB3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHNlbGVjdGVkRXhwZXJpbWVudHM7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZXhwZXJpbWVudCBicmFuY2ggZW5hYmxlZCBmb3IgdGhlIGdpdmVuIGV4cGVyaW1lbnQgSUQuXG4gKiBGb3IgZXhhbXBsZSwgJ2NvbnRyb2wnIG9yICdleHBlcmltZW50Jy5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpbiBXaW5kb3cgY29udGV4dCB0byBjaGVjayBmb3IgZXhwZXJpbWVudCBzdGF0ZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHBlcmltZW50TmFtZSBOYW1lIG9mIHRoZSBleHBlcmltZW50IHRvIGNoZWNrLlxuICogQHJldHVybiB7P3N0cmluZ30gQWN0aXZlIGV4cGVyaW1lbnQgYnJhbmNoIElEIGZvciBleHBlcmltZW50TmFtZSAocG9zc2libHlcbiAqICAgICBudWxsIGlmIGV4cGVyaW1lbnROYW1lIGhhcyBiZWVuIHRlc3RlZCBidXQgbm8gYnJhbmNoIHdhcyBlbmFibGVkKS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4cGVyaW1lbnRCcmFuY2god2luLCBleHBlcmltZW50TmFtZSkge1xuICByZXR1cm4gd2luLmV4cGVyaW1lbnRCcmFuY2hlcyA/IHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdIDogbnVsbDtcbn1cblxuLyoqXG4gKiBGb3JjZSBlbmFibGUgKG9yIGRpc2FibGUpIGEgc3BlY2lmaWMgYnJhbmNoIG9mIGEgZ2l2ZW4gZXhwZXJpbWVudCBuYW1lLlxuICogRGlzYWJsZXMgdGhlIGV4cGVyaW1lbnQgbmFtZSBhbHRvZ2V0aGVyIGlmIGJyYW5jaElkIGlzIGZhbHNlaXNoLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luIFdpbmRvdyBjb250ZXh0IHRvIGNoZWNrIGZvciBleHBlcmltZW50IHN0YXRlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4cGVyaW1lbnROYW1lIE5hbWUgb2YgdGhlIGV4cGVyaW1lbnQgdG8gY2hlY2suXG4gKiBAcGFyYW0gez9zdHJpbmd9IGJyYW5jaElkIElEIG9mIGJyYW5jaCB0byBmb3JjZSBvciBudWxsIHRvIGRpc2FibGVcbiAqICAgICBhbHRvZ2V0aGVyLlxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JjZUV4cGVyaW1lbnRCcmFuY2god2luLCBleHBlcmltZW50TmFtZSwgYnJhbmNoSWQpIHtcbiAgd2luLmV4cGVyaW1lbnRCcmFuY2hlcyA9IHdpbi5leHBlcmltZW50QnJhbmNoZXMgfHwge307XG4gIHRvZ2dsZUV4cGVyaW1lbnQod2luLCBleHBlcmltZW50TmFtZSwgISFicmFuY2hJZCwgdHJ1ZSk7XG4gIHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdID0gYnJhbmNoSWQ7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtHZXN0dXJlUmVjb2duaXplcn0gZnJvbSAnLi9nZXN0dXJlJztcbmltcG9ydCB7Y2FsY1ZlbG9jaXR5fSBmcm9tICcuL21vdGlvbic7XG5cblxuLyoqXG4gKiBBIFwidGFwXCIgZ2VzdHVyZS5cbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGNsaWVudFg6IG51bWJlcixcbiAqICAgY2xpZW50WTogbnVtYmVyXG4gKiB9fVxuICovXG5sZXQgVGFwRGVmO1xuXG5cbi8qKlxuICogUmVjb2duaXplcyBcInRhcFwiIGdlc3R1cmVzLlxuICogQGV4dGVuZHMge0dlc3R1cmVSZWNvZ25pemVyPFRhcERlZj59XG4gKi9cbmV4cG9ydCBjbGFzcyBUYXBSZWNvZ25pemVyIGV4dGVuZHMgR2VzdHVyZVJlY29nbml6ZXIge1xuICAvKipcbiAgICogQHBhcmFtIHshLi9nZXN0dXJlLkdlc3R1cmVzfSBtYW5hZ2VyXG4gICAqL1xuICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7XG4gICAgc3VwZXIoJ3RhcCcsIG1hbmFnZXIpO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5zdGFydFhfID0gMDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMuc3RhcnRZXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLmxhc3RYXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLmxhc3RZXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUgez9FdmVudFRhcmdldH0gKi9cbiAgICB0aGlzLnRhcmdldF8gPSBudWxsO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBvblRvdWNoU3RhcnQoZSkge1xuICAgIGNvbnN0IHt0b3VjaGVzfSA9IGU7XG4gICAgdGhpcy50YXJnZXRfID0gZS50YXJnZXQ7XG4gICAgaWYgKHRvdWNoZXMgJiYgdG91Y2hlcy5sZW5ndGggPT0gMSkge1xuICAgICAgdGhpcy5zdGFydFhfID0gdG91Y2hlc1swXS5jbGllbnRYO1xuICAgICAgdGhpcy5zdGFydFlfID0gdG91Y2hlc1swXS5jbGllbnRZO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIG9uVG91Y2hNb3ZlKGUpIHtcbiAgICBjb25zdCB0b3VjaGVzID0gZS5jaGFuZ2VkVG91Y2hlcyB8fCBlLnRvdWNoZXM7XG4gICAgaWYgKHRvdWNoZXMgJiYgdG91Y2hlcy5sZW5ndGggPT0gMSkge1xuICAgICAgdGhpcy5sYXN0WF8gPSB0b3VjaGVzWzBdLmNsaWVudFg7XG4gICAgICB0aGlzLmxhc3RZXyA9IHRvdWNoZXNbMF0uY2xpZW50WTtcbiAgICAgIGNvbnN0IGR4ID0gTWF0aC5hYnModGhpcy5sYXN0WF8gLSB0aGlzLnN0YXJ0WF8pID49IDg7XG4gICAgICBjb25zdCBkeSA9IE1hdGguYWJzKHRoaXMubGFzdFlfIC0gdGhpcy5zdGFydFlfKSA+PSA4O1xuICAgICAgaWYgKGR4IHx8IGR5KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIG9uVG91Y2hFbmQodW51c2VkRSkge1xuICAgIHRoaXMuc2lnbmFsUmVhZHkoMCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGFjY2VwdFN0YXJ0KCkge1xuICAgIHRoaXMuc2lnbmFsRW1pdCh7XG4gICAgICBjbGllbnRYOiB0aGlzLmxhc3RYXyxcbiAgICAgIGNsaWVudFk6IHRoaXMubGFzdFlfLFxuICAgICAgdGFyZ2V0OiB0aGlzLnRhcmdldF8sXG4gICAgfSwgbnVsbCk7XG4gICAgdGhpcy5zaWduYWxFbmQoKTtcbiAgfVxufVxuXG5cblxuLyoqXG4gKiBBIFwiZG91YmxldGFwXCIgZ2VzdHVyZS5cbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGNsaWVudFg6IG51bWJlcixcbiAqICAgY2xpZW50WTogbnVtYmVyXG4gKiB9fVxuICovXG5sZXQgRG91YmxldGFwRGVmO1xuXG5cbi8qKlxuICogUmVjb2duaXplcyBhIFwiZG91YmxldGFwXCIgZ2VzdHVyZS4gVGhpcyBnZXN0dXJlIHdpbGwgYmxvY2sgYSBzaW5nbGUgXCJ0YXBcIlxuICogZm9yIGFib3V0IDMwMG1zIHdoaWxlIGl0J3MgZXhwZWN0aW5nIHRoZSBzZWNvbmQgXCJ0YXBcIi5cbiAqIEBleHRlbmRzIHtHZXN0dXJlUmVjb2duaXplcjxEb3VibGV0YXBEZWY+fVxuICovXG5leHBvcnQgY2xhc3MgRG91YmxldGFwUmVjb2duaXplciBleHRlbmRzIEdlc3R1cmVSZWNvZ25pemVyIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4vZ2VzdHVyZS5HZXN0dXJlc30gbWFuYWdlclxuICAgKi9cbiAgY29uc3RydWN0b3IobWFuYWdlcikge1xuICAgIHN1cGVyKCdkb3VibGV0YXAnLCBtYW5hZ2VyKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMuc3RhcnRYXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnN0YXJ0WV8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5sYXN0WF8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5sYXN0WV8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy50YXBDb3VudF8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/RXZlbnR9ICovXG4gICAgdGhpcy5ldmVudF8gPSBudWxsO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBvblRvdWNoU3RhcnQoZSkge1xuICAgIGlmICh0aGlzLnRhcENvdW50XyA+IDEpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY29uc3Qge3RvdWNoZXN9ID0gZTtcbiAgICBpZiAodG91Y2hlcyAmJiB0b3VjaGVzLmxlbmd0aCA9PSAxKSB7XG4gICAgICB0aGlzLnN0YXJ0WF8gPSB0b3VjaGVzWzBdLmNsaWVudFg7XG4gICAgICB0aGlzLnN0YXJ0WV8gPSB0b3VjaGVzWzBdLmNsaWVudFk7XG4gICAgICB0aGlzLmxhc3RYXyA9IHRvdWNoZXNbMF0uY2xpZW50WDtcbiAgICAgIHRoaXMubGFzdFlfID0gdG91Y2hlc1swXS5jbGllbnRZO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIG9uVG91Y2hNb3ZlKGUpIHtcbiAgICBjb25zdCB7dG91Y2hlc30gPSBlO1xuICAgIGlmICh0b3VjaGVzICYmIHRvdWNoZXMubGVuZ3RoID09IDEpIHtcbiAgICAgIHRoaXMubGFzdFhfID0gdG91Y2hlc1swXS5jbGllbnRYO1xuICAgICAgdGhpcy5sYXN0WV8gPSB0b3VjaGVzWzBdLmNsaWVudFk7XG4gICAgICBjb25zdCBkeCA9IE1hdGguYWJzKHRoaXMubGFzdFhfIC0gdGhpcy5zdGFydFhfKSA+PSA4O1xuICAgICAgY29uc3QgZHkgPSBNYXRoLmFicyh0aGlzLmxhc3RZXyAtIHRoaXMuc3RhcnRZXykgPj0gODtcbiAgICAgIGlmIChkeCB8fCBkeSkge1xuICAgICAgICB0aGlzLmFjY2VwdENhbmNlbCgpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgb25Ub3VjaEVuZChlKSB7XG4gICAgdGhpcy50YXBDb3VudF8rKztcbiAgICBpZiAodGhpcy50YXBDb3VudF8gPCAyKSB7XG4gICAgICB0aGlzLnNpZ25hbFBlbmRpbmcoMzAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5ldmVudF8gPSBlO1xuICAgICAgdGhpcy5zaWduYWxSZWFkeSgwKTtcbiAgICB9XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGFjY2VwdFN0YXJ0KCkge1xuICAgIHRoaXMudGFwQ291bnRfID0gMDtcbiAgICB0aGlzLnNpZ25hbEVtaXQoe2NsaWVudFg6IHRoaXMubGFzdFhfLCBjbGllbnRZOiB0aGlzLmxhc3RZX30sIHRoaXMuZXZlbnRfKTtcbiAgICB0aGlzLnNpZ25hbEVuZCgpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBhY2NlcHRDYW5jZWwoKSB7XG4gICAgdGhpcy50YXBDb3VudF8gPSAwO1xuICB9XG59XG5cblxuXG4vKipcbiAqIEEgXCJzd2lwZS14eVwiLCBcInN3aXBlLXhcIiBvciBcInN3aXBlLXlcIiBnZXN0dXJlLiBBIG51bWJlciBvZiB0aGVzZSBnZXN0dXJlc1xuICogbWF5IGJlIGVtaXR0ZWQgZm9yIGEgc2luZ2xlIHRvdWNoIHNlcmllcy5cbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGZpcnN0OiBib29sZWFuLFxuICogICBsYXN0OiBib29sZWFuLFxuICogICBkZWx0YVg6IG51bWJlcixcbiAqICAgZGVsdGFZOiBudW1iZXIsXG4gKiAgIHZlbG9jaXR5WDogbnVtYmVyLFxuICogICB2ZWxvY2l0eVk6IG51bWJlclxuICogfX1cbiAqL1xuZXhwb3J0IGxldCBTd2lwZURlZjtcblxuXG4vKipcbiAqIFJlY29nbml6ZXMgc3dpcGUgZ2VzdHVyZXMuIFRoaXMgZ2VzdHVyZSB3aWxsIHlpZWxkIGFib3V0IDEwbXMgdG8gb3RoZXJcbiAqIGdlc3R1cmVzLlxuICogQGV4dGVuZHMge0dlc3R1cmVSZWNvZ25pemVyPFN3aXBlRGVmPn1cbiAqL1xuY2xhc3MgU3dpcGVSZWNvZ25pemVyIGV4dGVuZHMgR2VzdHVyZVJlY29nbml6ZXIge1xuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAgICogQHBhcmFtIHshLi9nZXN0dXJlLkdlc3R1cmVzfSBtYW5hZ2VyXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaG9yaXpcbiAgICogQHBhcmFtIHtib29sZWFufSB2ZXJ0XG4gICAqL1xuICBjb25zdHJ1Y3Rvcih0eXBlLCBtYW5hZ2VyLCBob3JpeiwgdmVydCkge1xuICAgIHN1cGVyKHR5cGUsIG1hbmFnZXIpO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuaG9yaXpfID0gaG9yaXo7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy52ZXJ0XyA9IHZlcnQ7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy5ldmVudGluZ18gPSBmYWxzZTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMuc3RhcnRYXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnN0YXJ0WV8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5sYXN0WF8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5sYXN0WV8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5wcmV2WF8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5wcmV2WV8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHt0aW1lfSAqL1xuICAgIHRoaXMuc3RhcnRUaW1lXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge3RpbWV9ICovXG4gICAgdGhpcy5sYXN0VGltZV8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHt0aW1lfSAqL1xuICAgIHRoaXMucHJldlRpbWVfID0gMDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMudmVsb2NpdHlYXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnZlbG9jaXR5WV8gPSAwO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBvblRvdWNoU3RhcnQoZSkge1xuICAgIGNvbnN0IHt0b3VjaGVzfSA9IGU7XG4gICAgaWYgKHRvdWNoZXMgJiYgdG91Y2hlcy5sZW5ndGggPT0gMSkge1xuICAgICAgdGhpcy5zdGFydFRpbWVfID0gRGF0ZS5ub3coKTtcbiAgICAgIHRoaXMuc3RhcnRYXyA9IHRvdWNoZXNbMF0uY2xpZW50WDtcbiAgICAgIHRoaXMuc3RhcnRZXyA9IHRvdWNoZXNbMF0uY2xpZW50WTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBvblRvdWNoTW92ZShlKSB7XG4gICAgY29uc3Qge3RvdWNoZXN9ID0gZTtcbiAgICBpZiAodG91Y2hlcyAmJiB0b3VjaGVzLmxlbmd0aCA9PSAxKSB7XG4gICAgICBjb25zdCB7Y2xpZW50WDogeCwgY2xpZW50WTogeX0gPSB0b3VjaGVzWzBdIDtcbiAgICAgIHRoaXMubGFzdFhfID0geDtcbiAgICAgIHRoaXMubGFzdFlfID0geTtcbiAgICAgIGlmICh0aGlzLmV2ZW50aW5nXykge1xuICAgICAgICB0aGlzLmVtaXRfKGZhbHNlLCBmYWxzZSwgZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBkeCA9IE1hdGguYWJzKHggLSB0aGlzLnN0YXJ0WF8pO1xuICAgICAgICBjb25zdCBkeSA9IE1hdGguYWJzKHkgLSB0aGlzLnN0YXJ0WV8pO1xuICAgICAgICAvLyBTd2lwZSBpcyBwZW5hbGl6ZWQgc2xpZ2h0bHkgc2luY2UgaXQncyBvbmUgb2YgdGhlIGxlYXN0IGRlbWFuZGluZ1xuICAgICAgICAvLyBnZXN0dXJlLCB0aHVzIC0xMCBpbiBzaWduYWxSZWFkeS5cbiAgICAgICAgaWYgKHRoaXMuaG9yaXpfICYmIHRoaXMudmVydF8pIHtcbiAgICAgICAgICBpZiAoZHggPj0gOCB8fCBkeSA+PSA4KSB7XG4gICAgICAgICAgICB0aGlzLnNpZ25hbFJlYWR5KC0xMCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaG9yaXpfKSB7XG4gICAgICAgICAgaWYgKGR4ID49IDggJiYgZHggPiBkeSkge1xuICAgICAgICAgICAgdGhpcy5zaWduYWxSZWFkeSgtMTApO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZHkgPj0gOCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnZlcnRfKSB7XG4gICAgICAgICAgaWYgKGR5ID49IDggJiYgZHkgPiBkeCkge1xuICAgICAgICAgICAgdGhpcy5zaWduYWxSZWFkeSgtMTApO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZHggPj0gOCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBvblRvdWNoRW5kKGUpIHtcbiAgICB0aGlzLmVuZF8oZSk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGFjY2VwdFN0YXJ0KCkge1xuICAgIHRoaXMuZXZlbnRpbmdfID0gdHJ1ZTtcbiAgICAvLyBSZXNldCBzdGFydCBjb29yZGluYXRlcyB0byB3aGVyZSB0aGUgZ2VzdHVyZSBiZWdhbiB0byBhdm9pZCB2aXNpYmxlXG4gICAgLy8ganVtcCwgYnV0IHByZXNlcnZlIHRoZW0gYXMgXCJwcmV2XCIgY29vcmRpbmF0ZXMgdG8gY2FsY3VsYXRlIHRoZSByaWdodFxuICAgIC8vIHZlbG9jaXR5LlxuICAgIHRoaXMucHJldlhfID0gdGhpcy5zdGFydFhfO1xuICAgIHRoaXMucHJldllfID0gdGhpcy5zdGFydFlfO1xuICAgIHRoaXMucHJldlRpbWVfID0gdGhpcy5zdGFydFRpbWVfO1xuICAgIHRoaXMuc3RhcnRYXyA9IHRoaXMubGFzdFhfO1xuICAgIHRoaXMuc3RhcnRZXyA9IHRoaXMubGFzdFlfO1xuICAgIHRoaXMuZW1pdF8odHJ1ZSwgZmFsc2UsIG51bGwpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBhY2NlcHRDYW5jZWwoKSB7XG4gICAgdGhpcy5ldmVudGluZ18gPSBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGZpcnN0XG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gbGFzdFxuICAgKiBAcGFyYW0gez9FdmVudH0gZXZlbnRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGVtaXRfKGZpcnN0LCBsYXN0LCBldmVudCkge1xuICAgIHRoaXMubGFzdFRpbWVfID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCBkZWx0YVRpbWUgPSB0aGlzLmxhc3RUaW1lXyAtIHRoaXMucHJldlRpbWVfO1xuICAgIC8vIEl0J3Mgb2Z0ZW4gdGhhdCBgdG91Y2hlbmRgIGFycml2ZXMgb24gdGhlIG5leHQgZnJhbWUuIFRoZXNlIHNob3VsZFxuICAgIC8vIGJlIGlnbm9yZWQgdG8gYXZvaWQgYSBzaWduaWZpY2FudCB2ZWxvY2l0eSBkb3duZ3JhZGUuXG4gICAgaWYgKCghbGFzdCAmJiBkZWx0YVRpbWUgPiA0KSB8fCAobGFzdCAmJiBkZWx0YVRpbWUgPiAxNikpIHtcbiAgICAgIHRoaXMudmVsb2NpdHlYXyA9IGNhbGNWZWxvY2l0eSh0aGlzLmxhc3RYXyAtIHRoaXMucHJldlhfLCBkZWx0YVRpbWUsXG4gICAgICAgICAgdGhpcy52ZWxvY2l0eVhfKTtcbiAgICAgIHRoaXMudmVsb2NpdHlZXyA9IGNhbGNWZWxvY2l0eSh0aGlzLmxhc3RZXyAtIHRoaXMucHJldllfLCBkZWx0YVRpbWUsXG4gICAgICAgICAgdGhpcy52ZWxvY2l0eVlfKTtcbiAgICAgIHRoaXMudmVsb2NpdHlYXyA9IE1hdGguYWJzKHRoaXMudmVsb2NpdHlYXykgPiAxZS00ID8gdGhpcy52ZWxvY2l0eVhfIDogMDtcbiAgICAgIHRoaXMudmVsb2NpdHlZXyA9IE1hdGguYWJzKHRoaXMudmVsb2NpdHlZXykgPiAxZS00ID8gdGhpcy52ZWxvY2l0eVlfIDogMDtcbiAgICAgIHRoaXMucHJldlhfID0gdGhpcy5sYXN0WF87XG4gICAgICB0aGlzLnByZXZZXyA9IHRoaXMubGFzdFlfO1xuICAgICAgdGhpcy5wcmV2VGltZV8gPSB0aGlzLmxhc3RUaW1lXztcbiAgICB9XG5cbiAgICB0aGlzLnNpZ25hbEVtaXQoe1xuICAgICAgZmlyc3QsXG4gICAgICBsYXN0LFxuICAgICAgdGltZTogdGhpcy5sYXN0VGltZV8sXG4gICAgICBkZWx0YVg6IHRoaXMuaG9yaXpfID8gdGhpcy5sYXN0WF8gLSB0aGlzLnN0YXJ0WF8gOiAwLFxuICAgICAgZGVsdGFZOiB0aGlzLnZlcnRfID8gdGhpcy5sYXN0WV8gLSB0aGlzLnN0YXJ0WV8gOiAwLFxuICAgICAgc3RhcnRYOiB0aGlzLnN0YXJ0WF8sXG4gICAgICBzdGFydFk6IHRoaXMuc3RhcnRZXyxcbiAgICAgIGxhc3RYOiB0aGlzLmxhc3RYXyxcbiAgICAgIGxhc3RZOiB0aGlzLmxhc3RZXyxcbiAgICAgIHZlbG9jaXR5WDogdGhpcy5ob3Jpel8gPyB0aGlzLnZlbG9jaXR5WF8gOiAwLFxuICAgICAgdmVsb2NpdHlZOiB0aGlzLnZlcnRfID8gdGhpcy52ZWxvY2l0eVlfIDogMCxcbiAgICB9LCBldmVudCk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHs/RXZlbnR9IGV2ZW50XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBlbmRfKGV2ZW50KSB7XG4gICAgaWYgKHRoaXMuZXZlbnRpbmdfKSB7XG4gICAgICB0aGlzLmV2ZW50aW5nXyA9IGZhbHNlO1xuICAgICAgdGhpcy5lbWl0XyhmYWxzZSwgdHJ1ZSwgZXZlbnQpO1xuICAgICAgdGhpcy5zaWduYWxFbmQoKTtcbiAgICB9XG4gIH1cbn1cblxuXG4vKipcbiAqIFJlY29nbml6ZXMgXCJzd2lwZS14eVwiIGdlc3R1cmUuIFlpZWxkcyBhYm91dCAxMG1zIHRvIG90aGVyIGdlc3R1cmVzLlxuICovXG5leHBvcnQgY2xhc3MgU3dpcGVYWVJlY29nbml6ZXIgZXh0ZW5kcyBTd2lwZVJlY29nbml6ZXIge1xuICAvKipcbiAgICogQHBhcmFtIHshLi9nZXN0dXJlLkdlc3R1cmVzfSBtYW5hZ2VyXG4gICAqL1xuICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7XG4gICAgc3VwZXIoJ3N3aXBlLXh5JywgbWFuYWdlciwgdHJ1ZSwgdHJ1ZSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFJlY29nbml6ZXMgXCJzd2lwZS14XCIgZ2VzdHVyZS4gWWllbGRzIGFib3V0IDEwbXMgdG8gb3RoZXIgZ2VzdHVyZXMuXG4gKi9cbmV4cG9ydCBjbGFzcyBTd2lwZVhSZWNvZ25pemVyIGV4dGVuZHMgU3dpcGVSZWNvZ25pemVyIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4vZ2VzdHVyZS5HZXN0dXJlc30gbWFuYWdlclxuICAgKi9cbiAgY29uc3RydWN0b3IobWFuYWdlcikge1xuICAgIHN1cGVyKCdzd2lwZS14JywgbWFuYWdlciwgdHJ1ZSwgZmFsc2UpO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZWNvZ25pemVzIFwic3dpcGUteVwiIGdlc3R1cmUuIFlpZWxkcyBhYm91dCAxMG1zIHRvIG90aGVyIGdlc3R1cmVzLlxuICovXG5leHBvcnQgY2xhc3MgU3dpcGVZUmVjb2duaXplciBleHRlbmRzIFN3aXBlUmVjb2duaXplciB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyEuL2dlc3R1cmUuR2VzdHVyZXN9IG1hbmFnZXJcbiAgICovXG4gIGNvbnN0cnVjdG9yKG1hbmFnZXIpIHtcbiAgICBzdXBlcignc3dpcGUteScsIG1hbmFnZXIsIGZhbHNlLCB0cnVlKTtcbiAgfVxufVxuXG5cblxuLyoqXG4gKiBBIFwidGFwem9vbVwiIGdlc3R1cmUuIEl0IGhhcyBhIGNlbnRlciwgZGVsdGEgb2ZmIHRoZSBjZW50ZXIgY2VudGVyIGFuZFxuICogdGhlIHZlbG9jaXR5IG9mIG1vdmluZyBhd2F5IGZyb20gdGhlIGNlbnRlci5cbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGZpcnN0OiBib29sZWFuLFxuICogICBsYXN0OiBib29sZWFuLFxuICogICBjZW50ZXJDbGllbnRYOiBudW1iZXIsXG4gKiAgIGNlbnRlckNsaWVudFk6IG51bWJlcixcbiAqICAgZGVsdGFYOiBudW1iZXIsXG4gKiAgIGRlbHRhWTogbnVtYmVyLFxuICogICB2ZWxvY2l0eVg6IG51bWJlcixcbiAqICAgdmVsb2NpdHlZOiBudW1iZXJcbiAqIH19XG4gKi9cbmxldCBUYXB6b29tRGVmO1xuXG5cbi8qKlxuICogUmVjb2duaXplcyBhIFwidGFwem9vbVwiIGdlc3R1cmUuIFRoaXMgZ2VzdHVyZSB3aWxsIGJsb2NrIG90aGVyIGdlc3R1cmVzXG4gKiBmb3IgYWJvdXQgNDAwbXMgYWZ0ZXIgZmlyc3QgXCJ0YXBcIiB3aGlsZSBpdCdzIGV4cGVjdGluZyBzd2lwZS5cbiAqIEBleHRlbmRzIHtHZXN0dXJlUmVjb2duaXplcjxUYXB6b29tRGVmPn1cbiAqL1xuZXhwb3J0IGNsYXNzIFRhcHpvb21SZWNvZ25pemVyIGV4dGVuZHMgR2VzdHVyZVJlY29nbml6ZXIge1xuICAvKipcbiAgICogQHBhcmFtIHshLi9nZXN0dXJlLkdlc3R1cmVzfSBtYW5hZ2VyXG4gICAqL1xuICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7XG4gICAgc3VwZXIoJ3RhcHpvb20nLCBtYW5hZ2VyKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7Ym9vbGVhbn0gKi9cbiAgICB0aGlzLmV2ZW50aW5nXyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5zdGFydFhfID0gMDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMuc3RhcnRZXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLmxhc3RYXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLmxhc3RZXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnRhcENvdW50XyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnByZXZYXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnByZXZZXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge3RpbWV9ICovXG4gICAgdGhpcy5sYXN0VGltZV8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHt0aW1lfSAqL1xuICAgIHRoaXMucHJldlRpbWVfID0gMDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMudmVsb2NpdHlYXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnZlbG9jaXR5WV8gPSAwO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBvblRvdWNoU3RhcnQoZSkge1xuICAgIGlmICh0aGlzLmV2ZW50aW5nXykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCB7dG91Y2hlc30gPSBlO1xuICAgIGlmICh0b3VjaGVzICYmIHRvdWNoZXMubGVuZ3RoID09IDEpIHtcbiAgICAgIHRoaXMuc3RhcnRYXyA9IHRvdWNoZXNbMF0uY2xpZW50WDtcbiAgICAgIHRoaXMuc3RhcnRZXyA9IHRvdWNoZXNbMF0uY2xpZW50WTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBvblRvdWNoTW92ZShlKSB7XG4gICAgY29uc3Qge3RvdWNoZXN9ID0gZTtcbiAgICBpZiAodG91Y2hlcyAmJiB0b3VjaGVzLmxlbmd0aCA9PSAxKSB7XG4gICAgICB0aGlzLmxhc3RYXyA9IHRvdWNoZXNbMF0uY2xpZW50WDtcbiAgICAgIHRoaXMubGFzdFlfID0gdG91Y2hlc1swXS5jbGllbnRZO1xuICAgICAgaWYgKHRoaXMuZXZlbnRpbmdfKSB7XG4gICAgICAgIHRoaXMuZW1pdF8oZmFsc2UsIGZhbHNlLCBlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGR4ID0gTWF0aC5hYnModGhpcy5sYXN0WF8gLSB0aGlzLnN0YXJ0WF8pID49IDg7XG4gICAgICAgIGNvbnN0IGR5ID0gTWF0aC5hYnModGhpcy5sYXN0WV8gLSB0aGlzLnN0YXJ0WV8pID49IDg7XG4gICAgICAgIGlmIChkeCB8fCBkeSkge1xuICAgICAgICAgIGlmICh0aGlzLnRhcENvdW50XyA9PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmFjY2VwdENhbmNlbCgpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNpZ25hbFJlYWR5KDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIG9uVG91Y2hFbmQoZSkge1xuICAgIGlmICh0aGlzLmV2ZW50aW5nXykge1xuICAgICAgdGhpcy5lbmRfKGUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudGFwQ291bnRfKys7XG4gICAgaWYgKHRoaXMudGFwQ291bnRfID09IDEpIHtcbiAgICAgIHRoaXMuc2lnbmFsUGVuZGluZyg0MDApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuYWNjZXB0Q2FuY2VsKCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGFjY2VwdFN0YXJ0KCkge1xuICAgIHRoaXMudGFwQ291bnRfID0gMDtcbiAgICB0aGlzLmV2ZW50aW5nXyA9IHRydWU7XG4gICAgdGhpcy5lbWl0Xyh0cnVlLCBmYWxzZSwgbnVsbCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGFjY2VwdENhbmNlbCgpIHtcbiAgICB0aGlzLnRhcENvdW50XyA9IDA7XG4gICAgdGhpcy5ldmVudGluZ18gPSBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGZpcnN0XG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gbGFzdFxuICAgKiBAcGFyYW0gez9FdmVudH0gZXZlbnRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGVtaXRfKGZpcnN0LCBsYXN0LCBldmVudCkge1xuICAgIHRoaXMubGFzdFRpbWVfID0gRGF0ZS5ub3coKTtcbiAgICBpZiAoZmlyc3QpIHtcbiAgICAgIHRoaXMudmVsb2NpdHlYXyA9IHRoaXMudmVsb2NpdHlZXyA9IDA7XG4gICAgfSBlbHNlIGlmICh0aGlzLmxhc3RUaW1lXyAtIHRoaXMucHJldlRpbWVfID4gMikge1xuICAgICAgdGhpcy52ZWxvY2l0eVhfID0gY2FsY1ZlbG9jaXR5KHRoaXMubGFzdFhfIC0gdGhpcy5wcmV2WF8sXG4gICAgICAgICAgdGhpcy5sYXN0VGltZV8gLSB0aGlzLnByZXZUaW1lXywgdGhpcy52ZWxvY2l0eVhfKTtcbiAgICAgIHRoaXMudmVsb2NpdHlZXyA9IGNhbGNWZWxvY2l0eSh0aGlzLmxhc3RZXyAtIHRoaXMucHJldllfLFxuICAgICAgICAgIHRoaXMubGFzdFRpbWVfIC0gdGhpcy5wcmV2VGltZV8sIHRoaXMudmVsb2NpdHlZXyk7XG4gICAgfVxuICAgIHRoaXMucHJldlhfID0gdGhpcy5sYXN0WF87XG4gICAgdGhpcy5wcmV2WV8gPSB0aGlzLmxhc3RZXztcbiAgICB0aGlzLnByZXZUaW1lXyA9IHRoaXMubGFzdFRpbWVfO1xuXG4gICAgdGhpcy5zaWduYWxFbWl0KHtcbiAgICAgIGZpcnN0LFxuICAgICAgbGFzdCxcbiAgICAgIGNlbnRlckNsaWVudFg6IHRoaXMuc3RhcnRYXyxcbiAgICAgIGNlbnRlckNsaWVudFk6IHRoaXMuc3RhcnRZXyxcbiAgICAgIGRlbHRhWDogdGhpcy5sYXN0WF8gLSB0aGlzLnN0YXJ0WF8sXG4gICAgICBkZWx0YVk6IHRoaXMubGFzdFlfIC0gdGhpcy5zdGFydFlfLFxuICAgICAgdmVsb2NpdHlYOiB0aGlzLnZlbG9jaXR5WF8sXG4gICAgICB2ZWxvY2l0eVk6IHRoaXMudmVsb2NpdHlZXyxcbiAgICB9LCBldmVudCk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHs/RXZlbnR9IGV2ZW50XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBlbmRfKGV2ZW50KSB7XG4gICAgaWYgKHRoaXMuZXZlbnRpbmdfKSB7XG4gICAgICB0aGlzLmV2ZW50aW5nXyA9IGZhbHNlO1xuICAgICAgdGhpcy5lbWl0XyhmYWxzZSwgdHJ1ZSwgZXZlbnQpO1xuICAgICAgdGhpcy5zaWduYWxFbmQoKTtcbiAgICB9XG4gIH1cbn1cblxuXG5cbi8qKlxuICogQSBcInBpbmNoXCIgZ2VzdHVyZS4gSXQgaGFzIGEgY2VudGVyLCBkZWx0YSBvZmYgdGhlIGNlbnRlciBjZW50ZXIgYW5kXG4gKiB0aGUgdmVsb2NpdHkgb2YgbW92aW5nIGF3YXkgZnJvbSB0aGUgY2VudGVyLiBcImRpclwiIGNvbXBvbmVudCBvZiBgMWBcbiAqIGluZGljYXRlcyB0aGF0IGl0J3MgYSBleHBhbmQgbW90aW9uIGFuZCBgLTFgIGluZGljYXRlcyBwaW5jaCBtb3Rpb24uXG4gKiBAdHlwZWRlZiB7e1xuICogICBmaXJzdDogYm9vbGVhbixcbiAqICAgbGFzdDogYm9vbGVhbixcbiAqICAgY2VudGVyQ2xpZW50WDogbnVtYmVyLFxuICogICBjZW50ZXJDbGllbnRZOiBudW1iZXIsXG4gKiAgIGRpcjogbnVtYmVyLFxuICogICBkZWx0YVg6IG51bWJlcixcbiAqICAgZGVsdGFZOiBudW1iZXIsXG4gKiAgIHZlbG9jaXR5WDogbnVtYmVyLFxuICogICB2ZWxvY2l0eVk6IG51bWJlclxuICogfX1cbiAqL1xubGV0IFBpbmNoRGVmO1xuXG4vKipcbiAqIFRocmVzaG9sZCBpbiBwaXhlbHMgZm9yIGhvdyBtdWNoIHR3byB0b3VjaGVzIG1vdmUgYXdheSBmcm9tXG4gKiBlYWNoIG90aGVyIGJlZm9yZSB3ZSByZWNvZ25pemUgdGhlIGdlc3R1cmUgYXMgYSBwaW5jaC5cbiAqL1xuY29uc3QgUElOQ0hfQUNDRVBUX1RIUkVTSE9MRCA9IDQ7XG5cbi8qKlxuICogVGhyZXNob2xkIGluIHBpeGVscyBmb3IgaG93IG11Y2ggdHdvIHRvdWNoZXMgbW92ZSBpbiB0aGUgc2FtZVxuICogZGlyZWN0aW9uIGJlZm9yZSB3ZSByZWplY3QgdGhlIGdlc3R1cmUgYXMgYSBwaW5jaC5cbiAqL1xuY29uc3QgUElOQ0hfUkVKRUNUX1RIUkVTSE9MRCA9IDEwO1xuXG4vKipcbiAqIFJlY29nbml6ZXMgYSBcInBpbmNoXCIgZ2VzdHVyZS5cbiAqIEBleHRlbmRzIHtHZXN0dXJlUmVjb2duaXplcjxQaW5jaERlZj59XG4gKi9cbmV4cG9ydCBjbGFzcyBQaW5jaFJlY29nbml6ZXIgZXh0ZW5kcyBHZXN0dXJlUmVjb2duaXplciB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyEuL2dlc3R1cmUuR2VzdHVyZXN9IG1hbmFnZXJcbiAgICovXG4gIGNvbnN0cnVjdG9yKG1hbmFnZXIpIHtcbiAgICBzdXBlcigncGluY2gnLCBtYW5hZ2VyKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7Ym9vbGVhbn0gKi9cbiAgICB0aGlzLmV2ZW50aW5nXyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5zdGFydFgxXyA9IDA7XG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5zdGFydFkxXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnN0YXJ0WDJfID0gMDtcbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnN0YXJ0WTJfID0gMDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMubGFzdFgxXyA9IDA7XG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5sYXN0WTFfID0gMDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMubGFzdFgyXyA9IDA7XG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5sYXN0WTJfID0gMDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMucHJldkRlbHRhWF8gPSAwO1xuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMucHJldkRlbHRhWV8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5jZW50ZXJDbGllbnRYXyA9IDA7XG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5jZW50ZXJDbGllbnRZXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge3RpbWV9ICovXG4gICAgdGhpcy5zdGFydFRpbWVfID0gMDtcbiAgICAvKiogQHByaXZhdGUge3RpbWV9ICovXG4gICAgdGhpcy5sYXN0VGltZV8gPSAwO1xuICAgIC8qKiBAcHJpdmF0ZSB7dGltZX0gKi9cbiAgICB0aGlzLnByZXZUaW1lXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnZlbG9jaXR5WF8gPSAwO1xuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMudmVsb2NpdHlZXyA9IDA7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIG9uVG91Y2hTdGFydChlKSB7XG4gICAgY29uc3Qge3RvdWNoZXN9ID0gZTtcbiAgICAvLyBQaW5jaCB0b3VjaGVzIGFyZSBub3QgYWx3YXlzIHNpbXVsdGFuZW91cywgY29udGludWUgdG8gbGlzdGVuXG4gICAgLy8gZm9yIHNlY29uZCB0b3VjaC5cbiAgICBpZiAodG91Y2hlcyAmJiB0b3VjaGVzLmxlbmd0aCA9PSAxKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKHRvdWNoZXMgJiYgdG91Y2hlcy5sZW5ndGggPT0gMikge1xuICAgICAgdGhpcy5zdGFydFRpbWVfID0gRGF0ZS5ub3coKTtcbiAgICAgIHRoaXMuc3RhcnRYMV8gPSB0b3VjaGVzWzBdLmNsaWVudFg7XG4gICAgICB0aGlzLnN0YXJ0WTFfID0gdG91Y2hlc1swXS5jbGllbnRZO1xuICAgICAgdGhpcy5zdGFydFgyXyA9IHRvdWNoZXNbMV0uY2xpZW50WDtcbiAgICAgIHRoaXMuc3RhcnRZMl8gPSB0b3VjaGVzWzFdLmNsaWVudFk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgb25Ub3VjaE1vdmUoZSkge1xuICAgIGNvbnN0IHt0b3VjaGVzfSA9IGU7XG4gICAgLy8gUGluY2ggdG91Y2hlcyBhcmUgbm90IGFsd2F5cyBzaW11bHRhbmVvdXMsIGNvbnRpbnVlIHRvIGxpc3RlblxuICAgIC8vIGZvciBzZWNvbmQgdG91Y2guXG4gICAgaWYgKHRvdWNoZXMgJiYgdG91Y2hlcy5sZW5ndGggPT0gMSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIGlmICh0b3VjaGVzICYmIHRvdWNoZXMubGVuZ3RoID09IDIpIHtcbiAgICAgIHRoaXMubGFzdFgxXyA9IHRvdWNoZXNbMF0uY2xpZW50WDtcbiAgICAgIHRoaXMubGFzdFkxXyA9IHRvdWNoZXNbMF0uY2xpZW50WTtcbiAgICAgIHRoaXMubGFzdFgyXyA9IHRvdWNoZXNbMV0uY2xpZW50WDtcbiAgICAgIHRoaXMubGFzdFkyXyA9IHRvdWNoZXNbMV0uY2xpZW50WTtcbiAgICAgIGlmICh0aGlzLmV2ZW50aW5nXykge1xuICAgICAgICB0aGlzLmVtaXRfKGZhbHNlLCBmYWxzZSwgZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBkeDEgPSB0aGlzLmxhc3RYMV8gLSB0aGlzLnN0YXJ0WDFfO1xuICAgICAgICBjb25zdCBkeTEgPSB0aGlzLmxhc3RZMV8gLSB0aGlzLnN0YXJ0WTFfO1xuICAgICAgICBjb25zdCBkeDIgPSB0aGlzLmxhc3RYMl8gLSB0aGlzLnN0YXJ0WDJfO1xuICAgICAgICBjb25zdCBkeTIgPSB0aGlzLmxhc3RZMl8gLSB0aGlzLnN0YXJ0WTJfO1xuICAgICAgICAvLyBGaW5nZXJzIHNob3VsZCBtb3ZlIGluIG9wcG9zaXRlIGRpcmVjdGlvbnMgYW5kIGdvIG92ZXIgdGhlIHRocmVzaG9sZC5cbiAgICAgICAgaWYgKGR4MSAqIGR4MiA8PSAwICYmIGR5MSAqIGR5MiA8PSAwKSB7XG4gICAgICAgICAgaWYgKE1hdGguYWJzKGR4MSAtIGR4MikgPj0gUElOQ0hfQUNDRVBUX1RIUkVTSE9MRFxuICAgICAgICAgICAgfHwgTWF0aC5hYnMoZHkxIC0gZHkyKSA+PSBQSU5DSF9BQ0NFUFRfVEhSRVNIT0xEKSB7XG4gICAgICAgICAgICB0aGlzLnNpZ25hbFJlYWR5KDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChNYXRoLmFicyhkeDEgKyBkeDIpID49IFBJTkNIX1JFSkVDVF9USFJFU0hPTERcbiAgICAgICAgICB8fCBNYXRoLmFicyhkeTEgKyBkeTIpID49IFBJTkNIX1JFSkVDVF9USFJFU0hPTEQpIHtcbiAgICAgICAgICAvLyBNb3ZpbmcgaW4gdGhlIHNhbWUgZGlyZWN0aW9uIG92ZXIgYSB0aHJlc2hvbGQuXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgb25Ub3VjaEVuZChlKSB7XG4gICAgdGhpcy5lbmRfKGUpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBhY2NlcHRTdGFydCgpIHtcbiAgICB0aGlzLmV2ZW50aW5nXyA9IHRydWU7XG4gICAgdGhpcy5wcmV2VGltZV8gPSB0aGlzLnN0YXJ0VGltZV87XG4gICAgdGhpcy5wcmV2RGVsdGFYXyA9IDA7XG4gICAgdGhpcy5wcmV2RGVsdGFZXyA9IDA7XG4gICAgdGhpcy5jZW50ZXJDbGllbnRYXyA9ICh0aGlzLnN0YXJ0WDFfICsgdGhpcy5zdGFydFgyXykgKiAwLjU7XG4gICAgdGhpcy5jZW50ZXJDbGllbnRZXyA9ICh0aGlzLnN0YXJ0WTFfICsgdGhpcy5zdGFydFkyXykgKiAwLjU7XG4gICAgdGhpcy5lbWl0Xyh0cnVlLCBmYWxzZSwgbnVsbCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGFjY2VwdENhbmNlbCgpIHtcbiAgICB0aGlzLmV2ZW50aW5nXyA9IGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gZmlyc3RcbiAgICogQHBhcmFtIHtib29sZWFufSBsYXN0XG4gICAqIEBwYXJhbSB7P0V2ZW50fSBldmVudFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZW1pdF8oZmlyc3QsIGxhc3QsIGV2ZW50KSB7XG4gICAgdGhpcy5sYXN0VGltZV8gPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGRlbHRhVGltZSA9IHRoaXMubGFzdFRpbWVfIC0gdGhpcy5wcmV2VGltZV87XG4gICAgY29uc3QgZGVsdGFYID0gdGhpcy5kZWx0YVhfKCk7XG4gICAgY29uc3QgZGVsdGFZID0gdGhpcy5kZWx0YVlfKCk7XG4gICAgLy8gSXQncyBvZnRlbiB0aGF0IGB0b3VjaGVuZGAgYXJyaXZlcyBvbiB0aGUgbmV4dCBmcmFtZS4gVGhlc2Ugc2hvdWxkXG4gICAgLy8gYmUgaWdub3JlZCB0byBhdm9pZCBhIHNpZ25pZmljYW50IHZlbG9jaXR5IGRvd25ncmFkZS5cbiAgICBpZiAoKCFsYXN0ICYmIGRlbHRhVGltZSA+IDQpIHx8IChsYXN0ICYmIGRlbHRhVGltZSA+IDE2KSkge1xuICAgICAgdGhpcy52ZWxvY2l0eVhfID0gY2FsY1ZlbG9jaXR5KGRlbHRhWCAtIHRoaXMucHJldkRlbHRhWF8sIGRlbHRhVGltZSxcbiAgICAgICAgICB0aGlzLnZlbG9jaXR5WF8pO1xuICAgICAgdGhpcy52ZWxvY2l0eVlfID0gY2FsY1ZlbG9jaXR5KGRlbHRhWSAtIHRoaXMucHJldkRlbHRhWV8sIGRlbHRhVGltZSxcbiAgICAgICAgICB0aGlzLnZlbG9jaXR5WV8pO1xuICAgICAgdGhpcy52ZWxvY2l0eVhfID0gTWF0aC5hYnModGhpcy52ZWxvY2l0eVhfKSA+IDFlLTQgPyB0aGlzLnZlbG9jaXR5WF8gOiAwO1xuICAgICAgdGhpcy52ZWxvY2l0eVlfID0gTWF0aC5hYnModGhpcy52ZWxvY2l0eVlfKSA+IDFlLTQgPyB0aGlzLnZlbG9jaXR5WV8gOiAwO1xuICAgICAgdGhpcy5wcmV2RGVsdGFYXyA9IGRlbHRhWDtcbiAgICAgIHRoaXMucHJldkRlbHRhWV8gPSBkZWx0YVk7XG4gICAgICB0aGlzLnByZXZUaW1lXyA9IHRoaXMubGFzdFRpbWVfO1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXJ0U3EgPSB0aGlzLnNxRGlzdF8odGhpcy5zdGFydFgxXywgdGhpcy5zdGFydFgyXyxcbiAgICAgICAgdGhpcy5zdGFydFkxXywgdGhpcy5zdGFydFkyXyk7XG4gICAgY29uc3QgbGFzdFNxID0gdGhpcy5zcURpc3RfKHRoaXMubGFzdFgxXywgdGhpcy5sYXN0WDJfLFxuICAgICAgICB0aGlzLmxhc3RZMV8sIHRoaXMubGFzdFkyXyk7XG4gICAgdGhpcy5zaWduYWxFbWl0KHtcbiAgICAgIGZpcnN0LFxuICAgICAgbGFzdCxcbiAgICAgIHRpbWU6IHRoaXMubGFzdFRpbWVfLFxuICAgICAgY2VudGVyQ2xpZW50WDogdGhpcy5jZW50ZXJDbGllbnRYXyxcbiAgICAgIGNlbnRlckNsaWVudFk6IHRoaXMuY2VudGVyQ2xpZW50WV8sXG4gICAgICBkaXI6IE1hdGguc2lnbihsYXN0U3EgLSBzdGFydFNxKSxcbiAgICAgIGRlbHRhWDogZGVsdGFYICogMC41LFxuICAgICAgZGVsdGFZOiBkZWx0YVkgKiAwLjUsXG4gICAgICB2ZWxvY2l0eVg6IHRoaXMudmVsb2NpdHlYXyAqIDAuNSxcbiAgICAgIHZlbG9jaXR5WTogdGhpcy52ZWxvY2l0eVlfICogMC41LFxuICAgIH0sIGV2ZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gez9FdmVudH0gZXZlbnRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGVuZF8oZXZlbnQpIHtcbiAgICBpZiAodGhpcy5ldmVudGluZ18pIHtcbiAgICAgIHRoaXMuZXZlbnRpbmdfID0gZmFsc2U7XG4gICAgICB0aGlzLmVtaXRfKGZhbHNlLCB0cnVlLCBldmVudCk7XG4gICAgICB0aGlzLnNpZ25hbEVuZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0geDFcbiAgICogQHBhcmFtIHtudW1iZXJ9IHgyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5MVxuICAgKiBAcGFyYW0ge251bWJlcn0geTJcbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc3FEaXN0Xyh4MSwgeDIsIHkxLCB5Mikge1xuICAgIHJldHVybiAoeDEgLSB4MikgKiAoeDEgLSB4MikgKyAoeTEgLSB5MikgKiAoeTEgLSB5Mik7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZGVsdGFYXygpIHtcbiAgICByZXR1cm4gTWF0aC5hYnMoKHRoaXMubGFzdFgxXyAtIHRoaXMuc3RhcnRYMV8pIC1cbiAgICAgICAgKHRoaXMubGFzdFgyXyAtIHRoaXMuc3RhcnRYMl8pKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBkZWx0YVlfKCkge1xuICAgIHJldHVybiBNYXRoLmFicygodGhpcy5sYXN0WTFfIC0gdGhpcy5zdGFydFkxXykgLVxuICAgICAgICAodGhpcy5sYXN0WTJfIC0gdGhpcy5zdGFydFkyXykpO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtPYnNlcnZhYmxlfSBmcm9tICcuL29ic2VydmFibGUnO1xuaW1wb3J0IHtQYXNzfSBmcm9tICcuL3Bhc3MnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7ZmluZEluZGV4fSBmcm9tICcuL3V0aWxzL2FycmF5JztcbmltcG9ydCB7dG9XaW59IGZyb20gJy4vdHlwZXMnO1xuXG5cbmNvbnN0IFBST1BfID0gJ19fQU1QX0dlc3R1cmVzJztcblxuXG4vKipcbiAqIEEgZ2VzdHVyZSBvYmplY3QgY29udGFpbnMgdGhlIHR5cGUgYW5kIGRhdGEgb2YgdGhlIGdlc3R1cmUgc3VjaCBhc1xuICogYSB0YXAgb3IgYSBkb3VibGUtdGFwIG9yIGEgc3dpcGUuIFNlZSB7QGxpbmsgR2VzdHVyZVJlY29nbml6ZXJ9IGZvclxuICogbW9yZSBkZXRhaWxzLlxuICogQHN0cnVjdFxuICogQGNvbnN0XG4gKiBAdGVtcGxhdGUgREFUQVxuICovXG5leHBvcnQgY2xhc3MgR2VzdHVyZSB7XG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBUaGUgZ2VzdHVyZSdzIHN0cmluZyB0eXBlLlxuICAgKiBAcGFyYW0ge0RBVEF9IGRhdGEgVGhlIGRhdGEgb2YgdGhlIGdlc3R1cmUuXG4gICAqIEBwYXJhbSB7dGltZX0gdGltZSBUaGUgdGltZSB0aGF0IHRoZSBnZXN0dXJlIGhhcyBiZWVuIGVtaXR0ZWQuXG4gICAqIEBwYXJhbSB7P0V2ZW50fSBldmVudCBBbiBvcHRpb25hbCBicm93c2VyIGV2ZW50IHRoYXQgcmVzdWx0ZWQgaW4gdGhlXG4gICAqICAgZ2VzdHVyZS5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHR5cGUsIGRhdGEsIHRpbWUsIGV2ZW50KSB7XG4gICAgLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgLyoqIEBjb25zdCB7REFUQX0gKi9cbiAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgIC8qKiBAY29uc3Qge3RpbWV9ICovXG4gICAgdGhpcy50aW1lID0gdGltZTtcbiAgICAvKiogQGNvbnN0IHs/RXZlbnR9ICovXG4gICAgdGhpcy5ldmVudCA9IGV2ZW50O1xuICB9XG59XG5cblxuLyoqXG4gKiBHZXN0dXJlcyBvYmplY3QgbWFuYWdlcyBhbGwgZ2VzdHVyZXMgb24gYSBwYXJ0aWN1bGFyIGVsZW1lbnQuIEl0IGxpc3RlbnNcbiAqIHRvIGFsbCBwb2ludGVyIGV2ZW50cyBhbmQgZGVsZWdhdGVzIHRoZW0gdG8gaW5kaXZpZHVhbCBnZXN0dXJlIHJlY29nbml6ZXJzLlxuICogV2hlbiBhIHJlY29nbml6ZXIgaGFzIHJlY29nbml6ZWQgYSBnZXN0dXJlIGFuZCByZWFkeSB0byBzdGFydCBlbWl0dGluZyBpdFxuICogaXQgcmVxdWVzdHMgcGVybWlzc2lvbiB0byBkbyBzbyBmcm9tIHRoaXMgY2xhc3Mgd2hpY2ggcmVzb2x2ZXMgY29uZmxpY3RzXG4gKiBiZXR3ZWVuIGNvbXBldGluZyByZWNvZ25pemVycyB0byBkZWNpZGUgd2hpY2ggZ2VzdHVyZSBzaG91bGQgZ28gZm9yd2FyZC5cbiAqL1xuZXhwb3J0IGNsYXNzIEdlc3R1cmVzIHtcblxuICAvKipcbiAgICogQ3JlYXRlcyBpZiBub3QgeWV0IGNyZWF0ZWQgYW5kIHJldHVybnMgdGhlIHNoYXJlZCBHZXN0dXJlcyBpbnN0YW5jZSBmb3JcbiAgICogdGhlIHNwZWNpZmllZCBlbGVtZW50LlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9zaG91bGROb3RQcmV2ZW50RGVmYXVsdFxuICAgKiBAcmV0dXJuIHshR2VzdHVyZXN9XG4gICAqL1xuICBzdGF0aWMgZ2V0KGVsZW1lbnQsIG9wdF9zaG91bGROb3RQcmV2ZW50RGVmYXVsdCA9IGZhbHNlKSB7XG4gICAgbGV0IHJlcyA9IGVsZW1lbnRbUFJPUF9dO1xuICAgIGlmICghcmVzKSB7XG4gICAgICByZXMgPSBuZXcgR2VzdHVyZXMoZWxlbWVudCwgb3B0X3Nob3VsZE5vdFByZXZlbnREZWZhdWx0KTtcbiAgICAgIGVsZW1lbnRbUFJPUF9dID0gcmVzO1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAgICogQHBhcmFtIHtib29sZWFufSBzaG91bGROb3RQcmV2ZW50RGVmYXVsdFxuICAgKi9cbiAgY29uc3RydWN0b3IoZWxlbWVudCwgc2hvdWxkTm90UHJldmVudERlZmF1bHQpIHtcbiAgICAvKiogQHByaXZhdGUgeyFFbGVtZW50fSAqL1xuICAgIHRoaXMuZWxlbWVudF8gPSBlbGVtZW50O1xuXG4gICAgLyoqIEBwcml2YXRlIHshQXJyYXk8IUdlc3R1cmVSZWNvZ25pemVyPn0gKi9cbiAgICB0aGlzLnJlY29nbml6ZXJzXyA9IFtdO1xuXG4gICAgLyoqIEBwcml2YXRlIHshQXJyYXk8Ym9vbGVhbj59ICovXG4gICAgdGhpcy50cmFja2luZ18gPSBbXTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IUFycmF5PHRpbWU+fSAqL1xuICAgIHRoaXMucmVhZHlfID0gW107XG5cbiAgICAvKiogQHByaXZhdGUgeyFBcnJheTx0aW1lPn0gKi9cbiAgICB0aGlzLnBlbmRpbmdfID0gW107XG5cbiAgICAvKiogQHByaXZhdGUgez9HZXN0dXJlUmVjb2duaXplcn0gKi9cbiAgICB0aGlzLmV2ZW50aW5nXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy5zaG91bGROb3RQcmV2ZW50RGVmYXVsdF8gPSBzaG91bGROb3RQcmV2ZW50RGVmYXVsdDtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgdmFyaWFibGUgaW5kaWNhdGVzIHRoYXQgdGhlIGV2ZW50aW5nIGhhcyBzdG9wcGVkIG9uIHRoaXNcbiAgICAgKiBldmVudCBjeWNsZS5cbiAgICAgKiBAcHJpdmF0ZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB0aGlzLndhc0V2ZW50aW5nXyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcml2YXRlIHshUGFzc30gKi9cbiAgICB0aGlzLnBhc3NfID0gbmV3IFBhc3ModG9XaW4oZWxlbWVudC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3KSxcbiAgICAgICAgdGhpcy5kb1Bhc3NfLmJpbmQodGhpcykpO1xuXG4gICAgLyoqIEBwcml2YXRlIHshT2JzZXJ2YWJsZX0gKi9cbiAgICB0aGlzLnBvaW50ZXJEb3duT2JzZXJ2YWJsZV8gPSBuZXcgT2JzZXJ2YWJsZSgpO1xuXG4gICAgLyoqXG4gICAgICogT2JzZXJ2ZXJzIGZvciBlYWNoIHR5cGUgb2YgcmVnaXN0ZXJlZCBnZXN0dXJlIHR5cGVzLlxuICAgICAqIEBwcml2YXRlIHshT2JqZWN0PHN0cmluZywgIU9ic2VydmFibGU8IUdlc3R1cmU+Pn1cbiAgICAgKi9cbiAgICB0aGlzLm92ZXJzZXJ2ZXJzXyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtmdW5jdGlvbighRXZlbnQpfSAqL1xuICAgIHRoaXMuYm91bmRPblRvdWNoU3RhcnRfID0gdGhpcy5vblRvdWNoU3RhcnRfLmJpbmQodGhpcyk7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7ZnVuY3Rpb24oIUV2ZW50KX0gKi9cbiAgICB0aGlzLmJvdW5kT25Ub3VjaEVuZF8gPSB0aGlzLm9uVG91Y2hFbmRfLmJpbmQodGhpcyk7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7ZnVuY3Rpb24oIUV2ZW50KX0gKi9cbiAgICB0aGlzLmJvdW5kT25Ub3VjaE1vdmVfID0gdGhpcy5vblRvdWNoTW92ZV8uYmluZCh0aGlzKTtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtmdW5jdGlvbighRXZlbnQpfSAqL1xuICAgIHRoaXMuYm91bmRPblRvdWNoQ2FuY2VsXyA9IHRoaXMub25Ub3VjaENhbmNlbF8uYmluZCh0aGlzKTtcblxuICAgIHRoaXMuZWxlbWVudF8uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMuYm91bmRPblRvdWNoU3RhcnRfKTtcbiAgICB0aGlzLmVsZW1lbnRfLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5ib3VuZE9uVG91Y2hFbmRfKTtcbiAgICB0aGlzLmVsZW1lbnRfLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMuYm91bmRPblRvdWNoTW92ZV8pO1xuICAgIHRoaXMuZWxlbWVudF8uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hjYW5jZWwnLCB0aGlzLmJvdW5kT25Ub3VjaENhbmNlbF8pO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMucGFzc0FmdGVyRXZlbnRfID0gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogVW5zdWJzY3JpYmVzIGZyb20gYWxsIHBvaW50ZXIgZXZlbnRzIGFuZCByZW1vdmVzIHRoZSBzaGFyZWQgY2FjaGUgaW5zdGFuY2UuXG4gICAqL1xuICBjbGVhbnVwKCkge1xuICAgIHRoaXMuZWxlbWVudF8ucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMuYm91bmRPblRvdWNoU3RhcnRfKTtcbiAgICB0aGlzLmVsZW1lbnRfLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5ib3VuZE9uVG91Y2hFbmRfKTtcbiAgICB0aGlzLmVsZW1lbnRfLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMuYm91bmRPblRvdWNoTW92ZV8pO1xuICAgIHRoaXMuZWxlbWVudF8ucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hjYW5jZWwnLCB0aGlzLmJvdW5kT25Ub3VjaENhbmNlbF8pO1xuICAgIGRlbGV0ZSB0aGlzLmVsZW1lbnRfW1BST1BfXTtcbiAgICB0aGlzLnBhc3NfLmNhbmNlbCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN1YnNjcmliZXMgdG8gYSBnZXN0dXJlIGVtaXR0ZWQgYnkgdGhlIHNwZWNpZmllZCByZWNvZ25pemVyLiBGb3IgYSBmaXJzdFxuICAgKiBnZXN0dXJlIGhhbmRsZXIgcmVnaXN0ZXJlZCBpbiB0aGlzIG1ldGhvZCB0aGUgcmVjb2duaXplciBpcyBpbnN0YWxsZWRcbiAgICogYW5kIGZyb20gdGhhdCBwb2ludCBvbiBpdCBwYXJ0aWNpcGF0ZXMgaW4gdGhlIGV2ZW50IHByb2Nlc3NpbmcuXG4gICAqXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24obmV3Okdlc3R1cmVSZWNvZ25pemVyPERBVEE+LCAhR2VzdHVyZXMpfSByZWNvZ25pemVyQ29uc3RyXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oIUdlc3R1cmU8REFUQT4pfSBoYW5kbGVyXG4gICAqIEByZXR1cm4geyFVbmxpc3RlbkRlZn1cbiAgICogQHRlbXBsYXRlIERBVEFcbiAgICovXG4gIG9uR2VzdHVyZShyZWNvZ25pemVyQ29uc3RyLCBoYW5kbGVyKSB7XG4gICAgY29uc3QgcmVjb2duaXplciA9IG5ldyByZWNvZ25pemVyQ29uc3RyKHRoaXMpO1xuICAgIGNvbnN0IHR5cGUgPSByZWNvZ25pemVyLmdldFR5cGUoKTtcbiAgICBsZXQgb3ZlcnNlcnZlciA9IHRoaXMub3ZlcnNlcnZlcnNfW3R5cGVdO1xuICAgIGlmICghb3ZlcnNlcnZlcikge1xuICAgICAgdGhpcy5yZWNvZ25pemVyc18ucHVzaChyZWNvZ25pemVyKTtcbiAgICAgIG92ZXJzZXJ2ZXIgPSBuZXcgT2JzZXJ2YWJsZSgpO1xuICAgICAgdGhpcy5vdmVyc2VydmVyc19bdHlwZV0gPSBvdmVyc2VydmVyO1xuICAgIH1cbiAgICByZXR1cm4gb3ZlcnNlcnZlci5hZGQoaGFuZGxlcik7XG4gIH1cblxuICAvKipcbiAgICogVW5zdWJzY3JpYmVzIGFsbCBoYW5kbGVycyBmcm9tIHRoZSBnaXZlbiBnZXN0dXJlIHJlY29nbml6ZXIuIFJldHVybnNcbiAgICogdHJ1ZSBpZiBhbnl0aGluZyB3YXMgZG9uZS4gUmV0dXJucyBmYWxzZSBpZiB0aGVyZSB3ZXJlIG5vIGhhbmRsZXJzXG4gICAqIHJlZ2lzdGVyZWQgb24gdGhlIGdpdmVuIGdlc3R1cmUgcmVjb2duaXplciBpbiBmaXJzdCBwbGFjZS5cbiAgICpcbiAgICogQHBhcmFtIHtmdW5jdGlvbihuZXc6R2VzdHVyZVJlY29nbml6ZXI8REFUQT4sICFHZXN0dXJlcyl9IHJlY29nbml6ZXJDb25zdHJcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIHJlbW92ZUdlc3R1cmUocmVjb2duaXplckNvbnN0cikge1xuICAgIGNvbnN0IHR5cGUgPSBuZXcgcmVjb2duaXplckNvbnN0cih0aGlzKS5nZXRUeXBlKCk7XG4gICAgY29uc3Qgb3ZlcnNlcnZlciA9IHRoaXMub3ZlcnNlcnZlcnNfW3R5cGVdO1xuICAgIGlmIChvdmVyc2VydmVyKSB7XG4gICAgICBvdmVyc2VydmVyLnJlbW92ZUFsbCgpO1xuICAgICAgY29uc3QgaW5kZXggPSBmaW5kSW5kZXgodGhpcy5yZWNvZ25pemVyc18sIGUgPT4gZS5nZXRUeXBlKCkgPT0gdHlwZSk7XG4gICAgICBpZiAoaW5kZXggPCAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIC8vIFJlbW92ZSB0aGUgcmVjb2duaXplciBhcyB3ZWxsIGFzIGFsbCBhc3NvY2lhdGVkIHRyYWNraW5nIHN0YXRlXG4gICAgICB0aGlzLnJlY29nbml6ZXJzXy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgdGhpcy5yZWFkeV8uc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIHRoaXMucGVuZGluZ18uc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIHRoaXMudHJhY2tpbmdfLnNwbGljZShpbmRleCwgMSk7XG4gICAgICBkZWxldGUgdGhpcy5vdmVyc2VydmVyc19bdHlwZV07XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTdWJzY3JpYmVzIHRvIHBvaW50ZXIgZG93biBldmVudHMsIHN1Y2ggYXMgXCJ0b3VjaHN0YXJ0XCIgb3IgXCJtb3VzZWRvd25cIi5cbiAgICogQHBhcmFtIHshRnVuY3Rpb259IGhhbmRsZXJcbiAgICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICAgKi9cbiAgb25Qb2ludGVyRG93bihoYW5kbGVyKSB7XG4gICAgcmV0dXJuIHRoaXMucG9pbnRlckRvd25PYnNlcnZhYmxlXy5hZGQoaGFuZGxlcik7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlcyBhbGwgXCJ0b3VjaHN0YXJ0XCIgZXZlbnRzIGFuZCBkaXNwYXRjaGVzIHRoZW0gdG8gdGhlIHRyYWNraW5nXG4gICAqIHJlY29nbml6ZXJzLlxuICAgKiBAcGFyYW0geyFFdmVudH0gZXZlbnRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIG9uVG91Y2hTdGFydF8oZXZlbnQpIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIHRoaXMud2FzRXZlbnRpbmdfID0gZmFsc2U7XG5cbiAgICB0aGlzLnBvaW50ZXJEb3duT2JzZXJ2YWJsZV8uZmlyZShldmVudCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucmVjb2duaXplcnNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5yZWFkeV9baV0pIHtcbiAgICAgICAgLy8gSWYgdGhlIHJlY29nbml6ZXIgaXMgaW4gdGhlIFwicmVhZHlcIiBzdGF0ZSwgaXQgd29uJ3QgcmVjZWl2ZVxuICAgICAgICAvLyBhbnkgbW9yZSB0b3VjaCBzZXJpZXMgdW50aWwgaXQncyBhbGxvd2VkIHRvIGVtaXQuXG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMucGVuZGluZ19baV0gJiYgdGhpcy5wZW5kaW5nX1tpXSA8IG5vdykge1xuICAgICAgICAvLyBQZW5kaW5nIHN0YXRlIGV4cGlyZWQuIFJlc2V0LlxuICAgICAgICB0aGlzLnN0b3BUcmFja2luZ18oaSk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5yZWNvZ25pemVyc19baV0ub25Ub3VjaFN0YXJ0KGV2ZW50KSkge1xuICAgICAgICAvLyBXaGVuIGEgcmVjb2duaXplciBpcyBpbnRlcmVzdGVkIGluIHRoZSB0b3VjaCBzZXJpZXMgaXQgcmV0dXJucyBcInRydWVcIlxuICAgICAgICAvLyBmcm9tIGl0cyBvblRvdWNoU3RhcnQgbWV0aG9kLiBGb3IgdGhpcyByZWNvZ25pemVyIHdlIHN0YXJ0IHRyYWNraW5nXG4gICAgICAgIC8vIHRoZSB3aG9sZSBzZXJpZXMgb2YgdG91Y2ggZXZlbnRzIGZyb20gdG91Y2hzdGFydCB0byB0b3VjaGVuZC4gT3RoZXJcbiAgICAgICAgLy8gcmVjb2duaXplcnMgd2lsbCBub3QgcmVjZWl2ZSB0aGVtIHVubGVzcyB0aGV5IHJldHVybiBcInRydWVcIiBmcm9tXG4gICAgICAgIC8vIG9uVG91Y2hTdGFydC5cbiAgICAgICAgdGhpcy5zdGFydFRyYWNraW5nXyhpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmFmdGVyRXZlbnRfKGV2ZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIGFsbCBcInRvdWNobW92ZVwiIGV2ZW50cyBhbmQgZGlzcGF0Y2hlcyB0aGVtIHRvIHRoZSB0cmFja2luZ1xuICAgKiByZWNvZ25pemVycy5cbiAgICogQHBhcmFtIHshRXZlbnR9IGV2ZW50XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBvblRvdWNoTW92ZV8oZXZlbnQpIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnJlY29nbml6ZXJzXy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKCF0aGlzLnRyYWNraW5nX1tpXSkge1xuICAgICAgICAvLyBUaGUgd2hvbGUgdG91Y2ggc2VyaWVzIGFyZSBpZ25vcmVkIGZvciBub24tdHJhY2tpbmcgcmVjb2duaXplcnMuXG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMucGVuZGluZ19baV0gJiYgdGhpcy5wZW5kaW5nX1tpXSA8IG5vdykge1xuICAgICAgICAvLyBQZW5kaW5nIHN0YXRlIGV4cGlyZWQuIFJlc2V0LlxuICAgICAgICB0aGlzLnN0b3BUcmFja2luZ18oaSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLnJlY29nbml6ZXJzX1tpXS5vblRvdWNoTW92ZShldmVudCkpIHtcbiAgICAgICAgLy8gUmVjb2duaXplciBsb3N0IGludGVyZXN0IGluIHRoZSBzZXJpZXMuIFJlc2V0LlxuICAgICAgICB0aGlzLnN0b3BUcmFja2luZ18oaSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5hZnRlckV2ZW50XyhldmVudCk7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlcyBhbGwgXCJ0b3VjaGVuZFwiIGV2ZW50cyBhbmQgZGlzcGF0Y2hlcyB0aGVtIHRvIHRoZSB0cmFja2luZ1xuICAgKiByZWNvZ25pemVycy5cbiAgICogQHBhcmFtIHshRXZlbnR9IGV2ZW50XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBvblRvdWNoRW5kXyhldmVudCkge1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucmVjb2duaXplcnNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoIXRoaXMudHJhY2tpbmdfW2ldKSB7XG4gICAgICAgIC8vIFRoZSB3aG9sZSB0b3VjaCBzZXJpZXMgYXJlIGlnbm9yZWQgZm9yIG5vbi10cmFja2luZyByZWNvZ25pemVycy5cbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5wZW5kaW5nX1tpXSAmJiB0aGlzLnBlbmRpbmdfW2ldIDwgbm93KSB7XG4gICAgICAgIC8vIFBlbmRpbmcgc3RhdGUgZXhwaXJlZC4gUmVzZXQuXG4gICAgICAgIHRoaXMuc3RvcFRyYWNraW5nXyhpKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICB0aGlzLnJlY29nbml6ZXJzX1tpXS5vblRvdWNoRW5kKGV2ZW50KTtcbiAgICAgIGlmICghdGhpcy5wZW5kaW5nX1tpXSB8fCB0aGlzLnBlbmRpbmdfW2ldIDwgbm93KSB7XG4gICAgICAgIHRoaXMuc3RvcFRyYWNraW5nXyhpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmFmdGVyRXZlbnRfKGV2ZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIGFsbCBcInRvdWNoY2FuY2VsXCIgZXZlbnRzLiBDYW5jZWxzIGFsbCB0cmFja2luZy9lbWl0dGluZ1xuICAgKiByZWNvZ25pemVycy5cbiAgICogQHBhcmFtIHshRXZlbnR9IGV2ZW50XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBvblRvdWNoQ2FuY2VsXyhldmVudCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5yZWNvZ25pemVyc18ubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMuY2FuY2VsRXZlbnRpbmdfKGkpO1xuICAgIH1cbiAgICB0aGlzLmFmdGVyRXZlbnRfKGV2ZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBmb3IgYSBnZXN0dXJlIHJlY29nbml6ZXIgdG8gY29tbXVuaWNhdGUgdGhhdCBpdCdzIHJlYWR5IHRvXG4gICAqIHN0YXJ0IGVtaXR0aW5nIGdlc3R1cmVzLiBHZXN0dXJlcyBpbnN0YW5jZSBtYXkgb3IgbWF5IG5vdCBhbGxvdyB0aGVcbiAgICogcmVjb2duaXplciB0byBwcm9jZWVkLlxuICAgKiBAcGFyYW0geyFHZXN0dXJlUmVjb2duaXplcn0gcmVjb2duaXplclxuICAgKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0XG4gICAqIEBwcml2YXRlXG4gICAqIEByZXN0cmljdGVkXG4gICAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICAgKi9cbiAgc2lnbmFsUmVhZHlfKHJlY29nbml6ZXIsIG9mZnNldCkge1xuICAgIC8vIFNvbWVib2R5IGdvdCBoZXJlIGZpcnN0LlxuICAgIGlmICh0aGlzLmV2ZW50aW5nXykge1xuICAgICAgcmVjb2duaXplci5hY2NlcHRDYW5jZWwoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTZXQgdGhlIHJlY29nbml6ZXIgYXMgcmVhZHkgYW5kIHdhaXQgZm9yIHRoZSBwYXNzIHRvXG4gICAgLy8gbWFrZSB0aGUgZGVjaXNpb24uXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucmVjb2duaXplcnNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5yZWNvZ25pemVyc19baV0gPT0gcmVjb2duaXplcikge1xuICAgICAgICB0aGlzLnJlYWR5X1tpXSA9IG5vdyArIG9mZnNldDtcbiAgICAgICAgdGhpcy5wZW5kaW5nX1tpXSA9IDA7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMucGFzc0FmdGVyRXZlbnRfID0gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBmb3IgYSBnZXN0dXJlIHJlY29nbml6ZXIgdG8gY29tbXVuaWNhdGUgdGhhdCBpdCdzIGNsb3NlIHRvXG4gICAqIHN0YXJ0IGVtaXR0aW5nIGdlc3R1cmVzLCBidXQgbmVlZHMgbW9yZSB0aW1lIHRvIHNlZSBtb3JlIGV2ZW50cy4gT25jZVxuICAgKiB0aGlzIHRpbWUgZXhwaXJlcyB0aGUgcmVjb2duaXplciBzaG91bGQgZWl0aGVyIHNpZ25hbCByZWFkaW5lc3Mgb3IgaXRcbiAgICogd2lsbCBiZSBjYW5jZWxlZC5cbiAgICogQHBhcmFtIHshR2VzdHVyZVJlY29nbml6ZXJ9IHJlY29nbml6ZXJcbiAgICogQHBhcmFtIHtudW1iZXJ9IHRpbWVMZWZ0XG4gICAqIEBwcml2YXRlXG4gICAqIEByZXN0cmljdGVkXG4gICAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICAgKi9cbiAgc2lnbmFsUGVuZGluZ18ocmVjb2duaXplciwgdGltZUxlZnQpIHtcbiAgICAvLyBTb21lYm9keSBnb3QgaGVyZSBmaXJzdC5cbiAgICBpZiAodGhpcy5ldmVudGluZ18pIHtcbiAgICAgIHJlY29nbml6ZXIuYWNjZXB0Q2FuY2VsKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucmVjb2duaXplcnNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5yZWNvZ25pemVyc19baV0gPT0gcmVjb2duaXplcikge1xuICAgICAgICB0aGlzLnBlbmRpbmdfW2ldID0gbm93ICsgdGltZUxlZnQ7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIGZvciBhIGdlc3R1cmUgcmVjb2duaXplciB0byBjb21tdW5pY2F0ZSB0aGF0IGl0J3MgZG9uZVxuICAgKiBlbWl0dGluZyBnZXN0dXJlcy5cbiAgICogQHBhcmFtIHshR2VzdHVyZVJlY29nbml6ZXJ9IHJlY29nbml6ZXJcbiAgICogQHByaXZhdGVcbiAgICogQHJlc3RyaWN0ZWRcbiAgICogQHZpc2libGVGb3JUZXN0aW5nXG4gICAqL1xuICBzaWduYWxFbmRfKHJlY29nbml6ZXIpIHtcbiAgICBpZiAodGhpcy5ldmVudGluZ18gPT0gcmVjb2duaXplcikge1xuICAgICAgdGhpcy5ldmVudGluZ18gPSBudWxsO1xuICAgICAgdGhpcy53YXNFdmVudGluZ18gPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBmb3IgYSBnZXN0dXJlIGVtaXQgdGhlIGdlc3R1cmUuIE9ubHkgdGhlIGN1cnJlbnRseSBlbWl0dGluZ1xuICAgKiByZWNvZ25pemVyIGlzIGFsbG93ZWQgdG8gZW1pdCBnZXN0dXJlcy5cbiAgICogQHBhcmFtIHshR2VzdHVyZVJlY29nbml6ZXJ9IHJlY29nbml6ZXJcbiAgICogQHBhcmFtIHsqfSBkYXRhXG4gICAqIEBwYXJhbSB7P0V2ZW50fSBldmVudFxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcmVzdHJpY3RlZFxuICAgKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAgICovXG4gIHNpZ25hbEVtaXRfKHJlY29nbml6ZXIsIGRhdGEsIGV2ZW50KSB7XG4gICAgZGV2KCkuYXNzZXJ0KHRoaXMuZXZlbnRpbmdfID09IHJlY29nbml6ZXIsXG4gICAgICAgICdSZWNvZ25pemVyIGlzIG5vdCBjdXJyZW50bHkgYWxsb3dlZDogJXMnLCByZWNvZ25pemVyLmdldFR5cGUoKSk7XG4gICAgY29uc3Qgb3ZlcnNlcnZlciA9IHRoaXMub3ZlcnNlcnZlcnNfW3JlY29nbml6ZXIuZ2V0VHlwZSgpXTtcbiAgICBpZiAob3ZlcnNlcnZlcikge1xuICAgICAgb3ZlcnNlcnZlci5maXJlKG5ldyBHZXN0dXJlKHJlY29nbml6ZXIuZ2V0VHlwZSgpLCBkYXRhLCBEYXRlLm5vdygpLFxuICAgICAgICAgIGV2ZW50KSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUV2ZW50fSBldmVudFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgYWZ0ZXJFdmVudF8oZXZlbnQpIHtcbiAgICBsZXQgY2FuY2VsRXZlbnQgPSAhIXRoaXMuZXZlbnRpbmdfIHx8IHRoaXMud2FzRXZlbnRpbmdfO1xuICAgIHRoaXMud2FzRXZlbnRpbmdfID0gZmFsc2U7XG4gICAgaWYgKCFjYW5jZWxFdmVudCkge1xuICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5yZWNvZ25pemVyc18ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMucmVhZHlfW2ldIHx8XG4gICAgICAgICAgICAgICAgKHRoaXMucGVuZGluZ19baV0gJiYgdGhpcy5wZW5kaW5nX1tpXSA+PSBub3cpKSB7XG4gICAgICAgICAgY2FuY2VsRXZlbnQgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChjYW5jZWxFdmVudCkge1xuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBpZiAoIXRoaXMuc2hvdWxkTm90UHJldmVudERlZmF1bHRfKSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0aGlzLnBhc3NBZnRlckV2ZW50Xykge1xuICAgICAgdGhpcy5wYXNzQWZ0ZXJFdmVudF8gPSBmYWxzZTtcbiAgICAgIHRoaXMuZG9QYXNzXygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgcGFzcyB0aGF0IGRlY2lkZXMgd2hpY2ggcmVjb2duaXplcnMgY2FuIHN0YXJ0IGVtaXR0aW5nIGFuZCB3aGljaFxuICAgKiBhcmUgY2FuY2VsZWQuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBkb1Bhc3NfKCkge1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG5cbiAgICAvLyBUaGUgXCJtb3N0IHJlYWR5XCIgcmVjb2duaXplciBpcyB0aGUgeW91bmdlc3QgaW4gdGhlIFwicmVhZHlcIiBzZXQuXG4gICAgLy8gT3RoZXJ3aXNlIHdlIHdvdWxkbid0IHdhaXQgZm9yIGl0IGF0IGFsbC5cbiAgICBsZXQgcmVhZHlJbmRleCA9IC0xO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5yZWNvZ25pemVyc18ubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghdGhpcy5yZWFkeV9baV0pIHtcbiAgICAgICAgaWYgKHRoaXMucGVuZGluZ19baV0gJiYgdGhpcy5wZW5kaW5nX1tpXSA8IG5vdykge1xuICAgICAgICAgIC8vIFBlbmRpbmcgc3RhdGUgZXhwaXJlZC4gUmVzZXQuXG4gICAgICAgICAgdGhpcy5zdG9wVHJhY2tpbmdfKGkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKHJlYWR5SW5kZXggPT0gLTEgfHwgdGhpcy5yZWFkeV9baV0gPiB0aGlzLnJlYWR5X1tyZWFkeUluZGV4XSkge1xuICAgICAgICByZWFkeUluZGV4ID0gaTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocmVhZHlJbmRleCA9PSAtMSkge1xuICAgICAgLy8gTm90aGluZyB0byBkby5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBMb29rIGZvciBjb25mbGljdHMuXG4gICAgbGV0IHdhaXRUaW1lID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucmVjb2duaXplcnNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5yZWFkeV9baV0gfHwgIXRoaXMudHJhY2tpbmdfW2ldKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgd2FpdFRpbWUgPSBNYXRoLm1heCh3YWl0VGltZSwgdGhpcy5wZW5kaW5nX1tpXSAtIG5vdyk7XG4gICAgfVxuXG4gICAgaWYgKHdhaXRUaW1lIDwgMikge1xuICAgICAgLy8gV2Ugd2FpdGVkIGxvbmcgZW5vdWdoLlxuICAgICAgdGhpcy5zdGFydEV2ZW50aW5nXyhyZWFkeUluZGV4KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTb21lIGNvbmZsaWN0czogaGF2ZSB0byB3YWl0IHRvIHNlZSB3aG8gd2lucy5cbiAgICB0aGlzLnBhc3NfLnNjaGVkdWxlKHdhaXRUaW1lKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIHJlY29nbml6ZXIgaXMgZ2l2ZW4gXCJnbyBhaGVhZFwiIGFuZCBhbGwgb3RoZXJzIGFyZSBjYW5jZWxlZC5cbiAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzdGFydEV2ZW50aW5nXyhpbmRleCkge1xuICAgIGNvbnN0IHJlY29nbml6ZXIgPSB0aGlzLnJlY29nbml6ZXJzX1tpbmRleF07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnJlY29nbml6ZXJzXy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGkgIT0gaW5kZXgpIHtcbiAgICAgICAgdGhpcy5jYW5jZWxFdmVudGluZ18oaSk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMucmVhZHlfW2luZGV4XSA9IDA7XG4gICAgdGhpcy5wZW5kaW5nX1tpbmRleF0gPSAwO1xuICAgIHRoaXMuZXZlbnRpbmdfID0gcmVjb2duaXplcjtcbiAgICByZWNvZ25pemVyLmFjY2VwdFN0YXJ0KCk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzdGFydFRyYWNraW5nXyhpbmRleCkge1xuICAgIHRoaXMudHJhY2tpbmdfW2luZGV4XSA9IHRydWU7XG4gICAgdGhpcy5wZW5kaW5nX1tpbmRleF0gPSAwO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc3RvcFRyYWNraW5nXyhpbmRleCkge1xuICAgIHRoaXMudHJhY2tpbmdfW2luZGV4XSA9IGZhbHNlO1xuICAgIHRoaXMucGVuZGluZ19baW5kZXhdID0gMDtcbiAgICBpZiAoIXRoaXMucmVhZHlfW2luZGV4XSkge1xuICAgICAgdGhpcy5yZWNvZ25pemVyc19baW5kZXhdLmFjY2VwdENhbmNlbCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXhcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGNhbmNlbEV2ZW50aW5nXyhpbmRleCkge1xuICAgIHRoaXMucmVhZHlfW2luZGV4XSA9IDA7XG4gICAgdGhpcy5zdG9wVHJhY2tpbmdfKGluZGV4KTtcbiAgfVxufVxuXG5cbi8qKlxuICogVGhlIGdlc3R1cmUgcmVjb2duaXplciByZWNlaXZlcyB0aGUgcG9pbnRlciBldmVudHMgZnJvbSBHZXN0dXJlcyBpbnN0YW5jZS5cbiAqIEJhc2VkIG9uIHRoZXNlIGV2ZW50cywgaXQgY2FuIFwicmVjb2duaXplXCIgdGhlIGdlc3R1cmUgaXQncyByZXNwb25zaWJsZSBmb3IsXG4gKiByZXF1ZXN0IHRvIHN0YXJ0IGVtaXR0aW5nIGFuZCBlbWl0IGdlc3R1cmVzLiBHZXN0dXJlcyBpbnN0YW5jZXMgbWFuYWdlc1xuICogc2V2ZXJhbCBjb21wZXRpbmcgcmVjb2duaXplcnMgYW5kIGRlY2lkZXMgd2hpY2ggb25lcyBnZXQgdG8gZW1pdCBnZXN0dXJlc1xuICogYW5kIHdoaWNoIGRvIG5vdC5cbiAqXG4gKiBUaGUgcmVjb2duaXplciBjYW4gYmUgaW4gc2V2ZXJhbCBtYWluIHN0YXRlczpcbiAqIDEuIFRyYWNraW5nIHN0YXRlLiBJbiB0aGlzIHN0YXRlIHRoZSByZWNvZ25pemVyIGlzIHJlY2VpdmluZyB0aGUgc2VyaWVzIG9mXG4gKiAgICB0b3VjaCBldmVudHMgZnJvbSB0b3VjaHN0YXJ0IHRvIHRvdWNoZW5kLiBUbyBnZXQgaW50byB0aGlzIHN0YXRlIHRoZVxuICogICAgcmVjb2duaXplciBoYXMgdG8gcmV0dXJuIFwidHJ1ZVwiIGZyb20gdGhlIHtAbGluayBvblRvdWNoU3RhcnR9LlxuICogMi4gUGVuZGluZyBzdGF0ZSAob3B0aW9uYWwpLiBUaGUgcmVjb2duaXplciBtYXRjaGVkIHBhcnQgb2YgdGhlIGdlc3R1cmUsXG4gKiAgICBidXQgbmVlZHMgbW9yZSB0aW1lIHRvIGdldCB0cmFjayBtb3JlIGV2ZW50cy4gSXQgcmVxdWVzdHMgbW9yZSB0aW1lXG4gKiAgICBieSBjYWxsaW5nIHtAbGluayBzaWduYWxQZW5kaW5nfSwgQnkgdGhlIGVuZCBvZiB0aGlzIHRpbWUgdGhlIHJlY29nbml6ZXJcbiAqICAgIGhhcyBlaXRoZXIgbWF0Y2hlZCB0aGUgZ2VzdHVyZSBvciBoYXMgYmVlbiBjYW5jZWxlZC5cbiAqIDMuIFJlYWR5IHN0YXRlLiBUaGUgcmVjb2duaXplciBtYXRjaGVkIHRoZSB3aG9sZSBnZXN0dXJlIGFuZCByZWFkeSB0byBzdGFydFxuICogICAgZW1pdHRpbmcuIEl0IGNvbW11bmljYXRlcyB0byB0aGUgR2VzdHVyZXMgdGhpcyByZWFkaW5lc3MgYnkgY2FsbGluZ1xuICogICAge0BsaW5rIHNpZ25hbFJlYWR5fS5cbiAqIDUuIEVtaXR0aW5nIHN0YXRlLiBJZiBHZXN0dXJlcyBkZWNpZGVzIHRvIGdvIGFoZWFkIHdpdGggdGhpcyByZWNvZ25pemVyLCBpdFxuICogICAgd2lsbCBjYWxsIHtAbGluayBhY2NlcHRTdGFydH0gbWV0aG9kLiBPdGhlcndpc2UsIGl0IHdpbGwgY2FsbFxuICogICAge0BsaW5rIGFjY2VwdENhbmNlbH0gbWV0aG9kLiBPbmNlIGluIHRoZSBlbWl0dGluZyBzdGF0ZSwgdGhlIHJlY29nbml6ZXJcbiAqICAgIGNhbiBlbWl0IGFueSBudW1iZXIgb2YgZXZlbnRzIGJ5IGNhbGxpbmcge0BsaW5rIHNpZ25hbEVtaXR9LlxuICogNi4gQ29tcGxldGUgc3RhdGUuIE9uY2UgZG9uZSwgdGhlIHJlY29nbml6ZXIgY2FuIGNhbGwge0BsaW5rIHNpZ25hbEVuZH0gdG9cbiAqICAgIGNvbW11bmljYXRlIHRoYXQgaXQncyBkb25lLlxuICpcbiAqIEB0ZW1wbGF0ZSBEQVRBXG4gKi9cbmV4cG9ydCBjbGFzcyBHZXN0dXJlUmVjb2duaXplciB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlXG4gICAqIEBwYXJhbSB7IUdlc3R1cmVzfSBtYW5hZ2VyXG4gICAqL1xuICBjb25zdHJ1Y3Rvcih0eXBlLCBtYW5hZ2VyKSB7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7c3RyaW5nfSAqL1xuICAgIHRoaXMudHlwZV8gPSB0eXBlO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IUdlc3R1cmVzfSAqL1xuICAgIHRoaXMubWFuYWdlcl8gPSBtYW5hZ2VyO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHR5cGUgb2YgdGhlIGdlc3R1cmUgZW1pdHRlZCBieSB0aGUgaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICogSXQgaGFzIHRvIGJlIHVuaXF1ZSBpbiB0aGUgc2NvcGUgb2YgdGhlIEdlc3R1cmVzIGluc3RhbmNlLlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAqL1xuICBnZXRUeXBlKCkge1xuICAgIHJldHVybiB0aGlzLnR5cGVfO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSByZWNvZ25pemVyIGNhbiBjYWxsIHRoaXMgbWV0aG9kIHRvIGNvbW11bmljYXRlIHRoYXQgaXQncyByZWFkeSB0b1xuICAgKiBzdGFydCBlbWl0dGluZyB0aGUgZ2VzdHVyZS4gT3B0aW9uYWxseSBpdCBjYW4gcGFzcyBhIHplcm8sIHBvc2l0aXZlIG9yXG4gICAqIG5lZ2F0aXZlIG9mZnNldCAtIGEgdGltZSBvbiBob3cgbXVjaCB0aGUgZ2VzdHVyZSBzaG91bGQgYmUgcGVuYWxpemVkIG9yXG4gICAqIGdpdmVuIGFkdmFudGFnZSBpbiBjb25mbGljdCByZXNvbHV0aW9uLiBUaGUgcmVjb2duaXplciBhdCB0aGlzIHBvaW50IGlzXG4gICAqIGluIHRoZSBcInJlYWR5XCIgc3RhdGUuXG4gICAqIEBwYXJhbSB7dGltZX0gb2Zmc2V0XG4gICAqL1xuICBzaWduYWxSZWFkeShvZmZzZXQpIHtcbiAgICB0aGlzLm1hbmFnZXJfLnNpZ25hbFJlYWR5Xyh0aGlzLCBvZmZzZXQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSByZWNvZ25pemVyIGNhbiBjYWxsIHRoaXMgbWV0aG9kIHRvIGNvbW11bmljYXRlIHRoYXQgaXQgbmVlZHMgbW9yZVxuICAgKiB0aW1lICh0aW1lTGVmdCkgdG8gbWF0Y2ggdGhlIGdlc3R1cmUuIEJ5IHRoZSBlbmQgb2YgdGhpcyB0aW1lIHRoZVxuICAgKiByZWNvZ25pemVyIGhhcyB0byBlaXRoZXIgdHJhbnNpdCB0byB0aGUgcmVhZHkgc3RhdGUgdXNpbmdcbiAgICoge0BsaW5rIHNpZ25hbFJlYWR5fSBvciBpdCB3aWxsIGJlIGNhbmNlbGVkLiBUaGUgcmVjb2duaXplciBpcyBpbiB0aGVcbiAgICogXCJwZW5kaW5nXCIgc3RhdGUuXG4gICAqIEBwYXJhbSB7dGltZX0gdGltZUxlZnRcbiAgICovXG4gIHNpZ25hbFBlbmRpbmcodGltZUxlZnQpIHtcbiAgICB0aGlzLm1hbmFnZXJfLnNpZ25hbFBlbmRpbmdfKHRoaXMsIHRpbWVMZWZ0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgcmVjb2duaXplciBjYW4gY2FsbCB0aGlzIG1ldGhvZCB0byBjb21tdW5pY2F0ZSB0aGF0IGl0J3MgZG9uZVxuICAgKiBlbWl0dGluZyB0aGUgZ2VzdHVyZXMuIEl0IHdpbGwgcmV0dXJuIHRvIHRoZSB3YWl0aW5nIHN0YXRlLiBSZWNvZ25pemVyXG4gICAqIGNhbiBvbmx5IGNhbGwgdGhpcyBtZXRob2QgaWYgaXQgaGFzIHByZXZpb3VzbHkgcmVjZWl2ZWQgdGhlXG4gICAqIHtAbGluayBhY2NlcHRTdGFydH0gY2FsbC5cbiAgICovXG4gIHNpZ25hbEVuZCgpIHtcbiAgICB0aGlzLm1hbmFnZXJfLnNpZ25hbEVuZF8odGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogVGhlIHJlY29nbml6ZXIgY2FuIGNhbGwgdGhpcyBtZXRob2QgdG8gZW1pdCB0aGUgZ2VzdHVyZXMgd2hpbGUgaW4gdGhlXG4gICAqIFwiZW1pdHRpbmdcIiBzdGF0ZS4gUmVjb2duaXplciBjYW4gb25seSBjYWxsIHRoaXMgbWV0aG9kIGlmIGl0IGhhc1xuICAgKiBwcmV2aW91c2x5IHJlY2VpdmVkIHRoZSB7QGxpbmsgYWNjZXB0U3RhcnR9IGNhbGwuXG4gICAqIEBwYXJhbSB7REFUQX0gZGF0YVxuICAgKiBAcGFyYW0gez9FdmVudH0gZXZlbnRcbiAgICovXG4gIHNpZ25hbEVtaXQoZGF0YSwgZXZlbnQpIHtcbiAgICB0aGlzLm1hbmFnZXJfLnNpZ25hbEVtaXRfKHRoaXMsIGRhdGEsIGV2ZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgR2VzdHVyZXMgaW5zdGFuY2UgY2FsbHMgdGhpcyBtZXRob2QgdG8gYWxsb3cgdGhlIHJlY29nbml6ZXIgdG8gc3RhcnRcbiAgICogZW1pdHRpbmcgdGhlIGdlc3R1cmVzLiBBdCB0aGlzIHBvaW50IHRoZSByZWNvZ25pemVyIGlzIGluIHRoZSBcImVtaXR0aW5nXCJcbiAgICogc3RhdGUuIEl0IHdpbGwgYmUgaW4gdGhpcyBzdGF0ZSB1bnRpbCBpdCBjYWxscyB7QGxpbmsgc2lnbmFsRW5kfSBvclxuICAgKiB0aGUge0BsaW5rIGFjY2VwdENhbmNlbH0gaXMgY2FsbGVkIGJ5IHRoZSBHZXN0dXJlcyBpbnN0YW5jZS5cbiAgICovXG4gIGFjY2VwdFN0YXJ0KCkge1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBHZXN0dXJlcyBpbnN0YW5jZSBjYWxscyB0aGlzIG1ldGhvZCB0byByZXNldCB0aGUgcmVjb2duaXplci4gQXQgdGhpc1xuICAgKiBwb2ludCB0aGUgcmVjb2duaXplciBpcyBpbiB0aGUgaW5pdGlhbCB3YWl0aW5nIHN0YXRlLlxuICAgKi9cbiAgYWNjZXB0Q2FuY2VsKCkge1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBHZXN0dXJlcyBpbnN0YW5jZSBjYWxscyB0aGlzIG1ldGhvZCBmb3IgZWFjaCBcInRvdWNoc3RhcnRcIiBldmVudC4gSWZcbiAgICogdGhlIHJlY29nbml6ZXIgd2FudHMgdG8gcmVjZWl2ZSBvdGhlciB0b3VjaCBldmVudHMgaW4gdGhlIHNlcmllcywgaXQgaGFzXG4gICAqIHRvIHJldHVybiBcInRydWVcIi5cbiAgICogQHBhcmFtIHshRXZlbnR9IHVudXNlZEV2ZW50XG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBvblRvdWNoU3RhcnQodW51c2VkRXZlbnQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogVGhlIEdlc3R1cmVzIGluc3RhbmNlIGNhbGxzIHRoaXMgbWV0aG9kIGZvciBlYWNoIFwidG91Y2htb3ZlXCIgZXZlbnQuIElmXG4gICAqIHRoZSByZWNvZ25pemVyIHdhbnRzIHRvIGNvbnRpbnVlIHJlY2VpdmluZyB0b3VjaCBldmVudHMgaW4gdGhlIHNlcmllcyxcbiAgICogaXQgaGFzIHRvIHJldHVybiBcInRydWVcIi5cbiAgICogQHBhcmFtIHshRXZlbnR9IHVudXNlZEV2ZW50XG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBvblRvdWNoTW92ZSh1bnVzZWRFdmVudCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgR2VzdHVyZXMgaW5zdGFuY2UgY2FsbHMgdGhpcyBtZXRob2QgZm9yIHRoZSBcInRvdWNoZW5kXCIgZXZlbnQuXG4gICAqIFNvbWV3aGVyZSB3aXRoaW4gdGhpcyB0b3VjaCBzZXJpZXMgdGhlIHJlY29nbml6ZXIgaGFzIHRvIGNhbGxcbiAgICoge0BsaW5rIHNpZ25hbFJlYWR5fSBvciB7QGxpbmsgc2lnbmFsUGVuZGluZ30gb3IgaXQgd2lsbCBiZSByZXNldCBmb3IgdGhlXG4gICAqIG5leHQgdG91Y2ggc2VyaWVzLlxuICAgKiBAcGFyYW0geyFFdmVudH0gdW51c2VkRXZlbnRcbiAgICovXG4gIG9uVG91Y2hFbmQodW51c2VkRXZlbnQpIHtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuLyoqXG4gKiBUaGUgc3RydWN0dXJlIHRoYXQgY29tYmluZXMgcG9zaXRpb24gYW5kIHNpemUgZm9yIGFuIGVsZW1lbnQuIFRoZSBleGFjdFxuICogaW50ZXJwcmV0YXRpb24gb2YgcG9zaXRpb24gYW5kIHNpemUgZGVwZW5kcyBvbiB0aGUgdXNlIGNhc2UuXG4gKlxuICogQHR5cGVkZWYge3tcbiAqICAgdG9wOiBudW1iZXIsXG4gKiAgIGJvdHRvbTogbnVtYmVyLFxuICogICBsZWZ0OiBudW1iZXIsXG4gKiAgIHJpZ2h0OiBudW1iZXIsXG4gKiAgIHdpZHRoOiBudW1iZXIsXG4gKiAgIGhlaWdodDogbnVtYmVyLFxuICogICB4OiBudW1iZXIsXG4gKiAgIHk6IG51bWJlclxuICogfX1cbiAqL1xuZXhwb3J0IGxldCBMYXlvdXRSZWN0RGVmO1xuXG5cbi8qKlxuICogVGhlIHN0cnVjdHVyZSB0aGF0IHJlcHJlc2VudHMgdGhlIG1hcmdpbnMgb2YgYW4gRWxlbWVudC5cbiAqXG4gKiBAdHlwZWRlZiB7e1xuICogICB0b3A6IG51bWJlcixcbiAqICAgcmlnaHQ6IG51bWJlcixcbiAqICAgYm90dG9tOiBudW1iZXIsXG4gKiAgIGxlZnQ6IG51bWJlclxuICogfX1cbiAqL1xuZXhwb3J0IGxldCBMYXlvdXRNYXJnaW5zRGVmO1xuXG5cbi8qKlxuICogVGhlIHN0cnVjdHVyZSB0aGF0IHJlcHJlc2VudHMgYSByZXF1ZXN0ZWQgY2hhbmdlIHRvIHRoZSBtYXJnaW5zIG9mIGFuXG4gKiBFbGVtZW50LiBBbnkgbmV3IHZhbHVlcyBzcGVjaWZpZWQgd2lsbCByZXBsYWNlIGV4aXN0aW5nIG9uZXMgKHJhdGhlciB0aGFuXG4gKiBiZWluZyBhZGRpdGl2ZSkuXG4gKlxuICogQHR5cGVkZWYge3tcbiAqICAgdG9wOiAobnVtYmVyfHVuZGVmaW5lZCksXG4gKiAgIHJpZ2h0OiAobnVtYmVyfHVuZGVmaW5lZCksXG4gKiAgIGJvdHRvbTogKG51bWJlcnx1bmRlZmluZWQpLFxuICogICBsZWZ0OiAobnVtYmVyfHVuZGVmaW5lZClcbiAqIH19XG4gKi9cbmV4cG9ydCBsZXQgTGF5b3V0TWFyZ2luc0NoYW5nZURlZjtcblxuLyoqXG4qIFJlbGF0aXZlUG9zaXRpb25zXG4qXG4qIERlc2NyaWJlcyB0aGUgcmVsYXRpdmUgcG9zaXRpb24gb2YgYW4gZWxlbWVudCB0byBhbm90aGVyICh3aGV0aGVyIHRoZVxuKiBmaXJzdCBpcyBpbnNpZGUgdGhlIHNlY29uZCwgb24gdG9wIG9mIHRoZSBzZWNvbmQgb3Igb24gdGhlIGJvdHRvbVxuKiBAZW51bSB7c3RyaW5nfVxuKi9cbmV4cG9ydCBjb25zdCBSZWxhdGl2ZVBvc2l0aW9ucyA9IHtcbiAgSU5TSURFOiAnaW5zaWRlJyxcbiAgVE9QOiAndG9wJyxcbiAgQk9UVE9NOiAnYm90dG9tJyxcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIGxheW91dCByZWN0IGJhc2VkIG9uIHRoZSBsZWZ0LCB0b3AsIHdpZHRoIGFuZCBoZWlnaHQgcGFyYW1ldGVyc1xuICogaW4gdGhhdCBvcmRlci5cbiAqIEBwYXJhbSB7bnVtYmVyfSBsZWZ0XG4gKiBAcGFyYW0ge251bWJlcn0gdG9wXG4gKiBAcGFyYW0ge251bWJlcn0gd2lkdGhcbiAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHRcbiAqIEByZXR1cm4geyFMYXlvdXRSZWN0RGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGF5b3V0UmVjdEx0d2gobGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0KSB7XG4gIHJldHVybiB7XG4gICAgbGVmdCxcbiAgICB0b3AsXG4gICAgd2lkdGgsXG4gICAgaGVpZ2h0LFxuICAgIGJvdHRvbTogdG9wICsgaGVpZ2h0LFxuICAgIHJpZ2h0OiBsZWZ0ICsgd2lkdGgsXG4gICAgeDogbGVmdCxcbiAgICB5OiB0b3AsXG4gIH07XG59XG5cblxuLyoqXG4gKiBDcmVhdGVzIGEgbGF5b3V0IHJlY3QgYmFzZWQgb24gdGhlIERPTVJlY3QsIGUuZy4gb2J0YWluZWQgZnJvbSBjYWxsaW5nXG4gKiBnZXRCb3VuZGluZ0NsaWVudFJlY3QuXG4gKiBAcGFyYW0geyFDbGllbnRSZWN0fSByZWN0XG4gKiBAcmV0dXJuIHshTGF5b3V0UmVjdERlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxheW91dFJlY3RGcm9tRG9tUmVjdChyZWN0KSB7XG4gIHJldHVybiBsYXlvdXRSZWN0THR3aChOdW1iZXIocmVjdC5sZWZ0KSwgTnVtYmVyKHJlY3QudG9wKSxcbiAgICAgIE51bWJlcihyZWN0LndpZHRoKSwgTnVtYmVyKHJlY3QuaGVpZ2h0KSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBzcGVjaWZpZWQgdHdvIHJlY3RzIG92ZXJsYXAgYnkgYSBzaW5nbGUgcGl4ZWwuXG4gKiBAcGFyYW0geyFMYXlvdXRSZWN0RGVmfSByMVxuICogQHBhcmFtIHshTGF5b3V0UmVjdERlZn0gcjJcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXlvdXRSZWN0c092ZXJsYXAocjEsIHIyKSB7XG4gIHJldHVybiAocjEudG9wIDw9IHIyLmJvdHRvbSAmJiByMi50b3AgPD0gcjEuYm90dG9tICYmXG4gICAgICByMS5sZWZ0IDw9IHIyLnJpZ2h0ICYmIHIyLmxlZnQgPD0gcjEucmlnaHQpO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyB0aGUgaW50ZXJzZWN0aW9uIGJldHdlZW4gYSwgYiBvciBudWxsIGlmIHRoZXJlIGlzIG5vbmUuXG4gKiBAcGFyYW0gey4uLj9MYXlvdXRSZWN0RGVmfHVuZGVmaW5lZH0gdmFyX2FyZ3NcbiAqIEByZXR1cm4gez9MYXlvdXRSZWN0RGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVjdEludGVyc2VjdGlvbih2YXJfYXJncykge1xuICBsZXQgeDAgPSAtSW5maW5pdHk7XG4gIGxldCB4MSA9IEluZmluaXR5O1xuICBsZXQgeTAgPSAtSW5maW5pdHk7XG4gIGxldCB5MSA9IEluZmluaXR5O1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGN1cnJlbnQgPSBhcmd1bWVudHNbaV07XG4gICAgaWYgKCFjdXJyZW50KSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgeDAgPSBNYXRoLm1heCh4MCwgY3VycmVudC5sZWZ0KTtcbiAgICB4MSA9IE1hdGgubWluKHgxLCBjdXJyZW50LmxlZnQgKyBjdXJyZW50LndpZHRoKTtcbiAgICB5MCA9IE1hdGgubWF4KHkwLCBjdXJyZW50LnRvcCk7XG4gICAgeTEgPSBNYXRoLm1pbih5MSwgY3VycmVudC50b3AgKyBjdXJyZW50LmhlaWdodCk7XG4gICAgaWYgKHgxIDwgeDAgfHwgeTEgPCB5MCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG4gIGlmICh4MSA9PSBJbmZpbml0eSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHJldHVybiBsYXlvdXRSZWN0THR3aCh4MCwgeTAsIHgxIC0geDAsIHkxIC0geTApO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHBvc2l0aW9uIG9mIHIyIHJlbGF0aXZlIHRvIHIxXG4gKiBAcGFyYW0geyFMYXlvdXRSZWN0RGVmfSByMVxuICogQHBhcmFtIHshTGF5b3V0UmVjdERlZn0gcjJcbiAqIEByZXR1cm4ge1JlbGF0aXZlUG9zaXRpb25zfVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGF5b3V0UmVjdHNSZWxhdGl2ZVBvcyhyMSwgcjIpIHtcbiAgaWYgKHIxLnRvcCA8IHIyLnRvcCkge1xuICAgIHJldHVybiBSZWxhdGl2ZVBvc2l0aW9ucy5UT1A7XG4gIH0gZWxzZSBpZiAocjEuYm90dG9tID4gcjIuYm90dG9tKSB7XG4gICAgcmV0dXJuIFJlbGF0aXZlUG9zaXRpb25zLkJPVFRPTTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gUmVsYXRpdmVQb3NpdGlvbnMuSU5TSURFO1xuICB9XG59XG5cbi8qKlxuICogRXhwYW5kIHRoZSBsYXlvdXQgcmVjdCB1c2luZyBtdWx0aXBsZXMgb2Ygd2lkdGggYW5kIGhlaWdodC5cbiAqIEBwYXJhbSB7IUxheW91dFJlY3REZWZ9IHJlY3QgT3JpZ2luYWwgcmVjdC5cbiAqIEBwYXJhbSB7bnVtYmVyfSBkdyBFeHBhbnNpb24gaW4gd2lkdGgsIHNwZWNpZmllZCBhcyBhIG11bHRpcGxlIG9mIHdpZHRoLlxuICogQHBhcmFtIHtudW1iZXJ9IGRoIEV4cGFuc2lvbiBpbiBoZWlnaHQsIHNwZWNpZmllZCBhcyBhIG11bHRpcGxlIG9mIGhlaWdodC5cbiAqIEByZXR1cm4geyFMYXlvdXRSZWN0RGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhwYW5kTGF5b3V0UmVjdChyZWN0LCBkdywgZGgpIHtcbiAgcmV0dXJuIGxheW91dFJlY3RMdHdoKHJlY3QubGVmdCAtIHJlY3Qud2lkdGggKiBkdyxcbiAgICAgIHJlY3QudG9wIC0gcmVjdC5oZWlnaHQgKiBkaCxcbiAgICAgIHJlY3Qud2lkdGggKiAoMSArIGR3ICogMiksXG4gICAgICByZWN0LmhlaWdodCAqICgxICsgZGggKiAyKSk7XG59XG5cbi8qKlxuICogTW92ZXMgdGhlIGxheW91dCByZWN0IHVzaW5nIGR4IGFuZCBkeS5cbiAqIEBwYXJhbSB7IUxheW91dFJlY3REZWZ9IHJlY3QgT3JpZ2luYWwgcmVjdC5cbiAqIEBwYXJhbSB7bnVtYmVyfSBkeCBNb3ZlIGhvcml6b250YWxseSB3aXRoIHRoaXMgdmFsdWUuXG4gKiBAcGFyYW0ge251bWJlcn0gZHkgTW92ZSB2ZXJ0aWNhbGx5IHdpdGggdGhpcyB2YWx1ZS5cbiAqIEByZXR1cm4geyFMYXlvdXRSZWN0RGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gbW92ZUxheW91dFJlY3QocmVjdCwgZHgsIGR5KSB7XG4gIGlmICgoZHggPT0gMCAmJiBkeSA9PSAwKSB8fFxuICAgICAgKHJlY3Qud2lkdGggPT0gMCAmJiByZWN0LmhlaWdodCA9PSAwKSkge1xuICAgIHJldHVybiByZWN0O1xuICB9XG4gIHJldHVybiBsYXlvdXRSZWN0THR3aChyZWN0LmxlZnQgKyBkeCwgcmVjdC50b3AgKyBkeSxcbiAgICAgIHJlY3Qud2lkdGgsIHJlY3QuaGVpZ2h0KTtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IUxheW91dE1hcmdpbnNEZWZ9IG1hcmdpbnNcbiAqIEBwYXJhbSB7IUxheW91dE1hcmdpbnNDaGFuZ2VEZWZ9IGNoYW5nZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFyZU1hcmdpbnNDaGFuZ2VkKG1hcmdpbnMsIGNoYW5nZSkge1xuICByZXR1cm4gKGNoYW5nZS50b3AgIT09IHVuZGVmaW5lZCAmJiBjaGFuZ2UudG9wICE9IG1hcmdpbnMudG9wKSB8fFxuICAgICAgKGNoYW5nZS5yaWdodCAhPT0gdW5kZWZpbmVkICYmIGNoYW5nZS5yaWdodCAhPSBtYXJnaW5zLnJpZ2h0KSB8fFxuICAgICAgKGNoYW5nZS5ib3R0b20gIT09IHVuZGVmaW5lZCAmJiBjaGFuZ2UuYm90dG9tICE9IG1hcmdpbnMuYm90dG9tKSB8fFxuICAgICAgKGNoYW5nZS5sZWZ0ICE9PSB1bmRlZmluZWQgJiYgY2hhbmdlLmxlZnQgIT0gbWFyZ2lucy5sZWZ0KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFMYXlvdXRSZWN0RGVmfSBmcm9tXG4gKiBAcGFyYW0geyFMYXlvdXRSZWN0RGVmfSB0b1xuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxheW91dFJlY3RTaXplRXF1YWxzKGZyb20sIHRvKSB7XG4gIHJldHVybiBmcm9tLndpZHRoID09IHRvLndpZHRoICYmXG4gICAgICBmcm9tLmhlaWdodCA9PT0gdG8uaGVpZ2h0O1xufVxuXG4vKipcbiAqIEBwYXJhbSB7P0xheW91dFJlY3REZWZ9IHIxXG4gKiBAcGFyYW0gez9MYXlvdXRSZWN0RGVmfSByMlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxheW91dFJlY3RFcXVhbHMocjEsIHIyKSB7XG4gIGlmICghcjEgfHwgIXIyKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiByMS5sZWZ0ID09IHIyLmxlZnQgJiYgcjEudG9wID09IHIyLnRvcCAmJlxuICAgICAgcjEud2lkdGggPT0gcjIud2lkdGggJiYgcjEuaGVpZ2h0ID09IHIyLmhlaWdodDtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge0xheW91dE1hcmdpbnNDaGFuZ2VEZWZ8dW5kZWZpbmVkfSBtYXJnaW5zQ2hhbmdlXG4gKiBAcmV0dXJuIHtMYXlvdXRNYXJnaW5zQ2hhbmdlRGVmfHVuZGVmaW5lZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsb25lTGF5b3V0TWFyZ2luc0NoYW5nZURlZihtYXJnaW5zQ2hhbmdlKSB7XG4gIGlmICghbWFyZ2luc0NoYW5nZSkge1xuICAgIHJldHVybiBtYXJnaW5zQ2hhbmdlO1xuICB9XG4gIHJldHVybiB7XG4gICAgdG9wOiBtYXJnaW5zQ2hhbmdlLnRvcCxcbiAgICBib3R0b206IG1hcmdpbnNDaGFuZ2UuYm90dG9tLFxuICAgIGxlZnQ6IG1hcmdpbnNDaGFuZ2UubGVmdCxcbiAgICByaWdodDogbWFyZ2luc0NoYW5nZS5yaWdodCxcbiAgfTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgSW1wbGVtZW50cyBlbGVtZW50IGxheW91dC4gU2VlIGh0dHBzOi8vZ29vLmdsLzlhdlh1VCBmb3JcbiAqIGRldGFpbHMuXG4gKi9cblxuaW1wb3J0IHtkZXYsIHVzZXJ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7aHRtbEZvcn0gZnJvbSAnLi9zdGF0aWMtdGVtcGxhdGUnO1xuaW1wb3J0IHtpc0Zpbml0ZU51bWJlcn0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQge3NldFN0eWxlLCBzZXRTdHlsZXN9IGZyb20gJy4vc3R5bGUnO1xuaW1wb3J0IHtzdGFydHNXaXRofSBmcm9tICcuL3N0cmluZyc7XG5cbi8qKlxuICogQGVudW0ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGNvbnN0IExheW91dCA9IHtcbiAgTk9ESVNQTEFZOiAnbm9kaXNwbGF5JyxcbiAgRklYRUQ6ICdmaXhlZCcsXG4gIEZJWEVEX0hFSUdIVDogJ2ZpeGVkLWhlaWdodCcsXG4gIFJFU1BPTlNJVkU6ICdyZXNwb25zaXZlJyxcbiAgQ09OVEFJTkVSOiAnY29udGFpbmVyJyxcbiAgRklMTDogJ2ZpbGwnLFxuICBGTEVYX0lURU06ICdmbGV4LWl0ZW0nLFxuICBGTFVJRDogJ2ZsdWlkJyxcbiAgSU5UUklOU0lDOiAnaW50cmluc2ljJyxcbn07XG5cblxuLyoqXG4gKiBMYXlvdXQgcHJpb3JpdGllcyB0byB1c2Ugd2l0aCBCYXNlRWxlbWVudCNnZXRMYXlvdXRQcmlvcml0eSgpIGFuZFxuICogQmFzZUVsZW1lbnQjdXBkYXRlTGF5b3V0UHJpb3JpdHkoKS5cbiAqIEBlbnVtIHtudW1iZXJ9XG4gKi9cbmV4cG9ydCBjb25zdCBMYXlvdXRQcmlvcml0eSA9IHtcbiAgQ09OVEVOVDogMCxcbiAgTUVUQURBVEE6IDEsXG4gIEFEUzogMixcbiAgQkFDS0dST1VORDogMyxcbn07XG5cblxuLyoqXG4gKiBDU1MgTGVuZ3RoIHR5cGUuIEUuZy4gXCIxcHhcIiBvciBcIjIwdmhcIi5cbiAqIEB0eXBlZGVmIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBsZXQgTGVuZ3RoRGVmO1xuXG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgd2lkdGg6IHN0cmluZyxcbiAqICAgaGVpZ2h0OiBzdHJpbmdcbiAqIH19XG4gKi9cbmxldCBEaW1lbnNpb25zRGVmO1xuXG5cbi8qKlxuICogVGhlIHNldCBvZiBlbGVtZW50cyB3aXRoIG5hdHVyYWwgZGltZW5zaW9ucywgdGhhdCBpcywgZWxlbWVudHNcbiAqIHdoaWNoIGhhdmUgYSBrbm93biBkaW1lbnNpb24gZWl0aGVyIGJhc2VkIG9uIHRoZWlyIHZhbHVlIHNwZWNpZmllZCBoZXJlLFxuICogb3IsIGlmIHRoZSB2YWx1ZSBpcyBudWxsLCBhIGRpbWVuc2lvbiBzcGVjaWZpYyB0byB0aGUgYnJvd3Nlci5cbiAqIGBoYXNOYXR1cmFsRGltZW5zaW9uc2AgY2hlY2tzIGZvciBtZW1iZXJzaGlwIGluIHRoaXMgc2V0LlxuICogYGdldE5hdHVyYWxEaW1lbnNpb25zYCBkZXRlcm1pbmVzIHRoZSBkaW1lbnNpb25zIGZvciBhbiBlbGVtZW50IGluIHRoZVxuICogICAgc2V0IGFuZCBjYWNoZXMgaXQuXG4gKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsID9EaW1lbnNpb25zRGVmPn1cbiAqIEBwcml2YXRlICBWaXNpYmxlIGZvciB0ZXN0aW5nIG9ubHkhXG4gKi9cbmV4cG9ydCBjb25zdCBuYXR1cmFsRGltZW5zaW9uc18gPSB7XG4gICdBTVAtUElYRUwnOiB7d2lkdGg6ICcwcHgnLCBoZWlnaHQ6ICcwcHgnfSxcbiAgJ0FNUC1BTkFMWVRJQ1MnOiB7d2lkdGg6ICcxcHgnLCBoZWlnaHQ6ICcxcHgnfSxcbiAgLy8gVE9ETyhkdm95dGVua28pOiBhdWRpbyBzaG91bGQgaGF2ZSB3aWR0aDphdXRvLlxuICAnQU1QLUFVRElPJzogbnVsbCxcbiAgJ0FNUC1TT0NJQUwtU0hBUkUnOiB7d2lkdGg6ICc2MHB4JywgaGVpZ2h0OiAnNDRweCd9LFxufTtcblxuXG4vKipcbiAqIEVsZW1lbnRzIHRoYXQgdGhlIHByb2dlc3MgY2FuIGJlIHNob3duIGZvci4gVGhpcyBzZXQgaGFzIHRvIGJlIGV4dGVybmFsaXplZFxuICogc2luY2UgdGhlIGVsZW1lbnQncyBpbXBsZW1lbnRhdGlvbiBtYXkgbm90IGJlIGRvd25sb2FkZWQgeWV0LlxuICogQGVudW0ge2Jvb2xlYW59XG4gKiBAcHJpdmF0ZSAgVmlzaWJsZSBmb3IgdGVzdGluZyBvbmx5IVxuICovXG5leHBvcnQgY29uc3QgTE9BRElOR19FTEVNRU5UU18gPSB7XG4gICdBTVAtQU5JTSc6IHRydWUsXG4gICdBTVAtQlJJR0hUQ09WRSc6IHRydWUsXG4gICdBTVAtR09PR0xFLURPQ1VNRU5ULUVNQkVEJzogdHJ1ZSxcbiAgJ0FNUC1FTUJFRCc6IHRydWUsXG4gICdBTVAtRkFDRUJPT0snOiB0cnVlLFxuICAnQU1QLUZBQ0VCT09LLUNPTU1FTlRTJzogdHJ1ZSxcbiAgJ0FNUC1GQUNFQk9PSy1MSUtFJzogdHJ1ZSxcbiAgJ0FNUC1GQUNFQk9PSy1QQUdFJzogdHJ1ZSxcbiAgJ0FNUC1JRlJBTUUnOiB0cnVlLFxuICAnQU1QLUlNRyc6IHRydWUsXG4gICdBTVAtSU5TVEFHUkFNJzogdHJ1ZSxcbiAgJ0FNUC1MSVNUJzogdHJ1ZSxcbiAgJ0FNUC1PT1lBTEEtUExBWUVSJzogdHJ1ZSxcbiAgJ0FNUC1QSU5URVJFU1QnOiB0cnVlLFxuICAnQU1QLVBMQVlCVVpaJzogdHJ1ZSxcbiAgJ0FNUC1WSURFTyc6IHRydWUsXG4gICdBTVAtWU9VVFVCRSc6IHRydWUsXG59O1xuXG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IHNcbiAqIEByZXR1cm4ge0xheW91dHx1bmRlZmluZWR9IFJldHVybnMgdW5kZWZpbmVkIGluIGNhc2Ugb2YgZmFpbHVyZSB0byBwYXJzZVxuICogICB0aGUgbGF5b3V0IHN0cmluZy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlTGF5b3V0KHMpIHtcbiAgZm9yIChjb25zdCBrIGluIExheW91dCkge1xuICAgIGlmIChMYXlvdXRba10gPT0gcykge1xuICAgICAgcmV0dXJuIExheW91dFtrXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IUxheW91dH0gbGF5b3V0XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRMYXlvdXRDbGFzcyhsYXlvdXQpIHtcbiAgcmV0dXJuICdpLWFtcGh0bWwtbGF5b3V0LScgKyBsYXlvdXQ7XG59XG5cblxuLyoqXG4gKiBXaGV0aGVyIGFuIGVsZW1lbnQgd2l0aCB0aGlzIGxheW91dCBpbmhlcmVudGx5IGRlZmluZXMgdGhlIHNpemUuXG4gKiBAcGFyYW0geyFMYXlvdXR9IGxheW91dFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTGF5b3V0U2l6ZURlZmluZWQobGF5b3V0KSB7XG4gIHJldHVybiAobGF5b3V0ID09IExheW91dC5GSVhFRCB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5GSVhFRF9IRUlHSFQgfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuUkVTUE9OU0lWRSB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5GSUxMIHx8XG4gICAgICBsYXlvdXQgPT0gTGF5b3V0LkZMRVhfSVRFTSB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5GTFVJRCB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5JTlRSSU5TSUMpO1xufVxuXG5cbi8qKlxuICogV2hldGhlciB0aGUgdGFnIGlzIGFuIGludGVybmFsIChzZXJ2aWNlKSBBTVAgdGFnLlxuICogQHBhcmFtIHshTm9kZXxzdHJpbmd9IHRhZ1xuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzSW50ZXJuYWxFbGVtZW50KHRhZykge1xuICBjb25zdCB0YWdOYW1lID0gKHR5cGVvZiB0YWcgPT0gJ3N0cmluZycpID8gdGFnIDogdGFnLnRhZ05hbWU7XG4gIHJldHVybiB0YWdOYW1lICYmIHN0YXJ0c1dpdGgodGFnTmFtZS50b0xvd2VyQ2FzZSgpLCAnaS0nKTtcbn1cblxuXG4vKipcbiAqIFBhcnNlcyB0aGUgQ1NTIGxlbmd0aCB2YWx1ZS4gSWYgbm8gdW5pdHMgc3BlY2lmaWVkLCB0aGUgYXNzdW1lZCB2YWx1ZSBpc1xuICogXCJweFwiLiBSZXR1cm5zIHVuZGVmaW5lZCBpbiBjYXNlIG9mIHBhcnNpbmcgZXJyb3IuXG4gKiBAcGFyYW0ge3N0cmluZ3x1bmRlZmluZWR8bnVsbH0gc1xuICogQHJldHVybiB7IUxlbmd0aERlZnx1bmRlZmluZWR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUxlbmd0aChzKSB7XG4gIGlmICh0eXBlb2YgcyA9PSAnbnVtYmVyJykge1xuICAgIHJldHVybiBzICsgJ3B4JztcbiAgfVxuICBpZiAoIXMpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIGlmICghL15cXGQrKFxcLlxcZCspPyhweHxlbXxyZW18dmh8dnd8dm1pbnx2bWF4fGNtfG1tfHF8aW58cGN8cHQpPyQvLnRlc3QocykpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIGlmICgvXlxcZCsoXFwuXFxkKyk/JC8udGVzdChzKSkge1xuICAgIHJldHVybiBzICsgJ3B4JztcbiAgfVxuICByZXR1cm4gcztcbn1cblxuXG5cbi8qKlxuICogQXNzZXJ0cyB0aGF0IHRoZSBzdXBwbGllZCB2YWx1ZSBpcyBhIG5vbi1wZXJjZW50IENTUyBMZW5ndGggdmFsdWUuXG4gKiBAcGFyYW0geyFMZW5ndGhEZWZ8c3RyaW5nfG51bGx8dW5kZWZpbmVkfSBsZW5ndGhcbiAqIEByZXR1cm4geyFMZW5ndGhEZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRMZW5ndGgobGVuZ3RoKSB7XG4gIHVzZXIoKS5hc3NlcnQoXG4gICAgICAvXlxcZCsoXFwuXFxkKyk/KHB4fGVtfHJlbXx2aHx2d3x2bWlufHZtYXh8Y218bW18cXxpbnxwY3xwdCkkLy50ZXN0KGxlbmd0aCksXG4gICAgICAnSW52YWxpZCBsZW5ndGggdmFsdWU6ICVzJywgbGVuZ3RoKTtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IUxlbmd0aERlZn0gKi8gKGxlbmd0aCk7XG59XG5cblxuXG5cbi8qKlxuICogQXNzZXJ0cyB0aGF0IHRoZSBzdXBwbGllZCB2YWx1ZSBpcyBhIENTUyBMZW5ndGggdmFsdWVcbiAqIChpbmNsdWRpbmcgcGVyY2VudCB1bml0KS5cbiAqIEBwYXJhbSB7IUxlbmd0aERlZnxzdHJpbmd9IGxlbmd0aFxuICogQHJldHVybiB7IUxlbmd0aERlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydExlbmd0aE9yUGVyY2VudChsZW5ndGgpIHtcbiAgdXNlcigpLmFzc2VydCgvXlxcZCsoXFwuXFxkKyk/KHB4fGVtfHJlbXx2aHx2d3x2bWlufHZtYXh8JSkkLy50ZXN0KGxlbmd0aCksXG4gICAgICAnSW52YWxpZCBsZW5ndGggb3IgcGVyY2VudCB2YWx1ZTogJXMnLCBsZW5ndGgpO1xuICByZXR1cm4gbGVuZ3RoO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyB1bml0cyBmcm9tIHRoZSBDU1MgbGVuZ3RoIHZhbHVlLlxuICogQHBhcmFtIHshTGVuZ3RoRGVmfHN0cmluZ3xudWxsfHVuZGVmaW5lZH0gbGVuZ3RoXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRMZW5ndGhVbml0cyhsZW5ndGgpIHtcbiAgYXNzZXJ0TGVuZ3RoKGxlbmd0aCk7XG4gIGRldigpLmFzc2VydFN0cmluZyhsZW5ndGgpO1xuICBjb25zdCBtID0gdXNlcigpLmFzc2VydChsZW5ndGgubWF0Y2goL1thLXpdKy9pKSxcbiAgICAgICdGYWlsZWQgdG8gcmVhZCB1bml0cyBmcm9tICVzJywgbGVuZ3RoKTtcbiAgcmV0dXJuIG1bMF07XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBudW1lcmljIHZhbHVlIG9mIGEgQ1NTIGxlbmd0aCB2YWx1ZS5cbiAqIEBwYXJhbSB7IUxlbmd0aERlZnxzdHJpbmd8bnVsbHx1bmRlZmluZWR9IGxlbmd0aFxuICogQHJldHVybiB7bnVtYmVyfHVuZGVmaW5lZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExlbmd0aE51bWVyYWwobGVuZ3RoKSB7XG4gIGNvbnN0IHJlcyA9IHBhcnNlRmxvYXQobGVuZ3RoKTtcbiAgcmV0dXJuIGlzRmluaXRlTnVtYmVyKHJlcykgPyByZXMgOiB1bmRlZmluZWQ7XG59XG5cblxuLyoqXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIHRhZ05hbWUgaXMgYSBrbm93biBlbGVtZW50IHRoYXQgaGFzIG5hdHVyYWwgZGltZW5zaW9uc1xuICogaW4gb3VyIHJ1bnRpbWUgb3IgdGhlIGJyb3dzZXIuXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZSBUaGUgZWxlbWVudCB0YWcgbmFtZS5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoYXNOYXR1cmFsRGltZW5zaW9ucyh0YWdOYW1lKSB7XG4gIHRhZ05hbWUgPSB0YWdOYW1lLnRvVXBwZXJDYXNlKCk7XG4gIHJldHVybiBuYXR1cmFsRGltZW5zaW9uc19bdGFnTmFtZV0gIT09IHVuZGVmaW5lZDtcbn1cblxuXG4vKipcbiAqIERldGVybWluZXMgdGhlIGRlZmF1bHQgZGltZW5zaW9ucyBmb3IgYW4gZWxlbWVudCB3aGljaCBjb3VsZCB2YXJ5IGFjcm9zc1xuICogZGlmZmVyZW50IGJyb3dzZXIgaW1wbGVtZW50YXRpb25zLCBsaWtlIDxhdWRpbz4gZm9yIGluc3RhbmNlLlxuICogVGhpcyBvcGVyYXRpb24gY2FuIG9ubHkgYmUgY29tcGxldGVkIGZvciBhbiBlbGVtZW50IHdoaXRlbGlzdGVkIGJ5XG4gKiBgaGFzTmF0dXJhbERpbWVuc2lvbnNgLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7RGltZW5zaW9uc0RlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE5hdHVyYWxEaW1lbnNpb25zKGVsZW1lbnQpIHtcbiAgY29uc3QgdGFnTmFtZSA9IGVsZW1lbnQudGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xuICBkZXYoKS5hc3NlcnQobmF0dXJhbERpbWVuc2lvbnNfW3RhZ05hbWVdICE9PSB1bmRlZmluZWQpO1xuICBpZiAoIW5hdHVyYWxEaW1lbnNpb25zX1t0YWdOYW1lXSkge1xuICAgIGNvbnN0IGRvYyA9IGVsZW1lbnQub3duZXJEb2N1bWVudDtcbiAgICBjb25zdCBuYXR1cmFsVGFnTmFtZSA9IHRhZ05hbWUucmVwbGFjZSgvXkFNUFxcLS8sICcnKTtcbiAgICBjb25zdCB0ZW1wID0gZG9jLmNyZWF0ZUVsZW1lbnQobmF0dXJhbFRhZ05hbWUpO1xuICAgIC8vIEZvciBhdWRpbywgc2hvdWxkIG5vLW9wIGVsc2V3aGVyZS5cbiAgICB0ZW1wLmNvbnRyb2xzID0gdHJ1ZTtcbiAgICBzZXRTdHlsZXModGVtcCwge1xuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICB2aXNpYmlsaXR5OiAnaGlkZGVuJyxcbiAgICB9KTtcbiAgICBkb2MuYm9keS5hcHBlbmRDaGlsZCh0ZW1wKTtcbiAgICBuYXR1cmFsRGltZW5zaW9uc19bdGFnTmFtZV0gPSB7XG4gICAgICB3aWR0aDogKHRlbXAuLypPSyovb2Zmc2V0V2lkdGggfHwgMSkgKyAncHgnLFxuICAgICAgaGVpZ2h0OiAodGVtcC4vKk9LKi9vZmZzZXRIZWlnaHQgfHwgMSkgKyAncHgnLFxuICAgIH07XG4gICAgZG9jLmJvZHkucmVtb3ZlQ2hpbGQodGVtcCk7XG4gIH1cbiAgcmV0dXJuIC8qKiBAdHlwZSB7RGltZW5zaW9uc0RlZn0gKi8gKG5hdHVyYWxEaW1lbnNpb25zX1t0YWdOYW1lXSk7XG59XG5cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBsb2FkaW5nIGNhbiBiZSBzaG93biBmb3IgdGhlIHNwZWNpZmllZCBlbGVtZWVudC4gVGhpcyBzZXQgaGFzXG4gKiB0byBiZSBleHRlcm5hbGl6ZWQgc2luY2UgdGhlIGVsZW1lbnQncyBpbXBsZW1lbnRhdGlvbiBtYXkgbm90IGJlXG4gKiBkb3dubG9hZGVkIHlldC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvYWRpbmdBbGxvd2VkKGVsZW1lbnQpIHtcbiAgY29uc3QgdGFnTmFtZSA9IGVsZW1lbnQudGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xuICBpZiAodGFnTmFtZSA9PSAnQU1QLUFEJyB8fCB0YWdOYW1lID09ICdBTVAtRU1CRUQnKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIExPQURJTkdfRUxFTUVOVFNfW3RhZ05hbWVdIHx8IGZhbHNlO1xufVxuXG5cbi8qKlxuICogQXBwbGllcyBsYXlvdXQgdG8gdGhlIGVsZW1lbnQuIFZpc2libGUgZm9yIHRlc3Rpbmcgb25seS5cbiAqXG4gKiBcXCAgIFxcICAvICBcXCAgLyAgIC8gLyAgIFxcICAgICB8ICAgXyAgXFwgICAgIHwgIFxcIHwgIHwgfCAgfCB8ICBcXCB8ICB8ICAvIF9fX19ffFxuICogIFxcICAgXFwvICAgIFxcLyAgIC8gLyAgXiAgXFwgICAgfCAgfF8pICB8ICAgIHwgICBcXHwgIHwgfCAgfCB8ICAgXFx8ICB8IHwgIHwgIF9fXG4gKiAgIFxcICAgICAgICAgICAgLyAvICAvX1xcICBcXCAgIHwgICAgICAvICAgICB8ICAuIGAgIHwgfCAgfCB8ICAuIGAgIHwgfCAgfCB8XyB8XG4gKiAgICBcXCAgICAvXFwgICAgLyAvICBfX19fXyAgXFwgIHwgIHxcXCAgXFwtLS0tLnwgIHxcXCAgIHwgfCAgfCB8ICB8XFwgICB8IHwgIHxfX3wgfFxuICogICAgIFxcX18vICBcXF9fLyAvX18vICAgICBcXF9fXFwgfCBffCBgLl9fX19ffHxfX3wgXFxfX3wgfF9ffCB8X198IFxcX198ICBcXF9fX19fX3xcbiAqXG4gKiBUaGUgZXF1aXZhbGVudCBvZiB0aGlzIG1ldGhvZCBpcyB1c2VkIGZvciBzZXJ2ZXItc2lkZSByZW5kZXJpbmcgKFNTUikgYW5kXG4gKiBhbnkgY2hhbmdlcyBtYWRlIHRvIGl0IG11c3QgYmUgbWFkZSBpbiBjb29yZGluYXRpb24gd2l0aCBjYWNoZXMgdGhhdFxuICogaW1wbGVtZW50IFNTUi4gRm9yIG1vcmUgaW5mb3JtYXRpb24gb24gU1NSIHNlZSBiaXQubHkvYW1wLXNzci5cbiAqXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHshTGF5b3V0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlTdGF0aWNMYXlvdXQoZWxlbWVudCkge1xuICAvLyBDaGVjayBpZiB0aGUgbGF5b3V0IGhhcyBhbHJlYWR5IGJlZW4gZG9uZSBieSBzZXJ2ZXItc2lkZSByZW5kZXJpbmcuIFRoZVxuICAvLyBkb2N1bWVudCBtYXkgYmUgdmlzaWJsZSB0byB0aGUgdXNlciBpZiB0aGUgYm9pbGVycGxhdGUgd2FzIHJlbW92ZWQgc29cbiAgLy8gcGxlYXNlIHRha2UgY2FyZSBpbiBtYWtpbmcgY2hhbmdlcyBoZXJlLlxuICBjb25zdCBjb21wbGV0ZWRMYXlvdXRBdHRyID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2ktYW1waHRtbC1sYXlvdXQnKTtcbiAgaWYgKGNvbXBsZXRlZExheW91dEF0dHIpIHtcbiAgICBjb25zdCBsYXlvdXQgPSAvKiogQHR5cGUgeyFMYXlvdXR9ICovIChkZXYoKS5hc3NlcnQoXG4gICAgICAgIHBhcnNlTGF5b3V0KGNvbXBsZXRlZExheW91dEF0dHIpKSk7XG4gICAgaWYgKChsYXlvdXQgPT0gTGF5b3V0LlJFU1BPTlNJVkUgfHwgbGF5b3V0ID09IExheW91dC5JTlRSSU5TSUMpXG4gICAgICAmJiBlbGVtZW50LmZpcnN0RWxlbWVudENoaWxkKSB7XG4gICAgICAvLyBGaW5kIHNpemVyLCBidXQgYXNzdW1lIHRoYXQgaXQgbWlnaHQgbm90IGhhdmUgYmVlbiBwYXJzZWQgeWV0LlxuICAgICAgZWxlbWVudC5zaXplckVsZW1lbnQgPVxuICAgICAgICAgIGVsZW1lbnQucXVlcnlTZWxlY3RvcignaS1hbXBodG1sLXNpemVyJykgfHwgdW5kZWZpbmVkO1xuICAgIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5OT0RJU1BMQVkpIHtcbiAgICAgIGFwcGx5Tm9EaXNwbGF5TGF5b3V0KGVsZW1lbnQpO1xuICAgIH1cbiAgICByZXR1cm4gbGF5b3V0O1xuICB9XG5cbiAgLy8gSWYgdGhlIGxheW91dCB3YXMgYWxyZWFkeSBkb25lIGJ5IHNlcnZlci1zaWRlIHJlbmRlcmluZyAoU1NSKSwgdGhlbiB0aGVcbiAgLy8gY29kZSBiZWxvdyB3aWxsIG5vdCBydW4uIEFueSBjaGFuZ2VzIGJlbG93IHdpbGwgbmVjZXNzaXRhdGUgYSBjaGFuZ2UgdG8gU1NSXG4gIC8vIGFuZCBtdXN0IGJlIGNvb3JkaW5hdGVkIHdpdGggY2FjaGVzIHRoYXQgaW1wbGVtZW50IFNTUi4gU2VlIGJpdC5seS9hbXAtc3NyLlxuXG4gIC8vIFBhcnNlIGxheW91dCBmcm9tIHRoZSBlbGVtZW50LlxuICBjb25zdCBsYXlvdXRBdHRyID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2xheW91dCcpO1xuICBjb25zdCB3aWR0aEF0dHIgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnd2lkdGgnKTtcbiAgY29uc3QgaGVpZ2h0QXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdoZWlnaHQnKTtcbiAgY29uc3Qgc2l6ZXNBdHRyID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3NpemVzJyk7XG4gIGNvbnN0IGhlaWdodHNBdHRyID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2hlaWdodHMnKTtcblxuICAvLyBJbnB1dCBsYXlvdXQgYXR0cmlidXRlcy5cbiAgY29uc3QgaW5wdXRMYXlvdXQgPSBsYXlvdXRBdHRyID8gcGFyc2VMYXlvdXQobGF5b3V0QXR0cikgOiBudWxsO1xuICB1c2VyKCkuYXNzZXJ0KGlucHV0TGF5b3V0ICE9PSB1bmRlZmluZWQsICdVbmtub3duIGxheW91dDogJXMnLCBsYXlvdXRBdHRyKTtcbiAgLyoqIEBjb25zdCB7c3RyaW5nfG51bGx8dW5kZWZpbmVkfSAqL1xuICBjb25zdCBpbnB1dFdpZHRoID0gKHdpZHRoQXR0ciAmJiB3aWR0aEF0dHIgIT0gJ2F1dG8nKSA/XG4gICAgcGFyc2VMZW5ndGgod2lkdGhBdHRyKSA6IHdpZHRoQXR0cjtcbiAgdXNlcigpLmFzc2VydChpbnB1dFdpZHRoICE9PSB1bmRlZmluZWQsICdJbnZhbGlkIHdpZHRoIHZhbHVlOiAlcycsIHdpZHRoQXR0cik7XG4gIC8qKiBAY29uc3Qge3N0cmluZ3xudWxsfHVuZGVmaW5lZH0gKi9cbiAgY29uc3QgaW5wdXRIZWlnaHQgPSAoaGVpZ2h0QXR0ciAmJiBoZWlnaHRBdHRyICE9ICdmbHVpZCcpID9cbiAgICBwYXJzZUxlbmd0aChoZWlnaHRBdHRyKSA6IGhlaWdodEF0dHI7XG4gIHVzZXIoKS5hc3NlcnQoaW5wdXRIZWlnaHQgIT09IHVuZGVmaW5lZCwgJ0ludmFsaWQgaGVpZ2h0IHZhbHVlOiAlcycsXG4gICAgICBoZWlnaHRBdHRyKTtcblxuICAvLyBFZmZlY3RpdmUgbGF5b3V0IGF0dHJpYnV0ZXMuIFRoZXNlIGFyZSBlZmZlY3RpdmVseSBjb25zdGFudHMuXG4gIGxldCB3aWR0aDtcbiAgbGV0IGhlaWdodDtcbiAgbGV0IGxheW91dDtcblxuICAvLyBDYWxjdWxhdGUgZWZmZWN0aXZlIHdpZHRoIGFuZCBoZWlnaHQuXG4gIGlmICgoIWlucHV0TGF5b3V0IHx8IGlucHV0TGF5b3V0ID09IExheW91dC5GSVhFRCB8fFxuICAgICAgaW5wdXRMYXlvdXQgPT0gTGF5b3V0LkZJWEVEX0hFSUdIVCkgJiZcbiAgICAgICghaW5wdXRXaWR0aCB8fCAhaW5wdXRIZWlnaHQpICYmIGhhc05hdHVyYWxEaW1lbnNpb25zKGVsZW1lbnQudGFnTmFtZSkpIHtcbiAgICAvLyBEZWZhdWx0IHdpZHRoIGFuZCBoZWlnaHQ6IGhhbmRsZSBlbGVtZW50cyB0aGF0IGRvIG5vdCBzcGVjaWZ5IGFcbiAgICAvLyB3aWR0aC9oZWlnaHQgYW5kIGFyZSBkZWZpbmVkIHRvIGhhdmUgbmF0dXJhbCBicm93c2VyIGRpbWVuc2lvbnMuXG4gICAgY29uc3QgZGltZW5zaW9ucyA9IGdldE5hdHVyYWxEaW1lbnNpb25zKGVsZW1lbnQpO1xuICAgIHdpZHRoID0gKGlucHV0V2lkdGggfHwgaW5wdXRMYXlvdXQgPT0gTGF5b3V0LkZJWEVEX0hFSUdIVCkgPyBpbnB1dFdpZHRoIDpcbiAgICAgIGRpbWVuc2lvbnMud2lkdGg7XG4gICAgaGVpZ2h0ID0gaW5wdXRIZWlnaHQgfHwgZGltZW5zaW9ucy5oZWlnaHQ7XG4gIH0gZWxzZSB7XG4gICAgd2lkdGggPSBpbnB1dFdpZHRoO1xuICAgIGhlaWdodCA9IGlucHV0SGVpZ2h0O1xuICB9XG5cbiAgLy8gQ2FsY3VsYXRlIGVmZmVjdGl2ZSBsYXlvdXQuXG4gIGlmIChpbnB1dExheW91dCkge1xuICAgIGxheW91dCA9IGlucHV0TGF5b3V0O1xuICB9IGVsc2UgaWYgKCF3aWR0aCAmJiAhaGVpZ2h0KSB7XG4gICAgbGF5b3V0ID0gTGF5b3V0LkNPTlRBSU5FUjtcbiAgfSBlbHNlIGlmIChoZWlnaHQgPT0gJ2ZsdWlkJykge1xuICAgIGxheW91dCA9IExheW91dC5GTFVJRDtcbiAgfSBlbHNlIGlmIChoZWlnaHQgJiYgKCF3aWR0aCB8fCB3aWR0aCA9PSAnYXV0bycpKSB7XG4gICAgbGF5b3V0ID0gTGF5b3V0LkZJWEVEX0hFSUdIVDtcbiAgfSBlbHNlIGlmIChoZWlnaHQgJiYgd2lkdGggJiYgKHNpemVzQXR0ciB8fCBoZWlnaHRzQXR0cikpIHtcbiAgICBsYXlvdXQgPSBMYXlvdXQuUkVTUE9OU0lWRTtcbiAgfSBlbHNlIHtcbiAgICBsYXlvdXQgPSBMYXlvdXQuRklYRUQ7XG4gIH1cblxuICAvLyBWZXJpZnkgbGF5b3V0IGF0dHJpYnV0ZXMuXG4gIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZJWEVEIHx8IGxheW91dCA9PSBMYXlvdXQuRklYRURfSEVJR0hUIHx8XG4gICAgICBsYXlvdXQgPT0gTGF5b3V0LlJFU1BPTlNJVkUgfHwgbGF5b3V0ID09IExheW91dC5JTlRSSU5TSUMpIHtcbiAgICB1c2VyKCkuYXNzZXJ0KGhlaWdodCwgJ0V4cGVjdGVkIGhlaWdodCB0byBiZSBhdmFpbGFibGU6ICVzJywgaGVpZ2h0QXR0cik7XG4gIH1cbiAgaWYgKGxheW91dCA9PSBMYXlvdXQuRklYRURfSEVJR0hUKSB7XG4gICAgdXNlcigpLmFzc2VydCghd2lkdGggfHwgd2lkdGggPT0gJ2F1dG8nLFxuICAgICAgICAnRXhwZWN0ZWQgd2lkdGggdG8gYmUgZWl0aGVyIGFic2VudCBvciBlcXVhbCBcImF1dG9cIiAnICtcbiAgICAgICAgJ2ZvciBmaXhlZC1oZWlnaHQgbGF5b3V0OiAlcycsIHdpZHRoQXR0cik7XG4gIH1cbiAgaWYgKGxheW91dCA9PSBMYXlvdXQuRklYRUQgfHwgbGF5b3V0ID09IExheW91dC5SRVNQT05TSVZFIHx8XG4gICAgICBsYXlvdXQgPT0gTGF5b3V0LklOVFJJTlNJQykge1xuICAgIHVzZXIoKS5hc3NlcnQod2lkdGggJiYgd2lkdGggIT0gJ2F1dG8nLFxuICAgICAgICAnRXhwZWN0ZWQgd2lkdGggdG8gYmUgYXZhaWxhYmxlIGFuZCBub3QgZXF1YWwgdG8gXCJhdXRvXCI6ICVzJyxcbiAgICAgICAgd2lkdGhBdHRyKTtcbiAgfVxuXG4gIGlmIChsYXlvdXQgPT0gTGF5b3V0LlJFU1BPTlNJVkUgfHwgbGF5b3V0ID09IExheW91dC5JTlRSSU5TSUMpIHtcbiAgICB1c2VyKCkuYXNzZXJ0KGdldExlbmd0aFVuaXRzKHdpZHRoKSA9PSBnZXRMZW5ndGhVbml0cyhoZWlnaHQpLFxuICAgICAgICAnTGVuZ3RoIHVuaXRzIHNob3VsZCBiZSB0aGUgc2FtZSBmb3Igd2lkdGggYW5kIGhlaWdodDogJXMsICVzJyxcbiAgICAgICAgd2lkdGhBdHRyLCBoZWlnaHRBdHRyKTtcbiAgfSBlbHNlIHtcbiAgICB1c2VyKCkuYXNzZXJ0KGhlaWdodHNBdHRyID09PSBudWxsLFxuICAgICAgICAnVW5leHBlY3RlZCBcImhlaWdodHNcIiBhdHRyaWJ1dGUgZm9yIG5vbmUtcmVzcG9uc2l2ZSBsYXlvdXQnKTtcbiAgfVxuXG4gIC8vIEFwcGx5IFVJLlxuICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoZ2V0TGF5b3V0Q2xhc3MobGF5b3V0KSk7XG4gIGlmIChpc0xheW91dFNpemVEZWZpbmVkKGxheW91dCkpIHtcbiAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2ktYW1waHRtbC1sYXlvdXQtc2l6ZS1kZWZpbmVkJyk7XG4gIH1cbiAgaWYgKGxheW91dCA9PSBMYXlvdXQuTk9ESVNQTEFZKSB7XG4gICAgLy8gQ1NTIGRlZmluZXMgbGF5b3V0PW5vZGlzcGxheSBhdXRvbWF0aWNhbGx5IHdpdGggYGRpc3BsYXk6bm9uZWAuIFRodXNcbiAgICAvLyBubyBhZGRpdGlvbmFsIHN0eWxpbmcgaXMgbmVlZGVkLlxuICAgIGFwcGx5Tm9EaXNwbGF5TGF5b3V0KGVsZW1lbnQpO1xuICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuRklYRUQpIHtcbiAgICBzZXRTdHlsZXMoZWxlbWVudCwge1xuICAgICAgd2lkdGg6IGRldigpLmFzc2VydFN0cmluZyh3aWR0aCksXG4gICAgICBoZWlnaHQ6IGRldigpLmFzc2VydFN0cmluZyhoZWlnaHQpLFxuICAgIH0pO1xuICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuRklYRURfSEVJR0hUKSB7XG4gICAgc2V0U3R5bGUoZWxlbWVudCwgJ2hlaWdodCcsIGRldigpLmFzc2VydFN0cmluZyhoZWlnaHQpKTtcbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LlJFU1BPTlNJVkUpIHtcbiAgICBjb25zdCBzaXplciA9IGVsZW1lbnQub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpLWFtcGh0bWwtc2l6ZXInKTtcbiAgICBzZXRTdHlsZXMoc2l6ZXIsIHtcbiAgICAgIGRpc3BsYXk6ICdibG9jaycsXG4gICAgICBwYWRkaW5nVG9wOlxuICAgICAgICAoKGdldExlbmd0aE51bWVyYWwoaGVpZ2h0KSAvIGdldExlbmd0aE51bWVyYWwod2lkdGgpKSAqIDEwMCkgKyAnJScsXG4gICAgfSk7XG4gICAgZWxlbWVudC5pbnNlcnRCZWZvcmUoc2l6ZXIsIGVsZW1lbnQuZmlyc3RDaGlsZCk7XG4gICAgZWxlbWVudC5zaXplckVsZW1lbnQgPSBzaXplcjtcbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LklOVFJJTlNJQykge1xuICAgIC8vIEludHJpbnNpYyB1c2VzIGFuIHN2ZyBpbnNpZGUgdGhlIHNpemVyIGVsZW1lbnQgcmF0aGVyIHRoYW4gdGhlIHBhZGRpbmdcbiAgICAvLyB0cmljayBOb3RlIGEgbmFrZWQgc3ZnIHdvbid0IHdvcmsgYmVjYXN1ZSBvdGhlciB0aGluZyBleHBlY3QgdGhlXG4gICAgLy8gaS1hbXBodG1sLXNpemVyIGVsZW1lbnRcbiAgICBjb25zdCBzaXplciA9IGh0bWxGb3IoZWxlbWVudClgXG4gICAgICA8aS1hbXBodG1sLXNpemVyIGNsYXNzPVwiaS1hbXBodG1sLXNpemVyXCI+XG4gICAgICAgIDxpbWcgY2xhc3M9XCJpLWFtcGh0bWwtaW50cmluc2ljLXNpemVyXCIgLz5cbiAgICAgIDwvaS1hbXBodG1sLXNpemVyPmA7XG4gICAgY29uc3QgaW50cmluc2ljU2l6ZXIgPSBzaXplci5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICBpbnRyaW5zaWNTaXplci5zZXRBdHRyaWJ1dGUoJ3NyYycsXG4gICAgICAgIGBkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCw8c3ZnIGhlaWdodD1cIiR7aGVpZ2h0fVwiIHdpZHRoPVwiJHt3aWR0aH1cIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmVyc2lvbj1cIjEuMVwiLz5gKTtcbiAgICBlbGVtZW50Lmluc2VydEJlZm9yZShzaXplciwgZWxlbWVudC5maXJzdENoaWxkKTtcbiAgICAvLyBUT0RPKGpwZXR0aXR0KTogc2l6ZXIgaXMgbGVha2VkIGFuZCBjYW4ndCBiZSBjbGVhbmVkIHVwLlxuICAgIGVsZW1lbnQuc2l6ZXJFbGVtZW50ID0gaW50cmluc2ljU2l6ZXI7XG4gIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5GSUxMKSB7XG4gICAgLy8gRG8gbm90aGluZy5cbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LkNPTlRBSU5FUikge1xuICAgIC8vIERvIG5vdGhpbmcuIEVsZW1lbnRzIHRoZW1zZWx2ZXMgd2lsbCBjaGVjayB3aGV0aGVyIHRoZSBzdXBwbGllZFxuICAgIC8vIGxheW91dCB2YWx1ZSBpcyBhY2NlcHRhYmxlLiBJbiBwYXJ0aWN1bGFyIGNvbnRhaW5lciBpcyBvbmx5IE9LXG4gICAgLy8gc29tZXRpbWVzLlxuICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuRkxFWF9JVEVNKSB7XG4gICAgLy8gU2V0IGhlaWdodCBhbmQgd2lkdGggdG8gYSBmbGV4IGl0ZW0gaWYgdGhleSBleGlzdC5cbiAgICAvLyBUaGUgc2l6ZSBzZXQgdG8gYSBmbGV4IGl0ZW0gY291bGQgYmUgb3ZlcnJpZGRlbiBieSBgZGlzcGxheTogZmxleGAgbGF0ZXIuXG4gICAgaWYgKHdpZHRoKSB7XG4gICAgICBzZXRTdHlsZShlbGVtZW50LCAnd2lkdGgnLCB3aWR0aCk7XG4gICAgfVxuICAgIGlmIChoZWlnaHQpIHtcbiAgICAgIHNldFN0eWxlKGVsZW1lbnQsICdoZWlnaHQnLCBoZWlnaHQpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZMVUlEKSB7XG4gICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdpLWFtcGh0bWwtbGF5b3V0LWF3YWl0aW5nLXNpemUnKTtcbiAgICBpZiAod2lkdGgpIHtcbiAgICAgIHNldFN0eWxlKGVsZW1lbnQsICd3aWR0aCcsIHdpZHRoKTtcbiAgICB9XG4gICAgc2V0U3R5bGUoZWxlbWVudCwgJ2hlaWdodCcsIDApO1xuICB9XG4gIHJldHVybiBsYXlvdXQ7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKi9cbmZ1bmN0aW9uIGFwcGx5Tm9EaXNwbGF5TGF5b3V0KGVsZW1lbnQpIHtcbiAgLy8gVE9ETyhkdm95dGVua28sICM5MzUzKTogb25jZSBgdG9nZ2xlTGF5b3V0RGlzcGxheWAgQVBJIGhhcyBiZWVuIGRlcGxveWVkXG4gIC8vIGV2ZXJ5d2hlcmUsIHN3aXRjaCBhbGwgcmVsZXZhbnQgZWxlbWVudHMgdG8gdGhpcyBBUEkuIEluIHRoZSBtZWFudGltZSxcbiAgLy8gc2ltcGx5IHVuYmxvY2sgZGlzcGxheSB0b2dnbGluZyB2aWEgYHN0eWxlPVwiZGlzcGxheTogLi4uXCJgLlxuICBzZXRTdHlsZShlbGVtZW50LCAnZGlzcGxheScsICdub25lJyk7XG4gIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaS1hbXBodG1sLWRpc3BsYXknKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4vbW9kZSc7XG5pbXBvcnQge2dldE1vZGVPYmplY3R9IGZyb20gJy4vbW9kZS1vYmplY3QnO1xuaW1wb3J0IHtpc0VudW1WYWx1ZX0gZnJvbSAnLi90eXBlcyc7XG5cbi8qKlxuICogVHJpcGxlIHplcm8gd2lkdGggc3BhY2UuXG4gKlxuICogVGhpcyBpcyBhZGRlZCB0byB1c2VyIGVycm9yIG1lc3NhZ2VzLCBzbyB0aGF0IHdlIGNhbiBsYXRlciBpZGVudGlmeVxuICogdGhlbSwgd2hlbiB0aGUgb25seSB0aGluZyB0aGF0IHdlIGhhdmUgaXMgdGhlIG1lc3NhZ2UuIFRoaXMgaXMgdGhlXG4gKiBjYXNlIGluIG1hbnkgYnJvd3NlcnMgd2hlbiB0aGUgZ2xvYmFsIGV4Y2VwdGlvbiBoYW5kbGVyIGlzIGludm9rZWQuXG4gKlxuICogQGNvbnN0IHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBjb25zdCBVU0VSX0VSUk9SX1NFTlRJTkVMID0gJ1xcdTIwMEJcXHUyMDBCXFx1MjAwQic7XG5cblxuLyoqXG4gKiBGb3VyIHplcm8gd2lkdGggc3BhY2UuXG4gKlxuICogQGNvbnN0IHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBjb25zdCBVU0VSX0VSUk9SX0VNQkVEX1NFTlRJTkVMID0gJ1xcdTIwMEJcXHUyMDBCXFx1MjAwQlxcdTIwMEInO1xuXG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhpcyBtZXNzYWdlIHdhcyBhIHVzZXIgZXJyb3IuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1VzZXJFcnJvck1lc3NhZ2UobWVzc2FnZSkge1xuICByZXR1cm4gbWVzc2FnZS5pbmRleE9mKFVTRVJfRVJST1JfU0VOVElORUwpID49IDA7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhpcyBtZXNzYWdlIHdhcyBhIGEgdXNlciBlcnJvciBmcm9tIGFuIGlmcmFtZSBlbWJlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVXNlckVycm9yRW1iZWQobWVzc2FnZSkge1xuICByZXR1cm4gbWVzc2FnZS5pbmRleE9mKFVTRVJfRVJST1JfRU1CRURfU0VOVElORUwpID49IDA7XG59XG5cblxuLyoqXG4gKiBAZW51bSB7bnVtYmVyfVxuICogQHByaXZhdGUgVmlzaWJsZSBmb3IgdGVzdGluZyBvbmx5LlxuICovXG5leHBvcnQgY29uc3QgTG9nTGV2ZWwgPSB7XG4gIE9GRjogMCxcbiAgRVJST1I6IDEsXG4gIFdBUk46IDIsXG4gIElORk86IDMsXG4gIEZJTkU6IDQsXG59O1xuXG4vKipcbiAqIFNldHMgcmVwb3J0RXJyb3IgZnVuY3Rpb24uIENhbGxlZCBmcm9tIGVycm9yLmpzIHRvIGJyZWFrIGN5Y2xpY1xuICogZGVwZW5kZW5jeS5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKiwgIUVsZW1lbnQ9KXx1bmRlZmluZWR9IGZuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRSZXBvcnRFcnJvcihmbikge1xuICBzZWxmLnJlcG9ydEVycm9yID0gZm47XG59XG5cbi8qKlxuICogQHR5cGUgeyFMb2dMZXZlbHx1bmRlZmluZWR9XG4gKiBAcHJpdmF0ZVxuICovXG5sZXQgbGV2ZWxPdmVycmlkZV8gPSB1bmRlZmluZWQ7XG5cbi8qKlxuICogQHBhcmFtIHshTG9nTGV2ZWx9IGxldmVsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvdmVycmlkZUxvZ0xldmVsKGxldmVsKSB7XG4gIGxldmVsT3ZlcnJpZGVfID0gbGV2ZWw7XG59XG5cbi8qKlxuICogTG9nZ2luZyBjbGFzcy4gVXNlIG9mIHNlbnRpbmVsIHN0cmluZyBpbnN0ZWFkIG9mIGEgYm9vbGVhbiB0byBjaGVjayB1c2VyL2RldlxuICogZXJyb3JzIGJlY2F1c2UgZXJyb3JzIGNvdWxkIGJlIHJldGhyb3duIGJ5IHNvbWUgbmF0aXZlIGNvZGUgYXMgYSBuZXcgZXJyb3IsXG4gKiBhbmQgb25seSBhIG1lc3NhZ2Ugd291bGQgc3Vydml2ZS4gQWxzbywgc29tZSBicm93c2VyIGRvbuKAmXQgc3VwcG9ydCBhIDV0aFxuICogZXJyb3Igb2JqZWN0IGFyZ3VtZW50IGluIHdpbmRvdy5vbmVycm9yLiBMaXN0IG9mIHN1cHBvcnRpbmcgYnJvd3NlciBjYW4gYmVcbiAqIGZvdW5kIGhlcmU6XG4gKiBodHRwczovL2Jsb2cuc2VudHJ5LmlvLzIwMTYvMDEvMDQvY2xpZW50LWphdmFzY3JpcHQtcmVwb3J0aW5nLXdpbmRvdy1vbmVycm9yLmh0bWxcbiAqIEBmaW5hbFxuICogQHByaXZhdGUgVmlzaWJsZSBmb3IgdGVzdGluZyBvbmx5LlxuICovXG5leHBvcnQgY2xhc3MgTG9nIHtcbiAgLyoqXG4gICAqIG9wdF9zdWZmaXggd2lsbCBiZSBhcHBlbmRlZCB0byBlcnJvciBtZXNzYWdlIHRvIGlkZW50aWZ5IHRoZSB0eXBlIG9mIHRoZVxuICAgKiBlcnJvciBtZXNzYWdlLiBXZSBjYW4ndCByZWx5IG9uIHRoZSBlcnJvciBvYmplY3QgdG8gcGFzcyBhbG9uZyB0aGUgdHlwZVxuICAgKiBiZWNhdXNlIHNvbWUgYnJvd3NlcnMgZG8gbm90IGhhdmUgdGhpcyBwYXJhbSBpbiBpdHMgd2luZG93Lm9uZXJyb3IgQVBJLlxuICAgKiBTZWU6XG4gICAqIGh0dHBzOi8vYmxvZy5zZW50cnkuaW8vMjAxNi8wMS8wNC9jbGllbnQtamF2YXNjcmlwdC1yZXBvcnRpbmctd2luZG93LW9uZXJyb3IuaHRtbFxuICAgKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCEuL21vZGUuTW9kZURlZik6IUxvZ0xldmVsfSBsZXZlbEZ1bmNcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfc3VmZml4XG4gICAqL1xuICBjb25zdHJ1Y3Rvcih3aW4sIGxldmVsRnVuYywgb3B0X3N1ZmZpeCkge1xuICAgIC8qKlxuICAgICAqIEluIHRlc3RzIHdlIHVzZSB0aGUgbWFpbiB0ZXN0IHdpbmRvdyBpbnN0ZWFkIG9mIHRoZSBpZnJhbWUgd2hlcmVcbiAgICAgKiB0aGUgdGVzdHMgcnVucyBiZWNhdXNlIG9ubHkgdGhlIGZvcm1lciBpcyByZWxheWVkIHRvIHRoZSBjb25zb2xlLlxuICAgICAqIEBjb25zdCB7IVdpbmRvd31cbiAgICAgKi9cbiAgICB0aGlzLndpbiA9IChnZXRNb2RlKCkudGVzdCAmJiB3aW4uQU1QX1RFU1RfSUZSQU1FKSA/IHdpbi5wYXJlbnQgOiB3aW47XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtmdW5jdGlvbighLi9tb2RlLk1vZGVEZWYpOiFMb2dMZXZlbH0gKi9cbiAgICB0aGlzLmxldmVsRnVuY18gPSBsZXZlbEZ1bmM7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshTG9nTGV2ZWx9ICovXG4gICAgdGhpcy5sZXZlbF8gPSB0aGlzLmRlZmF1bHRMZXZlbF8oKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge3N0cmluZ30gKi9cbiAgICB0aGlzLnN1ZmZpeF8gPSBvcHRfc3VmZml4IHx8ICcnO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFMb2dMZXZlbH1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdldExldmVsXygpIHtcbiAgICByZXR1cm4gKGxldmVsT3ZlcnJpZGVfICE9PSB1bmRlZmluZWQpID8gbGV2ZWxPdmVycmlkZV8gOiB0aGlzLmxldmVsXztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshTG9nTGV2ZWx9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBkZWZhdWx0TGV2ZWxfKCkge1xuICAgIC8vIE5vIGNvbnNvbGUgLSBjYW4ndCBlbmFibGUgbG9nZ2luZy5cbiAgICBpZiAoIXRoaXMud2luLmNvbnNvbGUgfHwgIXRoaXMud2luLmNvbnNvbGUubG9nKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuT0ZGO1xuICAgIH1cblxuICAgIC8vIExvZ2dpbmcgaGFzIGJlZW4gZXhwbGljaXRseSBkaXNhYmxlZC5cbiAgICBpZiAoZ2V0TW9kZSgpLmxvZyA9PSAnMCcpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5PRkY7XG4gICAgfVxuXG4gICAgLy8gTG9nZ2luZyBpcyBlbmFibGVkIGZvciB0ZXN0cyBkaXJlY3RseS5cbiAgICBpZiAoZ2V0TW9kZSgpLnRlc3QgJiYgdGhpcy53aW4uRU5BQkxFX0xPRykge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLkZJTkU7XG4gICAgfVxuXG4gICAgLy8gTG9jYWxEZXYgYnkgZGVmYXVsdCBhbGxvd3MgSU5GTyBsZXZlbCwgdW5sZXNzIG92ZXJyaWRlbiBieSBgI2xvZ2AuXG4gICAgaWYgKGdldE1vZGUoKS5sb2NhbERldiAmJiAhZ2V0TW9kZSgpLmxvZykge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLklORk87XG4gICAgfVxuXG4gICAgLy8gRGVsZWdhdGUgdG8gdGhlIHNwZWNpZmljIHJlc29sdmVyLlxuICAgIHJldHVybiB0aGlzLmxldmVsRnVuY18oZ2V0TW9kZU9iamVjdCgpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBsZXZlbFxuICAgKiBAcGFyYW0geyFBcnJheX0gbWVzc2FnZXNcbiAgICovXG4gIG1zZ18odGFnLCBsZXZlbCwgbWVzc2FnZXMpIHtcbiAgICBpZiAodGhpcy5nZXRMZXZlbF8oKSAhPSBMb2dMZXZlbC5PRkYpIHtcbiAgICAgIGxldCBmbiA9IHRoaXMud2luLmNvbnNvbGUubG9nO1xuICAgICAgaWYgKGxldmVsID09ICdFUlJPUicpIHtcbiAgICAgICAgZm4gPSB0aGlzLndpbi5jb25zb2xlLmVycm9yIHx8IGZuO1xuICAgICAgfSBlbHNlIGlmIChsZXZlbCA9PSAnSU5GTycpIHtcbiAgICAgICAgZm4gPSB0aGlzLndpbi5jb25zb2xlLmluZm8gfHwgZm47XG4gICAgICB9IGVsc2UgaWYgKGxldmVsID09ICdXQVJOJykge1xuICAgICAgICBmbiA9IHRoaXMud2luLmNvbnNvbGUud2FybiB8fCBmbjtcbiAgICAgIH1cbiAgICAgIGlmIChnZXRNb2RlKCkubG9jYWxEZXYpIHtcbiAgICAgICAgbWVzc2FnZXMudW5zaGlmdCgnWycgKyB0YWcgKyAnXScpO1xuICAgICAgfVxuICAgICAgZm4uYXBwbHkodGhpcy53aW4uY29uc29sZSwgbWVzc2FnZXMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBsb2dnaW5nIGlzIGVuYWJsZWQuXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBpc0VuYWJsZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0TGV2ZWxfKCkgIT0gTG9nTGV2ZWwuT0ZGO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9ydHMgYSBmaW5lLWdyYWluZWQgbWVzc2FnZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqL1xuICBmaW5lKHRhZywgdmFyX2FyZ3MpIHtcbiAgICBpZiAodGhpcy5nZXRMZXZlbF8oKSA+PSBMb2dMZXZlbC5GSU5FKSB7XG4gICAgICB0aGlzLm1zZ18odGFnLCAnRklORScsIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGEgaW5mb3JtYXRpb25hbCBtZXNzYWdlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICovXG4gIGluZm8odGFnLCB2YXJfYXJncykge1xuICAgIGlmICh0aGlzLmdldExldmVsXygpID49IExvZ0xldmVsLklORk8pIHtcbiAgICAgIHRoaXMubXNnXyh0YWcsICdJTkZPJywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9ydHMgYSB3YXJuaW5nIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKi9cbiAgd2Fybih0YWcsIHZhcl9hcmdzKSB7XG4gICAgaWYgKHRoaXMuZ2V0TGV2ZWxfKCkgPj0gTG9nTGV2ZWwuV0FSTikge1xuICAgICAgdGhpcy5tc2dfKHRhZywgJ1dBUk4nLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVwb3J0cyBhbiBlcnJvciBtZXNzYWdlLiBJZiB0aGUgbG9nZ2luZyBpcyBkaXNhYmxlZCwgdGhlIGVycm9yIGlzIHJldGhyb3duXG4gICAqIGFzeW5jaHJvbm91c2x5LlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICogQHJldHVybiB7IUVycm9yfHVuZGVmaW5lZH1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGVycm9yXyh0YWcsIHZhcl9hcmdzKSB7XG4gICAgaWYgKHRoaXMuZ2V0TGV2ZWxfKCkgPj0gTG9nTGV2ZWwuRVJST1IpIHtcbiAgICAgIHRoaXMubXNnXyh0YWcsICdFUlJPUicsIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBlcnJvciA9IGNyZWF0ZUVycm9yVmFyZ3MuYXBwbHkobnVsbCxcbiAgICAgICAgICBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICAgIHRoaXMucHJlcGFyZUVycm9yXyhlcnJvcik7XG4gICAgICByZXR1cm4gZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9ydHMgYW4gZXJyb3IgbWVzc2FnZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqL1xuICBlcnJvcih0YWcsIHZhcl9hcmdzKSB7XG4gICAgY29uc3QgZXJyb3IgPSB0aGlzLmVycm9yXy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmIChlcnJvcikge1xuICAgICAgZXJyb3IubmFtZSA9IHRhZyB8fCBlcnJvci5uYW1lO1xuICAgICAgLy8gcmVwb3J0RXJyb3IgaXMgaW5zdGFsbGVkIGdsb2JhbGx5IHBlciB3aW5kb3cgaW4gdGhlIGVudHJ5IHBvaW50LlxuICAgICAgc2VsZi5yZXBvcnRFcnJvcihlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9ydHMgYW4gZXJyb3IgbWVzc2FnZSBhbmQgbWFya3Mgd2l0aCBhbiBleHBlY3RlZCBwcm9wZXJ0eS4gSWYgdGhlXG4gICAqIGxvZ2dpbmcgaXMgZGlzYWJsZWQsIHRoZSBlcnJvciBpcyByZXRocm93biBhc3luY2hyb25vdXNseS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHVudXNlZFRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqL1xuICBleHBlY3RlZEVycm9yKHVudXNlZFRhZywgdmFyX2FyZ3MpIHtcbiAgICBjb25zdCBlcnJvciA9IHRoaXMuZXJyb3JfLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBlcnJvci5leHBlY3RlZCA9IHRydWU7XG4gICAgICAvLyByZXBvcnRFcnJvciBpcyBpbnN0YWxsZWQgZ2xvYmFsbHkgcGVyIHdpbmRvdyBpbiB0aGUgZW50cnkgcG9pbnQuXG4gICAgICBzZWxmLnJlcG9ydEVycm9yKGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBlcnJvciBvYmplY3QuXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICogQHJldHVybiB7IUVycm9yfVxuICAgKi9cbiAgY3JlYXRlRXJyb3IodmFyX2FyZ3MpIHtcbiAgICBjb25zdCBlcnJvciA9IGNyZWF0ZUVycm9yVmFyZ3MuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgICB0aGlzLnByZXBhcmVFcnJvcl8oZXJyb3IpO1xuICAgIHJldHVybiBlcnJvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGVycm9yIG9iamVjdCB3aXRoIGl0cyBleHBlY3RlZCBwcm9wZXJ0eSBzZXQgdG8gdHJ1ZS5cbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKiBAcmV0dXJuIHshRXJyb3J9XG4gICAqL1xuICBjcmVhdGVFeHBlY3RlZEVycm9yKHZhcl9hcmdzKSB7XG4gICAgY29uc3QgZXJyb3IgPSBjcmVhdGVFcnJvclZhcmdzLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgdGhpcy5wcmVwYXJlRXJyb3JfKGVycm9yKTtcbiAgICBlcnJvci5leHBlY3RlZCA9IHRydWU7XG4gICAgcmV0dXJuIGVycm9yO1xuICB9XG5cbiAgLyoqXG4gICAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgZmlyc3QgYXJndW1lbnQgaXNuJ3QgdHJ1ZWlzaC5cbiAgICpcbiAgICogU3VwcG9ydHMgYXJndW1lbnQgc3Vic3RpdHV0aW9uIGludG8gdGhlIG1lc3NhZ2UgdmlhICVzIHBsYWNlaG9sZGVycy5cbiAgICpcbiAgICogVGhyb3dzIGFuIGVycm9yIG9iamVjdCB0aGF0IGhhcyB0d28gZXh0cmEgcHJvcGVydGllczpcbiAgICogLSBhc3NvY2lhdGVkRWxlbWVudDogVGhpcyBpcyB0aGUgZmlyc3QgZWxlbWVudCBwcm92aWRlZCBpbiB0aGUgdmFyIGFyZ3MuXG4gICAqICAgSXQgY2FuIGJlIHVzZWQgZm9yIGltcHJvdmVkIGRpc3BsYXkgb2YgZXJyb3IgbWVzc2FnZXMuXG4gICAqIC0gbWVzc2FnZUFycmF5OiBUaGUgZWxlbWVudHMgb2YgdGhlIHN1YnN0aXR1dGVkIG1lc3NhZ2UgYXMgbm9uLXN0cmluZ2lmaWVkXG4gICAqICAgZWxlbWVudHMgaW4gYW4gYXJyYXkuIFdoZW4gZS5nLiBwYXNzZWQgdG8gY29uc29sZS5lcnJvciB0aGlzIHlpZWxkc1xuICAgKiAgIG5hdGl2ZSBkaXNwbGF5cyBvZiB0aGluZ3MgbGlrZSBIVE1MIGVsZW1lbnRzLlxuICAgKlxuICAgKiBAcGFyYW0ge1R9IHNob3VsZEJlVHJ1ZWlzaCBUaGUgdmFsdWUgdG8gYXNzZXJ0LiBUaGUgYXNzZXJ0IGZhaWxzIGlmIGl0IGRvZXNcbiAgICogICAgIG5vdCBldmFsdWF0ZSB0byB0cnVlLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9tZXNzYWdlIFRoZSBhc3NlcnRpb24gbWVzc2FnZVxuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzIEFyZ3VtZW50cyBzdWJzdGl0dXRlZCBpbnRvICVzIGluIHRoZSBtZXNzYWdlLlxuICAgKiBAcmV0dXJuIHtUfSBUaGUgdmFsdWUgb2Ygc2hvdWxkQmVUcnVlaXNoLlxuICAgKiBAdGVtcGxhdGUgVFxuICAgKiBlc2xpbnQgXCJnb29nbGUtY2FtZWxjYXNlL2dvb2dsZS1jYW1lbGNhc2VcIjogMFxuICAgKi9cbiAgYXNzZXJ0KHNob3VsZEJlVHJ1ZWlzaCwgb3B0X21lc3NhZ2UsIHZhcl9hcmdzKSB7XG4gICAgbGV0IGZpcnN0RWxlbWVudDtcbiAgICBpZiAoIXNob3VsZEJlVHJ1ZWlzaCkge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IG9wdF9tZXNzYWdlIHx8ICdBc3NlcnRpb24gZmFpbGVkJztcbiAgICAgIGNvbnN0IHNwbGl0TWVzc2FnZSA9IG1lc3NhZ2Uuc3BsaXQoJyVzJyk7XG4gICAgICBjb25zdCBmaXJzdCA9IHNwbGl0TWVzc2FnZS5zaGlmdCgpO1xuICAgICAgbGV0IGZvcm1hdHRlZCA9IGZpcnN0O1xuICAgICAgY29uc3QgbWVzc2FnZUFycmF5ID0gW107XG4gICAgICBwdXNoSWZOb25FbXB0eShtZXNzYWdlQXJyYXksIGZpcnN0KTtcbiAgICAgIGZvciAobGV0IGkgPSAyOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHZhbCA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgaWYgKHZhbCAmJiB2YWwudGFnTmFtZSkge1xuICAgICAgICAgIGZpcnN0RWxlbWVudCA9IHZhbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuZXh0Q29uc3RhbnQgPSBzcGxpdE1lc3NhZ2Uuc2hpZnQoKTtcbiAgICAgICAgbWVzc2FnZUFycmF5LnB1c2godmFsKTtcbiAgICAgICAgcHVzaElmTm9uRW1wdHkobWVzc2FnZUFycmF5LCBuZXh0Q29uc3RhbnQudHJpbSgpKTtcbiAgICAgICAgZm9ybWF0dGVkICs9IHRvU3RyaW5nKHZhbCkgKyBuZXh0Q29uc3RhbnQ7XG4gICAgICB9XG4gICAgICBjb25zdCBlID0gbmV3IEVycm9yKGZvcm1hdHRlZCk7XG4gICAgICBlLmZyb21Bc3NlcnQgPSB0cnVlO1xuICAgICAgZS5hc3NvY2lhdGVkRWxlbWVudCA9IGZpcnN0RWxlbWVudDtcbiAgICAgIGUubWVzc2FnZUFycmF5ID0gbWVzc2FnZUFycmF5O1xuICAgICAgdGhpcy5wcmVwYXJlRXJyb3JfKGUpO1xuICAgICAgLy8gcmVwb3J0RXJyb3IgaXMgaW5zdGFsbGVkIGdsb2JhbGx5IHBlciB3aW5kb3cgaW4gdGhlIGVudHJ5IHBvaW50LlxuICAgICAgc2VsZi5yZXBvcnRFcnJvcihlKTtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuICAgIHJldHVybiBzaG91bGRCZVRydWVpc2g7XG4gIH1cblxuICAvKipcbiAgICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpc24ndCBhbiBFbGVtZW50XG4gICAqXG4gICAqIE90aGVyd2lzZSBzZWUgYGFzc2VydGAgZm9yIHVzYWdlXG4gICAqXG4gICAqIEBwYXJhbSB7Kn0gc2hvdWxkQmVFbGVtZW50XG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X21lc3NhZ2UgVGhlIGFzc2VydGlvbiBtZXNzYWdlXG4gICAqIEByZXR1cm4geyFFbGVtZW50fSBUaGUgdmFsdWUgb2Ygc2hvdWxkQmVUcnVlaXNoLlxuICAgKiBAdGVtcGxhdGUgVFxuICAgKiBlc2xpbnQgXCJnb29nbGUtY2FtZWxjYXNlL2dvb2dsZS1jYW1lbGNhc2VcIjogMlxuICAgKi9cbiAgYXNzZXJ0RWxlbWVudChzaG91bGRCZUVsZW1lbnQsIG9wdF9tZXNzYWdlKSB7XG4gICAgY29uc3Qgc2hvdWxkQmVUcnVlaXNoID0gc2hvdWxkQmVFbGVtZW50ICYmIHNob3VsZEJlRWxlbWVudC5ub2RlVHlwZSA9PSAxO1xuICAgIHRoaXMuYXNzZXJ0KHNob3VsZEJlVHJ1ZWlzaCwgKG9wdF9tZXNzYWdlIHx8ICdFbGVtZW50IGV4cGVjdGVkJykgKyAnOiAlcycsXG4gICAgICAgIHNob3VsZEJlRWxlbWVudCk7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IUVsZW1lbnR9ICovIChzaG91bGRCZUVsZW1lbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgZmlyc3QgYXJndW1lbnQgaXNuJ3QgYSBzdHJpbmcuIFRoZSBzdHJpbmcgY2FuXG4gICAqIGJlIGVtcHR5LlxuICAgKlxuICAgKiBGb3IgbW9yZSBkZXRhaWxzIHNlZSBgYXNzZXJ0YC5cbiAgICpcbiAgICogQHBhcmFtIHsqfSBzaG91bGRCZVN0cmluZ1xuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9tZXNzYWdlIFRoZSBhc3NlcnRpb24gbWVzc2FnZVxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBzdHJpbmcgdmFsdWUuIENhbiBiZSBhbiBlbXB0eSBzdHJpbmcuXG4gICAqIGVzbGludCBcImdvb2dsZS1jYW1lbGNhc2UvZ29vZ2xlLWNhbWVsY2FzZVwiOiAyXG4gICAqL1xuICBhc3NlcnRTdHJpbmcoc2hvdWxkQmVTdHJpbmcsIG9wdF9tZXNzYWdlKSB7XG4gICAgdGhpcy5hc3NlcnQodHlwZW9mIHNob3VsZEJlU3RyaW5nID09ICdzdHJpbmcnLFxuICAgICAgICAob3B0X21lc3NhZ2UgfHwgJ1N0cmluZyBleHBlY3RlZCcpICsgJzogJXMnLCBzaG91bGRCZVN0cmluZyk7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAoc2hvdWxkQmVTdHJpbmcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgZmlyc3QgYXJndW1lbnQgaXNuJ3QgYSBudW1iZXIuIFRoZSBhbGxvd2VkIHZhbHVlc1xuICAgKiBpbmNsdWRlIGAwYCBhbmQgYE5hTmAuXG4gICAqXG4gICAqIEZvciBtb3JlIGRldGFpbHMgc2VlIGBhc3NlcnRgLlxuICAgKlxuICAgKiBAcGFyYW0geyp9IHNob3VsZEJlTnVtYmVyXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X21lc3NhZ2UgVGhlIGFzc2VydGlvbiBtZXNzYWdlXG4gICAqIEByZXR1cm4ge251bWJlcn0gVGhlIG51bWJlciB2YWx1ZS4gVGhlIGFsbG93ZWQgdmFsdWVzIGluY2x1ZGUgYDBgXG4gICAqICAgYW5kIGBOYU5gLlxuICAgKi9cbiAgYXNzZXJ0TnVtYmVyKHNob3VsZEJlTnVtYmVyLCBvcHRfbWVzc2FnZSkge1xuICAgIHRoaXMuYXNzZXJ0KHR5cGVvZiBzaG91bGRCZU51bWJlciA9PSAnbnVtYmVyJyxcbiAgICAgICAgKG9wdF9tZXNzYWdlIHx8ICdOdW1iZXIgZXhwZWN0ZWQnKSArICc6ICVzJywgc2hvdWxkQmVOdW1iZXIpO1xuICAgIHJldHVybiAvKiogQHR5cGUge251bWJlcn0gKi8gKHNob3VsZEJlTnVtYmVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzbid0IGEgYm9vbGVhbi5cbiAgICpcbiAgICogRm9yIG1vcmUgZGV0YWlscyBzZWUgYGFzc2VydGAuXG4gICAqXG4gICAqIEBwYXJhbSB7Kn0gc2hvdWxkQmVCb29sZWFuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X21lc3NhZ2UgVGhlIGFzc2VydGlvbiBtZXNzYWdlXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IFRoZSBib29sZWFuIHZhbHVlLlxuICAgKi9cbiAgYXNzZXJ0Qm9vbGVhbihzaG91bGRCZUJvb2xlYW4sIG9wdF9tZXNzYWdlKSB7XG4gICAgdGhpcy5hc3NlcnQoISFzaG91bGRCZUJvb2xlYW4gPT09IHNob3VsZEJlQm9vbGVhbixcbiAgICAgICAgKG9wdF9tZXNzYWdlIHx8ICdCb29sZWFuIGV4cGVjdGVkJykgKyAnOiAlcycsIHNob3VsZEJlQm9vbGVhbik7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi8gKHNob3VsZEJlQm9vbGVhbik7XG4gIH1cblxuICAvKipcbiAgICogQXNzZXJ0cyBhbmQgcmV0dXJucyB0aGUgZW51bSB2YWx1ZS4gSWYgdGhlIGVudW0gZG9lc24ndCBjb250YWluIHN1Y2ggYVxuICAgKiB2YWx1ZSwgdGhlIGVycm9yIGlzIHRocm93bi5cbiAgICpcbiAgICogQHBhcmFtIHshT2JqZWN0PFQ+fSBlbnVtT2JqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X2VudW1OYW1lXG4gICAqIEByZXR1cm4ge1R9XG4gICAqIEB0ZW1wbGF0ZSBUXG4gICAqIGVzbGludCBcImdvb2dsZS1jYW1lbGNhc2UvZ29vZ2xlLWNhbWVsY2FzZVwiOiAyXG4gICAqL1xuICBhc3NlcnRFbnVtVmFsdWUoZW51bU9iaiwgcywgb3B0X2VudW1OYW1lKSB7XG4gICAgaWYgKGlzRW51bVZhbHVlKGVudW1PYmosIHMpKSB7XG4gICAgICByZXR1cm4gcztcbiAgICB9XG4gICAgdGhpcy5hc3NlcnQoZmFsc2UsXG4gICAgICAgICdVbmtub3duICVzIHZhbHVlOiBcIiVzXCInLFxuICAgICAgICBvcHRfZW51bU5hbWUgfHwgJ2VudW0nLCBzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFcnJvcn0gZXJyb3JcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHByZXBhcmVFcnJvcl8oZXJyb3IpIHtcbiAgICBlcnJvciA9IGR1cGxpY2F0ZUVycm9ySWZOZWNlc3NhcnkoZXJyb3IpO1xuICAgIGlmICh0aGlzLnN1ZmZpeF8pIHtcbiAgICAgIGlmICghZXJyb3IubWVzc2FnZSkge1xuICAgICAgICBlcnJvci5tZXNzYWdlID0gdGhpcy5zdWZmaXhfO1xuICAgICAgfSBlbHNlIGlmIChlcnJvci5tZXNzYWdlLmluZGV4T2YodGhpcy5zdWZmaXhfKSA9PSAtMSkge1xuICAgICAgICBlcnJvci5tZXNzYWdlICs9IHRoaXMuc3VmZml4XztcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGlzVXNlckVycm9yTWVzc2FnZShlcnJvci5tZXNzYWdlKSkge1xuICAgICAgZXJyb3IubWVzc2FnZSA9IGVycm9yLm1lc3NhZ2UucmVwbGFjZShVU0VSX0VSUk9SX1NFTlRJTkVMLCAnJyk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd8IUVsZW1lbnR9IHZhbFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0b1N0cmluZyh2YWwpIHtcbiAgLy8gRG8gY2hlY2sgZXF1aXZhbGVudCB0byBgdmFsIGluc3RhbmNlb2YgRWxlbWVudGAgd2l0aG91dCBjcm9zcy13aW5kb3cgYnVnXG4gIGlmICh2YWwgJiYgdmFsLm5vZGVUeXBlID09IDEpIHtcbiAgICByZXR1cm4gdmFsLnRhZ05hbWUudG9Mb3dlckNhc2UoKSArICh2YWwuaWQgPyAnIycgKyB2YWwuaWQgOiAnJyk7XG4gIH1cbiAgcmV0dXJuIC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAodmFsKTtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IUFycmF5fSBhcnJheVxuICogQHBhcmFtIHsqfSB2YWxcbiAqL1xuZnVuY3Rpb24gcHVzaElmTm9uRW1wdHkoYXJyYXksIHZhbCkge1xuICBpZiAodmFsICE9ICcnKSB7XG4gICAgYXJyYXkucHVzaCh2YWwpO1xuICB9XG59XG5cbi8qKlxuICogU29tZSBleGNlcHRpb25zIChET01FeGNlcHRpb24sIG5hbWVseSkgaGF2ZSByZWFkLW9ubHkgbWVzc2FnZS5cbiAqIEBwYXJhbSB7IUVycm9yfSBlcnJvclxuICogQHJldHVybiB7IUVycm9yfTtcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGR1cGxpY2F0ZUVycm9ySWZOZWNlc3NhcnkoZXJyb3IpIHtcbiAgY29uc3Qge21lc3NhZ2V9ID0gZXJyb3I7XG4gIGNvbnN0IHRlc3QgPSBTdHJpbmcoTWF0aC5yYW5kb20oKSk7XG4gIGVycm9yLm1lc3NhZ2UgPSB0ZXN0O1xuXG4gIGlmIChlcnJvci5tZXNzYWdlID09PSB0ZXN0KSB7XG4gICAgZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgcmV0dXJuIGVycm9yO1xuICB9XG5cbiAgY29uc3QgZSA9IG5ldyBFcnJvcihlcnJvci5tZXNzYWdlKTtcbiAgLy8gQ29weSBhbGwgdGhlIGV4dHJhbmVvdXMgdGhpbmdzIHdlIGF0dGFjaC5cbiAgZm9yIChjb25zdCBwcm9wIGluIGVycm9yKSB7XG4gICAgZVtwcm9wXSA9IGVycm9yW3Byb3BdO1xuICB9XG4gIC8vIEVuc3VyZSB0aGVzZSBhcmUgY29waWVkLlxuICBlLnN0YWNrID0gZXJyb3Iuc3RhY2s7XG4gIHJldHVybiBlO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAqIEByZXR1cm4geyFFcnJvcn1cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRXJyb3JWYXJncyh2YXJfYXJncykge1xuICBsZXQgZXJyb3IgPSBudWxsO1xuICBsZXQgbWVzc2FnZSA9ICcnO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGFyZyA9IGFyZ3VtZW50c1tpXTtcbiAgICBpZiAoYXJnIGluc3RhbmNlb2YgRXJyb3IgJiYgIWVycm9yKSB7XG4gICAgICBlcnJvciA9IGR1cGxpY2F0ZUVycm9ySWZOZWNlc3NhcnkoYXJnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKG1lc3NhZ2UpIHtcbiAgICAgICAgbWVzc2FnZSArPSAnICc7XG4gICAgICB9XG4gICAgICBtZXNzYWdlICs9IGFyZztcbiAgICB9XG4gIH1cblxuICBpZiAoIWVycm9yKSB7XG4gICAgZXJyb3IgPSBuZXcgRXJyb3IobWVzc2FnZSk7XG4gIH0gZWxzZSBpZiAobWVzc2FnZSkge1xuICAgIGVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlICsgJzogJyArIGVycm9yLm1lc3NhZ2U7XG4gIH1cbiAgcmV0dXJuIGVycm9yO1xufVxuXG5cbi8qKlxuICogUmV0aHJvd3MgdGhlIGVycm9yIHdpdGhvdXQgdGVybWluYXRpbmcgdGhlIGN1cnJlbnQgY29udGV4dC4gVGhpcyBwcmVzZXJ2ZXNcbiAqIHdoZXRoZXIgdGhlIG9yaWdpbmFsIGVycm9yIGRlc2lnbmF0aW9uIGlzIGEgdXNlciBlcnJvciBvciBhIGRldiBlcnJvci5cbiAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJldGhyb3dBc3luYyh2YXJfYXJncykge1xuICBjb25zdCBlcnJvciA9IGNyZWF0ZUVycm9yVmFyZ3MuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgLy8gcmVwb3J0RXJyb3IgaXMgaW5zdGFsbGVkIGdsb2JhbGx5IHBlciB3aW5kb3cgaW4gdGhlIGVudHJ5IHBvaW50LlxuICAgIHNlbGYucmVwb3J0RXJyb3IoZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9KTtcbn1cblxuXG4vKipcbiAqIENhY2hlIGZvciBsb2dzLiBXZSBkbyBub3QgdXNlIGEgU2VydmljZSBzaW5jZSB0aGUgc2VydmljZSBtb2R1bGUgZGVwZW5kc1xuICogb24gTG9nIGFuZCBjbG9zdXJlIGxpdGVyYWxseSBjYW4ndCBldmVuLlxuICogQHR5cGUge3t1c2VyOiA/TG9nLCBkZXY6ID9Mb2csIHVzZXJGb3JFbWJlZDogP0xvZ319XG4gKi9cbnNlbGYubG9nID0gKHNlbGYubG9nIHx8IHtcbiAgdXNlcjogbnVsbCxcbiAgZGV2OiBudWxsLFxuICB1c2VyRm9yRW1iZWQ6IG51bGwsXG59KTtcblxuY29uc3QgbG9ncyA9IHNlbGYubG9nO1xuXG4vKipcbiAqIEV2ZW50dWFsbHkgaG9sZHMgYSBjb25zdHJ1Y3RvciBmb3IgTG9nIG9iamVjdHMuIExhemlseSBpbml0aWFsaXplZCwgc28gd2VcbiAqIGNhbiBhdm9pZCBldmVyIHJlZmVyZW5jaW5nIHRoZSByZWFsIGNvbnN0cnVjdG9yIGV4Y2VwdCBpbiBKUyBiaW5hcmllc1xuICogdGhhdCBhY3R1YWxseSB3YW50IHRvIGluY2x1ZGUgdGhlIGltcGxlbWVudGF0aW9uLlxuICogQHR5cGUgez9GdW5jdGlvbn1cbiAqL1xubGV0IGxvZ0NvbnN0cnVjdG9yID0gbnVsbDtcblxuLyoqXG4gKiBJbml0aWFsaXplcyBsb2cgY29udHJ1Y3Rvci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluaXRMb2dDb25zdHJ1Y3RvcigpIHtcbiAgbG9nQ29uc3RydWN0b3IgPSBMb2c7XG4gIC8vIEluaXRpYWxpemUgaW5zdGFuY2VzIGZvciB1c2UuIElmIGEgYmluYXJ5IChhbiBleHRlbnNpb24gZm9yIGV4YW1wbGUpIHRoYXRcbiAgLy8gZG9lcyBub3QgY2FsbCBgaW5pdExvZ0NvbnN0cnVjdG9yYCBpbnZva2VzIGBkZXYoKWAgb3IgYHVzZXIoKWAgZWFybGllciB0aGFuXG4gIC8vIHRoZSBiaW5hcnkgdGhhdCBkb2VzIGNhbGwgYGluaXRMb2dDb25zdHJ1Y3RvcmAgKGFtcC5qcyksIHRoZSBleHRlbnNpb24gd2lsbFxuICAvLyB0aHJvdyBhbiBlcnJvciBhcyB0aGF0IGV4dGVuc2lvbiB3aWxsIG5ldmVyIGJlIGFibGUgdG8gaW5pdGlhbGl6ZSB0aGUgbG9nXG4gIC8vIGluc3RhbmNlcyBhbmQgd2UgYWxzbyBkb24ndCB3YW50IGl0IHRvIGNhbGwgYGluaXRMb2dDb25zdHJ1Y3RvcmAgZWl0aGVyXG4gIC8vIChzaW5jZSB0aGF0IHdpbGwgY2F1c2UgdGhlIExvZyBpbXBsZW1lbnRhdGlvbiB0byBiZSBidW5kbGVkIGludG8gdGhhdFxuICAvLyBiaW5hcnkpLiBTbyB3ZSBtdXN0IGluaXRpYWxpemUgdGhlIGluc3RhbmNlcyBlYWdlcmx5IHNvIHRoYXQgdGhleSBhcmUgcmVhZHlcbiAgLy8gZm9yIHVzZSAoc3RvcmVkIGdsb2JhbGx5KSBhZnRlciB0aGUgbWFpbiBiaW5hcnkgY2FsbHMgYGluaXRMb2dDb25zdHJ1Y3RvcmAuXG4gIGRldigpO1xuICB1c2VyKCk7XG59XG5cbi8qKlxuICogUmVzZXRzIGxvZyBjb250cnVjdG9yIGZvciB0ZXN0aW5nLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRMb2dDb25zdHJ1Y3RvckZvclRlc3RpbmcoKSB7XG4gIGxvZ0NvbnN0cnVjdG9yID0gbnVsbDtcbn1cblxuLyoqXG4gKiBQdWJsaXNoZXIgbGV2ZWwgbG9nLlxuICpcbiAqIEVuYWJsZWQgaW4gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICogIDEuIE5vdCBkaXNhYmxlZCB1c2luZyBgI2xvZz0wYC5cbiAqICAyLiBEZXZlbG9wbWVudCBtb2RlIGlzIGVuYWJsZWQgdmlhIGAjZGV2ZWxvcG1lbnQ9MWAgb3IgbG9nZ2luZyBpcyBleHBsaWNpdGx5XG4gKiAgICAgZW5hYmxlZCB2aWEgYCNsb2c9RGAgd2hlcmUgRCA+PSAxLlxuICogIDMuIEFNUC5zZXRMb2dMZXZlbChEKSBpcyBjYWxsZWQsIHdoZXJlIEQgPj0gMS5cbiAqXG4gKiBAcGFyYW0geyFFbGVtZW50PX0gb3B0X2VsZW1lbnRcbiAqIEByZXR1cm4geyFMb2d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VyKG9wdF9lbGVtZW50KSB7XG4gIGlmICghbG9ncy51c2VyKSB7XG4gICAgbG9ncy51c2VyID0gZ2V0VXNlckxvZ2dlcihVU0VSX0VSUk9SX1NFTlRJTkVMKTtcbiAgfVxuICBpZiAoIWlzRnJvbUVtYmVkKGxvZ3MudXNlci53aW4sIG9wdF9lbGVtZW50KSkge1xuICAgIHJldHVybiBsb2dzLnVzZXI7XG4gIH0gZWxzZSB7XG4gICAgaWYgKGxvZ3MudXNlckZvckVtYmVkKSB7XG4gICAgICByZXR1cm4gbG9ncy51c2VyRm9yRW1iZWQ7XG4gICAgfVxuICAgIHJldHVybiBsb2dzLnVzZXJGb3JFbWJlZCA9IGdldFVzZXJMb2dnZXIoVVNFUl9FUlJPUl9FTUJFRF9TRU5USU5FTCk7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXR0ZXIgZm9yIHVzZXIgbG9nZ2VyXG4gKiBAcGFyYW0ge3N0cmluZz19IHN1ZmZpeFxuICogQHJldHVybiB7IUxvZ31cbiAqL1xuZnVuY3Rpb24gZ2V0VXNlckxvZ2dlcihzdWZmaXgpIHtcbiAgaWYgKCFsb2dDb25zdHJ1Y3Rvcikge1xuICAgIHRocm93IG5ldyBFcnJvcignZmFpbGVkIHRvIGNhbGwgaW5pdExvZ0NvbnN0cnVjdG9yJyk7XG4gIH1cbiAgcmV0dXJuIG5ldyBsb2dDb25zdHJ1Y3RvcihzZWxmLCBtb2RlID0+IHtcbiAgICBjb25zdCBsb2dOdW0gPSBwYXJzZUludChtb2RlLmxvZywgMTApO1xuICAgIGlmIChtb2RlLmRldmVsb3BtZW50IHx8IGxvZ051bSA+PSAxKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuRklORTtcbiAgICB9XG4gICAgcmV0dXJuIExvZ0xldmVsLldBUk47XG4gIH0sIHN1ZmZpeCk7XG59XG5cbi8qKlxuICogQU1QIGRldmVsb3BtZW50IGxvZy4gQ2FsbHMgdG8gYGRldkxvZygpLmFzc2VydGAgYW5kIGBkZXYuZmluZWAgYXJlIHN0cmlwcGVkXG4gKiBpbiB0aGUgUFJPRCBiaW5hcnkuIEhvd2V2ZXIsIGBkZXZMb2coKS5hc3NlcnRgIHJlc3VsdCBpcyBwcmVzZXJ2ZWQgaW4gZWl0aGVyXG4gKiBjYXNlLlxuICpcbiAqIEVuYWJsZWQgaW4gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICogIDEuIE5vdCBkaXNhYmxlZCB1c2luZyBgI2xvZz0wYC5cbiAqICAyLiBMb2dnaW5nIGlzIGV4cGxpY2l0bHkgZW5hYmxlZCB2aWEgYCNsb2c9RGAsIHdoZXJlIEQgPj0gMi5cbiAqICAzLiBBTVAuc2V0TG9nTGV2ZWwoRCkgaXMgY2FsbGVkLCB3aGVyZSBEID49IDIuXG4gKlxuICogQHJldHVybiB7IUxvZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRldigpIHtcbiAgaWYgKGxvZ3MuZGV2KSB7XG4gICAgcmV0dXJuIGxvZ3MuZGV2O1xuICB9XG4gIGlmICghbG9nQ29uc3RydWN0b3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2ZhaWxlZCB0byBjYWxsIGluaXRMb2dDb25zdHJ1Y3RvcicpO1xuICB9XG4gIHJldHVybiBsb2dzLmRldiA9IG5ldyBsb2dDb25zdHJ1Y3RvcihzZWxmLCBtb2RlID0+IHtcbiAgICBjb25zdCBsb2dOdW0gPSBwYXJzZUludChtb2RlLmxvZywgMTApO1xuICAgIGlmIChsb2dOdW0gPj0gMykge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLkZJTkU7XG4gICAgfVxuICAgIGlmIChsb2dOdW0gPj0gMikge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLklORk87XG4gICAgfVxuICAgIHJldHVybiBMb2dMZXZlbC5PRkY7XG4gIH0pO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFFbGVtZW50PX0gb3B0X2VsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59IGlzRW1iZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRnJvbUVtYmVkKHdpbiwgb3B0X2VsZW1lbnQpIHtcbiAgaWYgKCFvcHRfZWxlbWVudCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gb3B0X2VsZW1lbnQub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldyAhPSB3aW47XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuL21vZGUnO1xuXG4vKipcbiAqIFByb3ZpZGVzIGluZm8gYWJvdXQgdGhlIGN1cnJlbnQgYXBwLiBUaGlzIHJldHVybiB2YWx1ZSBtYXkgYmUgY2FjaGVkIGFuZFxuICogcGFzc2VkIGFyb3VuZCBhcyBpdCB3aWxsIGFsd2F5cyBiZSBEQ0UnZC5cbiAqIEBwYXJhbSB7P1dpbmRvdz19IG9wdF93aW5cbiAqIEByZXR1cm4geyEuL21vZGUuTW9kZURlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE1vZGVPYmplY3Qob3B0X3dpbikge1xuICByZXR1cm4ge1xuICAgIGxvY2FsRGV2OiBnZXRNb2RlKG9wdF93aW4pLmxvY2FsRGV2LFxuICAgIGRldmVsb3BtZW50OiBnZXRNb2RlKG9wdF93aW4pLmRldmVsb3BtZW50LFxuICAgIGZpbHRlcjogZ2V0TW9kZShvcHRfd2luKS5maWx0ZXIsXG4gICAgbWluaWZpZWQ6IGdldE1vZGUob3B0X3dpbikubWluaWZpZWQsXG4gICAgbGl0ZTogZ2V0TW9kZShvcHRfd2luKS5saXRlLFxuICAgIHRlc3Q6IGdldE1vZGUob3B0X3dpbikudGVzdCxcbiAgICBsb2c6IGdldE1vZGUob3B0X3dpbikubG9nLFxuICAgIHZlcnNpb246IGdldE1vZGUob3B0X3dpbikudmVyc2lvbixcbiAgICBydHZWZXJzaW9uOiBnZXRNb2RlKG9wdF93aW4pLnJ0dlZlcnNpb24sXG4gIH07XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtwYXJzZVF1ZXJ5U3RyaW5nX30gZnJvbSAnLi91cmwtcGFyc2UtcXVlcnktc3RyaW5nJztcblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBsb2NhbERldjogYm9vbGVhbixcbiAqICAgZGV2ZWxvcG1lbnQ6IGJvb2xlYW4sXG4gKiAgIGZpbHRlcjogKHN0cmluZ3x1bmRlZmluZWQpLFxuICogICBtaW5pZmllZDogYm9vbGVhbixcbiAqICAgbGl0ZTogYm9vbGVhbixcbiAqICAgdGVzdDogYm9vbGVhbixcbiAqICAgbG9nOiAoc3RyaW5nfHVuZGVmaW5lZCksXG4gKiAgIHZlcnNpb246IHN0cmluZyxcbiAqICAgcnR2VmVyc2lvbjogc3RyaW5nLFxuICogfX1cbiAqL1xuZXhwb3J0IGxldCBNb2RlRGVmO1xuXG4vKiogQHR5cGUge3N0cmluZ30gKi9cbmNvbnN0IHZlcnNpb24gPSAnJGludGVybmFsUnVudGltZVZlcnNpb24kJztcblxuLyoqXG4gKiBgcnR2VmVyc2lvbmAgaXMgdGhlIHByZWZpeGVkIHZlcnNpb24gd2Ugc2VydmUgb2ZmIG9mIHRoZSBjZG4uXG4gKiBUaGUgcHJlZml4IGRlbm90ZXMgY2FuYXJ5KDAwKSBvciBwcm9kKDAxKSBvciBhbiBleHBlcmltZW50IHZlcnNpb24gKCA+IDAxKS5cbiAqIEB0eXBlIHtzdHJpbmd9XG4gKi9cbmxldCBydHZWZXJzaW9uID0gJyc7XG5cbi8qKlxuICogUHJvdmlkZXMgaW5mbyBhYm91dCB0aGUgY3VycmVudCBhcHAuXG4gKiBAcGFyYW0gez9XaW5kb3c9fSBvcHRfd2luXG4gKiBAcmV0dXJuIHshTW9kZURlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE1vZGUob3B0X3dpbikge1xuICBjb25zdCB3aW4gPSBvcHRfd2luIHx8IHNlbGY7XG4gIGlmICh3aW4uQU1QX01PREUpIHtcbiAgICByZXR1cm4gd2luLkFNUF9NT0RFO1xuICB9XG4gIHJldHVybiB3aW4uQU1QX01PREUgPSBnZXRNb2RlXyh3aW4pO1xufVxuXG4vKipcbiAqIFByb3ZpZGVzIGluZm8gYWJvdXQgdGhlIGN1cnJlbnQgYXBwLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFNb2RlRGVmfVxuICovXG5mdW5jdGlvbiBnZXRNb2RlXyh3aW4pIHtcbiAgLy8gTWFnaWMgY29uc3RhbnRzIHRoYXQgYXJlIHJlcGxhY2VkIGJ5IGNsb3N1cmUgY29tcGlsZXIuXG4gIC8vIElTX01JTklGSUVEIGlzIGFsd2F5cyByZXBsYWNlZCB3aXRoIHRydWUgd2hlbiBjbG9zdXJlIGNvbXBpbGVyIGlzIHVzZWRcbiAgLy8gd2hpbGUgSVNfREVWIGlzIG9ubHkgcmVwbGFjZWQgd2hlbiBgZ3VscCBkaXN0YCBpcyBjYWxsZWQgd2l0aG91dCB0aGVcbiAgLy8gLS1mb3J0ZXN0aW5nIGZsYWcuXG4gIGNvbnN0IElTX0RFViA9IHRydWU7XG4gIGNvbnN0IElTX01JTklGSUVEID0gZmFsc2U7XG5cbiAgY29uc3QgbG9jYWxEZXZFbmFibGVkID0gISEoc2VsZi5BTVBfQ09ORklHICYmIHNlbGYuQU1QX0NPTkZJRy5sb2NhbERldik7XG4gIGNvbnN0IHJ1bm5pbmdUZXN0cyA9IElTX0RFViAmJiAhISh3aW4uQU1QX1RFU1QgfHwgd2luLl9fa2FybWFfXyk7XG4gIGNvbnN0IGlzTG9jYWxEZXYgPSBJU19ERVYgJiYgKGxvY2FsRGV2RW5hYmxlZCB8fCBydW5uaW5nVGVzdHMpO1xuICBjb25zdCBoYXNoUXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nXyhcbiAgICAgIC8vIGxvY2F0aW9uLm9yaWdpbmFsSGFzaCBpcyBzZXQgYnkgdGhlIHZpZXdlciB3aGVuIGl0IHJlbW92ZXMgdGhlIGZyYWdtZW50XG4gICAgICAvLyBmcm9tIHRoZSBVUkwuXG4gICAgICB3aW4ubG9jYXRpb24ub3JpZ2luYWxIYXNoIHx8IHdpbi5sb2NhdGlvbi5oYXNoKTtcblxuICBjb25zdCBzZWFyY2hRdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmdfKHdpbi5sb2NhdGlvbi5zZWFyY2gpO1xuXG4gIGlmICghcnR2VmVyc2lvbikge1xuICAgIHJ0dlZlcnNpb24gPSBnZXRSdHZWZXJzaW9uKHdpbiwgaXNMb2NhbERldik7XG4gIH1cblxuICAvLyBUaGUgYG1pbmlmaWVkYCwgYHRlc3RgIGFuZCBgbG9jYWxEZXZgIHByb3BlcnRpZXMgYXJlIHJlcGxhY2VkXG4gIC8vIGFzIGJvb2xlYW4gbGl0ZXJhbHMgd2hlbiB3ZSBydW4gYGd1bHAgZGlzdGAgd2l0aG91dCB0aGUgYC0tZm9ydGVzdGluZ2BcbiAgLy8gZmxhZ3MuIFRoaXMgaW1wcm92ZWQgRENFIG9uIHRoZSBwcm9kdWN0aW9uIGZpbGUgd2UgZGVwbG95IGFzIHRoZSBjb2RlXG4gIC8vIHBhdGhzIGZvciBsb2NhbGhvc3QvdGVzdGluZy9kZXZlbG9wbWVudCBhcmUgZWxpbWluYXRlZC5cbiAgcmV0dXJuIHtcbiAgICBsb2NhbERldjogaXNMb2NhbERldixcbiAgICAvLyBUcmlnZ2VycyB2YWxpZGF0aW9uIG9yIGVuYWJsZSBwdWIgbGV2ZWwgbG9nZ2luZy4gVmFsaWRhdGlvbiBjYW4gYmVcbiAgICAvLyBieXBhc3NlZCB2aWEgI3ZhbGlkYXRlPTAuXG4gICAgLy8gTm90ZSB0aGF0IEFNUF9ERVZfTU9ERSBmbGFnIGlzIHVzZWQgZm9yIHRlc3RpbmcgcHVycG9zZXMuXG4gICAgZGV2ZWxvcG1lbnQ6ICEhKGhhc2hRdWVyeVsnZGV2ZWxvcG1lbnQnXSA9PSAnMScgfHwgd2luLkFNUF9ERVZfTU9ERSksXG4gICAgZXhhbWluZXI6IGhhc2hRdWVyeVsnZGV2ZWxvcG1lbnQnXSA9PSAnMicsXG4gICAgLy8gQWxsb3dzIGZpbHRlcmluZyB2YWxpZGF0aW9uIGVycm9ycyBieSBlcnJvciBjYXRlZ29yeS4gRm9yIHRoZVxuICAgIC8vIGF2YWlsYWJsZSBjYXRlZ29yaWVzLCBzZWUgRXJyb3JDYXRlZ29yeSBpbiB2YWxpZGF0b3IvdmFsaWRhdG9yLnByb3RvLlxuICAgIGZpbHRlcjogaGFzaFF1ZXJ5WydmaWx0ZXInXSxcbiAgICAvLyBhbXAtZ2VvIG92ZXJyaWRlXG4gICAgZ2VvT3ZlcnJpZGU6IGhhc2hRdWVyeVsnYW1wLWdlbyddLFxuICAgIG1pbmlmaWVkOiBJU19NSU5JRklFRCxcbiAgICAvLyBXaGV0aGVyIGRvY3VtZW50IGlzIGluIGFuIGFtcC1saXRlIHZpZXdlci4gSXQgc2lnbmFsIHRoYXQgdGhlIHVzZXJcbiAgICAvLyB3b3VsZCBwcmVmZXIgdG8gdXNlIGxlc3MgYmFuZHdpZHRoLlxuICAgIGxpdGU6IHNlYXJjaFF1ZXJ5WydhbXBfbGl0ZSddICE9IHVuZGVmaW5lZCxcbiAgICB0ZXN0OiBydW5uaW5nVGVzdHMsXG4gICAgbG9nOiBoYXNoUXVlcnlbJ2xvZyddLFxuICAgIHZlcnNpb24sXG4gICAgcnR2VmVyc2lvbixcbiAgfTtcbn1cblxuLyoqXG4gKiBSZXRyaWV2ZSB0aGUgYHJ0dlZlcnNpb25gIHdoaWNoIHdpbGwgaGF2ZSBhIG51bWVyaWMgcHJlZml4XG4gKiBkZW5vdGluZyBjYW5hcnkvcHJvZC9leHBlcmltZW50ICh1bmxlc3MgYGlzTG9jYWxEZXZgIGlzIHRydWUpLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGlzTG9jYWxEZXZcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gZ2V0UnR2VmVyc2lvbih3aW4sIGlzTG9jYWxEZXYpIHtcbiAgLy8gSWYgaXQncyBsb2NhbCBkZXYgdGhlbiB3ZSB3b24ndCBhY3R1YWxseSBoYXZlIGEgZnVsbCB2ZXJzaW9uIHNvXG4gIC8vIGp1c3QgdXNlIHRoZSB2ZXJzaW9uLlxuICBpZiAoaXNMb2NhbERldikge1xuICAgIHJldHVybiB2ZXJzaW9uO1xuICB9XG5cbiAgaWYgKHdpbi5BTVBfQ09ORklHICYmIHdpbi5BTVBfQ09ORklHLnYpIHtcbiAgICByZXR1cm4gd2luLkFNUF9DT05GSUcudjtcbiAgfVxuXG4gIC8vIEN1cnJlbnRseSBgJGludGVybmFsUnVudGltZVZlcnNpb24kYCBhbmQgdGh1cyBgbW9kZS52ZXJzaW9uYCBjb250YWluIG9ubHlcbiAgLy8gbWFqb3IgdmVyc2lvbi4gVGhlIGZ1bGwgdmVyc2lvbiBob3dldmVyIG11c3QgYWxzbyBjYXJyeSB0aGUgbWlub3IgdmVyc2lvbi5cbiAgLy8gV2Ugd2lsbCBkZWZhdWx0IHRvIHByb2R1Y3Rpb24gZGVmYXVsdCBgMDFgIG1pbm9yIHZlcnNpb24gZm9yIG5vdy5cbiAgLy8gVE9ETyhlcndpbm1vbWJheSk6IGRlY2lkZSB3aGV0aGVyICRpbnRlcm5hbFJ1bnRpbWVWZXJzaW9uJCBzaG91bGQgY29udGFpblxuICAvLyBtaW5vciB2ZXJzaW9uLlxuICByZXR1cm4gYDAxJHt2ZXJzaW9ufWA7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtib29sZWFufSBpc0xvY2FsRGV2XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJ0dlZlcnNpb25Gb3JUZXN0aW5nKHdpbiwgaXNMb2NhbERldikge1xuICByZXR1cm4gZ2V0UnR2VmVyc2lvbih3aW4sIGlzTG9jYWxEZXYpO1xufVxuXG5cbi8qKiBAdmlzaWJsZUZvclRlc3RpbmcgKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldFJ0dlZlcnNpb25Gb3JUZXN0aW5nKCkge1xuICBydHZWZXJzaW9uID0gJyc7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtEZWZlcnJlZH0gZnJvbSAnLi91dGlscy9wcm9taXNlJztcbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4vc2VydmljZXMnO1xuXG4vKiogQGNvbnN0IHtmdW5jdGlvbigpfSAqL1xuY29uc3QgTk9PUF9DQUxMQkFDS18gPSBmdW5jdGlvbigpIHt9O1xuXG4vKiogQGNvbnN0IHtudW1iZXJ9ICovXG5jb25zdCBNSU5fVkVMT0NJVFlfID0gMC4wMjtcblxuLyoqIEBjb25zdCB7bnVtYmVyfSAqL1xuY29uc3QgRlJBTUVfQ09OU1RfID0gMTYuNjc7XG5cbi8qKiBAY29uc3Qge251bWJlcn0gKi9cbmNvbnN0IEVYUF9GUkFNRV9DT05TVF8gPSBNYXRoLnJvdW5kKC1GUkFNRV9DT05TVF8gLyBNYXRoLmxvZygwLjk1KSk7XG5cbi8qKlxuICogRGVwcmVjaWF0aW9uIGZhY3RvciBvZiAxLzEwMCBvZiBhIG1pbGxpc2Vjb25kLiBUaGlzIGlzIGhvdyBtdWNoIHByZXZpb3VzXG4gKiB2ZWxvY2l0eSBpcyBkZXByZWNpYXRlZCB3aGVuIGNhbGN1bGF0aW5nIHRoZSBuZXcgdmVsb2NpdHkuXG4gKiBAY29uc3Qge251bWJlcn1cbiAqL1xuY29uc3QgVkVMT0NJVFlfREVQUl9GQUNUT1JfID0gRlJBTUVfQ09OU1RfICogMjtcblxuXG4vKipcbiAqIENhbGN1bGF0ZXMgdmVsb2NpdHkgZm9yIGFuIG9iamVjdCB0cmF2ZWxpbmcgdGhlIGRpc3RhbmNlIGRlbHRhViBpbiB0aGVcbiAqIHRpbWUgZGVsdGFUaW1lIGdpdmVuIHRoZSBwcmV2aW91cyB2ZWxvY2l0eSBwcmV2VmVsb2NpdHkuIFRoZSBjYWxjdWxhdGlvblxuICogYXNzdW1lcyBhIGJhc2ljIGluZm9ybWF0aW9uYWwgZGVwcmVjaWF0aW9uIG9mIHByZXZpb3VzIHZlbG9jaXR5LlxuICogQHBhcmFtIHtudW1iZXJ9IGRlbHRhVlxuICogQHBhcmFtIHt0aW1lfSBkZWx0YVRpbWVcbiAqIEBwYXJhbSB7bnVtYmVyfSBwcmV2VmVsb2NpdHlcbiAqIEByZXR1cm4ge251bWJlcn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNhbGNWZWxvY2l0eShkZWx0YVYsIGRlbHRhVGltZSwgcHJldlZlbG9jaXR5KSB7XG4gIGlmIChkZWx0YVRpbWUgPCAxKSB7XG4gICAgZGVsdGFUaW1lID0gMTtcbiAgfVxuXG4gIC8vIENhbGN1bGF0ZSBzcGVlZCBhbmQgc3BlZWQgZGVwcmVjaWF0aW9uLlxuICBjb25zdCBzcGVlZCA9IGRlbHRhViAvIGRlbHRhVGltZTtcblxuICAvLyBEZXByZWNpYXRpb24gaXMgc2ltcGx5IGFuIGluZm9ybWF0aW9uYWwgcXVhbGl0eS4gSXQgYmFzaWNhbGx5IG1lYW5zOlxuICAvLyB3ZSBjYW4ndCBpZ25vcmUgdGhlIHZlbG9jaXR5IHdlIGtuZXcgcmVjZW50bHksIGJ1dCB3ZSdkIG9ubHkgY29uc2lkZXJcbiAgLy8gaXQgcHJvcG9ydGlvbmFsbHkgdG8gaG93IGxvbmcgYWdvIHdlJ3ZlIHNlZW4gaXQuIEN1cnJlbnRseSwgdGhpc1xuICAvLyBkZXByZWNpYXRpb24gZmFjdG9yIGlzIDEvMTAwIG9mIGEgbWlsbGlzZWNvbmQuIE5ldyBhdmVyYWdlIHZlbG9jaXR5IGlzXG4gIC8vIGNhbGN1bGF0ZWQgYnkgd2VpZ2hpbmcgdG93YXJkIHRoZSBuZXcgdmVsb2NpdHkgYW5kIGF3YXkgZnJvbSBvbGRcbiAgLy8gdmVsb2NpdHkgYmFzZWQgb24gdGhlIGRlcHJlY2lhdGlvbi5cbiAgY29uc3QgZGVwciA9IDAuNSArIE1hdGgubWluKGRlbHRhVGltZSAvIFZFTE9DSVRZX0RFUFJfRkFDVE9SXywgMC41KTtcbiAgcmV0dXJuIHNwZWVkICogZGVwciArIHByZXZWZWxvY2l0eSAqICgxIC0gZGVwcik7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgbW90aW9uIHByb2Nlc3MgdGhhdCB3aWxsIHlpZWxkIHdoZW4gdGhlIHZlbG9jaXR5IGhhcyBydW4gZG93biB0b1xuICogemVycC4gRm9yIGVhY2ggaXRlcmF0aW9uLCB0aGUgdmVsb2NpdHkgaXMgZGVwcmVjaWF0ZWQgYW5kIHRoZSBjb29yZGluYXRlc1xuICogYXJlIGFkdmFuY2VkIGZyb20gc3RhcnQgWC9ZIHRvIHRoZSBkZXN0aW5hdGlvbiBhY2NvcmRpbmcgdG8gdmVsb2NpdHlcbiAqIHZlY3RvcnMuIEZvciBlYWNoIHN1Y2ggaXRlcmF0aW9uIHRoZSBjYWxsYmFjayBpcyBjYWxsZWQgd2l0aCB0aGUgbmV3IHggYW5kIHkuXG4gKiBAcGFyYW0geyFOb2RlfSBjb250ZXh0Tm9kZVxuICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0WCBTdGFydCBYIGNvb3JkaW5hdGUuXG4gKiBAcGFyYW0ge251bWJlcn0gc3RhcnRZIFN0YXJ0IFkgY29vcmRpbmF0ZS5cbiAqIEBwYXJhbSB7bnVtYmVyfSB2ZWxvWCBTdGFydGluZyBYIHZlbG9jaXR5LlxuICogQHBhcmFtIHtudW1iZXJ9IHZlbG9ZIFN0YXJ0aW5nIFkgdmVsb2NpdHkuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKG51bWJlciwgbnVtYmVyKTpib29sZWFufSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgZm9yIGVhY2hcbiAqICAgc3RlcCBvZiB0aGUgZGVjZWxlcmF0aW9uIG1vdGlvbi5cbiAqIEBwYXJhbSB7IS4vc2VydmljZS92c3luYy1pbXBsLlZzeW5jPX0gb3B0X3ZzeW5jIE1vc3RseSBmb3IgdGVzdGluZyBvbmx5LlxuICogQHJldHVybiB7IU1vdGlvbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnRpbnVlTW90aW9uKGNvbnRleHROb2RlLCBzdGFydFgsIHN0YXJ0WSwgdmVsb1gsIHZlbG9ZLFxuICBjYWxsYmFjaywgb3B0X3ZzeW5jKSB7XG4gIHJldHVybiBuZXcgTW90aW9uKGNvbnRleHROb2RlLCBzdGFydFgsIHN0YXJ0WSwgdmVsb1gsIHZlbG9ZLFxuICAgICAgY2FsbGJhY2ssIG9wdF92c3luYykuc3RhcnQoKTtcbn1cblxuXG4vKipcbiAqIE1vdGlvbiBwcm9jZXNzIHRoYXQgYWxsb3dzIHRyYWNraW5nIGFuZCBtb25pdG9yaW5nIG9mIHRoZSBydW5uaW5nIG1vdGlvbi5cbiAqIE1vc3QgaW1wb3J0YW50bHkgaXQgZXhwb3NlcyBtZXRob2RzIFwidGhlblwiIGFuZCBcInRoZW5BbHdheXNcIiB0aGF0IGhhdmUgdGhlXG4gKiBzZW1hbnRpY3Mgb2YgYSBQcm9taXNlIGFuZCBzaWduYWwgd2hlbiB0aGUgbW90aW9uIGhhcyBjb21wbGV0ZWQgb3IgZmFpbGVkLlxuICogQWRkaXRpb25hbGx5LCBpdCBleHBvc2VzIHRoZSBtZXRob2QgXCJoYWx0XCIgd2hpY2ggYWxsb3dzIHRvIHN0b3AvcmVzZXQgdGhlXG4gKiBtb3Rpb24uXG4gKiBAaW1wbGVtZW50cyB7SVRoZW5hYmxlfVxuICovXG5leHBvcnQgY2xhc3MgTW90aW9uIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IU5vZGV9IGNvbnRleHROb2RlIENvbnRleHQgbm9kZS5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0WCBTdGFydCBYIGNvb3JkaW5hdGUuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydFkgU3RhcnQgWSBjb29yZGluYXRlLlxuICAgKiBAcGFyYW0ge251bWJlcn0gdmVsb1ggU3RhcnRpbmcgWCB2ZWxvY2l0eS5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHZlbG9ZIFN0YXJ0aW5nIFkgdmVsb2NpdHkuXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24obnVtYmVyLCBudW1iZXIpOmJvb2xlYW59IGNhbGxiYWNrIFRoZSBjYWxsYmFjayBmb3IgZWFjaFxuICAgKiAgIHN0ZXAgb2YgdGhlIGRlY2VsZXJhdGlvbiBtb3Rpb24uXG4gICAqIEBwYXJhbSB7IS4vc2VydmljZS92c3luYy1pbXBsLlZzeW5jPX0gb3B0X3ZzeW5jXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihjb250ZXh0Tm9kZSwgc3RhcnRYLCBzdGFydFksIHZlbG9YLCB2ZWxvWSwgY2FsbGJhY2ssIG9wdF92c3luYykge1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyEuL3NlcnZpY2UvdnN5bmMtaW1wbC5Wc3luY30gKi9cbiAgICB0aGlzLnZzeW5jXyA9IG9wdF92c3luYyB8fCBTZXJ2aWNlcy52c3luY0ZvcihzZWxmKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFOb2RlfSAqL1xuICAgIHRoaXMuY29udGV4dE5vZGVfID0gY29udGV4dE5vZGU7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0ICovXG4gICAgdGhpcy5jYWxsYmFja18gPSBjYWxsYmFjaztcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMubGFzdFhfID0gc3RhcnRYO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5sYXN0WV8gPSBzdGFydFk7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLm1heFZlbG9jaXR5WF8gPSB2ZWxvWDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMubWF4VmVsb2NpdHlZXyA9IHZlbG9ZO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy52ZWxvY2l0eVhfID0gMDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMudmVsb2NpdHlZXyA9IDA7XG5cbiAgICBjb25zdCBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuXG4gICAgLyoqIEBwcml2YXRlIHshUHJvbWlzZX0gKi9cbiAgICB0aGlzLnByb21pc2VfID0gZGVmZXJyZWQucHJvbWlzZTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IUZ1bmN0aW9ufSAqL1xuICAgIHRoaXMucmVzb2x2ZV8gPSBkZWZlcnJlZC5yZXNvbHZlO1xuXG4gICAgLyoqIEBwcml2YXRlIHshRnVuY3Rpb259ICovXG4gICAgdGhpcy5yZWplY3RfID0gZGVmZXJyZWQucmVqZWN0O1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuY29udGludWluZ18gPSBmYWxzZTtcbiAgfVxuXG4gIC8qKiAqL1xuICBzdGFydCgpIHtcbiAgICB0aGlzLmNvbnRpbnVpbmdfID0gdHJ1ZTtcbiAgICBpZiAoTWF0aC5hYnModGhpcy5tYXhWZWxvY2l0eVhfKSA8PSBNSU5fVkVMT0NJVFlfICYmXG4gICAgICAgICAgICBNYXRoLmFicyh0aGlzLm1heFZlbG9jaXR5WV8pIDw9IE1JTl9WRUxPQ0lUWV8pIHtcbiAgICAgIHRoaXMuZmlyZU1vdmVfKCk7XG4gICAgICB0aGlzLmNvbXBsZXRlQ29udGludWVfKHRydWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJ1bkNvbnRpbnVpbmdfKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbHRzIHRoZSBtb3Rpb24uIFRoZSBtb3Rpb24gcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIHNpbmNlIHRoZSBtb3Rpb25cbiAgICogaGFzIGJlZW4gaW50ZXJydXB0ZWQuXG4gICAqL1xuICBoYWx0KCkge1xuICAgIGlmICh0aGlzLmNvbnRpbnVpbmdfKSB7XG4gICAgICB0aGlzLmNvbXBsZXRlQ29udGludWVfKGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2hhaW5zIHRvIHRoZSBtb3Rpb24ncyBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHdoZW4gdGhlIG1vdGlvbiBoYXNcbiAgICogY29tcGxldGVkIG9yIHdpbGwgcmVqZWN0IGlmIG1vdGlvbiBoYXMgZmFpbGVkIG9yIHdhcyBpbnRlcnJ1cHRlZC5cbiAgICogQG92ZXJyaWRlXG4gICAqL1xuICB0aGVuKG9wdF9yZXNvbHZlLCBvcHRfcmVqZWN0KSB7XG4gICAgaWYgKCFvcHRfcmVzb2x2ZSAmJiAhb3B0X3JlamVjdCkge1xuICAgICAgcmV0dXJuIHRoaXMucHJvbWlzZV87XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnByb21pc2VfLnRoZW4ob3B0X3Jlc29sdmUsIG9wdF9yZWplY3QpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIGZvciByZWdhcmRsZXNzIHdoZXRoZXIgdGhlIG1vdGlvbiBzdWNjZWVkcyBvciBmYWlscy5cbiAgICogQHBhcmFtIHtmdW5jdGlvbigpPX0gb3B0X2NhbGxiYWNrXG4gICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgKi9cbiAgdGhlbkFsd2F5cyhvcHRfY2FsbGJhY2spIHtcbiAgICBjb25zdCBjYWxsYmFjayA9IG9wdF9jYWxsYmFjayB8fCBOT09QX0NBTExCQUNLXztcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZX0gKi8gKHRoaXMudGhlbihjYWxsYmFjaywgY2FsbGJhY2spKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHJ1bkNvbnRpbnVpbmdfKCkge1xuICAgIHRoaXMudmVsb2NpdHlYXyA9IHRoaXMubWF4VmVsb2NpdHlYXztcbiAgICB0aGlzLnZlbG9jaXR5WV8gPSB0aGlzLm1heFZlbG9jaXR5WV87XG4gICAgY29uc3QgYm91bmRTdGVwID0gdGhpcy5zdGVwQ29udGludWVfLmJpbmQodGhpcyk7XG4gICAgY29uc3QgYm91bmRDb21wbGV0ZSA9IHRoaXMuY29tcGxldGVDb250aW51ZV8uYmluZCh0aGlzLCB0cnVlKTtcbiAgICByZXR1cm4gdGhpcy52c3luY18ucnVuQW5pbU11dGF0ZVNlcmllcyh0aGlzLmNvbnRleHROb2RlXywgYm91bmRTdGVwLCA1MDAwKVxuICAgICAgICAudGhlbihib3VuZENvbXBsZXRlLCBib3VuZENvbXBsZXRlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIFwidHJ1ZVwiIHRvIGNvbnRpbnVlIGFuZCBcImZhbHNlXCIgdG8gc3RvcCBtb3Rpb24gcHJvY2Vzcy5cbiAgICogQHBhcmFtIHt0aW1lfSB0aW1lU2luY2VTdGFydFxuICAgKiBAcGFyYW0ge3RpbWV9IHRpbWVTaW5jZVByZXZcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHN0ZXBDb250aW51ZV8odGltZVNpbmNlU3RhcnQsIHRpbWVTaW5jZVByZXYpIHtcbiAgICBpZiAoIXRoaXMuY29udGludWluZ18pIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0aGlzLmxhc3RYXyArPSB0aW1lU2luY2VQcmV2ICogdGhpcy52ZWxvY2l0eVhfO1xuICAgIHRoaXMubGFzdFlfICs9IHRpbWVTaW5jZVByZXYgKiB0aGlzLnZlbG9jaXR5WV87XG4gICAgaWYgKCF0aGlzLmZpcmVNb3ZlXygpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgY29uc3QgZGVjZWwgPSBNYXRoLmV4cCgtdGltZVNpbmNlU3RhcnQgLyBFWFBfRlJBTUVfQ09OU1RfKTtcbiAgICB0aGlzLnZlbG9jaXR5WF8gPSB0aGlzLm1heFZlbG9jaXR5WF8gKiBkZWNlbDtcbiAgICB0aGlzLnZlbG9jaXR5WV8gPSB0aGlzLm1heFZlbG9jaXR5WV8gKiBkZWNlbDtcbiAgICByZXR1cm4gKE1hdGguYWJzKHRoaXMudmVsb2NpdHlYXykgPiBNSU5fVkVMT0NJVFlfIHx8XG4gICAgICAgIE1hdGguYWJzKHRoaXMudmVsb2NpdHlZXykgPiBNSU5fVkVMT0NJVFlfKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHN1Y2Nlc3NcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGNvbXBsZXRlQ29udGludWVfKHN1Y2Nlc3MpIHtcbiAgICBpZiAoIXRoaXMuY29udGludWluZ18pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5jb250aW51aW5nXyA9IGZhbHNlO1xuICAgIHRoaXMuZmlyZU1vdmVfKCk7XG4gICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgIHRoaXMucmVzb2x2ZV8oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZWplY3RfKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBwcml2YXRlICovXG4gIGZpcmVNb3ZlXygpIHtcbiAgICByZXR1cm4gdGhpcy5jYWxsYmFja18odGhpcy5sYXN0WF8sIHRoaXMubGFzdFlfKTtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuXG4vKipcbiAqIFRoaXMgY2xhc3MgaGVscHMgdG8gbWFuYWdlIG9ic2VydmVycy4gT2JzZXJ2ZXJzIGNhbiBiZSBhZGRlZCwgcmVtb3ZlZCBvclxuICogZmlyZWQgdGhyb3VnaCBhbmQgaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAqIEB0ZW1wbGF0ZSBUWVBFXG4gKi9cbmV4cG9ydCBjbGFzcyBPYnNlcnZhYmxlIHtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBPYnNlcnZhYmxlLlxuICAgKi9cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLyoqIEB0eXBlIHs/QXJyYXk8ZnVuY3Rpb24oVFlQRSk+fSAqL1xuICAgIHRoaXMuaGFuZGxlcnNfID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIHRoZSBvYnNlcnZlciB0byB0aGlzIGluc3RhbmNlLlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKFRZUEUpfSBoYW5kbGVyIE9ic2VydmVyJ3MgaGFuZGxlci5cbiAgICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICAgKi9cbiAgYWRkKGhhbmRsZXIpIHtcbiAgICBpZiAoIXRoaXMuaGFuZGxlcnNfKSB7XG4gICAgICB0aGlzLmhhbmRsZXJzXyA9IFtdO1xuICAgIH1cbiAgICB0aGlzLmhhbmRsZXJzXy5wdXNoKGhhbmRsZXIpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICB0aGlzLnJlbW92ZShoYW5kbGVyKTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgdGhlIG9ic2VydmVyIGZyb20gdGhpcyBpbnN0YW5jZS5cbiAgICogQHBhcmFtIHtmdW5jdGlvbihUWVBFKX0gaGFuZGxlciBPYnNlcnZlcidzIGluc3RhbmNlLlxuICAgKi9cbiAgcmVtb3ZlKGhhbmRsZXIpIHtcbiAgICBpZiAoIXRoaXMuaGFuZGxlcnNfKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5oYW5kbGVyc18uaW5kZXhPZihoYW5kbGVyKTtcbiAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgdGhpcy5oYW5kbGVyc18uc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlcyBhbGwgb2JzZXJ2ZXJzLlxuICAgKi9cbiAgcmVtb3ZlQWxsKCkge1xuICAgIGlmICghdGhpcy5oYW5kbGVyc18pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5oYW5kbGVyc18ubGVuZ3RoID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBGaXJlcyBhbiBldmVudC4gQWxsIG9ic2VydmVycyBhcmUgY2FsbGVkLlxuICAgKiBAcGFyYW0ge1RZUEU9fSBvcHRfZXZlbnRcbiAgICovXG4gIGZpcmUob3B0X2V2ZW50KSB7XG4gICAgaWYgKCF0aGlzLmhhbmRsZXJzXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBoYW5kbGVycyA9IHRoaXMuaGFuZGxlcnNfO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaGFuZGxlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGhhbmRsZXIgPSBoYW5kbGVyc1tpXTtcbiAgICAgIGhhbmRsZXIob3B0X2V2ZW50KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBudW1iZXIgb2YgaGFuZGxlcnMuIE1vc3RseSBuZWVkZWQgZm9yIHRlc3RzLlxuICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAqL1xuICBnZXRIYW5kbGVyQ291bnQoKSB7XG4gICAgaWYgKCF0aGlzLmhhbmRsZXJzXykge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmhhbmRsZXJzXy5sZW5ndGg7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuL3NlcnZpY2VzJztcblxuXG4vKipcbiAqIFBhc3MgY2xhc3MgaGVscHMgdG8gbWFuYWdlIHNpbmdsZS1wYXNzIHByb2Nlc3MuIEEgcGFzcyBpcyBzY2hlZHVsZWQgdXNpbmdcbiAqIGRlbGF5IG1ldGhvZC4gT25seSBvbmUgcGFzcyBjYW4gYmUgcGVuZGluZyBhdCBhIHRpbWUuIElmIG5vIHBhc3MgaXMgcGVuZGluZ1xuICogdGhlIHByb2Nlc3MgaXMgY29uc2lkZXJlZCB0byBiZSBcImlkbGVcIi5cbiAqL1xuZXhwb3J0IGNsYXNzIFBhc3Mge1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IFBhc3MgaW5zdGFuY2UuXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gaGFuZGxlciBIYW5kbGVyIHRvIGJlIGV4ZWN1dGVkIHdoZW4gcGFzcyBpcyB0cmlnZ2VyZWQuXG4gICAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0X2RlZmF1bHREZWxheSBEZWZhdWx0IGRlbGF5IHRvIGJlIHVzZWQgd2hlbiBzY2hlZHVsZVxuICAgKiAgIGlzIGNhbGxlZCB3aXRob3V0IG9uZS5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHdpbiwgaGFuZGxlciwgb3B0X2RlZmF1bHREZWxheSkge1xuICAgIHRoaXMudGltZXJfID0gU2VydmljZXMudGltZXJGb3Iod2luKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge2Z1bmN0aW9uKCl9ICovXG4gICAgdGhpcy5oYW5kbGVyXyA9IGhhbmRsZXI7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtudW1iZXJ9ICovXG4gICAgdGhpcy5kZWZhdWx0RGVsYXlfID0gb3B0X2RlZmF1bHREZWxheSB8fCAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ8c3RyaW5nfSAqL1xuICAgIHRoaXMuc2NoZWR1bGVkXyA9IC0xO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5uZXh0VGltZV8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMucnVubmluZ18gPSBmYWxzZTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFGdW5jdGlvbn0gKi9cbiAgICB0aGlzLmJvdW5kUGFzc18gPSAoKSA9PiB0aGlzLnBhc3NfKCk7XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciBvciBub3QgYSBwYXNzIGlzIGN1cnJlbnRseSBwZW5kaW5nLlxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgaXNQZW5kaW5nKCkge1xuICAgIHJldHVybiB0aGlzLnNjaGVkdWxlZF8gIT0gLTE7XG4gIH1cblxuICAvKipcbiAgICogVHJpZXMgdG8gc2NoZWR1bGUgYSBuZXcgcGFzcyBvcHRpb25hbGx5IHdpdGggc3BlY2lmaWVkIGRlbGF5LiBJZiB0aGUgbmV3XG4gICAqIHJlcXVlc3RlZCBwYXNzIGlzIHJlcXVlc3RlZCBiZWZvcmUgdGhlIHBlbmRpbmcgcGFzcywgdGhlIHBlbmRpbmcgcGFzcyBpc1xuICAgKiBjYW5jZWxlZC4gSWYgdGhlIG5ldyBwYXNzIGlzIHJlcXVlc3RlZCBhZnRlciB0aGUgcGVuZGluZyBwYXNzLCB0aGUgbmV3bHlcbiAgICogcmVxdWVzdGVkIHBhc3MgaXMgaWdub3JlZC5cbiAgICpcbiAgICogUmV0dXJucyB7QGNvZGUgdHJ1ZX0gaWYgdGhlIHBhc3MgaGFzIGJlZW4gc2NoZWR1bGVkIGFuZCB7QGNvZGUgZmFsc2V9IGlmXG4gICAqIGlnbm9yZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0X2RlbGF5IERlbGF5IHRvIHNjaGVkdWxlIHRoZSBwYXNzLiBJZiBub3Qgc3BlY2lmaWVkXG4gICAqICAgdGhlIGRlZmF1bHQgZGVsYXkgaXMgdXNlZCwgZmFsbGluZyBiYWNrIHRvIDAuXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBzY2hlZHVsZShvcHRfZGVsYXkpIHtcbiAgICBsZXQgZGVsYXkgPSBvcHRfZGVsYXkgfHwgdGhpcy5kZWZhdWx0RGVsYXlfO1xuICAgIGlmICh0aGlzLnJ1bm5pbmdfICYmIGRlbGF5IDwgMTApIHtcbiAgICAgIC8vIElmIHdlIGdldCBjYWxsZWQgcmVjdXJzaXZlbHksIHdhaXQgYXQgbGVhc3QgMTBtcyBmb3IgdGhlIG5leHRcbiAgICAgIC8vIGV4ZWN1dGlvbi5cbiAgICAgIGRlbGF5ID0gMTA7XG4gICAgfVxuXG4gICAgY29uc3QgbmV4dFRpbWUgPSBEYXRlLm5vdygpICsgZGVsYXk7XG4gICAgLy8gU2NoZWR1bGUgYW5ldyBpZiBub3RoaW5nIGlzIHNjaGVkdWxlZCBjdXJyZW50bHkgb3IgaWYgdGhlIG5ldyB0aW1lIGlzXG4gICAgLy8gc29vbmVyIHRoZW4gcHJldmlvdXNseSByZXF1ZXN0ZWQuXG4gICAgaWYgKCF0aGlzLmlzUGVuZGluZygpIHx8IG5leHRUaW1lIC0gdGhpcy5uZXh0VGltZV8gPCAtMTApIHtcbiAgICAgIHRoaXMuY2FuY2VsKCk7XG4gICAgICB0aGlzLm5leHRUaW1lXyA9IG5leHRUaW1lO1xuICAgICAgdGhpcy5zY2hlZHVsZWRfID0gdGhpcy50aW1lcl8uZGVsYXkodGhpcy5ib3VuZFBhc3NfLCBkZWxheSk7XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKlxuICAgKi9cbiAgcGFzc18oKSB7XG4gICAgdGhpcy5zY2hlZHVsZWRfID0gLTE7XG4gICAgdGhpcy5uZXh0VGltZV8gPSAwO1xuICAgIHRoaXMucnVubmluZ18gPSB0cnVlO1xuICAgIHRoaXMuaGFuZGxlcl8oKTtcbiAgICB0aGlzLnJ1bm5pbmdfID0gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogQ2FuY2VscyB0aGUgcGVuZGluZyBwYXNzIGlmIGFueS5cbiAgICovXG4gIGNhbmNlbCgpIHtcbiAgICBpZiAodGhpcy5pc1BlbmRpbmcoKSkge1xuICAgICAgdGhpcy50aW1lcl8uY2FuY2VsKHRoaXMuc2NoZWR1bGVkXyk7XG4gICAgICB0aGlzLnNjaGVkdWxlZF8gPSAtMTtcbiAgICB9XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4vbW9kZSc7XG5pbXBvcnQge2luc3RhbGwgYXMgaW5zdGFsbEFycmF5SW5jbHVkZXN9IGZyb20gJy4vcG9seWZpbGxzL2FycmF5LWluY2x1ZGVzJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsQ3VzdG9tRWxlbWVudHN9IGZyb20gJy4vcG9seWZpbGxzL2N1c3RvbS1lbGVtZW50cyc7XG5pbXBvcnQge1xuICBpbnN0YWxsIGFzIGluc3RhbGxET01Ub2tlbkxpc3RUb2dnbGUsXG59IGZyb20gJy4vcG9seWZpbGxzL2RvbXRva2VubGlzdC10b2dnbGUnO1xuaW1wb3J0IHtpbnN0YWxsIGFzIGluc3RhbGxEb2NDb250YWluc30gZnJvbSAnLi9wb2x5ZmlsbHMvZG9jdW1lbnQtY29udGFpbnMnO1xuaW1wb3J0IHtpbnN0YWxsIGFzIGluc3RhbGxNYXRoU2lnbn0gZnJvbSAnLi9wb2x5ZmlsbHMvbWF0aC1zaWduJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsT2JqZWN0QXNzaWdufSBmcm9tICcuL3BvbHlmaWxscy9vYmplY3QtYXNzaWduJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsUHJvbWlzZX0gZnJvbSAnLi9wb2x5ZmlsbHMvcHJvbWlzZSc7XG5pbXBvcnQge2luc3RhbGxDdXN0b21FbGVtZW50cyBhcyBpbnN0YWxsUmVnaXN0ZXJFbGVtZW50fSBmcm9tXG4gICdkb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50L2J1aWxkL2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQucGF0Y2hlZCc7XG5pbXBvcnQge2lzRXhwZXJpbWVudE9ufSBmcm9tICcuL2V4cGVyaW1lbnRzJztcblxuaWYgKGlzRXhwZXJpbWVudE9uKHNlbGYsICdjdXN0b20tZWxlbWVudHMtdjEnKSB8fCBnZXRNb2RlKCkudGVzdCkge1xuICBpbnN0YWxsQ3VzdG9tRWxlbWVudHMoc2VsZiwgY2xhc3Mge30pO1xufSBlbHNlIHtcbiAgaW5zdGFsbFJlZ2lzdGVyRWxlbWVudChzZWxmLCAnYXV0bycpO1xufVxuaW5zdGFsbERPTVRva2VuTGlzdFRvZ2dsZShzZWxmKTtcbmluc3RhbGxNYXRoU2lnbihzZWxmKTtcbmluc3RhbGxPYmplY3RBc3NpZ24oc2VsZik7XG5pbnN0YWxsUHJvbWlzZShzZWxmKTtcbmluc3RhbGxEb2NDb250YWlucyhzZWxmKTtcbmluc3RhbGxBcnJheUluY2x1ZGVzKHNlbGYpO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIGVsZW1lbnQgaXMgaW4gdGhlIGFycmF5IGFuZCBmYWxzZSBvdGhlcndpc2UuXG4gKlxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHBhcmFtIHtudW1iZXI9fSBvcHRfZnJvbUluZGV4XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHRoaXMge0FycmF5fVxuICovXG5mdW5jdGlvbiBpbmNsdWRlcyh2YWx1ZSwgb3B0X2Zyb21JbmRleCkge1xuICBjb25zdCBmcm9tSW5kZXggPSBvcHRfZnJvbUluZGV4IHx8IDA7XG4gIGNvbnN0IGxlbiA9IHRoaXMubGVuZ3RoO1xuICBsZXQgaSA9IGZyb21JbmRleCA+PSAwID8gZnJvbUluZGV4IDogTWF0aC5tYXgobGVuICsgZnJvbUluZGV4LCAwKTtcbiAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgIGNvbnN0IG90aGVyID0gdGhpc1tpXTtcbiAgICAvLyBJZiB2YWx1ZSBoYXMgYmVlbiBmb3VuZCBPUiAodmFsdWUgaXMgTmFOIEFORCBvdGhlciBpcyBOYU4pXG4gICAgLyplc2xpbnQgXCJuby1zZWxmLWNvbXBhcmVcIjogMCovXG4gICAgaWYgKG90aGVyID09PSB2YWx1ZSB8fCAodmFsdWUgIT09IHZhbHVlICYmIG90aGVyICE9PSBvdGhlcikpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuKiBTZXRzIHRoZSBBcnJheS5jb250YWlucyBwb2x5ZmlsbCBpZiBpdCBkb2VzIG5vdCBleGlzdC5cbiogQHBhcmFtIHshV2luZG93fSB3aW5cbiovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzKSB7XG4gICAgd2luLk9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdpbmNsdWRlcycsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogaW5jbHVkZXMsXG4gICAgfSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHByb21pc2U6ICFQcm9taXNlPHVuZGVmaW5lZD4sXG4gKiAgIHJlc29sdmU6IGZ1bmN0aW9uKCksXG4gKiB9fVxuICovXG5sZXQgRGVmZXJyZWREZWY7XG5cbi8qKlxuICogQHR5cGVkZWYgeyFGdW5jdGlvbn1cbiAqL1xubGV0IEN1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZjtcblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogIG5hbWU6IHN0cmluZyxcbiAqICBjdG9yOiAhQ3VzdG9tRWxlbWVudENvbnN0cnVjdG9yRGVmLFxuICogfX1cbiAqL1xubGV0IEN1c3RvbUVsZW1lbnREZWY7XG5cbi8qKlxuICogVmFsaWRhdGVzIHRoZSBjdXN0b20gZWxlbWVudCdzIG5hbWUuXG4gKiBUaGlzIGludGVudGlvbmFsbHkgaWdub3JlcyBcInZhbGlkXCIgaGlnaGVyIFVuaWNvZGUgQ29kZSBQb2ludHMuXG4gKiBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9jdXN0b20tZWxlbWVudHMuaHRtbCN2YWxpZC1jdXN0b20tZWxlbWVudC1uYW1lXG4gKi9cbmNvbnN0IFZBTElEX05BTUUgPSAvXlthLXpdW2EtejAtOS5fXSotW2EtejAtOS5fLV0qJC87XG5jb25zdCBJTlZBTElEX05BTUVTID0gW1xuICAnYW5ub3RhdGlvbi14bWwnLFxuICAnY29sb3ItcHJvZmlsZScsXG4gICdmb250LWZhY2UnLFxuICAnZm9udC1mYWNlLXNyYycsXG4gICdmb250LWZhY2UtdXJpJyxcbiAgJ2ZvbnQtZmFjZS1mb3JtYXQnLFxuICAnZm9udC1mYWNlLW5hbWUnLFxuICAnbWlzc2luZy1nbHlwaCcsXG5dO1xuXG4vKipcbiAqIEFzc2VydHMgdGhhdCB0aGUgY3VzdG9tIGVsZW1lbnQgbmFtZSBjb25mb3JtcyB0byB0aGUgc3BlYy5cbiAqXG4gKiBAcGFyYW0geyFGdW5jdGlvbn0gU3ludGF4RXJyb3JcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gKi9cbmZ1bmN0aW9uIGFzc2VydFZhbGlkTmFtZShTeW50YXhFcnJvciwgbmFtZSkge1xuICBpZiAoIVZBTElEX05BTUUudGVzdChuYW1lKSB8fCBJTlZBTElEX05BTUVTLmluZGV4T2YobmFtZSkgPj0gMCkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgaW52YWxpZCBjdXN0b20gZWxlbWVudCBuYW1lIFwiJHtuYW1lfVwiYCk7XG4gIH1cbn1cblxuLyoqXG4gKiBEb2VzIHdpbiBoYXZlIGEgZnVsbCBDdXN0b20gRWxlbWVudHMgcmVnaXN0cnk/XG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGhhc0N1c3RvbUVsZW1lbnRzKHdpbikge1xuICBjb25zdCB7Y3VzdG9tRWxlbWVudHN9ID0gd2luO1xuXG4gIHJldHVybiAhIShcbiAgICBjdXN0b21FbGVtZW50cyAmJlxuICAgIGN1c3RvbUVsZW1lbnRzLmRlZmluZSAmJlxuICAgIGN1c3RvbUVsZW1lbnRzLmdldCAmJlxuICAgIGN1c3RvbUVsZW1lbnRzLndoZW5EZWZpbmVkKTtcbn1cblxuLyoqXG4gKiBXYXMgSFRNTEVsZW1lbnQgYWxyZWFkeSBwYXRjaGVkIGZvciB0aGlzIHdpbmRvdz9cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNQYXRjaGVkKHdpbikge1xuICBjb25zdCB0YWcgPSB3aW4uSFRNTEVsZW1lbnQudG9TdHJpbmcoKTtcbiAgcmV0dXJuIHRhZy5pbmRleE9mKCdbbmF0aXZlIGNvZGVdJykgPT09IC0xO1xufVxuXG4vKipcbiAqIFRoZSBwdWJsaWMgQ3VzdG9tIEVsZW1lbnRzIEFQSS5cbiAqL1xuY2xhc3MgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5IHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEBwYXJhbSB7IVJlZ2lzdHJ5fSByZWdpc3RyeVxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luLCByZWdpc3RyeSkge1xuICAgIC8qKlxuICAgICAqIEBjb25zdCBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMud2luXyA9IHdpbjtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdCBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMucmVnaXN0cnlfID0gcmVnaXN0cnk7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsIERlZmVycmVkRGVmPn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBjb25zdFxuICAgICAqL1xuICAgIHRoaXMucGVuZGluZ0RlZmluZXNfID0gdGhpcy53aW5fLk9iamVjdC5jcmVhdGUobnVsbCk7XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXIgdGhlIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcGFyYW0geyFDdXN0b21FbGVtZW50Q29uc3RydWN0b3JEZWZ9IGN0b3JcbiAgICogQHBhcmFtIHshT2JqZWN0PX0gb3B0aW9uc1xuICAgKi9cbiAgZGVmaW5lKG5hbWUsIGN0b3IsIG9wdGlvbnMpIHtcbiAgICB0aGlzLnJlZ2lzdHJ5Xy5kZWZpbmUobmFtZSwgY3Rvciwgb3B0aW9ucyk7XG5cbiAgICAvLyBJZiBhbnlvbmUgaXMgd2FpdGluZyBmb3IgdGhpcyBjdXN0b20gZWxlbWVudCB0byBiZSBkZWZpbmVkLCByZXNvbHZlXG4gICAgLy8gdGhlaXIgcHJvbWlzZS5cbiAgICBjb25zdCBwZW5kaW5nID0gdGhpcy5wZW5kaW5nRGVmaW5lc187XG4gICAgY29uc3QgZGVmZXJyZWQgPSBwZW5kaW5nW25hbWVdO1xuICAgIGlmIChkZWZlcnJlZCkge1xuICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgZGVsZXRlIHBlbmRpbmdbbmFtZV07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY29uc3RydWN0b3Igb2YgdGhlIChhbHJlYWR5IGRlZmluZWQpIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcmV0dXJuIHshQ3VzdG9tRWxlbWVudENvbnN0cnVjdG9yRGVmfHVuZGVmaW5lZH1cbiAgICovXG4gIGdldChuYW1lKSB7XG4gICAgY29uc3QgZGVmID0gdGhpcy5yZWdpc3RyeV8uZ2V0QnlOYW1lKG5hbWUpO1xuICAgIGlmIChkZWYpIHtcbiAgICAgIHJldHVybiBkZWYuY3RvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgdGhhdCB3YWl0cyB1bnRpbCB0aGUgY3VzdG9tIGVsZW1lbnQgaXMgZGVmaW5lZC5cbiAgICogSWYgdGhlIGN1c3RvbSBlbGVtZW50IGlzIGFscmVhZHkgZGVmaW5lZCwgcmV0dXJucyBhIHJlc29sdmVkIHByb21pc2UuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAqIEByZXR1cm4geyFQcm9taXNlPHVuZGVmaW5lZD59XG4gICAqL1xuICB3aGVuRGVmaW5lZChuYW1lKSB7XG4gICAgY29uc3Qge1Byb21pc2UsIFN5bnRheEVycm9yfSA9IHRoaXMud2luXztcbiAgICBhc3NlcnRWYWxpZE5hbWUoU3ludGF4RXJyb3IsIG5hbWUpO1xuXG4gICAgaWYgKHRoaXMucmVnaXN0cnlfLmdldEJ5TmFtZShuYW1lKSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cblxuICAgIGNvbnN0IHBlbmRpbmcgPSB0aGlzLnBlbmRpbmdEZWZpbmVzXztcbiAgICBjb25zdCBkZWZlcnJlZCA9IHBlbmRpbmdbbmFtZV07XG4gICAgaWYgKGRlZmVycmVkKSB7XG4gICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBsZXQgcmVzb2x2ZTtcbiAgICBjb25zdCBwcm9taXNlID0gbmV3IC8qT0sqL1Byb21pc2UocmVzID0+IHJlc29sdmUgPSByZXMpO1xuICAgIHBlbmRpbmdbbmFtZV0gPSB7XG4gICAgICBwcm9taXNlLFxuICAgICAgcmVzb2x2ZSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHByb21pc2U7XG4gIH1cblxuICAvKipcbiAgICogVXBncmFkZSBhbGwgY3VzdG9tIGVsZW1lbnRzIGluc2lkZSByb290LlxuICAgKlxuICAgKiBAcGFyYW0geyFOb2RlfSByb290XG4gICAqL1xuICB1cGdyYWRlKHJvb3QpIHtcbiAgICB0aGlzLnJlZ2lzdHJ5Xy51cGdyYWRlKHJvb3QpO1xuICB9XG59XG5cbi8qKlxuICogVGhpcyBpbnRlcm5hbCBBUElzIG5lY2Vzc2FyeSB0byBydW4gdGhlIEN1c3RvbUVsZW1lbnRSZWdpc3RyeS5cbiAqIFNpbmNlIFJlZ2lzdHJ5IGlzIG5ldmVyIGV4cG9zZWQgZXh0ZXJuYWxseSwgYWxsIG1ldGhvZHMgYXJlIGFjdHVhbGx5XG4gKiBhdmFpbGFibGUgb24gdGhlIGluc3RhbmNlLlxuICovXG5jbGFzcyBSZWdpc3RyeSB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luKSB7XG4gICAgLyoqXG4gICAgICogQHByaXZhdGUgQGNvbnN0XG4gICAgICovXG4gICAgdGhpcy53aW5fID0gd2luO1xuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGUgQGNvbnN0XG4gICAgICovXG4gICAgdGhpcy5kb2NfID0gd2luLmRvY3VtZW50O1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCAhQ3VzdG9tRWxlbWVudERlZj59XG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAY29uc3RcbiAgICAgKi9cbiAgICB0aGlzLmRlZmluaXRpb25zXyA9IHdpbi5PYmplY3QuY3JlYXRlKG51bGwpO1xuXG4gICAgLyoqXG4gICAgICogQSB1cC10by1kYXRlIERPTSBzZWxlY3RvciBmb3IgYWxsIGN1c3RvbSBlbGVtZW50cy5cbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIHRoaXMucXVlcnlfID0gJyc7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgY3VycmVudGx5IHVwZ3JhZGluZyBlbGVtZW50LlxuICAgICAqIEBwcml2YXRlIHtFbGVtZW50fVxuICAgICAqL1xuICAgIHRoaXMuY3VycmVudF8gPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50bHktYmVpbmctdXBncmFkZWQgY3VzdG9tIGVsZW1lbnQuXG4gICAqXG4gICAqIFdoZW4gYW4gYWxyZWFkeSBjcmVhdGVkICh0aHJvdWdoIHRoZSBET00gcGFyc2luZyBBUElzLCBvciBpbm5lckhUTUwpXG4gICAqIGN1c3RvbSBlbGVtZW50IG5vZGUgaXMgYmVpbmcgdXBncmFkZWQsIHdlIGNhbid0IGp1c3QgY3JlYXRlIGEgbmV3IG5vZGVcbiAgICogKGl0J3MgaWxsZWdhbCBpbiB0aGUgc3BlYykuIEJ1dCB3ZSBzdGlsbCBuZWVkIHRvIHJ1biB0aGUgY3VzdG9tIGVsZW1lbnQnc1xuICAgKiBjb25zdHJ1Y3RvciBjb2RlIG9uIHRoZSBub2RlLiBXZSBhdm9pZCB0aGlzIGNvbnVuZHJ1bSBieSBydW5uaW5nIHRoZVxuICAgKiBjb25zdHJ1Y3RvciB3aGlsZSByZXR1cm5pbmcgdGhpcyBjdXJyZW50IG5vZGUgaW4gdGhlIEhUTUxFbGVtZW50XG4gICAqIGNsYXNzIGNvbnN0cnVjdG9yICh0aGUgYmFzZSBjbGFzcyBvZiBhbGwgY3VzdG9tIGVsZW1lbnRzKS5cbiAgICpcbiAgICogQHJldHVybiB7RWxlbWVudH1cbiAgICovXG4gIGN1cnJlbnQoKSB7XG4gICAgY29uc3QgY3VycmVudCA9IHRoaXMuY3VycmVudF87XG4gICAgdGhpcy5jdXJyZW50XyA9IG51bGw7XG4gICAgcmV0dXJuIGN1cnJlbnQ7XG4gIH1cblxuICAvKipcbiAgICogRmluZHMgdGhlIGN1c3RvbSBlbGVtZW50IGRlZmluaXRpb24gYnkgbmFtZS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICogQHJldHVybiB7Q3VzdG9tRWxlbWVudERlZnx1bmRlZmluZWR9XG4gICAqL1xuICBnZXRCeU5hbWUobmFtZSkge1xuICAgIGNvbnN0IGRlZmluaXRpb24gPSB0aGlzLmRlZmluaXRpb25zX1tuYW1lXTtcbiAgICBpZiAoZGVmaW5pdGlvbikge1xuICAgICAgcmV0dXJuIGRlZmluaXRpb247XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZpbmRzIHRoZSBjdXN0b20gZWxlbWVudCBkZWZpbml0aW9uIGJ5IGNvbnN0cnVjdG9yIGluc3RhbmNlLlxuICAgKlxuICAgKiBAcGFyYW0ge0N1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZn0gY3RvclxuICAgKiBAcmV0dXJuIHtDdXN0b21FbGVtZW50RGVmfHVuZGVmaW5lZH1cbiAgICovXG4gIGdldEJ5Q29uc3RydWN0b3IoY3Rvcikge1xuICAgIGNvbnN0IGRlZmluaXRpb25zID0gdGhpcy5kZWZpbml0aW9uc187XG5cbiAgICBmb3IgKGNvbnN0IG5hbWUgaW4gZGVmaW5pdGlvbnMpIHtcbiAgICAgIGNvbnN0IGRlZiA9IGRlZmluaXRpb25zW25hbWVdO1xuICAgICAgaWYgKGRlZi5jdG9yID09PSBjdG9yKSB7XG4gICAgICAgIHJldHVybiBkZWY7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVycyB0aGUgY3VzdG9tIGVsZW1lbnQgZGVmaW5pdGlvbiwgYW5kIHVwZ3JhZGVzIGFsbCBlbGVtZW50cyBieSB0aGF0XG4gICAqIG5hbWUgaW4gdGhlIHJvb3QgZG9jdW1lbnQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAqIEBwYXJhbSB7IUN1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZn0gY3RvclxuICAgKiBAcGFyYW0geyFPYmplY3R8dW5kZWZpbmVkfSBvcHRpb25zXG4gICAqL1xuICBkZWZpbmUobmFtZSwgY3Rvciwgb3B0aW9ucykge1xuICAgIGNvbnN0IHtFcnJvciwgU3ludGF4RXJyb3J9ID0gdGhpcy53aW5fO1xuXG4gICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRXh0ZW5kaW5nIG5hdGl2ZSBjdXN0b20gZWxlbWVudHMgaXMgbm90IHN1cHBvcnRlZCcpO1xuICAgIH1cblxuICAgIGFzc2VydFZhbGlkTmFtZShTeW50YXhFcnJvciwgbmFtZSk7XG5cbiAgICBpZiAodGhpcy5nZXRCeU5hbWUobmFtZSkgfHxcbiAgICAgICAgdGhpcy5nZXRCeUNvbnN0cnVjdG9yKGN0b3IpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYGR1cGxpY2F0ZSBkZWZpbml0aW9uIFwiJHtuYW1lfVwiYCk7XG4gICAgfVxuXG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogUmVjb3JkIGNvbm5lY3RlZENhbGxiYWNrLCBkaXNjb25uZWN0ZWRDYWxsYmFjayxcbiAgICAvLyBhZG9wdGVkQ2FsbGJhY2ssIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjaywgYW5kIG9ic2VydmVkQXR0cmlidXRlcy5cbiAgICAvLyBUT0RPKGpyaWRnZXdlbGwpOiBJZiBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2ssIGdhdGhlciBvYnNlcnZlZEF0dHJpYnV0ZXNcbiAgICB0aGlzLmRlZmluaXRpb25zX1tuYW1lXSA9IHtcbiAgICAgIG5hbWUsXG4gICAgICBjdG9yLFxuICAgIH07XG5cbiAgICB0aGlzLm9ic2VydmVfKG5hbWUpO1xuICAgIHRoaXMudXBncmFkZSh0aGlzLmRvY18sIG5hbWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZ3JhZGVzIGN1c3RvbSBlbGVtZW50cyBkZXNjZW5kYW50cyBvZiByb290IChidXQgbm90IGluY2x1ZGluZyByb290KS5cbiAgICpcbiAgICogV2hlbiBjYWxsZWQgd2l0aCBhbiBvcHRfcXVlcnksIGl0IGJvdGggdXBncmFkZXMgYW5kIGNvbm5lY3RzIHRoZSBjdXN0b21cbiAgICogZWxlbWVudHMgKHRoaXMgaXMgdXNlZCBkdXJpbmcgdGhlIGN1c3RvbSBlbGVtZW50IGRlZmluZSBhbGdvcml0aG0pLlxuICAgKlxuICAgKiBAcGFyYW0geyFOb2RlfSByb290XG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X3F1ZXJ5XG4gICAqL1xuICB1cGdyYWRlKHJvb3QsIG9wdF9xdWVyeSkge1xuICAgIC8vIE9ubHkgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5LnAuZGVmaW5lIHByb3ZpZGVzIGEgcXVlcnkgKHRoZSBuZXdseSBkZWZpbmVkXG4gICAgLy8gY3VzdG9tIGVsZW1lbnQpLiBJbiB0aGlzIGNhc2UsIHdlIGFyZSBib3RoIHVwZ3JhZGluZyBfYW5kXyBjb25uZWN0aW5nXG4gICAgLy8gdGhlIGN1c3RvbSBlbGVtZW50cy5cbiAgICBjb25zdCBuZXdseURlZmluZWQgPSAhIW9wdF9xdWVyeTtcbiAgICBjb25zdCBxdWVyeSA9IG9wdF9xdWVyeSB8fCB0aGlzLnF1ZXJ5XztcbiAgICBjb25zdCB1cGdyYWRlQ2FuZGlkYXRlcyA9IHRoaXMucXVlcnlBbGxfKHJvb3QsIHF1ZXJ5KTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXBncmFkZUNhbmRpZGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGNhbmRpZGF0ZSA9IHVwZ3JhZGVDYW5kaWRhdGVzW2ldO1xuICAgICAgaWYgKG5ld2x5RGVmaW5lZCkge1xuICAgICAgICB0aGlzLmNvbm5lY3RlZENhbGxiYWNrXyhjYW5kaWRhdGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy51cGdyYWRlU2VsZihjYW5kaWRhdGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGdyYWRlcyB0aGUgY3VzdG9tIGVsZW1lbnQgbm9kZSwgaWYgYSBjdXN0b20gZWxlbWVudCBoYXMgYmVlbiByZWdpc3RlcmVkXG4gICAqIGJ5IHRoaXMgbmFtZS5cbiAgICpcbiAgICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICAgKi9cbiAgdXBncmFkZVNlbGYobm9kZSkge1xuICAgIGNvbnN0IGRlZiA9IHRoaXMuZ2V0QnlOYW1lKG5vZGUubG9jYWxOYW1lKTtcbiAgICBpZiAoIWRlZikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudXBncmFkZVNlbGZfKC8qKiBAdHlwZSB7IUVsZW1lbnR9ICovKG5vZGUpLCBkZWYpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IU5vZGV9IHJvb3RcbiAgICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5XG4gICAqIEByZXR1cm4geyFBcnJheXwhTm9kZUxpc3R9XG4gICAqL1xuICBxdWVyeUFsbF8ocm9vdCwgcXVlcnkpIHtcbiAgICBpZiAoIXF1ZXJ5IHx8ICFyb290LnF1ZXJ5U2VsZWN0b3JBbGwpIHtcbiAgICAgIC8vIE5vdGhpbmcgdG8gZG8uLi5cbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICByZXR1cm4gcm9vdC5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGdyYWRlcyB0aGUgKGFscmVhZHkgY3JlYXRlZCB2aWEgRE9NIHBhcnNpbmcpIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBub2RlXG4gICAqIEBwYXJhbSB7IUN1c3RvbUVsZW1lbnREZWZ9IGRlZlxuICAgKi9cbiAgdXBncmFkZVNlbGZfKG5vZGUsIGRlZikge1xuICAgIGNvbnN0IHtjdG9yfSA9IGRlZjtcbiAgICBpZiAobm9kZSBpbnN0YW5jZW9mIGN0b3IpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBEZXNwaXRlIGhvdyBpdCBsb29rcywgdGhpcyBpcyBub3QgYSB1c2VsZXNzIGNvbnN0cnVjdGlvbi5cbiAgICAvLyBIVE1MRWxlbWVudFBvbHlmaWxsICh0aGUgYmFzZSBjbGFzcyBvZiBhbGwgY3VzdG9tIGVsZW1lbnRzKSB3aWxsIHJldHVyblxuICAgIC8vIHRoZSBjdXJyZW50IG5vZGUsIGFsbG93aW5nIHRoZSBjdXN0b20gZWxlbWVudCdzIHN1YmNsYXNzIGNvbnN0cnVjdG9yIHRvXG4gICAgLy8gcnVuIG9uIHRoZSBub2RlLiBUaGUgbm9kZSBpdHNlbGYgaXMgYWxyZWFkeSBjb25zdHJ1Y3RlZCwgc28gdGhlIHJldHVyblxuICAgIC8vIHZhbHVlIGlzIGp1c3QgdGhlIG5vZGUuXG4gICAgdGhpcy5jdXJyZW50XyA9IG5vZGU7XG4gICAgY29uc3QgZWwgPSBuZXcgY3RvcigpO1xuXG4gICAgaWYgKGVsICE9PSBub2RlKSB7XG4gICAgICB0aHJvdyBuZXcgdGhpcy53aW5fLkVycm9yKFxuICAgICAgICAgICdDb25zdHJ1Y3RvciBpbGxlZ2FsbHkgcmV0dXJuZWQgYSBkaWZmZXJlbnQgaW5zdGFuY2UuJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZpcmVzIGNvbm5lY3RlZENhbGxiYWNrIG9uIHRoZSBjdXN0b20gZWxlbWVudCwgaWYgaXQgaGFzIG9uZS5cbiAgICogVGhpcyBhbHNvIHVwZ3JhZGVzIHRoZSBjdXN0b20gZWxlbWVudCwgc2luY2UgaXQgbWF5IG5vdCBoYXZlIGJlZW5cbiAgICogYWNjZXNzaWJsZSB2aWEgdGhlIHJvb3QgZG9jdW1lbnQgYmVmb3JlIChhIGRldGFjaGVkIERPTSB0cmVlKS5cbiAgICpcbiAgICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICAgKi9cbiAgY29ubmVjdGVkQ2FsbGJhY2tfKG5vZGUpIHtcbiAgICBjb25zdCBkZWYgPSB0aGlzLmdldEJ5TmFtZShub2RlLmxvY2FsTmFtZSk7XG4gICAgaWYgKCFkZWYpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy51cGdyYWRlU2VsZl8oLyoqIEB0eXBlIHshRWxlbWVudH0gKi8obm9kZSksIGRlZik7XG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogSXQgbWF5IGJlIGFwcHJvcHJpYXRlIHRvIGFkb3B0Q2FsbGJhY2ssIGlmIHRoZSBub2RlXG4gICAgLy8gdXNlZCB0byBiZSBpbiBhbm90aGVyIGRvYy5cbiAgICAvLyBUT0RPKGpyaWRnZXdlbGwpOiBJIHNob3VsZCBiZSBjYWxsaW5nIHRoZSBkZWZpbml0aW9ucyBjb25uZWN0ZWRDYWxsYmFja1xuICAgIC8vIHdpdGggbm9kZSBhcyB0aGUgY29udGV4dC5cbiAgICBpZiAobm9kZS5jb25uZWN0ZWRDYWxsYmFjaykge1xuICAgICAgbm9kZS5jb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGaXJlcyBkaXNjb25uZWN0ZWRDYWxsYmFjayBvbiB0aGUgY3VzdG9tIGVsZW1lbnQsIGlmIGl0IGhhcyBvbmUuXG4gICAqXG4gICAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAgICovXG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrXyhub2RlKSB7XG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogSSBzaG91bGQgYmUgY2FsbGluZyB0aGUgZGVmaW5pdGlvbnMgY29ubmVjdGVkQ2FsbGJhY2tcbiAgICAvLyB3aXRoIG5vZGUgYXMgdGhlIGNvbnRleHQuXG4gICAgaWYgKG5vZGUuZGlzY29ubmVjdGVkQ2FsbGJhY2spIHtcbiAgICAgIG5vZGUuZGlzY29ubmVjdGVkQ2FsbGJhY2soKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkcyBuYW1lIGFzIGEgcmVnaXN0ZXJlZCBjdXN0b20gZWxlbWVudCB0byBvYnNlcnZlLlxuICAgKlxuICAgKiBTdGFydHMgdGhlIE11dGF0aW9uIE9ic2VydmVyIGlmIHRoaXMgaXMgdGhlIGZpcnN0IHJlZ2lzdGVyZWQgY3VzdG9tXG4gICAqIGVsZW1lbnQuIFRoaXMgaXMgZGVmZXJyZWQgdW50aWwgdGhlIGZpcnN0IGN1c3RvbSBlbGVtZW50IGlzIGRlZmluZWQgdG9cbiAgICogc3BlZWQgdXAgaW5pdGlhbCByZW5kZXJpbmcgb2YgdGhlIHBhZ2UuXG4gICAqXG4gICAqIE11dGF0aW9uIE9ic2VydmVycyBhcmUgY29udmVuaWVudGx5IGF2YWlsYWJsZSBpbiBldmVyeSBicm93c2VyIHdlIGNhcmVcbiAgICogYWJvdXQuIFdoZW4gYSBub2RlIGlzIGNvbm5lY3RlZCB0byB0aGUgcm9vdCBkb2N1bWVudCwgYWxsIGN1c3RvbVxuICAgKiBlbGVtZW50cyAoaW5jbHVkaW5nIHRoYXQgbm9kZSBpdGVzZWxmKSB3aWxsIGJlIHVwZ3JhZGVkIGFuZCBjYWxsXG4gICAqIGNvbm5lY3RlZENhbGxiYWNrLiBXaGVuIGEgbm9kZSBpcyBkaXNjb25uZWN0ZWRDYWxsYmFjayBmcm9tIHRoZSByb290XG4gICAqIGRvY3VtZW50LCBhbGwgY3VzdG9tIGVsZW1lbnRzIHdpbGwgY2FsbCBkaXNjb25uZWN0ZWRDYWxsYmFjay5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICovXG4gIG9ic2VydmVfKG5hbWUpIHtcbiAgICBpZiAodGhpcy5xdWVyeV8pIHtcbiAgICAgIHRoaXMucXVlcnlfICs9IGAsJHtuYW1lfWA7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5xdWVyeV8gPSBuYW1lO1xuXG4gICAgLy8gVGhlIGZpcnN0IHJlZ2lzdGVyZWQgbmFtZSBzdGFydHMgdGhlIG11dGF0aW9uIG9ic2VydmVyLlxuICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IHRoaXMud2luXy5NdXRhdGlvbk9ic2VydmVyKHJlY29yZHMgPT4ge1xuICAgICAgaWYgKHJlY29yZHMpIHtcbiAgICAgICAgdGhpcy5oYW5kbGVSZWNvcmRzXyhyZWNvcmRzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBvYnNlcnZlci5vYnNlcnZlKHRoaXMuZG9jXywge1xuICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgc3VidHJlZTogdHJ1ZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgYWxsIHRoZSBNdXRhdGlvbiBPYnNlcnZlcidzIE11dGF0aW9uIFJlY29yZHMuXG4gICAqIEFsbCBhZGRlZCBjdXN0b20gZWxlbWVudHMgd2lsbCBiZSB1cGdyYWRlZCAoaWYgbm90IGFscmVhZHkpIGFuZCBjYWxsXG4gICAqIGNvbm5lY3RlZENhbGxiYWNrLiBBbGwgcmVtb3ZlZCBjdXN0b20gZWxlbWVudHMgd2lsbCBjYWxsXG4gICAqIGRpc2Nvbm5lY3RlZENhbGxiYWNrLlxuICAgKlxuICAgKiBAcGFyYW0geyFBcnJheTwhTXV0YXRpb25SZWNvcmQ+fSByZWNvcmRzXG4gICAqL1xuICBoYW5kbGVSZWNvcmRzXyhyZWNvcmRzKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZWNvcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCByZWNvcmQgPSByZWNvcmRzW2ldO1xuICAgICAgaWYgKCFyZWNvcmQpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHthZGRlZE5vZGVzLCByZW1vdmVkTm9kZXN9ID0gcmVjb3JkO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhZGRlZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBhZGRlZE5vZGVzW2ldO1xuICAgICAgICBjb25zdCBjb25uZWN0ZWRDYW5kaWRhdGVzID0gdGhpcy5xdWVyeUFsbF8obm9kZSwgdGhpcy5xdWVyeV8pO1xuICAgICAgICB0aGlzLmNvbm5lY3RlZENhbGxiYWNrXyhub2RlKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb25uZWN0ZWRDYW5kaWRhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdGhpcy5jb25uZWN0ZWRDYWxsYmFja18oY29ubmVjdGVkQ2FuZGlkYXRlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZW1vdmVkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IHJlbW92ZWROb2Rlc1tpXTtcbiAgICAgICAgY29uc3QgZGlzY29ubmVjdGVkQ2FuZGlkYXRlcyA9IHRoaXMucXVlcnlBbGxfKG5vZGUsIHRoaXMucXVlcnlfKTtcbiAgICAgICAgdGhpcy5kaXNjb25uZWN0ZWRDYWxsYmFja18obm9kZSk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGlzY29ubmVjdGVkQ2FuZGlkYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuZGlzY29ubmVjdGVkQ2FsbGJhY2tfKGRpc2Nvbm5lY3RlZENhbmRpZGF0ZXNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogRG9lcyB0aGUgcG9seWZpbGxpbmcuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5mdW5jdGlvbiBwb2x5ZmlsbCh3aW4pIHtcbiAgY29uc3Qge0hUTUxFbGVtZW50LCBFbGVtZW50LCBOb2RlLCBEb2N1bWVudCwgT2JqZWN0LCBkb2N1bWVudH0gPSB3aW47XG4gIGNvbnN0IHtjcmVhdGVFbGVtZW50LCBjbG9uZU5vZGUsIGltcG9ydE5vZGV9ID0gZG9jdW1lbnQ7XG5cbiAgY29uc3QgcmVnaXN0cnkgPSBuZXcgUmVnaXN0cnkod2luKTtcbiAgY29uc3QgY3VzdG9tRWxlbWVudHMgPSBuZXcgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5KHdpbiwgcmVnaXN0cnkpO1xuXG4gIC8vIEV4cG9zZSB0aGUgY3VzdG9tIGVsZW1lbnQgcmVnaXN0cnkuXG4gIC8vIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LCAnY3VzdG9tRWxlbWVudHMnKVxuICAvLyB7Z2V0OiDGkiwgc2V0OiB1bmRlZmluZWQsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZX1cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbiwgJ2N1c3RvbUVsZW1lbnRzJywge1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIC8vIHdyaXRhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogY3VzdG9tRWxlbWVudHMsXG4gIH0pO1xuXG4gIC8vIFBhdGNoIGNyZWF0ZUVsZW1lbnQgdG8gaW1tZWRpYXRlbHkgdXBncmFkZSB0aGUgY3VzdG9tIGVsZW1lbnQuXG4gIC8vIFRoaXMgaGFzIHRoZSBhZGRlZCBiZW5lZml0IHRoYXQgaXQgYXZvaWRzIHRoZSBcImFscmVhZHkgY3JlYXRlZCBidXQgbmVlZHNcbiAgLy8gY29uc3RydWN0b3IgY29kZSBydW5cIiBjaGlja2VuLWFuZC1lZ2cgcHJvYmxlbS5cbiAgRG9jdW1lbnQucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbiBjcmVhdGVFbGVtZW50UG9seWZpbGwobmFtZSkge1xuICAgIGNvbnN0IGRlZiA9IHJlZ2lzdHJ5LmdldEJ5TmFtZShuYW1lKTtcbiAgICBpZiAoZGVmKSB7XG4gICAgICByZXR1cm4gbmV3IGRlZi5jdG9yKCk7XG4gICAgfVxuICAgIHJldHVybiBjcmVhdGVFbGVtZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgLy8gUGF0Y2ggaW1wb3J0Tm9kZSB0byBpbW1lZGlhdGVseSB1cGdyYWRlIGN1c3RvbSBlbGVtZW50cy5cbiAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogQ2FuIGZpcmUgYWRvcHRlZENhbGxiYWNrIGZvciBjcm9zcyBkb2MgaW1wb3J0cy5cbiAgRG9jdW1lbnQucHJvdG90eXBlLmltcG9ydE5vZGUgPSBmdW5jdGlvbiBpbXBvcnROb2RlUG9seWZpbGwoKSB7XG4gICAgY29uc3QgaW1wb3J0ZWQgPSBpbXBvcnROb2RlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKGltcG9ydGVkKSB7XG4gICAgICByZWdpc3RyeS51cGdyYWRlU2VsZihpbXBvcnRlZCk7XG4gICAgICByZWdpc3RyeS51cGdyYWRlKGltcG9ydGVkKTtcbiAgICB9XG4gICAgcmV0dXJuIGltcG9ydGVkO1xuICB9O1xuXG4gIC8vIFBhdGNoIGNsb25lTm9kZSB0byBpbW1lZGlhdGVseSB1cGdyYWRlIGN1c3RvbSBlbGVtZW50cy5cbiAgTm9kZS5wcm90b3R5cGUuY2xvbmVOb2RlID0gZnVuY3Rpb24gY2xvbmVOb2RlUG9seWZpbGwoKSB7XG4gICAgY29uc3QgY2xvbmVkID0gY2xvbmVOb2RlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgcmVnaXN0cnkudXBncmFkZVNlbGYoY2xvbmVkKTtcbiAgICByZWdpc3RyeS51cGdyYWRlKGNsb25lZCk7XG4gICAgcmV0dXJuIGNsb25lZDtcbiAgfTtcblxuICAvLyBQYXRjaCB0aGUgaW5uZXJIVE1MIHNldHRlciB0byBpbW1lZGlhdGVseSB1cGdyYWRlIGN1c3RvbSBlbGVtZW50cy5cbiAgLy8gTm90ZSwgdGhpcyBjb3VsZCB0ZWNobmljYWxseSBmaXJlIGNvbm5lY3RlZENhbGxiYWNrcyBpZiB0aGlzIG5vZGUgd2FzXG4gIC8vIGNvbm5lY3RlZCwgYnV0IHdlIGxlYXZlIHRoYXQgdG8gdGhlIE11dGF0aW9uIE9ic2VydmVyLlxuICBjb25zdCBpbm5lckhUTUxEZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihFbGVtZW50LnByb3RvdHlwZSxcbiAgICAgICdpbm5lckhUTUwnKTtcbiAgY29uc3QgaW5uZXJIVE1MU2V0dGVyID0gaW5uZXJIVE1MRGVzYy5zZXQ7XG4gIGlubmVySFRNTERlc2Muc2V0ID0gZnVuY3Rpb24oaHRtbCkge1xuICAgIGlubmVySFRNTFNldHRlci5jYWxsKHRoaXMsIGh0bWwpO1xuICAgIHJlZ2lzdHJ5LnVwZ3JhZGUodGhpcyk7XG4gIH07XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFbGVtZW50LnByb3RvdHlwZSwgJ2lubmVySFRNTCcsIGlubmVySFRNTERlc2MpO1xuXG4gIC8qKlxuICAgKiBZb3UgY2FuJ3QgdXNlIHRoZSByZWFsIEhUTUxFbGVtZW50IGNvbnN0cnVjdG9yLCBiZWNhdXNlIHlvdSBjYW4ndCBzdWJjbGFzc1xuICAgKiBpdCB3aXRob3V0IHVzaW5nIG5hdGl2ZSBjbGFzc2VzLiBTbywgbW9jayBpdHMgYXBwcm94aW1hdGlvbiB1c2luZ1xuICAgKiBjcmVhdGVFbGVtZW50LlxuICAgKi9cbiAgZnVuY3Rpb24gSFRNTEVsZW1lbnRQb2x5ZmlsbCgpIHtcbiAgICBjb25zdCB7Y29uc3RydWN0b3J9ID0gdGhpcztcblxuICAgIC8vIElmIHdlJ3JlIHVwZ3JhZGluZyBhbiBhbHJlYWR5IGNyZWF0ZWQgY3VzdG9tIGVsZW1lbnQsIHdlIGNhbid0IGNyZWF0ZVxuICAgIC8vIGFub3RoZXIgbmV3IG5vZGUgKGJ5IHRoZSBzcGVjLCBpdCBtdXN0IGJlIHRoZSBzYW1lIG5vZGUpLlxuICAgIGxldCBlbCA9IHJlZ2lzdHJ5LmN1cnJlbnQoKTtcblxuICAgIC8vIElmIHRoZXJlJ3Mgbm90IGEgYWxyZWFkeSBjcmVhdGVkIGN1c3RvbSBlbGVtZW50LCB3ZSdyZSBiZWluZyBpbnZva2VkIHZpYVxuICAgIC8vIGBuZXdgaW5nIHRoZSBjb25zdHJ1Y3Rvci5cbiAgICAvL1xuICAgIC8vIFRlY2huaWNhbGx5LCB3ZSBjb3VsZCBnZXQgaGVyZSB2aWEgY3JlYXRlRWxlbWVudCwgYnV0IHdlIHBhdGNoZWQgdGhhdC5cbiAgICAvLyBJZiBpdCB0aGUgY3VzdG9tIGVsZW1lbnQgd2FzIHJlZ2lzdGVyZWQsIHRoZSBwYXRjaCB0dXJuZWQgaXQgaW50byBhXG4gICAgLy8gYG5ld2AgY2FsbC5cbiAgICAvLyBJZiBpdCB3YXMgbm90IHJlZ2lzdGVyZWQsIHRoZSBuYXRpdmUgY3JlYXRlRWxlbWVudCBpcyB1c2VkLiBBbmQgaWZcbiAgICAvLyBuYXRpdmUgY3JlYXRlRWxlbWVudCBpcyBiZWluZyB1c2VkIGFuZCB3ZSBnb3QgdG8gdGhpcyBjb2RlLCB3ZSdyZSByZWFsbHlcbiAgICAvLyBpbiBhbiBpbmZpbml0ZSBsb29wIChhIG5hdGl2ZSBjcmVhdGVFbGVtZW50IGNhbGwganVzdCBiZWxvdykgc28gd2UndmVcbiAgICAvLyBnb3QgYmlnZ2VyIHByb2JsZW1zLlxuICAgIC8vXG4gICAgLy8gU28ganVzdCB0YWtlIG15IHdvcmQgd2UgZ290IGhlcmUgdmlhIGBuZXdgLlxuICAgIGlmICghZWwpIHtcbiAgICAgIC8vIFRoZSBjdXN0b20gZWxlbWVudCBkZWZpbml0aW9uIGlzIGFuIGludmFyaWFudC4gSWYgdGhlIGN1c3RvbSBlbGVtZW50XG4gICAgICAvLyBpcyByZWdpc3RlcmVkLCBldmVyeXRoaW5nIHdvcmtzLiBJZiBpdCdzIG5vdCwgaXQgdGhyb3dzIGluIHRoZSBtZW1iZXJcbiAgICAgIC8vIHByb3BlcnR5IGFjY2VzcyAob25seSBkZWZpbmVkIGN1c3RvbSBlbGVtZW50cyBjYW4gYmUgZGlyZWN0bHlcbiAgICAgIC8vIGNvbnN0cnVjdGVkIHZpYSBgbmV3YCkuXG4gICAgICBjb25zdCBkZWYgPSByZWdpc3RyeS5nZXRCeUNvbnN0cnVjdG9yKGNvbnN0cnVjdG9yKTtcbiAgICAgIGVsID0gY3JlYXRlRWxlbWVudC5jYWxsKGRvY3VtZW50LCBkZWYubmFtZSk7XG4gICAgfVxuXG4gICAgLy8gRmluYWxseSwgaWYgdGhlIG5vZGUgd2FzIGFscmVhZHkgY29uc3RydWN0ZWQsIHdlIG5lZWQgdG8gcmVzZXQgaXQnc1xuICAgIC8vIHByb3RvdHlwZSB0byB0aGUgY3VzdG9tIGVsZW1lbnQgcHJvdG90eXBlLiBBbmQgaWYgaXQgd2Fzbid0IGFscmVhZHlcbiAgICAvLyBjb25zdHJ1Y3RlZCwgd2UgY3JlYXRlZCBhIG5ldyBub2RlIHZpYSBuYXRpdmUgY3JlYXRlRWxlbWVudCwgYW5kIHdlIG5lZWRcbiAgICAvLyB0byByZXNldCBpdCdzIHByb3RvdHlwZS4gQmFzaWNhbGx5IGFsd2F5cyByZXNldCB0aGUgcHJvdG90eXBlLlxuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihlbCwgY29uc3RydWN0b3IucHJvdG90eXBlKTtcbiAgICByZXR1cm4gZWw7XG4gIH1cbiAgc3ViQ2xhc3MoT2JqZWN0LCBIVE1MRWxlbWVudCwgSFRNTEVsZW1lbnRQb2x5ZmlsbCk7XG5cbiAgLy8gRXhwb3NlIHRoZSBwb2x5ZmlsbGVkIEhUTUxFbGVtZW50IGNvbnN0cnVjdG9yIGZvciBldmVyeW9uZSB0byBleHRlbmQgZnJvbS5cbiAgd2luLkhUTUxFbGVtZW50ID0gSFRNTEVsZW1lbnRQb2x5ZmlsbDtcbn1cblxuLyoqXG4gKiBXcmFwcyBIVE1MRWxlbWVudCBpbiBhIFJlZmxlY3QuY29uc3RydWN0IGNvbnN0cnVjdG9yLCBzbyB0aGF0IHRyYW5zcGlsZWRcbiAqIGNsYXNzZXMgY2FuIGBfdGhpcyA9IHN1cGVyQ2xhc3MuY2FsbCh0aGlzKWAgZHVyaW5nIHRoZWlyIGNvbnN0cnVjdGlvbi5cbiAqXG4gKiBUaGlzIGlzIG9ubHkgdXNlZCB3aGVuIEN1c3RvbSBFbGVtZW50cyB2MSBpcyBhbHJlYWR5IGF2YWlsYWJsZSBfYW5kXyB3ZSdyZVxuICogdXNpbmcgdHJhbnNwaWxlZCBjbGFzc2VzICh3aGljaCB1c2UgRVM1IGNvbnN0cnVjdGlvbiBpZGlvbXMpLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKi9cbmZ1bmN0aW9uIHdyYXBIVE1MRWxlbWVudCh3aW4pIHtcbiAgY29uc3Qge0hUTUxFbGVtZW50LCBSZWZsZWN0LCBPYmplY3R9ID0gd2luO1xuICAvKipcbiAgICovXG4gIGZ1bmN0aW9uIEhUTUxFbGVtZW50V3JhcHBlcigpIHtcbiAgICBjb25zdCBjdG9yID0gLyoqIEB0eXBlIHtmdW5jdGlvbiguLi4/KTo/fHVuZGVmaW5lZH0gKi8oXG4gICAgICAvKiogQHR5cGUgeyFIVE1MRWxlbWVudH0gKi8odGhpcykuY29uc3RydWN0b3IpO1xuXG4gICAgLy8gUmVmbGVjdC5jb25zdHJ1Y3QgYWxsb3dzIHVzIHRvIGNvbnN0cnVjdCBhIG5ldyBIVE1MRWxlbWVudCB3aXRob3V0IHVzaW5nXG4gICAgLy8gYG5ld2AgKHdoaWNoIHdpbGwgYWx3YXlzIGZhaWwgYmVjYXVzZSBuYXRpdmUgSFRNTEVsZW1lbnQgaXMgYSByZXN0cmljdGVkXG4gICAgLy8gY29uc3RydWN0b3IpLlxuICAgIHJldHVybiBSZWZsZWN0LmNvbnN0cnVjdChIVE1MRWxlbWVudCwgW10sIGN0b3IpO1xuICB9XG4gIHN1YkNsYXNzKE9iamVjdCwgSFRNTEVsZW1lbnQsIEhUTUxFbGVtZW50V3JhcHBlcik7XG5cbiAgLy8gRXhwb3NlIHRoZSB3cmFwcGVkIEhUTUxFbGVtZW50IGNvbnN0cnVjdG9yIGZvciBldmVyeW9uZSB0byBleHRlbmQgZnJvbS5cbiAgd2luLkhUTUxFbGVtZW50ID0gSFRNTEVsZW1lbnRXcmFwcGVyO1xufVxuXG4vKipcbiAqIFNldHVwcyB1cCBwcm90b3R5cGUgaW5oZXJpdGFuY2VcbiAqXG4gKiBAcGFyYW0geyFPYmplY3R9IE9iamVjdFxuICogQHBhcmFtIHshRnVuY3Rpb259IHN1cGVyQ2xhc3NcbiAqIEBwYXJhbSB7IUZ1bmN0aW9ufSBzdWJDbGFzc1xuICovXG5mdW5jdGlvbiBzdWJDbGFzcyhPYmplY3QsIHN1cGVyQ2xhc3MsIHN1YkNsYXNzKSB7XG4gIC8vIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc3VwZXJDbGFzcy5wcm90b3R5cGUsICdjb25zdHJ1Y3RvcicpXG4gIC8vIHt2YWx1ZTogxpIsIHdyaXRhYmxlOiB0cnVlLCBlbnVtZXJhYmxlOiBmYWxzZSwgY29uZmlndXJhYmxlOiB0cnVlfVxuICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7XG4gICAgY29uc3RydWN0b3I6IHtcbiAgICAgIC8vIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogc3ViQ2xhc3MsXG4gICAgfSxcbiAgfSk7XG59XG5cbi8qKlxuICogUG9seWZpbGxzIEN1c3RvbSBFbGVtZW50cyB2MSBBUEkuIFRoaXMgaGFzIDQgbW9kZXM6XG4gKlxuICogMS4gQ3VzdG9tIGVsZW1lbnRzIHYxIGFscmVhZHkgc3VwcG9ydGVkLCB1c2luZyBuYXRpdmUgY2xhc3Nlc1xuICogMi4gQ3VzdG9tIGVsZW1lbnRzIHYxIGFscmVhZHkgc3VwcG9ydGVkLCB1c2luZyB0cmFuc3BpbGVkIGNsYXNzZXNcbiAqIDMuIEN1c3RvbSBlbGVtZW50cyB2MSBub3Qgc3VwcG9ydGVkLCB1c2luZyBuYXRpdmUgY2xhc3Nlc1xuICogNC4gQ3VzdG9tIGVsZW1lbnRzIHYxIG5vdCBzdXBwb3J0ZWQsIHVzaW5nIHRyYW5zcGlsZWQgY2xhc3Nlc1xuICpcbiAqIEluIG1vZGUgMSwgbm90aGluZyBpcyBkb25lLiBJbiBtb2RlIDIsIGEgbWluaW1hbCBwb2x5ZmlsbCBpcyB1c2VkIHRvIHN1cHBvcnRcbiAqIGV4dGVuZGluZyB0aGUgSFRNTEVsZW1lbnQgYmFzZSBjbGFzcy4gSW4gbW9kZSAzIGFuZCA0LCBhIGZ1bGwgcG9seWZpbGwgaXNcbiAqIGRvbmUuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IUZ1bmN0aW9ufSBjdG9yXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnN0YWxsKHdpbiwgY3Rvcikge1xuICBpZiAoaXNQYXRjaGVkKHdpbikpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgaW5zdGFsbCA9IHRydWU7XG4gIGxldCBpbnN0YWxsV3JhcHBlciA9IGZhbHNlO1xuXG4gIGlmIChoYXNDdXN0b21FbGVtZW50cyh3aW4pKSB7XG4gICAgLy8gSWYgY3RvciBpcyBjb25zdHJ1Y3RhYmxlIHdpdGhvdXQgbmV3LCBpdCdzIGEgZnVuY3Rpb24uIFRoYXQgbWVhbnMgaXQgd2FzXG4gICAgLy8gY29tcGlsZWQgZG93biwgYW5kIHdlIG5lZWQgdG8gZG8gdGhlIG1pbmltYWwgcG9seWZpbGwgYmVjYXVzZSBhbGwgeW91XG4gICAgLy8gY2Fubm90IGV4dGVuZCBIVE1MRWxlbWVudCB3aXRob3V0IG5hdGl2ZSBjbGFzc2VzLlxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7T2JqZWN0LCBSZWZsZWN0fSA9IHdpbjtcblxuICAgICAgLy8gXCJDb25zdHJ1Y3RcIiBjdG9yIHVzaW5nIEVTNSBpZGlvbXNcbiAgICAgIGNvbnN0IGluc3RhbmNlID0gT2JqZWN0LmNyZWF0ZShjdG9yLnByb3RvdHlwZSk7XG4gICAgICBjdG9yLmNhbGwoaW5zdGFuY2UpO1xuXG4gICAgICAvLyBJZiB0aGF0IHN1Y2NlZWRlZCwgd2UncmUgaW4gYSB0cmFuc3BpbGVkIGVudmlyb25tZW50XG4gICAgICAvLyBMZXQncyBmaW5kIG91dCBpZiB3ZSBjYW4gd3JhcCBIVE1MRWxlbWVudCBhbmQgYXZvaWQgYSBmdWxsIHBhdGNoLlxuICAgICAgaW5zdGFsbFdyYXBwZXIgPSAhIShSZWZsZWN0ICYmIFJlZmxlY3QuY29uc3RydWN0KTtcbiAgICB9IGNhdGNoIChlKSB7XG5cbiAgICAgIC8vIFRoZSBjdG9yIHRocmV3IHdoZW4gd2UgY29uc3RydWN0ZWQgaXMgdmlhIEVTNSwgc28gaXQncyBhIHJlYWwgY2xhc3MuXG4gICAgICAvLyBXZSdyZSBvayB0byBub3QgaW5zdGFsbCB0aGUgcG9seWZpbGwuXG4gICAgICBpbnN0YWxsID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgaWYgKGluc3RhbGxXcmFwcGVyKSB7XG4gICAgd3JhcEhUTUxFbGVtZW50KHdpbik7XG4gIH0gZWxzZSBpZiAoaW5zdGFsbCkge1xuICAgIHBvbHlmaWxsKHdpbik7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogUG9seWZpbGwgZm9yIGBkb2N1bWVudC5jb250YWlucygpYCBtZXRob2QuIE5vdGljZSB0aGF0IGFjY29yZGluZyB0byBzcGVjXG4gKiBgZG9jdW1lbnQuY29udGFpbnNgIGlzIGluY2x1c2lvbmFyeS5cbiAqIFNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvTm9kZS9jb250YWluc1xuICogQHBhcmFtIHs/Tm9kZX0gbm9kZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0aGlzIHtOb2RlfVxuICovXG5mdW5jdGlvbiBkb2N1bWVudENvbnRhaW5zUG9seWZpbGwobm9kZSkge1xuICAvLyBQZXIgc3BlYywgXCJjb250YWluc1wiIG1ldGhvZCBpcyBpbmNsdXNpb25hcnlcbiAgLy8gaS5lLiBgbm9kZS5jb250YWlucyhub2RlKSA9PSB0cnVlYC4gSG93ZXZlciwgd2Ugc3RpbGwgbmVlZCB0byB0ZXN0XG4gIC8vIGVxdWFsaXR5IHRvIHRoZSBkb2N1bWVudCBpdHNlbGYuXG4gIHJldHVybiBub2RlID09IHRoaXMgfHwgdGhpcy5kb2N1bWVudEVsZW1lbnQuY29udGFpbnMobm9kZSk7XG59XG5cblxuLyoqXG4gKiBQb2x5ZmlsbHMgYEhUTUxEb2N1bWVudC5jb250YWluc2AgQVBJLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIC8vIEhUTUxEb2N1bWVudCBpcyB1bmRlZmluZWQgaW4gSW50ZXJuZXQgRXhwbG9yZXIgMTAsIGJ1dCBpdCBoYXMgRG9jdW1lbnQsXG4gIC8vIHNvIHdlIHVzZSB0aGF0IGFzIGEgZmFsbGJhY2suXG4gIGNvbnN0IGRvY3VtZW50Q2xhc3MgPSB3aW4uSFRNTERvY3VtZW50IHx8IHdpbi5Eb2N1bWVudDtcbiAgaWYgKCFkb2N1bWVudENsYXNzLnByb3RvdHlwZS5jb250YWlucykge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkoZG9jdW1lbnRDbGFzcy5wcm90b3R5cGUsICdjb250YWlucycsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogZG9jdW1lbnRDb250YWluc1BvbHlmaWxsLFxuICAgIH0pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBgRE9NVG9rZW5MaXN0LnByb3RvdHlwZS50b2dnbGUodG9rZW4sIG9wdF9mb3JjZSlgIG1ldGhvZC4gVGhpc1xuICogaXMgc3BlY2lhbGx5IGltcG9ydGFudCBiZWNhdXNlIElFIGRvZXMgbm90IHN1cHBvcnQgYG9wdF9mb3JjZWAgYXR0cmlidXRlLiBTZWVcbiAqIGh0dHBzOi8vZ29vLmdsL2hnS05ZWSBmb3IgZGV0YWlscy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0b2tlblxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2ZvcmNlXG4gKiBAdGhpcyB7RE9NVG9rZW5MaXN0fVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gZG9tVG9rZW5MaXN0VG9nZ2xlUG9seWZpbGwodG9rZW4sIG9wdF9mb3JjZSkge1xuICBjb25zdCByZW1vdmUgPSBvcHRfZm9yY2UgPT09IHVuZGVmaW5lZCA/IHRoaXMuY29udGFpbnModG9rZW4pIDogIW9wdF9mb3JjZTtcbiAgaWYgKHJlbW92ZSkge1xuICAgIHRoaXMucmVtb3ZlKHRva2VuKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5hZGQodG9rZW4pO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG5cblxuLyoqXG4gKiBQb2x5ZmlsbHMgYERPTVRva2VuTGlzdC5wcm90b3R5cGUudG9nZ2xlYCBBUEkgaW4gSUUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKGlzSWUod2luKSAmJiB3aW4uRE9NVG9rZW5MaXN0KSB7XG4gICAgd2luLk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW4uRE9NVG9rZW5MaXN0LnByb3RvdHlwZSwgJ3RvZ2dsZScsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogZG9tVG9rZW5MaXN0VG9nZ2xlUG9seWZpbGwsXG4gICAgfSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGN1cnJlbnQgYnJvd3NlciBpcyBhIElFIGJyb3dzZXIuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNJZSh3aW4pIHtcbiAgcmV0dXJuIC9UcmlkZW50fE1TSUV8SUVNb2JpbGUvaS50ZXN0KHdpbi5uYXZpZ2F0b3IudXNlckFnZW50KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIFBhcnNlcyB0aGUgbnVtYmVyIHggYW5kIHJldHVybnMgaXRzIHNpZ24uIEZvciBwb3NpdGl2ZSB4IHJldHVybnMgMSwgZm9yXG4gKiBuZWdhdGl2ZSwgLTEuIEZvciAwIGFuZCAtMCwgcmV0dXJucyAwIGFuZCAtMCByZXNwZWN0aXZlbHkuIEZvciBhbnkgbnVtYmVyXG4gKiB0aGF0IHBhcnNlcyB0byBOYU4sIHJldHVybnMgTmFOLlxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gKiBAcmV0dXJuIHtudW1iZXJ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaWduKHgpIHtcbiAgeCA9IE51bWJlcih4KTtcblxuICAvLyBJZiB4IGlzIDAsIC0wLCBvciBOYU4sIHJldHVybiBpdC5cbiAgaWYgKCF4KSB7XG4gICAgcmV0dXJuIHg7XG4gIH1cblxuICByZXR1cm4geCA+IDAgPyAxIDogLTE7XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBNYXRoLnNpZ24gcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uTWF0aC5zaWduKSB7XG4gICAgd2luLk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW4uTWF0aCwgJ3NpZ24nLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IHNpZ24sXG4gICAgfSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5jb25zdCB7aGFzT3duUHJvcGVydHl9ID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqXG4gKiBDb3BpZXMgdmFsdWVzIG9mIGFsbCBlbnVtZXJhYmxlIG93biBwcm9wZXJ0aWVzIGZyb20gb25lIG9yIG1vcmUgc291cmNlXG4gKiBvYmplY3RzIChwcm92aWRlZCBhcyBleHRlbmRlZCBhcmd1bWVudHMgdG8gdGhlIGZ1bmN0aW9uKSB0byBhIHRhcmdldCBvYmplY3QuXG4gKlxuICogQHBhcmFtIHshT2JqZWN0fSB0YXJnZXRcbiAqIEBwYXJhbSB7Li4uT2JqZWN0fSB2YXJfYXJnc1xuICogQHJldHVybiB7IU9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQsIHZhcl9hcmdzKSB7XG4gIGlmICh0YXJnZXQgPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjb252ZXJ0IHVuZGVmaW5lZCBvciBudWxsIHRvIG9iamVjdCcpO1xuICB9XG5cbiAgY29uc3Qgb3V0cHV0ID0gT2JqZWN0KHRhcmdldCk7XG4gIGZvciAobGV0IGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgIGlmIChzb3VyY2UgIT0gbnVsbCkge1xuICAgICAgZm9yIChjb25zdCBrZXkgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkge1xuICAgICAgICAgIG91dHB1dFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG91dHB1dDtcbn1cblxuXG4vKipcbiAqIFNldHMgdGhlIE9iamVjdC5hc3NpZ24gcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uT2JqZWN0LmFzc2lnbikge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkod2luLk9iamVjdCwgJ2Fzc2lnbicsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogYXNzaWduLFxuICAgIH0pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG5pbXBvcnQgKiBhcyBQcm9taXNlIGZyb20gJ3Byb21pc2UtcGpzL3Byb21pc2UnO1xuXG4vKipcbiAqIFNldHMgdGhlIFByb21pc2UgcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uUHJvbWlzZSkge1xuICAgIHdpbi5Qcm9taXNlID0gLyoqIEB0eXBlIHs/fSAqLyAoUHJvbWlzZSk7XG4gICAgLy8gSW4gYmFiZWwgdGhlICogZXhwb3J0IGlzIGFuIE9iamVjdCB3aXRoIGEgZGVmYXVsdCBwcm9wZXJ0eS5cbiAgICAvLyBJbiBjbG9zdXJlIGNvbXBpbGVyIGl0IGlzIHRoZSBQcm9taXNlIGZ1bmN0aW9uIGl0c2VsZi5cbiAgICBpZiAoUHJvbWlzZS5kZWZhdWx0KSB7XG4gICAgICB3aW4uUHJvbWlzZSA9IFByb21pc2UuZGVmYXVsdDtcbiAgICB9XG4gICAgLy8gV2UgY29weSB0aGUgaW5kaXZpZHVhbCBzdGF0aWMgbWV0aG9kcywgYmVjYXVzZSBjbG9zdXJlXG4gICAgLy8gY29tcGlsZXIgZmxhdHRlbnMgdGhlIHBvbHlmaWxsIG5hbWVzcGFjZS5cbiAgICB3aW4uUHJvbWlzZS5yZXNvbHZlID0gUHJvbWlzZS5yZXNvbHZlO1xuICAgIHdpbi5Qcm9taXNlLnJlamVjdCA9IFByb21pc2UucmVqZWN0O1xuICAgIHdpbi5Qcm9taXNlLmFsbCA9IFByb21pc2UuYWxsO1xuICAgIHdpbi5Qcm9taXNlLnJhY2UgPSBQcm9taXNlLnJhY2U7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgUmVnaXN0cmF0aW9uIGFuZCBnZXR0ZXIgZnVuY3Rpb25zIGZvciBBTVAgc2VydmljZXMuXG4gKlxuICogSW52YXJpYW50OiBTZXJ2aWNlIGdldHRlcnMgbmV2ZXIgcmV0dXJuIG51bGwgZm9yIHJlZ2lzdGVyZWQgc2VydmljZXMuXG4gKi9cblxuLy8gc3JjL3BvbHlmaWxscy5qcyBtdXN0IGJlIHRoZSBmaXJzdCBpbXBvcnQuXG5pbXBvcnQgJy4vcG9seWZpbGxzJzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBzb3J0LWltcG9ydHMtZXM2LWF1dG9maXgvc29ydC1pbXBvcnRzLWVzNlxuXG5pbXBvcnQge0RlZmVycmVkfSBmcm9tICcuL3V0aWxzL3Byb21pc2UnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7dG9XaW59IGZyb20gJy4vdHlwZXMnO1xuXG5cbi8qKlxuICogSG9sZHMgaW5mbyBhYm91dCBhIHNlcnZpY2UuXG4gKiAtIG9iajogQWN0dWFsIHNlcnZpY2UgaW1wbGVtZW50YXRpb24gd2hlbiBhdmFpbGFibGUuXG4gKiAtIHByb21pc2U6IFByb21pc2UgZm9yIHRoZSBvYmouXG4gKiAtIHJlc29sdmU6IEZ1bmN0aW9uIHRvIHJlc29sdmUgdGhlIHByb21pc2Ugd2l0aCB0aGUgb2JqZWN0LlxuICogLSBjb250ZXh0OiBBcmd1bWVudCBmb3IgY3RvciwgZWl0aGVyIGEgd2luZG93IG9yIGFuIGFtcGRvYy5cbiAqIC0gY3RvcjogRnVuY3Rpb24gdGhhdCBjb25zdHJ1Y3RzIGFuZCByZXR1cm5zIHRoZSBzZXJ2aWNlLlxuICogQHR5cGVkZWYge3tcbiAqICAgb2JqOiAoP09iamVjdCksXG4gKiAgIHByb21pc2U6ICg/UHJvbWlzZSksXG4gKiAgIHJlc29sdmU6ICg/ZnVuY3Rpb24oIU9iamVjdCkpLFxuICogICBjb250ZXh0OiAoP1dpbmRvd3w/Li9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvYyksXG4gKiAgIGN0b3I6ICg/ZnVuY3Rpb24obmV3Ok9iamVjdCwgIVdpbmRvdyl8XG4gKiAgICAgICAgICA/ZnVuY3Rpb24obmV3Ok9iamVjdCwgIS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2MpKSxcbiAqIH19XG4gKi9cbmxldCBTZXJ2aWNlSG9sZGVyRGVmO1xuXG5cbi8qKlxuICogVGhpcyBpbnRlcmZhY2UgcHJvdmlkZXMgYSBgZGlzcG9zZWAgbWV0aG9kIHRoYXQgd2lsbCBiZSBjYWxsZWQgYnlcbiAqIHJ1bnRpbWUgd2hlbiBhIHNlcnZpY2UgbmVlZHMgdG8gYmUgZGlzcG9zZWQgb2YuXG4gKiBAaW50ZXJmYWNlXG4gKi9cbmV4cG9ydCBjbGFzcyBEaXNwb3NhYmxlIHtcblxuICAvKipcbiAgICogSW5zdHJ1Y3RzIHRoZSBzZXJ2aWNlIHRvIHJlbGVhc2UgYW55IHJlc291cmNlcyBpdCBtaWdodCBiZSBob2xkaW5nLiBDYW5cbiAgICogYmUgY2FsbGVkIG9ubHkgb25jZSBpbiB0aGUgbGlmZWN5Y2xlIG9mIGEgc2VydmljZS5cbiAgICovXG4gIGRpc3Bvc2UoKSB7fVxufVxuXG5cbi8qKlxuICogVGhpcyBpbnRlcmZhY2UgcHJvdmlkZXMgYSBgYWRvcHRFbWJlZFdpbmRvd2AgbWV0aG9kIHRoYXQgd2lsbCBiZSBjYWxsZWQgYnlcbiAqIHJ1bnRpbWUgZm9yIGEgbmV3IGVtYmVkIHdpbmRvdy5cbiAqIEBpbnRlcmZhY2VcbiAqL1xuZXhwb3J0IGNsYXNzIEVtYmVkZGFibGVTZXJ2aWNlIHtcblxuICAvKipcbiAgICogSW5zdHJ1Y3RzIHRoZSBzZXJ2aWNlIHRvIGFkb3B0IHRoZSBlbWJlZCB3aW5kb3cgYW5kIGFkZCBhbnkgbmVjZXNzYXJ5XG4gICAqIGxpc3RlbmVycyBhbmQgcmVzb3VyY2VzLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHVudXNlZEVtYmVkV2luXG4gICAqL1xuICBhZG9wdEVtYmVkV2luZG93KHVudXNlZEVtYmVkV2luKSB7fVxufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2Ugd2l0aCB0aGUgZ2l2ZW4gaWQuIEFzc3VtZXMgdGhhdCBpdCBoYXMgYmVlbiByZWdpc3RlcmVkXG4gKiBhbHJlYWR5LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2ZhbGxiYWNrVG9Ub3BXaW5cbiAqIEByZXR1cm4ge09iamVjdH0gVGhlIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFeGlzdGluZ1NlcnZpY2VJbkVtYmVkU2NvcGUod2luLCBpZCwgb3B0X2ZhbGxiYWNrVG9Ub3BXaW4pIHtcbiAgLy8gRmlyc3QsIHRyeSB0byByZXNvbHZlIHZpYSBsb2NhbCAoZW1iZWQpIHdpbmRvdy5cbiAgY29uc3QgbG9jYWwgPSBnZXRMb2NhbEV4aXN0aW5nU2VydmljZUZvckVtYmVkV2luT3JOdWxsKHdpbiwgaWQpO1xuICBpZiAobG9jYWwpIHtcbiAgICByZXR1cm4gbG9jYWw7XG4gIH1cbiAgaWYgKG9wdF9mYWxsYmFja1RvVG9wV2luKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2Uod2luLCBpZCk7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2Ugd2l0aCB0aGUgZ2l2ZW4gaWQuIEFzc3VtZXMgdGhhdCBpdCBoYXMgYmVlbiBjb25zdHJ1Y3RlZFxuICogYWxyZWFkeS5cbiAqXG4gKiBVbmxpa2UgbW9zdCBzZXJ2aWNlIGdldHRlcnMsIHBhc3NpbmcgYE5vZGVgIGlzIG5lY2Vzc2FyeSBmb3Igc29tZSBGSUUtc2NvcGVcbiAqIHNlcnZpY2VzIHNpbmNlIHNvbWV0aW1lcyB3ZSBvbmx5IGhhdmUgdGhlIEZJRSBEb2N1bWVudCBmb3IgY29udGV4dC5cbiAqXG4gKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2ZhbGxiYWNrVG9Ub3BXaW5cbiAqIEByZXR1cm4ge09iamVjdH0gVGhlIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUoXG4gIG5vZGVPckRvYywgaWQsIG9wdF9mYWxsYmFja1RvVG9wV2luKSB7XG4gIC8vIEZpcnN0LCB0cnkgdG8gcmVzb2x2ZSB2aWEgbG9jYWwgKGVtYmVkKSB3aW5kb3cuXG4gIGlmIChub2RlT3JEb2Mubm9kZVR5cGUpIHtcbiAgICAvLyBJZiBhIG5vZGUgaXMgcGFzc2VkLCB0cnkgdG8gcmVzb2x2ZSB2aWEgdGhpcyBub2RlLlxuICAgIGNvbnN0IHdpbiA9IHRvV2luKC8qKiBAdHlwZSB7IURvY3VtZW50fSAqLyAoXG4gICAgICBub2RlT3JEb2Mub3duZXJEb2N1bWVudCB8fCBub2RlT3JEb2MpLmRlZmF1bHRWaWV3KTtcbiAgICBjb25zdCBsb2NhbCA9IGdldExvY2FsRXhpc3RpbmdTZXJ2aWNlRm9yRW1iZWRXaW5Pck51bGwod2luLCBpZCk7XG4gICAgaWYgKGxvY2FsKSB7XG4gICAgICByZXR1cm4gbG9jYWw7XG4gICAgfVxuICB9XG4gIC8vIElmIGFuIGFtcGRvYyBpcyBwYXNzZWQgb3IgZmFsbGJhY2sgaXMgYWxsb3dlZCwgY29udGludWUgcmVzb2x2aW5nLlxuICBpZiAoIW5vZGVPckRvYy5ub2RlVHlwZSB8fCBvcHRfZmFsbGJhY2tUb1RvcFdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZChub2RlT3JEb2MsIGlkKTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBJbnN0YWxscyBhIHNlcnZpY2Ugb3ZlcnJpZGUgb24gYW1wLWRvYyBsZXZlbC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gZW1iZWRXaW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHshT2JqZWN0fSBzZXJ2aWNlIFRoZSBzZXJ2aWNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbFNlcnZpY2VJbkVtYmVkU2NvcGUoZW1iZWRXaW4sIGlkLCBzZXJ2aWNlKSB7XG4gIGNvbnN0IHRvcFdpbiA9IGdldFRvcFdpbmRvdyhlbWJlZFdpbik7XG4gIGRldigpLmFzc2VydChlbWJlZFdpbiAhPSB0b3BXaW4sXG4gICAgICAnU2VydmljZSBvdmVycmlkZSBjYW4gb25seSBiZSBpbnN0YWxsZWQgaW4gZW1iZWQgd2luZG93OiAlcycsIGlkKTtcbiAgZGV2KCkuYXNzZXJ0KCFnZXRMb2NhbEV4aXN0aW5nU2VydmljZUZvckVtYmVkV2luT3JOdWxsKGVtYmVkV2luLCBpZCksXG4gICAgICAnU2VydmljZSBvdmVycmlkZSBoYXMgYWxyZWFkeSBiZWVuIGluc3RhbGxlZDogJXMnLCBpZCk7XG4gIHJlZ2lzdGVyU2VydmljZUludGVybmFsKGVtYmVkV2luLCBlbWJlZFdpbiwgaWQsICgpID0+IHNlcnZpY2UpO1xuICBnZXRTZXJ2aWNlSW50ZXJuYWwoZW1iZWRXaW4sIGlkKTsgLy8gRm9yY2Ugc2VydmljZSB0byBidWlsZC5cbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IGVtYmVkV2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4gez9PYmplY3R9XG4gKi9cbmZ1bmN0aW9uIGdldExvY2FsRXhpc3RpbmdTZXJ2aWNlRm9yRW1iZWRXaW5Pck51bGwoZW1iZWRXaW4sIGlkKSB7XG4gIC8vIE5vdGUgdGhhdCB0aGlzIG1ldGhvZCBjdXJyZW50bHkgb25seSByZXNvbHZlcyBhZ2FpbnN0IHRoZSBnaXZlbiB3aW5kb3cuXG4gIC8vIEl0IGRvZXMgbm90IHRyeSB0byBnbyBhbGwgdGhlIHdheSB1cCB0aGUgcGFyZW50IHdpbmRvdyBjaGFpbi4gV2UgY2FuIGNoYW5nZVxuICAvLyB0aGlzIGluIHRoZSBmdXR1cmUsIGJ1dCBmb3Igbm93IHRoaXMgZ2l2ZXMgdXMgYSBiZXR0ZXIgcGVyZm9ybWFuY2UuXG4gIGNvbnN0IHRvcFdpbiA9IGdldFRvcFdpbmRvdyhlbWJlZFdpbik7XG4gIGlmIChlbWJlZFdpbiAhPSB0b3BXaW4gJiYgaXNTZXJ2aWNlUmVnaXN0ZXJlZChlbWJlZFdpbiwgaWQpKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2VJbnRlcm5hbChlbWJlZFdpbiwgaWQpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogUmVnaXN0ZXJzIGEgc2VydmljZSBnaXZlbiBhIGNsYXNzIHRvIGJlIHVzZWQgYXMgaW1wbGVtZW50YXRpb24uXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtmdW5jdGlvbihuZXc6T2JqZWN0LCAhV2luZG93KX0gY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pbnN0YW50aWF0ZSBXaGV0aGVyIHRvIGltbWVkaWF0ZWx5IGNyZWF0ZSB0aGUgc2VydmljZVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJTZXJ2aWNlQnVpbGRlcih3aW4sXG4gIGlkLFxuICBjb25zdHJ1Y3RvcixcbiAgb3B0X2luc3RhbnRpYXRlKSB7XG4gIHdpbiA9IGdldFRvcFdpbmRvdyh3aW4pO1xuICByZWdpc3RlclNlcnZpY2VJbnRlcm5hbCh3aW4sIHdpbiwgaWQsIGNvbnN0cnVjdG9yKTtcbiAgaWYgKG9wdF9pbnN0YW50aWF0ZSkge1xuICAgIGdldFNlcnZpY2VJbnRlcm5hbCh3aW4sIGlkKTtcbiAgfVxufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2UgYW5kIHJlZ2lzdGVycyBpdCBnaXZlbiBhIGNsYXNzIHRvIGJlIHVzZWQgYXNcbiAqIGltcGxlbWVudGF0aW9uLlxuICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKG5ldzpPYmplY3QsICEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jKX0gY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pbnN0YW50aWF0ZSBXaGV0aGVyIHRvIGltbWVkaWF0ZWx5IGNyZWF0ZSB0aGUgc2VydmljZVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJTZXJ2aWNlQnVpbGRlckZvckRvYyhub2RlT3JEb2MsXG4gIGlkLFxuICBjb25zdHJ1Y3RvcixcbiAgb3B0X2luc3RhbnRpYXRlKSB7XG4gIGNvbnN0IGFtcGRvYyA9IGdldEFtcGRvYyhub2RlT3JEb2MpO1xuICBjb25zdCBob2xkZXIgPSBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGFtcGRvYyk7XG4gIHJlZ2lzdGVyU2VydmljZUludGVybmFsKGhvbGRlciwgYW1wZG9jLCBpZCwgY29uc3RydWN0b3IpO1xuICBpZiAob3B0X2luc3RhbnRpYXRlKSB7XG4gICAgZ2V0U2VydmljZUludGVybmFsKGhvbGRlciwgaWQpO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VydmljZSBmb3IgdGhlIGdpdmVuIGlkIGFuZCB3aW5kb3cgKGEgcGVyLXdpbmRvdyBzaW5nbGV0b24pLiBVc2Vyc1xuICogc2hvdWxkIHR5cGljYWxseSB3cmFwIHRoaXMgYXMgYSBzcGVjaWFsIHB1cnBvc2UgZnVuY3Rpb24gKGUuZy5cbiAqIGBTZXJ2aWNlcy52c3luY0Zvcih3aW4pYCkgZm9yIHR5cGUgc2FmZXR5IGFuZCBiZWNhdXNlIHRoZSBmYWN0b3J5IHNob3VsZCBub3RcbiAqIGJlIHBhc3NlZCBhcm91bmQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHRlbXBsYXRlIFRcbiAqIEByZXR1cm4ge1R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlKHdpbiwgaWQpIHtcbiAgd2luID0gZ2V0VG9wV2luZG93KHdpbik7XG4gIHJldHVybiBnZXRTZXJ2aWNlSW50ZXJuYWwod2luLCBpZCk7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIHdpbmRvdy4gQWxzbyBleHBlY3RzIGFuXG4gKiBlbGVtZW50IHRoYXQgaGFzIHRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24uIFRoZSBwcm9taXNlIHJlc29sdmVzIHdoZW4gdGhlXG4gKiBpbXBsZW1lbnRhdGlvbiBsb2FkZWQuIFVzZXJzIHNob3VsZCB0eXBpY2FsbHkgd3JhcCB0aGlzIGFzIGEgc3BlY2lhbCBwdXJwb3NlXG4gKiBmdW5jdGlvbiAoZS5nLiBgU2VydmljZXMudnN5bmNGb3Iod2luKWApIGZvciB0eXBlIHNhZmV0eSBhbmQgYmVjYXVzZSB0aGVcbiAqIGZhY3Rvcnkgc2hvdWxkIG5vdCBiZSBwYXNzZWQgYXJvdW5kLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEByZXR1cm4geyFQcm9taXNlPCFPYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2Uod2luLCBpZCkge1xuICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VJbnRlcm5hbCh3aW4sIGlkKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBzZXJ2aWNlIG9yIG51bGwgd2l0aCB0aGUgZ2l2ZW4gaWQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJuIHs/T2JqZWN0fSBUaGUgc2VydmljZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4aXN0aW5nU2VydmljZU9yTnVsbCh3aW4sIGlkKSB7XG4gIHdpbiA9IGdldFRvcFdpbmRvdyh3aW4pO1xuICBpZiAoaXNTZXJ2aWNlUmVnaXN0ZXJlZCh3aW4sIGlkKSkge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlSW50ZXJuYWwod2luLCBpZCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuXG4vKipcbiAqIExpa2UgZ2V0U2VydmljZVByb21pc2UgYnV0IHJldHVybnMgbnVsbCBpZiB0aGUgc2VydmljZSB3YXMgbmV2ZXIgcmVnaXN0ZXJlZC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4gez9Qcm9taXNlPCFPYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2VPck51bGwod2luLCBpZCkge1xuICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VPck51bGxJbnRlcm5hbCh3aW4sIGlkKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIGFtcGRvYyAoYSBwZXItYW1wZG9jIHNpbmdsZXRvbikuXG4gKiBFeHBlY3RzIHNlcnZpY2UgYGlkYCB0byBiZSByZWdpc3RlcmVkLlxuICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4ge1R9XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGlkKSB7XG4gIGNvbnN0IGFtcGRvYyA9IGdldEFtcGRvYyhlbGVtZW50T3JBbXBEb2MpO1xuICBjb25zdCBob2xkZXIgPSBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGFtcGRvYyk7XG4gIHJldHVybiBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCk7XG59XG5cblxuLyoqXG4gKiB0bDtkciAtLSBVc2UgZ2V0U2VydmljZUZvckRvYygpIGluc3RlYWQgb2YgdGhpcy5cbiAqXG4gKiBQcml2aWxlZ2VkIHZhcmlhbnQgb2YgZ2V0U2VydmljZUZvckRvYygpIHRoYXQgYWNjZXB0cyBub24tZWxlbWVudCBwYXJhbXMsXG4gKiBlLmcuIHdpbmRvdy5kb2N1bWVudC4gVGhpcyBpcyBjdXJyZW50bHkgbmVjZXNzYXJ5IGZvciBkb2MtbGV2ZWwgc2VydmljZXNcbiAqIHVzZWQgaW4gc3RhcnR1cCwgZS5nLiBDaHVua3MuIEV2ZW50dWFsbHkgd2Ugd2FudCB0byByZW1vdmUgdGhpcyBmdW5jdGlvblxuICogYW5kIGhhdmUgY2FsbGVycyBmaW5kIHRoZSBhcHByb3ByaWF0ZSBBbXBEb2MgYW5kIHVzZSBnZXRTZXJ2aWNlRm9yRG9jKCkuXG4gKlxuICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4ge1R9XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQobm9kZU9yRG9jLCBpZCkge1xuICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2Mobm9kZU9yRG9jKTtcbiAgY29uc3QgaG9sZGVyID0gZ2V0QW1wZG9jU2VydmljZUhvbGRlcihhbXBkb2MpO1xuICByZXR1cm4gZ2V0U2VydmljZUludGVybmFsKGhvbGRlciwgaWQpO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgZm9yIGEgc2VydmljZSBmb3IgdGhlIGdpdmVuIGlkIGFuZCBhbXBkb2MuIEFsc28gZXhwZWN0c1xuICogYSBzZXJ2aWNlIHRoYXQgaGFzIHRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24uIFRoZSBwcm9taXNlIHJlc29sdmVzIHdoZW5cbiAqIHRoZSBpbXBsZW1lbnRhdGlvbiBsb2FkZWQuXG4gKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybiB7IVByb21pc2U8IU9iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGlkKSB7XG4gIHJldHVybiBnZXRTZXJ2aWNlUHJvbWlzZUludGVybmFsKFxuICAgICAgZ2V0QW1wZG9jU2VydmljZUhvbGRlcihlbGVtZW50T3JBbXBEb2MpLCBpZCk7XG59XG5cblxuLyoqXG4gKiBMaWtlIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jIGJ1dCByZXR1cm5zIG51bGwgaWYgdGhlIHNlcnZpY2Ugd2FzIG5ldmVyXG4gKiByZWdpc3RlcmVkIGZvciB0aGlzIGFtcGRvYy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJuIHs/UHJvbWlzZTwhT2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpIHtcbiAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsSW50ZXJuYWwoXG4gICAgICBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGVsZW1lbnRPckFtcERvYyksIGlkKTtcbn1cblxuLyoqXG4gKiBTZXQgdGhlIHBhcmVudCBhbmQgdG9wIHdpbmRvd3Mgb24gYSBjaGlsZCB3aW5kb3cgKGZyaWVuZGx5IGlmcmFtZSkuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshV2luZG93fSBwYXJlbnRXaW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFBhcmVudFdpbmRvdyh3aW4sIHBhcmVudFdpbikge1xuICB3aW4uX19BTVBfUEFSRU5UID0gcGFyZW50V2luO1xuICB3aW4uX19BTVBfVE9QID0gZ2V0VG9wV2luZG93KHBhcmVudFdpbik7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwYXJlbnQgd2luZG93IGZvciBhIGNoaWxkIHdpbmRvdyAoZnJpZW5kbHkgaWZyYW1lKS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshV2luZG93fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGFyZW50V2luZG93KHdpbikge1xuICByZXR1cm4gd2luLl9fQU1QX1BBUkVOVCB8fCB3aW47XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB0b3Agd2luZG93IHdoZXJlIEFNUCBSdW50aW1lIGlzIGluc3RhbGxlZCBmb3IgYSBjaGlsZCB3aW5kb3dcbiAqIChmcmllbmRseSBpZnJhbWUpLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFXaW5kb3d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUb3BXaW5kb3cod2luKSB7XG4gIHJldHVybiB3aW4uX19BTVBfVE9QIHx8IHdpbjtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIHBhcmVudCBcImZyaWVuZGx5XCIgaWZyYW1lIGlmIHRoZSBub2RlIGJlbG9uZ3MgdG8gYSBjaGlsZCB3aW5kb3cuXG4gKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gKiBAcGFyYW0geyFXaW5kb3d9IHRvcFdpblxuICogQHJldHVybiB7P0hUTUxJRnJhbWVFbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGFyZW50V2luZG93RnJhbWVFbGVtZW50KG5vZGUsIHRvcFdpbikge1xuICBjb25zdCBjaGlsZFdpbiA9IChub2RlLm93bmVyRG9jdW1lbnQgfHwgbm9kZSkuZGVmYXVsdFZpZXc7XG4gIGlmIChjaGlsZFdpbiAmJiBjaGlsZFdpbiAhPSB0b3BXaW4gJiYgZ2V0VG9wV2luZG93KGNoaWxkV2luKSA9PSB0b3BXaW4pIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIC8qKiBAdHlwZSB7P0hUTUxJRnJhbWVFbGVtZW50fSAqLyAoY2hpbGRXaW4uZnJhbWVFbGVtZW50KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAvLyBJZ25vcmUgdGhlIGVycm9yLlxuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICogQHJldHVybiB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBbXBkb2Mobm9kZU9yRG9jKSB7XG4gIGlmIChub2RlT3JEb2Mubm9kZVR5cGUpIHtcbiAgICBjb25zdCB3aW4gPSB0b1dpbigvKiogQHR5cGUgeyFEb2N1bWVudH0gKi8gKFxuICAgICAgbm9kZU9yRG9jLm93bmVyRG9jdW1lbnQgfHwgbm9kZU9yRG9jKS5kZWZhdWx0Vmlldyk7XG4gICAgcmV0dXJuIGdldEFtcGRvY1NlcnZpY2Uod2luKS5nZXRBbXBEb2MoLyoqIEB0eXBlIHshTm9kZX0gKi8gKG5vZGVPckRvYykpO1xuICB9XG4gIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSAqLyAobm9kZU9yRG9jKTtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICogQHJldHVybiB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N8IVdpbmRvd31cbiAqL1xuZnVuY3Rpb24gZ2V0QW1wZG9jU2VydmljZUhvbGRlcihub2RlT3JEb2MpIHtcbiAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKG5vZGVPckRvYyk7XG4gIHJldHVybiBhbXBkb2MuaXNTaW5nbGVEb2MoKSA/IGFtcGRvYy53aW4gOiBhbXBkb2M7XG59XG5cblxuLyoqXG4gKiBUaGlzIGlzIGVzc2VudGlhbGx5IGEgZHVwbGljYXRlIG9mIGBhbXBkb2MuanNgLCBidXQgbmVjZXNzYXJ5IHRvIGF2b2lkXG4gKiBjaXJjdWxhciBkZXBlbmRlbmNpZXMuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2NTZXJ2aWNlfVxuICovXG5mdW5jdGlvbiBnZXRBbXBkb2NTZXJ2aWNlKHdpbikge1xuICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY1NlcnZpY2V9ICovIChcbiAgICBnZXRTZXJ2aWNlKHdpbiwgJ2FtcGRvYycpKTtcbn1cblxuXG4vKipcbiAqIEdldCBzZXJ2aWNlIGBpZGAgZnJvbSBgaG9sZGVyYC4gQXNzdW1lcyB0aGUgc2VydmljZVxuICogaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkLlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXIgT2JqZWN0IGhvbGRpbmcgdGhlIHNlcnZpY2UgaW5zdGFuY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHtPYmplY3R9XG4gKiBAdGVtcGxhdGUgVFxuICovXG5mdW5jdGlvbiBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCkge1xuICBkZXYoKS5hc3NlcnQoaXNTZXJ2aWNlUmVnaXN0ZXJlZChob2xkZXIsIGlkKSxcbiAgICAgIGBFeHBlY3RlZCBzZXJ2aWNlICR7aWR9IHRvIGJlIHJlZ2lzdGVyZWRgKTtcbiAgY29uc3Qgc2VydmljZXMgPSBnZXRTZXJ2aWNlcyhob2xkZXIpO1xuICBjb25zdCBzID0gc2VydmljZXNbaWRdO1xuICBpZiAoIXMub2JqKSB7XG4gICAgZGV2KCkuYXNzZXJ0KHMuY3RvciwgYFNlcnZpY2UgJHtpZH0gcmVnaXN0ZXJlZCB3aXRob3V0IGN0b3Igbm9yIGltcGwuYCk7XG4gICAgZGV2KCkuYXNzZXJ0KHMuY29udGV4dCwgYFNlcnZpY2UgJHtpZH0gcmVnaXN0ZXJlZCB3aXRob3V0IGNvbnRleHQuYCk7XG4gICAgcy5vYmogPSBuZXcgcy5jdG9yKHMuY29udGV4dCk7XG4gICAgZGV2KCkuYXNzZXJ0KHMub2JqLCBgU2VydmljZSAke2lkfSBjb25zdHJ1Y3RlZCB0byBudWxsLmApO1xuICAgIHMuY3RvciA9IG51bGw7XG4gICAgcy5jb250ZXh0ID0gbnVsbDtcbiAgICAvLyBUaGUgc2VydmljZSBtYXkgaGF2ZSBiZWVuIHJlcXVlc3RlZCBhbHJlYWR5LCBpbiB3aGljaCBjYXNlIHdlIGhhdmUgYVxuICAgIC8vIHBlbmRpbmcgcHJvbWlzZSB3ZSBuZWVkIHRvIGZ1bGZpbGwuXG4gICAgaWYgKHMucmVzb2x2ZSkge1xuICAgICAgcy5yZXNvbHZlKHMub2JqKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHMub2JqO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyIE9iamVjdCBob2xkaW5nIHRoZSBzZXJ2aWNlIGluc3RhbmNlLlxuICogQHBhcmFtIHshV2luZG93fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBjb250ZXh0IFdpbiBvciBBbXBEb2MuXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0gez9mdW5jdGlvbihuZXc6T2JqZWN0LCAhV2luZG93KXw/ZnVuY3Rpb24obmV3Ok9iamVjdCwgIS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2MpfSBjdG9yIENvbnN0cnVjdG9yIGZ1bmN0aW9uIHRvIG5ldyB0aGUgc2VydmljZS4gQ2FsbGVkIHdpdGggY29udGV4dC5cbiAqL1xuZnVuY3Rpb24gcmVnaXN0ZXJTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBjb250ZXh0LCBpZCwgY3Rvcikge1xuICBjb25zdCBzZXJ2aWNlcyA9IGdldFNlcnZpY2VzKGhvbGRlcik7XG4gIGxldCBzID0gc2VydmljZXNbaWRdO1xuXG4gIGlmICghcykge1xuICAgIHMgPSBzZXJ2aWNlc1tpZF0gPSB7XG4gICAgICBvYmo6IG51bGwsXG4gICAgICBwcm9taXNlOiBudWxsLFxuICAgICAgcmVzb2x2ZTogbnVsbCxcbiAgICAgIGNvbnRleHQ6IG51bGwsXG4gICAgICBjdG9yOiBudWxsLFxuICAgIH07XG4gIH1cblxuICBpZiAocy5jdG9yIHx8IHMub2JqKSB7XG4gICAgLy8gU2VydmljZSBhbHJlYWR5IHJlZ2lzdGVyZWQuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcy5jdG9yID0gY3RvcjtcbiAgcy5jb250ZXh0ID0gY29udGV4dDtcblxuICAvLyBUaGUgc2VydmljZSBtYXkgaGF2ZSBiZWVuIHJlcXVlc3RlZCBhbHJlYWR5LCBpbiB3aGljaCBjYXNlIHRoZXJlIGlzIGFcbiAgLy8gcGVuZGluZyBwcm9taXNlIHRoYXQgbmVlZHMgdG8gZnVsZmlsbGVkLlxuICBpZiAocy5yZXNvbHZlKSB7XG4gICAgLy8gZ2V0U2VydmljZUludGVybmFsIHdpbGwgcmVzb2x2ZSB0aGUgcHJvbWlzZS5cbiAgICBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCk7XG4gIH1cbn1cblxuLyoqXG4gKiBAcGFyYW0geyFPYmplY3R9IGhvbGRlclxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHJldHVybiB7IVByb21pc2U8IU9iamVjdD59XG4gKi9cbmZ1bmN0aW9uIGdldFNlcnZpY2VQcm9taXNlSW50ZXJuYWwoaG9sZGVyLCBpZCkge1xuICBjb25zdCBjYWNoZWQgPSBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEludGVybmFsKGhvbGRlciwgaWQpO1xuICBpZiAoY2FjaGVkKSB7XG4gICAgcmV0dXJuIGNhY2hlZDtcbiAgfVxuICAvLyBTZXJ2aWNlIGlzIG5vdCByZWdpc3RlcmVkLlxuXG4gIC8vIFRPRE8oQGNyYW1mb3JjZSk6IEFkZCBhIGNoZWNrIHRoYXQgaWYgdGhlIGVsZW1lbnQgaXMgZXZlbnR1YWxseSByZWdpc3RlcmVkXG4gIC8vIHRoYXQgdGhlIHNlcnZpY2UgaXMgYWN0dWFsbHkgcHJvdmlkZWQgYW5kIHRoaXMgcHJvbWlzZSByZXNvbHZlcy5cbiAgY29uc3QgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcbiAgY29uc3Qge3Byb21pc2UsIHJlc29sdmV9ID0gZGVmZXJyZWQ7XG5cbiAgY29uc3Qgc2VydmljZXMgPSBnZXRTZXJ2aWNlcyhob2xkZXIpO1xuICBzZXJ2aWNlc1tpZF0gPSB7XG4gICAgb2JqOiBudWxsLFxuICAgIHByb21pc2UsXG4gICAgcmVzb2x2ZSxcbiAgICBjb250ZXh0OiBudWxsLFxuICAgIGN0b3I6IG51bGwsXG4gIH07XG4gIHJldHVybiBwcm9taXNlO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgZm9yIHNlcnZpY2UgYGlkYCBpZiB0aGUgc2VydmljZSBoYXMgYmVlbiByZWdpc3RlcmVkXG4gKiBvbiBgaG9sZGVyYC5cbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHs/UHJvbWlzZTwhT2JqZWN0Pn1cbiAqL1xuZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2VPck51bGxJbnRlcm5hbChob2xkZXIsIGlkKSB7XG4gIGNvbnN0IHNlcnZpY2VzID0gZ2V0U2VydmljZXMoaG9sZGVyKTtcbiAgY29uc3QgcyA9IHNlcnZpY2VzW2lkXTtcbiAgaWYgKHMpIHtcbiAgICBpZiAocy5wcm9taXNlKSB7XG4gICAgICByZXR1cm4gcy5wcm9taXNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBJbnN0YW50aWF0ZSBzZXJ2aWNlIGlmIG5vdCBhbHJlYWR5IGluc3RhbnRpYXRlZC5cbiAgICAgIGdldFNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGlkKTtcbiAgICAgIHJldHVybiBzLnByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoLyoqIEB0eXBlIHshT2JqZWN0fSAqLyAocy5vYmopKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBvYmplY3QgdGhhdCBob2xkcyB0aGUgc2VydmljZXMgcmVnaXN0ZXJlZCBpbiBhIGhvbGRlci5cbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywhU2VydmljZUhvbGRlckRlZj59XG4gKi9cbmZ1bmN0aW9uIGdldFNlcnZpY2VzKGhvbGRlcikge1xuICBsZXQge3NlcnZpY2VzfSA9IGhvbGRlcjtcbiAgaWYgKCFzZXJ2aWNlcykge1xuICAgIHNlcnZpY2VzID0gaG9sZGVyLnNlcnZpY2VzID0ge307XG4gIH1cbiAgcmV0dXJuIHNlcnZpY2VzO1xufVxuXG5cbi8qKlxuICogV2hldGhlciB0aGUgc3BlY2lmaWVkIHNlcnZpY2UgaW1wbGVtZW50cyBgRGlzcG9zYWJsZWAgaW50ZXJmYWNlLlxuICogQHBhcmFtIHshT2JqZWN0fSBzZXJ2aWNlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNEaXNwb3NhYmxlKHNlcnZpY2UpIHtcbiAgcmV0dXJuIHR5cGVvZiBzZXJ2aWNlLmRpc3Bvc2UgPT0gJ2Z1bmN0aW9uJztcbn1cblxuXG4vKipcbiAqIEFzc2VydHMgdGhhdCB0aGUgc3BlY2lmaWVkIHNlcnZpY2UgaW1wbGVtZW50cyBgRGlzcG9zYWJsZWAgaW50ZXJmYWNlIGFuZFxuICogdHlwZWNhc3RzIHRoZSBpbnN0YW5jZSB0byBgRGlzcG9zYWJsZWAuXG4gKiBAcGFyYW0geyFPYmplY3R9IHNlcnZpY2VcbiAqIEByZXR1cm4geyFEaXNwb3NhYmxlfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RGlzcG9zYWJsZShzZXJ2aWNlKSB7XG4gIGRldigpLmFzc2VydChpc0Rpc3Bvc2FibGUoc2VydmljZSksICdyZXF1aXJlZCB0byBpbXBsZW1lbnQgRGlzcG9zYWJsZScpO1xuICByZXR1cm4gLyoqIEB0eXBlIHshRGlzcG9zYWJsZX0gKi8gKHNlcnZpY2UpO1xufVxuXG5cbi8qKlxuICogRGlzcG9zZXMgYWxsIGRpc3Bvc2FibGUgKGltcGxlbWVudHMgYERpc3Bvc2FibGVgIGludGVyZmFjZSkgc2VydmljZXMgaW5cbiAqIGFtcGRvYyBzY29wZS5cbiAqIEBwYXJhbSB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICovXG5leHBvcnQgZnVuY3Rpb24gZGlzcG9zZVNlcnZpY2VzRm9yRG9jKGFtcGRvYykge1xuICBkaXNwb3NlU2VydmljZXNJbnRlcm5hbChhbXBkb2MpO1xufVxuXG5cbi8qKlxuICogRGlzcG9zZXMgYWxsIGRpc3Bvc2FibGUgKGltcGxlbWVudHMgYERpc3Bvc2FibGVgIGludGVyZmFjZSkgc2VydmljZXMgaW5cbiAqIGVtYmVkIHNjb3BlLlxuICogQHBhcmFtIHshV2luZG93fSBlbWJlZFdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gZGlzcG9zZVNlcnZpY2VzRm9yRW1iZWQoZW1iZWRXaW4pIHtcbiAgZGlzcG9zZVNlcnZpY2VzSW50ZXJuYWwoZW1iZWRXaW4pO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXIgT2JqZWN0IGhvbGRpbmcgdGhlIHNlcnZpY2UgaW5zdGFuY2VzLlxuICovXG5mdW5jdGlvbiBkaXNwb3NlU2VydmljZXNJbnRlcm5hbChob2xkZXIpIHtcbiAgLy8gVE9ETyhkdm95dGVua28pOiBDb25zaWRlciBtYXJraW5nIGhvbGRlciBhcyBkZXN0cm95ZWQgZm9yIGxhdGVyLWFycml2aW5nXG4gIC8vIHNlcnZpY2UgdG8gYmUgY2FuY2VsZWQgYXV0b21hdGljYWxseS5cbiAgY29uc3Qgc2VydmljZXMgPSBnZXRTZXJ2aWNlcyhob2xkZXIpO1xuICBmb3IgKGNvbnN0IGlkIGluIHNlcnZpY2VzKSB7XG4gICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc2VydmljZXMsIGlkKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGNvbnN0IHNlcnZpY2VIb2xkZXIgPSBzZXJ2aWNlc1tpZF07XG4gICAgaWYgKHNlcnZpY2VIb2xkZXIub2JqKSB7XG4gICAgICBkaXNwb3NlU2VydmljZUludGVybmFsKGlkLCBzZXJ2aWNlSG9sZGVyLm9iaik7XG4gICAgfSBlbHNlIGlmIChzZXJ2aWNlSG9sZGVyLnByb21pc2UpIHtcbiAgICAgIHNlcnZpY2VIb2xkZXIucHJvbWlzZS50aGVuKFxuICAgICAgICAgIGluc3RhbmNlID0+IGRpc3Bvc2VTZXJ2aWNlSW50ZXJuYWwoaWQsIGluc3RhbmNlKSk7XG4gICAgfVxuICB9XG59XG5cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEBwYXJhbSB7IU9iamVjdH0gc2VydmljZVxuICovXG5mdW5jdGlvbiBkaXNwb3NlU2VydmljZUludGVybmFsKGlkLCBzZXJ2aWNlKSB7XG4gIGlmICghaXNEaXNwb3NhYmxlKHNlcnZpY2UpKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHRyeSB7XG4gICAgYXNzZXJ0RGlzcG9zYWJsZShzZXJ2aWNlKS5kaXNwb3NlKCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBFbnN1cmUgdGhhdCBhIGZhaWx1cmUgdG8gZGlzcG9zZSBhIHNlcnZpY2UgZG9lcyBub3QgZGlzcnVwdCBvdGhlclxuICAgIC8vIHNlcnZpY2VzLlxuICAgIGRldigpLmVycm9yKCdTRVJWSUNFJywgJ2ZhaWxlZCB0byBkaXNwb3NlIHNlcnZpY2UnLCBpZCwgZSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHNwZWNpZmllZCBzZXJ2aWNlIGltcGxlbWVudHMgYEVtYmVkZGFibGVTZXJ2aWNlYCBpbnRlcmZhY2UuXG4gKiBAcGFyYW0geyFPYmplY3R9IHNlcnZpY2VcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0VtYmVkZGFibGUoc2VydmljZSkge1xuICByZXR1cm4gdHlwZW9mIHNlcnZpY2UuYWRvcHRFbWJlZFdpbmRvdyA9PSAnZnVuY3Rpb24nO1xufVxuXG5cbi8qKlxuICogQWRvcHRzIGFuIGVtYmVkZGFibGUgKGltcGxlbWVudHMgYEVtYmVkZGFibGVTZXJ2aWNlYCBpbnRlcmZhY2UpIHNlcnZpY2VcbiAqIGluIGVtYmVkIHNjb3BlLlxuICogQHBhcmFtIHshV2luZG93fSBlbWJlZFdpblxuICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VJZFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRvcHRTZXJ2aWNlRm9yRW1iZWQoZW1iZWRXaW4sIHNlcnZpY2VJZCkge1xuICBjb25zdCBhZG9wdGVkID0gYWRvcHRTZXJ2aWNlRm9yRW1iZWRJZkVtYmVkZGFibGUoZW1iZWRXaW4sIHNlcnZpY2VJZCk7XG4gIGRldigpLmFzc2VydChhZG9wdGVkLCBgU2VydmljZSAke3NlcnZpY2VJZH0gbm90IGZvdW5kIG9uIHBhcmVudCBgICtcbiAgICAgICdvciBkb2VzblxcJ3QgaW1wbGVtZW50IEVtYmVkZGFibGVTZXJ2aWNlLicpO1xufVxuXG5cbi8qKlxuICogQWRvcHRzIGFuIGVtYmVkZGFibGUgKGltcGxlbWVudHMgYEVtYmVkZGFibGVTZXJ2aWNlYCBpbnRlcmZhY2UpIHNlcnZpY2VcbiAqIGluIGVtYmVkIHNjb3BlLlxuICogQHBhcmFtIHshV2luZG93fSBlbWJlZFdpblxuICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VJZFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkb3B0U2VydmljZUZvckVtYmVkSWZFbWJlZGRhYmxlKGVtYmVkV2luLCBzZXJ2aWNlSWQpIHtcbiAgY29uc3QgZnJhbWVFbGVtZW50ID0gLyoqIEB0eXBlIHshTm9kZX0gKi8gKGRldigpLmFzc2VydChcbiAgICAgIGVtYmVkV2luLmZyYW1lRWxlbWVudCxcbiAgICAgICdmcmFtZUVsZW1lbnQgbm90IGZvdW5kIGZvciBlbWJlZCcpKTtcbiAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKGZyYW1lRWxlbWVudCk7XG4gIGNvbnN0IGhvbGRlciA9IGdldEFtcGRvY1NlcnZpY2VIb2xkZXIoYW1wZG9jKTtcbiAgaWYgKCFpc1NlcnZpY2VSZWdpc3RlcmVkKGhvbGRlciwgc2VydmljZUlkKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBjb25zdCBzZXJ2aWNlID0gZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQoZnJhbWVFbGVtZW50LCBzZXJ2aWNlSWQpO1xuICBpZiAoIWlzRW1iZWRkYWJsZShzZXJ2aWNlKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBzZXJ2aWNlLmFkb3B0RW1iZWRXaW5kb3coZW1iZWRXaW4pO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuXG4vKipcbiAqIFJlc2V0cyBhIHNpbmdsZSBzZXJ2aWNlLCBzbyBpdCBnZXRzIHJlY3JlYXRlZCBvbiBuZXh0IGdldFNlcnZpY2UgaW52b2NhdGlvbi5cbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldFNlcnZpY2VGb3JUZXN0aW5nKGhvbGRlciwgaWQpIHtcbiAgaWYgKGhvbGRlci5zZXJ2aWNlcykge1xuICAgIGhvbGRlci5zZXJ2aWNlc1tpZF0gPSBudWxsO1xuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXIgT2JqZWN0IGhvbGRpbmcgdGhlIHNlcnZpY2UgaW5zdGFuY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc1NlcnZpY2VSZWdpc3RlcmVkKGhvbGRlciwgaWQpIHtcbiAgY29uc3Qgc2VydmljZSA9IGhvbGRlci5zZXJ2aWNlcyAmJiBob2xkZXIuc2VydmljZXNbaWRdO1xuICAvLyBBbGwgcmVnaXN0ZXJlZCBzZXJ2aWNlcyBtdXN0IGhhdmUgYW4gaW1wbGVtZW50YXRpb24gb3IgYSBjb25zdHJ1Y3Rvci5cbiAgcmV0dXJuICEhKHNlcnZpY2UgJiYgKHNlcnZpY2UuY3RvciB8fCBzZXJ2aWNlLm9iaikpO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIGdldEFtcGRvYyxcbiAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlLFxuICBnZXRFeGlzdGluZ1NlcnZpY2VPck51bGwsXG4gIGdldFNlcnZpY2UsXG4gIGdldFNlcnZpY2VGb3JEb2MsXG4gIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkLFxuICBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyxcbn0gZnJvbSAnLi9zZXJ2aWNlJztcbmltcG9ydCB7XG4gIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jLFxuICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlLFxuICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jLFxuICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jSW5FbWJlZFNjb3BlLFxufSBmcm9tICcuL2VsZW1lbnQtc2VydmljZSc7XG5cbi8qKiBAdHlwZWRlZiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN1YnNjcmlwdGlvbnMvMC4xL2FtcC1zdWJzY3JpcHRpb25zLlN1YnNjcmlwdGlvblNlcnZpY2V9ICovXG5leHBvcnQgbGV0IFN1YnNjcmlwdGlvblNlcnZpY2U7XG5cbmV4cG9ydCBjbGFzcyBTZXJ2aWNlcyB7XG4gIC8qKlxuICAgKiBIaW50OiBBZGQgZXh0ZW5zaW9ucyBmb2xkZXIgcGF0aCB0byBjb21waWxlLmpzIHdpdGhcbiAgICogd2FybmluZ3MgY2Fubm90IGZpbmQgbW9kdWxlcy5cbiAgICovXG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIGZvciB0aGUgQWNjZXNzIHNlcnZpY2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtYWNjZXNzLzAuMS9hbXAtYWNjZXNzLkFjY2Vzc1NlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFjY2Vzc1NlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hY2Nlc3MvMC4xL2FtcC1hY2Nlc3MuQWNjZXNzU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2FjY2VzcycsICdhbXAtYWNjZXNzJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIEFjY2VzcyBzZXJ2aWNlIG9yIGEgcHJvbWlzZSBmb3IgbnVsbCBpZiB0aGVcbiAgICogc2VydmljZSBpcyBub3QgYXZhaWxhYmxlIG9uIHRoZSBjdXJyZW50IHBhZ2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYWNjZXNzLzAuMS9hbXAtYWNjZXNzLkFjY2Vzc1NlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFjY2Vzc1NlcnZpY2VGb3JEb2NPck51bGwoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1hY2Nlc3MvMC4xL2FtcC1hY2Nlc3MuQWNjZXNzU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnYWNjZXNzJyxcbiAgICAgICAgICAnYW1wLWFjY2VzcycpKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBTdWJzY3JpcHRpb25zIHNlcnZpY2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhU3Vic2NyaXB0aW9uU2VydmljZT59XG4gICAqL1xuICBzdGF0aWMgc3Vic2NyaXB0aW9uc1NlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCFTdWJzY3JpcHRpb25TZXJ2aWNlPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnc3Vic2NyaXB0aW9ucycsXG4gICAgICAgICAgJ2FtcC1zdWJzY3JpcHRpb25zJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIFN1YnNjcmlwdGlvbnMgc2VydmljZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD9TdWJzY3JpcHRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBzdWJzY3JpcHRpb25zU2VydmljZUZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8P1N1YnNjcmlwdGlvblNlcnZpY2U+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ3N1YnNjcmlwdGlvbnMnLFxuICAgICAgICAgICdhbXAtc3Vic2NyaXB0aW9ucycpKSk7XG4gIH1cblxuICAvKipcbiAgICogVW5saWtlIG1vc3Qgc2VydmljZSBnZXR0ZXJzLCBwYXNzaW5nIGBOb2RlYCBpcyBuZWNlc3NhcnkgZm9yIHNvbWUgRklFLXNjb3BlXG4gICAqIHNlcnZpY2VzIHNpbmNlIHNvbWV0aW1lcyB3ZSBvbmx5IGhhdmUgdGhlIEZJRSBEb2N1bWVudCBmb3IgY29udGV4dC5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvYWN0aW9uLWltcGwuQWN0aW9uU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBhY3Rpb25TZXJ2aWNlRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvYWN0aW9uLWltcGwuQWN0aW9uU2VydmljZX0gKi8gKFxuICAgICAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIG5vZGVPckRvYywgJ2FjdGlvbicsIC8qIG9wdF9mYWxsYmFja1RvVG9wV2luICovIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8IUFjdGl2aXR5Pn1cbiAgICovXG4gIHN0YXRpYyBhY3Rpdml0eUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhQWN0aXZpdHk+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdhY3Rpdml0eScsICdhbXAtYW5hbHl0aWNzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGdsb2JhbCBpbnN0YW5jZSBvZiB0aGUgYEFtcERvY1NlcnZpY2VgIHNlcnZpY2UgdGhhdCBjYW4gYmVcbiAgICogdXNlZCB0byByZXNvbHZlIGFuIGFtcGRvYyBmb3IgYW55IG5vZGU6IGVpdGhlciBpbiB0aGUgc2luZ2xlLWRvYyBvclxuICAgKiBzaGFkb3ctZG9jIGVudmlyb25tZW50LlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY1NlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgYW1wZG9jU2VydmljZUZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY1NlcnZpY2V9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAnYW1wZG9jJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIEFtcERvYyBmb3IgdGhlIHNwZWNpZmllZCBjb250ZXh0IG5vZGUuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY31cbiAgICovXG4gIHN0YXRpYyBhbXBkb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIGdldEFtcGRvYyhlbGVtZW50T3JBbXBEb2MpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBsb2FkQW5hbHl0aWNzXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hbmFseXRpY3MvMC4xL2luc3RydW1lbnRhdGlvbi5JbnN0cnVtZW50YXRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBhbmFseXRpY3NGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBsb2FkQW5hbHl0aWNzID0gZmFsc2UpIHtcbiAgICBpZiAobG9hZEFuYWx5dGljcykge1xuICAgICAgLy8gR2V0IEV4dGVuc2lvbnMgc2VydmljZSBhbmQgZm9yY2UgbG9hZCBhbmFseXRpY3MgZXh0ZW5zaW9uLlxuICAgICAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKGVsZW1lbnRPckFtcERvYyk7XG4gICAgICBTZXJ2aWNlcy5leHRlbnNpb25zRm9yKGFtcGRvYy53aW4pLi8qT0sqL2luc3RhbGxFeHRlbnNpb25Gb3JEb2MoXG4gICAgICAgICAgYW1wZG9jLCAnYW1wLWFuYWx5dGljcycpO1xuICAgIH1cbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtYW5hbHl0aWNzLzAuMS9pbnN0cnVtZW50YXRpb24uSW5zdHJ1bWVudGF0aW9uU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2FtcC1hbmFseXRpY3MtaW5zdHJ1bWVudGF0aW9uJyxcbiAgICAgICAgICAnYW1wLWFuYWx5dGljcycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWFuYWx5dGljcy8wLjEvaW5zdHJ1bWVudGF0aW9uLkluc3RydW1lbnRhdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFuYWx5dGljc0ZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYW5hbHl0aWNzLzAuMS9pbnN0cnVtZW50YXRpb24uSW5zdHJ1bWVudGF0aW9uU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLFxuICAgICAgICAgICdhbXAtYW5hbHl0aWNzLWluc3RydW1lbnRhdGlvbicsICdhbXAtYW5hbHl0aWNzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvYmF0Y2hlZC14aHItaW1wbC5CYXRjaGVkWGhyfVxuICAgKi9cbiAgc3RhdGljIGJhdGNoZWRYaHJGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9iYXRjaGVkLXhoci1pbXBsLkJhdGNoZWRYaHJ9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAnYmF0Y2hlZC14aHInKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1iaW5kLzAuMS9iaW5kLWltcGwuQmluZD59XG4gICAqL1xuICBzdGF0aWMgYmluZEZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYmluZC8wLjEvYmluZC1pbXBsLkJpbmQ+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIGVsZW1lbnRPckFtcERvYywgJ2JpbmQnLCAnYW1wLWJpbmQnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuL3NlcnZpY2UvY2lkLWltcGwuQ2lkPn1cbiAgICovXG4gIHN0YXRpYyBjaWRGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8IS4vc2VydmljZS9jaWQtaW1wbC5DaWQ+fSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdjaWQnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvbmF2aWdhdGlvbi5OYXZpZ2F0aW9ufVxuICAgKi9cbiAgc3RhdGljIG5hdmlnYXRpb25Gb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9uYXZpZ2F0aW9uLk5hdmlnYXRpb259ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnbmF2aWdhdGlvbicpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2NyeXB0by1pbXBsLkNyeXB0b31cbiAgICovXG4gIHN0YXRpYyBjcnlwdG9Gb3Iod2luZG93KSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyEuL3NlcnZpY2UvY3J5cHRvLWltcGwuQ3J5cHRvfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ2NyeXB0bycpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvZG9jdW1lbnQtaW5mby1pbXBsLkRvY3VtZW50SW5mb0RlZn0gSW5mbyBhYm91dCB0aGUgZG9jXG4gICAqL1xuICBzdGF0aWMgZG9jdW1lbnRJbmZvRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvZG9jdW1lbnQtaW5mby1pbXBsLkRvY0luZm99ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnZG9jdW1lbnRJbmZvJykpLmdldCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvZG9jdW1lbnQtc3RhdGUuRG9jdW1lbnRTdGF0ZX1cbiAgICovXG4gIHN0YXRpYyBkb2N1bWVudFN0YXRlRm9yKHdpbmRvdykge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbmRvdywgJ2RvY3VtZW50U3RhdGUnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2V4dGVuc2lvbnMtaW1wbC5FeHRlbnNpb25zfVxuICAgKi9cbiAgc3RhdGljIGV4dGVuc2lvbnNGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9leHRlbnNpb25zLWltcGwuRXh0ZW5zaW9uc30gKi8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdleHRlbnNpb25zJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgc2VydmljZSBpbXBsZW1lbnRlZCBpbiBzZXJ2aWNlL2hpc3RvcnktaW1wbC5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvaGlzdG9yeS1pbXBsLkhpc3Rvcnl9XG4gICAqL1xuICBzdGF0aWMgaGlzdG9yeUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2hpc3RvcnktaW1wbC5IaXN0b3J5fSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2hpc3RvcnknKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4vaW5wdXQuSW5wdXR9XG4gICAqL1xuICBzdGF0aWMgaW5wdXRGb3Iod2luKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2Uod2luLCAnaW5wdXQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9sYXllcnMtaW1wbC5MYXlvdXRMYXllcnN9XG4gICAqL1xuICBzdGF0aWMgbGF5ZXJzRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvbGF5ZXJzLWltcGwuTGF5b3V0TGF5ZXJzfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2xheWVycycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3BlcmZvcm1hbmNlLWltcGwuUGVyZm9ybWFuY2V9XG4gICAqL1xuICBzdGF0aWMgcGVyZm9ybWFuY2VGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9wZXJmb3JtYW5jZS1pbXBsLlBlcmZvcm1hbmNlfSovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAncGVyZm9ybWFuY2UnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9wZXJmb3JtYW5jZS1pbXBsLlBlcmZvcm1hbmNlfVxuICAgKi9cbiAgc3RhdGljIHBlcmZvcm1hbmNlRm9yT3JOdWxsKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvcGVyZm9ybWFuY2UtaW1wbC5QZXJmb3JtYW5jZX0qLyAoXG4gICAgICBnZXRFeGlzdGluZ1NlcnZpY2VPck51bGwod2luZG93LCAncGVyZm9ybWFuY2UnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9wbGF0Zm9ybS1pbXBsLlBsYXRmb3JtfVxuICAgKi9cbiAgc3RhdGljIHBsYXRmb3JtRm9yKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvcGxhdGZvcm0taW1wbC5QbGF0Zm9ybX0gKi8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdwbGF0Zm9ybScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VzIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKCkgc2luY2UgUmVzb3VyY2VzIGlzIGEgc3RhcnR1cCBzZXJ2aWNlLlxuICAgKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9yZXNvdXJjZXMtaW1wbC5SZXNvdXJjZXN9XG4gICAqL1xuICBzdGF0aWMgcmVzb3VyY2VzRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvcmVzb3VyY2VzLWltcGwuUmVzb3VyY2VzfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZChub2RlT3JEb2MsICdyZXNvdXJjZXMnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7P1Byb21pc2U8P3tpbmNvbWluZ0ZyYWdtZW50OiBzdHJpbmcsIG91dGdvaW5nRnJhZ21lbnQ6IHN0cmluZ30+fVxuICAgKi9cbiAgc3RhdGljIHNoYXJlVHJhY2tpbmdGb3JPck51bGwod2luKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPD97aW5jb21pbmdGcmFnbWVudDogc3RyaW5nLCBvdXRnb2luZ0ZyYWdtZW50OiBzdHJpbmd9Pn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICdzaGFyZS10cmFja2luZycsXG4gICAgICAgICAgJ2FtcC1zaGFyZS10cmFja2luZycsIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7P1Byb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC92YXJpYWJsZS1zZXJ2aWNlLlN0b3J5VmFyaWFibGVEZWY+fVxuICAgKi9cbiAgc3RhdGljIHN0b3J5VmFyaWFibGVTZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL3ZhcmlhYmxlLXNlcnZpY2UuU3RvcnlWYXJpYWJsZURlZj59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICdzdG9yeS12YXJpYWJsZScsICdhbXAtc3RvcnknLFxuICAgICAgICAgIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogVmVyc2lvbiBvZiB0aGUgc3Rvcnkgc3RvcmUgc2VydmljZSBkZXBlbmRzIG9uIHdoaWNoIHZlcnNpb24gb2YgYW1wLXN0b3J5XG4gICAqIHRoZSBwdWJsaXNoZXIgaXMgbG9hZGluZy4gVGhleSBhbGwgaGF2ZSB0aGUgc2FtZSBpbXBsZW1lbnRhdGlvbi5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7P1Byb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZXw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBzdG9yeVN0b3JlU2VydmljZUZvck9yTnVsbCh3aW4pIHtcbiAgICByZXR1cm4gKFxuICAgIC8qKiBAdHlwZSB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZXw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgJ3N0b3J5LXN0b3JlJywgJ2FtcC1zdG9yeScpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBzdG9yeVN0b3JlU2VydmljZSh3aW4pIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZX0gKi9cbiAgICAgIChnZXRFeGlzdGluZ1NlcnZpY2VPck51bGwod2luLCAnc3Rvcnktc3RvcmUnKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4gez8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvYW1wLXN0b3J5LXJlcXVlc3Qtc2VydmljZS5BbXBTdG9yeVJlcXVlc3RTZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIHN0b3J5UmVxdWVzdFNlcnZpY2Uod2luKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgez8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvYW1wLXN0b3J5LXJlcXVlc3Qtc2VydmljZS5BbXBTdG9yeVJlcXVlc3RTZXJ2aWNlfSAqL1xuICAgICAgKGdldEV4aXN0aW5nU2VydmljZU9yTnVsbCh3aW4sICdzdG9yeS1yZXF1ZXN0JykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2xvY2FsaXphdGlvbi5Mb2NhbGl6YXRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBsb2NhbGl6YXRpb25TZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2xvY2FsaXphdGlvbi5Mb2NhbGl6YXRpb25TZXJ2aWNlPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgJ2xvY2FsaXphdGlvbicsICdhbXAtc3RvcnknLCB0cnVlKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4geyEuLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgbG9jYWxpemF0aW9uU2VydmljZSh3aW4pIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZSh3aW4sICdsb2NhbGl6YXRpb24nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUT0RPKCMxNDM1Nyk6IFJlbW92ZSB0aGlzIHdoZW4gYW1wLXN0b3J5OjAuMSBpcyBkZXByZWNhdGVkLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshLi4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIHN0b3J5U3RvcmVTZXJ2aWNlVjAxKHdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbiwgJ3N0b3J5LXN0b3JlJyk7XG4gIH1cblxuICAvKipcbiAgICogVE9ETygjMTQzNTcpOiBSZW1vdmUgdGhpcyB3aGVuIGFtcC1zdG9yeTowLjEgaXMgZGVwcmVjYXRlZC5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzAuMS9hbXAtc3RvcnktcmVxdWVzdC1zZXJ2aWNlLkFtcFN0b3J5UmVxdWVzdFNlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgc3RvcnlSZXF1ZXN0U2VydmljZVYwMSh3aW4pIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZSh3aW4sICdzdG9yeS1yZXF1ZXN0LXYwMScpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRPRE8oIzE0MzU3KTogUmVtb3ZlIHRoaXMgd2hlbiBhbXAtc3Rvcnk6MC4xIGlzIGRlcHJlY2F0ZWQuXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGxvY2FsaXphdGlvblNlcnZpY2VGb3JPck51bGxWMDEod2luKSB7XG4gICAgcmV0dXJuIChcbiAgICAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2U+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAnbG9jYWxpemF0aW9uLXYwMScsICdhbXAtc3RvcnknLFxuICAgICAgICAgIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogVE9ETygjMTQzNTcpOiBSZW1vdmUgdGhpcyB3aGVuIGFtcC1zdG9yeTowLjEgaXMgZGVwcmVjYXRlZC5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzAuMS9sb2NhbGl6YXRpb24uTG9jYWxpemF0aW9uU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBsb2NhbGl6YXRpb25TZXJ2aWNlVjAxKHdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbiwgJ2xvY2FsaXphdGlvbi12MDEnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHs/UHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtdmlld2VyLWludGVncmF0aW9uLzAuMS92YXJpYWJsZS1zZXJ2aWNlLlZpZXdlckludGVncmF0aW9uVmFyaWFibGVEZWY+fVxuICAgKi9cbiAgc3RhdGljIHZpZXdlckludGVncmF0aW9uVmFyaWFibGVTZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtdmlld2VyLWludGVncmF0aW9uLzAuMS92YXJpYWJsZS1zZXJ2aWNlLlZpZXdlckludGVncmF0aW9uVmFyaWFibGVEZWY+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAndmlld2VyLWludGVncmF0aW9uLXZhcmlhYmxlJyxcbiAgICAgICAgICAnYW1wLXZpZXdlci1pbnRlZ3JhdGlvbicsIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hbmltYXRpb24vMC4xL3dlYi1hbmltYXRpb24tc2VydmljZS5XZWJBbmltYXRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyB3ZWJBbmltYXRpb25TZXJ2aWNlRm9yKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAoLyoqIEB0eXBlIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtYW5pbWF0aW9uLzAuMS93ZWItYW5pbWF0aW9uLXNlcnZpY2UuV2ViQW5pbWF0aW9uU2VydmljZT59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoXG4gICAgICAgICAgZWxlbWVudE9yQW1wRG9jLCAnd2ViLWFuaW1hdGlvbicsICdhbXAtYW5pbWF0aW9uJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8IS4vc2VydmljZS9zdG9yYWdlLWltcGwuU3RvcmFnZT59XG4gICAqL1xuICBzdGF0aWMgc3RvcmFnZUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3N0b3JhZ2UtaW1wbC5TdG9yYWdlPn0gKi8gKFxuICAgICAgZ2V0U2VydmljZVByb21pc2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnc3RvcmFnZScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3RlbXBsYXRlLWltcGwuVGVtcGxhdGVzfVxuICAgKi9cbiAgc3RhdGljIHRlbXBsYXRlc0Zvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3RlbXBsYXRlLWltcGwuVGVtcGxhdGVzfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3RlbXBsYXRlcycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3RpbWVyLWltcGwuVGltZXJ9XG4gICAqL1xuICBzdGF0aWMgdGltZXJGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS90aW1lci1pbXBsLlRpbWVyfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3RpbWVyJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVubGlrZSBtb3N0IHNlcnZpY2UgZ2V0dGVycywgcGFzc2luZyBgTm9kZWAgaXMgbmVjZXNzYXJ5IGZvciBzb21lIEZJRS1zY29wZVxuICAgKiBzZXJ2aWNlcyBzaW5jZSBzb21ldGltZXMgd2Ugb25seSBoYXZlIHRoZSBGSUUgRG9jdW1lbnQgZm9yIGNvbnRleHQuXG4gICAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3VybC1yZXBsYWNlbWVudHMtaW1wbC5VcmxSZXBsYWNlbWVudHN9XG4gICAqL1xuICBzdGF0aWMgdXJsUmVwbGFjZW1lbnRzRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvdXJsLXJlcGxhY2VtZW50cy1pbXBsLlVybFJlcGxhY2VtZW50c30gKi8gKFxuICAgICAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIG5vZGVPckRvYywgJ3VybC1yZXBsYWNlJywgLyogb3B0X2ZhbGxiYWNrVG9Ub3BXaW4gKi8gdHJ1ZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtdXNlci1ub3RpZmljYXRpb24vMC4xL2FtcC11c2VyLW5vdGlmaWNhdGlvbi5Vc2VyTm90aWZpY2F0aW9uTWFuYWdlcj59XG4gICAqL1xuICBzdGF0aWMgdXNlck5vdGlmaWNhdGlvbk1hbmFnZXJGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC11c2VyLW5vdGlmaWNhdGlvbi8wLjEvYW1wLXVzZXItbm90aWZpY2F0aW9uLlVzZXJOb3RpZmljYXRpb25NYW5hZ2VyPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICd1c2VyTm90aWZpY2F0aW9uTWFuYWdlcicsXG4gICAgICAgICAgJ2FtcC11c2VyLW5vdGlmaWNhdGlvbicpKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBjb25zZW50UG9saWN5IFNlcnZpY2Ugb3IgYSBwcm9taXNlIGZvciBudWxsIGlmXG4gICAqIHRoZSBzZXJ2aWNlIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1jb25zZW50LzAuMS9jb25zZW50LXBvbGljeS1tYW5hZ2VyLkNvbnNlbnRQb2xpY3lNYW5hZ2VyPn1cbiAgICovXG4gIHN0YXRpYyBjb25zZW50UG9saWN5U2VydmljZUZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWNvbnNlbnQvMC4xL2NvbnNlbnQtcG9saWN5LW1hbmFnZXIuQ29uc2VudFBvbGljeU1hbmFnZXI+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLFxuICAgICAgICAgICdjb25zZW50UG9saWN5TWFuYWdlcicsICdhbXAtY29uc2VudCcpKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBnZW8gc2VydmljZSBvciBhIHByb21pc2UgZm9yIG51bGwgaWZcbiAgICogdGhlIHNlcnZpY2UgaXMgbm90IGF2YWlsYWJsZSBvbiB0aGUgY3VycmVudCBwYWdlLlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWdlby8wLjEvYW1wLWdlby5HZW9EZWY+fVxuICAgKi9cbiAgc3RhdGljIGdlb0ZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtZ2VvLzAuMS9hbXAtZ2VvLkdlb0RlZj59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoXG4gICAgICAgICAgZWxlbWVudE9yQW1wRG9jLCAnZ2VvJywgJ2FtcC1nZW8nLCB0cnVlKSk7XG4gIH1cblxuICAvKipcbiAgICogVW5saWtlIG1vc3Qgc2VydmljZSBnZXR0ZXJzLCBwYXNzaW5nIGBOb2RlYCBpcyBuZWNlc3NhcnkgZm9yIHNvbWUgRklFLXNjb3BlXG4gICAqIHNlcnZpY2VzIHNpbmNlIHNvbWV0aW1lcyB3ZSBvbmx5IGhhdmUgdGhlIEZJRSBEb2N1bWVudCBmb3IgY29udGV4dC5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvdXJsLWltcGwuVXJsfVxuICAgKi9cbiAgc3RhdGljIHVybEZvckRvYyhub2RlT3JEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3VybC1pbXBsLlVybH0gKi8gKFxuICAgICAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIG5vZGVPckRvYywgJ3VybCcsIC8qIG9wdF9mYWxsYmFja1RvVG9wV2luICovIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIGV4cGVyaW1lbnQgdmFyaWFudHMgb3IgYSBwcm9taXNlIGZvciBudWxsIGlmIGl0XG4gICAqIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IVByb21pc2U8P09iamVjdDxzdHJpbmc+Pn1cbiAgICovXG4gIHN0YXRpYyB2YXJpYW50Rm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q8c3RyaW5nPj59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAndmFyaWFudCcsICdhbXAtZXhwZXJpbWVudCcsIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS92aWRlby1zZXJ2aWNlLWludGVyZmFjZS5WaWRlb1NlcnZpY2VJbnRlcmZhY2V9XG4gICAqL1xuICBzdGF0aWMgdmlkZW9NYW5hZ2VyRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAoXG4gICAgICAvKiogQHR5cGUgeyEuL3NlcnZpY2UvdmlkZW8tc2VydmljZS1pbnRlcmZhY2UuVmlkZW9TZXJ2aWNlSW50ZXJmYWNlfSAqLyAoXG4gICAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAndmlkZW8tbWFuYWdlcicpKSk7XG4gIH1cblxuICAvKipcbiAgICogVXNlcyBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZCgpIHNpbmNlIFZpZXdlciBpcyBhIHN0YXJ0dXAgc2VydmljZS5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2Uvdmlld2VyLWltcGwuVmlld2VyfVxuICAgKi9cbiAgc3RhdGljIHZpZXdlckZvckRvYyhub2RlT3JEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcn0gKi8gKFxuICAgICAgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQobm9kZU9yRG9jLCAndmlld2VyJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgcHJvbWlzZSBmb3IgdGhlIHZpZXdlci4gVGhpcyBpcyBhbiB1bnVzdWFsIGNhc2UgYW5kIG5lY2Vzc2FyeSBvbmx5XG4gICAqIGZvciBzZXJ2aWNlcyB0aGF0IG5lZWQgcmVmZXJlbmNlIHRvIHRoZSB2aWV3ZXIgYmVmb3JlIGl0IGhhcyBiZWVuXG4gICAqIGluaXRpYWxpemVkLiBNb3N0IG9mIHRoZSBjb2RlLCBob3dldmVyLCBqdXN0IHNob3VsZCB1c2UgYHZpZXdlckZvckRvY2AuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcj59XG4gICAqL1xuICBzdGF0aWMgdmlld2VyUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcj59ICovIChcbiAgICAgIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ3ZpZXdlcicpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3ZzeW5jLWltcGwuVnN5bmN9XG4gICAqL1xuICBzdGF0aWMgdnN5bmNGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS92c3luYy1pbXBsLlZzeW5jfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3ZzeW5jJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZXMgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQoKSBzaW5jZSBWaWV3cG9ydCBpcyBhIHN0YXJ0dXAgc2VydmljZS5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2Uvdmlld3BvcnQvdmlld3BvcnQtaW1wbC5WaWV3cG9ydH1cbiAgICovXG4gIHN0YXRpYyB2aWV3cG9ydEZvckRvYyhub2RlT3JEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3ZpZXdwb3J0L3ZpZXdwb3J0LWltcGwuVmlld3BvcnR9ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKG5vZGVPckRvYywgJ3ZpZXdwb3J0JykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UveGhyLWltcGwuWGhyfVxuICAgKi9cbiAgc3RhdGljIHhockZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3hoci1pbXBsLlhocn0gKi8gKGdldFNlcnZpY2Uod2luZG93LCAneGhyJykpO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7bWFwfSBmcm9tICcuL3V0aWxzL29iamVjdC5qcyc7XG5cbmxldCBjb250YWluZXI7XG5cbi8qKlxuICogQ3JlYXRlcyB0aGUgaHRtbCBoZWxwZXIgZm9yIHRoZSBkb2MuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudHwhRG9jdW1lbnR9IG5vZGVPckRvY1xuICogQHJldHVybiB7ZnVuY3Rpb24oIUFycmF5PHN0cmluZz4pOiFFbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gaHRtbEZvcihub2RlT3JEb2MpIHtcbiAgY29uc3QgZG9jID0gbm9kZU9yRG9jLm93bmVyRG9jdW1lbnQgfHwgbm9kZU9yRG9jO1xuICBpZiAoIWNvbnRhaW5lciB8fCBjb250YWluZXIub3duZXJEb2N1bWVudCAhPT0gZG9jKSB7XG4gICAgY29udGFpbmVyID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB9XG5cbiAgcmV0dXJuIGh0bWw7XG59XG5cbi8qKlxuICogQSB0YWdnZWQgdGVtcGxhdGUgbGl0ZXJhbCBoZWxwZXIgdG8gZ2VuZXJhdGUgc3RhdGljIERPTSB0cmVlcy5cbiAqIFRoaXMgbXVzdCBiZSB1c2VkIGFzIGEgdGFnZ2VkIHRlbXBsYXRlLCBpZVxuICpcbiAqIGBgYFxuICogY29uc3QgZGl2ID0gaHRtbGA8ZGl2PjxzcGFuPjwvc3Bhbj48L2Rpdj5gO1xuICogYGBgXG4gKlxuICogT25seSB0aGUgcm9vdCBlbGVtZW50IGFuZCBpdHMgc3VidHJlZSB3aWxsIGJlIHJldHVybmVkLiBETyBOT1QgdXNlIHRoaXMgdG9cbiAqIHJlbmRlciBzdWJ0cmVlJ3Mgd2l0aCBkeW5hbWljIGNvbnRlbnQsIGl0IFdJTEwgcmVzdWx0IGluIGFuIGVycm9yIVxuICpcbiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHN0cmluZ3NcbiAqIEByZXR1cm4geyFFbGVtZW50fVxuICovXG5mdW5jdGlvbiBodG1sKHN0cmluZ3MpIHtcbiAgZGV2KCkuYXNzZXJ0KHN0cmluZ3MubGVuZ3RoID09PSAxLCAnSW1wcm9wZXIgaHRtbCB0ZW1wbGF0ZSB0YWcgdXNhZ2UuJyk7XG4gIGNvbnRhaW5lci4vKk9LKi9pbm5lckhUTUwgPSBzdHJpbmdzWzBdO1xuXG4gIGNvbnN0IGVsID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkO1xuICBkZXYoKS5hc3NlcnQoZWwsICdObyBlbGVtZW50cyBpbiB0ZW1wbGF0ZScpO1xuICBkZXYoKS5hc3NlcnQoIWVsLm5leHRFbGVtZW50U2libGluZywgJ1RvbyBtYW55IHJvb3QgZWxlbWVudHMgaW4gdGVtcGxhdGUnKTtcblxuICAvLyBDbGVhciB0byBmcmVlIG1lbW9yeS5cbiAgY29udGFpbmVyLi8qT0sqL2lubmVySFRNTCA9ICcnO1xuXG4gIHJldHVybiBlbDtcbn1cblxuLyoqXG4gKiBRdWVyaWVzIGFuIGVsZW1lbnQgZm9yIGFsbCBlbGVtZW50cyB3aXRoIGEgXCJyZWZcIiBhdHRyaWJ1dGUsIHJlbW92aW5nXG4gKiB0aGUgYXR0cmlidXRlIGFmdGVyd2FyZHMuXG4gKiBSZXR1cm5zIGEgbmFtZWQgbWFwIG9mIGFsbCByZWYgZWxlbWVudHMuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudH0gcm9vdFxuICogQHJldHVybiB7IU9iamVjdDxzdHJpbmcsICFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGh0bWxSZWZzKHJvb3QpIHtcbiAgY29uc3QgZWxlbWVudHMgPSByb290LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tyZWZdJyk7XG4gIGNvbnN0IHJlZnMgPSBtYXAoKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgZWxlbWVudCA9IGVsZW1lbnRzW2ldO1xuICAgIGNvbnN0IHJlZiA9IGRldigpLmFzc2VydChlbGVtZW50LmdldEF0dHJpYnV0ZSgncmVmJyksICdFbXB0eSByZWYgYXR0cicpO1xuICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdyZWYnKTtcbiAgICBkZXYoKS5hc3NlcnQocmVmc1tyZWZdID09PSB1bmRlZmluZWQsICdEdXBsaWNhdGUgcmVmJyk7XG4gICAgcmVmc1tyZWZdID0gZWxlbWVudDtcbiAgfVxuXG4gIHJldHVybiByZWZzO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IF9tYXRjaFxuICogQHBhcmFtIHtzdHJpbmd9IGNoYXJhY3RlclxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0b1VwcGVyQ2FzZShfbWF0Y2gsIGNoYXJhY3Rlcikge1xuICByZXR1cm4gY2hhcmFjdGVyLnRvVXBwZXJDYXNlKCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG1hdGNoXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHByZXBlbmREYXNoQW5kVG9Mb3dlckNhc2UobWF0Y2gpIHtcbiAgcmV0dXJuICctJyArIG1hdGNoLnRvTG93ZXJDYXNlKCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgQXR0cmlidXRlIG5hbWUgY29udGFpbmluZyBkYXNoZXMuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IERhc2hlcyByZW1vdmVkIGFuZCBzdWNjZXNzaXZlIGNoYXJhY3RlciBzZW50IHRvIHVwcGVyIGNhc2UuXG4gKiB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZGFzaFRvQ2FtZWxDYXNlKG5hbWUpIHtcbiAgcmV0dXJuIG5hbWUucmVwbGFjZSgvLShbYS16XSkvZywgdG9VcHBlckNhc2UpO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgc3RyaW5nIHRoYXQgaXMgaW4gY2FtZWxDYXNlIHRvIG9uZSB0aGF0IGlzIGluIGRhc2gtY2FzZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nIFRoZSBzdHJpbmcgdG8gY29udmVydC5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHN0cmluZyBpbiBkYXNoLWNhc2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW1lbENhc2VUb0Rhc2goc3RyaW5nKSB7XG4gIHJldHVybiBzdHJpbmcucmVwbGFjZSgvKD8hXilbQS1aXS9nLCBwcmVwZW5kRGFzaEFuZFRvTG93ZXJDYXNlKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBBdHRyaWJ1dGUgbmFtZSB3aXRoIGRhc2hlc1xuICogQHJldHVybiB7c3RyaW5nfSBEYXNoZXMgcmVwbGFjZWQgYnkgdW5kZXJsaW5lcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRhc2hUb1VuZGVybGluZShuYW1lKSB7XG4gIHJldHVybiBuYW1lLnJlcGxhY2UoJy0nLCAnXycpO1xufVxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBTdHJpbmcucHJvdG90eXBlLmVuZHNXaXRoLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZ1xuICogQHBhcmFtIHtzdHJpbmd9IHN1ZmZpeFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVuZHNXaXRoKHN0cmluZywgc3VmZml4KSB7XG4gIGNvbnN0IGluZGV4ID0gc3RyaW5nLmxlbmd0aCAtIHN1ZmZpeC5sZW5ndGg7XG4gIHJldHVybiBpbmRleCA+PSAwICYmIHN0cmluZy5pbmRleE9mKHN1ZmZpeCwgaW5kZXgpID09IGluZGV4O1xufVxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGguXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJlZml4XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RhcnRzV2l0aChzdHJpbmcsIHByZWZpeCkge1xuICBpZiAocHJlZml4Lmxlbmd0aCA+IHN0cmluZy5sZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHN0cmluZy5sYXN0SW5kZXhPZihwcmVmaXgsIDApID09IDA7XG59XG5cbi8qKlxuICogRXhwYW5kcyBwbGFjZWhvbGRlcnMgaW4gYSBnaXZlbiB0ZW1wbGF0ZSBzdHJpbmcgd2l0aCB2YWx1ZXMuXG4gKlxuICogUGxhY2Vob2xkZXJzIHVzZSAke2tleS1uYW1lfSBzeW50YXggYW5kIGFyZSByZXBsYWNlZCB3aXRoIHRoZSB2YWx1ZVxuICogcmV0dXJuZWQgZnJvbSB0aGUgZ2l2ZW4gZ2V0dGVyIGZ1bmN0aW9uLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZW1wbGF0ZSBUaGUgdGVtcGxhdGUgc3RyaW5nIHRvIGV4cGFuZC5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nKToqfSBnZXR0ZXIgRnVuY3Rpb24gdXNlZCB0byByZXRyaWV2ZSBhIHZhbHVlIGZvciBhXG4gKiAgIHBsYWNlaG9sZGVyLiBSZXR1cm5zIHZhbHVlcyB3aWxsIGJlIGNvZXJjZWQgaW50byBzdHJpbmdzLlxuICogQHBhcmFtIHtudW1iZXI9fSBvcHRfbWF4SXRlcmF0aW9ucyBOdW1iZXIgb2YgdGltZXMgdG8gZXhwYW5kIHRoZSB0ZW1wbGF0ZS5cbiAqICAgRGVmYXVsdHMgdG8gMSwgYnV0IHNob3VsZCBiZSBzZXQgdG8gYSBsYXJnZXIgdmFsdWUgeW91ciBwbGFjZWhvbGRlciB0b2tlbnNcbiAqICAgY2FuIGJlIGV4cGFuZGVkIHRvIG90aGVyIHBsYWNlaG9sZGVyIHRva2Vucy4gVGFrZSBjYXV0aW9uIHdpdGggbGFyZ2UgdmFsdWVzXG4gKiAgIGFzIHJlY3Vyc2l2ZWx5IGV4cGFuZGluZyBhIHN0cmluZyBjYW4gYmUgZXhwb25lbnRpYWxseSBleHBlbnNpdmUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHBhbmRUZW1wbGF0ZSh0ZW1wbGF0ZSwgZ2V0dGVyLCBvcHRfbWF4SXRlcmF0aW9ucykge1xuICBjb25zdCBtYXhJdGVyYXRpb25zID0gb3B0X21heEl0ZXJhdGlvbnMgfHwgMTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhJdGVyYXRpb25zOyBpKyspIHtcbiAgICBsZXQgbWF0Y2hlcyA9IDA7XG4gICAgdGVtcGxhdGUgPSB0ZW1wbGF0ZS5yZXBsYWNlKC9cXCR7KFtefV0qKX0vZywgKF9hLCBiKSA9PiB7XG4gICAgICBtYXRjaGVzKys7XG4gICAgICByZXR1cm4gZ2V0dGVyKGIpO1xuICAgIH0pO1xuICAgIGlmICghbWF0Y2hlcykge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIHJldHVybiB0ZW1wbGF0ZTtcbn1cblxuLyoqXG4gKiBIYXNoIGZ1bmN0aW9uIGRqYjJhXG4gKiBUaGlzIGlzIGludGVuZGVkIHRvIGJlIGEgc2ltcGxlLCBmYXN0IGhhc2hpbmcgZnVuY3Rpb24gdXNpbmcgbWluaW1hbCBjb2RlLlxuICogSXQgZG9lcyAqbm90KiBoYXZlIGdvb2QgY3J5cHRvZ3JhcGhpYyBwcm9wZXJ0aWVzLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxuICogQHJldHVybiB7c3RyaW5nfSAzMi1iaXQgdW5zaWduZWQgaGFzaCBvZiB0aGUgc3RyaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdHJpbmdIYXNoMzIoc3RyKSB7XG4gIGNvbnN0IHtsZW5ndGh9ID0gc3RyO1xuICBsZXQgaGFzaCA9IDUzODE7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICBoYXNoID0gaGFzaCAqIDMzIF4gc3RyLmNoYXJDb2RlQXQoaSk7XG4gIH1cbiAgLy8gQ29udmVydCBmcm9tIDMyLWJpdCBzaWduZWQgdG8gdW5zaWduZWQuXG4gIHJldHVybiBTdHJpbmcoaGFzaCA+Pj4gMCk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLy8gTm90ZTogbG9hZGVkIGJ5IDNwIHN5c3RlbS4gQ2Fubm90IHJlbHkgb24gYmFiZWwgcG9seWZpbGxzLlxuaW1wb3J0IHttYXB9IGZyb20gJy4vdXRpbHMvb2JqZWN0LmpzJztcbmltcG9ydCB7c3RhcnRzV2l0aH0gZnJvbSAnLi9zdHJpbmcnO1xuXG5cbi8qKiBAdHlwZSB7T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gKi9cbmxldCBwcm9wZXJ0eU5hbWVDYWNoZTtcblxuLyoqIEBjb25zdCB7IUFycmF5PHN0cmluZz59ICovXG5jb25zdCB2ZW5kb3JQcmVmaXhlcyA9IFsnV2Via2l0JywgJ3dlYmtpdCcsICdNb3onLCAnbW96JywgJ21zJywgJ08nLCAnbyddO1xuXG5cbi8qKlxuICogQGV4cG9ydFxuICogQHBhcmFtIHtzdHJpbmd9IGNhbWVsQ2FzZSBjYW1lbCBjYXNlZCBzdHJpbmdcbiAqIEByZXR1cm4ge3N0cmluZ30gdGl0bGUgY2FzZWQgc3RyaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW1lbENhc2VUb1RpdGxlQ2FzZShjYW1lbENhc2UpIHtcbiAgcmV0dXJuIGNhbWVsQ2FzZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGNhbWVsQ2FzZS5zbGljZSgxKTtcbn1cblxuLyoqXG4gKiBDaGVja3MgdGhlIHN0eWxlIGlmIGEgcHJlZml4ZWQgdmVyc2lvbiBvZiBhIHByb3BlcnR5IGV4aXN0cyBhbmQgcmV0dXJuc1xuICogaXQgb3IgcmV0dXJucyBhbiBlbXB0eSBzdHJpbmcuXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHshT2JqZWN0fSBzdHlsZVxuICogQHBhcmFtIHtzdHJpbmd9IHRpdGxlQ2FzZSB0aGUgdGl0bGUgY2FzZSB2ZXJzaW9uIG9mIGEgY3NzIHByb3BlcnR5IG5hbWVcbiAqIEByZXR1cm4ge3N0cmluZ30gdGhlIHByZWZpeGVkIHByb3BlcnR5IG5hbWUgb3IgbnVsbC5cbiAqL1xuZnVuY3Rpb24gZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWVfKHN0eWxlLCB0aXRsZUNhc2UpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB2ZW5kb3JQcmVmaXhlcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHByb3BlcnR5TmFtZSA9IHZlbmRvclByZWZpeGVzW2ldICsgdGl0bGVDYXNlO1xuICAgIGlmIChzdHlsZVtwcm9wZXJ0eU5hbWVdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBwcm9wZXJ0eU5hbWU7XG4gICAgfVxuICB9XG4gIHJldHVybiAnJztcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwb3NzaWJseSBwcmVmaXhlZCBKYXZhU2NyaXB0IHByb3BlcnR5IG5hbWUgb2YgYSBzdHlsZSBwcm9wZXJ0eVxuICogKGV4LiBXZWJraXRUcmFuc2l0aW9uRHVyYXRpb24pIGdpdmVuIGEgY2FtZWxDYXNlJ2QgdmVyc2lvbiBvZiB0aGUgcHJvcGVydHlcbiAqIChleC4gdHJhbnNpdGlvbkR1cmF0aW9uKS5cbiAqIEBleHBvcnRcbiAqIEBwYXJhbSB7IU9iamVjdH0gc3R5bGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBjYW1lbENhc2UgdGhlIGNhbWVsIGNhc2VkIHZlcnNpb24gb2YgYSBjc3MgcHJvcGVydHkgbmFtZVxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2J5cGFzc0NhY2hlIGJ5cGFzcyB0aGUgbWVtb2l6ZWQgY2FjaGUgb2YgcHJvcGVydHlcbiAqICAgbWFwcGluZ1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWUoc3R5bGUsIGNhbWVsQ2FzZSwgb3B0X2J5cGFzc0NhY2hlKSB7XG4gIGlmIChzdGFydHNXaXRoKGNhbWVsQ2FzZSwgJy0tJykpIHtcbiAgICAvLyBDU1MgdmFycyBhcmUgcmV0dXJuZWQgYXMgaXMuXG4gICAgcmV0dXJuIGNhbWVsQ2FzZTtcbiAgfVxuICBpZiAoIXByb3BlcnR5TmFtZUNhY2hlKSB7XG4gICAgcHJvcGVydHlOYW1lQ2FjaGUgPSBtYXAoKTtcbiAgfVxuICBsZXQgcHJvcGVydHlOYW1lID0gcHJvcGVydHlOYW1lQ2FjaGVbY2FtZWxDYXNlXTtcbiAgaWYgKCFwcm9wZXJ0eU5hbWUgfHwgb3B0X2J5cGFzc0NhY2hlKSB7XG4gICAgcHJvcGVydHlOYW1lID0gY2FtZWxDYXNlO1xuICAgIGlmIChzdHlsZVtjYW1lbENhc2VdID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnN0IHRpdGxlQ2FzZSA9IGNhbWVsQ2FzZVRvVGl0bGVDYXNlKGNhbWVsQ2FzZSk7XG4gICAgICBjb25zdCBwcmVmaXhlZFByb3BlcnR5TmFtZSA9IGdldFZlbmRvckpzUHJvcGVydHlOYW1lXyhzdHlsZSwgdGl0bGVDYXNlKTtcblxuICAgICAgaWYgKHN0eWxlW3ByZWZpeGVkUHJvcGVydHlOYW1lXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHByb3BlcnR5TmFtZSA9IHByZWZpeGVkUHJvcGVydHlOYW1lO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIW9wdF9ieXBhc3NDYWNoZSkge1xuICAgICAgcHJvcGVydHlOYW1lQ2FjaGVbY2FtZWxDYXNlXSA9IHByb3BlcnR5TmFtZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHByb3BlcnR5TmFtZTtcbn1cblxuXG4vKipcbiAqIFNldHMgdGhlIENTUyBzdHlsZXMgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IHdpdGggIWltcG9ydGFudC4gVGhlIHN0eWxlc1xuICogYXJlIHNwZWNpZmllZCBhcyBhIG1hcCBmcm9tIENTUyBwcm9wZXJ0eSBuYW1lcyB0byB0aGVpciB2YWx1ZXMuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPn0gc3R5bGVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRJbXBvcnRhbnRTdHlsZXMoZWxlbWVudCwgc3R5bGVzKSB7XG4gIGZvciAoY29uc3QgayBpbiBzdHlsZXMpIHtcbiAgICBlbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KFxuICAgICAgICBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZShzdHlsZXMsIGspLCBzdHlsZXNba10udG9TdHJpbmcoKSwgJ2ltcG9ydGFudCcpO1xuICB9XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBDU1Mgc3R5bGUgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IHdpdGggb3B0aW9uYWwgdW5pdHMsIGUuZy4gXCJweFwiLlxuICogQHBhcmFtIHs/RWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5XG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF91bml0c1xuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2J5cGFzc0NhY2hlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRTdHlsZShlbGVtZW50LCBwcm9wZXJ0eSwgdmFsdWUsIG9wdF91bml0cywgb3B0X2J5cGFzc0NhY2hlKSB7XG4gIGNvbnN0IHByb3BlcnR5TmFtZSA9IGdldFZlbmRvckpzUHJvcGVydHlOYW1lKGVsZW1lbnQuc3R5bGUsIHByb3BlcnR5LFxuICAgICAgb3B0X2J5cGFzc0NhY2hlKTtcbiAgaWYgKHByb3BlcnR5TmFtZSkge1xuICAgIGVsZW1lbnQuc3R5bGVbcHJvcGVydHlOYW1lXSA9XG4gICAgICAvKiogQHR5cGUge3N0cmluZ30gKi8gKG9wdF91bml0cyA/IHZhbHVlICsgb3B0X3VuaXRzIDogdmFsdWUpO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgQ1NTIHN0eWxlIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wZXJ0eVxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2J5cGFzc0NhY2hlXG4gKiBAcmV0dXJuIHsqfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3R5bGUoZWxlbWVudCwgcHJvcGVydHksIG9wdF9ieXBhc3NDYWNoZSkge1xuICBjb25zdCBwcm9wZXJ0eU5hbWUgPSBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZShlbGVtZW50LnN0eWxlLCBwcm9wZXJ0eSxcbiAgICAgIG9wdF9ieXBhc3NDYWNoZSk7XG4gIGlmICghcHJvcGVydHlOYW1lKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICByZXR1cm4gZWxlbWVudC5zdHlsZVtwcm9wZXJ0eU5hbWVdO1xufVxuXG5cbi8qKlxuICogU2V0cyB0aGUgQ1NTIHN0eWxlcyBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQuIFRoZSBzdHlsZXNcbiAqIGEgc3BlY2lmaWVkIGFzIGEgbWFwIGZyb20gQ1NTIHByb3BlcnR5IG5hbWVzIHRvIHRoZWlyIHZhbHVlcy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICo+fSBzdHlsZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFN0eWxlcyhlbGVtZW50LCBzdHlsZXMpIHtcbiAgZm9yIChjb25zdCBrIGluIHN0eWxlcykge1xuICAgIHNldFN0eWxlKGVsZW1lbnQsIGssIHN0eWxlc1trXSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFNob3dzIG9yIGhpZGVzIHRoZSBzcGVjaWZpZWQgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9kaXNwbGF5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGUoZWxlbWVudCwgb3B0X2Rpc3BsYXkpIHtcbiAgaWYgKG9wdF9kaXNwbGF5ID09PSB1bmRlZmluZWQpIHtcbiAgICBvcHRfZGlzcGxheSA9IGdldFN0eWxlKGVsZW1lbnQsICdkaXNwbGF5JykgPT0gJ25vbmUnO1xuICB9XG4gIHNldFN0eWxlKGVsZW1lbnQsICdkaXNwbGF5Jywgb3B0X2Rpc3BsYXkgPyAnJyA6ICdub25lJyk7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcGl4ZWwgdmFsdWUuXG4gKiBAcGFyYW0ge251bWJlcn0gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHB4KHZhbHVlKSB7XG4gIHJldHVybiBgJHt2YWx1ZX1weGA7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGRlZ3JlZSB2YWx1ZS5cbiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVnKHZhbHVlKSB7XG4gIHJldHVybiBgJHt2YWx1ZX1kZWdgO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBcInRyYW5zbGF0ZVhcIiBmb3IgQ1NTIFwidHJhbnNmb3JtXCIgcHJvcGVydHkuXG4gKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2xhdGVYKHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gYHRyYW5zbGF0ZVgoJHt2YWx1ZX0pYDtcbiAgfVxuICByZXR1cm4gYHRyYW5zbGF0ZVgoJHtweCh2YWx1ZSl9KWA7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgXCJ0cmFuc2xhdGVYXCIgZm9yIENTUyBcInRyYW5zZm9ybVwiIHByb3BlcnR5LlxuICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSB4XG4gKiBAcGFyYW0geyhudW1iZXJ8c3RyaW5nKT19IG9wdF95XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2xhdGUoeCwgb3B0X3kpIHtcbiAgaWYgKHR5cGVvZiB4ID09ICdudW1iZXInKSB7XG4gICAgeCA9IHB4KHgpO1xuICB9XG4gIGlmIChvcHRfeSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIGB0cmFuc2xhdGUoJHt4fSlgO1xuICB9XG4gIGlmICh0eXBlb2Ygb3B0X3kgPT0gJ251bWJlcicpIHtcbiAgICBvcHRfeSA9IHB4KG9wdF95KTtcbiAgfVxuICByZXR1cm4gYHRyYW5zbGF0ZSgke3h9LCAke29wdF95fSlgO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIFwic2NhbGVcIiBmb3IgQ1NTIFwidHJhbnNmb3JtXCIgcHJvcGVydHkuXG4gKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzY2FsZSh2YWx1ZSkge1xuICByZXR1cm4gYHNjYWxlKCR7dmFsdWV9KWA7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIFwicm90YXRlXCIgZm9yIENTUyBcInRyYW5zZm9ybVwiIHByb3BlcnR5LlxuICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcm90YXRlKHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT0gJ251bWJlcicpIHtcbiAgICB2YWx1ZSA9IGRlZyh2YWx1ZSk7XG4gIH1cbiAgcmV0dXJuIGByb3RhdGUoJHt2YWx1ZX0pYDtcbn1cblxuLyoqXG4gKiBSZW1vdmUgYWxwaGEgdmFsdWUgZnJvbSBhIHJnYmEgY29sb3IgdmFsdWUuXG4gKiBSZXR1cm4gdGhlIG5ldyBjb2xvciBwcm9wZXJ0eSB3aXRoIGFscGhhIGVxdWFscyBpZiBoYXMgdGhlIGFscGhhIHZhbHVlLlxuICogQ2FsbGVyIG5lZWRzIHRvIG1ha2Ugc3VyZSB0aGUgaW5wdXQgY29sb3IgdmFsdWUgaXMgYSB2YWxpZCByZ2JhL3JnYiB2YWx1ZVxuICogQHBhcmFtIHtzdHJpbmd9IHJnYmFDb2xvclxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlQWxwaGFGcm9tQ29sb3IocmdiYUNvbG9yKSB7XG4gIHJldHVybiByZ2JhQ29sb3IucmVwbGFjZShcbiAgICAgIC9cXCgoW14sXSspLChbXixdKyksKFteLCldKyksW14pXStcXCkvZywgJygkMSwkMiwkMywgMSknKTtcbn1cblxuLyoqXG4gKiBHZXRzIHRoZSBjb21wdXRlZCBzdHlsZSBvZiB0aGUgZWxlbWVudC4gVGhlIGhlbHBlciBpcyBuZWNlc3NhcnkgdG8gZW5mb3JjZVxuICogdGhlIHBvc3NpYmxlIGBudWxsYCB2YWx1ZSByZXR1cm5lZCBieSBhIGJ1Z2d5IEZpcmVmb3guXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVkU3R5bGUod2luLCBlbCkge1xuICBjb25zdCBzdHlsZSA9IC8qKiBAdHlwZSB7P0NTU1N0eWxlRGVjbGFyYXRpb259ICovKHdpbi5nZXRDb21wdXRlZFN0eWxlKGVsKSk7XG4gIHJldHVybiAvKiogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSAqLyhzdHlsZSkgfHwgbWFwKCk7XG59XG5cblxuLyoqXG4gKiBSZXNldHMgc3R5bGVzIHRoYXQgd2VyZSBzZXQgZHluYW1pY2FsbHkgKGkuZS4gaW5saW5lKVxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHshQXJyYXk8c3RyaW5nPn0gcHJvcGVydGllc1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRTdHlsZXMoZWxlbWVudCwgcHJvcGVydGllcykge1xuICBjb25zdCBzdHlsZU9iaiA9IHt9O1xuICBwcm9wZXJ0aWVzLmZvckVhY2gocHJvcCA9PiB7XG4gICAgc3R5bGVPYmpbcHJvcF0gPSBudWxsO1xuICB9KTtcbiAgc2V0U3R5bGVzKGVsZW1lbnQsIHN0eWxlT2JqKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogQWJzb2x1dGUgdGltZSBpbiBtaWxsaXNlY29uZHMuXG4gKiBAdHlwZWRlZiB7bnVtYmVyfVxuICovXG5leHBvcnQgbGV0IHRpbWVEZWY7XG5cblxuLyoqXG4gKiBOdW1iZXIgYmV0d2VlbiAwIGFuZCAxIHRoYXQgZGVzaWduYXRlcyBub3JtYWxpemVkIHRpbWUsIGFzIGluIFwiZnJvbSBzdGFydCB0b1xuICogZW5kXCIuXG4gKiBAdHlwZWRlZiB7bnVtYmVyfVxuICovXG5leHBvcnQgbGV0IG5vcm10aW1lRGVmO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCAqIGFzIHN0IGZyb20gJy4vc3R5bGUnO1xuaW1wb3J0IHtnZXRDdXJ2ZX0gZnJvbSAnLi9jdXJ2ZSc7XG5cblxuXG5leHBvcnQgY29uc3QgTk9PUCA9IGZ1bmN0aW9uKHVudXNlZFRpbWUpIHtyZXR1cm4gbnVsbDt9O1xuXG5cbi8qKlxuICogUmV0dXJucyBhIHRyYW5zaXRpb24gdGhhdCBjb21iaW5lcyBhIG51bWJlciBvZiBvdGhlciB0cmFuc2l0aW9ucyBhbmRcbiAqIGludm9rZXMgdGhlbSBhbGwgaW4gcGFyYWxsZWwuXG4gKiBAcGFyYW0geyFBcnJheTwhVHJhbnNpdGlvbkRlZj59IHRyYW5zaXRpb25zXG4gKiBAcmV0dXJuIHshVHJhbnNpdGlvbkRlZjx2b2lkPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFsbCh0cmFuc2l0aW9ucykge1xuICByZXR1cm4gKHRpbWUsIGNvbXBsZXRlKSA9PiB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmFuc2l0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgdHIgPSB0cmFuc2l0aW9uc1tpXTtcbiAgICAgIHRyKHRpbWUsIGNvbXBsZXRlKTtcbiAgICB9XG4gIH07XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgdHJhbnNpdGlvbiB0aGF0IGNvbWJpbmVzIHRoZSBzdHJpbmcgcmVzdWx0IG9mIG90aGVyIHN0cmluZy1iYXNlZFxuICogdHJhbnNpdGlvbnMgc3VjaCBhcyB0cmFuc2Zvcm0gYW5kIHNjYWxlIHVzaW5nIHRoZSBnaXZlbiBvcHRfZGVsaW1pdGVyLlxuICogQHBhcmFtIHshQXJyYXk8IVRyYW5zaXRpb25EZWY8c3RyaW5nPj59IHRyYW5zaXRpb25zXG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF9kZWxpbWl0ZXIgRGVmYXVsdHMgdG8gYSBzaW5nbGUgd2hpdGVzcGFjZS5cbiAqIEByZXR1cm4geyFUcmFuc2l0aW9uRGVmPHN0cmluZz59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb25jYXQodHJhbnNpdGlvbnMsIG9wdF9kZWxpbWl0ZXIgPSAnICcpIHtcbiAgcmV0dXJuICh0aW1lLCBjb21wbGV0ZSkgPT4ge1xuICAgIGNvbnN0IHJlc3VsdHMgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyYW5zaXRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCB0ciA9IHRyYW5zaXRpb25zW2ldO1xuICAgICAgY29uc3QgcmVzdWx0ID0gdHIodGltZSwgY29tcGxldGUpO1xuICAgICAgaWYgKHR5cGVvZiByZXN1bHQgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmVzdWx0cy5wdXNoKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHRzLmpvaW4ob3B0X2RlbGltaXRlcik7XG4gIH07XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBzcGVjaWZpZWQgdHJhbnNpdGlvbiB3aXRoIHRoZSB0aW1lIGN1cnZlZCB2aWEgc3BlY2lmaWVkIGN1cnZlXG4gKiBmdW5jdGlvbi5cbiAqIEBwYXJhbSB7IVRyYW5zaXRpb25EZWY8UkVTVUxUPn0gdHJhbnNpdGlvblxuICogQHBhcmFtIHshLi9jdXJ2ZS5DdXJ2ZURlZnxzdHJpbmd9IGN1cnZlXG4gKiBAcmV0dXJuIHshVHJhbnNpdGlvbkRlZjxSRVNVTFQ+fVxuICogQHRlbXBsYXRlIFJFU1VMVFxuICovXG5leHBvcnQgZnVuY3Rpb24gd2l0aEN1cnZlKHRyYW5zaXRpb24sIGN1cnZlKSB7XG4gIC8qKiBAY29uc3Qgez8uL2N1cnZlLkN1cnZlRGVmfSAqL1xuICBjb25zdCBjdXJ2ZUZuID0gZ2V0Q3VydmUoY3VydmUpO1xuICByZXR1cm4gKHRpbWUsIGNvbXBsZXRlKSA9PiB7XG4gICAgcmV0dXJuIHRyYW5zaXRpb24oY29tcGxldGUgPyAxIDogY3VydmVGbih0aW1lKSwgY29tcGxldGUpO1xuICB9O1xufVxuXG5cbi8qKlxuICogQSB0cmFuc2l0aW9uIHRoYXQgc2V0cyB0aGUgQ1NTIHN0eWxlIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudC4gVGhlIHN0eWxlc1xuICogYSBzcGVjaWZpZWQgYXMgYSBtYXAgZnJvbSBDU1MgcHJvcGVydHkgbmFtZXMgdG8gdHJhbnNpdGlvbiBmdW5jdGlvbnMgZm9yXG4gKiBlYWNoIG9mIHRoZXNlIHByb3BlcnRpZXMuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAhVHJhbnNpdGlvbkRlZj59IHN0eWxlc1xuICogQHJldHVybiB7IVRyYW5zaXRpb25EZWY8dm9pZD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRTdHlsZXMoZWxlbWVudCwgc3R5bGVzKSB7XG4gIHJldHVybiAodGltZSwgY29tcGxldGUpID0+IHtcbiAgICBmb3IgKGNvbnN0IGsgaW4gc3R5bGVzKSB7XG4gICAgICBzdC5zZXRTdHlsZShlbGVtZW50LCBrLCBzdHlsZXNba10odGltZSwgY29tcGxldGUpKTtcbiAgICB9XG4gIH07XG59XG5cblxuLyoqXG4gKiBBIGJhc2ljIG51bWVyaWMgaW50ZXJwb2xhdGlvbi5cbiAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydFxuICogQHBhcmFtIHtudW1iZXJ9IGVuZFxuICogQHJldHVybiB7IVRyYW5zaXRpb25EZWY8bnVtYmVyPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG51bWVyaWMoc3RhcnQsIGVuZCkge1xuICByZXR1cm4gdGltZSA9PiB7XG4gICAgcmV0dXJuIHN0YXJ0ICsgKGVuZCAtIHN0YXJ0KSAqIHRpbWU7XG4gIH07XG59XG5cblxuLyoqXG4gKiBTcHJpbmcgbnVtZXJpYyBpbnRlcnBvbGF0aW9uLlxuICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0XG4gKiBAcGFyYW0ge251bWJlcn0gZW5kXG4gKiBAcGFyYW0ge251bWJlcn0gZXh0ZW5kZWRcbiAqIEBwYXJhbSB7bnVtYmVyfSB0aHJlc2hvbGRcbiAqIEByZXR1cm4geyFUcmFuc2l0aW9uRGVmPG51bWJlcj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzcHJpbmcoc3RhcnQsIGVuZCwgZXh0ZW5kZWQsIHRocmVzaG9sZCkge1xuICBpZiAoZW5kID09IGV4dGVuZGVkKSB7XG4gICAgcmV0dXJuIHRpbWUgPT4ge1xuICAgICAgcmV0dXJuIG51bWVyaWMoc3RhcnQsIGVuZCkodGltZSk7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gdGltZSA9PiB7XG4gICAgaWYgKHRpbWUgPCB0aHJlc2hvbGQpIHtcbiAgICAgIHJldHVybiBzdGFydCArIChleHRlbmRlZCAtIHN0YXJ0KSAqICh0aW1lIC8gdGhyZXNob2xkKTtcbiAgICB9XG4gICAgcmV0dXJuIGV4dGVuZGVkICsgKGVuZCAtIGV4dGVuZGVkKSAqICgodGltZSAtIHRocmVzaG9sZCkgL1xuICAgICAgICAoMSAtIHRocmVzaG9sZCkpO1xuICB9O1xufVxuXG5cbi8qKlxuICogQWRkcyBcInB4XCIgdW5pdHMuXG4gKiBAcGFyYW0geyFUcmFuc2l0aW9uRGVmPG51bWJlcj59IHRyYW5zaXRpb25cbiAqIEByZXR1cm4geyFUcmFuc2l0aW9uRGVmPHN0cmluZz59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBweCh0cmFuc2l0aW9uKSB7XG4gIHJldHVybiB0aW1lID0+IHtcbiAgICByZXR1cm4gdHJhbnNpdGlvbih0aW1lKSArICdweCc7XG4gIH07XG59XG5cblxuLyoqXG4gKiBBIHRyYW5zaXRpb24gZm9yIFwidHJhbnNsYXRlWFwiIG9mIENTUyBcInRyYW5zZm9ybVwiIHByb3BlcnR5LlxuICogQHBhcmFtIHshVHJhbnNpdGlvbkRlZjxudW1iZXJ8c3RyaW5nPn0gdHJhbnNpdGlvblxuICogQHJldHVybiB7IVRyYW5zaXRpb25EZWY8c3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyYW5zbGF0ZVgodHJhbnNpdGlvbikge1xuICByZXR1cm4gdGltZSA9PiB7XG4gICAgY29uc3QgcmVzID0gdHJhbnNpdGlvbih0aW1lKTtcbiAgICBpZiAodHlwZW9mIHJlcyA9PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIGB0cmFuc2xhdGVYKCR7cmVzfSlgO1xuICAgIH1cbiAgICByZXR1cm4gYHRyYW5zbGF0ZVgoJHtyZXN9cHgpYDtcbiAgfTtcbn1cblxuLyoqXG4gKiBBIHRyYW5zaXRpb24gZm9yIFwidHJhbnNsYXRlWVwiIG9mIENTUyBcInRyYW5zZm9ybVwiIHByb3BlcnR5LlxuICogQHBhcmFtIHshVHJhbnNpdGlvbkRlZjxudW1iZXJ8c3RyaW5nPn0gdHJhbnNpdGlvblxuICogQHJldHVybiB7IVRyYW5zaXRpb25EZWY8c3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyYW5zbGF0ZVkodHJhbnNpdGlvbikge1xuICByZXR1cm4gdGltZSA9PiB7XG4gICAgY29uc3QgcmVzID0gdHJhbnNpdGlvbih0aW1lKTtcbiAgICBpZiAodHlwZW9mIHJlcyA9PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIGB0cmFuc2xhdGVZKCR7cmVzfSlgO1xuICAgIH1cbiAgICByZXR1cm4gYHRyYW5zbGF0ZVkoJHtyZXN9cHgpYDtcbiAgfTtcbn1cblxuXG4vKipcbiAqIEEgdHJhbnNpdGlvbiBmb3IgXCJ0cmFuc2xhdGUoeCwgeSlcIiBvZiBDU1MgXCJ0cmFuc2Zvcm1cIiBwcm9wZXJ0eS5cbiAqIEBwYXJhbSB7IVRyYW5zaXRpb25EZWY8bnVtYmVyfHN0cmluZz59IHRyYW5zaXRpb25YXG4gKiBAcGFyYW0geyFUcmFuc2l0aW9uRGVmPG51bWJlcnxzdHJpbmc+fHVuZGVmaW5lZH0gb3B0X3RyYW5zaXRpb25ZXG4gKiBAcmV0dXJuIHshVHJhbnNpdGlvbkRlZjxzdHJpbmc+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJhbnNsYXRlKHRyYW5zaXRpb25YLCBvcHRfdHJhbnNpdGlvblkpIHtcbiAgcmV0dXJuIHRpbWUgPT4ge1xuICAgIGxldCB4ID0gdHJhbnNpdGlvblgodGltZSk7XG4gICAgaWYgKHR5cGVvZiB4ID09ICdudW1iZXInKSB7XG4gICAgICB4ID0gc3QucHgoeCk7XG4gICAgfVxuICAgIGlmICghb3B0X3RyYW5zaXRpb25ZKSB7XG4gICAgICByZXR1cm4gYHRyYW5zbGF0ZSgke3h9KWA7XG4gICAgfVxuXG4gICAgbGV0IHkgPSBvcHRfdHJhbnNpdGlvblkodGltZSk7XG4gICAgaWYgKHR5cGVvZiB5ID09ICdudW1iZXInKSB7XG4gICAgICB5ID0gc3QucHgoeSk7XG4gICAgfVxuICAgIHJldHVybiBgdHJhbnNsYXRlKCR7eH0sJHt5fSlgO1xuICB9O1xufVxuXG5cbi8qKlxuICogQSB0cmFuc2l0aW9uIGZvciBcInNjYWxlXCIgb2YgQ1NTIFwidHJhbnNmb3JtXCIgcHJvcGVydHkuXG4gKiBAcGFyYW0geyFUcmFuc2l0aW9uRGVmPG51bWJlcnxzdHJpbmc+fSB0cmFuc2l0aW9uXG4gKiBAcmV0dXJuIHshVHJhbnNpdGlvbkRlZjxzdHJpbmc+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2NhbGUodHJhbnNpdGlvbikge1xuICByZXR1cm4gdGltZSA9PiB7XG4gICAgcmV0dXJuIGBzY2FsZSgke3RyYW5zaXRpb24odGltZSl9KWA7XG4gIH07XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyogQGNvbnN0ICovXG5jb25zdCB0b1N0cmluZ18gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXG4vKipcbiAqIFJldHVybnMgdGhlIEVDTUEgW1tDbGFzc11dIG9mIGEgdmFsdWVcbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gdG9TdHJpbmcodmFsdWUpIHtcbiAgcmV0dXJuIHRvU3RyaW5nXy5jYWxsKHZhbHVlKTtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmVzIGlmIHZhbHVlIGlzIGFjdHVhbGx5IGFuIEFycmF5LlxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQXJyYXkodmFsdWUpIHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkodmFsdWUpO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGFuIGFycmF5LWxpa2Ugb2JqZWN0IHRvIGFuIGFycmF5LlxuICogQHBhcmFtIHs/SUFycmF5TGlrZTxUPnxzdHJpbmd9IGFycmF5TGlrZVxuICogQHJldHVybiB7IUFycmF5PFQ+fVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvQXJyYXkoYXJyYXlMaWtlKSB7XG4gIGlmICghYXJyYXlMaWtlKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGNvbnN0IGFycmF5ID0gbmV3IEFycmF5KGFycmF5TGlrZS5sZW5ndGgpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5TGlrZS5sZW5ndGg7IGkrKykge1xuICAgIGFycmF5W2ldID0gYXJyYXlMaWtlW2ldO1xuICB9XG4gIHJldHVybiBhcnJheTtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmVzIGlmIHZhbHVlIGlzIGFjdHVhbGx5IGFuIE9iamVjdC5cbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc09iamVjdCh2YWx1ZSkge1xuICByZXR1cm4gdG9TdHJpbmcodmFsdWUpID09PSAnW29iamVjdCBPYmplY3RdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmVzIGlmIHZhbHVlIGlzIG9mIG51bWJlciB0eXBlIGFuZCBmaW5pdGUuXG4gKiBOYU4gYW5kIEluZmluaXR5IGFyZSBub3QgY29uc2lkZXJlZCBhIGZpbml0ZSBudW1iZXIuXG4gKiBTdHJpbmcgbnVtYmVycyBhcmUgbm90IGNvbnNpZGVyZWQgbnVtYmVycy5cbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Zpbml0ZU51bWJlcih2YWx1ZSkge1xuICByZXR1cm4gKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgJiYgaXNGaW5pdGUodmFsdWUpKTtcbn1cblxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciBgc2AgaXMgYSB2YWxpZCB2YWx1ZSBvZiBgZW51bU9iamAuXG4gKlxuICogQHBhcmFtIHshT2JqZWN0PFQ+fSBlbnVtT2JqXG4gKiBAcGFyYW0ge1R9IHNcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNFbnVtVmFsdWUoZW51bU9iaiwgcykge1xuICBmb3IgKGNvbnN0IGsgaW4gZW51bU9iaikge1xuICAgIGlmIChlbnVtT2JqW2tdID09PSBzKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIEV4dGVybnMgZGVjbGFyZSB0aGF0IGFjY2VzcyBgZGVmYXVsdFZpZXdgIGZyb20gYGRvY3VtZW50YCBvclxuICogYG93bmVyRG9jdW1lbnRgIGlzIG9mIHR5cGUgYChXaW5kb3d8bnVsbClgIGJ1dCBtb3N0IG9mIG91ciBwYXJhbWV0ZXIgdHlwZXNcbiAqIGFzc3VtZSB0aGF0IGl0IGlzIG5ldmVyIG51bGwuIFRoaXMgaXMgT0sgaW4gcHJhY3RpY2UgYXMgd2UgZXZlciBvbmx5IGdldFxuICogbnVsbCBvbiBkaXNjb25uZWN0ZWQgZG9jdW1lbnRzIG9yIG9sZCBJRS5cbiAqIFRoaXMgaGVscGVyIGZ1bmN0aW9uIGNhc3RzIGl0IGludG8ganVzdCBhIHNpbXBsZSBXaW5kb3cgcmV0dXJuIHR5cGUuXG4gKlxuICogQHBhcmFtIHshV2luZG93fG51bGx9IHdpbk9yTnVsbFxuICogQHJldHVybiB7IVdpbmRvd31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvV2luKHdpbk9yTnVsbCkge1xuICByZXR1cm4gLyoqIEB0eXBlIHshV2luZG93fSAqLyAod2luT3JOdWxsKTtcbn1cblxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7dHJ5RGVjb2RlVXJpQ29tcG9uZW50X30gZnJvbSAnLi91cmwtdHJ5LWRlY29kZS11cmktY29tcG9uZW50JztcblxuY29uc3QgcmVnZXggPSAvKD86XlsjP10/fCYpKFtePSZdKykoPzo9KFteJl0qKSk/L2c7XG5cbi8qKlxuICogUGFyc2VzIHRoZSBxdWVyeSBzdHJpbmcgb2YgYW4gVVJMLiBUaGlzIG1ldGhvZCByZXR1cm5zIGEgc2ltcGxlIGtleS92YWx1ZVxuICogbWFwLiBJZiB0aGVyZSBhcmUgZHVwbGljYXRlIGtleXMgdGhlIGxhdGVzdCB2YWx1ZSBpcyByZXR1cm5lZC5cbiAqXG4gKiBETyBOT1QgaW1wb3J0IHRoZSBmdW5jdGlvbiBmcm9tIHRoaXMgZmlsZS4gSW5zdGVhZCwgaW1wb3J0IHBhcnNlUXVlcnlTdHJpbmdcbiAqIGZyb20gYHNyYy91cmwuanNgLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBxdWVyeVN0cmluZ1xuICogQHJldHVybiB7IUpzb25PYmplY3R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVF1ZXJ5U3RyaW5nXyhxdWVyeVN0cmluZykge1xuICBjb25zdCBwYXJhbXMgPSAvKiogQHR5cGUgeyFKc29uT2JqZWN0fSAqLyAoT2JqZWN0LmNyZWF0ZShudWxsKSk7XG4gIGlmICghcXVlcnlTdHJpbmcpIHtcbiAgICByZXR1cm4gcGFyYW1zO1xuICB9XG5cbiAgbGV0IG1hdGNoO1xuICB3aGlsZSAoKG1hdGNoID0gcmVnZXguZXhlYyhxdWVyeVN0cmluZykpKSB7XG4gICAgY29uc3QgbmFtZSA9IHRyeURlY29kZVVyaUNvbXBvbmVudF8obWF0Y2hbMV0sIG1hdGNoWzFdKTtcbiAgICBjb25zdCB2YWx1ZSA9IG1hdGNoWzJdID8gdHJ5RGVjb2RlVXJpQ29tcG9uZW50XyhtYXRjaFsyXSwgbWF0Y2hbMl0pIDogJyc7XG4gICAgcGFyYW1zW25hbWVdID0gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIHBhcmFtcztcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIFRyaWVzIHRvIGRlY29kZSBhIFVSSSBjb21wb25lbnQsIGZhbGxpbmcgYmFjayB0byBvcHRfZmFsbGJhY2sgKG9yIGFuIGVtcHR5XG4gKiBzdHJpbmcpXG4gKlxuICogRE8gTk9UIGltcG9ydCB0aGUgZnVuY3Rpb24gZnJvbSB0aGlzIGZpbGUuIEluc3RlYWQsIGltcG9ydFxuICogdHJ5RGVjb2RlVXJpQ29tcG9uZW50IGZyb20gYHNyYy91cmwuanNgLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb21wb25lbnRcbiAqIEBwYXJhbSB7c3RyaW5nPX0gZmFsbGJhY2tcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyeURlY29kZVVyaUNvbXBvbmVudF8oY29tcG9uZW50LCBmYWxsYmFjayA9ICcnKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChjb21wb25lbnQpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbGxiYWNrO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtMcnVDYWNoZX0gZnJvbSAnLi91dGlscy9scnUtY2FjaGUnO1xuaW1wb3J0IHtkaWN0fSBmcm9tICcuL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge2VuZHNXaXRoLCBzdGFydHNXaXRofSBmcm9tICcuL3N0cmluZyc7XG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4vbW9kZSc7XG5pbXBvcnQge2lzQXJyYXl9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHtwYXJzZVF1ZXJ5U3RyaW5nX30gZnJvbSAnLi91cmwtcGFyc2UtcXVlcnktc3RyaW5nJztcbmltcG9ydCB7dHJ5RGVjb2RlVXJpQ29tcG9uZW50X30gZnJvbSAnLi91cmwtdHJ5LWRlY29kZS11cmktY29tcG9uZW50JztcbmltcG9ydCB7dXJsc30gZnJvbSAnLi9jb25maWcnO1xuaW1wb3J0IHt1c2VyfSBmcm9tICcuL2xvZyc7XG5cbi8qKlxuICogQHR5cGUgeyFKc29uT2JqZWN0fVxuICovXG5jb25zdCBTRVJWSU5HX1RZUEVfUFJFRklYID0gZGljdCh7XG4gIC8vIE5vIHZpZXdlclxuICAnYyc6IHRydWUsXG4gIC8vIEluIHZpZXdlclxuICAndic6IHRydWUsXG4gIC8vIEFkIGxhbmRpbmcgcGFnZVxuICAnYSc6IHRydWUsXG4gIC8vIEFkXG4gICdhZCc6IHRydWUsXG59KTtcblxuLyoqXG4gKiBDYWNoZWQgYS10YWcgdG8gYXZvaWQgbWVtb3J5IGFsbG9jYXRpb24gZHVyaW5nIFVSTCBwYXJzaW5nLlxuICogQHR5cGUge0hUTUxBbmNob3JFbGVtZW50fVxuICovXG5sZXQgYTtcblxuLyoqXG4gKiBXZSBjYWNoZWQgYWxsIHBhcnNlZCBVUkxzLiBBcyBvZiBub3cgdGhlcmUgYXJlIG5vIHVzZSBjYXNlc1xuICogb2YgQU1QIGRvY3MgdGhhdCB3b3VsZCBldmVyIHBhcnNlIGFuIGFjdHVhbCBsYXJnZSBudW1iZXIgb2YgVVJMcyxcbiAqIGJ1dCB3ZSBvZnRlbiBwYXJzZSB0aGUgc2FtZSBvbmUgb3ZlciBhbmQgb3ZlciBhZ2Fpbi5cbiAqIEB0eXBlIHtMcnVDYWNoZX1cbiAqL1xubGV0IGNhY2hlO1xuXG4vKiogQHByaXZhdGUgQGNvbnN0IE1hdGNoZXMgYW1wX2pzXyogcGFyYW1ldGVycyBpbiBxdWVyeSBzdHJpbmcuICovXG5jb25zdCBBTVBfSlNfUEFSQU1TX1JFR0VYID0gL1s/Jl1hbXBfanNbXiZdKi87XG5cbi8qKiBAcHJpdmF0ZSBAY29uc3QgTWF0Y2hlcyBhbXBfZ3NhIHBhcmFtZXRlcnMgaW4gcXVlcnkgc3RyaW5nLiAqL1xuY29uc3QgQU1QX0dTQV9QQVJBTVNfUkVHRVggPSAvWz8mXWFtcF9nc2FbXiZdKi87XG5cbi8qKiBAcHJpdmF0ZSBAY29uc3QgTWF0Y2hlcyBhbXBfciBwYXJhbWV0ZXJzIGluIHF1ZXJ5IHN0cmluZy4gKi9cbmNvbnN0IEFNUF9SX1BBUkFNU19SRUdFWCA9IC9bPyZdYW1wX3JbXiZdKi87XG5cbi8qKiBAcHJpdmF0ZSBAY29uc3QgTWF0Y2hlcyB1c3FwIHBhcmFtZXRlcnMgZnJvbSBnb29nIGV4cGVyaW1lbnQgaW4gcXVlcnkgc3RyaW5nLiAqL1xuY29uc3QgR09PR0xFX0VYUEVSSU1FTlRfUEFSQU1TX1JFR0VYID0gL1s/Jl11c3FwW14mXSovO1xuXG5jb25zdCBJTlZBTElEX1BST1RPQ09MUyA9IFtcbiAgLyplc2xpbnQgbm8tc2NyaXB0LXVybDogMCovICdqYXZhc2NyaXB0OicsXG4gIC8qZXNsaW50IG5vLXNjcmlwdC11cmw6IDAqLyAnZGF0YTonLFxuICAvKmVzbGludCBuby1zY3JpcHQtdXJsOiAwKi8gJ3Zic2NyaXB0OicsXG5dO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgU09VUkNFX09SSUdJTl9QQVJBTSA9ICdfX2FtcF9zb3VyY2Vfb3JpZ2luJztcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBjb3JyZWN0IG9yaWdpbiBmb3IgYSBnaXZlbiB3aW5kb3cuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7c3RyaW5nfSBvcmlnaW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFdpbk9yaWdpbih3aW4pIHtcbiAgcmV0dXJuIHdpbi5vcmlnaW4gfHwgcGFyc2VVcmxEZXByZWNhdGVkKHdpbi5sb2NhdGlvbi5ocmVmKS5vcmlnaW47XG59XG5cbi8qKlxuICogUmV0dXJucyBhIExvY2F0aW9uLWxpa2Ugb2JqZWN0IGZvciB0aGUgZ2l2ZW4gVVJMLiBJZiBpdCBpcyByZWxhdGl2ZSxcbiAqIHRoZSBVUkwgZ2V0cyByZXNvbHZlZC5cbiAqIENvbnNpZGVyIHRoZSByZXR1cm5lZCBvYmplY3QgaW1tdXRhYmxlLiBUaGlzIGlzIGVuZm9yY2VkIGR1cmluZ1xuICogdGVzdGluZyBieSBmcmVlemluZyB0aGUgb2JqZWN0LlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X25vY2FjaGVcbiAqIEByZXR1cm4geyFMb2NhdGlvbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwsIG9wdF9ub2NhY2hlKSB7XG4gIGlmICghYSkge1xuICAgIGEgPSAvKiogQHR5cGUgeyFIVE1MQW5jaG9yRWxlbWVudH0gKi8gKHNlbGYuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpKTtcbiAgICBjYWNoZSA9IHNlbGYuVXJsQ2FjaGUgfHwgKHNlbGYuVXJsQ2FjaGUgPSBuZXcgTHJ1Q2FjaGUoMTAwKSk7XG4gIH1cblxuICByZXR1cm4gcGFyc2VVcmxXaXRoQShhLCB1cmwsIG9wdF9ub2NhY2hlID8gbnVsbCA6IGNhY2hlKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgTG9jYXRpb24tbGlrZSBvYmplY3QgZm9yIHRoZSBnaXZlbiBVUkwuIElmIGl0IGlzIHJlbGF0aXZlLFxuICogdGhlIFVSTCBnZXRzIHJlc29sdmVkLlxuICogQ29uc2lkZXIgdGhlIHJldHVybmVkIG9iamVjdCBpbW11dGFibGUuIFRoaXMgaXMgZW5mb3JjZWQgZHVyaW5nXG4gKiB0ZXN0aW5nIGJ5IGZyZWV6aW5nIHRoZSBvYmplY3QuXG4gKiBAcGFyYW0geyFIVE1MQW5jaG9yRWxlbWVudH0gYVxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHBhcmFtIHtMcnVDYWNoZT19IG9wdF9jYWNoZVxuICogQHJldHVybiB7IUxvY2F0aW9ufVxuICogQHJlc3RyaWN0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlVXJsV2l0aEEoYSwgdXJsLCBvcHRfY2FjaGUpIHtcbiAgaWYgKG9wdF9jYWNoZSAmJiBvcHRfY2FjaGUuaGFzKHVybCkpIHtcbiAgICByZXR1cm4gb3B0X2NhY2hlLmdldCh1cmwpO1xuICB9XG5cbiAgYS5ocmVmID0gdXJsO1xuXG4gIC8vIElFMTEgZG9lc24ndCBwcm92aWRlIGZ1bGwgVVJMIGNvbXBvbmVudHMgd2hlbiBwYXJzaW5nIHJlbGF0aXZlIFVSTHMuXG4gIC8vIEFzc2lnbmluZyB0byBpdHNlbGYgYWdhaW4gZG9lcyB0aGUgdHJpY2sgIzM0NDkuXG4gIGlmICghYS5wcm90b2NvbCkge1xuICAgIGEuaHJlZiA9IGEuaHJlZjtcbiAgfVxuXG4gIGNvbnN0IGluZm8gPSAvKiogQHR5cGUgeyFMb2NhdGlvbn0gKi8oe1xuICAgIGhyZWY6IGEuaHJlZixcbiAgICBwcm90b2NvbDogYS5wcm90b2NvbCxcbiAgICBob3N0OiBhLmhvc3QsXG4gICAgaG9zdG5hbWU6IGEuaG9zdG5hbWUsXG4gICAgcG9ydDogYS5wb3J0ID09ICcwJyA/ICcnIDogYS5wb3J0LFxuICAgIHBhdGhuYW1lOiBhLnBhdGhuYW1lLFxuICAgIHNlYXJjaDogYS5zZWFyY2gsXG4gICAgaGFzaDogYS5oYXNoLFxuICAgIG9yaWdpbjogbnVsbCwgLy8gU2V0IGJlbG93LlxuICB9KTtcblxuICAvLyBTb21lIElFMTEgc3BlY2lmaWMgcG9seWZpbGxzLlxuICAvLyAxKSBJRTExIHN0cmlwcyBvdXQgdGhlIGxlYWRpbmcgJy8nIGluIHRoZSBwYXRobmFtZS5cbiAgaWYgKGluZm8ucGF0aG5hbWVbMF0gIT09ICcvJykge1xuICAgIGluZm8ucGF0aG5hbWUgPSAnLycgKyBpbmZvLnBhdGhuYW1lO1xuICB9XG5cbiAgLy8gMikgRm9yIFVSTHMgd2l0aCBpbXBsaWNpdCBwb3J0cywgSUUxMSBwYXJzZXMgdG8gZGVmYXVsdCBwb3J0cyB3aGlsZVxuICAvLyBvdGhlciBicm93c2VycyBsZWF2ZSB0aGUgcG9ydCBmaWVsZCBlbXB0eS5cbiAgaWYgKChpbmZvLnByb3RvY29sID09ICdodHRwOicgJiYgaW5mby5wb3J0ID09IDgwKVxuICAgICAgfHwgKGluZm8ucHJvdG9jb2wgPT0gJ2h0dHBzOicgJiYgaW5mby5wb3J0ID09IDQ0MykpIHtcbiAgICBpbmZvLnBvcnQgPSAnJztcbiAgICBpbmZvLmhvc3QgPSBpbmZvLmhvc3RuYW1lO1xuICB9XG5cbiAgLy8gRm9yIGRhdGEgVVJJIGEub3JpZ2luIGlzIGVxdWFsIHRvIHRoZSBzdHJpbmcgJ251bGwnIHdoaWNoIGlzIG5vdCB1c2VmdWwuXG4gIC8vIFdlIGluc3RlYWQgcmV0dXJuIHRoZSBhY3R1YWwgb3JpZ2luIHdoaWNoIGlzIHRoZSBmdWxsIFVSTC5cbiAgaWYgKGEub3JpZ2luICYmIGEub3JpZ2luICE9ICdudWxsJykge1xuICAgIGluZm8ub3JpZ2luID0gYS5vcmlnaW47XG4gIH0gZWxzZSBpZiAoaW5mby5wcm90b2NvbCA9PSAnZGF0YTonIHx8ICFpbmZvLmhvc3QpIHtcbiAgICBpbmZvLm9yaWdpbiA9IGluZm8uaHJlZjtcbiAgfSBlbHNlIHtcbiAgICBpbmZvLm9yaWdpbiA9IGluZm8ucHJvdG9jb2wgKyAnLy8nICsgaW5mby5ob3N0O1xuICB9XG5cbiAgLy8gRnJlZXplIGR1cmluZyB0ZXN0aW5nIHRvIGF2b2lkIGFjY2lkZW50YWwgbXV0YXRpb24uXG4gIGNvbnN0IGZyb3plbiA9IChnZXRNb2RlKCkudGVzdCAmJiBPYmplY3QuZnJlZXplKSA/IE9iamVjdC5mcmVlemUoaW5mbykgOiBpbmZvO1xuXG4gIGlmIChvcHRfY2FjaGUpIHtcbiAgICBvcHRfY2FjaGUucHV0KHVybCwgZnJvemVuKTtcbiAgfVxuXG4gIHJldHVybiBmcm96ZW47XG59XG5cbi8qKlxuICogQXBwZW5kcyB0aGUgc3RyaW5nIGp1c3QgYmVmb3JlIHRoZSBmcmFnbWVudCBwYXJ0IChvciBvcHRpb25hbGx5XG4gKiB0byB0aGUgZnJvbnQgb2YgdGhlIHF1ZXJ5IHN0cmluZykgb2YgdGhlIFVSTC5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXJhbVN0cmluZ1xuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2FkZFRvRnJvbnRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGVuZEVuY29kZWRQYXJhbVN0cmluZ1RvVXJsKHVybCwgcGFyYW1TdHJpbmcsXG4gIG9wdF9hZGRUb0Zyb250KSB7XG4gIGlmICghcGFyYW1TdHJpbmcpIHtcbiAgICByZXR1cm4gdXJsO1xuICB9XG4gIGNvbnN0IG1haW5BbmRGcmFnbWVudCA9IHVybC5zcGxpdCgnIycsIDIpO1xuICBjb25zdCBtYWluQW5kUXVlcnkgPSBtYWluQW5kRnJhZ21lbnRbMF0uc3BsaXQoJz8nLCAyKTtcblxuICBsZXQgbmV3VXJsID0gbWFpbkFuZFF1ZXJ5WzBdICsgKFxuICAgIG1haW5BbmRRdWVyeVsxXVxuICAgICAgPyAob3B0X2FkZFRvRnJvbnRcbiAgICAgICAgPyBgPyR7cGFyYW1TdHJpbmd9JiR7bWFpbkFuZFF1ZXJ5WzFdfWBcbiAgICAgICAgOiBgPyR7bWFpbkFuZFF1ZXJ5WzFdfSYke3BhcmFtU3RyaW5nfWApXG4gICAgICA6IGA/JHtwYXJhbVN0cmluZ31gKTtcbiAgbmV3VXJsICs9IG1haW5BbmRGcmFnbWVudFsxXSA/IGAjJHttYWluQW5kRnJhZ21lbnRbMV19YCA6ICcnO1xuICByZXR1cm4gbmV3VXJsO1xufVxuLyoqXG4gKiBBcHBlbmRzIGEgcXVlcnkgc3RyaW5nIGZpZWxkIGFuZCB2YWx1ZSB0byBhIHVybC4gYGtleWAgYW5kIGB2YWx1ZWBcbiAqIHdpbGwgYmUgcmFuIHRocm91Z2ggYGVuY29kZVVSSUNvbXBvbmVudGAgYmVmb3JlIGFwcGVuZGluZy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXlcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2FkZFRvRnJvbnRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZFBhcmFtVG9VcmwodXJsLCBrZXksIHZhbHVlLCBvcHRfYWRkVG9Gcm9udCkge1xuICBjb25zdCBmaWVsZCA9IGAke2VuY29kZVVSSUNvbXBvbmVudChrZXkpfT0ke2VuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSl9YDtcbiAgcmV0dXJuIGFwcGVuZEVuY29kZWRQYXJhbVN0cmluZ1RvVXJsKHVybCwgZmllbGQsIG9wdF9hZGRUb0Zyb250KTtcbn1cblxuLyoqXG4gKiBBcHBlbmRzIHF1ZXJ5IHN0cmluZyBmaWVsZHMgYW5kIHZhbHVlcyB0byBhIHVybC4gVGhlIGBwYXJhbXNgIG9iamVjdHMnXG4gKiBga2V5YHMgYW5kIGB2YWx1ZWBzIHdpbGwgYmUgdHJhbnNmb3JtZWQgaW50byBxdWVyeSBzdHJpbmcga2V5cy92YWx1ZXMuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0PHN0cmluZywgc3RyaW5nfCFBcnJheTxzdHJpbmc+Pn0gcGFyYW1zXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGRQYXJhbXNUb1VybCh1cmwsIHBhcmFtcykge1xuICByZXR1cm4gYXBwZW5kRW5jb2RlZFBhcmFtU3RyaW5nVG9VcmwodXJsLCBzZXJpYWxpemVRdWVyeVN0cmluZyhwYXJhbXMpKTtcbn1cblxuLyoqXG4gKiBTZXJpYWxpemVzIHRoZSBwYXNzZWQgcGFyYW1ldGVyIG1hcCBpbnRvIGEgcXVlcnkgc3RyaW5nIHdpdGggYm90aCBrZXlzXG4gKiBhbmQgdmFsdWVzIGVuY29kZWQuXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0PHN0cmluZywgc3RyaW5nfCFBcnJheTxzdHJpbmc+Pn0gcGFyYW1zXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXJpYWxpemVRdWVyeVN0cmluZyhwYXJhbXMpIHtcbiAgY29uc3QgcyA9IFtdO1xuICBmb3IgKGNvbnN0IGsgaW4gcGFyYW1zKSB7XG4gICAgY29uc3QgdiA9IHBhcmFtc1trXTtcbiAgICBpZiAodiA9PSBudWxsKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9IGVsc2UgaWYgKGlzQXJyYXkodikpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdi5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBzdiA9IC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAodltpXSk7XG4gICAgICAgIHMucHVzaChgJHtlbmNvZGVVUklDb21wb25lbnQoayl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHN2KX1gKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgc3YgPSAvKiogQHR5cGUge3N0cmluZ30gKi8gKHYpO1xuICAgICAgcy5wdXNoKGAke2VuY29kZVVSSUNvbXBvbmVudChrKX09JHtlbmNvZGVVUklDb21wb25lbnQoc3YpfWApO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcy5qb2luKCcmJyk7XG59XG5cbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIFVSTCBpcyBzZWN1cmU6IGVpdGhlciBIVFRQUyBvciBsb2NhbGhvc3QgKGZvciB0ZXN0aW5nKS5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNTZWN1cmVVcmxEZXByZWNhdGVkKHVybCkge1xuICBpZiAodHlwZW9mIHVybCA9PSAnc3RyaW5nJykge1xuICAgIHVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICB9XG4gIHJldHVybiAodXJsLnByb3RvY29sID09ICdodHRwczonIHx8XG4gICAgICB1cmwuaG9zdG5hbWUgPT0gJ2xvY2FsaG9zdCcgfHxcbiAgICAgIGVuZHNXaXRoKHVybC5ob3N0bmFtZSwgJy5sb2NhbGhvc3QnKSk7XG59XG5cbi8qKlxuICogQXNzZXJ0cyB0aGF0IGEgZ2l2ZW4gdXJsIGlzIEhUVFBTIG9yIHByb3RvY29sIHJlbGF0aXZlLiBJdCdzIGEgdXNlci1sZXZlbFxuICogYXNzZXJ0LlxuICpcbiAqIFByb3ZpZGVzIGFuIGV4Y2VwdGlvbiBmb3IgbG9jYWxob3N0LlxuICpcbiAqIEBwYXJhbSB7P3N0cmluZ3x1bmRlZmluZWR9IHVybFN0cmluZ1xuICogQHBhcmFtIHshRWxlbWVudHxzdHJpbmd9IGVsZW1lbnRDb250ZXh0IEVsZW1lbnQgd2hlcmUgdGhlIHVybCB3YXMgZm91bmQuXG4gKiBAcGFyYW0ge3N0cmluZz19IHNvdXJjZU5hbWUgVXNlZCBmb3IgZXJyb3IgbWVzc2FnZXMuXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRIdHRwc1VybChcbiAgdXJsU3RyaW5nLCBlbGVtZW50Q29udGV4dCwgc291cmNlTmFtZSA9ICdzb3VyY2UnKSB7XG4gIHVzZXIoKS5hc3NlcnQodXJsU3RyaW5nICE9IG51bGwsICclcyAlcyBtdXN0IGJlIGF2YWlsYWJsZScsXG4gICAgICBlbGVtZW50Q29udGV4dCwgc291cmNlTmFtZSk7XG4gIC8vIChlcndpbm0sICM0NTYwKTogdHlwZSBjYXN0IG5lY2Vzc2FyeSB1bnRpbCAjNDU2MCBpcyBmaXhlZC5cbiAgY29uc3QgdGhlVXJsU3RyaW5nID0gLyoqIEB0eXBlIHtzdHJpbmd9ICovICh1cmxTdHJpbmcpO1xuICB1c2VyKCkuYXNzZXJ0KGlzU2VjdXJlVXJsRGVwcmVjYXRlZCh0aGVVcmxTdHJpbmcpIHx8IC9eKFxcL1xcLykvLnRlc3QodGhlVXJsU3RyaW5nKSxcbiAgICAgICclcyAlcyBtdXN0IHN0YXJ0IHdpdGggJyArXG4gICAgICAnXCJodHRwczovL1wiIG9yIFwiLy9cIiBvciBiZSByZWxhdGl2ZSBhbmQgc2VydmVkIGZyb20gJyArXG4gICAgICAnZWl0aGVyIGh0dHBzIG9yIGZyb20gbG9jYWxob3N0LiBJbnZhbGlkIHZhbHVlOiAlcycsXG4gICAgICBlbGVtZW50Q29udGV4dCwgc291cmNlTmFtZSwgdGhlVXJsU3RyaW5nKTtcbiAgcmV0dXJuIHRoZVVybFN0cmluZztcbn1cblxuLyoqXG4gKiBBc3NlcnRzIHRoYXQgYSBnaXZlbiB1cmwgaXMgYW4gYWJzb2x1dGUgSFRUUCBvciBIVFRQUyBVUkwuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsU3RyaW5nXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRBYnNvbHV0ZUh0dHBPckh0dHBzVXJsKHVybFN0cmluZykge1xuICB1c2VyKCkuYXNzZXJ0KC9eaHR0cHM/XFw6L2kudGVzdCh1cmxTdHJpbmcpLFxuICAgICAgJ1VSTCBtdXN0IHN0YXJ0IHdpdGggXCJodHRwOi8vXCIgb3IgXCJodHRwczovL1wiLiBJbnZhbGlkIHZhbHVlOiAlcycsXG4gICAgICB1cmxTdHJpbmcpO1xuICByZXR1cm4gcGFyc2VVcmxEZXByZWNhdGVkKHVybFN0cmluZykuaHJlZjtcbn1cblxuXG4vKipcbiAqIFBhcnNlcyB0aGUgcXVlcnkgc3RyaW5nIG9mIGFuIFVSTC4gVGhpcyBtZXRob2QgcmV0dXJucyBhIHNpbXBsZSBrZXkvdmFsdWVcbiAqIG1hcC4gSWYgdGhlcmUgYXJlIGR1cGxpY2F0ZSBrZXlzIHRoZSBsYXRlc3QgdmFsdWUgaXMgcmV0dXJuZWQuXG4gKlxuICogVGhpcyBmdW5jdGlvbiBpcyBpbXBsZW1lbnRlZCBpbiBhIHNlcGFyYXRlIGZpbGUgdG8gYXZvaWQgYSBjaXJjdWxhclxuICogZGVwZW5kZW5jeS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcXVlcnlTdHJpbmdcbiAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VRdWVyeVN0cmluZyhxdWVyeVN0cmluZykge1xuICByZXR1cm4gcGFyc2VRdWVyeVN0cmluZ18ocXVlcnlTdHJpbmcpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIFVSTCB3aXRob3V0IGZyYWdtZW50LiBJZiBVUkwgZG9lc24ndCBjb250YWluIGZyYWdtZW50LCB0aGUgc2FtZVxuICogc3RyaW5nIGlzIHJldHVybmVkLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlRnJhZ21lbnQodXJsKSB7XG4gIGNvbnN0IGluZGV4ID0gdXJsLmluZGV4T2YoJyMnKTtcbiAgaWYgKGluZGV4ID09IC0xKSB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxuICByZXR1cm4gdXJsLnN1YnN0cmluZygwLCBpbmRleCk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZnJhZ21lbnQgZnJvbSB0aGUgVVJMLiBJZiB0aGUgVVJMIGRvZXNuJ3QgY29udGFpbiBmcmFnbWVudCxcbiAqIHRoZSBlbXB0eSBzdHJpbmcgaXMgcmV0dXJuZWQuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRGcmFnbWVudCh1cmwpIHtcbiAgY29uc3QgaW5kZXggPSB1cmwuaW5kZXhPZignIycpO1xuICBpZiAoaW5kZXggPT0gLTEpIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbiAgcmV0dXJuIHVybC5zdWJzdHJpbmcoaW5kZXgpO1xufVxuXG4vKipcbiAqIFJldHVybnMgd2hldGhlciB0aGUgVVJMIGhhcyB0aGUgb3JpZ2luIG9mIGEgcHJveHkuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybCBVUkwgb2YgYW4gQU1QIGRvY3VtZW50LlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzUHJveHlPcmlnaW4odXJsKSB7XG4gIGlmICh0eXBlb2YgdXJsID09ICdzdHJpbmcnKSB7XG4gICAgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIH1cbiAgcmV0dXJuIHVybHMuY2RuUHJveHlSZWdleC50ZXN0KHVybC5vcmlnaW4pO1xufVxuXG4vKipcbiAqIEZvciBwcm94eS1vcmlnaW4gVVJMcywgcmV0dXJucyB0aGUgc2VydmluZyB0eXBlLiBPdGhlcndpc2UsIHJldHVybnMgbnVsbC5cbiAqIEUuZy4sICdodHRwczovL2FtcC1jb20uY2RuLmFtcHByb2plY3Qub3JnL2Evcy9hbXAuY29tL2FtcF9kb2N1bWVudC5odG1sJ1xuICogcmV0dXJucyAnYScuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybCBVUkwgb2YgYW4gQU1QIGRvY3VtZW50LlxuICogQHJldHVybiB7P3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFByb3h5U2VydmluZ1R5cGUodXJsKSB7XG4gIGlmICh0eXBlb2YgdXJsID09ICdzdHJpbmcnKSB7XG4gICAgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIH1cbiAgaWYgKCFpc1Byb3h5T3JpZ2luKHVybCkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBwYXRoID0gdXJsLnBhdGhuYW1lLnNwbGl0KCcvJywgMik7XG4gIHJldHVybiBwYXRoWzFdO1xufVxuXG4vKipcbiAqIFJldHVybnMgd2hldGhlciB0aGUgVVJMIG9yaWdpbiBpcyBsb2NhbGhvc3QuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybCBVUkwgb2YgYW4gQU1QIGRvY3VtZW50LlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTG9jYWxob3N0T3JpZ2luKHVybCkge1xuICBpZiAodHlwZW9mIHVybCA9PSAnc3RyaW5nJykge1xuICAgIHVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICB9XG4gIHJldHVybiB1cmxzLmxvY2FsaG9zdFJlZ2V4LnRlc3QodXJsLm9yaWdpbik7XG59XG5cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBVUkwgaGFzIHZhbGlkIHByb3RvY29sLlxuICogRGVlcCBsaW5rIHByb3RvY29sIGlzIHZhbGlkLCBidXQgbm90IGphdmFzY3JpcHQgZXRjLlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmxcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1Byb3RvY29sVmFsaWQodXJsKSB7XG4gIGlmICghdXJsKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgaWYgKHR5cGVvZiB1cmwgPT0gJ3N0cmluZycpIHtcbiAgICB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgfVxuICByZXR1cm4gIUlOVkFMSURfUFJPVE9DT0xTLmluY2x1ZGVzKHVybC5wcm90b2NvbCk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIFVSTCB3aXRob3V0IEFNUCBKUyBwYXJhbWV0ZXJzLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlQW1wSnNQYXJhbXNGcm9tVXJsKHVybCkge1xuICBjb25zdCBwYXJzZWQgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgY29uc3Qgc2VhcmNoID0gcmVtb3ZlQW1wSnNQYXJhbXNGcm9tU2VhcmNoKHBhcnNlZC5zZWFyY2gpO1xuICByZXR1cm4gcGFyc2VkLm9yaWdpbiArIHBhcnNlZC5wYXRobmFtZSArIHNlYXJjaCArIHBhcnNlZC5oYXNoO1xuXG59XG5cbi8qKlxuICogUmV0dXJucyBhIFVSTCB3aXRob3V0IGEgcXVlcnkgc3RyaW5nLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlU2VhcmNoKHVybCkge1xuICBjb25zdCBpbmRleCA9IHVybC5pbmRleE9mKCc/Jyk7XG4gIGlmIChpbmRleCA9PSAtMSkge1xuICAgIHJldHVybiB1cmw7XG4gIH1cbiAgY29uc3QgZnJhZ21lbnQgPSBnZXRGcmFnbWVudCh1cmwpO1xuICByZXR1cm4gdXJsLnN1YnN0cmluZygwLCBpbmRleCkgKyBmcmFnbWVudDtcbn1cblxuLyoqXG4gKiBSZW1vdmVzIHBhcmFtZXRlcnMgdGhhdCBzdGFydCB3aXRoIGFtcCBqcyBwYXJhbWV0ZXIgcGF0dGVybiBhbmQgcmV0dXJucyB0aGVcbiAqIG5ldyBzZWFyY2ggc3RyaW5nLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFNlYXJjaFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiByZW1vdmVBbXBKc1BhcmFtc0Zyb21TZWFyY2godXJsU2VhcmNoKSB7XG4gIGlmICghdXJsU2VhcmNoIHx8IHVybFNlYXJjaCA9PSAnPycpIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbiAgY29uc3Qgc2VhcmNoID0gdXJsU2VhcmNoXG4gICAgICAucmVwbGFjZShBTVBfSlNfUEFSQU1TX1JFR0VYLCAnJylcbiAgICAgIC5yZXBsYWNlKEFNUF9HU0FfUEFSQU1TX1JFR0VYLCAnJylcbiAgICAgIC5yZXBsYWNlKEFNUF9SX1BBUkFNU19SRUdFWCwgJycpXG4gICAgICAucmVwbGFjZShHT09HTEVfRVhQRVJJTUVOVF9QQVJBTVNfUkVHRVgsICcnKVxuICAgICAgLnJlcGxhY2UoL15bPyZdLywgJycpOyAvLyBSZW1vdmVzIGZpcnN0ID8gb3IgJi5cbiAgcmV0dXJuIHNlYXJjaCA/ICc/JyArIHNlYXJjaCA6ICcnO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHNvdXJjZSBVUkwgb2YgYW4gQU1QIGRvY3VtZW50IGZvciBkb2N1bWVudHMgc2VydmVkXG4gKiBvbiBhIHByb3h5IG9yaWdpbiBvciBkaXJlY3RseS5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsIFVSTCBvZiBhbiBBTVAgZG9jdW1lbnQuXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTb3VyY2VVcmwodXJsKSB7XG4gIGlmICh0eXBlb2YgdXJsID09ICdzdHJpbmcnKSB7XG4gICAgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIH1cblxuICAvLyBOb3QgYSBwcm94eSBVUkwgLSByZXR1cm4gdGhlIFVSTCBpdHNlbGYuXG4gIGlmICghaXNQcm94eU9yaWdpbih1cmwpKSB7XG4gICAgcmV0dXJuIHVybC5ocmVmO1xuICB9XG5cbiAgLy8gQSBwcm94eSBVUkwuXG4gIC8vIEV4YW1wbGUgcGF0aCB0aGF0IGlzIGJlaW5nIG1hdGNoZWQgaGVyZS5cbiAgLy8gaHR0cHM6Ly9jZG4uYW1wcHJvamVjdC5vcmcvYy9zL3d3dy5vcmlnaW4uY29tL2Zvby9cbiAgLy8gVGhlIC9zLyBpcyBvcHRpb25hbCBhbmQgc2lnbmFscyBhIHNlY3VyZSBvcmlnaW4uXG4gIGNvbnN0IHBhdGggPSB1cmwucGF0aG5hbWUuc3BsaXQoJy8nKTtcbiAgY29uc3QgcHJlZml4ID0gcGF0aFsxXTtcbiAgdXNlcigpLmFzc2VydChTRVJWSU5HX1RZUEVfUFJFRklYW3ByZWZpeF0sXG4gICAgICAnVW5rbm93biBwYXRoIHByZWZpeCBpbiB1cmwgJXMnLCB1cmwuaHJlZik7XG4gIGNvbnN0IGRvbWFpbk9ySHR0cHNTaWduYWwgPSBwYXRoWzJdO1xuICBjb25zdCBvcmlnaW4gPSBkb21haW5Pckh0dHBzU2lnbmFsID09ICdzJ1xuICAgID8gJ2h0dHBzOi8vJyArIGRlY29kZVVSSUNvbXBvbmVudChwYXRoWzNdKVxuICAgIDogJ2h0dHA6Ly8nICsgZGVjb2RlVVJJQ29tcG9uZW50KGRvbWFpbk9ySHR0cHNTaWduYWwpO1xuICAvLyBTYW5pdHkgdGVzdCB0aGF0IHdoYXQgd2UgZm91bmQgbG9va3MgbGlrZSBhIGRvbWFpbi5cbiAgdXNlcigpLmFzc2VydChvcmlnaW4uaW5kZXhPZignLicpID4gMCwgJ0V4cGVjdGVkIGEgLiBpbiBvcmlnaW4gJXMnLCBvcmlnaW4pO1xuICBwYXRoLnNwbGljZSgxLCBkb21haW5Pckh0dHBzU2lnbmFsID09ICdzJyA/IDMgOiAyKTtcbiAgcmV0dXJuIG9yaWdpbiArIHBhdGguam9pbignLycpICtcbiAgICAgIHJlbW92ZUFtcEpzUGFyYW1zRnJvbVNlYXJjaCh1cmwuc2VhcmNoKSArICh1cmwuaGFzaCB8fCAnJyk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgc291cmNlIG9yaWdpbiBvZiBhbiBBTVAgZG9jdW1lbnQgZm9yIGRvY3VtZW50cyBzZXJ2ZWRcbiAqIG9uIGEgcHJveHkgb3JpZ2luIG9yIGRpcmVjdGx5LlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmwgVVJMIG9mIGFuIEFNUCBkb2N1bWVudC5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHNvdXJjZSBvcmlnaW4gb2YgdGhlIFVSTC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNvdXJjZU9yaWdpbih1cmwpIHtcbiAgcmV0dXJuIHBhcnNlVXJsRGVwcmVjYXRlZChnZXRTb3VyY2VVcmwodXJsKSkub3JpZ2luO1xufVxuXG4vKipcbiAqIFJldHVybnMgYWJzb2x1dGUgVVJMIHJlc29sdmVkIGJhc2VkIG9uIHRoZSByZWxhdGl2ZSBVUkwgYW5kIHRoZSBiYXNlLlxuICogQHBhcmFtIHtzdHJpbmd9IHJlbGF0aXZlVXJsU3RyaW5nXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IGJhc2VVcmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVSZWxhdGl2ZVVybChyZWxhdGl2ZVVybFN0cmluZywgYmFzZVVybCkge1xuICBpZiAodHlwZW9mIGJhc2VVcmwgPT0gJ3N0cmluZycpIHtcbiAgICBiYXNlVXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKGJhc2VVcmwpO1xuICB9XG4gIGlmICh0eXBlb2YgVVJMID09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm4gbmV3IFVSTChyZWxhdGl2ZVVybFN0cmluZywgYmFzZVVybC5ocmVmKS50b1N0cmluZygpO1xuICB9XG4gIHJldHVybiByZXNvbHZlUmVsYXRpdmVVcmxGYWxsYmFja18ocmVsYXRpdmVVcmxTdHJpbmcsIGJhc2VVcmwpO1xufVxuXG4vKipcbiAqIEZhbGxiYWNrIGZvciBVUkwgcmVzb2x2ZXIgd2hlbiBVUkwgY2xhc3MgaXMgbm90IGF2YWlsYWJsZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSByZWxhdGl2ZVVybFN0cmluZ1xuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSBiYXNlVXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKiBAcHJpdmF0ZSBWaXNpYmxlIGZvciB0ZXN0aW5nLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZVJlbGF0aXZlVXJsRmFsbGJhY2tfKHJlbGF0aXZlVXJsU3RyaW5nLCBiYXNlVXJsKSB7XG4gIGlmICh0eXBlb2YgYmFzZVVybCA9PSAnc3RyaW5nJykge1xuICAgIGJhc2VVcmwgPSBwYXJzZVVybERlcHJlY2F0ZWQoYmFzZVVybCk7XG4gIH1cbiAgcmVsYXRpdmVVcmxTdHJpbmcgPSByZWxhdGl2ZVVybFN0cmluZy5yZXBsYWNlKC9cXFxcL2csICcvJyk7XG4gIGNvbnN0IHJlbGF0aXZlVXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHJlbGF0aXZlVXJsU3RyaW5nKTtcblxuICAvLyBBYnNvbHV0ZSBVUkwuXG4gIGlmIChzdGFydHNXaXRoKHJlbGF0aXZlVXJsU3RyaW5nLnRvTG93ZXJDYXNlKCksIHJlbGF0aXZlVXJsLnByb3RvY29sKSkge1xuICAgIHJldHVybiByZWxhdGl2ZVVybC5ocmVmO1xuICB9XG5cbiAgLy8gUHJvdG9jb2wtcmVsYXRpdmUgVVJMLlxuICBpZiAoc3RhcnRzV2l0aChyZWxhdGl2ZVVybFN0cmluZywgJy8vJykpIHtcbiAgICByZXR1cm4gYmFzZVVybC5wcm90b2NvbCArIHJlbGF0aXZlVXJsU3RyaW5nO1xuICB9XG5cbiAgLy8gQWJzb2x1dGUgcGF0aC5cbiAgaWYgKHN0YXJ0c1dpdGgocmVsYXRpdmVVcmxTdHJpbmcsICcvJykpIHtcbiAgICByZXR1cm4gYmFzZVVybC5vcmlnaW4gKyByZWxhdGl2ZVVybFN0cmluZztcbiAgfVxuXG4gIC8vIFJlbGF0aXZlIHBhdGguXG4gIHJldHVybiBiYXNlVXJsLm9yaWdpbiArIGJhc2VVcmwucGF0aG5hbWUucmVwbGFjZSgvXFwvW14vXSokLywgJy8nKVxuICAgICAgKyByZWxhdGl2ZVVybFN0cmluZztcbn1cblxuXG4vKipcbiAqIEFkZCBcIl9fYW1wX3NvdXJjZV9vcmlnaW5cIiBxdWVyeSBwYXJhbWV0ZXIgdG8gdGhlIFVSTC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb3JzVXJsKHdpbiwgdXJsKSB7XG4gIGNoZWNrQ29yc1VybCh1cmwpO1xuICBjb25zdCBzb3VyY2VPcmlnaW4gPSBnZXRTb3VyY2VPcmlnaW4od2luLmxvY2F0aW9uLmhyZWYpO1xuICByZXR1cm4gYWRkUGFyYW1Ub1VybCh1cmwsIFNPVVJDRV9PUklHSU5fUEFSQU0sIHNvdXJjZU9yaWdpbik7XG59XG5cblxuLyoqXG4gKiBDaGVja3MgaWYgdGhlIHVybCBoYXMgX19hbXBfc291cmNlX29yaWdpbiBhbmQgdGhyb3dzIGlmIGl0IGRvZXMuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGVja0NvcnNVcmwodXJsKSB7XG4gIGNvbnN0IHBhcnNlZFVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICBjb25zdCBxdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmcocGFyc2VkVXJsLnNlYXJjaCk7XG4gIHVzZXIoKS5hc3NlcnQoIShTT1VSQ0VfT1JJR0lOX1BBUkFNIGluIHF1ZXJ5KSxcbiAgICAgICdTb3VyY2Ugb3JpZ2luIGlzIG5vdCBhbGxvd2VkIGluICVzJywgdXJsKTtcbn1cblxuLyoqXG4gKiBUcmllcyB0byBkZWNvZGUgYSBVUkkgY29tcG9uZW50LCBmYWxsaW5nIGJhY2sgdG8gb3B0X2ZhbGxiYWNrIChvciBhbiBlbXB0eVxuICogc3RyaW5nKVxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb21wb25lbnRcbiAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X2ZhbGxiYWNrXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnlEZWNvZGVVcmlDb21wb25lbnQoY29tcG9uZW50LCBvcHRfZmFsbGJhY2spIHtcbiAgcmV0dXJuIHRyeURlY29kZVVyaUNvbXBvbmVudF8oY29tcG9uZW50LCBvcHRfZmFsbGJhY2spO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuLyoqXG4gKiBDb21wYXJlcyBpZiB0d28gYXJyYXlzIGNvbnRhaW5zIGV4YWN0bHkgc2FtZSBlbGVtZW50cyBvZiBzYW1lIG51bWJlclxuICogb2Ygc2FtZSBvcmRlci5cbiAqIE5vdGljZSB0aGF0IGl0IGRvZXMgTk9UIGhhbmRsZSBOYU4gY2FzZSBhcyBleHBlY3RlZFxuICpcbiAqIEBwYXJhbSB7IUFycmF5PFQ+fSBhcnIxXG4gKiBAcGFyYW0geyFBcnJheTxUPn0gYXJyMlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcmVFcXVhbE9yZGVyZWQoYXJyMSwgYXJyMikge1xuICBpZiAoYXJyMS5sZW5ndGggIT09IGFycjIubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIxLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGFycjFbaV0gIT09IGFycjJbaV0pIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cblxuLyoqXG4gKiBBIGJpdCBsaWtlIEFycmF5I2ZpbHRlciwgYnV0IHJlbW92ZXMgZWxlbWVudHMgdGhhdCBmaWx0ZXIgZmFsc2UgZnJvbSB0aGVcbiAqIGFycmF5LiBSZXR1cm5zIHRoZSBmaWx0ZXJlZCBpdGVtcy5cbiAqXG4gKiBAcGFyYW0geyFBcnJheTxUPn0gYXJyYXlcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oVCwgbnVtYmVyLCAhQXJyYXk8VD4pOmJvb2xlYW59IGZpbHRlclxuICogQHJldHVybiB7IUFycmF5PFQ+fVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlclNwbGljZShhcnJheSwgZmlsdGVyKSB7XG4gIGNvbnN0IHNwbGljZSA9IFtdO1xuICBsZXQgaW5kZXggPSAwO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgaXRlbSA9IGFycmF5W2ldO1xuICAgIGlmIChmaWx0ZXIoaXRlbSwgaSwgYXJyYXkpKSB7XG4gICAgICBpZiAoaW5kZXggPCBpKSB7XG4gICAgICAgIGFycmF5W2luZGV4XSA9IGl0ZW07XG4gICAgICB9XG4gICAgICBpbmRleCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICBzcGxpY2UucHVzaChpdGVtKTtcbiAgICB9XG4gIH1cblxuICBpZiAoaW5kZXggPCBhcnJheS5sZW5ndGgpIHtcbiAgICBhcnJheS5sZW5ndGggPSBpbmRleDtcbiAgfVxuXG4gIHJldHVybiBzcGxpY2U7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgbWF0Y2hpbmcgdGhlIHByZWRpY2F0ZS5cbiAqIExpa2UgQXJyYXkjZmluZEluZGV4LlxuICpcbiAqIEBwYXJhbSB7IUFycmF5PFQ+fSBhcnJheVxuICogQHBhcmFtIHtmdW5jdGlvbihULCBudW1iZXIsICFBcnJheTxUPik6Ym9vbGVhbn0gcHJlZGljYXRlXG4gKiBAcmV0dXJuIHtudW1iZXJ9XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gZmluZEluZGV4KGFycmF5LCBwcmVkaWNhdGUpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChwcmVkaWNhdGUoYXJyYXlbaV0sIGksIGFycmF5KSkge1xuICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICB9XG4gIHJldHVybiAtMTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyB0aGUgZ2l2ZW4gaXRlcmF0b3IgdG8gYW4gYXJyYXkuXG4gKlxuICogQHBhcmFtIHshSXRlcmF0b3I8VD59IGl0ZXJhdG9yXG4gKiBAcmV0dXJuIHtBcnJheTxUPn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmcm9tSXRlcmF0b3IoaXRlcmF0b3IpIHtcbiAgY29uc3QgYXJyYXkgPSBbXTtcbiAgZm9yIChsZXQgZSA9IGl0ZXJhdG9yLm5leHQoKTsgIWUuZG9uZTsgZSA9IGl0ZXJhdG9yLm5leHQoKSkge1xuICAgIGFycmF5LnB1c2goZS52YWx1ZSk7XG4gIH1cbiAgcmV0dXJuIGFycmF5O1xufVxuXG4vKipcbiAqIEFkZHMgaXRlbSB0byBhcnJheSBpZiBpdCBpcyBub3QgYWxyZWFkeSBwcmVzZW50LlxuICpcbiAqIEBwYXJhbSB7QXJyYXk8VD59IGFycmF5XG4gKiBAcGFyYW0ge1R9IGl0ZW1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwdXNoSWZOb3RFeGlzdChhcnJheSwgaXRlbSkge1xuICBpZiAoYXJyYXkuaW5kZXhPZihpdGVtKSA8IDApIHtcbiAgICBhcnJheS5wdXNoKGl0ZW0pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtkZXZ9IGZyb20gJy4uL2xvZyc7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmNvbnN0IFRBRyA9ICdscnUtY2FjaGUnO1xuXG4vKipcbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBjbGFzcyBMcnVDYWNoZSB7XG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gY2FwYWNpdHlcbiAgICovXG4gIGNvbnN0cnVjdG9yKGNhcGFjaXR5KSB7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7bnVtYmVyfSAqL1xuICAgIHRoaXMuY2FwYWNpdHlfID0gY2FwYWNpdHk7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnNpemVfID0gMDtcblxuICAgIC8qKlxuICAgICAqIEFuIGluY3JlbWVudGluZyBjb3VudGVyIHRvIGRlZmluZSB0aGUgbGFzdCBhY2Nlc3MuXG4gICAgICogQHByaXZhdGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLmFjY2Vzc18gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHshT2JqZWN0PChudW1iZXJ8c3RyaW5nKSwge3BheWxvYWQ6IFQsIGFjY2VzczogbnVtYmVyfT59ICovXG4gICAgdGhpcy5jYWNoZV8gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgd2hldGhlciBrZXkgaXMgY2FjaGVkLlxuICAgKlxuICAgKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IGtleVxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgaGFzKGtleSkge1xuICAgIHJldHVybiAhIXRoaXMuY2FjaGVfW2tleV07XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSBrZXlcbiAgICogQHJldHVybiB7VH0gVGhlIGNhY2hlZCBwYXlsb2FkLlxuICAgKi9cbiAgZ2V0KGtleSkge1xuICAgIGNvbnN0IGNhY2hlYWJsZSA9IHRoaXMuY2FjaGVfW2tleV07XG4gICAgaWYgKGNhY2hlYWJsZSkge1xuICAgICAgY2FjaGVhYmxlLmFjY2VzcyA9ICsrdGhpcy5hY2Nlc3NfO1xuICAgICAgcmV0dXJuIGNhY2hlYWJsZS5wYXlsb2FkO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30ga2V5XG4gICAqIEBwYXJhbSB7VH0gcGF5bG9hZCBUaGUgcGF5bG9hZCB0byBjYWNoZS5cbiAgICovXG4gIHB1dChrZXksIHBheWxvYWQpIHtcbiAgICBpZiAoIXRoaXMuaGFzKGtleSkpIHtcbiAgICAgIHRoaXMuc2l6ZV8rKztcbiAgICB9XG4gICAgdGhpcy5jYWNoZV9ba2V5XSA9IHtwYXlsb2FkLCBhY2Nlc3M6IHRoaXMuYWNjZXNzX307XG4gICAgdGhpcy5ldmljdF8oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFdmljdHMgdGhlIG9sZGVzdCBjYWNoZSBlbnRyeSwgaWYgd2UndmUgZXhjZWVkZWQgY2FwYWNpdHkuXG4gICAqL1xuICBldmljdF8oKSB7XG4gICAgaWYgKHRoaXMuc2l6ZV8gPD0gdGhpcy5jYXBhY2l0eV8pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBkZXYoKS53YXJuKFRBRywgJ1RyaW1taW5nIExSVSBjYWNoZScpO1xuICAgIGNvbnN0IGNhY2hlID0gdGhpcy5jYWNoZV87XG4gICAgbGV0IG9sZGVzdCA9IHRoaXMuYWNjZXNzXyArIDE7XG4gICAgbGV0IG9sZGVzdEtleTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBjYWNoZSkge1xuICAgICAgY29uc3Qge2FjY2Vzc30gPSBjYWNoZVtrZXldO1xuICAgICAgaWYgKGFjY2VzcyA8IG9sZGVzdCkge1xuICAgICAgICBvbGRlc3QgPSBhY2Nlc3M7XG4gICAgICAgIG9sZGVzdEtleSA9IGtleTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAob2xkZXN0S2V5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGRlbGV0ZSBjYWNoZVtvbGRlc3RLZXldO1xuICAgICAgdGhpcy5zaXplXy0tO1xuICAgIH1cbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogTWFwcyBhIHZhbHVlIGluIGEgZmlyc3QgcmFuZ2UgdG8gaXRzIGVxdWl2YWxlbnQgaW4gYSBzZWNvbmQgcmFuZ2VcbiAqIEV4LjogNSBpbiB0aGUgcmFuZ2UgWzAsMTBdIGdpdmVzIDYwIGluIHRoZSByYW5nZVs0MCw4MF1cbiAqXG4gKiBOT1RFOiBsb3dlci91cHBlciBib3VuZHMgb24gdGhlIHNvdXJjZSByYW5nZSBhcmUgZGV0ZWN0ZWQgYXV0b21hdGljYWxseSxcbiAqIGhvd2V2ZXIgdGhlIGJvdW5kcyBvbiB0aGUgdGFyZ2V0IHJhbmdlIGFyZSBub3QgYWx0ZXJlZCAodGh1cyB0aGUgdGFyZ2V0XG4gKiByYW5nZSBjb3VsZCBiZSBkZWNyZWFzaW5nKS5cbiAqIEV4MTogOCBpbiB0aGUgcmFuZ2UgWzAsIDEwXSBnaXZlcyAyIGluIHRoZSByYW5nZSBbMTAsIDBdXG4gKiBFeDI6IGFsc28sIDggaW4gdGhlIHJhbmdlIFsxMCwgMF0gZ2l2ZXMgMiBpbiB0aGUgcmFuZ2UgWzEwLCAwXVxuICpcbiAqIE5PVEU6IElucHV0IHZhbHVlIGlzIGVuZm9yY2VkIHRvIGJlIGJvdW5kZWQgaW5zaWRlIHRoZSBzb3VyY2UgcmFuZ2VcbiAqIEV4MTogLTIgaW4gdGhlIHJhbmdlIFswLCAxMF0gaXMgaW50ZXJwcmV0ZWQgYXMgMCBhbmQgdGh1cyBnaXZlcyA0MCBpbiBbNDAsODBdXG4gKiBFeDI6IDE5IGluIHRoZSByYW5nZSBbMCwgNV0gaXMgaW50ZXJwcmV0ZWQgYXMgNSBhbmQgdGh1cyBnaXZlcyA4MCBpbiBbNDAsODBdXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IHZhbCB0aGUgdmFsdWUgaW4gdGhlIHNvdXJjZSByYW5nZVxuICogQHBhcmFtIHtudW1iZXJ9IG1pbjEgdGhlIGxvd2VyIGJvdW5kIG9mIHRoZSBzb3VyY2UgcmFuZ2VcbiAqIEBwYXJhbSB7bnVtYmVyfSBtYXgxIHRoZSB1cHBlciBib3VuZCBvZiB0aGUgc291cmNlIHJhbmdlXG4gKiBAcGFyYW0ge251bWJlcn0gbWluMiB0aGUgbG93ZXIgYm91bmQgb2YgdGhlIHRhcmdldCByYW5nZVxuICogQHBhcmFtIHtudW1iZXJ9IG1heDIgdGhlIHVwcGVyIGJvdW5kIG9mIHRoZSB0YXJnZXQgcmFuZ2VcbiAqIEByZXR1cm4ge251bWJlcn0gdGhlIGVxdWl2YWxlbnQgdmFsdWUgaW4gdGhlIHRhcmdldCByYW5nZVxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFwUmFuZ2UodmFsLCBtaW4xLCBtYXgxLCBtaW4yLCBtYXgyKSB7XG5cbiAgbGV0IG1heDFCb3VuZCA9IG1heDE7XG4gIGxldCBtaW4xQm91bmQgPSBtaW4xO1xuICBpZiAobWluMSA+IG1heDEpIHtcbiAgICBtYXgxQm91bmQgPSBtaW4xO1xuICAgIG1pbjFCb3VuZCA9IG1heDE7XG4gIH1cblxuICBpZiAodmFsIDwgbWluMUJvdW5kKSB7XG4gICAgdmFsID0gbWluMUJvdW5kO1xuICB9IGVsc2UgaWYgKHZhbCA+IG1heDFCb3VuZCkge1xuICAgIHZhbCA9IG1heDFCb3VuZDtcbiAgfVxuXG4gIHJldHVybiAodmFsIC0gbWluMSkgKiAobWF4MiAtIG1pbjIpIC8gKG1heDEgLSBtaW4xKSArIG1pbjI7XG59XG5cbi8qKlxuICogQ29tcHV0ZXMgdGhlIG1vZHVsdXMgb2YgdmFsdWVzIGBhYCBhbmQgYGJgLlxuICpcbiAqIFRoaXMgaXMgbmVlZGVkIGJlY2F1c2UgdGhlICUgb3BlcmF0b3IgaW4gSmF2YVNjcmlwdCBkb2Vzbid0IGltcGxlbWVudFxuICogbW9kdWx1cyBiZWhhdmlvdXIgYXMgY2FuIGJlIHNlZW4gYnkgdGhlIHNwZWMgaGVyZTpcbiAqIGh0dHA6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy0xMS41LjMuXG4gKiBJdCBpbnN0ZWFkIGlzIHVzZWQgdG8gb2J0YWluIHRoZSByZW1haW5kZXIgb2YgYSBkaXZpc2lvbi5cbiAqIFRoaXMgZnVuY3Rpb24gdXNlcyB0aGUgcmVtYWluZGVyICglKSBvcGVyYXRvciB0byBkZXRlcm1pbmUgdGhlIG1vZHVsdXMuXG4gKiBEZXJpdmVkIGZyb20gaGVyZTpcbiAqIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzI1NzI2NzYwL2phdmFzY3JpcHQtbW9kdWxhci1hcml0aG1ldGljLzQ3MzU0MzU2IzQ3MzU0MzU2XG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IGFcbiAqIEBwYXJhbSB7bnVtYmVyfSBiXG4gKiBAcmV0dXJuIHtudW1iZXJ9IHJldHVybnMgdGhlIG1vZHVsdXMgb2YgdGhlIHR3byBudW1iZXJzLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLm1pbigxMCwgNSk7XG4gKiAvLyA9PiAwXG4gKlxuICogXy5tb2QoLTEsIDUpO1xuICogLy8gPT4gNFxuICovXG5leHBvcnQgZnVuY3Rpb24gbW9kKGEsIGIpIHtcbiAgcmV0dXJuIGEgPiAwICYmIGIgPiAwID8gYSAlIGIgOiAoKGEgJSBiKSArIGIpICUgYjtcbn1cblxuLyoqXG4gKiBSZXN0cmljdHMgYSBudW1iZXIgdG8gYmUgaW4gdGhlIGdpdmVuIG1pbi9tYXggcmFuZ2UuXG4gKlxuICogRXhhbXBsZXM6XG4gKiBjbGFtcCgwLjUsIDAsIDEpIC0+IDAuNVxuICogY2xhbXAoMS41LCAwLCAxKSAtPiAxXG4gKiBjbGFtcCgtMC41LCAwLCAxKSAtPiAwXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IHZhbCB0aGUgdmFsdWUgdG8gY2xhbXAuXG4gKiBAcGFyYW0ge251bWJlcn0gbWluIHRoZSBsb3dlciBib3VuZC5cbiAqIEBwYXJhbSB7bnVtYmVyfSBtYXggdGhlIHVwcGVyIGJvdW5kLlxuICogQHJldHVybiB7bnVtYmVyfSB0aGUgY2xhbXBlZCB2YWx1ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsYW1wKHZhbCwgbWluLCBtYXgpIHtcbiAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KHZhbCwgbWluKSwgbWF4KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2lzT2JqZWN0fSBmcm9tICcuLi90eXBlcyc7XG5cbi8qIEBjb25zdCAqL1xuY29uc3QgaGFzT3duXyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cbi8qKlxuICogUmV0dXJucyBhIG1hcC1saWtlIG9iamVjdC5cbiAqIElmIG9wdF9pbml0aWFsIGlzIHByb3ZpZGVkLCBjb3BpZXMgaXRzIG93biBwcm9wZXJ0aWVzIGludG8gdGhlXG4gKiBuZXdseSBjcmVhdGVkIG9iamVjdC5cbiAqIEBwYXJhbSB7VD19IG9wdF9pbml0aWFsIFRoaXMgc2hvdWxkIHR5cGljYWxseSBiZSBhbiBvYmplY3QgbGl0ZXJhbC5cbiAqIEByZXR1cm4ge1R9XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFwKG9wdF9pbml0aWFsKSB7XG4gIGNvbnN0IG9iaiA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIGlmIChvcHRfaW5pdGlhbCkge1xuICAgIE9iamVjdC5hc3NpZ24ob2JqLCBvcHRfaW5pdGlhbCk7XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cblxuLyoqXG4gKiBSZXR1cm4gYW4gZW1wdHkgSnNvbk9iamVjdCBvciBtYWtlcyB0aGUgcGFzc2VkIGluIG9iamVjdCBsaXRlcmFsXG4gKiBhbiBKc29uT2JqZWN0LlxuICogVGhlIEpzb25PYmplY3QgdHlwZSBpcyBqdXN0IGEgc2ltcGxlIG9iamVjdCB0aGF0IGlzIGF0LWRpY3QuXG4gKiBTZWVcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvY2xvc3VyZS1jb21waWxlci93aWtpL0BzdHJ1Y3QtYW5kLUBkaWN0LUFubm90YXRpb25zXG4gKiBmb3Igd2hhdCBhIGRpY3QgaXMgdHlwZS13aXNlLlxuICogVGhlIGxpbnRlciBlbmZvcmNlcyB0aGF0IHRoZSBhcmd1bWVudCBpcywgaW4gZmFjdCwgYXQtZGljdCBsaWtlLlxuICogQHBhcmFtIHshT2JqZWN0PX0gb3B0X2luaXRpYWxcbiAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGljdChvcHRfaW5pdGlhbCkge1xuICAvLyBXZSBkbyBub3QgY29weS4gVGhlIGxpbnRlciBlbmZvcmNlcyB0aGF0IHRoZSBwYXNzZWQgaW4gb2JqZWN0IGlzIGEgbGl0ZXJhbFxuICAvLyBhbmQgdGh1cyB0aGUgY2FsbGVyIGNhbm5vdCBoYXZlIGEgcmVmZXJlbmNlIHRvIGl0LlxuICByZXR1cm4gLyoqIEB0eXBlIHshSnNvbk9iamVjdH0gKi8gKG9wdF9pbml0aWFsIHx8IHt9KTtcbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgdGhlIGdpdmVuIGtleSBpcyBhIHByb3BlcnR5IGluIHRoZSBtYXAuXG4gKlxuICogQHBhcmFtIHtUfSAgb2JqIGEgbWFwIGxpa2UgcHJvcGVydHkuXG4gKiBAcGFyYW0ge3N0cmluZ30gIGtleVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoYXNPd24ob2JqLCBrZXkpIHtcbiAgcmV0dXJuIGhhc093bl8uY2FsbChvYmosIGtleSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBvYmpba2V5XSBpZmYga2V5IGlzIG9iaidzIG93biBwcm9wZXJ0eSAoaXMgbm90IGluaGVyaXRlZCkuXG4gKiBPdGhlcndpc2UsIHJldHVybnMgdW5kZWZpbmVkLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmpcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXlcbiAqIEByZXR1cm4geyp9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvd25Qcm9wZXJ0eShvYmosIGtleSkge1xuICBpZiAoaGFzT3duKG9iaiwga2V5KSkge1xuICAgIHJldHVybiBvYmpba2V5XTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59XG5cbi8qKlxuICogRGVlcCBtZXJnZXMgc291cmNlIGludG8gdGFyZ2V0LlxuICpcbiAqIEBwYXJhbSB7IU9iamVjdH0gdGFyZ2V0XG4gKiBAcGFyYW0geyFPYmplY3R9IHNvdXJjZVxuICogQHBhcmFtIHtudW1iZXJ9IGRlcHRoIFRoZSBtYXhpbXVtIG1lcmdlIGRlcHRoLiBJZiBleGNlZWRlZCwgT2JqZWN0LmFzc2lnblxuICogICAgICAgICAgICAgICAgICAgICAgIHdpbGwgYmUgdXNlZCBpbnN0ZWFkLlxuICogQHJldHVybiB7IU9iamVjdH1cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBzb3VyY2UgY29udGFpbnMgYSBjaXJjdWxhciByZWZlcmVuY2UuXG4gKiBOb3RlOiBPbmx5IG5lc3RlZCBvYmplY3RzIGFyZSBkZWVwLW1lcmdlZCwgcHJpbWl0aXZlcyBhbmQgYXJyYXlzIGFyZSBub3QuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWVwTWVyZ2UodGFyZ2V0LCBzb3VyY2UsIGRlcHRoID0gMTApIHtcbiAgLy8gS2VlcCB0cmFjayBvZiBzZWVuIG9iamVjdHMgdG8gZGV0ZWN0IHJlY3Vyc2l2ZSByZWZlcmVuY2VzLlxuICBjb25zdCBzZWVuID0gW107XG5cbiAgLyoqIEB0eXBlIHshQXJyYXk8e3Q6ICFPYmplY3QsIHM6ICFPYmplY3QsIGQ6IG51bWJlcn0+fSAqL1xuICBjb25zdCBxdWV1ZSA9IFtdO1xuICBxdWV1ZS5wdXNoKHt0OiB0YXJnZXQsIHM6IHNvdXJjZSwgZDogMH0pO1xuXG4gIC8vIEJGUyB0byBlbnN1cmUgb2JqZWN0cyBkb24ndCBoYXZlIHJlY3Vyc2l2ZSByZWZlcmVuY2VzIGF0IHNoYWxsb3dlciBkZXB0aHMuXG4gIHdoaWxlIChxdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgY29uc3Qge3QsIHMsIGR9ID0gcXVldWUuc2hpZnQoKTtcbiAgICBpZiAoc2Vlbi5pbmNsdWRlcyhzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdTb3VyY2Ugb2JqZWN0IGhhcyBhIGNpcmN1bGFyIHJlZmVyZW5jZS4nKTtcbiAgICB9XG4gICAgc2Vlbi5wdXNoKHMpO1xuICAgIGlmICh0ID09PSBzKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKGQgPiBkZXB0aCkge1xuICAgICAgT2JqZWN0LmFzc2lnbih0LCBzKTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBPYmplY3Qua2V5cyhzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICBjb25zdCBuZXdWYWx1ZSA9IHNba2V5XTtcbiAgICAgIC8vIFBlcmZvcm0gYSBkZWVwIG1lcmdlIElGRiBib3RoIHRhcmdldCBhbmQgc291cmNlIGhhdmUgdGhlIHNhbWUga2V5XG4gICAgICAvLyB3aG9zZSBjb3JyZXNwb25kaW5nIHZhbHVlcyBhcmUgb2JqZWN0cy5cbiAgICAgIGlmIChoYXNPd24odCwga2V5KSkge1xuICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IHRba2V5XTtcbiAgICAgICAgaWYgKGlzT2JqZWN0KG5ld1ZhbHVlKSAmJiBpc09iamVjdChvbGRWYWx1ZSkpIHtcbiAgICAgICAgICBxdWV1ZS5wdXNoKHt0OiBvbGRWYWx1ZSwgczogbmV3VmFsdWUsIGQ6IGQgKyAxfSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0W2tleV0gPSBuZXdWYWx1ZTtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gdGFyZ2V0O1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IU9iamVjdH0gbyBBbiBvYmplY3QgdG8gcmVtb3ZlIHByb3BlcnRpZXMgZnJvbVxuICogQHBhcmFtIHshQXJyYXk8c3RyaW5nPn0gcHJvcHMgQSBsaXN0IG9mIHByb3BlcnRpZXMgdG8gcmVtb3ZlIGZyb20gdGhlIE9iamVjdFxuICogQHJldHVybiB7IU9iamVjdH0gQW4gb2JqZWN0IHdpdGggdGhlIGdpdmVuIHByb3BlcnRpZXMgcmVtb3ZlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gb21pdChvLCBwcm9wcykge1xuICByZXR1cm4gT2JqZWN0LmtleXMobykucmVkdWNlKChhY2MsIGtleSkgPT4ge1xuICAgIGlmICghcHJvcHMuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgYWNjW2tleV0gPSBvW2tleV07XG4gICAgfVxuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIFJldHVybnMgYSBEZWZlcnJlZCBzdHJ1Y3QsIHdoaWNoIGhvbGRzIGEgcGVuZGluZyBwcm9taXNlIGFuZCBpdHMgYXNzb2NpYXRlZFxuICogcmVzb2x2ZSBhbmQgcmVqZWN0IGZ1bmN0aW9ucy5cbiAqXG4gKiBUaGlzIGlzIHByZWZlcnJlZCBpbnN0ZWFkIG9mIGNyZWF0aW5nIGEgUHJvbWlzZSBpbnN0YW5jZSB0byBleHRyYWN0IHRoZVxuICogcmVzb2x2ZS9yZWplY3QgZnVuY3Rpb25zIHlvdXJzZWxmOlxuICpcbiAqIGBgYFxuICogLy8gQXZvaWQgZG9pbmdcbiAqIGxldCByZXNvbHZlO1xuICogY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKHJlcyA9PiB7XG4gKiAgIHJlc29sdmUgPSByZXM7XG4gKiB9KTtcbiAqXG4gKiAvLyBHb29kXG4gKiBjb25zdCBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICogY29uc3QgeyBwcm9taXNlLCByZXNvbHZlIH0gPSBkZWZlcnJlZDtcbiAqIGBgYFxuICpcbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBjbGFzcyBEZWZlcnJlZCB7XG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIERlZmVycmVkLlxuICAgKi9cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgbGV0IHJlc29sdmUsIHJlamVjdDtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdCB7IVByb21pc2U8VD59XG4gICAgICovXG4gICAgdGhpcy5wcm9taXNlID0gbmV3IC8qT0sqL1Byb21pc2UoKHJlcywgcmVqKSA9PiB7XG4gICAgICByZXNvbHZlID0gcmVzO1xuICAgICAgcmVqZWN0ID0gcmVqO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQGNvbnN0IHtmdW5jdGlvbihUPSl9XG4gICAgICovXG4gICAgdGhpcy5yZXNvbHZlID0gcmVzb2x2ZTtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdCB7ZnVuY3Rpb24oKj0pfVxuICAgICAqL1xuICAgIHRoaXMucmVqZWN0ID0gcmVqZWN0O1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIHByb21pc2UgcmVzb2x2ZWQgdG8gdGhlIHJldHVybiB2YWx1ZSBvZiBmbi5cbiAqIElmIGZuIHN5bmMgdGhyb3dzLCBpdCB3aWxsIGNhdXNlIHRoZSBwcm9taXNlIHRvIHJlamVjdC5cbiAqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCk6VH0gZm5cbiAqIEByZXR1cm4geyFQcm9taXNlPFQ+fVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyeVJlc29sdmUoZm4pIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgIHJlc29sdmUoZm4oKSk7XG4gIH0pO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIHdoaWNoIHJlc29sdmVzIGlmIGEgdGhyZXNob2xkIGFtb3VudCBvZiB0aGUgZ2l2ZW4gcHJvbWlzZXNcbiAqIHJlc29sdmUsIGFuZCByZWplY3RzIG90aGVyd2lzZS5cbiAqIEBwYXJhbSB7IUFycmF5PCFQcm9taXNlPn0gcHJvbWlzZXMgVGhlIGFycmF5IG9mIHByb21pc2VzIHRvIHRlc3QuXG4gKiBAcGFyYW0ge251bWJlcn0gY291bnQgVGhlIG51bWJlciBvZiBwcm9taXNlcyB0aGF0IG11c3QgcmVzb2x2ZSBmb3IgdGhlXG4gKiAgICAgcmV0dXJuZWQgcHJvbWlzZSB0byByZXNvbHZlLlxuICogQHJldHVybiB7IVByb21pc2V9IEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIGlmIGFueSBvZiB0aGUgZ2l2ZW4gcHJvbWlzZXNcbiAqICAgICByZXNvbHZlLCBhbmQgd2hpY2ggcmVqZWN0cyBvdGhlcndpc2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzb21lKHByb21pc2VzLCBjb3VudCA9IDEpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb3VudCA9IE1hdGgubWF4KGNvdW50LCAwKTtcbiAgICBjb25zdCBleHRyYSA9IHByb21pc2VzLmxlbmd0aCAtIGNvdW50O1xuICAgIGlmIChleHRyYSA8IDApIHtcbiAgICAgIHJlamVjdChuZXcgRXJyb3IoJ25vdCBlbm91Z2ggcHJvbWlzZXMgdG8gcmVzb2x2ZScpKTtcbiAgICB9XG4gICAgaWYgKHByb21pc2VzLmxlbmd0aCA9PSAwKSB7XG4gICAgICByZXNvbHZlKFtdKTtcbiAgICB9XG4gICAgY29uc3QgdmFsdWVzID0gW107XG4gICAgY29uc3QgcmVhc29ucyA9IFtdO1xuXG4gICAgY29uc3Qgb25GdWxmaWxsZWQgPSB2YWx1ZSA9PiB7XG4gICAgICBpZiAodmFsdWVzLmxlbmd0aCA8IGNvdW50KSB7XG4gICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIGlmICh2YWx1ZXMubGVuZ3RoID09IGNvdW50KSB7XG4gICAgICAgIHJlc29sdmUodmFsdWVzKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IG9uUmVqZWN0ZWQgPSByZWFzb24gPT4ge1xuICAgICAgaWYgKHJlYXNvbnMubGVuZ3RoIDw9IGV4dHJhKSB7XG4gICAgICAgIHJlYXNvbnMucHVzaChyZWFzb24pO1xuICAgICAgfVxuICAgICAgaWYgKHJlYXNvbnMubGVuZ3RoID4gZXh0cmEpIHtcbiAgICAgICAgcmVqZWN0KHJlYXNvbnMpO1xuICAgICAgfVxuICAgIH07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9taXNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgUHJvbWlzZS5yZXNvbHZlKHByb21pc2VzW2ldKS50aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIFJlc29sdmVzIHdpdGggdGhlIHJlc3VsdCBvZiB0aGUgbGFzdCBwcm9taXNlIGFkZGVkLlxuICogQGltcGxlbWVudHMge0lUaGVuYWJsZX1cbiAqL1xuZXhwb3J0IGNsYXNzIExhc3RBZGRlZFJlc29sdmVyIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IUFycmF5PCFQcm9taXNlPj19IG9wdF9wcm9taXNlc1xuICAgKi9cbiAgY29uc3RydWN0b3Iob3B0X3Byb21pc2VzKSB7XG4gICAgbGV0IHJlc29sdmVfLCByZWplY3RfO1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFQcm9taXNlfSAqL1xuICAgIHRoaXMucHJvbWlzZV8gPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZXNvbHZlXyA9IHJlc29sdmU7XG4gICAgICByZWplY3RfID0gcmVqZWN0O1xuICAgIH0pO1xuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5yZXNvbHZlXyA9IHJlc29sdmVfO1xuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5yZWplY3RfID0gcmVqZWN0XztcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMuY291bnRfID0gMDtcblxuICAgIGlmIChvcHRfcHJvbWlzZXMpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb3B0X3Byb21pc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuYWRkKG9wdF9wcm9taXNlc1tpXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBhIHByb21pc2UgdG8gcG9zc2libHkgYmUgcmVzb2x2ZWQuXG4gICAqIEBwYXJhbSB7IVByb21pc2V9IHByb21pc2VcbiAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAqL1xuICBhZGQocHJvbWlzZSkge1xuICAgIGNvbnN0IGNvdW50QXRBZGQgPSArK3RoaXMuY291bnRfO1xuICAgIFByb21pc2UucmVzb2x2ZShwcm9taXNlKS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICBpZiAodGhpcy5jb3VudF8gPT09IGNvdW50QXRBZGQpIHtcbiAgICAgICAgdGhpcy5yZXNvbHZlXyhyZXN1bHQpO1xuICAgICAgfVxuICAgIH0sIGVycm9yID0+IHtcbiAgICAgIC8vIERvbid0IGZvbGxvdyBiZWhhdmlvciBvZiBQcm9taXNlLmFsbCBhbmQgUHJvbWlzZS5yYWNlIGVycm9yIHNvIHRoYXRcbiAgICAgIC8vIHRoaXMgd2lsbCBvbmx5IHJlamVjdCB3aGVuIG1vc3QgcmVjZW50bHkgYWRkZWQgcHJvbWlzZSBmYWlscy5cbiAgICAgIGlmICh0aGlzLmNvdW50XyA9PT0gY291bnRBdEFkZCkge1xuICAgICAgICB0aGlzLnJlamVjdF8oZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLnByb21pc2VfO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICB0aGVuKG9wdF9yZXNvbHZlLCBvcHRfcmVqZWN0KSB7XG4gICAgcmV0dXJuIHRoaXMucHJvbWlzZV8udGhlbihvcHRfcmVzb2x2ZSwgb3B0X3JlamVjdCk7XG4gIH1cbn1cbiIsIi8qISBodHRwczovL210aHMuYmUvY3NzZXNjYXBlIHYxLjUuMSBieSBAbWF0aGlhcyB8IE1JVCBsaWNlbnNlICovXG5cblxuLyoqXG4gKiBUaGlzIHJlZ2V4IGNvbnNpc3RzIG9mIDQgbWF0Y2hpbmcgY2FwdHVyZSBncm91cHMgYW5kIG9uZSAobm9uLW1hdGNoaW5nKSBmYWxsYmFjazpcbiAqXG4gKiAtIChcXDApLCBjYXRjaCB0aGUgbnVsbCB0ZXJtaW5hdG9yIGNoYXJhY3RlciBzbyBpdCBtYXkgYmUgcmVwbGFjZWQgYnkgVVRGXG4gKiAgIFJlcGxhY2VtZW50IENoYXJcbiAqIC0gXigtKSQsIGNhdGNoIGEgc29saXRhcnkgZGFzaCBjaGFyLCBzbyB0aGF0IGl0IG1heSBiZSBiYWNrc2xhc2ggZXNjYXBlZC5cbiAqICAgVGhpcyBpcyBhIHNlcGFyYXRlIGNhcHR1cmUgZ3JvdXAgc28gdGhhdCB0aGUgbGVnYWwtY2hhcnMgKGdyb3VwIDQpIGRvZXNuJ3RcbiAqICAgY2FwdHVyZSBpdCBmaXJzdCwgc2luY2UgdGhhdCBncm91cCBkb2Vzbid0IG5lZWQgdG8gZXNjYXBlIGl0cyBkYXNoLlxuICogLSAoW1xceDAxLVxceDFmXFx4N2ZdfF4tP1swLTldKSwgY2F0Y2ggYSBVVEYgY29udHJvbCBjaGFyLCBvciBhbnkgbGVhZGluZ1xuICogICBudW1iZXIgKHdpdGggYW4gb3B0aW9uYWwgbGVhZGluZyBkYXNoKS4gVGhlIGNvbnRyb2wgb3IgdGhlIG51bWJlciAoYnV0IG5vdFxuICogICB0aGUgbGVhZGluZyBkYXNoKSBtdXN0IGJlIGhleC1lc2NhcGVkLC5cbiAqIC0gKFtcXHg4MC1cXHVmZmZmMC05YS16QS1aXy1dKyksIGNhdGNoIGxlZ2FsLWNoYXJzLCB3aXRoIHRoZSBleGNlcHRpb24gb2YgYVxuICogICBzb2xpdGFyeSBkYXNoLCB3aGljaCB3aWxsIGFscmVhZHkgaGF2ZSBtYXRjaGVkIGluIGdyb3VwIDEuXG4gKiAtIFteXSwgZmluYWxseSwgYSBjYXRjaC1hbGwgdGhhdCBhbGxvd3MgdXMgdG8gYmFja3NsYXNoIGVzY2FwZSB0aGUgY2hhci5cbiAqXG4gKiBUb2dldGhlciwgdGhpcyBtYXRjaGVzIGV2ZXJ5dGhpbmcgbmVjZXNzYXJ5IGZvciBDU1MuZXNjYXBlLlxuICovXG52YXIgcmVnZXggPSAvKFxcMCl8XigtKSR8KFtcXHgwMS1cXHgxZlxceDdmXXxeLT9bMC05XSl8KFtcXHg4MC1cXHVmZmZmMC05YS16QS1aXy1dKyl8W15dL2c7XG5cbmZ1bmN0aW9uIGVzY2FwZXIobWF0Y2gsIG5pbCwgZGFzaCwgaGV4RXNjYXBlLCBjaGFycykge1xuICAvLyBDaGFycyBpcyB0aGUgbGVnYWwtY2hhcnMgKGdyb3VwIDQpIGNhcHR1cmVcbiAgaWYgKGNoYXJzKSB7XG4gICAgcmV0dXJuIGNoYXJzO1xuICB9XG4gIC8vIE5pbCBpcyB0aGUgbnVsbCB0ZXJtaW5hdG9yIChncm91cCAxKSBjYXB0dXJlXG4gIGlmIChuaWwpIHtcbiAgICByZXR1cm4gJ1xcdUZGRkQnO1xuICB9XG4gIC8vIEJvdGggVVRGIGNvbnRyb2wgY2hhcnMsIGFuZCBsZWFkaW5nIG51bWJlcnMgKHdpdGggb3B0aW9uYWwgbGVhZGluZyBkYXNoKVxuICAvLyAoZ3JvdXAgMykgbXVzdCBiZSBiYWNrc2xhc2ggZXNjYXBlZCB3aXRoIGEgdHJhaWxpbmcgc3BhY2UuICBGdW5uaWx5LCB0aGVcbiAgLy8gbGVhZGluZyBkYXNoIG11c3Qgbm90IGJlIGVzY2FwZWQsIGJ1dCB0aGUgbnVtYmVyLiA6c2hydWc6XG4gIGlmIChoZXhFc2NhcGUpIHtcbiAgICByZXR1cm4gbWF0Y2guc2xpY2UoMCwgLTEpICsgJ1xcXFwnICsgbWF0Y2guc2xpY2UoLTEpLmNoYXJDb2RlQXQoMCkudG9TdHJpbmcoMTYpICsgJyAnXG4gIH1cbiAgLy8gRmluYWxseSwgdGhlIHNvbGl0YXJ5IGRhc2ggYW5kIHRoZSBjYXRjaC1hbGwgY2hhcnMgcmVxdWlyZSBiYWNrc2xhc2hcbiAgLy8gZXNjYXBpbmcuXG4gIHJldHVybiAnXFxcXCcgKyBtYXRjaDtcbn1cblxuLyoqXG4gKiBodHRwczovL2RyYWZ0cy5jc3N3Zy5vcmcvY3Nzb20vI3NlcmlhbGl6ZS1hbi1pZGVudGlmaWVyXG4gKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNzc0VzY2FwZSh2YWx1ZSkge1xuICByZXR1cm4gU3RyaW5nKHZhbHVlKS5yZXBsYWNlKHJlZ2V4LCBlc2NhcGVyKTtcbn1cbiJdfQ=="}