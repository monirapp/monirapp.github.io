{"version":3,"sources":["node_modules/browser-pack/_prelude.js","ads/_a4a-config.js","ads/_config.js","ads/google/a4a/experiment-utils.js","ads/google/a4a/line-delimited-response-handler.js","ads/google/a4a/traffic-experiments.js","ads/google/a4a/url-builder.js","ads/google/a4a/utils.js","ads/google/utils.js","extensions/amp-a4a/0.1/a4a-variable-source.js","extensions/amp-a4a/0.1/amp-a4a.js","extensions/amp-a4a/0.1/callout-vendors.js","extensions/amp-a4a/0.1/real-time-config-manager.js","extensions/amp-a4a/0.1/refresh-intersection-observer-wrapper.js","extensions/amp-a4a/0.1/refresh-manager.js","extensions/amp-a4a/0.1/signature-verifier.js","extensions/amp-ad-network-adsense-impl/0.1/adsense-a4a-config.js","extensions/amp-ad-network-cloudflare-impl/0.1/cloudflare-a4a-config.js","extensions/amp-ad-network-doubleclick-impl/0.1/amp-ad-network-doubleclick-impl.js","extensions/amp-ad-network-doubleclick-impl/0.1/safeframe-host.js","extensions/amp-ad-network-doubleclick-impl/0.1/sra-utils.js","extensions/amp-ad-network-gmossp-impl/0.1/gmossp-a4a-config.js","extensions/amp-ad-network-triplelift-impl/0.1/triplelift-a4a-config.js","extensions/amp-ad/0.1/concurrent-load.js","node_modules/document-register-element/build/document-register-element.patched.js","node_modules/promise-pjs/promise.js","src/3p-frame-messaging.js","src/3p-frame.js","src/ad-cid.js","src/ad-helper.js","src/amp-events.js","src/analytics.js","src/common-signals.js","src/config.js","src/consent-state.js","src/consent.js","src/cookies.js","src/document-ready.js","src/dom.js","src/element-service.js","src/error.js","src/event-helper-listen.js","src/event-helper.js","src/experiments.js","src/exponential-backoff.js","src/extension-analytics.js","src/friendly-iframe-embed.js","src/iframe-attributes.js","src/iframe-helper.js","src/impression.js","src/intersection-observer-polyfill.js","src/json.js","src/layout-rect.js","src/layout.js","src/log.js","src/mode-object.js","src/mode.js","src/observable.js","src/polyfills.js","src/polyfills/array-includes.js","src/polyfills/custom-elements.js","src/polyfills/document-contains.js","src/polyfills/domtokenlist-toggle.js","src/polyfills/math-sign.js","src/polyfills/object-assign.js","src/polyfills/promise.js","src/render-delaying-services.js","src/service.js","src/service/navigation.js","src/service/url-expander/expander.js","src/service/url-replacements-impl.js","src/service/variable-source.js","src/services.js","src/static-template.js","src/string.js","src/style-installer.js","src/style.js","src/types.js","src/url-parse-query-string.js","src/url-try-decode-uri-component.js","src/url.js","src/utils/array.js","src/utils/base64.js","src/utils/bytes.js","src/utils/dom-fingerprint.js","src/utils/lru-cache.js","src/utils/object.js","src/utils/promise.js","src/utils/rate-limit.js","src/utils/signals.js","src/window-interface.js","third_party/css-escape/css-escape.js"],"names":[],"mappings":"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ACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACn6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;QCzbgB,M,GAAA,M;QAeA,gB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","file":"amp-ad-network-doubleclick-impl-0.1.max.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  adsenseIsA4AEnabled,\n} from '../extensions/amp-ad-network-adsense-impl/0.1/adsense-a4a-config';\nimport {\n  cloudflareIsA4AEnabled,\n} from\n  '../extensions/amp-ad-network-cloudflare-impl/0.1/cloudflare-a4a-config';\nimport {\n  gmosspIsA4AEnabled,\n} from\n  '../extensions/amp-ad-network-gmossp-impl/0.1/gmossp-a4a-config';\nimport {map} from '../src/utils/object';\nimport {\n  tripleliftIsA4AEnabled,\n} from\n  '../extensions/amp-ad-network-triplelift-impl/0.1/triplelift-a4a-config';\n\n/**\n * Registry for A4A (AMP Ads for AMPHTML pages) \"is supported\" predicates.\n * If an ad network, {@code ${NETWORK}}, is registered in this object, then the\n * {@code <amp-ad type=\"${NETWORK}\">} implementation will look up its predicate\n * here. If there is a predicate and it and returns {@code true}, then\n * {@code amp-ad} will attempt to render the ad via the A4A pathway (fetch\n * ad creative via early XHR CORS request; verify that it is validated AMP;\n * and then render directly in the host page by splicing into the host DOM).\n * Otherwise, it will attempt to render the ad via the existing \"3p iframe\"\n * pathway (delay load into a cross-domain iframe).\n *\n * @type {!Object<string, function(!Window, !Element): boolean>}\n */\nlet a4aRegistry;\n\n/**\n * Returns the a4a registry map\n * @return {Object}\n */\nexport function getA4ARegistry() {\n  if (!a4aRegistry) {\n    a4aRegistry = map({\n      'adsense': adsenseIsA4AEnabled,\n      'adzerk': () => true,\n      'doubleclick': () => true,\n      'triplelift': tripleliftIsA4AEnabled,\n      'cloudflare': cloudflareIsA4AEnabled,\n      'gmossp': gmosspIsA4AEnabled,\n      'fake': () => true,\n      // TODO: Add new ad network implementation \"is enabled\" functions here.\n      // Note: if you add a function here that requires a new \"import\", above,\n      // you'll probably also need to add a whitelist exception to\n      // build-system/dep-check-config.js in the \"filesMatching: 'ads/**/*.js'\n      // rule.\n    });\n  }\n\n  return a4aRegistry;\n}\n\n/**\n * An object mapping signing server names to their corresponding URLs.\n * @type {!Object<string, string>}\n */\nexport const signingServerURLs = {\n  'google': 'https://cdn.ampproject.org/amp-ad-verifying-keyset.json',\n  'google-dev': 'https://cdn.ampproject.org/amp-ad-verifying-keyset-dev.json',\n  'cloudflare': 'https://amp.cloudflare.com/amp-ad-verifying-keyset.json',\n  'cloudflare-dev': 'https://amp.cloudflare.com/amp-ad-verifying-keyset-dev.json',\n};\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @typedef {{\n *   prefetch: (string|undefined),\n *   preconnect: (string|undefined),\n *   renderStartImplemented: (boolean|undefined),\n *   clientIdScope: (string|undefined),\n *   clientIdCookieName: (string|undefined),\n *   consentHandlingOverride: (boolean|undefined),\n *   remoteHTMLDisabled: (boolean|undefined),\n *   fullWidthHeightRatio: (number|undefined),\n * }}\n */\nlet AdNetworkConfigDef;\n\n/**\n * The config of each ad network.\n * Please keep the list alphabetic order.\n *\n * yourNetworkName: {  // This is the \"type\" attribute of <amp-ad>\n *\n *   // List of URLs for prefetch\n *   prefetch: string|array\n *\n *   // List of hosts for preconnect\n *   preconnect: string|array\n *\n *   // The scope used to provide CIDs to ads\n *   clientIdScope: string\n *\n *   // The cookie name to store the CID. In absence, `clientIdScope` is used.\n *   clientIdCookieName: string\n *\n *   // If the ad network is willing to override the consent handling, which\n *   // by default is blocking ad load until the consent is accepted.\n *   consentHandlingOverride: boolean\n *\n *   // Whether render-start API has been implemented\n *   // We highly recommend all networks to implement the API,\n *   // see details in the README.md\n *   renderStartImplemented: boolean\n *\n *   // The width / height ratio for full width ad units.\n *   // If absent, it means the network does not support full width ad units.\n *   // Example value: 1.2\n *   fullWidthHeightRatio: number\n * }\n *\n * @const {!Object<string, !AdNetworkConfigDef>}}\n */\nexport const adConfig = {\n  '_ping_': {\n    renderStartImplemented: true,\n    clientIdScope: '_PING_',\n    consentHandlingOverride: true,\n  },\n\n  '24smi': {\n    prefetch: 'https://jsn.24smi.net/smi.js',\n    preconnect: 'https://data.24smi.net',\n  },\n\n  'a8': {\n    prefetch: 'https://statics.a8.net/amp/ad.js',\n    renderStartImplemented: true,\n  },\n\n  'a9': {\n    prefetch: 'https://c.amazon-adsystem.com/aax2/assoc.js',\n  },\n\n  'accesstrade': {\n    prefetch: 'https://h.accesstrade.net/js/amp/amp.js',\n  },\n\n  'adagio': {\n    prefetch: 'https://js-ssl.neodatagroup.com/adagio_amp.js',\n    preconnect: [\n      'https://ad-aws-it.neodatagroup.com',\n      'https://tracker.neodatagroup.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'adblade': {\n    prefetch: 'https://web.adblade.com/js/ads/async/show.js',\n    preconnect: [\n      'https://staticd.cdn.adblade.com',\n      'https://static.adblade.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'adbutler': {\n    prefetch: 'https://servedbyadbutler.com/app.js',\n  },\n\n  'adform': {},\n\n  'adfox': {\n    prefetch: 'https://yastatic.net/pcode/adfox/loader.js',\n    renderStartImplemented: true,\n  },\n\n  'adgeneration': {\n    prefetch: 'https://i.socdm.com/sdk/js/adg-script-loader.js',\n  },\n\n  'adhese': {\n    renderStartImplemented: true,\n  },\n\n  'adincube': {\n    renderStartImplemented: true,\n  },\n\n  'adition': {},\n\n  'adman': {},\n\n  'admanmedia': {\n    renderStartImplemented: true,\n  },\n\n  'admixer': {\n    renderStartImplemented: true,\n    preconnect: [\n      'https://inv-nets.admixer.net',\n      'https://cdn.admixer.net',\n    ],\n  },\n\n  'adocean': {},\n\n  'adpicker': {\n    renderStartImplemented: true,\n  },\n\n  'adplugg': {\n    prefetch: 'https://www.adplugg.com/serve/js/ad.js',\n    renderStartImplemented: true,\n  },\n\n  'adreactor': {},\n\n  'adsense': {\n    prefetch: 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js',\n    preconnect: 'https://googleads.g.doubleclick.net',\n    clientIdScope: 'AMP_ECID_GOOGLE',\n    clientIdCookieName: '_ga',\n    remoteHTMLDisabled: true,\n    masterFrameAccessibleType: 'google_network',\n    fullWidthHeightRatio: 1.2,\n    consentHandlingOverride: true,\n  },\n\n  'adsnative': {\n    prefetch: 'https://static.adsnative.com/static/js/render.v1.js',\n    preconnect: 'https://api.adsnative.com',\n  },\n\n  'adspeed': {\n    preconnect: 'https://g.adspeed.net',\n    renderStartImplemented: true,\n  },\n\n  'adspirit': {},\n\n  'adstir': {\n    prefetch: 'https://js.ad-stir.com/js/adstir_async.js',\n    preconnect: 'https://ad.ad-stir.com',\n  },\n\n  'adtech': {\n    prefetch: 'https://s.aolcdn.com/os/ads/adsWrapper3.js',\n    preconnect: [\n      'https://mads.at.atwola.com',\n      'https://aka-cdn.adtechus.com',\n    ],\n  },\n\n  'adthrive': {\n    prefetch: [\n      'https://www.googletagservices.com/tag/js/gpt.js',\n    ],\n    preconnect: [\n      'https://partner.googleadservices.com',\n      'https://securepubads.g.doubleclick.net',\n      'https://tpc.googlesyndication.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'adunity': {\n    preconnect: [\n      'https://content.adunity.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'aduptech': {\n    prefetch: 'https://s.d.adup-tech.com/jsapi',\n    preconnect: [\n      'https://d.adup-tech.com',\n      'https://m.adup-tech.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'adventive': {\n    preconnect: [\n      'https://ads.adventive.com',\n      'https://amp.adventivedev.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'adverline': {\n    prefetch: 'https://ads.adverline.com/richmedias/amp.js',\n    preconnect: [\n      'https://adnext.fr',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'adverticum': {},\n\n  'advertserve': {\n    renderStartImplemented: true,\n  },\n\n  'adzerk': {},\n\n  'affiliateb': {\n    prefetch: 'https://track.affiliate-b.com/amp/a.js',\n    renderStartImplemented: true,\n  },\n\n  'aja': {\n    renderStartImplemented: true,\n    prefetch: 'https://cdn.as.amanad.adtdp.com/sdk/asot-v2.js',\n  },\n\n  'appvador': {\n    prefetch: [\n      'https://cdn.apvdr.com/js/VastAdUnit.min.js',\n      'https://cdn.apvdr.com/js/VideoAd.min.js',\n      'https://cdn.apvdr.com/js/VideoAd3PAS.min.js',\n      'https://cdn.apvdr.com/js/VideoAdAutoPlay.min.js',\n      'https://cdn.apvdr.com/js/VideoAdNative.min.js',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'amoad': {\n    prefetch: [\n      'https://j.amoad.com/js/a.js',\n      'https://j.amoad.com/js/n.js',\n    ],\n    preconnect: [\n      'https://d.amoad.com',\n      'https://i.amoad.com',\n      'https://m.amoad.com',\n      'https://v.amoad.com',\n    ],\n  },\n\n  'appnexus': {\n    prefetch: 'https://acdn.adnxs.com/ast/ast.js',\n    preconnect: 'https://ib.adnxs.com',\n    renderStartImplemented: true,\n  },\n\n  'atomx': {\n    prefetch: 'https://s.ato.mx/p.js',\n  },\n\n  'beopinion': {\n    prefetch: 'https://widget.beopinion.com/sdk.js',\n    preconnect: [\n      'https://t.beopinion.com',\n      'https://s.beopinion.com',\n      'https://data.beopinion.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'bidtellect': {},\n\n  'brainy': {},\n\n  'bringhub': {\n    renderStartImplemented: true,\n    preconnect: [\n      'https://static.bh-cdn.com',\n      'https://core-api.bringhub.io',\n    ],\n  },\n\n  'broadstreetads': {\n    prefetch: 'https://cdn.broadstreetads.com/init-2.min.js',\n  },\n\n  'caajainfeed': {\n    prefetch: [\n      'https://cdn.amanad.adtdp.com/sdk/ajaamp.js',\n    ],\n    preconnect: [\n      'https://ad.amanad.adtdp.com',\n    ],\n  },\n\n  'capirs': {\n    renderStartImplemented: true,\n  },\n\n  'caprofitx': {\n    prefetch: [\n      'https://cdn.caprofitx.com/pfx.min.js',\n      'https://cdn.caprofitx.com/tags/amp/profitx_amp.js',\n    ],\n    preconnect: 'https://ad.caprofitx.adtdp.com',\n  },\n\n  'cedato': {\n    renderStartImplemented: true,\n  },\n\n  'chargeads': {},\n\n  'colombia': {\n    prefetch: 'https://static.clmbtech.com/ad/commons/js/colombia-amp.js',\n  },\n\n  'connatix': {\n    renderStartImplemented: true,\n  },\n\n  'contentad': {},\n\n\n  'criteo': {\n    prefetch: 'https://static.criteo.net/js/ld/publishertag.js',\n    preconnect: 'https://cas.criteo.com',\n  },\n\n  'csa': {\n    prefetch: 'https://www.google.com/adsense/search/ads.js',\n  },\n\n  'dable': {\n    preconnect: [\n      'https://static.dable.io',\n      'https://api.dable.io',\n      'https://images.dable.io',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'directadvert': {\n    renderStartImplemented: true,\n  },\n\n  'distroscale': {\n    preconnect: [\n      'https://c.jsrdn.com',\n      'https://s.jsrdn.com',\n      'https://i.jsrdn.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'dotandads': {\n    prefetch: 'https://amp.ad.dotandad.com/dotandadsAmp.js',\n    preconnect: 'https://bal.ad.dotandad.com',\n  },\n\n  'eadv': {\n    renderStartImplemented: true,\n    clientIdScope: 'AMP_ECID_EADV',\n    prefetch: [\n      'https://www.eadv.it/track/esr.min.js',\n      'https://www.eadv.it/track/ead.min.js',\n    ],\n  },\n\n  'eas': {\n    prefetch: 'https://amp.emediate.eu/amp.v0.js',\n    renderStartImplemented: true,\n  },\n\n  'engageya': {},\n\n  'epeex': {},\n\n  'eplanning': {\n    prefetch: 'https://us.img.e-planning.net/layers/epl-amp.js',\n  },\n\n  'ezoic': {\n    prefetch: [\n      'https://www.googletagservices.com/tag/js/gpt.js',\n      'https://g.ezoic.net/ezoic/ampad.js',\n    ],\n    clientIdScope: 'AMP_ECID_EZOIC',\n    consentHandlingOverride: true,\n  },\n\n  'f1e': {\n    prefetch: 'https://img.ak.impact-ad.jp/util/f1e_amp.min.js',\n  },\n\n  'f1h': {\n    preconnect: 'https://img.ak.impact-ad.jp',\n    renderStartImplemented: true,\n  },\n\n  'fake': {},\n\n  'felmat': {\n    prefetch: 'https://t.felmat.net/js/fmamp.js',\n    renderStartImplemented: true,\n  },\n\n  'flite': {},\n\n  'fluct': {\n    preconnect: [\n      'https://cdn-fluct.sh.adingo.jp',\n      'https://s.sh.adingo.jp',\n      'https://i.adingo.jp',\n    ],\n  },\n\n  'fusion': {\n    prefetch: 'https://assets.adtomafusion.net/fusion/latest/fusion-amp.min.js',\n  },\n\n  'genieessp': {\n    prefetch: 'https://js.gsspcln.jp/l/amp.js',\n  },\n\n  'giraff': {\n    renderStartImplemented: true,\n  },\n\n  'gmossp': {\n    prefetch: 'https://cdn.gmossp-sp.jp/ads/amp.js',\n  },\n\n  'gumgum': {\n    prefetch: 'https://g2.gumgum.com/javascripts/ad.js',\n    renderStartImplemented: true,\n  },\n\n  'holder': {\n    prefetch: 'https://i.holder.com.ua/js2/holder/ajax/ampv1.js',\n    preconnect: 'https://h.holder.com.ua',\n    renderStartImplemented: true,\n  },\n\n  'ibillboard': {},\n\n  'imedia': {\n    prefetch: 'https://i.imedia.cz/js/im3.js',\n    renderStartImplemented: true,\n  },\n\n  'imobile': {\n    prefetch: 'https://spamp.i-mobile.co.jp/script/amp.js',\n    preconnect: 'https://spad.i-mobile.co.jp',\n  },\n  'imonomy': {\n    renderStartImplemented: true,\n  },\n  'improvedigital': {},\n\n  'industrybrains': {\n    prefetch: 'https://web.industrybrains.com/js/ads/async/show.js',\n    preconnect: [\n      'https://staticd.cdn.industrybrains.com',\n      'https://static.industrybrains.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'inmobi': {\n    prefetch: 'https://cf.cdn.inmobi.com/ad/inmobi.secure.js',\n    renderStartImplemented: true,\n  },\n\n  'innity': {\n    prefetch: 'https://cdn.innity.net/admanager.js',\n    preconnect: 'https://as.innity.com',\n    renderStartImplemented: true,\n  },\n\n  'ix': {\n    prefetch: [\n      'https://js-sec.indexww.com/apl/amp.js',\n    ],\n    preconnect: 'https://as-sec.casalemedia.com',\n    renderStartImplemented: true,\n  },\n\n  'kargo': {},\n\n  'kiosked': {\n    renderStartImplemented: true,\n  },\n\n  'kixer': {\n    prefetch: 'https://cdn.kixer.com/ad/load.js',\n    renderStartImplemented: true,\n  },\n\n  'kuadio': {},\n\n  'ligatus': {\n    prefetch: 'https://ssl.ligatus.com/render/ligrend.js',\n    renderStartImplemented: true,\n  },\n\n  'lockerdome': {\n    prefetch: 'https://cdn2.lockerdomecdn.com/_js/amp.js',\n    renderStartImplemented: true,\n  },\n\n  'loka': {\n    prefetch: 'https://loka-cdn.akamaized.net/scene/amp.js',\n    preconnect: [\n      'https://scene-front.lokaplatform.com',\n      'https://loka-materials.akamaized.net',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'mads': {\n    prefetch: 'https://eu2.madsone.com/js/tags.js',\n  },\n\n  'mantis-display': {\n    prefetch: 'https://assets.mantisadnetwork.com/mantodea.min.js',\n    preconnect: [\n      'https://mantodea.mantisadnetwork.com',\n      'https://res.cloudinary.com',\n      'https://resize.mantisadnetwork.com',\n    ],\n  },\n\n  'mantis-recommend': {\n    prefetch: 'https://assets.mantisadnetwork.com/recommend.min.js',\n    preconnect: [\n      'https://mantodea.mantisadnetwork.com',\n      'https://resize.mantisadnetwork.com',\n    ],\n  },\n\n  'mediaimpact': {\n    prefetch: 'https://ec-ns.sascdn.com/diff/251/pages/amp_default.js',\n    preconnect: [\n      'https://ww251.smartadserver.com',\n      'https://static.sascdn.com/',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'medianet': {\n    preconnect: 'https://contextual.media.net',\n    renderStartImplemented: true,\n  },\n\n  'mediavine': {\n    prefetch: 'https://amp.mediavine.com/wrapper.min.js',\n    preconnect: [\n      'https://partner.googleadservices.com',\n      'https://securepubads.g.doubleclick.net',\n      'https://tpc.googlesyndication.com',\n    ],\n    renderStartImplemented: true,\n    consentHandlingOverride: true,\n  },\n\n  'medyanet': {\n    renderStartImplemented: true,\n  },\n\n  'meg': {\n    renderStartImplemented: true,\n  },\n\n  'microad': {\n    prefetch: 'https://j.microad.net/js/camp.js',\n    preconnect: [\n      'https://s-rtb.send.microad.jp',\n      'https://s-rtb.send.microadinc.com',\n      'https://cache.send.microad.jp',\n      'https://cache.send.microadinc.com',\n      'https://deb.send.microad.jp',\n    ],\n  },\n\n  'miximedia': {\n    renderStartImplemented: true,\n  },\n\n  'mixpo': {\n    prefetch: 'https://cdn.mixpo.com/js/loader.js',\n    preconnect: [\n      'https://player1.mixpo.com',\n      'https://player2.mixpo.com',\n    ],\n  },\n\n  'monetizer101': {\n    renderStartImplemented: true,\n  },\n\n  'mytarget': {\n    prefetch: 'https://ad.mail.ru/static/ads-async.js',\n    renderStartImplemented: true,\n  },\n\n  'mywidget': {\n    preconnect: 'https://likemore-fe.go.mail.ru',\n    prefetch: 'https://likemore-go.imgsmail.ru/widget_amp.js',\n    renderStartImplemented: true,\n  },\n\n  'nativo': {\n    prefetch: 'https://s.ntv.io/serve/load.js',\n  },\n\n  'navegg': {\n    renderStartImplemented: true,\n  },\n\n  'nend': {\n    prefetch: 'https://js1.nend.net/js/amp.js',\n    preconnect: [\n      'https://output.nend.net',\n      'https://img1.nend.net',\n    ],\n  },\n\n  'netletix': {\n    preconnect: [\n      'https://call.netzathleten-media.de',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'noddus': {\n    prefetch: 'https://noddus.com/amp_loader.js',\n    renderStartImplemented: true,\n  },\n\n  'nokta': {\n    prefetch: 'https://static.virgul.com/theme/mockups/noktaamp/ampjs.js',\n    renderStartImplemented: true,\n  },\n\n  'openadstream': {},\n\n  'openx': {\n    prefetch: 'https://www.googletagservices.com/tag/js/gpt.js',\n    preconnect: [\n      'https://partner.googleadservices.com',\n      'https://securepubads.g.doubleclick.net',\n      'https://tpc.googlesyndication.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'outbrain': {\n    renderStartImplemented: true,\n    prefetch: 'https://widgets.outbrain.com/widgetAMP/outbrainAMP.min.js',\n    preconnect: [\n      'https://odb.outbrain.com',\n    ],\n    consentHandlingOverride: true,\n  },\n\n  'pixels': {\n    prefetch: 'https://cdn.adsfactor.net/amp/pixels-amp.min.js',\n    clientIdCookieName: '__AF',\n    renderStartImplemented: true,\n  },\n\n  'plista': {},\n\n  'polymorphicads': {\n    prefetch: 'https://www.polymorphicads.jp/js/amp.js',\n    preconnect: [\n      'https://img.polymorphicads.jp',\n      'https://ad.polymorphicads.jp',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'popin': {\n    renderStartImplemented: true,\n  },\n\n  'postquare': {},\n\n  'pubexchange': {},\n\n  'pubguru': {\n    renderStartImplemented: true,\n  },\n\n  'pubmatic': {\n    prefetch: 'https://ads.pubmatic.com/AdServer/js/amp.js',\n  },\n\n  'pubmine': {\n    prefetch: [\n      'https://s.pubmine.com/head.js',\n      'https://s.pubmine.com/showad.js',\n    ],\n    preconnect: 'https://delivery.g.switchadhub.com',\n    renderStartImplemented: true,\n  },\n\n  'pulsepoint': {\n    prefetch: 'https://ads.contextweb.com/TagPublish/getjs.static.js',\n    preconnect: 'https://tag.contextweb.com',\n  },\n\n  'purch': {\n    prefetch: 'https://ramp.purch.com/serve/creative_amp.js',\n    renderStartImplemented: true,\n  },\n\n  'quoraad': {\n    prefetch: 'https://a.quora.com/amp_ad.js',\n    preconnect: 'https://ampad.quora.com',\n    renderStartImplemented: true,\n  },\n\n  'realclick': {\n    renderStartImplemented: true,\n  },\n\n  'relap': {\n    renderStartImplemented: true,\n  },\n\n  'revcontent': {\n    prefetch: 'https://labs-cdn.revcontent.com/build/amphtml/revcontent.amp.min.js',\n    preconnect: [\n      'https://trends.revcontent.com',\n      'https://cdn.revcontent.com',\n      'https://img.revcontent.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'revjet': {\n    prefetch: 'https://cdn.revjet.com/~cdn/JS/03/amp.js',\n    renderStartImplemented: true,\n  },\n\n  'rubicon': {},\n\n  'sekindo': {\n    renderStartImplemented: true,\n  },\n\n  'sharethrough': {\n    renderStartImplemented: true,\n  },\n\n  'sklik': {\n    prefetch: 'https://c.imedia.cz/js/amp.js',\n  },\n\n  'slimcutmedia': {\n    preconnect: [\n      'https://sb.freeskreen.com',\n      'https://static.freeskreen.com',\n      'https://video.freeskreen.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'smartadserver': {\n    prefetch: 'https://ec-ns.sascdn.com/diff/js/amp.v0.js',\n    preconnect: 'https://static.sascdn.com',\n    renderStartImplemented: true,\n  },\n\n  'smartclip': {\n    prefetch: 'https://cdn.smartclip.net/amp/amp.v0.js',\n    preconnect: 'https://des.smartclip.net',\n    renderStartImplemented: true,\n  },\n\n  'smi2': {\n    renderStartImplemented: true,\n  },\n\n  'sogouad': {\n    prefetch: 'https://theta.sogoucdn.com/wap/js/aw.js',\n    renderStartImplemented: true,\n  },\n\n  'sortable': {\n    prefetch: 'https://www.googletagservices.com/tag/js/gpt.js',\n    preconnect: [\n      'https://tags-cdn.deployads.com',\n      'https://partner.googleadservices.com',\n      'https://securepubads.g.doubleclick.net',\n      'https://tpc.googlesyndication.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'sovrn': {\n    prefetch: 'https://ap.lijit.com/www/sovrn_amp/sovrn_ads.js',\n  },\n\n  'spotx': {\n    preconnect: 'https://js.spotx.tv',\n    renderStartImplemented: true,\n  },\n\n  'sunmedia': {\n    prefetch: 'https://vod.addevweb.com/sunmedia/amp/ads/sunmedia.js',\n    preconnect: 'https://static.addevweb.com',\n    renderStartImplemented: true,\n  },\n\n  'swoop': {\n    prefetch: 'https://www.swoop-amp.com/amp.js',\n    preconnect: [\n      'https://www.swpsvc.com',\n      'https://client.swpcld.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'taboola': {},\n\n  'teads': {\n    prefetch: 'https://cdn.teads.tv/media/format/v3/teads-format.min.js',\n    preconnect: [\n      'https://cdn2.teads.tv',\n      'https://a.teads.tv',\n      'https://t.teads.tv',\n      'https://r.teads.tv',\n    ],\n    consentHandlingOverride: true,\n  },\n\n  'triplelift': {},\n\n  'trugaze': {\n    clientIdScope: '__tg_amp',\n    renderStartImplemented: true,\n  },\n\n  'uas': {\n    prefetch: 'https://ads.pubmatic.com/AdServer/js/phoenix.js',\n  },\n\n  'uzou': {\n    preconnect: [\n      'https://speee-ad.akamaized.net',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'unruly': {\n    prefetch: 'https://video.unrulymedia.com/amp-demo/native-loader.js',\n    renderStartImplemented: true,\n  },\n\n  'valuecommerce': {\n    prefetch: 'https://amp.valuecommerce.com/amp_bridge.js',\n    preconnect: [\n      'https://ad.jp.ap.valuecommerce.com',\n      'https://ad.omks.valuecommerce.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'videointelligence': {\n    preconnect: 'https://s.vi-serve.com',\n    renderStartImplemented: true,\n  },\n\n  'videonow': {\n    renderStartImplemented: true,\n  },\n\n  'viralize': {\n    renderStartImplemented: true,\n  },\n\n  'vmfive': {\n    prefetch: 'https://man.vm5apis.com/dist/adn-web-sdk.js',\n    preconnect: [\n      'https://vawpro.vm5apis.com',\n      'https://vahfront.vm5apis.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'webediads': {\n    prefetch: 'https://eu1.wbdds.com/amp.min.js',\n    preconnect: [\n      'https://goutee.top',\n      'https://mediaathay.org.uk',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'weborama-display': {\n    prefetch: [\n      'https://cstatic.weborama.fr/js/advertiserv2/adperf_launch_1.0.0_scrambled.js',\n      'https://cstatic.weborama.fr/js/advertiserv2/adperf_core_1.0.0_scrambled.js',\n    ],\n  },\n\n  'widespace': {},\n\n  'wisteria': {\n    renderStartImplemented: true,\n  },\n\n  'wpmedia': {\n    prefetch: 'https://std.wpcdn.pl/wpjslib/wpjslib-amp.js',\n    preconnect: [\n      'https://www.wp.pl',\n      'https://v.wpimg.pl',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'xlift': {\n    prefetch: 'https://cdn.x-lift.jp/resources/common/xlift_amp.js',\n    renderStartImplemented: true,\n  },\n\n  'yahoo': {\n    prefetch: 'https://s.yimg.com/os/ampad/display.js',\n    preconnect: 'https://us.adserver.yahoo.com',\n  },\n\n  'yahoojp': {\n    prefetch: [\n      'https://s.yimg.jp/images/listing/tool/yads/ydn/amp/amp.js',\n      'https://yads.c.yimg.jp/js/yads.js',\n    ],\n    preconnect: 'https://yads.yahoo.co.jp',\n  },\n\n  'yandex': {\n    prefetch: 'https://yastatic.net/partner-code/loaders/context_amp.js',\n    renderStartImplemented: true,\n  },\n\n  'yengo': {\n    renderStartImplemented: true,\n  },\n\n  'yieldbot': {\n    prefetch: [\n      'https://cdn.yldbt.com/js/yieldbot.intent.amp.js',\n      'https://msg.yldbt.com/js/ybmsg.html',\n    ],\n    preconnect: 'https://i.yldbt.com',\n  },\n\n  'yieldmo': {\n    prefetch: 'https://static.yieldmo.com/ym.1.js',\n    preconnect: [\n      'https://s.yieldmo.com',\n      'https://ads.yieldmo.com',\n    ],\n    renderStartImplemented: true,\n  },\n\n  'yieldone': {\n    prefetch: 'https://img.ak.impact-ad.jp/ic/pone/commonjs/yone-amp.js',\n  },\n\n  'yieldpro': {\n    preconnect: 'https://creatives.yieldpro.eu',\n    renderStartImplemented: true,\n  },\n\n  'zedo': {\n    prefetch: 'https://ss3.zedo.com/gecko/tag/Gecko.amp.min.js',\n    renderStartImplemented: true,\n  },\n\n  'zergnet': {},\n\n  'zucks': {\n    preconnect: [\n      'https://j.zucks.net.zimg.jp',\n      'https://sh.zucks.net',\n      'https://k.zucks.net',\n      'https://static.zucks.net.zimg.jp',\n    ],\n  },\n\n};\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ExperimentInfo, // eslint-disable-line no-unused-vars\n  forceExperimentBranch,\n  getExperimentBranch,\n  randomlySelectUnsetExperiments,\n} from '../../../src/experiments';\nimport {\n  addExperimentIdToElement,\n} from './traffic-experiments';\n\n/**\n * Attempts to select into experiment and forces branch if selected.\n * @param {!Window} win\n * @param {!Element} element\n * @param {!Array<string>} branches\n * @param {string} expName\n * @param {boolean=} optAddExpIdToElement\n */\nexport function selectAndSetExperiments(\n  win, element, branches, expName, optAddExpIdToElement) {\n  const experimentId = expUtils.maybeSelectExperiment(\n      win, element, branches, expName);\n  if (!!experimentId) {\n    addExperimentIdToElement(optAddExpIdToElement ?\n      experimentId : undefined, element);\n    forceExperimentBranch(win, expName, experimentId);\n  }\n  return experimentId;\n}\n\nexport class ExperimentUtils {\n  /**\n   * @param {!Window} win\n   * @param {!Element} element\n   * @param {!Array<string>} selectionBranches\n   * @param {string} experimentName\n   */\n  maybeSelectExperiment(\n    win, element, selectionBranches, experimentName) {\n    const experimentInfoMap =\n    /** @type {!Object<string, !ExperimentInfo>} */ ({});\n    experimentInfoMap[experimentName] = {\n      isTrafficEligible: () => true,\n      branches: selectionBranches,\n    };\n    randomlySelectUnsetExperiments(win, experimentInfoMap);\n    return getExperimentBranch(win, experimentName);\n  }\n}\n\n/**\n * ExperimentUtils singleton.\n * @type {!ExperimentUtils}\n*/\nconst expUtils = new ExperimentUtils();\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {tryParseJson} from '../../../src/json';\n\n/**\n  * Handles an XHR response by calling lineCallback for each line delineation.\n  * Uses streaming where possible otherwise falls back to text.\n  * @param {!Window} win\n  * @param {!../../../src/utils/xhr-utils.FetchResponse} response\n  * @param {function(string, boolean)} lineCallback\n  * @private\n  */\nexport function lineDelimitedStreamer(win, response, lineCallback) {\n  let line = '';\n  /**\n   * @param {string} text\n   * @param {boolean} done\n   */\n  function streamer(text, done) {\n    const regex = /([^\\n]*)(\\n)?/g;\n    let match;\n    while ((match = regex.exec(text))) {\n      line += match[1];\n      if (match[2]) {\n        lineCallback(line, done && regex.lastIndex === text.length);\n        line = '';\n      }\n      if (regex.lastIndex === text.length) {\n        break;\n      }\n    }\n  }\n  if (!response.body || !win.TextDecoder) {\n    response.text().then(text => streamer(text, true));\n    return;\n  }\n\n  const decoder = new TextDecoder('utf-8');\n  const reader = /** @type !ReadableStreamDefaultReader */ (\n    response.body.getReader());\n  reader.read().then(function chunk(result) {\n    if (result.value) {\n      streamer(\n          decoder.decode(\n              /** @type {!ArrayBuffer} */(result.value), {'stream': true}),\n          result.done);\n    }\n    if (!result.done) {\n      // More chunks to read.\n      reader.read().then(chunk);\n    }\n  });\n}\n\n/**\n  * Given each line, groups such that the first is JSON parsed and second\n  * html unescaped.\n  * @param {function(string, !Object<string, *>, boolean)} callback\n  * @private\n  */\nexport function metaJsonCreativeGrouper(callback) {\n  let first;\n  return function(line, done) {\n    if (first) {\n      const metadata =\n      /** @type {!Object<string, *>} */(tryParseJson(first) || {});\n      const lowerCasedMetadata =\n          Object.keys(metadata).reduce((newObj, key) => {\n            newObj[key.toLowerCase()] = metadata[key];\n            return newObj;\n          }, {});\n      callback(unescapeLineDelimitedHtml_(line), lowerCasedMetadata, done);\n      first = null;\n    } else {\n      first = line;\n    }\n  };\n}\n\n/**\n  * Unescapes characters that are escaped in line-delimited JSON-HTML.\n  * @param {string} html An html snippet.\n  * @return {string}\n  * @private\n  */\nfunction unescapeLineDelimitedHtml_(html) {\n  return html.replace(\n      /\\\\(n|r|\\\\)/g,\n      (_, match) => match == 'n' ? '\\n' : match == 'r' ? '\\r' : '\\\\');\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Machinery for doing \"traffic-level\" experiments.  That is, rather than\n * a single user choosing to opt-in to an experimental version of a module,\n * this framework allows you to do randomized, controlled experiments on all\n * AMP page loads to, for example, test relative performance or look for\n * impacts on click-throughs.\n */\n\nimport {\n  EXPERIMENT_ATTRIBUTE,\n  mergeExperimentIds,\n} from './utils';\nimport {\n  ExperimentInfo, // eslint-disable-line no-unused-vars\n  isExperimentOn,\n} from '../../../src/experiments';\nimport {Services} from '../../../src/services';\nimport {parseQueryString} from '../../../src/url';\n\n/** @typedef {{\n *    control: string,\n *    experiment: string\n *  }} */\nexport let A4aExperimentBranches;\n\n/** @type {string} @private */\nexport const MANUAL_EXPERIMENT_ID = '117152632';\n\n/**\n * @param {!Window} win\n * @param {!Element} element Ad tag Element.\n * @return {?string} experiment extracted from page url.\n */\nexport function extractUrlExperimentId(win, element) {\n  const expParam = Services.viewerForDoc(element).getParam('exp') ||\n    parseQueryString(win.location.search)['exp'];\n  if (!expParam) {\n    return null;\n  }\n  // Allow for per type experiment control with Doubleclick key set for 'da'\n  // and AdSense using 'aa'.  Fallback to 'a4a' if type specific is missing.\n  const expKeys = [\n    (element.getAttribute('type') || '').toLowerCase() == 'doubleclick' ?\n      'da' : 'aa',\n    'a4a',\n  ];\n  let arg;\n  let match;\n  expKeys.forEach(key => arg = arg ||\n    ((match = new RegExp(`(?:^|,)${key}:(-?\\\\d+)`).exec(expParam)) &&\n      match[1]));\n  return arg || null;\n}\n\n/**\n * Sets of experiment IDs can be attached to Elements via attributes.  In\n * that case, we encode them as a string containing a comma-separated list\n * of experiment IDs.  This parses a comma-separated list from a string into\n * a list of ID strings.  If the input string is empty or null, this returns\n * the empty list.  This does no validity checking on the ID formats -- for\n * that, use validateExperimentIds.\n *\n * @param {?string} idString  String to parse.\n * @return {!Array<string>}  List of experiment IDs (possibly empty).\n * @see validateExperimentIds\n */\nexport function parseExperimentIds(idString) {\n  if (idString) {\n    return idString.split(',');\n  }\n  return [];\n}\n\n/**\n * Checks whether the given element is a member of the given experiment branch.\n * I.e., whether the element's data-experiment-id attribute contains the id\n * value (possibly because the host page URL contains a 'exp=a4a:X' parameter\n * and #maybeSetExperimentFromUrl has added the appropriate EID).\n *\n * @param {!Element} element Element to check for membership in a specific\n *   experiment.\n * @param {?string} id Experiment ID to check for on `element`.\n * @return {boolean}\n */\nexport function isInExperiment(element, id) {\n  return parseExperimentIds(element.getAttribute(EXPERIMENT_ATTRIBUTE)).some(\n      x => { return x === id; });\n}\n\n/**\n * Checks whether the given element is a member of the 'manually triggered\n * \"experiment\" branch'.  I.e., whether the element's data-experiment-id\n * attribute contains the MANUAL_EXPERIMENT_ID value (hopefully because the\n * user has manually specified 'exp=a4a:-1' in the host page URL and\n * #maybeSetExperimentFromUrl has added it).\n *\n * @param {!Element} element  Element to check for manual experiment membership.\n * @return {boolean}\n */\nexport function isInManualExperiment(element) {\n  return isInExperiment(element, MANUAL_EXPERIMENT_ID);\n}\n\n/**\n * Predicate to check whether A4A has launched yet or not.\n * If it has not yet launched, then the experimental branch serves A4A, and\n * control/filler do not. If it has not, then the filler and control branch do\n * serve A4A, and the experimental branch does not.\n *\n * @param {!Window} win  Host window for the ad.\n * @param {!Element} element  Element to check for pre-launch membership.\n * @return {boolean}\n */\nexport function hasLaunched(win, element) {\n  switch (element.getAttribute('type')) {\n    case 'adsense':\n      return isExperimentOn(win, 'a4aFastFetchAdSenseLaunched');\n    case 'doubleclick':\n      return isExperimentOn(win, 'a4aFastFetchDoubleclickLaunched');\n    default:\n      return false;\n  }\n}\n\n/**\n * Checks that all string experiment IDs in a list are syntactically valid\n * (integer base 10).\n *\n * @param {!Array<string>} idList  List of experiment IDs.  Can be empty.\n * @return {boolean} Whether all list elements are valid experiment IDs.\n */\nexport function validateExperimentIds(idList) {\n  return idList.every(id => { return !isNaN(parseInt(id, 10)); });\n}\n\n/**\n * Adds a single experimentID to an element iff it's a valid experiment ID.\n * No-ops if the experimentId is undefined.\n *\n * @param {string|undefined} experimentId  ID to add to the element.\n * @param {Element} element to add the experiment ID to.\n */\nexport function addExperimentIdToElement(experimentId, element) {\n  if (!experimentId) {\n    return;\n  }\n  const currentEids = element.getAttribute(EXPERIMENT_ATTRIBUTE);\n  if (currentEids && validateExperimentIds(parseExperimentIds(currentEids))) {\n    element.setAttribute(EXPERIMENT_ATTRIBUTE,\n        mergeExperimentIds([experimentId], currentEids));\n  } else {\n    element.setAttribute(EXPERIMENT_ATTRIBUTE, experimentId);\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {{name: string, value: (string|number|null)}} */\nexport let QueryParameterDef;\n\n/**\n * Builds a URL from query parameters, truncating to a maximum length if\n * necessary.\n * @param {string} baseUrl scheme, domain, and path for the URL.\n * @param {!Object<string,string|number|null>} queryParams query parameters for\n *     the URL.\n * @param {number} maxLength length to truncate the URL to if necessary.\n * @param {?QueryParameterDef=} opt_truncationQueryParam query parameter to\n *     append to the URL iff any query parameters were truncated.\n * @return {string} the fully constructed URL.\n */\nexport function buildUrl(\n  baseUrl, queryParams, maxLength, opt_truncationQueryParam) {\n  const encodedParams = [];\n  const encodedTruncationParam =\n      opt_truncationQueryParam &&\n      !(opt_truncationQueryParam.value == null ||\n      opt_truncationQueryParam.value === '') ?\n        encodeURIComponent(opt_truncationQueryParam.name) + '=' +\n      encodeURIComponent(String(opt_truncationQueryParam.value)) :\n        null;\n  let capacity = maxLength - baseUrl.length;\n  if (encodedTruncationParam) {\n    capacity -= encodedTruncationParam.length + 1;\n  }\n  const keys = Object.keys(queryParams);\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i];\n    const value = queryParams[key];\n    if (value == null || value === '') {\n      continue;\n    }\n    const encodedNameAndSep = encodeURIComponent(key) + '=';\n    const encodedValue = encodeURIComponent(String(value));\n    const fullLength = encodedNameAndSep.length + encodedValue.length + 1;\n    if (fullLength > capacity) {\n      const truncatedValue = encodedValue\n          .substr(0, capacity - encodedNameAndSep.length - 1)\n      // Don't end with a partially truncated escape sequence\n          .replace(/%\\w?$/, '');\n      if (truncatedValue) {\n        encodedParams.push(encodedNameAndSep + truncatedValue);\n      }\n      if (encodedTruncationParam) {\n        encodedParams.push(encodedTruncationParam);\n      }\n      break;\n    }\n    encodedParams.push(encodedNameAndSep + encodedValue);\n    capacity -= fullLength;\n  }\n  if (!encodedParams.length) {\n    return baseUrl;\n  }\n  return baseUrl + '?' + encodedParams.join('&');\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DomFingerprint} from '../../../src/utils/dom-fingerprint';\nimport {Services} from '../../../src/services';\nimport {buildUrl} from './url-builder';\nimport {dev} from '../../../src/log';\nimport {dict} from '../../../src/utils/object';\nimport {getBinaryType} from '../../../src/experiments';\nimport {getMode} from '../../../src/mode';\nimport {getOrCreateAdCid} from '../../../src/ad-cid';\nimport {getTimingDataSync} from '../../../src/service/variable-source';\nimport {\n  isExperimentOn,\n  toggleExperiment,\n} from '../../../src/experiments';\nimport {parseJson} from '../../../src/json';\nimport {whenUpgradedToCustomElement} from '../../../src/dom';\n\n/** @type {string}  */\nconst AMP_ANALYTICS_HEADER = 'X-AmpAnalytics';\n\n/** @const {number} */\nconst MAX_URL_LENGTH = 16384;\n\n/** @enum {string} */\nconst AmpAdImplementation = {\n  AMP_AD_XHR_TO_IFRAME: '2',\n  AMP_AD_XHR_TO_IFRAME_OR_AMP: '3',\n  AMP_AD_IFRAME_GET: '5',\n};\n\n/** @const {!Object} */\nexport const ValidAdContainerTypes = {\n  'AMP-CAROUSEL': 'ac',\n  'AMP-FX-FLYING-CARPET': 'fc',\n  'AMP-LIGHTBOX': 'lb',\n  'AMP-STICKY-AD': 'sa',\n};\n\n/**\n * See `VisibilityState` enum.\n * @const {!Object<string, string>}\n */\nconst visibilityStateCodes = {\n  'visible': '1',\n  'hidden': '2',\n  'prerender': '3',\n  'unloaded': '5',\n};\n\n/** @const {string} */\nexport const QQID_HEADER = 'X-QQID';\n\n/**\n * Element attribute that stores experiment IDs.\n *\n * Note: This attribute should be used only for tracking experimental\n * implementations of AMP tags, e.g., by AMPHTML implementors.  It should not be\n * added by a publisher page.\n *\n * @const {string}\n * @visibleForTesting\n */\nexport const EXPERIMENT_ATTRIBUTE = 'data-experiment-id';\n\n/** @typedef {{urls: !Array<string>}}\n */\nexport let AmpAnalyticsConfigDef;\n\n/**\n * @typedef {{instantLoad: boolean, writeInBody: boolean}}\n */\nexport let NameframeExperimentConfig;\n\n/**\n * @const {!./url-builder.QueryParameterDef}\n * @visibleForTesting\n */\nexport const TRUNCATION_PARAM = {name: 'trunc', value: '1'};\n\n/** @const {Object} */\nconst CDN_PROXY_REGEXP = /^https:\\/\\/([a-zA-Z0-9_-]+\\.)?cdn\\.ampproject\\.org((\\/.*)|($))+/;\n\n/**\n * Returns the value of navigation start using the performance API or 0 if not\n * supported by the browser.\n * Feature detection is used for safety on browsers that do not support the\n * performance API.\n * @param {!Window} win\n * @return {number}\n */\nfunction getNavStart(win) {\n  return (win['performance'] && win['performance']['timing'] &&\n      win['performance']['timing']['navigationStart']) || 0;\n}\n\n/**\n * Check whether Google Ads supports the A4A rendering pathway is valid for the\n * environment by ensuring native crypto support and page originated in the\n * {@code cdn.ampproject.org} CDN <em>or</em> we must be running in local\n * dev mode.\n *\n * @param {!Window} win  Host window for the ad.\n * @return {boolean}  Whether Google Ads should attempt to render via the A4A\n *   pathway.\n */\nexport function isGoogleAdsA4AValidEnvironment(win) {\n  return supportsNativeCrypto(win) && (\n    !!isCdnProxy(win) || getMode(win).localDev || getMode(win).test);\n}\n\n/**\n * Checks whether native crypto is supported for win.\n * @param {!Window} win  Host window for the ad.\n * @return {boolean} Whether native crypto is supported.\n */\nexport function supportsNativeCrypto(win) {\n  return win.crypto && (win.crypto.subtle || win.crypto.webkitSubtle);\n}\n\n/**\n * @param {!AMP.BaseElement} ampElement The element on whose lifecycle this\n *    reporter will be reporting.\n * @return {boolean} whether reporting is enabled for this element\n */\nexport function isReportingEnabled(ampElement) {\n  // Carve-outs: We only want to enable profiling pingbacks when:\n  //   - The ad is from one of the Google networks (AdSense or Doubleclick).\n  //   - The ad slot is in the A4A-vs-3p amp-ad control branch (either via\n  //     internal, client-side selection or via external, Google Search\n  //     selection).\n  //   - We haven't turned off profiling via the rate controls in\n  //     build-system/global-config/{canary,prod}-config.json\n  // If any of those fail, we use the `BaseLifecycleReporter`, which is a\n  // a no-op (sends no pings).\n  const type = ampElement.element.getAttribute('type');\n  const {win} = ampElement;\n  // In local dev mode, neither the canary nor prod config files is available,\n  // so manually set the profiling rate, for testing/dev.\n  if (getMode(ampElement.win).localDev && !getMode(ampElement.win).test) {\n    toggleExperiment(win, 'a4aProfilingRate', true, true);\n  }\n  return (type == 'doubleclick' || type == 'adsense') &&\n      isExperimentOn(win, 'a4aProfilingRate');\n}\n\n/**\n * Has side-effect of incrementing ifi counter on window.\n * @param {!../../../extensions/amp-a4a/0.1/amp-a4a.AmpA4A} a4a\n * @param {!Array<string>=} opt_experimentIds Any experiments IDs (in addition\n *     to those specified on the ad element) that should be included in the\n *     request.\n * @return {!Object<string,null|number|string>} block level parameters\n */\nexport function googleBlockParameters(a4a, opt_experimentIds) {\n  const {element: adElement, win} = a4a;\n  const slotRect = a4a.getPageLayoutBox();\n  const iframeDepth = iframeNestingDepth(win);\n  const enclosingContainers = getEnclosingContainerTypes(adElement);\n  let eids = adElement.getAttribute('data-experiment-id');\n  if (opt_experimentIds) {\n    eids = mergeExperimentIds(opt_experimentIds, eids);\n  }\n  return {\n    'adf': DomFingerprint.generate(adElement),\n    'nhd': iframeDepth,\n    'eid': eids,\n    'adx': slotRect.left,\n    'ady': slotRect.top,\n    'oid': '2',\n    'act': enclosingContainers.length ? enclosingContainers.join() : null,\n  };\n}\n\n/**\n * @param {!Window} win\n * @param {string} type matching typing attribute.\n * @param {function(!Element):string} groupFn\n * @return {!Promise<!Object<string,!Array<!Promise<!../../../src/base-element.BaseElement>>>>}\n */\nexport function groupAmpAdsByType(win, type, groupFn) {\n  // Look for amp-ad elements of correct type or those contained within\n  // standard container type.  Note that display none containers will not be\n  // included as they will never be measured.\n  // TODO(keithwrightbos): what about slots that become measured due to removal\n  // of display none (e.g. user resizes viewport and media selector makes\n  // visible).\n  const ampAdSelector =\n      r => r.element./*OK*/querySelector(`amp-ad[type=${type}]`);\n  return Services.resourcesForDoc(win.document).getMeasuredResources(win,\n      r => {\n        const isAmpAdType = r.element.tagName == 'AMP-AD' &&\n          r.element.getAttribute('type') == type;\n        if (isAmpAdType) {\n          return true;\n        }\n        const isAmpAdContainerElement =\n          Object.keys(ValidAdContainerTypes).includes(r.element.tagName) &&\n          !!ampAdSelector(r);\n        return isAmpAdContainerElement;\n      })\n      // Need to wait on any contained element resolution followed by build\n      // of child ad.\n      .then(resources => Promise.all(resources.map(\n          resource => {\n            if (resource.element.tagName == 'AMP-AD') {\n              return resource.element;\n            }\n            // Must be container element so need to wait for child amp-ad to\n            // be upgraded.\n            return whenUpgradedToCustomElement(\n                dev().assertElement(ampAdSelector(resource)));\n          })))\n      // Group by networkId.\n      .then(elements => elements.reduce((result, element) => {\n        const groupId = groupFn(element);\n        (result[groupId] || (result[groupId] = [])).push(element.getImpl());\n        return result;\n      }, {}));\n}\n\n/**\n * @param {! ../../../extensions/amp-a4a/0.1/amp-a4a.AmpA4A} a4a\n * @param {number} startTime\n * @return {!Promise<!Object<string,null|number|string>>}\n */\nexport function googlePageParameters(a4a, startTime) {\n  const {win} = a4a;\n  const ampDoc = a4a.getAmpDoc();\n  return Promise.all([\n    getOrCreateAdCid(ampDoc, 'AMP_ECID_GOOGLE', '_ga'),\n    Services.viewerForDoc(ampDoc).getReferrerUrl()])\n      .then(promiseResults => {\n        const clientId = promiseResults[0];\n        const documentInfo = Services.documentInfoForDoc(ampDoc);\n        // Read by GPT for GA/GPT integration.\n        win.gaGlobal = win.gaGlobal ||\n        {cid: clientId, hid: documentInfo.pageViewId};\n        const {screen} = win;\n        const viewport = Services.viewportForDoc(ampDoc);\n        const viewportRect = viewport.getRect();\n        const viewportSize = viewport.getSize();\n        const visibilityState = Services.viewerForDoc(ampDoc)\n            .getVisibilityState();\n        return {\n          'is_amp': a4a.isXhrAllowed() ?\n            AmpAdImplementation.AMP_AD_XHR_TO_IFRAME_OR_AMP :\n            AmpAdImplementation.AMP_AD_IFRAME_GET,\n          'amp_v': '$internalRuntimeVersion$',\n          'd_imp': '1',\n          'c': getCorrelator(win, ampDoc, clientId),\n          'ga_cid': win.gaGlobal.cid || null,\n          'ga_hid': win.gaGlobal.hid || null,\n          'dt': startTime,\n          'biw': viewportRect.width,\n          'bih': viewportRect.height,\n          'u_aw': screen ? screen.availWidth : null,\n          'u_ah': screen ? screen.availHeight : null,\n          'u_cd': screen ? screen.colorDepth : null,\n          'u_w': screen ? screen.width : null,\n          'u_h': screen ? screen.height : null,\n          'u_tz': -new Date().getTimezoneOffset(),\n          'u_his': getHistoryLength(win),\n          'isw': win != win.top ? viewportSize.width : null,\n          'ish': win != win.top ? viewportSize.height : null,\n          'art': getAmpRuntimeTypeParameter(win),\n          'vis': visibilityStateCodes[visibilityState] || '0',\n          'scr_x': viewport.getScrollLeft(),\n          'scr_y': viewport.getScrollTop(),\n          'bc': getBrowserCapabilitiesBitmap(win) || null,\n          'debug_experiment_id':\n              (/(?:#|,)deid=([\\d,]+)/i.exec(win.location.hash) || [])[1] ||\n                  null,\n          'url': documentInfo.canonicalUrl,\n          'top': win != win.top ? topWindowUrlOrDomain(win) : null,\n          'loc': win.location.href == documentInfo.canonicalUrl ?\n            null : win.location.href,\n          'ref': promiseResults[1] || null,\n        };\n      });\n}\n\n/**\n * @param {!../../../extensions/amp-a4a/0.1/amp-a4a.AmpA4A} a4a\n * @param {string} baseUrl\n * @param {number} startTime\n * @param {!Object<string,null|number|string>} parameters\n * @param {!Array<string>=} opt_experimentIds Any experiments IDs (in addition\n *     to those specified on the ad element) that should be included in the\n *     request.\n * @return {!Promise<string>}\n */\nexport function googleAdUrl(\n  a4a, baseUrl, startTime, parameters, opt_experimentIds) {\n  // TODO: Maybe add checks in case these promises fail.\n  const blockLevelParameters = googleBlockParameters(a4a, opt_experimentIds);\n  return googlePageParameters(a4a, startTime)\n      .then(pageLevelParameters => {\n        Object.assign(parameters, blockLevelParameters, pageLevelParameters);\n        return truncAndTimeUrl(baseUrl, parameters, startTime);\n      });\n}\n\n/**\n * @param {string} baseUrl\n * @param {!Object<string,null|number|string>} parameters\n * @param {number} startTime\n * @return {string}\n */\nexport function truncAndTimeUrl(baseUrl, parameters, startTime) {\n  return buildUrl(\n      baseUrl, parameters, MAX_URL_LENGTH - 10, TRUNCATION_PARAM)\n    + '&dtd=' + elapsedTimeWithCeiling(Date.now(), startTime);\n}\n\n/**\n * @param {!Window} win\n * @return {number}\n */\nfunction iframeNestingDepth(win) {\n  let w = win;\n  let depth = 0;\n  while (w != w.parent && depth < 100) {\n    w = w.parent;\n    depth++;\n  }\n  dev().assert(w == win.top);\n  return depth;\n}\n\n/**\n * @param {!Window} win\n * @return {number}\n */\nfunction getHistoryLength(win) {\n  // We have seen cases where accessing history length causes errors.\n  try {\n    return win.history.length;\n  } catch (e) {\n    return 0;\n  }\n}\n\n/**\n * @param {string} url\n * @return {string} hostname portion of url\n * @visibleForTesting\n */\nexport function extractHost(url) {\n  return (/^(?:https?:\\/\\/)?([^\\/\\?:]+)/i.exec(url) || [])[1] || url;\n}\n\n/**\n * @param {!Window} win\n * @return {?string}\n */\nfunction topWindowUrlOrDomain(win) {\n  const {ancestorOrigins} = win.location;\n  if (ancestorOrigins) {\n    const {origin} = win.location;\n    const topOrigin = ancestorOrigins[ancestorOrigins.length - 1];\n    if (origin == topOrigin) {\n      return win.top.location.hostname;\n    }\n    const secondFromTop = secondWindowFromTop(win);\n    if (secondFromTop == win ||\n        origin == ancestorOrigins[ancestorOrigins.length - 2]) {\n      return extractHost(secondFromTop./*OK*/document.referrer);\n    }\n    return extractHost(topOrigin);\n  } else {\n    try {\n      return win.top.location.hostname;\n    } catch (e) {}\n    const secondFromTop = secondWindowFromTop(win);\n    try {\n      return extractHost(secondFromTop./*OK*/document.referrer);\n    } catch (e) {}\n    return null;\n  }\n}\n\n/**\n * @param {!Window} win\n * @return {!Window}\n */\nfunction secondWindowFromTop(win) {\n  let secondFromTop = win;\n  let depth = 0;\n  while (secondFromTop.parent != secondFromTop.parent.parent &&\n        depth < 100) {\n    secondFromTop = secondFromTop.parent;\n    depth++;\n  }\n  dev().assert(secondFromTop.parent == win.top);\n  return secondFromTop;\n}\n\n/**\n * @param {number} time\n * @param {number} start\n * @return {(number|string)}\n */\nfunction elapsedTimeWithCeiling(time, start) {\n  const duration = time - start;\n  if (duration >= 1e6) {\n    return 'M';\n  } else if (duration >= 0) {\n    return duration;\n  }\n  return '-M';\n}\n\n/**\n * `nodeOrDoc` must be passed for correct behavior in shadow AMP (PWA) case.\n * @param {!Window} win\n * @param {!Element|!../../../src/service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string=} opt_cid\n * @return {number} The correlator.\n */\nexport function getCorrelator(win, elementOrAmpDoc, opt_cid) {\n  if (!win.ampAdPageCorrelator) {\n    win.ampAdPageCorrelator = isExperimentOn(win, 'exp-new-correlator') ?\n      Math.floor(4503599627370496 * Math.random()) :\n      makeCorrelator(\n          Services.documentInfoForDoc(elementOrAmpDoc).pageViewId, opt_cid);\n  }\n  return win.ampAdPageCorrelator;\n}\n\n/**\n * @param {string} pageViewId\n * @param {string=} opt_clientId\n * @return {number}\n */\nfunction makeCorrelator(pageViewId, opt_clientId) {\n  const pageViewIdNumeric = Number(pageViewId || 0);\n  if (opt_clientId) {\n    return pageViewIdNumeric + ((opt_clientId.replace(/\\D/g, '') % 1e6) * 1e6);\n  } else {\n    // In this case, pageViewIdNumeric is only 4 digits => too low entropy\n    // to be useful as a page correlator.  So synthesize one from scratch.\n    // 4503599627370496 == 2^52.  The guaranteed range of JS Number is at least\n    // 2^53 - 1.\n    return Math.floor(4503599627370496 * Math.random());\n  }\n}\n\n\n/**\n * Collect additional dimensions for the brdim parameter.\n * @param {!Window} win The window for which we read the browser dimensions.\n * @param {{width: number, height: number}|null} viewportSize\n * @return {string}\n * @visibleForTesting\n */\nexport function additionalDimensions(win, viewportSize) {\n  // Some browsers throw errors on some of these.\n  let screenX, screenY, outerWidth, outerHeight, innerWidth, innerHeight;\n  try {\n    screenX = win.screenX;\n    screenY = win.screenY;\n  } catch (e) {}\n  try {\n    outerWidth = win.outerWidth;\n    outerHeight = win.outerHeight;\n  } catch (e) {}\n  try {\n    innerWidth = viewportSize.width;\n    innerHeight = viewportSize.height;\n  } catch (e) {}\n  return [win.screenLeft,\n    win.screenTop,\n    screenX,\n    screenY,\n    win.screen ? win.screen.availWidth : undefined,\n    win.screen ? win.screen.availTop : undefined,\n    outerWidth,\n    outerHeight,\n    innerWidth,\n    innerHeight].join();\n}\n\n/**\n * Returns amp-analytics config for a new CSI trigger.\n * @param {string} on The name of the analytics trigger.\n * @param {!Object<string, string>} params Params to be included on the ping.\n * @return {!JsonObject}\n */\nfunction csiTrigger(on, params) {\n  return dict({\n    'on': on,\n    'request': 'csi',\n    'sampleSpec': {\n      // Pings are sampled on a per-pageview basis. A prefix is included in the\n      // sampleOn spec so that the hash is orthogonal to any other sampling in\n      // amp.\n      'sampleOn': 'a4a-csi-${pageViewId}',\n      'threshold': 1, // 1% sample\n    },\n    'selector': 'amp-ad',\n    'selectionMethod': 'closest',\n    'extraUrlParams': params,\n  });\n}\n\n/**\n * Returns amp-analytics config for Google ads network impls.\n * @return {!JsonObject}\n */\nexport function getCsiAmpAnalyticsConfig() {\n  return dict({\n    'requests': {\n      'csi': 'https://csi.gstatic.com/csi?',\n    },\n    'transport': {'xhrpost': false},\n    'triggers': {\n      'adRequestStart': csiTrigger('ad-request-start', {\n        // afs => ad fetch start\n        'met.a4a': 'afs_lvt.${viewerLastVisibleTime}~afs.${time}',\n      }),\n      'adResponseEnd': csiTrigger('ad-response-end', {\n        // afe => ad fetch end\n        'met.a4a': 'afe.${time}',\n      }),\n      'adRenderStart': csiTrigger('ad-render-start', {\n        // ast => ad schedule time\n        // ars => ad render start\n        'met.a4a':\n            'ast.${scheduleTime}~ars_lvt.${viewerLastVisibleTime}~ars.${time}',\n        'qqid': '${qqid}',\n      }),\n      'adIframeLoaded': csiTrigger('ad-iframe-loaded', {\n        // ail => ad iframe loaded\n        'met.a4a': 'ail.${time}',\n      }),\n    },\n    'extraUrlParams': {\n      's': 'ampad',\n      'ctx': '2',\n      'c': '${correlator}',\n      'slotId': '${slotId}',\n      // Time that the beacon was actually sent. Note that there can be delays\n      // between the time at which the event is fired and when ${nowMs} is\n      // evaluated when the URL is built by amp-analytics.\n      'puid': '${requestCount}~${timestamp}',\n    },\n  });\n}\n\n/**\n * Returns variables to be included in the amp-analytics event for A4A.\n * @param {string} analyticsTrigger The name of the analytics trigger.\n * @param {!AMP.BaseElement} a4a The A4A element.\n * @param {?string} qqid The query ID or null if the query ID has not been set\n *     yet.\n */\nexport function getCsiAmpAnalyticsVariables(analyticsTrigger, a4a, qqid) {\n  const {win} = a4a;\n  const ampdoc = a4a.getAmpDoc();\n  const viewer = Services.viewerForDoc(ampdoc);\n  const navStart = getNavStart(win);\n  const vars = {\n    'correlator': getCorrelator(win, ampdoc),\n    'slotId': a4a.element.getAttribute('data-amp-slot-index'),\n    'viewerLastVisibleTime': viewer.getLastVisibleTime() - navStart,\n  };\n  if (qqid) {\n    vars['qqid'] = qqid;\n  }\n  if (analyticsTrigger == 'ad-render-start') {\n    vars['scheduleTime'] = a4a.element.layoutScheduleTime - navStart;\n  }\n  return vars;\n}\n\n/**\n * Extracts configuration used to build amp-analytics element for active view.\n *\n * @param {!../../../extensions/amp-a4a/0.1/amp-a4a.AmpA4A} a4a\n * @param {!../../../src/utils/xhr-utils.FetchResponseHeaders} responseHeaders\n *   XHR service FetchResponseHeaders object containing the response\n *   headers.\n * @return {?JsonObject} config or null if invalid/missing.\n */\nexport function extractAmpAnalyticsConfig(a4a, responseHeaders) {\n  if (!responseHeaders.has(AMP_ANALYTICS_HEADER)) {\n    return null;\n  }\n  try {\n    const analyticsConfig =\n        parseJson(responseHeaders.get(AMP_ANALYTICS_HEADER));\n    dev().assert(Array.isArray(analyticsConfig['url']));\n    const urls = analyticsConfig['url'];\n    if (!urls.length) {\n      return null;\n    }\n\n    const config = /** @type {JsonObject}*/ ({\n      'transport': {'beacon': false, 'xhrpost': false},\n      'triggers': {\n        'continuousVisible': {\n          'on': 'visible',\n          'visibilitySpec': {\n            'selector': 'amp-ad',\n            'selectionMethod': 'closest',\n            'visiblePercentageMin': 50,\n            'continuousTimeMin': 1000,\n          },\n        },\n      },\n    });\n\n    // Discover and build visibility endpoints.\n    const requests = dict();\n    for (let idx = 1; idx <= urls.length; idx++) {\n      // TODO: Ensure url is valid and not freeform JS?\n      requests[`visibility${idx}`] = `${urls[idx - 1]}`;\n    }\n    // Security review needed here.\n    config['requests'] = requests;\n    config['triggers']['continuousVisible']['request'] =\n        Object.keys(requests);\n    return config;\n  } catch (err) {\n    dev().error('AMP-A4A', 'Invalid analytics', err,\n        responseHeaders.get(AMP_ANALYTICS_HEADER));\n  }\n  return null;\n}\n\n/**\n * Add new experiment IDs to a (possibly empty) existing set of experiment IDs.\n * The {@code currentIdString} may be {@code null} or {@code ''}, but if it is\n * populated, it must contain a comma-separated list of integer experiment IDs\n * (per {@code parseExperimentIds()}).  Returns the new set of IDs, encoded\n * as a comma-separated list.  Does not de-duplicate ID entries.\n *\n * @param {!Array<string>} newIds IDs to merge in. Should contain stringified\n *     integer (base 10) experiment IDs.\n * @param {?string} currentIdString  If present, a string containing a\n *   comma-separated list of integer experiment IDs.\n * @return {string}  New experiment list string, including newId iff it is\n *   a valid (integer) experiment ID.\n * @see parseExperimentIds, validateExperimentIds\n */\nexport function mergeExperimentIds(newIds, currentIdString) {\n  const newIdString = newIds.filter(newId => Number(newId)).join(',');\n  currentIdString = currentIdString || '';\n  return currentIdString + (currentIdString && newIdString ? ',' : '')\n      + newIdString;\n}\n\n/**\n * Adds two CSI signals to the given amp-analytics configuration object, one\n * for render-start, and one for ini-load.\n *\n * @param {!Window} win\n * @param {!Element} element The ad slot.\n * @param {!JsonObject} config The original config object.\n * @param {?string} qqid\n * @param {boolean} isVerifiedAmpCreative\n * @return {?JsonObject} config or null if invalid/missing.\n */\nexport function addCsiSignalsToAmpAnalyticsConfig(\n  win, element, config, qqid, isVerifiedAmpCreative) {\n  // Add CSI pingbacks.\n  const correlator = getCorrelator(win, element);\n  const slotId = Number(element.getAttribute('data-amp-slot-index'));\n  const eids = encodeURIComponent(\n      element.getAttribute(EXPERIMENT_ATTRIBUTE));\n  const adType = element.getAttribute('type');\n  const initTime =\n      Number(getTimingDataSync(win, 'navigationStart') || Date.now());\n  const deltaTime = Math.round(win.performance && win.performance.now ?\n    win.performance.now() : (Date.now() - initTime));\n  const baseCsiUrl = 'https://csi.gstatic.com/csi?s=a4a' +\n      `&c=${correlator}&slotId=${slotId}&qqid.${slotId}=${qqid}` +\n      `&dt=${initTime}` +\n      (eids != 'null' ? `&e.${slotId}=${eids}` : '') +\n      `&rls=$internalRuntimeVersion$&adt.${slotId}=${adType}`;\n  const isAmpSuffix = isVerifiedAmpCreative ? 'Friendly' : 'CrossDomain';\n  config['triggers']['continuousVisibleIniLoad'] = {\n    'on': 'ini-load',\n    'selector': 'amp-ad',\n    'selectionMethod': 'closest',\n    'request': 'iniLoadCsi',\n  };\n  config['triggers']['continuousVisibleRenderStart'] = {\n    'on': 'render-start',\n    'selector': 'amp-ad',\n    'selectionMethod': 'closest',\n    'request': 'renderStartCsi',\n  };\n  config['requests']['iniLoadCsi'] = baseCsiUrl +\n      `&met.a4a.${slotId}=iniLoadCsi${isAmpSuffix}.${deltaTime}`;\n  config['requests']['renderStartCsi'] = baseCsiUrl +\n      `&met.a4a.${slotId}=renderStartCsi${isAmpSuffix}.${deltaTime}`;\n\n  // Add CSI ping for visibility.\n  config['requests']['visibilityCsi'] = baseCsiUrl +\n      `&met.a4a.${slotId}=visibilityCsi.${deltaTime}`;\n  config['triggers']['continuousVisible']['request'].push('visibilityCsi');\n  return config;\n}\n\n/**\n * Returns an array of two-letter codes representing the amp-ad containers\n * enclosing the given ad element.\n *\n * @param {!Element} adElement\n * @return {!Array<string>}\n */\nexport function getEnclosingContainerTypes(adElement) {\n  const containerTypeSet = {};\n  for (let el = adElement.parentElement, counter = 0;\n    el && counter < 20; el = el.parentElement, counter++) {\n    const tagName = el.tagName.toUpperCase();\n    if (ValidAdContainerTypes[tagName]) {\n      containerTypeSet[ValidAdContainerTypes[tagName]] = true;\n    }\n  }\n  return Object.keys(containerTypeSet);\n}\n\n/**\n * Appends parameter to ad request indicating error state so long as error\n * parameter is not already present or url has been truncated.\n * @param {string} adUrl used for network request\n * @param {string} parameterValue to be appended\n * @return {string|undefined} potentially modified url, undefined\n */\nexport function maybeAppendErrorParameter(adUrl, parameterValue) {\n  dev().assert(!!adUrl && !!parameterValue);\n  // Add parameter indicating error so long as the url has not already been\n  // truncated and error parameter is not already present.  Note that we assume\n  // that added, error parameter length will be less than truncation parameter\n  // so adding will not cause length to exceed maximum.\n  if (new RegExp(`[?|&](${encodeURIComponent(TRUNCATION_PARAM.name)}=` +\n      `${encodeURIComponent(String(TRUNCATION_PARAM.value))}|aet=[^&]*)$`)\n      .test(adUrl)) {\n    return;\n  }\n  const modifiedAdUrl = adUrl + `&aet=${parameterValue}`;\n  dev().assert(modifiedAdUrl.length <= MAX_URL_LENGTH);\n  return modifiedAdUrl;\n}\n\n/**\n * Returns a numerical code representing the binary type.\n * @param {string} type\n * @return {?string}\n */\nexport function getBinaryTypeNumericalCode(type) {\n  return {\n    'production': '0',\n    'control': '1',\n    'canary': '2',\n  }[type] || null;\n}\n\n/** @const {!RegExp} */\nconst IDENTITY_DOMAIN_REGEXP_ = /\\.google\\.(?:com?\\.)?[a-z]{2,3}$/;\n\n/** @typedef {{\n      token: (string|undefined),\n      jar: (string|undefined),\n      pucrd: (string|undefined),\n      freshLifetimeSecs: (number|undefined),\n      validLifetimeSecs: (number|undefined),\n      fetchTimeMs: (number|undefined)\n   }} */\nexport let IdentityToken;\n\n/**\n * @param {!Window} win\n * @param {!Element|!../../../src/service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @return {!Promise<!IdentityToken>}\n */\nexport function getIdentityToken(win, elementOrAmpDoc) {\n  win['goog_identity_prom'] = win['goog_identity_prom'] ||\n      executeIdentityTokenFetch(win, elementOrAmpDoc);\n  return /** @type {!Promise<!IdentityToken>} */(win['goog_identity_prom']);\n}\n\n/**\n * @param {!Window} win\n * @param {!Element|!../../../src/service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {number=} redirectsRemaining (default 1)\n * @param {string=} domain\n * @param {number=} startTime\n * @return {!Promise<!IdentityToken>}\n */\nfunction executeIdentityTokenFetch(win, elementOrAmpDoc, redirectsRemaining = 1,\n  domain = undefined, startTime = Date.now()) {\n  const url = getIdentityTokenRequestUrl(win, elementOrAmpDoc, domain);\n  return Services.xhrFor(win).fetchJson(url, {\n    mode: 'cors',\n    method: 'GET',\n    ampCors: false,\n    credentials: 'include',\n  }).then(res => res.json())\n      .then(obj => {\n        const token = obj['newToken'];\n        const jar = obj['1p_jar'] || '';\n        const pucrd = obj['pucrd'] || '';\n        const freshLifetimeSecs = parseInt(obj['freshLifetimeSecs'] || '', 10);\n        const validLifetimeSecs = parseInt(obj['validLifetimeSecs'] || '', 10);\n        const altDomain = obj['altDomain'];\n        const fetchTimeMs = Date.now() - startTime;\n        if (IDENTITY_DOMAIN_REGEXP_.test(altDomain)) {\n          if (!redirectsRemaining--) {\n            // Max redirects, log?\n            return {fetchTimeMs};\n          }\n          return executeIdentityTokenFetch(\n              win, elementOrAmpDoc, redirectsRemaining, altDomain, startTime);\n        } else if (freshLifetimeSecs > 0 && validLifetimeSecs > 0 &&\n            typeof token == 'string') {\n          return {token, jar, pucrd, freshLifetimeSecs, validLifetimeSecs,\n            fetchTimeMs};\n        }\n        // returning empty\n        return {fetchTimeMs};\n      })\n      .catch(unusedErr => {\n        // TODO log?\n        return {};\n      });\n}\n\n/**\n * @param {!Window} win\n * @param {!Element|!../../../src/service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string=} domain\n * @return {string} url\n * @visibleForTesting\n */\nexport function getIdentityTokenRequestUrl(win, elementOrAmpDoc,\n  domain = undefined) {\n  if (!domain && win != win.top && win.location.ancestorOrigins) {\n    const matches = IDENTITY_DOMAIN_REGEXP_.exec(\n        win.location.ancestorOrigins[win.location.ancestorOrigins.length - 1]);\n    domain = (matches && matches[0]) || undefined;\n  }\n  domain = domain || '.google.com';\n  const canonical =\n    extractHost(Services.documentInfoForDoc(elementOrAmpDoc).canonicalUrl);\n  return `https://adservice${domain}/adsid/integrator.json?domain=${canonical}`;\n}\n\n/**\n * Returns whether we are running on the AMP CDN.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isCdnProxy(win) {\n  return CDN_PROXY_REGEXP.test(win.location.origin);\n}\n\n/**\n * Populates the fields of the given Nameframe experiment config object.\n * @param {!../../../src/utils/xhr-utils.FetchResponseHeaders} headers\n * @param {!NameframeExperimentConfig} nameframeConfig\n */\nexport function setNameframeExperimentConfigs(headers, nameframeConfig) {\n  const nameframeExperimentHeader = headers.get('amp-nameframe-exp');\n  if (nameframeExperimentHeader) {\n    nameframeExperimentHeader.split(';').forEach(config => {\n      if (config == 'instantLoad' || config == 'writeInBody') {\n        nameframeConfig[config] = true;\n      }\n    });\n  }\n}\n\n/**\n * Enum for browser capabilities. NOTE: Since JS is 32-bit, do not add anymore\n * than 32 capabilities to this enum.\n * @enum {number}\n */\nconst Capability = {\n  SVG_SUPPORTED: 1 << 0,\n  SANDBOXING_ALLOW_TOP_NAVIGATION_BY_USER_ACTIVATION_SUPPORTED: 1 << 1,\n  SANDBOXING_ALLOW_POPUPS_TO_ESCAPE_SANDBOX_SUPPORTED: 1 << 2,\n};\n\n/**\n * Returns a bitmap representing what features are supported by this browser.\n * @param {!Window} win\n * @return {number}\n */\nfunction getBrowserCapabilitiesBitmap(win) {\n  let browserCapabilities = 0;\n  const doc = win.document;\n  if (win.SVGElement && doc.createElementNS) {\n    browserCapabilities |= Capability.SVG_SUPPORTED;\n  }\n  const iframeEl = doc.createElement('iframe');\n  if (iframeEl.sandbox && iframeEl.sandbox.supports) {\n    if (iframeEl.sandbox.supports('allow-top-navigation-by-user-activation')) {\n      browserCapabilities |=\n        Capability.SANDBOXING_ALLOW_TOP_NAVIGATION_BY_USER_ACTIVATION_SUPPORTED;\n    }\n    if (iframeEl.sandbox.supports('allow-popups-to-escape-sandbox')) {\n      browserCapabilities |=\n        Capability.SANDBOXING_ALLOW_POPUPS_TO_ESCAPE_SANDBOX_SUPPORTED;\n    }\n  }\n  return browserCapabilities;\n}\n\n/**\n * Returns an enum value representing the AMP binary type, or null if this is a\n * canonical page.\n * @param {!Window} win\n * @return {?string} The binary type enum.\n * @visibleForTesting\n */\nexport function getAmpRuntimeTypeParameter(win) {\n  const art = getBinaryTypeNumericalCode(getBinaryType(win));\n  return isCdnProxy(win) && art != '0' ? art : null;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {user} from '../../src/log';\n\n/**\n * Approved height for AdSense full-width responsive ads.\n * @const {number}\n */\nexport const ADSENSE_RSPV_WHITELISTED_HEIGHT = 320;\n\n/**\n * Given the amp-ad data attribute containing the multi-size dimensions, and a\n * set of primary dimensions, this function will return all valid multi-size\n * [width, height] pairs in an array.\n *\n * @param {string} multiSizeDataStr The amp-ad data attribute containing the\n *   multi-size dimensions.\n * @param {number} primaryWidth The primary width of the ad slot.\n * @param {number} primaryHeight The primary height of the ad slot.\n * @param {boolean} multiSizeValidation A flag that if set to true will enforce\n *   the rule that ensures multi-size dimensions are no less than 2/3rds of\n *   their primary dimension's counterpart.\n * @param {boolean=} isFluid Indicates whether this ad slot is Fluid-enabled.\n * @return {?Array<!Array<number>>} An array of dimensions.\n */\nexport function getMultiSizeDimensions(\n  multiSizeDataStr,\n  primaryWidth,\n  primaryHeight,\n  multiSizeValidation,\n  isFluid = false) {\n\n  const dimensions = [];\n  const arrayOfSizeStrs = multiSizeDataStr.split(',');\n\n  for (let i = 0; i < arrayOfSizeStrs.length; i++) {\n\n    const sizeStr = arrayOfSizeStrs[i];\n    const size = sizeStr.split('x');\n\n    // Make sure that each size is specified in the form WxH.\n    if (size.length != 2) {\n      user().error('AMP-AD', `Invalid multi-size data format '${sizeStr}'.`);\n      continue;\n    }\n\n    const width = Number(size[0]);\n    const height = Number(size[1]);\n\n    // Make sure that both dimensions given are positive numbers.\n    if (!validateDimensions(width, height,\n        w => isNaN(w) || w <= 0,\n        h => isNaN(h) || h <= 0,\n        badParams => badParams.map(badParam =>\n          `Invalid ${badParam.dim} of ${badParam.val} ` +\n            'given for secondary size.').join(' '))) {\n      continue;\n    }\n\n    // Check that secondary size is not larger than primary size.\n    if (!isFluid && !validateDimensions(width, height,\n        w => w > primaryWidth,\n        h => h > primaryHeight,\n        badParams => badParams.map(badParam =>\n          `Secondary ${badParam.dim} ${badParam.val} ` +\n            `can't be larger than the primary ${badParam.dim}.`).join(' '))) {\n      continue;\n    }\n\n    // Check that if multi-size-validation is on, that the secondary sizes\n    // are at least minRatio of the primary size.\n    if (multiSizeValidation) {\n      // The minimum ratio of each secondary dimension to its corresponding\n      // primary dimension.\n      const minRatio = 2 / 3;\n      const minWidth = minRatio * primaryWidth;\n      const minHeight = minRatio * primaryHeight;\n      if (!validateDimensions(width, height,\n          w => w < minWidth,\n          h => h < minHeight,\n          badParams => badParams.map(badParam =>\n            `Secondary ${badParam.dim} ${badParam.val} is ` +\n              `smaller than 2/3rds of the primary ${badParam.dim}.`)\n              .join(' '))) {\n        continue;\n      }\n    }\n\n    // Passed all checks! Push additional size to dimensions.\n    dimensions.push([width, height]);\n  }\n\n  return dimensions;\n}\n\n/**\n * A helper function for determining whether a given width or height violates\n * some condition.\n *\n * Checks the width and height against their corresponding conditions. If\n * either of the conditions fail, the errorBuilder function will be called with\n * the appropriate arguments, its result will be logged to user().error, and\n * validateDimensions will return false. Otherwise, validateDimensions will\n * only return true.\n *\n * @param {(number|string)} width\n * @param {(number|string)} height\n * @param {function((number|string)): boolean} widthCond\n * @param {function((number|string)): boolean} heightCond\n * @param {function(!Array<{dim: string, val: (number|string)}>): string=} errorBuilder\n * A function that will produce an informative error message.\n * @return {boolean}\n */\nfunction validateDimensions(width, height, widthCond, heightCond, errorBuilder)\n{\n  const badParams = [];\n  if (widthCond(width)) {\n    badParams.push({dim: 'width', val: width});\n  }\n  if (heightCond(height)) {\n    badParams.push({dim: 'height', val: height});\n  }\n  if (badParams.length) {\n    user().warn('AMP-AD', errorBuilder(badParams));\n  }\n  return !badParams.length;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from '../../../src/services';\nimport {\n  VariableSource,\n  getNavigationData,\n  getTimingDataAsync,\n  getTimingDataSync,\n} from '../../../src/service/variable-source';\nimport {user} from '../../../src/log';\n\n\nconst WHITELISTED_VARIABLES = [\n  'AMPDOC_HOST',\n  'AMPDOC_HOSTNAME',\n  'AMPDOC_URL',\n  'AMP_VERSION',\n  'AVAILABLE_SCREEN_HEIGHT',\n  'AVAILABLE_SCREEN_WIDTH',\n  'BACKGROUND_STATE',\n  'BROWSER_LANGUAGE',\n  'CANONICAL_HOST',\n  'CANONICAL_HOSTNAME',\n  'CANONICAL_PATH',\n  'CANONICAL_URL',\n  'CLIENT_ID',\n  'COUNTER',\n  'DOCUMENT_CHARSET',\n  'DOCUMENT_REFERRER',\n  'FIRST_CONTENTFUL_PAINT',\n  'FIRST_VIEWPORT_READY',\n  'MAKE_BODY_VISIBLE',\n  'PAGE_VIEW_ID',\n  'RANDOM',\n  'SCREEN_COLOR_DEPTH',\n  'SCREEN_HEIGHT',\n  'SCREEN_WIDTH',\n  'SCROLL_HEIGHT',\n  'SCROLL_LEFT',\n  'SCROLL_TOP',\n  'SCROLL_WIDTH',\n  'SHARE_TRACKING_INCOMING',\n  'SHARE_TRACKING_OUTGOING',\n  'SOURCE_HOST',\n  'SOURCE_HOSTNAME',\n  'SOURCE_PATH',\n  'SOURCE_URL',\n  'TIMESTAMP',\n  'TIMEZONE',\n  'TIMEZONE_CODE',\n  'TITLE',\n  'TOTAL_ENGAGED_TIME',\n  'USER_AGENT',\n  'VARIANT',\n  'VARIANTS',\n  'VIEWER',\n  'VIEWPORT_HEIGHT',\n  'VIEWPORT_WIDTH',\n];\n\n/** Provides A4A specific variable substitution. */\nexport class A4AVariableSource extends VariableSource {\n  /**\n   * @param  {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n   * @param  {!Window} embedWin\n   */\n  constructor(ampdoc, embedWin) {\n    super(ampdoc);\n    /** @private {VariableSource} global variable source for fallback. */\n    this.globalVariableSource_ = Services.urlReplacementsForDoc(ampdoc)\n        .getVariableSource();\n\n    /** @private {!Window} */\n    this.win_ = embedWin;\n  }\n\n  /** @override */\n  initialize() {\n    this.set('AD_NAV_TIMING', (startAttribute, endAttribute) => {\n      user().assert(startAttribute, 'The first argument to AD_NAV_TIMING, the' +\n          ' start attribute name, is required');\n      return getTimingDataSync(\n          this.win_,\n          /**@type {string}*/(startAttribute),\n          /**@type {string}*/(endAttribute));\n    }).setAsync('AD_NAV_TIMING', (startAttribute, endAttribute) => {\n      user().assert(startAttribute, 'The first argument to AD_NAV_TIMING, the' +\n          ' start attribute name, is required');\n      return getTimingDataAsync(\n          this.win_,\n          /**@type {string}*/(startAttribute),\n          /**@type {string}*/(endAttribute));\n    });\n\n    this.set('AD_NAV_TYPE', () => {\n      return getNavigationData(this.win_, 'type');\n    });\n\n    this.set('AD_NAV_REDIRECT_COUNT', () => {\n      return getNavigationData(this.win_, 'redirectCount');\n    });\n\n    this.set('HTML_ATTR',\n        /** @type {function(...*)} */(this.htmlAttributeBinding_.bind(this)));\n\n    for (let v = 0; v < WHITELISTED_VARIABLES.length; v++) {\n      const varName = WHITELISTED_VARIABLES[v];\n      const resolvers = this.globalVariableSource_.get(varName);\n      this.set(varName, resolvers.sync).setAsync(varName, resolvers.async);\n    }\n  }\n\n  /**\n   * Provides a binding for getting attributes from the DOM.\n   * Most such bindings are provided in src/service/url-replacements-impl, but\n   * this one needs access to this.win_.document, which if the amp-analytics\n   * tag is contained within an amp-ad tag will NOT be the parent/publisher\n   * page. Hence the need to put it here.\n   * @param {string} cssSelector Elements matching this selector will be\n   *     included, provided they have at least one of the attributeNames\n   *     set, up to a max of 10. May be URI encoded.\n   * @param {...string} var_args Additional params will be the names of\n   *     attributes whose values will be returned. There should be at least 1.\n   * @return {string} A stringified JSON array containing one member for each\n   *     matching element. Each member will contain the names and values of the\n   *     specified attributes, if the corresponding element has that attribute.\n   *     Note that if an element matches the cssSelected but has none of the\n   *     requested attributes, then nothing will be included in the array\n   *     for that element.\n   */\n  htmlAttributeBinding_(cssSelector, var_args) {\n    // Generate an error if cssSelector matches more than this many elements\n    const HTML_ATTR_MAX_ELEMENTS_TO_TRAVERSE = 20;\n\n    // Of the elements matched by cssSelector, see which contain one or more\n    // of the specified attributes, and return an array of at most this many.\n    const HTML_ATTR_MAX_ELEMENTS_TO_RETURN = 10;\n\n    // Only allow at most this many attributeNames to be specified.\n    const HTML_ATTR_MAX_ATTRS = 10;\n\n    const TAG = 'A4AVariableSource';\n\n    const attributeNames = Array.prototype.slice.call(arguments, 1);\n    if (!cssSelector || !attributeNames.length) {\n      return '[]';\n    }\n    if (attributeNames.length > HTML_ATTR_MAX_ATTRS) {\n      user().error(TAG, `At most ${HTML_ATTR_MAX_ATTRS} may be requested.`);\n      return '[]';\n    }\n    cssSelector = decodeURI(cssSelector);\n    let elements;\n    try {\n      elements = this.win_.document.querySelectorAll(cssSelector);\n    } catch (e) {\n      user().error(TAG, `Invalid selector: ${cssSelector}`);\n      return '[]';\n    }\n    if (elements.length > HTML_ATTR_MAX_ELEMENTS_TO_TRAVERSE) {\n      user().error(TAG, 'CSS selector may match at most ' +\n          `${HTML_ATTR_MAX_ELEMENTS_TO_TRAVERSE} elements.`);\n      return '[]';\n    }\n    const result = [];\n    for (let i = 0; i < elements.length &&\n        result.length < HTML_ATTR_MAX_ELEMENTS_TO_RETURN; ++i) {\n      const currentResult = {};\n      let foundAtLeastOneAttr = false;\n      for (let j = 0; j < attributeNames.length; ++j) {\n        const attributeName = attributeNames[j];\n        if (elements[i].hasAttribute(attributeName)) {\n          currentResult[attributeName] =\n              elements[i].getAttribute(attributeName);\n          foundAtLeastOneAttr = true;\n        }\n      }\n      if (foundAtLeastOneAttr) {\n        result.push(currentResult);\n      }\n    }\n    return JSON.stringify(result);\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {A4AVariableSource} from './a4a-variable-source';\nimport {\n  CONSENT_POLICY_STATE, // eslint-disable-line no-unused-vars\n} from '../../../src/consent-state';\nimport {Layout, isLayoutSizeDefined} from '../../../src/layout';\nimport {LayoutPriority} from '../../../src/layout';\nimport {Services} from '../../../src/services';\nimport {SignatureVerifier, VerificationStatus} from './signature-verifier';\nimport {\n  assertHttpsUrl,\n  tryDecodeUriComponent,\n} from '../../../src/url';\nimport {cancellation, isCancellation} from '../../../src/error';\nimport {createElementWithAttributes} from '../../../src/dom';\nimport {dev, duplicateErrorIfNecessary, user} from '../../../src/log';\nimport {dict} from '../../../src/utils/object';\nimport {\n  generateSentinel,\n  getDefaultBootstrapBaseUrl,\n} from '../../../src/3p-frame';\nimport {\n  getAmpAdRenderOutsideViewport,\n  incrementLoadingAds,\n  is3pThrottled,\n} from '../../amp-ad/0.1/concurrent-load';\nimport {getBinaryType} from '../../../src/experiments';\nimport {getBinaryTypeNumericalCode} from '../../../ads/google/a4a/utils';\nimport {getConsentPolicyState} from '../../../src/consent';\nimport {getContextMetadata} from '../../../src/iframe-attributes';\nimport {getMode} from '../../../src/mode';\nimport {insertAnalyticsElement} from '../../../src/extension-analytics';\nimport {\n  installFriendlyIframeEmbed,\n  setFriendlyIframeEmbedVisible,\n} from '../../../src/friendly-iframe-embed';\nimport {\n  installUrlReplacementsForEmbed,\n} from '../../../src/service/url-replacements-impl';\nimport {isAdPositionAllowed} from '../../../src/ad-helper';\nimport {isArray, isEnumValue, isObject} from '../../../src/types';\nimport {isExperimentOn} from '../../../src/experiments';\nimport {parseJson} from '../../../src/json';\nimport {setStyle} from '../../../src/style';\nimport {signingServerURLs} from '../../../ads/_a4a-config';\nimport {triggerAnalyticsEvent} from '../../../src/analytics';\nimport {tryResolve} from '../../../src/utils/promise';\nimport {utf8Decode} from '../../../src/utils/bytes';\n\n/** @type {Array<string>} */\nconst METADATA_STRINGS = [\n  '<script amp-ad-metadata type=application/json>',\n  '<script type=\"application/json\" amp-ad-metadata>',\n  '<script type=application/json amp-ad-metadata>'];\n\n// TODO(tdrl): Temporary, while we're verifying whether SafeFrame is an\n// acceptable solution to the 'Safari on iOS doesn't fetch iframe src from\n// cache' issue.  See https://github.com/ampproject/amphtml/issues/5614\n/** @type {string} */\nexport const DEFAULT_SAFEFRAME_VERSION = '1-0-23';\n\n/** @const {string} */\nexport const CREATIVE_SIZE_HEADER = 'X-CreativeSize';\n\n/** @type {string} @visibleForTesting */\nexport const RENDERING_TYPE_HEADER = 'X-AmpAdRender';\n\n/** @type {string} @visibleForTesting */\nexport const SAFEFRAME_VERSION_HEADER = 'X-AmpSafeFrameVersion';\n\n/** @type {string} @visibleForTesting */\nexport const EXPERIMENT_FEATURE_HEADER_NAME = 'amp-ff-exps';\n\n/** @type {string} @visibileForTesting */\nexport const SANDBOX_HEADER = 'amp-ff-sandbox';\n\n/** @type {string} */\nconst TAG = 'amp-a4a';\n\n/** @type {string} */\nexport const NO_CONTENT_RESPONSE = 'NO-CONTENT-RESPONSE';\n\n/** @type {string} */\nexport const NETWORK_FAILURE = 'NETWORK-FAILURE';\n\n/** @type {string} */\nexport const INVALID_SPSA_RESPONSE = 'INVALID-SPSA-RESPONSE';\n\n/** @type {string} */\nexport const IFRAME_GET = 'IFRAME-GET';\n\n/** @enum {string} */\nexport const XORIGIN_MODE = {\n  CLIENT_CACHE: 'client_cache',\n  SAFEFRAME: 'safeframe',\n  NAMEFRAME: 'nameframe',\n  IFRAME_GET: 'iframe_get',\n};\n\n/** @type {!Object} @private */\nconst SHARED_IFRAME_PROPERTIES = dict({\n  'frameborder': '0',\n  'allowfullscreen': '',\n  'allowtransparency': '',\n  'scrolling': 'no',\n  'marginwidth': '0',\n  'marginheight': '0',\n});\n\n/** @typedef {{width: number, height: number}} */\nexport let SizeInfoDef;\n\n/** @typedef {{\n      minifiedCreative: string,\n      customElementExtensions: !Array<string>,\n      customStylesheets: !Array<{href: string}>,\n      images: (Array<string>|undefined),\n      ctaType: (string|undefined),\n      ctaUrl: (string|undefined),\n    }} */\nexport let CreativeMetaDataDef;\n\n/**\n * Name of A4A lifecycle triggers.\n * @enum {string}\n */\nexport const AnalyticsTrigger = {\n  AD_REQUEST_START: 'ad-request-start',\n  AD_RESPONSE_END: 'ad-response-end',\n  AD_RENDER_START: 'ad-render-start',\n  AD_RENDER_END: 'ad-render-end',\n  AD_IFRAME_LOADED: 'ad-iframe-loaded',\n  // This trigger is not part of the normal ads lifecycle and only fires when an\n  // ad is refreshed.\n  AD_REFRESH: 'ad-refresh',\n};\n\n/**\n * Maps the names of lifecycle events to analytics triggers.\n * @const {!Object<string, !AnalyticsTrigger>}\n */\nconst LIFECYCLE_STAGE_TO_ANALYTICS_TRIGGER = {\n  'adRequestStart': AnalyticsTrigger.AD_REQUEST_START,\n  'adRequestEnd': AnalyticsTrigger.AD_RESPONSE_END,\n  'renderFriendlyStart': AnalyticsTrigger.AD_RENDER_START,\n  'renderCrossDomainStart': AnalyticsTrigger.AD_RENDER_START,\n  'renderSafeFrameStart': AnalyticsTrigger.AD_RENDER_START,\n  'renderFriendlyEnd': AnalyticsTrigger.AD_RENDER_END,\n  'renderCrossDomainEnd': AnalyticsTrigger.AD_RENDER_END,\n  'friendlyIframeIniLoad': AnalyticsTrigger.AD_IFRAME_LOADED,\n  'crossDomainIframeLoaded': AnalyticsTrigger.AD_IFRAME_LOADED,\n};\n\n/**\n * The sandboxing flags to use when applying the \"sandbox\" attribute to ad\n * iframes. See http://go/mdn/HTML/Element/iframe#attr-sandbox.\n * @const {string} @visibleForTesting\n */\nexport const IFRAME_SANDBOXING_FLAGS = 'allow-forms allow-pointer-lock ' +\n    'allow-popups allow-popups-to-escape-sandbox allow-same-origin ' +\n    'allow-scripts allow-top-navigation-by-user-activation';\n\n/**\n * Utility function that ensures any error thrown is handled by optional\n * onError handler (if none provided or handler throws, error is swallowed and\n * undefined is returned).\n * @param {!Function} fn to protect\n * @param {T=} inThis An optional object to use as the 'this' object\n *    when calling the function.  If not provided, undefined is bound as this\n *    when calling function.\n * @param {function(this:T, !Error, ...*):?=} onError function given error\n *    and arguments provided to function call.\n * @return {!Function} protected function\n * @template T\n * @visibleForTesting\n */\nexport function protectFunctionWrapper(\n  fn, inThis = undefined, onError = undefined) {\n  return (...fnArgs) => {\n    try {\n      return fn.apply(inThis, fnArgs);\n    } catch (err) {\n      if (onError) {\n        try {\n          // Ideally we could use [err, ...var_args] but linter disallows\n          // spread so instead using unshift :(\n          fnArgs.unshift(err);\n          return onError.apply(inThis, fnArgs);\n        } catch (captureErr) {\n          // swallow error if error handler throws.\n        }\n      }\n      // In the event of no optional on error function or its execution throws,\n      // return undefined.\n      return undefined;\n    }\n  };\n}\n\n/** Abstract class for AMP Ad Fast Fetch enabled networks */\nexport class AmpA4A extends AMP.BaseElement {\n  // TODO: Add more error handling throughout code.\n  // TODO: Handle creatives that do not fill.\n\n  /**\n   * @param {!Element} element\n   */\n  constructor(element) {\n    super(element);\n    dev().assert(AMP.AmpAdUIHandler);\n    dev().assert(AMP.AmpAdXOriginIframeHandler);\n\n    /** @private {?Promise<undefined>} */\n    this.keysetPromise_ = null;\n\n    /** @private {?Promise<?CreativeMetaDataDef>} */\n    this.adPromise_ = null;\n\n    /**\n     * @private {number} unique ID of the currently executing promise to allow\n     * for cancellation.\n     */\n    this.promiseId_ = 0;\n\n    /** @private {?string} */\n    this.adUrl_ = null;\n\n    /** @private {?../../../src/friendly-iframe-embed.FriendlyIframeEmbed} */\n    this.friendlyIframeEmbed_ = null;\n\n    /** {?AMP.AmpAdUIHandler} */\n    this.uiHandler = null;\n\n    /** @private {?AMP.AmpAdXOriginIframeHandler} */\n    this.xOriginIframeHandler_ = null;\n\n    /** @private {boolean} whether creative has been verified as AMP */\n    this.isVerifiedAmpCreative_ = false;\n\n    /** @private {?ArrayBuffer} */\n    this.creativeBody_ = null;\n\n    /**\n     * Initialize this with the slot width/height attributes, and override\n     * later with what the network implementation returns via extractSize.\n     * Note: Either value may be 'auto' (i.e., non-numeric).\n     *\n     * @private {?({width, height}|../../../src/layout-rect.LayoutRectDef)}\n     */\n    this.creativeSize_ = null;\n\n    /** @private {?../../../src/layout-rect.LayoutRectDef} */\n    this.originalSlotSize_ = null;\n\n    /**\n     * Note(keithwrightbos) - ensure the default here is null so that ios\n     * uses safeframe when response header is not specified.\n     * @private {?XORIGIN_MODE}\n     */\n    this.experimentalNonAmpCreativeRenderMethod_ =\n        this.getNonAmpCreativeRenderingMethod();\n\n    /**\n     * Whether or not the iframe containing the ad should be sandboxed via the\n     * \"sandbox\" attribute.\n     * @private {boolean}\n     */\n    this.shouldSandbox_ = false;\n\n    /**\n     * Gets a notion of current time, in ms.  The value is not necessarily\n     * absolute, so should be used only for computing deltas.  When available,\n     * the performance system will be used; otherwise Date.now() will be\n     * returned.\n     *\n     * @const {function():number}\n     */\n    this.getNow_ = (this.win.performance && this.win.performance.now) ?\n      this.win.performance.now.bind(this.win.performance) : Date.now;\n\n    /** @const {string} */\n    this.sentinel = generateSentinel(window);\n\n    /**\n     * Used to indicate whether this slot should be collapsed or not. Marked\n     * true if the ad response has status 204, is null, or has a null\n     * arrayBuffer.\n     * @private {boolean}\n     */\n    this.isCollapsed_ = false;\n\n    /**\n     * Frame in which the creative renders (friendly if validated AMP, xdomain\n     * otherwise).\n     * {?HTMLIframeElement}\n     */\n    this.iframe = null;\n\n    /**\n     * TODO(keithwrightbos) - remove once resume behavior is verified.\n     * {boolean} whether most recent ad request was generated as part\n     *    of resume callback.\n     */\n    this.fromResumeCallback = false;\n\n    /** @type {string} */\n    this.safeframeVersion = DEFAULT_SAFEFRAME_VERSION;\n\n    /**\n     * @protected {boolean} Indicates whether the ad is currently in the\n     *    process of being refreshed.\n     */\n    this.isRefreshing = false;\n\n    /** @protected {boolean} */\n    this.isRelayoutNeededFlag = false;\n\n    /**\n     * Used as a signal in some of the CSI pings.\n     * @private @const {string}\n     */\n    this.releaseType_ = getBinaryTypeNumericalCode(getBinaryType(this.win)) ||\n        '-1';\n\n    /**\n     * Mapping of feature name to value extracted from ad response header\n     * amp-ff-exps with comma separated pairs of '=' separated key/value.\n     * @type {!Object<string,string>}\n     */\n    this.postAdResponseExperimentFeatures = {};\n\n    /**\n     * The configuration for amp-analytics. If null, no amp-analytics element\n     * will be inserted and no analytics events will be fired.\n     * This will be initialized inside of buildCallback.\n     * @private {?JsonObject}\n     */\n    this.a4aAnalyticsConfig_ = null;\n\n    /**\n     * The amp-analytics element that for this impl's analytics config. It will\n     * be null before buildCallback() executes or if the impl does not provide\n     * an analytice config.\n     * @private {?Element}\n     * @visibleForTesting\n     */\n    this.a4aAnalyticsElement_ = null;\n\n    /**\n     * Indicates that this slot is a single page ad within an AMP story.\n     * @type {boolean}\n     */\n    this.isSinglePageStoryAd = false;\n  }\n\n  /** @override */\n  getLayoutPriority() {\n    // Priority used for scheduling preload and layout callback.  Because\n    // AMP creatives will be injected as part of the promise chain created\n    // within onLayoutMeasure, this is only relevant to non-AMP creatives\n    // therefore we want this to match the 3p priority.\n    const isPWA = !this.element.getAmpDoc().isSingleDoc();\n    // give the ad higher priority if it is inside a PWA\n    return isPWA ? LayoutPriority.METADATA : LayoutPriority.ADS;\n  }\n\n  /** @override */\n  isLayoutSupported(layout) {\n    return isLayoutSizeDefined(layout);\n  }\n\n  /** @override */\n  isRelayoutNeeded() {\n    return this.isRelayoutNeededFlag;\n  }\n\n  /** @override */\n  buildCallback() {\n    this.creativeSize_ = {\n      width: this.element.getAttribute('width'),\n      height: this.element.getAttribute('height'),\n    };\n    const upgradeDelayMs = Math.round(this.getResource().getUpgradeDelayMs());\n    dev().info(TAG,\n        `upgradeDelay ${this.element.getAttribute('type')}: ${upgradeDelayMs}`);\n\n    this.uiHandler = new AMP.AmpAdUIHandler(this);\n\n    const verifier = signatureVerifierFor(this.win);\n    this.keysetPromise_ =\n        Services.viewerForDoc(this.getAmpDoc()).whenFirstVisible().then(() => {\n          this.getSigningServiceNames().forEach(signingServiceName => {\n            verifier.loadKeyset(signingServiceName);\n          });\n        });\n\n    this.a4aAnalyticsConfig_ = this.getA4aAnalyticsConfig();\n    if (this.a4aAnalyticsConfig_) {\n      // TODO(warrengm): Consider having page-level singletons for networks that\n      // use the same config for all ads.\n      this.a4aAnalyticsElement_ = insertAnalyticsElement(\n          this.element, this.a4aAnalyticsConfig_, true /* loadAnalytics */);\n    }\n\n    this.isSinglePageStoryAd = this.element.hasAttribute('amp-story');\n  }\n\n  /** @override */\n  renderOutsideViewport() {\n    // Ensure non-verified AMP creatives are throttled.\n    if (!this.isVerifiedAmpCreative_ && is3pThrottled(this.win) &&\n        !this.inNonAmpPreferenceExp()) {\n      return false;\n    }\n    // Otherwise the ad is good to go.\n    const elementCheck = getAmpAdRenderOutsideViewport(this.element);\n    return elementCheck !== null ?\n      elementCheck : super.renderOutsideViewport();\n  }\n\n  /**\n   * To be overridden by network specific implementation indicating if element\n   * (and environment generally) are valid for sending XHR queries.\n   * @return {boolean} whether element is valid and ad request should be\n   *    sent.  If false, no ad request is sent and slot will be collapsed if\n   *    possible.\n   */\n  isValidElement() {\n    return true;\n  }\n\n  /**\n   * Returns the creativeSize, which is the size extracted from the ad response.\n   * @return {?({width, height}|../../../src/layout-rect.LayoutRectDef)}\n   */\n  getCreativeSize() {\n    return this.creativeSize_;\n  }\n\n  /**\n   * @return {boolean|number} whether ad request should be delayed until\n   *    renderOutsideViewport is met or if number, the amount of viewports.\n   */\n  delayAdRequestEnabled() {\n    return false;\n  }\n\n  /**\n   * Returns preconnect urls for A4A. Ad network should overwrite in their\n   * Fast Fetch implementation and return an array of urls for the runtime to\n   * preconnect to.\n   * @return {!Array<string>}\n   */\n  getPreconnectUrls() {\n    return [];\n  }\n\n  /**\n   * Returns prefetch urls for A4A. Ad network should overwrite in their\n   * Fast Fetch implementation and return an array of urls for the runtime to\n   * prefetch.\n   * @return {!Array<string>}\n   */\n  getPrefetchUrls() {\n    return [];\n  }\n\n  /**\n   * Returns true if this element was loaded from an amp-ad element.  For use by\n   * network-specific implementations that don't want to allow themselves to be\n   * embedded directly into a page.\n   * @return {boolean}\n   */\n  isAmpAdElement() {\n    return this.element.tagName == 'AMP-AD' ||\n        this.element.tagName == 'AMP-EMBED';\n  }\n\n  /**\n   * Prefetches and preconnects URLs related to the ad using adPreconnect\n   * registration which assumes ad request domain used for 3p is applicable.\n   * @param {boolean=} unusedOnLayout\n   * @override\n   */\n  preconnectCallback(unusedOnLayout) {\n    const preconnect = this.getPreconnectUrls();\n    // NOTE(keithwrightbos): Does not take isValidElement into account so could\n    // preconnect unnecessarily, however it is assumed that isValidElement\n    // matches amp-ad loader predicate such that A4A impl does not load.\n    if (preconnect) {\n      preconnect.forEach(p => {\n        this.preconnect.url(p, /*opt_preloadAs*/true);\n      });\n    }\n  }\n\n  /** @override */\n  resumeCallback() {\n    // FIE that was not destroyed on unlayoutCallback does not require a new\n    // ad request.\n    if (this.friendlyIframeEmbed_) {\n      return;\n    }\n    this.fromResumeCallback = true;\n    // If layout of page has not changed, onLayoutMeasure will not be called\n    // so do so explicitly.\n    const resource = this.getResource();\n    if (resource.hasBeenMeasured() && !resource.isMeasureRequested()) {\n      this.onLayoutMeasure();\n    }\n  }\n\n  /**\n   * @return {!../../../src/service/resource.Resource}\n   * @visibleForTesting\n   */\n  getResource() {\n    return this.element.getResources().getResourceForElement(this.element);\n  }\n\n  /**\n   * @return {boolean} whether adPromise was initialized (indicator of\n   *    element validity).\n   * @protected\n   */\n  hasAdPromise() {\n    return !!this.adPromise_;\n  }\n\n  /**\n   * Should only be called after XHR response headers have been processed and\n   * postAdResponseExperimentFeatures is populated.\n   * @return {boolean} whether in experiment giving non-AMP creatives same\n   *    benefits as AMP (increased priority, no throttle)\n   * @visibleForTesting\n   */\n  inNonAmpPreferenceExp() {\n    return !!this.postAdResponseExperimentFeatures['pref_neutral_enabled'] &&\n      ['adsense', 'doubleclick'].includes(this.element.getAttribute('type'));\n  }\n\n  /**\n   * @return {boolean} whether environment/element should initialize ad request\n   *    promise chain.\n   * @private\n   */\n  shouldInitializePromiseChain_() {\n    const slotRect = this.getIntersectionElementLayoutBox();\n    if (this.getLayout() != Layout.FLUID &&\n        (slotRect.height == 0 || slotRect.width == 0)) {\n      dev().fine(\n          TAG, 'onLayoutMeasure canceled due height/width 0', this.element);\n      return false;\n    }\n    if (!isAdPositionAllowed(this.element, this.win)) {\n      user().warn(TAG, `<${this.element.tagName}> is not allowed to be ` +\n        `placed in elements with position:fixed: ${this.element}`);\n      return false;\n    }\n    // OnLayoutMeasure can be called when page is in prerender so delay until\n    // visible.  Assume that it is ok to call isValidElement as it should\n    // only being looking at window, immutable properties (i.e. location) and\n    // its element ancestry.\n    if (!this.isValidElement()) {\n      // TODO(kjwright): collapse?\n      user().warn(TAG, this.element.getAttribute('type'),\n          'Amp ad element ignored as invalid', this.element);\n      return false;\n    }\n    return true;\n  }\n\n  /** @override */\n  onLayoutMeasure() {\n    this.initiateAdRequest();\n  }\n\n  /**\n   * This is the entry point into the ad promise chain.\n   *\n   * Calling this function will initiate the following sequence of events: ad\n   * url construction, ad request issuance, creative verification, and metadata\n   * parsing.\n   *\n   * @protected\n   */\n  initiateAdRequest() {\n    if (this.xOriginIframeHandler_) {\n      this.xOriginIframeHandler_.onLayoutMeasure();\n    }\n    if (this.adPromise_ || !this.shouldInitializePromiseChain_()) {\n      return;\n    }\n\n    // Increment unique promise ID so that if its value changes within the\n    // promise chain due to cancel from unlayout, the promise will be rejected.\n    ++this.promiseId_;\n\n    // Shorthand for: reject promise if current promise chain is out of date.\n    const checkStillCurrent = this.verifyStillCurrent();\n\n    // Return value from this chain: True iff rendering was \"successful\"\n    // (i.e., shouldn't try to render later via iframe); false iff should\n    // try to render later in iframe.\n    // Cases to handle in this chain:\n    //   - Everything ok  => Render; return true\n    //   - Empty network response returned => Don't render; return true\n    //   - Can't parse creative out of response => Don't render; return false\n    //   - Can parse, but creative is empty => Don't render; return true\n    //   - Validation fails => return false\n    //   - Rendering fails => return false\n    //   - Chain cancelled => don't return; drop error\n    //   - Uncaught error otherwise => don't return; percolate error up\n    this.adPromise_ = Services.viewerForDoc(this.getAmpDoc()).whenFirstVisible()\n        .then(() => {\n          checkStillCurrent();\n          // See if experiment that delays request until slot is within\n          // renderOutsideViewport. Within render outside viewport will not\n          // resolve if already within viewport thus the check for already\n          // meeting the definition as opposed to waiting on the promise.\n          const delay = this.delayAdRequestEnabled();\n          if (delay) {\n            return this.getResource().whenWithinViewport(\n                typeof delay == 'number' ? delay :\n                  this.renderOutsideViewport());\n          }\n        })\n        // Possibly block on amp-consent.\n        /** @return {!Promise<?CONSENT_POLICY_STATE>} */\n        .then(() => {\n          checkStillCurrent();\n          const consentPolicyId = super.getConsentPolicy();\n          return consentPolicyId ?\n            getConsentPolicyState(this.getAmpDoc(), consentPolicyId)\n                .catch(err => {\n                  user().error(TAG, 'Error determining consent state', err);\n                  return CONSENT_POLICY_STATE.UNKNOWN;\n                }) : Promise.resolve(null);\n        })\n        // This block returns the ad URL, if one is available.\n        /** @return {!Promise<?string>} */\n        .then(consentState => {\n          checkStillCurrent();\n          return /** @type {!Promise<?string>} */(this.getAdUrl(\n              consentState, this.tryExecuteRealTimeConfig_(consentState)));\n        })\n        // This block returns the (possibly empty) response to the XHR request.\n        /** @return {!Promise<?Response>} */\n        .then(adUrl => {\n          checkStillCurrent();\n          this.adUrl_ = adUrl;\n          // If we should skip the XHR, we will instead request and render\n          // by simply writing a frame into the page using\n          // renderViaIframeGet\n          if (!this.isXhrAllowed() && !!this.adUrl_) {\n            this.experimentalNonAmpCreativeRenderMethod_ =\n                XORIGIN_MODE.IFRAME_GET;\n            return Promise.reject(IFRAME_GET);\n          }\n          return adUrl && this.sendXhrRequest(adUrl);\n        })\n        // The following block returns either the response (as a\n        // {bytes, headers} object), or null if no response is available /\n        // response is empty.\n        /** @return {?Promise<?{bytes: !ArrayBuffer, headers: !Headers}>} */\n        .then(fetchResponse => {\n          checkStillCurrent();\n          this.maybeTriggerAnalyticsEvent_('adRequestEnd');\n          // If the response is null (can occur for non-200 responses)  or\n          // arrayBuffer is null, force collapse.\n          if (!fetchResponse || !fetchResponse.arrayBuffer ||\n              fetchResponse.headers.has('amp-ff-empty-creative')) {\n            this.forceCollapse();\n            return Promise.reject(NO_CONTENT_RESPONSE);\n          }\n          if (fetchResponse.headers && fetchResponse.headers.has(\n              EXPERIMENT_FEATURE_HEADER_NAME)) {\n            this.populatePostAdResponseExperimentFeatures_(\n                fetchResponse.headers.get(EXPERIMENT_FEATURE_HEADER_NAME));\n          }\n          if (getMode().localDev && this.win.location &&\n              this.win.location.search) {\n            // Allow for setting experiment features via query param which\n            // will potentially override values returned in response.\n            const match = /(?:\\?|&)a4a_feat_exp=([^&]+)/.exec(\n                this.win.location.search);\n            if (match && match[1]) {\n              dev().info(TAG, `Using debug exp features: ${match[1]}`);\n              this.populatePostAdResponseExperimentFeatures_(\n                  tryDecodeUriComponent(match[1]));\n            }\n          }\n          // TODO(tdrl): Temporary, while we're verifying whether SafeFrame is\n          // an acceptable solution to the 'Safari on iOS doesn't fetch\n          // iframe src from cache' issue.  See\n          // https://github.com/ampproject/amphtml/issues/5614\n          const method = this.getNonAmpCreativeRenderingMethod(\n              fetchResponse.headers.get(RENDERING_TYPE_HEADER));\n          this.experimentalNonAmpCreativeRenderMethod_ = method;\n          if (this.experimentalNonAmpCreativeRenderMethod_ ==\n              XORIGIN_MODE.NAMEFRAME) {\n            this.preconnect.preload(\n                getDefaultBootstrapBaseUrl(this.win, 'nameframe'));\n          }\n          const browserSupportsSandbox = this.win.HTMLIFrameElement &&\n              'sandbox' in this.win.HTMLIFrameElement.prototype;\n          this.shouldSandbox_ = browserSupportsSandbox &&\n              fetchResponse.headers.get(SANDBOX_HEADER) == 'true';\n          const safeframeVersionHeader =\n            fetchResponse.headers.get(SAFEFRAME_VERSION_HEADER);\n          if (/^[0-9-]+$/.test(safeframeVersionHeader) &&\n              safeframeVersionHeader != DEFAULT_SAFEFRAME_VERSION) {\n            this.safeframeVersion = safeframeVersionHeader;\n            this.preconnect.preload(this.getSafeframePath());\n          }\n          // Note: Resolving a .then inside a .then because we need to capture\n          // two fields of fetchResponse, one of which is, itself, a promise,\n          // and one of which isn't.  If we just return\n          // fetchResponse.arrayBuffer(), the next step in the chain will\n          // resolve it to a concrete value, but we'll lose track of\n          // fetchResponse.headers.\n          return fetchResponse.arrayBuffer().then(bytes => {\n            if (bytes.byteLength == 0) {\n              // The server returned no content. Instead of displaying a blank\n              // rectangle, we collapse the slot instead.\n              this.forceCollapse();\n              return Promise.reject(NO_CONTENT_RESPONSE);\n            }\n            return {\n              bytes,\n              headers: fetchResponse.headers,\n            };\n          });\n        })\n        /** @return {!Promise<?ArrayBuffer>} */\n        .then(responseParts => {\n          checkStillCurrent();\n          // Keep a handle to the creative body so that we can render into\n          // SafeFrame or NameFrame later, if necessary.  TODO(tdrl): Temporary,\n          // while we\n          // assess whether this is the right solution to the Safari+iOS iframe\n          // src cache issue.  If we decide to keep a SafeFrame-like solution,\n          // we should restructure the promise chain to pass this info along\n          // more cleanly, without use of an object variable outside the chain.\n          if (!responseParts) {\n            return Promise.resolve();\n          }\n          const {bytes, headers} = responseParts;\n          const size = this.extractSize(responseParts.headers);\n          this.creativeSize_ = size || this.creativeSize_;\n          if (this.experimentalNonAmpCreativeRenderMethod_ !=\n              XORIGIN_MODE.CLIENT_CACHE &&\n              bytes) {\n            this.creativeBody_ = bytes;\n          }\n          return this.maybeValidateAmpCreative(bytes, headers);\n        })\n        .then(creative => {\n          checkStillCurrent();\n          // Need to know if creative was verified as part of render outside\n          // viewport but cannot wait on promise.  Sadly, need a state a\n          // variable.\n          this.isVerifiedAmpCreative_ = !!creative;\n          return creative && utf8Decode(creative);\n        })\n        // This block returns CreativeMetaDataDef iff the creative was verified\n        // as AMP and could be properly parsed for friendly iframe render.\n        /** @return {?CreativeMetaDataDef} */\n        .then(creativeDecoded => {\n          checkStillCurrent();\n          // Note: It's critical that #getAmpAdMetadata be called\n          // on precisely the same creative that was validated\n          // via #validateAdResponse_.  See GitHub issue\n          // https://github.com/ampproject/amphtml/issues/4187\n          let creativeMetaDataDef;\n          if (!creativeDecoded ||\n            !(creativeMetaDataDef = this.getAmpAdMetadata(creativeDecoded))) {\n            if (this.inNonAmpPreferenceExp()) {\n              // Experiment to give non-AMP creatives same benefits as AMP so\n              // update priority.\n              this.updateLayoutPriority(LayoutPriority.CONTENT);\n            }\n            return null;\n          }\n\n          // Update priority.\n          this.updateLayoutPriority(LayoutPriority.CONTENT);\n          // Load any extensions; do not wait on their promises as this\n          // is just to prefetch.\n          const extensions = Services.extensionsFor(this.win);\n          creativeMetaDataDef.customElementExtensions.forEach(\n              extensionId => extensions.preloadExtension(extensionId));\n          // Preload any fonts.\n          (creativeMetaDataDef.customStylesheets || []).forEach(font =>\n            this.preconnect.preload(font.href));\n\n          const urls = Services.urlForDoc(this.getAmpDoc());\n          // Preload any AMP images.\n          (creativeMetaDataDef.images || []).forEach(image =>\n            urls.isSecure(image) && this.preconnect.preload(image));\n          return creativeMetaDataDef;\n        })\n        .catch(error => {\n          switch (error.message || error) {\n            case IFRAME_GET:\n            case NETWORK_FAILURE:\n              return null;\n            case INVALID_SPSA_RESPONSE:\n            case NO_CONTENT_RESPONSE:\n              return {\n                minifiedCreative: '',\n                customElementExtensions: [],\n                customStylesheets: [],\n              };\n          }\n          // If error in chain occurs, report it and return null so that\n          // layoutCallback can render via cross domain iframe assuming ad\n          // url or creative exist.\n          this.promiseErrorHandler_(error);\n          return null;\n        });\n  }\n\n  /**\n   * This block returns the ad creative if it exists and validates as AMP;\n   * null otherwise.\n   * @param {!ArrayBuffer} bytes\n   * @param {!Headers} headers\n   * @return {!Promise<?ArrayBuffer>}\n   */\n  maybeValidateAmpCreative(bytes, headers) {\n    const checkStillCurrent = this.verifyStillCurrent();\n    return this.keysetPromise_\n        .then(() => {\n          if (this.element.getAttribute('type') == 'fake' &&\n              !this.element.getAttribute('checksig')) {\n            // do not verify signature for fake type ad, unless the ad\n            // specfically requires via 'checksig' attribute\n            return Promise.resolve(VerificationStatus.OK);\n          }\n          return signatureVerifierFor(this.win).verify(bytes, headers);\n        })\n        .then(status => {\n          checkStillCurrent();\n          let result = null;\n          switch (status) {\n            case VerificationStatus.OK:\n              result = bytes;\n              break;\n            case VerificationStatus.CRYPTO_UNAVAILABLE:\n              result = this.shouldPreferentialRenderWithoutCrypto() ?\n                bytes : null;\n              break;\n            // TODO(@taymonbeal, #9274): differentiate between these\n            case VerificationStatus.ERROR_KEY_NOT_FOUND:\n            case VerificationStatus.ERROR_SIGNATURE_MISMATCH:\n              user().error(\n                  TAG, this.element.getAttribute('type'),\n                  'Signature verification failed');\n            case VerificationStatus.UNVERIFIED:\n          }\n          if (this.isSinglePageStoryAd && !result) {\n            throw new Error(INVALID_SPSA_RESPONSE);\n          }\n          return result;\n        });\n  }\n\n  /**\n   * Populates object mapping of feature to value used for post ad response\n   * behavior experimentation.  Assumes comma separated, = delimited key/value\n   * pairs.  If key appears more than once, last value wins.\n   * @param {string} input\n   * @private\n   */\n  populatePostAdResponseExperimentFeatures_(input) {\n    input.split(',').forEach(line => {\n      if (!line) {\n        return;\n      }\n      const parts = line.split('=');\n      if (parts.length != 2 || !parts[0]) {\n        dev().warn(TAG, `invalid experiment feature ${line}`);\n        return;\n      }\n      this.postAdResponseExperimentFeatures[parts[0]] = parts[1];\n    });\n  }\n\n  /**\n   * Refreshes ad slot by fetching a new creative and rendering it. This leaves\n   * the current creative displayed until the next one is ready.\n   *\n   * @param {function()} refreshEndCallback When called, this function will\n   *   restart the refresh cycle.\n   * @return {Promise} A promise that resolves when all asynchronous portions of\n   *   the refresh function complete. This is particularly handy for testing.\n   */\n  refresh(refreshEndCallback) {\n    dev().assert(!this.isRefreshing);\n    this.isRefreshing = true;\n    this.tearDownSlot();\n    this.initiateAdRequest();\n    dev().assert(this.adPromise_);\n    const promiseId = this.promiseId_;\n    return this.adPromise_.then(() => {\n      if (!this.isRefreshing || promiseId != this.promiseId_) {\n        // If this refresh cycle was canceled, such as in a no-content\n        // response case, keep showing the old creative.\n        refreshEndCallback();\n        return;\n      }\n      return this.mutateElement(() => {\n        // Fire an ad-refresh event so that 3rd parties can track when an ad\n        // has changed.\n        triggerAnalyticsEvent(this.element, AnalyticsTrigger.AD_REFRESH);\n\n        this.togglePlaceholder(true);\n        // This delay provides a 1 second buffer where the ad loader is\n        // displayed in between the creatives.\n        return Services.timerFor(this.win).promise(1000).then(() => {\n          this.isRelayoutNeededFlag = true;\n          this.getResource().layoutCanceled();\n          // Only Require relayout after page visible\n          Services.viewerForDoc(this.getAmpDoc()).whenNextVisible().then(() => {\n            Services.resourcesForDoc(this.getAmpDoc())\n                ./*OK*/requireLayout(this.element);\n          });\n        });\n      });\n    });\n  }\n\n  /**\n   * Handles uncaught errors within promise flow.\n   * @param {*} error\n   * @param {boolean=} opt_ignoreStack\n   * @private\n   */\n  promiseErrorHandler_(error, opt_ignoreStack) {\n    if (isCancellation(error)) {\n      // Rethrow if cancellation.\n      throw error;\n    }\n\n    if (error && error.message) {\n      error = duplicateErrorIfNecessary(/** @type {!Error} */(error));\n    } else {\n      error = new Error('unknown error ' + error);\n    }\n    if (opt_ignoreStack) {\n      error.ignoreStack = opt_ignoreStack;\n    }\n\n    // Add `type` to the message. Ensure to preserve the original stack.\n    const type = this.element.getAttribute('type') || 'notype';\n    if (error.message.indexOf(`${TAG}: ${type}:`) != 0) {\n      error.message = `${TAG}: ${type}: ${error.message}`;\n    }\n\n    // Additional arguments.\n    assignAdUrlToError(/** @type {!Error} */(error), this.adUrl_);\n\n    if (getMode().development || getMode().localDev || getMode().log) {\n      user().error(TAG, error);\n    } else {\n      user().warn(TAG, error);\n      // Report with 1% sampling as an expected dev error.\n      if (Math.random() < 0.01) {\n        dev().expectedError(TAG, error);\n      }\n    }\n  }\n\n  /** @override */\n  layoutCallback() {\n    if (this.isRefreshing) {\n      this.destroyFrame(true);\n    }\n    return this.attemptToRenderCreative();\n  }\n\n  /**\n   * Attemps to render the returned creative following the resolution of the\n   * adPromise.\n   *\n   * @return {!Promise<boolean>|!Promise<undefined>} A promise that resolves\n   *   when the rendering attempt has finished.\n   * @protected\n   */\n  attemptToRenderCreative() {\n    // Promise may be null if element was determined to be invalid for A4A.\n    if (!this.adPromise_) {\n      if (this.shouldInitializePromiseChain_()) {\n        dev().error(TAG, 'Null promise in layoutCallback');\n      }\n      return Promise.resolve();\n    }\n    const checkStillCurrent = this.verifyStillCurrent();\n    // Promise chain will have determined if creative is valid AMP.\n    return this.adPromise_.then(creativeMetaData => {\n      checkStillCurrent();\n      if (this.isCollapsed_) {\n        return Promise.resolve();\n      }\n      // If this.iframe already exists, and we're not currently in the middle\n      // of refreshing, bail out here. This should only happen in\n      // testing context, not in production.\n      if (this.iframe && !this.isRefreshing) {\n        return Promise.resolve();\n      }\n      if (!creativeMetaData) {\n        // Non-AMP creative case, will verify ad url existence.\n        return this.renderNonAmpCreative();\n      }\n      // Must be an AMP creative.\n      return this.renderAmpCreative_(creativeMetaData)\n          .catch(err => {\n            checkStillCurrent();\n            // Failed to render via AMP creative path so fallback to non-AMP\n            // rendering within cross domain iframe.\n            user().warn(TAG, this.element.getAttribute('type'),\n                'Error injecting creative in friendly frame', err);\n            return this.renderNonAmpCreative();\n          });\n    }).catch(error => {\n      this.promiseErrorHandler_(error);\n      throw cancellation();\n    });\n  }\n\n  /**\n   * Returns whether or not the ad request may be sent using XHR.\n   * @return {boolean}\n   */\n  isXhrAllowed() {\n    return true;\n  }\n\n  /** @override **/\n  attemptChangeSize(newHeight, newWidth) {\n    // Store original size of slot in order to allow re-expansion on\n    // unlayoutCallback so that it is reverted to original size in case\n    // of resumeCallback.\n    this.originalSlotSize_ = this.originalSlotSize_ || this.getLayoutBox();\n    return super.attemptChangeSize(newHeight, newWidth);\n  }\n\n  /** @override  */\n  unlayoutCallback() {\n    this.tearDownSlot();\n    return true;\n  }\n\n  /**\n   * Attempts to tear down and set all state variables to initial conditions.\n   * @protected\n   */\n  tearDownSlot() {\n    // Increment promiseId to cause any pending promise to cancel.\n    this.promiseId_++;\n    this.uiHandler.applyUnlayoutUI();\n    if (this.originalSlotSize_) {\n      super.attemptChangeSize(\n          this.originalSlotSize_.height, this.originalSlotSize_.width)\n          .then(() => {\n            this.originalSlotSize_ = null;\n          })\n          .catch(err => {\n          // TODO(keithwrightbos): if we are unable to revert size, on next\n          // trigger of promise chain the ad request may fail due to invalid\n          // slot size.  Determine how to handle this case.\n            dev().warn(TAG, 'unable to revert to original size', err);\n          });\n    }\n\n    this.isCollapsed_ = false;\n\n    // Remove rendering frame, if it exists.\n    this.destroyFrame();\n\n    this.adPromise_ = null;\n    this.adUrl_ = null;\n    this.creativeBody_ = null;\n    this.isVerifiedAmpCreative_ = false;\n    this.fromResumeCallback = false;\n    this.experimentalNonAmpCreativeRenderMethod_ =\n        this.getNonAmpCreativeRenderingMethod();\n    this.postAdResponseExperimentFeatures = {};\n  }\n\n  /**\n   * Attempts to remove the current frame and free any associated resources.\n   * This function will no-op if this ad slot is currently in the process of\n   * being refreshed.\n   *\n   * @param {boolean=} force Forces the removal of the frame, even if\n   *   this.isRefreshing is true.\n   * @protected\n   */\n  destroyFrame(force = false) {\n    if (!force && this.isRefreshing) {\n      return;\n    }\n    // Allow embed to release its resources.\n    if (this.friendlyIframeEmbed_) {\n      this.friendlyIframeEmbed_.destroy();\n      this.friendlyIframeEmbed_ = null;\n    }\n    if (this.iframe && this.iframe.parentElement) {\n      this.iframe.parentElement.removeChild(this.iframe);\n      this.iframe = null;\n    }\n    if (this.xOriginIframeHandler_) {\n      this.xOriginIframeHandler_.freeXOriginIframe();\n      this.xOriginIframeHandler_ = null;\n    }\n  }\n\n  /** @override  */\n  viewportCallback(inViewport) {\n    if (this.friendlyIframeEmbed_) {\n      setFriendlyIframeEmbedVisible(this.friendlyIframeEmbed_, inViewport);\n    }\n    if (this.xOriginIframeHandler_) {\n      this.xOriginIframeHandler_.viewportCallback(inViewport);\n    }\n  }\n\n  /** @override */\n  createPlaceholderCallback() {\n    return this.uiHandler.createPlaceholder();\n  }\n\n  /**\n   * Gets the Ad URL to send an XHR Request to.  To be implemented\n   * by network.\n   * @param {?CONSENT_POLICY_STATE} unusedConsentState\n   * @param {Promise<!Array<rtcResponseDef>>=} opt_rtcResponsesPromise\n   * @return {!Promise<string>|string}\n   */\n  getAdUrl(unusedConsentState, opt_rtcResponsesPromise) {\n    throw new Error('getAdUrl not implemented!');\n  }\n\n  /**\n   * Resets ad url state to null, used to prevent frame get fallback if error\n   * is thrown after url construction but prior to layoutCallback.\n   */\n  resetAdUrl() {\n    this.adUrl_ = null;\n  }\n\n  /**\n   * @return {function()} function that when called will verify if current\n   *    ad retrieval is current (meaning unlayoutCallback was not executed).\n   *    If not, will throw cancellation exception;\n   * @throws {Error}\n   */\n  verifyStillCurrent() {\n    const promiseId = this.promiseId_;\n    return () => {\n      if (promiseId != this.promiseId_) {\n        throw cancellation();\n      }\n    };\n  }\n\n  /**\n   * Determine the desired size of the creative based on the HTTP response\n   * headers. Must be less than or equal to the original size of the ad slot\n   * along each dimension. May be overridden by network.\n   *\n   * @param {!../../../src/utils/xhr-utils.FetchResponseHeaders} responseHeaders\n   * @return {?SizeInfoDef}\n   */\n  extractSize(responseHeaders) {\n    const headerValue = responseHeaders.get(CREATIVE_SIZE_HEADER);\n    if (!headerValue) {\n      return null;\n    }\n    const match = /^([0-9]+)x([0-9]+)$/.exec(headerValue);\n    if (!match) {\n      // TODO(@taymonbeal, #9274): replace this with real error reporting\n      user().error(TAG, `Invalid size header: ${headerValue}`);\n      return null;\n    }\n    return /** @type {?SizeInfoDef} */ (\n      {width: Number(match[1]), height: Number(match[2])});\n  }\n\n  /**\n   * Forces the UI Handler to collapse this slot.\n   * @visibleForTesting\n   */\n  forceCollapse() {\n    if (this.isRefreshing) {\n      // If, for whatever reason, the new creative would collapse this slot,\n      // stick with the old creative until the next refresh cycle.\n      this.isRefreshing = false;\n      return;\n    }\n    dev().assert(this.uiHandler);\n    // Store original size to allow for reverting on unlayoutCallback so that\n    // subsequent pageview allows for ad request.\n    this.originalSlotSize_ = this.originalSlotSize_ || this.getLayoutBox();\n    this.uiHandler.applyNoContentUI();\n    this.isCollapsed_ = true;\n  }\n\n  /**\n   * Callback executed when creative has successfully rendered within the\n   * publisher page but prior to load (or ini-load for friendly frame AMP\n   * creative render).  To be overridden by network implementations as needed.\n   *\n   * @param {?CreativeMetaDataDef} creativeMetaData metadata if AMP creative,\n   *    null otherwise.\n   */\n  onCreativeRender(creativeMetaData) {\n    this.maybeTriggerAnalyticsEvent_(\n        creativeMetaData ? 'renderFriendlyEnd' : 'renderCrossDomainEnd');\n  }\n\n  /**\n   * @param {!Element} iframe that was just created.  To be overridden for\n   * testing.\n   * @visibleForTesting\n   */\n  onCrossDomainIframeCreated(iframe) {\n    dev().info(TAG, this.element.getAttribute('type'),\n        `onCrossDomainIframeCreated ${iframe}`);\n  }\n\n  /**\n   * Send ad request, extract the creative and signature from the response.\n   * @param {string} adUrl Request URL to send XHR to.\n   * @return {!Promise<?../../../src/utils/xhr-utils.FetchResponse>}\n   * @protected\n   */\n  sendXhrRequest(adUrl) {\n    this.maybeTriggerAnalyticsEvent_('adRequestStart');\n    const xhrInit = {\n      mode: 'cors',\n      method: 'GET',\n      credentials: 'include',\n    };\n    return Services.xhrFor(this.win)\n        .fetch(adUrl, xhrInit)\n        .catch(error => {\n          if (error.response && error.response.status > 200) {\n            // Invalid server response code so we should collapse.\n            return null;\n          }\n          // If an error occurs, let the ad be rendered via iframe after delay.\n          // TODO(taymonbeal): Figure out a more sophisticated test for deciding\n          // whether to retry with an iframe after an ad request failure or just\n          // give up and render the fallback content (or collapse the ad slot).\n          const networkFailureHandlerResult =\n              this.onNetworkFailure(error, /** @type {string} */ (this.adUrl_));\n          dev().assert(!!networkFailureHandlerResult);\n          if (networkFailureHandlerResult.frameGetDisabled) {\n            // Reset adUrl to null which will cause layoutCallback to not\n            // fetch via frame GET.\n            dev().info(\n                TAG, 'frame get disabled as part of network failure handler');\n            this.resetAdUrl();\n          } else {\n            this.adUrl_ = networkFailureHandlerResult.adUrl || this.adUrl_;\n            return Promise.reject(NETWORK_FAILURE);\n          }\n          return null;\n        });\n  }\n\n  /**\n   * Called on network failure sending XHR CORS ad request allowing for\n   * modification of ad url and prevent frame GET request on layoutCallback.\n   * By default, GET frame request will be executed with same ad URL as used\n   * for XHR CORS request.\n   * @param {*} unusedError from network failure\n   * @param {string} unusedAdUrl used for network request\n   * @return {!{adUrl: (string|undefined), frameGetDisabled: (boolean|undefined)}}\n   */\n  onNetworkFailure(unusedError, unusedAdUrl) {\n    return {};\n  }\n\n  /**\n   * To be overridden by network specific implementation indicating which\n   * signing service(s) is to be used.\n   * @return {!Array<string>} A list of signing services.\n   */\n  getSigningServiceNames() {\n    return getMode().localDev ? ['google', 'google-dev'] : ['google'];\n  }\n\n  /**\n   * Render non-AMP creative within cross domain iframe.\n   * @param {boolean=} throttleApplied Whether incrementLoadingAds has already\n   *    been called\n   * @return {Promise<boolean>} Whether the creative was successfully rendered.\n   */\n  renderNonAmpCreative(throttleApplied) {\n    if (this.element.getAttribute('disable3pfallback') == 'true') {\n      user().warn(TAG, this.element.getAttribute('type'),\n          'fallback to 3p disabled');\n      return Promise.resolve(false);\n    }\n    // TODO(keithwrightbos): remove when no longer needed.\n    dev().warn(TAG, 'fallback to 3p');\n    // Haven't rendered yet, so try rendering via one of our\n    // cross-domain iframe solutions.\n    const method = this.experimentalNonAmpCreativeRenderMethod_;\n    let renderPromise = Promise.resolve(false);\n    if ((method == XORIGIN_MODE.SAFEFRAME ||\n         method == XORIGIN_MODE.NAMEFRAME) &&\n        this.creativeBody_) {\n      renderPromise = this.renderViaNameAttrOfXOriginIframe_(\n          this.creativeBody_);\n      this.creativeBody_ = null; // Free resources.\n    } else if (this.adUrl_) {\n      assertHttpsUrl(this.adUrl_, this.element);\n      renderPromise = this.renderViaIframeGet_(this.adUrl_);\n    } else {\n      // Ad URL may not exist if buildAdUrl throws error or returns empty.\n      // If error occurred, it would have already been reported but let's\n      // report to user in case of empty.\n      user().warn(TAG, this.element.getAttribute('type'),\n          'No creative or URL available -- A4A can\\'t render any ad');\n    }\n    if (!throttleApplied && !this.inNonAmpPreferenceExp()) {\n      incrementLoadingAds(this.win, renderPromise);\n    }\n    return renderPromise.then(\n        result => {\n          this.maybeTriggerAnalyticsEvent_('crossDomainIframeLoaded');\n          // Pass on the result to the next value in the promise change.\n          return result;\n        });\n  }\n\n  /**\n   * Render a validated AMP creative directly in the parent page.\n   * @param {!CreativeMetaDataDef} creativeMetaData Metadata required to render\n   *     AMP creative.\n   * @return {!Promise} Whether the creative was successfully rendered.\n   * @private\n   */\n  renderAmpCreative_(creativeMetaData) {\n    dev().assert(creativeMetaData.minifiedCreative,\n        'missing minified creative');\n    dev().assert(!!this.element.ownerDocument, 'missing owner document?!');\n    this.maybeTriggerAnalyticsEvent_('renderFriendlyStart');\n    // Create and setup friendly iframe.\n    this.iframe = /** @type {!HTMLIFrameElement} */(\n      createElementWithAttributes(\n          /** @type {!Document} */(this.element.ownerDocument), 'iframe',\n          dict({\n            // NOTE: It is possible for either width or height to be 'auto',\n            // a non-numeric value.\n            'height': this.creativeSize_.height,\n            'width': this.creativeSize_.width,\n            'frameborder': '0',\n            'allowfullscreen': '',\n            'allowtransparency': '',\n            'scrolling': 'no',\n          })));\n    this.applyFillContent(this.iframe);\n    const fontsArray = [];\n    if (creativeMetaData.customStylesheets) {\n      creativeMetaData.customStylesheets.forEach(s => {\n        const href = s['href'];\n        if (href) {\n          fontsArray.push(href);\n        }\n      });\n    }\n    const checkStillCurrent = this.verifyStillCurrent();\n    return installFriendlyIframeEmbed(\n        this.iframe, this.element, {\n          host: this.element,\n          // Need to guarantee that this is no longer null\n          url: /** @type {string} */ (this.adUrl_),\n          html: creativeMetaData.minifiedCreative,\n          extensionIds: creativeMetaData.customElementExtensions || [],\n          fonts: fontsArray,\n        }, embedWin => {\n          installUrlReplacementsForEmbed(this.getAmpDoc(), embedWin,\n              new A4AVariableSource(this.getAmpDoc(), embedWin));\n        }).then(friendlyIframeEmbed => {\n      checkStillCurrent();\n      this.friendlyIframeEmbed_ = friendlyIframeEmbed;\n      setFriendlyIframeEmbedVisible(\n          friendlyIframeEmbed, this.isInViewport());\n      // Ensure visibility hidden has been removed (set by boilerplate).\n      const frameDoc = friendlyIframeEmbed.iframe.contentDocument ||\n              friendlyIframeEmbed.win.document;\n      setStyle(frameDoc.body, 'visibility', 'visible');\n      protectFunctionWrapper(this.onCreativeRender, this, err => {\n        dev().error(TAG, this.element.getAttribute('type'),\n            'Error executing onCreativeRender', err);\n      })(creativeMetaData);\n      // It's enough to wait for \"ini-load\" signal because in a FIE case\n      // we know that the embed no longer consumes significant resources\n      // after the initial load.\n      return friendlyIframeEmbed.whenIniLoaded();\n    }).then(() => {\n      checkStillCurrent();\n      // Capture ini-load ping.\n      this.maybeTriggerAnalyticsEvent_('friendlyIframeIniLoad');\n    });\n  }\n\n  /**\n   * Shared functionality for cross-domain iframe-based rendering methods.\n   * @param {!JsonObject<string, string>} attributes The attributes of the iframe.\n   * @return {!Promise} awaiting load event for ad frame\n   * @private\n   */\n  iframeRenderHelper_(attributes) {\n    const mergedAttributes = Object.assign(attributes, dict({\n      'height': this.creativeSize_.height,\n      'width': this.creativeSize_.width,\n    }));\n\n    if (this.sentinel) {\n      mergedAttributes['data-amp-3p-sentinel'] = this.sentinel;\n    }\n    if (this.shouldSandbox_) {\n      mergedAttributes['sandbox'] = IFRAME_SANDBOXING_FLAGS;\n    }\n    if (isExperimentOn(this.win, 'no-sync-xhr-in-ads')) {\n      // Block synchronous XHR in ad. These are very rare, but super bad for UX\n      // as they block the UI thread for the arbitrary amount of time until the\n      // request completes.\n      mergedAttributes['allow'] = 'sync-xhr \\'none\\';';\n    }\n    this.iframe = createElementWithAttributes(\n        /** @type {!Document} */ (this.element.ownerDocument),\n        'iframe', /** @type {!JsonObject} */ (\n          Object.assign(mergedAttributes, SHARED_IFRAME_PROPERTIES)));\n    // TODO(keithwrightbos): noContentCallback?\n    this.xOriginIframeHandler_ = new AMP.AmpAdXOriginIframeHandler(this);\n    // Iframe is appended to element as part of xorigin frame handler init.\n    // Executive onCreativeRender after init to ensure it can get reference\n    // to frame but prior to load to allow for earlier access.\n    const frameLoadPromise =\n        this.xOriginIframeHandler_.init(this.iframe, /* opt_isA4A */ true);\n    protectFunctionWrapper(this.onCreativeRender, this, err => {\n      dev().error(TAG, this.element.getAttribute('type'),\n          'Error executing onCreativeRender', err);\n    })(null);\n    return frameLoadPromise;\n  }\n\n  /**\n   * Creates iframe whose src matches that of the ad URL. For standard\n   * Fast Fetch running on the AMP cdn, an XHR request will typically have\n   * already been sent to the same adUrl, and the response should\n   * have been cached causing the browser to render without callout.  However,\n   * it is possible for cache miss to occur which can be detected server-side\n   * by missing ORIGIN header.\n   *\n   * Additionally, this method is also used in certain cases to send the only\n   * request, i.e. the initial XHR is skipped.\n   *\n   * Note: As of 2016-10-18, the fill-from-cache assumption appears to fail on\n   * Safari-on-iOS, which issues a fresh network request, even though the\n   * content is already in cache.\n   *\n   * @param {string} adUrl  Ad request URL, as sent to #sendXhrRequest (i.e.,\n   *    before any modifications that XHR module does to it.)\n   * @return {!Promise} awaiting ad completed insertion.\n   * @private\n   */\n  renderViaIframeGet_(adUrl) {\n    this.maybeTriggerAnalyticsEvent_('renderCrossDomainStart');\n    return this.iframeRenderHelper_(dict({\n      'src': Services.xhrFor(this.win).getCorsUrl(this.win, adUrl),\n      'name': JSON.stringify(\n          getContextMetadata(this.win, this.element, this.sentinel)),\n    }));\n  }\n\n  /**\n   * Render the creative via some \"cross domain iframe that accepts the creative\n   * in the name attribute\".  This could be SafeFrame or the AMP-native\n   * NameFrame.\n   *\n   * @param {!ArrayBuffer} creativeBody\n   * @return {!Promise} awaiting load event for ad frame\n   * @private\n   */\n  renderViaNameAttrOfXOriginIframe_(creativeBody) {\n    /** @type {?string} */\n    const method = this.experimentalNonAmpCreativeRenderMethod_;\n    dev().assert(method == XORIGIN_MODE.SAFEFRAME ||\n        method == XORIGIN_MODE.NAMEFRAME,\n    'Unrecognized A4A cross-domain rendering mode: %s', method);\n    this.maybeTriggerAnalyticsEvent_('renderSafeFrameStart');\n    const checkStillCurrent = this.verifyStillCurrent();\n    return tryResolve(() => utf8Decode(creativeBody)).then(creative => {\n      checkStillCurrent();\n      let srcPath;\n      let name = '';\n      switch (method) {\n        case XORIGIN_MODE.SAFEFRAME:\n          srcPath = this.getSafeframePath() + '?n=0';\n          break;\n        case XORIGIN_MODE.NAMEFRAME:\n          srcPath = getDefaultBootstrapBaseUrl(this.win, 'nameframe');\n          // Name will be set for real below in nameframe case.\n          break;\n        default:\n          // Shouldn't be able to get here, but...  Because of the assert,\n          // above, we can only get here in non-dev mode, so give user feedback.\n          user().error('A4A', 'A4A received unrecognized cross-domain name'\n              + ' attribute iframe rendering mode request: %s.  Unable to'\n              + ' render a creative for'\n              + ' slot %s.', method, this.element.getAttribute('id'));\n          return Promise.reject('Unrecognized rendering mode request');\n      }\n      // TODO(bradfrizzell): change name of function and var\n      let contextMetadata = getContextMetadata(\n          this.win, this.element, this.sentinel,\n          this.getAdditionalContextMetadata(method == XORIGIN_MODE.SAFEFRAME));\n      // TODO(bradfrizzell) Clean up name assigning.\n      if (method == XORIGIN_MODE.NAMEFRAME) {\n        contextMetadata['creative'] = creative;\n        name = JSON.stringify(contextMetadata);\n      } else if (method == XORIGIN_MODE.SAFEFRAME) {\n        contextMetadata = JSON.stringify(contextMetadata);\n        name = `${this.safeframeVersion};${creative.length};${creative}` +\n            `${contextMetadata}`;\n      }\n      return this.iframeRenderHelper_(dict({'src': srcPath, 'name': name}));\n    });\n  }\n\n  /**\n   *\n   * Throws {@code SyntaxError} if the metadata block delimiters are missing\n   * or corrupted or if the metadata content doesn't parse as JSON.\n   * @param {string} creative from which CSS is extracted\n   * @return {?CreativeMetaDataDef} Object result of parsing JSON data blob inside\n   *     the metadata markers on the ad text, or null if no metadata markers are\n   *     found.\n   * TODO(keithwrightbos@): report error cases\n   */\n  getAmpAdMetadata(creative) {\n    let metadataStart = -1;\n    let metadataString;\n    for (let i = 0; i < METADATA_STRINGS.length; i++) {\n      metadataString = METADATA_STRINGS[i];\n      metadataStart = creative.lastIndexOf(metadataString);\n      if (metadataStart >= 0) {\n        break;\n      }\n    }\n    if (metadataStart < 0) {\n      // Couldn't find a metadata blob.\n      dev().warn(TAG, this.element.getAttribute('type'),\n          'Could not locate start index for amp meta data in: %s', creative);\n      return null;\n    }\n    const metadataEnd = creative.lastIndexOf('</script>');\n    if (metadataEnd < 0) {\n      // Couldn't find a metadata blob.\n      dev().warn(TAG, this.element.getAttribute('type'),\n          'Could not locate closing script tag for amp meta data in: %s',\n          creative);\n      return null;\n    }\n    try {\n      const metaDataObj = parseJson(\n          creative.slice(metadataStart + metadataString.length, metadataEnd));\n      const ampRuntimeUtf16CharOffsets =\n        metaDataObj['ampRuntimeUtf16CharOffsets'];\n      if (!isArray(ampRuntimeUtf16CharOffsets) ||\n          ampRuntimeUtf16CharOffsets.length != 2 ||\n          typeof ampRuntimeUtf16CharOffsets[0] !== 'number' ||\n          typeof ampRuntimeUtf16CharOffsets[1] !== 'number') {\n        throw new Error('Invalid runtime offsets');\n      }\n      const metaData = {};\n      if (metaDataObj['customElementExtensions']) {\n        metaData.customElementExtensions =\n          metaDataObj['customElementExtensions'];\n        if (!isArray(metaData.customElementExtensions)) {\n          throw new Error(\n              'Invalid extensions', metaData.customElementExtensions);\n        }\n      } else {\n        metaData.customElementExtensions = [];\n      }\n      if (metaDataObj['customStylesheets']) {\n        // Expect array of objects with at least one key being 'href' whose\n        // value is URL.\n        metaData.customStylesheets = metaDataObj['customStylesheets'];\n        const errorMsg = 'Invalid custom stylesheets';\n        if (!isArray(metaData.customStylesheets)) {\n          throw new Error(errorMsg);\n        }\n\n        const urls = Services.urlForDoc(this.getAmpDoc());\n        metaData.customStylesheets.forEach(stylesheet => {\n          if (!isObject(stylesheet) || !stylesheet['href'] ||\n              typeof stylesheet['href'] !== 'string' ||\n              !urls.isSecure(stylesheet['href'])) {\n            throw new Error(errorMsg);\n          }\n        });\n      }\n      if (isArray(metaDataObj['images'])) {\n        // Load maximum of 5 images.\n        metaData.images = metaDataObj['images'].splice(0, 5);\n      }\n      if (this.isSinglePageStoryAd) {\n        if (!metaDataObj['ctaUrl'] || !metaDataObj['ctaType']) {\n          throw new Error(INVALID_SPSA_RESPONSE);\n        }\n        this.element.setAttribute('data-vars-ctatype', metaDataObj['ctaType']);\n        this.element.setAttribute('data-vars-ctaurl', metaDataObj['ctaUrl']);\n      }\n      // TODO(keithwrightbos): OK to assume ampRuntimeUtf16CharOffsets is before\n      // metadata as its in the head?\n      metaData.minifiedCreative =\n        creative.slice(0, ampRuntimeUtf16CharOffsets[0]) +\n        creative.slice(ampRuntimeUtf16CharOffsets[1], metadataStart) +\n        creative.slice(metadataEnd + '</script>'.length);\n      return metaData;\n    } catch (err) {\n      dev().warn(\n          TAG, this.element.getAttribute('type'), 'Invalid amp metadata: %s',\n          creative.slice(metadataStart + metadataString.length, metadataEnd));\n      if (this.isSinglePageStoryAd) {\n        throw err;\n      }\n      return null;\n    }\n  }\n\n  /**\n   * @return {string} full url to safeframe implementation.\n   */\n  getSafeframePath() {\n    return 'https://tpc.googlesyndication.com/safeframe/' +\n      `${this.safeframeVersion}/html/container.html`;\n  }\n\n  /**\n   * Checks if the given lifecycle event has a corresponding amp-analytics event\n   * and fires the analytics trigger if so.\n   * @param {string} lifecycleStage\n   * @private\n   */\n  maybeTriggerAnalyticsEvent_(lifecycleStage) {\n    if (!this.a4aAnalyticsConfig_) {\n      // No config exists that will listen to this event.\n      return;\n    }\n    const analyticsEvent =\n        dev().assert(LIFECYCLE_STAGE_TO_ANALYTICS_TRIGGER[lifecycleStage]);\n    const analyticsVars = Object.assign(\n        {'time': Math.round(this.getNow_())},\n        this.getA4aAnalyticsVars(analyticsEvent));\n    triggerAnalyticsEvent(this.element, analyticsEvent, analyticsVars);\n  }\n\n  /**\n   * Returns variables to be included on an analytics event. This can be\n   * overridden by specific network implementations.\n   * Note that this function is called for each time an analytics event is\n   * fired.\n   * @param {string} unusedAnalyticsEvent The name of the analytics event.\n   * @return {!Object<string, string>}\n   */\n  getA4aAnalyticsVars(unusedAnalyticsEvent) { return {}; }\n\n  /**\n   * Returns network-specific config for amp-analytics. It should overridden\n   * with network-specific configurations.\n   * This function may return null. If so, no amp-analytics element will be\n   * added to this A4A element and no A4A triggers will be fired.\n   * @return {?JsonObject}\n   */\n  getA4aAnalyticsConfig() { return null; }\n\n  /**\n   * Attempts to execute Real Time Config, if the ad network has enabled it.\n   * If it is not supported by the network, but the publisher has included\n   * the rtc-config attribute on the amp-ad element, warn.\n   * @param {?CONSENT_POLICY_STATE} consentState\n   * @return {Promise<!Array<!rtcResponseDef>>|undefined}\n   */\n  tryExecuteRealTimeConfig_(consentState) {\n    if (!!AMP.RealTimeConfigManager) {\n      try {\n        return new AMP.RealTimeConfigManager(this)\n            .maybeExecuteRealTimeConfig(\n                this.getCustomRealTimeConfigMacros_(), consentState);\n      } catch (err) {\n        user().error(TAG, 'Could not perform Real Time Config.', err);\n      }\n    } else if (this.element.getAttribute('rtc-config')) {\n      user().error(TAG, 'RTC not supported for ad network ' +\n                   `${this.element.getAttribute('type')}`);\n\n    }\n  }\n\n  /**\n   * To be overriden by network impl. Should return a mapping of macro keys\n   * to values for substitution in publisher-specified URLs for RTC.\n   * @return {!Object<string,\n   *   !../../../src/service/variable-source.AsyncResolverDef>}\n   */\n  getCustomRealTimeConfigMacros_() {\n    return {};\n  }\n\n  /**\n   * Whether preferential render should still be utilized if web crypto is\n   * unavailable, and crypto signature header is present.\n   * @return {boolean}\n   */\n  shouldPreferentialRenderWithoutCrypto() {\n    return false;\n  }\n\n  /**\n   * @param {string=} headerValue Method as given in header.\n   */\n  getNonAmpCreativeRenderingMethod(headerValue) {\n    if (headerValue) {\n      if (!isEnumValue(XORIGIN_MODE, headerValue)) {\n        dev().error(\n            'AMP-A4A', `cross-origin render mode header ${headerValue}`);\n      } else {\n        return headerValue;\n      }\n    }\n    return Services.platformFor(this.win).isIos() ?\n      XORIGIN_MODE.NAMEFRAME : null;\n  }\n\n  /**\n   * Returns base object that will be written to cross-domain iframe name\n   * attribute.\n   * @param {boolean=} opt_isSafeframe Whether creative is rendering into\n   *   a safeframe.\n   * @return {!JsonObject|undefined}\n   */\n  getAdditionalContextMetadata(opt_isSafeframe) {}\n}\n\n/**\n * Attachs query string portion of ad url to error.\n * @param {!Error} error\n * @param {?string} adUrl\n */\nexport function assignAdUrlToError(error, adUrl) {\n  if (!adUrl || (error.args && error.args['au'])) {\n    return;\n  }\n  const adQueryIdx = adUrl.indexOf('?');\n  if (adQueryIdx == -1) {\n    return;\n  }\n  (error.args || (error.args = {}))['au'] =\n    adUrl.substring(adQueryIdx + 1, adQueryIdx + 251);\n}\n\n/**\n * Returns the signature verifier for the given window. Lazily creates it if it\n * doesn't already exist.\n *\n * This ensures that only one signature verifier exists per window, which allows\n * multiple Fast Fetch ad slots on a page (even ones from different ad networks)\n * to share the same cached public keys.\n *\n * @param {!Window} win\n * @return {!SignatureVerifier}\n * @visibleForTesting\n */\nexport function signatureVerifierFor(win) {\n  const propertyName = 'AMP_FAST_FETCH_SIGNATURE_VERIFIER_';\n  return win[propertyName] ||\n      (win[propertyName] = new SignatureVerifier(win, signingServerURLs));\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {getMode} from '../../../src/mode';\n\n//////////////////////////////////////////////////////////////////\n//                                                              //\n//     IMPORTANT: All keys in RTC_VENDORS must be lowercase     //\n//       otherwise the vendor endpoint will not be used.        //\n//                                                              //\n//////////////////////////////////////////////////////////////////\n\n// Note: disableKeyAppend is an option specifically for DoubleClick's\n// implementation of RTC. It prevents the vendor ID from being\n// appended onto each key of the RTC response, for each vendor.\n// This appending is done to prevent a collision case during merge\n// that would cause one RTC response to overwrite another if they\n// share key names.\n/** @typedef {{\n    url: string,\n    macros: Array<string>,\n    errorReportingUrl: (string|undefined),\n    disableKeyAppend: boolean}} */\nlet RtcVendorDef;\n\n/** @const {!Object<string, RtcVendorDef>} */\nexport const RTC_VENDORS = {\n  // Add vendors here\n  medianet: {\n    url: 'https://amprtc.media.net/rtb/getrtc?cid=CID&w=ATTR(width)&h=ATTR(height)&ow=ATTR(data-override-width)&oh=ATTR(data-override-height)&ms=ATTR(data-multi-size)&slot=ATTR(data-slot)&tgt=TGT&curl=CANONICAL_URL&to=TIMEOUT&purl=HREF',\n    macros: ['CID'],\n    errorReportingUrl: 'https://qsearch-a.akamaihd.net/log?logid=kfk&evtid=projectevents&project=amprtc_error&error=ERROR_TYPE&rd=HREF',\n    disableKeyAppend: true,\n  },\n  prebidappnexus: {\n    url: 'https://prebid.adnxs.com/pbs/v1/openrtb2/amp?tag_id=PLACEMENT_ID&w=ATTR(width)&h=ATTR(height)&ow=ATTR(data-override-width)&oh=ATTR(data-override-height)&ms=ATTR(data-multi-size)&slot=ATTR(data-slot)&targeting=TGT&curl=CANONICAL_URL&timeout=TIMEOUT&adcid=ADCID&purl=HREF',\n    macros: ['PLACEMENT_ID'],\n    disableKeyAppend: true,\n  },\n  prebidrubicon: {\n    url: 'https://prebid-server.rubiconproject.com/openrtb2/amp?tag_id=REQUEST_ID&w=ATTR(width)&h=ATTR(height)&ow=ATTR(data-override-width)&oh=ATTR(data-override-height)&ms=ATTR(data-multi-size)&slot=ATTR(data-slot)&targeting=TGT&curl=CANONICAL_URL&timeout=TIMEOUT&adc=ADCID&purl=HREF',\n    macros: ['REQUEST_ID'],\n    disableKeyAppend: true,\n  },\n  indexexchange: {\n    url: 'https://amp.casalemedia.com/amprtc?v=1&w=ATTR(width)&h=ATTR(height)&ow=ATTR(data-override-width)&oh=ATTR(data-override-height)&ms=ATTR(data-multi-size)&s=SITE_ID&p=CANONICAL_URL',\n    macros: ['SITE_ID'],\n    disableKeyAppend: true,\n  },\n  lotame: {\n    url: 'https://ad.crwdcntrl.net/5/pe=y/c=CLIENT_ID/an=AD_NETWORK',\n    macros: ['CLIENT_ID', 'AD_NETWORK'],\n  },\n  yieldbot: {\n    url: 'https://i.yldbt.com/m/YB_PSN/v1/amp/init?curl=CANONICAL_URL&sn=YB_SLOT&w=ATTR(width)&h=ATTR(height)&ow=ATTR(data-override-width)&oh=ATTR(data-override-height)&ms=ATTR(data-multi-size)&aup=ATTR(data-slot)&pvi=PAGEVIEWID&tgt=TGT&adcid=ADCID&href=HREF',\n    macros: ['YB_PSN', 'YB_SLOT'],\n    disableKeyAppend: true,\n  },\n  salesforcedmp: {\n    url: 'https://cdn.krxd.net/userdata/v2/amp/ORGANIZATION_ID?segments_key=SEGMENTS_KEY&kuid_key=USER_KEY',\n    macros: ['ORGANIZATION_ID', 'SEGMENTS_KEY', 'USER_KEY'],\n    disableKeyAppend: true,\n  },\n  purch: {\n    url: 'https://ads.servebom.com/tmntag.js?v=1.2&fmt=amp&o={%22p%22%3APLACEMENT_ID}&div_id=DIV_ID',\n    macros: ['PLACEMENT_ID', 'DIV_ID'],\n    disableKeyAppend: true,\n  },\n  aps: {\n    url: 'https://aax.amazon-adsystem.com/e/dtb/bid?src=PUB_ID&amp=1&u=CANONICAL_URL&slots=%5B%7B%22sd%22%3A%22ATTR(data-slot)%22%2C%22s%22%3A%5B%22ATTR(width)xATTR(height)%22%5D%7D%5D&pj=PARAMS',\n    macros: ['PUB_ID', 'PARAMS'],\n    disableKeyAppend: true,\n  },\n  openwrap: {\n    // PubMatic OpenWrap\n    url: 'https://ow.pubmatic.com/amp?v=1&w=ATTR(width)&h=ATTR(height)&ms=ATTR(data-multi-size)&auId=ATTR(data-slot)&purl=HREF&pubId=PUB_ID&profId=PROFILE_ID',\n    macros: ['PUB_ID', 'PROFILE_ID'],\n    errorReportingUrl: 'https://ow.pubmatic.com/amp_error?e=ERROR_TYPE&h=HREF',\n    disableKeyAppend: true,\n  },\n  criteo: {\n    url: 'https://bidder.criteo.com/amp/rtc?zid=ZONE_ID&nid=NETWORK_ID&psubid=PUBLISHER_SUB_ID&lir=LINE_ITEM_RANGES&w=ATTR(width)&h=ATTR(height)&ow=ATTR(data-override-width)&oh=ATTR(data-override-height)&ms=ATTR(data-multi-size)&slot=ATTR(data-slot)&timeout=TIMEOUT&href=HREF',\n    macros: ['ZONE_ID', 'NETWORK_ID', 'PUBLISHER_SUB_ID', 'LINE_ITEM_RANGES'],\n    disableKeyAppend: true,\n  },\n};\n\n// DO NOT MODIFY: Setup for tests\nif (getMode().localDev || getMode().test) {\n  RTC_VENDORS['fakevendor'] = /** @type {RtcVendorDef} */({\n    url: 'https://localhost:8000/examples/rtcE1.json?slot_id=SLOT_ID&page_id=PAGE_ID&foo_id=FOO_ID',\n    macros: ['SLOT_ID', 'PAGE_ID', 'FOO_ID'],\n  });\n  RTC_VENDORS['fakevendor2'] = /** @type {RtcVendorDef} */({\n    url: 'https://localhost:8000/examples/rtcE1.json?slot_id=SLOT_ID&page_id=PAGE_ID&foo_id=FOO_ID',\n    errorReportingUrl: 'https://localhost:8000/examples/ERROR_TYPE',\n    disableKeyAppend: true,\n  });\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {CONSENT_POLICY_STATE} from '../../../src/consent-state';\nimport {RTC_VENDORS} from './callout-vendors';\nimport {Services} from '../../../src/services';\nimport {dev, user} from '../../../src/log';\nimport {getMode} from '../../../src/mode';\nimport {isArray, isObject} from '../../../src/types';\nimport {isCancellation} from '../../../src/error';\nimport {tryParseJson} from '../../../src/json';\n\n/** @type {string} */\nconst TAG = 'real-time-config';\n\n/** @type {number} */\nconst MAX_RTC_CALLOUTS = 5;\n\n/** @type {number} */\nconst MAX_URL_LENGTH = 16384;\n\n/** @type {boolean} */\nconst ERROR_REPORTING_ENABLED = getMode(window).localDev ||\n      getMode(window).test || Math.random() < 0.01;\n\n/** @typedef {{\n    urls: (undefined|Array<string>|\n      Array<{url:string, errorReportingUrl:string,\n        sendRegardlessOfConsentState:(undefined|boolean|Array<string>)}>),\n    vendors: (undefined|Object),\n    timeoutMillis: number,\n    errorReportingUrl: (undefined|string),\n    sendRegardlessOfConsentState: (undefined|boolean|Array<string>)\n}} */\nlet RtcConfigDef;\n\n/**\n * Enum starts at 4 because 1-3 reserved as:\n *  1 = custom remote.html in use.\n *  2 = RTC succeeded.\n *  3 = deprecated generic RTC failures.\n * @enum {string}\n */\nexport const RTC_ERROR_ENUM = {\n  // Occurs when response is unparseable as JSON\n  MALFORMED_JSON_RESPONSE: '4',\n  // Occurs when a publisher has specified the same url\n  // or vendor url (after macros are substituted) to call out to more than once.\n  DUPLICATE_URL: '5',\n  // Occurs when a URL fails isSecureUrl check.\n  INSECURE_URL: '6',\n  // Occurs when 5 valid callout urls have already been built, and additional\n  // urls are still specified.\n  MAX_CALLOUTS_EXCEEDED: '7',\n  // Occurs due to XHR failure.\n  NETWORK_FAILURE: '8',\n  // Occurs when a specified vendor does not exist in RTC_VENDORS.\n  UNKNOWN_VENDOR: '9',\n  // Occurs when request took longer than timeout\n  TIMEOUT: '10',\n  // Occurs when URL expansion time exceeded allowed timeout, request never\n  // sent.\n  MACRO_EXPAND_TIMEOUT: '11',\n};\n\nexport class RealTimeConfigManager {\n  /**\n   * @param {!./amp-a4a.AmpA4A} a4aElement\n   */\n  constructor(a4aElement) {\n    /** @private {!./amp-a4a.AmpA4A} */\n    this.a4aElement_ = a4aElement;\n\n    /** @private {!Window} */\n    this.win_ = this.a4aElement_.win;\n\n    /** @private {!Object<string, boolean>} */\n    this.seenUrls_ = {};\n\n    /** @private {?number} */\n    this.rtcStartTime_ = null;\n\n    /** @private {!Array<!Promise<!rtcResponseDef>>} */\n    this.promiseArray_ = [];\n\n    /** @private {?RtcConfigDef} */\n    this.rtcConfig_ = null;\n\n    /** @private !../../../src/service/ampdoc-impl.AmpDoc */\n    this.ampDoc_ = this.a4aElement_.getAmpDoc();\n\n    /** @private {?CONSENT_POLICY_STATE} */\n    this.consentState_ = null;\n  }\n\n  /**\n   * @param {string} error\n   * @param {string} callout\n   * @param {string} errorReportingUrl\n   * @param {number=} opt_rtcTime\n   * @return {!Promise<!rtcResponseDef>}\n   * @private\n   */\n  buildErrorResponse_(\n    error, callout, errorReportingUrl, opt_rtcTime) {\n    dev().warn(TAG, `RTC callout to ${callout} caused ${error}`);\n    if (errorReportingUrl) {\n      this.sendErrorMessage(error, errorReportingUrl);\n    }\n    return Promise.resolve(/**@type {rtcResponseDef} */(\n      {error, callout, rtcTime: opt_rtcTime || 0}));\n  }\n\n  /**\n   * @param {string} errorType Uses the RTC_ERROR_ENUM above.\n   * @param {string} errorReportingUrl\n   */\n  sendErrorMessage(errorType, errorReportingUrl) {\n    if (!ERROR_REPORTING_ENABLED) {\n      return;\n    }\n    const whitelist = {ERROR_TYPE: true, HREF: true};\n    const macros = {\n      ERROR_TYPE: errorType,\n      HREF: this.win_.location.href,\n    };\n    const url = Services.urlReplacementsForDoc(this.ampDoc_).expandUrlSync(\n        errorReportingUrl, macros, whitelist);\n    new this.win_.Image().src = url;\n  }\n\n  /**\n   * Converts a URL into its corresponding shortened callout string.\n   * We also truncate to a maximum length of 50 characters.\n   * For instance, if we are passed\n   * \"https://example.com/example.php?foo=a&bar=b, then we return\n   * example.com/example.php\n   * @param {string} url\n   * @return {string}\n   */\n  getCalloutParam_(url) {\n    const parsedUrl = Services.urlForDoc(\n        this.a4aElement_.getAmpDoc()).parse(url);\n    return (parsedUrl.hostname + parsedUrl.pathname).substr(0, 50);\n  }\n\n  /**\n   * For a given A4A Element, sends out Real Time Config requests to\n   * any urls or vendors specified by the publisher.\n   * @param {!Object<string, !../../../src/service/variable-source.AsyncResolverDef>} customMacros The ad-network specified macro\n   *   substitutions available to use.\n   * @param {?CONSENT_POLICY_STATE} consentState\n   * @return {Promise<!Array<!rtcResponseDef>>|undefined}\n   * @visibleForTesting\n   */\n  maybeExecuteRealTimeConfig(customMacros, consentState) {\n    if (!this.validateRtcConfig_(this.a4aElement_.element)) {\n      return;\n    }\n    this.consentState_ = consentState;\n    this.modifyRtcConfigForConsentStateSettings();\n    customMacros = this.assignMacros(customMacros);\n    this.rtcStartTime_ = Date.now();\n    this.handleRtcForCustomUrls(customMacros);\n    this.handleRtcForVendorUrls(customMacros);\n    return Promise.all(this.promiseArray_);\n  }\n\n  /**\n   * Returns whether a given callout object is valid to send an RTC request\n   * to, for the given consentState.\n   * @param {Object|string} calloutConfig\n   * @param {boolean=} optIsGloballyValid\n   * @return {boolean}\n   * @visibleForTesting\n   */\n  isValidCalloutForConsentState(calloutConfig, optIsGloballyValid) {\n    const {sendRegardlessOfConsentState} = calloutConfig;\n    if (!isObject(calloutConfig) || !sendRegardlessOfConsentState) {\n      return !!optIsGloballyValid;\n    }\n\n    if (typeof sendRegardlessOfConsentState == 'boolean') {\n      return sendRegardlessOfConsentState;\n    }\n\n    if (isArray(sendRegardlessOfConsentState)) {\n      for (let i = 0; i < sendRegardlessOfConsentState.length; i++) {\n        if (this.consentState_ ==\n            CONSENT_POLICY_STATE[sendRegardlessOfConsentState[i]]) {\n          return true;\n        } else if (!CONSENT_POLICY_STATE[sendRegardlessOfConsentState[i]]) {\n          dev().warn(TAG, 'Invalid RTC consent state given: ' +\n                     `${sendRegardlessOfConsentState[i]}`);\n        }\n      }\n      return false;\n    }\n    user().warn(TAG, 'Invalid value for sendRegardlessOfConsentState:' +\n                `${sendRegardlessOfConsentState}`);\n    return !!optIsGloballyValid;\n  }\n\n  /**\n   * Goes through the RTC config, and for any URL that we should not callout\n   * as per the current consent state, deletes it from the RTC config.\n   * For example, if the RTC config looked like:\n   *    {vendors: {vendorA: {'sendRegardlessOfConsentState': true}\n   *               vendorB: {'macros': {'SLOT_ID': 1}}},\n   *     urls: ['https://www.rtc.example/example',\n   *            {url: 'https://www.rtcSite2.example/example',\n   *             sendRegardlessOfConsentState: ['UNKNOWN']}]\n   *    }\n   * and the consentState is CONSENT_POLICY_STATE.UNKNOWN,\n   * then this method call would clear the callouts to vendorB, and to the first\n   * custom URL.\n   */\n  modifyRtcConfigForConsentStateSettings() {\n    if (this.consentState_ == undefined ||\n        this.consentState_ == CONSENT_POLICY_STATE.SUFFICIENT ||\n        this.consentState_ == CONSENT_POLICY_STATE.UNKNOWN_NOT_REQUIRED) {\n      return;\n    }\n\n    const isGloballyValid = this.isValidCalloutForConsentState(this.rtcConfig_);\n    this.rtcConfig_.urls = (this.rtcConfig_.urls || []).filter(\n        url => this.isValidCalloutForConsentState(url, isGloballyValid));\n\n    Object.keys(this.rtcConfig_.vendors || {}).forEach(vendor => {\n      if (!this.isValidCalloutForConsentState(\n          this.rtcConfig_.vendors[vendor], isGloballyValid)) {\n        delete this.rtcConfig_.vendors[vendor];\n      }\n    });\n\n  }\n\n  /**\n   * Assigns constant macros that should exist for all RTC to object of custom\n   * per-network macros.\n   * @param {!Object<string, !../../../src/service/variable-source.AsyncResolverDef>} macros\n   */\n  assignMacros(macros) {\n    macros['TIMEOUT'] = () => this.rtcConfig_.timeoutMillis;\n    macros['CONSENT_STATE'] = () => this.consentState_;\n    return macros;\n  }\n\n  /**\n   * Manages sending the RTC callouts for the Custom URLs.\n   * @param {!Object<string, !../../../src/service/variable-source.AsyncResolverDef>} customMacros The ad-network specified macro\n   */\n  handleRtcForCustomUrls(customMacros) {\n    // For each publisher defined URL, inflate the url using the macros,\n    // and send the RTC request.\n    (this.rtcConfig_.urls || []).forEach(urlObj => {\n      let url, errorReportingUrl;\n      if (isObject(urlObj)) {\n        url = urlObj.url;\n        errorReportingUrl = urlObj.errorReportingUrl;\n      } else if (typeof urlObj == 'string') {\n        url = urlObj;\n      } else {\n        dev().warn(TAG, `Invalid url: ${urlObj}`);\n      }\n      this.inflateAndSendRtc_(url,\n          customMacros,\n          errorReportingUrl);\n    });\n  }\n\n  /**\n   * Manages sending the RTC callouts for all specified vendors.\n   * @param {!Object<string, !../../../src/service/variable-source.AsyncResolverDef>} customMacros The ad-network specified macro\n   */\n  handleRtcForVendorUrls(customMacros) {\n    // For each vendor the publisher has specified, inflate the vendor\n    // url if it exists, and send the RTC request.\n    Object.keys(this.rtcConfig_.vendors || []).forEach(vendor => {\n      const vendorObject = RTC_VENDORS[vendor.toLowerCase()];\n      const url = vendorObject ? vendorObject.url : '';\n      const errorReportingUrl = vendorObject && vendorObject.errorReportingUrl ?\n        vendorObject.errorReportingUrl : '';\n      if (!url) {\n        return this.promiseArray_.push(\n            this.buildErrorResponse_(\n                RTC_ERROR_ENUM.UNKNOWN_VENDOR, vendor, errorReportingUrl));\n      }\n      // There are two valid configurations of the vendor object.\n      // It can either be an object of macros mapping string to string,\n      // or it can be an object with sub-objects, one of which can be\n      // 'macros'. This is for backwards compatability.\n      const vendorMacros =\n            isObject(this.rtcConfig_.vendors[vendor]['macros']) ?\n              this.rtcConfig_.vendors[vendor]['macros'] :\n              this.rtcConfig_.vendors[vendor];\n      const validVendorMacros = {};\n      Object.keys(vendorMacros).forEach(macro => {\n        if (!(vendorObject.macros && vendorObject.macros.includes(macro))) {\n          user().error(TAG, `Unknown macro: ${macro} for vendor: ${vendor}`);\n        } else {\n          const value = vendorMacros[macro];\n          validVendorMacros[macro] = isObject(value) || isArray(value) ?\n            JSON.stringify(value) : value;\n        }\n      });\n      // The ad network defined macros override vendor defined/pub specifed.\n      const macros = Object.assign(validVendorMacros, customMacros);\n      this.inflateAndSendRtc_(url,\n          macros, errorReportingUrl,\n          vendor.toLowerCase());\n    });\n  }\n\n  /**\n   * @param {string} url\n   * @param {!Object<string, !../../../src/service/variable-source.AsyncResolverDef>} macros\n   * @param {string} errorReportingUrl\n   * @param {string=} opt_vendor\n   * @private\n   */\n  inflateAndSendRtc_(url,\n    macros, errorReportingUrl, opt_vendor) {\n    let {timeoutMillis} = this.rtcConfig_;\n    const callout = opt_vendor || this.getCalloutParam_(url);\n    const checkStillCurrent = this.a4aElement_.verifyStillCurrent.bind(\n        this.a4aElement_)();\n    /**\n     * The time that it takes to substitute the macros into the URL can vary\n     * depending on what the url requires to be substituted, i.e. a long\n     * async call. Thus, however long the URL replacement took is treated as a\n     * time penalty.\n     * @param {string} url\n     */\n    const send = url => {\n      if (Object.keys(this.seenUrls_).length == MAX_RTC_CALLOUTS) {\n        return this.buildErrorResponse_(\n            RTC_ERROR_ENUM.MAX_CALLOUTS_EXCEEDED,\n            callout, errorReportingUrl);\n      }\n      if (!Services.urlForDoc(\n          this.a4aElement_.getAmpDoc()).isSecure(url)) {\n        return this.buildErrorResponse_(RTC_ERROR_ENUM.INSECURE_URL,\n            callout, errorReportingUrl);\n      }\n      if (this.seenUrls_[url]) {\n        return this.buildErrorResponse_(RTC_ERROR_ENUM.DUPLICATE_URL,\n            callout, errorReportingUrl);\n      }\n      this.seenUrls_[url] = true;\n      if (url.length > MAX_URL_LENGTH) {\n        url = this.truncUrl_(url);\n      }\n      return this.sendRtcCallout_(\n          url, timeoutMillis, callout, checkStillCurrent,\n          errorReportingUrl);\n    };\n\n    const whitelist = {};\n    Object.keys(macros).forEach(key => whitelist[key] = true);\n    const urlReplacementStartTime = Date.now();\n    this.promiseArray_.push(Services.timerFor(this.win_).timeoutPromise(\n        timeoutMillis,\n        Services.urlReplacementsForDoc(this.ampDoc_).expandUrlAsync(\n            url, macros, whitelist)).then(url => {\n      checkStillCurrent();\n      timeoutMillis -= (urlReplacementStartTime - Date.now());\n      return send(url);\n    }).catch(error => {\n      return isCancellation(error) ? undefined :\n        this.buildErrorResponse_(RTC_ERROR_ENUM.MACRO_EXPAND_TIMEOUT,\n            callout, errorReportingUrl);\n    }));\n  }\n\n\n  /**\n   * @param {string} url\n   * @return {string}\n   */\n  truncUrl_(url) {\n    url = url.substr(0, MAX_URL_LENGTH - 12).replace(/%\\w?$/, '');\n    return url + '&__trunc__=1';\n  }\n\n  /**\n   * @param {string} url\n   * @param {number} timeoutMillis\n   * @param {string} callout\n   * @param {!Function} checkStillCurrent\n   * @param {string} errorReportingUrl\n   * @return {!Promise<!rtcResponseDef>}\n   * @private\n   */\n  sendRtcCallout_(url, timeoutMillis, callout, checkStillCurrent,\n    errorReportingUrl) {\n    /**\n     * Note: Timeout is enforced by timerFor, not the value of\n     *   rtcTime. There are situations where rtcTime could thus\n     *   end up being greater than timeoutMillis.\n     */\n    return Services.timerFor(this.win_).timeoutPromise(\n        timeoutMillis,\n        Services.xhrFor(this.win_).fetchJson(\n            // NOTE(bradfrizzell): we could include ampCors:false allowing\n            // the request to be cached across sites but for now assume that\n            // is not a required feature.\n            url, {credentials: 'include'}).then(res => {\n          checkStillCurrent();\n          return res.text().then(text => {\n            checkStillCurrent();\n            const rtcTime = Date.now() - this.rtcStartTime_;\n            // An empty text response is allowed, not an error.\n            if (!text) {\n              return {rtcTime, callout};\n            }\n            const response = tryParseJson(text);\n            return response ? {response, rtcTime, callout} :\n              this.buildErrorResponse_(\n                  RTC_ERROR_ENUM.MALFORMED_JSON_RESPONSE, callout,\n                  errorReportingUrl, rtcTime);\n          });\n        })).catch(error => {\n      return isCancellation(error) ? undefined :\n        this.buildErrorResponse_(\n            // The relevant error message for timeout looks like it is\n            // just 'message' but is in fact 'messageXXX' where the\n            // X's are hidden special characters. That's why we use\n            // match here.\n            (/^timeout/.test(error.message)) ?\n              RTC_ERROR_ENUM.TIMEOUT : RTC_ERROR_ENUM.NETWORK_FAILURE,\n            callout, errorReportingUrl, Date.now() - this.rtcStartTime_);\n    });\n  }\n\n  /**\n   * Attempts to parse the publisher-defined RTC config off the amp-ad\n   * element, then validates that the rtcConfig exists, and contains\n   * an entry for either vendor URLs, or publisher-defined URLs. If the\n   * config contains an entry for timeoutMillis, validates that it is a\n   * number, or converts to a number if number-like, otherwise overwrites\n   * with the default.\n   * IMPORTANT: If the rtcConfig is invalid, RTC is aborted, and the ad\n   *   request continues without RTC.\n   * @param {!Element} element\n   * @return {boolean}\n   */\n  validateRtcConfig_(element) {\n    const defaultTimeoutMillis = 1000;\n    const unparsedRtcConfig = element.getAttribute('rtc-config');\n    if (!unparsedRtcConfig) {\n      return false;\n    }\n    const rtcConfig = tryParseJson(unparsedRtcConfig);\n    if (!rtcConfig) {\n      user().warn(TAG, 'Could not JSON parse rtc-config attribute');\n      return false;\n    }\n\n    let timeout;\n    try {\n      user().assert(rtcConfig['vendors'] || rtcConfig['urls'],\n          'RTC Config must specify vendors or urls');\n      Object.keys(rtcConfig).forEach(key => {\n        switch (key) {\n          case 'vendors':\n            user().assert(isObject(rtcConfig[key]), 'RTC invalid vendors');\n            break;\n          case 'urls':\n            user().assert(isArray(rtcConfig[key]), 'RTC invalid urls');\n            break;\n          case 'timeoutMillis':\n            timeout = parseInt(rtcConfig[key], 10);\n            if (isNaN(timeout)) {\n              user().warn(TAG, 'Invalid RTC timeout is NaN, ' +\n                          `using default timeout ${defaultTimeoutMillis}ms`);\n              timeout = undefined;\n            } else if (timeout >= defaultTimeoutMillis || timeout < 0) {\n              user().warn(TAG, `Invalid RTC timeout: ${timeout}ms, ` +\n                          `using default timeout ${defaultTimeoutMillis}ms`);\n              timeout = undefined;\n            }\n            break;\n          default:\n            user().warn(TAG, `Unknown RTC Config key: ${key}`);\n            break;\n        }\n      });\n      if (!Object.keys(rtcConfig['vendors'] || {}).length\n          && !(rtcConfig['urls'] || []).length) {\n        return false;\n      }\n      const validateErrorReportingUrl = urlObj => {\n        const errorUrl = urlObj['errorReportingUrl'];\n        if (errorUrl && !Services.urlForDoc(\n            this.a4aElement_.getAmpDoc()).isSecure(errorUrl)) {\n          dev().warn(TAG, `Insecure RTC errorReportingUrl: ${errorUrl}`);\n          urlObj['errorReportingUrl'] = undefined;\n        }\n      };\n      (rtcConfig['urls'] || []).forEach(urlObj => {\n        if (isObject(urlObj)) {\n          validateErrorReportingUrl(urlObj);\n        }\n      });\n      validateErrorReportingUrl(rtcConfig);\n    } catch (unusedErr) {\n      // This error would be due to the asserts above.\n      return false;\n    }\n    rtcConfig['timeoutMillis'] = timeout !== undefined ?\n      timeout : defaultTimeoutMillis;\n    this.rtcConfig_ = /** @type {RtcConfigDef} */(rtcConfig);\n    return true;\n  }\n}\nAMP.RealTimeConfigManager = RealTimeConfigManager;\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {IntersectionObserverPolyfill} from '../../../src/intersection-observer-polyfill';\nimport {dev} from '../../../src/log';\n\nexport class RefreshIntersectionObserverWrapper {\n  /**\n   * A thin wrapper class to allow the IntersectionObserverPolyfill to work with\n   * refresh.\n   * @param {function(!Array<!IntersectionObserverEntry>)} callback\n   * @param {!AMP.BaseElement} baseElement\n   * @param {Object} config\n   */\n  constructor(callback, baseElement, config) {\n\n    /**\n     * @private @const {!IntersectionObserverPolyfill}\n     */\n    this.intersectionObserver_ = new IntersectionObserverPolyfill(\n        callback, config);\n\n    /**\n     * Stores elements and their original viewportCallback functions so that\n     * they can be reverted upon invocation of unobserve.\n     * @private {!Object<string, function()>}\n     */\n    this.viewportCallbacks_ = {};\n\n    /** @private @const {!../../../src/service/viewport/viewport-impl.Viewport} */\n    this.viewport_ = baseElement.getViewport();\n\n    /**\n     * Flag that indicates when #tick should be called on the observer\n     * polyfill.\n     * @private {boolean}\n     */\n    this.updateObserver_ = false;\n  }\n\n  /**\n   * Begin observing the given element.\n   * @param {!Element} element\n   */\n  observe(element) {\n    // The attribute name is exported in refresh-manager.js as\n    // DATA_MANAGER_ID_NAME, but unfortunately, it can't be imported without\n    // creating a cyclical dependency.\n    const refreshId = element.getAttribute('data-amp-ad-refresh-id');\n    dev().assert(refreshId, 'observe invoked on element without refresh id');\n\n    if (!this.viewportCallbacks_[refreshId]) {\n      const viewportCallback = element.viewportCallback.bind(element);\n      this.viewportCallbacks_[refreshId] = viewportCallback;\n      element.viewportCallback = inViewport => {\n        if (this.updateObserver_) {\n          this.intersectionObserver_.tick(this.viewport_.getRect());\n        }\n        viewportCallback(inViewport);\n      };\n    }\n\n    this.updateObserver_ = true;\n    this.intersectionObserver_.observe(element);\n    // Elements that appear and remain within the viewport for the duration of\n    // their existence may never have viewportCallback invoked. To ensure that\n    // refresh is triggered, we need to make this initial call.\n    this.intersectionObserver_.tick(this.viewport_.getRect());\n  }\n\n  /**\n   * Cease observing the given element.\n   * @param {!Element} element\n   */\n  unobserve(element) {\n    // We need to call 'tick' to update current host viewport state, otherwise\n    // the next time we call 'observe', the viewport state might be stale, and\n    // indicate that the element is in the viewport when it's not.\n    this.intersectionObserver_.tick(this.viewport_.getRect());\n    this.intersectionObserver_.unobserve(element);\n    this.updateObserver_ = false;\n  }\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefreshIntersectionObserverWrapper} from './refresh-intersection-observer-wrapper';\nimport {Services} from '../../../src/services';\nimport {dev, user} from '../../../src/log';\n\n/**\n * - visibilePercentageMin: The percentage of pixels that need to be on screen\n *   for the creative to be considered \"visible\".\n * - continuousTimeMin: The amount of continuous time, in milliseconds, that\n *   the creative must be on screen for in order to be considered \"visible\".\n *\n * @typedef {{\n *   visiblePercentageMin: number,\n *   continuousTimeMin: number,\n * }}\n */\nexport let RefreshConfig;\n\nexport const MIN_REFRESH_INTERVAL = 30;\nexport const DATA_ATTR_NAME = 'data-enable-refresh';\nexport const DATA_MANAGER_ID_NAME = 'data-amp-ad-refresh-id';\nexport const METATAG_NAME = 'amp-ad-enable-refresh';\n\nconst TAG = 'AMP-AD';\n\n/**\n * Retrieves the publisher-specified refresh interval, if one were set. This\n * function first checks for appropriate slot attributes and then for\n * metadata tags, preferring whichever it finds first.\n * @param {!Element} element\n * @param {!Window} win\n * @return {?number}\n * @visibleForTesting\n */\nexport function getPublisherSpecifiedRefreshInterval(element, win) {\n  const refreshInterval = element.getAttribute(DATA_ATTR_NAME);\n  if (refreshInterval) {\n    return checkAndSanitizeRefreshInterval(refreshInterval);\n  }\n  let metaTag;\n  const metaTagContent = ((metaTag = win.document\n      .getElementsByName(METATAG_NAME))\n      && metaTag[0]\n      && metaTag[0].getAttribute('content'));\n  if (!metaTagContent) {\n    return null;\n  }\n  const networkIntervalPairs = metaTagContent.split(',');\n  for (let i = 0; i < networkIntervalPairs.length; i++) {\n    const pair = networkIntervalPairs[i].split('=');\n    user().assert(pair.length == 2, 'refresh metadata config must be of ' +\n        'the form `network_type=refresh_interval`');\n    if (pair[0].toLowerCase() == element.getAttribute('type').toLowerCase()) {\n      return checkAndSanitizeRefreshInterval(pair[1]);\n    }\n  }\n  return null;\n}\n\n/**\n * Ensures that refreshInterval is a number no less than 30. Returns null if\n * the given input fails to meet these criteria. This also converts from\n * seconds to milliseconds.\n *\n * @param {(number|string)} refreshInterval\n * @return {?number}\n */\nfunction checkAndSanitizeRefreshInterval(refreshInterval) {\n  const refreshIntervalNum = Number(refreshInterval);\n  if (isNaN(refreshIntervalNum) ||\n      refreshIntervalNum < MIN_REFRESH_INTERVAL) {\n    user().warn(TAG,\n        'invalid refresh interval, must be a number no less than ' +\n        `${MIN_REFRESH_INTERVAL}: ${refreshInterval}`);\n    return null;\n  }\n  return refreshIntervalNum * 1000;\n}\n\n/**\n * Defines the DFA states for the refresh cycle.\n *\n * 1. All newly registered elements begin in the INITIAL state.\n * 2. Only when the element enters the viewport with the specified\n *    intersection ratio does it transition into the VIEW_PENDING state.\n * 3. If the element remains in the viewport for the specified duration, it\n *    will then transition into the REFRESH_PENDING state, otherwise it will\n *    transition back into the INITIAL state.\n * 4. The element will remain in REFRESH_PENDING state until the refresh\n *    interval expires.\n * 5. Once the interval expires, the element will return to the INITIAL state.\n *\n * @enum {string}\n */\nconst RefreshLifecycleState = {\n  /**\n   * Element has been registered, but not yet seen on screen.\n   */\n  INITIAL: 'initial',\n\n  /**\n   * The element has appeared in the viewport, but not yet for the required\n   * duration.\n   */\n  VIEW_PENDING: 'view_pending',\n\n  /**\n   * The element has been in the viewport for the required duration; the\n   * refresh interval for the element has begun.\n   */\n  REFRESH_PENDING: 'refresh_pending',\n};\n\n/**\n * An object containing the IntersectionObservers used to monitor elements.\n * Each IO is configured to a different threshold, and all elements that\n * share the same visiblePercentageMin will be monitored by the same IO.\n *\n * @const {!Object<string, (!IntersectionObserver|!RefreshIntersectionObserverWrapper)>}\n */\nconst observers = {};\n\n/**\n * An object containing all currently active RefreshManagers. This is used in\n * the IntersectionOberserver callback function to find the appropriate element\n * target.\n *\n * @const {!Object<string, !RefreshManager>}\n */\nconst managers = {};\n\n/**\n * Used to generate unique IDs for each RefreshManager.\n * @type {number}\n */\nlet refreshManagerIdCounter = 0;\n\n/**\n * Returns an instance of RefreshManager, if refresh is enabled on the page or\n * slot. An optional predicate for eligibility may be passed. If refresh is not\n * enabled, or fails the optional predicate, null will be returned.\n *\n * @param {!./amp-a4a.AmpA4A} a4a\n * @param {function():boolean=} opt_predicate\n * @return {?RefreshManager}\n */\nexport function getRefreshManager(a4a, opt_predicate) {\n  const refreshInterval =\n      getPublisherSpecifiedRefreshInterval(a4a.element, a4a.win);\n  if (!refreshInterval || (opt_predicate && !opt_predicate())) {\n    return null;\n  }\n  return new RefreshManager(a4a, {\n    visiblePercentageMin: 50,\n    continuousTimeMin: 1,\n  }, refreshInterval);\n}\n\n\nexport class RefreshManager {\n\n  /**\n   * @param {!./amp-a4a.AmpA4A} a4a The AmpA4A instance to be refreshed.\n   * @param {!RefreshConfig} config\n   * @param {number} refreshInterval\n   */\n  constructor(a4a, config, refreshInterval) {\n\n    /** @private {string} */\n    this.state_ = RefreshLifecycleState.INITIAL;\n\n    /** @const @private {!./amp-a4a.AmpA4A} */\n    this.a4a_ = a4a;\n\n    /** @const @private {!Window} */\n    this.win_ = a4a.win;\n\n    /** @const @private {!Element} */\n    this.element_ = a4a.element;\n\n    /** @const @private {string} */\n    this.adType_ = this.element_.getAttribute('type').toLowerCase();\n\n    /** @const @private {?number} */\n    this.refreshInterval_ = refreshInterval;\n\n    /** @const @private {!RefreshConfig} */\n    this.config_ = this.convertAndSanitizeConfiguration_(config);\n\n    /** @const @private {!../../../src/service/timer-impl.Timer} */\n    this.timer_ = Services.timerFor(this.win_);\n\n    /** @private {?(number|string)} */\n    this.refreshTimeoutId_ = null;\n\n    /** @private {?(number|string)} */\n    this.visibilityTimeoutId_ = null;\n\n    const managerId = String(refreshManagerIdCounter++);\n    this.element_.setAttribute(DATA_MANAGER_ID_NAME, managerId);\n    managers[managerId] = this;\n    this.initiateRefreshCycle();\n  }\n\n  /**\n   * Returns an IntersectionObserver configured to the given threshold, creating\n   * one if one does not yet exist.\n   *\n   * @param {number} threshold\n   * @return {(!IntersectionObserver|!RefreshIntersectionObserverWrapper)}\n   */\n  getIntersectionObserverWithThreshold_(threshold) {\n\n    const thresholdString = String(threshold);\n    return observers[thresholdString] ||\n        (observers[thresholdString] = 'IntersectionObserver' in this.win_\n          ? new this.win_['IntersectionObserver'](this.ioCallback_, {threshold})\n          : new RefreshIntersectionObserverWrapper(\n              this.ioCallback_, this.a4a_, {threshold}));\n  }\n\n  /**\n   * Returns a function that will be invoked directly by the\n   * IntersectionObserver implementation. It will implement the core logic of\n   * the refresh lifecycle, including the transitions of the DFA.\n   *\n   * @param {!Array<!IntersectionObserverEntry>} entries\n   */\n  ioCallback_(entries) {\n    entries.forEach(entry => {\n      const refreshManagerId = entry.target.getAttribute(DATA_MANAGER_ID_NAME);\n      dev().assert(refreshManagerId);\n      const refreshManager = managers[refreshManagerId];\n      if (entry.target != refreshManager.element_) {\n        return;\n      }\n      switch (refreshManager.state_) {\n        case RefreshLifecycleState.INITIAL:\n          // First check if the element qualifies as \"being on screen\", i.e.,\n          // that at least a minimum threshold of pixels is on screen. If so,\n          // begin a timer, set for the duration of the minimum time on screen\n          // threshold. If this timer runs out without interruption, then all\n          // viewability conditions have been met, and we can begin the refresh\n          // timer.\n          if (entry.intersectionRatio >=\n              refreshManager.config_.visiblePercentageMin) {\n            refreshManager.state_ = RefreshLifecycleState.VIEW_PENDING;\n            refreshManager.visibilityTimeoutId_ = refreshManager.timer_.delay(\n                () => {\n                  refreshManager.state_ = RefreshLifecycleState.REFRESH_PENDING;\n                  refreshManager.startRefreshTimer_();\n                }, refreshManager.config_.continuousTimeMin);\n          }\n          break;\n        case RefreshLifecycleState.VIEW_PENDING:\n          // If the element goes off screen before the minimum on screen time\n          // duration elapses, place it back into INITIAL state.\n          if (entry.intersectionRatio <\n              refreshManager.config_.visiblePercentageMin) {\n            refreshManager.timer_.cancel(refreshManager.visibilityTimeoutId_);\n            refreshManager.visibilityTimeoutId_ = null;\n            refreshManager.state_ = RefreshLifecycleState.INITIAL;\n          }\n          break;\n        case RefreshLifecycleState.REFRESH_PENDING:\n        default:\n          break;\n      }\n    });\n  }\n\n  /**\n   * Initiates the refresh cycle by initiating the visibility manager on the\n   * element.\n   */\n  initiateRefreshCycle() {\n    switch (this.state_) {\n      case RefreshLifecycleState.INITIAL:\n        this.getIntersectionObserverWithThreshold_(\n            this.config_.visiblePercentageMin).observe(this.element_);\n        break;\n      case RefreshLifecycleState.REFRESH_PENDING:\n      case RefreshLifecycleState.VIEW_PENDING:\n      default:\n        break;\n\n    }\n  }\n\n  /**\n   * Starts the refresh timer for the given monitored element.\n   *\n   * @return {!Promise<boolean>} A promise that resolves to true when the\n   *    refresh timer elapses successfully.\n   */\n  startRefreshTimer_() {\n    return new Promise(resolve => {\n      this.refreshTimeoutId_ = this.timer_.delay(() => {\n        this.state_ = RefreshLifecycleState.INITIAL;\n        this.unobserve();\n        this.a4a_.refresh(() => this.initiateRefreshCycle());\n        resolve(true);\n      }, /** @type {number} */ (this.refreshInterval_));\n    });\n  }\n\n  /**\n   * Converts config to appropriate units, modifying the argument in place. This\n   * also ensures that visiblePercentageMin is in the range of [0, 100].\n   * @param {!RefreshConfig} config\n   * @return {!RefreshConfig}\n   */\n  convertAndSanitizeConfiguration_(config) {\n    dev().assert(config['visiblePercentageMin'] >= 0 &&\n        config['visiblePercentageMin'] <= 100,\n    'visiblePercentageMin for refresh must be in the range [0, 100]');\n    // Convert seconds to milliseconds.\n    config['continuousTimeMin'] *= 1000;\n    config['visiblePercentageMin'] /= 100;\n    return config;\n  }\n\n  /**\n   * Stops the intersection observer from observing the element.\n   */\n  unobserve() {\n    this.getIntersectionObserverWithThreshold_(\n        this.config_.visiblePercentageMin).unobserve(this.element_);\n  }\n}\n\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from '../../../src/services';\nimport {base64DecodeToBytes} from '../../../src/utils/base64';\nimport {dev, user} from '../../../src/log';\nimport {isArray} from '../../../src/types';\n\n/** @visibleForTesting */\nexport const AMP_SIGNATURE_HEADER = 'AMP-Fast-Fetch-Signature';\n\n/**\n * The result of an attempt to verify a Fast Fetch signature. The different\n * error statuses are used for reporting errors to the ad network.\n *\n * @enum {number}\n */\nexport const VerificationStatus = {\n\n  /** The ad was successfully verified as AMP. */\n  OK: 0,\n\n  /**\n   * Verification failed because of a factor beyond the ad network's control,\n   * such as a network connectivity failure, unavailability of Web Cryptography\n   * in the current browsing context, or a misbehaving signing service.\n   */\n  UNVERIFIED: 1,\n\n  /**\n   * Verification failed because the keypair ID provided by the ad network did\n   * not correspond to any public key offered by the signing service.\n   */\n  ERROR_KEY_NOT_FOUND: 2,\n\n  /**\n   * Verification failed because the signature provided by the ad network was\n   * not the correct cryptographic signature for the given creative data and\n   * public key.\n   */\n  ERROR_SIGNATURE_MISMATCH: 3,\n\n  /**\n   * Verification failed because the page does not have web crypto available,\n   * i.e. is not SSL.\n   */\n  CRYPTO_UNAVAILABLE: 4,\n\n};\n\n/**\n * A window-level object that encapsulates the logic for obtaining public keys\n * from Fast Fetch signing services and cryptographically verifying signatures\n * of AMP creatives.\n *\n * Unlike an AMP service, a signature verifier is **stateful**. It maintains a\n * cache of all public keys that it has previously downloaded and imported, and\n * also keeps track of which keys and signing services have already had\n * unsuccessful download or import attempts and should not be attempted again.\n *\n * This entire class is currently dead code in production, but will soon be\n * introduced as an experiment.\n */\nexport class SignatureVerifier {\n\n  /**\n   * @param {!Window} win\n   * @param {!Object<string, string>} signingServerURLs a map from the name of\n   *    each trusted signing service to the URL of its public key endpoint\n   */\n  constructor(win, signingServerURLs) {\n    /** @private @const {!Window} */\n    this.win_ = win;\n\n    /** @private @const {!Object<string, string>} */\n    this.signingServerURLs_ = signingServerURLs;\n\n    /**\n     * The cache where all the public keys are stored.\n     *\n     * This field has a lot of internal structure and its type's a little hairy,\n     * so here's a rundown of what each piece means:\n     *  - If Web Cryptography isn't available in the current browsing context,\n     *    then the entire field is null. Since the keys are of no use, we don't\n     *    fetch them.\n     *  - Otherwise, it's a map-like `Object` from signing service names (as\n     *    defined in the Fast Fetch config registry) to \"signer\" objects.\n     *  - The `promise` property of each signer resolves to a boolean indicating\n     *    whether the most recent attempt to fetch and import that signing\n     *    service's public keys was successful. If the promise is still pending,\n     *    then an attempt is currently in progress. This property is mutable;\n     *    its value is replaced with a new promise when a new attempt is made.\n     *    Invariant: only one attempt may be in progress at a time, so this\n     *    property may not be mutated while the current promise is pending.\n     *  - The `keys` property of each signer is a map-like `Object` from keypair\n     *    IDs to nullable key promises. (This means that a property access on\n     *    this object may evaluate to `undefined`, `null`, or a `Promise`\n     *    object.) The `keys` object is internally mutable; new keys are added\n     *    to it as they are fetched. Invariant: the `keys` object may be mutated\n     *    only while the corresponding `promise` object is pending; this ensures\n     *    that callbacks chained to `promise` may observe `keys` without being\n     *    subject to race conditions.\n     *  - If a key promise (i.e., the value of a property access on the `keys`\n     *    object) is absent (i.e., `undefined`), then no key with that keypair\n     *    ID is present (but this could be because of a stale cache). If it's\n     *    null, then no key with that keypair ID could be found even after\n     *    cachebusting. If it's a `Promise` that resolves to `null`, then key\n     *    data for that keypair ID was found but could not be imported\n     *    successfully; this most likely indicates signing service misbehavior.\n     *    The success case is a `Promise` that resolves to a `CryptoKey`.\n     *\n     * @private @const {?Object<string, {promise: !Promise<boolean>, keys: !Object<string, ?Promise<?webCrypto.CryptoKey>>}>}\n     */\n    this.signers_ = Services.cryptoFor(win).isPkcsAvailable() ? {} : null;\n\n    /**\n     * Gets a notion of current time, in ms.  The value is not necessarily\n     * absolute, so should be used only for computing deltas.  When available,\n     * the performance system will be used; otherwise Date.now() will be\n     * returned.\n     *\n     * @private @const {function(): number}\n     */\n    this.getNow_ = (win.performance && win.performance.now) ?\n      win.performance.now.bind(win.performance) : Date.now;\n  }\n\n  /**\n   * Fetches and imports the public keyset for the named signing service,\n   * without any cachebusting. Hopefully, this will hit cache in many cases\n   * and not make an actual network round-trip. This method should be called\n   * as early as possible, once it's known which signing service is likely to\n   * be used, so that the network request and key imports can execute in\n   * parallel with other operations.\n   *\n   * @param {string} signingServiceName\n   */\n  loadKeyset(signingServiceName) {\n    if (this.signers_ && !this.signers_[signingServiceName]) {\n      const keys = {};\n      const promise = this.fetchAndAddKeys_(keys, signingServiceName, null);\n      this.signers_[signingServiceName] = {promise, keys};\n    }\n  }\n\n  /**\n   * Extracts a cryptographic signature from `headers` and attempts to verify\n   * that it's the correct cryptographic signature for `creative`.\n   *\n   * As a precondition, `loadKeyset(signingServiceName)` must have already been\n   * called.\n   *\n   * @param {!ArrayBuffer} creative\n   * @param {!Headers} headers\n   * @return {!Promise<!VerificationStatus>}\n   */\n  verify(creative, headers) {\n    const signatureFormat =\n        /^([A-Za-z0-9._-]+):([A-Za-z0-9._-]+):([A-Za-z0-9+/]{341}[AQgw]==)$/;\n    if (!headers.has(AMP_SIGNATURE_HEADER)) {\n      return Promise.resolve(VerificationStatus.UNVERIFIED);\n    }\n    const headerValue = headers.get(AMP_SIGNATURE_HEADER);\n    const match = signatureFormat.exec(headerValue);\n    if (!match) {\n      // TODO(@taymonbeal, #9274): replace this with real error reporting\n      user().error(\n          'AMP-A4A', `Invalid signature header: ${headerValue.split(':')[0]}`);\n      return Promise.resolve(VerificationStatus.ERROR_SIGNATURE_MISMATCH);\n    }\n    return this.verifyCreativeAndSignature(\n        match[1], match[2], base64DecodeToBytes(match[3]), creative);\n  }\n\n  /**\n   * Verifies that `signature` is the correct cryptographic signature for\n   * `creative`, with the public key from the named signing service identified\n   * by `keypairId`.\n   *\n   * As a precondition, `loadKeyset(signingServiceName)` must have already been\n   * called.\n   *\n   * If the keyset for the named signing service was imported successfully but\n   * did not include a key for `keypairId`, this may be the result of a stale\n   * browser cache. To work around this, `keypairId` is added to the public key\n   * endpoint URL as a query parameter and the keyset is re-fetched. Other kinds\n   * of failures, including network connectivity failures, are not retried.\n   *\n   * @param {string} signingServiceName\n   * @param {string} keypairId\n   * @param {!Uint8Array} signature\n   * @param {!ArrayBuffer} creative\n   * @return {!Promise<!VerificationStatus>}\n   * @visibleForTesting\n   */\n  verifyCreativeAndSignature(\n    signingServiceName, keypairId, signature, creative) {\n    if (!this.signers_) {\n      // Web Cryptography isn't available.\n      return Promise.resolve(VerificationStatus.CRYPTO_UNAVAILABLE);\n    }\n    const signer = this.signers_[signingServiceName];\n    dev().assert(\n        signer, 'Keyset for service %s not loaded before verification',\n        signingServiceName);\n    return signer.promise.then(success => {\n      if (!success) {\n        // The public keyset couldn't be fetched and imported. Probably a\n        // network connectivity failure.\n        return VerificationStatus.UNVERIFIED;\n      }\n      const keyPromise = signer.keys[keypairId];\n      if (keyPromise === undefined) {\n        // We don't have this key, but maybe the cache is stale; try\n        // cachebusting.\n        signer.promise =\n            this.fetchAndAddKeys_(signer.keys, signingServiceName, keypairId)\n                .then(success => {\n                  if (signer.keys[keypairId] === undefined) {\n                    // We still don't have this key; make sure we never try\n                    // again.\n                    signer.keys[keypairId] = null;\n                  }\n                  return success;\n                });\n        // This \"recursive\" call can recurse at most once.\n        return this.verifyCreativeAndSignature(\n            signingServiceName, keypairId, signature, creative);\n      } else if (keyPromise === null) {\n        // We don't have this key and we already tried cachebusting.\n        return VerificationStatus.ERROR_KEY_NOT_FOUND;\n      } else {\n        return keyPromise.then(key => {\n          if (!key) {\n            // This particular public key couldn't be imported. Probably the\n            // signing service's fault.\n            return VerificationStatus.UNVERIFIED;\n          }\n          const crypto = Services.cryptoFor(this.win_);\n          return crypto.verifyPkcs(key, signature, creative).then(\n              result => result ? VerificationStatus.OK :\n                VerificationStatus.ERROR_SIGNATURE_MISMATCH,\n              err => {\n                // Web Cryptography rejected the verification attempt. This\n                // hopefully won't happen in the wild, but browsers can be weird\n                // about this, so we need to guard against the possibility.\n                // Phone home to the AMP Project so that we can understand why\n                // this occurred.\n                const message = err && err.message;\n                dev().error(\n                    'AMP-A4A', `Failed to verify signature: ${message}`);\n                return VerificationStatus.UNVERIFIED;\n              });\n        });\n      }\n    });\n  }\n\n  /**\n   * Try to download the keyset for the named signing service and add a promise\n   * for each key to the `keys` object.\n   *\n   * @param {!Object<string, ?Promise<?webCrypto.CryptoKey>>} keys the object to\n   *     add each key promise to. This is mutated while the returned promise is\n   *     pending.\n   * @param {string} signingServiceName\n   * @param {?string} keypairId the keypair ID to include in the query string\n   *     for cachebusting purposes, or `null` if no cachebusting is needed\n   * @return {!Promise<boolean>} resolves after the mutation of `keys` is\n   *     complete, to `true` if the keyset was downloaded and parsed\n   *     successfully (even if some keys were malformed), or `false` if a\n   *     keyset-level failure occurred\n   * @private\n   */\n  fetchAndAddKeys_(keys, signingServiceName, keypairId) {\n    let url = this.signingServerURLs_[signingServiceName];\n    if (keypairId != null) {\n      url += '?kid=' + encodeURIComponent(keypairId);\n    }\n    // TODO(@taymonbeal, #11088): consider a timeout on this fetch\n    return Services.xhrFor(this.win_)\n        .fetchJson(url, {\n          mode: 'cors',\n          method: 'GET',\n          // This should be cached across publisher domains, so don't append\n          // __amp_source_origin to the URL.\n          ampCors: false,\n          credentials: 'omit',\n        }).then(\n            response => {\n              // These are assertions on signing service behavior required by\n              // the spec. However, nothing terrible happens if they aren't met\n              // and there's no meaningful error recovery to be done if they\n              // fail, so we don't need to do them at runtime in production.\n              // They're included in dev mode as a debugging aid.\n              dev().assert(\n                  response.status === 200,\n                  'Fast Fetch keyset spec requires status code 200');\n              dev().assert(\n                  response.headers.get('Content-Type') ==\n                      'application/jwk-set+json',\n                  'Fast Fetch keyset spec requires Content-Type: ' +\n                      'application/jwk-set+json');\n              return response.json().then(\n                  jwkSet => {\n                    // This is supposed to be a JSON Web Key Set, as defined in\n                    // Section 5 of RFC 7517. However, the signing service could\n                    // misbehave and send an arbitrary JSON value, so we have to\n                    // type-check at runtime.\n                    if (!jwkSet || !isArray(jwkSet['keys'])) {\n                      signingServiceError(\n                          signingServiceName,\n                          `Key set (${JSON.stringify(jwkSet)}) has no \"keys\"`);\n                      return false;\n                    }\n                    jwkSet['keys'].forEach(jwk => {\n                      if (!jwk || typeof jwk['kid'] != 'string') {\n                        signingServiceError(\n                            signingServiceName,\n                            `Key (${JSON.stringify(jwk)}) has no \"kid\"`);\n                      } else if (keys[jwk['kid']] === undefined) {\n                        // We haven't seen this keypair ID before.\n                        keys[jwk['kid']] =\n                            Services.cryptoFor(this.win_).importPkcsKey(jwk)\n                                .catch(err => {\n                                  // Web Cryptography rejected the key\n                                  // import attempt. Either the signing\n                                  // service sent a malformed key or the\n                                  // browser is doing something weird.\n                                  const jwkData = JSON.stringify(jwk);\n                                  const message = err && err.message;\n                                  signingServiceError(\n                                      signingServiceName,\n                                      `Failed to import key (${\n                                        jwkData\n                                      }): ${message}`);\n                                  return null;\n                                });\n                      }\n                    });\n                    return true;\n                  },\n                  err => {\n                    // The signing service didn't send valid JSON.\n                    signingServiceError(\n                        signingServiceName,\n                        `Failed to parse JSON: ${err && err.response}`);\n                    return false;\n                  });\n            },\n            err => {\n              // Some kind of error occurred during the XHR. This could be a lot\n              // of things (and we have no type information), but if there's no\n              // `response` it's probably a network connectivity failure, so we\n              // ignore it. Unfortunately, we can't distinguish this from a CORS\n              // problem.\n              if (err && err.response) {\n                // This probably indicates a non-2xx HTTP status code.\n                signingServiceError(\n                    signingServiceName, `Status code ${err.response.status}`);\n              }\n              return false;\n            });\n  }\n}\n\n/**\n * Report an error caused by a signing service. Since signing services currently\n * don't have their own error logging URLs, we just send everything to the AMP\n * Project.\n *\n * @param {string} signingServiceName\n * @param {string} message\n * @private\n */\nfunction signingServiceError(signingServiceName, message) {\n  dev().error(\n      'AMP-A4A', `Signing service error for ${signingServiceName}: ${message}`);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Because AdSense and DoubleClick are both operated by Google and their A4A\n// implementations share some behavior in common, part of the logic for this\n// implementation is located in the ads/google/a4a directory rather than here.\n// Most other ad networks will want to put their A4A code entirely in the\n// extensions/amp-ad-network-${NETWORK_NAME}-impl directory.\n\nimport {\n  MANUAL_EXPERIMENT_ID,\n  addExperimentIdToElement,\n  extractUrlExperimentId,\n} from '../../../ads/google/a4a/traffic-experiments';\nimport {dev} from '../../../src/log';\nimport {\n  forceExperimentBranch,\n  getExperimentBranch,\n} from '../../../src/experiments';\nimport {\n  isCdnProxy,\n  isGoogleAdsA4AValidEnvironment,\n} from '../../../ads/google/a4a/utils';\nimport {selectAndSetExperiments} from '../../../ads/google/a4a/experiment-utils';\n\n/** @const {string} @visibleForTesting */\nexport const ADSENSE_A4A_EXPERIMENT_NAME = 'expAdsenseA4A';\n\n/** @type {string} */\nconst TAG = 'amp-ad-network-adsense-impl';\n\n/** @const @type {!Object<string,?string>} */\nexport const URL_EXPERIMENT_MAPPING = {\n  '-1': MANUAL_EXPERIMENT_ID,\n  '0': null,\n};\n\n/** @const @type {!Object<string, string>} */\nexport const ADSENSE_EXPERIMENTS = {\n  UNCONDITIONED_CANONICAL_EXP: '21062154',\n  UNCONDITIONED_CANONICAL_CTL: '21062155',\n  CANONICAL_EXP: '21062158',\n  CANONICAL_CTL: '21062159',\n};\n\n/** @const @type {!Object<string, string>} */\nexport const ADSENSE_EXP_NAMES = {\n  UNCONDITIONED_CANONICAL: 'expAdsenseUnconditionedCanonical',\n  CANONICAL: 'expAdsenseCanonical',\n};\n\n/**\n * Attempts to select into Adsense experiments.\n * @param {!Window} win\n * @param {!Element} element\n */\nfunction selectExperiments(win, element) {\n  selectAndSetExperiments(win, element,\n      [ADSENSE_EXPERIMENTS.UNCONDITIONED_CANONICAL_EXP,\n        ADSENSE_EXPERIMENTS.UNCONDITIONED_CANONICAL_CTL],\n      ADSENSE_EXP_NAMES.UNCONDITIONED_CANONICAL,\n      true);\n\n\n  // See if in holdback control/experiment.\n  const urlExperimentId = extractUrlExperimentId(win, element);\n  const experimentId = URL_EXPERIMENT_MAPPING[urlExperimentId || ''];\n  if (experimentId) {\n    addExperimentIdToElement(experimentId, element);\n    forceExperimentBranch(win, ADSENSE_A4A_EXPERIMENT_NAME, experimentId);\n    dev().info(\n        TAG, `url experiment selection ${urlExperimentId}: ${experimentId}.`);\n  }\n\n  // If not in the unconditioned canonical experiment, attempt to\n  // select into the undiluted canonical experiment.\n  const inUnconditionedCanonicalExp = !!getExperimentBranch(\n      win, ADSENSE_EXP_NAMES.UNCONDITIONED_CANONICAL);\n  if (!inUnconditionedCanonicalExp && !isCdnProxy(win)) {\n    selectAndSetExperiments(win, element,\n        [ADSENSE_EXPERIMENTS.CANONICAL_EXP,\n          ADSENSE_EXPERIMENTS.CANONICAL_CTL],\n        ADSENSE_EXP_NAMES.CANONICAL, true);\n  }\n}\n\n/**\n * @param {!Window} win\n * @param {!Element} element\n * @param {boolean} useRemoteHtml\n * @return {boolean}\n */\nexport function adsenseIsA4AEnabled(win, element, useRemoteHtml) {\n  if (useRemoteHtml || !element.getAttribute('data-ad-client')) {\n    return false;\n  }\n  selectExperiments(win, element);\n  return isGoogleAdsA4AValidEnvironment(win) ||\n      getExperimentBranch(\n          win, ADSENSE_EXP_NAMES.UNCONDITIONED_CANONICAL) ==\n      ADSENSE_EXPERIMENTS.UNCONDITIONED_CANONICAL_EXP ||\n      getExperimentBranch(win, ADSENSE_EXP_NAMES.CANONICAL) ==\n      ADSENSE_EXPERIMENTS.CANONICAL_EXP;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Determines which tags desire A4A handling\n * @param {!Window} win\n * @param {!Element} element\n * @param {boolean} useRemoteHtml\n * @return {boolean}\n */\nexport function cloudflareIsA4AEnabled(win, element, useRemoteHtml) {\n  // We assume fast fetch for all content, but this will gracefully degrade,\n  // when non-a4a content is delivered\n  return !useRemoteHtml;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Because AdSense and DoubleClick are both operated by Google and their A4A\n// implementations share some behavior in common, part of the logic for this\n// implementation is located in the ads/google/a4a directory rather than here.\n// Most other ad networks will want to put their A4A code entirely in the\n// extensions/amp-ad-network-${NETWORK_NAME}-impl directory.\n\nimport '../../amp-a4a/0.1/real-time-config-manager';\nimport {\n  AmpA4A,\n  DEFAULT_SAFEFRAME_VERSION,\n  XORIGIN_MODE,\n  assignAdUrlToError,\n} from '../../amp-a4a/0.1/amp-a4a';\nimport {\n  AmpAnalyticsConfigDef,\n  QQID_HEADER,\n  ValidAdContainerTypes,\n  addCsiSignalsToAmpAnalyticsConfig,\n  extractAmpAnalyticsConfig,\n  getCsiAmpAnalyticsConfig,\n  getCsiAmpAnalyticsVariables,\n  getEnclosingContainerTypes,\n  getIdentityToken,\n  googleAdUrl,\n  googleBlockParameters,\n  googlePageParameters,\n  groupAmpAdsByType,\n  isCdnProxy,\n  isReportingEnabled,\n  maybeAppendErrorParameter,\n  truncAndTimeUrl,\n} from '../../../ads/google/a4a/utils';\nimport {CONSENT_POLICY_STATE} from '../../../src/consent-state';\nimport {Deferred} from '../../../src/utils/promise';\nimport {Layout, isLayoutSizeDefined} from '../../../src/layout';\nimport {Navigation} from '../../../src/service/navigation';\nimport {RTC_VENDORS} from '../../amp-a4a/0.1/callout-vendors';\nimport {\n  RefreshManager, // eslint-disable-line no-unused-vars\n  getRefreshManager,\n} from '../../amp-a4a/0.1/refresh-manager';\nimport {SafeframeHostApi} from './safeframe-host';\nimport {Services} from '../../../src/services';\nimport {\n  TFCD,\n  constructSRABlockParameters,\n  serializeTargeting,\n  sraBlockCallbackHandler,\n} from './sra-utils';\nimport {createElementWithAttributes, removeElement} from '../../../src/dom';\nimport {deepMerge, dict} from '../../../src/utils/object';\nimport {dev, user} from '../../../src/log';\nimport {domFingerprintPlain} from '../../../src/utils/dom-fingerprint';\nimport {getMode} from '../../../src/mode';\nimport {getMultiSizeDimensions} from '../../../ads/google/utils';\nimport {getOrCreateAdCid} from '../../../src/ad-cid';\nimport {\n  incrementLoadingAds,\n  is3pThrottled,\n  waitFor3pThrottle,\n} from '../../amp-ad/0.1/concurrent-load';\nimport {insertAnalyticsElement} from '../../../src/extension-analytics';\nimport {isCancellation} from '../../../src/error';\nimport {isExperimentOn} from '../../../src/experiments';\nimport {\n  isInManualExperiment,\n} from '../../../ads/google/a4a/traffic-experiments';\nimport {\n  lineDelimitedStreamer,\n  metaJsonCreativeGrouper,\n} from '../../../ads/google/a4a/line-delimited-response-handler';\nimport {parseQueryString} from '../../../src/url';\nimport {randomlySelectUnsetExperiments} from '../../../src/experiments';\nimport {setStyles} from '../../../src/style';\nimport {stringHash32} from '../../../src/string';\nimport {tryParseJson} from '../../../src/json';\n\n/** @type {string} */\nconst TAG = 'amp-ad-network-doubleclick-impl';\n\n/** @const {string} */\nconst DOUBLECLICK_BASE_URL =\n    'https://securepubads.g.doubleclick.net/gampad/ads';\n\n/** @const {string} */\nconst RTC_SUCCESS = '2';\n\n/** @const {string} */\nconst DOUBLECLICK_SRA_EXP = 'doubleclickSraExp';\n\n/** @const @enum{string} */\nconst DOUBLECLICK_SRA_EXP_BRANCHES = {\n  SRA_CONTROL: '117152666',\n  SRA: '117152667',\n  SRA_NO_RECOVER: '21062235',\n};\n\n/**\n * Map of pageview tokens to the instances they belong to.\n * @private {!Object<string, !AmpAdNetworkDoubleclickImpl>}\n */\nlet tokensToInstances = {};\n\n/** @private {?Promise} */\nlet sraRequests = null;\n\n/** @typedef {{\n      adUrl: !Promise<string>,\n      lineItemId: string,\n      creativeId: string,\n      slotId: string,\n      slotIndex: string,\n    }} */\nlet TroubleshootDataDef;\n\n/** @private {?JsonObject} */\nlet windowLocationQueryParameters;\n\n/**\n * @typedef\n * {({width: number, height: number}|../../../src/layout-rect.LayoutRectDef)}\n */\nlet LayoutRectOrDimsDef;\n\n/** @final */\nexport class AmpAdNetworkDoubleclickImpl extends AmpA4A {\n\n  /**\n   * @param {!Element} element\n   */\n  constructor(element) {\n    super(element);\n\n    /**\n     * Config to generate amp-analytics element for active view reporting.\n     * @type {?JsonObject}\n     * @private\n     */\n    this.ampAnalyticsConfig_ = null;\n\n    /** @private {!../../../src/service/extensions-impl.Extensions} */\n    this.extensions_ = Services.extensionsFor(this.win);\n\n    /** @private {?string} */\n    this.qqid_ = null;\n\n    /** @private {?LayoutRectOrDimsDef} */\n    this.initialSize_ = null;\n\n    /** @type {?string} */\n    this.parameterSize = null;\n\n    /** @private {?{width: number, height: number}} */\n    this.returnedSize_ = null;\n\n    /** @private {?Element} */\n    this.ampAnalyticsElement_ = null;\n\n    /** @type {?Object<string,*>}*/\n    this.jsonTargeting = null;\n\n    /** @type {number} */\n    this.adKey = 0;\n\n    /** @type {!Array<string>} */\n    this.experimentIds = [];\n\n    /** @protected {boolean} */\n    this.useSra = false;\n\n    /** @protected {!Deferred<?../../../src/utils/xhr-utils.FetchResponse>} */\n    this.sraDeferred = new Deferred();\n\n    /** @private {?RefreshManager} */\n    this.refreshManager_ = null;\n\n    /** @private {number} */\n    this.refreshCount_ = 0;\n\n    /** @private {number} */\n    this.ifi_ = 0;\n\n    /** @private {boolean} */\n    this.isFluidRequest_ = false;\n\n    /** @private {?string} */\n    this.fluidImpressionUrl_ = null;\n\n    /** @private {?Promise<!../../../ads/google/a4a/utils.IdentityToken>} */\n    this.identityTokenPromise_ = null;\n\n    /** @type {?../../../ads/google/a4a/utils.IdentityToken} */\n    this.identityToken = null;\n\n    /** @private {!TroubleshootDataDef} */\n    this.troubleshootData_ = /** @type {!TroubleshootDataDef} */ ({});\n\n    /**\n     * @private {?boolean} whether preferential rendered AMP creative, null\n     * indicates no creative render.\n     */\n    this.isAmpCreative_ = null;\n\n    /** @private {boolean} */\n    this.isIdleRender_ = false;\n\n    /** @private {?./safeframe-host.SafeframeHostApi} */\n    this.safeframeApi_ = null;\n\n    /** @type {boolean} whether safeframe forced via tag */\n    this.forceSafeframe = false;\n    if ('forceSafeframe' in this.element.dataset) {\n      if (!/^(1|(true))$/i.test(this.element.dataset['forceSafeframe'])) {\n        user().warn(TAG, 'Ignoring invalid data-force-safeframe attribute: ' +\n            this.element.dataset['forceSafeframe']);\n      } else {\n        this.forceSafeframe = true;\n      }\n    }\n\n    /** @protected {?CONSENT_POLICY_STATE} */\n    this.consentState = null;\n\n    /** @protected {!Deferred<string>} */\n    this.getAdUrlDeferred = new Deferred();\n  }\n\n  /**\n   * @return {number|boolean} render on idle configuration with false\n   *    indicating disabled.\n   * @private\n   */\n  getIdleRenderEnabled_() {\n    if (this.isIdleRender_) {\n      return this.isIdleRender_;\n    }\n    // Disable if publisher has indicated a non-default loading strategy.\n    if (this.element.getAttribute('data-loading-strategy')) {\n      return false;\n    }\n    const expVal = this.postAdResponseExperimentFeatures['render-idle-vp'];\n    const vpRange = parseInt(expVal, 10);\n    if (expVal && isNaN(vpRange)) {\n      // holdback branch sends non-numeric value.\n      return false;\n    }\n    return vpRange || 12;\n  }\n\n  /** @override */\n  idleRenderOutsideViewport() {\n    const vpRange = this.getIdleRenderEnabled_();\n    if (vpRange === false) {\n      return vpRange;\n    }\n    this.isIdleRender_ = true;\n    // NOTE(keithwrightbos): handle race condition where previous\n    // idleRenderOutsideViewport marked slot as idle render despite never\n    // being schedule due to being beyond viewport max offset.  If slot\n    // comes within standard outside viewport range, then ensure throttling\n    // will not be applied.\n    this.getResource().whenWithinViewport(this.renderOutsideViewport()).then(\n        () => this.isIdleRender_ = false);\n    return vpRange;\n  }\n\n  /** @override */\n  isLayoutSupported(layout) {\n    this.isFluidRequest_ = layout == Layout.FLUID;\n    return this.isFluidRequest_ || isLayoutSizeDefined(layout);\n  }\n\n  /** @override */\n  isValidElement() {\n    return this.isAmpAdElement();\n  }\n\n  /**\n   * Executes page level experiment diversion and pushes any experiment IDs\n   * onto this.experimentIds.\n   * @visibleForTesting\n   */\n  setPageLevelExperiments() {\n    if (!isCdnProxy(this.win) && !isExperimentOn(\n        this.win, 'expDfpInvOrigDeprecated')) {\n      this.experimentIds.push('21060933');\n    }\n    const experimentInfoMap =\n    /** @type {!Object<string,\n        !../../../src/experiments.ExperimentInfo>} */ ({\n        // Only select into SRA experiments if SRA not already explicitly\n        // enabled and refresh is not being used by any slot.\n        [DOUBLECLICK_SRA_EXP]: {\n          isTrafficEligible: () => !this.win.document./*OK*/querySelector(\n              'meta[name=amp-ad-enable-refresh], ' +\n              'amp-ad[type=doubleclick][data-enable-refresh], ' +\n              'meta[name=amp-ad-doubleclick-sra]'),\n          branches: Object.keys(DOUBLECLICK_SRA_EXP_BRANCHES).map(\n              key => DOUBLECLICK_SRA_EXP_BRANCHES[key]),\n        },\n      });\n    const setExps = this.randomlySelectUnsetExperiments_(experimentInfoMap);\n    Object.keys(setExps).forEach(expName =>\n      setExps[expName] && this.experimentIds.push(setExps[expName]));\n  }\n\n  /**\n   * For easier unit testing.\n   * @param {!Object<string, !../../../src/experiments.ExperimentInfo>} experimentInfoMap\n   * @return {!Object<string, string>}\n   */\n  randomlySelectUnsetExperiments_(experimentInfoMap) {\n    return randomlySelectUnsetExperiments(this.win, experimentInfoMap);\n  }\n\n  /** @private */\n  maybeDeprecationWarn_() {\n    const warnDeprecation = feature => user().warn(\n        TAG, `${feature} is no longer supported for DoubleClick.` +\n          'Please refer to ' +\n          'https://github.com/ampproject/amphtml/issues/11834 ' +\n          'for more information');\n    const usdrd = 'useSameDomainRenderingUntilDeprecated';\n    const hasUSDRD = usdrd in this.element.dataset ||\n          (tryParseJson(this.element.getAttribute('json')) || {})[usdrd];\n    if (hasUSDRD) {\n      warnDeprecation(usdrd);\n    }\n    const useRemoteHtml =\n      !!this.win.document.querySelector('meta[name=amp-3p-iframe-src]');\n    if (useRemoteHtml) {\n      warnDeprecation('remote.html');\n    }\n  }\n\n  /** @override */\n  buildCallback() {\n    super.buildCallback();\n    this.maybeDeprecationWarn_();\n    this.setPageLevelExperiments();\n    this.useSra = (getMode().localDev && /(\\?|&)force_sra=true(&|$)/.test(\n        this.win.location.search)) ||\n        !!this.win.document.querySelector(\n            'meta[name=amp-ad-doubleclick-sra]') ||\n        !!this.experimentIds.filter(exp =>\n          exp == DOUBLECLICK_SRA_EXP_BRANCHES.SRA ||\n          exp == DOUBLECLICK_SRA_EXP_BRANCHES.SRA_NO_RECOVER).length;\n    this.identityTokenPromise_ = Services.viewerForDoc(this.getAmpDoc())\n        .whenFirstVisible()\n        .then(() => getIdentityToken(this.win, this.getAmpDoc()));\n    this.troubleshootData_.slotId = this.element.getAttribute('data-slot');\n    this.troubleshootData_.slotIndex =\n        this.element.getAttribute('data-amp-slot-index');\n  }\n\n  /** @override */\n  shouldPreferentialRenderWithoutCrypto() {\n    dev().assert(!isCdnProxy(this.win));\n    return true;\n  }\n\n  /**\n   * @param {?CONSENT_POLICY_STATE} consentState\n   * @param {!Array<!AmpAdNetworkDoubleclickImpl>=} instances\n   * @return {!Object<string,string|boolean|number>}\n   * @visibleForTesting\n   */\n  getPageParameters(consentState, instances) {\n    instances = instances || [this];\n    return {\n      'npa': consentState == CONSENT_POLICY_STATE.INSUFFICIENT ||\n          consentState == CONSENT_POLICY_STATE.UNKNOWN ? 1 : null,\n      'gdfp_req': '1',\n      'sfv': DEFAULT_SAFEFRAME_VERSION,\n      'u_sd': this.win.devicePixelRatio,\n      'gct': this.getLocationQueryParameterValue('google_preview') || null,\n      'psts': getPageviewStateTokensForAdRequest(instances),\n    };\n  }\n\n  /**\n   * Constructs block-level url parameters with side effect of setting\n   * size_, jsonTargeting, and adKey_ fields.\n   * @return {!Object<string,string|boolean|number>}\n   */\n  getBlockParameters_() {\n    dev().assert(this.initialSize_);\n    dev().assert(this.jsonTargeting);\n    const tfcd = this.jsonTargeting && this.jsonTargeting[TFCD];\n    this.win['ampAdGoogleIfiCounter'] = this.win['ampAdGoogleIfiCounter'] || 1;\n    this.ifi_ = (this.isRefreshing && this.ifi_) ||\n        this.win['ampAdGoogleIfiCounter']++;\n    const pageLayoutBox = this.isSinglePageStoryAd ?\n      this.element.getPageLayoutBox() : null;\n    return Object.assign({\n      'iu': this.element.getAttribute('data-slot'),\n      'co': this.jsonTargeting &&\n          this.jsonTargeting['cookieOptOut'] ? '1' : null,\n      'adk': this.adKey,\n      'sz': this.isSinglePageStoryAd ? '1x1' : this.parameterSize,\n      'output': 'html',\n      'impl': 'ifr',\n      'tfcd': tfcd == undefined ? null : tfcd,\n      'adtest': isInManualExperiment(this.element) ? 'on' : null,\n      'ifi': this.ifi_,\n      'rc': this.refreshCount_ || null,\n      'frc': Number(this.fromResumeCallback) || null,\n      'fluid': this.isFluidRequest_ ? 'height' : null,\n      'fsf': this.forceSafeframe ? '1' : null,\n      'scp': serializeTargeting(\n          (this.jsonTargeting && this.jsonTargeting['targeting']) || null,\n          (this.jsonTargeting &&\n            this.jsonTargeting['categoryExclusions']) || null),\n      'spsa': this.isSinglePageStoryAd ?\n        `${pageLayoutBox.width}x${pageLayoutBox.height}` : null,\n    }, googleBlockParameters(this));\n  }\n\n  /**\n   * Populate's block-level state for ad URL construction.\n   * @param {?CONSENT_POLICY_STATE} consentState\n   * @visibleForTesting\n   */\n  populateAdUrlState(consentState) {\n    this.consentState = consentState;\n    // Allow for pub to override height/width via override attribute.\n    const width = Number(this.element.getAttribute('data-override-width')) ||\n      Number(this.element.getAttribute('width'));\n    const height = Number(this.element.getAttribute('data-override-height')) ||\n      Number(this.element.getAttribute('height'));\n    this.initialSize_ = this.isFluidRequest_ ? {width: 0, height: 0} :\n      (width && height ?\n        // width/height could be 'auto' in which case we fallback to measured.\n        {width, height} : this.getIntersectionElementLayoutBox());\n    this.jsonTargeting =\n      tryParseJson(this.element.getAttribute('json')) || {};\n    this.adKey = this.generateAdKey_(\n        `${this.initialSize_.width}x${this.initialSize_.height}`);\n    this.parameterSize = this.isFluidRequest_ ?\n      '320x50' : `${this.initialSize_.width}x${this.initialSize_.height}`;\n    const multiSizeDataStr = this.element.getAttribute('data-multi-size');\n    if (multiSizeDataStr) {\n      if (this.element.getAttribute('layout') == 'responsive') {\n        // TODO(levitzky) Define the behavior and remove this warning.\n        user().warn(TAG, 'Behavior of multi-size and responsive layout is ' +\n            'currently not well defined. Forcefully overriding layout to ' +\n            '`fixed`.');\n        this.element.setAttribute('layout', 'fixed');\n      }\n      const multiSizeValidation = this.element\n          .getAttribute('data-multi-size-validation') || 'true';\n      // The following call will check all specified multi-size dimensions,\n      // verify that they meet all requirements, and then return all the valid\n      // dimensions in an array.\n      const dimensions = getMultiSizeDimensions(\n          multiSizeDataStr,\n          this.initialSize_.width,\n          this.initialSize_.height,\n          multiSizeValidation == 'true',\n          this.isFluidRequest_);\n      if (dimensions.length) {\n        this.parameterSize += '|' + dimensions\n            .map(dimension => dimension.join('x'))\n            .join('|');\n      }\n    }\n  }\n\n  /** @override */\n  getConsentPolicy() {\n    // Ensure that build is not blocked by need for consent (delay will occur\n    // prior to RTC & ad URL construction).\n    return null;\n  }\n\n  /** @override */\n  getAdUrl(consentState, opt_rtcResponsesPromise) {\n    if (consentState == CONSENT_POLICY_STATE.UNKNOWN &&\n        this.element.getAttribute('data-npa-on-unknown-consent') != 'true') {\n      user().info(TAG, 'Ad request suppressed due to unknown consent');\n      this.getAdUrlDeferred.resolve('');\n      return Promise.resolve('');\n    }\n    if (this.iframe && !this.isRefreshing) {\n      dev().warn(TAG, `Frame already exists, sra: ${this.useSra}`);\n      this.getAdUrlDeferred.resolve('');\n      return Promise.resolve('');\n    }\n    opt_rtcResponsesPromise = opt_rtcResponsesPromise || Promise.resolve();\n    // TODO(keithwrightbos): SRA blocks currently unnecessarily generate full\n    // ad url.  This could be optimized however non-SRA ad url is required to\n    // fallback to non-SRA if single block.\n    this.populateAdUrlState(consentState);\n    // TODO: Check for required and allowed parameters. Probably use\n    // validateData, from 3p/3p/js, after noving it someplace common.\n    const startTime = Date.now();\n    const identityPromise = Services.timerFor(this.win)\n        .timeoutPromise(1000, this.identityTokenPromise_)\n        .catch(() => {\n          // On error/timeout, proceed.\n          return /**@type {!../../../ads/google/a4a/utils.IdentityToken}*/({});\n        });\n    const checkStillCurrent = this.verifyStillCurrent();\n    Promise.all([opt_rtcResponsesPromise, identityPromise])\n        .then(results => {\n          checkStillCurrent();\n          const rtcParams = this.mergeRtcResponses_(results[0]);\n          this.identityToken = results[1];\n          googleAdUrl(\n              this, DOUBLECLICK_BASE_URL, startTime, Object.assign(\n                  this.getBlockParameters_(), this.buildIdentityParams(),\n                  this.getPageParameters(consentState), rtcParams),\n              this.experimentIds)\n              .then(adUrl => this.getAdUrlDeferred.resolve(adUrl));\n        });\n    this.troubleshootData_.adUrl = this.getAdUrlDeferred.promise;\n    return this.getAdUrlDeferred.promise;\n  }\n\n  /**\n   * Converts identity token response to ad request parameters.\n   * @return {!Object<string,string>}\n   */\n  buildIdentityParams() {\n    return this.identityToken ? {\n      adsid: this.identityToken.token || null,\n      jar: this.identityToken.jar || null,\n      pucrd: this.identityToken.pucrd || null,\n    } : {};\n  }\n\n  /**\n   * Merges all of the rtcResponses into the JSON targeting and\n   * category exclusions.\n   * @param {?Array<!rtcResponseDef>} rtcResponseArray\n   * @private\n   */\n  mergeRtcResponses_(rtcResponseArray) {\n    if (!rtcResponseArray) {\n      return null;\n    }\n    const artc = [];\n    const ati = [];\n    const ard = [];\n    let exclusions;\n    rtcResponseArray.forEach(rtcResponse => {\n      if (!rtcResponse) {\n        return;\n      }\n      artc.push(rtcResponse.rtcTime);\n      ati.push(rtcResponse.error || RTC_SUCCESS);\n      ard.push(rtcResponse.callout);\n      if (rtcResponse.response) {\n        if (rtcResponse.response['targeting']) {\n          const rewrittenResponse = this.rewriteRtcKeys_(\n              rtcResponse.response['targeting'],\n              rtcResponse.callout);\n          this.jsonTargeting['targeting'] =\n              !!this.jsonTargeting['targeting'] ?\n                deepMerge(this.jsonTargeting['targeting'],\n                    rewrittenResponse) :\n                rewrittenResponse;\n        }\n        if (rtcResponse.response['categoryExclusions']) {\n          if (!exclusions) {\n            exclusions = {};\n            if (this.jsonTargeting['categoryExclusions']) {\n              this.jsonTargeting['categoryExclusions'].forEach(exclusion => {\n                exclusions[exclusion] = true;\n              });\n            }\n          }\n          rtcResponse.response['categoryExclusions'].forEach(exclusion => {\n            exclusions[exclusion] = true;\n          });\n        }\n      }\n    });\n    if (exclusions) {\n      this.jsonTargeting['categoryExclusions'] = Object.keys(exclusions);\n    }\n    return {'artc': artc.join() || null, 'ati': ati.join(), 'ard': ard.join()};\n  }\n\n  /** @override */\n  getCustomRealTimeConfigMacros_() {\n    /**\n     * This whitelist allow attributes on the amp-ad element to be used as\n     * macros for constructing the RTC URL. Add attributes here, in lowercase,\n     * to make them available.\n     */\n    const whitelist = {\n      'height': true,\n      'width': true,\n      'data-slot': true,\n      'data-multi-size': true,\n      'data-multi-size-validation': true,\n      'data-override-width': true,\n      'data-override-height': true,\n    };\n    return {\n      PAGEVIEWID: () => Services.documentInfoForDoc(this.element).pageViewId,\n      HREF: () => this.win.location.href,\n      REFERRER: opt_timeout => this.getReferrer_(opt_timeout),\n      TGT: () =>\n        JSON.stringify(\n            (tryParseJson(\n                this.element.getAttribute('json')) || {})['targeting']),\n      ADCID: opt_timeout => getOrCreateAdCid(\n          this.getAmpDoc(), 'AMP_ECID_GOOGLE', '_ga',\n          parseInt(opt_timeout, 10)),\n      ATTR: name => {\n        if (!whitelist[name.toLowerCase()]) {\n          dev().warn('TAG', `Invalid attribute ${name}`);\n        } else {\n          return this.element.getAttribute(name);\n        }\n      },\n      CANONICAL_URL: () =>\n        Services.documentInfoForDoc(this.element).canonicalUrl,\n    };\n  }\n\n  /**\n   * Returns the referrer or undefined if the referrer is not resolved\n   * before the given timeout\n   * @param {number=} opt_timeout\n   * @return {!(Promise<string>|Promise<undefined>)} A promise with a referrer or undefined\n   * if timed out\n   * @private\n   */\n  getReferrer_(opt_timeout) {\n    const timeoutInt = parseInt(opt_timeout, 10);\n    const referrerPromise = Services.viewerForDoc(this.getAmpDoc())\n        .getReferrerUrl();\n    if (isNaN(timeoutInt) || timeoutInt < 0) {\n      return referrerPromise;\n    }\n    return Services.timerFor(this.win)\n        .timeoutPromise(timeoutInt, referrerPromise)\n        .catch(() => undefined);\n  }\n\n  /**\n   * Appends the callout value to the keys of response to prevent a collision\n   * case caused by multiple vendors returning the same keys.\n   * @param {!Object<string, string>} response\n   * @param {string} callout\n   * @return {!Object<string, string>}\n   * @private\n   */\n  rewriteRtcKeys_(response, callout) {\n    // Only perform this substitution for vendor-defined URLs.\n    if (!RTC_VENDORS[callout] || RTC_VENDORS[callout].disableKeyAppend) {\n      return response;\n    }\n    const newResponse = {};\n    Object.keys(response).forEach(key => {\n      newResponse[`${key}_${callout}`] = response[key];\n    });\n    return newResponse;\n  }\n\n  /** @override */\n  onNetworkFailure(error, adUrl) {\n    dev().info(TAG, 'network error, attempt adding of error parameter', error);\n    return {adUrl: maybeAppendErrorParameter(adUrl, 'n')};\n  }\n\n  /** @override */\n  extractSize(responseHeaders) {\n    this.ampAnalyticsConfig_ = extractAmpAnalyticsConfig(this, responseHeaders);\n    this.qqid_ = responseHeaders.get(QQID_HEADER);\n    this.troubleshootData_.creativeId =\n        responseHeaders.get('google-creative-id');\n    this.troubleshootData_.lineItemId =\n        responseHeaders.get('google-lineitem-id');\n    if (this.ampAnalyticsConfig_) {\n      // Load amp-analytics extensions\n      this.extensions_./*OK*/installExtensionForDoc(\n          this.getAmpDoc(), 'amp-analytics');\n    }\n    // If the server returned a size, use that, otherwise use the size that we\n    // sent in the ad request.\n    let size = super.extractSize(responseHeaders);\n    if (size) {\n      this.returnedSize_ = size;\n      this.handleResize_(size.width, size.height);\n    } else {\n      size = this.getSlotSize();\n    }\n    // If this is a multi-size creative, fire delayed impression now. If it's\n    // fluid, wait until after resize happens.\n    if (this.isFluidRequest_ && !this.returnedSize_) {\n      this.fluidImpressionUrl_ = responseHeaders.get('X-AmpImps');\n    }\n\n    // If the response included a pageview state token, check for an existing\n    // token and remove it. Then save the new one to the module level object.\n    if (responseHeaders.get('amp-ff-pageview-tokens')) {\n      this.removePageviewStateToken();\n      this.setPageviewStateToken(\n          responseHeaders.get('amp-ff-pageview-tokens'));\n    }\n\n    return size;\n  }\n\n  /**\n   * Returns the width and height of the slot as defined by the width and height\n   * attributes, or the dimensions as computed by\n   * getIntersectionElementLayoutBox.\n   * @return {{width: number, height: number}|../../../src/layout-rect.LayoutRectDef}\n   */\n  getSlotSize() {\n    const width = Number(this.element.getAttribute('width'));\n    const height = Number(this.element.getAttribute('height'));\n    return width && height\n      ? {width, height}\n      // width/height could be 'auto' in which case we fallback to measured.\n      : this.getIntersectionElementLayoutBox();\n  }\n\n  /** @override */\n  tearDownSlot() {\n    super.tearDownSlot();\n    this.element.setAttribute('data-amp-slot-index',\n        this.win.ampAdSlotIdCounter++);\n    if (this.ampAnalyticsElement_) {\n      removeElement(this.ampAnalyticsElement_);\n      this.ampAnalyticsElement_ = null;\n    }\n    this.ampAnalyticsConfig_ = null;\n    this.jsonTargeting = null;\n    this.isAmpCreative_ = null;\n    this.isIdleRender_ = false;\n    this.parameterSize = null;\n    this.returnedSize_ = null;\n    // Reset SRA requests to allow for resumeCallback to re-fetch\n    // ad requests.  Assumes that unlayoutCallback will be called for all slots\n    // in rapid succession (meaning onLayoutMeasure initiated promise chain\n    // will not be started until resumeCallback).\n    sraRequests = null;\n    this.sraDeferred = null;\n    this.qqid_ = null;\n    this.consentState = null;\n    this.getAdUrlDeferred = new Deferred();\n    this.removePageviewStateToken();\n  }\n\n  /** @override */\n  renderNonAmpCreative() {\n    // If render idle with throttling, impose one second render delay for\n    // non-AMP creatives.  This is not done in the scheduler to ensure as many\n    // slots as possible are marked for layout given scheduler imposes 5 seconds\n    // past previous execution.\n    if (this.postAdResponseExperimentFeatures['render-idle-throttle'] &&\n          this.isIdleRender_) {\n      if (is3pThrottled(this.win)) {\n        return waitFor3pThrottle().then(() => super.renderNonAmpCreative());\n      } else {\n        incrementLoadingAds(this.win);\n        return super.renderNonAmpCreative(true);\n      }\n    }\n    return super.renderNonAmpCreative();\n  }\n\n  /** @override  */\n  unlayoutCallback() {\n    if (this.refreshManager_) {\n      this.refreshManager_.unobserve();\n    }\n    if (!this.useSra && this.isAmpCreative_) {\n      // Allow non-AMP creatives to remain unless SRA.\n      return false;\n    }\n    this.destroySafeFrameApi_();\n    return super.unlayoutCallback();\n  }\n\n  /** @visibleForTesting */\n  cleanupAfterTest() {\n    this.destroySafeFrameApi_();\n  }\n\n  /** @private */\n  destroySafeFrameApi_() {\n    if (!this.safeframeApi_) {\n      return;\n    }\n    this.safeframeApi_.destroy();\n    this.safeframeApi_ = null;\n  }\n\n  /** @override */\n  refresh(refreshEndCallback) {\n    this.refreshCount_++;\n    return super.refresh(refreshEndCallback);\n  }\n\n  /** @override */\n  onCreativeRender(creativeMetaData) {\n    super.onCreativeRender(creativeMetaData);\n    this.isAmpCreative_ = !!creativeMetaData;\n    if (creativeMetaData &&\n        !creativeMetaData.customElementExtensions.includes('amp-ad-exit')) {\n      // Capture phase click handlers on the ad if amp-ad-exit not present\n      // (assume it will handle capture).\n      dev().assert(this.iframe);\n      Navigation.installAnchorClickInterceptor(\n          this.getAmpDoc(), this.iframe.contentWindow);\n    }\n    if (this.ampAnalyticsConfig_) {\n      dev().assert(!this.ampAnalyticsElement_);\n      if (isReportingEnabled(this)) {\n        addCsiSignalsToAmpAnalyticsConfig(\n            this.win,\n            this.element,\n            this.ampAnalyticsConfig_,\n            this.qqid_,\n            !!creativeMetaData);\n      }\n      this.ampAnalyticsElement_ = insertAnalyticsElement(\n          this.element, this.ampAnalyticsConfig_, /*loadAnalytics*/ true,\n          !!this.postAdResponseExperimentFeatures['avr_disable_immediate']);\n    }\n    if (this.isRefreshing) {\n      dev().assert(this.refreshManager_);\n      this.refreshManager_.initiateRefreshCycle();\n      this.isRefreshing = false;\n      this.isRelayoutNeededFlag = false;\n    }\n\n    // Force size of frame to match creative or, if creative size is unknown,\n    // the slot. This ensures that the creative is centered in the former case,\n    // and not truncated in the latter.\n    const size = this.returnedSize_ || this.getSlotSize();\n    const isMultiSizeFluid = this.isFluidRequest_ && this.returnedSize_ &&\n        // TODO(@glevitzky, 11583) Remove this clause once we stop sending back\n        // the size header for fluid ads. Fluid size headers always come back as\n        // 0x0.\n        !(size.width == 0 && size.height == 0);\n    setStyles(dev().assertElement(this.iframe), {\n      width: `${size.width}px`,\n      height: `${size.height}px`,\n      position: isMultiSizeFluid ? 'relative' : null,\n    });\n    if (isMultiSizeFluid) {\n      // This is a fluid + multi-size request, where the returned creative is\n      // multi-size. The slot needs to not be styled with width: 100%, or the\n      // creative will be centered instead of left-aligned.\n      this.element.removeAttribute('height');\n      setStyles(this.element, {width: `${size.width}px`});\n    }\n\n    this.refreshManager_ = this.refreshManager_ ||\n        getRefreshManager(this, () => {\n          if (this.useSra) {\n            user().warn(TAG, 'Refresh not compatible with SRA.');\n            return false;\n          }\n          if (getEnclosingContainerTypes(this.element).filter(container =>\n            container != ValidAdContainerTypes['AMP-CAROUSEL'] &&\n                container != ValidAdContainerTypes['AMP-STICKY-AD']).length) {\n            user().warn(TAG,\n                'Refresh not compatible with ad-containers, except for ' +\n                'AMP-CAROUSEL and AMP-STICKY-AD');\n            return false;\n          }\n          return true;\n        });\n\n    this.postTroubleshootMessage();\n  }\n\n  /**\n   * @param {string} size\n   * @return {string} The ad unit hash key string.\n   * @private\n   */\n  generateAdKey_(size) {\n    const {element} = this;\n    const domFingerprint = domFingerprintPlain(element);\n    const slot = element.getAttribute('data-slot') || '';\n    const multiSize = element.getAttribute('data-multi-size') || '';\n    const string = `${slot}:${size}:${multiSize}:${domFingerprint}`;\n    return stringHash32(string);\n  }\n\n  /**\n   * Attempts to resize the ad, if the returned size is smaller than the primary\n   * dimensions.\n   * @param {number} width\n   * @param {number} height\n   * @private\n   */\n  handleResize_(width, height) {\n    const pWidth = this.element.getAttribute('width');\n    const pHeight = this.element.getAttribute('height');\n    // We want to resize only if neither returned dimension is larger than its\n    // primary counterpart, and if at least one of the returned dimensions\n    // differ from its primary counterpart.\n    if ((this.isFluidRequest_ && width && height) ||\n        ((width != pWidth || height != pHeight) &&\n         (width <= pWidth && height <= pHeight))) {\n      this.attemptChangeSize(height, width).catch(() => {});\n    }\n  }\n\n  /** @override */\n  sendXhrRequest(adUrl) {\n    if (!this.useSra) {\n      return super.sendXhrRequest(adUrl);\n    }\n    this.sraDeferred = new Deferred();\n    const checkStillCurrent = this.verifyStillCurrent();\n    // InitiateSraRequests resolves when all blocks have had their SRA\n    // responses returned such that sraDeferred being non-null indicates this\n    // element was somehow not included so report.\n    this.initiateSraRequests().then(() => {\n      checkStillCurrent();\n      if (!this.sraDeferred) {\n        dev().warn(TAG, `SRA failed to include element ${this.ifi_}`);\n        if (isExperimentOn(this.win, 'doubleclickSraReportExcludedBlock')) {\n          this.getAmpDoc().getBody().appendChild(createElementWithAttributes(\n              this.win.document, 'amp-pixel', dict({'src':\n              'https://pagead2.googlesyndication.com/pagead/gen_204?' +\n                  `id=${encodeURIComponent('a4a::sra')}&ifi=${this.ifi_}`})));\n        }\n      }\n    });\n    // Wait for SRA request which will call response promise when this block's\n    // response has been returned. Null response indicates single slot should\n    // execute using non-SRA method.\n    return this.sraDeferred.promise.then(response => {\n      checkStillCurrent();\n      this.sraDeferred = null;\n      return response || super.sendXhrRequest(adUrl);\n    });\n  }\n\n  /**\n   * @param {string} impressions\n   * @param {boolean=} scrubReferer\n   * @visibleForTesting\n   */\n  fireDelayedImpressions(impressions, scrubReferer) {\n    if (!impressions) {\n      return;\n    }\n    impressions.split(',').forEach(url => {\n      try {\n        if (!Services.urlForDoc(this.getAmpDoc()).isSecure(url)) {\n          dev().warn(TAG, `insecure impression url: ${url}`);\n          return;\n        }\n        // Create amp-pixel and append to document to send impression.\n        this.win.document.body.appendChild(\n            createElementWithAttributes(\n                this.win.document,\n                'amp-pixel',\n                dict({\n                  'src': url,\n                  'referrerpolicy': scrubReferer ? 'no-referrer' : '',\n                })));\n      } catch (unusedError) {}\n    });\n  }\n\n  /**\n   * Groups slots by type and networkId from data-slot parameter.  Exposed for\n   * ease of testing.\n   * @return {!Promise<!Object<string,!Array<!Promise<!../../../src/base-element.BaseElement>>>>}\n   * @visibleForTesting\n   */\n  groupSlotsForSra() {\n    return groupAmpAdsByType(\n        this.win, this.element.getAttribute('type'), getNetworkId);\n  }\n\n  /**\n   * Executes SRA request via the following steps:\n   * - create only one executor per page\n   * - get all doubleclick amp-ad instances on the page\n   * - group by networkID allowing for separate SRA requests\n   * - for each grouping, construct SRA request\n   * - handle chunks for streaming response for each block\n   * @return {!Promise}\n   * @visibleForTesting\n   */\n  initiateSraRequests() {\n    // Use cancellation of the first slot's promiseId as indication of\n    // unlayoutCallback execution.  Assume that if called for one slot, it will\n    // be called for all and we should cancel SRA execution.\n    const checkStillCurrent = this.verifyStillCurrent();\n    const noFallbackExp = this.experimentIds.includes(\n        DOUBLECLICK_SRA_EXP_BRANCHES.SRA_NO_RECOVER);\n    sraRequests = sraRequests || this.groupSlotsForSra()\n        .then(groupIdToBlocksAry => {\n          checkStillCurrent();\n          const sraRequestPromises = [];\n          Object.keys(groupIdToBlocksAry).forEach(networkId => {\n            const blocks = dev().assert(groupIdToBlocksAry[networkId]);\n            // TODO: filter blocks with SRA disabled?\n            sraRequestPromises.push(Promise.all(blocks).then(instances => {\n              dev().assert(instances.length);\n              checkStillCurrent();\n              // Exclude any instances that do not have an adPromise_ as this\n              // indicates they were invalid.\n              const typeInstances =\n              /** @type {!Array<!AmpAdNetworkDoubleclickImpl>}*/(instances)\n                    .filter(instance => {\n                      const isValid = instance.hasAdPromise();\n                      if (!isValid) {\n                        dev().info(TAG,\n                            'Ignoring instance without ad promise as ' +\n                            'likely invalid',\n                            instance.element);\n                      }\n                      return isValid;\n                    });\n              if (!typeInstances.length) {\n              // Only contained invalid elements.\n                return;\n              }\n              // If not within no recovery SRA experiment, determine if more\n              // than one block for this element, if not do not set sra request\n              // promise which results in sending as non-SRA request (benefit\n              // is it allows direct cache method).\n              if (!noFallbackExp && typeInstances.length == 1) {\n                dev().info(TAG, `single block in network ${networkId}`);\n                typeInstances[0].sraDeferred.resolve(null);\n                return;\n              }\n              let sraUrl;\n              // Construct and send SRA request.\n              // Chunk handler called with metadata and creative for each slot\n              // in order of URLs given which is then passed to resolver used\n              // for sendXhrRequest.\n              const sraRequestAdUrlResolvers =\n              typeInstances.map(instance => instance.sraDeferred.resolve);\n              const slotCallback = metaJsonCreativeGrouper(\n                  (creative, headersObj, done) => {\n                    checkStillCurrent();\n                    sraBlockCallbackHandler(creative, headersObj, done,\n                        sraRequestAdUrlResolvers, sraUrl);\n                  });\n              // TODO(keithwrightbos) - how do we handle per slot 204 response?\n              return constructSRARequest_(this, typeInstances)\n                  .then(sraUrlIn => {\n                    checkStillCurrent();\n                    sraUrl = sraUrlIn;\n                    return Services.xhrFor(this.win).fetch(sraUrl, {\n                      mode: 'cors',\n                      method: 'GET',\n                      credentials: 'include',\n                    });\n                  })\n                  .then(response => {\n                    checkStillCurrent();\n                    lineDelimitedStreamer(this.win, response, slotCallback);\n                    return Promise.all(typeInstances.map(\n                        instance => instance.sraDeferred.promise));\n                  })\n                  .catch(error => {\n                    if (isCancellation(error)) {\n                      // Cancellation should be propagated to slot promises\n                      // causing their adPromise chains within A4A to handle\n                      // appropriately.\n                      typeInstances.forEach(instance => instance.sraDeferred &&\n                        instance.sraDeferred.reject(error));\n                    } else if (noFallbackExp ||\n                      !!this.win.document.querySelector(\n                          'meta[name=amp-ad-doubleclick-sra]')) {\n                      // If publisher has explicitly enabled SRA mode (not\n                      // experiment), then assume error is network failure,\n                      // collapse slot, reset url to empty string to ensure\n                      // no fallback to frame GET (given expectation of SRA\n                      // consistency), and propagate error to A4A ad promise\n                      // chain.\n                      assignAdUrlToError(/** @type {!Error} */(error), sraUrl);\n                      this.warnOnError('SRA request failure', error);\n                      // Publisher explicitly wants SRA so do not attempt to\n                      // recover as SRA guarantees cannot be enforced.\n                      typeInstances.forEach(instance => {\n                        // Reset ad url to ensure layoutCallback does not\n                        // fallback to frame get which would lose SRA\n                        // guarantees.\n                        instance.resetAdUrl();\n                        instance.attemptCollapse();\n                        instance.sraDeferred.reject(error);\n                      });\n                    } else {\n                      // Opportunistic SRA used so fallback to individual\n                      // XHR requests.\n                      typeInstances.forEach(instance =>\n                        instance.sraDeferred.resolve(null));\n                    }\n                  });\n            }));\n          });\n          return Promise.all(sraRequestPromises);\n        });\n    return sraRequests;\n  }\n\n  /**\n   * @param {string} message\n   * @param {*} error\n   * @visibleForTesting\n   */\n  warnOnError(message, error) {\n    dev().warn(TAG, message, error);\n  }\n\n  /** @override */\n  getPreconnectUrls() {\n    return ['https://securepubads.g.doubleclick.net/'];\n  }\n\n  /** @override */\n  getNonAmpCreativeRenderingMethod(headerValue) {\n    return this.forceSafeframe || this.isFluidRequest_\n      ? XORIGIN_MODE.SAFEFRAME\n      : super.getNonAmpCreativeRenderingMethod(headerValue);\n  }\n\n  /**\n   * Note that location is parsed once on first access and cached.\n   * @param {string} parameterName\n   * @return {string|undefined} parameter value from window.location.search\n   * @visibleForTesting\n   */\n  getLocationQueryParameterValue(parameterName) {\n    windowLocationQueryParameters = windowLocationQueryParameters ||\n        parseQueryString((this.win.location && this.win.location.search) || '');\n    return windowLocationQueryParameters[parameterName];\n  }\n\n  /** @override */\n  getAdditionalContextMetadata(isSafeFrame = false) {\n    if (!this.isFluidRequest_ && !isSafeFrame) {\n      return;\n    }\n    const creativeSize = this.getCreativeSize();\n    dev().assert(creativeSize, 'this.getCreativeSize returned null');\n    this.safeframeApi_ = this.safeframeApi_ ||\n        new SafeframeHostApi(\n            this, this.isFluidRequest_,\n            /** @type {{height, width}} */(creativeSize),\n            this.fluidImpressionUrl_);\n\n    return this.safeframeApi_.getSafeframeNameAttr();\n  }\n\n  /**\n   * Emits a postMessage containing information about this slot to the DFP\n   * Troubleshoot UI. A promise is returned if a message is posted, otherwise\n   * null is returned. The promise is returned only for test convenience.\n   *\n   * @return {?Promise}\n   * @visibleForTesting\n   */\n  postTroubleshootMessage() {\n    if (!this.win.opener || !/[?|&]dfpdeb/.test(this.win.location.search)) {\n      return null;\n    }\n    dev().assert(this.troubleshootData_.adUrl, 'ad URL does not exist yet');\n    return this.troubleshootData_.adUrl.then(adUrl => {\n      const slotId = this.troubleshootData_.slotId + '_' +\n          this.troubleshootData_.slotIndex;\n      const payload = dict({\n        'gutData': JSON.stringify(dict({\n          'events': [{\n            'timestamp': Date.now(),\n            'slotid': slotId,\n            'messageId': 4,\n          }],\n          'slots': [{\n            'contentUrl': adUrl || '',\n            'id': slotId,\n            'leafAdUnitName': this.troubleshootData_.slotId,\n            'domId': slotId,\n            'lineItemId': this.troubleshootData_.lineItemId,\n            'creativeId': this.troubleshootData_.creativeId,\n          }],\n        })),\n        'userAgent': navigator.userAgent,\n        'referrer': this.win.location.href,\n        'messageType': 'LOAD',\n      });\n      this.win.opener./*OK*/postMessage(payload, '*');\n    });\n  }\n\n  /**\n   * Sets the pageview state token associated with the slot. Token does not\n   * expire.\n   * @param {string} token\n   */\n  setPageviewStateToken(token) {\n    tokensToInstances[token] = this;\n  }\n\n  /**\n   * Checks for the presence of a pageview token in the module level object\n   * and removes it if present.\n   */\n  removePageviewStateToken() {\n    for (const token in tokensToInstances) {\n      if (tokensToInstances[token] == this) {\n        delete tokensToInstances[token];\n        break;\n      }\n    }\n  }\n\n  /** @override */\n  getA4aAnalyticsVars(analyticsTrigger) {\n    return getCsiAmpAnalyticsVariables(analyticsTrigger, this, this.qqid_);\n  }\n\n  /** @override */\n  getA4aAnalyticsConfig() {\n    return getCsiAmpAnalyticsConfig();\n  }\n}\n\nAMP.extension(TAG, '0.1', AMP => {\n  AMP.registerElement(TAG, AmpAdNetworkDoubleclickImpl);\n});\n\n\n/** @visibleForTesting */\nexport function resetSraStateForTesting() {\n  sraRequests = null;\n}\n\n/** @visibleForTesting */\nexport function resetLocationQueryParametersForTesting() {\n  windowLocationQueryParameters = null;\n}\n\n/**\n * @param {!Element} element\n * @return {string} networkId from data-ad-slot attribute.\n * @visibleForTesting\n */\nexport function getNetworkId(element) {\n  const networkId = /^(?:\\/)?(\\d+)/.exec(\n      dev().assertString(element.getAttribute('data-slot')));\n  // TODO: guarantee data-ad-slot format as part of isValidElement?\n  return networkId ? networkId[1] : '';\n}\n\n\n/**\n * @param {!../../../extensions/amp-a4a/0.1/amp-a4a.AmpA4A} a4a\n * @param {!Array<!AmpAdNetworkDoubleclickImpl>} instances\n * @return {!Promise<string>} SRA request URL\n */\nfunction constructSRARequest_(a4a, instances) {\n  // TODO(bradfrizzell): Need to add support for RTC.\n  dev().assert(instances && instances.length);\n  const startTime = Date.now();\n  return Promise.all(\n      instances.map(instance => instance.getAdUrlDeferred.promise))\n      .then(() => googlePageParameters(a4a, startTime))\n      .then(googPageLevelParameters => {\n        const blockParameters = constructSRABlockParameters(instances);\n        return truncAndTimeUrl(DOUBLECLICK_BASE_URL,\n            Object.assign(blockParameters, googPageLevelParameters,\n                instances[0].getPageParameters(instances[0].consentState,\n                    instances)), startTime);\n      });\n}\n\n/**\n * Returns the pageview tokens that should be included in the ad request. Tokens\n * should come only from instances that are not being requested in this request.\n * @param {!Array<!AmpAdNetworkDoubleclickImpl>} instancesInAdRequest\n * @return {!Array<string>} Array of pageview tokens to include in the ad\n * request.\n */\nexport function getPageviewStateTokensForAdRequest(instancesInAdRequest) {\n  const pageviewStateTokensInAdRequest = [];\n  for (const token in tokensToInstances) {\n    if (!instancesInAdRequest.includes(\n        tokensToInstances[token])) {\n      pageviewStateTokensInAdRequest.push(token);\n    }\n  }\n  return pageviewStateTokensInAdRequest;\n}\n\n/**\n * Resets the tokensToInstances mapping for testing purposes.\n * @visibleForTesting\n */\nexport function resetTokensToInstancesMap() {\n  tokensToInstances = {};\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from '../../../src/services';\nimport {dev} from '../../../src/log';\nimport {dict, hasOwn} from '../../../src/utils/object';\nimport {getData} from '../../../src/event-helper';\nimport {getStyle} from '../../../src/style';\nimport {parseUrlDeprecated} from '../../../src/url';\nimport {setStyles} from '../../../src/style';\nimport {throttle} from '../../../src/utils/rate-limit';\nimport {tryParseJson} from '../../../src/json';\n\n/**\n * Used to manage messages for different Safeframe ad slots.\n *\n * Maps a sentinel value to an instance of the SafeframeHostApi to which that\n * sentinel value belongs.\n * @type {!Object<string, !SafeframeHostApi>}\n */\nexport const safeframeHosts = {};\n\n/** @private {boolean} */\nlet safeframeListenerCreated_ = false;\n\n/** @enum {string} */\nexport const MESSAGE_FIELDS = {\n  CHANNEL: 'c',\n  SENTINEL: 'e',\n  ENDPOINT_IDENTITY: 'i',\n  PAYLOAD: 'p',\n  SERVICE: 's',\n  MESSAGE: 'message',\n};\n\n/** @enum {string} */\nexport const SERVICE = {\n  GEOMETRY_UPDATE: 'geometry_update',\n  CREATIVE_GEOMETRY_UPDATE: 'creative_geometry_update',\n  EXPAND_REQUEST: 'expand_request',\n  EXPAND_RESPONSE: 'expand_response',\n  REGISTER_DONE: 'register_done',\n  COLLAPSE_REQUEST: 'collapse_request',\n  COLLAPSE_RESPONSE: 'collapse_response',\n  RESIZE_REQUEST: 'resize_request',\n  RESIZE_RESPONSE: 'resize_response',\n};\n\n/** @private {string} */\nconst TAG = 'AMP-DOUBLECLICK-SAFEFRAME';\n\n/** @const {string} */\nexport const SAFEFRAME_ORIGIN = 'https://tpc.googlesyndication.com';\n\n/**\n * Event listener callback for message events. If message is a Safeframe\n * message, handles the message. This listener is registered within\n * SafeframeHostApi.\n * @param {!Event} event\n */\nexport function safeframeListener(event) {\n  const data = tryParseJson(getData(event));\n  /** Only process messages that are valid Safeframe messages */\n  if (event.origin != SAFEFRAME_ORIGIN || !data) {\n    return;\n  }\n  const payload = tryParseJson(data[MESSAGE_FIELDS.PAYLOAD]) || {};\n  /**\n   * If the sentinel is provided at the top level, this is a message simply\n   * to setup the postMessage channel, so set it up.\n   */\n  const sentinel = data[MESSAGE_FIELDS.SENTINEL] || payload['sentinel'];\n  const safeframeHost = safeframeHosts[sentinel];\n  if (!safeframeHost) {\n    dev().warn(TAG, `Safeframe Host for sentinel: ${sentinel} not found.`);\n    return;\n  }\n  if (!safeframeHost.channel) {\n    safeframeHost.connectMessagingChannel(data[MESSAGE_FIELDS.CHANNEL]);\n  } else if (payload) {\n    // Currently we do not expect a payload on initial connection messages.\n    safeframeHost.processMessage(/** @type {!JsonObject} */(payload),\n        data[MESSAGE_FIELDS.SERVICE]);\n  }\n}\n\n/**\n * Sets up the host API for DoubleClick Safeframe to allow the following\n * Safeframe container APIs to work:\n *   - $sf.ext.expand()\n *   - $sf.ext.collapse()\n *   - $sf.ext.geom() Expand and collapse are both implemented utilizing AMP's\n *     built in element resizing.\n *\n * For geom, the host needs to send geometry updates into the container whenever\n *  a position change happens, at a max frequency of 1 message/second. To\n *  implement this messaging, we are leveraging the existing\n *  IntersectionObserver class that works with AMP elements. However, the\n *  safeframe iframe that we need to monitor is not an AMP element, but rather\n *  contained within an amp-ad. So, we are doing intersection observing on the\n *  amp-ad, and calculating the correct position for the iframe whenever we get\n *  an update.\n *\n * We pass an instance of this class into the IntersectionObserver class, which\n *  then calls the instance of send() below whenever an update occurs.\n */\nexport class SafeframeHostApi {\n\n  /**\n   * @param {!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl} baseInstance\n   * @param {boolean} isFluid\n   * @param {{width:number, height:number}} creativeSize\n   * @param {?string} fluidImpressionUrl\n   */\n  constructor(baseInstance, isFluid, creativeSize, fluidImpressionUrl) {\n    /** @private {!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl} */\n    this.baseInstance_ = baseInstance;\n\n    /** @private {!Function} */\n    this.checkStillCurrent_ = this.baseInstance_.verifyStillCurrent.bind(\n        this.baseInstance_)();\n\n    /** @private {!Window} */\n    this.win_ = this.baseInstance_.win;\n\n    /** @private {string} */\n    this.sentinel_ = this.baseInstance_.sentinel;\n\n    /** @private {?Element} */\n    this.iframe_ = null;\n\n    /** @type {?string} */\n    this.channel = null;\n\n    /** @private {?JsonObject} */\n    this.currentGeometry_ = null;\n\n    /** @private {number} */\n    this.endpointIdentity_ = Math.random();\n\n    /** @private {number} */\n    this.uid_ = Math.random();\n\n    /** @private {boolean} */\n    this.isFluid_ = isFluid;\n\n    /** @private {{width:number, height:number}} */\n    this.creativeSize_ = creativeSize;\n\n    /** @private {{width:number, height:number}} */\n    this.initialCreativeSize_ =\n      /** @private {{width:number, height:number}} */\n      (Object.assign({}, creativeSize));\n\n    /** @private {?string} */\n    this.fluidImpressionUrl_ = fluidImpressionUrl;\n\n    /** @private {?Promise} */\n    this.delay_ = null;\n\n    /** @private {../../../src/service/viewport/viewport-impl.Viewport} */\n    this.viewport_ = this.baseInstance_.getViewport();\n\n    /** @private {boolean} */\n    this.isCollapsed_ = true;\n\n    /** @private {boolean} */\n    this.isRegistered_ = false;\n\n    // TODO: Make this page-level.\n    const sfConfig = Object(tryParseJson(\n        this.baseInstance_.element.getAttribute(\n            'data-safeframe-config')) || {});\n    /** @private {boolean} */\n    this.expandByOverlay_ = hasOwn(sfConfig, 'expandByOverlay') ?\n      sfConfig['expandByOverlay'] : true;\n\n    /** @private {boolean} */\n    this.expandByPush_ = hasOwn(sfConfig, 'expandByPush') ?\n      sfConfig['expandByPush'] : true;\n\n    /** @private {?Function} */\n    this.unlisten_ = null;\n\n    this.registerSafeframeHost();\n  }\n\n  /**\n   * Returns the Safeframe specific name attributes that are needed for the\n   * Safeframe creative to properly setup.\n   * @return {!JsonObject}\n   */\n  getSafeframeNameAttr() {\n    const attributes = dict({});\n    attributes['uid'] = this.uid_;\n    attributes['hostPeerName'] = this.win_.location.origin;\n    attributes['initialGeometry'] = this.getInitialGeometry();\n    attributes['permissions'] = JSON.stringify(\n        dict({\n          'expandByOverlay': this.expandByOverlay_,\n          'expandByPush': this.expandByPush_,\n          'readCookie': false,\n          'writeCookie': false,\n        }));\n    attributes['metadata'] = JSON.stringify(\n        dict({\n          'shared': {\n            'sf_ver': this.baseInstance_.safeframeVersion,\n            'ck_on': 1,\n            'flash_ver': '26.0.0',\n            // Once GPT Safeframe is updated to look in amp object,\n            // remove this canonical_url here.\n            'canonical_url': this.maybeGetCanonicalUrl(),\n            'amp': {\n              'canonical_url': this.maybeGetCanonicalUrl(),\n            },\n          },\n        }));\n    attributes['reportCreativeGeometry'] = this.isFluid_;\n    attributes['isDifferentSourceWindow'] = false;\n    attributes['sentinel'] = this.sentinel_;\n    return attributes;\n  }\n\n  /**\n   * Returns the canonical URL of the page, if the publisher allows\n   * it to be passed.\n   * @return {string|undefined}\n   * @visibleForTesting\n   */\n  maybeGetCanonicalUrl() {\n    // Don't allow for referrer policy same-origin,\n    // as Safeframe will always be a different origin.\n    // Don't allow for no-referrer.\n    const {canonicalUrl} = Services.documentInfoForDoc(\n        this.baseInstance_.getAmpDoc());\n    const metaReferrer = this.win_.document.querySelector(\n        \"meta[name='referrer']\");\n    if (!metaReferrer) {\n      return canonicalUrl;\n    }\n    switch (metaReferrer.getAttribute('content')) {\n      case 'same-origin':\n        return;\n      case 'no-referrer':\n        return;\n      case 'origin':\n        return parseUrlDeprecated(canonicalUrl).origin;\n    }\n    return canonicalUrl;\n  }\n\n  /**\n   * Returns the initialGeometry to assign to the name of the safeframe\n   * for rendering. This needs to be done differently than all the other\n   * geometry updates, because we don't actually have access to the\n   * rendered safeframe yet. Note that we are using getPageLayoutBox,\n   * which is not guaranteed to be perfectly accurate as it is from\n   * the last measure of the element. This is fine for our use case\n   * here, as even if the position is slightly off, we'll send the right\n   * size.\n   * @return {string}\n   */\n  getInitialGeometry() {\n    const ampAdBox = this.baseInstance_.getPageLayoutBox();\n    const heightOffset = (ampAdBox.height - this.creativeSize_.height) / 2;\n    const widthOffset = (ampAdBox.width - this.creativeSize_.width) / 2;\n    const iframeBox = /** @type {!../../../src/layout-rect.LayoutRectDef} */ ({\n      top: ampAdBox.top + heightOffset,\n      bottom: ampAdBox.bottom - heightOffset,\n      left: ampAdBox.left + widthOffset,\n      right: ampAdBox.right - widthOffset,\n      height: this.initialCreativeSize_.height,\n      width: this.initialCreativeSize_.width,\n    });\n    return this.formatGeom_(iframeBox);\n  }\n\n  /**\n   * Registers this instance as the host API for the current sentinel.\n   * If the global safeframe listener has not yet been created, it creates\n   * that as well.\n   */\n  registerSafeframeHost() {\n    dev().assert(this.sentinel_);\n    safeframeHosts[this.sentinel_] = safeframeHosts[this.sentinel_] || this;\n    if (!safeframeListenerCreated_) {\n      safeframeListenerCreated_ = true;\n      this.win_.addEventListener('message', safeframeListener, false);\n    }\n  }\n\n  /**\n   * Sends initial connection message to the safeframe to finish initialization.\n   * Also initializes the sending of geometry update messages to the frame.\n   * @param {string} channel\n   */\n  connectMessagingChannel(channel) {\n    // Set the iframe here, because when class is first created the iframe\n    // element does not yet exist on this.baseInstance_. The first time\n    // we receive a message we know that it now exists.\n    dev().assert(this.baseInstance_.iframe);\n    this.iframe_ = this.baseInstance_.iframe;\n    this.channel = channel;\n    this.setupGeom_();\n    this.sendMessage_({\n      'message': 'connect',\n      'c': this.channel,\n    }, '');\n  }\n\n  /**\n   * Creates IntersectionObserver instance for this SafeframeAPI instance.\n   * We utilize the existing IntersectionObserver class, by passing in this\n   * class for IO to use instead of SubscriptionApi for sending its update\n   * messages. The method 'send' below is triggered by IO every time that\n   * an update occurs.\n   * @private\n   */\n  setupGeom_() {\n    dev().assert(this.iframe_.contentWindow,\n        'Frame contentWindow unavailable.');\n    const throttledUpdate = throttle(\n        this.win_, this.updateGeometry_.bind(this), 1000);\n    const scrollUnlistener = this.viewport_.onScroll(throttledUpdate);\n    const changedUnlistener = this.viewport_.onChanged(throttledUpdate);\n    this.unlisten_ = () => {\n      scrollUnlistener();\n      changedUnlistener();\n    };\n    this.updateGeometry_();\n  }\n\n  /**\n   * Sends a geometry update message into the safeframe.\n   * @private\n   */\n  updateGeometry_() {\n    if (!this.iframe_) {\n      return;\n    }\n    this.viewport_.getClientRectAsync(this.iframe_).then(iframeBox => {\n      this.checkStillCurrent_();\n      const formattedGeom = this.formatGeom_(iframeBox);\n      this.sendMessage_({\n        newGeometry: formattedGeom,\n        uid: this.uid_,\n      }, SERVICE.GEOMETRY_UPDATE);\n    }).catch(err => dev().error(TAG, err));\n  }\n\n  /**\n   * Builds geometry update format expected by GPT Safeframe.\n   * Also sets this.currentGeometry as side effect.\n   * @param {!../../../src/layout-rect.LayoutRectDef} iframeBox The elementRect for the safeframe.\n   * @return {string} Safeframe formatted changes.\n   * @private\n   */\n  formatGeom_(iframeBox) {\n    const viewportSize = this.viewport_.getSize();\n    const scrollLeft = this.viewport_.getScrollLeft();\n    const scrollTop = this.viewport_.getScrollTop();\n    const currentGeometry = /** @type {JsonObject} */({\n      'windowCoords_t': 0,\n      'windowCoords_r': viewportSize.width,\n      'windowCoords_b': viewportSize.height,\n      'windowCoords_l': 0,\n      'frameCoords_t': iframeBox.top + scrollTop,\n      'frameCoords_r': iframeBox.right + scrollLeft,\n      'frameCoords_b': iframeBox.bottom + scrollTop,\n      'frameCoords_l': iframeBox.left + scrollLeft,\n      'posCoords_t': iframeBox.top,\n      'posCoords_b': iframeBox.bottom,\n      'posCoords_r': iframeBox.right,\n      'posCoords_l': iframeBox.left,\n      'styleZIndex': getStyle(this.baseInstance_.element, 'zIndex'),\n      // AMP's built in resize methodology that we use only allows expansion\n      // to the right and bottom, so we enforce that here.\n      'allowedExpansion_r': viewportSize.width -\n          iframeBox.width,\n      'allowedExpansion_b': viewportSize.height -\n          iframeBox.height,\n      'allowedExpansion_t': 0,\n      'allowedExpansion_l': 0,\n      'yInView': this.getPercInView(viewportSize.height,\n          iframeBox.top, iframeBox.bottom),\n      'xInView': this.getPercInView(viewportSize.width,\n          iframeBox.left, iframeBox.right),\n    });\n    this.currentGeometry_ = currentGeometry;\n    return JSON.stringify(currentGeometry);\n  }\n\n  /**\n   * Helper function to calculate both the xInView and yInView of the\n   * geometry update messages. In the case of a 400px wide viewport,\n   * with a 100px wide creative that starts at x position 50, if we\n   * are calculating xInView, rootBoundEnd is 400, boundingRectStart\n   * is 50, and boundingRectEnd is 150.\n   * @param {number} rootBoundEnd\n   * @param {number} boundingRectStart\n   * @param {number} boundingRectEnd\n   * @return {number}\n   */\n  getPercInView(rootBoundEnd, boundingRectStart, boundingRectEnd) {\n    const lengthInView = (boundingRectEnd >= rootBoundEnd) ?\n      rootBoundEnd - boundingRectStart : boundingRectEnd;\n    const percInView = lengthInView / (boundingRectEnd - boundingRectStart);\n    return Math.max(0, Math.min(1, percInView)) || 0;\n  }\n\n  /**\n   * Handles serializing and sending messages to the safeframe.\n   * @param {!Object} payload\n   * @param {string} serviceName\n   * @private\n   */\n  sendMessage_(payload, serviceName) {\n    if (!this.iframe_.contentWindow) {\n      dev().error(TAG, 'Frame contentWindow unavailable.');\n      return;\n    }\n    const message = dict();\n    message[MESSAGE_FIELDS.CHANNEL] = this.channel;\n    message[MESSAGE_FIELDS.PAYLOAD] = JSON.stringify(\n        /** @type {!JsonObject} */(payload));\n    message[MESSAGE_FIELDS.SERVICE] = serviceName;\n    message[MESSAGE_FIELDS.SENTINEL] = this.sentinel_;\n    message[MESSAGE_FIELDS.ENDPOINT_IDENTITY] = this.endpointIdentity_;\n    this.iframe_.contentWindow./*OK*/postMessage(\n        JSON.stringify(message), SAFEFRAME_ORIGIN);\n  }\n\n  /**\n   * Routes messages to their appropriate handler.\n   * @param {!JsonObject} payload\n   * @param {string} service\n   */\n  processMessage(payload, service) {\n    // We are not logging unexpected messages, and some expected\n    // messages are being dropped, like init_done, as we don't need them.\n    switch (service) {\n      case SERVICE.CREATIVE_GEOMETRY_UPDATE:\n        this.handleFluidMessage_(payload);\n        break;\n      case SERVICE.EXPAND_REQUEST:\n        this.handleExpandRequest_(payload);\n        break;\n      case SERVICE.REGISTER_DONE:\n        this.isRegistered_ = true;\n        break;\n      case SERVICE.COLLAPSE_REQUEST:\n        this.handleCollapseRequest_();\n        break;\n      case SERVICE.RESIZE_REQUEST:\n        this.handleResizeRequest_(payload);\n      default:\n        break;\n    }\n  }\n\n\n  /**\n   * @param {!JsonObject} payload\n   * @private\n   */\n  handleExpandRequest_(payload) {\n    if (!this.isRegistered_) {\n      return;\n    }\n    const expandHeight = Number(this.creativeSize_.height) +\n          payload['expand_b'] + payload['expand_t'];\n    const expandWidth = Number(this.creativeSize_.width) +\n          payload['expand_r'] + payload['expand_l'];\n    // Verify that if expanding by push, that expandByPush is allowed.\n    // If expanding by overlay, verify that expandByOverlay is allowed,\n    // and that we are only expanding within the bounds of the amp-ad.\n    if (isNaN(expandHeight) || isNaN(expandWidth) ||\n        (payload['push'] && !this.expandByPush_) ||\n        (!payload['push'] && !this.expandByOverlay_ &&\n         (expandWidth > this.creativeSize_.width ||\n          expandHeight > this.creativeSize_.height))) {\n      dev().error(TAG, 'Invalid expand values.');\n      this.sendResizeResponse(\n          /* SUCCESS? */ false, SERVICE.EXPAND_RESPONSE);\n      return;\n    }\n    // Can't expand to greater than the viewport size\n    if (expandHeight > this.viewport_.getSize().height ||\n        expandWidth > this.viewport_.getSize().width) {\n      this.sendResizeResponse(\n          /* SUCCESS? */ false, SERVICE.EXPAND_RESPONSE);\n      return;\n    }\n    this.handleSizeChange(expandHeight,\n        expandWidth,\n        SERVICE.EXPAND_RESPONSE);\n  }\n\n  /**\n   * @private\n   */\n  handleCollapseRequest_() {\n    // Only collapse if expanded.\n    if (this.isCollapsed_ || !this.isRegistered_) {\n      this.sendResizeResponse(\n          /* SUCCESS? */ false, SERVICE.COLLAPSE_RESPONSE);\n      return;\n    }\n    this.handleSizeChange(this.initialCreativeSize_.height,\n        this.initialCreativeSize_.width,\n        SERVICE.COLLAPSE_RESPONSE,\n        /** isCollapse */ true);\n  }\n\n  /**\n   * @param {number} height\n   * @param {number} width\n   * @param {string} messageType\n   */\n  resizeSafeframe(height, width, messageType) {\n    this.isCollapsed_ = messageType == SERVICE.COLLAPSE_RESPONSE;\n    this.baseInstance_.measureMutateElement(\n        /** MEASURER */ () => {\n          this.baseInstance_.getResource().measure();\n        },\n        /** MUTATOR */ () => {\n          if (this.iframe_) {\n            setStyles(this.iframe_, {\n              'height': height + 'px',\n              'width': width + 'px',\n            });\n            this.creativeSize_.height = height;\n            this.creativeSize_.width = width;\n          }\n          this.sendResizeResponse(/** SUCCESS */ true, messageType);\n        },\n        this.iframe_\n    );\n  }\n\n  /**\n   * Resizes the safeframe, and potentially the containing amp-ad element.\n   * Then sends a response message to the Safeframe creative.\n   *\n   * For expansion:\n   *  If the new size is fully contained within the bounds of the amp-ad,\n   *  we can resize immediately as there will be no reflow. However, if\n   *  the new size is larger than the amp-ad, then first we need to try\n   *  to resize the amp-ad, and only resize the safeframe if that succeeds.\n   * For collapse:\n   *  We always first want to attempt to collapse the amp-ad. Then,\n   *  regardless of whether that succeeds, we collapse the safeframe too.\n   * @param {number} height In pixels.\n   * @param {number} width In pixels.\n   * @param {string} messageType\n   * @param {boolean=} optIsCollapse Whether this is a collapse attempt.\n   */\n  handleSizeChange(height, width, messageType, optIsCollapse) {\n    return this.viewport_.getClientRectAsync(\n        this.baseInstance_.element).then(box => {\n      if (!optIsCollapse && width <= box.width && height <= box.height) {\n        this.resizeSafeframe(height, width, messageType);\n      } else {\n        this.resizeAmpAdAndSafeframe(height, width, messageType,\n            optIsCollapse);\n      }\n    });\n  }\n\n  /**\n   * @param {!JsonObject} payload\n   * @private\n   */\n  handleResizeRequest_(payload) {\n    if (!this.isRegistered_) {\n      return;\n    }\n    const resizeHeight = Number(this.creativeSize_.height) +\n          (payload['resize_b'] + payload['resize_t']);\n    const resizeWidth = Number(this.creativeSize_.width) +\n          (payload['resize_r'] + payload['resize_l']);\n\n    // Make sure we are actually resizing here.\n    if (isNaN(resizeWidth) || isNaN(resizeHeight) ||\n        resizeWidth > this.creativeSize_.width ||\n        resizeHeight > this.creativeSize_.height) {\n      dev().error(TAG, 'Invalid resize values.');\n      return;\n    }\n\n    this.resizeAmpAdAndSafeframe(resizeHeight, resizeWidth,\n        SERVICE.RESIZE_RESPONSE, true);\n  }\n\n  /**\n   * @param {boolean} success\n   * @param {string} messageType\n   */\n  sendResizeResponse(success, messageType) {\n    if (!this.iframe_) {\n      return;\n    }\n    this.viewport_.getClientRectAsync(this.iframe_).then(iframeBox => {\n      this.checkStillCurrent_();\n      const formattedGeom = this.formatGeom_(iframeBox);\n      this.sendMessage_({\n        uid: this.uid_,\n        success,\n        newGeometry: formattedGeom,\n        'expand_t': this.currentGeometry_['allowedExpansion_t'],\n        'expand_b': this.currentGeometry_['allowedExpansion_b'],\n        'expand_r': this.currentGeometry_['allowedExpansion_r'],\n        'expand_l': this.currentGeometry_['allowedExpansion_l'],\n        push: true,\n      }, messageType);\n    }).catch(err => dev().error(TAG, err));\n  }\n\n  /**\n   * Attempts to resize both the amp-ad and the Safeframe.\n   * If the amp-ad can not be resized, then if it was a collapse request,\n   * we will still collapse just the safeframe.\n   * @param {number} height\n   * @param {number} width\n   * @param {string} messageType\n   * @param {boolean=} opt_isShrinking True if collapsing or resizing smaller.\n   */\n  resizeAmpAdAndSafeframe(height, width, messageType, opt_isShrinking) {\n    // First, attempt to resize the Amp-Ad that is the parent of the\n    // safeframe\n    this.baseInstance_.attemptChangeSize(height, width).then(() => {\n      this.checkStillCurrent_();\n      // If this resize succeeded, we always resize the safeframe.\n      // resizeSafeframe also sends the resize response.\n      this.resizeSafeframe(height, width, messageType);\n    }, /** REJECT CALLBACK */ () => {\n      // If the resize initially failed, it may have been queued\n      // as a pendingChangeSize, which will cause the size change\n      // to execute upon the next user interaction. We don't want\n      // that for safeframe, so we reset it here.\n      this.baseInstance_.getResource().resetPendingChangeSize();\n      if (opt_isShrinking) {\n        // If this is a collapse or resize request, then even if resizing\n        // the amp-ad failed, still resize the iframe.\n        // resizeSafeframe also sends the resize response.\n        // Only register as collapsed if explicitly a collapse request.\n        this.resizeSafeframe(height, width, messageType);\n      } else {\n        // We were attempting to\n        // expand past the bounds of the amp-ad, and it failed. Thus,\n        // we need to send a failure message, and the safeframe is\n        // not resized.\n        this.sendResizeResponse(false, messageType);\n      }\n    }).catch(err => {\n      if (err.message == 'CANCELLED') {\n        dev().error(TAG, err);\n        return;\n      }\n      dev().error(TAG, `Resizing failed: ${err}`);\n      this.sendResizeResponse(false, messageType);\n    });\n  }\n\n  /**\n   * Handles Fluid-related messages dispatched from SafeFrame.\n   * @param {!JsonObject} payload\n   * @private\n   */\n  handleFluidMessage_(payload) {\n    let newHeight;\n    if (!payload || !(newHeight = parseInt(payload['height'], 10))) {\n      // TODO(levitzky) Add actual error handling here.\n      this.baseInstance_.forceCollapse();\n      return;\n    }\n    this.baseInstance_.attemptChangeHeight(newHeight)\n        .then(() => {\n          this.checkStillCurrent_();\n          this.onFluidResize_(newHeight);\n        }).catch(err => {\n          if (err.message == 'CANCELLED') {\n            dev().error(TAG, err);\n            return;\n          }\n          // TODO(levitzky) Add more error handling here\n          this.baseInstance_.forceCollapse();\n        });\n  }\n\n  /**\n   * Fires a delayed impression and notifies the Fluid creative that its\n   * container has been resized.\n   * @param {number} newHeight The height expanded to.\n   * @private\n   */\n  onFluidResize_(newHeight) {\n    const iframe = dev().assertElement(this.baseInstance_.iframe);\n    const iframeHeight = parseInt(getStyle(iframe, 'height'), 10) || 0;\n    if (iframeHeight != newHeight) {\n      setStyles(iframe, {height: `${newHeight}px`});\n    }\n    if (this.fluidImpressionUrl_) {\n      this.baseInstance_.fireDelayedImpressions(\n          this.fluidImpressionUrl_);\n      this.fluidImpressionUrl_ = null;\n    }\n    this.iframe_.contentWindow./*OK*/postMessage(\n        JSON.stringify(dict({'message': 'resize-complete', 'c': this.channel})),\n        SAFEFRAME_ORIGIN);\n  }\n\n  /**\n   * Unregister this Host API.\n   */\n  destroy() {\n    this.iframe_ = null;\n    delete safeframeHosts[this.sentinel_];\n    if (this.unlisten_) {\n      this.unlisten_();\n    }\n    if (Object.keys(safeframeHosts).length == 0) {\n      removeSafeframeListener();\n    }\n  }\n}\n\n/**\n * Removes the safeframe event listener.\n */\nexport function removeSafeframeListener() {\n  window.removeEventListener('message', safeframeListener, false);\n  safeframeListenerCreated_ = false;\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RENDERING_TYPE_HEADER, XORIGIN_MODE} from '../../amp-a4a/0.1/amp-a4a';\nimport {dev} from '../../../src/log';\nimport {getEnclosingContainerTypes} from '../../../ads/google/a4a/utils';\nimport {\n  isInManualExperiment,\n} from '../../../ads/google/a4a/traffic-experiments';\nimport {isObject} from '../../../src/types';\nimport {tryResolve} from '../../../src/utils/promise';\nimport {utf8Encode} from '../../../src/utils/bytes';\n\n/** @type {string} */\nconst TAG = 'amp-ad-network-doubleclick-impl';\n\n/**\n * @const {string}\n * @visibleForTesting\n */\nexport const TFCD = 'tagForChildDirectedTreatment';\n\n/** @private {!Array<function(!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>):?Object<string,string>>} */\nconst SRA_JOINERS = [\n  combineInventoryUnits, getCookieOptOut, getAdks, getSizes, getTfcd, isAdTest,\n  getTargetingAndExclusions, getExperimentIds, getIdentity, getForceSafeframe,\n  getPageOffsets, getContainers];\n\n/**\n  * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n  * @return {!Object<string, *>}\n  */\nexport function constructSRABlockParameters(impls) {\n  const parameters = {'output': 'ldjh', 'impl': 'fifs'};\n  SRA_JOINERS.forEach(joiner => Object.assign(parameters, joiner(impls)));\n  return parameters;\n}\n\n/**\n * Given array of instances, execute extractFn on each and return first non-\n * falsey value or null if none are truthy.\n * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n * @param {function(!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl):?T} extractFn\n * @return {?T} value of first instance with non-null/undefined value or null\n *    if none can be found\n * @template T\n * @private\n */\nfunction getFirstInstanceValue_(impls, extractFn) {\n  for (let i = 0; i < impls.length; i++) {\n    const val = extractFn(impls[i]);\n    if (val) {\n      return val;\n    }\n  }\n  return null;\n}\n\n/**\n * Combines inventory unit paths for multiple blocks by building list of\n * unique path parts in iu_parts and then comma separated list of block\n * paths using index into iu_parts list.\n * Example: /123/foo/bar and /blah/foo/bar/123 =>\n *    iu_parts=123,foo,bar,blah & enc_prev_ius=/0/1/2,/3/1/2/0\n * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n * @return {?Object<string,string>}\n * @visibleForTesting\n */\nexport function combineInventoryUnits(impls) {\n  const uniqueIuNames = {};\n  const iuNamesOutput = [];\n  let uniqueIuNamesCount = 0;\n  const prevIusEncoded = [];\n  impls.forEach(instance => {\n    const iu = dev().assert(instance.element.getAttribute('data-slot'));\n    const componentNames = iu.split('/');\n    const encodedNames = [];\n    for (let i = 0; i < componentNames.length; i++) {\n      if (componentNames[i] == '') {\n        continue;\n      }\n      let index = uniqueIuNames[componentNames[i]];\n      if (index == undefined) {\n        iuNamesOutput.push(componentNames[i]);\n        uniqueIuNames[componentNames[i]] = (index = uniqueIuNamesCount++);\n      }\n      encodedNames.push(index);\n    }\n    prevIusEncoded.push(encodedNames.join('/'));\n  });\n  return {\n    'iu_parts': iuNamesOutput.join(),\n    'enc_prev_ius': prevIusEncoded.join(),\n  };\n}\n\n/**\n * Indicates SRA request is cookie opt out if any of the blocks includes\n * cookie opt out in targeting.\n * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n * @return {?Object<string,string>}\n * @visibleForTesting\n */\nexport function getCookieOptOut(impls) {\n  return getFirstInstanceValue_(impls, impl =>\n    impl.jsonTargeting &&\n         impl.jsonTargeting['cookieOptOut'] ? {'co': '1'} : null);\n}\n\n/**\n * Combine ad unit key of each block via comma separated values.\n * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n * @return {?Object<string,string>}\n * @visibleForTesting\n */\nexport function getAdks(impls) {\n  return ({'adks': impls.map(impl => dev().assert(impl.adKey)).join()});\n}\n\n/**\n * Combine block sizes via comma separated values.\n * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n * @return {?Object<string,string>}\n * @visibleForTesting\n */\nexport function getSizes(impls) {\n  return ({'prev_iu_szs': impls.map(impl =>\n    dev().assert(impl.parameterSize)).join()});\n}\n\n/**\n * Indicate SRA request is tagForChildDirectedTreatment if any blocks includes\n * in targeting.\n * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n * @return {?Object<string,string>}\n * @visibleForTesting\n */\nexport function getTfcd(impls) {\n  return getFirstInstanceValue_(impls, impl =>\n    impl.jsonTargeting && impl.jsonTargeting[TFCD] ?\n      {'tfcd': impl.jsonTargeting[TFCD]} : null);\n}\n\n/**\n * Indicate SRA request should include adtest=on if any block includes the\n * manual experiment id.\n * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n * @return {?Object<string,string>}\n * @visibleForTesting\n */\nexport function isAdTest(impls) {\n  return getFirstInstanceValue_(impls, impl =>\n    isInManualExperiment(impl.element) ? {'adtest': 'on'} : null);\n}\n\n/**\n * Join block targeting values by separating by pipes (each key/value pair for\n * a given block is separated by =) and exclusions are given special excl_cat\n * key (list of categories are comma separated).\n * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n * @return {?Object<string,string>}\n * @visibleForTesting\n */\nexport function getTargetingAndExclusions(impls) {\n  let hasScp = false;\n  const scps = [];\n  impls.forEach(impl => {\n    if (impl.jsonTargeting && (impl.jsonTargeting['targeting'] ||\n       impl.jsonTargeting['categoryExclusions'])) {\n      hasScp = true;\n      scps.push(serializeTargeting(\n          impl.jsonTargeting['targeting'] || null,\n          impl.jsonTargeting['categoryExclusions'] || null));\n    } else {\n      scps.push('');\n    }\n  });\n  return hasScp ? {'prev_scp': scps.join('|')} : null;\n}\n\n/**\n * Experiment ids are assumed to be page level given that is all that is\n * supported for SRA requests therefore block values are combined by building\n * the unique set of experiment ids which are comma separated (order does not\n * matter).\n * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n * @return {?Object<string,string>}\n * @visibleForTesting\n */\nexport function getExperimentIds(impls) {\n  const eids = {};\n  const deid = (impls.length &&\n     /(?:#|,)deid=([\\d,]+)/i.exec(impls[0].win.location.hash)) || [];\n  (deid[1] || '').split(',').forEach(eid => eid && (eids[eid] = 1));\n  impls.forEach(impl => impl.experimentIds.forEach(eid => eids[eid] = 1));\n  const eidKeys = Object.keys(eids).join();\n  return eidKeys ? {'eid': eidKeys} : null;\n}\n\n/**\n * Identity token is page level therefore SRA uses the value of the first\n * block.\n * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n * @return {?Object<string,string>}\n * @visibleForTesting\n */\nexport function getIdentity(impls) {\n  return getFirstInstanceValue_(impls, impl => impl.buildIdentityParams());\n}\n\n/**\n * Combine force safeframe values for each block via comma separated numeric\n * values based on boolean value (e.g. false = 0, true = 1).  If none of the\n * blocks has force safeframe, parameter is not included in SRA request.\n * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n * @return {?Object<string,string>}\n * @visibleForTesting\n */\nexport function getForceSafeframe(impls) {\n  let safeframeForced = false;\n  const forceSafeframes = [];\n  impls.forEach(impl => {\n    safeframeForced = safeframeForced || impl.forceSafeframe;\n    forceSafeframes.push(Number(impl.forceSafeframe));\n  });\n  return safeframeForced ? {'fsfs': forceSafeframes.join()} : null;\n}\n\n/**\n * Combine page offset info for each block by constructing separate parameter\n * for left (adxs) and top (adyx) via comma separated.\n * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n * @return {?Object<string,string>}\n * @visibleForTesting\n */\nexport function getPageOffsets(impls) {\n  const adxs = [];\n  const adys = [];\n  impls.forEach(impl => {\n    const layoutBox = impl.getPageLayoutBox();\n    adxs.push(layoutBox.left);\n    adys.push(layoutBox.top);\n  });\n  return {'adxs': adxs.join(), 'adys': adys.join()};\n}\n\n/**\n * Combine which containers exist for each block (e.g. sticky) via pipe\n * separator (as block can have multiple values that are comma separated).  If\n * none of the blocks have a container, then parameter is not sent.\n * @param {!Array<!./amp-ad-network-doubleclick-impl.AmpAdNetworkDoubleclickImpl>} impls\n * @return {?Object<string,string>}\n * @visibleForTesting\n */\nexport function getContainers(impls) {\n  let hasAmpContainer = false;\n  const result = [];\n  impls.forEach(impl => {\n    const containers = getEnclosingContainerTypes(impl.element);\n    result.push(containers.join());\n    hasAmpContainer = hasAmpContainer || !!containers.length;\n  });\n  return hasAmpContainer ? {'acts': result.join('|')} : null;\n}\n\n/**\n * @param {?Object<string, (!Array<string>|string)>} targeting\n * @param {?(!Array<string>|string)} categoryExclusions\n * @return {?string}\n */\nexport function serializeTargeting(targeting, categoryExclusions) {\n  const serialized = targeting ?\n    Object.keys(targeting).map(key => serializeItem_(key, targeting[key])) :\n    [];\n  if (categoryExclusions) {\n    serialized.push(serializeItem_('excl_cat', categoryExclusions));\n  }\n  return serialized.length ? serialized.join('&') : null;\n}\n\n/**\n * @param {string} key\n * @param {(!Array<string>|string)} value\n * @return {string}\n * @private\n */\nfunction serializeItem_(key, value) {\n  const serializedValue =\n    (Array.isArray(value) ? value : [value]).map(encodeURIComponent).join();\n  return `${encodeURIComponent(key)}=${serializedValue}`;\n}\n\n/**\n * Callback for streaming SRA response given creative and JSON parsed Object\n * containing headers (as if request had been sent via non-SRA flow).  Creative\n * and headers object is converted to XHR FetchResponse object and passed to\n * resolver popped off stack of resolvers (in order of expected block responses)\n * such that sendXhrRequest is resolved from standard A4A flow.  Done boolean\n * used to verify array of resolvers is empty once all results are returned.\n * @param {string} creative\n * @param {!Object<string,string>} headersObj\n * @param {boolean} done\n * @param {!Array<function(?../../../src/utils/xhr-utils.FetchResponse)>} sraRequestAdUrlResolvers\n * @param {string} sraUrl url of SRA request for error reporting\n */\nexport function sraBlockCallbackHandler(\n  creative, headersObj, done, sraRequestAdUrlResolvers, sraUrl) {\n  const headerNames = Object.keys(headersObj);\n  if (headerNames.length == 1 &&\n      isObject(headersObj[headerNames[0]])) {\n    // TODO(keithwrightbos) - fix upstream so response does\n    // not improperly place headers under key.\n    headersObj =\n      /** @type {!Object} */(headersObj)[headerNames[0]];\n    headersObj = Object.keys(headersObj).reduce(\n        (newObj, key) => {\n          newObj[key.toLowerCase()] = headersObj[key];\n          return newObj;\n        }, {});\n  }\n  // Force safeframe rendering method.\n  headersObj[RENDERING_TYPE_HEADER.toLowerCase()] =\n      XORIGIN_MODE.SAFEFRAME;\n  // Construct pseudo fetch response to be passed down the A4A\n  // promise chain for this block.\n  const headers =\n/** @type {?../../../src/utils/xhr-utils.FetchResponseHeaders} */\n({\n  get: name => {\n    // TODO(keithwrightbos) - fix upstream so response writes\n    // all metadata values as strings.\n    let header = headersObj[name.toLowerCase()];\n    if (header && typeof header != 'string') {\n      header = JSON.stringify(header);\n    }\n    return header;\n  },\n  has: name => !!headersObj[name.toLowerCase()],\n});\n  const fetchResponse =\n/** @type {?../../../src/utils/xhr-utils.FetchResponse} */\n({\n  headers,\n  arrayBuffer: () => tryResolve(() => utf8Encode(creative)),\n});\n  // Pop head off of the array of resolvers as the response\n  // should match the order of blocks declared in the ad url.\n  // This allows the block to start rendering while the SRA\n  // response is streaming back to the client.\n  dev().assert(sraRequestAdUrlResolvers.shift())(fetchResponse);\n  // If done, expect array to be empty (ensures ad response\n  // included data for all slots).\n  if (done && sraRequestAdUrlResolvers.length) {\n    dev().warn(TAG, 'Premature end of SRA response',\n        sraRequestAdUrlResolvers.length, sraUrl);\n  }\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {startsWith} from '../../../src/string';\n\n/** @const @private {string} */\nconst GMOSSP_SRC_PREFIX_ = 'https://sp.gmossp-sp.jp/';\n\n/** @const @private {string} */\nconst GMOSSP_SRC_A4A_PREFIX_ = 'https://amp.sp.gmossp-sp.jp/_a4a/';\n\n/**\n * @param {!Window} win\n * @param {!Element} element\n * @param {boolean} useRemoteHtml\n * @return {boolean}\n */\nexport function gmosspIsA4AEnabled(win, element, useRemoteHtml) {\n  let src;\n  return !useRemoteHtml && !!(src = element.getAttribute('src')) &&\n      !!element.getAttribute('data-use-a4a') &&\n      (startsWith(src, GMOSSP_SRC_PREFIX_) ||\n       startsWith(src, GMOSSP_SRC_A4A_PREFIX_));\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @const @private {string} */\nconst SRC_PREFIX_ = 'https://ib.3lift.com/';\n/**\n * @param {!Window} win\n * @param {!Element} element\n * @param {boolean} useRemoteHtml\n * @return {boolean}\n */\nexport function tripleliftIsA4AEnabled(win, element, useRemoteHtml) {\n  let src;\n  return !useRemoteHtml && !!element.getAttribute('data-use-a4a') && !!(src =\n    element.getAttribute('src')) && src.indexOf(SRC_PREFIX_) == 0;\n}\n","/* Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Deferred} from '../../../src/utils/promise';\nimport {Services} from '../../../src/services';\nimport {user} from '../../../src/log';\n\n/**\n * Store loading ads info within window to ensure it can be properly stored\n * across separately compiled binaries that share load throttling.\n * @const ID of window variable used to track 3p ads waiting to load.\n */\nconst LOADING_ADS_WIN_ID_ = '3pla';\n\n/** @private {?Promise} resolves when no 3p throttle */\nlet throttlePromise_ = null;\n/** @private {?Function} resolver for throttle promise */\nlet throttlePromiseResolver_ = null;\n\n/**\n * @param {!Window} win\n * @return {boolean} Whether 3p is currently throttled.\n */\nexport function is3pThrottled(win) {\n  return !!win[LOADING_ADS_WIN_ID_];\n}\n\n/** @return {!Promise} resolves when no 3p throttle */\nexport function waitFor3pThrottle() {\n  return throttlePromise_ || Promise.resolve();\n}\n\n/**\n * @param {!Element} element\n * @return {?number} number if explicit value should be used otherwise super\n *    default should be used.\n */\nexport function getAmpAdRenderOutsideViewport(element) {\n  const rawValue = element.getAttribute('data-loading-strategy');\n  if (rawValue == null) {\n    return null;\n  }\n  // Ad opts into lazier loading strategy where we only load ads that are\n  // at closer given number of viewports away.\n  if (rawValue == 'prefer-viewability-over-views' || rawValue == '') {\n    return 1.25;\n  }\n  const errorMessage =\n      'Value of data-loading-strategy should be a float number in range ' +\n      'of [0, 3], but got ' + rawValue;\n  const viewportNumber =\n      user().assertNumber(parseFloat(rawValue), errorMessage);\n  user().assert(viewportNumber >= 0 && viewportNumber <= 3, errorMessage);\n  return viewportNumber;\n}\n\n/**\n * Increments loading ads count for throttling.\n * @param {!Window} win\n * @param {!Promise=} opt_loadingPromise\n */\nexport function incrementLoadingAds(win, opt_loadingPromise) {\n  if (win[LOADING_ADS_WIN_ID_] === undefined) {\n    win[LOADING_ADS_WIN_ID_] = 0;\n  }\n  win[LOADING_ADS_WIN_ID_]++;\n\n  if (!throttlePromise_) {\n    const deferred = new Deferred();\n    throttlePromise_ = deferred.promise;\n    throttlePromiseResolver_ = deferred.resolve;\n  }\n\n  Services.timerFor(win)\n      .timeoutPromise(1000, opt_loadingPromise)\n      .catch(() => {})\n      .then(() => {\n        if (!--win[LOADING_ADS_WIN_ID_]) {\n          throttlePromiseResolver_();\n          throttlePromise_ = null;\n          throttlePromiseResolver_ = null;\n        }\n      });\n}\n","/*!\n\nCopyright (C) 2014-2016 by Andrea Giammarchi - @WebReflection\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n\n*/\n// global window Object\n// optional polyfill info\n//    'auto' used by default, everything is feature detected\n//    'force' use the polyfill even if not fully needed\nfunction installCustomElements(window, polyfill) {'use strict';\n\n  // DO NOT USE THIS FILE DIRECTLY, IT WON'T WORK\n  // THIS IS A PROJECT BASED ON A BUILD SYSTEM\n  // THIS FILE IS JUST WRAPPED UP RESULTING IN\n  // build/document-register-element.node.js\n\n  var\n    document = window.document,\n    Object = window.Object\n  ;\n\n  var htmlClass = (function (info) {\n    // (C) Andrea Giammarchi - @WebReflection - MIT Style\n    var\n      catchClass = /^[A-Z]+[a-z]/,\n      filterBy = function (re) {\n        var arr = [], tag;\n        for (tag in register) {\n          if (re.test(tag)) arr.push(tag);\n        }\n        return arr;\n      },\n      add = function (Class, tag) {\n        tag = tag.toLowerCase();\n        if (!(tag in register)) {\n          register[Class] = (register[Class] || []).concat(tag);\n          register[tag] = (register[tag.toUpperCase()] = Class);\n        }\n      },\n      register = (Object.create || Object)(null),\n      htmlClass = {},\n      i, section, tags, Class\n    ;\n    for (section in info) {\n      for (Class in info[section]) {\n        tags = info[section][Class];\n        register[Class] = tags;\n        for (i = 0; i < tags.length; i++) {\n          register[tags[i].toLowerCase()] =\n          register[tags[i].toUpperCase()] = Class;\n        }\n      }\n    }\n    htmlClass.get = function get(tagOrClass) {\n      return typeof tagOrClass === 'string' ?\n        (register[tagOrClass] || (catchClass.test(tagOrClass) ? [] : '')) :\n        filterBy(tagOrClass);\n    };\n    htmlClass.set = function set(tag, Class) {\n      return (catchClass.test(tag) ?\n        add(tag, Class) :\n        add(Class, tag)\n      ), htmlClass;\n    };\n    return htmlClass;\n  }({\n    \"collections\": {\n      \"HTMLAllCollection\": [\n        \"all\"\n      ],\n      \"HTMLCollection\": [\n        \"forms\"\n      ],\n      \"HTMLFormControlsCollection\": [\n        \"elements\"\n      ],\n      \"HTMLOptionsCollection\": [\n        \"options\"\n      ]\n    },\n    \"elements\": {\n      \"Element\": [\n        \"element\"\n      ],\n      \"HTMLAnchorElement\": [\n        \"a\"\n      ],\n      \"HTMLAppletElement\": [\n        \"applet\"\n      ],\n      \"HTMLAreaElement\": [\n        \"area\"\n      ],\n      \"HTMLAttachmentElement\": [\n        \"attachment\"\n      ],\n      \"HTMLAudioElement\": [\n        \"audio\"\n      ],\n      \"HTMLBRElement\": [\n        \"br\"\n      ],\n      \"HTMLBaseElement\": [\n        \"base\"\n      ],\n      \"HTMLBodyElement\": [\n        \"body\"\n      ],\n      \"HTMLButtonElement\": [\n        \"button\"\n      ],\n      \"HTMLCanvasElement\": [\n        \"canvas\"\n      ],\n      \"HTMLContentElement\": [\n        \"content\"\n      ],\n      \"HTMLDListElement\": [\n        \"dl\"\n      ],\n      \"HTMLDataElement\": [\n        \"data\"\n      ],\n      \"HTMLDataListElement\": [\n        \"datalist\"\n      ],\n      \"HTMLDetailsElement\": [\n        \"details\"\n      ],\n      \"HTMLDialogElement\": [\n        \"dialog\"\n      ],\n      \"HTMLDirectoryElement\": [\n        \"dir\"\n      ],\n      \"HTMLDivElement\": [\n        \"div\"\n      ],\n      \"HTMLDocument\": [\n        \"document\"\n      ],\n      \"HTMLElement\": [\n        \"element\",\n        \"abbr\",\n        \"address\",\n        \"article\",\n        \"aside\",\n        \"b\",\n        \"bdi\",\n        \"bdo\",\n        \"cite\",\n        \"code\",\n        \"command\",\n        \"dd\",\n        \"dfn\",\n        \"dt\",\n        \"em\",\n        \"figcaption\",\n        \"figure\",\n        \"footer\",\n        \"header\",\n        \"i\",\n        \"kbd\",\n        \"mark\",\n        \"nav\",\n        \"noscript\",\n        \"rp\",\n        \"rt\",\n        \"ruby\",\n        \"s\",\n        \"samp\",\n        \"section\",\n        \"small\",\n        \"strong\",\n        \"sub\",\n        \"summary\",\n        \"sup\",\n        \"u\",\n        \"var\",\n        \"wbr\"\n      ],\n      \"HTMLEmbedElement\": [\n        \"embed\"\n      ],\n      \"HTMLFieldSetElement\": [\n        \"fieldset\"\n      ],\n      \"HTMLFontElement\": [\n        \"font\"\n      ],\n      \"HTMLFormElement\": [\n        \"form\"\n      ],\n      \"HTMLFrameElement\": [\n        \"frame\"\n      ],\n      \"HTMLFrameSetElement\": [\n        \"frameset\"\n      ],\n      \"HTMLHRElement\": [\n        \"hr\"\n      ],\n      \"HTMLHeadElement\": [\n        \"head\"\n      ],\n      \"HTMLHeadingElement\": [\n        \"h1\",\n        \"h2\",\n        \"h3\",\n        \"h4\",\n        \"h5\",\n        \"h6\"\n      ],\n      \"HTMLHtmlElement\": [\n        \"html\"\n      ],\n      \"HTMLIFrameElement\": [\n        \"iframe\"\n      ],\n      \"HTMLImageElement\": [\n        \"img\"\n      ],\n      \"HTMLInputElement\": [\n        \"input\"\n      ],\n      \"HTMLKeygenElement\": [\n        \"keygen\"\n      ],\n      \"HTMLLIElement\": [\n        \"li\"\n      ],\n      \"HTMLLabelElement\": [\n        \"label\"\n      ],\n      \"HTMLLegendElement\": [\n        \"legend\"\n      ],\n      \"HTMLLinkElement\": [\n        \"link\"\n      ],\n      \"HTMLMapElement\": [\n        \"map\"\n      ],\n      \"HTMLMarqueeElement\": [\n        \"marquee\"\n      ],\n      \"HTMLMediaElement\": [\n        \"media\"\n      ],\n      \"HTMLMenuElement\": [\n        \"menu\"\n      ],\n      \"HTMLMenuItemElement\": [\n        \"menuitem\"\n      ],\n      \"HTMLMetaElement\": [\n        \"meta\"\n      ],\n      \"HTMLMeterElement\": [\n        \"meter\"\n      ],\n      \"HTMLModElement\": [\n        \"del\",\n        \"ins\"\n      ],\n      \"HTMLOListElement\": [\n        \"ol\"\n      ],\n      \"HTMLObjectElement\": [\n        \"object\"\n      ],\n      \"HTMLOptGroupElement\": [\n        \"optgroup\"\n      ],\n      \"HTMLOptionElement\": [\n        \"option\"\n      ],\n      \"HTMLOutputElement\": [\n        \"output\"\n      ],\n      \"HTMLParagraphElement\": [\n        \"p\"\n      ],\n      \"HTMLParamElement\": [\n        \"param\"\n      ],\n      \"HTMLPictureElement\": [\n        \"picture\"\n      ],\n      \"HTMLPreElement\": [\n        \"pre\"\n      ],\n      \"HTMLProgressElement\": [\n        \"progress\"\n      ],\n      \"HTMLQuoteElement\": [\n        \"blockquote\",\n        \"q\",\n        \"quote\"\n      ],\n      \"HTMLScriptElement\": [\n        \"script\"\n      ],\n      \"HTMLSelectElement\": [\n        \"select\"\n      ],\n      \"HTMLShadowElement\": [\n        \"shadow\"\n      ],\n      \"HTMLSlotElement\": [\n        \"slot\"\n      ],\n      \"HTMLSourceElement\": [\n        \"source\"\n      ],\n      \"HTMLSpanElement\": [\n        \"span\"\n      ],\n      \"HTMLStyleElement\": [\n        \"style\"\n      ],\n      \"HTMLTableCaptionElement\": [\n        \"caption\"\n      ],\n      \"HTMLTableCellElement\": [\n        \"td\",\n        \"th\"\n      ],\n      \"HTMLTableColElement\": [\n        \"col\",\n        \"colgroup\"\n      ],\n      \"HTMLTableElement\": [\n        \"table\"\n      ],\n      \"HTMLTableRowElement\": [\n        \"tr\"\n      ],\n      \"HTMLTableSectionElement\": [\n        \"thead\",\n        \"tbody\",\n        \"tfoot\"\n      ],\n      \"HTMLTemplateElement\": [\n        \"template\"\n      ],\n      \"HTMLTextAreaElement\": [\n        \"textarea\"\n      ],\n      \"HTMLTimeElement\": [\n        \"time\"\n      ],\n      \"HTMLTitleElement\": [\n        \"title\"\n      ],\n      \"HTMLTrackElement\": [\n        \"track\"\n      ],\n      \"HTMLUListElement\": [\n        \"ul\"\n      ],\n      \"HTMLUnknownElement\": [\n        \"unknown\",\n        \"vhgroupv\",\n        \"vkeygen\"\n      ],\n      \"HTMLVideoElement\": [\n        \"video\"\n      ]\n    },\n    \"nodes\": {\n      \"Attr\": [\n        \"node\"\n      ],\n      \"Audio\": [\n        \"audio\"\n      ],\n      \"CDATASection\": [\n        \"node\"\n      ],\n      \"CharacterData\": [\n        \"node\"\n      ],\n      \"Comment\": [\n        \"#comment\"\n      ],\n      \"Document\": [\n        \"#document\"\n      ],\n      \"DocumentFragment\": [\n        \"#document-fragment\"\n      ],\n      \"DocumentType\": [\n        \"node\"\n      ],\n      \"HTMLDocument\": [\n        \"#document\"\n      ],\n      \"Image\": [\n        \"img\"\n      ],\n      \"Option\": [\n        \"option\"\n      ],\n      \"ProcessingInstruction\": [\n        \"node\"\n      ],\n      \"ShadowRoot\": [\n        \"#shadow-root\"\n      ],\n      \"Text\": [\n        \"#text\"\n      ],\n      \"XMLDocument\": [\n        \"xml\"\n      ]\n    }\n  }));\n  \n  \n    \n  // passed at runtime, configurable\n  // via nodejs module\n  if (!polyfill) polyfill = 'auto';\n  \n  var\n    // V0 polyfill entry\n    REGISTER_ELEMENT = 'registerElement',\n  \n    // IE < 11 only + old WebKit for attributes + feature detection\n    EXPANDO_UID = '__' + REGISTER_ELEMENT + (window.Math.random() * 10e4 >> 0),\n  \n    // shortcuts and costants\n    ADD_EVENT_LISTENER = 'addEventListener',\n    ATTACHED = 'attached',\n    CALLBACK = 'Callback',\n    DETACHED = 'detached',\n    EXTENDS = 'extends',\n  \n    ATTRIBUTE_CHANGED_CALLBACK = 'attributeChanged' + CALLBACK,\n    ATTACHED_CALLBACK = ATTACHED + CALLBACK,\n    CONNECTED_CALLBACK = 'connected' + CALLBACK,\n    DISCONNECTED_CALLBACK = 'disconnected' + CALLBACK,\n    CREATED_CALLBACK = 'created' + CALLBACK,\n    DETACHED_CALLBACK = DETACHED + CALLBACK,\n  \n    ADDITION = 'ADDITION',\n    MODIFICATION = 'MODIFICATION',\n    REMOVAL = 'REMOVAL',\n  \n    DOM_ATTR_MODIFIED = 'DOMAttrModified',\n    DOM_CONTENT_LOADED = 'DOMContentLoaded',\n    DOM_SUBTREE_MODIFIED = 'DOMSubtreeModified',\n  \n    PREFIX_TAG = '<',\n    PREFIX_IS = '=',\n  \n    // valid and invalid node names\n    validName = /^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,\n    invalidNames = [\n      'ANNOTATION-XML',\n      'COLOR-PROFILE',\n      'FONT-FACE',\n      'FONT-FACE-SRC',\n      'FONT-FACE-URI',\n      'FONT-FACE-FORMAT',\n      'FONT-FACE-NAME',\n      'MISSING-GLYPH'\n    ],\n  \n    // registered types and their prototypes\n    types = [],\n    protos = [],\n  \n    // to query subnodes\n    query = '',\n  \n    // html shortcut used to feature detect\n    documentElement = document.documentElement,\n  \n    // ES5 inline helpers || basic patches\n    indexOf = types.indexOf || function (v) {\n      for(var i = this.length; i-- && this[i] !== v;){}\n      return i;\n    },\n  \n    // other helpers / shortcuts\n    OP = Object.prototype,\n    hOP = OP.hasOwnProperty,\n    iPO = OP.isPrototypeOf,\n  \n    defineProperty = Object.defineProperty,\n    empty = [],\n    gOPD = Object.getOwnPropertyDescriptor,\n    gOPN = Object.getOwnPropertyNames,\n    gPO = Object.getPrototypeOf,\n    sPO = Object.setPrototypeOf,\n  \n    // jshint proto: true\n    hasProto = !!Object.__proto__,\n  \n    // V1 helpers\n    fixGetClass = false,\n    DRECEV1 = '__dreCEv1',\n    customElements = window.customElements,\n    usableCustomElements = polyfill !== 'force' && !!(\n      customElements &&\n      customElements.define &&\n      customElements.get &&\n      customElements.whenDefined\n    ),\n    Dict = Object.create || Object,\n    Map = window.Map || function Map() {\n      var K = [], V = [], i;\n      return {\n        get: function (k) {\n          return V[indexOf.call(K, k)];\n        },\n        set: function (k, v) {\n          i = indexOf.call(K, k);\n          if (i < 0) V[K.push(k) - 1] = v;\n          else V[i] = v;\n        }\n      };\n    },\n    Promise = window.Promise || function (fn) {\n      var\n        notify = [],\n        done = false,\n        p = {\n          'catch': function () {\n            return p;\n          },\n          'then': function (cb) {\n            notify.push(cb);\n            if (done) setTimeout(resolve, 1);\n            return p;\n          }\n        }\n      ;\n      function resolve(value) {\n        done = true;\n        while (notify.length) notify.shift()(value);\n      }\n      fn(resolve);\n      return p;\n    },\n    justCreated = false,\n    constructors = Dict(null),\n    waitingList = Dict(null),\n    nodeNames = new Map(),\n    secondArgument = function (is) {\n      return is.toLowerCase();\n    },\n  \n    // used to create unique instances\n    create = Object.create || function Bridge(proto) {\n      // silly broken polyfill probably ever used but short enough to work\n      return proto ? ((Bridge.prototype = proto), new Bridge()) : this;\n    },\n  \n    // will set the prototype if possible\n    // or copy over all properties\n    setPrototype = sPO || (\n      hasProto ?\n        function (o, p) {\n          o.__proto__ = p;\n          return o;\n        } : (\n      (gOPN && gOPD) ?\n        (function(){\n          function setProperties(o, p) {\n            for (var\n              key,\n              names = gOPN(p),\n              i = 0, length = names.length;\n              i < length; i++\n            ) {\n              key = names[i];\n              if (!hOP.call(o, key)) {\n                defineProperty(o, key, gOPD(p, key));\n              }\n            }\n          }\n          return function (o, p) {\n            do {\n              setProperties(o, p);\n            } while ((p = gPO(p)) && !iPO.call(p, o));\n            return o;\n          };\n        }()) :\n        function (o, p) {\n          for (var key in p) {\n            o[key] = p[key];\n          }\n          return o;\n        }\n    )),\n  \n    // DOM shortcuts and helpers, if any\n  \n    MutationObserver = window.MutationObserver ||\n                       window.WebKitMutationObserver,\n  \n    HTMLElementPrototype = (\n      window.HTMLElement ||\n      window.Element ||\n      window.Node\n    ).prototype,\n  \n    IE8 = !iPO.call(HTMLElementPrototype, documentElement),\n  \n    safeProperty = IE8 ? function (o, k, d) {\n      o[k] = d.value;\n      return o;\n    } : defineProperty,\n  \n    isValidNode = IE8 ?\n      function (node) {\n        return node.nodeType === 1;\n      } :\n      function (node) {\n        return iPO.call(HTMLElementPrototype, node);\n      },\n  \n    targets = IE8 && [],\n  \n    attachShadow = HTMLElementPrototype.attachShadow,\n    cloneNode = HTMLElementPrototype.cloneNode,\n    dispatchEvent = HTMLElementPrototype.dispatchEvent,\n    getAttribute = HTMLElementPrototype.getAttribute,\n    hasAttribute = HTMLElementPrototype.hasAttribute,\n    removeAttribute = HTMLElementPrototype.removeAttribute,\n    setAttribute = HTMLElementPrototype.setAttribute,\n  \n    // replaced later on\n    createElement = document.createElement,\n    patchedCreateElement = createElement,\n  \n    // shared observer for all attributes\n    attributesObserver = MutationObserver && {\n      attributes: true,\n      characterData: true,\n      attributeOldValue: true\n    },\n  \n    // useful to detect only if there's no MutationObserver\n    DOMAttrModified = MutationObserver || function(e) {\n      doesNotSupportDOMAttrModified = false;\n      documentElement.removeEventListener(\n        DOM_ATTR_MODIFIED,\n        DOMAttrModified\n      );\n    },\n  \n    // will both be used to make DOMNodeInserted asynchronous\n    asapQueue,\n    asapTimer = 0,\n  \n    // internal flags\n    V0 = REGISTER_ELEMENT in document,\n    setListener = true,\n    justSetup = false,\n    doesNotSupportDOMAttrModified = true,\n    dropDomContentLoaded = true,\n  \n    // needed for the innerHTML helper\n    notFromInnerHTMLHelper = true,\n  \n    // optionally defined later on\n    onSubtreeModified,\n    callDOMAttrModified,\n    getAttributesMirror,\n    observer,\n    observe,\n  \n    // based on setting prototype capability\n    // will check proto or the expando attribute\n    // in order to setup the node once\n    patchIfNotAlready,\n    patch\n  ;\n  \n  // only if needed\n  if (!V0) {\n  \n    if (sPO || hasProto) {\n        patchIfNotAlready = function (node, proto) {\n          if (!iPO.call(proto, node)) {\n            setupNode(node, proto);\n          }\n        };\n        patch = setupNode;\n    } else {\n        patchIfNotAlready = function (node, proto) {\n          if (!node[EXPANDO_UID]) {\n            node[EXPANDO_UID] = Object(true);\n            setupNode(node, proto);\n          }\n        };\n        patch = patchIfNotAlready;\n    }\n  \n    if (IE8) {\n      doesNotSupportDOMAttrModified = false;\n      (function (){\n        var\n          descriptor = gOPD(HTMLElementPrototype, ADD_EVENT_LISTENER),\n          addEventListener = descriptor.value,\n          patchedRemoveAttribute = function (name) {\n            var e = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true});\n            e.attrName = name;\n            e.prevValue = getAttribute.call(this, name);\n            e.newValue = null;\n            e[REMOVAL] = e.attrChange = 2;\n            removeAttribute.call(this, name);\n            dispatchEvent.call(this, e);\n          },\n          patchedSetAttribute = function (name, value) {\n            var\n              had = hasAttribute.call(this, name),\n              old = had && getAttribute.call(this, name),\n              e = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true})\n            ;\n            setAttribute.call(this, name, value);\n            e.attrName = name;\n            e.prevValue = had ? old : null;\n            e.newValue = value;\n            if (had) {\n              e[MODIFICATION] = e.attrChange = 1;\n            } else {\n              e[ADDITION] = e.attrChange = 0;\n            }\n            dispatchEvent.call(this, e);\n          },\n          onPropertyChange = function (e) {\n            // jshint eqnull:true\n            var\n              node = e.currentTarget,\n              superSecret = node[EXPANDO_UID],\n              propertyName = e.propertyName,\n              event\n            ;\n            if (superSecret.hasOwnProperty(propertyName)) {\n              superSecret = superSecret[propertyName];\n              event = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true});\n              event.attrName = superSecret.name;\n              event.prevValue = superSecret.value || null;\n              event.newValue = (superSecret.value = node[propertyName] || null);\n              if (event.prevValue == null) {\n                event[ADDITION] = event.attrChange = 0;\n              } else {\n                event[MODIFICATION] = event.attrChange = 1;\n              }\n              dispatchEvent.call(node, event);\n            }\n          }\n        ;\n        descriptor.value = function (type, handler, capture) {\n          if (\n            type === DOM_ATTR_MODIFIED &&\n            this[ATTRIBUTE_CHANGED_CALLBACK] &&\n            this.setAttribute !== patchedSetAttribute\n          ) {\n            this[EXPANDO_UID] = {\n              className: {\n                name: 'class',\n                value: this.className\n              }\n            };\n            this.setAttribute = patchedSetAttribute;\n            this.removeAttribute = patchedRemoveAttribute;\n            addEventListener.call(this, 'propertychange', onPropertyChange);\n          }\n          addEventListener.call(this, type, handler, capture);\n        };\n        defineProperty(HTMLElementPrototype, ADD_EVENT_LISTENER, descriptor);\n      }());\n    } else if (!MutationObserver) {\n      documentElement[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED, DOMAttrModified);\n      documentElement.setAttribute(EXPANDO_UID, 1);\n      documentElement.removeAttribute(EXPANDO_UID);\n      if (doesNotSupportDOMAttrModified) {\n        onSubtreeModified = function (e) {\n          var\n            node = this,\n            oldAttributes,\n            newAttributes,\n            key\n          ;\n          if (node === e.target) {\n            oldAttributes = node[EXPANDO_UID];\n            node[EXPANDO_UID] = (newAttributes = getAttributesMirror(node));\n            for (key in newAttributes) {\n              if (!(key in oldAttributes)) {\n                // attribute was added\n                return callDOMAttrModified(\n                  0,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  ADDITION\n                );\n              } else if (newAttributes[key] !== oldAttributes[key]) {\n                // attribute was changed\n                return callDOMAttrModified(\n                  1,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  MODIFICATION\n                );\n              }\n            }\n            // checking if it has been removed\n            for (key in oldAttributes) {\n              if (!(key in newAttributes)) {\n                // attribute removed\n                return callDOMAttrModified(\n                  2,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  REMOVAL\n                );\n              }\n            }\n          }\n        };\n        callDOMAttrModified = function (\n          attrChange,\n          currentTarget,\n          attrName,\n          prevValue,\n          newValue,\n          action\n        ) {\n          var e = {\n            attrChange: attrChange,\n            currentTarget: currentTarget,\n            attrName: attrName,\n            prevValue: prevValue,\n            newValue: newValue\n          };\n          e[action] = attrChange;\n          onDOMAttrModified(e);\n        };\n        getAttributesMirror = function (node) {\n          for (var\n            attr, name,\n            result = {},\n            attributes = node.attributes,\n            i = 0, length = attributes.length;\n            i < length; i++\n          ) {\n            attr = attributes[i];\n            name = attr.name;\n            if (name !== 'setAttribute') {\n              result[name] = attr.value;\n            }\n          }\n          return result;\n        };\n      }\n    }\n  \n    // set as enumerable, writable and configurable\n    document[REGISTER_ELEMENT] = function registerElement(type, options) {\n      upperType = type.toUpperCase();\n      if (setListener) {\n        // only first time document.registerElement is used\n        // we need to set this listener\n        // setting it by default might slow down for no reason\n        setListener = false;\n        if (MutationObserver) {\n          observer = (function(attached, detached){\n            function checkEmAll(list, callback) {\n              for (var i = 0, length = list.length; i < length; callback(list[i++])){}\n            }\n            return new MutationObserver(function (records) {\n              for (var\n                current, node, newValue,\n                i = 0, length = records.length; i < length; i++\n              ) {\n                current = records[i];\n                if (current.type === 'childList') {\n                  checkEmAll(current.addedNodes, attached);\n                  checkEmAll(current.removedNodes, detached);\n                } else {\n                  node = current.target;\n                  if (notFromInnerHTMLHelper &&\n                      node[ATTRIBUTE_CHANGED_CALLBACK] &&\n                      current.attributeName !== 'style') {\n                    newValue = getAttribute.call(node, current.attributeName);\n                    if (newValue !== current.oldValue) {\n                      node[ATTRIBUTE_CHANGED_CALLBACK](\n                        current.attributeName,\n                        current.oldValue,\n                        newValue\n                      );\n                    }\n                  }\n                }\n              }\n            });\n          }(executeAction(ATTACHED), executeAction(DETACHED)));\n          observe = function (node) {\n            observer.observe(\n              node,\n              {\n                childList: true,\n                subtree: true\n              }\n            );\n            return node;\n          };\n          observe(document);\n          if (attachShadow) {\n            HTMLElementPrototype.attachShadow = function () {\n              return observe(attachShadow.apply(this, arguments));\n            };\n          }\n        } else {\n          asapQueue = [];\n          document[ADD_EVENT_LISTENER]('DOMNodeInserted', onDOMNode(ATTACHED));\n          document[ADD_EVENT_LISTENER]('DOMNodeRemoved', onDOMNode(DETACHED));\n        }\n  \n        document[ADD_EVENT_LISTENER](DOM_CONTENT_LOADED, onReadyStateChange);\n        document[ADD_EVENT_LISTENER]('readystatechange', onReadyStateChange);\n  \n        HTMLElementPrototype.cloneNode = function (deep) {\n          var\n            node = cloneNode.call(this, !!deep),\n            i = getTypeIndex(node)\n          ;\n          if (-1 < i) patch(node, protos[i]);\n          if (deep && query.length) loopAndSetup(node.querySelectorAll(query));\n          return node;\n        };\n      }\n  \n      if (justSetup) return (justSetup = false);\n  \n      if (-2 < (\n        indexOf.call(types, PREFIX_IS + upperType) +\n        indexOf.call(types, PREFIX_TAG + upperType)\n      )) {\n        throwTypeError(type);\n      }\n  \n      if (!validName.test(upperType) || -1 < indexOf.call(invalidNames, upperType)) {\n        throw new Error('The type ' + type + ' is invalid');\n      }\n  \n      var\n        constructor = function () {\n          return extending ?\n            document.createElement(nodeName, upperType) :\n            document.createElement(nodeName);\n        },\n        opt = options || OP,\n        extending = hOP.call(opt, EXTENDS),\n        nodeName = extending ? options[EXTENDS].toUpperCase() : upperType,\n        upperType,\n        i\n      ;\n  \n      if (extending && -1 < (\n        indexOf.call(types, PREFIX_TAG + nodeName)\n      )) {\n        throwTypeError(nodeName);\n      }\n  \n      i = types.push((extending ? PREFIX_IS : PREFIX_TAG) + upperType) - 1;\n  \n      query = query.concat(\n        query.length ? ',' : '',\n        extending ? nodeName + '[is=\"' + type.toLowerCase() + '\"]' : nodeName\n      );\n  \n      constructor.prototype = (\n        protos[i] = hOP.call(opt, 'prototype') ?\n          opt.prototype :\n          create(HTMLElementPrototype)\n      );\n  \n      if (query.length) loopAndVerify(\n        document.querySelectorAll(query),\n        ATTACHED\n      );\n  \n      return constructor;\n    };\n  \n    document.createElement = (patchedCreateElement = function (localName, typeExtension) {\n      var\n        is = getIs(typeExtension),\n        node = is ?\n          createElement.call(document, localName, secondArgument(is)) :\n          createElement.call(document, localName),\n        name = '' + localName,\n        i = indexOf.call(\n          types,\n          (is ? PREFIX_IS : PREFIX_TAG) +\n          (is || name).toUpperCase()\n        ),\n        setup = -1 < i\n      ;\n      if (is) {\n        node.setAttribute('is', is = is.toLowerCase());\n        if (setup) {\n          setup = isInQSA(name.toUpperCase(), is);\n        }\n      }\n      notFromInnerHTMLHelper = !document.createElement.innerHTMLHelper;\n      if (setup) patch(node, protos[i]);\n      return node;\n    });\n  \n  }\n  \n  function ASAP() {\n    var queue = asapQueue.splice(0, asapQueue.length);\n    asapTimer = 0;\n    while (queue.length) {\n      queue.shift().call(\n        null, queue.shift()\n      );\n    }\n  }\n  \n  function loopAndVerify(list, action) {\n    for (var i = 0, length = list.length; i < length; i++) {\n      verifyAndSetupAndAction(list[i], action);\n    }\n  }\n  \n  function loopAndSetup(list) {\n    for (var i = 0, length = list.length, node; i < length; i++) {\n      node = list[i];\n      patch(node, protos[getTypeIndex(node)]);\n    }\n  }\n  \n  function executeAction(action) {\n    return function (node) {\n      if (isValidNode(node)) {\n        verifyAndSetupAndAction(node, action);\n        if (query.length) loopAndVerify(\n          node.querySelectorAll(query),\n          action\n        );\n      }\n    };\n  }\n  \n  function getTypeIndex(target) {\n    var\n      is = getAttribute.call(target, 'is'),\n      nodeName = target.nodeName.toUpperCase(),\n      i = indexOf.call(\n        types,\n        is ?\n            PREFIX_IS + is.toUpperCase() :\n            PREFIX_TAG + nodeName\n      )\n    ;\n    return is && -1 < i && !isInQSA(nodeName, is) ? -1 : i;\n  }\n  \n  function isInQSA(name, type) {\n    return -1 < query.indexOf(name + '[is=\"' + type + '\"]');\n  }\n  \n  function onDOMAttrModified(e) {\n    var\n      node = e.currentTarget,\n      attrChange = e.attrChange,\n      attrName = e.attrName,\n      target = e.target,\n      addition = e[ADDITION] || 2,\n      removal = e[REMOVAL] || 3\n    ;\n    if (notFromInnerHTMLHelper &&\n        (!target || target === node) &&\n        node[ATTRIBUTE_CHANGED_CALLBACK] &&\n        attrName !== 'style' && (\n          e.prevValue !== e.newValue ||\n          // IE9, IE10, and Opera 12 gotcha\n          e.newValue === '' && (\n            attrChange === addition ||\n            attrChange === removal\n          )\n    )) {\n      node[ATTRIBUTE_CHANGED_CALLBACK](\n        attrName,\n        attrChange === addition ? null : e.prevValue,\n        attrChange === removal ? null : e.newValue\n      );\n    }\n  }\n  \n  function onDOMNode(action) {\n    var executor = executeAction(action);\n    return function (e) {\n      asapQueue.push(executor, e.target);\n      if (asapTimer) clearTimeout(asapTimer);\n      asapTimer = setTimeout(ASAP, 1);\n    };\n  }\n  \n  function onReadyStateChange(e) {\n    if (dropDomContentLoaded) {\n      dropDomContentLoaded = false;\n      e.currentTarget.removeEventListener(DOM_CONTENT_LOADED, onReadyStateChange);\n    }\n    if (query.length) loopAndVerify(\n      (e.target || document).querySelectorAll(query),\n      e.detail === DETACHED ? DETACHED : ATTACHED\n    );\n    if (IE8) purge();\n  }\n  \n  function patchedSetAttribute(name, value) {\n    // jshint validthis:true\n    var self = this;\n    setAttribute.call(self, name, value);\n    onSubtreeModified.call(self, {target: self});\n  }\n  \n  function setupNode(node, proto) {\n    setPrototype(node, proto);\n    if (observer) {\n      observer.observe(node, attributesObserver);\n    } else {\n      if (doesNotSupportDOMAttrModified) {\n        node.setAttribute = patchedSetAttribute;\n        node[EXPANDO_UID] = getAttributesMirror(node);\n        node[ADD_EVENT_LISTENER](DOM_SUBTREE_MODIFIED, onSubtreeModified);\n      }\n      node[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED, onDOMAttrModified);\n    }\n    if (node[CREATED_CALLBACK] && notFromInnerHTMLHelper) {\n      node.created = true;\n      node[CREATED_CALLBACK]();\n      node.created = false;\n    }\n  }\n  \n  function purge() {\n    for (var\n      node,\n      i = 0,\n      length = targets.length;\n      i < length; i++\n    ) {\n      node = targets[i];\n      if (!documentElement.contains(node)) {\n        length--;\n        targets.splice(i--, 1);\n        verifyAndSetupAndAction(node, DETACHED);\n      }\n    }\n  }\n  \n  function throwTypeError(type) {\n    throw new Error('A ' + type + ' type is already registered');\n  }\n  \n  function verifyAndSetupAndAction(node, action) {\n    var\n      fn,\n      i = getTypeIndex(node)\n    ;\n    if (-1 < i) {\n      patchIfNotAlready(node, protos[i]);\n      i = 0;\n      if (action === ATTACHED && !node[ATTACHED]) {\n        node[DETACHED] = false;\n        node[ATTACHED] = true;\n        i = 1;\n        if (IE8 && indexOf.call(targets, node) < 0) {\n          targets.push(node);\n        }\n      } else if (action === DETACHED && !node[DETACHED]) {\n        node[ATTACHED] = false;\n        node[DETACHED] = true;\n        i = 1;\n      }\n      if (i && (fn = node[action + CALLBACK])) fn.call(node);\n    }\n  }\n  \n  \n  \n  // V1 in da House!\n  function CustomElementRegistry() {}\n  \n  CustomElementRegistry.prototype = {\n    constructor: CustomElementRegistry,\n    // a workaround for the stubborn WebKit\n    define: usableCustomElements ?\n      function (name, Class, options) {\n        if (options) {\n          CERDefine(name, Class, options);\n        } else {\n          var NAME = name.toUpperCase();\n          constructors[NAME] = {\n            constructor: Class,\n            create: [NAME]\n          };\n          nodeNames.set(Class, NAME);\n          customElements.define(name, Class);\n        }\n      } :\n      CERDefine,\n    get: usableCustomElements ?\n      function (name) {\n        return customElements.get(name) || get(name);\n      } :\n      get,\n    whenDefined: usableCustomElements ?\n      function (name) {\n        return Promise.race([\n          customElements.whenDefined(name),\n          whenDefined(name)\n        ]);\n      } :\n      whenDefined\n  };\n  \n  function CERDefine(name, Class, options) {\n    var\n      is = options && options[EXTENDS] || '',\n      CProto = Class.prototype,\n      proto = create(CProto),\n      attributes = Class.observedAttributes || empty,\n      definition = {prototype: proto}\n    ;\n    // TODO: is this needed at all since it's inherited?\n    // defineProperty(proto, 'constructor', {value: Class});\n    safeProperty(proto, CREATED_CALLBACK, {\n        value: function () {\n          if (justCreated) justCreated = false;\n          else if (!this[DRECEV1]) {\n            this[DRECEV1] = true;\n            new Class(this);\n            if (CProto[CREATED_CALLBACK])\n              CProto[CREATED_CALLBACK].call(this);\n            var info = constructors[nodeNames.get(Class)];\n            if (!usableCustomElements || info.create.length > 1) {\n              notifyAttributes(this);\n            }\n          }\n      }\n    });\n    safeProperty(proto, ATTRIBUTE_CHANGED_CALLBACK, {\n      value: function (name) {\n        if (-1 < indexOf.call(attributes, name))\n          CProto[ATTRIBUTE_CHANGED_CALLBACK].apply(this, arguments);\n      }\n    });\n    if (CProto[CONNECTED_CALLBACK]) {\n      safeProperty(proto, ATTACHED_CALLBACK, {\n        value: CProto[CONNECTED_CALLBACK]\n      });\n    }\n    if (CProto[DISCONNECTED_CALLBACK]) {\n      safeProperty(proto, DETACHED_CALLBACK, {\n        value: CProto[DISCONNECTED_CALLBACK]\n      });\n    }\n    if (is) definition[EXTENDS] = is;\n    name = name.toUpperCase();\n    constructors[name] = {\n      constructor: Class,\n      create: is ? [is, secondArgument(name)] : [name]\n    };\n    nodeNames.set(Class, name);\n    document[REGISTER_ELEMENT](name.toLowerCase(), definition);\n    whenDefined(name);\n    waitingList[name].r();\n  }\n  \n  function get(name) {\n    var info = constructors[name.toUpperCase()];\n    return info && info.constructor;\n  }\n  \n  function getIs(options) {\n    return typeof options === 'string' ?\n        options : (options && options.is || '');\n  }\n  \n  function notifyAttributes(self) {\n    var\n      callback = self[ATTRIBUTE_CHANGED_CALLBACK],\n      attributes = callback ? self.attributes : empty,\n      i = attributes.length,\n      attribute\n    ;\n    while (i--) {\n      attribute =  attributes[i]; // || attributes.item(i);\n      callback.call(\n        self,\n        attribute.name || attribute.nodeName,\n        null,\n        attribute.value || attribute.nodeValue\n      );\n    }\n  }\n  \n  function whenDefined(name) {\n    name = name.toUpperCase();\n    if (!(name in waitingList)) {\n      waitingList[name] = {};\n      waitingList[name].p = new Promise(function (resolve) {\n        waitingList[name].r = resolve;\n      });\n    }\n    return waitingList[name].p;\n  }\n  \n  function polyfillV1() {\n    if (customElements) delete window.customElements;\n    defineProperty(window, 'customElements', {\n      configurable: true,\n      value: new CustomElementRegistry()\n    });\n    defineProperty(window, 'CustomElementRegistry', {\n      configurable: true,\n      value: CustomElementRegistry\n    });\n    for (var\n      patchClass = function (name) {\n        var Class = window[name];\n        if (Class) {\n          window[name] = function CustomElementsV1(self) {\n            var info, isNative;\n            if (!self) self = this;\n            if (!self[DRECEV1]) {\n              justCreated = true;\n              info = constructors[nodeNames.get(self.constructor)];\n              isNative = usableCustomElements && info.create.length === 1;\n              self = isNative ?\n                Reflect.construct(Class, empty, info.constructor) :\n                document.createElement.apply(document, info.create);\n              self[DRECEV1] = true;\n              justCreated = false;\n              if (!isNative) notifyAttributes(self);\n            }\n            return self;\n          };\n          window[name].prototype = Class.prototype;\n          try {\n            Class.prototype.constructor = window[name];\n          } catch(WebKit) {\n            fixGetClass = true;\n            defineProperty(Class, DRECEV1, {value: window[name]});\n          }\n        }\n      },\n      Classes = htmlClass.get(/^HTML[A-Z]*[a-z]/),\n      i = Classes.length;\n      i--;\n      patchClass(Classes[i])\n    ) {}\n    (document.createElement = function (name, options) {\n      var is = getIs(options);\n      return is ?\n        patchedCreateElement.call(this, name, secondArgument(is)) :\n        patchedCreateElement.call(this, name);\n    });\n    if (!V0) {\n      justSetup = true;\n      document[REGISTER_ELEMENT]('');\n    }\n  }\n  \n  // if customElements is not there at all\n  if (!customElements || polyfill === 'force') polyfillV1();\n  else {\n    // if available test extends work as expected\n    try {\n      (function (DRE, options, name) {\n        options[EXTENDS] = 'a';\n        DRE.prototype = create(HTMLAnchorElement.prototype);\n        DRE.prototype.constructor = DRE;\n        window.customElements.define(name, DRE, options);\n        if (\n          getAttribute.call(document.createElement('a', {is: name}), 'is') !== name ||\n          (usableCustomElements && getAttribute.call(new DRE(), 'is') !== name)\n        ) {\n          throw options;\n        }\n      }(\n        function DRE() {\n          return Reflect.construct(HTMLAnchorElement, [], DRE);\n        },\n        {},\n        'document-register-element-a'\n      ));\n    } catch(o_O) {\n      // or force the polyfill if not\n      // and keep internal original reference\n      polyfillV1();\n    }\n  }\n  \n  try {\n    createElement.call(document, 'a', 'a');\n  } catch(FireFox) {\n    secondArgument = function (is) {\n      return {is: is.toLowerCase()};\n    };\n  }\n  \n}\n\nexports.installCustomElements = installCustomElements;\n\n","'use strict';\n\n/**\n * Constructs a ES6/Promises A+ Promise instance.\n *\n * @constructor\n * @param {function(function(*=), function (*=))} resolver\n */\nfunction Promise(resolver) {\n  if (!(this instanceof Promise)) {\n    throw new TypeError('Constructor Promise requires `new`');\n  }\n  if (!isFunction(resolver)) {\n    throw new TypeError('Must pass resolver function');\n  }\n\n  /**\n   * @type {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise}\n   * @private\n   */\n  this._state = PendingPromise;\n\n  /**\n   * @type {*}\n   * @private\n   */\n  this._value = [];\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this._isChainEnd = true;\n\n  doResolve(\n    this,\n    adopter(this, FulfilledPromise),\n    adopter(this, RejectedPromise),\n    { then: resolver }\n  );\n}\n\n/****************************\n  Public Instance Methods\n ****************************/\n\n/**\n * Creates a new promise instance that will receive the result of this promise\n * as inputs to the onFulfilled or onRejected callbacks.\n *\n * @param {function(*)} onFulfilled\n * @param {function(*)} onRejected\n */\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  onFulfilled = isFunction(onFulfilled) ? onFulfilled : void 0;\n  onRejected = isFunction(onRejected) ? onRejected : void 0;\n\n  if (onFulfilled || onRejected) {\n    this._isChainEnd = false;\n  }\n\n  return this._state(\n    this._value,\n    onFulfilled,\n    onRejected\n  );\n};\n\n/**\n * Creates a new promise that will handle the rejected state of this promise.\n *\n * @param {function(*)} onRejected\n * @returns {!Promise}\n */\nPromise.prototype.catch = function(onRejected) {\n  return this.then(void 0, onRejected);\n};\n\n/****************************\n  Public Static Methods\n ****************************/\n\n/**\n * Creates a fulfilled Promise of value. If value is itself a then-able,\n * resolves with the then-able's value.\n *\n * @this {!Promise}\n * @param {*=} value\n * @returns {!Promise}\n */\nPromise.resolve = function(value) {\n  var Constructor = this;\n  var promise;\n\n  if (isObject(value) && value instanceof this) {\n    promise = value;\n  } else {\n    promise = new Constructor(function(resolve) {\n      resolve(value);\n    });\n  }\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a rejected Promise of reason.\n *\n * @this {!Promise}\n * @param {*=} reason\n * @returns {!Promise}\n */\nPromise.reject = function(reason) {\n  var Constructor = this;\n  var promise = new Constructor(function(_, reject) {\n    reject(reason);\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve with an array of the values of the\n * passed in promises. If any promise rejects, the returned promise will\n * reject.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.all = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    var length = promises.length;\n    var values = new Array(length);\n\n    if (length === 0) {\n      return resolve(values);\n    }\n\n    each(promises, function(promise, index) {\n      Constructor.resolve(promise).then(function(value) {\n        values[index] = value;\n        if (--length === 0) {\n          resolve(values);\n        }\n      }, reject);\n    });\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve or reject based on the first\n * resolved or rejected promise.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.race = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    for (var i = 0; i < promises.length; i++) {\n      Constructor.resolve(promises[i]).then(resolve, reject);\n    }\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\nvar onPossiblyUnhandledRejection = function(reason, promise) {\n  throw reason;\n};\n\n/**\n * An internal use static function.\n */\nPromise._overrideUnhandledExceptionHandler = function(handler) {\n  onPossiblyUnhandledRejection = handler;\n};\n\n/****************************\n  Private functions\n ****************************/\n\n/**\n * The Fulfilled Promise state. Calls onFulfilled with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onFulfilled, returns the current promise to avoid an promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} value The current promise's resolved value.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} unused\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Fulfilled state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction FulfilledPromise(value, onFulfilled, unused, deferred) {\n  if (!onFulfilled) {\n    deferredAdopt(deferred, FulfilledPromise, value);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onFulfilled, value));\n  return deferred.promise;\n}\n\n/**\n * The Rejected Promise state. Calls onRejected with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onRejected, returns the current promise to avoid an promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} reason The current promise's rejection reason.\n * @param {function(*=)=} unused\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Rejected state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction RejectedPromise(reason, unused, onRejected, deferred) {\n  if (!onRejected) {\n    deferredAdopt(deferred, RejectedPromise, reason);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onRejected, reason));\n  return deferred.promise;\n}\n\n/**\n * The Pending Promise state. Eventually calls onFulfilled once the promise has\n * resolved, or onRejected once the promise rejects.\n *\n * If there is no onFulfilled and no onRejected, returns the current promise to\n * avoid an promise instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} queue The current promise's pending promises queue.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Pending state from the\n *     Pending state of another promise.\n * @returns {!Promise}\n */\nfunction PendingPromise(queue, onFulfilled, onRejected, deferred) {\n  if (!deferred) {\n    if (!onFulfilled && !onRejected) { return this; }\n    deferred = new Deferred(this.constructor);\n  }\n  queue.push({\n    deferred: deferred,\n    onFulfilled: onFulfilled || deferred.resolve,\n    onRejected: onRejected || deferred.reject\n  });\n  return deferred.promise;\n}\n\n/**\n * Constructs a deferred instance that holds a promise and its resolve and\n * reject functions.\n *\n * @constructor\n */\nfunction Deferred(Promise) {\n  var deferred = this;\n  /** @type {!Promise} */\n  this.promise = new Promise(function(resolve, reject) {\n    /** @type {function(*=)} */\n    deferred.resolve = resolve;\n\n    /** @type {function(*=)} */\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n\n/**\n * Transitions the state of promise to another state. This is only ever called\n * on with a promise that is currently in the Pending state.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction adopt(promise, state, value, adoptee) {\n  var queue = promise._value;\n  promise._state = state;\n  promise._value = value;\n\n  if (adoptee && state === PendingPromise) {\n    adoptee._state(value, void 0, void 0, {\n      promise: promise,\n      resolve: void 0,\n      reject: void 0\n    });\n  }\n\n  for (var i = 0; i < queue.length; i++) {\n    var next = queue[i];\n    promise._state(\n      value,\n      next.onFulfilled,\n      next.onRejected,\n      next.deferred\n    );\n  }\n  queue.length = 0;\n\n  // Determine if this rejected promise will be \"handled\".\n  if (state === RejectedPromise && promise._isChainEnd) {\n    setTimeout(function() {\n      if (promise._isChainEnd) {\n        onPossiblyUnhandledRejection(value, promise);\n      }\n    }, 0);\n  }\n}\n\n/**\n * A partial application of adopt.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @returns {function(*=)}\n */\nfunction adopter(promise, state) {\n  return function(value) {\n    adopt(promise, state, value);\n  };\n}\n\n/**\n * Updates a deferred promises state. Necessary for updating an adopting\n * promise's state when the adoptee resolves.\n *\n * @param {?Deferred} deferred\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction deferredAdopt(deferred, state, value) {\n  if (deferred) {\n    var promise = deferred.promise;\n    promise._state = state;\n    promise._value = value;\n  }\n}\n\n/**\n * A no-op function to prevent double resolving.\n */\nfunction noop() {}\n\n/**\n * Tests if fn is a Function\n *\n * @param {*} fn\n * @returns {boolean}\n */\nfunction isFunction(fn) {\n  return typeof fn === 'function';\n}\n\n/**\n * Tests if fn is an Object\n *\n * @param {*} obj\n * @returns {boolean}\n */\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n/**\n * Iterates over each element of an array, calling the iterator with the\n * element and its index.\n *\n * @param {!Array} collection\n * @param {function(*=,number)} iterator\n */\nfunction each(collection, iterator) {\n  for (var i = 0; i < collection.length; i++) {\n    iterator(collection[i], i);\n  }\n}\n\n/**\n * Creates a function that will attempt to resolve the deferred with the return\n * of fn. If any error is raised, rejects instead.\n *\n * @param {!Deferred} deferred\n * @param {function(*=)} fn\n * @param {*} arg\n * @returns {function()}\n */\nfunction tryCatchDeferred(deferred, fn, arg) {\n  var promise = deferred.promise;\n  var resolve = deferred.resolve;\n  var reject = deferred.reject;\n  return function() {\n    try {\n      var result = fn(arg);\n      doResolve(promise, resolve, reject, result, result);\n    } catch (e) {\n      reject(e);\n    }\n  };\n}\n\n/**\n * Queues and executes multiple deferred functions on another run loop.\n */\nvar defer = (function() {\n  /**\n   * Defers fn to another run loop.\n   */\n  var scheduleFlush;\n  if (typeof window !== 'undefined' && window.postMessage) {\n    window.addEventListener('message', flush);\n    scheduleFlush = function() {\n      window.postMessage('macro-task', '*');\n    };\n  } else {\n    scheduleFlush = function() {\n      setTimeout(flush, 0);\n    };\n  }\n\n  var queue = new Array(16);\n  var length = 0;\n\n  function flush() {\n    for (var i = 0; i < length; i++) {\n      var fn = queue[i];\n      queue[i] = null;\n      fn();\n    }\n    length = 0;\n  }\n\n  /**\n   * @param {function()} fn\n   */\n  function defer(fn) {\n    if (length === 0) { scheduleFlush(); }\n    queue[length++] = fn;\n  }\n\n  return defer;\n})();\n\n/**\n * The Promise resolution procedure.\n * https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n *\n * @param {!Promise} promise\n * @param {function(*=)} resolve\n * @param {function(*=)} reject\n * @param {*} value\n * @param {*=} context\n */\nfunction doResolve(promise, resolve, reject, value, context) {\n  var _reject = reject;\n  var then;\n  var _resolve;\n  try {\n    if (value === promise) {\n      throw new TypeError('Cannot fulfill promise with itself');\n    }\n    var isObj = isObject(value);\n    if (isObj && value instanceof promise.constructor) {\n      adopt(promise, value._state, value._value, value);\n    } else if (isObj && (then = value.then) && isFunction(then)) {\n      _resolve = function(value) {\n        _resolve = _reject = noop;\n        doResolve(promise, resolve, reject, value, value);\n      };\n      _reject = function(reason) {\n        _resolve = _reject = noop;\n        reject(reason);\n      };\n      then.call(\n        context,\n        function(value) { _resolve(value); },\n        function(reason) { _reject(reason); }\n      );\n    } else {\n      resolve(value);\n    }\n  } catch (e) {\n    _reject(e);\n  }\n}\n\nmodule.exports = Promise;\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {internalListenImplementation} from './event-helper-listen';\nimport {parseJson} from './json';\n\n\n/** @const */\nconst AMP_MESSAGE_PREFIX = 'amp-';\nexport const CONSTANTS = {\n  responseTypeSuffix: '-result',\n  messageIdFieldName: 'messageId',\n  payloadFieldName: 'payload',\n  contentFieldName: 'content',\n};\n\n/** @enum {string} */\nexport const MessageType = {\n  // For amp-ad\n  SEND_EMBED_STATE: 'send-embed-state',\n  EMBED_STATE: 'embed-state',\n  SEND_EMBED_CONTEXT: 'send-embed-context',\n  EMBED_CONTEXT: 'embed-context',\n  SEND_INTERSECTIONS: 'send-intersections',\n  INTERSECTION: 'intersection',\n  EMBED_SIZE: 'embed-size',\n  EMBED_SIZE_CHANGED: 'embed-size-changed',\n  EMBED_SIZE_DENIED: 'embed-size-denied',\n  NO_CONTENT: 'no-content',\n  GET_HTML: 'get-html',\n  GET_CONSENT_STATE: 'get-consent-state',\n\n  // For the frame to be placed in full overlay mode for lightboxes\n  FULL_OVERLAY_FRAME: 'full-overlay-frame',\n  FULL_OVERLAY_FRAME_RESPONSE: 'full-overlay-frame-response',\n  CANCEL_FULL_OVERLAY_FRAME: 'cancel-full-overlay-frame',\n  CANCEL_FULL_OVERLAY_FRAME_RESPONSE: 'cancel-full-overlay-frame-response',\n\n  // For amp-inabox\n  SEND_POSITIONS: 'send-positions',\n  POSITION: 'position',\n\n  // For amp-analytics' iframe-transport\n  SEND_IFRAME_TRANSPORT_EVENTS: 'send-iframe-transport-events',\n  IFRAME_TRANSPORT_EVENTS: 'iframe-transport-events',\n  IFRAME_TRANSPORT_RESPONSE: 'iframe-transport-response',\n\n  // For user-error-in-iframe\n  USER_ERROR_IN_IFRAME: 'user-error-in-iframe',\n};\n\n/**\n * Listens for the specified event on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listen(element, eventType, listener, opt_evtListenerOpts) {\n  return internalListenImplementation(\n      element, eventType, listener, opt_evtListenerOpts);\n}\n\n\n/**\n * Serialize an AMP post message. Output looks like:\n * 'amp-011481323099490{\"type\":\"position\",\"sentinel\":\"12345\",\"foo\":\"bar\"}'\n * @param {string} type\n * @param {string} sentinel\n * @param {JsonObject=} data\n * @param {?string=} rtvVersion\n * @return {string}\n */\nexport function serializeMessage(type, sentinel, data = dict(),\n  rtvVersion = null) {\n  // TODO: consider wrap the data in a \"data\" field. { type, sentinal, data }\n  const message = data;\n  message['type'] = type;\n  message['sentinel'] = sentinel;\n  return AMP_MESSAGE_PREFIX + (rtvVersion || '') + JSON.stringify(message);\n}\n\n\n/**\n * Deserialize an AMP post message.\n * Returns null if it's not valid AMP message format.\n *\n * @param {*} message\n * @return {?JsonObject|undefined}\n */\nexport function deserializeMessage(message) {\n  if (!isAmpMessage(message)) {\n    return null;\n  }\n  const startPos = message.indexOf('{');\n  dev().assert(startPos != -1, 'JSON missing in %s', message);\n  try {\n    return parseJson(message.substr(startPos));\n  } catch (e) {\n    dev().error('MESSAGING', 'Failed to parse message: ' + message, e);\n    return null;\n  }\n}\n\n\n/**\n *  Returns true if message looks like it is an AMP postMessage\n *  @param {*} message\n *  @return {boolean}\n */\nexport function isAmpMessage(message) {\n  return (typeof message == 'string' &&\n      message.indexOf(AMP_MESSAGE_PREFIX) == 0 &&\n      message.indexOf('{') != -1);\n}\n\n/** @typedef {{creativeId: string, message: string}} */\nexport let IframeTransportEvent;\n// An event, and the transport ID of the amp-analytics tags that\n// generated it. For instance if the creative with transport\n// ID 2 sends \"hi\", then an IframeTransportEvent would look like:\n// { creativeId: \"2\", message: \"hi\" }\n// If the creative with transport ID 2 sent that, and also sent \"hello\",\n// and the creative with transport ID 3 sends \"goodbye\" then an *array* of 3\n// AmpAnalyticsIframeTransportEvent would be sent to the 3p frame like so:\n// [\n//   { creativeId: \"2\", message: \"hi\" }, // An AmpAnalyticsIframeTransportEvent\n//   { creativeId: \"2\", message: \"hello\" }, // Another\n//   { creativeId: \"3\", message: \"goodbye\" } // And another\n// ]\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {assertHttpsUrl, parseUrlDeprecated} from './url';\nimport {dev, user} from './log';\nimport {dict} from './utils/object';\nimport {getContextMetadata} from '../src/iframe-attributes';\nimport {getMode} from './mode';\nimport {isExperimentOn} from './experiments';\nimport {setStyle} from './style';\nimport {startsWith} from './string';\nimport {tryParseJson} from './json';\nimport {urls} from './config';\n\n/** @type {!Object<string,number>} Number of 3p frames on the for that type. */\nlet count = {};\n\n/** @type {string} */\nlet overrideBootstrapBaseUrl;\n\n/** @const {string} */\nconst TAG = '3p-frame';\n\n/**\n * Produces the attributes for the ad template.\n * @param {!Window} parentWindow\n * @param {!AmpElement} element\n * @param {string=} opt_type\n * @param {Object=} opt_context\n * @return {!JsonObject} Contains\n *     - type, width, height, src attributes of <amp-ad> tag. These have\n *       precedence over the data- attributes.\n *     - data-* attributes of the <amp-ad> tag with the \"data-\" removed.\n *     - A _context object for internal use.\n */\nfunction getFrameAttributes(parentWindow, element, opt_type, opt_context) {\n  const type = opt_type || element.getAttribute('type');\n  user().assert(type, 'Attribute type required for <amp-ad>: %s', element);\n  const sentinel = generateSentinel(parentWindow);\n  let attributes = dict();\n  // Do these first, as the other attributes have precedence.\n  addDataAndJsonAttributes_(element, attributes);\n  attributes = getContextMetadata(parentWindow, element, sentinel,\n      attributes);\n  attributes['type'] = type;\n  Object.assign(attributes['_context'], opt_context);\n  return attributes;\n}\n\n/**\n * Creates the iframe for the embed. Applies correct size and passes the embed\n * attributes to the frame via JSON inside the fragment.\n * @param {!Window} parentWindow\n * @param {!AmpElement} parentElement\n * @param {string=} opt_type\n * @param {Object=} opt_context\n * @param {!{\n *   disallowCustom,\n *   allowFullscreen,\n * }=} opt_options Options for the created iframe.\n * @return {!Element} The iframe.\n */\nexport function getIframe(\n  parentWindow, parentElement, opt_type, opt_context,\n  {disallowCustom, allowFullscreen} = {}) {\n  // Check that the parentElement is already in DOM. This code uses a new and\n  // fast `isConnected` API and thus only used when it's available.\n  dev().assert(\n      parentElement['isConnected'] === undefined ||\n      parentElement['isConnected'] === true,\n      'Parent element must be in DOM');\n  const attributes =\n      getFrameAttributes(parentWindow, parentElement, opt_type, opt_context);\n  const iframe = parentWindow.document.createElement('iframe');\n\n  if (!count[attributes['type']]) {\n    count[attributes['type']] = 0;\n  }\n  count[attributes['type']] += 1;\n\n  const baseUrl = getBootstrapBaseUrl(\n      parentWindow, undefined, opt_type, disallowCustom);\n  const host = parseUrlDeprecated(baseUrl).hostname;\n  // This name attribute may be overwritten if this frame is chosen to\n  // be the master frame. That is ok, as we will read the name off\n  // for our uses before that would occur.\n  // @see https://github.com/ampproject/amphtml/blob/master/3p/integration.js\n  const name = JSON.stringify(dict({\n    'host': host,\n    'type': attributes['type'],\n    // https://github.com/ampproject/amphtml/pull/2955\n    'count': count[attributes['type']],\n    'attributes': attributes,\n  }));\n\n  iframe.src = baseUrl;\n  iframe.ampLocation = parseUrlDeprecated(baseUrl);\n  iframe.name = name;\n  // Add the check before assigning to prevent IE throw Invalid argument error\n  if (attributes['width']) {\n    iframe.width = attributes['width'];\n  }\n  if (attributes['height']) {\n    iframe.height = attributes['height'];\n  }\n  if (attributes['title']) {\n    iframe.title = attributes['title'];\n  }\n  if (allowFullscreen) {\n    iframe.setAttribute('allowfullscreen', 'true');\n  }\n  iframe.setAttribute('scrolling', 'no');\n  setStyle(iframe, 'border', 'none');\n  /** @this {!Element} */\n  iframe.onload = function() {\n    // Chrome does not reflect the iframe readystate.\n    this.readyState = 'complete';\n  };\n  if (isExperimentOn(parentWindow, 'no-sync-xhr-in-ads')) {\n    // Block synchronous XHR in ad. These are very rare, but super bad for UX\n    // as they block the UI thread for the arbitrary amount of time until the\n    // request completes.\n    iframe.setAttribute('allow', 'sync-xhr \\'none\\';');\n  }\n  iframe.setAttribute('data-amp-3p-sentinel',\n      attributes['_context']['sentinel']);\n  return iframe;\n}\n\n/**\n * Copies data- attributes from the element into the attributes object.\n * Removes the data- from the name and capitalizes after -. If there\n * is an attribute called json, parses the JSON and adds it to the\n * attributes.\n * @param {!Element} element\n * @param {!JsonObject} attributes The destination.\n * visibleForTesting\n */\nexport function addDataAndJsonAttributes_(element, attributes) {\n  const {dataset} = element;\n  for (const name in dataset) {\n    // data-vars- is reserved for amp-analytics\n    // see https://github.com/ampproject/amphtml/blob/master/extensions/amp-analytics/analytics-vars.md#variables-as-data-attribute\n    if (!startsWith(name, 'vars')) {\n      attributes[name] = dataset[name];\n    }\n  }\n  const json = element.getAttribute('json');\n  if (json) {\n    const obj = tryParseJson(json);\n    if (obj === undefined) {\n      throw user().createError(\n          'Error parsing JSON in json attribute in element %s',\n          element);\n    }\n    for (const key in obj) {\n      attributes[key] = obj[key];\n    }\n  }\n}\n\n/**\n * Preloads URLs related to the bootstrap iframe.\n * @param {!Window} win\n * @param {!./preconnect.Preconnect} preconnect\n * @param {string=} opt_type\n * @param {boolean=} opt_disallowCustom whether 3p url should not use meta tag.\n */\nexport function preloadBootstrap(\n  win, preconnect, opt_type, opt_disallowCustom) {\n  const url = getBootstrapBaseUrl(win, undefined, opt_type, opt_disallowCustom);\n  preconnect.preload(url, 'document');\n\n  // While the URL may point to a custom domain, this URL will always be\n  // fetched by it.\n  const scriptUrl = getMode().localDev\n    ? getAdsLocalhost(win) + '/dist.3p/current/integration.js'\n    : `${urls.thirdParty}/$internalRuntimeVersion$/f.js`;\n  preconnect.preload(scriptUrl, 'script');\n}\n\n/**\n * Returns the base URL for 3p bootstrap iframes.\n * @param {!Window} parentWindow\n * @param {boolean=} opt_strictForUnitTest\n * @param {string=} opt_type\n * @param {boolean=} opt_disallowCustom whether 3p url should not use meta tag.\n * @return {string}\n * @visibleForTesting\n */\nexport function getBootstrapBaseUrl(\n  parentWindow, opt_strictForUnitTest, opt_type, opt_disallowCustom) {\n  // The value is cached in a global variable called `bootstrapBaseUrl`;\n  const {bootstrapBaseUrl} = parentWindow;\n  if (bootstrapBaseUrl) {\n    return bootstrapBaseUrl;\n  }\n  return parentWindow.bootstrapBaseUrl = getCustomBootstrapBaseUrl(\n      parentWindow, opt_strictForUnitTest, opt_type, opt_disallowCustom) ||\n      getDefaultBootstrapBaseUrl(parentWindow);\n}\n\n/**\n * @param {string} url\n */\nexport function setDefaultBootstrapBaseUrlForTesting(url) {\n  overrideBootstrapBaseUrl = url;\n}\n\n/**\n * @param {*} win\n */\nexport function resetBootstrapBaseUrlForTesting(win) {\n  win.bootstrapBaseUrl = undefined;\n  win.defaultBootstrapSubDomain = undefined;\n}\n\n/**\n * Returns the default base URL for 3p bootstrap iframes.\n * @param {!Window} parentWindow\n * @param {string=} opt_srcFileBasename\n * @return {string}\n */\nexport function getDefaultBootstrapBaseUrl(parentWindow, opt_srcFileBasename) {\n  const srcFileBasename = opt_srcFileBasename || 'frame';\n  if (getMode().localDev || getMode().test) {\n    return overrideBootstrapBaseUrl || getAdsLocalhost(parentWindow)\n          + '/dist.3p/'\n          + (getMode().minified ? `$internalRuntimeVersion$/${srcFileBasename}`\n            : `current/${srcFileBasename}.max`)\n          + '.html';\n  }\n  // Ensure same sub-domain is used despite potentially different file.\n  parentWindow.defaultBootstrapSubDomain =\n      parentWindow.defaultBootstrapSubDomain || getSubDomain(parentWindow);\n  return 'https://' + parentWindow.defaultBootstrapSubDomain +\n      `.${urls.thirdPartyFrameHost}/$internalRuntimeVersion$/` +\n      `${srcFileBasename}.html`;\n}\n\n/**\n * @param {!Window} win\n * @return {string}\n */\nfunction getAdsLocalhost(win) {\n  let adsUrl = urls.thirdParty; // local dev with a non-localhost server\n  if (adsUrl.indexOf('ampproject.net') > -1) {\n    adsUrl = 'http://ads.localhost'; // local dev with a localhost server\n  }\n  return adsUrl + ':' + (win.location.port || win.parent.location.port);\n}\n\n/**\n * Sub domain on which the 3p iframe will be hosted.\n * Because we only calculate the URL once per page, this function is only\n * called once and hence all frames on a page use the same URL.\n * @param {!Window} win\n * @return {string}\n * @visibleForTesting\n */\nexport function getSubDomain(win) {\n  return 'd-' + getRandom(win);\n}\n\n/**\n * Generates a random non-negative integer.\n * @param {!Window} win\n * @return {string}\n */\nexport function getRandom(win) {\n  let rand;\n  if (win.crypto && win.crypto.getRandomValues) {\n    // By default use 2 32 bit integers.\n    const uint32array = new Uint32Array(2);\n    win.crypto.getRandomValues(uint32array);\n    rand = String(uint32array[0]) + uint32array[1];\n  } else {\n    // Fall back to Math.random.\n    rand = String(win.Math.random()).substr(2) + '0';\n  }\n  return rand;\n}\n\n/**\n * Returns the custom base URL for 3p bootstrap iframes if it exists.\n * Otherwise null.\n * @param {!Window} parentWindow\n * @param {boolean=} opt_strictForUnitTest\n * @param {string=} opt_type\n * @param {boolean=} opt_disallowCustom whether 3p url should not use meta tag.\n * @return {?string}\n */\nfunction getCustomBootstrapBaseUrl(\n  parentWindow, opt_strictForUnitTest, opt_type, opt_disallowCustom) {\n  const meta = parentWindow.document\n      .querySelector('meta[name=\"amp-3p-iframe-src\"]');\n  if (!meta) {\n    return null;\n  }\n  if (opt_disallowCustom) {\n    user().error(TAG, `3p iframe url disabled for ${opt_type || 'unknown'}`);\n    return null;\n  }\n  const url = assertHttpsUrl(meta.getAttribute('content'), meta);\n  user().assert(url.indexOf('?') == -1,\n      '3p iframe url must not include query string %s in element %s.',\n      url, meta);\n  // This is not a security primitive, we just don't want this to happen in\n  // practice. People could still redirect to the same origin, but they cannot\n  // redirect to the proxy origin which is the important one.\n  const parsed = parseUrlDeprecated(url);\n  user().assert((parsed.hostname == 'localhost' && !opt_strictForUnitTest) ||\n      parsed.origin != parseUrlDeprecated(parentWindow.location.href).origin,\n  '3p iframe url must not be on the same origin as the current document ' +\n      '%s (%s) in element %s. See https://github.com/ampproject/amphtml' +\n      '/blob/master/spec/amp-iframe-origin-policy.md for details.', url,\n  parsed.origin, meta);\n  return url + '?$internalRuntimeVersion$';\n}\n\n/**\n * Returns a randomized sentinel value for 3p iframes.\n * The format is \"%d-%d\" with the first value being the depth of current\n * window in the window hierarchy and the second a random integer.\n * @param {!Window} parentWindow\n * @return {string}\n * @visibleForTesting\n */\nexport function generateSentinel(parentWindow) {\n  let windowDepth = 0;\n  for (let win = parentWindow; win && win != win.parent; win = win.parent) {\n    windowDepth++;\n  }\n  return String(windowDepth) + '-' + getRandom(parentWindow);\n}\n\n/**\n * Resets the count of each 3p frame type\n * @visibleForTesting\n */\nexport function resetCountForTesting() {\n  count = {};\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from './services';\nimport {adConfig} from '../ads/_config';\nimport {dev} from '../src/log';\n\n/**\n * @param {AMP.BaseElement} adElement\n * @return {!Promise<string|undefined>} A promise for a CID or undefined if\n *     - the ad network does not request one or\n *     - `amp-analytics` which provides the CID service was not installed.\n */\nexport function getAdCid(adElement) {\n  const config = adConfig[adElement.element.getAttribute('type')];\n  if (!config || !config.clientIdScope) {\n    return Promise.resolve();\n  }\n  return getOrCreateAdCid(adElement.getAmpDoc(), config.clientIdScope,\n      config.clientIdCookieName);\n}\n\n/**\n * @param {!./service/ampdoc-impl.AmpDoc} ampDoc\n * @param {string} clientIdScope\n * @param {string=} opt_clientIdCookieName\n * @param {number=} opt_timeout\n * @return {!Promise<string|undefined>} A promise for a CID or undefined.\n */\nexport function getOrCreateAdCid(\n  ampDoc, clientIdScope, opt_clientIdCookieName, opt_timeout) {\n  const timeout = isNaN(opt_timeout) || opt_timeout == null ?\n    1000 : opt_timeout;\n  const cidPromise = Services.cidForDoc(ampDoc).then(cidService => {\n    if (!cidService) {\n      return;\n    }\n    return cidService.get({\n      scope: dev().assertString(clientIdScope),\n      createCookieIfNotPresent: true,\n      cookieName: opt_clientIdCookieName,\n    }, Promise.resolve(undefined)).catch(error => {\n      // Not getting a CID is not fatal.\n      dev().error('AD-CID', error);\n      return undefined;\n    });\n  });\n  // The CID should never be crucial for an ad. If it does not come within\n  // 1 second, assume it will never arrive.\n  return Services.timerFor(ampDoc.win)\n      .timeoutPromise(timeout, cidPromise, 'cid timeout').catch(error => {\n        // Timeout is not fatal.\n        dev().warn('AD-CID', error);\n        return undefined;\n      });\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {computedStyle} from './style';\nimport {dev} from './log';\nimport {getParentWindowFrameElement} from './service';\n\nconst AD_CONTAINER_PROP = '__AMP__AD_CONTAINER';\n\n/**\n * Tags that are allowed to have fixed positioning\n * @const {!Object<string, boolean>}\n */\nconst CONTAINERS = {\n  'AMP-FX-FLYING-CARPET': true,\n  'AMP-LIGHTBOX': true,\n  'AMP-STICKY-AD': true,\n  'AMP-LIGHTBOX-GALLERY': true,\n};\n\n/**\n * Determines if an element is fixed-positioned.\n * OK to use, because it's only called from onLayoutMeasure\n * @param {!Element} el\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isPositionFixed(el, win) {\n  const {position} = computedStyle(win, el);\n  // We consider sticky positions as fixed, since they can be fixed.\n  return position == 'fixed' || position == 'sticky';\n}\n\n/**\n * @param {!Element} element\n * @param {!Window} win\n * @return {boolean} whether the element position is allowed. If the element\n * belongs to CONTAINERS, it is allowed to be position fixed.\n * If the element has a position fixed ancestor, it is not allowed.\n * This should only be called when a layout on the page was just forced\n * anyway.\n */\nexport function isAdPositionAllowed(element, win) {\n  let hasFixedAncestor = false;\n  let containers = 0;\n  let el = element;\n  do {\n    if (CONTAINERS[el.tagName]) {\n      // The containers must not themselves be contained in a fixed-position\n      // element. Continue the search.\n      containers++;\n      hasFixedAncestor = false;\n    } else if (isPositionFixed(dev().assertElement(el), win)) {\n      // Because certain blessed elements may contain a position fixed\n      // container (which contain an ad), we continue to search the\n      // ancestry tree.\n      hasFixedAncestor = true;\n    }\n    el = el.parentElement;\n  } while (el && el.tagName != 'BODY');\n  return !hasFixedAncestor && containers <= 1;\n}\n\n/**\n * Returns the blessed container element tagName if the ad is contained by one.\n * This is called during layout measure.\n * @param {!Element} element\n * @return {?string}\n */\nexport function getAdContainer(element) {\n  if (element[AD_CONTAINER_PROP] === undefined) {\n    let el = element.parentElement;\n    while (el && el.tagName != 'BODY') {\n      if (CONTAINERS[el.tagName]) {\n        return element[AD_CONTAINER_PROP] = el.tagName;\n      }\n      el = el.parentElement;\n    }\n    element[AD_CONTAINER_PROP] = null;\n  }\n  return element[AD_CONTAINER_PROP];\n}\n\n/**\n * Gets the resource ID of the amp-ad element containing the passed node.\n * If there is no containing amp-ad tag, then null will be returned.\n * TODO(jonkeller): Investigate whether non-A4A use case is needed. Issue 11436\n * @param {!Element} node\n * @param {!Window} topWin\n * @return {?string}\n */\nexport function getAmpAdResourceId(node, topWin) {\n  try {\n    const frameParent = getParentWindowFrameElement(node, topWin).parentElement;\n    if (frameParent.nodeName == 'AMP-AD') {\n      return String(frameParent.getResourceId());\n    }\n  } catch (e) {\n  }\n  // Whether we entered the catch above (e.g. due to attempt to access\n  // across xdomain boundary), or failed to enter the if further above, the\n  // node is not within a friendly amp-ad tag. So, there is no amp-ad\n  // resource ID. How to handle that is up to the caller, but see TODO above.\n  return null;\n}\n\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Common AMP events.\n * @enum {string}\n */\nexport const AmpEvents = {\n  BUILT: 'amp:built',\n  DOM_UPDATE: 'amp:dom-update',\n  VISIBILITY_CHANGE: 'amp:visibilitychange', // https://github.com/ampproject/amphtml/blob/master/ads/README.md#page-visibility\n  // The following codes are only used for testing.\n  // TODO(choumx): Move these to a separate enum so they can be DCE'd.\n  ATTACHED: 'amp:attached',\n  STUBBED: 'amp:stubbed',\n  LOAD_START: 'amp:load:start',\n  LOAD_END: 'amp:load:end',\n  ERROR: 'amp:error',\n};\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from './services';\n\n/**\n * Helper method to trigger analytics event if amp-analytics is available.\n * TODO: Do not expose this function\n * @param {!Element} target\n * @param {string} eventType\n * @param {!Object<string, string>=} opt_vars A map of vars and their values.\n */\nexport function triggerAnalyticsEvent(target, eventType, opt_vars) {\n  Services.analyticsForDocOrNull(target).then(analytics => {\n    if (!analytics) {\n      return;\n    }\n    analytics.triggerEventForTarget(target, eventType, opt_vars);\n  });\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Commonly used signals across different elements and documents.\n * @enum {string}\n */\nexport const CommonSignals = {\n\n  /**\n   * The element has been built.\n   */\n  BUILT: 'built',\n\n  /**\n   * The initial contents of an element/document/embed have been loaded.\n   */\n  INI_LOAD: 'ini-load',\n\n  /**\n   * The element has been loaded.\n   */\n  LOAD_END: 'load-end',\n\n  /**\n   * The element has started loading.\n   */\n  LOAD_START: 'load-start',\n\n  /**\n   * Rendering has been confirmed to have been started.\n   */\n  RENDER_START: 'render-start',\n\n  /**\n   * The element has been unlaid out.\n   */\n  UNLOAD: 'unload',\n};\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Allows for runtime configuration. Internally, the runtime should\n * use the src/config.js module for various constants. We can use the\n * AMP_CONFIG global to translate user-defined configurations to this\n * module.\n * @type {!Object<string, string>}\n */\nconst env = self.AMP_CONFIG || {};\n\nconst thirdPartyFrameRegex = typeof env['thirdPartyFrameRegex'] == 'string' ?\n  new RegExp(env['thirdPartyFrameRegex']) : env['thirdPartyFrameRegex'];\n\nconst cdnProxyRegex = typeof env['cdnProxyRegex'] == 'string' ?\n  new RegExp(env['cdnProxyRegex']) : env['cdnProxyRegex'];\n\n/** @type {!Object<string, string|boolean|RegExp>} */\nexport const urls = {\n  thirdParty: env['thirdPartyUrl'] || 'https://3p.ampproject.net',\n  thirdPartyFrameHost: env['thirdPartyFrameHost'] || 'ampproject.net',\n  thirdPartyFrameRegex: thirdPartyFrameRegex || /^d-\\d+\\.ampproject\\.net$/,\n  cdn: env['cdnUrl'] || 'https://cdn.ampproject.org',\n  /* Note that cdnProxyRegex is only ever checked against origins\n   * (proto://host[:port]) so does not need to consider path\n   */\n  cdnProxyRegex: cdnProxyRegex ||\n      /^https:\\/\\/([a-zA-Z0-9_-]+\\.)?cdn\\.ampproject\\.org$/,\n  localhostRegex: /^https?:\\/\\/localhost(:\\d+)?$/,\n  errorReporting: env['errorReportingUrl'] ||\n      'https://amp-error-reporting.appspot.com/r',\n  localDev: env['localDev'] || false,\n};\n\nexport const config = {\n  urls,\n};\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// This file will be imported by 3P scripts.\n\n/**\n * Possible consent policy state to proceed with.\n * @enum {number}\n */\nexport const CONSENT_POLICY_STATE = {\n  // Enum value has external dependency. Please do not change existing value.\n  // If new values are added, please notify the AMP for Ads team to assure\n  // correct Real Time Config behavior is maintained for Fast Fetch.\n  SUFFICIENT: 1,\n  INSUFFICIENT: 2,\n  UNKNOWN_NOT_REQUIRED: 3,\n  UNKNOWN: 4,\n};\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  CONSENT_POLICY_STATE, // eslint-disable-line no-unused-vars\n} from './consent-state';\nimport {Services} from './services';\n\n/**\n * Returns a promise that resolve when all consent state the policy wait\n * for resolve. Or if consent service is not available.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n * @param {string} policyId\n * @return {!Promise<?CONSENT_POLICY_STATE>}\n */\nexport function getConsentPolicyState(ampdoc, policyId) {\n  return Services.consentPolicyServiceForDocOrNull(ampdoc)\n      .then(consentPolicy => {\n        if (!consentPolicy) {\n          return null;\n        }\n        return consentPolicy.whenPolicyResolved(\n            /** @type {string} */ (policyId));\n      });\n}\n\n/**\n * Returns a promise that resolves to a sharedData retrieved from consent\n * remote endpoint.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n * @param {string} policyId\n * @return {!Promise<?Object>}\n */\nexport function getConsentPolicySharedData(ampdoc, policyId) {\n  return Services.consentPolicyServiceForDocOrNull(ampdoc)\n      .then(consentPolicy => {\n        if (!consentPolicy) {\n          return null;\n        }\n        return consentPolicy.getMergedSharedData(\n            /** @type {string} */ (policyId));\n      });\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {endsWith} from './string';\nimport {\n  isProxyOrigin,\n  parseUrlDeprecated,\n  tryDecodeUriComponent,\n} from './url';\nimport {urls} from './config';\n\n\n/**\n * Returns the value of the cookie. The cookie access is restricted and must\n * go through the privacy review. Before using this method please file a\n * GitHub issue with \"Privacy Review\" label.\n *\n * Returns the cookie's value or `null`.\n *\n * @param {!Window} win\n * @param {string} name\n * @return {?string}\n */\nexport function getCookie(win, name) {\n  const cookieString = tryGetDocumentCookieNoInline(win);\n  if (!cookieString) {\n    return null;\n  }\n  const cookies = cookieString.split(';');\n  for (let i = 0; i < cookies.length; i++) {\n    const cookie = cookies[i].trim();\n    const eq = cookie.indexOf('=');\n    if (eq == -1) {\n      continue;\n    }\n    if (tryDecodeUriComponent(cookie.substring(0, eq).trim()) == name) {\n      const value = cookie.substring(eq + 1).trim();\n      return tryDecodeUriComponent(value, value);\n    }\n  }\n  return null;\n}\n\n/**\n * This method should not be inlined to prevent TryCatch deoptimization.\n * NoInline keyword at the end of function name also prevents Closure compiler\n * from inlining the function.\n * @param {!Window} win\n * @return {string}\n */\nfunction tryGetDocumentCookieNoInline(win) {\n  try {\n    return win.document.cookie;\n  } catch (e) {\n    // Act as if no cookie is available. Exceptions can be thrown when\n    // AMP docs are opened on origins that do not allow setting\n    // cookies such as null origins.\n    return '';\n  }\n}\n\n/**\n * Sets the value of the cookie. The cookie access is restricted and must\n * go through the privacy review. Before using this method please file a\n * GitHub issue with \"Privacy Review\" label.\n *\n * @param {!Window} win\n * @param {string} name\n * @param {string} value\n * @param {time} expirationTime\n * @param {{\n *   highestAvailableDomain:(boolean|undefined),\n *   domain:(string|undefined)\n * }=} opt_options\n *     - highestAvailableDomain: If true, set the cookie at the widest domain\n *       scope allowed by the browser. E.g. on example.com if we are currently\n *       on www.example.com.\n *     - domain: Explicit domain to set.\n *     - allowOnProxyOrigin: Allow setting a cookie on the AMP Cache.\n */\nexport function setCookie(win, name, value, expirationTime, opt_options) {\n  checkOriginForSettingCookie(win, opt_options, name);\n  if (opt_options && opt_options.highestAvailableDomain) {\n    const parts = win.location.hostname.split('.');\n    let domain = parts[parts.length - 1];\n    for (let i = parts.length - 2; i >= 0; i--) {\n      domain = parts[i] + '.' + domain;\n      trySetCookie(win, name, value, expirationTime, domain);\n      if (getCookie(win, name) == value) {\n        return;\n      }\n    }\n  }\n  let domain = undefined;\n  if (opt_options && opt_options.domain) {\n    domain = opt_options.domain;\n  }\n  trySetCookie(win, name, value, expirationTime, domain);\n}\n\n/**\n * Attempt to set a cookie with the given params.\n *\n * @param {!Window} win\n * @param {string} name\n * @param {string} value\n * @param {time} expirationTime\n * @param {string|undefined} domain\n */\nfunction trySetCookie(win, name, value, expirationTime, domain) {\n  // We do not allow setting cookies on the domain that contains both\n  // the cdn. and www. hosts.\n  if (domain == 'ampproject.org') {\n    // Actively delete them.\n    value = 'delete';\n    expirationTime = 0;\n  }\n  const cookie = encodeURIComponent(name) + '=' +\n      encodeURIComponent(value) +\n      '; path=/' +\n      (domain ? '; domain=' + domain : '') +\n      '; expires=' + new Date(expirationTime).toUTCString();\n  try {\n    win.document.cookie = cookie;\n  } catch (ignore) {\n    // Do not throw if setting the cookie failed Exceptions can be thrown\n    // when AMP docs are opened on origins that do not allow setting\n    // cookies such as null origins.\n  }\n}\n\n/**\n * Throws if a given cookie should not be set on the given origin.\n * This is a defense-in-depth. Callers should never run into this.\n *\n * @param {!Window} win\n * @param {!Object|undefined} options\n * @param {string} name For the error message.\n */\nfunction checkOriginForSettingCookie(win, options, name) {\n  if (options && options.allowOnProxyOrigin) {\n    return;\n  }\n  if (isProxyOrigin(win.location.href)) {\n    throw new Error('Should never attempt to set cookie on proxy origin: '\n        + name);\n  }\n\n  const current = parseUrlDeprecated(win.location.href).hostname.toLowerCase();\n  const proxy = parseUrlDeprecated(urls.cdn).hostname.toLowerCase();\n  if (current == proxy || endsWith(current, '.' + proxy)) {\n    throw new Error('Should never attempt to set cookie on proxy origin.'\n        + ' (in depth check): ' + name);\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Whether the document is ready.\n * @param {!Document} doc\n * @return {boolean}\n */\nexport function isDocumentReady(doc) {\n  return doc.readyState != 'loading' && doc.readyState != 'uninitialized';\n}\n\n/**\n * Whether the document has loaded all the css and sub-resources.\n * @param {!Document} doc\n * @return {boolean}\n */\nfunction isDocumentComplete(doc) {\n  return doc.readyState == 'complete';\n}\n\n/**\n * Calls the callback when document is ready.\n * @param {!Document} doc\n * @param {function(!Document)} callback\n */\nexport function onDocumentReady(doc, callback) {\n  onDocumentState(doc, isDocumentReady, callback);\n}\n\n/**\n * Calls the callback when document's state satisfies the stateFn.\n * @param {!Document} doc\n * @param {function(!Document):boolean} stateFn\n * @param {function(!Document)} callback\n */\nfunction onDocumentState(doc, stateFn, callback) {\n  let ready = stateFn(doc);\n  if (ready) {\n    callback(doc);\n  } else {\n    const readyListener = () => {\n      if (stateFn(doc)) {\n        if (!ready) {\n          ready = true;\n          callback(doc);\n        }\n        doc.removeEventListener('readystatechange', readyListener);\n      }\n    };\n    doc.addEventListener('readystatechange', readyListener);\n  }\n}\n\n/**\n * Returns a promise that is resolved when document is ready.\n * @param {!Document} doc\n * @return {!Promise<!Document>}\n */\nexport function whenDocumentReady(doc) {\n  return new Promise(resolve => {\n    onDocumentReady(doc, resolve);\n  });\n}\n\n/**\n * Returns a promise that is resolved when document is complete.\n * @param {!Document} doc\n * @return {!Promise<!Document>}\n */\nexport function whenDocumentComplete(doc) {\n  return new Promise(resolve => {\n    onDocumentState(doc, isDocumentComplete, resolve);\n  });\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Deferred} from './utils/promise';\nimport {cssEscape} from '../third_party/css-escape/css-escape';\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {startsWith} from './string';\nimport {toWin} from './types';\n\nconst HTML_ESCAPE_CHARS = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;',\n};\nconst HTML_ESCAPE_REGEX = /(&|<|>|\"|'|`)/g;\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_PROMISE =\n    '__AMP_UPG_PRM';\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_RESOLVER =\n    '__AMP_UPG_RES';\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * callback is executed.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @param {function()} callback\n */\nexport function waitForChild(parent, checkFunc, callback) {\n  if (checkFunc(parent)) {\n    callback();\n    return;\n  }\n  /** @const {!Window} */\n  const win = toWin(parent.ownerDocument.defaultView);\n  if (win.MutationObserver) {\n    /** @const {MutationObserver} */\n    const observer = new win.MutationObserver(() => {\n      if (checkFunc(parent)) {\n        observer.disconnect();\n        callback();\n      }\n    });\n    observer.observe(parent, {childList: true});\n  } else {\n    /** @const {number} */\n    const interval = win.setInterval(() => {\n      if (checkFunc(parent)) {\n        win.clearInterval(interval);\n        callback();\n      }\n    }, /* milliseconds */ 5);\n  }\n}\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * promise is resolved.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @return {!Promise}\n */\nexport function waitForChildPromise(parent, checkFunc) {\n  return new Promise(resolve => {\n    waitForChild(parent, checkFunc, resolve);\n  });\n}\n\n/**\n * Waits for document's body to be available.\n * Will be deprecated soon; use {@link AmpDoc#whenBodyAvailable} or\n * @{link DocumentState#onBodyAvailable} instead.\n * @param {!Document} doc\n * @param {function()} callback\n */\nexport function waitForBody(doc, callback) {\n  waitForChild(doc.documentElement, () => !!doc.body, callback);\n}\n\n\n/**\n * Waits for document's body to be available.\n * @param {!Document} doc\n * @return {!Promise}\n */\nexport function waitForBodyPromise(doc) {\n  return new Promise(resolve => {\n    waitForBody(doc, resolve);\n  });\n}\n\n\n/**\n * Removes the element.\n * @param {!Element} element\n */\nexport function removeElement(element) {\n  if (element.parentElement) {\n    element.parentElement.removeChild(element);\n  }\n}\n\n\n/**\n * Removes all child nodes of the specified element.\n * @param {!Element} parent\n */\nexport function removeChildren(parent) {\n  while (parent.firstChild) {\n    parent.removeChild(parent.firstChild);\n  }\n}\n\n\n/**\n * Copies all children nodes of element \"from\" to element \"to\". Child nodes\n * are deeply cloned. Notice, that this method should be used with care and\n * preferably on smaller subtrees.\n * @param {!Element} from\n * @param {!Element|!DocumentFragment} to\n */\nexport function copyChildren(from, to) {\n  const frag = to.ownerDocument.createDocumentFragment();\n  for (let n = from.firstChild; n; n = n.nextSibling) {\n    frag.appendChild(n.cloneNode(true));\n  }\n  to.appendChild(frag);\n}\n\n/**\n * Insert the element in the root after the element named after or\n * if that is null at the beginning.\n * @param {!Element|!ShadowRoot} root\n * @param {!Element} element\n * @param {?Node} after\n */\nexport function insertAfterOrAtStart(root, element, after) {\n  const before = after ? after.nextSibling : root.firstChild;\n  root.insertBefore(element, before);\n}\n\n/**\n * Add attributes to an element.\n * @param {!Element} element\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function addAttributesToElement(element, attributes) {\n  for (const attr in attributes) {\n    element.setAttribute(attr, attributes[attr]);\n  }\n  return element;\n}\n\n/**\n * Create a new element on document with specified tagName and attributes.\n * @param {!Document} doc\n * @param {string} tagName\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function createElementWithAttributes(doc, tagName, attributes) {\n  const element = doc.createElement(tagName);\n  return addAttributesToElement(element, attributes);\n}\n\n/**\n * Returns true if node is connected (attached).\n * @param {!Node} node\n * @return {boolean}\n * @see https://dom.spec.whatwg.org/#connected\n */\nexport function isConnectedNode(node) {\n  const connected = node.isConnected;\n  if (connected !== undefined) {\n    return connected;\n  }\n\n  // \"An element is connected if its shadow-including root is a document.\"\n  let n = node;\n  do {\n    n = rootNodeFor(n);\n    if (n.host) {\n      n = n.host;\n    } else {\n      break;\n    }\n  } while (true);\n  return n.nodeType === Node.DOCUMENT_NODE;\n}\n\n/**\n * Returns the root for a given node. Does not cross shadow DOM boundary.\n * @param {!Node} node\n * @return {!Node}\n */\nexport function rootNodeFor(node) {\n  if (Node.prototype.getRootNode) {\n    // Type checker says `getRootNode` may return null.\n    return node.getRootNode() || node;\n  }\n  let n;\n  for (n = node; !!n.parentNode; n = n.parentNode) {}\n  return n;\n}\n\n/**\n * Finds the closest element that satisfies the callback from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {function(!Element):boolean} callback\n * @param {Element=} opt_stopAt optional elemnt to stop the search at.\n * @return {?Element}\n */\nexport function closest(element, callback, opt_stopAt) {\n  for (let el = element; el && el !== opt_stopAt; el = el.parentElement) {\n    if (callback(el)) {\n      return el;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest node that satisfies the callback from this node\n * up the DOM subtree.\n * @param {!Node} node\n * @param {function(!Node):boolean} callback\n * @return {?Node}\n */\nexport function closestNode(node, callback) {\n  for (let n = node; n; n = n.parentNode) {\n    if (callback(n)) {\n      return n;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest element with the specified name from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function closestByTag(element, tagName) {\n  if (element.closest) {\n    return element.closest(tagName);\n  }\n  tagName = tagName.toUpperCase();\n  return closest(element, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Finds the closest element with the specified selector from this element\n * @param {!Element} element\n * @param {string} selector\n * @return {?Element} closest ancestor if found.\n */\nexport function closestBySelector(element, selector) {\n  if (element.closest) {\n    return element.closest(selector);\n  }\n\n  return closest(element, el => {\n    return matches(el, selector);\n  });\n}\n\n/**\n * Checks if the given element matches the selector\n * @param  {!Element} el The element to verify\n * @param  {string} selector The selector to check against\n * @return {boolean} True if the element matched the selector. False otherwise.\n */\nexport function matches(el, selector) {\n  const matcher = el.matches ||\n      el.webkitMatchesSelector ||\n      el.mozMatchesSelector ||\n      el.msMatchesSelector ||\n      el.oMatchesSelector;\n  if (matcher) {\n    return matcher.call(el, selector);\n  }\n  return false; // IE8 always returns false.\n}\n\n/**\n * Finds the first descendant element with the specified name.\n * @param {!Element|!Document|!ShadowRoot} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function elementByTag(element, tagName) {\n  let elements;\n  // getElementsByTagName() is not supported on ShadowRoot.\n  if (typeof element.getElementsByTagName === 'function') {\n    elements = element.getElementsByTagName(tagName);\n  } else {\n    elements = element./*OK*/querySelectorAll(tagName);\n  }\n  return (elements && elements[0]) || null;\n}\n\n\n/**\n * Finds the first child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function childElement(parent, callback) {\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds all child elements that satisfy the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {!Array<!Element>}\n */\nexport function childElements(parent, callback) {\n  const children = [];\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      children.push(child);\n    }\n  }\n  return children;\n}\n\n\n/**\n * Finds the last child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function lastChildElement(parent, callback) {\n  for (let child = parent.lastElementChild; child;\n    child = child.previousElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n/**\n * Finds all child nodes that satisfy the callback.\n * These nodes can include Text, Comment and other child nodes.\n * @param {!Node} parent\n * @param {function(!Node):boolean} callback\n * @return {!Array<!Node>}\n */\nexport function childNodes(parent, callback) {\n  const nodes = [];\n  for (let child = parent.firstChild; child;\n    child = child.nextSibling) {\n    if (callback(child)) {\n      nodes.push(child);\n    }\n  }\n  return nodes;\n}\n\n/**\n * @type {boolean|undefined}\n * @visibleForTesting\n */\nlet scopeSelectorSupported;\n\n/**\n * @param {boolean|undefined} val\n * @visibleForTesting\n */\nexport function setScopeSelectorSupportedForTesting(val) {\n  scopeSelectorSupported = val;\n}\n\n/**\n * Test that the :scope selector is supported and behaves correctly.\n * @param {!Element} parent\n * @return {boolean}\n */\nfunction isScopeSelectorSupported(parent) {\n  const doc = parent.ownerDocument;\n  try {\n    const testElement = doc.createElement('div');\n    const testChild = doc.createElement('div');\n    testElement.appendChild(testChild);\n    // NOTE(cvializ, #12383): Firefox's implementation is incomplete,\n    // therefore we test actual functionality of`:scope` as well.\n    return testElement./*OK*/querySelector(':scope div') === testChild;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Finds the first child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function childElementByAttr(parent, attr) {\n  return scopedQuerySelector/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the last child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function lastChildElementByAttr(parent, attr) {\n  return lastChildElement(parent, el => {\n    return el.hasAttribute(attr);\n  });\n}\n\n\n/**\n * Finds all child elements that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByAttr(parent, attr) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the first child element that has the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {?Element}\n */\nexport function childElementByTag(parent, tagName) {\n  return scopedQuerySelector/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds all child elements with the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByTag(parent, tagName) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds the first element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {?Element}\n */\nexport function scopedQuerySelector(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelector(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const element = root./*OK*/querySelector(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return element;\n}\n\n\n/**\n * Finds the every element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {!NodeList<!Element>}\n */\nexport function scopedQuerySelectorAll(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelectorAll(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const elements = root./*OK*/querySelectorAll(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return elements;\n}\n\n\n/**\n * Returns element data-param- attributes as url parameters key-value pairs.\n * e.g. data-param-some-attr=value -> {someAttr: value}.\n * @param {!Element} element\n * @param {function(string):string=} opt_computeParamNameFunc to compute the\n *    parameter name, get passed the camel-case parameter name.\n * @param {!RegExp=} opt_paramPattern Regex pattern to match data attributes.\n * @return {!JsonObject}\n */\nexport function getDataParamsFromAttributes(element, opt_computeParamNameFunc,\n  opt_paramPattern) {\n  const computeParamNameFunc = opt_computeParamNameFunc || (key => key);\n  const {dataset} = element;\n  const params = dict();\n  const paramPattern = opt_paramPattern ? opt_paramPattern : /^param(.+)/;\n  for (const key in dataset) {\n    const matches = key.match(paramPattern);\n    if (matches) {\n      const param = matches[1][0].toLowerCase() + matches[1].substr(1);\n      params[computeParamNameFunc(param)] = dataset[key];\n    }\n  }\n  return params;\n}\n\n/**\n * Whether the element have a next node in the document order.\n * This means either:\n *  a. The element itself has a nextSibling.\n *  b. Any of the element ancestors has a nextSibling.\n * @param {!Element} element\n * @param {?Node} opt_stopNode\n * @return {boolean}\n */\nexport function hasNextNodeInDocumentOrder(element, opt_stopNode) {\n  let currentElement = element;\n  do {\n    if (currentElement.nextSibling) {\n      return true;\n    }\n  } while ((currentElement = currentElement.parentNode) &&\n            currentElement != opt_stopNode);\n  return false;\n}\n\n\n/**\n * Finds all ancestor elements that satisfy predicate.\n * @param {!Element} child\n * @param {function(!Element):boolean} predicate\n * @return {!Array<!Element>}\n */\nexport function ancestorElements(child, predicate) {\n  const ancestors = [];\n  for (let ancestor = child.parentElement; ancestor;\n    ancestor = ancestor.parentElement) {\n    if (predicate(ancestor)) {\n      ancestors.push(ancestor);\n    }\n  }\n  return ancestors;\n}\n\n\n/**\n * Finds all ancestor elements that has the specified tag name.\n * @param {!Element} child\n * @param {string} tagName\n * @return {!Array<!Element>}\n */\nexport function ancestorElementsByTag(child, tagName) {\n  tagName = tagName.toUpperCase();\n  return ancestorElements(child, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Returns a clone of the content of a template element.\n *\n * Polyfill to replace .content access for browsers that do not support\n * HTMLTemplateElements natively.\n *\n * @param {!HTMLTemplateElement|!Element} template\n * @return {!DocumentFragment}\n */\nexport function templateContentClone(template) {\n  if ('content' in template) {\n    return template.content.cloneNode(true);\n  } else {\n    const content = template.ownerDocument.createDocumentFragment();\n    copyChildren(template, content);\n    return content;\n  }\n}\n\n/**\n * Iterate over an array-like. Some collections like NodeList are\n * lazily evaluated in some browsers, and accessing `length` forces full\n * evaluation. We can improve performance by iterating until an element is\n * `undefined` to avoid checking the `length` property.\n * Test cases: https://jsperf.com/iterating-over-collections-of-elements\n * @param {!IArrayLike<T>} iterable\n * @param {function(T, number)} cb\n * @template T\n */\nexport function iterateCursor(iterable, cb) {\n  for (let i = 0, value; (value = iterable[i]) !== undefined; i++) {\n    cb(value, i);\n  }\n}\n\n/**\n * This method wraps around window's open method. It first tries to execute\n * `open` call with the provided target and if it fails, it retries the call\n * with the `_top` target. This is necessary given that in some embedding\n * scenarios, such as iOS' WKWebView, navigation to `_blank` and other targets\n * is blocked by default.\n *\n * @param {!Window} win\n * @param {string} url\n * @param {string} target\n * @param {string=} opt_features\n * @return {?Window}\n */\nexport function openWindowDialog(win, url, target, opt_features) {\n  // Try first with the specified target. If we're inside the WKWebView or\n  // a similar environments, this method is expected to fail by default for\n  // all targets except `_top`.\n  let res;\n  try {\n    res = win.open(url, target, opt_features);\n  } catch (e) {\n    dev().error('DOM', 'Failed to open url on target: ', target, e);\n  }\n\n  // Then try with `_top` target.\n  if (!res && target != '_top') {\n    res = win.open(url, '_top');\n  }\n  return res;\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n            element.getAttribute('type').toUpperCase() == 'APPLICATION/JSON';\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonLdScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n      element.getAttribute('type').toUpperCase() == 'APPLICATION/LD+JSON';\n}\n\n/**\n * Whether the page's direction is right to left or not.\n * @param {!Document} doc\n * @return {boolean}\n */\nexport function isRTL(doc) {\n  const dir = doc.body.getAttribute('dir')\n                 || doc.documentElement.getAttribute('dir')\n                 || 'ltr';\n  return dir == 'rtl';\n}\n\n\n/**\n * Escapes an ident (ID or a class name) to be used as a CSS selector.\n *\n * See https://drafts.csswg.org/cssom/#serialize-an-identifier.\n *\n * @param {string} ident\n * @return {string}\n */\nexport function escapeCssSelectorIdent(ident) {\n  return cssEscape(ident);\n}\n\n/**\n * Escapes an ident in a way that can be used by :nth-child() psuedo-class.\n *\n * See https://github.com/w3c/csswg-drafts/issues/2306.\n *\n * @param {string|number} ident\n * @return {string}\n */\nexport function escapeCssSelectorNth(ident) {\n  const escaped = String(ident);\n  // Ensure it doesn't close the nth-child psuedo class.\n  dev().assert(escaped.indexOf(')') === -1);\n  return escaped;\n}\n\n/**\n * Escapes `<`, `>` and other HTML charcaters with their escaped forms.\n * @param {string} text\n * @return {string}\n */\nexport function escapeHtml(text) {\n  if (!text) {\n    return text;\n  }\n  return text.replace(HTML_ESCAPE_REGEX, escapeHtmlChar);\n}\n\n/**\n * @param {string} c\n * @return {string}\n */\nfunction escapeHtmlChar(c) {\n  return HTML_ESCAPE_CHARS[c];\n}\n\n/**\n * Tries to focus on the given element; fails silently if browser throws an\n * exception.\n * @param {!Element} element\n */\nexport function tryFocus(element) {\n  try {\n    element./*OK*/focus();\n  } catch (e) {\n    // IE <= 7 may throw exceptions when focusing on hidden items.\n  }\n}\n\n/**\n * Whether the given window is in an iframe or not.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isIframed(win) {\n  return win.parent && win.parent != win;\n}\n\n/**\n * Determines if this element is an AMP element\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isAmpElement(element) {\n  const tag = element.tagName;\n  // Use prefix to recognize AMP element. This is necessary because stub\n  // may not be attached yet.\n  return startsWith(tag, 'AMP-') &&\n      // Some \"amp-*\" elements are not really AMP elements. :smh:\n      !(tag == 'AMP-STICKY-AD-TOP-PADDING' || tag == 'AMP-BODY');\n}\n\n/**\n * Return a promise that resolve when an AMP element upgrade from HTMLElement\n * to CustomElement\n * @param {!Element} element\n * @return {!Promise<!Element>}\n */\nexport function whenUpgradedToCustomElement(element) {\n  dev().assert(isAmpElement(element), 'element is not AmpElement');\n  if (element.createdCallback) {\n    // Element already is CustomElement;\n    return Promise.resolve(element);\n  }\n  // If Element is still HTMLElement, wait for it to upgrade to customElement\n  // Note: use pure string to avoid obfuscation between versions.\n  if (!element[UPGRADE_TO_CUSTOMELEMENT_PROMISE]) {\n    const deferred = new Deferred();\n    element[UPGRADE_TO_CUSTOMELEMENT_PROMISE] = deferred.promise;\n    element[UPGRADE_TO_CUSTOMELEMENT_RESOLVER] = deferred.resolve;\n\n  }\n\n  return element[UPGRADE_TO_CUSTOMELEMENT_PROMISE];\n}\n\n/**\n * Replacement for `Element.requestFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Element/requestFullscreen\n * @param {!Element} element\n */\nexport function fullscreenEnter(element) {\n  const requestFs = element.requestFullscreen\n   || element.requestFullScreen\n   || element.webkitRequestFullscreen\n   || element.webkitRequestFullScreen\n   || element.webkitEnterFullscreen\n   || element.webkitEnterFullScreen\n   || element.msRequestFullscreen\n   || element.msRequestFullScreen\n   || element.mozRequestFullscreen\n   || element.mozRequestFullScreen;\n  if (requestFs) {\n    requestFs.call(element);\n  }\n}\n\n/**\n * Replacement for `Document.exitFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/exitFullscreen\n * @param {!Element} element\n */\nexport function fullscreenExit(element) {\n  let exitFs = element.cancelFullScreen\n              || element.exitFullscreen\n              || element.exitFullScreen\n              || element.webkitExitFullscreen\n              || element.webkitExitFullScreen\n              || element.webkitCancelFullScreen\n              || element.mozCancelFullScreen\n              || element.msExitFullscreen;\n  if (exitFs) {\n    exitFs.call(element);\n    return;\n  }\n  if (element.ownerDocument) {\n    exitFs = element.ownerDocument.cancelFullScreen\n             || element.ownerDocument.exitFullscreen\n             || element.ownerDocument.exitFullScreen\n             || element.ownerDocument.webkitExitFullscreen\n             || element.ownerDocument.webkitExitFullScreen\n             || element.ownerDocument.webkitCancelFullScreen\n             || element.ownerDocument.mozCancelFullScreen\n             || element.ownerDocument.msExitFullscreen;\n  }\n  if (exitFs) {\n    exitFs.call(element.ownerDocument);\n    return;\n  }\n}\n\n\n/**\n * Replacement for `Document.fullscreenElement`.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/fullscreenElement\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isFullscreenElement(element) {\n  const isFullscreen = element.webkitDisplayingFullscreen;\n  if (isFullscreen) {\n    return true;\n  }\n  if (element.ownerDocument) {\n    const fullscreenElement = element.ownerDocument.fullscreenElement\n             || element.ownerDocument.webkitFullscreenElement\n             || element.ownerDocument.mozFullScreenElement\n             || element.webkitCurrentFullScreenElement;\n    if (fullscreenElement == element) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Returns true if node is not disabled.\n *\n * IE8 can return false positives, see {@link matches}.\n * @param {!Element} element\n * @return {boolean}\n * @see https://www.w3.org/TR/html5/forms.html#concept-fe-disabled\n */\nexport function isEnabled(element) {\n  return !(element.disabled || matches(element, ':disabled'));\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as dom from './dom';\nimport {\n  getAmpdoc,\n  getExistingServiceForDocInEmbedScope,\n  getService,\n  getServicePromise,\n  getServicePromiseForDoc,\n  getServicePromiseOrNull,\n  getServicePromiseOrNullForDoc,\n  getTopWindow,\n} from './service';\nimport {toWin} from './types';\nimport {user} from './log';\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. Services.viewportForDoc(...)) for type safety and because the\n * factory should not be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an element,\n *     not the extension.\n * @return {!Promise<*>}\n */\nexport function getElementService(win, id, extension, opt_element) {\n  return getElementServiceIfAvailable(win, id, extension, opt_element).then(\n      service => assertService(service, id, extension));\n}\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailable(win, id, extension, opt_element) {\n  const s = getServicePromiseOrNull(win, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n  return getElementServicePromiseOrNull(win, id, extension, opt_element);\n}\n\n/**\n * @param {!Window} win\n * @param {string} elementName Name of an extended custom element.\n * @return {boolean} Whether this element is scheduled to be loaded.\n */\nfunction isElementScheduled(win, elementName) {\n  // Set in custom-element.js\n  if (!win.ampExtendedElements) {\n    return false;\n  }\n  return !!win.ampExtendedElements[elementName];\n}\n\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. Services.viewportForDoc(...)) for type safety and because the\n * factory should not be passed around.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an element,\n *     not the extension.\n * @return {!Promise<*>}\n */\nexport function getElementServiceForDoc(elementOrAmpDoc, id, extension,\n  opt_element) {\n  return getElementServiceIfAvailableForDoc(\n      elementOrAmpDoc, id, extension, opt_element)\n      .then(service => assertService(service, id, extension));\n}\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDoc(\n  elementOrAmpDoc, id, extension, opt_element) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const s = getServicePromiseOrNullForDoc(elementOrAmpDoc, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n\n  return ampdoc.whenBodyAvailable()\n      .then(() => waitForExtensionIfPresent(\n          ampdoc.win, extension,\n          ampdoc.getHeadNode()))\n      .then(() => {\n        // If this service is provided by an element, then we can't depend on\n        // the service (they may not use the element).\n        if (opt_element) {\n          return getServicePromiseOrNullForDoc(elementOrAmpDoc, id);\n        } else if (isElementScheduled(ampdoc.win, extension)) {\n          return getServicePromiseForDoc(elementOrAmpDoc, id);\n        }\n        return null;\n      });\n}\n\n/**\n * Returns a promise for service for the given id in the embed scope of\n * a given node, if it exists. Otherwise, falls back to ampdoc scope IFF\n * the given node is in the top-level window.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom element that provides\n *     the implementation of this service.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDocInEmbedScope(\n  elementOrAmpDoc, id, extension) {\n  const s = getExistingServiceForDocInEmbedScope(elementOrAmpDoc, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (Promise.resolve(s));\n  }\n  // Return embed-scope element service promise if scheduled.\n  if (elementOrAmpDoc.nodeType) {\n    const win = toWin(elementOrAmpDoc.ownerDocument.defaultView);\n    const topWin = getTopWindow(win);\n    // In embeds, doc-scope services are window-scope. But make sure to\n    // only do this for embeds (not the top window), otherwise we'd grab\n    // a promise from the wrong service holder which would never resolve.\n    if (win !== topWin) {\n      return getElementServicePromiseOrNull(win, id, extension);\n    } else {\n      // Fallback to ampdoc IFF the given node is _not_ FIE.\n      return getElementServiceIfAvailableForDoc(elementOrAmpDoc, id, extension);\n    }\n  }\n  return /** @type {!Promise<?Object>} */ (Promise.resolve(null));\n}\n\n/**\n * Throws user error if `service` is null.\n * @param {Object} service\n * @param {string} id\n * @param {string} extension\n * @return {!Object}\n * @private\n */\nfunction assertService(service, id, extension) {\n  return /** @type {!Object} */ (user().assert(service,\n      'Service %s was requested to be provided through %s, ' +\n      'but %s is not loaded in the current page. To fix this ' +\n      'problem load the JavaScript file for %s in this page.',\n      id, extension, extension, extension));\n}\n\n/**\n * Get list of all the extension JS files\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @return {!Array<string>}\n */\nexport function extensionScriptsInNode(head) {\n  // ampdoc.getHeadNode() can return null\n  if (!head) {\n    return [];\n  }\n  const scripts = [];\n  const list = head.querySelectorAll('script[custom-element]');\n  for (let i = 0; i < list.length; i++) {\n    scripts.push(list[i].getAttribute('custom-element'));\n  }\n  return scripts;\n}\n\n/**\n * Waits for body to be present then verifies that an extension script is\n * present in head for installation.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n * @param {string} extensionId\n * @return {!Promise<boolean>}\n */\nexport function isExtensionScriptInNode(ampdoc, extensionId) {\n  return ampdoc.whenBodyAvailable()\n      .then(() => {\n        return extensionScriptInNode(\n            ampdoc.getHeadNode(), extensionId);\n      });\n}\n\n/**\n * Verifies that an extension script is present in head for\n * installation.\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @param {string} extensionId\n * @private\n */\nfunction extensionScriptInNode(head, extensionId) {\n  return extensionScriptsInNode(head).includes(extensionId);\n}\n\n/**\n * Waits for an extension if its script is present\n * @param {!Window} win\n * @param {string} extension\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @return {!Promise}\n * @private\n */\nfunction waitForExtensionIfPresent(win, extension, head) {\n  /**\n   * If there is an extension script wait for it to load before trying\n   * to get the service. Prevents a race condition when everything but\n   * the extensions is in cache. If there is no script then it's either\n   * not present, or the service was defined by a test. In those cases\n   * we don't wait around for an extension that does not exist.\n   */\n\n  // TODO(jpettitt) investigate registerExtension to short circuit\n  // the dom call in extensionScriptsInNode()\n  if (!extensionScriptInNode(head, extension)) {\n    return Promise.resolve();\n  }\n\n  const extensions = getService(win, 'extensions');\n  return /** @type {!Promise<?Object>} */ (\n    extensions.waitForExtension(win, extension));\n}\n\n/**\n * Returns the promise for service with `id` on the given window if available.\n * Otherwise, resolves with null (service was not registered).\n * @param {!Window} win\n * @param {string} id\n * @param {string} extension\n * @param {boolean=} opt_element\n * @return {!Promise<Object>}\n * @private\n */\nfunction getElementServicePromiseOrNull(win, id, extension, opt_element) {\n  return dom.waitForBodyPromise(win.document)\n      .then(() => waitForExtensionIfPresent(win, extension, win.document.head))\n      .then(() => {\n        // If this service is provided by an element, then we can't depend on\n        // the service (they may not use the element).\n        if (opt_element) {\n          return getServicePromiseOrNull(win, id);\n        } else if (isElementScheduled(win, extension)) {\n          return getServicePromise(win, id);\n        }\n        return null;\n      });\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nimport {AmpEvents} from './amp-events';\nimport {Services} from './services';\nimport {\n  USER_ERROR_SENTINEL,\n  dev,\n  duplicateErrorIfNecessary,\n  isUserErrorEmbed,\n  isUserErrorMessage,\n} from './log';\nimport {experimentTogglesOrNull, getBinaryType, isCanary} from './experiments';\nimport {exponentialBackoff} from './exponential-backoff';\nimport {getMode} from './mode';\nimport {isExperimentOn} from './experiments';\nimport {\n  isLoadErrorMessage,\n} from './event-helper';\nimport {isProxyOrigin} from './url';\nimport {makeBodyVisible} from './style-installer';\nimport {startsWith} from './string';\nimport {triggerAnalyticsEvent} from './analytics';\nimport {urls} from './config';\n\n/**\n * @const {string}\n */\nconst CANCELLED = 'CANCELLED';\n\n/**\n * @const {string}\n */\nconst BLOCK_BY_CONSENT = 'BLOCK_BY_CONSENT';\n\n\n/**\n * The threshold for errors throttled because nothing can be done about\n * them, but we'd still like to report the rough number.\n * @const {number}\n */\nconst NON_ACTIONABLE_ERROR_THROTTLE_THRESHOLD = 0.001;\n\n/**\n * The threshold for errors throttled because nothing can be done about\n * them, but we'd still like to report the rough number.\n * @const {number}\n */\nconst USER_ERROR_THROTTLE_THRESHOLD = 0.1;\n\n\n/**\n * Collects error messages, so they can be included in subsequent reports.\n * That allows identifying errors that might be caused by previous errors.\n */\nlet accumulatedErrorMessages = self.AMPErrors || [];\n// Use a true global, to avoid multi-module inclusion issues.\nself.AMPErrors = accumulatedErrorMessages;\n\n/**\n * Pushes element into array, keeping at most the most recent limit elements\n *\n * @param {!Array<T>} array\n * @param {T} element\n * @param {number} limit\n * @template T\n */\nfunction pushLimit(array, element, limit) {\n  if (array.length >= limit) {\n    array.splice(0, array.length - limit + 1);\n  }\n  array.push(element);\n}\n\n/**\n * A wrapper around our exponentialBackoff, to lazy initialize it to avoid an\n * un-DCE'able side-effect.\n * @param {function()} work the function to execute after backoff\n * @return {number} the setTimeout id\n */\nlet reportingBackoff = function(work) {\n  // Set reportingBackoff as the lazy-created function. JS Vooodoooo.\n  reportingBackoff = exponentialBackoff(1.5);\n  return reportingBackoff(work);\n};\n\n/**\n * Attempts to stringify a value, falling back to String.\n * @param {*} value\n * @return {string}\n */\nfunction tryJsonStringify(value) {\n  try {\n    // Cast is fine, because we really don't care here. Just trying.\n    return JSON.stringify(/** @type {!JsonObject} */ (value));\n  } catch (e) {\n    return String(value);\n  }\n}\n\n/**\n * The true JS engine, as detected by inspecting an Error stack. This should be\n * used with the userAgent to tell definitely. I.e., Chrome on iOS is really a\n * Safari JS engine.\n */\nlet detectedJsEngine;\n\n/**\n * @param {!Window} win\n * @param {*} error\n * @param {!Element=} opt_associatedElement\n */\nexport function reportErrorForWin(win, error, opt_associatedElement) {\n  reportError(error, opt_associatedElement);\n  if (error && !!win && isUserErrorMessage(error.message)\n      && !isUserErrorEmbed(error.message)) {\n    reportErrorToAnalytics(/** @type {!Error} */(error), win);\n  }\n}\n\n/**\n * Reports an error. If the error has an \"associatedElement\" property\n * the element is marked with the `i-amphtml-element-error` and displays\n * the message itself. The message is always send to the console.\n * If the error has a \"messageArray\" property, that array is logged.\n * This way one gets the native fidelity of the console for things like\n * elements instead of stringification.\n * @param {*} error\n * @param {!Element=} opt_associatedElement\n * @return {!Error}\n */\nexport function reportError(error, opt_associatedElement) {\n  try {\n    // Convert error to the expected type.\n    let isValidError;\n    if (error) {\n      if (error.message !== undefined) {\n        error = duplicateErrorIfNecessary(/** @type {!Error} */(error));\n        isValidError = true;\n      } else {\n        const origError = error;\n        error = new Error(tryJsonStringify(origError));\n        error.origError = origError;\n      }\n    } else {\n      error = new Error('Unknown error');\n    }\n    // Report if error is not an expected type.\n    if (!isValidError && getMode().localDev && !getMode().test) {\n      setTimeout(function() {\n        const rethrow = new Error(\n            '_reported_ Error reported incorrectly: ' + error);\n        throw rethrow;\n      });\n    }\n\n    if (error.reported) {\n      return /** @type {!Error} */ (error);\n    }\n    error.reported = true;\n\n    // Update element.\n    const element = opt_associatedElement || error.associatedElement;\n    if (element && element.classList) {\n      element.classList.add('i-amphtml-error');\n      if (getMode().development) {\n        element.classList.add('i-amphtml-element-error');\n        element.setAttribute('error-message', error.message);\n      }\n    }\n\n    // Report to console.\n    if (self.console) {\n      const output = (console.error || console.log);\n      if (error.messageArray) {\n        output.apply(console, error.messageArray);\n      } else {\n        if (element) {\n          output.call(console, error.message, element);\n        } else if (!getMode().minified) {\n          output.call(console, error.stack);\n        } else {\n          output.call(console, error.message);\n        }\n      }\n    }\n    if (element && element.dispatchCustomEventForTesting) {\n      element.dispatchCustomEventForTesting(AmpEvents.ERROR, error.message);\n    }\n\n    // 'call' to make linter happy. And .call to make compiler happy\n    // that expects some @this.\n    reportErrorToServer['call'](undefined, undefined, undefined, undefined,\n        undefined, error);\n  } catch (errorReportingError) {\n    setTimeout(function() {\n      throw errorReportingError;\n    });\n  }\n  return /** @type {!Error} */ (error);\n}\n\n/**\n * Returns an error for a cancellation of a promise.\n * @return {!Error}\n */\nexport function cancellation() {\n  return new Error(CANCELLED);\n}\n\n/**\n * @param {*} errorOrMessage\n * @return {boolean}\n */\nexport function isCancellation(errorOrMessage) {\n  if (!errorOrMessage) {\n    return false;\n  }\n  if (typeof errorOrMessage == 'string') {\n    return startsWith(errorOrMessage, CANCELLED);\n  }\n  if (typeof errorOrMessage.message == 'string') {\n    return startsWith(errorOrMessage.message, CANCELLED);\n  }\n  return false;\n}\n\n/**\n * Returns an error for component blocked by consent\n * @return {!Error}\n */\nexport function blockedByConsentError() {\n  return new Error(BLOCK_BY_CONSENT);\n}\n\n/**\n * @param {*} errorOrMessage\n * @return {boolean}\n */\nexport function isBlockedByConsent(errorOrMessage) {\n  if (!errorOrMessage) {\n    return false;\n  }\n  if (typeof errorOrMessage == 'string') {\n    return startsWith(errorOrMessage, BLOCK_BY_CONSENT);\n  }\n  if (typeof errorOrMessage.message == 'string') {\n    return startsWith(errorOrMessage.message, BLOCK_BY_CONSENT);\n  }\n  return false;\n}\n\n\n/**\n * Install handling of global unhandled exceptions.\n * @param {!Window} win\n */\nexport function installErrorReporting(win) {\n  win.onerror = /** @type {!Function} */ (reportErrorToServer);\n  win.addEventListener('unhandledrejection', event => {\n    if (event.reason &&\n      (event.reason.message === CANCELLED ||\n      event.reason.message === BLOCK_BY_CONSENT)) {\n      event.preventDefault();\n      return;\n    }\n    reportError(event.reason || new Error('rejected promise ' + event));\n  });\n}\n\n/**\n * Signature designed, so it can work with window.onerror\n * @param {string|undefined} message\n * @param {string|undefined} filename\n * @param {string|undefined} line\n * @param {string|undefined} col\n * @param {*|undefined} error\n * @this {!Window|undefined}\n */\nfunction reportErrorToServer(message, filename, line, col, error) {\n  // Make an attempt to unhide the body.\n  if (this && this.document) {\n    makeBodyVisible(this.document);\n  }\n  if (getMode().localDev || getMode().development || getMode().test) {\n    return;\n  }\n  let hasNonAmpJs = false;\n  try {\n    hasNonAmpJs = detectNonAmpJs(self);\n  } catch (ignore) {\n    // Ignore errors during error report generation.\n  }\n  if (hasNonAmpJs && Math.random() > 0.01) {\n    // Only report 1% of errors on pages with non-AMP JS.\n    // These errors can almost never be acted upon, but spikes such as\n    // due to buggy browser extensions may be helpful to notify authors.\n    return;\n  }\n  const data = getErrorReportData(message, filename, line, col, error,\n      hasNonAmpJs);\n  if (data) {\n    // Report the error to viewer if it has the capability. The data passed\n    // to the viewer is exactly the same as the data passed to the server\n    // below.\n    maybeReportErrorToViewer(this, data);\n    reportingBackoff(() => {\n      const xhr = new XMLHttpRequest();\n      xhr.open('POST', urls.errorReporting, true);\n      xhr.send(JSON.stringify(data));\n    });\n  }\n}\n\n/**\n * Passes the given error data to the viewer if the following criteria is met:\n * - The viewer is a trusted viewer\n * - The viewer has the `errorReporter` capability\n * - The AMP doc is in single doc mode\n * - The AMP doc is opted-in for error interception (`<html>` tag has the\n *   `report-errors-to-viewer` attribute)\n *\n * @param {!Window} win\n * @param {!JsonObject} data Data from `getErrorReportData`.\n * @return {!Promise<boolean>} `Promise<True>` if the error was sent to the\n *     viewer, `Promise<False>` otherwise.\n * @visibleForTesting\n */\nexport function maybeReportErrorToViewer(win, data) {\n  const ampdocService = Services.ampdocServiceFor(win);\n  if (!ampdocService.isSingleDoc()) {\n    return Promise.resolve(false);\n  }\n  const ampdocSingle = ampdocService.getAmpDoc();\n  const htmlElement = ampdocSingle.getRootNode().documentElement;\n  const docOptedIn = htmlElement.hasAttribute('report-errors-to-viewer');\n  if (!docOptedIn) {\n    return Promise.resolve(false);\n  }\n\n  const viewer = Services.viewerForDoc(ampdocSingle);\n  if (!viewer.hasCapability('errorReporter')) {\n    return Promise.resolve(false);\n  }\n\n  return viewer.isTrustedViewer().then(viewerTrusted => {\n    if (!viewerTrusted) {\n      return false;\n    }\n    viewer.sendMessage('error', data);\n    return true;\n  });\n}\n\n/**\n * Signature designed, so it can work with window.onerror\n * @param {string|undefined} message\n * @param {string|undefined} filename\n * @param {string|undefined} line\n * @param {string|undefined} col\n * @param {*|undefined} error\n * @param {boolean} hasNonAmpJs\n * @return {!JsonObject|undefined} The data to post\n * visibleForTesting\n */\nexport function getErrorReportData(message, filename, line, col, error,\n  hasNonAmpJs) {\n  let expected = false;\n  if (error) {\n    if (error.message) {\n      message = error.message;\n    } else {\n      // This should never be a string, but sometimes it is.\n      message = String(error);\n    }\n    // An \"expected\" error is still an error, i.e. some features are disabled\n    // or not functioning fully because of it. However, it's an expected\n    // error. E.g. as is the case with some browser API missing (storage).\n    // Thus, the error can be classified differently by log aggregators.\n    // The main goal is to monitor that an \"expected\" error doesn't deteriorate\n    // over time. It's impossible to completely eliminate it.\n    if (error.expected) {\n      expected = true;\n    }\n  }\n  if (!message) {\n    message = 'Unknown error';\n  }\n  if (/_reported_/.test(message)) {\n    return;\n  }\n  if (message == CANCELLED) {\n    return;\n  }\n\n  const detachedWindow = !(self && self.window);\n  const throttleBase = Math.random();\n\n  // We throttle load errors and generic \"Script error.\" errors\n  // that have no information and thus cannot be acted upon.\n  if (isLoadErrorMessage(message) ||\n    // See https://github.com/ampproject/amphtml/issues/7353\n    // for context.\n    message == 'Script error.' ||\n    // Window has become detached, really anything can happen\n    // at this point.\n    detachedWindow) {\n    expected = true;\n\n    if (throttleBase > NON_ACTIONABLE_ERROR_THROTTLE_THRESHOLD) {\n      return;\n    }\n  }\n\n  const isUserError = isUserErrorMessage(message);\n\n  // Only report a subset of user errors.\n  if (isUserError && throttleBase > USER_ERROR_THROTTLE_THRESHOLD) {\n    return;\n  }\n\n  // This is the App Engine app in\n  // https://github.com/ampproject/error-tracker\n  // It stores error reports via https://cloud.google.com/error-reporting/\n  // for analyzing production issues.\n  const data = /** @type {!JsonObject} */ (Object.create(null));\n  data['v'] = getMode().rtvVersion;\n  data['noAmp'] = hasNonAmpJs ? '1' : '0';\n  data['m'] = message.replace(USER_ERROR_SENTINEL, '');\n  data['a'] = isUserError ? '1' : '0';\n\n  // Errors are tagged with \"ex\" (\"expected\") label to allow loggers to\n  // classify these errors as benchmarks and not exceptions.\n  data['ex'] = expected ? '1' : '0';\n  data['dw'] = detachedWindow ? '1' : '0';\n\n  let runtime = '1p';\n  if (self.context && self.context.location) {\n    data['3p'] = '1';\n    runtime = '3p';\n  } else if (getMode().runtime) {\n    runtime = getMode().runtime;\n  }\n  data['rt'] = runtime;\n\n  // TODO(erwinm): Remove ca when all systems read `bt` instead of `ca` to\n  // identify js binary type.\n  data['ca'] = isCanary(self) ? '1' : '0';\n\n  // Pass binary type.\n  data['bt'] = getBinaryType(self);\n\n  if (self.location.ancestorOrigins && self.location.ancestorOrigins[0]) {\n    data['or'] = self.location.ancestorOrigins[0];\n  }\n  if (self.viewerState) {\n    data['vs'] = self.viewerState;\n  }\n  // Is embedded?\n  if (self.parent && self.parent != self) {\n    data['iem'] = '1';\n  }\n\n  if (self.AMP && self.AMP.viewer) {\n    const resolvedViewerUrl = self.AMP.viewer.getResolvedViewerUrl();\n    const messagingOrigin = self.AMP.viewer.maybeGetMessagingOrigin();\n    if (resolvedViewerUrl) {\n      data['rvu'] = resolvedViewerUrl;\n    }\n    if (messagingOrigin) {\n      data['mso'] = messagingOrigin;\n    }\n  }\n\n  if (!detectedJsEngine) {\n    detectedJsEngine = detectJsEngineFromStack();\n  }\n  data['jse'] = detectedJsEngine;\n\n  const exps = [];\n  const experiments = experimentTogglesOrNull(self);\n  for (const exp in experiments) {\n    const on = experiments[exp];\n    exps.push(`${exp}=${on ? '1' : '0'}`);\n  }\n  data['exps'] = exps.join(',');\n\n  if (error) {\n    const tagName = error.associatedElement\n      ? error.associatedElement.tagName\n      : 'u'; // Unknown\n    data['el'] = tagName;\n\n    if (error.args) {\n      data['args'] = JSON.stringify(error.args);\n    }\n\n    if (!isUserError && !error.ignoreStack && error.stack) {\n      data['s'] = error.stack;\n    }\n\n    error.message += ' _reported_';\n  } else {\n    data['f'] = filename || '';\n    data['l'] = line || '';\n    data['c'] = col || '';\n  }\n  data['r'] = self.document.referrer;\n  data['ae'] = accumulatedErrorMessages.join(',');\n  data['fr'] = self.location.originalHash || self.location.hash;\n\n  pushLimit(accumulatedErrorMessages, message, 25);\n\n  return data;\n}\n\n/**\n * Returns true if it appears like there is non-AMP JS on the\n * current page.\n * @param {!Window} win\n * @return {boolean}\n * @visibleForTesting\n */\nexport function detectNonAmpJs(win) {\n  const scripts = win.document.querySelectorAll('script[src]');\n  for (let i = 0; i < scripts.length; i++) {\n    if (!isProxyOrigin(scripts[i].src.toLowerCase())) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Resets accumulated error messages for testing\n */\nexport function resetAccumulatedErrorMessagesForTesting() {\n  accumulatedErrorMessages = [];\n}\n\n/**\n * Does a series of checks on the stack of an thrown error to determine the\n * JS engine that is currently running. This gives a bit more information than\n * just the UserAgent, since browsers often allow overriding it to \"emulate\"\n * mobile.\n * @return {string}\n * @visibleForTesting\n */\nexport function detectJsEngineFromStack() {\n  /** @constructor */\n  function Fn() {}\n  Fn.prototype.t = function() {\n    throw new Error('message');\n  };\n  const object = new Fn();\n  try {\n    object.t();\n  } catch (e) {\n    const {stack} = e;\n\n    // Safari only mentions the method name.\n    if (startsWith(stack, 't@')) {\n      return 'Safari';\n    }\n\n    // Firefox mentions \"prototype\".\n    if (stack.indexOf('.prototype.t@') > -1) {\n      return 'Firefox';\n    }\n\n    // IE looks like Chrome, but includes a context for the base stack line.\n    // Explicitly, we're looking for something like:\n    // \"    at Global code (https://example.com/app.js:1:200)\" or\n    // \"    at Anonymous function (https://example.com/app.js:1:200)\"\n    // vs Chrome which has:\n    // \"    at https://example.com/app.js:1:200\"\n    const last = stack.split('\\n').pop();\n    if (/\\bat .* \\(/i.test(last)) {\n      return 'IE';\n    }\n\n    // Finally, chrome includes the error message in the stack.\n    if (startsWith(stack, 'Error: message')) {\n      return 'Chrome';\n    }\n  }\n\n  return 'unknown';\n}\n\n/**\n * @param {!Error} error\n * @param {!Window} win\n */\nexport function reportErrorToAnalytics(error, win) {\n  if (isExperimentOn(win, 'user-error-reporting')) {\n    const vars = {\n      'errorName': error.name,\n      'errorMessage': error.message,\n    };\n    triggerAnalyticsEvent(getRootElement_(win), 'user-error', vars);\n  }\n}\n\n/**\n * @param {!Window} win\n * @return {!Element}\n * @private\n */\nfunction getRootElement_(win) {\n  const root = Services.ampdocServiceFor(win).getAmpDoc().getRootNode();\n  return dev().assertElement(root.documentElement || root.body || root);\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n  * Whether addEventListener supports options or only takes capture as a boolean\n  * @type {boolean|undefined}\n  * @visibleForTesting\n  */\nlet optsSupported;\n\n/**\n * Listens for the specified event on the element.\n *\n * Do not use this directly. This method is implemented as a shared\n * dependency. Use `listen()` in either `event-helper` or `3p-frame-messaging`,\n * depending on your use case.\n *\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function internalListenImplementation(element, eventType, listener,\n  opt_evtListenerOpts) {\n  let localElement = element;\n  let localListener = listener;\n  /**\n   * @type {?Function}\n   */\n  let wrapped;\n\n  wrapped = event => {\n    try {\n      return localListener(event);\n    } catch (e) {\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n  };\n  const optsSupported = detectEvtListenerOptsSupport();\n  let capture = false;\n  if (opt_evtListenerOpts) {\n    capture = opt_evtListenerOpts.capture;\n  }\n  localElement.addEventListener(\n      eventType,\n      wrapped,\n      optsSupported ? opt_evtListenerOpts : capture\n  );\n  return () => {\n    if (localElement) {\n      localElement.removeEventListener(\n          eventType,\n          wrapped,\n          optsSupported ? opt_evtListenerOpts : capture\n      );\n    }\n    // Ensure these are GC'd\n    localListener = null;\n    localElement = null;\n    wrapped = null;\n  };\n}\n\n/**\n * Tests whether the browser supports options as an argument of addEventListener\n * or not.\n *\n * @return {boolean}\n */\nexport function detectEvtListenerOptsSupport() {\n  // Only run the test once\n  if (optsSupported !== undefined) {\n    return optsSupported;\n  }\n\n  optsSupported = false;\n  try {\n    // Test whether browser supports EventListenerOptions or not\n    const options = {\n      get capture() {\n        optsSupported = true;\n      },\n    };\n    self.addEventListener('test-options', null, options);\n    self.removeEventListener('test-options', null, options);\n  } catch (err) {\n    // EventListenerOptions are not supported\n  }\n  return optsSupported;\n}\n\n/**\n  * Resets the test for whether addEventListener supports options or not.\n  */\nexport function resetEvtListenerOptsSupportForTesting() {\n  optsSupported = undefined;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {internalListenImplementation} from './event-helper-listen';\nimport {user} from './log';\n\n/** @const {string}  */\nconst LOAD_FAILURE_PREFIX = 'Failed to load:';\n\n/**\n * Returns a CustomEvent with a given type and detail; supports fallback for IE.\n * @param {!Window} win\n * @param {string} type\n * @param {!JsonObject|string|undefined|null} detail\n * @param {EventInit=} opt_eventInit\n * @return {!Event}\n */\nexport function createCustomEvent(win, type, detail, opt_eventInit) {\n  const eventInit = /** @type {!CustomEventInit} */ ({detail});\n  Object.assign(eventInit, opt_eventInit);\n  // win.CustomEvent is a function on Edge, Chrome, FF, Safari but\n  // is an object on IE 11.\n  if (typeof win.CustomEvent == 'function') {\n    return new win.CustomEvent(type, eventInit);\n  } else {\n    // Deprecated fallback for IE.\n    const e = win.document.createEvent('CustomEvent');\n    e.initCustomEvent(\n        type, !!eventInit.bubbles, !!eventInit.cancelable, detail);\n    return e;\n  }\n}\n\n/**\n * Listens for the specified event on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listen(element, eventType, listener, opt_evtListenerOpts) {\n  return internalListenImplementation(\n      element, eventType, listener, opt_evtListenerOpts);\n}\n\n/**\n * Returns the data property of an event with the correct type.\n * @param {!Event|{data: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getData(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.data);\n}\n\n/**\n * Returns the detail property of an event with the correct type.\n * @param {!Event|{detail: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getDetail(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.detail);\n}\n\n/**\n * Listens for the specified event on the element and removes the listener\n * as soon as event has been received.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listenOnce(element, eventType, listener, opt_evtListenerOpts) {\n  let localListener = listener;\n  const unlisten = internalListenImplementation(element, eventType, event => {\n    try {\n      localListener(event);\n    } finally {\n      // Ensure listener is GC'd\n      localListener = null;\n      unlisten();\n    }\n  }, opt_evtListenerOpts);\n  return unlisten;\n}\n\n\n/**\n * Returns  a promise that will resolve as soon as the specified event has\n * fired on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {Object=} opt_evtListenerOpts\n * @param {function(!UnlistenDef)=} opt_cancel An optional function that, when\n *     provided, will be called with the unlistener. This gives the caller\n *     access to the unlistener, so it may be called manually when necessary.\n * @return {!Promise<!Event>}\n */\nexport function listenOncePromise(element, eventType, opt_evtListenerOpts,\n  opt_cancel) {\n  let unlisten;\n  const eventPromise = new Promise(resolve => {\n    unlisten = listenOnce(element, eventType, resolve, opt_evtListenerOpts);\n  });\n  eventPromise.then(unlisten, unlisten);\n  if (opt_cancel) {\n    opt_cancel(unlisten);\n  }\n  return eventPromise;\n}\n\n\n/**\n * Whether the specified element/window has been loaded already.\n * @param {!Element|!Window} eleOrWindow\n * @return {boolean}\n */\nexport function isLoaded(eleOrWindow) {\n  return !!(eleOrWindow.complete || eleOrWindow.readyState == 'complete'\n      // If the passed in thing is a Window, infer loaded state from\n      //\n      || (eleOrWindow.document\n          && eleOrWindow.document.readyState == 'complete'));\n}\n\n/**\n * Returns a promise that will resolve or fail based on the eleOrWindow's 'load'\n * and 'error' events. Optionally this method takes a timeout, which will reject\n * the promise if the resource has not loaded by then.\n * @param {T} eleOrWindow Supports both Elements and as a special case Windows.\n * @return {!Promise<T>}\n * @template T\n */\nexport function loadPromise(eleOrWindow) {\n  let unlistenLoad;\n  let unlistenError;\n  if (isLoaded(eleOrWindow)) {\n    return Promise.resolve(eleOrWindow);\n  }\n  const loadingPromise = new Promise((resolve, reject) => {\n    // Listen once since IE 5/6/7 fire the onload event continuously for\n    // animated GIFs.\n    const {tagName} = eleOrWindow;\n    if (tagName === 'AUDIO' || tagName === 'VIDEO') {\n      unlistenLoad = listenOnce(eleOrWindow, 'loadstart', resolve);\n    } else {\n      unlistenLoad = listenOnce(eleOrWindow, 'load', resolve);\n    }\n    // For elements, unlisten on error (don't for Windows).\n    if (tagName) {\n      unlistenError = listenOnce(eleOrWindow, 'error', reject);\n    }\n  });\n\n  return loadingPromise.then(() => {\n    if (unlistenError) {\n      unlistenError();\n    }\n    return eleOrWindow;\n  }, () => {\n    if (unlistenLoad) {\n      unlistenLoad();\n    }\n    failedToLoad(eleOrWindow);\n  });\n}\n\n/**\n * Emit error on load failure.\n * @param {!Element|!Window} eleOrWindow Supports both Elements and as a special\n *     case Windows.\n */\nfunction failedToLoad(eleOrWindow) {\n  // Report failed loads as user errors so that they automatically go\n  // into the \"document error\" bucket.\n  let target = eleOrWindow;\n  if (target && target.src) {\n    target = target.src;\n  }\n  throw user().createError(LOAD_FAILURE_PREFIX, target);\n}\n\n/**\n * Returns true if this error message is was created for a load error.\n * @param {string} message An error message\n * @return {boolean}\n */\nexport function isLoadErrorMessage(message) {\n  return message.indexOf(LOAD_FAILURE_PREFIX) != -1;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Experiments system allows a developer to opt-in to test\n * features that are not yet fully tested.\n *\n * Experiments page: https://cdn.ampproject.org/experiments.html *\n */\n\nimport {getCookie, setCookie} from './cookies';\nimport {hasOwn} from './utils/object';\nimport {parseQueryString} from './url';\n\n/** @const {string} */\nconst COOKIE_NAME = 'AMP_EXP';\n\n/** @const {number} */\nconst COOKIE_MAX_AGE_DAYS = 180; // 6 month\n\n/** @const {time} */\nconst COOKIE_EXPIRATION_INTERVAL = COOKIE_MAX_AGE_DAYS * 24 * 60 * 60 * 1000;\n\n/** @const {string} */\nconst TOGGLES_WINDOW_PROPERTY = '__AMP__EXPERIMENT_TOGGLES';\n\n/**\n * @typedef {{\n *   isTrafficEligible: function(!Window):boolean,\n *   branches: !Array<string>\n * }}\n */\nexport let ExperimentInfo;\n\n/**\n * Whether we are in canary.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isCanary(win) {\n  return !!(win.AMP_CONFIG && win.AMP_CONFIG.canary);\n}\n\n/**\n * Returns binary type, e.g., canary, control, or production.\n * @param {!Window} win\n * @return {string}\n */\nexport function getBinaryType(win) {\n  return win.AMP_CONFIG && win.AMP_CONFIG.type ?\n    win.AMP_CONFIG.type : 'unknown';\n}\n\n/**\n * Whether the specified experiment is on or off.\n * @param {!Window} win\n * @param {string} experimentId\n * @return {boolean}\n */\nexport function isExperimentOn(win, experimentId) {\n  const toggles = experimentToggles(win);\n  return !!toggles[experimentId];\n}\n\n/**\n * Toggles the experiment on or off. Returns the actual value of the experiment\n * after toggling is done.\n * @param {!Window} win\n * @param {string} experimentId\n * @param {boolean=} opt_on\n * @param {boolean=} opt_transientExperiment  Whether to toggle the\n *     experiment state \"transiently\" (i.e., for this page load only) or\n *     durably (by saving the experiment IDs to the cookie after toggling).\n *     Default: false (save durably).\n * @return {boolean} New state for experimentId.\n */\nexport function toggleExperiment(win, experimentId, opt_on,\n  opt_transientExperiment) {\n  const currentlyOn = isExperimentOn(win, /*OK*/experimentId);\n  const on = !!(opt_on !== undefined ? opt_on : !currentlyOn);\n  if (on != currentlyOn) {\n    const toggles = experimentToggles(win);\n    toggles[experimentId] = on;\n\n    if (!opt_transientExperiment) {\n      const cookieToggles = getExperimentTogglesFromCookie(win);\n      cookieToggles[experimentId] = on;\n      saveExperimentTogglesToCookie(win, cookieToggles);\n    }\n  }\n  return on;\n}\n\n/**\n * Calculate whether the experiment is on or off based off of the\n * cookieFlag or the global config frequency given.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nexport function experimentToggles(win) {\n  if (win[TOGGLES_WINDOW_PROPERTY]) {\n    return win[TOGGLES_WINDOW_PROPERTY];\n  }\n  win[TOGGLES_WINDOW_PROPERTY] = Object.create(null);\n  const toggles = win[TOGGLES_WINDOW_PROPERTY];\n\n  // Read the default config of this build.\n  if (win.AMP_CONFIG) {\n    for (const experimentId in win.AMP_CONFIG) {\n      const frequency = win.AMP_CONFIG[experimentId];\n      if (typeof frequency === 'number' && frequency >= 0 && frequency <= 1) {\n        toggles[experimentId] = Math.random() < frequency;\n      }\n    }\n  }\n  // Read document level override from meta tag.\n  if (win.AMP_CONFIG\n      && Array.isArray(win.AMP_CONFIG['allow-doc-opt-in'])\n      && win.AMP_CONFIG['allow-doc-opt-in'].length > 0) {\n    const allowed = win.AMP_CONFIG['allow-doc-opt-in'];\n    const meta =\n        win.document.head.querySelector('meta[name=\"amp-experiments-opt-in\"]');\n    if (meta) {\n      const optedInExperiments = meta.getAttribute('content').split(',');\n      for (let i = 0; i < optedInExperiments.length; i++) {\n        if (allowed.indexOf(optedInExperiments[i]) != -1) {\n          toggles[optedInExperiments[i]] = true;\n        }\n      }\n    }\n  }\n\n  Object.assign(toggles, getExperimentTogglesFromCookie(win));\n\n  if (win.AMP_CONFIG\n      && Array.isArray(win.AMP_CONFIG['allow-url-opt-in'])\n      && win.AMP_CONFIG['allow-url-opt-in'].length > 0) {\n    const allowed = win.AMP_CONFIG['allow-url-opt-in'];\n    const hash = win.location.originalHash || win.location.hash;\n    const params = parseQueryString(hash);\n    for (let i = 0; i < allowed.length; i++) {\n      const param = params[`e-${allowed[i]}`];\n      if (param == '1') {\n        toggles[allowed[i]] = true;\n      }\n      if (param == '0') {\n        toggles[allowed[i]] = false;\n      }\n    }\n  }\n  return toggles;\n}\n\n/**\n * Returns the cached experiments toggles, or null if they have not been\n * computed yet.\n * @param {!Window} win\n * @return {Object<string, boolean>}\n */\nexport function experimentTogglesOrNull(win) {\n  return win[TOGGLES_WINDOW_PROPERTY] || null;\n}\n\n/**\n * Returns a set of experiment IDs currently on.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nfunction getExperimentTogglesFromCookie(win) {\n  const experimentCookie = getCookie(win, COOKIE_NAME);\n  const tokens = experimentCookie ? experimentCookie.split(/\\s*,\\s*/g) : [];\n\n  const toggles = Object.create(null);\n  for (let i = 0; i < tokens.length; i++) {\n    if (tokens[i].length == 0) {\n      continue;\n    }\n    if (tokens[i][0] == '-') {\n      toggles[tokens[i].substr(1)] = false;\n    } else {\n      toggles[tokens[i]] = true;\n    }\n  }\n\n  return toggles;\n}\n\n/**\n * Saves a set of experiment IDs currently on.\n * @param {!Window} win\n * @param {!Object<string, boolean>} toggles\n */\nfunction saveExperimentTogglesToCookie(win, toggles) {\n  const experimentIds = [];\n  for (const experiment in toggles) {\n    experimentIds.push((toggles[experiment] === false ? '-' : '') + experiment);\n  }\n\n  setCookie(win, COOKIE_NAME, experimentIds.join(','),\n      Date.now() + COOKIE_EXPIRATION_INTERVAL, {\n        // Set explicit domain, so the cookie gets send to sub domains.\n        domain: win.location.hostname,\n        allowOnProxyOrigin: true,\n      });\n}\n\n/**\n * See getExperimentTogglesFromCookie().\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n * @visibleForTesting\n */\nexport function getExperimentToglesFromCookieForTesting(win) {\n  return getExperimentTogglesFromCookie(win);\n}\n\n/**\n * Resets the experimentsToggle cache for testing purposes.\n * @param {!Window} win\n * @visibleForTesting\n */\nexport function resetExperimentTogglesForTesting(win) {\n  setCookie(win, COOKIE_NAME, '', 0, {\n    domain: win.location.hostname,\n  });\n  win[TOGGLES_WINDOW_PROPERTY] = null;\n}\n\n/**\n * In some browser implementations of Math.random(), sequential calls of\n * Math.random() are correlated and can cause a bias.  In particular,\n * if the previous random() call was < 0.001 (as it will be if we select\n * into an experiment), the next value could be less than 0.5 more than\n * 50.7% of the time.  This provides an implementation that roots down into\n * the crypto API, when available, to produce less biased samples.\n *\n * @return {number} Pseudo-random floating-point value on the range [0, 1).\n */\nfunction slowButAccuratePrng() {\n  // TODO(tdrl): Implement.\n  return Math.random();\n}\n\n/**\n * Container for alternate random number generator implementations.  This\n * allows us to set an \"accurate\" PRNG for branch selection, but to mock it\n * out easily in tests.\n *\n * @visibleForTesting\n * @const {!{accuratePrng: function():number}}\n */\nexport const RANDOM_NUMBER_GENERATORS = {\n  accuratePrng: slowButAccuratePrng,\n};\n\n/**\n * Selects, uniformly at random, a single item from the array.\n * @param {!Array<string>} arr Object to select from.\n * @return {?string} Single item from arr or null if arr was empty.\n */\nfunction selectRandomItem(arr) {\n  const rn = RANDOM_NUMBER_GENERATORS.accuratePrng();\n  return arr[Math.floor(rn * arr.length)] || null;\n}\n\n/**\n * Selects which page-level experiment branches are enabled. If a given\n * experiment name is already set (including to the null / no branches selected\n * state), this won't alter its state.\n *\n * Check whether a given experiment is set using isExperimentOn(win,\n * experimentName) and, if it is on, look for which branch is selected in\n * win.experimentBranches[experimentName].\n *\n * @param {!Window} win Window context on which to save experiment\n *     selection state.\n * @param {!Object<string, !ExperimentInfo>} experiments  Set of experiments to\n *     configure for this page load.\n * @return {!Object<string, string>} Map of experiment names to selected\n *     branches.\n */\nexport function randomlySelectUnsetExperiments(win, experiments) {\n  win.experimentBranches = win.experimentBranches || {};\n  const selectedExperiments = {};\n  for (const experimentName in experiments) {\n    // Skip experimentName if it is not a key of experiments object or if it\n    // has already been populated by some other property.\n    if (!hasOwn(experiments, experimentName)) {\n      continue;\n    }\n    if (hasOwn(win.experimentBranches, experimentName)) {\n      selectedExperiments[experimentName] =\n          win.experimentBranches[experimentName];\n      continue;\n    }\n\n    if (!experiments[experimentName].isTrafficEligible ||\n        !experiments[experimentName].isTrafficEligible(win)) {\n      win.experimentBranches[experimentName] = null;\n      continue;\n    }\n\n    // If we're in the experiment, but we haven't already forced a specific\n    // experiment branch (e.g., via a test setup), then randomize the branch\n    // choice.\n    if (!win.experimentBranches[experimentName] &&\n      isExperimentOn(win, /*OK*/experimentName)) {\n      const {branches} = experiments[experimentName];\n      win.experimentBranches[experimentName] = selectRandomItem(branches);\n      selectedExperiments[experimentName] =\n          win.experimentBranches[experimentName];\n    }\n  }\n  return selectedExperiments;\n}\n\n/**\n * Returns the experiment branch enabled for the given experiment ID.\n * For example, 'control' or 'experiment'.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @return {?string} Active experiment branch ID for experimentName (possibly\n *     null if experimentName has been tested but no branch was enabled).\n */\nexport function getExperimentBranch(win, experimentName) {\n  return win.experimentBranches ? win.experimentBranches[experimentName] : null;\n}\n\n/**\n * Force enable (or disable) a specific branch of a given experiment name.\n * Disables the experiment name altogether if branchId is falseish.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @param {?string} branchId ID of branch to force or null to disable\n *     altogether.\n * @visibleForTesting\n */\nexport function forceExperimentBranch(win, experimentName, branchId) {\n  win.experimentBranches = win.experimentBranches || {};\n  toggleExperiment(win, experimentName, !!branchId, true);\n  win.experimentBranches[experimentName] = branchId;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * @param {number=} opt_base Exponential base. Defaults to 2.\n * @return {function(function()): number} Function that when invoked will\n *     call the passed in function. On every invocation the next\n *     invocation of the passed in function will be exponentially\n *     later. Returned function returns timeout id.\n */\nexport function exponentialBackoff(opt_base) {\n  const getTimeout = exponentialBackoffClock(opt_base);\n  return work => {\n    return setTimeout(work, getTimeout());\n  };\n}\n\n/**\n * @param {number=} opt_base Exponential base. Defaults to 2.\n * @return {function(): number} Function that when invoked will return\n *    a number that exponentially grows per invocation.\n */\nexport function exponentialBackoffClock(opt_base) {\n  const base = opt_base || 2;\n  let count = 0;\n  return () => {\n    let wait = Math.pow(base, count++);\n    wait += getJitter(wait);\n    return wait * 1000;\n  };\n}\n\n/**\n * Add jitter to avoid the thundering herd. This can e.g. happen when\n * we poll a backend and it fails for everyone at the same time.\n * We add up to 30% (default) longer or shorter than the given time.\n *\n * @param {number} wait the amount if base milliseconds\n * @param {number=} opt_perc the min/max percentage to add or sutract\n * @return {number}\n */\nexport function getJitter(wait, opt_perc) {\n  opt_perc = opt_perc || .3;\n  let jitter = wait * opt_perc * Math.random();\n  if (Math.random() > .5) {\n    jitter *= -1;\n  }\n  return jitter;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CommonSignals} from './common-signals';\nimport {Services} from './services';\nimport {\n  createElementWithAttributes,\n  removeElement,\n} from './dom';\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {isArray, toWin} from './types';\nimport {triggerAnalyticsEvent} from './analytics';\n\n/**\n * Method to create scoped analytics element for any element.\n * TODO: Make this function private\n * @param {!Element} parentElement\n * @param {!JsonObject} config\n * @param {boolean=} loadAnalytics\n * @param {boolean=} disableImmediate\n * @return {!Element} created analytics element\n */\nexport function insertAnalyticsElement(\n  parentElement, config, loadAnalytics = false, disableImmediate = false) {\n  const doc = /** @type {!Document} */ (parentElement.ownerDocument);\n  const analyticsElem = createElementWithAttributes(\n      doc,\n      'amp-analytics', dict({\n        'sandbox': 'true',\n        'trigger': disableImmediate ? '' : 'immediate',\n      }));\n  const scriptElem = createElementWithAttributes(\n      doc,\n      'script', dict({\n        'type': 'application/json',\n      }));\n  scriptElem.textContent = JSON.stringify(config);\n  analyticsElem.appendChild(scriptElem);\n  analyticsElem.CONFIG = config;\n\n  // Force load analytics extension if script not included in page.\n  if (loadAnalytics) {\n    // Get Extensions service and force load analytics extension.\n    const extensions =\n        Services.extensionsFor(toWin(parentElement.ownerDocument.defaultView));\n    const ampdoc = Services.ampdoc(parentElement);\n    extensions./*OK*/installExtensionForDoc(ampdoc, 'amp-analytics');\n  } else {\n    Services.analyticsForDocOrNull(parentElement).then(analytics => {\n      dev().assert(analytics);\n    });\n  }\n  parentElement.appendChild(analyticsElem);\n  return analyticsElem;\n}\n\n/**\n * A class that handles customEvent reporting of extension element through\n * amp-analytics. This class is not exposed to extension element directly to\n * restrict the genration of the config Please use CustomEventReporterBuilder to\n * build a CustomEventReporter instance.\n */\nclass CustomEventReporter {\n  /**\n   * @param {!Element} parent\n   * @param {!JsonObject} config\n   */\n  constructor(parent, config) {\n    dev().assert(config['triggers'], 'Config must have triggers defined');\n    /** @private {string} */\n    this.id_ = parent.getResourceId();\n\n    /** @private {!AmpElement} */\n    this.parent_ = parent;\n\n    /** @private {JsonObject} */\n    this.config_ = config;\n\n    for (const event in config['triggers']) {\n      const eventType = config['triggers'][event]['on'];\n      dev().assert(eventType,\n          'CustomEventReporter config must specify trigger eventType');\n      const newEventType = this.getEventTypeInSandbox_(eventType);\n      config['triggers'][event]['on'] = newEventType;\n    }\n\n    this.parent_.signals().whenSignal(CommonSignals.LOAD_START).then(() => {\n      insertAnalyticsElement(this.parent_, config, false);\n    });\n  }\n\n  /**\n   * @param {string} eventType\n   * @param {!Object<string, string>=} opt_vars A map of vars and their values.\n   */\n  trigger(eventType, opt_vars) {\n    dev().assert(this.config_['triggers'][eventType],\n        'Cannot trigger non initiated eventType');\n    triggerAnalyticsEvent(this.parent_,\n        this.getEventTypeInSandbox_(eventType), opt_vars);\n  }\n  /**\n   * @param {string} eventType\n   * @return {string}\n   */\n  getEventTypeInSandbox_(eventType) {\n    return `sandbox-${this.id_}-${eventType}`;\n  }\n}\n\n\n/**\n * A builder class that enable extension elements to easily build and get a\n * CustomEventReporter instance. Its constructor requires the parent AMP\n * element. It provides two methods #track() and #build() to build the\n * CustomEventReporter instance.\n */\nexport class CustomEventReporterBuilder {\n  /** @param {!AmpElement} parent */\n  constructor(parent) {\n\n    /** @private {!AmpElement} */\n    this.parent_ = parent;\n\n    /** @private {?JsonObject} */\n    this.config_ = /** @type {JsonObject} */ ({\n      'requests': {},\n      'triggers': {},\n    });\n  }\n\n  /**\n   * The #track() method takes in a unique custom-event name, and the\n   * corresponding request url (or an array of request urls). One can call\n   * #track() multiple times with different eventType name (order doesn't\n   * matter) before #build() is called.\n   * @param {string} eventType\n   * @param {string|!Array<string>} request\n   */\n  track(eventType, request) {\n    request = isArray(request) ? request : [request];\n    dev().assert(!this.config_['triggers'][eventType],\n        'customEventReporterBuilder should not track same eventType twice');\n    const requestList = [];\n    for (let i = 0; i < request.length; i++) {\n      const requestName = `${eventType}-request-${i}`;\n      this.config_['requests'][requestName] = request[i];\n      requestList.push(requestName);\n    }\n    this.config_['triggers'][eventType] = {\n      'on': eventType,\n      'request': requestList,\n    };\n    return this;\n  }\n\n  /**\n   * Call the #build() method to build and get the CustomEventReporter instance.\n   * One CustomEventReporterBuilder instance can only build one reporter, which\n   * means #build() should only be called once after all eventType are added.\n   */\n  build() {\n    dev().assert(this.config_, 'CustomEventReporter already built');\n    const report = new CustomEventReporter(\n        this.parent_, /** @type {!JsonObject} */ (this.config_));\n    this.config_ = null;\n    return report;\n  }\n}\n\n\n/**\n * A helper method that should be used by all extension elements to add their\n * sandbox analytics tracking. This method takes care of insert and remove the\n * analytics tracker at the right time of the element lifecycle.\n * @param {!AmpElement} element\n * @param {!Promise<!JsonObject>} promise\n */\nexport function useAnalyticsInSandbox(element, promise) {\n  let analyticsElement = null;\n  let configPromise = promise;\n  // Listener to LOAD_START signal. Insert analytics element on LOAD_START\n  element.signals().whenSignal(CommonSignals.LOAD_START).then(() => {\n    if (analyticsElement || !configPromise) {\n      return;\n    }\n    configPromise.then(config => {\n      if (!configPromise) {\n        // If config promise resolve after unload, do nothing.\n        return;\n      }\n      configPromise = null;\n      analyticsElement = insertAnalyticsElement(element, config, false);\n    });\n  });\n\n  // Listener to UNLOAD signal. Destroy remove element on UNLOAD\n  element.signals().whenSignal(CommonSignals.UNLOAD).then(() => {\n    configPromise = null;\n    if (analyticsElement) {\n      removeElement(analyticsElement);\n      analyticsElement = null;\n    }\n  });\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CommonSignals} from './common-signals';\nimport {Observable} from './observable';\nimport {Services} from './services';\nimport {Signals} from './utils/signals';\nimport {closestBySelector, escapeHtml} from './dom';\nimport {dev, rethrowAsync, user} from './log';\nimport {disposeServicesForEmbed, getTopWindow} from './service';\nimport {isDocumentReady} from './document-ready';\nimport {layoutRectLtwh, moveLayoutRect} from './layout-rect';\nimport {loadPromise} from './event-helper';\nimport {\n  px,\n  resetStyles,\n  setImportantStyles,\n  setStyle,\n  setStyles,\n} from './style';\nimport {toWin} from './types';\n\n\n/** @const {string} */\nconst EMBED_PROP = '__AMP_EMBED__';\n\n/** @const {!Array<string>} */\nconst EXCLUDE_INI_LOAD =\n    ['AMP-AD', 'AMP-ANALYTICS', 'AMP-PIXEL', 'AMP-AD-EXIT'];\n\n\n/**\n * Parameters used to create the new \"friendly iframe\" embed.\n * - html: The complete content of an AMP embed, which is itself an AMP\n *   document. Can include whatever is normally allowed in an AMP document,\n *   except for AMP `<script>` declarations. Those should be passed as an\n *   array of `extensionIds`.\n * - extensionsIds: An optional array of AMP extension IDs used in this embed.\n * - fonts: An optional array of fonts used in this embed.\n *\n * @typedef {{\n *   host: (?AmpElement|undefined),\n *   url: string,\n *   html: string,\n *   extensionIds: (?Array<string>|undefined),\n *   fonts: (?Array<string>|undefined),\n * }}\n */\nexport let FriendlyIframeSpec;\n\n\n/**\n * @type {boolean|undefined}\n * @visibleForTesting\n */\nlet srcdocSupported;\n\n/**\n * @param {boolean|undefined} val\n * @visibleForTesting\n */\nexport function setSrcdocSupportedForTesting(val) {\n  srcdocSupported = val;\n}\n\n/**\n * Returns `true` if the Friendly Iframes are supported.\n * @return {boolean}\n */\nfunction isSrcdocSupported() {\n  if (srcdocSupported === undefined) {\n    srcdocSupported = 'srcdoc' in HTMLIFrameElement.prototype;\n  }\n  return srcdocSupported;\n}\n\n\n/**\n * Sets whether the embed is currently visible. The interpretation of visibility\n * is up to the embed parent. However, most of typical cases would rely on\n * whether the embed is currently in the viewport.\n * @param {!FriendlyIframeEmbed} embed\n * @param {boolean} visible\n * TODO(dvoytenko): Re-evaluate and probably drop once layers are ready.\n */\nexport function setFriendlyIframeEmbedVisible(embed, visible) {\n  embed.setVisible_(visible);\n}\n\n\n/**\n * Returns the embed created using `installFriendlyIframeEmbed` or `null`.\n * Caution: This will only return the FIE after the iframe has 'loaded'. If you\n * are checking before this signal you may be in a race condition that returns\n * null.\n * @param {!HTMLIFrameElement} iframe\n * @return {?FriendlyIframeEmbed}\n */\nexport function getFriendlyIframeEmbedOptional(iframe) {\n  return /** @type {?FriendlyIframeEmbed} */ (iframe[EMBED_PROP]);\n}\n\n\n/**\n * Creates the requested \"friendly iframe\" embed. Returns the promise that\n * will be resolved as soon as the embed is available. The actual\n * initialization of the embed will start as soon as the `iframe` is added\n * to the DOM.\n * @param {!HTMLIFrameElement} iframe\n * @param {!Element} container\n * @param {!FriendlyIframeSpec} spec\n * @param {function(!Window)=} opt_preinstallCallback\n * @return {!Promise<!FriendlyIframeEmbed>}\n */\nexport function installFriendlyIframeEmbed(iframe, container, spec,\n  opt_preinstallCallback) {\n  /** @const {!Window} */\n  const win = getTopWindow(toWin(iframe.ownerDocument.defaultView));\n  /** @const {!./service/extensions-impl.Extensions} */\n  const extensions = Services.extensionsFor(win);\n\n  setStyle(iframe, 'visibility', 'hidden');\n  iframe.setAttribute('referrerpolicy', 'unsafe-url');\n\n  // Pre-load extensions.\n  if (spec.extensionIds) {\n    spec.extensionIds.forEach(\n        extensionId => extensions.preloadExtension(extensionId));\n  }\n\n  const html = mergeHtml(spec);\n\n  // Receive the signal when iframe is ready: it's document is formed.\n  iframe.onload = () => {\n    // Chrome does not reflect the iframe readystate.\n    iframe.readyState = 'complete';\n  };\n  const registerViolationListener = () => {\n    iframe.contentWindow.addEventListener('securitypolicyviolation',\n        violationEvent => {\n          dev().warn('FIE', 'security policy violation', violationEvent);\n        });\n  };\n  let loadedPromise;\n  if (isSrcdocSupported()) {\n    iframe.srcdoc = html;\n    loadedPromise = loadPromise(iframe);\n    container.appendChild(iframe);\n    registerViolationListener();\n  } else {\n    iframe.src = 'about:blank';\n    container.appendChild(iframe);\n    const childDoc = iframe.contentWindow.document;\n    childDoc.open();\n    registerViolationListener();\n    childDoc.write(html);\n    // With document.write, `iframe.onload` arrives almost immediately, thus\n    // we need to wait for child's `window.onload`.\n    loadedPromise = loadPromise(iframe.contentWindow);\n    childDoc.close();\n  }\n\n  // Wait for document ready signal.\n  // This is complicated due to crbug.com/649201 on Chrome and a similar issue\n  // on Safari where newly created document's `readyState` immediately equals\n  // `complete`, even though the document itself is not yet available. There's\n  // no other reliable signal for `readyState` in a child window and thus\n  // we have to fallback to polling.\n  let readyPromise;\n  if (isIframeReady(iframe)) {\n    readyPromise = Promise.resolve();\n  } else {\n    readyPromise = new Promise(resolve => {\n      /** @const {number} */\n      const interval = win.setInterval(() => {\n        if (isIframeReady(iframe)) {\n          resolve();\n          win.clearInterval(interval);\n        }\n      }, /* milliseconds */ 5);\n\n      // For safety, make sure we definitely stop polling when child doc is\n      // loaded.\n      loadedPromise.catch(error => {\n        rethrowAsync(error);\n      }).then(() => {\n        resolve();\n        win.clearInterval(interval);\n      });\n    });\n  }\n\n  return readyPromise.then(() => {\n    const embed = new FriendlyIframeEmbed(iframe, spec, loadedPromise);\n    iframe[EMBED_PROP] = embed;\n\n    const childWin = /** @type {!Window} */ (iframe.contentWindow);\n    // Add extensions.\n    extensions.installExtensionsInChildWindow(\n        childWin, spec.extensionIds || [], opt_preinstallCallback);\n    // Ready to be shown.\n    embed.startRender_();\n    return embed;\n  });\n}\n\n\n/**\n * Returns `true` when iframe is ready.\n * @param {!HTMLIFrameElement} iframe\n * @return {boolean}\n */\nfunction isIframeReady(iframe) {\n  // This is complicated due to crbug.com/649201 on Chrome and a similar issue\n  // on Safari where newly created document's `readyState` immediately equals\n  // `complete`, even though the document itself is not yet available. There's\n  // no other reliable signal for `readyState` in a child window and thus\n  // the best way to check is to see the contents of the body.\n  const childDoc = iframe.contentWindow && iframe.contentWindow.document;\n  return !!(childDoc &&\n      isDocumentReady(childDoc) &&\n      childDoc.body &&\n      childDoc.body.firstChild);\n}\n\n\n/**\n * Merges base and fonts into html document.\n * @param {!FriendlyIframeSpec} spec\n */\nfunction mergeHtml(spec) {\n  const originalHtml = spec.html;\n  const originalHtmlUp = originalHtml.toUpperCase();\n\n  // Find the insertion point.\n  let ip = originalHtmlUp.indexOf('<HEAD');\n  if (ip != -1) {\n    ip = originalHtmlUp.indexOf('>', ip + 1) + 1;\n  }\n  if (ip == -1) {\n    ip = originalHtmlUp.indexOf('<BODY');\n  }\n  if (ip == -1) {\n    ip = originalHtmlUp.indexOf('<HTML');\n    if (ip != -1) {\n      ip = originalHtmlUp.indexOf('>', ip + 1) + 1;\n    }\n  }\n\n  const result = [];\n\n  // Preambule.\n  if (ip > 0) {\n    result.push(originalHtml.substring(0, ip));\n  }\n\n  // Add <BASE> tag.\n  result.push(`<base href=\"${escapeHtml(spec.url)}\">`);\n\n  // Load fonts.\n  if (spec.fonts) {\n    spec.fonts.forEach(font => {\n      result.push(\n          `<link href=\"${escapeHtml(font)}\" rel=\"stylesheet\" type=\"text/css\">`);\n    });\n  }\n\n  // Load CSP\n  result.push('<meta http-equiv=Content-Security-Policy ' +\n      'content=\"script-src \\'none\\';object-src \\'none\\';child-src \\'none\\'\">');\n\n  // Postambule.\n  if (ip > 0) {\n    result.push(originalHtml.substring(ip));\n  } else {\n    result.push(originalHtml);\n  }\n\n  return result.join('');\n}\n\n\n/**\n * Exposes `mergeHtml` for testing purposes.\n * @param {!FriendlyIframeSpec} spec\n * @visibleForTesting\n */\nexport function mergeHtmlForTesting(spec) {\n  return mergeHtml(spec);\n}\n\n\n/**\n * A \"friendly iframe\" embed. This is the iframe that's fully accessible to\n * the AMP runtime. It's similar to Shadow DOM in many respects, but it also\n * provides iframe/viewport measurements and enables the use of `vh`, `vw` and\n * `@media` CSS.\n *\n * The friendly iframe is managed by the top-level AMP Runtime. When it's\n * destroyed, the `destroy` method must be called to free up the shared\n * resources.\n */\nexport class FriendlyIframeEmbed {\n\n  /**\n   * @param {!HTMLIFrameElement} iframe\n   * @param {!FriendlyIframeSpec} spec\n   * @param {!Promise} loadedPromise\n   */\n  constructor(iframe, spec, loadedPromise) {\n    /** @const {!HTMLIFrameElement} */\n    this.iframe = iframe;\n\n    /** @const {!Window} */\n    this.win = /** @type{!Window} */(iframe.contentWindow);\n\n    /** @const {!FriendlyIframeSpec} */\n    this.spec = spec;\n\n    /** @const {?AmpElement} */\n    this.host = spec.host || null;\n\n    /** @const @private {time} */\n    this.startTime_ = Date.now();\n\n    /**\n     * Starts out as invisible. The interpretation of this flag is up to\n     * the emded parent.\n     * @private {boolean}\n     */\n    this.visible_ = false;\n\n    /** @private {!Observable<boolean>} */\n    this.visibilityObservable_ = new Observable();\n\n    /** @private @const */\n    this.signals_ = this.host ? this.host.signals() : new Signals();\n\n    /** @private @const {!Promise} */\n    this.winLoadedPromise_ = Promise.all([loadedPromise, this.whenReady()]);\n  }\n\n  /**\n   * Ensures that all resources from this iframe have been released.\n   */\n  destroy() {\n    Services.resourcesForDoc(this.iframe).removeForChildWindow(this.win);\n    disposeServicesForEmbed(this.win);\n  }\n\n  /**\n   * @return {time}\n   */\n  getStartTime() {\n    return this.startTime_;\n  }\n\n  /**\n   * Returns the base URL for the embedded document.\n   * @return {string}\n   */\n  getUrl() {\n    return this.spec.url;\n  }\n\n  /** @return {!Signals} */\n  signals() {\n    return this.signals_;\n  }\n\n  /**\n   * Returns a promise that will resolve when the embed document is ready.\n   * Notice that this signal coincides with the embed's `render-start`.\n   * @return {!Promise}\n   */\n  whenReady() {\n    return this.signals_.whenSignal(CommonSignals.RENDER_START);\n  }\n\n  /**\n   * Returns a promise that will resolve when the child window's `onload` event\n   * has been emitted. In friendly iframes this typically only includes font\n   * loading.\n   * @return {!Promise}\n   */\n  whenWindowLoaded() {\n    return this.winLoadedPromise_;\n  }\n\n  /**\n   * Returns a promise that will resolve when the initial load  of the embed's\n   * content has been completed.\n   * @return {!Promise}\n   */\n  whenIniLoaded() {\n    return this.signals_.whenSignal(CommonSignals.INI_LOAD);\n  }\n\n  /**\n   * @private\n   * @restricted\n   */\n  startRender_() {\n    if (this.host) {\n      this.host.renderStarted();\n    } else {\n      this.signals_.signal(CommonSignals.RENDER_START);\n    }\n    setStyle(this.iframe, 'visibility', '');\n    if (this.win.document && this.win.document.body) {\n      this.win.document.documentElement.classList.add('i-amphtml-fie');\n      setStyles(dev().assertElement(this.win.document.body), {\n        opacity: 1,\n        visibility: 'visible',\n        animation: 'none',\n      });\n    }\n\n    // Initial load signal signal.\n    let rect;\n    if (this.host) {\n      rect = this.host.getLayoutBox();\n    } else {\n      rect = layoutRectLtwh(\n          0, 0,\n          this.win./*OK*/innerWidth,\n          this.win./*OK*/innerHeight);\n    }\n    Promise.all([\n      this.whenReady(),\n      whenContentIniLoad(this.iframe, this.win, rect),\n    ]).then(() => {\n      this.signals_.signal(CommonSignals.INI_LOAD);\n    });\n  }\n\n  /**\n   * Whether the embed is currently visible. The interpretation of visibility\n   * is up to the embed parent. However, most of typical cases would rely on\n   * whether the embed is currently in the viewport.\n   * @return {boolean}\n   * TODO(dvoytenko): Re-evaluate and probably drop once layers are ready.\n   */\n  isVisible() {\n    return this.visible_;\n  }\n\n  /**\n   * See `isVisible` for more info.\n   * @param {function(boolean)} handler\n   * @return {!UnlistenDef}\n   */\n  onVisibilityChanged(handler) {\n    return this.visibilityObservable_.add(handler);\n  }\n\n  /**\n   * @param {boolean} visible\n   * @private\n   * @restricted\n   */\n  setVisible_(visible) {\n    if (this.visible_ != visible) {\n      this.visible_ = visible;\n      this.visibilityObservable_.fire(this.visible_);\n    }\n  }\n\n  /**\n   * @return {!HTMLBodyElement}\n   * @visibleForTesting\n   */\n  getBodyElement() {\n    return /** @type {!HTMLBodyElement} */ (\n      (this.iframe.contentDocument || this.iframe.contentWindow.document)\n          .body);\n  }\n\n  /**\n   * @return {!./service/resources-impl.Resources}\n   * @private\n   */\n  getResources_() {\n    return Services.resourcesForDoc(this.iframe);\n  }\n\n  /**\n   * Runs a measure/mutate cycle ensuring that the iframe change is propagated\n   * to the resource manager.\n   * @param {{measure: (function()|undefined), mutate: function()}} task\n   * @return {!Promise}\n   * @private\n   */\n  measureMutate_(task) {\n    return this.getResources_().measureMutateElement(this.iframe,\n        task.measure || null, task.mutate);\n  }\n\n  /**\n   * @return {!Promise}\n   */\n  enterFullOverlayMode() {\n    const ampAdParent = dev().assertElement(this.iframe.parentNode);\n\n    // Security assertion. Otherwise any 3p frame could request lighbox mode.\n    user().assert(ampAdParent.tagName.toLowerCase() == 'amp-ad',\n        'Only <amp-ad> is allowed to enter lightbox mode.');\n\n    const bodyStyle = {\n      'background': 'transparent',\n      'position': 'absolute',\n      'bottom': 'auto',\n      'right': 'auto',\n\n      // Set for replacing with vsync values.\n      'top': '',\n      'left': '',\n      'width': '',\n      'height': '',\n    };\n\n    const iframeStyle = {\n      'position': 'fixed',\n      'left': 0,\n      'right': 0,\n      'bottom': 0,\n      'width': '100vw',\n      'top': 0,\n      'height': '100vh',\n    };\n\n    return this.measureMutate_({\n      measure: () => {\n        const rect = this.host ?\n          this.host.getLayoutBox() :\n          this.iframe./*OK*/getBoundingClientRect();\n\n        // Offset by scroll top as iframe will be position: fixed.\n        const dy = -Services.viewportForDoc(this.iframe).getScrollTop();\n        const {top, left, width, height} = moveLayoutRect(rect, /* dx */ 0, dy);\n\n        // Offset body by header height to prevent visual jump.\n        Object.assign(bodyStyle, {\n          'top': px(top),\n          'left': px(left),\n          'width': px(width),\n          'height': px(height),\n        });\n      },\n      mutate: () => {\n        // !important to prevent abuse e.g. box @ ltwh = 0, 0, 0, 0\n        setImportantStyles(this.iframe, iframeStyle);\n\n        // We need to override runtime-level !important rules\n        setImportantStyles(this.getBodyElement(), bodyStyle);\n      },\n    });\n  }\n\n  /**\n   * @return {!Promise}\n   */\n  leaveFullOverlayMode() {\n    return this.measureMutate_({\n      mutate: () => {\n        resetStyles(this.iframe, [\n          'position',\n          'left',\n          'right',\n          'top',\n          'bottom',\n          'width',\n          'height',\n        ]);\n\n        // we're not resetting background here as we need to set it to\n        // transparent permanently.\n        resetStyles(this.getBodyElement(), [\n          'position',\n          'top',\n          'left',\n          'width',\n          'height',\n          'bottom',\n          'right',\n        ]);\n      },\n    });\n  }\n}\n\n/**\n * Returns the promise that will be resolved when all content elements\n * have been loaded in the initially visible set.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {!Window} hostWin\n * @param {!./layout-rect.LayoutRectDef} rect\n * @return {!Promise}\n */\nexport function whenContentIniLoad(elementOrAmpDoc, hostWin, rect) {\n  return Services.resourcesForDoc(elementOrAmpDoc)\n      .getResourcesInRect(hostWin, rect)\n      .then(resources => {\n        const promises = [];\n        resources.forEach(r => {\n          if (!EXCLUDE_INI_LOAD.includes(r.element.tagName)) {\n            promises.push(r.loadedOnce());\n          }\n        });\n        return Promise.all(promises);\n      });\n}\n\n/**\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isInFie(element) {\n  return !!closestBySelector(element, '.i-amphtml-fie');\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {DomFingerprint} from './utils/dom-fingerprint';\nimport {Services} from './services';\nimport {dict} from './utils/object.js';\nimport {experimentToggles, isCanary} from './experiments';\nimport {getLengthNumeral} from './layout';\nimport {getModeObject} from './mode-object';\nimport {urls} from './config';\n\n/**\n * Produces the attributes for the ad template.\n * @param {!Window} parentWindow\n * @param {!AmpElement} element\n * @param {string} sentinel\n * @param {!JsonObject=} attributes\n * @return {!JsonObject}\n */\nexport function getContextMetadata(\n  parentWindow, element, sentinel, attributes) {\n  const startTime = Date.now();\n  const width = element.getAttribute('width');\n  const height = element.getAttribute('height');\n  attributes = attributes ? attributes : dict();\n  attributes['width'] = getLengthNumeral(width);\n  attributes['height'] = getLengthNumeral(height);\n  if (element.getAttribute('title')) {\n    attributes['title'] = element.getAttribute('title');\n  }\n  let locationHref = parentWindow.location.href;\n  // This is really only needed for tests, but whatever. Children\n  // see us as the logical origin, so telling them we are about:srcdoc\n  // will fail ancestor checks.\n  if (locationHref == 'about:srcdoc') {\n    locationHref = parentWindow.parent.location.href;\n  }\n\n  const docInfo = Services.documentInfoForDoc(element);\n  const viewer = Services.viewerForDoc(element);\n  const referrer = viewer.getUnconfirmedReferrerUrl();\n\n  // TODO(alanorozco): Redesign data structure so that fields not exposed by\n  // AmpContext are not part of this object.\n  const layoutRect = element.getPageLayoutBox();\n  attributes['_context'] = dict({\n    'ampcontextVersion': '$internalRuntimeVersion$',\n    'ampcontextFilepath': urls.thirdParty + '/$internalRuntimeVersion$' +\n        '/ampcontext-v0.js',\n    'sourceUrl': docInfo.sourceUrl,\n    'referrer': referrer,\n    'canonicalUrl': docInfo.canonicalUrl,\n    'pageViewId': docInfo.pageViewId,\n    'location': {\n      'href': locationHref,\n    },\n    'startTime': startTime,\n    'tagName': element.tagName,\n    'mode': getModeObject(),\n    'canary': isCanary(parentWindow),\n    'hidden': !viewer.isVisible(),\n    'initialLayoutRect': layoutRect ? {\n      'left': layoutRect.left,\n      'top': layoutRect.top,\n      'width': layoutRect.width,\n      'height': layoutRect.height,\n    } : null,\n    'initialIntersection': element.getIntersectionChangeEntry(),\n    'domFingerprint': DomFingerprint.generate(element),\n    'experimentToggles': experimentToggles(parentWindow),\n    'sentinel': sentinel,\n  });\n  const adSrc = element.getAttribute('src');\n  if (adSrc) {\n    attributes['src'] = adSrc;\n  }\n  return attributes;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {addAttributesToElement, closestBySelector} from './dom';\nimport {deserializeMessage, isAmpMessage} from './3p-frame-messaging';\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {filterSplice} from './utils/array';\nimport {getData} from './event-helper';\nimport {parseUrlDeprecated} from './url';\nimport {setStyle} from './style';\nimport {tryParseJson} from './json';\n\n/**\n * Sentinel used to force unlistening after a iframe is detached.\n * @type {string}\n */\nconst UNLISTEN_SENTINEL = 'unlisten';\n\n/**\n * @typedef {{\n *   frame: !Element,\n *   events: !Object<string, !Array<function(!JsonObject)>>\n * }}\n */\nlet WindowEventsDef;\n\n/**\n * Returns a mapping from a URL's origin to an array of windows and their\n * listenFor listeners.\n * @param {?Window} parentWin the window that created the iframe\n * @param {boolean=} opt_create create the mapping if it does not exist\n * @return {?Object<string, !Array<!WindowEventsDef>>}\n */\nfunction getListenFors(parentWin, opt_create) {\n  let {listeningFors} = parentWin;\n\n  if (!listeningFors && opt_create) {\n    listeningFors = parentWin.listeningFors = Object.create(null);\n  }\n  return listeningFors || null;\n}\n\n/**\n * Returns an array of WindowEventsDef that have had any listenFor listeners\n * registered for this sentinel.\n * @param {?Window} parentWin the window that created the iframe\n * @param {string} sentinel the sentinel of the message\n * @param {boolean=} opt_create create the array if it does not exist\n * @return {?Array<!WindowEventsDef>}\n */\nfunction getListenForSentinel(parentWin, sentinel, opt_create) {\n  const listeningFors = getListenFors(parentWin, opt_create);\n  if (!listeningFors) {\n    return listeningFors;\n  }\n\n  let listenSentinel = listeningFors[sentinel];\n  if (!listenSentinel && opt_create) {\n    listenSentinel = listeningFors[sentinel] = [];\n  }\n  return listenSentinel || null;\n}\n\n/**\n * Returns an mapping of event names to listenFor listeners.\n * @param {?Window} parentWin the window that created the iframe\n * @param {!Element} iframe the iframe element who's context will trigger the\n *     event\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n * @return {?Object<string, !Array<function(!JsonObject, !Window, string)>>}\n */\nfunction getOrCreateListenForEvents(parentWin, iframe, opt_is3P) {\n  const {origin} = parseUrlDeprecated(iframe.src);\n  const sentinel = getSentinel_(iframe, opt_is3P);\n  const listenSentinel = getListenForSentinel(parentWin, sentinel, true);\n\n  let windowEvents;\n  for (let i = 0; i < listenSentinel.length; i++) {\n    const we = listenSentinel[i];\n    if (we.frame === iframe) {\n      windowEvents = we;\n      break;\n    }\n  }\n\n  if (!windowEvents) {\n    windowEvents = {\n      frame: iframe,\n      origin,\n      events: Object.create(null),\n    };\n    listenSentinel.push(windowEvents);\n  }\n\n  return windowEvents.events;\n}\n\n/**\n * Returns an mapping of event names to listenFor listeners.\n * @param {?Window} parentWin the window that created the iframe\n * @param {string} sentinel the sentinel of the message\n * @param {string} origin the source window's origin\n * @param {?Window} triggerWin the window that triggered the event\n * @return {?Object<string, !Array<function(!JsonObject, !Window, string)>>}\n */\nfunction getListenForEvents(parentWin, sentinel, origin, triggerWin) {\n  const listenSentinel = getListenForSentinel(parentWin, sentinel);\n\n  if (!listenSentinel) {\n    return listenSentinel;\n  }\n\n  // Find the entry for the frame.\n  // TODO(@nekodo): Add a WeakMap<Window, WindowEventsDef> cache to\n  //     speed up this process.\n  let windowEvents;\n  for (let i = 0; i < listenSentinel.length; i++) {\n    const we = listenSentinel[i];\n    const {contentWindow} = we.frame;\n    if (!contentWindow) {\n      setTimeout(dropListenSentinel, 0, listenSentinel);\n    } else if (sentinel === 'amp') {\n      // A non-3P code path, origin must match.\n      if (we.origin === origin && contentWindow == triggerWin) {\n        windowEvents = we;\n        break;\n      }\n    } else if (triggerWin == contentWindow ||\n        isDescendantWindow(contentWindow, triggerWin)) {\n      // 3p code path, we may accept messages from nested frames.\n      windowEvents = we;\n      break;\n    }\n  }\n\n  return windowEvents ? windowEvents.events : null;\n}\n\n/**\n * Checks whether one window is a descendant of another by climbing\n * the parent chain.\n * @param {?Window} ancestor potential ancestor window\n * @param {?Window} descendant potential descendant window\n * @return {boolean}\n */\nfunction isDescendantWindow(ancestor, descendant) {\n  for (let win = descendant; win && win != win.parent; win = win.parent) {\n    if (win == ancestor) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Removes any listenFors registed on listenSentinel that do not have\n * a contentWindow (the frame was removed from the DOM tree).\n * @param {!Array<!WindowEventsDef>} listenSentinel\n */\nfunction dropListenSentinel(listenSentinel) {\n  const noopData = dict({'sentinel': UNLISTEN_SENTINEL});\n\n  for (let i = listenSentinel.length - 1; i >= 0; i--) {\n    const windowEvents = listenSentinel[i];\n\n    if (!windowEvents.frame.contentWindow) {\n      listenSentinel.splice(i, 1);\n\n      const {events} = windowEvents;\n      for (const name in events) {\n        // Splice here, so that each unlisten does not shift the array\n        events[name].splice(0, Infinity).forEach(event => {\n          event(noopData);\n        });\n      }\n    }\n  }\n}\n\n/**\n * Registers the global listenFor event listener if it has yet to be.\n * @param {?Window} parentWin\n */\nfunction registerGlobalListenerIfNeeded(parentWin) {\n  if (parentWin.listeningFors) {\n    return;\n  }\n  const listenForListener = function(event) {\n    if (!getData(event)) {\n      return;\n    }\n    const data = parseIfNeeded(getData(event));\n    if (!data || !data['sentinel']) {\n      return;\n    }\n\n    const listenForEvents = getListenForEvents(\n        parentWin,\n        data['sentinel'],\n        event.origin,\n        event.source\n    );\n    if (!listenForEvents) {\n      return;\n    }\n\n    let listeners = listenForEvents[data['type']];\n    if (!listeners) {\n      return;\n    }\n\n    // We slice to avoid issues with adding another listener or unlistening\n    // during iteration. We could move to a Doubly Linked List with\n    // backtracking, but that's overly complicated.\n    listeners = listeners.slice();\n    for (let i = 0; i < listeners.length; i++) {\n      const listener = listeners[i];\n      listener(data, event.source, event.origin);\n    }\n  };\n\n  parentWin.addEventListener('message', listenForListener);\n}\n\n/**\n * Allows listening for message from the iframe. Returns an unlisten\n * function to remove the listener.\n *\n * @param {?Element} iframe\n * @param {string} typeOfMessage\n * @param {?function(!JsonObject, !Window, string)} callback Called when a\n *     message of this type arrives for this iframe.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n * @param {boolean=} opt_includingNestedWindows set to true if a messages from\n *     nested frames should also be accepted.\n * @return {!UnlistenDef}\n */\nexport function listenFor(\n  iframe, typeOfMessage, callback, opt_is3P, opt_includingNestedWindows) {\n  dev().assert(iframe.src, 'only iframes with src supported');\n  dev().assert(!iframe.parentNode, 'cannot register events on an attached ' +\n      'iframe. It will cause hair-pulling bugs like #2942');\n  dev().assert(callback);\n  const parentWin = iframe.ownerDocument.defaultView;\n\n  registerGlobalListenerIfNeeded(parentWin);\n\n  const listenForEvents = getOrCreateListenForEvents(\n      parentWin,\n      iframe,\n      opt_is3P\n  );\n\n\n  let events = listenForEvents[typeOfMessage] ||\n    (listenForEvents[typeOfMessage] = []);\n\n  let unlisten;\n  let listener = function(data, source, origin) {\n    // Exclude nested frames if necessary.\n    // Note that the source was already verified to be either the contentWindow\n    // of the iframe itself or a descendant window within it.\n    if (!opt_includingNestedWindows && source != iframe.contentWindow) {\n      return;\n    }\n\n    if (data.sentinel == UNLISTEN_SENTINEL) {\n      unlisten();\n      return;\n    }\n    callback(data, source, origin);\n  };\n\n  events.push(listener);\n\n  return unlisten = function() {\n    if (listener) {\n      const index = events.indexOf(listener);\n      if (index > -1) {\n        events.splice(index, 1);\n      }\n      // Make sure references to the unlisten function do not keep\n      // alive too much.\n      listener = null;\n      events = null;\n      callback = null;\n    }\n  };\n}\n\n/**\n * Returns a promise that resolves when one of given messages has been observed\n * for the first time. And remove listener for all other messages.\n * @param {!Element} iframe\n * @param {string|!Array<string>} typeOfMessages\n * @param {boolean=} opt_is3P\n * @return {!Promise<!{data: !JsonObject, source: !Window, origin: string}>}\n */\nexport function listenForOncePromise(iframe, typeOfMessages, opt_is3P) {\n  const unlistenList = [];\n  if (typeof typeOfMessages == 'string') {\n    typeOfMessages = [typeOfMessages];\n  }\n  return new Promise(resolve => {\n    for (let i = 0; i < typeOfMessages.length; i++) {\n      const message = typeOfMessages[i];\n      const unlisten = listenFor(iframe, message, (data, source, origin) => {\n        for (let i = 0; i < unlistenList.length; i++) {\n          unlistenList[i]();\n        }\n        resolve({data, source, origin});\n      }, opt_is3P);\n      unlistenList.push(unlisten);\n    }\n  });\n}\n\n/**\n * Posts a message to the iframe.\n * @param {!Element} iframe The iframe.\n * @param {string} type Type of the message.\n * @param {!JsonObject} object Message payload.\n * @param {string} targetOrigin origin of the target.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n */\nexport function postMessage(iframe, type, object, targetOrigin, opt_is3P) {\n  postMessageToWindows(iframe,\n      [{win: iframe.contentWindow, origin: targetOrigin}], type, object,\n      opt_is3P);\n}\n\n/**\n * Posts an identical message to multiple target windows with the same\n * sentinel.\n * The message is serialized only once.\n * @param {!Element} iframe The iframe.\n * @param {!Array<{win: !Window, origin: string}>} targets to send the message\n *     to, pairs of window and its origin.\n * @param {string} type Type of the message.\n * @param {!JsonObject} object Message payload.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n */\nexport function postMessageToWindows(iframe, targets, type, object, opt_is3P) {\n  if (!iframe.contentWindow) {\n    return;\n  }\n  object['type'] = type;\n  object['sentinel'] = getSentinel_(iframe, opt_is3P);\n  let payload = object;\n  if (opt_is3P) {\n    // Serialize ourselves because that is much faster in Chrome.\n    payload = 'amp-' + JSON.stringify(object);\n  }\n  for (let i = 0; i < targets.length; i++) {\n    const target = targets[i];\n    target.win./*OK*/postMessage(payload, target.origin);\n  }\n}\n\n/**\n * Gets the sentinel string.\n * @param {!Element} iframe The iframe.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n * @return {string} Sentinel string.\n * @private\n */\nfunction getSentinel_(iframe, opt_is3P) {\n  return opt_is3P ? iframe.getAttribute('data-amp-3p-sentinel') : 'amp';\n}\n\n/**\n * JSON parses event.data if it needs to be\n * @param {*} data\n * @return {?JsonObject} object message\n * @private\n * @visibleForTesting\n */\nexport function parseIfNeeded(data) {\n  if (typeof data == 'string') {\n    if (data.charAt(0) == '{') {\n      data = tryParseJson(data, e => {\n        dev().warn('IFRAME-HELPER',\n            'Postmessage could not be parsed. ' +\n            'Is it in a valid JSON format?', e);\n      }) || null;\n    } else if (isAmpMessage(data)) {\n      data = deserializeMessage(data);\n    } else {\n      data = null;\n    }\n  }\n  return /** @type {?JsonObject} */ (data);\n}\n\n\n\n/**\n * Manages a postMessage API for an iframe with a subscription message and\n * a way to broadcast messages to all subscribed windows, which\n * in turn must all be descendants of the contentWindow of the iframe.\n */\nexport class SubscriptionApi {\n  /**\n   * @param {!Element} iframe The iframe.\n   * @param {string} type Type of the subscription message.\n   * @param {boolean} is3p set to true if the iframe is 3p.\n   * @param {function(!JsonObject, !Window, string)} requestCallback Callback\n   *     invoked whenever a new window subscribes.\n   */\n  constructor(iframe, type, is3p, requestCallback) {\n    /** @private @const {!Element} */\n    this.iframe_ = iframe;\n    /** @private @const {boolean} */\n    this.is3p_ = is3p;\n    /** @private @const {!Array<{win: !Window, origin: string}>} */\n    this.clientWindows_ = [];\n\n    /** @private @const {!UnlistenDef} */\n    this.unlisten_ = listenFor(this.iframe_, type, (data, source, origin) => {\n      // This message might be from any window within the iframe, we need\n      // to keep track of which windows want to be sent updates.\n      if (!this.clientWindows_.some(entry => entry.win == source)) {\n        this.clientWindows_.push({win: source, origin});\n      }\n      requestCallback(data, source, origin);\n    }, this.is3p_,\n        // For 3P frames we also allow nested frames within them to subscribe..\n    this.is3p_ /* opt_includingNestedWindows */);\n  }\n\n  /**\n   * Sends a message to all subscribed windows.\n   * @param {string} type Type of the message.\n   * @param {!JsonObject} data Message payload.\n   */\n  send(type, data) {\n    // Remove clients that have been removed from the DOM.\n    filterSplice(this.clientWindows_, client => !!client.win.parent);\n    postMessageToWindows(\n        this.iframe_,\n        this.clientWindows_,\n        type,\n        data,\n        this.is3p_);\n  }\n\n  /**\n   * Destroys iframe.\n   */\n  destroy() {\n    this.unlisten_();\n    this.clientWindows_.length = 0;\n  }\n}\n\n/**\n * @param {!Element} element\n * @return {boolean}\n */\nexport function looksLikeTrackingIframe(element) {\n  const box = element.getLayoutBox();\n  // This heuristic is subject to change.\n  if (box.width > 10 || box.height > 10) {\n    return false;\n  }\n  // Iframe is not tracking iframe if open with user interaction\n  return !closestBySelector(element, '.i-amphtml-overlay');\n}\n\n// Most common ad sizes\n// Array of [width, height] pairs.\nconst adSizes = [\n  [300, 250],\n  [320, 50],\n  [300, 50],\n  [320, 100],\n];\n\n/**\n * Guess whether this element might be an ad.\n * @param {!Element} element An amp-iframe element.\n * @return {boolean}\n * @visibleForTesting\n */\nexport function isAdLike(element) {\n  const box = element.getLayoutBox();\n  const {height, width} = box;\n  for (let i = 0; i < adSizes.length; i++) {\n    const refWidth = adSizes[i][0];\n    const refHeight = adSizes[i][1];\n    if (refHeight > height) {\n      continue;\n    }\n    if (refWidth > width) {\n      continue;\n    }\n    // Fuzzy matching to account for padding.\n    if (height - refHeight <= 20 && width - refWidth <= 20) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * @param {!Element} iframe\n * @private\n */\nexport function disableScrollingOnIframe(iframe) {\n  addAttributesToElement(iframe, dict({'scrolling': 'no'}));\n\n  // This shouldn't work, but it does on Firefox.\n  // https://stackoverflow.com/a/15494969\n  setStyle(iframe, 'overflow', 'hidden');\n\n  return iframe;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Deferred} from './utils/promise';\nimport {Services} from './services';\nimport {\n  addParamsToUrl,\n  isProxyOrigin,\n  parseQueryString,\n  parseUrlDeprecated,\n} from './url';\nimport {dev, user} from './log';\nimport {getMode} from './mode';\nimport {isExperimentOn} from './experiments';\n\nconst TIMEOUT_VALUE = 8000;\n\nlet trackImpressionPromise = null;\n\nconst DEFAULT_APPEND_URL_PARAM = [\n  'gclid',\n  'gclsrc',\n];\n\n/**\n * A function to get the trackImpressionPromise;\n * @return {!Promise}\n */\nexport function getTrackImpressionPromise() {\n  return dev().assert(trackImpressionPromise);\n}\n\n/**\n * Function that reset the trackImpressionPromise only for testing\n * @visibleForTesting\n */\nexport function resetTrackImpressionPromiseForTesting() {\n  trackImpressionPromise = null;\n}\n\n/**\n * Emit a HTTP request to a destination defined on the incoming URL.\n * Launched for trusted viewer. Otherwise guarded by experiment.\n * @param {!Window} win\n */\nexport function maybeTrackImpression(win) {\n  const deferred = new Deferred();\n  const {promise, resolve: resolveImpression} = deferred;\n\n\n  trackImpressionPromise = Services.timerFor(win).timeoutPromise(TIMEOUT_VALUE,\n      promise, 'TrackImpressionPromise timeout').catch(error => {\n    dev().warn('IMPRESSION', error);\n  });\n\n  const viewer = Services.viewerForDoc(win.document);\n  const isTrustedViewerPromise = viewer.isTrustedViewer();\n  const isTrustedReferrerPromise = viewer.isTrustedReferrer();\n  Promise.all([\n    isTrustedViewerPromise,\n    isTrustedReferrerPromise,\n  ]).then(results => {\n    const isTrustedViewer = results[0];\n    const isTrustedReferrer = results[1];\n    // Currently this feature is launched for trusted viewer and trusted\n    // referrer, but still experiment guarded for all AMP docs.\n    if (!isTrustedViewer && !isTrustedReferrer && !isExperimentOn(win, 'alp')) {\n      resolveImpression();\n      return;\n    }\n\n    const replaceUrlPromise = handleReplaceUrl(win);\n    const clickUrlPromise = handleClickUrl(win);\n\n    Promise.all([replaceUrlPromise, clickUrlPromise]).then(() => {\n      resolveImpression();\n    }, () => {});\n  });\n}\n\n/**\n * Signal that impression tracking is not relevant in this environment.\n */\nexport function doNotTrackImpression() {\n  trackImpressionPromise = Promise.resolve();\n}\n\n/**\n * Handle the getReplaceUrl and return a promise when url is replaced Only\n * handles replaceUrl when viewer indicates AMP to do so. Viewer should indicate\n * by setting the legacy replaceUrl init param and add `replaceUrl` to its\n * capability param. Future plan is to change the type of legacy init replaceUrl\n * param from url string to boolean value. Please NOTE replaceUrl and adLocation\n * will never arrive at same time, so there is no race condition on the order of\n * handling url replacement.\n * @param {!Window} win\n * @return {!Promise}\n */\nfunction handleReplaceUrl(win) {\n  const viewer = Services.viewerForDoc(win.document);\n\n  // ReplaceUrl substitution doesn't have to wait until the document is visible\n  if (!viewer.getParam('replaceUrl')) {\n    // The init replaceUrl param serve as a signal on whether replaceUrl is\n    // required for this doc.\n    return Promise.resolve();\n  }\n\n  if (!viewer.hasCapability('replaceUrl')) {\n    // If Viewer is not capability of providing async replaceUrl, use the legacy\n    // init replaceUrl param.\n    viewer.replaceUrl(viewer.getParam('replaceUrl') || null);\n    return Promise.resolve();\n  }\n\n  // request async replaceUrl is viewer support getReplaceUrl.\n  return viewer.sendMessageAwaitResponse('getReplaceUrl', /* data */ undefined)\n      .then(response => {\n        if (!response || typeof response != 'object') {\n          dev().warn('IMPRESSION', 'get invalid replaceUrl response');\n          return;\n        }\n        viewer.replaceUrl(response['replaceUrl'] || null);\n      }, err => {\n        dev().warn('IMPRESSION', 'Error request replaceUrl from viewer', err);\n      });\n}\n\n\n/**\n * Perform the impression request if it has been provided via\n * the click param in the viewer arguments. Returns a promise.\n * @param {!Window} win\n * @return {!Promise}\n */\nfunction handleClickUrl(win) {\n  const viewer = Services.viewerForDoc(win.document);\n  /** @const {string|undefined} */\n  const clickUrl = viewer.getParam('click');\n\n\n  if (!clickUrl) {\n    return Promise.resolve();\n  }\n\n  if (clickUrl.indexOf('https://') != 0) {\n    user().warn('IMPRESSION',\n        'click fragment param should start with https://. Found ',\n        clickUrl);\n    return Promise.resolve();\n  }\n\n  if (win.location.hash) {\n    // This is typically done using replaceState inside the viewer.\n    // If for some reason it failed, get rid of the fragment here to\n    // avoid duplicate tracking.\n    win.location.hash = '';\n  }\n\n  // TODO(@zhouyx) need test with a real response.\n  return viewer.whenFirstVisible().then(() => {\n    return invoke(win, dev().assertString(clickUrl));\n  }).then(response => {\n    applyResponse(win, response);\n  }).catch(err => {\n    user().warn('IMPRESSION', 'Error on request clickUrl: ', err);\n  });\n}\n\n/**\n * Send the url to ad server and wait for its response\n * @param {!Window} win\n * @param {string} clickUrl\n * @return {!Promise<?JsonObject>}\n */\nfunction invoke(win, clickUrl) {\n  if (getMode().localDev && !getMode().test) {\n    clickUrl = 'http://localhost:8000/impression-proxy?url=' + clickUrl;\n  }\n  return Services.xhrFor(win).fetchJson(clickUrl, {\n    credentials: 'include',\n    // All origins are allows to send these requests.\n    requireAmpResponseSourceOrigin: false,\n  }).then(res => {\n    // Treat 204 no content response specially\n    if (res.status == 204) {\n      return null;\n    }\n    return res.json();\n  });\n}\n\n/**\n * parse the response back from ad server\n * Set for analytics purposes\n * @param {!Window} win\n * @param {?JsonObject} response\n */\nfunction applyResponse(win, response) {\n  if (!response) {\n    return;\n  }\n\n  const adLocation = response['location'];\n  const adTracking = response['tracking_url'];\n\n  // If there is a tracking_url, need to track it\n  // Otherwise track the location\n  const trackUrl = adTracking || adLocation;\n\n  if (trackUrl && !isProxyOrigin(trackUrl)) {\n    // To request the provided trackUrl for tracking purposes.\n    new Image().src = trackUrl;\n  }\n\n  // Replace the location href params with new location params we get (if any).\n  if (adLocation) {\n    if (!win.history.replaceState) {\n      return;\n    }\n\n    const viewer = Services.viewerForDoc(win.document);\n    const currentHref = win.location.href;\n    const url = parseUrlDeprecated(adLocation);\n    const params = parseQueryString(url.search);\n    const newHref = addParamsToUrl(currentHref, params);\n    // TODO: Avoid overwriting the fragment parameter.\n    win.history.replaceState(null, '', newHref);\n    viewer.maybeUpdateFragmentForCct();\n  }\n}\n\n/**\n * Return a promise that whether appending extra url params to outgoing link is\n * required.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n * @return {!Promise<boolean>}\n */\nexport function shouldAppendExtraParams(ampdoc) {\n  return ampdoc.whenReady().then(() => {\n    return !!ampdoc.getBody().querySelector(\n        'amp-analytics[type=googleanalytics]');\n  });\n}\n\n/**\n * Return the extra url params string that should be appended to outgoing link\n * @param {!Window} win\n * @param {!Element} target\n * @return {string}\n */\nexport function getExtraParamsUrl(win, target) {\n  // Get an array with extra params that needs to append.\n  const url = parseUrlDeprecated(win.location.href);\n  const params = parseQueryString(url.search);\n  const appendParams = [];\n  for (let i = 0; i < DEFAULT_APPEND_URL_PARAM.length; i++) {\n    const param = DEFAULT_APPEND_URL_PARAM[i];\n    if (typeof params[param] !== 'undefined') {\n      appendParams.push(param);\n    }\n  }\n\n  // Check if the param already exists\n  const additionalUrlParams = target.getAttribute('data-amp-addparams');\n  let {href} = target;\n  if (additionalUrlParams) {\n    href = addParamsToUrl(href, parseQueryString(additionalUrlParams));\n  }\n  const loc = parseUrlDeprecated(href);\n  const existParams = parseQueryString(loc.search);\n  for (let i = appendParams.length - 1; i >= 0; i--) {\n    const param = appendParams[i];\n    if (typeof existParams[param] !== 'undefined') {\n      appendParams.splice(i, 1);\n    }\n  }\n  return getQueryParamUrl(appendParams);\n}\n\n/**\n * Helper method to convert an query param array to string\n * @param {!Array<string>} params\n * @return {string}\n */\nfunction getQueryParamUrl(params) {\n  let url = '';\n  for (let i = 0; i < params.length; i++) {\n    const param = params[i];\n    url += (i == 0) ?\n      `${param}=QUERY_PARAM(${param})` :\n      `&${param}=QUERY_PARAM(${param})`;\n  }\n  return url;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SubscriptionApi} from './iframe-helper';\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {isArray, isFiniteNumber} from './types';\nimport {layoutRectLtwh, moveLayoutRect, rectIntersection} from './layout-rect';\n\n/**\n * The structure that defines the rectangle used in intersection observers.\n *\n * @typedef {{\n *   top: number,\n *   bottom: number,\n *   left: number,\n *   right: number,\n *   width: number,\n *   height: number,\n *   x: number,\n *   y: number,\n * }}\n */\nexport let DOMRect;\n\nexport const DEFAULT_THRESHOLD =\n    [0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4,\n      0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1];\n\n/** @typedef {{\n *    element: !Element,\n *    currentThresholdSlot: number,\n *  }}\n */\nlet ElementIntersectionStateDef;\n\n/** @const @private */\nconst TAG = 'INTERSECTION-OBSERVER';\n\n/** @const @private */\nconst INIT_TIME = Date.now();\n\n/**\n * A function to get the element's current IntersectionObserverEntry\n * regardless of the intersetion ratio. Only available when element is not\n * nested in a container iframe.\n * TODO: support opt_iframe if there's valid use cases.\n * @param {!./layout-rect.LayoutRectDef} element element's rect\n * @param {?./layout-rect.LayoutRectDef} owner element's owner rect\n * @param {!./layout-rect.LayoutRectDef} hostViewport hostViewport's rect\n * @return {!IntersectionObserverEntry} A change entry.\n */\nexport function getIntersectionChangeEntry(\n  element, owner, hostViewport) {\n  const intersection = rectIntersection(element, owner, hostViewport) ||\n      layoutRectLtwh(0, 0, 0, 0);\n  const ratio = intersectionRatio(intersection, element);\n  return calculateChangeEntry(\n      element, hostViewport, intersection, ratio);\n}\n\n/**\n * @param {!Window} win\n * @return {boolean}\n */\nexport function nativeIntersectionObserverSupported(win) {\n  return 'IntersectionObserver' in win &&\n      'IntersectionObserverEntry' in win &&\n      'intersectionRatio' in win.IntersectionObserverEntry.prototype;\n}\n\n/**\n * A class to help amp-iframe and amp-ad nested iframe listen to intersection\n * change.\n */\nexport class IntersectionObserverApi {\n  /**\n   * @param {!AMP.BaseElement} baseElement\n   * @param {!Element} iframe\n   * @param {boolean=} opt_is3p\n   */\n  constructor(baseElement, iframe, opt_is3p) {\n    /** @private @const {!AMP.BaseElement} */\n    this.baseElement_ = baseElement;\n\n    /** @private {?IntersectionObserverPolyfill} */\n    this.intersectionObserver_ = null;\n\n    /** @private {boolean} */\n    this.shouldObserve_ = false;\n\n    /** @private {boolean} */\n    this.isInViewport_ = false;\n\n    /** @private {?function()} */\n    this.unlistenOnDestroy_ = null;\n\n    /** @private @const {!./service/viewport/viewport-impl.Viewport} */\n    this.viewport_ = baseElement.getViewport();\n\n    /** @private {?SubscriptionApi} */\n    this.subscriptionApi_ = new SubscriptionApi(\n        iframe, 'send-intersections', opt_is3p || false, () => {\n          this.startSendingIntersection_();\n        });\n\n    this.intersectionObserver_ = new IntersectionObserverPolyfill(entries => {\n      // Remove target info from cross origin iframe.\n      for (let i = 0; i < entries.length; i++) {\n        delete entries[i]['target'];\n      }\n      this.subscriptionApi_.send('intersection', dict({'changes': entries}));\n    }, {threshold: DEFAULT_THRESHOLD});\n    this.intersectionObserver_.tick(this.viewport_.getRect());\n\n    /** @const {function()} */\n    this.fire = () => {\n      if (!this.shouldObserve_ || !this.isInViewport_) {\n        return;\n      }\n      this.intersectionObserver_.tick(this.viewport_.getRect());\n    };\n  }\n\n  /**\n   * Function to start listening to viewport event. and observer intersection\n   * change on the element.\n   */\n  startSendingIntersection_() {\n    this.shouldObserve_ = true;\n    this.intersectionObserver_.observe(this.baseElement_.element);\n    this.baseElement_.getVsync().measure(() => {\n      this.isInViewport_ = this.baseElement_.isInViewport();\n      this.fire();\n    });\n\n    const unlistenViewportScroll = this.viewport_.onScroll(this.fire);\n    const unlistenViewportChange = this.viewport_.onChanged(this.fire);\n    this.unlistenOnDestroy_ = () => {\n      unlistenViewportScroll();\n      unlistenViewportChange();\n    };\n  }\n\n  /**\n   * Enable to the PositionObserver to listen to viewport events\n   * @param {boolean} inViewport\n   */\n  onViewportCallback(inViewport) {\n    this.isInViewport_ = inViewport;\n  }\n\n  /**\n   * Clean all listenrs\n   */\n  destroy() {\n    this.shouldObserve_ = false;\n    this.intersectionObserver_ = null;\n    if (this.unlistenOnDestroy_) {\n      this.unlistenOnDestroy_();\n      this.unlistenOnDestroy_ = null;\n    }\n    this.subscriptionApi_.destroy();\n    this.subscriptionApi_ = null;\n  }\n}\n\n\n/**\n * The IntersectionObserverPolyfill class lets any element receive its\n * intersection data with the viewport. It acts like native browser supported\n * IntersectionObserver.\n * The IntersectionObserver receives a callback function and an optional option\n * as params. Whenever the element intersection ratio cross a threshold value,\n * IntersectionObserverPolyfill will call the provided callback function with\n * the change entry.\n * @visibleForTesting\n */\nexport class IntersectionObserverPolyfill {\n  /**\n   * @param {function(!Array<!IntersectionObserverEntry>)} callback\n   * @param {Object=} opt_option\n   */\n  constructor(callback, opt_option) {\n    /** @private @const {function(!Array<!IntersectionObserverEntry>)} */\n    this.callback_ = callback;\n\n    // The input threshold can be a number or an array of numbers.\n    let threshold = opt_option && opt_option.threshold;\n    if (threshold) {\n      threshold = isArray(threshold) ?\n        threshold : [threshold];\n    } else {\n      threshold = [0];\n    }\n\n    for (let i = 0; i < threshold.length; i++) {\n      dev().assert(isFiniteNumber(threshold[i]), 'Threshold should be a ' +\n          'finite number or an array of finite numbers');\n    }\n\n    /**\n     * A list of threshold, sorted in increasing numeric order\n     * @private @const {!Array}\n     */\n    this.threshold_ = threshold.sort();\n    dev().assert(this.threshold_[0] >= 0 &&\n        this.threshold_[this.threshold_.length - 1] <= 1,\n    'Threshold should be in the range from \"[0, 1]\"');\n\n    /** @private {?./layout-rect.LayoutRectDef} */\n    this.lastViewportRect_ = null;\n\n    /** @private {./layout-rect.LayoutRectDef|undefined} */\n    this.lastIframeRect_ = undefined;\n\n    /**\n     * Store a list of observed elements and their current threshold slot which\n     * their intersection ratio fills, range from [0, this.threshold_.length]\n     * @private {Array<!ElementIntersectionStateDef>}\n     */\n    this.observeEntries_ = [];\n  }\n\n  /**\n   */\n  disconnect() {\n    this.observeEntries_.length = 0;\n  }\n\n  /**\n   * Provide a way to observe the intersection change for a specific element\n   * Please note IntersectionObserverPolyfill only support AMP element now\n   * TODO: Support non AMP element\n   * @param {!Element} element\n   */\n  observe(element) {\n    // Check the element is an AMP element.\n    dev().assert(element.getLayoutBox);\n\n    // If the element already exists in current observeEntries, do nothing\n    for (let i = 0; i < this.observeEntries_.length; i++) {\n      if (this.observeEntries_[i].element === element) {\n        dev().warn(TAG, 'should observe same element once');\n        return;\n      }\n    }\n\n    const newState = {\n      element,\n      currentThresholdSlot: 0,\n    };\n\n    // Get the new observed element's first changeEntry based on last viewport\n    if (this.lastViewportRect_) {\n      const change = this.getValidIntersectionChangeEntry_(\n          newState, this.lastViewportRect_, this.lastIframeRect_);\n      if (change) {\n        this.callback_([change]);\n      }\n    }\n\n    // push new observed element\n    this.observeEntries_.push(newState);\n  }\n\n  /**\n   * Provide a way to unobserve intersection change for a specified element\n   * @param {!Element} element\n   */\n  unobserve(element) {\n    // find the unobserved element in observeEntries\n    for (let i = 0; i < this.observeEntries_.length; i++) {\n      if (this.observeEntries_[i].element === element) {\n        this.observeEntries_.splice(i, 1);\n        return;\n      }\n    }\n    dev().warn(TAG, 'unobserve non-observed element');\n  }\n\n  /**\n   * Tick function that update the DOMRect of the root of observed elements.\n   * Caller needs to make sure to pass in the correct container.\n   * Note: the opt_iframe param is the iframe position relative to the host doc,\n   * The iframe must be a non-scrollable iframe.\n   * @param {!./layout-rect.LayoutRectDef} hostViewport\n   * @param {./layout-rect.LayoutRectDef=} opt_iframe\n   */\n  tick(hostViewport, opt_iframe) {\n\n    if (opt_iframe) {\n      // If element inside an iframe. Adjust origin to the iframe.left/top.\n      hostViewport =\n          moveLayoutRect(hostViewport, -opt_iframe.left, -opt_iframe.top);\n      opt_iframe =\n          moveLayoutRect(opt_iframe, -opt_iframe.left, -opt_iframe.top);\n    }\n\n    this.lastViewportRect_ = hostViewport;\n    this.lastIframeRect_ = opt_iframe;\n\n    const changes = [];\n\n    for (let i = 0; i < this.observeEntries_.length; i++) {\n      const change = this.getValidIntersectionChangeEntry_(\n          this.observeEntries_[i], hostViewport, opt_iframe);\n      if (change) {\n        changes.push(change);\n      }\n    }\n\n    if (changes.length) {\n      this.callback_(changes);\n    }\n  }\n\n  /**\n   * Return a change entry for one element that should be compatible with\n   * IntersectionObserverEntry if it's valid with current config.\n   * When the new intersection ratio doesn't cross one of a threshold value,\n   * the function will return null.\n   *\n   * @param {!ElementIntersectionStateDef} state\n   * @param {!./layout-rect.LayoutRectDef} hostViewport hostViewport's rect\n   * @param {./layout-rect.LayoutRectDef=} opt_iframe iframe container rect\n   * @return {?IntersectionObserverEntry} A valid change entry or null if ratio\n   * @private\n   */\n  getValidIntersectionChangeEntry_(state, hostViewport, opt_iframe) {\n    const {element} = state;\n\n    // Normalize container LayoutRect to be relative to page\n    let ownerRect = null;\n\n    // If opt_iframe is provided, all LayoutRect has position relative to\n    // the iframe.\n    // If opt_iframe is not provided, all LayoutRect has position relative to\n    // the host document.\n    const elementRect = element.getLayoutBox();\n    const owner = element.getOwner();\n    ownerRect = owner && owner.getLayoutBox();\n\n    // calculate intersectionRect. that the element intersects with hostViewport\n    // and intersects with owner element and container iframe if exists.\n    const intersectionRect =\n        rectIntersection(elementRect, ownerRect, hostViewport, opt_iframe) ||\n        layoutRectLtwh(0, 0, 0, 0);\n    // calculate ratio, call callback based on new ratio value.\n    const ratio = intersectionRatio(intersectionRect, elementRect);\n    const newThresholdSlot = getThresholdSlot(this.threshold_, ratio);\n\n    if (newThresholdSlot == state.currentThresholdSlot) {\n      return null;\n    }\n    state.currentThresholdSlot = newThresholdSlot;\n\n    // To get same behavior as native IntersectionObserver set hostViewport null\n    // if inside an iframe\n    const changeEntry = calculateChangeEntry(elementRect,\n        (opt_iframe ? null : hostViewport), intersectionRect, ratio);\n    changeEntry.target = element;\n    return changeEntry;\n  }\n}\n\n/**\n * Returns the ratio of the smaller box's area to the larger box's area.\n * @param {!./layout-rect.LayoutRectDef} smaller\n * @param {!./layout-rect.LayoutRectDef} larger\n * @return {number}\n */\nfunction intersectionRatio(smaller, larger) {\n  return (smaller.width * smaller.height) / (larger.width * larger.height);\n}\n\n/**\n * Returns the slot number that the current ratio fills in.\n * @param {!Array} sortedThreshold valid sorted IoB threshold\n * @param {number} ratio Range from [0, 1]\n * @return {number} Range from [0, threshold.length]\n * @visibleForTesting\n */\nexport function getThresholdSlot(sortedThreshold, ratio) {\n  let startIdx = 0;\n  let endIdx = sortedThreshold.length;\n  // 0 is a special case that does not fit into [small, large) range\n  if (ratio == 0) {\n    return 0;\n  }\n  let mid = ((startIdx + endIdx) / 2) | 0;\n  while (startIdx < mid) {\n    const midValue = sortedThreshold[mid];\n    // In the range of [small, large)\n    if (ratio < midValue) {\n      endIdx = mid;\n    } else {\n      startIdx = mid;\n    }\n    mid = ((startIdx + endIdx) / 2) | 0;\n  }\n  return endIdx;\n}\n\n/**\n * Helper function to calculate the IntersectionObserver change entry.\n * @param {!./layout-rect.LayoutRectDef} element element's rect\n * @param {?./layout-rect.LayoutRectDef} hostViewport hostViewport's rect\n * @param {!./layout-rect.LayoutRectDef} intersection\n * @param {number} ratio\n * @return {!IntersectionObserverEntry}}\n */\nfunction calculateChangeEntry(\n  element, hostViewport, intersection, ratio) {\n  // If element not in an iframe.\n  // adjust all LayoutRect to hostViewport Origin.\n  let boundingClientRect = element;\n  let rootBounds = hostViewport;\n  // If no hostViewport is provided, element is inside an non-scrollable iframe.\n  // Every Layoutrect has already adjust their origin according to iframe\n  // rect origin. LayoutRect position is relative to iframe origin,\n  // thus relative to iframe's viewport origin because the viewport is at the\n  // iframe origin. No need to adjust position here.\n\n  if (hostViewport) {\n    // If element not in an iframe.\n    // adjust all LayoutRect to hostViewport Origin.\n    rootBounds = /** @type {!./layout-rect.LayoutRectDef} */ (rootBounds);\n    intersection = moveLayoutRect(intersection, -hostViewport.left,\n        -hostViewport.top);\n    // The element is relative to (0, 0), while the viewport moves. So, we must\n    // adjust.\n    boundingClientRect = moveLayoutRect(boundingClientRect,\n        -hostViewport.left, -hostViewport.top);\n    // Now, move the viewport to (0, 0)\n    rootBounds = moveLayoutRect(rootBounds,\n        -hostViewport.left, -hostViewport.top);\n  }\n\n  return /** @type {!IntersectionObserverEntry} */ ({\n    time: (typeof performance !== 'undefined' && performance.now) ?\n      performance.now() : Date.now() - INIT_TIME,\n    rootBounds,\n    boundingClientRect,\n    intersectionRect: intersection,\n    intersectionRatio: ratio,\n  });\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview This module declares JSON types as defined in the\n * {@link http://json.org/}.\n */\n\nimport {isObject} from './types';\n\n\n// NOTE Type are changed to {*} because of\n// https://github.com/google/closure-compiler/issues/1999\n\n/**\n * JSON scalar. It's either string, number or boolean.\n * @typedef {*} should be string|number|boolean\n */\nlet JSONScalarDef;\n\n\n/**\n * JSON object. It's a map with string keys and JSON values.\n * @typedef {*} should be !Object<string, ?JSONValueDef>\n */\nlet JSONObjectDef;\n\n\n/**\n * JSON array. It's an array with JSON values.\n * @typedef {*} should be !Array<?JSONValueDef>\n */\nlet JSONArrayDef;\n\n\n/**\n * JSON value. It's either a scalar, an object or an array.\n * @typedef {*} should be !JSONScalarDef|!JSONObjectDef|!JSONArrayDef\n */\nlet JSONValueDef;\n\n/**\n * Recreates objects with prototype-less copies.\n * @param {!JsonObject} obj\n * @return {!JsonObject}\n */\nexport function recreateNonProtoObject(obj) {\n  const copy = Object.create(null);\n  for (const k in obj) {\n    if (!hasOwnProperty(obj, k)) {\n      continue;\n    }\n    const v = obj[k];\n    copy[k] = isObject(v) ? recreateNonProtoObject(v) : v;\n  }\n  return /** @type {!JsonObject} */ (copy);\n}\n\n/**\n * Returns a value from an object for a field-based expression. The expression\n * is a simple nested dot-notation of fields, such as `field1.field2`. If any\n * field in a chain does not exist or is not an object or array, the returned\n * value will be `undefined`.\n *\n * @param {!JsonObject} obj\n * @param {string} expr\n * @return {*}\n */\nexport function getValueForExpr(obj, expr) {\n  // The `.` indicates \"the object itself\".\n  if (expr == '.') {\n    return obj;\n  }\n  // Otherwise, navigate via properties.\n  const parts = expr.split('.');\n  let value = obj;\n  for (let i = 0; i < parts.length; i++) {\n    const part = parts[i];\n    if (part &&\n        value &&\n        value[part] !== undefined &&\n        hasOwnProperty(value, part)\n    ) {\n      value = value[part];\n      continue;\n    }\n    value = undefined;\n    break;\n  }\n  return value;\n}\n\n/**\n * Simple wrapper around JSON.parse that casts the return value\n * to JsonObject.\n * Create a new wrapper if an array return value is desired.\n * @param {*} json JSON string to parse\n * @return {?JsonObject} May be extend to parse arrays.\n */\nexport function parseJson(json) {\n  return /** @type {?JsonObject} */(JSON.parse(/** @type {string} */ (json)));\n}\n\n/**\n * Parses the given `json` string without throwing an exception if not valid.\n * Returns `undefined` if parsing fails.\n * Returns the `Object` corresponding to the JSON string when parsing succeeds.\n * @param {*} json JSON string to parse\n * @param {function(!Error)=} opt_onFailed Optional function that will be called\n *     with the error if parsing fails.\n * @return {?JsonObject|undefined} May be extend to parse arrays.\n */\nexport function tryParseJson(json, opt_onFailed) {\n  try {\n    return parseJson(json);\n  } catch (e) {\n    if (opt_onFailed) {\n      opt_onFailed(e);\n    }\n    return undefined;\n  }\n}\n\n/**\n * Recursively checks strict equality of items in nested arrays and objects.\n *\n * @param {JSONValueDef} a\n * @param {JSONValueDef} b\n * @param {number} depth The maximum recursion depth. Must be finite.\n * @return {boolean}\n * @throws {Error} If depth argument is not finite.\n */\nexport function recursiveEquals(a, b, depth = 3) {\n  if (!isFinite(depth)) {\n    throw new Error('depth arg must be finite: ' + depth);\n  }\n  if (a === b) {\n    return true;\n  }\n  // Only check shallow equality for depth < 1.\n  if (depth < 1) {\n    return false;\n  }\n  if (typeof a !== typeof b) {\n    return false;\n  }\n  if (Array.isArray(a) && Array.isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n    for (let i = 0; i < a.length; i++) {\n      if (!recursiveEquals(a[i], b[i], depth - 1)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\n    const keysA = Object.keys(/** @type {!Object} */ (a));\n    const keysB = Object.keys(/** @type {!Object} */ (b));\n    if (keysA.length !== keysB.length) {\n      return false;\n    }\n    for (let i = 0; i < keysA.length; i++) {\n      const keyA = keysA[i];\n      const valueA = a[keyA];\n      const valueB = b[keyA];\n      if (!recursiveEquals(valueA, valueB, depth - 1)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {*} obj\n * @param {string} key\n * @return {boolean}\n */\nfunction hasOwnProperty(obj, key) {\n  if (obj == null || typeof obj != 'object') {\n    return false;\n  }\n  return Object.prototype.hasOwnProperty.call(\n      /** @type {!Object} */ (obj), key);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * The structure that combines position and size for an element. The exact\n * interpretation of position and size depends on the use case.\n *\n * @typedef {{\n *   top: number,\n *   bottom: number,\n *   left: number,\n *   right: number,\n *   width: number,\n *   height: number,\n *   x: number,\n *   y: number\n * }}\n */\nexport let LayoutRectDef;\n\n\n/**\n * The structure that represents the margins of an Element.\n *\n * @typedef {{\n *   top: number,\n *   right: number,\n *   bottom: number,\n *   left: number\n * }}\n */\nexport let LayoutMarginsDef;\n\n\n/**\n * The structure that represents a requested change to the margins of an\n * Element. Any new values specified will replace existing ones (rather than\n * being additive).\n *\n * @typedef {{\n *   top: (number|undefined),\n *   right: (number|undefined),\n *   bottom: (number|undefined),\n *   left: (number|undefined)\n * }}\n */\nexport let LayoutMarginsChangeDef;\n\n/**\n* RelativePositions\n*\n* Describes the relative position of an element to another (whether the\n* first is inside the second, on top of the second or on the bottom\n* @enum {string}\n*/\nexport const RelativePositions = {\n  INSIDE: 'inside',\n  TOP: 'top',\n  BOTTOM: 'bottom',\n};\n\n/**\n * Creates a layout rect based on the left, top, width and height parameters\n * in that order.\n * @param {number} left\n * @param {number} top\n * @param {number} width\n * @param {number} height\n * @return {!LayoutRectDef}\n */\nexport function layoutRectLtwh(left, top, width, height) {\n  return {\n    left,\n    top,\n    width,\n    height,\n    bottom: top + height,\n    right: left + width,\n    x: left,\n    y: top,\n  };\n}\n\n\n/**\n * Creates a layout rect based on the DOMRect, e.g. obtained from calling\n * getBoundingClientRect.\n * @param {!ClientRect} rect\n * @return {!LayoutRectDef}\n */\nexport function layoutRectFromDomRect(rect) {\n  return layoutRectLtwh(Number(rect.left), Number(rect.top),\n      Number(rect.width), Number(rect.height));\n}\n\n/**\n * Returns true if the specified two rects overlap by a single pixel.\n * @param {!LayoutRectDef} r1\n * @param {!LayoutRectDef} r2\n * @return {boolean}\n */\nexport function layoutRectsOverlap(r1, r2) {\n  return (r1.top <= r2.bottom && r2.top <= r1.bottom &&\n      r1.left <= r2.right && r2.left <= r1.right);\n}\n\n\n/**\n * Returns the intersection between a, b or null if there is none.\n * @param {...?LayoutRectDef|undefined} var_args\n * @return {?LayoutRectDef}\n */\nexport function rectIntersection(var_args) {\n  let x0 = -Infinity;\n  let x1 = Infinity;\n  let y0 = -Infinity;\n  let y1 = Infinity;\n  for (let i = 0; i < arguments.length; i++) {\n    const current = arguments[i];\n    if (!current) {\n      continue;\n    }\n    x0 = Math.max(x0, current.left);\n    x1 = Math.min(x1, current.left + current.width);\n    y0 = Math.max(y0, current.top);\n    y1 = Math.min(y1, current.top + current.height);\n    if (x1 < x0 || y1 < y0) {\n      return null;\n    }\n  }\n  if (x1 == Infinity) {\n    return null;\n  }\n  return layoutRectLtwh(x0, y0, x1 - x0, y1 - y0);\n}\n\n/**\n * Returns the position of r2 relative to r1\n * @param {!LayoutRectDef} r1\n * @param {!LayoutRectDef} r2\n * @return {RelativePositions}\n */\nexport function layoutRectsRelativePos(r1, r2) {\n  if (r1.top < r2.top) {\n    return RelativePositions.TOP;\n  } else if (r1.bottom > r2.bottom) {\n    return RelativePositions.BOTTOM;\n  } else {\n    return RelativePositions.INSIDE;\n  }\n}\n\n/**\n * Expand the layout rect using multiples of width and height.\n * @param {!LayoutRectDef} rect Original rect.\n * @param {number} dw Expansion in width, specified as a multiple of width.\n * @param {number} dh Expansion in height, specified as a multiple of height.\n * @return {!LayoutRectDef}\n */\nexport function expandLayoutRect(rect, dw, dh) {\n  return layoutRectLtwh(rect.left - rect.width * dw,\n      rect.top - rect.height * dh,\n      rect.width * (1 + dw * 2),\n      rect.height * (1 + dh * 2));\n}\n\n/**\n * Moves the layout rect using dx and dy.\n * @param {!LayoutRectDef} rect Original rect.\n * @param {number} dx Move horizontally with this value.\n * @param {number} dy Move vertically with this value.\n * @return {!LayoutRectDef}\n */\nexport function moveLayoutRect(rect, dx, dy) {\n  if ((dx == 0 && dy == 0) ||\n      (rect.width == 0 && rect.height == 0)) {\n    return rect;\n  }\n  return layoutRectLtwh(rect.left + dx, rect.top + dy,\n      rect.width, rect.height);\n}\n\n\n/**\n * @param {!LayoutMarginsDef} margins\n * @param {!LayoutMarginsChangeDef} change\n * @return {boolean}\n */\nexport function areMarginsChanged(margins, change) {\n  return (change.top !== undefined && change.top != margins.top) ||\n      (change.right !== undefined && change.right != margins.right) ||\n      (change.bottom !== undefined && change.bottom != margins.bottom) ||\n      (change.left !== undefined && change.left != margins.left);\n}\n\n/**\n * @param {!LayoutRectDef} from\n * @param {!LayoutRectDef} to\n * @return {boolean}\n */\nexport function layoutRectSizeEquals(from, to) {\n  return from.width == to.width &&\n      from.height === to.height;\n}\n\n/**\n * @param {?LayoutRectDef} r1\n * @param {?LayoutRectDef} r2\n * @return {boolean}\n */\nexport function layoutRectEquals(r1, r2) {\n  if (!r1 || !r2) {\n    return false;\n  }\n  return r1.left == r2.left && r1.top == r2.top &&\n      r1.width == r2.width && r1.height == r2.height;\n}\n\n/**\n * @param {LayoutMarginsChangeDef|undefined} marginsChange\n * @return {LayoutMarginsChangeDef|undefined}\n */\nexport function cloneLayoutMarginsChangeDef(marginsChange) {\n  if (!marginsChange) {\n    return marginsChange;\n  }\n  return {\n    top: marginsChange.top,\n    bottom: marginsChange.bottom,\n    left: marginsChange.left,\n    right: marginsChange.right,\n  };\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Implements element layout. See https://goo.gl/9avXuT for\n * details.\n */\n\nimport {dev, user} from './log';\nimport {htmlFor} from './static-template';\nimport {isFiniteNumber} from './types';\nimport {setStyle, setStyles} from './style';\nimport {startsWith} from './string';\n\n/**\n * @enum {string}\n */\nexport const Layout = {\n  NODISPLAY: 'nodisplay',\n  FIXED: 'fixed',\n  FIXED_HEIGHT: 'fixed-height',\n  RESPONSIVE: 'responsive',\n  CONTAINER: 'container',\n  FILL: 'fill',\n  FLEX_ITEM: 'flex-item',\n  FLUID: 'fluid',\n  INTRINSIC: 'intrinsic',\n};\n\n\n/**\n * Layout priorities to use with BaseElement#getLayoutPriority() and\n * BaseElement#updateLayoutPriority().\n * @enum {number}\n */\nexport const LayoutPriority = {\n  CONTENT: 0,\n  METADATA: 1,\n  ADS: 2,\n  BACKGROUND: 3,\n};\n\n\n/**\n * CSS Length type. E.g. \"1px\" or \"20vh\".\n * @typedef {string}\n */\nexport let LengthDef;\n\n\n/**\n * @typedef {{\n *   width: string,\n *   height: string\n * }}\n */\nlet DimensionsDef;\n\n\n/**\n * The set of elements with natural dimensions, that is, elements\n * which have a known dimension either based on their value specified here,\n * or, if the value is null, a dimension specific to the browser.\n * `hasNaturalDimensions` checks for membership in this set.\n * `getNaturalDimensions` determines the dimensions for an element in the\n *    set and caches it.\n * @type {!Object<string, ?DimensionsDef>}\n * @private  Visible for testing only!\n */\nexport const naturalDimensions_ = {\n  'AMP-PIXEL': {width: '0px', height: '0px'},\n  'AMP-ANALYTICS': {width: '1px', height: '1px'},\n  // TODO(dvoytenko): audio should have width:auto.\n  'AMP-AUDIO': null,\n  'AMP-SOCIAL-SHARE': {width: '60px', height: '44px'},\n};\n\n\n/**\n * Elements that the progess can be shown for. This set has to be externalized\n * since the element's implementation may not be downloaded yet.\n * @enum {boolean}\n * @private  Visible for testing only!\n */\nexport const LOADING_ELEMENTS_ = {\n  'AMP-ANIM': true,\n  'AMP-BRIGHTCOVE': true,\n  'AMP-GOOGLE-DOCUMENT-EMBED': true,\n  'AMP-EMBED': true,\n  'AMP-FACEBOOK': true,\n  'AMP-FACEBOOK-COMMENTS': true,\n  'AMP-FACEBOOK-LIKE': true,\n  'AMP-FACEBOOK-PAGE': true,\n  'AMP-IFRAME': true,\n  'AMP-IMG': true,\n  'AMP-INSTAGRAM': true,\n  'AMP-LIST': true,\n  'AMP-OOYALA-PLAYER': true,\n  'AMP-PINTEREST': true,\n  'AMP-PLAYBUZZ': true,\n  'AMP-VIDEO': true,\n  'AMP-YOUTUBE': true,\n};\n\n\n/**\n * @param {string} s\n * @return {Layout|undefined} Returns undefined in case of failure to parse\n *   the layout string.\n */\nexport function parseLayout(s) {\n  for (const k in Layout) {\n    if (Layout[k] == s) {\n      return Layout[k];\n    }\n  }\n  return undefined;\n}\n\n\n/**\n * @param {!Layout} layout\n * @return {string}\n */\nexport function getLayoutClass(layout) {\n  return 'i-amphtml-layout-' + layout;\n}\n\n\n/**\n * Whether an element with this layout inherently defines the size.\n * @param {!Layout} layout\n * @return {boolean}\n */\nexport function isLayoutSizeDefined(layout) {\n  return (layout == Layout.FIXED ||\n      layout == Layout.FIXED_HEIGHT ||\n      layout == Layout.RESPONSIVE ||\n      layout == Layout.FILL ||\n      layout == Layout.FLEX_ITEM ||\n      layout == Layout.FLUID ||\n      layout == Layout.INTRINSIC);\n}\n\n\n/**\n * Whether the tag is an internal (service) AMP tag.\n * @param {!Node|string} tag\n * @return {boolean}\n */\nexport function isInternalElement(tag) {\n  const tagName = (typeof tag == 'string') ? tag : tag.tagName;\n  return tagName && startsWith(tagName.toLowerCase(), 'i-');\n}\n\n\n/**\n * Parses the CSS length value. If no units specified, the assumed value is\n * \"px\". Returns undefined in case of parsing error.\n * @param {string|undefined|null} s\n * @return {!LengthDef|undefined}\n */\nexport function parseLength(s) {\n  if (typeof s == 'number') {\n    return s + 'px';\n  }\n  if (!s) {\n    return undefined;\n  }\n  if (!/^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)?$/.test(s)) {\n    return undefined;\n  }\n  if (/^\\d+(\\.\\d+)?$/.test(s)) {\n    return s + 'px';\n  }\n  return s;\n}\n\n\n\n/**\n * Asserts that the supplied value is a non-percent CSS Length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {!LengthDef}\n */\nexport function assertLength(length) {\n  user().assert(\n      /^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)$/.test(length),\n      'Invalid length value: %s', length);\n  return /** @type {!LengthDef} */ (length);\n}\n\n\n\n\n/**\n * Asserts that the supplied value is a CSS Length value\n * (including percent unit).\n * @param {!LengthDef|string} length\n * @return {!LengthDef}\n */\nexport function assertLengthOrPercent(length) {\n  user().assert(/^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|%)$/.test(length),\n      'Invalid length or percent value: %s', length);\n  return length;\n}\n\n\n/**\n * Returns units from the CSS length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {string}\n */\nexport function getLengthUnits(length) {\n  assertLength(length);\n  dev().assertString(length);\n  const m = user().assert(length.match(/[a-z]+/i),\n      'Failed to read units from %s', length);\n  return m[0];\n}\n\n\n/**\n * Returns the numeric value of a CSS length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {number|undefined}\n */\nexport function getLengthNumeral(length) {\n  const res = parseFloat(length);\n  return isFiniteNumber(res) ? res : undefined;\n}\n\n\n/**\n * Determines whether the tagName is a known element that has natural dimensions\n * in our runtime or the browser.\n * @param {string} tagName The element tag name.\n * @return {boolean}\n */\nexport function hasNaturalDimensions(tagName) {\n  tagName = tagName.toUpperCase();\n  return naturalDimensions_[tagName] !== undefined;\n}\n\n\n/**\n * Determines the default dimensions for an element which could vary across\n * different browser implementations, like <audio> for instance.\n * This operation can only be completed for an element whitelisted by\n * `hasNaturalDimensions`.\n * @param {!Element} element\n * @return {DimensionsDef}\n */\nexport function getNaturalDimensions(element) {\n  const tagName = element.tagName.toUpperCase();\n  dev().assert(naturalDimensions_[tagName] !== undefined);\n  if (!naturalDimensions_[tagName]) {\n    const doc = element.ownerDocument;\n    const naturalTagName = tagName.replace(/^AMP\\-/, '');\n    const temp = doc.createElement(naturalTagName);\n    // For audio, should no-op elsewhere.\n    temp.controls = true;\n    setStyles(temp, {\n      position: 'absolute',\n      visibility: 'hidden',\n    });\n    doc.body.appendChild(temp);\n    naturalDimensions_[tagName] = {\n      width: (temp./*OK*/offsetWidth || 1) + 'px',\n      height: (temp./*OK*/offsetHeight || 1) + 'px',\n    };\n    doc.body.removeChild(temp);\n  }\n  return /** @type {DimensionsDef} */ (naturalDimensions_[tagName]);\n}\n\n\n/**\n * Whether the loading can be shown for the specified elemeent. This set has\n * to be externalized since the element's implementation may not be\n * downloaded yet.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isLoadingAllowed(element) {\n  const tagName = element.tagName.toUpperCase();\n  if (tagName == 'AMP-AD' || tagName == 'AMP-EMBED') {\n    return true;\n  }\n  return LOADING_ELEMENTS_[tagName] || false;\n}\n\n\n/**\n * Applies layout to the element. Visible for testing only.\n *\n * \\   \\  /  \\  /   / /   \\     |   _  \\     |  \\ |  | |  | |  \\ |  |  / _____|\n *  \\   \\/    \\/   / /  ^  \\    |  |_)  |    |   \\|  | |  | |   \\|  | |  |  __\n *   \\            / /  /_\\  \\   |      /     |  . `  | |  | |  . `  | |  | |_ |\n *    \\    /\\    / /  _____  \\  |  |\\  \\----.|  |\\   | |  | |  |\\   | |  |__| |\n *     \\__/  \\__/ /__/     \\__\\ | _| `._____||__| \\__| |__| |__| \\__|  \\______|\n *\n * The equivalent of this method is used for server-side rendering (SSR) and\n * any changes made to it must be made in coordination with caches that\n * implement SSR. For more information on SSR see bit.ly/amp-ssr.\n *\n * @param {!Element} element\n * @return {!Layout}\n */\nexport function applyStaticLayout(element) {\n  // Check if the layout has already been done by server-side rendering. The\n  // document may be visible to the user if the boilerplate was removed so\n  // please take care in making changes here.\n  const completedLayoutAttr = element.getAttribute('i-amphtml-layout');\n  if (completedLayoutAttr) {\n    const layout = /** @type {!Layout} */ (dev().assert(\n        parseLayout(completedLayoutAttr)));\n    if ((layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC)\n      && element.firstElementChild) {\n      // Find sizer, but assume that it might not have been parsed yet.\n      element.sizerElement =\n          element.querySelector('i-amphtml-sizer') || undefined;\n    } else if (layout == Layout.NODISPLAY) {\n      applyNoDisplayLayout(element);\n    }\n    return layout;\n  }\n\n  // If the layout was already done by server-side rendering (SSR), then the\n  // code below will not run. Any changes below will necessitate a change to SSR\n  // and must be coordinated with caches that implement SSR. See bit.ly/amp-ssr.\n\n  // Parse layout from the element.\n  const layoutAttr = element.getAttribute('layout');\n  const widthAttr = element.getAttribute('width');\n  const heightAttr = element.getAttribute('height');\n  const sizesAttr = element.getAttribute('sizes');\n  const heightsAttr = element.getAttribute('heights');\n\n  // Input layout attributes.\n  const inputLayout = layoutAttr ? parseLayout(layoutAttr) : null;\n  user().assert(inputLayout !== undefined, 'Unknown layout: %s', layoutAttr);\n  /** @const {string|null|undefined} */\n  const inputWidth = (widthAttr && widthAttr != 'auto') ?\n    parseLength(widthAttr) : widthAttr;\n  user().assert(inputWidth !== undefined, 'Invalid width value: %s', widthAttr);\n  /** @const {string|null|undefined} */\n  const inputHeight = (heightAttr && heightAttr != 'fluid') ?\n    parseLength(heightAttr) : heightAttr;\n  user().assert(inputHeight !== undefined, 'Invalid height value: %s',\n      heightAttr);\n\n  // Effective layout attributes. These are effectively constants.\n  let width;\n  let height;\n  let layout;\n\n  // Calculate effective width and height.\n  if ((!inputLayout || inputLayout == Layout.FIXED ||\n      inputLayout == Layout.FIXED_HEIGHT) &&\n      (!inputWidth || !inputHeight) && hasNaturalDimensions(element.tagName)) {\n    // Default width and height: handle elements that do not specify a\n    // width/height and are defined to have natural browser dimensions.\n    const dimensions = getNaturalDimensions(element);\n    width = (inputWidth || inputLayout == Layout.FIXED_HEIGHT) ? inputWidth :\n      dimensions.width;\n    height = inputHeight || dimensions.height;\n  } else {\n    width = inputWidth;\n    height = inputHeight;\n  }\n\n  // Calculate effective layout.\n  if (inputLayout) {\n    layout = inputLayout;\n  } else if (!width && !height) {\n    layout = Layout.CONTAINER;\n  } else if (height == 'fluid') {\n    layout = Layout.FLUID;\n  } else if (height && (!width || width == 'auto')) {\n    layout = Layout.FIXED_HEIGHT;\n  } else if (height && width && (sizesAttr || heightsAttr)) {\n    layout = Layout.RESPONSIVE;\n  } else {\n    layout = Layout.FIXED;\n  }\n\n  // Verify layout attributes.\n  if (layout == Layout.FIXED || layout == Layout.FIXED_HEIGHT ||\n      layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC) {\n    user().assert(height, 'Expected height to be available: %s', heightAttr);\n  }\n  if (layout == Layout.FIXED_HEIGHT) {\n    user().assert(!width || width == 'auto',\n        'Expected width to be either absent or equal \"auto\" ' +\n        'for fixed-height layout: %s', widthAttr);\n  }\n  if (layout == Layout.FIXED || layout == Layout.RESPONSIVE ||\n      layout == Layout.INTRINSIC) {\n    user().assert(width && width != 'auto',\n        'Expected width to be available and not equal to \"auto\": %s',\n        widthAttr);\n  }\n\n  if (layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC) {\n    user().assert(getLengthUnits(width) == getLengthUnits(height),\n        'Length units should be the same for width and height: %s, %s',\n        widthAttr, heightAttr);\n  } else {\n    user().assert(heightsAttr === null,\n        'Unexpected \"heights\" attribute for none-responsive layout');\n  }\n\n  // Apply UI.\n  element.classList.add(getLayoutClass(layout));\n  if (isLayoutSizeDefined(layout)) {\n    element.classList.add('i-amphtml-layout-size-defined');\n  }\n  if (layout == Layout.NODISPLAY) {\n    // CSS defines layout=nodisplay automatically with `display:none`. Thus\n    // no additional styling is needed.\n    applyNoDisplayLayout(element);\n  } else if (layout == Layout.FIXED) {\n    setStyles(element, {\n      width: dev().assertString(width),\n      height: dev().assertString(height),\n    });\n  } else if (layout == Layout.FIXED_HEIGHT) {\n    setStyle(element, 'height', dev().assertString(height));\n  } else if (layout == Layout.RESPONSIVE) {\n    const sizer = element.ownerDocument.createElement('i-amphtml-sizer');\n    setStyles(sizer, {\n      display: 'block',\n      paddingTop:\n        ((getLengthNumeral(height) / getLengthNumeral(width)) * 100) + '%',\n    });\n    element.insertBefore(sizer, element.firstChild);\n    element.sizerElement = sizer;\n  } else if (layout == Layout.INTRINSIC) {\n    // Intrinsic uses an svg inside the sizer element rather than the padding\n    // trick Note a naked svg won't work becasue other thing expect the\n    // i-amphtml-sizer element\n    const sizer = htmlFor(element)`\n      <i-amphtml-sizer class=\"i-amphtml-sizer\">\n        <img class=\"i-amphtml-intrinsic-sizer\" />\n      </i-amphtml-sizer>`;\n    const intrinsicSizer = sizer.firstElementChild;\n    intrinsicSizer.setAttribute('src',\n        `data:image/svg+xml;charset=utf-8,<svg height=\"${height}\" width=\"${width}\" xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\"/>`);\n    element.insertBefore(sizer, element.firstChild);\n    // TODO(jpettitt): sizer is leaked and can't be cleaned up.\n    element.sizerElement = intrinsicSizer;\n  } else if (layout == Layout.FILL) {\n    // Do nothing.\n  } else if (layout == Layout.CONTAINER) {\n    // Do nothing. Elements themselves will check whether the supplied\n    // layout value is acceptable. In particular container is only OK\n    // sometimes.\n  } else if (layout == Layout.FLEX_ITEM) {\n    // Set height and width to a flex item if they exist.\n    // The size set to a flex item could be overridden by `display: flex` later.\n    if (width) {\n      setStyle(element, 'width', width);\n    }\n    if (height) {\n      setStyle(element, 'height', height);\n    }\n  } else if (layout == Layout.FLUID) {\n    element.classList.add('i-amphtml-layout-awaiting-size');\n    if (width) {\n      setStyle(element, 'width', width);\n    }\n    setStyle(element, 'height', 0);\n  }\n  return layout;\n}\n\n\n/**\n * @param {!Element} element\n */\nfunction applyNoDisplayLayout(element) {\n  // TODO(dvoytenko, #9353): once `toggleLayoutDisplay` API has been deployed\n  // everywhere, switch all relevant elements to this API. In the meantime,\n  // simply unblock display toggling via `style=\"display: ...\"`.\n  setStyle(element, 'display', 'none');\n  element.classList.add('i-amphtml-display');\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {getModeObject} from './mode-object';\nimport {isEnumValue} from './types';\n\n/**\n * Triple zero width space.\n *\n * This is added to user error messages, so that we can later identify\n * them, when the only thing that we have is the message. This is the\n * case in many browsers when the global exception handler is invoked.\n *\n * @const {string}\n */\nexport const USER_ERROR_SENTINEL = '\\u200B\\u200B\\u200B';\n\n\n/**\n * Four zero width space.\n *\n * @const {string}\n */\nexport const USER_ERROR_EMBED_SENTINEL = '\\u200B\\u200B\\u200B\\u200B';\n\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a user error.\n */\nexport function isUserErrorMessage(message) {\n  return message.indexOf(USER_ERROR_SENTINEL) >= 0;\n}\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a a user error from an iframe embed.\n */\nexport function isUserErrorEmbed(message) {\n  return message.indexOf(USER_ERROR_EMBED_SENTINEL) >= 0;\n}\n\n\n/**\n * @enum {number}\n * @private Visible for testing only.\n */\nexport const LogLevel = {\n  OFF: 0,\n  ERROR: 1,\n  WARN: 2,\n  INFO: 3,\n  FINE: 4,\n};\n\n/**\n * Sets reportError function. Called from error.js to break cyclic\n * dependency.\n * @param {function(*, !Element=)|undefined} fn\n */\nexport function setReportError(fn) {\n  self.reportError = fn;\n}\n\n/**\n * @type {!LogLevel|undefined}\n * @private\n */\nlet levelOverride_ = undefined;\n\n/**\n * @param {!LogLevel} level\n */\nexport function overrideLogLevel(level) {\n  levelOverride_ = level;\n}\n\n/**\n * Logging class. Use of sentinel string instead of a boolean to check user/dev\n * errors because errors could be rethrown by some native code as a new error,\n * and only a message would survive. Also, some browser dont support a 5th\n * error object argument in window.onerror. List of supporting browser can be\n * found here:\n * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n * @final\n * @private Visible for testing only.\n */\nexport class Log {\n  /**\n   * opt_suffix will be appended to error message to identify the type of the\n   * error message. We can't rely on the error object to pass along the type\n   * because some browsers do not have this param in its window.onerror API.\n   * See:\n   * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n   *\n   * @param {!Window} win\n   * @param {function(!./mode.ModeDef):!LogLevel} levelFunc\n   * @param {string=} opt_suffix\n   */\n  constructor(win, levelFunc, opt_suffix) {\n    /**\n     * In tests we use the main test window instead of the iframe where\n     * the tests runs because only the former is relayed to the console.\n     * @const {!Window}\n     */\n    this.win = (getMode().test && win.AMP_TEST_IFRAME) ? win.parent : win;\n\n    /** @private @const {function(!./mode.ModeDef):!LogLevel} */\n    this.levelFunc_ = levelFunc;\n\n    /** @private @const {!LogLevel} */\n    this.level_ = this.defaultLevel_();\n\n    /** @private @const {string} */\n    this.suffix_ = opt_suffix || '';\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  getLevel_() {\n    return (levelOverride_ !== undefined) ? levelOverride_ : this.level_;\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  defaultLevel_() {\n    // No console - can't enable logging.\n    if (!this.win.console || !this.win.console.log) {\n      return LogLevel.OFF;\n    }\n\n    // Logging has been explicitly disabled.\n    if (getMode().log == '0') {\n      return LogLevel.OFF;\n    }\n\n    // Logging is enabled for tests directly.\n    if (getMode().test && this.win.ENABLE_LOG) {\n      return LogLevel.FINE;\n    }\n\n    // LocalDev by default allows INFO level, unless overriden by `#log`.\n    if (getMode().localDev && !getMode().log) {\n      return LogLevel.INFO;\n    }\n\n    // Delegate to the specific resolver.\n    return this.levelFunc_(getModeObject());\n  }\n\n  /**\n   * @param {string} tag\n   * @param {string} level\n   * @param {!Array} messages\n   */\n  msg_(tag, level, messages) {\n    if (this.getLevel_() != LogLevel.OFF) {\n      let fn = this.win.console.log;\n      if (level == 'ERROR') {\n        fn = this.win.console.error || fn;\n      } else if (level == 'INFO') {\n        fn = this.win.console.info || fn;\n      } else if (level == 'WARN') {\n        fn = this.win.console.warn || fn;\n      }\n      if (getMode().localDev) {\n        messages.unshift('[' + tag + ']');\n      }\n      fn.apply(this.win.console, messages);\n    }\n  }\n\n  /**\n   * Whether the logging is enabled.\n   * @return {boolean}\n   */\n  isEnabled() {\n    return this.getLevel_() != LogLevel.OFF;\n  }\n\n  /**\n   * Reports a fine-grained message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  fine(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.FINE) {\n      this.msg_(tag, 'FINE', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a informational message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  info(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.INFO) {\n      this.msg_(tag, 'INFO', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a warning message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  warn(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.WARN) {\n      this.msg_(tag, 'WARN', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports an error message. If the logging is disabled, the error is rethrown\n   * asynchronously.\n   * @param {string} tag\n   * @param {...*} var_args\n   * @return {!Error|undefined}\n   * @private\n   */\n  error_(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.ERROR) {\n      this.msg_(tag, 'ERROR', Array.prototype.slice.call(arguments, 1));\n    } else {\n      const error = createErrorVargs.apply(null,\n          Array.prototype.slice.call(arguments, 1));\n      this.prepareError_(error);\n      return error;\n    }\n  }\n\n  /**\n   * Reports an error message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  error(tag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.name = tag || error.name;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Reports an error message and marks with an expected property. If the\n   * logging is disabled, the error is rethrown asynchronously.\n   * @param {string} unusedTag\n   * @param {...*} var_args\n   */\n  expectedError(unusedTag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.expected = true;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Creates an error object.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    return error;\n  }\n\n  /**\n   * Creates an error object with its expected property set to true.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createExpectedError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    error.expected = true;\n    return error;\n  }\n\n  /**\n   * Throws an error if the first argument isn't trueish.\n   *\n   * Supports argument substitution into the message via %s placeholders.\n   *\n   * Throws an error object that has two extra properties:\n   * - associatedElement: This is the first element provided in the var args.\n   *   It can be used for improved display of error messages.\n   * - messageArray: The elements of the substituted message as non-stringified\n   *   elements in an array. When e.g. passed to console.error this yields\n   *   native displays of things like HTML elements.\n   *\n   * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n   *     not evaluate to true.\n   * @param {string=} opt_message The assertion message\n   * @param {...*} var_args Arguments substituted into %s in the message.\n   * @return {T} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 0\n   */\n  assert(shouldBeTrueish, opt_message, var_args) {\n    let firstElement;\n    if (!shouldBeTrueish) {\n      const message = opt_message || 'Assertion failed';\n      const splitMessage = message.split('%s');\n      const first = splitMessage.shift();\n      let formatted = first;\n      const messageArray = [];\n      pushIfNonEmpty(messageArray, first);\n      for (let i = 2; i < arguments.length; i++) {\n        const val = arguments[i];\n        if (val && val.tagName) {\n          firstElement = val;\n        }\n        const nextConstant = splitMessage.shift();\n        messageArray.push(val);\n        pushIfNonEmpty(messageArray, nextConstant.trim());\n        formatted += toString(val) + nextConstant;\n      }\n      const e = new Error(formatted);\n      e.fromAssert = true;\n      e.associatedElement = firstElement;\n      e.messageArray = messageArray;\n      this.prepareError_(e);\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n    return shouldBeTrueish;\n  }\n\n  /**\n   * Throws an error if the first argument isn't an Element\n   *\n   * Otherwise see `assert` for usage\n   *\n   * @param {*} shouldBeElement\n   * @param {string=} opt_message The assertion message\n   * @return {!Element} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertElement(shouldBeElement, opt_message) {\n    const shouldBeTrueish = shouldBeElement && shouldBeElement.nodeType == 1;\n    this.assert(shouldBeTrueish, (opt_message || 'Element expected') + ': %s',\n        shouldBeElement);\n    return /** @type {!Element} */ (shouldBeElement);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a string. The string can\n   * be empty.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeString\n   * @param {string=} opt_message The assertion message\n   * @return {string} The string value. Can be an empty string.\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertString(shouldBeString, opt_message) {\n    this.assert(typeof shouldBeString == 'string',\n        (opt_message || 'String expected') + ': %s', shouldBeString);\n    return /** @type {string} */ (shouldBeString);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a number. The allowed values\n   * include `0` and `NaN`.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeNumber\n   * @param {string=} opt_message The assertion message\n   * @return {number} The number value. The allowed values include `0`\n   *   and `NaN`.\n   */\n  assertNumber(shouldBeNumber, opt_message) {\n    this.assert(typeof shouldBeNumber == 'number',\n        (opt_message || 'Number expected') + ': %s', shouldBeNumber);\n    return /** @type {number} */ (shouldBeNumber);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a boolean.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeBoolean\n   * @param {string=} opt_message The assertion message\n   * @return {boolean} The boolean value.\n   */\n  assertBoolean(shouldBeBoolean, opt_message) {\n    this.assert(!!shouldBeBoolean === shouldBeBoolean,\n        (opt_message || 'Boolean expected') + ': %s', shouldBeBoolean);\n    return /** @type {boolean} */ (shouldBeBoolean);\n  }\n\n  /**\n   * Asserts and returns the enum value. If the enum doesn't contain such a\n   * value, the error is thrown.\n   *\n   * @param {!Object<T>} enumObj\n   * @param {string} s\n   * @param {string=} opt_enumName\n   * @return {T}\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertEnumValue(enumObj, s, opt_enumName) {\n    if (isEnumValue(enumObj, s)) {\n      return s;\n    }\n    this.assert(false,\n        'Unknown %s value: \"%s\"',\n        opt_enumName || 'enum', s);\n  }\n\n  /**\n   * @param {!Error} error\n   * @private\n   */\n  prepareError_(error) {\n    error = duplicateErrorIfNecessary(error);\n    if (this.suffix_) {\n      if (!error.message) {\n        error.message = this.suffix_;\n      } else if (error.message.indexOf(this.suffix_) == -1) {\n        error.message += this.suffix_;\n      }\n    } else if (isUserErrorMessage(error.message)) {\n      error.message = error.message.replace(USER_ERROR_SENTINEL, '');\n    }\n  }\n}\n\n/**\n * @param {string|!Element} val\n * @return {string}\n */\nfunction toString(val) {\n  // Do check equivalent to `val instanceof Element` without cross-window bug\n  if (val && val.nodeType == 1) {\n    return val.tagName.toLowerCase() + (val.id ? '#' + val.id : '');\n  }\n  return /** @type {string} */ (val);\n}\n\n\n/**\n * @param {!Array} array\n * @param {*} val\n */\nfunction pushIfNonEmpty(array, val) {\n  if (val != '') {\n    array.push(val);\n  }\n}\n\n/**\n * Some exceptions (DOMException, namely) have read-only message.\n * @param {!Error} error\n * @return {!Error};\n */\nexport function duplicateErrorIfNecessary(error) {\n  const {message} = error;\n  const test = String(Math.random());\n  error.message = test;\n\n  if (error.message === test) {\n    error.message = message;\n    return error;\n  }\n\n  const e = new Error(error.message);\n  // Copy all the extraneous things we attach.\n  for (const prop in error) {\n    e[prop] = error[prop];\n  }\n  // Ensure these are copied.\n  e.stack = error.stack;\n  return e;\n}\n\n/**\n * @param {...*} var_args\n * @return {!Error}\n * @visibleForTesting\n */\nexport function createErrorVargs(var_args) {\n  let error = null;\n  let message = '';\n  for (let i = 0; i < arguments.length; i++) {\n    const arg = arguments[i];\n    if (arg instanceof Error && !error) {\n      error = duplicateErrorIfNecessary(arg);\n    } else {\n      if (message) {\n        message += ' ';\n      }\n      message += arg;\n    }\n  }\n\n  if (!error) {\n    error = new Error(message);\n  } else if (message) {\n    error.message = message + ': ' + error.message;\n  }\n  return error;\n}\n\n\n/**\n * Rethrows the error without terminating the current context. This preserves\n * whether the original error designation is a user error or a dev error.\n * @param {...*} var_args\n */\nexport function rethrowAsync(var_args) {\n  const error = createErrorVargs.apply(null, arguments);\n  setTimeout(() => {\n    // reportError is installed globally per window in the entry point.\n    self.reportError(error);\n    throw error;\n  });\n}\n\n\n/**\n * Cache for logs. We do not use a Service since the service module depends\n * on Log and closure literally can't even.\n * @type {{user: ?Log, dev: ?Log, userForEmbed: ?Log}}\n */\nself.log = (self.log || {\n  user: null,\n  dev: null,\n  userForEmbed: null,\n});\n\nconst logs = self.log;\n\n/**\n * Eventually holds a constructor for Log objects. Lazily initialized, so we\n * can avoid ever referencing the real constructor except in JS binaries\n * that actually want to include the implementation.\n * @type {?Function}\n */\nlet logConstructor = null;\n\n/**\n * Initializes log contructor.\n */\nexport function initLogConstructor() {\n  logConstructor = Log;\n  // Initialize instances for use. If a binary (an extension for example) that\n  // does not call `initLogConstructor` invokes `dev()` or `user()` earlier than\n  // the binary that does call `initLogConstructor` (amp.js), the extension will\n  // throw an error as that extension will never be able to initialize the log\n  // instances and we also don't want it to call `initLogConstructor` either\n  // (since that will cause the Log implementation to be bundled into that\n  // binary). So we must initialize the instances eagerly so that they are ready\n  // for use (stored globally) after the main binary calls `initLogConstructor`.\n  dev();\n  user();\n}\n\n/**\n * Resets log contructor for testing.\n */\nexport function resetLogConstructorForTesting() {\n  logConstructor = null;\n}\n\n/**\n * Publisher level log.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Development mode is enabled via `#development=1` or logging is explicitly\n *     enabled via `#log=D` where D >= 1.\n *  3. AMP.setLogLevel(D) is called, where D >= 1.\n *\n * @param {!Element=} opt_element\n * @return {!Log}\n */\nexport function user(opt_element) {\n  if (!logs.user) {\n    logs.user = getUserLogger(USER_ERROR_SENTINEL);\n  }\n  if (!isFromEmbed(logs.user.win, opt_element)) {\n    return logs.user;\n  } else {\n    if (logs.userForEmbed) {\n      return logs.userForEmbed;\n    }\n    return logs.userForEmbed = getUserLogger(USER_ERROR_EMBED_SENTINEL);\n  }\n}\n\n/**\n * Getter for user logger\n * @param {string=} suffix\n * @return {!Log}\n */\nfunction getUserLogger(suffix) {\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (mode.development || logNum >= 1) {\n      return LogLevel.FINE;\n    }\n    return LogLevel.WARN;\n  }, suffix);\n}\n\n/**\n * AMP development log. Calls to `devLog().assert` and `dev.fine` are stripped\n * in the PROD binary. However, `devLog().assert` result is preserved in either\n * case.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Logging is explicitly enabled via `#log=D`, where D >= 2.\n *  3. AMP.setLogLevel(D) is called, where D >= 2.\n *\n * @return {!Log}\n */\nexport function dev() {\n  if (logs.dev) {\n    return logs.dev;\n  }\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return logs.dev = new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (logNum >= 3) {\n      return LogLevel.FINE;\n    }\n    if (logNum >= 2) {\n      return LogLevel.INFO;\n    }\n    return LogLevel.OFF;\n  });\n}\n\n/**\n * @param {!Window} win\n * @param {!Element=} opt_element\n * @return {boolean} isEmbed\n */\nexport function isFromEmbed(win, opt_element) {\n  if (!opt_element) {\n    return false;\n  }\n  return opt_element.ownerDocument.defaultView != win;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\n\n/**\n * Provides info about the current app. This return value may be cached and\n * passed around as it will always be DCE'd.\n * @param {?Window=} opt_win\n * @return {!./mode.ModeDef}\n */\nexport function getModeObject(opt_win) {\n  return {\n    localDev: getMode(opt_win).localDev,\n    development: getMode(opt_win).development,\n    filter: getMode(opt_win).filter,\n    minified: getMode(opt_win).minified,\n    lite: getMode(opt_win).lite,\n    test: getMode(opt_win).test,\n    log: getMode(opt_win).log,\n    version: getMode(opt_win).version,\n    rtvVersion: getMode(opt_win).rtvVersion,\n  };\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {parseQueryString_} from './url-parse-query-string';\n\n/**\n * @typedef {{\n *   localDev: boolean,\n *   development: boolean,\n *   filter: (string|undefined),\n *   minified: boolean,\n *   lite: boolean,\n *   test: boolean,\n *   log: (string|undefined),\n *   version: string,\n *   rtvVersion: string,\n * }}\n */\nexport let ModeDef;\n\n/** @type {string} */\nconst version = '$internalRuntimeVersion$';\n\n/**\n * `rtvVersion` is the prefixed version we serve off of the cdn.\n * The prefix denotes canary(00) or prod(01) or an experiment version ( > 01).\n * @type {string}\n */\nlet rtvVersion = '';\n\n/**\n * Provides info about the current app.\n * @param {?Window=} opt_win\n * @return {!ModeDef}\n */\nexport function getMode(opt_win) {\n  const win = opt_win || self;\n  if (win.AMP_MODE) {\n    return win.AMP_MODE;\n  }\n  return win.AMP_MODE = getMode_(win);\n}\n\n/**\n * Provides info about the current app.\n * @param {!Window} win\n * @return {!ModeDef}\n */\nfunction getMode_(win) {\n  // Magic constants that are replaced by closure compiler.\n  // IS_MINIFIED is always replaced with true when closure compiler is used\n  // while IS_DEV is only replaced when `gulp dist` is called without the\n  // --fortesting flag.\n  const IS_DEV = true;\n  const IS_MINIFIED = false;\n\n  const localDevEnabled = !!(self.AMP_CONFIG && self.AMP_CONFIG.localDev);\n  const runningTests = IS_DEV && !!(win.AMP_TEST || win.__karma__);\n  const isLocalDev = IS_DEV && (localDevEnabled || runningTests);\n  const hashQuery = parseQueryString_(\n      // location.originalHash is set by the viewer when it removes the fragment\n      // from the URL.\n      win.location.originalHash || win.location.hash);\n\n  const searchQuery = parseQueryString_(win.location.search);\n\n  if (!rtvVersion) {\n    rtvVersion = getRtvVersion(win, isLocalDev);\n  }\n\n  // The `minified`, `test` and `localDev` properties are replaced\n  // as boolean literals when we run `gulp dist` without the `--fortesting`\n  // flags. This improved DCE on the production file we deploy as the code\n  // paths for localhost/testing/development are eliminated.\n  return {\n    localDev: isLocalDev,\n    // Triggers validation or enable pub level logging. Validation can be\n    // bypassed via #validate=0.\n    // Note that AMP_DEV_MODE flag is used for testing purposes.\n    development: !!(hashQuery['development'] == '1' || win.AMP_DEV_MODE),\n    examiner: hashQuery['development'] == '2',\n    // Allows filtering validation errors by error category. For the\n    // available categories, see ErrorCategory in validator/validator.proto.\n    filter: hashQuery['filter'],\n    // amp-geo override\n    geoOverride: hashQuery['amp-geo'],\n    minified: IS_MINIFIED,\n    // Whether document is in an amp-lite viewer. It signal that the user\n    // would prefer to use less bandwidth.\n    lite: searchQuery['amp_lite'] != undefined,\n    test: runningTests,\n    log: hashQuery['log'],\n    version,\n    rtvVersion,\n  };\n}\n\n/**\n * Retrieve the `rtvVersion` which will have a numeric prefix\n * denoting canary/prod/experiment (unless `isLocalDev` is true).\n *\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n */\nfunction getRtvVersion(win, isLocalDev) {\n  // If it's local dev then we won't actually have a full version so\n  // just use the version.\n  if (isLocalDev) {\n    return version;\n  }\n\n  if (win.AMP_CONFIG && win.AMP_CONFIG.v) {\n    return win.AMP_CONFIG.v;\n  }\n\n  // Currently `$internalRuntimeVersion$` and thus `mode.version` contain only\n  // major version. The full version however must also carry the minor version.\n  // We will default to production default `01` minor version for now.\n  // TODO(erwinmombay): decide whether $internalRuntimeVersion$ should contain\n  // minor version.\n  return `01${version}`;\n}\n\n\n/**\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n * @visibleForTesting\n */\nexport function getRtvVersionForTesting(win, isLocalDev) {\n  return getRtvVersion(win, isLocalDev);\n}\n\n\n/** @visibleForTesting */\nexport function resetRtvVersionForTesting() {\n  rtvVersion = '';\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n\n/**\n * This class helps to manage observers. Observers can be added, removed or\n * fired through and instance of this class.\n * @template TYPE\n */\nexport class Observable {\n\n  /**\n   * Creates an instance of Observable.\n   */\n  constructor() {\n    /** @type {?Array<function(TYPE)>} */\n    this.handlers_ = null;\n  }\n\n  /**\n   * Adds the observer to this instance.\n   * @param {function(TYPE)} handler Observer's handler.\n   * @return {!UnlistenDef}\n   */\n  add(handler) {\n    if (!this.handlers_) {\n      this.handlers_ = [];\n    }\n    this.handlers_.push(handler);\n    return () => {\n      this.remove(handler);\n    };\n  }\n\n  /**\n   * Removes the observer from this instance.\n   * @param {function(TYPE)} handler Observer's instance.\n   */\n  remove(handler) {\n    if (!this.handlers_) {\n      return;\n    }\n    const index = this.handlers_.indexOf(handler);\n    if (index > -1) {\n      this.handlers_.splice(index, 1);\n    }\n  }\n\n  /**\n   * Removes all observers.\n   */\n  removeAll() {\n    if (!this.handlers_) {\n      return;\n    }\n    this.handlers_.length = 0;\n  }\n\n  /**\n   * Fires an event. All observers are called.\n   * @param {TYPE=} opt_event\n   */\n  fire(opt_event) {\n    if (!this.handlers_) {\n      return;\n    }\n    const handlers = this.handlers_;\n    for (let i = 0; i < handlers.length; i++) {\n      const handler = handlers[i];\n      handler(opt_event);\n    }\n  }\n\n  /**\n   * Returns number of handlers. Mostly needed for tests.\n   * @return {number}\n   */\n  getHandlerCount() {\n    if (!this.handlers_) {\n      return 0;\n    }\n    return this.handlers_.length;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {install as installArrayIncludes} from './polyfills/array-includes';\nimport {install as installCustomElements} from './polyfills/custom-elements';\nimport {\n  install as installDOMTokenListToggle,\n} from './polyfills/domtokenlist-toggle';\nimport {install as installDocContains} from './polyfills/document-contains';\nimport {install as installMathSign} from './polyfills/math-sign';\nimport {install as installObjectAssign} from './polyfills/object-assign';\nimport {install as installPromise} from './polyfills/promise';\nimport {installCustomElements as installRegisterElement} from\n  'document-register-element/build/document-register-element.patched';\nimport {isExperimentOn} from './experiments';\n\nif (isExperimentOn(self, 'custom-elements-v1') || getMode().test) {\n  installCustomElements(self, class {});\n} else {\n  installRegisterElement(self, 'auto');\n}\ninstallDOMTokenListToggle(self);\ninstallMathSign(self);\ninstallObjectAssign(self);\ninstallPromise(self);\ninstallDocContains(self);\ninstallArrayIncludes(self);\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Returns true if the element is in the array and false otherwise.\n *\n * @param {*} value\n * @param {number=} opt_fromIndex\n * @return {boolean}\n * @this {Array}\n */\nfunction includes(value, opt_fromIndex) {\n  const fromIndex = opt_fromIndex || 0;\n  const len = this.length;\n  let i = fromIndex >= 0 ? fromIndex : Math.max(len + fromIndex, 0);\n  for (; i < len; i++) {\n    const other = this[i];\n    // If value has been found OR (value is NaN AND other is NaN)\n    /*eslint \"no-self-compare\": 0*/\n    if (other === value || (value !== value && other !== other)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n* Sets the Array.contains polyfill if it does not exist.\n* @param {!Window} win\n*/\nexport function install(win) {\n  if (!win.Array.prototype.includes) {\n    win.Object.defineProperty(Array.prototype, 'includes', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: includes,\n    });\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @typedef {{\n *   promise: !Promise<undefined>,\n *   resolve: function(),\n * }}\n */\nlet DeferredDef;\n\n/**\n * @typedef {!Function}\n */\nlet CustomElementConstructorDef;\n\n/**\n * @typedef {{\n *  name: string,\n *  ctor: !CustomElementConstructorDef,\n * }}\n */\nlet CustomElementDef;\n\n/**\n * Validates the custom element's name.\n * This intentionally ignores \"valid\" higher Unicode Code Points.\n * https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name\n */\nconst VALID_NAME = /^[a-z][a-z0-9._]*-[a-z0-9._-]*$/;\nconst INVALID_NAMES = [\n  'annotation-xml',\n  'color-profile',\n  'font-face',\n  'font-face-src',\n  'font-face-uri',\n  'font-face-format',\n  'font-face-name',\n  'missing-glyph',\n];\n\n/**\n * Asserts that the custom element name conforms to the spec.\n *\n * @param {!Function} SyntaxError\n * @param {string} name\n */\nfunction assertValidName(SyntaxError, name) {\n  if (!VALID_NAME.test(name) || INVALID_NAMES.indexOf(name) >= 0) {\n    throw new SyntaxError(`invalid custom element name \"${name}\"`);\n  }\n}\n\n/**\n * Does win have a full Custom Elements registry?\n *\n * @param {!Window} win\n * @return {boolean}\n */\nfunction hasCustomElements(win) {\n  const {customElements} = win;\n\n  return !!(\n    customElements &&\n    customElements.define &&\n    customElements.get &&\n    customElements.whenDefined);\n}\n\n/**\n * Was HTMLElement already patched for this window?\n *\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isPatched(win) {\n  const tag = win.HTMLElement.toString();\n  return tag.indexOf('[native code]') === -1;\n}\n\n/**\n * The public Custom Elements API.\n */\nclass CustomElementRegistry {\n  /**\n   * @param {!Window} win\n   * @param {!Registry} registry\n   */\n  constructor(win, registry) {\n    /**\n     * @const @private\n     */\n    this.win_ = win;\n\n    /**\n     * @const @private\n     */\n    this.registry_ = registry;\n\n    /**\n     * @type {!Object<string, DeferredDef>}\n     * @private\n     * @const\n     */\n    this.pendingDefines_ = this.win_.Object.create(null);\n  }\n\n  /**\n   * Register the custom element.\n   *\n   * @param {string} name\n   * @param {!CustomElementConstructorDef} ctor\n   * @param {!Object=} options\n   */\n  define(name, ctor, options) {\n    this.registry_.define(name, ctor, options);\n\n    // If anyone is waiting for this custom element to be defined, resolve\n    // their promise.\n    const pending = this.pendingDefines_;\n    const deferred = pending[name];\n    if (deferred) {\n      deferred.resolve();\n      delete pending[name];\n    }\n  }\n\n  /**\n   * Get the constructor of the (already defined) custom element.\n   *\n   * @param {string} name\n   * @return {!CustomElementConstructorDef|undefined}\n   */\n  get(name) {\n    const def = this.registry_.getByName(name);\n    if (def) {\n      return def.ctor;\n    }\n  }\n\n  /**\n   * Returns a promise that waits until the custom element is defined.\n   * If the custom element is already defined, returns a resolved promise.\n   *\n   * @param {string} name\n   * @return {!Promise<undefined>}\n   */\n  whenDefined(name) {\n    const {Promise, SyntaxError} = this.win_;\n    assertValidName(SyntaxError, name);\n\n    if (this.registry_.getByName(name)) {\n      return Promise.resolve();\n    }\n\n    const pending = this.pendingDefines_;\n    const deferred = pending[name];\n    if (deferred) {\n      return deferred.promise;\n    }\n\n    let resolve;\n    const promise = new /*OK*/Promise(res => resolve = res);\n    pending[name] = {\n      promise,\n      resolve,\n    };\n\n    return promise;\n  }\n\n  /**\n   * Upgrade all custom elements inside root.\n   *\n   * @param {!Node} root\n   */\n  upgrade(root) {\n    this.registry_.upgrade(root);\n  }\n}\n\n/**\n * This internal APIs necessary to run the CustomElementRegistry.\n * Since Registry is never exposed externally, all methods are actually\n * available on the instance.\n */\nclass Registry {\n  /**\n   * @param {!Window} win\n   */\n  constructor(win) {\n    /**\n     * @private @const\n     */\n    this.win_ = win;\n\n    /**\n     * @private @const\n     */\n    this.doc_ = win.document;\n\n    /**\n     * @type {!Object<string, !CustomElementDef>}\n     * @private\n     * @const\n     */\n    this.definitions_ = win.Object.create(null);\n\n    /**\n     * A up-to-date DOM selector for all custom elements.\n     * @type {string}\n     */\n    this.query_ = '';\n\n    /**\n     * The currently upgrading element.\n     * @private {Element}\n     */\n    this.current_ = null;\n  }\n\n  /**\n   * The currently-being-upgraded custom element.\n   *\n   * When an already created (through the DOM parsing APIs, or innerHTML)\n   * custom element node is being upgraded, we can't just create a new node\n   * (it's illegal in the spec). But we still need to run the custom element's\n   * constructor code on the node. We avoid this conundrum by running the\n   * constructor while returning this current node in the HTMLElement\n   * class constructor (the base class of all custom elements).\n   *\n   * @return {Element}\n   */\n  current() {\n    const current = this.current_;\n    this.current_ = null;\n    return current;\n  }\n\n  /**\n   * Finds the custom element definition by name.\n   *\n   * @param {string} name\n   * @return {CustomElementDef|undefined}\n   */\n  getByName(name) {\n    const definition = this.definitions_[name];\n    if (definition) {\n      return definition;\n    }\n  }\n\n  /**\n   * Finds the custom element definition by constructor instance.\n   *\n   * @param {CustomElementConstructorDef} ctor\n   * @return {CustomElementDef|undefined}\n   */\n  getByConstructor(ctor) {\n    const definitions = this.definitions_;\n\n    for (const name in definitions) {\n      const def = definitions[name];\n      if (def.ctor === ctor) {\n        return def;\n      }\n    }\n  }\n\n  /**\n   * Registers the custom element definition, and upgrades all elements by that\n   * name in the root document.\n   *\n   * @param {string} name\n   * @param {!CustomElementConstructorDef} ctor\n   * @param {!Object|undefined} options\n   */\n  define(name, ctor, options) {\n    const {Error, SyntaxError} = this.win_;\n\n    if (options) {\n      throw new Error('Extending native custom elements is not supported');\n    }\n\n    assertValidName(SyntaxError, name);\n\n    if (this.getByName(name) ||\n        this.getByConstructor(ctor)) {\n      throw new Error(`duplicate definition \"${name}\"`);\n    }\n\n    // TODO(jridgewell): Record connectedCallback, disconnectedCallback,\n    // adoptedCallback, attributeChangedCallback, and observedAttributes.\n    // TODO(jridgewell): If attributeChangedCallback, gather observedAttributes\n    this.definitions_[name] = {\n      name,\n      ctor,\n    };\n\n    this.observe_(name);\n    this.upgrade(this.doc_, name);\n  }\n\n  /**\n   * Upgrades custom elements descendants of root (but not including root).\n   *\n   * When called with an opt_query, it both upgrades and connects the custom\n   * elements (this is used during the custom element define algorithm).\n   *\n   * @param {!Node} root\n   * @param {string=} opt_query\n   */\n  upgrade(root, opt_query) {\n    // Only CustomElementRegistry.p.define provides a query (the newly defined\n    // custom element). In this case, we are both upgrading _and_ connecting\n    // the custom elements.\n    const newlyDefined = !!opt_query;\n    const query = opt_query || this.query_;\n    const upgradeCandidates = this.queryAll_(root, query);\n\n    for (let i = 0; i < upgradeCandidates.length; i++) {\n      const candidate = upgradeCandidates[i];\n      if (newlyDefined) {\n        this.connectedCallback_(candidate);\n      } else {\n        this.upgradeSelf(candidate);\n      }\n    }\n  }\n\n  /**\n   * Upgrades the custom element node, if a custom element has been registered\n   * by this name.\n   *\n   * @param {!Node} node\n   */\n  upgradeSelf(node) {\n    const def = this.getByName(node.localName);\n    if (!def) {\n      return;\n    }\n\n    this.upgradeSelf_(/** @type {!Element} */(node), def);\n  }\n\n  /**\n   * @param {!Node} root\n   * @param {string} query\n   * @return {!Array|!NodeList}\n   */\n  queryAll_(root, query) {\n    if (!query || !root.querySelectorAll) {\n      // Nothing to do...\n      return [];\n    }\n\n    return root.querySelectorAll(query);\n  }\n\n  /**\n   * Upgrades the (already created via DOM parsing) custom element.\n   *\n   * @param {!Element} node\n   * @param {!CustomElementDef} def\n   */\n  upgradeSelf_(node, def) {\n    const {ctor} = def;\n    if (node instanceof ctor) {\n      return;\n    }\n\n    // Despite how it looks, this is not a useless construction.\n    // HTMLElementPolyfill (the base class of all custom elements) will return\n    // the current node, allowing the custom element's subclass constructor to\n    // run on the node. The node itself is already constructed, so the return\n    // value is just the node.\n    this.current_ = node;\n    const el = new ctor();\n\n    if (el !== node) {\n      throw new this.win_.Error(\n          'Constructor illegally returned a different instance.');\n    }\n  }\n\n  /**\n   * Fires connectedCallback on the custom element, if it has one.\n   * This also upgrades the custom element, since it may not have been\n   * accessible via the root document before (a detached DOM tree).\n   *\n   * @param {!Node} node\n   */\n  connectedCallback_(node) {\n    const def = this.getByName(node.localName);\n    if (!def) {\n      return;\n    }\n    this.upgradeSelf_(/** @type {!Element} */(node), def);\n    // TODO(jridgewell): It may be appropriate to adoptCallback, if the node\n    // used to be in another doc.\n    // TODO(jridgewell): I should be calling the definitions connectedCallback\n    // with node as the context.\n    if (node.connectedCallback) {\n      node.connectedCallback();\n    }\n  }\n\n  /**\n   * Fires disconnectedCallback on the custom element, if it has one.\n   *\n   * @param {!Node} node\n   */\n  disconnectedCallback_(node) {\n    // TODO(jridgewell): I should be calling the definitions connectedCallback\n    // with node as the context.\n    if (node.disconnectedCallback) {\n      node.disconnectedCallback();\n    }\n  }\n\n  /**\n   * Records name as a registered custom element to observe.\n   *\n   * Starts the Mutation Observer if this is the first registered custom\n   * element. This is deferred until the first custom element is defined to\n   * speed up initial rendering of the page.\n   *\n   * Mutation Observers are conveniently available in every browser we care\n   * about. When a node is connected to the root document, all custom\n   * elements (including that node iteself) will be upgraded and call\n   * connectedCallback. When a node is disconnectedCallback from the root\n   * document, all custom elements will call disconnectedCallback.\n   *\n   * @param {string} name\n   */\n  observe_(name) {\n    if (this.query_) {\n      this.query_ += `,${name}`;\n      return;\n    }\n\n    this.query_ = name;\n\n    // The first registered name starts the mutation observer.\n    const observer = new this.win_.MutationObserver(records => {\n      if (records) {\n        this.handleRecords_(records);\n      }\n    });\n    observer.observe(this.doc_, {\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  /**\n   * Handle all the Mutation Observer's Mutation Records.\n   * All added custom elements will be upgraded (if not already) and call\n   * connectedCallback. All removed custom elements will call\n   * disconnectedCallback.\n   *\n   * @param {!Array<!MutationRecord>} records\n   */\n  handleRecords_(records) {\n    for (let i = 0; i < records.length; i++) {\n      const record = records[i];\n      if (!record) {\n        continue;\n      }\n\n      const {addedNodes, removedNodes} = record;\n      for (let i = 0; i < addedNodes.length; i++) {\n        const node = addedNodes[i];\n        const connectedCandidates = this.queryAll_(node, this.query_);\n        this.connectedCallback_(node);\n        for (let i = 0; i < connectedCandidates.length; i++) {\n          this.connectedCallback_(connectedCandidates[i]);\n        }\n      }\n\n      for (let i = 0; i < removedNodes.length; i++) {\n        const node = removedNodes[i];\n        const disconnectedCandidates = this.queryAll_(node, this.query_);\n        this.disconnectedCallback_(node);\n        for (let i = 0; i < disconnectedCandidates.length; i++) {\n          this.disconnectedCallback_(disconnectedCandidates[i]);\n        }\n      }\n    }\n  }\n}\n\n/**\n * Does the polyfilling.\n * @param {!Window} win\n */\nfunction polyfill(win) {\n  const {HTMLElement, Element, Node, Document, Object, document} = win;\n  const {createElement, cloneNode, importNode} = document;\n\n  const registry = new Registry(win);\n  const customElements = new CustomElementRegistry(win, registry);\n\n  // Expose the custom element registry.\n  // Object.getOwnPropertyDescriptor(window, 'customElements')\n  // {get: , set: undefined, enumerable: true, configurable: true}\n  Object.defineProperty(win, 'customElements', {\n    enumerable: true,\n    configurable: true,\n    // writable: false,\n    value: customElements,\n  });\n\n  // Patch createElement to immediately upgrade the custom element.\n  // This has the added benefit that it avoids the \"already created but needs\n  // constructor code run\" chicken-and-egg problem.\n  Document.prototype.createElement = function createElementPolyfill(name) {\n    const def = registry.getByName(name);\n    if (def) {\n      return new def.ctor();\n    }\n    return createElement.apply(this, arguments);\n  };\n\n  // Patch importNode to immediately upgrade custom elements.\n  // TODO(jridgewell): Can fire adoptedCallback for cross doc imports.\n  Document.prototype.importNode = function importNodePolyfill() {\n    const imported = importNode.apply(this, arguments);\n    if (imported) {\n      registry.upgradeSelf(imported);\n      registry.upgrade(imported);\n    }\n    return imported;\n  };\n\n  // Patch cloneNode to immediately upgrade custom elements.\n  Node.prototype.cloneNode = function cloneNodePolyfill() {\n    const cloned = cloneNode.apply(this, arguments);\n    registry.upgradeSelf(cloned);\n    registry.upgrade(cloned);\n    return cloned;\n  };\n\n  // Patch the innerHTML setter to immediately upgrade custom elements.\n  // Note, this could technically fire connectedCallbacks if this node was\n  // connected, but we leave that to the Mutation Observer.\n  const innerHTMLDesc = Object.getOwnPropertyDescriptor(Element.prototype,\n      'innerHTML');\n  const innerHTMLSetter = innerHTMLDesc.set;\n  innerHTMLDesc.set = function(html) {\n    innerHTMLSetter.call(this, html);\n    registry.upgrade(this);\n  };\n  Object.defineProperty(Element.prototype, 'innerHTML', innerHTMLDesc);\n\n  /**\n   * You can't use the real HTMLElement constructor, because you can't subclass\n   * it without using native classes. So, mock its approximation using\n   * createElement.\n   */\n  function HTMLElementPolyfill() {\n    const {constructor} = this;\n\n    // If we're upgrading an already created custom element, we can't create\n    // another new node (by the spec, it must be the same node).\n    let el = registry.current();\n\n    // If there's not a already created custom element, we're being invoked via\n    // `new`ing the constructor.\n    //\n    // Technically, we could get here via createElement, but we patched that.\n    // If it the custom element was registered, the patch turned it into a\n    // `new` call.\n    // If it was not registered, the native createElement is used. And if\n    // native createElement is being used and we got to this code, we're really\n    // in an infinite loop (a native createElement call just below) so we've\n    // got bigger problems.\n    //\n    // So just take my word we got here via `new`.\n    if (!el) {\n      // The custom element definition is an invariant. If the custom element\n      // is registered, everything works. If it's not, it throws in the member\n      // property access (only defined custom elements can be directly\n      // constructed via `new`).\n      const def = registry.getByConstructor(constructor);\n      el = createElement.call(document, def.name);\n    }\n\n    // Finally, if the node was already constructed, we need to reset it's\n    // prototype to the custom element prototype. And if it wasn't already\n    // constructed, we created a new node via native createElement, and we need\n    // to reset it's prototype. Basically always reset the prototype.\n    Object.setPrototypeOf(el, constructor.prototype);\n    return el;\n  }\n  subClass(Object, HTMLElement, HTMLElementPolyfill);\n\n  // Expose the polyfilled HTMLElement constructor for everyone to extend from.\n  win.HTMLElement = HTMLElementPolyfill;\n}\n\n/**\n * Wraps HTMLElement in a Reflect.construct constructor, so that transpiled\n * classes can `_this = superClass.call(this)` during their construction.\n *\n * This is only used when Custom Elements v1 is already available _and_ we're\n * using transpiled classes (which use ES5 construction idioms).\n *\n * @param {!Window} win\n */\nfunction wrapHTMLElement(win) {\n  const {HTMLElement, Reflect, Object} = win;\n  /**\n   */\n  function HTMLElementWrapper() {\n    const ctor = /** @type {function(...?):?|undefined} */(\n      /** @type {!HTMLElement} */(this).constructor);\n\n    // Reflect.construct allows us to construct a new HTMLElement without using\n    // `new` (which will always fail because native HTMLElement is a restricted\n    // constructor).\n    return Reflect.construct(HTMLElement, [], ctor);\n  }\n  subClass(Object, HTMLElement, HTMLElementWrapper);\n\n  // Expose the wrapped HTMLElement constructor for everyone to extend from.\n  win.HTMLElement = HTMLElementWrapper;\n}\n\n/**\n * Setups up prototype inheritance\n *\n * @param {!Object} Object\n * @param {!Function} superClass\n * @param {!Function} subClass\n */\nfunction subClass(Object, superClass, subClass) {\n  // Object.getOwnPropertyDescriptor(superClass.prototype, 'constructor')\n  // {value: , writable: true, enumerable: false, configurable: true}\n  subClass.prototype = Object.create(superClass.prototype, {\n    constructor: {\n      // enumerable: false,\n      configurable: true,\n      writable: true,\n      value: subClass,\n    },\n  });\n}\n\n/**\n * Polyfills Custom Elements v1 API. This has 4 modes:\n *\n * 1. Custom elements v1 already supported, using native classes\n * 2. Custom elements v1 already supported, using transpiled classes\n * 3. Custom elements v1 not supported, using native classes\n * 4. Custom elements v1 not supported, using transpiled classes\n *\n * In mode 1, nothing is done. In mode 2, a minimal polyfill is used to support\n * extending the HTMLElement base class. In mode 3 and 4, a full polyfill is\n * done.\n *\n * @param {!Window} win\n * @param {!Function} ctor\n */\nexport function install(win, ctor) {\n  if (isPatched(win)) {\n    return;\n  }\n\n  let install = true;\n  let installWrapper = false;\n\n  if (hasCustomElements(win)) {\n    // If ctor is constructable without new, it's a function. That means it was\n    // compiled down, and we need to do the minimal polyfill because all you\n    // cannot extend HTMLElement without native classes.\n    try {\n      const {Object, Reflect} = win;\n\n      // \"Construct\" ctor using ES5 idioms\n      const instance = Object.create(ctor.prototype);\n      ctor.call(instance);\n\n      // If that succeeded, we're in a transpiled environment\n      // Let's find out if we can wrap HTMLElement and avoid a full patch.\n      installWrapper = !!(Reflect && Reflect.construct);\n    } catch (e) {\n\n      // The ctor threw when we constructed is via ES5, so it's a real class.\n      // We're ok to not install the polyfill.\n      install = false;\n    }\n  }\n\n  if (installWrapper) {\n    wrapHTMLElement(win);\n  } else if (install) {\n    polyfill(win);\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Polyfill for `document.contains()` method. Notice that according to spec\n * `document.contains` is inclusionary.\n * See https://developer.mozilla.org/en-US/docs/Web/API/Node/contains\n * @param {?Node} node\n * @return {boolean}\n * @this {Node}\n */\nfunction documentContainsPolyfill(node) {\n  // Per spec, \"contains\" method is inclusionary\n  // i.e. `node.contains(node) == true`. However, we still need to test\n  // equality to the document itself.\n  return node == this || this.documentElement.contains(node);\n}\n\n\n/**\n * Polyfills `HTMLDocument.contains` API.\n * @param {!Window} win\n */\nexport function install(win) {\n  // HTMLDocument is undefined in Internet Explorer 10, but it has Document,\n  // so we use that as a fallback.\n  const documentClass = win.HTMLDocument || win.Document;\n  if (!documentClass.prototype.contains) {\n    win.Object.defineProperty(documentClass.prototype, 'contains', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: documentContainsPolyfill,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Polyfill for `DOMTokenList.prototype.toggle(token, opt_force)` method. This\n * is specially important because IE does not support `opt_force` attribute. See\n * https://goo.gl/hgKNYY for details.\n * @param {string} token\n * @param {boolean=} opt_force\n * @this {DOMTokenList}\n * @return {boolean}\n */\nfunction domTokenListTogglePolyfill(token, opt_force) {\n  const remove = opt_force === undefined ? this.contains(token) : !opt_force;\n  if (remove) {\n    this.remove(token);\n    return false;\n  } else {\n    this.add(token);\n    return true;\n  }\n}\n\n\n/**\n * Polyfills `DOMTokenList.prototype.toggle` API in IE.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (isIe(win) && win.DOMTokenList) {\n    win.Object.defineProperty(win.DOMTokenList.prototype, 'toggle', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: domTokenListTogglePolyfill,\n    });\n  }\n}\n\n\n/**\n * Whether the current browser is a IE browser.\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isIe(win) {\n  return /Trident|MSIE|IEMobile/i.test(win.navigator.userAgent);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Parses the number x and returns its sign. For positive x returns 1, for\n * negative, -1. For 0 and -0, returns 0 and -0 respectively. For any number\n * that parses to NaN, returns NaN.\n *\n * @param {number} x\n * @return {number}\n */\nexport function sign(x) {\n  x = Number(x);\n\n  // If x is 0, -0, or NaN, return it.\n  if (!x) {\n    return x;\n  }\n\n  return x > 0 ? 1 : -1;\n}\n\n\n/**\n * Sets the Math.sign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Math.sign) {\n    win.Object.defineProperty(win.Math, 'sign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: sign,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst {hasOwnProperty} = Object.prototype;\n\n/**\n * Copies values of all enumerable own properties from one or more source\n * objects (provided as extended arguments to the function) to a target object.\n *\n * @param {!Object} target\n * @param {...Object} var_args\n * @return {!Object}\n */\nexport function assign(target, var_args) {\n  if (target == null) {\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  const output = Object(target);\n  for (let i = 1; i < arguments.length; i++) {\n    const source = arguments[i];\n    if (source != null) {\n      for (const key in source) {\n        if (hasOwnProperty.call(source, key)) {\n          output[key] = source[key];\n        }\n      }\n    }\n  }\n  return output;\n}\n\n\n/**\n * Sets the Object.assign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Object.assign) {\n    win.Object.defineProperty(win.Object, 'assign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: assign,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nimport * as Promise from 'promise-pjs/promise';\n\n/**\n * Sets the Promise polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Promise) {\n    win.Promise = /** @type {?} */ (Promise);\n    // In babel the * export is an Object with a default property.\n    // In closure compiler it is the Promise function itself.\n    if (Promise.default) {\n      win.Promise = Promise.default;\n    }\n    // We copy the individual static methods, because closure\n    // compiler flattens the polyfill namespace.\n    win.Promise.resolve = Promise.resolve;\n    win.Promise.reject = Promise.reject;\n    win.Promise.all = Promise.all;\n    win.Promise.race = Promise.race;\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from './services';\nimport {dev} from './log';\nimport {getServicePromise} from './service';\n\n/**\n * A map of services that delay rendering. The key is the name of the service\n * and the value is a DOM query which is used to check if the service is needed\n * in the current document.\n * Do not add a service unless absolutely necessary.\n *\n * \\   \\  /  \\  /   / /   \\     |   _  \\     |  \\ |  | |  | |  \\ |  |  / _____|\n *  \\   \\/    \\/   / /  ^  \\    |  |_)  |    |   \\|  | |  | |   \\|  | |  |  __\n *   \\            / /  /_\\  \\   |      /     |  . `  | |  | |  . `  | |  | |_ |\n *    \\    /\\    / /  _____  \\  |  |\\  \\----.|  |\\   | |  | |  |\\   | |  |__| |\n *     \\__/  \\__/ /__/     \\__\\ | _| `._____||__| \\__| |__| |__| \\__|  \\______|\n *\n * The equivalent of this list is used for server-side rendering (SSR) and any\n * changes made to it must be made in coordination with caches that implement\n * SSR. For more information on SSR see bit.ly/amp-ssr.\n *\n * @const {!Object<string, string>}\n */\nconst SERVICES = {\n  'amp-dynamic-css-classes': '[custom-element=amp-dynamic-css-classes]',\n  'variant': 'amp-experiment',\n  'amp-story': 'amp-story[standalone]',\n};\n\n/**\n * Maximum milliseconds to wait for all extensions to load before erroring.\n * @const\n */\nconst LOAD_TIMEOUT = 3000;\n\n/**\n * Detects any render delaying services that are required on the page, and\n * returns a promise with a timeout.\n * @param {!Window} win\n * @return {!Promise<!Array<*>>} resolves to an Array that has the same length\n *     as the detected render delaying services\n */\nexport function waitForServices(win) {\n  const promises = includedServices(win).map(service => {\n    return Services.timerFor(win).timeoutPromise(\n        LOAD_TIMEOUT,\n        getServicePromise(win, service),\n        `Render timeout waiting for service ${service} to be ready.`\n    );\n  });\n  return Promise.all(promises);\n}\n\n/**\n * Returns true if the page has a render delaying service.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function hasRenderDelayingServices(win) {\n  return includedServices(win).length > 0;\n}\n\n/**\n * Detects which, if any, render-delaying extensions are included on the page.\n * @param {!Window} win\n * @return {!Array<string>}\n */\nexport function includedServices(win) {\n  /** @const {!Document} */\n  const doc = win.document;\n  dev().assert(doc.body);\n\n  return Object.keys(SERVICES).filter(service => {\n    return doc.querySelector(SERVICES[service]);\n  });\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Registration and getter functions for AMP services.\n *\n * Invariant: Service getters never return null for registered services.\n */\n\n// src/polyfills.js must be the first import.\nimport './polyfills'; // eslint-disable-line sort-imports-es6-autofix/sort-imports-es6\n\nimport {Deferred} from './utils/promise';\nimport {dev} from './log';\nimport {toWin} from './types';\n\n\n/**\n * Holds info about a service.\n * - obj: Actual service implementation when available.\n * - promise: Promise for the obj.\n * - resolve: Function to resolve the promise with the object.\n * - context: Argument for ctor, either a window or an ampdoc.\n * - ctor: Function that constructs and returns the service.\n * @typedef {{\n *   obj: (?Object),\n *   promise: (?Promise),\n *   resolve: (?function(!Object)),\n *   context: (?Window|?./service/ampdoc-impl.AmpDoc),\n *   ctor: (?function(new:Object, !Window)|\n *          ?function(new:Object, !./service/ampdoc-impl.AmpDoc)),\n * }}\n */\nlet ServiceHolderDef;\n\n\n/**\n * This interface provides a `dispose` method that will be called by\n * runtime when a service needs to be disposed of.\n * @interface\n */\nexport class Disposable {\n\n  /**\n   * Instructs the service to release any resources it might be holding. Can\n   * be called only once in the lifecycle of a service.\n   */\n  dispose() {}\n}\n\n\n/**\n * This interface provides a `adoptEmbedWindow` method that will be called by\n * runtime for a new embed window.\n * @interface\n */\nexport class EmbeddableService {\n\n  /**\n   * Instructs the service to adopt the embed window and add any necessary\n   * listeners and resources.\n   * @param {!Window} unusedEmbedWin\n   */\n  adoptEmbedWindow(unusedEmbedWin) {}\n}\n\n\n/**\n * Returns a service with the given id. Assumes that it has been registered\n * already.\n * @param {!Window} win\n * @param {string} id\n * @param {boolean=} opt_fallbackToTopWin\n * @return {Object} The service.\n */\nexport function getExistingServiceInEmbedScope(win, id, opt_fallbackToTopWin) {\n  // First, try to resolve via local (embed) window.\n  const local = getLocalExistingServiceForEmbedWinOrNull(win, id);\n  if (local) {\n    return local;\n  }\n  if (opt_fallbackToTopWin) {\n    return getService(win, id);\n  }\n  return null;\n}\n\n/**\n * Returns a service with the given id. Assumes that it has been constructed\n * already.\n *\n * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n * services since sometimes we only have the FIE Document for context.\n *\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id\n * @param {boolean=} opt_fallbackToTopWin\n * @return {Object} The service.\n */\nexport function getExistingServiceForDocInEmbedScope(\n  nodeOrDoc, id, opt_fallbackToTopWin) {\n  // First, try to resolve via local (embed) window.\n  if (nodeOrDoc.nodeType) {\n    // If a node is passed, try to resolve via this node.\n    const win = toWin(/** @type {!Document} */ (\n      nodeOrDoc.ownerDocument || nodeOrDoc).defaultView);\n    const local = getLocalExistingServiceForEmbedWinOrNull(win, id);\n    if (local) {\n      return local;\n    }\n  }\n  // If an ampdoc is passed or fallback is allowed, continue resolving.\n  if (!nodeOrDoc.nodeType || opt_fallbackToTopWin) {\n    return getServiceForDocDeprecated(nodeOrDoc, id);\n  }\n  return null;\n}\n\n/**\n * Installs a service override on amp-doc level.\n * @param {!Window} embedWin\n * @param {string} id\n * @param {!Object} service The service.\n */\nexport function installServiceInEmbedScope(embedWin, id, service) {\n  const topWin = getTopWindow(embedWin);\n  dev().assert(embedWin != topWin,\n      'Service override can only be installed in embed window: %s', id);\n  dev().assert(!getLocalExistingServiceForEmbedWinOrNull(embedWin, id),\n      'Service override has already been installed: %s', id);\n  registerServiceInternal(embedWin, embedWin, id, () => service);\n  getServiceInternal(embedWin, id); // Force service to build.\n}\n\n/**\n * @param {!Window} embedWin\n * @param {string} id\n * @return {?Object}\n */\nfunction getLocalExistingServiceForEmbedWinOrNull(embedWin, id) {\n  // Note that this method currently only resolves against the given window.\n  // It does not try to go all the way up the parent window chain. We can change\n  // this in the future, but for now this gives us a better performance.\n  const topWin = getTopWindow(embedWin);\n  if (embedWin != topWin && isServiceRegistered(embedWin, id)) {\n    return getServiceInternal(embedWin, id);\n  } else {\n    return null;\n  }\n}\n\n/**\n * Registers a service given a class to be used as implementation.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {function(new:Object, !Window)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilder(win,\n  id,\n  constructor,\n  opt_instantiate) {\n  win = getTopWindow(win);\n  registerServiceInternal(win, win, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(win, id);\n  }\n}\n\n\n/**\n * Returns a service and registers it given a class to be used as\n * implementation.\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id of the service.\n * @param {function(new:Object, !./service/ampdoc-impl.AmpDoc)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilderForDoc(nodeOrDoc,\n  id,\n  constructor,\n  opt_instantiate) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  registerServiceInternal(holder, ampdoc, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(holder, id);\n  }\n}\n\n\n/**\n * Returns a service for the given id and window (a per-window singleton). Users\n * should typically wrap this as a special purpose function (e.g.\n * `Services.vsyncFor(win)`) for type safety and because the factory should not\n * be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @template T\n * @return {T}\n */\nexport function getService(win, id) {\n  win = getTopWindow(win);\n  return getServiceInternal(win, id);\n}\n\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. `Services.vsyncFor(win)`) for type safety and because the\n * factory should not be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nexport function getServicePromise(win, id) {\n  return getServicePromiseInternal(win, id);\n}\n\n\n/**\n * Returns a service or null with the given id.\n * @param {!Window} win\n * @param {string} id\n * @return {?Object} The service.\n */\nexport function getExistingServiceOrNull(win, id) {\n  win = getTopWindow(win);\n  if (isServiceRegistered(win, id)) {\n    return getServiceInternal(win, id);\n  } else {\n    return null;\n  }\n}\n\n\n/**\n * Like getServicePromise but returns null if the service was never registered.\n * @param {!Window} win\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNull(win, id) {\n  return getServicePromiseOrNullInternal(win, id);\n}\n\n\n/**\n * Returns a service for the given id and ampdoc (a per-ampdoc singleton).\n * Expects service `id` to be registered.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {T}\n * @template T\n */\nexport function getServiceForDoc(elementOrAmpDoc, id) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  return getServiceInternal(holder, id);\n}\n\n\n/**\n * tl;dr -- Use getServiceForDoc() instead of this.\n *\n * Privileged variant of getServiceForDoc() that accepts non-element params,\n * e.g. window.document. This is currently necessary for doc-level services\n * used in startup, e.g. Chunks. Eventually we want to remove this function\n * and have callers find the appropriate AmpDoc and use getServiceForDoc().\n *\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id\n * @return {T}\n * @template T\n */\nexport function getServiceForDocDeprecated(nodeOrDoc, id) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  return getServiceInternal(holder, id);\n}\n\n\n/**\n * Returns a promise for a service for the given id and ampdoc. Also expects\n * a service that has the actual implementation. The promise resolves when\n * the implementation loaded.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {!Promise<!Object>}\n */\nexport function getServicePromiseForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseInternal(\n      getAmpdocServiceHolder(elementOrAmpDoc), id);\n}\n\n\n/**\n * Like getServicePromiseForDoc but returns null if the service was never\n * registered for this ampdoc.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNullForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseOrNullInternal(\n      getAmpdocServiceHolder(elementOrAmpDoc), id);\n}\n\n/**\n * Set the parent and top windows on a child window (friendly iframe).\n * @param {!Window} win\n * @param {!Window} parentWin\n */\nexport function setParentWindow(win, parentWin) {\n  win.__AMP_PARENT = parentWin;\n  win.__AMP_TOP = getTopWindow(parentWin);\n}\n\n\n/**\n * Returns the parent window for a child window (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getParentWindow(win) {\n  return win.__AMP_PARENT || win;\n}\n\n\n/**\n * Returns the top window where AMP Runtime is installed for a child window\n * (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getTopWindow(win) {\n  return win.__AMP_TOP || win;\n}\n\n\n/**\n * Returns the parent \"friendly\" iframe if the node belongs to a child window.\n * @param {!Node} node\n * @param {!Window} topWin\n * @return {?HTMLIFrameElement}\n */\nexport function getParentWindowFrameElement(node, topWin) {\n  const childWin = (node.ownerDocument || node).defaultView;\n  if (childWin && childWin != topWin && getTopWindow(childWin) == topWin) {\n    try {\n      return /** @type {?HTMLIFrameElement} */ (childWin.frameElement);\n    } catch (e) {\n      // Ignore the error.\n    }\n  }\n  return null;\n}\n\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc}\n */\nexport function getAmpdoc(nodeOrDoc) {\n  if (nodeOrDoc.nodeType) {\n    const win = toWin(/** @type {!Document} */ (\n      nodeOrDoc.ownerDocument || nodeOrDoc).defaultView);\n    return getAmpdocService(win).getAmpDoc(/** @type {!Node} */ (nodeOrDoc));\n  }\n  return /** @type {!./service/ampdoc-impl.AmpDoc} */ (nodeOrDoc);\n}\n\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc|!Window}\n */\nfunction getAmpdocServiceHolder(nodeOrDoc) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  return ampdoc.isSingleDoc() ? ampdoc.win : ampdoc;\n}\n\n\n/**\n * This is essentially a duplicate of `ampdoc.js`, but necessary to avoid\n * circular dependencies.\n * @param {!Window} win\n * @return {!./service/ampdoc-impl.AmpDocService}\n */\nfunction getAmpdocService(win) {\n  return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n    getService(win, 'ampdoc'));\n}\n\n\n/**\n * Get service `id` from `holder`. Assumes the service\n * has already been registered.\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {Object}\n * @template T\n */\nfunction getServiceInternal(holder, id) {\n  dev().assert(isServiceRegistered(holder, id),\n      `Expected service ${id} to be registered`);\n  const services = getServices(holder);\n  const s = services[id];\n  if (!s.obj) {\n    dev().assert(s.ctor, `Service ${id} registered without ctor nor impl.`);\n    dev().assert(s.context, `Service ${id} registered without context.`);\n    s.obj = new s.ctor(s.context);\n    dev().assert(s.obj, `Service ${id} constructed to null.`);\n    s.ctor = null;\n    s.context = null;\n    // The service may have been requested already, in which case we have a\n    // pending promise we need to fulfill.\n    if (s.resolve) {\n      s.resolve(s.obj);\n    }\n  }\n  return s.obj;\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {!Window|!./service/ampdoc-impl.AmpDoc} context Win or AmpDoc.\n * @param {string} id of the service.\n * @param {?function(new:Object, !Window)|?function(new:Object, !./service/ampdoc-impl.AmpDoc)} ctor Constructor function to new the service. Called with context.\n */\nfunction registerServiceInternal(holder, context, id, ctor) {\n  const services = getServices(holder);\n  let s = services[id];\n\n  if (!s) {\n    s = services[id] = {\n      obj: null,\n      promise: null,\n      resolve: null,\n      context: null,\n      ctor: null,\n    };\n  }\n\n  if (s.ctor || s.obj) {\n    // Service already registered.\n    return;\n  }\n\n  s.ctor = ctor;\n  s.context = context;\n\n  // The service may have been requested already, in which case there is a\n  // pending promise that needs to fulfilled.\n  if (s.resolve) {\n    // getServiceInternal will resolve the promise.\n    getServiceInternal(holder, id);\n  }\n}\n\n/**\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nfunction getServicePromiseInternal(holder, id) {\n  const cached = getServicePromiseOrNullInternal(holder, id);\n  if (cached) {\n    return cached;\n  }\n  // Service is not registered.\n\n  // TODO(@cramforce): Add a check that if the element is eventually registered\n  // that the service is actually provided and this promise resolves.\n  const deferred = new Deferred();\n  const {promise, resolve} = deferred;\n\n  const services = getServices(holder);\n  services[id] = {\n    obj: null,\n    promise,\n    resolve,\n    context: null,\n    ctor: null,\n  };\n  return promise;\n}\n\n\n/**\n * Returns a promise for service `id` if the service has been registered\n * on `holder`.\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {?Promise<!Object>}\n */\nfunction getServicePromiseOrNullInternal(holder, id) {\n  const services = getServices(holder);\n  const s = services[id];\n  if (s) {\n    if (s.promise) {\n      return s.promise;\n    } else {\n      // Instantiate service if not already instantiated.\n      getServiceInternal(holder, id);\n      return s.promise = Promise.resolve(/** @type {!Object} */ (s.obj));\n    }\n  }\n  return null;\n}\n\n\n/**\n * Returns the object that holds the services registered in a holder.\n * @param {!Object} holder\n * @return {!Object<string,!ServiceHolderDef>}\n */\nfunction getServices(holder) {\n  let {services} = holder;\n  if (!services) {\n    services = holder.services = {};\n  }\n  return services;\n}\n\n\n/**\n * Whether the specified service implements `Disposable` interface.\n * @param {!Object} service\n * @return {boolean}\n */\nexport function isDisposable(service) {\n  return typeof service.dispose == 'function';\n}\n\n\n/**\n * Asserts that the specified service implements `Disposable` interface and\n * typecasts the instance to `Disposable`.\n * @param {!Object} service\n * @return {!Disposable}\n */\nexport function assertDisposable(service) {\n  dev().assert(isDisposable(service), 'required to implement Disposable');\n  return /** @type {!Disposable} */ (service);\n}\n\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * ampdoc scope.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n */\nexport function disposeServicesForDoc(ampdoc) {\n  disposeServicesInternal(ampdoc);\n}\n\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * embed scope.\n * @param {!Window} embedWin\n */\nexport function disposeServicesForEmbed(embedWin) {\n  disposeServicesInternal(embedWin);\n}\n\n\n/**\n * @param {!Object} holder Object holding the service instances.\n */\nfunction disposeServicesInternal(holder) {\n  // TODO(dvoytenko): Consider marking holder as destroyed for later-arriving\n  // service to be canceled automatically.\n  const services = getServices(holder);\n  for (const id in services) {\n    if (!Object.prototype.hasOwnProperty.call(services, id)) {\n      continue;\n    }\n    const serviceHolder = services[id];\n    if (serviceHolder.obj) {\n      disposeServiceInternal(id, serviceHolder.obj);\n    } else if (serviceHolder.promise) {\n      serviceHolder.promise.then(\n          instance => disposeServiceInternal(id, instance));\n    }\n  }\n}\n\n\n/**\n * @param {string} id\n * @param {!Object} service\n */\nfunction disposeServiceInternal(id, service) {\n  if (!isDisposable(service)) {\n    return;\n  }\n  try {\n    assertDisposable(service).dispose();\n  } catch (e) {\n    // Ensure that a failure to dispose a service does not disrupt other\n    // services.\n    dev().error('SERVICE', 'failed to dispose service', id, e);\n  }\n}\n\n\n/**\n * Whether the specified service implements `EmbeddableService` interface.\n * @param {!Object} service\n * @return {boolean}\n */\nexport function isEmbeddable(service) {\n  return typeof service.adoptEmbedWindow == 'function';\n}\n\n\n/**\n * Adopts an embeddable (implements `EmbeddableService` interface) service\n * in embed scope.\n * @param {!Window} embedWin\n * @param {string} serviceId\n */\nexport function adoptServiceForEmbed(embedWin, serviceId) {\n  const adopted = adoptServiceForEmbedIfEmbeddable(embedWin, serviceId);\n  dev().assert(adopted, `Service ${serviceId} not found on parent ` +\n      'or doesn\\'t implement EmbeddableService.');\n}\n\n\n/**\n * Adopts an embeddable (implements `EmbeddableService` interface) service\n * in embed scope.\n * @param {!Window} embedWin\n * @param {string} serviceId\n * @return {boolean}\n */\nexport function adoptServiceForEmbedIfEmbeddable(embedWin, serviceId) {\n  const frameElement = /** @type {!Node} */ (dev().assert(\n      embedWin.frameElement,\n      'frameElement not found for embed'));\n  const ampdoc = getAmpdoc(frameElement);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  if (!isServiceRegistered(holder, serviceId)) {\n    return false;\n  }\n  const service = getServiceForDocDeprecated(frameElement, serviceId);\n  if (!isEmbeddable(service)) {\n    return false;\n  }\n  service.adoptEmbedWindow(embedWin);\n  return true;\n}\n\n\n/**\n * Resets a single service, so it gets recreated on next getService invocation.\n * @param {!Object} holder\n * @param {string} id of the service.\n */\nexport function resetServiceForTesting(holder, id) {\n  if (holder.services) {\n    holder.services[id] = null;\n  }\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {boolean}\n */\nfunction isServiceRegistered(holder, id) {\n  const service = holder.services && holder.services[id];\n  // All registered services must have an implementation or a constructor.\n  return !!(service && (service.ctor || service.obj));\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from '../services';\nimport {\n  closestByTag,\n  escapeCssSelectorIdent,\n  isIframed,\n  openWindowDialog,\n} from '../dom';\nimport {dev, user} from '../log';\nimport {\n  getExtraParamsUrl,\n  shouldAppendExtraParams,\n} from '../impression';\nimport {getMode} from '../mode';\nimport {\n  installServiceInEmbedScope,\n  registerServiceBuilderForDoc,\n} from '../service';\nimport {toWin} from '../types';\n\nconst TAG = 'navigation';\n/** @private @const {string} */\nconst EVENT_TYPE_CLICK = 'click';\n/** @private @const {string} */\nconst EVENT_TYPE_CONTEXT_MENU = 'contextmenu';\n\n/** @private @const {string} */\nconst ORIG_HREF_ATTRIBUTE = 'data-a4a-orig-href';\n\n/**\n * Install navigation service for ampdoc, which handles navigations from anchor\n * tag clicks and other runtime features like AMP.navigateTo().\n *\n * Immediately instantiates the service.\n *\n * @param {!./ampdoc-impl.AmpDoc} ampdoc\n */\nexport function installGlobalNavigationHandlerForDoc(ampdoc) {\n  registerServiceBuilderForDoc(\n      ampdoc,\n      TAG,\n      Navigation,\n      /* opt_instantiate */ true);\n}\n\n/**\n * @param {!./ampdoc-impl.AmpDoc} ampdoc\n * @param {!Event} e\n * @visibleForTesting\n */\nexport function maybeExpandUrlParamsForTesting(ampdoc, e) {\n  maybeExpandUrlParams(ampdoc, e);\n}\n\n/**\n * Intercept any click on the current document and prevent any\n * linking to an identifier from pushing into the history stack.\n * @implements {../service.EmbeddableService}\n * @visibleForTesting\n */\nexport class Navigation {\n  /**\n   * @param {!./ampdoc-impl.AmpDoc} ampdoc\n   * @param {(!Document|!ShadowRoot)=} opt_rootNode\n   */\n  constructor(ampdoc, opt_rootNode) {\n    /** @const {!./ampdoc-impl.AmpDoc} */\n    this.ampdoc = ampdoc;\n\n    /** @private @const {!Document|!ShadowRoot} */\n    this.rootNode_ = opt_rootNode || ampdoc.getRootNode();\n\n    /** @private @const {!./viewport/viewport-impl.Viewport} */\n    this.viewport_ = Services.viewportForDoc(this.ampdoc);\n\n    /** @private @const {!./viewer-impl.Viewer} */\n    this.viewer_ = Services.viewerForDoc(this.ampdoc);\n\n    /** @private @const {!./history-impl.History} */\n    this.history_ = Services.historyForDoc(this.ampdoc);\n\n    const platform = Services.platformFor(this.ampdoc.win);\n    /** @private @const {boolean} */\n    this.isIosSafari_ = platform.isIos() && platform.isSafari();\n\n    /** @private @const {boolean} */\n    this.isIframed_ =\n        isIframed(this.ampdoc.win) && this.viewer_.isOvertakeHistory();\n\n    /** @private @const {boolean} */\n    this.isEmbed_ = this.rootNode_ != this.ampdoc.getRootNode();\n\n    /** @private @const {boolean} */\n    this.isInABox_ = getMode(this.ampdoc.win).runtime == 'inabox';\n\n\n    /** @private @const {!function(!Event)|undefined} */\n    this.boundHandle_ = this.handle_.bind(this);\n    this.rootNode_.addEventListener(EVENT_TYPE_CLICK, this.boundHandle_);\n    this.rootNode_.addEventListener(EVENT_TYPE_CONTEXT_MENU, this.boundHandle_);\n    /** @private {boolean} */\n    this.appendExtraParams_ = false;\n    shouldAppendExtraParams(this.ampdoc).then(res => {\n      this.appendExtraParams_ = res;\n    });\n\n    /**\n     * Lazy-generated list of A2A-enabled navigation features.\n     * @private {?Array<string>}\n     */\n    this.a2aFeatures_ = null;\n  }\n\n  /**\n   * Registers a handler that performs URL replacement on the href\n   * of an ad click.\n   * @param {!./ampdoc-impl.AmpDoc} ampdoc\n   * @param {!Window} win\n   */\n  static installAnchorClickInterceptor(ampdoc, win) {\n    win.document.documentElement.addEventListener('click',\n        maybeExpandUrlParams.bind(null, ampdoc), /* capture */ true);\n  }\n\n  /** @override */\n  adoptEmbedWindow(embedWin) {\n    installServiceInEmbedScope(embedWin, TAG,\n        new Navigation(this.ampdoc, embedWin.document));\n  }\n\n  /**\n   * Removes all event listeners.\n   */\n  cleanup() {\n    if (this.boundHandle_) {\n      this.rootNode_.removeEventListener(EVENT_TYPE_CLICK, this.boundHandle_);\n      this.rootNode_.removeEventListener(\n          EVENT_TYPE_CONTEXT_MENU, this.boundHandle_);\n    }\n  }\n\n  /**\n   * Navigates a window to a URL.\n   *\n   * If opt_requestedBy matches a feature name in a <meta> tag with attribute\n   * name=\"amp-to-amp-navigation\", then treats the URL as an AMP URL (A2A).\n   *\n   * @param {!Window} win\n   * @param {string} url\n   * @param {string=} opt_requestedBy\n   */\n  navigateTo(win, url, opt_requestedBy) {\n    const urlService = Services.urlForDoc(this.ampdoc);\n    if (!urlService.isProtocolValid(url)) {\n      user().error(TAG, 'Cannot navigate to invalid protocol: ' + url);\n      return;\n    }\n\n    // If this redirect was requested by a feature that opted into A2A,\n    // try to ask the viewer to navigate this AMP URL.\n    if (opt_requestedBy) {\n      if (!this.a2aFeatures_) {\n        this.a2aFeatures_ = this.queryA2AFeatures_();\n      }\n      if (this.a2aFeatures_.includes(opt_requestedBy)) {\n        if (this.viewer_.navigateToAmpUrl(url, opt_requestedBy)) {\n          return;\n        }\n      }\n    }\n\n    // Otherwise, perform normal behavior of navigating the top frame.\n    win.top.location.href = url;\n  }\n\n  /**\n   * @return {!Array<string>}\n   * @private\n   */\n  queryA2AFeatures_() {\n    const meta = this.rootNode_.querySelector(\n        'meta[name=\"amp-to-amp-navigation\"]');\n    if (meta && meta.hasAttribute('content')) {\n      return meta.getAttribute('content').split(',').map(s => s.trim());\n    }\n    return [];\n  }\n\n  /**\n   * Intercept any click on the current document and prevent any\n   * linking to an identifier from pushing into the history stack.\n   *\n   * This also handles custom protocols (e.g. whatsapp://) when iframed\n   * on iOS Safari.\n   *\n   * @param {!Event} e\n   * @private\n   */\n  handle_(e) {\n    if (e.defaultPrevented) {\n      return;\n    }\n    const target = closestByTag(dev().assertElement(e.target), 'A');\n    if (!target || !target.href) {\n      return;\n    }\n    if (e.type == EVENT_TYPE_CLICK) {\n      this.handleClick_(target, e);\n    } else if (e.type == EVENT_TYPE_CONTEXT_MENU) {\n      // Handles contextmenu click. Note that currently this only deals\n      // with url variable substitution and expansion, as there is\n      // straightforward way of determining what the user clicked in the\n      // context menu, required for A2A navigation and custom link protocol\n      // handling.\n      // TODO(alabiaga): investigate fix for handling A2A and custom link\n      // protocols.\n      this.expandVarsForAnchor_(target);\n    }\n  }\n\n  /**\n   * @param {!Element} target\n   * @param {!Event} e\n   * @private\n   */\n  handleClick_(target, e) {\n    this.expandVarsForAnchor_(target);\n\n    const location = this.parseUrl_(target.href);\n\n    // Handle AMP-to-AMP navigation if rel=amphtml.\n    if (this.handleA2AClick_(e, target, location)) {\n      return;\n    }\n\n    // Handle navigating to custom protocol if applicable.\n    if (this.handleCustomProtocolClick_(e, target, location)) {\n      return;\n    }\n\n    // Finally, handle normal click-navigation behavior.\n    this.handleNavClick_(e, target, location);\n  }\n\n  /**\n   * @param {!Element} el\n   * @private\n   */\n  expandVarsForAnchor_(el) {\n    // First check if need to handle external link decoration.\n    let defaultExpandParamsUrl = null;\n    if (this.appendExtraParams_ && !this.isEmbed_) {\n      // Only decorate outgoing link when needed to and is not in FIE.\n      defaultExpandParamsUrl = getExtraParamsUrl(this.ampdoc.win, el);\n    }\n\n    const urlReplacements = Services.urlReplacementsForDoc(el);\n    urlReplacements.maybeExpandLink(el, defaultExpandParamsUrl);\n  }\n\n  /**\n   * Handles clicking on a custom protocol link.\n   * Returns true if the navigation was handled. Otherwise, returns false.\n   * @param {!Event} e\n   * @param {!Element} target\n   * @param {!Location} location\n   * @return {boolean}\n   * @private\n   */\n  handleCustomProtocolClick_(e, target, location) {\n    // Handle custom protocols only if the document is iframed.\n    if (!this.isIframed_) {\n      return false;\n    }\n\n    /** @const {!Window} */\n    const win = toWin(target.ownerDocument.defaultView);\n    const url = target.href;\n    const {protocol} = location;\n\n    // On Safari iOS, custom protocol links will fail to open apps when the\n    // document is iframed - in order to go around this, we set the top.location\n    // to the custom protocol href.\n    const isFTP = protocol == 'ftp:';\n\n    // In case of FTP Links in embedded documents always open then in _blank.\n    if (isFTP) {\n      openWindowDialog(win, url, '_blank');\n      e.preventDefault();\n      return true;\n    }\n\n    const isNormalProtocol = /^(https?|mailto):$/.test(protocol);\n    if (this.isIosSafari_ && !isNormalProtocol) {\n      openWindowDialog(win, url, '_top');\n      // Without preventing default the page would should an alert error twice\n      // in the case where there's no app to handle the custom protocol.\n      e.preventDefault();\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Handles clicking on an AMP link.\n   * Returns true if the navigation was handled. Otherwise, returns false.\n   * @param {!Event} e\n   * @param {!Element} target\n   * @param {!Location} location\n   * @return {boolean}\n   * @private\n   */\n  handleA2AClick_(e, target, location) {\n    if (!target.hasAttribute('rel')) {\n      return false;\n    }\n    const relations = target.getAttribute('rel').split(' ').map(s => s.trim());\n    if (!relations.includes('amphtml')) {\n      return false;\n    }\n    // The viewer may not support the capability for navigating AMP links.\n    if (this.viewer_.navigateToAmpUrl(location.href, '<a rel=amphtml>')) {\n      e.preventDefault();\n      return true;\n    }\n    return false;\n  }\n\n\n  /**\n   * Handles clicking on a link with hash navigation.\n   * @param {!Event} e\n   * @param {!Element} target\n   * @param {!Location} tgtLoc\n   * @private\n   */\n  handleNavClick_(e, target, tgtLoc) {\n    // In test mode, we're not able to properly fix the anchor tag's base URL.\n    // So, we have to use the (mocked) window's location instead.\n    const baseHref = getMode().test && !this.isEmbed_\n      ? this.ampdoc.win.location.href\n      : '';\n    const curLoc = this.parseUrl_(baseHref);\n    const tgtHref = `${tgtLoc.origin}${tgtLoc.pathname}${tgtLoc.search}`;\n    const curHref = `${curLoc.origin}${curLoc.pathname}${curLoc.search}`;\n\n    // If the current target anchor link is the same origin + path\n    // as the current document then we know we are just linking to an\n    // identifier in the document. Otherwise, it's an external navigation.\n    if (!tgtLoc.hash || tgtHref != curHref) {\n      if (this.isEmbed_ || this.isInABox_) {\n        // Target in the embed must be either _top or _blank. If none specified,\n        // force to _blank.\n        const targetAttr = (target.getAttribute('target') || '').toLowerCase();\n        if (targetAttr != '_top' && targetAttr != '_blank') {\n          target.setAttribute('target', '_blank');\n        }\n      }\n      return;\n    }\n\n    // We prevent default so that the current click does not push\n    // into the history stack as this messes up the external documents\n    // history which contains the amp document.\n    e.preventDefault();\n\n    // For an embed, do not perform scrolling or global history push - both have\n    // significant UX and browser problems.\n    if (this.isEmbed_) {\n      return;\n    }\n\n    // Look for the referenced element.\n    const hash = tgtLoc.hash.slice(1);\n    let elem = null;\n    if (hash) {\n      const escapedHash = escapeCssSelectorIdent(hash);\n      elem = (this.rootNode_.getElementById(hash) ||\n          // Fallback to anchor[name] if element with id is not found.\n          // Linking to an anchor element with name is obsolete in html5.\n          this.rootNode_./*OK*/querySelector(`a[name=\"${escapedHash}\"]`));\n    }\n\n    // If possible do update the URL with the hash. As explained above\n    // we do `replace` to avoid messing with the container's history.\n    if (tgtLoc.hash != curLoc.hash) {\n      this.history_.replaceStateForTarget(tgtLoc.hash).then(() => {\n        this.scrollToElement_(elem, hash);\n      });\n    } else {\n      // If the hash did not update just scroll to the element.\n      this.scrollToElement_(elem, hash);\n    }\n  }\n\n  /**\n   * Scrolls the page to the given element.\n   * @param {?Element} elem\n   * @param {string} hash\n   * @private\n   */\n  scrollToElement_(elem, hash) {\n    // Scroll to the element if found.\n    if (elem) {\n      // The first call to scrollIntoView overrides browsers' default scrolling\n      // behavior. The second call insides setTimeout allows us to scroll to\n      // that element properly. Without doing this, the viewport will not catch\n      // the updated scroll position on iOS Safari and hence calculate the wrong\n      // scrollTop for the scrollbar jumping the user back to the top for\n      // failing to calculate the new jumped offset. Without the first call\n      // there will be a visual jump due to browser scroll. See\n      // https://github.com/ampproject/amphtml/issues/5334 for more details.\n      this.viewport_./*OK*/scrollIntoView(elem);\n      Services.timerFor(this.ampdoc.win).delay(() =>\n        this.viewport_./*OK*/scrollIntoView(dev().assertElement(elem)), 1);\n    } else {\n      dev().warn(TAG,\n          `failed to find element with id=${hash} or a[name=${hash}]`);\n    }\n  }\n\n  /**\n   * @param {string} url\n   * @return {!Location}\n   * @private\n   */\n  parseUrl_(url) {\n    // Must use URL parsing scoped to this.rootNode_ for correct FIE behavior.\n    return Services.urlForDoc(this.rootNode_).parse(url);\n  }\n}\n\n/**\n * Handle click on links and replace variables in the click URL.\n * The function changes the actual href value and stores the\n * template in the ORIGINAL_HREF_ATTRIBUTE attribute\n * @param {!./ampdoc-impl.AmpDoc} ampdoc\n * @param {!Event} e\n */\nfunction maybeExpandUrlParams(ampdoc, e) {\n  const target = closestByTag(dev().assertElement(e.target), 'A');\n  if (!target || !target.href) {\n    // Not a click on a link.\n    return;\n  }\n  const hrefToExpand =\n      target.getAttribute(ORIG_HREF_ATTRIBUTE) || target.getAttribute('href');\n  if (!hrefToExpand) {\n    return;\n  }\n  const vars = {\n    'CLICK_X': () => {\n      return e.pageX;\n    },\n    'CLICK_Y': () => {\n      return e.pageY;\n    },\n  };\n  const newHref = Services.urlReplacementsForDoc(ampdoc).expandUrlSync(\n      hrefToExpand, vars, undefined, /* opt_whitelist */ {\n        // For now we only allow to replace the click location vars\n        // and nothing else.\n        // NOTE: Addition to this whitelist requires additional review.\n        'CLICK_X': true,\n        'CLICK_Y': true,\n      });\n  if (newHref != hrefToExpand) {\n    // Store original value so that later clicks can be processed with\n    // freshest values.\n    if (!target.getAttribute(ORIG_HREF_ATTRIBUTE)) {\n      target.setAttribute(ORIG_HREF_ATTRIBUTE, hrefToExpand);\n    }\n    target.setAttribute('href', newHref);\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hasOwn} from '../../utils/object';\nimport {rethrowAsync, user} from '../../log';\nimport {tryResolve} from '../../utils/promise';\n\n/** @private @const {string} */\nconst PARSER_IGNORE_FLAG = '`';\n\n/** @private @const {string} */\nconst TAG = 'Expander';\n\n/** A whitelist for replacements whose values should not be %-encoded. */\n/** @const {Object<string, boolean>} */\nexport const NOENCODE_WHITELIST = {'ANCESTOR_ORIGIN': true};\n\n/** Rudamentary parser to handle nested Url replacement. */\nexport class Expander {\n\n  /**\n   * Link this instance of parser to the calling UrlReplacment\n   * @param {!../variable-source.VariableSource|null} variableSource the keywords to replace\n   */\n  constructor(variableSource) {\n    this.variableSource_ = variableSource;\n  }\n\n\n  /**\n   * take the template url and return a promise of its evaluated value\n   * @param {string} url url to be substituted\n   * @param {!Object<string, *>=} opt_bindings additional one-off bindings\n   * @param {!Object<string, *>=} opt_collectVars Object passed in to collect\n   *   variable resolutions.\n   * @param {boolean=} opt_sync If the method should resolve syncronously.\n   * @param {!Object<string, boolean>=} opt_whiteList Optional white list of names\n   *   that can be substituted.\n   * @return {!Promise<string>|string}\n   */\n  expand(url, opt_bindings, opt_collectVars, opt_sync, opt_whiteList) {\n    if (!url.length) {\n      return opt_sync ? url : Promise.resolve(url);\n    }\n    const expr = this.variableSource_\n        .getExpr(opt_bindings, /*opt_ignoreArgs */ true, opt_whiteList);\n\n    const matches = this.findMatches_(url, expr);\n    // if no keywords move on\n    if (!matches.length) {\n      return opt_sync ? url : Promise.resolve(url);\n    }\n    return this.parseUrlRecursively_(url, matches, opt_bindings,\n        opt_collectVars, opt_sync);\n  }\n\n\n  /**\n   * Structures the regex matching into the desired format\n   * @param {string} url url to be substituted\n   * @param {RegExp} expression regex containing all keywords\n   * @return {Array<Object<string, string|number>>} array of objects representing\n   *  matching keywords\n   */\n  findMatches_(url, expression) {\n    const matches = [];\n    url.replace(expression, (match, name, startPosition) => {\n      const {length} = match;\n      const stopPosition = length + startPosition - 1;\n      const info = {\n        start: startPosition,\n        stop: stopPosition,\n        name,\n        length,\n      };\n      matches.push(info);\n    });\n    return matches;\n  }\n\n\n  /**\n   * @param {string} url\n   * @param {!Array<Object<string, string|number>>} matches Array of objects\n   *   representing matching keywords.\n   * @param {!Object<string, *>=} opt_bindings Additional one-off bindings.\n   * @param {!Object<string, *>=} opt_collectVars Object passed in to collect\n   *   variable resolutions.\n   * @param {boolean=} opt_sync\n   * @return {!Promise<string>|string}\n   */\n  parseUrlRecursively_(url, matches, opt_bindings, opt_collectVars, opt_sync) {\n    const stack = [];\n    let urlIndex = 0;\n    let matchIndex = 0;\n    let match = matches[matchIndex];\n    let numOfPendingCalls = 0;\n    let ignoringChars = false;\n    let nextArgShouldBeRaw = false;\n\n    const evaluateNextLevel = () => {\n      let builder = '';\n      const results = [];\n\n      while (urlIndex < url.length && matchIndex <= matches.length) {\n        if (match && urlIndex === match.start) {\n          let binding;\n          // find out where this keyword is coming from\n          if (opt_bindings && hasOwn(opt_bindings, match.name)) {\n            // the optional bindings\n            binding = {\n              // This construction helps us save the match name and determine\n              // precedence of resolution choices in #expandBinding_ later.\n              name: match.name,\n              prioritized: opt_bindings[match.name],\n            };\n          } else {\n            // or the global source\n            binding = this.variableSource_.get(match.name);\n            binding.name = match.name;\n          }\n\n          urlIndex = match.stop + 1;\n          match = matches[++matchIndex];\n\n          if (url[urlIndex] === '(') {\n            // if we hit a left parenthesis we still need to get args\n            urlIndex++;\n            numOfPendingCalls++;\n            stack.push(binding);\n            // trim space in between args\n            if (builder.trim().length) {\n              results.push(builder);\n            }\n            results.push(evaluateNextLevel());\n          } else {\n            if (builder.length) {\n              results.push(builder);\n            }\n            results.push(this.evaluateBinding_(binding,\n                /* opt_args */ undefined, opt_collectVars, opt_sync));\n          }\n\n          builder = '';\n        }\n\n        else if (url[urlIndex] === PARSER_IGNORE_FLAG) {\n          if (!ignoringChars) {\n            ignoringChars = true;\n            nextArgShouldBeRaw = true;\n            user().assert(builder.trim() === '',\n                `The substring \"${builder}\" was lost during url-replacement. ` +\n                'Please ensure the url syntax is correct');\n            builder = '';\n          } else {\n            ignoringChars = false;\n          }\n          urlIndex++;\n        }\n\n        else if (numOfPendingCalls && url[urlIndex] === ',' && !ignoringChars) {\n          if (builder.length) {\n            const nextArg = nextArgShouldBeRaw ? builder : builder.trim();\n            results.push(nextArg);\n            nextArgShouldBeRaw = false;\n          }\n          // support existing two comma format\n          // eg CLIENT_ID(__ga,,ga-url)\n          if (url[urlIndex + 1] === ',') {\n            results.push(''); // TODO(ccordry): may want this to be undefined at some point\n            urlIndex++;\n          }\n          builder = '';\n          urlIndex++;\n        }\n\n        // Invoke a function on every right parenthesis unless the stack is\n        // empty.\n        else if (numOfPendingCalls && url[urlIndex] === ')' && !ignoringChars) {\n          urlIndex++;\n          numOfPendingCalls--;\n          const binding = stack.pop();\n          const nextArg = nextArgShouldBeRaw ? builder : builder.trim();\n          results.push(nextArg);\n          nextArgShouldBeRaw = false;\n          const value = this.evaluateBinding_(binding, /* opt_args */ results,\n              opt_collectVars, opt_sync);\n          return value;\n        }\n\n        else {\n          builder += url[urlIndex];\n          urlIndex++;\n        }\n\n        //capture trailing characters\n        if (urlIndex === url.length && builder.length) {\n          results.push(builder);\n        }\n      }\n\n      if (opt_sync) {\n        return results.join('');\n      }\n\n      return Promise.all(results)\n          .then(promiseArray => promiseArray.join(''))\n          .catch(e => {\n            rethrowAsync(e);\n            return '';\n          });\n    };\n\n    return evaluateNextLevel();\n  }\n\n\n  /**\n   * Called when a binding is ready to be resolved. Determines which version of\n   * binding to use and if syncronous or asyncronous version should be called.\n   * @param {Object<string, *>} bindingInfo An object containing the name of macro\n   *   and value to be resolved.\n   * @param {Array=} opt_args Arguments passed to the macro.\n   * @param {!Object<string, *>=} opt_collectVars Object passed in to collect\n   *   variable resolutions.\n   * @param {*=} opt_sync Whether the binding should be resolved synchronously.\n   */\n  evaluateBinding_(bindingInfo, opt_args, opt_collectVars, opt_sync) {\n    const {name} = bindingInfo;\n    let binding;\n    if (bindingInfo.prioritized) {\n      // If a binding is passed in through opt_bindings it always takes\n      // precedence.\n      binding = bindingInfo.prioritized;\n    } else if (opt_sync && bindingInfo.sync) {\n      // Use the sync resolution if avaliable when called synchronously.\n      binding = bindingInfo.sync;\n    } else if (opt_sync) {\n      // If there is no sync resolution we can not wait.\n      user().error(TAG, 'ignoring async replacement key: ', bindingInfo.name);\n      binding = '';\n    } else {\n      // Prefer the async over the sync but it may not exist.\n      binding = bindingInfo.async || bindingInfo.sync;\n    }\n    return opt_sync ?\n      this.evaluateBindingSync_(binding, name, opt_args, opt_collectVars) :\n      this.evaluateBindingAsync_(binding, name, opt_args, opt_collectVars);\n  }\n\n\n  /**\n   * Resolves binding to value to be substituted asyncronously.\n   * @param {*} binding Container for sync/async resolutions.\n   * @param {string} name\n   * @param {?Array=} opt_args Arguments to be passed if binding is function.\n   * @param {!Object<string, *>=} opt_collectVars Object passed in to collect\n   *   variable resolutions.\n   * @return {!Promise<string>} Resolved value.\n   */\n  evaluateBindingAsync_(binding, name, opt_args, opt_collectVars) {\n    let value;\n    try {\n      if (typeof binding === 'function') {\n        if (opt_args) {\n          value = Promise.all(opt_args)\n              .then(args => binding.apply(null, args));\n        } else {\n          value = tryResolve(binding);\n        }\n      } else {\n        value = Promise.resolve(binding);\n      }\n      return value.then(val => {\n        let result;\n\n        if (val == null) {\n          result = '';\n        } else {\n          result = NOENCODE_WHITELIST[name] ? val : encodeURIComponent(val);\n        }\n\n        if (opt_collectVars) {\n          opt_collectVars[name] = result;\n        }\n        return result;\n      }).catch(e => {\n        rethrowAsync(e);\n        if (opt_collectVars) {\n          opt_collectVars[name] = '';\n        }\n        return Promise.resolve('');\n      });\n\n    } catch (e) {\n      // Report error, but do not disrupt URL replacement. This will\n      // interpolate as the empty string.\n      rethrowAsync(e);\n      if (opt_collectVars) {\n        opt_collectVars[name] = '';\n      }\n      return Promise.resolve('');\n    }\n  }\n\n\n  /**\n   * Resolves binding to value to be substituted asyncronously.\n   * @param {*} binding Container for sync/async resolutions.\n   * @param {string} name\n   * @param {?Array=} opt_args Arguments to be passed if binding is function.\n   * @param {!Object<string, *>=} opt_collectVars Object passed in to collect\n   *   variable resolutions.\n   * @return {string} Resolved value.\n   */\n  evaluateBindingSync_(binding, name, opt_args, opt_collectVars) {\n    try {\n      const value = typeof binding === 'function' ?\n        binding.apply(null, opt_args) : binding;\n\n      let result;\n\n      if (value && value.then) {\n        // If binding is passed in as opt_binding we try to resolve it and it\n        // may return a promise.\n        user().error(TAG, 'ignoring async macro resolution');\n        result = '';\n      } else if (typeof value === 'string' || typeof value === 'number') {\n        // Normal case.\n        result = NOENCODE_WHITELIST[name] ? value.toString() :\n          encodeURIComponent(/** @type {string} */ (value));\n      } else {\n        // Most likely a broken binding gets us here.\n        result = '';\n      }\n\n      if (opt_collectVars) {\n        opt_collectVars[name] = result;\n      }\n\n      return result;\n    } catch (e) {\n      // Report error, but do not disrupt URL replacement. This will\n      // interpolate as the empty string.\n      rethrowAsync(e);\n      if (opt_collectVars) {\n        opt_collectVars[name] = '';\n      }\n      return '';\n    }\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  AsyncResolverDef,\n  ResolverReturnDef,\n  SyncResolverDef,\n  VariableSource,\n  getNavigationData,\n  getTimingDataAsync,\n  getTimingDataSync,\n} from './variable-source';\nimport {Expander, NOENCODE_WHITELIST} from './url-expander/expander';\nimport {Services} from '../services';\nimport {WindowInterface} from '../window-interface';\nimport {\n  addParamsToUrl,\n  getSourceUrl,\n  parseQueryString,\n  parseUrlDeprecated,\n  removeAmpJsParamsFromUrl,\n  removeFragment,\n  removeSearch,\n} from '../url';\nimport {dev, rethrowAsync, user} from '../log';\nimport {getTrackImpressionPromise} from '../impression.js';\nimport {hasOwn} from '../utils/object';\nimport {\n  installServiceInEmbedScope,\n  registerServiceBuilderForDoc,\n} from '../service';\nimport {isExperimentOn} from '../experiments';\nimport {isProtocolValid} from '../url';\nimport {tryResolve} from '../utils/promise';\n\n/** @private @const {string} */\nconst TAG = 'UrlReplacements';\nconst EXPERIMENT_DELIMITER = '!';\nconst VARIANT_DELIMITER = '.';\nconst GEO_DELIM = ',';\nconst ORIGINAL_HREF_PROPERTY = 'amp-original-href';\nconst ORIGINAL_VALUE_PROPERTY = 'amp-original-value';\n\n/**\n * Returns a encoded URI Component, or an empty string if the value is nullish.\n * @param {*} val\n * @return {string}\n */\nfunction encodeValue(val) {\n  if (val == null) {\n    return '';\n  }\n  return encodeURIComponent(/** @type {string} */(val));\n}\n\n/**\n * Returns a function that executes method on a new Date instance. This is a\n * byte saving hack.\n *\n * @param {string} method\n * @return {!SyncResolverDef}\n */\nfunction dateMethod(method) {\n  return () => new Date()[method]();\n}\n\n/**\n * Returns a function that returns property of screen. This is a byte saving\n * hack.\n *\n * @param {!Screen} screen\n * @param {string} property\n * @return {!SyncResolverDef}\n */\nfunction screenProperty(screen, property) {\n  return () => screen[property];\n}\n\n/**\n * Class to provide variables that pertain to top level AMP window.\n */\nexport class GlobalVariableSource extends VariableSource {\n  /**\n   * @param {!./ampdoc-impl.AmpDoc} ampdoc\n   */\n  constructor(ampdoc) {\n    super(ampdoc);\n\n    /** @private {?Promise<?Object<string, string>>} */\n    this.variants_ = null;\n\n    /** @private {?Promise<?ShareTrackingFragmentsDef>} */\n    this.shareTrackingFragments_ = null;\n  }\n\n  /**\n   * Utility function for setting resolver for timing data that supports\n   * sync and async.\n   * @param {string} varName\n   * @param {string} startEvent\n   * @param {string=} endEvent\n   * @return {!VariableSource}\n   * @private\n   */\n  setTimingResolver_(varName, startEvent, endEvent) {\n    return this.setBoth(varName, () => {\n      return getTimingDataSync(this.ampdoc.win, startEvent, endEvent);\n    }, () => {\n      return getTimingDataAsync(this.ampdoc.win, startEvent, endEvent);\n    });\n  }\n\n  /** @override */\n  initialize() {\n    /** @const {!./viewport/viewport-impl.Viewport} */\n    const viewport = Services.viewportForDoc(this.ampdoc);\n\n    // Returns a random value for cache busters.\n    this.set('RANDOM', () => Math.random());\n\n    // Provides a counter starting at 1 per given scope.\n    const counterStore = Object.create(null);\n    this.set('COUNTER', scope => {\n      return counterStore[scope] = (counterStore[scope] | 0) + 1;\n    });\n\n    // Returns the canonical URL for this AMP document.\n    this.set('CANONICAL_URL', this.getDocInfoUrl_('canonicalUrl'));\n\n    // Returns the host of the canonical URL for this AMP document.\n    this.set('CANONICAL_HOST', this.getDocInfoUrl_('canonicalUrl', 'host'));\n\n    // Returns the hostname of the canonical URL for this AMP document.\n    this.set('CANONICAL_HOSTNAME', this.getDocInfoUrl_('canonicalUrl',\n        'hostname'));\n\n    // Returns the path of the canonical URL for this AMP document.\n    this.set('CANONICAL_PATH', this.getDocInfoUrl_('canonicalUrl', 'pathname'));\n\n    // Returns the referrer URL.\n    this.setAsync('DOCUMENT_REFERRER', /** @type {AsyncResolverDef} */(() => {\n      return Services.viewerForDoc(this.ampdoc).getReferrerUrl();\n    }));\n\n    // Like DOCUMENT_REFERRER, but returns null if the referrer is of\n    // same domain or the corresponding CDN proxy.\n    this.setAsync('EXTERNAL_REFERRER', /** @type {AsyncResolverDef} */(() => {\n      return Services.viewerForDoc(this.ampdoc).getReferrerUrl()\n          .then(referrer => {\n            if (!referrer) {\n              return null;\n            }\n            const referrerHostname = parseUrlDeprecated(getSourceUrl(referrer))\n                .hostname;\n            const currentHostname =\n                WindowInterface.getHostname(this.ampdoc.win);\n            return referrerHostname === currentHostname ? null : referrer;\n          });\n    }));\n\n    // Returns the title of this AMP document.\n    this.set('TITLE', () => {\n      // The environment may override the title and set originalTitle. Prefer\n      // that if available.\n      return this.ampdoc.win.document['originalTitle'] ||\n          this.ampdoc.win.document.title;\n    });\n\n    // Returns the URL for this AMP document.\n    this.set('AMPDOC_URL', () => {\n      return removeFragment(\n          this.addReplaceParamsIfMissing_(\n              this.ampdoc.win.location.href));\n    });\n\n    // Returns the host of the URL for this AMP document.\n    this.set('AMPDOC_HOST', () => {\n      const url = parseUrlDeprecated(this.ampdoc.win.location.href);\n      return url && url.host;\n    });\n\n    // Returns the hostname of the URL for this AMP document.\n    this.set('AMPDOC_HOSTNAME', () => {\n      const url = parseUrlDeprecated(this.ampdoc.win.location.href);\n      return url && url.hostname;\n    });\n\n    // Returns the Source URL for this AMP document.\n    const expandSourceUrl = () => {\n      const docInfo = Services.documentInfoForDoc(this.ampdoc);\n      return removeFragment(this.addReplaceParamsIfMissing_(docInfo.sourceUrl));\n    };\n    this.setBoth('SOURCE_URL',\n        () => expandSourceUrl(),\n        () => getTrackImpressionPromise().then(() => expandSourceUrl()));\n\n    // Returns the host of the Source URL for this AMP document.\n    this.set('SOURCE_HOST', this.getDocInfoUrl_('sourceUrl', 'host'));\n\n    // Returns the hostname of the Source URL for this AMP document.\n    this.set('SOURCE_HOSTNAME', this.getDocInfoUrl_('sourceUrl', 'hostname'));\n\n    // Returns the path of the Source URL for this AMP document.\n    this.set('SOURCE_PATH', this.getDocInfoUrl_('sourceUrl', 'pathname'));\n\n    // Returns a random string that will be the constant for the duration of\n    // single page view. It should have sufficient entropy to be unique for\n    // all the page views a single user is making at a time.\n    this.set('PAGE_VIEW_ID', this.getDocInfoUrl_('pageViewId'));\n\n    this.setBoth('QUERY_PARAM', (param, defaultValue = '') => {\n      return this.getQueryParamData_(param, defaultValue);\n    }, (param, defaultValue = '') => {\n      return getTrackImpressionPromise().then(() => {\n        return this.getQueryParamData_(param, defaultValue);\n      });\n    });\n\n    // Returns the value of the given field name in the fragment query string.\n    // Second parameter is an optional default value.\n    // For example, if location is 'pub.com/amp.html?x=1#y=2' then\n    // FRAGMENT_PARAM(y) returns '2' and FRAGMENT_PARAM(z, 3) returns 3.\n    this.setAsync('FRAGMENT_PARAM',\n        this.getViewerIntegrationValue_('fragmentParam', 'FRAGMENT_PARAM'));\n\n    // Returns the first item in the ancestorOrigins array, if available.\n    this.setAsync('ANCESTOR_ORIGIN',\n        this.getViewerIntegrationValue_('ancestorOrigin', 'ANCESTOR_ORIGIN'));\n\n    /**\n     * Stores client ids that were generated during this page view\n     * indexed by scope.\n     * @type {?Object<string, string>}\n     */\n    let clientIds = null;\n    // Synchronous alternative. Only works for scopes that were previously\n    // requested using the async method.\n    this.setBoth('CLIENT_ID', scope => {\n      if (!clientIds) {\n        return null;\n      }\n      return clientIds[dev().assertString(scope)];\n    }, (scope, opt_userNotificationId, opt_cookieName) => {\n      user().assertString(scope,\n          'The first argument to CLIENT_ID, the fallback' +\n          /*OK*/' Cookie name, is required');\n      let consent = Promise.resolve();\n\n      // If no `opt_userNotificationId` argument is provided then\n      // assume consent is given by default.\n      if (opt_userNotificationId) {\n        consent = Services.userNotificationManagerForDoc(this.ampdoc)\n            .then(service => {\n              return service.get(opt_userNotificationId);\n            });\n      }\n      return Services.cidForDoc(this.ampdoc).then(cid => {\n        return cid.get({\n          scope: dev().assertString(scope),\n          createCookieIfNotPresent: true,\n          cookieName: opt_cookieName,\n        }, consent);\n      }).then(cid => {\n        if (!clientIds) {\n          clientIds = Object.create(null);\n        }\n\n        // A temporary work around to extract Client ID from _ga cookie. #5761\n        // TODO: replace with \"filter\" when it's in place. #2198\n        const cookieName = opt_cookieName || scope;\n        if (cid && cookieName == '_ga') {\n          if (typeof cid === 'string') {\n            cid = extractClientIdFromGaCookie(cid);\n          } else {\n            // TODO(@jridgewell, #11120): remove once #11120 is figured out.\n            // Do not log the CID directly, that's PII.\n            dev().error(TAG, 'non-string cid, what is it?', Object.keys(cid));\n          }\n        }\n\n        clientIds[scope] = cid;\n        return cid;\n      });\n    });\n\n    // Returns assigned variant name for the given experiment.\n    this.setAsync('VARIANT', /** @type {AsyncResolverDef} */(experiment => {\n      return this.getVariantsValue_(variants => {\n        const variant = variants[/** @type {string} */(experiment)];\n        user().assert(variant !== undefined,\n            'The value passed to VARIANT() is not a valid experiment name:' +\n                experiment);\n        // When no variant assigned, use reserved keyword 'none'.\n        return variant === null ? 'none' : /** @type {string} */(variant);\n      }, 'VARIANT');\n    }));\n\n    // Returns all assigned experiment variants in a serialized form.\n    this.setAsync('VARIANTS', /** @type {AsyncResolverDef} */(() => {\n      return this.getVariantsValue_(variants => {\n        const experiments = [];\n        for (const experiment in variants) {\n          const variant = variants[experiment];\n          experiments.push(\n              experiment + VARIANT_DELIMITER + (variant || 'none'));\n        }\n        return experiments.join(EXPERIMENT_DELIMITER);\n      }, 'VARIANTS');\n    }));\n\n    // Returns assigned geo value for geoType or all groups.\n    this.setAsync('AMP_GEO', /** @type {AsyncResolverDef} */(geoType => {\n      return this.getGeo_(geos => {\n        if (geoType) {\n          user().assert(geoType === 'ISOCountry',\n              'The value passed to AMP_GEO() is not valid name:' + geoType);\n          return /** @type {string} */ (geos[geoType] || 'unknown');\n        }\n        return /** @type {string} */ (geos.ISOCountryGroups.join(GEO_DELIM));\n      }, 'AMP_GEO');\n    }));\n\n    // Returns incoming share tracking fragment.\n    this.setAsync('SHARE_TRACKING_INCOMING', /** @type {AsyncResolverDef} */(\n      () => {\n        return this.getShareTrackingValue_(fragments => {\n          return fragments.incomingFragment;\n        }, 'SHARE_TRACKING_INCOMING');\n      }));\n\n    // Returns outgoing share tracking fragment.\n    this.setAsync('SHARE_TRACKING_OUTGOING', /** @type {AsyncResolverDef} */(\n      () => {\n        return this.getShareTrackingValue_(fragments => {\n          return fragments.outgoingFragment;\n        }, 'SHARE_TRACKING_OUTGOING');\n      }));\n\n    // Returns the number of milliseconds since 1 Jan 1970 00:00:00 UTC.\n    this.set('TIMESTAMP', dateMethod('getTime'));\n\n    // Returns the human readable timestamp in format of\n    // 2011-01-01T11:11:11.612Z.\n    this.set('TIMESTAMP_ISO', dateMethod('toISOString'));\n\n    // Returns the user's time-zone offset from UTC, in minutes.\n    this.set('TIMEZONE', dateMethod('getTimezoneOffset'));\n\n    // Returns the IANA timezone code\n    this.set('TIMEZONE_CODE', () => {\n      let tzCode;\n      if ('Intl' in this.ampdoc.win &&\n        'DateTimeFormat' in this.ampdoc.win.Intl) {\n        // It could be undefined (i.e. IE11)\n        tzCode = new Intl.DateTimeFormat().resolvedOptions().timeZone;\n      }\n\n      return tzCode || '';\n    });\n\n    // Returns a promise resolving to viewport.getScrollTop.\n    this.set('SCROLL_TOP', () => viewport.getScrollTop());\n\n    // Returns a promise resolving to viewport.getScrollLeft.\n    this.set('SCROLL_LEFT', () => viewport.getScrollLeft());\n\n    // Returns a promise resolving to viewport.getScrollHeight.\n    this.set('SCROLL_HEIGHT', () => viewport.getScrollHeight());\n\n    // Returns a promise resolving to viewport.getScrollWidth.\n    this.set('SCROLL_WIDTH', () => viewport.getScrollWidth());\n\n    // Returns the viewport height.\n    this.set('VIEWPORT_HEIGHT', () => viewport.getHeight());\n\n    // Returns the viewport width.\n    this.set('VIEWPORT_WIDTH', () => viewport.getWidth());\n\n\n    const {screen} = this.ampdoc.win;\n    // Returns screen.width.\n    this.set('SCREEN_WIDTH', screenProperty(screen, 'width'));\n\n    // Returns screen.height.\n    this.set('SCREEN_HEIGHT', screenProperty(screen, 'height'));\n\n    // Returns screen.availHeight.\n    this.set('AVAILABLE_SCREEN_HEIGHT', screenProperty(screen, 'availHeight'));\n\n    // Returns screen.availWidth.\n    this.set('AVAILABLE_SCREEN_WIDTH', screenProperty(screen, 'availWidth'));\n\n    // Returns screen.ColorDepth.\n    this.set('SCREEN_COLOR_DEPTH', screenProperty(screen, 'colorDepth'));\n\n    // Returns document characterset.\n    this.set('DOCUMENT_CHARSET', () => {\n      const doc = this.ampdoc.win.document;\n      return doc.characterSet || doc.charset;\n    });\n\n    // Returns the browser language.\n    this.set('BROWSER_LANGUAGE', () => {\n      const nav = this.ampdoc.win.navigator;\n      return (nav.language || nav.userLanguage || nav.browserLanguage || '')\n          .toLowerCase();\n    });\n\n    // Returns the user agent.\n    this.set('USER_AGENT', () => {\n      const nav = this.ampdoc.win.navigator;\n      return nav.userAgent;\n    });\n\n    // Returns the time it took to load the whole page. (excludes amp-* elements\n    // that are not rendered by the system yet.)\n    this.setTimingResolver_(\n        'PAGE_LOAD_TIME', 'navigationStart', 'loadEventStart');\n\n    // Returns the time it took to perform DNS lookup for the domain.\n    this.setTimingResolver_(\n        'DOMAIN_LOOKUP_TIME', 'domainLookupStart', 'domainLookupEnd');\n\n    // Returns the time it took to connect to the server.\n    this.setTimingResolver_(\n        'TCP_CONNECT_TIME', 'connectStart', 'connectEnd');\n\n    // Returns the time it took for server to start sending a response to the\n    // request.\n    this.setTimingResolver_(\n        'SERVER_RESPONSE_TIME', 'requestStart', 'responseStart');\n\n    // Returns the time it took to download the page.\n    this.setTimingResolver_(\n        'PAGE_DOWNLOAD_TIME', 'responseStart', 'responseEnd');\n\n    // Returns the time it took for redirects to complete.\n    this.setTimingResolver_(\n        'REDIRECT_TIME', 'navigationStart', 'fetchStart');\n\n    // Returns the time it took for DOM to become interactive.\n    this.setTimingResolver_(\n        'DOM_INTERACTIVE_TIME', 'navigationStart', 'domInteractive');\n\n    // Returns the time it took for content to load.\n    this.setTimingResolver_(\n        'CONTENT_LOAD_TIME', 'navigationStart', 'domContentLoadedEventStart');\n\n    // Access: Reader ID.\n    this.setAsync('ACCESS_READER_ID', /** @type {AsyncResolverDef} */(() => {\n      return this.getAccessValue_(accessService => {\n        return accessService.getAccessReaderId();\n      }, 'ACCESS_READER_ID');\n    }));\n\n    // Access: data from the authorization response.\n    this.setAsync('AUTHDATA', /** @type {AsyncResolverDef} */(field => {\n      user().assert(field,\n          'The first argument to AUTHDATA, the field, is required');\n      return this.getAccessValue_(accessService => {\n        return accessService.getAuthdataField(field);\n      }, 'AUTHDATA');\n    }));\n\n    // Returns an identifier for the viewer.\n    this.setAsync('VIEWER', () => {\n      return Services.viewerForDoc(this.ampdoc)\n          .getViewerOrigin().then(viewer => {\n            return viewer == undefined ? '' : viewer;\n          });\n    });\n\n    // Returns the total engaged time since the content became viewable.\n    this.setAsync('TOTAL_ENGAGED_TIME', () => {\n      return Services.activityForDoc(this.ampdoc).then(activity => {\n        return activity.getTotalEngagedTime();\n      });\n    });\n\n    // Returns the incremental engaged time since the last push under the\n    // same name.\n    this.setAsync('INCREMENTAL_ENGAGED_TIME', (name, reset) => {\n      return Services.activityForDoc(this.ampdoc).then(activity => {\n        return activity.getIncrementalEngagedTime(name, reset !== 'false');\n      });\n    });\n\n    this.set('NAV_TIMING', (startAttribute, endAttribute) => {\n      user().assert(startAttribute, 'The first argument to NAV_TIMING, the ' +\n          'start attribute name, is required');\n      return getTimingDataSync(\n          this.ampdoc.win,\n          /**@type {string}*/(startAttribute),\n          /**@type {string}*/(endAttribute));\n    });\n    this.setAsync('NAV_TIMING', (startAttribute, endAttribute) => {\n      user().assert(startAttribute, 'The first argument to NAV_TIMING, the ' +\n          'start attribute name, is required');\n      return getTimingDataAsync(\n          this.ampdoc.win,\n          /**@type {string}*/(startAttribute),\n          /**@type {string}*/(endAttribute));\n    });\n\n    this.set('NAV_TYPE', () => {\n      return getNavigationData(this.ampdoc.win, 'type');\n    });\n\n    this.set('NAV_REDIRECT_COUNT', () => {\n      return getNavigationData(this.ampdoc.win, 'redirectCount');\n    });\n\n    // returns the AMP version number\n    this.set('AMP_VERSION', () => '$internalRuntimeVersion$');\n\n    this.set('BACKGROUND_STATE', () => {\n      return Services.viewerForDoc(this.ampdoc).isVisible() ? '0' : '1';\n    });\n\n    this.setAsync('VIDEO_STATE', (id, property) => {\n      const root = this.ampdoc.getRootNode();\n      const video = user().assertElement(\n          root.getElementById(/** @type {string} */ (id)),\n          `Could not find an element with id=\"${id}\" for VIDEO_STATE`);\n      return Services.videoManagerForDoc(this.ampdoc)\n          .getAnalyticsDetails(video)\n          .then(details => details ? details[property] : '');\n    });\n\n    this.setAsync('STORY_PAGE_INDEX', this.getStoryValue_('pageIndex',\n        'STORY_PAGE_INDEX'));\n\n    this.setAsync('STORY_PAGE_ID', this.getStoryValue_('pageId',\n        'STORY_PAGE_ID'));\n\n    this.setAsync('FIRST_CONTENTFUL_PAINT', () => {\n      return tryResolve(() =>\n        Services.performanceFor(this.ampdoc.win).getFirstContentfulPaint());\n    });\n\n    this.setAsync('FIRST_VIEWPORT_READY', () => {\n      return tryResolve(() =>\n        Services.performanceFor(this.ampdoc.win).getFirstViewportReady());\n    });\n\n    this.setAsync('MAKE_BODY_VISIBLE', () => {\n      return tryResolve(() =>\n        Services.performanceFor(this.ampdoc.win).getMakeBodyVisible());\n    });\n\n    this.setAsync('AMP_STATE', key => {\n      return Services.bindForDocOrNull(this.ampdoc).then(bind => {\n        if (!bind) {\n          return '';\n        }\n        return bind.getStateValue(/** @type {string} */ (key));\n      });\n    });\n  }\n\n  /**\n   * Merges any replacement parameters into a given URL's query string,\n   * preferring values set in the original query string.\n   * @param {string} orig The original URL\n   * @return {string} The resulting URL\n   * @private\n   */\n  addReplaceParamsIfMissing_(orig) {\n    const {replaceParams} =\n    /** @type {!Object} */ (Services.documentInfoForDoc(this.ampdoc));\n    const url = parseUrlDeprecated(removeAmpJsParamsFromUrl(orig));\n    const params = parseQueryString(url.search);\n    return addParamsToUrl(removeSearch(orig),\n        /** @type {!JsonObject} **/ (Object.assign({}, replaceParams, params)));\n  }\n\n  /**\n   * Resolves the value via one of document info's urls.\n   * @param {string} field A field on the docInfo\n   * @param {string=} opt_urlProp A subproperty of the field\n   * @return {T}\n   * @template T\n   */\n  getDocInfoUrl_(field, opt_urlProp) {\n    return () => {\n      const docInfo = Services.documentInfoForDoc(this.ampdoc);\n      const value = docInfo[field];\n      return opt_urlProp ? parseUrlDeprecated(value)[opt_urlProp] : value;\n    };\n  }\n\n  /**\n   * Resolves the value via access service. If access service is not configured,\n   * the resulting value is `null`.\n   * @param {function(!../../extensions/amp-access/0.1/access-vars.AccessVars):(T|!Promise<T>)} getter\n   * @param {string} expr\n   * @return {T|null}\n   * @template T\n   * @private\n   */\n  getAccessValue_(getter, expr) {\n    return Promise.all([\n      Services.accessServiceForDocOrNull(this.ampdoc),\n      Services.subscriptionsServiceForDocOrNull(this.ampdoc),\n    ]).then(services => {\n      const service = /** @type {?../../extensions/amp-access/0.1/access-vars.AccessVars} */ (\n        services[0] || services[1]);\n      if (!service) {\n        // Access/subscriptions service is not installed.\n        user().error(\n            TAG,\n            'Access or subsciptions service is not installed to access: ',\n            expr);\n        return null;\n      }\n      return getter(service);\n    });\n  }\n\n  /**\n   * Return the QUERY_PARAM from the current location href\n   * @param {*} param\n   * @param {string} defaultValue\n   * @return {string}\n   * @private\n   */\n  getQueryParamData_(param, defaultValue) {\n    user().assert(param,\n        'The first argument to QUERY_PARAM, the query string ' +\n        'param is required');\n    const url = parseUrlDeprecated(\n        removeAmpJsParamsFromUrl(this.ampdoc.win.location.href));\n    const params = parseQueryString(url.search);\n    const key = user().assertString(param);\n    const {replaceParams} = Services.documentInfoForDoc(this.ampdoc);\n    if (typeof params[key] !== 'undefined') {\n      return params[key];\n    }\n    if (typeof replaceParams[key] !== 'undefined') {\n      return /** @type {string} */(replaceParams[key]);\n    }\n    return defaultValue;\n  }\n\n  /**\n   * Resolves the value via amp-experiment's variants service.\n   * @param {function(!Object<string, string>):(?string)} getter\n   * @param {string} expr\n   * @return {!Promise<?string>}\n   * @template T\n   * @private\n   */\n  getVariantsValue_(getter, expr) {\n    if (!this.variants_) {\n      this.variants_ = Services.variantForOrNull(this.ampdoc.win);\n    }\n    return this.variants_.then(variants => {\n      user().assert(variants,\n          'To use variable %s, amp-experiment should be configured',\n          expr);\n      return getter(variants);\n    });\n  }\n\n  /**\n   * Resolves the value via geo service.\n   * @param {function(Object<string, string>)} getter\n   * @param {string} expr\n   * @return {!Promise<Object<string,(string|Array<string>)>>}\n   * @template T\n   * @private\n   */\n  getGeo_(getter, expr) {\n    return Services.geoForDocOrNull(this.ampdoc)\n        .then(geo => {\n          user().assert(geo,\n              'To use variable %s, amp-geo should be configured',\n              expr);\n          return getter(geo);\n        });\n  }\n\n  /**\n   * Resolves the value via amp-share-tracking's service.\n   * @param {function(!ShareTrackingFragmentsDef):T} getter\n   * @param {string} expr\n   * @return {!Promise<T>}\n   * @template T\n   * @private\n   */\n  getShareTrackingValue_(getter, expr) {\n    if (!this.shareTrackingFragments_) {\n      this.shareTrackingFragments_ =\n          Services.shareTrackingForOrNull(this.ampdoc.win);\n    }\n    return this.shareTrackingFragments_.then(fragments => {\n      user().assert(fragments, 'To use variable %s, ' +\n          'amp-share-tracking should be configured',\n      expr);\n      return getter(/** @type {!ShareTrackingFragmentsDef} */ (fragments));\n    });\n  }\n\n  /**\n   * Resolves the value via amp-story's service.\n   * @param {string} property\n   * @param {string} name\n   * @return {!AsyncResolverDef}\n   * @private\n   */\n  getStoryValue_(property, name) {\n    return () => {\n      const service = Services.storyVariableServiceForOrNull(this.ampdoc.win);\n      return service.then(storyVariables => {\n        user().assert(storyVariables,\n            'To use variable %s amp-story should be configured', name);\n        return storyVariables[property];\n      });\n    };\n  }\n\n  /**\n   * Resolves the value via amp-viewer-integration's service.\n   * @param {string} property\n   * @param {string} name\n   * @return {!AsyncResolverDef}\n   * @private\n   */\n  getViewerIntegrationValue_(property, name) {\n    return /** @type {!AsyncResolverDef} */ (\n      (param, defaultValue = '') => {\n        const service =\n            Services.viewerIntegrationVariableServiceForOrNull(this.ampdoc.win);\n        return service.then(viewerIntegrationVariables => {\n          user().assert(viewerIntegrationVariables, 'To use variable %s ' +\n              'amp-viewer-integration must be installed', name);\n          return viewerIntegrationVariables[property](param, defaultValue);\n        });\n      });\n  }\n}\n\n/**\n * This class replaces substitution variables with their values.\n * Document new values in ../spec/amp-var-substitutions.md\n * @package For export\n */\nexport class UrlReplacements {\n  /**\n   * @param {!./ampdoc-impl.AmpDoc} ampdoc\n   * @param {!VariableSource} variableSource\n   */\n  constructor(ampdoc, variableSource) {\n    /** @const {!./ampdoc-impl.AmpDoc} */\n    this.ampdoc = ampdoc;\n\n    /** @type {VariableSource} */\n    this.variableSource_ = variableSource;\n\n    /** @type {!Expander} */\n    this.expander_ = new Expander(this.variableSource_);\n  }\n\n\n  /**\n   * Synchronously expands the provided source by replacing all known variables\n   * with their resolved values. Optional `opt_bindings` can be used to add new\n   * variables or override existing ones.  Any async bindings are ignored.\n   * @param {string} source\n   * @param {!Object<string, (ResolverReturnDef|!SyncResolverDef)>=} opt_bindings\n   * @param {!Object<string, ResolverReturnDef>=} opt_collectVars\n   * @param {!Object<string, boolean>=} opt_whiteList Optional white list of\n   *     names that can be substituted.\n   * @return {string}\n   */\n  expandStringSync(source, opt_bindings, opt_collectVars, opt_whiteList) {\n    return /** @type {string} */ (\n      this.expand_(source, opt_bindings, opt_collectVars, /* opt_sync */ true,\n          opt_whiteList));\n  }\n\n  /**\n   * Expands the provided source by replacing all known variables with their\n   * resolved values. Optional `opt_bindings` can be used to add new variables\n   * or override existing ones.\n   * @param {string} source\n   * @param {!Object<string, *>=} opt_bindings\n   * @return {!Promise<string>}\n   */\n  expandStringAsync(source, opt_bindings) {\n    return /** @type {!Promise<string>} */ (this.expand_(source, opt_bindings));\n  }\n\n  /**\n   * Synchronously expands the provided URL by replacing all known variables\n   * with their resolved values. Optional `opt_bindings` can be used to add new\n   * variables or override existing ones.  Any async bindings are ignored.\n   * @param {string} url\n   * @param {!Object<string, (ResolverReturnDef|!SyncResolverDef)>=} opt_bindings\n   * @param {!Object<string, ResolverReturnDef>=} opt_collectVars\n   * @param {!Object<string, boolean>=} opt_whiteList Optional white list of\n   *     names that can be substituted.\n   * @return {string}\n   */\n  expandUrlSync(url, opt_bindings, opt_collectVars, opt_whiteList) {\n    return this.ensureProtocolMatches_(url, /** @type {string} */ (this.expand_(\n        url, opt_bindings, opt_collectVars, /* opt_sync */ true,\n        opt_whiteList)));\n  }\n\n  /**\n   * Expands the provided URL by replacing all known variables with their\n   * resolved values. Optional `opt_bindings` can be used to add new variables\n   * or override existing ones.\n   * @param {string} url\n   * @param {!Object<string, *>=} opt_bindings\n   * @param {!Object<string, boolean>=} opt_whiteList Optional white list of names\n   *     that can be substituted.\n   * @return {!Promise<string>}\n   */\n  expandUrlAsync(url, opt_bindings, opt_whiteList) {\n    return /** @type {!Promise<string>} */ (\n      this.expand_(url, opt_bindings, undefined, undefined,\n          opt_whiteList).then(\n          replacement => this.ensureProtocolMatches_(url, replacement)));\n  }\n\n  /**\n   * Expands an input element value attribute with variable substituted.\n   * @param {!HTMLInputElement} element\n   * @return {!Promise<string>}\n   */\n  expandInputValueAsync(element) {\n    return /** @type {!Promise<string>} */ (\n      this.expandInputValue_(element, /*opt_sync*/ false));\n  }\n\n  /**\n   * Expands an input element value attribute with variable substituted.\n   * @param {!HTMLInputElement} element\n   * @return {string} Replaced string for testing\n   */\n  expandInputValueSync(element) {\n    return /** @type {string} */ (\n      this.expandInputValue_(element, /*opt_sync*/ true));\n  }\n\n  /**\n   * Expands in input element value attribute with variable substituted.\n   * @param {!HTMLInputElement} element\n   * @param {boolean=} opt_sync\n   * @return {string|!Promise<string>}\n   */\n  expandInputValue_(element, opt_sync) {\n    dev().assert(element.tagName == 'INPUT' &&\n        (element.getAttribute('type') || '').toLowerCase() == 'hidden',\n    'Input value expansion only works on hidden input fields: %s', element);\n\n    const whitelist = this.getWhitelistForElement_(element);\n    if (!whitelist) {\n      return opt_sync ? element.value : Promise.resolve(element.value);\n    }\n    if (element[ORIGINAL_VALUE_PROPERTY] === undefined) {\n      element[ORIGINAL_VALUE_PROPERTY] = element.value;\n    }\n    const result = this.expand_(\n        element[ORIGINAL_VALUE_PROPERTY] || element.value,\n        /* opt_bindings */ undefined,\n        /* opt_collectVars */ undefined,\n        /* opt_sync */ opt_sync,\n        /* opt_whitelist */ whitelist);\n\n    if (opt_sync) {\n      return element.value = result;\n    }\n    return result.then(newValue => {\n      element.value = newValue;\n      return newValue;\n    });\n  }\n\n  /**\n   * Returns a replacement whitelist from elements' data-amp-replace attribute.\n   * @param {!Element} element\n   * @param {!Object<string, boolean>=} opt_supportedReplacement Optional supported\n   * replacement that filters whitelist to a subset.\n   * @return {!Object<string, boolean>|undefined}\n   */\n  getWhitelistForElement_(element, opt_supportedReplacement) {\n    const whitelist = element.getAttribute('data-amp-replace');\n    if (!whitelist) {\n      return;\n    }\n    const requestedReplacements = {};\n    whitelist.trim().split(/\\s+/).forEach(replacement => {\n      if (!opt_supportedReplacement ||\n          hasOwn(opt_supportedReplacement, replacement)) {\n        requestedReplacements[replacement] = true;\n      } else {\n        user().warn('URL', 'Ignoring unsupported replacement', replacement);\n      }\n    });\n    return requestedReplacements;\n  }\n\n  /**\n    * Returns whether variable substitution is allowed for given url.\n    * @param {!Location} url\n    * @return {boolean}\n    */\n  isAllowedOrigin_(url) {\n    const docInfo = Services.documentInfoForDoc(this.ampdoc);\n    if (url.origin == parseUrlDeprecated(docInfo.canonicalUrl).origin ||\n        url.origin == parseUrlDeprecated(docInfo.sourceUrl).origin) {\n      return true;\n    }\n\n    const meta = this.ampdoc.getRootNode().querySelector(\n        'meta[name=amp-link-variable-allowed-origin]');\n\n    if (meta && meta.hasAttribute('content')) {\n      const whitelist = meta.getAttribute('content').trim().split(/\\s+/);\n      for (let i = 0; i < whitelist.length; i++) {\n        if (url.origin == parseUrlDeprecated(whitelist[i]).origin) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Replaces values in the link of an anchor tag if\n   * - the link opts into it (via data-amp-replace argument)\n   * - the destination is the source or canonical origin of this doc.\n   * @param {!Element} element An anchor element.\n   * @param {?string} defaultUrlParams to expand link if caller request.\n   * @return {string|undefined} Replaced string for testing\n   */\n  maybeExpandLink(element, defaultUrlParams) {\n    dev().assert(element.tagName == 'A');\n    const supportedReplacements = {\n      'CLIENT_ID': true,\n      'QUERY_PARAM': true,\n    };\n    const additionalUrlParameters =\n        element.getAttribute('data-amp-addparams') || '';\n    const whitelist = this.getWhitelistForElement_(\n        element, supportedReplacements);\n\n    if (!whitelist && !additionalUrlParameters && !defaultUrlParams) {\n      return;\n    }\n    // ORIGINAL_HREF_PROPERTY has the value of the href \"pre-replacement\".\n    // We set this to the original value before doing any work and use it\n    // on subsequent replacements, so that each run gets a fresh value.\n    let href = dev().assertString(\n        element[ORIGINAL_HREF_PROPERTY] || element.getAttribute('href'));\n    const url = parseUrlDeprecated(href);\n    if (element[ORIGINAL_HREF_PROPERTY] == null) {\n      element[ORIGINAL_HREF_PROPERTY] = href;\n    }\n    if (additionalUrlParameters) {\n      href = addParamsToUrl(\n          href,\n          parseQueryString(additionalUrlParameters));\n    }\n\n    const isAllowedOrigin = this.isAllowedOrigin_(url);\n    if (!isAllowedOrigin) {\n      if (whitelist) {\n        user().warn('URL', 'Ignoring link replacement', href,\n            ' because the link does not go to the document\\'s' +\n            ' source, canonical, or whitelisted origin.');\n      }\n      return element.href = href;\n    }\n\n    // Note that defaultUrlParams is treated differently than\n    // additionalUrlParameters in two ways #1: If the outgoing url origin is not\n    // whitelisted: additionalUrlParameters are always appended by not expanded,\n    // defaultUrlParams will not be appended. #2: If the expansion function is\n    // not whitelisted: additionalUrlParamters will not be expanded,\n    // defaultUrlParams will by default support QUERY_PARAM, and will still be\n    // expanded.\n    if (defaultUrlParams) {\n      if (!whitelist || !whitelist['QUERY_PARAM']) {\n        // override whitelist and expand defaultUrlParams;\n        const overrideWhitelist = {'QUERY_PARAM': true};\n        defaultUrlParams = this.expandUrlSync(\n            defaultUrlParams,\n            /* opt_bindings */ undefined,\n            /* opt_collectVars */ undefined,\n            /* opt_whitelist */ overrideWhitelist);\n      }\n      href = addParamsToUrl(href, parseQueryString(defaultUrlParams));\n    }\n\n    if (whitelist) {\n      href = this.expandUrlSync(\n          href,\n          /* opt_bindings */ undefined,\n          /* opt_collectVars */ undefined,\n          /* opt_whitelist */ whitelist);\n    }\n\n    return element.href = href;\n  }\n\n  /**\n   * @param {string} url\n   * @param {!Object<string, *>=} opt_bindings\n   * @param {!Object<string, *>=} opt_collectVars\n   * @param {boolean=} opt_sync\n   * @param {!Object<string, boolean>=} opt_whiteList Optional white list of names\n   *     that can be substituted.\n   * @return {!Promise<string>|string}\n   * @private\n   */\n  expand_(url, opt_bindings, opt_collectVars, opt_sync, opt_whiteList) {\n    const isV2ExperimentOn = isExperimentOn(this.ampdoc.win,\n        'url-replacement-v2');\n    if (isV2ExperimentOn) {\n      // TODO(ccordy) support opt_collectVars && opt_whitelist\n      return this.expander_./*OK*/expand(url, opt_bindings, opt_collectVars,\n          opt_sync, opt_whiteList);\n    }\n\n    // existing parsing method\n    const expr = this.variableSource_.getExpr(opt_bindings);\n    let replacementPromise;\n    let replacement = url.replace(expr, (match, name, opt_strargs) => {\n      let args = [];\n      if (typeof opt_strargs == 'string') {\n        args = opt_strargs.split(/,\\s*/);\n      }\n      if (opt_whiteList && !opt_whiteList[name]) {\n        // Do not perform substitution and just return back the original\n        // match, so that the string doesn't change.\n        return match;\n      }\n      let binding;\n      if (opt_bindings && (name in opt_bindings)) {\n        binding = opt_bindings[name];\n      } else if ((binding = this.variableSource_.get(name))) {\n        if (opt_sync) {\n          binding = binding.sync;\n          if (!binding) {\n            user().error(TAG, 'ignoring async replacement key: ', name);\n            return '';\n          }\n        } else {\n          binding = binding.async || binding.sync;\n        }\n      }\n      let val;\n      try {\n        val = (typeof binding == 'function') ?\n          binding.apply(null, args) : binding;\n      } catch (e) {\n        // Report error, but do not disrupt URL replacement. This will\n        // interpolate as the empty string.\n        if (opt_sync) {\n          val = '';\n        }\n        rethrowAsync(e);\n      }\n      // In case the produced value is a promise, we don't actually\n      // replace anything here, but do it again when the promise resolves.\n      if (val && val.then) {\n        if (opt_sync) {\n          user().error(TAG, 'ignoring promise value for key: ', name);\n          return '';\n        }\n        /** @const {Promise<string>} */\n        const p = val.catch(err => {\n          // Report error, but do not disrupt URL replacement. This will\n          // interpolate as the empty string.\n          rethrowAsync(err);\n        }).then(v => {\n          replacement = replacement.replace(match,\n              NOENCODE_WHITELIST[match] ? v : encodeValue(v));\n          if (opt_collectVars) {\n            opt_collectVars[match] = v;\n          }\n        });\n        if (replacementPromise) {\n          replacementPromise = replacementPromise.then(() => p);\n        } else {\n          replacementPromise = p;\n        }\n        return match;\n      }\n      if (opt_collectVars) {\n        opt_collectVars[match] = val;\n      }\n      return NOENCODE_WHITELIST[match] ? val : encodeValue(val);\n    });\n\n    if (replacementPromise) {\n      replacementPromise = replacementPromise.then(() => replacement);\n    }\n\n    if (opt_sync) {\n      return replacement;\n    }\n    return replacementPromise || Promise.resolve(replacement);\n  }\n\n  /**\n   * Collects all substitutions in the provided URL and expands them to the\n   * values for known variables. Optional `opt_bindings` can be used to add\n   * new variables or override existing ones.\n   * @param {string} url\n   * @param {!Object<string, *>=} opt_bindings\n   * @return {!Promise<!Object<string, *>>}\n   */\n  collectVars(url, opt_bindings) {\n    const vars = Object.create(null);\n    return this.expand_(url, opt_bindings, vars).then(() => vars);\n  }\n\n  /**\n   * Collects substitutions in the `src` attribute of the given element\n   * that are _not_ whitelisted via `data-amp-replace` opt-in attribute.\n   * @param {!Element} element\n   * @return {!Array<string>}\n   */\n  collectUnwhitelistedVarsSync(element) {\n    const url = element.getAttribute('src');\n    const vars = Object.create(null);\n    this.expandStringSync(url, /* opt_bindings */ undefined, vars);\n    const varNames = Object.keys(vars);\n\n    const whitelist = this.getWhitelistForElement_(element);\n    if (whitelist) {\n      return varNames.filter(v => !whitelist[v]);\n    } else {\n      // All vars are unwhitelisted if the element has no whitelist.\n      return varNames;\n    }\n  }\n\n  /**\n   * Ensures that the protocol of the original url matches the protocol of the\n   * replacement url. Returns the replacement if they do, the original if they\n   * do not.\n   * @param {string} url\n   * @param {string} replacement\n   * @return {string}\n   */\n  ensureProtocolMatches_(url, replacement) {\n    const newProtocol = parseUrlDeprecated(replacement, /* opt_nocache */ true)\n        .protocol;\n    const oldProtocol = parseUrlDeprecated(url, /* opt_nocache */ true)\n        .protocol;\n    if (newProtocol != oldProtocol) {\n      user().error(TAG, 'Illegal replacement of the protocol: ', url);\n      return url;\n    }\n    user().assert(isProtocolValid(replacement),\n        'The replacement url has invalid protocol: %s', replacement);\n\n    return replacement;\n  }\n\n  /**\n   * @return {VariableSource}\n   */\n  getVariableSource() {\n    return this.variableSource_;\n  }\n}\n\n/**\n * Extracts client ID from a _ga cookie.\n * https://developers.google.com/analytics/devguides/collection/analyticsjs/cookies-user-id\n * @param {string} gaCookie\n * @return {string}\n */\nexport function extractClientIdFromGaCookie(gaCookie) {\n  return gaCookie.replace(/^(GA1|1)\\.[\\d-]+\\./, '');\n}\n\n/**\n * @param {!./ampdoc-impl.AmpDoc} ampdoc\n */\nexport function installUrlReplacementsServiceForDoc(ampdoc) {\n  registerServiceBuilderForDoc(\n      ampdoc,\n      'url-replace',\n      function(doc) {\n        return new UrlReplacements(doc, new GlobalVariableSource(doc));\n      });\n}\n\n\n/**\n * @param {!./ampdoc-impl.AmpDoc} ampdoc\n * @param {!Window} embedWin\n * @param {!VariableSource} varSource\n */\nexport function installUrlReplacementsForEmbed(ampdoc, embedWin, varSource) {\n  installServiceInEmbedScope(embedWin, 'url-replace',\n      new UrlReplacements(ampdoc, varSource));\n}\n\n/**\n * @typedef {{incomingFragment: string, outgoingFragment: string}}\n */\nlet ShareTrackingFragmentsDef;\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {dev} from '../log';\nimport {isFiniteNumber} from '../types';\nimport {loadPromise} from '../event-helper';\n\n/** @typedef {string|number|boolean|undefined|null} */\nlet ResolverReturnDef;\n\n/** @typedef {function(...*):ResolverReturnDef} */\nexport let SyncResolverDef;\n\n/** @typedef {function(...*):!Promise<ResolverReturnDef>} */\nexport let AsyncResolverDef;\n\n/** @typedef {{sync: SyncResolverDef, async: AsyncResolverDef}} */\nlet ReplacementDef;\n\n\n/**\n * Returns navigation timing information based on the start and end events.\n * The data for the timing events is retrieved from performance.timing API.\n * If start and end events are both given, the result is the difference between\n * the two. If only start event is given, the result is the timing value at\n * start event.\n * @param {!Window} win\n * @param {string} startEvent\n * @param {string=} endEvent\n * @return {!Promise<ResolverReturnDef>}\n */\nexport function getTimingDataAsync(win, startEvent, endEvent) {\n  return loadPromise(win).then(() => {\n    return getTimingDataSync(win, startEvent, endEvent);\n  });\n}\n\n/**\n * Returns navigation timing information based on the start and end events.\n * The data for the timing events is retrieved from performance.timing API.\n * If start and end events are both given, the result is the difference between\n * the two. If only start event is given, the result is the timing value at\n * start event. Enforces synchronous evaluation.\n * @param {!Window} win\n * @param {string} startEvent\n * @param {string=} endEvent\n * @return {ResolverReturnDef} undefined if API is not available, empty string\n *    if it is not yet available, or value as string\n */\nexport function getTimingDataSync(win, startEvent, endEvent) {\n  const timingInfo = win['performance'] && win['performance']['timing'];\n  if (!timingInfo || timingInfo['navigationStart'] == 0) {\n    // Navigation timing API is not supported.\n    return;\n  }\n\n  const metric = (endEvent === undefined)\n    ? timingInfo[startEvent]\n    : timingInfo[endEvent] - timingInfo[startEvent];\n\n  if (!isFiniteNumber(metric) || metric < 0) {\n    // The metric is not supported.\n    return;\n  } else {\n    return metric;\n  }\n}\n\n/**\n * Returns navigation information from the current browsing context.\n * @param {!Window} win\n * @param {string} attribute\n * @return {ResolverReturnDef}\n * @private\n */\nexport function getNavigationData(win, attribute) {\n  const navigationInfo = win['performance'] &&\n    win['performance']['navigation'];\n  if (!navigationInfo || navigationInfo[attribute] === undefined) {\n    // PerformanceNavigation interface is not supported or attribute is not\n    // implemented.\n    return;\n  }\n  return navigationInfo[attribute];\n}\n\n\n/**\n * A class to provide variable substitution related features. Extend this class\n * and override initialize() to add more supported variables.\n */\nexport class VariableSource {\n  /**\n   * @param {!./ampdoc-impl.AmpDoc} ampdoc\n   */\n  constructor(ampdoc) {\n    /** @protected @const {!./ampdoc-impl.AmpDoc} */\n    this.ampdoc = ampdoc;\n\n    /** @private {!RegExp|undefined} */\n    this.replacementExpr_ = undefined;\n\n    /** @private {!RegExp|undefined} */\n    this.replacementExprV2_ = undefined;\n\n    /** @private @const {!Object<string, !ReplacementDef>} */\n    this.replacements_ = Object.create(null);\n\n    /** @private {boolean} */\n    this.initialized_ = false;\n\n    this.getUrlMacroWhitelist_();\n  }\n\n  /**\n   * Lazily initialize the default replacements.\n   * @private\n   */\n  initialize_() {\n    this.initialize();\n    this.initialized_ = true;\n  }\n\n  /**\n   * Override this method to set all the variables supported by derived class.\n   */\n  initialize() {\n    // Needs to be implemented by derived classes.\n  }\n\n  /**\n   * Method exists to assist stubbing in tests.\n   * @param {string} name\n   * @return {!ReplacementDef}\n   */\n  get(name) {\n    if (!this.initialized_) {\n      this.initialize_();\n    }\n\n    return this.replacements_[name];\n  }\n\n  /**\n   * Sets a synchronous value resolver for the variable with the specified name.\n   * The value resolver may optionally take an extra parameter.\n   * Can be called in conjunction with setAsync to allow for additional\n   * asynchronous resolver where expand will use async and expandSync the sync\n   * version.\n   * @param {string} varName\n   * @param {!SyncResolverDef} syncResolver\n   * @return {!VariableSource}\n   */\n  set(varName, syncResolver) {\n    dev().assert(varName.indexOf('RETURN') == -1);\n    this.replacements_[varName] =\n        this.replacements_[varName] || {sync: undefined, async: undefined};\n    this.replacements_[varName].sync = syncResolver;\n    this.replacementExpr_ = undefined;\n    this.replacementExprV2_ = undefined;\n    return this;\n  }\n\n  /**\n   * Sets an async value resolver for the variable with the specified name.\n   * The value resolver may optionally take an extra parameter.\n   * Can be called in conjuction with setAsync to allow for additional\n   * asynchronous resolver where expand will use async and expandSync the sync\n   * version.\n   * @param {string} varName\n   * @param {!AsyncResolverDef} asyncResolver\n   * @return {!VariableSource}\n   */\n  setAsync(varName, asyncResolver) {\n    dev().assert(varName.indexOf('RETURN') == -1);\n    this.replacements_[varName] =\n        this.replacements_[varName] || {sync: undefined, async: undefined};\n    this.replacements_[varName].async = asyncResolver;\n    this.replacementExpr_ = undefined;\n    this.replacementExprV2_ = undefined;\n    return this;\n  }\n\n  /**\n   * Helper method to set both sync and async resolvers.\n   * @param {string} varName\n   * @param {!SyncResolverDef} syncResolver\n   * @param {!AsyncResolverDef} asyncResolver\n   * @return {!VariableSource}\n   */\n  setBoth(varName, syncResolver, asyncResolver) {\n    return this.set(varName, syncResolver).setAsync(varName, asyncResolver);\n  }\n\n  /**\n   * Returns a Regular expression that can be used to detect all the variables\n   * in a template.\n   * @param {!Object<string, *>=} opt_bindings\n   * @param {boolean=} isV2 Flag to ignore capture of args.\n   * @param {!Object<string, boolean>=} opt_whiteList Optional white list of names\n   *   that can be substituted.\n   */\n  getExpr(opt_bindings, isV2, opt_whiteList) {\n    if (!this.initialized_) {\n      this.initialize_();\n    }\n\n    const additionalKeys = opt_bindings ? Object.keys(opt_bindings) : null;\n    if (additionalKeys && additionalKeys.length > 0) {\n      const allKeys = Object.keys(this.replacements_);\n      additionalKeys.forEach(key => {\n        if (this.replacements_[key] === undefined) {\n          allKeys.push(key);\n        }\n      });\n      return this.buildExpr_(allKeys, isV2, opt_whiteList);\n    }\n    if (!this.replacementExpr_ && !isV2) {\n      this.replacementExpr_ = this.buildExpr_(\n          Object.keys(this.replacements_));\n    }\n    // sometimes the v1 expand will be called before the v2\n    // so we need to cache both versions\n    if (!this.replacementExprV2_ && isV2) {\n      this.replacementExprV2_ = this.buildExpr_(\n          Object.keys(this.replacements_), isV2, opt_whiteList);\n    }\n\n    return isV2 ? this.replacementExprV2_ :\n      this.replacementExpr_;\n  }\n\n  /**\n   * @param {!Array<string>} keys\n   * @param {boolean=} isV2 flag to ignore capture of args\n   * @param {!Object<string, boolean>=} opt_whiteList Optional white list of names\n   *   that can be substituted.\n   * @return {!RegExp}\n   * @private\n   */\n  buildExpr_(keys, isV2, opt_whiteList) {\n    // If a whitelist is present, the keys must belong to the whitelist.\n    // We filter the keys one last time to ensure no unwhitelisted key is\n    // allowed.\n    if (this.getUrlMacroWhitelist_()) {\n      keys = keys.filter(key => this.getUrlMacroWhitelist_().includes(key));\n    }\n    // If a whitelist is passed into the call to GlobalVariableSource.expand_\n    // then we only resolve values contained in the whitelist.\n    if (opt_whiteList) {\n      keys = keys.filter(key => opt_whiteList[key]);\n    }\n    // The keys must be sorted to ensure that the longest keys are considered\n    // first. This avoids a problem where a RANDOM conflicts with RANDOM_ONE.\n    keys.sort((s1, s2) => s2.length - s1.length);\n    // Keys that start with a `$` need to be escaped so that they do not\n    // interfere with the regex that is constructed.\n    const escaped = keys.map(key => {\n      if (key[0] === '$') {\n        return '\\\\' + key;\n      }\n      return key;\n    });\n\n    const all = escaped.join('|');\n    // Match the given replacement patterns, as well as optionally\n    // arguments to the replacement behind it in parentheses.\n    // Example string that match\n    // FOO_BAR\n    // FOO_BAR(arg1)\n    // FOO_BAR(arg1,arg2)\n    // FOO_BAR(arg1, arg2)\n    let regexStr = '\\\\$?(' + all + ')';\n    // ignore the capturing of arguments in new parser\n    if (!isV2) {\n      regexStr += '(?:\\\\(((?:\\\\s*[0-9a-zA-Z-_.]*\\\\s*(?=,|\\\\)),?)*)\\\\s*\\\\))?';\n    }\n    return new RegExp(regexStr, 'g');\n  }\n\n  /**\n   * @return {?Array<string>} The whitelist of allowed AMP variables. (if provided in\n   *     a meta tag).\n   * @private\n   */\n  getUrlMacroWhitelist_() {\n    if (this.variableWhitelist_) {\n      return this.variableWhitelist_;\n    }\n\n    const {head} = this.ampdoc.getRootNode();\n    if (!head) {\n      return null;\n    }\n\n    // A meta[name=\"amp-allowed-url-macros\"] tag, if present,\n    // contains, in its content attribute, a whitelist of variable substitution.\n    const meta =\n      head.querySelector('meta[name=\"amp-allowed-url-macros\"]');\n    if (!meta) {\n      return null;\n    }\n\n    /**\n     * The whitelist of variables allowed for variable substitution.\n     * @private {?Array<string>}\n     */\n    this.variableWhitelist_ = meta.getAttribute('content').split(',')\n        .map(variable => variable.trim());\n    return this.variableWhitelist_;\n  }\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getAmpdoc,\n  getExistingServiceForDocInEmbedScope,\n  getExistingServiceOrNull,\n  getService,\n  getServiceForDoc,\n  getServiceForDocDeprecated,\n  getServicePromiseForDoc,\n} from './service';\nimport {\n  getElementServiceForDoc,\n  getElementServiceIfAvailable,\n  getElementServiceIfAvailableForDoc,\n  getElementServiceIfAvailableForDocInEmbedScope,\n} from './element-service';\n\n/** @typedef {!../extensions/amp-subscriptions/0.1/amp-subscriptions.SubscriptionService} */\nexport let SubscriptionService;\n\nexport class Services {\n  /**\n   * Hint: Add extensions folder path to compile.js with\n   * warnings cannot find modules.\n   */\n\n  /**\n   * Returns a promise for the Access service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'access', 'amp-access')));\n  }\n\n  /**\n   * Returns a promise for the Access service or a promise for null if the\n   * service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc, 'access',\n          'amp-access')));\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!SubscriptionService>}\n   */\n  static subscriptionsServiceForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!SubscriptionService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'subscriptions',\n          'amp-subscriptions')));\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?SubscriptionService>}\n   */\n  static subscriptionsServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?SubscriptionService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc, 'subscriptions',\n          'amp-subscriptions')));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/action-impl.ActionService}\n   */\n  static actionServiceForDoc(nodeOrDoc) {\n    return /** @type {!./service/action-impl.ActionService} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'action', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!Activity>}\n   */\n  static activityForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!Activity>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'activity', 'amp-analytics'));\n  }\n\n  /**\n   * Returns the global instance of the `AmpDocService` service that can be\n   * used to resolve an ampdoc for any node: either in the single-doc or\n   * shadow-doc environment.\n   * @param {!Window} window\n   * @return {!./service/ampdoc-impl.AmpDocService}\n   */\n  static ampdocServiceFor(window) {\n    return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n      getService(window, 'ampdoc'));\n  }\n\n  /**\n   * Returns the AmpDoc for the specified context node.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/ampdoc-impl.AmpDoc}\n   */\n  static ampdoc(elementOrAmpDoc) {\n    return getAmpdoc(elementOrAmpDoc);\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @param {boolean=} loadAnalytics\n   * @return {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDoc(elementOrAmpDoc, loadAnalytics = false) {\n    if (loadAnalytics) {\n      // Get Extensions service and force load analytics extension.\n      const ampdoc = getAmpdoc(elementOrAmpDoc);\n      Services.extensionsFor(ampdoc.win)./*OK*/installExtensionForDoc(\n          ampdoc, 'amp-analytics');\n    }\n    return /** @type {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'amp-analytics-instrumentation',\n          'amp-analytics'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc,\n          'amp-analytics-instrumentation', 'amp-analytics'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/batched-xhr-impl.BatchedXhr}\n   */\n  static batchedXhrFor(window) {\n    return /** @type {!./service/batched-xhr-impl.BatchedXhr} */ (\n      getService(window, 'batched-xhr'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>}\n   */\n  static bindForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>} */ (\n      getElementServiceIfAvailableForDocInEmbedScope(\n          elementOrAmpDoc, 'bind', 'amp-bind'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/cid-impl.Cid>}\n   */\n  static cidForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/cid-impl.Cid>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'cid'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/navigation.Navigation}\n   */\n  static navigationForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/navigation.Navigation} */ (\n      getServiceForDoc(elementOrAmpDoc, 'navigation'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/crypto-impl.Crypto}\n   */\n  static cryptoFor(window) {\n    return (/** @type {!./service/crypto-impl.Crypto} */ (\n      getService(window, 'crypto')));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/document-info-impl.DocumentInfoDef} Info about the doc\n   */\n  static documentInfoForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/document-info-impl.DocInfo} */ (\n      getServiceForDoc(elementOrAmpDoc, 'documentInfo')).get();\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/document-state.DocumentState}\n   */\n  static documentStateFor(window) {\n    return getService(window, 'documentState');\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/extensions-impl.Extensions}\n   */\n  static extensionsFor(window) {\n    return /** @type {!./service/extensions-impl.Extensions} */ (\n      getService(window, 'extensions'));\n  }\n\n  /**\n   * Returns service implemented in service/history-impl.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/history-impl.History}\n   */\n  static historyForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/history-impl.History} */ (\n      getServiceForDoc(elementOrAmpDoc, 'history'));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!./input.Input}\n   */\n  static inputFor(win) {\n    return getService(win, 'input');\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/layers-impl.LayoutLayers}\n   */\n  static layersForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/layers-impl.LayoutLayers} */ (\n      getServiceForDoc(elementOrAmpDoc, 'layers'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceFor(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getService(window, 'performance'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceForOrNull(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getExistingServiceOrNull(window, 'performance'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/platform-impl.Platform}\n   */\n  static platformFor(window) {\n    return /** @type {!./service/platform-impl.Platform} */ (\n      getService(window, 'platform'));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Resources is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/resources-impl.Resources}\n   */\n  static resourcesForDoc(nodeOrDoc) {\n    return /** @type {!./service/resources-impl.Resources} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'resources'));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?{incomingFragment: string, outgoingFragment: string}>}\n   */\n  static shareTrackingForOrNull(win) {\n    return (/** @type {!Promise<?{incomingFragment: string, outgoingFragment: string}>} */ (\n      getElementServiceIfAvailable(win, 'share-tracking',\n          'amp-share-tracking', true)));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/variable-service.StoryVariableDef>}\n   */\n  static storyVariableServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/variable-service.StoryVariableDef>} */\n      (getElementServiceIfAvailable(win, 'story-variable', 'amp-story',\n          true)));\n  }\n\n  /**\n   * Version of the story store service depends on which version of amp-story\n   * the publisher is loading. They all have the same implementation.\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService|?../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService>}\n   */\n  static storyStoreServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService|?../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService>} */\n      (getElementServiceIfAvailable(win, 'story-store', 'amp-story')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService}\n   */\n  static storyStoreService(win) {\n    return (/** @type {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService} */\n      (getExistingServiceOrNull(win, 'story-store')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService}\n   */\n  static storyRequestService(win) {\n    return (/** @type {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService} */\n      (getExistingServiceOrNull(win, 'story-request')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!Promise<?../extensions/amp-story/1.0/localization.LocalizationService>}\n   */\n  static localizationServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/localization.LocalizationService>} */\n      (getElementServiceIfAvailable(win, 'localization', 'amp-story', true)));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/1.0/localization.LocalizationService}\n   */\n  static localizationService(win) {\n    return getService(win, 'localization');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService}\n   */\n  static storyStoreServiceV01(win) {\n    return getService(win, 'story-store');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/amp-story-request-service.AmpStoryRequestService}\n   */\n  static storyRequestServiceV01(win) {\n    return getService(win, 'story-request-v01');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!Promise<?../extensions/amp-story/0.1/localization.LocalizationService>}\n   */\n  static localizationServiceForOrNullV01(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/0.1/localization.LocalizationService>} */\n      (getElementServiceIfAvailable(win, 'localization-v01', 'amp-story',\n          true)));\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/localization.LocalizationService}\n   */\n  static localizationServiceV01(win) {\n    return getService(win, 'localization-v01');\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-viewer-integration/0.1/variable-service.ViewerIntegrationVariableDef>}\n   */\n  static viewerIntegrationVariableServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-viewer-integration/0.1/variable-service.ViewerIntegrationVariableDef>} */\n      (getElementServiceIfAvailable(win, 'viewer-integration-variable',\n          'amp-viewer-integration', true)));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>}\n   */\n  static webAnimationServiceFor(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>} */\n      (getElementServiceForDoc(\n          elementOrAmpDoc, 'web-animation', 'amp-animation')));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/storage-impl.Storage>}\n   */\n  static storageForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/storage-impl.Storage>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'storage'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/template-impl.Templates}\n   */\n  static templatesFor(window) {\n    return /** @type {!./service/template-impl.Templates} */ (\n      getService(window, 'templates'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/timer-impl.Timer}\n   */\n  static timerFor(window) {\n    return /** @type {!./service/timer-impl.Timer} */ (\n      getService(window, 'timer'));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/url-replacements-impl.UrlReplacements}\n   */\n  static urlReplacementsForDoc(nodeOrDoc) {\n    return /** @type {!./service/url-replacements-impl.UrlReplacements} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'url-replace', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>}\n   */\n  static userNotificationManagerForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>} */\n      (getElementServiceForDoc(elementOrAmpDoc, 'userNotificationManager',\n          'amp-user-notification')));\n  }\n\n  /**\n   * Returns a promise for the consentPolicy Service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>}\n   */\n  static consentPolicyServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>} */\n      (getElementServiceIfAvailableForDoc(elementOrAmpDoc,\n          'consentPolicyManager', 'amp-consent')));\n  }\n\n  /**\n   * Returns a promise for the geo service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>}\n   */\n  static geoForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>} */ (\n      getElementServiceIfAvailableForDoc(\n          elementOrAmpDoc, 'geo', 'amp-geo', true));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/url-impl.Url}\n   */\n  static urlForDoc(nodeOrDoc) {\n    return /** @type {!./service/url-impl.Url} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'url', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * Returns a promise for the experiment variants or a promise for null if it\n   * is not available on the current page.\n   * @param {!Window} win\n   * @return {!Promise<?Object<string>>}\n   */\n  static variantForOrNull(win) {\n    return /** @type {!Promise<?Object<string>>} */ (\n      getElementServiceIfAvailable(win, 'variant', 'amp-experiment', true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/video-service-interface.VideoServiceInterface}\n   */\n  static videoManagerForDoc(elementOrAmpDoc) {\n    return (\n      /** @type {!./service/video-service-interface.VideoServiceInterface} */ (\n        getServiceForDoc(elementOrAmpDoc, 'video-manager')));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Viewer is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/viewer-impl.Viewer}\n   */\n  static viewerForDoc(nodeOrDoc) {\n    return /** @type {!./service/viewer-impl.Viewer} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'viewer'));\n  }\n\n  /**\n   * Returns promise for the viewer. This is an unusual case and necessary only\n   * for services that need reference to the viewer before it has been\n   * initialized. Most of the code, however, just should use `viewerForDoc`.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/viewer-impl.Viewer>}\n   */\n  static viewerPromiseForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/viewer-impl.Viewer>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'viewer'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/vsync-impl.Vsync}\n   */\n  static vsyncFor(window) {\n    return /** @type {!./service/vsync-impl.Vsync} */ (\n      getService(window, 'vsync'));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Viewport is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/viewport/viewport-impl.Viewport}\n   */\n  static viewportForDoc(nodeOrDoc) {\n    return /** @type {!./service/viewport/viewport-impl.Viewport} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'viewport'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/xhr-impl.Xhr}\n   */\n  static xhrFor(window) {\n    return /** @type {!./service/xhr-impl.Xhr} */ (getService(window, 'xhr'));\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from './log';\nimport {map} from './utils/object.js';\n\nlet container;\n\n/**\n * Creates the html helper for the doc.\n *\n * @param {!Element|!Document} nodeOrDoc\n * @return {function(!Array<string>):!Element}\n */\nexport function htmlFor(nodeOrDoc) {\n  const doc = nodeOrDoc.ownerDocument || nodeOrDoc;\n  if (!container || container.ownerDocument !== doc) {\n    container = doc.createElement('div');\n  }\n\n  return html;\n}\n\n/**\n * A tagged template literal helper to generate static DOM trees.\n * This must be used as a tagged template, ie\n *\n * ```\n * const div = html`<div><span></span></div>`;\n * ```\n *\n * Only the root element and its subtree will be returned. DO NOT use this to\n * render subtree's with dynamic content, it WILL result in an error!\n *\n * @param {!Array<string>} strings\n * @return {!Element}\n */\nfunction html(strings) {\n  dev().assert(strings.length === 1, 'Improper html template tag usage.');\n  container./*OK*/innerHTML = strings[0];\n\n  const el = container.firstElementChild;\n  dev().assert(el, 'No elements in template');\n  dev().assert(!el.nextElementSibling, 'Too many root elements in template');\n\n  // Clear to free memory.\n  container./*OK*/innerHTML = '';\n\n  return el;\n}\n\n/**\n * Queries an element for all elements with a \"ref\" attribute, removing\n * the attribute afterwards.\n * Returns a named map of all ref elements.\n *\n * @param {!Element} root\n * @return {!Object<string, !Element>}\n */\nexport function htmlRefs(root) {\n  const elements = root.querySelectorAll('[ref]');\n  const refs = map();\n\n  for (let i = 0; i < elements.length; i++) {\n    const element = elements[i];\n    const ref = dev().assert(element.getAttribute('ref'), 'Empty ref attr');\n    element.removeAttribute('ref');\n    dev().assert(refs[ref] === undefined, 'Duplicate ref');\n    refs[ref] = element;\n  }\n\n  return refs;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {string} _match\n * @param {string} character\n * @return {string}\n */\nfunction toUpperCase(_match, character) {\n  return character.toUpperCase();\n}\n\n/**\n * @param {string} match\n * @return {string}\n */\nfunction prependDashAndToLowerCase(match) {\n  return '-' + match.toLowerCase();\n}\n\n/**\n * @param {string} name Attribute name containing dashes.\n * @return {string} Dashes removed and successive character sent to upper case.\n * visibleForTesting\n */\nexport function dashToCamelCase(name) {\n  return name.replace(/-([a-z])/g, toUpperCase);\n}\n\n/**\n * Converts a string that is in camelCase to one that is in dash-case.\n *\n * @param {string} string The string to convert.\n * @return {string} The string in dash-case.\n */\nexport function camelCaseToDash(string) {\n  return string.replace(/(?!^)[A-Z]/g, prependDashAndToLowerCase);\n}\n\n/**\n * @param {string} name Attribute name with dashes\n * @return {string} Dashes replaced by underlines.\n */\nexport function dashToUnderline(name) {\n  return name.replace('-', '_');\n}\n\n/**\n * Polyfill for String.prototype.endsWith.\n * @param {string} string\n * @param {string} suffix\n * @return {boolean}\n */\nexport function endsWith(string, suffix) {\n  const index = string.length - suffix.length;\n  return index >= 0 && string.indexOf(suffix, index) == index;\n}\n\n/**\n * Polyfill for String.prototype.startsWith.\n * @param {string} string\n * @param {string} prefix\n * @return {boolean}\n */\nexport function startsWith(string, prefix) {\n  if (prefix.length > string.length) {\n    return false;\n  }\n  return string.lastIndexOf(prefix, 0) == 0;\n}\n\n/**\n * Expands placeholders in a given template string with values.\n *\n * Placeholders use ${key-name} syntax and are replaced with the value\n * returned from the given getter function.\n *\n * @param {string} template The template string to expand.\n * @param {function(string):*} getter Function used to retrieve a value for a\n *   placeholder. Returns values will be coerced into strings.\n * @param {number=} opt_maxIterations Number of times to expand the template.\n *   Defaults to 1, but should be set to a larger value your placeholder tokens\n *   can be expanded to other placeholder tokens. Take caution with large values\n *   as recursively expanding a string can be exponentially expensive.\n */\nexport function expandTemplate(template, getter, opt_maxIterations) {\n  const maxIterations = opt_maxIterations || 1;\n  for (let i = 0; i < maxIterations; i++) {\n    let matches = 0;\n    template = template.replace(/\\${([^}]*)}/g, (_a, b) => {\n      matches++;\n      return getter(b);\n    });\n    if (!matches) {\n      break;\n    }\n  }\n  return template;\n}\n\n/**\n * Hash function djb2a\n * This is intended to be a simple, fast hashing function using minimal code.\n * It does *not* have good cryptographic properties.\n * @param {string} str\n * @return {string} 32-bit unsigned hash of the string\n */\nexport function stringHash32(str) {\n  const {length} = str;\n  let hash = 5381;\n  for (let i = 0; i < length; i++) {\n    hash = hash * 33 ^ str.charCodeAt(i);\n  }\n  // Convert from 32-bit signed to unsigned.\n  return String(hash >>> 0);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Services} from './services';\nimport {dev, rethrowAsync} from './log';\nimport {insertAfterOrAtStart, waitForBody} from './dom';\nimport {map} from './utils/object';\nimport {setStyles} from './style';\nimport {waitForServices} from './render-delaying-services';\n\nconst TRANSFORMER_PROP = '__AMP_CSS_TR';\nconst STYLE_MAP_PROP = '__AMP_CSS_SM';\nconst bodyVisibleSentinel = '__AMP_BODY_VISIBLE';\n\n\n/**\n * Adds the given css text to the given ampdoc.\n *\n * The style tags will be at the beginning of the head before all author\n * styles. One element can be the main runtime CSS. This is guaranteed\n * to always be the first stylesheet in the doc.\n *\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc The ampdoc that should get the new styles.\n * @param {string} cssText\n * @param {?function(!Element)|undefined} cb Called when the new styles are available.\n *     Not using a promise, because this is synchronous when possible.\n *     for better performance.\n * @param {boolean=} opt_isRuntimeCss If true, this style tag will be inserted\n *     as the first element in head and all style elements will be positioned\n *     after.\n * @param {string=} opt_ext\n * @return {!Element}\n */\nexport function installStylesForDoc(\n  ampdoc, cssText, cb, opt_isRuntimeCss, opt_ext) {\n  const cssRoot = ampdoc.getHeadNode();\n  const style = insertStyleElement(\n      cssRoot,\n      maybeTransform(cssRoot, cssText),\n      opt_isRuntimeCss || false,\n      opt_ext || null);\n\n  if (cb) {\n    const rootNode = ampdoc.getRootNode();\n    // Styles aren't always available synchronously. E.g. if there is a\n    // pending style download, it will have to finish before the new\n    // style is visible.\n    // For this reason we poll until the style becomes available.\n    // Sync case.\n    if (styleLoaded(rootNode, style)) {\n      cb(style);\n      return style;\n    }\n    // Poll until styles are available.\n    const interval = setInterval(() => {\n      if (styleLoaded(rootNode, style)) {\n        clearInterval(interval);\n        cb(style);\n      }\n    }, 4);\n  }\n  return style;\n}\n\n\n/**\n * Adds the given css text to the given document.\n * TODO(dvoytenko, #10705): Remove this method once FIE/ampdoc migration is\n * done.\n *\n * @param {!Document} doc The document that should get the new styles.\n * @param {string} cssText\n * @param {?function(!Element)|undefined} cb Called when the new styles are\n *     available. Not using a promise, because this is synchronous when\n *     possible. for better performance.\n * @param {boolean=} opt_isRuntimeCss If true, this style tag will be inserted\n *     as the first element in head and all style elements will be positioned\n *     after.\n * @param {string=} opt_ext\n * @return {!Element}\n */\nexport function installStylesLegacy(\n  doc, cssText, cb, opt_isRuntimeCss, opt_ext) {\n  const style = insertStyleElement(\n      dev().assertElement(doc.head),\n      cssText,\n      opt_isRuntimeCss || false,\n      opt_ext || null);\n\n  if (cb) {\n    // Styles aren't always available synchronously. E.g. if there is a\n    // pending style download, it will have to finish before the new\n    // style is visible.\n    // For this reason we poll until the style becomes available.\n    // Sync case.\n    if (styleLoaded(doc, style)) {\n      cb(style);\n      return style;\n    }\n    // Poll until styles are available.\n    const interval = setInterval(() => {\n      if (styleLoaded(doc, style)) {\n        clearInterval(interval);\n        cb(style);\n      }\n    }, 4);\n  }\n  return style;\n}\n\n\n/**\n * Creates the properly configured style element.\n * @param {!Element|!ShadowRoot} cssRoot\n * @param {string} cssText\n * @param {boolean} isRuntimeCss\n * @param {?string} ext\n * @return {!Element}\n */\nfunction insertStyleElement(cssRoot, cssText, isRuntimeCss, ext) {\n  let styleMap = cssRoot[STYLE_MAP_PROP];\n  if (!styleMap) {\n    styleMap = cssRoot[STYLE_MAP_PROP] = map();\n  }\n\n  const isExtCss = !isRuntimeCss &&\n      (ext && ext != 'amp-custom' && ext != 'amp-keyframes');\n  const key =\n      isRuntimeCss ? 'amp-runtime' :\n        isExtCss ? `amp-extension=${ext}` : null;\n\n  // Check if it has already been created or discovered.\n  if (key) {\n    const existing = getExistingStyleElement(cssRoot, styleMap, key);\n    if (existing) {\n      return existing;\n    }\n  }\n\n  // Create the new style element and append to cssRoot.\n  const doc = (cssRoot.ownerDocument || cssRoot);\n  const style = doc.createElement('style');\n  style./*OK*/textContent = cssText;\n  let afterElement = null;\n  // Make sure that we place style tags after the main runtime CSS. Otherwise\n  // the order is random.\n  if (isRuntimeCss) {\n    style.setAttribute('amp-runtime', '');\n  } else if (isExtCss) {\n    style.setAttribute('amp-extension', ext || '');\n    afterElement = dev().assertElement(getExistingStyleElement(\n        cssRoot, styleMap, 'amp-runtime'));\n  } else {\n    if (ext) {\n      style.setAttribute(ext, '');\n    }\n    afterElement = cssRoot.lastChild;\n  }\n  insertAfterOrAtStart(cssRoot, style, afterElement);\n  if (key) {\n    styleMap[key] = style;\n  }\n  return style;\n}\n\n\n/**\n * @param {!Element|!ShadowRoot} cssRoot\n * @param {!Object<string, !Element>} styleMap\n * @param {string} key\n * @return {?Element}\n */\nfunction getExistingStyleElement(cssRoot, styleMap, key) {\n  // Already cached.\n  if (styleMap[key]) {\n    return styleMap[key];\n  }\n  // Check if the style has already been added by the server layout.\n  const existing = cssRoot./*OK*/querySelector(`style[${key}]`);\n  if (existing) {\n    styleMap[key] = existing;\n    return existing;\n  }\n  // Nothing found.\n  return null;\n}\n\n\n/**\n * Applies a transformer to the CSS text if it has been registered.\n * @param {!Element|!ShadowRoot} cssRoot\n * @param {function(string):string} transformer\n */\nexport function installCssTransformer(cssRoot, transformer) {\n  cssRoot[TRANSFORMER_PROP] = transformer;\n}\n\n\n/**\n * Applies a transformer to the CSS text if it has been registered.\n * @param {!Element|!ShadowRoot} cssRoot\n * @param {string} cssText\n * @return {string}\n */\nfunction maybeTransform(cssRoot, cssText) {\n  const transformer = cssRoot[TRANSFORMER_PROP];\n  return transformer ? transformer(cssText) : cssText;\n}\n\n\n/**\n * Sets the document's body opacity to 1.\n * If the body is not yet available (because our script was loaded\n * synchronously), polls until it is.\n * @param {!Document} doc The document who's body we should make visible.\n * @param {boolean=} opt_waitForServices Whether the body visibility should\n *     be blocked on key services being loaded.\n */\nexport function makeBodyVisible(doc, opt_waitForServices) {\n  dev().assert(doc.defaultView, 'Passed in document must have a defaultView');\n  const win = /** @type {!Window} */ (doc.defaultView);\n  if (win[bodyVisibleSentinel]) {\n    return;\n  }\n  const set = () => {\n    win[bodyVisibleSentinel] = true;\n    setStyles(dev().assertElement(doc.body), {\n      opacity: 1,\n      visibility: 'visible',\n      'animation': 'none',\n    });\n    renderStartedNoInline(doc);\n  };\n  try {\n    waitForBody(doc, () => {\n      if (win[bodyVisibleSentinel]) {\n        return;\n      }\n      win[bodyVisibleSentinel] = true;\n      if (opt_waitForServices) {\n        waitForServices(win).catch(reason => {\n          rethrowAsync(reason);\n          return [];\n        }).then(services => {\n          set();\n          if (services.length > 0) {\n            Services.resourcesForDoc(doc)./*OK*/schedulePass(\n                1, /* relayoutAll */ true);\n          }\n          try {\n            const perf = Services.performanceFor(win);\n            perf.tick('mbv');\n            perf.flush();\n          } catch (e) {}\n        });\n      } else {\n        set();\n      }\n    });\n  } catch (e) {\n    // If there was an error during the logic above (such as service not\n    // yet installed, definitely try to make the body visible.\n    set();\n    // Avoid errors in the function to break execution flow as this is\n    // often called as a last resort.\n    rethrowAsync(e);\n  }\n}\n\n\n/**\n * @param {!Document} doc\n */\nfunction renderStartedNoInline(doc) {\n  try {\n    Services.resourcesForDoc(doc).renderStarted();\n  } catch (e) {\n    // `makeBodyVisible` is called in the error-processing cycle and thus\n    // could be triggered when runtime's initialization is incomplete which\n    // would cause unrelated errors to be thrown here.\n  }\n}\n\n\n/**\n * Indicates that the body is always visible. For instance, in case of PWA.\n * @param {!Window} win\n */\nexport function bodyAlwaysVisible(win) {\n  win[bodyVisibleSentinel] = true;\n}\n\n\n/**\n * Checks whether a style element was registered in the DOM.\n * @param {!Document|!ShadowRoot} doc\n * @param {!Element} style\n * @return {boolean}\n */\nfunction styleLoaded(doc, style) {\n  const sheets = doc.styleSheets;\n  for (let i = 0; i < sheets.length; i++) {\n    const sheet = sheets[i];\n    if (sheet.ownerNode == style) {\n      return true;\n    }\n  }\n  return false;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Note: loaded by 3p system. Cannot rely on babel polyfills.\nimport {map} from './utils/object.js';\nimport {startsWith} from './string';\n\n\n/** @type {Object<string, string>} */\nlet propertyNameCache;\n\n/** @const {!Array<string>} */\nconst vendorPrefixes = ['Webkit', 'webkit', 'Moz', 'moz', 'ms', 'O', 'o'];\n\n\n/**\n * @export\n * @param {string} camelCase camel cased string\n * @return {string} title cased string\n */\nexport function camelCaseToTitleCase(camelCase) {\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n}\n\n/**\n * Checks the style if a prefixed version of a property exists and returns\n * it or returns an empty string.\n * @private\n * @param {!Object} style\n * @param {string} titleCase the title case version of a css property name\n * @return {string} the prefixed property name or null.\n */\nfunction getVendorJsPropertyName_(style, titleCase) {\n  for (let i = 0; i < vendorPrefixes.length; i++) {\n    const propertyName = vendorPrefixes[i] + titleCase;\n    if (style[propertyName] !== undefined) {\n      return propertyName;\n    }\n  }\n  return '';\n}\n\n/**\n * Returns the possibly prefixed JavaScript property name of a style property\n * (ex. WebkitTransitionDuration) given a camelCase'd version of the property\n * (ex. transitionDuration).\n * @export\n * @param {!Object} style\n * @param {string} camelCase the camel cased version of a css property name\n * @param {boolean=} opt_bypassCache bypass the memoized cache of property\n *   mapping\n * @return {string}\n */\nexport function getVendorJsPropertyName(style, camelCase, opt_bypassCache) {\n  if (startsWith(camelCase, '--')) {\n    // CSS vars are returned as is.\n    return camelCase;\n  }\n  if (!propertyNameCache) {\n    propertyNameCache = map();\n  }\n  let propertyName = propertyNameCache[camelCase];\n  if (!propertyName || opt_bypassCache) {\n    propertyName = camelCase;\n    if (style[camelCase] === undefined) {\n      const titleCase = camelCaseToTitleCase(camelCase);\n      const prefixedPropertyName = getVendorJsPropertyName_(style, titleCase);\n\n      if (style[prefixedPropertyName] !== undefined) {\n        propertyName = prefixedPropertyName;\n      }\n    }\n    if (!opt_bypassCache) {\n      propertyNameCache[camelCase] = propertyName;\n    }\n  }\n  return propertyName;\n}\n\n\n/**\n * Sets the CSS styles of the specified element with !important. The styles\n * are specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setImportantStyles(element, styles) {\n  for (const k in styles) {\n    element.style.setProperty(\n        getVendorJsPropertyName(styles, k), styles[k].toString(), 'important');\n  }\n}\n\n\n/**\n * Sets the CSS style of the specified element with optional units, e.g. \"px\".\n * @param {?Element} element\n * @param {string} property\n * @param {*} value\n * @param {string=} opt_units\n * @param {boolean=} opt_bypassCache\n */\nexport function setStyle(element, property, value, opt_units, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (propertyName) {\n    element.style[propertyName] =\n      /** @type {string} */ (opt_units ? value + opt_units : value);\n  }\n}\n\n\n/**\n * Returns the value of the CSS style of the specified element.\n * @param {!Element} element\n * @param {string} property\n * @param {boolean=} opt_bypassCache\n * @return {*}\n */\nexport function getStyle(element, property, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (!propertyName) {\n    return undefined;\n  }\n  return element.style[propertyName];\n}\n\n\n/**\n * Sets the CSS styles of the specified element. The styles\n * a specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setStyles(element, styles) {\n  for (const k in styles) {\n    setStyle(element, k, styles[k]);\n  }\n}\n\n\n/**\n * Shows or hides the specified element.\n * @param {!Element} element\n * @param {boolean=} opt_display\n */\nexport function toggle(element, opt_display) {\n  if (opt_display === undefined) {\n    opt_display = getStyle(element, 'display') == 'none';\n  }\n  setStyle(element, 'display', opt_display ? '' : 'none');\n}\n\n\n/**\n * Returns a pixel value.\n * @param {number} value\n * @return {string}\n */\nexport function px(value) {\n  return `${value}px`;\n}\n\n/**\n * Returns a degree value.\n * @param {number} value\n * @return {string}\n */\nexport function deg(value) {\n  return `${value}deg`;\n}\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function translateX(value) {\n  if (typeof value == 'string') {\n    return `translateX(${value})`;\n  }\n  return `translateX(${px(value)})`;\n}\n\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} x\n * @param {(number|string)=} opt_y\n * @return {string}\n */\nexport function translate(x, opt_y) {\n  if (typeof x == 'number') {\n    x = px(x);\n  }\n  if (opt_y === undefined) {\n    return `translate(${x})`;\n  }\n  if (typeof opt_y == 'number') {\n    opt_y = px(opt_y);\n  }\n  return `translate(${x}, ${opt_y})`;\n}\n\n\n/**\n * Returns a \"scale\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function scale(value) {\n  return `scale(${value})`;\n}\n\n/**\n * Returns a \"rotate\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function rotate(value) {\n  if (typeof value == 'number') {\n    value = deg(value);\n  }\n  return `rotate(${value})`;\n}\n\n/**\n * Remove alpha value from a rgba color value.\n * Return the new color property with alpha equals if has the alpha value.\n * Caller needs to make sure the input color value is a valid rgba/rgb value\n * @param {string} rgbaColor\n * @return {string}\n */\nexport function removeAlphaFromColor(rgbaColor) {\n  return rgbaColor.replace(\n      /\\(([^,]+),([^,]+),([^,)]+),[^)]+\\)/g, '($1,$2,$3, 1)');\n}\n\n/**\n * Gets the computed style of the element. The helper is necessary to enforce\n * the possible `null` value returned by a buggy Firefox.\n *\n * @param {!Window} win\n * @param {!Element} el\n * @return {!Object<string, string>}\n */\nexport function computedStyle(win, el) {\n  const style = /** @type {?CSSStyleDeclaration} */(win.getComputedStyle(el));\n  return /** @type {!Object<string, string>} */(style) || map();\n}\n\n\n/**\n * Resets styles that were set dynamically (i.e. inline)\n * @param {!Element} element\n * @param {!Array<string>} properties\n */\nexport function resetStyles(element, properties) {\n  const styleObj = {};\n  properties.forEach(prop => {\n    styleObj[prop] = null;\n  });\n  setStyles(element, styleObj);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* @const */\nconst toString_ = Object.prototype.toString;\n\n/**\n * Returns the ECMA [[Class]] of a value\n * @param {*} value\n * @return {string}\n */\nfunction toString(value) {\n  return toString_.call(value);\n}\n\n/**\n * Determines if value is actually an Array.\n * @param {*} value\n * @return {boolean}\n */\nexport function isArray(value) {\n  return Array.isArray(value);\n}\n\n/**\n * Converts an array-like object to an array.\n * @param {?IArrayLike<T>|string} arrayLike\n * @return {!Array<T>}\n * @template T\n */\nexport function toArray(arrayLike) {\n  if (!arrayLike) {\n    return [];\n  }\n  const array = new Array(arrayLike.length);\n  for (let i = 0; i < arrayLike.length; i++) {\n    array[i] = arrayLike[i];\n  }\n  return array;\n}\n\n/**\n * Determines if value is actually an Object.\n * @param {*} value\n * @return {boolean}\n */\nexport function isObject(value) {\n  return toString(value) === '[object Object]';\n}\n\n/**\n * Determines if value is of number type and finite.\n * NaN and Infinity are not considered a finite number.\n * String numbers are not considered numbers.\n * @param {*} value\n * @return {boolean}\n */\nexport function isFiniteNumber(value) {\n  return (typeof value === 'number' && isFinite(value));\n}\n\n/**\n * Checks whether `s` is a valid value of `enumObj`.\n *\n * @param {!Object<T>} enumObj\n * @param {T} s\n * @return {boolean}\n * @template T\n */\nexport function isEnumValue(enumObj, s) {\n  for (const k in enumObj) {\n    if (enumObj[k] === s) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Externs declare that access `defaultView` from `document` or\n * `ownerDocument` is of type `(Window|null)` but most of our parameter types\n * assume that it is never null. This is OK in practice as we ever only get\n * null on disconnected documents or old IE.\n * This helper function casts it into just a simple Window return type.\n *\n * @param {!Window|null} winOrNull\n * @return {!Window}\n */\nexport function toWin(winOrNull) {\n  return /** @type {!Window} */ (winOrNull);\n}\n\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {tryDecodeUriComponent_} from './url-try-decode-uri-component';\n\nconst regex = /(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * DO NOT import the function from this file. Instead, import parseQueryString\n * from `src/url.js`.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString_(queryString) {\n  const params = /** @type {!JsonObject} */ (Object.create(null));\n  if (!queryString) {\n    return params;\n  }\n\n  let match;\n  while ((match = regex.exec(queryString))) {\n    const name = tryDecodeUriComponent_(match[1], match[1]);\n    const value = match[2] ? tryDecodeUriComponent_(match[2], match[2]) : '';\n    params[name] = value;\n  }\n  return params;\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * DO NOT import the function from this file. Instead, import\n * tryDecodeUriComponent from `src/url.js`.\n *\n * @param {string} component\n * @param {string=} fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent_(component, fallback = '') {\n  try {\n    return decodeURIComponent(component);\n  } catch (e) {\n    return fallback;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {LruCache} from './utils/lru-cache';\nimport {dict} from './utils/object';\nimport {endsWith, startsWith} from './string';\nimport {getMode} from './mode';\nimport {isArray} from './types';\nimport {parseQueryString_} from './url-parse-query-string';\nimport {tryDecodeUriComponent_} from './url-try-decode-uri-component';\nimport {urls} from './config';\nimport {user} from './log';\n\n/**\n * @type {!JsonObject}\n */\nconst SERVING_TYPE_PREFIX = dict({\n  // No viewer\n  'c': true,\n  // In viewer\n  'v': true,\n  // Ad landing page\n  'a': true,\n  // Ad\n  'ad': true,\n});\n\n/**\n * Cached a-tag to avoid memory allocation during URL parsing.\n * @type {HTMLAnchorElement}\n */\nlet a;\n\n/**\n * We cached all parsed URLs. As of now there are no use cases\n * of AMP docs that would ever parse an actual large number of URLs,\n * but we often parse the same one over and over again.\n * @type {LruCache}\n */\nlet cache;\n\n/** @private @const Matches amp_js_* parameters in query string. */\nconst AMP_JS_PARAMS_REGEX = /[?&]amp_js[^&]*/;\n\n/** @private @const Matches amp_gsa parameters in query string. */\nconst AMP_GSA_PARAMS_REGEX = /[?&]amp_gsa[^&]*/;\n\n/** @private @const Matches amp_r parameters in query string. */\nconst AMP_R_PARAMS_REGEX = /[?&]amp_r[^&]*/;\n\n/** @private @const Matches usqp parameters from goog experiment in query string. */\nconst GOOGLE_EXPERIMENT_PARAMS_REGEX = /[?&]usqp[^&]*/;\n\nconst INVALID_PROTOCOLS = [\n  /*eslint no-script-url: 0*/ 'javascript:',\n  /*eslint no-script-url: 0*/ 'data:',\n  /*eslint no-script-url: 0*/ 'vbscript:',\n];\n\n/** @const {string} */\nexport const SOURCE_ORIGIN_PARAM = '__amp_source_origin';\n\n/**\n * Returns the correct origin for a given window.\n * @param {!Window} win\n * @return {string} origin\n */\nexport function getWinOrigin(win) {\n  return win.origin || parseUrlDeprecated(win.location.href).origin;\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {string} url\n * @param {boolean=} opt_nocache\n * @return {!Location}\n */\nexport function parseUrlDeprecated(url, opt_nocache) {\n  if (!a) {\n    a = /** @type {!HTMLAnchorElement} */ (self.document.createElement('a'));\n    cache = self.UrlCache || (self.UrlCache = new LruCache(100));\n  }\n\n  return parseUrlWithA(a, url, opt_nocache ? null : cache);\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {!HTMLAnchorElement} a\n * @param {string} url\n * @param {LruCache=} opt_cache\n * @return {!Location}\n * @restricted\n */\nexport function parseUrlWithA(a, url, opt_cache) {\n  if (opt_cache && opt_cache.has(url)) {\n    return opt_cache.get(url);\n  }\n\n  a.href = url;\n\n  // IE11 doesn't provide full URL components when parsing relative URLs.\n  // Assigning to itself again does the trick #3449.\n  if (!a.protocol) {\n    a.href = a.href;\n  }\n\n  const info = /** @type {!Location} */({\n    href: a.href,\n    protocol: a.protocol,\n    host: a.host,\n    hostname: a.hostname,\n    port: a.port == '0' ? '' : a.port,\n    pathname: a.pathname,\n    search: a.search,\n    hash: a.hash,\n    origin: null, // Set below.\n  });\n\n  // Some IE11 specific polyfills.\n  // 1) IE11 strips out the leading '/' in the pathname.\n  if (info.pathname[0] !== '/') {\n    info.pathname = '/' + info.pathname;\n  }\n\n  // 2) For URLs with implicit ports, IE11 parses to default ports while\n  // other browsers leave the port field empty.\n  if ((info.protocol == 'http:' && info.port == 80)\n      || (info.protocol == 'https:' && info.port == 443)) {\n    info.port = '';\n    info.host = info.hostname;\n  }\n\n  // For data URI a.origin is equal to the string 'null' which is not useful.\n  // We instead return the actual origin which is the full URL.\n  if (a.origin && a.origin != 'null') {\n    info.origin = a.origin;\n  } else if (info.protocol == 'data:' || !info.host) {\n    info.origin = info.href;\n  } else {\n    info.origin = info.protocol + '//' + info.host;\n  }\n\n  // Freeze during testing to avoid accidental mutation.\n  const frozen = (getMode().test && Object.freeze) ? Object.freeze(info) : info;\n\n  if (opt_cache) {\n    opt_cache.put(url, frozen);\n  }\n\n  return frozen;\n}\n\n/**\n * Appends the string just before the fragment part (or optionally\n * to the front of the query string) of the URL.\n * @param {string} url\n * @param {string} paramString\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function appendEncodedParamStringToUrl(url, paramString,\n  opt_addToFront) {\n  if (!paramString) {\n    return url;\n  }\n  const mainAndFragment = url.split('#', 2);\n  const mainAndQuery = mainAndFragment[0].split('?', 2);\n\n  let newUrl = mainAndQuery[0] + (\n    mainAndQuery[1]\n      ? (opt_addToFront\n        ? `?${paramString}&${mainAndQuery[1]}`\n        : `?${mainAndQuery[1]}&${paramString}`)\n      : `?${paramString}`);\n  newUrl += mainAndFragment[1] ? `#${mainAndFragment[1]}` : '';\n  return newUrl;\n}\n/**\n * Appends a query string field and value to a url. `key` and `value`\n * will be ran through `encodeURIComponent` before appending.\n * @param {string} url\n * @param {string} key\n * @param {string} value\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function addParamToUrl(url, key, value, opt_addToFront) {\n  const field = `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\n  return appendEncodedParamStringToUrl(url, field, opt_addToFront);\n}\n\n/**\n * Appends query string fields and values to a url. The `params` objects'\n * `key`s and `value`s will be transformed into query string keys/values.\n * @param {string} url\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function addParamsToUrl(url, params) {\n  return appendEncodedParamStringToUrl(url, serializeQueryString(params));\n}\n\n/**\n * Serializes the passed parameter map into a query string with both keys\n * and values encoded.\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function serializeQueryString(params) {\n  const s = [];\n  for (const k in params) {\n    const v = params[k];\n    if (v == null) {\n      continue;\n    } else if (isArray(v)) {\n      for (let i = 0; i < v.length; i++) {\n        const sv = /** @type {string} */ (v[i]);\n        s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n      }\n    } else {\n      const sv = /** @type {string} */ (v);\n      s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n    }\n  }\n  return s.join('&');\n}\n\n/**\n * Returns `true` if the URL is secure: either HTTPS or localhost (for testing).\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isSecureUrlDeprecated(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return (url.protocol == 'https:' ||\n      url.hostname == 'localhost' ||\n      endsWith(url.hostname, '.localhost'));\n}\n\n/**\n * Asserts that a given url is HTTPS or protocol relative. It's a user-level\n * assert.\n *\n * Provides an exception for localhost.\n *\n * @param {?string|undefined} urlString\n * @param {!Element|string} elementContext Element where the url was found.\n * @param {string=} sourceName Used for error messages.\n * @return {string}\n */\nexport function assertHttpsUrl(\n  urlString, elementContext, sourceName = 'source') {\n  user().assert(urlString != null, '%s %s must be available',\n      elementContext, sourceName);\n  // (erwinm, #4560): type cast necessary until #4560 is fixed.\n  const theUrlString = /** @type {string} */ (urlString);\n  user().assert(isSecureUrlDeprecated(theUrlString) || /^(\\/\\/)/.test(theUrlString),\n      '%s %s must start with ' +\n      '\"https://\" or \"//\" or be relative and served from ' +\n      'either https or from localhost. Invalid value: %s',\n      elementContext, sourceName, theUrlString);\n  return theUrlString;\n}\n\n/**\n * Asserts that a given url is an absolute HTTP or HTTPS URL.\n * @param {string} urlString\n * @return {string}\n */\nexport function assertAbsoluteHttpOrHttpsUrl(urlString) {\n  user().assert(/^https?\\:/i.test(urlString),\n      'URL must start with \"http://\" or \"https://\". Invalid value: %s',\n      urlString);\n  return parseUrlDeprecated(urlString).href;\n}\n\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * This function is implemented in a separate file to avoid a circular\n * dependency.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString(queryString) {\n  return parseQueryString_(queryString);\n}\n\n/**\n * Returns the URL without fragment. If URL doesn't contain fragment, the same\n * string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function removeFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return url;\n  }\n  return url.substring(0, index);\n}\n\n/**\n * Returns the fragment from the URL. If the URL doesn't contain fragment,\n * the empty string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function getFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return '';\n  }\n  return url.substring(index);\n}\n\n/**\n * Returns whether the URL has the origin of a proxy.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isProxyOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.cdnProxyRegex.test(url.origin);\n}\n\n/**\n * For proxy-origin URLs, returns the serving type. Otherwise, returns null.\n * E.g., 'https://amp-com.cdn.ampproject.org/a/s/amp.com/amp_document.html'\n * returns 'a'.\n * @param {string|!Location} url URL of an AMP document.\n * @return {?string}\n */\nexport function getProxyServingType(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  if (!isProxyOrigin(url)) {\n    return null;\n  }\n  const path = url.pathname.split('/', 2);\n  return path[1];\n}\n\n/**\n * Returns whether the URL origin is localhost.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isLocalhostOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.localhostRegex.test(url.origin);\n}\n\n/**\n * Returns whether the URL has valid protocol.\n * Deep link protocol is valid, but not javascript etc.\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isProtocolValid(url) {\n  if (!url) {\n    return true;\n  }\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return !INVALID_PROTOCOLS.includes(url.protocol);\n}\n\n/**\n * Returns a URL without AMP JS parameters.\n * @param {string} url\n * @return {string}\n */\nexport function removeAmpJsParamsFromUrl(url) {\n  const parsed = parseUrlDeprecated(url);\n  const search = removeAmpJsParamsFromSearch(parsed.search);\n  return parsed.origin + parsed.pathname + search + parsed.hash;\n\n}\n\n/**\n * Returns a URL without a query string.\n * @param {string} url\n * @return {string}\n */\nexport function removeSearch(url) {\n  const index = url.indexOf('?');\n  if (index == -1) {\n    return url;\n  }\n  const fragment = getFragment(url);\n  return url.substring(0, index) + fragment;\n}\n\n/**\n * Removes parameters that start with amp js parameter pattern and returns the\n * new search string.\n * @param {string} urlSearch\n * @return {string}\n */\nfunction removeAmpJsParamsFromSearch(urlSearch) {\n  if (!urlSearch || urlSearch == '?') {\n    return '';\n  }\n  const search = urlSearch\n      .replace(AMP_JS_PARAMS_REGEX, '')\n      .replace(AMP_GSA_PARAMS_REGEX, '')\n      .replace(AMP_R_PARAMS_REGEX, '')\n      .replace(GOOGLE_EXPERIMENT_PARAMS_REGEX, '')\n      .replace(/^[?&]/, ''); // Removes first ? or &.\n  return search ? '?' + search : '';\n}\n\n/**\n * Returns the source URL of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string}\n */\nexport function getSourceUrl(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n\n  // Not a proxy URL - return the URL itself.\n  if (!isProxyOrigin(url)) {\n    return url.href;\n  }\n\n  // A proxy URL.\n  // Example path that is being matched here.\n  // https://cdn.ampproject.org/c/s/www.origin.com/foo/\n  // The /s/ is optional and signals a secure origin.\n  const path = url.pathname.split('/');\n  const prefix = path[1];\n  user().assert(SERVING_TYPE_PREFIX[prefix],\n      'Unknown path prefix in url %s', url.href);\n  const domainOrHttpsSignal = path[2];\n  const origin = domainOrHttpsSignal == 's'\n    ? 'https://' + decodeURIComponent(path[3])\n    : 'http://' + decodeURIComponent(domainOrHttpsSignal);\n  // Sanity test that what we found looks like a domain.\n  user().assert(origin.indexOf('.') > 0, 'Expected a . in origin %s', origin);\n  path.splice(1, domainOrHttpsSignal == 's' ? 3 : 2);\n  return origin + path.join('/') +\n      removeAmpJsParamsFromSearch(url.search) + (url.hash || '');\n}\n\n/**\n * Returns the source origin of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string} The source origin of the URL.\n */\nexport function getSourceOrigin(url) {\n  return parseUrlDeprecated(getSourceUrl(url)).origin;\n}\n\n/**\n * Returns absolute URL resolved based on the relative URL and the base.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n */\nexport function resolveRelativeUrl(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  if (typeof URL == 'function') {\n    return new URL(relativeUrlString, baseUrl.href).toString();\n  }\n  return resolveRelativeUrlFallback_(relativeUrlString, baseUrl);\n}\n\n/**\n * Fallback for URL resolver when URL class is not available.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n * @private Visible for testing.\n */\nexport function resolveRelativeUrlFallback_(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  relativeUrlString = relativeUrlString.replace(/\\\\/g, '/');\n  const relativeUrl = parseUrlDeprecated(relativeUrlString);\n\n  // Absolute URL.\n  if (startsWith(relativeUrlString.toLowerCase(), relativeUrl.protocol)) {\n    return relativeUrl.href;\n  }\n\n  // Protocol-relative URL.\n  if (startsWith(relativeUrlString, '//')) {\n    return baseUrl.protocol + relativeUrlString;\n  }\n\n  // Absolute path.\n  if (startsWith(relativeUrlString, '/')) {\n    return baseUrl.origin + relativeUrlString;\n  }\n\n  // Relative path.\n  return baseUrl.origin + baseUrl.pathname.replace(/\\/[^/]*$/, '/')\n      + relativeUrlString;\n}\n\n\n/**\n * Add \"__amp_source_origin\" query parameter to the URL.\n * @param {!Window} win\n * @param {string} url\n * @return {string}\n */\nexport function getCorsUrl(win, url) {\n  checkCorsUrl(url);\n  const sourceOrigin = getSourceOrigin(win.location.href);\n  return addParamToUrl(url, SOURCE_ORIGIN_PARAM, sourceOrigin);\n}\n\n\n/**\n * Checks if the url has __amp_source_origin and throws if it does.\n * @param {string} url\n */\nexport function checkCorsUrl(url) {\n  const parsedUrl = parseUrlDeprecated(url);\n  const query = parseQueryString(parsedUrl.search);\n  user().assert(!(SOURCE_ORIGIN_PARAM in query),\n      'Source origin is not allowed in %s', url);\n}\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * @param {string} component\n * @param {string=} opt_fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent(component, opt_fallback) {\n  return tryDecodeUriComponent_(component, opt_fallback);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Compares if two arrays contains exactly same elements of same number\n * of same order.\n * Notice that it does NOT handle NaN case as expected\n *\n * @param {!Array<T>} arr1\n * @param {!Array<T>} arr2\n * @return {boolean}\n * @template T\n */\nexport function areEqualOrdered(arr1, arr2) {\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n\n  for (let i = 0; i < arr1.length; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * A bit like Array#filter, but removes elements that filter false from the\n * array. Returns the filtered items.\n *\n * @param {!Array<T>} array\n * @param {function(T, number, !Array<T>):boolean} filter\n * @return {!Array<T>}\n * @template T\n */\nexport function filterSplice(array, filter) {\n  const splice = [];\n  let index = 0;\n  for (let i = 0; i < array.length; i++) {\n    const item = array[i];\n    if (filter(item, i, array)) {\n      if (index < i) {\n        array[index] = item;\n      }\n      index++;\n    } else {\n      splice.push(item);\n    }\n  }\n\n  if (index < array.length) {\n    array.length = index;\n  }\n\n  return splice;\n}\n\n/**\n * Returns the index of the first element matching the predicate.\n * Like Array#findIndex.\n *\n * @param {!Array<T>} array\n * @param {function(T, number, !Array<T>):boolean} predicate\n * @return {number}\n * @template T\n */\nexport function findIndex(array, predicate) {\n  for (let i = 0; i < array.length; i++) {\n    if (predicate(array[i], i, array)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n/**\n * Converts the given iterator to an array.\n *\n * @param {!Iterator<T>} iterator\n * @return {Array<T>}\n * @template T\n */\nexport function fromIterator(iterator) {\n  const array = [];\n  for (let e = iterator.next(); !e.done; e = iterator.next()) {\n    array.push(e.value);\n  }\n  return array;\n}\n\n/**\n * Adds item to array if it is not already present.\n *\n * @param {Array<T>} array\n * @param {T} item\n * @template T\n */\nexport function pushIfNotExist(array, item) {\n  if (array.indexOf(item) < 0) {\n    array.push(item);\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {bytesToString, stringToBytes, utf8Encode} from './bytes';\n\n/**\n * Character mapping from base64url to base64.\n * @const {!Object<string, string>}\n */\nconst base64UrlDecodeSubs = {'-': '+', '_': '/', '.': '='};\n\n/**\n * Character mapping from base64 to base64url.\n * @const {!Object<string, string>}\n */\nconst base64UrlEncodeSubs = {'+': '-', '/': '_', '=': '.'};\n\n/**\n * Converts a string which is in base64url encoding into a Uint8Array\n * containing the decoded value.\n * @param {string} str\n * @return {!Uint8Array}\n */\nexport function base64UrlDecodeToBytes(str) {\n  const encoded = atob(str.replace(/[-_.]/g, ch => base64UrlDecodeSubs[ch]));\n  return stringToBytes(encoded);\n}\n\n/**\n * Converts a string which is in base64 encoding into a Uint8Array\n * containing the decoded value.\n * @param {string} str\n * @return {!Uint8Array}\n */\nexport function base64DecodeToBytes(str) {\n  return stringToBytes(atob(str));\n}\n\n/**\n * Converts a bytes array into base64url encoded string.\n * base64url is defined in RFC 4648. It is sometimes referred to as \"web safe\".\n * @param {!Uint8Array} bytes\n * @return {string}\n */\nexport function base64UrlEncodeFromBytes(bytes) {\n  const str = bytesToString(bytes);\n  return btoa(str).replace(/[+/=]/g, ch => base64UrlEncodeSubs[ch]);\n}\n\n/**\n * Converts a string into base64url encoded string.\n * base64url is defined in RFC 4648. It is sometimes referred to as \"web safe\".\n * @param {string} str\n * @return {string}\n */\nexport function base64UrlEncodeFromString(str) {\n  const bytes = utf8Encode(str);\n  return base64UrlEncodeFromBytes(bytes);\n}\n\n/**\n * Converts a bytes array into base64 encoded string.\n * @param {!Uint8Array} bytes\n * @return {string}\n */\nexport function base64EncodeFromBytes(bytes) {\n  return btoa(bytesToString(bytes));\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from '../log';\n\n/**\n * Interpret a byte array as a UTF-8 string.\n * @param {!BufferSource} bytes\n * @return {string}\n */\nexport function utf8Decode(bytes) {\n  if (typeof TextDecoder !== 'undefined') {\n    return new TextDecoder('utf-8').decode(bytes);\n  }\n  const asciiString = bytesToString(new Uint8Array(bytes.buffer || bytes));\n  return decodeURIComponent(escape(asciiString));\n}\n\n/**\n * Turn a string into UTF-8 bytes.\n * @param {string} string\n * @return {!Uint8Array}\n */\nexport function utf8Encode(string) {\n  if (typeof TextEncoder !== 'undefined') {\n    return new TextEncoder('utf-8').encode(string);\n  }\n  return stringToBytes(unescape(encodeURIComponent(string)));\n}\n\n/**\n * Converts a string which holds 8-bit code points, such as the result of atob,\n * into a Uint8Array with the corresponding bytes.\n * If you have a string of characters, you probably want to be using utf8Encode.\n * @param {string} str\n * @return {!Uint8Array}\n */\nexport function stringToBytes(str) {\n  const bytes = new Uint8Array(str.length);\n  for (let i = 0; i < str.length; i++) {\n    const charCode = str.charCodeAt(i);\n    dev().assert(charCode <= 255, 'Characters must be in range [0,255]');\n    bytes[i] = charCode;\n  }\n  return bytes;\n}\n\n/**\n * Converts a 8-bit bytes array into a string\n * @param {!Uint8Array} bytes\n * @return {string}\n */\nexport function bytesToString(bytes) {\n  // Intentionally avoids String.fromCharCode.apply so we don't suffer a\n  // stack overflow. #10495, https://jsperf.com/bytesToString-2\n  const array = new Array(bytes.length);\n  for (let i = 0; i < bytes.length; i++) {\n    array[i] = String.fromCharCode(bytes[i]);\n  }\n  return array.join('');\n}\n\n/**\n * Converts a 4-item byte array to an unsigned integer.\n * Assumes bytes are big endian.\n * @param {!Uint8Array} bytes\n * @return {number}\n */\nexport function bytesToUInt32(bytes) {\n  if (bytes.length != 4) {\n    throw new Error('Received byte array with length != 4');\n  }\n  const val = (bytes[0] & 0xFF) << 24 |\n     (bytes[1] & 0xFF) << 16 |\n     (bytes[2] & 0xFF) << 8 |\n     (bytes[3] & 0xFF);\n  // Convert to unsigned.\n  return val >>> 0;\n}\n\n/**\n * Generate a random bytes array with specific length using\n * win.crypto.getRandomValues. Return null if it is not available.\n * @param {!Window} win\n * @param {number} length\n * @return {?Uint8Array}\n */\nexport function getCryptoRandomBytesArray(win, length) {\n  if (!win.crypto || !win.crypto.getRandomValues) {\n    return null;\n  }\n\n  // Widely available in browsers we support:\n  // http://caniuse.com/#search=getRandomValues\n  const uint8array = new Uint8Array(length);\n  win.crypto.getRandomValues(uint8array);\n  return uint8array;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {stringHash32} from '../string';\n\n\n/**\n * Gets a string of concatenated element names and relative positions\n * of the DOM element and its parentElement's (up to 25).  Relative position\n * is the index of nodes with this tag within the parent's children.\n * The order is from the inner to outer nodes in DOM hierarchy.\n *\n * If a DOM hierarchy is the following:\n *\n * <div id='id1' ...>\n *   <div id='id2' ...>\n *     <table ...>       // table:0\n *       <tr>            // tr:0\n *         <td>...</td>  // td:0\n *         <td>          // td:1\n *           <amp-ad ...></amp-ad>\n *         </td>\n *       </tr>\n *       <tr>...</tr>    // tr:1\n *     </table>\n *   </div>\n * </div>\n *\n * With the amp-ad element passed in:\n * 'amp-ad.0,td.1,tr.0,table.0,div/id2.0,div/id1.0'\n *\n * Note: 25 is chosen arbitrarily.\n *\n * @param {?Element} element DOM node from which to get fingerprint.\n * @return {string} Concatenated element ids.\n */\nexport function domFingerprintPlain(element) {\n  const ids = [];\n  let level = 0;\n  while (element && element.nodeType == /* element */ 1 && level < 25) {\n    let id = '';\n    if (element.id) {\n      id = `/${element.id}`;\n    }\n    const nodeName = element.nodeName.toLowerCase();\n    ids.push(`${nodeName}${id}${indexWithinParent(element)}`);\n    level++;\n    element = element.parentElement;\n  }\n  return ids.join();\n}\n\n\nexport class DomFingerprint {\n  /**\n   * Calculates ad slot DOM fingerprint.  This key is intended to\n   * identify \"same\" ad unit across many page views. This is\n   * based on where the ad appears within the page's DOM structure.\n   *\n   * @param {?Element} element The DOM element from which to collect\n   *     the DOM chain element IDs.  If null, DOM chain element IDs are not\n   *     included in the hash.\n   * @return {string} The ad unit hash key string.\n   */\n  static generate(element) {\n    return stringHash32(domFingerprintPlain(element));\n  }\n}\n\n\n/**\n * Gets a string showing the index of an element within\n * the children of its parent, counting only nodes with the same tag.\n * Stop at 25, just to have a limit.\n * @param {!Element} element DOM node to get index of.\n * @return {string} '.<index>' or ''.\n */\nfunction indexWithinParent(element) {\n  const {nodeName} = element;\n  // Find my index within my parent's children\n  let i = 0;\n  let count = 0;\n  let sibling = element.previousElementSibling;\n  // Different browsers have different children.\n  // So count only nodes with the same tag.\n  // Use a limit for the tags, so that different browsers get the same\n  // count. So 25 and higher all return no index.\n  while (sibling && count < 25 && i < 100) {\n    if (sibling.nodeName == nodeName) {\n      count++;\n    }\n    i++;\n    sibling = sibling.previousElementSibling;\n  }\n  // If we got to the end, then the count is accurate; otherwise skip count.\n  return count < 25 && i < 100 ? `.${count}` : '';\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from '../log';\n\n/** @const {string} */\nconst TAG = 'lru-cache';\n\n/**\n * @template T\n */\nexport class LruCache {\n  /**\n   * @param {number} capacity\n   */\n  constructor(capacity) {\n    /** @private @const {number} */\n    this.capacity_ = capacity;\n\n    /** @private {number} */\n    this.size_ = 0;\n\n    /**\n     * An incrementing counter to define the last access.\n     * @private {number}\n     */\n    this.access_ = 0;\n\n    /** @private {!Object<(number|string), {payload: T, access: number}>} */\n    this.cache_ = Object.create(null);\n  }\n\n  /**\n   * Returns whether key is cached.\n   *\n   * @param {number|string} key\n   * @return {boolean}\n   */\n  has(key) {\n    return !!this.cache_[key];\n  }\n\n  /**\n   * @param {number|string} key\n   * @return {T} The cached payload.\n   */\n  get(key) {\n    const cacheable = this.cache_[key];\n    if (cacheable) {\n      cacheable.access = ++this.access_;\n      return cacheable.payload;\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {number|string} key\n   * @param {T} payload The payload to cache.\n   */\n  put(key, payload) {\n    if (!this.has(key)) {\n      this.size_++;\n    }\n    this.cache_[key] = {payload, access: this.access_};\n    this.evict_();\n  }\n\n  /**\n   * Evicts the oldest cache entry, if we've exceeded capacity.\n   */\n  evict_() {\n    if (this.size_ <= this.capacity_) {\n      return;\n    }\n\n    dev().warn(TAG, 'Trimming LRU cache');\n    const cache = this.cache_;\n    let oldest = this.access_ + 1;\n    let oldestKey;\n    for (const key in cache) {\n      const {access} = cache[key];\n      if (access < oldest) {\n        oldest = access;\n        oldestKey = key;\n      }\n    }\n\n    if (oldestKey !== undefined) {\n      delete cache[oldestKey];\n      this.size_--;\n    }\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {isObject} from '../types';\n\n/* @const */\nconst hasOwn_ = Object.prototype.hasOwnProperty;\n\n/**\n * Returns a map-like object.\n * If opt_initial is provided, copies its own properties into the\n * newly created object.\n * @param {T=} opt_initial This should typically be an object literal.\n * @return {T}\n * @template T\n */\nexport function map(opt_initial) {\n  const obj = Object.create(null);\n  if (opt_initial) {\n    Object.assign(obj, opt_initial);\n  }\n  return obj;\n}\n\n/**\n * Return an empty JsonObject or makes the passed in object literal\n * an JsonObject.\n * The JsonObject type is just a simple object that is at-dict.\n * See\n * https://github.com/google/closure-compiler/wiki/@struct-and-@dict-Annotations\n * for what a dict is type-wise.\n * The linter enforces that the argument is, in fact, at-dict like.\n * @param {!Object=} opt_initial\n * @return {!JsonObject}\n */\nexport function dict(opt_initial) {\n  // We do not copy. The linter enforces that the passed in object is a literal\n  // and thus the caller cannot have a reference to it.\n  return /** @type {!JsonObject} */ (opt_initial || {});\n}\n\n/**\n * Checks if the given key is a property in the map.\n *\n * @param {T}  obj a map like property.\n * @param {string}  key\n * @return {boolean}\n * @template T\n */\nexport function hasOwn(obj, key) {\n  return hasOwn_.call(obj, key);\n}\n\n/**\n * Returns obj[key] iff key is obj's own property (is not inherited).\n * Otherwise, returns undefined.\n *\n * @param {Object} obj\n * @param {string} key\n * @return {*}\n */\nexport function ownProperty(obj, key) {\n  if (hasOwn(obj, key)) {\n    return obj[key];\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Deep merges source into target.\n *\n * @param {!Object} target\n * @param {!Object} source\n * @param {number} depth The maximum merge depth. If exceeded, Object.assign\n *                       will be used instead.\n * @return {!Object}\n * @throws {Error} If source contains a circular reference.\n * Note: Only nested objects are deep-merged, primitives and arrays are not.\n */\nexport function deepMerge(target, source, depth = 10) {\n  // Keep track of seen objects to detect recursive references.\n  const seen = [];\n\n  /** @type {!Array<{t: !Object, s: !Object, d: number}>} */\n  const queue = [];\n  queue.push({t: target, s: source, d: 0});\n\n  // BFS to ensure objects don't have recursive references at shallower depths.\n  while (queue.length > 0) {\n    const {t, s, d} = queue.shift();\n    if (seen.includes(s)) {\n      throw new Error('Source object has a circular reference.');\n    }\n    seen.push(s);\n    if (t === s) {\n      continue;\n    }\n    if (d > depth) {\n      Object.assign(t, s);\n      continue;\n    }\n    Object.keys(s).forEach(key => {\n      const newValue = s[key];\n      // Perform a deep merge IFF both target and source have the same key\n      // whose corresponding values are objects.\n      if (hasOwn(t, key)) {\n        const oldValue = t[key];\n        if (isObject(newValue) && isObject(oldValue)) {\n          queue.push({t: oldValue, s: newValue, d: d + 1});\n          return;\n        }\n      }\n      t[key] = newValue;\n    });\n  }\n  return target;\n}\n\n/**\n * @param {!Object} o An object to remove properties from\n * @param {!Array<string>} props A list of properties to remove from the Object\n * @return {!Object} An object with the given properties removed\n */\nexport function omit(o, props) {\n  return Object.keys(o).reduce((acc, key) => {\n    if (!props.includes(key)) {\n      acc[key] = o[key];\n    }\n    return acc;\n  }, {});\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns a Deferred struct, which holds a pending promise and its associated\n * resolve and reject functions.\n *\n * This is preferred instead of creating a Promise instance to extract the\n * resolve/reject functions yourself:\n *\n * ```\n * // Avoid doing\n * let resolve;\n * const promise = new Promise(res => {\n *   resolve = res;\n * });\n *\n * // Good\n * const deferred = new Deferred();\n * const { promise, resolve } = deferred;\n * ```\n *\n * @template T\n */\nexport class Deferred {\n  /**\n   * Creates an instance of Deferred.\n   */\n  constructor() {\n    let resolve, reject;\n\n    /**\n     * @const {!Promise<T>}\n     */\n    this.promise = new /*OK*/Promise((res, rej) => {\n      resolve = res;\n      reject = rej;\n    });\n\n    /**\n     * @const {function(T=)}\n     */\n    this.resolve = resolve;\n\n    /**\n     * @const {function(*=)}\n     */\n    this.reject = reject;\n  }\n}\n\n/**\n * Creates a promise resolved to the return value of fn.\n * If fn sync throws, it will cause the promise to reject.\n *\n * @param {function():T} fn\n * @return {!Promise<T>}\n * @template T\n */\nexport function tryResolve(fn) {\n  return new Promise(resolve => {\n    resolve(fn());\n  });\n}\n\n/**\n * Returns a promise which resolves if a threshold amount of the given promises\n * resolve, and rejects otherwise.\n * @param {!Array<!Promise>} promises The array of promises to test.\n * @param {number} count The number of promises that must resolve for the\n *     returned promise to resolve.\n * @return {!Promise} A promise that resolves if any of the given promises\n *     resolve, and which rejects otherwise.\n */\nexport function some(promises, count = 1) {\n  return new Promise((resolve, reject) => {\n    count = Math.max(count, 0);\n    const extra = promises.length - count;\n    if (extra < 0) {\n      reject(new Error('not enough promises to resolve'));\n    }\n    if (promises.length == 0) {\n      resolve([]);\n    }\n    const values = [];\n    const reasons = [];\n\n    const onFulfilled = value => {\n      if (values.length < count) {\n        values.push(value);\n      }\n      if (values.length == count) {\n        resolve(values);\n      }\n    };\n    const onRejected = reason => {\n      if (reasons.length <= extra) {\n        reasons.push(reason);\n      }\n      if (reasons.length > extra) {\n        reject(reasons);\n      }\n    };\n    for (let i = 0; i < promises.length; i++) {\n      Promise.resolve(promises[i]).then(onFulfilled, onRejected);\n    }\n  });\n}\n\n/**\n * Resolves with the result of the last promise added.\n * @implements {IThenable}\n */\nexport class LastAddedResolver {\n  /**\n   * @param {!Array<!Promise>=} opt_promises\n   */\n  constructor(opt_promises) {\n    let resolve_, reject_;\n    /** @private @const {!Promise} */\n    this.promise_ = new Promise((resolve, reject) => {\n      resolve_ = resolve;\n      reject_ = reject;\n    });\n\n    /** @private */\n    this.resolve_ = resolve_;\n\n    /** @private */\n    this.reject_ = reject_;\n\n    /** @private */\n    this.count_ = 0;\n\n    if (opt_promises) {\n      for (let i = 0; i < opt_promises.length; i++) {\n        this.add(opt_promises[i]);\n      }\n    }\n  }\n\n  /**\n   * Add a promise to possibly be resolved.\n   * @param {!Promise} promise\n   * @return {!Promise}\n   */\n  add(promise) {\n    const countAtAdd = ++this.count_;\n    Promise.resolve(promise).then(result => {\n      if (this.count_ === countAtAdd) {\n        this.resolve_(result);\n      }\n    }, error => {\n      // Don't follow behavior of Promise.all and Promise.race error so that\n      // this will only reject when most recently added promise fails.\n      if (this.count_ === countAtAdd) {\n        this.reject_(error);\n      }\n    });\n    return this.promise_;\n  }\n\n  /** @override */\n  then(opt_resolve, opt_reject) {\n    return this.promise_.then(opt_resolve, opt_reject);\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Wraps a given callback and applies a rate limit.\n * It throttles the calls so that no consequent calls have time interval\n * smaller than the given minimal interval.\n *\n * @param {!Window} win\n * @param {function(...*)} callback\n * @param {number} minInterval the minimum time interval in millisecond\n * @return {function(...*)}\n */\nexport function throttle(win, callback, minInterval) {\n  let locker = 0;\n  let nextCallArgs = null;\n\n  /**\n   * @param {!Object} args\n   */\n  function fire(args) {\n    nextCallArgs = null;\n    // Lock the fire for minInterval milliseconds\n    locker = win.setTimeout(waiter, minInterval);\n\n    callback.apply(null, args);\n  }\n\n  /**\n   * Waiter function\n   */\n  function waiter() {\n    locker = 0;\n    // If during the period there're invocations queued up, fire once.\n    if (nextCallArgs) {\n      fire(nextCallArgs);\n    }\n  }\n\n  return function(...args) {\n    if (locker) {\n      nextCallArgs = args;\n    } else {\n      fire(args);\n    }\n  };\n}\n\n/**\n * Wraps a given callback and applies a wait timer, so that minInterval\n * milliseconds must pass since the last call before the callback is actually\n * invoked.\n *\n * @param {!Window} win\n * @param {function(...*)} callback\n * @param {number} minInterval the minimum time interval in millisecond\n * @return {function(...*)}\n */\nexport function debounce(win, callback, minInterval) {\n  let locker = 0;\n  let timestamp = 0;\n  let nextCallArgs = null;\n\n  /**\n   * @param {?Array} args\n   */\n  function fire(args) {\n    nextCallArgs = null;\n    callback.apply(null, args);\n  }\n\n  /**\n   * Wait function for debounce\n   */\n  function waiter() {\n    locker = 0;\n    const remaining = minInterval - (win.Date.now() - timestamp);\n    if (remaining > 0) {\n      locker = win.setTimeout(waiter, remaining);\n    } else {\n      fire(nextCallArgs);\n    }\n  }\n\n  return function(...args) {\n    timestamp = win.Date.now();\n    nextCallArgs = args;\n    if (!locker) {\n      locker = win.setTimeout(waiter, minInterval);\n    }\n  };\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Deferred} from './promise';\nimport {map} from './object';\n\n\n/**\n * This object tracts signals and allows blocking until a signal has been\n * received.\n */\nexport class Signals {\n\n  /**\n   * Creates an instance of Signals.\n   */\n  constructor() {\n    /**\n     * A mapping from a signal name to the signal response: either time or\n     * an error.\n     * @private @const {!Object<string, (time|!Error)>}\n     */\n    this.map_ = map();\n\n    /**\n     * A mapping from a signal name to the signal promise, resolve and reject.\n     * Only allocated when promise has been requested.\n     * @private {?Object<string, {\n     *   promise: !Promise,\n     *   resolve: (function(time)|undefined),\n     *   reject: (function(!Error)|undefined)\n     * }>}\n     */\n    this.promiseMap_ = null;\n  }\n\n  /**\n   * Returns the current known value of the signal. If signal is not yet\n   * available, `null` is returned.\n   * @param {string} name\n   * @return {number|!Error|null}\n   */\n  get(name) {\n    return this.map_[name] || null;\n  }\n\n  /**\n   * Returns the promise that's resolved when the signal is triggered. The\n   * resolved value is the time of the signal.\n   * @param {string} name\n   * @return {!Promise<time>}\n   */\n  whenSignal(name) {\n    let promiseStruct = this.promiseMap_ && this.promiseMap_[name];\n    if (!promiseStruct) {\n      const result = this.map_[name];\n      if (result != null) {\n        // Immediately resolve signal.\n        const promise = typeof result == 'number' ?\n          Promise.resolve(result) :\n          Promise.reject(result);\n        promiseStruct = {promise};\n      } else {\n        // Allocate the promise/resolver for when the signal arrives in the\n        // future.\n        const deferred = new Deferred();\n        const {promise, resolve, reject} = deferred;\n\n        promiseStruct = {promise, resolve, reject};\n      }\n      if (!this.promiseMap_) {\n        this.promiseMap_ = map();\n      }\n      this.promiseMap_[name] = promiseStruct;\n    }\n    return promiseStruct.promise;\n  }\n\n  /**\n   * Triggers the signal with the specified name on the element. The time is\n   * optional; if not provided, the current time is used. The associated\n   * promise is resolved with the resulting time.\n   * @param {string} name\n   * @param {time=} opt_time\n   */\n  signal(name, opt_time) {\n    if (this.map_[name] != null) {\n      // Do not duplicate signals.\n      return;\n    }\n    const time = opt_time || Date.now();\n    this.map_[name] = time;\n    const promiseStruct = this.promiseMap_ && this.promiseMap_[name];\n    if (promiseStruct && promiseStruct.resolve) {\n      promiseStruct.resolve(time);\n      promiseStruct.resolve = undefined;\n      promiseStruct.reject = undefined;\n    }\n  }\n\n  /**\n   * Rejects the signal. Indicates that the signal will never succeed. The\n   * associated signal is rejected.\n   * @param {string} name\n   * @param {!Error} error\n   */\n  rejectSignal(name, error) {\n    if (this.map_[name] != null) {\n      // Do not duplicate signals.\n      return;\n    }\n    this.map_[name] = error;\n    const promiseStruct = this.promiseMap_ && this.promiseMap_[name];\n    if (promiseStruct && promiseStruct.reject) {\n      promiseStruct.reject(error);\n      promiseStruct.resolve = undefined;\n      promiseStruct.reject = undefined;\n    }\n  }\n\n  /**\n   * Resets all signals.\n   * @param {string} name\n   */\n  reset(name) {\n    if (this.map_[name]) {\n      delete this.map_[name];\n    }\n    // Reset promise it has already been resolved.\n    const promiseStruct = this.promiseMap_ && this.promiseMap_[name];\n    if (promiseStruct && !promiseStruct.resolve) {\n      delete this.promiseMap_[name];\n    }\n  }\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * An interface to interact with browser window object.\n * Mainly used to mock out read only APIs in test.\n * See test-helper.js#mockWindowInterface\n */\nexport class WindowInterface {\n\n  /**\n   * @static\n   * @param {!Window} win\n   * @return {string}\n   */\n  static getDocumentReferrer(win) {\n    return win.document.referrer;\n  }\n\n  /**\n   * @static\n   * @param {!Window} win\n   * @return {string}\n   */\n  static getHostname(win) {\n    return win.location.hostname;\n  }\n}\n","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n\n\n/**\n * This regex consists of 4 matching capture groups and one (non-matching) fallback:\n *\n * - (\\0), catch the null terminator character so it may be replaced by UTF\n *   Replacement Char\n * - ^(-)$, catch a solitary dash char, so that it may be backslash escaped.\n *   This is a separate capture group so that the legal-chars (group 4) doesn't\n *   capture it first, since that group doesn't need to escape its dash.\n * - ([\\x01-\\x1f\\x7f]|^-?[0-9]), catch a UTF control char, or any leading\n *   number (with an optional leading dash). The control or the number (but not\n *   the leading dash) must be hex-escaped,.\n * - ([\\x80-\\uffff0-9a-zA-Z_-]+), catch legal-chars, with the exception of a\n *   solitary dash, which will already have matched in group 1.\n * - [^], finally, a catch-all that allows us to backslash escape the char.\n *\n * Together, this matches everything necessary for CSS.escape.\n */\nvar regex = /(\\0)|^(-)$|([\\x01-\\x1f\\x7f]|^-?[0-9])|([\\x80-\\uffff0-9a-zA-Z_-]+)|[^]/g;\n\nfunction escaper(match, nil, dash, hexEscape, chars) {\n  // Chars is the legal-chars (group 4) capture\n  if (chars) {\n    return chars;\n  }\n  // Nil is the null terminator (group 1) capture\n  if (nil) {\n    return '\\uFFFD';\n  }\n  // Both UTF control chars, and leading numbers (with optional leading dash)\n  // (group 3) must be backslash escaped with a trailing space.  Funnily, the\n  // leading dash must not be escaped, but the number. :shrug:\n  if (hexEscape) {\n    return match.slice(0, -1) + '\\\\' + match.slice(-1).charCodeAt(0).toString(16) + ' '\n  }\n  // Finally, the solitary dash and the catch-all chars require backslash\n  // escaping.\n  return '\\\\' + match;\n}\n\n/**\n * https://drafts.csswg.org/cssom/#serialize-an-identifier\n * @param {string} value\n * @return {string}\n */\nexport function cssEscape(value) {\n  return String(value).replace(regex, escaper);\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhZHMvX2E0YS1jb25maWcuanMiLCJhZHMvX2NvbmZpZy5qcyIsImFkcy9nb29nbGUvYTRhL2V4cGVyaW1lbnQtdXRpbHMuanMiLCJhZHMvZ29vZ2xlL2E0YS9saW5lLWRlbGltaXRlZC1yZXNwb25zZS1oYW5kbGVyLmpzIiwiYWRzL2dvb2dsZS9hNGEvdHJhZmZpYy1leHBlcmltZW50cy5qcyIsImFkcy9nb29nbGUvYTRhL3VybC1idWlsZGVyLmpzIiwiYWRzL2dvb2dsZS9hNGEvdXRpbHMuanMiLCJhZHMvZ29vZ2xlL3V0aWxzLmpzIiwiZXh0ZW5zaW9ucy9hbXAtYTRhLzAuMS9hNGEtdmFyaWFibGUtc291cmNlLmpzIiwiZXh0ZW5zaW9ucy9hbXAtYTRhLzAuMS9hbXAtYTRhLmpzIiwiZXh0ZW5zaW9ucy9hbXAtYTRhLzAuMS9jYWxsb3V0LXZlbmRvcnMuanMiLCJleHRlbnNpb25zL2FtcC1hNGEvMC4xL3JlYWwtdGltZS1jb25maWctbWFuYWdlci5qcyIsImV4dGVuc2lvbnMvYW1wLWE0YS8wLjEvcmVmcmVzaC1pbnRlcnNlY3Rpb24tb2JzZXJ2ZXItd3JhcHBlci5qcyIsImV4dGVuc2lvbnMvYW1wLWE0YS8wLjEvcmVmcmVzaC1tYW5hZ2VyLmpzIiwiZXh0ZW5zaW9ucy9hbXAtYTRhLzAuMS9zaWduYXR1cmUtdmVyaWZpZXIuanMiLCJleHRlbnNpb25zL2FtcC1hZC1uZXR3b3JrLWFkc2Vuc2UtaW1wbC8wLjEvYWRzZW5zZS1hNGEtY29uZmlnLmpzIiwiZXh0ZW5zaW9ucy9hbXAtYWQtbmV0d29yay1jbG91ZGZsYXJlLWltcGwvMC4xL2Nsb3VkZmxhcmUtYTRhLWNvbmZpZy5qcyIsImV4dGVuc2lvbnMvYW1wLWFkLW5ldHdvcmstZG91YmxlY2xpY2staW1wbC8wLjEvYW1wLWFkLW5ldHdvcmstZG91YmxlY2xpY2staW1wbC5qcyIsImV4dGVuc2lvbnMvYW1wLWFkLW5ldHdvcmstZG91YmxlY2xpY2staW1wbC8wLjEvc2FmZWZyYW1lLWhvc3QuanMiLCJleHRlbnNpb25zL2FtcC1hZC1uZXR3b3JrLWRvdWJsZWNsaWNrLWltcGwvMC4xL3NyYS11dGlscy5qcyIsImV4dGVuc2lvbnMvYW1wLWFkLW5ldHdvcmstZ21vc3NwLWltcGwvMC4xL2dtb3NzcC1hNGEtY29uZmlnLmpzIiwiZXh0ZW5zaW9ucy9hbXAtYWQtbmV0d29yay10cmlwbGVsaWZ0LWltcGwvMC4xL3RyaXBsZWxpZnQtYTRhLWNvbmZpZy5qcyIsImV4dGVuc2lvbnMvYW1wLWFkLzAuMS9jb25jdXJyZW50LWxvYWQuanMiLCJub2RlX21vZHVsZXMvZG9jdW1lbnQtcmVnaXN0ZXItZWxlbWVudC9idWlsZC9kb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50LnBhdGNoZWQuanMiLCJub2RlX21vZHVsZXMvcHJvbWlzZS1wanMvcHJvbWlzZS5qcyIsInNyYy8zcC1mcmFtZS1tZXNzYWdpbmcuanMiLCJzcmMvM3AtZnJhbWUuanMiLCJzcmMvYWQtY2lkLmpzIiwic3JjL2FkLWhlbHBlci5qcyIsInNyYy9hbXAtZXZlbnRzLmpzIiwic3JjL2FuYWx5dGljcy5qcyIsInNyYy9jb21tb24tc2lnbmFscy5qcyIsInNyYy9jb25maWcuanMiLCJzcmMvY29uc2VudC1zdGF0ZS5qcyIsInNyYy9jb25zZW50LmpzIiwic3JjL2Nvb2tpZXMuanMiLCJzcmMvZG9jdW1lbnQtcmVhZHkuanMiLCJzcmMvZG9tLmpzIiwic3JjL2VsZW1lbnQtc2VydmljZS5qcyIsInNyYy9lcnJvci5qcyIsInNyYy9ldmVudC1oZWxwZXItbGlzdGVuLmpzIiwic3JjL2V2ZW50LWhlbHBlci5qcyIsInNyYy9leHBlcmltZW50cy5qcyIsInNyYy9leHBvbmVudGlhbC1iYWNrb2ZmLmpzIiwic3JjL2V4dGVuc2lvbi1hbmFseXRpY3MuanMiLCJzcmMvZnJpZW5kbHktaWZyYW1lLWVtYmVkLmpzIiwic3JjL2lmcmFtZS1hdHRyaWJ1dGVzLmpzIiwic3JjL2lmcmFtZS1oZWxwZXIuanMiLCJzcmMvaW1wcmVzc2lvbi5qcyIsInNyYy9pbnRlcnNlY3Rpb24tb2JzZXJ2ZXItcG9seWZpbGwuanMiLCJzcmMvanNvbi5qcyIsInNyYy9sYXlvdXQtcmVjdC5qcyIsInNyYy9sYXlvdXQuanMiLCJzcmMvbG9nLmpzIiwic3JjL21vZGUtb2JqZWN0LmpzIiwic3JjL21vZGUuanMiLCJzcmMvb2JzZXJ2YWJsZS5qcyIsInNyYy9wb2x5ZmlsbHMuanMiLCJzcmMvcG9seWZpbGxzL2FycmF5LWluY2x1ZGVzLmpzIiwic3JjL3BvbHlmaWxscy9jdXN0b20tZWxlbWVudHMuanMiLCJzcmMvcG9seWZpbGxzL2RvY3VtZW50LWNvbnRhaW5zLmpzIiwic3JjL3BvbHlmaWxscy9kb210b2tlbmxpc3QtdG9nZ2xlLmpzIiwic3JjL3BvbHlmaWxscy9tYXRoLXNpZ24uanMiLCJzcmMvcG9seWZpbGxzL29iamVjdC1hc3NpZ24uanMiLCJzcmMvcG9seWZpbGxzL3Byb21pc2UuanMiLCJzcmMvcmVuZGVyLWRlbGF5aW5nLXNlcnZpY2VzLmpzIiwic3JjL3NlcnZpY2UuanMiLCJzcmMvc2VydmljZS9uYXZpZ2F0aW9uLmpzIiwic3JjL3NlcnZpY2UvdXJsLWV4cGFuZGVyL2V4cGFuZGVyLmpzIiwic3JjL3NlcnZpY2UvdXJsLXJlcGxhY2VtZW50cy1pbXBsLmpzIiwic3JjL3NlcnZpY2UvdmFyaWFibGUtc291cmNlLmpzIiwic3JjL3NlcnZpY2VzLmpzIiwic3JjL3N0YXRpYy10ZW1wbGF0ZS5qcyIsInNyYy9zdHJpbmcuanMiLCJzcmMvc3R5bGUtaW5zdGFsbGVyLmpzIiwic3JjL3N0eWxlLmpzIiwic3JjL3R5cGVzLmpzIiwic3JjL3VybC1wYXJzZS1xdWVyeS1zdHJpbmcuanMiLCJzcmMvdXJsLXRyeS1kZWNvZGUtdXJpLWNvbXBvbmVudC5qcyIsInNyYy91cmwuanMiLCJzcmMvdXRpbHMvYXJyYXkuanMiLCJzcmMvdXRpbHMvYmFzZTY0LmpzIiwic3JjL3V0aWxzL2J5dGVzLmpzIiwic3JjL3V0aWxzL2RvbS1maW5nZXJwcmludC5qcyIsInNyYy91dGlscy9scnUtY2FjaGUuanMiLCJzcmMvdXRpbHMvb2JqZWN0LmpzIiwic3JjL3V0aWxzL3Byb21pc2UuanMiLCJzcmMvdXRpbHMvcmF0ZS1saW1pdC5qcyIsInNyYy91dGlscy9zaWduYWxzLmpzIiwic3JjL3dpbmRvdy1pbnRlcmZhY2UuanMiLCJ0aGlyZF9wYXJ0eS9jc3MtZXNjYXBlL2Nzcy1lc2NhcGUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7O1FDb0RnQixjLEdBQUEsYzs7QUFwQ2hCOztBQUdBOztBQUlBOztBQUlBOztBQUNBOztBQUtBOzs7Ozs7Ozs7Ozs7O0FBYUEsSUFBSSxvQkFBSjs7QUFFQTs7OztBQWhEQTs7Ozs7Ozs7Ozs7Ozs7OztBQW9ETyxTQUFTLGNBQVQsR0FBMEI7QUFDL0IsTUFBSSxDQUFDLFdBQUwsRUFBa0I7QUFDaEIsa0JBQWMsaUJBQUk7QUFDaEIsc0RBRGdCO0FBRWhCLGdCQUFVO0FBQUEsZUFBTSxJQUFOO0FBQUEsT0FGTTtBQUdoQixxQkFBZTtBQUFBLGVBQU0sSUFBTjtBQUFBLE9BSEM7QUFJaEIsK0RBSmdCO0FBS2hCLCtEQUxnQjtBQU1oQixtREFOZ0I7QUFPaEIsY0FBUTtBQUFBLGVBQU0sSUFBTjtBQUFBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpnQixLQUFKLENBQWQ7QUFjRDs7QUFFRCxTQUFPLFdBQVA7QUFDRDs7QUFFRDs7OztBQUlPLElBQU0sZ0RBQW9CO0FBQy9CLFlBQVUseURBRHFCO0FBRS9CLGdCQUFjLDZEQUZpQjtBQUcvQixnQkFBYyx5REFIaUI7QUFJL0Isb0JBQWtCO0FBSmEsQ0FBMUI7Ozs7OztBQzdFUDs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQTs7Ozs7Ozs7Ozs7O0FBWUEsSUFBSSwyQkFBSjs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFtQ08sSUFBTSw4QkFBVztBQUN0QixZQUFVO0FBQ1IsNEJBQXdCLElBRGhCO0FBRVIs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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbjZDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QUN0QixhQUFPLElBQUksUUFBSixDQUFhLFFBQXBCO0FBQ0Q7Ozs7Ozs7Ozs7UUNRYSxTLEdBQUEsUztBQS9DaEI7O0FBR0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBLElBQUksUUFBUSx3RUFBWjs7QUFFQSxTQUFTLE9BQVQsQ0FBaUIsS0FBakIsRUFBd0IsR0FBeEIsRUFBNkIsSUFBN0IsRUFBbUMsU0FBbkMsRUFBOEMsS0FBOUMsRUFBcUQ7QUFDbkQ7QUFDQSxNQUFJLEtBQUosRUFBVztBQUNULFdBQU8sS0FBUDtBQUNEO0FBQ0Q7QUFDQSxNQUFJLEdBQUosRUFBUztBQUNQLFdBQU8sUUFBUDtBQUNEO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsTUFBSSxTQUFKLEVBQWU7QUFDYixXQUFPLE1BQU0sS0FBTixDQUFZLENBQVosRUFBZSxDQUFDLENBQWhCLElBQXFCLElBQXJCLEdBQTRCLE1BQU0sS0FBTixDQUFZLENBQUMsQ0FBYixFQUFnQixVQUFoQixDQUEyQixDQUEzQixFQUE4QixRQUE5QixDQUF1QyxFQUF2QyxDQUE1QixHQUF5RSxHQUFoRjtBQUNEO0FBQ0Q7QUFDQTtBQUNBLFNBQU8sT0FBTyxLQUFkO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxTQUFULENBQW1CLEtBQW5CLEVBQTBCO0FBQy9CLFNBQU8sT0FBTyxLQUFQLEVBQWMsT0FBZCxDQUFzQixLQUF0QixFQUE2QixPQUE3QixDQUFQO0FBQ0QiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIGFkc2Vuc2VJc0E0QUVuYWJsZWQsXG59IGZyb20gJy4uL2V4dGVuc2lvbnMvYW1wLWFkLW5ldHdvcmstYWRzZW5zZS1pbXBsLzAuMS9hZHNlbnNlLWE0YS1jb25maWcnO1xuaW1wb3J0IHtcbiAgY2xvdWRmbGFyZUlzQTRBRW5hYmxlZCxcbn0gZnJvbVxuICAnLi4vZXh0ZW5zaW9ucy9hbXAtYWQtbmV0d29yay1jbG91ZGZsYXJlLWltcGwvMC4xL2Nsb3VkZmxhcmUtYTRhLWNvbmZpZyc7XG5pbXBvcnQge1xuICBnbW9zc3BJc0E0QUVuYWJsZWQsXG59IGZyb21cbiAgJy4uL2V4dGVuc2lvbnMvYW1wLWFkLW5ldHdvcmstZ21vc3NwLWltcGwvMC4xL2dtb3NzcC1hNGEtY29uZmlnJztcbmltcG9ydCB7bWFwfSBmcm9tICcuLi9zcmMvdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7XG4gIHRyaXBsZWxpZnRJc0E0QUVuYWJsZWQsXG59IGZyb21cbiAgJy4uL2V4dGVuc2lvbnMvYW1wLWFkLW5ldHdvcmstdHJpcGxlbGlmdC1pbXBsLzAuMS90cmlwbGVsaWZ0LWE0YS1jb25maWcnO1xuXG4vKipcbiAqIFJlZ2lzdHJ5IGZvciBBNEEgKEFNUCBBZHMgZm9yIEFNUEhUTUwgcGFnZXMpIFwiaXMgc3VwcG9ydGVkXCIgcHJlZGljYXRlcy5cbiAqIElmIGFuIGFkIG5ldHdvcmssIHtAY29kZSAke05FVFdPUkt9fSwgaXMgcmVnaXN0ZXJlZCBpbiB0aGlzIG9iamVjdCwgdGhlbiB0aGVcbiAqIHtAY29kZSA8YW1wLWFkIHR5cGU9XCIke05FVFdPUkt9XCI+fSBpbXBsZW1lbnRhdGlvbiB3aWxsIGxvb2sgdXAgaXRzIHByZWRpY2F0ZVxuICogaGVyZS4gSWYgdGhlcmUgaXMgYSBwcmVkaWNhdGUgYW5kIGl0IGFuZCByZXR1cm5zIHtAY29kZSB0cnVlfSwgdGhlblxuICoge0Bjb2RlIGFtcC1hZH0gd2lsbCBhdHRlbXB0IHRvIHJlbmRlciB0aGUgYWQgdmlhIHRoZSBBNEEgcGF0aHdheSAoZmV0Y2hcbiAqIGFkIGNyZWF0aXZlIHZpYSBlYXJseSBYSFIgQ09SUyByZXF1ZXN0OyB2ZXJpZnkgdGhhdCBpdCBpcyB2YWxpZGF0ZWQgQU1QO1xuICogYW5kIHRoZW4gcmVuZGVyIGRpcmVjdGx5IGluIHRoZSBob3N0IHBhZ2UgYnkgc3BsaWNpbmcgaW50byB0aGUgaG9zdCBET00pLlxuICogT3RoZXJ3aXNlLCBpdCB3aWxsIGF0dGVtcHQgdG8gcmVuZGVyIHRoZSBhZCB2aWEgdGhlIGV4aXN0aW5nIFwiM3AgaWZyYW1lXCJcbiAqIHBhdGh3YXkgKGRlbGF5IGxvYWQgaW50byBhIGNyb3NzLWRvbWFpbiBpZnJhbWUpLlxuICpcbiAqIEB0eXBlIHshT2JqZWN0PHN0cmluZywgZnVuY3Rpb24oIVdpbmRvdywgIUVsZW1lbnQpOiBib29sZWFuPn1cbiAqL1xubGV0IGE0YVJlZ2lzdHJ5O1xuXG4vKipcbiAqIFJldHVybnMgdGhlIGE0YSByZWdpc3RyeSBtYXBcbiAqIEByZXR1cm4ge09iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEE0QVJlZ2lzdHJ5KCkge1xuICBpZiAoIWE0YVJlZ2lzdHJ5KSB7XG4gICAgYTRhUmVnaXN0cnkgPSBtYXAoe1xuICAgICAgJ2Fkc2Vuc2UnOiBhZHNlbnNlSXNBNEFFbmFibGVkLFxuICAgICAgJ2FkemVyayc6ICgpID0+IHRydWUsXG4gICAgICAnZG91YmxlY2xpY2snOiAoKSA9PiB0cnVlLFxuICAgICAgJ3RyaXBsZWxpZnQnOiB0cmlwbGVsaWZ0SXNBNEFFbmFibGVkLFxuICAgICAgJ2Nsb3VkZmxhcmUnOiBjbG91ZGZsYXJlSXNBNEFFbmFibGVkLFxuICAgICAgJ2dtb3NzcCc6IGdtb3NzcElzQTRBRW5hYmxlZCxcbiAgICAgICdmYWtlJzogKCkgPT4gdHJ1ZSxcbiAgICAgIC8vIFRPRE86IEFkZCBuZXcgYWQgbmV0d29yayBpbXBsZW1lbnRhdGlvbiBcImlzIGVuYWJsZWRcIiBmdW5jdGlvbnMgaGVyZS5cbiAgICAgIC8vIE5vdGU6IGlmIHlvdSBhZGQgYSBmdW5jdGlvbiBoZXJlIHRoYXQgcmVxdWlyZXMgYSBuZXcgXCJpbXBvcnRcIiwgYWJvdmUsXG4gICAgICAvLyB5b3UnbGwgcHJvYmFibHkgYWxzbyBuZWVkIHRvIGFkZCBhIHdoaXRlbGlzdCBleGNlcHRpb24gdG9cbiAgICAgIC8vIGJ1aWxkLXN5c3RlbS9kZXAtY2hlY2stY29uZmlnLmpzIGluIHRoZSBcImZpbGVzTWF0Y2hpbmc6ICdhZHMvKiovKi5qcydcbiAgICAgIC8vIHJ1bGUuXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gYTRhUmVnaXN0cnk7XG59XG5cbi8qKlxuICogQW4gb2JqZWN0IG1hcHBpbmcgc2lnbmluZyBzZXJ2ZXIgbmFtZXMgdG8gdGhlaXIgY29ycmVzcG9uZGluZyBVUkxzLlxuICogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fVxuICovXG5leHBvcnQgY29uc3Qgc2lnbmluZ1NlcnZlclVSTHMgPSB7XG4gICdnb29nbGUnOiAnaHR0cHM6Ly9jZG4uYW1wcHJvamVjdC5vcmcvYW1wLWFkLXZlcmlmeWluZy1rZXlzZXQuanNvbicsXG4gICdnb29nbGUtZGV2JzogJ2h0dHBzOi8vY2RuLmFtcHByb2plY3Qub3JnL2FtcC1hZC12ZXJpZnlpbmcta2V5c2V0LWRldi5qc29uJyxcbiAgJ2Nsb3VkZmxhcmUnOiAnaHR0cHM6Ly9hbXAuY2xvdWRmbGFyZS5jb20vYW1wLWFkLXZlcmlmeWluZy1rZXlzZXQuanNvbicsXG4gICdjbG91ZGZsYXJlLWRldic6ICdodHRwczovL2FtcC5jbG91ZGZsYXJlLmNvbS9hbXAtYWQtdmVyaWZ5aW5nLWtleXNldC1kZXYuanNvbicsXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgcHJlZmV0Y2g6IChzdHJpbmd8dW5kZWZpbmVkKSxcbiAqICAgcHJlY29ubmVjdDogKHN0cmluZ3x1bmRlZmluZWQpLFxuICogICByZW5kZXJTdGFydEltcGxlbWVudGVkOiAoYm9vbGVhbnx1bmRlZmluZWQpLFxuICogICBjbGllbnRJZFNjb3BlOiAoc3RyaW5nfHVuZGVmaW5lZCksXG4gKiAgIGNsaWVudElkQ29va2llTmFtZTogKHN0cmluZ3x1bmRlZmluZWQpLFxuICogICBjb25zZW50SGFuZGxpbmdPdmVycmlkZTogKGJvb2xlYW58dW5kZWZpbmVkKSxcbiAqICAgcmVtb3RlSFRNTERpc2FibGVkOiAoYm9vbGVhbnx1bmRlZmluZWQpLFxuICogICBmdWxsV2lkdGhIZWlnaHRSYXRpbzogKG51bWJlcnx1bmRlZmluZWQpLFxuICogfX1cbiAqL1xubGV0IEFkTmV0d29ya0NvbmZpZ0RlZjtcblxuLyoqXG4gKiBUaGUgY29uZmlnIG9mIGVhY2ggYWQgbmV0d29yay5cbiAqIFBsZWFzZSBrZWVwIHRoZSBsaXN0IGFscGhhYmV0aWMgb3JkZXIuXG4gKlxuICogeW91ck5ldHdvcmtOYW1lOiB7ICAvLyBUaGlzIGlzIHRoZSBcInR5cGVcIiBhdHRyaWJ1dGUgb2YgPGFtcC1hZD5cbiAqXG4gKiAgIC8vIExpc3Qgb2YgVVJMcyBmb3IgcHJlZmV0Y2hcbiAqICAgcHJlZmV0Y2g6IHN0cmluZ3xhcnJheVxuICpcbiAqICAgLy8gTGlzdCBvZiBob3N0cyBmb3IgcHJlY29ubmVjdFxuICogICBwcmVjb25uZWN0OiBzdHJpbmd8YXJyYXlcbiAqXG4gKiAgIC8vIFRoZSBzY29wZSB1c2VkIHRvIHByb3ZpZGUgQ0lEcyB0byBhZHNcbiAqICAgY2xpZW50SWRTY29wZTogc3RyaW5nXG4gKlxuICogICAvLyBUaGUgY29va2llIG5hbWUgdG8gc3RvcmUgdGhlIENJRC4gSW4gYWJzZW5jZSwgYGNsaWVudElkU2NvcGVgIGlzIHVzZWQuXG4gKiAgIGNsaWVudElkQ29va2llTmFtZTogc3RyaW5nXG4gKlxuICogICAvLyBJZiB0aGUgYWQgbmV0d29yayBpcyB3aWxsaW5nIHRvIG92ZXJyaWRlIHRoZSBjb25zZW50IGhhbmRsaW5nLCB3aGljaFxuICogICAvLyBieSBkZWZhdWx0IGlzIGJsb2NraW5nIGFkIGxvYWQgdW50aWwgdGhlIGNvbnNlbnQgaXMgYWNjZXB0ZWQuXG4gKiAgIGNvbnNlbnRIYW5kbGluZ092ZXJyaWRlOiBib29sZWFuXG4gKlxuICogICAvLyBXaGV0aGVyIHJlbmRlci1zdGFydCBBUEkgaGFzIGJlZW4gaW1wbGVtZW50ZWRcbiAqICAgLy8gV2UgaGlnaGx5IHJlY29tbWVuZCBhbGwgbmV0d29ya3MgdG8gaW1wbGVtZW50IHRoZSBBUEksXG4gKiAgIC8vIHNlZSBkZXRhaWxzIGluIHRoZSBSRUFETUUubWRcbiAqICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogYm9vbGVhblxuICpcbiAqICAgLy8gVGhlIHdpZHRoIC8gaGVpZ2h0IHJhdGlvIGZvciBmdWxsIHdpZHRoIGFkIHVuaXRzLlxuICogICAvLyBJZiBhYnNlbnQsIGl0IG1lYW5zIHRoZSBuZXR3b3JrIGRvZXMgbm90IHN1cHBvcnQgZnVsbCB3aWR0aCBhZCB1bml0cy5cbiAqICAgLy8gRXhhbXBsZSB2YWx1ZTogMS4yXG4gKiAgIGZ1bGxXaWR0aEhlaWdodFJhdGlvOiBudW1iZXJcbiAqIH1cbiAqXG4gKiBAY29uc3QgeyFPYmplY3Q8c3RyaW5nLCAhQWROZXR3b3JrQ29uZmlnRGVmPn19XG4gKi9cbmV4cG9ydCBjb25zdCBhZENvbmZpZyA9IHtcbiAgJ19waW5nXyc6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICAgIGNsaWVudElkU2NvcGU6ICdfUElOR18nLFxuICAgIGNvbnNlbnRIYW5kbGluZ092ZXJyaWRlOiB0cnVlLFxuICB9LFxuXG4gICcyNHNtaSc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vanNuLjI0c21pLm5ldC9zbWkuanMnLFxuICAgIHByZWNvbm5lY3Q6ICdodHRwczovL2RhdGEuMjRzbWkubmV0JyxcbiAgfSxcblxuICAnYTgnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL3N0YXRpY3MuYTgubmV0L2FtcC9hZC5qcycsXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnYTknOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2MuYW1hem9uLWFkc3lzdGVtLmNvbS9hYXgyL2Fzc29jLmpzJyxcbiAgfSxcblxuICAnYWNjZXNzdHJhZGUnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2guYWNjZXNzdHJhZGUubmV0L2pzL2FtcC9hbXAuanMnLFxuICB9LFxuXG4gICdhZGFnaW8nOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2pzLXNzbC5uZW9kYXRhZ3JvdXAuY29tL2FkYWdpb19hbXAuanMnLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL2FkLWF3cy1pdC5uZW9kYXRhZ3JvdXAuY29tJyxcbiAgICAgICdodHRwczovL3RyYWNrZXIubmVvZGF0YWdyb3VwLmNvbScsXG4gICAgXSxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdhZGJsYWRlJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly93ZWIuYWRibGFkZS5jb20vanMvYWRzL2FzeW5jL3Nob3cuanMnLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL3N0YXRpY2QuY2RuLmFkYmxhZGUuY29tJyxcbiAgICAgICdodHRwczovL3N0YXRpYy5hZGJsYWRlLmNvbScsXG4gICAgXSxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdhZGJ1dGxlcic6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vc2VydmVkYnlhZGJ1dGxlci5jb20vYXBwLmpzJyxcbiAgfSxcblxuICAnYWRmb3JtJzoge30sXG5cbiAgJ2FkZm94Jzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly95YXN0YXRpYy5uZXQvcGNvZGUvYWRmb3gvbG9hZGVyLmpzJyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdhZGdlbmVyYXRpb24nOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2kuc29jZG0uY29tL3Nkay9qcy9hZGctc2NyaXB0LWxvYWRlci5qcycsXG4gIH0sXG5cbiAgJ2FkaGVzZSc6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdhZGluY3ViZSc6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdhZGl0aW9uJzoge30sXG5cbiAgJ2FkbWFuJzoge30sXG5cbiAgJ2FkbWFubWVkaWEnOiB7XG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnYWRtaXhlcic6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL2ludi1uZXRzLmFkbWl4ZXIubmV0JyxcbiAgICAgICdodHRwczovL2Nkbi5hZG1peGVyLm5ldCcsXG4gICAgXSxcbiAgfSxcblxuICAnYWRvY2Vhbic6IHt9LFxuXG4gICdhZHBpY2tlcic6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdhZHBsdWdnJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly93d3cuYWRwbHVnZy5jb20vc2VydmUvanMvYWQuanMnLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ2FkcmVhY3Rvcic6IHt9LFxuXG4gICdhZHNlbnNlJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9wYWdlYWQyLmdvb2dsZXN5bmRpY2F0aW9uLmNvbS9wYWdlYWQvanMvYWRzYnlnb29nbGUuanMnLFxuICAgIHByZWNvbm5lY3Q6ICdodHRwczovL2dvb2dsZWFkcy5nLmRvdWJsZWNsaWNrLm5ldCcsXG4gICAgY2xpZW50SWRTY29wZTogJ0FNUF9FQ0lEX0dPT0dMRScsXG4gICAgY2xpZW50SWRDb29raWVOYW1lOiAnX2dhJyxcbiAgICByZW1vdGVIVE1MRGlzYWJsZWQ6IHRydWUsXG4gICAgbWFzdGVyRnJhbWVBY2Nlc3NpYmxlVHlwZTogJ2dvb2dsZV9uZXR3b3JrJyxcbiAgICBmdWxsV2lkdGhIZWlnaHRSYXRpbzogMS4yLFxuICAgIGNvbnNlbnRIYW5kbGluZ092ZXJyaWRlOiB0cnVlLFxuICB9LFxuXG4gICdhZHNuYXRpdmUnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL3N0YXRpYy5hZHNuYXRpdmUuY29tL3N0YXRpYy9qcy9yZW5kZXIudjEuanMnLFxuICAgIHByZWNvbm5lY3Q6ICdodHRwczovL2FwaS5hZHNuYXRpdmUuY29tJyxcbiAgfSxcblxuICAnYWRzcGVlZCc6IHtcbiAgICBwcmVjb25uZWN0OiAnaHR0cHM6Ly9nLmFkc3BlZWQubmV0JyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdhZHNwaXJpdCc6IHt9LFxuXG4gICdhZHN0aXInOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2pzLmFkLXN0aXIuY29tL2pzL2Fkc3Rpcl9hc3luYy5qcycsXG4gICAgcHJlY29ubmVjdDogJ2h0dHBzOi8vYWQuYWQtc3Rpci5jb20nLFxuICB9LFxuXG4gICdhZHRlY2gnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL3MuYW9sY2RuLmNvbS9vcy9hZHMvYWRzV3JhcHBlcjMuanMnLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL21hZHMuYXQuYXR3b2xhLmNvbScsXG4gICAgICAnaHR0cHM6Ly9ha2EtY2RuLmFkdGVjaHVzLmNvbScsXG4gICAgXSxcbiAgfSxcblxuICAnYWR0aHJpdmUnOiB7XG4gICAgcHJlZmV0Y2g6IFtcbiAgICAgICdodHRwczovL3d3dy5nb29nbGV0YWdzZXJ2aWNlcy5jb20vdGFnL2pzL2dwdC5qcycsXG4gICAgXSxcbiAgICBwcmVjb25uZWN0OiBbXG4gICAgICAnaHR0cHM6Ly9wYXJ0bmVyLmdvb2dsZWFkc2VydmljZXMuY29tJyxcbiAgICAgICdodHRwczovL3NlY3VyZXB1YmFkcy5nLmRvdWJsZWNsaWNrLm5ldCcsXG4gICAgICAnaHR0cHM6Ly90cGMuZ29vZ2xlc3luZGljYXRpb24uY29tJyxcbiAgICBdLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ2FkdW5pdHknOiB7XG4gICAgcHJlY29ubmVjdDogW1xuICAgICAgJ2h0dHBzOi8vY29udGVudC5hZHVuaXR5LmNvbScsXG4gICAgXSxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdhZHVwdGVjaCc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vcy5kLmFkdXAtdGVjaC5jb20vanNhcGknLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL2QuYWR1cC10ZWNoLmNvbScsXG4gICAgICAnaHR0cHM6Ly9tLmFkdXAtdGVjaC5jb20nLFxuICAgIF0sXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnYWR2ZW50aXZlJzoge1xuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL2Fkcy5hZHZlbnRpdmUuY29tJyxcbiAgICAgICdodHRwczovL2FtcC5hZHZlbnRpdmVkZXYuY29tJyxcbiAgICBdLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ2FkdmVybGluZSc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vYWRzLmFkdmVybGluZS5jb20vcmljaG1lZGlhcy9hbXAuanMnLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL2FkbmV4dC5mcicsXG4gICAgXSxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdhZHZlcnRpY3VtJzoge30sXG5cbiAgJ2FkdmVydHNlcnZlJzoge1xuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ2FkemVyayc6IHt9LFxuXG4gICdhZmZpbGlhdGViJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly90cmFjay5hZmZpbGlhdGUtYi5jb20vYW1wL2EuanMnLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ2FqYSc6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9jZG4uYXMuYW1hbmFkLmFkdGRwLmNvbS9zZGsvYXNvdC12Mi5qcycsXG4gIH0sXG5cbiAgJ2FwcHZhZG9yJzoge1xuICAgIHByZWZldGNoOiBbXG4gICAgICAnaHR0cHM6Ly9jZG4uYXB2ZHIuY29tL2pzL1Zhc3RBZFVuaXQubWluLmpzJyxcbiAgICAgICdodHRwczovL2Nkbi5hcHZkci5jb20vanMvVmlkZW9BZC5taW4uanMnLFxuICAgICAgJ2h0dHBzOi8vY2RuLmFwdmRyLmNvbS9qcy9WaWRlb0FkM1BBUy5taW4uanMnLFxuICAgICAgJ2h0dHBzOi8vY2RuLmFwdmRyLmNvbS9qcy9WaWRlb0FkQXV0b1BsYXkubWluLmpzJyxcbiAgICAgICdodHRwczovL2Nkbi5hcHZkci5jb20vanMvVmlkZW9BZE5hdGl2ZS5taW4uanMnLFxuICAgIF0sXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnYW1vYWQnOiB7XG4gICAgcHJlZmV0Y2g6IFtcbiAgICAgICdodHRwczovL2ouYW1vYWQuY29tL2pzL2EuanMnLFxuICAgICAgJ2h0dHBzOi8vai5hbW9hZC5jb20vanMvbi5qcycsXG4gICAgXSxcbiAgICBwcmVjb25uZWN0OiBbXG4gICAgICAnaHR0cHM6Ly9kLmFtb2FkLmNvbScsXG4gICAgICAnaHR0cHM6Ly9pLmFtb2FkLmNvbScsXG4gICAgICAnaHR0cHM6Ly9tLmFtb2FkLmNvbScsXG4gICAgICAnaHR0cHM6Ly92LmFtb2FkLmNvbScsXG4gICAgXSxcbiAgfSxcblxuICAnYXBwbmV4dXMnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2FjZG4uYWRueHMuY29tL2FzdC9hc3QuanMnLFxuICAgIHByZWNvbm5lY3Q6ICdodHRwczovL2liLmFkbnhzLmNvbScsXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnYXRvbXgnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL3MuYXRvLm14L3AuanMnLFxuICB9LFxuXG4gICdiZW9waW5pb24nOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL3dpZGdldC5iZW9waW5pb24uY29tL3Nkay5qcycsXG4gICAgcHJlY29ubmVjdDogW1xuICAgICAgJ2h0dHBzOi8vdC5iZW9waW5pb24uY29tJyxcbiAgICAgICdodHRwczovL3MuYmVvcGluaW9uLmNvbScsXG4gICAgICAnaHR0cHM6Ly9kYXRhLmJlb3Bpbmlvbi5jb20nLFxuICAgIF0sXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnYmlkdGVsbGVjdCc6IHt9LFxuXG4gICdicmFpbnknOiB7fSxcblxuICAnYnJpbmdodWInOiB7XG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgICBwcmVjb25uZWN0OiBbXG4gICAgICAnaHR0cHM6Ly9zdGF0aWMuYmgtY2RuLmNvbScsXG4gICAgICAnaHR0cHM6Ly9jb3JlLWFwaS5icmluZ2h1Yi5pbycsXG4gICAgXSxcbiAgfSxcblxuICAnYnJvYWRzdHJlZXRhZHMnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2Nkbi5icm9hZHN0cmVldGFkcy5jb20vaW5pdC0yLm1pbi5qcycsXG4gIH0sXG5cbiAgJ2NhYWphaW5mZWVkJzoge1xuICAgIHByZWZldGNoOiBbXG4gICAgICAnaHR0cHM6Ly9jZG4uYW1hbmFkLmFkdGRwLmNvbS9zZGsvYWphYW1wLmpzJyxcbiAgICBdLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL2FkLmFtYW5hZC5hZHRkcC5jb20nLFxuICAgIF0sXG4gIH0sXG5cbiAgJ2NhcGlycyc6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdjYXByb2ZpdHgnOiB7XG4gICAgcHJlZmV0Y2g6IFtcbiAgICAgICdodHRwczovL2Nkbi5jYXByb2ZpdHguY29tL3BmeC5taW4uanMnLFxuICAgICAgJ2h0dHBzOi8vY2RuLmNhcHJvZml0eC5jb20vdGFncy9hbXAvcHJvZml0eF9hbXAuanMnLFxuICAgIF0sXG4gICAgcHJlY29ubmVjdDogJ2h0dHBzOi8vYWQuY2Fwcm9maXR4LmFkdGRwLmNvbScsXG4gIH0sXG5cbiAgJ2NlZGF0byc6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdjaGFyZ2VhZHMnOiB7fSxcblxuICAnY29sb21iaWEnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL3N0YXRpYy5jbG1idGVjaC5jb20vYWQvY29tbW9ucy9qcy9jb2xvbWJpYS1hbXAuanMnLFxuICB9LFxuXG4gICdjb25uYXRpeCc6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdjb250ZW50YWQnOiB7fSxcblxuXG4gICdjcml0ZW8nOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL3N0YXRpYy5jcml0ZW8ubmV0L2pzL2xkL3B1Ymxpc2hlcnRhZy5qcycsXG4gICAgcHJlY29ubmVjdDogJ2h0dHBzOi8vY2FzLmNyaXRlby5jb20nLFxuICB9LFxuXG4gICdjc2EnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL3d3dy5nb29nbGUuY29tL2Fkc2Vuc2Uvc2VhcmNoL2Fkcy5qcycsXG4gIH0sXG5cbiAgJ2RhYmxlJzoge1xuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL3N0YXRpYy5kYWJsZS5pbycsXG4gICAgICAnaHR0cHM6Ly9hcGkuZGFibGUuaW8nLFxuICAgICAgJ2h0dHBzOi8vaW1hZ2VzLmRhYmxlLmlvJyxcbiAgICBdLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ2RpcmVjdGFkdmVydCc6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdkaXN0cm9zY2FsZSc6IHtcbiAgICBwcmVjb25uZWN0OiBbXG4gICAgICAnaHR0cHM6Ly9jLmpzcmRuLmNvbScsXG4gICAgICAnaHR0cHM6Ly9zLmpzcmRuLmNvbScsXG4gICAgICAnaHR0cHM6Ly9pLmpzcmRuLmNvbScsXG4gICAgXSxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdkb3RhbmRhZHMnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2FtcC5hZC5kb3RhbmRhZC5jb20vZG90YW5kYWRzQW1wLmpzJyxcbiAgICBwcmVjb25uZWN0OiAnaHR0cHM6Ly9iYWwuYWQuZG90YW5kYWQuY29tJyxcbiAgfSxcblxuICAnZWFkdic6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICAgIGNsaWVudElkU2NvcGU6ICdBTVBfRUNJRF9FQURWJyxcbiAgICBwcmVmZXRjaDogW1xuICAgICAgJ2h0dHBzOi8vd3d3LmVhZHYuaXQvdHJhY2svZXNyLm1pbi5qcycsXG4gICAgICAnaHR0cHM6Ly93d3cuZWFkdi5pdC90cmFjay9lYWQubWluLmpzJyxcbiAgICBdLFxuICB9LFxuXG4gICdlYXMnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2FtcC5lbWVkaWF0ZS5ldS9hbXAudjAuanMnLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ2VuZ2FnZXlhJzoge30sXG5cbiAgJ2VwZWV4Jzoge30sXG5cbiAgJ2VwbGFubmluZyc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vdXMuaW1nLmUtcGxhbm5pbmcubmV0L2xheWVycy9lcGwtYW1wLmpzJyxcbiAgfSxcblxuICAnZXpvaWMnOiB7XG4gICAgcHJlZmV0Y2g6IFtcbiAgICAgICdodHRwczovL3d3dy5nb29nbGV0YWdzZXJ2aWNlcy5jb20vdGFnL2pzL2dwdC5qcycsXG4gICAgICAnaHR0cHM6Ly9nLmV6b2ljLm5ldC9lem9pYy9hbXBhZC5qcycsXG4gICAgXSxcbiAgICBjbGllbnRJZFNjb3BlOiAnQU1QX0VDSURfRVpPSUMnLFxuICAgIGNvbnNlbnRIYW5kbGluZ092ZXJyaWRlOiB0cnVlLFxuICB9LFxuXG4gICdmMWUnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2ltZy5hay5pbXBhY3QtYWQuanAvdXRpbC9mMWVfYW1wLm1pbi5qcycsXG4gIH0sXG5cbiAgJ2YxaCc6IHtcbiAgICBwcmVjb25uZWN0OiAnaHR0cHM6Ly9pbWcuYWsuaW1wYWN0LWFkLmpwJyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdmYWtlJzoge30sXG5cbiAgJ2ZlbG1hdCc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vdC5mZWxtYXQubmV0L2pzL2ZtYW1wLmpzJyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdmbGl0ZSc6IHt9LFxuXG4gICdmbHVjdCc6IHtcbiAgICBwcmVjb25uZWN0OiBbXG4gICAgICAnaHR0cHM6Ly9jZG4tZmx1Y3Quc2guYWRpbmdvLmpwJyxcbiAgICAgICdodHRwczovL3Muc2guYWRpbmdvLmpwJyxcbiAgICAgICdodHRwczovL2kuYWRpbmdvLmpwJyxcbiAgICBdLFxuICB9LFxuXG4gICdmdXNpb24nOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2Fzc2V0cy5hZHRvbWFmdXNpb24ubmV0L2Z1c2lvbi9sYXRlc3QvZnVzaW9uLWFtcC5taW4uanMnLFxuICB9LFxuXG4gICdnZW5pZWVzc3AnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2pzLmdzc3BjbG4uanAvbC9hbXAuanMnLFxuICB9LFxuXG4gICdnaXJhZmYnOiB7XG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnZ21vc3NwJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9jZG4uZ21vc3NwLXNwLmpwL2Fkcy9hbXAuanMnLFxuICB9LFxuXG4gICdndW1ndW0nOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2cyLmd1bWd1bS5jb20vamF2YXNjcmlwdHMvYWQuanMnLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ2hvbGRlcic6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vaS5ob2xkZXIuY29tLnVhL2pzMi9ob2xkZXIvYWpheC9hbXB2MS5qcycsXG4gICAgcHJlY29ubmVjdDogJ2h0dHBzOi8vaC5ob2xkZXIuY29tLnVhJyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdpYmlsbGJvYXJkJzoge30sXG5cbiAgJ2ltZWRpYSc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vaS5pbWVkaWEuY3ovanMvaW0zLmpzJyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdpbW9iaWxlJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9zcGFtcC5pLW1vYmlsZS5jby5qcC9zY3JpcHQvYW1wLmpzJyxcbiAgICBwcmVjb25uZWN0OiAnaHR0cHM6Ly9zcGFkLmktbW9iaWxlLmNvLmpwJyxcbiAgfSxcbiAgJ2ltb25vbXknOiB7XG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcbiAgJ2ltcHJvdmVkaWdpdGFsJzoge30sXG5cbiAgJ2luZHVzdHJ5YnJhaW5zJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly93ZWIuaW5kdXN0cnlicmFpbnMuY29tL2pzL2Fkcy9hc3luYy9zaG93LmpzJyxcbiAgICBwcmVjb25uZWN0OiBbXG4gICAgICAnaHR0cHM6Ly9zdGF0aWNkLmNkbi5pbmR1c3RyeWJyYWlucy5jb20nLFxuICAgICAgJ2h0dHBzOi8vc3RhdGljLmluZHVzdHJ5YnJhaW5zLmNvbScsXG4gICAgXSxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdpbm1vYmknOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2NmLmNkbi5pbm1vYmkuY29tL2FkL2lubW9iaS5zZWN1cmUuanMnLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ2lubml0eSc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vY2RuLmlubml0eS5uZXQvYWRtYW5hZ2VyLmpzJyxcbiAgICBwcmVjb25uZWN0OiAnaHR0cHM6Ly9hcy5pbm5pdHkuY29tJyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdpeCc6IHtcbiAgICBwcmVmZXRjaDogW1xuICAgICAgJ2h0dHBzOi8vanMtc2VjLmluZGV4d3cuY29tL2FwbC9hbXAuanMnLFxuICAgIF0sXG4gICAgcHJlY29ubmVjdDogJ2h0dHBzOi8vYXMtc2VjLmNhc2FsZW1lZGlhLmNvbScsXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAna2FyZ28nOiB7fSxcblxuICAna2lvc2tlZCc6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdraXhlcic6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vY2RuLmtpeGVyLmNvbS9hZC9sb2FkLmpzJyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdrdWFkaW8nOiB7fSxcblxuICAnbGlnYXR1cyc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vc3NsLmxpZ2F0dXMuY29tL3JlbmRlci9saWdyZW5kLmpzJyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdsb2NrZXJkb21lJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9jZG4yLmxvY2tlcmRvbWVjZG4uY29tL19qcy9hbXAuanMnLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ2xva2EnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2xva2EtY2RuLmFrYW1haXplZC5uZXQvc2NlbmUvYW1wLmpzJyxcbiAgICBwcmVjb25uZWN0OiBbXG4gICAgICAnaHR0cHM6Ly9zY2VuZS1mcm9udC5sb2thcGxhdGZvcm0uY29tJyxcbiAgICAgICdodHRwczovL2xva2EtbWF0ZXJpYWxzLmFrYW1haXplZC5uZXQnLFxuICAgIF0sXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnbWFkcyc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vZXUyLm1hZHNvbmUuY29tL2pzL3RhZ3MuanMnLFxuICB9LFxuXG4gICdtYW50aXMtZGlzcGxheSc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vYXNzZXRzLm1hbnRpc2FkbmV0d29yay5jb20vbWFudG9kZWEubWluLmpzJyxcbiAgICBwcmVjb25uZWN0OiBbXG4gICAgICAnaHR0cHM6Ly9tYW50b2RlYS5tYW50aXNhZG5ldHdvcmsuY29tJyxcbiAgICAgICdodHRwczovL3Jlcy5jbG91ZGluYXJ5LmNvbScsXG4gICAgICAnaHR0cHM6Ly9yZXNpemUubWFudGlzYWRuZXR3b3JrLmNvbScsXG4gICAgXSxcbiAgfSxcblxuICAnbWFudGlzLXJlY29tbWVuZCc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vYXNzZXRzLm1hbnRpc2FkbmV0d29yay5jb20vcmVjb21tZW5kLm1pbi5qcycsXG4gICAgcHJlY29ubmVjdDogW1xuICAgICAgJ2h0dHBzOi8vbWFudG9kZWEubWFudGlzYWRuZXR3b3JrLmNvbScsXG4gICAgICAnaHR0cHM6Ly9yZXNpemUubWFudGlzYWRuZXR3b3JrLmNvbScsXG4gICAgXSxcbiAgfSxcblxuICAnbWVkaWFpbXBhY3QnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2VjLW5zLnNhc2Nkbi5jb20vZGlmZi8yNTEvcGFnZXMvYW1wX2RlZmF1bHQuanMnLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL3d3MjUxLnNtYXJ0YWRzZXJ2ZXIuY29tJyxcbiAgICAgICdodHRwczovL3N0YXRpYy5zYXNjZG4uY29tLycsXG4gICAgXSxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdtZWRpYW5ldCc6IHtcbiAgICBwcmVjb25uZWN0OiAnaHR0cHM6Ly9jb250ZXh0dWFsLm1lZGlhLm5ldCcsXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnbWVkaWF2aW5lJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9hbXAubWVkaWF2aW5lLmNvbS93cmFwcGVyLm1pbi5qcycsXG4gICAgcHJlY29ubmVjdDogW1xuICAgICAgJ2h0dHBzOi8vcGFydG5lci5nb29nbGVhZHNlcnZpY2VzLmNvbScsXG4gICAgICAnaHR0cHM6Ly9zZWN1cmVwdWJhZHMuZy5kb3VibGVjbGljay5uZXQnLFxuICAgICAgJ2h0dHBzOi8vdHBjLmdvb2dsZXN5bmRpY2F0aW9uLmNvbScsXG4gICAgXSxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICAgIGNvbnNlbnRIYW5kbGluZ092ZXJyaWRlOiB0cnVlLFxuICB9LFxuXG4gICdtZWR5YW5ldCc6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdtZWcnOiB7XG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnbWljcm9hZCc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vai5taWNyb2FkLm5ldC9qcy9jYW1wLmpzJyxcbiAgICBwcmVjb25uZWN0OiBbXG4gICAgICAnaHR0cHM6Ly9zLXJ0Yi5zZW5kLm1pY3JvYWQuanAnLFxuICAgICAgJ2h0dHBzOi8vcy1ydGIuc2VuZC5taWNyb2FkaW5jLmNvbScsXG4gICAgICAnaHR0cHM6Ly9jYWNoZS5zZW5kLm1pY3JvYWQuanAnLFxuICAgICAgJ2h0dHBzOi8vY2FjaGUuc2VuZC5taWNyb2FkaW5jLmNvbScsXG4gICAgICAnaHR0cHM6Ly9kZWIuc2VuZC5taWNyb2FkLmpwJyxcbiAgICBdLFxuICB9LFxuXG4gICdtaXhpbWVkaWEnOiB7XG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnbWl4cG8nOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2Nkbi5taXhwby5jb20vanMvbG9hZGVyLmpzJyxcbiAgICBwcmVjb25uZWN0OiBbXG4gICAgICAnaHR0cHM6Ly9wbGF5ZXIxLm1peHBvLmNvbScsXG4gICAgICAnaHR0cHM6Ly9wbGF5ZXIyLm1peHBvLmNvbScsXG4gICAgXSxcbiAgfSxcblxuICAnbW9uZXRpemVyMTAxJzoge1xuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ215dGFyZ2V0Jzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9hZC5tYWlsLnJ1L3N0YXRpYy9hZHMtYXN5bmMuanMnLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ215d2lkZ2V0Jzoge1xuICAgIHByZWNvbm5lY3Q6ICdodHRwczovL2xpa2Vtb3JlLWZlLmdvLm1haWwucnUnLFxuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9saWtlbW9yZS1nby5pbWdzbWFpbC5ydS93aWRnZXRfYW1wLmpzJyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICduYXRpdm8nOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL3MubnR2LmlvL3NlcnZlL2xvYWQuanMnLFxuICB9LFxuXG4gICduYXZlZ2cnOiB7XG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnbmVuZCc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vanMxLm5lbmQubmV0L2pzL2FtcC5qcycsXG4gICAgcHJlY29ubmVjdDogW1xuICAgICAgJ2h0dHBzOi8vb3V0cHV0Lm5lbmQubmV0JyxcbiAgICAgICdodHRwczovL2ltZzEubmVuZC5uZXQnLFxuICAgIF0sXG4gIH0sXG5cbiAgJ25ldGxldGl4Jzoge1xuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL2NhbGwubmV0emF0aGxldGVuLW1lZGlhLmRlJyxcbiAgICBdLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ25vZGR1cyc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vbm9kZHVzLmNvbS9hbXBfbG9hZGVyLmpzJyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdub2t0YSc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vc3RhdGljLnZpcmd1bC5jb20vdGhlbWUvbW9ja3Vwcy9ub2t0YWFtcC9hbXBqcy5qcycsXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnb3BlbmFkc3RyZWFtJzoge30sXG5cbiAgJ29wZW54Jzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly93d3cuZ29vZ2xldGFnc2VydmljZXMuY29tL3RhZy9qcy9ncHQuanMnLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL3BhcnRuZXIuZ29vZ2xlYWRzZXJ2aWNlcy5jb20nLFxuICAgICAgJ2h0dHBzOi8vc2VjdXJlcHViYWRzLmcuZG91YmxlY2xpY2submV0JyxcbiAgICAgICdodHRwczovL3RwYy5nb29nbGVzeW5kaWNhdGlvbi5jb20nLFxuICAgIF0sXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnb3V0YnJhaW4nOiB7XG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vd2lkZ2V0cy5vdXRicmFpbi5jb20vd2lkZ2V0QU1QL291dGJyYWluQU1QLm1pbi5qcycsXG4gICAgcHJlY29ubmVjdDogW1xuICAgICAgJ2h0dHBzOi8vb2RiLm91dGJyYWluLmNvbScsXG4gICAgXSxcbiAgICBjb25zZW50SGFuZGxpbmdPdmVycmlkZTogdHJ1ZSxcbiAgfSxcblxuICAncGl4ZWxzJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9jZG4uYWRzZmFjdG9yLm5ldC9hbXAvcGl4ZWxzLWFtcC5taW4uanMnLFxuICAgIGNsaWVudElkQ29va2llTmFtZTogJ19fQUYnLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3BsaXN0YSc6IHt9LFxuXG4gICdwb2x5bW9ycGhpY2Fkcyc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vd3d3LnBvbHltb3JwaGljYWRzLmpwL2pzL2FtcC5qcycsXG4gICAgcHJlY29ubmVjdDogW1xuICAgICAgJ2h0dHBzOi8vaW1nLnBvbHltb3JwaGljYWRzLmpwJyxcbiAgICAgICdodHRwczovL2FkLnBvbHltb3JwaGljYWRzLmpwJyxcbiAgICBdLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3BvcGluJzoge1xuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3Bvc3RxdWFyZSc6IHt9LFxuXG4gICdwdWJleGNoYW5nZSc6IHt9LFxuXG4gICdwdWJndXJ1Jzoge1xuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3B1Ym1hdGljJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9hZHMucHVibWF0aWMuY29tL0FkU2VydmVyL2pzL2FtcC5qcycsXG4gIH0sXG5cbiAgJ3B1Ym1pbmUnOiB7XG4gICAgcHJlZmV0Y2g6IFtcbiAgICAgICdodHRwczovL3MucHVibWluZS5jb20vaGVhZC5qcycsXG4gICAgICAnaHR0cHM6Ly9zLnB1Ym1pbmUuY29tL3Nob3dhZC5qcycsXG4gICAgXSxcbiAgICBwcmVjb25uZWN0OiAnaHR0cHM6Ly9kZWxpdmVyeS5nLnN3aXRjaGFkaHViLmNvbScsXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAncHVsc2Vwb2ludCc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vYWRzLmNvbnRleHR3ZWIuY29tL1RhZ1B1Ymxpc2gvZ2V0anMuc3RhdGljLmpzJyxcbiAgICBwcmVjb25uZWN0OiAnaHR0cHM6Ly90YWcuY29udGV4dHdlYi5jb20nLFxuICB9LFxuXG4gICdwdXJjaCc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vcmFtcC5wdXJjaC5jb20vc2VydmUvY3JlYXRpdmVfYW1wLmpzJyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdxdW9yYWFkJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9hLnF1b3JhLmNvbS9hbXBfYWQuanMnLFxuICAgIHByZWNvbm5lY3Q6ICdodHRwczovL2FtcGFkLnF1b3JhLmNvbScsXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAncmVhbGNsaWNrJzoge1xuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3JlbGFwJzoge1xuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3JldmNvbnRlbnQnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2xhYnMtY2RuLnJldmNvbnRlbnQuY29tL2J1aWxkL2FtcGh0bWwvcmV2Y29udGVudC5hbXAubWluLmpzJyxcbiAgICBwcmVjb25uZWN0OiBbXG4gICAgICAnaHR0cHM6Ly90cmVuZHMucmV2Y29udGVudC5jb20nLFxuICAgICAgJ2h0dHBzOi8vY2RuLnJldmNvbnRlbnQuY29tJyxcbiAgICAgICdodHRwczovL2ltZy5yZXZjb250ZW50LmNvbScsXG4gICAgXSxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdyZXZqZXQnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2Nkbi5yZXZqZXQuY29tL35jZG4vSlMvMDMvYW1wLmpzJyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdydWJpY29uJzoge30sXG5cbiAgJ3Nla2luZG8nOiB7XG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnc2hhcmV0aHJvdWdoJzoge1xuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3NrbGlrJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9jLmltZWRpYS5jei9qcy9hbXAuanMnLFxuICB9LFxuXG4gICdzbGltY3V0bWVkaWEnOiB7XG4gICAgcHJlY29ubmVjdDogW1xuICAgICAgJ2h0dHBzOi8vc2IuZnJlZXNrcmVlbi5jb20nLFxuICAgICAgJ2h0dHBzOi8vc3RhdGljLmZyZWVza3JlZW4uY29tJyxcbiAgICAgICdodHRwczovL3ZpZGVvLmZyZWVza3JlZW4uY29tJyxcbiAgICBdLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3NtYXJ0YWRzZXJ2ZXInOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2VjLW5zLnNhc2Nkbi5jb20vZGlmZi9qcy9hbXAudjAuanMnLFxuICAgIHByZWNvbm5lY3Q6ICdodHRwczovL3N0YXRpYy5zYXNjZG4uY29tJyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdzbWFydGNsaXAnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2Nkbi5zbWFydGNsaXAubmV0L2FtcC9hbXAudjAuanMnLFxuICAgIHByZWNvbm5lY3Q6ICdodHRwczovL2Rlcy5zbWFydGNsaXAubmV0JyxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdzbWkyJzoge1xuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3NvZ291YWQnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL3RoZXRhLnNvZ291Y2RuLmNvbS93YXAvanMvYXcuanMnLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3NvcnRhYmxlJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly93d3cuZ29vZ2xldGFnc2VydmljZXMuY29tL3RhZy9qcy9ncHQuanMnLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL3RhZ3MtY2RuLmRlcGxveWFkcy5jb20nLFxuICAgICAgJ2h0dHBzOi8vcGFydG5lci5nb29nbGVhZHNlcnZpY2VzLmNvbScsXG4gICAgICAnaHR0cHM6Ly9zZWN1cmVwdWJhZHMuZy5kb3VibGVjbGljay5uZXQnLFxuICAgICAgJ2h0dHBzOi8vdHBjLmdvb2dsZXN5bmRpY2F0aW9uLmNvbScsXG4gICAgXSxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICdzb3Zybic6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vYXAubGlqaXQuY29tL3d3dy9zb3Zybl9hbXAvc292cm5fYWRzLmpzJyxcbiAgfSxcblxuICAnc3BvdHgnOiB7XG4gICAgcHJlY29ubmVjdDogJ2h0dHBzOi8vanMuc3BvdHgudHYnLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3N1bm1lZGlhJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly92b2QuYWRkZXZ3ZWIuY29tL3N1bm1lZGlhL2FtcC9hZHMvc3VubWVkaWEuanMnLFxuICAgIHByZWNvbm5lY3Q6ICdodHRwczovL3N0YXRpYy5hZGRldndlYi5jb20nLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3N3b29wJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly93d3cuc3dvb3AtYW1wLmNvbS9hbXAuanMnLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL3d3dy5zd3BzdmMuY29tJyxcbiAgICAgICdodHRwczovL2NsaWVudC5zd3BjbGQuY29tJyxcbiAgICBdLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3RhYm9vbGEnOiB7fSxcblxuICAndGVhZHMnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2Nkbi50ZWFkcy50di9tZWRpYS9mb3JtYXQvdjMvdGVhZHMtZm9ybWF0Lm1pbi5qcycsXG4gICAgcHJlY29ubmVjdDogW1xuICAgICAgJ2h0dHBzOi8vY2RuMi50ZWFkcy50dicsXG4gICAgICAnaHR0cHM6Ly9hLnRlYWRzLnR2JyxcbiAgICAgICdodHRwczovL3QudGVhZHMudHYnLFxuICAgICAgJ2h0dHBzOi8vci50ZWFkcy50dicsXG4gICAgXSxcbiAgICBjb25zZW50SGFuZGxpbmdPdmVycmlkZTogdHJ1ZSxcbiAgfSxcblxuICAndHJpcGxlbGlmdCc6IHt9LFxuXG4gICd0cnVnYXplJzoge1xuICAgIGNsaWVudElkU2NvcGU6ICdfX3RnX2FtcCcsXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAndWFzJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9hZHMucHVibWF0aWMuY29tL0FkU2VydmVyL2pzL3Bob2VuaXguanMnLFxuICB9LFxuXG4gICd1em91Jzoge1xuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL3NwZWVlLWFkLmFrYW1haXplZC5uZXQnLFxuICAgIF0sXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAndW5ydWx5Jzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly92aWRlby51bnJ1bHltZWRpYS5jb20vYW1wLWRlbW8vbmF0aXZlLWxvYWRlci5qcycsXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAndmFsdWVjb21tZXJjZSc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vYW1wLnZhbHVlY29tbWVyY2UuY29tL2FtcF9icmlkZ2UuanMnLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL2FkLmpwLmFwLnZhbHVlY29tbWVyY2UuY29tJyxcbiAgICAgICdodHRwczovL2FkLm9ta3MudmFsdWVjb21tZXJjZS5jb20nLFxuICAgIF0sXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAndmlkZW9pbnRlbGxpZ2VuY2UnOiB7XG4gICAgcHJlY29ubmVjdDogJ2h0dHBzOi8vcy52aS1zZXJ2ZS5jb20nLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3ZpZGVvbm93Jzoge1xuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3ZpcmFsaXplJzoge1xuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3ZtZml2ZSc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vbWFuLnZtNWFwaXMuY29tL2Rpc3QvYWRuLXdlYi1zZGsuanMnLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL3Zhd3Byby52bTVhcGlzLmNvbScsXG4gICAgICAnaHR0cHM6Ly92YWhmcm9udC52bTVhcGlzLmNvbScsXG4gICAgXSxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICd3ZWJlZGlhZHMnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2V1MS53YmRkcy5jb20vYW1wLm1pbi5qcycsXG4gICAgcHJlY29ubmVjdDogW1xuICAgICAgJ2h0dHBzOi8vZ291dGVlLnRvcCcsXG4gICAgICAnaHR0cHM6Ly9tZWRpYWF0aGF5Lm9yZy51aycsXG4gICAgXSxcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICd3ZWJvcmFtYS1kaXNwbGF5Jzoge1xuICAgIHByZWZldGNoOiBbXG4gICAgICAnaHR0cHM6Ly9jc3RhdGljLndlYm9yYW1hLmZyL2pzL2FkdmVydGlzZXJ2Mi9hZHBlcmZfbGF1bmNoXzEuMC4wX3NjcmFtYmxlZC5qcycsXG4gICAgICAnaHR0cHM6Ly9jc3RhdGljLndlYm9yYW1hLmZyL2pzL2FkdmVydGlzZXJ2Mi9hZHBlcmZfY29yZV8xLjAuMF9zY3JhbWJsZWQuanMnLFxuICAgIF0sXG4gIH0sXG5cbiAgJ3dpZGVzcGFjZSc6IHt9LFxuXG4gICd3aXN0ZXJpYSc6IHtcbiAgICByZW5kZXJTdGFydEltcGxlbWVudGVkOiB0cnVlLFxuICB9LFxuXG4gICd3cG1lZGlhJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9zdGQud3BjZG4ucGwvd3Bqc2xpYi93cGpzbGliLWFtcC5qcycsXG4gICAgcHJlY29ubmVjdDogW1xuICAgICAgJ2h0dHBzOi8vd3d3LndwLnBsJyxcbiAgICAgICdodHRwczovL3Yud3BpbWcucGwnLFxuICAgIF0sXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAneGxpZnQnOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL2Nkbi54LWxpZnQuanAvcmVzb3VyY2VzL2NvbW1vbi94bGlmdF9hbXAuanMnLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3lhaG9vJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9zLnlpbWcuY29tL29zL2FtcGFkL2Rpc3BsYXkuanMnLFxuICAgIHByZWNvbm5lY3Q6ICdodHRwczovL3VzLmFkc2VydmVyLnlhaG9vLmNvbScsXG4gIH0sXG5cbiAgJ3lhaG9vanAnOiB7XG4gICAgcHJlZmV0Y2g6IFtcbiAgICAgICdodHRwczovL3MueWltZy5qcC9pbWFnZXMvbGlzdGluZy90b29sL3lhZHMveWRuL2FtcC9hbXAuanMnLFxuICAgICAgJ2h0dHBzOi8veWFkcy5jLnlpbWcuanAvanMveWFkcy5qcycsXG4gICAgXSxcbiAgICBwcmVjb25uZWN0OiAnaHR0cHM6Ly95YWRzLnlhaG9vLmNvLmpwJyxcbiAgfSxcblxuICAneWFuZGV4Jzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly95YXN0YXRpYy5uZXQvcGFydG5lci1jb2RlL2xvYWRlcnMvY29udGV4dF9hbXAuanMnLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3llbmdvJzoge1xuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3lpZWxkYm90Jzoge1xuICAgIHByZWZldGNoOiBbXG4gICAgICAnaHR0cHM6Ly9jZG4ueWxkYnQuY29tL2pzL3lpZWxkYm90LmludGVudC5hbXAuanMnLFxuICAgICAgJ2h0dHBzOi8vbXNnLnlsZGJ0LmNvbS9qcy95Ym1zZy5odG1sJyxcbiAgICBdLFxuICAgIHByZWNvbm5lY3Q6ICdodHRwczovL2kueWxkYnQuY29tJyxcbiAgfSxcblxuICAneWllbGRtbyc6IHtcbiAgICBwcmVmZXRjaDogJ2h0dHBzOi8vc3RhdGljLnlpZWxkbW8uY29tL3ltLjEuanMnLFxuICAgIHByZWNvbm5lY3Q6IFtcbiAgICAgICdodHRwczovL3MueWllbGRtby5jb20nLFxuICAgICAgJ2h0dHBzOi8vYWRzLnlpZWxkbW8uY29tJyxcbiAgICBdLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3lpZWxkb25lJzoge1xuICAgIHByZWZldGNoOiAnaHR0cHM6Ly9pbWcuYWsuaW1wYWN0LWFkLmpwL2ljL3BvbmUvY29tbW9uanMveW9uZS1hbXAuanMnLFxuICB9LFxuXG4gICd5aWVsZHBybyc6IHtcbiAgICBwcmVjb25uZWN0OiAnaHR0cHM6Ly9jcmVhdGl2ZXMueWllbGRwcm8uZXUnLFxuICAgIHJlbmRlclN0YXJ0SW1wbGVtZW50ZWQ6IHRydWUsXG4gIH0sXG5cbiAgJ3plZG8nOiB7XG4gICAgcHJlZmV0Y2g6ICdodHRwczovL3NzMy56ZWRvLmNvbS9nZWNrby90YWcvR2Vja28uYW1wLm1pbi5qcycsXG4gICAgcmVuZGVyU3RhcnRJbXBsZW1lbnRlZDogdHJ1ZSxcbiAgfSxcblxuICAnemVyZ25ldCc6IHt9LFxuXG4gICd6dWNrcyc6IHtcbiAgICBwcmVjb25uZWN0OiBbXG4gICAgICAnaHR0cHM6Ly9qLnp1Y2tzLm5ldC56aW1nLmpwJyxcbiAgICAgICdodHRwczovL3NoLnp1Y2tzLm5ldCcsXG4gICAgICAnaHR0cHM6Ly9rLnp1Y2tzLm5ldCcsXG4gICAgICAnaHR0cHM6Ly9zdGF0aWMuenVja3MubmV0LnppbWcuanAnLFxuICAgIF0sXG4gIH0sXG5cbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgRXhwZXJpbWVudEluZm8sIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgZm9yY2VFeHBlcmltZW50QnJhbmNoLFxuICBnZXRFeHBlcmltZW50QnJhbmNoLFxuICByYW5kb21seVNlbGVjdFVuc2V0RXhwZXJpbWVudHMsXG59IGZyb20gJy4uLy4uLy4uL3NyYy9leHBlcmltZW50cyc7XG5pbXBvcnQge1xuICBhZGRFeHBlcmltZW50SWRUb0VsZW1lbnQsXG59IGZyb20gJy4vdHJhZmZpYy1leHBlcmltZW50cyc7XG5cbi8qKlxuICogQXR0ZW1wdHMgdG8gc2VsZWN0IGludG8gZXhwZXJpbWVudCBhbmQgZm9yY2VzIGJyYW5jaCBpZiBzZWxlY3RlZC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0geyFBcnJheTxzdHJpbmc+fSBicmFuY2hlc1xuICogQHBhcmFtIHtzdHJpbmd9IGV4cE5hbWVcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdEFkZEV4cElkVG9FbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZWxlY3RBbmRTZXRFeHBlcmltZW50cyhcbiAgd2luLCBlbGVtZW50LCBicmFuY2hlcywgZXhwTmFtZSwgb3B0QWRkRXhwSWRUb0VsZW1lbnQpIHtcbiAgY29uc3QgZXhwZXJpbWVudElkID0gZXhwVXRpbHMubWF5YmVTZWxlY3RFeHBlcmltZW50KFxuICAgICAgd2luLCBlbGVtZW50LCBicmFuY2hlcywgZXhwTmFtZSk7XG4gIGlmICghIWV4cGVyaW1lbnRJZCkge1xuICAgIGFkZEV4cGVyaW1lbnRJZFRvRWxlbWVudChvcHRBZGRFeHBJZFRvRWxlbWVudCA/XG4gICAgICBleHBlcmltZW50SWQgOiB1bmRlZmluZWQsIGVsZW1lbnQpO1xuICAgIGZvcmNlRXhwZXJpbWVudEJyYW5jaCh3aW4sIGV4cE5hbWUsIGV4cGVyaW1lbnRJZCk7XG4gIH1cbiAgcmV0dXJuIGV4cGVyaW1lbnRJZDtcbn1cblxuZXhwb3J0IGNsYXNzIEV4cGVyaW1lbnRVdGlscyB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gICAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHNlbGVjdGlvbkJyYW5jaGVzXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBleHBlcmltZW50TmFtZVxuICAgKi9cbiAgbWF5YmVTZWxlY3RFeHBlcmltZW50KFxuICAgIHdpbiwgZWxlbWVudCwgc2VsZWN0aW9uQnJhbmNoZXMsIGV4cGVyaW1lbnROYW1lKSB7XG4gICAgY29uc3QgZXhwZXJpbWVudEluZm9NYXAgPVxuICAgIC8qKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsICFFeHBlcmltZW50SW5mbz59ICovICh7fSk7XG4gICAgZXhwZXJpbWVudEluZm9NYXBbZXhwZXJpbWVudE5hbWVdID0ge1xuICAgICAgaXNUcmFmZmljRWxpZ2libGU6ICgpID0+IHRydWUsXG4gICAgICBicmFuY2hlczogc2VsZWN0aW9uQnJhbmNoZXMsXG4gICAgfTtcbiAgICByYW5kb21seVNlbGVjdFVuc2V0RXhwZXJpbWVudHMod2luLCBleHBlcmltZW50SW5mb01hcCk7XG4gICAgcmV0dXJuIGdldEV4cGVyaW1lbnRCcmFuY2god2luLCBleHBlcmltZW50TmFtZSk7XG4gIH1cbn1cblxuLyoqXG4gKiBFeHBlcmltZW50VXRpbHMgc2luZ2xldG9uLlxuICogQHR5cGUgeyFFeHBlcmltZW50VXRpbHN9XG4qL1xuY29uc3QgZXhwVXRpbHMgPSBuZXcgRXhwZXJpbWVudFV0aWxzKCk7XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHt0cnlQYXJzZUpzb259IGZyb20gJy4uLy4uLy4uL3NyYy9qc29uJztcblxuLyoqXG4gICogSGFuZGxlcyBhbiBYSFIgcmVzcG9uc2UgYnkgY2FsbGluZyBsaW5lQ2FsbGJhY2sgZm9yIGVhY2ggbGluZSBkZWxpbmVhdGlvbi5cbiAgKiBVc2VzIHN0cmVhbWluZyB3aGVyZSBwb3NzaWJsZSBvdGhlcndpc2UgZmFsbHMgYmFjayB0byB0ZXh0LlxuICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICogQHBhcmFtIHshLi4vLi4vLi4vc3JjL3V0aWxzL3hoci11dGlscy5GZXRjaFJlc3BvbnNlfSByZXNwb25zZVxuICAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nLCBib29sZWFuKX0gbGluZUNhbGxiYWNrXG4gICogQHByaXZhdGVcbiAgKi9cbmV4cG9ydCBmdW5jdGlvbiBsaW5lRGVsaW1pdGVkU3RyZWFtZXIod2luLCByZXNwb25zZSwgbGluZUNhbGxiYWNrKSB7XG4gIGxldCBsaW5lID0gJyc7XG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dFxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGRvbmVcbiAgICovXG4gIGZ1bmN0aW9uIHN0cmVhbWVyKHRleHQsIGRvbmUpIHtcbiAgICBjb25zdCByZWdleCA9IC8oW15cXG5dKikoXFxuKT8vZztcbiAgICBsZXQgbWF0Y2g7XG4gICAgd2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWModGV4dCkpKSB7XG4gICAgICBsaW5lICs9IG1hdGNoWzFdO1xuICAgICAgaWYgKG1hdGNoWzJdKSB7XG4gICAgICAgIGxpbmVDYWxsYmFjayhsaW5lLCBkb25lICYmIHJlZ2V4Lmxhc3RJbmRleCA9PT0gdGV4dC5sZW5ndGgpO1xuICAgICAgICBsaW5lID0gJyc7XG4gICAgICB9XG4gICAgICBpZiAocmVnZXgubGFzdEluZGV4ID09PSB0ZXh0Lmxlbmd0aCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYgKCFyZXNwb25zZS5ib2R5IHx8ICF3aW4uVGV4dERlY29kZXIpIHtcbiAgICByZXNwb25zZS50ZXh0KCkudGhlbih0ZXh0ID0+IHN0cmVhbWVyKHRleHQsIHRydWUpKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCd1dGYtOCcpO1xuICBjb25zdCByZWFkZXIgPSAvKiogQHR5cGUgIVJlYWRhYmxlU3RyZWFtRGVmYXVsdFJlYWRlciAqLyAoXG4gICAgcmVzcG9uc2UuYm9keS5nZXRSZWFkZXIoKSk7XG4gIHJlYWRlci5yZWFkKCkudGhlbihmdW5jdGlvbiBjaHVuayhyZXN1bHQpIHtcbiAgICBpZiAocmVzdWx0LnZhbHVlKSB7XG4gICAgICBzdHJlYW1lcihcbiAgICAgICAgICBkZWNvZGVyLmRlY29kZShcbiAgICAgICAgICAgICAgLyoqIEB0eXBlIHshQXJyYXlCdWZmZXJ9ICovKHJlc3VsdC52YWx1ZSksIHsnc3RyZWFtJzogdHJ1ZX0pLFxuICAgICAgICAgIHJlc3VsdC5kb25lKTtcbiAgICB9XG4gICAgaWYgKCFyZXN1bHQuZG9uZSkge1xuICAgICAgLy8gTW9yZSBjaHVua3MgdG8gcmVhZC5cbiAgICAgIHJlYWRlci5yZWFkKCkudGhlbihjaHVuayk7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gICogR2l2ZW4gZWFjaCBsaW5lLCBncm91cHMgc3VjaCB0aGF0IHRoZSBmaXJzdCBpcyBKU09OIHBhcnNlZCBhbmQgc2Vjb25kXG4gICogaHRtbCB1bmVzY2FwZWQuXG4gICogQHBhcmFtIHtmdW5jdGlvbihzdHJpbmcsICFPYmplY3Q8c3RyaW5nLCAqPiwgYm9vbGVhbil9IGNhbGxiYWNrXG4gICogQHByaXZhdGVcbiAgKi9cbmV4cG9ydCBmdW5jdGlvbiBtZXRhSnNvbkNyZWF0aXZlR3JvdXBlcihjYWxsYmFjaykge1xuICBsZXQgZmlyc3Q7XG4gIHJldHVybiBmdW5jdGlvbihsaW5lLCBkb25lKSB7XG4gICAgaWYgKGZpcnN0KSB7XG4gICAgICBjb25zdCBtZXRhZGF0YSA9XG4gICAgICAvKiogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCAqPn0gKi8odHJ5UGFyc2VKc29uKGZpcnN0KSB8fCB7fSk7XG4gICAgICBjb25zdCBsb3dlckNhc2VkTWV0YWRhdGEgPVxuICAgICAgICAgIE9iamVjdC5rZXlzKG1ldGFkYXRhKS5yZWR1Y2UoKG5ld09iaiwga2V5KSA9PiB7XG4gICAgICAgICAgICBuZXdPYmpba2V5LnRvTG93ZXJDYXNlKCldID0gbWV0YWRhdGFba2V5XTtcbiAgICAgICAgICAgIHJldHVybiBuZXdPYmo7XG4gICAgICAgICAgfSwge30pO1xuICAgICAgY2FsbGJhY2sodW5lc2NhcGVMaW5lRGVsaW1pdGVkSHRtbF8obGluZSksIGxvd2VyQ2FzZWRNZXRhZGF0YSwgZG9uZSk7XG4gICAgICBmaXJzdCA9IG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZpcnN0ID0gbGluZTtcbiAgICB9XG4gIH07XG59XG5cbi8qKlxuICAqIFVuZXNjYXBlcyBjaGFyYWN0ZXJzIHRoYXQgYXJlIGVzY2FwZWQgaW4gbGluZS1kZWxpbWl0ZWQgSlNPTi1IVE1MLlxuICAqIEBwYXJhbSB7c3RyaW5nfSBodG1sIEFuIGh0bWwgc25pcHBldC5cbiAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICogQHByaXZhdGVcbiAgKi9cbmZ1bmN0aW9uIHVuZXNjYXBlTGluZURlbGltaXRlZEh0bWxfKGh0bWwpIHtcbiAgcmV0dXJuIGh0bWwucmVwbGFjZShcbiAgICAgIC9cXFxcKG58cnxcXFxcKS9nLFxuICAgICAgKF8sIG1hdGNoKSA9PiBtYXRjaCA9PSAnbicgPyAnXFxuJyA6IG1hdGNoID09ICdyJyA/ICdcXHInIDogJ1xcXFwnKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIE1hY2hpbmVyeSBmb3IgZG9pbmcgXCJ0cmFmZmljLWxldmVsXCIgZXhwZXJpbWVudHMuICBUaGF0IGlzLCByYXRoZXIgdGhhblxuICogYSBzaW5nbGUgdXNlciBjaG9vc2luZyB0byBvcHQtaW4gdG8gYW4gZXhwZXJpbWVudGFsIHZlcnNpb24gb2YgYSBtb2R1bGUsXG4gKiB0aGlzIGZyYW1ld29yayBhbGxvd3MgeW91IHRvIGRvIHJhbmRvbWl6ZWQsIGNvbnRyb2xsZWQgZXhwZXJpbWVudHMgb24gYWxsXG4gKiBBTVAgcGFnZSBsb2FkcyB0bywgZm9yIGV4YW1wbGUsIHRlc3QgcmVsYXRpdmUgcGVyZm9ybWFuY2Ugb3IgbG9vayBmb3JcbiAqIGltcGFjdHMgb24gY2xpY2stdGhyb3VnaHMuXG4gKi9cblxuaW1wb3J0IHtcbiAgRVhQRVJJTUVOVF9BVFRSSUJVVEUsXG4gIG1lcmdlRXhwZXJpbWVudElkcyxcbn0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQge1xuICBFeHBlcmltZW50SW5mbywgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuICBpc0V4cGVyaW1lbnRPbixcbn0gZnJvbSAnLi4vLi4vLi4vc3JjL2V4cGVyaW1lbnRzJztcbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4uLy4uLy4uL3NyYy9zZXJ2aWNlcyc7XG5pbXBvcnQge3BhcnNlUXVlcnlTdHJpbmd9IGZyb20gJy4uLy4uLy4uL3NyYy91cmwnO1xuXG4vKiogQHR5cGVkZWYge3tcbiAqICAgIGNvbnRyb2w6IHN0cmluZyxcbiAqICAgIGV4cGVyaW1lbnQ6IHN0cmluZ1xuICogIH19ICovXG5leHBvcnQgbGV0IEE0YUV4cGVyaW1lbnRCcmFuY2hlcztcblxuLyoqIEB0eXBlIHtzdHJpbmd9IEBwcml2YXRlICovXG5leHBvcnQgY29uc3QgTUFOVUFMX0VYUEVSSU1FTlRfSUQgPSAnMTE3MTUyNjMyJztcblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudCBBZCB0YWcgRWxlbWVudC5cbiAqIEByZXR1cm4gez9zdHJpbmd9IGV4cGVyaW1lbnQgZXh0cmFjdGVkIGZyb20gcGFnZSB1cmwuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0VXJsRXhwZXJpbWVudElkKHdpbiwgZWxlbWVudCkge1xuICBjb25zdCBleHBQYXJhbSA9IFNlcnZpY2VzLnZpZXdlckZvckRvYyhlbGVtZW50KS5nZXRQYXJhbSgnZXhwJykgfHxcbiAgICBwYXJzZVF1ZXJ5U3RyaW5nKHdpbi5sb2NhdGlvbi5zZWFyY2gpWydleHAnXTtcbiAgaWYgKCFleHBQYXJhbSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIC8vIEFsbG93IGZvciBwZXIgdHlwZSBleHBlcmltZW50IGNvbnRyb2wgd2l0aCBEb3VibGVjbGljayBrZXkgc2V0IGZvciAnZGEnXG4gIC8vIGFuZCBBZFNlbnNlIHVzaW5nICdhYScuICBGYWxsYmFjayB0byAnYTRhJyBpZiB0eXBlIHNwZWNpZmljIGlzIG1pc3NpbmcuXG4gIGNvbnN0IGV4cEtleXMgPSBbXG4gICAgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykgfHwgJycpLnRvTG93ZXJDYXNlKCkgPT0gJ2RvdWJsZWNsaWNrJyA/XG4gICAgICAnZGEnIDogJ2FhJyxcbiAgICAnYTRhJyxcbiAgXTtcbiAgbGV0IGFyZztcbiAgbGV0IG1hdGNoO1xuICBleHBLZXlzLmZvckVhY2goa2V5ID0+IGFyZyA9IGFyZyB8fFxuICAgICgobWF0Y2ggPSBuZXcgUmVnRXhwKGAoPzpefCwpJHtrZXl9OigtP1xcXFxkKylgKS5leGVjKGV4cFBhcmFtKSkgJiZcbiAgICAgIG1hdGNoWzFdKSk7XG4gIHJldHVybiBhcmcgfHwgbnVsbDtcbn1cblxuLyoqXG4gKiBTZXRzIG9mIGV4cGVyaW1lbnQgSURzIGNhbiBiZSBhdHRhY2hlZCB0byBFbGVtZW50cyB2aWEgYXR0cmlidXRlcy4gIEluXG4gKiB0aGF0IGNhc2UsIHdlIGVuY29kZSB0aGVtIGFzIGEgc3RyaW5nIGNvbnRhaW5pbmcgYSBjb21tYS1zZXBhcmF0ZWQgbGlzdFxuICogb2YgZXhwZXJpbWVudCBJRHMuICBUaGlzIHBhcnNlcyBhIGNvbW1hLXNlcGFyYXRlZCBsaXN0IGZyb20gYSBzdHJpbmcgaW50b1xuICogYSBsaXN0IG9mIElEIHN0cmluZ3MuICBJZiB0aGUgaW5wdXQgc3RyaW5nIGlzIGVtcHR5IG9yIG51bGwsIHRoaXMgcmV0dXJuc1xuICogdGhlIGVtcHR5IGxpc3QuICBUaGlzIGRvZXMgbm8gdmFsaWRpdHkgY2hlY2tpbmcgb24gdGhlIElEIGZvcm1hdHMgLS0gZm9yXG4gKiB0aGF0LCB1c2UgdmFsaWRhdGVFeHBlcmltZW50SWRzLlxuICpcbiAqIEBwYXJhbSB7P3N0cmluZ30gaWRTdHJpbmcgIFN0cmluZyB0byBwYXJzZS5cbiAqIEByZXR1cm4geyFBcnJheTxzdHJpbmc+fSAgTGlzdCBvZiBleHBlcmltZW50IElEcyAocG9zc2libHkgZW1wdHkpLlxuICogQHNlZSB2YWxpZGF0ZUV4cGVyaW1lbnRJZHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRXhwZXJpbWVudElkcyhpZFN0cmluZykge1xuICBpZiAoaWRTdHJpbmcpIHtcbiAgICByZXR1cm4gaWRTdHJpbmcuc3BsaXQoJywnKTtcbiAgfVxuICByZXR1cm4gW107XG59XG5cbi8qKlxuICogQ2hlY2tzIHdoZXRoZXIgdGhlIGdpdmVuIGVsZW1lbnQgaXMgYSBtZW1iZXIgb2YgdGhlIGdpdmVuIGV4cGVyaW1lbnQgYnJhbmNoLlxuICogSS5lLiwgd2hldGhlciB0aGUgZWxlbWVudCdzIGRhdGEtZXhwZXJpbWVudC1pZCBhdHRyaWJ1dGUgY29udGFpbnMgdGhlIGlkXG4gKiB2YWx1ZSAocG9zc2libHkgYmVjYXVzZSB0aGUgaG9zdCBwYWdlIFVSTCBjb250YWlucyBhICdleHA9YTRhOlgnIHBhcmFtZXRlclxuICogYW5kICNtYXliZVNldEV4cGVyaW1lbnRGcm9tVXJsIGhhcyBhZGRlZCB0aGUgYXBwcm9wcmlhdGUgRUlEKS5cbiAqXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50IEVsZW1lbnQgdG8gY2hlY2sgZm9yIG1lbWJlcnNoaXAgaW4gYSBzcGVjaWZpY1xuICogICBleHBlcmltZW50LlxuICogQHBhcmFtIHs/c3RyaW5nfSBpZCBFeHBlcmltZW50IElEIHRvIGNoZWNrIGZvciBvbiBgZWxlbWVudGAuXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNJbkV4cGVyaW1lbnQoZWxlbWVudCwgaWQpIHtcbiAgcmV0dXJuIHBhcnNlRXhwZXJpbWVudElkcyhlbGVtZW50LmdldEF0dHJpYnV0ZShFWFBFUklNRU5UX0FUVFJJQlVURSkpLnNvbWUoXG4gICAgICB4ID0+IHsgcmV0dXJuIHggPT09IGlkOyB9KTtcbn1cblxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciB0aGUgZ2l2ZW4gZWxlbWVudCBpcyBhIG1lbWJlciBvZiB0aGUgJ21hbnVhbGx5IHRyaWdnZXJlZFxuICogXCJleHBlcmltZW50XCIgYnJhbmNoJy4gIEkuZS4sIHdoZXRoZXIgdGhlIGVsZW1lbnQncyBkYXRhLWV4cGVyaW1lbnQtaWRcbiAqIGF0dHJpYnV0ZSBjb250YWlucyB0aGUgTUFOVUFMX0VYUEVSSU1FTlRfSUQgdmFsdWUgKGhvcGVmdWxseSBiZWNhdXNlIHRoZVxuICogdXNlciBoYXMgbWFudWFsbHkgc3BlY2lmaWVkICdleHA9YTRhOi0xJyBpbiB0aGUgaG9zdCBwYWdlIFVSTCBhbmRcbiAqICNtYXliZVNldEV4cGVyaW1lbnRGcm9tVXJsIGhhcyBhZGRlZCBpdCkuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudCAgRWxlbWVudCB0byBjaGVjayBmb3IgbWFudWFsIGV4cGVyaW1lbnQgbWVtYmVyc2hpcC5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0luTWFudWFsRXhwZXJpbWVudChlbGVtZW50KSB7XG4gIHJldHVybiBpc0luRXhwZXJpbWVudChlbGVtZW50LCBNQU5VQUxfRVhQRVJJTUVOVF9JRCk7XG59XG5cbi8qKlxuICogUHJlZGljYXRlIHRvIGNoZWNrIHdoZXRoZXIgQTRBIGhhcyBsYXVuY2hlZCB5ZXQgb3Igbm90LlxuICogSWYgaXQgaGFzIG5vdCB5ZXQgbGF1bmNoZWQsIHRoZW4gdGhlIGV4cGVyaW1lbnRhbCBicmFuY2ggc2VydmVzIEE0QSwgYW5kXG4gKiBjb250cm9sL2ZpbGxlciBkbyBub3QuIElmIGl0IGhhcyBub3QsIHRoZW4gdGhlIGZpbGxlciBhbmQgY29udHJvbCBicmFuY2ggZG9cbiAqIHNlcnZlIEE0QSwgYW5kIHRoZSBleHBlcmltZW50YWwgYnJhbmNoIGRvZXMgbm90LlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luICBIb3N0IHdpbmRvdyBmb3IgdGhlIGFkLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudCAgRWxlbWVudCB0byBjaGVjayBmb3IgcHJlLWxhdW5jaCBtZW1iZXJzaGlwLlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc0xhdW5jaGVkKHdpbiwgZWxlbWVudCkge1xuICBzd2l0Y2ggKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykpIHtcbiAgICBjYXNlICdhZHNlbnNlJzpcbiAgICAgIHJldHVybiBpc0V4cGVyaW1lbnRPbih3aW4sICdhNGFGYXN0RmV0Y2hBZFNlbnNlTGF1bmNoZWQnKTtcbiAgICBjYXNlICdkb3VibGVjbGljayc6XG4gICAgICByZXR1cm4gaXNFeHBlcmltZW50T24od2luLCAnYTRhRmFzdEZldGNoRG91YmxlY2xpY2tMYXVuY2hlZCcpO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuLyoqXG4gKiBDaGVja3MgdGhhdCBhbGwgc3RyaW5nIGV4cGVyaW1lbnQgSURzIGluIGEgbGlzdCBhcmUgc3ludGFjdGljYWxseSB2YWxpZFxuICogKGludGVnZXIgYmFzZSAxMCkuXG4gKlxuICogQHBhcmFtIHshQXJyYXk8c3RyaW5nPn0gaWRMaXN0ICBMaXN0IG9mIGV4cGVyaW1lbnQgSURzLiAgQ2FuIGJlIGVtcHR5LlxuICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciBhbGwgbGlzdCBlbGVtZW50cyBhcmUgdmFsaWQgZXhwZXJpbWVudCBJRHMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUV4cGVyaW1lbnRJZHMoaWRMaXN0KSB7XG4gIHJldHVybiBpZExpc3QuZXZlcnkoaWQgPT4geyByZXR1cm4gIWlzTmFOKHBhcnNlSW50KGlkLCAxMCkpOyB9KTtcbn1cblxuLyoqXG4gKiBBZGRzIGEgc2luZ2xlIGV4cGVyaW1lbnRJRCB0byBhbiBlbGVtZW50IGlmZiBpdCdzIGEgdmFsaWQgZXhwZXJpbWVudCBJRC5cbiAqIE5vLW9wcyBpZiB0aGUgZXhwZXJpbWVudElkIGlzIHVuZGVmaW5lZC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ3x1bmRlZmluZWR9IGV4cGVyaW1lbnRJZCAgSUQgdG8gYWRkIHRvIHRoZSBlbGVtZW50LlxuICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IHRvIGFkZCB0aGUgZXhwZXJpbWVudCBJRCB0by5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZEV4cGVyaW1lbnRJZFRvRWxlbWVudChleHBlcmltZW50SWQsIGVsZW1lbnQpIHtcbiAgaWYgKCFleHBlcmltZW50SWQpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgY3VycmVudEVpZHMgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShFWFBFUklNRU5UX0FUVFJJQlVURSk7XG4gIGlmIChjdXJyZW50RWlkcyAmJiB2YWxpZGF0ZUV4cGVyaW1lbnRJZHMocGFyc2VFeHBlcmltZW50SWRzKGN1cnJlbnRFaWRzKSkpIHtcbiAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShFWFBFUklNRU5UX0FUVFJJQlVURSxcbiAgICAgICAgbWVyZ2VFeHBlcmltZW50SWRzKFtleHBlcmltZW50SWRdLCBjdXJyZW50RWlkcykpO1xuICB9IGVsc2Uge1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKEVYUEVSSU1FTlRfQVRUUklCVVRFLCBleHBlcmltZW50SWQpO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqIEB0eXBlZGVmIHt7bmFtZTogc3RyaW5nLCB2YWx1ZTogKHN0cmluZ3xudW1iZXJ8bnVsbCl9fSAqL1xuZXhwb3J0IGxldCBRdWVyeVBhcmFtZXRlckRlZjtcblxuLyoqXG4gKiBCdWlsZHMgYSBVUkwgZnJvbSBxdWVyeSBwYXJhbWV0ZXJzLCB0cnVuY2F0aW5nIHRvIGEgbWF4aW11bSBsZW5ndGggaWZcbiAqIG5lY2Vzc2FyeS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBiYXNlVXJsIHNjaGVtZSwgZG9tYWluLCBhbmQgcGF0aCBmb3IgdGhlIFVSTC5cbiAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsc3RyaW5nfG51bWJlcnxudWxsPn0gcXVlcnlQYXJhbXMgcXVlcnkgcGFyYW1ldGVycyBmb3JcbiAqICAgICB0aGUgVVJMLlxuICogQHBhcmFtIHtudW1iZXJ9IG1heExlbmd0aCBsZW5ndGggdG8gdHJ1bmNhdGUgdGhlIFVSTCB0byBpZiBuZWNlc3NhcnkuXG4gKiBAcGFyYW0gez9RdWVyeVBhcmFtZXRlckRlZj19IG9wdF90cnVuY2F0aW9uUXVlcnlQYXJhbSBxdWVyeSBwYXJhbWV0ZXIgdG9cbiAqICAgICBhcHBlbmQgdG8gdGhlIFVSTCBpZmYgYW55IHF1ZXJ5IHBhcmFtZXRlcnMgd2VyZSB0cnVuY2F0ZWQuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IHRoZSBmdWxseSBjb25zdHJ1Y3RlZCBVUkwuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBidWlsZFVybChcbiAgYmFzZVVybCwgcXVlcnlQYXJhbXMsIG1heExlbmd0aCwgb3B0X3RydW5jYXRpb25RdWVyeVBhcmFtKSB7XG4gIGNvbnN0IGVuY29kZWRQYXJhbXMgPSBbXTtcbiAgY29uc3QgZW5jb2RlZFRydW5jYXRpb25QYXJhbSA9XG4gICAgICBvcHRfdHJ1bmNhdGlvblF1ZXJ5UGFyYW0gJiZcbiAgICAgICEob3B0X3RydW5jYXRpb25RdWVyeVBhcmFtLnZhbHVlID09IG51bGwgfHxcbiAgICAgIG9wdF90cnVuY2F0aW9uUXVlcnlQYXJhbS52YWx1ZSA9PT0gJycpID9cbiAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KG9wdF90cnVuY2F0aW9uUXVlcnlQYXJhbS5uYW1lKSArICc9JyArXG4gICAgICBlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKG9wdF90cnVuY2F0aW9uUXVlcnlQYXJhbS52YWx1ZSkpIDpcbiAgICAgICAgbnVsbDtcbiAgbGV0IGNhcGFjaXR5ID0gbWF4TGVuZ3RoIC0gYmFzZVVybC5sZW5ndGg7XG4gIGlmIChlbmNvZGVkVHJ1bmNhdGlvblBhcmFtKSB7XG4gICAgY2FwYWNpdHkgLT0gZW5jb2RlZFRydW5jYXRpb25QYXJhbS5sZW5ndGggKyAxO1xuICB9XG4gIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhxdWVyeVBhcmFtcyk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGtleSA9IGtleXNbaV07XG4gICAgY29uc3QgdmFsdWUgPSBxdWVyeVBhcmFtc1trZXldO1xuICAgIGlmICh2YWx1ZSA9PSBudWxsIHx8IHZhbHVlID09PSAnJykge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGNvbnN0IGVuY29kZWROYW1lQW5kU2VwID0gZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyAnPSc7XG4gICAgY29uc3QgZW5jb2RlZFZhbHVlID0gZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyh2YWx1ZSkpO1xuICAgIGNvbnN0IGZ1bGxMZW5ndGggPSBlbmNvZGVkTmFtZUFuZFNlcC5sZW5ndGggKyBlbmNvZGVkVmFsdWUubGVuZ3RoICsgMTtcbiAgICBpZiAoZnVsbExlbmd0aCA+IGNhcGFjaXR5KSB7XG4gICAgICBjb25zdCB0cnVuY2F0ZWRWYWx1ZSA9IGVuY29kZWRWYWx1ZVxuICAgICAgICAgIC5zdWJzdHIoMCwgY2FwYWNpdHkgLSBlbmNvZGVkTmFtZUFuZFNlcC5sZW5ndGggLSAxKVxuICAgICAgLy8gRG9uJ3QgZW5kIHdpdGggYSBwYXJ0aWFsbHkgdHJ1bmNhdGVkIGVzY2FwZSBzZXF1ZW5jZVxuICAgICAgICAgIC5yZXBsYWNlKC8lXFx3PyQvLCAnJyk7XG4gICAgICBpZiAodHJ1bmNhdGVkVmFsdWUpIHtcbiAgICAgICAgZW5jb2RlZFBhcmFtcy5wdXNoKGVuY29kZWROYW1lQW5kU2VwICsgdHJ1bmNhdGVkVmFsdWUpO1xuICAgICAgfVxuICAgICAgaWYgKGVuY29kZWRUcnVuY2F0aW9uUGFyYW0pIHtcbiAgICAgICAgZW5jb2RlZFBhcmFtcy5wdXNoKGVuY29kZWRUcnVuY2F0aW9uUGFyYW0pO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGVuY29kZWRQYXJhbXMucHVzaChlbmNvZGVkTmFtZUFuZFNlcCArIGVuY29kZWRWYWx1ZSk7XG4gICAgY2FwYWNpdHkgLT0gZnVsbExlbmd0aDtcbiAgfVxuICBpZiAoIWVuY29kZWRQYXJhbXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGJhc2VVcmw7XG4gIH1cbiAgcmV0dXJuIGJhc2VVcmwgKyAnPycgKyBlbmNvZGVkUGFyYW1zLmpvaW4oJyYnKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge0RvbUZpbmdlcnByaW50fSBmcm9tICcuLi8uLi8uLi9zcmMvdXRpbHMvZG9tLWZpbmdlcnByaW50JztcbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4uLy4uLy4uL3NyYy9zZXJ2aWNlcyc7XG5pbXBvcnQge2J1aWxkVXJsfSBmcm9tICcuL3VybC1idWlsZGVyJztcbmltcG9ydCB7ZGV2fSBmcm9tICcuLi8uLi8uLi9zcmMvbG9nJztcbmltcG9ydCB7ZGljdH0gZnJvbSAnLi4vLi4vLi4vc3JjL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge2dldEJpbmFyeVR5cGV9IGZyb20gJy4uLy4uLy4uL3NyYy9leHBlcmltZW50cyc7XG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4uLy4uLy4uL3NyYy9tb2RlJztcbmltcG9ydCB7Z2V0T3JDcmVhdGVBZENpZH0gZnJvbSAnLi4vLi4vLi4vc3JjL2FkLWNpZCc7XG5pbXBvcnQge2dldFRpbWluZ0RhdGFTeW5jfSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZS92YXJpYWJsZS1zb3VyY2UnO1xuaW1wb3J0IHtcbiAgaXNFeHBlcmltZW50T24sXG4gIHRvZ2dsZUV4cGVyaW1lbnQsXG59IGZyb20gJy4uLy4uLy4uL3NyYy9leHBlcmltZW50cyc7XG5pbXBvcnQge3BhcnNlSnNvbn0gZnJvbSAnLi4vLi4vLi4vc3JjL2pzb24nO1xuaW1wb3J0IHt3aGVuVXBncmFkZWRUb0N1c3RvbUVsZW1lbnR9IGZyb20gJy4uLy4uLy4uL3NyYy9kb20nO1xuXG4vKiogQHR5cGUge3N0cmluZ30gICovXG5jb25zdCBBTVBfQU5BTFlUSUNTX0hFQURFUiA9ICdYLUFtcEFuYWx5dGljcyc7XG5cbi8qKiBAY29uc3Qge251bWJlcn0gKi9cbmNvbnN0IE1BWF9VUkxfTEVOR1RIID0gMTYzODQ7XG5cbi8qKiBAZW51bSB7c3RyaW5nfSAqL1xuY29uc3QgQW1wQWRJbXBsZW1lbnRhdGlvbiA9IHtcbiAgQU1QX0FEX1hIUl9UT19JRlJBTUU6ICcyJyxcbiAgQU1QX0FEX1hIUl9UT19JRlJBTUVfT1JfQU1QOiAnMycsXG4gIEFNUF9BRF9JRlJBTUVfR0VUOiAnNScsXG59O1xuXG4vKiogQGNvbnN0IHshT2JqZWN0fSAqL1xuZXhwb3J0IGNvbnN0IFZhbGlkQWRDb250YWluZXJUeXBlcyA9IHtcbiAgJ0FNUC1DQVJPVVNFTCc6ICdhYycsXG4gICdBTVAtRlgtRkxZSU5HLUNBUlBFVCc6ICdmYycsXG4gICdBTVAtTElHSFRCT1gnOiAnbGInLFxuICAnQU1QLVNUSUNLWS1BRCc6ICdzYScsXG59O1xuXG4vKipcbiAqIFNlZSBgVmlzaWJpbGl0eVN0YXRlYCBlbnVtLlxuICogQGNvbnN0IHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn1cbiAqL1xuY29uc3QgdmlzaWJpbGl0eVN0YXRlQ29kZXMgPSB7XG4gICd2aXNpYmxlJzogJzEnLFxuICAnaGlkZGVuJzogJzInLFxuICAncHJlcmVuZGVyJzogJzMnLFxuICAndW5sb2FkZWQnOiAnNScsXG59O1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgUVFJRF9IRUFERVIgPSAnWC1RUUlEJztcblxuLyoqXG4gKiBFbGVtZW50IGF0dHJpYnV0ZSB0aGF0IHN0b3JlcyBleHBlcmltZW50IElEcy5cbiAqXG4gKiBOb3RlOiBUaGlzIGF0dHJpYnV0ZSBzaG91bGQgYmUgdXNlZCBvbmx5IGZvciB0cmFja2luZyBleHBlcmltZW50YWxcbiAqIGltcGxlbWVudGF0aW9ucyBvZiBBTVAgdGFncywgZS5nLiwgYnkgQU1QSFRNTCBpbXBsZW1lbnRvcnMuICBJdCBzaG91bGQgbm90IGJlXG4gKiBhZGRlZCBieSBhIHB1Ymxpc2hlciBwYWdlLlxuICpcbiAqIEBjb25zdCB7c3RyaW5nfVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBjb25zdCBFWFBFUklNRU5UX0FUVFJJQlVURSA9ICdkYXRhLWV4cGVyaW1lbnQtaWQnO1xuXG4vKiogQHR5cGVkZWYge3t1cmxzOiAhQXJyYXk8c3RyaW5nPn19XG4gKi9cbmV4cG9ydCBsZXQgQW1wQW5hbHl0aWNzQ29uZmlnRGVmO1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7aW5zdGFudExvYWQ6IGJvb2xlYW4sIHdyaXRlSW5Cb2R5OiBib29sZWFufX1cbiAqL1xuZXhwb3J0IGxldCBOYW1lZnJhbWVFeHBlcmltZW50Q29uZmlnO1xuXG4vKipcbiAqIEBjb25zdCB7IS4vdXJsLWJ1aWxkZXIuUXVlcnlQYXJhbWV0ZXJEZWZ9XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IFRSVU5DQVRJT05fUEFSQU0gPSB7bmFtZTogJ3RydW5jJywgdmFsdWU6ICcxJ307XG5cbi8qKiBAY29uc3Qge09iamVjdH0gKi9cbmNvbnN0IENETl9QUk9YWV9SRUdFWFAgPSAvXmh0dHBzOlxcL1xcLyhbYS16QS1aMC05Xy1dK1xcLik/Y2RuXFwuYW1wcHJvamVjdFxcLm9yZygoXFwvLiopfCgkKSkrLztcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiBuYXZpZ2F0aW9uIHN0YXJ0IHVzaW5nIHRoZSBwZXJmb3JtYW5jZSBBUEkgb3IgMCBpZiBub3RcbiAqIHN1cHBvcnRlZCBieSB0aGUgYnJvd3Nlci5cbiAqIEZlYXR1cmUgZGV0ZWN0aW9uIGlzIHVzZWQgZm9yIHNhZmV0eSBvbiBicm93c2VycyB0aGF0IGRvIG5vdCBzdXBwb3J0IHRoZVxuICogcGVyZm9ybWFuY2UgQVBJLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge251bWJlcn1cbiAqL1xuZnVuY3Rpb24gZ2V0TmF2U3RhcnQod2luKSB7XG4gIHJldHVybiAod2luWydwZXJmb3JtYW5jZSddICYmIHdpblsncGVyZm9ybWFuY2UnXVsndGltaW5nJ10gJiZcbiAgICAgIHdpblsncGVyZm9ybWFuY2UnXVsndGltaW5nJ11bJ25hdmlnYXRpb25TdGFydCddKSB8fCAwO1xufVxuXG4vKipcbiAqIENoZWNrIHdoZXRoZXIgR29vZ2xlIEFkcyBzdXBwb3J0cyB0aGUgQTRBIHJlbmRlcmluZyBwYXRod2F5IGlzIHZhbGlkIGZvciB0aGVcbiAqIGVudmlyb25tZW50IGJ5IGVuc3VyaW5nIG5hdGl2ZSBjcnlwdG8gc3VwcG9ydCBhbmQgcGFnZSBvcmlnaW5hdGVkIGluIHRoZVxuICoge0Bjb2RlIGNkbi5hbXBwcm9qZWN0Lm9yZ30gQ0ROIDxlbT5vcjwvZW0+IHdlIG11c3QgYmUgcnVubmluZyBpbiBsb2NhbFxuICogZGV2IG1vZGUuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW4gIEhvc3Qgd2luZG93IGZvciB0aGUgYWQuXG4gKiBAcmV0dXJuIHtib29sZWFufSAgV2hldGhlciBHb29nbGUgQWRzIHNob3VsZCBhdHRlbXB0IHRvIHJlbmRlciB2aWEgdGhlIEE0QVxuICogICBwYXRod2F5LlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNHb29nbGVBZHNBNEFWYWxpZEVudmlyb25tZW50KHdpbikge1xuICByZXR1cm4gc3VwcG9ydHNOYXRpdmVDcnlwdG8od2luKSAmJiAoXG4gICAgISFpc0NkblByb3h5KHdpbikgfHwgZ2V0TW9kZSh3aW4pLmxvY2FsRGV2IHx8IGdldE1vZGUod2luKS50ZXN0KTtcbn1cblxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciBuYXRpdmUgY3J5cHRvIGlzIHN1cHBvcnRlZCBmb3Igd2luLlxuICogQHBhcmFtIHshV2luZG93fSB3aW4gIEhvc3Qgd2luZG93IGZvciB0aGUgYWQuXG4gKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIG5hdGl2ZSBjcnlwdG8gaXMgc3VwcG9ydGVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc3VwcG9ydHNOYXRpdmVDcnlwdG8od2luKSB7XG4gIHJldHVybiB3aW4uY3J5cHRvICYmICh3aW4uY3J5cHRvLnN1YnRsZSB8fCB3aW4uY3J5cHRvLndlYmtpdFN1YnRsZSk7XG59XG5cbi8qKlxuICogQHBhcmFtIHshQU1QLkJhc2VFbGVtZW50fSBhbXBFbGVtZW50IFRoZSBlbGVtZW50IG9uIHdob3NlIGxpZmVjeWNsZSB0aGlzXG4gKiAgICByZXBvcnRlciB3aWxsIGJlIHJlcG9ydGluZy5cbiAqIEByZXR1cm4ge2Jvb2xlYW59IHdoZXRoZXIgcmVwb3J0aW5nIGlzIGVuYWJsZWQgZm9yIHRoaXMgZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNSZXBvcnRpbmdFbmFibGVkKGFtcEVsZW1lbnQpIHtcbiAgLy8gQ2FydmUtb3V0czogV2Ugb25seSB3YW50IHRvIGVuYWJsZSBwcm9maWxpbmcgcGluZ2JhY2tzIHdoZW46XG4gIC8vICAgLSBUaGUgYWQgaXMgZnJvbSBvbmUgb2YgdGhlIEdvb2dsZSBuZXR3b3JrcyAoQWRTZW5zZSBvciBEb3VibGVjbGljaykuXG4gIC8vICAgLSBUaGUgYWQgc2xvdCBpcyBpbiB0aGUgQTRBLXZzLTNwIGFtcC1hZCBjb250cm9sIGJyYW5jaCAoZWl0aGVyIHZpYVxuICAvLyAgICAgaW50ZXJuYWwsIGNsaWVudC1zaWRlIHNlbGVjdGlvbiBvciB2aWEgZXh0ZXJuYWwsIEdvb2dsZSBTZWFyY2hcbiAgLy8gICAgIHNlbGVjdGlvbikuXG4gIC8vICAgLSBXZSBoYXZlbid0IHR1cm5lZCBvZmYgcHJvZmlsaW5nIHZpYSB0aGUgcmF0ZSBjb250cm9scyBpblxuICAvLyAgICAgYnVpbGQtc3lzdGVtL2dsb2JhbC1jb25maWcve2NhbmFyeSxwcm9kfS1jb25maWcuanNvblxuICAvLyBJZiBhbnkgb2YgdGhvc2UgZmFpbCwgd2UgdXNlIHRoZSBgQmFzZUxpZmVjeWNsZVJlcG9ydGVyYCwgd2hpY2ggaXMgYVxuICAvLyBhIG5vLW9wIChzZW5kcyBubyBwaW5ncykuXG4gIGNvbnN0IHR5cGUgPSBhbXBFbGVtZW50LmVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJyk7XG4gIGNvbnN0IHt3aW59ID0gYW1wRWxlbWVudDtcbiAgLy8gSW4gbG9jYWwgZGV2IG1vZGUsIG5laXRoZXIgdGhlIGNhbmFyeSBub3IgcHJvZCBjb25maWcgZmlsZXMgaXMgYXZhaWxhYmxlLFxuICAvLyBzbyBtYW51YWxseSBzZXQgdGhlIHByb2ZpbGluZyByYXRlLCBmb3IgdGVzdGluZy9kZXYuXG4gIGlmIChnZXRNb2RlKGFtcEVsZW1lbnQud2luKS5sb2NhbERldiAmJiAhZ2V0TW9kZShhbXBFbGVtZW50LndpbikudGVzdCkge1xuICAgIHRvZ2dsZUV4cGVyaW1lbnQod2luLCAnYTRhUHJvZmlsaW5nUmF0ZScsIHRydWUsIHRydWUpO1xuICB9XG4gIHJldHVybiAodHlwZSA9PSAnZG91YmxlY2xpY2snIHx8IHR5cGUgPT0gJ2Fkc2Vuc2UnKSAmJlxuICAgICAgaXNFeHBlcmltZW50T24od2luLCAnYTRhUHJvZmlsaW5nUmF0ZScpO1xufVxuXG4vKipcbiAqIEhhcyBzaWRlLWVmZmVjdCBvZiBpbmNyZW1lbnRpbmcgaWZpIGNvdW50ZXIgb24gd2luZG93LlxuICogQHBhcmFtIHshLi4vLi4vLi4vZXh0ZW5zaW9ucy9hbXAtYTRhLzAuMS9hbXAtYTRhLkFtcEE0QX0gYTRhXG4gKiBAcGFyYW0geyFBcnJheTxzdHJpbmc+PX0gb3B0X2V4cGVyaW1lbnRJZHMgQW55IGV4cGVyaW1lbnRzIElEcyAoaW4gYWRkaXRpb25cbiAqICAgICB0byB0aG9zZSBzcGVjaWZpZWQgb24gdGhlIGFkIGVsZW1lbnQpIHRoYXQgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZVxuICogICAgIHJlcXVlc3QuXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZyxudWxsfG51bWJlcnxzdHJpbmc+fSBibG9jayBsZXZlbCBwYXJhbWV0ZXJzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnb29nbGVCbG9ja1BhcmFtZXRlcnMoYTRhLCBvcHRfZXhwZXJpbWVudElkcykge1xuICBjb25zdCB7ZWxlbWVudDogYWRFbGVtZW50LCB3aW59ID0gYTRhO1xuICBjb25zdCBzbG90UmVjdCA9IGE0YS5nZXRQYWdlTGF5b3V0Qm94KCk7XG4gIGNvbnN0IGlmcmFtZURlcHRoID0gaWZyYW1lTmVzdGluZ0RlcHRoKHdpbik7XG4gIGNvbnN0IGVuY2xvc2luZ0NvbnRhaW5lcnMgPSBnZXRFbmNsb3NpbmdDb250YWluZXJUeXBlcyhhZEVsZW1lbnQpO1xuICBsZXQgZWlkcyA9IGFkRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZXhwZXJpbWVudC1pZCcpO1xuICBpZiAob3B0X2V4cGVyaW1lbnRJZHMpIHtcbiAgICBlaWRzID0gbWVyZ2VFeHBlcmltZW50SWRzKG9wdF9leHBlcmltZW50SWRzLCBlaWRzKTtcbiAgfVxuICByZXR1cm4ge1xuICAgICdhZGYnOiBEb21GaW5nZXJwcmludC5nZW5lcmF0ZShhZEVsZW1lbnQpLFxuICAgICduaGQnOiBpZnJhbWVEZXB0aCxcbiAgICAnZWlkJzogZWlkcyxcbiAgICAnYWR4Jzogc2xvdFJlY3QubGVmdCxcbiAgICAnYWR5Jzogc2xvdFJlY3QudG9wLFxuICAgICdvaWQnOiAnMicsXG4gICAgJ2FjdCc6IGVuY2xvc2luZ0NvbnRhaW5lcnMubGVuZ3RoID8gZW5jbG9zaW5nQ29udGFpbmVycy5qb2luKCkgOiBudWxsLFxuICB9O1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBtYXRjaGluZyB0eXBpbmcgYXR0cmlidXRlLlxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6c3RyaW5nfSBncm91cEZuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhT2JqZWN0PHN0cmluZywhQXJyYXk8IVByb21pc2U8IS4uLy4uLy4uL3NyYy9iYXNlLWVsZW1lbnQuQmFzZUVsZW1lbnQ+Pj4+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ3JvdXBBbXBBZHNCeVR5cGUod2luLCB0eXBlLCBncm91cEZuKSB7XG4gIC8vIExvb2sgZm9yIGFtcC1hZCBlbGVtZW50cyBvZiBjb3JyZWN0IHR5cGUgb3IgdGhvc2UgY29udGFpbmVkIHdpdGhpblxuICAvLyBzdGFuZGFyZCBjb250YWluZXIgdHlwZS4gIE5vdGUgdGhhdCBkaXNwbGF5IG5vbmUgY29udGFpbmVycyB3aWxsIG5vdCBiZVxuICAvLyBpbmNsdWRlZCBhcyB0aGV5IHdpbGwgbmV2ZXIgYmUgbWVhc3VyZWQuXG4gIC8vIFRPRE8oa2VpdGh3cmlnaHRib3MpOiB3aGF0IGFib3V0IHNsb3RzIHRoYXQgYmVjb21lIG1lYXN1cmVkIGR1ZSB0byByZW1vdmFsXG4gIC8vIG9mIGRpc3BsYXkgbm9uZSAoZS5nLiB1c2VyIHJlc2l6ZXMgdmlld3BvcnQgYW5kIG1lZGlhIHNlbGVjdG9yIG1ha2VzXG4gIC8vIHZpc2libGUpLlxuICBjb25zdCBhbXBBZFNlbGVjdG9yID1cbiAgICAgIHIgPT4gci5lbGVtZW50Li8qT0sqL3F1ZXJ5U2VsZWN0b3IoYGFtcC1hZFt0eXBlPSR7dHlwZX1dYCk7XG4gIHJldHVybiBTZXJ2aWNlcy5yZXNvdXJjZXNGb3JEb2Mod2luLmRvY3VtZW50KS5nZXRNZWFzdXJlZFJlc291cmNlcyh3aW4sXG4gICAgICByID0+IHtcbiAgICAgICAgY29uc3QgaXNBbXBBZFR5cGUgPSByLmVsZW1lbnQudGFnTmFtZSA9PSAnQU1QLUFEJyAmJlxuICAgICAgICAgIHIuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSA9PSB0eXBlO1xuICAgICAgICBpZiAoaXNBbXBBZFR5cGUpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpc0FtcEFkQ29udGFpbmVyRWxlbWVudCA9XG4gICAgICAgICAgT2JqZWN0LmtleXMoVmFsaWRBZENvbnRhaW5lclR5cGVzKS5pbmNsdWRlcyhyLmVsZW1lbnQudGFnTmFtZSkgJiZcbiAgICAgICAgICAhIWFtcEFkU2VsZWN0b3Iocik7XG4gICAgICAgIHJldHVybiBpc0FtcEFkQ29udGFpbmVyRWxlbWVudDtcbiAgICAgIH0pXG4gICAgICAvLyBOZWVkIHRvIHdhaXQgb24gYW55IGNvbnRhaW5lZCBlbGVtZW50IHJlc29sdXRpb24gZm9sbG93ZWQgYnkgYnVpbGRcbiAgICAgIC8vIG9mIGNoaWxkIGFkLlxuICAgICAgLnRoZW4ocmVzb3VyY2VzID0+IFByb21pc2UuYWxsKHJlc291cmNlcy5tYXAoXG4gICAgICAgICAgcmVzb3VyY2UgPT4ge1xuICAgICAgICAgICAgaWYgKHJlc291cmNlLmVsZW1lbnQudGFnTmFtZSA9PSAnQU1QLUFEJykge1xuICAgICAgICAgICAgICByZXR1cm4gcmVzb3VyY2UuZWxlbWVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIE11c3QgYmUgY29udGFpbmVyIGVsZW1lbnQgc28gbmVlZCB0byB3YWl0IGZvciBjaGlsZCBhbXAtYWQgdG9cbiAgICAgICAgICAgIC8vIGJlIHVwZ3JhZGVkLlxuICAgICAgICAgICAgcmV0dXJuIHdoZW5VcGdyYWRlZFRvQ3VzdG9tRWxlbWVudChcbiAgICAgICAgICAgICAgICBkZXYoKS5hc3NlcnRFbGVtZW50KGFtcEFkU2VsZWN0b3IocmVzb3VyY2UpKSk7XG4gICAgICAgICAgfSkpKVxuICAgICAgLy8gR3JvdXAgYnkgbmV0d29ya0lkLlxuICAgICAgLnRoZW4oZWxlbWVudHMgPT4gZWxlbWVudHMucmVkdWNlKChyZXN1bHQsIGVsZW1lbnQpID0+IHtcbiAgICAgICAgY29uc3QgZ3JvdXBJZCA9IGdyb3VwRm4oZWxlbWVudCk7XG4gICAgICAgIChyZXN1bHRbZ3JvdXBJZF0gfHwgKHJlc3VsdFtncm91cElkXSA9IFtdKSkucHVzaChlbGVtZW50LmdldEltcGwoKSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9LCB7fSkpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7ISAuLi8uLi8uLi9leHRlbnNpb25zL2FtcC1hNGEvMC4xL2FtcC1hNGEuQW1wQTRBfSBhNGFcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydFRpbWVcbiAqIEByZXR1cm4geyFQcm9taXNlPCFPYmplY3Q8c3RyaW5nLG51bGx8bnVtYmVyfHN0cmluZz4+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ29vZ2xlUGFnZVBhcmFtZXRlcnMoYTRhLCBzdGFydFRpbWUpIHtcbiAgY29uc3Qge3dpbn0gPSBhNGE7XG4gIGNvbnN0IGFtcERvYyA9IGE0YS5nZXRBbXBEb2MoKTtcbiAgcmV0dXJuIFByb21pc2UuYWxsKFtcbiAgICBnZXRPckNyZWF0ZUFkQ2lkKGFtcERvYywgJ0FNUF9FQ0lEX0dPT0dMRScsICdfZ2EnKSxcbiAgICBTZXJ2aWNlcy52aWV3ZXJGb3JEb2MoYW1wRG9jKS5nZXRSZWZlcnJlclVybCgpXSlcbiAgICAgIC50aGVuKHByb21pc2VSZXN1bHRzID0+IHtcbiAgICAgICAgY29uc3QgY2xpZW50SWQgPSBwcm9taXNlUmVzdWx0c1swXTtcbiAgICAgICAgY29uc3QgZG9jdW1lbnRJbmZvID0gU2VydmljZXMuZG9jdW1lbnRJbmZvRm9yRG9jKGFtcERvYyk7XG4gICAgICAgIC8vIFJlYWQgYnkgR1BUIGZvciBHQS9HUFQgaW50ZWdyYXRpb24uXG4gICAgICAgIHdpbi5nYUdsb2JhbCA9IHdpbi5nYUdsb2JhbCB8fFxuICAgICAgICB7Y2lkOiBjbGllbnRJZCwgaGlkOiBkb2N1bWVudEluZm8ucGFnZVZpZXdJZH07XG4gICAgICAgIGNvbnN0IHtzY3JlZW59ID0gd2luO1xuICAgICAgICBjb25zdCB2aWV3cG9ydCA9IFNlcnZpY2VzLnZpZXdwb3J0Rm9yRG9jKGFtcERvYyk7XG4gICAgICAgIGNvbnN0IHZpZXdwb3J0UmVjdCA9IHZpZXdwb3J0LmdldFJlY3QoKTtcbiAgICAgICAgY29uc3Qgdmlld3BvcnRTaXplID0gdmlld3BvcnQuZ2V0U2l6ZSgpO1xuICAgICAgICBjb25zdCB2aXNpYmlsaXR5U3RhdGUgPSBTZXJ2aWNlcy52aWV3ZXJGb3JEb2MoYW1wRG9jKVxuICAgICAgICAgICAgLmdldFZpc2liaWxpdHlTdGF0ZSgpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICdpc19hbXAnOiBhNGEuaXNYaHJBbGxvd2VkKCkgP1xuICAgICAgICAgICAgQW1wQWRJbXBsZW1lbnRhdGlvbi5BTVBfQURfWEhSX1RPX0lGUkFNRV9PUl9BTVAgOlxuICAgICAgICAgICAgQW1wQWRJbXBsZW1lbnRhdGlvbi5BTVBfQURfSUZSQU1FX0dFVCxcbiAgICAgICAgICAnYW1wX3YnOiAnJGludGVybmFsUnVudGltZVZlcnNpb24kJyxcbiAgICAgICAgICAnZF9pbXAnOiAnMScsXG4gICAgICAgICAgJ2MnOiBnZXRDb3JyZWxhdG9yKHdpbiwgYW1wRG9jLCBjbGllbnRJZCksXG4gICAgICAgICAgJ2dhX2NpZCc6IHdpbi5nYUdsb2JhbC5jaWQgfHwgbnVsbCxcbiAgICAgICAgICAnZ2FfaGlkJzogd2luLmdhR2xvYmFsLmhpZCB8fCBudWxsLFxuICAgICAgICAgICdkdCc6IHN0YXJ0VGltZSxcbiAgICAgICAgICAnYml3Jzogdmlld3BvcnRSZWN0LndpZHRoLFxuICAgICAgICAgICdiaWgnOiB2aWV3cG9ydFJlY3QuaGVpZ2h0LFxuICAgICAgICAgICd1X2F3Jzogc2NyZWVuID8gc2NyZWVuLmF2YWlsV2lkdGggOiBudWxsLFxuICAgICAgICAgICd1X2FoJzogc2NyZWVuID8gc2NyZWVuLmF2YWlsSGVpZ2h0IDogbnVsbCxcbiAgICAgICAgICAndV9jZCc6IHNjcmVlbiA/IHNjcmVlbi5jb2xvckRlcHRoIDogbnVsbCxcbiAgICAgICAgICAndV93Jzogc2NyZWVuID8gc2NyZWVuLndpZHRoIDogbnVsbCxcbiAgICAgICAgICAndV9oJzogc2NyZWVuID8gc2NyZWVuLmhlaWdodCA6IG51bGwsXG4gICAgICAgICAgJ3VfdHonOiAtbmV3IERhdGUoKS5nZXRUaW1lem9uZU9mZnNldCgpLFxuICAgICAgICAgICd1X2hpcyc6IGdldEhpc3RvcnlMZW5ndGgod2luKSxcbiAgICAgICAgICAnaXN3Jzogd2luICE9IHdpbi50b3AgPyB2aWV3cG9ydFNpemUud2lkdGggOiBudWxsLFxuICAgICAgICAgICdpc2gnOiB3aW4gIT0gd2luLnRvcCA/IHZpZXdwb3J0U2l6ZS5oZWlnaHQgOiBudWxsLFxuICAgICAgICAgICdhcnQnOiBnZXRBbXBSdW50aW1lVHlwZVBhcmFtZXRlcih3aW4pLFxuICAgICAgICAgICd2aXMnOiB2aXNpYmlsaXR5U3RhdGVDb2Rlc1t2aXNpYmlsaXR5U3RhdGVdIHx8ICcwJyxcbiAgICAgICAgICAnc2NyX3gnOiB2aWV3cG9ydC5nZXRTY3JvbGxMZWZ0KCksXG4gICAgICAgICAgJ3Njcl95Jzogdmlld3BvcnQuZ2V0U2Nyb2xsVG9wKCksXG4gICAgICAgICAgJ2JjJzogZ2V0QnJvd3NlckNhcGFiaWxpdGllc0JpdG1hcCh3aW4pIHx8IG51bGwsXG4gICAgICAgICAgJ2RlYnVnX2V4cGVyaW1lbnRfaWQnOlxuICAgICAgICAgICAgICAoLyg/OiN8LClkZWlkPShbXFxkLF0rKS9pLmV4ZWMod2luLmxvY2F0aW9uLmhhc2gpIHx8IFtdKVsxXSB8fFxuICAgICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAndXJsJzogZG9jdW1lbnRJbmZvLmNhbm9uaWNhbFVybCxcbiAgICAgICAgICAndG9wJzogd2luICE9IHdpbi50b3AgPyB0b3BXaW5kb3dVcmxPckRvbWFpbih3aW4pIDogbnVsbCxcbiAgICAgICAgICAnbG9jJzogd2luLmxvY2F0aW9uLmhyZWYgPT0gZG9jdW1lbnRJbmZvLmNhbm9uaWNhbFVybCA/XG4gICAgICAgICAgICBudWxsIDogd2luLmxvY2F0aW9uLmhyZWYsXG4gICAgICAgICAgJ3JlZic6IHByb21pc2VSZXN1bHRzWzFdIHx8IG51bGwsXG4gICAgICAgIH07XG4gICAgICB9KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyEuLi8uLi8uLi9leHRlbnNpb25zL2FtcC1hNGEvMC4xL2FtcC1hNGEuQW1wQTRBfSBhNGFcbiAqIEBwYXJhbSB7c3RyaW5nfSBiYXNlVXJsXG4gKiBAcGFyYW0ge251bWJlcn0gc3RhcnRUaW1lXG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLG51bGx8bnVtYmVyfHN0cmluZz59IHBhcmFtZXRlcnNcbiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz49fSBvcHRfZXhwZXJpbWVudElkcyBBbnkgZXhwZXJpbWVudHMgSURzIChpbiBhZGRpdGlvblxuICogICAgIHRvIHRob3NlIHNwZWNpZmllZCBvbiB0aGUgYWQgZWxlbWVudCkgdGhhdCBzaG91bGQgYmUgaW5jbHVkZWQgaW4gdGhlXG4gKiAgICAgcmVxdWVzdC5cbiAqIEByZXR1cm4geyFQcm9taXNlPHN0cmluZz59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnb29nbGVBZFVybChcbiAgYTRhLCBiYXNlVXJsLCBzdGFydFRpbWUsIHBhcmFtZXRlcnMsIG9wdF9leHBlcmltZW50SWRzKSB7XG4gIC8vIFRPRE86IE1heWJlIGFkZCBjaGVja3MgaW4gY2FzZSB0aGVzZSBwcm9taXNlcyBmYWlsLlxuICBjb25zdCBibG9ja0xldmVsUGFyYW1ldGVycyA9IGdvb2dsZUJsb2NrUGFyYW1ldGVycyhhNGEsIG9wdF9leHBlcmltZW50SWRzKTtcbiAgcmV0dXJuIGdvb2dsZVBhZ2VQYXJhbWV0ZXJzKGE0YSwgc3RhcnRUaW1lKVxuICAgICAgLnRoZW4ocGFnZUxldmVsUGFyYW1ldGVycyA9PiB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24ocGFyYW1ldGVycywgYmxvY2tMZXZlbFBhcmFtZXRlcnMsIHBhZ2VMZXZlbFBhcmFtZXRlcnMpO1xuICAgICAgICByZXR1cm4gdHJ1bmNBbmRUaW1lVXJsKGJhc2VVcmwsIHBhcmFtZXRlcnMsIHN0YXJ0VGltZSk7XG4gICAgICB9KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gYmFzZVVybFxuICogQHBhcmFtIHshT2JqZWN0PHN0cmluZyxudWxsfG51bWJlcnxzdHJpbmc+fSBwYXJhbWV0ZXJzXG4gKiBAcGFyYW0ge251bWJlcn0gc3RhcnRUaW1lXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnVuY0FuZFRpbWVVcmwoYmFzZVVybCwgcGFyYW1ldGVycywgc3RhcnRUaW1lKSB7XG4gIHJldHVybiBidWlsZFVybChcbiAgICAgIGJhc2VVcmwsIHBhcmFtZXRlcnMsIE1BWF9VUkxfTEVOR1RIIC0gMTAsIFRSVU5DQVRJT05fUEFSQU0pXG4gICAgKyAnJmR0ZD0nICsgZWxhcHNlZFRpbWVXaXRoQ2VpbGluZyhEYXRlLm5vdygpLCBzdGFydFRpbWUpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtudW1iZXJ9XG4gKi9cbmZ1bmN0aW9uIGlmcmFtZU5lc3RpbmdEZXB0aCh3aW4pIHtcbiAgbGV0IHcgPSB3aW47XG4gIGxldCBkZXB0aCA9IDA7XG4gIHdoaWxlICh3ICE9IHcucGFyZW50ICYmIGRlcHRoIDwgMTAwKSB7XG4gICAgdyA9IHcucGFyZW50O1xuICAgIGRlcHRoKys7XG4gIH1cbiAgZGV2KCkuYXNzZXJ0KHcgPT0gd2luLnRvcCk7XG4gIHJldHVybiBkZXB0aDtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7bnVtYmVyfVxuICovXG5mdW5jdGlvbiBnZXRIaXN0b3J5TGVuZ3RoKHdpbikge1xuICAvLyBXZSBoYXZlIHNlZW4gY2FzZXMgd2hlcmUgYWNjZXNzaW5nIGhpc3RvcnkgbGVuZ3RoIGNhdXNlcyBlcnJvcnMuXG4gIHRyeSB7XG4gICAgcmV0dXJuIHdpbi5oaXN0b3J5Lmxlbmd0aDtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiAwO1xuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHJldHVybiB7c3RyaW5nfSBob3N0bmFtZSBwb3J0aW9uIG9mIHVybFxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0SG9zdCh1cmwpIHtcbiAgcmV0dXJuICgvXig/Omh0dHBzPzpcXC9cXC8pPyhbXlxcL1xcPzpdKykvaS5leGVjKHVybCkgfHwgW10pWzFdIHx8IHVybDtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7P3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gdG9wV2luZG93VXJsT3JEb21haW4od2luKSB7XG4gIGNvbnN0IHthbmNlc3Rvck9yaWdpbnN9ID0gd2luLmxvY2F0aW9uO1xuICBpZiAoYW5jZXN0b3JPcmlnaW5zKSB7XG4gICAgY29uc3Qge29yaWdpbn0gPSB3aW4ubG9jYXRpb247XG4gICAgY29uc3QgdG9wT3JpZ2luID0gYW5jZXN0b3JPcmlnaW5zW2FuY2VzdG9yT3JpZ2lucy5sZW5ndGggLSAxXTtcbiAgICBpZiAob3JpZ2luID09IHRvcE9yaWdpbikge1xuICAgICAgcmV0dXJuIHdpbi50b3AubG9jYXRpb24uaG9zdG5hbWU7XG4gICAgfVxuICAgIGNvbnN0IHNlY29uZEZyb21Ub3AgPSBzZWNvbmRXaW5kb3dGcm9tVG9wKHdpbik7XG4gICAgaWYgKHNlY29uZEZyb21Ub3AgPT0gd2luIHx8XG4gICAgICAgIG9yaWdpbiA9PSBhbmNlc3Rvck9yaWdpbnNbYW5jZXN0b3JPcmlnaW5zLmxlbmd0aCAtIDJdKSB7XG4gICAgICByZXR1cm4gZXh0cmFjdEhvc3Qoc2Vjb25kRnJvbVRvcC4vKk9LKi9kb2N1bWVudC5yZWZlcnJlcik7XG4gICAgfVxuICAgIHJldHVybiBleHRyYWN0SG9zdCh0b3BPcmlnaW4pO1xuICB9IGVsc2Uge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gd2luLnRvcC5sb2NhdGlvbi5ob3N0bmFtZTtcbiAgICB9IGNhdGNoIChlKSB7fVxuICAgIGNvbnN0IHNlY29uZEZyb21Ub3AgPSBzZWNvbmRXaW5kb3dGcm9tVG9wKHdpbik7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBleHRyYWN0SG9zdChzZWNvbmRGcm9tVG9wLi8qT0sqL2RvY3VtZW50LnJlZmVycmVyKTtcbiAgICB9IGNhdGNoIChlKSB7fVxuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFXaW5kb3d9XG4gKi9cbmZ1bmN0aW9uIHNlY29uZFdpbmRvd0Zyb21Ub3Aod2luKSB7XG4gIGxldCBzZWNvbmRGcm9tVG9wID0gd2luO1xuICBsZXQgZGVwdGggPSAwO1xuICB3aGlsZSAoc2Vjb25kRnJvbVRvcC5wYXJlbnQgIT0gc2Vjb25kRnJvbVRvcC5wYXJlbnQucGFyZW50ICYmXG4gICAgICAgIGRlcHRoIDwgMTAwKSB7XG4gICAgc2Vjb25kRnJvbVRvcCA9IHNlY29uZEZyb21Ub3AucGFyZW50O1xuICAgIGRlcHRoKys7XG4gIH1cbiAgZGV2KCkuYXNzZXJ0KHNlY29uZEZyb21Ub3AucGFyZW50ID09IHdpbi50b3ApO1xuICByZXR1cm4gc2Vjb25kRnJvbVRvcDtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge251bWJlcn0gdGltZVxuICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0XG4gKiBAcmV0dXJuIHsobnVtYmVyfHN0cmluZyl9XG4gKi9cbmZ1bmN0aW9uIGVsYXBzZWRUaW1lV2l0aENlaWxpbmcodGltZSwgc3RhcnQpIHtcbiAgY29uc3QgZHVyYXRpb24gPSB0aW1lIC0gc3RhcnQ7XG4gIGlmIChkdXJhdGlvbiA+PSAxZTYpIHtcbiAgICByZXR1cm4gJ00nO1xuICB9IGVsc2UgaWYgKGR1cmF0aW9uID49IDApIHtcbiAgICByZXR1cm4gZHVyYXRpb247XG4gIH1cbiAgcmV0dXJuICctTSc7XG59XG5cbi8qKlxuICogYG5vZGVPckRvY2AgbXVzdCBiZSBwYXNzZWQgZm9yIGNvcnJlY3QgYmVoYXZpb3IgaW4gc2hhZG93IEFNUCAoUFdBKSBjYXNlLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF9jaWRcbiAqIEByZXR1cm4ge251bWJlcn0gVGhlIGNvcnJlbGF0b3IuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb3JyZWxhdG9yKHdpbiwgZWxlbWVudE9yQW1wRG9jLCBvcHRfY2lkKSB7XG4gIGlmICghd2luLmFtcEFkUGFnZUNvcnJlbGF0b3IpIHtcbiAgICB3aW4uYW1wQWRQYWdlQ29ycmVsYXRvciA9IGlzRXhwZXJpbWVudE9uKHdpbiwgJ2V4cC1uZXctY29ycmVsYXRvcicpID9cbiAgICAgIE1hdGguZmxvb3IoNDUwMzU5OTYyNzM3MDQ5NiAqIE1hdGgucmFuZG9tKCkpIDpcbiAgICAgIG1ha2VDb3JyZWxhdG9yKFxuICAgICAgICAgIFNlcnZpY2VzLmRvY3VtZW50SW5mb0ZvckRvYyhlbGVtZW50T3JBbXBEb2MpLnBhZ2VWaWV3SWQsIG9wdF9jaWQpO1xuICB9XG4gIHJldHVybiB3aW4uYW1wQWRQYWdlQ29ycmVsYXRvcjtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gcGFnZVZpZXdJZFxuICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfY2xpZW50SWRcbiAqIEByZXR1cm4ge251bWJlcn1cbiAqL1xuZnVuY3Rpb24gbWFrZUNvcnJlbGF0b3IocGFnZVZpZXdJZCwgb3B0X2NsaWVudElkKSB7XG4gIGNvbnN0IHBhZ2VWaWV3SWROdW1lcmljID0gTnVtYmVyKHBhZ2VWaWV3SWQgfHwgMCk7XG4gIGlmIChvcHRfY2xpZW50SWQpIHtcbiAgICByZXR1cm4gcGFnZVZpZXdJZE51bWVyaWMgKyAoKG9wdF9jbGllbnRJZC5yZXBsYWNlKC9cXEQvZywgJycpICUgMWU2KSAqIDFlNik7XG4gIH0gZWxzZSB7XG4gICAgLy8gSW4gdGhpcyBjYXNlLCBwYWdlVmlld0lkTnVtZXJpYyBpcyBvbmx5IDQgZGlnaXRzID0+IHRvbyBsb3cgZW50cm9weVxuICAgIC8vIHRvIGJlIHVzZWZ1bCBhcyBhIHBhZ2UgY29ycmVsYXRvci4gIFNvIHN5bnRoZXNpemUgb25lIGZyb20gc2NyYXRjaC5cbiAgICAvLyA0NTAzNTk5NjI3MzcwNDk2ID09IDJeNTIuICBUaGUgZ3VhcmFudGVlZCByYW5nZSBvZiBKUyBOdW1iZXIgaXMgYXQgbGVhc3RcbiAgICAvLyAyXjUzIC0gMS5cbiAgICByZXR1cm4gTWF0aC5mbG9vcig0NTAzNTk5NjI3MzcwNDk2ICogTWF0aC5yYW5kb20oKSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIENvbGxlY3QgYWRkaXRpb25hbCBkaW1lbnNpb25zIGZvciB0aGUgYnJkaW0gcGFyYW1ldGVyLlxuICogQHBhcmFtIHshV2luZG93fSB3aW4gVGhlIHdpbmRvdyBmb3Igd2hpY2ggd2UgcmVhZCB0aGUgYnJvd3NlciBkaW1lbnNpb25zLlxuICogQHBhcmFtIHt7d2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXJ9fG51bGx9IHZpZXdwb3J0U2l6ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGRpdGlvbmFsRGltZW5zaW9ucyh3aW4sIHZpZXdwb3J0U2l6ZSkge1xuICAvLyBTb21lIGJyb3dzZXJzIHRocm93IGVycm9ycyBvbiBzb21lIG9mIHRoZXNlLlxuICBsZXQgc2NyZWVuWCwgc2NyZWVuWSwgb3V0ZXJXaWR0aCwgb3V0ZXJIZWlnaHQsIGlubmVyV2lkdGgsIGlubmVySGVpZ2h0O1xuICB0cnkge1xuICAgIHNjcmVlblggPSB3aW4uc2NyZWVuWDtcbiAgICBzY3JlZW5ZID0gd2luLnNjcmVlblk7XG4gIH0gY2F0Y2ggKGUpIHt9XG4gIHRyeSB7XG4gICAgb3V0ZXJXaWR0aCA9IHdpbi5vdXRlcldpZHRoO1xuICAgIG91dGVySGVpZ2h0ID0gd2luLm91dGVySGVpZ2h0O1xuICB9IGNhdGNoIChlKSB7fVxuICB0cnkge1xuICAgIGlubmVyV2lkdGggPSB2aWV3cG9ydFNpemUud2lkdGg7XG4gICAgaW5uZXJIZWlnaHQgPSB2aWV3cG9ydFNpemUuaGVpZ2h0O1xuICB9IGNhdGNoIChlKSB7fVxuICByZXR1cm4gW3dpbi5zY3JlZW5MZWZ0LFxuICAgIHdpbi5zY3JlZW5Ub3AsXG4gICAgc2NyZWVuWCxcbiAgICBzY3JlZW5ZLFxuICAgIHdpbi5zY3JlZW4gPyB3aW4uc2NyZWVuLmF2YWlsV2lkdGggOiB1bmRlZmluZWQsXG4gICAgd2luLnNjcmVlbiA/IHdpbi5zY3JlZW4uYXZhaWxUb3AgOiB1bmRlZmluZWQsXG4gICAgb3V0ZXJXaWR0aCxcbiAgICBvdXRlckhlaWdodCxcbiAgICBpbm5lcldpZHRoLFxuICAgIGlubmVySGVpZ2h0XS5qb2luKCk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhbXAtYW5hbHl0aWNzIGNvbmZpZyBmb3IgYSBuZXcgQ1NJIHRyaWdnZXIuXG4gKiBAcGFyYW0ge3N0cmluZ30gb24gVGhlIG5hbWUgb2YgdGhlIGFuYWx5dGljcyB0cmlnZ2VyLlxuICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn0gcGFyYW1zIFBhcmFtcyB0byBiZSBpbmNsdWRlZCBvbiB0aGUgcGluZy5cbiAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICovXG5mdW5jdGlvbiBjc2lUcmlnZ2VyKG9uLCBwYXJhbXMpIHtcbiAgcmV0dXJuIGRpY3Qoe1xuICAgICdvbic6IG9uLFxuICAgICdyZXF1ZXN0JzogJ2NzaScsXG4gICAgJ3NhbXBsZVNwZWMnOiB7XG4gICAgICAvLyBQaW5ncyBhcmUgc2FtcGxlZCBvbiBhIHBlci1wYWdldmlldyBiYXNpcy4gQSBwcmVmaXggaXMgaW5jbHVkZWQgaW4gdGhlXG4gICAgICAvLyBzYW1wbGVPbiBzcGVjIHNvIHRoYXQgdGhlIGhhc2ggaXMgb3J0aG9nb25hbCB0byBhbnkgb3RoZXIgc2FtcGxpbmcgaW5cbiAgICAgIC8vIGFtcC5cbiAgICAgICdzYW1wbGVPbic6ICdhNGEtY3NpLSR7cGFnZVZpZXdJZH0nLFxuICAgICAgJ3RocmVzaG9sZCc6IDEsIC8vIDElIHNhbXBsZVxuICAgIH0sXG4gICAgJ3NlbGVjdG9yJzogJ2FtcC1hZCcsXG4gICAgJ3NlbGVjdGlvbk1ldGhvZCc6ICdjbG9zZXN0JyxcbiAgICAnZXh0cmFVcmxQYXJhbXMnOiBwYXJhbXMsXG4gIH0pO1xufVxuXG4vKipcbiAqIFJldHVybnMgYW1wLWFuYWx5dGljcyBjb25maWcgZm9yIEdvb2dsZSBhZHMgbmV0d29yayBpbXBscy5cbiAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3NpQW1wQW5hbHl0aWNzQ29uZmlnKCkge1xuICByZXR1cm4gZGljdCh7XG4gICAgJ3JlcXVlc3RzJzoge1xuICAgICAgJ2NzaSc6ICdodHRwczovL2NzaS5nc3RhdGljLmNvbS9jc2k/JyxcbiAgICB9LFxuICAgICd0cmFuc3BvcnQnOiB7J3hocnBvc3QnOiBmYWxzZX0sXG4gICAgJ3RyaWdnZXJzJzoge1xuICAgICAgJ2FkUmVxdWVzdFN0YXJ0JzogY3NpVHJpZ2dlcignYWQtcmVxdWVzdC1zdGFydCcsIHtcbiAgICAgICAgLy8gYWZzID0+IGFkIGZldGNoIHN0YXJ0XG4gICAgICAgICdtZXQuYTRhJzogJ2Fmc19sdnQuJHt2aWV3ZXJMYXN0VmlzaWJsZVRpbWV9fmFmcy4ke3RpbWV9JyxcbiAgICAgIH0pLFxuICAgICAgJ2FkUmVzcG9uc2VFbmQnOiBjc2lUcmlnZ2VyKCdhZC1yZXNwb25zZS1lbmQnLCB7XG4gICAgICAgIC8vIGFmZSA9PiBhZCBmZXRjaCBlbmRcbiAgICAgICAgJ21ldC5hNGEnOiAnYWZlLiR7dGltZX0nLFxuICAgICAgfSksXG4gICAgICAnYWRSZW5kZXJTdGFydCc6IGNzaVRyaWdnZXIoJ2FkLXJlbmRlci1zdGFydCcsIHtcbiAgICAgICAgLy8gYXN0ID0+IGFkIHNjaGVkdWxlIHRpbWVcbiAgICAgICAgLy8gYXJzID0+IGFkIHJlbmRlciBzdGFydFxuICAgICAgICAnbWV0LmE0YSc6XG4gICAgICAgICAgICAnYXN0LiR7c2NoZWR1bGVUaW1lfX5hcnNfbHZ0LiR7dmlld2VyTGFzdFZpc2libGVUaW1lfX5hcnMuJHt0aW1lfScsXG4gICAgICAgICdxcWlkJzogJyR7cXFpZH0nLFxuICAgICAgfSksXG4gICAgICAnYWRJZnJhbWVMb2FkZWQnOiBjc2lUcmlnZ2VyKCdhZC1pZnJhbWUtbG9hZGVkJywge1xuICAgICAgICAvLyBhaWwgPT4gYWQgaWZyYW1lIGxvYWRlZFxuICAgICAgICAnbWV0LmE0YSc6ICdhaWwuJHt0aW1lfScsXG4gICAgICB9KSxcbiAgICB9LFxuICAgICdleHRyYVVybFBhcmFtcyc6IHtcbiAgICAgICdzJzogJ2FtcGFkJyxcbiAgICAgICdjdHgnOiAnMicsXG4gICAgICAnYyc6ICcke2NvcnJlbGF0b3J9JyxcbiAgICAgICdzbG90SWQnOiAnJHtzbG90SWR9JyxcbiAgICAgIC8vIFRpbWUgdGhhdCB0aGUgYmVhY29uIHdhcyBhY3R1YWxseSBzZW50LiBOb3RlIHRoYXQgdGhlcmUgY2FuIGJlIGRlbGF5c1xuICAgICAgLy8gYmV0d2VlbiB0aGUgdGltZSBhdCB3aGljaCB0aGUgZXZlbnQgaXMgZmlyZWQgYW5kIHdoZW4gJHtub3dNc30gaXNcbiAgICAgIC8vIGV2YWx1YXRlZCB3aGVuIHRoZSBVUkwgaXMgYnVpbHQgYnkgYW1wLWFuYWx5dGljcy5cbiAgICAgICdwdWlkJzogJyR7cmVxdWVzdENvdW50fX4ke3RpbWVzdGFtcH0nLFxuICAgIH0sXG4gIH0pO1xufVxuXG4vKipcbiAqIFJldHVybnMgdmFyaWFibGVzIHRvIGJlIGluY2x1ZGVkIGluIHRoZSBhbXAtYW5hbHl0aWNzIGV2ZW50IGZvciBBNEEuXG4gKiBAcGFyYW0ge3N0cmluZ30gYW5hbHl0aWNzVHJpZ2dlciBUaGUgbmFtZSBvZiB0aGUgYW5hbHl0aWNzIHRyaWdnZXIuXG4gKiBAcGFyYW0geyFBTVAuQmFzZUVsZW1lbnR9IGE0YSBUaGUgQTRBIGVsZW1lbnQuXG4gKiBAcGFyYW0gez9zdHJpbmd9IHFxaWQgVGhlIHF1ZXJ5IElEIG9yIG51bGwgaWYgdGhlIHF1ZXJ5IElEIGhhcyBub3QgYmVlbiBzZXRcbiAqICAgICB5ZXQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDc2lBbXBBbmFseXRpY3NWYXJpYWJsZXMoYW5hbHl0aWNzVHJpZ2dlciwgYTRhLCBxcWlkKSB7XG4gIGNvbnN0IHt3aW59ID0gYTRhO1xuICBjb25zdCBhbXBkb2MgPSBhNGEuZ2V0QW1wRG9jKCk7XG4gIGNvbnN0IHZpZXdlciA9IFNlcnZpY2VzLnZpZXdlckZvckRvYyhhbXBkb2MpO1xuICBjb25zdCBuYXZTdGFydCA9IGdldE5hdlN0YXJ0KHdpbik7XG4gIGNvbnN0IHZhcnMgPSB7XG4gICAgJ2NvcnJlbGF0b3InOiBnZXRDb3JyZWxhdG9yKHdpbiwgYW1wZG9jKSxcbiAgICAnc2xvdElkJzogYTRhLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWFtcC1zbG90LWluZGV4JyksXG4gICAgJ3ZpZXdlckxhc3RWaXNpYmxlVGltZSc6IHZpZXdlci5nZXRMYXN0VmlzaWJsZVRpbWUoKSAtIG5hdlN0YXJ0LFxuICB9O1xuICBpZiAocXFpZCkge1xuICAgIHZhcnNbJ3FxaWQnXSA9IHFxaWQ7XG4gIH1cbiAgaWYgKGFuYWx5dGljc1RyaWdnZXIgPT0gJ2FkLXJlbmRlci1zdGFydCcpIHtcbiAgICB2YXJzWydzY2hlZHVsZVRpbWUnXSA9IGE0YS5lbGVtZW50LmxheW91dFNjaGVkdWxlVGltZSAtIG5hdlN0YXJ0O1xuICB9XG4gIHJldHVybiB2YXJzO1xufVxuXG4vKipcbiAqIEV4dHJhY3RzIGNvbmZpZ3VyYXRpb24gdXNlZCB0byBidWlsZCBhbXAtYW5hbHl0aWNzIGVsZW1lbnQgZm9yIGFjdGl2ZSB2aWV3LlxuICpcbiAqIEBwYXJhbSB7IS4uLy4uLy4uL2V4dGVuc2lvbnMvYW1wLWE0YS8wLjEvYW1wLWE0YS5BbXBBNEF9IGE0YVxuICogQHBhcmFtIHshLi4vLi4vLi4vc3JjL3V0aWxzL3hoci11dGlscy5GZXRjaFJlc3BvbnNlSGVhZGVyc30gcmVzcG9uc2VIZWFkZXJzXG4gKiAgIFhIUiBzZXJ2aWNlIEZldGNoUmVzcG9uc2VIZWFkZXJzIG9iamVjdCBjb250YWluaW5nIHRoZSByZXNwb25zZVxuICogICBoZWFkZXJzLlxuICogQHJldHVybiB7P0pzb25PYmplY3R9IGNvbmZpZyBvciBudWxsIGlmIGludmFsaWQvbWlzc2luZy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RBbXBBbmFseXRpY3NDb25maWcoYTRhLCByZXNwb25zZUhlYWRlcnMpIHtcbiAgaWYgKCFyZXNwb25zZUhlYWRlcnMuaGFzKEFNUF9BTkFMWVRJQ1NfSEVBREVSKSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHRyeSB7XG4gICAgY29uc3QgYW5hbHl0aWNzQ29uZmlnID1cbiAgICAgICAgcGFyc2VKc29uKHJlc3BvbnNlSGVhZGVycy5nZXQoQU1QX0FOQUxZVElDU19IRUFERVIpKTtcbiAgICBkZXYoKS5hc3NlcnQoQXJyYXkuaXNBcnJheShhbmFseXRpY3NDb25maWdbJ3VybCddKSk7XG4gICAgY29uc3QgdXJscyA9IGFuYWx5dGljc0NvbmZpZ1sndXJsJ107XG4gICAgaWYgKCF1cmxzLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgY29uZmlnID0gLyoqIEB0eXBlIHtKc29uT2JqZWN0fSovICh7XG4gICAgICAndHJhbnNwb3J0JzogeydiZWFjb24nOiBmYWxzZSwgJ3hocnBvc3QnOiBmYWxzZX0sXG4gICAgICAndHJpZ2dlcnMnOiB7XG4gICAgICAgICdjb250aW51b3VzVmlzaWJsZSc6IHtcbiAgICAgICAgICAnb24nOiAndmlzaWJsZScsXG4gICAgICAgICAgJ3Zpc2liaWxpdHlTcGVjJzoge1xuICAgICAgICAgICAgJ3NlbGVjdG9yJzogJ2FtcC1hZCcsXG4gICAgICAgICAgICAnc2VsZWN0aW9uTWV0aG9kJzogJ2Nsb3Nlc3QnLFxuICAgICAgICAgICAgJ3Zpc2libGVQZXJjZW50YWdlTWluJzogNTAsXG4gICAgICAgICAgICAnY29udGludW91c1RpbWVNaW4nOiAxMDAwLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gRGlzY292ZXIgYW5kIGJ1aWxkIHZpc2liaWxpdHkgZW5kcG9pbnRzLlxuICAgIGNvbnN0IHJlcXVlc3RzID0gZGljdCgpO1xuICAgIGZvciAobGV0IGlkeCA9IDE7IGlkeCA8PSB1cmxzLmxlbmd0aDsgaWR4KyspIHtcbiAgICAgIC8vIFRPRE86IEVuc3VyZSB1cmwgaXMgdmFsaWQgYW5kIG5vdCBmcmVlZm9ybSBKUz9cbiAgICAgIHJlcXVlc3RzW2B2aXNpYmlsaXR5JHtpZHh9YF0gPSBgJHt1cmxzW2lkeCAtIDFdfWA7XG4gICAgfVxuICAgIC8vIFNlY3VyaXR5IHJldmlldyBuZWVkZWQgaGVyZS5cbiAgICBjb25maWdbJ3JlcXVlc3RzJ10gPSByZXF1ZXN0cztcbiAgICBjb25maWdbJ3RyaWdnZXJzJ11bJ2NvbnRpbnVvdXNWaXNpYmxlJ11bJ3JlcXVlc3QnXSA9XG4gICAgICAgIE9iamVjdC5rZXlzKHJlcXVlc3RzKTtcbiAgICByZXR1cm4gY29uZmlnO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBkZXYoKS5lcnJvcignQU1QLUE0QScsICdJbnZhbGlkIGFuYWx5dGljcycsIGVycixcbiAgICAgICAgcmVzcG9uc2VIZWFkZXJzLmdldChBTVBfQU5BTFlUSUNTX0hFQURFUikpO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIEFkZCBuZXcgZXhwZXJpbWVudCBJRHMgdG8gYSAocG9zc2libHkgZW1wdHkpIGV4aXN0aW5nIHNldCBvZiBleHBlcmltZW50IElEcy5cbiAqIFRoZSB7QGNvZGUgY3VycmVudElkU3RyaW5nfSBtYXkgYmUge0Bjb2RlIG51bGx9IG9yIHtAY29kZSAnJ30sIGJ1dCBpZiBpdCBpc1xuICogcG9wdWxhdGVkLCBpdCBtdXN0IGNvbnRhaW4gYSBjb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiBpbnRlZ2VyIGV4cGVyaW1lbnQgSURzXG4gKiAocGVyIHtAY29kZSBwYXJzZUV4cGVyaW1lbnRJZHMoKX0pLiAgUmV0dXJucyB0aGUgbmV3IHNldCBvZiBJRHMsIGVuY29kZWRcbiAqIGFzIGEgY29tbWEtc2VwYXJhdGVkIGxpc3QuICBEb2VzIG5vdCBkZS1kdXBsaWNhdGUgSUQgZW50cmllcy5cbiAqXG4gKiBAcGFyYW0geyFBcnJheTxzdHJpbmc+fSBuZXdJZHMgSURzIHRvIG1lcmdlIGluLiBTaG91bGQgY29udGFpbiBzdHJpbmdpZmllZFxuICogICAgIGludGVnZXIgKGJhc2UgMTApIGV4cGVyaW1lbnQgSURzLlxuICogQHBhcmFtIHs/c3RyaW5nfSBjdXJyZW50SWRTdHJpbmcgIElmIHByZXNlbnQsIGEgc3RyaW5nIGNvbnRhaW5pbmcgYVxuICogICBjb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiBpbnRlZ2VyIGV4cGVyaW1lbnQgSURzLlxuICogQHJldHVybiB7c3RyaW5nfSAgTmV3IGV4cGVyaW1lbnQgbGlzdCBzdHJpbmcsIGluY2x1ZGluZyBuZXdJZCBpZmYgaXQgaXNcbiAqICAgYSB2YWxpZCAoaW50ZWdlcikgZXhwZXJpbWVudCBJRC5cbiAqIEBzZWUgcGFyc2VFeHBlcmltZW50SWRzLCB2YWxpZGF0ZUV4cGVyaW1lbnRJZHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlRXhwZXJpbWVudElkcyhuZXdJZHMsIGN1cnJlbnRJZFN0cmluZykge1xuICBjb25zdCBuZXdJZFN0cmluZyA9IG5ld0lkcy5maWx0ZXIobmV3SWQgPT4gTnVtYmVyKG5ld0lkKSkuam9pbignLCcpO1xuICBjdXJyZW50SWRTdHJpbmcgPSBjdXJyZW50SWRTdHJpbmcgfHwgJyc7XG4gIHJldHVybiBjdXJyZW50SWRTdHJpbmcgKyAoY3VycmVudElkU3RyaW5nICYmIG5ld0lkU3RyaW5nID8gJywnIDogJycpXG4gICAgICArIG5ld0lkU3RyaW5nO1xufVxuXG4vKipcbiAqIEFkZHMgdHdvIENTSSBzaWduYWxzIHRvIHRoZSBnaXZlbiBhbXAtYW5hbHl0aWNzIGNvbmZpZ3VyYXRpb24gb2JqZWN0LCBvbmVcbiAqIGZvciByZW5kZXItc3RhcnQsIGFuZCBvbmUgZm9yIGluaS1sb2FkLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50IFRoZSBhZCBzbG90LlxuICogQHBhcmFtIHshSnNvbk9iamVjdH0gY29uZmlnIFRoZSBvcmlnaW5hbCBjb25maWcgb2JqZWN0LlxuICogQHBhcmFtIHs/c3RyaW5nfSBxcWlkXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGlzVmVyaWZpZWRBbXBDcmVhdGl2ZVxuICogQHJldHVybiB7P0pzb25PYmplY3R9IGNvbmZpZyBvciBudWxsIGlmIGludmFsaWQvbWlzc2luZy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZENzaVNpZ25hbHNUb0FtcEFuYWx5dGljc0NvbmZpZyhcbiAgd2luLCBlbGVtZW50LCBjb25maWcsIHFxaWQsIGlzVmVyaWZpZWRBbXBDcmVhdGl2ZSkge1xuICAvLyBBZGQgQ1NJIHBpbmdiYWNrcy5cbiAgY29uc3QgY29ycmVsYXRvciA9IGdldENvcnJlbGF0b3Iod2luLCBlbGVtZW50KTtcbiAgY29uc3Qgc2xvdElkID0gTnVtYmVyKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWFtcC1zbG90LWluZGV4JykpO1xuICBjb25zdCBlaWRzID0gZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgZWxlbWVudC5nZXRBdHRyaWJ1dGUoRVhQRVJJTUVOVF9BVFRSSUJVVEUpKTtcbiAgY29uc3QgYWRUeXBlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKTtcbiAgY29uc3QgaW5pdFRpbWUgPVxuICAgICAgTnVtYmVyKGdldFRpbWluZ0RhdGFTeW5jKHdpbiwgJ25hdmlnYXRpb25TdGFydCcpIHx8IERhdGUubm93KCkpO1xuICBjb25zdCBkZWx0YVRpbWUgPSBNYXRoLnJvdW5kKHdpbi5wZXJmb3JtYW5jZSAmJiB3aW4ucGVyZm9ybWFuY2Uubm93ID9cbiAgICB3aW4ucGVyZm9ybWFuY2Uubm93KCkgOiAoRGF0ZS5ub3coKSAtIGluaXRUaW1lKSk7XG4gIGNvbnN0IGJhc2VDc2lVcmwgPSAnaHR0cHM6Ly9jc2kuZ3N0YXRpYy5jb20vY3NpP3M9YTRhJyArXG4gICAgICBgJmM9JHtjb3JyZWxhdG9yfSZzbG90SWQ9JHtzbG90SWR9JnFxaWQuJHtzbG90SWR9PSR7cXFpZH1gICtcbiAgICAgIGAmZHQ9JHtpbml0VGltZX1gICtcbiAgICAgIChlaWRzICE9ICdudWxsJyA/IGAmZS4ke3Nsb3RJZH09JHtlaWRzfWAgOiAnJykgK1xuICAgICAgYCZybHM9JGludGVybmFsUnVudGltZVZlcnNpb24kJmFkdC4ke3Nsb3RJZH09JHthZFR5cGV9YDtcbiAgY29uc3QgaXNBbXBTdWZmaXggPSBpc1ZlcmlmaWVkQW1wQ3JlYXRpdmUgPyAnRnJpZW5kbHknIDogJ0Nyb3NzRG9tYWluJztcbiAgY29uZmlnWyd0cmlnZ2VycyddWydjb250aW51b3VzVmlzaWJsZUluaUxvYWQnXSA9IHtcbiAgICAnb24nOiAnaW5pLWxvYWQnLFxuICAgICdzZWxlY3Rvcic6ICdhbXAtYWQnLFxuICAgICdzZWxlY3Rpb25NZXRob2QnOiAnY2xvc2VzdCcsXG4gICAgJ3JlcXVlc3QnOiAnaW5pTG9hZENzaScsXG4gIH07XG4gIGNvbmZpZ1sndHJpZ2dlcnMnXVsnY29udGludW91c1Zpc2libGVSZW5kZXJTdGFydCddID0ge1xuICAgICdvbic6ICdyZW5kZXItc3RhcnQnLFxuICAgICdzZWxlY3Rvcic6ICdhbXAtYWQnLFxuICAgICdzZWxlY3Rpb25NZXRob2QnOiAnY2xvc2VzdCcsXG4gICAgJ3JlcXVlc3QnOiAncmVuZGVyU3RhcnRDc2knLFxuICB9O1xuICBjb25maWdbJ3JlcXVlc3RzJ11bJ2luaUxvYWRDc2knXSA9IGJhc2VDc2lVcmwgK1xuICAgICAgYCZtZXQuYTRhLiR7c2xvdElkfT1pbmlMb2FkQ3NpJHtpc0FtcFN1ZmZpeH0uJHtkZWx0YVRpbWV9YDtcbiAgY29uZmlnWydyZXF1ZXN0cyddWydyZW5kZXJTdGFydENzaSddID0gYmFzZUNzaVVybCArXG4gICAgICBgJm1ldC5hNGEuJHtzbG90SWR9PXJlbmRlclN0YXJ0Q3NpJHtpc0FtcFN1ZmZpeH0uJHtkZWx0YVRpbWV9YDtcblxuICAvLyBBZGQgQ1NJIHBpbmcgZm9yIHZpc2liaWxpdHkuXG4gIGNvbmZpZ1sncmVxdWVzdHMnXVsndmlzaWJpbGl0eUNzaSddID0gYmFzZUNzaVVybCArXG4gICAgICBgJm1ldC5hNGEuJHtzbG90SWR9PXZpc2liaWxpdHlDc2kuJHtkZWx0YVRpbWV9YDtcbiAgY29uZmlnWyd0cmlnZ2VycyddWydjb250aW51b3VzVmlzaWJsZSddWydyZXF1ZXN0J10ucHVzaCgndmlzaWJpbGl0eUNzaScpO1xuICByZXR1cm4gY29uZmlnO1xufVxuXG4vKipcbiAqIFJldHVybnMgYW4gYXJyYXkgb2YgdHdvLWxldHRlciBjb2RlcyByZXByZXNlbnRpbmcgdGhlIGFtcC1hZCBjb250YWluZXJzXG4gKiBlbmNsb3NpbmcgdGhlIGdpdmVuIGFkIGVsZW1lbnQuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudH0gYWRFbGVtZW50XG4gKiBAcmV0dXJuIHshQXJyYXk8c3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVuY2xvc2luZ0NvbnRhaW5lclR5cGVzKGFkRWxlbWVudCkge1xuICBjb25zdCBjb250YWluZXJUeXBlU2V0ID0ge307XG4gIGZvciAobGV0IGVsID0gYWRFbGVtZW50LnBhcmVudEVsZW1lbnQsIGNvdW50ZXIgPSAwO1xuICAgIGVsICYmIGNvdW50ZXIgPCAyMDsgZWwgPSBlbC5wYXJlbnRFbGVtZW50LCBjb3VudGVyKyspIHtcbiAgICBjb25zdCB0YWdOYW1lID0gZWwudGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xuICAgIGlmIChWYWxpZEFkQ29udGFpbmVyVHlwZXNbdGFnTmFtZV0pIHtcbiAgICAgIGNvbnRhaW5lclR5cGVTZXRbVmFsaWRBZENvbnRhaW5lclR5cGVzW3RhZ05hbWVdXSA9IHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBPYmplY3Qua2V5cyhjb250YWluZXJUeXBlU2V0KTtcbn1cblxuLyoqXG4gKiBBcHBlbmRzIHBhcmFtZXRlciB0byBhZCByZXF1ZXN0IGluZGljYXRpbmcgZXJyb3Igc3RhdGUgc28gbG9uZyBhcyBlcnJvclxuICogcGFyYW1ldGVyIGlzIG5vdCBhbHJlYWR5IHByZXNlbnQgb3IgdXJsIGhhcyBiZWVuIHRydW5jYXRlZC5cbiAqIEBwYXJhbSB7c3RyaW5nfSBhZFVybCB1c2VkIGZvciBuZXR3b3JrIHJlcXVlc3RcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXJhbWV0ZXJWYWx1ZSB0byBiZSBhcHBlbmRlZFxuICogQHJldHVybiB7c3RyaW5nfHVuZGVmaW5lZH0gcG90ZW50aWFsbHkgbW9kaWZpZWQgdXJsLCB1bmRlZmluZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1heWJlQXBwZW5kRXJyb3JQYXJhbWV0ZXIoYWRVcmwsIHBhcmFtZXRlclZhbHVlKSB7XG4gIGRldigpLmFzc2VydCghIWFkVXJsICYmICEhcGFyYW1ldGVyVmFsdWUpO1xuICAvLyBBZGQgcGFyYW1ldGVyIGluZGljYXRpbmcgZXJyb3Igc28gbG9uZyBhcyB0aGUgdXJsIGhhcyBub3QgYWxyZWFkeSBiZWVuXG4gIC8vIHRydW5jYXRlZCBhbmQgZXJyb3IgcGFyYW1ldGVyIGlzIG5vdCBhbHJlYWR5IHByZXNlbnQuICBOb3RlIHRoYXQgd2UgYXNzdW1lXG4gIC8vIHRoYXQgYWRkZWQsIGVycm9yIHBhcmFtZXRlciBsZW5ndGggd2lsbCBiZSBsZXNzIHRoYW4gdHJ1bmNhdGlvbiBwYXJhbWV0ZXJcbiAgLy8gc28gYWRkaW5nIHdpbGwgbm90IGNhdXNlIGxlbmd0aCB0byBleGNlZWQgbWF4aW11bS5cbiAgaWYgKG5ldyBSZWdFeHAoYFs/fCZdKCR7ZW5jb2RlVVJJQ29tcG9uZW50KFRSVU5DQVRJT05fUEFSQU0ubmFtZSl9PWAgK1xuICAgICAgYCR7ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhUUlVOQ0FUSU9OX1BBUkFNLnZhbHVlKSl9fGFldD1bXiZdKikkYClcbiAgICAgIC50ZXN0KGFkVXJsKSkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBtb2RpZmllZEFkVXJsID0gYWRVcmwgKyBgJmFldD0ke3BhcmFtZXRlclZhbHVlfWA7XG4gIGRldigpLmFzc2VydChtb2RpZmllZEFkVXJsLmxlbmd0aCA8PSBNQVhfVVJMX0xFTkdUSCk7XG4gIHJldHVybiBtb2RpZmllZEFkVXJsO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBudW1lcmljYWwgY29kZSByZXByZXNlbnRpbmcgdGhlIGJpbmFyeSB0eXBlLlxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAqIEByZXR1cm4gez9zdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRCaW5hcnlUeXBlTnVtZXJpY2FsQ29kZSh0eXBlKSB7XG4gIHJldHVybiB7XG4gICAgJ3Byb2R1Y3Rpb24nOiAnMCcsXG4gICAgJ2NvbnRyb2wnOiAnMScsXG4gICAgJ2NhbmFyeSc6ICcyJyxcbiAgfVt0eXBlXSB8fCBudWxsO1xufVxuXG4vKiogQGNvbnN0IHshUmVnRXhwfSAqL1xuY29uc3QgSURFTlRJVFlfRE9NQUlOX1JFR0VYUF8gPSAvXFwuZ29vZ2xlXFwuKD86Y29tP1xcLik/W2Etel17MiwzfSQvO1xuXG4vKiogQHR5cGVkZWYge3tcbiAgICAgIHRva2VuOiAoc3RyaW5nfHVuZGVmaW5lZCksXG4gICAgICBqYXI6IChzdHJpbmd8dW5kZWZpbmVkKSxcbiAgICAgIHB1Y3JkOiAoc3RyaW5nfHVuZGVmaW5lZCksXG4gICAgICBmcmVzaExpZmV0aW1lU2VjczogKG51bWJlcnx1bmRlZmluZWQpLFxuICAgICAgdmFsaWRMaWZldGltZVNlY3M6IChudW1iZXJ8dW5kZWZpbmVkKSxcbiAgICAgIGZldGNoVGltZU1zOiAobnVtYmVyfHVuZGVmaW5lZClcbiAgIH19ICovXG5leHBvcnQgbGV0IElkZW50aXR5VG9rZW47XG5cbi8qKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhSWRlbnRpdHlUb2tlbj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRJZGVudGl0eVRva2VuKHdpbiwgZWxlbWVudE9yQW1wRG9jKSB7XG4gIHdpblsnZ29vZ19pZGVudGl0eV9wcm9tJ10gPSB3aW5bJ2dvb2dfaWRlbnRpdHlfcHJvbSddIHx8XG4gICAgICBleGVjdXRlSWRlbnRpdHlUb2tlbkZldGNoKHdpbiwgZWxlbWVudE9yQW1wRG9jKTtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8IUlkZW50aXR5VG9rZW4+fSAqLyh3aW5bJ2dvb2dfaWRlbnRpdHlfcHJvbSddKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshRWxlbWVudHwhLi4vLi4vLi4vc3JjL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAqIEBwYXJhbSB7bnVtYmVyPX0gcmVkaXJlY3RzUmVtYWluaW5nIChkZWZhdWx0IDEpXG4gKiBAcGFyYW0ge3N0cmluZz19IGRvbWFpblxuICogQHBhcmFtIHtudW1iZXI9fSBzdGFydFRpbWVcbiAqIEByZXR1cm4geyFQcm9taXNlPCFJZGVudGl0eVRva2VuPn1cbiAqL1xuZnVuY3Rpb24gZXhlY3V0ZUlkZW50aXR5VG9rZW5GZXRjaCh3aW4sIGVsZW1lbnRPckFtcERvYywgcmVkaXJlY3RzUmVtYWluaW5nID0gMSxcbiAgZG9tYWluID0gdW5kZWZpbmVkLCBzdGFydFRpbWUgPSBEYXRlLm5vdygpKSB7XG4gIGNvbnN0IHVybCA9IGdldElkZW50aXR5VG9rZW5SZXF1ZXN0VXJsKHdpbiwgZWxlbWVudE9yQW1wRG9jLCBkb21haW4pO1xuICByZXR1cm4gU2VydmljZXMueGhyRm9yKHdpbikuZmV0Y2hKc29uKHVybCwge1xuICAgIG1vZGU6ICdjb3JzJyxcbiAgICBtZXRob2Q6ICdHRVQnLFxuICAgIGFtcENvcnM6IGZhbHNlLFxuICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZScsXG4gIH0pLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXG4gICAgICAudGhlbihvYmogPT4ge1xuICAgICAgICBjb25zdCB0b2tlbiA9IG9ialsnbmV3VG9rZW4nXTtcbiAgICAgICAgY29uc3QgamFyID0gb2JqWycxcF9qYXInXSB8fCAnJztcbiAgICAgICAgY29uc3QgcHVjcmQgPSBvYmpbJ3B1Y3JkJ10gfHwgJyc7XG4gICAgICAgIGNvbnN0IGZyZXNoTGlmZXRpbWVTZWNzID0gcGFyc2VJbnQob2JqWydmcmVzaExpZmV0aW1lU2VjcyddIHx8ICcnLCAxMCk7XG4gICAgICAgIGNvbnN0IHZhbGlkTGlmZXRpbWVTZWNzID0gcGFyc2VJbnQob2JqWyd2YWxpZExpZmV0aW1lU2VjcyddIHx8ICcnLCAxMCk7XG4gICAgICAgIGNvbnN0IGFsdERvbWFpbiA9IG9ialsnYWx0RG9tYWluJ107XG4gICAgICAgIGNvbnN0IGZldGNoVGltZU1zID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgICAgaWYgKElERU5USVRZX0RPTUFJTl9SRUdFWFBfLnRlc3QoYWx0RG9tYWluKSkge1xuICAgICAgICAgIGlmICghcmVkaXJlY3RzUmVtYWluaW5nLS0pIHtcbiAgICAgICAgICAgIC8vIE1heCByZWRpcmVjdHMsIGxvZz9cbiAgICAgICAgICAgIHJldHVybiB7ZmV0Y2hUaW1lTXN9O1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZXhlY3V0ZUlkZW50aXR5VG9rZW5GZXRjaChcbiAgICAgICAgICAgICAgd2luLCBlbGVtZW50T3JBbXBEb2MsIHJlZGlyZWN0c1JlbWFpbmluZywgYWx0RG9tYWluLCBzdGFydFRpbWUpO1xuICAgICAgICB9IGVsc2UgaWYgKGZyZXNoTGlmZXRpbWVTZWNzID4gMCAmJiB2YWxpZExpZmV0aW1lU2VjcyA+IDAgJiZcbiAgICAgICAgICAgIHR5cGVvZiB0b2tlbiA9PSAnc3RyaW5nJykge1xuICAgICAgICAgIHJldHVybiB7dG9rZW4sIGphciwgcHVjcmQsIGZyZXNoTGlmZXRpbWVTZWNzLCB2YWxpZExpZmV0aW1lU2VjcyxcbiAgICAgICAgICAgIGZldGNoVGltZU1zfTtcbiAgICAgICAgfVxuICAgICAgICAvLyByZXR1cm5pbmcgZW1wdHlcbiAgICAgICAgcmV0dXJuIHtmZXRjaFRpbWVNc307XG4gICAgICB9KVxuICAgICAgLmNhdGNoKHVudXNlZEVyciA9PiB7XG4gICAgICAgIC8vIFRPRE8gbG9nP1xuICAgICAgICByZXR1cm4ge307XG4gICAgICB9KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshRWxlbWVudHwhLi4vLi4vLi4vc3JjL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAqIEBwYXJhbSB7c3RyaW5nPX0gZG9tYWluXG4gKiBAcmV0dXJuIHtzdHJpbmd9IHVybFxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRJZGVudGl0eVRva2VuUmVxdWVzdFVybCh3aW4sIGVsZW1lbnRPckFtcERvYyxcbiAgZG9tYWluID0gdW5kZWZpbmVkKSB7XG4gIGlmICghZG9tYWluICYmIHdpbiAhPSB3aW4udG9wICYmIHdpbi5sb2NhdGlvbi5hbmNlc3Rvck9yaWdpbnMpIHtcbiAgICBjb25zdCBtYXRjaGVzID0gSURFTlRJVFlfRE9NQUlOX1JFR0VYUF8uZXhlYyhcbiAgICAgICAgd2luLmxvY2F0aW9uLmFuY2VzdG9yT3JpZ2luc1t3aW4ubG9jYXRpb24uYW5jZXN0b3JPcmlnaW5zLmxlbmd0aCAtIDFdKTtcbiAgICBkb21haW4gPSAobWF0Y2hlcyAmJiBtYXRjaGVzWzBdKSB8fCB1bmRlZmluZWQ7XG4gIH1cbiAgZG9tYWluID0gZG9tYWluIHx8ICcuZ29vZ2xlLmNvbSc7XG4gIGNvbnN0IGNhbm9uaWNhbCA9XG4gICAgZXh0cmFjdEhvc3QoU2VydmljZXMuZG9jdW1lbnRJbmZvRm9yRG9jKGVsZW1lbnRPckFtcERvYykuY2Fub25pY2FsVXJsKTtcbiAgcmV0dXJuIGBodHRwczovL2Fkc2VydmljZSR7ZG9tYWlufS9hZHNpZC9pbnRlZ3JhdG9yLmpzb24/ZG9tYWluPSR7Y2Fub25pY2FsfWA7XG59XG5cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIHdlIGFyZSBydW5uaW5nIG9uIHRoZSBBTVAgQ0ROLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0NkblByb3h5KHdpbikge1xuICByZXR1cm4gQ0ROX1BST1hZX1JFR0VYUC50ZXN0KHdpbi5sb2NhdGlvbi5vcmlnaW4pO1xufVxuXG4vKipcbiAqIFBvcHVsYXRlcyB0aGUgZmllbGRzIG9mIHRoZSBnaXZlbiBOYW1lZnJhbWUgZXhwZXJpbWVudCBjb25maWcgb2JqZWN0LlxuICogQHBhcmFtIHshLi4vLi4vLi4vc3JjL3V0aWxzL3hoci11dGlscy5GZXRjaFJlc3BvbnNlSGVhZGVyc30gaGVhZGVyc1xuICogQHBhcmFtIHshTmFtZWZyYW1lRXhwZXJpbWVudENvbmZpZ30gbmFtZWZyYW1lQ29uZmlnXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXROYW1lZnJhbWVFeHBlcmltZW50Q29uZmlncyhoZWFkZXJzLCBuYW1lZnJhbWVDb25maWcpIHtcbiAgY29uc3QgbmFtZWZyYW1lRXhwZXJpbWVudEhlYWRlciA9IGhlYWRlcnMuZ2V0KCdhbXAtbmFtZWZyYW1lLWV4cCcpO1xuICBpZiAobmFtZWZyYW1lRXhwZXJpbWVudEhlYWRlcikge1xuICAgIG5hbWVmcmFtZUV4cGVyaW1lbnRIZWFkZXIuc3BsaXQoJzsnKS5mb3JFYWNoKGNvbmZpZyA9PiB7XG4gICAgICBpZiAoY29uZmlnID09ICdpbnN0YW50TG9hZCcgfHwgY29uZmlnID09ICd3cml0ZUluQm9keScpIHtcbiAgICAgICAgbmFtZWZyYW1lQ29uZmlnW2NvbmZpZ10gPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICogRW51bSBmb3IgYnJvd3NlciBjYXBhYmlsaXRpZXMuIE5PVEU6IFNpbmNlIEpTIGlzIDMyLWJpdCwgZG8gbm90IGFkZCBhbnltb3JlXG4gKiB0aGFuIDMyIGNhcGFiaWxpdGllcyB0byB0aGlzIGVudW0uXG4gKiBAZW51bSB7bnVtYmVyfVxuICovXG5jb25zdCBDYXBhYmlsaXR5ID0ge1xuICBTVkdfU1VQUE9SVEVEOiAxIDw8IDAsXG4gIFNBTkRCT1hJTkdfQUxMT1dfVE9QX05BVklHQVRJT05fQllfVVNFUl9BQ1RJVkFUSU9OX1NVUFBPUlRFRDogMSA8PCAxLFxuICBTQU5EQk9YSU5HX0FMTE9XX1BPUFVQU19UT19FU0NBUEVfU0FOREJPWF9TVVBQT1JURUQ6IDEgPDwgMixcbn07XG5cbi8qKlxuICogUmV0dXJucyBhIGJpdG1hcCByZXByZXNlbnRpbmcgd2hhdCBmZWF0dXJlcyBhcmUgc3VwcG9ydGVkIGJ5IHRoaXMgYnJvd3Nlci5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtudW1iZXJ9XG4gKi9cbmZ1bmN0aW9uIGdldEJyb3dzZXJDYXBhYmlsaXRpZXNCaXRtYXAod2luKSB7XG4gIGxldCBicm93c2VyQ2FwYWJpbGl0aWVzID0gMDtcbiAgY29uc3QgZG9jID0gd2luLmRvY3VtZW50O1xuICBpZiAod2luLlNWR0VsZW1lbnQgJiYgZG9jLmNyZWF0ZUVsZW1lbnROUykge1xuICAgIGJyb3dzZXJDYXBhYmlsaXRpZXMgfD0gQ2FwYWJpbGl0eS5TVkdfU1VQUE9SVEVEO1xuICB9XG4gIGNvbnN0IGlmcmFtZUVsID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpO1xuICBpZiAoaWZyYW1lRWwuc2FuZGJveCAmJiBpZnJhbWVFbC5zYW5kYm94LnN1cHBvcnRzKSB7XG4gICAgaWYgKGlmcmFtZUVsLnNhbmRib3guc3VwcG9ydHMoJ2FsbG93LXRvcC1uYXZpZ2F0aW9uLWJ5LXVzZXItYWN0aXZhdGlvbicpKSB7XG4gICAgICBicm93c2VyQ2FwYWJpbGl0aWVzIHw9XG4gICAgICAgIENhcGFiaWxpdHkuU0FOREJPWElOR19BTExPV19UT1BfTkFWSUdBVElPTl9CWV9VU0VSX0FDVElWQVRJT05fU1VQUE9SVEVEO1xuICAgIH1cbiAgICBpZiAoaWZyYW1lRWwuc2FuZGJveC5zdXBwb3J0cygnYWxsb3ctcG9wdXBzLXRvLWVzY2FwZS1zYW5kYm94JykpIHtcbiAgICAgIGJyb3dzZXJDYXBhYmlsaXRpZXMgfD1cbiAgICAgICAgQ2FwYWJpbGl0eS5TQU5EQk9YSU5HX0FMTE9XX1BPUFVQU19UT19FU0NBUEVfU0FOREJPWF9TVVBQT1JURUQ7XG4gICAgfVxuICB9XG4gIHJldHVybiBicm93c2VyQ2FwYWJpbGl0aWVzO1xufVxuXG4vKipcbiAqIFJldHVybnMgYW4gZW51bSB2YWx1ZSByZXByZXNlbnRpbmcgdGhlIEFNUCBiaW5hcnkgdHlwZSwgb3IgbnVsbCBpZiB0aGlzIGlzIGFcbiAqIGNhbm9uaWNhbCBwYWdlLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4gez9zdHJpbmd9IFRoZSBiaW5hcnkgdHlwZSBlbnVtLlxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBbXBSdW50aW1lVHlwZVBhcmFtZXRlcih3aW4pIHtcbiAgY29uc3QgYXJ0ID0gZ2V0QmluYXJ5VHlwZU51bWVyaWNhbENvZGUoZ2V0QmluYXJ5VHlwZSh3aW4pKTtcbiAgcmV0dXJuIGlzQ2RuUHJveHkod2luKSAmJiBhcnQgIT0gJzAnID8gYXJ0IDogbnVsbDtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge3VzZXJ9IGZyb20gJy4uLy4uL3NyYy9sb2cnO1xuXG4vKipcbiAqIEFwcHJvdmVkIGhlaWdodCBmb3IgQWRTZW5zZSBmdWxsLXdpZHRoIHJlc3BvbnNpdmUgYWRzLlxuICogQGNvbnN0IHtudW1iZXJ9XG4gKi9cbmV4cG9ydCBjb25zdCBBRFNFTlNFX1JTUFZfV0hJVEVMSVNURURfSEVJR0hUID0gMzIwO1xuXG4vKipcbiAqIEdpdmVuIHRoZSBhbXAtYWQgZGF0YSBhdHRyaWJ1dGUgY29udGFpbmluZyB0aGUgbXVsdGktc2l6ZSBkaW1lbnNpb25zLCBhbmQgYVxuICogc2V0IG9mIHByaW1hcnkgZGltZW5zaW9ucywgdGhpcyBmdW5jdGlvbiB3aWxsIHJldHVybiBhbGwgdmFsaWQgbXVsdGktc2l6ZVxuICogW3dpZHRoLCBoZWlnaHRdIHBhaXJzIGluIGFuIGFycmF5LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBtdWx0aVNpemVEYXRhU3RyIFRoZSBhbXAtYWQgZGF0YSBhdHRyaWJ1dGUgY29udGFpbmluZyB0aGVcbiAqICAgbXVsdGktc2l6ZSBkaW1lbnNpb25zLlxuICogQHBhcmFtIHtudW1iZXJ9IHByaW1hcnlXaWR0aCBUaGUgcHJpbWFyeSB3aWR0aCBvZiB0aGUgYWQgc2xvdC5cbiAqIEBwYXJhbSB7bnVtYmVyfSBwcmltYXJ5SGVpZ2h0IFRoZSBwcmltYXJ5IGhlaWdodCBvZiB0aGUgYWQgc2xvdC5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gbXVsdGlTaXplVmFsaWRhdGlvbiBBIGZsYWcgdGhhdCBpZiBzZXQgdG8gdHJ1ZSB3aWxsIGVuZm9yY2VcbiAqICAgdGhlIHJ1bGUgdGhhdCBlbnN1cmVzIG11bHRpLXNpemUgZGltZW5zaW9ucyBhcmUgbm8gbGVzcyB0aGFuIDIvM3JkcyBvZlxuICogICB0aGVpciBwcmltYXJ5IGRpbWVuc2lvbidzIGNvdW50ZXJwYXJ0LlxuICogQHBhcmFtIHtib29sZWFuPX0gaXNGbHVpZCBJbmRpY2F0ZXMgd2hldGhlciB0aGlzIGFkIHNsb3QgaXMgRmx1aWQtZW5hYmxlZC5cbiAqIEByZXR1cm4gez9BcnJheTwhQXJyYXk8bnVtYmVyPj59IEFuIGFycmF5IG9mIGRpbWVuc2lvbnMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRNdWx0aVNpemVEaW1lbnNpb25zKFxuICBtdWx0aVNpemVEYXRhU3RyLFxuICBwcmltYXJ5V2lkdGgsXG4gIHByaW1hcnlIZWlnaHQsXG4gIG11bHRpU2l6ZVZhbGlkYXRpb24sXG4gIGlzRmx1aWQgPSBmYWxzZSkge1xuXG4gIGNvbnN0IGRpbWVuc2lvbnMgPSBbXTtcbiAgY29uc3QgYXJyYXlPZlNpemVTdHJzID0gbXVsdGlTaXplRGF0YVN0ci5zcGxpdCgnLCcpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXlPZlNpemVTdHJzLmxlbmd0aDsgaSsrKSB7XG5cbiAgICBjb25zdCBzaXplU3RyID0gYXJyYXlPZlNpemVTdHJzW2ldO1xuICAgIGNvbnN0IHNpemUgPSBzaXplU3RyLnNwbGl0KCd4Jyk7XG5cbiAgICAvLyBNYWtlIHN1cmUgdGhhdCBlYWNoIHNpemUgaXMgc3BlY2lmaWVkIGluIHRoZSBmb3JtIFd4SC5cbiAgICBpZiAoc2l6ZS5sZW5ndGggIT0gMikge1xuICAgICAgdXNlcigpLmVycm9yKCdBTVAtQUQnLCBgSW52YWxpZCBtdWx0aS1zaXplIGRhdGEgZm9ybWF0ICcke3NpemVTdHJ9Jy5gKTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGNvbnN0IHdpZHRoID0gTnVtYmVyKHNpemVbMF0pO1xuICAgIGNvbnN0IGhlaWdodCA9IE51bWJlcihzaXplWzFdKTtcblxuICAgIC8vIE1ha2Ugc3VyZSB0aGF0IGJvdGggZGltZW5zaW9ucyBnaXZlbiBhcmUgcG9zaXRpdmUgbnVtYmVycy5cbiAgICBpZiAoIXZhbGlkYXRlRGltZW5zaW9ucyh3aWR0aCwgaGVpZ2h0LFxuICAgICAgICB3ID0+IGlzTmFOKHcpIHx8IHcgPD0gMCxcbiAgICAgICAgaCA9PiBpc05hTihoKSB8fCBoIDw9IDAsXG4gICAgICAgIGJhZFBhcmFtcyA9PiBiYWRQYXJhbXMubWFwKGJhZFBhcmFtID0+XG4gICAgICAgICAgYEludmFsaWQgJHtiYWRQYXJhbS5kaW19IG9mICR7YmFkUGFyYW0udmFsfSBgICtcbiAgICAgICAgICAgICdnaXZlbiBmb3Igc2Vjb25kYXJ5IHNpemUuJykuam9pbignICcpKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgdGhhdCBzZWNvbmRhcnkgc2l6ZSBpcyBub3QgbGFyZ2VyIHRoYW4gcHJpbWFyeSBzaXplLlxuICAgIGlmICghaXNGbHVpZCAmJiAhdmFsaWRhdGVEaW1lbnNpb25zKHdpZHRoLCBoZWlnaHQsXG4gICAgICAgIHcgPT4gdyA+IHByaW1hcnlXaWR0aCxcbiAgICAgICAgaCA9PiBoID4gcHJpbWFyeUhlaWdodCxcbiAgICAgICAgYmFkUGFyYW1zID0+IGJhZFBhcmFtcy5tYXAoYmFkUGFyYW0gPT5cbiAgICAgICAgICBgU2Vjb25kYXJ5ICR7YmFkUGFyYW0uZGltfSAke2JhZFBhcmFtLnZhbH0gYCArXG4gICAgICAgICAgICBgY2FuJ3QgYmUgbGFyZ2VyIHRoYW4gdGhlIHByaW1hcnkgJHtiYWRQYXJhbS5kaW19LmApLmpvaW4oJyAnKSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIC8vIENoZWNrIHRoYXQgaWYgbXVsdGktc2l6ZS12YWxpZGF0aW9uIGlzIG9uLCB0aGF0IHRoZSBzZWNvbmRhcnkgc2l6ZXNcbiAgICAvLyBhcmUgYXQgbGVhc3QgbWluUmF0aW8gb2YgdGhlIHByaW1hcnkgc2l6ZS5cbiAgICBpZiAobXVsdGlTaXplVmFsaWRhdGlvbikge1xuICAgICAgLy8gVGhlIG1pbmltdW0gcmF0aW8gb2YgZWFjaCBzZWNvbmRhcnkgZGltZW5zaW9uIHRvIGl0cyBjb3JyZXNwb25kaW5nXG4gICAgICAvLyBwcmltYXJ5IGRpbWVuc2lvbi5cbiAgICAgIGNvbnN0IG1pblJhdGlvID0gMiAvIDM7XG4gICAgICBjb25zdCBtaW5XaWR0aCA9IG1pblJhdGlvICogcHJpbWFyeVdpZHRoO1xuICAgICAgY29uc3QgbWluSGVpZ2h0ID0gbWluUmF0aW8gKiBwcmltYXJ5SGVpZ2h0O1xuICAgICAgaWYgKCF2YWxpZGF0ZURpbWVuc2lvbnMod2lkdGgsIGhlaWdodCxcbiAgICAgICAgICB3ID0+IHcgPCBtaW5XaWR0aCxcbiAgICAgICAgICBoID0+IGggPCBtaW5IZWlnaHQsXG4gICAgICAgICAgYmFkUGFyYW1zID0+IGJhZFBhcmFtcy5tYXAoYmFkUGFyYW0gPT5cbiAgICAgICAgICAgIGBTZWNvbmRhcnkgJHtiYWRQYXJhbS5kaW19ICR7YmFkUGFyYW0udmFsfSBpcyBgICtcbiAgICAgICAgICAgICAgYHNtYWxsZXIgdGhhbiAyLzNyZHMgb2YgdGhlIHByaW1hcnkgJHtiYWRQYXJhbS5kaW19LmApXG4gICAgICAgICAgICAgIC5qb2luKCcgJykpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFBhc3NlZCBhbGwgY2hlY2tzISBQdXNoIGFkZGl0aW9uYWwgc2l6ZSB0byBkaW1lbnNpb25zLlxuICAgIGRpbWVuc2lvbnMucHVzaChbd2lkdGgsIGhlaWdodF0pO1xuICB9XG5cbiAgcmV0dXJuIGRpbWVuc2lvbnM7XG59XG5cbi8qKlxuICogQSBoZWxwZXIgZnVuY3Rpb24gZm9yIGRldGVybWluaW5nIHdoZXRoZXIgYSBnaXZlbiB3aWR0aCBvciBoZWlnaHQgdmlvbGF0ZXNcbiAqIHNvbWUgY29uZGl0aW9uLlxuICpcbiAqIENoZWNrcyB0aGUgd2lkdGggYW5kIGhlaWdodCBhZ2FpbnN0IHRoZWlyIGNvcnJlc3BvbmRpbmcgY29uZGl0aW9ucy4gSWZcbiAqIGVpdGhlciBvZiB0aGUgY29uZGl0aW9ucyBmYWlsLCB0aGUgZXJyb3JCdWlsZGVyIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIHdpdGhcbiAqIHRoZSBhcHByb3ByaWF0ZSBhcmd1bWVudHMsIGl0cyByZXN1bHQgd2lsbCBiZSBsb2dnZWQgdG8gdXNlcigpLmVycm9yLCBhbmRcbiAqIHZhbGlkYXRlRGltZW5zaW9ucyB3aWxsIHJldHVybiBmYWxzZS4gT3RoZXJ3aXNlLCB2YWxpZGF0ZURpbWVuc2lvbnMgd2lsbFxuICogb25seSByZXR1cm4gdHJ1ZS5cbiAqXG4gKiBAcGFyYW0geyhudW1iZXJ8c3RyaW5nKX0gd2lkdGhcbiAqIEBwYXJhbSB7KG51bWJlcnxzdHJpbmcpfSBoZWlnaHRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKG51bWJlcnxzdHJpbmcpKTogYm9vbGVhbn0gd2lkdGhDb25kXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKChudW1iZXJ8c3RyaW5nKSk6IGJvb2xlYW59IGhlaWdodENvbmRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUFycmF5PHtkaW06IHN0cmluZywgdmFsOiAobnVtYmVyfHN0cmluZyl9Pik6IHN0cmluZz19IGVycm9yQnVpbGRlclxuICogQSBmdW5jdGlvbiB0aGF0IHdpbGwgcHJvZHVjZSBhbiBpbmZvcm1hdGl2ZSBlcnJvciBtZXNzYWdlLlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gdmFsaWRhdGVEaW1lbnNpb25zKHdpZHRoLCBoZWlnaHQsIHdpZHRoQ29uZCwgaGVpZ2h0Q29uZCwgZXJyb3JCdWlsZGVyKVxue1xuICBjb25zdCBiYWRQYXJhbXMgPSBbXTtcbiAgaWYgKHdpZHRoQ29uZCh3aWR0aCkpIHtcbiAgICBiYWRQYXJhbXMucHVzaCh7ZGltOiAnd2lkdGgnLCB2YWw6IHdpZHRofSk7XG4gIH1cbiAgaWYgKGhlaWdodENvbmQoaGVpZ2h0KSkge1xuICAgIGJhZFBhcmFtcy5wdXNoKHtkaW06ICdoZWlnaHQnLCB2YWw6IGhlaWdodH0pO1xuICB9XG4gIGlmIChiYWRQYXJhbXMubGVuZ3RoKSB7XG4gICAgdXNlcigpLndhcm4oJ0FNUC1BRCcsIGVycm9yQnVpbGRlcihiYWRQYXJhbXMpKTtcbiAgfVxuICByZXR1cm4gIWJhZFBhcmFtcy5sZW5ndGg7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi4vLi4vLi4vc3JjL3NlcnZpY2VzJztcbmltcG9ydCB7XG4gIFZhcmlhYmxlU291cmNlLFxuICBnZXROYXZpZ2F0aW9uRGF0YSxcbiAgZ2V0VGltaW5nRGF0YUFzeW5jLFxuICBnZXRUaW1pbmdEYXRhU3luYyxcbn0gZnJvbSAnLi4vLi4vLi4vc3JjL3NlcnZpY2UvdmFyaWFibGUtc291cmNlJztcbmltcG9ydCB7dXNlcn0gZnJvbSAnLi4vLi4vLi4vc3JjL2xvZyc7XG5cblxuY29uc3QgV0hJVEVMSVNURURfVkFSSUFCTEVTID0gW1xuICAnQU1QRE9DX0hPU1QnLFxuICAnQU1QRE9DX0hPU1ROQU1FJyxcbiAgJ0FNUERPQ19VUkwnLFxuICAnQU1QX1ZFUlNJT04nLFxuICAnQVZBSUxBQkxFX1NDUkVFTl9IRUlHSFQnLFxuICAnQVZBSUxBQkxFX1NDUkVFTl9XSURUSCcsXG4gICdCQUNLR1JPVU5EX1NUQVRFJyxcbiAgJ0JST1dTRVJfTEFOR1VBR0UnLFxuICAnQ0FOT05JQ0FMX0hPU1QnLFxuICAnQ0FOT05JQ0FMX0hPU1ROQU1FJyxcbiAgJ0NBTk9OSUNBTF9QQVRIJyxcbiAgJ0NBTk9OSUNBTF9VUkwnLFxuICAnQ0xJRU5UX0lEJyxcbiAgJ0NPVU5URVInLFxuICAnRE9DVU1FTlRfQ0hBUlNFVCcsXG4gICdET0NVTUVOVF9SRUZFUlJFUicsXG4gICdGSVJTVF9DT05URU5URlVMX1BBSU5UJyxcbiAgJ0ZJUlNUX1ZJRVdQT1JUX1JFQURZJyxcbiAgJ01BS0VfQk9EWV9WSVNJQkxFJyxcbiAgJ1BBR0VfVklFV19JRCcsXG4gICdSQU5ET00nLFxuICAnU0NSRUVOX0NPTE9SX0RFUFRIJyxcbiAgJ1NDUkVFTl9IRUlHSFQnLFxuICAnU0NSRUVOX1dJRFRIJyxcbiAgJ1NDUk9MTF9IRUlHSFQnLFxuICAnU0NST0xMX0xFRlQnLFxuICAnU0NST0xMX1RPUCcsXG4gICdTQ1JPTExfV0lEVEgnLFxuICAnU0hBUkVfVFJBQ0tJTkdfSU5DT01JTkcnLFxuICAnU0hBUkVfVFJBQ0tJTkdfT1VUR09JTkcnLFxuICAnU09VUkNFX0hPU1QnLFxuICAnU09VUkNFX0hPU1ROQU1FJyxcbiAgJ1NPVVJDRV9QQVRIJyxcbiAgJ1NPVVJDRV9VUkwnLFxuICAnVElNRVNUQU1QJyxcbiAgJ1RJTUVaT05FJyxcbiAgJ1RJTUVaT05FX0NPREUnLFxuICAnVElUTEUnLFxuICAnVE9UQUxfRU5HQUdFRF9USU1FJyxcbiAgJ1VTRVJfQUdFTlQnLFxuICAnVkFSSUFOVCcsXG4gICdWQVJJQU5UUycsXG4gICdWSUVXRVInLFxuICAnVklFV1BPUlRfSEVJR0hUJyxcbiAgJ1ZJRVdQT1JUX1dJRFRIJyxcbl07XG5cbi8qKiBQcm92aWRlcyBBNEEgc3BlY2lmaWMgdmFyaWFibGUgc3Vic3RpdHV0aW9uLiAqL1xuZXhwb3J0IGNsYXNzIEE0QVZhcmlhYmxlU291cmNlIGV4dGVuZHMgVmFyaWFibGVTb3VyY2Uge1xuICAvKipcbiAgICogQHBhcmFtICB7IS4uLy4uLy4uL3NyYy9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gICAqIEBwYXJhbSAgeyFXaW5kb3d9IGVtYmVkV2luXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhbXBkb2MsIGVtYmVkV2luKSB7XG4gICAgc3VwZXIoYW1wZG9jKTtcbiAgICAvKiogQHByaXZhdGUge1ZhcmlhYmxlU291cmNlfSBnbG9iYWwgdmFyaWFibGUgc291cmNlIGZvciBmYWxsYmFjay4gKi9cbiAgICB0aGlzLmdsb2JhbFZhcmlhYmxlU291cmNlXyA9IFNlcnZpY2VzLnVybFJlcGxhY2VtZW50c0ZvckRvYyhhbXBkb2MpXG4gICAgICAgIC5nZXRWYXJpYWJsZVNvdXJjZSgpO1xuXG4gICAgLyoqIEBwcml2YXRlIHshV2luZG93fSAqL1xuICAgIHRoaXMud2luXyA9IGVtYmVkV2luO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBpbml0aWFsaXplKCkge1xuICAgIHRoaXMuc2V0KCdBRF9OQVZfVElNSU5HJywgKHN0YXJ0QXR0cmlidXRlLCBlbmRBdHRyaWJ1dGUpID0+IHtcbiAgICAgIHVzZXIoKS5hc3NlcnQoc3RhcnRBdHRyaWJ1dGUsICdUaGUgZmlyc3QgYXJndW1lbnQgdG8gQURfTkFWX1RJTUlORywgdGhlJyArXG4gICAgICAgICAgJyBzdGFydCBhdHRyaWJ1dGUgbmFtZSwgaXMgcmVxdWlyZWQnKTtcbiAgICAgIHJldHVybiBnZXRUaW1pbmdEYXRhU3luYyhcbiAgICAgICAgICB0aGlzLndpbl8sXG4gICAgICAgICAgLyoqQHR5cGUge3N0cmluZ30qLyhzdGFydEF0dHJpYnV0ZSksXG4gICAgICAgICAgLyoqQHR5cGUge3N0cmluZ30qLyhlbmRBdHRyaWJ1dGUpKTtcbiAgICB9KS5zZXRBc3luYygnQURfTkFWX1RJTUlORycsIChzdGFydEF0dHJpYnV0ZSwgZW5kQXR0cmlidXRlKSA9PiB7XG4gICAgICB1c2VyKCkuYXNzZXJ0KHN0YXJ0QXR0cmlidXRlLCAnVGhlIGZpcnN0IGFyZ3VtZW50IHRvIEFEX05BVl9USU1JTkcsIHRoZScgK1xuICAgICAgICAgICcgc3RhcnQgYXR0cmlidXRlIG5hbWUsIGlzIHJlcXVpcmVkJyk7XG4gICAgICByZXR1cm4gZ2V0VGltaW5nRGF0YUFzeW5jKFxuICAgICAgICAgIHRoaXMud2luXyxcbiAgICAgICAgICAvKipAdHlwZSB7c3RyaW5nfSovKHN0YXJ0QXR0cmlidXRlKSxcbiAgICAgICAgICAvKipAdHlwZSB7c3RyaW5nfSovKGVuZEF0dHJpYnV0ZSkpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5zZXQoJ0FEX05BVl9UWVBFJywgKCkgPT4ge1xuICAgICAgcmV0dXJuIGdldE5hdmlnYXRpb25EYXRhKHRoaXMud2luXywgJ3R5cGUnKTtcbiAgICB9KTtcblxuICAgIHRoaXMuc2V0KCdBRF9OQVZfUkVESVJFQ1RfQ09VTlQnLCAoKSA9PiB7XG4gICAgICByZXR1cm4gZ2V0TmF2aWdhdGlvbkRhdGEodGhpcy53aW5fLCAncmVkaXJlY3RDb3VudCcpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5zZXQoJ0hUTUxfQVRUUicsXG4gICAgICAgIC8qKiBAdHlwZSB7ZnVuY3Rpb24oLi4uKil9ICovKHRoaXMuaHRtbEF0dHJpYnV0ZUJpbmRpbmdfLmJpbmQodGhpcykpKTtcblxuICAgIGZvciAobGV0IHYgPSAwOyB2IDwgV0hJVEVMSVNURURfVkFSSUFCTEVTLmxlbmd0aDsgdisrKSB7XG4gICAgICBjb25zdCB2YXJOYW1lID0gV0hJVEVMSVNURURfVkFSSUFCTEVTW3ZdO1xuICAgICAgY29uc3QgcmVzb2x2ZXJzID0gdGhpcy5nbG9iYWxWYXJpYWJsZVNvdXJjZV8uZ2V0KHZhck5hbWUpO1xuICAgICAgdGhpcy5zZXQodmFyTmFtZSwgcmVzb2x2ZXJzLnN5bmMpLnNldEFzeW5jKHZhck5hbWUsIHJlc29sdmVycy5hc3luYyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFByb3ZpZGVzIGEgYmluZGluZyBmb3IgZ2V0dGluZyBhdHRyaWJ1dGVzIGZyb20gdGhlIERPTS5cbiAgICogTW9zdCBzdWNoIGJpbmRpbmdzIGFyZSBwcm92aWRlZCBpbiBzcmMvc2VydmljZS91cmwtcmVwbGFjZW1lbnRzLWltcGwsIGJ1dFxuICAgKiB0aGlzIG9uZSBuZWVkcyBhY2Nlc3MgdG8gdGhpcy53aW5fLmRvY3VtZW50LCB3aGljaCBpZiB0aGUgYW1wLWFuYWx5dGljc1xuICAgKiB0YWcgaXMgY29udGFpbmVkIHdpdGhpbiBhbiBhbXAtYWQgdGFnIHdpbGwgTk9UIGJlIHRoZSBwYXJlbnQvcHVibGlzaGVyXG4gICAqIHBhZ2UuIEhlbmNlIHRoZSBuZWVkIHRvIHB1dCBpdCBoZXJlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gY3NzU2VsZWN0b3IgRWxlbWVudHMgbWF0Y2hpbmcgdGhpcyBzZWxlY3RvciB3aWxsIGJlXG4gICAqICAgICBpbmNsdWRlZCwgcHJvdmlkZWQgdGhleSBoYXZlIGF0IGxlYXN0IG9uZSBvZiB0aGUgYXR0cmlidXRlTmFtZXNcbiAgICogICAgIHNldCwgdXAgdG8gYSBtYXggb2YgMTAuIE1heSBiZSBVUkkgZW5jb2RlZC5cbiAgICogQHBhcmFtIHsuLi5zdHJpbmd9IHZhcl9hcmdzIEFkZGl0aW9uYWwgcGFyYW1zIHdpbGwgYmUgdGhlIG5hbWVzIG9mXG4gICAqICAgICBhdHRyaWJ1dGVzIHdob3NlIHZhbHVlcyB3aWxsIGJlIHJldHVybmVkLiBUaGVyZSBzaG91bGQgYmUgYXQgbGVhc3QgMS5cbiAgICogQHJldHVybiB7c3RyaW5nfSBBIHN0cmluZ2lmaWVkIEpTT04gYXJyYXkgY29udGFpbmluZyBvbmUgbWVtYmVyIGZvciBlYWNoXG4gICAqICAgICBtYXRjaGluZyBlbGVtZW50LiBFYWNoIG1lbWJlciB3aWxsIGNvbnRhaW4gdGhlIG5hbWVzIGFuZCB2YWx1ZXMgb2YgdGhlXG4gICAqICAgICBzcGVjaWZpZWQgYXR0cmlidXRlcywgaWYgdGhlIGNvcnJlc3BvbmRpbmcgZWxlbWVudCBoYXMgdGhhdCBhdHRyaWJ1dGUuXG4gICAqICAgICBOb3RlIHRoYXQgaWYgYW4gZWxlbWVudCBtYXRjaGVzIHRoZSBjc3NTZWxlY3RlZCBidXQgaGFzIG5vbmUgb2YgdGhlXG4gICAqICAgICByZXF1ZXN0ZWQgYXR0cmlidXRlcywgdGhlbiBub3RoaW5nIHdpbGwgYmUgaW5jbHVkZWQgaW4gdGhlIGFycmF5XG4gICAqICAgICBmb3IgdGhhdCBlbGVtZW50LlxuICAgKi9cbiAgaHRtbEF0dHJpYnV0ZUJpbmRpbmdfKGNzc1NlbGVjdG9yLCB2YXJfYXJncykge1xuICAgIC8vIEdlbmVyYXRlIGFuIGVycm9yIGlmIGNzc1NlbGVjdG9yIG1hdGNoZXMgbW9yZSB0aGFuIHRoaXMgbWFueSBlbGVtZW50c1xuICAgIGNvbnN0IEhUTUxfQVRUUl9NQVhfRUxFTUVOVFNfVE9fVFJBVkVSU0UgPSAyMDtcblxuICAgIC8vIE9mIHRoZSBlbGVtZW50cyBtYXRjaGVkIGJ5IGNzc1NlbGVjdG9yLCBzZWUgd2hpY2ggY29udGFpbiBvbmUgb3IgbW9yZVxuICAgIC8vIG9mIHRoZSBzcGVjaWZpZWQgYXR0cmlidXRlcywgYW5kIHJldHVybiBhbiBhcnJheSBvZiBhdCBtb3N0IHRoaXMgbWFueS5cbiAgICBjb25zdCBIVE1MX0FUVFJfTUFYX0VMRU1FTlRTX1RPX1JFVFVSTiA9IDEwO1xuXG4gICAgLy8gT25seSBhbGxvdyBhdCBtb3N0IHRoaXMgbWFueSBhdHRyaWJ1dGVOYW1lcyB0byBiZSBzcGVjaWZpZWQuXG4gICAgY29uc3QgSFRNTF9BVFRSX01BWF9BVFRSUyA9IDEwO1xuXG4gICAgY29uc3QgVEFHID0gJ0E0QVZhcmlhYmxlU291cmNlJztcblxuICAgIGNvbnN0IGF0dHJpYnV0ZU5hbWVzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgICBpZiAoIWNzc1NlbGVjdG9yIHx8ICFhdHRyaWJ1dGVOYW1lcy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiAnW10nO1xuICAgIH1cbiAgICBpZiAoYXR0cmlidXRlTmFtZXMubGVuZ3RoID4gSFRNTF9BVFRSX01BWF9BVFRSUykge1xuICAgICAgdXNlcigpLmVycm9yKFRBRywgYEF0IG1vc3QgJHtIVE1MX0FUVFJfTUFYX0FUVFJTfSBtYXkgYmUgcmVxdWVzdGVkLmApO1xuICAgICAgcmV0dXJuICdbXSc7XG4gICAgfVxuICAgIGNzc1NlbGVjdG9yID0gZGVjb2RlVVJJKGNzc1NlbGVjdG9yKTtcbiAgICBsZXQgZWxlbWVudHM7XG4gICAgdHJ5IHtcbiAgICAgIGVsZW1lbnRzID0gdGhpcy53aW5fLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY3NzU2VsZWN0b3IpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHVzZXIoKS5lcnJvcihUQUcsIGBJbnZhbGlkIHNlbGVjdG9yOiAke2Nzc1NlbGVjdG9yfWApO1xuICAgICAgcmV0dXJuICdbXSc7XG4gICAgfVxuICAgIGlmIChlbGVtZW50cy5sZW5ndGggPiBIVE1MX0FUVFJfTUFYX0VMRU1FTlRTX1RPX1RSQVZFUlNFKSB7XG4gICAgICB1c2VyKCkuZXJyb3IoVEFHLCAnQ1NTIHNlbGVjdG9yIG1heSBtYXRjaCBhdCBtb3N0ICcgK1xuICAgICAgICAgIGAke0hUTUxfQVRUUl9NQVhfRUxFTUVOVFNfVE9fVFJBVkVSU0V9IGVsZW1lbnRzLmApO1xuICAgICAgcmV0dXJuICdbXSc7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoICYmXG4gICAgICAgIHJlc3VsdC5sZW5ndGggPCBIVE1MX0FUVFJfTUFYX0VMRU1FTlRTX1RPX1JFVFVSTjsgKytpKSB7XG4gICAgICBjb25zdCBjdXJyZW50UmVzdWx0ID0ge307XG4gICAgICBsZXQgZm91bmRBdExlYXN0T25lQXR0ciA9IGZhbHNlO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBhdHRyaWJ1dGVOYW1lcy5sZW5ndGg7ICsraikge1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVOYW1lID0gYXR0cmlidXRlTmFtZXNbal07XG4gICAgICAgIGlmIChlbGVtZW50c1tpXS5oYXNBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSkpIHtcbiAgICAgICAgICBjdXJyZW50UmVzdWx0W2F0dHJpYnV0ZU5hbWVdID1cbiAgICAgICAgICAgICAgZWxlbWVudHNbaV0uZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICAgIGZvdW5kQXRMZWFzdE9uZUF0dHIgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoZm91bmRBdExlYXN0T25lQXR0cikge1xuICAgICAgICByZXN1bHQucHVzaChjdXJyZW50UmVzdWx0KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHJlc3VsdCk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge0E0QVZhcmlhYmxlU291cmNlfSBmcm9tICcuL2E0YS12YXJpYWJsZS1zb3VyY2UnO1xuaW1wb3J0IHtcbiAgQ09OU0VOVF9QT0xJQ1lfU1RBVEUsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbn0gZnJvbSAnLi4vLi4vLi4vc3JjL2NvbnNlbnQtc3RhdGUnO1xuaW1wb3J0IHtMYXlvdXQsIGlzTGF5b3V0U2l6ZURlZmluZWR9IGZyb20gJy4uLy4uLy4uL3NyYy9sYXlvdXQnO1xuaW1wb3J0IHtMYXlvdXRQcmlvcml0eX0gZnJvbSAnLi4vLi4vLi4vc3JjL2xheW91dCc7XG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZXMnO1xuaW1wb3J0IHtTaWduYXR1cmVWZXJpZmllciwgVmVyaWZpY2F0aW9uU3RhdHVzfSBmcm9tICcuL3NpZ25hdHVyZS12ZXJpZmllcic7XG5pbXBvcnQge1xuICBhc3NlcnRIdHRwc1VybCxcbiAgdHJ5RGVjb2RlVXJpQ29tcG9uZW50LFxufSBmcm9tICcuLi8uLi8uLi9zcmMvdXJsJztcbmltcG9ydCB7Y2FuY2VsbGF0aW9uLCBpc0NhbmNlbGxhdGlvbn0gZnJvbSAnLi4vLi4vLi4vc3JjL2Vycm9yJztcbmltcG9ydCB7Y3JlYXRlRWxlbWVudFdpdGhBdHRyaWJ1dGVzfSBmcm9tICcuLi8uLi8uLi9zcmMvZG9tJztcbmltcG9ydCB7ZGV2LCBkdXBsaWNhdGVFcnJvcklmTmVjZXNzYXJ5LCB1c2VyfSBmcm9tICcuLi8uLi8uLi9zcmMvbG9nJztcbmltcG9ydCB7ZGljdH0gZnJvbSAnLi4vLi4vLi4vc3JjL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge1xuICBnZW5lcmF0ZVNlbnRpbmVsLFxuICBnZXREZWZhdWx0Qm9vdHN0cmFwQmFzZVVybCxcbn0gZnJvbSAnLi4vLi4vLi4vc3JjLzNwLWZyYW1lJztcbmltcG9ydCB7XG4gIGdldEFtcEFkUmVuZGVyT3V0c2lkZVZpZXdwb3J0LFxuICBpbmNyZW1lbnRMb2FkaW5nQWRzLFxuICBpczNwVGhyb3R0bGVkLFxufSBmcm9tICcuLi8uLi9hbXAtYWQvMC4xL2NvbmN1cnJlbnQtbG9hZCc7XG5pbXBvcnQge2dldEJpbmFyeVR5cGV9IGZyb20gJy4uLy4uLy4uL3NyYy9leHBlcmltZW50cyc7XG5pbXBvcnQge2dldEJpbmFyeVR5cGVOdW1lcmljYWxDb2RlfSBmcm9tICcuLi8uLi8uLi9hZHMvZ29vZ2xlL2E0YS91dGlscyc7XG5pbXBvcnQge2dldENvbnNlbnRQb2xpY3lTdGF0ZX0gZnJvbSAnLi4vLi4vLi4vc3JjL2NvbnNlbnQnO1xuaW1wb3J0IHtnZXRDb250ZXh0TWV0YWRhdGF9IGZyb20gJy4uLy4uLy4uL3NyYy9pZnJhbWUtYXR0cmlidXRlcyc7XG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4uLy4uLy4uL3NyYy9tb2RlJztcbmltcG9ydCB7aW5zZXJ0QW5hbHl0aWNzRWxlbWVudH0gZnJvbSAnLi4vLi4vLi4vc3JjL2V4dGVuc2lvbi1hbmFseXRpY3MnO1xuaW1wb3J0IHtcbiAgaW5zdGFsbEZyaWVuZGx5SWZyYW1lRW1iZWQsXG4gIHNldEZyaWVuZGx5SWZyYW1lRW1iZWRWaXNpYmxlLFxufSBmcm9tICcuLi8uLi8uLi9zcmMvZnJpZW5kbHktaWZyYW1lLWVtYmVkJztcbmltcG9ydCB7XG4gIGluc3RhbGxVcmxSZXBsYWNlbWVudHNGb3JFbWJlZCxcbn0gZnJvbSAnLi4vLi4vLi4vc3JjL3NlcnZpY2UvdXJsLXJlcGxhY2VtZW50cy1pbXBsJztcbmltcG9ydCB7aXNBZFBvc2l0aW9uQWxsb3dlZH0gZnJvbSAnLi4vLi4vLi4vc3JjL2FkLWhlbHBlcic7XG5pbXBvcnQge2lzQXJyYXksIGlzRW51bVZhbHVlLCBpc09iamVjdH0gZnJvbSAnLi4vLi4vLi4vc3JjL3R5cGVzJztcbmltcG9ydCB7aXNFeHBlcmltZW50T259IGZyb20gJy4uLy4uLy4uL3NyYy9leHBlcmltZW50cyc7XG5pbXBvcnQge3BhcnNlSnNvbn0gZnJvbSAnLi4vLi4vLi4vc3JjL2pzb24nO1xuaW1wb3J0IHtzZXRTdHlsZX0gZnJvbSAnLi4vLi4vLi4vc3JjL3N0eWxlJztcbmltcG9ydCB7c2lnbmluZ1NlcnZlclVSTHN9IGZyb20gJy4uLy4uLy4uL2Fkcy9fYTRhLWNvbmZpZyc7XG5pbXBvcnQge3RyaWdnZXJBbmFseXRpY3NFdmVudH0gZnJvbSAnLi4vLi4vLi4vc3JjL2FuYWx5dGljcyc7XG5pbXBvcnQge3RyeVJlc29sdmV9IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9wcm9taXNlJztcbmltcG9ydCB7dXRmOERlY29kZX0gZnJvbSAnLi4vLi4vLi4vc3JjL3V0aWxzL2J5dGVzJztcblxuLyoqIEB0eXBlIHtBcnJheTxzdHJpbmc+fSAqL1xuY29uc3QgTUVUQURBVEFfU1RSSU5HUyA9IFtcbiAgJzxzY3JpcHQgYW1wLWFkLW1ldGFkYXRhIHR5cGU9YXBwbGljYXRpb24vanNvbj4nLFxuICAnPHNjcmlwdCB0eXBlPVwiYXBwbGljYXRpb24vanNvblwiIGFtcC1hZC1tZXRhZGF0YT4nLFxuICAnPHNjcmlwdCB0eXBlPWFwcGxpY2F0aW9uL2pzb24gYW1wLWFkLW1ldGFkYXRhPiddO1xuXG4vLyBUT0RPKHRkcmwpOiBUZW1wb3JhcnksIHdoaWxlIHdlJ3JlIHZlcmlmeWluZyB3aGV0aGVyIFNhZmVGcmFtZSBpcyBhblxuLy8gYWNjZXB0YWJsZSBzb2x1dGlvbiB0byB0aGUgJ1NhZmFyaSBvbiBpT1MgZG9lc24ndCBmZXRjaCBpZnJhbWUgc3JjIGZyb21cbi8vIGNhY2hlJyBpc3N1ZS4gIFNlZSBodHRwczovL2dpdGh1Yi5jb20vYW1wcHJvamVjdC9hbXBodG1sL2lzc3Vlcy81NjE0XG4vKiogQHR5cGUge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NBRkVGUkFNRV9WRVJTSU9OID0gJzEtMC0yMyc7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBDUkVBVElWRV9TSVpFX0hFQURFUiA9ICdYLUNyZWF0aXZlU2l6ZSc7XG5cbi8qKiBAdHlwZSB7c3RyaW5nfSBAdmlzaWJsZUZvclRlc3RpbmcgKi9cbmV4cG9ydCBjb25zdCBSRU5ERVJJTkdfVFlQRV9IRUFERVIgPSAnWC1BbXBBZFJlbmRlcic7XG5cbi8qKiBAdHlwZSB7c3RyaW5nfSBAdmlzaWJsZUZvclRlc3RpbmcgKi9cbmV4cG9ydCBjb25zdCBTQUZFRlJBTUVfVkVSU0lPTl9IRUFERVIgPSAnWC1BbXBTYWZlRnJhbWVWZXJzaW9uJztcblxuLyoqIEB0eXBlIHtzdHJpbmd9IEB2aXNpYmxlRm9yVGVzdGluZyAqL1xuZXhwb3J0IGNvbnN0IEVYUEVSSU1FTlRfRkVBVFVSRV9IRUFERVJfTkFNRSA9ICdhbXAtZmYtZXhwcyc7XG5cbi8qKiBAdHlwZSB7c3RyaW5nfSBAdmlzaWJpbGVGb3JUZXN0aW5nICovXG5leHBvcnQgY29uc3QgU0FOREJPWF9IRUFERVIgPSAnYW1wLWZmLXNhbmRib3gnO1xuXG4vKiogQHR5cGUge3N0cmluZ30gKi9cbmNvbnN0IFRBRyA9ICdhbXAtYTRhJztcblxuLyoqIEB0eXBlIHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgTk9fQ09OVEVOVF9SRVNQT05TRSA9ICdOTy1DT05URU5ULVJFU1BPTlNFJztcblxuLyoqIEB0eXBlIHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgTkVUV09SS19GQUlMVVJFID0gJ05FVFdPUkstRkFJTFVSRSc7XG5cbi8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuZXhwb3J0IGNvbnN0IElOVkFMSURfU1BTQV9SRVNQT05TRSA9ICdJTlZBTElELVNQU0EtUkVTUE9OU0UnO1xuXG4vKiogQHR5cGUge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBJRlJBTUVfR0VUID0gJ0lGUkFNRS1HRVQnO1xuXG4vKiogQGVudW0ge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBYT1JJR0lOX01PREUgPSB7XG4gIENMSUVOVF9DQUNIRTogJ2NsaWVudF9jYWNoZScsXG4gIFNBRkVGUkFNRTogJ3NhZmVmcmFtZScsXG4gIE5BTUVGUkFNRTogJ25hbWVmcmFtZScsXG4gIElGUkFNRV9HRVQ6ICdpZnJhbWVfZ2V0Jyxcbn07XG5cbi8qKiBAdHlwZSB7IU9iamVjdH0gQHByaXZhdGUgKi9cbmNvbnN0IFNIQVJFRF9JRlJBTUVfUFJPUEVSVElFUyA9IGRpY3Qoe1xuICAnZnJhbWVib3JkZXInOiAnMCcsXG4gICdhbGxvd2Z1bGxzY3JlZW4nOiAnJyxcbiAgJ2FsbG93dHJhbnNwYXJlbmN5JzogJycsXG4gICdzY3JvbGxpbmcnOiAnbm8nLFxuICAnbWFyZ2lud2lkdGgnOiAnMCcsXG4gICdtYXJnaW5oZWlnaHQnOiAnMCcsXG59KTtcblxuLyoqIEB0eXBlZGVmIHt7d2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXJ9fSAqL1xuZXhwb3J0IGxldCBTaXplSW5mb0RlZjtcblxuLyoqIEB0eXBlZGVmIHt7XG4gICAgICBtaW5pZmllZENyZWF0aXZlOiBzdHJpbmcsXG4gICAgICBjdXN0b21FbGVtZW50RXh0ZW5zaW9uczogIUFycmF5PHN0cmluZz4sXG4gICAgICBjdXN0b21TdHlsZXNoZWV0czogIUFycmF5PHtocmVmOiBzdHJpbmd9PixcbiAgICAgIGltYWdlczogKEFycmF5PHN0cmluZz58dW5kZWZpbmVkKSxcbiAgICAgIGN0YVR5cGU6IChzdHJpbmd8dW5kZWZpbmVkKSxcbiAgICAgIGN0YVVybDogKHN0cmluZ3x1bmRlZmluZWQpLFxuICAgIH19ICovXG5leHBvcnQgbGV0IENyZWF0aXZlTWV0YURhdGFEZWY7XG5cbi8qKlxuICogTmFtZSBvZiBBNEEgbGlmZWN5Y2xlIHRyaWdnZXJzLlxuICogQGVudW0ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGNvbnN0IEFuYWx5dGljc1RyaWdnZXIgPSB7XG4gIEFEX1JFUVVFU1RfU1RBUlQ6ICdhZC1yZXF1ZXN0LXN0YXJ0JyxcbiAgQURfUkVTUE9OU0VfRU5EOiAnYWQtcmVzcG9uc2UtZW5kJyxcbiAgQURfUkVOREVSX1NUQVJUOiAnYWQtcmVuZGVyLXN0YXJ0JyxcbiAgQURfUkVOREVSX0VORDogJ2FkLXJlbmRlci1lbmQnLFxuICBBRF9JRlJBTUVfTE9BREVEOiAnYWQtaWZyYW1lLWxvYWRlZCcsXG4gIC8vIFRoaXMgdHJpZ2dlciBpcyBub3QgcGFydCBvZiB0aGUgbm9ybWFsIGFkcyBsaWZlY3ljbGUgYW5kIG9ubHkgZmlyZXMgd2hlbiBhblxuICAvLyBhZCBpcyByZWZyZXNoZWQuXG4gIEFEX1JFRlJFU0g6ICdhZC1yZWZyZXNoJyxcbn07XG5cbi8qKlxuICogTWFwcyB0aGUgbmFtZXMgb2YgbGlmZWN5Y2xlIGV2ZW50cyB0byBhbmFseXRpY3MgdHJpZ2dlcnMuXG4gKiBAY29uc3QgeyFPYmplY3Q8c3RyaW5nLCAhQW5hbHl0aWNzVHJpZ2dlcj59XG4gKi9cbmNvbnN0IExJRkVDWUNMRV9TVEFHRV9UT19BTkFMWVRJQ1NfVFJJR0dFUiA9IHtcbiAgJ2FkUmVxdWVzdFN0YXJ0JzogQW5hbHl0aWNzVHJpZ2dlci5BRF9SRVFVRVNUX1NUQVJULFxuICAnYWRSZXF1ZXN0RW5kJzogQW5hbHl0aWNzVHJpZ2dlci5BRF9SRVNQT05TRV9FTkQsXG4gICdyZW5kZXJGcmllbmRseVN0YXJ0JzogQW5hbHl0aWNzVHJpZ2dlci5BRF9SRU5ERVJfU1RBUlQsXG4gICdyZW5kZXJDcm9zc0RvbWFpblN0YXJ0JzogQW5hbHl0aWNzVHJpZ2dlci5BRF9SRU5ERVJfU1RBUlQsXG4gICdyZW5kZXJTYWZlRnJhbWVTdGFydCc6IEFuYWx5dGljc1RyaWdnZXIuQURfUkVOREVSX1NUQVJULFxuICAncmVuZGVyRnJpZW5kbHlFbmQnOiBBbmFseXRpY3NUcmlnZ2VyLkFEX1JFTkRFUl9FTkQsXG4gICdyZW5kZXJDcm9zc0RvbWFpbkVuZCc6IEFuYWx5dGljc1RyaWdnZXIuQURfUkVOREVSX0VORCxcbiAgJ2ZyaWVuZGx5SWZyYW1lSW5pTG9hZCc6IEFuYWx5dGljc1RyaWdnZXIuQURfSUZSQU1FX0xPQURFRCxcbiAgJ2Nyb3NzRG9tYWluSWZyYW1lTG9hZGVkJzogQW5hbHl0aWNzVHJpZ2dlci5BRF9JRlJBTUVfTE9BREVELFxufTtcblxuLyoqXG4gKiBUaGUgc2FuZGJveGluZyBmbGFncyB0byB1c2Ugd2hlbiBhcHBseWluZyB0aGUgXCJzYW5kYm94XCIgYXR0cmlidXRlIHRvIGFkXG4gKiBpZnJhbWVzLiBTZWUgaHR0cDovL2dvL21kbi9IVE1ML0VsZW1lbnQvaWZyYW1lI2F0dHItc2FuZGJveC5cbiAqIEBjb25zdCB7c3RyaW5nfSBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IElGUkFNRV9TQU5EQk9YSU5HX0ZMQUdTID0gJ2FsbG93LWZvcm1zIGFsbG93LXBvaW50ZXItbG9jayAnICtcbiAgICAnYWxsb3ctcG9wdXBzIGFsbG93LXBvcHVwcy10by1lc2NhcGUtc2FuZGJveCBhbGxvdy1zYW1lLW9yaWdpbiAnICtcbiAgICAnYWxsb3ctc2NyaXB0cyBhbGxvdy10b3AtbmF2aWdhdGlvbi1ieS11c2VyLWFjdGl2YXRpb24nO1xuXG4vKipcbiAqIFV0aWxpdHkgZnVuY3Rpb24gdGhhdCBlbnN1cmVzIGFueSBlcnJvciB0aHJvd24gaXMgaGFuZGxlZCBieSBvcHRpb25hbFxuICogb25FcnJvciBoYW5kbGVyIChpZiBub25lIHByb3ZpZGVkIG9yIGhhbmRsZXIgdGhyb3dzLCBlcnJvciBpcyBzd2FsbG93ZWQgYW5kXG4gKiB1bmRlZmluZWQgaXMgcmV0dXJuZWQpLlxuICogQHBhcmFtIHshRnVuY3Rpb259IGZuIHRvIHByb3RlY3RcbiAqIEBwYXJhbSB7VD19IGluVGhpcyBBbiBvcHRpb25hbCBvYmplY3QgdG8gdXNlIGFzIHRoZSAndGhpcycgb2JqZWN0XG4gKiAgICB3aGVuIGNhbGxpbmcgdGhlIGZ1bmN0aW9uLiAgSWYgbm90IHByb3ZpZGVkLCB1bmRlZmluZWQgaXMgYm91bmQgYXMgdGhpc1xuICogICAgd2hlbiBjYWxsaW5nIGZ1bmN0aW9uLlxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlQsICFFcnJvciwgLi4uKik6Pz19IG9uRXJyb3IgZnVuY3Rpb24gZ2l2ZW4gZXJyb3JcbiAqICAgIGFuZCBhcmd1bWVudHMgcHJvdmlkZWQgdG8gZnVuY3Rpb24gY2FsbC5cbiAqIEByZXR1cm4geyFGdW5jdGlvbn0gcHJvdGVjdGVkIGZ1bmN0aW9uXG4gKiBAdGVtcGxhdGUgVFxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwcm90ZWN0RnVuY3Rpb25XcmFwcGVyKFxuICBmbiwgaW5UaGlzID0gdW5kZWZpbmVkLCBvbkVycm9yID0gdW5kZWZpbmVkKSB7XG4gIHJldHVybiAoLi4uZm5BcmdzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBmbi5hcHBseShpblRoaXMsIGZuQXJncyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBpZiAob25FcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIC8vIElkZWFsbHkgd2UgY291bGQgdXNlIFtlcnIsIC4uLnZhcl9hcmdzXSBidXQgbGludGVyIGRpc2FsbG93c1xuICAgICAgICAgIC8vIHNwcmVhZCBzbyBpbnN0ZWFkIHVzaW5nIHVuc2hpZnQgOihcbiAgICAgICAgICBmbkFyZ3MudW5zaGlmdChlcnIpO1xuICAgICAgICAgIHJldHVybiBvbkVycm9yLmFwcGx5KGluVGhpcywgZm5BcmdzKTtcbiAgICAgICAgfSBjYXRjaCAoY2FwdHVyZUVycikge1xuICAgICAgICAgIC8vIHN3YWxsb3cgZXJyb3IgaWYgZXJyb3IgaGFuZGxlciB0aHJvd3MuXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIEluIHRoZSBldmVudCBvZiBubyBvcHRpb25hbCBvbiBlcnJvciBmdW5jdGlvbiBvciBpdHMgZXhlY3V0aW9uIHRocm93cyxcbiAgICAgIC8vIHJldHVybiB1bmRlZmluZWQuXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgfTtcbn1cblxuLyoqIEFic3RyYWN0IGNsYXNzIGZvciBBTVAgQWQgRmFzdCBGZXRjaCBlbmFibGVkIG5ldHdvcmtzICovXG5leHBvcnQgY2xhc3MgQW1wQTRBIGV4dGVuZHMgQU1QLkJhc2VFbGVtZW50IHtcbiAgLy8gVE9ETzogQWRkIG1vcmUgZXJyb3IgaGFuZGxpbmcgdGhyb3VnaG91dCBjb2RlLlxuICAvLyBUT0RPOiBIYW5kbGUgY3JlYXRpdmVzIHRoYXQgZG8gbm90IGZpbGwuXG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAgICovXG4gIGNvbnN0cnVjdG9yKGVsZW1lbnQpIHtcbiAgICBzdXBlcihlbGVtZW50KTtcbiAgICBkZXYoKS5hc3NlcnQoQU1QLkFtcEFkVUlIYW5kbGVyKTtcbiAgICBkZXYoKS5hc3NlcnQoQU1QLkFtcEFkWE9yaWdpbklmcmFtZUhhbmRsZXIpO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/UHJvbWlzZTx1bmRlZmluZWQ+fSAqL1xuICAgIHRoaXMua2V5c2V0UHJvbWlzZV8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/UHJvbWlzZTw/Q3JlYXRpdmVNZXRhRGF0YURlZj59ICovXG4gICAgdGhpcy5hZFByb21pc2VfID0gbnVsbDtcblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlIHtudW1iZXJ9IHVuaXF1ZSBJRCBvZiB0aGUgY3VycmVudGx5IGV4ZWN1dGluZyBwcm9taXNlIHRvIGFsbG93XG4gICAgICogZm9yIGNhbmNlbGxhdGlvbi5cbiAgICAgKi9cbiAgICB0aGlzLnByb21pc2VJZF8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/c3RyaW5nfSAqL1xuICAgIHRoaXMuYWRVcmxfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7Py4uLy4uLy4uL3NyYy9mcmllbmRseS1pZnJhbWUtZW1iZWQuRnJpZW5kbHlJZnJhbWVFbWJlZH0gKi9cbiAgICB0aGlzLmZyaWVuZGx5SWZyYW1lRW1iZWRfID0gbnVsbDtcblxuICAgIC8qKiB7P0FNUC5BbXBBZFVJSGFuZGxlcn0gKi9cbiAgICB0aGlzLnVpSGFuZGxlciA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUgez9BTVAuQW1wQWRYT3JpZ2luSWZyYW1lSGFuZGxlcn0gKi9cbiAgICB0aGlzLnhPcmlnaW5JZnJhbWVIYW5kbGVyXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59IHdoZXRoZXIgY3JlYXRpdmUgaGFzIGJlZW4gdmVyaWZpZWQgYXMgQU1QICovXG4gICAgdGhpcy5pc1ZlcmlmaWVkQW1wQ3JlYXRpdmVfID0gZmFsc2U7XG5cbiAgICAvKiogQHByaXZhdGUgez9BcnJheUJ1ZmZlcn0gKi9cbiAgICB0aGlzLmNyZWF0aXZlQm9keV8gPSBudWxsO1xuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSB0aGlzIHdpdGggdGhlIHNsb3Qgd2lkdGgvaGVpZ2h0IGF0dHJpYnV0ZXMsIGFuZCBvdmVycmlkZVxuICAgICAqIGxhdGVyIHdpdGggd2hhdCB0aGUgbmV0d29yayBpbXBsZW1lbnRhdGlvbiByZXR1cm5zIHZpYSBleHRyYWN0U2l6ZS5cbiAgICAgKiBOb3RlOiBFaXRoZXIgdmFsdWUgbWF5IGJlICdhdXRvJyAoaS5lLiwgbm9uLW51bWVyaWMpLlxuICAgICAqXG4gICAgICogQHByaXZhdGUgez8oe3dpZHRoLCBoZWlnaHR9fC4uLy4uLy4uL3NyYy9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmKX1cbiAgICAgKi9cbiAgICB0aGlzLmNyZWF0aXZlU2l6ZV8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/Li4vLi4vLi4vc3JjL2xheW91dC1yZWN0LkxheW91dFJlY3REZWZ9ICovXG4gICAgdGhpcy5vcmlnaW5hbFNsb3RTaXplXyA9IG51bGw7XG5cbiAgICAvKipcbiAgICAgKiBOb3RlKGtlaXRod3JpZ2h0Ym9zKSAtIGVuc3VyZSB0aGUgZGVmYXVsdCBoZXJlIGlzIG51bGwgc28gdGhhdCBpb3NcbiAgICAgKiB1c2VzIHNhZmVmcmFtZSB3aGVuIHJlc3BvbnNlIGhlYWRlciBpcyBub3Qgc3BlY2lmaWVkLlxuICAgICAqIEBwcml2YXRlIHs/WE9SSUdJTl9NT0RFfVxuICAgICAqL1xuICAgIHRoaXMuZXhwZXJpbWVudGFsTm9uQW1wQ3JlYXRpdmVSZW5kZXJNZXRob2RfID1cbiAgICAgICAgdGhpcy5nZXROb25BbXBDcmVhdGl2ZVJlbmRlcmluZ01ldGhvZCgpO1xuXG4gICAgLyoqXG4gICAgICogV2hldGhlciBvciBub3QgdGhlIGlmcmFtZSBjb250YWluaW5nIHRoZSBhZCBzaG91bGQgYmUgc2FuZGJveGVkIHZpYSB0aGVcbiAgICAgKiBcInNhbmRib3hcIiBhdHRyaWJ1dGUuXG4gICAgICogQHByaXZhdGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgdGhpcy5zaG91bGRTYW5kYm94XyA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogR2V0cyBhIG5vdGlvbiBvZiBjdXJyZW50IHRpbWUsIGluIG1zLiAgVGhlIHZhbHVlIGlzIG5vdCBuZWNlc3NhcmlseVxuICAgICAqIGFic29sdXRlLCBzbyBzaG91bGQgYmUgdXNlZCBvbmx5IGZvciBjb21wdXRpbmcgZGVsdGFzLiAgV2hlbiBhdmFpbGFibGUsXG4gICAgICogdGhlIHBlcmZvcm1hbmNlIHN5c3RlbSB3aWxsIGJlIHVzZWQ7IG90aGVyd2lzZSBEYXRlLm5vdygpIHdpbGwgYmVcbiAgICAgKiByZXR1cm5lZC5cbiAgICAgKlxuICAgICAqIEBjb25zdCB7ZnVuY3Rpb24oKTpudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy5nZXROb3dfID0gKHRoaXMud2luLnBlcmZvcm1hbmNlICYmIHRoaXMud2luLnBlcmZvcm1hbmNlLm5vdykgP1xuICAgICAgdGhpcy53aW4ucGVyZm9ybWFuY2Uubm93LmJpbmQodGhpcy53aW4ucGVyZm9ybWFuY2UpIDogRGF0ZS5ub3c7XG5cbiAgICAvKiogQGNvbnN0IHtzdHJpbmd9ICovXG4gICAgdGhpcy5zZW50aW5lbCA9IGdlbmVyYXRlU2VudGluZWwod2luZG93KTtcblxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gaW5kaWNhdGUgd2hldGhlciB0aGlzIHNsb3Qgc2hvdWxkIGJlIGNvbGxhcHNlZCBvciBub3QuIE1hcmtlZFxuICAgICAqIHRydWUgaWYgdGhlIGFkIHJlc3BvbnNlIGhhcyBzdGF0dXMgMjA0LCBpcyBudWxsLCBvciBoYXMgYSBudWxsXG4gICAgICogYXJyYXlCdWZmZXIuXG4gICAgICogQHByaXZhdGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgdGhpcy5pc0NvbGxhcHNlZF8gPSBmYWxzZTtcblxuICAgIC8qKlxuICAgICAqIEZyYW1lIGluIHdoaWNoIHRoZSBjcmVhdGl2ZSByZW5kZXJzIChmcmllbmRseSBpZiB2YWxpZGF0ZWQgQU1QLCB4ZG9tYWluXG4gICAgICogb3RoZXJ3aXNlKS5cbiAgICAgKiB7P0hUTUxJZnJhbWVFbGVtZW50fVxuICAgICAqL1xuICAgIHRoaXMuaWZyYW1lID0gbnVsbDtcblxuICAgIC8qKlxuICAgICAqIFRPRE8oa2VpdGh3cmlnaHRib3MpIC0gcmVtb3ZlIG9uY2UgcmVzdW1lIGJlaGF2aW9yIGlzIHZlcmlmaWVkLlxuICAgICAqIHtib29sZWFufSB3aGV0aGVyIG1vc3QgcmVjZW50IGFkIHJlcXVlc3Qgd2FzIGdlbmVyYXRlZCBhcyBwYXJ0XG4gICAgICogICAgb2YgcmVzdW1lIGNhbGxiYWNrLlxuICAgICAqL1xuICAgIHRoaXMuZnJvbVJlc3VtZUNhbGxiYWNrID0gZmFsc2U7XG5cbiAgICAvKiogQHR5cGUge3N0cmluZ30gKi9cbiAgICB0aGlzLnNhZmVmcmFtZVZlcnNpb24gPSBERUZBVUxUX1NBRkVGUkFNRV9WRVJTSU9OO1xuXG4gICAgLyoqXG4gICAgICogQHByb3RlY3RlZCB7Ym9vbGVhbn0gSW5kaWNhdGVzIHdoZXRoZXIgdGhlIGFkIGlzIGN1cnJlbnRseSBpbiB0aGVcbiAgICAgKiAgICBwcm9jZXNzIG9mIGJlaW5nIHJlZnJlc2hlZC5cbiAgICAgKi9cbiAgICB0aGlzLmlzUmVmcmVzaGluZyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcm90ZWN0ZWQge2Jvb2xlYW59ICovXG4gICAgdGhpcy5pc1JlbGF5b3V0TmVlZGVkRmxhZyA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogVXNlZCBhcyBhIHNpZ25hbCBpbiBzb21lIG9mIHRoZSBDU0kgcGluZ3MuXG4gICAgICogQHByaXZhdGUgQGNvbnN0IHtzdHJpbmd9XG4gICAgICovXG4gICAgdGhpcy5yZWxlYXNlVHlwZV8gPSBnZXRCaW5hcnlUeXBlTnVtZXJpY2FsQ29kZShnZXRCaW5hcnlUeXBlKHRoaXMud2luKSkgfHxcbiAgICAgICAgJy0xJztcblxuICAgIC8qKlxuICAgICAqIE1hcHBpbmcgb2YgZmVhdHVyZSBuYW1lIHRvIHZhbHVlIGV4dHJhY3RlZCBmcm9tIGFkIHJlc3BvbnNlIGhlYWRlclxuICAgICAqIGFtcC1mZi1leHBzIHdpdGggY29tbWEgc2VwYXJhdGVkIHBhaXJzIG9mICc9JyBzZXBhcmF0ZWQga2V5L3ZhbHVlLlxuICAgICAqIEB0eXBlIHshT2JqZWN0PHN0cmluZyxzdHJpbmc+fVxuICAgICAqL1xuICAgIHRoaXMucG9zdEFkUmVzcG9uc2VFeHBlcmltZW50RmVhdHVyZXMgPSB7fTtcblxuICAgIC8qKlxuICAgICAqIFRoZSBjb25maWd1cmF0aW9uIGZvciBhbXAtYW5hbHl0aWNzLiBJZiBudWxsLCBubyBhbXAtYW5hbHl0aWNzIGVsZW1lbnRcbiAgICAgKiB3aWxsIGJlIGluc2VydGVkIGFuZCBubyBhbmFseXRpY3MgZXZlbnRzIHdpbGwgYmUgZmlyZWQuXG4gICAgICogVGhpcyB3aWxsIGJlIGluaXRpYWxpemVkIGluc2lkZSBvZiBidWlsZENhbGxiYWNrLlxuICAgICAqIEBwcml2YXRlIHs/SnNvbk9iamVjdH1cbiAgICAgKi9cbiAgICB0aGlzLmE0YUFuYWx5dGljc0NvbmZpZ18gPSBudWxsO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGFtcC1hbmFseXRpY3MgZWxlbWVudCB0aGF0IGZvciB0aGlzIGltcGwncyBhbmFseXRpY3MgY29uZmlnLiBJdCB3aWxsXG4gICAgICogYmUgbnVsbCBiZWZvcmUgYnVpbGRDYWxsYmFjaygpIGV4ZWN1dGVzIG9yIGlmIHRoZSBpbXBsIGRvZXMgbm90IHByb3ZpZGVcbiAgICAgKiBhbiBhbmFseXRpY2UgY29uZmlnLlxuICAgICAqIEBwcml2YXRlIHs/RWxlbWVudH1cbiAgICAgKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAgICAgKi9cbiAgICB0aGlzLmE0YUFuYWx5dGljc0VsZW1lbnRfID0gbnVsbDtcblxuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGF0IHRoaXMgc2xvdCBpcyBhIHNpbmdsZSBwYWdlIGFkIHdpdGhpbiBhbiBBTVAgc3RvcnkuXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgdGhpcy5pc1NpbmdsZVBhZ2VTdG9yeUFkID0gZmFsc2U7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGdldExheW91dFByaW9yaXR5KCkge1xuICAgIC8vIFByaW9yaXR5IHVzZWQgZm9yIHNjaGVkdWxpbmcgcHJlbG9hZCBhbmQgbGF5b3V0IGNhbGxiYWNrLiAgQmVjYXVzZVxuICAgIC8vIEFNUCBjcmVhdGl2ZXMgd2lsbCBiZSBpbmplY3RlZCBhcyBwYXJ0IG9mIHRoZSBwcm9taXNlIGNoYWluIGNyZWF0ZWRcbiAgICAvLyB3aXRoaW4gb25MYXlvdXRNZWFzdXJlLCB0aGlzIGlzIG9ubHkgcmVsZXZhbnQgdG8gbm9uLUFNUCBjcmVhdGl2ZXNcbiAgICAvLyB0aGVyZWZvcmUgd2Ugd2FudCB0aGlzIHRvIG1hdGNoIHRoZSAzcCBwcmlvcml0eS5cbiAgICBjb25zdCBpc1BXQSA9ICF0aGlzLmVsZW1lbnQuZ2V0QW1wRG9jKCkuaXNTaW5nbGVEb2MoKTtcbiAgICAvLyBnaXZlIHRoZSBhZCBoaWdoZXIgcHJpb3JpdHkgaWYgaXQgaXMgaW5zaWRlIGEgUFdBXG4gICAgcmV0dXJuIGlzUFdBID8gTGF5b3V0UHJpb3JpdHkuTUVUQURBVEEgOiBMYXlvdXRQcmlvcml0eS5BRFM7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGlzTGF5b3V0U3VwcG9ydGVkKGxheW91dCkge1xuICAgIHJldHVybiBpc0xheW91dFNpemVEZWZpbmVkKGxheW91dCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGlzUmVsYXlvdXROZWVkZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNSZWxheW91dE5lZWRlZEZsYWc7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGJ1aWxkQ2FsbGJhY2soKSB7XG4gICAgdGhpcy5jcmVhdGl2ZVNpemVfID0ge1xuICAgICAgd2lkdGg6IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3dpZHRoJyksXG4gICAgICBoZWlnaHQ6IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2hlaWdodCcpLFxuICAgIH07XG4gICAgY29uc3QgdXBncmFkZURlbGF5TXMgPSBNYXRoLnJvdW5kKHRoaXMuZ2V0UmVzb3VyY2UoKS5nZXRVcGdyYWRlRGVsYXlNcygpKTtcbiAgICBkZXYoKS5pbmZvKFRBRyxcbiAgICAgICAgYHVwZ3JhZGVEZWxheSAke3RoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKX06ICR7dXBncmFkZURlbGF5TXN9YCk7XG5cbiAgICB0aGlzLnVpSGFuZGxlciA9IG5ldyBBTVAuQW1wQWRVSUhhbmRsZXIodGhpcyk7XG5cbiAgICBjb25zdCB2ZXJpZmllciA9IHNpZ25hdHVyZVZlcmlmaWVyRm9yKHRoaXMud2luKTtcbiAgICB0aGlzLmtleXNldFByb21pc2VfID1cbiAgICAgICAgU2VydmljZXMudmlld2VyRm9yRG9jKHRoaXMuZ2V0QW1wRG9jKCkpLndoZW5GaXJzdFZpc2libGUoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmdldFNpZ25pbmdTZXJ2aWNlTmFtZXMoKS5mb3JFYWNoKHNpZ25pbmdTZXJ2aWNlTmFtZSA9PiB7XG4gICAgICAgICAgICB2ZXJpZmllci5sb2FkS2V5c2V0KHNpZ25pbmdTZXJ2aWNlTmFtZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgdGhpcy5hNGFBbmFseXRpY3NDb25maWdfID0gdGhpcy5nZXRBNGFBbmFseXRpY3NDb25maWcoKTtcbiAgICBpZiAodGhpcy5hNGFBbmFseXRpY3NDb25maWdfKSB7XG4gICAgICAvLyBUT0RPKHdhcnJlbmdtKTogQ29uc2lkZXIgaGF2aW5nIHBhZ2UtbGV2ZWwgc2luZ2xldG9ucyBmb3IgbmV0d29ya3MgdGhhdFxuICAgICAgLy8gdXNlIHRoZSBzYW1lIGNvbmZpZyBmb3IgYWxsIGFkcy5cbiAgICAgIHRoaXMuYTRhQW5hbHl0aWNzRWxlbWVudF8gPSBpbnNlcnRBbmFseXRpY3NFbGVtZW50KFxuICAgICAgICAgIHRoaXMuZWxlbWVudCwgdGhpcy5hNGFBbmFseXRpY3NDb25maWdfLCB0cnVlIC8qIGxvYWRBbmFseXRpY3MgKi8pO1xuICAgIH1cblxuICAgIHRoaXMuaXNTaW5nbGVQYWdlU3RvcnlBZCA9IHRoaXMuZWxlbWVudC5oYXNBdHRyaWJ1dGUoJ2FtcC1zdG9yeScpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICByZW5kZXJPdXRzaWRlVmlld3BvcnQoKSB7XG4gICAgLy8gRW5zdXJlIG5vbi12ZXJpZmllZCBBTVAgY3JlYXRpdmVzIGFyZSB0aHJvdHRsZWQuXG4gICAgaWYgKCF0aGlzLmlzVmVyaWZpZWRBbXBDcmVhdGl2ZV8gJiYgaXMzcFRocm90dGxlZCh0aGlzLndpbikgJiZcbiAgICAgICAgIXRoaXMuaW5Ob25BbXBQcmVmZXJlbmNlRXhwKCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gT3RoZXJ3aXNlIHRoZSBhZCBpcyBnb29kIHRvIGdvLlxuICAgIGNvbnN0IGVsZW1lbnRDaGVjayA9IGdldEFtcEFkUmVuZGVyT3V0c2lkZVZpZXdwb3J0KHRoaXMuZWxlbWVudCk7XG4gICAgcmV0dXJuIGVsZW1lbnRDaGVjayAhPT0gbnVsbCA/XG4gICAgICBlbGVtZW50Q2hlY2sgOiBzdXBlci5yZW5kZXJPdXRzaWRlVmlld3BvcnQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUbyBiZSBvdmVycmlkZGVuIGJ5IG5ldHdvcmsgc3BlY2lmaWMgaW1wbGVtZW50YXRpb24gaW5kaWNhdGluZyBpZiBlbGVtZW50XG4gICAqIChhbmQgZW52aXJvbm1lbnQgZ2VuZXJhbGx5KSBhcmUgdmFsaWQgZm9yIHNlbmRpbmcgWEhSIHF1ZXJpZXMuXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IHdoZXRoZXIgZWxlbWVudCBpcyB2YWxpZCBhbmQgYWQgcmVxdWVzdCBzaG91bGQgYmVcbiAgICogICAgc2VudC4gIElmIGZhbHNlLCBubyBhZCByZXF1ZXN0IGlzIHNlbnQgYW5kIHNsb3Qgd2lsbCBiZSBjb2xsYXBzZWQgaWZcbiAgICogICAgcG9zc2libGUuXG4gICAqL1xuICBpc1ZhbGlkRWxlbWVudCgpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBjcmVhdGl2ZVNpemUsIHdoaWNoIGlzIHRoZSBzaXplIGV4dHJhY3RlZCBmcm9tIHRoZSBhZCByZXNwb25zZS5cbiAgICogQHJldHVybiB7Pyh7d2lkdGgsIGhlaWdodH18Li4vLi4vLi4vc3JjL2xheW91dC1yZWN0LkxheW91dFJlY3REZWYpfVxuICAgKi9cbiAgZ2V0Q3JlYXRpdmVTaXplKCkge1xuICAgIHJldHVybiB0aGlzLmNyZWF0aXZlU2l6ZV87XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7Ym9vbGVhbnxudW1iZXJ9IHdoZXRoZXIgYWQgcmVxdWVzdCBzaG91bGQgYmUgZGVsYXllZCB1bnRpbFxuICAgKiAgICByZW5kZXJPdXRzaWRlVmlld3BvcnQgaXMgbWV0IG9yIGlmIG51bWJlciwgdGhlIGFtb3VudCBvZiB2aWV3cG9ydHMuXG4gICAqL1xuICBkZWxheUFkUmVxdWVzdEVuYWJsZWQoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgcHJlY29ubmVjdCB1cmxzIGZvciBBNEEuIEFkIG5ldHdvcmsgc2hvdWxkIG92ZXJ3cml0ZSBpbiB0aGVpclxuICAgKiBGYXN0IEZldGNoIGltcGxlbWVudGF0aW9uIGFuZCByZXR1cm4gYW4gYXJyYXkgb2YgdXJscyBmb3IgdGhlIHJ1bnRpbWUgdG9cbiAgICogcHJlY29ubmVjdCB0by5cbiAgICogQHJldHVybiB7IUFycmF5PHN0cmluZz59XG4gICAqL1xuICBnZXRQcmVjb25uZWN0VXJscygpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBwcmVmZXRjaCB1cmxzIGZvciBBNEEuIEFkIG5ldHdvcmsgc2hvdWxkIG92ZXJ3cml0ZSBpbiB0aGVpclxuICAgKiBGYXN0IEZldGNoIGltcGxlbWVudGF0aW9uIGFuZCByZXR1cm4gYW4gYXJyYXkgb2YgdXJscyBmb3IgdGhlIHJ1bnRpbWUgdG9cbiAgICogcHJlZmV0Y2guXG4gICAqIEByZXR1cm4geyFBcnJheTxzdHJpbmc+fVxuICAgKi9cbiAgZ2V0UHJlZmV0Y2hVcmxzKCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBlbGVtZW50IHdhcyBsb2FkZWQgZnJvbSBhbiBhbXAtYWQgZWxlbWVudC4gIEZvciB1c2UgYnlcbiAgICogbmV0d29yay1zcGVjaWZpYyBpbXBsZW1lbnRhdGlvbnMgdGhhdCBkb24ndCB3YW50IHRvIGFsbG93IHRoZW1zZWx2ZXMgdG8gYmVcbiAgICogZW1iZWRkZWQgZGlyZWN0bHkgaW50byBhIHBhZ2UuXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBpc0FtcEFkRWxlbWVudCgpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50LnRhZ05hbWUgPT0gJ0FNUC1BRCcgfHxcbiAgICAgICAgdGhpcy5lbGVtZW50LnRhZ05hbWUgPT0gJ0FNUC1FTUJFRCc7XG4gIH1cblxuICAvKipcbiAgICogUHJlZmV0Y2hlcyBhbmQgcHJlY29ubmVjdHMgVVJMcyByZWxhdGVkIHRvIHRoZSBhZCB1c2luZyBhZFByZWNvbm5lY3RcbiAgICogcmVnaXN0cmF0aW9uIHdoaWNoIGFzc3VtZXMgYWQgcmVxdWVzdCBkb21haW4gdXNlZCBmb3IgM3AgaXMgYXBwbGljYWJsZS5cbiAgICogQHBhcmFtIHtib29sZWFuPX0gdW51c2VkT25MYXlvdXRcbiAgICogQG92ZXJyaWRlXG4gICAqL1xuICBwcmVjb25uZWN0Q2FsbGJhY2sodW51c2VkT25MYXlvdXQpIHtcbiAgICBjb25zdCBwcmVjb25uZWN0ID0gdGhpcy5nZXRQcmVjb25uZWN0VXJscygpO1xuICAgIC8vIE5PVEUoa2VpdGh3cmlnaHRib3MpOiBEb2VzIG5vdCB0YWtlIGlzVmFsaWRFbGVtZW50IGludG8gYWNjb3VudCBzbyBjb3VsZFxuICAgIC8vIHByZWNvbm5lY3QgdW5uZWNlc3NhcmlseSwgaG93ZXZlciBpdCBpcyBhc3N1bWVkIHRoYXQgaXNWYWxpZEVsZW1lbnRcbiAgICAvLyBtYXRjaGVzIGFtcC1hZCBsb2FkZXIgcHJlZGljYXRlIHN1Y2ggdGhhdCBBNEEgaW1wbCBkb2VzIG5vdCBsb2FkLlxuICAgIGlmIChwcmVjb25uZWN0KSB7XG4gICAgICBwcmVjb25uZWN0LmZvckVhY2gocCA9PiB7XG4gICAgICAgIHRoaXMucHJlY29ubmVjdC51cmwocCwgLypvcHRfcHJlbG9hZEFzKi90cnVlKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgcmVzdW1lQ2FsbGJhY2soKSB7XG4gICAgLy8gRklFIHRoYXQgd2FzIG5vdCBkZXN0cm95ZWQgb24gdW5sYXlvdXRDYWxsYmFjayBkb2VzIG5vdCByZXF1aXJlIGEgbmV3XG4gICAgLy8gYWQgcmVxdWVzdC5cbiAgICBpZiAodGhpcy5mcmllbmRseUlmcmFtZUVtYmVkXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmZyb21SZXN1bWVDYWxsYmFjayA9IHRydWU7XG4gICAgLy8gSWYgbGF5b3V0IG9mIHBhZ2UgaGFzIG5vdCBjaGFuZ2VkLCBvbkxheW91dE1lYXN1cmUgd2lsbCBub3QgYmUgY2FsbGVkXG4gICAgLy8gc28gZG8gc28gZXhwbGljaXRseS5cbiAgICBjb25zdCByZXNvdXJjZSA9IHRoaXMuZ2V0UmVzb3VyY2UoKTtcbiAgICBpZiAocmVzb3VyY2UuaGFzQmVlbk1lYXN1cmVkKCkgJiYgIXJlc291cmNlLmlzTWVhc3VyZVJlcXVlc3RlZCgpKSB7XG4gICAgICB0aGlzLm9uTGF5b3V0TWVhc3VyZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshLi4vLi4vLi4vc3JjL3NlcnZpY2UvcmVzb3VyY2UuUmVzb3VyY2V9XG4gICAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICAgKi9cbiAgZ2V0UmVzb3VyY2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5nZXRSZXNvdXJjZXMoKS5nZXRSZXNvdXJjZUZvckVsZW1lbnQodGhpcy5lbGVtZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHtib29sZWFufSB3aGV0aGVyIGFkUHJvbWlzZSB3YXMgaW5pdGlhbGl6ZWQgKGluZGljYXRvciBvZlxuICAgKiAgICBlbGVtZW50IHZhbGlkaXR5KS5cbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgaGFzQWRQcm9taXNlKCkge1xuICAgIHJldHVybiAhIXRoaXMuYWRQcm9taXNlXztcbiAgfVxuXG4gIC8qKlxuICAgKiBTaG91bGQgb25seSBiZSBjYWxsZWQgYWZ0ZXIgWEhSIHJlc3BvbnNlIGhlYWRlcnMgaGF2ZSBiZWVuIHByb2Nlc3NlZCBhbmRcbiAgICogcG9zdEFkUmVzcG9uc2VFeHBlcmltZW50RmVhdHVyZXMgaXMgcG9wdWxhdGVkLlxuICAgKiBAcmV0dXJuIHtib29sZWFufSB3aGV0aGVyIGluIGV4cGVyaW1lbnQgZ2l2aW5nIG5vbi1BTVAgY3JlYXRpdmVzIHNhbWVcbiAgICogICAgYmVuZWZpdHMgYXMgQU1QIChpbmNyZWFzZWQgcHJpb3JpdHksIG5vIHRocm90dGxlKVxuICAgKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAgICovXG4gIGluTm9uQW1wUHJlZmVyZW5jZUV4cCgpIHtcbiAgICByZXR1cm4gISF0aGlzLnBvc3RBZFJlc3BvbnNlRXhwZXJpbWVudEZlYXR1cmVzWydwcmVmX25ldXRyYWxfZW5hYmxlZCddICYmXG4gICAgICBbJ2Fkc2Vuc2UnLCAnZG91YmxlY2xpY2snXS5pbmNsdWRlcyh0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IHdoZXRoZXIgZW52aXJvbm1lbnQvZWxlbWVudCBzaG91bGQgaW5pdGlhbGl6ZSBhZCByZXF1ZXN0XG4gICAqICAgIHByb21pc2UgY2hhaW4uXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzaG91bGRJbml0aWFsaXplUHJvbWlzZUNoYWluXygpIHtcbiAgICBjb25zdCBzbG90UmVjdCA9IHRoaXMuZ2V0SW50ZXJzZWN0aW9uRWxlbWVudExheW91dEJveCgpO1xuICAgIGlmICh0aGlzLmdldExheW91dCgpICE9IExheW91dC5GTFVJRCAmJlxuICAgICAgICAoc2xvdFJlY3QuaGVpZ2h0ID09IDAgfHwgc2xvdFJlY3Qud2lkdGggPT0gMCkpIHtcbiAgICAgIGRldigpLmZpbmUoXG4gICAgICAgICAgVEFHLCAnb25MYXlvdXRNZWFzdXJlIGNhbmNlbGVkIGR1ZSBoZWlnaHQvd2lkdGggMCcsIHRoaXMuZWxlbWVudCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmICghaXNBZFBvc2l0aW9uQWxsb3dlZCh0aGlzLmVsZW1lbnQsIHRoaXMud2luKSkge1xuICAgICAgdXNlcigpLndhcm4oVEFHLCBgPCR7dGhpcy5lbGVtZW50LnRhZ05hbWV9PiBpcyBub3QgYWxsb3dlZCB0byBiZSBgICtcbiAgICAgICAgYHBsYWNlZCBpbiBlbGVtZW50cyB3aXRoIHBvc2l0aW9uOmZpeGVkOiAke3RoaXMuZWxlbWVudH1gKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gT25MYXlvdXRNZWFzdXJlIGNhbiBiZSBjYWxsZWQgd2hlbiBwYWdlIGlzIGluIHByZXJlbmRlciBzbyBkZWxheSB1bnRpbFxuICAgIC8vIHZpc2libGUuICBBc3N1bWUgdGhhdCBpdCBpcyBvayB0byBjYWxsIGlzVmFsaWRFbGVtZW50IGFzIGl0IHNob3VsZFxuICAgIC8vIG9ubHkgYmVpbmcgbG9va2luZyBhdCB3aW5kb3csIGltbXV0YWJsZSBwcm9wZXJ0aWVzIChpLmUuIGxvY2F0aW9uKSBhbmRcbiAgICAvLyBpdHMgZWxlbWVudCBhbmNlc3RyeS5cbiAgICBpZiAoIXRoaXMuaXNWYWxpZEVsZW1lbnQoKSkge1xuICAgICAgLy8gVE9ETyhrandyaWdodCk6IGNvbGxhcHNlP1xuICAgICAgdXNlcigpLndhcm4oVEFHLCB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJyksXG4gICAgICAgICAgJ0FtcCBhZCBlbGVtZW50IGlnbm9yZWQgYXMgaW52YWxpZCcsIHRoaXMuZWxlbWVudCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBvbkxheW91dE1lYXN1cmUoKSB7XG4gICAgdGhpcy5pbml0aWF0ZUFkUmVxdWVzdCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgaXMgdGhlIGVudHJ5IHBvaW50IGludG8gdGhlIGFkIHByb21pc2UgY2hhaW4uXG4gICAqXG4gICAqIENhbGxpbmcgdGhpcyBmdW5jdGlvbiB3aWxsIGluaXRpYXRlIHRoZSBmb2xsb3dpbmcgc2VxdWVuY2Ugb2YgZXZlbnRzOiBhZFxuICAgKiB1cmwgY29uc3RydWN0aW9uLCBhZCByZXF1ZXN0IGlzc3VhbmNlLCBjcmVhdGl2ZSB2ZXJpZmljYXRpb24sIGFuZCBtZXRhZGF0YVxuICAgKiBwYXJzaW5nLlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBpbml0aWF0ZUFkUmVxdWVzdCgpIHtcbiAgICBpZiAodGhpcy54T3JpZ2luSWZyYW1lSGFuZGxlcl8pIHtcbiAgICAgIHRoaXMueE9yaWdpbklmcmFtZUhhbmRsZXJfLm9uTGF5b3V0TWVhc3VyZSgpO1xuICAgIH1cbiAgICBpZiAodGhpcy5hZFByb21pc2VfIHx8ICF0aGlzLnNob3VsZEluaXRpYWxpemVQcm9taXNlQ2hhaW5fKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBJbmNyZW1lbnQgdW5pcXVlIHByb21pc2UgSUQgc28gdGhhdCBpZiBpdHMgdmFsdWUgY2hhbmdlcyB3aXRoaW4gdGhlXG4gICAgLy8gcHJvbWlzZSBjaGFpbiBkdWUgdG8gY2FuY2VsIGZyb20gdW5sYXlvdXQsIHRoZSBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQuXG4gICAgKyt0aGlzLnByb21pc2VJZF87XG5cbiAgICAvLyBTaG9ydGhhbmQgZm9yOiByZWplY3QgcHJvbWlzZSBpZiBjdXJyZW50IHByb21pc2UgY2hhaW4gaXMgb3V0IG9mIGRhdGUuXG4gICAgY29uc3QgY2hlY2tTdGlsbEN1cnJlbnQgPSB0aGlzLnZlcmlmeVN0aWxsQ3VycmVudCgpO1xuXG4gICAgLy8gUmV0dXJuIHZhbHVlIGZyb20gdGhpcyBjaGFpbjogVHJ1ZSBpZmYgcmVuZGVyaW5nIHdhcyBcInN1Y2Nlc3NmdWxcIlxuICAgIC8vIChpLmUuLCBzaG91bGRuJ3QgdHJ5IHRvIHJlbmRlciBsYXRlciB2aWEgaWZyYW1lKTsgZmFsc2UgaWZmIHNob3VsZFxuICAgIC8vIHRyeSB0byByZW5kZXIgbGF0ZXIgaW4gaWZyYW1lLlxuICAgIC8vIENhc2VzIHRvIGhhbmRsZSBpbiB0aGlzIGNoYWluOlxuICAgIC8vICAgLSBFdmVyeXRoaW5nIG9rICA9PiBSZW5kZXI7IHJldHVybiB0cnVlXG4gICAgLy8gICAtIEVtcHR5IG5ldHdvcmsgcmVzcG9uc2UgcmV0dXJuZWQgPT4gRG9uJ3QgcmVuZGVyOyByZXR1cm4gdHJ1ZVxuICAgIC8vICAgLSBDYW4ndCBwYXJzZSBjcmVhdGl2ZSBvdXQgb2YgcmVzcG9uc2UgPT4gRG9uJ3QgcmVuZGVyOyByZXR1cm4gZmFsc2VcbiAgICAvLyAgIC0gQ2FuIHBhcnNlLCBidXQgY3JlYXRpdmUgaXMgZW1wdHkgPT4gRG9uJ3QgcmVuZGVyOyByZXR1cm4gdHJ1ZVxuICAgIC8vICAgLSBWYWxpZGF0aW9uIGZhaWxzID0+IHJldHVybiBmYWxzZVxuICAgIC8vICAgLSBSZW5kZXJpbmcgZmFpbHMgPT4gcmV0dXJuIGZhbHNlXG4gICAgLy8gICAtIENoYWluIGNhbmNlbGxlZCA9PiBkb24ndCByZXR1cm47IGRyb3AgZXJyb3JcbiAgICAvLyAgIC0gVW5jYXVnaHQgZXJyb3Igb3RoZXJ3aXNlID0+IGRvbid0IHJldHVybjsgcGVyY29sYXRlIGVycm9yIHVwXG4gICAgdGhpcy5hZFByb21pc2VfID0gU2VydmljZXMudmlld2VyRm9yRG9jKHRoaXMuZ2V0QW1wRG9jKCkpLndoZW5GaXJzdFZpc2libGUoKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgY2hlY2tTdGlsbEN1cnJlbnQoKTtcbiAgICAgICAgICAvLyBTZWUgaWYgZXhwZXJpbWVudCB0aGF0IGRlbGF5cyByZXF1ZXN0IHVudGlsIHNsb3QgaXMgd2l0aGluXG4gICAgICAgICAgLy8gcmVuZGVyT3V0c2lkZVZpZXdwb3J0LiBXaXRoaW4gcmVuZGVyIG91dHNpZGUgdmlld3BvcnQgd2lsbCBub3RcbiAgICAgICAgICAvLyByZXNvbHZlIGlmIGFscmVhZHkgd2l0aGluIHZpZXdwb3J0IHRodXMgdGhlIGNoZWNrIGZvciBhbHJlYWR5XG4gICAgICAgICAgLy8gbWVldGluZyB0aGUgZGVmaW5pdGlvbiBhcyBvcHBvc2VkIHRvIHdhaXRpbmcgb24gdGhlIHByb21pc2UuXG4gICAgICAgICAgY29uc3QgZGVsYXkgPSB0aGlzLmRlbGF5QWRSZXF1ZXN0RW5hYmxlZCgpO1xuICAgICAgICAgIGlmIChkZWxheSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmVzb3VyY2UoKS53aGVuV2l0aGluVmlld3BvcnQoXG4gICAgICAgICAgICAgICAgdHlwZW9mIGRlbGF5ID09ICdudW1iZXInID8gZGVsYXkgOlxuICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJPdXRzaWRlVmlld3BvcnQoKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAvLyBQb3NzaWJseSBibG9jayBvbiBhbXAtY29uc2VudC5cbiAgICAgICAgLyoqIEByZXR1cm4geyFQcm9taXNlPD9DT05TRU5UX1BPTElDWV9TVEFURT59ICovXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICBjaGVja1N0aWxsQ3VycmVudCgpO1xuICAgICAgICAgIGNvbnN0IGNvbnNlbnRQb2xpY3lJZCA9IHN1cGVyLmdldENvbnNlbnRQb2xpY3koKTtcbiAgICAgICAgICByZXR1cm4gY29uc2VudFBvbGljeUlkID9cbiAgICAgICAgICAgIGdldENvbnNlbnRQb2xpY3lTdGF0ZSh0aGlzLmdldEFtcERvYygpLCBjb25zZW50UG9saWN5SWQpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICB1c2VyKCkuZXJyb3IoVEFHLCAnRXJyb3IgZGV0ZXJtaW5pbmcgY29uc2VudCBzdGF0ZScsIGVycik7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gQ09OU0VOVF9QT0xJQ1lfU1RBVEUuVU5LTk9XTjtcbiAgICAgICAgICAgICAgICB9KSA6IFByb21pc2UucmVzb2x2ZShudWxsKTtcbiAgICAgICAgfSlcbiAgICAgICAgLy8gVGhpcyBibG9jayByZXR1cm5zIHRoZSBhZCBVUkwsIGlmIG9uZSBpcyBhdmFpbGFibGUuXG4gICAgICAgIC8qKiBAcmV0dXJuIHshUHJvbWlzZTw/c3RyaW5nPn0gKi9cbiAgICAgICAgLnRoZW4oY29uc2VudFN0YXRlID0+IHtcbiAgICAgICAgICBjaGVja1N0aWxsQ3VycmVudCgpO1xuICAgICAgICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9zdHJpbmc+fSAqLyh0aGlzLmdldEFkVXJsKFxuICAgICAgICAgICAgICBjb25zZW50U3RhdGUsIHRoaXMudHJ5RXhlY3V0ZVJlYWxUaW1lQ29uZmlnXyhjb25zZW50U3RhdGUpKSk7XG4gICAgICAgIH0pXG4gICAgICAgIC8vIFRoaXMgYmxvY2sgcmV0dXJucyB0aGUgKHBvc3NpYmx5IGVtcHR5KSByZXNwb25zZSB0byB0aGUgWEhSIHJlcXVlc3QuXG4gICAgICAgIC8qKiBAcmV0dXJuIHshUHJvbWlzZTw/UmVzcG9uc2U+fSAqL1xuICAgICAgICAudGhlbihhZFVybCA9PiB7XG4gICAgICAgICAgY2hlY2tTdGlsbEN1cnJlbnQoKTtcbiAgICAgICAgICB0aGlzLmFkVXJsXyA9IGFkVXJsO1xuICAgICAgICAgIC8vIElmIHdlIHNob3VsZCBza2lwIHRoZSBYSFIsIHdlIHdpbGwgaW5zdGVhZCByZXF1ZXN0IGFuZCByZW5kZXJcbiAgICAgICAgICAvLyBieSBzaW1wbHkgd3JpdGluZyBhIGZyYW1lIGludG8gdGhlIHBhZ2UgdXNpbmdcbiAgICAgICAgICAvLyByZW5kZXJWaWFJZnJhbWVHZXRcbiAgICAgICAgICBpZiAoIXRoaXMuaXNYaHJBbGxvd2VkKCkgJiYgISF0aGlzLmFkVXJsXykge1xuICAgICAgICAgICAgdGhpcy5leHBlcmltZW50YWxOb25BbXBDcmVhdGl2ZVJlbmRlck1ldGhvZF8gPVxuICAgICAgICAgICAgICAgIFhPUklHSU5fTU9ERS5JRlJBTUVfR0VUO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KElGUkFNRV9HRVQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gYWRVcmwgJiYgdGhpcy5zZW5kWGhyUmVxdWVzdChhZFVybCk7XG4gICAgICAgIH0pXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYmxvY2sgcmV0dXJucyBlaXRoZXIgdGhlIHJlc3BvbnNlIChhcyBhXG4gICAgICAgIC8vIHtieXRlcywgaGVhZGVyc30gb2JqZWN0KSwgb3IgbnVsbCBpZiBubyByZXNwb25zZSBpcyBhdmFpbGFibGUgL1xuICAgICAgICAvLyByZXNwb25zZSBpcyBlbXB0eS5cbiAgICAgICAgLyoqIEByZXR1cm4gez9Qcm9taXNlPD97Ynl0ZXM6ICFBcnJheUJ1ZmZlciwgaGVhZGVyczogIUhlYWRlcnN9Pn0gKi9cbiAgICAgICAgLnRoZW4oZmV0Y2hSZXNwb25zZSA9PiB7XG4gICAgICAgICAgY2hlY2tTdGlsbEN1cnJlbnQoKTtcbiAgICAgICAgICB0aGlzLm1heWJlVHJpZ2dlckFuYWx5dGljc0V2ZW50XygnYWRSZXF1ZXN0RW5kJyk7XG4gICAgICAgICAgLy8gSWYgdGhlIHJlc3BvbnNlIGlzIG51bGwgKGNhbiBvY2N1ciBmb3Igbm9uLTIwMCByZXNwb25zZXMpICBvclxuICAgICAgICAgIC8vIGFycmF5QnVmZmVyIGlzIG51bGwsIGZvcmNlIGNvbGxhcHNlLlxuICAgICAgICAgIGlmICghZmV0Y2hSZXNwb25zZSB8fCAhZmV0Y2hSZXNwb25zZS5hcnJheUJ1ZmZlciB8fFxuICAgICAgICAgICAgICBmZXRjaFJlc3BvbnNlLmhlYWRlcnMuaGFzKCdhbXAtZmYtZW1wdHktY3JlYXRpdmUnKSkge1xuICAgICAgICAgICAgdGhpcy5mb3JjZUNvbGxhcHNlKCk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoTk9fQ09OVEVOVF9SRVNQT05TRSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChmZXRjaFJlc3BvbnNlLmhlYWRlcnMgJiYgZmV0Y2hSZXNwb25zZS5oZWFkZXJzLmhhcyhcbiAgICAgICAgICAgICAgRVhQRVJJTUVOVF9GRUFUVVJFX0hFQURFUl9OQU1FKSkge1xuICAgICAgICAgICAgdGhpcy5wb3B1bGF0ZVBvc3RBZFJlc3BvbnNlRXhwZXJpbWVudEZlYXR1cmVzXyhcbiAgICAgICAgICAgICAgICBmZXRjaFJlc3BvbnNlLmhlYWRlcnMuZ2V0KEVYUEVSSU1FTlRfRkVBVFVSRV9IRUFERVJfTkFNRSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZ2V0TW9kZSgpLmxvY2FsRGV2ICYmIHRoaXMud2luLmxvY2F0aW9uICYmXG4gICAgICAgICAgICAgIHRoaXMud2luLmxvY2F0aW9uLnNlYXJjaCkge1xuICAgICAgICAgICAgLy8gQWxsb3cgZm9yIHNldHRpbmcgZXhwZXJpbWVudCBmZWF0dXJlcyB2aWEgcXVlcnkgcGFyYW0gd2hpY2hcbiAgICAgICAgICAgIC8vIHdpbGwgcG90ZW50aWFsbHkgb3ZlcnJpZGUgdmFsdWVzIHJldHVybmVkIGluIHJlc3BvbnNlLlxuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSAvKD86XFw/fCYpYTRhX2ZlYXRfZXhwPShbXiZdKykvLmV4ZWMoXG4gICAgICAgICAgICAgICAgdGhpcy53aW4ubG9jYXRpb24uc2VhcmNoKTtcbiAgICAgICAgICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSkge1xuICAgICAgICAgICAgICBkZXYoKS5pbmZvKFRBRywgYFVzaW5nIGRlYnVnIGV4cCBmZWF0dXJlczogJHttYXRjaFsxXX1gKTtcbiAgICAgICAgICAgICAgdGhpcy5wb3B1bGF0ZVBvc3RBZFJlc3BvbnNlRXhwZXJpbWVudEZlYXR1cmVzXyhcbiAgICAgICAgICAgICAgICAgIHRyeURlY29kZVVyaUNvbXBvbmVudChtYXRjaFsxXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBUT0RPKHRkcmwpOiBUZW1wb3JhcnksIHdoaWxlIHdlJ3JlIHZlcmlmeWluZyB3aGV0aGVyIFNhZmVGcmFtZSBpc1xuICAgICAgICAgIC8vIGFuIGFjY2VwdGFibGUgc29sdXRpb24gdG8gdGhlICdTYWZhcmkgb24gaU9TIGRvZXNuJ3QgZmV0Y2hcbiAgICAgICAgICAvLyBpZnJhbWUgc3JjIGZyb20gY2FjaGUnIGlzc3VlLiAgU2VlXG4gICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FtcHByb2plY3QvYW1waHRtbC9pc3N1ZXMvNTYxNFxuICAgICAgICAgIGNvbnN0IG1ldGhvZCA9IHRoaXMuZ2V0Tm9uQW1wQ3JlYXRpdmVSZW5kZXJpbmdNZXRob2QoXG4gICAgICAgICAgICAgIGZldGNoUmVzcG9uc2UuaGVhZGVycy5nZXQoUkVOREVSSU5HX1RZUEVfSEVBREVSKSk7XG4gICAgICAgICAgdGhpcy5leHBlcmltZW50YWxOb25BbXBDcmVhdGl2ZVJlbmRlck1ldGhvZF8gPSBtZXRob2Q7XG4gICAgICAgICAgaWYgKHRoaXMuZXhwZXJpbWVudGFsTm9uQW1wQ3JlYXRpdmVSZW5kZXJNZXRob2RfID09XG4gICAgICAgICAgICAgIFhPUklHSU5fTU9ERS5OQU1FRlJBTUUpIHtcbiAgICAgICAgICAgIHRoaXMucHJlY29ubmVjdC5wcmVsb2FkKFxuICAgICAgICAgICAgICAgIGdldERlZmF1bHRCb290c3RyYXBCYXNlVXJsKHRoaXMud2luLCAnbmFtZWZyYW1lJykpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBicm93c2VyU3VwcG9ydHNTYW5kYm94ID0gdGhpcy53aW4uSFRNTElGcmFtZUVsZW1lbnQgJiZcbiAgICAgICAgICAgICAgJ3NhbmRib3gnIGluIHRoaXMud2luLkhUTUxJRnJhbWVFbGVtZW50LnByb3RvdHlwZTtcbiAgICAgICAgICB0aGlzLnNob3VsZFNhbmRib3hfID0gYnJvd3NlclN1cHBvcnRzU2FuZGJveCAmJlxuICAgICAgICAgICAgICBmZXRjaFJlc3BvbnNlLmhlYWRlcnMuZ2V0KFNBTkRCT1hfSEVBREVSKSA9PSAndHJ1ZSc7XG4gICAgICAgICAgY29uc3Qgc2FmZWZyYW1lVmVyc2lvbkhlYWRlciA9XG4gICAgICAgICAgICBmZXRjaFJlc3BvbnNlLmhlYWRlcnMuZ2V0KFNBRkVGUkFNRV9WRVJTSU9OX0hFQURFUik7XG4gICAgICAgICAgaWYgKC9eWzAtOS1dKyQvLnRlc3Qoc2FmZWZyYW1lVmVyc2lvbkhlYWRlcikgJiZcbiAgICAgICAgICAgICAgc2FmZWZyYW1lVmVyc2lvbkhlYWRlciAhPSBERUZBVUxUX1NBRkVGUkFNRV9WRVJTSU9OKSB7XG4gICAgICAgICAgICB0aGlzLnNhZmVmcmFtZVZlcnNpb24gPSBzYWZlZnJhbWVWZXJzaW9uSGVhZGVyO1xuICAgICAgICAgICAgdGhpcy5wcmVjb25uZWN0LnByZWxvYWQodGhpcy5nZXRTYWZlZnJhbWVQYXRoKCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBOb3RlOiBSZXNvbHZpbmcgYSAudGhlbiBpbnNpZGUgYSAudGhlbiBiZWNhdXNlIHdlIG5lZWQgdG8gY2FwdHVyZVxuICAgICAgICAgIC8vIHR3byBmaWVsZHMgb2YgZmV0Y2hSZXNwb25zZSwgb25lIG9mIHdoaWNoIGlzLCBpdHNlbGYsIGEgcHJvbWlzZSxcbiAgICAgICAgICAvLyBhbmQgb25lIG9mIHdoaWNoIGlzbid0LiAgSWYgd2UganVzdCByZXR1cm5cbiAgICAgICAgICAvLyBmZXRjaFJlc3BvbnNlLmFycmF5QnVmZmVyKCksIHRoZSBuZXh0IHN0ZXAgaW4gdGhlIGNoYWluIHdpbGxcbiAgICAgICAgICAvLyByZXNvbHZlIGl0IHRvIGEgY29uY3JldGUgdmFsdWUsIGJ1dCB3ZSdsbCBsb3NlIHRyYWNrIG9mXG4gICAgICAgICAgLy8gZmV0Y2hSZXNwb25zZS5oZWFkZXJzLlxuICAgICAgICAgIHJldHVybiBmZXRjaFJlc3BvbnNlLmFycmF5QnVmZmVyKCkudGhlbihieXRlcyA9PiB7XG4gICAgICAgICAgICBpZiAoYnl0ZXMuYnl0ZUxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgIC8vIFRoZSBzZXJ2ZXIgcmV0dXJuZWQgbm8gY29udGVudC4gSW5zdGVhZCBvZiBkaXNwbGF5aW5nIGEgYmxhbmtcbiAgICAgICAgICAgICAgLy8gcmVjdGFuZ2xlLCB3ZSBjb2xsYXBzZSB0aGUgc2xvdCBpbnN0ZWFkLlxuICAgICAgICAgICAgICB0aGlzLmZvcmNlQ29sbGFwc2UoKTtcbiAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KE5PX0NPTlRFTlRfUkVTUE9OU0UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgYnl0ZXMsXG4gICAgICAgICAgICAgIGhlYWRlcnM6IGZldGNoUmVzcG9uc2UuaGVhZGVycyxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgICAgIC8qKiBAcmV0dXJuIHshUHJvbWlzZTw/QXJyYXlCdWZmZXI+fSAqL1xuICAgICAgICAudGhlbihyZXNwb25zZVBhcnRzID0+IHtcbiAgICAgICAgICBjaGVja1N0aWxsQ3VycmVudCgpO1xuICAgICAgICAgIC8vIEtlZXAgYSBoYW5kbGUgdG8gdGhlIGNyZWF0aXZlIGJvZHkgc28gdGhhdCB3ZSBjYW4gcmVuZGVyIGludG9cbiAgICAgICAgICAvLyBTYWZlRnJhbWUgb3IgTmFtZUZyYW1lIGxhdGVyLCBpZiBuZWNlc3NhcnkuICBUT0RPKHRkcmwpOiBUZW1wb3JhcnksXG4gICAgICAgICAgLy8gd2hpbGUgd2VcbiAgICAgICAgICAvLyBhc3Nlc3Mgd2hldGhlciB0aGlzIGlzIHRoZSByaWdodCBzb2x1dGlvbiB0byB0aGUgU2FmYXJpK2lPUyBpZnJhbWVcbiAgICAgICAgICAvLyBzcmMgY2FjaGUgaXNzdWUuICBJZiB3ZSBkZWNpZGUgdG8ga2VlcCBhIFNhZmVGcmFtZS1saWtlIHNvbHV0aW9uLFxuICAgICAgICAgIC8vIHdlIHNob3VsZCByZXN0cnVjdHVyZSB0aGUgcHJvbWlzZSBjaGFpbiB0byBwYXNzIHRoaXMgaW5mbyBhbG9uZ1xuICAgICAgICAgIC8vIG1vcmUgY2xlYW5seSwgd2l0aG91dCB1c2Ugb2YgYW4gb2JqZWN0IHZhcmlhYmxlIG91dHNpZGUgdGhlIGNoYWluLlxuICAgICAgICAgIGlmICghcmVzcG9uc2VQYXJ0cykge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB7Ynl0ZXMsIGhlYWRlcnN9ID0gcmVzcG9uc2VQYXJ0cztcbiAgICAgICAgICBjb25zdCBzaXplID0gdGhpcy5leHRyYWN0U2l6ZShyZXNwb25zZVBhcnRzLmhlYWRlcnMpO1xuICAgICAgICAgIHRoaXMuY3JlYXRpdmVTaXplXyA9IHNpemUgfHwgdGhpcy5jcmVhdGl2ZVNpemVfO1xuICAgICAgICAgIGlmICh0aGlzLmV4cGVyaW1lbnRhbE5vbkFtcENyZWF0aXZlUmVuZGVyTWV0aG9kXyAhPVxuICAgICAgICAgICAgICBYT1JJR0lOX01PREUuQ0xJRU5UX0NBQ0hFICYmXG4gICAgICAgICAgICAgIGJ5dGVzKSB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0aXZlQm9keV8gPSBieXRlcztcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRoaXMubWF5YmVWYWxpZGF0ZUFtcENyZWF0aXZlKGJ5dGVzLCBoZWFkZXJzKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oY3JlYXRpdmUgPT4ge1xuICAgICAgICAgIGNoZWNrU3RpbGxDdXJyZW50KCk7XG4gICAgICAgICAgLy8gTmVlZCB0byBrbm93IGlmIGNyZWF0aXZlIHdhcyB2ZXJpZmllZCBhcyBwYXJ0IG9mIHJlbmRlciBvdXRzaWRlXG4gICAgICAgICAgLy8gdmlld3BvcnQgYnV0IGNhbm5vdCB3YWl0IG9uIHByb21pc2UuICBTYWRseSwgbmVlZCBhIHN0YXRlIGFcbiAgICAgICAgICAvLyB2YXJpYWJsZS5cbiAgICAgICAgICB0aGlzLmlzVmVyaWZpZWRBbXBDcmVhdGl2ZV8gPSAhIWNyZWF0aXZlO1xuICAgICAgICAgIHJldHVybiBjcmVhdGl2ZSAmJiB1dGY4RGVjb2RlKGNyZWF0aXZlKTtcbiAgICAgICAgfSlcbiAgICAgICAgLy8gVGhpcyBibG9jayByZXR1cm5zIENyZWF0aXZlTWV0YURhdGFEZWYgaWZmIHRoZSBjcmVhdGl2ZSB3YXMgdmVyaWZpZWRcbiAgICAgICAgLy8gYXMgQU1QIGFuZCBjb3VsZCBiZSBwcm9wZXJseSBwYXJzZWQgZm9yIGZyaWVuZGx5IGlmcmFtZSByZW5kZXIuXG4gICAgICAgIC8qKiBAcmV0dXJuIHs/Q3JlYXRpdmVNZXRhRGF0YURlZn0gKi9cbiAgICAgICAgLnRoZW4oY3JlYXRpdmVEZWNvZGVkID0+IHtcbiAgICAgICAgICBjaGVja1N0aWxsQ3VycmVudCgpO1xuICAgICAgICAgIC8vIE5vdGU6IEl0J3MgY3JpdGljYWwgdGhhdCAjZ2V0QW1wQWRNZXRhZGF0YSBiZSBjYWxsZWRcbiAgICAgICAgICAvLyBvbiBwcmVjaXNlbHkgdGhlIHNhbWUgY3JlYXRpdmUgdGhhdCB3YXMgdmFsaWRhdGVkXG4gICAgICAgICAgLy8gdmlhICN2YWxpZGF0ZUFkUmVzcG9uc2VfLiAgU2VlIEdpdEh1YiBpc3N1ZVxuICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hbXBwcm9qZWN0L2FtcGh0bWwvaXNzdWVzLzQxODdcbiAgICAgICAgICBsZXQgY3JlYXRpdmVNZXRhRGF0YURlZjtcbiAgICAgICAgICBpZiAoIWNyZWF0aXZlRGVjb2RlZCB8fFxuICAgICAgICAgICAgIShjcmVhdGl2ZU1ldGFEYXRhRGVmID0gdGhpcy5nZXRBbXBBZE1ldGFkYXRhKGNyZWF0aXZlRGVjb2RlZCkpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pbk5vbkFtcFByZWZlcmVuY2VFeHAoKSkge1xuICAgICAgICAgICAgICAvLyBFeHBlcmltZW50IHRvIGdpdmUgbm9uLUFNUCBjcmVhdGl2ZXMgc2FtZSBiZW5lZml0cyBhcyBBTVAgc29cbiAgICAgICAgICAgICAgLy8gdXBkYXRlIHByaW9yaXR5LlxuICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUxheW91dFByaW9yaXR5KExheW91dFByaW9yaXR5LkNPTlRFTlQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gVXBkYXRlIHByaW9yaXR5LlxuICAgICAgICAgIHRoaXMudXBkYXRlTGF5b3V0UHJpb3JpdHkoTGF5b3V0UHJpb3JpdHkuQ09OVEVOVCk7XG4gICAgICAgICAgLy8gTG9hZCBhbnkgZXh0ZW5zaW9uczsgZG8gbm90IHdhaXQgb24gdGhlaXIgcHJvbWlzZXMgYXMgdGhpc1xuICAgICAgICAgIC8vIGlzIGp1c3QgdG8gcHJlZmV0Y2guXG4gICAgICAgICAgY29uc3QgZXh0ZW5zaW9ucyA9IFNlcnZpY2VzLmV4dGVuc2lvbnNGb3IodGhpcy53aW4pO1xuICAgICAgICAgIGNyZWF0aXZlTWV0YURhdGFEZWYuY3VzdG9tRWxlbWVudEV4dGVuc2lvbnMuZm9yRWFjaChcbiAgICAgICAgICAgICAgZXh0ZW5zaW9uSWQgPT4gZXh0ZW5zaW9ucy5wcmVsb2FkRXh0ZW5zaW9uKGV4dGVuc2lvbklkKSk7XG4gICAgICAgICAgLy8gUHJlbG9hZCBhbnkgZm9udHMuXG4gICAgICAgICAgKGNyZWF0aXZlTWV0YURhdGFEZWYuY3VzdG9tU3R5bGVzaGVldHMgfHwgW10pLmZvckVhY2goZm9udCA9PlxuICAgICAgICAgICAgdGhpcy5wcmVjb25uZWN0LnByZWxvYWQoZm9udC5ocmVmKSk7XG5cbiAgICAgICAgICBjb25zdCB1cmxzID0gU2VydmljZXMudXJsRm9yRG9jKHRoaXMuZ2V0QW1wRG9jKCkpO1xuICAgICAgICAgIC8vIFByZWxvYWQgYW55IEFNUCBpbWFnZXMuXG4gICAgICAgICAgKGNyZWF0aXZlTWV0YURhdGFEZWYuaW1hZ2VzIHx8IFtdKS5mb3JFYWNoKGltYWdlID0+XG4gICAgICAgICAgICB1cmxzLmlzU2VjdXJlKGltYWdlKSAmJiB0aGlzLnByZWNvbm5lY3QucHJlbG9hZChpbWFnZSkpO1xuICAgICAgICAgIHJldHVybiBjcmVhdGl2ZU1ldGFEYXRhRGVmO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgIHN3aXRjaCAoZXJyb3IubWVzc2FnZSB8fCBlcnJvcikge1xuICAgICAgICAgICAgY2FzZSBJRlJBTUVfR0VUOlxuICAgICAgICAgICAgY2FzZSBORVRXT1JLX0ZBSUxVUkU6XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgY2FzZSBJTlZBTElEX1NQU0FfUkVTUE9OU0U6XG4gICAgICAgICAgICBjYXNlIE5PX0NPTlRFTlRfUkVTUE9OU0U6XG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbWluaWZpZWRDcmVhdGl2ZTogJycsXG4gICAgICAgICAgICAgICAgY3VzdG9tRWxlbWVudEV4dGVuc2lvbnM6IFtdLFxuICAgICAgICAgICAgICAgIGN1c3RvbVN0eWxlc2hlZXRzOiBbXSxcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gSWYgZXJyb3IgaW4gY2hhaW4gb2NjdXJzLCByZXBvcnQgaXQgYW5kIHJldHVybiBudWxsIHNvIHRoYXRcbiAgICAgICAgICAvLyBsYXlvdXRDYWxsYmFjayBjYW4gcmVuZGVyIHZpYSBjcm9zcyBkb21haW4gaWZyYW1lIGFzc3VtaW5nIGFkXG4gICAgICAgICAgLy8gdXJsIG9yIGNyZWF0aXZlIGV4aXN0LlxuICAgICAgICAgIHRoaXMucHJvbWlzZUVycm9ySGFuZGxlcl8oZXJyb3IpO1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIGJsb2NrIHJldHVybnMgdGhlIGFkIGNyZWF0aXZlIGlmIGl0IGV4aXN0cyBhbmQgdmFsaWRhdGVzIGFzIEFNUDtcbiAgICogbnVsbCBvdGhlcndpc2UuXG4gICAqIEBwYXJhbSB7IUFycmF5QnVmZmVyfSBieXRlc1xuICAgKiBAcGFyYW0geyFIZWFkZXJzfSBoZWFkZXJzXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD9BcnJheUJ1ZmZlcj59XG4gICAqL1xuICBtYXliZVZhbGlkYXRlQW1wQ3JlYXRpdmUoYnl0ZXMsIGhlYWRlcnMpIHtcbiAgICBjb25zdCBjaGVja1N0aWxsQ3VycmVudCA9IHRoaXMudmVyaWZ5U3RpbGxDdXJyZW50KCk7XG4gICAgcmV0dXJuIHRoaXMua2V5c2V0UHJvbWlzZV9cbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykgPT0gJ2Zha2UnICYmXG4gICAgICAgICAgICAgICF0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdjaGVja3NpZycpKSB7XG4gICAgICAgICAgICAvLyBkbyBub3QgdmVyaWZ5IHNpZ25hdHVyZSBmb3IgZmFrZSB0eXBlIGFkLCB1bmxlc3MgdGhlIGFkXG4gICAgICAgICAgICAvLyBzcGVjZmljYWxseSByZXF1aXJlcyB2aWEgJ2NoZWNrc2lnJyBhdHRyaWJ1dGVcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoVmVyaWZpY2F0aW9uU3RhdHVzLk9LKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHNpZ25hdHVyZVZlcmlmaWVyRm9yKHRoaXMud2luKS52ZXJpZnkoYnl0ZXMsIGhlYWRlcnMpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihzdGF0dXMgPT4ge1xuICAgICAgICAgIGNoZWNrU3RpbGxDdXJyZW50KCk7XG4gICAgICAgICAgbGV0IHJlc3VsdCA9IG51bGw7XG4gICAgICAgICAgc3dpdGNoIChzdGF0dXMpIHtcbiAgICAgICAgICAgIGNhc2UgVmVyaWZpY2F0aW9uU3RhdHVzLk9LOlxuICAgICAgICAgICAgICByZXN1bHQgPSBieXRlcztcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFZlcmlmaWNhdGlvblN0YXR1cy5DUllQVE9fVU5BVkFJTEFCTEU6XG4gICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuc2hvdWxkUHJlZmVyZW50aWFsUmVuZGVyV2l0aG91dENyeXB0bygpID9cbiAgICAgICAgICAgICAgICBieXRlcyA6IG51bGw7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgLy8gVE9ETyhAdGF5bW9uYmVhbCwgIzkyNzQpOiBkaWZmZXJlbnRpYXRlIGJldHdlZW4gdGhlc2VcbiAgICAgICAgICAgIGNhc2UgVmVyaWZpY2F0aW9uU3RhdHVzLkVSUk9SX0tFWV9OT1RfRk9VTkQ6XG4gICAgICAgICAgICBjYXNlIFZlcmlmaWNhdGlvblN0YXR1cy5FUlJPUl9TSUdOQVRVUkVfTUlTTUFUQ0g6XG4gICAgICAgICAgICAgIHVzZXIoKS5lcnJvcihcbiAgICAgICAgICAgICAgICAgIFRBRywgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpLFxuICAgICAgICAgICAgICAgICAgJ1NpZ25hdHVyZSB2ZXJpZmljYXRpb24gZmFpbGVkJyk7XG4gICAgICAgICAgICBjYXNlIFZlcmlmaWNhdGlvblN0YXR1cy5VTlZFUklGSUVEOlxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodGhpcy5pc1NpbmdsZVBhZ2VTdG9yeUFkICYmICFyZXN1bHQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihJTlZBTElEX1NQU0FfUkVTUE9OU0UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQb3B1bGF0ZXMgb2JqZWN0IG1hcHBpbmcgb2YgZmVhdHVyZSB0byB2YWx1ZSB1c2VkIGZvciBwb3N0IGFkIHJlc3BvbnNlXG4gICAqIGJlaGF2aW9yIGV4cGVyaW1lbnRhdGlvbi4gIEFzc3VtZXMgY29tbWEgc2VwYXJhdGVkLCA9IGRlbGltaXRlZCBrZXkvdmFsdWVcbiAgICogcGFpcnMuICBJZiBrZXkgYXBwZWFycyBtb3JlIHRoYW4gb25jZSwgbGFzdCB2YWx1ZSB3aW5zLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gaW5wdXRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHBvcHVsYXRlUG9zdEFkUmVzcG9uc2VFeHBlcmltZW50RmVhdHVyZXNfKGlucHV0KSB7XG4gICAgaW5wdXQuc3BsaXQoJywnKS5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgaWYgKCFsaW5lKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHBhcnRzID0gbGluZS5zcGxpdCgnPScpO1xuICAgICAgaWYgKHBhcnRzLmxlbmd0aCAhPSAyIHx8ICFwYXJ0c1swXSkge1xuICAgICAgICBkZXYoKS53YXJuKFRBRywgYGludmFsaWQgZXhwZXJpbWVudCBmZWF0dXJlICR7bGluZX1gKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5wb3N0QWRSZXNwb25zZUV4cGVyaW1lbnRGZWF0dXJlc1twYXJ0c1swXV0gPSBwYXJ0c1sxXTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWZyZXNoZXMgYWQgc2xvdCBieSBmZXRjaGluZyBhIG5ldyBjcmVhdGl2ZSBhbmQgcmVuZGVyaW5nIGl0LiBUaGlzIGxlYXZlc1xuICAgKiB0aGUgY3VycmVudCBjcmVhdGl2ZSBkaXNwbGF5ZWQgdW50aWwgdGhlIG5leHQgb25lIGlzIHJlYWR5LlxuICAgKlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IHJlZnJlc2hFbmRDYWxsYmFjayBXaGVuIGNhbGxlZCwgdGhpcyBmdW5jdGlvbiB3aWxsXG4gICAqICAgcmVzdGFydCB0aGUgcmVmcmVzaCBjeWNsZS5cbiAgICogQHJldHVybiB7UHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2hlbiBhbGwgYXN5bmNocm9ub3VzIHBvcnRpb25zIG9mXG4gICAqICAgdGhlIHJlZnJlc2ggZnVuY3Rpb24gY29tcGxldGUuIFRoaXMgaXMgcGFydGljdWxhcmx5IGhhbmR5IGZvciB0ZXN0aW5nLlxuICAgKi9cbiAgcmVmcmVzaChyZWZyZXNoRW5kQ2FsbGJhY2spIHtcbiAgICBkZXYoKS5hc3NlcnQoIXRoaXMuaXNSZWZyZXNoaW5nKTtcbiAgICB0aGlzLmlzUmVmcmVzaGluZyA9IHRydWU7XG4gICAgdGhpcy50ZWFyRG93blNsb3QoKTtcbiAgICB0aGlzLmluaXRpYXRlQWRSZXF1ZXN0KCk7XG4gICAgZGV2KCkuYXNzZXJ0KHRoaXMuYWRQcm9taXNlXyk7XG4gICAgY29uc3QgcHJvbWlzZUlkID0gdGhpcy5wcm9taXNlSWRfO1xuICAgIHJldHVybiB0aGlzLmFkUHJvbWlzZV8udGhlbigoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuaXNSZWZyZXNoaW5nIHx8IHByb21pc2VJZCAhPSB0aGlzLnByb21pc2VJZF8pIHtcbiAgICAgICAgLy8gSWYgdGhpcyByZWZyZXNoIGN5Y2xlIHdhcyBjYW5jZWxlZCwgc3VjaCBhcyBpbiBhIG5vLWNvbnRlbnRcbiAgICAgICAgLy8gcmVzcG9uc2UgY2FzZSwga2VlcCBzaG93aW5nIHRoZSBvbGQgY3JlYXRpdmUuXG4gICAgICAgIHJlZnJlc2hFbmRDYWxsYmFjaygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5tdXRhdGVFbGVtZW50KCgpID0+IHtcbiAgICAgICAgLy8gRmlyZSBhbiBhZC1yZWZyZXNoIGV2ZW50IHNvIHRoYXQgM3JkIHBhcnRpZXMgY2FuIHRyYWNrIHdoZW4gYW4gYWRcbiAgICAgICAgLy8gaGFzIGNoYW5nZWQuXG4gICAgICAgIHRyaWdnZXJBbmFseXRpY3NFdmVudCh0aGlzLmVsZW1lbnQsIEFuYWx5dGljc1RyaWdnZXIuQURfUkVGUkVTSCk7XG5cbiAgICAgICAgdGhpcy50b2dnbGVQbGFjZWhvbGRlcih0cnVlKTtcbiAgICAgICAgLy8gVGhpcyBkZWxheSBwcm92aWRlcyBhIDEgc2Vjb25kIGJ1ZmZlciB3aGVyZSB0aGUgYWQgbG9hZGVyIGlzXG4gICAgICAgIC8vIGRpc3BsYXllZCBpbiBiZXR3ZWVuIHRoZSBjcmVhdGl2ZXMuXG4gICAgICAgIHJldHVybiBTZXJ2aWNlcy50aW1lckZvcih0aGlzLndpbikucHJvbWlzZSgxMDAwKS50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmlzUmVsYXlvdXROZWVkZWRGbGFnID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLmdldFJlc291cmNlKCkubGF5b3V0Q2FuY2VsZWQoKTtcbiAgICAgICAgICAvLyBPbmx5IFJlcXVpcmUgcmVsYXlvdXQgYWZ0ZXIgcGFnZSB2aXNpYmxlXG4gICAgICAgICAgU2VydmljZXMudmlld2VyRm9yRG9jKHRoaXMuZ2V0QW1wRG9jKCkpLndoZW5OZXh0VmlzaWJsZSgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgU2VydmljZXMucmVzb3VyY2VzRm9yRG9jKHRoaXMuZ2V0QW1wRG9jKCkpXG4gICAgICAgICAgICAgICAgLi8qT0sqL3JlcXVpcmVMYXlvdXQodGhpcy5lbGVtZW50KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIHVuY2F1Z2h0IGVycm9ycyB3aXRoaW4gcHJvbWlzZSBmbG93LlxuICAgKiBAcGFyYW0geyp9IGVycm9yXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pZ25vcmVTdGFja1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJvbWlzZUVycm9ySGFuZGxlcl8oZXJyb3IsIG9wdF9pZ25vcmVTdGFjaykge1xuICAgIGlmIChpc0NhbmNlbGxhdGlvbihlcnJvcikpIHtcbiAgICAgIC8vIFJldGhyb3cgaWYgY2FuY2VsbGF0aW9uLlxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuXG4gICAgaWYgKGVycm9yICYmIGVycm9yLm1lc3NhZ2UpIHtcbiAgICAgIGVycm9yID0gZHVwbGljYXRlRXJyb3JJZk5lY2Vzc2FyeSgvKiogQHR5cGUgeyFFcnJvcn0gKi8oZXJyb3IpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZXJyb3IgPSBuZXcgRXJyb3IoJ3Vua25vd24gZXJyb3IgJyArIGVycm9yKTtcbiAgICB9XG4gICAgaWYgKG9wdF9pZ25vcmVTdGFjaykge1xuICAgICAgZXJyb3IuaWdub3JlU3RhY2sgPSBvcHRfaWdub3JlU3RhY2s7XG4gICAgfVxuXG4gICAgLy8gQWRkIGB0eXBlYCB0byB0aGUgbWVzc2FnZS4gRW5zdXJlIHRvIHByZXNlcnZlIHRoZSBvcmlnaW5hbCBzdGFjay5cbiAgICBjb25zdCB0eXBlID0gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpIHx8ICdub3R5cGUnO1xuICAgIGlmIChlcnJvci5tZXNzYWdlLmluZGV4T2YoYCR7VEFHfTogJHt0eXBlfTpgKSAhPSAwKSB7XG4gICAgICBlcnJvci5tZXNzYWdlID0gYCR7VEFHfTogJHt0eXBlfTogJHtlcnJvci5tZXNzYWdlfWA7XG4gICAgfVxuXG4gICAgLy8gQWRkaXRpb25hbCBhcmd1bWVudHMuXG4gICAgYXNzaWduQWRVcmxUb0Vycm9yKC8qKiBAdHlwZSB7IUVycm9yfSAqLyhlcnJvciksIHRoaXMuYWRVcmxfKTtcblxuICAgIGlmIChnZXRNb2RlKCkuZGV2ZWxvcG1lbnQgfHwgZ2V0TW9kZSgpLmxvY2FsRGV2IHx8IGdldE1vZGUoKS5sb2cpIHtcbiAgICAgIHVzZXIoKS5lcnJvcihUQUcsIGVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdXNlcigpLndhcm4oVEFHLCBlcnJvcik7XG4gICAgICAvLyBSZXBvcnQgd2l0aCAxJSBzYW1wbGluZyBhcyBhbiBleHBlY3RlZCBkZXYgZXJyb3IuXG4gICAgICBpZiAoTWF0aC5yYW5kb20oKSA8IDAuMDEpIHtcbiAgICAgICAgZGV2KCkuZXhwZWN0ZWRFcnJvcihUQUcsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGxheW91dENhbGxiYWNrKCkge1xuICAgIGlmICh0aGlzLmlzUmVmcmVzaGluZykge1xuICAgICAgdGhpcy5kZXN0cm95RnJhbWUodHJ1ZSk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmF0dGVtcHRUb1JlbmRlckNyZWF0aXZlKCk7XG4gIH1cblxuICAvKipcbiAgICogQXR0ZW1wcyB0byByZW5kZXIgdGhlIHJldHVybmVkIGNyZWF0aXZlIGZvbGxvd2luZyB0aGUgcmVzb2x1dGlvbiBvZiB0aGVcbiAgICogYWRQcm9taXNlLlxuICAgKlxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTxib29sZWFuPnwhUHJvbWlzZTx1bmRlZmluZWQ+fSBBIHByb21pc2UgdGhhdCByZXNvbHZlc1xuICAgKiAgIHdoZW4gdGhlIHJlbmRlcmluZyBhdHRlbXB0IGhhcyBmaW5pc2hlZC5cbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgYXR0ZW1wdFRvUmVuZGVyQ3JlYXRpdmUoKSB7XG4gICAgLy8gUHJvbWlzZSBtYXkgYmUgbnVsbCBpZiBlbGVtZW50IHdhcyBkZXRlcm1pbmVkIHRvIGJlIGludmFsaWQgZm9yIEE0QS5cbiAgICBpZiAoIXRoaXMuYWRQcm9taXNlXykge1xuICAgICAgaWYgKHRoaXMuc2hvdWxkSW5pdGlhbGl6ZVByb21pc2VDaGFpbl8oKSkge1xuICAgICAgICBkZXYoKS5lcnJvcihUQUcsICdOdWxsIHByb21pc2UgaW4gbGF5b3V0Q2FsbGJhY2snKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgY29uc3QgY2hlY2tTdGlsbEN1cnJlbnQgPSB0aGlzLnZlcmlmeVN0aWxsQ3VycmVudCgpO1xuICAgIC8vIFByb21pc2UgY2hhaW4gd2lsbCBoYXZlIGRldGVybWluZWQgaWYgY3JlYXRpdmUgaXMgdmFsaWQgQU1QLlxuICAgIHJldHVybiB0aGlzLmFkUHJvbWlzZV8udGhlbihjcmVhdGl2ZU1ldGFEYXRhID0+IHtcbiAgICAgIGNoZWNrU3RpbGxDdXJyZW50KCk7XG4gICAgICBpZiAodGhpcy5pc0NvbGxhcHNlZF8pIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgfVxuICAgICAgLy8gSWYgdGhpcy5pZnJhbWUgYWxyZWFkeSBleGlzdHMsIGFuZCB3ZSdyZSBub3QgY3VycmVudGx5IGluIHRoZSBtaWRkbGVcbiAgICAgIC8vIG9mIHJlZnJlc2hpbmcsIGJhaWwgb3V0IGhlcmUuIFRoaXMgc2hvdWxkIG9ubHkgaGFwcGVuIGluXG4gICAgICAvLyB0ZXN0aW5nIGNvbnRleHQsIG5vdCBpbiBwcm9kdWN0aW9uLlxuICAgICAgaWYgKHRoaXMuaWZyYW1lICYmICF0aGlzLmlzUmVmcmVzaGluZykge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICB9XG4gICAgICBpZiAoIWNyZWF0aXZlTWV0YURhdGEpIHtcbiAgICAgICAgLy8gTm9uLUFNUCBjcmVhdGl2ZSBjYXNlLCB3aWxsIHZlcmlmeSBhZCB1cmwgZXhpc3RlbmNlLlxuICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJOb25BbXBDcmVhdGl2ZSgpO1xuICAgICAgfVxuICAgICAgLy8gTXVzdCBiZSBhbiBBTVAgY3JlYXRpdmUuXG4gICAgICByZXR1cm4gdGhpcy5yZW5kZXJBbXBDcmVhdGl2ZV8oY3JlYXRpdmVNZXRhRGF0YSlcbiAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgIGNoZWNrU3RpbGxDdXJyZW50KCk7XG4gICAgICAgICAgICAvLyBGYWlsZWQgdG8gcmVuZGVyIHZpYSBBTVAgY3JlYXRpdmUgcGF0aCBzbyBmYWxsYmFjayB0byBub24tQU1QXG4gICAgICAgICAgICAvLyByZW5kZXJpbmcgd2l0aGluIGNyb3NzIGRvbWFpbiBpZnJhbWUuXG4gICAgICAgICAgICB1c2VyKCkud2FybihUQUcsIHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSxcbiAgICAgICAgICAgICAgICAnRXJyb3IgaW5qZWN0aW5nIGNyZWF0aXZlIGluIGZyaWVuZGx5IGZyYW1lJywgZXJyKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlck5vbkFtcENyZWF0aXZlKCk7XG4gICAgICAgICAgfSk7XG4gICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgdGhpcy5wcm9taXNlRXJyb3JIYW5kbGVyXyhlcnJvcik7XG4gICAgICB0aHJvdyBjYW5jZWxsYXRpb24oKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHdoZXRoZXIgb3Igbm90IHRoZSBhZCByZXF1ZXN0IG1heSBiZSBzZW50IHVzaW5nIFhIUi5cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlzWGhyQWxsb3dlZCgpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKiovXG4gIGF0dGVtcHRDaGFuZ2VTaXplKG5ld0hlaWdodCwgbmV3V2lkdGgpIHtcbiAgICAvLyBTdG9yZSBvcmlnaW5hbCBzaXplIG9mIHNsb3QgaW4gb3JkZXIgdG8gYWxsb3cgcmUtZXhwYW5zaW9uIG9uXG4gICAgLy8gdW5sYXlvdXRDYWxsYmFjayBzbyB0aGF0IGl0IGlzIHJldmVydGVkIHRvIG9yaWdpbmFsIHNpemUgaW4gY2FzZVxuICAgIC8vIG9mIHJlc3VtZUNhbGxiYWNrLlxuICAgIHRoaXMub3JpZ2luYWxTbG90U2l6ZV8gPSB0aGlzLm9yaWdpbmFsU2xvdFNpemVfIHx8IHRoaXMuZ2V0TGF5b3V0Qm94KCk7XG4gICAgcmV0dXJuIHN1cGVyLmF0dGVtcHRDaGFuZ2VTaXplKG5ld0hlaWdodCwgbmV3V2lkdGgpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAgKi9cbiAgdW5sYXlvdXRDYWxsYmFjaygpIHtcbiAgICB0aGlzLnRlYXJEb3duU2xvdCgpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIEF0dGVtcHRzIHRvIHRlYXIgZG93biBhbmQgc2V0IGFsbCBzdGF0ZSB2YXJpYWJsZXMgdG8gaW5pdGlhbCBjb25kaXRpb25zLlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICB0ZWFyRG93blNsb3QoKSB7XG4gICAgLy8gSW5jcmVtZW50IHByb21pc2VJZCB0byBjYXVzZSBhbnkgcGVuZGluZyBwcm9taXNlIHRvIGNhbmNlbC5cbiAgICB0aGlzLnByb21pc2VJZF8rKztcbiAgICB0aGlzLnVpSGFuZGxlci5hcHBseVVubGF5b3V0VUkoKTtcbiAgICBpZiAodGhpcy5vcmlnaW5hbFNsb3RTaXplXykge1xuICAgICAgc3VwZXIuYXR0ZW1wdENoYW5nZVNpemUoXG4gICAgICAgICAgdGhpcy5vcmlnaW5hbFNsb3RTaXplXy5oZWlnaHQsIHRoaXMub3JpZ2luYWxTbG90U2l6ZV8ud2lkdGgpXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFNsb3RTaXplXyA9IG51bGw7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAvLyBUT0RPKGtlaXRod3JpZ2h0Ym9zKTogaWYgd2UgYXJlIHVuYWJsZSB0byByZXZlcnQgc2l6ZSwgb24gbmV4dFxuICAgICAgICAgIC8vIHRyaWdnZXIgb2YgcHJvbWlzZSBjaGFpbiB0aGUgYWQgcmVxdWVzdCBtYXkgZmFpbCBkdWUgdG8gaW52YWxpZFxuICAgICAgICAgIC8vIHNsb3Qgc2l6ZS4gIERldGVybWluZSBob3cgdG8gaGFuZGxlIHRoaXMgY2FzZS5cbiAgICAgICAgICAgIGRldigpLndhcm4oVEFHLCAndW5hYmxlIHRvIHJldmVydCB0byBvcmlnaW5hbCBzaXplJywgZXJyKTtcbiAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLmlzQ29sbGFwc2VkXyA9IGZhbHNlO1xuXG4gICAgLy8gUmVtb3ZlIHJlbmRlcmluZyBmcmFtZSwgaWYgaXQgZXhpc3RzLlxuICAgIHRoaXMuZGVzdHJveUZyYW1lKCk7XG5cbiAgICB0aGlzLmFkUHJvbWlzZV8gPSBudWxsO1xuICAgIHRoaXMuYWRVcmxfID0gbnVsbDtcbiAgICB0aGlzLmNyZWF0aXZlQm9keV8gPSBudWxsO1xuICAgIHRoaXMuaXNWZXJpZmllZEFtcENyZWF0aXZlXyA9IGZhbHNlO1xuICAgIHRoaXMuZnJvbVJlc3VtZUNhbGxiYWNrID0gZmFsc2U7XG4gICAgdGhpcy5leHBlcmltZW50YWxOb25BbXBDcmVhdGl2ZVJlbmRlck1ldGhvZF8gPVxuICAgICAgICB0aGlzLmdldE5vbkFtcENyZWF0aXZlUmVuZGVyaW5nTWV0aG9kKCk7XG4gICAgdGhpcy5wb3N0QWRSZXNwb25zZUV4cGVyaW1lbnRGZWF0dXJlcyA9IHt9O1xuICB9XG5cbiAgLyoqXG4gICAqIEF0dGVtcHRzIHRvIHJlbW92ZSB0aGUgY3VycmVudCBmcmFtZSBhbmQgZnJlZSBhbnkgYXNzb2NpYXRlZCByZXNvdXJjZXMuXG4gICAqIFRoaXMgZnVuY3Rpb24gd2lsbCBuby1vcCBpZiB0aGlzIGFkIHNsb3QgaXMgY3VycmVudGx5IGluIHRoZSBwcm9jZXNzIG9mXG4gICAqIGJlaW5nIHJlZnJlc2hlZC5cbiAgICpcbiAgICogQHBhcmFtIHtib29sZWFuPX0gZm9yY2UgRm9yY2VzIHRoZSByZW1vdmFsIG9mIHRoZSBmcmFtZSwgZXZlbiBpZlxuICAgKiAgIHRoaXMuaXNSZWZyZXNoaW5nIGlzIHRydWUuXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIGRlc3Ryb3lGcmFtZShmb3JjZSA9IGZhbHNlKSB7XG4gICAgaWYgKCFmb3JjZSAmJiB0aGlzLmlzUmVmcmVzaGluZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBBbGxvdyBlbWJlZCB0byByZWxlYXNlIGl0cyByZXNvdXJjZXMuXG4gICAgaWYgKHRoaXMuZnJpZW5kbHlJZnJhbWVFbWJlZF8pIHtcbiAgICAgIHRoaXMuZnJpZW5kbHlJZnJhbWVFbWJlZF8uZGVzdHJveSgpO1xuICAgICAgdGhpcy5mcmllbmRseUlmcmFtZUVtYmVkXyA9IG51bGw7XG4gICAgfVxuICAgIGlmICh0aGlzLmlmcmFtZSAmJiB0aGlzLmlmcmFtZS5wYXJlbnRFbGVtZW50KSB7XG4gICAgICB0aGlzLmlmcmFtZS5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMuaWZyYW1lKTtcbiAgICAgIHRoaXMuaWZyYW1lID0gbnVsbDtcbiAgICB9XG4gICAgaWYgKHRoaXMueE9yaWdpbklmcmFtZUhhbmRsZXJfKSB7XG4gICAgICB0aGlzLnhPcmlnaW5JZnJhbWVIYW5kbGVyXy5mcmVlWE9yaWdpbklmcmFtZSgpO1xuICAgICAgdGhpcy54T3JpZ2luSWZyYW1lSGFuZGxlcl8gPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgICovXG4gIHZpZXdwb3J0Q2FsbGJhY2soaW5WaWV3cG9ydCkge1xuICAgIGlmICh0aGlzLmZyaWVuZGx5SWZyYW1lRW1iZWRfKSB7XG4gICAgICBzZXRGcmllbmRseUlmcmFtZUVtYmVkVmlzaWJsZSh0aGlzLmZyaWVuZGx5SWZyYW1lRW1iZWRfLCBpblZpZXdwb3J0KTtcbiAgICB9XG4gICAgaWYgKHRoaXMueE9yaWdpbklmcmFtZUhhbmRsZXJfKSB7XG4gICAgICB0aGlzLnhPcmlnaW5JZnJhbWVIYW5kbGVyXy52aWV3cG9ydENhbGxiYWNrKGluVmlld3BvcnQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgY3JlYXRlUGxhY2Vob2xkZXJDYWxsYmFjaygpIHtcbiAgICByZXR1cm4gdGhpcy51aUhhbmRsZXIuY3JlYXRlUGxhY2Vob2xkZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBBZCBVUkwgdG8gc2VuZCBhbiBYSFIgUmVxdWVzdCB0by4gIFRvIGJlIGltcGxlbWVudGVkXG4gICAqIGJ5IG5ldHdvcmsuXG4gICAqIEBwYXJhbSB7P0NPTlNFTlRfUE9MSUNZX1NUQVRFfSB1bnVzZWRDb25zZW50U3RhdGVcbiAgICogQHBhcmFtIHtQcm9taXNlPCFBcnJheTxydGNSZXNwb25zZURlZj4+PX0gb3B0X3J0Y1Jlc3BvbnNlc1Byb21pc2VcbiAgICogQHJldHVybiB7IVByb21pc2U8c3RyaW5nPnxzdHJpbmd9XG4gICAqL1xuICBnZXRBZFVybCh1bnVzZWRDb25zZW50U3RhdGUsIG9wdF9ydGNSZXNwb25zZXNQcm9taXNlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdnZXRBZFVybCBub3QgaW1wbGVtZW50ZWQhJyk7XG4gIH1cblxuICAvKipcbiAgICogUmVzZXRzIGFkIHVybCBzdGF0ZSB0byBudWxsLCB1c2VkIHRvIHByZXZlbnQgZnJhbWUgZ2V0IGZhbGxiYWNrIGlmIGVycm9yXG4gICAqIGlzIHRocm93biBhZnRlciB1cmwgY29uc3RydWN0aW9uIGJ1dCBwcmlvciB0byBsYXlvdXRDYWxsYmFjay5cbiAgICovXG4gIHJlc2V0QWRVcmwoKSB7XG4gICAgdGhpcy5hZFVybF8gPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge2Z1bmN0aW9uKCl9IGZ1bmN0aW9uIHRoYXQgd2hlbiBjYWxsZWQgd2lsbCB2ZXJpZnkgaWYgY3VycmVudFxuICAgKiAgICBhZCByZXRyaWV2YWwgaXMgY3VycmVudCAobWVhbmluZyB1bmxheW91dENhbGxiYWNrIHdhcyBub3QgZXhlY3V0ZWQpLlxuICAgKiAgICBJZiBub3QsIHdpbGwgdGhyb3cgY2FuY2VsbGF0aW9uIGV4Y2VwdGlvbjtcbiAgICogQHRocm93cyB7RXJyb3J9XG4gICAqL1xuICB2ZXJpZnlTdGlsbEN1cnJlbnQoKSB7XG4gICAgY29uc3QgcHJvbWlzZUlkID0gdGhpcy5wcm9taXNlSWRfO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBpZiAocHJvbWlzZUlkICE9IHRoaXMucHJvbWlzZUlkXykge1xuICAgICAgICB0aHJvdyBjYW5jZWxsYXRpb24oKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZSB0aGUgZGVzaXJlZCBzaXplIG9mIHRoZSBjcmVhdGl2ZSBiYXNlZCBvbiB0aGUgSFRUUCByZXNwb25zZVxuICAgKiBoZWFkZXJzLiBNdXN0IGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgb3JpZ2luYWwgc2l6ZSBvZiB0aGUgYWQgc2xvdFxuICAgKiBhbG9uZyBlYWNoIGRpbWVuc2lvbi4gTWF5IGJlIG92ZXJyaWRkZW4gYnkgbmV0d29yay5cbiAgICpcbiAgICogQHBhcmFtIHshLi4vLi4vLi4vc3JjL3V0aWxzL3hoci11dGlscy5GZXRjaFJlc3BvbnNlSGVhZGVyc30gcmVzcG9uc2VIZWFkZXJzXG4gICAqIEByZXR1cm4gez9TaXplSW5mb0RlZn1cbiAgICovXG4gIGV4dHJhY3RTaXplKHJlc3BvbnNlSGVhZGVycykge1xuICAgIGNvbnN0IGhlYWRlclZhbHVlID0gcmVzcG9uc2VIZWFkZXJzLmdldChDUkVBVElWRV9TSVpFX0hFQURFUik7XG4gICAgaWYgKCFoZWFkZXJWYWx1ZSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IG1hdGNoID0gL14oWzAtOV0rKXgoWzAtOV0rKSQvLmV4ZWMoaGVhZGVyVmFsdWUpO1xuICAgIGlmICghbWF0Y2gpIHtcbiAgICAgIC8vIFRPRE8oQHRheW1vbmJlYWwsICM5Mjc0KTogcmVwbGFjZSB0aGlzIHdpdGggcmVhbCBlcnJvciByZXBvcnRpbmdcbiAgICAgIHVzZXIoKS5lcnJvcihUQUcsIGBJbnZhbGlkIHNpemUgaGVhZGVyOiAke2hlYWRlclZhbHVlfWApO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiAvKiogQHR5cGUgez9TaXplSW5mb0RlZn0gKi8gKFxuICAgICAge3dpZHRoOiBOdW1iZXIobWF0Y2hbMV0pLCBoZWlnaHQ6IE51bWJlcihtYXRjaFsyXSl9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JjZXMgdGhlIFVJIEhhbmRsZXIgdG8gY29sbGFwc2UgdGhpcyBzbG90LlxuICAgKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAgICovXG4gIGZvcmNlQ29sbGFwc2UoKSB7XG4gICAgaWYgKHRoaXMuaXNSZWZyZXNoaW5nKSB7XG4gICAgICAvLyBJZiwgZm9yIHdoYXRldmVyIHJlYXNvbiwgdGhlIG5ldyBjcmVhdGl2ZSB3b3VsZCBjb2xsYXBzZSB0aGlzIHNsb3QsXG4gICAgICAvLyBzdGljayB3aXRoIHRoZSBvbGQgY3JlYXRpdmUgdW50aWwgdGhlIG5leHQgcmVmcmVzaCBjeWNsZS5cbiAgICAgIHRoaXMuaXNSZWZyZXNoaW5nID0gZmFsc2U7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGRldigpLmFzc2VydCh0aGlzLnVpSGFuZGxlcik7XG4gICAgLy8gU3RvcmUgb3JpZ2luYWwgc2l6ZSB0byBhbGxvdyBmb3IgcmV2ZXJ0aW5nIG9uIHVubGF5b3V0Q2FsbGJhY2sgc28gdGhhdFxuICAgIC8vIHN1YnNlcXVlbnQgcGFnZXZpZXcgYWxsb3dzIGZvciBhZCByZXF1ZXN0LlxuICAgIHRoaXMub3JpZ2luYWxTbG90U2l6ZV8gPSB0aGlzLm9yaWdpbmFsU2xvdFNpemVfIHx8IHRoaXMuZ2V0TGF5b3V0Qm94KCk7XG4gICAgdGhpcy51aUhhbmRsZXIuYXBwbHlOb0NvbnRlbnRVSSgpO1xuICAgIHRoaXMuaXNDb2xsYXBzZWRfID0gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBleGVjdXRlZCB3aGVuIGNyZWF0aXZlIGhhcyBzdWNjZXNzZnVsbHkgcmVuZGVyZWQgd2l0aGluIHRoZVxuICAgKiBwdWJsaXNoZXIgcGFnZSBidXQgcHJpb3IgdG8gbG9hZCAob3IgaW5pLWxvYWQgZm9yIGZyaWVuZGx5IGZyYW1lIEFNUFxuICAgKiBjcmVhdGl2ZSByZW5kZXIpLiAgVG8gYmUgb3ZlcnJpZGRlbiBieSBuZXR3b3JrIGltcGxlbWVudGF0aW9ucyBhcyBuZWVkZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7P0NyZWF0aXZlTWV0YURhdGFEZWZ9IGNyZWF0aXZlTWV0YURhdGEgbWV0YWRhdGEgaWYgQU1QIGNyZWF0aXZlLFxuICAgKiAgICBudWxsIG90aGVyd2lzZS5cbiAgICovXG4gIG9uQ3JlYXRpdmVSZW5kZXIoY3JlYXRpdmVNZXRhRGF0YSkge1xuICAgIHRoaXMubWF5YmVUcmlnZ2VyQW5hbHl0aWNzRXZlbnRfKFxuICAgICAgICBjcmVhdGl2ZU1ldGFEYXRhID8gJ3JlbmRlckZyaWVuZGx5RW5kJyA6ICdyZW5kZXJDcm9zc0RvbWFpbkVuZCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGlmcmFtZSB0aGF0IHdhcyBqdXN0IGNyZWF0ZWQuICBUbyBiZSBvdmVycmlkZGVuIGZvclxuICAgKiB0ZXN0aW5nLlxuICAgKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAgICovXG4gIG9uQ3Jvc3NEb21haW5JZnJhbWVDcmVhdGVkKGlmcmFtZSkge1xuICAgIGRldigpLmluZm8oVEFHLCB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJyksXG4gICAgICAgIGBvbkNyb3NzRG9tYWluSWZyYW1lQ3JlYXRlZCAke2lmcmFtZX1gKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZW5kIGFkIHJlcXVlc3QsIGV4dHJhY3QgdGhlIGNyZWF0aXZlIGFuZCBzaWduYXR1cmUgZnJvbSB0aGUgcmVzcG9uc2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhZFVybCBSZXF1ZXN0IFVSTCB0byBzZW5kIFhIUiB0by5cbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uLy4uLy4uL3NyYy91dGlscy94aHItdXRpbHMuRmV0Y2hSZXNwb25zZT59XG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIHNlbmRYaHJSZXF1ZXN0KGFkVXJsKSB7XG4gICAgdGhpcy5tYXliZVRyaWdnZXJBbmFseXRpY3NFdmVudF8oJ2FkUmVxdWVzdFN0YXJ0Jyk7XG4gICAgY29uc3QgeGhySW5pdCA9IHtcbiAgICAgIG1vZGU6ICdjb3JzJyxcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICBjcmVkZW50aWFsczogJ2luY2x1ZGUnLFxuICAgIH07XG4gICAgcmV0dXJuIFNlcnZpY2VzLnhockZvcih0aGlzLndpbilcbiAgICAgICAgLmZldGNoKGFkVXJsLCB4aHJJbml0KVxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgIGlmIChlcnJvci5yZXNwb25zZSAmJiBlcnJvci5yZXNwb25zZS5zdGF0dXMgPiAyMDApIHtcbiAgICAgICAgICAgIC8vIEludmFsaWQgc2VydmVyIHJlc3BvbnNlIGNvZGUgc28gd2Ugc2hvdWxkIGNvbGxhcHNlLlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIElmIGFuIGVycm9yIG9jY3VycywgbGV0IHRoZSBhZCBiZSByZW5kZXJlZCB2aWEgaWZyYW1lIGFmdGVyIGRlbGF5LlxuICAgICAgICAgIC8vIFRPRE8odGF5bW9uYmVhbCk6IEZpZ3VyZSBvdXQgYSBtb3JlIHNvcGhpc3RpY2F0ZWQgdGVzdCBmb3IgZGVjaWRpbmdcbiAgICAgICAgICAvLyB3aGV0aGVyIHRvIHJldHJ5IHdpdGggYW4gaWZyYW1lIGFmdGVyIGFuIGFkIHJlcXVlc3QgZmFpbHVyZSBvciBqdXN0XG4gICAgICAgICAgLy8gZ2l2ZSB1cCBhbmQgcmVuZGVyIHRoZSBmYWxsYmFjayBjb250ZW50IChvciBjb2xsYXBzZSB0aGUgYWQgc2xvdCkuXG4gICAgICAgICAgY29uc3QgbmV0d29ya0ZhaWx1cmVIYW5kbGVyUmVzdWx0ID1cbiAgICAgICAgICAgICAgdGhpcy5vbk5ldHdvcmtGYWlsdXJlKGVycm9yLCAvKiogQHR5cGUge3N0cmluZ30gKi8gKHRoaXMuYWRVcmxfKSk7XG4gICAgICAgICAgZGV2KCkuYXNzZXJ0KCEhbmV0d29ya0ZhaWx1cmVIYW5kbGVyUmVzdWx0KTtcbiAgICAgICAgICBpZiAobmV0d29ya0ZhaWx1cmVIYW5kbGVyUmVzdWx0LmZyYW1lR2V0RGlzYWJsZWQpIHtcbiAgICAgICAgICAgIC8vIFJlc2V0IGFkVXJsIHRvIG51bGwgd2hpY2ggd2lsbCBjYXVzZSBsYXlvdXRDYWxsYmFjayB0byBub3RcbiAgICAgICAgICAgIC8vIGZldGNoIHZpYSBmcmFtZSBHRVQuXG4gICAgICAgICAgICBkZXYoKS5pbmZvKFxuICAgICAgICAgICAgICAgIFRBRywgJ2ZyYW1lIGdldCBkaXNhYmxlZCBhcyBwYXJ0IG9mIG5ldHdvcmsgZmFpbHVyZSBoYW5kbGVyJyk7XG4gICAgICAgICAgICB0aGlzLnJlc2V0QWRVcmwoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hZFVybF8gPSBuZXR3b3JrRmFpbHVyZUhhbmRsZXJSZXN1bHQuYWRVcmwgfHwgdGhpcy5hZFVybF87XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoTkVUV09SS19GQUlMVVJFKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCBvbiBuZXR3b3JrIGZhaWx1cmUgc2VuZGluZyBYSFIgQ09SUyBhZCByZXF1ZXN0IGFsbG93aW5nIGZvclxuICAgKiBtb2RpZmljYXRpb24gb2YgYWQgdXJsIGFuZCBwcmV2ZW50IGZyYW1lIEdFVCByZXF1ZXN0IG9uIGxheW91dENhbGxiYWNrLlxuICAgKiBCeSBkZWZhdWx0LCBHRVQgZnJhbWUgcmVxdWVzdCB3aWxsIGJlIGV4ZWN1dGVkIHdpdGggc2FtZSBhZCBVUkwgYXMgdXNlZFxuICAgKiBmb3IgWEhSIENPUlMgcmVxdWVzdC5cbiAgICogQHBhcmFtIHsqfSB1bnVzZWRFcnJvciBmcm9tIG5ldHdvcmsgZmFpbHVyZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gdW51c2VkQWRVcmwgdXNlZCBmb3IgbmV0d29yayByZXF1ZXN0XG4gICAqIEByZXR1cm4geyF7YWRVcmw6IChzdHJpbmd8dW5kZWZpbmVkKSwgZnJhbWVHZXREaXNhYmxlZDogKGJvb2xlYW58dW5kZWZpbmVkKX19XG4gICAqL1xuICBvbk5ldHdvcmtGYWlsdXJlKHVudXNlZEVycm9yLCB1bnVzZWRBZFVybCkge1xuICAgIHJldHVybiB7fTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUbyBiZSBvdmVycmlkZGVuIGJ5IG5ldHdvcmsgc3BlY2lmaWMgaW1wbGVtZW50YXRpb24gaW5kaWNhdGluZyB3aGljaFxuICAgKiBzaWduaW5nIHNlcnZpY2UocykgaXMgdG8gYmUgdXNlZC5cbiAgICogQHJldHVybiB7IUFycmF5PHN0cmluZz59IEEgbGlzdCBvZiBzaWduaW5nIHNlcnZpY2VzLlxuICAgKi9cbiAgZ2V0U2lnbmluZ1NlcnZpY2VOYW1lcygpIHtcbiAgICByZXR1cm4gZ2V0TW9kZSgpLmxvY2FsRGV2ID8gWydnb29nbGUnLCAnZ29vZ2xlLWRldiddIDogWydnb29nbGUnXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXIgbm9uLUFNUCBjcmVhdGl2ZSB3aXRoaW4gY3Jvc3MgZG9tYWluIGlmcmFtZS5cbiAgICogQHBhcmFtIHtib29sZWFuPX0gdGhyb3R0bGVBcHBsaWVkIFdoZXRoZXIgaW5jcmVtZW50TG9hZGluZ0FkcyBoYXMgYWxyZWFkeVxuICAgKiAgICBiZWVuIGNhbGxlZFxuICAgKiBAcmV0dXJuIHtQcm9taXNlPGJvb2xlYW4+fSBXaGV0aGVyIHRoZSBjcmVhdGl2ZSB3YXMgc3VjY2Vzc2Z1bGx5IHJlbmRlcmVkLlxuICAgKi9cbiAgcmVuZGVyTm9uQW1wQ3JlYXRpdmUodGhyb3R0bGVBcHBsaWVkKSB7XG4gICAgaWYgKHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2Rpc2FibGUzcGZhbGxiYWNrJykgPT0gJ3RydWUnKSB7XG4gICAgICB1c2VyKCkud2FybihUQUcsIHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSxcbiAgICAgICAgICAnZmFsbGJhY2sgdG8gM3AgZGlzYWJsZWQnKTtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZmFsc2UpO1xuICAgIH1cbiAgICAvLyBUT0RPKGtlaXRod3JpZ2h0Ym9zKTogcmVtb3ZlIHdoZW4gbm8gbG9uZ2VyIG5lZWRlZC5cbiAgICBkZXYoKS53YXJuKFRBRywgJ2ZhbGxiYWNrIHRvIDNwJyk7XG4gICAgLy8gSGF2ZW4ndCByZW5kZXJlZCB5ZXQsIHNvIHRyeSByZW5kZXJpbmcgdmlhIG9uZSBvZiBvdXJcbiAgICAvLyBjcm9zcy1kb21haW4gaWZyYW1lIHNvbHV0aW9ucy5cbiAgICBjb25zdCBtZXRob2QgPSB0aGlzLmV4cGVyaW1lbnRhbE5vbkFtcENyZWF0aXZlUmVuZGVyTWV0aG9kXztcbiAgICBsZXQgcmVuZGVyUHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShmYWxzZSk7XG4gICAgaWYgKChtZXRob2QgPT0gWE9SSUdJTl9NT0RFLlNBRkVGUkFNRSB8fFxuICAgICAgICAgbWV0aG9kID09IFhPUklHSU5fTU9ERS5OQU1FRlJBTUUpICYmXG4gICAgICAgIHRoaXMuY3JlYXRpdmVCb2R5Xykge1xuICAgICAgcmVuZGVyUHJvbWlzZSA9IHRoaXMucmVuZGVyVmlhTmFtZUF0dHJPZlhPcmlnaW5JZnJhbWVfKFxuICAgICAgICAgIHRoaXMuY3JlYXRpdmVCb2R5Xyk7XG4gICAgICB0aGlzLmNyZWF0aXZlQm9keV8gPSBudWxsOyAvLyBGcmVlIHJlc291cmNlcy5cbiAgICB9IGVsc2UgaWYgKHRoaXMuYWRVcmxfKSB7XG4gICAgICBhc3NlcnRIdHRwc1VybCh0aGlzLmFkVXJsXywgdGhpcy5lbGVtZW50KTtcbiAgICAgIHJlbmRlclByb21pc2UgPSB0aGlzLnJlbmRlclZpYUlmcmFtZUdldF8odGhpcy5hZFVybF8pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBBZCBVUkwgbWF5IG5vdCBleGlzdCBpZiBidWlsZEFkVXJsIHRocm93cyBlcnJvciBvciByZXR1cm5zIGVtcHR5LlxuICAgICAgLy8gSWYgZXJyb3Igb2NjdXJyZWQsIGl0IHdvdWxkIGhhdmUgYWxyZWFkeSBiZWVuIHJlcG9ydGVkIGJ1dCBsZXQnc1xuICAgICAgLy8gcmVwb3J0IHRvIHVzZXIgaW4gY2FzZSBvZiBlbXB0eS5cbiAgICAgIHVzZXIoKS53YXJuKFRBRywgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpLFxuICAgICAgICAgICdObyBjcmVhdGl2ZSBvciBVUkwgYXZhaWxhYmxlIC0tIEE0QSBjYW5cXCd0IHJlbmRlciBhbnkgYWQnKTtcbiAgICB9XG4gICAgaWYgKCF0aHJvdHRsZUFwcGxpZWQgJiYgIXRoaXMuaW5Ob25BbXBQcmVmZXJlbmNlRXhwKCkpIHtcbiAgICAgIGluY3JlbWVudExvYWRpbmdBZHModGhpcy53aW4sIHJlbmRlclByb21pc2UpO1xuICAgIH1cbiAgICByZXR1cm4gcmVuZGVyUHJvbWlzZS50aGVuKFxuICAgICAgICByZXN1bHQgPT4ge1xuICAgICAgICAgIHRoaXMubWF5YmVUcmlnZ2VyQW5hbHl0aWNzRXZlbnRfKCdjcm9zc0RvbWFpbklmcmFtZUxvYWRlZCcpO1xuICAgICAgICAgIC8vIFBhc3Mgb24gdGhlIHJlc3VsdCB0byB0aGUgbmV4dCB2YWx1ZSBpbiB0aGUgcHJvbWlzZSBjaGFuZ2UuXG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVyIGEgdmFsaWRhdGVkIEFNUCBjcmVhdGl2ZSBkaXJlY3RseSBpbiB0aGUgcGFyZW50IHBhZ2UuXG4gICAqIEBwYXJhbSB7IUNyZWF0aXZlTWV0YURhdGFEZWZ9IGNyZWF0aXZlTWV0YURhdGEgTWV0YWRhdGEgcmVxdWlyZWQgdG8gcmVuZGVyXG4gICAqICAgICBBTVAgY3JlYXRpdmUuXG4gICAqIEByZXR1cm4geyFQcm9taXNlfSBXaGV0aGVyIHRoZSBjcmVhdGl2ZSB3YXMgc3VjY2Vzc2Z1bGx5IHJlbmRlcmVkLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcmVuZGVyQW1wQ3JlYXRpdmVfKGNyZWF0aXZlTWV0YURhdGEpIHtcbiAgICBkZXYoKS5hc3NlcnQoY3JlYXRpdmVNZXRhRGF0YS5taW5pZmllZENyZWF0aXZlLFxuICAgICAgICAnbWlzc2luZyBtaW5pZmllZCBjcmVhdGl2ZScpO1xuICAgIGRldigpLmFzc2VydCghIXRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50LCAnbWlzc2luZyBvd25lciBkb2N1bWVudD8hJyk7XG4gICAgdGhpcy5tYXliZVRyaWdnZXJBbmFseXRpY3NFdmVudF8oJ3JlbmRlckZyaWVuZGx5U3RhcnQnKTtcbiAgICAvLyBDcmVhdGUgYW5kIHNldHVwIGZyaWVuZGx5IGlmcmFtZS5cbiAgICB0aGlzLmlmcmFtZSA9IC8qKiBAdHlwZSB7IUhUTUxJRnJhbWVFbGVtZW50fSAqLyhcbiAgICAgIGNyZWF0ZUVsZW1lbnRXaXRoQXR0cmlidXRlcyhcbiAgICAgICAgICAvKiogQHR5cGUgeyFEb2N1bWVudH0gKi8odGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQpLCAnaWZyYW1lJyxcbiAgICAgICAgICBkaWN0KHtcbiAgICAgICAgICAgIC8vIE5PVEU6IEl0IGlzIHBvc3NpYmxlIGZvciBlaXRoZXIgd2lkdGggb3IgaGVpZ2h0IHRvIGJlICdhdXRvJyxcbiAgICAgICAgICAgIC8vIGEgbm9uLW51bWVyaWMgdmFsdWUuXG4gICAgICAgICAgICAnaGVpZ2h0JzogdGhpcy5jcmVhdGl2ZVNpemVfLmhlaWdodCxcbiAgICAgICAgICAgICd3aWR0aCc6IHRoaXMuY3JlYXRpdmVTaXplXy53aWR0aCxcbiAgICAgICAgICAgICdmcmFtZWJvcmRlcic6ICcwJyxcbiAgICAgICAgICAgICdhbGxvd2Z1bGxzY3JlZW4nOiAnJyxcbiAgICAgICAgICAgICdhbGxvd3RyYW5zcGFyZW5jeSc6ICcnLFxuICAgICAgICAgICAgJ3Njcm9sbGluZyc6ICdubycsXG4gICAgICAgICAgfSkpKTtcbiAgICB0aGlzLmFwcGx5RmlsbENvbnRlbnQodGhpcy5pZnJhbWUpO1xuICAgIGNvbnN0IGZvbnRzQXJyYXkgPSBbXTtcbiAgICBpZiAoY3JlYXRpdmVNZXRhRGF0YS5jdXN0b21TdHlsZXNoZWV0cykge1xuICAgICAgY3JlYXRpdmVNZXRhRGF0YS5jdXN0b21TdHlsZXNoZWV0cy5mb3JFYWNoKHMgPT4ge1xuICAgICAgICBjb25zdCBocmVmID0gc1snaHJlZiddO1xuICAgICAgICBpZiAoaHJlZikge1xuICAgICAgICAgIGZvbnRzQXJyYXkucHVzaChocmVmKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGNoZWNrU3RpbGxDdXJyZW50ID0gdGhpcy52ZXJpZnlTdGlsbEN1cnJlbnQoKTtcbiAgICByZXR1cm4gaW5zdGFsbEZyaWVuZGx5SWZyYW1lRW1iZWQoXG4gICAgICAgIHRoaXMuaWZyYW1lLCB0aGlzLmVsZW1lbnQsIHtcbiAgICAgICAgICBob3N0OiB0aGlzLmVsZW1lbnQsXG4gICAgICAgICAgLy8gTmVlZCB0byBndWFyYW50ZWUgdGhhdCB0aGlzIGlzIG5vIGxvbmdlciBudWxsXG4gICAgICAgICAgdXJsOiAvKiogQHR5cGUge3N0cmluZ30gKi8gKHRoaXMuYWRVcmxfKSxcbiAgICAgICAgICBodG1sOiBjcmVhdGl2ZU1ldGFEYXRhLm1pbmlmaWVkQ3JlYXRpdmUsXG4gICAgICAgICAgZXh0ZW5zaW9uSWRzOiBjcmVhdGl2ZU1ldGFEYXRhLmN1c3RvbUVsZW1lbnRFeHRlbnNpb25zIHx8IFtdLFxuICAgICAgICAgIGZvbnRzOiBmb250c0FycmF5LFxuICAgICAgICB9LCBlbWJlZFdpbiA9PiB7XG4gICAgICAgICAgaW5zdGFsbFVybFJlcGxhY2VtZW50c0ZvckVtYmVkKHRoaXMuZ2V0QW1wRG9jKCksIGVtYmVkV2luLFxuICAgICAgICAgICAgICBuZXcgQTRBVmFyaWFibGVTb3VyY2UodGhpcy5nZXRBbXBEb2MoKSwgZW1iZWRXaW4pKTtcbiAgICAgICAgfSkudGhlbihmcmllbmRseUlmcmFtZUVtYmVkID0+IHtcbiAgICAgIGNoZWNrU3RpbGxDdXJyZW50KCk7XG4gICAgICB0aGlzLmZyaWVuZGx5SWZyYW1lRW1iZWRfID0gZnJpZW5kbHlJZnJhbWVFbWJlZDtcbiAgICAgIHNldEZyaWVuZGx5SWZyYW1lRW1iZWRWaXNpYmxlKFxuICAgICAgICAgIGZyaWVuZGx5SWZyYW1lRW1iZWQsIHRoaXMuaXNJblZpZXdwb3J0KCkpO1xuICAgICAgLy8gRW5zdXJlIHZpc2liaWxpdHkgaGlkZGVuIGhhcyBiZWVuIHJlbW92ZWQgKHNldCBieSBib2lsZXJwbGF0ZSkuXG4gICAgICBjb25zdCBmcmFtZURvYyA9IGZyaWVuZGx5SWZyYW1lRW1iZWQuaWZyYW1lLmNvbnRlbnREb2N1bWVudCB8fFxuICAgICAgICAgICAgICBmcmllbmRseUlmcmFtZUVtYmVkLndpbi5kb2N1bWVudDtcbiAgICAgIHNldFN0eWxlKGZyYW1lRG9jLmJvZHksICd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTtcbiAgICAgIHByb3RlY3RGdW5jdGlvbldyYXBwZXIodGhpcy5vbkNyZWF0aXZlUmVuZGVyLCB0aGlzLCBlcnIgPT4ge1xuICAgICAgICBkZXYoKS5lcnJvcihUQUcsIHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSxcbiAgICAgICAgICAgICdFcnJvciBleGVjdXRpbmcgb25DcmVhdGl2ZVJlbmRlcicsIGVycik7XG4gICAgICB9KShjcmVhdGl2ZU1ldGFEYXRhKTtcbiAgICAgIC8vIEl0J3MgZW5vdWdoIHRvIHdhaXQgZm9yIFwiaW5pLWxvYWRcIiBzaWduYWwgYmVjYXVzZSBpbiBhIEZJRSBjYXNlXG4gICAgICAvLyB3ZSBrbm93IHRoYXQgdGhlIGVtYmVkIG5vIGxvbmdlciBjb25zdW1lcyBzaWduaWZpY2FudCByZXNvdXJjZXNcbiAgICAgIC8vIGFmdGVyIHRoZSBpbml0aWFsIGxvYWQuXG4gICAgICByZXR1cm4gZnJpZW5kbHlJZnJhbWVFbWJlZC53aGVuSW5pTG9hZGVkKCk7XG4gICAgfSkudGhlbigoKSA9PiB7XG4gICAgICBjaGVja1N0aWxsQ3VycmVudCgpO1xuICAgICAgLy8gQ2FwdHVyZSBpbmktbG9hZCBwaW5nLlxuICAgICAgdGhpcy5tYXliZVRyaWdnZXJBbmFseXRpY3NFdmVudF8oJ2ZyaWVuZGx5SWZyYW1lSW5pTG9hZCcpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNoYXJlZCBmdW5jdGlvbmFsaXR5IGZvciBjcm9zcy1kb21haW4gaWZyYW1lLWJhc2VkIHJlbmRlcmluZyBtZXRob2RzLlxuICAgKiBAcGFyYW0geyFKc29uT2JqZWN0PHN0cmluZywgc3RyaW5nPn0gYXR0cmlidXRlcyBUaGUgYXR0cmlidXRlcyBvZiB0aGUgaWZyYW1lLlxuICAgKiBAcmV0dXJuIHshUHJvbWlzZX0gYXdhaXRpbmcgbG9hZCBldmVudCBmb3IgYWQgZnJhbWVcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGlmcmFtZVJlbmRlckhlbHBlcl8oYXR0cmlidXRlcykge1xuICAgIGNvbnN0IG1lcmdlZEF0dHJpYnV0ZXMgPSBPYmplY3QuYXNzaWduKGF0dHJpYnV0ZXMsIGRpY3Qoe1xuICAgICAgJ2hlaWdodCc6IHRoaXMuY3JlYXRpdmVTaXplXy5oZWlnaHQsXG4gICAgICAnd2lkdGgnOiB0aGlzLmNyZWF0aXZlU2l6ZV8ud2lkdGgsXG4gICAgfSkpO1xuXG4gICAgaWYgKHRoaXMuc2VudGluZWwpIHtcbiAgICAgIG1lcmdlZEF0dHJpYnV0ZXNbJ2RhdGEtYW1wLTNwLXNlbnRpbmVsJ10gPSB0aGlzLnNlbnRpbmVsO1xuICAgIH1cbiAgICBpZiAodGhpcy5zaG91bGRTYW5kYm94Xykge1xuICAgICAgbWVyZ2VkQXR0cmlidXRlc1snc2FuZGJveCddID0gSUZSQU1FX1NBTkRCT1hJTkdfRkxBR1M7XG4gICAgfVxuICAgIGlmIChpc0V4cGVyaW1lbnRPbih0aGlzLndpbiwgJ25vLXN5bmMteGhyLWluLWFkcycpKSB7XG4gICAgICAvLyBCbG9jayBzeW5jaHJvbm91cyBYSFIgaW4gYWQuIFRoZXNlIGFyZSB2ZXJ5IHJhcmUsIGJ1dCBzdXBlciBiYWQgZm9yIFVYXG4gICAgICAvLyBhcyB0aGV5IGJsb2NrIHRoZSBVSSB0aHJlYWQgZm9yIHRoZSBhcmJpdHJhcnkgYW1vdW50IG9mIHRpbWUgdW50aWwgdGhlXG4gICAgICAvLyByZXF1ZXN0IGNvbXBsZXRlcy5cbiAgICAgIG1lcmdlZEF0dHJpYnV0ZXNbJ2FsbG93J10gPSAnc3luYy14aHIgXFwnbm9uZVxcJzsnO1xuICAgIH1cbiAgICB0aGlzLmlmcmFtZSA9IGNyZWF0ZUVsZW1lbnRXaXRoQXR0cmlidXRlcyhcbiAgICAgICAgLyoqIEB0eXBlIHshRG9jdW1lbnR9ICovICh0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudCksXG4gICAgICAgICdpZnJhbWUnLCAvKiogQHR5cGUgeyFKc29uT2JqZWN0fSAqLyAoXG4gICAgICAgICAgT2JqZWN0LmFzc2lnbihtZXJnZWRBdHRyaWJ1dGVzLCBTSEFSRURfSUZSQU1FX1BST1BFUlRJRVMpKSk7XG4gICAgLy8gVE9ETyhrZWl0aHdyaWdodGJvcyk6IG5vQ29udGVudENhbGxiYWNrP1xuICAgIHRoaXMueE9yaWdpbklmcmFtZUhhbmRsZXJfID0gbmV3IEFNUC5BbXBBZFhPcmlnaW5JZnJhbWVIYW5kbGVyKHRoaXMpO1xuICAgIC8vIElmcmFtZSBpcyBhcHBlbmRlZCB0byBlbGVtZW50IGFzIHBhcnQgb2YgeG9yaWdpbiBmcmFtZSBoYW5kbGVyIGluaXQuXG4gICAgLy8gRXhlY3V0aXZlIG9uQ3JlYXRpdmVSZW5kZXIgYWZ0ZXIgaW5pdCB0byBlbnN1cmUgaXQgY2FuIGdldCByZWZlcmVuY2VcbiAgICAvLyB0byBmcmFtZSBidXQgcHJpb3IgdG8gbG9hZCB0byBhbGxvdyBmb3IgZWFybGllciBhY2Nlc3MuXG4gICAgY29uc3QgZnJhbWVMb2FkUHJvbWlzZSA9XG4gICAgICAgIHRoaXMueE9yaWdpbklmcmFtZUhhbmRsZXJfLmluaXQodGhpcy5pZnJhbWUsIC8qIG9wdF9pc0E0QSAqLyB0cnVlKTtcbiAgICBwcm90ZWN0RnVuY3Rpb25XcmFwcGVyKHRoaXMub25DcmVhdGl2ZVJlbmRlciwgdGhpcywgZXJyID0+IHtcbiAgICAgIGRldigpLmVycm9yKFRBRywgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpLFxuICAgICAgICAgICdFcnJvciBleGVjdXRpbmcgb25DcmVhdGl2ZVJlbmRlcicsIGVycik7XG4gICAgfSkobnVsbCk7XG4gICAgcmV0dXJuIGZyYW1lTG9hZFByb21pc2U7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBpZnJhbWUgd2hvc2Ugc3JjIG1hdGNoZXMgdGhhdCBvZiB0aGUgYWQgVVJMLiBGb3Igc3RhbmRhcmRcbiAgICogRmFzdCBGZXRjaCBydW5uaW5nIG9uIHRoZSBBTVAgY2RuLCBhbiBYSFIgcmVxdWVzdCB3aWxsIHR5cGljYWxseSBoYXZlXG4gICAqIGFscmVhZHkgYmVlbiBzZW50IHRvIHRoZSBzYW1lIGFkVXJsLCBhbmQgdGhlIHJlc3BvbnNlIHNob3VsZFxuICAgKiBoYXZlIGJlZW4gY2FjaGVkIGNhdXNpbmcgdGhlIGJyb3dzZXIgdG8gcmVuZGVyIHdpdGhvdXQgY2FsbG91dC4gIEhvd2V2ZXIsXG4gICAqIGl0IGlzIHBvc3NpYmxlIGZvciBjYWNoZSBtaXNzIHRvIG9jY3VyIHdoaWNoIGNhbiBiZSBkZXRlY3RlZCBzZXJ2ZXItc2lkZVxuICAgKiBieSBtaXNzaW5nIE9SSUdJTiBoZWFkZXIuXG4gICAqXG4gICAqIEFkZGl0aW9uYWxseSwgdGhpcyBtZXRob2QgaXMgYWxzbyB1c2VkIGluIGNlcnRhaW4gY2FzZXMgdG8gc2VuZCB0aGUgb25seVxuICAgKiByZXF1ZXN0LCBpLmUuIHRoZSBpbml0aWFsIFhIUiBpcyBza2lwcGVkLlxuICAgKlxuICAgKiBOb3RlOiBBcyBvZiAyMDE2LTEwLTE4LCB0aGUgZmlsbC1mcm9tLWNhY2hlIGFzc3VtcHRpb24gYXBwZWFycyB0byBmYWlsIG9uXG4gICAqIFNhZmFyaS1vbi1pT1MsIHdoaWNoIGlzc3VlcyBhIGZyZXNoIG5ldHdvcmsgcmVxdWVzdCwgZXZlbiB0aG91Z2ggdGhlXG4gICAqIGNvbnRlbnQgaXMgYWxyZWFkeSBpbiBjYWNoZS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGFkVXJsICBBZCByZXF1ZXN0IFVSTCwgYXMgc2VudCB0byAjc2VuZFhoclJlcXVlc3QgKGkuZS4sXG4gICAqICAgIGJlZm9yZSBhbnkgbW9kaWZpY2F0aW9ucyB0aGF0IFhIUiBtb2R1bGUgZG9lcyB0byBpdC4pXG4gICAqIEByZXR1cm4geyFQcm9taXNlfSBhd2FpdGluZyBhZCBjb21wbGV0ZWQgaW5zZXJ0aW9uLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcmVuZGVyVmlhSWZyYW1lR2V0XyhhZFVybCkge1xuICAgIHRoaXMubWF5YmVUcmlnZ2VyQW5hbHl0aWNzRXZlbnRfKCdyZW5kZXJDcm9zc0RvbWFpblN0YXJ0Jyk7XG4gICAgcmV0dXJuIHRoaXMuaWZyYW1lUmVuZGVySGVscGVyXyhkaWN0KHtcbiAgICAgICdzcmMnOiBTZXJ2aWNlcy54aHJGb3IodGhpcy53aW4pLmdldENvcnNVcmwodGhpcy53aW4sIGFkVXJsKSxcbiAgICAgICduYW1lJzogSlNPTi5zdHJpbmdpZnkoXG4gICAgICAgICAgZ2V0Q29udGV4dE1ldGFkYXRhKHRoaXMud2luLCB0aGlzLmVsZW1lbnQsIHRoaXMuc2VudGluZWwpKSxcbiAgICB9KSk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVyIHRoZSBjcmVhdGl2ZSB2aWEgc29tZSBcImNyb3NzIGRvbWFpbiBpZnJhbWUgdGhhdCBhY2NlcHRzIHRoZSBjcmVhdGl2ZVxuICAgKiBpbiB0aGUgbmFtZSBhdHRyaWJ1dGVcIi4gIFRoaXMgY291bGQgYmUgU2FmZUZyYW1lIG9yIHRoZSBBTVAtbmF0aXZlXG4gICAqIE5hbWVGcmFtZS5cbiAgICpcbiAgICogQHBhcmFtIHshQXJyYXlCdWZmZXJ9IGNyZWF0aXZlQm9keVxuICAgKiBAcmV0dXJuIHshUHJvbWlzZX0gYXdhaXRpbmcgbG9hZCBldmVudCBmb3IgYWQgZnJhbWVcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHJlbmRlclZpYU5hbWVBdHRyT2ZYT3JpZ2luSWZyYW1lXyhjcmVhdGl2ZUJvZHkpIHtcbiAgICAvKiogQHR5cGUgez9zdHJpbmd9ICovXG4gICAgY29uc3QgbWV0aG9kID0gdGhpcy5leHBlcmltZW50YWxOb25BbXBDcmVhdGl2ZVJlbmRlck1ldGhvZF87XG4gICAgZGV2KCkuYXNzZXJ0KG1ldGhvZCA9PSBYT1JJR0lOX01PREUuU0FGRUZSQU1FIHx8XG4gICAgICAgIG1ldGhvZCA9PSBYT1JJR0lOX01PREUuTkFNRUZSQU1FLFxuICAgICdVbnJlY29nbml6ZWQgQTRBIGNyb3NzLWRvbWFpbiByZW5kZXJpbmcgbW9kZTogJXMnLCBtZXRob2QpO1xuICAgIHRoaXMubWF5YmVUcmlnZ2VyQW5hbHl0aWNzRXZlbnRfKCdyZW5kZXJTYWZlRnJhbWVTdGFydCcpO1xuICAgIGNvbnN0IGNoZWNrU3RpbGxDdXJyZW50ID0gdGhpcy52ZXJpZnlTdGlsbEN1cnJlbnQoKTtcbiAgICByZXR1cm4gdHJ5UmVzb2x2ZSgoKSA9PiB1dGY4RGVjb2RlKGNyZWF0aXZlQm9keSkpLnRoZW4oY3JlYXRpdmUgPT4ge1xuICAgICAgY2hlY2tTdGlsbEN1cnJlbnQoKTtcbiAgICAgIGxldCBzcmNQYXRoO1xuICAgICAgbGV0IG5hbWUgPSAnJztcbiAgICAgIHN3aXRjaCAobWV0aG9kKSB7XG4gICAgICAgIGNhc2UgWE9SSUdJTl9NT0RFLlNBRkVGUkFNRTpcbiAgICAgICAgICBzcmNQYXRoID0gdGhpcy5nZXRTYWZlZnJhbWVQYXRoKCkgKyAnP249MCc7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgWE9SSUdJTl9NT0RFLk5BTUVGUkFNRTpcbiAgICAgICAgICBzcmNQYXRoID0gZ2V0RGVmYXVsdEJvb3RzdHJhcEJhc2VVcmwodGhpcy53aW4sICduYW1lZnJhbWUnKTtcbiAgICAgICAgICAvLyBOYW1lIHdpbGwgYmUgc2V0IGZvciByZWFsIGJlbG93IGluIG5hbWVmcmFtZSBjYXNlLlxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIC8vIFNob3VsZG4ndCBiZSBhYmxlIHRvIGdldCBoZXJlLCBidXQuLi4gIEJlY2F1c2Ugb2YgdGhlIGFzc2VydCxcbiAgICAgICAgICAvLyBhYm92ZSwgd2UgY2FuIG9ubHkgZ2V0IGhlcmUgaW4gbm9uLWRldiBtb2RlLCBzbyBnaXZlIHVzZXIgZmVlZGJhY2suXG4gICAgICAgICAgdXNlcigpLmVycm9yKCdBNEEnLCAnQTRBIHJlY2VpdmVkIHVucmVjb2duaXplZCBjcm9zcy1kb21haW4gbmFtZSdcbiAgICAgICAgICAgICAgKyAnIGF0dHJpYnV0ZSBpZnJhbWUgcmVuZGVyaW5nIG1vZGUgcmVxdWVzdDogJXMuICBVbmFibGUgdG8nXG4gICAgICAgICAgICAgICsgJyByZW5kZXIgYSBjcmVhdGl2ZSBmb3InXG4gICAgICAgICAgICAgICsgJyBzbG90ICVzLicsIG1ldGhvZCwgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnaWQnKSk7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCdVbnJlY29nbml6ZWQgcmVuZGVyaW5nIG1vZGUgcmVxdWVzdCcpO1xuICAgICAgfVxuICAgICAgLy8gVE9ETyhicmFkZnJpenplbGwpOiBjaGFuZ2UgbmFtZSBvZiBmdW5jdGlvbiBhbmQgdmFyXG4gICAgICBsZXQgY29udGV4dE1ldGFkYXRhID0gZ2V0Q29udGV4dE1ldGFkYXRhKFxuICAgICAgICAgIHRoaXMud2luLCB0aGlzLmVsZW1lbnQsIHRoaXMuc2VudGluZWwsXG4gICAgICAgICAgdGhpcy5nZXRBZGRpdGlvbmFsQ29udGV4dE1ldGFkYXRhKG1ldGhvZCA9PSBYT1JJR0lOX01PREUuU0FGRUZSQU1FKSk7XG4gICAgICAvLyBUT0RPKGJyYWRmcml6emVsbCkgQ2xlYW4gdXAgbmFtZSBhc3NpZ25pbmcuXG4gICAgICBpZiAobWV0aG9kID09IFhPUklHSU5fTU9ERS5OQU1FRlJBTUUpIHtcbiAgICAgICAgY29udGV4dE1ldGFkYXRhWydjcmVhdGl2ZSddID0gY3JlYXRpdmU7XG4gICAgICAgIG5hbWUgPSBKU09OLnN0cmluZ2lmeShjb250ZXh0TWV0YWRhdGEpO1xuICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT0gWE9SSUdJTl9NT0RFLlNBRkVGUkFNRSkge1xuICAgICAgICBjb250ZXh0TWV0YWRhdGEgPSBKU09OLnN0cmluZ2lmeShjb250ZXh0TWV0YWRhdGEpO1xuICAgICAgICBuYW1lID0gYCR7dGhpcy5zYWZlZnJhbWVWZXJzaW9ufTske2NyZWF0aXZlLmxlbmd0aH07JHtjcmVhdGl2ZX1gICtcbiAgICAgICAgICAgIGAke2NvbnRleHRNZXRhZGF0YX1gO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuaWZyYW1lUmVuZGVySGVscGVyXyhkaWN0KHsnc3JjJzogc3JjUGF0aCwgJ25hbWUnOiBuYW1lfSkpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIFRocm93cyB7QGNvZGUgU3ludGF4RXJyb3J9IGlmIHRoZSBtZXRhZGF0YSBibG9jayBkZWxpbWl0ZXJzIGFyZSBtaXNzaW5nXG4gICAqIG9yIGNvcnJ1cHRlZCBvciBpZiB0aGUgbWV0YWRhdGEgY29udGVudCBkb2Vzbid0IHBhcnNlIGFzIEpTT04uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBjcmVhdGl2ZSBmcm9tIHdoaWNoIENTUyBpcyBleHRyYWN0ZWRcbiAgICogQHJldHVybiB7P0NyZWF0aXZlTWV0YURhdGFEZWZ9IE9iamVjdCByZXN1bHQgb2YgcGFyc2luZyBKU09OIGRhdGEgYmxvYiBpbnNpZGVcbiAgICogICAgIHRoZSBtZXRhZGF0YSBtYXJrZXJzIG9uIHRoZSBhZCB0ZXh0LCBvciBudWxsIGlmIG5vIG1ldGFkYXRhIG1hcmtlcnMgYXJlXG4gICAqICAgICBmb3VuZC5cbiAgICogVE9ETyhrZWl0aHdyaWdodGJvc0ApOiByZXBvcnQgZXJyb3IgY2FzZXNcbiAgICovXG4gIGdldEFtcEFkTWV0YWRhdGEoY3JlYXRpdmUpIHtcbiAgICBsZXQgbWV0YWRhdGFTdGFydCA9IC0xO1xuICAgIGxldCBtZXRhZGF0YVN0cmluZztcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IE1FVEFEQVRBX1NUUklOR1MubGVuZ3RoOyBpKyspIHtcbiAgICAgIG1ldGFkYXRhU3RyaW5nID0gTUVUQURBVEFfU1RSSU5HU1tpXTtcbiAgICAgIG1ldGFkYXRhU3RhcnQgPSBjcmVhdGl2ZS5sYXN0SW5kZXhPZihtZXRhZGF0YVN0cmluZyk7XG4gICAgICBpZiAobWV0YWRhdGFTdGFydCA+PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAobWV0YWRhdGFTdGFydCA8IDApIHtcbiAgICAgIC8vIENvdWxkbid0IGZpbmQgYSBtZXRhZGF0YSBibG9iLlxuICAgICAgZGV2KCkud2FybihUQUcsIHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSxcbiAgICAgICAgICAnQ291bGQgbm90IGxvY2F0ZSBzdGFydCBpbmRleCBmb3IgYW1wIG1ldGEgZGF0YSBpbjogJXMnLCBjcmVhdGl2ZSk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgbWV0YWRhdGFFbmQgPSBjcmVhdGl2ZS5sYXN0SW5kZXhPZignPC9zY3JpcHQ+Jyk7XG4gICAgaWYgKG1ldGFkYXRhRW5kIDwgMCkge1xuICAgICAgLy8gQ291bGRuJ3QgZmluZCBhIG1ldGFkYXRhIGJsb2IuXG4gICAgICBkZXYoKS53YXJuKFRBRywgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpLFxuICAgICAgICAgICdDb3VsZCBub3QgbG9jYXRlIGNsb3Npbmcgc2NyaXB0IHRhZyBmb3IgYW1wIG1ldGEgZGF0YSBpbjogJXMnLFxuICAgICAgICAgIGNyZWF0aXZlKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgY29uc3QgbWV0YURhdGFPYmogPSBwYXJzZUpzb24oXG4gICAgICAgICAgY3JlYXRpdmUuc2xpY2UobWV0YWRhdGFTdGFydCArIG1ldGFkYXRhU3RyaW5nLmxlbmd0aCwgbWV0YWRhdGFFbmQpKTtcbiAgICAgIGNvbnN0IGFtcFJ1bnRpbWVVdGYxNkNoYXJPZmZzZXRzID1cbiAgICAgICAgbWV0YURhdGFPYmpbJ2FtcFJ1bnRpbWVVdGYxNkNoYXJPZmZzZXRzJ107XG4gICAgICBpZiAoIWlzQXJyYXkoYW1wUnVudGltZVV0ZjE2Q2hhck9mZnNldHMpIHx8XG4gICAgICAgICAgYW1wUnVudGltZVV0ZjE2Q2hhck9mZnNldHMubGVuZ3RoICE9IDIgfHxcbiAgICAgICAgICB0eXBlb2YgYW1wUnVudGltZVV0ZjE2Q2hhck9mZnNldHNbMF0gIT09ICdudW1iZXInIHx8XG4gICAgICAgICAgdHlwZW9mIGFtcFJ1bnRpbWVVdGYxNkNoYXJPZmZzZXRzWzFdICE9PSAnbnVtYmVyJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcnVudGltZSBvZmZzZXRzJyk7XG4gICAgICB9XG4gICAgICBjb25zdCBtZXRhRGF0YSA9IHt9O1xuICAgICAgaWYgKG1ldGFEYXRhT2JqWydjdXN0b21FbGVtZW50RXh0ZW5zaW9ucyddKSB7XG4gICAgICAgIG1ldGFEYXRhLmN1c3RvbUVsZW1lbnRFeHRlbnNpb25zID1cbiAgICAgICAgICBtZXRhRGF0YU9ialsnY3VzdG9tRWxlbWVudEV4dGVuc2lvbnMnXTtcbiAgICAgICAgaWYgKCFpc0FycmF5KG1ldGFEYXRhLmN1c3RvbUVsZW1lbnRFeHRlbnNpb25zKSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgJ0ludmFsaWQgZXh0ZW5zaW9ucycsIG1ldGFEYXRhLmN1c3RvbUVsZW1lbnRFeHRlbnNpb25zKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbWV0YURhdGEuY3VzdG9tRWxlbWVudEV4dGVuc2lvbnMgPSBbXTtcbiAgICAgIH1cbiAgICAgIGlmIChtZXRhRGF0YU9ialsnY3VzdG9tU3R5bGVzaGVldHMnXSkge1xuICAgICAgICAvLyBFeHBlY3QgYXJyYXkgb2Ygb2JqZWN0cyB3aXRoIGF0IGxlYXN0IG9uZSBrZXkgYmVpbmcgJ2hyZWYnIHdob3NlXG4gICAgICAgIC8vIHZhbHVlIGlzIFVSTC5cbiAgICAgICAgbWV0YURhdGEuY3VzdG9tU3R5bGVzaGVldHMgPSBtZXRhRGF0YU9ialsnY3VzdG9tU3R5bGVzaGVldHMnXTtcbiAgICAgICAgY29uc3QgZXJyb3JNc2cgPSAnSW52YWxpZCBjdXN0b20gc3R5bGVzaGVldHMnO1xuICAgICAgICBpZiAoIWlzQXJyYXkobWV0YURhdGEuY3VzdG9tU3R5bGVzaGVldHMpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTXNnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHVybHMgPSBTZXJ2aWNlcy51cmxGb3JEb2ModGhpcy5nZXRBbXBEb2MoKSk7XG4gICAgICAgIG1ldGFEYXRhLmN1c3RvbVN0eWxlc2hlZXRzLmZvckVhY2goc3R5bGVzaGVldCA9PiB7XG4gICAgICAgICAgaWYgKCFpc09iamVjdChzdHlsZXNoZWV0KSB8fCAhc3R5bGVzaGVldFsnaHJlZiddIHx8XG4gICAgICAgICAgICAgIHR5cGVvZiBzdHlsZXNoZWV0WydocmVmJ10gIT09ICdzdHJpbmcnIHx8XG4gICAgICAgICAgICAgICF1cmxzLmlzU2VjdXJlKHN0eWxlc2hlZXRbJ2hyZWYnXSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1zZyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChpc0FycmF5KG1ldGFEYXRhT2JqWydpbWFnZXMnXSkpIHtcbiAgICAgICAgLy8gTG9hZCBtYXhpbXVtIG9mIDUgaW1hZ2VzLlxuICAgICAgICBtZXRhRGF0YS5pbWFnZXMgPSBtZXRhRGF0YU9ialsnaW1hZ2VzJ10uc3BsaWNlKDAsIDUpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuaXNTaW5nbGVQYWdlU3RvcnlBZCkge1xuICAgICAgICBpZiAoIW1ldGFEYXRhT2JqWydjdGFVcmwnXSB8fCAhbWV0YURhdGFPYmpbJ2N0YVR5cGUnXSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihJTlZBTElEX1NQU0FfUkVTUE9OU0UpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdmFycy1jdGF0eXBlJywgbWV0YURhdGFPYmpbJ2N0YVR5cGUnXSk7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdmFycy1jdGF1cmwnLCBtZXRhRGF0YU9ialsnY3RhVXJsJ10pO1xuICAgICAgfVxuICAgICAgLy8gVE9ETyhrZWl0aHdyaWdodGJvcyk6IE9LIHRvIGFzc3VtZSBhbXBSdW50aW1lVXRmMTZDaGFyT2Zmc2V0cyBpcyBiZWZvcmVcbiAgICAgIC8vIG1ldGFkYXRhIGFzIGl0cyBpbiB0aGUgaGVhZD9cbiAgICAgIG1ldGFEYXRhLm1pbmlmaWVkQ3JlYXRpdmUgPVxuICAgICAgICBjcmVhdGl2ZS5zbGljZSgwLCBhbXBSdW50aW1lVXRmMTZDaGFyT2Zmc2V0c1swXSkgK1xuICAgICAgICBjcmVhdGl2ZS5zbGljZShhbXBSdW50aW1lVXRmMTZDaGFyT2Zmc2V0c1sxXSwgbWV0YWRhdGFTdGFydCkgK1xuICAgICAgICBjcmVhdGl2ZS5zbGljZShtZXRhZGF0YUVuZCArICc8L3NjcmlwdD4nLmxlbmd0aCk7XG4gICAgICByZXR1cm4gbWV0YURhdGE7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBkZXYoKS53YXJuKFxuICAgICAgICAgIFRBRywgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpLCAnSW52YWxpZCBhbXAgbWV0YWRhdGE6ICVzJyxcbiAgICAgICAgICBjcmVhdGl2ZS5zbGljZShtZXRhZGF0YVN0YXJ0ICsgbWV0YWRhdGFTdHJpbmcubGVuZ3RoLCBtZXRhZGF0YUVuZCkpO1xuICAgICAgaWYgKHRoaXMuaXNTaW5nbGVQYWdlU3RvcnlBZCkge1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7c3RyaW5nfSBmdWxsIHVybCB0byBzYWZlZnJhbWUgaW1wbGVtZW50YXRpb24uXG4gICAqL1xuICBnZXRTYWZlZnJhbWVQYXRoKCkge1xuICAgIHJldHVybiAnaHR0cHM6Ly90cGMuZ29vZ2xlc3luZGljYXRpb24uY29tL3NhZmVmcmFtZS8nICtcbiAgICAgIGAke3RoaXMuc2FmZWZyYW1lVmVyc2lvbn0vaHRtbC9jb250YWluZXIuaHRtbGA7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIHRoZSBnaXZlbiBsaWZlY3ljbGUgZXZlbnQgaGFzIGEgY29ycmVzcG9uZGluZyBhbXAtYW5hbHl0aWNzIGV2ZW50XG4gICAqIGFuZCBmaXJlcyB0aGUgYW5hbHl0aWNzIHRyaWdnZXIgaWYgc28uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBsaWZlY3ljbGVTdGFnZVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgbWF5YmVUcmlnZ2VyQW5hbHl0aWNzRXZlbnRfKGxpZmVjeWNsZVN0YWdlKSB7XG4gICAgaWYgKCF0aGlzLmE0YUFuYWx5dGljc0NvbmZpZ18pIHtcbiAgICAgIC8vIE5vIGNvbmZpZyBleGlzdHMgdGhhdCB3aWxsIGxpc3RlbiB0byB0aGlzIGV2ZW50LlxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBhbmFseXRpY3NFdmVudCA9XG4gICAgICAgIGRldigpLmFzc2VydChMSUZFQ1lDTEVfU1RBR0VfVE9fQU5BTFlUSUNTX1RSSUdHRVJbbGlmZWN5Y2xlU3RhZ2VdKTtcbiAgICBjb25zdCBhbmFseXRpY3NWYXJzID0gT2JqZWN0LmFzc2lnbihcbiAgICAgICAgeyd0aW1lJzogTWF0aC5yb3VuZCh0aGlzLmdldE5vd18oKSl9LFxuICAgICAgICB0aGlzLmdldEE0YUFuYWx5dGljc1ZhcnMoYW5hbHl0aWNzRXZlbnQpKTtcbiAgICB0cmlnZ2VyQW5hbHl0aWNzRXZlbnQodGhpcy5lbGVtZW50LCBhbmFseXRpY3NFdmVudCwgYW5hbHl0aWNzVmFycyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB2YXJpYWJsZXMgdG8gYmUgaW5jbHVkZWQgb24gYW4gYW5hbHl0aWNzIGV2ZW50LiBUaGlzIGNhbiBiZVxuICAgKiBvdmVycmlkZGVuIGJ5IHNwZWNpZmljIG5ldHdvcmsgaW1wbGVtZW50YXRpb25zLlxuICAgKiBOb3RlIHRoYXQgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgZm9yIGVhY2ggdGltZSBhbiBhbmFseXRpY3MgZXZlbnQgaXNcbiAgICogZmlyZWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB1bnVzZWRBbmFseXRpY3NFdmVudCBUaGUgbmFtZSBvZiB0aGUgYW5hbHl0aWNzIGV2ZW50LlxuICAgKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn1cbiAgICovXG4gIGdldEE0YUFuYWx5dGljc1ZhcnModW51c2VkQW5hbHl0aWNzRXZlbnQpIHsgcmV0dXJuIHt9OyB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgbmV0d29yay1zcGVjaWZpYyBjb25maWcgZm9yIGFtcC1hbmFseXRpY3MuIEl0IHNob3VsZCBvdmVycmlkZGVuXG4gICAqIHdpdGggbmV0d29yay1zcGVjaWZpYyBjb25maWd1cmF0aW9ucy5cbiAgICogVGhpcyBmdW5jdGlvbiBtYXkgcmV0dXJuIG51bGwuIElmIHNvLCBubyBhbXAtYW5hbHl0aWNzIGVsZW1lbnQgd2lsbCBiZVxuICAgKiBhZGRlZCB0byB0aGlzIEE0QSBlbGVtZW50IGFuZCBubyBBNEEgdHJpZ2dlcnMgd2lsbCBiZSBmaXJlZC5cbiAgICogQHJldHVybiB7P0pzb25PYmplY3R9XG4gICAqL1xuICBnZXRBNGFBbmFseXRpY3NDb25maWcoKSB7IHJldHVybiBudWxsOyB9XG5cbiAgLyoqXG4gICAqIEF0dGVtcHRzIHRvIGV4ZWN1dGUgUmVhbCBUaW1lIENvbmZpZywgaWYgdGhlIGFkIG5ldHdvcmsgaGFzIGVuYWJsZWQgaXQuXG4gICAqIElmIGl0IGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhlIG5ldHdvcmssIGJ1dCB0aGUgcHVibGlzaGVyIGhhcyBpbmNsdWRlZFxuICAgKiB0aGUgcnRjLWNvbmZpZyBhdHRyaWJ1dGUgb24gdGhlIGFtcC1hZCBlbGVtZW50LCB3YXJuLlxuICAgKiBAcGFyYW0gez9DT05TRU5UX1BPTElDWV9TVEFURX0gY29uc2VudFN0YXRlXG4gICAqIEByZXR1cm4ge1Byb21pc2U8IUFycmF5PCFydGNSZXNwb25zZURlZj4+fHVuZGVmaW5lZH1cbiAgICovXG4gIHRyeUV4ZWN1dGVSZWFsVGltZUNvbmZpZ18oY29uc2VudFN0YXRlKSB7XG4gICAgaWYgKCEhQU1QLlJlYWxUaW1lQ29uZmlnTWFuYWdlcikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIG5ldyBBTVAuUmVhbFRpbWVDb25maWdNYW5hZ2VyKHRoaXMpXG4gICAgICAgICAgICAubWF5YmVFeGVjdXRlUmVhbFRpbWVDb25maWcoXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRDdXN0b21SZWFsVGltZUNvbmZpZ01hY3Jvc18oKSwgY29uc2VudFN0YXRlKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICB1c2VyKCkuZXJyb3IoVEFHLCAnQ291bGQgbm90IHBlcmZvcm0gUmVhbCBUaW1lIENvbmZpZy4nLCBlcnIpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgncnRjLWNvbmZpZycpKSB7XG4gICAgICB1c2VyKCkuZXJyb3IoVEFHLCAnUlRDIG5vdCBzdXBwb3J0ZWQgZm9yIGFkIG5ldHdvcmsgJyArXG4gICAgICAgICAgICAgICAgICAgYCR7dGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpfWApO1xuXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRvIGJlIG92ZXJyaWRlbiBieSBuZXR3b3JrIGltcGwuIFNob3VsZCByZXR1cm4gYSBtYXBwaW5nIG9mIG1hY3JvIGtleXNcbiAgICogdG8gdmFsdWVzIGZvciBzdWJzdGl0dXRpb24gaW4gcHVibGlzaGVyLXNwZWNpZmllZCBVUkxzIGZvciBSVEMuXG4gICAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLFxuICAgKiAgICEuLi8uLi8uLi9zcmMvc2VydmljZS92YXJpYWJsZS1zb3VyY2UuQXN5bmNSZXNvbHZlckRlZj59XG4gICAqL1xuICBnZXRDdXN0b21SZWFsVGltZUNvbmZpZ01hY3Jvc18oKSB7XG4gICAgcmV0dXJuIHt9O1xuICB9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgcHJlZmVyZW50aWFsIHJlbmRlciBzaG91bGQgc3RpbGwgYmUgdXRpbGl6ZWQgaWYgd2ViIGNyeXB0byBpc1xuICAgKiB1bmF2YWlsYWJsZSwgYW5kIGNyeXB0byBzaWduYXR1cmUgaGVhZGVyIGlzIHByZXNlbnQuXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBzaG91bGRQcmVmZXJlbnRpYWxSZW5kZXJXaXRob3V0Q3J5cHRvKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZz19IGhlYWRlclZhbHVlIE1ldGhvZCBhcyBnaXZlbiBpbiBoZWFkZXIuXG4gICAqL1xuICBnZXROb25BbXBDcmVhdGl2ZVJlbmRlcmluZ01ldGhvZChoZWFkZXJWYWx1ZSkge1xuICAgIGlmIChoZWFkZXJWYWx1ZSkge1xuICAgICAgaWYgKCFpc0VudW1WYWx1ZShYT1JJR0lOX01PREUsIGhlYWRlclZhbHVlKSkge1xuICAgICAgICBkZXYoKS5lcnJvcihcbiAgICAgICAgICAgICdBTVAtQTRBJywgYGNyb3NzLW9yaWdpbiByZW5kZXIgbW9kZSBoZWFkZXIgJHtoZWFkZXJWYWx1ZX1gKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBoZWFkZXJWYWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFNlcnZpY2VzLnBsYXRmb3JtRm9yKHRoaXMud2luKS5pc0lvcygpID9cbiAgICAgIFhPUklHSU5fTU9ERS5OQU1FRlJBTUUgOiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYmFzZSBvYmplY3QgdGhhdCB3aWxsIGJlIHdyaXR0ZW4gdG8gY3Jvc3MtZG9tYWluIGlmcmFtZSBuYW1lXG4gICAqIGF0dHJpYnV0ZS5cbiAgICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2lzU2FmZWZyYW1lIFdoZXRoZXIgY3JlYXRpdmUgaXMgcmVuZGVyaW5nIGludG9cbiAgICogICBhIHNhZmVmcmFtZS5cbiAgICogQHJldHVybiB7IUpzb25PYmplY3R8dW5kZWZpbmVkfVxuICAgKi9cbiAgZ2V0QWRkaXRpb25hbENvbnRleHRNZXRhZGF0YShvcHRfaXNTYWZlZnJhbWUpIHt9XG59XG5cbi8qKlxuICogQXR0YWNocyBxdWVyeSBzdHJpbmcgcG9ydGlvbiBvZiBhZCB1cmwgdG8gZXJyb3IuXG4gKiBAcGFyYW0geyFFcnJvcn0gZXJyb3JcbiAqIEBwYXJhbSB7P3N0cmluZ30gYWRVcmxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2lnbkFkVXJsVG9FcnJvcihlcnJvciwgYWRVcmwpIHtcbiAgaWYgKCFhZFVybCB8fCAoZXJyb3IuYXJncyAmJiBlcnJvci5hcmdzWydhdSddKSkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBhZFF1ZXJ5SWR4ID0gYWRVcmwuaW5kZXhPZignPycpO1xuICBpZiAoYWRRdWVyeUlkeCA9PSAtMSkge1xuICAgIHJldHVybjtcbiAgfVxuICAoZXJyb3IuYXJncyB8fCAoZXJyb3IuYXJncyA9IHt9KSlbJ2F1J10gPVxuICAgIGFkVXJsLnN1YnN0cmluZyhhZFF1ZXJ5SWR4ICsgMSwgYWRRdWVyeUlkeCArIDI1MSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgc2lnbmF0dXJlIHZlcmlmaWVyIGZvciB0aGUgZ2l2ZW4gd2luZG93LiBMYXppbHkgY3JlYXRlcyBpdCBpZiBpdFxuICogZG9lc24ndCBhbHJlYWR5IGV4aXN0LlxuICpcbiAqIFRoaXMgZW5zdXJlcyB0aGF0IG9ubHkgb25lIHNpZ25hdHVyZSB2ZXJpZmllciBleGlzdHMgcGVyIHdpbmRvdywgd2hpY2ggYWxsb3dzXG4gKiBtdWx0aXBsZSBGYXN0IEZldGNoIGFkIHNsb3RzIG9uIGEgcGFnZSAoZXZlbiBvbmVzIGZyb20gZGlmZmVyZW50IGFkIG5ldHdvcmtzKVxuICogdG8gc2hhcmUgdGhlIHNhbWUgY2FjaGVkIHB1YmxpYyBrZXlzLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshU2lnbmF0dXJlVmVyaWZpZXJ9XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNpZ25hdHVyZVZlcmlmaWVyRm9yKHdpbikge1xuICBjb25zdCBwcm9wZXJ0eU5hbWUgPSAnQU1QX0ZBU1RfRkVUQ0hfU0lHTkFUVVJFX1ZFUklGSUVSXyc7XG4gIHJldHVybiB3aW5bcHJvcGVydHlOYW1lXSB8fFxuICAgICAgKHdpbltwcm9wZXJ0eU5hbWVdID0gbmV3IFNpZ25hdHVyZVZlcmlmaWVyKHdpbiwgc2lnbmluZ1NlcnZlclVSTHMpKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuLi8uLi8uLi9zcmMvbW9kZSc7XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4vLyAgICAgSU1QT1JUQU5UOiBBbGwga2V5cyBpbiBSVENfVkVORE9SUyBtdXN0IGJlIGxvd2VyY2FzZSAgICAgLy9cbi8vICAgICAgIG90aGVyd2lzZSB0aGUgdmVuZG9yIGVuZHBvaW50IHdpbGwgbm90IGJlIHVzZWQuICAgICAgICAvL1xuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuLy8gTm90ZTogZGlzYWJsZUtleUFwcGVuZCBpcyBhbiBvcHRpb24gc3BlY2lmaWNhbGx5IGZvciBEb3VibGVDbGljaydzXG4vLyBpbXBsZW1lbnRhdGlvbiBvZiBSVEMuIEl0IHByZXZlbnRzIHRoZSB2ZW5kb3IgSUQgZnJvbSBiZWluZ1xuLy8gYXBwZW5kZWQgb250byBlYWNoIGtleSBvZiB0aGUgUlRDIHJlc3BvbnNlLCBmb3IgZWFjaCB2ZW5kb3IuXG4vLyBUaGlzIGFwcGVuZGluZyBpcyBkb25lIHRvIHByZXZlbnQgYSBjb2xsaXNpb24gY2FzZSBkdXJpbmcgbWVyZ2Vcbi8vIHRoYXQgd291bGQgY2F1c2Ugb25lIFJUQyByZXNwb25zZSB0byBvdmVyd3JpdGUgYW5vdGhlciBpZiB0aGV5XG4vLyBzaGFyZSBrZXkgbmFtZXMuXG4vKiogQHR5cGVkZWYge3tcbiAgICB1cmw6IHN0cmluZyxcbiAgICBtYWNyb3M6IEFycmF5PHN0cmluZz4sXG4gICAgZXJyb3JSZXBvcnRpbmdVcmw6IChzdHJpbmd8dW5kZWZpbmVkKSxcbiAgICBkaXNhYmxlS2V5QXBwZW5kOiBib29sZWFufX0gKi9cbmxldCBSdGNWZW5kb3JEZWY7XG5cbi8qKiBAY29uc3QgeyFPYmplY3Q8c3RyaW5nLCBSdGNWZW5kb3JEZWY+fSAqL1xuZXhwb3J0IGNvbnN0IFJUQ19WRU5ET1JTID0ge1xuICAvLyBBZGQgdmVuZG9ycyBoZXJlXG4gIG1lZGlhbmV0OiB7XG4gICAgdXJsOiAnaHR0cHM6Ly9hbXBydGMubWVkaWEubmV0L3J0Yi9nZXRydGM/Y2lkPUNJRCZ3PUFUVFIod2lkdGgpJmg9QVRUUihoZWlnaHQpJm93PUFUVFIoZGF0YS1vdmVycmlkZS13aWR0aCkmb2g9QVRUUihkYXRhLW92ZXJyaWRlLWhlaWdodCkmbXM9QVRUUihkYXRhLW11bHRpLXNpemUpJnNsb3Q9QVRUUihkYXRhLXNsb3QpJnRndD1UR1QmY3VybD1DQU5PTklDQUxfVVJMJnRvPVRJTUVPVVQmcHVybD1IUkVGJyxcbiAgICBtYWNyb3M6IFsnQ0lEJ10sXG4gICAgZXJyb3JSZXBvcnRpbmdVcmw6ICdodHRwczovL3FzZWFyY2gtYS5ha2FtYWloZC5uZXQvbG9nP2xvZ2lkPWtmayZldnRpZD1wcm9qZWN0ZXZlbnRzJnByb2plY3Q9YW1wcnRjX2Vycm9yJmVycm9yPUVSUk9SX1RZUEUmcmQ9SFJFRicsXG4gICAgZGlzYWJsZUtleUFwcGVuZDogdHJ1ZSxcbiAgfSxcbiAgcHJlYmlkYXBwbmV4dXM6IHtcbiAgICB1cmw6ICdodHRwczovL3ByZWJpZC5hZG54cy5jb20vcGJzL3YxL29wZW5ydGIyL2FtcD90YWdfaWQ9UExBQ0VNRU5UX0lEJnc9QVRUUih3aWR0aCkmaD1BVFRSKGhlaWdodCkmb3c9QVRUUihkYXRhLW92ZXJyaWRlLXdpZHRoKSZvaD1BVFRSKGRhdGEtb3ZlcnJpZGUtaGVpZ2h0KSZtcz1BVFRSKGRhdGEtbXVsdGktc2l6ZSkmc2xvdD1BVFRSKGRhdGEtc2xvdCkmdGFyZ2V0aW5nPVRHVCZjdXJsPUNBTk9OSUNBTF9VUkwmdGltZW91dD1USU1FT1VUJmFkY2lkPUFEQ0lEJnB1cmw9SFJFRicsXG4gICAgbWFjcm9zOiBbJ1BMQUNFTUVOVF9JRCddLFxuICAgIGRpc2FibGVLZXlBcHBlbmQ6IHRydWUsXG4gIH0sXG4gIHByZWJpZHJ1Ymljb246IHtcbiAgICB1cmw6ICdodHRwczovL3ByZWJpZC1zZXJ2ZXIucnViaWNvbnByb2plY3QuY29tL29wZW5ydGIyL2FtcD90YWdfaWQ9UkVRVUVTVF9JRCZ3PUFUVFIod2lkdGgpJmg9QVRUUihoZWlnaHQpJm93PUFUVFIoZGF0YS1vdmVycmlkZS13aWR0aCkmb2g9QVRUUihkYXRhLW92ZXJyaWRlLWhlaWdodCkmbXM9QVRUUihkYXRhLW11bHRpLXNpemUpJnNsb3Q9QVRUUihkYXRhLXNsb3QpJnRhcmdldGluZz1UR1QmY3VybD1DQU5PTklDQUxfVVJMJnRpbWVvdXQ9VElNRU9VVCZhZGM9QURDSUQmcHVybD1IUkVGJyxcbiAgICBtYWNyb3M6IFsnUkVRVUVTVF9JRCddLFxuICAgIGRpc2FibGVLZXlBcHBlbmQ6IHRydWUsXG4gIH0sXG4gIGluZGV4ZXhjaGFuZ2U6IHtcbiAgICB1cmw6ICdodHRwczovL2FtcC5jYXNhbGVtZWRpYS5jb20vYW1wcnRjP3Y9MSZ3PUFUVFIod2lkdGgpJmg9QVRUUihoZWlnaHQpJm93PUFUVFIoZGF0YS1vdmVycmlkZS13aWR0aCkmb2g9QVRUUihkYXRhLW92ZXJyaWRlLWhlaWdodCkmbXM9QVRUUihkYXRhLW11bHRpLXNpemUpJnM9U0lURV9JRCZwPUNBTk9OSUNBTF9VUkwnLFxuICAgIG1hY3JvczogWydTSVRFX0lEJ10sXG4gICAgZGlzYWJsZUtleUFwcGVuZDogdHJ1ZSxcbiAgfSxcbiAgbG90YW1lOiB7XG4gICAgdXJsOiAnaHR0cHM6Ly9hZC5jcndkY250cmwubmV0LzUvcGU9eS9jPUNMSUVOVF9JRC9hbj1BRF9ORVRXT1JLJyxcbiAgICBtYWNyb3M6IFsnQ0xJRU5UX0lEJywgJ0FEX05FVFdPUksnXSxcbiAgfSxcbiAgeWllbGRib3Q6IHtcbiAgICB1cmw6ICdodHRwczovL2kueWxkYnQuY29tL20vWUJfUFNOL3YxL2FtcC9pbml0P2N1cmw9Q0FOT05JQ0FMX1VSTCZzbj1ZQl9TTE9UJnc9QVRUUih3aWR0aCkmaD1BVFRSKGhlaWdodCkmb3c9QVRUUihkYXRhLW92ZXJyaWRlLXdpZHRoKSZvaD1BVFRSKGRhdGEtb3ZlcnJpZGUtaGVpZ2h0KSZtcz1BVFRSKGRhdGEtbXVsdGktc2l6ZSkmYXVwPUFUVFIoZGF0YS1zbG90KSZwdmk9UEFHRVZJRVdJRCZ0Z3Q9VEdUJmFkY2lkPUFEQ0lEJmhyZWY9SFJFRicsXG4gICAgbWFjcm9zOiBbJ1lCX1BTTicsICdZQl9TTE9UJ10sXG4gICAgZGlzYWJsZUtleUFwcGVuZDogdHJ1ZSxcbiAgfSxcbiAgc2FsZXNmb3JjZWRtcDoge1xuICAgIHVybDogJ2h0dHBzOi8vY2RuLmtyeGQubmV0L3VzZXJkYXRhL3YyL2FtcC9PUkdBTklaQVRJT05fSUQ/c2VnbWVudHNfa2V5PVNFR01FTlRTX0tFWSZrdWlkX2tleT1VU0VSX0tFWScsXG4gICAgbWFjcm9zOiBbJ09SR0FOSVpBVElPTl9JRCcsICdTRUdNRU5UU19LRVknLCAnVVNFUl9LRVknXSxcbiAgICBkaXNhYmxlS2V5QXBwZW5kOiB0cnVlLFxuICB9LFxuICBwdXJjaDoge1xuICAgIHVybDogJ2h0dHBzOi8vYWRzLnNlcnZlYm9tLmNvbS90bW50YWcuanM/dj0xLjImZm10PWFtcCZvPXslMjJwJTIyJTNBUExBQ0VNRU5UX0lEfSZkaXZfaWQ9RElWX0lEJyxcbiAgICBtYWNyb3M6IFsnUExBQ0VNRU5UX0lEJywgJ0RJVl9JRCddLFxuICAgIGRpc2FibGVLZXlBcHBlbmQ6IHRydWUsXG4gIH0sXG4gIGFwczoge1xuICAgIHVybDogJ2h0dHBzOi8vYWF4LmFtYXpvbi1hZHN5c3RlbS5jb20vZS9kdGIvYmlkP3NyYz1QVUJfSUQmYW1wPTEmdT1DQU5PTklDQUxfVVJMJnNsb3RzPSU1QiU3QiUyMnNkJTIyJTNBJTIyQVRUUihkYXRhLXNsb3QpJTIyJTJDJTIycyUyMiUzQSU1QiUyMkFUVFIod2lkdGgpeEFUVFIoaGVpZ2h0KSUyMiU1RCU3RCU1RCZwaj1QQVJBTVMnLFxuICAgIG1hY3JvczogWydQVUJfSUQnLCAnUEFSQU1TJ10sXG4gICAgZGlzYWJsZUtleUFwcGVuZDogdHJ1ZSxcbiAgfSxcbiAgb3BlbndyYXA6IHtcbiAgICAvLyBQdWJNYXRpYyBPcGVuV3JhcFxuICAgIHVybDogJ2h0dHBzOi8vb3cucHVibWF0aWMuY29tL2FtcD92PTEmdz1BVFRSKHdpZHRoKSZoPUFUVFIoaGVpZ2h0KSZtcz1BVFRSKGRhdGEtbXVsdGktc2l6ZSkmYXVJZD1BVFRSKGRhdGEtc2xvdCkmcHVybD1IUkVGJnB1YklkPVBVQl9JRCZwcm9mSWQ9UFJPRklMRV9JRCcsXG4gICAgbWFjcm9zOiBbJ1BVQl9JRCcsICdQUk9GSUxFX0lEJ10sXG4gICAgZXJyb3JSZXBvcnRpbmdVcmw6ICdodHRwczovL293LnB1Ym1hdGljLmNvbS9hbXBfZXJyb3I/ZT1FUlJPUl9UWVBFJmg9SFJFRicsXG4gICAgZGlzYWJsZUtleUFwcGVuZDogdHJ1ZSxcbiAgfSxcbiAgY3JpdGVvOiB7XG4gICAgdXJsOiAnaHR0cHM6Ly9iaWRkZXIuY3JpdGVvLmNvbS9hbXAvcnRjP3ppZD1aT05FX0lEJm5pZD1ORVRXT1JLX0lEJnBzdWJpZD1QVUJMSVNIRVJfU1VCX0lEJmxpcj1MSU5FX0lURU1fUkFOR0VTJnc9QVRUUih3aWR0aCkmaD1BVFRSKGhlaWdodCkmb3c9QVRUUihkYXRhLW92ZXJyaWRlLXdpZHRoKSZvaD1BVFRSKGRhdGEtb3ZlcnJpZGUtaGVpZ2h0KSZtcz1BVFRSKGRhdGEtbXVsdGktc2l6ZSkmc2xvdD1BVFRSKGRhdGEtc2xvdCkmdGltZW91dD1USU1FT1VUJmhyZWY9SFJFRicsXG4gICAgbWFjcm9zOiBbJ1pPTkVfSUQnLCAnTkVUV09SS19JRCcsICdQVUJMSVNIRVJfU1VCX0lEJywgJ0xJTkVfSVRFTV9SQU5HRVMnXSxcbiAgICBkaXNhYmxlS2V5QXBwZW5kOiB0cnVlLFxuICB9LFxufTtcblxuLy8gRE8gTk9UIE1PRElGWTogU2V0dXAgZm9yIHRlc3RzXG5pZiAoZ2V0TW9kZSgpLmxvY2FsRGV2IHx8IGdldE1vZGUoKS50ZXN0KSB7XG4gIFJUQ19WRU5ET1JTWydmYWtldmVuZG9yJ10gPSAvKiogQHR5cGUge1J0Y1ZlbmRvckRlZn0gKi8oe1xuICAgIHVybDogJ2h0dHBzOi8vbG9jYWxob3N0OjgwMDAvZXhhbXBsZXMvcnRjRTEuanNvbj9zbG90X2lkPVNMT1RfSUQmcGFnZV9pZD1QQUdFX0lEJmZvb19pZD1GT09fSUQnLFxuICAgIG1hY3JvczogWydTTE9UX0lEJywgJ1BBR0VfSUQnLCAnRk9PX0lEJ10sXG4gIH0pO1xuICBSVENfVkVORE9SU1snZmFrZXZlbmRvcjInXSA9IC8qKiBAdHlwZSB7UnRjVmVuZG9yRGVmfSAqLyh7XG4gICAgdXJsOiAnaHR0cHM6Ly9sb2NhbGhvc3Q6ODAwMC9leGFtcGxlcy9ydGNFMS5qc29uP3Nsb3RfaWQ9U0xPVF9JRCZwYWdlX2lkPVBBR0VfSUQmZm9vX2lkPUZPT19JRCcsXG4gICAgZXJyb3JSZXBvcnRpbmdVcmw6ICdodHRwczovL2xvY2FsaG9zdDo4MDAwL2V4YW1wbGVzL0VSUk9SX1RZUEUnLFxuICAgIGRpc2FibGVLZXlBcHBlbmQ6IHRydWUsXG4gIH0pO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQge0NPTlNFTlRfUE9MSUNZX1NUQVRFfSBmcm9tICcuLi8uLi8uLi9zcmMvY29uc2VudC1zdGF0ZSc7XG5pbXBvcnQge1JUQ19WRU5ET1JTfSBmcm9tICcuL2NhbGxvdXQtdmVuZG9ycyc7XG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZXMnO1xuaW1wb3J0IHtkZXYsIHVzZXJ9IGZyb20gJy4uLy4uLy4uL3NyYy9sb2cnO1xuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuLi8uLi8uLi9zcmMvbW9kZSc7XG5pbXBvcnQge2lzQXJyYXksIGlzT2JqZWN0fSBmcm9tICcuLi8uLi8uLi9zcmMvdHlwZXMnO1xuaW1wb3J0IHtpc0NhbmNlbGxhdGlvbn0gZnJvbSAnLi4vLi4vLi4vc3JjL2Vycm9yJztcbmltcG9ydCB7dHJ5UGFyc2VKc29ufSBmcm9tICcuLi8uLi8uLi9zcmMvanNvbic7XG5cbi8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuY29uc3QgVEFHID0gJ3JlYWwtdGltZS1jb25maWcnO1xuXG4vKiogQHR5cGUge251bWJlcn0gKi9cbmNvbnN0IE1BWF9SVENfQ0FMTE9VVFMgPSA1O1xuXG4vKiogQHR5cGUge251bWJlcn0gKi9cbmNvbnN0IE1BWF9VUkxfTEVOR1RIID0gMTYzODQ7XG5cbi8qKiBAdHlwZSB7Ym9vbGVhbn0gKi9cbmNvbnN0IEVSUk9SX1JFUE9SVElOR19FTkFCTEVEID0gZ2V0TW9kZSh3aW5kb3cpLmxvY2FsRGV2IHx8XG4gICAgICBnZXRNb2RlKHdpbmRvdykudGVzdCB8fCBNYXRoLnJhbmRvbSgpIDwgMC4wMTtcblxuLyoqIEB0eXBlZGVmIHt7XG4gICAgdXJsczogKHVuZGVmaW5lZHxBcnJheTxzdHJpbmc+fFxuICAgICAgQXJyYXk8e3VybDpzdHJpbmcsIGVycm9yUmVwb3J0aW5nVXJsOnN0cmluZyxcbiAgICAgICAgc2VuZFJlZ2FyZGxlc3NPZkNvbnNlbnRTdGF0ZToodW5kZWZpbmVkfGJvb2xlYW58QXJyYXk8c3RyaW5nPil9PiksXG4gICAgdmVuZG9yczogKHVuZGVmaW5lZHxPYmplY3QpLFxuICAgIHRpbWVvdXRNaWxsaXM6IG51bWJlcixcbiAgICBlcnJvclJlcG9ydGluZ1VybDogKHVuZGVmaW5lZHxzdHJpbmcpLFxuICAgIHNlbmRSZWdhcmRsZXNzT2ZDb25zZW50U3RhdGU6ICh1bmRlZmluZWR8Ym9vbGVhbnxBcnJheTxzdHJpbmc+KVxufX0gKi9cbmxldCBSdGNDb25maWdEZWY7XG5cbi8qKlxuICogRW51bSBzdGFydHMgYXQgNCBiZWNhdXNlIDEtMyByZXNlcnZlZCBhczpcbiAqICAxID0gY3VzdG9tIHJlbW90ZS5odG1sIGluIHVzZS5cbiAqICAyID0gUlRDIHN1Y2NlZWRlZC5cbiAqICAzID0gZGVwcmVjYXRlZCBnZW5lcmljIFJUQyBmYWlsdXJlcy5cbiAqIEBlbnVtIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBjb25zdCBSVENfRVJST1JfRU5VTSA9IHtcbiAgLy8gT2NjdXJzIHdoZW4gcmVzcG9uc2UgaXMgdW5wYXJzZWFibGUgYXMgSlNPTlxuICBNQUxGT1JNRURfSlNPTl9SRVNQT05TRTogJzQnLFxuICAvLyBPY2N1cnMgd2hlbiBhIHB1Ymxpc2hlciBoYXMgc3BlY2lmaWVkIHRoZSBzYW1lIHVybFxuICAvLyBvciB2ZW5kb3IgdXJsIChhZnRlciBtYWNyb3MgYXJlIHN1YnN0aXR1dGVkKSB0byBjYWxsIG91dCB0byBtb3JlIHRoYW4gb25jZS5cbiAgRFVQTElDQVRFX1VSTDogJzUnLFxuICAvLyBPY2N1cnMgd2hlbiBhIFVSTCBmYWlscyBpc1NlY3VyZVVybCBjaGVjay5cbiAgSU5TRUNVUkVfVVJMOiAnNicsXG4gIC8vIE9jY3VycyB3aGVuIDUgdmFsaWQgY2FsbG91dCB1cmxzIGhhdmUgYWxyZWFkeSBiZWVuIGJ1aWx0LCBhbmQgYWRkaXRpb25hbFxuICAvLyB1cmxzIGFyZSBzdGlsbCBzcGVjaWZpZWQuXG4gIE1BWF9DQUxMT1VUU19FWENFRURFRDogJzcnLFxuICAvLyBPY2N1cnMgZHVlIHRvIFhIUiBmYWlsdXJlLlxuICBORVRXT1JLX0ZBSUxVUkU6ICc4JyxcbiAgLy8gT2NjdXJzIHdoZW4gYSBzcGVjaWZpZWQgdmVuZG9yIGRvZXMgbm90IGV4aXN0IGluIFJUQ19WRU5ET1JTLlxuICBVTktOT1dOX1ZFTkRPUjogJzknLFxuICAvLyBPY2N1cnMgd2hlbiByZXF1ZXN0IHRvb2sgbG9uZ2VyIHRoYW4gdGltZW91dFxuICBUSU1FT1VUOiAnMTAnLFxuICAvLyBPY2N1cnMgd2hlbiBVUkwgZXhwYW5zaW9uIHRpbWUgZXhjZWVkZWQgYWxsb3dlZCB0aW1lb3V0LCByZXF1ZXN0IG5ldmVyXG4gIC8vIHNlbnQuXG4gIE1BQ1JPX0VYUEFORF9USU1FT1VUOiAnMTEnLFxufTtcblxuZXhwb3J0IGNsYXNzIFJlYWxUaW1lQ29uZmlnTWFuYWdlciB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyEuL2FtcC1hNGEuQW1wQTRBfSBhNGFFbGVtZW50XG4gICAqL1xuICBjb25zdHJ1Y3RvcihhNGFFbGVtZW50KSB7XG4gICAgLyoqIEBwcml2YXRlIHshLi9hbXAtYTRhLkFtcEE0QX0gKi9cbiAgICB0aGlzLmE0YUVsZW1lbnRfID0gYTRhRWxlbWVudDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IVdpbmRvd30gKi9cbiAgICB0aGlzLndpbl8gPSB0aGlzLmE0YUVsZW1lbnRfLndpbjtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IU9iamVjdDxzdHJpbmcsIGJvb2xlYW4+fSAqL1xuICAgIHRoaXMuc2VlblVybHNfID0ge307XG5cbiAgICAvKiogQHByaXZhdGUgez9udW1iZXJ9ICovXG4gICAgdGhpcy5ydGNTdGFydFRpbWVfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IUFycmF5PCFQcm9taXNlPCFydGNSZXNwb25zZURlZj4+fSAqL1xuICAgIHRoaXMucHJvbWlzZUFycmF5XyA9IFtdO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/UnRjQ29uZmlnRGVmfSAqL1xuICAgIHRoaXMucnRjQ29uZmlnXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUgIS4uLy4uLy4uL3NyYy9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvYyAqL1xuICAgIHRoaXMuYW1wRG9jXyA9IHRoaXMuYTRhRWxlbWVudF8uZ2V0QW1wRG9jKCk7XG5cbiAgICAvKiogQHByaXZhdGUgez9DT05TRU5UX1BPTElDWV9TVEFURX0gKi9cbiAgICB0aGlzLmNvbnNlbnRTdGF0ZV8gPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBlcnJvclxuICAgKiBAcGFyYW0ge3N0cmluZ30gY2FsbG91dFxuICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JSZXBvcnRpbmdVcmxcbiAgICogQHBhcmFtIHtudW1iZXI9fSBvcHRfcnRjVGltZVxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhcnRjUmVzcG9uc2VEZWY+fVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgYnVpbGRFcnJvclJlc3BvbnNlXyhcbiAgICBlcnJvciwgY2FsbG91dCwgZXJyb3JSZXBvcnRpbmdVcmwsIG9wdF9ydGNUaW1lKSB7XG4gICAgZGV2KCkud2FybihUQUcsIGBSVEMgY2FsbG91dCB0byAke2NhbGxvdXR9IGNhdXNlZCAke2Vycm9yfWApO1xuICAgIGlmIChlcnJvclJlcG9ydGluZ1VybCkge1xuICAgICAgdGhpcy5zZW5kRXJyb3JNZXNzYWdlKGVycm9yLCBlcnJvclJlcG9ydGluZ1VybCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoLyoqQHR5cGUge3J0Y1Jlc3BvbnNlRGVmfSAqLyhcbiAgICAgIHtlcnJvciwgY2FsbG91dCwgcnRjVGltZTogb3B0X3J0Y1RpbWUgfHwgMH0pKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JUeXBlIFVzZXMgdGhlIFJUQ19FUlJPUl9FTlVNIGFib3ZlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JSZXBvcnRpbmdVcmxcbiAgICovXG4gIHNlbmRFcnJvck1lc3NhZ2UoZXJyb3JUeXBlLCBlcnJvclJlcG9ydGluZ1VybCkge1xuICAgIGlmICghRVJST1JfUkVQT1JUSU5HX0VOQUJMRUQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgd2hpdGVsaXN0ID0ge0VSUk9SX1RZUEU6IHRydWUsIEhSRUY6IHRydWV9O1xuICAgIGNvbnN0IG1hY3JvcyA9IHtcbiAgICAgIEVSUk9SX1RZUEU6IGVycm9yVHlwZSxcbiAgICAgIEhSRUY6IHRoaXMud2luXy5sb2NhdGlvbi5ocmVmLFxuICAgIH07XG4gICAgY29uc3QgdXJsID0gU2VydmljZXMudXJsUmVwbGFjZW1lbnRzRm9yRG9jKHRoaXMuYW1wRG9jXykuZXhwYW5kVXJsU3luYyhcbiAgICAgICAgZXJyb3JSZXBvcnRpbmdVcmwsIG1hY3Jvcywgd2hpdGVsaXN0KTtcbiAgICBuZXcgdGhpcy53aW5fLkltYWdlKCkuc3JjID0gdXJsO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnRzIGEgVVJMIGludG8gaXRzIGNvcnJlc3BvbmRpbmcgc2hvcnRlbmVkIGNhbGxvdXQgc3RyaW5nLlxuICAgKiBXZSBhbHNvIHRydW5jYXRlIHRvIGEgbWF4aW11bSBsZW5ndGggb2YgNTAgY2hhcmFjdGVycy5cbiAgICogRm9yIGluc3RhbmNlLCBpZiB3ZSBhcmUgcGFzc2VkXG4gICAqIFwiaHR0cHM6Ly9leGFtcGxlLmNvbS9leGFtcGxlLnBocD9mb289YSZiYXI9YiwgdGhlbiB3ZSByZXR1cm5cbiAgICogZXhhbXBsZS5jb20vZXhhbXBsZS5waHBcbiAgICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAqL1xuICBnZXRDYWxsb3V0UGFyYW1fKHVybCkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IFNlcnZpY2VzLnVybEZvckRvYyhcbiAgICAgICAgdGhpcy5hNGFFbGVtZW50Xy5nZXRBbXBEb2MoKSkucGFyc2UodXJsKTtcbiAgICByZXR1cm4gKHBhcnNlZFVybC5ob3N0bmFtZSArIHBhcnNlZFVybC5wYXRobmFtZSkuc3Vic3RyKDAsIDUwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3IgYSBnaXZlbiBBNEEgRWxlbWVudCwgc2VuZHMgb3V0IFJlYWwgVGltZSBDb25maWcgcmVxdWVzdHMgdG9cbiAgICogYW55IHVybHMgb3IgdmVuZG9ycyBzcGVjaWZpZWQgYnkgdGhlIHB1Ymxpc2hlci5cbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgIS4uLy4uLy4uL3NyYy9zZXJ2aWNlL3ZhcmlhYmxlLXNvdXJjZS5Bc3luY1Jlc29sdmVyRGVmPn0gY3VzdG9tTWFjcm9zIFRoZSBhZC1uZXR3b3JrIHNwZWNpZmllZCBtYWNyb1xuICAgKiAgIHN1YnN0aXR1dGlvbnMgYXZhaWxhYmxlIHRvIHVzZS5cbiAgICogQHBhcmFtIHs/Q09OU0VOVF9QT0xJQ1lfU1RBVEV9IGNvbnNlbnRTdGF0ZVxuICAgKiBAcmV0dXJuIHtQcm9taXNlPCFBcnJheTwhcnRjUmVzcG9uc2VEZWY+Pnx1bmRlZmluZWR9XG4gICAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICAgKi9cbiAgbWF5YmVFeGVjdXRlUmVhbFRpbWVDb25maWcoY3VzdG9tTWFjcm9zLCBjb25zZW50U3RhdGUpIHtcbiAgICBpZiAoIXRoaXMudmFsaWRhdGVSdGNDb25maWdfKHRoaXMuYTRhRWxlbWVudF8uZWxlbWVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5jb25zZW50U3RhdGVfID0gY29uc2VudFN0YXRlO1xuICAgIHRoaXMubW9kaWZ5UnRjQ29uZmlnRm9yQ29uc2VudFN0YXRlU2V0dGluZ3MoKTtcbiAgICBjdXN0b21NYWNyb3MgPSB0aGlzLmFzc2lnbk1hY3JvcyhjdXN0b21NYWNyb3MpO1xuICAgIHRoaXMucnRjU3RhcnRUaW1lXyA9IERhdGUubm93KCk7XG4gICAgdGhpcy5oYW5kbGVSdGNGb3JDdXN0b21VcmxzKGN1c3RvbU1hY3Jvcyk7XG4gICAgdGhpcy5oYW5kbGVSdGNGb3JWZW5kb3JVcmxzKGN1c3RvbU1hY3Jvcyk7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHRoaXMucHJvbWlzZUFycmF5Xyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB3aGV0aGVyIGEgZ2l2ZW4gY2FsbG91dCBvYmplY3QgaXMgdmFsaWQgdG8gc2VuZCBhbiBSVEMgcmVxdWVzdFxuICAgKiB0bywgZm9yIHRoZSBnaXZlbiBjb25zZW50U3RhdGUuXG4gICAqIEBwYXJhbSB7T2JqZWN0fHN0cmluZ30gY2FsbG91dENvbmZpZ1xuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRJc0dsb2JhbGx5VmFsaWRcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICogQHZpc2libGVGb3JUZXN0aW5nXG4gICAqL1xuICBpc1ZhbGlkQ2FsbG91dEZvckNvbnNlbnRTdGF0ZShjYWxsb3V0Q29uZmlnLCBvcHRJc0dsb2JhbGx5VmFsaWQpIHtcbiAgICBjb25zdCB7c2VuZFJlZ2FyZGxlc3NPZkNvbnNlbnRTdGF0ZX0gPSBjYWxsb3V0Q29uZmlnO1xuICAgIGlmICghaXNPYmplY3QoY2FsbG91dENvbmZpZykgfHwgIXNlbmRSZWdhcmRsZXNzT2ZDb25zZW50U3RhdGUpIHtcbiAgICAgIHJldHVybiAhIW9wdElzR2xvYmFsbHlWYWxpZDtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHNlbmRSZWdhcmRsZXNzT2ZDb25zZW50U3RhdGUgPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICByZXR1cm4gc2VuZFJlZ2FyZGxlc3NPZkNvbnNlbnRTdGF0ZTtcbiAgICB9XG5cbiAgICBpZiAoaXNBcnJheShzZW5kUmVnYXJkbGVzc09mQ29uc2VudFN0YXRlKSkge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZW5kUmVnYXJkbGVzc09mQ29uc2VudFN0YXRlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbnNlbnRTdGF0ZV8gPT1cbiAgICAgICAgICAgIENPTlNFTlRfUE9MSUNZX1NUQVRFW3NlbmRSZWdhcmRsZXNzT2ZDb25zZW50U3RhdGVbaV1dKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAoIUNPTlNFTlRfUE9MSUNZX1NUQVRFW3NlbmRSZWdhcmRsZXNzT2ZDb25zZW50U3RhdGVbaV1dKSB7XG4gICAgICAgICAgZGV2KCkud2FybihUQUcsICdJbnZhbGlkIFJUQyBjb25zZW50IHN0YXRlIGdpdmVuOiAnICtcbiAgICAgICAgICAgICAgICAgICAgIGAke3NlbmRSZWdhcmRsZXNzT2ZDb25zZW50U3RhdGVbaV19YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdXNlcigpLndhcm4oVEFHLCAnSW52YWxpZCB2YWx1ZSBmb3Igc2VuZFJlZ2FyZGxlc3NPZkNvbnNlbnRTdGF0ZTonICtcbiAgICAgICAgICAgICAgICBgJHtzZW5kUmVnYXJkbGVzc09mQ29uc2VudFN0YXRlfWApO1xuICAgIHJldHVybiAhIW9wdElzR2xvYmFsbHlWYWxpZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHb2VzIHRocm91Z2ggdGhlIFJUQyBjb25maWcsIGFuZCBmb3IgYW55IFVSTCB0aGF0IHdlIHNob3VsZCBub3QgY2FsbG91dFxuICAgKiBhcyBwZXIgdGhlIGN1cnJlbnQgY29uc2VudCBzdGF0ZSwgZGVsZXRlcyBpdCBmcm9tIHRoZSBSVEMgY29uZmlnLlxuICAgKiBGb3IgZXhhbXBsZSwgaWYgdGhlIFJUQyBjb25maWcgbG9va2VkIGxpa2U6XG4gICAqICAgIHt2ZW5kb3JzOiB7dmVuZG9yQTogeydzZW5kUmVnYXJkbGVzc09mQ29uc2VudFN0YXRlJzogdHJ1ZX1cbiAgICogICAgICAgICAgICAgICB2ZW5kb3JCOiB7J21hY3Jvcyc6IHsnU0xPVF9JRCc6IDF9fX0sXG4gICAqICAgICB1cmxzOiBbJ2h0dHBzOi8vd3d3LnJ0Yy5leGFtcGxlL2V4YW1wbGUnLFxuICAgKiAgICAgICAgICAgIHt1cmw6ICdodHRwczovL3d3dy5ydGNTaXRlMi5leGFtcGxlL2V4YW1wbGUnLFxuICAgKiAgICAgICAgICAgICBzZW5kUmVnYXJkbGVzc09mQ29uc2VudFN0YXRlOiBbJ1VOS05PV04nXX1dXG4gICAqICAgIH1cbiAgICogYW5kIHRoZSBjb25zZW50U3RhdGUgaXMgQ09OU0VOVF9QT0xJQ1lfU1RBVEUuVU5LTk9XTixcbiAgICogdGhlbiB0aGlzIG1ldGhvZCBjYWxsIHdvdWxkIGNsZWFyIHRoZSBjYWxsb3V0cyB0byB2ZW5kb3JCLCBhbmQgdG8gdGhlIGZpcnN0XG4gICAqIGN1c3RvbSBVUkwuXG4gICAqL1xuICBtb2RpZnlSdGNDb25maWdGb3JDb25zZW50U3RhdGVTZXR0aW5ncygpIHtcbiAgICBpZiAodGhpcy5jb25zZW50U3RhdGVfID09IHVuZGVmaW5lZCB8fFxuICAgICAgICB0aGlzLmNvbnNlbnRTdGF0ZV8gPT0gQ09OU0VOVF9QT0xJQ1lfU1RBVEUuU1VGRklDSUVOVCB8fFxuICAgICAgICB0aGlzLmNvbnNlbnRTdGF0ZV8gPT0gQ09OU0VOVF9QT0xJQ1lfU1RBVEUuVU5LTk9XTl9OT1RfUkVRVUlSRUQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBpc0dsb2JhbGx5VmFsaWQgPSB0aGlzLmlzVmFsaWRDYWxsb3V0Rm9yQ29uc2VudFN0YXRlKHRoaXMucnRjQ29uZmlnXyk7XG4gICAgdGhpcy5ydGNDb25maWdfLnVybHMgPSAodGhpcy5ydGNDb25maWdfLnVybHMgfHwgW10pLmZpbHRlcihcbiAgICAgICAgdXJsID0+IHRoaXMuaXNWYWxpZENhbGxvdXRGb3JDb25zZW50U3RhdGUodXJsLCBpc0dsb2JhbGx5VmFsaWQpKTtcblxuICAgIE9iamVjdC5rZXlzKHRoaXMucnRjQ29uZmlnXy52ZW5kb3JzIHx8IHt9KS5mb3JFYWNoKHZlbmRvciA9PiB7XG4gICAgICBpZiAoIXRoaXMuaXNWYWxpZENhbGxvdXRGb3JDb25zZW50U3RhdGUoXG4gICAgICAgICAgdGhpcy5ydGNDb25maWdfLnZlbmRvcnNbdmVuZG9yXSwgaXNHbG9iYWxseVZhbGlkKSkge1xuICAgICAgICBkZWxldGUgdGhpcy5ydGNDb25maWdfLnZlbmRvcnNbdmVuZG9yXTtcbiAgICAgIH1cbiAgICB9KTtcblxuICB9XG5cbiAgLyoqXG4gICAqIEFzc2lnbnMgY29uc3RhbnQgbWFjcm9zIHRoYXQgc2hvdWxkIGV4aXN0IGZvciBhbGwgUlRDIHRvIG9iamVjdCBvZiBjdXN0b21cbiAgICogcGVyLW5ldHdvcmsgbWFjcm9zLlxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAhLi4vLi4vLi4vc3JjL3NlcnZpY2UvdmFyaWFibGUtc291cmNlLkFzeW5jUmVzb2x2ZXJEZWY+fSBtYWNyb3NcbiAgICovXG4gIGFzc2lnbk1hY3JvcyhtYWNyb3MpIHtcbiAgICBtYWNyb3NbJ1RJTUVPVVQnXSA9ICgpID0+IHRoaXMucnRjQ29uZmlnXy50aW1lb3V0TWlsbGlzO1xuICAgIG1hY3Jvc1snQ09OU0VOVF9TVEFURSddID0gKCkgPT4gdGhpcy5jb25zZW50U3RhdGVfO1xuICAgIHJldHVybiBtYWNyb3M7XG4gIH1cblxuICAvKipcbiAgICogTWFuYWdlcyBzZW5kaW5nIHRoZSBSVEMgY2FsbG91dHMgZm9yIHRoZSBDdXN0b20gVVJMcy5cbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgIS4uLy4uLy4uL3NyYy9zZXJ2aWNlL3ZhcmlhYmxlLXNvdXJjZS5Bc3luY1Jlc29sdmVyRGVmPn0gY3VzdG9tTWFjcm9zIFRoZSBhZC1uZXR3b3JrIHNwZWNpZmllZCBtYWNyb1xuICAgKi9cbiAgaGFuZGxlUnRjRm9yQ3VzdG9tVXJscyhjdXN0b21NYWNyb3MpIHtcbiAgICAvLyBGb3IgZWFjaCBwdWJsaXNoZXIgZGVmaW5lZCBVUkwsIGluZmxhdGUgdGhlIHVybCB1c2luZyB0aGUgbWFjcm9zLFxuICAgIC8vIGFuZCBzZW5kIHRoZSBSVEMgcmVxdWVzdC5cbiAgICAodGhpcy5ydGNDb25maWdfLnVybHMgfHwgW10pLmZvckVhY2godXJsT2JqID0+IHtcbiAgICAgIGxldCB1cmwsIGVycm9yUmVwb3J0aW5nVXJsO1xuICAgICAgaWYgKGlzT2JqZWN0KHVybE9iaikpIHtcbiAgICAgICAgdXJsID0gdXJsT2JqLnVybDtcbiAgICAgICAgZXJyb3JSZXBvcnRpbmdVcmwgPSB1cmxPYmouZXJyb3JSZXBvcnRpbmdVcmw7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiB1cmxPYmogPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdXJsID0gdXJsT2JqO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGV2KCkud2FybihUQUcsIGBJbnZhbGlkIHVybDogJHt1cmxPYmp9YCk7XG4gICAgICB9XG4gICAgICB0aGlzLmluZmxhdGVBbmRTZW5kUnRjXyh1cmwsXG4gICAgICAgICAgY3VzdG9tTWFjcm9zLFxuICAgICAgICAgIGVycm9yUmVwb3J0aW5nVXJsKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNYW5hZ2VzIHNlbmRpbmcgdGhlIFJUQyBjYWxsb3V0cyBmb3IgYWxsIHNwZWNpZmllZCB2ZW5kb3JzLlxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAhLi4vLi4vLi4vc3JjL3NlcnZpY2UvdmFyaWFibGUtc291cmNlLkFzeW5jUmVzb2x2ZXJEZWY+fSBjdXN0b21NYWNyb3MgVGhlIGFkLW5ldHdvcmsgc3BlY2lmaWVkIG1hY3JvXG4gICAqL1xuICBoYW5kbGVSdGNGb3JWZW5kb3JVcmxzKGN1c3RvbU1hY3Jvcykge1xuICAgIC8vIEZvciBlYWNoIHZlbmRvciB0aGUgcHVibGlzaGVyIGhhcyBzcGVjaWZpZWQsIGluZmxhdGUgdGhlIHZlbmRvclxuICAgIC8vIHVybCBpZiBpdCBleGlzdHMsIGFuZCBzZW5kIHRoZSBSVEMgcmVxdWVzdC5cbiAgICBPYmplY3Qua2V5cyh0aGlzLnJ0Y0NvbmZpZ18udmVuZG9ycyB8fCBbXSkuZm9yRWFjaCh2ZW5kb3IgPT4ge1xuICAgICAgY29uc3QgdmVuZG9yT2JqZWN0ID0gUlRDX1ZFTkRPUlNbdmVuZG9yLnRvTG93ZXJDYXNlKCldO1xuICAgICAgY29uc3QgdXJsID0gdmVuZG9yT2JqZWN0ID8gdmVuZG9yT2JqZWN0LnVybCA6ICcnO1xuICAgICAgY29uc3QgZXJyb3JSZXBvcnRpbmdVcmwgPSB2ZW5kb3JPYmplY3QgJiYgdmVuZG9yT2JqZWN0LmVycm9yUmVwb3J0aW5nVXJsID9cbiAgICAgICAgdmVuZG9yT2JqZWN0LmVycm9yUmVwb3J0aW5nVXJsIDogJyc7XG4gICAgICBpZiAoIXVybCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9taXNlQXJyYXlfLnB1c2goXG4gICAgICAgICAgICB0aGlzLmJ1aWxkRXJyb3JSZXNwb25zZV8oXG4gICAgICAgICAgICAgICAgUlRDX0VSUk9SX0VOVU0uVU5LTk9XTl9WRU5ET1IsIHZlbmRvciwgZXJyb3JSZXBvcnRpbmdVcmwpKTtcbiAgICAgIH1cbiAgICAgIC8vIFRoZXJlIGFyZSB0d28gdmFsaWQgY29uZmlndXJhdGlvbnMgb2YgdGhlIHZlbmRvciBvYmplY3QuXG4gICAgICAvLyBJdCBjYW4gZWl0aGVyIGJlIGFuIG9iamVjdCBvZiBtYWNyb3MgbWFwcGluZyBzdHJpbmcgdG8gc3RyaW5nLFxuICAgICAgLy8gb3IgaXQgY2FuIGJlIGFuIG9iamVjdCB3aXRoIHN1Yi1vYmplY3RzLCBvbmUgb2Ygd2hpY2ggY2FuIGJlXG4gICAgICAvLyAnbWFjcm9zJy4gVGhpcyBpcyBmb3IgYmFja3dhcmRzIGNvbXBhdGFiaWxpdHkuXG4gICAgICBjb25zdCB2ZW5kb3JNYWNyb3MgPVxuICAgICAgICAgICAgaXNPYmplY3QodGhpcy5ydGNDb25maWdfLnZlbmRvcnNbdmVuZG9yXVsnbWFjcm9zJ10pID9cbiAgICAgICAgICAgICAgdGhpcy5ydGNDb25maWdfLnZlbmRvcnNbdmVuZG9yXVsnbWFjcm9zJ10gOlxuICAgICAgICAgICAgICB0aGlzLnJ0Y0NvbmZpZ18udmVuZG9yc1t2ZW5kb3JdO1xuICAgICAgY29uc3QgdmFsaWRWZW5kb3JNYWNyb3MgPSB7fTtcbiAgICAgIE9iamVjdC5rZXlzKHZlbmRvck1hY3JvcykuZm9yRWFjaChtYWNybyA9PiB7XG4gICAgICAgIGlmICghKHZlbmRvck9iamVjdC5tYWNyb3MgJiYgdmVuZG9yT2JqZWN0Lm1hY3Jvcy5pbmNsdWRlcyhtYWNybykpKSB7XG4gICAgICAgICAgdXNlcigpLmVycm9yKFRBRywgYFVua25vd24gbWFjcm86ICR7bWFjcm99IGZvciB2ZW5kb3I6ICR7dmVuZG9yfWApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IHZhbHVlID0gdmVuZG9yTWFjcm9zW21hY3JvXTtcbiAgICAgICAgICB2YWxpZFZlbmRvck1hY3Jvc1ttYWNyb10gPSBpc09iamVjdCh2YWx1ZSkgfHwgaXNBcnJheSh2YWx1ZSkgP1xuICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkodmFsdWUpIDogdmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgLy8gVGhlIGFkIG5ldHdvcmsgZGVmaW5lZCBtYWNyb3Mgb3ZlcnJpZGUgdmVuZG9yIGRlZmluZWQvcHViIHNwZWNpZmVkLlxuICAgICAgY29uc3QgbWFjcm9zID0gT2JqZWN0LmFzc2lnbih2YWxpZFZlbmRvck1hY3JvcywgY3VzdG9tTWFjcm9zKTtcbiAgICAgIHRoaXMuaW5mbGF0ZUFuZFNlbmRSdGNfKHVybCxcbiAgICAgICAgICBtYWNyb3MsIGVycm9yUmVwb3J0aW5nVXJsLFxuICAgICAgICAgIHZlbmRvci50b0xvd2VyQ2FzZSgpKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gICAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICEuLi8uLi8uLi9zcmMvc2VydmljZS92YXJpYWJsZS1zb3VyY2UuQXN5bmNSZXNvbHZlckRlZj59IG1hY3Jvc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JSZXBvcnRpbmdVcmxcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfdmVuZG9yXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBpbmZsYXRlQW5kU2VuZFJ0Y18odXJsLFxuICAgIG1hY3JvcywgZXJyb3JSZXBvcnRpbmdVcmwsIG9wdF92ZW5kb3IpIHtcbiAgICBsZXQge3RpbWVvdXRNaWxsaXN9ID0gdGhpcy5ydGNDb25maWdfO1xuICAgIGNvbnN0IGNhbGxvdXQgPSBvcHRfdmVuZG9yIHx8IHRoaXMuZ2V0Q2FsbG91dFBhcmFtXyh1cmwpO1xuICAgIGNvbnN0IGNoZWNrU3RpbGxDdXJyZW50ID0gdGhpcy5hNGFFbGVtZW50Xy52ZXJpZnlTdGlsbEN1cnJlbnQuYmluZChcbiAgICAgICAgdGhpcy5hNGFFbGVtZW50XykoKTtcbiAgICAvKipcbiAgICAgKiBUaGUgdGltZSB0aGF0IGl0IHRha2VzIHRvIHN1YnN0aXR1dGUgdGhlIG1hY3JvcyBpbnRvIHRoZSBVUkwgY2FuIHZhcnlcbiAgICAgKiBkZXBlbmRpbmcgb24gd2hhdCB0aGUgdXJsIHJlcXVpcmVzIHRvIGJlIHN1YnN0aXR1dGVkLCBpLmUuIGEgbG9uZ1xuICAgICAqIGFzeW5jIGNhbGwuIFRodXMsIGhvd2V2ZXIgbG9uZyB0aGUgVVJMIHJlcGxhY2VtZW50IHRvb2sgaXMgdHJlYXRlZCBhcyBhXG4gICAgICogdGltZSBwZW5hbHR5LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAgICAgKi9cbiAgICBjb25zdCBzZW5kID0gdXJsID0+IHtcbiAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLnNlZW5VcmxzXykubGVuZ3RoID09IE1BWF9SVENfQ0FMTE9VVFMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRFcnJvclJlc3BvbnNlXyhcbiAgICAgICAgICAgIFJUQ19FUlJPUl9FTlVNLk1BWF9DQUxMT1VUU19FWENFRURFRCxcbiAgICAgICAgICAgIGNhbGxvdXQsIGVycm9yUmVwb3J0aW5nVXJsKTtcbiAgICAgIH1cbiAgICAgIGlmICghU2VydmljZXMudXJsRm9yRG9jKFxuICAgICAgICAgIHRoaXMuYTRhRWxlbWVudF8uZ2V0QW1wRG9jKCkpLmlzU2VjdXJlKHVybCkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRFcnJvclJlc3BvbnNlXyhSVENfRVJST1JfRU5VTS5JTlNFQ1VSRV9VUkwsXG4gICAgICAgICAgICBjYWxsb3V0LCBlcnJvclJlcG9ydGluZ1VybCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5zZWVuVXJsc19bdXJsXSkge1xuICAgICAgICByZXR1cm4gdGhpcy5idWlsZEVycm9yUmVzcG9uc2VfKFJUQ19FUlJPUl9FTlVNLkRVUExJQ0FURV9VUkwsXG4gICAgICAgICAgICBjYWxsb3V0LCBlcnJvclJlcG9ydGluZ1VybCk7XG4gICAgICB9XG4gICAgICB0aGlzLnNlZW5VcmxzX1t1cmxdID0gdHJ1ZTtcbiAgICAgIGlmICh1cmwubGVuZ3RoID4gTUFYX1VSTF9MRU5HVEgpIHtcbiAgICAgICAgdXJsID0gdGhpcy50cnVuY1VybF8odXJsKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLnNlbmRSdGNDYWxsb3V0XyhcbiAgICAgICAgICB1cmwsIHRpbWVvdXRNaWxsaXMsIGNhbGxvdXQsIGNoZWNrU3RpbGxDdXJyZW50LFxuICAgICAgICAgIGVycm9yUmVwb3J0aW5nVXJsKTtcbiAgICB9O1xuXG4gICAgY29uc3Qgd2hpdGVsaXN0ID0ge307XG4gICAgT2JqZWN0LmtleXMobWFjcm9zKS5mb3JFYWNoKGtleSA9PiB3aGl0ZWxpc3Rba2V5XSA9IHRydWUpO1xuICAgIGNvbnN0IHVybFJlcGxhY2VtZW50U3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICB0aGlzLnByb21pc2VBcnJheV8ucHVzaChTZXJ2aWNlcy50aW1lckZvcih0aGlzLndpbl8pLnRpbWVvdXRQcm9taXNlKFxuICAgICAgICB0aW1lb3V0TWlsbGlzLFxuICAgICAgICBTZXJ2aWNlcy51cmxSZXBsYWNlbWVudHNGb3JEb2ModGhpcy5hbXBEb2NfKS5leHBhbmRVcmxBc3luYyhcbiAgICAgICAgICAgIHVybCwgbWFjcm9zLCB3aGl0ZWxpc3QpKS50aGVuKHVybCA9PiB7XG4gICAgICBjaGVja1N0aWxsQ3VycmVudCgpO1xuICAgICAgdGltZW91dE1pbGxpcyAtPSAodXJsUmVwbGFjZW1lbnRTdGFydFRpbWUgLSBEYXRlLm5vdygpKTtcbiAgICAgIHJldHVybiBzZW5kKHVybCk7XG4gICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgcmV0dXJuIGlzQ2FuY2VsbGF0aW9uKGVycm9yKSA/IHVuZGVmaW5lZCA6XG4gICAgICAgIHRoaXMuYnVpbGRFcnJvclJlc3BvbnNlXyhSVENfRVJST1JfRU5VTS5NQUNST19FWFBBTkRfVElNRU9VVCxcbiAgICAgICAgICAgIGNhbGxvdXQsIGVycm9yUmVwb3J0aW5nVXJsKTtcbiAgICB9KSk7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICovXG4gIHRydW5jVXJsXyh1cmwpIHtcbiAgICB1cmwgPSB1cmwuc3Vic3RyKDAsIE1BWF9VUkxfTEVOR1RIIC0gMTIpLnJlcGxhY2UoLyVcXHc/JC8sICcnKTtcbiAgICByZXR1cm4gdXJsICsgJyZfX3RydW5jX189MSc7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICAgKiBAcGFyYW0ge251bWJlcn0gdGltZW91dE1pbGxpc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gY2FsbG91dFxuICAgKiBAcGFyYW0geyFGdW5jdGlvbn0gY2hlY2tTdGlsbEN1cnJlbnRcbiAgICogQHBhcmFtIHtzdHJpbmd9IGVycm9yUmVwb3J0aW5nVXJsXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCFydGNSZXNwb25zZURlZj59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzZW5kUnRjQ2FsbG91dF8odXJsLCB0aW1lb3V0TWlsbGlzLCBjYWxsb3V0LCBjaGVja1N0aWxsQ3VycmVudCxcbiAgICBlcnJvclJlcG9ydGluZ1VybCkge1xuICAgIC8qKlxuICAgICAqIE5vdGU6IFRpbWVvdXQgaXMgZW5mb3JjZWQgYnkgdGltZXJGb3IsIG5vdCB0aGUgdmFsdWUgb2ZcbiAgICAgKiAgIHJ0Y1RpbWUuIFRoZXJlIGFyZSBzaXR1YXRpb25zIHdoZXJlIHJ0Y1RpbWUgY291bGQgdGh1c1xuICAgICAqICAgZW5kIHVwIGJlaW5nIGdyZWF0ZXIgdGhhbiB0aW1lb3V0TWlsbGlzLlxuICAgICAqL1xuICAgIHJldHVybiBTZXJ2aWNlcy50aW1lckZvcih0aGlzLndpbl8pLnRpbWVvdXRQcm9taXNlKFxuICAgICAgICB0aW1lb3V0TWlsbGlzLFxuICAgICAgICBTZXJ2aWNlcy54aHJGb3IodGhpcy53aW5fKS5mZXRjaEpzb24oXG4gICAgICAgICAgICAvLyBOT1RFKGJyYWRmcml6emVsbCk6IHdlIGNvdWxkIGluY2x1ZGUgYW1wQ29yczpmYWxzZSBhbGxvd2luZ1xuICAgICAgICAgICAgLy8gdGhlIHJlcXVlc3QgdG8gYmUgY2FjaGVkIGFjcm9zcyBzaXRlcyBidXQgZm9yIG5vdyBhc3N1bWUgdGhhdFxuICAgICAgICAgICAgLy8gaXMgbm90IGEgcmVxdWlyZWQgZmVhdHVyZS5cbiAgICAgICAgICAgIHVybCwge2NyZWRlbnRpYWxzOiAnaW5jbHVkZSd9KS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgY2hlY2tTdGlsbEN1cnJlbnQoKTtcbiAgICAgICAgICByZXR1cm4gcmVzLnRleHQoKS50aGVuKHRleHQgPT4ge1xuICAgICAgICAgICAgY2hlY2tTdGlsbEN1cnJlbnQoKTtcbiAgICAgICAgICAgIGNvbnN0IHJ0Y1RpbWUgPSBEYXRlLm5vdygpIC0gdGhpcy5ydGNTdGFydFRpbWVfO1xuICAgICAgICAgICAgLy8gQW4gZW1wdHkgdGV4dCByZXNwb25zZSBpcyBhbGxvd2VkLCBub3QgYW4gZXJyb3IuXG4gICAgICAgICAgICBpZiAoIXRleHQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHtydGNUaW1lLCBjYWxsb3V0fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gdHJ5UGFyc2VKc29uKHRleHQpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlID8ge3Jlc3BvbnNlLCBydGNUaW1lLCBjYWxsb3V0fSA6XG4gICAgICAgICAgICAgIHRoaXMuYnVpbGRFcnJvclJlc3BvbnNlXyhcbiAgICAgICAgICAgICAgICAgIFJUQ19FUlJPUl9FTlVNLk1BTEZPUk1FRF9KU09OX1JFU1BPTlNFLCBjYWxsb3V0LFxuICAgICAgICAgICAgICAgICAgZXJyb3JSZXBvcnRpbmdVcmwsIHJ0Y1RpbWUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KSkuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgcmV0dXJuIGlzQ2FuY2VsbGF0aW9uKGVycm9yKSA/IHVuZGVmaW5lZCA6XG4gICAgICAgIHRoaXMuYnVpbGRFcnJvclJlc3BvbnNlXyhcbiAgICAgICAgICAgIC8vIFRoZSByZWxldmFudCBlcnJvciBtZXNzYWdlIGZvciB0aW1lb3V0IGxvb2tzIGxpa2UgaXQgaXNcbiAgICAgICAgICAgIC8vIGp1c3QgJ21lc3NhZ2UnIGJ1dCBpcyBpbiBmYWN0ICdtZXNzYWdlWFhYJyB3aGVyZSB0aGVcbiAgICAgICAgICAgIC8vIFgncyBhcmUgaGlkZGVuIHNwZWNpYWwgY2hhcmFjdGVycy4gVGhhdCdzIHdoeSB3ZSB1c2VcbiAgICAgICAgICAgIC8vIG1hdGNoIGhlcmUuXG4gICAgICAgICAgICAoL150aW1lb3V0Ly50ZXN0KGVycm9yLm1lc3NhZ2UpKSA/XG4gICAgICAgICAgICAgIFJUQ19FUlJPUl9FTlVNLlRJTUVPVVQgOiBSVENfRVJST1JfRU5VTS5ORVRXT1JLX0ZBSUxVUkUsXG4gICAgICAgICAgICBjYWxsb3V0LCBlcnJvclJlcG9ydGluZ1VybCwgRGF0ZS5ub3coKSAtIHRoaXMucnRjU3RhcnRUaW1lXyk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQXR0ZW1wdHMgdG8gcGFyc2UgdGhlIHB1Ymxpc2hlci1kZWZpbmVkIFJUQyBjb25maWcgb2ZmIHRoZSBhbXAtYWRcbiAgICogZWxlbWVudCwgdGhlbiB2YWxpZGF0ZXMgdGhhdCB0aGUgcnRjQ29uZmlnIGV4aXN0cywgYW5kIGNvbnRhaW5zXG4gICAqIGFuIGVudHJ5IGZvciBlaXRoZXIgdmVuZG9yIFVSTHMsIG9yIHB1Ymxpc2hlci1kZWZpbmVkIFVSTHMuIElmIHRoZVxuICAgKiBjb25maWcgY29udGFpbnMgYW4gZW50cnkgZm9yIHRpbWVvdXRNaWxsaXMsIHZhbGlkYXRlcyB0aGF0IGl0IGlzIGFcbiAgICogbnVtYmVyLCBvciBjb252ZXJ0cyB0byBhIG51bWJlciBpZiBudW1iZXItbGlrZSwgb3RoZXJ3aXNlIG92ZXJ3cml0ZXNcbiAgICogd2l0aCB0aGUgZGVmYXVsdC5cbiAgICogSU1QT1JUQU5UOiBJZiB0aGUgcnRjQ29uZmlnIGlzIGludmFsaWQsIFJUQyBpcyBhYm9ydGVkLCBhbmQgdGhlIGFkXG4gICAqICAgcmVxdWVzdCBjb250aW51ZXMgd2l0aG91dCBSVEMuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIHZhbGlkYXRlUnRjQ29uZmlnXyhlbGVtZW50KSB7XG4gICAgY29uc3QgZGVmYXVsdFRpbWVvdXRNaWxsaXMgPSAxMDAwO1xuICAgIGNvbnN0IHVucGFyc2VkUnRjQ29uZmlnID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3J0Yy1jb25maWcnKTtcbiAgICBpZiAoIXVucGFyc2VkUnRjQ29uZmlnKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IHJ0Y0NvbmZpZyA9IHRyeVBhcnNlSnNvbih1bnBhcnNlZFJ0Y0NvbmZpZyk7XG4gICAgaWYgKCFydGNDb25maWcpIHtcbiAgICAgIHVzZXIoKS53YXJuKFRBRywgJ0NvdWxkIG5vdCBKU09OIHBhcnNlIHJ0Yy1jb25maWcgYXR0cmlidXRlJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHRpbWVvdXQ7XG4gICAgdHJ5IHtcbiAgICAgIHVzZXIoKS5hc3NlcnQocnRjQ29uZmlnWyd2ZW5kb3JzJ10gfHwgcnRjQ29uZmlnWyd1cmxzJ10sXG4gICAgICAgICAgJ1JUQyBDb25maWcgbXVzdCBzcGVjaWZ5IHZlbmRvcnMgb3IgdXJscycpO1xuICAgICAgT2JqZWN0LmtleXMocnRjQ29uZmlnKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgICAgY2FzZSAndmVuZG9ycyc6XG4gICAgICAgICAgICB1c2VyKCkuYXNzZXJ0KGlzT2JqZWN0KHJ0Y0NvbmZpZ1trZXldKSwgJ1JUQyBpbnZhbGlkIHZlbmRvcnMnKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ3VybHMnOlxuICAgICAgICAgICAgdXNlcigpLmFzc2VydChpc0FycmF5KHJ0Y0NvbmZpZ1trZXldKSwgJ1JUQyBpbnZhbGlkIHVybHMnKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ3RpbWVvdXRNaWxsaXMnOlxuICAgICAgICAgICAgdGltZW91dCA9IHBhcnNlSW50KHJ0Y0NvbmZpZ1trZXldLCAxMCk7XG4gICAgICAgICAgICBpZiAoaXNOYU4odGltZW91dCkpIHtcbiAgICAgICAgICAgICAgdXNlcigpLndhcm4oVEFHLCAnSW52YWxpZCBSVEMgdGltZW91dCBpcyBOYU4sICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICBgdXNpbmcgZGVmYXVsdCB0aW1lb3V0ICR7ZGVmYXVsdFRpbWVvdXRNaWxsaXN9bXNgKTtcbiAgICAgICAgICAgICAgdGltZW91dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGltZW91dCA+PSBkZWZhdWx0VGltZW91dE1pbGxpcyB8fCB0aW1lb3V0IDwgMCkge1xuICAgICAgICAgICAgICB1c2VyKCkud2FybihUQUcsIGBJbnZhbGlkIFJUQyB0aW1lb3V0OiAke3RpbWVvdXR9bXMsIGAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICBgdXNpbmcgZGVmYXVsdCB0aW1lb3V0ICR7ZGVmYXVsdFRpbWVvdXRNaWxsaXN9bXNgKTtcbiAgICAgICAgICAgICAgdGltZW91dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB1c2VyKCkud2FybihUQUcsIGBVbmtub3duIFJUQyBDb25maWcga2V5OiAke2tleX1gKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmICghT2JqZWN0LmtleXMocnRjQ29uZmlnWyd2ZW5kb3JzJ10gfHwge30pLmxlbmd0aFxuICAgICAgICAgICYmICEocnRjQ29uZmlnWyd1cmxzJ10gfHwgW10pLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBjb25zdCB2YWxpZGF0ZUVycm9yUmVwb3J0aW5nVXJsID0gdXJsT2JqID0+IHtcbiAgICAgICAgY29uc3QgZXJyb3JVcmwgPSB1cmxPYmpbJ2Vycm9yUmVwb3J0aW5nVXJsJ107XG4gICAgICAgIGlmIChlcnJvclVybCAmJiAhU2VydmljZXMudXJsRm9yRG9jKFxuICAgICAgICAgICAgdGhpcy5hNGFFbGVtZW50Xy5nZXRBbXBEb2MoKSkuaXNTZWN1cmUoZXJyb3JVcmwpKSB7XG4gICAgICAgICAgZGV2KCkud2FybihUQUcsIGBJbnNlY3VyZSBSVEMgZXJyb3JSZXBvcnRpbmdVcmw6ICR7ZXJyb3JVcmx9YCk7XG4gICAgICAgICAgdXJsT2JqWydlcnJvclJlcG9ydGluZ1VybCddID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgKHJ0Y0NvbmZpZ1sndXJscyddIHx8IFtdKS5mb3JFYWNoKHVybE9iaiA9PiB7XG4gICAgICAgIGlmIChpc09iamVjdCh1cmxPYmopKSB7XG4gICAgICAgICAgdmFsaWRhdGVFcnJvclJlcG9ydGluZ1VybCh1cmxPYmopO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHZhbGlkYXRlRXJyb3JSZXBvcnRpbmdVcmwocnRjQ29uZmlnKTtcbiAgICB9IGNhdGNoICh1bnVzZWRFcnIpIHtcbiAgICAgIC8vIFRoaXMgZXJyb3Igd291bGQgYmUgZHVlIHRvIHRoZSBhc3NlcnRzIGFib3ZlLlxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBydGNDb25maWdbJ3RpbWVvdXRNaWxsaXMnXSA9IHRpbWVvdXQgIT09IHVuZGVmaW5lZCA/XG4gICAgICB0aW1lb3V0IDogZGVmYXVsdFRpbWVvdXRNaWxsaXM7XG4gICAgdGhpcy5ydGNDb25maWdfID0gLyoqIEB0eXBlIHtSdGNDb25maWdEZWZ9ICovKHJ0Y0NvbmZpZyk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn1cbkFNUC5SZWFsVGltZUNvbmZpZ01hbmFnZXIgPSBSZWFsVGltZUNvbmZpZ01hbmFnZXI7XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtJbnRlcnNlY3Rpb25PYnNlcnZlclBvbHlmaWxsfSBmcm9tICcuLi8uLi8uLi9zcmMvaW50ZXJzZWN0aW9uLW9ic2VydmVyLXBvbHlmaWxsJztcbmltcG9ydCB7ZGV2fSBmcm9tICcuLi8uLi8uLi9zcmMvbG9nJztcblxuZXhwb3J0IGNsYXNzIFJlZnJlc2hJbnRlcnNlY3Rpb25PYnNlcnZlcldyYXBwZXIge1xuICAvKipcbiAgICogQSB0aGluIHdyYXBwZXIgY2xhc3MgdG8gYWxsb3cgdGhlIEludGVyc2VjdGlvbk9ic2VydmVyUG9seWZpbGwgdG8gd29yayB3aXRoXG4gICAqIHJlZnJlc2guXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oIUFycmF5PCFJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5Pil9IGNhbGxiYWNrXG4gICAqIEBwYXJhbSB7IUFNUC5CYXNlRWxlbWVudH0gYmFzZUVsZW1lbnRcbiAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgKi9cbiAgY29uc3RydWN0b3IoY2FsbGJhY2ssIGJhc2VFbGVtZW50LCBjb25maWcpIHtcblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlIEBjb25zdCB7IUludGVyc2VjdGlvbk9ic2VydmVyUG9seWZpbGx9XG4gICAgICovXG4gICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlcl8gPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJQb2x5ZmlsbChcbiAgICAgICAgY2FsbGJhY2ssIGNvbmZpZyk7XG5cbiAgICAvKipcbiAgICAgKiBTdG9yZXMgZWxlbWVudHMgYW5kIHRoZWlyIG9yaWdpbmFsIHZpZXdwb3J0Q2FsbGJhY2sgZnVuY3Rpb25zIHNvIHRoYXRcbiAgICAgKiB0aGV5IGNhbiBiZSByZXZlcnRlZCB1cG9uIGludm9jYXRpb24gb2YgdW5vYnNlcnZlLlxuICAgICAqIEBwcml2YXRlIHshT2JqZWN0PHN0cmluZywgZnVuY3Rpb24oKT59XG4gICAgICovXG4gICAgdGhpcy52aWV3cG9ydENhbGxiYWNrc18gPSB7fTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyEuLi8uLi8uLi9zcmMvc2VydmljZS92aWV3cG9ydC92aWV3cG9ydC1pbXBsLlZpZXdwb3J0fSAqL1xuICAgIHRoaXMudmlld3BvcnRfID0gYmFzZUVsZW1lbnQuZ2V0Vmlld3BvcnQoKTtcblxuICAgIC8qKlxuICAgICAqIEZsYWcgdGhhdCBpbmRpY2F0ZXMgd2hlbiAjdGljayBzaG91bGQgYmUgY2FsbGVkIG9uIHRoZSBvYnNlcnZlclxuICAgICAqIHBvbHlmaWxsLlxuICAgICAqIEBwcml2YXRlIHtib29sZWFufVxuICAgICAqL1xuICAgIHRoaXMudXBkYXRlT2JzZXJ2ZXJfID0gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogQmVnaW4gb2JzZXJ2aW5nIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gICAqL1xuICBvYnNlcnZlKGVsZW1lbnQpIHtcbiAgICAvLyBUaGUgYXR0cmlidXRlIG5hbWUgaXMgZXhwb3J0ZWQgaW4gcmVmcmVzaC1tYW5hZ2VyLmpzIGFzXG4gICAgLy8gREFUQV9NQU5BR0VSX0lEX05BTUUsIGJ1dCB1bmZvcnR1bmF0ZWx5LCBpdCBjYW4ndCBiZSBpbXBvcnRlZCB3aXRob3V0XG4gICAgLy8gY3JlYXRpbmcgYSBjeWNsaWNhbCBkZXBlbmRlbmN5LlxuICAgIGNvbnN0IHJlZnJlc2hJZCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWFtcC1hZC1yZWZyZXNoLWlkJyk7XG4gICAgZGV2KCkuYXNzZXJ0KHJlZnJlc2hJZCwgJ29ic2VydmUgaW52b2tlZCBvbiBlbGVtZW50IHdpdGhvdXQgcmVmcmVzaCBpZCcpO1xuXG4gICAgaWYgKCF0aGlzLnZpZXdwb3J0Q2FsbGJhY2tzX1tyZWZyZXNoSWRdKSB7XG4gICAgICBjb25zdCB2aWV3cG9ydENhbGxiYWNrID0gZWxlbWVudC52aWV3cG9ydENhbGxiYWNrLmJpbmQoZWxlbWVudCk7XG4gICAgICB0aGlzLnZpZXdwb3J0Q2FsbGJhY2tzX1tyZWZyZXNoSWRdID0gdmlld3BvcnRDYWxsYmFjaztcbiAgICAgIGVsZW1lbnQudmlld3BvcnRDYWxsYmFjayA9IGluVmlld3BvcnQgPT4ge1xuICAgICAgICBpZiAodGhpcy51cGRhdGVPYnNlcnZlcl8pIHtcbiAgICAgICAgICB0aGlzLmludGVyc2VjdGlvbk9ic2VydmVyXy50aWNrKHRoaXMudmlld3BvcnRfLmdldFJlY3QoKSk7XG4gICAgICAgIH1cbiAgICAgICAgdmlld3BvcnRDYWxsYmFjayhpblZpZXdwb3J0KTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVPYnNlcnZlcl8gPSB0cnVlO1xuICAgIHRoaXMuaW50ZXJzZWN0aW9uT2JzZXJ2ZXJfLm9ic2VydmUoZWxlbWVudCk7XG4gICAgLy8gRWxlbWVudHMgdGhhdCBhcHBlYXIgYW5kIHJlbWFpbiB3aXRoaW4gdGhlIHZpZXdwb3J0IGZvciB0aGUgZHVyYXRpb24gb2ZcbiAgICAvLyB0aGVpciBleGlzdGVuY2UgbWF5IG5ldmVyIGhhdmUgdmlld3BvcnRDYWxsYmFjayBpbnZva2VkLiBUbyBlbnN1cmUgdGhhdFxuICAgIC8vIHJlZnJlc2ggaXMgdHJpZ2dlcmVkLCB3ZSBuZWVkIHRvIG1ha2UgdGhpcyBpbml0aWFsIGNhbGwuXG4gICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlcl8udGljayh0aGlzLnZpZXdwb3J0Xy5nZXRSZWN0KCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENlYXNlIG9ic2VydmluZyB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICAgKi9cbiAgdW5vYnNlcnZlKGVsZW1lbnQpIHtcbiAgICAvLyBXZSBuZWVkIHRvIGNhbGwgJ3RpY2snIHRvIHVwZGF0ZSBjdXJyZW50IGhvc3Qgdmlld3BvcnQgc3RhdGUsIG90aGVyd2lzZVxuICAgIC8vIHRoZSBuZXh0IHRpbWUgd2UgY2FsbCAnb2JzZXJ2ZScsIHRoZSB2aWV3cG9ydCBzdGF0ZSBtaWdodCBiZSBzdGFsZSwgYW5kXG4gICAgLy8gaW5kaWNhdGUgdGhhdCB0aGUgZWxlbWVudCBpcyBpbiB0aGUgdmlld3BvcnQgd2hlbiBpdCdzIG5vdC5cbiAgICB0aGlzLmludGVyc2VjdGlvbk9ic2VydmVyXy50aWNrKHRoaXMudmlld3BvcnRfLmdldFJlY3QoKSk7XG4gICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlcl8udW5vYnNlcnZlKGVsZW1lbnQpO1xuICAgIHRoaXMudXBkYXRlT2JzZXJ2ZXJfID0gZmFsc2U7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1JlZnJlc2hJbnRlcnNlY3Rpb25PYnNlcnZlcldyYXBwZXJ9IGZyb20gJy4vcmVmcmVzaC1pbnRlcnNlY3Rpb24tb2JzZXJ2ZXItd3JhcHBlcic7XG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZXMnO1xuaW1wb3J0IHtkZXYsIHVzZXJ9IGZyb20gJy4uLy4uLy4uL3NyYy9sb2cnO1xuXG4vKipcbiAqIC0gdmlzaWJpbGVQZXJjZW50YWdlTWluOiBUaGUgcGVyY2VudGFnZSBvZiBwaXhlbHMgdGhhdCBuZWVkIHRvIGJlIG9uIHNjcmVlblxuICogICBmb3IgdGhlIGNyZWF0aXZlIHRvIGJlIGNvbnNpZGVyZWQgXCJ2aXNpYmxlXCIuXG4gKiAtIGNvbnRpbnVvdXNUaW1lTWluOiBUaGUgYW1vdW50IG9mIGNvbnRpbnVvdXMgdGltZSwgaW4gbWlsbGlzZWNvbmRzLCB0aGF0XG4gKiAgIHRoZSBjcmVhdGl2ZSBtdXN0IGJlIG9uIHNjcmVlbiBmb3IgaW4gb3JkZXIgdG8gYmUgY29uc2lkZXJlZCBcInZpc2libGVcIi5cbiAqXG4gKiBAdHlwZWRlZiB7e1xuICogICB2aXNpYmxlUGVyY2VudGFnZU1pbjogbnVtYmVyLFxuICogICBjb250aW51b3VzVGltZU1pbjogbnVtYmVyLFxuICogfX1cbiAqL1xuZXhwb3J0IGxldCBSZWZyZXNoQ29uZmlnO1xuXG5leHBvcnQgY29uc3QgTUlOX1JFRlJFU0hfSU5URVJWQUwgPSAzMDtcbmV4cG9ydCBjb25zdCBEQVRBX0FUVFJfTkFNRSA9ICdkYXRhLWVuYWJsZS1yZWZyZXNoJztcbmV4cG9ydCBjb25zdCBEQVRBX01BTkFHRVJfSURfTkFNRSA9ICdkYXRhLWFtcC1hZC1yZWZyZXNoLWlkJztcbmV4cG9ydCBjb25zdCBNRVRBVEFHX05BTUUgPSAnYW1wLWFkLWVuYWJsZS1yZWZyZXNoJztcblxuY29uc3QgVEFHID0gJ0FNUC1BRCc7XG5cbi8qKlxuICogUmV0cmlldmVzIHRoZSBwdWJsaXNoZXItc3BlY2lmaWVkIHJlZnJlc2ggaW50ZXJ2YWwsIGlmIG9uZSB3ZXJlIHNldC4gVGhpc1xuICogZnVuY3Rpb24gZmlyc3QgY2hlY2tzIGZvciBhcHByb3ByaWF0ZSBzbG90IGF0dHJpYnV0ZXMgYW5kIHRoZW4gZm9yXG4gKiBtZXRhZGF0YSB0YWdzLCBwcmVmZXJyaW5nIHdoaWNoZXZlciBpdCBmaW5kcyBmaXJzdC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHs/bnVtYmVyfVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQdWJsaXNoZXJTcGVjaWZpZWRSZWZyZXNoSW50ZXJ2YWwoZWxlbWVudCwgd2luKSB7XG4gIGNvbnN0IHJlZnJlc2hJbnRlcnZhbCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKERBVEFfQVRUUl9OQU1FKTtcbiAgaWYgKHJlZnJlc2hJbnRlcnZhbCkge1xuICAgIHJldHVybiBjaGVja0FuZFNhbml0aXplUmVmcmVzaEludGVydmFsKHJlZnJlc2hJbnRlcnZhbCk7XG4gIH1cbiAgbGV0IG1ldGFUYWc7XG4gIGNvbnN0IG1ldGFUYWdDb250ZW50ID0gKChtZXRhVGFnID0gd2luLmRvY3VtZW50XG4gICAgICAuZ2V0RWxlbWVudHNCeU5hbWUoTUVUQVRBR19OQU1FKSlcbiAgICAgICYmIG1ldGFUYWdbMF1cbiAgICAgICYmIG1ldGFUYWdbMF0uZ2V0QXR0cmlidXRlKCdjb250ZW50JykpO1xuICBpZiAoIW1ldGFUYWdDb250ZW50KSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgbmV0d29ya0ludGVydmFsUGFpcnMgPSBtZXRhVGFnQ29udGVudC5zcGxpdCgnLCcpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IG5ldHdvcmtJbnRlcnZhbFBhaXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgcGFpciA9IG5ldHdvcmtJbnRlcnZhbFBhaXJzW2ldLnNwbGl0KCc9Jyk7XG4gICAgdXNlcigpLmFzc2VydChwYWlyLmxlbmd0aCA9PSAyLCAncmVmcmVzaCBtZXRhZGF0YSBjb25maWcgbXVzdCBiZSBvZiAnICtcbiAgICAgICAgJ3RoZSBmb3JtIGBuZXR3b3JrX3R5cGU9cmVmcmVzaF9pbnRlcnZhbGAnKTtcbiAgICBpZiAocGFpclswXS50b0xvd2VyQ2FzZSgpID09IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykudG9Mb3dlckNhc2UoKSkge1xuICAgICAgcmV0dXJuIGNoZWNrQW5kU2FuaXRpemVSZWZyZXNoSW50ZXJ2YWwocGFpclsxXSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIEVuc3VyZXMgdGhhdCByZWZyZXNoSW50ZXJ2YWwgaXMgYSBudW1iZXIgbm8gbGVzcyB0aGFuIDMwLiBSZXR1cm5zIG51bGwgaWZcbiAqIHRoZSBnaXZlbiBpbnB1dCBmYWlscyB0byBtZWV0IHRoZXNlIGNyaXRlcmlhLiBUaGlzIGFsc28gY29udmVydHMgZnJvbVxuICogc2Vjb25kcyB0byBtaWxsaXNlY29uZHMuXG4gKlxuICogQHBhcmFtIHsobnVtYmVyfHN0cmluZyl9IHJlZnJlc2hJbnRlcnZhbFxuICogQHJldHVybiB7P251bWJlcn1cbiAqL1xuZnVuY3Rpb24gY2hlY2tBbmRTYW5pdGl6ZVJlZnJlc2hJbnRlcnZhbChyZWZyZXNoSW50ZXJ2YWwpIHtcbiAgY29uc3QgcmVmcmVzaEludGVydmFsTnVtID0gTnVtYmVyKHJlZnJlc2hJbnRlcnZhbCk7XG4gIGlmIChpc05hTihyZWZyZXNoSW50ZXJ2YWxOdW0pIHx8XG4gICAgICByZWZyZXNoSW50ZXJ2YWxOdW0gPCBNSU5fUkVGUkVTSF9JTlRFUlZBTCkge1xuICAgIHVzZXIoKS53YXJuKFRBRyxcbiAgICAgICAgJ2ludmFsaWQgcmVmcmVzaCBpbnRlcnZhbCwgbXVzdCBiZSBhIG51bWJlciBubyBsZXNzIHRoYW4gJyArXG4gICAgICAgIGAke01JTl9SRUZSRVNIX0lOVEVSVkFMfTogJHtyZWZyZXNoSW50ZXJ2YWx9YCk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgcmV0dXJuIHJlZnJlc2hJbnRlcnZhbE51bSAqIDEwMDA7XG59XG5cbi8qKlxuICogRGVmaW5lcyB0aGUgREZBIHN0YXRlcyBmb3IgdGhlIHJlZnJlc2ggY3ljbGUuXG4gKlxuICogMS4gQWxsIG5ld2x5IHJlZ2lzdGVyZWQgZWxlbWVudHMgYmVnaW4gaW4gdGhlIElOSVRJQUwgc3RhdGUuXG4gKiAyLiBPbmx5IHdoZW4gdGhlIGVsZW1lbnQgZW50ZXJzIHRoZSB2aWV3cG9ydCB3aXRoIHRoZSBzcGVjaWZpZWRcbiAqICAgIGludGVyc2VjdGlvbiByYXRpbyBkb2VzIGl0IHRyYW5zaXRpb24gaW50byB0aGUgVklFV19QRU5ESU5HIHN0YXRlLlxuICogMy4gSWYgdGhlIGVsZW1lbnQgcmVtYWlucyBpbiB0aGUgdmlld3BvcnQgZm9yIHRoZSBzcGVjaWZpZWQgZHVyYXRpb24sIGl0XG4gKiAgICB3aWxsIHRoZW4gdHJhbnNpdGlvbiBpbnRvIHRoZSBSRUZSRVNIX1BFTkRJTkcgc3RhdGUsIG90aGVyd2lzZSBpdCB3aWxsXG4gKiAgICB0cmFuc2l0aW9uIGJhY2sgaW50byB0aGUgSU5JVElBTCBzdGF0ZS5cbiAqIDQuIFRoZSBlbGVtZW50IHdpbGwgcmVtYWluIGluIFJFRlJFU0hfUEVORElORyBzdGF0ZSB1bnRpbCB0aGUgcmVmcmVzaFxuICogICAgaW50ZXJ2YWwgZXhwaXJlcy5cbiAqIDUuIE9uY2UgdGhlIGludGVydmFsIGV4cGlyZXMsIHRoZSBlbGVtZW50IHdpbGwgcmV0dXJuIHRvIHRoZSBJTklUSUFMIHN0YXRlLlxuICpcbiAqIEBlbnVtIHtzdHJpbmd9XG4gKi9cbmNvbnN0IFJlZnJlc2hMaWZlY3ljbGVTdGF0ZSA9IHtcbiAgLyoqXG4gICAqIEVsZW1lbnQgaGFzIGJlZW4gcmVnaXN0ZXJlZCwgYnV0IG5vdCB5ZXQgc2VlbiBvbiBzY3JlZW4uXG4gICAqL1xuICBJTklUSUFMOiAnaW5pdGlhbCcsXG5cbiAgLyoqXG4gICAqIFRoZSBlbGVtZW50IGhhcyBhcHBlYXJlZCBpbiB0aGUgdmlld3BvcnQsIGJ1dCBub3QgeWV0IGZvciB0aGUgcmVxdWlyZWRcbiAgICogZHVyYXRpb24uXG4gICAqL1xuICBWSUVXX1BFTkRJTkc6ICd2aWV3X3BlbmRpbmcnLFxuXG4gIC8qKlxuICAgKiBUaGUgZWxlbWVudCBoYXMgYmVlbiBpbiB0aGUgdmlld3BvcnQgZm9yIHRoZSByZXF1aXJlZCBkdXJhdGlvbjsgdGhlXG4gICAqIHJlZnJlc2ggaW50ZXJ2YWwgZm9yIHRoZSBlbGVtZW50IGhhcyBiZWd1bi5cbiAgICovXG4gIFJFRlJFU0hfUEVORElORzogJ3JlZnJlc2hfcGVuZGluZycsXG59O1xuXG4vKipcbiAqIEFuIG9iamVjdCBjb250YWluaW5nIHRoZSBJbnRlcnNlY3Rpb25PYnNlcnZlcnMgdXNlZCB0byBtb25pdG9yIGVsZW1lbnRzLlxuICogRWFjaCBJTyBpcyBjb25maWd1cmVkIHRvIGEgZGlmZmVyZW50IHRocmVzaG9sZCwgYW5kIGFsbCBlbGVtZW50cyB0aGF0XG4gKiBzaGFyZSB0aGUgc2FtZSB2aXNpYmxlUGVyY2VudGFnZU1pbiB3aWxsIGJlIG1vbml0b3JlZCBieSB0aGUgc2FtZSBJTy5cbiAqXG4gKiBAY29uc3QgeyFPYmplY3Q8c3RyaW5nLCAoIUludGVyc2VjdGlvbk9ic2VydmVyfCFSZWZyZXNoSW50ZXJzZWN0aW9uT2JzZXJ2ZXJXcmFwcGVyKT59XG4gKi9cbmNvbnN0IG9ic2VydmVycyA9IHt9O1xuXG4vKipcbiAqIEFuIG9iamVjdCBjb250YWluaW5nIGFsbCBjdXJyZW50bHkgYWN0aXZlIFJlZnJlc2hNYW5hZ2Vycy4gVGhpcyBpcyB1c2VkIGluXG4gKiB0aGUgSW50ZXJzZWN0aW9uT2JlcnNlcnZlciBjYWxsYmFjayBmdW5jdGlvbiB0byBmaW5kIHRoZSBhcHByb3ByaWF0ZSBlbGVtZW50XG4gKiB0YXJnZXQuXG4gKlxuICogQGNvbnN0IHshT2JqZWN0PHN0cmluZywgIVJlZnJlc2hNYW5hZ2VyPn1cbiAqL1xuY29uc3QgbWFuYWdlcnMgPSB7fTtcblxuLyoqXG4gKiBVc2VkIHRvIGdlbmVyYXRlIHVuaXF1ZSBJRHMgZm9yIGVhY2ggUmVmcmVzaE1hbmFnZXIuXG4gKiBAdHlwZSB7bnVtYmVyfVxuICovXG5sZXQgcmVmcmVzaE1hbmFnZXJJZENvdW50ZXIgPSAwO1xuXG4vKipcbiAqIFJldHVybnMgYW4gaW5zdGFuY2Ugb2YgUmVmcmVzaE1hbmFnZXIsIGlmIHJlZnJlc2ggaXMgZW5hYmxlZCBvbiB0aGUgcGFnZSBvclxuICogc2xvdC4gQW4gb3B0aW9uYWwgcHJlZGljYXRlIGZvciBlbGlnaWJpbGl0eSBtYXkgYmUgcGFzc2VkLiBJZiByZWZyZXNoIGlzIG5vdFxuICogZW5hYmxlZCwgb3IgZmFpbHMgdGhlIG9wdGlvbmFsIHByZWRpY2F0ZSwgbnVsbCB3aWxsIGJlIHJldHVybmVkLlxuICpcbiAqIEBwYXJhbSB7IS4vYW1wLWE0YS5BbXBBNEF9IGE0YVxuICogQHBhcmFtIHtmdW5jdGlvbigpOmJvb2xlYW49fSBvcHRfcHJlZGljYXRlXG4gKiBAcmV0dXJuIHs/UmVmcmVzaE1hbmFnZXJ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWZyZXNoTWFuYWdlcihhNGEsIG9wdF9wcmVkaWNhdGUpIHtcbiAgY29uc3QgcmVmcmVzaEludGVydmFsID1cbiAgICAgIGdldFB1Ymxpc2hlclNwZWNpZmllZFJlZnJlc2hJbnRlcnZhbChhNGEuZWxlbWVudCwgYTRhLndpbik7XG4gIGlmICghcmVmcmVzaEludGVydmFsIHx8IChvcHRfcHJlZGljYXRlICYmICFvcHRfcHJlZGljYXRlKCkpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgcmV0dXJuIG5ldyBSZWZyZXNoTWFuYWdlcihhNGEsIHtcbiAgICB2aXNpYmxlUGVyY2VudGFnZU1pbjogNTAsXG4gICAgY29udGludW91c1RpbWVNaW46IDEsXG4gIH0sIHJlZnJlc2hJbnRlcnZhbCk7XG59XG5cblxuZXhwb3J0IGNsYXNzIFJlZnJlc2hNYW5hZ2VyIHtcblxuICAvKipcbiAgICogQHBhcmFtIHshLi9hbXAtYTRhLkFtcEE0QX0gYTRhIFRoZSBBbXBBNEEgaW5zdGFuY2UgdG8gYmUgcmVmcmVzaGVkLlxuICAgKiBAcGFyYW0geyFSZWZyZXNoQ29uZmlnfSBjb25maWdcbiAgICogQHBhcmFtIHtudW1iZXJ9IHJlZnJlc2hJbnRlcnZhbFxuICAgKi9cbiAgY29uc3RydWN0b3IoYTRhLCBjb25maWcsIHJlZnJlc2hJbnRlcnZhbCkge1xuXG4gICAgLyoqIEBwcml2YXRlIHtzdHJpbmd9ICovXG4gICAgdGhpcy5zdGF0ZV8gPSBSZWZyZXNoTGlmZWN5Y2xlU3RhdGUuSU5JVElBTDtcblxuICAgIC8qKiBAY29uc3QgQHByaXZhdGUgeyEuL2FtcC1hNGEuQW1wQTRBfSAqL1xuICAgIHRoaXMuYTRhXyA9IGE0YTtcblxuICAgIC8qKiBAY29uc3QgQHByaXZhdGUgeyFXaW5kb3d9ICovXG4gICAgdGhpcy53aW5fID0gYTRhLndpbjtcblxuICAgIC8qKiBAY29uc3QgQHByaXZhdGUgeyFFbGVtZW50fSAqL1xuICAgIHRoaXMuZWxlbWVudF8gPSBhNGEuZWxlbWVudDtcblxuICAgIC8qKiBAY29uc3QgQHByaXZhdGUge3N0cmluZ30gKi9cbiAgICB0aGlzLmFkVHlwZV8gPSB0aGlzLmVsZW1lbnRfLmdldEF0dHJpYnV0ZSgndHlwZScpLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAvKiogQGNvbnN0IEBwcml2YXRlIHs/bnVtYmVyfSAqL1xuICAgIHRoaXMucmVmcmVzaEludGVydmFsXyA9IHJlZnJlc2hJbnRlcnZhbDtcblxuICAgIC8qKiBAY29uc3QgQHByaXZhdGUgeyFSZWZyZXNoQ29uZmlnfSAqL1xuICAgIHRoaXMuY29uZmlnXyA9IHRoaXMuY29udmVydEFuZFNhbml0aXplQ29uZmlndXJhdGlvbl8oY29uZmlnKTtcblxuICAgIC8qKiBAY29uc3QgQHByaXZhdGUgeyEuLi8uLi8uLi9zcmMvc2VydmljZS90aW1lci1pbXBsLlRpbWVyfSAqL1xuICAgIHRoaXMudGltZXJfID0gU2VydmljZXMudGltZXJGb3IodGhpcy53aW5fKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7PyhudW1iZXJ8c3RyaW5nKX0gKi9cbiAgICB0aGlzLnJlZnJlc2hUaW1lb3V0SWRfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7PyhudW1iZXJ8c3RyaW5nKX0gKi9cbiAgICB0aGlzLnZpc2liaWxpdHlUaW1lb3V0SWRfID0gbnVsbDtcblxuICAgIGNvbnN0IG1hbmFnZXJJZCA9IFN0cmluZyhyZWZyZXNoTWFuYWdlcklkQ291bnRlcisrKTtcbiAgICB0aGlzLmVsZW1lbnRfLnNldEF0dHJpYnV0ZShEQVRBX01BTkFHRVJfSURfTkFNRSwgbWFuYWdlcklkKTtcbiAgICBtYW5hZ2Vyc1ttYW5hZ2VySWRdID0gdGhpcztcbiAgICB0aGlzLmluaXRpYXRlUmVmcmVzaEN5Y2xlKCk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhbiBJbnRlcnNlY3Rpb25PYnNlcnZlciBjb25maWd1cmVkIHRvIHRoZSBnaXZlbiB0aHJlc2hvbGQsIGNyZWF0aW5nXG4gICAqIG9uZSBpZiBvbmUgZG9lcyBub3QgeWV0IGV4aXN0LlxuICAgKlxuICAgKiBAcGFyYW0ge251bWJlcn0gdGhyZXNob2xkXG4gICAqIEByZXR1cm4geyghSW50ZXJzZWN0aW9uT2JzZXJ2ZXJ8IVJlZnJlc2hJbnRlcnNlY3Rpb25PYnNlcnZlcldyYXBwZXIpfVxuICAgKi9cbiAgZ2V0SW50ZXJzZWN0aW9uT2JzZXJ2ZXJXaXRoVGhyZXNob2xkXyh0aHJlc2hvbGQpIHtcblxuICAgIGNvbnN0IHRocmVzaG9sZFN0cmluZyA9IFN0cmluZyh0aHJlc2hvbGQpO1xuICAgIHJldHVybiBvYnNlcnZlcnNbdGhyZXNob2xkU3RyaW5nXSB8fFxuICAgICAgICAob2JzZXJ2ZXJzW3RocmVzaG9sZFN0cmluZ10gPSAnSW50ZXJzZWN0aW9uT2JzZXJ2ZXInIGluIHRoaXMud2luX1xuICAgICAgICAgID8gbmV3IHRoaXMud2luX1snSW50ZXJzZWN0aW9uT2JzZXJ2ZXInXSh0aGlzLmlvQ2FsbGJhY2tfLCB7dGhyZXNob2xkfSlcbiAgICAgICAgICA6IG5ldyBSZWZyZXNoSW50ZXJzZWN0aW9uT2JzZXJ2ZXJXcmFwcGVyKFxuICAgICAgICAgICAgICB0aGlzLmlvQ2FsbGJhY2tfLCB0aGlzLmE0YV8sIHt0aHJlc2hvbGR9KSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBpbnZva2VkIGRpcmVjdGx5IGJ5IHRoZVxuICAgKiBJbnRlcnNlY3Rpb25PYnNlcnZlciBpbXBsZW1lbnRhdGlvbi4gSXQgd2lsbCBpbXBsZW1lbnQgdGhlIGNvcmUgbG9naWMgb2ZcbiAgICogdGhlIHJlZnJlc2ggbGlmZWN5Y2xlLCBpbmNsdWRpbmcgdGhlIHRyYW5zaXRpb25zIG9mIHRoZSBERkEuXG4gICAqXG4gICAqIEBwYXJhbSB7IUFycmF5PCFJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5Pn0gZW50cmllc1xuICAgKi9cbiAgaW9DYWxsYmFja18oZW50cmllcykge1xuICAgIGVudHJpZXMuZm9yRWFjaChlbnRyeSA9PiB7XG4gICAgICBjb25zdCByZWZyZXNoTWFuYWdlcklkID0gZW50cnkudGFyZ2V0LmdldEF0dHJpYnV0ZShEQVRBX01BTkFHRVJfSURfTkFNRSk7XG4gICAgICBkZXYoKS5hc3NlcnQocmVmcmVzaE1hbmFnZXJJZCk7XG4gICAgICBjb25zdCByZWZyZXNoTWFuYWdlciA9IG1hbmFnZXJzW3JlZnJlc2hNYW5hZ2VySWRdO1xuICAgICAgaWYgKGVudHJ5LnRhcmdldCAhPSByZWZyZXNoTWFuYWdlci5lbGVtZW50Xykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBzd2l0Y2ggKHJlZnJlc2hNYW5hZ2VyLnN0YXRlXykge1xuICAgICAgICBjYXNlIFJlZnJlc2hMaWZlY3ljbGVTdGF0ZS5JTklUSUFMOlxuICAgICAgICAgIC8vIEZpcnN0IGNoZWNrIGlmIHRoZSBlbGVtZW50IHF1YWxpZmllcyBhcyBcImJlaW5nIG9uIHNjcmVlblwiLCBpLmUuLFxuICAgICAgICAgIC8vIHRoYXQgYXQgbGVhc3QgYSBtaW5pbXVtIHRocmVzaG9sZCBvZiBwaXhlbHMgaXMgb24gc2NyZWVuLiBJZiBzbyxcbiAgICAgICAgICAvLyBiZWdpbiBhIHRpbWVyLCBzZXQgZm9yIHRoZSBkdXJhdGlvbiBvZiB0aGUgbWluaW11bSB0aW1lIG9uIHNjcmVlblxuICAgICAgICAgIC8vIHRocmVzaG9sZC4gSWYgdGhpcyB0aW1lciBydW5zIG91dCB3aXRob3V0IGludGVycnVwdGlvbiwgdGhlbiBhbGxcbiAgICAgICAgICAvLyB2aWV3YWJpbGl0eSBjb25kaXRpb25zIGhhdmUgYmVlbiBtZXQsIGFuZCB3ZSBjYW4gYmVnaW4gdGhlIHJlZnJlc2hcbiAgICAgICAgICAvLyB0aW1lci5cbiAgICAgICAgICBpZiAoZW50cnkuaW50ZXJzZWN0aW9uUmF0aW8gPj1cbiAgICAgICAgICAgICAgcmVmcmVzaE1hbmFnZXIuY29uZmlnXy52aXNpYmxlUGVyY2VudGFnZU1pbikge1xuICAgICAgICAgICAgcmVmcmVzaE1hbmFnZXIuc3RhdGVfID0gUmVmcmVzaExpZmVjeWNsZVN0YXRlLlZJRVdfUEVORElORztcbiAgICAgICAgICAgIHJlZnJlc2hNYW5hZ2VyLnZpc2liaWxpdHlUaW1lb3V0SWRfID0gcmVmcmVzaE1hbmFnZXIudGltZXJfLmRlbGF5KFxuICAgICAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAgIHJlZnJlc2hNYW5hZ2VyLnN0YXRlXyA9IFJlZnJlc2hMaWZlY3ljbGVTdGF0ZS5SRUZSRVNIX1BFTkRJTkc7XG4gICAgICAgICAgICAgICAgICByZWZyZXNoTWFuYWdlci5zdGFydFJlZnJlc2hUaW1lcl8oKTtcbiAgICAgICAgICAgICAgICB9LCByZWZyZXNoTWFuYWdlci5jb25maWdfLmNvbnRpbnVvdXNUaW1lTWluKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgUmVmcmVzaExpZmVjeWNsZVN0YXRlLlZJRVdfUEVORElORzpcbiAgICAgICAgICAvLyBJZiB0aGUgZWxlbWVudCBnb2VzIG9mZiBzY3JlZW4gYmVmb3JlIHRoZSBtaW5pbXVtIG9uIHNjcmVlbiB0aW1lXG4gICAgICAgICAgLy8gZHVyYXRpb24gZWxhcHNlcywgcGxhY2UgaXQgYmFjayBpbnRvIElOSVRJQUwgc3RhdGUuXG4gICAgICAgICAgaWYgKGVudHJ5LmludGVyc2VjdGlvblJhdGlvIDxcbiAgICAgICAgICAgICAgcmVmcmVzaE1hbmFnZXIuY29uZmlnXy52aXNpYmxlUGVyY2VudGFnZU1pbikge1xuICAgICAgICAgICAgcmVmcmVzaE1hbmFnZXIudGltZXJfLmNhbmNlbChyZWZyZXNoTWFuYWdlci52aXNpYmlsaXR5VGltZW91dElkXyk7XG4gICAgICAgICAgICByZWZyZXNoTWFuYWdlci52aXNpYmlsaXR5VGltZW91dElkXyA9IG51bGw7XG4gICAgICAgICAgICByZWZyZXNoTWFuYWdlci5zdGF0ZV8gPSBSZWZyZXNoTGlmZWN5Y2xlU3RhdGUuSU5JVElBTDtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgUmVmcmVzaExpZmVjeWNsZVN0YXRlLlJFRlJFU0hfUEVORElORzpcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWF0ZXMgdGhlIHJlZnJlc2ggY3ljbGUgYnkgaW5pdGlhdGluZyB0aGUgdmlzaWJpbGl0eSBtYW5hZ2VyIG9uIHRoZVxuICAgKiBlbGVtZW50LlxuICAgKi9cbiAgaW5pdGlhdGVSZWZyZXNoQ3ljbGUoKSB7XG4gICAgc3dpdGNoICh0aGlzLnN0YXRlXykge1xuICAgICAgY2FzZSBSZWZyZXNoTGlmZWN5Y2xlU3RhdGUuSU5JVElBTDpcbiAgICAgICAgdGhpcy5nZXRJbnRlcnNlY3Rpb25PYnNlcnZlcldpdGhUaHJlc2hvbGRfKFxuICAgICAgICAgICAgdGhpcy5jb25maWdfLnZpc2libGVQZXJjZW50YWdlTWluKS5vYnNlcnZlKHRoaXMuZWxlbWVudF8pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgUmVmcmVzaExpZmVjeWNsZVN0YXRlLlJFRlJFU0hfUEVORElORzpcbiAgICAgIGNhc2UgUmVmcmVzaExpZmVjeWNsZVN0YXRlLlZJRVdfUEVORElORzpcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrO1xuXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0cyB0aGUgcmVmcmVzaCB0aW1lciBmb3IgdGhlIGdpdmVuIG1vbml0b3JlZCBlbGVtZW50LlxuICAgKlxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTxib29sZWFuPn0gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdHJ1ZSB3aGVuIHRoZVxuICAgKiAgICByZWZyZXNoIHRpbWVyIGVsYXBzZXMgc3VjY2Vzc2Z1bGx5LlxuICAgKi9cbiAgc3RhcnRSZWZyZXNoVGltZXJfKCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgIHRoaXMucmVmcmVzaFRpbWVvdXRJZF8gPSB0aGlzLnRpbWVyXy5kZWxheSgoKSA9PiB7XG4gICAgICAgIHRoaXMuc3RhdGVfID0gUmVmcmVzaExpZmVjeWNsZVN0YXRlLklOSVRJQUw7XG4gICAgICAgIHRoaXMudW5vYnNlcnZlKCk7XG4gICAgICAgIHRoaXMuYTRhXy5yZWZyZXNoKCgpID0+IHRoaXMuaW5pdGlhdGVSZWZyZXNoQ3ljbGUoKSk7XG4gICAgICAgIHJlc29sdmUodHJ1ZSk7XG4gICAgICB9LCAvKiogQHR5cGUge251bWJlcn0gKi8gKHRoaXMucmVmcmVzaEludGVydmFsXykpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnRzIGNvbmZpZyB0byBhcHByb3ByaWF0ZSB1bml0cywgbW9kaWZ5aW5nIHRoZSBhcmd1bWVudCBpbiBwbGFjZS4gVGhpc1xuICAgKiBhbHNvIGVuc3VyZXMgdGhhdCB2aXNpYmxlUGVyY2VudGFnZU1pbiBpcyBpbiB0aGUgcmFuZ2Ugb2YgWzAsIDEwMF0uXG4gICAqIEBwYXJhbSB7IVJlZnJlc2hDb25maWd9IGNvbmZpZ1xuICAgKiBAcmV0dXJuIHshUmVmcmVzaENvbmZpZ31cbiAgICovXG4gIGNvbnZlcnRBbmRTYW5pdGl6ZUNvbmZpZ3VyYXRpb25fKGNvbmZpZykge1xuICAgIGRldigpLmFzc2VydChjb25maWdbJ3Zpc2libGVQZXJjZW50YWdlTWluJ10gPj0gMCAmJlxuICAgICAgICBjb25maWdbJ3Zpc2libGVQZXJjZW50YWdlTWluJ10gPD0gMTAwLFxuICAgICd2aXNpYmxlUGVyY2VudGFnZU1pbiBmb3IgcmVmcmVzaCBtdXN0IGJlIGluIHRoZSByYW5nZSBbMCwgMTAwXScpO1xuICAgIC8vIENvbnZlcnQgc2Vjb25kcyB0byBtaWxsaXNlY29uZHMuXG4gICAgY29uZmlnWydjb250aW51b3VzVGltZU1pbiddICo9IDEwMDA7XG4gICAgY29uZmlnWyd2aXNpYmxlUGVyY2VudGFnZU1pbiddIC89IDEwMDtcbiAgICByZXR1cm4gY29uZmlnO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3BzIHRoZSBpbnRlcnNlY3Rpb24gb2JzZXJ2ZXIgZnJvbSBvYnNlcnZpbmcgdGhlIGVsZW1lbnQuXG4gICAqL1xuICB1bm9ic2VydmUoKSB7XG4gICAgdGhpcy5nZXRJbnRlcnNlY3Rpb25PYnNlcnZlcldpdGhUaHJlc2hvbGRfKFxuICAgICAgICB0aGlzLmNvbmZpZ18udmlzaWJsZVBlcmNlbnRhZ2VNaW4pLnVub2JzZXJ2ZSh0aGlzLmVsZW1lbnRfKTtcbiAgfVxufVxuXG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi4vLi4vLi4vc3JjL3NlcnZpY2VzJztcbmltcG9ydCB7YmFzZTY0RGVjb2RlVG9CeXRlc30gZnJvbSAnLi4vLi4vLi4vc3JjL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQge2RldiwgdXNlcn0gZnJvbSAnLi4vLi4vLi4vc3JjL2xvZyc7XG5pbXBvcnQge2lzQXJyYXl9IGZyb20gJy4uLy4uLy4uL3NyYy90eXBlcyc7XG5cbi8qKiBAdmlzaWJsZUZvclRlc3RpbmcgKi9cbmV4cG9ydCBjb25zdCBBTVBfU0lHTkFUVVJFX0hFQURFUiA9ICdBTVAtRmFzdC1GZXRjaC1TaWduYXR1cmUnO1xuXG4vKipcbiAqIFRoZSByZXN1bHQgb2YgYW4gYXR0ZW1wdCB0byB2ZXJpZnkgYSBGYXN0IEZldGNoIHNpZ25hdHVyZS4gVGhlIGRpZmZlcmVudFxuICogZXJyb3Igc3RhdHVzZXMgYXJlIHVzZWQgZm9yIHJlcG9ydGluZyBlcnJvcnMgdG8gdGhlIGFkIG5ldHdvcmsuXG4gKlxuICogQGVudW0ge251bWJlcn1cbiAqL1xuZXhwb3J0IGNvbnN0IFZlcmlmaWNhdGlvblN0YXR1cyA9IHtcblxuICAvKiogVGhlIGFkIHdhcyBzdWNjZXNzZnVsbHkgdmVyaWZpZWQgYXMgQU1QLiAqL1xuICBPSzogMCxcblxuICAvKipcbiAgICogVmVyaWZpY2F0aW9uIGZhaWxlZCBiZWNhdXNlIG9mIGEgZmFjdG9yIGJleW9uZCB0aGUgYWQgbmV0d29yaydzIGNvbnRyb2wsXG4gICAqIHN1Y2ggYXMgYSBuZXR3b3JrIGNvbm5lY3Rpdml0eSBmYWlsdXJlLCB1bmF2YWlsYWJpbGl0eSBvZiBXZWIgQ3J5cHRvZ3JhcGh5XG4gICAqIGluIHRoZSBjdXJyZW50IGJyb3dzaW5nIGNvbnRleHQsIG9yIGEgbWlzYmVoYXZpbmcgc2lnbmluZyBzZXJ2aWNlLlxuICAgKi9cbiAgVU5WRVJJRklFRDogMSxcblxuICAvKipcbiAgICogVmVyaWZpY2F0aW9uIGZhaWxlZCBiZWNhdXNlIHRoZSBrZXlwYWlyIElEIHByb3ZpZGVkIGJ5IHRoZSBhZCBuZXR3b3JrIGRpZFxuICAgKiBub3QgY29ycmVzcG9uZCB0byBhbnkgcHVibGljIGtleSBvZmZlcmVkIGJ5IHRoZSBzaWduaW5nIHNlcnZpY2UuXG4gICAqL1xuICBFUlJPUl9LRVlfTk9UX0ZPVU5EOiAyLFxuXG4gIC8qKlxuICAgKiBWZXJpZmljYXRpb24gZmFpbGVkIGJlY2F1c2UgdGhlIHNpZ25hdHVyZSBwcm92aWRlZCBieSB0aGUgYWQgbmV0d29yayB3YXNcbiAgICogbm90IHRoZSBjb3JyZWN0IGNyeXB0b2dyYXBoaWMgc2lnbmF0dXJlIGZvciB0aGUgZ2l2ZW4gY3JlYXRpdmUgZGF0YSBhbmRcbiAgICogcHVibGljIGtleS5cbiAgICovXG4gIEVSUk9SX1NJR05BVFVSRV9NSVNNQVRDSDogMyxcblxuICAvKipcbiAgICogVmVyaWZpY2F0aW9uIGZhaWxlZCBiZWNhdXNlIHRoZSBwYWdlIGRvZXMgbm90IGhhdmUgd2ViIGNyeXB0byBhdmFpbGFibGUsXG4gICAqIGkuZS4gaXMgbm90IFNTTC5cbiAgICovXG4gIENSWVBUT19VTkFWQUlMQUJMRTogNCxcblxufTtcblxuLyoqXG4gKiBBIHdpbmRvdy1sZXZlbCBvYmplY3QgdGhhdCBlbmNhcHN1bGF0ZXMgdGhlIGxvZ2ljIGZvciBvYnRhaW5pbmcgcHVibGljIGtleXNcbiAqIGZyb20gRmFzdCBGZXRjaCBzaWduaW5nIHNlcnZpY2VzIGFuZCBjcnlwdG9ncmFwaGljYWxseSB2ZXJpZnlpbmcgc2lnbmF0dXJlc1xuICogb2YgQU1QIGNyZWF0aXZlcy5cbiAqXG4gKiBVbmxpa2UgYW4gQU1QIHNlcnZpY2UsIGEgc2lnbmF0dXJlIHZlcmlmaWVyIGlzICoqc3RhdGVmdWwqKi4gSXQgbWFpbnRhaW5zIGFcbiAqIGNhY2hlIG9mIGFsbCBwdWJsaWMga2V5cyB0aGF0IGl0IGhhcyBwcmV2aW91c2x5IGRvd25sb2FkZWQgYW5kIGltcG9ydGVkLCBhbmRcbiAqIGFsc28ga2VlcHMgdHJhY2sgb2Ygd2hpY2gga2V5cyBhbmQgc2lnbmluZyBzZXJ2aWNlcyBoYXZlIGFscmVhZHkgaGFkXG4gKiB1bnN1Y2Nlc3NmdWwgZG93bmxvYWQgb3IgaW1wb3J0IGF0dGVtcHRzIGFuZCBzaG91bGQgbm90IGJlIGF0dGVtcHRlZCBhZ2Fpbi5cbiAqXG4gKiBUaGlzIGVudGlyZSBjbGFzcyBpcyBjdXJyZW50bHkgZGVhZCBjb2RlIGluIHByb2R1Y3Rpb24sIGJ1dCB3aWxsIHNvb24gYmVcbiAqIGludHJvZHVjZWQgYXMgYW4gZXhwZXJpbWVudC5cbiAqL1xuZXhwb3J0IGNsYXNzIFNpZ25hdHVyZVZlcmlmaWVyIHtcblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn0gc2lnbmluZ1NlcnZlclVSTHMgYSBtYXAgZnJvbSB0aGUgbmFtZSBvZlxuICAgKiAgICBlYWNoIHRydXN0ZWQgc2lnbmluZyBzZXJ2aWNlIHRvIHRoZSBVUkwgb2YgaXRzIHB1YmxpYyBrZXkgZW5kcG9pbnRcbiAgICovXG4gIGNvbnN0cnVjdG9yKHdpbiwgc2lnbmluZ1NlcnZlclVSTHMpIHtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshV2luZG93fSAqL1xuICAgIHRoaXMud2luXyA9IHdpbjtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSAqL1xuICAgIHRoaXMuc2lnbmluZ1NlcnZlclVSTHNfID0gc2lnbmluZ1NlcnZlclVSTHM7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgY2FjaGUgd2hlcmUgYWxsIHRoZSBwdWJsaWMga2V5cyBhcmUgc3RvcmVkLlxuICAgICAqXG4gICAgICogVGhpcyBmaWVsZCBoYXMgYSBsb3Qgb2YgaW50ZXJuYWwgc3RydWN0dXJlIGFuZCBpdHMgdHlwZSdzIGEgbGl0dGxlIGhhaXJ5LFxuICAgICAqIHNvIGhlcmUncyBhIHJ1bmRvd24gb2Ygd2hhdCBlYWNoIHBpZWNlIG1lYW5zOlxuICAgICAqICAtIElmIFdlYiBDcnlwdG9ncmFwaHkgaXNuJ3QgYXZhaWxhYmxlIGluIHRoZSBjdXJyZW50IGJyb3dzaW5nIGNvbnRleHQsXG4gICAgICogICAgdGhlbiB0aGUgZW50aXJlIGZpZWxkIGlzIG51bGwuIFNpbmNlIHRoZSBrZXlzIGFyZSBvZiBubyB1c2UsIHdlIGRvbid0XG4gICAgICogICAgZmV0Y2ggdGhlbS5cbiAgICAgKiAgLSBPdGhlcndpc2UsIGl0J3MgYSBtYXAtbGlrZSBgT2JqZWN0YCBmcm9tIHNpZ25pbmcgc2VydmljZSBuYW1lcyAoYXNcbiAgICAgKiAgICBkZWZpbmVkIGluIHRoZSBGYXN0IEZldGNoIGNvbmZpZyByZWdpc3RyeSkgdG8gXCJzaWduZXJcIiBvYmplY3RzLlxuICAgICAqICAtIFRoZSBgcHJvbWlzZWAgcHJvcGVydHkgb2YgZWFjaCBzaWduZXIgcmVzb2x2ZXMgdG8gYSBib29sZWFuIGluZGljYXRpbmdcbiAgICAgKiAgICB3aGV0aGVyIHRoZSBtb3N0IHJlY2VudCBhdHRlbXB0IHRvIGZldGNoIGFuZCBpbXBvcnQgdGhhdCBzaWduaW5nXG4gICAgICogICAgc2VydmljZSdzIHB1YmxpYyBrZXlzIHdhcyBzdWNjZXNzZnVsLiBJZiB0aGUgcHJvbWlzZSBpcyBzdGlsbCBwZW5kaW5nLFxuICAgICAqICAgIHRoZW4gYW4gYXR0ZW1wdCBpcyBjdXJyZW50bHkgaW4gcHJvZ3Jlc3MuIFRoaXMgcHJvcGVydHkgaXMgbXV0YWJsZTtcbiAgICAgKiAgICBpdHMgdmFsdWUgaXMgcmVwbGFjZWQgd2l0aCBhIG5ldyBwcm9taXNlIHdoZW4gYSBuZXcgYXR0ZW1wdCBpcyBtYWRlLlxuICAgICAqICAgIEludmFyaWFudDogb25seSBvbmUgYXR0ZW1wdCBtYXkgYmUgaW4gcHJvZ3Jlc3MgYXQgYSB0aW1lLCBzbyB0aGlzXG4gICAgICogICAgcHJvcGVydHkgbWF5IG5vdCBiZSBtdXRhdGVkIHdoaWxlIHRoZSBjdXJyZW50IHByb21pc2UgaXMgcGVuZGluZy5cbiAgICAgKiAgLSBUaGUgYGtleXNgIHByb3BlcnR5IG9mIGVhY2ggc2lnbmVyIGlzIGEgbWFwLWxpa2UgYE9iamVjdGAgZnJvbSBrZXlwYWlyXG4gICAgICogICAgSURzIHRvIG51bGxhYmxlIGtleSBwcm9taXNlcy4gKFRoaXMgbWVhbnMgdGhhdCBhIHByb3BlcnR5IGFjY2VzcyBvblxuICAgICAqICAgIHRoaXMgb2JqZWN0IG1heSBldmFsdWF0ZSB0byBgdW5kZWZpbmVkYCwgYG51bGxgLCBvciBhIGBQcm9taXNlYFxuICAgICAqICAgIG9iamVjdC4pIFRoZSBga2V5c2Agb2JqZWN0IGlzIGludGVybmFsbHkgbXV0YWJsZTsgbmV3IGtleXMgYXJlIGFkZGVkXG4gICAgICogICAgdG8gaXQgYXMgdGhleSBhcmUgZmV0Y2hlZC4gSW52YXJpYW50OiB0aGUgYGtleXNgIG9iamVjdCBtYXkgYmUgbXV0YXRlZFxuICAgICAqICAgIG9ubHkgd2hpbGUgdGhlIGNvcnJlc3BvbmRpbmcgYHByb21pc2VgIG9iamVjdCBpcyBwZW5kaW5nOyB0aGlzIGVuc3VyZXNcbiAgICAgKiAgICB0aGF0IGNhbGxiYWNrcyBjaGFpbmVkIHRvIGBwcm9taXNlYCBtYXkgb2JzZXJ2ZSBga2V5c2Agd2l0aG91dCBiZWluZ1xuICAgICAqICAgIHN1YmplY3QgdG8gcmFjZSBjb25kaXRpb25zLlxuICAgICAqICAtIElmIGEga2V5IHByb21pc2UgKGkuZS4sIHRoZSB2YWx1ZSBvZiBhIHByb3BlcnR5IGFjY2VzcyBvbiB0aGUgYGtleXNgXG4gICAgICogICAgb2JqZWN0KSBpcyBhYnNlbnQgKGkuZS4sIGB1bmRlZmluZWRgKSwgdGhlbiBubyBrZXkgd2l0aCB0aGF0IGtleXBhaXJcbiAgICAgKiAgICBJRCBpcyBwcmVzZW50IChidXQgdGhpcyBjb3VsZCBiZSBiZWNhdXNlIG9mIGEgc3RhbGUgY2FjaGUpLiBJZiBpdCdzXG4gICAgICogICAgbnVsbCwgdGhlbiBubyBrZXkgd2l0aCB0aGF0IGtleXBhaXIgSUQgY291bGQgYmUgZm91bmQgZXZlbiBhZnRlclxuICAgICAqICAgIGNhY2hlYnVzdGluZy4gSWYgaXQncyBhIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIHRvIGBudWxsYCwgdGhlbiBrZXlcbiAgICAgKiAgICBkYXRhIGZvciB0aGF0IGtleXBhaXIgSUQgd2FzIGZvdW5kIGJ1dCBjb3VsZCBub3QgYmUgaW1wb3J0ZWRcbiAgICAgKiAgICBzdWNjZXNzZnVsbHk7IHRoaXMgbW9zdCBsaWtlbHkgaW5kaWNhdGVzIHNpZ25pbmcgc2VydmljZSBtaXNiZWhhdmlvci5cbiAgICAgKiAgICBUaGUgc3VjY2VzcyBjYXNlIGlzIGEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgdG8gYSBgQ3J5cHRvS2V5YC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlIEBjb25zdCB7P09iamVjdDxzdHJpbmcsIHtwcm9taXNlOiAhUHJvbWlzZTxib29sZWFuPiwga2V5czogIU9iamVjdDxzdHJpbmcsID9Qcm9taXNlPD93ZWJDcnlwdG8uQ3J5cHRvS2V5Pj59Pn1cbiAgICAgKi9cbiAgICB0aGlzLnNpZ25lcnNfID0gU2VydmljZXMuY3J5cHRvRm9yKHdpbikuaXNQa2NzQXZhaWxhYmxlKCkgPyB7fSA6IG51bGw7XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGEgbm90aW9uIG9mIGN1cnJlbnQgdGltZSwgaW4gbXMuICBUaGUgdmFsdWUgaXMgbm90IG5lY2Vzc2FyaWx5XG4gICAgICogYWJzb2x1dGUsIHNvIHNob3VsZCBiZSB1c2VkIG9ubHkgZm9yIGNvbXB1dGluZyBkZWx0YXMuICBXaGVuIGF2YWlsYWJsZSxcbiAgICAgKiB0aGUgcGVyZm9ybWFuY2Ugc3lzdGVtIHdpbGwgYmUgdXNlZDsgb3RoZXJ3aXNlIERhdGUubm93KCkgd2lsbCBiZVxuICAgICAqIHJldHVybmVkLlxuICAgICAqXG4gICAgICogQHByaXZhdGUgQGNvbnN0IHtmdW5jdGlvbigpOiBudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy5nZXROb3dfID0gKHdpbi5wZXJmb3JtYW5jZSAmJiB3aW4ucGVyZm9ybWFuY2Uubm93KSA/XG4gICAgICB3aW4ucGVyZm9ybWFuY2Uubm93LmJpbmQod2luLnBlcmZvcm1hbmNlKSA6IERhdGUubm93O1xuICB9XG5cbiAgLyoqXG4gICAqIEZldGNoZXMgYW5kIGltcG9ydHMgdGhlIHB1YmxpYyBrZXlzZXQgZm9yIHRoZSBuYW1lZCBzaWduaW5nIHNlcnZpY2UsXG4gICAqIHdpdGhvdXQgYW55IGNhY2hlYnVzdGluZy4gSG9wZWZ1bGx5LCB0aGlzIHdpbGwgaGl0IGNhY2hlIGluIG1hbnkgY2FzZXNcbiAgICogYW5kIG5vdCBtYWtlIGFuIGFjdHVhbCBuZXR3b3JrIHJvdW5kLXRyaXAuIFRoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWRcbiAgICogYXMgZWFybHkgYXMgcG9zc2libGUsIG9uY2UgaXQncyBrbm93biB3aGljaCBzaWduaW5nIHNlcnZpY2UgaXMgbGlrZWx5IHRvXG4gICAqIGJlIHVzZWQsIHNvIHRoYXQgdGhlIG5ldHdvcmsgcmVxdWVzdCBhbmQga2V5IGltcG9ydHMgY2FuIGV4ZWN1dGUgaW5cbiAgICogcGFyYWxsZWwgd2l0aCBvdGhlciBvcGVyYXRpb25zLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gc2lnbmluZ1NlcnZpY2VOYW1lXG4gICAqL1xuICBsb2FkS2V5c2V0KHNpZ25pbmdTZXJ2aWNlTmFtZSkge1xuICAgIGlmICh0aGlzLnNpZ25lcnNfICYmICF0aGlzLnNpZ25lcnNfW3NpZ25pbmdTZXJ2aWNlTmFtZV0pIHtcbiAgICAgIGNvbnN0IGtleXMgPSB7fTtcbiAgICAgIGNvbnN0IHByb21pc2UgPSB0aGlzLmZldGNoQW5kQWRkS2V5c18oa2V5cywgc2lnbmluZ1NlcnZpY2VOYW1lLCBudWxsKTtcbiAgICAgIHRoaXMuc2lnbmVyc19bc2lnbmluZ1NlcnZpY2VOYW1lXSA9IHtwcm9taXNlLCBrZXlzfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRXh0cmFjdHMgYSBjcnlwdG9ncmFwaGljIHNpZ25hdHVyZSBmcm9tIGBoZWFkZXJzYCBhbmQgYXR0ZW1wdHMgdG8gdmVyaWZ5XG4gICAqIHRoYXQgaXQncyB0aGUgY29ycmVjdCBjcnlwdG9ncmFwaGljIHNpZ25hdHVyZSBmb3IgYGNyZWF0aXZlYC5cbiAgICpcbiAgICogQXMgYSBwcmVjb25kaXRpb24sIGBsb2FkS2V5c2V0KHNpZ25pbmdTZXJ2aWNlTmFtZSlgIG11c3QgaGF2ZSBhbHJlYWR5IGJlZW5cbiAgICogY2FsbGVkLlxuICAgKlxuICAgKiBAcGFyYW0geyFBcnJheUJ1ZmZlcn0gY3JlYXRpdmVcbiAgICogQHBhcmFtIHshSGVhZGVyc30gaGVhZGVyc1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhVmVyaWZpY2F0aW9uU3RhdHVzPn1cbiAgICovXG4gIHZlcmlmeShjcmVhdGl2ZSwgaGVhZGVycykge1xuICAgIGNvbnN0IHNpZ25hdHVyZUZvcm1hdCA9XG4gICAgICAgIC9eKFtBLVphLXowLTkuXy1dKyk6KFtBLVphLXowLTkuXy1dKyk6KFtBLVphLXowLTkrL117MzQxfVtBUWd3XT09KSQvO1xuICAgIGlmICghaGVhZGVycy5oYXMoQU1QX1NJR05BVFVSRV9IRUFERVIpKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFZlcmlmaWNhdGlvblN0YXR1cy5VTlZFUklGSUVEKTtcbiAgICB9XG4gICAgY29uc3QgaGVhZGVyVmFsdWUgPSBoZWFkZXJzLmdldChBTVBfU0lHTkFUVVJFX0hFQURFUik7XG4gICAgY29uc3QgbWF0Y2ggPSBzaWduYXR1cmVGb3JtYXQuZXhlYyhoZWFkZXJWYWx1ZSk7XG4gICAgaWYgKCFtYXRjaCkge1xuICAgICAgLy8gVE9ETyhAdGF5bW9uYmVhbCwgIzkyNzQpOiByZXBsYWNlIHRoaXMgd2l0aCByZWFsIGVycm9yIHJlcG9ydGluZ1xuICAgICAgdXNlcigpLmVycm9yKFxuICAgICAgICAgICdBTVAtQTRBJywgYEludmFsaWQgc2lnbmF0dXJlIGhlYWRlcjogJHtoZWFkZXJWYWx1ZS5zcGxpdCgnOicpWzBdfWApO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShWZXJpZmljYXRpb25TdGF0dXMuRVJST1JfU0lHTkFUVVJFX01JU01BVENIKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudmVyaWZ5Q3JlYXRpdmVBbmRTaWduYXR1cmUoXG4gICAgICAgIG1hdGNoWzFdLCBtYXRjaFsyXSwgYmFzZTY0RGVjb2RlVG9CeXRlcyhtYXRjaFszXSksIGNyZWF0aXZlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmllcyB0aGF0IGBzaWduYXR1cmVgIGlzIHRoZSBjb3JyZWN0IGNyeXB0b2dyYXBoaWMgc2lnbmF0dXJlIGZvclxuICAgKiBgY3JlYXRpdmVgLCB3aXRoIHRoZSBwdWJsaWMga2V5IGZyb20gdGhlIG5hbWVkIHNpZ25pbmcgc2VydmljZSBpZGVudGlmaWVkXG4gICAqIGJ5IGBrZXlwYWlySWRgLlxuICAgKlxuICAgKiBBcyBhIHByZWNvbmRpdGlvbiwgYGxvYWRLZXlzZXQoc2lnbmluZ1NlcnZpY2VOYW1lKWAgbXVzdCBoYXZlIGFscmVhZHkgYmVlblxuICAgKiBjYWxsZWQuXG4gICAqXG4gICAqIElmIHRoZSBrZXlzZXQgZm9yIHRoZSBuYW1lZCBzaWduaW5nIHNlcnZpY2Ugd2FzIGltcG9ydGVkIHN1Y2Nlc3NmdWxseSBidXRcbiAgICogZGlkIG5vdCBpbmNsdWRlIGEga2V5IGZvciBga2V5cGFpcklkYCwgdGhpcyBtYXkgYmUgdGhlIHJlc3VsdCBvZiBhIHN0YWxlXG4gICAqIGJyb3dzZXIgY2FjaGUuIFRvIHdvcmsgYXJvdW5kIHRoaXMsIGBrZXlwYWlySWRgIGlzIGFkZGVkIHRvIHRoZSBwdWJsaWMga2V5XG4gICAqIGVuZHBvaW50IFVSTCBhcyBhIHF1ZXJ5IHBhcmFtZXRlciBhbmQgdGhlIGtleXNldCBpcyByZS1mZXRjaGVkLiBPdGhlciBraW5kc1xuICAgKiBvZiBmYWlsdXJlcywgaW5jbHVkaW5nIG5ldHdvcmsgY29ubmVjdGl2aXR5IGZhaWx1cmVzLCBhcmUgbm90IHJldHJpZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzaWduaW5nU2VydmljZU5hbWVcbiAgICogQHBhcmFtIHtzdHJpbmd9IGtleXBhaXJJZFxuICAgKiBAcGFyYW0geyFVaW50OEFycmF5fSBzaWduYXR1cmVcbiAgICogQHBhcmFtIHshQXJyYXlCdWZmZXJ9IGNyZWF0aXZlXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCFWZXJpZmljYXRpb25TdGF0dXM+fVxuICAgKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAgICovXG4gIHZlcmlmeUNyZWF0aXZlQW5kU2lnbmF0dXJlKFxuICAgIHNpZ25pbmdTZXJ2aWNlTmFtZSwga2V5cGFpcklkLCBzaWduYXR1cmUsIGNyZWF0aXZlKSB7XG4gICAgaWYgKCF0aGlzLnNpZ25lcnNfKSB7XG4gICAgICAvLyBXZWIgQ3J5cHRvZ3JhcGh5IGlzbid0IGF2YWlsYWJsZS5cbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoVmVyaWZpY2F0aW9uU3RhdHVzLkNSWVBUT19VTkFWQUlMQUJMRSk7XG4gICAgfVxuICAgIGNvbnN0IHNpZ25lciA9IHRoaXMuc2lnbmVyc19bc2lnbmluZ1NlcnZpY2VOYW1lXTtcbiAgICBkZXYoKS5hc3NlcnQoXG4gICAgICAgIHNpZ25lciwgJ0tleXNldCBmb3Igc2VydmljZSAlcyBub3QgbG9hZGVkIGJlZm9yZSB2ZXJpZmljYXRpb24nLFxuICAgICAgICBzaWduaW5nU2VydmljZU5hbWUpO1xuICAgIHJldHVybiBzaWduZXIucHJvbWlzZS50aGVuKHN1Y2Nlc3MgPT4ge1xuICAgICAgaWYgKCFzdWNjZXNzKSB7XG4gICAgICAgIC8vIFRoZSBwdWJsaWMga2V5c2V0IGNvdWxkbid0IGJlIGZldGNoZWQgYW5kIGltcG9ydGVkLiBQcm9iYWJseSBhXG4gICAgICAgIC8vIG5ldHdvcmsgY29ubmVjdGl2aXR5IGZhaWx1cmUuXG4gICAgICAgIHJldHVybiBWZXJpZmljYXRpb25TdGF0dXMuVU5WRVJJRklFRDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGtleVByb21pc2UgPSBzaWduZXIua2V5c1trZXlwYWlySWRdO1xuICAgICAgaWYgKGtleVByb21pc2UgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAvLyBXZSBkb24ndCBoYXZlIHRoaXMga2V5LCBidXQgbWF5YmUgdGhlIGNhY2hlIGlzIHN0YWxlOyB0cnlcbiAgICAgICAgLy8gY2FjaGVidXN0aW5nLlxuICAgICAgICBzaWduZXIucHJvbWlzZSA9XG4gICAgICAgICAgICB0aGlzLmZldGNoQW5kQWRkS2V5c18oc2lnbmVyLmtleXMsIHNpZ25pbmdTZXJ2aWNlTmFtZSwga2V5cGFpcklkKVxuICAgICAgICAgICAgICAgIC50aGVuKHN1Y2Nlc3MgPT4ge1xuICAgICAgICAgICAgICAgICAgaWYgKHNpZ25lci5rZXlzW2tleXBhaXJJZF0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBXZSBzdGlsbCBkb24ndCBoYXZlIHRoaXMga2V5OyBtYWtlIHN1cmUgd2UgbmV2ZXIgdHJ5XG4gICAgICAgICAgICAgICAgICAgIC8vIGFnYWluLlxuICAgICAgICAgICAgICAgICAgICBzaWduZXIua2V5c1trZXlwYWlySWRdID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHJldHVybiBzdWNjZXNzO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAvLyBUaGlzIFwicmVjdXJzaXZlXCIgY2FsbCBjYW4gcmVjdXJzZSBhdCBtb3N0IG9uY2UuXG4gICAgICAgIHJldHVybiB0aGlzLnZlcmlmeUNyZWF0aXZlQW5kU2lnbmF0dXJlKFxuICAgICAgICAgICAgc2lnbmluZ1NlcnZpY2VOYW1lLCBrZXlwYWlySWQsIHNpZ25hdHVyZSwgY3JlYXRpdmUpO1xuICAgICAgfSBlbHNlIGlmIChrZXlQcm9taXNlID09PSBudWxsKSB7XG4gICAgICAgIC8vIFdlIGRvbid0IGhhdmUgdGhpcyBrZXkgYW5kIHdlIGFscmVhZHkgdHJpZWQgY2FjaGVidXN0aW5nLlxuICAgICAgICByZXR1cm4gVmVyaWZpY2F0aW9uU3RhdHVzLkVSUk9SX0tFWV9OT1RfRk9VTkQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ga2V5UHJvbWlzZS50aGVuKGtleSA9PiB7XG4gICAgICAgICAgaWYgKCFrZXkpIHtcbiAgICAgICAgICAgIC8vIFRoaXMgcGFydGljdWxhciBwdWJsaWMga2V5IGNvdWxkbid0IGJlIGltcG9ydGVkLiBQcm9iYWJseSB0aGVcbiAgICAgICAgICAgIC8vIHNpZ25pbmcgc2VydmljZSdzIGZhdWx0LlxuICAgICAgICAgICAgcmV0dXJuIFZlcmlmaWNhdGlvblN0YXR1cy5VTlZFUklGSUVEO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBjcnlwdG8gPSBTZXJ2aWNlcy5jcnlwdG9Gb3IodGhpcy53aW5fKTtcbiAgICAgICAgICByZXR1cm4gY3J5cHRvLnZlcmlmeVBrY3Moa2V5LCBzaWduYXR1cmUsIGNyZWF0aXZlKS50aGVuKFxuICAgICAgICAgICAgICByZXN1bHQgPT4gcmVzdWx0ID8gVmVyaWZpY2F0aW9uU3RhdHVzLk9LIDpcbiAgICAgICAgICAgICAgICBWZXJpZmljYXRpb25TdGF0dXMuRVJST1JfU0lHTkFUVVJFX01JU01BVENILFxuICAgICAgICAgICAgICBlcnIgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFdlYiBDcnlwdG9ncmFwaHkgcmVqZWN0ZWQgdGhlIHZlcmlmaWNhdGlvbiBhdHRlbXB0LiBUaGlzXG4gICAgICAgICAgICAgICAgLy8gaG9wZWZ1bGx5IHdvbid0IGhhcHBlbiBpbiB0aGUgd2lsZCwgYnV0IGJyb3dzZXJzIGNhbiBiZSB3ZWlyZFxuICAgICAgICAgICAgICAgIC8vIGFib3V0IHRoaXMsIHNvIHdlIG5lZWQgdG8gZ3VhcmQgYWdhaW5zdCB0aGUgcG9zc2liaWxpdHkuXG4gICAgICAgICAgICAgICAgLy8gUGhvbmUgaG9tZSB0byB0aGUgQU1QIFByb2plY3Qgc28gdGhhdCB3ZSBjYW4gdW5kZXJzdGFuZCB3aHlcbiAgICAgICAgICAgICAgICAvLyB0aGlzIG9jY3VycmVkLlxuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnIgJiYgZXJyLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgZGV2KCkuZXJyb3IoXG4gICAgICAgICAgICAgICAgICAgICdBTVAtQTRBJywgYEZhaWxlZCB0byB2ZXJpZnkgc2lnbmF0dXJlOiAke21lc3NhZ2V9YCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFZlcmlmaWNhdGlvblN0YXR1cy5VTlZFUklGSUVEO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogVHJ5IHRvIGRvd25sb2FkIHRoZSBrZXlzZXQgZm9yIHRoZSBuYW1lZCBzaWduaW5nIHNlcnZpY2UgYW5kIGFkZCBhIHByb21pc2VcbiAgICogZm9yIGVhY2gga2V5IHRvIHRoZSBga2V5c2Agb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCA/UHJvbWlzZTw/d2ViQ3J5cHRvLkNyeXB0b0tleT4+fSBrZXlzIHRoZSBvYmplY3QgdG9cbiAgICogICAgIGFkZCBlYWNoIGtleSBwcm9taXNlIHRvLiBUaGlzIGlzIG11dGF0ZWQgd2hpbGUgdGhlIHJldHVybmVkIHByb21pc2UgaXNcbiAgICogICAgIHBlbmRpbmcuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzaWduaW5nU2VydmljZU5hbWVcbiAgICogQHBhcmFtIHs/c3RyaW5nfSBrZXlwYWlySWQgdGhlIGtleXBhaXIgSUQgdG8gaW5jbHVkZSBpbiB0aGUgcXVlcnkgc3RyaW5nXG4gICAqICAgICBmb3IgY2FjaGVidXN0aW5nIHB1cnBvc2VzLCBvciBgbnVsbGAgaWYgbm8gY2FjaGVidXN0aW5nIGlzIG5lZWRlZFxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTxib29sZWFuPn0gcmVzb2x2ZXMgYWZ0ZXIgdGhlIG11dGF0aW9uIG9mIGBrZXlzYCBpc1xuICAgKiAgICAgY29tcGxldGUsIHRvIGB0cnVlYCBpZiB0aGUga2V5c2V0IHdhcyBkb3dubG9hZGVkIGFuZCBwYXJzZWRcbiAgICogICAgIHN1Y2Nlc3NmdWxseSAoZXZlbiBpZiBzb21lIGtleXMgd2VyZSBtYWxmb3JtZWQpLCBvciBgZmFsc2VgIGlmIGFcbiAgICogICAgIGtleXNldC1sZXZlbCBmYWlsdXJlIG9jY3VycmVkXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBmZXRjaEFuZEFkZEtleXNfKGtleXMsIHNpZ25pbmdTZXJ2aWNlTmFtZSwga2V5cGFpcklkKSB7XG4gICAgbGV0IHVybCA9IHRoaXMuc2lnbmluZ1NlcnZlclVSTHNfW3NpZ25pbmdTZXJ2aWNlTmFtZV07XG4gICAgaWYgKGtleXBhaXJJZCAhPSBudWxsKSB7XG4gICAgICB1cmwgKz0gJz9raWQ9JyArIGVuY29kZVVSSUNvbXBvbmVudChrZXlwYWlySWQpO1xuICAgIH1cbiAgICAvLyBUT0RPKEB0YXltb25iZWFsLCAjMTEwODgpOiBjb25zaWRlciBhIHRpbWVvdXQgb24gdGhpcyBmZXRjaFxuICAgIHJldHVybiBTZXJ2aWNlcy54aHJGb3IodGhpcy53aW5fKVxuICAgICAgICAuZmV0Y2hKc29uKHVybCwge1xuICAgICAgICAgIG1vZGU6ICdjb3JzJyxcbiAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgIC8vIFRoaXMgc2hvdWxkIGJlIGNhY2hlZCBhY3Jvc3MgcHVibGlzaGVyIGRvbWFpbnMsIHNvIGRvbid0IGFwcGVuZFxuICAgICAgICAgIC8vIF9fYW1wX3NvdXJjZV9vcmlnaW4gdG8gdGhlIFVSTC5cbiAgICAgICAgICBhbXBDb3JzOiBmYWxzZSxcbiAgICAgICAgICBjcmVkZW50aWFsczogJ29taXQnLFxuICAgICAgICB9KS50aGVuKFxuICAgICAgICAgICAgcmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAvLyBUaGVzZSBhcmUgYXNzZXJ0aW9ucyBvbiBzaWduaW5nIHNlcnZpY2UgYmVoYXZpb3IgcmVxdWlyZWQgYnlcbiAgICAgICAgICAgICAgLy8gdGhlIHNwZWMuIEhvd2V2ZXIsIG5vdGhpbmcgdGVycmlibGUgaGFwcGVucyBpZiB0aGV5IGFyZW4ndCBtZXRcbiAgICAgICAgICAgICAgLy8gYW5kIHRoZXJlJ3Mgbm8gbWVhbmluZ2Z1bCBlcnJvciByZWNvdmVyeSB0byBiZSBkb25lIGlmIHRoZXlcbiAgICAgICAgICAgICAgLy8gZmFpbCwgc28gd2UgZG9uJ3QgbmVlZCB0byBkbyB0aGVtIGF0IHJ1bnRpbWUgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgICAgICAgLy8gVGhleSdyZSBpbmNsdWRlZCBpbiBkZXYgbW9kZSBhcyBhIGRlYnVnZ2luZyBhaWQuXG4gICAgICAgICAgICAgIGRldigpLmFzc2VydChcbiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwLFxuICAgICAgICAgICAgICAgICAgJ0Zhc3QgRmV0Y2gga2V5c2V0IHNwZWMgcmVxdWlyZXMgc3RhdHVzIGNvZGUgMjAwJyk7XG4gICAgICAgICAgICAgIGRldigpLmFzc2VydChcbiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdDb250ZW50LVR5cGUnKSA9PVxuICAgICAgICAgICAgICAgICAgICAgICdhcHBsaWNhdGlvbi9qd2stc2V0K2pzb24nLFxuICAgICAgICAgICAgICAgICAgJ0Zhc3QgRmV0Y2gga2V5c2V0IHNwZWMgcmVxdWlyZXMgQ29udGVudC1UeXBlOiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAnYXBwbGljYXRpb24vandrLXNldCtqc29uJyk7XG4gICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCkudGhlbihcbiAgICAgICAgICAgICAgICAgIGp3a1NldCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgc3VwcG9zZWQgdG8gYmUgYSBKU09OIFdlYiBLZXkgU2V0LCBhcyBkZWZpbmVkIGluXG4gICAgICAgICAgICAgICAgICAgIC8vIFNlY3Rpb24gNSBvZiBSRkMgNzUxNy4gSG93ZXZlciwgdGhlIHNpZ25pbmcgc2VydmljZSBjb3VsZFxuICAgICAgICAgICAgICAgICAgICAvLyBtaXNiZWhhdmUgYW5kIHNlbmQgYW4gYXJiaXRyYXJ5IEpTT04gdmFsdWUsIHNvIHdlIGhhdmUgdG9cbiAgICAgICAgICAgICAgICAgICAgLy8gdHlwZS1jaGVjayBhdCBydW50aW1lLlxuICAgICAgICAgICAgICAgICAgICBpZiAoIWp3a1NldCB8fCAhaXNBcnJheShqd2tTZXRbJ2tleXMnXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICBzaWduaW5nU2VydmljZUVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzaWduaW5nU2VydmljZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGBLZXkgc2V0ICgke0pTT04uc3RyaW5naWZ5KGp3a1NldCl9KSBoYXMgbm8gXCJrZXlzXCJgKTtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgandrU2V0WydrZXlzJ10uZm9yRWFjaChqd2sgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgIGlmICghandrIHx8IHR5cGVvZiBqd2tbJ2tpZCddICE9ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduaW5nU2VydmljZUVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25pbmdTZXJ2aWNlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgS2V5ICgke0pTT04uc3RyaW5naWZ5KGp3ayl9KSBoYXMgbm8gXCJraWRcImApO1xuICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5c1tqd2tbJ2tpZCddXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlbid0IHNlZW4gdGhpcyBrZXlwYWlyIElEIGJlZm9yZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGtleXNbandrWydraWQnXV0gPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNlcnZpY2VzLmNyeXB0b0Zvcih0aGlzLndpbl8pLmltcG9ydFBrY3NLZXkoandrKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZWIgQ3J5cHRvZ3JhcGh5IHJlamVjdGVkIHRoZSBrZXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbXBvcnQgYXR0ZW1wdC4gRWl0aGVyIHRoZSBzaWduaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VydmljZSBzZW50IGEgbWFsZm9ybWVkIGtleSBvciB0aGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBicm93c2VyIGlzIGRvaW5nIHNvbWV0aGluZyB3ZWlyZC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBqd2tEYXRhID0gSlNPTi5zdHJpbmdpZnkoandrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gZXJyICYmIGVyci5tZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25pbmdTZXJ2aWNlRXJyb3IoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25pbmdTZXJ2aWNlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYEZhaWxlZCB0byBpbXBvcnQga2V5ICgke1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3a0RhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk6ICR7bWVzc2FnZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgZXJyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHNpZ25pbmcgc2VydmljZSBkaWRuJ3Qgc2VuZCB2YWxpZCBKU09OLlxuICAgICAgICAgICAgICAgICAgICBzaWduaW5nU2VydmljZUVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmluZ1NlcnZpY2VOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgYEZhaWxlZCB0byBwYXJzZSBKU09OOiAke2VyciAmJiBlcnIucmVzcG9uc2V9YCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVyciA9PiB7XG4gICAgICAgICAgICAgIC8vIFNvbWUga2luZCBvZiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgdGhlIFhIUi4gVGhpcyBjb3VsZCBiZSBhIGxvdFxuICAgICAgICAgICAgICAvLyBvZiB0aGluZ3MgKGFuZCB3ZSBoYXZlIG5vIHR5cGUgaW5mb3JtYXRpb24pLCBidXQgaWYgdGhlcmUncyBub1xuICAgICAgICAgICAgICAvLyBgcmVzcG9uc2VgIGl0J3MgcHJvYmFibHkgYSBuZXR3b3JrIGNvbm5lY3Rpdml0eSBmYWlsdXJlLCBzbyB3ZVxuICAgICAgICAgICAgICAvLyBpZ25vcmUgaXQuIFVuZm9ydHVuYXRlbHksIHdlIGNhbid0IGRpc3Rpbmd1aXNoIHRoaXMgZnJvbSBhIENPUlNcbiAgICAgICAgICAgICAgLy8gcHJvYmxlbS5cbiAgICAgICAgICAgICAgaWYgKGVyciAmJiBlcnIucmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIHByb2JhYmx5IGluZGljYXRlcyBhIG5vbi0yeHggSFRUUCBzdGF0dXMgY29kZS5cbiAgICAgICAgICAgICAgICBzaWduaW5nU2VydmljZUVycm9yKFxuICAgICAgICAgICAgICAgICAgICBzaWduaW5nU2VydmljZU5hbWUsIGBTdGF0dXMgY29kZSAke2Vyci5yZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gIH1cbn1cblxuLyoqXG4gKiBSZXBvcnQgYW4gZXJyb3IgY2F1c2VkIGJ5IGEgc2lnbmluZyBzZXJ2aWNlLiBTaW5jZSBzaWduaW5nIHNlcnZpY2VzIGN1cnJlbnRseVxuICogZG9uJ3QgaGF2ZSB0aGVpciBvd24gZXJyb3IgbG9nZ2luZyBVUkxzLCB3ZSBqdXN0IHNlbmQgZXZlcnl0aGluZyB0byB0aGUgQU1QXG4gKiBQcm9qZWN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBzaWduaW5nU2VydmljZU5hbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBzaWduaW5nU2VydmljZUVycm9yKHNpZ25pbmdTZXJ2aWNlTmFtZSwgbWVzc2FnZSkge1xuICBkZXYoKS5lcnJvcihcbiAgICAgICdBTVAtQTRBJywgYFNpZ25pbmcgc2VydmljZSBlcnJvciBmb3IgJHtzaWduaW5nU2VydmljZU5hbWV9OiAke21lc3NhZ2V9YCk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLy8gQmVjYXVzZSBBZFNlbnNlIGFuZCBEb3VibGVDbGljayBhcmUgYm90aCBvcGVyYXRlZCBieSBHb29nbGUgYW5kIHRoZWlyIEE0QVxuLy8gaW1wbGVtZW50YXRpb25zIHNoYXJlIHNvbWUgYmVoYXZpb3IgaW4gY29tbW9uLCBwYXJ0IG9mIHRoZSBsb2dpYyBmb3IgdGhpc1xuLy8gaW1wbGVtZW50YXRpb24gaXMgbG9jYXRlZCBpbiB0aGUgYWRzL2dvb2dsZS9hNGEgZGlyZWN0b3J5IHJhdGhlciB0aGFuIGhlcmUuXG4vLyBNb3N0IG90aGVyIGFkIG5ldHdvcmtzIHdpbGwgd2FudCB0byBwdXQgdGhlaXIgQTRBIGNvZGUgZW50aXJlbHkgaW4gdGhlXG4vLyBleHRlbnNpb25zL2FtcC1hZC1uZXR3b3JrLSR7TkVUV09SS19OQU1FfS1pbXBsIGRpcmVjdG9yeS5cblxuaW1wb3J0IHtcbiAgTUFOVUFMX0VYUEVSSU1FTlRfSUQsXG4gIGFkZEV4cGVyaW1lbnRJZFRvRWxlbWVudCxcbiAgZXh0cmFjdFVybEV4cGVyaW1lbnRJZCxcbn0gZnJvbSAnLi4vLi4vLi4vYWRzL2dvb2dsZS9hNGEvdHJhZmZpYy1leHBlcmltZW50cyc7XG5pbXBvcnQge2Rldn0gZnJvbSAnLi4vLi4vLi4vc3JjL2xvZyc7XG5pbXBvcnQge1xuICBmb3JjZUV4cGVyaW1lbnRCcmFuY2gsXG4gIGdldEV4cGVyaW1lbnRCcmFuY2gsXG59IGZyb20gJy4uLy4uLy4uL3NyYy9leHBlcmltZW50cyc7XG5pbXBvcnQge1xuICBpc0NkblByb3h5LFxuICBpc0dvb2dsZUFkc0E0QVZhbGlkRW52aXJvbm1lbnQsXG59IGZyb20gJy4uLy4uLy4uL2Fkcy9nb29nbGUvYTRhL3V0aWxzJztcbmltcG9ydCB7c2VsZWN0QW5kU2V0RXhwZXJpbWVudHN9IGZyb20gJy4uLy4uLy4uL2Fkcy9nb29nbGUvYTRhL2V4cGVyaW1lbnQtdXRpbHMnO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9IEB2aXNpYmxlRm9yVGVzdGluZyAqL1xuZXhwb3J0IGNvbnN0IEFEU0VOU0VfQTRBX0VYUEVSSU1FTlRfTkFNRSA9ICdleHBBZHNlbnNlQTRBJztcblxuLyoqIEB0eXBlIHtzdHJpbmd9ICovXG5jb25zdCBUQUcgPSAnYW1wLWFkLW5ldHdvcmstYWRzZW5zZS1pbXBsJztcblxuLyoqIEBjb25zdCBAdHlwZSB7IU9iamVjdDxzdHJpbmcsP3N0cmluZz59ICovXG5leHBvcnQgY29uc3QgVVJMX0VYUEVSSU1FTlRfTUFQUElORyA9IHtcbiAgJy0xJzogTUFOVUFMX0VYUEVSSU1FTlRfSUQsXG4gICcwJzogbnVsbCxcbn07XG5cbi8qKiBAY29uc3QgQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSAqL1xuZXhwb3J0IGNvbnN0IEFEU0VOU0VfRVhQRVJJTUVOVFMgPSB7XG4gIFVOQ09ORElUSU9ORURfQ0FOT05JQ0FMX0VYUDogJzIxMDYyMTU0JyxcbiAgVU5DT05ESVRJT05FRF9DQU5PTklDQUxfQ1RMOiAnMjEwNjIxNTUnLFxuICBDQU5PTklDQUxfRVhQOiAnMjEwNjIxNTgnLFxuICBDQU5PTklDQUxfQ1RMOiAnMjEwNjIxNTknLFxufTtcblxuLyoqIEBjb25zdCBAdHlwZSB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59ICovXG5leHBvcnQgY29uc3QgQURTRU5TRV9FWFBfTkFNRVMgPSB7XG4gIFVOQ09ORElUSU9ORURfQ0FOT05JQ0FMOiAnZXhwQWRzZW5zZVVuY29uZGl0aW9uZWRDYW5vbmljYWwnLFxuICBDQU5PTklDQUw6ICdleHBBZHNlbnNlQ2Fub25pY2FsJyxcbn07XG5cbi8qKlxuICogQXR0ZW1wdHMgdG8gc2VsZWN0IGludG8gQWRzZW5zZSBleHBlcmltZW50cy5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKi9cbmZ1bmN0aW9uIHNlbGVjdEV4cGVyaW1lbnRzKHdpbiwgZWxlbWVudCkge1xuICBzZWxlY3RBbmRTZXRFeHBlcmltZW50cyh3aW4sIGVsZW1lbnQsXG4gICAgICBbQURTRU5TRV9FWFBFUklNRU5UUy5VTkNPTkRJVElPTkVEX0NBTk9OSUNBTF9FWFAsXG4gICAgICAgIEFEU0VOU0VfRVhQRVJJTUVOVFMuVU5DT05ESVRJT05FRF9DQU5PTklDQUxfQ1RMXSxcbiAgICAgIEFEU0VOU0VfRVhQX05BTUVTLlVOQ09ORElUSU9ORURfQ0FOT05JQ0FMLFxuICAgICAgdHJ1ZSk7XG5cblxuICAvLyBTZWUgaWYgaW4gaG9sZGJhY2sgY29udHJvbC9leHBlcmltZW50LlxuICBjb25zdCB1cmxFeHBlcmltZW50SWQgPSBleHRyYWN0VXJsRXhwZXJpbWVudElkKHdpbiwgZWxlbWVudCk7XG4gIGNvbnN0IGV4cGVyaW1lbnRJZCA9IFVSTF9FWFBFUklNRU5UX01BUFBJTkdbdXJsRXhwZXJpbWVudElkIHx8ICcnXTtcbiAgaWYgKGV4cGVyaW1lbnRJZCkge1xuICAgIGFkZEV4cGVyaW1lbnRJZFRvRWxlbWVudChleHBlcmltZW50SWQsIGVsZW1lbnQpO1xuICAgIGZvcmNlRXhwZXJpbWVudEJyYW5jaCh3aW4sIEFEU0VOU0VfQTRBX0VYUEVSSU1FTlRfTkFNRSwgZXhwZXJpbWVudElkKTtcbiAgICBkZXYoKS5pbmZvKFxuICAgICAgICBUQUcsIGB1cmwgZXhwZXJpbWVudCBzZWxlY3Rpb24gJHt1cmxFeHBlcmltZW50SWR9OiAke2V4cGVyaW1lbnRJZH0uYCk7XG4gIH1cblxuICAvLyBJZiBub3QgaW4gdGhlIHVuY29uZGl0aW9uZWQgY2Fub25pY2FsIGV4cGVyaW1lbnQsIGF0dGVtcHQgdG9cbiAgLy8gc2VsZWN0IGludG8gdGhlIHVuZGlsdXRlZCBjYW5vbmljYWwgZXhwZXJpbWVudC5cbiAgY29uc3QgaW5VbmNvbmRpdGlvbmVkQ2Fub25pY2FsRXhwID0gISFnZXRFeHBlcmltZW50QnJhbmNoKFxuICAgICAgd2luLCBBRFNFTlNFX0VYUF9OQU1FUy5VTkNPTkRJVElPTkVEX0NBTk9OSUNBTCk7XG4gIGlmICghaW5VbmNvbmRpdGlvbmVkQ2Fub25pY2FsRXhwICYmICFpc0NkblByb3h5KHdpbikpIHtcbiAgICBzZWxlY3RBbmRTZXRFeHBlcmltZW50cyh3aW4sIGVsZW1lbnQsXG4gICAgICAgIFtBRFNFTlNFX0VYUEVSSU1FTlRTLkNBTk9OSUNBTF9FWFAsXG4gICAgICAgICAgQURTRU5TRV9FWFBFUklNRU5UUy5DQU5PTklDQUxfQ1RMXSxcbiAgICAgICAgQURTRU5TRV9FWFBfTkFNRVMuQ0FOT05JQ0FMLCB0cnVlKTtcbiAgfVxufVxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge2Jvb2xlYW59IHVzZVJlbW90ZUh0bWxcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZHNlbnNlSXNBNEFFbmFibGVkKHdpbiwgZWxlbWVudCwgdXNlUmVtb3RlSHRtbCkge1xuICBpZiAodXNlUmVtb3RlSHRtbCB8fCAhZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtYWQtY2xpZW50JykpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgc2VsZWN0RXhwZXJpbWVudHMod2luLCBlbGVtZW50KTtcbiAgcmV0dXJuIGlzR29vZ2xlQWRzQTRBVmFsaWRFbnZpcm9ubWVudCh3aW4pIHx8XG4gICAgICBnZXRFeHBlcmltZW50QnJhbmNoKFxuICAgICAgICAgIHdpbiwgQURTRU5TRV9FWFBfTkFNRVMuVU5DT05ESVRJT05FRF9DQU5PTklDQUwpID09XG4gICAgICBBRFNFTlNFX0VYUEVSSU1FTlRTLlVOQ09ORElUSU9ORURfQ0FOT05JQ0FMX0VYUCB8fFxuICAgICAgZ2V0RXhwZXJpbWVudEJyYW5jaCh3aW4sIEFEU0VOU0VfRVhQX05BTUVTLkNBTk9OSUNBTCkgPT1cbiAgICAgIEFEU0VOU0VfRVhQRVJJTUVOVFMuQ0FOT05JQ0FMX0VYUDtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIERldGVybWluZXMgd2hpY2ggdGFncyBkZXNpcmUgQTRBIGhhbmRsaW5nXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtib29sZWFufSB1c2VSZW1vdGVIdG1sXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2xvdWRmbGFyZUlzQTRBRW5hYmxlZCh3aW4sIGVsZW1lbnQsIHVzZVJlbW90ZUh0bWwpIHtcbiAgLy8gV2UgYXNzdW1lIGZhc3QgZmV0Y2ggZm9yIGFsbCBjb250ZW50LCBidXQgdGhpcyB3aWxsIGdyYWNlZnVsbHkgZGVncmFkZSxcbiAgLy8gd2hlbiBub24tYTRhIGNvbnRlbnQgaXMgZGVsaXZlcmVkXG4gIHJldHVybiAhdXNlUmVtb3RlSHRtbDtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vLyBCZWNhdXNlIEFkU2Vuc2UgYW5kIERvdWJsZUNsaWNrIGFyZSBib3RoIG9wZXJhdGVkIGJ5IEdvb2dsZSBhbmQgdGhlaXIgQTRBXG4vLyBpbXBsZW1lbnRhdGlvbnMgc2hhcmUgc29tZSBiZWhhdmlvciBpbiBjb21tb24sIHBhcnQgb2YgdGhlIGxvZ2ljIGZvciB0aGlzXG4vLyBpbXBsZW1lbnRhdGlvbiBpcyBsb2NhdGVkIGluIHRoZSBhZHMvZ29vZ2xlL2E0YSBkaXJlY3RvcnkgcmF0aGVyIHRoYW4gaGVyZS5cbi8vIE1vc3Qgb3RoZXIgYWQgbmV0d29ya3Mgd2lsbCB3YW50IHRvIHB1dCB0aGVpciBBNEEgY29kZSBlbnRpcmVseSBpbiB0aGVcbi8vIGV4dGVuc2lvbnMvYW1wLWFkLW5ldHdvcmstJHtORVRXT1JLX05BTUV9LWltcGwgZGlyZWN0b3J5LlxuXG5pbXBvcnQgJy4uLy4uL2FtcC1hNGEvMC4xL3JlYWwtdGltZS1jb25maWctbWFuYWdlcic7XG5pbXBvcnQge1xuICBBbXBBNEEsXG4gIERFRkFVTFRfU0FGRUZSQU1FX1ZFUlNJT04sXG4gIFhPUklHSU5fTU9ERSxcbiAgYXNzaWduQWRVcmxUb0Vycm9yLFxufSBmcm9tICcuLi8uLi9hbXAtYTRhLzAuMS9hbXAtYTRhJztcbmltcG9ydCB7XG4gIEFtcEFuYWx5dGljc0NvbmZpZ0RlZixcbiAgUVFJRF9IRUFERVIsXG4gIFZhbGlkQWRDb250YWluZXJUeXBlcyxcbiAgYWRkQ3NpU2lnbmFsc1RvQW1wQW5hbHl0aWNzQ29uZmlnLFxuICBleHRyYWN0QW1wQW5hbHl0aWNzQ29uZmlnLFxuICBnZXRDc2lBbXBBbmFseXRpY3NDb25maWcsXG4gIGdldENzaUFtcEFuYWx5dGljc1ZhcmlhYmxlcyxcbiAgZ2V0RW5jbG9zaW5nQ29udGFpbmVyVHlwZXMsXG4gIGdldElkZW50aXR5VG9rZW4sXG4gIGdvb2dsZUFkVXJsLFxuICBnb29nbGVCbG9ja1BhcmFtZXRlcnMsXG4gIGdvb2dsZVBhZ2VQYXJhbWV0ZXJzLFxuICBncm91cEFtcEFkc0J5VHlwZSxcbiAgaXNDZG5Qcm94eSxcbiAgaXNSZXBvcnRpbmdFbmFibGVkLFxuICBtYXliZUFwcGVuZEVycm9yUGFyYW1ldGVyLFxuICB0cnVuY0FuZFRpbWVVcmwsXG59IGZyb20gJy4uLy4uLy4uL2Fkcy9nb29nbGUvYTRhL3V0aWxzJztcbmltcG9ydCB7Q09OU0VOVF9QT0xJQ1lfU1RBVEV9IGZyb20gJy4uLy4uLy4uL3NyYy9jb25zZW50LXN0YXRlJztcbmltcG9ydCB7RGVmZXJyZWR9IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9wcm9taXNlJztcbmltcG9ydCB7TGF5b3V0LCBpc0xheW91dFNpemVEZWZpbmVkfSBmcm9tICcuLi8uLi8uLi9zcmMvbGF5b3V0JztcbmltcG9ydCB7TmF2aWdhdGlvbn0gZnJvbSAnLi4vLi4vLi4vc3JjL3NlcnZpY2UvbmF2aWdhdGlvbic7XG5pbXBvcnQge1JUQ19WRU5ET1JTfSBmcm9tICcuLi8uLi9hbXAtYTRhLzAuMS9jYWxsb3V0LXZlbmRvcnMnO1xuaW1wb3J0IHtcbiAgUmVmcmVzaE1hbmFnZXIsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgZ2V0UmVmcmVzaE1hbmFnZXIsXG59IGZyb20gJy4uLy4uL2FtcC1hNGEvMC4xL3JlZnJlc2gtbWFuYWdlcic7XG5pbXBvcnQge1NhZmVmcmFtZUhvc3RBcGl9IGZyb20gJy4vc2FmZWZyYW1lLWhvc3QnO1xuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi4vLi4vLi4vc3JjL3NlcnZpY2VzJztcbmltcG9ydCB7XG4gIFRGQ0QsXG4gIGNvbnN0cnVjdFNSQUJsb2NrUGFyYW1ldGVycyxcbiAgc2VyaWFsaXplVGFyZ2V0aW5nLFxuICBzcmFCbG9ja0NhbGxiYWNrSGFuZGxlcixcbn0gZnJvbSAnLi9zcmEtdXRpbHMnO1xuaW1wb3J0IHtjcmVhdGVFbGVtZW50V2l0aEF0dHJpYnV0ZXMsIHJlbW92ZUVsZW1lbnR9IGZyb20gJy4uLy4uLy4uL3NyYy9kb20nO1xuaW1wb3J0IHtkZWVwTWVyZ2UsIGRpY3R9IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtkZXYsIHVzZXJ9IGZyb20gJy4uLy4uLy4uL3NyYy9sb2cnO1xuaW1wb3J0IHtkb21GaW5nZXJwcmludFBsYWlufSBmcm9tICcuLi8uLi8uLi9zcmMvdXRpbHMvZG9tLWZpbmdlcnByaW50JztcbmltcG9ydCB7Z2V0TW9kZX0gZnJvbSAnLi4vLi4vLi4vc3JjL21vZGUnO1xuaW1wb3J0IHtnZXRNdWx0aVNpemVEaW1lbnNpb25zfSBmcm9tICcuLi8uLi8uLi9hZHMvZ29vZ2xlL3V0aWxzJztcbmltcG9ydCB7Z2V0T3JDcmVhdGVBZENpZH0gZnJvbSAnLi4vLi4vLi4vc3JjL2FkLWNpZCc7XG5pbXBvcnQge1xuICBpbmNyZW1lbnRMb2FkaW5nQWRzLFxuICBpczNwVGhyb3R0bGVkLFxuICB3YWl0Rm9yM3BUaHJvdHRsZSxcbn0gZnJvbSAnLi4vLi4vYW1wLWFkLzAuMS9jb25jdXJyZW50LWxvYWQnO1xuaW1wb3J0IHtpbnNlcnRBbmFseXRpY3NFbGVtZW50fSBmcm9tICcuLi8uLi8uLi9zcmMvZXh0ZW5zaW9uLWFuYWx5dGljcyc7XG5pbXBvcnQge2lzQ2FuY2VsbGF0aW9ufSBmcm9tICcuLi8uLi8uLi9zcmMvZXJyb3InO1xuaW1wb3J0IHtpc0V4cGVyaW1lbnRPbn0gZnJvbSAnLi4vLi4vLi4vc3JjL2V4cGVyaW1lbnRzJztcbmltcG9ydCB7XG4gIGlzSW5NYW51YWxFeHBlcmltZW50LFxufSBmcm9tICcuLi8uLi8uLi9hZHMvZ29vZ2xlL2E0YS90cmFmZmljLWV4cGVyaW1lbnRzJztcbmltcG9ydCB7XG4gIGxpbmVEZWxpbWl0ZWRTdHJlYW1lcixcbiAgbWV0YUpzb25DcmVhdGl2ZUdyb3VwZXIsXG59IGZyb20gJy4uLy4uLy4uL2Fkcy9nb29nbGUvYTRhL2xpbmUtZGVsaW1pdGVkLXJlc3BvbnNlLWhhbmRsZXInO1xuaW1wb3J0IHtwYXJzZVF1ZXJ5U3RyaW5nfSBmcm9tICcuLi8uLi8uLi9zcmMvdXJsJztcbmltcG9ydCB7cmFuZG9tbHlTZWxlY3RVbnNldEV4cGVyaW1lbnRzfSBmcm9tICcuLi8uLi8uLi9zcmMvZXhwZXJpbWVudHMnO1xuaW1wb3J0IHtzZXRTdHlsZXN9IGZyb20gJy4uLy4uLy4uL3NyYy9zdHlsZSc7XG5pbXBvcnQge3N0cmluZ0hhc2gzMn0gZnJvbSAnLi4vLi4vLi4vc3JjL3N0cmluZyc7XG5pbXBvcnQge3RyeVBhcnNlSnNvbn0gZnJvbSAnLi4vLi4vLi4vc3JjL2pzb24nO1xuXG4vKiogQHR5cGUge3N0cmluZ30gKi9cbmNvbnN0IFRBRyA9ICdhbXAtYWQtbmV0d29yay1kb3VibGVjbGljay1pbXBsJztcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgRE9VQkxFQ0xJQ0tfQkFTRV9VUkwgPVxuICAgICdodHRwczovL3NlY3VyZXB1YmFkcy5nLmRvdWJsZWNsaWNrLm5ldC9nYW1wYWQvYWRzJztcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgUlRDX1NVQ0NFU1MgPSAnMic7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmNvbnN0IERPVUJMRUNMSUNLX1NSQV9FWFAgPSAnZG91YmxlY2xpY2tTcmFFeHAnO1xuXG4vKiogQGNvbnN0IEBlbnVte3N0cmluZ30gKi9cbmNvbnN0IERPVUJMRUNMSUNLX1NSQV9FWFBfQlJBTkNIRVMgPSB7XG4gIFNSQV9DT05UUk9MOiAnMTE3MTUyNjY2JyxcbiAgU1JBOiAnMTE3MTUyNjY3JyxcbiAgU1JBX05PX1JFQ09WRVI6ICcyMTA2MjIzNScsXG59O1xuXG4vKipcbiAqIE1hcCBvZiBwYWdldmlldyB0b2tlbnMgdG8gdGhlIGluc3RhbmNlcyB0aGV5IGJlbG9uZyB0by5cbiAqIEBwcml2YXRlIHshT2JqZWN0PHN0cmluZywgIUFtcEFkTmV0d29ya0RvdWJsZWNsaWNrSW1wbD59XG4gKi9cbmxldCB0b2tlbnNUb0luc3RhbmNlcyA9IHt9O1xuXG4vKiogQHByaXZhdGUgez9Qcm9taXNlfSAqL1xubGV0IHNyYVJlcXVlc3RzID0gbnVsbDtcblxuLyoqIEB0eXBlZGVmIHt7XG4gICAgICBhZFVybDogIVByb21pc2U8c3RyaW5nPixcbiAgICAgIGxpbmVJdGVtSWQ6IHN0cmluZyxcbiAgICAgIGNyZWF0aXZlSWQ6IHN0cmluZyxcbiAgICAgIHNsb3RJZDogc3RyaW5nLFxuICAgICAgc2xvdEluZGV4OiBzdHJpbmcsXG4gICAgfX0gKi9cbmxldCBUcm91Ymxlc2hvb3REYXRhRGVmO1xuXG4vKiogQHByaXZhdGUgez9Kc29uT2JqZWN0fSAqL1xubGV0IHdpbmRvd0xvY2F0aW9uUXVlcnlQYXJhbWV0ZXJzO1xuXG4vKipcbiAqIEB0eXBlZGVmXG4gKiB7KHt3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcn18Li4vLi4vLi4vc3JjL2xheW91dC1yZWN0LkxheW91dFJlY3REZWYpfVxuICovXG5sZXQgTGF5b3V0UmVjdE9yRGltc0RlZjtcblxuLyoqIEBmaW5hbCAqL1xuZXhwb3J0IGNsYXNzIEFtcEFkTmV0d29ya0RvdWJsZWNsaWNrSW1wbCBleHRlbmRzIEFtcEE0QSB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAgICovXG4gIGNvbnN0cnVjdG9yKGVsZW1lbnQpIHtcbiAgICBzdXBlcihlbGVtZW50KTtcblxuICAgIC8qKlxuICAgICAqIENvbmZpZyB0byBnZW5lcmF0ZSBhbXAtYW5hbHl0aWNzIGVsZW1lbnQgZm9yIGFjdGl2ZSB2aWV3IHJlcG9ydGluZy5cbiAgICAgKiBAdHlwZSB7P0pzb25PYmplY3R9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLmFtcEFuYWx5dGljc0NvbmZpZ18gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHshLi4vLi4vLi4vc3JjL3NlcnZpY2UvZXh0ZW5zaW9ucy1pbXBsLkV4dGVuc2lvbnN9ICovXG4gICAgdGhpcy5leHRlbnNpb25zXyA9IFNlcnZpY2VzLmV4dGVuc2lvbnNGb3IodGhpcy53aW4pO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/c3RyaW5nfSAqL1xuICAgIHRoaXMucXFpZF8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/TGF5b3V0UmVjdE9yRGltc0RlZn0gKi9cbiAgICB0aGlzLmluaXRpYWxTaXplXyA9IG51bGw7XG5cbiAgICAvKiogQHR5cGUgez9zdHJpbmd9ICovXG4gICAgdGhpcy5wYXJhbWV0ZXJTaXplID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P3t3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcn19ICovXG4gICAgdGhpcy5yZXR1cm5lZFNpemVfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P0VsZW1lbnR9ICovXG4gICAgdGhpcy5hbXBBbmFseXRpY3NFbGVtZW50XyA9IG51bGw7XG5cbiAgICAvKiogQHR5cGUgez9PYmplY3Q8c3RyaW5nLCo+fSovXG4gICAgdGhpcy5qc29uVGFyZ2V0aW5nID0gbnVsbDtcblxuICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMuYWRLZXkgPSAwO1xuXG4gICAgLyoqIEB0eXBlIHshQXJyYXk8c3RyaW5nPn0gKi9cbiAgICB0aGlzLmV4cGVyaW1lbnRJZHMgPSBbXTtcblxuICAgIC8qKiBAcHJvdGVjdGVkIHtib29sZWFufSAqL1xuICAgIHRoaXMudXNlU3JhID0gZmFsc2U7XG5cbiAgICAvKiogQHByb3RlY3RlZCB7IURlZmVycmVkPD8uLi8uLi8uLi9zcmMvdXRpbHMveGhyLXV0aWxzLkZldGNoUmVzcG9uc2U+fSAqL1xuICAgIHRoaXMuc3JhRGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P1JlZnJlc2hNYW5hZ2VyfSAqL1xuICAgIHRoaXMucmVmcmVzaE1hbmFnZXJfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMucmVmcmVzaENvdW50XyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLmlmaV8gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuaXNGbHVpZFJlcXVlc3RfID0gZmFsc2U7XG5cbiAgICAvKiogQHByaXZhdGUgez9zdHJpbmd9ICovXG4gICAgdGhpcy5mbHVpZEltcHJlc3Npb25VcmxfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P1Byb21pc2U8IS4uLy4uLy4uL2Fkcy9nb29nbGUvYTRhL3V0aWxzLklkZW50aXR5VG9rZW4+fSAqL1xuICAgIHRoaXMuaWRlbnRpdHlUb2tlblByb21pc2VfID0gbnVsbDtcblxuICAgIC8qKiBAdHlwZSB7Py4uLy4uLy4uL2Fkcy9nb29nbGUvYTRhL3V0aWxzLklkZW50aXR5VG9rZW59ICovXG4gICAgdGhpcy5pZGVudGl0eVRva2VuID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IVRyb3VibGVzaG9vdERhdGFEZWZ9ICovXG4gICAgdGhpcy50cm91Ymxlc2hvb3REYXRhXyA9IC8qKiBAdHlwZSB7IVRyb3VibGVzaG9vdERhdGFEZWZ9ICovICh7fSk7XG5cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZSB7P2Jvb2xlYW59IHdoZXRoZXIgcHJlZmVyZW50aWFsIHJlbmRlcmVkIEFNUCBjcmVhdGl2ZSwgbnVsbFxuICAgICAqIGluZGljYXRlcyBubyBjcmVhdGl2ZSByZW5kZXIuXG4gICAgICovXG4gICAgdGhpcy5pc0FtcENyZWF0aXZlXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy5pc0lkbGVSZW5kZXJfID0gZmFsc2U7XG5cbiAgICAvKiogQHByaXZhdGUgez8uL3NhZmVmcmFtZS1ob3N0LlNhZmVmcmFtZUhvc3RBcGl9ICovXG4gICAgdGhpcy5zYWZlZnJhbWVBcGlfID0gbnVsbDtcblxuICAgIC8qKiBAdHlwZSB7Ym9vbGVhbn0gd2hldGhlciBzYWZlZnJhbWUgZm9yY2VkIHZpYSB0YWcgKi9cbiAgICB0aGlzLmZvcmNlU2FmZWZyYW1lID0gZmFsc2U7XG4gICAgaWYgKCdmb3JjZVNhZmVmcmFtZScgaW4gdGhpcy5lbGVtZW50LmRhdGFzZXQpIHtcbiAgICAgIGlmICghL14oMXwodHJ1ZSkpJC9pLnRlc3QodGhpcy5lbGVtZW50LmRhdGFzZXRbJ2ZvcmNlU2FmZWZyYW1lJ10pKSB7XG4gICAgICAgIHVzZXIoKS53YXJuKFRBRywgJ0lnbm9yaW5nIGludmFsaWQgZGF0YS1mb3JjZS1zYWZlZnJhbWUgYXR0cmlidXRlOiAnICtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kYXRhc2V0Wydmb3JjZVNhZmVmcmFtZSddKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZm9yY2VTYWZlZnJhbWUgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBAcHJvdGVjdGVkIHs/Q09OU0VOVF9QT0xJQ1lfU1RBVEV9ICovXG4gICAgdGhpcy5jb25zZW50U3RhdGUgPSBudWxsO1xuXG4gICAgLyoqIEBwcm90ZWN0ZWQgeyFEZWZlcnJlZDxzdHJpbmc+fSAqL1xuICAgIHRoaXMuZ2V0QWRVcmxEZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge251bWJlcnxib29sZWFufSByZW5kZXIgb24gaWRsZSBjb25maWd1cmF0aW9uIHdpdGggZmFsc2VcbiAgICogICAgaW5kaWNhdGluZyBkaXNhYmxlZC5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdldElkbGVSZW5kZXJFbmFibGVkXygpIHtcbiAgICBpZiAodGhpcy5pc0lkbGVSZW5kZXJfKSB7XG4gICAgICByZXR1cm4gdGhpcy5pc0lkbGVSZW5kZXJfO1xuICAgIH1cbiAgICAvLyBEaXNhYmxlIGlmIHB1Ymxpc2hlciBoYXMgaW5kaWNhdGVkIGEgbm9uLWRlZmF1bHQgbG9hZGluZyBzdHJhdGVneS5cbiAgICBpZiAodGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1sb2FkaW5nLXN0cmF0ZWd5JykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY29uc3QgZXhwVmFsID0gdGhpcy5wb3N0QWRSZXNwb25zZUV4cGVyaW1lbnRGZWF0dXJlc1sncmVuZGVyLWlkbGUtdnAnXTtcbiAgICBjb25zdCB2cFJhbmdlID0gcGFyc2VJbnQoZXhwVmFsLCAxMCk7XG4gICAgaWYgKGV4cFZhbCAmJiBpc05hTih2cFJhbmdlKSkge1xuICAgICAgLy8gaG9sZGJhY2sgYnJhbmNoIHNlbmRzIG5vbi1udW1lcmljIHZhbHVlLlxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdnBSYW5nZSB8fCAxMjtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgaWRsZVJlbmRlck91dHNpZGVWaWV3cG9ydCgpIHtcbiAgICBjb25zdCB2cFJhbmdlID0gdGhpcy5nZXRJZGxlUmVuZGVyRW5hYmxlZF8oKTtcbiAgICBpZiAodnBSYW5nZSA9PT0gZmFsc2UpIHtcbiAgICAgIHJldHVybiB2cFJhbmdlO1xuICAgIH1cbiAgICB0aGlzLmlzSWRsZVJlbmRlcl8gPSB0cnVlO1xuICAgIC8vIE5PVEUoa2VpdGh3cmlnaHRib3MpOiBoYW5kbGUgcmFjZSBjb25kaXRpb24gd2hlcmUgcHJldmlvdXNcbiAgICAvLyBpZGxlUmVuZGVyT3V0c2lkZVZpZXdwb3J0IG1hcmtlZCBzbG90IGFzIGlkbGUgcmVuZGVyIGRlc3BpdGUgbmV2ZXJcbiAgICAvLyBiZWluZyBzY2hlZHVsZSBkdWUgdG8gYmVpbmcgYmV5b25kIHZpZXdwb3J0IG1heCBvZmZzZXQuICBJZiBzbG90XG4gICAgLy8gY29tZXMgd2l0aGluIHN0YW5kYXJkIG91dHNpZGUgdmlld3BvcnQgcmFuZ2UsIHRoZW4gZW5zdXJlIHRocm90dGxpbmdcbiAgICAvLyB3aWxsIG5vdCBiZSBhcHBsaWVkLlxuICAgIHRoaXMuZ2V0UmVzb3VyY2UoKS53aGVuV2l0aGluVmlld3BvcnQodGhpcy5yZW5kZXJPdXRzaWRlVmlld3BvcnQoKSkudGhlbihcbiAgICAgICAgKCkgPT4gdGhpcy5pc0lkbGVSZW5kZXJfID0gZmFsc2UpO1xuICAgIHJldHVybiB2cFJhbmdlO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBpc0xheW91dFN1cHBvcnRlZChsYXlvdXQpIHtcbiAgICB0aGlzLmlzRmx1aWRSZXF1ZXN0XyA9IGxheW91dCA9PSBMYXlvdXQuRkxVSUQ7XG4gICAgcmV0dXJuIHRoaXMuaXNGbHVpZFJlcXVlc3RfIHx8IGlzTGF5b3V0U2l6ZURlZmluZWQobGF5b3V0KTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgaXNWYWxpZEVsZW1lbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNBbXBBZEVsZW1lbnQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeGVjdXRlcyBwYWdlIGxldmVsIGV4cGVyaW1lbnQgZGl2ZXJzaW9uIGFuZCBwdXNoZXMgYW55IGV4cGVyaW1lbnQgSURzXG4gICAqIG9udG8gdGhpcy5leHBlcmltZW50SWRzLlxuICAgKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAgICovXG4gIHNldFBhZ2VMZXZlbEV4cGVyaW1lbnRzKCkge1xuICAgIGlmICghaXNDZG5Qcm94eSh0aGlzLndpbikgJiYgIWlzRXhwZXJpbWVudE9uKFxuICAgICAgICB0aGlzLndpbiwgJ2V4cERmcEludk9yaWdEZXByZWNhdGVkJykpIHtcbiAgICAgIHRoaXMuZXhwZXJpbWVudElkcy5wdXNoKCcyMTA2MDkzMycpO1xuICAgIH1cbiAgICBjb25zdCBleHBlcmltZW50SW5mb01hcCA9XG4gICAgLyoqIEB0eXBlIHshT2JqZWN0PHN0cmluZyxcbiAgICAgICAgIS4uLy4uLy4uL3NyYy9leHBlcmltZW50cy5FeHBlcmltZW50SW5mbz59ICovICh7XG4gICAgICAgIC8vIE9ubHkgc2VsZWN0IGludG8gU1JBIGV4cGVyaW1lbnRzIGlmIFNSQSBub3QgYWxyZWFkeSBleHBsaWNpdGx5XG4gICAgICAgIC8vIGVuYWJsZWQgYW5kIHJlZnJlc2ggaXMgbm90IGJlaW5nIHVzZWQgYnkgYW55IHNsb3QuXG4gICAgICAgIFtET1VCTEVDTElDS19TUkFfRVhQXToge1xuICAgICAgICAgIGlzVHJhZmZpY0VsaWdpYmxlOiAoKSA9PiAhdGhpcy53aW4uZG9jdW1lbnQuLypPSyovcXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgJ21ldGFbbmFtZT1hbXAtYWQtZW5hYmxlLXJlZnJlc2hdLCAnICtcbiAgICAgICAgICAgICAgJ2FtcC1hZFt0eXBlPWRvdWJsZWNsaWNrXVtkYXRhLWVuYWJsZS1yZWZyZXNoXSwgJyArXG4gICAgICAgICAgICAgICdtZXRhW25hbWU9YW1wLWFkLWRvdWJsZWNsaWNrLXNyYV0nKSxcbiAgICAgICAgICBicmFuY2hlczogT2JqZWN0LmtleXMoRE9VQkxFQ0xJQ0tfU1JBX0VYUF9CUkFOQ0hFUykubWFwKFxuICAgICAgICAgICAgICBrZXkgPT4gRE9VQkxFQ0xJQ0tfU1JBX0VYUF9CUkFOQ0hFU1trZXldKSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIGNvbnN0IHNldEV4cHMgPSB0aGlzLnJhbmRvbWx5U2VsZWN0VW5zZXRFeHBlcmltZW50c18oZXhwZXJpbWVudEluZm9NYXApO1xuICAgIE9iamVjdC5rZXlzKHNldEV4cHMpLmZvckVhY2goZXhwTmFtZSA9PlxuICAgICAgc2V0RXhwc1tleHBOYW1lXSAmJiB0aGlzLmV4cGVyaW1lbnRJZHMucHVzaChzZXRFeHBzW2V4cE5hbWVdKSk7XG4gIH1cblxuICAvKipcbiAgICogRm9yIGVhc2llciB1bml0IHRlc3RpbmcuXG4gICAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICEuLi8uLi8uLi9zcmMvZXhwZXJpbWVudHMuRXhwZXJpbWVudEluZm8+fSBleHBlcmltZW50SW5mb01hcFxuICAgKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn1cbiAgICovXG4gIHJhbmRvbWx5U2VsZWN0VW5zZXRFeHBlcmltZW50c18oZXhwZXJpbWVudEluZm9NYXApIHtcbiAgICByZXR1cm4gcmFuZG9tbHlTZWxlY3RVbnNldEV4cGVyaW1lbnRzKHRoaXMud2luLCBleHBlcmltZW50SW5mb01hcCk7XG4gIH1cblxuICAvKiogQHByaXZhdGUgKi9cbiAgbWF5YmVEZXByZWNhdGlvbldhcm5fKCkge1xuICAgIGNvbnN0IHdhcm5EZXByZWNhdGlvbiA9IGZlYXR1cmUgPT4gdXNlcigpLndhcm4oXG4gICAgICAgIFRBRywgYCR7ZmVhdHVyZX0gaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCBmb3IgRG91YmxlQ2xpY2suYCArXG4gICAgICAgICAgJ1BsZWFzZSByZWZlciB0byAnICtcbiAgICAgICAgICAnaHR0cHM6Ly9naXRodWIuY29tL2FtcHByb2plY3QvYW1waHRtbC9pc3N1ZXMvMTE4MzQgJyArXG4gICAgICAgICAgJ2ZvciBtb3JlIGluZm9ybWF0aW9uJyk7XG4gICAgY29uc3QgdXNkcmQgPSAndXNlU2FtZURvbWFpblJlbmRlcmluZ1VudGlsRGVwcmVjYXRlZCc7XG4gICAgY29uc3QgaGFzVVNEUkQgPSB1c2RyZCBpbiB0aGlzLmVsZW1lbnQuZGF0YXNldCB8fFxuICAgICAgICAgICh0cnlQYXJzZUpzb24odGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnanNvbicpKSB8fCB7fSlbdXNkcmRdO1xuICAgIGlmIChoYXNVU0RSRCkge1xuICAgICAgd2FybkRlcHJlY2F0aW9uKHVzZHJkKTtcbiAgICB9XG4gICAgY29uc3QgdXNlUmVtb3RlSHRtbCA9XG4gICAgICAhIXRoaXMud2luLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21ldGFbbmFtZT1hbXAtM3AtaWZyYW1lLXNyY10nKTtcbiAgICBpZiAodXNlUmVtb3RlSHRtbCkge1xuICAgICAgd2FybkRlcHJlY2F0aW9uKCdyZW1vdGUuaHRtbCcpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgYnVpbGRDYWxsYmFjaygpIHtcbiAgICBzdXBlci5idWlsZENhbGxiYWNrKCk7XG4gICAgdGhpcy5tYXliZURlcHJlY2F0aW9uV2Fybl8oKTtcbiAgICB0aGlzLnNldFBhZ2VMZXZlbEV4cGVyaW1lbnRzKCk7XG4gICAgdGhpcy51c2VTcmEgPSAoZ2V0TW9kZSgpLmxvY2FsRGV2ICYmIC8oXFw/fCYpZm9yY2Vfc3JhPXRydWUoJnwkKS8udGVzdChcbiAgICAgICAgdGhpcy53aW4ubG9jYXRpb24uc2VhcmNoKSkgfHxcbiAgICAgICAgISF0aGlzLndpbi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgJ21ldGFbbmFtZT1hbXAtYWQtZG91YmxlY2xpY2stc3JhXScpIHx8XG4gICAgICAgICEhdGhpcy5leHBlcmltZW50SWRzLmZpbHRlcihleHAgPT5cbiAgICAgICAgICBleHAgPT0gRE9VQkxFQ0xJQ0tfU1JBX0VYUF9CUkFOQ0hFUy5TUkEgfHxcbiAgICAgICAgICBleHAgPT0gRE9VQkxFQ0xJQ0tfU1JBX0VYUF9CUkFOQ0hFUy5TUkFfTk9fUkVDT1ZFUikubGVuZ3RoO1xuICAgIHRoaXMuaWRlbnRpdHlUb2tlblByb21pc2VfID0gU2VydmljZXMudmlld2VyRm9yRG9jKHRoaXMuZ2V0QW1wRG9jKCkpXG4gICAgICAgIC53aGVuRmlyc3RWaXNpYmxlKClcbiAgICAgICAgLnRoZW4oKCkgPT4gZ2V0SWRlbnRpdHlUb2tlbih0aGlzLndpbiwgdGhpcy5nZXRBbXBEb2MoKSkpO1xuICAgIHRoaXMudHJvdWJsZXNob290RGF0YV8uc2xvdElkID0gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1zbG90Jyk7XG4gICAgdGhpcy50cm91Ymxlc2hvb3REYXRhXy5zbG90SW5kZXggPVxuICAgICAgICB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWFtcC1zbG90LWluZGV4Jyk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHNob3VsZFByZWZlcmVudGlhbFJlbmRlcldpdGhvdXRDcnlwdG8oKSB7XG4gICAgZGV2KCkuYXNzZXJ0KCFpc0NkblByb3h5KHRoaXMud2luKSk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHs/Q09OU0VOVF9QT0xJQ1lfU1RBVEV9IGNvbnNlbnRTdGF0ZVxuICAgKiBAcGFyYW0geyFBcnJheTwhQW1wQWROZXR3b3JrRG91YmxlY2xpY2tJbXBsPj19IGluc3RhbmNlc1xuICAgKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZyxzdHJpbmd8Ym9vbGVhbnxudW1iZXI+fVxuICAgKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAgICovXG4gIGdldFBhZ2VQYXJhbWV0ZXJzKGNvbnNlbnRTdGF0ZSwgaW5zdGFuY2VzKSB7XG4gICAgaW5zdGFuY2VzID0gaW5zdGFuY2VzIHx8IFt0aGlzXTtcbiAgICByZXR1cm4ge1xuICAgICAgJ25wYSc6IGNvbnNlbnRTdGF0ZSA9PSBDT05TRU5UX1BPTElDWV9TVEFURS5JTlNVRkZJQ0lFTlQgfHxcbiAgICAgICAgICBjb25zZW50U3RhdGUgPT0gQ09OU0VOVF9QT0xJQ1lfU1RBVEUuVU5LTk9XTiA/IDEgOiBudWxsLFxuICAgICAgJ2dkZnBfcmVxJzogJzEnLFxuICAgICAgJ3Nmdic6IERFRkFVTFRfU0FGRUZSQU1FX1ZFUlNJT04sXG4gICAgICAndV9zZCc6IHRoaXMud2luLmRldmljZVBpeGVsUmF0aW8sXG4gICAgICAnZ2N0JzogdGhpcy5nZXRMb2NhdGlvblF1ZXJ5UGFyYW1ldGVyVmFsdWUoJ2dvb2dsZV9wcmV2aWV3JykgfHwgbnVsbCxcbiAgICAgICdwc3RzJzogZ2V0UGFnZXZpZXdTdGF0ZVRva2Vuc0ZvckFkUmVxdWVzdChpbnN0YW5jZXMpLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ29uc3RydWN0cyBibG9jay1sZXZlbCB1cmwgcGFyYW1ldGVycyB3aXRoIHNpZGUgZWZmZWN0IG9mIHNldHRpbmdcbiAgICogc2l6ZV8sIGpzb25UYXJnZXRpbmcsIGFuZCBhZEtleV8gZmllbGRzLlxuICAgKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZyxzdHJpbmd8Ym9vbGVhbnxudW1iZXI+fVxuICAgKi9cbiAgZ2V0QmxvY2tQYXJhbWV0ZXJzXygpIHtcbiAgICBkZXYoKS5hc3NlcnQodGhpcy5pbml0aWFsU2l6ZV8pO1xuICAgIGRldigpLmFzc2VydCh0aGlzLmpzb25UYXJnZXRpbmcpO1xuICAgIGNvbnN0IHRmY2QgPSB0aGlzLmpzb25UYXJnZXRpbmcgJiYgdGhpcy5qc29uVGFyZ2V0aW5nW1RGQ0RdO1xuICAgIHRoaXMud2luWydhbXBBZEdvb2dsZUlmaUNvdW50ZXInXSA9IHRoaXMud2luWydhbXBBZEdvb2dsZUlmaUNvdW50ZXInXSB8fCAxO1xuICAgIHRoaXMuaWZpXyA9ICh0aGlzLmlzUmVmcmVzaGluZyAmJiB0aGlzLmlmaV8pIHx8XG4gICAgICAgIHRoaXMud2luWydhbXBBZEdvb2dsZUlmaUNvdW50ZXInXSsrO1xuICAgIGNvbnN0IHBhZ2VMYXlvdXRCb3ggPSB0aGlzLmlzU2luZ2xlUGFnZVN0b3J5QWQgP1xuICAgICAgdGhpcy5lbGVtZW50LmdldFBhZ2VMYXlvdXRCb3goKSA6IG51bGw7XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe1xuICAgICAgJ2l1JzogdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1zbG90JyksXG4gICAgICAnY28nOiB0aGlzLmpzb25UYXJnZXRpbmcgJiZcbiAgICAgICAgICB0aGlzLmpzb25UYXJnZXRpbmdbJ2Nvb2tpZU9wdE91dCddID8gJzEnIDogbnVsbCxcbiAgICAgICdhZGsnOiB0aGlzLmFkS2V5LFxuICAgICAgJ3N6JzogdGhpcy5pc1NpbmdsZVBhZ2VTdG9yeUFkID8gJzF4MScgOiB0aGlzLnBhcmFtZXRlclNpemUsXG4gICAgICAnb3V0cHV0JzogJ2h0bWwnLFxuICAgICAgJ2ltcGwnOiAnaWZyJyxcbiAgICAgICd0ZmNkJzogdGZjZCA9PSB1bmRlZmluZWQgPyBudWxsIDogdGZjZCxcbiAgICAgICdhZHRlc3QnOiBpc0luTWFudWFsRXhwZXJpbWVudCh0aGlzLmVsZW1lbnQpID8gJ29uJyA6IG51bGwsXG4gICAgICAnaWZpJzogdGhpcy5pZmlfLFxuICAgICAgJ3JjJzogdGhpcy5yZWZyZXNoQ291bnRfIHx8IG51bGwsXG4gICAgICAnZnJjJzogTnVtYmVyKHRoaXMuZnJvbVJlc3VtZUNhbGxiYWNrKSB8fCBudWxsLFxuICAgICAgJ2ZsdWlkJzogdGhpcy5pc0ZsdWlkUmVxdWVzdF8gPyAnaGVpZ2h0JyA6IG51bGwsXG4gICAgICAnZnNmJzogdGhpcy5mb3JjZVNhZmVmcmFtZSA/ICcxJyA6IG51bGwsXG4gICAgICAnc2NwJzogc2VyaWFsaXplVGFyZ2V0aW5nKFxuICAgICAgICAgICh0aGlzLmpzb25UYXJnZXRpbmcgJiYgdGhpcy5qc29uVGFyZ2V0aW5nWyd0YXJnZXRpbmcnXSkgfHwgbnVsbCxcbiAgICAgICAgICAodGhpcy5qc29uVGFyZ2V0aW5nICYmXG4gICAgICAgICAgICB0aGlzLmpzb25UYXJnZXRpbmdbJ2NhdGVnb3J5RXhjbHVzaW9ucyddKSB8fCBudWxsKSxcbiAgICAgICdzcHNhJzogdGhpcy5pc1NpbmdsZVBhZ2VTdG9yeUFkID9cbiAgICAgICAgYCR7cGFnZUxheW91dEJveC53aWR0aH14JHtwYWdlTGF5b3V0Qm94LmhlaWdodH1gIDogbnVsbCxcbiAgICB9LCBnb29nbGVCbG9ja1BhcmFtZXRlcnModGhpcykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFBvcHVsYXRlJ3MgYmxvY2stbGV2ZWwgc3RhdGUgZm9yIGFkIFVSTCBjb25zdHJ1Y3Rpb24uXG4gICAqIEBwYXJhbSB7P0NPTlNFTlRfUE9MSUNZX1NUQVRFfSBjb25zZW50U3RhdGVcbiAgICogQHZpc2libGVGb3JUZXN0aW5nXG4gICAqL1xuICBwb3B1bGF0ZUFkVXJsU3RhdGUoY29uc2VudFN0YXRlKSB7XG4gICAgdGhpcy5jb25zZW50U3RhdGUgPSBjb25zZW50U3RhdGU7XG4gICAgLy8gQWxsb3cgZm9yIHB1YiB0byBvdmVycmlkZSBoZWlnaHQvd2lkdGggdmlhIG92ZXJyaWRlIGF0dHJpYnV0ZS5cbiAgICBjb25zdCB3aWR0aCA9IE51bWJlcih0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLW92ZXJyaWRlLXdpZHRoJykpIHx8XG4gICAgICBOdW1iZXIodGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnd2lkdGgnKSk7XG4gICAgY29uc3QgaGVpZ2h0ID0gTnVtYmVyKHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtb3ZlcnJpZGUtaGVpZ2h0JykpIHx8XG4gICAgICBOdW1iZXIodGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnaGVpZ2h0JykpO1xuICAgIHRoaXMuaW5pdGlhbFNpemVfID0gdGhpcy5pc0ZsdWlkUmVxdWVzdF8gPyB7d2lkdGg6IDAsIGhlaWdodDogMH0gOlxuICAgICAgKHdpZHRoICYmIGhlaWdodCA/XG4gICAgICAgIC8vIHdpZHRoL2hlaWdodCBjb3VsZCBiZSAnYXV0bycgaW4gd2hpY2ggY2FzZSB3ZSBmYWxsYmFjayB0byBtZWFzdXJlZC5cbiAgICAgICAge3dpZHRoLCBoZWlnaHR9IDogdGhpcy5nZXRJbnRlcnNlY3Rpb25FbGVtZW50TGF5b3V0Qm94KCkpO1xuICAgIHRoaXMuanNvblRhcmdldGluZyA9XG4gICAgICB0cnlQYXJzZUpzb24odGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnanNvbicpKSB8fCB7fTtcbiAgICB0aGlzLmFkS2V5ID0gdGhpcy5nZW5lcmF0ZUFkS2V5XyhcbiAgICAgICAgYCR7dGhpcy5pbml0aWFsU2l6ZV8ud2lkdGh9eCR7dGhpcy5pbml0aWFsU2l6ZV8uaGVpZ2h0fWApO1xuICAgIHRoaXMucGFyYW1ldGVyU2l6ZSA9IHRoaXMuaXNGbHVpZFJlcXVlc3RfID9cbiAgICAgICczMjB4NTAnIDogYCR7dGhpcy5pbml0aWFsU2l6ZV8ud2lkdGh9eCR7dGhpcy5pbml0aWFsU2l6ZV8uaGVpZ2h0fWA7XG4gICAgY29uc3QgbXVsdGlTaXplRGF0YVN0ciA9IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbXVsdGktc2l6ZScpO1xuICAgIGlmIChtdWx0aVNpemVEYXRhU3RyKSB7XG4gICAgICBpZiAodGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnbGF5b3V0JykgPT0gJ3Jlc3BvbnNpdmUnKSB7XG4gICAgICAgIC8vIFRPRE8obGV2aXR6a3kpIERlZmluZSB0aGUgYmVoYXZpb3IgYW5kIHJlbW92ZSB0aGlzIHdhcm5pbmcuXG4gICAgICAgIHVzZXIoKS53YXJuKFRBRywgJ0JlaGF2aW9yIG9mIG11bHRpLXNpemUgYW5kIHJlc3BvbnNpdmUgbGF5b3V0IGlzICcgK1xuICAgICAgICAgICAgJ2N1cnJlbnRseSBub3Qgd2VsbCBkZWZpbmVkLiBGb3JjZWZ1bGx5IG92ZXJyaWRpbmcgbGF5b3V0IHRvICcgK1xuICAgICAgICAgICAgJ2BmaXhlZGAuJyk7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2xheW91dCcsICdmaXhlZCcpO1xuICAgICAgfVxuICAgICAgY29uc3QgbXVsdGlTaXplVmFsaWRhdGlvbiA9IHRoaXMuZWxlbWVudFxuICAgICAgICAgIC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbXVsdGktc2l6ZS12YWxpZGF0aW9uJykgfHwgJ3RydWUnO1xuICAgICAgLy8gVGhlIGZvbGxvd2luZyBjYWxsIHdpbGwgY2hlY2sgYWxsIHNwZWNpZmllZCBtdWx0aS1zaXplIGRpbWVuc2lvbnMsXG4gICAgICAvLyB2ZXJpZnkgdGhhdCB0aGV5IG1lZXQgYWxsIHJlcXVpcmVtZW50cywgYW5kIHRoZW4gcmV0dXJuIGFsbCB0aGUgdmFsaWRcbiAgICAgIC8vIGRpbWVuc2lvbnMgaW4gYW4gYXJyYXkuXG4gICAgICBjb25zdCBkaW1lbnNpb25zID0gZ2V0TXVsdGlTaXplRGltZW5zaW9ucyhcbiAgICAgICAgICBtdWx0aVNpemVEYXRhU3RyLFxuICAgICAgICAgIHRoaXMuaW5pdGlhbFNpemVfLndpZHRoLFxuICAgICAgICAgIHRoaXMuaW5pdGlhbFNpemVfLmhlaWdodCxcbiAgICAgICAgICBtdWx0aVNpemVWYWxpZGF0aW9uID09ICd0cnVlJyxcbiAgICAgICAgICB0aGlzLmlzRmx1aWRSZXF1ZXN0Xyk7XG4gICAgICBpZiAoZGltZW5zaW9ucy5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXJTaXplICs9ICd8JyArIGRpbWVuc2lvbnNcbiAgICAgICAgICAgIC5tYXAoZGltZW5zaW9uID0+IGRpbWVuc2lvbi5qb2luKCd4JykpXG4gICAgICAgICAgICAuam9pbignfCcpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgZ2V0Q29uc2VudFBvbGljeSgpIHtcbiAgICAvLyBFbnN1cmUgdGhhdCBidWlsZCBpcyBub3QgYmxvY2tlZCBieSBuZWVkIGZvciBjb25zZW50IChkZWxheSB3aWxsIG9jY3VyXG4gICAgLy8gcHJpb3IgdG8gUlRDICYgYWQgVVJMIGNvbnN0cnVjdGlvbikuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGdldEFkVXJsKGNvbnNlbnRTdGF0ZSwgb3B0X3J0Y1Jlc3BvbnNlc1Byb21pc2UpIHtcbiAgICBpZiAoY29uc2VudFN0YXRlID09IENPTlNFTlRfUE9MSUNZX1NUQVRFLlVOS05PV04gJiZcbiAgICAgICAgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1ucGEtb24tdW5rbm93bi1jb25zZW50JykgIT0gJ3RydWUnKSB7XG4gICAgICB1c2VyKCkuaW5mbyhUQUcsICdBZCByZXF1ZXN0IHN1cHByZXNzZWQgZHVlIHRvIHVua25vd24gY29uc2VudCcpO1xuICAgICAgdGhpcy5nZXRBZFVybERlZmVycmVkLnJlc29sdmUoJycpO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgnJyk7XG4gICAgfVxuICAgIGlmICh0aGlzLmlmcmFtZSAmJiAhdGhpcy5pc1JlZnJlc2hpbmcpIHtcbiAgICAgIGRldigpLndhcm4oVEFHLCBgRnJhbWUgYWxyZWFkeSBleGlzdHMsIHNyYTogJHt0aGlzLnVzZVNyYX1gKTtcbiAgICAgIHRoaXMuZ2V0QWRVcmxEZWZlcnJlZC5yZXNvbHZlKCcnKTtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoJycpO1xuICAgIH1cbiAgICBvcHRfcnRjUmVzcG9uc2VzUHJvbWlzZSA9IG9wdF9ydGNSZXNwb25zZXNQcm9taXNlIHx8IFByb21pc2UucmVzb2x2ZSgpO1xuICAgIC8vIFRPRE8oa2VpdGh3cmlnaHRib3MpOiBTUkEgYmxvY2tzIGN1cnJlbnRseSB1bm5lY2Vzc2FyaWx5IGdlbmVyYXRlIGZ1bGxcbiAgICAvLyBhZCB1cmwuICBUaGlzIGNvdWxkIGJlIG9wdGltaXplZCBob3dldmVyIG5vbi1TUkEgYWQgdXJsIGlzIHJlcXVpcmVkIHRvXG4gICAgLy8gZmFsbGJhY2sgdG8gbm9uLVNSQSBpZiBzaW5nbGUgYmxvY2suXG4gICAgdGhpcy5wb3B1bGF0ZUFkVXJsU3RhdGUoY29uc2VudFN0YXRlKTtcbiAgICAvLyBUT0RPOiBDaGVjayBmb3IgcmVxdWlyZWQgYW5kIGFsbG93ZWQgcGFyYW1ldGVycy4gUHJvYmFibHkgdXNlXG4gICAgLy8gdmFsaWRhdGVEYXRhLCBmcm9tIDNwLzNwL2pzLCBhZnRlciBub3ZpbmcgaXQgc29tZXBsYWNlIGNvbW1vbi5cbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGlkZW50aXR5UHJvbWlzZSA9IFNlcnZpY2VzLnRpbWVyRm9yKHRoaXMud2luKVxuICAgICAgICAudGltZW91dFByb21pc2UoMTAwMCwgdGhpcy5pZGVudGl0eVRva2VuUHJvbWlzZV8pXG4gICAgICAgIC5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgLy8gT24gZXJyb3IvdGltZW91dCwgcHJvY2VlZC5cbiAgICAgICAgICByZXR1cm4gLyoqQHR5cGUgeyEuLi8uLi8uLi9hZHMvZ29vZ2xlL2E0YS91dGlscy5JZGVudGl0eVRva2VufSovKHt9KTtcbiAgICAgICAgfSk7XG4gICAgY29uc3QgY2hlY2tTdGlsbEN1cnJlbnQgPSB0aGlzLnZlcmlmeVN0aWxsQ3VycmVudCgpO1xuICAgIFByb21pc2UuYWxsKFtvcHRfcnRjUmVzcG9uc2VzUHJvbWlzZSwgaWRlbnRpdHlQcm9taXNlXSlcbiAgICAgICAgLnRoZW4ocmVzdWx0cyA9PiB7XG4gICAgICAgICAgY2hlY2tTdGlsbEN1cnJlbnQoKTtcbiAgICAgICAgICBjb25zdCBydGNQYXJhbXMgPSB0aGlzLm1lcmdlUnRjUmVzcG9uc2VzXyhyZXN1bHRzWzBdKTtcbiAgICAgICAgICB0aGlzLmlkZW50aXR5VG9rZW4gPSByZXN1bHRzWzFdO1xuICAgICAgICAgIGdvb2dsZUFkVXJsKFxuICAgICAgICAgICAgICB0aGlzLCBET1VCTEVDTElDS19CQVNFX1VSTCwgc3RhcnRUaW1lLCBPYmplY3QuYXNzaWduKFxuICAgICAgICAgICAgICAgICAgdGhpcy5nZXRCbG9ja1BhcmFtZXRlcnNfKCksIHRoaXMuYnVpbGRJZGVudGl0eVBhcmFtcygpLFxuICAgICAgICAgICAgICAgICAgdGhpcy5nZXRQYWdlUGFyYW1ldGVycyhjb25zZW50U3RhdGUpLCBydGNQYXJhbXMpLFxuICAgICAgICAgICAgICB0aGlzLmV4cGVyaW1lbnRJZHMpXG4gICAgICAgICAgICAgIC50aGVuKGFkVXJsID0+IHRoaXMuZ2V0QWRVcmxEZWZlcnJlZC5yZXNvbHZlKGFkVXJsKSk7XG4gICAgICAgIH0pO1xuICAgIHRoaXMudHJvdWJsZXNob290RGF0YV8uYWRVcmwgPSB0aGlzLmdldEFkVXJsRGVmZXJyZWQucHJvbWlzZTtcbiAgICByZXR1cm4gdGhpcy5nZXRBZFVybERlZmVycmVkLnByb21pc2U7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydHMgaWRlbnRpdHkgdG9rZW4gcmVzcG9uc2UgdG8gYWQgcmVxdWVzdCBwYXJhbWV0ZXJzLlxuICAgKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZyxzdHJpbmc+fVxuICAgKi9cbiAgYnVpbGRJZGVudGl0eVBhcmFtcygpIHtcbiAgICByZXR1cm4gdGhpcy5pZGVudGl0eVRva2VuID8ge1xuICAgICAgYWRzaWQ6IHRoaXMuaWRlbnRpdHlUb2tlbi50b2tlbiB8fCBudWxsLFxuICAgICAgamFyOiB0aGlzLmlkZW50aXR5VG9rZW4uamFyIHx8IG51bGwsXG4gICAgICBwdWNyZDogdGhpcy5pZGVudGl0eVRva2VuLnB1Y3JkIHx8IG51bGwsXG4gICAgfSA6IHt9O1xuICB9XG5cbiAgLyoqXG4gICAqIE1lcmdlcyBhbGwgb2YgdGhlIHJ0Y1Jlc3BvbnNlcyBpbnRvIHRoZSBKU09OIHRhcmdldGluZyBhbmRcbiAgICogY2F0ZWdvcnkgZXhjbHVzaW9ucy5cbiAgICogQHBhcmFtIHs/QXJyYXk8IXJ0Y1Jlc3BvbnNlRGVmPn0gcnRjUmVzcG9uc2VBcnJheVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgbWVyZ2VSdGNSZXNwb25zZXNfKHJ0Y1Jlc3BvbnNlQXJyYXkpIHtcbiAgICBpZiAoIXJ0Y1Jlc3BvbnNlQXJyYXkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBhcnRjID0gW107XG4gICAgY29uc3QgYXRpID0gW107XG4gICAgY29uc3QgYXJkID0gW107XG4gICAgbGV0IGV4Y2x1c2lvbnM7XG4gICAgcnRjUmVzcG9uc2VBcnJheS5mb3JFYWNoKHJ0Y1Jlc3BvbnNlID0+IHtcbiAgICAgIGlmICghcnRjUmVzcG9uc2UpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgYXJ0Yy5wdXNoKHJ0Y1Jlc3BvbnNlLnJ0Y1RpbWUpO1xuICAgICAgYXRpLnB1c2gocnRjUmVzcG9uc2UuZXJyb3IgfHwgUlRDX1NVQ0NFU1MpO1xuICAgICAgYXJkLnB1c2gocnRjUmVzcG9uc2UuY2FsbG91dCk7XG4gICAgICBpZiAocnRjUmVzcG9uc2UucmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJ0Y1Jlc3BvbnNlLnJlc3BvbnNlWyd0YXJnZXRpbmcnXSkge1xuICAgICAgICAgIGNvbnN0IHJld3JpdHRlblJlc3BvbnNlID0gdGhpcy5yZXdyaXRlUnRjS2V5c18oXG4gICAgICAgICAgICAgIHJ0Y1Jlc3BvbnNlLnJlc3BvbnNlWyd0YXJnZXRpbmcnXSxcbiAgICAgICAgICAgICAgcnRjUmVzcG9uc2UuY2FsbG91dCk7XG4gICAgICAgICAgdGhpcy5qc29uVGFyZ2V0aW5nWyd0YXJnZXRpbmcnXSA9XG4gICAgICAgICAgICAgICEhdGhpcy5qc29uVGFyZ2V0aW5nWyd0YXJnZXRpbmcnXSA/XG4gICAgICAgICAgICAgICAgZGVlcE1lcmdlKHRoaXMuanNvblRhcmdldGluZ1sndGFyZ2V0aW5nJ10sXG4gICAgICAgICAgICAgICAgICAgIHJld3JpdHRlblJlc3BvbnNlKSA6XG4gICAgICAgICAgICAgICAgcmV3cml0dGVuUmVzcG9uc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJ0Y1Jlc3BvbnNlLnJlc3BvbnNlWydjYXRlZ29yeUV4Y2x1c2lvbnMnXSkge1xuICAgICAgICAgIGlmICghZXhjbHVzaW9ucykge1xuICAgICAgICAgICAgZXhjbHVzaW9ucyA9IHt9O1xuICAgICAgICAgICAgaWYgKHRoaXMuanNvblRhcmdldGluZ1snY2F0ZWdvcnlFeGNsdXNpb25zJ10pIHtcbiAgICAgICAgICAgICAgdGhpcy5qc29uVGFyZ2V0aW5nWydjYXRlZ29yeUV4Y2x1c2lvbnMnXS5mb3JFYWNoKGV4Y2x1c2lvbiA9PiB7XG4gICAgICAgICAgICAgICAgZXhjbHVzaW9uc1tleGNsdXNpb25dID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJ0Y1Jlc3BvbnNlLnJlc3BvbnNlWydjYXRlZ29yeUV4Y2x1c2lvbnMnXS5mb3JFYWNoKGV4Y2x1c2lvbiA9PiB7XG4gICAgICAgICAgICBleGNsdXNpb25zW2V4Y2x1c2lvbl0gPSB0cnVlO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKGV4Y2x1c2lvbnMpIHtcbiAgICAgIHRoaXMuanNvblRhcmdldGluZ1snY2F0ZWdvcnlFeGNsdXNpb25zJ10gPSBPYmplY3Qua2V5cyhleGNsdXNpb25zKTtcbiAgICB9XG4gICAgcmV0dXJuIHsnYXJ0Yyc6IGFydGMuam9pbigpIHx8IG51bGwsICdhdGknOiBhdGkuam9pbigpLCAnYXJkJzogYXJkLmpvaW4oKX07XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGdldEN1c3RvbVJlYWxUaW1lQ29uZmlnTWFjcm9zXygpIHtcbiAgICAvKipcbiAgICAgKiBUaGlzIHdoaXRlbGlzdCBhbGxvdyBhdHRyaWJ1dGVzIG9uIHRoZSBhbXAtYWQgZWxlbWVudCB0byBiZSB1c2VkIGFzXG4gICAgICogbWFjcm9zIGZvciBjb25zdHJ1Y3RpbmcgdGhlIFJUQyBVUkwuIEFkZCBhdHRyaWJ1dGVzIGhlcmUsIGluIGxvd2VyY2FzZSxcbiAgICAgKiB0byBtYWtlIHRoZW0gYXZhaWxhYmxlLlxuICAgICAqL1xuICAgIGNvbnN0IHdoaXRlbGlzdCA9IHtcbiAgICAgICdoZWlnaHQnOiB0cnVlLFxuICAgICAgJ3dpZHRoJzogdHJ1ZSxcbiAgICAgICdkYXRhLXNsb3QnOiB0cnVlLFxuICAgICAgJ2RhdGEtbXVsdGktc2l6ZSc6IHRydWUsXG4gICAgICAnZGF0YS1tdWx0aS1zaXplLXZhbGlkYXRpb24nOiB0cnVlLFxuICAgICAgJ2RhdGEtb3ZlcnJpZGUtd2lkdGgnOiB0cnVlLFxuICAgICAgJ2RhdGEtb3ZlcnJpZGUtaGVpZ2h0JzogdHJ1ZSxcbiAgICB9O1xuICAgIHJldHVybiB7XG4gICAgICBQQUdFVklFV0lEOiAoKSA9PiBTZXJ2aWNlcy5kb2N1bWVudEluZm9Gb3JEb2ModGhpcy5lbGVtZW50KS5wYWdlVmlld0lkLFxuICAgICAgSFJFRjogKCkgPT4gdGhpcy53aW4ubG9jYXRpb24uaHJlZixcbiAgICAgIFJFRkVSUkVSOiBvcHRfdGltZW91dCA9PiB0aGlzLmdldFJlZmVycmVyXyhvcHRfdGltZW91dCksXG4gICAgICBUR1Q6ICgpID0+XG4gICAgICAgIEpTT04uc3RyaW5naWZ5KFxuICAgICAgICAgICAgKHRyeVBhcnNlSnNvbihcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdqc29uJykpIHx8IHt9KVsndGFyZ2V0aW5nJ10pLFxuICAgICAgQURDSUQ6IG9wdF90aW1lb3V0ID0+IGdldE9yQ3JlYXRlQWRDaWQoXG4gICAgICAgICAgdGhpcy5nZXRBbXBEb2MoKSwgJ0FNUF9FQ0lEX0dPT0dMRScsICdfZ2EnLFxuICAgICAgICAgIHBhcnNlSW50KG9wdF90aW1lb3V0LCAxMCkpLFxuICAgICAgQVRUUjogbmFtZSA9PiB7XG4gICAgICAgIGlmICghd2hpdGVsaXN0W25hbWUudG9Mb3dlckNhc2UoKV0pIHtcbiAgICAgICAgICBkZXYoKS53YXJuKCdUQUcnLCBgSW52YWxpZCBhdHRyaWJ1dGUgJHtuYW1lfWApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKG5hbWUpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgQ0FOT05JQ0FMX1VSTDogKCkgPT5cbiAgICAgICAgU2VydmljZXMuZG9jdW1lbnRJbmZvRm9yRG9jKHRoaXMuZWxlbWVudCkuY2Fub25pY2FsVXJsLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgcmVmZXJyZXIgb3IgdW5kZWZpbmVkIGlmIHRoZSByZWZlcnJlciBpcyBub3QgcmVzb2x2ZWRcbiAgICogYmVmb3JlIHRoZSBnaXZlbiB0aW1lb3V0XG4gICAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0X3RpbWVvdXRcbiAgICogQHJldHVybiB7IShQcm9taXNlPHN0cmluZz58UHJvbWlzZTx1bmRlZmluZWQ+KX0gQSBwcm9taXNlIHdpdGggYSByZWZlcnJlciBvciB1bmRlZmluZWRcbiAgICogaWYgdGltZWQgb3V0XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRSZWZlcnJlcl8ob3B0X3RpbWVvdXQpIHtcbiAgICBjb25zdCB0aW1lb3V0SW50ID0gcGFyc2VJbnQob3B0X3RpbWVvdXQsIDEwKTtcbiAgICBjb25zdCByZWZlcnJlclByb21pc2UgPSBTZXJ2aWNlcy52aWV3ZXJGb3JEb2ModGhpcy5nZXRBbXBEb2MoKSlcbiAgICAgICAgLmdldFJlZmVycmVyVXJsKCk7XG4gICAgaWYgKGlzTmFOKHRpbWVvdXRJbnQpIHx8IHRpbWVvdXRJbnQgPCAwKSB7XG4gICAgICByZXR1cm4gcmVmZXJyZXJQcm9taXNlO1xuICAgIH1cbiAgICByZXR1cm4gU2VydmljZXMudGltZXJGb3IodGhpcy53aW4pXG4gICAgICAgIC50aW1lb3V0UHJvbWlzZSh0aW1lb3V0SW50LCByZWZlcnJlclByb21pc2UpXG4gICAgICAgIC5jYXRjaCgoKSA9PiB1bmRlZmluZWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGVuZHMgdGhlIGNhbGxvdXQgdmFsdWUgdG8gdGhlIGtleXMgb2YgcmVzcG9uc2UgdG8gcHJldmVudCBhIGNvbGxpc2lvblxuICAgKiBjYXNlIGNhdXNlZCBieSBtdWx0aXBsZSB2ZW5kb3JzIHJldHVybmluZyB0aGUgc2FtZSBrZXlzLlxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSByZXNwb25zZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gY2FsbG91dFxuICAgKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHJld3JpdGVSdGNLZXlzXyhyZXNwb25zZSwgY2FsbG91dCkge1xuICAgIC8vIE9ubHkgcGVyZm9ybSB0aGlzIHN1YnN0aXR1dGlvbiBmb3IgdmVuZG9yLWRlZmluZWQgVVJMcy5cbiAgICBpZiAoIVJUQ19WRU5ET1JTW2NhbGxvdXRdIHx8IFJUQ19WRU5ET1JTW2NhbGxvdXRdLmRpc2FibGVLZXlBcHBlbmQpIHtcbiAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICB9XG4gICAgY29uc3QgbmV3UmVzcG9uc2UgPSB7fTtcbiAgICBPYmplY3Qua2V5cyhyZXNwb25zZSkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgbmV3UmVzcG9uc2VbYCR7a2V5fV8ke2NhbGxvdXR9YF0gPSByZXNwb25zZVtrZXldO1xuICAgIH0pO1xuICAgIHJldHVybiBuZXdSZXNwb25zZTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgb25OZXR3b3JrRmFpbHVyZShlcnJvciwgYWRVcmwpIHtcbiAgICBkZXYoKS5pbmZvKFRBRywgJ25ldHdvcmsgZXJyb3IsIGF0dGVtcHQgYWRkaW5nIG9mIGVycm9yIHBhcmFtZXRlcicsIGVycm9yKTtcbiAgICByZXR1cm4ge2FkVXJsOiBtYXliZUFwcGVuZEVycm9yUGFyYW1ldGVyKGFkVXJsLCAnbicpfTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgZXh0cmFjdFNpemUocmVzcG9uc2VIZWFkZXJzKSB7XG4gICAgdGhpcy5hbXBBbmFseXRpY3NDb25maWdfID0gZXh0cmFjdEFtcEFuYWx5dGljc0NvbmZpZyh0aGlzLCByZXNwb25zZUhlYWRlcnMpO1xuICAgIHRoaXMucXFpZF8gPSByZXNwb25zZUhlYWRlcnMuZ2V0KFFRSURfSEVBREVSKTtcbiAgICB0aGlzLnRyb3VibGVzaG9vdERhdGFfLmNyZWF0aXZlSWQgPVxuICAgICAgICByZXNwb25zZUhlYWRlcnMuZ2V0KCdnb29nbGUtY3JlYXRpdmUtaWQnKTtcbiAgICB0aGlzLnRyb3VibGVzaG9vdERhdGFfLmxpbmVJdGVtSWQgPVxuICAgICAgICByZXNwb25zZUhlYWRlcnMuZ2V0KCdnb29nbGUtbGluZWl0ZW0taWQnKTtcbiAgICBpZiAodGhpcy5hbXBBbmFseXRpY3NDb25maWdfKSB7XG4gICAgICAvLyBMb2FkIGFtcC1hbmFseXRpY3MgZXh0ZW5zaW9uc1xuICAgICAgdGhpcy5leHRlbnNpb25zXy4vKk9LKi9pbnN0YWxsRXh0ZW5zaW9uRm9yRG9jKFxuICAgICAgICAgIHRoaXMuZ2V0QW1wRG9jKCksICdhbXAtYW5hbHl0aWNzJyk7XG4gICAgfVxuICAgIC8vIElmIHRoZSBzZXJ2ZXIgcmV0dXJuZWQgYSBzaXplLCB1c2UgdGhhdCwgb3RoZXJ3aXNlIHVzZSB0aGUgc2l6ZSB0aGF0IHdlXG4gICAgLy8gc2VudCBpbiB0aGUgYWQgcmVxdWVzdC5cbiAgICBsZXQgc2l6ZSA9IHN1cGVyLmV4dHJhY3RTaXplKHJlc3BvbnNlSGVhZGVycyk7XG4gICAgaWYgKHNpemUpIHtcbiAgICAgIHRoaXMucmV0dXJuZWRTaXplXyA9IHNpemU7XG4gICAgICB0aGlzLmhhbmRsZVJlc2l6ZV8oc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzaXplID0gdGhpcy5nZXRTbG90U2l6ZSgpO1xuICAgIH1cbiAgICAvLyBJZiB0aGlzIGlzIGEgbXVsdGktc2l6ZSBjcmVhdGl2ZSwgZmlyZSBkZWxheWVkIGltcHJlc3Npb24gbm93LiBJZiBpdCdzXG4gICAgLy8gZmx1aWQsIHdhaXQgdW50aWwgYWZ0ZXIgcmVzaXplIGhhcHBlbnMuXG4gICAgaWYgKHRoaXMuaXNGbHVpZFJlcXVlc3RfICYmICF0aGlzLnJldHVybmVkU2l6ZV8pIHtcbiAgICAgIHRoaXMuZmx1aWRJbXByZXNzaW9uVXJsXyA9IHJlc3BvbnNlSGVhZGVycy5nZXQoJ1gtQW1wSW1wcycpO1xuICAgIH1cblxuICAgIC8vIElmIHRoZSByZXNwb25zZSBpbmNsdWRlZCBhIHBhZ2V2aWV3IHN0YXRlIHRva2VuLCBjaGVjayBmb3IgYW4gZXhpc3RpbmdcbiAgICAvLyB0b2tlbiBhbmQgcmVtb3ZlIGl0LiBUaGVuIHNhdmUgdGhlIG5ldyBvbmUgdG8gdGhlIG1vZHVsZSBsZXZlbCBvYmplY3QuXG4gICAgaWYgKHJlc3BvbnNlSGVhZGVycy5nZXQoJ2FtcC1mZi1wYWdldmlldy10b2tlbnMnKSkge1xuICAgICAgdGhpcy5yZW1vdmVQYWdldmlld1N0YXRlVG9rZW4oKTtcbiAgICAgIHRoaXMuc2V0UGFnZXZpZXdTdGF0ZVRva2VuKFxuICAgICAgICAgIHJlc3BvbnNlSGVhZGVycy5nZXQoJ2FtcC1mZi1wYWdldmlldy10b2tlbnMnKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHNpemU7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgd2lkdGggYW5kIGhlaWdodCBvZiB0aGUgc2xvdCBhcyBkZWZpbmVkIGJ5IHRoZSB3aWR0aCBhbmQgaGVpZ2h0XG4gICAqIGF0dHJpYnV0ZXMsIG9yIHRoZSBkaW1lbnNpb25zIGFzIGNvbXB1dGVkIGJ5XG4gICAqIGdldEludGVyc2VjdGlvbkVsZW1lbnRMYXlvdXRCb3guXG4gICAqIEByZXR1cm4ge3t3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcn18Li4vLi4vLi4vc3JjL2xheW91dC1yZWN0LkxheW91dFJlY3REZWZ9XG4gICAqL1xuICBnZXRTbG90U2l6ZSgpIHtcbiAgICBjb25zdCB3aWR0aCA9IE51bWJlcih0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCd3aWR0aCcpKTtcbiAgICBjb25zdCBoZWlnaHQgPSBOdW1iZXIodGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnaGVpZ2h0JykpO1xuICAgIHJldHVybiB3aWR0aCAmJiBoZWlnaHRcbiAgICAgID8ge3dpZHRoLCBoZWlnaHR9XG4gICAgICAvLyB3aWR0aC9oZWlnaHQgY291bGQgYmUgJ2F1dG8nIGluIHdoaWNoIGNhc2Ugd2UgZmFsbGJhY2sgdG8gbWVhc3VyZWQuXG4gICAgICA6IHRoaXMuZ2V0SW50ZXJzZWN0aW9uRWxlbWVudExheW91dEJveCgpO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICB0ZWFyRG93blNsb3QoKSB7XG4gICAgc3VwZXIudGVhckRvd25TbG90KCk7XG4gICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1hbXAtc2xvdC1pbmRleCcsXG4gICAgICAgIHRoaXMud2luLmFtcEFkU2xvdElkQ291bnRlcisrKTtcbiAgICBpZiAodGhpcy5hbXBBbmFseXRpY3NFbGVtZW50Xykge1xuICAgICAgcmVtb3ZlRWxlbWVudCh0aGlzLmFtcEFuYWx5dGljc0VsZW1lbnRfKTtcbiAgICAgIHRoaXMuYW1wQW5hbHl0aWNzRWxlbWVudF8gPSBudWxsO1xuICAgIH1cbiAgICB0aGlzLmFtcEFuYWx5dGljc0NvbmZpZ18gPSBudWxsO1xuICAgIHRoaXMuanNvblRhcmdldGluZyA9IG51bGw7XG4gICAgdGhpcy5pc0FtcENyZWF0aXZlXyA9IG51bGw7XG4gICAgdGhpcy5pc0lkbGVSZW5kZXJfID0gZmFsc2U7XG4gICAgdGhpcy5wYXJhbWV0ZXJTaXplID0gbnVsbDtcbiAgICB0aGlzLnJldHVybmVkU2l6ZV8gPSBudWxsO1xuICAgIC8vIFJlc2V0IFNSQSByZXF1ZXN0cyB0byBhbGxvdyBmb3IgcmVzdW1lQ2FsbGJhY2sgdG8gcmUtZmV0Y2hcbiAgICAvLyBhZCByZXF1ZXN0cy4gIEFzc3VtZXMgdGhhdCB1bmxheW91dENhbGxiYWNrIHdpbGwgYmUgY2FsbGVkIGZvciBhbGwgc2xvdHNcbiAgICAvLyBpbiByYXBpZCBzdWNjZXNzaW9uIChtZWFuaW5nIG9uTGF5b3V0TWVhc3VyZSBpbml0aWF0ZWQgcHJvbWlzZSBjaGFpblxuICAgIC8vIHdpbGwgbm90IGJlIHN0YXJ0ZWQgdW50aWwgcmVzdW1lQ2FsbGJhY2spLlxuICAgIHNyYVJlcXVlc3RzID0gbnVsbDtcbiAgICB0aGlzLnNyYURlZmVycmVkID0gbnVsbDtcbiAgICB0aGlzLnFxaWRfID0gbnVsbDtcbiAgICB0aGlzLmNvbnNlbnRTdGF0ZSA9IG51bGw7XG4gICAgdGhpcy5nZXRBZFVybERlZmVycmVkID0gbmV3IERlZmVycmVkKCk7XG4gICAgdGhpcy5yZW1vdmVQYWdldmlld1N0YXRlVG9rZW4oKTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgcmVuZGVyTm9uQW1wQ3JlYXRpdmUoKSB7XG4gICAgLy8gSWYgcmVuZGVyIGlkbGUgd2l0aCB0aHJvdHRsaW5nLCBpbXBvc2Ugb25lIHNlY29uZCByZW5kZXIgZGVsYXkgZm9yXG4gICAgLy8gbm9uLUFNUCBjcmVhdGl2ZXMuICBUaGlzIGlzIG5vdCBkb25lIGluIHRoZSBzY2hlZHVsZXIgdG8gZW5zdXJlIGFzIG1hbnlcbiAgICAvLyBzbG90cyBhcyBwb3NzaWJsZSBhcmUgbWFya2VkIGZvciBsYXlvdXQgZ2l2ZW4gc2NoZWR1bGVyIGltcG9zZXMgNSBzZWNvbmRzXG4gICAgLy8gcGFzdCBwcmV2aW91cyBleGVjdXRpb24uXG4gICAgaWYgKHRoaXMucG9zdEFkUmVzcG9uc2VFeHBlcmltZW50RmVhdHVyZXNbJ3JlbmRlci1pZGxlLXRocm90dGxlJ10gJiZcbiAgICAgICAgICB0aGlzLmlzSWRsZVJlbmRlcl8pIHtcbiAgICAgIGlmIChpczNwVGhyb3R0bGVkKHRoaXMud2luKSkge1xuICAgICAgICByZXR1cm4gd2FpdEZvcjNwVGhyb3R0bGUoKS50aGVuKCgpID0+IHN1cGVyLnJlbmRlck5vbkFtcENyZWF0aXZlKCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW5jcmVtZW50TG9hZGluZ0Fkcyh0aGlzLndpbik7XG4gICAgICAgIHJldHVybiBzdXBlci5yZW5kZXJOb25BbXBDcmVhdGl2ZSh0cnVlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHN1cGVyLnJlbmRlck5vbkFtcENyZWF0aXZlKCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICAqL1xuICB1bmxheW91dENhbGxiYWNrKCkge1xuICAgIGlmICh0aGlzLnJlZnJlc2hNYW5hZ2VyXykge1xuICAgICAgdGhpcy5yZWZyZXNoTWFuYWdlcl8udW5vYnNlcnZlKCk7XG4gICAgfVxuICAgIGlmICghdGhpcy51c2VTcmEgJiYgdGhpcy5pc0FtcENyZWF0aXZlXykge1xuICAgICAgLy8gQWxsb3cgbm9uLUFNUCBjcmVhdGl2ZXMgdG8gcmVtYWluIHVubGVzcyBTUkEuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHRoaXMuZGVzdHJveVNhZmVGcmFtZUFwaV8oKTtcbiAgICByZXR1cm4gc3VwZXIudW5sYXlvdXRDYWxsYmFjaygpO1xuICB9XG5cbiAgLyoqIEB2aXNpYmxlRm9yVGVzdGluZyAqL1xuICBjbGVhbnVwQWZ0ZXJUZXN0KCkge1xuICAgIHRoaXMuZGVzdHJveVNhZmVGcmFtZUFwaV8oKTtcbiAgfVxuXG4gIC8qKiBAcHJpdmF0ZSAqL1xuICBkZXN0cm95U2FmZUZyYW1lQXBpXygpIHtcbiAgICBpZiAoIXRoaXMuc2FmZWZyYW1lQXBpXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNhZmVmcmFtZUFwaV8uZGVzdHJveSgpO1xuICAgIHRoaXMuc2FmZWZyYW1lQXBpXyA9IG51bGw7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHJlZnJlc2gocmVmcmVzaEVuZENhbGxiYWNrKSB7XG4gICAgdGhpcy5yZWZyZXNoQ291bnRfKys7XG4gICAgcmV0dXJuIHN1cGVyLnJlZnJlc2gocmVmcmVzaEVuZENhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgb25DcmVhdGl2ZVJlbmRlcihjcmVhdGl2ZU1ldGFEYXRhKSB7XG4gICAgc3VwZXIub25DcmVhdGl2ZVJlbmRlcihjcmVhdGl2ZU1ldGFEYXRhKTtcbiAgICB0aGlzLmlzQW1wQ3JlYXRpdmVfID0gISFjcmVhdGl2ZU1ldGFEYXRhO1xuICAgIGlmIChjcmVhdGl2ZU1ldGFEYXRhICYmXG4gICAgICAgICFjcmVhdGl2ZU1ldGFEYXRhLmN1c3RvbUVsZW1lbnRFeHRlbnNpb25zLmluY2x1ZGVzKCdhbXAtYWQtZXhpdCcpKSB7XG4gICAgICAvLyBDYXB0dXJlIHBoYXNlIGNsaWNrIGhhbmRsZXJzIG9uIHRoZSBhZCBpZiBhbXAtYWQtZXhpdCBub3QgcHJlc2VudFxuICAgICAgLy8gKGFzc3VtZSBpdCB3aWxsIGhhbmRsZSBjYXB0dXJlKS5cbiAgICAgIGRldigpLmFzc2VydCh0aGlzLmlmcmFtZSk7XG4gICAgICBOYXZpZ2F0aW9uLmluc3RhbGxBbmNob3JDbGlja0ludGVyY2VwdG9yKFxuICAgICAgICAgIHRoaXMuZ2V0QW1wRG9jKCksIHRoaXMuaWZyYW1lLmNvbnRlbnRXaW5kb3cpO1xuICAgIH1cbiAgICBpZiAodGhpcy5hbXBBbmFseXRpY3NDb25maWdfKSB7XG4gICAgICBkZXYoKS5hc3NlcnQoIXRoaXMuYW1wQW5hbHl0aWNzRWxlbWVudF8pO1xuICAgICAgaWYgKGlzUmVwb3J0aW5nRW5hYmxlZCh0aGlzKSkge1xuICAgICAgICBhZGRDc2lTaWduYWxzVG9BbXBBbmFseXRpY3NDb25maWcoXG4gICAgICAgICAgICB0aGlzLndpbixcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCxcbiAgICAgICAgICAgIHRoaXMuYW1wQW5hbHl0aWNzQ29uZmlnXyxcbiAgICAgICAgICAgIHRoaXMucXFpZF8sXG4gICAgICAgICAgICAhIWNyZWF0aXZlTWV0YURhdGEpO1xuICAgICAgfVxuICAgICAgdGhpcy5hbXBBbmFseXRpY3NFbGVtZW50XyA9IGluc2VydEFuYWx5dGljc0VsZW1lbnQoXG4gICAgICAgICAgdGhpcy5lbGVtZW50LCB0aGlzLmFtcEFuYWx5dGljc0NvbmZpZ18sIC8qbG9hZEFuYWx5dGljcyovIHRydWUsXG4gICAgICAgICAgISF0aGlzLnBvc3RBZFJlc3BvbnNlRXhwZXJpbWVudEZlYXR1cmVzWydhdnJfZGlzYWJsZV9pbW1lZGlhdGUnXSk7XG4gICAgfVxuICAgIGlmICh0aGlzLmlzUmVmcmVzaGluZykge1xuICAgICAgZGV2KCkuYXNzZXJ0KHRoaXMucmVmcmVzaE1hbmFnZXJfKTtcbiAgICAgIHRoaXMucmVmcmVzaE1hbmFnZXJfLmluaXRpYXRlUmVmcmVzaEN5Y2xlKCk7XG4gICAgICB0aGlzLmlzUmVmcmVzaGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5pc1JlbGF5b3V0TmVlZGVkRmxhZyA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8vIEZvcmNlIHNpemUgb2YgZnJhbWUgdG8gbWF0Y2ggY3JlYXRpdmUgb3IsIGlmIGNyZWF0aXZlIHNpemUgaXMgdW5rbm93bixcbiAgICAvLyB0aGUgc2xvdC4gVGhpcyBlbnN1cmVzIHRoYXQgdGhlIGNyZWF0aXZlIGlzIGNlbnRlcmVkIGluIHRoZSBmb3JtZXIgY2FzZSxcbiAgICAvLyBhbmQgbm90IHRydW5jYXRlZCBpbiB0aGUgbGF0dGVyLlxuICAgIGNvbnN0IHNpemUgPSB0aGlzLnJldHVybmVkU2l6ZV8gfHwgdGhpcy5nZXRTbG90U2l6ZSgpO1xuICAgIGNvbnN0IGlzTXVsdGlTaXplRmx1aWQgPSB0aGlzLmlzRmx1aWRSZXF1ZXN0XyAmJiB0aGlzLnJldHVybmVkU2l6ZV8gJiZcbiAgICAgICAgLy8gVE9ETyhAZ2xldml0emt5LCAxMTU4MykgUmVtb3ZlIHRoaXMgY2xhdXNlIG9uY2Ugd2Ugc3RvcCBzZW5kaW5nIGJhY2tcbiAgICAgICAgLy8gdGhlIHNpemUgaGVhZGVyIGZvciBmbHVpZCBhZHMuIEZsdWlkIHNpemUgaGVhZGVycyBhbHdheXMgY29tZSBiYWNrIGFzXG4gICAgICAgIC8vIDB4MC5cbiAgICAgICAgIShzaXplLndpZHRoID09IDAgJiYgc2l6ZS5oZWlnaHQgPT0gMCk7XG4gICAgc2V0U3R5bGVzKGRldigpLmFzc2VydEVsZW1lbnQodGhpcy5pZnJhbWUpLCB7XG4gICAgICB3aWR0aDogYCR7c2l6ZS53aWR0aH1weGAsXG4gICAgICBoZWlnaHQ6IGAke3NpemUuaGVpZ2h0fXB4YCxcbiAgICAgIHBvc2l0aW9uOiBpc011bHRpU2l6ZUZsdWlkID8gJ3JlbGF0aXZlJyA6IG51bGwsXG4gICAgfSk7XG4gICAgaWYgKGlzTXVsdGlTaXplRmx1aWQpIHtcbiAgICAgIC8vIFRoaXMgaXMgYSBmbHVpZCArIG11bHRpLXNpemUgcmVxdWVzdCwgd2hlcmUgdGhlIHJldHVybmVkIGNyZWF0aXZlIGlzXG4gICAgICAvLyBtdWx0aS1zaXplLiBUaGUgc2xvdCBuZWVkcyB0byBub3QgYmUgc3R5bGVkIHdpdGggd2lkdGg6IDEwMCUsIG9yIHRoZVxuICAgICAgLy8gY3JlYXRpdmUgd2lsbCBiZSBjZW50ZXJlZCBpbnN0ZWFkIG9mIGxlZnQtYWxpZ25lZC5cbiAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2hlaWdodCcpO1xuICAgICAgc2V0U3R5bGVzKHRoaXMuZWxlbWVudCwge3dpZHRoOiBgJHtzaXplLndpZHRofXB4YH0pO1xuICAgIH1cblxuICAgIHRoaXMucmVmcmVzaE1hbmFnZXJfID0gdGhpcy5yZWZyZXNoTWFuYWdlcl8gfHxcbiAgICAgICAgZ2V0UmVmcmVzaE1hbmFnZXIodGhpcywgKCkgPT4ge1xuICAgICAgICAgIGlmICh0aGlzLnVzZVNyYSkge1xuICAgICAgICAgICAgdXNlcigpLndhcm4oVEFHLCAnUmVmcmVzaCBub3QgY29tcGF0aWJsZSB3aXRoIFNSQS4nKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGdldEVuY2xvc2luZ0NvbnRhaW5lclR5cGVzKHRoaXMuZWxlbWVudCkuZmlsdGVyKGNvbnRhaW5lciA9PlxuICAgICAgICAgICAgY29udGFpbmVyICE9IFZhbGlkQWRDb250YWluZXJUeXBlc1snQU1QLUNBUk9VU0VMJ10gJiZcbiAgICAgICAgICAgICAgICBjb250YWluZXIgIT0gVmFsaWRBZENvbnRhaW5lclR5cGVzWydBTVAtU1RJQ0tZLUFEJ10pLmxlbmd0aCkge1xuICAgICAgICAgICAgdXNlcigpLndhcm4oVEFHLFxuICAgICAgICAgICAgICAgICdSZWZyZXNoIG5vdCBjb21wYXRpYmxlIHdpdGggYWQtY29udGFpbmVycywgZXhjZXB0IGZvciAnICtcbiAgICAgICAgICAgICAgICAnQU1QLUNBUk9VU0VMIGFuZCBBTVAtU1RJQ0tZLUFEJyk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcblxuICAgIHRoaXMucG9zdFRyb3VibGVzaG9vdE1lc3NhZ2UoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gc2l6ZVxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBhZCB1bml0IGhhc2gga2V5IHN0cmluZy5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdlbmVyYXRlQWRLZXlfKHNpemUpIHtcbiAgICBjb25zdCB7ZWxlbWVudH0gPSB0aGlzO1xuICAgIGNvbnN0IGRvbUZpbmdlcnByaW50ID0gZG9tRmluZ2VycHJpbnRQbGFpbihlbGVtZW50KTtcbiAgICBjb25zdCBzbG90ID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2xvdCcpIHx8ICcnO1xuICAgIGNvbnN0IG11bHRpU2l6ZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLW11bHRpLXNpemUnKSB8fCAnJztcbiAgICBjb25zdCBzdHJpbmcgPSBgJHtzbG90fToke3NpemV9OiR7bXVsdGlTaXplfToke2RvbUZpbmdlcnByaW50fWA7XG4gICAgcmV0dXJuIHN0cmluZ0hhc2gzMihzdHJpbmcpO1xuICB9XG5cbiAgLyoqXG4gICAqIEF0dGVtcHRzIHRvIHJlc2l6ZSB0aGUgYWQsIGlmIHRoZSByZXR1cm5lZCBzaXplIGlzIHNtYWxsZXIgdGhhbiB0aGUgcHJpbWFyeVxuICAgKiBkaW1lbnNpb25zLlxuICAgKiBAcGFyYW0ge251bWJlcn0gd2lkdGhcbiAgICogQHBhcmFtIHtudW1iZXJ9IGhlaWdodFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgaGFuZGxlUmVzaXplXyh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgY29uc3QgcFdpZHRoID0gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnd2lkdGgnKTtcbiAgICBjb25zdCBwSGVpZ2h0ID0gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnaGVpZ2h0Jyk7XG4gICAgLy8gV2Ugd2FudCB0byByZXNpemUgb25seSBpZiBuZWl0aGVyIHJldHVybmVkIGRpbWVuc2lvbiBpcyBsYXJnZXIgdGhhbiBpdHNcbiAgICAvLyBwcmltYXJ5IGNvdW50ZXJwYXJ0LCBhbmQgaWYgYXQgbGVhc3Qgb25lIG9mIHRoZSByZXR1cm5lZCBkaW1lbnNpb25zXG4gICAgLy8gZGlmZmVyIGZyb20gaXRzIHByaW1hcnkgY291bnRlcnBhcnQuXG4gICAgaWYgKCh0aGlzLmlzRmx1aWRSZXF1ZXN0XyAmJiB3aWR0aCAmJiBoZWlnaHQpIHx8XG4gICAgICAgICgod2lkdGggIT0gcFdpZHRoIHx8IGhlaWdodCAhPSBwSGVpZ2h0KSAmJlxuICAgICAgICAgKHdpZHRoIDw9IHBXaWR0aCAmJiBoZWlnaHQgPD0gcEhlaWdodCkpKSB7XG4gICAgICB0aGlzLmF0dGVtcHRDaGFuZ2VTaXplKGhlaWdodCwgd2lkdGgpLmNhdGNoKCgpID0+IHt9KTtcbiAgICB9XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHNlbmRYaHJSZXF1ZXN0KGFkVXJsKSB7XG4gICAgaWYgKCF0aGlzLnVzZVNyYSkge1xuICAgICAgcmV0dXJuIHN1cGVyLnNlbmRYaHJSZXF1ZXN0KGFkVXJsKTtcbiAgICB9XG4gICAgdGhpcy5zcmFEZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgIGNvbnN0IGNoZWNrU3RpbGxDdXJyZW50ID0gdGhpcy52ZXJpZnlTdGlsbEN1cnJlbnQoKTtcbiAgICAvLyBJbml0aWF0ZVNyYVJlcXVlc3RzIHJlc29sdmVzIHdoZW4gYWxsIGJsb2NrcyBoYXZlIGhhZCB0aGVpciBTUkFcbiAgICAvLyByZXNwb25zZXMgcmV0dXJuZWQgc3VjaCB0aGF0IHNyYURlZmVycmVkIGJlaW5nIG5vbi1udWxsIGluZGljYXRlcyB0aGlzXG4gICAgLy8gZWxlbWVudCB3YXMgc29tZWhvdyBub3QgaW5jbHVkZWQgc28gcmVwb3J0LlxuICAgIHRoaXMuaW5pdGlhdGVTcmFSZXF1ZXN0cygpLnRoZW4oKCkgPT4ge1xuICAgICAgY2hlY2tTdGlsbEN1cnJlbnQoKTtcbiAgICAgIGlmICghdGhpcy5zcmFEZWZlcnJlZCkge1xuICAgICAgICBkZXYoKS53YXJuKFRBRywgYFNSQSBmYWlsZWQgdG8gaW5jbHVkZSBlbGVtZW50ICR7dGhpcy5pZmlffWApO1xuICAgICAgICBpZiAoaXNFeHBlcmltZW50T24odGhpcy53aW4sICdkb3VibGVjbGlja1NyYVJlcG9ydEV4Y2x1ZGVkQmxvY2snKSkge1xuICAgICAgICAgIHRoaXMuZ2V0QW1wRG9jKCkuZ2V0Qm9keSgpLmFwcGVuZENoaWxkKGNyZWF0ZUVsZW1lbnRXaXRoQXR0cmlidXRlcyhcbiAgICAgICAgICAgICAgdGhpcy53aW4uZG9jdW1lbnQsICdhbXAtcGl4ZWwnLCBkaWN0KHsnc3JjJzpcbiAgICAgICAgICAgICAgJ2h0dHBzOi8vcGFnZWFkMi5nb29nbGVzeW5kaWNhdGlvbi5jb20vcGFnZWFkL2dlbl8yMDQ/JyArXG4gICAgICAgICAgICAgICAgICBgaWQ9JHtlbmNvZGVVUklDb21wb25lbnQoJ2E0YTo6c3JhJyl9JmlmaT0ke3RoaXMuaWZpX31gfSkpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIC8vIFdhaXQgZm9yIFNSQSByZXF1ZXN0IHdoaWNoIHdpbGwgY2FsbCByZXNwb25zZSBwcm9taXNlIHdoZW4gdGhpcyBibG9jaydzXG4gICAgLy8gcmVzcG9uc2UgaGFzIGJlZW4gcmV0dXJuZWQuIE51bGwgcmVzcG9uc2UgaW5kaWNhdGVzIHNpbmdsZSBzbG90IHNob3VsZFxuICAgIC8vIGV4ZWN1dGUgdXNpbmcgbm9uLVNSQSBtZXRob2QuXG4gICAgcmV0dXJuIHRoaXMuc3JhRGVmZXJyZWQucHJvbWlzZS50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgIGNoZWNrU3RpbGxDdXJyZW50KCk7XG4gICAgICB0aGlzLnNyYURlZmVycmVkID0gbnVsbDtcbiAgICAgIHJldHVybiByZXNwb25zZSB8fCBzdXBlci5zZW5kWGhyUmVxdWVzdChhZFVybCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IGltcHJlc3Npb25zXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IHNjcnViUmVmZXJlclxuICAgKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAgICovXG4gIGZpcmVEZWxheWVkSW1wcmVzc2lvbnMoaW1wcmVzc2lvbnMsIHNjcnViUmVmZXJlcikge1xuICAgIGlmICghaW1wcmVzc2lvbnMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaW1wcmVzc2lvbnMuc3BsaXQoJywnKS5mb3JFYWNoKHVybCA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoIVNlcnZpY2VzLnVybEZvckRvYyh0aGlzLmdldEFtcERvYygpKS5pc1NlY3VyZSh1cmwpKSB7XG4gICAgICAgICAgZGV2KCkud2FybihUQUcsIGBpbnNlY3VyZSBpbXByZXNzaW9uIHVybDogJHt1cmx9YCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIENyZWF0ZSBhbXAtcGl4ZWwgYW5kIGFwcGVuZCB0byBkb2N1bWVudCB0byBzZW5kIGltcHJlc3Npb24uXG4gICAgICAgIHRoaXMud2luLmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoXG4gICAgICAgICAgICBjcmVhdGVFbGVtZW50V2l0aEF0dHJpYnV0ZXMoXG4gICAgICAgICAgICAgICAgdGhpcy53aW4uZG9jdW1lbnQsXG4gICAgICAgICAgICAgICAgJ2FtcC1waXhlbCcsXG4gICAgICAgICAgICAgICAgZGljdCh7XG4gICAgICAgICAgICAgICAgICAnc3JjJzogdXJsLFxuICAgICAgICAgICAgICAgICAgJ3JlZmVycmVycG9saWN5Jzogc2NydWJSZWZlcmVyID8gJ25vLXJlZmVycmVyJyA6ICcnLFxuICAgICAgICAgICAgICAgIH0pKSk7XG4gICAgICB9IGNhdGNoICh1bnVzZWRFcnJvcikge31cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHcm91cHMgc2xvdHMgYnkgdHlwZSBhbmQgbmV0d29ya0lkIGZyb20gZGF0YS1zbG90IHBhcmFtZXRlci4gIEV4cG9zZWQgZm9yXG4gICAqIGVhc2Ugb2YgdGVzdGluZy5cbiAgICogQHJldHVybiB7IVByb21pc2U8IU9iamVjdDxzdHJpbmcsIUFycmF5PCFQcm9taXNlPCEuLi8uLi8uLi9zcmMvYmFzZS1lbGVtZW50LkJhc2VFbGVtZW50Pj4+Pn1cbiAgICogQHZpc2libGVGb3JUZXN0aW5nXG4gICAqL1xuICBncm91cFNsb3RzRm9yU3JhKCkge1xuICAgIHJldHVybiBncm91cEFtcEFkc0J5VHlwZShcbiAgICAgICAgdGhpcy53aW4sIHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSwgZ2V0TmV0d29ya0lkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeGVjdXRlcyBTUkEgcmVxdWVzdCB2aWEgdGhlIGZvbGxvd2luZyBzdGVwczpcbiAgICogLSBjcmVhdGUgb25seSBvbmUgZXhlY3V0b3IgcGVyIHBhZ2VcbiAgICogLSBnZXQgYWxsIGRvdWJsZWNsaWNrIGFtcC1hZCBpbnN0YW5jZXMgb24gdGhlIHBhZ2VcbiAgICogLSBncm91cCBieSBuZXR3b3JrSUQgYWxsb3dpbmcgZm9yIHNlcGFyYXRlIFNSQSByZXF1ZXN0c1xuICAgKiAtIGZvciBlYWNoIGdyb3VwaW5nLCBjb25zdHJ1Y3QgU1JBIHJlcXVlc3RcbiAgICogLSBoYW5kbGUgY2h1bmtzIGZvciBzdHJlYW1pbmcgcmVzcG9uc2UgZm9yIGVhY2ggYmxvY2tcbiAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICAgKi9cbiAgaW5pdGlhdGVTcmFSZXF1ZXN0cygpIHtcbiAgICAvLyBVc2UgY2FuY2VsbGF0aW9uIG9mIHRoZSBmaXJzdCBzbG90J3MgcHJvbWlzZUlkIGFzIGluZGljYXRpb24gb2ZcbiAgICAvLyB1bmxheW91dENhbGxiYWNrIGV4ZWN1dGlvbi4gIEFzc3VtZSB0aGF0IGlmIGNhbGxlZCBmb3Igb25lIHNsb3QsIGl0IHdpbGxcbiAgICAvLyBiZSBjYWxsZWQgZm9yIGFsbCBhbmQgd2Ugc2hvdWxkIGNhbmNlbCBTUkEgZXhlY3V0aW9uLlxuICAgIGNvbnN0IGNoZWNrU3RpbGxDdXJyZW50ID0gdGhpcy52ZXJpZnlTdGlsbEN1cnJlbnQoKTtcbiAgICBjb25zdCBub0ZhbGxiYWNrRXhwID0gdGhpcy5leHBlcmltZW50SWRzLmluY2x1ZGVzKFxuICAgICAgICBET1VCTEVDTElDS19TUkFfRVhQX0JSQU5DSEVTLlNSQV9OT19SRUNPVkVSKTtcbiAgICBzcmFSZXF1ZXN0cyA9IHNyYVJlcXVlc3RzIHx8IHRoaXMuZ3JvdXBTbG90c0ZvclNyYSgpXG4gICAgICAgIC50aGVuKGdyb3VwSWRUb0Jsb2Nrc0FyeSA9PiB7XG4gICAgICAgICAgY2hlY2tTdGlsbEN1cnJlbnQoKTtcbiAgICAgICAgICBjb25zdCBzcmFSZXF1ZXN0UHJvbWlzZXMgPSBbXTtcbiAgICAgICAgICBPYmplY3Qua2V5cyhncm91cElkVG9CbG9ja3NBcnkpLmZvckVhY2gobmV0d29ya0lkID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGJsb2NrcyA9IGRldigpLmFzc2VydChncm91cElkVG9CbG9ja3NBcnlbbmV0d29ya0lkXSk7XG4gICAgICAgICAgICAvLyBUT0RPOiBmaWx0ZXIgYmxvY2tzIHdpdGggU1JBIGRpc2FibGVkP1xuICAgICAgICAgICAgc3JhUmVxdWVzdFByb21pc2VzLnB1c2goUHJvbWlzZS5hbGwoYmxvY2tzKS50aGVuKGluc3RhbmNlcyA9PiB7XG4gICAgICAgICAgICAgIGRldigpLmFzc2VydChpbnN0YW5jZXMubGVuZ3RoKTtcbiAgICAgICAgICAgICAgY2hlY2tTdGlsbEN1cnJlbnQoKTtcbiAgICAgICAgICAgICAgLy8gRXhjbHVkZSBhbnkgaW5zdGFuY2VzIHRoYXQgZG8gbm90IGhhdmUgYW4gYWRQcm9taXNlXyBhcyB0aGlzXG4gICAgICAgICAgICAgIC8vIGluZGljYXRlcyB0aGV5IHdlcmUgaW52YWxpZC5cbiAgICAgICAgICAgICAgY29uc3QgdHlwZUluc3RhbmNlcyA9XG4gICAgICAgICAgICAgIC8qKiBAdHlwZSB7IUFycmF5PCFBbXBBZE5ldHdvcmtEb3VibGVjbGlja0ltcGw+fSovKGluc3RhbmNlcylcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihpbnN0YW5jZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNWYWxpZCA9IGluc3RhbmNlLmhhc0FkUHJvbWlzZSgpO1xuICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNWYWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGV2KCkuaW5mbyhUQUcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0lnbm9yaW5nIGluc3RhbmNlIHdpdGhvdXQgYWQgcHJvbWlzZSBhcyAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGlrZWx5IGludmFsaWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLmVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNWYWxpZDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGlmICghdHlwZUluc3RhbmNlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgLy8gT25seSBjb250YWluZWQgaW52YWxpZCBlbGVtZW50cy5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLy8gSWYgbm90IHdpdGhpbiBubyByZWNvdmVyeSBTUkEgZXhwZXJpbWVudCwgZGV0ZXJtaW5lIGlmIG1vcmVcbiAgICAgICAgICAgICAgLy8gdGhhbiBvbmUgYmxvY2sgZm9yIHRoaXMgZWxlbWVudCwgaWYgbm90IGRvIG5vdCBzZXQgc3JhIHJlcXVlc3RcbiAgICAgICAgICAgICAgLy8gcHJvbWlzZSB3aGljaCByZXN1bHRzIGluIHNlbmRpbmcgYXMgbm9uLVNSQSByZXF1ZXN0IChiZW5lZml0XG4gICAgICAgICAgICAgIC8vIGlzIGl0IGFsbG93cyBkaXJlY3QgY2FjaGUgbWV0aG9kKS5cbiAgICAgICAgICAgICAgaWYgKCFub0ZhbGxiYWNrRXhwICYmIHR5cGVJbnN0YW5jZXMubGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgICAgICBkZXYoKS5pbmZvKFRBRywgYHNpbmdsZSBibG9jayBpbiBuZXR3b3JrICR7bmV0d29ya0lkfWApO1xuICAgICAgICAgICAgICAgIHR5cGVJbnN0YW5jZXNbMF0uc3JhRGVmZXJyZWQucmVzb2x2ZShudWxsKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgbGV0IHNyYVVybDtcbiAgICAgICAgICAgICAgLy8gQ29uc3RydWN0IGFuZCBzZW5kIFNSQSByZXF1ZXN0LlxuICAgICAgICAgICAgICAvLyBDaHVuayBoYW5kbGVyIGNhbGxlZCB3aXRoIG1ldGFkYXRhIGFuZCBjcmVhdGl2ZSBmb3IgZWFjaCBzbG90XG4gICAgICAgICAgICAgIC8vIGluIG9yZGVyIG9mIFVSTHMgZ2l2ZW4gd2hpY2ggaXMgdGhlbiBwYXNzZWQgdG8gcmVzb2x2ZXIgdXNlZFxuICAgICAgICAgICAgICAvLyBmb3Igc2VuZFhoclJlcXVlc3QuXG4gICAgICAgICAgICAgIGNvbnN0IHNyYVJlcXVlc3RBZFVybFJlc29sdmVycyA9XG4gICAgICAgICAgICAgIHR5cGVJbnN0YW5jZXMubWFwKGluc3RhbmNlID0+IGluc3RhbmNlLnNyYURlZmVycmVkLnJlc29sdmUpO1xuICAgICAgICAgICAgICBjb25zdCBzbG90Q2FsbGJhY2sgPSBtZXRhSnNvbkNyZWF0aXZlR3JvdXBlcihcbiAgICAgICAgICAgICAgICAgIChjcmVhdGl2ZSwgaGVhZGVyc09iaiwgZG9uZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjaGVja1N0aWxsQ3VycmVudCgpO1xuICAgICAgICAgICAgICAgICAgICBzcmFCbG9ja0NhbGxiYWNrSGFuZGxlcihjcmVhdGl2ZSwgaGVhZGVyc09iaiwgZG9uZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyYVJlcXVlc3RBZFVybFJlc29sdmVycywgc3JhVXJsKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAvLyBUT0RPKGtlaXRod3JpZ2h0Ym9zKSAtIGhvdyBkbyB3ZSBoYW5kbGUgcGVyIHNsb3QgMjA0IHJlc3BvbnNlP1xuICAgICAgICAgICAgICByZXR1cm4gY29uc3RydWN0U1JBUmVxdWVzdF8odGhpcywgdHlwZUluc3RhbmNlcylcbiAgICAgICAgICAgICAgICAgIC50aGVuKHNyYVVybEluID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tTdGlsbEN1cnJlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgc3JhVXJsID0gc3JhVXJsSW47XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBTZXJ2aWNlcy54aHJGb3IodGhpcy53aW4pLmZldGNoKHNyYVVybCwge1xuICAgICAgICAgICAgICAgICAgICAgIG1vZGU6ICdjb3JzJyxcbiAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgICAgICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZScsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tTdGlsbEN1cnJlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgbGluZURlbGltaXRlZFN0cmVhbWVyKHRoaXMud2luLCByZXNwb25zZSwgc2xvdENhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHR5cGVJbnN0YW5jZXMubWFwKFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UgPT4gaW5zdGFuY2Uuc3JhRGVmZXJyZWQucHJvbWlzZSkpO1xuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0NhbmNlbGxhdGlvbihlcnJvcikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAvLyBDYW5jZWxsYXRpb24gc2hvdWxkIGJlIHByb3BhZ2F0ZWQgdG8gc2xvdCBwcm9taXNlc1xuICAgICAgICAgICAgICAgICAgICAgIC8vIGNhdXNpbmcgdGhlaXIgYWRQcm9taXNlIGNoYWlucyB3aXRoaW4gQTRBIHRvIGhhbmRsZVxuICAgICAgICAgICAgICAgICAgICAgIC8vIGFwcHJvcHJpYXRlbHkuXG4gICAgICAgICAgICAgICAgICAgICAgdHlwZUluc3RhbmNlcy5mb3JFYWNoKGluc3RhbmNlID0+IGluc3RhbmNlLnNyYURlZmVycmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5zcmFEZWZlcnJlZC5yZWplY3QoZXJyb3IpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub0ZhbGxiYWNrRXhwIHx8XG4gICAgICAgICAgICAgICAgICAgICAgISF0aGlzLndpbi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAnbWV0YVtuYW1lPWFtcC1hZC1kb3VibGVjbGljay1zcmFdJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBwdWJsaXNoZXIgaGFzIGV4cGxpY2l0bHkgZW5hYmxlZCBTUkEgbW9kZSAobm90XG4gICAgICAgICAgICAgICAgICAgICAgLy8gZXhwZXJpbWVudCksIHRoZW4gYXNzdW1lIGVycm9yIGlzIG5ldHdvcmsgZmFpbHVyZSxcbiAgICAgICAgICAgICAgICAgICAgICAvLyBjb2xsYXBzZSBzbG90LCByZXNldCB1cmwgdG8gZW1wdHkgc3RyaW5nIHRvIGVuc3VyZVxuICAgICAgICAgICAgICAgICAgICAgIC8vIG5vIGZhbGxiYWNrIHRvIGZyYW1lIEdFVCAoZ2l2ZW4gZXhwZWN0YXRpb24gb2YgU1JBXG4gICAgICAgICAgICAgICAgICAgICAgLy8gY29uc2lzdGVuY3kpLCBhbmQgcHJvcGFnYXRlIGVycm9yIHRvIEE0QSBhZCBwcm9taXNlXG4gICAgICAgICAgICAgICAgICAgICAgLy8gY2hhaW4uXG4gICAgICAgICAgICAgICAgICAgICAgYXNzaWduQWRVcmxUb0Vycm9yKC8qKiBAdHlwZSB7IUVycm9yfSAqLyhlcnJvciksIHNyYVVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy53YXJuT25FcnJvcignU1JBIHJlcXVlc3QgZmFpbHVyZScsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAvLyBQdWJsaXNoZXIgZXhwbGljaXRseSB3YW50cyBTUkEgc28gZG8gbm90IGF0dGVtcHQgdG9cbiAgICAgICAgICAgICAgICAgICAgICAvLyByZWNvdmVyIGFzIFNSQSBndWFyYW50ZWVzIGNhbm5vdCBiZSBlbmZvcmNlZC5cbiAgICAgICAgICAgICAgICAgICAgICB0eXBlSW5zdGFuY2VzLmZvckVhY2goaW5zdGFuY2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVzZXQgYWQgdXJsIHRvIGVuc3VyZSBsYXlvdXRDYWxsYmFjayBkb2VzIG5vdFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmFsbGJhY2sgdG8gZnJhbWUgZ2V0IHdoaWNoIHdvdWxkIGxvc2UgU1JBXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBndWFyYW50ZWVzLlxuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UucmVzZXRBZFVybCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuYXR0ZW1wdENvbGxhcHNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5zcmFEZWZlcnJlZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIC8vIE9wcG9ydHVuaXN0aWMgU1JBIHVzZWQgc28gZmFsbGJhY2sgdG8gaW5kaXZpZHVhbFxuICAgICAgICAgICAgICAgICAgICAgIC8vIFhIUiByZXF1ZXN0cy5cbiAgICAgICAgICAgICAgICAgICAgICB0eXBlSW5zdGFuY2VzLmZvckVhY2goaW5zdGFuY2UgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLnNyYURlZmVycmVkLnJlc29sdmUobnVsbCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoc3JhUmVxdWVzdFByb21pc2VzKTtcbiAgICAgICAgfSk7XG4gICAgcmV0dXJuIHNyYVJlcXVlc3RzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gICAqIEBwYXJhbSB7Kn0gZXJyb3JcbiAgICogQHZpc2libGVGb3JUZXN0aW5nXG4gICAqL1xuICB3YXJuT25FcnJvcihtZXNzYWdlLCBlcnJvcikge1xuICAgIGRldigpLndhcm4oVEFHLCBtZXNzYWdlLCBlcnJvcik7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGdldFByZWNvbm5lY3RVcmxzKCkge1xuICAgIHJldHVybiBbJ2h0dHBzOi8vc2VjdXJlcHViYWRzLmcuZG91YmxlY2xpY2submV0LyddO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBnZXROb25BbXBDcmVhdGl2ZVJlbmRlcmluZ01ldGhvZChoZWFkZXJWYWx1ZSkge1xuICAgIHJldHVybiB0aGlzLmZvcmNlU2FmZWZyYW1lIHx8IHRoaXMuaXNGbHVpZFJlcXVlc3RfXG4gICAgICA/IFhPUklHSU5fTU9ERS5TQUZFRlJBTUVcbiAgICAgIDogc3VwZXIuZ2V0Tm9uQW1wQ3JlYXRpdmVSZW5kZXJpbmdNZXRob2QoaGVhZGVyVmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIE5vdGUgdGhhdCBsb2NhdGlvbiBpcyBwYXJzZWQgb25jZSBvbiBmaXJzdCBhY2Nlc3MgYW5kIGNhY2hlZC5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHBhcmFtZXRlck5hbWVcbiAgICogQHJldHVybiB7c3RyaW5nfHVuZGVmaW5lZH0gcGFyYW1ldGVyIHZhbHVlIGZyb20gd2luZG93LmxvY2F0aW9uLnNlYXJjaFxuICAgKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAgICovXG4gIGdldExvY2F0aW9uUXVlcnlQYXJhbWV0ZXJWYWx1ZShwYXJhbWV0ZXJOYW1lKSB7XG4gICAgd2luZG93TG9jYXRpb25RdWVyeVBhcmFtZXRlcnMgPSB3aW5kb3dMb2NhdGlvblF1ZXJ5UGFyYW1ldGVycyB8fFxuICAgICAgICBwYXJzZVF1ZXJ5U3RyaW5nKCh0aGlzLndpbi5sb2NhdGlvbiAmJiB0aGlzLndpbi5sb2NhdGlvbi5zZWFyY2gpIHx8ICcnKTtcbiAgICByZXR1cm4gd2luZG93TG9jYXRpb25RdWVyeVBhcmFtZXRlcnNbcGFyYW1ldGVyTmFtZV07XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGdldEFkZGl0aW9uYWxDb250ZXh0TWV0YWRhdGEoaXNTYWZlRnJhbWUgPSBmYWxzZSkge1xuICAgIGlmICghdGhpcy5pc0ZsdWlkUmVxdWVzdF8gJiYgIWlzU2FmZUZyYW1lKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGNyZWF0aXZlU2l6ZSA9IHRoaXMuZ2V0Q3JlYXRpdmVTaXplKCk7XG4gICAgZGV2KCkuYXNzZXJ0KGNyZWF0aXZlU2l6ZSwgJ3RoaXMuZ2V0Q3JlYXRpdmVTaXplIHJldHVybmVkIG51bGwnKTtcbiAgICB0aGlzLnNhZmVmcmFtZUFwaV8gPSB0aGlzLnNhZmVmcmFtZUFwaV8gfHxcbiAgICAgICAgbmV3IFNhZmVmcmFtZUhvc3RBcGkoXG4gICAgICAgICAgICB0aGlzLCB0aGlzLmlzRmx1aWRSZXF1ZXN0XyxcbiAgICAgICAgICAgIC8qKiBAdHlwZSB7e2hlaWdodCwgd2lkdGh9fSAqLyhjcmVhdGl2ZVNpemUpLFxuICAgICAgICAgICAgdGhpcy5mbHVpZEltcHJlc3Npb25VcmxfKTtcblxuICAgIHJldHVybiB0aGlzLnNhZmVmcmFtZUFwaV8uZ2V0U2FmZWZyYW1lTmFtZUF0dHIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbWl0cyBhIHBvc3RNZXNzYWdlIGNvbnRhaW5pbmcgaW5mb3JtYXRpb24gYWJvdXQgdGhpcyBzbG90IHRvIHRoZSBERlBcbiAgICogVHJvdWJsZXNob290IFVJLiBBIHByb21pc2UgaXMgcmV0dXJuZWQgaWYgYSBtZXNzYWdlIGlzIHBvc3RlZCwgb3RoZXJ3aXNlXG4gICAqIG51bGwgaXMgcmV0dXJuZWQuIFRoZSBwcm9taXNlIGlzIHJldHVybmVkIG9ubHkgZm9yIHRlc3QgY29udmVuaWVuY2UuXG4gICAqXG4gICAqIEByZXR1cm4gez9Qcm9taXNlfVxuICAgKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAgICovXG4gIHBvc3RUcm91Ymxlc2hvb3RNZXNzYWdlKCkge1xuICAgIGlmICghdGhpcy53aW4ub3BlbmVyIHx8ICEvWz98Jl1kZnBkZWIvLnRlc3QodGhpcy53aW4ubG9jYXRpb24uc2VhcmNoKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGRldigpLmFzc2VydCh0aGlzLnRyb3VibGVzaG9vdERhdGFfLmFkVXJsLCAnYWQgVVJMIGRvZXMgbm90IGV4aXN0IHlldCcpO1xuICAgIHJldHVybiB0aGlzLnRyb3VibGVzaG9vdERhdGFfLmFkVXJsLnRoZW4oYWRVcmwgPT4ge1xuICAgICAgY29uc3Qgc2xvdElkID0gdGhpcy50cm91Ymxlc2hvb3REYXRhXy5zbG90SWQgKyAnXycgK1xuICAgICAgICAgIHRoaXMudHJvdWJsZXNob290RGF0YV8uc2xvdEluZGV4O1xuICAgICAgY29uc3QgcGF5bG9hZCA9IGRpY3Qoe1xuICAgICAgICAnZ3V0RGF0YSc6IEpTT04uc3RyaW5naWZ5KGRpY3Qoe1xuICAgICAgICAgICdldmVudHMnOiBbe1xuICAgICAgICAgICAgJ3RpbWVzdGFtcCc6IERhdGUubm93KCksXG4gICAgICAgICAgICAnc2xvdGlkJzogc2xvdElkLFxuICAgICAgICAgICAgJ21lc3NhZ2VJZCc6IDQsXG4gICAgICAgICAgfV0sXG4gICAgICAgICAgJ3Nsb3RzJzogW3tcbiAgICAgICAgICAgICdjb250ZW50VXJsJzogYWRVcmwgfHwgJycsXG4gICAgICAgICAgICAnaWQnOiBzbG90SWQsXG4gICAgICAgICAgICAnbGVhZkFkVW5pdE5hbWUnOiB0aGlzLnRyb3VibGVzaG9vdERhdGFfLnNsb3RJZCxcbiAgICAgICAgICAgICdkb21JZCc6IHNsb3RJZCxcbiAgICAgICAgICAgICdsaW5lSXRlbUlkJzogdGhpcy50cm91Ymxlc2hvb3REYXRhXy5saW5lSXRlbUlkLFxuICAgICAgICAgICAgJ2NyZWF0aXZlSWQnOiB0aGlzLnRyb3VibGVzaG9vdERhdGFfLmNyZWF0aXZlSWQsXG4gICAgICAgICAgfV0sXG4gICAgICAgIH0pKSxcbiAgICAgICAgJ3VzZXJBZ2VudCc6IG5hdmlnYXRvci51c2VyQWdlbnQsXG4gICAgICAgICdyZWZlcnJlcic6IHRoaXMud2luLmxvY2F0aW9uLmhyZWYsXG4gICAgICAgICdtZXNzYWdlVHlwZSc6ICdMT0FEJyxcbiAgICAgIH0pO1xuICAgICAgdGhpcy53aW4ub3BlbmVyLi8qT0sqL3Bvc3RNZXNzYWdlKHBheWxvYWQsICcqJyk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgcGFnZXZpZXcgc3RhdGUgdG9rZW4gYXNzb2NpYXRlZCB3aXRoIHRoZSBzbG90LiBUb2tlbiBkb2VzIG5vdFxuICAgKiBleHBpcmUuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0b2tlblxuICAgKi9cbiAgc2V0UGFnZXZpZXdTdGF0ZVRva2VuKHRva2VuKSB7XG4gICAgdG9rZW5zVG9JbnN0YW5jZXNbdG9rZW5dID0gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgZm9yIHRoZSBwcmVzZW5jZSBvZiBhIHBhZ2V2aWV3IHRva2VuIGluIHRoZSBtb2R1bGUgbGV2ZWwgb2JqZWN0XG4gICAqIGFuZCByZW1vdmVzIGl0IGlmIHByZXNlbnQuXG4gICAqL1xuICByZW1vdmVQYWdldmlld1N0YXRlVG9rZW4oKSB7XG4gICAgZm9yIChjb25zdCB0b2tlbiBpbiB0b2tlbnNUb0luc3RhbmNlcykge1xuICAgICAgaWYgKHRva2Vuc1RvSW5zdGFuY2VzW3Rva2VuXSA9PSB0aGlzKSB7XG4gICAgICAgIGRlbGV0ZSB0b2tlbnNUb0luc3RhbmNlc1t0b2tlbl07XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgZ2V0QTRhQW5hbHl0aWNzVmFycyhhbmFseXRpY3NUcmlnZ2VyKSB7XG4gICAgcmV0dXJuIGdldENzaUFtcEFuYWx5dGljc1ZhcmlhYmxlcyhhbmFseXRpY3NUcmlnZ2VyLCB0aGlzLCB0aGlzLnFxaWRfKTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgZ2V0QTRhQW5hbHl0aWNzQ29uZmlnKCkge1xuICAgIHJldHVybiBnZXRDc2lBbXBBbmFseXRpY3NDb25maWcoKTtcbiAgfVxufVxuXG5BTVAuZXh0ZW5zaW9uKFRBRywgJzAuMScsIEFNUCA9PiB7XG4gIEFNUC5yZWdpc3RlckVsZW1lbnQoVEFHLCBBbXBBZE5ldHdvcmtEb3VibGVjbGlja0ltcGwpO1xufSk7XG5cblxuLyoqIEB2aXNpYmxlRm9yVGVzdGluZyAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0U3JhU3RhdGVGb3JUZXN0aW5nKCkge1xuICBzcmFSZXF1ZXN0cyA9IG51bGw7XG59XG5cbi8qKiBAdmlzaWJsZUZvclRlc3RpbmcgKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldExvY2F0aW9uUXVlcnlQYXJhbWV0ZXJzRm9yVGVzdGluZygpIHtcbiAgd2luZG93TG9jYXRpb25RdWVyeVBhcmFtZXRlcnMgPSBudWxsO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge3N0cmluZ30gbmV0d29ya0lkIGZyb20gZGF0YS1hZC1zbG90IGF0dHJpYnV0ZS5cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmV0d29ya0lkKGVsZW1lbnQpIHtcbiAgY29uc3QgbmV0d29ya0lkID0gL14oPzpcXC8pPyhcXGQrKS8uZXhlYyhcbiAgICAgIGRldigpLmFzc2VydFN0cmluZyhlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1zbG90JykpKTtcbiAgLy8gVE9ETzogZ3VhcmFudGVlIGRhdGEtYWQtc2xvdCBmb3JtYXQgYXMgcGFydCBvZiBpc1ZhbGlkRWxlbWVudD9cbiAgcmV0dXJuIG5ldHdvcmtJZCA/IG5ldHdvcmtJZFsxXSA6ICcnO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshLi4vLi4vLi4vZXh0ZW5zaW9ucy9hbXAtYTRhLzAuMS9hbXAtYTRhLkFtcEE0QX0gYTRhXG4gKiBAcGFyYW0geyFBcnJheTwhQW1wQWROZXR3b3JrRG91YmxlY2xpY2tJbXBsPn0gaW5zdGFuY2VzXG4gKiBAcmV0dXJuIHshUHJvbWlzZTxzdHJpbmc+fSBTUkEgcmVxdWVzdCBVUkxcbiAqL1xuZnVuY3Rpb24gY29uc3RydWN0U1JBUmVxdWVzdF8oYTRhLCBpbnN0YW5jZXMpIHtcbiAgLy8gVE9ETyhicmFkZnJpenplbGwpOiBOZWVkIHRvIGFkZCBzdXBwb3J0IGZvciBSVEMuXG4gIGRldigpLmFzc2VydChpbnN0YW5jZXMgJiYgaW5zdGFuY2VzLmxlbmd0aCk7XG4gIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gIHJldHVybiBQcm9taXNlLmFsbChcbiAgICAgIGluc3RhbmNlcy5tYXAoaW5zdGFuY2UgPT4gaW5zdGFuY2UuZ2V0QWRVcmxEZWZlcnJlZC5wcm9taXNlKSlcbiAgICAgIC50aGVuKCgpID0+IGdvb2dsZVBhZ2VQYXJhbWV0ZXJzKGE0YSwgc3RhcnRUaW1lKSlcbiAgICAgIC50aGVuKGdvb2dQYWdlTGV2ZWxQYXJhbWV0ZXJzID0+IHtcbiAgICAgICAgY29uc3QgYmxvY2tQYXJhbWV0ZXJzID0gY29uc3RydWN0U1JBQmxvY2tQYXJhbWV0ZXJzKGluc3RhbmNlcyk7XG4gICAgICAgIHJldHVybiB0cnVuY0FuZFRpbWVVcmwoRE9VQkxFQ0xJQ0tfQkFTRV9VUkwsXG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKGJsb2NrUGFyYW1ldGVycywgZ29vZ1BhZ2VMZXZlbFBhcmFtZXRlcnMsXG4gICAgICAgICAgICAgICAgaW5zdGFuY2VzWzBdLmdldFBhZ2VQYXJhbWV0ZXJzKGluc3RhbmNlc1swXS5jb25zZW50U3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlcykpLCBzdGFydFRpbWUpO1xuICAgICAgfSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgcGFnZXZpZXcgdG9rZW5zIHRoYXQgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZSBhZCByZXF1ZXN0LiBUb2tlbnNcbiAqIHNob3VsZCBjb21lIG9ubHkgZnJvbSBpbnN0YW5jZXMgdGhhdCBhcmUgbm90IGJlaW5nIHJlcXVlc3RlZCBpbiB0aGlzIHJlcXVlc3QuXG4gKiBAcGFyYW0geyFBcnJheTwhQW1wQWROZXR3b3JrRG91YmxlY2xpY2tJbXBsPn0gaW5zdGFuY2VzSW5BZFJlcXVlc3RcbiAqIEByZXR1cm4geyFBcnJheTxzdHJpbmc+fSBBcnJheSBvZiBwYWdldmlldyB0b2tlbnMgdG8gaW5jbHVkZSBpbiB0aGUgYWRcbiAqIHJlcXVlc3QuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYWdldmlld1N0YXRlVG9rZW5zRm9yQWRSZXF1ZXN0KGluc3RhbmNlc0luQWRSZXF1ZXN0KSB7XG4gIGNvbnN0IHBhZ2V2aWV3U3RhdGVUb2tlbnNJbkFkUmVxdWVzdCA9IFtdO1xuICBmb3IgKGNvbnN0IHRva2VuIGluIHRva2Vuc1RvSW5zdGFuY2VzKSB7XG4gICAgaWYgKCFpbnN0YW5jZXNJbkFkUmVxdWVzdC5pbmNsdWRlcyhcbiAgICAgICAgdG9rZW5zVG9JbnN0YW5jZXNbdG9rZW5dKSkge1xuICAgICAgcGFnZXZpZXdTdGF0ZVRva2Vuc0luQWRSZXF1ZXN0LnB1c2godG9rZW4pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcGFnZXZpZXdTdGF0ZVRva2Vuc0luQWRSZXF1ZXN0O1xufVxuXG4vKipcbiAqIFJlc2V0cyB0aGUgdG9rZW5zVG9JbnN0YW5jZXMgbWFwcGluZyBmb3IgdGVzdGluZyBwdXJwb3Nlcy5cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRUb2tlbnNUb0luc3RhbmNlc01hcCgpIHtcbiAgdG9rZW5zVG9JbnN0YW5jZXMgPSB7fTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi8uLi8uLi9zcmMvc2VydmljZXMnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4uLy4uLy4uL3NyYy9sb2cnO1xuaW1wb3J0IHtkaWN0LCBoYXNPd259IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtnZXREYXRhfSBmcm9tICcuLi8uLi8uLi9zcmMvZXZlbnQtaGVscGVyJztcbmltcG9ydCB7Z2V0U3R5bGV9IGZyb20gJy4uLy4uLy4uL3NyYy9zdHlsZSc7XG5pbXBvcnQge3BhcnNlVXJsRGVwcmVjYXRlZH0gZnJvbSAnLi4vLi4vLi4vc3JjL3VybCc7XG5pbXBvcnQge3NldFN0eWxlc30gZnJvbSAnLi4vLi4vLi4vc3JjL3N0eWxlJztcbmltcG9ydCB7dGhyb3R0bGV9IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9yYXRlLWxpbWl0JztcbmltcG9ydCB7dHJ5UGFyc2VKc29ufSBmcm9tICcuLi8uLi8uLi9zcmMvanNvbic7XG5cbi8qKlxuICogVXNlZCB0byBtYW5hZ2UgbWVzc2FnZXMgZm9yIGRpZmZlcmVudCBTYWZlZnJhbWUgYWQgc2xvdHMuXG4gKlxuICogTWFwcyBhIHNlbnRpbmVsIHZhbHVlIHRvIGFuIGluc3RhbmNlIG9mIHRoZSBTYWZlZnJhbWVIb3N0QXBpIHRvIHdoaWNoIHRoYXRcbiAqIHNlbnRpbmVsIHZhbHVlIGJlbG9uZ3MuXG4gKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsICFTYWZlZnJhbWVIb3N0QXBpPn1cbiAqL1xuZXhwb3J0IGNvbnN0IHNhZmVmcmFtZUhvc3RzID0ge307XG5cbi8qKiBAcHJpdmF0ZSB7Ym9vbGVhbn0gKi9cbmxldCBzYWZlZnJhbWVMaXN0ZW5lckNyZWF0ZWRfID0gZmFsc2U7XG5cbi8qKiBAZW51bSB7c3RyaW5nfSAqL1xuZXhwb3J0IGNvbnN0IE1FU1NBR0VfRklFTERTID0ge1xuICBDSEFOTkVMOiAnYycsXG4gIFNFTlRJTkVMOiAnZScsXG4gIEVORFBPSU5UX0lERU5USVRZOiAnaScsXG4gIFBBWUxPQUQ6ICdwJyxcbiAgU0VSVklDRTogJ3MnLFxuICBNRVNTQUdFOiAnbWVzc2FnZScsXG59O1xuXG4vKiogQGVudW0ge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBTRVJWSUNFID0ge1xuICBHRU9NRVRSWV9VUERBVEU6ICdnZW9tZXRyeV91cGRhdGUnLFxuICBDUkVBVElWRV9HRU9NRVRSWV9VUERBVEU6ICdjcmVhdGl2ZV9nZW9tZXRyeV91cGRhdGUnLFxuICBFWFBBTkRfUkVRVUVTVDogJ2V4cGFuZF9yZXF1ZXN0JyxcbiAgRVhQQU5EX1JFU1BPTlNFOiAnZXhwYW5kX3Jlc3BvbnNlJyxcbiAgUkVHSVNURVJfRE9ORTogJ3JlZ2lzdGVyX2RvbmUnLFxuICBDT0xMQVBTRV9SRVFVRVNUOiAnY29sbGFwc2VfcmVxdWVzdCcsXG4gIENPTExBUFNFX1JFU1BPTlNFOiAnY29sbGFwc2VfcmVzcG9uc2UnLFxuICBSRVNJWkVfUkVRVUVTVDogJ3Jlc2l6ZV9yZXF1ZXN0JyxcbiAgUkVTSVpFX1JFU1BPTlNFOiAncmVzaXplX3Jlc3BvbnNlJyxcbn07XG5cbi8qKiBAcHJpdmF0ZSB7c3RyaW5nfSAqL1xuY29uc3QgVEFHID0gJ0FNUC1ET1VCTEVDTElDSy1TQUZFRlJBTUUnO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgU0FGRUZSQU1FX09SSUdJTiA9ICdodHRwczovL3RwYy5nb29nbGVzeW5kaWNhdGlvbi5jb20nO1xuXG4vKipcbiAqIEV2ZW50IGxpc3RlbmVyIGNhbGxiYWNrIGZvciBtZXNzYWdlIGV2ZW50cy4gSWYgbWVzc2FnZSBpcyBhIFNhZmVmcmFtZVxuICogbWVzc2FnZSwgaGFuZGxlcyB0aGUgbWVzc2FnZS4gVGhpcyBsaXN0ZW5lciBpcyByZWdpc3RlcmVkIHdpdGhpblxuICogU2FmZWZyYW1lSG9zdEFwaS5cbiAqIEBwYXJhbSB7IUV2ZW50fSBldmVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gc2FmZWZyYW1lTGlzdGVuZXIoZXZlbnQpIHtcbiAgY29uc3QgZGF0YSA9IHRyeVBhcnNlSnNvbihnZXREYXRhKGV2ZW50KSk7XG4gIC8qKiBPbmx5IHByb2Nlc3MgbWVzc2FnZXMgdGhhdCBhcmUgdmFsaWQgU2FmZWZyYW1lIG1lc3NhZ2VzICovXG4gIGlmIChldmVudC5vcmlnaW4gIT0gU0FGRUZSQU1FX09SSUdJTiB8fCAhZGF0YSkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBwYXlsb2FkID0gdHJ5UGFyc2VKc29uKGRhdGFbTUVTU0FHRV9GSUVMRFMuUEFZTE9BRF0pIHx8IHt9O1xuICAvKipcbiAgICogSWYgdGhlIHNlbnRpbmVsIGlzIHByb3ZpZGVkIGF0IHRoZSB0b3AgbGV2ZWwsIHRoaXMgaXMgYSBtZXNzYWdlIHNpbXBseVxuICAgKiB0byBzZXR1cCB0aGUgcG9zdE1lc3NhZ2UgY2hhbm5lbCwgc28gc2V0IGl0IHVwLlxuICAgKi9cbiAgY29uc3Qgc2VudGluZWwgPSBkYXRhW01FU1NBR0VfRklFTERTLlNFTlRJTkVMXSB8fCBwYXlsb2FkWydzZW50aW5lbCddO1xuICBjb25zdCBzYWZlZnJhbWVIb3N0ID0gc2FmZWZyYW1lSG9zdHNbc2VudGluZWxdO1xuICBpZiAoIXNhZmVmcmFtZUhvc3QpIHtcbiAgICBkZXYoKS53YXJuKFRBRywgYFNhZmVmcmFtZSBIb3N0IGZvciBzZW50aW5lbDogJHtzZW50aW5lbH0gbm90IGZvdW5kLmApO1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoIXNhZmVmcmFtZUhvc3QuY2hhbm5lbCkge1xuICAgIHNhZmVmcmFtZUhvc3QuY29ubmVjdE1lc3NhZ2luZ0NoYW5uZWwoZGF0YVtNRVNTQUdFX0ZJRUxEUy5DSEFOTkVMXSk7XG4gIH0gZWxzZSBpZiAocGF5bG9hZCkge1xuICAgIC8vIEN1cnJlbnRseSB3ZSBkbyBub3QgZXhwZWN0IGEgcGF5bG9hZCBvbiBpbml0aWFsIGNvbm5lY3Rpb24gbWVzc2FnZXMuXG4gICAgc2FmZWZyYW1lSG9zdC5wcm9jZXNzTWVzc2FnZSgvKiogQHR5cGUgeyFKc29uT2JqZWN0fSAqLyhwYXlsb2FkKSxcbiAgICAgICAgZGF0YVtNRVNTQUdFX0ZJRUxEUy5TRVJWSUNFXSk7XG4gIH1cbn1cblxuLyoqXG4gKiBTZXRzIHVwIHRoZSBob3N0IEFQSSBmb3IgRG91YmxlQ2xpY2sgU2FmZWZyYW1lIHRvIGFsbG93IHRoZSBmb2xsb3dpbmdcbiAqIFNhZmVmcmFtZSBjb250YWluZXIgQVBJcyB0byB3b3JrOlxuICogICAtICRzZi5leHQuZXhwYW5kKClcbiAqICAgLSAkc2YuZXh0LmNvbGxhcHNlKClcbiAqICAgLSAkc2YuZXh0Lmdlb20oKSBFeHBhbmQgYW5kIGNvbGxhcHNlIGFyZSBib3RoIGltcGxlbWVudGVkIHV0aWxpemluZyBBTVAnc1xuICogICAgIGJ1aWx0IGluIGVsZW1lbnQgcmVzaXppbmcuXG4gKlxuICogRm9yIGdlb20sIHRoZSBob3N0IG5lZWRzIHRvIHNlbmQgZ2VvbWV0cnkgdXBkYXRlcyBpbnRvIHRoZSBjb250YWluZXIgd2hlbmV2ZXJcbiAqICBhIHBvc2l0aW9uIGNoYW5nZSBoYXBwZW5zLCBhdCBhIG1heCBmcmVxdWVuY3kgb2YgMSBtZXNzYWdlL3NlY29uZC4gVG9cbiAqICBpbXBsZW1lbnQgdGhpcyBtZXNzYWdpbmcsIHdlIGFyZSBsZXZlcmFnaW5nIHRoZSBleGlzdGluZ1xuICogIEludGVyc2VjdGlvbk9ic2VydmVyIGNsYXNzIHRoYXQgd29ya3Mgd2l0aCBBTVAgZWxlbWVudHMuIEhvd2V2ZXIsIHRoZVxuICogIHNhZmVmcmFtZSBpZnJhbWUgdGhhdCB3ZSBuZWVkIHRvIG1vbml0b3IgaXMgbm90IGFuIEFNUCBlbGVtZW50LCBidXQgcmF0aGVyXG4gKiAgY29udGFpbmVkIHdpdGhpbiBhbiBhbXAtYWQuIFNvLCB3ZSBhcmUgZG9pbmcgaW50ZXJzZWN0aW9uIG9ic2VydmluZyBvbiB0aGVcbiAqICBhbXAtYWQsIGFuZCBjYWxjdWxhdGluZyB0aGUgY29ycmVjdCBwb3NpdGlvbiBmb3IgdGhlIGlmcmFtZSB3aGVuZXZlciB3ZSBnZXRcbiAqICBhbiB1cGRhdGUuXG4gKlxuICogV2UgcGFzcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzIGludG8gdGhlIEludGVyc2VjdGlvbk9ic2VydmVyIGNsYXNzLCB3aGljaFxuICogIHRoZW4gY2FsbHMgdGhlIGluc3RhbmNlIG9mIHNlbmQoKSBiZWxvdyB3aGVuZXZlciBhbiB1cGRhdGUgb2NjdXJzLlxuICovXG5leHBvcnQgY2xhc3MgU2FmZWZyYW1lSG9zdEFwaSB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4vYW1wLWFkLW5ldHdvcmstZG91YmxlY2xpY2staW1wbC5BbXBBZE5ldHdvcmtEb3VibGVjbGlja0ltcGx9IGJhc2VJbnN0YW5jZVxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzRmx1aWRcbiAgICogQHBhcmFtIHt7d2lkdGg6bnVtYmVyLCBoZWlnaHQ6bnVtYmVyfX0gY3JlYXRpdmVTaXplXG4gICAqIEBwYXJhbSB7P3N0cmluZ30gZmx1aWRJbXByZXNzaW9uVXJsXG4gICAqL1xuICBjb25zdHJ1Y3RvcihiYXNlSW5zdGFuY2UsIGlzRmx1aWQsIGNyZWF0aXZlU2l6ZSwgZmx1aWRJbXByZXNzaW9uVXJsKSB7XG4gICAgLyoqIEBwcml2YXRlIHshLi9hbXAtYWQtbmV0d29yay1kb3VibGVjbGljay1pbXBsLkFtcEFkTmV0d29ya0RvdWJsZWNsaWNrSW1wbH0gKi9cbiAgICB0aGlzLmJhc2VJbnN0YW5jZV8gPSBiYXNlSW5zdGFuY2U7XG5cbiAgICAvKiogQHByaXZhdGUgeyFGdW5jdGlvbn0gKi9cbiAgICB0aGlzLmNoZWNrU3RpbGxDdXJyZW50XyA9IHRoaXMuYmFzZUluc3RhbmNlXy52ZXJpZnlTdGlsbEN1cnJlbnQuYmluZChcbiAgICAgICAgdGhpcy5iYXNlSW5zdGFuY2VfKSgpO1xuXG4gICAgLyoqIEBwcml2YXRlIHshV2luZG93fSAqL1xuICAgIHRoaXMud2luXyA9IHRoaXMuYmFzZUluc3RhbmNlXy53aW47XG5cbiAgICAvKiogQHByaXZhdGUge3N0cmluZ30gKi9cbiAgICB0aGlzLnNlbnRpbmVsXyA9IHRoaXMuYmFzZUluc3RhbmNlXy5zZW50aW5lbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P0VsZW1lbnR9ICovXG4gICAgdGhpcy5pZnJhbWVfID0gbnVsbDtcblxuICAgIC8qKiBAdHlwZSB7P3N0cmluZ30gKi9cbiAgICB0aGlzLmNoYW5uZWwgPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/SnNvbk9iamVjdH0gKi9cbiAgICB0aGlzLmN1cnJlbnRHZW9tZXRyeV8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5lbmRwb2ludElkZW50aXR5XyA9IE1hdGgucmFuZG9tKCk7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnVpZF8gPSBNYXRoLnJhbmRvbSgpO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuaXNGbHVpZF8gPSBpc0ZsdWlkO1xuXG4gICAgLyoqIEBwcml2YXRlIHt7d2lkdGg6bnVtYmVyLCBoZWlnaHQ6bnVtYmVyfX0gKi9cbiAgICB0aGlzLmNyZWF0aXZlU2l6ZV8gPSBjcmVhdGl2ZVNpemU7XG5cbiAgICAvKiogQHByaXZhdGUge3t3aWR0aDpudW1iZXIsIGhlaWdodDpudW1iZXJ9fSAqL1xuICAgIHRoaXMuaW5pdGlhbENyZWF0aXZlU2l6ZV8gPVxuICAgICAgLyoqIEBwcml2YXRlIHt7d2lkdGg6bnVtYmVyLCBoZWlnaHQ6bnVtYmVyfX0gKi9cbiAgICAgIChPYmplY3QuYXNzaWduKHt9LCBjcmVhdGl2ZVNpemUpKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P3N0cmluZ30gKi9cbiAgICB0aGlzLmZsdWlkSW1wcmVzc2lvblVybF8gPSBmbHVpZEltcHJlc3Npb25Vcmw7XG5cbiAgICAvKiogQHByaXZhdGUgez9Qcm9taXNlfSAqL1xuICAgIHRoaXMuZGVsYXlfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7Li4vLi4vLi4vc3JjL3NlcnZpY2Uvdmlld3BvcnQvdmlld3BvcnQtaW1wbC5WaWV3cG9ydH0gKi9cbiAgICB0aGlzLnZpZXdwb3J0XyA9IHRoaXMuYmFzZUluc3RhbmNlXy5nZXRWaWV3cG9ydCgpO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuaXNDb2xsYXBzZWRfID0gdHJ1ZTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7Ym9vbGVhbn0gKi9cbiAgICB0aGlzLmlzUmVnaXN0ZXJlZF8gPSBmYWxzZTtcblxuICAgIC8vIFRPRE86IE1ha2UgdGhpcyBwYWdlLWxldmVsLlxuICAgIGNvbnN0IHNmQ29uZmlnID0gT2JqZWN0KHRyeVBhcnNlSnNvbihcbiAgICAgICAgdGhpcy5iYXNlSW5zdGFuY2VfLmVsZW1lbnQuZ2V0QXR0cmlidXRlKFxuICAgICAgICAgICAgJ2RhdGEtc2FmZWZyYW1lLWNvbmZpZycpKSB8fCB7fSk7XG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuZXhwYW5kQnlPdmVybGF5XyA9IGhhc093bihzZkNvbmZpZywgJ2V4cGFuZEJ5T3ZlcmxheScpID9cbiAgICAgIHNmQ29uZmlnWydleHBhbmRCeU92ZXJsYXknXSA6IHRydWU7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy5leHBhbmRCeVB1c2hfID0gaGFzT3duKHNmQ29uZmlnLCAnZXhwYW5kQnlQdXNoJykgP1xuICAgICAgc2ZDb25maWdbJ2V4cGFuZEJ5UHVzaCddIDogdHJ1ZTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P0Z1bmN0aW9ufSAqL1xuICAgIHRoaXMudW5saXN0ZW5fID0gbnVsbDtcblxuICAgIHRoaXMucmVnaXN0ZXJTYWZlZnJhbWVIb3N0KCk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgU2FmZWZyYW1lIHNwZWNpZmljIG5hbWUgYXR0cmlidXRlcyB0aGF0IGFyZSBuZWVkZWQgZm9yIHRoZVxuICAgKiBTYWZlZnJhbWUgY3JlYXRpdmUgdG8gcHJvcGVybHkgc2V0dXAuXG4gICAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICAgKi9cbiAgZ2V0U2FmZWZyYW1lTmFtZUF0dHIoKSB7XG4gICAgY29uc3QgYXR0cmlidXRlcyA9IGRpY3Qoe30pO1xuICAgIGF0dHJpYnV0ZXNbJ3VpZCddID0gdGhpcy51aWRfO1xuICAgIGF0dHJpYnV0ZXNbJ2hvc3RQZWVyTmFtZSddID0gdGhpcy53aW5fLmxvY2F0aW9uLm9yaWdpbjtcbiAgICBhdHRyaWJ1dGVzWydpbml0aWFsR2VvbWV0cnknXSA9IHRoaXMuZ2V0SW5pdGlhbEdlb21ldHJ5KCk7XG4gICAgYXR0cmlidXRlc1sncGVybWlzc2lvbnMnXSA9IEpTT04uc3RyaW5naWZ5KFxuICAgICAgICBkaWN0KHtcbiAgICAgICAgICAnZXhwYW5kQnlPdmVybGF5JzogdGhpcy5leHBhbmRCeU92ZXJsYXlfLFxuICAgICAgICAgICdleHBhbmRCeVB1c2gnOiB0aGlzLmV4cGFuZEJ5UHVzaF8sXG4gICAgICAgICAgJ3JlYWRDb29raWUnOiBmYWxzZSxcbiAgICAgICAgICAnd3JpdGVDb29raWUnOiBmYWxzZSxcbiAgICAgICAgfSkpO1xuICAgIGF0dHJpYnV0ZXNbJ21ldGFkYXRhJ10gPSBKU09OLnN0cmluZ2lmeShcbiAgICAgICAgZGljdCh7XG4gICAgICAgICAgJ3NoYXJlZCc6IHtcbiAgICAgICAgICAgICdzZl92ZXInOiB0aGlzLmJhc2VJbnN0YW5jZV8uc2FmZWZyYW1lVmVyc2lvbixcbiAgICAgICAgICAgICdja19vbic6IDEsXG4gICAgICAgICAgICAnZmxhc2hfdmVyJzogJzI2LjAuMCcsXG4gICAgICAgICAgICAvLyBPbmNlIEdQVCBTYWZlZnJhbWUgaXMgdXBkYXRlZCB0byBsb29rIGluIGFtcCBvYmplY3QsXG4gICAgICAgICAgICAvLyByZW1vdmUgdGhpcyBjYW5vbmljYWxfdXJsIGhlcmUuXG4gICAgICAgICAgICAnY2Fub25pY2FsX3VybCc6IHRoaXMubWF5YmVHZXRDYW5vbmljYWxVcmwoKSxcbiAgICAgICAgICAgICdhbXAnOiB7XG4gICAgICAgICAgICAgICdjYW5vbmljYWxfdXJsJzogdGhpcy5tYXliZUdldENhbm9uaWNhbFVybCgpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSk7XG4gICAgYXR0cmlidXRlc1sncmVwb3J0Q3JlYXRpdmVHZW9tZXRyeSddID0gdGhpcy5pc0ZsdWlkXztcbiAgICBhdHRyaWJ1dGVzWydpc0RpZmZlcmVudFNvdXJjZVdpbmRvdyddID0gZmFsc2U7XG4gICAgYXR0cmlidXRlc1snc2VudGluZWwnXSA9IHRoaXMuc2VudGluZWxfO1xuICAgIHJldHVybiBhdHRyaWJ1dGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGNhbm9uaWNhbCBVUkwgb2YgdGhlIHBhZ2UsIGlmIHRoZSBwdWJsaXNoZXIgYWxsb3dzXG4gICAqIGl0IHRvIGJlIHBhc3NlZC5cbiAgICogQHJldHVybiB7c3RyaW5nfHVuZGVmaW5lZH1cbiAgICogQHZpc2libGVGb3JUZXN0aW5nXG4gICAqL1xuICBtYXliZUdldENhbm9uaWNhbFVybCgpIHtcbiAgICAvLyBEb24ndCBhbGxvdyBmb3IgcmVmZXJyZXIgcG9saWN5IHNhbWUtb3JpZ2luLFxuICAgIC8vIGFzIFNhZmVmcmFtZSB3aWxsIGFsd2F5cyBiZSBhIGRpZmZlcmVudCBvcmlnaW4uXG4gICAgLy8gRG9uJ3QgYWxsb3cgZm9yIG5vLXJlZmVycmVyLlxuICAgIGNvbnN0IHtjYW5vbmljYWxVcmx9ID0gU2VydmljZXMuZG9jdW1lbnRJbmZvRm9yRG9jKFxuICAgICAgICB0aGlzLmJhc2VJbnN0YW5jZV8uZ2V0QW1wRG9jKCkpO1xuICAgIGNvbnN0IG1ldGFSZWZlcnJlciA9IHRoaXMud2luXy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICBcIm1ldGFbbmFtZT0ncmVmZXJyZXInXVwiKTtcbiAgICBpZiAoIW1ldGFSZWZlcnJlcikge1xuICAgICAgcmV0dXJuIGNhbm9uaWNhbFVybDtcbiAgICB9XG4gICAgc3dpdGNoIChtZXRhUmVmZXJyZXIuZ2V0QXR0cmlidXRlKCdjb250ZW50JykpIHtcbiAgICAgIGNhc2UgJ3NhbWUtb3JpZ2luJzpcbiAgICAgICAgcmV0dXJuO1xuICAgICAgY2FzZSAnbm8tcmVmZXJyZXInOlxuICAgICAgICByZXR1cm47XG4gICAgICBjYXNlICdvcmlnaW4nOlxuICAgICAgICByZXR1cm4gcGFyc2VVcmxEZXByZWNhdGVkKGNhbm9uaWNhbFVybCkub3JpZ2luO1xuICAgIH1cbiAgICByZXR1cm4gY2Fub25pY2FsVXJsO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGluaXRpYWxHZW9tZXRyeSB0byBhc3NpZ24gdG8gdGhlIG5hbWUgb2YgdGhlIHNhZmVmcmFtZVxuICAgKiBmb3IgcmVuZGVyaW5nLiBUaGlzIG5lZWRzIHRvIGJlIGRvbmUgZGlmZmVyZW50bHkgdGhhbiBhbGwgdGhlIG90aGVyXG4gICAqIGdlb21ldHJ5IHVwZGF0ZXMsIGJlY2F1c2Ugd2UgZG9uJ3QgYWN0dWFsbHkgaGF2ZSBhY2Nlc3MgdG8gdGhlXG4gICAqIHJlbmRlcmVkIHNhZmVmcmFtZSB5ZXQuIE5vdGUgdGhhdCB3ZSBhcmUgdXNpbmcgZ2V0UGFnZUxheW91dEJveCxcbiAgICogd2hpY2ggaXMgbm90IGd1YXJhbnRlZWQgdG8gYmUgcGVyZmVjdGx5IGFjY3VyYXRlIGFzIGl0IGlzIGZyb21cbiAgICogdGhlIGxhc3QgbWVhc3VyZSBvZiB0aGUgZWxlbWVudC4gVGhpcyBpcyBmaW5lIGZvciBvdXIgdXNlIGNhc2VcbiAgICogaGVyZSwgYXMgZXZlbiBpZiB0aGUgcG9zaXRpb24gaXMgc2xpZ2h0bHkgb2ZmLCB3ZSdsbCBzZW5kIHRoZSByaWdodFxuICAgKiBzaXplLlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAqL1xuICBnZXRJbml0aWFsR2VvbWV0cnkoKSB7XG4gICAgY29uc3QgYW1wQWRCb3ggPSB0aGlzLmJhc2VJbnN0YW5jZV8uZ2V0UGFnZUxheW91dEJveCgpO1xuICAgIGNvbnN0IGhlaWdodE9mZnNldCA9IChhbXBBZEJveC5oZWlnaHQgLSB0aGlzLmNyZWF0aXZlU2l6ZV8uaGVpZ2h0KSAvIDI7XG4gICAgY29uc3Qgd2lkdGhPZmZzZXQgPSAoYW1wQWRCb3gud2lkdGggLSB0aGlzLmNyZWF0aXZlU2l6ZV8ud2lkdGgpIC8gMjtcbiAgICBjb25zdCBpZnJhbWVCb3ggPSAvKiogQHR5cGUgeyEuLi8uLi8uLi9zcmMvbGF5b3V0LXJlY3QuTGF5b3V0UmVjdERlZn0gKi8gKHtcbiAgICAgIHRvcDogYW1wQWRCb3gudG9wICsgaGVpZ2h0T2Zmc2V0LFxuICAgICAgYm90dG9tOiBhbXBBZEJveC5ib3R0b20gLSBoZWlnaHRPZmZzZXQsXG4gICAgICBsZWZ0OiBhbXBBZEJveC5sZWZ0ICsgd2lkdGhPZmZzZXQsXG4gICAgICByaWdodDogYW1wQWRCb3gucmlnaHQgLSB3aWR0aE9mZnNldCxcbiAgICAgIGhlaWdodDogdGhpcy5pbml0aWFsQ3JlYXRpdmVTaXplXy5oZWlnaHQsXG4gICAgICB3aWR0aDogdGhpcy5pbml0aWFsQ3JlYXRpdmVTaXplXy53aWR0aCxcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5mb3JtYXRHZW9tXyhpZnJhbWVCb3gpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVycyB0aGlzIGluc3RhbmNlIGFzIHRoZSBob3N0IEFQSSBmb3IgdGhlIGN1cnJlbnQgc2VudGluZWwuXG4gICAqIElmIHRoZSBnbG9iYWwgc2FmZWZyYW1lIGxpc3RlbmVyIGhhcyBub3QgeWV0IGJlZW4gY3JlYXRlZCwgaXQgY3JlYXRlc1xuICAgKiB0aGF0IGFzIHdlbGwuXG4gICAqL1xuICByZWdpc3RlclNhZmVmcmFtZUhvc3QoKSB7XG4gICAgZGV2KCkuYXNzZXJ0KHRoaXMuc2VudGluZWxfKTtcbiAgICBzYWZlZnJhbWVIb3N0c1t0aGlzLnNlbnRpbmVsX10gPSBzYWZlZnJhbWVIb3N0c1t0aGlzLnNlbnRpbmVsX10gfHwgdGhpcztcbiAgICBpZiAoIXNhZmVmcmFtZUxpc3RlbmVyQ3JlYXRlZF8pIHtcbiAgICAgIHNhZmVmcmFtZUxpc3RlbmVyQ3JlYXRlZF8gPSB0cnVlO1xuICAgICAgdGhpcy53aW5fLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBzYWZlZnJhbWVMaXN0ZW5lciwgZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZW5kcyBpbml0aWFsIGNvbm5lY3Rpb24gbWVzc2FnZSB0byB0aGUgc2FmZWZyYW1lIHRvIGZpbmlzaCBpbml0aWFsaXphdGlvbi5cbiAgICogQWxzbyBpbml0aWFsaXplcyB0aGUgc2VuZGluZyBvZiBnZW9tZXRyeSB1cGRhdGUgbWVzc2FnZXMgdG8gdGhlIGZyYW1lLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gY2hhbm5lbFxuICAgKi9cbiAgY29ubmVjdE1lc3NhZ2luZ0NoYW5uZWwoY2hhbm5lbCkge1xuICAgIC8vIFNldCB0aGUgaWZyYW1lIGhlcmUsIGJlY2F1c2Ugd2hlbiBjbGFzcyBpcyBmaXJzdCBjcmVhdGVkIHRoZSBpZnJhbWVcbiAgICAvLyBlbGVtZW50IGRvZXMgbm90IHlldCBleGlzdCBvbiB0aGlzLmJhc2VJbnN0YW5jZV8uIFRoZSBmaXJzdCB0aW1lXG4gICAgLy8gd2UgcmVjZWl2ZSBhIG1lc3NhZ2Ugd2Uga25vdyB0aGF0IGl0IG5vdyBleGlzdHMuXG4gICAgZGV2KCkuYXNzZXJ0KHRoaXMuYmFzZUluc3RhbmNlXy5pZnJhbWUpO1xuICAgIHRoaXMuaWZyYW1lXyA9IHRoaXMuYmFzZUluc3RhbmNlXy5pZnJhbWU7XG4gICAgdGhpcy5jaGFubmVsID0gY2hhbm5lbDtcbiAgICB0aGlzLnNldHVwR2VvbV8oKTtcbiAgICB0aGlzLnNlbmRNZXNzYWdlXyh7XG4gICAgICAnbWVzc2FnZSc6ICdjb25uZWN0JyxcbiAgICAgICdjJzogdGhpcy5jaGFubmVsLFxuICAgIH0sICcnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIEludGVyc2VjdGlvbk9ic2VydmVyIGluc3RhbmNlIGZvciB0aGlzIFNhZmVmcmFtZUFQSSBpbnN0YW5jZS5cbiAgICogV2UgdXRpbGl6ZSB0aGUgZXhpc3RpbmcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIgY2xhc3MsIGJ5IHBhc3NpbmcgaW4gdGhpc1xuICAgKiBjbGFzcyBmb3IgSU8gdG8gdXNlIGluc3RlYWQgb2YgU3Vic2NyaXB0aW9uQXBpIGZvciBzZW5kaW5nIGl0cyB1cGRhdGVcbiAgICogbWVzc2FnZXMuIFRoZSBtZXRob2QgJ3NlbmQnIGJlbG93IGlzIHRyaWdnZXJlZCBieSBJTyBldmVyeSB0aW1lIHRoYXRcbiAgICogYW4gdXBkYXRlIG9jY3Vycy5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHNldHVwR2VvbV8oKSB7XG4gICAgZGV2KCkuYXNzZXJ0KHRoaXMuaWZyYW1lXy5jb250ZW50V2luZG93LFxuICAgICAgICAnRnJhbWUgY29udGVudFdpbmRvdyB1bmF2YWlsYWJsZS4nKTtcbiAgICBjb25zdCB0aHJvdHRsZWRVcGRhdGUgPSB0aHJvdHRsZShcbiAgICAgICAgdGhpcy53aW5fLCB0aGlzLnVwZGF0ZUdlb21ldHJ5Xy5iaW5kKHRoaXMpLCAxMDAwKTtcbiAgICBjb25zdCBzY3JvbGxVbmxpc3RlbmVyID0gdGhpcy52aWV3cG9ydF8ub25TY3JvbGwodGhyb3R0bGVkVXBkYXRlKTtcbiAgICBjb25zdCBjaGFuZ2VkVW5saXN0ZW5lciA9IHRoaXMudmlld3BvcnRfLm9uQ2hhbmdlZCh0aHJvdHRsZWRVcGRhdGUpO1xuICAgIHRoaXMudW5saXN0ZW5fID0gKCkgPT4ge1xuICAgICAgc2Nyb2xsVW5saXN0ZW5lcigpO1xuICAgICAgY2hhbmdlZFVubGlzdGVuZXIoKTtcbiAgICB9O1xuICAgIHRoaXMudXBkYXRlR2VvbWV0cnlfKCk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZHMgYSBnZW9tZXRyeSB1cGRhdGUgbWVzc2FnZSBpbnRvIHRoZSBzYWZlZnJhbWUuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB1cGRhdGVHZW9tZXRyeV8oKSB7XG4gICAgaWYgKCF0aGlzLmlmcmFtZV8pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy52aWV3cG9ydF8uZ2V0Q2xpZW50UmVjdEFzeW5jKHRoaXMuaWZyYW1lXykudGhlbihpZnJhbWVCb3ggPT4ge1xuICAgICAgdGhpcy5jaGVja1N0aWxsQ3VycmVudF8oKTtcbiAgICAgIGNvbnN0IGZvcm1hdHRlZEdlb20gPSB0aGlzLmZvcm1hdEdlb21fKGlmcmFtZUJveCk7XG4gICAgICB0aGlzLnNlbmRNZXNzYWdlXyh7XG4gICAgICAgIG5ld0dlb21ldHJ5OiBmb3JtYXR0ZWRHZW9tLFxuICAgICAgICB1aWQ6IHRoaXMudWlkXyxcbiAgICAgIH0sIFNFUlZJQ0UuR0VPTUVUUllfVVBEQVRFKTtcbiAgICB9KS5jYXRjaChlcnIgPT4gZGV2KCkuZXJyb3IoVEFHLCBlcnIpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCdWlsZHMgZ2VvbWV0cnkgdXBkYXRlIGZvcm1hdCBleHBlY3RlZCBieSBHUFQgU2FmZWZyYW1lLlxuICAgKiBBbHNvIHNldHMgdGhpcy5jdXJyZW50R2VvbWV0cnkgYXMgc2lkZSBlZmZlY3QuXG4gICAqIEBwYXJhbSB7IS4uLy4uLy4uL3NyYy9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmfSBpZnJhbWVCb3ggVGhlIGVsZW1lbnRSZWN0IGZvciB0aGUgc2FmZWZyYW1lLlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IFNhZmVmcmFtZSBmb3JtYXR0ZWQgY2hhbmdlcy5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGZvcm1hdEdlb21fKGlmcmFtZUJveCkge1xuICAgIGNvbnN0IHZpZXdwb3J0U2l6ZSA9IHRoaXMudmlld3BvcnRfLmdldFNpemUoKTtcbiAgICBjb25zdCBzY3JvbGxMZWZ0ID0gdGhpcy52aWV3cG9ydF8uZ2V0U2Nyb2xsTGVmdCgpO1xuICAgIGNvbnN0IHNjcm9sbFRvcCA9IHRoaXMudmlld3BvcnRfLmdldFNjcm9sbFRvcCgpO1xuICAgIGNvbnN0IGN1cnJlbnRHZW9tZXRyeSA9IC8qKiBAdHlwZSB7SnNvbk9iamVjdH0gKi8oe1xuICAgICAgJ3dpbmRvd0Nvb3Jkc190JzogMCxcbiAgICAgICd3aW5kb3dDb29yZHNfcic6IHZpZXdwb3J0U2l6ZS53aWR0aCxcbiAgICAgICd3aW5kb3dDb29yZHNfYic6IHZpZXdwb3J0U2l6ZS5oZWlnaHQsXG4gICAgICAnd2luZG93Q29vcmRzX2wnOiAwLFxuICAgICAgJ2ZyYW1lQ29vcmRzX3QnOiBpZnJhbWVCb3gudG9wICsgc2Nyb2xsVG9wLFxuICAgICAgJ2ZyYW1lQ29vcmRzX3InOiBpZnJhbWVCb3gucmlnaHQgKyBzY3JvbGxMZWZ0LFxuICAgICAgJ2ZyYW1lQ29vcmRzX2InOiBpZnJhbWVCb3guYm90dG9tICsgc2Nyb2xsVG9wLFxuICAgICAgJ2ZyYW1lQ29vcmRzX2wnOiBpZnJhbWVCb3gubGVmdCArIHNjcm9sbExlZnQsXG4gICAgICAncG9zQ29vcmRzX3QnOiBpZnJhbWVCb3gudG9wLFxuICAgICAgJ3Bvc0Nvb3Jkc19iJzogaWZyYW1lQm94LmJvdHRvbSxcbiAgICAgICdwb3NDb29yZHNfcic6IGlmcmFtZUJveC5yaWdodCxcbiAgICAgICdwb3NDb29yZHNfbCc6IGlmcmFtZUJveC5sZWZ0LFxuICAgICAgJ3N0eWxlWkluZGV4JzogZ2V0U3R5bGUodGhpcy5iYXNlSW5zdGFuY2VfLmVsZW1lbnQsICd6SW5kZXgnKSxcbiAgICAgIC8vIEFNUCdzIGJ1aWx0IGluIHJlc2l6ZSBtZXRob2RvbG9neSB0aGF0IHdlIHVzZSBvbmx5IGFsbG93cyBleHBhbnNpb25cbiAgICAgIC8vIHRvIHRoZSByaWdodCBhbmQgYm90dG9tLCBzbyB3ZSBlbmZvcmNlIHRoYXQgaGVyZS5cbiAgICAgICdhbGxvd2VkRXhwYW5zaW9uX3InOiB2aWV3cG9ydFNpemUud2lkdGggLVxuICAgICAgICAgIGlmcmFtZUJveC53aWR0aCxcbiAgICAgICdhbGxvd2VkRXhwYW5zaW9uX2InOiB2aWV3cG9ydFNpemUuaGVpZ2h0IC1cbiAgICAgICAgICBpZnJhbWVCb3guaGVpZ2h0LFxuICAgICAgJ2FsbG93ZWRFeHBhbnNpb25fdCc6IDAsXG4gICAgICAnYWxsb3dlZEV4cGFuc2lvbl9sJzogMCxcbiAgICAgICd5SW5WaWV3JzogdGhpcy5nZXRQZXJjSW5WaWV3KHZpZXdwb3J0U2l6ZS5oZWlnaHQsXG4gICAgICAgICAgaWZyYW1lQm94LnRvcCwgaWZyYW1lQm94LmJvdHRvbSksXG4gICAgICAneEluVmlldyc6IHRoaXMuZ2V0UGVyY0luVmlldyh2aWV3cG9ydFNpemUud2lkdGgsXG4gICAgICAgICAgaWZyYW1lQm94LmxlZnQsIGlmcmFtZUJveC5yaWdodCksXG4gICAgfSk7XG4gICAgdGhpcy5jdXJyZW50R2VvbWV0cnlfID0gY3VycmVudEdlb21ldHJ5O1xuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShjdXJyZW50R2VvbWV0cnkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhlbHBlciBmdW5jdGlvbiB0byBjYWxjdWxhdGUgYm90aCB0aGUgeEluVmlldyBhbmQgeUluVmlldyBvZiB0aGVcbiAgICogZ2VvbWV0cnkgdXBkYXRlIG1lc3NhZ2VzLiBJbiB0aGUgY2FzZSBvZiBhIDQwMHB4IHdpZGUgdmlld3BvcnQsXG4gICAqIHdpdGggYSAxMDBweCB3aWRlIGNyZWF0aXZlIHRoYXQgc3RhcnRzIGF0IHggcG9zaXRpb24gNTAsIGlmIHdlXG4gICAqIGFyZSBjYWxjdWxhdGluZyB4SW5WaWV3LCByb290Qm91bmRFbmQgaXMgNDAwLCBib3VuZGluZ1JlY3RTdGFydFxuICAgKiBpcyA1MCwgYW5kIGJvdW5kaW5nUmVjdEVuZCBpcyAxNTAuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSByb290Qm91bmRFbmRcbiAgICogQHBhcmFtIHtudW1iZXJ9IGJvdW5kaW5nUmVjdFN0YXJ0XG4gICAqIEBwYXJhbSB7bnVtYmVyfSBib3VuZGluZ1JlY3RFbmRcbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKi9cbiAgZ2V0UGVyY0luVmlldyhyb290Qm91bmRFbmQsIGJvdW5kaW5nUmVjdFN0YXJ0LCBib3VuZGluZ1JlY3RFbmQpIHtcbiAgICBjb25zdCBsZW5ndGhJblZpZXcgPSAoYm91bmRpbmdSZWN0RW5kID49IHJvb3RCb3VuZEVuZCkgP1xuICAgICAgcm9vdEJvdW5kRW5kIC0gYm91bmRpbmdSZWN0U3RhcnQgOiBib3VuZGluZ1JlY3RFbmQ7XG4gICAgY29uc3QgcGVyY0luVmlldyA9IGxlbmd0aEluVmlldyAvIChib3VuZGluZ1JlY3RFbmQgLSBib3VuZGluZ1JlY3RTdGFydCk7XG4gICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHBlcmNJblZpZXcpKSB8fCAwO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgc2VyaWFsaXppbmcgYW5kIHNlbmRpbmcgbWVzc2FnZXMgdG8gdGhlIHNhZmVmcmFtZS5cbiAgICogQHBhcmFtIHshT2JqZWN0fSBwYXlsb2FkXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlTmFtZVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc2VuZE1lc3NhZ2VfKHBheWxvYWQsIHNlcnZpY2VOYW1lKSB7XG4gICAgaWYgKCF0aGlzLmlmcmFtZV8uY29udGVudFdpbmRvdykge1xuICAgICAgZGV2KCkuZXJyb3IoVEFHLCAnRnJhbWUgY29udGVudFdpbmRvdyB1bmF2YWlsYWJsZS4nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbWVzc2FnZSA9IGRpY3QoKTtcbiAgICBtZXNzYWdlW01FU1NBR0VfRklFTERTLkNIQU5ORUxdID0gdGhpcy5jaGFubmVsO1xuICAgIG1lc3NhZ2VbTUVTU0FHRV9GSUVMRFMuUEFZTE9BRF0gPSBKU09OLnN0cmluZ2lmeShcbiAgICAgICAgLyoqIEB0eXBlIHshSnNvbk9iamVjdH0gKi8ocGF5bG9hZCkpO1xuICAgIG1lc3NhZ2VbTUVTU0FHRV9GSUVMRFMuU0VSVklDRV0gPSBzZXJ2aWNlTmFtZTtcbiAgICBtZXNzYWdlW01FU1NBR0VfRklFTERTLlNFTlRJTkVMXSA9IHRoaXMuc2VudGluZWxfO1xuICAgIG1lc3NhZ2VbTUVTU0FHRV9GSUVMRFMuRU5EUE9JTlRfSURFTlRJVFldID0gdGhpcy5lbmRwb2ludElkZW50aXR5XztcbiAgICB0aGlzLmlmcmFtZV8uY29udGVudFdpbmRvdy4vKk9LKi9wb3N0TWVzc2FnZShcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkobWVzc2FnZSksIFNBRkVGUkFNRV9PUklHSU4pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJvdXRlcyBtZXNzYWdlcyB0byB0aGVpciBhcHByb3ByaWF0ZSBoYW5kbGVyLlxuICAgKiBAcGFyYW0geyFKc29uT2JqZWN0fSBwYXlsb2FkXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlXG4gICAqL1xuICBwcm9jZXNzTWVzc2FnZShwYXlsb2FkLCBzZXJ2aWNlKSB7XG4gICAgLy8gV2UgYXJlIG5vdCBsb2dnaW5nIHVuZXhwZWN0ZWQgbWVzc2FnZXMsIGFuZCBzb21lIGV4cGVjdGVkXG4gICAgLy8gbWVzc2FnZXMgYXJlIGJlaW5nIGRyb3BwZWQsIGxpa2UgaW5pdF9kb25lLCBhcyB3ZSBkb24ndCBuZWVkIHRoZW0uXG4gICAgc3dpdGNoIChzZXJ2aWNlKSB7XG4gICAgICBjYXNlIFNFUlZJQ0UuQ1JFQVRJVkVfR0VPTUVUUllfVVBEQVRFOlxuICAgICAgICB0aGlzLmhhbmRsZUZsdWlkTWVzc2FnZV8ocGF5bG9hZCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBTRVJWSUNFLkVYUEFORF9SRVFVRVNUOlxuICAgICAgICB0aGlzLmhhbmRsZUV4cGFuZFJlcXVlc3RfKHBheWxvYWQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgU0VSVklDRS5SRUdJU1RFUl9ET05FOlxuICAgICAgICB0aGlzLmlzUmVnaXN0ZXJlZF8gPSB0cnVlO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgU0VSVklDRS5DT0xMQVBTRV9SRVFVRVNUOlxuICAgICAgICB0aGlzLmhhbmRsZUNvbGxhcHNlUmVxdWVzdF8oKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFNFUlZJQ0UuUkVTSVpFX1JFUVVFU1Q6XG4gICAgICAgIHRoaXMuaGFuZGxlUmVzaXplUmVxdWVzdF8ocGF5bG9hZCk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFKc29uT2JqZWN0fSBwYXlsb2FkXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBoYW5kbGVFeHBhbmRSZXF1ZXN0XyhwYXlsb2FkKSB7XG4gICAgaWYgKCF0aGlzLmlzUmVnaXN0ZXJlZF8pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZXhwYW5kSGVpZ2h0ID0gTnVtYmVyKHRoaXMuY3JlYXRpdmVTaXplXy5oZWlnaHQpICtcbiAgICAgICAgICBwYXlsb2FkWydleHBhbmRfYiddICsgcGF5bG9hZFsnZXhwYW5kX3QnXTtcbiAgICBjb25zdCBleHBhbmRXaWR0aCA9IE51bWJlcih0aGlzLmNyZWF0aXZlU2l6ZV8ud2lkdGgpICtcbiAgICAgICAgICBwYXlsb2FkWydleHBhbmRfciddICsgcGF5bG9hZFsnZXhwYW5kX2wnXTtcbiAgICAvLyBWZXJpZnkgdGhhdCBpZiBleHBhbmRpbmcgYnkgcHVzaCwgdGhhdCBleHBhbmRCeVB1c2ggaXMgYWxsb3dlZC5cbiAgICAvLyBJZiBleHBhbmRpbmcgYnkgb3ZlcmxheSwgdmVyaWZ5IHRoYXQgZXhwYW5kQnlPdmVybGF5IGlzIGFsbG93ZWQsXG4gICAgLy8gYW5kIHRoYXQgd2UgYXJlIG9ubHkgZXhwYW5kaW5nIHdpdGhpbiB0aGUgYm91bmRzIG9mIHRoZSBhbXAtYWQuXG4gICAgaWYgKGlzTmFOKGV4cGFuZEhlaWdodCkgfHwgaXNOYU4oZXhwYW5kV2lkdGgpIHx8XG4gICAgICAgIChwYXlsb2FkWydwdXNoJ10gJiYgIXRoaXMuZXhwYW5kQnlQdXNoXykgfHxcbiAgICAgICAgKCFwYXlsb2FkWydwdXNoJ10gJiYgIXRoaXMuZXhwYW5kQnlPdmVybGF5XyAmJlxuICAgICAgICAgKGV4cGFuZFdpZHRoID4gdGhpcy5jcmVhdGl2ZVNpemVfLndpZHRoIHx8XG4gICAgICAgICAgZXhwYW5kSGVpZ2h0ID4gdGhpcy5jcmVhdGl2ZVNpemVfLmhlaWdodCkpKSB7XG4gICAgICBkZXYoKS5lcnJvcihUQUcsICdJbnZhbGlkIGV4cGFuZCB2YWx1ZXMuJyk7XG4gICAgICB0aGlzLnNlbmRSZXNpemVSZXNwb25zZShcbiAgICAgICAgICAvKiBTVUNDRVNTPyAqLyBmYWxzZSwgU0VSVklDRS5FWFBBTkRfUkVTUE9OU0UpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBDYW4ndCBleHBhbmQgdG8gZ3JlYXRlciB0aGFuIHRoZSB2aWV3cG9ydCBzaXplXG4gICAgaWYgKGV4cGFuZEhlaWdodCA+IHRoaXMudmlld3BvcnRfLmdldFNpemUoKS5oZWlnaHQgfHxcbiAgICAgICAgZXhwYW5kV2lkdGggPiB0aGlzLnZpZXdwb3J0Xy5nZXRTaXplKCkud2lkdGgpIHtcbiAgICAgIHRoaXMuc2VuZFJlc2l6ZVJlc3BvbnNlKFxuICAgICAgICAgIC8qIFNVQ0NFU1M/ICovIGZhbHNlLCBTRVJWSUNFLkVYUEFORF9SRVNQT05TRSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaGFuZGxlU2l6ZUNoYW5nZShleHBhbmRIZWlnaHQsXG4gICAgICAgIGV4cGFuZFdpZHRoLFxuICAgICAgICBTRVJWSUNFLkVYUEFORF9SRVNQT05TRSk7XG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGhhbmRsZUNvbGxhcHNlUmVxdWVzdF8oKSB7XG4gICAgLy8gT25seSBjb2xsYXBzZSBpZiBleHBhbmRlZC5cbiAgICBpZiAodGhpcy5pc0NvbGxhcHNlZF8gfHwgIXRoaXMuaXNSZWdpc3RlcmVkXykge1xuICAgICAgdGhpcy5zZW5kUmVzaXplUmVzcG9uc2UoXG4gICAgICAgICAgLyogU1VDQ0VTUz8gKi8gZmFsc2UsIFNFUlZJQ0UuQ09MTEFQU0VfUkVTUE9OU0UpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmhhbmRsZVNpemVDaGFuZ2UodGhpcy5pbml0aWFsQ3JlYXRpdmVTaXplXy5oZWlnaHQsXG4gICAgICAgIHRoaXMuaW5pdGlhbENyZWF0aXZlU2l6ZV8ud2lkdGgsXG4gICAgICAgIFNFUlZJQ0UuQ09MTEFQU0VfUkVTUE9OU0UsXG4gICAgICAgIC8qKiBpc0NvbGxhcHNlICovIHRydWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHRcbiAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlVHlwZVxuICAgKi9cbiAgcmVzaXplU2FmZWZyYW1lKGhlaWdodCwgd2lkdGgsIG1lc3NhZ2VUeXBlKSB7XG4gICAgdGhpcy5pc0NvbGxhcHNlZF8gPSBtZXNzYWdlVHlwZSA9PSBTRVJWSUNFLkNPTExBUFNFX1JFU1BPTlNFO1xuICAgIHRoaXMuYmFzZUluc3RhbmNlXy5tZWFzdXJlTXV0YXRlRWxlbWVudChcbiAgICAgICAgLyoqIE1FQVNVUkVSICovICgpID0+IHtcbiAgICAgICAgICB0aGlzLmJhc2VJbnN0YW5jZV8uZ2V0UmVzb3VyY2UoKS5tZWFzdXJlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKiBNVVRBVE9SICovICgpID0+IHtcbiAgICAgICAgICBpZiAodGhpcy5pZnJhbWVfKSB7XG4gICAgICAgICAgICBzZXRTdHlsZXModGhpcy5pZnJhbWVfLCB7XG4gICAgICAgICAgICAgICdoZWlnaHQnOiBoZWlnaHQgKyAncHgnLFxuICAgICAgICAgICAgICAnd2lkdGgnOiB3aWR0aCArICdweCcsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRpdmVTaXplXy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgICAgICB0aGlzLmNyZWF0aXZlU2l6ZV8ud2lkdGggPSB3aWR0aDtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5zZW5kUmVzaXplUmVzcG9uc2UoLyoqIFNVQ0NFU1MgKi8gdHJ1ZSwgbWVzc2FnZVR5cGUpO1xuICAgICAgICB9LFxuICAgICAgICB0aGlzLmlmcmFtZV9cbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc2l6ZXMgdGhlIHNhZmVmcmFtZSwgYW5kIHBvdGVudGlhbGx5IHRoZSBjb250YWluaW5nIGFtcC1hZCBlbGVtZW50LlxuICAgKiBUaGVuIHNlbmRzIGEgcmVzcG9uc2UgbWVzc2FnZSB0byB0aGUgU2FmZWZyYW1lIGNyZWF0aXZlLlxuICAgKlxuICAgKiBGb3IgZXhwYW5zaW9uOlxuICAgKiAgSWYgdGhlIG5ldyBzaXplIGlzIGZ1bGx5IGNvbnRhaW5lZCB3aXRoaW4gdGhlIGJvdW5kcyBvZiB0aGUgYW1wLWFkLFxuICAgKiAgd2UgY2FuIHJlc2l6ZSBpbW1lZGlhdGVseSBhcyB0aGVyZSB3aWxsIGJlIG5vIHJlZmxvdy4gSG93ZXZlciwgaWZcbiAgICogIHRoZSBuZXcgc2l6ZSBpcyBsYXJnZXIgdGhhbiB0aGUgYW1wLWFkLCB0aGVuIGZpcnN0IHdlIG5lZWQgdG8gdHJ5XG4gICAqICB0byByZXNpemUgdGhlIGFtcC1hZCwgYW5kIG9ubHkgcmVzaXplIHRoZSBzYWZlZnJhbWUgaWYgdGhhdCBzdWNjZWVkcy5cbiAgICogRm9yIGNvbGxhcHNlOlxuICAgKiAgV2UgYWx3YXlzIGZpcnN0IHdhbnQgdG8gYXR0ZW1wdCB0byBjb2xsYXBzZSB0aGUgYW1wLWFkLiBUaGVuLFxuICAgKiAgcmVnYXJkbGVzcyBvZiB3aGV0aGVyIHRoYXQgc3VjY2VlZHMsIHdlIGNvbGxhcHNlIHRoZSBzYWZlZnJhbWUgdG9vLlxuICAgKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0IEluIHBpeGVscy5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoIEluIHBpeGVscy5cbiAgICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VUeXBlXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdElzQ29sbGFwc2UgV2hldGhlciB0aGlzIGlzIGEgY29sbGFwc2UgYXR0ZW1wdC5cbiAgICovXG4gIGhhbmRsZVNpemVDaGFuZ2UoaGVpZ2h0LCB3aWR0aCwgbWVzc2FnZVR5cGUsIG9wdElzQ29sbGFwc2UpIHtcbiAgICByZXR1cm4gdGhpcy52aWV3cG9ydF8uZ2V0Q2xpZW50UmVjdEFzeW5jKFxuICAgICAgICB0aGlzLmJhc2VJbnN0YW5jZV8uZWxlbWVudCkudGhlbihib3ggPT4ge1xuICAgICAgaWYgKCFvcHRJc0NvbGxhcHNlICYmIHdpZHRoIDw9IGJveC53aWR0aCAmJiBoZWlnaHQgPD0gYm94LmhlaWdodCkge1xuICAgICAgICB0aGlzLnJlc2l6ZVNhZmVmcmFtZShoZWlnaHQsIHdpZHRoLCBtZXNzYWdlVHlwZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnJlc2l6ZUFtcEFkQW5kU2FmZWZyYW1lKGhlaWdodCwgd2lkdGgsIG1lc3NhZ2VUeXBlLFxuICAgICAgICAgICAgb3B0SXNDb2xsYXBzZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshSnNvbk9iamVjdH0gcGF5bG9hZFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgaGFuZGxlUmVzaXplUmVxdWVzdF8ocGF5bG9hZCkge1xuICAgIGlmICghdGhpcy5pc1JlZ2lzdGVyZWRfKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHJlc2l6ZUhlaWdodCA9IE51bWJlcih0aGlzLmNyZWF0aXZlU2l6ZV8uaGVpZ2h0KSArXG4gICAgICAgICAgKHBheWxvYWRbJ3Jlc2l6ZV9iJ10gKyBwYXlsb2FkWydyZXNpemVfdCddKTtcbiAgICBjb25zdCByZXNpemVXaWR0aCA9IE51bWJlcih0aGlzLmNyZWF0aXZlU2l6ZV8ud2lkdGgpICtcbiAgICAgICAgICAocGF5bG9hZFsncmVzaXplX3InXSArIHBheWxvYWRbJ3Jlc2l6ZV9sJ10pO1xuXG4gICAgLy8gTWFrZSBzdXJlIHdlIGFyZSBhY3R1YWxseSByZXNpemluZyBoZXJlLlxuICAgIGlmIChpc05hTihyZXNpemVXaWR0aCkgfHwgaXNOYU4ocmVzaXplSGVpZ2h0KSB8fFxuICAgICAgICByZXNpemVXaWR0aCA+IHRoaXMuY3JlYXRpdmVTaXplXy53aWR0aCB8fFxuICAgICAgICByZXNpemVIZWlnaHQgPiB0aGlzLmNyZWF0aXZlU2l6ZV8uaGVpZ2h0KSB7XG4gICAgICBkZXYoKS5lcnJvcihUQUcsICdJbnZhbGlkIHJlc2l6ZSB2YWx1ZXMuJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5yZXNpemVBbXBBZEFuZFNhZmVmcmFtZShyZXNpemVIZWlnaHQsIHJlc2l6ZVdpZHRoLFxuICAgICAgICBTRVJWSUNFLlJFU0laRV9SRVNQT05TRSwgdHJ1ZSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtib29sZWFufSBzdWNjZXNzXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlVHlwZVxuICAgKi9cbiAgc2VuZFJlc2l6ZVJlc3BvbnNlKHN1Y2Nlc3MsIG1lc3NhZ2VUeXBlKSB7XG4gICAgaWYgKCF0aGlzLmlmcmFtZV8pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy52aWV3cG9ydF8uZ2V0Q2xpZW50UmVjdEFzeW5jKHRoaXMuaWZyYW1lXykudGhlbihpZnJhbWVCb3ggPT4ge1xuICAgICAgdGhpcy5jaGVja1N0aWxsQ3VycmVudF8oKTtcbiAgICAgIGNvbnN0IGZvcm1hdHRlZEdlb20gPSB0aGlzLmZvcm1hdEdlb21fKGlmcmFtZUJveCk7XG4gICAgICB0aGlzLnNlbmRNZXNzYWdlXyh7XG4gICAgICAgIHVpZDogdGhpcy51aWRfLFxuICAgICAgICBzdWNjZXNzLFxuICAgICAgICBuZXdHZW9tZXRyeTogZm9ybWF0dGVkR2VvbSxcbiAgICAgICAgJ2V4cGFuZF90JzogdGhpcy5jdXJyZW50R2VvbWV0cnlfWydhbGxvd2VkRXhwYW5zaW9uX3QnXSxcbiAgICAgICAgJ2V4cGFuZF9iJzogdGhpcy5jdXJyZW50R2VvbWV0cnlfWydhbGxvd2VkRXhwYW5zaW9uX2InXSxcbiAgICAgICAgJ2V4cGFuZF9yJzogdGhpcy5jdXJyZW50R2VvbWV0cnlfWydhbGxvd2VkRXhwYW5zaW9uX3InXSxcbiAgICAgICAgJ2V4cGFuZF9sJzogdGhpcy5jdXJyZW50R2VvbWV0cnlfWydhbGxvd2VkRXhwYW5zaW9uX2wnXSxcbiAgICAgICAgcHVzaDogdHJ1ZSxcbiAgICAgIH0sIG1lc3NhZ2VUeXBlKTtcbiAgICB9KS5jYXRjaChlcnIgPT4gZGV2KCkuZXJyb3IoVEFHLCBlcnIpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBdHRlbXB0cyB0byByZXNpemUgYm90aCB0aGUgYW1wLWFkIGFuZCB0aGUgU2FmZWZyYW1lLlxuICAgKiBJZiB0aGUgYW1wLWFkIGNhbiBub3QgYmUgcmVzaXplZCwgdGhlbiBpZiBpdCB3YXMgYSBjb2xsYXBzZSByZXF1ZXN0LFxuICAgKiB3ZSB3aWxsIHN0aWxsIGNvbGxhcHNlIGp1c3QgdGhlIHNhZmVmcmFtZS5cbiAgICogQHBhcmFtIHtudW1iZXJ9IGhlaWdodFxuICAgKiBAcGFyYW0ge251bWJlcn0gd2lkdGhcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VUeXBlXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pc1Nocmlua2luZyBUcnVlIGlmIGNvbGxhcHNpbmcgb3IgcmVzaXppbmcgc21hbGxlci5cbiAgICovXG4gIHJlc2l6ZUFtcEFkQW5kU2FmZWZyYW1lKGhlaWdodCwgd2lkdGgsIG1lc3NhZ2VUeXBlLCBvcHRfaXNTaHJpbmtpbmcpIHtcbiAgICAvLyBGaXJzdCwgYXR0ZW1wdCB0byByZXNpemUgdGhlIEFtcC1BZCB0aGF0IGlzIHRoZSBwYXJlbnQgb2YgdGhlXG4gICAgLy8gc2FmZWZyYW1lXG4gICAgdGhpcy5iYXNlSW5zdGFuY2VfLmF0dGVtcHRDaGFuZ2VTaXplKGhlaWdodCwgd2lkdGgpLnRoZW4oKCkgPT4ge1xuICAgICAgdGhpcy5jaGVja1N0aWxsQ3VycmVudF8oKTtcbiAgICAgIC8vIElmIHRoaXMgcmVzaXplIHN1Y2NlZWRlZCwgd2UgYWx3YXlzIHJlc2l6ZSB0aGUgc2FmZWZyYW1lLlxuICAgICAgLy8gcmVzaXplU2FmZWZyYW1lIGFsc28gc2VuZHMgdGhlIHJlc2l6ZSByZXNwb25zZS5cbiAgICAgIHRoaXMucmVzaXplU2FmZWZyYW1lKGhlaWdodCwgd2lkdGgsIG1lc3NhZ2VUeXBlKTtcbiAgICB9LCAvKiogUkVKRUNUIENBTExCQUNLICovICgpID0+IHtcbiAgICAgIC8vIElmIHRoZSByZXNpemUgaW5pdGlhbGx5IGZhaWxlZCwgaXQgbWF5IGhhdmUgYmVlbiBxdWV1ZWRcbiAgICAgIC8vIGFzIGEgcGVuZGluZ0NoYW5nZVNpemUsIHdoaWNoIHdpbGwgY2F1c2UgdGhlIHNpemUgY2hhbmdlXG4gICAgICAvLyB0byBleGVjdXRlIHVwb24gdGhlIG5leHQgdXNlciBpbnRlcmFjdGlvbi4gV2UgZG9uJ3Qgd2FudFxuICAgICAgLy8gdGhhdCBmb3Igc2FmZWZyYW1lLCBzbyB3ZSByZXNldCBpdCBoZXJlLlxuICAgICAgdGhpcy5iYXNlSW5zdGFuY2VfLmdldFJlc291cmNlKCkucmVzZXRQZW5kaW5nQ2hhbmdlU2l6ZSgpO1xuICAgICAgaWYgKG9wdF9pc1Nocmlua2luZykge1xuICAgICAgICAvLyBJZiB0aGlzIGlzIGEgY29sbGFwc2Ugb3IgcmVzaXplIHJlcXVlc3QsIHRoZW4gZXZlbiBpZiByZXNpemluZ1xuICAgICAgICAvLyB0aGUgYW1wLWFkIGZhaWxlZCwgc3RpbGwgcmVzaXplIHRoZSBpZnJhbWUuXG4gICAgICAgIC8vIHJlc2l6ZVNhZmVmcmFtZSBhbHNvIHNlbmRzIHRoZSByZXNpemUgcmVzcG9uc2UuXG4gICAgICAgIC8vIE9ubHkgcmVnaXN0ZXIgYXMgY29sbGFwc2VkIGlmIGV4cGxpY2l0bHkgYSBjb2xsYXBzZSByZXF1ZXN0LlxuICAgICAgICB0aGlzLnJlc2l6ZVNhZmVmcmFtZShoZWlnaHQsIHdpZHRoLCBtZXNzYWdlVHlwZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBXZSB3ZXJlIGF0dGVtcHRpbmcgdG9cbiAgICAgICAgLy8gZXhwYW5kIHBhc3QgdGhlIGJvdW5kcyBvZiB0aGUgYW1wLWFkLCBhbmQgaXQgZmFpbGVkLiBUaHVzLFxuICAgICAgICAvLyB3ZSBuZWVkIHRvIHNlbmQgYSBmYWlsdXJlIG1lc3NhZ2UsIGFuZCB0aGUgc2FmZWZyYW1lIGlzXG4gICAgICAgIC8vIG5vdCByZXNpemVkLlxuICAgICAgICB0aGlzLnNlbmRSZXNpemVSZXNwb25zZShmYWxzZSwgbWVzc2FnZVR5cGUpO1xuICAgICAgfVxuICAgIH0pLmNhdGNoKGVyciA9PiB7XG4gICAgICBpZiAoZXJyLm1lc3NhZ2UgPT0gJ0NBTkNFTExFRCcpIHtcbiAgICAgICAgZGV2KCkuZXJyb3IoVEFHLCBlcnIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBkZXYoKS5lcnJvcihUQUcsIGBSZXNpemluZyBmYWlsZWQ6ICR7ZXJyfWApO1xuICAgICAgdGhpcy5zZW5kUmVzaXplUmVzcG9uc2UoZmFsc2UsIG1lc3NhZ2VUeXBlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIEZsdWlkLXJlbGF0ZWQgbWVzc2FnZXMgZGlzcGF0Y2hlZCBmcm9tIFNhZmVGcmFtZS5cbiAgICogQHBhcmFtIHshSnNvbk9iamVjdH0gcGF5bG9hZFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgaGFuZGxlRmx1aWRNZXNzYWdlXyhwYXlsb2FkKSB7XG4gICAgbGV0IG5ld0hlaWdodDtcbiAgICBpZiAoIXBheWxvYWQgfHwgIShuZXdIZWlnaHQgPSBwYXJzZUludChwYXlsb2FkWydoZWlnaHQnXSwgMTApKSkge1xuICAgICAgLy8gVE9ETyhsZXZpdHpreSkgQWRkIGFjdHVhbCBlcnJvciBoYW5kbGluZyBoZXJlLlxuICAgICAgdGhpcy5iYXNlSW5zdGFuY2VfLmZvcmNlQ29sbGFwc2UoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5iYXNlSW5zdGFuY2VfLmF0dGVtcHRDaGFuZ2VIZWlnaHQobmV3SGVpZ2h0KVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgdGhpcy5jaGVja1N0aWxsQ3VycmVudF8oKTtcbiAgICAgICAgICB0aGlzLm9uRmx1aWRSZXNpemVfKG5ld0hlaWdodCk7XG4gICAgICAgIH0pLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgaWYgKGVyci5tZXNzYWdlID09ICdDQU5DRUxMRUQnKSB7XG4gICAgICAgICAgICBkZXYoKS5lcnJvcihUQUcsIGVycik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIFRPRE8obGV2aXR6a3kpIEFkZCBtb3JlIGVycm9yIGhhbmRsaW5nIGhlcmVcbiAgICAgICAgICB0aGlzLmJhc2VJbnN0YW5jZV8uZm9yY2VDb2xsYXBzZSgpO1xuICAgICAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGaXJlcyBhIGRlbGF5ZWQgaW1wcmVzc2lvbiBhbmQgbm90aWZpZXMgdGhlIEZsdWlkIGNyZWF0aXZlIHRoYXQgaXRzXG4gICAqIGNvbnRhaW5lciBoYXMgYmVlbiByZXNpemVkLlxuICAgKiBAcGFyYW0ge251bWJlcn0gbmV3SGVpZ2h0IFRoZSBoZWlnaHQgZXhwYW5kZWQgdG8uXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBvbkZsdWlkUmVzaXplXyhuZXdIZWlnaHQpIHtcbiAgICBjb25zdCBpZnJhbWUgPSBkZXYoKS5hc3NlcnRFbGVtZW50KHRoaXMuYmFzZUluc3RhbmNlXy5pZnJhbWUpO1xuICAgIGNvbnN0IGlmcmFtZUhlaWdodCA9IHBhcnNlSW50KGdldFN0eWxlKGlmcmFtZSwgJ2hlaWdodCcpLCAxMCkgfHwgMDtcbiAgICBpZiAoaWZyYW1lSGVpZ2h0ICE9IG5ld0hlaWdodCkge1xuICAgICAgc2V0U3R5bGVzKGlmcmFtZSwge2hlaWdodDogYCR7bmV3SGVpZ2h0fXB4YH0pO1xuICAgIH1cbiAgICBpZiAodGhpcy5mbHVpZEltcHJlc3Npb25VcmxfKSB7XG4gICAgICB0aGlzLmJhc2VJbnN0YW5jZV8uZmlyZURlbGF5ZWRJbXByZXNzaW9ucyhcbiAgICAgICAgICB0aGlzLmZsdWlkSW1wcmVzc2lvblVybF8pO1xuICAgICAgdGhpcy5mbHVpZEltcHJlc3Npb25VcmxfID0gbnVsbDtcbiAgICB9XG4gICAgdGhpcy5pZnJhbWVfLmNvbnRlbnRXaW5kb3cuLypPSyovcG9zdE1lc3NhZ2UoXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KGRpY3QoeydtZXNzYWdlJzogJ3Jlc2l6ZS1jb21wbGV0ZScsICdjJzogdGhpcy5jaGFubmVsfSkpLFxuICAgICAgICBTQUZFRlJBTUVfT1JJR0lOKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVbnJlZ2lzdGVyIHRoaXMgSG9zdCBBUEkuXG4gICAqL1xuICBkZXN0cm95KCkge1xuICAgIHRoaXMuaWZyYW1lXyA9IG51bGw7XG4gICAgZGVsZXRlIHNhZmVmcmFtZUhvc3RzW3RoaXMuc2VudGluZWxfXTtcbiAgICBpZiAodGhpcy51bmxpc3Rlbl8pIHtcbiAgICAgIHRoaXMudW5saXN0ZW5fKCk7XG4gICAgfVxuICAgIGlmIChPYmplY3Qua2V5cyhzYWZlZnJhbWVIb3N0cykubGVuZ3RoID09IDApIHtcbiAgICAgIHJlbW92ZVNhZmVmcmFtZUxpc3RlbmVyKCk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogUmVtb3ZlcyB0aGUgc2FmZWZyYW1lIGV2ZW50IGxpc3RlbmVyLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlU2FmZWZyYW1lTGlzdGVuZXIoKSB7XG4gIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgc2FmZWZyYW1lTGlzdGVuZXIsIGZhbHNlKTtcbiAgc2FmZWZyYW1lTGlzdGVuZXJDcmVhdGVkXyA9IGZhbHNlO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7UkVOREVSSU5HX1RZUEVfSEVBREVSLCBYT1JJR0lOX01PREV9IGZyb20gJy4uLy4uL2FtcC1hNGEvMC4xL2FtcC1hNGEnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4uLy4uLy4uL3NyYy9sb2cnO1xuaW1wb3J0IHtnZXRFbmNsb3NpbmdDb250YWluZXJUeXBlc30gZnJvbSAnLi4vLi4vLi4vYWRzL2dvb2dsZS9hNGEvdXRpbHMnO1xuaW1wb3J0IHtcbiAgaXNJbk1hbnVhbEV4cGVyaW1lbnQsXG59IGZyb20gJy4uLy4uLy4uL2Fkcy9nb29nbGUvYTRhL3RyYWZmaWMtZXhwZXJpbWVudHMnO1xuaW1wb3J0IHtpc09iamVjdH0gZnJvbSAnLi4vLi4vLi4vc3JjL3R5cGVzJztcbmltcG9ydCB7dHJ5UmVzb2x2ZX0gZnJvbSAnLi4vLi4vLi4vc3JjL3V0aWxzL3Byb21pc2UnO1xuaW1wb3J0IHt1dGY4RW5jb2RlfSBmcm9tICcuLi8uLi8uLi9zcmMvdXRpbHMvYnl0ZXMnO1xuXG4vKiogQHR5cGUge3N0cmluZ30gKi9cbmNvbnN0IFRBRyA9ICdhbXAtYWQtbmV0d29yay1kb3VibGVjbGljay1pbXBsJztcblxuLyoqXG4gKiBAY29uc3Qge3N0cmluZ31cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgY29uc3QgVEZDRCA9ICd0YWdGb3JDaGlsZERpcmVjdGVkVHJlYXRtZW50JztcblxuLyoqIEBwcml2YXRlIHshQXJyYXk8ZnVuY3Rpb24oIUFycmF5PCEuL2FtcC1hZC1uZXR3b3JrLWRvdWJsZWNsaWNrLWltcGwuQW1wQWROZXR3b3JrRG91YmxlY2xpY2tJbXBsPik6P09iamVjdDxzdHJpbmcsc3RyaW5nPj59ICovXG5jb25zdCBTUkFfSk9JTkVSUyA9IFtcbiAgY29tYmluZUludmVudG9yeVVuaXRzLCBnZXRDb29raWVPcHRPdXQsIGdldEFka3MsIGdldFNpemVzLCBnZXRUZmNkLCBpc0FkVGVzdCxcbiAgZ2V0VGFyZ2V0aW5nQW5kRXhjbHVzaW9ucywgZ2V0RXhwZXJpbWVudElkcywgZ2V0SWRlbnRpdHksIGdldEZvcmNlU2FmZWZyYW1lLFxuICBnZXRQYWdlT2Zmc2V0cywgZ2V0Q29udGFpbmVyc107XG5cbi8qKlxuICAqIEBwYXJhbSB7IUFycmF5PCEuL2FtcC1hZC1uZXR3b3JrLWRvdWJsZWNsaWNrLWltcGwuQW1wQWROZXR3b3JrRG91YmxlY2xpY2tJbXBsPn0gaW1wbHNcbiAgKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgKj59XG4gICovXG5leHBvcnQgZnVuY3Rpb24gY29uc3RydWN0U1JBQmxvY2tQYXJhbWV0ZXJzKGltcGxzKSB7XG4gIGNvbnN0IHBhcmFtZXRlcnMgPSB7J291dHB1dCc6ICdsZGpoJywgJ2ltcGwnOiAnZmlmcyd9O1xuICBTUkFfSk9JTkVSUy5mb3JFYWNoKGpvaW5lciA9PiBPYmplY3QuYXNzaWduKHBhcmFtZXRlcnMsIGpvaW5lcihpbXBscykpKTtcbiAgcmV0dXJuIHBhcmFtZXRlcnM7XG59XG5cbi8qKlxuICogR2l2ZW4gYXJyYXkgb2YgaW5zdGFuY2VzLCBleGVjdXRlIGV4dHJhY3RGbiBvbiBlYWNoIGFuZCByZXR1cm4gZmlyc3Qgbm9uLVxuICogZmFsc2V5IHZhbHVlIG9yIG51bGwgaWYgbm9uZSBhcmUgdHJ1dGh5LlxuICogQHBhcmFtIHshQXJyYXk8IS4vYW1wLWFkLW5ldHdvcmstZG91YmxlY2xpY2staW1wbC5BbXBBZE5ldHdvcmtEb3VibGVjbGlja0ltcGw+fSBpbXBsc1xuICogQHBhcmFtIHtmdW5jdGlvbighLi9hbXAtYWQtbmV0d29yay1kb3VibGVjbGljay1pbXBsLkFtcEFkTmV0d29ya0RvdWJsZWNsaWNrSW1wbCk6P1R9IGV4dHJhY3RGblxuICogQHJldHVybiB7P1R9IHZhbHVlIG9mIGZpcnN0IGluc3RhbmNlIHdpdGggbm9uLW51bGwvdW5kZWZpbmVkIHZhbHVlIG9yIG51bGxcbiAqICAgIGlmIG5vbmUgY2FuIGJlIGZvdW5kXG4gKiBAdGVtcGxhdGUgVFxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gZ2V0Rmlyc3RJbnN0YW5jZVZhbHVlXyhpbXBscywgZXh0cmFjdEZuKSB7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgaW1wbHMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCB2YWwgPSBleHRyYWN0Rm4oaW1wbHNbaV0pO1xuICAgIGlmICh2YWwpIHtcbiAgICAgIHJldHVybiB2YWw7XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIENvbWJpbmVzIGludmVudG9yeSB1bml0IHBhdGhzIGZvciBtdWx0aXBsZSBibG9ja3MgYnkgYnVpbGRpbmcgbGlzdCBvZlxuICogdW5pcXVlIHBhdGggcGFydHMgaW4gaXVfcGFydHMgYW5kIHRoZW4gY29tbWEgc2VwYXJhdGVkIGxpc3Qgb2YgYmxvY2tcbiAqIHBhdGhzIHVzaW5nIGluZGV4IGludG8gaXVfcGFydHMgbGlzdC5cbiAqIEV4YW1wbGU6IC8xMjMvZm9vL2JhciBhbmQgL2JsYWgvZm9vL2Jhci8xMjMgPT5cbiAqICAgIGl1X3BhcnRzPTEyMyxmb28sYmFyLGJsYWggJiBlbmNfcHJldl9pdXM9LzAvMS8yLC8zLzEvMi8wXG4gKiBAcGFyYW0geyFBcnJheTwhLi9hbXAtYWQtbmV0d29yay1kb3VibGVjbGljay1pbXBsLkFtcEFkTmV0d29ya0RvdWJsZWNsaWNrSW1wbD59IGltcGxzXG4gKiBAcmV0dXJuIHs/T2JqZWN0PHN0cmluZyxzdHJpbmc+fVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb21iaW5lSW52ZW50b3J5VW5pdHMoaW1wbHMpIHtcbiAgY29uc3QgdW5pcXVlSXVOYW1lcyA9IHt9O1xuICBjb25zdCBpdU5hbWVzT3V0cHV0ID0gW107XG4gIGxldCB1bmlxdWVJdU5hbWVzQ291bnQgPSAwO1xuICBjb25zdCBwcmV2SXVzRW5jb2RlZCA9IFtdO1xuICBpbXBscy5mb3JFYWNoKGluc3RhbmNlID0+IHtcbiAgICBjb25zdCBpdSA9IGRldigpLmFzc2VydChpbnN0YW5jZS5lbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1zbG90JykpO1xuICAgIGNvbnN0IGNvbXBvbmVudE5hbWVzID0gaXUuc3BsaXQoJy8nKTtcbiAgICBjb25zdCBlbmNvZGVkTmFtZXMgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbXBvbmVudE5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoY29tcG9uZW50TmFtZXNbaV0gPT0gJycpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBsZXQgaW5kZXggPSB1bmlxdWVJdU5hbWVzW2NvbXBvbmVudE5hbWVzW2ldXTtcbiAgICAgIGlmIChpbmRleCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaXVOYW1lc091dHB1dC5wdXNoKGNvbXBvbmVudE5hbWVzW2ldKTtcbiAgICAgICAgdW5pcXVlSXVOYW1lc1tjb21wb25lbnROYW1lc1tpXV0gPSAoaW5kZXggPSB1bmlxdWVJdU5hbWVzQ291bnQrKyk7XG4gICAgICB9XG4gICAgICBlbmNvZGVkTmFtZXMucHVzaChpbmRleCk7XG4gICAgfVxuICAgIHByZXZJdXNFbmNvZGVkLnB1c2goZW5jb2RlZE5hbWVzLmpvaW4oJy8nKSk7XG4gIH0pO1xuICByZXR1cm4ge1xuICAgICdpdV9wYXJ0cyc6IGl1TmFtZXNPdXRwdXQuam9pbigpLFxuICAgICdlbmNfcHJldl9pdXMnOiBwcmV2SXVzRW5jb2RlZC5qb2luKCksXG4gIH07XG59XG5cbi8qKlxuICogSW5kaWNhdGVzIFNSQSByZXF1ZXN0IGlzIGNvb2tpZSBvcHQgb3V0IGlmIGFueSBvZiB0aGUgYmxvY2tzIGluY2x1ZGVzXG4gKiBjb29raWUgb3B0IG91dCBpbiB0YXJnZXRpbmcuXG4gKiBAcGFyYW0geyFBcnJheTwhLi9hbXAtYWQtbmV0d29yay1kb3VibGVjbGljay1pbXBsLkFtcEFkTmV0d29ya0RvdWJsZWNsaWNrSW1wbD59IGltcGxzXG4gKiBAcmV0dXJuIHs/T2JqZWN0PHN0cmluZyxzdHJpbmc+fVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb29raWVPcHRPdXQoaW1wbHMpIHtcbiAgcmV0dXJuIGdldEZpcnN0SW5zdGFuY2VWYWx1ZV8oaW1wbHMsIGltcGwgPT5cbiAgICBpbXBsLmpzb25UYXJnZXRpbmcgJiZcbiAgICAgICAgIGltcGwuanNvblRhcmdldGluZ1snY29va2llT3B0T3V0J10gPyB7J2NvJzogJzEnfSA6IG51bGwpO1xufVxuXG4vKipcbiAqIENvbWJpbmUgYWQgdW5pdCBrZXkgb2YgZWFjaCBibG9jayB2aWEgY29tbWEgc2VwYXJhdGVkIHZhbHVlcy5cbiAqIEBwYXJhbSB7IUFycmF5PCEuL2FtcC1hZC1uZXR3b3JrLWRvdWJsZWNsaWNrLWltcGwuQW1wQWROZXR3b3JrRG91YmxlY2xpY2tJbXBsPn0gaW1wbHNcbiAqIEByZXR1cm4gez9PYmplY3Q8c3RyaW5nLHN0cmluZz59XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFka3MoaW1wbHMpIHtcbiAgcmV0dXJuICh7J2Fka3MnOiBpbXBscy5tYXAoaW1wbCA9PiBkZXYoKS5hc3NlcnQoaW1wbC5hZEtleSkpLmpvaW4oKX0pO1xufVxuXG4vKipcbiAqIENvbWJpbmUgYmxvY2sgc2l6ZXMgdmlhIGNvbW1hIHNlcGFyYXRlZCB2YWx1ZXMuXG4gKiBAcGFyYW0geyFBcnJheTwhLi9hbXAtYWQtbmV0d29yay1kb3VibGVjbGljay1pbXBsLkFtcEFkTmV0d29ya0RvdWJsZWNsaWNrSW1wbD59IGltcGxzXG4gKiBAcmV0dXJuIHs/T2JqZWN0PHN0cmluZyxzdHJpbmc+fVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTaXplcyhpbXBscykge1xuICByZXR1cm4gKHsncHJldl9pdV9zenMnOiBpbXBscy5tYXAoaW1wbCA9PlxuICAgIGRldigpLmFzc2VydChpbXBsLnBhcmFtZXRlclNpemUpKS5qb2luKCl9KTtcbn1cblxuLyoqXG4gKiBJbmRpY2F0ZSBTUkEgcmVxdWVzdCBpcyB0YWdGb3JDaGlsZERpcmVjdGVkVHJlYXRtZW50IGlmIGFueSBibG9ja3MgaW5jbHVkZXNcbiAqIGluIHRhcmdldGluZy5cbiAqIEBwYXJhbSB7IUFycmF5PCEuL2FtcC1hZC1uZXR3b3JrLWRvdWJsZWNsaWNrLWltcGwuQW1wQWROZXR3b3JrRG91YmxlY2xpY2tJbXBsPn0gaW1wbHNcbiAqIEByZXR1cm4gez9PYmplY3Q8c3RyaW5nLHN0cmluZz59XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRmY2QoaW1wbHMpIHtcbiAgcmV0dXJuIGdldEZpcnN0SW5zdGFuY2VWYWx1ZV8oaW1wbHMsIGltcGwgPT5cbiAgICBpbXBsLmpzb25UYXJnZXRpbmcgJiYgaW1wbC5qc29uVGFyZ2V0aW5nW1RGQ0RdID9cbiAgICAgIHsndGZjZCc6IGltcGwuanNvblRhcmdldGluZ1tURkNEXX0gOiBudWxsKTtcbn1cblxuLyoqXG4gKiBJbmRpY2F0ZSBTUkEgcmVxdWVzdCBzaG91bGQgaW5jbHVkZSBhZHRlc3Q9b24gaWYgYW55IGJsb2NrIGluY2x1ZGVzIHRoZVxuICogbWFudWFsIGV4cGVyaW1lbnQgaWQuXG4gKiBAcGFyYW0geyFBcnJheTwhLi9hbXAtYWQtbmV0d29yay1kb3VibGVjbGljay1pbXBsLkFtcEFkTmV0d29ya0RvdWJsZWNsaWNrSW1wbD59IGltcGxzXG4gKiBAcmV0dXJuIHs/T2JqZWN0PHN0cmluZyxzdHJpbmc+fVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0FkVGVzdChpbXBscykge1xuICByZXR1cm4gZ2V0Rmlyc3RJbnN0YW5jZVZhbHVlXyhpbXBscywgaW1wbCA9PlxuICAgIGlzSW5NYW51YWxFeHBlcmltZW50KGltcGwuZWxlbWVudCkgPyB7J2FkdGVzdCc6ICdvbid9IDogbnVsbCk7XG59XG5cbi8qKlxuICogSm9pbiBibG9jayB0YXJnZXRpbmcgdmFsdWVzIGJ5IHNlcGFyYXRpbmcgYnkgcGlwZXMgKGVhY2gga2V5L3ZhbHVlIHBhaXIgZm9yXG4gKiBhIGdpdmVuIGJsb2NrIGlzIHNlcGFyYXRlZCBieSA9KSBhbmQgZXhjbHVzaW9ucyBhcmUgZ2l2ZW4gc3BlY2lhbCBleGNsX2NhdFxuICoga2V5IChsaXN0IG9mIGNhdGVnb3JpZXMgYXJlIGNvbW1hIHNlcGFyYXRlZCkuXG4gKiBAcGFyYW0geyFBcnJheTwhLi9hbXAtYWQtbmV0d29yay1kb3VibGVjbGljay1pbXBsLkFtcEFkTmV0d29ya0RvdWJsZWNsaWNrSW1wbD59IGltcGxzXG4gKiBAcmV0dXJuIHs/T2JqZWN0PHN0cmluZyxzdHJpbmc+fVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUYXJnZXRpbmdBbmRFeGNsdXNpb25zKGltcGxzKSB7XG4gIGxldCBoYXNTY3AgPSBmYWxzZTtcbiAgY29uc3Qgc2NwcyA9IFtdO1xuICBpbXBscy5mb3JFYWNoKGltcGwgPT4ge1xuICAgIGlmIChpbXBsLmpzb25UYXJnZXRpbmcgJiYgKGltcGwuanNvblRhcmdldGluZ1sndGFyZ2V0aW5nJ10gfHxcbiAgICAgICBpbXBsLmpzb25UYXJnZXRpbmdbJ2NhdGVnb3J5RXhjbHVzaW9ucyddKSkge1xuICAgICAgaGFzU2NwID0gdHJ1ZTtcbiAgICAgIHNjcHMucHVzaChzZXJpYWxpemVUYXJnZXRpbmcoXG4gICAgICAgICAgaW1wbC5qc29uVGFyZ2V0aW5nWyd0YXJnZXRpbmcnXSB8fCBudWxsLFxuICAgICAgICAgIGltcGwuanNvblRhcmdldGluZ1snY2F0ZWdvcnlFeGNsdXNpb25zJ10gfHwgbnVsbCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzY3BzLnB1c2goJycpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBoYXNTY3AgPyB7J3ByZXZfc2NwJzogc2Nwcy5qb2luKCd8Jyl9IDogbnVsbDtcbn1cblxuLyoqXG4gKiBFeHBlcmltZW50IGlkcyBhcmUgYXNzdW1lZCB0byBiZSBwYWdlIGxldmVsIGdpdmVuIHRoYXQgaXMgYWxsIHRoYXQgaXNcbiAqIHN1cHBvcnRlZCBmb3IgU1JBIHJlcXVlc3RzIHRoZXJlZm9yZSBibG9jayB2YWx1ZXMgYXJlIGNvbWJpbmVkIGJ5IGJ1aWxkaW5nXG4gKiB0aGUgdW5pcXVlIHNldCBvZiBleHBlcmltZW50IGlkcyB3aGljaCBhcmUgY29tbWEgc2VwYXJhdGVkIChvcmRlciBkb2VzIG5vdFxuICogbWF0dGVyKS5cbiAqIEBwYXJhbSB7IUFycmF5PCEuL2FtcC1hZC1uZXR3b3JrLWRvdWJsZWNsaWNrLWltcGwuQW1wQWROZXR3b3JrRG91YmxlY2xpY2tJbXBsPn0gaW1wbHNcbiAqIEByZXR1cm4gez9PYmplY3Q8c3RyaW5nLHN0cmluZz59XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4cGVyaW1lbnRJZHMoaW1wbHMpIHtcbiAgY29uc3QgZWlkcyA9IHt9O1xuICBjb25zdCBkZWlkID0gKGltcGxzLmxlbmd0aCAmJlxuICAgICAvKD86I3wsKWRlaWQ9KFtcXGQsXSspL2kuZXhlYyhpbXBsc1swXS53aW4ubG9jYXRpb24uaGFzaCkpIHx8IFtdO1xuICAoZGVpZFsxXSB8fCAnJykuc3BsaXQoJywnKS5mb3JFYWNoKGVpZCA9PiBlaWQgJiYgKGVpZHNbZWlkXSA9IDEpKTtcbiAgaW1wbHMuZm9yRWFjaChpbXBsID0+IGltcGwuZXhwZXJpbWVudElkcy5mb3JFYWNoKGVpZCA9PiBlaWRzW2VpZF0gPSAxKSk7XG4gIGNvbnN0IGVpZEtleXMgPSBPYmplY3Qua2V5cyhlaWRzKS5qb2luKCk7XG4gIHJldHVybiBlaWRLZXlzID8geydlaWQnOiBlaWRLZXlzfSA6IG51bGw7XG59XG5cbi8qKlxuICogSWRlbnRpdHkgdG9rZW4gaXMgcGFnZSBsZXZlbCB0aGVyZWZvcmUgU1JBIHVzZXMgdGhlIHZhbHVlIG9mIHRoZSBmaXJzdFxuICogYmxvY2suXG4gKiBAcGFyYW0geyFBcnJheTwhLi9hbXAtYWQtbmV0d29yay1kb3VibGVjbGljay1pbXBsLkFtcEFkTmV0d29ya0RvdWJsZWNsaWNrSW1wbD59IGltcGxzXG4gKiBAcmV0dXJuIHs/T2JqZWN0PHN0cmluZyxzdHJpbmc+fVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRJZGVudGl0eShpbXBscykge1xuICByZXR1cm4gZ2V0Rmlyc3RJbnN0YW5jZVZhbHVlXyhpbXBscywgaW1wbCA9PiBpbXBsLmJ1aWxkSWRlbnRpdHlQYXJhbXMoKSk7XG59XG5cbi8qKlxuICogQ29tYmluZSBmb3JjZSBzYWZlZnJhbWUgdmFsdWVzIGZvciBlYWNoIGJsb2NrIHZpYSBjb21tYSBzZXBhcmF0ZWQgbnVtZXJpY1xuICogdmFsdWVzIGJhc2VkIG9uIGJvb2xlYW4gdmFsdWUgKGUuZy4gZmFsc2UgPSAwLCB0cnVlID0gMSkuICBJZiBub25lIG9mIHRoZVxuICogYmxvY2tzIGhhcyBmb3JjZSBzYWZlZnJhbWUsIHBhcmFtZXRlciBpcyBub3QgaW5jbHVkZWQgaW4gU1JBIHJlcXVlc3QuXG4gKiBAcGFyYW0geyFBcnJheTwhLi9hbXAtYWQtbmV0d29yay1kb3VibGVjbGljay1pbXBsLkFtcEFkTmV0d29ya0RvdWJsZWNsaWNrSW1wbD59IGltcGxzXG4gKiBAcmV0dXJuIHs/T2JqZWN0PHN0cmluZyxzdHJpbmc+fVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRGb3JjZVNhZmVmcmFtZShpbXBscykge1xuICBsZXQgc2FmZWZyYW1lRm9yY2VkID0gZmFsc2U7XG4gIGNvbnN0IGZvcmNlU2FmZWZyYW1lcyA9IFtdO1xuICBpbXBscy5mb3JFYWNoKGltcGwgPT4ge1xuICAgIHNhZmVmcmFtZUZvcmNlZCA9IHNhZmVmcmFtZUZvcmNlZCB8fCBpbXBsLmZvcmNlU2FmZWZyYW1lO1xuICAgIGZvcmNlU2FmZWZyYW1lcy5wdXNoKE51bWJlcihpbXBsLmZvcmNlU2FmZWZyYW1lKSk7XG4gIH0pO1xuICByZXR1cm4gc2FmZWZyYW1lRm9yY2VkID8geydmc2ZzJzogZm9yY2VTYWZlZnJhbWVzLmpvaW4oKX0gOiBudWxsO1xufVxuXG4vKipcbiAqIENvbWJpbmUgcGFnZSBvZmZzZXQgaW5mbyBmb3IgZWFjaCBibG9jayBieSBjb25zdHJ1Y3Rpbmcgc2VwYXJhdGUgcGFyYW1ldGVyXG4gKiBmb3IgbGVmdCAoYWR4cykgYW5kIHRvcCAoYWR5eCkgdmlhIGNvbW1hIHNlcGFyYXRlZC5cbiAqIEBwYXJhbSB7IUFycmF5PCEuL2FtcC1hZC1uZXR3b3JrLWRvdWJsZWNsaWNrLWltcGwuQW1wQWROZXR3b3JrRG91YmxlY2xpY2tJbXBsPn0gaW1wbHNcbiAqIEByZXR1cm4gez9PYmplY3Q8c3RyaW5nLHN0cmluZz59XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFBhZ2VPZmZzZXRzKGltcGxzKSB7XG4gIGNvbnN0IGFkeHMgPSBbXTtcbiAgY29uc3QgYWR5cyA9IFtdO1xuICBpbXBscy5mb3JFYWNoKGltcGwgPT4ge1xuICAgIGNvbnN0IGxheW91dEJveCA9IGltcGwuZ2V0UGFnZUxheW91dEJveCgpO1xuICAgIGFkeHMucHVzaChsYXlvdXRCb3gubGVmdCk7XG4gICAgYWR5cy5wdXNoKGxheW91dEJveC50b3ApO1xuICB9KTtcbiAgcmV0dXJuIHsnYWR4cyc6IGFkeHMuam9pbigpLCAnYWR5cyc6IGFkeXMuam9pbigpfTtcbn1cblxuLyoqXG4gKiBDb21iaW5lIHdoaWNoIGNvbnRhaW5lcnMgZXhpc3QgZm9yIGVhY2ggYmxvY2sgKGUuZy4gc3RpY2t5KSB2aWEgcGlwZVxuICogc2VwYXJhdG9yIChhcyBibG9jayBjYW4gaGF2ZSBtdWx0aXBsZSB2YWx1ZXMgdGhhdCBhcmUgY29tbWEgc2VwYXJhdGVkKS4gIElmXG4gKiBub25lIG9mIHRoZSBibG9ja3MgaGF2ZSBhIGNvbnRhaW5lciwgdGhlbiBwYXJhbWV0ZXIgaXMgbm90IHNlbnQuXG4gKiBAcGFyYW0geyFBcnJheTwhLi9hbXAtYWQtbmV0d29yay1kb3VibGVjbGljay1pbXBsLkFtcEFkTmV0d29ya0RvdWJsZWNsaWNrSW1wbD59IGltcGxzXG4gKiBAcmV0dXJuIHs/T2JqZWN0PHN0cmluZyxzdHJpbmc+fVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb250YWluZXJzKGltcGxzKSB7XG4gIGxldCBoYXNBbXBDb250YWluZXIgPSBmYWxzZTtcbiAgY29uc3QgcmVzdWx0ID0gW107XG4gIGltcGxzLmZvckVhY2goaW1wbCA9PiB7XG4gICAgY29uc3QgY29udGFpbmVycyA9IGdldEVuY2xvc2luZ0NvbnRhaW5lclR5cGVzKGltcGwuZWxlbWVudCk7XG4gICAgcmVzdWx0LnB1c2goY29udGFpbmVycy5qb2luKCkpO1xuICAgIGhhc0FtcENvbnRhaW5lciA9IGhhc0FtcENvbnRhaW5lciB8fCAhIWNvbnRhaW5lcnMubGVuZ3RoO1xuICB9KTtcbiAgcmV0dXJuIGhhc0FtcENvbnRhaW5lciA/IHsnYWN0cyc6IHJlc3VsdC5qb2luKCd8Jyl9IDogbnVsbDtcbn1cblxuLyoqXG4gKiBAcGFyYW0gez9PYmplY3Q8c3RyaW5nLCAoIUFycmF5PHN0cmluZz58c3RyaW5nKT59IHRhcmdldGluZ1xuICogQHBhcmFtIHs/KCFBcnJheTxzdHJpbmc+fHN0cmluZyl9IGNhdGVnb3J5RXhjbHVzaW9uc1xuICogQHJldHVybiB7P3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNlcmlhbGl6ZVRhcmdldGluZyh0YXJnZXRpbmcsIGNhdGVnb3J5RXhjbHVzaW9ucykge1xuICBjb25zdCBzZXJpYWxpemVkID0gdGFyZ2V0aW5nID9cbiAgICBPYmplY3Qua2V5cyh0YXJnZXRpbmcpLm1hcChrZXkgPT4gc2VyaWFsaXplSXRlbV8oa2V5LCB0YXJnZXRpbmdba2V5XSkpIDpcbiAgICBbXTtcbiAgaWYgKGNhdGVnb3J5RXhjbHVzaW9ucykge1xuICAgIHNlcmlhbGl6ZWQucHVzaChzZXJpYWxpemVJdGVtXygnZXhjbF9jYXQnLCBjYXRlZ29yeUV4Y2x1c2lvbnMpKTtcbiAgfVxuICByZXR1cm4gc2VyaWFsaXplZC5sZW5ndGggPyBzZXJpYWxpemVkLmpvaW4oJyYnKSA6IG51bGw7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICogQHBhcmFtIHsoIUFycmF5PHN0cmluZz58c3RyaW5nKX0gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIHNlcmlhbGl6ZUl0ZW1fKGtleSwgdmFsdWUpIHtcbiAgY29uc3Qgc2VyaWFsaXplZFZhbHVlID1cbiAgICAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZSA6IFt2YWx1ZV0pLm1hcChlbmNvZGVVUklDb21wb25lbnQpLmpvaW4oKTtcbiAgcmV0dXJuIGAke2VuY29kZVVSSUNvbXBvbmVudChrZXkpfT0ke3NlcmlhbGl6ZWRWYWx1ZX1gO1xufVxuXG4vKipcbiAqIENhbGxiYWNrIGZvciBzdHJlYW1pbmcgU1JBIHJlc3BvbnNlIGdpdmVuIGNyZWF0aXZlIGFuZCBKU09OIHBhcnNlZCBPYmplY3RcbiAqIGNvbnRhaW5pbmcgaGVhZGVycyAoYXMgaWYgcmVxdWVzdCBoYWQgYmVlbiBzZW50IHZpYSBub24tU1JBIGZsb3cpLiAgQ3JlYXRpdmVcbiAqIGFuZCBoZWFkZXJzIG9iamVjdCBpcyBjb252ZXJ0ZWQgdG8gWEhSIEZldGNoUmVzcG9uc2Ugb2JqZWN0IGFuZCBwYXNzZWQgdG9cbiAqIHJlc29sdmVyIHBvcHBlZCBvZmYgc3RhY2sgb2YgcmVzb2x2ZXJzIChpbiBvcmRlciBvZiBleHBlY3RlZCBibG9jayByZXNwb25zZXMpXG4gKiBzdWNoIHRoYXQgc2VuZFhoclJlcXVlc3QgaXMgcmVzb2x2ZWQgZnJvbSBzdGFuZGFyZCBBNEEgZmxvdy4gIERvbmUgYm9vbGVhblxuICogdXNlZCB0byB2ZXJpZnkgYXJyYXkgb2YgcmVzb2x2ZXJzIGlzIGVtcHR5IG9uY2UgYWxsIHJlc3VsdHMgYXJlIHJldHVybmVkLlxuICogQHBhcmFtIHtzdHJpbmd9IGNyZWF0aXZlXG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLHN0cmluZz59IGhlYWRlcnNPYmpcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gZG9uZVxuICogQHBhcmFtIHshQXJyYXk8ZnVuY3Rpb24oPy4uLy4uLy4uL3NyYy91dGlscy94aHItdXRpbHMuRmV0Y2hSZXNwb25zZSk+fSBzcmFSZXF1ZXN0QWRVcmxSZXNvbHZlcnNcbiAqIEBwYXJhbSB7c3RyaW5nfSBzcmFVcmwgdXJsIG9mIFNSQSByZXF1ZXN0IGZvciBlcnJvciByZXBvcnRpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNyYUJsb2NrQ2FsbGJhY2tIYW5kbGVyKFxuICBjcmVhdGl2ZSwgaGVhZGVyc09iaiwgZG9uZSwgc3JhUmVxdWVzdEFkVXJsUmVzb2x2ZXJzLCBzcmFVcmwpIHtcbiAgY29uc3QgaGVhZGVyTmFtZXMgPSBPYmplY3Qua2V5cyhoZWFkZXJzT2JqKTtcbiAgaWYgKGhlYWRlck5hbWVzLmxlbmd0aCA9PSAxICYmXG4gICAgICBpc09iamVjdChoZWFkZXJzT2JqW2hlYWRlck5hbWVzWzBdXSkpIHtcbiAgICAvLyBUT0RPKGtlaXRod3JpZ2h0Ym9zKSAtIGZpeCB1cHN0cmVhbSBzbyByZXNwb25zZSBkb2VzXG4gICAgLy8gbm90IGltcHJvcGVybHkgcGxhY2UgaGVhZGVycyB1bmRlciBrZXkuXG4gICAgaGVhZGVyc09iaiA9XG4gICAgICAvKiogQHR5cGUgeyFPYmplY3R9ICovKGhlYWRlcnNPYmopW2hlYWRlck5hbWVzWzBdXTtcbiAgICBoZWFkZXJzT2JqID0gT2JqZWN0LmtleXMoaGVhZGVyc09iaikucmVkdWNlKFxuICAgICAgICAobmV3T2JqLCBrZXkpID0+IHtcbiAgICAgICAgICBuZXdPYmpba2V5LnRvTG93ZXJDYXNlKCldID0gaGVhZGVyc09ialtrZXldO1xuICAgICAgICAgIHJldHVybiBuZXdPYmo7XG4gICAgICAgIH0sIHt9KTtcbiAgfVxuICAvLyBGb3JjZSBzYWZlZnJhbWUgcmVuZGVyaW5nIG1ldGhvZC5cbiAgaGVhZGVyc09ialtSRU5ERVJJTkdfVFlQRV9IRUFERVIudG9Mb3dlckNhc2UoKV0gPVxuICAgICAgWE9SSUdJTl9NT0RFLlNBRkVGUkFNRTtcbiAgLy8gQ29uc3RydWN0IHBzZXVkbyBmZXRjaCByZXNwb25zZSB0byBiZSBwYXNzZWQgZG93biB0aGUgQTRBXG4gIC8vIHByb21pc2UgY2hhaW4gZm9yIHRoaXMgYmxvY2suXG4gIGNvbnN0IGhlYWRlcnMgPVxuLyoqIEB0eXBlIHs/Li4vLi4vLi4vc3JjL3V0aWxzL3hoci11dGlscy5GZXRjaFJlc3BvbnNlSGVhZGVyc30gKi9cbih7XG4gIGdldDogbmFtZSA9PiB7XG4gICAgLy8gVE9ETyhrZWl0aHdyaWdodGJvcykgLSBmaXggdXBzdHJlYW0gc28gcmVzcG9uc2Ugd3JpdGVzXG4gICAgLy8gYWxsIG1ldGFkYXRhIHZhbHVlcyBhcyBzdHJpbmdzLlxuICAgIGxldCBoZWFkZXIgPSBoZWFkZXJzT2JqW25hbWUudG9Mb3dlckNhc2UoKV07XG4gICAgaWYgKGhlYWRlciAmJiB0eXBlb2YgaGVhZGVyICE9ICdzdHJpbmcnKSB7XG4gICAgICBoZWFkZXIgPSBKU09OLnN0cmluZ2lmeShoZWFkZXIpO1xuICAgIH1cbiAgICByZXR1cm4gaGVhZGVyO1xuICB9LFxuICBoYXM6IG5hbWUgPT4gISFoZWFkZXJzT2JqW25hbWUudG9Mb3dlckNhc2UoKV0sXG59KTtcbiAgY29uc3QgZmV0Y2hSZXNwb25zZSA9XG4vKiogQHR5cGUgez8uLi8uLi8uLi9zcmMvdXRpbHMveGhyLXV0aWxzLkZldGNoUmVzcG9uc2V9ICovXG4oe1xuICBoZWFkZXJzLFxuICBhcnJheUJ1ZmZlcjogKCkgPT4gdHJ5UmVzb2x2ZSgoKSA9PiB1dGY4RW5jb2RlKGNyZWF0aXZlKSksXG59KTtcbiAgLy8gUG9wIGhlYWQgb2ZmIG9mIHRoZSBhcnJheSBvZiByZXNvbHZlcnMgYXMgdGhlIHJlc3BvbnNlXG4gIC8vIHNob3VsZCBtYXRjaCB0aGUgb3JkZXIgb2YgYmxvY2tzIGRlY2xhcmVkIGluIHRoZSBhZCB1cmwuXG4gIC8vIFRoaXMgYWxsb3dzIHRoZSBibG9jayB0byBzdGFydCByZW5kZXJpbmcgd2hpbGUgdGhlIFNSQVxuICAvLyByZXNwb25zZSBpcyBzdHJlYW1pbmcgYmFjayB0byB0aGUgY2xpZW50LlxuICBkZXYoKS5hc3NlcnQoc3JhUmVxdWVzdEFkVXJsUmVzb2x2ZXJzLnNoaWZ0KCkpKGZldGNoUmVzcG9uc2UpO1xuICAvLyBJZiBkb25lLCBleHBlY3QgYXJyYXkgdG8gYmUgZW1wdHkgKGVuc3VyZXMgYWQgcmVzcG9uc2VcbiAgLy8gaW5jbHVkZWQgZGF0YSBmb3IgYWxsIHNsb3RzKS5cbiAgaWYgKGRvbmUgJiYgc3JhUmVxdWVzdEFkVXJsUmVzb2x2ZXJzLmxlbmd0aCkge1xuICAgIGRldigpLndhcm4oVEFHLCAnUHJlbWF0dXJlIGVuZCBvZiBTUkEgcmVzcG9uc2UnLFxuICAgICAgICBzcmFSZXF1ZXN0QWRVcmxSZXNvbHZlcnMubGVuZ3RoLCBzcmFVcmwpO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtzdGFydHNXaXRofSBmcm9tICcuLi8uLi8uLi9zcmMvc3RyaW5nJztcblxuLyoqIEBjb25zdCBAcHJpdmF0ZSB7c3RyaW5nfSAqL1xuY29uc3QgR01PU1NQX1NSQ19QUkVGSVhfID0gJ2h0dHBzOi8vc3AuZ21vc3NwLXNwLmpwLyc7XG5cbi8qKiBAY29uc3QgQHByaXZhdGUge3N0cmluZ30gKi9cbmNvbnN0IEdNT1NTUF9TUkNfQTRBX1BSRUZJWF8gPSAnaHR0cHM6Ly9hbXAuc3AuZ21vc3NwLXNwLmpwL19hNGEvJztcblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtib29sZWFufSB1c2VSZW1vdGVIdG1sXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ21vc3NwSXNBNEFFbmFibGVkKHdpbiwgZWxlbWVudCwgdXNlUmVtb3RlSHRtbCkge1xuICBsZXQgc3JjO1xuICByZXR1cm4gIXVzZVJlbW90ZUh0bWwgJiYgISEoc3JjID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3NyYycpKSAmJlxuICAgICAgISFlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS11c2UtYTRhJykgJiZcbiAgICAgIChzdGFydHNXaXRoKHNyYywgR01PU1NQX1NSQ19QUkVGSVhfKSB8fFxuICAgICAgIHN0YXJ0c1dpdGgoc3JjLCBHTU9TU1BfU1JDX0E0QV9QUkVGSVhfKSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqIEBjb25zdCBAcHJpdmF0ZSB7c3RyaW5nfSAqL1xuY29uc3QgU1JDX1BSRUZJWF8gPSAnaHR0cHM6Ly9pYi4zbGlmdC5jb20vJztcbi8qKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gdXNlUmVtb3RlSHRtbFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyaXBsZWxpZnRJc0E0QUVuYWJsZWQod2luLCBlbGVtZW50LCB1c2VSZW1vdGVIdG1sKSB7XG4gIGxldCBzcmM7XG4gIHJldHVybiAhdXNlUmVtb3RlSHRtbCAmJiAhIWVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXVzZS1hNGEnKSAmJiAhIShzcmMgPVxuICAgIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdzcmMnKSkgJiYgc3JjLmluZGV4T2YoU1JDX1BSRUZJWF8pID09IDA7XG59XG4iLCIvKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7RGVmZXJyZWR9IGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9wcm9taXNlJztcbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4uLy4uLy4uL3NyYy9zZXJ2aWNlcyc7XG5pbXBvcnQge3VzZXJ9IGZyb20gJy4uLy4uLy4uL3NyYy9sb2cnO1xuXG4vKipcbiAqIFN0b3JlIGxvYWRpbmcgYWRzIGluZm8gd2l0aGluIHdpbmRvdyB0byBlbnN1cmUgaXQgY2FuIGJlIHByb3Blcmx5IHN0b3JlZFxuICogYWNyb3NzIHNlcGFyYXRlbHkgY29tcGlsZWQgYmluYXJpZXMgdGhhdCBzaGFyZSBsb2FkIHRocm90dGxpbmcuXG4gKiBAY29uc3QgSUQgb2Ygd2luZG93IHZhcmlhYmxlIHVzZWQgdG8gdHJhY2sgM3AgYWRzIHdhaXRpbmcgdG8gbG9hZC5cbiAqL1xuY29uc3QgTE9BRElOR19BRFNfV0lOX0lEXyA9ICczcGxhJztcblxuLyoqIEBwcml2YXRlIHs/UHJvbWlzZX0gcmVzb2x2ZXMgd2hlbiBubyAzcCB0aHJvdHRsZSAqL1xubGV0IHRocm90dGxlUHJvbWlzZV8gPSBudWxsO1xuLyoqIEBwcml2YXRlIHs/RnVuY3Rpb259IHJlc29sdmVyIGZvciB0aHJvdHRsZSBwcm9taXNlICovXG5sZXQgdGhyb3R0bGVQcm9taXNlUmVzb2x2ZXJfID0gbnVsbDtcblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciAzcCBpcyBjdXJyZW50bHkgdGhyb3R0bGVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXMzcFRocm90dGxlZCh3aW4pIHtcbiAgcmV0dXJuICEhd2luW0xPQURJTkdfQURTX1dJTl9JRF9dO1xufVxuXG4vKiogQHJldHVybiB7IVByb21pc2V9IHJlc29sdmVzIHdoZW4gbm8gM3AgdGhyb3R0bGUgKi9cbmV4cG9ydCBmdW5jdGlvbiB3YWl0Rm9yM3BUaHJvdHRsZSgpIHtcbiAgcmV0dXJuIHRocm90dGxlUHJvbWlzZV8gfHwgUHJvbWlzZS5yZXNvbHZlKCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7P251bWJlcn0gbnVtYmVyIGlmIGV4cGxpY2l0IHZhbHVlIHNob3VsZCBiZSB1c2VkIG90aGVyd2lzZSBzdXBlclxuICogICAgZGVmYXVsdCBzaG91bGQgYmUgdXNlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFtcEFkUmVuZGVyT3V0c2lkZVZpZXdwb3J0KGVsZW1lbnQpIHtcbiAgY29uc3QgcmF3VmFsdWUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1sb2FkaW5nLXN0cmF0ZWd5Jyk7XG4gIGlmIChyYXdWYWx1ZSA9PSBudWxsKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgLy8gQWQgb3B0cyBpbnRvIGxhemllciBsb2FkaW5nIHN0cmF0ZWd5IHdoZXJlIHdlIG9ubHkgbG9hZCBhZHMgdGhhdCBhcmVcbiAgLy8gYXQgY2xvc2VyIGdpdmVuIG51bWJlciBvZiB2aWV3cG9ydHMgYXdheS5cbiAgaWYgKHJhd1ZhbHVlID09ICdwcmVmZXItdmlld2FiaWxpdHktb3Zlci12aWV3cycgfHwgcmF3VmFsdWUgPT0gJycpIHtcbiAgICByZXR1cm4gMS4yNTtcbiAgfVxuICBjb25zdCBlcnJvck1lc3NhZ2UgPVxuICAgICAgJ1ZhbHVlIG9mIGRhdGEtbG9hZGluZy1zdHJhdGVneSBzaG91bGQgYmUgYSBmbG9hdCBudW1iZXIgaW4gcmFuZ2UgJyArXG4gICAgICAnb2YgWzAsIDNdLCBidXQgZ290ICcgKyByYXdWYWx1ZTtcbiAgY29uc3Qgdmlld3BvcnROdW1iZXIgPVxuICAgICAgdXNlcigpLmFzc2VydE51bWJlcihwYXJzZUZsb2F0KHJhd1ZhbHVlKSwgZXJyb3JNZXNzYWdlKTtcbiAgdXNlcigpLmFzc2VydCh2aWV3cG9ydE51bWJlciA+PSAwICYmIHZpZXdwb3J0TnVtYmVyIDw9IDMsIGVycm9yTWVzc2FnZSk7XG4gIHJldHVybiB2aWV3cG9ydE51bWJlcjtcbn1cblxuLyoqXG4gKiBJbmNyZW1lbnRzIGxvYWRpbmcgYWRzIGNvdW50IGZvciB0aHJvdHRsaW5nLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IVByb21pc2U9fSBvcHRfbG9hZGluZ1Byb21pc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluY3JlbWVudExvYWRpbmdBZHMod2luLCBvcHRfbG9hZGluZ1Byb21pc2UpIHtcbiAgaWYgKHdpbltMT0FESU5HX0FEU19XSU5fSURfXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgd2luW0xPQURJTkdfQURTX1dJTl9JRF9dID0gMDtcbiAgfVxuICB3aW5bTE9BRElOR19BRFNfV0lOX0lEX10rKztcblxuICBpZiAoIXRocm90dGxlUHJvbWlzZV8pIHtcbiAgICBjb25zdCBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgIHRocm90dGxlUHJvbWlzZV8gPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgIHRocm90dGxlUHJvbWlzZVJlc29sdmVyXyA9IGRlZmVycmVkLnJlc29sdmU7XG4gIH1cblxuICBTZXJ2aWNlcy50aW1lckZvcih3aW4pXG4gICAgICAudGltZW91dFByb21pc2UoMTAwMCwgb3B0X2xvYWRpbmdQcm9taXNlKVxuICAgICAgLmNhdGNoKCgpID0+IHt9KVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBpZiAoIS0td2luW0xPQURJTkdfQURTX1dJTl9JRF9dKSB7XG4gICAgICAgICAgdGhyb3R0bGVQcm9taXNlUmVzb2x2ZXJfKCk7XG4gICAgICAgICAgdGhyb3R0bGVQcm9taXNlXyA9IG51bGw7XG4gICAgICAgICAgdGhyb3R0bGVQcm9taXNlUmVzb2x2ZXJfID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSk7XG59XG4iLCIvKiFcblxuQ29weXJpZ2h0IChDKSAyMDE0LTIwMTYgYnkgQW5kcmVhIEdpYW1tYXJjaGkgLSBAV2ViUmVmbGVjdGlvblxuXG5QZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG5vZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG5pbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG50byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG5jb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbmZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG5cblRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG5hbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG5GSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbkFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbkxJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG5PVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG5USEUgU09GVFdBUkUuXG5cbiovXG4vLyBnbG9iYWwgd2luZG93IE9iamVjdFxuLy8gb3B0aW9uYWwgcG9seWZpbGwgaW5mb1xuLy8gICAgJ2F1dG8nIHVzZWQgYnkgZGVmYXVsdCwgZXZlcnl0aGluZyBpcyBmZWF0dXJlIGRldGVjdGVkXG4vLyAgICAnZm9yY2UnIHVzZSB0aGUgcG9seWZpbGwgZXZlbiBpZiBub3QgZnVsbHkgbmVlZGVkXG5mdW5jdGlvbiBpbnN0YWxsQ3VzdG9tRWxlbWVudHMod2luZG93LCBwb2x5ZmlsbCkgeyd1c2Ugc3RyaWN0JztcblxuICAvLyBETyBOT1QgVVNFIFRISVMgRklMRSBESVJFQ1RMWSwgSVQgV09OJ1QgV09SS1xuICAvLyBUSElTIElTIEEgUFJPSkVDVCBCQVNFRCBPTiBBIEJVSUxEIFNZU1RFTVxuICAvLyBUSElTIEZJTEUgSVMgSlVTVCBXUkFQUEVEIFVQIFJFU1VMVElORyBJTlxuICAvLyBidWlsZC9kb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50Lm5vZGUuanNcblxuICB2YXJcbiAgICBkb2N1bWVudCA9IHdpbmRvdy5kb2N1bWVudCxcbiAgICBPYmplY3QgPSB3aW5kb3cuT2JqZWN0XG4gIDtcblxuICB2YXIgaHRtbENsYXNzID0gKGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgLy8gKEMpIEFuZHJlYSBHaWFtbWFyY2hpIC0gQFdlYlJlZmxlY3Rpb24gLSBNSVQgU3R5bGVcbiAgICB2YXJcbiAgICAgIGNhdGNoQ2xhc3MgPSAvXltBLVpdK1thLXpdLyxcbiAgICAgIGZpbHRlckJ5ID0gZnVuY3Rpb24gKHJlKSB7XG4gICAgICAgIHZhciBhcnIgPSBbXSwgdGFnO1xuICAgICAgICBmb3IgKHRhZyBpbiByZWdpc3Rlcikge1xuICAgICAgICAgIGlmIChyZS50ZXN0KHRhZykpIGFyci5wdXNoKHRhZyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFycjtcbiAgICAgIH0sXG4gICAgICBhZGQgPSBmdW5jdGlvbiAoQ2xhc3MsIHRhZykge1xuICAgICAgICB0YWcgPSB0YWcudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKCEodGFnIGluIHJlZ2lzdGVyKSkge1xuICAgICAgICAgIHJlZ2lzdGVyW0NsYXNzXSA9IChyZWdpc3RlcltDbGFzc10gfHwgW10pLmNvbmNhdCh0YWcpO1xuICAgICAgICAgIHJlZ2lzdGVyW3RhZ10gPSAocmVnaXN0ZXJbdGFnLnRvVXBwZXJDYXNlKCldID0gQ2xhc3MpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgcmVnaXN0ZXIgPSAoT2JqZWN0LmNyZWF0ZSB8fCBPYmplY3QpKG51bGwpLFxuICAgICAgaHRtbENsYXNzID0ge30sXG4gICAgICBpLCBzZWN0aW9uLCB0YWdzLCBDbGFzc1xuICAgIDtcbiAgICBmb3IgKHNlY3Rpb24gaW4gaW5mbykge1xuICAgICAgZm9yIChDbGFzcyBpbiBpbmZvW3NlY3Rpb25dKSB7XG4gICAgICAgIHRhZ3MgPSBpbmZvW3NlY3Rpb25dW0NsYXNzXTtcbiAgICAgICAgcmVnaXN0ZXJbQ2xhc3NdID0gdGFncztcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHRhZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICByZWdpc3Rlclt0YWdzW2ldLnRvTG93ZXJDYXNlKCldID1cbiAgICAgICAgICByZWdpc3Rlclt0YWdzW2ldLnRvVXBwZXJDYXNlKCldID0gQ2xhc3M7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaHRtbENsYXNzLmdldCA9IGZ1bmN0aW9uIGdldCh0YWdPckNsYXNzKSB7XG4gICAgICByZXR1cm4gdHlwZW9mIHRhZ09yQ2xhc3MgPT09ICdzdHJpbmcnID9cbiAgICAgICAgKHJlZ2lzdGVyW3RhZ09yQ2xhc3NdIHx8IChjYXRjaENsYXNzLnRlc3QodGFnT3JDbGFzcykgPyBbXSA6ICcnKSkgOlxuICAgICAgICBmaWx0ZXJCeSh0YWdPckNsYXNzKTtcbiAgICB9O1xuICAgIGh0bWxDbGFzcy5zZXQgPSBmdW5jdGlvbiBzZXQodGFnLCBDbGFzcykge1xuICAgICAgcmV0dXJuIChjYXRjaENsYXNzLnRlc3QodGFnKSA/XG4gICAgICAgIGFkZCh0YWcsIENsYXNzKSA6XG4gICAgICAgIGFkZChDbGFzcywgdGFnKVxuICAgICAgKSwgaHRtbENsYXNzO1xuICAgIH07XG4gICAgcmV0dXJuIGh0bWxDbGFzcztcbiAgfSh7XG4gICAgXCJjb2xsZWN0aW9uc1wiOiB7XG4gICAgICBcIkhUTUxBbGxDb2xsZWN0aW9uXCI6IFtcbiAgICAgICAgXCJhbGxcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTENvbGxlY3Rpb25cIjogW1xuICAgICAgICBcImZvcm1zXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGb3JtQ29udHJvbHNDb2xsZWN0aW9uXCI6IFtcbiAgICAgICAgXCJlbGVtZW50c1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT3B0aW9uc0NvbGxlY3Rpb25cIjogW1xuICAgICAgICBcIm9wdGlvbnNcIlxuICAgICAgXVxuICAgIH0sXG4gICAgXCJlbGVtZW50c1wiOiB7XG4gICAgICBcIkVsZW1lbnRcIjogW1xuICAgICAgICBcImVsZW1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEFuY2hvckVsZW1lbnRcIjogW1xuICAgICAgICBcImFcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEFwcGxldEVsZW1lbnRcIjogW1xuICAgICAgICBcImFwcGxldFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQXJlYUVsZW1lbnRcIjogW1xuICAgICAgICBcImFyZWFcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEF0dGFjaG1lbnRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJhdHRhY2htZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxBdWRpb0VsZW1lbnRcIjogW1xuICAgICAgICBcImF1ZGlvXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxCUkVsZW1lbnRcIjogW1xuICAgICAgICBcImJyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxCYXNlRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYmFzZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQm9keUVsZW1lbnRcIjogW1xuICAgICAgICBcImJvZHlcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEJ1dHRvbkVsZW1lbnRcIjogW1xuICAgICAgICBcImJ1dHRvblwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQ2FudmFzRWxlbWVudFwiOiBbXG4gICAgICAgIFwiY2FudmFzXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxDb250ZW50RWxlbWVudFwiOiBbXG4gICAgICAgIFwiY29udGVudFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRExpc3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGF0YUVsZW1lbnRcIjogW1xuICAgICAgICBcImRhdGFcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERhdGFMaXN0RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZGF0YWxpc3RcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERldGFpbHNFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkZXRhaWxzXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxEaWFsb2dFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkaWFsb2dcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERpcmVjdG9yeUVsZW1lbnRcIjogW1xuICAgICAgICBcImRpclwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGl2RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZGl2XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxEb2N1bWVudFwiOiBbXG4gICAgICAgIFwiZG9jdW1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEVsZW1lbnRcIjogW1xuICAgICAgICBcImVsZW1lbnRcIixcbiAgICAgICAgXCJhYmJyXCIsXG4gICAgICAgIFwiYWRkcmVzc1wiLFxuICAgICAgICBcImFydGljbGVcIixcbiAgICAgICAgXCJhc2lkZVwiLFxuICAgICAgICBcImJcIixcbiAgICAgICAgXCJiZGlcIixcbiAgICAgICAgXCJiZG9cIixcbiAgICAgICAgXCJjaXRlXCIsXG4gICAgICAgIFwiY29kZVwiLFxuICAgICAgICBcImNvbW1hbmRcIixcbiAgICAgICAgXCJkZFwiLFxuICAgICAgICBcImRmblwiLFxuICAgICAgICBcImR0XCIsXG4gICAgICAgIFwiZW1cIixcbiAgICAgICAgXCJmaWdjYXB0aW9uXCIsXG4gICAgICAgIFwiZmlndXJlXCIsXG4gICAgICAgIFwiZm9vdGVyXCIsXG4gICAgICAgIFwiaGVhZGVyXCIsXG4gICAgICAgIFwiaVwiLFxuICAgICAgICBcImtiZFwiLFxuICAgICAgICBcIm1hcmtcIixcbiAgICAgICAgXCJuYXZcIixcbiAgICAgICAgXCJub3NjcmlwdFwiLFxuICAgICAgICBcInJwXCIsXG4gICAgICAgIFwicnRcIixcbiAgICAgICAgXCJydWJ5XCIsXG4gICAgICAgIFwic1wiLFxuICAgICAgICBcInNhbXBcIixcbiAgICAgICAgXCJzZWN0aW9uXCIsXG4gICAgICAgIFwic21hbGxcIixcbiAgICAgICAgXCJzdHJvbmdcIixcbiAgICAgICAgXCJzdWJcIixcbiAgICAgICAgXCJzdW1tYXJ5XCIsXG4gICAgICAgIFwic3VwXCIsXG4gICAgICAgIFwidVwiLFxuICAgICAgICBcInZhclwiLFxuICAgICAgICBcIndiclwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRW1iZWRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJlbWJlZFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRmllbGRTZXRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJmaWVsZHNldFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRm9udEVsZW1lbnRcIjogW1xuICAgICAgICBcImZvbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEZvcm1FbGVtZW50XCI6IFtcbiAgICAgICAgXCJmb3JtXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGcmFtZUVsZW1lbnRcIjogW1xuICAgICAgICBcImZyYW1lXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGcmFtZVNldEVsZW1lbnRcIjogW1xuICAgICAgICBcImZyYW1lc2V0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxIUkVsZW1lbnRcIjogW1xuICAgICAgICBcImhyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxIZWFkRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaGVhZFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSGVhZGluZ0VsZW1lbnRcIjogW1xuICAgICAgICBcImgxXCIsXG4gICAgICAgIFwiaDJcIixcbiAgICAgICAgXCJoM1wiLFxuICAgICAgICBcImg0XCIsXG4gICAgICAgIFwiaDVcIixcbiAgICAgICAgXCJoNlwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSHRtbEVsZW1lbnRcIjogW1xuICAgICAgICBcImh0bWxcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTElGcmFtZUVsZW1lbnRcIjogW1xuICAgICAgICBcImlmcmFtZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSW1hZ2VFbGVtZW50XCI6IFtcbiAgICAgICAgXCJpbWdcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTElucHV0RWxlbWVudFwiOiBbXG4gICAgICAgIFwiaW5wdXRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEtleWdlbkVsZW1lbnRcIjogW1xuICAgICAgICBcImtleWdlblwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTElFbGVtZW50XCI6IFtcbiAgICAgICAgXCJsaVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTGFiZWxFbGVtZW50XCI6IFtcbiAgICAgICAgXCJsYWJlbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTGVnZW5kRWxlbWVudFwiOiBbXG4gICAgICAgIFwibGVnZW5kXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxMaW5rRWxlbWVudFwiOiBbXG4gICAgICAgIFwibGlua1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWFwRWxlbWVudFwiOiBbXG4gICAgICAgIFwibWFwXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNYXJxdWVlRWxlbWVudFwiOiBbXG4gICAgICAgIFwibWFycXVlZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWVkaWFFbGVtZW50XCI6IFtcbiAgICAgICAgXCJtZWRpYVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWVudUVsZW1lbnRcIjogW1xuICAgICAgICBcIm1lbnVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1lbnVJdGVtRWxlbWVudFwiOiBbXG4gICAgICAgIFwibWVudWl0ZW1cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1ldGFFbGVtZW50XCI6IFtcbiAgICAgICAgXCJtZXRhXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNZXRlckVsZW1lbnRcIjogW1xuICAgICAgICBcIm1ldGVyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNb2RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkZWxcIixcbiAgICAgICAgXCJpbnNcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE9MaXN0RWxlbWVudFwiOiBbXG4gICAgICAgIFwib2xcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE9iamVjdEVsZW1lbnRcIjogW1xuICAgICAgICBcIm9iamVjdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT3B0R3JvdXBFbGVtZW50XCI6IFtcbiAgICAgICAgXCJvcHRncm91cFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT3B0aW9uRWxlbWVudFwiOiBbXG4gICAgICAgIFwib3B0aW9uXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxPdXRwdXRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJvdXRwdXRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFBhcmFncmFwaEVsZW1lbnRcIjogW1xuICAgICAgICBcInBcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFBhcmFtRWxlbWVudFwiOiBbXG4gICAgICAgIFwicGFyYW1cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFBpY3R1cmVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJwaWN0dXJlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxQcmVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJwcmVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFByb2dyZXNzRWxlbWVudFwiOiBbXG4gICAgICAgIFwicHJvZ3Jlc3NcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFF1b3RlRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYmxvY2txdW90ZVwiLFxuICAgICAgICBcInFcIixcbiAgICAgICAgXCJxdW90ZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU2NyaXB0RWxlbWVudFwiOiBbXG4gICAgICAgIFwic2NyaXB0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxTZWxlY3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJzZWxlY3RcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFNoYWRvd0VsZW1lbnRcIjogW1xuICAgICAgICBcInNoYWRvd1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU2xvdEVsZW1lbnRcIjogW1xuICAgICAgICBcInNsb3RcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFNvdXJjZUVsZW1lbnRcIjogW1xuICAgICAgICBcInNvdXJjZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU3BhbkVsZW1lbnRcIjogW1xuICAgICAgICBcInNwYW5cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFN0eWxlRWxlbWVudFwiOiBbXG4gICAgICAgIFwic3R5bGVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlQ2FwdGlvbkVsZW1lbnRcIjogW1xuICAgICAgICBcImNhcHRpb25cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlQ2VsbEVsZW1lbnRcIjogW1xuICAgICAgICBcInRkXCIsXG4gICAgICAgIFwidGhcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlQ29sRWxlbWVudFwiOiBbXG4gICAgICAgIFwiY29sXCIsXG4gICAgICAgIFwiY29sZ3JvdXBcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGFibGVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlUm93RWxlbWVudFwiOiBbXG4gICAgICAgIFwidHJcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlU2VjdGlvbkVsZW1lbnRcIjogW1xuICAgICAgICBcInRoZWFkXCIsXG4gICAgICAgIFwidGJvZHlcIixcbiAgICAgICAgXCJ0Zm9vdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGVtcGxhdGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0ZW1wbGF0ZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGV4dEFyZWFFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0ZXh0YXJlYVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGltZUVsZW1lbnRcIjogW1xuICAgICAgICBcInRpbWVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRpdGxlRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGl0bGVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRyYWNrRWxlbWVudFwiOiBbXG4gICAgICAgIFwidHJhY2tcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFVMaXN0RWxlbWVudFwiOiBbXG4gICAgICAgIFwidWxcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFVua25vd25FbGVtZW50XCI6IFtcbiAgICAgICAgXCJ1bmtub3duXCIsXG4gICAgICAgIFwidmhncm91cHZcIixcbiAgICAgICAgXCJ2a2V5Z2VuXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxWaWRlb0VsZW1lbnRcIjogW1xuICAgICAgICBcInZpZGVvXCJcbiAgICAgIF1cbiAgICB9LFxuICAgIFwibm9kZXNcIjoge1xuICAgICAgXCJBdHRyXCI6IFtcbiAgICAgICAgXCJub2RlXCJcbiAgICAgIF0sXG4gICAgICBcIkF1ZGlvXCI6IFtcbiAgICAgICAgXCJhdWRpb1wiXG4gICAgICBdLFxuICAgICAgXCJDREFUQVNlY3Rpb25cIjogW1xuICAgICAgICBcIm5vZGVcIlxuICAgICAgXSxcbiAgICAgIFwiQ2hhcmFjdGVyRGF0YVwiOiBbXG4gICAgICAgIFwibm9kZVwiXG4gICAgICBdLFxuICAgICAgXCJDb21tZW50XCI6IFtcbiAgICAgICAgXCIjY29tbWVudFwiXG4gICAgICBdLFxuICAgICAgXCJEb2N1bWVudFwiOiBbXG4gICAgICAgIFwiI2RvY3VtZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkRvY3VtZW50RnJhZ21lbnRcIjogW1xuICAgICAgICBcIiNkb2N1bWVudC1mcmFnbWVudFwiXG4gICAgICBdLFxuICAgICAgXCJEb2N1bWVudFR5cGVcIjogW1xuICAgICAgICBcIm5vZGVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERvY3VtZW50XCI6IFtcbiAgICAgICAgXCIjZG9jdW1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSW1hZ2VcIjogW1xuICAgICAgICBcImltZ1wiXG4gICAgICBdLFxuICAgICAgXCJPcHRpb25cIjogW1xuICAgICAgICBcIm9wdGlvblwiXG4gICAgICBdLFxuICAgICAgXCJQcm9jZXNzaW5nSW5zdHJ1Y3Rpb25cIjogW1xuICAgICAgICBcIm5vZGVcIlxuICAgICAgXSxcbiAgICAgIFwiU2hhZG93Um9vdFwiOiBbXG4gICAgICAgIFwiI3NoYWRvdy1yb290XCJcbiAgICAgIF0sXG4gICAgICBcIlRleHRcIjogW1xuICAgICAgICBcIiN0ZXh0XCJcbiAgICAgIF0sXG4gICAgICBcIlhNTERvY3VtZW50XCI6IFtcbiAgICAgICAgXCJ4bWxcIlxuICAgICAgXVxuICAgIH1cbiAgfSkpO1xuICBcbiAgXG4gICAgXG4gIC8vIHBhc3NlZCBhdCBydW50aW1lLCBjb25maWd1cmFibGVcbiAgLy8gdmlhIG5vZGVqcyBtb2R1bGVcbiAgaWYgKCFwb2x5ZmlsbCkgcG9seWZpbGwgPSAnYXV0byc7XG4gIFxuICB2YXJcbiAgICAvLyBWMCBwb2x5ZmlsbCBlbnRyeVxuICAgIFJFR0lTVEVSX0VMRU1FTlQgPSAncmVnaXN0ZXJFbGVtZW50JyxcbiAgXG4gICAgLy8gSUUgPCAxMSBvbmx5ICsgb2xkIFdlYktpdCBmb3IgYXR0cmlidXRlcyArIGZlYXR1cmUgZGV0ZWN0aW9uXG4gICAgRVhQQU5ET19VSUQgPSAnX18nICsgUkVHSVNURVJfRUxFTUVOVCArICh3aW5kb3cuTWF0aC5yYW5kb20oKSAqIDEwZTQgPj4gMCksXG4gIFxuICAgIC8vIHNob3J0Y3V0cyBhbmQgY29zdGFudHNcbiAgICBBRERfRVZFTlRfTElTVEVORVIgPSAnYWRkRXZlbnRMaXN0ZW5lcicsXG4gICAgQVRUQUNIRUQgPSAnYXR0YWNoZWQnLFxuICAgIENBTExCQUNLID0gJ0NhbGxiYWNrJyxcbiAgICBERVRBQ0hFRCA9ICdkZXRhY2hlZCcsXG4gICAgRVhURU5EUyA9ICdleHRlbmRzJyxcbiAgXG4gICAgQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0sgPSAnYXR0cmlidXRlQ2hhbmdlZCcgKyBDQUxMQkFDSyxcbiAgICBBVFRBQ0hFRF9DQUxMQkFDSyA9IEFUVEFDSEVEICsgQ0FMTEJBQ0ssXG4gICAgQ09OTkVDVEVEX0NBTExCQUNLID0gJ2Nvbm5lY3RlZCcgKyBDQUxMQkFDSyxcbiAgICBESVNDT05ORUNURURfQ0FMTEJBQ0sgPSAnZGlzY29ubmVjdGVkJyArIENBTExCQUNLLFxuICAgIENSRUFURURfQ0FMTEJBQ0sgPSAnY3JlYXRlZCcgKyBDQUxMQkFDSyxcbiAgICBERVRBQ0hFRF9DQUxMQkFDSyA9IERFVEFDSEVEICsgQ0FMTEJBQ0ssXG4gIFxuICAgIEFERElUSU9OID0gJ0FERElUSU9OJyxcbiAgICBNT0RJRklDQVRJT04gPSAnTU9ESUZJQ0FUSU9OJyxcbiAgICBSRU1PVkFMID0gJ1JFTU9WQUwnLFxuICBcbiAgICBET01fQVRUUl9NT0RJRklFRCA9ICdET01BdHRyTW9kaWZpZWQnLFxuICAgIERPTV9DT05URU5UX0xPQURFRCA9ICdET01Db250ZW50TG9hZGVkJyxcbiAgICBET01fU1VCVFJFRV9NT0RJRklFRCA9ICdET01TdWJ0cmVlTW9kaWZpZWQnLFxuICBcbiAgICBQUkVGSVhfVEFHID0gJzwnLFxuICAgIFBSRUZJWF9JUyA9ICc9JyxcbiAgXG4gICAgLy8gdmFsaWQgYW5kIGludmFsaWQgbm9kZSBuYW1lc1xuICAgIHZhbGlkTmFtZSA9IC9eW0EtWl1bQS1aMC05XSooPzotW0EtWjAtOV0rKSskLyxcbiAgICBpbnZhbGlkTmFtZXMgPSBbXG4gICAgICAnQU5OT1RBVElPTi1YTUwnLFxuICAgICAgJ0NPTE9SLVBST0ZJTEUnLFxuICAgICAgJ0ZPTlQtRkFDRScsXG4gICAgICAnRk9OVC1GQUNFLVNSQycsXG4gICAgICAnRk9OVC1GQUNFLVVSSScsXG4gICAgICAnRk9OVC1GQUNFLUZPUk1BVCcsXG4gICAgICAnRk9OVC1GQUNFLU5BTUUnLFxuICAgICAgJ01JU1NJTkctR0xZUEgnXG4gICAgXSxcbiAgXG4gICAgLy8gcmVnaXN0ZXJlZCB0eXBlcyBhbmQgdGhlaXIgcHJvdG90eXBlc1xuICAgIHR5cGVzID0gW10sXG4gICAgcHJvdG9zID0gW10sXG4gIFxuICAgIC8vIHRvIHF1ZXJ5IHN1Ym5vZGVzXG4gICAgcXVlcnkgPSAnJyxcbiAgXG4gICAgLy8gaHRtbCBzaG9ydGN1dCB1c2VkIHRvIGZlYXR1cmUgZGV0ZWN0XG4gICAgZG9jdW1lbnRFbGVtZW50ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LFxuICBcbiAgICAvLyBFUzUgaW5saW5lIGhlbHBlcnMgfHwgYmFzaWMgcGF0Y2hlc1xuICAgIGluZGV4T2YgPSB0eXBlcy5pbmRleE9mIHx8IGZ1bmN0aW9uICh2KSB7XG4gICAgICBmb3IodmFyIGkgPSB0aGlzLmxlbmd0aDsgaS0tICYmIHRoaXNbaV0gIT09IHY7KXt9XG4gICAgICByZXR1cm4gaTtcbiAgICB9LFxuICBcbiAgICAvLyBvdGhlciBoZWxwZXJzIC8gc2hvcnRjdXRzXG4gICAgT1AgPSBPYmplY3QucHJvdG90eXBlLFxuICAgIGhPUCA9IE9QLmhhc093blByb3BlcnR5LFxuICAgIGlQTyA9IE9QLmlzUHJvdG90eXBlT2YsXG4gIFxuICAgIGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5LFxuICAgIGVtcHR5ID0gW10sXG4gICAgZ09QRCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsXG4gICAgZ09QTiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzLFxuICAgIGdQTyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZixcbiAgICBzUE8gPSBPYmplY3Quc2V0UHJvdG90eXBlT2YsXG4gIFxuICAgIC8vIGpzaGludCBwcm90bzogdHJ1ZVxuICAgIGhhc1Byb3RvID0gISFPYmplY3QuX19wcm90b19fLFxuICBcbiAgICAvLyBWMSBoZWxwZXJzXG4gICAgZml4R2V0Q2xhc3MgPSBmYWxzZSxcbiAgICBEUkVDRVYxID0gJ19fZHJlQ0V2MScsXG4gICAgY3VzdG9tRWxlbWVudHMgPSB3aW5kb3cuY3VzdG9tRWxlbWVudHMsXG4gICAgdXNhYmxlQ3VzdG9tRWxlbWVudHMgPSBwb2x5ZmlsbCAhPT0gJ2ZvcmNlJyAmJiAhIShcbiAgICAgIGN1c3RvbUVsZW1lbnRzICYmXG4gICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUgJiZcbiAgICAgIGN1c3RvbUVsZW1lbnRzLmdldCAmJlxuICAgICAgY3VzdG9tRWxlbWVudHMud2hlbkRlZmluZWRcbiAgICApLFxuICAgIERpY3QgPSBPYmplY3QuY3JlYXRlIHx8IE9iamVjdCxcbiAgICBNYXAgPSB3aW5kb3cuTWFwIHx8IGZ1bmN0aW9uIE1hcCgpIHtcbiAgICAgIHZhciBLID0gW10sIFYgPSBbXSwgaTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKGspIHtcbiAgICAgICAgICByZXR1cm4gVltpbmRleE9mLmNhbGwoSywgayldO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChrLCB2KSB7XG4gICAgICAgICAgaSA9IGluZGV4T2YuY2FsbChLLCBrKTtcbiAgICAgICAgICBpZiAoaSA8IDApIFZbSy5wdXNoKGspIC0gMV0gPSB2O1xuICAgICAgICAgIGVsc2UgVltpXSA9IHY7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSxcbiAgICBQcm9taXNlID0gd2luZG93LlByb21pc2UgfHwgZnVuY3Rpb24gKGZuKSB7XG4gICAgICB2YXJcbiAgICAgICAgbm90aWZ5ID0gW10sXG4gICAgICAgIGRvbmUgPSBmYWxzZSxcbiAgICAgICAgcCA9IHtcbiAgICAgICAgICAnY2F0Y2gnOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcDtcbiAgICAgICAgICB9LFxuICAgICAgICAgICd0aGVuJzogZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgICAgICBub3RpZnkucHVzaChjYik7XG4gICAgICAgICAgICBpZiAoZG9uZSkgc2V0VGltZW91dChyZXNvbHZlLCAxKTtcbiAgICAgICAgICAgIHJldHVybiBwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgO1xuICAgICAgZnVuY3Rpb24gcmVzb2x2ZSh2YWx1ZSkge1xuICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgd2hpbGUgKG5vdGlmeS5sZW5ndGgpIG5vdGlmeS5zaGlmdCgpKHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIGZuKHJlc29sdmUpO1xuICAgICAgcmV0dXJuIHA7XG4gICAgfSxcbiAgICBqdXN0Q3JlYXRlZCA9IGZhbHNlLFxuICAgIGNvbnN0cnVjdG9ycyA9IERpY3QobnVsbCksXG4gICAgd2FpdGluZ0xpc3QgPSBEaWN0KG51bGwpLFxuICAgIG5vZGVOYW1lcyA9IG5ldyBNYXAoKSxcbiAgICBzZWNvbmRBcmd1bWVudCA9IGZ1bmN0aW9uIChpcykge1xuICAgICAgcmV0dXJuIGlzLnRvTG93ZXJDYXNlKCk7XG4gICAgfSxcbiAgXG4gICAgLy8gdXNlZCB0byBjcmVhdGUgdW5pcXVlIGluc3RhbmNlc1xuICAgIGNyZWF0ZSA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gQnJpZGdlKHByb3RvKSB7XG4gICAgICAvLyBzaWxseSBicm9rZW4gcG9seWZpbGwgcHJvYmFibHkgZXZlciB1c2VkIGJ1dCBzaG9ydCBlbm91Z2ggdG8gd29ya1xuICAgICAgcmV0dXJuIHByb3RvID8gKChCcmlkZ2UucHJvdG90eXBlID0gcHJvdG8pLCBuZXcgQnJpZGdlKCkpIDogdGhpcztcbiAgICB9LFxuICBcbiAgICAvLyB3aWxsIHNldCB0aGUgcHJvdG90eXBlIGlmIHBvc3NpYmxlXG4gICAgLy8gb3IgY29weSBvdmVyIGFsbCBwcm9wZXJ0aWVzXG4gICAgc2V0UHJvdG90eXBlID0gc1BPIHx8IChcbiAgICAgIGhhc1Byb3RvID9cbiAgICAgICAgZnVuY3Rpb24gKG8sIHApIHtcbiAgICAgICAgICBvLl9fcHJvdG9fXyA9IHA7XG4gICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgIH0gOiAoXG4gICAgICAoZ09QTiAmJiBnT1BEKSA/XG4gICAgICAgIChmdW5jdGlvbigpe1xuICAgICAgICAgIGZ1bmN0aW9uIHNldFByb3BlcnRpZXMobywgcCkge1xuICAgICAgICAgICAgZm9yICh2YXJcbiAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICBuYW1lcyA9IGdPUE4ocCksXG4gICAgICAgICAgICAgIGkgPSAwLCBsZW5ndGggPSBuYW1lcy5sZW5ndGg7XG4gICAgICAgICAgICAgIGkgPCBsZW5ndGg7IGkrK1xuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgIGtleSA9IG5hbWVzW2ldO1xuICAgICAgICAgICAgICBpZiAoIWhPUC5jYWxsKG8sIGtleSkpIHtcbiAgICAgICAgICAgICAgICBkZWZpbmVQcm9wZXJ0eShvLCBrZXksIGdPUEQocCwga2V5KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChvLCBwKSB7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgIHNldFByb3BlcnRpZXMobywgcCk7XG4gICAgICAgICAgICB9IHdoaWxlICgocCA9IGdQTyhwKSkgJiYgIWlQTy5jYWxsKHAsIG8pKTtcbiAgICAgICAgICAgIHJldHVybiBvO1xuICAgICAgICAgIH07XG4gICAgICAgIH0oKSkgOlxuICAgICAgICBmdW5jdGlvbiAobywgcCkge1xuICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwKSB7XG4gICAgICAgICAgICBvW2tleV0gPSBwW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBvO1xuICAgICAgICB9XG4gICAgKSksXG4gIFxuICAgIC8vIERPTSBzaG9ydGN1dHMgYW5kIGhlbHBlcnMsIGlmIGFueVxuICBcbiAgICBNdXRhdGlvbk9ic2VydmVyID0gd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LldlYktpdE11dGF0aW9uT2JzZXJ2ZXIsXG4gIFxuICAgIEhUTUxFbGVtZW50UHJvdG90eXBlID0gKFxuICAgICAgd2luZG93LkhUTUxFbGVtZW50IHx8XG4gICAgICB3aW5kb3cuRWxlbWVudCB8fFxuICAgICAgd2luZG93Lk5vZGVcbiAgICApLnByb3RvdHlwZSxcbiAgXG4gICAgSUU4ID0gIWlQTy5jYWxsKEhUTUxFbGVtZW50UHJvdG90eXBlLCBkb2N1bWVudEVsZW1lbnQpLFxuICBcbiAgICBzYWZlUHJvcGVydHkgPSBJRTggPyBmdW5jdGlvbiAobywgaywgZCkge1xuICAgICAgb1trXSA9IGQudmFsdWU7XG4gICAgICByZXR1cm4gbztcbiAgICB9IDogZGVmaW5lUHJvcGVydHksXG4gIFxuICAgIGlzVmFsaWROb2RlID0gSUU4ID9cbiAgICAgIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHJldHVybiBub2RlLm5vZGVUeXBlID09PSAxO1xuICAgICAgfSA6XG4gICAgICBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICByZXR1cm4gaVBPLmNhbGwoSFRNTEVsZW1lbnRQcm90b3R5cGUsIG5vZGUpO1xuICAgICAgfSxcbiAgXG4gICAgdGFyZ2V0cyA9IElFOCAmJiBbXSxcbiAgXG4gICAgYXR0YWNoU2hhZG93ID0gSFRNTEVsZW1lbnRQcm90b3R5cGUuYXR0YWNoU2hhZG93LFxuICAgIGNsb25lTm9kZSA9IEhUTUxFbGVtZW50UHJvdG90eXBlLmNsb25lTm9kZSxcbiAgICBkaXNwYXRjaEV2ZW50ID0gSFRNTEVsZW1lbnRQcm90b3R5cGUuZGlzcGF0Y2hFdmVudCxcbiAgICBnZXRBdHRyaWJ1dGUgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5nZXRBdHRyaWJ1dGUsXG4gICAgaGFzQXR0cmlidXRlID0gSFRNTEVsZW1lbnRQcm90b3R5cGUuaGFzQXR0cmlidXRlLFxuICAgIHJlbW92ZUF0dHJpYnV0ZSA9IEhUTUxFbGVtZW50UHJvdG90eXBlLnJlbW92ZUF0dHJpYnV0ZSxcbiAgICBzZXRBdHRyaWJ1dGUgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5zZXRBdHRyaWJ1dGUsXG4gIFxuICAgIC8vIHJlcGxhY2VkIGxhdGVyIG9uXG4gICAgY3JlYXRlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQsXG4gICAgcGF0Y2hlZENyZWF0ZUVsZW1lbnQgPSBjcmVhdGVFbGVtZW50LFxuICBcbiAgICAvLyBzaGFyZWQgb2JzZXJ2ZXIgZm9yIGFsbCBhdHRyaWJ1dGVzXG4gICAgYXR0cmlidXRlc09ic2VydmVyID0gTXV0YXRpb25PYnNlcnZlciAmJiB7XG4gICAgICBhdHRyaWJ1dGVzOiB0cnVlLFxuICAgICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSxcbiAgICAgIGF0dHJpYnV0ZU9sZFZhbHVlOiB0cnVlXG4gICAgfSxcbiAgXG4gICAgLy8gdXNlZnVsIHRvIGRldGVjdCBvbmx5IGlmIHRoZXJlJ3Mgbm8gTXV0YXRpb25PYnNlcnZlclxuICAgIERPTUF0dHJNb2RpZmllZCA9IE11dGF0aW9uT2JzZXJ2ZXIgfHwgZnVuY3Rpb24oZSkge1xuICAgICAgZG9lc05vdFN1cHBvcnRET01BdHRyTW9kaWZpZWQgPSBmYWxzZTtcbiAgICAgIGRvY3VtZW50RWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgICBET01fQVRUUl9NT0RJRklFRCxcbiAgICAgICAgRE9NQXR0ck1vZGlmaWVkXG4gICAgICApO1xuICAgIH0sXG4gIFxuICAgIC8vIHdpbGwgYm90aCBiZSB1c2VkIHRvIG1ha2UgRE9NTm9kZUluc2VydGVkIGFzeW5jaHJvbm91c1xuICAgIGFzYXBRdWV1ZSxcbiAgICBhc2FwVGltZXIgPSAwLFxuICBcbiAgICAvLyBpbnRlcm5hbCBmbGFnc1xuICAgIFYwID0gUkVHSVNURVJfRUxFTUVOVCBpbiBkb2N1bWVudCxcbiAgICBzZXRMaXN0ZW5lciA9IHRydWUsXG4gICAganVzdFNldHVwID0gZmFsc2UsXG4gICAgZG9lc05vdFN1cHBvcnRET01BdHRyTW9kaWZpZWQgPSB0cnVlLFxuICAgIGRyb3BEb21Db250ZW50TG9hZGVkID0gdHJ1ZSxcbiAgXG4gICAgLy8gbmVlZGVkIGZvciB0aGUgaW5uZXJIVE1MIGhlbHBlclxuICAgIG5vdEZyb21Jbm5lckhUTUxIZWxwZXIgPSB0cnVlLFxuICBcbiAgICAvLyBvcHRpb25hbGx5IGRlZmluZWQgbGF0ZXIgb25cbiAgICBvblN1YnRyZWVNb2RpZmllZCxcbiAgICBjYWxsRE9NQXR0ck1vZGlmaWVkLFxuICAgIGdldEF0dHJpYnV0ZXNNaXJyb3IsXG4gICAgb2JzZXJ2ZXIsXG4gICAgb2JzZXJ2ZSxcbiAgXG4gICAgLy8gYmFzZWQgb24gc2V0dGluZyBwcm90b3R5cGUgY2FwYWJpbGl0eVxuICAgIC8vIHdpbGwgY2hlY2sgcHJvdG8gb3IgdGhlIGV4cGFuZG8gYXR0cmlidXRlXG4gICAgLy8gaW4gb3JkZXIgdG8gc2V0dXAgdGhlIG5vZGUgb25jZVxuICAgIHBhdGNoSWZOb3RBbHJlYWR5LFxuICAgIHBhdGNoXG4gIDtcbiAgXG4gIC8vIG9ubHkgaWYgbmVlZGVkXG4gIGlmICghVjApIHtcbiAgXG4gICAgaWYgKHNQTyB8fCBoYXNQcm90bykge1xuICAgICAgICBwYXRjaElmTm90QWxyZWFkeSA9IGZ1bmN0aW9uIChub2RlLCBwcm90bykge1xuICAgICAgICAgIGlmICghaVBPLmNhbGwocHJvdG8sIG5vZGUpKSB7XG4gICAgICAgICAgICBzZXR1cE5vZGUobm9kZSwgcHJvdG8pO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcGF0Y2ggPSBzZXR1cE5vZGU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcGF0Y2hJZk5vdEFscmVhZHkgPSBmdW5jdGlvbiAobm9kZSwgcHJvdG8pIHtcbiAgICAgICAgICBpZiAoIW5vZGVbRVhQQU5ET19VSURdKSB7XG4gICAgICAgICAgICBub2RlW0VYUEFORE9fVUlEXSA9IE9iamVjdCh0cnVlKTtcbiAgICAgICAgICAgIHNldHVwTm9kZShub2RlLCBwcm90byk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBwYXRjaCA9IHBhdGNoSWZOb3RBbHJlYWR5O1xuICAgIH1cbiAgXG4gICAgaWYgKElFOCkge1xuICAgICAgZG9lc05vdFN1cHBvcnRET01BdHRyTW9kaWZpZWQgPSBmYWxzZTtcbiAgICAgIChmdW5jdGlvbiAoKXtcbiAgICAgICAgdmFyXG4gICAgICAgICAgZGVzY3JpcHRvciA9IGdPUEQoSFRNTEVsZW1lbnRQcm90b3R5cGUsIEFERF9FVkVOVF9MSVNURU5FUiksXG4gICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lciA9IGRlc2NyaXB0b3IudmFsdWUsXG4gICAgICAgICAgcGF0Y2hlZFJlbW92ZUF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICB2YXIgZSA9IG5ldyBDdXN0b21FdmVudChET01fQVRUUl9NT0RJRklFRCwge2J1YmJsZXM6IHRydWV9KTtcbiAgICAgICAgICAgIGUuYXR0ck5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgZS5wcmV2VmFsdWUgPSBnZXRBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuYW1lKTtcbiAgICAgICAgICAgIGUubmV3VmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgZVtSRU1PVkFMXSA9IGUuYXR0ckNoYW5nZSA9IDI7XG4gICAgICAgICAgICByZW1vdmVBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuYW1lKTtcbiAgICAgICAgICAgIGRpc3BhdGNoRXZlbnQuY2FsbCh0aGlzLCBlKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBhdGNoZWRTZXRBdHRyaWJ1dGUgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgICAgIHZhclxuICAgICAgICAgICAgICBoYWQgPSBoYXNBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuYW1lKSxcbiAgICAgICAgICAgICAgb2xkID0gaGFkICYmIGdldEF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUpLFxuICAgICAgICAgICAgICBlID0gbmV3IEN1c3RvbUV2ZW50KERPTV9BVFRSX01PRElGSUVELCB7YnViYmxlczogdHJ1ZX0pXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICBzZXRBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICBlLmF0dHJOYW1lID0gbmFtZTtcbiAgICAgICAgICAgIGUucHJldlZhbHVlID0gaGFkID8gb2xkIDogbnVsbDtcbiAgICAgICAgICAgIGUubmV3VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChoYWQpIHtcbiAgICAgICAgICAgICAgZVtNT0RJRklDQVRJT05dID0gZS5hdHRyQ2hhbmdlID0gMTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGVbQURESVRJT05dID0gZS5hdHRyQ2hhbmdlID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRpc3BhdGNoRXZlbnQuY2FsbCh0aGlzLCBlKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uUHJvcGVydHlDaGFuZ2UgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgLy8ganNoaW50IGVxbnVsbDp0cnVlXG4gICAgICAgICAgICB2YXJcbiAgICAgICAgICAgICAgbm9kZSA9IGUuY3VycmVudFRhcmdldCxcbiAgICAgICAgICAgICAgc3VwZXJTZWNyZXQgPSBub2RlW0VYUEFORE9fVUlEXSxcbiAgICAgICAgICAgICAgcHJvcGVydHlOYW1lID0gZS5wcm9wZXJ0eU5hbWUsXG4gICAgICAgICAgICAgIGV2ZW50XG4gICAgICAgICAgICA7XG4gICAgICAgICAgICBpZiAoc3VwZXJTZWNyZXQuaGFzT3duUHJvcGVydHkocHJvcGVydHlOYW1lKSkge1xuICAgICAgICAgICAgICBzdXBlclNlY3JldCA9IHN1cGVyU2VjcmV0W3Byb3BlcnR5TmFtZV07XG4gICAgICAgICAgICAgIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KERPTV9BVFRSX01PRElGSUVELCB7YnViYmxlczogdHJ1ZX0pO1xuICAgICAgICAgICAgICBldmVudC5hdHRyTmFtZSA9IHN1cGVyU2VjcmV0Lm5hbWU7XG4gICAgICAgICAgICAgIGV2ZW50LnByZXZWYWx1ZSA9IHN1cGVyU2VjcmV0LnZhbHVlIHx8IG51bGw7XG4gICAgICAgICAgICAgIGV2ZW50Lm5ld1ZhbHVlID0gKHN1cGVyU2VjcmV0LnZhbHVlID0gbm9kZVtwcm9wZXJ0eU5hbWVdIHx8IG51bGwpO1xuICAgICAgICAgICAgICBpZiAoZXZlbnQucHJldlZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBldmVudFtBRERJVElPTl0gPSBldmVudC5hdHRyQ2hhbmdlID0gMDtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBldmVudFtNT0RJRklDQVRJT05dID0gZXZlbnQuYXR0ckNoYW5nZSA9IDE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZGlzcGF0Y2hFdmVudC5jYWxsKG5vZGUsIGV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIDtcbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uICh0eXBlLCBoYW5kbGVyLCBjYXB0dXJlKSB7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgdHlwZSA9PT0gRE9NX0FUVFJfTU9ESUZJRUQgJiZcbiAgICAgICAgICAgIHRoaXNbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdICYmXG4gICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZSAhPT0gcGF0Y2hlZFNldEF0dHJpYnV0ZVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgdGhpc1tFWFBBTkRPX1VJRF0gPSB7XG4gICAgICAgICAgICAgIGNsYXNzTmFtZToge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdjbGFzcycsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuY2xhc3NOYW1lXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZSA9IHBhdGNoZWRTZXRBdHRyaWJ1dGU7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZSA9IHBhdGNoZWRSZW1vdmVBdHRyaWJ1dGU7XG4gICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyLmNhbGwodGhpcywgJ3Byb3BlcnR5Y2hhbmdlJywgb25Qcm9wZXJ0eUNoYW5nZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCB0eXBlLCBoYW5kbGVyLCBjYXB0dXJlKTtcbiAgICAgICAgfTtcbiAgICAgICAgZGVmaW5lUHJvcGVydHkoSFRNTEVsZW1lbnRQcm90b3R5cGUsIEFERF9FVkVOVF9MSVNURU5FUiwgZGVzY3JpcHRvcik7XG4gICAgICB9KCkpO1xuICAgIH0gZWxzZSBpZiAoIU11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAgIGRvY3VtZW50RWxlbWVudFtBRERfRVZFTlRfTElTVEVORVJdKERPTV9BVFRSX01PRElGSUVELCBET01BdHRyTW9kaWZpZWQpO1xuICAgICAgZG9jdW1lbnRFbGVtZW50LnNldEF0dHJpYnV0ZShFWFBBTkRPX1VJRCwgMSk7XG4gICAgICBkb2N1bWVudEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKEVYUEFORE9fVUlEKTtcbiAgICAgIGlmIChkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCkge1xuICAgICAgICBvblN1YnRyZWVNb2RpZmllZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdmFyXG4gICAgICAgICAgICBub2RlID0gdGhpcyxcbiAgICAgICAgICAgIG9sZEF0dHJpYnV0ZXMsXG4gICAgICAgICAgICBuZXdBdHRyaWJ1dGVzLFxuICAgICAgICAgICAga2V5XG4gICAgICAgICAgO1xuICAgICAgICAgIGlmIChub2RlID09PSBlLnRhcmdldCkge1xuICAgICAgICAgICAgb2xkQXR0cmlidXRlcyA9IG5vZGVbRVhQQU5ET19VSURdO1xuICAgICAgICAgICAgbm9kZVtFWFBBTkRPX1VJRF0gPSAobmV3QXR0cmlidXRlcyA9IGdldEF0dHJpYnV0ZXNNaXJyb3Iobm9kZSkpO1xuICAgICAgICAgICAgZm9yIChrZXkgaW4gbmV3QXR0cmlidXRlcykge1xuICAgICAgICAgICAgICBpZiAoIShrZXkgaW4gb2xkQXR0cmlidXRlcykpIHtcbiAgICAgICAgICAgICAgICAvLyBhdHRyaWJ1dGUgd2FzIGFkZGVkXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxET01BdHRyTW9kaWZpZWQoXG4gICAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgIG9sZEF0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIG5ld0F0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIEFERElUSU9OXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChuZXdBdHRyaWJ1dGVzW2tleV0gIT09IG9sZEF0dHJpYnV0ZXNba2V5XSkge1xuICAgICAgICAgICAgICAgIC8vIGF0dHJpYnV0ZSB3YXMgY2hhbmdlZFxuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsRE9NQXR0ck1vZGlmaWVkKFxuICAgICAgICAgICAgICAgICAgMSxcbiAgICAgICAgICAgICAgICAgIG5vZGUsXG4gICAgICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgICAgICBvbGRBdHRyaWJ1dGVzW2tleV0sXG4gICAgICAgICAgICAgICAgICBuZXdBdHRyaWJ1dGVzW2tleV0sXG4gICAgICAgICAgICAgICAgICBNT0RJRklDQVRJT05cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjaGVja2luZyBpZiBpdCBoYXMgYmVlbiByZW1vdmVkXG4gICAgICAgICAgICBmb3IgKGtleSBpbiBvbGRBdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgIGlmICghKGtleSBpbiBuZXdBdHRyaWJ1dGVzKSkge1xuICAgICAgICAgICAgICAgIC8vIGF0dHJpYnV0ZSByZW1vdmVkXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxET01BdHRyTW9kaWZpZWQoXG4gICAgICAgICAgICAgICAgICAyLFxuICAgICAgICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgIG9sZEF0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIG5ld0F0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIFJFTU9WQUxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjYWxsRE9NQXR0ck1vZGlmaWVkID0gZnVuY3Rpb24gKFxuICAgICAgICAgIGF0dHJDaGFuZ2UsXG4gICAgICAgICAgY3VycmVudFRhcmdldCxcbiAgICAgICAgICBhdHRyTmFtZSxcbiAgICAgICAgICBwcmV2VmFsdWUsXG4gICAgICAgICAgbmV3VmFsdWUsXG4gICAgICAgICAgYWN0aW9uXG4gICAgICAgICkge1xuICAgICAgICAgIHZhciBlID0ge1xuICAgICAgICAgICAgYXR0ckNoYW5nZTogYXR0ckNoYW5nZSxcbiAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQ6IGN1cnJlbnRUYXJnZXQsXG4gICAgICAgICAgICBhdHRyTmFtZTogYXR0ck5hbWUsXG4gICAgICAgICAgICBwcmV2VmFsdWU6IHByZXZWYWx1ZSxcbiAgICAgICAgICAgIG5ld1ZhbHVlOiBuZXdWYWx1ZVxuICAgICAgICAgIH07XG4gICAgICAgICAgZVthY3Rpb25dID0gYXR0ckNoYW5nZTtcbiAgICAgICAgICBvbkRPTUF0dHJNb2RpZmllZChlKTtcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0QXR0cmlidXRlc01pcnJvciA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgZm9yICh2YXJcbiAgICAgICAgICAgIGF0dHIsIG5hbWUsXG4gICAgICAgICAgICByZXN1bHQgPSB7fSxcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSBub2RlLmF0dHJpYnV0ZXMsXG4gICAgICAgICAgICBpID0gMCwgbGVuZ3RoID0gYXR0cmlidXRlcy5sZW5ndGg7XG4gICAgICAgICAgICBpIDwgbGVuZ3RoOyBpKytcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIGF0dHIgPSBhdHRyaWJ1dGVzW2ldO1xuICAgICAgICAgICAgbmFtZSA9IGF0dHIubmFtZTtcbiAgICAgICAgICAgIGlmIChuYW1lICE9PSAnc2V0QXR0cmlidXRlJykge1xuICAgICAgICAgICAgICByZXN1bHRbbmFtZV0gPSBhdHRyLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgXG4gICAgLy8gc2V0IGFzIGVudW1lcmFibGUsIHdyaXRhYmxlIGFuZCBjb25maWd1cmFibGVcbiAgICBkb2N1bWVudFtSRUdJU1RFUl9FTEVNRU5UXSA9IGZ1bmN0aW9uIHJlZ2lzdGVyRWxlbWVudCh0eXBlLCBvcHRpb25zKSB7XG4gICAgICB1cHBlclR5cGUgPSB0eXBlLnRvVXBwZXJDYXNlKCk7XG4gICAgICBpZiAoc2V0TGlzdGVuZXIpIHtcbiAgICAgICAgLy8gb25seSBmaXJzdCB0aW1lIGRvY3VtZW50LnJlZ2lzdGVyRWxlbWVudCBpcyB1c2VkXG4gICAgICAgIC8vIHdlIG5lZWQgdG8gc2V0IHRoaXMgbGlzdGVuZXJcbiAgICAgICAgLy8gc2V0dGluZyBpdCBieSBkZWZhdWx0IG1pZ2h0IHNsb3cgZG93biBmb3Igbm8gcmVhc29uXG4gICAgICAgIHNldExpc3RlbmVyID0gZmFsc2U7XG4gICAgICAgIGlmIChNdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgICAgICAgb2JzZXJ2ZXIgPSAoZnVuY3Rpb24oYXR0YWNoZWQsIGRldGFjaGVkKXtcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrRW1BbGwobGlzdCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGxpc3QubGVuZ3RoOyBpIDwgbGVuZ3RoOyBjYWxsYmFjayhsaXN0W2krK10pKXt9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKHJlY29yZHMpIHtcbiAgICAgICAgICAgICAgZm9yICh2YXJcbiAgICAgICAgICAgICAgICBjdXJyZW50LCBub2RlLCBuZXdWYWx1ZSxcbiAgICAgICAgICAgICAgICBpID0gMCwgbGVuZ3RoID0gcmVjb3Jkcy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrK1xuICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50ID0gcmVjb3Jkc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudC50eXBlID09PSAnY2hpbGRMaXN0Jykge1xuICAgICAgICAgICAgICAgICAgY2hlY2tFbUFsbChjdXJyZW50LmFkZGVkTm9kZXMsIGF0dGFjaGVkKTtcbiAgICAgICAgICAgICAgICAgIGNoZWNrRW1BbGwoY3VycmVudC5yZW1vdmVkTm9kZXMsIGRldGFjaGVkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgbm9kZSA9IGN1cnJlbnQudGFyZ2V0O1xuICAgICAgICAgICAgICAgICAgaWYgKG5vdEZyb21Jbm5lckhUTUxIZWxwZXIgJiZcbiAgICAgICAgICAgICAgICAgICAgICBub2RlW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXSAmJlxuICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQuYXR0cmlidXRlTmFtZSAhPT0gJ3N0eWxlJykge1xuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IGdldEF0dHJpYnV0ZS5jYWxsKG5vZGUsIGN1cnJlbnQuYXR0cmlidXRlTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gY3VycmVudC5vbGRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgIG5vZGVbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdKFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5hdHRyaWJ1dGVOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5vbGRWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfShleGVjdXRlQWN0aW9uKEFUVEFDSEVEKSwgZXhlY3V0ZUFjdGlvbihERVRBQ0hFRCkpKTtcbiAgICAgICAgICBvYnNlcnZlID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUoXG4gICAgICAgICAgICAgIG5vZGUsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgc3VidHJlZTogdHJ1ZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgICAgfTtcbiAgICAgICAgICBvYnNlcnZlKGRvY3VtZW50KTtcbiAgICAgICAgICBpZiAoYXR0YWNoU2hhZG93KSB7XG4gICAgICAgICAgICBIVE1MRWxlbWVudFByb3RvdHlwZS5hdHRhY2hTaGFkb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBvYnNlcnZlKGF0dGFjaFNoYWRvdy5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFzYXBRdWV1ZSA9IFtdO1xuICAgICAgICAgIGRvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oJ0RPTU5vZGVJbnNlcnRlZCcsIG9uRE9NTm9kZShBVFRBQ0hFRCkpO1xuICAgICAgICAgIGRvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oJ0RPTU5vZGVSZW1vdmVkJywgb25ET01Ob2RlKERFVEFDSEVEKSk7XG4gICAgICAgIH1cbiAgXG4gICAgICAgIGRvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oRE9NX0NPTlRFTlRfTE9BREVELCBvblJlYWR5U3RhdGVDaGFuZ2UpO1xuICAgICAgICBkb2N1bWVudFtBRERfRVZFTlRfTElTVEVORVJdKCdyZWFkeXN0YXRlY2hhbmdlJywgb25SZWFkeVN0YXRlQ2hhbmdlKTtcbiAgXG4gICAgICAgIEhUTUxFbGVtZW50UHJvdG90eXBlLmNsb25lTm9kZSA9IGZ1bmN0aW9uIChkZWVwKSB7XG4gICAgICAgICAgdmFyXG4gICAgICAgICAgICBub2RlID0gY2xvbmVOb2RlLmNhbGwodGhpcywgISFkZWVwKSxcbiAgICAgICAgICAgIGkgPSBnZXRUeXBlSW5kZXgobm9kZSlcbiAgICAgICAgICA7XG4gICAgICAgICAgaWYgKC0xIDwgaSkgcGF0Y2gobm9kZSwgcHJvdG9zW2ldKTtcbiAgICAgICAgICBpZiAoZGVlcCAmJiBxdWVyeS5sZW5ndGgpIGxvb3BBbmRTZXR1cChub2RlLnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpKTtcbiAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgXG4gICAgICBpZiAoanVzdFNldHVwKSByZXR1cm4gKGp1c3RTZXR1cCA9IGZhbHNlKTtcbiAgXG4gICAgICBpZiAoLTIgPCAoXG4gICAgICAgIGluZGV4T2YuY2FsbCh0eXBlcywgUFJFRklYX0lTICsgdXBwZXJUeXBlKSArXG4gICAgICAgIGluZGV4T2YuY2FsbCh0eXBlcywgUFJFRklYX1RBRyArIHVwcGVyVHlwZSlcbiAgICAgICkpIHtcbiAgICAgICAgdGhyb3dUeXBlRXJyb3IodHlwZSk7XG4gICAgICB9XG4gIFxuICAgICAgaWYgKCF2YWxpZE5hbWUudGVzdCh1cHBlclR5cGUpIHx8IC0xIDwgaW5kZXhPZi5jYWxsKGludmFsaWROYW1lcywgdXBwZXJUeXBlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSB0eXBlICcgKyB0eXBlICsgJyBpcyBpbnZhbGlkJyk7XG4gICAgICB9XG4gIFxuICAgICAgdmFyXG4gICAgICAgIGNvbnN0cnVjdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBleHRlbmRpbmcgP1xuICAgICAgICAgICAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudChub2RlTmFtZSwgdXBwZXJUeXBlKSA6XG4gICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGVOYW1lKTtcbiAgICAgICAgfSxcbiAgICAgICAgb3B0ID0gb3B0aW9ucyB8fCBPUCxcbiAgICAgICAgZXh0ZW5kaW5nID0gaE9QLmNhbGwob3B0LCBFWFRFTkRTKSxcbiAgICAgICAgbm9kZU5hbWUgPSBleHRlbmRpbmcgPyBvcHRpb25zW0VYVEVORFNdLnRvVXBwZXJDYXNlKCkgOiB1cHBlclR5cGUsXG4gICAgICAgIHVwcGVyVHlwZSxcbiAgICAgICAgaVxuICAgICAgO1xuICBcbiAgICAgIGlmIChleHRlbmRpbmcgJiYgLTEgPCAoXG4gICAgICAgIGluZGV4T2YuY2FsbCh0eXBlcywgUFJFRklYX1RBRyArIG5vZGVOYW1lKVxuICAgICAgKSkge1xuICAgICAgICB0aHJvd1R5cGVFcnJvcihub2RlTmFtZSk7XG4gICAgICB9XG4gIFxuICAgICAgaSA9IHR5cGVzLnB1c2goKGV4dGVuZGluZyA/IFBSRUZJWF9JUyA6IFBSRUZJWF9UQUcpICsgdXBwZXJUeXBlKSAtIDE7XG4gIFxuICAgICAgcXVlcnkgPSBxdWVyeS5jb25jYXQoXG4gICAgICAgIHF1ZXJ5Lmxlbmd0aCA/ICcsJyA6ICcnLFxuICAgICAgICBleHRlbmRpbmcgPyBub2RlTmFtZSArICdbaXM9XCInICsgdHlwZS50b0xvd2VyQ2FzZSgpICsgJ1wiXScgOiBub2RlTmFtZVxuICAgICAgKTtcbiAgXG4gICAgICBjb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSAoXG4gICAgICAgIHByb3Rvc1tpXSA9IGhPUC5jYWxsKG9wdCwgJ3Byb3RvdHlwZScpID9cbiAgICAgICAgICBvcHQucHJvdG90eXBlIDpcbiAgICAgICAgICBjcmVhdGUoSFRNTEVsZW1lbnRQcm90b3R5cGUpXG4gICAgICApO1xuICBcbiAgICAgIGlmIChxdWVyeS5sZW5ndGgpIGxvb3BBbmRWZXJpZnkoXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpLFxuICAgICAgICBBVFRBQ0hFRFxuICAgICAgKTtcbiAgXG4gICAgICByZXR1cm4gY29uc3RydWN0b3I7XG4gICAgfTtcbiAgXG4gICAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCA9IChwYXRjaGVkQ3JlYXRlRWxlbWVudCA9IGZ1bmN0aW9uIChsb2NhbE5hbWUsIHR5cGVFeHRlbnNpb24pIHtcbiAgICAgIHZhclxuICAgICAgICBpcyA9IGdldElzKHR5cGVFeHRlbnNpb24pLFxuICAgICAgICBub2RlID0gaXMgP1xuICAgICAgICAgIGNyZWF0ZUVsZW1lbnQuY2FsbChkb2N1bWVudCwgbG9jYWxOYW1lLCBzZWNvbmRBcmd1bWVudChpcykpIDpcbiAgICAgICAgICBjcmVhdGVFbGVtZW50LmNhbGwoZG9jdW1lbnQsIGxvY2FsTmFtZSksXG4gICAgICAgIG5hbWUgPSAnJyArIGxvY2FsTmFtZSxcbiAgICAgICAgaSA9IGluZGV4T2YuY2FsbChcbiAgICAgICAgICB0eXBlcyxcbiAgICAgICAgICAoaXMgPyBQUkVGSVhfSVMgOiBQUkVGSVhfVEFHKSArXG4gICAgICAgICAgKGlzIHx8IG5hbWUpLnRvVXBwZXJDYXNlKClcbiAgICAgICAgKSxcbiAgICAgICAgc2V0dXAgPSAtMSA8IGlcbiAgICAgIDtcbiAgICAgIGlmIChpcykge1xuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSgnaXMnLCBpcyA9IGlzLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICBpZiAoc2V0dXApIHtcbiAgICAgICAgICBzZXR1cCA9IGlzSW5RU0EobmFtZS50b1VwcGVyQ2FzZSgpLCBpcyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIG5vdEZyb21Jbm5lckhUTUxIZWxwZXIgPSAhZG9jdW1lbnQuY3JlYXRlRWxlbWVudC5pbm5lckhUTUxIZWxwZXI7XG4gICAgICBpZiAoc2V0dXApIHBhdGNoKG5vZGUsIHByb3Rvc1tpXSk7XG4gICAgICByZXR1cm4gbm9kZTtcbiAgICB9KTtcbiAgXG4gIH1cbiAgXG4gIGZ1bmN0aW9uIEFTQVAoKSB7XG4gICAgdmFyIHF1ZXVlID0gYXNhcFF1ZXVlLnNwbGljZSgwLCBhc2FwUXVldWUubGVuZ3RoKTtcbiAgICBhc2FwVGltZXIgPSAwO1xuICAgIHdoaWxlIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgIHF1ZXVlLnNoaWZ0KCkuY2FsbChcbiAgICAgICAgbnVsbCwgcXVldWUuc2hpZnQoKVxuICAgICAgKTtcbiAgICB9XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGxvb3BBbmRWZXJpZnkobGlzdCwgYWN0aW9uKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGxpc3QubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZlcmlmeUFuZFNldHVwQW5kQWN0aW9uKGxpc3RbaV0sIGFjdGlvbik7XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiBsb29wQW5kU2V0dXAobGlzdCkge1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBsaXN0Lmxlbmd0aCwgbm9kZTsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBub2RlID0gbGlzdFtpXTtcbiAgICAgIHBhdGNoKG5vZGUsIHByb3Rvc1tnZXRUeXBlSW5kZXgobm9kZSldKTtcbiAgICB9XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGV4ZWN1dGVBY3Rpb24oYWN0aW9uKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICBpZiAoaXNWYWxpZE5vZGUobm9kZSkpIHtcbiAgICAgICAgdmVyaWZ5QW5kU2V0dXBBbmRBY3Rpb24obm9kZSwgYWN0aW9uKTtcbiAgICAgICAgaWYgKHF1ZXJ5Lmxlbmd0aCkgbG9vcEFuZFZlcmlmeShcbiAgICAgICAgICBub2RlLnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpLFxuICAgICAgICAgIGFjdGlvblxuICAgICAgICApO1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGdldFR5cGVJbmRleCh0YXJnZXQpIHtcbiAgICB2YXJcbiAgICAgIGlzID0gZ2V0QXR0cmlidXRlLmNhbGwodGFyZ2V0LCAnaXMnKSxcbiAgICAgIG5vZGVOYW1lID0gdGFyZ2V0Lm5vZGVOYW1lLnRvVXBwZXJDYXNlKCksXG4gICAgICBpID0gaW5kZXhPZi5jYWxsKFxuICAgICAgICB0eXBlcyxcbiAgICAgICAgaXMgP1xuICAgICAgICAgICAgUFJFRklYX0lTICsgaXMudG9VcHBlckNhc2UoKSA6XG4gICAgICAgICAgICBQUkVGSVhfVEFHICsgbm9kZU5hbWVcbiAgICAgIClcbiAgICA7XG4gICAgcmV0dXJuIGlzICYmIC0xIDwgaSAmJiAhaXNJblFTQShub2RlTmFtZSwgaXMpID8gLTEgOiBpO1xuICB9XG4gIFxuICBmdW5jdGlvbiBpc0luUVNBKG5hbWUsIHR5cGUpIHtcbiAgICByZXR1cm4gLTEgPCBxdWVyeS5pbmRleE9mKG5hbWUgKyAnW2lzPVwiJyArIHR5cGUgKyAnXCJdJyk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIG9uRE9NQXR0ck1vZGlmaWVkKGUpIHtcbiAgICB2YXJcbiAgICAgIG5vZGUgPSBlLmN1cnJlbnRUYXJnZXQsXG4gICAgICBhdHRyQ2hhbmdlID0gZS5hdHRyQ2hhbmdlLFxuICAgICAgYXR0ck5hbWUgPSBlLmF0dHJOYW1lLFxuICAgICAgdGFyZ2V0ID0gZS50YXJnZXQsXG4gICAgICBhZGRpdGlvbiA9IGVbQURESVRJT05dIHx8IDIsXG4gICAgICByZW1vdmFsID0gZVtSRU1PVkFMXSB8fCAzXG4gICAgO1xuICAgIGlmIChub3RGcm9tSW5uZXJIVE1MSGVscGVyICYmXG4gICAgICAgICghdGFyZ2V0IHx8IHRhcmdldCA9PT0gbm9kZSkgJiZcbiAgICAgICAgbm9kZVtBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDS10gJiZcbiAgICAgICAgYXR0ck5hbWUgIT09ICdzdHlsZScgJiYgKFxuICAgICAgICAgIGUucHJldlZhbHVlICE9PSBlLm5ld1ZhbHVlIHx8XG4gICAgICAgICAgLy8gSUU5LCBJRTEwLCBhbmQgT3BlcmEgMTIgZ290Y2hhXG4gICAgICAgICAgZS5uZXdWYWx1ZSA9PT0gJycgJiYgKFxuICAgICAgICAgICAgYXR0ckNoYW5nZSA9PT0gYWRkaXRpb24gfHxcbiAgICAgICAgICAgIGF0dHJDaGFuZ2UgPT09IHJlbW92YWxcbiAgICAgICAgICApXG4gICAgKSkge1xuICAgICAgbm9kZVtBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDS10oXG4gICAgICAgIGF0dHJOYW1lLFxuICAgICAgICBhdHRyQ2hhbmdlID09PSBhZGRpdGlvbiA/IG51bGwgOiBlLnByZXZWYWx1ZSxcbiAgICAgICAgYXR0ckNoYW5nZSA9PT0gcmVtb3ZhbCA/IG51bGwgOiBlLm5ld1ZhbHVlXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gb25ET01Ob2RlKGFjdGlvbikge1xuICAgIHZhciBleGVjdXRvciA9IGV4ZWN1dGVBY3Rpb24oYWN0aW9uKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGFzYXBRdWV1ZS5wdXNoKGV4ZWN1dG9yLCBlLnRhcmdldCk7XG4gICAgICBpZiAoYXNhcFRpbWVyKSBjbGVhclRpbWVvdXQoYXNhcFRpbWVyKTtcbiAgICAgIGFzYXBUaW1lciA9IHNldFRpbWVvdXQoQVNBUCwgMSk7XG4gICAgfTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gb25SZWFkeVN0YXRlQ2hhbmdlKGUpIHtcbiAgICBpZiAoZHJvcERvbUNvbnRlbnRMb2FkZWQpIHtcbiAgICAgIGRyb3BEb21Db250ZW50TG9hZGVkID0gZmFsc2U7XG4gICAgICBlLmN1cnJlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihET01fQ09OVEVOVF9MT0FERUQsIG9uUmVhZHlTdGF0ZUNoYW5nZSk7XG4gICAgfVxuICAgIGlmIChxdWVyeS5sZW5ndGgpIGxvb3BBbmRWZXJpZnkoXG4gICAgICAoZS50YXJnZXQgfHwgZG9jdW1lbnQpLnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpLFxuICAgICAgZS5kZXRhaWwgPT09IERFVEFDSEVEID8gREVUQUNIRUQgOiBBVFRBQ0hFRFxuICAgICk7XG4gICAgaWYgKElFOCkgcHVyZ2UoKTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gcGF0Y2hlZFNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkge1xuICAgIC8vIGpzaGludCB2YWxpZHRoaXM6dHJ1ZVxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZXRBdHRyaWJ1dGUuY2FsbChzZWxmLCBuYW1lLCB2YWx1ZSk7XG4gICAgb25TdWJ0cmVlTW9kaWZpZWQuY2FsbChzZWxmLCB7dGFyZ2V0OiBzZWxmfSk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHNldHVwTm9kZShub2RlLCBwcm90bykge1xuICAgIHNldFByb3RvdHlwZShub2RlLCBwcm90byk7XG4gICAgaWYgKG9ic2VydmVyKSB7XG4gICAgICBvYnNlcnZlci5vYnNlcnZlKG5vZGUsIGF0dHJpYnV0ZXNPYnNlcnZlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCkge1xuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSA9IHBhdGNoZWRTZXRBdHRyaWJ1dGU7XG4gICAgICAgIG5vZGVbRVhQQU5ET19VSURdID0gZ2V0QXR0cmlidXRlc01pcnJvcihub2RlKTtcbiAgICAgICAgbm9kZVtBRERfRVZFTlRfTElTVEVORVJdKERPTV9TVUJUUkVFX01PRElGSUVELCBvblN1YnRyZWVNb2RpZmllZCk7XG4gICAgICB9XG4gICAgICBub2RlW0FERF9FVkVOVF9MSVNURU5FUl0oRE9NX0FUVFJfTU9ESUZJRUQsIG9uRE9NQXR0ck1vZGlmaWVkKTtcbiAgICB9XG4gICAgaWYgKG5vZGVbQ1JFQVRFRF9DQUxMQkFDS10gJiYgbm90RnJvbUlubmVySFRNTEhlbHBlcikge1xuICAgICAgbm9kZS5jcmVhdGVkID0gdHJ1ZTtcbiAgICAgIG5vZGVbQ1JFQVRFRF9DQUxMQkFDS10oKTtcbiAgICAgIG5vZGUuY3JlYXRlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gcHVyZ2UoKSB7XG4gICAgZm9yICh2YXJcbiAgICAgIG5vZGUsXG4gICAgICBpID0gMCxcbiAgICAgIGxlbmd0aCA9IHRhcmdldHMubGVuZ3RoO1xuICAgICAgaSA8IGxlbmd0aDsgaSsrXG4gICAgKSB7XG4gICAgICBub2RlID0gdGFyZ2V0c1tpXTtcbiAgICAgIGlmICghZG9jdW1lbnRFbGVtZW50LmNvbnRhaW5zKG5vZGUpKSB7XG4gICAgICAgIGxlbmd0aC0tO1xuICAgICAgICB0YXJnZXRzLnNwbGljZShpLS0sIDEpO1xuICAgICAgICB2ZXJpZnlBbmRTZXR1cEFuZEFjdGlvbihub2RlLCBERVRBQ0hFRCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiB0aHJvd1R5cGVFcnJvcih0eXBlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdBICcgKyB0eXBlICsgJyB0eXBlIGlzIGFscmVhZHkgcmVnaXN0ZXJlZCcpO1xuICB9XG4gIFxuICBmdW5jdGlvbiB2ZXJpZnlBbmRTZXR1cEFuZEFjdGlvbihub2RlLCBhY3Rpb24pIHtcbiAgICB2YXJcbiAgICAgIGZuLFxuICAgICAgaSA9IGdldFR5cGVJbmRleChub2RlKVxuICAgIDtcbiAgICBpZiAoLTEgPCBpKSB7XG4gICAgICBwYXRjaElmTm90QWxyZWFkeShub2RlLCBwcm90b3NbaV0pO1xuICAgICAgaSA9IDA7XG4gICAgICBpZiAoYWN0aW9uID09PSBBVFRBQ0hFRCAmJiAhbm9kZVtBVFRBQ0hFRF0pIHtcbiAgICAgICAgbm9kZVtERVRBQ0hFRF0gPSBmYWxzZTtcbiAgICAgICAgbm9kZVtBVFRBQ0hFRF0gPSB0cnVlO1xuICAgICAgICBpID0gMTtcbiAgICAgICAgaWYgKElFOCAmJiBpbmRleE9mLmNhbGwodGFyZ2V0cywgbm9kZSkgPCAwKSB7XG4gICAgICAgICAgdGFyZ2V0cy5wdXNoKG5vZGUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gREVUQUNIRUQgJiYgIW5vZGVbREVUQUNIRURdKSB7XG4gICAgICAgIG5vZGVbQVRUQUNIRURdID0gZmFsc2U7XG4gICAgICAgIG5vZGVbREVUQUNIRURdID0gdHJ1ZTtcbiAgICAgICAgaSA9IDE7XG4gICAgICB9XG4gICAgICBpZiAoaSAmJiAoZm4gPSBub2RlW2FjdGlvbiArIENBTExCQUNLXSkpIGZuLmNhbGwobm9kZSk7XG4gICAgfVxuICB9XG4gIFxuICBcbiAgXG4gIC8vIFYxIGluIGRhIEhvdXNlIVxuICBmdW5jdGlvbiBDdXN0b21FbGVtZW50UmVnaXN0cnkoKSB7fVxuICBcbiAgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5LnByb3RvdHlwZSA9IHtcbiAgICBjb25zdHJ1Y3RvcjogQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5LFxuICAgIC8vIGEgd29ya2Fyb3VuZCBmb3IgdGhlIHN0dWJib3JuIFdlYktpdFxuICAgIGRlZmluZTogdXNhYmxlQ3VzdG9tRWxlbWVudHMgP1xuICAgICAgZnVuY3Rpb24gKG5hbWUsIENsYXNzLCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChvcHRpb25zKSB7XG4gICAgICAgICAgQ0VSRGVmaW5lKG5hbWUsIENsYXNzLCBvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgTkFNRSA9IG5hbWUudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICBjb25zdHJ1Y3RvcnNbTkFNRV0gPSB7XG4gICAgICAgICAgICBjb25zdHJ1Y3RvcjogQ2xhc3MsXG4gICAgICAgICAgICBjcmVhdGU6IFtOQU1FXVxuICAgICAgICAgIH07XG4gICAgICAgICAgbm9kZU5hbWVzLnNldChDbGFzcywgTkFNRSk7XG4gICAgICAgICAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKG5hbWUsIENsYXNzKTtcbiAgICAgICAgfVxuICAgICAgfSA6XG4gICAgICBDRVJEZWZpbmUsXG4gICAgZ2V0OiB1c2FibGVDdXN0b21FbGVtZW50cyA/XG4gICAgICBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gY3VzdG9tRWxlbWVudHMuZ2V0KG5hbWUpIHx8IGdldChuYW1lKTtcbiAgICAgIH0gOlxuICAgICAgZ2V0LFxuICAgIHdoZW5EZWZpbmVkOiB1c2FibGVDdXN0b21FbGVtZW50cyA/XG4gICAgICBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yYWNlKFtcbiAgICAgICAgICBjdXN0b21FbGVtZW50cy53aGVuRGVmaW5lZChuYW1lKSxcbiAgICAgICAgICB3aGVuRGVmaW5lZChuYW1lKVxuICAgICAgICBdKTtcbiAgICAgIH0gOlxuICAgICAgd2hlbkRlZmluZWRcbiAgfTtcbiAgXG4gIGZ1bmN0aW9uIENFUkRlZmluZShuYW1lLCBDbGFzcywgb3B0aW9ucykge1xuICAgIHZhclxuICAgICAgaXMgPSBvcHRpb25zICYmIG9wdGlvbnNbRVhURU5EU10gfHwgJycsXG4gICAgICBDUHJvdG8gPSBDbGFzcy5wcm90b3R5cGUsXG4gICAgICBwcm90byA9IGNyZWF0ZShDUHJvdG8pLFxuICAgICAgYXR0cmlidXRlcyA9IENsYXNzLm9ic2VydmVkQXR0cmlidXRlcyB8fCBlbXB0eSxcbiAgICAgIGRlZmluaXRpb24gPSB7cHJvdG90eXBlOiBwcm90b31cbiAgICA7XG4gICAgLy8gVE9ETzogaXMgdGhpcyBuZWVkZWQgYXQgYWxsIHNpbmNlIGl0J3MgaW5oZXJpdGVkP1xuICAgIC8vIGRlZmluZVByb3BlcnR5KHByb3RvLCAnY29uc3RydWN0b3InLCB7dmFsdWU6IENsYXNzfSk7XG4gICAgc2FmZVByb3BlcnR5KHByb3RvLCBDUkVBVEVEX0NBTExCQUNLLCB7XG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKGp1c3RDcmVhdGVkKSBqdXN0Q3JlYXRlZCA9IGZhbHNlO1xuICAgICAgICAgIGVsc2UgaWYgKCF0aGlzW0RSRUNFVjFdKSB7XG4gICAgICAgICAgICB0aGlzW0RSRUNFVjFdID0gdHJ1ZTtcbiAgICAgICAgICAgIG5ldyBDbGFzcyh0aGlzKTtcbiAgICAgICAgICAgIGlmIChDUHJvdG9bQ1JFQVRFRF9DQUxMQkFDS10pXG4gICAgICAgICAgICAgIENQcm90b1tDUkVBVEVEX0NBTExCQUNLXS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdmFyIGluZm8gPSBjb25zdHJ1Y3RvcnNbbm9kZU5hbWVzLmdldChDbGFzcyldO1xuICAgICAgICAgICAgaWYgKCF1c2FibGVDdXN0b21FbGVtZW50cyB8fCBpbmZvLmNyZWF0ZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgIG5vdGlmeUF0dHJpYnV0ZXModGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIHNhZmVQcm9wZXJ0eShwcm90bywgQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0ssIHtcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICBpZiAoLTEgPCBpbmRleE9mLmNhbGwoYXR0cmlidXRlcywgbmFtZSkpXG4gICAgICAgICAgQ1Byb3RvW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChDUHJvdG9bQ09OTkVDVEVEX0NBTExCQUNLXSkge1xuICAgICAgc2FmZVByb3BlcnR5KHByb3RvLCBBVFRBQ0hFRF9DQUxMQkFDSywge1xuICAgICAgICB2YWx1ZTogQ1Byb3RvW0NPTk5FQ1RFRF9DQUxMQkFDS11cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoQ1Byb3RvW0RJU0NPTk5FQ1RFRF9DQUxMQkFDS10pIHtcbiAgICAgIHNhZmVQcm9wZXJ0eShwcm90bywgREVUQUNIRURfQ0FMTEJBQ0ssIHtcbiAgICAgICAgdmFsdWU6IENQcm90b1tESVNDT05ORUNURURfQ0FMTEJBQ0tdXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGlzKSBkZWZpbml0aW9uW0VYVEVORFNdID0gaXM7XG4gICAgbmFtZSA9IG5hbWUudG9VcHBlckNhc2UoKTtcbiAgICBjb25zdHJ1Y3RvcnNbbmFtZV0gPSB7XG4gICAgICBjb25zdHJ1Y3RvcjogQ2xhc3MsXG4gICAgICBjcmVhdGU6IGlzID8gW2lzLCBzZWNvbmRBcmd1bWVudChuYW1lKV0gOiBbbmFtZV1cbiAgICB9O1xuICAgIG5vZGVOYW1lcy5zZXQoQ2xhc3MsIG5hbWUpO1xuICAgIGRvY3VtZW50W1JFR0lTVEVSX0VMRU1FTlRdKG5hbWUudG9Mb3dlckNhc2UoKSwgZGVmaW5pdGlvbik7XG4gICAgd2hlbkRlZmluZWQobmFtZSk7XG4gICAgd2FpdGluZ0xpc3RbbmFtZV0ucigpO1xuICB9XG4gIFxuICBmdW5jdGlvbiBnZXQobmFtZSkge1xuICAgIHZhciBpbmZvID0gY29uc3RydWN0b3JzW25hbWUudG9VcHBlckNhc2UoKV07XG4gICAgcmV0dXJuIGluZm8gJiYgaW5mby5jb25zdHJ1Y3RvcjtcbiAgfVxuICBcbiAgZnVuY3Rpb24gZ2V0SXMob3B0aW9ucykge1xuICAgIHJldHVybiB0eXBlb2Ygb3B0aW9ucyA9PT0gJ3N0cmluZycgP1xuICAgICAgICBvcHRpb25zIDogKG9wdGlvbnMgJiYgb3B0aW9ucy5pcyB8fCAnJyk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIG5vdGlmeUF0dHJpYnV0ZXMoc2VsZikge1xuICAgIHZhclxuICAgICAgY2FsbGJhY2sgPSBzZWxmW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXSxcbiAgICAgIGF0dHJpYnV0ZXMgPSBjYWxsYmFjayA/IHNlbGYuYXR0cmlidXRlcyA6IGVtcHR5LFxuICAgICAgaSA9IGF0dHJpYnV0ZXMubGVuZ3RoLFxuICAgICAgYXR0cmlidXRlXG4gICAgO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIGF0dHJpYnV0ZSA9ICBhdHRyaWJ1dGVzW2ldOyAvLyB8fCBhdHRyaWJ1dGVzLml0ZW0oaSk7XG4gICAgICBjYWxsYmFjay5jYWxsKFxuICAgICAgICBzZWxmLFxuICAgICAgICBhdHRyaWJ1dGUubmFtZSB8fCBhdHRyaWJ1dGUubm9kZU5hbWUsXG4gICAgICAgIG51bGwsXG4gICAgICAgIGF0dHJpYnV0ZS52YWx1ZSB8fCBhdHRyaWJ1dGUubm9kZVZhbHVlXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gd2hlbkRlZmluZWQobmFtZSkge1xuICAgIG5hbWUgPSBuYW1lLnRvVXBwZXJDYXNlKCk7XG4gICAgaWYgKCEobmFtZSBpbiB3YWl0aW5nTGlzdCkpIHtcbiAgICAgIHdhaXRpbmdMaXN0W25hbWVdID0ge307XG4gICAgICB3YWl0aW5nTGlzdFtuYW1lXS5wID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgd2FpdGluZ0xpc3RbbmFtZV0uciA9IHJlc29sdmU7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHdhaXRpbmdMaXN0W25hbWVdLnA7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHBvbHlmaWxsVjEoKSB7XG4gICAgaWYgKGN1c3RvbUVsZW1lbnRzKSBkZWxldGUgd2luZG93LmN1c3RvbUVsZW1lbnRzO1xuICAgIGRlZmluZVByb3BlcnR5KHdpbmRvdywgJ2N1c3RvbUVsZW1lbnRzJywge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IG5ldyBDdXN0b21FbGVtZW50UmVnaXN0cnkoKVxuICAgIH0pO1xuICAgIGRlZmluZVByb3BlcnR5KHdpbmRvdywgJ0N1c3RvbUVsZW1lbnRSZWdpc3RyeScsIHtcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHZhbHVlOiBDdXN0b21FbGVtZW50UmVnaXN0cnlcbiAgICB9KTtcbiAgICBmb3IgKHZhclxuICAgICAgcGF0Y2hDbGFzcyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBDbGFzcyA9IHdpbmRvd1tuYW1lXTtcbiAgICAgICAgaWYgKENsYXNzKSB7XG4gICAgICAgICAgd2luZG93W25hbWVdID0gZnVuY3Rpb24gQ3VzdG9tRWxlbWVudHNWMShzZWxmKSB7XG4gICAgICAgICAgICB2YXIgaW5mbywgaXNOYXRpdmU7XG4gICAgICAgICAgICBpZiAoIXNlbGYpIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKCFzZWxmW0RSRUNFVjFdKSB7XG4gICAgICAgICAgICAgIGp1c3RDcmVhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgaW5mbyA9IGNvbnN0cnVjdG9yc1tub2RlTmFtZXMuZ2V0KHNlbGYuY29uc3RydWN0b3IpXTtcbiAgICAgICAgICAgICAgaXNOYXRpdmUgPSB1c2FibGVDdXN0b21FbGVtZW50cyAmJiBpbmZvLmNyZWF0ZS5sZW5ndGggPT09IDE7XG4gICAgICAgICAgICAgIHNlbGYgPSBpc05hdGl2ZSA/XG4gICAgICAgICAgICAgICAgUmVmbGVjdC5jb25zdHJ1Y3QoQ2xhc3MsIGVtcHR5LCBpbmZvLmNvbnN0cnVjdG9yKSA6XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudC5hcHBseShkb2N1bWVudCwgaW5mby5jcmVhdGUpO1xuICAgICAgICAgICAgICBzZWxmW0RSRUNFVjFdID0gdHJ1ZTtcbiAgICAgICAgICAgICAganVzdENyZWF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgaWYgKCFpc05hdGl2ZSkgbm90aWZ5QXR0cmlidXRlcyhzZWxmKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzZWxmO1xuICAgICAgICAgIH07XG4gICAgICAgICAgd2luZG93W25hbWVdLnByb3RvdHlwZSA9IENsYXNzLnByb3RvdHlwZTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gd2luZG93W25hbWVdO1xuICAgICAgICAgIH0gY2F0Y2goV2ViS2l0KSB7XG4gICAgICAgICAgICBmaXhHZXRDbGFzcyA9IHRydWU7XG4gICAgICAgICAgICBkZWZpbmVQcm9wZXJ0eShDbGFzcywgRFJFQ0VWMSwge3ZhbHVlOiB3aW5kb3dbbmFtZV19KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBDbGFzc2VzID0gaHRtbENsYXNzLmdldCgvXkhUTUxbQS1aXSpbYS16XS8pLFxuICAgICAgaSA9IENsYXNzZXMubGVuZ3RoO1xuICAgICAgaS0tO1xuICAgICAgcGF0Y2hDbGFzcyhDbGFzc2VzW2ldKVxuICAgICkge31cbiAgICAoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCA9IGZ1bmN0aW9uIChuYW1lLCBvcHRpb25zKSB7XG4gICAgICB2YXIgaXMgPSBnZXRJcyhvcHRpb25zKTtcbiAgICAgIHJldHVybiBpcyA/XG4gICAgICAgIHBhdGNoZWRDcmVhdGVFbGVtZW50LmNhbGwodGhpcywgbmFtZSwgc2Vjb25kQXJndW1lbnQoaXMpKSA6XG4gICAgICAgIHBhdGNoZWRDcmVhdGVFbGVtZW50LmNhbGwodGhpcywgbmFtZSk7XG4gICAgfSk7XG4gICAgaWYgKCFWMCkge1xuICAgICAganVzdFNldHVwID0gdHJ1ZTtcbiAgICAgIGRvY3VtZW50W1JFR0lTVEVSX0VMRU1FTlRdKCcnKTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIGlmIGN1c3RvbUVsZW1lbnRzIGlzIG5vdCB0aGVyZSBhdCBhbGxcbiAgaWYgKCFjdXN0b21FbGVtZW50cyB8fCBwb2x5ZmlsbCA9PT0gJ2ZvcmNlJykgcG9seWZpbGxWMSgpO1xuICBlbHNlIHtcbiAgICAvLyBpZiBhdmFpbGFibGUgdGVzdCBleHRlbmRzIHdvcmsgYXMgZXhwZWN0ZWRcbiAgICB0cnkge1xuICAgICAgKGZ1bmN0aW9uIChEUkUsIG9wdGlvbnMsIG5hbWUpIHtcbiAgICAgICAgb3B0aW9uc1tFWFRFTkRTXSA9ICdhJztcbiAgICAgICAgRFJFLnByb3RvdHlwZSA9IGNyZWF0ZShIVE1MQW5jaG9yRWxlbWVudC5wcm90b3R5cGUpO1xuICAgICAgICBEUkUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRFJFO1xuICAgICAgICB3aW5kb3cuY3VzdG9tRWxlbWVudHMuZGVmaW5lKG5hbWUsIERSRSwgb3B0aW9ucyk7XG4gICAgICAgIGlmIChcbiAgICAgICAgICBnZXRBdHRyaWJ1dGUuY2FsbChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJywge2lzOiBuYW1lfSksICdpcycpICE9PSBuYW1lIHx8XG4gICAgICAgICAgKHVzYWJsZUN1c3RvbUVsZW1lbnRzICYmIGdldEF0dHJpYnV0ZS5jYWxsKG5ldyBEUkUoKSwgJ2lzJykgIT09IG5hbWUpXG4gICAgICAgICkge1xuICAgICAgICAgIHRocm93IG9wdGlvbnM7XG4gICAgICAgIH1cbiAgICAgIH0oXG4gICAgICAgIGZ1bmN0aW9uIERSRSgpIHtcbiAgICAgICAgICByZXR1cm4gUmVmbGVjdC5jb25zdHJ1Y3QoSFRNTEFuY2hvckVsZW1lbnQsIFtdLCBEUkUpO1xuICAgICAgICB9LFxuICAgICAgICB7fSxcbiAgICAgICAgJ2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQtYSdcbiAgICAgICkpO1xuICAgIH0gY2F0Y2gob19PKSB7XG4gICAgICAvLyBvciBmb3JjZSB0aGUgcG9seWZpbGwgaWYgbm90XG4gICAgICAvLyBhbmQga2VlcCBpbnRlcm5hbCBvcmlnaW5hbCByZWZlcmVuY2VcbiAgICAgIHBvbHlmaWxsVjEoKTtcbiAgICB9XG4gIH1cbiAgXG4gIHRyeSB7XG4gICAgY3JlYXRlRWxlbWVudC5jYWxsKGRvY3VtZW50LCAnYScsICdhJyk7XG4gIH0gY2F0Y2goRmlyZUZveCkge1xuICAgIHNlY29uZEFyZ3VtZW50ID0gZnVuY3Rpb24gKGlzKSB7XG4gICAgICByZXR1cm4ge2lzOiBpcy50b0xvd2VyQ2FzZSgpfTtcbiAgICB9O1xuICB9XG4gIFxufVxuXG5leHBvcnRzLmluc3RhbGxDdXN0b21FbGVtZW50cyA9IGluc3RhbGxDdXN0b21FbGVtZW50cztcblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIENvbnN0cnVjdHMgYSBFUzYvUHJvbWlzZXMgQSsgUHJvbWlzZSBpbnN0YW5jZS5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oZnVuY3Rpb24oKj0pLCBmdW5jdGlvbiAoKj0pKX0gcmVzb2x2ZXJcbiAqL1xuZnVuY3Rpb24gUHJvbWlzZShyZXNvbHZlcikge1xuICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDb25zdHJ1Y3RvciBQcm9taXNlIHJlcXVpcmVzIGBuZXdgJyk7XG4gIH1cbiAgaWYgKCFpc0Z1bmN0aW9uKHJlc29sdmVyKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ011c3QgcGFzcyByZXNvbHZlciBmdW5jdGlvbicpO1xuICB9XG5cbiAgLyoqXG4gICAqIEB0eXBlIHtmdW5jdGlvbih0aGlzOlByb21pc2UsKj0sZnVuY3Rpb24oKj0pLGZ1bmN0aW9uKCo9KSxEZWZlcnJlZCk6IVByb21pc2V9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB0aGlzLl9zdGF0ZSA9IFBlbmRpbmdQcm9taXNlO1xuXG4gIC8qKlxuICAgKiBAdHlwZSB7Kn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHRoaXMuX3ZhbHVlID0gW107XG5cbiAgLyoqXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGhpcy5faXNDaGFpbkVuZCA9IHRydWU7XG5cbiAgZG9SZXNvbHZlKFxuICAgIHRoaXMsXG4gICAgYWRvcHRlcih0aGlzLCBGdWxmaWxsZWRQcm9taXNlKSxcbiAgICBhZG9wdGVyKHRoaXMsIFJlamVjdGVkUHJvbWlzZSksXG4gICAgeyB0aGVuOiByZXNvbHZlciB9XG4gICk7XG59XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gIFB1YmxpYyBJbnN0YW5jZSBNZXRob2RzXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHByb21pc2UgaW5zdGFuY2UgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIHJlc3VsdCBvZiB0aGlzIHByb21pc2VcbiAqIGFzIGlucHV0cyB0byB0aGUgb25GdWxmaWxsZWQgb3Igb25SZWplY3RlZCBjYWxsYmFja3MuXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbigqKX0gb25GdWxmaWxsZWRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKil9IG9uUmVqZWN0ZWRcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7XG4gIG9uRnVsZmlsbGVkID0gaXNGdW5jdGlvbihvbkZ1bGZpbGxlZCkgPyBvbkZ1bGZpbGxlZCA6IHZvaWQgMDtcbiAgb25SZWplY3RlZCA9IGlzRnVuY3Rpb24ob25SZWplY3RlZCkgPyBvblJlamVjdGVkIDogdm9pZCAwO1xuXG4gIGlmIChvbkZ1bGZpbGxlZCB8fCBvblJlamVjdGVkKSB7XG4gICAgdGhpcy5faXNDaGFpbkVuZCA9IGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHRoaXMuX3N0YXRlKFxuICAgIHRoaXMuX3ZhbHVlLFxuICAgIG9uRnVsZmlsbGVkLFxuICAgIG9uUmVqZWN0ZWRcbiAgKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBwcm9taXNlIHRoYXQgd2lsbCBoYW5kbGUgdGhlIHJlamVjdGVkIHN0YXRlIG9mIHRoaXMgcHJvbWlzZS5cbiAqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCopfSBvblJlamVjdGVkXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cblByb21pc2UucHJvdG90eXBlLmNhdGNoID0gZnVuY3Rpb24ob25SZWplY3RlZCkge1xuICByZXR1cm4gdGhpcy50aGVuKHZvaWQgMCwgb25SZWplY3RlZCk7XG59O1xuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICBQdWJsaWMgU3RhdGljIE1ldGhvZHNcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4vKipcbiAqIENyZWF0ZXMgYSBmdWxmaWxsZWQgUHJvbWlzZSBvZiB2YWx1ZS4gSWYgdmFsdWUgaXMgaXRzZWxmIGEgdGhlbi1hYmxlLFxuICogcmVzb2x2ZXMgd2l0aCB0aGUgdGhlbi1hYmxlJ3MgdmFsdWUuXG4gKlxuICogQHRoaXMgeyFQcm9taXNlfVxuICogQHBhcmFtIHsqPX0gdmFsdWVcbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuUHJvbWlzZS5yZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcbiAgdmFyIHByb21pc2U7XG5cbiAgaWYgKGlzT2JqZWN0KHZhbHVlKSAmJiB2YWx1ZSBpbnN0YW5jZW9mIHRoaXMpIHtcbiAgICBwcm9taXNlID0gdmFsdWU7XG4gIH0gZWxzZSB7XG4gICAgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICByZXNvbHZlKHZhbHVlKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlfSAqLyhwcm9taXNlKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIHJlamVjdGVkIFByb21pc2Ugb2YgcmVhc29uLlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX1cbiAqIEBwYXJhbSB7Kj19IHJlYXNvblxuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5Qcm9taXNlLnJlamVjdCA9IGZ1bmN0aW9uKHJlYXNvbikge1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbihfLCByZWplY3QpIHtcbiAgICByZWplY3QocmVhc29uKTtcbiAgfSk7XG5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2V9ICovKHByb21pc2UpO1xufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgUHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB3aXRoIGFuIGFycmF5IG9mIHRoZSB2YWx1ZXMgb2YgdGhlXG4gKiBwYXNzZWQgaW4gcHJvbWlzZXMuIElmIGFueSBwcm9taXNlIHJlamVjdHMsIHRoZSByZXR1cm5lZCBwcm9taXNlIHdpbGxcbiAqIHJlamVjdC5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9XG4gKiBAcGFyYW0geyFBcnJheTxQcm9taXNlfCo+fSBwcm9taXNlc1xuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5Qcm9taXNlLmFsbCA9IGZ1bmN0aW9uKHByb21pc2VzKSB7XG4gIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG4gIHZhciBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHZhciBsZW5ndGggPSBwcm9taXNlcy5sZW5ndGg7XG4gICAgdmFyIHZhbHVlcyA9IG5ldyBBcnJheShsZW5ndGgpO1xuXG4gICAgaWYgKGxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHJlc29sdmUodmFsdWVzKTtcbiAgICB9XG5cbiAgICBlYWNoKHByb21pc2VzLCBmdW5jdGlvbihwcm9taXNlLCBpbmRleCkge1xuICAgICAgQ29uc3RydWN0b3IucmVzb2x2ZShwcm9taXNlKS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgaWYgKC0tbGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgcmVzb2x2ZSh2YWx1ZXMpO1xuICAgICAgICB9XG4gICAgICB9LCByZWplY3QpO1xuICAgIH0pO1xuICB9KTtcblxuICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZX0gKi8ocHJvbWlzZSk7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBQcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIG9yIHJlamVjdCBiYXNlZCBvbiB0aGUgZmlyc3RcbiAqIHJlc29sdmVkIG9yIHJlamVjdGVkIHByb21pc2UuXG4gKlxuICogQHRoaXMgeyFQcm9taXNlfVxuICogQHBhcmFtIHshQXJyYXk8UHJvbWlzZXwqPn0gcHJvbWlzZXNcbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuUHJvbWlzZS5yYWNlID0gZnVuY3Rpb24ocHJvbWlzZXMpIHtcbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcbiAgdmFyIHByb21pc2UgPSBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9taXNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgQ29uc3RydWN0b3IucmVzb2x2ZShwcm9taXNlc1tpXSkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2V9ICovKHByb21pc2UpO1xufTtcblxudmFyIG9uUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gPSBmdW5jdGlvbihyZWFzb24sIHByb21pc2UpIHtcbiAgdGhyb3cgcmVhc29uO1xufTtcblxuLyoqXG4gKiBBbiBpbnRlcm5hbCB1c2Ugc3RhdGljIGZ1bmN0aW9uLlxuICovXG5Qcm9taXNlLl9vdmVycmlkZVVuaGFuZGxlZEV4Y2VwdGlvbkhhbmRsZXIgPSBmdW5jdGlvbihoYW5kbGVyKSB7XG4gIG9uUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gPSBoYW5kbGVyO1xufTtcblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgUHJpdmF0ZSBmdW5jdGlvbnNcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4vKipcbiAqIFRoZSBGdWxmaWxsZWQgUHJvbWlzZSBzdGF0ZS4gQ2FsbHMgb25GdWxmaWxsZWQgd2l0aCB0aGUgcmVzb2x2ZWQgdmFsdWUgb2ZcbiAqIHRoaXMgcHJvbWlzZSwgY3JlYXRpbmcgYSBuZXcgcHJvbWlzZS5cbiAqXG4gKiBJZiB0aGVyZSBpcyBubyBvbkZ1bGZpbGxlZCwgcmV0dXJucyB0aGUgY3VycmVudCBwcm9taXNlIHRvIGF2b2lkIGFuIHByb21pc2VcbiAqIGluc3RhbmNlLlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX0gVGhlIGN1cnJlbnQgcHJvbWlzZVxuICogQHBhcmFtIHsqPX0gdmFsdWUgVGhlIGN1cnJlbnQgcHJvbWlzZSdzIHJlc29sdmVkIHZhbHVlLlxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSBvbkZ1bGZpbGxlZFxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSB1bnVzZWRcbiAqIEBwYXJhbSB7RGVmZXJyZWR9IGRlZmVycmVkIEEgZGVmZXJyZWQgb2JqZWN0IHRoYXQgaG9sZHMgYSBwcm9taXNlIGFuZCBpdHNcbiAqICAgICByZXNvbHZlIGFuZCByZWplY3QgZnVuY3Rpb25zLiBJdCBJUyBOT1QgcGFzc2VkIHdoZW4gY2FsbGVkIGZyb21cbiAqICAgICBQcm9taXNlI3RoZW4gdG8gc2F2ZSBhbiBvYmplY3QgaW5zdGFuY2UgKHNpbmNlIHdlIG1heSByZXR1cm4gdGhlIGN1cnJlbnRcbiAqICAgICBwcm9taXNlKS4gSXQgSVMgcGFzc2VkIGluIHdoZW4gYWRvcHRpbmcgdGhlIEZ1bGZpbGxlZCBzdGF0ZSBmcm9tIHRoZVxuICogICAgIFBlbmRpbmcgc3RhdGUuXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cbmZ1bmN0aW9uIEZ1bGZpbGxlZFByb21pc2UodmFsdWUsIG9uRnVsZmlsbGVkLCB1bnVzZWQsIGRlZmVycmVkKSB7XG4gIGlmICghb25GdWxmaWxsZWQpIHtcbiAgICBkZWZlcnJlZEFkb3B0KGRlZmVycmVkLCBGdWxmaWxsZWRQcm9taXNlLCB2YWx1ZSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgaWYgKCFkZWZlcnJlZCkge1xuICAgIGRlZmVycmVkID0gbmV3IERlZmVycmVkKHRoaXMuY29uc3RydWN0b3IpO1xuICB9XG4gIGRlZmVyKHRyeUNhdGNoRGVmZXJyZWQoZGVmZXJyZWQsIG9uRnVsZmlsbGVkLCB2YWx1ZSkpO1xuICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbn1cblxuLyoqXG4gKiBUaGUgUmVqZWN0ZWQgUHJvbWlzZSBzdGF0ZS4gQ2FsbHMgb25SZWplY3RlZCB3aXRoIHRoZSByZXNvbHZlZCB2YWx1ZSBvZlxuICogdGhpcyBwcm9taXNlLCBjcmVhdGluZyBhIG5ldyBwcm9taXNlLlxuICpcbiAqIElmIHRoZXJlIGlzIG5vIG9uUmVqZWN0ZWQsIHJldHVybnMgdGhlIGN1cnJlbnQgcHJvbWlzZSB0byBhdm9pZCBhbiBwcm9taXNlXG4gKiBpbnN0YW5jZS5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9IFRoZSBjdXJyZW50IHByb21pc2VcbiAqIEBwYXJhbSB7Kj19IHJlYXNvbiBUaGUgY3VycmVudCBwcm9taXNlJ3MgcmVqZWN0aW9uIHJlYXNvbi5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0pPX0gdW51c2VkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IG9uUmVqZWN0ZWRcbiAqIEBwYXJhbSB7RGVmZXJyZWR9IGRlZmVycmVkIEEgZGVmZXJyZWQgb2JqZWN0IHRoYXQgaG9sZHMgYSBwcm9taXNlIGFuZCBpdHNcbiAqICAgICByZXNvbHZlIGFuZCByZWplY3QgZnVuY3Rpb25zLiBJdCBJUyBOT1QgcGFzc2VkIHdoZW4gY2FsbGVkIGZyb21cbiAqICAgICBQcm9taXNlI3RoZW4gdG8gc2F2ZSBhbiBvYmplY3QgaW5zdGFuY2UgKHNpbmNlIHdlIG1heSByZXR1cm4gdGhlIGN1cnJlbnRcbiAqICAgICBwcm9taXNlKS4gSXQgSVMgcGFzc2VkIGluIHdoZW4gYWRvcHRpbmcgdGhlIFJlamVjdGVkIHN0YXRlIGZyb20gdGhlXG4gKiAgICAgUGVuZGluZyBzdGF0ZS5cbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gUmVqZWN0ZWRQcm9taXNlKHJlYXNvbiwgdW51c2VkLCBvblJlamVjdGVkLCBkZWZlcnJlZCkge1xuICBpZiAoIW9uUmVqZWN0ZWQpIHtcbiAgICBkZWZlcnJlZEFkb3B0KGRlZmVycmVkLCBSZWplY3RlZFByb21pc2UsIHJlYXNvbik7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgaWYgKCFkZWZlcnJlZCkge1xuICAgIGRlZmVycmVkID0gbmV3IERlZmVycmVkKHRoaXMuY29uc3RydWN0b3IpO1xuICB9XG4gIGRlZmVyKHRyeUNhdGNoRGVmZXJyZWQoZGVmZXJyZWQsIG9uUmVqZWN0ZWQsIHJlYXNvbikpO1xuICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbn1cblxuLyoqXG4gKiBUaGUgUGVuZGluZyBQcm9taXNlIHN0YXRlLiBFdmVudHVhbGx5IGNhbGxzIG9uRnVsZmlsbGVkIG9uY2UgdGhlIHByb21pc2UgaGFzXG4gKiByZXNvbHZlZCwgb3Igb25SZWplY3RlZCBvbmNlIHRoZSBwcm9taXNlIHJlamVjdHMuXG4gKlxuICogSWYgdGhlcmUgaXMgbm8gb25GdWxmaWxsZWQgYW5kIG5vIG9uUmVqZWN0ZWQsIHJldHVybnMgdGhlIGN1cnJlbnQgcHJvbWlzZSB0b1xuICogYXZvaWQgYW4gcHJvbWlzZSBpbnN0YW5jZS5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9IFRoZSBjdXJyZW50IHByb21pc2VcbiAqIEBwYXJhbSB7Kj19IHF1ZXVlIFRoZSBjdXJyZW50IHByb21pc2UncyBwZW5kaW5nIHByb21pc2VzIHF1ZXVlLlxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSBvbkZ1bGZpbGxlZFxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSBvblJlamVjdGVkXG4gKiBAcGFyYW0ge0RlZmVycmVkfSBkZWZlcnJlZCBBIGRlZmVycmVkIG9iamVjdCB0aGF0IGhvbGRzIGEgcHJvbWlzZSBhbmQgaXRzXG4gKiAgICAgcmVzb2x2ZSBhbmQgcmVqZWN0IGZ1bmN0aW9ucy4gSXQgSVMgTk9UIHBhc3NlZCB3aGVuIGNhbGxlZCBmcm9tXG4gKiAgICAgUHJvbWlzZSN0aGVuIHRvIHNhdmUgYW4gb2JqZWN0IGluc3RhbmNlIChzaW5jZSB3ZSBtYXkgcmV0dXJuIHRoZSBjdXJyZW50XG4gKiAgICAgcHJvbWlzZSkuIEl0IElTIHBhc3NlZCBpbiB3aGVuIGFkb3B0aW5nIHRoZSBQZW5kaW5nIHN0YXRlIGZyb20gdGhlXG4gKiAgICAgUGVuZGluZyBzdGF0ZSBvZiBhbm90aGVyIHByb21pc2UuXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cbmZ1bmN0aW9uIFBlbmRpbmdQcm9taXNlKHF1ZXVlLCBvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCwgZGVmZXJyZWQpIHtcbiAgaWYgKCFkZWZlcnJlZCkge1xuICAgIGlmICghb25GdWxmaWxsZWQgJiYgIW9uUmVqZWN0ZWQpIHsgcmV0dXJuIHRoaXM7IH1cbiAgICBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCh0aGlzLmNvbnN0cnVjdG9yKTtcbiAgfVxuICBxdWV1ZS5wdXNoKHtcbiAgICBkZWZlcnJlZDogZGVmZXJyZWQsXG4gICAgb25GdWxmaWxsZWQ6IG9uRnVsZmlsbGVkIHx8IGRlZmVycmVkLnJlc29sdmUsXG4gICAgb25SZWplY3RlZDogb25SZWplY3RlZCB8fCBkZWZlcnJlZC5yZWplY3RcbiAgfSk7XG4gIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xufVxuXG4vKipcbiAqIENvbnN0cnVjdHMgYSBkZWZlcnJlZCBpbnN0YW5jZSB0aGF0IGhvbGRzIGEgcHJvbWlzZSBhbmQgaXRzIHJlc29sdmUgYW5kXG4gKiByZWplY3QgZnVuY3Rpb25zLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBEZWZlcnJlZChQcm9taXNlKSB7XG4gIHZhciBkZWZlcnJlZCA9IHRoaXM7XG4gIC8qKiBAdHlwZSB7IVByb21pc2V9ICovXG4gIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIC8qKiBAdHlwZSB7ZnVuY3Rpb24oKj0pfSAqL1xuICAgIGRlZmVycmVkLnJlc29sdmUgPSByZXNvbHZlO1xuXG4gICAgLyoqIEB0eXBlIHtmdW5jdGlvbigqPSl9ICovXG4gICAgZGVmZXJyZWQucmVqZWN0ID0gcmVqZWN0O1xuICB9KTtcbiAgcmV0dXJuIGRlZmVycmVkO1xufVxuXG4vKipcbiAqIFRyYW5zaXRpb25zIHRoZSBzdGF0ZSBvZiBwcm9taXNlIHRvIGFub3RoZXIgc3RhdGUuIFRoaXMgaXMgb25seSBldmVyIGNhbGxlZFxuICogb24gd2l0aCBhIHByb21pc2UgdGhhdCBpcyBjdXJyZW50bHkgaW4gdGhlIFBlbmRpbmcgc3RhdGUuXG4gKlxuICogQHBhcmFtIHshUHJvbWlzZX0gcHJvbWlzZVxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlByb21pc2UsKj0sZnVuY3Rpb24oKj0pLGZ1bmN0aW9uKCo9KSxEZWZlcnJlZCk6IVByb21pc2V9IHN0YXRlXG4gKiBAcGFyYW0geyo9fSB2YWx1ZVxuICovXG5mdW5jdGlvbiBhZG9wdChwcm9taXNlLCBzdGF0ZSwgdmFsdWUsIGFkb3B0ZWUpIHtcbiAgdmFyIHF1ZXVlID0gcHJvbWlzZS5fdmFsdWU7XG4gIHByb21pc2UuX3N0YXRlID0gc3RhdGU7XG4gIHByb21pc2UuX3ZhbHVlID0gdmFsdWU7XG5cbiAgaWYgKGFkb3B0ZWUgJiYgc3RhdGUgPT09IFBlbmRpbmdQcm9taXNlKSB7XG4gICAgYWRvcHRlZS5fc3RhdGUodmFsdWUsIHZvaWQgMCwgdm9pZCAwLCB7XG4gICAgICBwcm9taXNlOiBwcm9taXNlLFxuICAgICAgcmVzb2x2ZTogdm9pZCAwLFxuICAgICAgcmVqZWN0OiB2b2lkIDBcbiAgICB9KTtcbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgbmV4dCA9IHF1ZXVlW2ldO1xuICAgIHByb21pc2UuX3N0YXRlKFxuICAgICAgdmFsdWUsXG4gICAgICBuZXh0Lm9uRnVsZmlsbGVkLFxuICAgICAgbmV4dC5vblJlamVjdGVkLFxuICAgICAgbmV4dC5kZWZlcnJlZFxuICAgICk7XG4gIH1cbiAgcXVldWUubGVuZ3RoID0gMDtcblxuICAvLyBEZXRlcm1pbmUgaWYgdGhpcyByZWplY3RlZCBwcm9taXNlIHdpbGwgYmUgXCJoYW5kbGVkXCIuXG4gIGlmIChzdGF0ZSA9PT0gUmVqZWN0ZWRQcm9taXNlICYmIHByb21pc2UuX2lzQ2hhaW5FbmQpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHByb21pc2UuX2lzQ2hhaW5FbmQpIHtcbiAgICAgICAgb25Qb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbih2YWx1ZSwgcHJvbWlzZSk7XG4gICAgICB9XG4gICAgfSwgMCk7XG4gIH1cbn1cblxuLyoqXG4gKiBBIHBhcnRpYWwgYXBwbGljYXRpb24gb2YgYWRvcHQuXG4gKlxuICogQHBhcmFtIHshUHJvbWlzZX0gcHJvbWlzZVxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlByb21pc2UsKj0sZnVuY3Rpb24oKj0pLGZ1bmN0aW9uKCo9KSxEZWZlcnJlZCk6IVByb21pc2V9IHN0YXRlXG4gKiBAcmV0dXJucyB7ZnVuY3Rpb24oKj0pfVxuICovXG5mdW5jdGlvbiBhZG9wdGVyKHByb21pc2UsIHN0YXRlKSB7XG4gIHJldHVybiBmdW5jdGlvbih2YWx1ZSkge1xuICAgIGFkb3B0KHByb21pc2UsIHN0YXRlLCB2YWx1ZSk7XG4gIH07XG59XG5cbi8qKlxuICogVXBkYXRlcyBhIGRlZmVycmVkIHByb21pc2VzIHN0YXRlLiBOZWNlc3NhcnkgZm9yIHVwZGF0aW5nIGFuIGFkb3B0aW5nXG4gKiBwcm9taXNlJ3Mgc3RhdGUgd2hlbiB0aGUgYWRvcHRlZSByZXNvbHZlcy5cbiAqXG4gKiBAcGFyYW0gez9EZWZlcnJlZH0gZGVmZXJyZWRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24odGhpczpQcm9taXNlLCo9LGZ1bmN0aW9uKCo9KSxmdW5jdGlvbigqPSksRGVmZXJyZWQpOiFQcm9taXNlfSBzdGF0ZVxuICogQHBhcmFtIHsqPX0gdmFsdWVcbiAqL1xuZnVuY3Rpb24gZGVmZXJyZWRBZG9wdChkZWZlcnJlZCwgc3RhdGUsIHZhbHVlKSB7XG4gIGlmIChkZWZlcnJlZCkge1xuICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICBwcm9taXNlLl9zdGF0ZSA9IHN0YXRlO1xuICAgIHByb21pc2UuX3ZhbHVlID0gdmFsdWU7XG4gIH1cbn1cblxuLyoqXG4gKiBBIG5vLW9wIGZ1bmN0aW9uIHRvIHByZXZlbnQgZG91YmxlIHJlc29sdmluZy5cbiAqL1xuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbi8qKlxuICogVGVzdHMgaWYgZm4gaXMgYSBGdW5jdGlvblxuICpcbiAqIEBwYXJhbSB7Kn0gZm5cbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc0Z1bmN0aW9uKGZuKSB7XG4gIHJldHVybiB0eXBlb2YgZm4gPT09ICdmdW5jdGlvbic7XG59XG5cbi8qKlxuICogVGVzdHMgaWYgZm4gaXMgYW4gT2JqZWN0XG4gKlxuICogQHBhcmFtIHsqfSBvYmpcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc09iamVjdChvYmopIHtcbiAgcmV0dXJuIG9iaiA9PT0gT2JqZWN0KG9iaik7XG59XG5cbi8qKlxuICogSXRlcmF0ZXMgb3ZlciBlYWNoIGVsZW1lbnQgb2YgYW4gYXJyYXksIGNhbGxpbmcgdGhlIGl0ZXJhdG9yIHdpdGggdGhlXG4gKiBlbGVtZW50IGFuZCBpdHMgaW5kZXguXG4gKlxuICogQHBhcmFtIHshQXJyYXl9IGNvbGxlY3Rpb25cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0sbnVtYmVyKX0gaXRlcmF0b3JcbiAqL1xuZnVuY3Rpb24gZWFjaChjb2xsZWN0aW9uLCBpdGVyYXRvcikge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbGxlY3Rpb24ubGVuZ3RoOyBpKyspIHtcbiAgICBpdGVyYXRvcihjb2xsZWN0aW9uW2ldLCBpKTtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgYXR0ZW1wdCB0byByZXNvbHZlIHRoZSBkZWZlcnJlZCB3aXRoIHRoZSByZXR1cm5cbiAqIG9mIGZuLiBJZiBhbnkgZXJyb3IgaXMgcmFpc2VkLCByZWplY3RzIGluc3RlYWQuXG4gKlxuICogQHBhcmFtIHshRGVmZXJyZWR9IGRlZmVycmVkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KX0gZm5cbiAqIEBwYXJhbSB7Kn0gYXJnXG4gKiBAcmV0dXJucyB7ZnVuY3Rpb24oKX1cbiAqL1xuZnVuY3Rpb24gdHJ5Q2F0Y2hEZWZlcnJlZChkZWZlcnJlZCwgZm4sIGFyZykge1xuICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gIHZhciByZXNvbHZlID0gZGVmZXJyZWQucmVzb2x2ZTtcbiAgdmFyIHJlamVjdCA9IGRlZmVycmVkLnJlamVjdDtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHRyeSB7XG4gICAgICB2YXIgcmVzdWx0ID0gZm4oYXJnKTtcbiAgICAgIGRvUmVzb2x2ZShwcm9taXNlLCByZXNvbHZlLCByZWplY3QsIHJlc3VsdCwgcmVzdWx0KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZWplY3QoZSk7XG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIFF1ZXVlcyBhbmQgZXhlY3V0ZXMgbXVsdGlwbGUgZGVmZXJyZWQgZnVuY3Rpb25zIG9uIGFub3RoZXIgcnVuIGxvb3AuXG4gKi9cbnZhciBkZWZlciA9IChmdW5jdGlvbigpIHtcbiAgLyoqXG4gICAqIERlZmVycyBmbiB0byBhbm90aGVyIHJ1biBsb29wLlxuICAgKi9cbiAgdmFyIHNjaGVkdWxlRmx1c2g7XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucG9zdE1lc3NhZ2UpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZsdXNoKTtcbiAgICBzY2hlZHVsZUZsdXNoID0gZnVuY3Rpb24oKSB7XG4gICAgICB3aW5kb3cucG9zdE1lc3NhZ2UoJ21hY3JvLXRhc2snLCAnKicpO1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgc2NoZWR1bGVGbHVzaCA9IGZ1bmN0aW9uKCkge1xuICAgICAgc2V0VGltZW91dChmbHVzaCwgMCk7XG4gICAgfTtcbiAgfVxuXG4gIHZhciBxdWV1ZSA9IG5ldyBBcnJheSgxNik7XG4gIHZhciBsZW5ndGggPSAwO1xuXG4gIGZ1bmN0aW9uIGZsdXNoKCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBmbiA9IHF1ZXVlW2ldO1xuICAgICAgcXVldWVbaV0gPSBudWxsO1xuICAgICAgZm4oKTtcbiAgICB9XG4gICAgbGVuZ3RoID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGZuXG4gICAqL1xuICBmdW5jdGlvbiBkZWZlcihmbikge1xuICAgIGlmIChsZW5ndGggPT09IDApIHsgc2NoZWR1bGVGbHVzaCgpOyB9XG4gICAgcXVldWVbbGVuZ3RoKytdID0gZm47XG4gIH1cblxuICByZXR1cm4gZGVmZXI7XG59KSgpO1xuXG4vKipcbiAqIFRoZSBQcm9taXNlIHJlc29sdXRpb24gcHJvY2VkdXJlLlxuICogaHR0cHM6Ly9naXRodWIuY29tL3Byb21pc2VzLWFwbHVzL3Byb21pc2VzLXNwZWMjdGhlLXByb21pc2UtcmVzb2x1dGlvbi1wcm9jZWR1cmVcbiAqXG4gKiBAcGFyYW0geyFQcm9taXNlfSBwcm9taXNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KX0gcmVzb2x2ZVxuICogQHBhcmFtIHtmdW5jdGlvbigqPSl9IHJlamVjdFxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHBhcmFtIHsqPX0gY29udGV4dFxuICovXG5mdW5jdGlvbiBkb1Jlc29sdmUocHJvbWlzZSwgcmVzb2x2ZSwgcmVqZWN0LCB2YWx1ZSwgY29udGV4dCkge1xuICB2YXIgX3JlamVjdCA9IHJlamVjdDtcbiAgdmFyIHRoZW47XG4gIHZhciBfcmVzb2x2ZTtcbiAgdHJ5IHtcbiAgICBpZiAodmFsdWUgPT09IHByb21pc2UpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBmdWxmaWxsIHByb21pc2Ugd2l0aCBpdHNlbGYnKTtcbiAgICB9XG4gICAgdmFyIGlzT2JqID0gaXNPYmplY3QodmFsdWUpO1xuICAgIGlmIChpc09iaiAmJiB2YWx1ZSBpbnN0YW5jZW9mIHByb21pc2UuY29uc3RydWN0b3IpIHtcbiAgICAgIGFkb3B0KHByb21pc2UsIHZhbHVlLl9zdGF0ZSwgdmFsdWUuX3ZhbHVlLCB2YWx1ZSk7XG4gICAgfSBlbHNlIGlmIChpc09iaiAmJiAodGhlbiA9IHZhbHVlLnRoZW4pICYmIGlzRnVuY3Rpb24odGhlbikpIHtcbiAgICAgIF9yZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgX3Jlc29sdmUgPSBfcmVqZWN0ID0gbm9vcDtcbiAgICAgICAgZG9SZXNvbHZlKHByb21pc2UsIHJlc29sdmUsIHJlamVjdCwgdmFsdWUsIHZhbHVlKTtcbiAgICAgIH07XG4gICAgICBfcmVqZWN0ID0gZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgIF9yZXNvbHZlID0gX3JlamVjdCA9IG5vb3A7XG4gICAgICAgIHJlamVjdChyZWFzb24pO1xuICAgICAgfTtcbiAgICAgIHRoZW4uY2FsbChcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgZnVuY3Rpb24odmFsdWUpIHsgX3Jlc29sdmUodmFsdWUpOyB9LFxuICAgICAgICBmdW5jdGlvbihyZWFzb24pIHsgX3JlamVjdChyZWFzb24pOyB9XG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXNvbHZlKHZhbHVlKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBfcmVqZWN0KGUpO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gUHJvbWlzZTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2Rldn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtkaWN0fSBmcm9tICcuL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge2ludGVybmFsTGlzdGVuSW1wbGVtZW50YXRpb259IGZyb20gJy4vZXZlbnQtaGVscGVyLWxpc3Rlbic7XG5pbXBvcnQge3BhcnNlSnNvbn0gZnJvbSAnLi9qc29uJztcblxuXG4vKiogQGNvbnN0ICovXG5jb25zdCBBTVBfTUVTU0FHRV9QUkVGSVggPSAnYW1wLSc7XG5leHBvcnQgY29uc3QgQ09OU1RBTlRTID0ge1xuICByZXNwb25zZVR5cGVTdWZmaXg6ICctcmVzdWx0JyxcbiAgbWVzc2FnZUlkRmllbGROYW1lOiAnbWVzc2FnZUlkJyxcbiAgcGF5bG9hZEZpZWxkTmFtZTogJ3BheWxvYWQnLFxuICBjb250ZW50RmllbGROYW1lOiAnY29udGVudCcsXG59O1xuXG4vKiogQGVudW0ge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBNZXNzYWdlVHlwZSA9IHtcbiAgLy8gRm9yIGFtcC1hZFxuICBTRU5EX0VNQkVEX1NUQVRFOiAnc2VuZC1lbWJlZC1zdGF0ZScsXG4gIEVNQkVEX1NUQVRFOiAnZW1iZWQtc3RhdGUnLFxuICBTRU5EX0VNQkVEX0NPTlRFWFQ6ICdzZW5kLWVtYmVkLWNvbnRleHQnLFxuICBFTUJFRF9DT05URVhUOiAnZW1iZWQtY29udGV4dCcsXG4gIFNFTkRfSU5URVJTRUNUSU9OUzogJ3NlbmQtaW50ZXJzZWN0aW9ucycsXG4gIElOVEVSU0VDVElPTjogJ2ludGVyc2VjdGlvbicsXG4gIEVNQkVEX1NJWkU6ICdlbWJlZC1zaXplJyxcbiAgRU1CRURfU0laRV9DSEFOR0VEOiAnZW1iZWQtc2l6ZS1jaGFuZ2VkJyxcbiAgRU1CRURfU0laRV9ERU5JRUQ6ICdlbWJlZC1zaXplLWRlbmllZCcsXG4gIE5PX0NPTlRFTlQ6ICduby1jb250ZW50JyxcbiAgR0VUX0hUTUw6ICdnZXQtaHRtbCcsXG4gIEdFVF9DT05TRU5UX1NUQVRFOiAnZ2V0LWNvbnNlbnQtc3RhdGUnLFxuXG4gIC8vIEZvciB0aGUgZnJhbWUgdG8gYmUgcGxhY2VkIGluIGZ1bGwgb3ZlcmxheSBtb2RlIGZvciBsaWdodGJveGVzXG4gIEZVTExfT1ZFUkxBWV9GUkFNRTogJ2Z1bGwtb3ZlcmxheS1mcmFtZScsXG4gIEZVTExfT1ZFUkxBWV9GUkFNRV9SRVNQT05TRTogJ2Z1bGwtb3ZlcmxheS1mcmFtZS1yZXNwb25zZScsXG4gIENBTkNFTF9GVUxMX09WRVJMQVlfRlJBTUU6ICdjYW5jZWwtZnVsbC1vdmVybGF5LWZyYW1lJyxcbiAgQ0FOQ0VMX0ZVTExfT1ZFUkxBWV9GUkFNRV9SRVNQT05TRTogJ2NhbmNlbC1mdWxsLW92ZXJsYXktZnJhbWUtcmVzcG9uc2UnLFxuXG4gIC8vIEZvciBhbXAtaW5hYm94XG4gIFNFTkRfUE9TSVRJT05TOiAnc2VuZC1wb3NpdGlvbnMnLFxuICBQT1NJVElPTjogJ3Bvc2l0aW9uJyxcblxuICAvLyBGb3IgYW1wLWFuYWx5dGljcycgaWZyYW1lLXRyYW5zcG9ydFxuICBTRU5EX0lGUkFNRV9UUkFOU1BPUlRfRVZFTlRTOiAnc2VuZC1pZnJhbWUtdHJhbnNwb3J0LWV2ZW50cycsXG4gIElGUkFNRV9UUkFOU1BPUlRfRVZFTlRTOiAnaWZyYW1lLXRyYW5zcG9ydC1ldmVudHMnLFxuICBJRlJBTUVfVFJBTlNQT1JUX1JFU1BPTlNFOiAnaWZyYW1lLXRyYW5zcG9ydC1yZXNwb25zZScsXG5cbiAgLy8gRm9yIHVzZXItZXJyb3ItaW4taWZyYW1lXG4gIFVTRVJfRVJST1JfSU5fSUZSQU1FOiAndXNlci1lcnJvci1pbi1pZnJhbWUnLFxufTtcblxuLyoqXG4gKiBMaXN0ZW5zIGZvciB0aGUgc3BlY2lmaWVkIGV2ZW50IG9uIHRoZSBlbGVtZW50LlxuICogQHBhcmFtIHshRXZlbnRUYXJnZXR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUV2ZW50KX0gbGlzdGVuZXJcbiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0X2V2dExpc3RlbmVyT3B0c1xuICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGlzdGVuKGVsZW1lbnQsIGV2ZW50VHlwZSwgbGlzdGVuZXIsIG9wdF9ldnRMaXN0ZW5lck9wdHMpIHtcbiAgcmV0dXJuIGludGVybmFsTGlzdGVuSW1wbGVtZW50YXRpb24oXG4gICAgICBlbGVtZW50LCBldmVudFR5cGUsIGxpc3RlbmVyLCBvcHRfZXZ0TGlzdGVuZXJPcHRzKTtcbn1cblxuXG4vKipcbiAqIFNlcmlhbGl6ZSBhbiBBTVAgcG9zdCBtZXNzYWdlLiBPdXRwdXQgbG9va3MgbGlrZTpcbiAqICdhbXAtMDExNDgxMzIzMDk5NDkwe1widHlwZVwiOlwicG9zaXRpb25cIixcInNlbnRpbmVsXCI6XCIxMjM0NVwiLFwiZm9vXCI6XCJiYXJcIn0nXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICogQHBhcmFtIHtzdHJpbmd9IHNlbnRpbmVsXG4gKiBAcGFyYW0ge0pzb25PYmplY3Q9fSBkYXRhXG4gKiBAcGFyYW0gez9zdHJpbmc9fSBydHZWZXJzaW9uXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXJpYWxpemVNZXNzYWdlKHR5cGUsIHNlbnRpbmVsLCBkYXRhID0gZGljdCgpLFxuICBydHZWZXJzaW9uID0gbnVsbCkge1xuICAvLyBUT0RPOiBjb25zaWRlciB3cmFwIHRoZSBkYXRhIGluIGEgXCJkYXRhXCIgZmllbGQuIHsgdHlwZSwgc2VudGluYWwsIGRhdGEgfVxuICBjb25zdCBtZXNzYWdlID0gZGF0YTtcbiAgbWVzc2FnZVsndHlwZSddID0gdHlwZTtcbiAgbWVzc2FnZVsnc2VudGluZWwnXSA9IHNlbnRpbmVsO1xuICByZXR1cm4gQU1QX01FU1NBR0VfUFJFRklYICsgKHJ0dlZlcnNpb24gfHwgJycpICsgSlNPTi5zdHJpbmdpZnkobWVzc2FnZSk7XG59XG5cblxuLyoqXG4gKiBEZXNlcmlhbGl6ZSBhbiBBTVAgcG9zdCBtZXNzYWdlLlxuICogUmV0dXJucyBudWxsIGlmIGl0J3Mgbm90IHZhbGlkIEFNUCBtZXNzYWdlIGZvcm1hdC5cbiAqXG4gKiBAcGFyYW0geyp9IG1lc3NhZ2VcbiAqIEByZXR1cm4gez9Kc29uT2JqZWN0fHVuZGVmaW5lZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlc2VyaWFsaXplTWVzc2FnZShtZXNzYWdlKSB7XG4gIGlmICghaXNBbXBNZXNzYWdlKG1lc3NhZ2UpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3Qgc3RhcnRQb3MgPSBtZXNzYWdlLmluZGV4T2YoJ3snKTtcbiAgZGV2KCkuYXNzZXJ0KHN0YXJ0UG9zICE9IC0xLCAnSlNPTiBtaXNzaW5nIGluICVzJywgbWVzc2FnZSk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHBhcnNlSnNvbihtZXNzYWdlLnN1YnN0cihzdGFydFBvcykpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgZGV2KCkuZXJyb3IoJ01FU1NBR0lORycsICdGYWlsZWQgdG8gcGFyc2UgbWVzc2FnZTogJyArIG1lc3NhZ2UsIGUpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cblxuLyoqXG4gKiAgUmV0dXJucyB0cnVlIGlmIG1lc3NhZ2UgbG9va3MgbGlrZSBpdCBpcyBhbiBBTVAgcG9zdE1lc3NhZ2VcbiAqICBAcGFyYW0geyp9IG1lc3NhZ2VcbiAqICBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBbXBNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgcmV0dXJuICh0eXBlb2YgbWVzc2FnZSA9PSAnc3RyaW5nJyAmJlxuICAgICAgbWVzc2FnZS5pbmRleE9mKEFNUF9NRVNTQUdFX1BSRUZJWCkgPT0gMCAmJlxuICAgICAgbWVzc2FnZS5pbmRleE9mKCd7JykgIT0gLTEpO1xufVxuXG4vKiogQHR5cGVkZWYge3tjcmVhdGl2ZUlkOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZ319ICovXG5leHBvcnQgbGV0IElmcmFtZVRyYW5zcG9ydEV2ZW50O1xuLy8gQW4gZXZlbnQsIGFuZCB0aGUgdHJhbnNwb3J0IElEIG9mIHRoZSBhbXAtYW5hbHl0aWNzIHRhZ3MgdGhhdFxuLy8gZ2VuZXJhdGVkIGl0LiBGb3IgaW5zdGFuY2UgaWYgdGhlIGNyZWF0aXZlIHdpdGggdHJhbnNwb3J0XG4vLyBJRCAyIHNlbmRzIFwiaGlcIiwgdGhlbiBhbiBJZnJhbWVUcmFuc3BvcnRFdmVudCB3b3VsZCBsb29rIGxpa2U6XG4vLyB7IGNyZWF0aXZlSWQ6IFwiMlwiLCBtZXNzYWdlOiBcImhpXCIgfVxuLy8gSWYgdGhlIGNyZWF0aXZlIHdpdGggdHJhbnNwb3J0IElEIDIgc2VudCB0aGF0LCBhbmQgYWxzbyBzZW50IFwiaGVsbG9cIixcbi8vIGFuZCB0aGUgY3JlYXRpdmUgd2l0aCB0cmFuc3BvcnQgSUQgMyBzZW5kcyBcImdvb2RieWVcIiB0aGVuIGFuICphcnJheSogb2YgM1xuLy8gQW1wQW5hbHl0aWNzSWZyYW1lVHJhbnNwb3J0RXZlbnQgd291bGQgYmUgc2VudCB0byB0aGUgM3AgZnJhbWUgbGlrZSBzbzpcbi8vIFtcbi8vICAgeyBjcmVhdGl2ZUlkOiBcIjJcIiwgbWVzc2FnZTogXCJoaVwiIH0sIC8vIEFuIEFtcEFuYWx5dGljc0lmcmFtZVRyYW5zcG9ydEV2ZW50XG4vLyAgIHsgY3JlYXRpdmVJZDogXCIyXCIsIG1lc3NhZ2U6IFwiaGVsbG9cIiB9LCAvLyBBbm90aGVyXG4vLyAgIHsgY3JlYXRpdmVJZDogXCIzXCIsIG1lc3NhZ2U6IFwiZ29vZGJ5ZVwiIH0gLy8gQW5kIGFub3RoZXJcbi8vIF1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2Fzc2VydEh0dHBzVXJsLCBwYXJzZVVybERlcHJlY2F0ZWR9IGZyb20gJy4vdXJsJztcbmltcG9ydCB7ZGV2LCB1c2VyfSBmcm9tICcuL2xvZyc7XG5pbXBvcnQge2RpY3R9IGZyb20gJy4vdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7Z2V0Q29udGV4dE1ldGFkYXRhfSBmcm9tICcuLi9zcmMvaWZyYW1lLWF0dHJpYnV0ZXMnO1xuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuL21vZGUnO1xuaW1wb3J0IHtpc0V4cGVyaW1lbnRPbn0gZnJvbSAnLi9leHBlcmltZW50cyc7XG5pbXBvcnQge3NldFN0eWxlfSBmcm9tICcuL3N0eWxlJztcbmltcG9ydCB7c3RhcnRzV2l0aH0gZnJvbSAnLi9zdHJpbmcnO1xuaW1wb3J0IHt0cnlQYXJzZUpzb259IGZyb20gJy4vanNvbic7XG5pbXBvcnQge3VybHN9IGZyb20gJy4vY29uZmlnJztcblxuLyoqIEB0eXBlIHshT2JqZWN0PHN0cmluZyxudW1iZXI+fSBOdW1iZXIgb2YgM3AgZnJhbWVzIG9uIHRoZSBmb3IgdGhhdCB0eXBlLiAqL1xubGV0IGNvdW50ID0ge307XG5cbi8qKiBAdHlwZSB7c3RyaW5nfSAqL1xubGV0IG92ZXJyaWRlQm9vdHN0cmFwQmFzZVVybDtcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgVEFHID0gJzNwLWZyYW1lJztcblxuLyoqXG4gKiBQcm9kdWNlcyB0aGUgYXR0cmlidXRlcyBmb3IgdGhlIGFkIHRlbXBsYXRlLlxuICogQHBhcmFtIHshV2luZG93fSBwYXJlbnRXaW5kb3dcbiAqIEBwYXJhbSB7IUFtcEVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X3R5cGVcbiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0X2NvbnRleHRcbiAqIEByZXR1cm4geyFKc29uT2JqZWN0fSBDb250YWluc1xuICogICAgIC0gdHlwZSwgd2lkdGgsIGhlaWdodCwgc3JjIGF0dHJpYnV0ZXMgb2YgPGFtcC1hZD4gdGFnLiBUaGVzZSBoYXZlXG4gKiAgICAgICBwcmVjZWRlbmNlIG92ZXIgdGhlIGRhdGEtIGF0dHJpYnV0ZXMuXG4gKiAgICAgLSBkYXRhLSogYXR0cmlidXRlcyBvZiB0aGUgPGFtcC1hZD4gdGFnIHdpdGggdGhlIFwiZGF0YS1cIiByZW1vdmVkLlxuICogICAgIC0gQSBfY29udGV4dCBvYmplY3QgZm9yIGludGVybmFsIHVzZS5cbiAqL1xuZnVuY3Rpb24gZ2V0RnJhbWVBdHRyaWJ1dGVzKHBhcmVudFdpbmRvdywgZWxlbWVudCwgb3B0X3R5cGUsIG9wdF9jb250ZXh0KSB7XG4gIGNvbnN0IHR5cGUgPSBvcHRfdHlwZSB8fCBlbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpO1xuICB1c2VyKCkuYXNzZXJ0KHR5cGUsICdBdHRyaWJ1dGUgdHlwZSByZXF1aXJlZCBmb3IgPGFtcC1hZD46ICVzJywgZWxlbWVudCk7XG4gIGNvbnN0IHNlbnRpbmVsID0gZ2VuZXJhdGVTZW50aW5lbChwYXJlbnRXaW5kb3cpO1xuICBsZXQgYXR0cmlidXRlcyA9IGRpY3QoKTtcbiAgLy8gRG8gdGhlc2UgZmlyc3QsIGFzIHRoZSBvdGhlciBhdHRyaWJ1dGVzIGhhdmUgcHJlY2VkZW5jZS5cbiAgYWRkRGF0YUFuZEpzb25BdHRyaWJ1dGVzXyhlbGVtZW50LCBhdHRyaWJ1dGVzKTtcbiAgYXR0cmlidXRlcyA9IGdldENvbnRleHRNZXRhZGF0YShwYXJlbnRXaW5kb3csIGVsZW1lbnQsIHNlbnRpbmVsLFxuICAgICAgYXR0cmlidXRlcyk7XG4gIGF0dHJpYnV0ZXNbJ3R5cGUnXSA9IHR5cGU7XG4gIE9iamVjdC5hc3NpZ24oYXR0cmlidXRlc1snX2NvbnRleHQnXSwgb3B0X2NvbnRleHQpO1xuICByZXR1cm4gYXR0cmlidXRlcztcbn1cblxuLyoqXG4gKiBDcmVhdGVzIHRoZSBpZnJhbWUgZm9yIHRoZSBlbWJlZC4gQXBwbGllcyBjb3JyZWN0IHNpemUgYW5kIHBhc3NlcyB0aGUgZW1iZWRcbiAqIGF0dHJpYnV0ZXMgdG8gdGhlIGZyYW1lIHZpYSBKU09OIGluc2lkZSB0aGUgZnJhZ21lbnQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHBhcmVudFdpbmRvd1xuICogQHBhcmFtIHshQW1wRWxlbWVudH0gcGFyZW50RWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfdHlwZVxuICogQHBhcmFtIHtPYmplY3Q9fSBvcHRfY29udGV4dFxuICogQHBhcmFtIHshe1xuICogICBkaXNhbGxvd0N1c3RvbSxcbiAqICAgYWxsb3dGdWxsc2NyZWVuLFxuICogfT19IG9wdF9vcHRpb25zIE9wdGlvbnMgZm9yIHRoZSBjcmVhdGVkIGlmcmFtZS5cbiAqIEByZXR1cm4geyFFbGVtZW50fSBUaGUgaWZyYW1lLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0SWZyYW1lKFxuICBwYXJlbnRXaW5kb3csIHBhcmVudEVsZW1lbnQsIG9wdF90eXBlLCBvcHRfY29udGV4dCxcbiAge2Rpc2FsbG93Q3VzdG9tLCBhbGxvd0Z1bGxzY3JlZW59ID0ge30pIHtcbiAgLy8gQ2hlY2sgdGhhdCB0aGUgcGFyZW50RWxlbWVudCBpcyBhbHJlYWR5IGluIERPTS4gVGhpcyBjb2RlIHVzZXMgYSBuZXcgYW5kXG4gIC8vIGZhc3QgYGlzQ29ubmVjdGVkYCBBUEkgYW5kIHRodXMgb25seSB1c2VkIHdoZW4gaXQncyBhdmFpbGFibGUuXG4gIGRldigpLmFzc2VydChcbiAgICAgIHBhcmVudEVsZW1lbnRbJ2lzQ29ubmVjdGVkJ10gPT09IHVuZGVmaW5lZCB8fFxuICAgICAgcGFyZW50RWxlbWVudFsnaXNDb25uZWN0ZWQnXSA9PT0gdHJ1ZSxcbiAgICAgICdQYXJlbnQgZWxlbWVudCBtdXN0IGJlIGluIERPTScpO1xuICBjb25zdCBhdHRyaWJ1dGVzID1cbiAgICAgIGdldEZyYW1lQXR0cmlidXRlcyhwYXJlbnRXaW5kb3csIHBhcmVudEVsZW1lbnQsIG9wdF90eXBlLCBvcHRfY29udGV4dCk7XG4gIGNvbnN0IGlmcmFtZSA9IHBhcmVudFdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcblxuICBpZiAoIWNvdW50W2F0dHJpYnV0ZXNbJ3R5cGUnXV0pIHtcbiAgICBjb3VudFthdHRyaWJ1dGVzWyd0eXBlJ11dID0gMDtcbiAgfVxuICBjb3VudFthdHRyaWJ1dGVzWyd0eXBlJ11dICs9IDE7XG5cbiAgY29uc3QgYmFzZVVybCA9IGdldEJvb3RzdHJhcEJhc2VVcmwoXG4gICAgICBwYXJlbnRXaW5kb3csIHVuZGVmaW5lZCwgb3B0X3R5cGUsIGRpc2FsbG93Q3VzdG9tKTtcbiAgY29uc3QgaG9zdCA9IHBhcnNlVXJsRGVwcmVjYXRlZChiYXNlVXJsKS5ob3N0bmFtZTtcbiAgLy8gVGhpcyBuYW1lIGF0dHJpYnV0ZSBtYXkgYmUgb3ZlcndyaXR0ZW4gaWYgdGhpcyBmcmFtZSBpcyBjaG9zZW4gdG9cbiAgLy8gYmUgdGhlIG1hc3RlciBmcmFtZS4gVGhhdCBpcyBvaywgYXMgd2Ugd2lsbCByZWFkIHRoZSBuYW1lIG9mZlxuICAvLyBmb3Igb3VyIHVzZXMgYmVmb3JlIHRoYXQgd291bGQgb2NjdXIuXG4gIC8vIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2FtcHByb2plY3QvYW1waHRtbC9ibG9iL21hc3Rlci8zcC9pbnRlZ3JhdGlvbi5qc1xuICBjb25zdCBuYW1lID0gSlNPTi5zdHJpbmdpZnkoZGljdCh7XG4gICAgJ2hvc3QnOiBob3N0LFxuICAgICd0eXBlJzogYXR0cmlidXRlc1sndHlwZSddLFxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hbXBwcm9qZWN0L2FtcGh0bWwvcHVsbC8yOTU1XG4gICAgJ2NvdW50JzogY291bnRbYXR0cmlidXRlc1sndHlwZSddXSxcbiAgICAnYXR0cmlidXRlcyc6IGF0dHJpYnV0ZXMsXG4gIH0pKTtcblxuICBpZnJhbWUuc3JjID0gYmFzZVVybDtcbiAgaWZyYW1lLmFtcExvY2F0aW9uID0gcGFyc2VVcmxEZXByZWNhdGVkKGJhc2VVcmwpO1xuICBpZnJhbWUubmFtZSA9IG5hbWU7XG4gIC8vIEFkZCB0aGUgY2hlY2sgYmVmb3JlIGFzc2lnbmluZyB0byBwcmV2ZW50IElFIHRocm93IEludmFsaWQgYXJndW1lbnQgZXJyb3JcbiAgaWYgKGF0dHJpYnV0ZXNbJ3dpZHRoJ10pIHtcbiAgICBpZnJhbWUud2lkdGggPSBhdHRyaWJ1dGVzWyd3aWR0aCddO1xuICB9XG4gIGlmIChhdHRyaWJ1dGVzWydoZWlnaHQnXSkge1xuICAgIGlmcmFtZS5oZWlnaHQgPSBhdHRyaWJ1dGVzWydoZWlnaHQnXTtcbiAgfVxuICBpZiAoYXR0cmlidXRlc1sndGl0bGUnXSkge1xuICAgIGlmcmFtZS50aXRsZSA9IGF0dHJpYnV0ZXNbJ3RpdGxlJ107XG4gIH1cbiAgaWYgKGFsbG93RnVsbHNjcmVlbikge1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2FsbG93ZnVsbHNjcmVlbicsICd0cnVlJyk7XG4gIH1cbiAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnc2Nyb2xsaW5nJywgJ25vJyk7XG4gIHNldFN0eWxlKGlmcmFtZSwgJ2JvcmRlcicsICdub25lJyk7XG4gIC8qKiBAdGhpcyB7IUVsZW1lbnR9ICovXG4gIGlmcmFtZS5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAvLyBDaHJvbWUgZG9lcyBub3QgcmVmbGVjdCB0aGUgaWZyYW1lIHJlYWR5c3RhdGUuXG4gICAgdGhpcy5yZWFkeVN0YXRlID0gJ2NvbXBsZXRlJztcbiAgfTtcbiAgaWYgKGlzRXhwZXJpbWVudE9uKHBhcmVudFdpbmRvdywgJ25vLXN5bmMteGhyLWluLWFkcycpKSB7XG4gICAgLy8gQmxvY2sgc3luY2hyb25vdXMgWEhSIGluIGFkLiBUaGVzZSBhcmUgdmVyeSByYXJlLCBidXQgc3VwZXIgYmFkIGZvciBVWFxuICAgIC8vIGFzIHRoZXkgYmxvY2sgdGhlIFVJIHRocmVhZCBmb3IgdGhlIGFyYml0cmFyeSBhbW91bnQgb2YgdGltZSB1bnRpbCB0aGVcbiAgICAvLyByZXF1ZXN0IGNvbXBsZXRlcy5cbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdhbGxvdycsICdzeW5jLXhociBcXCdub25lXFwnOycpO1xuICB9XG4gIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtYW1wLTNwLXNlbnRpbmVsJyxcbiAgICAgIGF0dHJpYnV0ZXNbJ19jb250ZXh0J11bJ3NlbnRpbmVsJ10pO1xuICByZXR1cm4gaWZyYW1lO1xufVxuXG4vKipcbiAqIENvcGllcyBkYXRhLSBhdHRyaWJ1dGVzIGZyb20gdGhlIGVsZW1lbnQgaW50byB0aGUgYXR0cmlidXRlcyBvYmplY3QuXG4gKiBSZW1vdmVzIHRoZSBkYXRhLSBmcm9tIHRoZSBuYW1lIGFuZCBjYXBpdGFsaXplcyBhZnRlciAtLiBJZiB0aGVyZVxuICogaXMgYW4gYXR0cmlidXRlIGNhbGxlZCBqc29uLCBwYXJzZXMgdGhlIEpTT04gYW5kIGFkZHMgaXQgdG8gdGhlXG4gKiBhdHRyaWJ1dGVzLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHshSnNvbk9iamVjdH0gYXR0cmlidXRlcyBUaGUgZGVzdGluYXRpb24uXG4gKiB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkRGF0YUFuZEpzb25BdHRyaWJ1dGVzXyhlbGVtZW50LCBhdHRyaWJ1dGVzKSB7XG4gIGNvbnN0IHtkYXRhc2V0fSA9IGVsZW1lbnQ7XG4gIGZvciAoY29uc3QgbmFtZSBpbiBkYXRhc2V0KSB7XG4gICAgLy8gZGF0YS12YXJzLSBpcyByZXNlcnZlZCBmb3IgYW1wLWFuYWx5dGljc1xuICAgIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vYW1wcHJvamVjdC9hbXBodG1sL2Jsb2IvbWFzdGVyL2V4dGVuc2lvbnMvYW1wLWFuYWx5dGljcy9hbmFseXRpY3MtdmFycy5tZCN2YXJpYWJsZXMtYXMtZGF0YS1hdHRyaWJ1dGVcbiAgICBpZiAoIXN0YXJ0c1dpdGgobmFtZSwgJ3ZhcnMnKSkge1xuICAgICAgYXR0cmlidXRlc1tuYW1lXSA9IGRhdGFzZXRbbmFtZV07XG4gICAgfVxuICB9XG4gIGNvbnN0IGpzb24gPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnanNvbicpO1xuICBpZiAoanNvbikge1xuICAgIGNvbnN0IG9iaiA9IHRyeVBhcnNlSnNvbihqc29uKTtcbiAgICBpZiAob2JqID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IHVzZXIoKS5jcmVhdGVFcnJvcihcbiAgICAgICAgICAnRXJyb3IgcGFyc2luZyBKU09OIGluIGpzb24gYXR0cmlidXRlIGluIGVsZW1lbnQgJXMnLFxuICAgICAgICAgIGVsZW1lbnQpO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcbiAgICAgIGF0dHJpYnV0ZXNba2V5XSA9IG9ialtrZXldO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIFByZWxvYWRzIFVSTHMgcmVsYXRlZCB0byB0aGUgYm9vdHN0cmFwIGlmcmFtZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyEuL3ByZWNvbm5lY3QuUHJlY29ubmVjdH0gcHJlY29ubmVjdFxuICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfdHlwZVxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2Rpc2FsbG93Q3VzdG9tIHdoZXRoZXIgM3AgdXJsIHNob3VsZCBub3QgdXNlIG1ldGEgdGFnLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcHJlbG9hZEJvb3RzdHJhcChcbiAgd2luLCBwcmVjb25uZWN0LCBvcHRfdHlwZSwgb3B0X2Rpc2FsbG93Q3VzdG9tKSB7XG4gIGNvbnN0IHVybCA9IGdldEJvb3RzdHJhcEJhc2VVcmwod2luLCB1bmRlZmluZWQsIG9wdF90eXBlLCBvcHRfZGlzYWxsb3dDdXN0b20pO1xuICBwcmVjb25uZWN0LnByZWxvYWQodXJsLCAnZG9jdW1lbnQnKTtcblxuICAvLyBXaGlsZSB0aGUgVVJMIG1heSBwb2ludCB0byBhIGN1c3RvbSBkb21haW4sIHRoaXMgVVJMIHdpbGwgYWx3YXlzIGJlXG4gIC8vIGZldGNoZWQgYnkgaXQuXG4gIGNvbnN0IHNjcmlwdFVybCA9IGdldE1vZGUoKS5sb2NhbERldlxuICAgID8gZ2V0QWRzTG9jYWxob3N0KHdpbikgKyAnL2Rpc3QuM3AvY3VycmVudC9pbnRlZ3JhdGlvbi5qcydcbiAgICA6IGAke3VybHMudGhpcmRQYXJ0eX0vJGludGVybmFsUnVudGltZVZlcnNpb24kL2YuanNgO1xuICBwcmVjb25uZWN0LnByZWxvYWQoc2NyaXB0VXJsLCAnc2NyaXB0Jyk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgYmFzZSBVUkwgZm9yIDNwIGJvb3RzdHJhcCBpZnJhbWVzLlxuICogQHBhcmFtIHshV2luZG93fSBwYXJlbnRXaW5kb3dcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9zdHJpY3RGb3JVbml0VGVzdFxuICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfdHlwZVxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2Rpc2FsbG93Q3VzdG9tIHdoZXRoZXIgM3AgdXJsIHNob3VsZCBub3QgdXNlIG1ldGEgdGFnLlxuICogQHJldHVybiB7c3RyaW5nfVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRCb290c3RyYXBCYXNlVXJsKFxuICBwYXJlbnRXaW5kb3csIG9wdF9zdHJpY3RGb3JVbml0VGVzdCwgb3B0X3R5cGUsIG9wdF9kaXNhbGxvd0N1c3RvbSkge1xuICAvLyBUaGUgdmFsdWUgaXMgY2FjaGVkIGluIGEgZ2xvYmFsIHZhcmlhYmxlIGNhbGxlZCBgYm9vdHN0cmFwQmFzZVVybGA7XG4gIGNvbnN0IHtib290c3RyYXBCYXNlVXJsfSA9IHBhcmVudFdpbmRvdztcbiAgaWYgKGJvb3RzdHJhcEJhc2VVcmwpIHtcbiAgICByZXR1cm4gYm9vdHN0cmFwQmFzZVVybDtcbiAgfVxuICByZXR1cm4gcGFyZW50V2luZG93LmJvb3RzdHJhcEJhc2VVcmwgPSBnZXRDdXN0b21Cb290c3RyYXBCYXNlVXJsKFxuICAgICAgcGFyZW50V2luZG93LCBvcHRfc3RyaWN0Rm9yVW5pdFRlc3QsIG9wdF90eXBlLCBvcHRfZGlzYWxsb3dDdXN0b20pIHx8XG4gICAgICBnZXREZWZhdWx0Qm9vdHN0cmFwQmFzZVVybChwYXJlbnRXaW5kb3cpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldERlZmF1bHRCb290c3RyYXBCYXNlVXJsRm9yVGVzdGluZyh1cmwpIHtcbiAgb3ZlcnJpZGVCb290c3RyYXBCYXNlVXJsID0gdXJsO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7Kn0gd2luXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldEJvb3RzdHJhcEJhc2VVcmxGb3JUZXN0aW5nKHdpbikge1xuICB3aW4uYm9vdHN0cmFwQmFzZVVybCA9IHVuZGVmaW5lZDtcbiAgd2luLmRlZmF1bHRCb290c3RyYXBTdWJEb21haW4gPSB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZGVmYXVsdCBiYXNlIFVSTCBmb3IgM3AgYm9vdHN0cmFwIGlmcmFtZXMuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHBhcmVudFdpbmRvd1xuICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfc3JjRmlsZUJhc2VuYW1lXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0Qm9vdHN0cmFwQmFzZVVybChwYXJlbnRXaW5kb3csIG9wdF9zcmNGaWxlQmFzZW5hbWUpIHtcbiAgY29uc3Qgc3JjRmlsZUJhc2VuYW1lID0gb3B0X3NyY0ZpbGVCYXNlbmFtZSB8fCAnZnJhbWUnO1xuICBpZiAoZ2V0TW9kZSgpLmxvY2FsRGV2IHx8IGdldE1vZGUoKS50ZXN0KSB7XG4gICAgcmV0dXJuIG92ZXJyaWRlQm9vdHN0cmFwQmFzZVVybCB8fCBnZXRBZHNMb2NhbGhvc3QocGFyZW50V2luZG93KVxuICAgICAgICAgICsgJy9kaXN0LjNwLydcbiAgICAgICAgICArIChnZXRNb2RlKCkubWluaWZpZWQgPyBgJGludGVybmFsUnVudGltZVZlcnNpb24kLyR7c3JjRmlsZUJhc2VuYW1lfWBcbiAgICAgICAgICAgIDogYGN1cnJlbnQvJHtzcmNGaWxlQmFzZW5hbWV9Lm1heGApXG4gICAgICAgICAgKyAnLmh0bWwnO1xuICB9XG4gIC8vIEVuc3VyZSBzYW1lIHN1Yi1kb21haW4gaXMgdXNlZCBkZXNwaXRlIHBvdGVudGlhbGx5IGRpZmZlcmVudCBmaWxlLlxuICBwYXJlbnRXaW5kb3cuZGVmYXVsdEJvb3RzdHJhcFN1YkRvbWFpbiA9XG4gICAgICBwYXJlbnRXaW5kb3cuZGVmYXVsdEJvb3RzdHJhcFN1YkRvbWFpbiB8fCBnZXRTdWJEb21haW4ocGFyZW50V2luZG93KTtcbiAgcmV0dXJuICdodHRwczovLycgKyBwYXJlbnRXaW5kb3cuZGVmYXVsdEJvb3RzdHJhcFN1YkRvbWFpbiArXG4gICAgICBgLiR7dXJscy50aGlyZFBhcnR5RnJhbWVIb3N0fS8kaW50ZXJuYWxSdW50aW1lVmVyc2lvbiQvYCArXG4gICAgICBgJHtzcmNGaWxlQmFzZW5hbWV9Lmh0bWxgO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGdldEFkc0xvY2FsaG9zdCh3aW4pIHtcbiAgbGV0IGFkc1VybCA9IHVybHMudGhpcmRQYXJ0eTsgLy8gbG9jYWwgZGV2IHdpdGggYSBub24tbG9jYWxob3N0IHNlcnZlclxuICBpZiAoYWRzVXJsLmluZGV4T2YoJ2FtcHByb2plY3QubmV0JykgPiAtMSkge1xuICAgIGFkc1VybCA9ICdodHRwOi8vYWRzLmxvY2FsaG9zdCc7IC8vIGxvY2FsIGRldiB3aXRoIGEgbG9jYWxob3N0IHNlcnZlclxuICB9XG4gIHJldHVybiBhZHNVcmwgKyAnOicgKyAod2luLmxvY2F0aW9uLnBvcnQgfHwgd2luLnBhcmVudC5sb2NhdGlvbi5wb3J0KTtcbn1cblxuLyoqXG4gKiBTdWIgZG9tYWluIG9uIHdoaWNoIHRoZSAzcCBpZnJhbWUgd2lsbCBiZSBob3N0ZWQuXG4gKiBCZWNhdXNlIHdlIG9ubHkgY2FsY3VsYXRlIHRoZSBVUkwgb25jZSBwZXIgcGFnZSwgdGhpcyBmdW5jdGlvbiBpcyBvbmx5XG4gKiBjYWxsZWQgb25jZSBhbmQgaGVuY2UgYWxsIGZyYW1lcyBvbiBhIHBhZ2UgdXNlIHRoZSBzYW1lIFVSTC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFN1YkRvbWFpbih3aW4pIHtcbiAgcmV0dXJuICdkLScgKyBnZXRSYW5kb20od2luKTtcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZXMgYSByYW5kb20gbm9uLW5lZ2F0aXZlIGludGVnZXIuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmFuZG9tKHdpbikge1xuICBsZXQgcmFuZDtcbiAgaWYgKHdpbi5jcnlwdG8gJiYgd2luLmNyeXB0by5nZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAvLyBCeSBkZWZhdWx0IHVzZSAyIDMyIGJpdCBpbnRlZ2Vycy5cbiAgICBjb25zdCB1aW50MzJhcnJheSA9IG5ldyBVaW50MzJBcnJheSgyKTtcbiAgICB3aW4uY3J5cHRvLmdldFJhbmRvbVZhbHVlcyh1aW50MzJhcnJheSk7XG4gICAgcmFuZCA9IFN0cmluZyh1aW50MzJhcnJheVswXSkgKyB1aW50MzJhcnJheVsxXTtcbiAgfSBlbHNlIHtcbiAgICAvLyBGYWxsIGJhY2sgdG8gTWF0aC5yYW5kb20uXG4gICAgcmFuZCA9IFN0cmluZyh3aW4uTWF0aC5yYW5kb20oKSkuc3Vic3RyKDIpICsgJzAnO1xuICB9XG4gIHJldHVybiByYW5kO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGN1c3RvbSBiYXNlIFVSTCBmb3IgM3AgYm9vdHN0cmFwIGlmcmFtZXMgaWYgaXQgZXhpc3RzLlxuICogT3RoZXJ3aXNlIG51bGwuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHBhcmVudFdpbmRvd1xuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X3N0cmljdEZvclVuaXRUZXN0XG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF90eXBlXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZGlzYWxsb3dDdXN0b20gd2hldGhlciAzcCB1cmwgc2hvdWxkIG5vdCB1c2UgbWV0YSB0YWcuXG4gKiBAcmV0dXJuIHs/c3RyaW5nfVxuICovXG5mdW5jdGlvbiBnZXRDdXN0b21Cb290c3RyYXBCYXNlVXJsKFxuICBwYXJlbnRXaW5kb3csIG9wdF9zdHJpY3RGb3JVbml0VGVzdCwgb3B0X3R5cGUsIG9wdF9kaXNhbGxvd0N1c3RvbSkge1xuICBjb25zdCBtZXRhID0gcGFyZW50V2luZG93LmRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPVwiYW1wLTNwLWlmcmFtZS1zcmNcIl0nKTtcbiAgaWYgKCFtZXRhKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgaWYgKG9wdF9kaXNhbGxvd0N1c3RvbSkge1xuICAgIHVzZXIoKS5lcnJvcihUQUcsIGAzcCBpZnJhbWUgdXJsIGRpc2FibGVkIGZvciAke29wdF90eXBlIHx8ICd1bmtub3duJ31gKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCB1cmwgPSBhc3NlcnRIdHRwc1VybChtZXRhLmdldEF0dHJpYnV0ZSgnY29udGVudCcpLCBtZXRhKTtcbiAgdXNlcigpLmFzc2VydCh1cmwuaW5kZXhPZignPycpID09IC0xLFxuICAgICAgJzNwIGlmcmFtZSB1cmwgbXVzdCBub3QgaW5jbHVkZSBxdWVyeSBzdHJpbmcgJXMgaW4gZWxlbWVudCAlcy4nLFxuICAgICAgdXJsLCBtZXRhKTtcbiAgLy8gVGhpcyBpcyBub3QgYSBzZWN1cml0eSBwcmltaXRpdmUsIHdlIGp1c3QgZG9uJ3Qgd2FudCB0aGlzIHRvIGhhcHBlbiBpblxuICAvLyBwcmFjdGljZS4gUGVvcGxlIGNvdWxkIHN0aWxsIHJlZGlyZWN0IHRvIHRoZSBzYW1lIG9yaWdpbiwgYnV0IHRoZXkgY2Fubm90XG4gIC8vIHJlZGlyZWN0IHRvIHRoZSBwcm94eSBvcmlnaW4gd2hpY2ggaXMgdGhlIGltcG9ydGFudCBvbmUuXG4gIGNvbnN0IHBhcnNlZCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICB1c2VyKCkuYXNzZXJ0KChwYXJzZWQuaG9zdG5hbWUgPT0gJ2xvY2FsaG9zdCcgJiYgIW9wdF9zdHJpY3RGb3JVbml0VGVzdCkgfHxcbiAgICAgIHBhcnNlZC5vcmlnaW4gIT0gcGFyc2VVcmxEZXByZWNhdGVkKHBhcmVudFdpbmRvdy5sb2NhdGlvbi5ocmVmKS5vcmlnaW4sXG4gICczcCBpZnJhbWUgdXJsIG11c3Qgbm90IGJlIG9uIHRoZSBzYW1lIG9yaWdpbiBhcyB0aGUgY3VycmVudCBkb2N1bWVudCAnICtcbiAgICAgICclcyAoJXMpIGluIGVsZW1lbnQgJXMuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vYW1wcHJvamVjdC9hbXBodG1sJyArXG4gICAgICAnL2Jsb2IvbWFzdGVyL3NwZWMvYW1wLWlmcmFtZS1vcmlnaW4tcG9saWN5Lm1kIGZvciBkZXRhaWxzLicsIHVybCxcbiAgcGFyc2VkLm9yaWdpbiwgbWV0YSk7XG4gIHJldHVybiB1cmwgKyAnPyRpbnRlcm5hbFJ1bnRpbWVWZXJzaW9uJCc7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHJhbmRvbWl6ZWQgc2VudGluZWwgdmFsdWUgZm9yIDNwIGlmcmFtZXMuXG4gKiBUaGUgZm9ybWF0IGlzIFwiJWQtJWRcIiB3aXRoIHRoZSBmaXJzdCB2YWx1ZSBiZWluZyB0aGUgZGVwdGggb2YgY3VycmVudFxuICogd2luZG93IGluIHRoZSB3aW5kb3cgaGllcmFyY2h5IGFuZCB0aGUgc2Vjb25kIGEgcmFuZG9tIGludGVnZXIuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHBhcmVudFdpbmRvd1xuICogQHJldHVybiB7c3RyaW5nfVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVNlbnRpbmVsKHBhcmVudFdpbmRvdykge1xuICBsZXQgd2luZG93RGVwdGggPSAwO1xuICBmb3IgKGxldCB3aW4gPSBwYXJlbnRXaW5kb3c7IHdpbiAmJiB3aW4gIT0gd2luLnBhcmVudDsgd2luID0gd2luLnBhcmVudCkge1xuICAgIHdpbmRvd0RlcHRoKys7XG4gIH1cbiAgcmV0dXJuIFN0cmluZyh3aW5kb3dEZXB0aCkgKyAnLScgKyBnZXRSYW5kb20ocGFyZW50V2luZG93KTtcbn1cblxuLyoqXG4gKiBSZXNldHMgdGhlIGNvdW50IG9mIGVhY2ggM3AgZnJhbWUgdHlwZVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldENvdW50Rm9yVGVzdGluZygpIHtcbiAgY291bnQgPSB7fTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuL3NlcnZpY2VzJztcbmltcG9ydCB7YWRDb25maWd9IGZyb20gJy4uL2Fkcy9fY29uZmlnJztcbmltcG9ydCB7ZGV2fSBmcm9tICcuLi9zcmMvbG9nJztcblxuLyoqXG4gKiBAcGFyYW0ge0FNUC5CYXNlRWxlbWVudH0gYWRFbGVtZW50XG4gKiBAcmV0dXJuIHshUHJvbWlzZTxzdHJpbmd8dW5kZWZpbmVkPn0gQSBwcm9taXNlIGZvciBhIENJRCBvciB1bmRlZmluZWQgaWZcbiAqICAgICAtIHRoZSBhZCBuZXR3b3JrIGRvZXMgbm90IHJlcXVlc3Qgb25lIG9yXG4gKiAgICAgLSBgYW1wLWFuYWx5dGljc2Agd2hpY2ggcHJvdmlkZXMgdGhlIENJRCBzZXJ2aWNlIHdhcyBub3QgaW5zdGFsbGVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWRDaWQoYWRFbGVtZW50KSB7XG4gIGNvbnN0IGNvbmZpZyA9IGFkQ29uZmlnW2FkRWxlbWVudC5lbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpXTtcbiAgaWYgKCFjb25maWcgfHwgIWNvbmZpZy5jbGllbnRJZFNjb3BlKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICB9XG4gIHJldHVybiBnZXRPckNyZWF0ZUFkQ2lkKGFkRWxlbWVudC5nZXRBbXBEb2MoKSwgY29uZmlnLmNsaWVudElkU2NvcGUsXG4gICAgICBjb25maWcuY2xpZW50SWRDb29raWVOYW1lKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBjbGllbnRJZFNjb3BlXG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF9jbGllbnRJZENvb2tpZU5hbWVcbiAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0X3RpbWVvdXRcbiAqIEByZXR1cm4geyFQcm9taXNlPHN0cmluZ3x1bmRlZmluZWQ+fSBBIHByb21pc2UgZm9yIGEgQ0lEIG9yIHVuZGVmaW5lZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE9yQ3JlYXRlQWRDaWQoXG4gIGFtcERvYywgY2xpZW50SWRTY29wZSwgb3B0X2NsaWVudElkQ29va2llTmFtZSwgb3B0X3RpbWVvdXQpIHtcbiAgY29uc3QgdGltZW91dCA9IGlzTmFOKG9wdF90aW1lb3V0KSB8fCBvcHRfdGltZW91dCA9PSBudWxsID9cbiAgICAxMDAwIDogb3B0X3RpbWVvdXQ7XG4gIGNvbnN0IGNpZFByb21pc2UgPSBTZXJ2aWNlcy5jaWRGb3JEb2MoYW1wRG9jKS50aGVuKGNpZFNlcnZpY2UgPT4ge1xuICAgIGlmICghY2lkU2VydmljZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gY2lkU2VydmljZS5nZXQoe1xuICAgICAgc2NvcGU6IGRldigpLmFzc2VydFN0cmluZyhjbGllbnRJZFNjb3BlKSxcbiAgICAgIGNyZWF0ZUNvb2tpZUlmTm90UHJlc2VudDogdHJ1ZSxcbiAgICAgIGNvb2tpZU5hbWU6IG9wdF9jbGllbnRJZENvb2tpZU5hbWUsXG4gICAgfSwgUHJvbWlzZS5yZXNvbHZlKHVuZGVmaW5lZCkpLmNhdGNoKGVycm9yID0+IHtcbiAgICAgIC8vIE5vdCBnZXR0aW5nIGEgQ0lEIGlzIG5vdCBmYXRhbC5cbiAgICAgIGRldigpLmVycm9yKCdBRC1DSUQnLCBlcnJvcik7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH0pO1xuICB9KTtcbiAgLy8gVGhlIENJRCBzaG91bGQgbmV2ZXIgYmUgY3J1Y2lhbCBmb3IgYW4gYWQuIElmIGl0IGRvZXMgbm90IGNvbWUgd2l0aGluXG4gIC8vIDEgc2Vjb25kLCBhc3N1bWUgaXQgd2lsbCBuZXZlciBhcnJpdmUuXG4gIHJldHVybiBTZXJ2aWNlcy50aW1lckZvcihhbXBEb2Mud2luKVxuICAgICAgLnRpbWVvdXRQcm9taXNlKHRpbWVvdXQsIGNpZFByb21pc2UsICdjaWQgdGltZW91dCcpLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgLy8gVGltZW91dCBpcyBub3QgZmF0YWwuXG4gICAgICAgIGRldigpLndhcm4oJ0FELUNJRCcsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIH0pO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7Y29tcHV0ZWRTdHlsZX0gZnJvbSAnLi9zdHlsZSc7XG5pbXBvcnQge2Rldn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtnZXRQYXJlbnRXaW5kb3dGcmFtZUVsZW1lbnR9IGZyb20gJy4vc2VydmljZSc7XG5cbmNvbnN0IEFEX0NPTlRBSU5FUl9QUk9QID0gJ19fQU1QX19BRF9DT05UQUlORVInO1xuXG4vKipcbiAqIFRhZ3MgdGhhdCBhcmUgYWxsb3dlZCB0byBoYXZlIGZpeGVkIHBvc2l0aW9uaW5nXG4gKiBAY29uc3QgeyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPn1cbiAqL1xuY29uc3QgQ09OVEFJTkVSUyA9IHtcbiAgJ0FNUC1GWC1GTFlJTkctQ0FSUEVUJzogdHJ1ZSxcbiAgJ0FNUC1MSUdIVEJPWCc6IHRydWUsXG4gICdBTVAtU1RJQ0tZLUFEJzogdHJ1ZSxcbiAgJ0FNUC1MSUdIVEJPWC1HQUxMRVJZJzogdHJ1ZSxcbn07XG5cbi8qKlxuICogRGV0ZXJtaW5lcyBpZiBhbiBlbGVtZW50IGlzIGZpeGVkLXBvc2l0aW9uZWQuXG4gKiBPSyB0byB1c2UsIGJlY2F1c2UgaXQncyBvbmx5IGNhbGxlZCBmcm9tIG9uTGF5b3V0TWVhc3VyZVxuICogQHBhcmFtIHshRWxlbWVudH0gZWxcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc1Bvc2l0aW9uRml4ZWQoZWwsIHdpbikge1xuICBjb25zdCB7cG9zaXRpb259ID0gY29tcHV0ZWRTdHlsZSh3aW4sIGVsKTtcbiAgLy8gV2UgY29uc2lkZXIgc3RpY2t5IHBvc2l0aW9ucyBhcyBmaXhlZCwgc2luY2UgdGhleSBjYW4gYmUgZml4ZWQuXG4gIHJldHVybiBwb3NpdGlvbiA9PSAnZml4ZWQnIHx8IHBvc2l0aW9uID09ICdzdGlja3knO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufSB3aGV0aGVyIHRoZSBlbGVtZW50IHBvc2l0aW9uIGlzIGFsbG93ZWQuIElmIHRoZSBlbGVtZW50XG4gKiBiZWxvbmdzIHRvIENPTlRBSU5FUlMsIGl0IGlzIGFsbG93ZWQgdG8gYmUgcG9zaXRpb24gZml4ZWQuXG4gKiBJZiB0aGUgZWxlbWVudCBoYXMgYSBwb3NpdGlvbiBmaXhlZCBhbmNlc3RvciwgaXQgaXMgbm90IGFsbG93ZWQuXG4gKiBUaGlzIHNob3VsZCBvbmx5IGJlIGNhbGxlZCB3aGVuIGEgbGF5b3V0IG9uIHRoZSBwYWdlIHdhcyBqdXN0IGZvcmNlZFxuICogYW55d2F5LlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBZFBvc2l0aW9uQWxsb3dlZChlbGVtZW50LCB3aW4pIHtcbiAgbGV0IGhhc0ZpeGVkQW5jZXN0b3IgPSBmYWxzZTtcbiAgbGV0IGNvbnRhaW5lcnMgPSAwO1xuICBsZXQgZWwgPSBlbGVtZW50O1xuICBkbyB7XG4gICAgaWYgKENPTlRBSU5FUlNbZWwudGFnTmFtZV0pIHtcbiAgICAgIC8vIFRoZSBjb250YWluZXJzIG11c3Qgbm90IHRoZW1zZWx2ZXMgYmUgY29udGFpbmVkIGluIGEgZml4ZWQtcG9zaXRpb25cbiAgICAgIC8vIGVsZW1lbnQuIENvbnRpbnVlIHRoZSBzZWFyY2guXG4gICAgICBjb250YWluZXJzKys7XG4gICAgICBoYXNGaXhlZEFuY2VzdG9yID0gZmFsc2U7XG4gICAgfSBlbHNlIGlmIChpc1Bvc2l0aW9uRml4ZWQoZGV2KCkuYXNzZXJ0RWxlbWVudChlbCksIHdpbikpIHtcbiAgICAgIC8vIEJlY2F1c2UgY2VydGFpbiBibGVzc2VkIGVsZW1lbnRzIG1heSBjb250YWluIGEgcG9zaXRpb24gZml4ZWRcbiAgICAgIC8vIGNvbnRhaW5lciAod2hpY2ggY29udGFpbiBhbiBhZCksIHdlIGNvbnRpbnVlIHRvIHNlYXJjaCB0aGVcbiAgICAgIC8vIGFuY2VzdHJ5IHRyZWUuXG4gICAgICBoYXNGaXhlZEFuY2VzdG9yID0gdHJ1ZTtcbiAgICB9XG4gICAgZWwgPSBlbC5wYXJlbnRFbGVtZW50O1xuICB9IHdoaWxlIChlbCAmJiBlbC50YWdOYW1lICE9ICdCT0RZJyk7XG4gIHJldHVybiAhaGFzRml4ZWRBbmNlc3RvciAmJiBjb250YWluZXJzIDw9IDE7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgYmxlc3NlZCBjb250YWluZXIgZWxlbWVudCB0YWdOYW1lIGlmIHRoZSBhZCBpcyBjb250YWluZWQgYnkgb25lLlxuICogVGhpcyBpcyBjYWxsZWQgZHVyaW5nIGxheW91dCBtZWFzdXJlLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7P3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFkQ29udGFpbmVyKGVsZW1lbnQpIHtcbiAgaWYgKGVsZW1lbnRbQURfQ09OVEFJTkVSX1BST1BdID09PSB1bmRlZmluZWQpIHtcbiAgICBsZXQgZWwgPSBlbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgd2hpbGUgKGVsICYmIGVsLnRhZ05hbWUgIT0gJ0JPRFknKSB7XG4gICAgICBpZiAoQ09OVEFJTkVSU1tlbC50YWdOYW1lXSkge1xuICAgICAgICByZXR1cm4gZWxlbWVudFtBRF9DT05UQUlORVJfUFJPUF0gPSBlbC50YWdOYW1lO1xuICAgICAgfVxuICAgICAgZWwgPSBlbC5wYXJlbnRFbGVtZW50O1xuICAgIH1cbiAgICBlbGVtZW50W0FEX0NPTlRBSU5FUl9QUk9QXSA9IG51bGw7XG4gIH1cbiAgcmV0dXJuIGVsZW1lbnRbQURfQ09OVEFJTkVSX1BST1BdO1xufVxuXG4vKipcbiAqIEdldHMgdGhlIHJlc291cmNlIElEIG9mIHRoZSBhbXAtYWQgZWxlbWVudCBjb250YWluaW5nIHRoZSBwYXNzZWQgbm9kZS5cbiAqIElmIHRoZXJlIGlzIG5vIGNvbnRhaW5pbmcgYW1wLWFkIHRhZywgdGhlbiBudWxsIHdpbGwgYmUgcmV0dXJuZWQuXG4gKiBUT0RPKGpvbmtlbGxlcik6IEludmVzdGlnYXRlIHdoZXRoZXIgbm9uLUE0QSB1c2UgY2FzZSBpcyBuZWVkZWQuIElzc3VlIDExNDM2XG4gKiBAcGFyYW0geyFFbGVtZW50fSBub2RlXG4gKiBAcGFyYW0geyFXaW5kb3d9IHRvcFdpblxuICogQHJldHVybiB7P3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFtcEFkUmVzb3VyY2VJZChub2RlLCB0b3BXaW4pIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBmcmFtZVBhcmVudCA9IGdldFBhcmVudFdpbmRvd0ZyYW1lRWxlbWVudChub2RlLCB0b3BXaW4pLnBhcmVudEVsZW1lbnQ7XG4gICAgaWYgKGZyYW1lUGFyZW50Lm5vZGVOYW1lID09ICdBTVAtQUQnKSB7XG4gICAgICByZXR1cm4gU3RyaW5nKGZyYW1lUGFyZW50LmdldFJlc291cmNlSWQoKSk7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gIH1cbiAgLy8gV2hldGhlciB3ZSBlbnRlcmVkIHRoZSBjYXRjaCBhYm92ZSAoZS5nLiBkdWUgdG8gYXR0ZW1wdCB0byBhY2Nlc3NcbiAgLy8gYWNyb3NzIHhkb21haW4gYm91bmRhcnkpLCBvciBmYWlsZWQgdG8gZW50ZXIgdGhlIGlmIGZ1cnRoZXIgYWJvdmUsIHRoZVxuICAvLyBub2RlIGlzIG5vdCB3aXRoaW4gYSBmcmllbmRseSBhbXAtYWQgdGFnLiBTbywgdGhlcmUgaXMgbm8gYW1wLWFkXG4gIC8vIHJlc291cmNlIElELiBIb3cgdG8gaGFuZGxlIHRoYXQgaXMgdXAgdG8gdGhlIGNhbGxlciwgYnV0IHNlZSBUT0RPIGFib3ZlLlxuICByZXR1cm4gbnVsbDtcbn1cblxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQ29tbW9uIEFNUCBldmVudHMuXG4gKiBAZW51bSB7c3RyaW5nfVxuICovXG5leHBvcnQgY29uc3QgQW1wRXZlbnRzID0ge1xuICBCVUlMVDogJ2FtcDpidWlsdCcsXG4gIERPTV9VUERBVEU6ICdhbXA6ZG9tLXVwZGF0ZScsXG4gIFZJU0lCSUxJVFlfQ0hBTkdFOiAnYW1wOnZpc2liaWxpdHljaGFuZ2UnLCAvLyBodHRwczovL2dpdGh1Yi5jb20vYW1wcHJvamVjdC9hbXBodG1sL2Jsb2IvbWFzdGVyL2Fkcy9SRUFETUUubWQjcGFnZS12aXNpYmlsaXR5XG4gIC8vIFRoZSBmb2xsb3dpbmcgY29kZXMgYXJlIG9ubHkgdXNlZCBmb3IgdGVzdGluZy5cbiAgLy8gVE9ETyhjaG91bXgpOiBNb3ZlIHRoZXNlIHRvIGEgc2VwYXJhdGUgZW51bSBzbyB0aGV5IGNhbiBiZSBEQ0UnZC5cbiAgQVRUQUNIRUQ6ICdhbXA6YXR0YWNoZWQnLFxuICBTVFVCQkVEOiAnYW1wOnN0dWJiZWQnLFxuICBMT0FEX1NUQVJUOiAnYW1wOmxvYWQ6c3RhcnQnLFxuICBMT0FEX0VORDogJ2FtcDpsb2FkOmVuZCcsXG4gIEVSUk9SOiAnYW1wOmVycm9yJyxcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi9zZXJ2aWNlcyc7XG5cbi8qKlxuICogSGVscGVyIG1ldGhvZCB0byB0cmlnZ2VyIGFuYWx5dGljcyBldmVudCBpZiBhbXAtYW5hbHl0aWNzIGlzIGF2YWlsYWJsZS5cbiAqIFRPRE86IERvIG5vdCBleHBvc2UgdGhpcyBmdW5jdGlvblxuICogQHBhcmFtIHshRWxlbWVudH0gdGFyZ2V0XG4gKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+PX0gb3B0X3ZhcnMgQSBtYXAgb2YgdmFycyBhbmQgdGhlaXIgdmFsdWVzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJpZ2dlckFuYWx5dGljc0V2ZW50KHRhcmdldCwgZXZlbnRUeXBlLCBvcHRfdmFycykge1xuICBTZXJ2aWNlcy5hbmFseXRpY3NGb3JEb2NPck51bGwodGFyZ2V0KS50aGVuKGFuYWx5dGljcyA9PiB7XG4gICAgaWYgKCFhbmFseXRpY3MpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYW5hbHl0aWNzLnRyaWdnZXJFdmVudEZvclRhcmdldCh0YXJnZXQsIGV2ZW50VHlwZSwgb3B0X3ZhcnMpO1xuICB9KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogQ29tbW9ubHkgdXNlZCBzaWduYWxzIGFjcm9zcyBkaWZmZXJlbnQgZWxlbWVudHMgYW5kIGRvY3VtZW50cy5cbiAqIEBlbnVtIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBjb25zdCBDb21tb25TaWduYWxzID0ge1xuXG4gIC8qKlxuICAgKiBUaGUgZWxlbWVudCBoYXMgYmVlbiBidWlsdC5cbiAgICovXG4gIEJVSUxUOiAnYnVpbHQnLFxuXG4gIC8qKlxuICAgKiBUaGUgaW5pdGlhbCBjb250ZW50cyBvZiBhbiBlbGVtZW50L2RvY3VtZW50L2VtYmVkIGhhdmUgYmVlbiBsb2FkZWQuXG4gICAqL1xuICBJTklfTE9BRDogJ2luaS1sb2FkJyxcblxuICAvKipcbiAgICogVGhlIGVsZW1lbnQgaGFzIGJlZW4gbG9hZGVkLlxuICAgKi9cbiAgTE9BRF9FTkQ6ICdsb2FkLWVuZCcsXG5cbiAgLyoqXG4gICAqIFRoZSBlbGVtZW50IGhhcyBzdGFydGVkIGxvYWRpbmcuXG4gICAqL1xuICBMT0FEX1NUQVJUOiAnbG9hZC1zdGFydCcsXG5cbiAgLyoqXG4gICAqIFJlbmRlcmluZyBoYXMgYmVlbiBjb25maXJtZWQgdG8gaGF2ZSBiZWVuIHN0YXJ0ZWQuXG4gICAqL1xuICBSRU5ERVJfU1RBUlQ6ICdyZW5kZXItc3RhcnQnLFxuXG4gIC8qKlxuICAgKiBUaGUgZWxlbWVudCBoYXMgYmVlbiB1bmxhaWQgb3V0LlxuICAgKi9cbiAgVU5MT0FEOiAndW5sb2FkJyxcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBBbGxvd3MgZm9yIHJ1bnRpbWUgY29uZmlndXJhdGlvbi4gSW50ZXJuYWxseSwgdGhlIHJ1bnRpbWUgc2hvdWxkXG4gKiB1c2UgdGhlIHNyYy9jb25maWcuanMgbW9kdWxlIGZvciB2YXJpb3VzIGNvbnN0YW50cy4gV2UgY2FuIHVzZSB0aGVcbiAqIEFNUF9DT05GSUcgZ2xvYmFsIHRvIHRyYW5zbGF0ZSB1c2VyLWRlZmluZWQgY29uZmlndXJhdGlvbnMgdG8gdGhpc1xuICogbW9kdWxlLlxuICogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fVxuICovXG5jb25zdCBlbnYgPSBzZWxmLkFNUF9DT05GSUcgfHwge307XG5cbmNvbnN0IHRoaXJkUGFydHlGcmFtZVJlZ2V4ID0gdHlwZW9mIGVudlsndGhpcmRQYXJ0eUZyYW1lUmVnZXgnXSA9PSAnc3RyaW5nJyA/XG4gIG5ldyBSZWdFeHAoZW52Wyd0aGlyZFBhcnR5RnJhbWVSZWdleCddKSA6IGVudlsndGhpcmRQYXJ0eUZyYW1lUmVnZXgnXTtcblxuY29uc3QgY2RuUHJveHlSZWdleCA9IHR5cGVvZiBlbnZbJ2NkblByb3h5UmVnZXgnXSA9PSAnc3RyaW5nJyA/XG4gIG5ldyBSZWdFeHAoZW52WydjZG5Qcm94eVJlZ2V4J10pIDogZW52WydjZG5Qcm94eVJlZ2V4J107XG5cbi8qKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsIHN0cmluZ3xib29sZWFufFJlZ0V4cD59ICovXG5leHBvcnQgY29uc3QgdXJscyA9IHtcbiAgdGhpcmRQYXJ0eTogZW52Wyd0aGlyZFBhcnR5VXJsJ10gfHwgJ2h0dHBzOi8vM3AuYW1wcHJvamVjdC5uZXQnLFxuICB0aGlyZFBhcnR5RnJhbWVIb3N0OiBlbnZbJ3RoaXJkUGFydHlGcmFtZUhvc3QnXSB8fCAnYW1wcHJvamVjdC5uZXQnLFxuICB0aGlyZFBhcnR5RnJhbWVSZWdleDogdGhpcmRQYXJ0eUZyYW1lUmVnZXggfHwgL15kLVxcZCtcXC5hbXBwcm9qZWN0XFwubmV0JC8sXG4gIGNkbjogZW52WydjZG5VcmwnXSB8fCAnaHR0cHM6Ly9jZG4uYW1wcHJvamVjdC5vcmcnLFxuICAvKiBOb3RlIHRoYXQgY2RuUHJveHlSZWdleCBpcyBvbmx5IGV2ZXIgY2hlY2tlZCBhZ2FpbnN0IG9yaWdpbnNcbiAgICogKHByb3RvOi8vaG9zdFs6cG9ydF0pIHNvIGRvZXMgbm90IG5lZWQgdG8gY29uc2lkZXIgcGF0aFxuICAgKi9cbiAgY2RuUHJveHlSZWdleDogY2RuUHJveHlSZWdleCB8fFxuICAgICAgL15odHRwczpcXC9cXC8oW2EtekEtWjAtOV8tXStcXC4pP2NkblxcLmFtcHByb2plY3RcXC5vcmckLyxcbiAgbG9jYWxob3N0UmVnZXg6IC9eaHR0cHM/OlxcL1xcL2xvY2FsaG9zdCg6XFxkKyk/JC8sXG4gIGVycm9yUmVwb3J0aW5nOiBlbnZbJ2Vycm9yUmVwb3J0aW5nVXJsJ10gfHxcbiAgICAgICdodHRwczovL2FtcC1lcnJvci1yZXBvcnRpbmcuYXBwc3BvdC5jb20vcicsXG4gIGxvY2FsRGV2OiBlbnZbJ2xvY2FsRGV2J10gfHwgZmFsc2UsXG59O1xuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICB1cmxzLFxufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vLyBUaGlzIGZpbGUgd2lsbCBiZSBpbXBvcnRlZCBieSAzUCBzY3JpcHRzLlxuXG4vKipcbiAqIFBvc3NpYmxlIGNvbnNlbnQgcG9saWN5IHN0YXRlIHRvIHByb2NlZWQgd2l0aC5cbiAqIEBlbnVtIHtudW1iZXJ9XG4gKi9cbmV4cG9ydCBjb25zdCBDT05TRU5UX1BPTElDWV9TVEFURSA9IHtcbiAgLy8gRW51bSB2YWx1ZSBoYXMgZXh0ZXJuYWwgZGVwZW5kZW5jeS4gUGxlYXNlIGRvIG5vdCBjaGFuZ2UgZXhpc3RpbmcgdmFsdWUuXG4gIC8vIElmIG5ldyB2YWx1ZXMgYXJlIGFkZGVkLCBwbGVhc2Ugbm90aWZ5IHRoZSBBTVAgZm9yIEFkcyB0ZWFtIHRvIGFzc3VyZVxuICAvLyBjb3JyZWN0IFJlYWwgVGltZSBDb25maWcgYmVoYXZpb3IgaXMgbWFpbnRhaW5lZCBmb3IgRmFzdCBGZXRjaC5cbiAgU1VGRklDSUVOVDogMSxcbiAgSU5TVUZGSUNJRU5UOiAyLFxuICBVTktOT1dOX05PVF9SRVFVSVJFRDogMyxcbiAgVU5LTk9XTjogNCxcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgQ09OU0VOVF9QT0xJQ1lfU1RBVEUsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbn0gZnJvbSAnLi9jb25zZW50LXN0YXRlJztcbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4vc2VydmljZXMnO1xuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZSB3aGVuIGFsbCBjb25zZW50IHN0YXRlIHRoZSBwb2xpY3kgd2FpdFxuICogZm9yIHJlc29sdmUuIE9yIGlmIGNvbnNlbnQgc2VydmljZSBpcyBub3QgYXZhaWxhYmxlLlxuICogQHBhcmFtIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gcG9saWN5SWRcbiAqIEByZXR1cm4geyFQcm9taXNlPD9DT05TRU5UX1BPTElDWV9TVEFURT59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb25zZW50UG9saWN5U3RhdGUoYW1wZG9jLCBwb2xpY3lJZCkge1xuICByZXR1cm4gU2VydmljZXMuY29uc2VudFBvbGljeVNlcnZpY2VGb3JEb2NPck51bGwoYW1wZG9jKVxuICAgICAgLnRoZW4oY29uc2VudFBvbGljeSA9PiB7XG4gICAgICAgIGlmICghY29uc2VudFBvbGljeSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb25zZW50UG9saWN5LndoZW5Qb2xpY3lSZXNvbHZlZChcbiAgICAgICAgICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAocG9saWN5SWQpKTtcbiAgICAgIH0pO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gYSBzaGFyZWREYXRhIHJldHJpZXZlZCBmcm9tIGNvbnNlbnRcbiAqIHJlbW90ZSBlbmRwb2ludC5cbiAqIEBwYXJhbSB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICogQHBhcmFtIHtzdHJpbmd9IHBvbGljeUlkXG4gKiBAcmV0dXJuIHshUHJvbWlzZTw/T2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvbnNlbnRQb2xpY3lTaGFyZWREYXRhKGFtcGRvYywgcG9saWN5SWQpIHtcbiAgcmV0dXJuIFNlcnZpY2VzLmNvbnNlbnRQb2xpY3lTZXJ2aWNlRm9yRG9jT3JOdWxsKGFtcGRvYylcbiAgICAgIC50aGVuKGNvbnNlbnRQb2xpY3kgPT4ge1xuICAgICAgICBpZiAoIWNvbnNlbnRQb2xpY3kpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29uc2VudFBvbGljeS5nZXRNZXJnZWRTaGFyZWREYXRhKFxuICAgICAgICAgICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovIChwb2xpY3lJZCkpO1xuICAgICAgfSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtlbmRzV2l0aH0gZnJvbSAnLi9zdHJpbmcnO1xuaW1wb3J0IHtcbiAgaXNQcm94eU9yaWdpbixcbiAgcGFyc2VVcmxEZXByZWNhdGVkLFxuICB0cnlEZWNvZGVVcmlDb21wb25lbnQsXG59IGZyb20gJy4vdXJsJztcbmltcG9ydCB7dXJsc30gZnJvbSAnLi9jb25maWcnO1xuXG5cbi8qKlxuICogUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIGNvb2tpZS4gVGhlIGNvb2tpZSBhY2Nlc3MgaXMgcmVzdHJpY3RlZCBhbmQgbXVzdFxuICogZ28gdGhyb3VnaCB0aGUgcHJpdmFjeSByZXZpZXcuIEJlZm9yZSB1c2luZyB0aGlzIG1ldGhvZCBwbGVhc2UgZmlsZSBhXG4gKiBHaXRIdWIgaXNzdWUgd2l0aCBcIlByaXZhY3kgUmV2aWV3XCIgbGFiZWwuXG4gKlxuICogUmV0dXJucyB0aGUgY29va2llJ3MgdmFsdWUgb3IgYG51bGxgLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICogQHJldHVybiB7P3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvb2tpZSh3aW4sIG5hbWUpIHtcbiAgY29uc3QgY29va2llU3RyaW5nID0gdHJ5R2V0RG9jdW1lbnRDb29raWVOb0lubGluZSh3aW4pO1xuICBpZiAoIWNvb2tpZVN0cmluZykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IGNvb2tpZXMgPSBjb29raWVTdHJpbmcuc3BsaXQoJzsnKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb29raWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgY29va2llID0gY29va2llc1tpXS50cmltKCk7XG4gICAgY29uc3QgZXEgPSBjb29raWUuaW5kZXhPZignPScpO1xuICAgIGlmIChlcSA9PSAtMSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmICh0cnlEZWNvZGVVcmlDb21wb25lbnQoY29va2llLnN1YnN0cmluZygwLCBlcSkudHJpbSgpKSA9PSBuYW1lKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IGNvb2tpZS5zdWJzdHJpbmcoZXEgKyAxKS50cmltKCk7XG4gICAgICByZXR1cm4gdHJ5RGVjb2RlVXJpQ29tcG9uZW50KHZhbHVlLCB2YWx1ZSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIFRoaXMgbWV0aG9kIHNob3VsZCBub3QgYmUgaW5saW5lZCB0byBwcmV2ZW50IFRyeUNhdGNoIGRlb3B0aW1pemF0aW9uLlxuICogTm9JbmxpbmUga2V5d29yZCBhdCB0aGUgZW5kIG9mIGZ1bmN0aW9uIG5hbWUgYWxzbyBwcmV2ZW50cyBDbG9zdXJlIGNvbXBpbGVyXG4gKiBmcm9tIGlubGluaW5nIHRoZSBmdW5jdGlvbi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHRyeUdldERvY3VtZW50Q29va2llTm9JbmxpbmUod2luKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHdpbi5kb2N1bWVudC5jb29raWU7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBBY3QgYXMgaWYgbm8gY29va2llIGlzIGF2YWlsYWJsZS4gRXhjZXB0aW9ucyBjYW4gYmUgdGhyb3duIHdoZW5cbiAgICAvLyBBTVAgZG9jcyBhcmUgb3BlbmVkIG9uIG9yaWdpbnMgdGhhdCBkbyBub3QgYWxsb3cgc2V0dGluZ1xuICAgIC8vIGNvb2tpZXMgc3VjaCBhcyBudWxsIG9yaWdpbnMuXG4gICAgcmV0dXJuICcnO1xuICB9XG59XG5cbi8qKlxuICogU2V0cyB0aGUgdmFsdWUgb2YgdGhlIGNvb2tpZS4gVGhlIGNvb2tpZSBhY2Nlc3MgaXMgcmVzdHJpY3RlZCBhbmQgbXVzdFxuICogZ28gdGhyb3VnaCB0aGUgcHJpdmFjeSByZXZpZXcuIEJlZm9yZSB1c2luZyB0aGlzIG1ldGhvZCBwbGVhc2UgZmlsZSBhXG4gKiBHaXRIdWIgaXNzdWUgd2l0aCBcIlByaXZhY3kgUmV2aWV3XCIgbGFiZWwuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcbiAqIEBwYXJhbSB7dGltZX0gZXhwaXJhdGlvblRpbWVcbiAqIEBwYXJhbSB7e1xuICogICBoaWdoZXN0QXZhaWxhYmxlRG9tYWluOihib29sZWFufHVuZGVmaW5lZCksXG4gKiAgIGRvbWFpbjooc3RyaW5nfHVuZGVmaW5lZClcbiAqIH09fSBvcHRfb3B0aW9uc1xuICogICAgIC0gaGlnaGVzdEF2YWlsYWJsZURvbWFpbjogSWYgdHJ1ZSwgc2V0IHRoZSBjb29raWUgYXQgdGhlIHdpZGVzdCBkb21haW5cbiAqICAgICAgIHNjb3BlIGFsbG93ZWQgYnkgdGhlIGJyb3dzZXIuIEUuZy4gb24gZXhhbXBsZS5jb20gaWYgd2UgYXJlIGN1cnJlbnRseVxuICogICAgICAgb24gd3d3LmV4YW1wbGUuY29tLlxuICogICAgIC0gZG9tYWluOiBFeHBsaWNpdCBkb21haW4gdG8gc2V0LlxuICogICAgIC0gYWxsb3dPblByb3h5T3JpZ2luOiBBbGxvdyBzZXR0aW5nIGEgY29va2llIG9uIHRoZSBBTVAgQ2FjaGUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRDb29raWUod2luLCBuYW1lLCB2YWx1ZSwgZXhwaXJhdGlvblRpbWUsIG9wdF9vcHRpb25zKSB7XG4gIGNoZWNrT3JpZ2luRm9yU2V0dGluZ0Nvb2tpZSh3aW4sIG9wdF9vcHRpb25zLCBuYW1lKTtcbiAgaWYgKG9wdF9vcHRpb25zICYmIG9wdF9vcHRpb25zLmhpZ2hlc3RBdmFpbGFibGVEb21haW4pIHtcbiAgICBjb25zdCBwYXJ0cyA9IHdpbi5sb2NhdGlvbi5ob3N0bmFtZS5zcGxpdCgnLicpO1xuICAgIGxldCBkb21haW4gPSBwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXTtcbiAgICBmb3IgKGxldCBpID0gcGFydHMubGVuZ3RoIC0gMjsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGRvbWFpbiA9IHBhcnRzW2ldICsgJy4nICsgZG9tYWluO1xuICAgICAgdHJ5U2V0Q29va2llKHdpbiwgbmFtZSwgdmFsdWUsIGV4cGlyYXRpb25UaW1lLCBkb21haW4pO1xuICAgICAgaWYgKGdldENvb2tpZSh3aW4sIG5hbWUpID09IHZhbHVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgbGV0IGRvbWFpbiA9IHVuZGVmaW5lZDtcbiAgaWYgKG9wdF9vcHRpb25zICYmIG9wdF9vcHRpb25zLmRvbWFpbikge1xuICAgIGRvbWFpbiA9IG9wdF9vcHRpb25zLmRvbWFpbjtcbiAgfVxuICB0cnlTZXRDb29raWUod2luLCBuYW1lLCB2YWx1ZSwgZXhwaXJhdGlvblRpbWUsIGRvbWFpbik7XG59XG5cbi8qKlxuICogQXR0ZW1wdCB0byBzZXQgYSBjb29raWUgd2l0aCB0aGUgZ2l2ZW4gcGFyYW1zLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gKiBAcGFyYW0ge3RpbWV9IGV4cGlyYXRpb25UaW1lXG4gKiBAcGFyYW0ge3N0cmluZ3x1bmRlZmluZWR9IGRvbWFpblxuICovXG5mdW5jdGlvbiB0cnlTZXRDb29raWUod2luLCBuYW1lLCB2YWx1ZSwgZXhwaXJhdGlvblRpbWUsIGRvbWFpbikge1xuICAvLyBXZSBkbyBub3QgYWxsb3cgc2V0dGluZyBjb29raWVzIG9uIHRoZSBkb21haW4gdGhhdCBjb250YWlucyBib3RoXG4gIC8vIHRoZSBjZG4uIGFuZCB3d3cuIGhvc3RzLlxuICBpZiAoZG9tYWluID09ICdhbXBwcm9qZWN0Lm9yZycpIHtcbiAgICAvLyBBY3RpdmVseSBkZWxldGUgdGhlbS5cbiAgICB2YWx1ZSA9ICdkZWxldGUnO1xuICAgIGV4cGlyYXRpb25UaW1lID0gMDtcbiAgfVxuICBjb25zdCBjb29raWUgPSBlbmNvZGVVUklDb21wb25lbnQobmFtZSkgKyAnPScgK1xuICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSArXG4gICAgICAnOyBwYXRoPS8nICtcbiAgICAgIChkb21haW4gPyAnOyBkb21haW49JyArIGRvbWFpbiA6ICcnKSArXG4gICAgICAnOyBleHBpcmVzPScgKyBuZXcgRGF0ZShleHBpcmF0aW9uVGltZSkudG9VVENTdHJpbmcoKTtcbiAgdHJ5IHtcbiAgICB3aW4uZG9jdW1lbnQuY29va2llID0gY29va2llO1xuICB9IGNhdGNoIChpZ25vcmUpIHtcbiAgICAvLyBEbyBub3QgdGhyb3cgaWYgc2V0dGluZyB0aGUgY29va2llIGZhaWxlZCBFeGNlcHRpb25zIGNhbiBiZSB0aHJvd25cbiAgICAvLyB3aGVuIEFNUCBkb2NzIGFyZSBvcGVuZWQgb24gb3JpZ2lucyB0aGF0IGRvIG5vdCBhbGxvdyBzZXR0aW5nXG4gICAgLy8gY29va2llcyBzdWNoIGFzIG51bGwgb3JpZ2lucy5cbiAgfVxufVxuXG4vKipcbiAqIFRocm93cyBpZiBhIGdpdmVuIGNvb2tpZSBzaG91bGQgbm90IGJlIHNldCBvbiB0aGUgZ2l2ZW4gb3JpZ2luLlxuICogVGhpcyBpcyBhIGRlZmVuc2UtaW4tZGVwdGguIENhbGxlcnMgc2hvdWxkIG5ldmVyIHJ1biBpbnRvIHRoaXMuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IU9iamVjdHx1bmRlZmluZWR9IG9wdGlvbnNcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIEZvciB0aGUgZXJyb3IgbWVzc2FnZS5cbiAqL1xuZnVuY3Rpb24gY2hlY2tPcmlnaW5Gb3JTZXR0aW5nQ29va2llKHdpbiwgb3B0aW9ucywgbmFtZSkge1xuICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmFsbG93T25Qcm94eU9yaWdpbikge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoaXNQcm94eU9yaWdpbih3aW4ubG9jYXRpb24uaHJlZikpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1Nob3VsZCBuZXZlciBhdHRlbXB0IHRvIHNldCBjb29raWUgb24gcHJveHkgb3JpZ2luOiAnXG4gICAgICAgICsgbmFtZSk7XG4gIH1cblxuICBjb25zdCBjdXJyZW50ID0gcGFyc2VVcmxEZXByZWNhdGVkKHdpbi5sb2NhdGlvbi5ocmVmKS5ob3N0bmFtZS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBwcm94eSA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmxzLmNkbikuaG9zdG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgaWYgKGN1cnJlbnQgPT0gcHJveHkgfHwgZW5kc1dpdGgoY3VycmVudCwgJy4nICsgcHJveHkpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdTaG91bGQgbmV2ZXIgYXR0ZW1wdCB0byBzZXQgY29va2llIG9uIHByb3h5IG9yaWdpbi4nXG4gICAgICAgICsgJyAoaW4gZGVwdGggY2hlY2spOiAnICsgbmFtZSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogV2hldGhlciB0aGUgZG9jdW1lbnQgaXMgcmVhZHkuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNEb2N1bWVudFJlYWR5KGRvYykge1xuICByZXR1cm4gZG9jLnJlYWR5U3RhdGUgIT0gJ2xvYWRpbmcnICYmIGRvYy5yZWFkeVN0YXRlICE9ICd1bmluaXRpYWxpemVkJztcbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBkb2N1bWVudCBoYXMgbG9hZGVkIGFsbCB0aGUgY3NzIGFuZCBzdWItcmVzb3VyY2VzLlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNEb2N1bWVudENvbXBsZXRlKGRvYykge1xuICByZXR1cm4gZG9jLnJlYWR5U3RhdGUgPT0gJ2NvbXBsZXRlJztcbn1cblxuLyoqXG4gKiBDYWxscyB0aGUgY2FsbGJhY2sgd2hlbiBkb2N1bWVudCBpcyByZWFkeS5cbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2NcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIURvY3VtZW50KX0gY2FsbGJhY2tcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9uRG9jdW1lbnRSZWFkeShkb2MsIGNhbGxiYWNrKSB7XG4gIG9uRG9jdW1lbnRTdGF0ZShkb2MsIGlzRG9jdW1lbnRSZWFkeSwgY2FsbGJhY2spO1xufVxuXG4vKipcbiAqIENhbGxzIHRoZSBjYWxsYmFjayB3aGVuIGRvY3VtZW50J3Mgc3RhdGUgc2F0aXNmaWVzIHRoZSBzdGF0ZUZuLlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHBhcmFtIHtmdW5jdGlvbighRG9jdW1lbnQpOmJvb2xlYW59IHN0YXRlRm5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIURvY3VtZW50KX0gY2FsbGJhY2tcbiAqL1xuZnVuY3Rpb24gb25Eb2N1bWVudFN0YXRlKGRvYywgc3RhdGVGbiwgY2FsbGJhY2spIHtcbiAgbGV0IHJlYWR5ID0gc3RhdGVGbihkb2MpO1xuICBpZiAocmVhZHkpIHtcbiAgICBjYWxsYmFjayhkb2MpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHJlYWR5TGlzdGVuZXIgPSAoKSA9PiB7XG4gICAgICBpZiAoc3RhdGVGbihkb2MpKSB7XG4gICAgICAgIGlmICghcmVhZHkpIHtcbiAgICAgICAgICByZWFkeSA9IHRydWU7XG4gICAgICAgICAgY2FsbGJhY2soZG9jKTtcbiAgICAgICAgfVxuICAgICAgICBkb2MucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVhZHlzdGF0ZWNoYW5nZScsIHJlYWR5TGlzdGVuZXIpO1xuICAgICAgfVxuICAgIH07XG4gICAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoJ3JlYWR5c3RhdGVjaGFuZ2UnLCByZWFkeUxpc3RlbmVyKTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgaXMgcmVzb2x2ZWQgd2hlbiBkb2N1bWVudCBpcyByZWFkeS5cbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2NcbiAqIEByZXR1cm4geyFQcm9taXNlPCFEb2N1bWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aGVuRG9jdW1lbnRSZWFkeShkb2MpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgIG9uRG9jdW1lbnRSZWFkeShkb2MsIHJlc29sdmUpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IGlzIHJlc29sdmVkIHdoZW4gZG9jdW1lbnQgaXMgY29tcGxldGUuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhRG9jdW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gd2hlbkRvY3VtZW50Q29tcGxldGUoZG9jKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICBvbkRvY3VtZW50U3RhdGUoZG9jLCBpc0RvY3VtZW50Q29tcGxldGUsIHJlc29sdmUpO1xuICB9KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge0RlZmVycmVkfSBmcm9tICcuL3V0aWxzL3Byb21pc2UnO1xuaW1wb3J0IHtjc3NFc2NhcGV9IGZyb20gJy4uL3RoaXJkX3BhcnR5L2Nzcy1lc2NhcGUvY3NzLWVzY2FwZSc7XG5pbXBvcnQge2Rldn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtkaWN0fSBmcm9tICcuL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge3N0YXJ0c1dpdGh9IGZyb20gJy4vc3RyaW5nJztcbmltcG9ydCB7dG9XaW59IGZyb20gJy4vdHlwZXMnO1xuXG5jb25zdCBIVE1MX0VTQ0FQRV9DSEFSUyA9IHtcbiAgJyYnOiAnJmFtcDsnLFxuICAnPCc6ICcmbHQ7JyxcbiAgJz4nOiAnJmd0OycsXG4gICdcIic6ICcmcXVvdDsnLFxuICBcIidcIjogJyYjeDI3OycsXG4gICdgJzogJyYjeDYwOycsXG59O1xuY29uc3QgSFRNTF9FU0NBUEVfUkVHRVggPSAvKCZ8PHw+fFwifCd8YCkvZztcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuZXhwb3J0IGNvbnN0IFVQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9QUk9NSVNFID1cbiAgICAnX19BTVBfVVBHX1BSTSc7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUkVTT0xWRVIgPVxuICAgICdfX0FNUF9VUEdfUkVTJztcblxuLyoqXG4gKiBXYWl0cyB1bnRpbCB0aGUgY2hpbGQgZWxlbWVudCBpcyBjb25zdHJ1Y3RlZC4gT25jZSB0aGUgY2hpbGQgaXMgZm91bmQsIHRoZVxuICogY2FsbGJhY2sgaXMgZXhlY3V0ZWQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IGNoZWNrRnVuY1xuICogQHBhcmFtIHtmdW5jdGlvbigpfSBjYWxsYmFja1xuICovXG5leHBvcnQgZnVuY3Rpb24gd2FpdEZvckNoaWxkKHBhcmVudCwgY2hlY2tGdW5jLCBjYWxsYmFjaykge1xuICBpZiAoY2hlY2tGdW5jKHBhcmVudCkpIHtcbiAgICBjYWxsYmFjaygpO1xuICAgIHJldHVybjtcbiAgfVxuICAvKiogQGNvbnN0IHshV2luZG93fSAqL1xuICBjb25zdCB3aW4gPSB0b1dpbihwYXJlbnQub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldyk7XG4gIGlmICh3aW4uTXV0YXRpb25PYnNlcnZlcikge1xuICAgIC8qKiBAY29uc3Qge011dGF0aW9uT2JzZXJ2ZXJ9ICovXG4gICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgd2luLk11dGF0aW9uT2JzZXJ2ZXIoKCkgPT4ge1xuICAgICAgaWYgKGNoZWNrRnVuYyhwYXJlbnQpKSB7XG4gICAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBvYnNlcnZlci5vYnNlcnZlKHBhcmVudCwge2NoaWxkTGlzdDogdHJ1ZX0pO1xuICB9IGVsc2Uge1xuICAgIC8qKiBAY29uc3Qge251bWJlcn0gKi9cbiAgICBjb25zdCBpbnRlcnZhbCA9IHdpbi5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBpZiAoY2hlY2tGdW5jKHBhcmVudCkpIHtcbiAgICAgICAgd2luLmNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfVxuICAgIH0sIC8qIG1pbGxpc2Vjb25kcyAqLyA1KTtcbiAgfVxufVxuXG4vKipcbiAqIFdhaXRzIHVudGlsIHRoZSBjaGlsZCBlbGVtZW50IGlzIGNvbnN0cnVjdGVkLiBPbmNlIHRoZSBjaGlsZCBpcyBmb3VuZCwgdGhlXG4gKiBwcm9taXNlIGlzIHJlc29sdmVkLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjaGVja0Z1bmNcbiAqIEByZXR1cm4geyFQcm9taXNlfVxuICovXG5leHBvcnQgZnVuY3Rpb24gd2FpdEZvckNoaWxkUHJvbWlzZShwYXJlbnQsIGNoZWNrRnVuYykge1xuICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgd2FpdEZvckNoaWxkKHBhcmVudCwgY2hlY2tGdW5jLCByZXNvbHZlKTtcbiAgfSk7XG59XG5cbi8qKlxuICogV2FpdHMgZm9yIGRvY3VtZW50J3MgYm9keSB0byBiZSBhdmFpbGFibGUuXG4gKiBXaWxsIGJlIGRlcHJlY2F0ZWQgc29vbjsgdXNlIHtAbGluayBBbXBEb2Mjd2hlbkJvZHlBdmFpbGFibGV9IG9yXG4gKiBAe2xpbmsgRG9jdW1lbnRTdGF0ZSNvbkJvZHlBdmFpbGFibGV9IGluc3RlYWQuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGNhbGxiYWNrXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3YWl0Rm9yQm9keShkb2MsIGNhbGxiYWNrKSB7XG4gIHdhaXRGb3JDaGlsZChkb2MuZG9jdW1lbnRFbGVtZW50LCAoKSA9PiAhIWRvYy5ib2R5LCBjYWxsYmFjayk7XG59XG5cblxuLyoqXG4gKiBXYWl0cyBmb3IgZG9jdW1lbnQncyBib2R5IHRvIGJlIGF2YWlsYWJsZS5cbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2NcbiAqIEByZXR1cm4geyFQcm9taXNlfVxuICovXG5leHBvcnQgZnVuY3Rpb24gd2FpdEZvckJvZHlQcm9taXNlKGRvYykge1xuICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgd2FpdEZvckJvZHkoZG9jLCByZXNvbHZlKTtcbiAgfSk7XG59XG5cblxuLyoqXG4gKiBSZW1vdmVzIHRoZSBlbGVtZW50LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlRWxlbWVudChlbGVtZW50KSB7XG4gIGlmIChlbGVtZW50LnBhcmVudEVsZW1lbnQpIHtcbiAgICBlbGVtZW50LnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFJlbW92ZXMgYWxsIGNoaWxkIG5vZGVzIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlQ2hpbGRyZW4ocGFyZW50KSB7XG4gIHdoaWxlIChwYXJlbnQuZmlyc3RDaGlsZCkge1xuICAgIHBhcmVudC5yZW1vdmVDaGlsZChwYXJlbnQuZmlyc3RDaGlsZCk7XG4gIH1cbn1cblxuXG4vKipcbiAqIENvcGllcyBhbGwgY2hpbGRyZW4gbm9kZXMgb2YgZWxlbWVudCBcImZyb21cIiB0byBlbGVtZW50IFwidG9cIi4gQ2hpbGQgbm9kZXNcbiAqIGFyZSBkZWVwbHkgY2xvbmVkLiBOb3RpY2UsIHRoYXQgdGhpcyBtZXRob2Qgc2hvdWxkIGJlIHVzZWQgd2l0aCBjYXJlIGFuZFxuICogcHJlZmVyYWJseSBvbiBzbWFsbGVyIHN1YnRyZWVzLlxuICogQHBhcmFtIHshRWxlbWVudH0gZnJvbVxuICogQHBhcmFtIHshRWxlbWVudHwhRG9jdW1lbnRGcmFnbWVudH0gdG9cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvcHlDaGlsZHJlbihmcm9tLCB0bykge1xuICBjb25zdCBmcmFnID0gdG8ub3duZXJEb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gIGZvciAobGV0IG4gPSBmcm9tLmZpcnN0Q2hpbGQ7IG47IG4gPSBuLm5leHRTaWJsaW5nKSB7XG4gICAgZnJhZy5hcHBlbmRDaGlsZChuLmNsb25lTm9kZSh0cnVlKSk7XG4gIH1cbiAgdG8uYXBwZW5kQ2hpbGQoZnJhZyk7XG59XG5cbi8qKlxuICogSW5zZXJ0IHRoZSBlbGVtZW50IGluIHRoZSByb290IGFmdGVyIHRoZSBlbGVtZW50IG5hbWVkIGFmdGVyIG9yXG4gKiBpZiB0aGF0IGlzIG51bGwgYXQgdGhlIGJlZ2lubmluZy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IVNoYWRvd1Jvb3R9IHJvb3RcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7P05vZGV9IGFmdGVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRBZnRlck9yQXRTdGFydChyb290LCBlbGVtZW50LCBhZnRlcikge1xuICBjb25zdCBiZWZvcmUgPSBhZnRlciA/IGFmdGVyLm5leHRTaWJsaW5nIDogcm9vdC5maXJzdENoaWxkO1xuICByb290Lmluc2VydEJlZm9yZShlbGVtZW50LCBiZWZvcmUpO1xufVxuXG4vKipcbiAqIEFkZCBhdHRyaWJ1dGVzIHRvIGFuIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0geyFKc29uT2JqZWN0PHN0cmluZywgc3RyaW5nPn0gYXR0cmlidXRlc1xuICogQHJldHVybiB7IUVsZW1lbnR9IGNyZWF0ZWQgZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkQXR0cmlidXRlc1RvRWxlbWVudChlbGVtZW50LCBhdHRyaWJ1dGVzKSB7XG4gIGZvciAoY29uc3QgYXR0ciBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoYXR0ciwgYXR0cmlidXRlc1thdHRyXSk7XG4gIH1cbiAgcmV0dXJuIGVsZW1lbnQ7XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgbmV3IGVsZW1lbnQgb24gZG9jdW1lbnQgd2l0aCBzcGVjaWZpZWQgdGFnTmFtZSBhbmQgYXR0cmlidXRlcy5cbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0PHN0cmluZywgc3RyaW5nPn0gYXR0cmlidXRlc1xuICogQHJldHVybiB7IUVsZW1lbnR9IGNyZWF0ZWQgZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRWxlbWVudFdpdGhBdHRyaWJ1dGVzKGRvYywgdGFnTmFtZSwgYXR0cmlidXRlcykge1xuICBjb25zdCBlbGVtZW50ID0gZG9jLmNyZWF0ZUVsZW1lbnQodGFnTmFtZSk7XG4gIHJldHVybiBhZGRBdHRyaWJ1dGVzVG9FbGVtZW50KGVsZW1lbnQsIGF0dHJpYnV0ZXMpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBub2RlIGlzIGNvbm5lY3RlZCAoYXR0YWNoZWQpLlxuICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEBzZWUgaHR0cHM6Ly9kb20uc3BlYy53aGF0d2cub3JnLyNjb25uZWN0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQ29ubmVjdGVkTm9kZShub2RlKSB7XG4gIGNvbnN0IGNvbm5lY3RlZCA9IG5vZGUuaXNDb25uZWN0ZWQ7XG4gIGlmIChjb25uZWN0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBjb25uZWN0ZWQ7XG4gIH1cblxuICAvLyBcIkFuIGVsZW1lbnQgaXMgY29ubmVjdGVkIGlmIGl0cyBzaGFkb3ctaW5jbHVkaW5nIHJvb3QgaXMgYSBkb2N1bWVudC5cIlxuICBsZXQgbiA9IG5vZGU7XG4gIGRvIHtcbiAgICBuID0gcm9vdE5vZGVGb3Iobik7XG4gICAgaWYgKG4uaG9zdCkge1xuICAgICAgbiA9IG4uaG9zdDtcbiAgICB9IGVsc2Uge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9IHdoaWxlICh0cnVlKTtcbiAgcmV0dXJuIG4ubm9kZVR5cGUgPT09IE5vZGUuRE9DVU1FTlRfTk9ERTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSByb290IGZvciBhIGdpdmVuIG5vZGUuIERvZXMgbm90IGNyb3NzIHNoYWRvdyBET00gYm91bmRhcnkuXG4gKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gKiBAcmV0dXJuIHshTm9kZX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJvb3ROb2RlRm9yKG5vZGUpIHtcbiAgaWYgKE5vZGUucHJvdG90eXBlLmdldFJvb3ROb2RlKSB7XG4gICAgLy8gVHlwZSBjaGVja2VyIHNheXMgYGdldFJvb3ROb2RlYCBtYXkgcmV0dXJuIG51bGwuXG4gICAgcmV0dXJuIG5vZGUuZ2V0Um9vdE5vZGUoKSB8fCBub2RlO1xuICB9XG4gIGxldCBuO1xuICBmb3IgKG4gPSBub2RlOyAhIW4ucGFyZW50Tm9kZTsgbiA9IG4ucGFyZW50Tm9kZSkge31cbiAgcmV0dXJuIG47XG59XG5cbi8qKlxuICogRmluZHMgdGhlIGNsb3Nlc3QgZWxlbWVudCB0aGF0IHNhdGlzZmllcyB0aGUgY2FsbGJhY2sgZnJvbSB0aGlzIGVsZW1lbnRcbiAqIHVwIHRoZSBET00gc3VidHJlZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IGNhbGxiYWNrXG4gKiBAcGFyYW0ge0VsZW1lbnQ9fSBvcHRfc3RvcEF0IG9wdGlvbmFsIGVsZW1udCB0byBzdG9wIHRoZSBzZWFyY2ggYXQuXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsb3Nlc3QoZWxlbWVudCwgY2FsbGJhY2ssIG9wdF9zdG9wQXQpIHtcbiAgZm9yIChsZXQgZWwgPSBlbGVtZW50OyBlbCAmJiBlbCAhPT0gb3B0X3N0b3BBdDsgZWwgPSBlbC5wYXJlbnRFbGVtZW50KSB7XG4gICAgaWYgKGNhbGxiYWNrKGVsKSkge1xuICAgICAgcmV0dXJuIGVsO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBjbG9zZXN0IG5vZGUgdGhhdCBzYXRpc2ZpZXMgdGhlIGNhbGxiYWNrIGZyb20gdGhpcyBub2RlXG4gKiB1cCB0aGUgRE9NIHN1YnRyZWUuXG4gKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFOb2RlKTpib29sZWFufSBjYWxsYmFja1xuICogQHJldHVybiB7P05vZGV9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbG9zZXN0Tm9kZShub2RlLCBjYWxsYmFjaykge1xuICBmb3IgKGxldCBuID0gbm9kZTsgbjsgbiA9IG4ucGFyZW50Tm9kZSkge1xuICAgIGlmIChjYWxsYmFjayhuKSkge1xuICAgICAgcmV0dXJuIG47XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGNsb3Nlc3QgZWxlbWVudCB3aXRoIHRoZSBzcGVjaWZpZWQgbmFtZSBmcm9tIHRoaXMgZWxlbWVudFxuICogdXAgdGhlIERPTSBzdWJ0cmVlLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWVcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VzdEJ5VGFnKGVsZW1lbnQsIHRhZ05hbWUpIHtcbiAgaWYgKGVsZW1lbnQuY2xvc2VzdCkge1xuICAgIHJldHVybiBlbGVtZW50LmNsb3Nlc3QodGFnTmFtZSk7XG4gIH1cbiAgdGFnTmFtZSA9IHRhZ05hbWUudG9VcHBlckNhc2UoKTtcbiAgcmV0dXJuIGNsb3Nlc3QoZWxlbWVudCwgZWwgPT4ge1xuICAgIHJldHVybiBlbC50YWdOYW1lID09IHRhZ05hbWU7XG4gIH0pO1xufVxuXG4vKipcbiAqIEZpbmRzIHRoZSBjbG9zZXN0IGVsZW1lbnQgd2l0aCB0aGUgc3BlY2lmaWVkIHNlbGVjdG9yIGZyb20gdGhpcyBlbGVtZW50XG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcbiAqIEByZXR1cm4gez9FbGVtZW50fSBjbG9zZXN0IGFuY2VzdG9yIGlmIGZvdW5kLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VzdEJ5U2VsZWN0b3IoZWxlbWVudCwgc2VsZWN0b3IpIHtcbiAgaWYgKGVsZW1lbnQuY2xvc2VzdCkge1xuICAgIHJldHVybiBlbGVtZW50LmNsb3Nlc3Qoc2VsZWN0b3IpO1xuICB9XG5cbiAgcmV0dXJuIGNsb3Nlc3QoZWxlbWVudCwgZWwgPT4ge1xuICAgIHJldHVybiBtYXRjaGVzKGVsLCBzZWxlY3Rvcik7XG4gIH0pO1xufVxuXG4vKipcbiAqIENoZWNrcyBpZiB0aGUgZ2l2ZW4gZWxlbWVudCBtYXRjaGVzIHRoZSBzZWxlY3RvclxuICogQHBhcmFtICB7IUVsZW1lbnR9IGVsIFRoZSBlbGVtZW50IHRvIHZlcmlmeVxuICogQHBhcmFtICB7c3RyaW5nfSBzZWxlY3RvciBUaGUgc2VsZWN0b3IgdG8gY2hlY2sgYWdhaW5zdFxuICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgZWxlbWVudCBtYXRjaGVkIHRoZSBzZWxlY3Rvci4gRmFsc2Ugb3RoZXJ3aXNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbWF0Y2hlcyhlbCwgc2VsZWN0b3IpIHtcbiAgY29uc3QgbWF0Y2hlciA9IGVsLm1hdGNoZXMgfHxcbiAgICAgIGVsLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fFxuICAgICAgZWwubW96TWF0Y2hlc1NlbGVjdG9yIHx8XG4gICAgICBlbC5tc01hdGNoZXNTZWxlY3RvciB8fFxuICAgICAgZWwub01hdGNoZXNTZWxlY3RvcjtcbiAgaWYgKG1hdGNoZXIpIHtcbiAgICByZXR1cm4gbWF0Y2hlci5jYWxsKGVsLCBzZWxlY3Rvcik7XG4gIH1cbiAgcmV0dXJuIGZhbHNlOyAvLyBJRTggYWx3YXlzIHJldHVybnMgZmFsc2UuXG59XG5cbi8qKlxuICogRmluZHMgdGhlIGZpcnN0IGRlc2NlbmRhbnQgZWxlbWVudCB3aXRoIHRoZSBzcGVjaWZpZWQgbmFtZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IURvY3VtZW50fCFTaGFkb3dSb290fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlbGVtZW50QnlUYWcoZWxlbWVudCwgdGFnTmFtZSkge1xuICBsZXQgZWxlbWVudHM7XG4gIC8vIGdldEVsZW1lbnRzQnlUYWdOYW1lKCkgaXMgbm90IHN1cHBvcnRlZCBvbiBTaGFkb3dSb290LlxuICBpZiAodHlwZW9mIGVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICBlbGVtZW50cyA9IGVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnTmFtZSk7XG4gIH0gZWxzZSB7XG4gICAgZWxlbWVudHMgPSBlbGVtZW50Li8qT0sqL3F1ZXJ5U2VsZWN0b3JBbGwodGFnTmFtZSk7XG4gIH1cbiAgcmV0dXJuIChlbGVtZW50cyAmJiBlbGVtZW50c1swXSkgfHwgbnVsbDtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBmaXJzdCBjaGlsZCBlbGVtZW50IHRoYXQgc2F0aXNmaWVzIHRoZSBjYWxsYmFjay5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGRFbGVtZW50KHBhcmVudCwgY2FsbGJhY2spIHtcbiAgZm9yIChsZXQgY2hpbGQgPSBwYXJlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7IGNoaWxkO1xuICAgIGNoaWxkID0gY2hpbGQubmV4dEVsZW1lbnRTaWJsaW5nKSB7XG4gICAgaWYgKGNhbGxiYWNrKGNoaWxkKSkge1xuICAgICAgcmV0dXJuIGNoaWxkO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4vKipcbiAqIEZpbmRzIGFsbCBjaGlsZCBlbGVtZW50cyB0aGF0IHNhdGlzZnkgdGhlIGNhbGxiYWNrLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjYWxsYmFja1xuICogQHJldHVybiB7IUFycmF5PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudHMocGFyZW50LCBjYWxsYmFjaykge1xuICBjb25zdCBjaGlsZHJlbiA9IFtdO1xuICBmb3IgKGxldCBjaGlsZCA9IHBhcmVudC5maXJzdEVsZW1lbnRDaGlsZDsgY2hpbGQ7XG4gICAgY2hpbGQgPSBjaGlsZC5uZXh0RWxlbWVudFNpYmxpbmcpIHtcbiAgICBpZiAoY2FsbGJhY2soY2hpbGQpKSB7XG4gICAgICBjaGlsZHJlbi5wdXNoKGNoaWxkKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGNoaWxkcmVuO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGxhc3QgY2hpbGQgZWxlbWVudCB0aGF0IHNhdGlzZmllcyB0aGUgY2FsbGJhY2suXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IGNhbGxiYWNrXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxhc3RDaGlsZEVsZW1lbnQocGFyZW50LCBjYWxsYmFjaykge1xuICBmb3IgKGxldCBjaGlsZCA9IHBhcmVudC5sYXN0RWxlbWVudENoaWxkOyBjaGlsZDtcbiAgICBjaGlsZCA9IGNoaWxkLnByZXZpb3VzRWxlbWVudFNpYmxpbmcpIHtcbiAgICBpZiAoY2FsbGJhY2soY2hpbGQpKSB7XG4gICAgICByZXR1cm4gY2hpbGQ7XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIEZpbmRzIGFsbCBjaGlsZCBub2RlcyB0aGF0IHNhdGlzZnkgdGhlIGNhbGxiYWNrLlxuICogVGhlc2Ugbm9kZXMgY2FuIGluY2x1ZGUgVGV4dCwgQ29tbWVudCBhbmQgb3RoZXIgY2hpbGQgbm9kZXMuXG4gKiBAcGFyYW0geyFOb2RlfSBwYXJlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIU5vZGUpOmJvb2xlYW59IGNhbGxiYWNrXG4gKiBAcmV0dXJuIHshQXJyYXk8IU5vZGU+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGROb2RlcyhwYXJlbnQsIGNhbGxiYWNrKSB7XG4gIGNvbnN0IG5vZGVzID0gW107XG4gIGZvciAobGV0IGNoaWxkID0gcGFyZW50LmZpcnN0Q2hpbGQ7IGNoaWxkO1xuICAgIGNoaWxkID0gY2hpbGQubmV4dFNpYmxpbmcpIHtcbiAgICBpZiAoY2FsbGJhY2soY2hpbGQpKSB7XG4gICAgICBub2Rlcy5wdXNoKGNoaWxkKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG5vZGVzO1xufVxuXG4vKipcbiAqIEB0eXBlIHtib29sZWFufHVuZGVmaW5lZH1cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5sZXQgc2NvcGVTZWxlY3RvclN1cHBvcnRlZDtcblxuLyoqXG4gKiBAcGFyYW0ge2Jvb2xlYW58dW5kZWZpbmVkfSB2YWxcbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0U2NvcGVTZWxlY3RvclN1cHBvcnRlZEZvclRlc3RpbmcodmFsKSB7XG4gIHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQgPSB2YWw7XG59XG5cbi8qKlxuICogVGVzdCB0aGF0IHRoZSA6c2NvcGUgc2VsZWN0b3IgaXMgc3VwcG9ydGVkIGFuZCBiZWhhdmVzIGNvcnJlY3RseS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNTY29wZVNlbGVjdG9yU3VwcG9ydGVkKHBhcmVudCkge1xuICBjb25zdCBkb2MgPSBwYXJlbnQub3duZXJEb2N1bWVudDtcbiAgdHJ5IHtcbiAgICBjb25zdCB0ZXN0RWxlbWVudCA9IGRvYy5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25zdCB0ZXN0Q2hpbGQgPSBkb2MuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGVzdEVsZW1lbnQuYXBwZW5kQ2hpbGQodGVzdENoaWxkKTtcbiAgICAvLyBOT1RFKGN2aWFsaXosICMxMjM4Myk6IEZpcmVmb3gncyBpbXBsZW1lbnRhdGlvbiBpcyBpbmNvbXBsZXRlLFxuICAgIC8vIHRoZXJlZm9yZSB3ZSB0ZXN0IGFjdHVhbCBmdW5jdGlvbmFsaXR5IG9mYDpzY29wZWAgYXMgd2VsbC5cbiAgICByZXR1cm4gdGVzdEVsZW1lbnQuLypPSyovcXVlcnlTZWxlY3RvcignOnNjb3BlIGRpdicpID09PSB0ZXN0Q2hpbGQ7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuLyoqXG4gKiBGaW5kcyB0aGUgZmlyc3QgY2hpbGQgZWxlbWVudCB0aGF0IGhhcyB0aGUgc3BlY2lmaWVkIGF0dHJpYnV0ZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtzdHJpbmd9IGF0dHJcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGRFbGVtZW50QnlBdHRyKHBhcmVudCwgYXR0cikge1xuICByZXR1cm4gc2NvcGVkUXVlcnlTZWxlY3Rvci8qT0sqLyhwYXJlbnQsIGA+IFske2F0dHJ9XWApO1xufVxuXG5cbi8qKlxuICogRmluZHMgdGhlIGxhc3QgY2hpbGQgZWxlbWVudCB0aGF0IGhhcyB0aGUgc3BlY2lmaWVkIGF0dHJpYnV0ZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtzdHJpbmd9IGF0dHJcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGFzdENoaWxkRWxlbWVudEJ5QXR0cihwYXJlbnQsIGF0dHIpIHtcbiAgcmV0dXJuIGxhc3RDaGlsZEVsZW1lbnQocGFyZW50LCBlbCA9PiB7XG4gICAgcmV0dXJuIGVsLmhhc0F0dHJpYnV0ZShhdHRyKTtcbiAgfSk7XG59XG5cblxuLyoqXG4gKiBGaW5kcyBhbGwgY2hpbGQgZWxlbWVudHMgdGhhdCBoYXMgdGhlIHNwZWNpZmllZCBhdHRyaWJ1dGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyXG4gKiBAcmV0dXJuIHshTm9kZUxpc3Q8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGRFbGVtZW50c0J5QXR0cihwYXJlbnQsIGF0dHIpIHtcbiAgcmV0dXJuIHNjb3BlZFF1ZXJ5U2VsZWN0b3JBbGwvKk9LKi8ocGFyZW50LCBgPiBbJHthdHRyfV1gKTtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBmaXJzdCBjaGlsZCBlbGVtZW50IHRoYXQgaGFzIHRoZSBzcGVjaWZpZWQgdGFnIG5hbWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudEJ5VGFnKHBhcmVudCwgdGFnTmFtZSkge1xuICByZXR1cm4gc2NvcGVkUXVlcnlTZWxlY3Rvci8qT0sqLyhwYXJlbnQsIGA+ICR7dGFnTmFtZX1gKTtcbn1cblxuXG4vKipcbiAqIEZpbmRzIGFsbCBjaGlsZCBlbGVtZW50cyB3aXRoIHRoZSBzcGVjaWZpZWQgdGFnIG5hbWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lXG4gKiBAcmV0dXJuIHshTm9kZUxpc3Q8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hpbGRFbGVtZW50c0J5VGFnKHBhcmVudCwgdGFnTmFtZSkge1xuICByZXR1cm4gc2NvcGVkUXVlcnlTZWxlY3RvckFsbC8qT0sqLyhwYXJlbnQsIGA+ICR7dGFnTmFtZX1gKTtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBmaXJzdCBlbGVtZW50IHRoYXQgbWF0Y2hlcyBgc2VsZWN0b3JgLCBzY29wZWQgaW5zaWRlIGByb290YC5cbiAqIE5vdGU6IGluIElFLCB0aGlzIGNhdXNlcyBhIHF1aWNrIG11dGF0aW9uIG9mIHRoZSBlbGVtZW50J3MgY2xhc3MgbGlzdC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHJvb3RcbiAqIEBwYXJhbSB7c3RyaW5nfSBzZWxlY3RvclxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzY29wZWRRdWVyeVNlbGVjdG9yKHJvb3QsIHNlbGVjdG9yKSB7XG4gIGlmIChzY29wZVNlbGVjdG9yU3VwcG9ydGVkID09IG51bGwpIHtcbiAgICBzY29wZVNlbGVjdG9yU3VwcG9ydGVkID0gaXNTY29wZVNlbGVjdG9yU3VwcG9ydGVkKHJvb3QpO1xuICB9XG4gIGlmIChzY29wZVNlbGVjdG9yU3VwcG9ydGVkKSB7XG4gICAgcmV0dXJuIHJvb3QuLypPSyovcXVlcnlTZWxlY3RvcihgOnNjb3BlICR7c2VsZWN0b3J9YCk7XG4gIH1cblxuICAvLyBPbmx5IElFLlxuICBjb25zdCB1bmlxdWUgPSAnaS1hbXBodG1sLXNjb3BlZCc7XG4gIHJvb3QuY2xhc3NMaXN0LmFkZCh1bmlxdWUpO1xuICBjb25zdCBlbGVtZW50ID0gcm9vdC4vKk9LKi9xdWVyeVNlbGVjdG9yKGAuJHt1bmlxdWV9ICR7c2VsZWN0b3J9YCk7XG4gIHJvb3QuY2xhc3NMaXN0LnJlbW92ZSh1bmlxdWUpO1xuICByZXR1cm4gZWxlbWVudDtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBldmVyeSBlbGVtZW50IHRoYXQgbWF0Y2hlcyBgc2VsZWN0b3JgLCBzY29wZWQgaW5zaWRlIGByb290YC5cbiAqIE5vdGU6IGluIElFLCB0aGlzIGNhdXNlcyBhIHF1aWNrIG11dGF0aW9uIG9mIHRoZSBlbGVtZW50J3MgY2xhc3MgbGlzdC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHJvb3RcbiAqIEBwYXJhbSB7c3RyaW5nfSBzZWxlY3RvclxuICogQHJldHVybiB7IU5vZGVMaXN0PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNjb3BlZFF1ZXJ5U2VsZWN0b3JBbGwocm9vdCwgc2VsZWN0b3IpIHtcbiAgaWYgKHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQgPT0gbnVsbCkge1xuICAgIHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQgPSBpc1Njb3BlU2VsZWN0b3JTdXBwb3J0ZWQocm9vdCk7XG4gIH1cbiAgaWYgKHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQpIHtcbiAgICByZXR1cm4gcm9vdC4vKk9LKi9xdWVyeVNlbGVjdG9yQWxsKGA6c2NvcGUgJHtzZWxlY3Rvcn1gKTtcbiAgfVxuXG4gIC8vIE9ubHkgSUUuXG4gIGNvbnN0IHVuaXF1ZSA9ICdpLWFtcGh0bWwtc2NvcGVkJztcbiAgcm9vdC5jbGFzc0xpc3QuYWRkKHVuaXF1ZSk7XG4gIGNvbnN0IGVsZW1lbnRzID0gcm9vdC4vKk9LKi9xdWVyeVNlbGVjdG9yQWxsKGAuJHt1bmlxdWV9ICR7c2VsZWN0b3J9YCk7XG4gIHJvb3QuY2xhc3NMaXN0LnJlbW92ZSh1bmlxdWUpO1xuICByZXR1cm4gZWxlbWVudHM7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGVsZW1lbnQgZGF0YS1wYXJhbS0gYXR0cmlidXRlcyBhcyB1cmwgcGFyYW1ldGVycyBrZXktdmFsdWUgcGFpcnMuXG4gKiBlLmcuIGRhdGEtcGFyYW0tc29tZS1hdHRyPXZhbHVlIC0+IHtzb21lQXR0cjogdmFsdWV9LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtmdW5jdGlvbihzdHJpbmcpOnN0cmluZz19IG9wdF9jb21wdXRlUGFyYW1OYW1lRnVuYyB0byBjb21wdXRlIHRoZVxuICogICAgcGFyYW1ldGVyIG5hbWUsIGdldCBwYXNzZWQgdGhlIGNhbWVsLWNhc2UgcGFyYW1ldGVyIG5hbWUuXG4gKiBAcGFyYW0geyFSZWdFeHA9fSBvcHRfcGFyYW1QYXR0ZXJuIFJlZ2V4IHBhdHRlcm4gdG8gbWF0Y2ggZGF0YSBhdHRyaWJ1dGVzLlxuICogQHJldHVybiB7IUpzb25PYmplY3R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXREYXRhUGFyYW1zRnJvbUF0dHJpYnV0ZXMoZWxlbWVudCwgb3B0X2NvbXB1dGVQYXJhbU5hbWVGdW5jLFxuICBvcHRfcGFyYW1QYXR0ZXJuKSB7XG4gIGNvbnN0IGNvbXB1dGVQYXJhbU5hbWVGdW5jID0gb3B0X2NvbXB1dGVQYXJhbU5hbWVGdW5jIHx8IChrZXkgPT4ga2V5KTtcbiAgY29uc3Qge2RhdGFzZXR9ID0gZWxlbWVudDtcbiAgY29uc3QgcGFyYW1zID0gZGljdCgpO1xuICBjb25zdCBwYXJhbVBhdHRlcm4gPSBvcHRfcGFyYW1QYXR0ZXJuID8gb3B0X3BhcmFtUGF0dGVybiA6IC9ecGFyYW0oLispLztcbiAgZm9yIChjb25zdCBrZXkgaW4gZGF0YXNldCkge1xuICAgIGNvbnN0IG1hdGNoZXMgPSBrZXkubWF0Y2gocGFyYW1QYXR0ZXJuKTtcbiAgICBpZiAobWF0Y2hlcykge1xuICAgICAgY29uc3QgcGFyYW0gPSBtYXRjaGVzWzFdWzBdLnRvTG93ZXJDYXNlKCkgKyBtYXRjaGVzWzFdLnN1YnN0cigxKTtcbiAgICAgIHBhcmFtc1tjb21wdXRlUGFyYW1OYW1lRnVuYyhwYXJhbSldID0gZGF0YXNldFtrZXldO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcGFyYW1zO1xufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGVsZW1lbnQgaGF2ZSBhIG5leHQgbm9kZSBpbiB0aGUgZG9jdW1lbnQgb3JkZXIuXG4gKiBUaGlzIG1lYW5zIGVpdGhlcjpcbiAqICBhLiBUaGUgZWxlbWVudCBpdHNlbGYgaGFzIGEgbmV4dFNpYmxpbmcuXG4gKiAgYi4gQW55IG9mIHRoZSBlbGVtZW50IGFuY2VzdG9ycyBoYXMgYSBuZXh0U2libGluZy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7P05vZGV9IG9wdF9zdG9wTm9kZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc05leHROb2RlSW5Eb2N1bWVudE9yZGVyKGVsZW1lbnQsIG9wdF9zdG9wTm9kZSkge1xuICBsZXQgY3VycmVudEVsZW1lbnQgPSBlbGVtZW50O1xuICBkbyB7XG4gICAgaWYgKGN1cnJlbnRFbGVtZW50Lm5leHRTaWJsaW5nKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH0gd2hpbGUgKChjdXJyZW50RWxlbWVudCA9IGN1cnJlbnRFbGVtZW50LnBhcmVudE5vZGUpICYmXG4gICAgICAgICAgICBjdXJyZW50RWxlbWVudCAhPSBvcHRfc3RvcE5vZGUpO1xuICByZXR1cm4gZmFsc2U7XG59XG5cblxuLyoqXG4gKiBGaW5kcyBhbGwgYW5jZXN0b3IgZWxlbWVudHMgdGhhdCBzYXRpc2Z5IHByZWRpY2F0ZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGNoaWxkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBwcmVkaWNhdGVcbiAqIEByZXR1cm4geyFBcnJheTwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhbmNlc3RvckVsZW1lbnRzKGNoaWxkLCBwcmVkaWNhdGUpIHtcbiAgY29uc3QgYW5jZXN0b3JzID0gW107XG4gIGZvciAobGV0IGFuY2VzdG9yID0gY2hpbGQucGFyZW50RWxlbWVudDsgYW5jZXN0b3I7XG4gICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnRFbGVtZW50KSB7XG4gICAgaWYgKHByZWRpY2F0ZShhbmNlc3RvcikpIHtcbiAgICAgIGFuY2VzdG9ycy5wdXNoKGFuY2VzdG9yKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGFuY2VzdG9ycztcbn1cblxuXG4vKipcbiAqIEZpbmRzIGFsbCBhbmNlc3RvciBlbGVtZW50cyB0aGF0IGhhcyB0aGUgc3BlY2lmaWVkIHRhZyBuYW1lLlxuICogQHBhcmFtIHshRWxlbWVudH0gY2hpbGRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lXG4gKiBAcmV0dXJuIHshQXJyYXk8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gYW5jZXN0b3JFbGVtZW50c0J5VGFnKGNoaWxkLCB0YWdOYW1lKSB7XG4gIHRhZ05hbWUgPSB0YWdOYW1lLnRvVXBwZXJDYXNlKCk7XG4gIHJldHVybiBhbmNlc3RvckVsZW1lbnRzKGNoaWxkLCBlbCA9PiB7XG4gICAgcmV0dXJuIGVsLnRhZ05hbWUgPT0gdGFnTmFtZTtcbiAgfSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGNsb25lIG9mIHRoZSBjb250ZW50IG9mIGEgdGVtcGxhdGUgZWxlbWVudC5cbiAqXG4gKiBQb2x5ZmlsbCB0byByZXBsYWNlIC5jb250ZW50IGFjY2VzcyBmb3IgYnJvd3NlcnMgdGhhdCBkbyBub3Qgc3VwcG9ydFxuICogSFRNTFRlbXBsYXRlRWxlbWVudHMgbmF0aXZlbHkuXG4gKlxuICogQHBhcmFtIHshSFRNTFRlbXBsYXRlRWxlbWVudHwhRWxlbWVudH0gdGVtcGxhdGVcbiAqIEByZXR1cm4geyFEb2N1bWVudEZyYWdtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gdGVtcGxhdGVDb250ZW50Q2xvbmUodGVtcGxhdGUpIHtcbiAgaWYgKCdjb250ZW50JyBpbiB0ZW1wbGF0ZSkge1xuICAgIHJldHVybiB0ZW1wbGF0ZS5jb250ZW50LmNsb25lTm9kZSh0cnVlKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBjb250ZW50ID0gdGVtcGxhdGUub3duZXJEb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgY29weUNoaWxkcmVuKHRlbXBsYXRlLCBjb250ZW50KTtcbiAgICByZXR1cm4gY29udGVudDtcbiAgfVxufVxuXG4vKipcbiAqIEl0ZXJhdGUgb3ZlciBhbiBhcnJheS1saWtlLiBTb21lIGNvbGxlY3Rpb25zIGxpa2UgTm9kZUxpc3QgYXJlXG4gKiBsYXppbHkgZXZhbHVhdGVkIGluIHNvbWUgYnJvd3NlcnMsIGFuZCBhY2Nlc3NpbmcgYGxlbmd0aGAgZm9yY2VzIGZ1bGxcbiAqIGV2YWx1YXRpb24uIFdlIGNhbiBpbXByb3ZlIHBlcmZvcm1hbmNlIGJ5IGl0ZXJhdGluZyB1bnRpbCBhbiBlbGVtZW50IGlzXG4gKiBgdW5kZWZpbmVkYCB0byBhdm9pZCBjaGVja2luZyB0aGUgYGxlbmd0aGAgcHJvcGVydHkuXG4gKiBUZXN0IGNhc2VzOiBodHRwczovL2pzcGVyZi5jb20vaXRlcmF0aW5nLW92ZXItY29sbGVjdGlvbnMtb2YtZWxlbWVudHNcbiAqIEBwYXJhbSB7IUlBcnJheUxpa2U8VD59IGl0ZXJhYmxlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKFQsIG51bWJlcil9IGNiXG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXRlcmF0ZUN1cnNvcihpdGVyYWJsZSwgY2IpIHtcbiAgZm9yIChsZXQgaSA9IDAsIHZhbHVlOyAodmFsdWUgPSBpdGVyYWJsZVtpXSkgIT09IHVuZGVmaW5lZDsgaSsrKSB7XG4gICAgY2IodmFsdWUsIGkpO1xuICB9XG59XG5cbi8qKlxuICogVGhpcyBtZXRob2Qgd3JhcHMgYXJvdW5kIHdpbmRvdydzIG9wZW4gbWV0aG9kLiBJdCBmaXJzdCB0cmllcyB0byBleGVjdXRlXG4gKiBgb3BlbmAgY2FsbCB3aXRoIHRoZSBwcm92aWRlZCB0YXJnZXQgYW5kIGlmIGl0IGZhaWxzLCBpdCByZXRyaWVzIHRoZSBjYWxsXG4gKiB3aXRoIHRoZSBgX3RvcGAgdGFyZ2V0LiBUaGlzIGlzIG5lY2Vzc2FyeSBnaXZlbiB0aGF0IGluIHNvbWUgZW1iZWRkaW5nXG4gKiBzY2VuYXJpb3MsIHN1Y2ggYXMgaU9TJyBXS1dlYlZpZXcsIG5hdmlnYXRpb24gdG8gYF9ibGFua2AgYW5kIG90aGVyIHRhcmdldHNcbiAqIGlzIGJsb2NrZWQgYnkgZGVmYXVsdC5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHBhcmFtIHtzdHJpbmd9IHRhcmdldFxuICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfZmVhdHVyZXNcbiAqIEByZXR1cm4gez9XaW5kb3d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvcGVuV2luZG93RGlhbG9nKHdpbiwgdXJsLCB0YXJnZXQsIG9wdF9mZWF0dXJlcykge1xuICAvLyBUcnkgZmlyc3Qgd2l0aCB0aGUgc3BlY2lmaWVkIHRhcmdldC4gSWYgd2UncmUgaW5zaWRlIHRoZSBXS1dlYlZpZXcgb3JcbiAgLy8gYSBzaW1pbGFyIGVudmlyb25tZW50cywgdGhpcyBtZXRob2QgaXMgZXhwZWN0ZWQgdG8gZmFpbCBieSBkZWZhdWx0IGZvclxuICAvLyBhbGwgdGFyZ2V0cyBleGNlcHQgYF90b3BgLlxuICBsZXQgcmVzO1xuICB0cnkge1xuICAgIHJlcyA9IHdpbi5vcGVuKHVybCwgdGFyZ2V0LCBvcHRfZmVhdHVyZXMpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgZGV2KCkuZXJyb3IoJ0RPTScsICdGYWlsZWQgdG8gb3BlbiB1cmwgb24gdGFyZ2V0OiAnLCB0YXJnZXQsIGUpO1xuICB9XG5cbiAgLy8gVGhlbiB0cnkgd2l0aCBgX3RvcGAgdGFyZ2V0LlxuICBpZiAoIXJlcyAmJiB0YXJnZXQgIT0gJ190b3AnKSB7XG4gICAgcmVzID0gd2luLm9wZW4odXJsLCAnX3RvcCcpO1xuICB9XG4gIHJldHVybiByZXM7XG59XG5cbi8qKlxuICogV2hldGhlciB0aGUgZWxlbWVudCBpcyBhIHNjcmlwdCB0YWcgd2l0aCBhcHBsaWNhdGlvbi9qc29uIHR5cGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNKc29uU2NyaXB0VGFnKGVsZW1lbnQpIHtcbiAgcmV0dXJuIGVsZW1lbnQudGFnTmFtZSA9PSAnU0NSSVBUJyAmJlxuICAgICAgICAgICAgZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKS50b1VwcGVyQ2FzZSgpID09ICdBUFBMSUNBVElPTi9KU09OJztcbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBlbGVtZW50IGlzIGEgc2NyaXB0IHRhZyB3aXRoIGFwcGxpY2F0aW9uL2pzb24gdHlwZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0pzb25MZFNjcmlwdFRhZyhlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50LnRhZ05hbWUgPT0gJ1NDUklQVCcgJiZcbiAgICAgIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykudG9VcHBlckNhc2UoKSA9PSAnQVBQTElDQVRJT04vTEQrSlNPTic7XG59XG5cbi8qKlxuICogV2hldGhlciB0aGUgcGFnZSdzIGRpcmVjdGlvbiBpcyByaWdodCB0byBsZWZ0IG9yIG5vdC5cbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2NcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1JUTChkb2MpIHtcbiAgY29uc3QgZGlyID0gZG9jLmJvZHkuZ2V0QXR0cmlidXRlKCdkaXInKVxuICAgICAgICAgICAgICAgICB8fCBkb2MuZG9jdW1lbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGlyJylcbiAgICAgICAgICAgICAgICAgfHwgJ2x0cic7XG4gIHJldHVybiBkaXIgPT0gJ3J0bCc7XG59XG5cblxuLyoqXG4gKiBFc2NhcGVzIGFuIGlkZW50IChJRCBvciBhIGNsYXNzIG5hbWUpIHRvIGJlIHVzZWQgYXMgYSBDU1Mgc2VsZWN0b3IuXG4gKlxuICogU2VlIGh0dHBzOi8vZHJhZnRzLmNzc3dnLm9yZy9jc3NvbS8jc2VyaWFsaXplLWFuLWlkZW50aWZpZXIuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGlkZW50XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVDc3NTZWxlY3RvcklkZW50KGlkZW50KSB7XG4gIHJldHVybiBjc3NFc2NhcGUoaWRlbnQpO1xufVxuXG4vKipcbiAqIEVzY2FwZXMgYW4gaWRlbnQgaW4gYSB3YXkgdGhhdCBjYW4gYmUgdXNlZCBieSA6bnRoLWNoaWxkKCkgcHN1ZWRvLWNsYXNzLlxuICpcbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdzNjL2Nzc3dnLWRyYWZ0cy9pc3N1ZXMvMjMwNi5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IGlkZW50XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVDc3NTZWxlY3Rvck50aChpZGVudCkge1xuICBjb25zdCBlc2NhcGVkID0gU3RyaW5nKGlkZW50KTtcbiAgLy8gRW5zdXJlIGl0IGRvZXNuJ3QgY2xvc2UgdGhlIG50aC1jaGlsZCBwc3VlZG8gY2xhc3MuXG4gIGRldigpLmFzc2VydChlc2NhcGVkLmluZGV4T2YoJyknKSA9PT0gLTEpO1xuICByZXR1cm4gZXNjYXBlZDtcbn1cblxuLyoqXG4gKiBFc2NhcGVzIGA8YCwgYD5gIGFuZCBvdGhlciBIVE1MIGNoYXJjYXRlcnMgd2l0aCB0aGVpciBlc2NhcGVkIGZvcm1zLlxuICogQHBhcmFtIHtzdHJpbmd9IHRleHRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVzY2FwZUh0bWwodGV4dCkge1xuICBpZiAoIXRleHQpIHtcbiAgICByZXR1cm4gdGV4dDtcbiAgfVxuICByZXR1cm4gdGV4dC5yZXBsYWNlKEhUTUxfRVNDQVBFX1JFR0VYLCBlc2NhcGVIdG1sQ2hhcik7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IGNcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gZXNjYXBlSHRtbENoYXIoYykge1xuICByZXR1cm4gSFRNTF9FU0NBUEVfQ0hBUlNbY107XG59XG5cbi8qKlxuICogVHJpZXMgdG8gZm9jdXMgb24gdGhlIGdpdmVuIGVsZW1lbnQ7IGZhaWxzIHNpbGVudGx5IGlmIGJyb3dzZXIgdGhyb3dzIGFuXG4gKiBleGNlcHRpb24uXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnlGb2N1cyhlbGVtZW50KSB7XG4gIHRyeSB7XG4gICAgZWxlbWVudC4vKk9LKi9mb2N1cygpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gSUUgPD0gNyBtYXkgdGhyb3cgZXhjZXB0aW9ucyB3aGVuIGZvY3VzaW5nIG9uIGhpZGRlbiBpdGVtcy5cbiAgfVxufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGdpdmVuIHdpbmRvdyBpcyBpbiBhbiBpZnJhbWUgb3Igbm90LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0lmcmFtZWQod2luKSB7XG4gIHJldHVybiB3aW4ucGFyZW50ICYmIHdpbi5wYXJlbnQgIT0gd2luO1xufVxuXG4vKipcbiAqIERldGVybWluZXMgaWYgdGhpcyBlbGVtZW50IGlzIGFuIEFNUCBlbGVtZW50XG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBbXBFbGVtZW50KGVsZW1lbnQpIHtcbiAgY29uc3QgdGFnID0gZWxlbWVudC50YWdOYW1lO1xuICAvLyBVc2UgcHJlZml4IHRvIHJlY29nbml6ZSBBTVAgZWxlbWVudC4gVGhpcyBpcyBuZWNlc3NhcnkgYmVjYXVzZSBzdHViXG4gIC8vIG1heSBub3QgYmUgYXR0YWNoZWQgeWV0LlxuICByZXR1cm4gc3RhcnRzV2l0aCh0YWcsICdBTVAtJykgJiZcbiAgICAgIC8vIFNvbWUgXCJhbXAtKlwiIGVsZW1lbnRzIGFyZSBub3QgcmVhbGx5IEFNUCBlbGVtZW50cy4gOnNtaDpcbiAgICAgICEodGFnID09ICdBTVAtU1RJQ0tZLUFELVRPUC1QQURESU5HJyB8fCB0YWcgPT0gJ0FNUC1CT0RZJyk7XG59XG5cbi8qKlxuICogUmV0dXJuIGEgcHJvbWlzZSB0aGF0IHJlc29sdmUgd2hlbiBhbiBBTVAgZWxlbWVudCB1cGdyYWRlIGZyb20gSFRNTEVsZW1lbnRcbiAqIHRvIEN1c3RvbUVsZW1lbnRcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4geyFQcm9taXNlPCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdoZW5VcGdyYWRlZFRvQ3VzdG9tRWxlbWVudChlbGVtZW50KSB7XG4gIGRldigpLmFzc2VydChpc0FtcEVsZW1lbnQoZWxlbWVudCksICdlbGVtZW50IGlzIG5vdCBBbXBFbGVtZW50Jyk7XG4gIGlmIChlbGVtZW50LmNyZWF0ZWRDYWxsYmFjaykge1xuICAgIC8vIEVsZW1lbnQgYWxyZWFkeSBpcyBDdXN0b21FbGVtZW50O1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZWxlbWVudCk7XG4gIH1cbiAgLy8gSWYgRWxlbWVudCBpcyBzdGlsbCBIVE1MRWxlbWVudCwgd2FpdCBmb3IgaXQgdG8gdXBncmFkZSB0byBjdXN0b21FbGVtZW50XG4gIC8vIE5vdGU6IHVzZSBwdXJlIHN0cmluZyB0byBhdm9pZCBvYmZ1c2NhdGlvbiBiZXR3ZWVuIHZlcnNpb25zLlxuICBpZiAoIWVsZW1lbnRbVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1BST01JU0VdKSB7XG4gICAgY29uc3QgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICBlbGVtZW50W1VQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9QUk9NSVNFXSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgZWxlbWVudFtVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUkVTT0xWRVJdID0gZGVmZXJyZWQucmVzb2x2ZTtcblxuICB9XG5cbiAgcmV0dXJuIGVsZW1lbnRbVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1BST01JU0VdO1xufVxuXG4vKipcbiAqIFJlcGxhY2VtZW50IGZvciBgRWxlbWVudC5yZXF1ZXN0RnVsbHNjcmVlbigpYCBtZXRob2QuXG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvRWxlbWVudC9yZXF1ZXN0RnVsbHNjcmVlblxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gZnVsbHNjcmVlbkVudGVyKGVsZW1lbnQpIHtcbiAgY29uc3QgcmVxdWVzdEZzID0gZWxlbWVudC5yZXF1ZXN0RnVsbHNjcmVlblxuICAgfHwgZWxlbWVudC5yZXF1ZXN0RnVsbFNjcmVlblxuICAgfHwgZWxlbWVudC53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlblxuICAgfHwgZWxlbWVudC53ZWJraXRSZXF1ZXN0RnVsbFNjcmVlblxuICAgfHwgZWxlbWVudC53ZWJraXRFbnRlckZ1bGxzY3JlZW5cbiAgIHx8IGVsZW1lbnQud2Via2l0RW50ZXJGdWxsU2NyZWVuXG4gICB8fCBlbGVtZW50Lm1zUmVxdWVzdEZ1bGxzY3JlZW5cbiAgIHx8IGVsZW1lbnQubXNSZXF1ZXN0RnVsbFNjcmVlblxuICAgfHwgZWxlbWVudC5tb3pSZXF1ZXN0RnVsbHNjcmVlblxuICAgfHwgZWxlbWVudC5tb3pSZXF1ZXN0RnVsbFNjcmVlbjtcbiAgaWYgKHJlcXVlc3RGcykge1xuICAgIHJlcXVlc3RGcy5jYWxsKGVsZW1lbnQpO1xuICB9XG59XG5cbi8qKlxuICogUmVwbGFjZW1lbnQgZm9yIGBEb2N1bWVudC5leGl0RnVsbHNjcmVlbigpYCBtZXRob2QuXG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvRG9jdW1lbnQvZXhpdEZ1bGxzY3JlZW5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZ1bGxzY3JlZW5FeGl0KGVsZW1lbnQpIHtcbiAgbGV0IGV4aXRGcyA9IGVsZW1lbnQuY2FuY2VsRnVsbFNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQuZXhpdEZ1bGxzY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50LmV4aXRGdWxsU2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC53ZWJraXRFeGl0RnVsbHNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQud2Via2l0RXhpdEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50LndlYmtpdENhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50Lm1zRXhpdEZ1bGxzY3JlZW47XG4gIGlmIChleGl0RnMpIHtcbiAgICBleGl0RnMuY2FsbChlbGVtZW50KTtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGVsZW1lbnQub3duZXJEb2N1bWVudCkge1xuICAgIGV4aXRGcyA9IGVsZW1lbnQub3duZXJEb2N1bWVudC5jYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50LmV4aXRGdWxsc2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50LmV4aXRGdWxsU2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50LndlYmtpdEV4aXRGdWxsc2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50LndlYmtpdEV4aXRGdWxsU2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50LndlYmtpdENhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQubW96Q2FuY2VsRnVsbFNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC5tc0V4aXRGdWxsc2NyZWVuO1xuICB9XG4gIGlmIChleGl0RnMpIHtcbiAgICBleGl0RnMuY2FsbChlbGVtZW50Lm93bmVyRG9jdW1lbnQpO1xuICAgIHJldHVybjtcbiAgfVxufVxuXG5cbi8qKlxuICogUmVwbGFjZW1lbnQgZm9yIGBEb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudGAuXG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvRG9jdW1lbnQvZnVsbHNjcmVlbkVsZW1lbnRcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Z1bGxzY3JlZW5FbGVtZW50KGVsZW1lbnQpIHtcbiAgY29uc3QgaXNGdWxsc2NyZWVuID0gZWxlbWVudC53ZWJraXREaXNwbGF5aW5nRnVsbHNjcmVlbjtcbiAgaWYgKGlzRnVsbHNjcmVlbikge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGlmIChlbGVtZW50Lm93bmVyRG9jdW1lbnQpIHtcbiAgICBjb25zdCBmdWxsc2NyZWVuRWxlbWVudCA9IGVsZW1lbnQub3duZXJEb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudFxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC53ZWJraXRGdWxsc2NyZWVuRWxlbWVudFxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC5tb3pGdWxsU2NyZWVuRWxlbWVudFxuICAgICAgICAgICAgIHx8IGVsZW1lbnQud2Via2l0Q3VycmVudEZ1bGxTY3JlZW5FbGVtZW50O1xuICAgIGlmIChmdWxsc2NyZWVuRWxlbWVudCA9PSBlbGVtZW50KSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBub2RlIGlzIG5vdCBkaXNhYmxlZC5cbiAqXG4gKiBJRTggY2FuIHJldHVybiBmYWxzZSBwb3NpdGl2ZXMsIHNlZSB7QGxpbmsgbWF0Y2hlc30uXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHNlZSBodHRwczovL3d3dy53My5vcmcvVFIvaHRtbDUvZm9ybXMuaHRtbCNjb25jZXB0LWZlLWRpc2FibGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0VuYWJsZWQoZWxlbWVudCkge1xuICByZXR1cm4gIShlbGVtZW50LmRpc2FibGVkIHx8IG1hdGNoZXMoZWxlbWVudCwgJzpkaXNhYmxlZCcpKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgKiBhcyBkb20gZnJvbSAnLi9kb20nO1xuaW1wb3J0IHtcbiAgZ2V0QW1wZG9jLFxuICBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUsXG4gIGdldFNlcnZpY2UsXG4gIGdldFNlcnZpY2VQcm9taXNlLFxuICBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyxcbiAgZ2V0U2VydmljZVByb21pc2VPck51bGwsXG4gIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsRm9yRG9jLFxuICBnZXRUb3BXaW5kb3csXG59IGZyb20gJy4vc2VydmljZSc7XG5pbXBvcnQge3RvV2lufSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7dXNlcn0gZnJvbSAnLi9sb2cnO1xuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIGZvciBhIHNlcnZpY2UgZm9yIHRoZSBnaXZlbiBpZCBhbmQgd2luZG93LiBBbHNvIGV4cGVjdHMgYW5cbiAqIGVsZW1lbnQgdGhhdCBoYXMgdGhlIGFjdHVhbCBpbXBsZW1lbnRhdGlvbi4gVGhlIHByb21pc2UgcmVzb2x2ZXMgd2hlbiB0aGVcbiAqIGltcGxlbWVudGF0aW9uIGxvYWRlZC4gVXNlcnMgc2hvdWxkIHR5cGljYWxseSB3cmFwIHRoaXMgYXMgYSBzcGVjaWFsIHB1cnBvc2VcbiAqIGZ1bmN0aW9uIChlLmcuIFNlcnZpY2VzLnZpZXdwb3J0Rm9yRG9jKC4uLikpIGZvciB0eXBlIHNhZmV0eSBhbmQgYmVjYXVzZSB0aGVcbiAqIGZhY3Rvcnkgc2hvdWxkIG5vdCBiZSBwYXNzZWQgYXJvdW5kLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb24gTmFtZSBvZiB0aGUgY3VzdG9tIGV4dGVuc2lvbiB0aGF0IHByb3ZpZGVzIHRoZVxuICogICAgIGltcGxlbWVudGF0aW9uIG9mIHRoaXMgc2VydmljZS5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9lbGVtZW50IFdoZXRoZXIgdGhpcyBzZXJ2aWNlIGlzIHByb3ZpZGVkIGJ5IGFuIGVsZW1lbnQsXG4gKiAgICAgbm90IHRoZSBleHRlbnNpb24uXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwqPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRTZXJ2aWNlKHdpbiwgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpIHtcbiAgcmV0dXJuIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCBpZCwgZXh0ZW5zaW9uLCBvcHRfZWxlbWVudCkudGhlbihcbiAgICAgIHNlcnZpY2UgPT4gYXNzZXJ0U2VydmljZShzZXJ2aWNlLCBpZCwgZXh0ZW5zaW9uKSk7XG59XG5cbi8qKlxuICogU2FtZSBhcyBnZXRFbGVtZW50U2VydmljZSBidXQgcHJvZHVjZXMgbnVsbCBpZiB0aGUgZ2l2ZW4gZWxlbWVudCBpcyBub3RcbiAqIGFjdHVhbGx5IGF2YWlsYWJsZSBvbiB0aGUgY3VycmVudCBwYWdlLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb24gTmFtZSBvZiB0aGUgY3VzdG9tIGV4dGVuc2lvbiB0aGF0IHByb3ZpZGVzIHRoZVxuICogICAgIGltcGxlbWVudGF0aW9uIG9mIHRoaXMgc2VydmljZS5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9lbGVtZW50IFdoZXRoZXIgdGhpcyBzZXJ2aWNlIGlzIHByb3ZpZGVkIGJ5IGFuXG4gKiAgICAgZWxlbWVudCwgbm90IHRoZSBleHRlbnNpb24uXG4gKiBAcmV0dXJuIHshUHJvbWlzZTw/T2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCBpZCwgZXh0ZW5zaW9uLCBvcHRfZWxlbWVudCkge1xuICBjb25zdCBzID0gZ2V0U2VydmljZVByb21pc2VPck51bGwod2luLCBpZCk7XG4gIGlmIChzKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8P09iamVjdD59ICovIChzKTtcbiAgfVxuICByZXR1cm4gZ2V0RWxlbWVudFNlcnZpY2VQcm9taXNlT3JOdWxsKHdpbiwgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gZWxlbWVudE5hbWUgTmFtZSBvZiBhbiBleHRlbmRlZCBjdXN0b20gZWxlbWVudC5cbiAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhpcyBlbGVtZW50IGlzIHNjaGVkdWxlZCB0byBiZSBsb2FkZWQuXG4gKi9cbmZ1bmN0aW9uIGlzRWxlbWVudFNjaGVkdWxlZCh3aW4sIGVsZW1lbnROYW1lKSB7XG4gIC8vIFNldCBpbiBjdXN0b20tZWxlbWVudC5qc1xuICBpZiAoIXdpbi5hbXBFeHRlbmRlZEVsZW1lbnRzKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiAhIXdpbi5hbXBFeHRlbmRlZEVsZW1lbnRzW2VsZW1lbnROYW1lXTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIGZvciBhIHNlcnZpY2UgZm9yIHRoZSBnaXZlbiBpZCBhbmQgd2luZG93LiBBbHNvIGV4cGVjdHMgYW5cbiAqIGVsZW1lbnQgdGhhdCBoYXMgdGhlIGFjdHVhbCBpbXBsZW1lbnRhdGlvbi4gVGhlIHByb21pc2UgcmVzb2x2ZXMgd2hlbiB0aGVcbiAqIGltcGxlbWVudGF0aW9uIGxvYWRlZC4gVXNlcnMgc2hvdWxkIHR5cGljYWxseSB3cmFwIHRoaXMgYXMgYSBzcGVjaWFsIHB1cnBvc2VcbiAqIGZ1bmN0aW9uIChlLmcuIFNlcnZpY2VzLnZpZXdwb3J0Rm9yRG9jKC4uLikpIGZvciB0eXBlIHNhZmV0eSBhbmQgYmVjYXVzZSB0aGVcbiAqIGZhY3Rvcnkgc2hvdWxkIG5vdCBiZSBwYXNzZWQgYXJvdW5kLlxuICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uIE5hbWUgb2YgdGhlIGN1c3RvbSBleHRlbnNpb24gdGhhdCBwcm92aWRlcyB0aGVcbiAqICAgICBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZWxlbWVudCBXaGV0aGVyIHRoaXMgc2VydmljZSBpcyBwcm92aWRlZCBieSBhbiBlbGVtZW50LFxuICogICAgIG5vdCB0aGUgZXh0ZW5zaW9uLlxuICogQHJldHVybiB7IVByb21pc2U8Kj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGlkLCBleHRlbnNpb24sXG4gIG9wdF9lbGVtZW50KSB7XG4gIHJldHVybiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jKFxuICAgICAgZWxlbWVudE9yQW1wRG9jLCBpZCwgZXh0ZW5zaW9uLCBvcHRfZWxlbWVudClcbiAgICAgIC50aGVuKHNlcnZpY2UgPT4gYXNzZXJ0U2VydmljZShzZXJ2aWNlLCBpZCwgZXh0ZW5zaW9uKSk7XG59XG5cbi8qKlxuICogU2FtZSBhcyBnZXRFbGVtZW50U2VydmljZSBidXQgcHJvZHVjZXMgbnVsbCBpZiB0aGUgZ2l2ZW4gZWxlbWVudCBpcyBub3RcbiAqIGFjdHVhbGx5IGF2YWlsYWJsZSBvbiB0aGUgY3VycmVudCBwYWdlLlxuICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uIE5hbWUgb2YgdGhlIGN1c3RvbSBleHRlbnNpb24gdGhhdCBwcm92aWRlcyB0aGVcbiAqICAgICBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZWxlbWVudCBXaGV0aGVyIHRoaXMgc2VydmljZSBpcyBwcm92aWRlZCBieSBhblxuICogICAgIGVsZW1lbnQsIG5vdCB0aGUgZXh0ZW5zaW9uLlxuICogQHJldHVybiB7IVByb21pc2U8P09iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jKFxuICBlbGVtZW50T3JBbXBEb2MsIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KSB7XG4gIGNvbnN0IGFtcGRvYyA9IGdldEFtcGRvYyhlbGVtZW50T3JBbXBEb2MpO1xuICBjb25zdCBzID0gZ2V0U2VydmljZVByb21pc2VPck51bGxGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCk7XG4gIGlmIChzKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8P09iamVjdD59ICovIChzKTtcbiAgfVxuXG4gIHJldHVybiBhbXBkb2Mud2hlbkJvZHlBdmFpbGFibGUoKVxuICAgICAgLnRoZW4oKCkgPT4gd2FpdEZvckV4dGVuc2lvbklmUHJlc2VudChcbiAgICAgICAgICBhbXBkb2Mud2luLCBleHRlbnNpb24sXG4gICAgICAgICAgYW1wZG9jLmdldEhlYWROb2RlKCkpKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAvLyBJZiB0aGlzIHNlcnZpY2UgaXMgcHJvdmlkZWQgYnkgYW4gZWxlbWVudCwgdGhlbiB3ZSBjYW4ndCBkZXBlbmQgb25cbiAgICAgICAgLy8gdGhlIHNlcnZpY2UgKHRoZXkgbWF5IG5vdCB1c2UgdGhlIGVsZW1lbnQpLlxuICAgICAgICBpZiAob3B0X2VsZW1lbnQpIHtcbiAgICAgICAgICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VPck51bGxGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNFbGVtZW50U2NoZWR1bGVkKGFtcGRvYy53aW4sIGV4dGVuc2lvbikpIHtcbiAgICAgICAgICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3Igc2VydmljZSBmb3IgdGhlIGdpdmVuIGlkIGluIHRoZSBlbWJlZCBzY29wZSBvZlxuICogYSBnaXZlbiBub2RlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSwgZmFsbHMgYmFjayB0byBhbXBkb2Mgc2NvcGUgSUZGXG4gKiB0aGUgZ2l2ZW4gbm9kZSBpcyBpbiB0aGUgdG9wLWxldmVsIHdpbmRvdy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbiBOYW1lIG9mIHRoZSBjdXN0b20gZWxlbWVudCB0aGF0IHByb3ZpZGVzXG4gKiAgICAgdGhlIGltcGxlbWVudGF0aW9uIG9mIHRoaXMgc2VydmljZS5cbiAqIEByZXR1cm4geyFQcm9taXNlPD9PYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvY0luRW1iZWRTY29wZShcbiAgZWxlbWVudE9yQW1wRG9jLCBpZCwgZXh0ZW5zaW9uKSB7XG4gIGNvbnN0IHMgPSBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUoZWxlbWVudE9yQW1wRG9jLCBpZCk7XG4gIGlmIChzKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8P09iamVjdD59ICovIChQcm9taXNlLnJlc29sdmUocykpO1xuICB9XG4gIC8vIFJldHVybiBlbWJlZC1zY29wZSBlbGVtZW50IHNlcnZpY2UgcHJvbWlzZSBpZiBzY2hlZHVsZWQuXG4gIGlmIChlbGVtZW50T3JBbXBEb2Mubm9kZVR5cGUpIHtcbiAgICBjb25zdCB3aW4gPSB0b1dpbihlbGVtZW50T3JBbXBEb2Mub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldyk7XG4gICAgY29uc3QgdG9wV2luID0gZ2V0VG9wV2luZG93KHdpbik7XG4gICAgLy8gSW4gZW1iZWRzLCBkb2Mtc2NvcGUgc2VydmljZXMgYXJlIHdpbmRvdy1zY29wZS4gQnV0IG1ha2Ugc3VyZSB0b1xuICAgIC8vIG9ubHkgZG8gdGhpcyBmb3IgZW1iZWRzIChub3QgdGhlIHRvcCB3aW5kb3cpLCBvdGhlcndpc2Ugd2UnZCBncmFiXG4gICAgLy8gYSBwcm9taXNlIGZyb20gdGhlIHdyb25nIHNlcnZpY2UgaG9sZGVyIHdoaWNoIHdvdWxkIG5ldmVyIHJlc29sdmUuXG4gICAgaWYgKHdpbiAhPT0gdG9wV2luKSB7XG4gICAgICByZXR1cm4gZ2V0RWxlbWVudFNlcnZpY2VQcm9taXNlT3JOdWxsKHdpbiwgaWQsIGV4dGVuc2lvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEZhbGxiYWNrIHRvIGFtcGRvYyBJRkYgdGhlIGdpdmVuIG5vZGUgaXMgX25vdF8gRklFLlxuICAgICAgcmV0dXJuIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCwgZXh0ZW5zaW9uKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8P09iamVjdD59ICovIChQcm9taXNlLnJlc29sdmUobnVsbCkpO1xufVxuXG4vKipcbiAqIFRocm93cyB1c2VyIGVycm9yIGlmIGBzZXJ2aWNlYCBpcyBudWxsLlxuICogQHBhcmFtIHtPYmplY3R9IHNlcnZpY2VcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvblxuICogQHJldHVybiB7IU9iamVjdH1cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIGFzc2VydFNlcnZpY2Uoc2VydmljZSwgaWQsIGV4dGVuc2lvbikge1xuICByZXR1cm4gLyoqIEB0eXBlIHshT2JqZWN0fSAqLyAodXNlcigpLmFzc2VydChzZXJ2aWNlLFxuICAgICAgJ1NlcnZpY2UgJXMgd2FzIHJlcXVlc3RlZCB0byBiZSBwcm92aWRlZCB0aHJvdWdoICVzLCAnICtcbiAgICAgICdidXQgJXMgaXMgbm90IGxvYWRlZCBpbiB0aGUgY3VycmVudCBwYWdlLiBUbyBmaXggdGhpcyAnICtcbiAgICAgICdwcm9ibGVtIGxvYWQgdGhlIEphdmFTY3JpcHQgZmlsZSBmb3IgJXMgaW4gdGhpcyBwYWdlLicsXG4gICAgICBpZCwgZXh0ZW5zaW9uLCBleHRlbnNpb24sIGV4dGVuc2lvbikpO1xufVxuXG4vKipcbiAqIEdldCBsaXN0IG9mIGFsbCB0aGUgZXh0ZW5zaW9uIEpTIGZpbGVzXG4gKiBAcGFyYW0ge0hUTUxIZWFkRWxlbWVudHxFbGVtZW50fFNoYWRvd1Jvb3R9IGhlYWRcbiAqIEByZXR1cm4geyFBcnJheTxzdHJpbmc+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXh0ZW5zaW9uU2NyaXB0c0luTm9kZShoZWFkKSB7XG4gIC8vIGFtcGRvYy5nZXRIZWFkTm9kZSgpIGNhbiByZXR1cm4gbnVsbFxuICBpZiAoIWhlYWQpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgY29uc3Qgc2NyaXB0cyA9IFtdO1xuICBjb25zdCBsaXN0ID0gaGVhZC5xdWVyeVNlbGVjdG9yQWxsKCdzY3JpcHRbY3VzdG9tLWVsZW1lbnRdJyk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgIHNjcmlwdHMucHVzaChsaXN0W2ldLmdldEF0dHJpYnV0ZSgnY3VzdG9tLWVsZW1lbnQnKSk7XG4gIH1cbiAgcmV0dXJuIHNjcmlwdHM7XG59XG5cbi8qKlxuICogV2FpdHMgZm9yIGJvZHkgdG8gYmUgcHJlc2VudCB0aGVuIHZlcmlmaWVzIHRoYXQgYW4gZXh0ZW5zaW9uIHNjcmlwdCBpc1xuICogcHJlc2VudCBpbiBoZWFkIGZvciBpbnN0YWxsYXRpb24uXG4gKiBAcGFyYW0geyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb25JZFxuICogQHJldHVybiB7IVByb21pc2U8Ym9vbGVhbj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0V4dGVuc2lvblNjcmlwdEluTm9kZShhbXBkb2MsIGV4dGVuc2lvbklkKSB7XG4gIHJldHVybiBhbXBkb2Mud2hlbkJvZHlBdmFpbGFibGUoKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICByZXR1cm4gZXh0ZW5zaW9uU2NyaXB0SW5Ob2RlKFxuICAgICAgICAgICAgYW1wZG9jLmdldEhlYWROb2RlKCksIGV4dGVuc2lvbklkKTtcbiAgICAgIH0pO1xufVxuXG4vKipcbiAqIFZlcmlmaWVzIHRoYXQgYW4gZXh0ZW5zaW9uIHNjcmlwdCBpcyBwcmVzZW50IGluIGhlYWQgZm9yXG4gKiBpbnN0YWxsYXRpb24uXG4gKiBAcGFyYW0ge0hUTUxIZWFkRWxlbWVudHxFbGVtZW50fFNoYWRvd1Jvb3R9IGhlYWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb25JZFxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gZXh0ZW5zaW9uU2NyaXB0SW5Ob2RlKGhlYWQsIGV4dGVuc2lvbklkKSB7XG4gIHJldHVybiBleHRlbnNpb25TY3JpcHRzSW5Ob2RlKGhlYWQpLmluY2x1ZGVzKGV4dGVuc2lvbklkKTtcbn1cblxuLyoqXG4gKiBXYWl0cyBmb3IgYW4gZXh0ZW5zaW9uIGlmIGl0cyBzY3JpcHQgaXMgcHJlc2VudFxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb25cbiAqIEBwYXJhbSB7SFRNTEhlYWRFbGVtZW50fEVsZW1lbnR8U2hhZG93Um9vdH0gaGVhZFxuICogQHJldHVybiB7IVByb21pc2V9XG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiB3YWl0Rm9yRXh0ZW5zaW9uSWZQcmVzZW50KHdpbiwgZXh0ZW5zaW9uLCBoZWFkKSB7XG4gIC8qKlxuICAgKiBJZiB0aGVyZSBpcyBhbiBleHRlbnNpb24gc2NyaXB0IHdhaXQgZm9yIGl0IHRvIGxvYWQgYmVmb3JlIHRyeWluZ1xuICAgKiB0byBnZXQgdGhlIHNlcnZpY2UuIFByZXZlbnRzIGEgcmFjZSBjb25kaXRpb24gd2hlbiBldmVyeXRoaW5nIGJ1dFxuICAgKiB0aGUgZXh0ZW5zaW9ucyBpcyBpbiBjYWNoZS4gSWYgdGhlcmUgaXMgbm8gc2NyaXB0IHRoZW4gaXQncyBlaXRoZXJcbiAgICogbm90IHByZXNlbnQsIG9yIHRoZSBzZXJ2aWNlIHdhcyBkZWZpbmVkIGJ5IGEgdGVzdC4gSW4gdGhvc2UgY2FzZXNcbiAgICogd2UgZG9uJ3Qgd2FpdCBhcm91bmQgZm9yIGFuIGV4dGVuc2lvbiB0aGF0IGRvZXMgbm90IGV4aXN0LlxuICAgKi9cblxuICAvLyBUT0RPKGpwZXR0aXR0KSBpbnZlc3RpZ2F0ZSByZWdpc3RlckV4dGVuc2lvbiB0byBzaG9ydCBjaXJjdWl0XG4gIC8vIHRoZSBkb20gY2FsbCBpbiBleHRlbnNpb25TY3JpcHRzSW5Ob2RlKClcbiAgaWYgKCFleHRlbnNpb25TY3JpcHRJbk5vZGUoaGVhZCwgZXh0ZW5zaW9uKSkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuXG4gIGNvbnN0IGV4dGVuc2lvbnMgPSBnZXRTZXJ2aWNlKHdpbiwgJ2V4dGVuc2lvbnMnKTtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8P09iamVjdD59ICovIChcbiAgICBleHRlbnNpb25zLndhaXRGb3JFeHRlbnNpb24od2luLCBleHRlbnNpb24pKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwcm9taXNlIGZvciBzZXJ2aWNlIHdpdGggYGlkYCBvbiB0aGUgZ2l2ZW4gd2luZG93IGlmIGF2YWlsYWJsZS5cbiAqIE90aGVyd2lzZSwgcmVzb2x2ZXMgd2l0aCBudWxsIChzZXJ2aWNlIHdhcyBub3QgcmVnaXN0ZXJlZCkuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZWxlbWVudFxuICogQHJldHVybiB7IVByb21pc2U8T2JqZWN0Pn1cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIGdldEVsZW1lbnRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KSB7XG4gIHJldHVybiBkb20ud2FpdEZvckJvZHlQcm9taXNlKHdpbi5kb2N1bWVudClcbiAgICAgIC50aGVuKCgpID0+IHdhaXRGb3JFeHRlbnNpb25JZlByZXNlbnQod2luLCBleHRlbnNpb24sIHdpbi5kb2N1bWVudC5oZWFkKSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgLy8gSWYgdGhpcyBzZXJ2aWNlIGlzIHByb3ZpZGVkIGJ5IGFuIGVsZW1lbnQsIHRoZW4gd2UgY2FuJ3QgZGVwZW5kIG9uXG4gICAgICAgIC8vIHRoZSBzZXJ2aWNlICh0aGV5IG1heSBub3QgdXNlIHRoZSBlbGVtZW50KS5cbiAgICAgICAgaWYgKG9wdF9lbGVtZW50KSB7XG4gICAgICAgICAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsKHdpbiwgaWQpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzRWxlbWVudFNjaGVkdWxlZCh3aW4sIGV4dGVuc2lvbikpIHtcbiAgICAgICAgICByZXR1cm4gZ2V0U2VydmljZVByb21pc2Uod2luLCBpZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbmltcG9ydCB7QW1wRXZlbnRzfSBmcm9tICcuL2FtcC1ldmVudHMnO1xuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi9zZXJ2aWNlcyc7XG5pbXBvcnQge1xuICBVU0VSX0VSUk9SX1NFTlRJTkVMLFxuICBkZXYsXG4gIGR1cGxpY2F0ZUVycm9ySWZOZWNlc3NhcnksXG4gIGlzVXNlckVycm9yRW1iZWQsXG4gIGlzVXNlckVycm9yTWVzc2FnZSxcbn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtleHBlcmltZW50VG9nZ2xlc09yTnVsbCwgZ2V0QmluYXJ5VHlwZSwgaXNDYW5hcnl9IGZyb20gJy4vZXhwZXJpbWVudHMnO1xuaW1wb3J0IHtleHBvbmVudGlhbEJhY2tvZmZ9IGZyb20gJy4vZXhwb25lbnRpYWwtYmFja29mZic7XG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4vbW9kZSc7XG5pbXBvcnQge2lzRXhwZXJpbWVudE9ufSBmcm9tICcuL2V4cGVyaW1lbnRzJztcbmltcG9ydCB7XG4gIGlzTG9hZEVycm9yTWVzc2FnZSxcbn0gZnJvbSAnLi9ldmVudC1oZWxwZXInO1xuaW1wb3J0IHtpc1Byb3h5T3JpZ2lufSBmcm9tICcuL3VybCc7XG5pbXBvcnQge21ha2VCb2R5VmlzaWJsZX0gZnJvbSAnLi9zdHlsZS1pbnN0YWxsZXInO1xuaW1wb3J0IHtzdGFydHNXaXRofSBmcm9tICcuL3N0cmluZyc7XG5pbXBvcnQge3RyaWdnZXJBbmFseXRpY3NFdmVudH0gZnJvbSAnLi9hbmFseXRpY3MnO1xuaW1wb3J0IHt1cmxzfSBmcm9tICcuL2NvbmZpZyc7XG5cbi8qKlxuICogQGNvbnN0IHtzdHJpbmd9XG4gKi9cbmNvbnN0IENBTkNFTExFRCA9ICdDQU5DRUxMRUQnO1xuXG4vKipcbiAqIEBjb25zdCB7c3RyaW5nfVxuICovXG5jb25zdCBCTE9DS19CWV9DT05TRU5UID0gJ0JMT0NLX0JZX0NPTlNFTlQnO1xuXG5cbi8qKlxuICogVGhlIHRocmVzaG9sZCBmb3IgZXJyb3JzIHRocm90dGxlZCBiZWNhdXNlIG5vdGhpbmcgY2FuIGJlIGRvbmUgYWJvdXRcbiAqIHRoZW0sIGJ1dCB3ZSdkIHN0aWxsIGxpa2UgdG8gcmVwb3J0IHRoZSByb3VnaCBudW1iZXIuXG4gKiBAY29uc3Qge251bWJlcn1cbiAqL1xuY29uc3QgTk9OX0FDVElPTkFCTEVfRVJST1JfVEhST1RUTEVfVEhSRVNIT0xEID0gMC4wMDE7XG5cbi8qKlxuICogVGhlIHRocmVzaG9sZCBmb3IgZXJyb3JzIHRocm90dGxlZCBiZWNhdXNlIG5vdGhpbmcgY2FuIGJlIGRvbmUgYWJvdXRcbiAqIHRoZW0sIGJ1dCB3ZSdkIHN0aWxsIGxpa2UgdG8gcmVwb3J0IHRoZSByb3VnaCBudW1iZXIuXG4gKiBAY29uc3Qge251bWJlcn1cbiAqL1xuY29uc3QgVVNFUl9FUlJPUl9USFJPVFRMRV9USFJFU0hPTEQgPSAwLjE7XG5cblxuLyoqXG4gKiBDb2xsZWN0cyBlcnJvciBtZXNzYWdlcywgc28gdGhleSBjYW4gYmUgaW5jbHVkZWQgaW4gc3Vic2VxdWVudCByZXBvcnRzLlxuICogVGhhdCBhbGxvd3MgaWRlbnRpZnlpbmcgZXJyb3JzIHRoYXQgbWlnaHQgYmUgY2F1c2VkIGJ5IHByZXZpb3VzIGVycm9ycy5cbiAqL1xubGV0IGFjY3VtdWxhdGVkRXJyb3JNZXNzYWdlcyA9IHNlbGYuQU1QRXJyb3JzIHx8IFtdO1xuLy8gVXNlIGEgdHJ1ZSBnbG9iYWwsIHRvIGF2b2lkIG11bHRpLW1vZHVsZSBpbmNsdXNpb24gaXNzdWVzLlxuc2VsZi5BTVBFcnJvcnMgPSBhY2N1bXVsYXRlZEVycm9yTWVzc2FnZXM7XG5cbi8qKlxuICogUHVzaGVzIGVsZW1lbnQgaW50byBhcnJheSwga2VlcGluZyBhdCBtb3N0IHRoZSBtb3N0IHJlY2VudCBsaW1pdCBlbGVtZW50c1xuICpcbiAqIEBwYXJhbSB7IUFycmF5PFQ+fSBhcnJheVxuICogQHBhcmFtIHtUfSBlbGVtZW50XG4gKiBAcGFyYW0ge251bWJlcn0gbGltaXRcbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmZ1bmN0aW9uIHB1c2hMaW1pdChhcnJheSwgZWxlbWVudCwgbGltaXQpIHtcbiAgaWYgKGFycmF5Lmxlbmd0aCA+PSBsaW1pdCkge1xuICAgIGFycmF5LnNwbGljZSgwLCBhcnJheS5sZW5ndGggLSBsaW1pdCArIDEpO1xuICB9XG4gIGFycmF5LnB1c2goZWxlbWVudCk7XG59XG5cbi8qKlxuICogQSB3cmFwcGVyIGFyb3VuZCBvdXIgZXhwb25lbnRpYWxCYWNrb2ZmLCB0byBsYXp5IGluaXRpYWxpemUgaXQgdG8gYXZvaWQgYW5cbiAqIHVuLURDRSdhYmxlIHNpZGUtZWZmZWN0LlxuICogQHBhcmFtIHtmdW5jdGlvbigpfSB3b3JrIHRoZSBmdW5jdGlvbiB0byBleGVjdXRlIGFmdGVyIGJhY2tvZmZcbiAqIEByZXR1cm4ge251bWJlcn0gdGhlIHNldFRpbWVvdXQgaWRcbiAqL1xubGV0IHJlcG9ydGluZ0JhY2tvZmYgPSBmdW5jdGlvbih3b3JrKSB7XG4gIC8vIFNldCByZXBvcnRpbmdCYWNrb2ZmIGFzIHRoZSBsYXp5LWNyZWF0ZWQgZnVuY3Rpb24uIEpTIFZvb29kb29vby5cbiAgcmVwb3J0aW5nQmFja29mZiA9IGV4cG9uZW50aWFsQmFja29mZigxLjUpO1xuICByZXR1cm4gcmVwb3J0aW5nQmFja29mZih3b3JrKTtcbn07XG5cbi8qKlxuICogQXR0ZW1wdHMgdG8gc3RyaW5naWZ5IGEgdmFsdWUsIGZhbGxpbmcgYmFjayB0byBTdHJpbmcuXG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHRyeUpzb25TdHJpbmdpZnkodmFsdWUpIHtcbiAgdHJ5IHtcbiAgICAvLyBDYXN0IGlzIGZpbmUsIGJlY2F1c2Ugd2UgcmVhbGx5IGRvbid0IGNhcmUgaGVyZS4gSnVzdCB0cnlpbmcuXG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovICh2YWx1ZSkpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIFN0cmluZyh2YWx1ZSk7XG4gIH1cbn1cblxuLyoqXG4gKiBUaGUgdHJ1ZSBKUyBlbmdpbmUsIGFzIGRldGVjdGVkIGJ5IGluc3BlY3RpbmcgYW4gRXJyb3Igc3RhY2suIFRoaXMgc2hvdWxkIGJlXG4gKiB1c2VkIHdpdGggdGhlIHVzZXJBZ2VudCB0byB0ZWxsIGRlZmluaXRlbHkuIEkuZS4sIENocm9tZSBvbiBpT1MgaXMgcmVhbGx5IGFcbiAqIFNhZmFyaSBKUyBlbmdpbmUuXG4gKi9cbmxldCBkZXRlY3RlZEpzRW5naW5lO1xuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyp9IGVycm9yXG4gKiBAcGFyYW0geyFFbGVtZW50PX0gb3B0X2Fzc29jaWF0ZWRFbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXBvcnRFcnJvckZvcldpbih3aW4sIGVycm9yLCBvcHRfYXNzb2NpYXRlZEVsZW1lbnQpIHtcbiAgcmVwb3J0RXJyb3IoZXJyb3IsIG9wdF9hc3NvY2lhdGVkRWxlbWVudCk7XG4gIGlmIChlcnJvciAmJiAhIXdpbiAmJiBpc1VzZXJFcnJvck1lc3NhZ2UoZXJyb3IubWVzc2FnZSlcbiAgICAgICYmICFpc1VzZXJFcnJvckVtYmVkKGVycm9yLm1lc3NhZ2UpKSB7XG4gICAgcmVwb3J0RXJyb3JUb0FuYWx5dGljcygvKiogQHR5cGUgeyFFcnJvcn0gKi8oZXJyb3IpLCB3aW4pO1xuICB9XG59XG5cbi8qKlxuICogUmVwb3J0cyBhbiBlcnJvci4gSWYgdGhlIGVycm9yIGhhcyBhbiBcImFzc29jaWF0ZWRFbGVtZW50XCIgcHJvcGVydHlcbiAqIHRoZSBlbGVtZW50IGlzIG1hcmtlZCB3aXRoIHRoZSBgaS1hbXBodG1sLWVsZW1lbnQtZXJyb3JgIGFuZCBkaXNwbGF5c1xuICogdGhlIG1lc3NhZ2UgaXRzZWxmLiBUaGUgbWVzc2FnZSBpcyBhbHdheXMgc2VuZCB0byB0aGUgY29uc29sZS5cbiAqIElmIHRoZSBlcnJvciBoYXMgYSBcIm1lc3NhZ2VBcnJheVwiIHByb3BlcnR5LCB0aGF0IGFycmF5IGlzIGxvZ2dlZC5cbiAqIFRoaXMgd2F5IG9uZSBnZXRzIHRoZSBuYXRpdmUgZmlkZWxpdHkgb2YgdGhlIGNvbnNvbGUgZm9yIHRoaW5ncyBsaWtlXG4gKiBlbGVtZW50cyBpbnN0ZWFkIG9mIHN0cmluZ2lmaWNhdGlvbi5cbiAqIEBwYXJhbSB7Kn0gZXJyb3JcbiAqIEBwYXJhbSB7IUVsZW1lbnQ9fSBvcHRfYXNzb2NpYXRlZEVsZW1lbnRcbiAqIEByZXR1cm4geyFFcnJvcn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlcG9ydEVycm9yKGVycm9yLCBvcHRfYXNzb2NpYXRlZEVsZW1lbnQpIHtcbiAgdHJ5IHtcbiAgICAvLyBDb252ZXJ0IGVycm9yIHRvIHRoZSBleHBlY3RlZCB0eXBlLlxuICAgIGxldCBpc1ZhbGlkRXJyb3I7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IubWVzc2FnZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGVycm9yID0gZHVwbGljYXRlRXJyb3JJZk5lY2Vzc2FyeSgvKiogQHR5cGUgeyFFcnJvcn0gKi8oZXJyb3IpKTtcbiAgICAgICAgaXNWYWxpZEVycm9yID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IG9yaWdFcnJvciA9IGVycm9yO1xuICAgICAgICBlcnJvciA9IG5ldyBFcnJvcih0cnlKc29uU3RyaW5naWZ5KG9yaWdFcnJvcikpO1xuICAgICAgICBlcnJvci5vcmlnRXJyb3IgPSBvcmlnRXJyb3I7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGVycm9yID0gbmV3IEVycm9yKCdVbmtub3duIGVycm9yJyk7XG4gICAgfVxuICAgIC8vIFJlcG9ydCBpZiBlcnJvciBpcyBub3QgYW4gZXhwZWN0ZWQgdHlwZS5cbiAgICBpZiAoIWlzVmFsaWRFcnJvciAmJiBnZXRNb2RlKCkubG9jYWxEZXYgJiYgIWdldE1vZGUoKS50ZXN0KSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zdCByZXRocm93ID0gbmV3IEVycm9yKFxuICAgICAgICAgICAgJ19yZXBvcnRlZF8gRXJyb3IgcmVwb3J0ZWQgaW5jb3JyZWN0bHk6ICcgKyBlcnJvcik7XG4gICAgICAgIHRocm93IHJldGhyb3c7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoZXJyb3IucmVwb3J0ZWQpIHtcbiAgICAgIHJldHVybiAvKiogQHR5cGUgeyFFcnJvcn0gKi8gKGVycm9yKTtcbiAgICB9XG4gICAgZXJyb3IucmVwb3J0ZWQgPSB0cnVlO1xuXG4gICAgLy8gVXBkYXRlIGVsZW1lbnQuXG4gICAgY29uc3QgZWxlbWVudCA9IG9wdF9hc3NvY2lhdGVkRWxlbWVudCB8fCBlcnJvci5hc3NvY2lhdGVkRWxlbWVudDtcbiAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50LmNsYXNzTGlzdCkge1xuICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdpLWFtcGh0bWwtZXJyb3InKTtcbiAgICAgIGlmIChnZXRNb2RlKCkuZGV2ZWxvcG1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdpLWFtcGh0bWwtZWxlbWVudC1lcnJvcicpO1xuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZXJyb3ItbWVzc2FnZScsIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJlcG9ydCB0byBjb25zb2xlLlxuICAgIGlmIChzZWxmLmNvbnNvbGUpIHtcbiAgICAgIGNvbnN0IG91dHB1dCA9IChjb25zb2xlLmVycm9yIHx8IGNvbnNvbGUubG9nKTtcbiAgICAgIGlmIChlcnJvci5tZXNzYWdlQXJyYXkpIHtcbiAgICAgICAgb3V0cHV0LmFwcGx5KGNvbnNvbGUsIGVycm9yLm1lc3NhZ2VBcnJheSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgIG91dHB1dC5jYWxsKGNvbnNvbGUsIGVycm9yLm1lc3NhZ2UsIGVsZW1lbnQpO1xuICAgICAgICB9IGVsc2UgaWYgKCFnZXRNb2RlKCkubWluaWZpZWQpIHtcbiAgICAgICAgICBvdXRwdXQuY2FsbChjb25zb2xlLCBlcnJvci5zdGFjayk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb3V0cHV0LmNhbGwoY29uc29sZSwgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudC5kaXNwYXRjaEN1c3RvbUV2ZW50Rm9yVGVzdGluZykge1xuICAgICAgZWxlbWVudC5kaXNwYXRjaEN1c3RvbUV2ZW50Rm9yVGVzdGluZyhBbXBFdmVudHMuRVJST1IsIGVycm9yLm1lc3NhZ2UpO1xuICAgIH1cblxuICAgIC8vICdjYWxsJyB0byBtYWtlIGxpbnRlciBoYXBweS4gQW5kIC5jYWxsIHRvIG1ha2UgY29tcGlsZXIgaGFwcHlcbiAgICAvLyB0aGF0IGV4cGVjdHMgc29tZSBAdGhpcy5cbiAgICByZXBvcnRFcnJvclRvU2VydmVyWydjYWxsJ10odW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLFxuICAgICAgICB1bmRlZmluZWQsIGVycm9yKTtcbiAgfSBjYXRjaCAoZXJyb3JSZXBvcnRpbmdFcnJvcikge1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICB0aHJvdyBlcnJvclJlcG9ydGluZ0Vycm9yO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiAvKiogQHR5cGUgeyFFcnJvcn0gKi8gKGVycm9yKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFuIGVycm9yIGZvciBhIGNhbmNlbGxhdGlvbiBvZiBhIHByb21pc2UuXG4gKiBAcmV0dXJuIHshRXJyb3J9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW5jZWxsYXRpb24oKSB7XG4gIHJldHVybiBuZXcgRXJyb3IoQ0FOQ0VMTEVEKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyp9IGVycm9yT3JNZXNzYWdlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNDYW5jZWxsYXRpb24oZXJyb3JPck1lc3NhZ2UpIHtcbiAgaWYgKCFlcnJvck9yTWVzc2FnZSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBpZiAodHlwZW9mIGVycm9yT3JNZXNzYWdlID09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIHN0YXJ0c1dpdGgoZXJyb3JPck1lc3NhZ2UsIENBTkNFTExFRCk7XG4gIH1cbiAgaWYgKHR5cGVvZiBlcnJvck9yTWVzc2FnZS5tZXNzYWdlID09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIHN0YXJ0c1dpdGgoZXJyb3JPck1lc3NhZ2UubWVzc2FnZSwgQ0FOQ0VMTEVEKTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogUmV0dXJucyBhbiBlcnJvciBmb3IgY29tcG9uZW50IGJsb2NrZWQgYnkgY29uc2VudFxuICogQHJldHVybiB7IUVycm9yfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYmxvY2tlZEJ5Q29uc2VudEVycm9yKCkge1xuICByZXR1cm4gbmV3IEVycm9yKEJMT0NLX0JZX0NPTlNFTlQpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7Kn0gZXJyb3JPck1lc3NhZ2VcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Jsb2NrZWRCeUNvbnNlbnQoZXJyb3JPck1lc3NhZ2UpIHtcbiAgaWYgKCFlcnJvck9yTWVzc2FnZSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBpZiAodHlwZW9mIGVycm9yT3JNZXNzYWdlID09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIHN0YXJ0c1dpdGgoZXJyb3JPck1lc3NhZ2UsIEJMT0NLX0JZX0NPTlNFTlQpO1xuICB9XG4gIGlmICh0eXBlb2YgZXJyb3JPck1lc3NhZ2UubWVzc2FnZSA9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBzdGFydHNXaXRoKGVycm9yT3JNZXNzYWdlLm1lc3NhZ2UsIEJMT0NLX0JZX0NPTlNFTlQpO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuXG4vKipcbiAqIEluc3RhbGwgaGFuZGxpbmcgb2YgZ2xvYmFsIHVuaGFuZGxlZCBleGNlcHRpb25zLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGxFcnJvclJlcG9ydGluZyh3aW4pIHtcbiAgd2luLm9uZXJyb3IgPSAvKiogQHR5cGUgeyFGdW5jdGlvbn0gKi8gKHJlcG9ydEVycm9yVG9TZXJ2ZXIpO1xuICB3aW4uYWRkRXZlbnRMaXN0ZW5lcigndW5oYW5kbGVkcmVqZWN0aW9uJywgZXZlbnQgPT4ge1xuICAgIGlmIChldmVudC5yZWFzb24gJiZcbiAgICAgIChldmVudC5yZWFzb24ubWVzc2FnZSA9PT0gQ0FOQ0VMTEVEIHx8XG4gICAgICBldmVudC5yZWFzb24ubWVzc2FnZSA9PT0gQkxPQ0tfQllfQ09OU0VOVCkpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHJlcG9ydEVycm9yKGV2ZW50LnJlYXNvbiB8fCBuZXcgRXJyb3IoJ3JlamVjdGVkIHByb21pc2UgJyArIGV2ZW50KSk7XG4gIH0pO1xufVxuXG4vKipcbiAqIFNpZ25hdHVyZSBkZXNpZ25lZCwgc28gaXQgY2FuIHdvcmsgd2l0aCB3aW5kb3cub25lcnJvclxuICogQHBhcmFtIHtzdHJpbmd8dW5kZWZpbmVkfSBtZXNzYWdlXG4gKiBAcGFyYW0ge3N0cmluZ3x1bmRlZmluZWR9IGZpbGVuYW1lXG4gKiBAcGFyYW0ge3N0cmluZ3x1bmRlZmluZWR9IGxpbmVcbiAqIEBwYXJhbSB7c3RyaW5nfHVuZGVmaW5lZH0gY29sXG4gKiBAcGFyYW0geyp8dW5kZWZpbmVkfSBlcnJvclxuICogQHRoaXMgeyFXaW5kb3d8dW5kZWZpbmVkfVxuICovXG5mdW5jdGlvbiByZXBvcnRFcnJvclRvU2VydmVyKG1lc3NhZ2UsIGZpbGVuYW1lLCBsaW5lLCBjb2wsIGVycm9yKSB7XG4gIC8vIE1ha2UgYW4gYXR0ZW1wdCB0byB1bmhpZGUgdGhlIGJvZHkuXG4gIGlmICh0aGlzICYmIHRoaXMuZG9jdW1lbnQpIHtcbiAgICBtYWtlQm9keVZpc2libGUodGhpcy5kb2N1bWVudCk7XG4gIH1cbiAgaWYgKGdldE1vZGUoKS5sb2NhbERldiB8fCBnZXRNb2RlKCkuZGV2ZWxvcG1lbnQgfHwgZ2V0TW9kZSgpLnRlc3QpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgbGV0IGhhc05vbkFtcEpzID0gZmFsc2U7XG4gIHRyeSB7XG4gICAgaGFzTm9uQW1wSnMgPSBkZXRlY3ROb25BbXBKcyhzZWxmKTtcbiAgfSBjYXRjaCAoaWdub3JlKSB7XG4gICAgLy8gSWdub3JlIGVycm9ycyBkdXJpbmcgZXJyb3IgcmVwb3J0IGdlbmVyYXRpb24uXG4gIH1cbiAgaWYgKGhhc05vbkFtcEpzICYmIE1hdGgucmFuZG9tKCkgPiAwLjAxKSB7XG4gICAgLy8gT25seSByZXBvcnQgMSUgb2YgZXJyb3JzIG9uIHBhZ2VzIHdpdGggbm9uLUFNUCBKUy5cbiAgICAvLyBUaGVzZSBlcnJvcnMgY2FuIGFsbW9zdCBuZXZlciBiZSBhY3RlZCB1cG9uLCBidXQgc3Bpa2VzIHN1Y2ggYXNcbiAgICAvLyBkdWUgdG8gYnVnZ3kgYnJvd3NlciBleHRlbnNpb25zIG1heSBiZSBoZWxwZnVsIHRvIG5vdGlmeSBhdXRob3JzLlxuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBkYXRhID0gZ2V0RXJyb3JSZXBvcnREYXRhKG1lc3NhZ2UsIGZpbGVuYW1lLCBsaW5lLCBjb2wsIGVycm9yLFxuICAgICAgaGFzTm9uQW1wSnMpO1xuICBpZiAoZGF0YSkge1xuICAgIC8vIFJlcG9ydCB0aGUgZXJyb3IgdG8gdmlld2VyIGlmIGl0IGhhcyB0aGUgY2FwYWJpbGl0eS4gVGhlIGRhdGEgcGFzc2VkXG4gICAgLy8gdG8gdGhlIHZpZXdlciBpcyBleGFjdGx5IHRoZSBzYW1lIGFzIHRoZSBkYXRhIHBhc3NlZCB0byB0aGUgc2VydmVyXG4gICAgLy8gYmVsb3cuXG4gICAgbWF5YmVSZXBvcnRFcnJvclRvVmlld2VyKHRoaXMsIGRhdGEpO1xuICAgIHJlcG9ydGluZ0JhY2tvZmYoKCkgPT4ge1xuICAgICAgY29uc3QgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICB4aHIub3BlbignUE9TVCcsIHVybHMuZXJyb3JSZXBvcnRpbmcsIHRydWUpO1xuICAgICAgeGhyLnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICogUGFzc2VzIHRoZSBnaXZlbiBlcnJvciBkYXRhIHRvIHRoZSB2aWV3ZXIgaWYgdGhlIGZvbGxvd2luZyBjcml0ZXJpYSBpcyBtZXQ6XG4gKiAtIFRoZSB2aWV3ZXIgaXMgYSB0cnVzdGVkIHZpZXdlclxuICogLSBUaGUgdmlld2VyIGhhcyB0aGUgYGVycm9yUmVwb3J0ZXJgIGNhcGFiaWxpdHlcbiAqIC0gVGhlIEFNUCBkb2MgaXMgaW4gc2luZ2xlIGRvYyBtb2RlXG4gKiAtIFRoZSBBTVAgZG9jIGlzIG9wdGVkLWluIGZvciBlcnJvciBpbnRlcmNlcHRpb24gKGA8aHRtbD5gIHRhZyBoYXMgdGhlXG4gKiAgIGByZXBvcnQtZXJyb3JzLXRvLXZpZXdlcmAgYXR0cmlidXRlKVxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0fSBkYXRhIERhdGEgZnJvbSBgZ2V0RXJyb3JSZXBvcnREYXRhYC5cbiAqIEByZXR1cm4geyFQcm9taXNlPGJvb2xlYW4+fSBgUHJvbWlzZTxUcnVlPmAgaWYgdGhlIGVycm9yIHdhcyBzZW50IHRvIHRoZVxuICogICAgIHZpZXdlciwgYFByb21pc2U8RmFsc2U+YCBvdGhlcndpc2UuXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1heWJlUmVwb3J0RXJyb3JUb1ZpZXdlcih3aW4sIGRhdGEpIHtcbiAgY29uc3QgYW1wZG9jU2VydmljZSA9IFNlcnZpY2VzLmFtcGRvY1NlcnZpY2VGb3Iod2luKTtcbiAgaWYgKCFhbXBkb2NTZXJ2aWNlLmlzU2luZ2xlRG9jKCkpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcbiAgfVxuICBjb25zdCBhbXBkb2NTaW5nbGUgPSBhbXBkb2NTZXJ2aWNlLmdldEFtcERvYygpO1xuICBjb25zdCBodG1sRWxlbWVudCA9IGFtcGRvY1NpbmdsZS5nZXRSb290Tm9kZSgpLmRvY3VtZW50RWxlbWVudDtcbiAgY29uc3QgZG9jT3B0ZWRJbiA9IGh0bWxFbGVtZW50Lmhhc0F0dHJpYnV0ZSgncmVwb3J0LWVycm9ycy10by12aWV3ZXInKTtcbiAgaWYgKCFkb2NPcHRlZEluKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShmYWxzZSk7XG4gIH1cblxuICBjb25zdCB2aWV3ZXIgPSBTZXJ2aWNlcy52aWV3ZXJGb3JEb2MoYW1wZG9jU2luZ2xlKTtcbiAgaWYgKCF2aWV3ZXIuaGFzQ2FwYWJpbGl0eSgnZXJyb3JSZXBvcnRlcicpKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShmYWxzZSk7XG4gIH1cblxuICByZXR1cm4gdmlld2VyLmlzVHJ1c3RlZFZpZXdlcigpLnRoZW4odmlld2VyVHJ1c3RlZCA9PiB7XG4gICAgaWYgKCF2aWV3ZXJUcnVzdGVkKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZpZXdlci5zZW5kTWVzc2FnZSgnZXJyb3InLCBkYXRhKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSk7XG59XG5cbi8qKlxuICogU2lnbmF0dXJlIGRlc2lnbmVkLCBzbyBpdCBjYW4gd29yayB3aXRoIHdpbmRvdy5vbmVycm9yXG4gKiBAcGFyYW0ge3N0cmluZ3x1bmRlZmluZWR9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7c3RyaW5nfHVuZGVmaW5lZH0gZmlsZW5hbWVcbiAqIEBwYXJhbSB7c3RyaW5nfHVuZGVmaW5lZH0gbGluZVxuICogQHBhcmFtIHtzdHJpbmd8dW5kZWZpbmVkfSBjb2xcbiAqIEBwYXJhbSB7Knx1bmRlZmluZWR9IGVycm9yXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGhhc05vbkFtcEpzXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdHx1bmRlZmluZWR9IFRoZSBkYXRhIHRvIHBvc3RcbiAqIHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFcnJvclJlcG9ydERhdGEobWVzc2FnZSwgZmlsZW5hbWUsIGxpbmUsIGNvbCwgZXJyb3IsXG4gIGhhc05vbkFtcEpzKSB7XG4gIGxldCBleHBlY3RlZCA9IGZhbHNlO1xuICBpZiAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IubWVzc2FnZSkge1xuICAgICAgbWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFRoaXMgc2hvdWxkIG5ldmVyIGJlIGEgc3RyaW5nLCBidXQgc29tZXRpbWVzIGl0IGlzLlxuICAgICAgbWVzc2FnZSA9IFN0cmluZyhlcnJvcik7XG4gICAgfVxuICAgIC8vIEFuIFwiZXhwZWN0ZWRcIiBlcnJvciBpcyBzdGlsbCBhbiBlcnJvciwgaS5lLiBzb21lIGZlYXR1cmVzIGFyZSBkaXNhYmxlZFxuICAgIC8vIG9yIG5vdCBmdW5jdGlvbmluZyBmdWxseSBiZWNhdXNlIG9mIGl0LiBIb3dldmVyLCBpdCdzIGFuIGV4cGVjdGVkXG4gICAgLy8gZXJyb3IuIEUuZy4gYXMgaXMgdGhlIGNhc2Ugd2l0aCBzb21lIGJyb3dzZXIgQVBJIG1pc3NpbmcgKHN0b3JhZ2UpLlxuICAgIC8vIFRodXMsIHRoZSBlcnJvciBjYW4gYmUgY2xhc3NpZmllZCBkaWZmZXJlbnRseSBieSBsb2cgYWdncmVnYXRvcnMuXG4gICAgLy8gVGhlIG1haW4gZ29hbCBpcyB0byBtb25pdG9yIHRoYXQgYW4gXCJleHBlY3RlZFwiIGVycm9yIGRvZXNuJ3QgZGV0ZXJpb3JhdGVcbiAgICAvLyBvdmVyIHRpbWUuIEl0J3MgaW1wb3NzaWJsZSB0byBjb21wbGV0ZWx5IGVsaW1pbmF0ZSBpdC5cbiAgICBpZiAoZXJyb3IuZXhwZWN0ZWQpIHtcbiAgICAgIGV4cGVjdGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgaWYgKCFtZXNzYWdlKSB7XG4gICAgbWVzc2FnZSA9ICdVbmtub3duIGVycm9yJztcbiAgfVxuICBpZiAoL19yZXBvcnRlZF8vLnRlc3QobWVzc2FnZSkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKG1lc3NhZ2UgPT0gQ0FOQ0VMTEVEKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgZGV0YWNoZWRXaW5kb3cgPSAhKHNlbGYgJiYgc2VsZi53aW5kb3cpO1xuICBjb25zdCB0aHJvdHRsZUJhc2UgPSBNYXRoLnJhbmRvbSgpO1xuXG4gIC8vIFdlIHRocm90dGxlIGxvYWQgZXJyb3JzIGFuZCBnZW5lcmljIFwiU2NyaXB0IGVycm9yLlwiIGVycm9yc1xuICAvLyB0aGF0IGhhdmUgbm8gaW5mb3JtYXRpb24gYW5kIHRodXMgY2Fubm90IGJlIGFjdGVkIHVwb24uXG4gIGlmIChpc0xvYWRFcnJvck1lc3NhZ2UobWVzc2FnZSkgfHxcbiAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2FtcHByb2plY3QvYW1waHRtbC9pc3N1ZXMvNzM1M1xuICAgIC8vIGZvciBjb250ZXh0LlxuICAgIG1lc3NhZ2UgPT0gJ1NjcmlwdCBlcnJvci4nIHx8XG4gICAgLy8gV2luZG93IGhhcyBiZWNvbWUgZGV0YWNoZWQsIHJlYWxseSBhbnl0aGluZyBjYW4gaGFwcGVuXG4gICAgLy8gYXQgdGhpcyBwb2ludC5cbiAgICBkZXRhY2hlZFdpbmRvdykge1xuICAgIGV4cGVjdGVkID0gdHJ1ZTtcblxuICAgIGlmICh0aHJvdHRsZUJhc2UgPiBOT05fQUNUSU9OQUJMRV9FUlJPUl9USFJPVFRMRV9USFJFU0hPTEQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICBjb25zdCBpc1VzZXJFcnJvciA9IGlzVXNlckVycm9yTWVzc2FnZShtZXNzYWdlKTtcblxuICAvLyBPbmx5IHJlcG9ydCBhIHN1YnNldCBvZiB1c2VyIGVycm9ycy5cbiAgaWYgKGlzVXNlckVycm9yICYmIHRocm90dGxlQmFzZSA+IFVTRVJfRVJST1JfVEhST1RUTEVfVEhSRVNIT0xEKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gVGhpcyBpcyB0aGUgQXBwIEVuZ2luZSBhcHAgaW5cbiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FtcHByb2plY3QvZXJyb3ItdHJhY2tlclxuICAvLyBJdCBzdG9yZXMgZXJyb3IgcmVwb3J0cyB2aWEgaHR0cHM6Ly9jbG91ZC5nb29nbGUuY29tL2Vycm9yLXJlcG9ydGluZy9cbiAgLy8gZm9yIGFuYWx5emluZyBwcm9kdWN0aW9uIGlzc3Vlcy5cbiAgY29uc3QgZGF0YSA9IC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovIChPYmplY3QuY3JlYXRlKG51bGwpKTtcbiAgZGF0YVsndiddID0gZ2V0TW9kZSgpLnJ0dlZlcnNpb247XG4gIGRhdGFbJ25vQW1wJ10gPSBoYXNOb25BbXBKcyA/ICcxJyA6ICcwJztcbiAgZGF0YVsnbSddID0gbWVzc2FnZS5yZXBsYWNlKFVTRVJfRVJST1JfU0VOVElORUwsICcnKTtcbiAgZGF0YVsnYSddID0gaXNVc2VyRXJyb3IgPyAnMScgOiAnMCc7XG5cbiAgLy8gRXJyb3JzIGFyZSB0YWdnZWQgd2l0aCBcImV4XCIgKFwiZXhwZWN0ZWRcIikgbGFiZWwgdG8gYWxsb3cgbG9nZ2VycyB0b1xuICAvLyBjbGFzc2lmeSB0aGVzZSBlcnJvcnMgYXMgYmVuY2htYXJrcyBhbmQgbm90IGV4Y2VwdGlvbnMuXG4gIGRhdGFbJ2V4J10gPSBleHBlY3RlZCA/ICcxJyA6ICcwJztcbiAgZGF0YVsnZHcnXSA9IGRldGFjaGVkV2luZG93ID8gJzEnIDogJzAnO1xuXG4gIGxldCBydW50aW1lID0gJzFwJztcbiAgaWYgKHNlbGYuY29udGV4dCAmJiBzZWxmLmNvbnRleHQubG9jYXRpb24pIHtcbiAgICBkYXRhWyczcCddID0gJzEnO1xuICAgIHJ1bnRpbWUgPSAnM3AnO1xuICB9IGVsc2UgaWYgKGdldE1vZGUoKS5ydW50aW1lKSB7XG4gICAgcnVudGltZSA9IGdldE1vZGUoKS5ydW50aW1lO1xuICB9XG4gIGRhdGFbJ3J0J10gPSBydW50aW1lO1xuXG4gIC8vIFRPRE8oZXJ3aW5tKTogUmVtb3ZlIGNhIHdoZW4gYWxsIHN5c3RlbXMgcmVhZCBgYnRgIGluc3RlYWQgb2YgYGNhYCB0b1xuICAvLyBpZGVudGlmeSBqcyBiaW5hcnkgdHlwZS5cbiAgZGF0YVsnY2EnXSA9IGlzQ2FuYXJ5KHNlbGYpID8gJzEnIDogJzAnO1xuXG4gIC8vIFBhc3MgYmluYXJ5IHR5cGUuXG4gIGRhdGFbJ2J0J10gPSBnZXRCaW5hcnlUeXBlKHNlbGYpO1xuXG4gIGlmIChzZWxmLmxvY2F0aW9uLmFuY2VzdG9yT3JpZ2lucyAmJiBzZWxmLmxvY2F0aW9uLmFuY2VzdG9yT3JpZ2luc1swXSkge1xuICAgIGRhdGFbJ29yJ10gPSBzZWxmLmxvY2F0aW9uLmFuY2VzdG9yT3JpZ2luc1swXTtcbiAgfVxuICBpZiAoc2VsZi52aWV3ZXJTdGF0ZSkge1xuICAgIGRhdGFbJ3ZzJ10gPSBzZWxmLnZpZXdlclN0YXRlO1xuICB9XG4gIC8vIElzIGVtYmVkZGVkP1xuICBpZiAoc2VsZi5wYXJlbnQgJiYgc2VsZi5wYXJlbnQgIT0gc2VsZikge1xuICAgIGRhdGFbJ2llbSddID0gJzEnO1xuICB9XG5cbiAgaWYgKHNlbGYuQU1QICYmIHNlbGYuQU1QLnZpZXdlcikge1xuICAgIGNvbnN0IHJlc29sdmVkVmlld2VyVXJsID0gc2VsZi5BTVAudmlld2VyLmdldFJlc29sdmVkVmlld2VyVXJsKCk7XG4gICAgY29uc3QgbWVzc2FnaW5nT3JpZ2luID0gc2VsZi5BTVAudmlld2VyLm1heWJlR2V0TWVzc2FnaW5nT3JpZ2luKCk7XG4gICAgaWYgKHJlc29sdmVkVmlld2VyVXJsKSB7XG4gICAgICBkYXRhWydydnUnXSA9IHJlc29sdmVkVmlld2VyVXJsO1xuICAgIH1cbiAgICBpZiAobWVzc2FnaW5nT3JpZ2luKSB7XG4gICAgICBkYXRhWydtc28nXSA9IG1lc3NhZ2luZ09yaWdpbjtcbiAgICB9XG4gIH1cblxuICBpZiAoIWRldGVjdGVkSnNFbmdpbmUpIHtcbiAgICBkZXRlY3RlZEpzRW5naW5lID0gZGV0ZWN0SnNFbmdpbmVGcm9tU3RhY2soKTtcbiAgfVxuICBkYXRhWydqc2UnXSA9IGRldGVjdGVkSnNFbmdpbmU7XG5cbiAgY29uc3QgZXhwcyA9IFtdO1xuICBjb25zdCBleHBlcmltZW50cyA9IGV4cGVyaW1lbnRUb2dnbGVzT3JOdWxsKHNlbGYpO1xuICBmb3IgKGNvbnN0IGV4cCBpbiBleHBlcmltZW50cykge1xuICAgIGNvbnN0IG9uID0gZXhwZXJpbWVudHNbZXhwXTtcbiAgICBleHBzLnB1c2goYCR7ZXhwfT0ke29uID8gJzEnIDogJzAnfWApO1xuICB9XG4gIGRhdGFbJ2V4cHMnXSA9IGV4cHMuam9pbignLCcpO1xuXG4gIGlmIChlcnJvcikge1xuICAgIGNvbnN0IHRhZ05hbWUgPSBlcnJvci5hc3NvY2lhdGVkRWxlbWVudFxuICAgICAgPyBlcnJvci5hc3NvY2lhdGVkRWxlbWVudC50YWdOYW1lXG4gICAgICA6ICd1JzsgLy8gVW5rbm93blxuICAgIGRhdGFbJ2VsJ10gPSB0YWdOYW1lO1xuXG4gICAgaWYgKGVycm9yLmFyZ3MpIHtcbiAgICAgIGRhdGFbJ2FyZ3MnXSA9IEpTT04uc3RyaW5naWZ5KGVycm9yLmFyZ3MpO1xuICAgIH1cblxuICAgIGlmICghaXNVc2VyRXJyb3IgJiYgIWVycm9yLmlnbm9yZVN0YWNrICYmIGVycm9yLnN0YWNrKSB7XG4gICAgICBkYXRhWydzJ10gPSBlcnJvci5zdGFjaztcbiAgICB9XG5cbiAgICBlcnJvci5tZXNzYWdlICs9ICcgX3JlcG9ydGVkXyc7XG4gIH0gZWxzZSB7XG4gICAgZGF0YVsnZiddID0gZmlsZW5hbWUgfHwgJyc7XG4gICAgZGF0YVsnbCddID0gbGluZSB8fCAnJztcbiAgICBkYXRhWydjJ10gPSBjb2wgfHwgJyc7XG4gIH1cbiAgZGF0YVsnciddID0gc2VsZi5kb2N1bWVudC5yZWZlcnJlcjtcbiAgZGF0YVsnYWUnXSA9IGFjY3VtdWxhdGVkRXJyb3JNZXNzYWdlcy5qb2luKCcsJyk7XG4gIGRhdGFbJ2ZyJ10gPSBzZWxmLmxvY2F0aW9uLm9yaWdpbmFsSGFzaCB8fCBzZWxmLmxvY2F0aW9uLmhhc2g7XG5cbiAgcHVzaExpbWl0KGFjY3VtdWxhdGVkRXJyb3JNZXNzYWdlcywgbWVzc2FnZSwgMjUpO1xuXG4gIHJldHVybiBkYXRhO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBpdCBhcHBlYXJzIGxpa2UgdGhlcmUgaXMgbm9uLUFNUCBKUyBvbiB0aGVcbiAqIGN1cnJlbnQgcGFnZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZXRlY3ROb25BbXBKcyh3aW4pIHtcbiAgY29uc3Qgc2NyaXB0cyA9IHdpbi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdzY3JpcHRbc3JjXScpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHNjcmlwdHMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoIWlzUHJveHlPcmlnaW4oc2NyaXB0c1tpXS5zcmMudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogUmVzZXRzIGFjY3VtdWxhdGVkIGVycm9yIG1lc3NhZ2VzIGZvciB0ZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldEFjY3VtdWxhdGVkRXJyb3JNZXNzYWdlc0ZvclRlc3RpbmcoKSB7XG4gIGFjY3VtdWxhdGVkRXJyb3JNZXNzYWdlcyA9IFtdO1xufVxuXG4vKipcbiAqIERvZXMgYSBzZXJpZXMgb2YgY2hlY2tzIG9uIHRoZSBzdGFjayBvZiBhbiB0aHJvd24gZXJyb3IgdG8gZGV0ZXJtaW5lIHRoZVxuICogSlMgZW5naW5lIHRoYXQgaXMgY3VycmVudGx5IHJ1bm5pbmcuIFRoaXMgZ2l2ZXMgYSBiaXQgbW9yZSBpbmZvcm1hdGlvbiB0aGFuXG4gKiBqdXN0IHRoZSBVc2VyQWdlbnQsIHNpbmNlIGJyb3dzZXJzIG9mdGVuIGFsbG93IG92ZXJyaWRpbmcgaXQgdG8gXCJlbXVsYXRlXCJcbiAqIG1vYmlsZS5cbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZGV0ZWN0SnNFbmdpbmVGcm9tU3RhY2soKSB7XG4gIC8qKiBAY29uc3RydWN0b3IgKi9cbiAgZnVuY3Rpb24gRm4oKSB7fVxuICBGbi5wcm90b3R5cGUudCA9IGZ1bmN0aW9uKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignbWVzc2FnZScpO1xuICB9O1xuICBjb25zdCBvYmplY3QgPSBuZXcgRm4oKTtcbiAgdHJ5IHtcbiAgICBvYmplY3QudCgpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc3Qge3N0YWNrfSA9IGU7XG5cbiAgICAvLyBTYWZhcmkgb25seSBtZW50aW9ucyB0aGUgbWV0aG9kIG5hbWUuXG4gICAgaWYgKHN0YXJ0c1dpdGgoc3RhY2ssICd0QCcpKSB7XG4gICAgICByZXR1cm4gJ1NhZmFyaSc7XG4gICAgfVxuXG4gICAgLy8gRmlyZWZveCBtZW50aW9ucyBcInByb3RvdHlwZVwiLlxuICAgIGlmIChzdGFjay5pbmRleE9mKCcucHJvdG90eXBlLnRAJykgPiAtMSkge1xuICAgICAgcmV0dXJuICdGaXJlZm94JztcbiAgICB9XG5cbiAgICAvLyBJRSBsb29rcyBsaWtlIENocm9tZSwgYnV0IGluY2x1ZGVzIGEgY29udGV4dCBmb3IgdGhlIGJhc2Ugc3RhY2sgbGluZS5cbiAgICAvLyBFeHBsaWNpdGx5LCB3ZSdyZSBsb29raW5nIGZvciBzb21ldGhpbmcgbGlrZTpcbiAgICAvLyBcIiAgICBhdCBHbG9iYWwgY29kZSAoaHR0cHM6Ly9leGFtcGxlLmNvbS9hcHAuanM6MToyMDApXCIgb3JcbiAgICAvLyBcIiAgICBhdCBBbm9ueW1vdXMgZnVuY3Rpb24gKGh0dHBzOi8vZXhhbXBsZS5jb20vYXBwLmpzOjE6MjAwKVwiXG4gICAgLy8gdnMgQ2hyb21lIHdoaWNoIGhhczpcbiAgICAvLyBcIiAgICBhdCBodHRwczovL2V4YW1wbGUuY29tL2FwcC5qczoxOjIwMFwiXG4gICAgY29uc3QgbGFzdCA9IHN0YWNrLnNwbGl0KCdcXG4nKS5wb3AoKTtcbiAgICBpZiAoL1xcYmF0IC4qIFxcKC9pLnRlc3QobGFzdCkpIHtcbiAgICAgIHJldHVybiAnSUUnO1xuICAgIH1cblxuICAgIC8vIEZpbmFsbHksIGNocm9tZSBpbmNsdWRlcyB0aGUgZXJyb3IgbWVzc2FnZSBpbiB0aGUgc3RhY2suXG4gICAgaWYgKHN0YXJ0c1dpdGgoc3RhY2ssICdFcnJvcjogbWVzc2FnZScpKSB7XG4gICAgICByZXR1cm4gJ0Nocm9tZSc7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuICd1bmtub3duJztcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFFcnJvcn0gZXJyb3JcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXBvcnRFcnJvclRvQW5hbHl0aWNzKGVycm9yLCB3aW4pIHtcbiAgaWYgKGlzRXhwZXJpbWVudE9uKHdpbiwgJ3VzZXItZXJyb3ItcmVwb3J0aW5nJykpIHtcbiAgICBjb25zdCB2YXJzID0ge1xuICAgICAgJ2Vycm9yTmFtZSc6IGVycm9yLm5hbWUsXG4gICAgICAnZXJyb3JNZXNzYWdlJzogZXJyb3IubWVzc2FnZSxcbiAgICB9O1xuICAgIHRyaWdnZXJBbmFseXRpY3NFdmVudChnZXRSb290RWxlbWVudF8od2luKSwgJ3VzZXItZXJyb3InLCB2YXJzKTtcbiAgfVxufVxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshRWxlbWVudH1cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIGdldFJvb3RFbGVtZW50Xyh3aW4pIHtcbiAgY29uc3Qgcm9vdCA9IFNlcnZpY2VzLmFtcGRvY1NlcnZpY2VGb3Iod2luKS5nZXRBbXBEb2MoKS5nZXRSb290Tm9kZSgpO1xuICByZXR1cm4gZGV2KCkuYXNzZXJ0RWxlbWVudChyb290LmRvY3VtZW50RWxlbWVudCB8fCByb290LmJvZHkgfHwgcm9vdCk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gICogV2hldGhlciBhZGRFdmVudExpc3RlbmVyIHN1cHBvcnRzIG9wdGlvbnMgb3Igb25seSB0YWtlcyBjYXB0dXJlIGFzIGEgYm9vbGVhblxuICAqIEB0eXBlIHtib29sZWFufHVuZGVmaW5lZH1cbiAgKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAgKi9cbmxldCBvcHRzU3VwcG9ydGVkO1xuXG4vKipcbiAqIExpc3RlbnMgZm9yIHRoZSBzcGVjaWZpZWQgZXZlbnQgb24gdGhlIGVsZW1lbnQuXG4gKlxuICogRG8gbm90IHVzZSB0aGlzIGRpcmVjdGx5LiBUaGlzIG1ldGhvZCBpcyBpbXBsZW1lbnRlZCBhcyBhIHNoYXJlZFxuICogZGVwZW5kZW5jeS4gVXNlIGBsaXN0ZW4oKWAgaW4gZWl0aGVyIGBldmVudC1oZWxwZXJgIG9yIGAzcC1mcmFtZS1tZXNzYWdpbmdgLFxuICogZGVwZW5kaW5nIG9uIHlvdXIgdXNlIGNhc2UuXG4gKlxuICogQHBhcmFtIHshRXZlbnRUYXJnZXR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUV2ZW50KX0gbGlzdGVuZXJcbiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0X2V2dExpc3RlbmVyT3B0c1xuICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gaW50ZXJuYWxMaXN0ZW5JbXBsZW1lbnRhdGlvbihlbGVtZW50LCBldmVudFR5cGUsIGxpc3RlbmVyLFxuICBvcHRfZXZ0TGlzdGVuZXJPcHRzKSB7XG4gIGxldCBsb2NhbEVsZW1lbnQgPSBlbGVtZW50O1xuICBsZXQgbG9jYWxMaXN0ZW5lciA9IGxpc3RlbmVyO1xuICAvKipcbiAgICogQHR5cGUgez9GdW5jdGlvbn1cbiAgICovXG4gIGxldCB3cmFwcGVkO1xuXG4gIHdyYXBwZWQgPSBldmVudCA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBsb2NhbExpc3RlbmVyKGV2ZW50KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAvLyByZXBvcnRFcnJvciBpcyBpbnN0YWxsZWQgZ2xvYmFsbHkgcGVyIHdpbmRvdyBpbiB0aGUgZW50cnkgcG9pbnQuXG4gICAgICBzZWxmLnJlcG9ydEVycm9yKGUpO1xuICAgICAgdGhyb3cgZTtcbiAgICB9XG4gIH07XG4gIGNvbnN0IG9wdHNTdXBwb3J0ZWQgPSBkZXRlY3RFdnRMaXN0ZW5lck9wdHNTdXBwb3J0KCk7XG4gIGxldCBjYXB0dXJlID0gZmFsc2U7XG4gIGlmIChvcHRfZXZ0TGlzdGVuZXJPcHRzKSB7XG4gICAgY2FwdHVyZSA9IG9wdF9ldnRMaXN0ZW5lck9wdHMuY2FwdHVyZTtcbiAgfVxuICBsb2NhbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIGV2ZW50VHlwZSxcbiAgICAgIHdyYXBwZWQsXG4gICAgICBvcHRzU3VwcG9ydGVkID8gb3B0X2V2dExpc3RlbmVyT3B0cyA6IGNhcHR1cmVcbiAgKTtcbiAgcmV0dXJuICgpID0+IHtcbiAgICBpZiAobG9jYWxFbGVtZW50KSB7XG4gICAgICBsb2NhbEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICBldmVudFR5cGUsXG4gICAgICAgICAgd3JhcHBlZCxcbiAgICAgICAgICBvcHRzU3VwcG9ydGVkID8gb3B0X2V2dExpc3RlbmVyT3B0cyA6IGNhcHR1cmVcbiAgICAgICk7XG4gICAgfVxuICAgIC8vIEVuc3VyZSB0aGVzZSBhcmUgR0MnZFxuICAgIGxvY2FsTGlzdGVuZXIgPSBudWxsO1xuICAgIGxvY2FsRWxlbWVudCA9IG51bGw7XG4gICAgd3JhcHBlZCA9IG51bGw7XG4gIH07XG59XG5cbi8qKlxuICogVGVzdHMgd2hldGhlciB0aGUgYnJvd3NlciBzdXBwb3J0cyBvcHRpb25zIGFzIGFuIGFyZ3VtZW50IG9mIGFkZEV2ZW50TGlzdGVuZXJcbiAqIG9yIG5vdC5cbiAqXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGV0ZWN0RXZ0TGlzdGVuZXJPcHRzU3VwcG9ydCgpIHtcbiAgLy8gT25seSBydW4gdGhlIHRlc3Qgb25jZVxuICBpZiAob3B0c1N1cHBvcnRlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIG9wdHNTdXBwb3J0ZWQ7XG4gIH1cblxuICBvcHRzU3VwcG9ydGVkID0gZmFsc2U7XG4gIHRyeSB7XG4gICAgLy8gVGVzdCB3aGV0aGVyIGJyb3dzZXIgc3VwcG9ydHMgRXZlbnRMaXN0ZW5lck9wdGlvbnMgb3Igbm90XG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIGdldCBjYXB0dXJlKCkge1xuICAgICAgICBvcHRzU3VwcG9ydGVkID0gdHJ1ZTtcbiAgICAgIH0sXG4gICAgfTtcbiAgICBzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ3Rlc3Qtb3B0aW9ucycsIG51bGwsIG9wdGlvbnMpO1xuICAgIHNlbGYucmVtb3ZlRXZlbnRMaXN0ZW5lcigndGVzdC1vcHRpb25zJywgbnVsbCwgb3B0aW9ucyk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIC8vIEV2ZW50TGlzdGVuZXJPcHRpb25zIGFyZSBub3Qgc3VwcG9ydGVkXG4gIH1cbiAgcmV0dXJuIG9wdHNTdXBwb3J0ZWQ7XG59XG5cbi8qKlxuICAqIFJlc2V0cyB0aGUgdGVzdCBmb3Igd2hldGhlciBhZGRFdmVudExpc3RlbmVyIHN1cHBvcnRzIG9wdGlvbnMgb3Igbm90LlxuICAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0RXZ0TGlzdGVuZXJPcHRzU3VwcG9ydEZvclRlc3RpbmcoKSB7XG4gIG9wdHNTdXBwb3J0ZWQgPSB1bmRlZmluZWQ7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtpbnRlcm5hbExpc3RlbkltcGxlbWVudGF0aW9ufSBmcm9tICcuL2V2ZW50LWhlbHBlci1saXN0ZW4nO1xuaW1wb3J0IHt1c2VyfSBmcm9tICcuL2xvZyc7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gICovXG5jb25zdCBMT0FEX0ZBSUxVUkVfUFJFRklYID0gJ0ZhaWxlZCB0byBsb2FkOic7XG5cbi8qKlxuICogUmV0dXJucyBhIEN1c3RvbUV2ZW50IHdpdGggYSBnaXZlbiB0eXBlIGFuZCBkZXRhaWw7IHN1cHBvcnRzIGZhbGxiYWNrIGZvciBJRS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICogQHBhcmFtIHshSnNvbk9iamVjdHxzdHJpbmd8dW5kZWZpbmVkfG51bGx9IGRldGFpbFxuICogQHBhcmFtIHtFdmVudEluaXQ9fSBvcHRfZXZlbnRJbml0XG4gKiBAcmV0dXJuIHshRXZlbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDdXN0b21FdmVudCh3aW4sIHR5cGUsIGRldGFpbCwgb3B0X2V2ZW50SW5pdCkge1xuICBjb25zdCBldmVudEluaXQgPSAvKiogQHR5cGUgeyFDdXN0b21FdmVudEluaXR9ICovICh7ZGV0YWlsfSk7XG4gIE9iamVjdC5hc3NpZ24oZXZlbnRJbml0LCBvcHRfZXZlbnRJbml0KTtcbiAgLy8gd2luLkN1c3RvbUV2ZW50IGlzIGEgZnVuY3Rpb24gb24gRWRnZSwgQ2hyb21lLCBGRiwgU2FmYXJpIGJ1dFxuICAvLyBpcyBhbiBvYmplY3Qgb24gSUUgMTEuXG4gIGlmICh0eXBlb2Ygd2luLkN1c3RvbUV2ZW50ID09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm4gbmV3IHdpbi5DdXN0b21FdmVudCh0eXBlLCBldmVudEluaXQpO1xuICB9IGVsc2Uge1xuICAgIC8vIERlcHJlY2F0ZWQgZmFsbGJhY2sgZm9yIElFLlxuICAgIGNvbnN0IGUgPSB3aW4uZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG4gICAgZS5pbml0Q3VzdG9tRXZlbnQoXG4gICAgICAgIHR5cGUsICEhZXZlbnRJbml0LmJ1YmJsZXMsICEhZXZlbnRJbml0LmNhbmNlbGFibGUsIGRldGFpbCk7XG4gICAgcmV0dXJuIGU7XG4gIH1cbn1cblxuLyoqXG4gKiBMaXN0ZW5zIGZvciB0aGUgc3BlY2lmaWVkIGV2ZW50IG9uIHRoZSBlbGVtZW50LlxuICogQHBhcmFtIHshRXZlbnRUYXJnZXR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUV2ZW50KX0gbGlzdGVuZXJcbiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0X2V2dExpc3RlbmVyT3B0c1xuICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGlzdGVuKGVsZW1lbnQsIGV2ZW50VHlwZSwgbGlzdGVuZXIsIG9wdF9ldnRMaXN0ZW5lck9wdHMpIHtcbiAgcmV0dXJuIGludGVybmFsTGlzdGVuSW1wbGVtZW50YXRpb24oXG4gICAgICBlbGVtZW50LCBldmVudFR5cGUsIGxpc3RlbmVyLCBvcHRfZXZ0TGlzdGVuZXJPcHRzKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBkYXRhIHByb3BlcnR5IG9mIGFuIGV2ZW50IHdpdGggdGhlIGNvcnJlY3QgdHlwZS5cbiAqIEBwYXJhbSB7IUV2ZW50fHtkYXRhOiAhSnNvbk9iamVjdH19IGV2ZW50XG4gKiBAcmV0dXJuIHs/SnNvbk9iamVjdHxzdHJpbmd8dW5kZWZpbmVkfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGF0YShldmVudCkge1xuICByZXR1cm4gLyoqIEB0eXBlIHs/SnNvbk9iamVjdHxzdHJpbmd8dW5kZWZpbmVkfSAqLyAoZXZlbnQuZGF0YSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZGV0YWlsIHByb3BlcnR5IG9mIGFuIGV2ZW50IHdpdGggdGhlIGNvcnJlY3QgdHlwZS5cbiAqIEBwYXJhbSB7IUV2ZW50fHtkZXRhaWw6ICFKc29uT2JqZWN0fX0gZXZlbnRcbiAqIEByZXR1cm4gez9Kc29uT2JqZWN0fHN0cmluZ3x1bmRlZmluZWR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXREZXRhaWwoZXZlbnQpIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7P0pzb25PYmplY3R8c3RyaW5nfHVuZGVmaW5lZH0gKi8gKGV2ZW50LmRldGFpbCk7XG59XG5cbi8qKlxuICogTGlzdGVucyBmb3IgdGhlIHNwZWNpZmllZCBldmVudCBvbiB0aGUgZWxlbWVudCBhbmQgcmVtb3ZlcyB0aGUgbGlzdGVuZXJcbiAqIGFzIHNvb24gYXMgZXZlbnQgaGFzIGJlZW4gcmVjZWl2ZWQuXG4gKiBAcGFyYW0geyFFdmVudFRhcmdldH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50VHlwZVxuICogQHBhcmFtIHtmdW5jdGlvbighRXZlbnQpfSBsaXN0ZW5lclxuICogQHBhcmFtIHtPYmplY3Q9fSBvcHRfZXZ0TGlzdGVuZXJPcHRzXG4gKiBAcmV0dXJuIHshVW5saXN0ZW5EZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW5PbmNlKGVsZW1lbnQsIGV2ZW50VHlwZSwgbGlzdGVuZXIsIG9wdF9ldnRMaXN0ZW5lck9wdHMpIHtcbiAgbGV0IGxvY2FsTGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgY29uc3QgdW5saXN0ZW4gPSBpbnRlcm5hbExpc3RlbkltcGxlbWVudGF0aW9uKGVsZW1lbnQsIGV2ZW50VHlwZSwgZXZlbnQgPT4ge1xuICAgIHRyeSB7XG4gICAgICBsb2NhbExpc3RlbmVyKGV2ZW50KTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgLy8gRW5zdXJlIGxpc3RlbmVyIGlzIEdDJ2RcbiAgICAgIGxvY2FsTGlzdGVuZXIgPSBudWxsO1xuICAgICAgdW5saXN0ZW4oKTtcbiAgICB9XG4gIH0sIG9wdF9ldnRMaXN0ZW5lck9wdHMpO1xuICByZXR1cm4gdW5saXN0ZW47XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zICBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgYXMgc29vbiBhcyB0aGUgc3BlY2lmaWVkIGV2ZW50IGhhc1xuICogZmlyZWQgb24gdGhlIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFdmVudFRhcmdldH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50VHlwZVxuICogQHBhcmFtIHtPYmplY3Q9fSBvcHRfZXZ0TGlzdGVuZXJPcHRzXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFVbmxpc3RlbkRlZik9fSBvcHRfY2FuY2VsIEFuIG9wdGlvbmFsIGZ1bmN0aW9uIHRoYXQsIHdoZW5cbiAqICAgICBwcm92aWRlZCwgd2lsbCBiZSBjYWxsZWQgd2l0aCB0aGUgdW5saXN0ZW5lci4gVGhpcyBnaXZlcyB0aGUgY2FsbGVyXG4gKiAgICAgYWNjZXNzIHRvIHRoZSB1bmxpc3RlbmVyLCBzbyBpdCBtYXkgYmUgY2FsbGVkIG1hbnVhbGx5IHdoZW4gbmVjZXNzYXJ5LlxuICogQHJldHVybiB7IVByb21pc2U8IUV2ZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxpc3Rlbk9uY2VQcm9taXNlKGVsZW1lbnQsIGV2ZW50VHlwZSwgb3B0X2V2dExpc3RlbmVyT3B0cyxcbiAgb3B0X2NhbmNlbCkge1xuICBsZXQgdW5saXN0ZW47XG4gIGNvbnN0IGV2ZW50UHJvbWlzZSA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgIHVubGlzdGVuID0gbGlzdGVuT25jZShlbGVtZW50LCBldmVudFR5cGUsIHJlc29sdmUsIG9wdF9ldnRMaXN0ZW5lck9wdHMpO1xuICB9KTtcbiAgZXZlbnRQcm9taXNlLnRoZW4odW5saXN0ZW4sIHVubGlzdGVuKTtcbiAgaWYgKG9wdF9jYW5jZWwpIHtcbiAgICBvcHRfY2FuY2VsKHVubGlzdGVuKTtcbiAgfVxuICByZXR1cm4gZXZlbnRQcm9taXNlO1xufVxuXG5cbi8qKlxuICogV2hldGhlciB0aGUgc3BlY2lmaWVkIGVsZW1lbnQvd2luZG93IGhhcyBiZWVuIGxvYWRlZCBhbHJlYWR5LlxuICogQHBhcmFtIHshRWxlbWVudHwhV2luZG93fSBlbGVPcldpbmRvd1xuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTG9hZGVkKGVsZU9yV2luZG93KSB7XG4gIHJldHVybiAhIShlbGVPcldpbmRvdy5jb21wbGV0ZSB8fCBlbGVPcldpbmRvdy5yZWFkeVN0YXRlID09ICdjb21wbGV0ZSdcbiAgICAgIC8vIElmIHRoZSBwYXNzZWQgaW4gdGhpbmcgaXMgYSBXaW5kb3csIGluZmVyIGxvYWRlZCBzdGF0ZSBmcm9tXG4gICAgICAvL1xuICAgICAgfHwgKGVsZU9yV2luZG93LmRvY3VtZW50XG4gICAgICAgICAgJiYgZWxlT3JXaW5kb3cuZG9jdW1lbnQucmVhZHlTdGF0ZSA9PSAnY29tcGxldGUnKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgb3IgZmFpbCBiYXNlZCBvbiB0aGUgZWxlT3JXaW5kb3cncyAnbG9hZCdcbiAqIGFuZCAnZXJyb3InIGV2ZW50cy4gT3B0aW9uYWxseSB0aGlzIG1ldGhvZCB0YWtlcyBhIHRpbWVvdXQsIHdoaWNoIHdpbGwgcmVqZWN0XG4gKiB0aGUgcHJvbWlzZSBpZiB0aGUgcmVzb3VyY2UgaGFzIG5vdCBsb2FkZWQgYnkgdGhlbi5cbiAqIEBwYXJhbSB7VH0gZWxlT3JXaW5kb3cgU3VwcG9ydHMgYm90aCBFbGVtZW50cyBhbmQgYXMgYSBzcGVjaWFsIGNhc2UgV2luZG93cy5cbiAqIEByZXR1cm4geyFQcm9taXNlPFQ+fVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvYWRQcm9taXNlKGVsZU9yV2luZG93KSB7XG4gIGxldCB1bmxpc3RlbkxvYWQ7XG4gIGxldCB1bmxpc3RlbkVycm9yO1xuICBpZiAoaXNMb2FkZWQoZWxlT3JXaW5kb3cpKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShlbGVPcldpbmRvdyk7XG4gIH1cbiAgY29uc3QgbG9hZGluZ1Byb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgLy8gTGlzdGVuIG9uY2Ugc2luY2UgSUUgNS82LzcgZmlyZSB0aGUgb25sb2FkIGV2ZW50IGNvbnRpbnVvdXNseSBmb3JcbiAgICAvLyBhbmltYXRlZCBHSUZzLlxuICAgIGNvbnN0IHt0YWdOYW1lfSA9IGVsZU9yV2luZG93O1xuICAgIGlmICh0YWdOYW1lID09PSAnQVVESU8nIHx8IHRhZ05hbWUgPT09ICdWSURFTycpIHtcbiAgICAgIHVubGlzdGVuTG9hZCA9IGxpc3Rlbk9uY2UoZWxlT3JXaW5kb3csICdsb2Fkc3RhcnQnLCByZXNvbHZlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdW5saXN0ZW5Mb2FkID0gbGlzdGVuT25jZShlbGVPcldpbmRvdywgJ2xvYWQnLCByZXNvbHZlKTtcbiAgICB9XG4gICAgLy8gRm9yIGVsZW1lbnRzLCB1bmxpc3RlbiBvbiBlcnJvciAoZG9uJ3QgZm9yIFdpbmRvd3MpLlxuICAgIGlmICh0YWdOYW1lKSB7XG4gICAgICB1bmxpc3RlbkVycm9yID0gbGlzdGVuT25jZShlbGVPcldpbmRvdywgJ2Vycm9yJywgcmVqZWN0KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBsb2FkaW5nUHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICBpZiAodW5saXN0ZW5FcnJvcikge1xuICAgICAgdW5saXN0ZW5FcnJvcigpO1xuICAgIH1cbiAgICByZXR1cm4gZWxlT3JXaW5kb3c7XG4gIH0sICgpID0+IHtcbiAgICBpZiAodW5saXN0ZW5Mb2FkKSB7XG4gICAgICB1bmxpc3RlbkxvYWQoKTtcbiAgICB9XG4gICAgZmFpbGVkVG9Mb2FkKGVsZU9yV2luZG93KTtcbiAgfSk7XG59XG5cbi8qKlxuICogRW1pdCBlcnJvciBvbiBsb2FkIGZhaWx1cmUuXG4gKiBAcGFyYW0geyFFbGVtZW50fCFXaW5kb3d9IGVsZU9yV2luZG93IFN1cHBvcnRzIGJvdGggRWxlbWVudHMgYW5kIGFzIGEgc3BlY2lhbFxuICogICAgIGNhc2UgV2luZG93cy5cbiAqL1xuZnVuY3Rpb24gZmFpbGVkVG9Mb2FkKGVsZU9yV2luZG93KSB7XG4gIC8vIFJlcG9ydCBmYWlsZWQgbG9hZHMgYXMgdXNlciBlcnJvcnMgc28gdGhhdCB0aGV5IGF1dG9tYXRpY2FsbHkgZ29cbiAgLy8gaW50byB0aGUgXCJkb2N1bWVudCBlcnJvclwiIGJ1Y2tldC5cbiAgbGV0IHRhcmdldCA9IGVsZU9yV2luZG93O1xuICBpZiAodGFyZ2V0ICYmIHRhcmdldC5zcmMpIHtcbiAgICB0YXJnZXQgPSB0YXJnZXQuc3JjO1xuICB9XG4gIHRocm93IHVzZXIoKS5jcmVhdGVFcnJvcihMT0FEX0ZBSUxVUkVfUFJFRklYLCB0YXJnZXQpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGVycm9yIG1lc3NhZ2UgaXMgd2FzIGNyZWF0ZWQgZm9yIGEgbG9hZCBlcnJvci5cbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIEFuIGVycm9yIG1lc3NhZ2VcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvYWRFcnJvck1lc3NhZ2UobWVzc2FnZSkge1xuICByZXR1cm4gbWVzc2FnZS5pbmRleE9mKExPQURfRkFJTFVSRV9QUkVGSVgpICE9IC0xO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQGZpbGVvdmVydmlldyBFeHBlcmltZW50cyBzeXN0ZW0gYWxsb3dzIGEgZGV2ZWxvcGVyIHRvIG9wdC1pbiB0byB0ZXN0XG4gKiBmZWF0dXJlcyB0aGF0IGFyZSBub3QgeWV0IGZ1bGx5IHRlc3RlZC5cbiAqXG4gKiBFeHBlcmltZW50cyBwYWdlOiBodHRwczovL2Nkbi5hbXBwcm9qZWN0Lm9yZy9leHBlcmltZW50cy5odG1sICpcbiAqL1xuXG5pbXBvcnQge2dldENvb2tpZSwgc2V0Q29va2llfSBmcm9tICcuL2Nvb2tpZXMnO1xuaW1wb3J0IHtoYXNPd259IGZyb20gJy4vdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7cGFyc2VRdWVyeVN0cmluZ30gZnJvbSAnLi91cmwnO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5jb25zdCBDT09LSUVfTkFNRSA9ICdBTVBfRVhQJztcblxuLyoqIEBjb25zdCB7bnVtYmVyfSAqL1xuY29uc3QgQ09PS0lFX01BWF9BR0VfREFZUyA9IDE4MDsgLy8gNiBtb250aFxuXG4vKiogQGNvbnN0IHt0aW1lfSAqL1xuY29uc3QgQ09PS0lFX0VYUElSQVRJT05fSU5URVJWQUwgPSBDT09LSUVfTUFYX0FHRV9EQVlTICogMjQgKiA2MCAqIDYwICogMTAwMDtcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgVE9HR0xFU19XSU5ET1dfUFJPUEVSVFkgPSAnX19BTVBfX0VYUEVSSU1FTlRfVE9HR0xFUyc7XG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgaXNUcmFmZmljRWxpZ2libGU6IGZ1bmN0aW9uKCFXaW5kb3cpOmJvb2xlYW4sXG4gKiAgIGJyYW5jaGVzOiAhQXJyYXk8c3RyaW5nPlxuICogfX1cbiAqL1xuZXhwb3J0IGxldCBFeHBlcmltZW50SW5mbztcblxuLyoqXG4gKiBXaGV0aGVyIHdlIGFyZSBpbiBjYW5hcnkuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQ2FuYXJ5KHdpbikge1xuICByZXR1cm4gISEod2luLkFNUF9DT05GSUcgJiYgd2luLkFNUF9DT05GSUcuY2FuYXJ5KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGJpbmFyeSB0eXBlLCBlLmcuLCBjYW5hcnksIGNvbnRyb2wsIG9yIHByb2R1Y3Rpb24uXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmluYXJ5VHlwZSh3aW4pIHtcbiAgcmV0dXJuIHdpbi5BTVBfQ09ORklHICYmIHdpbi5BTVBfQ09ORklHLnR5cGUgP1xuICAgIHdpbi5BTVBfQ09ORklHLnR5cGUgOiAndW5rbm93bic7XG59XG5cbi8qKlxuICogV2hldGhlciB0aGUgc3BlY2lmaWVkIGV4cGVyaW1lbnQgaXMgb24gb3Igb2ZmLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHBlcmltZW50SWRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0V4cGVyaW1lbnRPbih3aW4sIGV4cGVyaW1lbnRJZCkge1xuICBjb25zdCB0b2dnbGVzID0gZXhwZXJpbWVudFRvZ2dsZXMod2luKTtcbiAgcmV0dXJuICEhdG9nZ2xlc1tleHBlcmltZW50SWRdO1xufVxuXG4vKipcbiAqIFRvZ2dsZXMgdGhlIGV4cGVyaW1lbnQgb24gb3Igb2ZmLiBSZXR1cm5zIHRoZSBhY3R1YWwgdmFsdWUgb2YgdGhlIGV4cGVyaW1lbnRcbiAqIGFmdGVyIHRvZ2dsaW5nIGlzIGRvbmUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGV4cGVyaW1lbnRJZFxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X29uXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfdHJhbnNpZW50RXhwZXJpbWVudCAgV2hldGhlciB0byB0b2dnbGUgdGhlXG4gKiAgICAgZXhwZXJpbWVudCBzdGF0ZSBcInRyYW5zaWVudGx5XCIgKGkuZS4sIGZvciB0aGlzIHBhZ2UgbG9hZCBvbmx5KSBvclxuICogICAgIGR1cmFibHkgKGJ5IHNhdmluZyB0aGUgZXhwZXJpbWVudCBJRHMgdG8gdGhlIGNvb2tpZSBhZnRlciB0b2dnbGluZykuXG4gKiAgICAgRGVmYXVsdDogZmFsc2UgKHNhdmUgZHVyYWJseSkuXG4gKiBAcmV0dXJuIHtib29sZWFufSBOZXcgc3RhdGUgZm9yIGV4cGVyaW1lbnRJZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvZ2dsZUV4cGVyaW1lbnQod2luLCBleHBlcmltZW50SWQsIG9wdF9vbixcbiAgb3B0X3RyYW5zaWVudEV4cGVyaW1lbnQpIHtcbiAgY29uc3QgY3VycmVudGx5T24gPSBpc0V4cGVyaW1lbnRPbih3aW4sIC8qT0sqL2V4cGVyaW1lbnRJZCk7XG4gIGNvbnN0IG9uID0gISEob3B0X29uICE9PSB1bmRlZmluZWQgPyBvcHRfb24gOiAhY3VycmVudGx5T24pO1xuICBpZiAob24gIT0gY3VycmVudGx5T24pIHtcbiAgICBjb25zdCB0b2dnbGVzID0gZXhwZXJpbWVudFRvZ2dsZXMod2luKTtcbiAgICB0b2dnbGVzW2V4cGVyaW1lbnRJZF0gPSBvbjtcblxuICAgIGlmICghb3B0X3RyYW5zaWVudEV4cGVyaW1lbnQpIHtcbiAgICAgIGNvbnN0IGNvb2tpZVRvZ2dsZXMgPSBnZXRFeHBlcmltZW50VG9nZ2xlc0Zyb21Db29raWUod2luKTtcbiAgICAgIGNvb2tpZVRvZ2dsZXNbZXhwZXJpbWVudElkXSA9IG9uO1xuICAgICAgc2F2ZUV4cGVyaW1lbnRUb2dnbGVzVG9Db29raWUod2luLCBjb29raWVUb2dnbGVzKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG9uO1xufVxuXG4vKipcbiAqIENhbGN1bGF0ZSB3aGV0aGVyIHRoZSBleHBlcmltZW50IGlzIG9uIG9yIG9mZiBiYXNlZCBvZmYgb2YgdGhlXG4gKiBjb29raWVGbGFnIG9yIHRoZSBnbG9iYWwgY29uZmlnIGZyZXF1ZW5jeSBnaXZlbi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgYm9vbGVhbj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHBlcmltZW50VG9nZ2xlcyh3aW4pIHtcbiAgaWYgKHdpbltUT0dHTEVTX1dJTkRPV19QUk9QRVJUWV0pIHtcbiAgICByZXR1cm4gd2luW1RPR0dMRVNfV0lORE9XX1BST1BFUlRZXTtcbiAgfVxuICB3aW5bVE9HR0xFU19XSU5ET1dfUFJPUEVSVFldID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgY29uc3QgdG9nZ2xlcyA9IHdpbltUT0dHTEVTX1dJTkRPV19QUk9QRVJUWV07XG5cbiAgLy8gUmVhZCB0aGUgZGVmYXVsdCBjb25maWcgb2YgdGhpcyBidWlsZC5cbiAgaWYgKHdpbi5BTVBfQ09ORklHKSB7XG4gICAgZm9yIChjb25zdCBleHBlcmltZW50SWQgaW4gd2luLkFNUF9DT05GSUcpIHtcbiAgICAgIGNvbnN0IGZyZXF1ZW5jeSA9IHdpbi5BTVBfQ09ORklHW2V4cGVyaW1lbnRJZF07XG4gICAgICBpZiAodHlwZW9mIGZyZXF1ZW5jeSA9PT0gJ251bWJlcicgJiYgZnJlcXVlbmN5ID49IDAgJiYgZnJlcXVlbmN5IDw9IDEpIHtcbiAgICAgICAgdG9nZ2xlc1tleHBlcmltZW50SWRdID0gTWF0aC5yYW5kb20oKSA8IGZyZXF1ZW5jeTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLy8gUmVhZCBkb2N1bWVudCBsZXZlbCBvdmVycmlkZSBmcm9tIG1ldGEgdGFnLlxuICBpZiAod2luLkFNUF9DT05GSUdcbiAgICAgICYmIEFycmF5LmlzQXJyYXkod2luLkFNUF9DT05GSUdbJ2FsbG93LWRvYy1vcHQtaW4nXSlcbiAgICAgICYmIHdpbi5BTVBfQ09ORklHWydhbGxvdy1kb2Mtb3B0LWluJ10ubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IGFsbG93ZWQgPSB3aW4uQU1QX0NPTkZJR1snYWxsb3ctZG9jLW9wdC1pbiddO1xuICAgIGNvbnN0IG1ldGEgPVxuICAgICAgICB3aW4uZG9jdW1lbnQuaGVhZC5xdWVyeVNlbGVjdG9yKCdtZXRhW25hbWU9XCJhbXAtZXhwZXJpbWVudHMtb3B0LWluXCJdJyk7XG4gICAgaWYgKG1ldGEpIHtcbiAgICAgIGNvbnN0IG9wdGVkSW5FeHBlcmltZW50cyA9IG1ldGEuZ2V0QXR0cmlidXRlKCdjb250ZW50Jykuc3BsaXQoJywnKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb3B0ZWRJbkV4cGVyaW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChhbGxvd2VkLmluZGV4T2Yob3B0ZWRJbkV4cGVyaW1lbnRzW2ldKSAhPSAtMSkge1xuICAgICAgICAgIHRvZ2dsZXNbb3B0ZWRJbkV4cGVyaW1lbnRzW2ldXSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBPYmplY3QuYXNzaWduKHRvZ2dsZXMsIGdldEV4cGVyaW1lbnRUb2dnbGVzRnJvbUNvb2tpZSh3aW4pKTtcblxuICBpZiAod2luLkFNUF9DT05GSUdcbiAgICAgICYmIEFycmF5LmlzQXJyYXkod2luLkFNUF9DT05GSUdbJ2FsbG93LXVybC1vcHQtaW4nXSlcbiAgICAgICYmIHdpbi5BTVBfQ09ORklHWydhbGxvdy11cmwtb3B0LWluJ10ubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IGFsbG93ZWQgPSB3aW4uQU1QX0NPTkZJR1snYWxsb3ctdXJsLW9wdC1pbiddO1xuICAgIGNvbnN0IGhhc2ggPSB3aW4ubG9jYXRpb24ub3JpZ2luYWxIYXNoIHx8IHdpbi5sb2NhdGlvbi5oYXNoO1xuICAgIGNvbnN0IHBhcmFtcyA9IHBhcnNlUXVlcnlTdHJpbmcoaGFzaCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbGxvd2VkLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBwYXJhbSA9IHBhcmFtc1tgZS0ke2FsbG93ZWRbaV19YF07XG4gICAgICBpZiAocGFyYW0gPT0gJzEnKSB7XG4gICAgICAgIHRvZ2dsZXNbYWxsb3dlZFtpXV0gPSB0cnVlO1xuICAgICAgfVxuICAgICAgaWYgKHBhcmFtID09ICcwJykge1xuICAgICAgICB0b2dnbGVzW2FsbG93ZWRbaV1dID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiB0b2dnbGVzO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGNhY2hlZCBleHBlcmltZW50cyB0b2dnbGVzLCBvciBudWxsIGlmIHRoZXkgaGF2ZSBub3QgYmVlblxuICogY29tcHV0ZWQgeWV0LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge09iamVjdDxzdHJpbmcsIGJvb2xlYW4+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhwZXJpbWVudFRvZ2dsZXNPck51bGwod2luKSB7XG4gIHJldHVybiB3aW5bVE9HR0xFU19XSU5ET1dfUFJPUEVSVFldIHx8IG51bGw7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNldCBvZiBleHBlcmltZW50IElEcyBjdXJyZW50bHkgb24uXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IU9iamVjdDxzdHJpbmcsIGJvb2xlYW4+fVxuICovXG5mdW5jdGlvbiBnZXRFeHBlcmltZW50VG9nZ2xlc0Zyb21Db29raWUod2luKSB7XG4gIGNvbnN0IGV4cGVyaW1lbnRDb29raWUgPSBnZXRDb29raWUod2luLCBDT09LSUVfTkFNRSk7XG4gIGNvbnN0IHRva2VucyA9IGV4cGVyaW1lbnRDb29raWUgPyBleHBlcmltZW50Q29va2llLnNwbGl0KC9cXHMqLFxccyovZykgOiBbXTtcblxuICBjb25zdCB0b2dnbGVzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAodG9rZW5zW2ldLmxlbmd0aCA9PSAwKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKHRva2Vuc1tpXVswXSA9PSAnLScpIHtcbiAgICAgIHRvZ2dsZXNbdG9rZW5zW2ldLnN1YnN0cigxKV0gPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdG9nZ2xlc1t0b2tlbnNbaV1dID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdG9nZ2xlcztcbn1cblxuLyoqXG4gKiBTYXZlcyBhIHNldCBvZiBleHBlcmltZW50IElEcyBjdXJyZW50bHkgb24uXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgYm9vbGVhbj59IHRvZ2dsZXNcbiAqL1xuZnVuY3Rpb24gc2F2ZUV4cGVyaW1lbnRUb2dnbGVzVG9Db29raWUod2luLCB0b2dnbGVzKSB7XG4gIGNvbnN0IGV4cGVyaW1lbnRJZHMgPSBbXTtcbiAgZm9yIChjb25zdCBleHBlcmltZW50IGluIHRvZ2dsZXMpIHtcbiAgICBleHBlcmltZW50SWRzLnB1c2goKHRvZ2dsZXNbZXhwZXJpbWVudF0gPT09IGZhbHNlID8gJy0nIDogJycpICsgZXhwZXJpbWVudCk7XG4gIH1cblxuICBzZXRDb29raWUod2luLCBDT09LSUVfTkFNRSwgZXhwZXJpbWVudElkcy5qb2luKCcsJyksXG4gICAgICBEYXRlLm5vdygpICsgQ09PS0lFX0VYUElSQVRJT05fSU5URVJWQUwsIHtcbiAgICAgICAgLy8gU2V0IGV4cGxpY2l0IGRvbWFpbiwgc28gdGhlIGNvb2tpZSBnZXRzIHNlbmQgdG8gc3ViIGRvbWFpbnMuXG4gICAgICAgIGRvbWFpbjogd2luLmxvY2F0aW9uLmhvc3RuYW1lLFxuICAgICAgICBhbGxvd09uUHJveHlPcmlnaW46IHRydWUsXG4gICAgICB9KTtcbn1cblxuLyoqXG4gKiBTZWUgZ2V0RXhwZXJpbWVudFRvZ2dsZXNGcm9tQ29va2llKCkuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IU9iamVjdDxzdHJpbmcsIGJvb2xlYW4+fVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFeHBlcmltZW50VG9nbGVzRnJvbUNvb2tpZUZvclRlc3Rpbmcod2luKSB7XG4gIHJldHVybiBnZXRFeHBlcmltZW50VG9nZ2xlc0Zyb21Db29raWUod2luKTtcbn1cblxuLyoqXG4gKiBSZXNldHMgdGhlIGV4cGVyaW1lbnRzVG9nZ2xlIGNhY2hlIGZvciB0ZXN0aW5nIHB1cnBvc2VzLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRFeHBlcmltZW50VG9nZ2xlc0ZvclRlc3Rpbmcod2luKSB7XG4gIHNldENvb2tpZSh3aW4sIENPT0tJRV9OQU1FLCAnJywgMCwge1xuICAgIGRvbWFpbjogd2luLmxvY2F0aW9uLmhvc3RuYW1lLFxuICB9KTtcbiAgd2luW1RPR0dMRVNfV0lORE9XX1BST1BFUlRZXSA9IG51bGw7XG59XG5cbi8qKlxuICogSW4gc29tZSBicm93c2VyIGltcGxlbWVudGF0aW9ucyBvZiBNYXRoLnJhbmRvbSgpLCBzZXF1ZW50aWFsIGNhbGxzIG9mXG4gKiBNYXRoLnJhbmRvbSgpIGFyZSBjb3JyZWxhdGVkIGFuZCBjYW4gY2F1c2UgYSBiaWFzLiAgSW4gcGFydGljdWxhcixcbiAqIGlmIHRoZSBwcmV2aW91cyByYW5kb20oKSBjYWxsIHdhcyA8IDAuMDAxIChhcyBpdCB3aWxsIGJlIGlmIHdlIHNlbGVjdFxuICogaW50byBhbiBleHBlcmltZW50KSwgdGhlIG5leHQgdmFsdWUgY291bGQgYmUgbGVzcyB0aGFuIDAuNSBtb3JlIHRoYW5cbiAqIDUwLjclIG9mIHRoZSB0aW1lLiAgVGhpcyBwcm92aWRlcyBhbiBpbXBsZW1lbnRhdGlvbiB0aGF0IHJvb3RzIGRvd24gaW50b1xuICogdGhlIGNyeXB0byBBUEksIHdoZW4gYXZhaWxhYmxlLCB0byBwcm9kdWNlIGxlc3MgYmlhc2VkIHNhbXBsZXMuXG4gKlxuICogQHJldHVybiB7bnVtYmVyfSBQc2V1ZG8tcmFuZG9tIGZsb2F0aW5nLXBvaW50IHZhbHVlIG9uIHRoZSByYW5nZSBbMCwgMSkuXG4gKi9cbmZ1bmN0aW9uIHNsb3dCdXRBY2N1cmF0ZVBybmcoKSB7XG4gIC8vIFRPRE8odGRybCk6IEltcGxlbWVudC5cbiAgcmV0dXJuIE1hdGgucmFuZG9tKCk7XG59XG5cbi8qKlxuICogQ29udGFpbmVyIGZvciBhbHRlcm5hdGUgcmFuZG9tIG51bWJlciBnZW5lcmF0b3IgaW1wbGVtZW50YXRpb25zLiAgVGhpc1xuICogYWxsb3dzIHVzIHRvIHNldCBhbiBcImFjY3VyYXRlXCIgUFJORyBmb3IgYnJhbmNoIHNlbGVjdGlvbiwgYnV0IHRvIG1vY2sgaXRcbiAqIG91dCBlYXNpbHkgaW4gdGVzdHMuXG4gKlxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKiBAY29uc3QgeyF7YWNjdXJhdGVQcm5nOiBmdW5jdGlvbigpOm51bWJlcn19XG4gKi9cbmV4cG9ydCBjb25zdCBSQU5ET01fTlVNQkVSX0dFTkVSQVRPUlMgPSB7XG4gIGFjY3VyYXRlUHJuZzogc2xvd0J1dEFjY3VyYXRlUHJuZyxcbn07XG5cbi8qKlxuICogU2VsZWN0cywgdW5pZm9ybWx5IGF0IHJhbmRvbSwgYSBzaW5nbGUgaXRlbSBmcm9tIHRoZSBhcnJheS5cbiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IGFyciBPYmplY3QgdG8gc2VsZWN0IGZyb20uXG4gKiBAcmV0dXJuIHs/c3RyaW5nfSBTaW5nbGUgaXRlbSBmcm9tIGFyciBvciBudWxsIGlmIGFyciB3YXMgZW1wdHkuXG4gKi9cbmZ1bmN0aW9uIHNlbGVjdFJhbmRvbUl0ZW0oYXJyKSB7XG4gIGNvbnN0IHJuID0gUkFORE9NX05VTUJFUl9HRU5FUkFUT1JTLmFjY3VyYXRlUHJuZygpO1xuICByZXR1cm4gYXJyW01hdGguZmxvb3Iocm4gKiBhcnIubGVuZ3RoKV0gfHwgbnVsbDtcbn1cblxuLyoqXG4gKiBTZWxlY3RzIHdoaWNoIHBhZ2UtbGV2ZWwgZXhwZXJpbWVudCBicmFuY2hlcyBhcmUgZW5hYmxlZC4gSWYgYSBnaXZlblxuICogZXhwZXJpbWVudCBuYW1lIGlzIGFscmVhZHkgc2V0IChpbmNsdWRpbmcgdG8gdGhlIG51bGwgLyBubyBicmFuY2hlcyBzZWxlY3RlZFxuICogc3RhdGUpLCB0aGlzIHdvbid0IGFsdGVyIGl0cyBzdGF0ZS5cbiAqXG4gKiBDaGVjayB3aGV0aGVyIGEgZ2l2ZW4gZXhwZXJpbWVudCBpcyBzZXQgdXNpbmcgaXNFeHBlcmltZW50T24od2luLFxuICogZXhwZXJpbWVudE5hbWUpIGFuZCwgaWYgaXQgaXMgb24sIGxvb2sgZm9yIHdoaWNoIGJyYW5jaCBpcyBzZWxlY3RlZCBpblxuICogd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV0uXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW4gV2luZG93IGNvbnRleHQgb24gd2hpY2ggdG8gc2F2ZSBleHBlcmltZW50XG4gKiAgICAgc2VsZWN0aW9uIHN0YXRlLlxuICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgIUV4cGVyaW1lbnRJbmZvPn0gZXhwZXJpbWVudHMgIFNldCBvZiBleHBlcmltZW50cyB0b1xuICogICAgIGNvbmZpZ3VyZSBmb3IgdGhpcyBwYWdlIGxvYWQuXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn0gTWFwIG9mIGV4cGVyaW1lbnQgbmFtZXMgdG8gc2VsZWN0ZWRcbiAqICAgICBicmFuY2hlcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJhbmRvbWx5U2VsZWN0VW5zZXRFeHBlcmltZW50cyh3aW4sIGV4cGVyaW1lbnRzKSB7XG4gIHdpbi5leHBlcmltZW50QnJhbmNoZXMgPSB3aW4uZXhwZXJpbWVudEJyYW5jaGVzIHx8IHt9O1xuICBjb25zdCBzZWxlY3RlZEV4cGVyaW1lbnRzID0ge307XG4gIGZvciAoY29uc3QgZXhwZXJpbWVudE5hbWUgaW4gZXhwZXJpbWVudHMpIHtcbiAgICAvLyBTa2lwIGV4cGVyaW1lbnROYW1lIGlmIGl0IGlzIG5vdCBhIGtleSBvZiBleHBlcmltZW50cyBvYmplY3Qgb3IgaWYgaXRcbiAgICAvLyBoYXMgYWxyZWFkeSBiZWVuIHBvcHVsYXRlZCBieSBzb21lIG90aGVyIHByb3BlcnR5LlxuICAgIGlmICghaGFzT3duKGV4cGVyaW1lbnRzLCBleHBlcmltZW50TmFtZSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoaGFzT3duKHdpbi5leHBlcmltZW50QnJhbmNoZXMsIGV4cGVyaW1lbnROYW1lKSkge1xuICAgICAgc2VsZWN0ZWRFeHBlcmltZW50c1tleHBlcmltZW50TmFtZV0gPVxuICAgICAgICAgIHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgaWYgKCFleHBlcmltZW50c1tleHBlcmltZW50TmFtZV0uaXNUcmFmZmljRWxpZ2libGUgfHxcbiAgICAgICAgIWV4cGVyaW1lbnRzW2V4cGVyaW1lbnROYW1lXS5pc1RyYWZmaWNFbGlnaWJsZSh3aW4pKSB7XG4gICAgICB3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXSA9IG51bGw7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICAvLyBJZiB3ZSdyZSBpbiB0aGUgZXhwZXJpbWVudCwgYnV0IHdlIGhhdmVuJ3QgYWxyZWFkeSBmb3JjZWQgYSBzcGVjaWZpY1xuICAgIC8vIGV4cGVyaW1lbnQgYnJhbmNoIChlLmcuLCB2aWEgYSB0ZXN0IHNldHVwKSwgdGhlbiByYW5kb21pemUgdGhlIGJyYW5jaFxuICAgIC8vIGNob2ljZS5cbiAgICBpZiAoIXdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdICYmXG4gICAgICBpc0V4cGVyaW1lbnRPbih3aW4sIC8qT0sqL2V4cGVyaW1lbnROYW1lKSkge1xuICAgICAgY29uc3Qge2JyYW5jaGVzfSA9IGV4cGVyaW1lbnRzW2V4cGVyaW1lbnROYW1lXTtcbiAgICAgIHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdID0gc2VsZWN0UmFuZG9tSXRlbShicmFuY2hlcyk7XG4gICAgICBzZWxlY3RlZEV4cGVyaW1lbnRzW2V4cGVyaW1lbnROYW1lXSA9XG4gICAgICAgICAgd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV07XG4gICAgfVxuICB9XG4gIHJldHVybiBzZWxlY3RlZEV4cGVyaW1lbnRzO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGV4cGVyaW1lbnQgYnJhbmNoIGVuYWJsZWQgZm9yIHRoZSBnaXZlbiBleHBlcmltZW50IElELlxuICogRm9yIGV4YW1wbGUsICdjb250cm9sJyBvciAnZXhwZXJpbWVudCcuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW4gV2luZG93IGNvbnRleHQgdG8gY2hlY2sgZm9yIGV4cGVyaW1lbnQgc3RhdGUuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXhwZXJpbWVudE5hbWUgTmFtZSBvZiB0aGUgZXhwZXJpbWVudCB0byBjaGVjay5cbiAqIEByZXR1cm4gez9zdHJpbmd9IEFjdGl2ZSBleHBlcmltZW50IGJyYW5jaCBJRCBmb3IgZXhwZXJpbWVudE5hbWUgKHBvc3NpYmx5XG4gKiAgICAgbnVsbCBpZiBleHBlcmltZW50TmFtZSBoYXMgYmVlbiB0ZXN0ZWQgYnV0IG5vIGJyYW5jaCB3YXMgZW5hYmxlZCkuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFeHBlcmltZW50QnJhbmNoKHdpbiwgZXhwZXJpbWVudE5hbWUpIHtcbiAgcmV0dXJuIHdpbi5leHBlcmltZW50QnJhbmNoZXMgPyB3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXSA6IG51bGw7XG59XG5cbi8qKlxuICogRm9yY2UgZW5hYmxlIChvciBkaXNhYmxlKSBhIHNwZWNpZmljIGJyYW5jaCBvZiBhIGdpdmVuIGV4cGVyaW1lbnQgbmFtZS5cbiAqIERpc2FibGVzIHRoZSBleHBlcmltZW50IG5hbWUgYWx0b2dldGhlciBpZiBicmFuY2hJZCBpcyBmYWxzZWlzaC5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpbiBXaW5kb3cgY29udGV4dCB0byBjaGVjayBmb3IgZXhwZXJpbWVudCBzdGF0ZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHBlcmltZW50TmFtZSBOYW1lIG9mIHRoZSBleHBlcmltZW50IHRvIGNoZWNrLlxuICogQHBhcmFtIHs/c3RyaW5nfSBicmFuY2hJZCBJRCBvZiBicmFuY2ggdG8gZm9yY2Ugb3IgbnVsbCB0byBkaXNhYmxlXG4gKiAgICAgYWx0b2dldGhlci5cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZm9yY2VFeHBlcmltZW50QnJhbmNoKHdpbiwgZXhwZXJpbWVudE5hbWUsIGJyYW5jaElkKSB7XG4gIHdpbi5leHBlcmltZW50QnJhbmNoZXMgPSB3aW4uZXhwZXJpbWVudEJyYW5jaGVzIHx8IHt9O1xuICB0b2dnbGVFeHBlcmltZW50KHdpbiwgZXhwZXJpbWVudE5hbWUsICEhYnJhbmNoSWQsIHRydWUpO1xuICB3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXSA9IGJyYW5jaElkO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuLyoqXG4gKiBAcGFyYW0ge251bWJlcj19IG9wdF9iYXNlIEV4cG9uZW50aWFsIGJhc2UuIERlZmF1bHRzIHRvIDIuXG4gKiBAcmV0dXJuIHtmdW5jdGlvbihmdW5jdGlvbigpKTogbnVtYmVyfSBGdW5jdGlvbiB0aGF0IHdoZW4gaW52b2tlZCB3aWxsXG4gKiAgICAgY2FsbCB0aGUgcGFzc2VkIGluIGZ1bmN0aW9uLiBPbiBldmVyeSBpbnZvY2F0aW9uIHRoZSBuZXh0XG4gKiAgICAgaW52b2NhdGlvbiBvZiB0aGUgcGFzc2VkIGluIGZ1bmN0aW9uIHdpbGwgYmUgZXhwb25lbnRpYWxseVxuICogICAgIGxhdGVyLiBSZXR1cm5lZCBmdW5jdGlvbiByZXR1cm5zIHRpbWVvdXQgaWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHBvbmVudGlhbEJhY2tvZmYob3B0X2Jhc2UpIHtcbiAgY29uc3QgZ2V0VGltZW91dCA9IGV4cG9uZW50aWFsQmFja29mZkNsb2NrKG9wdF9iYXNlKTtcbiAgcmV0dXJuIHdvcmsgPT4ge1xuICAgIHJldHVybiBzZXRUaW1lb3V0KHdvcmssIGdldFRpbWVvdXQoKSk7XG4gIH07XG59XG5cbi8qKlxuICogQHBhcmFtIHtudW1iZXI9fSBvcHRfYmFzZSBFeHBvbmVudGlhbCBiYXNlLiBEZWZhdWx0cyB0byAyLlxuICogQHJldHVybiB7ZnVuY3Rpb24oKTogbnVtYmVyfSBGdW5jdGlvbiB0aGF0IHdoZW4gaW52b2tlZCB3aWxsIHJldHVyblxuICogICAgYSBudW1iZXIgdGhhdCBleHBvbmVudGlhbGx5IGdyb3dzIHBlciBpbnZvY2F0aW9uLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhwb25lbnRpYWxCYWNrb2ZmQ2xvY2sob3B0X2Jhc2UpIHtcbiAgY29uc3QgYmFzZSA9IG9wdF9iYXNlIHx8IDI7XG4gIGxldCBjb3VudCA9IDA7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgbGV0IHdhaXQgPSBNYXRoLnBvdyhiYXNlLCBjb3VudCsrKTtcbiAgICB3YWl0ICs9IGdldEppdHRlcih3YWl0KTtcbiAgICByZXR1cm4gd2FpdCAqIDEwMDA7XG4gIH07XG59XG5cbi8qKlxuICogQWRkIGppdHRlciB0byBhdm9pZCB0aGUgdGh1bmRlcmluZyBoZXJkLiBUaGlzIGNhbiBlLmcuIGhhcHBlbiB3aGVuXG4gKiB3ZSBwb2xsIGEgYmFja2VuZCBhbmQgaXQgZmFpbHMgZm9yIGV2ZXJ5b25lIGF0IHRoZSBzYW1lIHRpbWUuXG4gKiBXZSBhZGQgdXAgdG8gMzAlIChkZWZhdWx0KSBsb25nZXIgb3Igc2hvcnRlciB0aGFuIHRoZSBnaXZlbiB0aW1lLlxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSB3YWl0IHRoZSBhbW91bnQgaWYgYmFzZSBtaWxsaXNlY29uZHNcbiAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0X3BlcmMgdGhlIG1pbi9tYXggcGVyY2VudGFnZSB0byBhZGQgb3Igc3V0cmFjdFxuICogQHJldHVybiB7bnVtYmVyfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Sml0dGVyKHdhaXQsIG9wdF9wZXJjKSB7XG4gIG9wdF9wZXJjID0gb3B0X3BlcmMgfHwgLjM7XG4gIGxldCBqaXR0ZXIgPSB3YWl0ICogb3B0X3BlcmMgKiBNYXRoLnJhbmRvbSgpO1xuICBpZiAoTWF0aC5yYW5kb20oKSA+IC41KSB7XG4gICAgaml0dGVyICo9IC0xO1xuICB9XG4gIHJldHVybiBqaXR0ZXI7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtDb21tb25TaWduYWxzfSBmcm9tICcuL2NvbW1vbi1zaWduYWxzJztcbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4vc2VydmljZXMnO1xuaW1wb3J0IHtcbiAgY3JlYXRlRWxlbWVudFdpdGhBdHRyaWJ1dGVzLFxuICByZW1vdmVFbGVtZW50LFxufSBmcm9tICcuL2RvbSc7XG5pbXBvcnQge2Rldn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtkaWN0fSBmcm9tICcuL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge2lzQXJyYXksIHRvV2lufSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7dHJpZ2dlckFuYWx5dGljc0V2ZW50fSBmcm9tICcuL2FuYWx5dGljcyc7XG5cbi8qKlxuICogTWV0aG9kIHRvIGNyZWF0ZSBzY29wZWQgYW5hbHl0aWNzIGVsZW1lbnQgZm9yIGFueSBlbGVtZW50LlxuICogVE9ETzogTWFrZSB0aGlzIGZ1bmN0aW9uIHByaXZhdGVcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudEVsZW1lbnRcbiAqIEBwYXJhbSB7IUpzb25PYmplY3R9IGNvbmZpZ1xuICogQHBhcmFtIHtib29sZWFuPX0gbG9hZEFuYWx5dGljc1xuICogQHBhcmFtIHtib29sZWFuPX0gZGlzYWJsZUltbWVkaWF0ZVxuICogQHJldHVybiB7IUVsZW1lbnR9IGNyZWF0ZWQgYW5hbHl0aWNzIGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc2VydEFuYWx5dGljc0VsZW1lbnQoXG4gIHBhcmVudEVsZW1lbnQsIGNvbmZpZywgbG9hZEFuYWx5dGljcyA9IGZhbHNlLCBkaXNhYmxlSW1tZWRpYXRlID0gZmFsc2UpIHtcbiAgY29uc3QgZG9jID0gLyoqIEB0eXBlIHshRG9jdW1lbnR9ICovIChwYXJlbnRFbGVtZW50Lm93bmVyRG9jdW1lbnQpO1xuICBjb25zdCBhbmFseXRpY3NFbGVtID0gY3JlYXRlRWxlbWVudFdpdGhBdHRyaWJ1dGVzKFxuICAgICAgZG9jLFxuICAgICAgJ2FtcC1hbmFseXRpY3MnLCBkaWN0KHtcbiAgICAgICAgJ3NhbmRib3gnOiAndHJ1ZScsXG4gICAgICAgICd0cmlnZ2VyJzogZGlzYWJsZUltbWVkaWF0ZSA/ICcnIDogJ2ltbWVkaWF0ZScsXG4gICAgICB9KSk7XG4gIGNvbnN0IHNjcmlwdEVsZW0gPSBjcmVhdGVFbGVtZW50V2l0aEF0dHJpYnV0ZXMoXG4gICAgICBkb2MsXG4gICAgICAnc2NyaXB0JywgZGljdCh7XG4gICAgICAgICd0eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgfSkpO1xuICBzY3JpcHRFbGVtLnRleHRDb250ZW50ID0gSlNPTi5zdHJpbmdpZnkoY29uZmlnKTtcbiAgYW5hbHl0aWNzRWxlbS5hcHBlbmRDaGlsZChzY3JpcHRFbGVtKTtcbiAgYW5hbHl0aWNzRWxlbS5DT05GSUcgPSBjb25maWc7XG5cbiAgLy8gRm9yY2UgbG9hZCBhbmFseXRpY3MgZXh0ZW5zaW9uIGlmIHNjcmlwdCBub3QgaW5jbHVkZWQgaW4gcGFnZS5cbiAgaWYgKGxvYWRBbmFseXRpY3MpIHtcbiAgICAvLyBHZXQgRXh0ZW5zaW9ucyBzZXJ2aWNlIGFuZCBmb3JjZSBsb2FkIGFuYWx5dGljcyBleHRlbnNpb24uXG4gICAgY29uc3QgZXh0ZW5zaW9ucyA9XG4gICAgICAgIFNlcnZpY2VzLmV4dGVuc2lvbnNGb3IodG9XaW4ocGFyZW50RWxlbWVudC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3KSk7XG4gICAgY29uc3QgYW1wZG9jID0gU2VydmljZXMuYW1wZG9jKHBhcmVudEVsZW1lbnQpO1xuICAgIGV4dGVuc2lvbnMuLypPSyovaW5zdGFsbEV4dGVuc2lvbkZvckRvYyhhbXBkb2MsICdhbXAtYW5hbHl0aWNzJyk7XG4gIH0gZWxzZSB7XG4gICAgU2VydmljZXMuYW5hbHl0aWNzRm9yRG9jT3JOdWxsKHBhcmVudEVsZW1lbnQpLnRoZW4oYW5hbHl0aWNzID0+IHtcbiAgICAgIGRldigpLmFzc2VydChhbmFseXRpY3MpO1xuICAgIH0pO1xuICB9XG4gIHBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoYW5hbHl0aWNzRWxlbSk7XG4gIHJldHVybiBhbmFseXRpY3NFbGVtO1xufVxuXG4vKipcbiAqIEEgY2xhc3MgdGhhdCBoYW5kbGVzIGN1c3RvbUV2ZW50IHJlcG9ydGluZyBvZiBleHRlbnNpb24gZWxlbWVudCB0aHJvdWdoXG4gKiBhbXAtYW5hbHl0aWNzLiBUaGlzIGNsYXNzIGlzIG5vdCBleHBvc2VkIHRvIGV4dGVuc2lvbiBlbGVtZW50IGRpcmVjdGx5IHRvXG4gKiByZXN0cmljdCB0aGUgZ2VucmF0aW9uIG9mIHRoZSBjb25maWcgUGxlYXNlIHVzZSBDdXN0b21FdmVudFJlcG9ydGVyQnVpbGRlciB0b1xuICogYnVpbGQgYSBDdXN0b21FdmVudFJlcG9ydGVyIGluc3RhbmNlLlxuICovXG5jbGFzcyBDdXN0b21FdmVudFJlcG9ydGVyIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICAgKiBAcGFyYW0geyFKc29uT2JqZWN0fSBjb25maWdcbiAgICovXG4gIGNvbnN0cnVjdG9yKHBhcmVudCwgY29uZmlnKSB7XG4gICAgZGV2KCkuYXNzZXJ0KGNvbmZpZ1sndHJpZ2dlcnMnXSwgJ0NvbmZpZyBtdXN0IGhhdmUgdHJpZ2dlcnMgZGVmaW5lZCcpO1xuICAgIC8qKiBAcHJpdmF0ZSB7c3RyaW5nfSAqL1xuICAgIHRoaXMuaWRfID0gcGFyZW50LmdldFJlc291cmNlSWQoKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IUFtcEVsZW1lbnR9ICovXG4gICAgdGhpcy5wYXJlbnRfID0gcGFyZW50O1xuXG4gICAgLyoqIEBwcml2YXRlIHtKc29uT2JqZWN0fSAqL1xuICAgIHRoaXMuY29uZmlnXyA9IGNvbmZpZztcblxuICAgIGZvciAoY29uc3QgZXZlbnQgaW4gY29uZmlnWyd0cmlnZ2VycyddKSB7XG4gICAgICBjb25zdCBldmVudFR5cGUgPSBjb25maWdbJ3RyaWdnZXJzJ11bZXZlbnRdWydvbiddO1xuICAgICAgZGV2KCkuYXNzZXJ0KGV2ZW50VHlwZSxcbiAgICAgICAgICAnQ3VzdG9tRXZlbnRSZXBvcnRlciBjb25maWcgbXVzdCBzcGVjaWZ5IHRyaWdnZXIgZXZlbnRUeXBlJyk7XG4gICAgICBjb25zdCBuZXdFdmVudFR5cGUgPSB0aGlzLmdldEV2ZW50VHlwZUluU2FuZGJveF8oZXZlbnRUeXBlKTtcbiAgICAgIGNvbmZpZ1sndHJpZ2dlcnMnXVtldmVudF1bJ29uJ10gPSBuZXdFdmVudFR5cGU7XG4gICAgfVxuXG4gICAgdGhpcy5wYXJlbnRfLnNpZ25hbHMoKS53aGVuU2lnbmFsKENvbW1vblNpZ25hbHMuTE9BRF9TVEFSVCkudGhlbigoKSA9PiB7XG4gICAgICBpbnNlcnRBbmFseXRpY3NFbGVtZW50KHRoaXMucGFyZW50XywgY29uZmlnLCBmYWxzZSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50VHlwZVxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+PX0gb3B0X3ZhcnMgQSBtYXAgb2YgdmFycyBhbmQgdGhlaXIgdmFsdWVzLlxuICAgKi9cbiAgdHJpZ2dlcihldmVudFR5cGUsIG9wdF92YXJzKSB7XG4gICAgZGV2KCkuYXNzZXJ0KHRoaXMuY29uZmlnX1sndHJpZ2dlcnMnXVtldmVudFR5cGVdLFxuICAgICAgICAnQ2Fubm90IHRyaWdnZXIgbm9uIGluaXRpYXRlZCBldmVudFR5cGUnKTtcbiAgICB0cmlnZ2VyQW5hbHl0aWNzRXZlbnQodGhpcy5wYXJlbnRfLFxuICAgICAgICB0aGlzLmdldEV2ZW50VHlwZUluU2FuZGJveF8oZXZlbnRUeXBlKSwgb3B0X3ZhcnMpO1xuICB9XG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICovXG4gIGdldEV2ZW50VHlwZUluU2FuZGJveF8oZXZlbnRUeXBlKSB7XG4gICAgcmV0dXJuIGBzYW5kYm94LSR7dGhpcy5pZF99LSR7ZXZlbnRUeXBlfWA7XG4gIH1cbn1cblxuXG4vKipcbiAqIEEgYnVpbGRlciBjbGFzcyB0aGF0IGVuYWJsZSBleHRlbnNpb24gZWxlbWVudHMgdG8gZWFzaWx5IGJ1aWxkIGFuZCBnZXQgYVxuICogQ3VzdG9tRXZlbnRSZXBvcnRlciBpbnN0YW5jZS4gSXRzIGNvbnN0cnVjdG9yIHJlcXVpcmVzIHRoZSBwYXJlbnQgQU1QXG4gKiBlbGVtZW50LiBJdCBwcm92aWRlcyB0d28gbWV0aG9kcyAjdHJhY2soKSBhbmQgI2J1aWxkKCkgdG8gYnVpbGQgdGhlXG4gKiBDdXN0b21FdmVudFJlcG9ydGVyIGluc3RhbmNlLlxuICovXG5leHBvcnQgY2xhc3MgQ3VzdG9tRXZlbnRSZXBvcnRlckJ1aWxkZXIge1xuICAvKiogQHBhcmFtIHshQW1wRWxlbWVudH0gcGFyZW50ICovXG4gIGNvbnN0cnVjdG9yKHBhcmVudCkge1xuXG4gICAgLyoqIEBwcml2YXRlIHshQW1wRWxlbWVudH0gKi9cbiAgICB0aGlzLnBhcmVudF8gPSBwYXJlbnQ7XG5cbiAgICAvKiogQHByaXZhdGUgez9Kc29uT2JqZWN0fSAqL1xuICAgIHRoaXMuY29uZmlnXyA9IC8qKiBAdHlwZSB7SnNvbk9iamVjdH0gKi8gKHtcbiAgICAgICdyZXF1ZXN0cyc6IHt9LFxuICAgICAgJ3RyaWdnZXJzJzoge30sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogVGhlICN0cmFjaygpIG1ldGhvZCB0YWtlcyBpbiBhIHVuaXF1ZSBjdXN0b20tZXZlbnQgbmFtZSwgYW5kIHRoZVxuICAgKiBjb3JyZXNwb25kaW5nIHJlcXVlc3QgdXJsIChvciBhbiBhcnJheSBvZiByZXF1ZXN0IHVybHMpLiBPbmUgY2FuIGNhbGxcbiAgICogI3RyYWNrKCkgbXVsdGlwbGUgdGltZXMgd2l0aCBkaWZmZXJlbnQgZXZlbnRUeXBlIG5hbWUgKG9yZGVyIGRvZXNuJ3RcbiAgICogbWF0dGVyKSBiZWZvcmUgI2J1aWxkKCkgaXMgY2FsbGVkLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gICAqIEBwYXJhbSB7c3RyaW5nfCFBcnJheTxzdHJpbmc+fSByZXF1ZXN0XG4gICAqL1xuICB0cmFjayhldmVudFR5cGUsIHJlcXVlc3QpIHtcbiAgICByZXF1ZXN0ID0gaXNBcnJheShyZXF1ZXN0KSA/IHJlcXVlc3QgOiBbcmVxdWVzdF07XG4gICAgZGV2KCkuYXNzZXJ0KCF0aGlzLmNvbmZpZ19bJ3RyaWdnZXJzJ11bZXZlbnRUeXBlXSxcbiAgICAgICAgJ2N1c3RvbUV2ZW50UmVwb3J0ZXJCdWlsZGVyIHNob3VsZCBub3QgdHJhY2sgc2FtZSBldmVudFR5cGUgdHdpY2UnKTtcbiAgICBjb25zdCByZXF1ZXN0TGlzdCA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVxdWVzdC5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgcmVxdWVzdE5hbWUgPSBgJHtldmVudFR5cGV9LXJlcXVlc3QtJHtpfWA7XG4gICAgICB0aGlzLmNvbmZpZ19bJ3JlcXVlc3RzJ11bcmVxdWVzdE5hbWVdID0gcmVxdWVzdFtpXTtcbiAgICAgIHJlcXVlc3RMaXN0LnB1c2gocmVxdWVzdE5hbWUpO1xuICAgIH1cbiAgICB0aGlzLmNvbmZpZ19bJ3RyaWdnZXJzJ11bZXZlbnRUeXBlXSA9IHtcbiAgICAgICdvbic6IGV2ZW50VHlwZSxcbiAgICAgICdyZXF1ZXN0JzogcmVxdWVzdExpc3QsXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsIHRoZSAjYnVpbGQoKSBtZXRob2QgdG8gYnVpbGQgYW5kIGdldCB0aGUgQ3VzdG9tRXZlbnRSZXBvcnRlciBpbnN0YW5jZS5cbiAgICogT25lIEN1c3RvbUV2ZW50UmVwb3J0ZXJCdWlsZGVyIGluc3RhbmNlIGNhbiBvbmx5IGJ1aWxkIG9uZSByZXBvcnRlciwgd2hpY2hcbiAgICogbWVhbnMgI2J1aWxkKCkgc2hvdWxkIG9ubHkgYmUgY2FsbGVkIG9uY2UgYWZ0ZXIgYWxsIGV2ZW50VHlwZSBhcmUgYWRkZWQuXG4gICAqL1xuICBidWlsZCgpIHtcbiAgICBkZXYoKS5hc3NlcnQodGhpcy5jb25maWdfLCAnQ3VzdG9tRXZlbnRSZXBvcnRlciBhbHJlYWR5IGJ1aWx0Jyk7XG4gICAgY29uc3QgcmVwb3J0ID0gbmV3IEN1c3RvbUV2ZW50UmVwb3J0ZXIoXG4gICAgICAgIHRoaXMucGFyZW50XywgLyoqIEB0eXBlIHshSnNvbk9iamVjdH0gKi8gKHRoaXMuY29uZmlnXykpO1xuICAgIHRoaXMuY29uZmlnXyA9IG51bGw7XG4gICAgcmV0dXJuIHJlcG9ydDtcbiAgfVxufVxuXG5cbi8qKlxuICogQSBoZWxwZXIgbWV0aG9kIHRoYXQgc2hvdWxkIGJlIHVzZWQgYnkgYWxsIGV4dGVuc2lvbiBlbGVtZW50cyB0byBhZGQgdGhlaXJcbiAqIHNhbmRib3ggYW5hbHl0aWNzIHRyYWNraW5nLiBUaGlzIG1ldGhvZCB0YWtlcyBjYXJlIG9mIGluc2VydCBhbmQgcmVtb3ZlIHRoZVxuICogYW5hbHl0aWNzIHRyYWNrZXIgYXQgdGhlIHJpZ2h0IHRpbWUgb2YgdGhlIGVsZW1lbnQgbGlmZWN5Y2xlLlxuICogQHBhcmFtIHshQW1wRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHshUHJvbWlzZTwhSnNvbk9iamVjdD59IHByb21pc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUFuYWx5dGljc0luU2FuZGJveChlbGVtZW50LCBwcm9taXNlKSB7XG4gIGxldCBhbmFseXRpY3NFbGVtZW50ID0gbnVsbDtcbiAgbGV0IGNvbmZpZ1Byb21pc2UgPSBwcm9taXNlO1xuICAvLyBMaXN0ZW5lciB0byBMT0FEX1NUQVJUIHNpZ25hbC4gSW5zZXJ0IGFuYWx5dGljcyBlbGVtZW50IG9uIExPQURfU1RBUlRcbiAgZWxlbWVudC5zaWduYWxzKCkud2hlblNpZ25hbChDb21tb25TaWduYWxzLkxPQURfU1RBUlQpLnRoZW4oKCkgPT4ge1xuICAgIGlmIChhbmFseXRpY3NFbGVtZW50IHx8ICFjb25maWdQcm9taXNlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbmZpZ1Byb21pc2UudGhlbihjb25maWcgPT4ge1xuICAgICAgaWYgKCFjb25maWdQcm9taXNlKSB7XG4gICAgICAgIC8vIElmIGNvbmZpZyBwcm9taXNlIHJlc29sdmUgYWZ0ZXIgdW5sb2FkLCBkbyBub3RoaW5nLlxuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25maWdQcm9taXNlID0gbnVsbDtcbiAgICAgIGFuYWx5dGljc0VsZW1lbnQgPSBpbnNlcnRBbmFseXRpY3NFbGVtZW50KGVsZW1lbnQsIGNvbmZpZywgZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICAvLyBMaXN0ZW5lciB0byBVTkxPQUQgc2lnbmFsLiBEZXN0cm95IHJlbW92ZSBlbGVtZW50IG9uIFVOTE9BRFxuICBlbGVtZW50LnNpZ25hbHMoKS53aGVuU2lnbmFsKENvbW1vblNpZ25hbHMuVU5MT0FEKS50aGVuKCgpID0+IHtcbiAgICBjb25maWdQcm9taXNlID0gbnVsbDtcbiAgICBpZiAoYW5hbHl0aWNzRWxlbWVudCkge1xuICAgICAgcmVtb3ZlRWxlbWVudChhbmFseXRpY3NFbGVtZW50KTtcbiAgICAgIGFuYWx5dGljc0VsZW1lbnQgPSBudWxsO1xuICAgIH1cbiAgfSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtDb21tb25TaWduYWxzfSBmcm9tICcuL2NvbW1vbi1zaWduYWxzJztcbmltcG9ydCB7T2JzZXJ2YWJsZX0gZnJvbSAnLi9vYnNlcnZhYmxlJztcbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4vc2VydmljZXMnO1xuaW1wb3J0IHtTaWduYWxzfSBmcm9tICcuL3V0aWxzL3NpZ25hbHMnO1xuaW1wb3J0IHtjbG9zZXN0QnlTZWxlY3RvciwgZXNjYXBlSHRtbH0gZnJvbSAnLi9kb20nO1xuaW1wb3J0IHtkZXYsIHJldGhyb3dBc3luYywgdXNlcn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtkaXNwb3NlU2VydmljZXNGb3JFbWJlZCwgZ2V0VG9wV2luZG93fSBmcm9tICcuL3NlcnZpY2UnO1xuaW1wb3J0IHtpc0RvY3VtZW50UmVhZHl9IGZyb20gJy4vZG9jdW1lbnQtcmVhZHknO1xuaW1wb3J0IHtsYXlvdXRSZWN0THR3aCwgbW92ZUxheW91dFJlY3R9IGZyb20gJy4vbGF5b3V0LXJlY3QnO1xuaW1wb3J0IHtsb2FkUHJvbWlzZX0gZnJvbSAnLi9ldmVudC1oZWxwZXInO1xuaW1wb3J0IHtcbiAgcHgsXG4gIHJlc2V0U3R5bGVzLFxuICBzZXRJbXBvcnRhbnRTdHlsZXMsXG4gIHNldFN0eWxlLFxuICBzZXRTdHlsZXMsXG59IGZyb20gJy4vc3R5bGUnO1xuaW1wb3J0IHt0b1dpbn0gZnJvbSAnLi90eXBlcyc7XG5cblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgRU1CRURfUFJPUCA9ICdfX0FNUF9FTUJFRF9fJztcblxuLyoqIEBjb25zdCB7IUFycmF5PHN0cmluZz59ICovXG5jb25zdCBFWENMVURFX0lOSV9MT0FEID1cbiAgICBbJ0FNUC1BRCcsICdBTVAtQU5BTFlUSUNTJywgJ0FNUC1QSVhFTCcsICdBTVAtQUQtRVhJVCddO1xuXG5cbi8qKlxuICogUGFyYW1ldGVycyB1c2VkIHRvIGNyZWF0ZSB0aGUgbmV3IFwiZnJpZW5kbHkgaWZyYW1lXCIgZW1iZWQuXG4gKiAtIGh0bWw6IFRoZSBjb21wbGV0ZSBjb250ZW50IG9mIGFuIEFNUCBlbWJlZCwgd2hpY2ggaXMgaXRzZWxmIGFuIEFNUFxuICogICBkb2N1bWVudC4gQ2FuIGluY2x1ZGUgd2hhdGV2ZXIgaXMgbm9ybWFsbHkgYWxsb3dlZCBpbiBhbiBBTVAgZG9jdW1lbnQsXG4gKiAgIGV4Y2VwdCBmb3IgQU1QIGA8c2NyaXB0PmAgZGVjbGFyYXRpb25zLiBUaG9zZSBzaG91bGQgYmUgcGFzc2VkIGFzIGFuXG4gKiAgIGFycmF5IG9mIGBleHRlbnNpb25JZHNgLlxuICogLSBleHRlbnNpb25zSWRzOiBBbiBvcHRpb25hbCBhcnJheSBvZiBBTVAgZXh0ZW5zaW9uIElEcyB1c2VkIGluIHRoaXMgZW1iZWQuXG4gKiAtIGZvbnRzOiBBbiBvcHRpb25hbCBhcnJheSBvZiBmb250cyB1c2VkIGluIHRoaXMgZW1iZWQuXG4gKlxuICogQHR5cGVkZWYge3tcbiAqICAgaG9zdDogKD9BbXBFbGVtZW50fHVuZGVmaW5lZCksXG4gKiAgIHVybDogc3RyaW5nLFxuICogICBodG1sOiBzdHJpbmcsXG4gKiAgIGV4dGVuc2lvbklkczogKD9BcnJheTxzdHJpbmc+fHVuZGVmaW5lZCksXG4gKiAgIGZvbnRzOiAoP0FycmF5PHN0cmluZz58dW5kZWZpbmVkKSxcbiAqIH19XG4gKi9cbmV4cG9ydCBsZXQgRnJpZW5kbHlJZnJhbWVTcGVjO1xuXG5cbi8qKlxuICogQHR5cGUge2Jvb2xlYW58dW5kZWZpbmVkfVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmxldCBzcmNkb2NTdXBwb3J0ZWQ7XG5cbi8qKlxuICogQHBhcmFtIHtib29sZWFufHVuZGVmaW5lZH0gdmFsXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFNyY2RvY1N1cHBvcnRlZEZvclRlc3RpbmcodmFsKSB7XG4gIHNyY2RvY1N1cHBvcnRlZCA9IHZhbDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgRnJpZW5kbHkgSWZyYW1lcyBhcmUgc3VwcG9ydGVkLlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNTcmNkb2NTdXBwb3J0ZWQoKSB7XG4gIGlmIChzcmNkb2NTdXBwb3J0ZWQgPT09IHVuZGVmaW5lZCkge1xuICAgIHNyY2RvY1N1cHBvcnRlZCA9ICdzcmNkb2MnIGluIEhUTUxJRnJhbWVFbGVtZW50LnByb3RvdHlwZTtcbiAgfVxuICByZXR1cm4gc3JjZG9jU3VwcG9ydGVkO1xufVxuXG5cbi8qKlxuICogU2V0cyB3aGV0aGVyIHRoZSBlbWJlZCBpcyBjdXJyZW50bHkgdmlzaWJsZS4gVGhlIGludGVycHJldGF0aW9uIG9mIHZpc2liaWxpdHlcbiAqIGlzIHVwIHRvIHRoZSBlbWJlZCBwYXJlbnQuIEhvd2V2ZXIsIG1vc3Qgb2YgdHlwaWNhbCBjYXNlcyB3b3VsZCByZWx5IG9uXG4gKiB3aGV0aGVyIHRoZSBlbWJlZCBpcyBjdXJyZW50bHkgaW4gdGhlIHZpZXdwb3J0LlxuICogQHBhcmFtIHshRnJpZW5kbHlJZnJhbWVFbWJlZH0gZW1iZWRcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gdmlzaWJsZVxuICogVE9ETyhkdm95dGVua28pOiBSZS1ldmFsdWF0ZSBhbmQgcHJvYmFibHkgZHJvcCBvbmNlIGxheWVycyBhcmUgcmVhZHkuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRGcmllbmRseUlmcmFtZUVtYmVkVmlzaWJsZShlbWJlZCwgdmlzaWJsZSkge1xuICBlbWJlZC5zZXRWaXNpYmxlXyh2aXNpYmxlKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIGVtYmVkIGNyZWF0ZWQgdXNpbmcgYGluc3RhbGxGcmllbmRseUlmcmFtZUVtYmVkYCBvciBgbnVsbGAuXG4gKiBDYXV0aW9uOiBUaGlzIHdpbGwgb25seSByZXR1cm4gdGhlIEZJRSBhZnRlciB0aGUgaWZyYW1lIGhhcyAnbG9hZGVkJy4gSWYgeW91XG4gKiBhcmUgY2hlY2tpbmcgYmVmb3JlIHRoaXMgc2lnbmFsIHlvdSBtYXkgYmUgaW4gYSByYWNlIGNvbmRpdGlvbiB0aGF0IHJldHVybnNcbiAqIG51bGwuXG4gKiBAcGFyYW0geyFIVE1MSUZyYW1lRWxlbWVudH0gaWZyYW1lXG4gKiBAcmV0dXJuIHs/RnJpZW5kbHlJZnJhbWVFbWJlZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEZyaWVuZGx5SWZyYW1lRW1iZWRPcHRpb25hbChpZnJhbWUpIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7P0ZyaWVuZGx5SWZyYW1lRW1iZWR9ICovIChpZnJhbWVbRU1CRURfUFJPUF0pO1xufVxuXG5cbi8qKlxuICogQ3JlYXRlcyB0aGUgcmVxdWVzdGVkIFwiZnJpZW5kbHkgaWZyYW1lXCIgZW1iZWQuIFJldHVybnMgdGhlIHByb21pc2UgdGhhdFxuICogd2lsbCBiZSByZXNvbHZlZCBhcyBzb29uIGFzIHRoZSBlbWJlZCBpcyBhdmFpbGFibGUuIFRoZSBhY3R1YWxcbiAqIGluaXRpYWxpemF0aW9uIG9mIHRoZSBlbWJlZCB3aWxsIHN0YXJ0IGFzIHNvb24gYXMgdGhlIGBpZnJhbWVgIGlzIGFkZGVkXG4gKiB0byB0aGUgRE9NLlxuICogQHBhcmFtIHshSFRNTElGcmFtZUVsZW1lbnR9IGlmcmFtZVxuICogQHBhcmFtIHshRWxlbWVudH0gY29udGFpbmVyXG4gKiBAcGFyYW0geyFGcmllbmRseUlmcmFtZVNwZWN9IHNwZWNcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIVdpbmRvdyk9fSBvcHRfcHJlaW5zdGFsbENhbGxiYWNrXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhRnJpZW5kbHlJZnJhbWVFbWJlZD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnN0YWxsRnJpZW5kbHlJZnJhbWVFbWJlZChpZnJhbWUsIGNvbnRhaW5lciwgc3BlYyxcbiAgb3B0X3ByZWluc3RhbGxDYWxsYmFjaykge1xuICAvKiogQGNvbnN0IHshV2luZG93fSAqL1xuICBjb25zdCB3aW4gPSBnZXRUb3BXaW5kb3codG9XaW4oaWZyYW1lLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcpKTtcbiAgLyoqIEBjb25zdCB7IS4vc2VydmljZS9leHRlbnNpb25zLWltcGwuRXh0ZW5zaW9uc30gKi9cbiAgY29uc3QgZXh0ZW5zaW9ucyA9IFNlcnZpY2VzLmV4dGVuc2lvbnNGb3Iod2luKTtcblxuICBzZXRTdHlsZShpZnJhbWUsICd2aXNpYmlsaXR5JywgJ2hpZGRlbicpO1xuICBpZnJhbWUuc2V0QXR0cmlidXRlKCdyZWZlcnJlcnBvbGljeScsICd1bnNhZmUtdXJsJyk7XG5cbiAgLy8gUHJlLWxvYWQgZXh0ZW5zaW9ucy5cbiAgaWYgKHNwZWMuZXh0ZW5zaW9uSWRzKSB7XG4gICAgc3BlYy5leHRlbnNpb25JZHMuZm9yRWFjaChcbiAgICAgICAgZXh0ZW5zaW9uSWQgPT4gZXh0ZW5zaW9ucy5wcmVsb2FkRXh0ZW5zaW9uKGV4dGVuc2lvbklkKSk7XG4gIH1cblxuICBjb25zdCBodG1sID0gbWVyZ2VIdG1sKHNwZWMpO1xuXG4gIC8vIFJlY2VpdmUgdGhlIHNpZ25hbCB3aGVuIGlmcmFtZSBpcyByZWFkeTogaXQncyBkb2N1bWVudCBpcyBmb3JtZWQuXG4gIGlmcmFtZS5vbmxvYWQgPSAoKSA9PiB7XG4gICAgLy8gQ2hyb21lIGRvZXMgbm90IHJlZmxlY3QgdGhlIGlmcmFtZSByZWFkeXN0YXRlLlxuICAgIGlmcmFtZS5yZWFkeVN0YXRlID0gJ2NvbXBsZXRlJztcbiAgfTtcbiAgY29uc3QgcmVnaXN0ZXJWaW9sYXRpb25MaXN0ZW5lciA9ICgpID0+IHtcbiAgICBpZnJhbWUuY29udGVudFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzZWN1cml0eXBvbGljeXZpb2xhdGlvbicsXG4gICAgICAgIHZpb2xhdGlvbkV2ZW50ID0+IHtcbiAgICAgICAgICBkZXYoKS53YXJuKCdGSUUnLCAnc2VjdXJpdHkgcG9saWN5IHZpb2xhdGlvbicsIHZpb2xhdGlvbkV2ZW50KTtcbiAgICAgICAgfSk7XG4gIH07XG4gIGxldCBsb2FkZWRQcm9taXNlO1xuICBpZiAoaXNTcmNkb2NTdXBwb3J0ZWQoKSkge1xuICAgIGlmcmFtZS5zcmNkb2MgPSBodG1sO1xuICAgIGxvYWRlZFByb21pc2UgPSBsb2FkUHJvbWlzZShpZnJhbWUpO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpZnJhbWUpO1xuICAgIHJlZ2lzdGVyVmlvbGF0aW9uTGlzdGVuZXIoKTtcbiAgfSBlbHNlIHtcbiAgICBpZnJhbWUuc3JjID0gJ2Fib3V0OmJsYW5rJztcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcbiAgICBjb25zdCBjaGlsZERvYyA9IGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50O1xuICAgIGNoaWxkRG9jLm9wZW4oKTtcbiAgICByZWdpc3RlclZpb2xhdGlvbkxpc3RlbmVyKCk7XG4gICAgY2hpbGREb2Mud3JpdGUoaHRtbCk7XG4gICAgLy8gV2l0aCBkb2N1bWVudC53cml0ZSwgYGlmcmFtZS5vbmxvYWRgIGFycml2ZXMgYWxtb3N0IGltbWVkaWF0ZWx5LCB0aHVzXG4gICAgLy8gd2UgbmVlZCB0byB3YWl0IGZvciBjaGlsZCdzIGB3aW5kb3cub25sb2FkYC5cbiAgICBsb2FkZWRQcm9taXNlID0gbG9hZFByb21pc2UoaWZyYW1lLmNvbnRlbnRXaW5kb3cpO1xuICAgIGNoaWxkRG9jLmNsb3NlKCk7XG4gIH1cblxuICAvLyBXYWl0IGZvciBkb2N1bWVudCByZWFkeSBzaWduYWwuXG4gIC8vIFRoaXMgaXMgY29tcGxpY2F0ZWQgZHVlIHRvIGNyYnVnLmNvbS82NDkyMDEgb24gQ2hyb21lIGFuZCBhIHNpbWlsYXIgaXNzdWVcbiAgLy8gb24gU2FmYXJpIHdoZXJlIG5ld2x5IGNyZWF0ZWQgZG9jdW1lbnQncyBgcmVhZHlTdGF0ZWAgaW1tZWRpYXRlbHkgZXF1YWxzXG4gIC8vIGBjb21wbGV0ZWAsIGV2ZW4gdGhvdWdoIHRoZSBkb2N1bWVudCBpdHNlbGYgaXMgbm90IHlldCBhdmFpbGFibGUuIFRoZXJlJ3NcbiAgLy8gbm8gb3RoZXIgcmVsaWFibGUgc2lnbmFsIGZvciBgcmVhZHlTdGF0ZWAgaW4gYSBjaGlsZCB3aW5kb3cgYW5kIHRodXNcbiAgLy8gd2UgaGF2ZSB0byBmYWxsYmFjayB0byBwb2xsaW5nLlxuICBsZXQgcmVhZHlQcm9taXNlO1xuICBpZiAoaXNJZnJhbWVSZWFkeShpZnJhbWUpKSB7XG4gICAgcmVhZHlQcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH0gZWxzZSB7XG4gICAgcmVhZHlQcm9taXNlID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAvKiogQGNvbnN0IHtudW1iZXJ9ICovXG4gICAgICBjb25zdCBpbnRlcnZhbCA9IHdpbi5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgIGlmIChpc0lmcmFtZVJlYWR5KGlmcmFtZSkpIHtcbiAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgd2luLmNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgICAgICB9XG4gICAgICB9LCAvKiBtaWxsaXNlY29uZHMgKi8gNSk7XG5cbiAgICAgIC8vIEZvciBzYWZldHksIG1ha2Ugc3VyZSB3ZSBkZWZpbml0ZWx5IHN0b3AgcG9sbGluZyB3aGVuIGNoaWxkIGRvYyBpc1xuICAgICAgLy8gbG9hZGVkLlxuICAgICAgbG9hZGVkUHJvbWlzZS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIHJldGhyb3dBc3luYyhlcnJvcik7XG4gICAgICB9KS50aGVuKCgpID0+IHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB3aW4uY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiByZWFkeVByb21pc2UudGhlbigoKSA9PiB7XG4gICAgY29uc3QgZW1iZWQgPSBuZXcgRnJpZW5kbHlJZnJhbWVFbWJlZChpZnJhbWUsIHNwZWMsIGxvYWRlZFByb21pc2UpO1xuICAgIGlmcmFtZVtFTUJFRF9QUk9QXSA9IGVtYmVkO1xuXG4gICAgY29uc3QgY2hpbGRXaW4gPSAvKiogQHR5cGUgeyFXaW5kb3d9ICovIChpZnJhbWUuY29udGVudFdpbmRvdyk7XG4gICAgLy8gQWRkIGV4dGVuc2lvbnMuXG4gICAgZXh0ZW5zaW9ucy5pbnN0YWxsRXh0ZW5zaW9uc0luQ2hpbGRXaW5kb3coXG4gICAgICAgIGNoaWxkV2luLCBzcGVjLmV4dGVuc2lvbklkcyB8fCBbXSwgb3B0X3ByZWluc3RhbGxDYWxsYmFjayk7XG4gICAgLy8gUmVhZHkgdG8gYmUgc2hvd24uXG4gICAgZW1iZWQuc3RhcnRSZW5kZXJfKCk7XG4gICAgcmV0dXJuIGVtYmVkO1xuICB9KTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYHRydWVgIHdoZW4gaWZyYW1lIGlzIHJlYWR5LlxuICogQHBhcmFtIHshSFRNTElGcmFtZUVsZW1lbnR9IGlmcmFtZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNJZnJhbWVSZWFkeShpZnJhbWUpIHtcbiAgLy8gVGhpcyBpcyBjb21wbGljYXRlZCBkdWUgdG8gY3JidWcuY29tLzY0OTIwMSBvbiBDaHJvbWUgYW5kIGEgc2ltaWxhciBpc3N1ZVxuICAvLyBvbiBTYWZhcmkgd2hlcmUgbmV3bHkgY3JlYXRlZCBkb2N1bWVudCdzIGByZWFkeVN0YXRlYCBpbW1lZGlhdGVseSBlcXVhbHNcbiAgLy8gYGNvbXBsZXRlYCwgZXZlbiB0aG91Z2ggdGhlIGRvY3VtZW50IGl0c2VsZiBpcyBub3QgeWV0IGF2YWlsYWJsZS4gVGhlcmUnc1xuICAvLyBubyBvdGhlciByZWxpYWJsZSBzaWduYWwgZm9yIGByZWFkeVN0YXRlYCBpbiBhIGNoaWxkIHdpbmRvdyBhbmQgdGh1c1xuICAvLyB0aGUgYmVzdCB3YXkgdG8gY2hlY2sgaXMgdG8gc2VlIHRoZSBjb250ZW50cyBvZiB0aGUgYm9keS5cbiAgY29uc3QgY2hpbGREb2MgPSBpZnJhbWUuY29udGVudFdpbmRvdyAmJiBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDtcbiAgcmV0dXJuICEhKGNoaWxkRG9jICYmXG4gICAgICBpc0RvY3VtZW50UmVhZHkoY2hpbGREb2MpICYmXG4gICAgICBjaGlsZERvYy5ib2R5ICYmXG4gICAgICBjaGlsZERvYy5ib2R5LmZpcnN0Q2hpbGQpO1xufVxuXG5cbi8qKlxuICogTWVyZ2VzIGJhc2UgYW5kIGZvbnRzIGludG8gaHRtbCBkb2N1bWVudC5cbiAqIEBwYXJhbSB7IUZyaWVuZGx5SWZyYW1lU3BlY30gc3BlY1xuICovXG5mdW5jdGlvbiBtZXJnZUh0bWwoc3BlYykge1xuICBjb25zdCBvcmlnaW5hbEh0bWwgPSBzcGVjLmh0bWw7XG4gIGNvbnN0IG9yaWdpbmFsSHRtbFVwID0gb3JpZ2luYWxIdG1sLnRvVXBwZXJDYXNlKCk7XG5cbiAgLy8gRmluZCB0aGUgaW5zZXJ0aW9uIHBvaW50LlxuICBsZXQgaXAgPSBvcmlnaW5hbEh0bWxVcC5pbmRleE9mKCc8SEVBRCcpO1xuICBpZiAoaXAgIT0gLTEpIHtcbiAgICBpcCA9IG9yaWdpbmFsSHRtbFVwLmluZGV4T2YoJz4nLCBpcCArIDEpICsgMTtcbiAgfVxuICBpZiAoaXAgPT0gLTEpIHtcbiAgICBpcCA9IG9yaWdpbmFsSHRtbFVwLmluZGV4T2YoJzxCT0RZJyk7XG4gIH1cbiAgaWYgKGlwID09IC0xKSB7XG4gICAgaXAgPSBvcmlnaW5hbEh0bWxVcC5pbmRleE9mKCc8SFRNTCcpO1xuICAgIGlmIChpcCAhPSAtMSkge1xuICAgICAgaXAgPSBvcmlnaW5hbEh0bWxVcC5pbmRleE9mKCc+JywgaXAgKyAxKSArIDE7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgcmVzdWx0ID0gW107XG5cbiAgLy8gUHJlYW1idWxlLlxuICBpZiAoaXAgPiAwKSB7XG4gICAgcmVzdWx0LnB1c2gob3JpZ2luYWxIdG1sLnN1YnN0cmluZygwLCBpcCkpO1xuICB9XG5cbiAgLy8gQWRkIDxCQVNFPiB0YWcuXG4gIHJlc3VsdC5wdXNoKGA8YmFzZSBocmVmPVwiJHtlc2NhcGVIdG1sKHNwZWMudXJsKX1cIj5gKTtcblxuICAvLyBMb2FkIGZvbnRzLlxuICBpZiAoc3BlYy5mb250cykge1xuICAgIHNwZWMuZm9udHMuZm9yRWFjaChmb250ID0+IHtcbiAgICAgIHJlc3VsdC5wdXNoKFxuICAgICAgICAgIGA8bGluayBocmVmPVwiJHtlc2NhcGVIdG1sKGZvbnQpfVwiIHJlbD1cInN0eWxlc2hlZXRcIiB0eXBlPVwidGV4dC9jc3NcIj5gKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIExvYWQgQ1NQXG4gIHJlc3VsdC5wdXNoKCc8bWV0YSBodHRwLWVxdWl2PUNvbnRlbnQtU2VjdXJpdHktUG9saWN5ICcgK1xuICAgICAgJ2NvbnRlbnQ9XCJzY3JpcHQtc3JjIFxcJ25vbmVcXCc7b2JqZWN0LXNyYyBcXCdub25lXFwnO2NoaWxkLXNyYyBcXCdub25lXFwnXCI+Jyk7XG5cbiAgLy8gUG9zdGFtYnVsZS5cbiAgaWYgKGlwID4gMCkge1xuICAgIHJlc3VsdC5wdXNoKG9yaWdpbmFsSHRtbC5zdWJzdHJpbmcoaXApKTtcbiAgfSBlbHNlIHtcbiAgICByZXN1bHQucHVzaChvcmlnaW5hbEh0bWwpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdC5qb2luKCcnKTtcbn1cblxuXG4vKipcbiAqIEV4cG9zZXMgYG1lcmdlSHRtbGAgZm9yIHRlc3RpbmcgcHVycG9zZXMuXG4gKiBAcGFyYW0geyFGcmllbmRseUlmcmFtZVNwZWN9IHNwZWNcbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gbWVyZ2VIdG1sRm9yVGVzdGluZyhzcGVjKSB7XG4gIHJldHVybiBtZXJnZUh0bWwoc3BlYyk7XG59XG5cblxuLyoqXG4gKiBBIFwiZnJpZW5kbHkgaWZyYW1lXCIgZW1iZWQuIFRoaXMgaXMgdGhlIGlmcmFtZSB0aGF0J3MgZnVsbHkgYWNjZXNzaWJsZSB0b1xuICogdGhlIEFNUCBydW50aW1lLiBJdCdzIHNpbWlsYXIgdG8gU2hhZG93IERPTSBpbiBtYW55IHJlc3BlY3RzLCBidXQgaXQgYWxzb1xuICogcHJvdmlkZXMgaWZyYW1lL3ZpZXdwb3J0IG1lYXN1cmVtZW50cyBhbmQgZW5hYmxlcyB0aGUgdXNlIG9mIGB2aGAsIGB2d2AgYW5kXG4gKiBgQG1lZGlhYCBDU1MuXG4gKlxuICogVGhlIGZyaWVuZGx5IGlmcmFtZSBpcyBtYW5hZ2VkIGJ5IHRoZSB0b3AtbGV2ZWwgQU1QIFJ1bnRpbWUuIFdoZW4gaXQnc1xuICogZGVzdHJveWVkLCB0aGUgYGRlc3Ryb3lgIG1ldGhvZCBtdXN0IGJlIGNhbGxlZCB0byBmcmVlIHVwIHRoZSBzaGFyZWRcbiAqIHJlc291cmNlcy5cbiAqL1xuZXhwb3J0IGNsYXNzIEZyaWVuZGx5SWZyYW1lRW1iZWQge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFIVE1MSUZyYW1lRWxlbWVudH0gaWZyYW1lXG4gICAqIEBwYXJhbSB7IUZyaWVuZGx5SWZyYW1lU3BlY30gc3BlY1xuICAgKiBAcGFyYW0geyFQcm9taXNlfSBsb2FkZWRQcm9taXNlXG4gICAqL1xuICBjb25zdHJ1Y3RvcihpZnJhbWUsIHNwZWMsIGxvYWRlZFByb21pc2UpIHtcbiAgICAvKiogQGNvbnN0IHshSFRNTElGcmFtZUVsZW1lbnR9ICovXG4gICAgdGhpcy5pZnJhbWUgPSBpZnJhbWU7XG5cbiAgICAvKiogQGNvbnN0IHshV2luZG93fSAqL1xuICAgIHRoaXMud2luID0gLyoqIEB0eXBleyFXaW5kb3d9ICovKGlmcmFtZS5jb250ZW50V2luZG93KTtcblxuICAgIC8qKiBAY29uc3QgeyFGcmllbmRseUlmcmFtZVNwZWN9ICovXG4gICAgdGhpcy5zcGVjID0gc3BlYztcblxuICAgIC8qKiBAY29uc3Qgez9BbXBFbGVtZW50fSAqL1xuICAgIHRoaXMuaG9zdCA9IHNwZWMuaG9zdCB8fCBudWxsO1xuXG4gICAgLyoqIEBjb25zdCBAcHJpdmF0ZSB7dGltZX0gKi9cbiAgICB0aGlzLnN0YXJ0VGltZV8gPSBEYXRlLm5vdygpO1xuXG4gICAgLyoqXG4gICAgICogU3RhcnRzIG91dCBhcyBpbnZpc2libGUuIFRoZSBpbnRlcnByZXRhdGlvbiBvZiB0aGlzIGZsYWcgaXMgdXAgdG9cbiAgICAgKiB0aGUgZW1kZWQgcGFyZW50LlxuICAgICAqIEBwcml2YXRlIHtib29sZWFufVxuICAgICAqL1xuICAgIHRoaXMudmlzaWJsZV8gPSBmYWxzZTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7IU9ic2VydmFibGU8Ym9vbGVhbj59ICovXG4gICAgdGhpcy52aXNpYmlsaXR5T2JzZXJ2YWJsZV8gPSBuZXcgT2JzZXJ2YWJsZSgpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCAqL1xuICAgIHRoaXMuc2lnbmFsc18gPSB0aGlzLmhvc3QgPyB0aGlzLmhvc3Quc2lnbmFscygpIDogbmV3IFNpZ25hbHMoKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFQcm9taXNlfSAqL1xuICAgIHRoaXMud2luTG9hZGVkUHJvbWlzZV8gPSBQcm9taXNlLmFsbChbbG9hZGVkUHJvbWlzZSwgdGhpcy53aGVuUmVhZHkoKV0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEVuc3VyZXMgdGhhdCBhbGwgcmVzb3VyY2VzIGZyb20gdGhpcyBpZnJhbWUgaGF2ZSBiZWVuIHJlbGVhc2VkLlxuICAgKi9cbiAgZGVzdHJveSgpIHtcbiAgICBTZXJ2aWNlcy5yZXNvdXJjZXNGb3JEb2ModGhpcy5pZnJhbWUpLnJlbW92ZUZvckNoaWxkV2luZG93KHRoaXMud2luKTtcbiAgICBkaXNwb3NlU2VydmljZXNGb3JFbWJlZCh0aGlzLndpbik7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7dGltZX1cbiAgICovXG4gIGdldFN0YXJ0VGltZSgpIHtcbiAgICByZXR1cm4gdGhpcy5zdGFydFRpbWVfO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGJhc2UgVVJMIGZvciB0aGUgZW1iZWRkZWQgZG9jdW1lbnQuXG4gICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICovXG4gIGdldFVybCgpIHtcbiAgICByZXR1cm4gdGhpcy5zcGVjLnVybDtcbiAgfVxuXG4gIC8qKiBAcmV0dXJuIHshU2lnbmFsc30gKi9cbiAgc2lnbmFscygpIHtcbiAgICByZXR1cm4gdGhpcy5zaWduYWxzXztcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB3aGVuIHRoZSBlbWJlZCBkb2N1bWVudCBpcyByZWFkeS5cbiAgICogTm90aWNlIHRoYXQgdGhpcyBzaWduYWwgY29pbmNpZGVzIHdpdGggdGhlIGVtYmVkJ3MgYHJlbmRlci1zdGFydGAuXG4gICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgKi9cbiAgd2hlblJlYWR5KCkge1xuICAgIHJldHVybiB0aGlzLnNpZ25hbHNfLndoZW5TaWduYWwoQ29tbW9uU2lnbmFscy5SRU5ERVJfU1RBUlQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHdoZW4gdGhlIGNoaWxkIHdpbmRvdydzIGBvbmxvYWRgIGV2ZW50XG4gICAqIGhhcyBiZWVuIGVtaXR0ZWQuIEluIGZyaWVuZGx5IGlmcmFtZXMgdGhpcyB0eXBpY2FsbHkgb25seSBpbmNsdWRlcyBmb250XG4gICAqIGxvYWRpbmcuXG4gICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgKi9cbiAgd2hlbldpbmRvd0xvYWRlZCgpIHtcbiAgICByZXR1cm4gdGhpcy53aW5Mb2FkZWRQcm9taXNlXztcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB3aGVuIHRoZSBpbml0aWFsIGxvYWQgIG9mIHRoZSBlbWJlZCdzXG4gICAqIGNvbnRlbnQgaGFzIGJlZW4gY29tcGxldGVkLlxuICAgKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAgICovXG4gIHdoZW5JbmlMb2FkZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuc2lnbmFsc18ud2hlblNpZ25hbChDb21tb25TaWduYWxzLklOSV9MT0FEKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcmVzdHJpY3RlZFxuICAgKi9cbiAgc3RhcnRSZW5kZXJfKCkge1xuICAgIGlmICh0aGlzLmhvc3QpIHtcbiAgICAgIHRoaXMuaG9zdC5yZW5kZXJTdGFydGVkKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2lnbmFsc18uc2lnbmFsKENvbW1vblNpZ25hbHMuUkVOREVSX1NUQVJUKTtcbiAgICB9XG4gICAgc2V0U3R5bGUodGhpcy5pZnJhbWUsICd2aXNpYmlsaXR5JywgJycpO1xuICAgIGlmICh0aGlzLndpbi5kb2N1bWVudCAmJiB0aGlzLndpbi5kb2N1bWVudC5ib2R5KSB7XG4gICAgICB0aGlzLndpbi5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaS1hbXBodG1sLWZpZScpO1xuICAgICAgc2V0U3R5bGVzKGRldigpLmFzc2VydEVsZW1lbnQodGhpcy53aW4uZG9jdW1lbnQuYm9keSksIHtcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgdmlzaWJpbGl0eTogJ3Zpc2libGUnLFxuICAgICAgICBhbmltYXRpb246ICdub25lJyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEluaXRpYWwgbG9hZCBzaWduYWwgc2lnbmFsLlxuICAgIGxldCByZWN0O1xuICAgIGlmICh0aGlzLmhvc3QpIHtcbiAgICAgIHJlY3QgPSB0aGlzLmhvc3QuZ2V0TGF5b3V0Qm94KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlY3QgPSBsYXlvdXRSZWN0THR3aChcbiAgICAgICAgICAwLCAwLFxuICAgICAgICAgIHRoaXMud2luLi8qT0sqL2lubmVyV2lkdGgsXG4gICAgICAgICAgdGhpcy53aW4uLypPSyovaW5uZXJIZWlnaHQpO1xuICAgIH1cbiAgICBQcm9taXNlLmFsbChbXG4gICAgICB0aGlzLndoZW5SZWFkeSgpLFxuICAgICAgd2hlbkNvbnRlbnRJbmlMb2FkKHRoaXMuaWZyYW1lLCB0aGlzLndpbiwgcmVjdCksXG4gICAgXSkudGhlbigoKSA9PiB7XG4gICAgICB0aGlzLnNpZ25hbHNfLnNpZ25hbChDb21tb25TaWduYWxzLklOSV9MT0FEKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBlbWJlZCBpcyBjdXJyZW50bHkgdmlzaWJsZS4gVGhlIGludGVycHJldGF0aW9uIG9mIHZpc2liaWxpdHlcbiAgICogaXMgdXAgdG8gdGhlIGVtYmVkIHBhcmVudC4gSG93ZXZlciwgbW9zdCBvZiB0eXBpY2FsIGNhc2VzIHdvdWxkIHJlbHkgb25cbiAgICogd2hldGhlciB0aGUgZW1iZWQgaXMgY3VycmVudGx5IGluIHRoZSB2aWV3cG9ydC5cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICogVE9ETyhkdm95dGVua28pOiBSZS1ldmFsdWF0ZSBhbmQgcHJvYmFibHkgZHJvcCBvbmNlIGxheWVycyBhcmUgcmVhZHkuXG4gICAqL1xuICBpc1Zpc2libGUoKSB7XG4gICAgcmV0dXJuIHRoaXMudmlzaWJsZV87XG4gIH1cblxuICAvKipcbiAgICogU2VlIGBpc1Zpc2libGVgIGZvciBtb3JlIGluZm8uXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oYm9vbGVhbil9IGhhbmRsZXJcbiAgICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICAgKi9cbiAgb25WaXNpYmlsaXR5Q2hhbmdlZChoYW5kbGVyKSB7XG4gICAgcmV0dXJuIHRoaXMudmlzaWJpbGl0eU9ic2VydmFibGVfLmFkZChoYW5kbGVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHZpc2libGVcbiAgICogQHByaXZhdGVcbiAgICogQHJlc3RyaWN0ZWRcbiAgICovXG4gIHNldFZpc2libGVfKHZpc2libGUpIHtcbiAgICBpZiAodGhpcy52aXNpYmxlXyAhPSB2aXNpYmxlKSB7XG4gICAgICB0aGlzLnZpc2libGVfID0gdmlzaWJsZTtcbiAgICAgIHRoaXMudmlzaWJpbGl0eU9ic2VydmFibGVfLmZpcmUodGhpcy52aXNpYmxlXyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFIVE1MQm9keUVsZW1lbnR9XG4gICAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICAgKi9cbiAgZ2V0Qm9keUVsZW1lbnQoKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IUhUTUxCb2R5RWxlbWVudH0gKi8gKFxuICAgICAgKHRoaXMuaWZyYW1lLmNvbnRlbnREb2N1bWVudCB8fCB0aGlzLmlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50KVxuICAgICAgICAgIC5ib2R5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3Jlc291cmNlcy1pbXBsLlJlc291cmNlc31cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdldFJlc291cmNlc18oKSB7XG4gICAgcmV0dXJuIFNlcnZpY2VzLnJlc291cmNlc0ZvckRvYyh0aGlzLmlmcmFtZSk7XG4gIH1cblxuICAvKipcbiAgICogUnVucyBhIG1lYXN1cmUvbXV0YXRlIGN5Y2xlIGVuc3VyaW5nIHRoYXQgdGhlIGlmcmFtZSBjaGFuZ2UgaXMgcHJvcGFnYXRlZFxuICAgKiB0byB0aGUgcmVzb3VyY2UgbWFuYWdlci5cbiAgICogQHBhcmFtIHt7bWVhc3VyZTogKGZ1bmN0aW9uKCl8dW5kZWZpbmVkKSwgbXV0YXRlOiBmdW5jdGlvbigpfX0gdGFza1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIG1lYXN1cmVNdXRhdGVfKHRhc2spIHtcbiAgICByZXR1cm4gdGhpcy5nZXRSZXNvdXJjZXNfKCkubWVhc3VyZU11dGF0ZUVsZW1lbnQodGhpcy5pZnJhbWUsXG4gICAgICAgIHRhc2subWVhc3VyZSB8fCBudWxsLCB0YXNrLm11dGF0ZSk7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAqL1xuICBlbnRlckZ1bGxPdmVybGF5TW9kZSgpIHtcbiAgICBjb25zdCBhbXBBZFBhcmVudCA9IGRldigpLmFzc2VydEVsZW1lbnQodGhpcy5pZnJhbWUucGFyZW50Tm9kZSk7XG5cbiAgICAvLyBTZWN1cml0eSBhc3NlcnRpb24uIE90aGVyd2lzZSBhbnkgM3AgZnJhbWUgY291bGQgcmVxdWVzdCBsaWdoYm94IG1vZGUuXG4gICAgdXNlcigpLmFzc2VydChhbXBBZFBhcmVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ2FtcC1hZCcsXG4gICAgICAgICdPbmx5IDxhbXAtYWQ+IGlzIGFsbG93ZWQgdG8gZW50ZXIgbGlnaHRib3ggbW9kZS4nKTtcblxuICAgIGNvbnN0IGJvZHlTdHlsZSA9IHtcbiAgICAgICdiYWNrZ3JvdW5kJzogJ3RyYW5zcGFyZW50JyxcbiAgICAgICdwb3NpdGlvbic6ICdhYnNvbHV0ZScsXG4gICAgICAnYm90dG9tJzogJ2F1dG8nLFxuICAgICAgJ3JpZ2h0JzogJ2F1dG8nLFxuXG4gICAgICAvLyBTZXQgZm9yIHJlcGxhY2luZyB3aXRoIHZzeW5jIHZhbHVlcy5cbiAgICAgICd0b3AnOiAnJyxcbiAgICAgICdsZWZ0JzogJycsXG4gICAgICAnd2lkdGgnOiAnJyxcbiAgICAgICdoZWlnaHQnOiAnJyxcbiAgICB9O1xuXG4gICAgY29uc3QgaWZyYW1lU3R5bGUgPSB7XG4gICAgICAncG9zaXRpb24nOiAnZml4ZWQnLFxuICAgICAgJ2xlZnQnOiAwLFxuICAgICAgJ3JpZ2h0JzogMCxcbiAgICAgICdib3R0b20nOiAwLFxuICAgICAgJ3dpZHRoJzogJzEwMHZ3JyxcbiAgICAgICd0b3AnOiAwLFxuICAgICAgJ2hlaWdodCc6ICcxMDB2aCcsXG4gICAgfTtcblxuICAgIHJldHVybiB0aGlzLm1lYXN1cmVNdXRhdGVfKHtcbiAgICAgIG1lYXN1cmU6ICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVjdCA9IHRoaXMuaG9zdCA/XG4gICAgICAgICAgdGhpcy5ob3N0LmdldExheW91dEJveCgpIDpcbiAgICAgICAgICB0aGlzLmlmcmFtZS4vKk9LKi9nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICAvLyBPZmZzZXQgYnkgc2Nyb2xsIHRvcCBhcyBpZnJhbWUgd2lsbCBiZSBwb3NpdGlvbjogZml4ZWQuXG4gICAgICAgIGNvbnN0IGR5ID0gLVNlcnZpY2VzLnZpZXdwb3J0Rm9yRG9jKHRoaXMuaWZyYW1lKS5nZXRTY3JvbGxUb3AoKTtcbiAgICAgICAgY29uc3Qge3RvcCwgbGVmdCwgd2lkdGgsIGhlaWdodH0gPSBtb3ZlTGF5b3V0UmVjdChyZWN0LCAvKiBkeCAqLyAwLCBkeSk7XG5cbiAgICAgICAgLy8gT2Zmc2V0IGJvZHkgYnkgaGVhZGVyIGhlaWdodCB0byBwcmV2ZW50IHZpc3VhbCBqdW1wLlxuICAgICAgICBPYmplY3QuYXNzaWduKGJvZHlTdHlsZSwge1xuICAgICAgICAgICd0b3AnOiBweCh0b3ApLFxuICAgICAgICAgICdsZWZ0JzogcHgobGVmdCksXG4gICAgICAgICAgJ3dpZHRoJzogcHgod2lkdGgpLFxuICAgICAgICAgICdoZWlnaHQnOiBweChoZWlnaHQpLFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBtdXRhdGU6ICgpID0+IHtcbiAgICAgICAgLy8gIWltcG9ydGFudCB0byBwcmV2ZW50IGFidXNlIGUuZy4gYm94IEAgbHR3aCA9IDAsIDAsIDAsIDBcbiAgICAgICAgc2V0SW1wb3J0YW50U3R5bGVzKHRoaXMuaWZyYW1lLCBpZnJhbWVTdHlsZSk7XG5cbiAgICAgICAgLy8gV2UgbmVlZCB0byBvdmVycmlkZSBydW50aW1lLWxldmVsICFpbXBvcnRhbnQgcnVsZXNcbiAgICAgICAgc2V0SW1wb3J0YW50U3R5bGVzKHRoaXMuZ2V0Qm9keUVsZW1lbnQoKSwgYm9keVN0eWxlKTtcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAqL1xuICBsZWF2ZUZ1bGxPdmVybGF5TW9kZSgpIHtcbiAgICByZXR1cm4gdGhpcy5tZWFzdXJlTXV0YXRlXyh7XG4gICAgICBtdXRhdGU6ICgpID0+IHtcbiAgICAgICAgcmVzZXRTdHlsZXModGhpcy5pZnJhbWUsIFtcbiAgICAgICAgICAncG9zaXRpb24nLFxuICAgICAgICAgICdsZWZ0JyxcbiAgICAgICAgICAncmlnaHQnLFxuICAgICAgICAgICd0b3AnLFxuICAgICAgICAgICdib3R0b20nLFxuICAgICAgICAgICd3aWR0aCcsXG4gICAgICAgICAgJ2hlaWdodCcsXG4gICAgICAgIF0pO1xuXG4gICAgICAgIC8vIHdlJ3JlIG5vdCByZXNldHRpbmcgYmFja2dyb3VuZCBoZXJlIGFzIHdlIG5lZWQgdG8gc2V0IGl0IHRvXG4gICAgICAgIC8vIHRyYW5zcGFyZW50IHBlcm1hbmVudGx5LlxuICAgICAgICByZXNldFN0eWxlcyh0aGlzLmdldEJvZHlFbGVtZW50KCksIFtcbiAgICAgICAgICAncG9zaXRpb24nLFxuICAgICAgICAgICd0b3AnLFxuICAgICAgICAgICdsZWZ0JyxcbiAgICAgICAgICAnd2lkdGgnLFxuICAgICAgICAgICdoZWlnaHQnLFxuICAgICAgICAgICdib3R0b20nLFxuICAgICAgICAgICdyaWdodCcsXG4gICAgICAgIF0pO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHByb21pc2UgdGhhdCB3aWxsIGJlIHJlc29sdmVkIHdoZW4gYWxsIGNvbnRlbnQgZWxlbWVudHNcbiAqIGhhdmUgYmVlbiBsb2FkZWQgaW4gdGhlIGluaXRpYWxseSB2aXNpYmxlIHNldC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHshV2luZG93fSBob3N0V2luXG4gKiBAcGFyYW0geyEuL2xheW91dC1yZWN0LkxheW91dFJlY3REZWZ9IHJlY3RcbiAqIEByZXR1cm4geyFQcm9taXNlfVxuICovXG5leHBvcnQgZnVuY3Rpb24gd2hlbkNvbnRlbnRJbmlMb2FkKGVsZW1lbnRPckFtcERvYywgaG9zdFdpbiwgcmVjdCkge1xuICByZXR1cm4gU2VydmljZXMucmVzb3VyY2VzRm9yRG9jKGVsZW1lbnRPckFtcERvYylcbiAgICAgIC5nZXRSZXNvdXJjZXNJblJlY3QoaG9zdFdpbiwgcmVjdClcbiAgICAgIC50aGVuKHJlc291cmNlcyA9PiB7XG4gICAgICAgIGNvbnN0IHByb21pc2VzID0gW107XG4gICAgICAgIHJlc291cmNlcy5mb3JFYWNoKHIgPT4ge1xuICAgICAgICAgIGlmICghRVhDTFVERV9JTklfTE9BRC5pbmNsdWRlcyhyLmVsZW1lbnQudGFnTmFtZSkpIHtcbiAgICAgICAgICAgIHByb21pc2VzLnB1c2goci5sb2FkZWRPbmNlKCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcyk7XG4gICAgICB9KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNJbkZpZShlbGVtZW50KSB7XG4gIHJldHVybiAhIWNsb3Nlc3RCeVNlbGVjdG9yKGVsZW1lbnQsICcuaS1hbXBodG1sLWZpZScpO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQge0RvbUZpbmdlcnByaW50fSBmcm9tICcuL3V0aWxzL2RvbS1maW5nZXJwcmludCc7XG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuL3NlcnZpY2VzJztcbmltcG9ydCB7ZGljdH0gZnJvbSAnLi91dGlscy9vYmplY3QuanMnO1xuaW1wb3J0IHtleHBlcmltZW50VG9nZ2xlcywgaXNDYW5hcnl9IGZyb20gJy4vZXhwZXJpbWVudHMnO1xuaW1wb3J0IHtnZXRMZW5ndGhOdW1lcmFsfSBmcm9tICcuL2xheW91dCc7XG5pbXBvcnQge2dldE1vZGVPYmplY3R9IGZyb20gJy4vbW9kZS1vYmplY3QnO1xuaW1wb3J0IHt1cmxzfSBmcm9tICcuL2NvbmZpZyc7XG5cbi8qKlxuICogUHJvZHVjZXMgdGhlIGF0dHJpYnV0ZXMgZm9yIHRoZSBhZCB0ZW1wbGF0ZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gcGFyZW50V2luZG93XG4gKiBAcGFyYW0geyFBbXBFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gc2VudGluZWxcbiAqIEBwYXJhbSB7IUpzb25PYmplY3Q9fSBhdHRyaWJ1dGVzXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvbnRleHRNZXRhZGF0YShcbiAgcGFyZW50V2luZG93LCBlbGVtZW50LCBzZW50aW5lbCwgYXR0cmlidXRlcykge1xuICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICBjb25zdCB3aWR0aCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd3aWR0aCcpO1xuICBjb25zdCBoZWlnaHQgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnaGVpZ2h0Jyk7XG4gIGF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzID8gYXR0cmlidXRlcyA6IGRpY3QoKTtcbiAgYXR0cmlidXRlc1snd2lkdGgnXSA9IGdldExlbmd0aE51bWVyYWwod2lkdGgpO1xuICBhdHRyaWJ1dGVzWydoZWlnaHQnXSA9IGdldExlbmd0aE51bWVyYWwoaGVpZ2h0KTtcbiAgaWYgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0aXRsZScpKSB7XG4gICAgYXR0cmlidXRlc1sndGl0bGUnXSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0aXRsZScpO1xuICB9XG4gIGxldCBsb2NhdGlvbkhyZWYgPSBwYXJlbnRXaW5kb3cubG9jYXRpb24uaHJlZjtcbiAgLy8gVGhpcyBpcyByZWFsbHkgb25seSBuZWVkZWQgZm9yIHRlc3RzLCBidXQgd2hhdGV2ZXIuIENoaWxkcmVuXG4gIC8vIHNlZSB1cyBhcyB0aGUgbG9naWNhbCBvcmlnaW4sIHNvIHRlbGxpbmcgdGhlbSB3ZSBhcmUgYWJvdXQ6c3JjZG9jXG4gIC8vIHdpbGwgZmFpbCBhbmNlc3RvciBjaGVja3MuXG4gIGlmIChsb2NhdGlvbkhyZWYgPT0gJ2Fib3V0OnNyY2RvYycpIHtcbiAgICBsb2NhdGlvbkhyZWYgPSBwYXJlbnRXaW5kb3cucGFyZW50LmxvY2F0aW9uLmhyZWY7XG4gIH1cblxuICBjb25zdCBkb2NJbmZvID0gU2VydmljZXMuZG9jdW1lbnRJbmZvRm9yRG9jKGVsZW1lbnQpO1xuICBjb25zdCB2aWV3ZXIgPSBTZXJ2aWNlcy52aWV3ZXJGb3JEb2MoZWxlbWVudCk7XG4gIGNvbnN0IHJlZmVycmVyID0gdmlld2VyLmdldFVuY29uZmlybWVkUmVmZXJyZXJVcmwoKTtcblxuICAvLyBUT0RPKGFsYW5vcm96Y28pOiBSZWRlc2lnbiBkYXRhIHN0cnVjdHVyZSBzbyB0aGF0IGZpZWxkcyBub3QgZXhwb3NlZCBieVxuICAvLyBBbXBDb250ZXh0IGFyZSBub3QgcGFydCBvZiB0aGlzIG9iamVjdC5cbiAgY29uc3QgbGF5b3V0UmVjdCA9IGVsZW1lbnQuZ2V0UGFnZUxheW91dEJveCgpO1xuICBhdHRyaWJ1dGVzWydfY29udGV4dCddID0gZGljdCh7XG4gICAgJ2FtcGNvbnRleHRWZXJzaW9uJzogJyRpbnRlcm5hbFJ1bnRpbWVWZXJzaW9uJCcsXG4gICAgJ2FtcGNvbnRleHRGaWxlcGF0aCc6IHVybHMudGhpcmRQYXJ0eSArICcvJGludGVybmFsUnVudGltZVZlcnNpb24kJyArXG4gICAgICAgICcvYW1wY29udGV4dC12MC5qcycsXG4gICAgJ3NvdXJjZVVybCc6IGRvY0luZm8uc291cmNlVXJsLFxuICAgICdyZWZlcnJlcic6IHJlZmVycmVyLFxuICAgICdjYW5vbmljYWxVcmwnOiBkb2NJbmZvLmNhbm9uaWNhbFVybCxcbiAgICAncGFnZVZpZXdJZCc6IGRvY0luZm8ucGFnZVZpZXdJZCxcbiAgICAnbG9jYXRpb24nOiB7XG4gICAgICAnaHJlZic6IGxvY2F0aW9uSHJlZixcbiAgICB9LFxuICAgICdzdGFydFRpbWUnOiBzdGFydFRpbWUsXG4gICAgJ3RhZ05hbWUnOiBlbGVtZW50LnRhZ05hbWUsXG4gICAgJ21vZGUnOiBnZXRNb2RlT2JqZWN0KCksXG4gICAgJ2NhbmFyeSc6IGlzQ2FuYXJ5KHBhcmVudFdpbmRvdyksXG4gICAgJ2hpZGRlbic6ICF2aWV3ZXIuaXNWaXNpYmxlKCksXG4gICAgJ2luaXRpYWxMYXlvdXRSZWN0JzogbGF5b3V0UmVjdCA/IHtcbiAgICAgICdsZWZ0JzogbGF5b3V0UmVjdC5sZWZ0LFxuICAgICAgJ3RvcCc6IGxheW91dFJlY3QudG9wLFxuICAgICAgJ3dpZHRoJzogbGF5b3V0UmVjdC53aWR0aCxcbiAgICAgICdoZWlnaHQnOiBsYXlvdXRSZWN0LmhlaWdodCxcbiAgICB9IDogbnVsbCxcbiAgICAnaW5pdGlhbEludGVyc2VjdGlvbic6IGVsZW1lbnQuZ2V0SW50ZXJzZWN0aW9uQ2hhbmdlRW50cnkoKSxcbiAgICAnZG9tRmluZ2VycHJpbnQnOiBEb21GaW5nZXJwcmludC5nZW5lcmF0ZShlbGVtZW50KSxcbiAgICAnZXhwZXJpbWVudFRvZ2dsZXMnOiBleHBlcmltZW50VG9nZ2xlcyhwYXJlbnRXaW5kb3cpLFxuICAgICdzZW50aW5lbCc6IHNlbnRpbmVsLFxuICB9KTtcbiAgY29uc3QgYWRTcmMgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnc3JjJyk7XG4gIGlmIChhZFNyYykge1xuICAgIGF0dHJpYnV0ZXNbJ3NyYyddID0gYWRTcmM7XG4gIH1cbiAgcmV0dXJuIGF0dHJpYnV0ZXM7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHthZGRBdHRyaWJ1dGVzVG9FbGVtZW50LCBjbG9zZXN0QnlTZWxlY3Rvcn0gZnJvbSAnLi9kb20nO1xuaW1wb3J0IHtkZXNlcmlhbGl6ZU1lc3NhZ2UsIGlzQW1wTWVzc2FnZX0gZnJvbSAnLi8zcC1mcmFtZS1tZXNzYWdpbmcnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7ZGljdH0gZnJvbSAnLi91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtmaWx0ZXJTcGxpY2V9IGZyb20gJy4vdXRpbHMvYXJyYXknO1xuaW1wb3J0IHtnZXREYXRhfSBmcm9tICcuL2V2ZW50LWhlbHBlcic7XG5pbXBvcnQge3BhcnNlVXJsRGVwcmVjYXRlZH0gZnJvbSAnLi91cmwnO1xuaW1wb3J0IHtzZXRTdHlsZX0gZnJvbSAnLi9zdHlsZSc7XG5pbXBvcnQge3RyeVBhcnNlSnNvbn0gZnJvbSAnLi9qc29uJztcblxuLyoqXG4gKiBTZW50aW5lbCB1c2VkIHRvIGZvcmNlIHVubGlzdGVuaW5nIGFmdGVyIGEgaWZyYW1lIGlzIGRldGFjaGVkLlxuICogQHR5cGUge3N0cmluZ31cbiAqL1xuY29uc3QgVU5MSVNURU5fU0VOVElORUwgPSAndW5saXN0ZW4nO1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGZyYW1lOiAhRWxlbWVudCxcbiAqICAgZXZlbnRzOiAhT2JqZWN0PHN0cmluZywgIUFycmF5PGZ1bmN0aW9uKCFKc29uT2JqZWN0KT4+XG4gKiB9fVxuICovXG5sZXQgV2luZG93RXZlbnRzRGVmO1xuXG4vKipcbiAqIFJldHVybnMgYSBtYXBwaW5nIGZyb20gYSBVUkwncyBvcmlnaW4gdG8gYW4gYXJyYXkgb2Ygd2luZG93cyBhbmQgdGhlaXJcbiAqIGxpc3RlbkZvciBsaXN0ZW5lcnMuXG4gKiBAcGFyYW0gez9XaW5kb3d9IHBhcmVudFdpbiB0aGUgd2luZG93IHRoYXQgY3JlYXRlZCB0aGUgaWZyYW1lXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfY3JlYXRlIGNyZWF0ZSB0aGUgbWFwcGluZyBpZiBpdCBkb2VzIG5vdCBleGlzdFxuICogQHJldHVybiB7P09iamVjdDxzdHJpbmcsICFBcnJheTwhV2luZG93RXZlbnRzRGVmPj59XG4gKi9cbmZ1bmN0aW9uIGdldExpc3RlbkZvcnMocGFyZW50V2luLCBvcHRfY3JlYXRlKSB7XG4gIGxldCB7bGlzdGVuaW5nRm9yc30gPSBwYXJlbnRXaW47XG5cbiAgaWYgKCFsaXN0ZW5pbmdGb3JzICYmIG9wdF9jcmVhdGUpIHtcbiAgICBsaXN0ZW5pbmdGb3JzID0gcGFyZW50V2luLmxpc3RlbmluZ0ZvcnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICB9XG4gIHJldHVybiBsaXN0ZW5pbmdGb3JzIHx8IG51bGw7XG59XG5cbi8qKlxuICogUmV0dXJucyBhbiBhcnJheSBvZiBXaW5kb3dFdmVudHNEZWYgdGhhdCBoYXZlIGhhZCBhbnkgbGlzdGVuRm9yIGxpc3RlbmVyc1xuICogcmVnaXN0ZXJlZCBmb3IgdGhpcyBzZW50aW5lbC5cbiAqIEBwYXJhbSB7P1dpbmRvd30gcGFyZW50V2luIHRoZSB3aW5kb3cgdGhhdCBjcmVhdGVkIHRoZSBpZnJhbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSBzZW50aW5lbCB0aGUgc2VudGluZWwgb2YgdGhlIG1lc3NhZ2VcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9jcmVhdGUgY3JlYXRlIHRoZSBhcnJheSBpZiBpdCBkb2VzIG5vdCBleGlzdFxuICogQHJldHVybiB7P0FycmF5PCFXaW5kb3dFdmVudHNEZWY+fVxuICovXG5mdW5jdGlvbiBnZXRMaXN0ZW5Gb3JTZW50aW5lbChwYXJlbnRXaW4sIHNlbnRpbmVsLCBvcHRfY3JlYXRlKSB7XG4gIGNvbnN0IGxpc3RlbmluZ0ZvcnMgPSBnZXRMaXN0ZW5Gb3JzKHBhcmVudFdpbiwgb3B0X2NyZWF0ZSk7XG4gIGlmICghbGlzdGVuaW5nRm9ycykge1xuICAgIHJldHVybiBsaXN0ZW5pbmdGb3JzO1xuICB9XG5cbiAgbGV0IGxpc3RlblNlbnRpbmVsID0gbGlzdGVuaW5nRm9yc1tzZW50aW5lbF07XG4gIGlmICghbGlzdGVuU2VudGluZWwgJiYgb3B0X2NyZWF0ZSkge1xuICAgIGxpc3RlblNlbnRpbmVsID0gbGlzdGVuaW5nRm9yc1tzZW50aW5lbF0gPSBbXTtcbiAgfVxuICByZXR1cm4gbGlzdGVuU2VudGluZWwgfHwgbnVsbDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFuIG1hcHBpbmcgb2YgZXZlbnQgbmFtZXMgdG8gbGlzdGVuRm9yIGxpc3RlbmVycy5cbiAqIEBwYXJhbSB7P1dpbmRvd30gcGFyZW50V2luIHRoZSB3aW5kb3cgdGhhdCBjcmVhdGVkIHRoZSBpZnJhbWVcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGlmcmFtZSB0aGUgaWZyYW1lIGVsZW1lbnQgd2hvJ3MgY29udGV4dCB3aWxsIHRyaWdnZXIgdGhlXG4gKiAgICAgZXZlbnRcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pczNQIHNldCB0byB0cnVlIGlmIHRoZSBpZnJhbWUgaXMgM3AuXG4gKiBAcmV0dXJuIHs/T2JqZWN0PHN0cmluZywgIUFycmF5PGZ1bmN0aW9uKCFKc29uT2JqZWN0LCAhV2luZG93LCBzdHJpbmcpPj59XG4gKi9cbmZ1bmN0aW9uIGdldE9yQ3JlYXRlTGlzdGVuRm9yRXZlbnRzKHBhcmVudFdpbiwgaWZyYW1lLCBvcHRfaXMzUCkge1xuICBjb25zdCB7b3JpZ2lufSA9IHBhcnNlVXJsRGVwcmVjYXRlZChpZnJhbWUuc3JjKTtcbiAgY29uc3Qgc2VudGluZWwgPSBnZXRTZW50aW5lbF8oaWZyYW1lLCBvcHRfaXMzUCk7XG4gIGNvbnN0IGxpc3RlblNlbnRpbmVsID0gZ2V0TGlzdGVuRm9yU2VudGluZWwocGFyZW50V2luLCBzZW50aW5lbCwgdHJ1ZSk7XG5cbiAgbGV0IHdpbmRvd0V2ZW50cztcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0ZW5TZW50aW5lbC5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHdlID0gbGlzdGVuU2VudGluZWxbaV07XG4gICAgaWYgKHdlLmZyYW1lID09PSBpZnJhbWUpIHtcbiAgICAgIHdpbmRvd0V2ZW50cyA9IHdlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgaWYgKCF3aW5kb3dFdmVudHMpIHtcbiAgICB3aW5kb3dFdmVudHMgPSB7XG4gICAgICBmcmFtZTogaWZyYW1lLFxuICAgICAgb3JpZ2luLFxuICAgICAgZXZlbnRzOiBPYmplY3QuY3JlYXRlKG51bGwpLFxuICAgIH07XG4gICAgbGlzdGVuU2VudGluZWwucHVzaCh3aW5kb3dFdmVudHMpO1xuICB9XG5cbiAgcmV0dXJuIHdpbmRvd0V2ZW50cy5ldmVudHM7XG59XG5cbi8qKlxuICogUmV0dXJucyBhbiBtYXBwaW5nIG9mIGV2ZW50IG5hbWVzIHRvIGxpc3RlbkZvciBsaXN0ZW5lcnMuXG4gKiBAcGFyYW0gez9XaW5kb3d9IHBhcmVudFdpbiB0aGUgd2luZG93IHRoYXQgY3JlYXRlZCB0aGUgaWZyYW1lXG4gKiBAcGFyYW0ge3N0cmluZ30gc2VudGluZWwgdGhlIHNlbnRpbmVsIG9mIHRoZSBtZXNzYWdlXG4gKiBAcGFyYW0ge3N0cmluZ30gb3JpZ2luIHRoZSBzb3VyY2Ugd2luZG93J3Mgb3JpZ2luXG4gKiBAcGFyYW0gez9XaW5kb3d9IHRyaWdnZXJXaW4gdGhlIHdpbmRvdyB0aGF0IHRyaWdnZXJlZCB0aGUgZXZlbnRcbiAqIEByZXR1cm4gez9PYmplY3Q8c3RyaW5nLCAhQXJyYXk8ZnVuY3Rpb24oIUpzb25PYmplY3QsICFXaW5kb3csIHN0cmluZyk+Pn1cbiAqL1xuZnVuY3Rpb24gZ2V0TGlzdGVuRm9yRXZlbnRzKHBhcmVudFdpbiwgc2VudGluZWwsIG9yaWdpbiwgdHJpZ2dlcldpbikge1xuICBjb25zdCBsaXN0ZW5TZW50aW5lbCA9IGdldExpc3RlbkZvclNlbnRpbmVsKHBhcmVudFdpbiwgc2VudGluZWwpO1xuXG4gIGlmICghbGlzdGVuU2VudGluZWwpIHtcbiAgICByZXR1cm4gbGlzdGVuU2VudGluZWw7XG4gIH1cblxuICAvLyBGaW5kIHRoZSBlbnRyeSBmb3IgdGhlIGZyYW1lLlxuICAvLyBUT0RPKEBuZWtvZG8pOiBBZGQgYSBXZWFrTWFwPFdpbmRvdywgV2luZG93RXZlbnRzRGVmPiBjYWNoZSB0b1xuICAvLyAgICAgc3BlZWQgdXAgdGhpcyBwcm9jZXNzLlxuICBsZXQgd2luZG93RXZlbnRzO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3RlblNlbnRpbmVsLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qgd2UgPSBsaXN0ZW5TZW50aW5lbFtpXTtcbiAgICBjb25zdCB7Y29udGVudFdpbmRvd30gPSB3ZS5mcmFtZTtcbiAgICBpZiAoIWNvbnRlbnRXaW5kb3cpIHtcbiAgICAgIHNldFRpbWVvdXQoZHJvcExpc3RlblNlbnRpbmVsLCAwLCBsaXN0ZW5TZW50aW5lbCk7XG4gICAgfSBlbHNlIGlmIChzZW50aW5lbCA9PT0gJ2FtcCcpIHtcbiAgICAgIC8vIEEgbm9uLTNQIGNvZGUgcGF0aCwgb3JpZ2luIG11c3QgbWF0Y2guXG4gICAgICBpZiAod2Uub3JpZ2luID09PSBvcmlnaW4gJiYgY29udGVudFdpbmRvdyA9PSB0cmlnZ2VyV2luKSB7XG4gICAgICAgIHdpbmRvd0V2ZW50cyA9IHdlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHRyaWdnZXJXaW4gPT0gY29udGVudFdpbmRvdyB8fFxuICAgICAgICBpc0Rlc2NlbmRhbnRXaW5kb3coY29udGVudFdpbmRvdywgdHJpZ2dlcldpbikpIHtcbiAgICAgIC8vIDNwIGNvZGUgcGF0aCwgd2UgbWF5IGFjY2VwdCBtZXNzYWdlcyBmcm9tIG5lc3RlZCBmcmFtZXMuXG4gICAgICB3aW5kb3dFdmVudHMgPSB3ZTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB3aW5kb3dFdmVudHMgPyB3aW5kb3dFdmVudHMuZXZlbnRzIDogbnVsbDtcbn1cblxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciBvbmUgd2luZG93IGlzIGEgZGVzY2VuZGFudCBvZiBhbm90aGVyIGJ5IGNsaW1iaW5nXG4gKiB0aGUgcGFyZW50IGNoYWluLlxuICogQHBhcmFtIHs/V2luZG93fSBhbmNlc3RvciBwb3RlbnRpYWwgYW5jZXN0b3Igd2luZG93XG4gKiBAcGFyYW0gez9XaW5kb3d9IGRlc2NlbmRhbnQgcG90ZW50aWFsIGRlc2NlbmRhbnQgd2luZG93XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc0Rlc2NlbmRhbnRXaW5kb3coYW5jZXN0b3IsIGRlc2NlbmRhbnQpIHtcbiAgZm9yIChsZXQgd2luID0gZGVzY2VuZGFudDsgd2luICYmIHdpbiAhPSB3aW4ucGFyZW50OyB3aW4gPSB3aW4ucGFyZW50KSB7XG4gICAgaWYgKHdpbiA9PSBhbmNlc3Rvcikge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBSZW1vdmVzIGFueSBsaXN0ZW5Gb3JzIHJlZ2lzdGVkIG9uIGxpc3RlblNlbnRpbmVsIHRoYXQgZG8gbm90IGhhdmVcbiAqIGEgY29udGVudFdpbmRvdyAodGhlIGZyYW1lIHdhcyByZW1vdmVkIGZyb20gdGhlIERPTSB0cmVlKS5cbiAqIEBwYXJhbSB7IUFycmF5PCFXaW5kb3dFdmVudHNEZWY+fSBsaXN0ZW5TZW50aW5lbFxuICovXG5mdW5jdGlvbiBkcm9wTGlzdGVuU2VudGluZWwobGlzdGVuU2VudGluZWwpIHtcbiAgY29uc3Qgbm9vcERhdGEgPSBkaWN0KHsnc2VudGluZWwnOiBVTkxJU1RFTl9TRU5USU5FTH0pO1xuXG4gIGZvciAobGV0IGkgPSBsaXN0ZW5TZW50aW5lbC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgIGNvbnN0IHdpbmRvd0V2ZW50cyA9IGxpc3RlblNlbnRpbmVsW2ldO1xuXG4gICAgaWYgKCF3aW5kb3dFdmVudHMuZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgbGlzdGVuU2VudGluZWwuc3BsaWNlKGksIDEpO1xuXG4gICAgICBjb25zdCB7ZXZlbnRzfSA9IHdpbmRvd0V2ZW50cztcbiAgICAgIGZvciAoY29uc3QgbmFtZSBpbiBldmVudHMpIHtcbiAgICAgICAgLy8gU3BsaWNlIGhlcmUsIHNvIHRoYXQgZWFjaCB1bmxpc3RlbiBkb2VzIG5vdCBzaGlmdCB0aGUgYXJyYXlcbiAgICAgICAgZXZlbnRzW25hbWVdLnNwbGljZSgwLCBJbmZpbml0eSkuZm9yRWFjaChldmVudCA9PiB7XG4gICAgICAgICAgZXZlbnQobm9vcERhdGEpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBSZWdpc3RlcnMgdGhlIGdsb2JhbCBsaXN0ZW5Gb3IgZXZlbnQgbGlzdGVuZXIgaWYgaXQgaGFzIHlldCB0byBiZS5cbiAqIEBwYXJhbSB7P1dpbmRvd30gcGFyZW50V2luXG4gKi9cbmZ1bmN0aW9uIHJlZ2lzdGVyR2xvYmFsTGlzdGVuZXJJZk5lZWRlZChwYXJlbnRXaW4pIHtcbiAgaWYgKHBhcmVudFdpbi5saXN0ZW5pbmdGb3JzKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGxpc3RlbkZvckxpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoIWdldERhdGEoZXZlbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGRhdGEgPSBwYXJzZUlmTmVlZGVkKGdldERhdGEoZXZlbnQpKTtcbiAgICBpZiAoIWRhdGEgfHwgIWRhdGFbJ3NlbnRpbmVsJ10pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBsaXN0ZW5Gb3JFdmVudHMgPSBnZXRMaXN0ZW5Gb3JFdmVudHMoXG4gICAgICAgIHBhcmVudFdpbixcbiAgICAgICAgZGF0YVsnc2VudGluZWwnXSxcbiAgICAgICAgZXZlbnQub3JpZ2luLFxuICAgICAgICBldmVudC5zb3VyY2VcbiAgICApO1xuICAgIGlmICghbGlzdGVuRm9yRXZlbnRzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IGxpc3RlbmVycyA9IGxpc3RlbkZvckV2ZW50c1tkYXRhWyd0eXBlJ11dO1xuICAgIGlmICghbGlzdGVuZXJzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gV2Ugc2xpY2UgdG8gYXZvaWQgaXNzdWVzIHdpdGggYWRkaW5nIGFub3RoZXIgbGlzdGVuZXIgb3IgdW5saXN0ZW5pbmdcbiAgICAvLyBkdXJpbmcgaXRlcmF0aW9uLiBXZSBjb3VsZCBtb3ZlIHRvIGEgRG91Ymx5IExpbmtlZCBMaXN0IHdpdGhcbiAgICAvLyBiYWNrdHJhY2tpbmcsIGJ1dCB0aGF0J3Mgb3Zlcmx5IGNvbXBsaWNhdGVkLlxuICAgIGxpc3RlbmVycyA9IGxpc3RlbmVycy5zbGljZSgpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBsaXN0ZW5lciA9IGxpc3RlbmVyc1tpXTtcbiAgICAgIGxpc3RlbmVyKGRhdGEsIGV2ZW50LnNvdXJjZSwgZXZlbnQub3JpZ2luKTtcbiAgICB9XG4gIH07XG5cbiAgcGFyZW50V2luLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBsaXN0ZW5Gb3JMaXN0ZW5lcik7XG59XG5cbi8qKlxuICogQWxsb3dzIGxpc3RlbmluZyBmb3IgbWVzc2FnZSBmcm9tIHRoZSBpZnJhbWUuIFJldHVybnMgYW4gdW5saXN0ZW5cbiAqIGZ1bmN0aW9uIHRvIHJlbW92ZSB0aGUgbGlzdGVuZXIuXG4gKlxuICogQHBhcmFtIHs/RWxlbWVudH0gaWZyYW1lXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZU9mTWVzc2FnZVxuICogQHBhcmFtIHs/ZnVuY3Rpb24oIUpzb25PYmplY3QsICFXaW5kb3csIHN0cmluZyl9IGNhbGxiYWNrIENhbGxlZCB3aGVuIGFcbiAqICAgICBtZXNzYWdlIG9mIHRoaXMgdHlwZSBhcnJpdmVzIGZvciB0aGlzIGlmcmFtZS5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pczNQIHNldCB0byB0cnVlIGlmIHRoZSBpZnJhbWUgaXMgM3AuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfaW5jbHVkaW5nTmVzdGVkV2luZG93cyBzZXQgdG8gdHJ1ZSBpZiBhIG1lc3NhZ2VzIGZyb21cbiAqICAgICBuZXN0ZWQgZnJhbWVzIHNob3VsZCBhbHNvIGJlIGFjY2VwdGVkLlxuICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGlzdGVuRm9yKFxuICBpZnJhbWUsIHR5cGVPZk1lc3NhZ2UsIGNhbGxiYWNrLCBvcHRfaXMzUCwgb3B0X2luY2x1ZGluZ05lc3RlZFdpbmRvd3MpIHtcbiAgZGV2KCkuYXNzZXJ0KGlmcmFtZS5zcmMsICdvbmx5IGlmcmFtZXMgd2l0aCBzcmMgc3VwcG9ydGVkJyk7XG4gIGRldigpLmFzc2VydCghaWZyYW1lLnBhcmVudE5vZGUsICdjYW5ub3QgcmVnaXN0ZXIgZXZlbnRzIG9uIGFuIGF0dGFjaGVkICcgK1xuICAgICAgJ2lmcmFtZS4gSXQgd2lsbCBjYXVzZSBoYWlyLXB1bGxpbmcgYnVncyBsaWtlICMyOTQyJyk7XG4gIGRldigpLmFzc2VydChjYWxsYmFjayk7XG4gIGNvbnN0IHBhcmVudFdpbiA9IGlmcmFtZS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3O1xuXG4gIHJlZ2lzdGVyR2xvYmFsTGlzdGVuZXJJZk5lZWRlZChwYXJlbnRXaW4pO1xuXG4gIGNvbnN0IGxpc3RlbkZvckV2ZW50cyA9IGdldE9yQ3JlYXRlTGlzdGVuRm9yRXZlbnRzKFxuICAgICAgcGFyZW50V2luLFxuICAgICAgaWZyYW1lLFxuICAgICAgb3B0X2lzM1BcbiAgKTtcblxuXG4gIGxldCBldmVudHMgPSBsaXN0ZW5Gb3JFdmVudHNbdHlwZU9mTWVzc2FnZV0gfHxcbiAgICAobGlzdGVuRm9yRXZlbnRzW3R5cGVPZk1lc3NhZ2VdID0gW10pO1xuXG4gIGxldCB1bmxpc3RlbjtcbiAgbGV0IGxpc3RlbmVyID0gZnVuY3Rpb24oZGF0YSwgc291cmNlLCBvcmlnaW4pIHtcbiAgICAvLyBFeGNsdWRlIG5lc3RlZCBmcmFtZXMgaWYgbmVjZXNzYXJ5LlxuICAgIC8vIE5vdGUgdGhhdCB0aGUgc291cmNlIHdhcyBhbHJlYWR5IHZlcmlmaWVkIHRvIGJlIGVpdGhlciB0aGUgY29udGVudFdpbmRvd1xuICAgIC8vIG9mIHRoZSBpZnJhbWUgaXRzZWxmIG9yIGEgZGVzY2VuZGFudCB3aW5kb3cgd2l0aGluIGl0LlxuICAgIGlmICghb3B0X2luY2x1ZGluZ05lc3RlZFdpbmRvd3MgJiYgc291cmNlICE9IGlmcmFtZS5jb250ZW50V2luZG93KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGRhdGEuc2VudGluZWwgPT0gVU5MSVNURU5fU0VOVElORUwpIHtcbiAgICAgIHVubGlzdGVuKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNhbGxiYWNrKGRhdGEsIHNvdXJjZSwgb3JpZ2luKTtcbiAgfTtcblxuICBldmVudHMucHVzaChsaXN0ZW5lcik7XG5cbiAgcmV0dXJuIHVubGlzdGVuID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKGxpc3RlbmVyKSB7XG4gICAgICBjb25zdCBpbmRleCA9IGV2ZW50cy5pbmRleE9mKGxpc3RlbmVyKTtcbiAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgIGV2ZW50cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfVxuICAgICAgLy8gTWFrZSBzdXJlIHJlZmVyZW5jZXMgdG8gdGhlIHVubGlzdGVuIGZ1bmN0aW9uIGRvIG5vdCBrZWVwXG4gICAgICAvLyBhbGl2ZSB0b28gbXVjaC5cbiAgICAgIGxpc3RlbmVyID0gbnVsbDtcbiAgICAgIGV2ZW50cyA9IG51bGw7XG4gICAgICBjYWxsYmFjayA9IG51bGw7XG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2hlbiBvbmUgb2YgZ2l2ZW4gbWVzc2FnZXMgaGFzIGJlZW4gb2JzZXJ2ZWRcbiAqIGZvciB0aGUgZmlyc3QgdGltZS4gQW5kIHJlbW92ZSBsaXN0ZW5lciBmb3IgYWxsIG90aGVyIG1lc3NhZ2VzLlxuICogQHBhcmFtIHshRWxlbWVudH0gaWZyYW1lXG4gKiBAcGFyYW0ge3N0cmluZ3whQXJyYXk8c3RyaW5nPn0gdHlwZU9mTWVzc2FnZXNcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pczNQXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhe2RhdGE6ICFKc29uT2JqZWN0LCBzb3VyY2U6ICFXaW5kb3csIG9yaWdpbjogc3RyaW5nfT59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW5Gb3JPbmNlUHJvbWlzZShpZnJhbWUsIHR5cGVPZk1lc3NhZ2VzLCBvcHRfaXMzUCkge1xuICBjb25zdCB1bmxpc3Rlbkxpc3QgPSBbXTtcbiAgaWYgKHR5cGVvZiB0eXBlT2ZNZXNzYWdlcyA9PSAnc3RyaW5nJykge1xuICAgIHR5cGVPZk1lc3NhZ2VzID0gW3R5cGVPZk1lc3NhZ2VzXTtcbiAgfVxuICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0eXBlT2ZNZXNzYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IHR5cGVPZk1lc3NhZ2VzW2ldO1xuICAgICAgY29uc3QgdW5saXN0ZW4gPSBsaXN0ZW5Gb3IoaWZyYW1lLCBtZXNzYWdlLCAoZGF0YSwgc291cmNlLCBvcmlnaW4pID0+IHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB1bmxpc3Rlbkxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB1bmxpc3Rlbkxpc3RbaV0oKTtcbiAgICAgICAgfVxuICAgICAgICByZXNvbHZlKHtkYXRhLCBzb3VyY2UsIG9yaWdpbn0pO1xuICAgICAgfSwgb3B0X2lzM1ApO1xuICAgICAgdW5saXN0ZW5MaXN0LnB1c2godW5saXN0ZW4pO1xuICAgIH1cbiAgfSk7XG59XG5cbi8qKlxuICogUG9zdHMgYSBtZXNzYWdlIHRvIHRoZSBpZnJhbWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBpZnJhbWUgVGhlIGlmcmFtZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIFR5cGUgb2YgdGhlIG1lc3NhZ2UuXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0fSBvYmplY3QgTWVzc2FnZSBwYXlsb2FkLlxuICogQHBhcmFtIHtzdHJpbmd9IHRhcmdldE9yaWdpbiBvcmlnaW4gb2YgdGhlIHRhcmdldC5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pczNQIHNldCB0byB0cnVlIGlmIHRoZSBpZnJhbWUgaXMgM3AuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwb3N0TWVzc2FnZShpZnJhbWUsIHR5cGUsIG9iamVjdCwgdGFyZ2V0T3JpZ2luLCBvcHRfaXMzUCkge1xuICBwb3N0TWVzc2FnZVRvV2luZG93cyhpZnJhbWUsXG4gICAgICBbe3dpbjogaWZyYW1lLmNvbnRlbnRXaW5kb3csIG9yaWdpbjogdGFyZ2V0T3JpZ2lufV0sIHR5cGUsIG9iamVjdCxcbiAgICAgIG9wdF9pczNQKTtcbn1cblxuLyoqXG4gKiBQb3N0cyBhbiBpZGVudGljYWwgbWVzc2FnZSB0byBtdWx0aXBsZSB0YXJnZXQgd2luZG93cyB3aXRoIHRoZSBzYW1lXG4gKiBzZW50aW5lbC5cbiAqIFRoZSBtZXNzYWdlIGlzIHNlcmlhbGl6ZWQgb25seSBvbmNlLlxuICogQHBhcmFtIHshRWxlbWVudH0gaWZyYW1lIFRoZSBpZnJhbWUuXG4gKiBAcGFyYW0geyFBcnJheTx7d2luOiAhV2luZG93LCBvcmlnaW46IHN0cmluZ30+fSB0YXJnZXRzIHRvIHNlbmQgdGhlIG1lc3NhZ2VcbiAqICAgICB0bywgcGFpcnMgb2Ygd2luZG93IGFuZCBpdHMgb3JpZ2luLlxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgVHlwZSBvZiB0aGUgbWVzc2FnZS5cbiAqIEBwYXJhbSB7IUpzb25PYmplY3R9IG9iamVjdCBNZXNzYWdlIHBheWxvYWQuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfaXMzUCBzZXQgdG8gdHJ1ZSBpZiB0aGUgaWZyYW1lIGlzIDNwLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcG9zdE1lc3NhZ2VUb1dpbmRvd3MoaWZyYW1lLCB0YXJnZXRzLCB0eXBlLCBvYmplY3QsIG9wdF9pczNQKSB7XG4gIGlmICghaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgb2JqZWN0Wyd0eXBlJ10gPSB0eXBlO1xuICBvYmplY3RbJ3NlbnRpbmVsJ10gPSBnZXRTZW50aW5lbF8oaWZyYW1lLCBvcHRfaXMzUCk7XG4gIGxldCBwYXlsb2FkID0gb2JqZWN0O1xuICBpZiAob3B0X2lzM1ApIHtcbiAgICAvLyBTZXJpYWxpemUgb3Vyc2VsdmVzIGJlY2F1c2UgdGhhdCBpcyBtdWNoIGZhc3RlciBpbiBDaHJvbWUuXG4gICAgcGF5bG9hZCA9ICdhbXAtJyArIEpTT04uc3RyaW5naWZ5KG9iamVjdCk7XG4gIH1cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gdGFyZ2V0c1tpXTtcbiAgICB0YXJnZXQud2luLi8qT0sqL3Bvc3RNZXNzYWdlKHBheWxvYWQsIHRhcmdldC5vcmlnaW4pO1xuICB9XG59XG5cbi8qKlxuICogR2V0cyB0aGUgc2VudGluZWwgc3RyaW5nLlxuICogQHBhcmFtIHshRWxlbWVudH0gaWZyYW1lIFRoZSBpZnJhbWUuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfaXMzUCBzZXQgdG8gdHJ1ZSBpZiB0aGUgaWZyYW1lIGlzIDNwLlxuICogQHJldHVybiB7c3RyaW5nfSBTZW50aW5lbCBzdHJpbmcuXG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBnZXRTZW50aW5lbF8oaWZyYW1lLCBvcHRfaXMzUCkge1xuICByZXR1cm4gb3B0X2lzM1AgPyBpZnJhbWUuZ2V0QXR0cmlidXRlKCdkYXRhLWFtcC0zcC1zZW50aW5lbCcpIDogJ2FtcCc7XG59XG5cbi8qKlxuICogSlNPTiBwYXJzZXMgZXZlbnQuZGF0YSBpZiBpdCBuZWVkcyB0byBiZVxuICogQHBhcmFtIHsqfSBkYXRhXG4gKiBAcmV0dXJuIHs/SnNvbk9iamVjdH0gb2JqZWN0IG1lc3NhZ2VcbiAqIEBwcml2YXRlXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSWZOZWVkZWQoZGF0YSkge1xuICBpZiAodHlwZW9mIGRhdGEgPT0gJ3N0cmluZycpIHtcbiAgICBpZiAoZGF0YS5jaGFyQXQoMCkgPT0gJ3snKSB7XG4gICAgICBkYXRhID0gdHJ5UGFyc2VKc29uKGRhdGEsIGUgPT4ge1xuICAgICAgICBkZXYoKS53YXJuKCdJRlJBTUUtSEVMUEVSJyxcbiAgICAgICAgICAgICdQb3N0bWVzc2FnZSBjb3VsZCBub3QgYmUgcGFyc2VkLiAnICtcbiAgICAgICAgICAgICdJcyBpdCBpbiBhIHZhbGlkIEpTT04gZm9ybWF0PycsIGUpO1xuICAgICAgfSkgfHwgbnVsbDtcbiAgICB9IGVsc2UgaWYgKGlzQW1wTWVzc2FnZShkYXRhKSkge1xuICAgICAgZGF0YSA9IGRlc2VyaWFsaXplTWVzc2FnZShkYXRhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGF0YSA9IG51bGw7XG4gICAgfVxuICB9XG4gIHJldHVybiAvKiogQHR5cGUgez9Kc29uT2JqZWN0fSAqLyAoZGF0YSk7XG59XG5cblxuXG4vKipcbiAqIE1hbmFnZXMgYSBwb3N0TWVzc2FnZSBBUEkgZm9yIGFuIGlmcmFtZSB3aXRoIGEgc3Vic2NyaXB0aW9uIG1lc3NhZ2UgYW5kXG4gKiBhIHdheSB0byBicm9hZGNhc3QgbWVzc2FnZXMgdG8gYWxsIHN1YnNjcmliZWQgd2luZG93cywgd2hpY2hcbiAqIGluIHR1cm4gbXVzdCBhbGwgYmUgZGVzY2VuZGFudHMgb2YgdGhlIGNvbnRlbnRXaW5kb3cgb2YgdGhlIGlmcmFtZS5cbiAqL1xuZXhwb3J0IGNsYXNzIFN1YnNjcmlwdGlvbkFwaSB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBpZnJhbWUgVGhlIGlmcmFtZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgVHlwZSBvZiB0aGUgc3Vic2NyaXB0aW9uIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXMzcCBzZXQgdG8gdHJ1ZSBpZiB0aGUgaWZyYW1lIGlzIDNwLlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCFKc29uT2JqZWN0LCAhV2luZG93LCBzdHJpbmcpfSByZXF1ZXN0Q2FsbGJhY2sgQ2FsbGJhY2tcbiAgICogICAgIGludm9rZWQgd2hlbmV2ZXIgYSBuZXcgd2luZG93IHN1YnNjcmliZXMuXG4gICAqL1xuICBjb25zdHJ1Y3RvcihpZnJhbWUsIHR5cGUsIGlzM3AsIHJlcXVlc3RDYWxsYmFjaykge1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFFbGVtZW50fSAqL1xuICAgIHRoaXMuaWZyYW1lXyA9IGlmcmFtZTtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtib29sZWFufSAqL1xuICAgIHRoaXMuaXMzcF8gPSBpczNwO1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFBcnJheTx7d2luOiAhV2luZG93LCBvcmlnaW46IHN0cmluZ30+fSAqL1xuICAgIHRoaXMuY2xpZW50V2luZG93c18gPSBbXTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFVbmxpc3RlbkRlZn0gKi9cbiAgICB0aGlzLnVubGlzdGVuXyA9IGxpc3RlbkZvcih0aGlzLmlmcmFtZV8sIHR5cGUsIChkYXRhLCBzb3VyY2UsIG9yaWdpbikgPT4ge1xuICAgICAgLy8gVGhpcyBtZXNzYWdlIG1pZ2h0IGJlIGZyb20gYW55IHdpbmRvdyB3aXRoaW4gdGhlIGlmcmFtZSwgd2UgbmVlZFxuICAgICAgLy8gdG8ga2VlcCB0cmFjayBvZiB3aGljaCB3aW5kb3dzIHdhbnQgdG8gYmUgc2VudCB1cGRhdGVzLlxuICAgICAgaWYgKCF0aGlzLmNsaWVudFdpbmRvd3NfLnNvbWUoZW50cnkgPT4gZW50cnkud2luID09IHNvdXJjZSkpIHtcbiAgICAgICAgdGhpcy5jbGllbnRXaW5kb3dzXy5wdXNoKHt3aW46IHNvdXJjZSwgb3JpZ2lufSk7XG4gICAgICB9XG4gICAgICByZXF1ZXN0Q2FsbGJhY2soZGF0YSwgc291cmNlLCBvcmlnaW4pO1xuICAgIH0sIHRoaXMuaXMzcF8sXG4gICAgICAgIC8vIEZvciAzUCBmcmFtZXMgd2UgYWxzbyBhbGxvdyBuZXN0ZWQgZnJhbWVzIHdpdGhpbiB0aGVtIHRvIHN1YnNjcmliZS4uXG4gICAgdGhpcy5pczNwXyAvKiBvcHRfaW5jbHVkaW5nTmVzdGVkV2luZG93cyAqLyk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZHMgYSBtZXNzYWdlIHRvIGFsbCBzdWJzY3JpYmVkIHdpbmRvd3MuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIFR5cGUgb2YgdGhlIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7IUpzb25PYmplY3R9IGRhdGEgTWVzc2FnZSBwYXlsb2FkLlxuICAgKi9cbiAgc2VuZCh0eXBlLCBkYXRhKSB7XG4gICAgLy8gUmVtb3ZlIGNsaWVudHMgdGhhdCBoYXZlIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSBET00uXG4gICAgZmlsdGVyU3BsaWNlKHRoaXMuY2xpZW50V2luZG93c18sIGNsaWVudCA9PiAhIWNsaWVudC53aW4ucGFyZW50KTtcbiAgICBwb3N0TWVzc2FnZVRvV2luZG93cyhcbiAgICAgICAgdGhpcy5pZnJhbWVfLFxuICAgICAgICB0aGlzLmNsaWVudFdpbmRvd3NfLFxuICAgICAgICB0eXBlLFxuICAgICAgICBkYXRhLFxuICAgICAgICB0aGlzLmlzM3BfKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXN0cm95cyBpZnJhbWUuXG4gICAqL1xuICBkZXN0cm95KCkge1xuICAgIHRoaXMudW5saXN0ZW5fKCk7XG4gICAgdGhpcy5jbGllbnRXaW5kb3dzXy5sZW5ndGggPSAwO1xuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvb2tzTGlrZVRyYWNraW5nSWZyYW1lKGVsZW1lbnQpIHtcbiAgY29uc3QgYm94ID0gZWxlbWVudC5nZXRMYXlvdXRCb3goKTtcbiAgLy8gVGhpcyBoZXVyaXN0aWMgaXMgc3ViamVjdCB0byBjaGFuZ2UuXG4gIGlmIChib3gud2lkdGggPiAxMCB8fCBib3guaGVpZ2h0ID4gMTApIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgLy8gSWZyYW1lIGlzIG5vdCB0cmFja2luZyBpZnJhbWUgaWYgb3BlbiB3aXRoIHVzZXIgaW50ZXJhY3Rpb25cbiAgcmV0dXJuICFjbG9zZXN0QnlTZWxlY3RvcihlbGVtZW50LCAnLmktYW1waHRtbC1vdmVybGF5Jyk7XG59XG5cbi8vIE1vc3QgY29tbW9uIGFkIHNpemVzXG4vLyBBcnJheSBvZiBbd2lkdGgsIGhlaWdodF0gcGFpcnMuXG5jb25zdCBhZFNpemVzID0gW1xuICBbMzAwLCAyNTBdLFxuICBbMzIwLCA1MF0sXG4gIFszMDAsIDUwXSxcbiAgWzMyMCwgMTAwXSxcbl07XG5cbi8qKlxuICogR3Vlc3Mgd2hldGhlciB0aGlzIGVsZW1lbnQgbWlnaHQgYmUgYW4gYWQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50IEFuIGFtcC1pZnJhbWUgZWxlbWVudC5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQWRMaWtlKGVsZW1lbnQpIHtcbiAgY29uc3QgYm94ID0gZWxlbWVudC5nZXRMYXlvdXRCb3goKTtcbiAgY29uc3Qge2hlaWdodCwgd2lkdGh9ID0gYm94O1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGFkU2l6ZXMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCByZWZXaWR0aCA9IGFkU2l6ZXNbaV1bMF07XG4gICAgY29uc3QgcmVmSGVpZ2h0ID0gYWRTaXplc1tpXVsxXTtcbiAgICBpZiAocmVmSGVpZ2h0ID4gaGVpZ2h0KSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKHJlZldpZHRoID4gd2lkdGgpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICAvLyBGdXp6eSBtYXRjaGluZyB0byBhY2NvdW50IGZvciBwYWRkaW5nLlxuICAgIGlmIChoZWlnaHQgLSByZWZIZWlnaHQgPD0gMjAgJiYgd2lkdGggLSByZWZXaWR0aCA8PSAyMCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFFbGVtZW50fSBpZnJhbWVcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkaXNhYmxlU2Nyb2xsaW5nT25JZnJhbWUoaWZyYW1lKSB7XG4gIGFkZEF0dHJpYnV0ZXNUb0VsZW1lbnQoaWZyYW1lLCBkaWN0KHsnc2Nyb2xsaW5nJzogJ25vJ30pKTtcblxuICAvLyBUaGlzIHNob3VsZG4ndCB3b3JrLCBidXQgaXQgZG9lcyBvbiBGaXJlZm94LlxuICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTU0OTQ5NjlcbiAgc2V0U3R5bGUoaWZyYW1lLCAnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7XG5cbiAgcmV0dXJuIGlmcmFtZTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge0RlZmVycmVkfSBmcm9tICcuL3V0aWxzL3Byb21pc2UnO1xuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi9zZXJ2aWNlcyc7XG5pbXBvcnQge1xuICBhZGRQYXJhbXNUb1VybCxcbiAgaXNQcm94eU9yaWdpbixcbiAgcGFyc2VRdWVyeVN0cmluZyxcbiAgcGFyc2VVcmxEZXByZWNhdGVkLFxufSBmcm9tICcuL3VybCc7XG5pbXBvcnQge2RldiwgdXNlcn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuL21vZGUnO1xuaW1wb3J0IHtpc0V4cGVyaW1lbnRPbn0gZnJvbSAnLi9leHBlcmltZW50cyc7XG5cbmNvbnN0IFRJTUVPVVRfVkFMVUUgPSA4MDAwO1xuXG5sZXQgdHJhY2tJbXByZXNzaW9uUHJvbWlzZSA9IG51bGw7XG5cbmNvbnN0IERFRkFVTFRfQVBQRU5EX1VSTF9QQVJBTSA9IFtcbiAgJ2djbGlkJyxcbiAgJ2djbHNyYycsXG5dO1xuXG4vKipcbiAqIEEgZnVuY3Rpb24gdG8gZ2V0IHRoZSB0cmFja0ltcHJlc3Npb25Qcm9taXNlO1xuICogQHJldHVybiB7IVByb21pc2V9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUcmFja0ltcHJlc3Npb25Qcm9taXNlKCkge1xuICByZXR1cm4gZGV2KCkuYXNzZXJ0KHRyYWNrSW1wcmVzc2lvblByb21pc2UpO1xufVxuXG4vKipcbiAqIEZ1bmN0aW9uIHRoYXQgcmVzZXQgdGhlIHRyYWNrSW1wcmVzc2lvblByb21pc2Ugb25seSBmb3IgdGVzdGluZ1xuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldFRyYWNrSW1wcmVzc2lvblByb21pc2VGb3JUZXN0aW5nKCkge1xuICB0cmFja0ltcHJlc3Npb25Qcm9taXNlID0gbnVsbDtcbn1cblxuLyoqXG4gKiBFbWl0IGEgSFRUUCByZXF1ZXN0IHRvIGEgZGVzdGluYXRpb24gZGVmaW5lZCBvbiB0aGUgaW5jb21pbmcgVVJMLlxuICogTGF1bmNoZWQgZm9yIHRydXN0ZWQgdmlld2VyLiBPdGhlcndpc2UgZ3VhcmRlZCBieSBleHBlcmltZW50LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1heWJlVHJhY2tJbXByZXNzaW9uKHdpbikge1xuICBjb25zdCBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICBjb25zdCB7cHJvbWlzZSwgcmVzb2x2ZTogcmVzb2x2ZUltcHJlc3Npb259ID0gZGVmZXJyZWQ7XG5cblxuICB0cmFja0ltcHJlc3Npb25Qcm9taXNlID0gU2VydmljZXMudGltZXJGb3Iod2luKS50aW1lb3V0UHJvbWlzZShUSU1FT1VUX1ZBTFVFLFxuICAgICAgcHJvbWlzZSwgJ1RyYWNrSW1wcmVzc2lvblByb21pc2UgdGltZW91dCcpLmNhdGNoKGVycm9yID0+IHtcbiAgICBkZXYoKS53YXJuKCdJTVBSRVNTSU9OJywgZXJyb3IpO1xuICB9KTtcblxuICBjb25zdCB2aWV3ZXIgPSBTZXJ2aWNlcy52aWV3ZXJGb3JEb2Mod2luLmRvY3VtZW50KTtcbiAgY29uc3QgaXNUcnVzdGVkVmlld2VyUHJvbWlzZSA9IHZpZXdlci5pc1RydXN0ZWRWaWV3ZXIoKTtcbiAgY29uc3QgaXNUcnVzdGVkUmVmZXJyZXJQcm9taXNlID0gdmlld2VyLmlzVHJ1c3RlZFJlZmVycmVyKCk7XG4gIFByb21pc2UuYWxsKFtcbiAgICBpc1RydXN0ZWRWaWV3ZXJQcm9taXNlLFxuICAgIGlzVHJ1c3RlZFJlZmVycmVyUHJvbWlzZSxcbiAgXSkudGhlbihyZXN1bHRzID0+IHtcbiAgICBjb25zdCBpc1RydXN0ZWRWaWV3ZXIgPSByZXN1bHRzWzBdO1xuICAgIGNvbnN0IGlzVHJ1c3RlZFJlZmVycmVyID0gcmVzdWx0c1sxXTtcbiAgICAvLyBDdXJyZW50bHkgdGhpcyBmZWF0dXJlIGlzIGxhdW5jaGVkIGZvciB0cnVzdGVkIHZpZXdlciBhbmQgdHJ1c3RlZFxuICAgIC8vIHJlZmVycmVyLCBidXQgc3RpbGwgZXhwZXJpbWVudCBndWFyZGVkIGZvciBhbGwgQU1QIGRvY3MuXG4gICAgaWYgKCFpc1RydXN0ZWRWaWV3ZXIgJiYgIWlzVHJ1c3RlZFJlZmVycmVyICYmICFpc0V4cGVyaW1lbnRPbih3aW4sICdhbHAnKSkge1xuICAgICAgcmVzb2x2ZUltcHJlc3Npb24oKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCByZXBsYWNlVXJsUHJvbWlzZSA9IGhhbmRsZVJlcGxhY2VVcmwod2luKTtcbiAgICBjb25zdCBjbGlja1VybFByb21pc2UgPSBoYW5kbGVDbGlja1VybCh3aW4pO1xuXG4gICAgUHJvbWlzZS5hbGwoW3JlcGxhY2VVcmxQcm9taXNlLCBjbGlja1VybFByb21pc2VdKS50aGVuKCgpID0+IHtcbiAgICAgIHJlc29sdmVJbXByZXNzaW9uKCk7XG4gICAgfSwgKCkgPT4ge30pO1xuICB9KTtcbn1cblxuLyoqXG4gKiBTaWduYWwgdGhhdCBpbXByZXNzaW9uIHRyYWNraW5nIGlzIG5vdCByZWxldmFudCBpbiB0aGlzIGVudmlyb25tZW50LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZG9Ob3RUcmFja0ltcHJlc3Npb24oKSB7XG4gIHRyYWNrSW1wcmVzc2lvblByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTtcbn1cblxuLyoqXG4gKiBIYW5kbGUgdGhlIGdldFJlcGxhY2VVcmwgYW5kIHJldHVybiBhIHByb21pc2Ugd2hlbiB1cmwgaXMgcmVwbGFjZWQgT25seVxuICogaGFuZGxlcyByZXBsYWNlVXJsIHdoZW4gdmlld2VyIGluZGljYXRlcyBBTVAgdG8gZG8gc28uIFZpZXdlciBzaG91bGQgaW5kaWNhdGVcbiAqIGJ5IHNldHRpbmcgdGhlIGxlZ2FjeSByZXBsYWNlVXJsIGluaXQgcGFyYW0gYW5kIGFkZCBgcmVwbGFjZVVybGAgdG8gaXRzXG4gKiBjYXBhYmlsaXR5IHBhcmFtLiBGdXR1cmUgcGxhbiBpcyB0byBjaGFuZ2UgdGhlIHR5cGUgb2YgbGVnYWN5IGluaXQgcmVwbGFjZVVybFxuICogcGFyYW0gZnJvbSB1cmwgc3RyaW5nIHRvIGJvb2xlYW4gdmFsdWUuIFBsZWFzZSBOT1RFIHJlcGxhY2VVcmwgYW5kIGFkTG9jYXRpb25cbiAqIHdpbGwgbmV2ZXIgYXJyaXZlIGF0IHNhbWUgdGltZSwgc28gdGhlcmUgaXMgbm8gcmFjZSBjb25kaXRpb24gb24gdGhlIG9yZGVyIG9mXG4gKiBoYW5kbGluZyB1cmwgcmVwbGFjZW1lbnQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IVByb21pc2V9XG4gKi9cbmZ1bmN0aW9uIGhhbmRsZVJlcGxhY2VVcmwod2luKSB7XG4gIGNvbnN0IHZpZXdlciA9IFNlcnZpY2VzLnZpZXdlckZvckRvYyh3aW4uZG9jdW1lbnQpO1xuXG4gIC8vIFJlcGxhY2VVcmwgc3Vic3RpdHV0aW9uIGRvZXNuJ3QgaGF2ZSB0byB3YWl0IHVudGlsIHRoZSBkb2N1bWVudCBpcyB2aXNpYmxlXG4gIGlmICghdmlld2VyLmdldFBhcmFtKCdyZXBsYWNlVXJsJykpIHtcbiAgICAvLyBUaGUgaW5pdCByZXBsYWNlVXJsIHBhcmFtIHNlcnZlIGFzIGEgc2lnbmFsIG9uIHdoZXRoZXIgcmVwbGFjZVVybCBpc1xuICAgIC8vIHJlcXVpcmVkIGZvciB0aGlzIGRvYy5cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH1cblxuICBpZiAoIXZpZXdlci5oYXNDYXBhYmlsaXR5KCdyZXBsYWNlVXJsJykpIHtcbiAgICAvLyBJZiBWaWV3ZXIgaXMgbm90IGNhcGFiaWxpdHkgb2YgcHJvdmlkaW5nIGFzeW5jIHJlcGxhY2VVcmwsIHVzZSB0aGUgbGVnYWN5XG4gICAgLy8gaW5pdCByZXBsYWNlVXJsIHBhcmFtLlxuICAgIHZpZXdlci5yZXBsYWNlVXJsKHZpZXdlci5nZXRQYXJhbSgncmVwbGFjZVVybCcpIHx8IG51bGwpO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuXG4gIC8vIHJlcXVlc3QgYXN5bmMgcmVwbGFjZVVybCBpcyB2aWV3ZXIgc3VwcG9ydCBnZXRSZXBsYWNlVXJsLlxuICByZXR1cm4gdmlld2VyLnNlbmRNZXNzYWdlQXdhaXRSZXNwb25zZSgnZ2V0UmVwbGFjZVVybCcsIC8qIGRhdGEgKi8gdW5kZWZpbmVkKVxuICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICBpZiAoIXJlc3BvbnNlIHx8IHR5cGVvZiByZXNwb25zZSAhPSAnb2JqZWN0Jykge1xuICAgICAgICAgIGRldigpLndhcm4oJ0lNUFJFU1NJT04nLCAnZ2V0IGludmFsaWQgcmVwbGFjZVVybCByZXNwb25zZScpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2aWV3ZXIucmVwbGFjZVVybChyZXNwb25zZVsncmVwbGFjZVVybCddIHx8IG51bGwpO1xuICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgZGV2KCkud2FybignSU1QUkVTU0lPTicsICdFcnJvciByZXF1ZXN0IHJlcGxhY2VVcmwgZnJvbSB2aWV3ZXInLCBlcnIpO1xuICAgICAgfSk7XG59XG5cblxuLyoqXG4gKiBQZXJmb3JtIHRoZSBpbXByZXNzaW9uIHJlcXVlc3QgaWYgaXQgaGFzIGJlZW4gcHJvdmlkZWQgdmlhXG4gKiB0aGUgY2xpY2sgcGFyYW0gaW4gdGhlIHZpZXdlciBhcmd1bWVudHMuIFJldHVybnMgYSBwcm9taXNlLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFQcm9taXNlfVxuICovXG5mdW5jdGlvbiBoYW5kbGVDbGlja1VybCh3aW4pIHtcbiAgY29uc3Qgdmlld2VyID0gU2VydmljZXMudmlld2VyRm9yRG9jKHdpbi5kb2N1bWVudCk7XG4gIC8qKiBAY29uc3Qge3N0cmluZ3x1bmRlZmluZWR9ICovXG4gIGNvbnN0IGNsaWNrVXJsID0gdmlld2VyLmdldFBhcmFtKCdjbGljaycpO1xuXG5cbiAgaWYgKCFjbGlja1VybCkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuXG4gIGlmIChjbGlja1VybC5pbmRleE9mKCdodHRwczovLycpICE9IDApIHtcbiAgICB1c2VyKCkud2FybignSU1QUkVTU0lPTicsXG4gICAgICAgICdjbGljayBmcmFnbWVudCBwYXJhbSBzaG91bGQgc3RhcnQgd2l0aCBodHRwczovLy4gRm91bmQgJyxcbiAgICAgICAgY2xpY2tVcmwpO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuXG4gIGlmICh3aW4ubG9jYXRpb24uaGFzaCkge1xuICAgIC8vIFRoaXMgaXMgdHlwaWNhbGx5IGRvbmUgdXNpbmcgcmVwbGFjZVN0YXRlIGluc2lkZSB0aGUgdmlld2VyLlxuICAgIC8vIElmIGZvciBzb21lIHJlYXNvbiBpdCBmYWlsZWQsIGdldCByaWQgb2YgdGhlIGZyYWdtZW50IGhlcmUgdG9cbiAgICAvLyBhdm9pZCBkdXBsaWNhdGUgdHJhY2tpbmcuXG4gICAgd2luLmxvY2F0aW9uLmhhc2ggPSAnJztcbiAgfVxuXG4gIC8vIFRPRE8oQHpob3V5eCkgbmVlZCB0ZXN0IHdpdGggYSByZWFsIHJlc3BvbnNlLlxuICByZXR1cm4gdmlld2VyLndoZW5GaXJzdFZpc2libGUoKS50aGVuKCgpID0+IHtcbiAgICByZXR1cm4gaW52b2tlKHdpbiwgZGV2KCkuYXNzZXJ0U3RyaW5nKGNsaWNrVXJsKSk7XG4gIH0pLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgIGFwcGx5UmVzcG9uc2Uod2luLCByZXNwb25zZSk7XG4gIH0pLmNhdGNoKGVyciA9PiB7XG4gICAgdXNlcigpLndhcm4oJ0lNUFJFU1NJT04nLCAnRXJyb3Igb24gcmVxdWVzdCBjbGlja1VybDogJywgZXJyKTtcbiAgfSk7XG59XG5cbi8qKlxuICogU2VuZCB0aGUgdXJsIHRvIGFkIHNlcnZlciBhbmQgd2FpdCBmb3IgaXRzIHJlc3BvbnNlXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGNsaWNrVXJsXG4gKiBAcmV0dXJuIHshUHJvbWlzZTw/SnNvbk9iamVjdD59XG4gKi9cbmZ1bmN0aW9uIGludm9rZSh3aW4sIGNsaWNrVXJsKSB7XG4gIGlmIChnZXRNb2RlKCkubG9jYWxEZXYgJiYgIWdldE1vZGUoKS50ZXN0KSB7XG4gICAgY2xpY2tVcmwgPSAnaHR0cDovL2xvY2FsaG9zdDo4MDAwL2ltcHJlc3Npb24tcHJveHk/dXJsPScgKyBjbGlja1VybDtcbiAgfVxuICByZXR1cm4gU2VydmljZXMueGhyRm9yKHdpbikuZmV0Y2hKc29uKGNsaWNrVXJsLCB7XG4gICAgY3JlZGVudGlhbHM6ICdpbmNsdWRlJyxcbiAgICAvLyBBbGwgb3JpZ2lucyBhcmUgYWxsb3dzIHRvIHNlbmQgdGhlc2UgcmVxdWVzdHMuXG4gICAgcmVxdWlyZUFtcFJlc3BvbnNlU291cmNlT3JpZ2luOiBmYWxzZSxcbiAgfSkudGhlbihyZXMgPT4ge1xuICAgIC8vIFRyZWF0IDIwNCBubyBjb250ZW50IHJlc3BvbnNlIHNwZWNpYWxseVxuICAgIGlmIChyZXMuc3RhdHVzID09IDIwNCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiByZXMuanNvbigpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBwYXJzZSB0aGUgcmVzcG9uc2UgYmFjayBmcm9tIGFkIHNlcnZlclxuICogU2V0IGZvciBhbmFseXRpY3MgcHVycG9zZXNcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0gez9Kc29uT2JqZWN0fSByZXNwb25zZVxuICovXG5mdW5jdGlvbiBhcHBseVJlc3BvbnNlKHdpbiwgcmVzcG9uc2UpIHtcbiAgaWYgKCFyZXNwb25zZSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGFkTG9jYXRpb24gPSByZXNwb25zZVsnbG9jYXRpb24nXTtcbiAgY29uc3QgYWRUcmFja2luZyA9IHJlc3BvbnNlWyd0cmFja2luZ191cmwnXTtcblxuICAvLyBJZiB0aGVyZSBpcyBhIHRyYWNraW5nX3VybCwgbmVlZCB0byB0cmFjayBpdFxuICAvLyBPdGhlcndpc2UgdHJhY2sgdGhlIGxvY2F0aW9uXG4gIGNvbnN0IHRyYWNrVXJsID0gYWRUcmFja2luZyB8fCBhZExvY2F0aW9uO1xuXG4gIGlmICh0cmFja1VybCAmJiAhaXNQcm94eU9yaWdpbih0cmFja1VybCkpIHtcbiAgICAvLyBUbyByZXF1ZXN0IHRoZSBwcm92aWRlZCB0cmFja1VybCBmb3IgdHJhY2tpbmcgcHVycG9zZXMuXG4gICAgbmV3IEltYWdlKCkuc3JjID0gdHJhY2tVcmw7XG4gIH1cblxuICAvLyBSZXBsYWNlIHRoZSBsb2NhdGlvbiBocmVmIHBhcmFtcyB3aXRoIG5ldyBsb2NhdGlvbiBwYXJhbXMgd2UgZ2V0IChpZiBhbnkpLlxuICBpZiAoYWRMb2NhdGlvbikge1xuICAgIGlmICghd2luLmhpc3RvcnkucmVwbGFjZVN0YXRlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgdmlld2VyID0gU2VydmljZXMudmlld2VyRm9yRG9jKHdpbi5kb2N1bWVudCk7XG4gICAgY29uc3QgY3VycmVudEhyZWYgPSB3aW4ubG9jYXRpb24uaHJlZjtcbiAgICBjb25zdCB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQoYWRMb2NhdGlvbik7XG4gICAgY29uc3QgcGFyYW1zID0gcGFyc2VRdWVyeVN0cmluZyh1cmwuc2VhcmNoKTtcbiAgICBjb25zdCBuZXdIcmVmID0gYWRkUGFyYW1zVG9VcmwoY3VycmVudEhyZWYsIHBhcmFtcyk7XG4gICAgLy8gVE9ETzogQXZvaWQgb3ZlcndyaXRpbmcgdGhlIGZyYWdtZW50IHBhcmFtZXRlci5cbiAgICB3aW4uaGlzdG9yeS5yZXBsYWNlU3RhdGUobnVsbCwgJycsIG5ld0hyZWYpO1xuICAgIHZpZXdlci5tYXliZVVwZGF0ZUZyYWdtZW50Rm9yQ2N0KCk7XG4gIH1cbn1cblxuLyoqXG4gKiBSZXR1cm4gYSBwcm9taXNlIHRoYXQgd2hldGhlciBhcHBlbmRpbmcgZXh0cmEgdXJsIHBhcmFtcyB0byBvdXRnb2luZyBsaW5rIGlzXG4gKiByZXF1aXJlZC5cbiAqIEBwYXJhbSB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICogQHJldHVybiB7IVByb21pc2U8Ym9vbGVhbj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaG91bGRBcHBlbmRFeHRyYVBhcmFtcyhhbXBkb2MpIHtcbiAgcmV0dXJuIGFtcGRvYy53aGVuUmVhZHkoKS50aGVuKCgpID0+IHtcbiAgICByZXR1cm4gISFhbXBkb2MuZ2V0Qm9keSgpLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICdhbXAtYW5hbHl0aWNzW3R5cGU9Z29vZ2xlYW5hbHl0aWNzXScpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBSZXR1cm4gdGhlIGV4dHJhIHVybCBwYXJhbXMgc3RyaW5nIHRoYXQgc2hvdWxkIGJlIGFwcGVuZGVkIHRvIG91dGdvaW5nIGxpbmtcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFFbGVtZW50fSB0YXJnZXRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4dHJhUGFyYW1zVXJsKHdpbiwgdGFyZ2V0KSB7XG4gIC8vIEdldCBhbiBhcnJheSB3aXRoIGV4dHJhIHBhcmFtcyB0aGF0IG5lZWRzIHRvIGFwcGVuZC5cbiAgY29uc3QgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHdpbi5sb2NhdGlvbi5ocmVmKTtcbiAgY29uc3QgcGFyYW1zID0gcGFyc2VRdWVyeVN0cmluZyh1cmwuc2VhcmNoKTtcbiAgY29uc3QgYXBwZW5kUGFyYW1zID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgREVGQVVMVF9BUFBFTkRfVVJMX1BBUkFNLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgcGFyYW0gPSBERUZBVUxUX0FQUEVORF9VUkxfUEFSQU1baV07XG4gICAgaWYgKHR5cGVvZiBwYXJhbXNbcGFyYW1dICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgYXBwZW5kUGFyYW1zLnB1c2gocGFyYW0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIENoZWNrIGlmIHRoZSBwYXJhbSBhbHJlYWR5IGV4aXN0c1xuICBjb25zdCBhZGRpdGlvbmFsVXJsUGFyYW1zID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1hbXAtYWRkcGFyYW1zJyk7XG4gIGxldCB7aHJlZn0gPSB0YXJnZXQ7XG4gIGlmIChhZGRpdGlvbmFsVXJsUGFyYW1zKSB7XG4gICAgaHJlZiA9IGFkZFBhcmFtc1RvVXJsKGhyZWYsIHBhcnNlUXVlcnlTdHJpbmcoYWRkaXRpb25hbFVybFBhcmFtcykpO1xuICB9XG4gIGNvbnN0IGxvYyA9IHBhcnNlVXJsRGVwcmVjYXRlZChocmVmKTtcbiAgY29uc3QgZXhpc3RQYXJhbXMgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvYy5zZWFyY2gpO1xuICBmb3IgKGxldCBpID0gYXBwZW5kUGFyYW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgY29uc3QgcGFyYW0gPSBhcHBlbmRQYXJhbXNbaV07XG4gICAgaWYgKHR5cGVvZiBleGlzdFBhcmFtc1twYXJhbV0gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBhcHBlbmRQYXJhbXMuc3BsaWNlKGksIDEpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZ2V0UXVlcnlQYXJhbVVybChhcHBlbmRQYXJhbXMpO1xufVxuXG4vKipcbiAqIEhlbHBlciBtZXRob2QgdG8gY29udmVydCBhbiBxdWVyeSBwYXJhbSBhcnJheSB0byBzdHJpbmdcbiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHBhcmFtc1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBnZXRRdWVyeVBhcmFtVXJsKHBhcmFtcykge1xuICBsZXQgdXJsID0gJyc7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcGFyYW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgcGFyYW0gPSBwYXJhbXNbaV07XG4gICAgdXJsICs9IChpID09IDApID9cbiAgICAgIGAke3BhcmFtfT1RVUVSWV9QQVJBTSgke3BhcmFtfSlgIDpcbiAgICAgIGAmJHtwYXJhbX09UVVFUllfUEFSQU0oJHtwYXJhbX0pYDtcbiAgfVxuICByZXR1cm4gdXJsO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7U3Vic2NyaXB0aW9uQXBpfSBmcm9tICcuL2lmcmFtZS1oZWxwZXInO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7ZGljdH0gZnJvbSAnLi91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtpc0FycmF5LCBpc0Zpbml0ZU51bWJlcn0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQge2xheW91dFJlY3RMdHdoLCBtb3ZlTGF5b3V0UmVjdCwgcmVjdEludGVyc2VjdGlvbn0gZnJvbSAnLi9sYXlvdXQtcmVjdCc7XG5cbi8qKlxuICogVGhlIHN0cnVjdHVyZSB0aGF0IGRlZmluZXMgdGhlIHJlY3RhbmdsZSB1c2VkIGluIGludGVyc2VjdGlvbiBvYnNlcnZlcnMuXG4gKlxuICogQHR5cGVkZWYge3tcbiAqICAgdG9wOiBudW1iZXIsXG4gKiAgIGJvdHRvbTogbnVtYmVyLFxuICogICBsZWZ0OiBudW1iZXIsXG4gKiAgIHJpZ2h0OiBudW1iZXIsXG4gKiAgIHdpZHRoOiBudW1iZXIsXG4gKiAgIGhlaWdodDogbnVtYmVyLFxuICogICB4OiBudW1iZXIsXG4gKiAgIHk6IG51bWJlcixcbiAqIH19XG4gKi9cbmV4cG9ydCBsZXQgRE9NUmVjdDtcblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfVEhSRVNIT0xEID1cbiAgICBbMCwgMC4wNSwgMC4xLCAwLjE1LCAwLjIsIDAuMjUsIDAuMywgMC4zNSwgMC40LFxuICAgICAgMC40NSwgMC41LCAwLjU1LCAwLjYsIDAuNjUsIDAuNywgMC43NSwgMC44LCAwLjg1LCAwLjksIDAuOTUsIDFdO1xuXG4vKiogQHR5cGVkZWYge3tcbiAqICAgIGVsZW1lbnQ6ICFFbGVtZW50LFxuICogICAgY3VycmVudFRocmVzaG9sZFNsb3Q6IG51bWJlcixcbiAqICB9fVxuICovXG5sZXQgRWxlbWVudEludGVyc2VjdGlvblN0YXRlRGVmO1xuXG4vKiogQGNvbnN0IEBwcml2YXRlICovXG5jb25zdCBUQUcgPSAnSU5URVJTRUNUSU9OLU9CU0VSVkVSJztcblxuLyoqIEBjb25zdCBAcHJpdmF0ZSAqL1xuY29uc3QgSU5JVF9USU1FID0gRGF0ZS5ub3coKTtcblxuLyoqXG4gKiBBIGZ1bmN0aW9uIHRvIGdldCB0aGUgZWxlbWVudCdzIGN1cnJlbnQgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeVxuICogcmVnYXJkbGVzcyBvZiB0aGUgaW50ZXJzZXRpb24gcmF0aW8uIE9ubHkgYXZhaWxhYmxlIHdoZW4gZWxlbWVudCBpcyBub3RcbiAqIG5lc3RlZCBpbiBhIGNvbnRhaW5lciBpZnJhbWUuXG4gKiBUT0RPOiBzdXBwb3J0IG9wdF9pZnJhbWUgaWYgdGhlcmUncyB2YWxpZCB1c2UgY2FzZXMuXG4gKiBAcGFyYW0geyEuL2xheW91dC1yZWN0LkxheW91dFJlY3REZWZ9IGVsZW1lbnQgZWxlbWVudCdzIHJlY3RcbiAqIEBwYXJhbSB7Py4vbGF5b3V0LXJlY3QuTGF5b3V0UmVjdERlZn0gb3duZXIgZWxlbWVudCdzIG93bmVyIHJlY3RcbiAqIEBwYXJhbSB7IS4vbGF5b3V0LXJlY3QuTGF5b3V0UmVjdERlZn0gaG9zdFZpZXdwb3J0IGhvc3RWaWV3cG9ydCdzIHJlY3RcbiAqIEByZXR1cm4geyFJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5fSBBIGNoYW5nZSBlbnRyeS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEludGVyc2VjdGlvbkNoYW5nZUVudHJ5KFxuICBlbGVtZW50LCBvd25lciwgaG9zdFZpZXdwb3J0KSB7XG4gIGNvbnN0IGludGVyc2VjdGlvbiA9IHJlY3RJbnRlcnNlY3Rpb24oZWxlbWVudCwgb3duZXIsIGhvc3RWaWV3cG9ydCkgfHxcbiAgICAgIGxheW91dFJlY3RMdHdoKDAsIDAsIDAsIDApO1xuICBjb25zdCByYXRpbyA9IGludGVyc2VjdGlvblJhdGlvKGludGVyc2VjdGlvbiwgZWxlbWVudCk7XG4gIHJldHVybiBjYWxjdWxhdGVDaGFuZ2VFbnRyeShcbiAgICAgIGVsZW1lbnQsIGhvc3RWaWV3cG9ydCwgaW50ZXJzZWN0aW9uLCByYXRpbyk7XG59XG5cbi8qKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBuYXRpdmVJbnRlcnNlY3Rpb25PYnNlcnZlclN1cHBvcnRlZCh3aW4pIHtcbiAgcmV0dXJuICdJbnRlcnNlY3Rpb25PYnNlcnZlcicgaW4gd2luICYmXG4gICAgICAnSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeScgaW4gd2luICYmXG4gICAgICAnaW50ZXJzZWN0aW9uUmF0aW8nIGluIHdpbi5JbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5LnByb3RvdHlwZTtcbn1cblxuLyoqXG4gKiBBIGNsYXNzIHRvIGhlbHAgYW1wLWlmcmFtZSBhbmQgYW1wLWFkIG5lc3RlZCBpZnJhbWUgbGlzdGVuIHRvIGludGVyc2VjdGlvblxuICogY2hhbmdlLlxuICovXG5leHBvcnQgY2xhc3MgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJBcGkge1xuICAvKipcbiAgICogQHBhcmFtIHshQU1QLkJhc2VFbGVtZW50fSBiYXNlRWxlbWVudFxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBpZnJhbWVcbiAgICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2lzM3BcbiAgICovXG4gIGNvbnN0cnVjdG9yKGJhc2VFbGVtZW50LCBpZnJhbWUsIG9wdF9pczNwKSB7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IUFNUC5CYXNlRWxlbWVudH0gKi9cbiAgICB0aGlzLmJhc2VFbGVtZW50XyA9IGJhc2VFbGVtZW50O1xuXG4gICAgLyoqIEBwcml2YXRlIHs/SW50ZXJzZWN0aW9uT2JzZXJ2ZXJQb2x5ZmlsbH0gKi9cbiAgICB0aGlzLmludGVyc2VjdGlvbk9ic2VydmVyXyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy5zaG91bGRPYnNlcnZlXyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuaXNJblZpZXdwb3J0XyA9IGZhbHNlO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/ZnVuY3Rpb24oKX0gKi9cbiAgICB0aGlzLnVubGlzdGVuT25EZXN0cm95XyA9IG51bGw7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshLi9zZXJ2aWNlL3ZpZXdwb3J0L3ZpZXdwb3J0LWltcGwuVmlld3BvcnR9ICovXG4gICAgdGhpcy52aWV3cG9ydF8gPSBiYXNlRWxlbWVudC5nZXRWaWV3cG9ydCgpO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/U3Vic2NyaXB0aW9uQXBpfSAqL1xuICAgIHRoaXMuc3Vic2NyaXB0aW9uQXBpXyA9IG5ldyBTdWJzY3JpcHRpb25BcGkoXG4gICAgICAgIGlmcmFtZSwgJ3NlbmQtaW50ZXJzZWN0aW9ucycsIG9wdF9pczNwIHx8IGZhbHNlLCAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5zdGFydFNlbmRpbmdJbnRlcnNlY3Rpb25fKCk7XG4gICAgICAgIH0pO1xuXG4gICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlcl8gPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJQb2x5ZmlsbChlbnRyaWVzID0+IHtcbiAgICAgIC8vIFJlbW92ZSB0YXJnZXQgaW5mbyBmcm9tIGNyb3NzIG9yaWdpbiBpZnJhbWUuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVudHJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZGVsZXRlIGVudHJpZXNbaV1bJ3RhcmdldCddO1xuICAgICAgfVxuICAgICAgdGhpcy5zdWJzY3JpcHRpb25BcGlfLnNlbmQoJ2ludGVyc2VjdGlvbicsIGRpY3QoeydjaGFuZ2VzJzogZW50cmllc30pKTtcbiAgICB9LCB7dGhyZXNob2xkOiBERUZBVUxUX1RIUkVTSE9MRH0pO1xuICAgIHRoaXMuaW50ZXJzZWN0aW9uT2JzZXJ2ZXJfLnRpY2sodGhpcy52aWV3cG9ydF8uZ2V0UmVjdCgpKTtcblxuICAgIC8qKiBAY29uc3Qge2Z1bmN0aW9uKCl9ICovXG4gICAgdGhpcy5maXJlID0gKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLnNob3VsZE9ic2VydmVfIHx8ICF0aGlzLmlzSW5WaWV3cG9ydF8pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlcl8udGljayh0aGlzLnZpZXdwb3J0Xy5nZXRSZWN0KCkpO1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogRnVuY3Rpb24gdG8gc3RhcnQgbGlzdGVuaW5nIHRvIHZpZXdwb3J0IGV2ZW50LiBhbmQgb2JzZXJ2ZXIgaW50ZXJzZWN0aW9uXG4gICAqIGNoYW5nZSBvbiB0aGUgZWxlbWVudC5cbiAgICovXG4gIHN0YXJ0U2VuZGluZ0ludGVyc2VjdGlvbl8oKSB7XG4gICAgdGhpcy5zaG91bGRPYnNlcnZlXyA9IHRydWU7XG4gICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlcl8ub2JzZXJ2ZSh0aGlzLmJhc2VFbGVtZW50Xy5lbGVtZW50KTtcbiAgICB0aGlzLmJhc2VFbGVtZW50Xy5nZXRWc3luYygpLm1lYXN1cmUoKCkgPT4ge1xuICAgICAgdGhpcy5pc0luVmlld3BvcnRfID0gdGhpcy5iYXNlRWxlbWVudF8uaXNJblZpZXdwb3J0KCk7XG4gICAgICB0aGlzLmZpcmUoKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHVubGlzdGVuVmlld3BvcnRTY3JvbGwgPSB0aGlzLnZpZXdwb3J0Xy5vblNjcm9sbCh0aGlzLmZpcmUpO1xuICAgIGNvbnN0IHVubGlzdGVuVmlld3BvcnRDaGFuZ2UgPSB0aGlzLnZpZXdwb3J0Xy5vbkNoYW5nZWQodGhpcy5maXJlKTtcbiAgICB0aGlzLnVubGlzdGVuT25EZXN0cm95XyA9ICgpID0+IHtcbiAgICAgIHVubGlzdGVuVmlld3BvcnRTY3JvbGwoKTtcbiAgICAgIHVubGlzdGVuVmlld3BvcnRDaGFuZ2UoKTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEVuYWJsZSB0byB0aGUgUG9zaXRpb25PYnNlcnZlciB0byBsaXN0ZW4gdG8gdmlld3BvcnQgZXZlbnRzXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaW5WaWV3cG9ydFxuICAgKi9cbiAgb25WaWV3cG9ydENhbGxiYWNrKGluVmlld3BvcnQpIHtcbiAgICB0aGlzLmlzSW5WaWV3cG9ydF8gPSBpblZpZXdwb3J0O1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFuIGFsbCBsaXN0ZW5yc1xuICAgKi9cbiAgZGVzdHJveSgpIHtcbiAgICB0aGlzLnNob3VsZE9ic2VydmVfID0gZmFsc2U7XG4gICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlcl8gPSBudWxsO1xuICAgIGlmICh0aGlzLnVubGlzdGVuT25EZXN0cm95Xykge1xuICAgICAgdGhpcy51bmxpc3Rlbk9uRGVzdHJveV8oKTtcbiAgICAgIHRoaXMudW5saXN0ZW5PbkRlc3Ryb3lfID0gbnVsbDtcbiAgICB9XG4gICAgdGhpcy5zdWJzY3JpcHRpb25BcGlfLmRlc3Ryb3koKTtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbkFwaV8gPSBudWxsO1xuICB9XG59XG5cblxuLyoqXG4gKiBUaGUgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJQb2x5ZmlsbCBjbGFzcyBsZXRzIGFueSBlbGVtZW50IHJlY2VpdmUgaXRzXG4gKiBpbnRlcnNlY3Rpb24gZGF0YSB3aXRoIHRoZSB2aWV3cG9ydC4gSXQgYWN0cyBsaWtlIG5hdGl2ZSBicm93c2VyIHN1cHBvcnRlZFxuICogSW50ZXJzZWN0aW9uT2JzZXJ2ZXIuXG4gKiBUaGUgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIgcmVjZWl2ZXMgYSBjYWxsYmFjayBmdW5jdGlvbiBhbmQgYW4gb3B0aW9uYWwgb3B0aW9uXG4gKiBhcyBwYXJhbXMuIFdoZW5ldmVyIHRoZSBlbGVtZW50IGludGVyc2VjdGlvbiByYXRpbyBjcm9zcyBhIHRocmVzaG9sZCB2YWx1ZSxcbiAqIEludGVyc2VjdGlvbk9ic2VydmVyUG9seWZpbGwgd2lsbCBjYWxsIHRoZSBwcm92aWRlZCBjYWxsYmFjayBmdW5jdGlvbiB3aXRoXG4gKiB0aGUgY2hhbmdlIGVudHJ5LlxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBjbGFzcyBJbnRlcnNlY3Rpb25PYnNlcnZlclBvbHlmaWxsIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oIUFycmF5PCFJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5Pil9IGNhbGxiYWNrXG4gICAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0X29wdGlvblxuICAgKi9cbiAgY29uc3RydWN0b3IoY2FsbGJhY2ssIG9wdF9vcHRpb24pIHtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtmdW5jdGlvbighQXJyYXk8IUludGVyc2VjdGlvbk9ic2VydmVyRW50cnk+KX0gKi9cbiAgICB0aGlzLmNhbGxiYWNrXyA9IGNhbGxiYWNrO1xuXG4gICAgLy8gVGhlIGlucHV0IHRocmVzaG9sZCBjYW4gYmUgYSBudW1iZXIgb3IgYW4gYXJyYXkgb2YgbnVtYmVycy5cbiAgICBsZXQgdGhyZXNob2xkID0gb3B0X29wdGlvbiAmJiBvcHRfb3B0aW9uLnRocmVzaG9sZDtcbiAgICBpZiAodGhyZXNob2xkKSB7XG4gICAgICB0aHJlc2hvbGQgPSBpc0FycmF5KHRocmVzaG9sZCkgP1xuICAgICAgICB0aHJlc2hvbGQgOiBbdGhyZXNob2xkXTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyZXNob2xkID0gWzBdO1xuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhyZXNob2xkLmxlbmd0aDsgaSsrKSB7XG4gICAgICBkZXYoKS5hc3NlcnQoaXNGaW5pdGVOdW1iZXIodGhyZXNob2xkW2ldKSwgJ1RocmVzaG9sZCBzaG91bGQgYmUgYSAnICtcbiAgICAgICAgICAnZmluaXRlIG51bWJlciBvciBhbiBhcnJheSBvZiBmaW5pdGUgbnVtYmVycycpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgbGlzdCBvZiB0aHJlc2hvbGQsIHNvcnRlZCBpbiBpbmNyZWFzaW5nIG51bWVyaWMgb3JkZXJcbiAgICAgKiBAcHJpdmF0ZSBAY29uc3QgeyFBcnJheX1cbiAgICAgKi9cbiAgICB0aGlzLnRocmVzaG9sZF8gPSB0aHJlc2hvbGQuc29ydCgpO1xuICAgIGRldigpLmFzc2VydCh0aGlzLnRocmVzaG9sZF9bMF0gPj0gMCAmJlxuICAgICAgICB0aGlzLnRocmVzaG9sZF9bdGhpcy50aHJlc2hvbGRfLmxlbmd0aCAtIDFdIDw9IDEsXG4gICAgJ1RocmVzaG9sZCBzaG91bGQgYmUgaW4gdGhlIHJhbmdlIGZyb20gXCJbMCwgMV1cIicpO1xuXG4gICAgLyoqIEBwcml2YXRlIHs/Li9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmfSAqL1xuICAgIHRoaXMubGFzdFZpZXdwb3J0UmVjdF8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHsuL2xheW91dC1yZWN0LkxheW91dFJlY3REZWZ8dW5kZWZpbmVkfSAqL1xuICAgIHRoaXMubGFzdElmcmFtZVJlY3RfID0gdW5kZWZpbmVkO1xuXG4gICAgLyoqXG4gICAgICogU3RvcmUgYSBsaXN0IG9mIG9ic2VydmVkIGVsZW1lbnRzIGFuZCB0aGVpciBjdXJyZW50IHRocmVzaG9sZCBzbG90IHdoaWNoXG4gICAgICogdGhlaXIgaW50ZXJzZWN0aW9uIHJhdGlvIGZpbGxzLCByYW5nZSBmcm9tIFswLCB0aGlzLnRocmVzaG9sZF8ubGVuZ3RoXVxuICAgICAqIEBwcml2YXRlIHtBcnJheTwhRWxlbWVudEludGVyc2VjdGlvblN0YXRlRGVmPn1cbiAgICAgKi9cbiAgICB0aGlzLm9ic2VydmVFbnRyaWVzXyA9IFtdO1xuICB9XG5cbiAgLyoqXG4gICAqL1xuICBkaXNjb25uZWN0KCkge1xuICAgIHRoaXMub2JzZXJ2ZUVudHJpZXNfLmxlbmd0aCA9IDA7XG4gIH1cblxuICAvKipcbiAgICogUHJvdmlkZSBhIHdheSB0byBvYnNlcnZlIHRoZSBpbnRlcnNlY3Rpb24gY2hhbmdlIGZvciBhIHNwZWNpZmljIGVsZW1lbnRcbiAgICogUGxlYXNlIG5vdGUgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJQb2x5ZmlsbCBvbmx5IHN1cHBvcnQgQU1QIGVsZW1lbnQgbm93XG4gICAqIFRPRE86IFN1cHBvcnQgbm9uIEFNUCBlbGVtZW50XG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAgICovXG4gIG9ic2VydmUoZWxlbWVudCkge1xuICAgIC8vIENoZWNrIHRoZSBlbGVtZW50IGlzIGFuIEFNUCBlbGVtZW50LlxuICAgIGRldigpLmFzc2VydChlbGVtZW50LmdldExheW91dEJveCk7XG5cbiAgICAvLyBJZiB0aGUgZWxlbWVudCBhbHJlYWR5IGV4aXN0cyBpbiBjdXJyZW50IG9ic2VydmVFbnRyaWVzLCBkbyBub3RoaW5nXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm9ic2VydmVFbnRyaWVzXy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMub2JzZXJ2ZUVudHJpZXNfW2ldLmVsZW1lbnQgPT09IGVsZW1lbnQpIHtcbiAgICAgICAgZGV2KCkud2FybihUQUcsICdzaG91bGQgb2JzZXJ2ZSBzYW1lIGVsZW1lbnQgb25jZScpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgbmV3U3RhdGUgPSB7XG4gICAgICBlbGVtZW50LFxuICAgICAgY3VycmVudFRocmVzaG9sZFNsb3Q6IDAsXG4gICAgfTtcblxuICAgIC8vIEdldCB0aGUgbmV3IG9ic2VydmVkIGVsZW1lbnQncyBmaXJzdCBjaGFuZ2VFbnRyeSBiYXNlZCBvbiBsYXN0IHZpZXdwb3J0XG4gICAgaWYgKHRoaXMubGFzdFZpZXdwb3J0UmVjdF8pIHtcbiAgICAgIGNvbnN0IGNoYW5nZSA9IHRoaXMuZ2V0VmFsaWRJbnRlcnNlY3Rpb25DaGFuZ2VFbnRyeV8oXG4gICAgICAgICAgbmV3U3RhdGUsIHRoaXMubGFzdFZpZXdwb3J0UmVjdF8sIHRoaXMubGFzdElmcmFtZVJlY3RfKTtcbiAgICAgIGlmIChjaGFuZ2UpIHtcbiAgICAgICAgdGhpcy5jYWxsYmFja18oW2NoYW5nZV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIHB1c2ggbmV3IG9ic2VydmVkIGVsZW1lbnRcbiAgICB0aGlzLm9ic2VydmVFbnRyaWVzXy5wdXNoKG5ld1N0YXRlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm92aWRlIGEgd2F5IHRvIHVub2JzZXJ2ZSBpbnRlcnNlY3Rpb24gY2hhbmdlIGZvciBhIHNwZWNpZmllZCBlbGVtZW50XG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAgICovXG4gIHVub2JzZXJ2ZShlbGVtZW50KSB7XG4gICAgLy8gZmluZCB0aGUgdW5vYnNlcnZlZCBlbGVtZW50IGluIG9ic2VydmVFbnRyaWVzXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm9ic2VydmVFbnRyaWVzXy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMub2JzZXJ2ZUVudHJpZXNfW2ldLmVsZW1lbnQgPT09IGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5vYnNlcnZlRW50cmllc18uc3BsaWNlKGksIDEpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIGRldigpLndhcm4oVEFHLCAndW5vYnNlcnZlIG5vbi1vYnNlcnZlZCBlbGVtZW50Jyk7XG4gIH1cblxuICAvKipcbiAgICogVGljayBmdW5jdGlvbiB0aGF0IHVwZGF0ZSB0aGUgRE9NUmVjdCBvZiB0aGUgcm9vdCBvZiBvYnNlcnZlZCBlbGVtZW50cy5cbiAgICogQ2FsbGVyIG5lZWRzIHRvIG1ha2Ugc3VyZSB0byBwYXNzIGluIHRoZSBjb3JyZWN0IGNvbnRhaW5lci5cbiAgICogTm90ZTogdGhlIG9wdF9pZnJhbWUgcGFyYW0gaXMgdGhlIGlmcmFtZSBwb3NpdGlvbiByZWxhdGl2ZSB0byB0aGUgaG9zdCBkb2MsXG4gICAqIFRoZSBpZnJhbWUgbXVzdCBiZSBhIG5vbi1zY3JvbGxhYmxlIGlmcmFtZS5cbiAgICogQHBhcmFtIHshLi9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmfSBob3N0Vmlld3BvcnRcbiAgICogQHBhcmFtIHsuL2xheW91dC1yZWN0LkxheW91dFJlY3REZWY9fSBvcHRfaWZyYW1lXG4gICAqL1xuICB0aWNrKGhvc3RWaWV3cG9ydCwgb3B0X2lmcmFtZSkge1xuXG4gICAgaWYgKG9wdF9pZnJhbWUpIHtcbiAgICAgIC8vIElmIGVsZW1lbnQgaW5zaWRlIGFuIGlmcmFtZS4gQWRqdXN0IG9yaWdpbiB0byB0aGUgaWZyYW1lLmxlZnQvdG9wLlxuICAgICAgaG9zdFZpZXdwb3J0ID1cbiAgICAgICAgICBtb3ZlTGF5b3V0UmVjdChob3N0Vmlld3BvcnQsIC1vcHRfaWZyYW1lLmxlZnQsIC1vcHRfaWZyYW1lLnRvcCk7XG4gICAgICBvcHRfaWZyYW1lID1cbiAgICAgICAgICBtb3ZlTGF5b3V0UmVjdChvcHRfaWZyYW1lLCAtb3B0X2lmcmFtZS5sZWZ0LCAtb3B0X2lmcmFtZS50b3ApO1xuICAgIH1cblxuICAgIHRoaXMubGFzdFZpZXdwb3J0UmVjdF8gPSBob3N0Vmlld3BvcnQ7XG4gICAgdGhpcy5sYXN0SWZyYW1lUmVjdF8gPSBvcHRfaWZyYW1lO1xuXG4gICAgY29uc3QgY2hhbmdlcyA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm9ic2VydmVFbnRyaWVzXy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgY2hhbmdlID0gdGhpcy5nZXRWYWxpZEludGVyc2VjdGlvbkNoYW5nZUVudHJ5XyhcbiAgICAgICAgICB0aGlzLm9ic2VydmVFbnRyaWVzX1tpXSwgaG9zdFZpZXdwb3J0LCBvcHRfaWZyYW1lKTtcbiAgICAgIGlmIChjaGFuZ2UpIHtcbiAgICAgICAgY2hhbmdlcy5wdXNoKGNoYW5nZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNoYW5nZXMubGVuZ3RoKSB7XG4gICAgICB0aGlzLmNhbGxiYWNrXyhjaGFuZ2VzKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIGEgY2hhbmdlIGVudHJ5IGZvciBvbmUgZWxlbWVudCB0aGF0IHNob3VsZCBiZSBjb21wYXRpYmxlIHdpdGhcbiAgICogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeSBpZiBpdCdzIHZhbGlkIHdpdGggY3VycmVudCBjb25maWcuXG4gICAqIFdoZW4gdGhlIG5ldyBpbnRlcnNlY3Rpb24gcmF0aW8gZG9lc24ndCBjcm9zcyBvbmUgb2YgYSB0aHJlc2hvbGQgdmFsdWUsXG4gICAqIHRoZSBmdW5jdGlvbiB3aWxsIHJldHVybiBudWxsLlxuICAgKlxuICAgKiBAcGFyYW0geyFFbGVtZW50SW50ZXJzZWN0aW9uU3RhdGVEZWZ9IHN0YXRlXG4gICAqIEBwYXJhbSB7IS4vbGF5b3V0LXJlY3QuTGF5b3V0UmVjdERlZn0gaG9zdFZpZXdwb3J0IGhvc3RWaWV3cG9ydCdzIHJlY3RcbiAgICogQHBhcmFtIHsuL2xheW91dC1yZWN0LkxheW91dFJlY3REZWY9fSBvcHRfaWZyYW1lIGlmcmFtZSBjb250YWluZXIgcmVjdFxuICAgKiBAcmV0dXJuIHs/SW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeX0gQSB2YWxpZCBjaGFuZ2UgZW50cnkgb3IgbnVsbCBpZiByYXRpb1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0VmFsaWRJbnRlcnNlY3Rpb25DaGFuZ2VFbnRyeV8oc3RhdGUsIGhvc3RWaWV3cG9ydCwgb3B0X2lmcmFtZSkge1xuICAgIGNvbnN0IHtlbGVtZW50fSA9IHN0YXRlO1xuXG4gICAgLy8gTm9ybWFsaXplIGNvbnRhaW5lciBMYXlvdXRSZWN0IHRvIGJlIHJlbGF0aXZlIHRvIHBhZ2VcbiAgICBsZXQgb3duZXJSZWN0ID0gbnVsbDtcblxuICAgIC8vIElmIG9wdF9pZnJhbWUgaXMgcHJvdmlkZWQsIGFsbCBMYXlvdXRSZWN0IGhhcyBwb3NpdGlvbiByZWxhdGl2ZSB0b1xuICAgIC8vIHRoZSBpZnJhbWUuXG4gICAgLy8gSWYgb3B0X2lmcmFtZSBpcyBub3QgcHJvdmlkZWQsIGFsbCBMYXlvdXRSZWN0IGhhcyBwb3NpdGlvbiByZWxhdGl2ZSB0b1xuICAgIC8vIHRoZSBob3N0IGRvY3VtZW50LlxuICAgIGNvbnN0IGVsZW1lbnRSZWN0ID0gZWxlbWVudC5nZXRMYXlvdXRCb3goKTtcbiAgICBjb25zdCBvd25lciA9IGVsZW1lbnQuZ2V0T3duZXIoKTtcbiAgICBvd25lclJlY3QgPSBvd25lciAmJiBvd25lci5nZXRMYXlvdXRCb3goKTtcblxuICAgIC8vIGNhbGN1bGF0ZSBpbnRlcnNlY3Rpb25SZWN0LiB0aGF0IHRoZSBlbGVtZW50IGludGVyc2VjdHMgd2l0aCBob3N0Vmlld3BvcnRcbiAgICAvLyBhbmQgaW50ZXJzZWN0cyB3aXRoIG93bmVyIGVsZW1lbnQgYW5kIGNvbnRhaW5lciBpZnJhbWUgaWYgZXhpc3RzLlxuICAgIGNvbnN0IGludGVyc2VjdGlvblJlY3QgPVxuICAgICAgICByZWN0SW50ZXJzZWN0aW9uKGVsZW1lbnRSZWN0LCBvd25lclJlY3QsIGhvc3RWaWV3cG9ydCwgb3B0X2lmcmFtZSkgfHxcbiAgICAgICAgbGF5b3V0UmVjdEx0d2goMCwgMCwgMCwgMCk7XG4gICAgLy8gY2FsY3VsYXRlIHJhdGlvLCBjYWxsIGNhbGxiYWNrIGJhc2VkIG9uIG5ldyByYXRpbyB2YWx1ZS5cbiAgICBjb25zdCByYXRpbyA9IGludGVyc2VjdGlvblJhdGlvKGludGVyc2VjdGlvblJlY3QsIGVsZW1lbnRSZWN0KTtcbiAgICBjb25zdCBuZXdUaHJlc2hvbGRTbG90ID0gZ2V0VGhyZXNob2xkU2xvdCh0aGlzLnRocmVzaG9sZF8sIHJhdGlvKTtcblxuICAgIGlmIChuZXdUaHJlc2hvbGRTbG90ID09IHN0YXRlLmN1cnJlbnRUaHJlc2hvbGRTbG90KSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgc3RhdGUuY3VycmVudFRocmVzaG9sZFNsb3QgPSBuZXdUaHJlc2hvbGRTbG90O1xuXG4gICAgLy8gVG8gZ2V0IHNhbWUgYmVoYXZpb3IgYXMgbmF0aXZlIEludGVyc2VjdGlvbk9ic2VydmVyIHNldCBob3N0Vmlld3BvcnQgbnVsbFxuICAgIC8vIGlmIGluc2lkZSBhbiBpZnJhbWVcbiAgICBjb25zdCBjaGFuZ2VFbnRyeSA9IGNhbGN1bGF0ZUNoYW5nZUVudHJ5KGVsZW1lbnRSZWN0LFxuICAgICAgICAob3B0X2lmcmFtZSA/IG51bGwgOiBob3N0Vmlld3BvcnQpLCBpbnRlcnNlY3Rpb25SZWN0LCByYXRpbyk7XG4gICAgY2hhbmdlRW50cnkudGFyZ2V0ID0gZWxlbWVudDtcbiAgICByZXR1cm4gY2hhbmdlRW50cnk7XG4gIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSByYXRpbyBvZiB0aGUgc21hbGxlciBib3gncyBhcmVhIHRvIHRoZSBsYXJnZXIgYm94J3MgYXJlYS5cbiAqIEBwYXJhbSB7IS4vbGF5b3V0LXJlY3QuTGF5b3V0UmVjdERlZn0gc21hbGxlclxuICogQHBhcmFtIHshLi9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmfSBsYXJnZXJcbiAqIEByZXR1cm4ge251bWJlcn1cbiAqL1xuZnVuY3Rpb24gaW50ZXJzZWN0aW9uUmF0aW8oc21hbGxlciwgbGFyZ2VyKSB7XG4gIHJldHVybiAoc21hbGxlci53aWR0aCAqIHNtYWxsZXIuaGVpZ2h0KSAvIChsYXJnZXIud2lkdGggKiBsYXJnZXIuaGVpZ2h0KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBzbG90IG51bWJlciB0aGF0IHRoZSBjdXJyZW50IHJhdGlvIGZpbGxzIGluLlxuICogQHBhcmFtIHshQXJyYXl9IHNvcnRlZFRocmVzaG9sZCB2YWxpZCBzb3J0ZWQgSW9CIHRocmVzaG9sZFxuICogQHBhcmFtIHtudW1iZXJ9IHJhdGlvIFJhbmdlIGZyb20gWzAsIDFdXG4gKiBAcmV0dXJuIHtudW1iZXJ9IFJhbmdlIGZyb20gWzAsIHRocmVzaG9sZC5sZW5ndGhdXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRocmVzaG9sZFNsb3Qoc29ydGVkVGhyZXNob2xkLCByYXRpbykge1xuICBsZXQgc3RhcnRJZHggPSAwO1xuICBsZXQgZW5kSWR4ID0gc29ydGVkVGhyZXNob2xkLmxlbmd0aDtcbiAgLy8gMCBpcyBhIHNwZWNpYWwgY2FzZSB0aGF0IGRvZXMgbm90IGZpdCBpbnRvIFtzbWFsbCwgbGFyZ2UpIHJhbmdlXG4gIGlmIChyYXRpbyA9PSAwKSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cbiAgbGV0IG1pZCA9ICgoc3RhcnRJZHggKyBlbmRJZHgpIC8gMikgfCAwO1xuICB3aGlsZSAoc3RhcnRJZHggPCBtaWQpIHtcbiAgICBjb25zdCBtaWRWYWx1ZSA9IHNvcnRlZFRocmVzaG9sZFttaWRdO1xuICAgIC8vIEluIHRoZSByYW5nZSBvZiBbc21hbGwsIGxhcmdlKVxuICAgIGlmIChyYXRpbyA8IG1pZFZhbHVlKSB7XG4gICAgICBlbmRJZHggPSBtaWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0YXJ0SWR4ID0gbWlkO1xuICAgIH1cbiAgICBtaWQgPSAoKHN0YXJ0SWR4ICsgZW5kSWR4KSAvIDIpIHwgMDtcbiAgfVxuICByZXR1cm4gZW5kSWR4O1xufVxuXG4vKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBjYWxjdWxhdGUgdGhlIEludGVyc2VjdGlvbk9ic2VydmVyIGNoYW5nZSBlbnRyeS5cbiAqIEBwYXJhbSB7IS4vbGF5b3V0LXJlY3QuTGF5b3V0UmVjdERlZn0gZWxlbWVudCBlbGVtZW50J3MgcmVjdFxuICogQHBhcmFtIHs/Li9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmfSBob3N0Vmlld3BvcnQgaG9zdFZpZXdwb3J0J3MgcmVjdFxuICogQHBhcmFtIHshLi9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmfSBpbnRlcnNlY3Rpb25cbiAqIEBwYXJhbSB7bnVtYmVyfSByYXRpb1xuICogQHJldHVybiB7IUludGVyc2VjdGlvbk9ic2VydmVyRW50cnl9fVxuICovXG5mdW5jdGlvbiBjYWxjdWxhdGVDaGFuZ2VFbnRyeShcbiAgZWxlbWVudCwgaG9zdFZpZXdwb3J0LCBpbnRlcnNlY3Rpb24sIHJhdGlvKSB7XG4gIC8vIElmIGVsZW1lbnQgbm90IGluIGFuIGlmcmFtZS5cbiAgLy8gYWRqdXN0IGFsbCBMYXlvdXRSZWN0IHRvIGhvc3RWaWV3cG9ydCBPcmlnaW4uXG4gIGxldCBib3VuZGluZ0NsaWVudFJlY3QgPSBlbGVtZW50O1xuICBsZXQgcm9vdEJvdW5kcyA9IGhvc3RWaWV3cG9ydDtcbiAgLy8gSWYgbm8gaG9zdFZpZXdwb3J0IGlzIHByb3ZpZGVkLCBlbGVtZW50IGlzIGluc2lkZSBhbiBub24tc2Nyb2xsYWJsZSBpZnJhbWUuXG4gIC8vIEV2ZXJ5IExheW91dHJlY3QgaGFzIGFscmVhZHkgYWRqdXN0IHRoZWlyIG9yaWdpbiBhY2NvcmRpbmcgdG8gaWZyYW1lXG4gIC8vIHJlY3Qgb3JpZ2luLiBMYXlvdXRSZWN0IHBvc2l0aW9uIGlzIHJlbGF0aXZlIHRvIGlmcmFtZSBvcmlnaW4sXG4gIC8vIHRodXMgcmVsYXRpdmUgdG8gaWZyYW1lJ3Mgdmlld3BvcnQgb3JpZ2luIGJlY2F1c2UgdGhlIHZpZXdwb3J0IGlzIGF0IHRoZVxuICAvLyBpZnJhbWUgb3JpZ2luLiBObyBuZWVkIHRvIGFkanVzdCBwb3NpdGlvbiBoZXJlLlxuXG4gIGlmIChob3N0Vmlld3BvcnQpIHtcbiAgICAvLyBJZiBlbGVtZW50IG5vdCBpbiBhbiBpZnJhbWUuXG4gICAgLy8gYWRqdXN0IGFsbCBMYXlvdXRSZWN0IHRvIGhvc3RWaWV3cG9ydCBPcmlnaW4uXG4gICAgcm9vdEJvdW5kcyA9IC8qKiBAdHlwZSB7IS4vbGF5b3V0LXJlY3QuTGF5b3V0UmVjdERlZn0gKi8gKHJvb3RCb3VuZHMpO1xuICAgIGludGVyc2VjdGlvbiA9IG1vdmVMYXlvdXRSZWN0KGludGVyc2VjdGlvbiwgLWhvc3RWaWV3cG9ydC5sZWZ0LFxuICAgICAgICAtaG9zdFZpZXdwb3J0LnRvcCk7XG4gICAgLy8gVGhlIGVsZW1lbnQgaXMgcmVsYXRpdmUgdG8gKDAsIDApLCB3aGlsZSB0aGUgdmlld3BvcnQgbW92ZXMuIFNvLCB3ZSBtdXN0XG4gICAgLy8gYWRqdXN0LlxuICAgIGJvdW5kaW5nQ2xpZW50UmVjdCA9IG1vdmVMYXlvdXRSZWN0KGJvdW5kaW5nQ2xpZW50UmVjdCxcbiAgICAgICAgLWhvc3RWaWV3cG9ydC5sZWZ0LCAtaG9zdFZpZXdwb3J0LnRvcCk7XG4gICAgLy8gTm93LCBtb3ZlIHRoZSB2aWV3cG9ydCB0byAoMCwgMClcbiAgICByb290Qm91bmRzID0gbW92ZUxheW91dFJlY3Qocm9vdEJvdW5kcyxcbiAgICAgICAgLWhvc3RWaWV3cG9ydC5sZWZ0LCAtaG9zdFZpZXdwb3J0LnRvcCk7XG4gIH1cblxuICByZXR1cm4gLyoqIEB0eXBlIHshSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeX0gKi8gKHtcbiAgICB0aW1lOiAodHlwZW9mIHBlcmZvcm1hbmNlICE9PSAndW5kZWZpbmVkJyAmJiBwZXJmb3JtYW5jZS5ub3cpID9cbiAgICAgIHBlcmZvcm1hbmNlLm5vdygpIDogRGF0ZS5ub3coKSAtIElOSVRfVElNRSxcbiAgICByb290Qm91bmRzLFxuICAgIGJvdW5kaW5nQ2xpZW50UmVjdCxcbiAgICBpbnRlcnNlY3Rpb25SZWN0OiBpbnRlcnNlY3Rpb24sXG4gICAgaW50ZXJzZWN0aW9uUmF0aW86IHJhdGlvLFxuICB9KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgVGhpcyBtb2R1bGUgZGVjbGFyZXMgSlNPTiB0eXBlcyBhcyBkZWZpbmVkIGluIHRoZVxuICoge0BsaW5rIGh0dHA6Ly9qc29uLm9yZy99LlxuICovXG5cbmltcG9ydCB7aXNPYmplY3R9IGZyb20gJy4vdHlwZXMnO1xuXG5cbi8vIE5PVEUgVHlwZSBhcmUgY2hhbmdlZCB0byB7Kn0gYmVjYXVzZSBvZlxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9jbG9zdXJlLWNvbXBpbGVyL2lzc3Vlcy8xOTk5XG5cbi8qKlxuICogSlNPTiBzY2FsYXIuIEl0J3MgZWl0aGVyIHN0cmluZywgbnVtYmVyIG9yIGJvb2xlYW4uXG4gKiBAdHlwZWRlZiB7Kn0gc2hvdWxkIGJlIHN0cmluZ3xudW1iZXJ8Ym9vbGVhblxuICovXG5sZXQgSlNPTlNjYWxhckRlZjtcblxuXG4vKipcbiAqIEpTT04gb2JqZWN0LiBJdCdzIGEgbWFwIHdpdGggc3RyaW5nIGtleXMgYW5kIEpTT04gdmFsdWVzLlxuICogQHR5cGVkZWYgeyp9IHNob3VsZCBiZSAhT2JqZWN0PHN0cmluZywgP0pTT05WYWx1ZURlZj5cbiAqL1xubGV0IEpTT05PYmplY3REZWY7XG5cblxuLyoqXG4gKiBKU09OIGFycmF5LiBJdCdzIGFuIGFycmF5IHdpdGggSlNPTiB2YWx1ZXMuXG4gKiBAdHlwZWRlZiB7Kn0gc2hvdWxkIGJlICFBcnJheTw/SlNPTlZhbHVlRGVmPlxuICovXG5sZXQgSlNPTkFycmF5RGVmO1xuXG5cbi8qKlxuICogSlNPTiB2YWx1ZS4gSXQncyBlaXRoZXIgYSBzY2FsYXIsIGFuIG9iamVjdCBvciBhbiBhcnJheS5cbiAqIEB0eXBlZGVmIHsqfSBzaG91bGQgYmUgIUpTT05TY2FsYXJEZWZ8IUpTT05PYmplY3REZWZ8IUpTT05BcnJheURlZlxuICovXG5sZXQgSlNPTlZhbHVlRGVmO1xuXG4vKipcbiAqIFJlY3JlYXRlcyBvYmplY3RzIHdpdGggcHJvdG90eXBlLWxlc3MgY29waWVzLlxuICogQHBhcmFtIHshSnNvbk9iamVjdH0gb2JqXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlY3JlYXRlTm9uUHJvdG9PYmplY3Qob2JqKSB7XG4gIGNvbnN0IGNvcHkgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBmb3IgKGNvbnN0IGsgaW4gb2JqKSB7XG4gICAgaWYgKCFoYXNPd25Qcm9wZXJ0eShvYmosIGspKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3QgdiA9IG9ialtrXTtcbiAgICBjb3B5W2tdID0gaXNPYmplY3QodikgPyByZWNyZWF0ZU5vblByb3RvT2JqZWN0KHYpIDogdjtcbiAgfVxuICByZXR1cm4gLyoqIEB0eXBlIHshSnNvbk9iamVjdH0gKi8gKGNvcHkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmcm9tIGFuIG9iamVjdCBmb3IgYSBmaWVsZC1iYXNlZCBleHByZXNzaW9uLiBUaGUgZXhwcmVzc2lvblxuICogaXMgYSBzaW1wbGUgbmVzdGVkIGRvdC1ub3RhdGlvbiBvZiBmaWVsZHMsIHN1Y2ggYXMgYGZpZWxkMS5maWVsZDJgLiBJZiBhbnlcbiAqIGZpZWxkIGluIGEgY2hhaW4gZG9lcyBub3QgZXhpc3Qgb3IgaXMgbm90IGFuIG9iamVjdCBvciBhcnJheSwgdGhlIHJldHVybmVkXG4gKiB2YWx1ZSB3aWxsIGJlIGB1bmRlZmluZWRgLlxuICpcbiAqIEBwYXJhbSB7IUpzb25PYmplY3R9IG9ialxuICogQHBhcmFtIHtzdHJpbmd9IGV4cHJcbiAqIEByZXR1cm4geyp9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRWYWx1ZUZvckV4cHIob2JqLCBleHByKSB7XG4gIC8vIFRoZSBgLmAgaW5kaWNhdGVzIFwidGhlIG9iamVjdCBpdHNlbGZcIi5cbiAgaWYgKGV4cHIgPT0gJy4nKSB7XG4gICAgcmV0dXJuIG9iajtcbiAgfVxuICAvLyBPdGhlcndpc2UsIG5hdmlnYXRlIHZpYSBwcm9wZXJ0aWVzLlxuICBjb25zdCBwYXJ0cyA9IGV4cHIuc3BsaXQoJy4nKTtcbiAgbGV0IHZhbHVlID0gb2JqO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgcGFydCA9IHBhcnRzW2ldO1xuICAgIGlmIChwYXJ0ICYmXG4gICAgICAgIHZhbHVlICYmXG4gICAgICAgIHZhbHVlW3BhcnRdICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgaGFzT3duUHJvcGVydHkodmFsdWUsIHBhcnQpXG4gICAgKSB7XG4gICAgICB2YWx1ZSA9IHZhbHVlW3BhcnRdO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHZhbHVlID0gdW5kZWZpbmVkO1xuICAgIGJyZWFrO1xuICB9XG4gIHJldHVybiB2YWx1ZTtcbn1cblxuLyoqXG4gKiBTaW1wbGUgd3JhcHBlciBhcm91bmQgSlNPTi5wYXJzZSB0aGF0IGNhc3RzIHRoZSByZXR1cm4gdmFsdWVcbiAqIHRvIEpzb25PYmplY3QuXG4gKiBDcmVhdGUgYSBuZXcgd3JhcHBlciBpZiBhbiBhcnJheSByZXR1cm4gdmFsdWUgaXMgZGVzaXJlZC5cbiAqIEBwYXJhbSB7Kn0ganNvbiBKU09OIHN0cmluZyB0byBwYXJzZVxuICogQHJldHVybiB7P0pzb25PYmplY3R9IE1heSBiZSBleHRlbmQgdG8gcGFyc2UgYXJyYXlzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VKc29uKGpzb24pIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7P0pzb25PYmplY3R9ICovKEpTT04ucGFyc2UoLyoqIEB0eXBlIHtzdHJpbmd9ICovIChqc29uKSkpO1xufVxuXG4vKipcbiAqIFBhcnNlcyB0aGUgZ2l2ZW4gYGpzb25gIHN0cmluZyB3aXRob3V0IHRocm93aW5nIGFuIGV4Y2VwdGlvbiBpZiBub3QgdmFsaWQuXG4gKiBSZXR1cm5zIGB1bmRlZmluZWRgIGlmIHBhcnNpbmcgZmFpbHMuXG4gKiBSZXR1cm5zIHRoZSBgT2JqZWN0YCBjb3JyZXNwb25kaW5nIHRvIHRoZSBKU09OIHN0cmluZyB3aGVuIHBhcnNpbmcgc3VjY2VlZHMuXG4gKiBAcGFyYW0geyp9IGpzb24gSlNPTiBzdHJpbmcgdG8gcGFyc2VcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVycm9yKT19IG9wdF9vbkZhaWxlZCBPcHRpb25hbCBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkXG4gKiAgICAgd2l0aCB0aGUgZXJyb3IgaWYgcGFyc2luZyBmYWlscy5cbiAqIEByZXR1cm4gez9Kc29uT2JqZWN0fHVuZGVmaW5lZH0gTWF5IGJlIGV4dGVuZCB0byBwYXJzZSBhcnJheXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnlQYXJzZUpzb24oanNvbiwgb3B0X29uRmFpbGVkKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHBhcnNlSnNvbihqc29uKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGlmIChvcHRfb25GYWlsZWQpIHtcbiAgICAgIG9wdF9vbkZhaWxlZChlKTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG4vKipcbiAqIFJlY3Vyc2l2ZWx5IGNoZWNrcyBzdHJpY3QgZXF1YWxpdHkgb2YgaXRlbXMgaW4gbmVzdGVkIGFycmF5cyBhbmQgb2JqZWN0cy5cbiAqXG4gKiBAcGFyYW0ge0pTT05WYWx1ZURlZn0gYVxuICogQHBhcmFtIHtKU09OVmFsdWVEZWZ9IGJcbiAqIEBwYXJhbSB7bnVtYmVyfSBkZXB0aCBUaGUgbWF4aW11bSByZWN1cnNpb24gZGVwdGguIE11c3QgYmUgZmluaXRlLlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBkZXB0aCBhcmd1bWVudCBpcyBub3QgZmluaXRlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVjdXJzaXZlRXF1YWxzKGEsIGIsIGRlcHRoID0gMykge1xuICBpZiAoIWlzRmluaXRlKGRlcHRoKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignZGVwdGggYXJnIG11c3QgYmUgZmluaXRlOiAnICsgZGVwdGgpO1xuICB9XG4gIGlmIChhID09PSBiKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgLy8gT25seSBjaGVjayBzaGFsbG93IGVxdWFsaXR5IGZvciBkZXB0aCA8IDEuXG4gIGlmIChkZXB0aCA8IDEpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgaWYgKHR5cGVvZiBhICE9PSB0eXBlb2YgYikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBpZiAoQXJyYXkuaXNBcnJheShhKSAmJiBBcnJheS5pc0FycmF5KGIpKSB7XG4gICAgaWYgKGEubGVuZ3RoICE9PSBiLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghcmVjdXJzaXZlRXF1YWxzKGFbaV0sIGJbaV0sIGRlcHRoIC0gMSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAoYSAmJiBiICYmIHR5cGVvZiBhID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgYiA9PT0gJ29iamVjdCcpIHtcbiAgICBjb25zdCBrZXlzQSA9IE9iamVjdC5rZXlzKC8qKiBAdHlwZSB7IU9iamVjdH0gKi8gKGEpKTtcbiAgICBjb25zdCBrZXlzQiA9IE9iamVjdC5rZXlzKC8qKiBAdHlwZSB7IU9iamVjdH0gKi8gKGIpKTtcbiAgICBpZiAoa2V5c0EubGVuZ3RoICE9PSBrZXlzQi5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzQS5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qga2V5QSA9IGtleXNBW2ldO1xuICAgICAgY29uc3QgdmFsdWVBID0gYVtrZXlBXTtcbiAgICAgIGNvbnN0IHZhbHVlQiA9IGJba2V5QV07XG4gICAgICBpZiAoIXJlY3Vyc2l2ZUVxdWFscyh2YWx1ZUEsIHZhbHVlQiwgZGVwdGggLSAxKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7Kn0gb2JqXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBoYXNPd25Qcm9wZXJ0eShvYmosIGtleSkge1xuICBpZiAob2JqID09IG51bGwgfHwgdHlwZW9mIG9iaiAhPSAnb2JqZWN0Jykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKFxuICAgICAgLyoqIEB0eXBlIHshT2JqZWN0fSAqLyAob2JqKSwga2V5KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogVGhlIHN0cnVjdHVyZSB0aGF0IGNvbWJpbmVzIHBvc2l0aW9uIGFuZCBzaXplIGZvciBhbiBlbGVtZW50LiBUaGUgZXhhY3RcbiAqIGludGVycHJldGF0aW9uIG9mIHBvc2l0aW9uIGFuZCBzaXplIGRlcGVuZHMgb24gdGhlIHVzZSBjYXNlLlxuICpcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHRvcDogbnVtYmVyLFxuICogICBib3R0b206IG51bWJlcixcbiAqICAgbGVmdDogbnVtYmVyLFxuICogICByaWdodDogbnVtYmVyLFxuICogICB3aWR0aDogbnVtYmVyLFxuICogICBoZWlnaHQ6IG51bWJlcixcbiAqICAgeDogbnVtYmVyLFxuICogICB5OiBudW1iZXJcbiAqIH19XG4gKi9cbmV4cG9ydCBsZXQgTGF5b3V0UmVjdERlZjtcblxuXG4vKipcbiAqIFRoZSBzdHJ1Y3R1cmUgdGhhdCByZXByZXNlbnRzIHRoZSBtYXJnaW5zIG9mIGFuIEVsZW1lbnQuXG4gKlxuICogQHR5cGVkZWYge3tcbiAqICAgdG9wOiBudW1iZXIsXG4gKiAgIHJpZ2h0OiBudW1iZXIsXG4gKiAgIGJvdHRvbTogbnVtYmVyLFxuICogICBsZWZ0OiBudW1iZXJcbiAqIH19XG4gKi9cbmV4cG9ydCBsZXQgTGF5b3V0TWFyZ2luc0RlZjtcblxuXG4vKipcbiAqIFRoZSBzdHJ1Y3R1cmUgdGhhdCByZXByZXNlbnRzIGEgcmVxdWVzdGVkIGNoYW5nZSB0byB0aGUgbWFyZ2lucyBvZiBhblxuICogRWxlbWVudC4gQW55IG5ldyB2YWx1ZXMgc3BlY2lmaWVkIHdpbGwgcmVwbGFjZSBleGlzdGluZyBvbmVzIChyYXRoZXIgdGhhblxuICogYmVpbmcgYWRkaXRpdmUpLlxuICpcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHRvcDogKG51bWJlcnx1bmRlZmluZWQpLFxuICogICByaWdodDogKG51bWJlcnx1bmRlZmluZWQpLFxuICogICBib3R0b206IChudW1iZXJ8dW5kZWZpbmVkKSxcbiAqICAgbGVmdDogKG51bWJlcnx1bmRlZmluZWQpXG4gKiB9fVxuICovXG5leHBvcnQgbGV0IExheW91dE1hcmdpbnNDaGFuZ2VEZWY7XG5cbi8qKlxuKiBSZWxhdGl2ZVBvc2l0aW9uc1xuKlxuKiBEZXNjcmliZXMgdGhlIHJlbGF0aXZlIHBvc2l0aW9uIG9mIGFuIGVsZW1lbnQgdG8gYW5vdGhlciAod2hldGhlciB0aGVcbiogZmlyc3QgaXMgaW5zaWRlIHRoZSBzZWNvbmQsIG9uIHRvcCBvZiB0aGUgc2Vjb25kIG9yIG9uIHRoZSBib3R0b21cbiogQGVudW0ge3N0cmluZ31cbiovXG5leHBvcnQgY29uc3QgUmVsYXRpdmVQb3NpdGlvbnMgPSB7XG4gIElOU0lERTogJ2luc2lkZScsXG4gIFRPUDogJ3RvcCcsXG4gIEJPVFRPTTogJ2JvdHRvbScsXG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBsYXlvdXQgcmVjdCBiYXNlZCBvbiB0aGUgbGVmdCwgdG9wLCB3aWR0aCBhbmQgaGVpZ2h0IHBhcmFtZXRlcnNcbiAqIGluIHRoYXQgb3JkZXIuXG4gKiBAcGFyYW0ge251bWJlcn0gbGVmdFxuICogQHBhcmFtIHtudW1iZXJ9IHRvcFxuICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoXG4gKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0XG4gKiBAcmV0dXJuIHshTGF5b3V0UmVjdERlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxheW91dFJlY3RMdHdoKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkge1xuICByZXR1cm4ge1xuICAgIGxlZnQsXG4gICAgdG9wLFxuICAgIHdpZHRoLFxuICAgIGhlaWdodCxcbiAgICBib3R0b206IHRvcCArIGhlaWdodCxcbiAgICByaWdodDogbGVmdCArIHdpZHRoLFxuICAgIHg6IGxlZnQsXG4gICAgeTogdG9wLFxuICB9O1xufVxuXG5cbi8qKlxuICogQ3JlYXRlcyBhIGxheW91dCByZWN0IGJhc2VkIG9uIHRoZSBET01SZWN0LCBlLmcuIG9idGFpbmVkIGZyb20gY2FsbGluZ1xuICogZ2V0Qm91bmRpbmdDbGllbnRSZWN0LlxuICogQHBhcmFtIHshQ2xpZW50UmVjdH0gcmVjdFxuICogQHJldHVybiB7IUxheW91dFJlY3REZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXlvdXRSZWN0RnJvbURvbVJlY3QocmVjdCkge1xuICByZXR1cm4gbGF5b3V0UmVjdEx0d2goTnVtYmVyKHJlY3QubGVmdCksIE51bWJlcihyZWN0LnRvcCksXG4gICAgICBOdW1iZXIocmVjdC53aWR0aCksIE51bWJlcihyZWN0LmhlaWdodCkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgc3BlY2lmaWVkIHR3byByZWN0cyBvdmVybGFwIGJ5IGEgc2luZ2xlIHBpeGVsLlxuICogQHBhcmFtIHshTGF5b3V0UmVjdERlZn0gcjFcbiAqIEBwYXJhbSB7IUxheW91dFJlY3REZWZ9IHIyXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGF5b3V0UmVjdHNPdmVybGFwKHIxLCByMikge1xuICByZXR1cm4gKHIxLnRvcCA8PSByMi5ib3R0b20gJiYgcjIudG9wIDw9IHIxLmJvdHRvbSAmJlxuICAgICAgcjEubGVmdCA8PSByMi5yaWdodCAmJiByMi5sZWZ0IDw9IHIxLnJpZ2h0KTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIGludGVyc2VjdGlvbiBiZXR3ZWVuIGEsIGIgb3IgbnVsbCBpZiB0aGVyZSBpcyBub25lLlxuICogQHBhcmFtIHsuLi4/TGF5b3V0UmVjdERlZnx1bmRlZmluZWR9IHZhcl9hcmdzXG4gKiBAcmV0dXJuIHs/TGF5b3V0UmVjdERlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlY3RJbnRlcnNlY3Rpb24odmFyX2FyZ3MpIHtcbiAgbGV0IHgwID0gLUluZmluaXR5O1xuICBsZXQgeDEgPSBJbmZpbml0eTtcbiAgbGV0IHkwID0gLUluZmluaXR5O1xuICBsZXQgeTEgPSBJbmZpbml0eTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBjdXJyZW50ID0gYXJndW1lbnRzW2ldO1xuICAgIGlmICghY3VycmVudCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHgwID0gTWF0aC5tYXgoeDAsIGN1cnJlbnQubGVmdCk7XG4gICAgeDEgPSBNYXRoLm1pbih4MSwgY3VycmVudC5sZWZ0ICsgY3VycmVudC53aWR0aCk7XG4gICAgeTAgPSBNYXRoLm1heCh5MCwgY3VycmVudC50b3ApO1xuICAgIHkxID0gTWF0aC5taW4oeTEsIGN1cnJlbnQudG9wICsgY3VycmVudC5oZWlnaHQpO1xuICAgIGlmICh4MSA8IHgwIHx8IHkxIDwgeTApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuICBpZiAoeDEgPT0gSW5maW5pdHkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICByZXR1cm4gbGF5b3V0UmVjdEx0d2goeDAsIHkwLCB4MSAtIHgwLCB5MSAtIHkwKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwb3NpdGlvbiBvZiByMiByZWxhdGl2ZSB0byByMVxuICogQHBhcmFtIHshTGF5b3V0UmVjdERlZn0gcjFcbiAqIEBwYXJhbSB7IUxheW91dFJlY3REZWZ9IHIyXG4gKiBAcmV0dXJuIHtSZWxhdGl2ZVBvc2l0aW9uc31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxheW91dFJlY3RzUmVsYXRpdmVQb3MocjEsIHIyKSB7XG4gIGlmIChyMS50b3AgPCByMi50b3ApIHtcbiAgICByZXR1cm4gUmVsYXRpdmVQb3NpdGlvbnMuVE9QO1xuICB9IGVsc2UgaWYgKHIxLmJvdHRvbSA+IHIyLmJvdHRvbSkge1xuICAgIHJldHVybiBSZWxhdGl2ZVBvc2l0aW9ucy5CT1RUT007XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIFJlbGF0aXZlUG9zaXRpb25zLklOU0lERTtcbiAgfVxufVxuXG4vKipcbiAqIEV4cGFuZCB0aGUgbGF5b3V0IHJlY3QgdXNpbmcgbXVsdGlwbGVzIG9mIHdpZHRoIGFuZCBoZWlnaHQuXG4gKiBAcGFyYW0geyFMYXlvdXRSZWN0RGVmfSByZWN0IE9yaWdpbmFsIHJlY3QuXG4gKiBAcGFyYW0ge251bWJlcn0gZHcgRXhwYW5zaW9uIGluIHdpZHRoLCBzcGVjaWZpZWQgYXMgYSBtdWx0aXBsZSBvZiB3aWR0aC5cbiAqIEBwYXJhbSB7bnVtYmVyfSBkaCBFeHBhbnNpb24gaW4gaGVpZ2h0LCBzcGVjaWZpZWQgYXMgYSBtdWx0aXBsZSBvZiBoZWlnaHQuXG4gKiBAcmV0dXJuIHshTGF5b3V0UmVjdERlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4cGFuZExheW91dFJlY3QocmVjdCwgZHcsIGRoKSB7XG4gIHJldHVybiBsYXlvdXRSZWN0THR3aChyZWN0LmxlZnQgLSByZWN0LndpZHRoICogZHcsXG4gICAgICByZWN0LnRvcCAtIHJlY3QuaGVpZ2h0ICogZGgsXG4gICAgICByZWN0LndpZHRoICogKDEgKyBkdyAqIDIpLFxuICAgICAgcmVjdC5oZWlnaHQgKiAoMSArIGRoICogMikpO1xufVxuXG4vKipcbiAqIE1vdmVzIHRoZSBsYXlvdXQgcmVjdCB1c2luZyBkeCBhbmQgZHkuXG4gKiBAcGFyYW0geyFMYXlvdXRSZWN0RGVmfSByZWN0IE9yaWdpbmFsIHJlY3QuXG4gKiBAcGFyYW0ge251bWJlcn0gZHggTW92ZSBob3Jpem9udGFsbHkgd2l0aCB0aGlzIHZhbHVlLlxuICogQHBhcmFtIHtudW1iZXJ9IGR5IE1vdmUgdmVydGljYWxseSB3aXRoIHRoaXMgdmFsdWUuXG4gKiBAcmV0dXJuIHshTGF5b3V0UmVjdERlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1vdmVMYXlvdXRSZWN0KHJlY3QsIGR4LCBkeSkge1xuICBpZiAoKGR4ID09IDAgJiYgZHkgPT0gMCkgfHxcbiAgICAgIChyZWN0LndpZHRoID09IDAgJiYgcmVjdC5oZWlnaHQgPT0gMCkpIHtcbiAgICByZXR1cm4gcmVjdDtcbiAgfVxuICByZXR1cm4gbGF5b3V0UmVjdEx0d2gocmVjdC5sZWZ0ICsgZHgsIHJlY3QudG9wICsgZHksXG4gICAgICByZWN0LndpZHRoLCByZWN0LmhlaWdodCk7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFMYXlvdXRNYXJnaW5zRGVmfSBtYXJnaW5zXG4gKiBAcGFyYW0geyFMYXlvdXRNYXJnaW5zQ2hhbmdlRGVmfSBjaGFuZ2VcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcmVNYXJnaW5zQ2hhbmdlZChtYXJnaW5zLCBjaGFuZ2UpIHtcbiAgcmV0dXJuIChjaGFuZ2UudG9wICE9PSB1bmRlZmluZWQgJiYgY2hhbmdlLnRvcCAhPSBtYXJnaW5zLnRvcCkgfHxcbiAgICAgIChjaGFuZ2UucmlnaHQgIT09IHVuZGVmaW5lZCAmJiBjaGFuZ2UucmlnaHQgIT0gbWFyZ2lucy5yaWdodCkgfHxcbiAgICAgIChjaGFuZ2UuYm90dG9tICE9PSB1bmRlZmluZWQgJiYgY2hhbmdlLmJvdHRvbSAhPSBtYXJnaW5zLmJvdHRvbSkgfHxcbiAgICAgIChjaGFuZ2UubGVmdCAhPT0gdW5kZWZpbmVkICYmIGNoYW5nZS5sZWZ0ICE9IG1hcmdpbnMubGVmdCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHshTGF5b3V0UmVjdERlZn0gZnJvbVxuICogQHBhcmFtIHshTGF5b3V0UmVjdERlZn0gdG9cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXlvdXRSZWN0U2l6ZUVxdWFscyhmcm9tLCB0bykge1xuICByZXR1cm4gZnJvbS53aWR0aCA9PSB0by53aWR0aCAmJlxuICAgICAgZnJvbS5oZWlnaHQgPT09IHRvLmhlaWdodDtcbn1cblxuLyoqXG4gKiBAcGFyYW0gez9MYXlvdXRSZWN0RGVmfSByMVxuICogQHBhcmFtIHs/TGF5b3V0UmVjdERlZn0gcjJcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXlvdXRSZWN0RXF1YWxzKHIxLCByMikge1xuICBpZiAoIXIxIHx8ICFyMikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gcjEubGVmdCA9PSByMi5sZWZ0ICYmIHIxLnRvcCA9PSByMi50b3AgJiZcbiAgICAgIHIxLndpZHRoID09IHIyLndpZHRoICYmIHIxLmhlaWdodCA9PSByMi5oZWlnaHQ7XG59XG5cbi8qKlxuICogQHBhcmFtIHtMYXlvdXRNYXJnaW5zQ2hhbmdlRGVmfHVuZGVmaW5lZH0gbWFyZ2luc0NoYW5nZVxuICogQHJldHVybiB7TGF5b3V0TWFyZ2luc0NoYW5nZURlZnx1bmRlZmluZWR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbG9uZUxheW91dE1hcmdpbnNDaGFuZ2VEZWYobWFyZ2luc0NoYW5nZSkge1xuICBpZiAoIW1hcmdpbnNDaGFuZ2UpIHtcbiAgICByZXR1cm4gbWFyZ2luc0NoYW5nZTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHRvcDogbWFyZ2luc0NoYW5nZS50b3AsXG4gICAgYm90dG9tOiBtYXJnaW5zQ2hhbmdlLmJvdHRvbSxcbiAgICBsZWZ0OiBtYXJnaW5zQ2hhbmdlLmxlZnQsXG4gICAgcmlnaHQ6IG1hcmdpbnNDaGFuZ2UucmlnaHQsXG4gIH07XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IEltcGxlbWVudHMgZWxlbWVudCBsYXlvdXQuIFNlZSBodHRwczovL2dvby5nbC85YXZYdVQgZm9yXG4gKiBkZXRhaWxzLlxuICovXG5cbmltcG9ydCB7ZGV2LCB1c2VyfSBmcm9tICcuL2xvZyc7XG5pbXBvcnQge2h0bWxGb3J9IGZyb20gJy4vc3RhdGljLXRlbXBsYXRlJztcbmltcG9ydCB7aXNGaW5pdGVOdW1iZXJ9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHtzZXRTdHlsZSwgc2V0U3R5bGVzfSBmcm9tICcuL3N0eWxlJztcbmltcG9ydCB7c3RhcnRzV2l0aH0gZnJvbSAnLi9zdHJpbmcnO1xuXG4vKipcbiAqIEBlbnVtIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBjb25zdCBMYXlvdXQgPSB7XG4gIE5PRElTUExBWTogJ25vZGlzcGxheScsXG4gIEZJWEVEOiAnZml4ZWQnLFxuICBGSVhFRF9IRUlHSFQ6ICdmaXhlZC1oZWlnaHQnLFxuICBSRVNQT05TSVZFOiAncmVzcG9uc2l2ZScsXG4gIENPTlRBSU5FUjogJ2NvbnRhaW5lcicsXG4gIEZJTEw6ICdmaWxsJyxcbiAgRkxFWF9JVEVNOiAnZmxleC1pdGVtJyxcbiAgRkxVSUQ6ICdmbHVpZCcsXG4gIElOVFJJTlNJQzogJ2ludHJpbnNpYycsXG59O1xuXG5cbi8qKlxuICogTGF5b3V0IHByaW9yaXRpZXMgdG8gdXNlIHdpdGggQmFzZUVsZW1lbnQjZ2V0TGF5b3V0UHJpb3JpdHkoKSBhbmRcbiAqIEJhc2VFbGVtZW50I3VwZGF0ZUxheW91dFByaW9yaXR5KCkuXG4gKiBAZW51bSB7bnVtYmVyfVxuICovXG5leHBvcnQgY29uc3QgTGF5b3V0UHJpb3JpdHkgPSB7XG4gIENPTlRFTlQ6IDAsXG4gIE1FVEFEQVRBOiAxLFxuICBBRFM6IDIsXG4gIEJBQ0tHUk9VTkQ6IDMsXG59O1xuXG5cbi8qKlxuICogQ1NTIExlbmd0aCB0eXBlLiBFLmcuIFwiMXB4XCIgb3IgXCIyMHZoXCIuXG4gKiBAdHlwZWRlZiB7c3RyaW5nfVxuICovXG5leHBvcnQgbGV0IExlbmd0aERlZjtcblxuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHdpZHRoOiBzdHJpbmcsXG4gKiAgIGhlaWdodDogc3RyaW5nXG4gKiB9fVxuICovXG5sZXQgRGltZW5zaW9uc0RlZjtcblxuXG4vKipcbiAqIFRoZSBzZXQgb2YgZWxlbWVudHMgd2l0aCBuYXR1cmFsIGRpbWVuc2lvbnMsIHRoYXQgaXMsIGVsZW1lbnRzXG4gKiB3aGljaCBoYXZlIGEga25vd24gZGltZW5zaW9uIGVpdGhlciBiYXNlZCBvbiB0aGVpciB2YWx1ZSBzcGVjaWZpZWQgaGVyZSxcbiAqIG9yLCBpZiB0aGUgdmFsdWUgaXMgbnVsbCwgYSBkaW1lbnNpb24gc3BlY2lmaWMgdG8gdGhlIGJyb3dzZXIuXG4gKiBgaGFzTmF0dXJhbERpbWVuc2lvbnNgIGNoZWNrcyBmb3IgbWVtYmVyc2hpcCBpbiB0aGlzIHNldC5cbiAqIGBnZXROYXR1cmFsRGltZW5zaW9uc2AgZGV0ZXJtaW5lcyB0aGUgZGltZW5zaW9ucyBmb3IgYW4gZWxlbWVudCBpbiB0aGVcbiAqICAgIHNldCBhbmQgY2FjaGVzIGl0LlxuICogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCA/RGltZW5zaW9uc0RlZj59XG4gKiBAcHJpdmF0ZSAgVmlzaWJsZSBmb3IgdGVzdGluZyBvbmx5IVxuICovXG5leHBvcnQgY29uc3QgbmF0dXJhbERpbWVuc2lvbnNfID0ge1xuICAnQU1QLVBJWEVMJzoge3dpZHRoOiAnMHB4JywgaGVpZ2h0OiAnMHB4J30sXG4gICdBTVAtQU5BTFlUSUNTJzoge3dpZHRoOiAnMXB4JywgaGVpZ2h0OiAnMXB4J30sXG4gIC8vIFRPRE8oZHZveXRlbmtvKTogYXVkaW8gc2hvdWxkIGhhdmUgd2lkdGg6YXV0by5cbiAgJ0FNUC1BVURJTyc6IG51bGwsXG4gICdBTVAtU09DSUFMLVNIQVJFJzoge3dpZHRoOiAnNjBweCcsIGhlaWdodDogJzQ0cHgnfSxcbn07XG5cblxuLyoqXG4gKiBFbGVtZW50cyB0aGF0IHRoZSBwcm9nZXNzIGNhbiBiZSBzaG93biBmb3IuIFRoaXMgc2V0IGhhcyB0byBiZSBleHRlcm5hbGl6ZWRcbiAqIHNpbmNlIHRoZSBlbGVtZW50J3MgaW1wbGVtZW50YXRpb24gbWF5IG5vdCBiZSBkb3dubG9hZGVkIHlldC5cbiAqIEBlbnVtIHtib29sZWFufVxuICogQHByaXZhdGUgIFZpc2libGUgZm9yIHRlc3Rpbmcgb25seSFcbiAqL1xuZXhwb3J0IGNvbnN0IExPQURJTkdfRUxFTUVOVFNfID0ge1xuICAnQU1QLUFOSU0nOiB0cnVlLFxuICAnQU1QLUJSSUdIVENPVkUnOiB0cnVlLFxuICAnQU1QLUdPT0dMRS1ET0NVTUVOVC1FTUJFRCc6IHRydWUsXG4gICdBTVAtRU1CRUQnOiB0cnVlLFxuICAnQU1QLUZBQ0VCT09LJzogdHJ1ZSxcbiAgJ0FNUC1GQUNFQk9PSy1DT01NRU5UUyc6IHRydWUsXG4gICdBTVAtRkFDRUJPT0stTElLRSc6IHRydWUsXG4gICdBTVAtRkFDRUJPT0stUEFHRSc6IHRydWUsXG4gICdBTVAtSUZSQU1FJzogdHJ1ZSxcbiAgJ0FNUC1JTUcnOiB0cnVlLFxuICAnQU1QLUlOU1RBR1JBTSc6IHRydWUsXG4gICdBTVAtTElTVCc6IHRydWUsXG4gICdBTVAtT09ZQUxBLVBMQVlFUic6IHRydWUsXG4gICdBTVAtUElOVEVSRVNUJzogdHJ1ZSxcbiAgJ0FNUC1QTEFZQlVaWic6IHRydWUsXG4gICdBTVAtVklERU8nOiB0cnVlLFxuICAnQU1QLVlPVVRVQkUnOiB0cnVlLFxufTtcblxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBzXG4gKiBAcmV0dXJuIHtMYXlvdXR8dW5kZWZpbmVkfSBSZXR1cm5zIHVuZGVmaW5lZCBpbiBjYXNlIG9mIGZhaWx1cmUgdG8gcGFyc2VcbiAqICAgdGhlIGxheW91dCBzdHJpbmcuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUxheW91dChzKSB7XG4gIGZvciAoY29uc3QgayBpbiBMYXlvdXQpIHtcbiAgICBpZiAoTGF5b3V0W2tdID09IHMpIHtcbiAgICAgIHJldHVybiBMYXlvdXRba107XG4gICAgfVxuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFMYXlvdXR9IGxheW91dFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGF5b3V0Q2xhc3MobGF5b3V0KSB7XG4gIHJldHVybiAnaS1hbXBodG1sLWxheW91dC0nICsgbGF5b3V0O1xufVxuXG5cbi8qKlxuICogV2hldGhlciBhbiBlbGVtZW50IHdpdGggdGhpcyBsYXlvdXQgaW5oZXJlbnRseSBkZWZpbmVzIHRoZSBzaXplLlxuICogQHBhcmFtIHshTGF5b3V0fSBsYXlvdXRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xheW91dFNpemVEZWZpbmVkKGxheW91dCkge1xuICByZXR1cm4gKGxheW91dCA9PSBMYXlvdXQuRklYRUQgfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuRklYRURfSEVJR0hUIHx8XG4gICAgICBsYXlvdXQgPT0gTGF5b3V0LlJFU1BPTlNJVkUgfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuRklMTCB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5GTEVYX0lURU0gfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuRkxVSUQgfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuSU5UUklOU0lDKTtcbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHRhZyBpcyBhbiBpbnRlcm5hbCAoc2VydmljZSkgQU1QIHRhZy5cbiAqIEBwYXJhbSB7IU5vZGV8c3RyaW5nfSB0YWdcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0ludGVybmFsRWxlbWVudCh0YWcpIHtcbiAgY29uc3QgdGFnTmFtZSA9ICh0eXBlb2YgdGFnID09ICdzdHJpbmcnKSA/IHRhZyA6IHRhZy50YWdOYW1lO1xuICByZXR1cm4gdGFnTmFtZSAmJiBzdGFydHNXaXRoKHRhZ05hbWUudG9Mb3dlckNhc2UoKSwgJ2ktJyk7XG59XG5cblxuLyoqXG4gKiBQYXJzZXMgdGhlIENTUyBsZW5ndGggdmFsdWUuIElmIG5vIHVuaXRzIHNwZWNpZmllZCwgdGhlIGFzc3VtZWQgdmFsdWUgaXNcbiAqIFwicHhcIi4gUmV0dXJucyB1bmRlZmluZWQgaW4gY2FzZSBvZiBwYXJzaW5nIGVycm9yLlxuICogQHBhcmFtIHtzdHJpbmd8dW5kZWZpbmVkfG51bGx9IHNcbiAqIEByZXR1cm4geyFMZW5ndGhEZWZ8dW5kZWZpbmVkfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VMZW5ndGgocykge1xuICBpZiAodHlwZW9mIHMgPT0gJ251bWJlcicpIHtcbiAgICByZXR1cm4gcyArICdweCc7XG4gIH1cbiAgaWYgKCFzKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIS9eXFxkKyhcXC5cXGQrKT8ocHh8ZW18cmVtfHZofHZ3fHZtaW58dm1heHxjbXxtbXxxfGlufHBjfHB0KT8kLy50ZXN0KHMpKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoL15cXGQrKFxcLlxcZCspPyQvLnRlc3QocykpIHtcbiAgICByZXR1cm4gcyArICdweCc7XG4gIH1cbiAgcmV0dXJuIHM7XG59XG5cblxuXG4vKipcbiAqIEFzc2VydHMgdGhhdCB0aGUgc3VwcGxpZWQgdmFsdWUgaXMgYSBub24tcGVyY2VudCBDU1MgTGVuZ3RoIHZhbHVlLlxuICogQHBhcmFtIHshTGVuZ3RoRGVmfHN0cmluZ3xudWxsfHVuZGVmaW5lZH0gbGVuZ3RoXG4gKiBAcmV0dXJuIHshTGVuZ3RoRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0TGVuZ3RoKGxlbmd0aCkge1xuICB1c2VyKCkuYXNzZXJ0KFxuICAgICAgL15cXGQrKFxcLlxcZCspPyhweHxlbXxyZW18dmh8dnd8dm1pbnx2bWF4fGNtfG1tfHF8aW58cGN8cHQpJC8udGVzdChsZW5ndGgpLFxuICAgICAgJ0ludmFsaWQgbGVuZ3RoIHZhbHVlOiAlcycsIGxlbmd0aCk7XG4gIHJldHVybiAvKiogQHR5cGUgeyFMZW5ndGhEZWZ9ICovIChsZW5ndGgpO1xufVxuXG5cblxuXG4vKipcbiAqIEFzc2VydHMgdGhhdCB0aGUgc3VwcGxpZWQgdmFsdWUgaXMgYSBDU1MgTGVuZ3RoIHZhbHVlXG4gKiAoaW5jbHVkaW5nIHBlcmNlbnQgdW5pdCkuXG4gKiBAcGFyYW0geyFMZW5ndGhEZWZ8c3RyaW5nfSBsZW5ndGhcbiAqIEByZXR1cm4geyFMZW5ndGhEZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRMZW5ndGhPclBlcmNlbnQobGVuZ3RoKSB7XG4gIHVzZXIoKS5hc3NlcnQoL15cXGQrKFxcLlxcZCspPyhweHxlbXxyZW18dmh8dnd8dm1pbnx2bWF4fCUpJC8udGVzdChsZW5ndGgpLFxuICAgICAgJ0ludmFsaWQgbGVuZ3RoIG9yIHBlcmNlbnQgdmFsdWU6ICVzJywgbGVuZ3RoKTtcbiAgcmV0dXJuIGxlbmd0aDtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdW5pdHMgZnJvbSB0aGUgQ1NTIGxlbmd0aCB2YWx1ZS5cbiAqIEBwYXJhbSB7IUxlbmd0aERlZnxzdHJpbmd8bnVsbHx1bmRlZmluZWR9IGxlbmd0aFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGVuZ3RoVW5pdHMobGVuZ3RoKSB7XG4gIGFzc2VydExlbmd0aChsZW5ndGgpO1xuICBkZXYoKS5hc3NlcnRTdHJpbmcobGVuZ3RoKTtcbiAgY29uc3QgbSA9IHVzZXIoKS5hc3NlcnQobGVuZ3RoLm1hdGNoKC9bYS16XSsvaSksXG4gICAgICAnRmFpbGVkIHRvIHJlYWQgdW5pdHMgZnJvbSAlcycsIGxlbmd0aCk7XG4gIHJldHVybiBtWzBdO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyB0aGUgbnVtZXJpYyB2YWx1ZSBvZiBhIENTUyBsZW5ndGggdmFsdWUuXG4gKiBAcGFyYW0geyFMZW5ndGhEZWZ8c3RyaW5nfG51bGx8dW5kZWZpbmVkfSBsZW5ndGhcbiAqIEByZXR1cm4ge251bWJlcnx1bmRlZmluZWR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRMZW5ndGhOdW1lcmFsKGxlbmd0aCkge1xuICBjb25zdCByZXMgPSBwYXJzZUZsb2F0KGxlbmd0aCk7XG4gIHJldHVybiBpc0Zpbml0ZU51bWJlcihyZXMpID8gcmVzIDogdW5kZWZpbmVkO1xufVxuXG5cbi8qKlxuICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSB0YWdOYW1lIGlzIGEga25vd24gZWxlbWVudCB0aGF0IGhhcyBuYXR1cmFsIGRpbWVuc2lvbnNcbiAqIGluIG91ciBydW50aW1lIG9yIHRoZSBicm93c2VyLlxuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWUgVGhlIGVsZW1lbnQgdGFnIG5hbWUuXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzTmF0dXJhbERpbWVuc2lvbnModGFnTmFtZSkge1xuICB0YWdOYW1lID0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xuICByZXR1cm4gbmF0dXJhbERpbWVuc2lvbnNfW3RhZ05hbWVdICE9PSB1bmRlZmluZWQ7XG59XG5cblxuLyoqXG4gKiBEZXRlcm1pbmVzIHRoZSBkZWZhdWx0IGRpbWVuc2lvbnMgZm9yIGFuIGVsZW1lbnQgd2hpY2ggY291bGQgdmFyeSBhY3Jvc3NcbiAqIGRpZmZlcmVudCBicm93c2VyIGltcGxlbWVudGF0aW9ucywgbGlrZSA8YXVkaW8+IGZvciBpbnN0YW5jZS5cbiAqIFRoaXMgb3BlcmF0aW9uIGNhbiBvbmx5IGJlIGNvbXBsZXRlZCBmb3IgYW4gZWxlbWVudCB3aGl0ZWxpc3RlZCBieVxuICogYGhhc05hdHVyYWxEaW1lbnNpb25zYC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4ge0RpbWVuc2lvbnNEZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXROYXR1cmFsRGltZW5zaW9ucyhlbGVtZW50KSB7XG4gIGNvbnN0IHRhZ05hbWUgPSBlbGVtZW50LnRhZ05hbWUudG9VcHBlckNhc2UoKTtcbiAgZGV2KCkuYXNzZXJ0KG5hdHVyYWxEaW1lbnNpb25zX1t0YWdOYW1lXSAhPT0gdW5kZWZpbmVkKTtcbiAgaWYgKCFuYXR1cmFsRGltZW5zaW9uc19bdGFnTmFtZV0pIHtcbiAgICBjb25zdCBkb2MgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQ7XG4gICAgY29uc3QgbmF0dXJhbFRhZ05hbWUgPSB0YWdOYW1lLnJlcGxhY2UoL15BTVBcXC0vLCAnJyk7XG4gICAgY29uc3QgdGVtcCA9IGRvYy5jcmVhdGVFbGVtZW50KG5hdHVyYWxUYWdOYW1lKTtcbiAgICAvLyBGb3IgYXVkaW8sIHNob3VsZCBuby1vcCBlbHNld2hlcmUuXG4gICAgdGVtcC5jb250cm9scyA9IHRydWU7XG4gICAgc2V0U3R5bGVzKHRlbXAsIHtcbiAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgdmlzaWJpbGl0eTogJ2hpZGRlbicsXG4gICAgfSk7XG4gICAgZG9jLmJvZHkuYXBwZW5kQ2hpbGQodGVtcCk7XG4gICAgbmF0dXJhbERpbWVuc2lvbnNfW3RhZ05hbWVdID0ge1xuICAgICAgd2lkdGg6ICh0ZW1wLi8qT0sqL29mZnNldFdpZHRoIHx8IDEpICsgJ3B4JyxcbiAgICAgIGhlaWdodDogKHRlbXAuLypPSyovb2Zmc2V0SGVpZ2h0IHx8IDEpICsgJ3B4JyxcbiAgICB9O1xuICAgIGRvYy5ib2R5LnJlbW92ZUNoaWxkKHRlbXApO1xuICB9XG4gIHJldHVybiAvKiogQHR5cGUge0RpbWVuc2lvbnNEZWZ9ICovIChuYXR1cmFsRGltZW5zaW9uc19bdGFnTmFtZV0pO1xufVxuXG5cbi8qKlxuICogV2hldGhlciB0aGUgbG9hZGluZyBjYW4gYmUgc2hvd24gZm9yIHRoZSBzcGVjaWZpZWQgZWxlbWVlbnQuIFRoaXMgc2V0IGhhc1xuICogdG8gYmUgZXh0ZXJuYWxpemVkIHNpbmNlIHRoZSBlbGVtZW50J3MgaW1wbGVtZW50YXRpb24gbWF5IG5vdCBiZVxuICogZG93bmxvYWRlZCB5ZXQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNMb2FkaW5nQWxsb3dlZChlbGVtZW50KSB7XG4gIGNvbnN0IHRhZ05hbWUgPSBlbGVtZW50LnRhZ05hbWUudG9VcHBlckNhc2UoKTtcbiAgaWYgKHRhZ05hbWUgPT0gJ0FNUC1BRCcgfHwgdGFnTmFtZSA9PSAnQU1QLUVNQkVEJykge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBMT0FESU5HX0VMRU1FTlRTX1t0YWdOYW1lXSB8fCBmYWxzZTtcbn1cblxuXG4vKipcbiAqIEFwcGxpZXMgbGF5b3V0IHRvIHRoZSBlbGVtZW50LiBWaXNpYmxlIGZvciB0ZXN0aW5nIG9ubHkuXG4gKlxuICogXFwgICBcXCAgLyAgXFwgIC8gICAvIC8gICBcXCAgICAgfCAgIF8gIFxcICAgICB8ICBcXCB8ICB8IHwgIHwgfCAgXFwgfCAgfCAgLyBfX19fX3xcbiAqICBcXCAgIFxcLyAgICBcXC8gICAvIC8gIF4gIFxcICAgIHwgIHxfKSAgfCAgICB8ICAgXFx8ICB8IHwgIHwgfCAgIFxcfCAgfCB8ICB8ICBfX1xuICogICBcXCAgICAgICAgICAgIC8gLyAgL19cXCAgXFwgICB8ICAgICAgLyAgICAgfCAgLiBgICB8IHwgIHwgfCAgLiBgICB8IHwgIHwgfF8gfFxuICogICAgXFwgICAgL1xcICAgIC8gLyAgX19fX18gIFxcICB8ICB8XFwgIFxcLS0tLS58ICB8XFwgICB8IHwgIHwgfCAgfFxcICAgfCB8ICB8X198IHxcbiAqICAgICBcXF9fLyAgXFxfXy8gL19fLyAgICAgXFxfX1xcIHwgX3wgYC5fX19fX3x8X198IFxcX198IHxfX3wgfF9ffCBcXF9ffCAgXFxfX19fX198XG4gKlxuICogVGhlIGVxdWl2YWxlbnQgb2YgdGhpcyBtZXRob2QgaXMgdXNlZCBmb3Igc2VydmVyLXNpZGUgcmVuZGVyaW5nIChTU1IpIGFuZFxuICogYW55IGNoYW5nZXMgbWFkZSB0byBpdCBtdXN0IGJlIG1hZGUgaW4gY29vcmRpbmF0aW9uIHdpdGggY2FjaGVzIHRoYXRcbiAqIGltcGxlbWVudCBTU1IuIEZvciBtb3JlIGluZm9ybWF0aW9uIG9uIFNTUiBzZWUgYml0Lmx5L2FtcC1zc3IuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7IUxheW91dH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5U3RhdGljTGF5b3V0KGVsZW1lbnQpIHtcbiAgLy8gQ2hlY2sgaWYgdGhlIGxheW91dCBoYXMgYWxyZWFkeSBiZWVuIGRvbmUgYnkgc2VydmVyLXNpZGUgcmVuZGVyaW5nLiBUaGVcbiAgLy8gZG9jdW1lbnQgbWF5IGJlIHZpc2libGUgdG8gdGhlIHVzZXIgaWYgdGhlIGJvaWxlcnBsYXRlIHdhcyByZW1vdmVkIHNvXG4gIC8vIHBsZWFzZSB0YWtlIGNhcmUgaW4gbWFraW5nIGNoYW5nZXMgaGVyZS5cbiAgY29uc3QgY29tcGxldGVkTGF5b3V0QXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdpLWFtcGh0bWwtbGF5b3V0Jyk7XG4gIGlmIChjb21wbGV0ZWRMYXlvdXRBdHRyKSB7XG4gICAgY29uc3QgbGF5b3V0ID0gLyoqIEB0eXBlIHshTGF5b3V0fSAqLyAoZGV2KCkuYXNzZXJ0KFxuICAgICAgICBwYXJzZUxheW91dChjb21wbGV0ZWRMYXlvdXRBdHRyKSkpO1xuICAgIGlmICgobGF5b3V0ID09IExheW91dC5SRVNQT05TSVZFIHx8IGxheW91dCA9PSBMYXlvdXQuSU5UUklOU0lDKVxuICAgICAgJiYgZWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZCkge1xuICAgICAgLy8gRmluZCBzaXplciwgYnV0IGFzc3VtZSB0aGF0IGl0IG1pZ2h0IG5vdCBoYXZlIGJlZW4gcGFyc2VkIHlldC5cbiAgICAgIGVsZW1lbnQuc2l6ZXJFbGVtZW50ID1cbiAgICAgICAgICBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2ktYW1waHRtbC1zaXplcicpIHx8IHVuZGVmaW5lZDtcbiAgICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuTk9ESVNQTEFZKSB7XG4gICAgICBhcHBseU5vRGlzcGxheUxheW91dChlbGVtZW50KTtcbiAgICB9XG4gICAgcmV0dXJuIGxheW91dDtcbiAgfVxuXG4gIC8vIElmIHRoZSBsYXlvdXQgd2FzIGFscmVhZHkgZG9uZSBieSBzZXJ2ZXItc2lkZSByZW5kZXJpbmcgKFNTUiksIHRoZW4gdGhlXG4gIC8vIGNvZGUgYmVsb3cgd2lsbCBub3QgcnVuLiBBbnkgY2hhbmdlcyBiZWxvdyB3aWxsIG5lY2Vzc2l0YXRlIGEgY2hhbmdlIHRvIFNTUlxuICAvLyBhbmQgbXVzdCBiZSBjb29yZGluYXRlZCB3aXRoIGNhY2hlcyB0aGF0IGltcGxlbWVudCBTU1IuIFNlZSBiaXQubHkvYW1wLXNzci5cblxuICAvLyBQYXJzZSBsYXlvdXQgZnJvbSB0aGUgZWxlbWVudC5cbiAgY29uc3QgbGF5b3V0QXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdsYXlvdXQnKTtcbiAgY29uc3Qgd2lkdGhBdHRyID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3dpZHRoJyk7XG4gIGNvbnN0IGhlaWdodEF0dHIgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnaGVpZ2h0Jyk7XG4gIGNvbnN0IHNpemVzQXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdzaXplcycpO1xuICBjb25zdCBoZWlnaHRzQXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdoZWlnaHRzJyk7XG5cbiAgLy8gSW5wdXQgbGF5b3V0IGF0dHJpYnV0ZXMuXG4gIGNvbnN0IGlucHV0TGF5b3V0ID0gbGF5b3V0QXR0ciA/IHBhcnNlTGF5b3V0KGxheW91dEF0dHIpIDogbnVsbDtcbiAgdXNlcigpLmFzc2VydChpbnB1dExheW91dCAhPT0gdW5kZWZpbmVkLCAnVW5rbm93biBsYXlvdXQ6ICVzJywgbGF5b3V0QXR0cik7XG4gIC8qKiBAY29uc3Qge3N0cmluZ3xudWxsfHVuZGVmaW5lZH0gKi9cbiAgY29uc3QgaW5wdXRXaWR0aCA9ICh3aWR0aEF0dHIgJiYgd2lkdGhBdHRyICE9ICdhdXRvJykgP1xuICAgIHBhcnNlTGVuZ3RoKHdpZHRoQXR0cikgOiB3aWR0aEF0dHI7XG4gIHVzZXIoKS5hc3NlcnQoaW5wdXRXaWR0aCAhPT0gdW5kZWZpbmVkLCAnSW52YWxpZCB3aWR0aCB2YWx1ZTogJXMnLCB3aWR0aEF0dHIpO1xuICAvKiogQGNvbnN0IHtzdHJpbmd8bnVsbHx1bmRlZmluZWR9ICovXG4gIGNvbnN0IGlucHV0SGVpZ2h0ID0gKGhlaWdodEF0dHIgJiYgaGVpZ2h0QXR0ciAhPSAnZmx1aWQnKSA/XG4gICAgcGFyc2VMZW5ndGgoaGVpZ2h0QXR0cikgOiBoZWlnaHRBdHRyO1xuICB1c2VyKCkuYXNzZXJ0KGlucHV0SGVpZ2h0ICE9PSB1bmRlZmluZWQsICdJbnZhbGlkIGhlaWdodCB2YWx1ZTogJXMnLFxuICAgICAgaGVpZ2h0QXR0cik7XG5cbiAgLy8gRWZmZWN0aXZlIGxheW91dCBhdHRyaWJ1dGVzLiBUaGVzZSBhcmUgZWZmZWN0aXZlbHkgY29uc3RhbnRzLlxuICBsZXQgd2lkdGg7XG4gIGxldCBoZWlnaHQ7XG4gIGxldCBsYXlvdXQ7XG5cbiAgLy8gQ2FsY3VsYXRlIGVmZmVjdGl2ZSB3aWR0aCBhbmQgaGVpZ2h0LlxuICBpZiAoKCFpbnB1dExheW91dCB8fCBpbnB1dExheW91dCA9PSBMYXlvdXQuRklYRUQgfHxcbiAgICAgIGlucHV0TGF5b3V0ID09IExheW91dC5GSVhFRF9IRUlHSFQpICYmXG4gICAgICAoIWlucHV0V2lkdGggfHwgIWlucHV0SGVpZ2h0KSAmJiBoYXNOYXR1cmFsRGltZW5zaW9ucyhlbGVtZW50LnRhZ05hbWUpKSB7XG4gICAgLy8gRGVmYXVsdCB3aWR0aCBhbmQgaGVpZ2h0OiBoYW5kbGUgZWxlbWVudHMgdGhhdCBkbyBub3Qgc3BlY2lmeSBhXG4gICAgLy8gd2lkdGgvaGVpZ2h0IGFuZCBhcmUgZGVmaW5lZCB0byBoYXZlIG5hdHVyYWwgYnJvd3NlciBkaW1lbnNpb25zLlxuICAgIGNvbnN0IGRpbWVuc2lvbnMgPSBnZXROYXR1cmFsRGltZW5zaW9ucyhlbGVtZW50KTtcbiAgICB3aWR0aCA9IChpbnB1dFdpZHRoIHx8IGlucHV0TGF5b3V0ID09IExheW91dC5GSVhFRF9IRUlHSFQpID8gaW5wdXRXaWR0aCA6XG4gICAgICBkaW1lbnNpb25zLndpZHRoO1xuICAgIGhlaWdodCA9IGlucHV0SGVpZ2h0IHx8IGRpbWVuc2lvbnMuaGVpZ2h0O1xuICB9IGVsc2Uge1xuICAgIHdpZHRoID0gaW5wdXRXaWR0aDtcbiAgICBoZWlnaHQgPSBpbnB1dEhlaWdodDtcbiAgfVxuXG4gIC8vIENhbGN1bGF0ZSBlZmZlY3RpdmUgbGF5b3V0LlxuICBpZiAoaW5wdXRMYXlvdXQpIHtcbiAgICBsYXlvdXQgPSBpbnB1dExheW91dDtcbiAgfSBlbHNlIGlmICghd2lkdGggJiYgIWhlaWdodCkge1xuICAgIGxheW91dCA9IExheW91dC5DT05UQUlORVI7XG4gIH0gZWxzZSBpZiAoaGVpZ2h0ID09ICdmbHVpZCcpIHtcbiAgICBsYXlvdXQgPSBMYXlvdXQuRkxVSUQ7XG4gIH0gZWxzZSBpZiAoaGVpZ2h0ICYmICghd2lkdGggfHwgd2lkdGggPT0gJ2F1dG8nKSkge1xuICAgIGxheW91dCA9IExheW91dC5GSVhFRF9IRUlHSFQ7XG4gIH0gZWxzZSBpZiAoaGVpZ2h0ICYmIHdpZHRoICYmIChzaXplc0F0dHIgfHwgaGVpZ2h0c0F0dHIpKSB7XG4gICAgbGF5b3V0ID0gTGF5b3V0LlJFU1BPTlNJVkU7XG4gIH0gZWxzZSB7XG4gICAgbGF5b3V0ID0gTGF5b3V0LkZJWEVEO1xuICB9XG5cbiAgLy8gVmVyaWZ5IGxheW91dCBhdHRyaWJ1dGVzLlxuICBpZiAobGF5b3V0ID09IExheW91dC5GSVhFRCB8fCBsYXlvdXQgPT0gTGF5b3V0LkZJWEVEX0hFSUdIVCB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5SRVNQT05TSVZFIHx8IGxheW91dCA9PSBMYXlvdXQuSU5UUklOU0lDKSB7XG4gICAgdXNlcigpLmFzc2VydChoZWlnaHQsICdFeHBlY3RlZCBoZWlnaHQgdG8gYmUgYXZhaWxhYmxlOiAlcycsIGhlaWdodEF0dHIpO1xuICB9XG4gIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZJWEVEX0hFSUdIVCkge1xuICAgIHVzZXIoKS5hc3NlcnQoIXdpZHRoIHx8IHdpZHRoID09ICdhdXRvJyxcbiAgICAgICAgJ0V4cGVjdGVkIHdpZHRoIHRvIGJlIGVpdGhlciBhYnNlbnQgb3IgZXF1YWwgXCJhdXRvXCIgJyArXG4gICAgICAgICdmb3IgZml4ZWQtaGVpZ2h0IGxheW91dDogJXMnLCB3aWR0aEF0dHIpO1xuICB9XG4gIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZJWEVEIHx8IGxheW91dCA9PSBMYXlvdXQuUkVTUE9OU0lWRSB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5JTlRSSU5TSUMpIHtcbiAgICB1c2VyKCkuYXNzZXJ0KHdpZHRoICYmIHdpZHRoICE9ICdhdXRvJyxcbiAgICAgICAgJ0V4cGVjdGVkIHdpZHRoIHRvIGJlIGF2YWlsYWJsZSBhbmQgbm90IGVxdWFsIHRvIFwiYXV0b1wiOiAlcycsXG4gICAgICAgIHdpZHRoQXR0cik7XG4gIH1cblxuICBpZiAobGF5b3V0ID09IExheW91dC5SRVNQT05TSVZFIHx8IGxheW91dCA9PSBMYXlvdXQuSU5UUklOU0lDKSB7XG4gICAgdXNlcigpLmFzc2VydChnZXRMZW5ndGhVbml0cyh3aWR0aCkgPT0gZ2V0TGVuZ3RoVW5pdHMoaGVpZ2h0KSxcbiAgICAgICAgJ0xlbmd0aCB1bml0cyBzaG91bGQgYmUgdGhlIHNhbWUgZm9yIHdpZHRoIGFuZCBoZWlnaHQ6ICVzLCAlcycsXG4gICAgICAgIHdpZHRoQXR0ciwgaGVpZ2h0QXR0cik7XG4gIH0gZWxzZSB7XG4gICAgdXNlcigpLmFzc2VydChoZWlnaHRzQXR0ciA9PT0gbnVsbCxcbiAgICAgICAgJ1VuZXhwZWN0ZWQgXCJoZWlnaHRzXCIgYXR0cmlidXRlIGZvciBub25lLXJlc3BvbnNpdmUgbGF5b3V0Jyk7XG4gIH1cblxuICAvLyBBcHBseSBVSS5cbiAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGdldExheW91dENsYXNzKGxheW91dCkpO1xuICBpZiAoaXNMYXlvdXRTaXplRGVmaW5lZChsYXlvdXQpKSB7XG4gICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdpLWFtcGh0bWwtbGF5b3V0LXNpemUtZGVmaW5lZCcpO1xuICB9XG4gIGlmIChsYXlvdXQgPT0gTGF5b3V0Lk5PRElTUExBWSkge1xuICAgIC8vIENTUyBkZWZpbmVzIGxheW91dD1ub2Rpc3BsYXkgYXV0b21hdGljYWxseSB3aXRoIGBkaXNwbGF5Om5vbmVgLiBUaHVzXG4gICAgLy8gbm8gYWRkaXRpb25hbCBzdHlsaW5nIGlzIG5lZWRlZC5cbiAgICBhcHBseU5vRGlzcGxheUxheW91dChlbGVtZW50KTtcbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZJWEVEKSB7XG4gICAgc2V0U3R5bGVzKGVsZW1lbnQsIHtcbiAgICAgIHdpZHRoOiBkZXYoKS5hc3NlcnRTdHJpbmcod2lkdGgpLFxuICAgICAgaGVpZ2h0OiBkZXYoKS5hc3NlcnRTdHJpbmcoaGVpZ2h0KSxcbiAgICB9KTtcbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZJWEVEX0hFSUdIVCkge1xuICAgIHNldFN0eWxlKGVsZW1lbnQsICdoZWlnaHQnLCBkZXYoKS5hc3NlcnRTdHJpbmcoaGVpZ2h0KSk7XG4gIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5SRVNQT05TSVZFKSB7XG4gICAgY29uc3Qgc2l6ZXIgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaS1hbXBodG1sLXNpemVyJyk7XG4gICAgc2V0U3R5bGVzKHNpemVyLCB7XG4gICAgICBkaXNwbGF5OiAnYmxvY2snLFxuICAgICAgcGFkZGluZ1RvcDpcbiAgICAgICAgKChnZXRMZW5ndGhOdW1lcmFsKGhlaWdodCkgLyBnZXRMZW5ndGhOdW1lcmFsKHdpZHRoKSkgKiAxMDApICsgJyUnLFxuICAgIH0pO1xuICAgIGVsZW1lbnQuaW5zZXJ0QmVmb3JlKHNpemVyLCBlbGVtZW50LmZpcnN0Q2hpbGQpO1xuICAgIGVsZW1lbnQuc2l6ZXJFbGVtZW50ID0gc2l6ZXI7XG4gIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5JTlRSSU5TSUMpIHtcbiAgICAvLyBJbnRyaW5zaWMgdXNlcyBhbiBzdmcgaW5zaWRlIHRoZSBzaXplciBlbGVtZW50IHJhdGhlciB0aGFuIHRoZSBwYWRkaW5nXG4gICAgLy8gdHJpY2sgTm90ZSBhIG5ha2VkIHN2ZyB3b24ndCB3b3JrIGJlY2FzdWUgb3RoZXIgdGhpbmcgZXhwZWN0IHRoZVxuICAgIC8vIGktYW1waHRtbC1zaXplciBlbGVtZW50XG4gICAgY29uc3Qgc2l6ZXIgPSBodG1sRm9yKGVsZW1lbnQpYFxuICAgICAgPGktYW1waHRtbC1zaXplciBjbGFzcz1cImktYW1waHRtbC1zaXplclwiPlxuICAgICAgICA8aW1nIGNsYXNzPVwiaS1hbXBodG1sLWludHJpbnNpYy1zaXplclwiIC8+XG4gICAgICA8L2ktYW1waHRtbC1zaXplcj5gO1xuICAgIGNvbnN0IGludHJpbnNpY1NpemVyID0gc2l6ZXIuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgaW50cmluc2ljU2l6ZXIuc2V0QXR0cmlidXRlKCdzcmMnLFxuICAgICAgICBgZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgsPHN2ZyBoZWlnaHQ9XCIke2hlaWdodH1cIiB3aWR0aD1cIiR7d2lkdGh9XCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZlcnNpb249XCIxLjFcIi8+YCk7XG4gICAgZWxlbWVudC5pbnNlcnRCZWZvcmUoc2l6ZXIsIGVsZW1lbnQuZmlyc3RDaGlsZCk7XG4gICAgLy8gVE9ETyhqcGV0dGl0dCk6IHNpemVyIGlzIGxlYWtlZCBhbmQgY2FuJ3QgYmUgY2xlYW5lZCB1cC5cbiAgICBlbGVtZW50LnNpemVyRWxlbWVudCA9IGludHJpbnNpY1NpemVyO1xuICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuRklMTCkge1xuICAgIC8vIERvIG5vdGhpbmcuXG4gIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5DT05UQUlORVIpIHtcbiAgICAvLyBEbyBub3RoaW5nLiBFbGVtZW50cyB0aGVtc2VsdmVzIHdpbGwgY2hlY2sgd2hldGhlciB0aGUgc3VwcGxpZWRcbiAgICAvLyBsYXlvdXQgdmFsdWUgaXMgYWNjZXB0YWJsZS4gSW4gcGFydGljdWxhciBjb250YWluZXIgaXMgb25seSBPS1xuICAgIC8vIHNvbWV0aW1lcy5cbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZMRVhfSVRFTSkge1xuICAgIC8vIFNldCBoZWlnaHQgYW5kIHdpZHRoIHRvIGEgZmxleCBpdGVtIGlmIHRoZXkgZXhpc3QuXG4gICAgLy8gVGhlIHNpemUgc2V0IHRvIGEgZmxleCBpdGVtIGNvdWxkIGJlIG92ZXJyaWRkZW4gYnkgYGRpc3BsYXk6IGZsZXhgIGxhdGVyLlxuICAgIGlmICh3aWR0aCkge1xuICAgICAgc2V0U3R5bGUoZWxlbWVudCwgJ3dpZHRoJywgd2lkdGgpO1xuICAgIH1cbiAgICBpZiAoaGVpZ2h0KSB7XG4gICAgICBzZXRTdHlsZShlbGVtZW50LCAnaGVpZ2h0JywgaGVpZ2h0KTtcbiAgICB9XG4gIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5GTFVJRCkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaS1hbXBodG1sLWxheW91dC1hd2FpdGluZy1zaXplJyk7XG4gICAgaWYgKHdpZHRoKSB7XG4gICAgICBzZXRTdHlsZShlbGVtZW50LCAnd2lkdGgnLCB3aWR0aCk7XG4gICAgfVxuICAgIHNldFN0eWxlKGVsZW1lbnQsICdoZWlnaHQnLCAwKTtcbiAgfVxuICByZXR1cm4gbGF5b3V0O1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICovXG5mdW5jdGlvbiBhcHBseU5vRGlzcGxheUxheW91dChlbGVtZW50KSB7XG4gIC8vIFRPRE8oZHZveXRlbmtvLCAjOTM1Myk6IG9uY2UgYHRvZ2dsZUxheW91dERpc3BsYXlgIEFQSSBoYXMgYmVlbiBkZXBsb3llZFxuICAvLyBldmVyeXdoZXJlLCBzd2l0Y2ggYWxsIHJlbGV2YW50IGVsZW1lbnRzIHRvIHRoaXMgQVBJLiBJbiB0aGUgbWVhbnRpbWUsXG4gIC8vIHNpbXBseSB1bmJsb2NrIGRpc3BsYXkgdG9nZ2xpbmcgdmlhIGBzdHlsZT1cImRpc3BsYXk6IC4uLlwiYC5cbiAgc2V0U3R5bGUoZWxlbWVudCwgJ2Rpc3BsYXknLCAnbm9uZScpO1xuICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2ktYW1waHRtbC1kaXNwbGF5Jyk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuL21vZGUnO1xuaW1wb3J0IHtnZXRNb2RlT2JqZWN0fSBmcm9tICcuL21vZGUtb2JqZWN0JztcbmltcG9ydCB7aXNFbnVtVmFsdWV9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIFRyaXBsZSB6ZXJvIHdpZHRoIHNwYWNlLlxuICpcbiAqIFRoaXMgaXMgYWRkZWQgdG8gdXNlciBlcnJvciBtZXNzYWdlcywgc28gdGhhdCB3ZSBjYW4gbGF0ZXIgaWRlbnRpZnlcbiAqIHRoZW0sIHdoZW4gdGhlIG9ubHkgdGhpbmcgdGhhdCB3ZSBoYXZlIGlzIHRoZSBtZXNzYWdlLiBUaGlzIGlzIHRoZVxuICogY2FzZSBpbiBtYW55IGJyb3dzZXJzIHdoZW4gdGhlIGdsb2JhbCBleGNlcHRpb24gaGFuZGxlciBpcyBpbnZva2VkLlxuICpcbiAqIEBjb25zdCB7c3RyaW5nfVxuICovXG5leHBvcnQgY29uc3QgVVNFUl9FUlJPUl9TRU5USU5FTCA9ICdcXHUyMDBCXFx1MjAwQlxcdTIwMEInO1xuXG5cbi8qKlxuICogRm91ciB6ZXJvIHdpZHRoIHNwYWNlLlxuICpcbiAqIEBjb25zdCB7c3RyaW5nfVxuICovXG5leHBvcnQgY29uc3QgVVNFUl9FUlJPUl9FTUJFRF9TRU5USU5FTCA9ICdcXHUyMDBCXFx1MjAwQlxcdTIwMEJcXHUyMDBCJztcblxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoaXMgbWVzc2FnZSB3YXMgYSB1c2VyIGVycm9yLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNVc2VyRXJyb3JNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgcmV0dXJuIG1lc3NhZ2UuaW5kZXhPZihVU0VSX0VSUk9SX1NFTlRJTkVMKSA+PSAwO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoaXMgbWVzc2FnZSB3YXMgYSBhIHVzZXIgZXJyb3IgZnJvbSBhbiBpZnJhbWUgZW1iZWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1VzZXJFcnJvckVtYmVkKG1lc3NhZ2UpIHtcbiAgcmV0dXJuIG1lc3NhZ2UuaW5kZXhPZihVU0VSX0VSUk9SX0VNQkVEX1NFTlRJTkVMKSA+PSAwO1xufVxuXG5cbi8qKlxuICogQGVudW0ge251bWJlcn1cbiAqIEBwcml2YXRlIFZpc2libGUgZm9yIHRlc3Rpbmcgb25seS5cbiAqL1xuZXhwb3J0IGNvbnN0IExvZ0xldmVsID0ge1xuICBPRkY6IDAsXG4gIEVSUk9SOiAxLFxuICBXQVJOOiAyLFxuICBJTkZPOiAzLFxuICBGSU5FOiA0LFxufTtcblxuLyoqXG4gKiBTZXRzIHJlcG9ydEVycm9yIGZ1bmN0aW9uLiBDYWxsZWQgZnJvbSBlcnJvci5qcyB0byBicmVhayBjeWNsaWNcbiAqIGRlcGVuZGVuY3kuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCosICFFbGVtZW50PSl8dW5kZWZpbmVkfSBmblxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0UmVwb3J0RXJyb3IoZm4pIHtcbiAgc2VsZi5yZXBvcnRFcnJvciA9IGZuO1xufVxuXG4vKipcbiAqIEB0eXBlIHshTG9nTGV2ZWx8dW5kZWZpbmVkfVxuICogQHByaXZhdGVcbiAqL1xubGV0IGxldmVsT3ZlcnJpZGVfID0gdW5kZWZpbmVkO1xuXG4vKipcbiAqIEBwYXJhbSB7IUxvZ0xldmVsfSBsZXZlbFxuICovXG5leHBvcnQgZnVuY3Rpb24gb3ZlcnJpZGVMb2dMZXZlbChsZXZlbCkge1xuICBsZXZlbE92ZXJyaWRlXyA9IGxldmVsO1xufVxuXG4vKipcbiAqIExvZ2dpbmcgY2xhc3MuIFVzZSBvZiBzZW50aW5lbCBzdHJpbmcgaW5zdGVhZCBvZiBhIGJvb2xlYW4gdG8gY2hlY2sgdXNlci9kZXZcbiAqIGVycm9ycyBiZWNhdXNlIGVycm9ycyBjb3VsZCBiZSByZXRocm93biBieSBzb21lIG5hdGl2ZSBjb2RlIGFzIGEgbmV3IGVycm9yLFxuICogYW5kIG9ubHkgYSBtZXNzYWdlIHdvdWxkIHN1cnZpdmUuIEFsc28sIHNvbWUgYnJvd3NlciBkb27igJl0IHN1cHBvcnQgYSA1dGhcbiAqIGVycm9yIG9iamVjdCBhcmd1bWVudCBpbiB3aW5kb3cub25lcnJvci4gTGlzdCBvZiBzdXBwb3J0aW5nIGJyb3dzZXIgY2FuIGJlXG4gKiBmb3VuZCBoZXJlOlxuICogaHR0cHM6Ly9ibG9nLnNlbnRyeS5pby8yMDE2LzAxLzA0L2NsaWVudC1qYXZhc2NyaXB0LXJlcG9ydGluZy13aW5kb3ctb25lcnJvci5odG1sXG4gKiBAZmluYWxcbiAqIEBwcml2YXRlIFZpc2libGUgZm9yIHRlc3Rpbmcgb25seS5cbiAqL1xuZXhwb3J0IGNsYXNzIExvZyB7XG4gIC8qKlxuICAgKiBvcHRfc3VmZml4IHdpbGwgYmUgYXBwZW5kZWQgdG8gZXJyb3IgbWVzc2FnZSB0byBpZGVudGlmeSB0aGUgdHlwZSBvZiB0aGVcbiAgICogZXJyb3IgbWVzc2FnZS4gV2UgY2FuJ3QgcmVseSBvbiB0aGUgZXJyb3Igb2JqZWN0IHRvIHBhc3MgYWxvbmcgdGhlIHR5cGVcbiAgICogYmVjYXVzZSBzb21lIGJyb3dzZXJzIGRvIG5vdCBoYXZlIHRoaXMgcGFyYW0gaW4gaXRzIHdpbmRvdy5vbmVycm9yIEFQSS5cbiAgICogU2VlOlxuICAgKiBodHRwczovL2Jsb2cuc2VudHJ5LmlvLzIwMTYvMDEvMDQvY2xpZW50LWphdmFzY3JpcHQtcmVwb3J0aW5nLXdpbmRvdy1vbmVycm9yLmh0bWxcbiAgICpcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHBhcmFtIHtmdW5jdGlvbighLi9tb2RlLk1vZGVEZWYpOiFMb2dMZXZlbH0gbGV2ZWxGdW5jXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X3N1ZmZpeFxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luLCBsZXZlbEZ1bmMsIG9wdF9zdWZmaXgpIHtcbiAgICAvKipcbiAgICAgKiBJbiB0ZXN0cyB3ZSB1c2UgdGhlIG1haW4gdGVzdCB3aW5kb3cgaW5zdGVhZCBvZiB0aGUgaWZyYW1lIHdoZXJlXG4gICAgICogdGhlIHRlc3RzIHJ1bnMgYmVjYXVzZSBvbmx5IHRoZSBmb3JtZXIgaXMgcmVsYXllZCB0byB0aGUgY29uc29sZS5cbiAgICAgKiBAY29uc3QgeyFXaW5kb3d9XG4gICAgICovXG4gICAgdGhpcy53aW4gPSAoZ2V0TW9kZSgpLnRlc3QgJiYgd2luLkFNUF9URVNUX0lGUkFNRSkgPyB3aW4ucGFyZW50IDogd2luO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7ZnVuY3Rpb24oIS4vbW9kZS5Nb2RlRGVmKTohTG9nTGV2ZWx9ICovXG4gICAgdGhpcy5sZXZlbEZ1bmNfID0gbGV2ZWxGdW5jO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IUxvZ0xldmVsfSAqL1xuICAgIHRoaXMubGV2ZWxfID0gdGhpcy5kZWZhdWx0TGV2ZWxfKCk7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtzdHJpbmd9ICovXG4gICAgdGhpcy5zdWZmaXhfID0gb3B0X3N1ZmZpeCB8fCAnJztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHshTG9nTGV2ZWx9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRMZXZlbF8oKSB7XG4gICAgcmV0dXJuIChsZXZlbE92ZXJyaWRlXyAhPT0gdW5kZWZpbmVkKSA/IGxldmVsT3ZlcnJpZGVfIDogdGhpcy5sZXZlbF87XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IUxvZ0xldmVsfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZGVmYXVsdExldmVsXygpIHtcbiAgICAvLyBObyBjb25zb2xlIC0gY2FuJ3QgZW5hYmxlIGxvZ2dpbmcuXG4gICAgaWYgKCF0aGlzLndpbi5jb25zb2xlIHx8ICF0aGlzLndpbi5jb25zb2xlLmxvZykge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLk9GRjtcbiAgICB9XG5cbiAgICAvLyBMb2dnaW5nIGhhcyBiZWVuIGV4cGxpY2l0bHkgZGlzYWJsZWQuXG4gICAgaWYgKGdldE1vZGUoKS5sb2cgPT0gJzAnKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuT0ZGO1xuICAgIH1cblxuICAgIC8vIExvZ2dpbmcgaXMgZW5hYmxlZCBmb3IgdGVzdHMgZGlyZWN0bHkuXG4gICAgaWYgKGdldE1vZGUoKS50ZXN0ICYmIHRoaXMud2luLkVOQUJMRV9MT0cpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5GSU5FO1xuICAgIH1cblxuICAgIC8vIExvY2FsRGV2IGJ5IGRlZmF1bHQgYWxsb3dzIElORk8gbGV2ZWwsIHVubGVzcyBvdmVycmlkZW4gYnkgYCNsb2dgLlxuICAgIGlmIChnZXRNb2RlKCkubG9jYWxEZXYgJiYgIWdldE1vZGUoKS5sb2cpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5JTkZPO1xuICAgIH1cblxuICAgIC8vIERlbGVnYXRlIHRvIHRoZSBzcGVjaWZpYyByZXNvbHZlci5cbiAgICByZXR1cm4gdGhpcy5sZXZlbEZ1bmNfKGdldE1vZGVPYmplY3QoKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0ge3N0cmluZ30gbGV2ZWxcbiAgICogQHBhcmFtIHshQXJyYXl9IG1lc3NhZ2VzXG4gICAqL1xuICBtc2dfKHRhZywgbGV2ZWwsIG1lc3NhZ2VzKSB7XG4gICAgaWYgKHRoaXMuZ2V0TGV2ZWxfKCkgIT0gTG9nTGV2ZWwuT0ZGKSB7XG4gICAgICBsZXQgZm4gPSB0aGlzLndpbi5jb25zb2xlLmxvZztcbiAgICAgIGlmIChsZXZlbCA9PSAnRVJST1InKSB7XG4gICAgICAgIGZuID0gdGhpcy53aW4uY29uc29sZS5lcnJvciB8fCBmbjtcbiAgICAgIH0gZWxzZSBpZiAobGV2ZWwgPT0gJ0lORk8nKSB7XG4gICAgICAgIGZuID0gdGhpcy53aW4uY29uc29sZS5pbmZvIHx8IGZuO1xuICAgICAgfSBlbHNlIGlmIChsZXZlbCA9PSAnV0FSTicpIHtcbiAgICAgICAgZm4gPSB0aGlzLndpbi5jb25zb2xlLndhcm4gfHwgZm47XG4gICAgICB9XG4gICAgICBpZiAoZ2V0TW9kZSgpLmxvY2FsRGV2KSB7XG4gICAgICAgIG1lc3NhZ2VzLnVuc2hpZnQoJ1snICsgdGFnICsgJ10nKTtcbiAgICAgIH1cbiAgICAgIGZuLmFwcGx5KHRoaXMud2luLmNvbnNvbGUsIG1lc3NhZ2VzKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciB0aGUgbG9nZ2luZyBpcyBlbmFibGVkLlxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgaXNFbmFibGVkKCkge1xuICAgIHJldHVybiB0aGlzLmdldExldmVsXygpICE9IExvZ0xldmVsLk9GRjtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGEgZmluZS1ncmFpbmVkIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKi9cbiAgZmluZSh0YWcsIHZhcl9hcmdzKSB7XG4gICAgaWYgKHRoaXMuZ2V0TGV2ZWxfKCkgPj0gTG9nTGV2ZWwuRklORSkge1xuICAgICAgdGhpcy5tc2dfKHRhZywgJ0ZJTkUnLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVwb3J0cyBhIGluZm9ybWF0aW9uYWwgbWVzc2FnZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqL1xuICBpbmZvKHRhZywgdmFyX2FyZ3MpIHtcbiAgICBpZiAodGhpcy5nZXRMZXZlbF8oKSA+PSBMb2dMZXZlbC5JTkZPKSB7XG4gICAgICB0aGlzLm1zZ18odGFnLCAnSU5GTycsIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGEgd2FybmluZyBtZXNzYWdlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICovXG4gIHdhcm4odGFnLCB2YXJfYXJncykge1xuICAgIGlmICh0aGlzLmdldExldmVsXygpID49IExvZ0xldmVsLldBUk4pIHtcbiAgICAgIHRoaXMubXNnXyh0YWcsICdXQVJOJywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9ydHMgYW4gZXJyb3IgbWVzc2FnZS4gSWYgdGhlIGxvZ2dpbmcgaXMgZGlzYWJsZWQsIHRoZSBlcnJvciBpcyByZXRocm93blxuICAgKiBhc3luY2hyb25vdXNseS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqIEByZXR1cm4geyFFcnJvcnx1bmRlZmluZWR9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBlcnJvcl8odGFnLCB2YXJfYXJncykge1xuICAgIGlmICh0aGlzLmdldExldmVsXygpID49IExvZ0xldmVsLkVSUk9SKSB7XG4gICAgICB0aGlzLm1zZ18odGFnLCAnRVJST1InLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZXJyb3IgPSBjcmVhdGVFcnJvclZhcmdzLmFwcGx5KG51bGwsXG4gICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgICB0aGlzLnByZXBhcmVFcnJvcl8oZXJyb3IpO1xuICAgICAgcmV0dXJuIGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGFuIGVycm9yIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKi9cbiAgZXJyb3IodGFnLCB2YXJfYXJncykge1xuICAgIGNvbnN0IGVycm9yID0gdGhpcy5lcnJvcl8uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGVycm9yLm5hbWUgPSB0YWcgfHwgZXJyb3IubmFtZTtcbiAgICAgIC8vIHJlcG9ydEVycm9yIGlzIGluc3RhbGxlZCBnbG9iYWxseSBwZXIgd2luZG93IGluIHRoZSBlbnRyeSBwb2ludC5cbiAgICAgIHNlbGYucmVwb3J0RXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGFuIGVycm9yIG1lc3NhZ2UgYW5kIG1hcmtzIHdpdGggYW4gZXhwZWN0ZWQgcHJvcGVydHkuIElmIHRoZVxuICAgKiBsb2dnaW5nIGlzIGRpc2FibGVkLCB0aGUgZXJyb3IgaXMgcmV0aHJvd24gYXN5bmNocm9ub3VzbHkuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB1bnVzZWRUYWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKi9cbiAgZXhwZWN0ZWRFcnJvcih1bnVzZWRUYWcsIHZhcl9hcmdzKSB7XG4gICAgY29uc3QgZXJyb3IgPSB0aGlzLmVycm9yXy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmIChlcnJvcikge1xuICAgICAgZXJyb3IuZXhwZWN0ZWQgPSB0cnVlO1xuICAgICAgLy8gcmVwb3J0RXJyb3IgaXMgaW5zdGFsbGVkIGdsb2JhbGx5IHBlciB3aW5kb3cgaW4gdGhlIGVudHJ5IHBvaW50LlxuICAgICAgc2VsZi5yZXBvcnRFcnJvcihlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gZXJyb3Igb2JqZWN0LlxuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqIEByZXR1cm4geyFFcnJvcn1cbiAgICovXG4gIGNyZWF0ZUVycm9yKHZhcl9hcmdzKSB7XG4gICAgY29uc3QgZXJyb3IgPSBjcmVhdGVFcnJvclZhcmdzLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgdGhpcy5wcmVwYXJlRXJyb3JfKGVycm9yKTtcbiAgICByZXR1cm4gZXJyb3I7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBlcnJvciBvYmplY3Qgd2l0aCBpdHMgZXhwZWN0ZWQgcHJvcGVydHkgc2V0IHRvIHRydWUuXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICogQHJldHVybiB7IUVycm9yfVxuICAgKi9cbiAgY3JlYXRlRXhwZWN0ZWRFcnJvcih2YXJfYXJncykge1xuICAgIGNvbnN0IGVycm9yID0gY3JlYXRlRXJyb3JWYXJncy5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgIHRoaXMucHJlcGFyZUVycm9yXyhlcnJvcik7XG4gICAgZXJyb3IuZXhwZWN0ZWQgPSB0cnVlO1xuICAgIHJldHVybiBlcnJvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzbid0IHRydWVpc2guXG4gICAqXG4gICAqIFN1cHBvcnRzIGFyZ3VtZW50IHN1YnN0aXR1dGlvbiBpbnRvIHRoZSBtZXNzYWdlIHZpYSAlcyBwbGFjZWhvbGRlcnMuXG4gICAqXG4gICAqIFRocm93cyBhbiBlcnJvciBvYmplY3QgdGhhdCBoYXMgdHdvIGV4dHJhIHByb3BlcnRpZXM6XG4gICAqIC0gYXNzb2NpYXRlZEVsZW1lbnQ6IFRoaXMgaXMgdGhlIGZpcnN0IGVsZW1lbnQgcHJvdmlkZWQgaW4gdGhlIHZhciBhcmdzLlxuICAgKiAgIEl0IGNhbiBiZSB1c2VkIGZvciBpbXByb3ZlZCBkaXNwbGF5IG9mIGVycm9yIG1lc3NhZ2VzLlxuICAgKiAtIG1lc3NhZ2VBcnJheTogVGhlIGVsZW1lbnRzIG9mIHRoZSBzdWJzdGl0dXRlZCBtZXNzYWdlIGFzIG5vbi1zdHJpbmdpZmllZFxuICAgKiAgIGVsZW1lbnRzIGluIGFuIGFycmF5LiBXaGVuIGUuZy4gcGFzc2VkIHRvIGNvbnNvbGUuZXJyb3IgdGhpcyB5aWVsZHNcbiAgICogICBuYXRpdmUgZGlzcGxheXMgb2YgdGhpbmdzIGxpa2UgSFRNTCBlbGVtZW50cy5cbiAgICpcbiAgICogQHBhcmFtIHtUfSBzaG91bGRCZVRydWVpc2ggVGhlIHZhbHVlIHRvIGFzc2VydC4gVGhlIGFzc2VydCBmYWlscyBpZiBpdCBkb2VzXG4gICAqICAgICBub3QgZXZhbHVhdGUgdG8gdHJ1ZS5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfbWVzc2FnZSBUaGUgYXNzZXJ0aW9uIG1lc3NhZ2VcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJncyBBcmd1bWVudHMgc3Vic3RpdHV0ZWQgaW50byAlcyBpbiB0aGUgbWVzc2FnZS5cbiAgICogQHJldHVybiB7VH0gVGhlIHZhbHVlIG9mIHNob3VsZEJlVHJ1ZWlzaC5cbiAgICogQHRlbXBsYXRlIFRcbiAgICogZXNsaW50IFwiZ29vZ2xlLWNhbWVsY2FzZS9nb29nbGUtY2FtZWxjYXNlXCI6IDBcbiAgICovXG4gIGFzc2VydChzaG91bGRCZVRydWVpc2gsIG9wdF9tZXNzYWdlLCB2YXJfYXJncykge1xuICAgIGxldCBmaXJzdEVsZW1lbnQ7XG4gICAgaWYgKCFzaG91bGRCZVRydWVpc2gpIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBvcHRfbWVzc2FnZSB8fCAnQXNzZXJ0aW9uIGZhaWxlZCc7XG4gICAgICBjb25zdCBzcGxpdE1lc3NhZ2UgPSBtZXNzYWdlLnNwbGl0KCclcycpO1xuICAgICAgY29uc3QgZmlyc3QgPSBzcGxpdE1lc3NhZ2Uuc2hpZnQoKTtcbiAgICAgIGxldCBmb3JtYXR0ZWQgPSBmaXJzdDtcbiAgICAgIGNvbnN0IG1lc3NhZ2VBcnJheSA9IFtdO1xuICAgICAgcHVzaElmTm9uRW1wdHkobWVzc2FnZUFycmF5LCBmaXJzdCk7XG4gICAgICBmb3IgKGxldCBpID0gMjsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCB2YWwgPSBhcmd1bWVudHNbaV07XG4gICAgICAgIGlmICh2YWwgJiYgdmFsLnRhZ05hbWUpIHtcbiAgICAgICAgICBmaXJzdEVsZW1lbnQgPSB2YWw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmV4dENvbnN0YW50ID0gc3BsaXRNZXNzYWdlLnNoaWZ0KCk7XG4gICAgICAgIG1lc3NhZ2VBcnJheS5wdXNoKHZhbCk7XG4gICAgICAgIHB1c2hJZk5vbkVtcHR5KG1lc3NhZ2VBcnJheSwgbmV4dENvbnN0YW50LnRyaW0oKSk7XG4gICAgICAgIGZvcm1hdHRlZCArPSB0b1N0cmluZyh2YWwpICsgbmV4dENvbnN0YW50O1xuICAgICAgfVxuICAgICAgY29uc3QgZSA9IG5ldyBFcnJvcihmb3JtYXR0ZWQpO1xuICAgICAgZS5mcm9tQXNzZXJ0ID0gdHJ1ZTtcbiAgICAgIGUuYXNzb2NpYXRlZEVsZW1lbnQgPSBmaXJzdEVsZW1lbnQ7XG4gICAgICBlLm1lc3NhZ2VBcnJheSA9IG1lc3NhZ2VBcnJheTtcbiAgICAgIHRoaXMucHJlcGFyZUVycm9yXyhlKTtcbiAgICAgIC8vIHJlcG9ydEVycm9yIGlzIGluc3RhbGxlZCBnbG9iYWxseSBwZXIgd2luZG93IGluIHRoZSBlbnRyeSBwb2ludC5cbiAgICAgIHNlbGYucmVwb3J0RXJyb3IoZSk7XG4gICAgICB0aHJvdyBlO1xuICAgIH1cbiAgICByZXR1cm4gc2hvdWxkQmVUcnVlaXNoO1xuICB9XG5cbiAgLyoqXG4gICAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgZmlyc3QgYXJndW1lbnQgaXNuJ3QgYW4gRWxlbWVudFxuICAgKlxuICAgKiBPdGhlcndpc2Ugc2VlIGBhc3NlcnRgIGZvciB1c2FnZVxuICAgKlxuICAgKiBAcGFyYW0geyp9IHNob3VsZEJlRWxlbWVudFxuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9tZXNzYWdlIFRoZSBhc3NlcnRpb24gbWVzc2FnZVxuICAgKiBAcmV0dXJuIHshRWxlbWVudH0gVGhlIHZhbHVlIG9mIHNob3VsZEJlVHJ1ZWlzaC5cbiAgICogQHRlbXBsYXRlIFRcbiAgICogZXNsaW50IFwiZ29vZ2xlLWNhbWVsY2FzZS9nb29nbGUtY2FtZWxjYXNlXCI6IDJcbiAgICovXG4gIGFzc2VydEVsZW1lbnQoc2hvdWxkQmVFbGVtZW50LCBvcHRfbWVzc2FnZSkge1xuICAgIGNvbnN0IHNob3VsZEJlVHJ1ZWlzaCA9IHNob3VsZEJlRWxlbWVudCAmJiBzaG91bGRCZUVsZW1lbnQubm9kZVR5cGUgPT0gMTtcbiAgICB0aGlzLmFzc2VydChzaG91bGRCZVRydWVpc2gsIChvcHRfbWVzc2FnZSB8fCAnRWxlbWVudCBleHBlY3RlZCcpICsgJzogJXMnLFxuICAgICAgICBzaG91bGRCZUVsZW1lbnQpO1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFFbGVtZW50fSAqLyAoc2hvdWxkQmVFbGVtZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzbid0IGEgc3RyaW5nLiBUaGUgc3RyaW5nIGNhblxuICAgKiBiZSBlbXB0eS5cbiAgICpcbiAgICogRm9yIG1vcmUgZGV0YWlscyBzZWUgYGFzc2VydGAuXG4gICAqXG4gICAqIEBwYXJhbSB7Kn0gc2hvdWxkQmVTdHJpbmdcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfbWVzc2FnZSBUaGUgYXNzZXJ0aW9uIG1lc3NhZ2VcbiAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgc3RyaW5nIHZhbHVlLiBDYW4gYmUgYW4gZW1wdHkgc3RyaW5nLlxuICAgKiBlc2xpbnQgXCJnb29nbGUtY2FtZWxjYXNlL2dvb2dsZS1jYW1lbGNhc2VcIjogMlxuICAgKi9cbiAgYXNzZXJ0U3RyaW5nKHNob3VsZEJlU3RyaW5nLCBvcHRfbWVzc2FnZSkge1xuICAgIHRoaXMuYXNzZXJ0KHR5cGVvZiBzaG91bGRCZVN0cmluZyA9PSAnc3RyaW5nJyxcbiAgICAgICAgKG9wdF9tZXNzYWdlIHx8ICdTdHJpbmcgZXhwZWN0ZWQnKSArICc6ICVzJywgc2hvdWxkQmVTdHJpbmcpO1xuICAgIHJldHVybiAvKiogQHR5cGUge3N0cmluZ30gKi8gKHNob3VsZEJlU3RyaW5nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzbid0IGEgbnVtYmVyLiBUaGUgYWxsb3dlZCB2YWx1ZXNcbiAgICogaW5jbHVkZSBgMGAgYW5kIGBOYU5gLlxuICAgKlxuICAgKiBGb3IgbW9yZSBkZXRhaWxzIHNlZSBgYXNzZXJ0YC5cbiAgICpcbiAgICogQHBhcmFtIHsqfSBzaG91bGRCZU51bWJlclxuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9tZXNzYWdlIFRoZSBhc3NlcnRpb24gbWVzc2FnZVxuICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBudW1iZXIgdmFsdWUuIFRoZSBhbGxvd2VkIHZhbHVlcyBpbmNsdWRlIGAwYFxuICAgKiAgIGFuZCBgTmFOYC5cbiAgICovXG4gIGFzc2VydE51bWJlcihzaG91bGRCZU51bWJlciwgb3B0X21lc3NhZ2UpIHtcbiAgICB0aGlzLmFzc2VydCh0eXBlb2Ygc2hvdWxkQmVOdW1iZXIgPT0gJ251bWJlcicsXG4gICAgICAgIChvcHRfbWVzc2FnZSB8fCAnTnVtYmVyIGV4cGVjdGVkJykgKyAnOiAlcycsIHNob3VsZEJlTnVtYmVyKTtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHtudW1iZXJ9ICovIChzaG91bGRCZU51bWJlcik7XG4gIH1cblxuICAvKipcbiAgICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpc24ndCBhIGJvb2xlYW4uXG4gICAqXG4gICAqIEZvciBtb3JlIGRldGFpbHMgc2VlIGBhc3NlcnRgLlxuICAgKlxuICAgKiBAcGFyYW0geyp9IHNob3VsZEJlQm9vbGVhblxuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9tZXNzYWdlIFRoZSBhc3NlcnRpb24gbWVzc2FnZVxuICAgKiBAcmV0dXJuIHtib29sZWFufSBUaGUgYm9vbGVhbiB2YWx1ZS5cbiAgICovXG4gIGFzc2VydEJvb2xlYW4oc2hvdWxkQmVCb29sZWFuLCBvcHRfbWVzc2FnZSkge1xuICAgIHRoaXMuYXNzZXJ0KCEhc2hvdWxkQmVCb29sZWFuID09PSBzaG91bGRCZUJvb2xlYW4sXG4gICAgICAgIChvcHRfbWVzc2FnZSB8fCAnQm9vbGVhbiBleHBlY3RlZCcpICsgJzogJXMnLCBzaG91bGRCZUJvb2xlYW4pO1xuICAgIHJldHVybiAvKiogQHR5cGUge2Jvb2xlYW59ICovIChzaG91bGRCZUJvb2xlYW4pO1xuICB9XG5cbiAgLyoqXG4gICAqIEFzc2VydHMgYW5kIHJldHVybnMgdGhlIGVudW0gdmFsdWUuIElmIHRoZSBlbnVtIGRvZXNuJ3QgY29udGFpbiBzdWNoIGFcbiAgICogdmFsdWUsIHRoZSBlcnJvciBpcyB0aHJvd24uXG4gICAqXG4gICAqIEBwYXJhbSB7IU9iamVjdDxUPn0gZW51bU9ialxuICAgKiBAcGFyYW0ge3N0cmluZ30gc1xuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9lbnVtTmFtZVxuICAgKiBAcmV0dXJuIHtUfVxuICAgKiBAdGVtcGxhdGUgVFxuICAgKiBlc2xpbnQgXCJnb29nbGUtY2FtZWxjYXNlL2dvb2dsZS1jYW1lbGNhc2VcIjogMlxuICAgKi9cbiAgYXNzZXJ0RW51bVZhbHVlKGVudW1PYmosIHMsIG9wdF9lbnVtTmFtZSkge1xuICAgIGlmIChpc0VudW1WYWx1ZShlbnVtT2JqLCBzKSkge1xuICAgICAgcmV0dXJuIHM7XG4gICAgfVxuICAgIHRoaXMuYXNzZXJ0KGZhbHNlLFxuICAgICAgICAnVW5rbm93biAlcyB2YWx1ZTogXCIlc1wiJyxcbiAgICAgICAgb3B0X2VudW1OYW1lIHx8ICdlbnVtJywgcyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRXJyb3J9IGVycm9yXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcmVwYXJlRXJyb3JfKGVycm9yKSB7XG4gICAgZXJyb3IgPSBkdXBsaWNhdGVFcnJvcklmTmVjZXNzYXJ5KGVycm9yKTtcbiAgICBpZiAodGhpcy5zdWZmaXhfKSB7XG4gICAgICBpZiAoIWVycm9yLm1lc3NhZ2UpIHtcbiAgICAgICAgZXJyb3IubWVzc2FnZSA9IHRoaXMuc3VmZml4XztcbiAgICAgIH0gZWxzZSBpZiAoZXJyb3IubWVzc2FnZS5pbmRleE9mKHRoaXMuc3VmZml4XykgPT0gLTEpIHtcbiAgICAgICAgZXJyb3IubWVzc2FnZSArPSB0aGlzLnN1ZmZpeF87XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChpc1VzZXJFcnJvck1lc3NhZ2UoZXJyb3IubWVzc2FnZSkpIHtcbiAgICAgIGVycm9yLm1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlLnJlcGxhY2UoVVNFUl9FUlJPUl9TRU5USU5FTCwgJycpO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfCFFbGVtZW50fSB2YWxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gdG9TdHJpbmcodmFsKSB7XG4gIC8vIERvIGNoZWNrIGVxdWl2YWxlbnQgdG8gYHZhbCBpbnN0YW5jZW9mIEVsZW1lbnRgIHdpdGhvdXQgY3Jvc3Mtd2luZG93IGJ1Z1xuICBpZiAodmFsICYmIHZhbC5ub2RlVHlwZSA9PSAxKSB7XG4gICAgcmV0dXJuIHZhbC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgKyAodmFsLmlkID8gJyMnICsgdmFsLmlkIDogJycpO1xuICB9XG4gIHJldHVybiAvKiogQHR5cGUge3N0cmluZ30gKi8gKHZhbCk7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFBcnJheX0gYXJyYXlcbiAqIEBwYXJhbSB7Kn0gdmFsXG4gKi9cbmZ1bmN0aW9uIHB1c2hJZk5vbkVtcHR5KGFycmF5LCB2YWwpIHtcbiAgaWYgKHZhbCAhPSAnJykge1xuICAgIGFycmF5LnB1c2godmFsKTtcbiAgfVxufVxuXG4vKipcbiAqIFNvbWUgZXhjZXB0aW9ucyAoRE9NRXhjZXB0aW9uLCBuYW1lbHkpIGhhdmUgcmVhZC1vbmx5IG1lc3NhZ2UuXG4gKiBAcGFyYW0geyFFcnJvcn0gZXJyb3JcbiAqIEByZXR1cm4geyFFcnJvcn07XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkdXBsaWNhdGVFcnJvcklmTmVjZXNzYXJ5KGVycm9yKSB7XG4gIGNvbnN0IHttZXNzYWdlfSA9IGVycm9yO1xuICBjb25zdCB0ZXN0ID0gU3RyaW5nKE1hdGgucmFuZG9tKCkpO1xuICBlcnJvci5tZXNzYWdlID0gdGVzdDtcblxuICBpZiAoZXJyb3IubWVzc2FnZSA9PT0gdGVzdCkge1xuICAgIGVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIHJldHVybiBlcnJvcjtcbiAgfVxuXG4gIGNvbnN0IGUgPSBuZXcgRXJyb3IoZXJyb3IubWVzc2FnZSk7XG4gIC8vIENvcHkgYWxsIHRoZSBleHRyYW5lb3VzIHRoaW5ncyB3ZSBhdHRhY2guXG4gIGZvciAoY29uc3QgcHJvcCBpbiBlcnJvcikge1xuICAgIGVbcHJvcF0gPSBlcnJvcltwcm9wXTtcbiAgfVxuICAvLyBFbnN1cmUgdGhlc2UgYXJlIGNvcGllZC5cbiAgZS5zdGFjayA9IGVycm9yLnN0YWNrO1xuICByZXR1cm4gZTtcbn1cblxuLyoqXG4gKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gKiBAcmV0dXJuIHshRXJyb3J9XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVycm9yVmFyZ3ModmFyX2FyZ3MpIHtcbiAgbGV0IGVycm9yID0gbnVsbDtcbiAgbGV0IG1lc3NhZ2UgPSAnJztcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBhcmcgPSBhcmd1bWVudHNbaV07XG4gICAgaWYgKGFyZyBpbnN0YW5jZW9mIEVycm9yICYmICFlcnJvcikge1xuICAgICAgZXJyb3IgPSBkdXBsaWNhdGVFcnJvcklmTmVjZXNzYXJ5KGFyZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICAgIG1lc3NhZ2UgKz0gJyAnO1xuICAgICAgfVxuICAgICAgbWVzc2FnZSArPSBhcmc7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFlcnJvcikge1xuICAgIGVycm9yID0gbmV3IEVycm9yKG1lc3NhZ2UpO1xuICB9IGVsc2UgaWYgKG1lc3NhZ2UpIHtcbiAgICBlcnJvci5tZXNzYWdlID0gbWVzc2FnZSArICc6ICcgKyBlcnJvci5tZXNzYWdlO1xuICB9XG4gIHJldHVybiBlcnJvcjtcbn1cblxuXG4vKipcbiAqIFJldGhyb3dzIHRoZSBlcnJvciB3aXRob3V0IHRlcm1pbmF0aW5nIHRoZSBjdXJyZW50IGNvbnRleHQuIFRoaXMgcHJlc2VydmVzXG4gKiB3aGV0aGVyIHRoZSBvcmlnaW5hbCBlcnJvciBkZXNpZ25hdGlvbiBpcyBhIHVzZXIgZXJyb3Igb3IgYSBkZXYgZXJyb3IuXG4gKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXRocm93QXN5bmModmFyX2FyZ3MpIHtcbiAgY29uc3QgZXJyb3IgPSBjcmVhdGVFcnJvclZhcmdzLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIC8vIHJlcG9ydEVycm9yIGlzIGluc3RhbGxlZCBnbG9iYWxseSBwZXIgd2luZG93IGluIHRoZSBlbnRyeSBwb2ludC5cbiAgICBzZWxmLnJlcG9ydEVycm9yKGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfSk7XG59XG5cblxuLyoqXG4gKiBDYWNoZSBmb3IgbG9ncy4gV2UgZG8gbm90IHVzZSBhIFNlcnZpY2Ugc2luY2UgdGhlIHNlcnZpY2UgbW9kdWxlIGRlcGVuZHNcbiAqIG9uIExvZyBhbmQgY2xvc3VyZSBsaXRlcmFsbHkgY2FuJ3QgZXZlbi5cbiAqIEB0eXBlIHt7dXNlcjogP0xvZywgZGV2OiA/TG9nLCB1c2VyRm9yRW1iZWQ6ID9Mb2d9fVxuICovXG5zZWxmLmxvZyA9IChzZWxmLmxvZyB8fCB7XG4gIHVzZXI6IG51bGwsXG4gIGRldjogbnVsbCxcbiAgdXNlckZvckVtYmVkOiBudWxsLFxufSk7XG5cbmNvbnN0IGxvZ3MgPSBzZWxmLmxvZztcblxuLyoqXG4gKiBFdmVudHVhbGx5IGhvbGRzIGEgY29uc3RydWN0b3IgZm9yIExvZyBvYmplY3RzLiBMYXppbHkgaW5pdGlhbGl6ZWQsIHNvIHdlXG4gKiBjYW4gYXZvaWQgZXZlciByZWZlcmVuY2luZyB0aGUgcmVhbCBjb25zdHJ1Y3RvciBleGNlcHQgaW4gSlMgYmluYXJpZXNcbiAqIHRoYXQgYWN0dWFsbHkgd2FudCB0byBpbmNsdWRlIHRoZSBpbXBsZW1lbnRhdGlvbi5cbiAqIEB0eXBlIHs/RnVuY3Rpb259XG4gKi9cbmxldCBsb2dDb25zdHJ1Y3RvciA9IG51bGw7XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgbG9nIGNvbnRydWN0b3IuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbml0TG9nQ29uc3RydWN0b3IoKSB7XG4gIGxvZ0NvbnN0cnVjdG9yID0gTG9nO1xuICAvLyBJbml0aWFsaXplIGluc3RhbmNlcyBmb3IgdXNlLiBJZiBhIGJpbmFyeSAoYW4gZXh0ZW5zaW9uIGZvciBleGFtcGxlKSB0aGF0XG4gIC8vIGRvZXMgbm90IGNhbGwgYGluaXRMb2dDb25zdHJ1Y3RvcmAgaW52b2tlcyBgZGV2KClgIG9yIGB1c2VyKClgIGVhcmxpZXIgdGhhblxuICAvLyB0aGUgYmluYXJ5IHRoYXQgZG9lcyBjYWxsIGBpbml0TG9nQ29uc3RydWN0b3JgIChhbXAuanMpLCB0aGUgZXh0ZW5zaW9uIHdpbGxcbiAgLy8gdGhyb3cgYW4gZXJyb3IgYXMgdGhhdCBleHRlbnNpb24gd2lsbCBuZXZlciBiZSBhYmxlIHRvIGluaXRpYWxpemUgdGhlIGxvZ1xuICAvLyBpbnN0YW5jZXMgYW5kIHdlIGFsc28gZG9uJ3Qgd2FudCBpdCB0byBjYWxsIGBpbml0TG9nQ29uc3RydWN0b3JgIGVpdGhlclxuICAvLyAoc2luY2UgdGhhdCB3aWxsIGNhdXNlIHRoZSBMb2cgaW1wbGVtZW50YXRpb24gdG8gYmUgYnVuZGxlZCBpbnRvIHRoYXRcbiAgLy8gYmluYXJ5KS4gU28gd2UgbXVzdCBpbml0aWFsaXplIHRoZSBpbnN0YW5jZXMgZWFnZXJseSBzbyB0aGF0IHRoZXkgYXJlIHJlYWR5XG4gIC8vIGZvciB1c2UgKHN0b3JlZCBnbG9iYWxseSkgYWZ0ZXIgdGhlIG1haW4gYmluYXJ5IGNhbGxzIGBpbml0TG9nQ29uc3RydWN0b3JgLlxuICBkZXYoKTtcbiAgdXNlcigpO1xufVxuXG4vKipcbiAqIFJlc2V0cyBsb2cgY29udHJ1Y3RvciBmb3IgdGVzdGluZy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0TG9nQ29uc3RydWN0b3JGb3JUZXN0aW5nKCkge1xuICBsb2dDb25zdHJ1Y3RvciA9IG51bGw7XG59XG5cbi8qKlxuICogUHVibGlzaGVyIGxldmVsIGxvZy5cbiAqXG4gKiBFbmFibGVkIGluIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAqICAxLiBOb3QgZGlzYWJsZWQgdXNpbmcgYCNsb2c9MGAuXG4gKiAgMi4gRGV2ZWxvcG1lbnQgbW9kZSBpcyBlbmFibGVkIHZpYSBgI2RldmVsb3BtZW50PTFgIG9yIGxvZ2dpbmcgaXMgZXhwbGljaXRseVxuICogICAgIGVuYWJsZWQgdmlhIGAjbG9nPURgIHdoZXJlIEQgPj0gMS5cbiAqICAzLiBBTVAuc2V0TG9nTGV2ZWwoRCkgaXMgY2FsbGVkLCB3aGVyZSBEID49IDEuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudD19IG9wdF9lbGVtZW50XG4gKiBAcmV0dXJuIHshTG9nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlcihvcHRfZWxlbWVudCkge1xuICBpZiAoIWxvZ3MudXNlcikge1xuICAgIGxvZ3MudXNlciA9IGdldFVzZXJMb2dnZXIoVVNFUl9FUlJPUl9TRU5USU5FTCk7XG4gIH1cbiAgaWYgKCFpc0Zyb21FbWJlZChsb2dzLnVzZXIud2luLCBvcHRfZWxlbWVudCkpIHtcbiAgICByZXR1cm4gbG9ncy51c2VyO1xuICB9IGVsc2Uge1xuICAgIGlmIChsb2dzLnVzZXJGb3JFbWJlZCkge1xuICAgICAgcmV0dXJuIGxvZ3MudXNlckZvckVtYmVkO1xuICAgIH1cbiAgICByZXR1cm4gbG9ncy51c2VyRm9yRW1iZWQgPSBnZXRVc2VyTG9nZ2VyKFVTRVJfRVJST1JfRU1CRURfU0VOVElORUwpO1xuICB9XG59XG5cbi8qKlxuICogR2V0dGVyIGZvciB1c2VyIGxvZ2dlclxuICogQHBhcmFtIHtzdHJpbmc9fSBzdWZmaXhcbiAqIEByZXR1cm4geyFMb2d9XG4gKi9cbmZ1bmN0aW9uIGdldFVzZXJMb2dnZXIoc3VmZml4KSB7XG4gIGlmICghbG9nQ29uc3RydWN0b3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2ZhaWxlZCB0byBjYWxsIGluaXRMb2dDb25zdHJ1Y3RvcicpO1xuICB9XG4gIHJldHVybiBuZXcgbG9nQ29uc3RydWN0b3Ioc2VsZiwgbW9kZSA9PiB7XG4gICAgY29uc3QgbG9nTnVtID0gcGFyc2VJbnQobW9kZS5sb2csIDEwKTtcbiAgICBpZiAobW9kZS5kZXZlbG9wbWVudCB8fCBsb2dOdW0gPj0gMSkge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLkZJTkU7XG4gICAgfVxuICAgIHJldHVybiBMb2dMZXZlbC5XQVJOO1xuICB9LCBzdWZmaXgpO1xufVxuXG4vKipcbiAqIEFNUCBkZXZlbG9wbWVudCBsb2cuIENhbGxzIHRvIGBkZXZMb2coKS5hc3NlcnRgIGFuZCBgZGV2LmZpbmVgIGFyZSBzdHJpcHBlZFxuICogaW4gdGhlIFBST0QgYmluYXJ5LiBIb3dldmVyLCBgZGV2TG9nKCkuYXNzZXJ0YCByZXN1bHQgaXMgcHJlc2VydmVkIGluIGVpdGhlclxuICogY2FzZS5cbiAqXG4gKiBFbmFibGVkIGluIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAqICAxLiBOb3QgZGlzYWJsZWQgdXNpbmcgYCNsb2c9MGAuXG4gKiAgMi4gTG9nZ2luZyBpcyBleHBsaWNpdGx5IGVuYWJsZWQgdmlhIGAjbG9nPURgLCB3aGVyZSBEID49IDIuXG4gKiAgMy4gQU1QLnNldExvZ0xldmVsKEQpIGlzIGNhbGxlZCwgd2hlcmUgRCA+PSAyLlxuICpcbiAqIEByZXR1cm4geyFMb2d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZXYoKSB7XG4gIGlmIChsb2dzLmRldikge1xuICAgIHJldHVybiBsb2dzLmRldjtcbiAgfVxuICBpZiAoIWxvZ0NvbnN0cnVjdG9yKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdmYWlsZWQgdG8gY2FsbCBpbml0TG9nQ29uc3RydWN0b3InKTtcbiAgfVxuICByZXR1cm4gbG9ncy5kZXYgPSBuZXcgbG9nQ29uc3RydWN0b3Ioc2VsZiwgbW9kZSA9PiB7XG4gICAgY29uc3QgbG9nTnVtID0gcGFyc2VJbnQobW9kZS5sb2csIDEwKTtcbiAgICBpZiAobG9nTnVtID49IDMpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5GSU5FO1xuICAgIH1cbiAgICBpZiAobG9nTnVtID49IDIpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5JTkZPO1xuICAgIH1cbiAgICByZXR1cm4gTG9nTGV2ZWwuT0ZGO1xuICB9KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshRWxlbWVudD19IG9wdF9lbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufSBpc0VtYmVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Zyb21FbWJlZCh3aW4sIG9wdF9lbGVtZW50KSB7XG4gIGlmICghb3B0X2VsZW1lbnQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIG9wdF9lbGVtZW50Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcgIT0gd2luO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7Z2V0TW9kZX0gZnJvbSAnLi9tb2RlJztcblxuLyoqXG4gKiBQcm92aWRlcyBpbmZvIGFib3V0IHRoZSBjdXJyZW50IGFwcC4gVGhpcyByZXR1cm4gdmFsdWUgbWF5IGJlIGNhY2hlZCBhbmRcbiAqIHBhc3NlZCBhcm91bmQgYXMgaXQgd2lsbCBhbHdheXMgYmUgRENFJ2QuXG4gKiBAcGFyYW0gez9XaW5kb3c9fSBvcHRfd2luXG4gKiBAcmV0dXJuIHshLi9tb2RlLk1vZGVEZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRNb2RlT2JqZWN0KG9wdF93aW4pIHtcbiAgcmV0dXJuIHtcbiAgICBsb2NhbERldjogZ2V0TW9kZShvcHRfd2luKS5sb2NhbERldixcbiAgICBkZXZlbG9wbWVudDogZ2V0TW9kZShvcHRfd2luKS5kZXZlbG9wbWVudCxcbiAgICBmaWx0ZXI6IGdldE1vZGUob3B0X3dpbikuZmlsdGVyLFxuICAgIG1pbmlmaWVkOiBnZXRNb2RlKG9wdF93aW4pLm1pbmlmaWVkLFxuICAgIGxpdGU6IGdldE1vZGUob3B0X3dpbikubGl0ZSxcbiAgICB0ZXN0OiBnZXRNb2RlKG9wdF93aW4pLnRlc3QsXG4gICAgbG9nOiBnZXRNb2RlKG9wdF93aW4pLmxvZyxcbiAgICB2ZXJzaW9uOiBnZXRNb2RlKG9wdF93aW4pLnZlcnNpb24sXG4gICAgcnR2VmVyc2lvbjogZ2V0TW9kZShvcHRfd2luKS5ydHZWZXJzaW9uLFxuICB9O1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7cGFyc2VRdWVyeVN0cmluZ199IGZyb20gJy4vdXJsLXBhcnNlLXF1ZXJ5LXN0cmluZyc7XG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgbG9jYWxEZXY6IGJvb2xlYW4sXG4gKiAgIGRldmVsb3BtZW50OiBib29sZWFuLFxuICogICBmaWx0ZXI6IChzdHJpbmd8dW5kZWZpbmVkKSxcbiAqICAgbWluaWZpZWQ6IGJvb2xlYW4sXG4gKiAgIGxpdGU6IGJvb2xlYW4sXG4gKiAgIHRlc3Q6IGJvb2xlYW4sXG4gKiAgIGxvZzogKHN0cmluZ3x1bmRlZmluZWQpLFxuICogICB2ZXJzaW9uOiBzdHJpbmcsXG4gKiAgIHJ0dlZlcnNpb246IHN0cmluZyxcbiAqIH19XG4gKi9cbmV4cG9ydCBsZXQgTW9kZURlZjtcblxuLyoqIEB0eXBlIHtzdHJpbmd9ICovXG5jb25zdCB2ZXJzaW9uID0gJyRpbnRlcm5hbFJ1bnRpbWVWZXJzaW9uJCc7XG5cbi8qKlxuICogYHJ0dlZlcnNpb25gIGlzIHRoZSBwcmVmaXhlZCB2ZXJzaW9uIHdlIHNlcnZlIG9mZiBvZiB0aGUgY2RuLlxuICogVGhlIHByZWZpeCBkZW5vdGVzIGNhbmFyeSgwMCkgb3IgcHJvZCgwMSkgb3IgYW4gZXhwZXJpbWVudCB2ZXJzaW9uICggPiAwMSkuXG4gKiBAdHlwZSB7c3RyaW5nfVxuICovXG5sZXQgcnR2VmVyc2lvbiA9ICcnO1xuXG4vKipcbiAqIFByb3ZpZGVzIGluZm8gYWJvdXQgdGhlIGN1cnJlbnQgYXBwLlxuICogQHBhcmFtIHs/V2luZG93PX0gb3B0X3dpblxuICogQHJldHVybiB7IU1vZGVEZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRNb2RlKG9wdF93aW4pIHtcbiAgY29uc3Qgd2luID0gb3B0X3dpbiB8fCBzZWxmO1xuICBpZiAod2luLkFNUF9NT0RFKSB7XG4gICAgcmV0dXJuIHdpbi5BTVBfTU9ERTtcbiAgfVxuICByZXR1cm4gd2luLkFNUF9NT0RFID0gZ2V0TW9kZV8od2luKTtcbn1cblxuLyoqXG4gKiBQcm92aWRlcyBpbmZvIGFib3V0IHRoZSBjdXJyZW50IGFwcC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshTW9kZURlZn1cbiAqL1xuZnVuY3Rpb24gZ2V0TW9kZV8od2luKSB7XG4gIC8vIE1hZ2ljIGNvbnN0YW50cyB0aGF0IGFyZSByZXBsYWNlZCBieSBjbG9zdXJlIGNvbXBpbGVyLlxuICAvLyBJU19NSU5JRklFRCBpcyBhbHdheXMgcmVwbGFjZWQgd2l0aCB0cnVlIHdoZW4gY2xvc3VyZSBjb21waWxlciBpcyB1c2VkXG4gIC8vIHdoaWxlIElTX0RFViBpcyBvbmx5IHJlcGxhY2VkIHdoZW4gYGd1bHAgZGlzdGAgaXMgY2FsbGVkIHdpdGhvdXQgdGhlXG4gIC8vIC0tZm9ydGVzdGluZyBmbGFnLlxuICBjb25zdCBJU19ERVYgPSB0cnVlO1xuICBjb25zdCBJU19NSU5JRklFRCA9IGZhbHNlO1xuXG4gIGNvbnN0IGxvY2FsRGV2RW5hYmxlZCA9ICEhKHNlbGYuQU1QX0NPTkZJRyAmJiBzZWxmLkFNUF9DT05GSUcubG9jYWxEZXYpO1xuICBjb25zdCBydW5uaW5nVGVzdHMgPSBJU19ERVYgJiYgISEod2luLkFNUF9URVNUIHx8IHdpbi5fX2thcm1hX18pO1xuICBjb25zdCBpc0xvY2FsRGV2ID0gSVNfREVWICYmIChsb2NhbERldkVuYWJsZWQgfHwgcnVubmluZ1Rlc3RzKTtcbiAgY29uc3QgaGFzaFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZ18oXG4gICAgICAvLyBsb2NhdGlvbi5vcmlnaW5hbEhhc2ggaXMgc2V0IGJ5IHRoZSB2aWV3ZXIgd2hlbiBpdCByZW1vdmVzIHRoZSBmcmFnbWVudFxuICAgICAgLy8gZnJvbSB0aGUgVVJMLlxuICAgICAgd2luLmxvY2F0aW9uLm9yaWdpbmFsSGFzaCB8fCB3aW4ubG9jYXRpb24uaGFzaCk7XG5cbiAgY29uc3Qgc2VhcmNoUXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nXyh3aW4ubG9jYXRpb24uc2VhcmNoKTtcblxuICBpZiAoIXJ0dlZlcnNpb24pIHtcbiAgICBydHZWZXJzaW9uID0gZ2V0UnR2VmVyc2lvbih3aW4sIGlzTG9jYWxEZXYpO1xuICB9XG5cbiAgLy8gVGhlIGBtaW5pZmllZGAsIGB0ZXN0YCBhbmQgYGxvY2FsRGV2YCBwcm9wZXJ0aWVzIGFyZSByZXBsYWNlZFxuICAvLyBhcyBib29sZWFuIGxpdGVyYWxzIHdoZW4gd2UgcnVuIGBndWxwIGRpc3RgIHdpdGhvdXQgdGhlIGAtLWZvcnRlc3RpbmdgXG4gIC8vIGZsYWdzLiBUaGlzIGltcHJvdmVkIERDRSBvbiB0aGUgcHJvZHVjdGlvbiBmaWxlIHdlIGRlcGxveSBhcyB0aGUgY29kZVxuICAvLyBwYXRocyBmb3IgbG9jYWxob3N0L3Rlc3RpbmcvZGV2ZWxvcG1lbnQgYXJlIGVsaW1pbmF0ZWQuXG4gIHJldHVybiB7XG4gICAgbG9jYWxEZXY6IGlzTG9jYWxEZXYsXG4gICAgLy8gVHJpZ2dlcnMgdmFsaWRhdGlvbiBvciBlbmFibGUgcHViIGxldmVsIGxvZ2dpbmcuIFZhbGlkYXRpb24gY2FuIGJlXG4gICAgLy8gYnlwYXNzZWQgdmlhICN2YWxpZGF0ZT0wLlxuICAgIC8vIE5vdGUgdGhhdCBBTVBfREVWX01PREUgZmxhZyBpcyB1c2VkIGZvciB0ZXN0aW5nIHB1cnBvc2VzLlxuICAgIGRldmVsb3BtZW50OiAhIShoYXNoUXVlcnlbJ2RldmVsb3BtZW50J10gPT0gJzEnIHx8IHdpbi5BTVBfREVWX01PREUpLFxuICAgIGV4YW1pbmVyOiBoYXNoUXVlcnlbJ2RldmVsb3BtZW50J10gPT0gJzInLFxuICAgIC8vIEFsbG93cyBmaWx0ZXJpbmcgdmFsaWRhdGlvbiBlcnJvcnMgYnkgZXJyb3IgY2F0ZWdvcnkuIEZvciB0aGVcbiAgICAvLyBhdmFpbGFibGUgY2F0ZWdvcmllcywgc2VlIEVycm9yQ2F0ZWdvcnkgaW4gdmFsaWRhdG9yL3ZhbGlkYXRvci5wcm90by5cbiAgICBmaWx0ZXI6IGhhc2hRdWVyeVsnZmlsdGVyJ10sXG4gICAgLy8gYW1wLWdlbyBvdmVycmlkZVxuICAgIGdlb092ZXJyaWRlOiBoYXNoUXVlcnlbJ2FtcC1nZW8nXSxcbiAgICBtaW5pZmllZDogSVNfTUlOSUZJRUQsXG4gICAgLy8gV2hldGhlciBkb2N1bWVudCBpcyBpbiBhbiBhbXAtbGl0ZSB2aWV3ZXIuIEl0IHNpZ25hbCB0aGF0IHRoZSB1c2VyXG4gICAgLy8gd291bGQgcHJlZmVyIHRvIHVzZSBsZXNzIGJhbmR3aWR0aC5cbiAgICBsaXRlOiBzZWFyY2hRdWVyeVsnYW1wX2xpdGUnXSAhPSB1bmRlZmluZWQsXG4gICAgdGVzdDogcnVubmluZ1Rlc3RzLFxuICAgIGxvZzogaGFzaFF1ZXJ5Wydsb2cnXSxcbiAgICB2ZXJzaW9uLFxuICAgIHJ0dlZlcnNpb24sXG4gIH07XG59XG5cbi8qKlxuICogUmV0cmlldmUgdGhlIGBydHZWZXJzaW9uYCB3aGljaCB3aWxsIGhhdmUgYSBudW1lcmljIHByZWZpeFxuICogZGVub3RpbmcgY2FuYXJ5L3Byb2QvZXhwZXJpbWVudCAodW5sZXNzIGBpc0xvY2FsRGV2YCBpcyB0cnVlKS5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtib29sZWFufSBpc0xvY2FsRGV2XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGdldFJ0dlZlcnNpb24od2luLCBpc0xvY2FsRGV2KSB7XG4gIC8vIElmIGl0J3MgbG9jYWwgZGV2IHRoZW4gd2Ugd29uJ3QgYWN0dWFsbHkgaGF2ZSBhIGZ1bGwgdmVyc2lvbiBzb1xuICAvLyBqdXN0IHVzZSB0aGUgdmVyc2lvbi5cbiAgaWYgKGlzTG9jYWxEZXYpIHtcbiAgICByZXR1cm4gdmVyc2lvbjtcbiAgfVxuXG4gIGlmICh3aW4uQU1QX0NPTkZJRyAmJiB3aW4uQU1QX0NPTkZJRy52KSB7XG4gICAgcmV0dXJuIHdpbi5BTVBfQ09ORklHLnY7XG4gIH1cblxuICAvLyBDdXJyZW50bHkgYCRpbnRlcm5hbFJ1bnRpbWVWZXJzaW9uJGAgYW5kIHRodXMgYG1vZGUudmVyc2lvbmAgY29udGFpbiBvbmx5XG4gIC8vIG1ham9yIHZlcnNpb24uIFRoZSBmdWxsIHZlcnNpb24gaG93ZXZlciBtdXN0IGFsc28gY2FycnkgdGhlIG1pbm9yIHZlcnNpb24uXG4gIC8vIFdlIHdpbGwgZGVmYXVsdCB0byBwcm9kdWN0aW9uIGRlZmF1bHQgYDAxYCBtaW5vciB2ZXJzaW9uIGZvciBub3cuXG4gIC8vIFRPRE8oZXJ3aW5tb21iYXkpOiBkZWNpZGUgd2hldGhlciAkaW50ZXJuYWxSdW50aW1lVmVyc2lvbiQgc2hvdWxkIGNvbnRhaW5cbiAgLy8gbWlub3IgdmVyc2lvbi5cbiAgcmV0dXJuIGAwMSR7dmVyc2lvbn1gO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNMb2NhbERldlxuICogQHJldHVybiB7c3RyaW5nfVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRSdHZWZXJzaW9uRm9yVGVzdGluZyh3aW4sIGlzTG9jYWxEZXYpIHtcbiAgcmV0dXJuIGdldFJ0dlZlcnNpb24od2luLCBpc0xvY2FsRGV2KTtcbn1cblxuXG4vKiogQHZpc2libGVGb3JUZXN0aW5nICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRSdHZWZXJzaW9uRm9yVGVzdGluZygpIHtcbiAgcnR2VmVyc2lvbiA9ICcnO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuXG4vKipcbiAqIFRoaXMgY2xhc3MgaGVscHMgdG8gbWFuYWdlIG9ic2VydmVycy4gT2JzZXJ2ZXJzIGNhbiBiZSBhZGRlZCwgcmVtb3ZlZCBvclxuICogZmlyZWQgdGhyb3VnaCBhbmQgaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAqIEB0ZW1wbGF0ZSBUWVBFXG4gKi9cbmV4cG9ydCBjbGFzcyBPYnNlcnZhYmxlIHtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBPYnNlcnZhYmxlLlxuICAgKi9cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLyoqIEB0eXBlIHs/QXJyYXk8ZnVuY3Rpb24oVFlQRSk+fSAqL1xuICAgIHRoaXMuaGFuZGxlcnNfID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIHRoZSBvYnNlcnZlciB0byB0aGlzIGluc3RhbmNlLlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKFRZUEUpfSBoYW5kbGVyIE9ic2VydmVyJ3MgaGFuZGxlci5cbiAgICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICAgKi9cbiAgYWRkKGhhbmRsZXIpIHtcbiAgICBpZiAoIXRoaXMuaGFuZGxlcnNfKSB7XG4gICAgICB0aGlzLmhhbmRsZXJzXyA9IFtdO1xuICAgIH1cbiAgICB0aGlzLmhhbmRsZXJzXy5wdXNoKGhhbmRsZXIpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICB0aGlzLnJlbW92ZShoYW5kbGVyKTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgdGhlIG9ic2VydmVyIGZyb20gdGhpcyBpbnN0YW5jZS5cbiAgICogQHBhcmFtIHtmdW5jdGlvbihUWVBFKX0gaGFuZGxlciBPYnNlcnZlcidzIGluc3RhbmNlLlxuICAgKi9cbiAgcmVtb3ZlKGhhbmRsZXIpIHtcbiAgICBpZiAoIXRoaXMuaGFuZGxlcnNfKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5oYW5kbGVyc18uaW5kZXhPZihoYW5kbGVyKTtcbiAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgdGhpcy5oYW5kbGVyc18uc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlcyBhbGwgb2JzZXJ2ZXJzLlxuICAgKi9cbiAgcmVtb3ZlQWxsKCkge1xuICAgIGlmICghdGhpcy5oYW5kbGVyc18pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5oYW5kbGVyc18ubGVuZ3RoID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBGaXJlcyBhbiBldmVudC4gQWxsIG9ic2VydmVycyBhcmUgY2FsbGVkLlxuICAgKiBAcGFyYW0ge1RZUEU9fSBvcHRfZXZlbnRcbiAgICovXG4gIGZpcmUob3B0X2V2ZW50KSB7XG4gICAgaWYgKCF0aGlzLmhhbmRsZXJzXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBoYW5kbGVycyA9IHRoaXMuaGFuZGxlcnNfO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaGFuZGxlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGhhbmRsZXIgPSBoYW5kbGVyc1tpXTtcbiAgICAgIGhhbmRsZXIob3B0X2V2ZW50KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBudW1iZXIgb2YgaGFuZGxlcnMuIE1vc3RseSBuZWVkZWQgZm9yIHRlc3RzLlxuICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAqL1xuICBnZXRIYW5kbGVyQ291bnQoKSB7XG4gICAgaWYgKCF0aGlzLmhhbmRsZXJzXykge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmhhbmRsZXJzXy5sZW5ndGg7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4vbW9kZSc7XG5pbXBvcnQge2luc3RhbGwgYXMgaW5zdGFsbEFycmF5SW5jbHVkZXN9IGZyb20gJy4vcG9seWZpbGxzL2FycmF5LWluY2x1ZGVzJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsQ3VzdG9tRWxlbWVudHN9IGZyb20gJy4vcG9seWZpbGxzL2N1c3RvbS1lbGVtZW50cyc7XG5pbXBvcnQge1xuICBpbnN0YWxsIGFzIGluc3RhbGxET01Ub2tlbkxpc3RUb2dnbGUsXG59IGZyb20gJy4vcG9seWZpbGxzL2RvbXRva2VubGlzdC10b2dnbGUnO1xuaW1wb3J0IHtpbnN0YWxsIGFzIGluc3RhbGxEb2NDb250YWluc30gZnJvbSAnLi9wb2x5ZmlsbHMvZG9jdW1lbnQtY29udGFpbnMnO1xuaW1wb3J0IHtpbnN0YWxsIGFzIGluc3RhbGxNYXRoU2lnbn0gZnJvbSAnLi9wb2x5ZmlsbHMvbWF0aC1zaWduJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsT2JqZWN0QXNzaWdufSBmcm9tICcuL3BvbHlmaWxscy9vYmplY3QtYXNzaWduJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsUHJvbWlzZX0gZnJvbSAnLi9wb2x5ZmlsbHMvcHJvbWlzZSc7XG5pbXBvcnQge2luc3RhbGxDdXN0b21FbGVtZW50cyBhcyBpbnN0YWxsUmVnaXN0ZXJFbGVtZW50fSBmcm9tXG4gICdkb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50L2J1aWxkL2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQucGF0Y2hlZCc7XG5pbXBvcnQge2lzRXhwZXJpbWVudE9ufSBmcm9tICcuL2V4cGVyaW1lbnRzJztcblxuaWYgKGlzRXhwZXJpbWVudE9uKHNlbGYsICdjdXN0b20tZWxlbWVudHMtdjEnKSB8fCBnZXRNb2RlKCkudGVzdCkge1xuICBpbnN0YWxsQ3VzdG9tRWxlbWVudHMoc2VsZiwgY2xhc3Mge30pO1xufSBlbHNlIHtcbiAgaW5zdGFsbFJlZ2lzdGVyRWxlbWVudChzZWxmLCAnYXV0bycpO1xufVxuaW5zdGFsbERPTVRva2VuTGlzdFRvZ2dsZShzZWxmKTtcbmluc3RhbGxNYXRoU2lnbihzZWxmKTtcbmluc3RhbGxPYmplY3RBc3NpZ24oc2VsZik7XG5pbnN0YWxsUHJvbWlzZShzZWxmKTtcbmluc3RhbGxEb2NDb250YWlucyhzZWxmKTtcbmluc3RhbGxBcnJheUluY2x1ZGVzKHNlbGYpO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIGVsZW1lbnQgaXMgaW4gdGhlIGFycmF5IGFuZCBmYWxzZSBvdGhlcndpc2UuXG4gKlxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHBhcmFtIHtudW1iZXI9fSBvcHRfZnJvbUluZGV4XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHRoaXMge0FycmF5fVxuICovXG5mdW5jdGlvbiBpbmNsdWRlcyh2YWx1ZSwgb3B0X2Zyb21JbmRleCkge1xuICBjb25zdCBmcm9tSW5kZXggPSBvcHRfZnJvbUluZGV4IHx8IDA7XG4gIGNvbnN0IGxlbiA9IHRoaXMubGVuZ3RoO1xuICBsZXQgaSA9IGZyb21JbmRleCA+PSAwID8gZnJvbUluZGV4IDogTWF0aC5tYXgobGVuICsgZnJvbUluZGV4LCAwKTtcbiAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgIGNvbnN0IG90aGVyID0gdGhpc1tpXTtcbiAgICAvLyBJZiB2YWx1ZSBoYXMgYmVlbiBmb3VuZCBPUiAodmFsdWUgaXMgTmFOIEFORCBvdGhlciBpcyBOYU4pXG4gICAgLyplc2xpbnQgXCJuby1zZWxmLWNvbXBhcmVcIjogMCovXG4gICAgaWYgKG90aGVyID09PSB2YWx1ZSB8fCAodmFsdWUgIT09IHZhbHVlICYmIG90aGVyICE9PSBvdGhlcikpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuKiBTZXRzIHRoZSBBcnJheS5jb250YWlucyBwb2x5ZmlsbCBpZiBpdCBkb2VzIG5vdCBleGlzdC5cbiogQHBhcmFtIHshV2luZG93fSB3aW5cbiovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzKSB7XG4gICAgd2luLk9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdpbmNsdWRlcycsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogaW5jbHVkZXMsXG4gICAgfSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHByb21pc2U6ICFQcm9taXNlPHVuZGVmaW5lZD4sXG4gKiAgIHJlc29sdmU6IGZ1bmN0aW9uKCksXG4gKiB9fVxuICovXG5sZXQgRGVmZXJyZWREZWY7XG5cbi8qKlxuICogQHR5cGVkZWYgeyFGdW5jdGlvbn1cbiAqL1xubGV0IEN1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZjtcblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogIG5hbWU6IHN0cmluZyxcbiAqICBjdG9yOiAhQ3VzdG9tRWxlbWVudENvbnN0cnVjdG9yRGVmLFxuICogfX1cbiAqL1xubGV0IEN1c3RvbUVsZW1lbnREZWY7XG5cbi8qKlxuICogVmFsaWRhdGVzIHRoZSBjdXN0b20gZWxlbWVudCdzIG5hbWUuXG4gKiBUaGlzIGludGVudGlvbmFsbHkgaWdub3JlcyBcInZhbGlkXCIgaGlnaGVyIFVuaWNvZGUgQ29kZSBQb2ludHMuXG4gKiBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9jdXN0b20tZWxlbWVudHMuaHRtbCN2YWxpZC1jdXN0b20tZWxlbWVudC1uYW1lXG4gKi9cbmNvbnN0IFZBTElEX05BTUUgPSAvXlthLXpdW2EtejAtOS5fXSotW2EtejAtOS5fLV0qJC87XG5jb25zdCBJTlZBTElEX05BTUVTID0gW1xuICAnYW5ub3RhdGlvbi14bWwnLFxuICAnY29sb3ItcHJvZmlsZScsXG4gICdmb250LWZhY2UnLFxuICAnZm9udC1mYWNlLXNyYycsXG4gICdmb250LWZhY2UtdXJpJyxcbiAgJ2ZvbnQtZmFjZS1mb3JtYXQnLFxuICAnZm9udC1mYWNlLW5hbWUnLFxuICAnbWlzc2luZy1nbHlwaCcsXG5dO1xuXG4vKipcbiAqIEFzc2VydHMgdGhhdCB0aGUgY3VzdG9tIGVsZW1lbnQgbmFtZSBjb25mb3JtcyB0byB0aGUgc3BlYy5cbiAqXG4gKiBAcGFyYW0geyFGdW5jdGlvbn0gU3ludGF4RXJyb3JcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gKi9cbmZ1bmN0aW9uIGFzc2VydFZhbGlkTmFtZShTeW50YXhFcnJvciwgbmFtZSkge1xuICBpZiAoIVZBTElEX05BTUUudGVzdChuYW1lKSB8fCBJTlZBTElEX05BTUVTLmluZGV4T2YobmFtZSkgPj0gMCkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgaW52YWxpZCBjdXN0b20gZWxlbWVudCBuYW1lIFwiJHtuYW1lfVwiYCk7XG4gIH1cbn1cblxuLyoqXG4gKiBEb2VzIHdpbiBoYXZlIGEgZnVsbCBDdXN0b20gRWxlbWVudHMgcmVnaXN0cnk/XG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGhhc0N1c3RvbUVsZW1lbnRzKHdpbikge1xuICBjb25zdCB7Y3VzdG9tRWxlbWVudHN9ID0gd2luO1xuXG4gIHJldHVybiAhIShcbiAgICBjdXN0b21FbGVtZW50cyAmJlxuICAgIGN1c3RvbUVsZW1lbnRzLmRlZmluZSAmJlxuICAgIGN1c3RvbUVsZW1lbnRzLmdldCAmJlxuICAgIGN1c3RvbUVsZW1lbnRzLndoZW5EZWZpbmVkKTtcbn1cblxuLyoqXG4gKiBXYXMgSFRNTEVsZW1lbnQgYWxyZWFkeSBwYXRjaGVkIGZvciB0aGlzIHdpbmRvdz9cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNQYXRjaGVkKHdpbikge1xuICBjb25zdCB0YWcgPSB3aW4uSFRNTEVsZW1lbnQudG9TdHJpbmcoKTtcbiAgcmV0dXJuIHRhZy5pbmRleE9mKCdbbmF0aXZlIGNvZGVdJykgPT09IC0xO1xufVxuXG4vKipcbiAqIFRoZSBwdWJsaWMgQ3VzdG9tIEVsZW1lbnRzIEFQSS5cbiAqL1xuY2xhc3MgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5IHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEBwYXJhbSB7IVJlZ2lzdHJ5fSByZWdpc3RyeVxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luLCByZWdpc3RyeSkge1xuICAgIC8qKlxuICAgICAqIEBjb25zdCBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMud2luXyA9IHdpbjtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdCBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMucmVnaXN0cnlfID0gcmVnaXN0cnk7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsIERlZmVycmVkRGVmPn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBjb25zdFxuICAgICAqL1xuICAgIHRoaXMucGVuZGluZ0RlZmluZXNfID0gdGhpcy53aW5fLk9iamVjdC5jcmVhdGUobnVsbCk7XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXIgdGhlIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcGFyYW0geyFDdXN0b21FbGVtZW50Q29uc3RydWN0b3JEZWZ9IGN0b3JcbiAgICogQHBhcmFtIHshT2JqZWN0PX0gb3B0aW9uc1xuICAgKi9cbiAgZGVmaW5lKG5hbWUsIGN0b3IsIG9wdGlvbnMpIHtcbiAgICB0aGlzLnJlZ2lzdHJ5Xy5kZWZpbmUobmFtZSwgY3Rvciwgb3B0aW9ucyk7XG5cbiAgICAvLyBJZiBhbnlvbmUgaXMgd2FpdGluZyBmb3IgdGhpcyBjdXN0b20gZWxlbWVudCB0byBiZSBkZWZpbmVkLCByZXNvbHZlXG4gICAgLy8gdGhlaXIgcHJvbWlzZS5cbiAgICBjb25zdCBwZW5kaW5nID0gdGhpcy5wZW5kaW5nRGVmaW5lc187XG4gICAgY29uc3QgZGVmZXJyZWQgPSBwZW5kaW5nW25hbWVdO1xuICAgIGlmIChkZWZlcnJlZCkge1xuICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgZGVsZXRlIHBlbmRpbmdbbmFtZV07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY29uc3RydWN0b3Igb2YgdGhlIChhbHJlYWR5IGRlZmluZWQpIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcmV0dXJuIHshQ3VzdG9tRWxlbWVudENvbnN0cnVjdG9yRGVmfHVuZGVmaW5lZH1cbiAgICovXG4gIGdldChuYW1lKSB7XG4gICAgY29uc3QgZGVmID0gdGhpcy5yZWdpc3RyeV8uZ2V0QnlOYW1lKG5hbWUpO1xuICAgIGlmIChkZWYpIHtcbiAgICAgIHJldHVybiBkZWYuY3RvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgdGhhdCB3YWl0cyB1bnRpbCB0aGUgY3VzdG9tIGVsZW1lbnQgaXMgZGVmaW5lZC5cbiAgICogSWYgdGhlIGN1c3RvbSBlbGVtZW50IGlzIGFscmVhZHkgZGVmaW5lZCwgcmV0dXJucyBhIHJlc29sdmVkIHByb21pc2UuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAqIEByZXR1cm4geyFQcm9taXNlPHVuZGVmaW5lZD59XG4gICAqL1xuICB3aGVuRGVmaW5lZChuYW1lKSB7XG4gICAgY29uc3Qge1Byb21pc2UsIFN5bnRheEVycm9yfSA9IHRoaXMud2luXztcbiAgICBhc3NlcnRWYWxpZE5hbWUoU3ludGF4RXJyb3IsIG5hbWUpO1xuXG4gICAgaWYgKHRoaXMucmVnaXN0cnlfLmdldEJ5TmFtZShuYW1lKSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cblxuICAgIGNvbnN0IHBlbmRpbmcgPSB0aGlzLnBlbmRpbmdEZWZpbmVzXztcbiAgICBjb25zdCBkZWZlcnJlZCA9IHBlbmRpbmdbbmFtZV07XG4gICAgaWYgKGRlZmVycmVkKSB7XG4gICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBsZXQgcmVzb2x2ZTtcbiAgICBjb25zdCBwcm9taXNlID0gbmV3IC8qT0sqL1Byb21pc2UocmVzID0+IHJlc29sdmUgPSByZXMpO1xuICAgIHBlbmRpbmdbbmFtZV0gPSB7XG4gICAgICBwcm9taXNlLFxuICAgICAgcmVzb2x2ZSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHByb21pc2U7XG4gIH1cblxuICAvKipcbiAgICogVXBncmFkZSBhbGwgY3VzdG9tIGVsZW1lbnRzIGluc2lkZSByb290LlxuICAgKlxuICAgKiBAcGFyYW0geyFOb2RlfSByb290XG4gICAqL1xuICB1cGdyYWRlKHJvb3QpIHtcbiAgICB0aGlzLnJlZ2lzdHJ5Xy51cGdyYWRlKHJvb3QpO1xuICB9XG59XG5cbi8qKlxuICogVGhpcyBpbnRlcm5hbCBBUElzIG5lY2Vzc2FyeSB0byBydW4gdGhlIEN1c3RvbUVsZW1lbnRSZWdpc3RyeS5cbiAqIFNpbmNlIFJlZ2lzdHJ5IGlzIG5ldmVyIGV4cG9zZWQgZXh0ZXJuYWxseSwgYWxsIG1ldGhvZHMgYXJlIGFjdHVhbGx5XG4gKiBhdmFpbGFibGUgb24gdGhlIGluc3RhbmNlLlxuICovXG5jbGFzcyBSZWdpc3RyeSB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luKSB7XG4gICAgLyoqXG4gICAgICogQHByaXZhdGUgQGNvbnN0XG4gICAgICovXG4gICAgdGhpcy53aW5fID0gd2luO1xuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGUgQGNvbnN0XG4gICAgICovXG4gICAgdGhpcy5kb2NfID0gd2luLmRvY3VtZW50O1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCAhQ3VzdG9tRWxlbWVudERlZj59XG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAY29uc3RcbiAgICAgKi9cbiAgICB0aGlzLmRlZmluaXRpb25zXyA9IHdpbi5PYmplY3QuY3JlYXRlKG51bGwpO1xuXG4gICAgLyoqXG4gICAgICogQSB1cC10by1kYXRlIERPTSBzZWxlY3RvciBmb3IgYWxsIGN1c3RvbSBlbGVtZW50cy5cbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIHRoaXMucXVlcnlfID0gJyc7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgY3VycmVudGx5IHVwZ3JhZGluZyBlbGVtZW50LlxuICAgICAqIEBwcml2YXRlIHtFbGVtZW50fVxuICAgICAqL1xuICAgIHRoaXMuY3VycmVudF8gPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50bHktYmVpbmctdXBncmFkZWQgY3VzdG9tIGVsZW1lbnQuXG4gICAqXG4gICAqIFdoZW4gYW4gYWxyZWFkeSBjcmVhdGVkICh0aHJvdWdoIHRoZSBET00gcGFyc2luZyBBUElzLCBvciBpbm5lckhUTUwpXG4gICAqIGN1c3RvbSBlbGVtZW50IG5vZGUgaXMgYmVpbmcgdXBncmFkZWQsIHdlIGNhbid0IGp1c3QgY3JlYXRlIGEgbmV3IG5vZGVcbiAgICogKGl0J3MgaWxsZWdhbCBpbiB0aGUgc3BlYykuIEJ1dCB3ZSBzdGlsbCBuZWVkIHRvIHJ1biB0aGUgY3VzdG9tIGVsZW1lbnQnc1xuICAgKiBjb25zdHJ1Y3RvciBjb2RlIG9uIHRoZSBub2RlLiBXZSBhdm9pZCB0aGlzIGNvbnVuZHJ1bSBieSBydW5uaW5nIHRoZVxuICAgKiBjb25zdHJ1Y3RvciB3aGlsZSByZXR1cm5pbmcgdGhpcyBjdXJyZW50IG5vZGUgaW4gdGhlIEhUTUxFbGVtZW50XG4gICAqIGNsYXNzIGNvbnN0cnVjdG9yICh0aGUgYmFzZSBjbGFzcyBvZiBhbGwgY3VzdG9tIGVsZW1lbnRzKS5cbiAgICpcbiAgICogQHJldHVybiB7RWxlbWVudH1cbiAgICovXG4gIGN1cnJlbnQoKSB7XG4gICAgY29uc3QgY3VycmVudCA9IHRoaXMuY3VycmVudF87XG4gICAgdGhpcy5jdXJyZW50XyA9IG51bGw7XG4gICAgcmV0dXJuIGN1cnJlbnQ7XG4gIH1cblxuICAvKipcbiAgICogRmluZHMgdGhlIGN1c3RvbSBlbGVtZW50IGRlZmluaXRpb24gYnkgbmFtZS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICogQHJldHVybiB7Q3VzdG9tRWxlbWVudERlZnx1bmRlZmluZWR9XG4gICAqL1xuICBnZXRCeU5hbWUobmFtZSkge1xuICAgIGNvbnN0IGRlZmluaXRpb24gPSB0aGlzLmRlZmluaXRpb25zX1tuYW1lXTtcbiAgICBpZiAoZGVmaW5pdGlvbikge1xuICAgICAgcmV0dXJuIGRlZmluaXRpb247XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZpbmRzIHRoZSBjdXN0b20gZWxlbWVudCBkZWZpbml0aW9uIGJ5IGNvbnN0cnVjdG9yIGluc3RhbmNlLlxuICAgKlxuICAgKiBAcGFyYW0ge0N1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZn0gY3RvclxuICAgKiBAcmV0dXJuIHtDdXN0b21FbGVtZW50RGVmfHVuZGVmaW5lZH1cbiAgICovXG4gIGdldEJ5Q29uc3RydWN0b3IoY3Rvcikge1xuICAgIGNvbnN0IGRlZmluaXRpb25zID0gdGhpcy5kZWZpbml0aW9uc187XG5cbiAgICBmb3IgKGNvbnN0IG5hbWUgaW4gZGVmaW5pdGlvbnMpIHtcbiAgICAgIGNvbnN0IGRlZiA9IGRlZmluaXRpb25zW25hbWVdO1xuICAgICAgaWYgKGRlZi5jdG9yID09PSBjdG9yKSB7XG4gICAgICAgIHJldHVybiBkZWY7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVycyB0aGUgY3VzdG9tIGVsZW1lbnQgZGVmaW5pdGlvbiwgYW5kIHVwZ3JhZGVzIGFsbCBlbGVtZW50cyBieSB0aGF0XG4gICAqIG5hbWUgaW4gdGhlIHJvb3QgZG9jdW1lbnQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAqIEBwYXJhbSB7IUN1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZn0gY3RvclxuICAgKiBAcGFyYW0geyFPYmplY3R8dW5kZWZpbmVkfSBvcHRpb25zXG4gICAqL1xuICBkZWZpbmUobmFtZSwgY3Rvciwgb3B0aW9ucykge1xuICAgIGNvbnN0IHtFcnJvciwgU3ludGF4RXJyb3J9ID0gdGhpcy53aW5fO1xuXG4gICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRXh0ZW5kaW5nIG5hdGl2ZSBjdXN0b20gZWxlbWVudHMgaXMgbm90IHN1cHBvcnRlZCcpO1xuICAgIH1cblxuICAgIGFzc2VydFZhbGlkTmFtZShTeW50YXhFcnJvciwgbmFtZSk7XG5cbiAgICBpZiAodGhpcy5nZXRCeU5hbWUobmFtZSkgfHxcbiAgICAgICAgdGhpcy5nZXRCeUNvbnN0cnVjdG9yKGN0b3IpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYGR1cGxpY2F0ZSBkZWZpbml0aW9uIFwiJHtuYW1lfVwiYCk7XG4gICAgfVxuXG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogUmVjb3JkIGNvbm5lY3RlZENhbGxiYWNrLCBkaXNjb25uZWN0ZWRDYWxsYmFjayxcbiAgICAvLyBhZG9wdGVkQ2FsbGJhY2ssIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjaywgYW5kIG9ic2VydmVkQXR0cmlidXRlcy5cbiAgICAvLyBUT0RPKGpyaWRnZXdlbGwpOiBJZiBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2ssIGdhdGhlciBvYnNlcnZlZEF0dHJpYnV0ZXNcbiAgICB0aGlzLmRlZmluaXRpb25zX1tuYW1lXSA9IHtcbiAgICAgIG5hbWUsXG4gICAgICBjdG9yLFxuICAgIH07XG5cbiAgICB0aGlzLm9ic2VydmVfKG5hbWUpO1xuICAgIHRoaXMudXBncmFkZSh0aGlzLmRvY18sIG5hbWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZ3JhZGVzIGN1c3RvbSBlbGVtZW50cyBkZXNjZW5kYW50cyBvZiByb290IChidXQgbm90IGluY2x1ZGluZyByb290KS5cbiAgICpcbiAgICogV2hlbiBjYWxsZWQgd2l0aCBhbiBvcHRfcXVlcnksIGl0IGJvdGggdXBncmFkZXMgYW5kIGNvbm5lY3RzIHRoZSBjdXN0b21cbiAgICogZWxlbWVudHMgKHRoaXMgaXMgdXNlZCBkdXJpbmcgdGhlIGN1c3RvbSBlbGVtZW50IGRlZmluZSBhbGdvcml0aG0pLlxuICAgKlxuICAgKiBAcGFyYW0geyFOb2RlfSByb290XG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X3F1ZXJ5XG4gICAqL1xuICB1cGdyYWRlKHJvb3QsIG9wdF9xdWVyeSkge1xuICAgIC8vIE9ubHkgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5LnAuZGVmaW5lIHByb3ZpZGVzIGEgcXVlcnkgKHRoZSBuZXdseSBkZWZpbmVkXG4gICAgLy8gY3VzdG9tIGVsZW1lbnQpLiBJbiB0aGlzIGNhc2UsIHdlIGFyZSBib3RoIHVwZ3JhZGluZyBfYW5kXyBjb25uZWN0aW5nXG4gICAgLy8gdGhlIGN1c3RvbSBlbGVtZW50cy5cbiAgICBjb25zdCBuZXdseURlZmluZWQgPSAhIW9wdF9xdWVyeTtcbiAgICBjb25zdCBxdWVyeSA9IG9wdF9xdWVyeSB8fCB0aGlzLnF1ZXJ5XztcbiAgICBjb25zdCB1cGdyYWRlQ2FuZGlkYXRlcyA9IHRoaXMucXVlcnlBbGxfKHJvb3QsIHF1ZXJ5KTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXBncmFkZUNhbmRpZGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGNhbmRpZGF0ZSA9IHVwZ3JhZGVDYW5kaWRhdGVzW2ldO1xuICAgICAgaWYgKG5ld2x5RGVmaW5lZCkge1xuICAgICAgICB0aGlzLmNvbm5lY3RlZENhbGxiYWNrXyhjYW5kaWRhdGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy51cGdyYWRlU2VsZihjYW5kaWRhdGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGdyYWRlcyB0aGUgY3VzdG9tIGVsZW1lbnQgbm9kZSwgaWYgYSBjdXN0b20gZWxlbWVudCBoYXMgYmVlbiByZWdpc3RlcmVkXG4gICAqIGJ5IHRoaXMgbmFtZS5cbiAgICpcbiAgICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICAgKi9cbiAgdXBncmFkZVNlbGYobm9kZSkge1xuICAgIGNvbnN0IGRlZiA9IHRoaXMuZ2V0QnlOYW1lKG5vZGUubG9jYWxOYW1lKTtcbiAgICBpZiAoIWRlZikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudXBncmFkZVNlbGZfKC8qKiBAdHlwZSB7IUVsZW1lbnR9ICovKG5vZGUpLCBkZWYpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IU5vZGV9IHJvb3RcbiAgICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5XG4gICAqIEByZXR1cm4geyFBcnJheXwhTm9kZUxpc3R9XG4gICAqL1xuICBxdWVyeUFsbF8ocm9vdCwgcXVlcnkpIHtcbiAgICBpZiAoIXF1ZXJ5IHx8ICFyb290LnF1ZXJ5U2VsZWN0b3JBbGwpIHtcbiAgICAgIC8vIE5vdGhpbmcgdG8gZG8uLi5cbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICByZXR1cm4gcm9vdC5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGdyYWRlcyB0aGUgKGFscmVhZHkgY3JlYXRlZCB2aWEgRE9NIHBhcnNpbmcpIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBub2RlXG4gICAqIEBwYXJhbSB7IUN1c3RvbUVsZW1lbnREZWZ9IGRlZlxuICAgKi9cbiAgdXBncmFkZVNlbGZfKG5vZGUsIGRlZikge1xuICAgIGNvbnN0IHtjdG9yfSA9IGRlZjtcbiAgICBpZiAobm9kZSBpbnN0YW5jZW9mIGN0b3IpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBEZXNwaXRlIGhvdyBpdCBsb29rcywgdGhpcyBpcyBub3QgYSB1c2VsZXNzIGNvbnN0cnVjdGlvbi5cbiAgICAvLyBIVE1MRWxlbWVudFBvbHlmaWxsICh0aGUgYmFzZSBjbGFzcyBvZiBhbGwgY3VzdG9tIGVsZW1lbnRzKSB3aWxsIHJldHVyblxuICAgIC8vIHRoZSBjdXJyZW50IG5vZGUsIGFsbG93aW5nIHRoZSBjdXN0b20gZWxlbWVudCdzIHN1YmNsYXNzIGNvbnN0cnVjdG9yIHRvXG4gICAgLy8gcnVuIG9uIHRoZSBub2RlLiBUaGUgbm9kZSBpdHNlbGYgaXMgYWxyZWFkeSBjb25zdHJ1Y3RlZCwgc28gdGhlIHJldHVyblxuICAgIC8vIHZhbHVlIGlzIGp1c3QgdGhlIG5vZGUuXG4gICAgdGhpcy5jdXJyZW50XyA9IG5vZGU7XG4gICAgY29uc3QgZWwgPSBuZXcgY3RvcigpO1xuXG4gICAgaWYgKGVsICE9PSBub2RlKSB7XG4gICAgICB0aHJvdyBuZXcgdGhpcy53aW5fLkVycm9yKFxuICAgICAgICAgICdDb25zdHJ1Y3RvciBpbGxlZ2FsbHkgcmV0dXJuZWQgYSBkaWZmZXJlbnQgaW5zdGFuY2UuJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZpcmVzIGNvbm5lY3RlZENhbGxiYWNrIG9uIHRoZSBjdXN0b20gZWxlbWVudCwgaWYgaXQgaGFzIG9uZS5cbiAgICogVGhpcyBhbHNvIHVwZ3JhZGVzIHRoZSBjdXN0b20gZWxlbWVudCwgc2luY2UgaXQgbWF5IG5vdCBoYXZlIGJlZW5cbiAgICogYWNjZXNzaWJsZSB2aWEgdGhlIHJvb3QgZG9jdW1lbnQgYmVmb3JlIChhIGRldGFjaGVkIERPTSB0cmVlKS5cbiAgICpcbiAgICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICAgKi9cbiAgY29ubmVjdGVkQ2FsbGJhY2tfKG5vZGUpIHtcbiAgICBjb25zdCBkZWYgPSB0aGlzLmdldEJ5TmFtZShub2RlLmxvY2FsTmFtZSk7XG4gICAgaWYgKCFkZWYpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy51cGdyYWRlU2VsZl8oLyoqIEB0eXBlIHshRWxlbWVudH0gKi8obm9kZSksIGRlZik7XG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogSXQgbWF5IGJlIGFwcHJvcHJpYXRlIHRvIGFkb3B0Q2FsbGJhY2ssIGlmIHRoZSBub2RlXG4gICAgLy8gdXNlZCB0byBiZSBpbiBhbm90aGVyIGRvYy5cbiAgICAvLyBUT0RPKGpyaWRnZXdlbGwpOiBJIHNob3VsZCBiZSBjYWxsaW5nIHRoZSBkZWZpbml0aW9ucyBjb25uZWN0ZWRDYWxsYmFja1xuICAgIC8vIHdpdGggbm9kZSBhcyB0aGUgY29udGV4dC5cbiAgICBpZiAobm9kZS5jb25uZWN0ZWRDYWxsYmFjaykge1xuICAgICAgbm9kZS5jb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGaXJlcyBkaXNjb25uZWN0ZWRDYWxsYmFjayBvbiB0aGUgY3VzdG9tIGVsZW1lbnQsIGlmIGl0IGhhcyBvbmUuXG4gICAqXG4gICAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAgICovXG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrXyhub2RlKSB7XG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogSSBzaG91bGQgYmUgY2FsbGluZyB0aGUgZGVmaW5pdGlvbnMgY29ubmVjdGVkQ2FsbGJhY2tcbiAgICAvLyB3aXRoIG5vZGUgYXMgdGhlIGNvbnRleHQuXG4gICAgaWYgKG5vZGUuZGlzY29ubmVjdGVkQ2FsbGJhY2spIHtcbiAgICAgIG5vZGUuZGlzY29ubmVjdGVkQ2FsbGJhY2soKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkcyBuYW1lIGFzIGEgcmVnaXN0ZXJlZCBjdXN0b20gZWxlbWVudCB0byBvYnNlcnZlLlxuICAgKlxuICAgKiBTdGFydHMgdGhlIE11dGF0aW9uIE9ic2VydmVyIGlmIHRoaXMgaXMgdGhlIGZpcnN0IHJlZ2lzdGVyZWQgY3VzdG9tXG4gICAqIGVsZW1lbnQuIFRoaXMgaXMgZGVmZXJyZWQgdW50aWwgdGhlIGZpcnN0IGN1c3RvbSBlbGVtZW50IGlzIGRlZmluZWQgdG9cbiAgICogc3BlZWQgdXAgaW5pdGlhbCByZW5kZXJpbmcgb2YgdGhlIHBhZ2UuXG4gICAqXG4gICAqIE11dGF0aW9uIE9ic2VydmVycyBhcmUgY29udmVuaWVudGx5IGF2YWlsYWJsZSBpbiBldmVyeSBicm93c2VyIHdlIGNhcmVcbiAgICogYWJvdXQuIFdoZW4gYSBub2RlIGlzIGNvbm5lY3RlZCB0byB0aGUgcm9vdCBkb2N1bWVudCwgYWxsIGN1c3RvbVxuICAgKiBlbGVtZW50cyAoaW5jbHVkaW5nIHRoYXQgbm9kZSBpdGVzZWxmKSB3aWxsIGJlIHVwZ3JhZGVkIGFuZCBjYWxsXG4gICAqIGNvbm5lY3RlZENhbGxiYWNrLiBXaGVuIGEgbm9kZSBpcyBkaXNjb25uZWN0ZWRDYWxsYmFjayBmcm9tIHRoZSByb290XG4gICAqIGRvY3VtZW50LCBhbGwgY3VzdG9tIGVsZW1lbnRzIHdpbGwgY2FsbCBkaXNjb25uZWN0ZWRDYWxsYmFjay5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICovXG4gIG9ic2VydmVfKG5hbWUpIHtcbiAgICBpZiAodGhpcy5xdWVyeV8pIHtcbiAgICAgIHRoaXMucXVlcnlfICs9IGAsJHtuYW1lfWA7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5xdWVyeV8gPSBuYW1lO1xuXG4gICAgLy8gVGhlIGZpcnN0IHJlZ2lzdGVyZWQgbmFtZSBzdGFydHMgdGhlIG11dGF0aW9uIG9ic2VydmVyLlxuICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IHRoaXMud2luXy5NdXRhdGlvbk9ic2VydmVyKHJlY29yZHMgPT4ge1xuICAgICAgaWYgKHJlY29yZHMpIHtcbiAgICAgICAgdGhpcy5oYW5kbGVSZWNvcmRzXyhyZWNvcmRzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBvYnNlcnZlci5vYnNlcnZlKHRoaXMuZG9jXywge1xuICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgc3VidHJlZTogdHJ1ZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgYWxsIHRoZSBNdXRhdGlvbiBPYnNlcnZlcidzIE11dGF0aW9uIFJlY29yZHMuXG4gICAqIEFsbCBhZGRlZCBjdXN0b20gZWxlbWVudHMgd2lsbCBiZSB1cGdyYWRlZCAoaWYgbm90IGFscmVhZHkpIGFuZCBjYWxsXG4gICAqIGNvbm5lY3RlZENhbGxiYWNrLiBBbGwgcmVtb3ZlZCBjdXN0b20gZWxlbWVudHMgd2lsbCBjYWxsXG4gICAqIGRpc2Nvbm5lY3RlZENhbGxiYWNrLlxuICAgKlxuICAgKiBAcGFyYW0geyFBcnJheTwhTXV0YXRpb25SZWNvcmQ+fSByZWNvcmRzXG4gICAqL1xuICBoYW5kbGVSZWNvcmRzXyhyZWNvcmRzKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZWNvcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCByZWNvcmQgPSByZWNvcmRzW2ldO1xuICAgICAgaWYgKCFyZWNvcmQpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHthZGRlZE5vZGVzLCByZW1vdmVkTm9kZXN9ID0gcmVjb3JkO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhZGRlZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBhZGRlZE5vZGVzW2ldO1xuICAgICAgICBjb25zdCBjb25uZWN0ZWRDYW5kaWRhdGVzID0gdGhpcy5xdWVyeUFsbF8obm9kZSwgdGhpcy5xdWVyeV8pO1xuICAgICAgICB0aGlzLmNvbm5lY3RlZENhbGxiYWNrXyhub2RlKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb25uZWN0ZWRDYW5kaWRhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdGhpcy5jb25uZWN0ZWRDYWxsYmFja18oY29ubmVjdGVkQ2FuZGlkYXRlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZW1vdmVkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IHJlbW92ZWROb2Rlc1tpXTtcbiAgICAgICAgY29uc3QgZGlzY29ubmVjdGVkQ2FuZGlkYXRlcyA9IHRoaXMucXVlcnlBbGxfKG5vZGUsIHRoaXMucXVlcnlfKTtcbiAgICAgICAgdGhpcy5kaXNjb25uZWN0ZWRDYWxsYmFja18obm9kZSk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGlzY29ubmVjdGVkQ2FuZGlkYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuZGlzY29ubmVjdGVkQ2FsbGJhY2tfKGRpc2Nvbm5lY3RlZENhbmRpZGF0ZXNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogRG9lcyB0aGUgcG9seWZpbGxpbmcuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5mdW5jdGlvbiBwb2x5ZmlsbCh3aW4pIHtcbiAgY29uc3Qge0hUTUxFbGVtZW50LCBFbGVtZW50LCBOb2RlLCBEb2N1bWVudCwgT2JqZWN0LCBkb2N1bWVudH0gPSB3aW47XG4gIGNvbnN0IHtjcmVhdGVFbGVtZW50LCBjbG9uZU5vZGUsIGltcG9ydE5vZGV9ID0gZG9jdW1lbnQ7XG5cbiAgY29uc3QgcmVnaXN0cnkgPSBuZXcgUmVnaXN0cnkod2luKTtcbiAgY29uc3QgY3VzdG9tRWxlbWVudHMgPSBuZXcgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5KHdpbiwgcmVnaXN0cnkpO1xuXG4gIC8vIEV4cG9zZSB0aGUgY3VzdG9tIGVsZW1lbnQgcmVnaXN0cnkuXG4gIC8vIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LCAnY3VzdG9tRWxlbWVudHMnKVxuICAvLyB7Z2V0OiDGkiwgc2V0OiB1bmRlZmluZWQsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZX1cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbiwgJ2N1c3RvbUVsZW1lbnRzJywge1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIC8vIHdyaXRhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogY3VzdG9tRWxlbWVudHMsXG4gIH0pO1xuXG4gIC8vIFBhdGNoIGNyZWF0ZUVsZW1lbnQgdG8gaW1tZWRpYXRlbHkgdXBncmFkZSB0aGUgY3VzdG9tIGVsZW1lbnQuXG4gIC8vIFRoaXMgaGFzIHRoZSBhZGRlZCBiZW5lZml0IHRoYXQgaXQgYXZvaWRzIHRoZSBcImFscmVhZHkgY3JlYXRlZCBidXQgbmVlZHNcbiAgLy8gY29uc3RydWN0b3IgY29kZSBydW5cIiBjaGlja2VuLWFuZC1lZ2cgcHJvYmxlbS5cbiAgRG9jdW1lbnQucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbiBjcmVhdGVFbGVtZW50UG9seWZpbGwobmFtZSkge1xuICAgIGNvbnN0IGRlZiA9IHJlZ2lzdHJ5LmdldEJ5TmFtZShuYW1lKTtcbiAgICBpZiAoZGVmKSB7XG4gICAgICByZXR1cm4gbmV3IGRlZi5jdG9yKCk7XG4gICAgfVxuICAgIHJldHVybiBjcmVhdGVFbGVtZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgLy8gUGF0Y2ggaW1wb3J0Tm9kZSB0byBpbW1lZGlhdGVseSB1cGdyYWRlIGN1c3RvbSBlbGVtZW50cy5cbiAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogQ2FuIGZpcmUgYWRvcHRlZENhbGxiYWNrIGZvciBjcm9zcyBkb2MgaW1wb3J0cy5cbiAgRG9jdW1lbnQucHJvdG90eXBlLmltcG9ydE5vZGUgPSBmdW5jdGlvbiBpbXBvcnROb2RlUG9seWZpbGwoKSB7XG4gICAgY29uc3QgaW1wb3J0ZWQgPSBpbXBvcnROb2RlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKGltcG9ydGVkKSB7XG4gICAgICByZWdpc3RyeS51cGdyYWRlU2VsZihpbXBvcnRlZCk7XG4gICAgICByZWdpc3RyeS51cGdyYWRlKGltcG9ydGVkKTtcbiAgICB9XG4gICAgcmV0dXJuIGltcG9ydGVkO1xuICB9O1xuXG4gIC8vIFBhdGNoIGNsb25lTm9kZSB0byBpbW1lZGlhdGVseSB1cGdyYWRlIGN1c3RvbSBlbGVtZW50cy5cbiAgTm9kZS5wcm90b3R5cGUuY2xvbmVOb2RlID0gZnVuY3Rpb24gY2xvbmVOb2RlUG9seWZpbGwoKSB7XG4gICAgY29uc3QgY2xvbmVkID0gY2xvbmVOb2RlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgcmVnaXN0cnkudXBncmFkZVNlbGYoY2xvbmVkKTtcbiAgICByZWdpc3RyeS51cGdyYWRlKGNsb25lZCk7XG4gICAgcmV0dXJuIGNsb25lZDtcbiAgfTtcblxuICAvLyBQYXRjaCB0aGUgaW5uZXJIVE1MIHNldHRlciB0byBpbW1lZGlhdGVseSB1cGdyYWRlIGN1c3RvbSBlbGVtZW50cy5cbiAgLy8gTm90ZSwgdGhpcyBjb3VsZCB0ZWNobmljYWxseSBmaXJlIGNvbm5lY3RlZENhbGxiYWNrcyBpZiB0aGlzIG5vZGUgd2FzXG4gIC8vIGNvbm5lY3RlZCwgYnV0IHdlIGxlYXZlIHRoYXQgdG8gdGhlIE11dGF0aW9uIE9ic2VydmVyLlxuICBjb25zdCBpbm5lckhUTUxEZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihFbGVtZW50LnByb3RvdHlwZSxcbiAgICAgICdpbm5lckhUTUwnKTtcbiAgY29uc3QgaW5uZXJIVE1MU2V0dGVyID0gaW5uZXJIVE1MRGVzYy5zZXQ7XG4gIGlubmVySFRNTERlc2Muc2V0ID0gZnVuY3Rpb24oaHRtbCkge1xuICAgIGlubmVySFRNTFNldHRlci5jYWxsKHRoaXMsIGh0bWwpO1xuICAgIHJlZ2lzdHJ5LnVwZ3JhZGUodGhpcyk7XG4gIH07XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFbGVtZW50LnByb3RvdHlwZSwgJ2lubmVySFRNTCcsIGlubmVySFRNTERlc2MpO1xuXG4gIC8qKlxuICAgKiBZb3UgY2FuJ3QgdXNlIHRoZSByZWFsIEhUTUxFbGVtZW50IGNvbnN0cnVjdG9yLCBiZWNhdXNlIHlvdSBjYW4ndCBzdWJjbGFzc1xuICAgKiBpdCB3aXRob3V0IHVzaW5nIG5hdGl2ZSBjbGFzc2VzLiBTbywgbW9jayBpdHMgYXBwcm94aW1hdGlvbiB1c2luZ1xuICAgKiBjcmVhdGVFbGVtZW50LlxuICAgKi9cbiAgZnVuY3Rpb24gSFRNTEVsZW1lbnRQb2x5ZmlsbCgpIHtcbiAgICBjb25zdCB7Y29uc3RydWN0b3J9ID0gdGhpcztcblxuICAgIC8vIElmIHdlJ3JlIHVwZ3JhZGluZyBhbiBhbHJlYWR5IGNyZWF0ZWQgY3VzdG9tIGVsZW1lbnQsIHdlIGNhbid0IGNyZWF0ZVxuICAgIC8vIGFub3RoZXIgbmV3IG5vZGUgKGJ5IHRoZSBzcGVjLCBpdCBtdXN0IGJlIHRoZSBzYW1lIG5vZGUpLlxuICAgIGxldCBlbCA9IHJlZ2lzdHJ5LmN1cnJlbnQoKTtcblxuICAgIC8vIElmIHRoZXJlJ3Mgbm90IGEgYWxyZWFkeSBjcmVhdGVkIGN1c3RvbSBlbGVtZW50LCB3ZSdyZSBiZWluZyBpbnZva2VkIHZpYVxuICAgIC8vIGBuZXdgaW5nIHRoZSBjb25zdHJ1Y3Rvci5cbiAgICAvL1xuICAgIC8vIFRlY2huaWNhbGx5LCB3ZSBjb3VsZCBnZXQgaGVyZSB2aWEgY3JlYXRlRWxlbWVudCwgYnV0IHdlIHBhdGNoZWQgdGhhdC5cbiAgICAvLyBJZiBpdCB0aGUgY3VzdG9tIGVsZW1lbnQgd2FzIHJlZ2lzdGVyZWQsIHRoZSBwYXRjaCB0dXJuZWQgaXQgaW50byBhXG4gICAgLy8gYG5ld2AgY2FsbC5cbiAgICAvLyBJZiBpdCB3YXMgbm90IHJlZ2lzdGVyZWQsIHRoZSBuYXRpdmUgY3JlYXRlRWxlbWVudCBpcyB1c2VkLiBBbmQgaWZcbiAgICAvLyBuYXRpdmUgY3JlYXRlRWxlbWVudCBpcyBiZWluZyB1c2VkIGFuZCB3ZSBnb3QgdG8gdGhpcyBjb2RlLCB3ZSdyZSByZWFsbHlcbiAgICAvLyBpbiBhbiBpbmZpbml0ZSBsb29wIChhIG5hdGl2ZSBjcmVhdGVFbGVtZW50IGNhbGwganVzdCBiZWxvdykgc28gd2UndmVcbiAgICAvLyBnb3QgYmlnZ2VyIHByb2JsZW1zLlxuICAgIC8vXG4gICAgLy8gU28ganVzdCB0YWtlIG15IHdvcmQgd2UgZ290IGhlcmUgdmlhIGBuZXdgLlxuICAgIGlmICghZWwpIHtcbiAgICAgIC8vIFRoZSBjdXN0b20gZWxlbWVudCBkZWZpbml0aW9uIGlzIGFuIGludmFyaWFudC4gSWYgdGhlIGN1c3RvbSBlbGVtZW50XG4gICAgICAvLyBpcyByZWdpc3RlcmVkLCBldmVyeXRoaW5nIHdvcmtzLiBJZiBpdCdzIG5vdCwgaXQgdGhyb3dzIGluIHRoZSBtZW1iZXJcbiAgICAgIC8vIHByb3BlcnR5IGFjY2VzcyAob25seSBkZWZpbmVkIGN1c3RvbSBlbGVtZW50cyBjYW4gYmUgZGlyZWN0bHlcbiAgICAgIC8vIGNvbnN0cnVjdGVkIHZpYSBgbmV3YCkuXG4gICAgICBjb25zdCBkZWYgPSByZWdpc3RyeS5nZXRCeUNvbnN0cnVjdG9yKGNvbnN0cnVjdG9yKTtcbiAgICAgIGVsID0gY3JlYXRlRWxlbWVudC5jYWxsKGRvY3VtZW50LCBkZWYubmFtZSk7XG4gICAgfVxuXG4gICAgLy8gRmluYWxseSwgaWYgdGhlIG5vZGUgd2FzIGFscmVhZHkgY29uc3RydWN0ZWQsIHdlIG5lZWQgdG8gcmVzZXQgaXQnc1xuICAgIC8vIHByb3RvdHlwZSB0byB0aGUgY3VzdG9tIGVsZW1lbnQgcHJvdG90eXBlLiBBbmQgaWYgaXQgd2Fzbid0IGFscmVhZHlcbiAgICAvLyBjb25zdHJ1Y3RlZCwgd2UgY3JlYXRlZCBhIG5ldyBub2RlIHZpYSBuYXRpdmUgY3JlYXRlRWxlbWVudCwgYW5kIHdlIG5lZWRcbiAgICAvLyB0byByZXNldCBpdCdzIHByb3RvdHlwZS4gQmFzaWNhbGx5IGFsd2F5cyByZXNldCB0aGUgcHJvdG90eXBlLlxuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihlbCwgY29uc3RydWN0b3IucHJvdG90eXBlKTtcbiAgICByZXR1cm4gZWw7XG4gIH1cbiAgc3ViQ2xhc3MoT2JqZWN0LCBIVE1MRWxlbWVudCwgSFRNTEVsZW1lbnRQb2x5ZmlsbCk7XG5cbiAgLy8gRXhwb3NlIHRoZSBwb2x5ZmlsbGVkIEhUTUxFbGVtZW50IGNvbnN0cnVjdG9yIGZvciBldmVyeW9uZSB0byBleHRlbmQgZnJvbS5cbiAgd2luLkhUTUxFbGVtZW50ID0gSFRNTEVsZW1lbnRQb2x5ZmlsbDtcbn1cblxuLyoqXG4gKiBXcmFwcyBIVE1MRWxlbWVudCBpbiBhIFJlZmxlY3QuY29uc3RydWN0IGNvbnN0cnVjdG9yLCBzbyB0aGF0IHRyYW5zcGlsZWRcbiAqIGNsYXNzZXMgY2FuIGBfdGhpcyA9IHN1cGVyQ2xhc3MuY2FsbCh0aGlzKWAgZHVyaW5nIHRoZWlyIGNvbnN0cnVjdGlvbi5cbiAqXG4gKiBUaGlzIGlzIG9ubHkgdXNlZCB3aGVuIEN1c3RvbSBFbGVtZW50cyB2MSBpcyBhbHJlYWR5IGF2YWlsYWJsZSBfYW5kXyB3ZSdyZVxuICogdXNpbmcgdHJhbnNwaWxlZCBjbGFzc2VzICh3aGljaCB1c2UgRVM1IGNvbnN0cnVjdGlvbiBpZGlvbXMpLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKi9cbmZ1bmN0aW9uIHdyYXBIVE1MRWxlbWVudCh3aW4pIHtcbiAgY29uc3Qge0hUTUxFbGVtZW50LCBSZWZsZWN0LCBPYmplY3R9ID0gd2luO1xuICAvKipcbiAgICovXG4gIGZ1bmN0aW9uIEhUTUxFbGVtZW50V3JhcHBlcigpIHtcbiAgICBjb25zdCBjdG9yID0gLyoqIEB0eXBlIHtmdW5jdGlvbiguLi4/KTo/fHVuZGVmaW5lZH0gKi8oXG4gICAgICAvKiogQHR5cGUgeyFIVE1MRWxlbWVudH0gKi8odGhpcykuY29uc3RydWN0b3IpO1xuXG4gICAgLy8gUmVmbGVjdC5jb25zdHJ1Y3QgYWxsb3dzIHVzIHRvIGNvbnN0cnVjdCBhIG5ldyBIVE1MRWxlbWVudCB3aXRob3V0IHVzaW5nXG4gICAgLy8gYG5ld2AgKHdoaWNoIHdpbGwgYWx3YXlzIGZhaWwgYmVjYXVzZSBuYXRpdmUgSFRNTEVsZW1lbnQgaXMgYSByZXN0cmljdGVkXG4gICAgLy8gY29uc3RydWN0b3IpLlxuICAgIHJldHVybiBSZWZsZWN0LmNvbnN0cnVjdChIVE1MRWxlbWVudCwgW10sIGN0b3IpO1xuICB9XG4gIHN1YkNsYXNzKE9iamVjdCwgSFRNTEVsZW1lbnQsIEhUTUxFbGVtZW50V3JhcHBlcik7XG5cbiAgLy8gRXhwb3NlIHRoZSB3cmFwcGVkIEhUTUxFbGVtZW50IGNvbnN0cnVjdG9yIGZvciBldmVyeW9uZSB0byBleHRlbmQgZnJvbS5cbiAgd2luLkhUTUxFbGVtZW50ID0gSFRNTEVsZW1lbnRXcmFwcGVyO1xufVxuXG4vKipcbiAqIFNldHVwcyB1cCBwcm90b3R5cGUgaW5oZXJpdGFuY2VcbiAqXG4gKiBAcGFyYW0geyFPYmplY3R9IE9iamVjdFxuICogQHBhcmFtIHshRnVuY3Rpb259IHN1cGVyQ2xhc3NcbiAqIEBwYXJhbSB7IUZ1bmN0aW9ufSBzdWJDbGFzc1xuICovXG5mdW5jdGlvbiBzdWJDbGFzcyhPYmplY3QsIHN1cGVyQ2xhc3MsIHN1YkNsYXNzKSB7XG4gIC8vIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc3VwZXJDbGFzcy5wcm90b3R5cGUsICdjb25zdHJ1Y3RvcicpXG4gIC8vIHt2YWx1ZTogxpIsIHdyaXRhYmxlOiB0cnVlLCBlbnVtZXJhYmxlOiBmYWxzZSwgY29uZmlndXJhYmxlOiB0cnVlfVxuICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7XG4gICAgY29uc3RydWN0b3I6IHtcbiAgICAgIC8vIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogc3ViQ2xhc3MsXG4gICAgfSxcbiAgfSk7XG59XG5cbi8qKlxuICogUG9seWZpbGxzIEN1c3RvbSBFbGVtZW50cyB2MSBBUEkuIFRoaXMgaGFzIDQgbW9kZXM6XG4gKlxuICogMS4gQ3VzdG9tIGVsZW1lbnRzIHYxIGFscmVhZHkgc3VwcG9ydGVkLCB1c2luZyBuYXRpdmUgY2xhc3Nlc1xuICogMi4gQ3VzdG9tIGVsZW1lbnRzIHYxIGFscmVhZHkgc3VwcG9ydGVkLCB1c2luZyB0cmFuc3BpbGVkIGNsYXNzZXNcbiAqIDMuIEN1c3RvbSBlbGVtZW50cyB2MSBub3Qgc3VwcG9ydGVkLCB1c2luZyBuYXRpdmUgY2xhc3Nlc1xuICogNC4gQ3VzdG9tIGVsZW1lbnRzIHYxIG5vdCBzdXBwb3J0ZWQsIHVzaW5nIHRyYW5zcGlsZWQgY2xhc3Nlc1xuICpcbiAqIEluIG1vZGUgMSwgbm90aGluZyBpcyBkb25lLiBJbiBtb2RlIDIsIGEgbWluaW1hbCBwb2x5ZmlsbCBpcyB1c2VkIHRvIHN1cHBvcnRcbiAqIGV4dGVuZGluZyB0aGUgSFRNTEVsZW1lbnQgYmFzZSBjbGFzcy4gSW4gbW9kZSAzIGFuZCA0LCBhIGZ1bGwgcG9seWZpbGwgaXNcbiAqIGRvbmUuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IUZ1bmN0aW9ufSBjdG9yXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnN0YWxsKHdpbiwgY3Rvcikge1xuICBpZiAoaXNQYXRjaGVkKHdpbikpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgaW5zdGFsbCA9IHRydWU7XG4gIGxldCBpbnN0YWxsV3JhcHBlciA9IGZhbHNlO1xuXG4gIGlmIChoYXNDdXN0b21FbGVtZW50cyh3aW4pKSB7XG4gICAgLy8gSWYgY3RvciBpcyBjb25zdHJ1Y3RhYmxlIHdpdGhvdXQgbmV3LCBpdCdzIGEgZnVuY3Rpb24uIFRoYXQgbWVhbnMgaXQgd2FzXG4gICAgLy8gY29tcGlsZWQgZG93biwgYW5kIHdlIG5lZWQgdG8gZG8gdGhlIG1pbmltYWwgcG9seWZpbGwgYmVjYXVzZSBhbGwgeW91XG4gICAgLy8gY2Fubm90IGV4dGVuZCBIVE1MRWxlbWVudCB3aXRob3V0IG5hdGl2ZSBjbGFzc2VzLlxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7T2JqZWN0LCBSZWZsZWN0fSA9IHdpbjtcblxuICAgICAgLy8gXCJDb25zdHJ1Y3RcIiBjdG9yIHVzaW5nIEVTNSBpZGlvbXNcbiAgICAgIGNvbnN0IGluc3RhbmNlID0gT2JqZWN0LmNyZWF0ZShjdG9yLnByb3RvdHlwZSk7XG4gICAgICBjdG9yLmNhbGwoaW5zdGFuY2UpO1xuXG4gICAgICAvLyBJZiB0aGF0IHN1Y2NlZWRlZCwgd2UncmUgaW4gYSB0cmFuc3BpbGVkIGVudmlyb25tZW50XG4gICAgICAvLyBMZXQncyBmaW5kIG91dCBpZiB3ZSBjYW4gd3JhcCBIVE1MRWxlbWVudCBhbmQgYXZvaWQgYSBmdWxsIHBhdGNoLlxuICAgICAgaW5zdGFsbFdyYXBwZXIgPSAhIShSZWZsZWN0ICYmIFJlZmxlY3QuY29uc3RydWN0KTtcbiAgICB9IGNhdGNoIChlKSB7XG5cbiAgICAgIC8vIFRoZSBjdG9yIHRocmV3IHdoZW4gd2UgY29uc3RydWN0ZWQgaXMgdmlhIEVTNSwgc28gaXQncyBhIHJlYWwgY2xhc3MuXG4gICAgICAvLyBXZSdyZSBvayB0byBub3QgaW5zdGFsbCB0aGUgcG9seWZpbGwuXG4gICAgICBpbnN0YWxsID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgaWYgKGluc3RhbGxXcmFwcGVyKSB7XG4gICAgd3JhcEhUTUxFbGVtZW50KHdpbik7XG4gIH0gZWxzZSBpZiAoaW5zdGFsbCkge1xuICAgIHBvbHlmaWxsKHdpbik7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogUG9seWZpbGwgZm9yIGBkb2N1bWVudC5jb250YWlucygpYCBtZXRob2QuIE5vdGljZSB0aGF0IGFjY29yZGluZyB0byBzcGVjXG4gKiBgZG9jdW1lbnQuY29udGFpbnNgIGlzIGluY2x1c2lvbmFyeS5cbiAqIFNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvTm9kZS9jb250YWluc1xuICogQHBhcmFtIHs/Tm9kZX0gbm9kZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0aGlzIHtOb2RlfVxuICovXG5mdW5jdGlvbiBkb2N1bWVudENvbnRhaW5zUG9seWZpbGwobm9kZSkge1xuICAvLyBQZXIgc3BlYywgXCJjb250YWluc1wiIG1ldGhvZCBpcyBpbmNsdXNpb25hcnlcbiAgLy8gaS5lLiBgbm9kZS5jb250YWlucyhub2RlKSA9PSB0cnVlYC4gSG93ZXZlciwgd2Ugc3RpbGwgbmVlZCB0byB0ZXN0XG4gIC8vIGVxdWFsaXR5IHRvIHRoZSBkb2N1bWVudCBpdHNlbGYuXG4gIHJldHVybiBub2RlID09IHRoaXMgfHwgdGhpcy5kb2N1bWVudEVsZW1lbnQuY29udGFpbnMobm9kZSk7XG59XG5cblxuLyoqXG4gKiBQb2x5ZmlsbHMgYEhUTUxEb2N1bWVudC5jb250YWluc2AgQVBJLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIC8vIEhUTUxEb2N1bWVudCBpcyB1bmRlZmluZWQgaW4gSW50ZXJuZXQgRXhwbG9yZXIgMTAsIGJ1dCBpdCBoYXMgRG9jdW1lbnQsXG4gIC8vIHNvIHdlIHVzZSB0aGF0IGFzIGEgZmFsbGJhY2suXG4gIGNvbnN0IGRvY3VtZW50Q2xhc3MgPSB3aW4uSFRNTERvY3VtZW50IHx8IHdpbi5Eb2N1bWVudDtcbiAgaWYgKCFkb2N1bWVudENsYXNzLnByb3RvdHlwZS5jb250YWlucykge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkoZG9jdW1lbnRDbGFzcy5wcm90b3R5cGUsICdjb250YWlucycsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogZG9jdW1lbnRDb250YWluc1BvbHlmaWxsLFxuICAgIH0pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBgRE9NVG9rZW5MaXN0LnByb3RvdHlwZS50b2dnbGUodG9rZW4sIG9wdF9mb3JjZSlgIG1ldGhvZC4gVGhpc1xuICogaXMgc3BlY2lhbGx5IGltcG9ydGFudCBiZWNhdXNlIElFIGRvZXMgbm90IHN1cHBvcnQgYG9wdF9mb3JjZWAgYXR0cmlidXRlLiBTZWVcbiAqIGh0dHBzOi8vZ29vLmdsL2hnS05ZWSBmb3IgZGV0YWlscy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0b2tlblxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2ZvcmNlXG4gKiBAdGhpcyB7RE9NVG9rZW5MaXN0fVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gZG9tVG9rZW5MaXN0VG9nZ2xlUG9seWZpbGwodG9rZW4sIG9wdF9mb3JjZSkge1xuICBjb25zdCByZW1vdmUgPSBvcHRfZm9yY2UgPT09IHVuZGVmaW5lZCA/IHRoaXMuY29udGFpbnModG9rZW4pIDogIW9wdF9mb3JjZTtcbiAgaWYgKHJlbW92ZSkge1xuICAgIHRoaXMucmVtb3ZlKHRva2VuKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5hZGQodG9rZW4pO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG5cblxuLyoqXG4gKiBQb2x5ZmlsbHMgYERPTVRva2VuTGlzdC5wcm90b3R5cGUudG9nZ2xlYCBBUEkgaW4gSUUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKGlzSWUod2luKSAmJiB3aW4uRE9NVG9rZW5MaXN0KSB7XG4gICAgd2luLk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW4uRE9NVG9rZW5MaXN0LnByb3RvdHlwZSwgJ3RvZ2dsZScsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogZG9tVG9rZW5MaXN0VG9nZ2xlUG9seWZpbGwsXG4gICAgfSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGN1cnJlbnQgYnJvd3NlciBpcyBhIElFIGJyb3dzZXIuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNJZSh3aW4pIHtcbiAgcmV0dXJuIC9UcmlkZW50fE1TSUV8SUVNb2JpbGUvaS50ZXN0KHdpbi5uYXZpZ2F0b3IudXNlckFnZW50KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIFBhcnNlcyB0aGUgbnVtYmVyIHggYW5kIHJldHVybnMgaXRzIHNpZ24uIEZvciBwb3NpdGl2ZSB4IHJldHVybnMgMSwgZm9yXG4gKiBuZWdhdGl2ZSwgLTEuIEZvciAwIGFuZCAtMCwgcmV0dXJucyAwIGFuZCAtMCByZXNwZWN0aXZlbHkuIEZvciBhbnkgbnVtYmVyXG4gKiB0aGF0IHBhcnNlcyB0byBOYU4sIHJldHVybnMgTmFOLlxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gKiBAcmV0dXJuIHtudW1iZXJ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaWduKHgpIHtcbiAgeCA9IE51bWJlcih4KTtcblxuICAvLyBJZiB4IGlzIDAsIC0wLCBvciBOYU4sIHJldHVybiBpdC5cbiAgaWYgKCF4KSB7XG4gICAgcmV0dXJuIHg7XG4gIH1cblxuICByZXR1cm4geCA+IDAgPyAxIDogLTE7XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBNYXRoLnNpZ24gcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uTWF0aC5zaWduKSB7XG4gICAgd2luLk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW4uTWF0aCwgJ3NpZ24nLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IHNpZ24sXG4gICAgfSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5jb25zdCB7aGFzT3duUHJvcGVydHl9ID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqXG4gKiBDb3BpZXMgdmFsdWVzIG9mIGFsbCBlbnVtZXJhYmxlIG93biBwcm9wZXJ0aWVzIGZyb20gb25lIG9yIG1vcmUgc291cmNlXG4gKiBvYmplY3RzIChwcm92aWRlZCBhcyBleHRlbmRlZCBhcmd1bWVudHMgdG8gdGhlIGZ1bmN0aW9uKSB0byBhIHRhcmdldCBvYmplY3QuXG4gKlxuICogQHBhcmFtIHshT2JqZWN0fSB0YXJnZXRcbiAqIEBwYXJhbSB7Li4uT2JqZWN0fSB2YXJfYXJnc1xuICogQHJldHVybiB7IU9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQsIHZhcl9hcmdzKSB7XG4gIGlmICh0YXJnZXQgPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjb252ZXJ0IHVuZGVmaW5lZCBvciBudWxsIHRvIG9iamVjdCcpO1xuICB9XG5cbiAgY29uc3Qgb3V0cHV0ID0gT2JqZWN0KHRhcmdldCk7XG4gIGZvciAobGV0IGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgIGlmIChzb3VyY2UgIT0gbnVsbCkge1xuICAgICAgZm9yIChjb25zdCBrZXkgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkge1xuICAgICAgICAgIG91dHB1dFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG91dHB1dDtcbn1cblxuXG4vKipcbiAqIFNldHMgdGhlIE9iamVjdC5hc3NpZ24gcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uT2JqZWN0LmFzc2lnbikge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkod2luLk9iamVjdCwgJ2Fzc2lnbicsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogYXNzaWduLFxuICAgIH0pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG5pbXBvcnQgKiBhcyBQcm9taXNlIGZyb20gJ3Byb21pc2UtcGpzL3Byb21pc2UnO1xuXG4vKipcbiAqIFNldHMgdGhlIFByb21pc2UgcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uUHJvbWlzZSkge1xuICAgIHdpbi5Qcm9taXNlID0gLyoqIEB0eXBlIHs/fSAqLyAoUHJvbWlzZSk7XG4gICAgLy8gSW4gYmFiZWwgdGhlICogZXhwb3J0IGlzIGFuIE9iamVjdCB3aXRoIGEgZGVmYXVsdCBwcm9wZXJ0eS5cbiAgICAvLyBJbiBjbG9zdXJlIGNvbXBpbGVyIGl0IGlzIHRoZSBQcm9taXNlIGZ1bmN0aW9uIGl0c2VsZi5cbiAgICBpZiAoUHJvbWlzZS5kZWZhdWx0KSB7XG4gICAgICB3aW4uUHJvbWlzZSA9IFByb21pc2UuZGVmYXVsdDtcbiAgICB9XG4gICAgLy8gV2UgY29weSB0aGUgaW5kaXZpZHVhbCBzdGF0aWMgbWV0aG9kcywgYmVjYXVzZSBjbG9zdXJlXG4gICAgLy8gY29tcGlsZXIgZmxhdHRlbnMgdGhlIHBvbHlmaWxsIG5hbWVzcGFjZS5cbiAgICB3aW4uUHJvbWlzZS5yZXNvbHZlID0gUHJvbWlzZS5yZXNvbHZlO1xuICAgIHdpbi5Qcm9taXNlLnJlamVjdCA9IFByb21pc2UucmVqZWN0O1xuICAgIHdpbi5Qcm9taXNlLmFsbCA9IFByb21pc2UuYWxsO1xuICAgIHdpbi5Qcm9taXNlLnJhY2UgPSBQcm9taXNlLnJhY2U7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuL3NlcnZpY2VzJztcbmltcG9ydCB7ZGV2fSBmcm9tICcuL2xvZyc7XG5pbXBvcnQge2dldFNlcnZpY2VQcm9taXNlfSBmcm9tICcuL3NlcnZpY2UnO1xuXG4vKipcbiAqIEEgbWFwIG9mIHNlcnZpY2VzIHRoYXQgZGVsYXkgcmVuZGVyaW5nLiBUaGUga2V5IGlzIHRoZSBuYW1lIG9mIHRoZSBzZXJ2aWNlXG4gKiBhbmQgdGhlIHZhbHVlIGlzIGEgRE9NIHF1ZXJ5IHdoaWNoIGlzIHVzZWQgdG8gY2hlY2sgaWYgdGhlIHNlcnZpY2UgaXMgbmVlZGVkXG4gKiBpbiB0aGUgY3VycmVudCBkb2N1bWVudC5cbiAqIERvIG5vdCBhZGQgYSBzZXJ2aWNlIHVubGVzcyBhYnNvbHV0ZWx5IG5lY2Vzc2FyeS5cbiAqXG4gKiBcXCAgIFxcICAvICBcXCAgLyAgIC8gLyAgIFxcICAgICB8ICAgXyAgXFwgICAgIHwgIFxcIHwgIHwgfCAgfCB8ICBcXCB8ICB8ICAvIF9fX19ffFxuICogIFxcICAgXFwvICAgIFxcLyAgIC8gLyAgXiAgXFwgICAgfCAgfF8pICB8ICAgIHwgICBcXHwgIHwgfCAgfCB8ICAgXFx8ICB8IHwgIHwgIF9fXG4gKiAgIFxcICAgICAgICAgICAgLyAvICAvX1xcICBcXCAgIHwgICAgICAvICAgICB8ICAuIGAgIHwgfCAgfCB8ICAuIGAgIHwgfCAgfCB8XyB8XG4gKiAgICBcXCAgICAvXFwgICAgLyAvICBfX19fXyAgXFwgIHwgIHxcXCAgXFwtLS0tLnwgIHxcXCAgIHwgfCAgfCB8ICB8XFwgICB8IHwgIHxfX3wgfFxuICogICAgIFxcX18vICBcXF9fLyAvX18vICAgICBcXF9fXFwgfCBffCBgLl9fX19ffHxfX3wgXFxfX3wgfF9ffCB8X198IFxcX198ICBcXF9fX19fX3xcbiAqXG4gKiBUaGUgZXF1aXZhbGVudCBvZiB0aGlzIGxpc3QgaXMgdXNlZCBmb3Igc2VydmVyLXNpZGUgcmVuZGVyaW5nIChTU1IpIGFuZCBhbnlcbiAqIGNoYW5nZXMgbWFkZSB0byBpdCBtdXN0IGJlIG1hZGUgaW4gY29vcmRpbmF0aW9uIHdpdGggY2FjaGVzIHRoYXQgaW1wbGVtZW50XG4gKiBTU1IuIEZvciBtb3JlIGluZm9ybWF0aW9uIG9uIFNTUiBzZWUgYml0Lmx5L2FtcC1zc3IuXG4gKlxuICogQGNvbnN0IHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn1cbiAqL1xuY29uc3QgU0VSVklDRVMgPSB7XG4gICdhbXAtZHluYW1pYy1jc3MtY2xhc3Nlcyc6ICdbY3VzdG9tLWVsZW1lbnQ9YW1wLWR5bmFtaWMtY3NzLWNsYXNzZXNdJyxcbiAgJ3ZhcmlhbnQnOiAnYW1wLWV4cGVyaW1lbnQnLFxuICAnYW1wLXN0b3J5JzogJ2FtcC1zdG9yeVtzdGFuZGFsb25lXScsXG59O1xuXG4vKipcbiAqIE1heGltdW0gbWlsbGlzZWNvbmRzIHRvIHdhaXQgZm9yIGFsbCBleHRlbnNpb25zIHRvIGxvYWQgYmVmb3JlIGVycm9yaW5nLlxuICogQGNvbnN0XG4gKi9cbmNvbnN0IExPQURfVElNRU9VVCA9IDMwMDA7XG5cbi8qKlxuICogRGV0ZWN0cyBhbnkgcmVuZGVyIGRlbGF5aW5nIHNlcnZpY2VzIHRoYXQgYXJlIHJlcXVpcmVkIG9uIHRoZSBwYWdlLCBhbmRcbiAqIHJldHVybnMgYSBwcm9taXNlIHdpdGggYSB0aW1lb3V0LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFQcm9taXNlPCFBcnJheTwqPj59IHJlc29sdmVzIHRvIGFuIEFycmF5IHRoYXQgaGFzIHRoZSBzYW1lIGxlbmd0aFxuICogICAgIGFzIHRoZSBkZXRlY3RlZCByZW5kZXIgZGVsYXlpbmcgc2VydmljZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JTZXJ2aWNlcyh3aW4pIHtcbiAgY29uc3QgcHJvbWlzZXMgPSBpbmNsdWRlZFNlcnZpY2VzKHdpbikubWFwKHNlcnZpY2UgPT4ge1xuICAgIHJldHVybiBTZXJ2aWNlcy50aW1lckZvcih3aW4pLnRpbWVvdXRQcm9taXNlKFxuICAgICAgICBMT0FEX1RJTUVPVVQsXG4gICAgICAgIGdldFNlcnZpY2VQcm9taXNlKHdpbiwgc2VydmljZSksXG4gICAgICAgIGBSZW5kZXIgdGltZW91dCB3YWl0aW5nIGZvciBzZXJ2aWNlICR7c2VydmljZX0gdG8gYmUgcmVhZHkuYFxuICAgICk7XG4gIH0pO1xuICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgcGFnZSBoYXMgYSByZW5kZXIgZGVsYXlpbmcgc2VydmljZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzUmVuZGVyRGVsYXlpbmdTZXJ2aWNlcyh3aW4pIHtcbiAgcmV0dXJuIGluY2x1ZGVkU2VydmljZXMod2luKS5sZW5ndGggPiAwO1xufVxuXG4vKipcbiAqIERldGVjdHMgd2hpY2gsIGlmIGFueSwgcmVuZGVyLWRlbGF5aW5nIGV4dGVuc2lvbnMgYXJlIGluY2x1ZGVkIG9uIHRoZSBwYWdlLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFBcnJheTxzdHJpbmc+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5jbHVkZWRTZXJ2aWNlcyh3aW4pIHtcbiAgLyoqIEBjb25zdCB7IURvY3VtZW50fSAqL1xuICBjb25zdCBkb2MgPSB3aW4uZG9jdW1lbnQ7XG4gIGRldigpLmFzc2VydChkb2MuYm9keSk7XG5cbiAgcmV0dXJuIE9iamVjdC5rZXlzKFNFUlZJQ0VTKS5maWx0ZXIoc2VydmljZSA9PiB7XG4gICAgcmV0dXJuIGRvYy5xdWVyeVNlbGVjdG9yKFNFUlZJQ0VTW3NlcnZpY2VdKTtcbiAgfSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IFJlZ2lzdHJhdGlvbiBhbmQgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgQU1QIHNlcnZpY2VzLlxuICpcbiAqIEludmFyaWFudDogU2VydmljZSBnZXR0ZXJzIG5ldmVyIHJldHVybiBudWxsIGZvciByZWdpc3RlcmVkIHNlcnZpY2VzLlxuICovXG5cbi8vIHNyYy9wb2x5ZmlsbHMuanMgbXVzdCBiZSB0aGUgZmlyc3QgaW1wb3J0LlxuaW1wb3J0ICcuL3BvbHlmaWxscyc7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgc29ydC1pbXBvcnRzLWVzNi1hdXRvZml4L3NvcnQtaW1wb3J0cy1lczZcblxuaW1wb3J0IHtEZWZlcnJlZH0gZnJvbSAnLi91dGlscy9wcm9taXNlJztcbmltcG9ydCB7ZGV2fSBmcm9tICcuL2xvZyc7XG5pbXBvcnQge3RvV2lufSBmcm9tICcuL3R5cGVzJztcblxuXG4vKipcbiAqIEhvbGRzIGluZm8gYWJvdXQgYSBzZXJ2aWNlLlxuICogLSBvYmo6IEFjdHVhbCBzZXJ2aWNlIGltcGxlbWVudGF0aW9uIHdoZW4gYXZhaWxhYmxlLlxuICogLSBwcm9taXNlOiBQcm9taXNlIGZvciB0aGUgb2JqLlxuICogLSByZXNvbHZlOiBGdW5jdGlvbiB0byByZXNvbHZlIHRoZSBwcm9taXNlIHdpdGggdGhlIG9iamVjdC5cbiAqIC0gY29udGV4dDogQXJndW1lbnQgZm9yIGN0b3IsIGVpdGhlciBhIHdpbmRvdyBvciBhbiBhbXBkb2MuXG4gKiAtIGN0b3I6IEZ1bmN0aW9uIHRoYXQgY29uc3RydWN0cyBhbmQgcmV0dXJucyB0aGUgc2VydmljZS5cbiAqIEB0eXBlZGVmIHt7XG4gKiAgIG9iajogKD9PYmplY3QpLFxuICogICBwcm9taXNlOiAoP1Byb21pc2UpLFxuICogICByZXNvbHZlOiAoP2Z1bmN0aW9uKCFPYmplY3QpKSxcbiAqICAgY29udGV4dDogKD9XaW5kb3d8Py4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2MpLFxuICogICBjdG9yOiAoP2Z1bmN0aW9uKG5ldzpPYmplY3QsICFXaW5kb3cpfFxuICogICAgICAgICAgP2Z1bmN0aW9uKG5ldzpPYmplY3QsICEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jKSksXG4gKiB9fVxuICovXG5sZXQgU2VydmljZUhvbGRlckRlZjtcblxuXG4vKipcbiAqIFRoaXMgaW50ZXJmYWNlIHByb3ZpZGVzIGEgYGRpc3Bvc2VgIG1ldGhvZCB0aGF0IHdpbGwgYmUgY2FsbGVkIGJ5XG4gKiBydW50aW1lIHdoZW4gYSBzZXJ2aWNlIG5lZWRzIHRvIGJlIGRpc3Bvc2VkIG9mLlxuICogQGludGVyZmFjZVxuICovXG5leHBvcnQgY2xhc3MgRGlzcG9zYWJsZSB7XG5cbiAgLyoqXG4gICAqIEluc3RydWN0cyB0aGUgc2VydmljZSB0byByZWxlYXNlIGFueSByZXNvdXJjZXMgaXQgbWlnaHQgYmUgaG9sZGluZy4gQ2FuXG4gICAqIGJlIGNhbGxlZCBvbmx5IG9uY2UgaW4gdGhlIGxpZmVjeWNsZSBvZiBhIHNlcnZpY2UuXG4gICAqL1xuICBkaXNwb3NlKCkge31cbn1cblxuXG4vKipcbiAqIFRoaXMgaW50ZXJmYWNlIHByb3ZpZGVzIGEgYGFkb3B0RW1iZWRXaW5kb3dgIG1ldGhvZCB0aGF0IHdpbGwgYmUgY2FsbGVkIGJ5XG4gKiBydW50aW1lIGZvciBhIG5ldyBlbWJlZCB3aW5kb3cuXG4gKiBAaW50ZXJmYWNlXG4gKi9cbmV4cG9ydCBjbGFzcyBFbWJlZGRhYmxlU2VydmljZSB7XG5cbiAgLyoqXG4gICAqIEluc3RydWN0cyB0aGUgc2VydmljZSB0byBhZG9wdCB0aGUgZW1iZWQgd2luZG93IGFuZCBhZGQgYW55IG5lY2Vzc2FyeVxuICAgKiBsaXN0ZW5lcnMgYW5kIHJlc291cmNlcy5cbiAgICogQHBhcmFtIHshV2luZG93fSB1bnVzZWRFbWJlZFdpblxuICAgKi9cbiAgYWRvcHRFbWJlZFdpbmRvdyh1bnVzZWRFbWJlZFdpbikge31cbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBzZXJ2aWNlIHdpdGggdGhlIGdpdmVuIGlkLiBBc3N1bWVzIHRoYXQgaXQgaGFzIGJlZW4gcmVnaXN0ZXJlZFxuICogYWxyZWFkeS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9mYWxsYmFja1RvVG9wV2luXG4gKiBAcmV0dXJuIHtPYmplY3R9IFRoZSBzZXJ2aWNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXhpc3RpbmdTZXJ2aWNlSW5FbWJlZFNjb3BlKHdpbiwgaWQsIG9wdF9mYWxsYmFja1RvVG9wV2luKSB7XG4gIC8vIEZpcnN0LCB0cnkgdG8gcmVzb2x2ZSB2aWEgbG9jYWwgKGVtYmVkKSB3aW5kb3cuXG4gIGNvbnN0IGxvY2FsID0gZ2V0TG9jYWxFeGlzdGluZ1NlcnZpY2VGb3JFbWJlZFdpbk9yTnVsbCh3aW4sIGlkKTtcbiAgaWYgKGxvY2FsKSB7XG4gICAgcmV0dXJuIGxvY2FsO1xuICB9XG4gIGlmIChvcHRfZmFsbGJhY2tUb1RvcFdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbiwgaWQpO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBzZXJ2aWNlIHdpdGggdGhlIGdpdmVuIGlkLiBBc3N1bWVzIHRoYXQgaXQgaGFzIGJlZW4gY29uc3RydWN0ZWRcbiAqIGFscmVhZHkuXG4gKlxuICogVW5saWtlIG1vc3Qgc2VydmljZSBnZXR0ZXJzLCBwYXNzaW5nIGBOb2RlYCBpcyBuZWNlc3NhcnkgZm9yIHNvbWUgRklFLXNjb3BlXG4gKiBzZXJ2aWNlcyBzaW5jZSBzb21ldGltZXMgd2Ugb25seSBoYXZlIHRoZSBGSUUgRG9jdW1lbnQgZm9yIGNvbnRleHQuXG4gKlxuICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9mYWxsYmFja1RvVG9wV2luXG4gKiBAcmV0dXJuIHtPYmplY3R9IFRoZSBzZXJ2aWNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICBub2RlT3JEb2MsIGlkLCBvcHRfZmFsbGJhY2tUb1RvcFdpbikge1xuICAvLyBGaXJzdCwgdHJ5IHRvIHJlc29sdmUgdmlhIGxvY2FsIChlbWJlZCkgd2luZG93LlxuICBpZiAobm9kZU9yRG9jLm5vZGVUeXBlKSB7XG4gICAgLy8gSWYgYSBub2RlIGlzIHBhc3NlZCwgdHJ5IHRvIHJlc29sdmUgdmlhIHRoaXMgbm9kZS5cbiAgICBjb25zdCB3aW4gPSB0b1dpbigvKiogQHR5cGUgeyFEb2N1bWVudH0gKi8gKFxuICAgICAgbm9kZU9yRG9jLm93bmVyRG9jdW1lbnQgfHwgbm9kZU9yRG9jKS5kZWZhdWx0Vmlldyk7XG4gICAgY29uc3QgbG9jYWwgPSBnZXRMb2NhbEV4aXN0aW5nU2VydmljZUZvckVtYmVkV2luT3JOdWxsKHdpbiwgaWQpO1xuICAgIGlmIChsb2NhbCkge1xuICAgICAgcmV0dXJuIGxvY2FsO1xuICAgIH1cbiAgfVxuICAvLyBJZiBhbiBhbXBkb2MgaXMgcGFzc2VkIG9yIGZhbGxiYWNrIGlzIGFsbG93ZWQsIGNvbnRpbnVlIHJlc29sdmluZy5cbiAgaWYgKCFub2RlT3JEb2Mubm9kZVR5cGUgfHwgb3B0X2ZhbGxiYWNrVG9Ub3BXaW4pIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQobm9kZU9yRG9jLCBpZCk7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogSW5zdGFsbHMgYSBzZXJ2aWNlIG92ZXJyaWRlIG9uIGFtcC1kb2MgbGV2ZWwuXG4gKiBAcGFyYW0geyFXaW5kb3d9IGVtYmVkV2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEBwYXJhbSB7IU9iamVjdH0gc2VydmljZSBUaGUgc2VydmljZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGxTZXJ2aWNlSW5FbWJlZFNjb3BlKGVtYmVkV2luLCBpZCwgc2VydmljZSkge1xuICBjb25zdCB0b3BXaW4gPSBnZXRUb3BXaW5kb3coZW1iZWRXaW4pO1xuICBkZXYoKS5hc3NlcnQoZW1iZWRXaW4gIT0gdG9wV2luLFxuICAgICAgJ1NlcnZpY2Ugb3ZlcnJpZGUgY2FuIG9ubHkgYmUgaW5zdGFsbGVkIGluIGVtYmVkIHdpbmRvdzogJXMnLCBpZCk7XG4gIGRldigpLmFzc2VydCghZ2V0TG9jYWxFeGlzdGluZ1NlcnZpY2VGb3JFbWJlZFdpbk9yTnVsbChlbWJlZFdpbiwgaWQpLFxuICAgICAgJ1NlcnZpY2Ugb3ZlcnJpZGUgaGFzIGFscmVhZHkgYmVlbiBpbnN0YWxsZWQ6ICVzJywgaWQpO1xuICByZWdpc3RlclNlcnZpY2VJbnRlcm5hbChlbWJlZFdpbiwgZW1iZWRXaW4sIGlkLCAoKSA9PiBzZXJ2aWNlKTtcbiAgZ2V0U2VydmljZUludGVybmFsKGVtYmVkV2luLCBpZCk7IC8vIEZvcmNlIHNlcnZpY2UgdG8gYnVpbGQuXG59XG5cbi8qKlxuICogQHBhcmFtIHshV2luZG93fSBlbWJlZFdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJuIHs/T2JqZWN0fVxuICovXG5mdW5jdGlvbiBnZXRMb2NhbEV4aXN0aW5nU2VydmljZUZvckVtYmVkV2luT3JOdWxsKGVtYmVkV2luLCBpZCkge1xuICAvLyBOb3RlIHRoYXQgdGhpcyBtZXRob2QgY3VycmVudGx5IG9ubHkgcmVzb2x2ZXMgYWdhaW5zdCB0aGUgZ2l2ZW4gd2luZG93LlxuICAvLyBJdCBkb2VzIG5vdCB0cnkgdG8gZ28gYWxsIHRoZSB3YXkgdXAgdGhlIHBhcmVudCB3aW5kb3cgY2hhaW4uIFdlIGNhbiBjaGFuZ2VcbiAgLy8gdGhpcyBpbiB0aGUgZnV0dXJlLCBidXQgZm9yIG5vdyB0aGlzIGdpdmVzIHVzIGEgYmV0dGVyIHBlcmZvcm1hbmNlLlxuICBjb25zdCB0b3BXaW4gPSBnZXRUb3BXaW5kb3coZW1iZWRXaW4pO1xuICBpZiAoZW1iZWRXaW4gIT0gdG9wV2luICYmIGlzU2VydmljZVJlZ2lzdGVyZWQoZW1iZWRXaW4sIGlkKSkge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlSW50ZXJuYWwoZW1iZWRXaW4sIGlkKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vKipcbiAqIFJlZ2lzdGVycyBhIHNlcnZpY2UgZ2l2ZW4gYSBjbGFzcyB0byBiZSB1c2VkIGFzIGltcGxlbWVudGF0aW9uLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24obmV3Ok9iamVjdCwgIVdpbmRvdyl9IGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfaW5zdGFudGlhdGUgV2hldGhlciB0byBpbW1lZGlhdGVseSBjcmVhdGUgdGhlIHNlcnZpY2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyU2VydmljZUJ1aWxkZXIod2luLFxuICBpZCxcbiAgY29uc3RydWN0b3IsXG4gIG9wdF9pbnN0YW50aWF0ZSkge1xuICB3aW4gPSBnZXRUb3BXaW5kb3cod2luKTtcbiAgcmVnaXN0ZXJTZXJ2aWNlSW50ZXJuYWwod2luLCB3aW4sIGlkLCBjb25zdHJ1Y3Rvcik7XG4gIGlmIChvcHRfaW5zdGFudGlhdGUpIHtcbiAgICBnZXRTZXJ2aWNlSW50ZXJuYWwod2luLCBpZCk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBzZXJ2aWNlIGFuZCByZWdpc3RlcnMgaXQgZ2l2ZW4gYSBjbGFzcyB0byBiZSB1c2VkIGFzXG4gKiBpbXBsZW1lbnRhdGlvbi5cbiAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtmdW5jdGlvbihuZXc6T2JqZWN0LCAhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvYyl9IGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfaW5zdGFudGlhdGUgV2hldGhlciB0byBpbW1lZGlhdGVseSBjcmVhdGUgdGhlIHNlcnZpY2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyU2VydmljZUJ1aWxkZXJGb3JEb2Mobm9kZU9yRG9jLFxuICBpZCxcbiAgY29uc3RydWN0b3IsXG4gIG9wdF9pbnN0YW50aWF0ZSkge1xuICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2Mobm9kZU9yRG9jKTtcbiAgY29uc3QgaG9sZGVyID0gZ2V0QW1wZG9jU2VydmljZUhvbGRlcihhbXBkb2MpO1xuICByZWdpc3RlclNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGFtcGRvYywgaWQsIGNvbnN0cnVjdG9yKTtcbiAgaWYgKG9wdF9pbnN0YW50aWF0ZSkge1xuICAgIGdldFNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGlkKTtcbiAgfVxufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2UgZm9yIHRoZSBnaXZlbiBpZCBhbmQgd2luZG93IChhIHBlci13aW5kb3cgc2luZ2xldG9uKS4gVXNlcnNcbiAqIHNob3VsZCB0eXBpY2FsbHkgd3JhcCB0aGlzIGFzIGEgc3BlY2lhbCBwdXJwb3NlIGZ1bmN0aW9uIChlLmcuXG4gKiBgU2VydmljZXMudnN5bmNGb3Iod2luKWApIGZvciB0eXBlIHNhZmV0eSBhbmQgYmVjYXVzZSB0aGUgZmFjdG9yeSBzaG91bGQgbm90XG4gKiBiZSBwYXNzZWQgYXJvdW5kLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEB0ZW1wbGF0ZSBUXG4gKiBAcmV0dXJuIHtUfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZSh3aW4sIGlkKSB7XG4gIHdpbiA9IGdldFRvcFdpbmRvdyh3aW4pO1xuICByZXR1cm4gZ2V0U2VydmljZUludGVybmFsKHdpbiwgaWQpO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgZm9yIGEgc2VydmljZSBmb3IgdGhlIGdpdmVuIGlkIGFuZCB3aW5kb3cuIEFsc28gZXhwZWN0cyBhblxuICogZWxlbWVudCB0aGF0IGhhcyB0aGUgYWN0dWFsIGltcGxlbWVudGF0aW9uLiBUaGUgcHJvbWlzZSByZXNvbHZlcyB3aGVuIHRoZVxuICogaW1wbGVtZW50YXRpb24gbG9hZGVkLiBVc2VycyBzaG91bGQgdHlwaWNhbGx5IHdyYXAgdGhpcyBhcyBhIHNwZWNpYWwgcHVycG9zZVxuICogZnVuY3Rpb24gKGUuZy4gYFNlcnZpY2VzLnZzeW5jRm9yKHdpbilgKSBmb3IgdHlwZSBzYWZldHkgYW5kIGJlY2F1c2UgdGhlXG4gKiBmYWN0b3J5IHNob3VsZCBub3QgYmUgcGFzc2VkIGFyb3VuZC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhT2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNlcnZpY2VQcm9taXNlKHdpbiwgaWQpIHtcbiAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlSW50ZXJuYWwod2luLCBpZCk7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VydmljZSBvciBudWxsIHdpdGggdGhlIGdpdmVuIGlkLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybiB7P09iamVjdH0gVGhlIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFeGlzdGluZ1NlcnZpY2VPck51bGwod2luLCBpZCkge1xuICB3aW4gPSBnZXRUb3BXaW5kb3cod2luKTtcbiAgaWYgKGlzU2VydmljZVJlZ2lzdGVyZWQod2luLCBpZCkpIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZUludGVybmFsKHdpbiwgaWQpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cblxuLyoqXG4gKiBMaWtlIGdldFNlcnZpY2VQcm9taXNlIGJ1dCByZXR1cm5zIG51bGwgaWYgdGhlIHNlcnZpY2Ugd2FzIG5ldmVyIHJlZ2lzdGVyZWQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJuIHs/UHJvbWlzZTwhT2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsKHdpbiwgaWQpIHtcbiAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsSW50ZXJuYWwod2luLCBpZCk7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VydmljZSBmb3IgdGhlIGdpdmVuIGlkIGFuZCBhbXBkb2MgKGEgcGVyLWFtcGRvYyBzaW5nbGV0b24pLlxuICogRXhwZWN0cyBzZXJ2aWNlIGBpZGAgdG8gYmUgcmVnaXN0ZXJlZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJuIHtUfVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCkge1xuICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2MoZWxlbWVudE9yQW1wRG9jKTtcbiAgY29uc3QgaG9sZGVyID0gZ2V0QW1wZG9jU2VydmljZUhvbGRlcihhbXBkb2MpO1xuICByZXR1cm4gZ2V0U2VydmljZUludGVybmFsKGhvbGRlciwgaWQpO1xufVxuXG5cbi8qKlxuICogdGw7ZHIgLS0gVXNlIGdldFNlcnZpY2VGb3JEb2MoKSBpbnN0ZWFkIG9mIHRoaXMuXG4gKlxuICogUHJpdmlsZWdlZCB2YXJpYW50IG9mIGdldFNlcnZpY2VGb3JEb2MoKSB0aGF0IGFjY2VwdHMgbm9uLWVsZW1lbnQgcGFyYW1zLFxuICogZS5nLiB3aW5kb3cuZG9jdW1lbnQuIFRoaXMgaXMgY3VycmVudGx5IG5lY2Vzc2FyeSBmb3IgZG9jLWxldmVsIHNlcnZpY2VzXG4gKiB1c2VkIGluIHN0YXJ0dXAsIGUuZy4gQ2h1bmtzLiBFdmVudHVhbGx5IHdlIHdhbnQgdG8gcmVtb3ZlIHRoaXMgZnVuY3Rpb25cbiAqIGFuZCBoYXZlIGNhbGxlcnMgZmluZCB0aGUgYXBwcm9wcmlhdGUgQW1wRG9jIGFuZCB1c2UgZ2V0U2VydmljZUZvckRvYygpLlxuICpcbiAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJuIHtUfVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKG5vZGVPckRvYywgaWQpIHtcbiAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKG5vZGVPckRvYyk7XG4gIGNvbnN0IGhvbGRlciA9IGdldEFtcGRvY1NlcnZpY2VIb2xkZXIoYW1wZG9jKTtcbiAgcmV0dXJuIGdldFNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGlkKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIGZvciBhIHNlcnZpY2UgZm9yIHRoZSBnaXZlbiBpZCBhbmQgYW1wZG9jLiBBbHNvIGV4cGVjdHNcbiAqIGEgc2VydmljZSB0aGF0IGhhcyB0aGUgYWN0dWFsIGltcGxlbWVudGF0aW9uLiBUaGUgcHJvbWlzZSByZXNvbHZlcyB3aGVuXG4gKiB0aGUgaW1wbGVtZW50YXRpb24gbG9hZGVkLlxuICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4geyFQcm9taXNlPCFPYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCkge1xuICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VJbnRlcm5hbChcbiAgICAgIGdldEFtcGRvY1NlcnZpY2VIb2xkZXIoZWxlbWVudE9yQW1wRG9jKSwgaWQpO1xufVxuXG5cbi8qKlxuICogTGlrZSBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyBidXQgcmV0dXJucyBudWxsIGlmIHRoZSBzZXJ2aWNlIHdhcyBuZXZlclxuICogcmVnaXN0ZXJlZCBmb3IgdGhpcyBhbXBkb2MuXG4gKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybiB7P1Byb21pc2U8IU9iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGlkKSB7XG4gIHJldHVybiBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEludGVybmFsKFxuICAgICAgZ2V0QW1wZG9jU2VydmljZUhvbGRlcihlbGVtZW50T3JBbXBEb2MpLCBpZCk7XG59XG5cbi8qKlxuICogU2V0IHRoZSBwYXJlbnQgYW5kIHRvcCB3aW5kb3dzIG9uIGEgY2hpbGQgd2luZG93IChmcmllbmRseSBpZnJhbWUpLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IVdpbmRvd30gcGFyZW50V2luXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRQYXJlbnRXaW5kb3cod2luLCBwYXJlbnRXaW4pIHtcbiAgd2luLl9fQU1QX1BBUkVOVCA9IHBhcmVudFdpbjtcbiAgd2luLl9fQU1QX1RPUCA9IGdldFRvcFdpbmRvdyhwYXJlbnRXaW4pO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyB0aGUgcGFyZW50IHdpbmRvdyBmb3IgYSBjaGlsZCB3aW5kb3cgKGZyaWVuZGx5IGlmcmFtZSkuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IVdpbmRvd31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFBhcmVudFdpbmRvdyh3aW4pIHtcbiAgcmV0dXJuIHdpbi5fX0FNUF9QQVJFTlQgfHwgd2luO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyB0aGUgdG9wIHdpbmRvdyB3aGVyZSBBTVAgUnVudGltZSBpcyBpbnN0YWxsZWQgZm9yIGEgY2hpbGQgd2luZG93XG4gKiAoZnJpZW5kbHkgaWZyYW1lKS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshV2luZG93fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VG9wV2luZG93KHdpbikge1xuICByZXR1cm4gd2luLl9fQU1QX1RPUCB8fCB3aW47XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwYXJlbnQgXCJmcmllbmRseVwiIGlmcmFtZSBpZiB0aGUgbm9kZSBiZWxvbmdzIHRvIGEgY2hpbGQgd2luZG93LlxuICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICogQHBhcmFtIHshV2luZG93fSB0b3BXaW5cbiAqIEByZXR1cm4gez9IVE1MSUZyYW1lRWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFBhcmVudFdpbmRvd0ZyYW1lRWxlbWVudChub2RlLCB0b3BXaW4pIHtcbiAgY29uc3QgY2hpbGRXaW4gPSAobm9kZS5vd25lckRvY3VtZW50IHx8IG5vZGUpLmRlZmF1bHRWaWV3O1xuICBpZiAoY2hpbGRXaW4gJiYgY2hpbGRXaW4gIT0gdG9wV2luICYmIGdldFRvcFdpbmRvdyhjaGlsZFdpbikgPT0gdG9wV2luKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiAvKiogQHR5cGUgez9IVE1MSUZyYW1lRWxlbWVudH0gKi8gKGNoaWxkV2luLmZyYW1lRWxlbWVudCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gSWdub3JlIHRoZSBlcnJvci5cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAqIEByZXR1cm4geyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QW1wZG9jKG5vZGVPckRvYykge1xuICBpZiAobm9kZU9yRG9jLm5vZGVUeXBlKSB7XG4gICAgY29uc3Qgd2luID0gdG9XaW4oLyoqIEB0eXBlIHshRG9jdW1lbnR9ICovIChcbiAgICAgIG5vZGVPckRvYy5vd25lckRvY3VtZW50IHx8IG5vZGVPckRvYykuZGVmYXVsdFZpZXcpO1xuICAgIHJldHVybiBnZXRBbXBkb2NTZXJ2aWNlKHdpbikuZ2V0QW1wRG9jKC8qKiBAdHlwZSB7IU5vZGV9ICovIChub2RlT3JEb2MpKTtcbiAgfVxuICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gKi8gKG5vZGVPckRvYyk7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAqIEByZXR1cm4geyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfCFXaW5kb3d9XG4gKi9cbmZ1bmN0aW9uIGdldEFtcGRvY1NlcnZpY2VIb2xkZXIobm9kZU9yRG9jKSB7XG4gIGNvbnN0IGFtcGRvYyA9IGdldEFtcGRvYyhub2RlT3JEb2MpO1xuICByZXR1cm4gYW1wZG9jLmlzU2luZ2xlRG9jKCkgPyBhbXBkb2Mud2luIDogYW1wZG9jO1xufVxuXG5cbi8qKlxuICogVGhpcyBpcyBlc3NlbnRpYWxseSBhIGR1cGxpY2F0ZSBvZiBgYW1wZG9jLmpzYCwgYnV0IG5lY2Vzc2FyeSB0byBhdm9pZFxuICogY2lyY3VsYXIgZGVwZW5kZW5jaWVzLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jU2VydmljZX1cbiAqL1xuZnVuY3Rpb24gZ2V0QW1wZG9jU2VydmljZSh3aW4pIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2NTZXJ2aWNlfSAqLyAoXG4gICAgZ2V0U2VydmljZSh3aW4sICdhbXBkb2MnKSk7XG59XG5cblxuLyoqXG4gKiBHZXQgc2VydmljZSBgaWRgIGZyb20gYGhvbGRlcmAuIEFzc3VtZXMgdGhlIHNlcnZpY2VcbiAqIGhhcyBhbHJlYWR5IGJlZW4gcmVnaXN0ZXJlZC5cbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyIE9iamVjdCBob2xkaW5nIHRoZSBzZXJ2aWNlIGluc3RhbmNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHJldHVybiB7T2JqZWN0fVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZnVuY3Rpb24gZ2V0U2VydmljZUludGVybmFsKGhvbGRlciwgaWQpIHtcbiAgZGV2KCkuYXNzZXJ0KGlzU2VydmljZVJlZ2lzdGVyZWQoaG9sZGVyLCBpZCksXG4gICAgICBgRXhwZWN0ZWQgc2VydmljZSAke2lkfSB0byBiZSByZWdpc3RlcmVkYCk7XG4gIGNvbnN0IHNlcnZpY2VzID0gZ2V0U2VydmljZXMoaG9sZGVyKTtcbiAgY29uc3QgcyA9IHNlcnZpY2VzW2lkXTtcbiAgaWYgKCFzLm9iaikge1xuICAgIGRldigpLmFzc2VydChzLmN0b3IsIGBTZXJ2aWNlICR7aWR9IHJlZ2lzdGVyZWQgd2l0aG91dCBjdG9yIG5vciBpbXBsLmApO1xuICAgIGRldigpLmFzc2VydChzLmNvbnRleHQsIGBTZXJ2aWNlICR7aWR9IHJlZ2lzdGVyZWQgd2l0aG91dCBjb250ZXh0LmApO1xuICAgIHMub2JqID0gbmV3IHMuY3RvcihzLmNvbnRleHQpO1xuICAgIGRldigpLmFzc2VydChzLm9iaiwgYFNlcnZpY2UgJHtpZH0gY29uc3RydWN0ZWQgdG8gbnVsbC5gKTtcbiAgICBzLmN0b3IgPSBudWxsO1xuICAgIHMuY29udGV4dCA9IG51bGw7XG4gICAgLy8gVGhlIHNlcnZpY2UgbWF5IGhhdmUgYmVlbiByZXF1ZXN0ZWQgYWxyZWFkeSwgaW4gd2hpY2ggY2FzZSB3ZSBoYXZlIGFcbiAgICAvLyBwZW5kaW5nIHByb21pc2Ugd2UgbmVlZCB0byBmdWxmaWxsLlxuICAgIGlmIChzLnJlc29sdmUpIHtcbiAgICAgIHMucmVzb2x2ZShzLm9iaik7XG4gICAgfVxuICB9XG4gIHJldHVybiBzLm9iajtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFPYmplY3R9IGhvbGRlciBPYmplY3QgaG9sZGluZyB0aGUgc2VydmljZSBpbnN0YW5jZS5cbiAqIEBwYXJhbSB7IVdpbmRvd3whLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gY29udGV4dCBXaW4gb3IgQW1wRG9jLlxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHs/ZnVuY3Rpb24obmV3Ok9iamVjdCwgIVdpbmRvdyl8P2Z1bmN0aW9uKG5ldzpPYmplY3QsICEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jKX0gY3RvciBDb25zdHJ1Y3RvciBmdW5jdGlvbiB0byBuZXcgdGhlIHNlcnZpY2UuIENhbGxlZCB3aXRoIGNvbnRleHQuXG4gKi9cbmZ1bmN0aW9uIHJlZ2lzdGVyU2VydmljZUludGVybmFsKGhvbGRlciwgY29udGV4dCwgaWQsIGN0b3IpIHtcbiAgY29uc3Qgc2VydmljZXMgPSBnZXRTZXJ2aWNlcyhob2xkZXIpO1xuICBsZXQgcyA9IHNlcnZpY2VzW2lkXTtcblxuICBpZiAoIXMpIHtcbiAgICBzID0gc2VydmljZXNbaWRdID0ge1xuICAgICAgb2JqOiBudWxsLFxuICAgICAgcHJvbWlzZTogbnVsbCxcbiAgICAgIHJlc29sdmU6IG51bGwsXG4gICAgICBjb250ZXh0OiBudWxsLFxuICAgICAgY3RvcjogbnVsbCxcbiAgICB9O1xuICB9XG5cbiAgaWYgKHMuY3RvciB8fCBzLm9iaikge1xuICAgIC8vIFNlcnZpY2UgYWxyZWFkeSByZWdpc3RlcmVkLlxuICAgIHJldHVybjtcbiAgfVxuXG4gIHMuY3RvciA9IGN0b3I7XG4gIHMuY29udGV4dCA9IGNvbnRleHQ7XG5cbiAgLy8gVGhlIHNlcnZpY2UgbWF5IGhhdmUgYmVlbiByZXF1ZXN0ZWQgYWxyZWFkeSwgaW4gd2hpY2ggY2FzZSB0aGVyZSBpcyBhXG4gIC8vIHBlbmRpbmcgcHJvbWlzZSB0aGF0IG5lZWRzIHRvIGZ1bGZpbGxlZC5cbiAgaWYgKHMucmVzb2x2ZSkge1xuICAgIC8vIGdldFNlcnZpY2VJbnRlcm5hbCB3aWxsIHJlc29sdmUgdGhlIHByb21pc2UuXG4gICAgZ2V0U2VydmljZUludGVybmFsKGhvbGRlciwgaWQpO1xuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEByZXR1cm4geyFQcm9taXNlPCFPYmplY3Q+fVxuICovXG5mdW5jdGlvbiBnZXRTZXJ2aWNlUHJvbWlzZUludGVybmFsKGhvbGRlciwgaWQpIHtcbiAgY29uc3QgY2FjaGVkID0gZ2V0U2VydmljZVByb21pc2VPck51bGxJbnRlcm5hbChob2xkZXIsIGlkKTtcbiAgaWYgKGNhY2hlZCkge1xuICAgIHJldHVybiBjYWNoZWQ7XG4gIH1cbiAgLy8gU2VydmljZSBpcyBub3QgcmVnaXN0ZXJlZC5cblxuICAvLyBUT0RPKEBjcmFtZm9yY2UpOiBBZGQgYSBjaGVjayB0aGF0IGlmIHRoZSBlbGVtZW50IGlzIGV2ZW50dWFsbHkgcmVnaXN0ZXJlZFxuICAvLyB0aGF0IHRoZSBzZXJ2aWNlIGlzIGFjdHVhbGx5IHByb3ZpZGVkIGFuZCB0aGlzIHByb21pc2UgcmVzb2x2ZXMuXG4gIGNvbnN0IGRlZmVycmVkID0gbmV3IERlZmVycmVkKCk7XG4gIGNvbnN0IHtwcm9taXNlLCByZXNvbHZlfSA9IGRlZmVycmVkO1xuXG4gIGNvbnN0IHNlcnZpY2VzID0gZ2V0U2VydmljZXMoaG9sZGVyKTtcbiAgc2VydmljZXNbaWRdID0ge1xuICAgIG9iajogbnVsbCxcbiAgICBwcm9taXNlLFxuICAgIHJlc29sdmUsXG4gICAgY29udGV4dDogbnVsbCxcbiAgICBjdG9yOiBudWxsLFxuICB9O1xuICByZXR1cm4gcHJvbWlzZTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIGZvciBzZXJ2aWNlIGBpZGAgaWYgdGhlIHNlcnZpY2UgaGFzIGJlZW4gcmVnaXN0ZXJlZFxuICogb24gYGhvbGRlcmAuXG4gKiBAcGFyYW0geyFPYmplY3R9IGhvbGRlclxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHJldHVybiB7P1Byb21pc2U8IU9iamVjdD59XG4gKi9cbmZ1bmN0aW9uIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsSW50ZXJuYWwoaG9sZGVyLCBpZCkge1xuICBjb25zdCBzZXJ2aWNlcyA9IGdldFNlcnZpY2VzKGhvbGRlcik7XG4gIGNvbnN0IHMgPSBzZXJ2aWNlc1tpZF07XG4gIGlmIChzKSB7XG4gICAgaWYgKHMucHJvbWlzZSkge1xuICAgICAgcmV0dXJuIHMucHJvbWlzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSW5zdGFudGlhdGUgc2VydmljZSBpZiBub3QgYWxyZWFkeSBpbnN0YW50aWF0ZWQuXG4gICAgICBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCk7XG4gICAgICByZXR1cm4gcy5wcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKC8qKiBAdHlwZSB7IU9iamVjdH0gKi8gKHMub2JqKSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyB0aGUgb2JqZWN0IHRoYXQgaG9sZHMgdGhlIHNlcnZpY2VzIHJlZ2lzdGVyZWQgaW4gYSBob2xkZXIuXG4gKiBAcGFyYW0geyFPYmplY3R9IGhvbGRlclxuICogQHJldHVybiB7IU9iamVjdDxzdHJpbmcsIVNlcnZpY2VIb2xkZXJEZWY+fVxuICovXG5mdW5jdGlvbiBnZXRTZXJ2aWNlcyhob2xkZXIpIHtcbiAgbGV0IHtzZXJ2aWNlc30gPSBob2xkZXI7XG4gIGlmICghc2VydmljZXMpIHtcbiAgICBzZXJ2aWNlcyA9IGhvbGRlci5zZXJ2aWNlcyA9IHt9O1xuICB9XG4gIHJldHVybiBzZXJ2aWNlcztcbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHNwZWNpZmllZCBzZXJ2aWNlIGltcGxlbWVudHMgYERpc3Bvc2FibGVgIGludGVyZmFjZS5cbiAqIEBwYXJhbSB7IU9iamVjdH0gc2VydmljZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRGlzcG9zYWJsZShzZXJ2aWNlKSB7XG4gIHJldHVybiB0eXBlb2Ygc2VydmljZS5kaXNwb3NlID09ICdmdW5jdGlvbic7XG59XG5cblxuLyoqXG4gKiBBc3NlcnRzIHRoYXQgdGhlIHNwZWNpZmllZCBzZXJ2aWNlIGltcGxlbWVudHMgYERpc3Bvc2FibGVgIGludGVyZmFjZSBhbmRcbiAqIHR5cGVjYXN0cyB0aGUgaW5zdGFuY2UgdG8gYERpc3Bvc2FibGVgLlxuICogQHBhcmFtIHshT2JqZWN0fSBzZXJ2aWNlXG4gKiBAcmV0dXJuIHshRGlzcG9zYWJsZX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydERpc3Bvc2FibGUoc2VydmljZSkge1xuICBkZXYoKS5hc3NlcnQoaXNEaXNwb3NhYmxlKHNlcnZpY2UpLCAncmVxdWlyZWQgdG8gaW1wbGVtZW50IERpc3Bvc2FibGUnKTtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IURpc3Bvc2FibGV9ICovIChzZXJ2aWNlKTtcbn1cblxuXG4vKipcbiAqIERpc3Bvc2VzIGFsbCBkaXNwb3NhYmxlIChpbXBsZW1lbnRzIGBEaXNwb3NhYmxlYCBpbnRlcmZhY2UpIHNlcnZpY2VzIGluXG4gKiBhbXBkb2Mgc2NvcGUuXG4gKiBAcGFyYW0geyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpc3Bvc2VTZXJ2aWNlc0ZvckRvYyhhbXBkb2MpIHtcbiAgZGlzcG9zZVNlcnZpY2VzSW50ZXJuYWwoYW1wZG9jKTtcbn1cblxuXG4vKipcbiAqIERpc3Bvc2VzIGFsbCBkaXNwb3NhYmxlIChpbXBsZW1lbnRzIGBEaXNwb3NhYmxlYCBpbnRlcmZhY2UpIHNlcnZpY2VzIGluXG4gKiBlbWJlZCBzY29wZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gZW1iZWRXaW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpc3Bvc2VTZXJ2aWNlc0ZvckVtYmVkKGVtYmVkV2luKSB7XG4gIGRpc3Bvc2VTZXJ2aWNlc0ludGVybmFsKGVtYmVkV2luKTtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyIE9iamVjdCBob2xkaW5nIHRoZSBzZXJ2aWNlIGluc3RhbmNlcy5cbiAqL1xuZnVuY3Rpb24gZGlzcG9zZVNlcnZpY2VzSW50ZXJuYWwoaG9sZGVyKSB7XG4gIC8vIFRPRE8oZHZveXRlbmtvKTogQ29uc2lkZXIgbWFya2luZyBob2xkZXIgYXMgZGVzdHJveWVkIGZvciBsYXRlci1hcnJpdmluZ1xuICAvLyBzZXJ2aWNlIHRvIGJlIGNhbmNlbGVkIGF1dG9tYXRpY2FsbHkuXG4gIGNvbnN0IHNlcnZpY2VzID0gZ2V0U2VydmljZXMoaG9sZGVyKTtcbiAgZm9yIChjb25zdCBpZCBpbiBzZXJ2aWNlcykge1xuICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNlcnZpY2VzLCBpZCkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBjb25zdCBzZXJ2aWNlSG9sZGVyID0gc2VydmljZXNbaWRdO1xuICAgIGlmIChzZXJ2aWNlSG9sZGVyLm9iaikge1xuICAgICAgZGlzcG9zZVNlcnZpY2VJbnRlcm5hbChpZCwgc2VydmljZUhvbGRlci5vYmopO1xuICAgIH0gZWxzZSBpZiAoc2VydmljZUhvbGRlci5wcm9taXNlKSB7XG4gICAgICBzZXJ2aWNlSG9sZGVyLnByb21pc2UudGhlbihcbiAgICAgICAgICBpbnN0YW5jZSA9PiBkaXNwb3NlU2VydmljZUludGVybmFsKGlkLCBpbnN0YW5jZSkpO1xuICAgIH1cbiAgfVxufVxuXG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcGFyYW0geyFPYmplY3R9IHNlcnZpY2VcbiAqL1xuZnVuY3Rpb24gZGlzcG9zZVNlcnZpY2VJbnRlcm5hbChpZCwgc2VydmljZSkge1xuICBpZiAoIWlzRGlzcG9zYWJsZShzZXJ2aWNlKSkge1xuICAgIHJldHVybjtcbiAgfVxuICB0cnkge1xuICAgIGFzc2VydERpc3Bvc2FibGUoc2VydmljZSkuZGlzcG9zZSgpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gRW5zdXJlIHRoYXQgYSBmYWlsdXJlIHRvIGRpc3Bvc2UgYSBzZXJ2aWNlIGRvZXMgbm90IGRpc3J1cHQgb3RoZXJcbiAgICAvLyBzZXJ2aWNlcy5cbiAgICBkZXYoKS5lcnJvcignU0VSVklDRScsICdmYWlsZWQgdG8gZGlzcG9zZSBzZXJ2aWNlJywgaWQsIGUpO1xuICB9XG59XG5cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBzcGVjaWZpZWQgc2VydmljZSBpbXBsZW1lbnRzIGBFbWJlZGRhYmxlU2VydmljZWAgaW50ZXJmYWNlLlxuICogQHBhcmFtIHshT2JqZWN0fSBzZXJ2aWNlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNFbWJlZGRhYmxlKHNlcnZpY2UpIHtcbiAgcmV0dXJuIHR5cGVvZiBzZXJ2aWNlLmFkb3B0RW1iZWRXaW5kb3cgPT0gJ2Z1bmN0aW9uJztcbn1cblxuXG4vKipcbiAqIEFkb3B0cyBhbiBlbWJlZGRhYmxlIChpbXBsZW1lbnRzIGBFbWJlZGRhYmxlU2VydmljZWAgaW50ZXJmYWNlKSBzZXJ2aWNlXG4gKiBpbiBlbWJlZCBzY29wZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gZW1iZWRXaW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlSWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkb3B0U2VydmljZUZvckVtYmVkKGVtYmVkV2luLCBzZXJ2aWNlSWQpIHtcbiAgY29uc3QgYWRvcHRlZCA9IGFkb3B0U2VydmljZUZvckVtYmVkSWZFbWJlZGRhYmxlKGVtYmVkV2luLCBzZXJ2aWNlSWQpO1xuICBkZXYoKS5hc3NlcnQoYWRvcHRlZCwgYFNlcnZpY2UgJHtzZXJ2aWNlSWR9IG5vdCBmb3VuZCBvbiBwYXJlbnQgYCArXG4gICAgICAnb3IgZG9lc25cXCd0IGltcGxlbWVudCBFbWJlZGRhYmxlU2VydmljZS4nKTtcbn1cblxuXG4vKipcbiAqIEFkb3B0cyBhbiBlbWJlZGRhYmxlIChpbXBsZW1lbnRzIGBFbWJlZGRhYmxlU2VydmljZWAgaW50ZXJmYWNlKSBzZXJ2aWNlXG4gKiBpbiBlbWJlZCBzY29wZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gZW1iZWRXaW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlSWRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZG9wdFNlcnZpY2VGb3JFbWJlZElmRW1iZWRkYWJsZShlbWJlZFdpbiwgc2VydmljZUlkKSB7XG4gIGNvbnN0IGZyYW1lRWxlbWVudCA9IC8qKiBAdHlwZSB7IU5vZGV9ICovIChkZXYoKS5hc3NlcnQoXG4gICAgICBlbWJlZFdpbi5mcmFtZUVsZW1lbnQsXG4gICAgICAnZnJhbWVFbGVtZW50IG5vdCBmb3VuZCBmb3IgZW1iZWQnKSk7XG4gIGNvbnN0IGFtcGRvYyA9IGdldEFtcGRvYyhmcmFtZUVsZW1lbnQpO1xuICBjb25zdCBob2xkZXIgPSBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGFtcGRvYyk7XG4gIGlmICghaXNTZXJ2aWNlUmVnaXN0ZXJlZChob2xkZXIsIHNlcnZpY2VJZCkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgY29uc3Qgc2VydmljZSA9IGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKGZyYW1lRWxlbWVudCwgc2VydmljZUlkKTtcbiAgaWYgKCFpc0VtYmVkZGFibGUoc2VydmljZSkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgc2VydmljZS5hZG9wdEVtYmVkV2luZG93KGVtYmVkV2luKTtcbiAgcmV0dXJuIHRydWU7XG59XG5cblxuLyoqXG4gKiBSZXNldHMgYSBzaW5nbGUgc2VydmljZSwgc28gaXQgZ2V0cyByZWNyZWF0ZWQgb24gbmV4dCBnZXRTZXJ2aWNlIGludm9jYXRpb24uXG4gKiBAcGFyYW0geyFPYmplY3R9IGhvbGRlclxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRTZXJ2aWNlRm9yVGVzdGluZyhob2xkZXIsIGlkKSB7XG4gIGlmIChob2xkZXIuc2VydmljZXMpIHtcbiAgICBob2xkZXIuc2VydmljZXNbaWRdID0gbnVsbDtcbiAgfVxufVxuXG4vKipcbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyIE9iamVjdCBob2xkaW5nIHRoZSBzZXJ2aWNlIGluc3RhbmNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNTZXJ2aWNlUmVnaXN0ZXJlZChob2xkZXIsIGlkKSB7XG4gIGNvbnN0IHNlcnZpY2UgPSBob2xkZXIuc2VydmljZXMgJiYgaG9sZGVyLnNlcnZpY2VzW2lkXTtcbiAgLy8gQWxsIHJlZ2lzdGVyZWQgc2VydmljZXMgbXVzdCBoYXZlIGFuIGltcGxlbWVudGF0aW9uIG9yIGEgY29uc3RydWN0b3IuXG4gIHJldHVybiAhIShzZXJ2aWNlICYmIChzZXJ2aWNlLmN0b3IgfHwgc2VydmljZS5vYmopKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuLi9zZXJ2aWNlcyc7XG5pbXBvcnQge1xuICBjbG9zZXN0QnlUYWcsXG4gIGVzY2FwZUNzc1NlbGVjdG9ySWRlbnQsXG4gIGlzSWZyYW1lZCxcbiAgb3BlbldpbmRvd0RpYWxvZyxcbn0gZnJvbSAnLi4vZG9tJztcbmltcG9ydCB7ZGV2LCB1c2VyfSBmcm9tICcuLi9sb2cnO1xuaW1wb3J0IHtcbiAgZ2V0RXh0cmFQYXJhbXNVcmwsXG4gIHNob3VsZEFwcGVuZEV4dHJhUGFyYW1zLFxufSBmcm9tICcuLi9pbXByZXNzaW9uJztcbmltcG9ydCB7Z2V0TW9kZX0gZnJvbSAnLi4vbW9kZSc7XG5pbXBvcnQge1xuICBpbnN0YWxsU2VydmljZUluRW1iZWRTY29wZSxcbiAgcmVnaXN0ZXJTZXJ2aWNlQnVpbGRlckZvckRvYyxcbn0gZnJvbSAnLi4vc2VydmljZSc7XG5pbXBvcnQge3RvV2lufSBmcm9tICcuLi90eXBlcyc7XG5cbmNvbnN0IFRBRyA9ICduYXZpZ2F0aW9uJztcbi8qKiBAcHJpdmF0ZSBAY29uc3Qge3N0cmluZ30gKi9cbmNvbnN0IEVWRU5UX1RZUEVfQ0xJQ0sgPSAnY2xpY2snO1xuLyoqIEBwcml2YXRlIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgRVZFTlRfVFlQRV9DT05URVhUX01FTlUgPSAnY29udGV4dG1lbnUnO1xuXG4vKiogQHByaXZhdGUgQGNvbnN0IHtzdHJpbmd9ICovXG5jb25zdCBPUklHX0hSRUZfQVRUUklCVVRFID0gJ2RhdGEtYTRhLW9yaWctaHJlZic7XG5cbi8qKlxuICogSW5zdGFsbCBuYXZpZ2F0aW9uIHNlcnZpY2UgZm9yIGFtcGRvYywgd2hpY2ggaGFuZGxlcyBuYXZpZ2F0aW9ucyBmcm9tIGFuY2hvclxuICogdGFnIGNsaWNrcyBhbmQgb3RoZXIgcnVudGltZSBmZWF0dXJlcyBsaWtlIEFNUC5uYXZpZ2F0ZVRvKCkuXG4gKlxuICogSW1tZWRpYXRlbHkgaW5zdGFudGlhdGVzIHRoZSBzZXJ2aWNlLlxuICpcbiAqIEBwYXJhbSB7IS4vYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGxHbG9iYWxOYXZpZ2F0aW9uSGFuZGxlckZvckRvYyhhbXBkb2MpIHtcbiAgcmVnaXN0ZXJTZXJ2aWNlQnVpbGRlckZvckRvYyhcbiAgICAgIGFtcGRvYyxcbiAgICAgIFRBRyxcbiAgICAgIE5hdmlnYXRpb24sXG4gICAgICAvKiBvcHRfaW5zdGFudGlhdGUgKi8gdHJ1ZSk7XG59XG5cbi8qKlxuICogQHBhcmFtIHshLi9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICogQHBhcmFtIHshRXZlbnR9IGVcbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gbWF5YmVFeHBhbmRVcmxQYXJhbXNGb3JUZXN0aW5nKGFtcGRvYywgZSkge1xuICBtYXliZUV4cGFuZFVybFBhcmFtcyhhbXBkb2MsIGUpO1xufVxuXG4vKipcbiAqIEludGVyY2VwdCBhbnkgY2xpY2sgb24gdGhlIGN1cnJlbnQgZG9jdW1lbnQgYW5kIHByZXZlbnQgYW55XG4gKiBsaW5raW5nIHRvIGFuIGlkZW50aWZpZXIgZnJvbSBwdXNoaW5nIGludG8gdGhlIGhpc3Rvcnkgc3RhY2suXG4gKiBAaW1wbGVtZW50cyB7Li4vc2VydmljZS5FbWJlZGRhYmxlU2VydmljZX1cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgY2xhc3MgTmF2aWdhdGlvbiB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyEuL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gICAqIEBwYXJhbSB7KCFEb2N1bWVudHwhU2hhZG93Um9vdCk9fSBvcHRfcm9vdE5vZGVcbiAgICovXG4gIGNvbnN0cnVjdG9yKGFtcGRvYywgb3B0X3Jvb3ROb2RlKSB7XG4gICAgLyoqIEBjb25zdCB7IS4vYW1wZG9jLWltcGwuQW1wRG9jfSAqL1xuICAgIHRoaXMuYW1wZG9jID0gYW1wZG9jO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IURvY3VtZW50fCFTaGFkb3dSb290fSAqL1xuICAgIHRoaXMucm9vdE5vZGVfID0gb3B0X3Jvb3ROb2RlIHx8IGFtcGRvYy5nZXRSb290Tm9kZSgpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IS4vdmlld3BvcnQvdmlld3BvcnQtaW1wbC5WaWV3cG9ydH0gKi9cbiAgICB0aGlzLnZpZXdwb3J0XyA9IFNlcnZpY2VzLnZpZXdwb3J0Rm9yRG9jKHRoaXMuYW1wZG9jKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyEuL3ZpZXdlci1pbXBsLlZpZXdlcn0gKi9cbiAgICB0aGlzLnZpZXdlcl8gPSBTZXJ2aWNlcy52aWV3ZXJGb3JEb2ModGhpcy5hbXBkb2MpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IS4vaGlzdG9yeS1pbXBsLkhpc3Rvcnl9ICovXG4gICAgdGhpcy5oaXN0b3J5XyA9IFNlcnZpY2VzLmhpc3RvcnlGb3JEb2ModGhpcy5hbXBkb2MpO1xuXG4gICAgY29uc3QgcGxhdGZvcm0gPSBTZXJ2aWNlcy5wbGF0Zm9ybUZvcih0aGlzLmFtcGRvYy53aW4pO1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge2Jvb2xlYW59ICovXG4gICAgdGhpcy5pc0lvc1NhZmFyaV8gPSBwbGF0Zm9ybS5pc0lvcygpICYmIHBsYXRmb3JtLmlzU2FmYXJpKCk7XG5cbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtib29sZWFufSAqL1xuICAgIHRoaXMuaXNJZnJhbWVkXyA9XG4gICAgICAgIGlzSWZyYW1lZCh0aGlzLmFtcGRvYy53aW4pICYmIHRoaXMudmlld2VyXy5pc092ZXJ0YWtlSGlzdG9yeSgpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7Ym9vbGVhbn0gKi9cbiAgICB0aGlzLmlzRW1iZWRfID0gdGhpcy5yb290Tm9kZV8gIT0gdGhpcy5hbXBkb2MuZ2V0Um9vdE5vZGUoKTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge2Jvb2xlYW59ICovXG4gICAgdGhpcy5pc0luQUJveF8gPSBnZXRNb2RlKHRoaXMuYW1wZG9jLndpbikucnVudGltZSA9PSAnaW5hYm94JztcblxuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IWZ1bmN0aW9uKCFFdmVudCl8dW5kZWZpbmVkfSAqL1xuICAgIHRoaXMuYm91bmRIYW5kbGVfID0gdGhpcy5oYW5kbGVfLmJpbmQodGhpcyk7XG4gICAgdGhpcy5yb290Tm9kZV8uYWRkRXZlbnRMaXN0ZW5lcihFVkVOVF9UWVBFX0NMSUNLLCB0aGlzLmJvdW5kSGFuZGxlXyk7XG4gICAgdGhpcy5yb290Tm9kZV8uYWRkRXZlbnRMaXN0ZW5lcihFVkVOVF9UWVBFX0NPTlRFWFRfTUVOVSwgdGhpcy5ib3VuZEhhbmRsZV8pO1xuICAgIC8qKiBAcHJpdmF0ZSB7Ym9vbGVhbn0gKi9cbiAgICB0aGlzLmFwcGVuZEV4dHJhUGFyYW1zXyA9IGZhbHNlO1xuICAgIHNob3VsZEFwcGVuZEV4dHJhUGFyYW1zKHRoaXMuYW1wZG9jKS50aGVuKHJlcyA9PiB7XG4gICAgICB0aGlzLmFwcGVuZEV4dHJhUGFyYW1zXyA9IHJlcztcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIExhenktZ2VuZXJhdGVkIGxpc3Qgb2YgQTJBLWVuYWJsZWQgbmF2aWdhdGlvbiBmZWF0dXJlcy5cbiAgICAgKiBAcHJpdmF0ZSB7P0FycmF5PHN0cmluZz59XG4gICAgICovXG4gICAgdGhpcy5hMmFGZWF0dXJlc18gPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVycyBhIGhhbmRsZXIgdGhhdCBwZXJmb3JtcyBVUkwgcmVwbGFjZW1lbnQgb24gdGhlIGhyZWZcbiAgICogb2YgYW4gYWQgY2xpY2suXG4gICAqIEBwYXJhbSB7IS4vYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICovXG4gIHN0YXRpYyBpbnN0YWxsQW5jaG9yQ2xpY2tJbnRlcmNlcHRvcihhbXBkb2MsIHdpbikge1xuICAgIHdpbi5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLFxuICAgICAgICBtYXliZUV4cGFuZFVybFBhcmFtcy5iaW5kKG51bGwsIGFtcGRvYyksIC8qIGNhcHR1cmUgKi8gdHJ1ZSk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGFkb3B0RW1iZWRXaW5kb3coZW1iZWRXaW4pIHtcbiAgICBpbnN0YWxsU2VydmljZUluRW1iZWRTY29wZShlbWJlZFdpbiwgVEFHLFxuICAgICAgICBuZXcgTmF2aWdhdGlvbih0aGlzLmFtcGRvYywgZW1iZWRXaW4uZG9jdW1lbnQpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmVzIGFsbCBldmVudCBsaXN0ZW5lcnMuXG4gICAqL1xuICBjbGVhbnVwKCkge1xuICAgIGlmICh0aGlzLmJvdW5kSGFuZGxlXykge1xuICAgICAgdGhpcy5yb290Tm9kZV8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihFVkVOVF9UWVBFX0NMSUNLLCB0aGlzLmJvdW5kSGFuZGxlXyk7XG4gICAgICB0aGlzLnJvb3ROb2RlXy5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgICAgIEVWRU5UX1RZUEVfQ09OVEVYVF9NRU5VLCB0aGlzLmJvdW5kSGFuZGxlXyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE5hdmlnYXRlcyBhIHdpbmRvdyB0byBhIFVSTC5cbiAgICpcbiAgICogSWYgb3B0X3JlcXVlc3RlZEJ5IG1hdGNoZXMgYSBmZWF0dXJlIG5hbWUgaW4gYSA8bWV0YT4gdGFnIHdpdGggYXR0cmlidXRlXG4gICAqIG5hbWU9XCJhbXAtdG8tYW1wLW5hdmlnYXRpb25cIiwgdGhlbiB0cmVhdHMgdGhlIFVSTCBhcyBhbiBBTVAgVVJMIChBMkEpLlxuICAgKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X3JlcXVlc3RlZEJ5XG4gICAqL1xuICBuYXZpZ2F0ZVRvKHdpbiwgdXJsLCBvcHRfcmVxdWVzdGVkQnkpIHtcbiAgICBjb25zdCB1cmxTZXJ2aWNlID0gU2VydmljZXMudXJsRm9yRG9jKHRoaXMuYW1wZG9jKTtcbiAgICBpZiAoIXVybFNlcnZpY2UuaXNQcm90b2NvbFZhbGlkKHVybCkpIHtcbiAgICAgIHVzZXIoKS5lcnJvcihUQUcsICdDYW5ub3QgbmF2aWdhdGUgdG8gaW52YWxpZCBwcm90b2NvbDogJyArIHVybCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gSWYgdGhpcyByZWRpcmVjdCB3YXMgcmVxdWVzdGVkIGJ5IGEgZmVhdHVyZSB0aGF0IG9wdGVkIGludG8gQTJBLFxuICAgIC8vIHRyeSB0byBhc2sgdGhlIHZpZXdlciB0byBuYXZpZ2F0ZSB0aGlzIEFNUCBVUkwuXG4gICAgaWYgKG9wdF9yZXF1ZXN0ZWRCeSkge1xuICAgICAgaWYgKCF0aGlzLmEyYUZlYXR1cmVzXykge1xuICAgICAgICB0aGlzLmEyYUZlYXR1cmVzXyA9IHRoaXMucXVlcnlBMkFGZWF0dXJlc18oKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLmEyYUZlYXR1cmVzXy5pbmNsdWRlcyhvcHRfcmVxdWVzdGVkQnkpKSB7XG4gICAgICAgIGlmICh0aGlzLnZpZXdlcl8ubmF2aWdhdGVUb0FtcFVybCh1cmwsIG9wdF9yZXF1ZXN0ZWRCeSkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBPdGhlcndpc2UsIHBlcmZvcm0gbm9ybWFsIGJlaGF2aW9yIG9mIG5hdmlnYXRpbmcgdGhlIHRvcCBmcmFtZS5cbiAgICB3aW4udG9wLmxvY2F0aW9uLmhyZWYgPSB1cmw7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IUFycmF5PHN0cmluZz59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBxdWVyeUEyQUZlYXR1cmVzXygpIHtcbiAgICBjb25zdCBtZXRhID0gdGhpcy5yb290Tm9kZV8ucXVlcnlTZWxlY3RvcihcbiAgICAgICAgJ21ldGFbbmFtZT1cImFtcC10by1hbXAtbmF2aWdhdGlvblwiXScpO1xuICAgIGlmIChtZXRhICYmIG1ldGEuaGFzQXR0cmlidXRlKCdjb250ZW50JykpIHtcbiAgICAgIHJldHVybiBtZXRhLmdldEF0dHJpYnV0ZSgnY29udGVudCcpLnNwbGl0KCcsJykubWFwKHMgPT4gcy50cmltKCkpO1xuICAgIH1cbiAgICByZXR1cm4gW107XG4gIH1cblxuICAvKipcbiAgICogSW50ZXJjZXB0IGFueSBjbGljayBvbiB0aGUgY3VycmVudCBkb2N1bWVudCBhbmQgcHJldmVudCBhbnlcbiAgICogbGlua2luZyB0byBhbiBpZGVudGlmaWVyIGZyb20gcHVzaGluZyBpbnRvIHRoZSBoaXN0b3J5IHN0YWNrLlxuICAgKlxuICAgKiBUaGlzIGFsc28gaGFuZGxlcyBjdXN0b20gcHJvdG9jb2xzIChlLmcuIHdoYXRzYXBwOi8vKSB3aGVuIGlmcmFtZWRcbiAgICogb24gaU9TIFNhZmFyaS5cbiAgICpcbiAgICogQHBhcmFtIHshRXZlbnR9IGVcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGhhbmRsZV8oZSkge1xuICAgIGlmIChlLmRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgdGFyZ2V0ID0gY2xvc2VzdEJ5VGFnKGRldigpLmFzc2VydEVsZW1lbnQoZS50YXJnZXQpLCAnQScpO1xuICAgIGlmICghdGFyZ2V0IHx8ICF0YXJnZXQuaHJlZikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZS50eXBlID09IEVWRU5UX1RZUEVfQ0xJQ0spIHtcbiAgICAgIHRoaXMuaGFuZGxlQ2xpY2tfKHRhcmdldCwgZSk7XG4gICAgfSBlbHNlIGlmIChlLnR5cGUgPT0gRVZFTlRfVFlQRV9DT05URVhUX01FTlUpIHtcbiAgICAgIC8vIEhhbmRsZXMgY29udGV4dG1lbnUgY2xpY2suIE5vdGUgdGhhdCBjdXJyZW50bHkgdGhpcyBvbmx5IGRlYWxzXG4gICAgICAvLyB3aXRoIHVybCB2YXJpYWJsZSBzdWJzdGl0dXRpb24gYW5kIGV4cGFuc2lvbiwgYXMgdGhlcmUgaXNcbiAgICAgIC8vIHN0cmFpZ2h0Zm9yd2FyZCB3YXkgb2YgZGV0ZXJtaW5pbmcgd2hhdCB0aGUgdXNlciBjbGlja2VkIGluIHRoZVxuICAgICAgLy8gY29udGV4dCBtZW51LCByZXF1aXJlZCBmb3IgQTJBIG5hdmlnYXRpb24gYW5kIGN1c3RvbSBsaW5rIHByb3RvY29sXG4gICAgICAvLyBoYW5kbGluZy5cbiAgICAgIC8vIFRPRE8oYWxhYmlhZ2EpOiBpbnZlc3RpZ2F0ZSBmaXggZm9yIGhhbmRsaW5nIEEyQSBhbmQgY3VzdG9tIGxpbmtcbiAgICAgIC8vIHByb3RvY29scy5cbiAgICAgIHRoaXMuZXhwYW5kVmFyc0ZvckFuY2hvcl8odGFyZ2V0KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudH0gdGFyZ2V0XG4gICAqIEBwYXJhbSB7IUV2ZW50fSBlXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBoYW5kbGVDbGlja18odGFyZ2V0LCBlKSB7XG4gICAgdGhpcy5leHBhbmRWYXJzRm9yQW5jaG9yXyh0YXJnZXQpO1xuXG4gICAgY29uc3QgbG9jYXRpb24gPSB0aGlzLnBhcnNlVXJsXyh0YXJnZXQuaHJlZik7XG5cbiAgICAvLyBIYW5kbGUgQU1QLXRvLUFNUCBuYXZpZ2F0aW9uIGlmIHJlbD1hbXBodG1sLlxuICAgIGlmICh0aGlzLmhhbmRsZUEyQUNsaWNrXyhlLCB0YXJnZXQsIGxvY2F0aW9uKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEhhbmRsZSBuYXZpZ2F0aW5nIHRvIGN1c3RvbSBwcm90b2NvbCBpZiBhcHBsaWNhYmxlLlxuICAgIGlmICh0aGlzLmhhbmRsZUN1c3RvbVByb3RvY29sQ2xpY2tfKGUsIHRhcmdldCwgbG9jYXRpb24pKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gRmluYWxseSwgaGFuZGxlIG5vcm1hbCBjbGljay1uYXZpZ2F0aW9uIGJlaGF2aW9yLlxuICAgIHRoaXMuaGFuZGxlTmF2Q2xpY2tfKGUsIHRhcmdldCwgbG9jYXRpb24pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBleHBhbmRWYXJzRm9yQW5jaG9yXyhlbCkge1xuICAgIC8vIEZpcnN0IGNoZWNrIGlmIG5lZWQgdG8gaGFuZGxlIGV4dGVybmFsIGxpbmsgZGVjb3JhdGlvbi5cbiAgICBsZXQgZGVmYXVsdEV4cGFuZFBhcmFtc1VybCA9IG51bGw7XG4gICAgaWYgKHRoaXMuYXBwZW5kRXh0cmFQYXJhbXNfICYmICF0aGlzLmlzRW1iZWRfKSB7XG4gICAgICAvLyBPbmx5IGRlY29yYXRlIG91dGdvaW5nIGxpbmsgd2hlbiBuZWVkZWQgdG8gYW5kIGlzIG5vdCBpbiBGSUUuXG4gICAgICBkZWZhdWx0RXhwYW5kUGFyYW1zVXJsID0gZ2V0RXh0cmFQYXJhbXNVcmwodGhpcy5hbXBkb2Mud2luLCBlbCk7XG4gICAgfVxuXG4gICAgY29uc3QgdXJsUmVwbGFjZW1lbnRzID0gU2VydmljZXMudXJsUmVwbGFjZW1lbnRzRm9yRG9jKGVsKTtcbiAgICB1cmxSZXBsYWNlbWVudHMubWF5YmVFeHBhbmRMaW5rKGVsLCBkZWZhdWx0RXhwYW5kUGFyYW1zVXJsKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIGNsaWNraW5nIG9uIGEgY3VzdG9tIHByb3RvY29sIGxpbmsuXG4gICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgbmF2aWdhdGlvbiB3YXMgaGFuZGxlZC4gT3RoZXJ3aXNlLCByZXR1cm5zIGZhbHNlLlxuICAgKiBAcGFyYW0geyFFdmVudH0gZVxuICAgKiBAcGFyYW0geyFFbGVtZW50fSB0YXJnZXRcbiAgICogQHBhcmFtIHshTG9jYXRpb259IGxvY2F0aW9uXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBoYW5kbGVDdXN0b21Qcm90b2NvbENsaWNrXyhlLCB0YXJnZXQsIGxvY2F0aW9uKSB7XG4gICAgLy8gSGFuZGxlIGN1c3RvbSBwcm90b2NvbHMgb25seSBpZiB0aGUgZG9jdW1lbnQgaXMgaWZyYW1lZC5cbiAgICBpZiAoIXRoaXMuaXNJZnJhbWVkXykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qKiBAY29uc3QgeyFXaW5kb3d9ICovXG4gICAgY29uc3Qgd2luID0gdG9XaW4odGFyZ2V0Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcpO1xuICAgIGNvbnN0IHVybCA9IHRhcmdldC5ocmVmO1xuICAgIGNvbnN0IHtwcm90b2NvbH0gPSBsb2NhdGlvbjtcblxuICAgIC8vIE9uIFNhZmFyaSBpT1MsIGN1c3RvbSBwcm90b2NvbCBsaW5rcyB3aWxsIGZhaWwgdG8gb3BlbiBhcHBzIHdoZW4gdGhlXG4gICAgLy8gZG9jdW1lbnQgaXMgaWZyYW1lZCAtIGluIG9yZGVyIHRvIGdvIGFyb3VuZCB0aGlzLCB3ZSBzZXQgdGhlIHRvcC5sb2NhdGlvblxuICAgIC8vIHRvIHRoZSBjdXN0b20gcHJvdG9jb2wgaHJlZi5cbiAgICBjb25zdCBpc0ZUUCA9IHByb3RvY29sID09ICdmdHA6JztcblxuICAgIC8vIEluIGNhc2Ugb2YgRlRQIExpbmtzIGluIGVtYmVkZGVkIGRvY3VtZW50cyBhbHdheXMgb3BlbiB0aGVuIGluIF9ibGFuay5cbiAgICBpZiAoaXNGVFApIHtcbiAgICAgIG9wZW5XaW5kb3dEaWFsb2cod2luLCB1cmwsICdfYmxhbmsnKTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGNvbnN0IGlzTm9ybWFsUHJvdG9jb2wgPSAvXihodHRwcz98bWFpbHRvKTokLy50ZXN0KHByb3RvY29sKTtcbiAgICBpZiAodGhpcy5pc0lvc1NhZmFyaV8gJiYgIWlzTm9ybWFsUHJvdG9jb2wpIHtcbiAgICAgIG9wZW5XaW5kb3dEaWFsb2cod2luLCB1cmwsICdfdG9wJyk7XG4gICAgICAvLyBXaXRob3V0IHByZXZlbnRpbmcgZGVmYXVsdCB0aGUgcGFnZSB3b3VsZCBzaG91bGQgYW4gYWxlcnQgZXJyb3IgdHdpY2VcbiAgICAgIC8vIGluIHRoZSBjYXNlIHdoZXJlIHRoZXJlJ3Mgbm8gYXBwIHRvIGhhbmRsZSB0aGUgY3VzdG9tIHByb3RvY29sLlxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgY2xpY2tpbmcgb24gYW4gQU1QIGxpbmsuXG4gICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgbmF2aWdhdGlvbiB3YXMgaGFuZGxlZC4gT3RoZXJ3aXNlLCByZXR1cm5zIGZhbHNlLlxuICAgKiBAcGFyYW0geyFFdmVudH0gZVxuICAgKiBAcGFyYW0geyFFbGVtZW50fSB0YXJnZXRcbiAgICogQHBhcmFtIHshTG9jYXRpb259IGxvY2F0aW9uXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBoYW5kbGVBMkFDbGlja18oZSwgdGFyZ2V0LCBsb2NhdGlvbikge1xuICAgIGlmICghdGFyZ2V0Lmhhc0F0dHJpYnV0ZSgncmVsJykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY29uc3QgcmVsYXRpb25zID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgncmVsJykuc3BsaXQoJyAnKS5tYXAocyA9PiBzLnRyaW0oKSk7XG4gICAgaWYgKCFyZWxhdGlvbnMuaW5jbHVkZXMoJ2FtcGh0bWwnKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyBUaGUgdmlld2VyIG1heSBub3Qgc3VwcG9ydCB0aGUgY2FwYWJpbGl0eSBmb3IgbmF2aWdhdGluZyBBTVAgbGlua3MuXG4gICAgaWYgKHRoaXMudmlld2VyXy5uYXZpZ2F0ZVRvQW1wVXJsKGxvY2F0aW9uLmhyZWYsICc8YSByZWw9YW1waHRtbD4nKSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgY2xpY2tpbmcgb24gYSBsaW5rIHdpdGggaGFzaCBuYXZpZ2F0aW9uLlxuICAgKiBAcGFyYW0geyFFdmVudH0gZVxuICAgKiBAcGFyYW0geyFFbGVtZW50fSB0YXJnZXRcbiAgICogQHBhcmFtIHshTG9jYXRpb259IHRndExvY1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgaGFuZGxlTmF2Q2xpY2tfKGUsIHRhcmdldCwgdGd0TG9jKSB7XG4gICAgLy8gSW4gdGVzdCBtb2RlLCB3ZSdyZSBub3QgYWJsZSB0byBwcm9wZXJseSBmaXggdGhlIGFuY2hvciB0YWcncyBiYXNlIFVSTC5cbiAgICAvLyBTbywgd2UgaGF2ZSB0byB1c2UgdGhlIChtb2NrZWQpIHdpbmRvdydzIGxvY2F0aW9uIGluc3RlYWQuXG4gICAgY29uc3QgYmFzZUhyZWYgPSBnZXRNb2RlKCkudGVzdCAmJiAhdGhpcy5pc0VtYmVkX1xuICAgICAgPyB0aGlzLmFtcGRvYy53aW4ubG9jYXRpb24uaHJlZlxuICAgICAgOiAnJztcbiAgICBjb25zdCBjdXJMb2MgPSB0aGlzLnBhcnNlVXJsXyhiYXNlSHJlZik7XG4gICAgY29uc3QgdGd0SHJlZiA9IGAke3RndExvYy5vcmlnaW59JHt0Z3RMb2MucGF0aG5hbWV9JHt0Z3RMb2Muc2VhcmNofWA7XG4gICAgY29uc3QgY3VySHJlZiA9IGAke2N1ckxvYy5vcmlnaW59JHtjdXJMb2MucGF0aG5hbWV9JHtjdXJMb2Muc2VhcmNofWA7XG5cbiAgICAvLyBJZiB0aGUgY3VycmVudCB0YXJnZXQgYW5jaG9yIGxpbmsgaXMgdGhlIHNhbWUgb3JpZ2luICsgcGF0aFxuICAgIC8vIGFzIHRoZSBjdXJyZW50IGRvY3VtZW50IHRoZW4gd2Uga25vdyB3ZSBhcmUganVzdCBsaW5raW5nIHRvIGFuXG4gICAgLy8gaWRlbnRpZmllciBpbiB0aGUgZG9jdW1lbnQuIE90aGVyd2lzZSwgaXQncyBhbiBleHRlcm5hbCBuYXZpZ2F0aW9uLlxuICAgIGlmICghdGd0TG9jLmhhc2ggfHwgdGd0SHJlZiAhPSBjdXJIcmVmKSB7XG4gICAgICBpZiAodGhpcy5pc0VtYmVkXyB8fCB0aGlzLmlzSW5BQm94Xykge1xuICAgICAgICAvLyBUYXJnZXQgaW4gdGhlIGVtYmVkIG11c3QgYmUgZWl0aGVyIF90b3Agb3IgX2JsYW5rLiBJZiBub25lIHNwZWNpZmllZCxcbiAgICAgICAgLy8gZm9yY2UgdG8gX2JsYW5rLlxuICAgICAgICBjb25zdCB0YXJnZXRBdHRyID0gKHRhcmdldC5nZXRBdHRyaWJ1dGUoJ3RhcmdldCcpIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAodGFyZ2V0QXR0ciAhPSAnX3RvcCcgJiYgdGFyZ2V0QXR0ciAhPSAnX2JsYW5rJykge1xuICAgICAgICAgIHRhcmdldC5zZXRBdHRyaWJ1dGUoJ3RhcmdldCcsICdfYmxhbmsnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFdlIHByZXZlbnQgZGVmYXVsdCBzbyB0aGF0IHRoZSBjdXJyZW50IGNsaWNrIGRvZXMgbm90IHB1c2hcbiAgICAvLyBpbnRvIHRoZSBoaXN0b3J5IHN0YWNrIGFzIHRoaXMgbWVzc2VzIHVwIHRoZSBleHRlcm5hbCBkb2N1bWVudHNcbiAgICAvLyBoaXN0b3J5IHdoaWNoIGNvbnRhaW5zIHRoZSBhbXAgZG9jdW1lbnQuXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgLy8gRm9yIGFuIGVtYmVkLCBkbyBub3QgcGVyZm9ybSBzY3JvbGxpbmcgb3IgZ2xvYmFsIGhpc3RvcnkgcHVzaCAtIGJvdGggaGF2ZVxuICAgIC8vIHNpZ25pZmljYW50IFVYIGFuZCBicm93c2VyIHByb2JsZW1zLlxuICAgIGlmICh0aGlzLmlzRW1iZWRfKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gTG9vayBmb3IgdGhlIHJlZmVyZW5jZWQgZWxlbWVudC5cbiAgICBjb25zdCBoYXNoID0gdGd0TG9jLmhhc2guc2xpY2UoMSk7XG4gICAgbGV0IGVsZW0gPSBudWxsO1xuICAgIGlmIChoYXNoKSB7XG4gICAgICBjb25zdCBlc2NhcGVkSGFzaCA9IGVzY2FwZUNzc1NlbGVjdG9ySWRlbnQoaGFzaCk7XG4gICAgICBlbGVtID0gKHRoaXMucm9vdE5vZGVfLmdldEVsZW1lbnRCeUlkKGhhc2gpIHx8XG4gICAgICAgICAgLy8gRmFsbGJhY2sgdG8gYW5jaG9yW25hbWVdIGlmIGVsZW1lbnQgd2l0aCBpZCBpcyBub3QgZm91bmQuXG4gICAgICAgICAgLy8gTGlua2luZyB0byBhbiBhbmNob3IgZWxlbWVudCB3aXRoIG5hbWUgaXMgb2Jzb2xldGUgaW4gaHRtbDUuXG4gICAgICAgICAgdGhpcy5yb290Tm9kZV8uLypPSyovcXVlcnlTZWxlY3RvcihgYVtuYW1lPVwiJHtlc2NhcGVkSGFzaH1cIl1gKSk7XG4gICAgfVxuXG4gICAgLy8gSWYgcG9zc2libGUgZG8gdXBkYXRlIHRoZSBVUkwgd2l0aCB0aGUgaGFzaC4gQXMgZXhwbGFpbmVkIGFib3ZlXG4gICAgLy8gd2UgZG8gYHJlcGxhY2VgIHRvIGF2b2lkIG1lc3Npbmcgd2l0aCB0aGUgY29udGFpbmVyJ3MgaGlzdG9yeS5cbiAgICBpZiAodGd0TG9jLmhhc2ggIT0gY3VyTG9jLmhhc2gpIHtcbiAgICAgIHRoaXMuaGlzdG9yeV8ucmVwbGFjZVN0YXRlRm9yVGFyZ2V0KHRndExvYy5oYXNoKS50aGVuKCgpID0+IHtcbiAgICAgICAgdGhpcy5zY3JvbGxUb0VsZW1lbnRfKGVsZW0sIGhhc2gpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIElmIHRoZSBoYXNoIGRpZCBub3QgdXBkYXRlIGp1c3Qgc2Nyb2xsIHRvIHRoZSBlbGVtZW50LlxuICAgICAgdGhpcy5zY3JvbGxUb0VsZW1lbnRfKGVsZW0sIGhhc2gpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTY3JvbGxzIHRoZSBwYWdlIHRvIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgKiBAcGFyYW0gez9FbGVtZW50fSBlbGVtXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBoYXNoXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzY3JvbGxUb0VsZW1lbnRfKGVsZW0sIGhhc2gpIHtcbiAgICAvLyBTY3JvbGwgdG8gdGhlIGVsZW1lbnQgaWYgZm91bmQuXG4gICAgaWYgKGVsZW0pIHtcbiAgICAgIC8vIFRoZSBmaXJzdCBjYWxsIHRvIHNjcm9sbEludG9WaWV3IG92ZXJyaWRlcyBicm93c2VycycgZGVmYXVsdCBzY3JvbGxpbmdcbiAgICAgIC8vIGJlaGF2aW9yLiBUaGUgc2Vjb25kIGNhbGwgaW5zaWRlcyBzZXRUaW1lb3V0IGFsbG93cyB1cyB0byBzY3JvbGwgdG9cbiAgICAgIC8vIHRoYXQgZWxlbWVudCBwcm9wZXJseS4gV2l0aG91dCBkb2luZyB0aGlzLCB0aGUgdmlld3BvcnQgd2lsbCBub3QgY2F0Y2hcbiAgICAgIC8vIHRoZSB1cGRhdGVkIHNjcm9sbCBwb3NpdGlvbiBvbiBpT1MgU2FmYXJpIGFuZCBoZW5jZSBjYWxjdWxhdGUgdGhlIHdyb25nXG4gICAgICAvLyBzY3JvbGxUb3AgZm9yIHRoZSBzY3JvbGxiYXIganVtcGluZyB0aGUgdXNlciBiYWNrIHRvIHRoZSB0b3AgZm9yXG4gICAgICAvLyBmYWlsaW5nIHRvIGNhbGN1bGF0ZSB0aGUgbmV3IGp1bXBlZCBvZmZzZXQuIFdpdGhvdXQgdGhlIGZpcnN0IGNhbGxcbiAgICAgIC8vIHRoZXJlIHdpbGwgYmUgYSB2aXN1YWwganVtcCBkdWUgdG8gYnJvd3NlciBzY3JvbGwuIFNlZVxuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FtcHByb2plY3QvYW1waHRtbC9pc3N1ZXMvNTMzNCBmb3IgbW9yZSBkZXRhaWxzLlxuICAgICAgdGhpcy52aWV3cG9ydF8uLypPSyovc2Nyb2xsSW50b1ZpZXcoZWxlbSk7XG4gICAgICBTZXJ2aWNlcy50aW1lckZvcih0aGlzLmFtcGRvYy53aW4pLmRlbGF5KCgpID0+XG4gICAgICAgIHRoaXMudmlld3BvcnRfLi8qT0sqL3Njcm9sbEludG9WaWV3KGRldigpLmFzc2VydEVsZW1lbnQoZWxlbSkpLCAxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGV2KCkud2FybihUQUcsXG4gICAgICAgICAgYGZhaWxlZCB0byBmaW5kIGVsZW1lbnQgd2l0aCBpZD0ke2hhc2h9IG9yIGFbbmFtZT0ke2hhc2h9XWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gICAqIEByZXR1cm4geyFMb2NhdGlvbn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHBhcnNlVXJsXyh1cmwpIHtcbiAgICAvLyBNdXN0IHVzZSBVUkwgcGFyc2luZyBzY29wZWQgdG8gdGhpcy5yb290Tm9kZV8gZm9yIGNvcnJlY3QgRklFIGJlaGF2aW9yLlxuICAgIHJldHVybiBTZXJ2aWNlcy51cmxGb3JEb2ModGhpcy5yb290Tm9kZV8pLnBhcnNlKHVybCk7XG4gIH1cbn1cblxuLyoqXG4gKiBIYW5kbGUgY2xpY2sgb24gbGlua3MgYW5kIHJlcGxhY2UgdmFyaWFibGVzIGluIHRoZSBjbGljayBVUkwuXG4gKiBUaGUgZnVuY3Rpb24gY2hhbmdlcyB0aGUgYWN0dWFsIGhyZWYgdmFsdWUgYW5kIHN0b3JlcyB0aGVcbiAqIHRlbXBsYXRlIGluIHRoZSBPUklHSU5BTF9IUkVGX0FUVFJJQlVURSBhdHRyaWJ1dGVcbiAqIEBwYXJhbSB7IS4vYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAqIEBwYXJhbSB7IUV2ZW50fSBlXG4gKi9cbmZ1bmN0aW9uIG1heWJlRXhwYW5kVXJsUGFyYW1zKGFtcGRvYywgZSkge1xuICBjb25zdCB0YXJnZXQgPSBjbG9zZXN0QnlUYWcoZGV2KCkuYXNzZXJ0RWxlbWVudChlLnRhcmdldCksICdBJyk7XG4gIGlmICghdGFyZ2V0IHx8ICF0YXJnZXQuaHJlZikge1xuICAgIC8vIE5vdCBhIGNsaWNrIG9uIGEgbGluay5cbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgaHJlZlRvRXhwYW5kID1cbiAgICAgIHRhcmdldC5nZXRBdHRyaWJ1dGUoT1JJR19IUkVGX0FUVFJJQlVURSkgfHwgdGFyZ2V0LmdldEF0dHJpYnV0ZSgnaHJlZicpO1xuICBpZiAoIWhyZWZUb0V4cGFuZCkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB2YXJzID0ge1xuICAgICdDTElDS19YJzogKCkgPT4ge1xuICAgICAgcmV0dXJuIGUucGFnZVg7XG4gICAgfSxcbiAgICAnQ0xJQ0tfWSc6ICgpID0+IHtcbiAgICAgIHJldHVybiBlLnBhZ2VZO1xuICAgIH0sXG4gIH07XG4gIGNvbnN0IG5ld0hyZWYgPSBTZXJ2aWNlcy51cmxSZXBsYWNlbWVudHNGb3JEb2MoYW1wZG9jKS5leHBhbmRVcmxTeW5jKFxuICAgICAgaHJlZlRvRXhwYW5kLCB2YXJzLCB1bmRlZmluZWQsIC8qIG9wdF93aGl0ZWxpc3QgKi8ge1xuICAgICAgICAvLyBGb3Igbm93IHdlIG9ubHkgYWxsb3cgdG8gcmVwbGFjZSB0aGUgY2xpY2sgbG9jYXRpb24gdmFyc1xuICAgICAgICAvLyBhbmQgbm90aGluZyBlbHNlLlxuICAgICAgICAvLyBOT1RFOiBBZGRpdGlvbiB0byB0aGlzIHdoaXRlbGlzdCByZXF1aXJlcyBhZGRpdGlvbmFsIHJldmlldy5cbiAgICAgICAgJ0NMSUNLX1gnOiB0cnVlLFxuICAgICAgICAnQ0xJQ0tfWSc6IHRydWUsXG4gICAgICB9KTtcbiAgaWYgKG5ld0hyZWYgIT0gaHJlZlRvRXhwYW5kKSB7XG4gICAgLy8gU3RvcmUgb3JpZ2luYWwgdmFsdWUgc28gdGhhdCBsYXRlciBjbGlja3MgY2FuIGJlIHByb2Nlc3NlZCB3aXRoXG4gICAgLy8gZnJlc2hlc3QgdmFsdWVzLlxuICAgIGlmICghdGFyZ2V0LmdldEF0dHJpYnV0ZShPUklHX0hSRUZfQVRUUklCVVRFKSkge1xuICAgICAgdGFyZ2V0LnNldEF0dHJpYnV0ZShPUklHX0hSRUZfQVRUUklCVVRFLCBocmVmVG9FeHBhbmQpO1xuICAgIH1cbiAgICB0YXJnZXQuc2V0QXR0cmlidXRlKCdocmVmJywgbmV3SHJlZik7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2hhc093bn0gZnJvbSAnLi4vLi4vdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7cmV0aHJvd0FzeW5jLCB1c2VyfSBmcm9tICcuLi8uLi9sb2cnO1xuaW1wb3J0IHt0cnlSZXNvbHZlfSBmcm9tICcuLi8uLi91dGlscy9wcm9taXNlJztcblxuLyoqIEBwcml2YXRlIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgUEFSU0VSX0lHTk9SRV9GTEFHID0gJ2AnO1xuXG4vKiogQHByaXZhdGUgQGNvbnN0IHtzdHJpbmd9ICovXG5jb25zdCBUQUcgPSAnRXhwYW5kZXInO1xuXG4vKiogQSB3aGl0ZWxpc3QgZm9yIHJlcGxhY2VtZW50cyB3aG9zZSB2YWx1ZXMgc2hvdWxkIG5vdCBiZSAlLWVuY29kZWQuICovXG4vKiogQGNvbnN0IHtPYmplY3Q8c3RyaW5nLCBib29sZWFuPn0gKi9cbmV4cG9ydCBjb25zdCBOT0VOQ09ERV9XSElURUxJU1QgPSB7J0FOQ0VTVE9SX09SSUdJTic6IHRydWV9O1xuXG4vKiogUnVkYW1lbnRhcnkgcGFyc2VyIHRvIGhhbmRsZSBuZXN0ZWQgVXJsIHJlcGxhY2VtZW50LiAqL1xuZXhwb3J0IGNsYXNzIEV4cGFuZGVyIHtcblxuICAvKipcbiAgICogTGluayB0aGlzIGluc3RhbmNlIG9mIHBhcnNlciB0byB0aGUgY2FsbGluZyBVcmxSZXBsYWNtZW50XG4gICAqIEBwYXJhbSB7IS4uL3ZhcmlhYmxlLXNvdXJjZS5WYXJpYWJsZVNvdXJjZXxudWxsfSB2YXJpYWJsZVNvdXJjZSB0aGUga2V5d29yZHMgdG8gcmVwbGFjZVxuICAgKi9cbiAgY29uc3RydWN0b3IodmFyaWFibGVTb3VyY2UpIHtcbiAgICB0aGlzLnZhcmlhYmxlU291cmNlXyA9IHZhcmlhYmxlU291cmNlO1xuICB9XG5cblxuICAvKipcbiAgICogdGFrZSB0aGUgdGVtcGxhdGUgdXJsIGFuZCByZXR1cm4gYSBwcm9taXNlIG9mIGl0cyBldmFsdWF0ZWQgdmFsdWVcbiAgICogQHBhcmFtIHtzdHJpbmd9IHVybCB1cmwgdG8gYmUgc3Vic3RpdHV0ZWRcbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgKj49fSBvcHRfYmluZGluZ3MgYWRkaXRpb25hbCBvbmUtb2ZmIGJpbmRpbmdzXG4gICAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICo+PX0gb3B0X2NvbGxlY3RWYXJzIE9iamVjdCBwYXNzZWQgaW4gdG8gY29sbGVjdFxuICAgKiAgIHZhcmlhYmxlIHJlc29sdXRpb25zLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfc3luYyBJZiB0aGUgbWV0aG9kIHNob3VsZCByZXNvbHZlIHN5bmNyb25vdXNseS5cbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgYm9vbGVhbj49fSBvcHRfd2hpdGVMaXN0IE9wdGlvbmFsIHdoaXRlIGxpc3Qgb2YgbmFtZXNcbiAgICogICB0aGF0IGNhbiBiZSBzdWJzdGl0dXRlZC5cbiAgICogQHJldHVybiB7IVByb21pc2U8c3RyaW5nPnxzdHJpbmd9XG4gICAqL1xuICBleHBhbmQodXJsLCBvcHRfYmluZGluZ3MsIG9wdF9jb2xsZWN0VmFycywgb3B0X3N5bmMsIG9wdF93aGl0ZUxpc3QpIHtcbiAgICBpZiAoIXVybC5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBvcHRfc3luYyA/IHVybCA6IFByb21pc2UucmVzb2x2ZSh1cmwpO1xuICAgIH1cbiAgICBjb25zdCBleHByID0gdGhpcy52YXJpYWJsZVNvdXJjZV9cbiAgICAgICAgLmdldEV4cHIob3B0X2JpbmRpbmdzLCAvKm9wdF9pZ25vcmVBcmdzICovIHRydWUsIG9wdF93aGl0ZUxpc3QpO1xuXG4gICAgY29uc3QgbWF0Y2hlcyA9IHRoaXMuZmluZE1hdGNoZXNfKHVybCwgZXhwcik7XG4gICAgLy8gaWYgbm8ga2V5d29yZHMgbW92ZSBvblxuICAgIGlmICghbWF0Y2hlcy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBvcHRfc3luYyA/IHVybCA6IFByb21pc2UucmVzb2x2ZSh1cmwpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5wYXJzZVVybFJlY3Vyc2l2ZWx5Xyh1cmwsIG1hdGNoZXMsIG9wdF9iaW5kaW5ncyxcbiAgICAgICAgb3B0X2NvbGxlY3RWYXJzLCBvcHRfc3luYyk7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBTdHJ1Y3R1cmVzIHRoZSByZWdleCBtYXRjaGluZyBpbnRvIHRoZSBkZXNpcmVkIGZvcm1hdFxuICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIHVybCB0byBiZSBzdWJzdGl0dXRlZFxuICAgKiBAcGFyYW0ge1JlZ0V4cH0gZXhwcmVzc2lvbiByZWdleCBjb250YWluaW5nIGFsbCBrZXl3b3Jkc1xuICAgKiBAcmV0dXJuIHtBcnJheTxPYmplY3Q8c3RyaW5nLCBzdHJpbmd8bnVtYmVyPj59IGFycmF5IG9mIG9iamVjdHMgcmVwcmVzZW50aW5nXG4gICAqICBtYXRjaGluZyBrZXl3b3Jkc1xuICAgKi9cbiAgZmluZE1hdGNoZXNfKHVybCwgZXhwcmVzc2lvbikge1xuICAgIGNvbnN0IG1hdGNoZXMgPSBbXTtcbiAgICB1cmwucmVwbGFjZShleHByZXNzaW9uLCAobWF0Y2gsIG5hbWUsIHN0YXJ0UG9zaXRpb24pID0+IHtcbiAgICAgIGNvbnN0IHtsZW5ndGh9ID0gbWF0Y2g7XG4gICAgICBjb25zdCBzdG9wUG9zaXRpb24gPSBsZW5ndGggKyBzdGFydFBvc2l0aW9uIC0gMTtcbiAgICAgIGNvbnN0IGluZm8gPSB7XG4gICAgICAgIHN0YXJ0OiBzdGFydFBvc2l0aW9uLFxuICAgICAgICBzdG9wOiBzdG9wUG9zaXRpb24sXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxlbmd0aCxcbiAgICAgIH07XG4gICAgICBtYXRjaGVzLnB1c2goaW5mbyk7XG4gICAgfSk7XG4gICAgcmV0dXJuIG1hdGNoZXM7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gICAqIEBwYXJhbSB7IUFycmF5PE9iamVjdDxzdHJpbmcsIHN0cmluZ3xudW1iZXI+Pn0gbWF0Y2hlcyBBcnJheSBvZiBvYmplY3RzXG4gICAqICAgcmVwcmVzZW50aW5nIG1hdGNoaW5nIGtleXdvcmRzLlxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPj19IG9wdF9iaW5kaW5ncyBBZGRpdGlvbmFsIG9uZS1vZmYgYmluZGluZ3MuXG4gICAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICo+PX0gb3B0X2NvbGxlY3RWYXJzIE9iamVjdCBwYXNzZWQgaW4gdG8gY29sbGVjdFxuICAgKiAgIHZhcmlhYmxlIHJlc29sdXRpb25zLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfc3luY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTxzdHJpbmc+fHN0cmluZ31cbiAgICovXG4gIHBhcnNlVXJsUmVjdXJzaXZlbHlfKHVybCwgbWF0Y2hlcywgb3B0X2JpbmRpbmdzLCBvcHRfY29sbGVjdFZhcnMsIG9wdF9zeW5jKSB7XG4gICAgY29uc3Qgc3RhY2sgPSBbXTtcbiAgICBsZXQgdXJsSW5kZXggPSAwO1xuICAgIGxldCBtYXRjaEluZGV4ID0gMDtcbiAgICBsZXQgbWF0Y2ggPSBtYXRjaGVzW21hdGNoSW5kZXhdO1xuICAgIGxldCBudW1PZlBlbmRpbmdDYWxscyA9IDA7XG4gICAgbGV0IGlnbm9yaW5nQ2hhcnMgPSBmYWxzZTtcbiAgICBsZXQgbmV4dEFyZ1Nob3VsZEJlUmF3ID0gZmFsc2U7XG5cbiAgICBjb25zdCBldmFsdWF0ZU5leHRMZXZlbCA9ICgpID0+IHtcbiAgICAgIGxldCBidWlsZGVyID0gJyc7XG4gICAgICBjb25zdCByZXN1bHRzID0gW107XG5cbiAgICAgIHdoaWxlICh1cmxJbmRleCA8IHVybC5sZW5ndGggJiYgbWF0Y2hJbmRleCA8PSBtYXRjaGVzLmxlbmd0aCkge1xuICAgICAgICBpZiAobWF0Y2ggJiYgdXJsSW5kZXggPT09IG1hdGNoLnN0YXJ0KSB7XG4gICAgICAgICAgbGV0IGJpbmRpbmc7XG4gICAgICAgICAgLy8gZmluZCBvdXQgd2hlcmUgdGhpcyBrZXl3b3JkIGlzIGNvbWluZyBmcm9tXG4gICAgICAgICAgaWYgKG9wdF9iaW5kaW5ncyAmJiBoYXNPd24ob3B0X2JpbmRpbmdzLCBtYXRjaC5uYW1lKSkge1xuICAgICAgICAgICAgLy8gdGhlIG9wdGlvbmFsIGJpbmRpbmdzXG4gICAgICAgICAgICBiaW5kaW5nID0ge1xuICAgICAgICAgICAgICAvLyBUaGlzIGNvbnN0cnVjdGlvbiBoZWxwcyB1cyBzYXZlIHRoZSBtYXRjaCBuYW1lIGFuZCBkZXRlcm1pbmVcbiAgICAgICAgICAgICAgLy8gcHJlY2VkZW5jZSBvZiByZXNvbHV0aW9uIGNob2ljZXMgaW4gI2V4cGFuZEJpbmRpbmdfIGxhdGVyLlxuICAgICAgICAgICAgICBuYW1lOiBtYXRjaC5uYW1lLFxuICAgICAgICAgICAgICBwcmlvcml0aXplZDogb3B0X2JpbmRpbmdzW21hdGNoLm5hbWVdLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gb3IgdGhlIGdsb2JhbCBzb3VyY2VcbiAgICAgICAgICAgIGJpbmRpbmcgPSB0aGlzLnZhcmlhYmxlU291cmNlXy5nZXQobWF0Y2gubmFtZSk7XG4gICAgICAgICAgICBiaW5kaW5nLm5hbWUgPSBtYXRjaC5uYW1lO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHVybEluZGV4ID0gbWF0Y2guc3RvcCArIDE7XG4gICAgICAgICAgbWF0Y2ggPSBtYXRjaGVzWysrbWF0Y2hJbmRleF07XG5cbiAgICAgICAgICBpZiAodXJsW3VybEluZGV4XSA9PT0gJygnKSB7XG4gICAgICAgICAgICAvLyBpZiB3ZSBoaXQgYSBsZWZ0IHBhcmVudGhlc2lzIHdlIHN0aWxsIG5lZWQgdG8gZ2V0IGFyZ3NcbiAgICAgICAgICAgIHVybEluZGV4Kys7XG4gICAgICAgICAgICBudW1PZlBlbmRpbmdDYWxscysrO1xuICAgICAgICAgICAgc3RhY2sucHVzaChiaW5kaW5nKTtcbiAgICAgICAgICAgIC8vIHRyaW0gc3BhY2UgaW4gYmV0d2VlbiBhcmdzXG4gICAgICAgICAgICBpZiAoYnVpbGRlci50cmltKCkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIHJlc3VsdHMucHVzaChidWlsZGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc3VsdHMucHVzaChldmFsdWF0ZU5leHRMZXZlbCgpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGJ1aWxkZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIHJlc3VsdHMucHVzaChidWlsZGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc3VsdHMucHVzaCh0aGlzLmV2YWx1YXRlQmluZGluZ18oYmluZGluZyxcbiAgICAgICAgICAgICAgICAvKiBvcHRfYXJncyAqLyB1bmRlZmluZWQsIG9wdF9jb2xsZWN0VmFycywgb3B0X3N5bmMpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBidWlsZGVyID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICBlbHNlIGlmICh1cmxbdXJsSW5kZXhdID09PSBQQVJTRVJfSUdOT1JFX0ZMQUcpIHtcbiAgICAgICAgICBpZiAoIWlnbm9yaW5nQ2hhcnMpIHtcbiAgICAgICAgICAgIGlnbm9yaW5nQ2hhcnMgPSB0cnVlO1xuICAgICAgICAgICAgbmV4dEFyZ1Nob3VsZEJlUmF3ID0gdHJ1ZTtcbiAgICAgICAgICAgIHVzZXIoKS5hc3NlcnQoYnVpbGRlci50cmltKCkgPT09ICcnLFxuICAgICAgICAgICAgICAgIGBUaGUgc3Vic3RyaW5nIFwiJHtidWlsZGVyfVwiIHdhcyBsb3N0IGR1cmluZyB1cmwtcmVwbGFjZW1lbnQuIGAgK1xuICAgICAgICAgICAgICAgICdQbGVhc2UgZW5zdXJlIHRoZSB1cmwgc3ludGF4IGlzIGNvcnJlY3QnKTtcbiAgICAgICAgICAgIGJ1aWxkZXIgPSAnJztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWdub3JpbmdDaGFycyA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB1cmxJbmRleCsrO1xuICAgICAgICB9XG5cbiAgICAgICAgZWxzZSBpZiAobnVtT2ZQZW5kaW5nQ2FsbHMgJiYgdXJsW3VybEluZGV4XSA9PT0gJywnICYmICFpZ25vcmluZ0NoYXJzKSB7XG4gICAgICAgICAgaWYgKGJ1aWxkZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0QXJnID0gbmV4dEFyZ1Nob3VsZEJlUmF3ID8gYnVpbGRlciA6IGJ1aWxkZXIudHJpbSgpO1xuICAgICAgICAgICAgcmVzdWx0cy5wdXNoKG5leHRBcmcpO1xuICAgICAgICAgICAgbmV4dEFyZ1Nob3VsZEJlUmF3ID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIHN1cHBvcnQgZXhpc3RpbmcgdHdvIGNvbW1hIGZvcm1hdFxuICAgICAgICAgIC8vIGVnIENMSUVOVF9JRChfX2dhLCxnYS11cmwpXG4gICAgICAgICAgaWYgKHVybFt1cmxJbmRleCArIDFdID09PSAnLCcpIHtcbiAgICAgICAgICAgIHJlc3VsdHMucHVzaCgnJyk7IC8vIFRPRE8oY2NvcmRyeSk6IG1heSB3YW50IHRoaXMgdG8gYmUgdW5kZWZpbmVkIGF0IHNvbWUgcG9pbnRcbiAgICAgICAgICAgIHVybEluZGV4Kys7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJ1aWxkZXIgPSAnJztcbiAgICAgICAgICB1cmxJbmRleCsrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSW52b2tlIGEgZnVuY3Rpb24gb24gZXZlcnkgcmlnaHQgcGFyZW50aGVzaXMgdW5sZXNzIHRoZSBzdGFjayBpc1xuICAgICAgICAvLyBlbXB0eS5cbiAgICAgICAgZWxzZSBpZiAobnVtT2ZQZW5kaW5nQ2FsbHMgJiYgdXJsW3VybEluZGV4XSA9PT0gJyknICYmICFpZ25vcmluZ0NoYXJzKSB7XG4gICAgICAgICAgdXJsSW5kZXgrKztcbiAgICAgICAgICBudW1PZlBlbmRpbmdDYWxscy0tO1xuICAgICAgICAgIGNvbnN0IGJpbmRpbmcgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICBjb25zdCBuZXh0QXJnID0gbmV4dEFyZ1Nob3VsZEJlUmF3ID8gYnVpbGRlciA6IGJ1aWxkZXIudHJpbSgpO1xuICAgICAgICAgIHJlc3VsdHMucHVzaChuZXh0QXJnKTtcbiAgICAgICAgICBuZXh0QXJnU2hvdWxkQmVSYXcgPSBmYWxzZTtcbiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZXZhbHVhdGVCaW5kaW5nXyhiaW5kaW5nLCAvKiBvcHRfYXJncyAqLyByZXN1bHRzLFxuICAgICAgICAgICAgICBvcHRfY29sbGVjdFZhcnMsIG9wdF9zeW5jKTtcbiAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBidWlsZGVyICs9IHVybFt1cmxJbmRleF07XG4gICAgICAgICAgdXJsSW5kZXgrKztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY2FwdHVyZSB0cmFpbGluZyBjaGFyYWN0ZXJzXG4gICAgICAgIGlmICh1cmxJbmRleCA9PT0gdXJsLmxlbmd0aCAmJiBidWlsZGVyLmxlbmd0aCkge1xuICAgICAgICAgIHJlc3VsdHMucHVzaChidWlsZGVyKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAob3B0X3N5bmMpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdHMuam9pbignJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChyZXN1bHRzKVxuICAgICAgICAgIC50aGVuKHByb21pc2VBcnJheSA9PiBwcm9taXNlQXJyYXkuam9pbignJykpXG4gICAgICAgICAgLmNhdGNoKGUgPT4ge1xuICAgICAgICAgICAgcmV0aHJvd0FzeW5jKGUpO1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgIH0pO1xuICAgIH07XG5cbiAgICByZXR1cm4gZXZhbHVhdGVOZXh0TGV2ZWwoKTtcbiAgfVxuXG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGEgYmluZGluZyBpcyByZWFkeSB0byBiZSByZXNvbHZlZC4gRGV0ZXJtaW5lcyB3aGljaCB2ZXJzaW9uIG9mXG4gICAqIGJpbmRpbmcgdG8gdXNlIGFuZCBpZiBzeW5jcm9ub3VzIG9yIGFzeW5jcm9ub3VzIHZlcnNpb24gc2hvdWxkIGJlIGNhbGxlZC5cbiAgICogQHBhcmFtIHtPYmplY3Q8c3RyaW5nLCAqPn0gYmluZGluZ0luZm8gQW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIG5hbWUgb2YgbWFjcm9cbiAgICogICBhbmQgdmFsdWUgdG8gYmUgcmVzb2x2ZWQuXG4gICAqIEBwYXJhbSB7QXJyYXk9fSBvcHRfYXJncyBBcmd1bWVudHMgcGFzc2VkIHRvIHRoZSBtYWNyby5cbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgKj49fSBvcHRfY29sbGVjdFZhcnMgT2JqZWN0IHBhc3NlZCBpbiB0byBjb2xsZWN0XG4gICAqICAgdmFyaWFibGUgcmVzb2x1dGlvbnMuXG4gICAqIEBwYXJhbSB7Kj19IG9wdF9zeW5jIFdoZXRoZXIgdGhlIGJpbmRpbmcgc2hvdWxkIGJlIHJlc29sdmVkIHN5bmNocm9ub3VzbHkuXG4gICAqL1xuICBldmFsdWF0ZUJpbmRpbmdfKGJpbmRpbmdJbmZvLCBvcHRfYXJncywgb3B0X2NvbGxlY3RWYXJzLCBvcHRfc3luYykge1xuICAgIGNvbnN0IHtuYW1lfSA9IGJpbmRpbmdJbmZvO1xuICAgIGxldCBiaW5kaW5nO1xuICAgIGlmIChiaW5kaW5nSW5mby5wcmlvcml0aXplZCkge1xuICAgICAgLy8gSWYgYSBiaW5kaW5nIGlzIHBhc3NlZCBpbiB0aHJvdWdoIG9wdF9iaW5kaW5ncyBpdCBhbHdheXMgdGFrZXNcbiAgICAgIC8vIHByZWNlZGVuY2UuXG4gICAgICBiaW5kaW5nID0gYmluZGluZ0luZm8ucHJpb3JpdGl6ZWQ7XG4gICAgfSBlbHNlIGlmIChvcHRfc3luYyAmJiBiaW5kaW5nSW5mby5zeW5jKSB7XG4gICAgICAvLyBVc2UgdGhlIHN5bmMgcmVzb2x1dGlvbiBpZiBhdmFsaWFibGUgd2hlbiBjYWxsZWQgc3luY2hyb25vdXNseS5cbiAgICAgIGJpbmRpbmcgPSBiaW5kaW5nSW5mby5zeW5jO1xuICAgIH0gZWxzZSBpZiAob3B0X3N5bmMpIHtcbiAgICAgIC8vIElmIHRoZXJlIGlzIG5vIHN5bmMgcmVzb2x1dGlvbiB3ZSBjYW4gbm90IHdhaXQuXG4gICAgICB1c2VyKCkuZXJyb3IoVEFHLCAnaWdub3JpbmcgYXN5bmMgcmVwbGFjZW1lbnQga2V5OiAnLCBiaW5kaW5nSW5mby5uYW1lKTtcbiAgICAgIGJpbmRpbmcgPSAnJztcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gUHJlZmVyIHRoZSBhc3luYyBvdmVyIHRoZSBzeW5jIGJ1dCBpdCBtYXkgbm90IGV4aXN0LlxuICAgICAgYmluZGluZyA9IGJpbmRpbmdJbmZvLmFzeW5jIHx8IGJpbmRpbmdJbmZvLnN5bmM7XG4gICAgfVxuICAgIHJldHVybiBvcHRfc3luYyA/XG4gICAgICB0aGlzLmV2YWx1YXRlQmluZGluZ1N5bmNfKGJpbmRpbmcsIG5hbWUsIG9wdF9hcmdzLCBvcHRfY29sbGVjdFZhcnMpIDpcbiAgICAgIHRoaXMuZXZhbHVhdGVCaW5kaW5nQXN5bmNfKGJpbmRpbmcsIG5hbWUsIG9wdF9hcmdzLCBvcHRfY29sbGVjdFZhcnMpO1xuICB9XG5cblxuICAvKipcbiAgICogUmVzb2x2ZXMgYmluZGluZyB0byB2YWx1ZSB0byBiZSBzdWJzdGl0dXRlZCBhc3luY3Jvbm91c2x5LlxuICAgKiBAcGFyYW0geyp9IGJpbmRpbmcgQ29udGFpbmVyIGZvciBzeW5jL2FzeW5jIHJlc29sdXRpb25zLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcGFyYW0gez9BcnJheT19IG9wdF9hcmdzIEFyZ3VtZW50cyB0byBiZSBwYXNzZWQgaWYgYmluZGluZyBpcyBmdW5jdGlvbi5cbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgKj49fSBvcHRfY29sbGVjdFZhcnMgT2JqZWN0IHBhc3NlZCBpbiB0byBjb2xsZWN0XG4gICAqICAgdmFyaWFibGUgcmVzb2x1dGlvbnMuXG4gICAqIEByZXR1cm4geyFQcm9taXNlPHN0cmluZz59IFJlc29sdmVkIHZhbHVlLlxuICAgKi9cbiAgZXZhbHVhdGVCaW5kaW5nQXN5bmNfKGJpbmRpbmcsIG5hbWUsIG9wdF9hcmdzLCBvcHRfY29sbGVjdFZhcnMpIHtcbiAgICBsZXQgdmFsdWU7XG4gICAgdHJ5IHtcbiAgICAgIGlmICh0eXBlb2YgYmluZGluZyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBpZiAob3B0X2FyZ3MpIHtcbiAgICAgICAgICB2YWx1ZSA9IFByb21pc2UuYWxsKG9wdF9hcmdzKVxuICAgICAgICAgICAgICAudGhlbihhcmdzID0+IGJpbmRpbmcuYXBwbHkobnVsbCwgYXJncykpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhbHVlID0gdHJ5UmVzb2x2ZShiaW5kaW5nKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsdWUgPSBQcm9taXNlLnJlc29sdmUoYmluZGluZyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWUudGhlbih2YWwgPT4ge1xuICAgICAgICBsZXQgcmVzdWx0O1xuXG4gICAgICAgIGlmICh2YWwgPT0gbnVsbCkge1xuICAgICAgICAgIHJlc3VsdCA9ICcnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc3VsdCA9IE5PRU5DT0RFX1dISVRFTElTVFtuYW1lXSA/IHZhbCA6IGVuY29kZVVSSUNvbXBvbmVudCh2YWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wdF9jb2xsZWN0VmFycykge1xuICAgICAgICAgIG9wdF9jb2xsZWN0VmFyc1tuYW1lXSA9IHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfSkuY2F0Y2goZSA9PiB7XG4gICAgICAgIHJldGhyb3dBc3luYyhlKTtcbiAgICAgICAgaWYgKG9wdF9jb2xsZWN0VmFycykge1xuICAgICAgICAgIG9wdF9jb2xsZWN0VmFyc1tuYW1lXSA9ICcnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoJycpO1xuICAgICAgfSk7XG5cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAvLyBSZXBvcnQgZXJyb3IsIGJ1dCBkbyBub3QgZGlzcnVwdCBVUkwgcmVwbGFjZW1lbnQuIFRoaXMgd2lsbFxuICAgICAgLy8gaW50ZXJwb2xhdGUgYXMgdGhlIGVtcHR5IHN0cmluZy5cbiAgICAgIHJldGhyb3dBc3luYyhlKTtcbiAgICAgIGlmIChvcHRfY29sbGVjdFZhcnMpIHtcbiAgICAgICAgb3B0X2NvbGxlY3RWYXJzW25hbWVdID0gJyc7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCcnKTtcbiAgICB9XG4gIH1cblxuXG4gIC8qKlxuICAgKiBSZXNvbHZlcyBiaW5kaW5nIHRvIHZhbHVlIHRvIGJlIHN1YnN0aXR1dGVkIGFzeW5jcm9ub3VzbHkuXG4gICAqIEBwYXJhbSB7Kn0gYmluZGluZyBDb250YWluZXIgZm9yIHN5bmMvYXN5bmMgcmVzb2x1dGlvbnMuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAqIEBwYXJhbSB7P0FycmF5PX0gb3B0X2FyZ3MgQXJndW1lbnRzIHRvIGJlIHBhc3NlZCBpZiBiaW5kaW5nIGlzIGZ1bmN0aW9uLlxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPj19IG9wdF9jb2xsZWN0VmFycyBPYmplY3QgcGFzc2VkIGluIHRvIGNvbGxlY3RcbiAgICogICB2YXJpYWJsZSByZXNvbHV0aW9ucy5cbiAgICogQHJldHVybiB7c3RyaW5nfSBSZXNvbHZlZCB2YWx1ZS5cbiAgICovXG4gIGV2YWx1YXRlQmluZGluZ1N5bmNfKGJpbmRpbmcsIG5hbWUsIG9wdF9hcmdzLCBvcHRfY29sbGVjdFZhcnMpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdmFsdWUgPSB0eXBlb2YgYmluZGluZyA9PT0gJ2Z1bmN0aW9uJyA/XG4gICAgICAgIGJpbmRpbmcuYXBwbHkobnVsbCwgb3B0X2FyZ3MpIDogYmluZGluZztcblxuICAgICAgbGV0IHJlc3VsdDtcblxuICAgICAgaWYgKHZhbHVlICYmIHZhbHVlLnRoZW4pIHtcbiAgICAgICAgLy8gSWYgYmluZGluZyBpcyBwYXNzZWQgaW4gYXMgb3B0X2JpbmRpbmcgd2UgdHJ5IHRvIHJlc29sdmUgaXQgYW5kIGl0XG4gICAgICAgIC8vIG1heSByZXR1cm4gYSBwcm9taXNlLlxuICAgICAgICB1c2VyKCkuZXJyb3IoVEFHLCAnaWdub3JpbmcgYXN5bmMgbWFjcm8gcmVzb2x1dGlvbicpO1xuICAgICAgICByZXN1bHQgPSAnJztcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgIC8vIE5vcm1hbCBjYXNlLlxuICAgICAgICByZXN1bHQgPSBOT0VOQ09ERV9XSElURUxJU1RbbmFtZV0gPyB2YWx1ZS50b1N0cmluZygpIDpcbiAgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoLyoqIEB0eXBlIHtzdHJpbmd9ICovICh2YWx1ZSkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gTW9zdCBsaWtlbHkgYSBicm9rZW4gYmluZGluZyBnZXRzIHVzIGhlcmUuXG4gICAgICAgIHJlc3VsdCA9ICcnO1xuICAgICAgfVxuXG4gICAgICBpZiAob3B0X2NvbGxlY3RWYXJzKSB7XG4gICAgICAgIG9wdF9jb2xsZWN0VmFyc1tuYW1lXSA9IHJlc3VsdDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAvLyBSZXBvcnQgZXJyb3IsIGJ1dCBkbyBub3QgZGlzcnVwdCBVUkwgcmVwbGFjZW1lbnQuIFRoaXMgd2lsbFxuICAgICAgLy8gaW50ZXJwb2xhdGUgYXMgdGhlIGVtcHR5IHN0cmluZy5cbiAgICAgIHJldGhyb3dBc3luYyhlKTtcbiAgICAgIGlmIChvcHRfY29sbGVjdFZhcnMpIHtcbiAgICAgICAgb3B0X2NvbGxlY3RWYXJzW25hbWVdID0gJyc7XG4gICAgICB9XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgQXN5bmNSZXNvbHZlckRlZixcbiAgUmVzb2x2ZXJSZXR1cm5EZWYsXG4gIFN5bmNSZXNvbHZlckRlZixcbiAgVmFyaWFibGVTb3VyY2UsXG4gIGdldE5hdmlnYXRpb25EYXRhLFxuICBnZXRUaW1pbmdEYXRhQXN5bmMsXG4gIGdldFRpbWluZ0RhdGFTeW5jLFxufSBmcm9tICcuL3ZhcmlhYmxlLXNvdXJjZSc7XG5pbXBvcnQge0V4cGFuZGVyLCBOT0VOQ09ERV9XSElURUxJU1R9IGZyb20gJy4vdXJsLWV4cGFuZGVyL2V4cGFuZGVyJztcbmltcG9ydCB7U2VydmljZXN9IGZyb20gJy4uL3NlcnZpY2VzJztcbmltcG9ydCB7V2luZG93SW50ZXJmYWNlfSBmcm9tICcuLi93aW5kb3ctaW50ZXJmYWNlJztcbmltcG9ydCB7XG4gIGFkZFBhcmFtc1RvVXJsLFxuICBnZXRTb3VyY2VVcmwsXG4gIHBhcnNlUXVlcnlTdHJpbmcsXG4gIHBhcnNlVXJsRGVwcmVjYXRlZCxcbiAgcmVtb3ZlQW1wSnNQYXJhbXNGcm9tVXJsLFxuICByZW1vdmVGcmFnbWVudCxcbiAgcmVtb3ZlU2VhcmNoLFxufSBmcm9tICcuLi91cmwnO1xuaW1wb3J0IHtkZXYsIHJldGhyb3dBc3luYywgdXNlcn0gZnJvbSAnLi4vbG9nJztcbmltcG9ydCB7Z2V0VHJhY2tJbXByZXNzaW9uUHJvbWlzZX0gZnJvbSAnLi4vaW1wcmVzc2lvbi5qcyc7XG5pbXBvcnQge2hhc093bn0gZnJvbSAnLi4vdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7XG4gIGluc3RhbGxTZXJ2aWNlSW5FbWJlZFNjb3BlLFxuICByZWdpc3RlclNlcnZpY2VCdWlsZGVyRm9yRG9jLFxufSBmcm9tICcuLi9zZXJ2aWNlJztcbmltcG9ydCB7aXNFeHBlcmltZW50T259IGZyb20gJy4uL2V4cGVyaW1lbnRzJztcbmltcG9ydCB7aXNQcm90b2NvbFZhbGlkfSBmcm9tICcuLi91cmwnO1xuaW1wb3J0IHt0cnlSZXNvbHZlfSBmcm9tICcuLi91dGlscy9wcm9taXNlJztcblxuLyoqIEBwcml2YXRlIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgVEFHID0gJ1VybFJlcGxhY2VtZW50cyc7XG5jb25zdCBFWFBFUklNRU5UX0RFTElNSVRFUiA9ICchJztcbmNvbnN0IFZBUklBTlRfREVMSU1JVEVSID0gJy4nO1xuY29uc3QgR0VPX0RFTElNID0gJywnO1xuY29uc3QgT1JJR0lOQUxfSFJFRl9QUk9QRVJUWSA9ICdhbXAtb3JpZ2luYWwtaHJlZic7XG5jb25zdCBPUklHSU5BTF9WQUxVRV9QUk9QRVJUWSA9ICdhbXAtb3JpZ2luYWwtdmFsdWUnO1xuXG4vKipcbiAqIFJldHVybnMgYSBlbmNvZGVkIFVSSSBDb21wb25lbnQsIG9yIGFuIGVtcHR5IHN0cmluZyBpZiB0aGUgdmFsdWUgaXMgbnVsbGlzaC5cbiAqIEBwYXJhbSB7Kn0gdmFsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGVuY29kZVZhbHVlKHZhbCkge1xuICBpZiAodmFsID09IG51bGwpIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbiAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudCgvKiogQHR5cGUge3N0cmluZ30gKi8odmFsKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgZXhlY3V0ZXMgbWV0aG9kIG9uIGEgbmV3IERhdGUgaW5zdGFuY2UuIFRoaXMgaXMgYVxuICogYnl0ZSBzYXZpbmcgaGFjay5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWV0aG9kXG4gKiBAcmV0dXJuIHshU3luY1Jlc29sdmVyRGVmfVxuICovXG5mdW5jdGlvbiBkYXRlTWV0aG9kKG1ldGhvZCkge1xuICByZXR1cm4gKCkgPT4gbmV3IERhdGUoKVttZXRob2RdKCk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBwcm9wZXJ0eSBvZiBzY3JlZW4uIFRoaXMgaXMgYSBieXRlIHNhdmluZ1xuICogaGFjay5cbiAqXG4gKiBAcGFyYW0geyFTY3JlZW59IHNjcmVlblxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5XG4gKiBAcmV0dXJuIHshU3luY1Jlc29sdmVyRGVmfVxuICovXG5mdW5jdGlvbiBzY3JlZW5Qcm9wZXJ0eShzY3JlZW4sIHByb3BlcnR5KSB7XG4gIHJldHVybiAoKSA9PiBzY3JlZW5bcHJvcGVydHldO1xufVxuXG4vKipcbiAqIENsYXNzIHRvIHByb3ZpZGUgdmFyaWFibGVzIHRoYXQgcGVydGFpbiB0byB0b3AgbGV2ZWwgQU1QIHdpbmRvdy5cbiAqL1xuZXhwb3J0IGNsYXNzIEdsb2JhbFZhcmlhYmxlU291cmNlIGV4dGVuZHMgVmFyaWFibGVTb3VyY2Uge1xuICAvKipcbiAgICogQHBhcmFtIHshLi9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICAgKi9cbiAgY29uc3RydWN0b3IoYW1wZG9jKSB7XG4gICAgc3VwZXIoYW1wZG9jKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P1Byb21pc2U8P09iamVjdDxzdHJpbmcsIHN0cmluZz4+fSAqL1xuICAgIHRoaXMudmFyaWFudHNfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P1Byb21pc2U8P1NoYXJlVHJhY2tpbmdGcmFnbWVudHNEZWY+fSAqL1xuICAgIHRoaXMuc2hhcmVUcmFja2luZ0ZyYWdtZW50c18gPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIFV0aWxpdHkgZnVuY3Rpb24gZm9yIHNldHRpbmcgcmVzb2x2ZXIgZm9yIHRpbWluZyBkYXRhIHRoYXQgc3VwcG9ydHNcbiAgICogc3luYyBhbmQgYXN5bmMuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2YXJOYW1lXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzdGFydEV2ZW50XG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gZW5kRXZlbnRcbiAgICogQHJldHVybiB7IVZhcmlhYmxlU291cmNlfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc2V0VGltaW5nUmVzb2x2ZXJfKHZhck5hbWUsIHN0YXJ0RXZlbnQsIGVuZEV2ZW50KSB7XG4gICAgcmV0dXJuIHRoaXMuc2V0Qm90aCh2YXJOYW1lLCAoKSA9PiB7XG4gICAgICByZXR1cm4gZ2V0VGltaW5nRGF0YVN5bmModGhpcy5hbXBkb2Mud2luLCBzdGFydEV2ZW50LCBlbmRFdmVudCk7XG4gICAgfSwgKCkgPT4ge1xuICAgICAgcmV0dXJuIGdldFRpbWluZ0RhdGFBc3luYyh0aGlzLmFtcGRvYy53aW4sIHN0YXJ0RXZlbnQsIGVuZEV2ZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgaW5pdGlhbGl6ZSgpIHtcbiAgICAvKiogQGNvbnN0IHshLi92aWV3cG9ydC92aWV3cG9ydC1pbXBsLlZpZXdwb3J0fSAqL1xuICAgIGNvbnN0IHZpZXdwb3J0ID0gU2VydmljZXMudmlld3BvcnRGb3JEb2ModGhpcy5hbXBkb2MpO1xuXG4gICAgLy8gUmV0dXJucyBhIHJhbmRvbSB2YWx1ZSBmb3IgY2FjaGUgYnVzdGVycy5cbiAgICB0aGlzLnNldCgnUkFORE9NJywgKCkgPT4gTWF0aC5yYW5kb20oKSk7XG5cbiAgICAvLyBQcm92aWRlcyBhIGNvdW50ZXIgc3RhcnRpbmcgYXQgMSBwZXIgZ2l2ZW4gc2NvcGUuXG4gICAgY29uc3QgY291bnRlclN0b3JlID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICB0aGlzLnNldCgnQ09VTlRFUicsIHNjb3BlID0+IHtcbiAgICAgIHJldHVybiBjb3VudGVyU3RvcmVbc2NvcGVdID0gKGNvdW50ZXJTdG9yZVtzY29wZV0gfCAwKSArIDE7XG4gICAgfSk7XG5cbiAgICAvLyBSZXR1cm5zIHRoZSBjYW5vbmljYWwgVVJMIGZvciB0aGlzIEFNUCBkb2N1bWVudC5cbiAgICB0aGlzLnNldCgnQ0FOT05JQ0FMX1VSTCcsIHRoaXMuZ2V0RG9jSW5mb1VybF8oJ2Nhbm9uaWNhbFVybCcpKTtcblxuICAgIC8vIFJldHVybnMgdGhlIGhvc3Qgb2YgdGhlIGNhbm9uaWNhbCBVUkwgZm9yIHRoaXMgQU1QIGRvY3VtZW50LlxuICAgIHRoaXMuc2V0KCdDQU5PTklDQUxfSE9TVCcsIHRoaXMuZ2V0RG9jSW5mb1VybF8oJ2Nhbm9uaWNhbFVybCcsICdob3N0JykpO1xuXG4gICAgLy8gUmV0dXJucyB0aGUgaG9zdG5hbWUgb2YgdGhlIGNhbm9uaWNhbCBVUkwgZm9yIHRoaXMgQU1QIGRvY3VtZW50LlxuICAgIHRoaXMuc2V0KCdDQU5PTklDQUxfSE9TVE5BTUUnLCB0aGlzLmdldERvY0luZm9VcmxfKCdjYW5vbmljYWxVcmwnLFxuICAgICAgICAnaG9zdG5hbWUnKSk7XG5cbiAgICAvLyBSZXR1cm5zIHRoZSBwYXRoIG9mIHRoZSBjYW5vbmljYWwgVVJMIGZvciB0aGlzIEFNUCBkb2N1bWVudC5cbiAgICB0aGlzLnNldCgnQ0FOT05JQ0FMX1BBVEgnLCB0aGlzLmdldERvY0luZm9VcmxfKCdjYW5vbmljYWxVcmwnLCAncGF0aG5hbWUnKSk7XG5cbiAgICAvLyBSZXR1cm5zIHRoZSByZWZlcnJlciBVUkwuXG4gICAgdGhpcy5zZXRBc3luYygnRE9DVU1FTlRfUkVGRVJSRVInLCAvKiogQHR5cGUge0FzeW5jUmVzb2x2ZXJEZWZ9ICovKCgpID0+IHtcbiAgICAgIHJldHVybiBTZXJ2aWNlcy52aWV3ZXJGb3JEb2ModGhpcy5hbXBkb2MpLmdldFJlZmVycmVyVXJsKCk7XG4gICAgfSkpO1xuXG4gICAgLy8gTGlrZSBET0NVTUVOVF9SRUZFUlJFUiwgYnV0IHJldHVybnMgbnVsbCBpZiB0aGUgcmVmZXJyZXIgaXMgb2ZcbiAgICAvLyBzYW1lIGRvbWFpbiBvciB0aGUgY29ycmVzcG9uZGluZyBDRE4gcHJveHkuXG4gICAgdGhpcy5zZXRBc3luYygnRVhURVJOQUxfUkVGRVJSRVInLCAvKiogQHR5cGUge0FzeW5jUmVzb2x2ZXJEZWZ9ICovKCgpID0+IHtcbiAgICAgIHJldHVybiBTZXJ2aWNlcy52aWV3ZXJGb3JEb2ModGhpcy5hbXBkb2MpLmdldFJlZmVycmVyVXJsKClcbiAgICAgICAgICAudGhlbihyZWZlcnJlciA9PiB7XG4gICAgICAgICAgICBpZiAoIXJlZmVycmVyKSB7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcmVmZXJyZXJIb3N0bmFtZSA9IHBhcnNlVXJsRGVwcmVjYXRlZChnZXRTb3VyY2VVcmwocmVmZXJyZXIpKVxuICAgICAgICAgICAgICAgIC5ob3N0bmFtZTtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRIb3N0bmFtZSA9XG4gICAgICAgICAgICAgICAgV2luZG93SW50ZXJmYWNlLmdldEhvc3RuYW1lKHRoaXMuYW1wZG9jLndpbik7XG4gICAgICAgICAgICByZXR1cm4gcmVmZXJyZXJIb3N0bmFtZSA9PT0gY3VycmVudEhvc3RuYW1lID8gbnVsbCA6IHJlZmVycmVyO1xuICAgICAgICAgIH0pO1xuICAgIH0pKTtcblxuICAgIC8vIFJldHVybnMgdGhlIHRpdGxlIG9mIHRoaXMgQU1QIGRvY3VtZW50LlxuICAgIHRoaXMuc2V0KCdUSVRMRScsICgpID0+IHtcbiAgICAgIC8vIFRoZSBlbnZpcm9ubWVudCBtYXkgb3ZlcnJpZGUgdGhlIHRpdGxlIGFuZCBzZXQgb3JpZ2luYWxUaXRsZS4gUHJlZmVyXG4gICAgICAvLyB0aGF0IGlmIGF2YWlsYWJsZS5cbiAgICAgIHJldHVybiB0aGlzLmFtcGRvYy53aW4uZG9jdW1lbnRbJ29yaWdpbmFsVGl0bGUnXSB8fFxuICAgICAgICAgIHRoaXMuYW1wZG9jLndpbi5kb2N1bWVudC50aXRsZTtcbiAgICB9KTtcblxuICAgIC8vIFJldHVybnMgdGhlIFVSTCBmb3IgdGhpcyBBTVAgZG9jdW1lbnQuXG4gICAgdGhpcy5zZXQoJ0FNUERPQ19VUkwnLCAoKSA9PiB7XG4gICAgICByZXR1cm4gcmVtb3ZlRnJhZ21lbnQoXG4gICAgICAgICAgdGhpcy5hZGRSZXBsYWNlUGFyYW1zSWZNaXNzaW5nXyhcbiAgICAgICAgICAgICAgdGhpcy5hbXBkb2Mud2luLmxvY2F0aW9uLmhyZWYpKTtcbiAgICB9KTtcblxuICAgIC8vIFJldHVybnMgdGhlIGhvc3Qgb2YgdGhlIFVSTCBmb3IgdGhpcyBBTVAgZG9jdW1lbnQuXG4gICAgdGhpcy5zZXQoJ0FNUERPQ19IT1NUJywgKCkgPT4ge1xuICAgICAgY29uc3QgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHRoaXMuYW1wZG9jLndpbi5sb2NhdGlvbi5ocmVmKTtcbiAgICAgIHJldHVybiB1cmwgJiYgdXJsLmhvc3Q7XG4gICAgfSk7XG5cbiAgICAvLyBSZXR1cm5zIHRoZSBob3N0bmFtZSBvZiB0aGUgVVJMIGZvciB0aGlzIEFNUCBkb2N1bWVudC5cbiAgICB0aGlzLnNldCgnQU1QRE9DX0hPU1ROQU1FJywgKCkgPT4ge1xuICAgICAgY29uc3QgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHRoaXMuYW1wZG9jLndpbi5sb2NhdGlvbi5ocmVmKTtcbiAgICAgIHJldHVybiB1cmwgJiYgdXJsLmhvc3RuYW1lO1xuICAgIH0pO1xuXG4gICAgLy8gUmV0dXJucyB0aGUgU291cmNlIFVSTCBmb3IgdGhpcyBBTVAgZG9jdW1lbnQuXG4gICAgY29uc3QgZXhwYW5kU291cmNlVXJsID0gKCkgPT4ge1xuICAgICAgY29uc3QgZG9jSW5mbyA9IFNlcnZpY2VzLmRvY3VtZW50SW5mb0ZvckRvYyh0aGlzLmFtcGRvYyk7XG4gICAgICByZXR1cm4gcmVtb3ZlRnJhZ21lbnQodGhpcy5hZGRSZXBsYWNlUGFyYW1zSWZNaXNzaW5nXyhkb2NJbmZvLnNvdXJjZVVybCkpO1xuICAgIH07XG4gICAgdGhpcy5zZXRCb3RoKCdTT1VSQ0VfVVJMJyxcbiAgICAgICAgKCkgPT4gZXhwYW5kU291cmNlVXJsKCksXG4gICAgICAgICgpID0+IGdldFRyYWNrSW1wcmVzc2lvblByb21pc2UoKS50aGVuKCgpID0+IGV4cGFuZFNvdXJjZVVybCgpKSk7XG5cbiAgICAvLyBSZXR1cm5zIHRoZSBob3N0IG9mIHRoZSBTb3VyY2UgVVJMIGZvciB0aGlzIEFNUCBkb2N1bWVudC5cbiAgICB0aGlzLnNldCgnU09VUkNFX0hPU1QnLCB0aGlzLmdldERvY0luZm9VcmxfKCdzb3VyY2VVcmwnLCAnaG9zdCcpKTtcblxuICAgIC8vIFJldHVybnMgdGhlIGhvc3RuYW1lIG9mIHRoZSBTb3VyY2UgVVJMIGZvciB0aGlzIEFNUCBkb2N1bWVudC5cbiAgICB0aGlzLnNldCgnU09VUkNFX0hPU1ROQU1FJywgdGhpcy5nZXREb2NJbmZvVXJsXygnc291cmNlVXJsJywgJ2hvc3RuYW1lJykpO1xuXG4gICAgLy8gUmV0dXJucyB0aGUgcGF0aCBvZiB0aGUgU291cmNlIFVSTCBmb3IgdGhpcyBBTVAgZG9jdW1lbnQuXG4gICAgdGhpcy5zZXQoJ1NPVVJDRV9QQVRIJywgdGhpcy5nZXREb2NJbmZvVXJsXygnc291cmNlVXJsJywgJ3BhdGhuYW1lJykpO1xuXG4gICAgLy8gUmV0dXJucyBhIHJhbmRvbSBzdHJpbmcgdGhhdCB3aWxsIGJlIHRoZSBjb25zdGFudCBmb3IgdGhlIGR1cmF0aW9uIG9mXG4gICAgLy8gc2luZ2xlIHBhZ2Ugdmlldy4gSXQgc2hvdWxkIGhhdmUgc3VmZmljaWVudCBlbnRyb3B5IHRvIGJlIHVuaXF1ZSBmb3JcbiAgICAvLyBhbGwgdGhlIHBhZ2Ugdmlld3MgYSBzaW5nbGUgdXNlciBpcyBtYWtpbmcgYXQgYSB0aW1lLlxuICAgIHRoaXMuc2V0KCdQQUdFX1ZJRVdfSUQnLCB0aGlzLmdldERvY0luZm9VcmxfKCdwYWdlVmlld0lkJykpO1xuXG4gICAgdGhpcy5zZXRCb3RoKCdRVUVSWV9QQVJBTScsIChwYXJhbSwgZGVmYXVsdFZhbHVlID0gJycpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmdldFF1ZXJ5UGFyYW1EYXRhXyhwYXJhbSwgZGVmYXVsdFZhbHVlKTtcbiAgICB9LCAocGFyYW0sIGRlZmF1bHRWYWx1ZSA9ICcnKSA9PiB7XG4gICAgICByZXR1cm4gZ2V0VHJhY2tJbXByZXNzaW9uUHJvbWlzZSgpLnRoZW4oKCkgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRRdWVyeVBhcmFtRGF0YV8ocGFyYW0sIGRlZmF1bHRWYWx1ZSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBnaXZlbiBmaWVsZCBuYW1lIGluIHRoZSBmcmFnbWVudCBxdWVyeSBzdHJpbmcuXG4gICAgLy8gU2Vjb25kIHBhcmFtZXRlciBpcyBhbiBvcHRpb25hbCBkZWZhdWx0IHZhbHVlLlxuICAgIC8vIEZvciBleGFtcGxlLCBpZiBsb2NhdGlvbiBpcyAncHViLmNvbS9hbXAuaHRtbD94PTEjeT0yJyB0aGVuXG4gICAgLy8gRlJBR01FTlRfUEFSQU0oeSkgcmV0dXJucyAnMicgYW5kIEZSQUdNRU5UX1BBUkFNKHosIDMpIHJldHVybnMgMy5cbiAgICB0aGlzLnNldEFzeW5jKCdGUkFHTUVOVF9QQVJBTScsXG4gICAgICAgIHRoaXMuZ2V0Vmlld2VySW50ZWdyYXRpb25WYWx1ZV8oJ2ZyYWdtZW50UGFyYW0nLCAnRlJBR01FTlRfUEFSQU0nKSk7XG5cbiAgICAvLyBSZXR1cm5zIHRoZSBmaXJzdCBpdGVtIGluIHRoZSBhbmNlc3Rvck9yaWdpbnMgYXJyYXksIGlmIGF2YWlsYWJsZS5cbiAgICB0aGlzLnNldEFzeW5jKCdBTkNFU1RPUl9PUklHSU4nLFxuICAgICAgICB0aGlzLmdldFZpZXdlckludGVncmF0aW9uVmFsdWVfKCdhbmNlc3Rvck9yaWdpbicsICdBTkNFU1RPUl9PUklHSU4nKSk7XG5cbiAgICAvKipcbiAgICAgKiBTdG9yZXMgY2xpZW50IGlkcyB0aGF0IHdlcmUgZ2VuZXJhdGVkIGR1cmluZyB0aGlzIHBhZ2Ugdmlld1xuICAgICAqIGluZGV4ZWQgYnkgc2NvcGUuXG4gICAgICogQHR5cGUgez9PYmplY3Q8c3RyaW5nLCBzdHJpbmc+fVxuICAgICAqL1xuICAgIGxldCBjbGllbnRJZHMgPSBudWxsO1xuICAgIC8vIFN5bmNocm9ub3VzIGFsdGVybmF0aXZlLiBPbmx5IHdvcmtzIGZvciBzY29wZXMgdGhhdCB3ZXJlIHByZXZpb3VzbHlcbiAgICAvLyByZXF1ZXN0ZWQgdXNpbmcgdGhlIGFzeW5jIG1ldGhvZC5cbiAgICB0aGlzLnNldEJvdGgoJ0NMSUVOVF9JRCcsIHNjb3BlID0+IHtcbiAgICAgIGlmICghY2xpZW50SWRzKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNsaWVudElkc1tkZXYoKS5hc3NlcnRTdHJpbmcoc2NvcGUpXTtcbiAgICB9LCAoc2NvcGUsIG9wdF91c2VyTm90aWZpY2F0aW9uSWQsIG9wdF9jb29raWVOYW1lKSA9PiB7XG4gICAgICB1c2VyKCkuYXNzZXJ0U3RyaW5nKHNjb3BlLFxuICAgICAgICAgICdUaGUgZmlyc3QgYXJndW1lbnQgdG8gQ0xJRU5UX0lELCB0aGUgZmFsbGJhY2snICtcbiAgICAgICAgICAvKk9LKi8nIENvb2tpZSBuYW1lLCBpcyByZXF1aXJlZCcpO1xuICAgICAgbGV0IGNvbnNlbnQgPSBQcm9taXNlLnJlc29sdmUoKTtcblxuICAgICAgLy8gSWYgbm8gYG9wdF91c2VyTm90aWZpY2F0aW9uSWRgIGFyZ3VtZW50IGlzIHByb3ZpZGVkIHRoZW5cbiAgICAgIC8vIGFzc3VtZSBjb25zZW50IGlzIGdpdmVuIGJ5IGRlZmF1bHQuXG4gICAgICBpZiAob3B0X3VzZXJOb3RpZmljYXRpb25JZCkge1xuICAgICAgICBjb25zZW50ID0gU2VydmljZXMudXNlck5vdGlmaWNhdGlvbk1hbmFnZXJGb3JEb2ModGhpcy5hbXBkb2MpXG4gICAgICAgICAgICAudGhlbihzZXJ2aWNlID0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2UuZ2V0KG9wdF91c2VyTm90aWZpY2F0aW9uSWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gU2VydmljZXMuY2lkRm9yRG9jKHRoaXMuYW1wZG9jKS50aGVuKGNpZCA9PiB7XG4gICAgICAgIHJldHVybiBjaWQuZ2V0KHtcbiAgICAgICAgICBzY29wZTogZGV2KCkuYXNzZXJ0U3RyaW5nKHNjb3BlKSxcbiAgICAgICAgICBjcmVhdGVDb29raWVJZk5vdFByZXNlbnQ6IHRydWUsXG4gICAgICAgICAgY29va2llTmFtZTogb3B0X2Nvb2tpZU5hbWUsXG4gICAgICAgIH0sIGNvbnNlbnQpO1xuICAgICAgfSkudGhlbihjaWQgPT4ge1xuICAgICAgICBpZiAoIWNsaWVudElkcykge1xuICAgICAgICAgIGNsaWVudElkcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBIHRlbXBvcmFyeSB3b3JrIGFyb3VuZCB0byBleHRyYWN0IENsaWVudCBJRCBmcm9tIF9nYSBjb29raWUuICM1NzYxXG4gICAgICAgIC8vIFRPRE86IHJlcGxhY2Ugd2l0aCBcImZpbHRlclwiIHdoZW4gaXQncyBpbiBwbGFjZS4gIzIxOThcbiAgICAgICAgY29uc3QgY29va2llTmFtZSA9IG9wdF9jb29raWVOYW1lIHx8IHNjb3BlO1xuICAgICAgICBpZiAoY2lkICYmIGNvb2tpZU5hbWUgPT0gJ19nYScpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGNpZCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNpZCA9IGV4dHJhY3RDbGllbnRJZEZyb21HYUNvb2tpZShjaWQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBUT0RPKEBqcmlkZ2V3ZWxsLCAjMTExMjApOiByZW1vdmUgb25jZSAjMTExMjAgaXMgZmlndXJlZCBvdXQuXG4gICAgICAgICAgICAvLyBEbyBub3QgbG9nIHRoZSBDSUQgZGlyZWN0bHksIHRoYXQncyBQSUkuXG4gICAgICAgICAgICBkZXYoKS5lcnJvcihUQUcsICdub24tc3RyaW5nIGNpZCwgd2hhdCBpcyBpdD8nLCBPYmplY3Qua2V5cyhjaWQpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjbGllbnRJZHNbc2NvcGVdID0gY2lkO1xuICAgICAgICByZXR1cm4gY2lkO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBSZXR1cm5zIGFzc2lnbmVkIHZhcmlhbnQgbmFtZSBmb3IgdGhlIGdpdmVuIGV4cGVyaW1lbnQuXG4gICAgdGhpcy5zZXRBc3luYygnVkFSSUFOVCcsIC8qKiBAdHlwZSB7QXN5bmNSZXNvbHZlckRlZn0gKi8oZXhwZXJpbWVudCA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRWYXJpYW50c1ZhbHVlXyh2YXJpYW50cyA9PiB7XG4gICAgICAgIGNvbnN0IHZhcmlhbnQgPSB2YXJpYW50c1svKiogQHR5cGUge3N0cmluZ30gKi8oZXhwZXJpbWVudCldO1xuICAgICAgICB1c2VyKCkuYXNzZXJ0KHZhcmlhbnQgIT09IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICdUaGUgdmFsdWUgcGFzc2VkIHRvIFZBUklBTlQoKSBpcyBub3QgYSB2YWxpZCBleHBlcmltZW50IG5hbWU6JyArXG4gICAgICAgICAgICAgICAgZXhwZXJpbWVudCk7XG4gICAgICAgIC8vIFdoZW4gbm8gdmFyaWFudCBhc3NpZ25lZCwgdXNlIHJlc2VydmVkIGtleXdvcmQgJ25vbmUnLlxuICAgICAgICByZXR1cm4gdmFyaWFudCA9PT0gbnVsbCA/ICdub25lJyA6IC8qKiBAdHlwZSB7c3RyaW5nfSAqLyh2YXJpYW50KTtcbiAgICAgIH0sICdWQVJJQU5UJyk7XG4gICAgfSkpO1xuXG4gICAgLy8gUmV0dXJucyBhbGwgYXNzaWduZWQgZXhwZXJpbWVudCB2YXJpYW50cyBpbiBhIHNlcmlhbGl6ZWQgZm9ybS5cbiAgICB0aGlzLnNldEFzeW5jKCdWQVJJQU5UUycsIC8qKiBAdHlwZSB7QXN5bmNSZXNvbHZlckRlZn0gKi8oKCkgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0VmFyaWFudHNWYWx1ZV8odmFyaWFudHMgPT4ge1xuICAgICAgICBjb25zdCBleHBlcmltZW50cyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGV4cGVyaW1lbnQgaW4gdmFyaWFudHMpIHtcbiAgICAgICAgICBjb25zdCB2YXJpYW50ID0gdmFyaWFudHNbZXhwZXJpbWVudF07XG4gICAgICAgICAgZXhwZXJpbWVudHMucHVzaChcbiAgICAgICAgICAgICAgZXhwZXJpbWVudCArIFZBUklBTlRfREVMSU1JVEVSICsgKHZhcmlhbnQgfHwgJ25vbmUnKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGV4cGVyaW1lbnRzLmpvaW4oRVhQRVJJTUVOVF9ERUxJTUlURVIpO1xuICAgICAgfSwgJ1ZBUklBTlRTJyk7XG4gICAgfSkpO1xuXG4gICAgLy8gUmV0dXJucyBhc3NpZ25lZCBnZW8gdmFsdWUgZm9yIGdlb1R5cGUgb3IgYWxsIGdyb3Vwcy5cbiAgICB0aGlzLnNldEFzeW5jKCdBTVBfR0VPJywgLyoqIEB0eXBlIHtBc3luY1Jlc29sdmVyRGVmfSAqLyhnZW9UeXBlID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmdldEdlb18oZ2VvcyA9PiB7XG4gICAgICAgIGlmIChnZW9UeXBlKSB7XG4gICAgICAgICAgdXNlcigpLmFzc2VydChnZW9UeXBlID09PSAnSVNPQ291bnRyeScsXG4gICAgICAgICAgICAgICdUaGUgdmFsdWUgcGFzc2VkIHRvIEFNUF9HRU8oKSBpcyBub3QgdmFsaWQgbmFtZTonICsgZ2VvVHlwZSk7XG4gICAgICAgICAgcmV0dXJuIC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAoZ2Vvc1tnZW9UeXBlXSB8fCAndW5rbm93bicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAvKiogQHR5cGUge3N0cmluZ30gKi8gKGdlb3MuSVNPQ291bnRyeUdyb3Vwcy5qb2luKEdFT19ERUxJTSkpO1xuICAgICAgfSwgJ0FNUF9HRU8nKTtcbiAgICB9KSk7XG5cbiAgICAvLyBSZXR1cm5zIGluY29taW5nIHNoYXJlIHRyYWNraW5nIGZyYWdtZW50LlxuICAgIHRoaXMuc2V0QXN5bmMoJ1NIQVJFX1RSQUNLSU5HX0lOQ09NSU5HJywgLyoqIEB0eXBlIHtBc3luY1Jlc29sdmVyRGVmfSAqLyhcbiAgICAgICgpID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U2hhcmVUcmFja2luZ1ZhbHVlXyhmcmFnbWVudHMgPT4ge1xuICAgICAgICAgIHJldHVybiBmcmFnbWVudHMuaW5jb21pbmdGcmFnbWVudDtcbiAgICAgICAgfSwgJ1NIQVJFX1RSQUNLSU5HX0lOQ09NSU5HJyk7XG4gICAgICB9KSk7XG5cbiAgICAvLyBSZXR1cm5zIG91dGdvaW5nIHNoYXJlIHRyYWNraW5nIGZyYWdtZW50LlxuICAgIHRoaXMuc2V0QXN5bmMoJ1NIQVJFX1RSQUNLSU5HX09VVEdPSU5HJywgLyoqIEB0eXBlIHtBc3luY1Jlc29sdmVyRGVmfSAqLyhcbiAgICAgICgpID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U2hhcmVUcmFja2luZ1ZhbHVlXyhmcmFnbWVudHMgPT4ge1xuICAgICAgICAgIHJldHVybiBmcmFnbWVudHMub3V0Z29pbmdGcmFnbWVudDtcbiAgICAgICAgfSwgJ1NIQVJFX1RSQUNLSU5HX09VVEdPSU5HJyk7XG4gICAgICB9KSk7XG5cbiAgICAvLyBSZXR1cm5zIHRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHNpbmNlIDEgSmFuIDE5NzAgMDA6MDA6MDAgVVRDLlxuICAgIHRoaXMuc2V0KCdUSU1FU1RBTVAnLCBkYXRlTWV0aG9kKCdnZXRUaW1lJykpO1xuXG4gICAgLy8gUmV0dXJucyB0aGUgaHVtYW4gcmVhZGFibGUgdGltZXN0YW1wIGluIGZvcm1hdCBvZlxuICAgIC8vIDIwMTEtMDEtMDFUMTE6MTE6MTEuNjEyWi5cbiAgICB0aGlzLnNldCgnVElNRVNUQU1QX0lTTycsIGRhdGVNZXRob2QoJ3RvSVNPU3RyaW5nJykpO1xuXG4gICAgLy8gUmV0dXJucyB0aGUgdXNlcidzIHRpbWUtem9uZSBvZmZzZXQgZnJvbSBVVEMsIGluIG1pbnV0ZXMuXG4gICAgdGhpcy5zZXQoJ1RJTUVaT05FJywgZGF0ZU1ldGhvZCgnZ2V0VGltZXpvbmVPZmZzZXQnKSk7XG5cbiAgICAvLyBSZXR1cm5zIHRoZSBJQU5BIHRpbWV6b25lIGNvZGVcbiAgICB0aGlzLnNldCgnVElNRVpPTkVfQ09ERScsICgpID0+IHtcbiAgICAgIGxldCB0ekNvZGU7XG4gICAgICBpZiAoJ0ludGwnIGluIHRoaXMuYW1wZG9jLndpbiAmJlxuICAgICAgICAnRGF0ZVRpbWVGb3JtYXQnIGluIHRoaXMuYW1wZG9jLndpbi5JbnRsKSB7XG4gICAgICAgIC8vIEl0IGNvdWxkIGJlIHVuZGVmaW5lZCAoaS5lLiBJRTExKVxuICAgICAgICB0ekNvZGUgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdCgpLnJlc29sdmVkT3B0aW9ucygpLnRpbWVab25lO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdHpDb2RlIHx8ICcnO1xuICAgIH0pO1xuXG4gICAgLy8gUmV0dXJucyBhIHByb21pc2UgcmVzb2x2aW5nIHRvIHZpZXdwb3J0LmdldFNjcm9sbFRvcC5cbiAgICB0aGlzLnNldCgnU0NST0xMX1RPUCcsICgpID0+IHZpZXdwb3J0LmdldFNjcm9sbFRvcCgpKTtcblxuICAgIC8vIFJldHVybnMgYSBwcm9taXNlIHJlc29sdmluZyB0byB2aWV3cG9ydC5nZXRTY3JvbGxMZWZ0LlxuICAgIHRoaXMuc2V0KCdTQ1JPTExfTEVGVCcsICgpID0+IHZpZXdwb3J0LmdldFNjcm9sbExlZnQoKSk7XG5cbiAgICAvLyBSZXR1cm5zIGEgcHJvbWlzZSByZXNvbHZpbmcgdG8gdmlld3BvcnQuZ2V0U2Nyb2xsSGVpZ2h0LlxuICAgIHRoaXMuc2V0KCdTQ1JPTExfSEVJR0hUJywgKCkgPT4gdmlld3BvcnQuZ2V0U2Nyb2xsSGVpZ2h0KCkpO1xuXG4gICAgLy8gUmV0dXJucyBhIHByb21pc2UgcmVzb2x2aW5nIHRvIHZpZXdwb3J0LmdldFNjcm9sbFdpZHRoLlxuICAgIHRoaXMuc2V0KCdTQ1JPTExfV0lEVEgnLCAoKSA9PiB2aWV3cG9ydC5nZXRTY3JvbGxXaWR0aCgpKTtcblxuICAgIC8vIFJldHVybnMgdGhlIHZpZXdwb3J0IGhlaWdodC5cbiAgICB0aGlzLnNldCgnVklFV1BPUlRfSEVJR0hUJywgKCkgPT4gdmlld3BvcnQuZ2V0SGVpZ2h0KCkpO1xuXG4gICAgLy8gUmV0dXJucyB0aGUgdmlld3BvcnQgd2lkdGguXG4gICAgdGhpcy5zZXQoJ1ZJRVdQT1JUX1dJRFRIJywgKCkgPT4gdmlld3BvcnQuZ2V0V2lkdGgoKSk7XG5cblxuICAgIGNvbnN0IHtzY3JlZW59ID0gdGhpcy5hbXBkb2Mud2luO1xuICAgIC8vIFJldHVybnMgc2NyZWVuLndpZHRoLlxuICAgIHRoaXMuc2V0KCdTQ1JFRU5fV0lEVEgnLCBzY3JlZW5Qcm9wZXJ0eShzY3JlZW4sICd3aWR0aCcpKTtcblxuICAgIC8vIFJldHVybnMgc2NyZWVuLmhlaWdodC5cbiAgICB0aGlzLnNldCgnU0NSRUVOX0hFSUdIVCcsIHNjcmVlblByb3BlcnR5KHNjcmVlbiwgJ2hlaWdodCcpKTtcblxuICAgIC8vIFJldHVybnMgc2NyZWVuLmF2YWlsSGVpZ2h0LlxuICAgIHRoaXMuc2V0KCdBVkFJTEFCTEVfU0NSRUVOX0hFSUdIVCcsIHNjcmVlblByb3BlcnR5KHNjcmVlbiwgJ2F2YWlsSGVpZ2h0JykpO1xuXG4gICAgLy8gUmV0dXJucyBzY3JlZW4uYXZhaWxXaWR0aC5cbiAgICB0aGlzLnNldCgnQVZBSUxBQkxFX1NDUkVFTl9XSURUSCcsIHNjcmVlblByb3BlcnR5KHNjcmVlbiwgJ2F2YWlsV2lkdGgnKSk7XG5cbiAgICAvLyBSZXR1cm5zIHNjcmVlbi5Db2xvckRlcHRoLlxuICAgIHRoaXMuc2V0KCdTQ1JFRU5fQ09MT1JfREVQVEgnLCBzY3JlZW5Qcm9wZXJ0eShzY3JlZW4sICdjb2xvckRlcHRoJykpO1xuXG4gICAgLy8gUmV0dXJucyBkb2N1bWVudCBjaGFyYWN0ZXJzZXQuXG4gICAgdGhpcy5zZXQoJ0RPQ1VNRU5UX0NIQVJTRVQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBkb2MgPSB0aGlzLmFtcGRvYy53aW4uZG9jdW1lbnQ7XG4gICAgICByZXR1cm4gZG9jLmNoYXJhY3RlclNldCB8fCBkb2MuY2hhcnNldDtcbiAgICB9KTtcblxuICAgIC8vIFJldHVybnMgdGhlIGJyb3dzZXIgbGFuZ3VhZ2UuXG4gICAgdGhpcy5zZXQoJ0JST1dTRVJfTEFOR1VBR0UnLCAoKSA9PiB7XG4gICAgICBjb25zdCBuYXYgPSB0aGlzLmFtcGRvYy53aW4ubmF2aWdhdG9yO1xuICAgICAgcmV0dXJuIChuYXYubGFuZ3VhZ2UgfHwgbmF2LnVzZXJMYW5ndWFnZSB8fCBuYXYuYnJvd3Nlckxhbmd1YWdlIHx8ICcnKVxuICAgICAgICAgIC50b0xvd2VyQ2FzZSgpO1xuICAgIH0pO1xuXG4gICAgLy8gUmV0dXJucyB0aGUgdXNlciBhZ2VudC5cbiAgICB0aGlzLnNldCgnVVNFUl9BR0VOVCcsICgpID0+IHtcbiAgICAgIGNvbnN0IG5hdiA9IHRoaXMuYW1wZG9jLndpbi5uYXZpZ2F0b3I7XG4gICAgICByZXR1cm4gbmF2LnVzZXJBZ2VudDtcbiAgICB9KTtcblxuICAgIC8vIFJldHVybnMgdGhlIHRpbWUgaXQgdG9vayB0byBsb2FkIHRoZSB3aG9sZSBwYWdlLiAoZXhjbHVkZXMgYW1wLSogZWxlbWVudHNcbiAgICAvLyB0aGF0IGFyZSBub3QgcmVuZGVyZWQgYnkgdGhlIHN5c3RlbSB5ZXQuKVxuICAgIHRoaXMuc2V0VGltaW5nUmVzb2x2ZXJfKFxuICAgICAgICAnUEFHRV9MT0FEX1RJTUUnLCAnbmF2aWdhdGlvblN0YXJ0JywgJ2xvYWRFdmVudFN0YXJ0Jyk7XG5cbiAgICAvLyBSZXR1cm5zIHRoZSB0aW1lIGl0IHRvb2sgdG8gcGVyZm9ybSBETlMgbG9va3VwIGZvciB0aGUgZG9tYWluLlxuICAgIHRoaXMuc2V0VGltaW5nUmVzb2x2ZXJfKFxuICAgICAgICAnRE9NQUlOX0xPT0tVUF9USU1FJywgJ2RvbWFpbkxvb2t1cFN0YXJ0JywgJ2RvbWFpbkxvb2t1cEVuZCcpO1xuXG4gICAgLy8gUmV0dXJucyB0aGUgdGltZSBpdCB0b29rIHRvIGNvbm5lY3QgdG8gdGhlIHNlcnZlci5cbiAgICB0aGlzLnNldFRpbWluZ1Jlc29sdmVyXyhcbiAgICAgICAgJ1RDUF9DT05ORUNUX1RJTUUnLCAnY29ubmVjdFN0YXJ0JywgJ2Nvbm5lY3RFbmQnKTtcblxuICAgIC8vIFJldHVybnMgdGhlIHRpbWUgaXQgdG9vayBmb3Igc2VydmVyIHRvIHN0YXJ0IHNlbmRpbmcgYSByZXNwb25zZSB0byB0aGVcbiAgICAvLyByZXF1ZXN0LlxuICAgIHRoaXMuc2V0VGltaW5nUmVzb2x2ZXJfKFxuICAgICAgICAnU0VSVkVSX1JFU1BPTlNFX1RJTUUnLCAncmVxdWVzdFN0YXJ0JywgJ3Jlc3BvbnNlU3RhcnQnKTtcblxuICAgIC8vIFJldHVybnMgdGhlIHRpbWUgaXQgdG9vayB0byBkb3dubG9hZCB0aGUgcGFnZS5cbiAgICB0aGlzLnNldFRpbWluZ1Jlc29sdmVyXyhcbiAgICAgICAgJ1BBR0VfRE9XTkxPQURfVElNRScsICdyZXNwb25zZVN0YXJ0JywgJ3Jlc3BvbnNlRW5kJyk7XG5cbiAgICAvLyBSZXR1cm5zIHRoZSB0aW1lIGl0IHRvb2sgZm9yIHJlZGlyZWN0cyB0byBjb21wbGV0ZS5cbiAgICB0aGlzLnNldFRpbWluZ1Jlc29sdmVyXyhcbiAgICAgICAgJ1JFRElSRUNUX1RJTUUnLCAnbmF2aWdhdGlvblN0YXJ0JywgJ2ZldGNoU3RhcnQnKTtcblxuICAgIC8vIFJldHVybnMgdGhlIHRpbWUgaXQgdG9vayBmb3IgRE9NIHRvIGJlY29tZSBpbnRlcmFjdGl2ZS5cbiAgICB0aGlzLnNldFRpbWluZ1Jlc29sdmVyXyhcbiAgICAgICAgJ0RPTV9JTlRFUkFDVElWRV9USU1FJywgJ25hdmlnYXRpb25TdGFydCcsICdkb21JbnRlcmFjdGl2ZScpO1xuXG4gICAgLy8gUmV0dXJucyB0aGUgdGltZSBpdCB0b29rIGZvciBjb250ZW50IHRvIGxvYWQuXG4gICAgdGhpcy5zZXRUaW1pbmdSZXNvbHZlcl8oXG4gICAgICAgICdDT05URU5UX0xPQURfVElNRScsICduYXZpZ2F0aW9uU3RhcnQnLCAnZG9tQ29udGVudExvYWRlZEV2ZW50U3RhcnQnKTtcblxuICAgIC8vIEFjY2VzczogUmVhZGVyIElELlxuICAgIHRoaXMuc2V0QXN5bmMoJ0FDQ0VTU19SRUFERVJfSUQnLCAvKiogQHR5cGUge0FzeW5jUmVzb2x2ZXJEZWZ9ICovKCgpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmdldEFjY2Vzc1ZhbHVlXyhhY2Nlc3NTZXJ2aWNlID0+IHtcbiAgICAgICAgcmV0dXJuIGFjY2Vzc1NlcnZpY2UuZ2V0QWNjZXNzUmVhZGVySWQoKTtcbiAgICAgIH0sICdBQ0NFU1NfUkVBREVSX0lEJyk7XG4gICAgfSkpO1xuXG4gICAgLy8gQWNjZXNzOiBkYXRhIGZyb20gdGhlIGF1dGhvcml6YXRpb24gcmVzcG9uc2UuXG4gICAgdGhpcy5zZXRBc3luYygnQVVUSERBVEEnLCAvKiogQHR5cGUge0FzeW5jUmVzb2x2ZXJEZWZ9ICovKGZpZWxkID0+IHtcbiAgICAgIHVzZXIoKS5hc3NlcnQoZmllbGQsXG4gICAgICAgICAgJ1RoZSBmaXJzdCBhcmd1bWVudCB0byBBVVRIREFUQSwgdGhlIGZpZWxkLCBpcyByZXF1aXJlZCcpO1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0QWNjZXNzVmFsdWVfKGFjY2Vzc1NlcnZpY2UgPT4ge1xuICAgICAgICByZXR1cm4gYWNjZXNzU2VydmljZS5nZXRBdXRoZGF0YUZpZWxkKGZpZWxkKTtcbiAgICAgIH0sICdBVVRIREFUQScpO1xuICAgIH0pKTtcblxuICAgIC8vIFJldHVybnMgYW4gaWRlbnRpZmllciBmb3IgdGhlIHZpZXdlci5cbiAgICB0aGlzLnNldEFzeW5jKCdWSUVXRVInLCAoKSA9PiB7XG4gICAgICByZXR1cm4gU2VydmljZXMudmlld2VyRm9yRG9jKHRoaXMuYW1wZG9jKVxuICAgICAgICAgIC5nZXRWaWV3ZXJPcmlnaW4oKS50aGVuKHZpZXdlciA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdmlld2VyID09IHVuZGVmaW5lZCA/ICcnIDogdmlld2VyO1xuICAgICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gUmV0dXJucyB0aGUgdG90YWwgZW5nYWdlZCB0aW1lIHNpbmNlIHRoZSBjb250ZW50IGJlY2FtZSB2aWV3YWJsZS5cbiAgICB0aGlzLnNldEFzeW5jKCdUT1RBTF9FTkdBR0VEX1RJTUUnLCAoKSA9PiB7XG4gICAgICByZXR1cm4gU2VydmljZXMuYWN0aXZpdHlGb3JEb2ModGhpcy5hbXBkb2MpLnRoZW4oYWN0aXZpdHkgPT4ge1xuICAgICAgICByZXR1cm4gYWN0aXZpdHkuZ2V0VG90YWxFbmdhZ2VkVGltZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBSZXR1cm5zIHRoZSBpbmNyZW1lbnRhbCBlbmdhZ2VkIHRpbWUgc2luY2UgdGhlIGxhc3QgcHVzaCB1bmRlciB0aGVcbiAgICAvLyBzYW1lIG5hbWUuXG4gICAgdGhpcy5zZXRBc3luYygnSU5DUkVNRU5UQUxfRU5HQUdFRF9USU1FJywgKG5hbWUsIHJlc2V0KSA9PiB7XG4gICAgICByZXR1cm4gU2VydmljZXMuYWN0aXZpdHlGb3JEb2ModGhpcy5hbXBkb2MpLnRoZW4oYWN0aXZpdHkgPT4ge1xuICAgICAgICByZXR1cm4gYWN0aXZpdHkuZ2V0SW5jcmVtZW50YWxFbmdhZ2VkVGltZShuYW1lLCByZXNldCAhPT0gJ2ZhbHNlJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRoaXMuc2V0KCdOQVZfVElNSU5HJywgKHN0YXJ0QXR0cmlidXRlLCBlbmRBdHRyaWJ1dGUpID0+IHtcbiAgICAgIHVzZXIoKS5hc3NlcnQoc3RhcnRBdHRyaWJ1dGUsICdUaGUgZmlyc3QgYXJndW1lbnQgdG8gTkFWX1RJTUlORywgdGhlICcgK1xuICAgICAgICAgICdzdGFydCBhdHRyaWJ1dGUgbmFtZSwgaXMgcmVxdWlyZWQnKTtcbiAgICAgIHJldHVybiBnZXRUaW1pbmdEYXRhU3luYyhcbiAgICAgICAgICB0aGlzLmFtcGRvYy53aW4sXG4gICAgICAgICAgLyoqQHR5cGUge3N0cmluZ30qLyhzdGFydEF0dHJpYnV0ZSksXG4gICAgICAgICAgLyoqQHR5cGUge3N0cmluZ30qLyhlbmRBdHRyaWJ1dGUpKTtcbiAgICB9KTtcbiAgICB0aGlzLnNldEFzeW5jKCdOQVZfVElNSU5HJywgKHN0YXJ0QXR0cmlidXRlLCBlbmRBdHRyaWJ1dGUpID0+IHtcbiAgICAgIHVzZXIoKS5hc3NlcnQoc3RhcnRBdHRyaWJ1dGUsICdUaGUgZmlyc3QgYXJndW1lbnQgdG8gTkFWX1RJTUlORywgdGhlICcgK1xuICAgICAgICAgICdzdGFydCBhdHRyaWJ1dGUgbmFtZSwgaXMgcmVxdWlyZWQnKTtcbiAgICAgIHJldHVybiBnZXRUaW1pbmdEYXRhQXN5bmMoXG4gICAgICAgICAgdGhpcy5hbXBkb2Mud2luLFxuICAgICAgICAgIC8qKkB0eXBlIHtzdHJpbmd9Ki8oc3RhcnRBdHRyaWJ1dGUpLFxuICAgICAgICAgIC8qKkB0eXBlIHtzdHJpbmd9Ki8oZW5kQXR0cmlidXRlKSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnNldCgnTkFWX1RZUEUnLCAoKSA9PiB7XG4gICAgICByZXR1cm4gZ2V0TmF2aWdhdGlvbkRhdGEodGhpcy5hbXBkb2Mud2luLCAndHlwZScpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5zZXQoJ05BVl9SRURJUkVDVF9DT1VOVCcsICgpID0+IHtcbiAgICAgIHJldHVybiBnZXROYXZpZ2F0aW9uRGF0YSh0aGlzLmFtcGRvYy53aW4sICdyZWRpcmVjdENvdW50Jyk7XG4gICAgfSk7XG5cbiAgICAvLyByZXR1cm5zIHRoZSBBTVAgdmVyc2lvbiBudW1iZXJcbiAgICB0aGlzLnNldCgnQU1QX1ZFUlNJT04nLCAoKSA9PiAnJGludGVybmFsUnVudGltZVZlcnNpb24kJyk7XG5cbiAgICB0aGlzLnNldCgnQkFDS0dST1VORF9TVEFURScsICgpID0+IHtcbiAgICAgIHJldHVybiBTZXJ2aWNlcy52aWV3ZXJGb3JEb2ModGhpcy5hbXBkb2MpLmlzVmlzaWJsZSgpID8gJzAnIDogJzEnO1xuICAgIH0pO1xuXG4gICAgdGhpcy5zZXRBc3luYygnVklERU9fU1RBVEUnLCAoaWQsIHByb3BlcnR5KSA9PiB7XG4gICAgICBjb25zdCByb290ID0gdGhpcy5hbXBkb2MuZ2V0Um9vdE5vZGUoKTtcbiAgICAgIGNvbnN0IHZpZGVvID0gdXNlcigpLmFzc2VydEVsZW1lbnQoXG4gICAgICAgICAgcm9vdC5nZXRFbGVtZW50QnlJZCgvKiogQHR5cGUge3N0cmluZ30gKi8gKGlkKSksXG4gICAgICAgICAgYENvdWxkIG5vdCBmaW5kIGFuIGVsZW1lbnQgd2l0aCBpZD1cIiR7aWR9XCIgZm9yIFZJREVPX1NUQVRFYCk7XG4gICAgICByZXR1cm4gU2VydmljZXMudmlkZW9NYW5hZ2VyRm9yRG9jKHRoaXMuYW1wZG9jKVxuICAgICAgICAgIC5nZXRBbmFseXRpY3NEZXRhaWxzKHZpZGVvKVxuICAgICAgICAgIC50aGVuKGRldGFpbHMgPT4gZGV0YWlscyA/IGRldGFpbHNbcHJvcGVydHldIDogJycpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5zZXRBc3luYygnU1RPUllfUEFHRV9JTkRFWCcsIHRoaXMuZ2V0U3RvcnlWYWx1ZV8oJ3BhZ2VJbmRleCcsXG4gICAgICAgICdTVE9SWV9QQUdFX0lOREVYJykpO1xuXG4gICAgdGhpcy5zZXRBc3luYygnU1RPUllfUEFHRV9JRCcsIHRoaXMuZ2V0U3RvcnlWYWx1ZV8oJ3BhZ2VJZCcsXG4gICAgICAgICdTVE9SWV9QQUdFX0lEJykpO1xuXG4gICAgdGhpcy5zZXRBc3luYygnRklSU1RfQ09OVEVOVEZVTF9QQUlOVCcsICgpID0+IHtcbiAgICAgIHJldHVybiB0cnlSZXNvbHZlKCgpID0+XG4gICAgICAgIFNlcnZpY2VzLnBlcmZvcm1hbmNlRm9yKHRoaXMuYW1wZG9jLndpbikuZ2V0Rmlyc3RDb250ZW50ZnVsUGFpbnQoKSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnNldEFzeW5jKCdGSVJTVF9WSUVXUE9SVF9SRUFEWScsICgpID0+IHtcbiAgICAgIHJldHVybiB0cnlSZXNvbHZlKCgpID0+XG4gICAgICAgIFNlcnZpY2VzLnBlcmZvcm1hbmNlRm9yKHRoaXMuYW1wZG9jLndpbikuZ2V0Rmlyc3RWaWV3cG9ydFJlYWR5KCkpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5zZXRBc3luYygnTUFLRV9CT0RZX1ZJU0lCTEUnLCAoKSA9PiB7XG4gICAgICByZXR1cm4gdHJ5UmVzb2x2ZSgoKSA9PlxuICAgICAgICBTZXJ2aWNlcy5wZXJmb3JtYW5jZUZvcih0aGlzLmFtcGRvYy53aW4pLmdldE1ha2VCb2R5VmlzaWJsZSgpKTtcbiAgICB9KTtcblxuICAgIHRoaXMuc2V0QXN5bmMoJ0FNUF9TVEFURScsIGtleSA9PiB7XG4gICAgICByZXR1cm4gU2VydmljZXMuYmluZEZvckRvY09yTnVsbCh0aGlzLmFtcGRvYykudGhlbihiaW5kID0+IHtcbiAgICAgICAgaWYgKCFiaW5kKSB7XG4gICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiaW5kLmdldFN0YXRlVmFsdWUoLyoqIEB0eXBlIHtzdHJpbmd9ICovIChrZXkpKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIE1lcmdlcyBhbnkgcmVwbGFjZW1lbnQgcGFyYW1ldGVycyBpbnRvIGEgZ2l2ZW4gVVJMJ3MgcXVlcnkgc3RyaW5nLFxuICAgKiBwcmVmZXJyaW5nIHZhbHVlcyBzZXQgaW4gdGhlIG9yaWdpbmFsIHF1ZXJ5IHN0cmluZy5cbiAgICogQHBhcmFtIHtzdHJpbmd9IG9yaWcgVGhlIG9yaWdpbmFsIFVSTFxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSByZXN1bHRpbmcgVVJMXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBhZGRSZXBsYWNlUGFyYW1zSWZNaXNzaW5nXyhvcmlnKSB7XG4gICAgY29uc3Qge3JlcGxhY2VQYXJhbXN9ID1cbiAgICAvKiogQHR5cGUgeyFPYmplY3R9ICovIChTZXJ2aWNlcy5kb2N1bWVudEluZm9Gb3JEb2ModGhpcy5hbXBkb2MpKTtcbiAgICBjb25zdCB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQocmVtb3ZlQW1wSnNQYXJhbXNGcm9tVXJsKG9yaWcpKTtcbiAgICBjb25zdCBwYXJhbXMgPSBwYXJzZVF1ZXJ5U3RyaW5nKHVybC5zZWFyY2gpO1xuICAgIHJldHVybiBhZGRQYXJhbXNUb1VybChyZW1vdmVTZWFyY2gob3JpZyksXG4gICAgICAgIC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICoqLyAoT2JqZWN0LmFzc2lnbih7fSwgcmVwbGFjZVBhcmFtcywgcGFyYW1zKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc29sdmVzIHRoZSB2YWx1ZSB2aWEgb25lIG9mIGRvY3VtZW50IGluZm8ncyB1cmxzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgQSBmaWVsZCBvbiB0aGUgZG9jSW5mb1xuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF91cmxQcm9wIEEgc3VicHJvcGVydHkgb2YgdGhlIGZpZWxkXG4gICAqIEByZXR1cm4ge1R9XG4gICAqIEB0ZW1wbGF0ZSBUXG4gICAqL1xuICBnZXREb2NJbmZvVXJsXyhmaWVsZCwgb3B0X3VybFByb3ApIHtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgY29uc3QgZG9jSW5mbyA9IFNlcnZpY2VzLmRvY3VtZW50SW5mb0ZvckRvYyh0aGlzLmFtcGRvYyk7XG4gICAgICBjb25zdCB2YWx1ZSA9IGRvY0luZm9bZmllbGRdO1xuICAgICAgcmV0dXJuIG9wdF91cmxQcm9wID8gcGFyc2VVcmxEZXByZWNhdGVkKHZhbHVlKVtvcHRfdXJsUHJvcF0gOiB2YWx1ZTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc29sdmVzIHRoZSB2YWx1ZSB2aWEgYWNjZXNzIHNlcnZpY2UuIElmIGFjY2VzcyBzZXJ2aWNlIGlzIG5vdCBjb25maWd1cmVkLFxuICAgKiB0aGUgcmVzdWx0aW5nIHZhbHVlIGlzIGBudWxsYC5cbiAgICogQHBhcmFtIHtmdW5jdGlvbighLi4vLi4vZXh0ZW5zaW9ucy9hbXAtYWNjZXNzLzAuMS9hY2Nlc3MtdmFycy5BY2Nlc3NWYXJzKTooVHwhUHJvbWlzZTxUPil9IGdldHRlclxuICAgKiBAcGFyYW0ge3N0cmluZ30gZXhwclxuICAgKiBAcmV0dXJuIHtUfG51bGx9XG4gICAqIEB0ZW1wbGF0ZSBUXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRBY2Nlc3NWYWx1ZV8oZ2V0dGVyLCBleHByKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFtcbiAgICAgIFNlcnZpY2VzLmFjY2Vzc1NlcnZpY2VGb3JEb2NPck51bGwodGhpcy5hbXBkb2MpLFxuICAgICAgU2VydmljZXMuc3Vic2NyaXB0aW9uc1NlcnZpY2VGb3JEb2NPck51bGwodGhpcy5hbXBkb2MpLFxuICAgIF0pLnRoZW4oc2VydmljZXMgPT4ge1xuICAgICAgY29uc3Qgc2VydmljZSA9IC8qKiBAdHlwZSB7Py4uLy4uL2V4dGVuc2lvbnMvYW1wLWFjY2Vzcy8wLjEvYWNjZXNzLXZhcnMuQWNjZXNzVmFyc30gKi8gKFxuICAgICAgICBzZXJ2aWNlc1swXSB8fCBzZXJ2aWNlc1sxXSk7XG4gICAgICBpZiAoIXNlcnZpY2UpIHtcbiAgICAgICAgLy8gQWNjZXNzL3N1YnNjcmlwdGlvbnMgc2VydmljZSBpcyBub3QgaW5zdGFsbGVkLlxuICAgICAgICB1c2VyKCkuZXJyb3IoXG4gICAgICAgICAgICBUQUcsXG4gICAgICAgICAgICAnQWNjZXNzIG9yIHN1YnNjaXB0aW9ucyBzZXJ2aWNlIGlzIG5vdCBpbnN0YWxsZWQgdG8gYWNjZXNzOiAnLFxuICAgICAgICAgICAgZXhwcik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGdldHRlcihzZXJ2aWNlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIFFVRVJZX1BBUkFNIGZyb20gdGhlIGN1cnJlbnQgbG9jYXRpb24gaHJlZlxuICAgKiBAcGFyYW0geyp9IHBhcmFtXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBkZWZhdWx0VmFsdWVcbiAgICogQHJldHVybiB7c3RyaW5nfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0UXVlcnlQYXJhbURhdGFfKHBhcmFtLCBkZWZhdWx0VmFsdWUpIHtcbiAgICB1c2VyKCkuYXNzZXJ0KHBhcmFtLFxuICAgICAgICAnVGhlIGZpcnN0IGFyZ3VtZW50IHRvIFFVRVJZX1BBUkFNLCB0aGUgcXVlcnkgc3RyaW5nICcgK1xuICAgICAgICAncGFyYW0gaXMgcmVxdWlyZWQnKTtcbiAgICBjb25zdCB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQoXG4gICAgICAgIHJlbW92ZUFtcEpzUGFyYW1zRnJvbVVybCh0aGlzLmFtcGRvYy53aW4ubG9jYXRpb24uaHJlZikpO1xuICAgIGNvbnN0IHBhcmFtcyA9IHBhcnNlUXVlcnlTdHJpbmcodXJsLnNlYXJjaCk7XG4gICAgY29uc3Qga2V5ID0gdXNlcigpLmFzc2VydFN0cmluZyhwYXJhbSk7XG4gICAgY29uc3Qge3JlcGxhY2VQYXJhbXN9ID0gU2VydmljZXMuZG9jdW1lbnRJbmZvRm9yRG9jKHRoaXMuYW1wZG9jKTtcbiAgICBpZiAodHlwZW9mIHBhcmFtc1trZXldICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgcmV0dXJuIHBhcmFtc1trZXldO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHJlcGxhY2VQYXJhbXNba2V5XSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHJldHVybiAvKiogQHR5cGUge3N0cmluZ30gKi8ocmVwbGFjZVBhcmFtc1trZXldKTtcbiAgICB9XG4gICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXNvbHZlcyB0aGUgdmFsdWUgdmlhIGFtcC1leHBlcmltZW50J3MgdmFyaWFudHMgc2VydmljZS5cbiAgICogQHBhcmFtIHtmdW5jdGlvbighT2JqZWN0PHN0cmluZywgc3RyaW5nPik6KD9zdHJpbmcpfSBnZXR0ZXJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGV4cHJcbiAgICogQHJldHVybiB7IVByb21pc2U8P3N0cmluZz59XG4gICAqIEB0ZW1wbGF0ZSBUXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRWYXJpYW50c1ZhbHVlXyhnZXR0ZXIsIGV4cHIpIHtcbiAgICBpZiAoIXRoaXMudmFyaWFudHNfKSB7XG4gICAgICB0aGlzLnZhcmlhbnRzXyA9IFNlcnZpY2VzLnZhcmlhbnRGb3JPck51bGwodGhpcy5hbXBkb2Mud2luKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudmFyaWFudHNfLnRoZW4odmFyaWFudHMgPT4ge1xuICAgICAgdXNlcigpLmFzc2VydCh2YXJpYW50cyxcbiAgICAgICAgICAnVG8gdXNlIHZhcmlhYmxlICVzLCBhbXAtZXhwZXJpbWVudCBzaG91bGQgYmUgY29uZmlndXJlZCcsXG4gICAgICAgICAgZXhwcik7XG4gICAgICByZXR1cm4gZ2V0dGVyKHZhcmlhbnRzKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXNvbHZlcyB0aGUgdmFsdWUgdmlhIGdlbyBzZXJ2aWNlLlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKE9iamVjdDxzdHJpbmcsIHN0cmluZz4pfSBnZXR0ZXJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGV4cHJcbiAgICogQHJldHVybiB7IVByb21pc2U8T2JqZWN0PHN0cmluZywoc3RyaW5nfEFycmF5PHN0cmluZz4pPj59XG4gICAqIEB0ZW1wbGF0ZSBUXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRHZW9fKGdldHRlciwgZXhwcikge1xuICAgIHJldHVybiBTZXJ2aWNlcy5nZW9Gb3JEb2NPck51bGwodGhpcy5hbXBkb2MpXG4gICAgICAgIC50aGVuKGdlbyA9PiB7XG4gICAgICAgICAgdXNlcigpLmFzc2VydChnZW8sXG4gICAgICAgICAgICAgICdUbyB1c2UgdmFyaWFibGUgJXMsIGFtcC1nZW8gc2hvdWxkIGJlIGNvbmZpZ3VyZWQnLFxuICAgICAgICAgICAgICBleHByKTtcbiAgICAgICAgICByZXR1cm4gZ2V0dGVyKGdlbyk7XG4gICAgICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc29sdmVzIHRoZSB2YWx1ZSB2aWEgYW1wLXNoYXJlLXRyYWNraW5nJ3Mgc2VydmljZS5cbiAgICogQHBhcmFtIHtmdW5jdGlvbighU2hhcmVUcmFja2luZ0ZyYWdtZW50c0RlZik6VH0gZ2V0dGVyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBleHByXG4gICAqIEByZXR1cm4geyFQcm9taXNlPFQ+fVxuICAgKiBAdGVtcGxhdGUgVFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0U2hhcmVUcmFja2luZ1ZhbHVlXyhnZXR0ZXIsIGV4cHIpIHtcbiAgICBpZiAoIXRoaXMuc2hhcmVUcmFja2luZ0ZyYWdtZW50c18pIHtcbiAgICAgIHRoaXMuc2hhcmVUcmFja2luZ0ZyYWdtZW50c18gPVxuICAgICAgICAgIFNlcnZpY2VzLnNoYXJlVHJhY2tpbmdGb3JPck51bGwodGhpcy5hbXBkb2Mud2luKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuc2hhcmVUcmFja2luZ0ZyYWdtZW50c18udGhlbihmcmFnbWVudHMgPT4ge1xuICAgICAgdXNlcigpLmFzc2VydChmcmFnbWVudHMsICdUbyB1c2UgdmFyaWFibGUgJXMsICcgK1xuICAgICAgICAgICdhbXAtc2hhcmUtdHJhY2tpbmcgc2hvdWxkIGJlIGNvbmZpZ3VyZWQnLFxuICAgICAgZXhwcik7XG4gICAgICByZXR1cm4gZ2V0dGVyKC8qKiBAdHlwZSB7IVNoYXJlVHJhY2tpbmdGcmFnbWVudHNEZWZ9ICovIChmcmFnbWVudHMpKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXNvbHZlcyB0aGUgdmFsdWUgdmlhIGFtcC1zdG9yeSdzIHNlcnZpY2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wZXJ0eVxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcmV0dXJuIHshQXN5bmNSZXNvbHZlckRlZn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdldFN0b3J5VmFsdWVfKHByb3BlcnR5LCBuYW1lKSB7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGNvbnN0IHNlcnZpY2UgPSBTZXJ2aWNlcy5zdG9yeVZhcmlhYmxlU2VydmljZUZvck9yTnVsbCh0aGlzLmFtcGRvYy53aW4pO1xuICAgICAgcmV0dXJuIHNlcnZpY2UudGhlbihzdG9yeVZhcmlhYmxlcyA9PiB7XG4gICAgICAgIHVzZXIoKS5hc3NlcnQoc3RvcnlWYXJpYWJsZXMsXG4gICAgICAgICAgICAnVG8gdXNlIHZhcmlhYmxlICVzIGFtcC1zdG9yeSBzaG91bGQgYmUgY29uZmlndXJlZCcsIG5hbWUpO1xuICAgICAgICByZXR1cm4gc3RvcnlWYXJpYWJsZXNbcHJvcGVydHldO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXNvbHZlcyB0aGUgdmFsdWUgdmlhIGFtcC12aWV3ZXItaW50ZWdyYXRpb24ncyBzZXJ2aWNlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvcGVydHlcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICogQHJldHVybiB7IUFzeW5jUmVzb2x2ZXJEZWZ9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBnZXRWaWV3ZXJJbnRlZ3JhdGlvblZhbHVlXyhwcm9wZXJ0eSwgbmFtZSkge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFBc3luY1Jlc29sdmVyRGVmfSAqLyAoXG4gICAgICAocGFyYW0sIGRlZmF1bHRWYWx1ZSA9ICcnKSA9PiB7XG4gICAgICAgIGNvbnN0IHNlcnZpY2UgPVxuICAgICAgICAgICAgU2VydmljZXMudmlld2VySW50ZWdyYXRpb25WYXJpYWJsZVNlcnZpY2VGb3JPck51bGwodGhpcy5hbXBkb2Mud2luKTtcbiAgICAgICAgcmV0dXJuIHNlcnZpY2UudGhlbih2aWV3ZXJJbnRlZ3JhdGlvblZhcmlhYmxlcyA9PiB7XG4gICAgICAgICAgdXNlcigpLmFzc2VydCh2aWV3ZXJJbnRlZ3JhdGlvblZhcmlhYmxlcywgJ1RvIHVzZSB2YXJpYWJsZSAlcyAnICtcbiAgICAgICAgICAgICAgJ2FtcC12aWV3ZXItaW50ZWdyYXRpb24gbXVzdCBiZSBpbnN0YWxsZWQnLCBuYW1lKTtcbiAgICAgICAgICByZXR1cm4gdmlld2VySW50ZWdyYXRpb25WYXJpYWJsZXNbcHJvcGVydHldKHBhcmFtLCBkZWZhdWx0VmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICogVGhpcyBjbGFzcyByZXBsYWNlcyBzdWJzdGl0dXRpb24gdmFyaWFibGVzIHdpdGggdGhlaXIgdmFsdWVzLlxuICogRG9jdW1lbnQgbmV3IHZhbHVlcyBpbiAuLi9zcGVjL2FtcC12YXItc3Vic3RpdHV0aW9ucy5tZFxuICogQHBhY2thZ2UgRm9yIGV4cG9ydFxuICovXG5leHBvcnQgY2xhc3MgVXJsUmVwbGFjZW1lbnRzIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IS4vYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAgICogQHBhcmFtIHshVmFyaWFibGVTb3VyY2V9IHZhcmlhYmxlU291cmNlXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhbXBkb2MsIHZhcmlhYmxlU291cmNlKSB7XG4gICAgLyoqIEBjb25zdCB7IS4vYW1wZG9jLWltcGwuQW1wRG9jfSAqL1xuICAgIHRoaXMuYW1wZG9jID0gYW1wZG9jO1xuXG4gICAgLyoqIEB0eXBlIHtWYXJpYWJsZVNvdXJjZX0gKi9cbiAgICB0aGlzLnZhcmlhYmxlU291cmNlXyA9IHZhcmlhYmxlU291cmNlO1xuXG4gICAgLyoqIEB0eXBlIHshRXhwYW5kZXJ9ICovXG4gICAgdGhpcy5leHBhbmRlcl8gPSBuZXcgRXhwYW5kZXIodGhpcy52YXJpYWJsZVNvdXJjZV8pO1xuICB9XG5cblxuICAvKipcbiAgICogU3luY2hyb25vdXNseSBleHBhbmRzIHRoZSBwcm92aWRlZCBzb3VyY2UgYnkgcmVwbGFjaW5nIGFsbCBrbm93biB2YXJpYWJsZXNcbiAgICogd2l0aCB0aGVpciByZXNvbHZlZCB2YWx1ZXMuIE9wdGlvbmFsIGBvcHRfYmluZGluZ3NgIGNhbiBiZSB1c2VkIHRvIGFkZCBuZXdcbiAgICogdmFyaWFibGVzIG9yIG92ZXJyaWRlIGV4aXN0aW5nIG9uZXMuICBBbnkgYXN5bmMgYmluZGluZ3MgYXJlIGlnbm9yZWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzb3VyY2VcbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgKFJlc29sdmVyUmV0dXJuRGVmfCFTeW5jUmVzb2x2ZXJEZWYpPj19IG9wdF9iaW5kaW5nc1xuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBSZXNvbHZlclJldHVybkRlZj49fSBvcHRfY29sbGVjdFZhcnNcbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgYm9vbGVhbj49fSBvcHRfd2hpdGVMaXN0IE9wdGlvbmFsIHdoaXRlIGxpc3Qgb2ZcbiAgICogICAgIG5hbWVzIHRoYXQgY2FuIGJlIHN1YnN0aXR1dGVkLlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAqL1xuICBleHBhbmRTdHJpbmdTeW5jKHNvdXJjZSwgb3B0X2JpbmRpbmdzLCBvcHRfY29sbGVjdFZhcnMsIG9wdF93aGl0ZUxpc3QpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHtzdHJpbmd9ICovIChcbiAgICAgIHRoaXMuZXhwYW5kXyhzb3VyY2UsIG9wdF9iaW5kaW5ncywgb3B0X2NvbGxlY3RWYXJzLCAvKiBvcHRfc3luYyAqLyB0cnVlLFxuICAgICAgICAgIG9wdF93aGl0ZUxpc3QpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeHBhbmRzIHRoZSBwcm92aWRlZCBzb3VyY2UgYnkgcmVwbGFjaW5nIGFsbCBrbm93biB2YXJpYWJsZXMgd2l0aCB0aGVpclxuICAgKiByZXNvbHZlZCB2YWx1ZXMuIE9wdGlvbmFsIGBvcHRfYmluZGluZ3NgIGNhbiBiZSB1c2VkIHRvIGFkZCBuZXcgdmFyaWFibGVzXG4gICAqIG9yIG92ZXJyaWRlIGV4aXN0aW5nIG9uZXMuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzb3VyY2VcbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgKj49fSBvcHRfYmluZGluZ3NcbiAgICogQHJldHVybiB7IVByb21pc2U8c3RyaW5nPn1cbiAgICovXG4gIGV4cGFuZFN0cmluZ0FzeW5jKHNvdXJjZSwgb3B0X2JpbmRpbmdzKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8c3RyaW5nPn0gKi8gKHRoaXMuZXhwYW5kXyhzb3VyY2UsIG9wdF9iaW5kaW5ncykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN5bmNocm9ub3VzbHkgZXhwYW5kcyB0aGUgcHJvdmlkZWQgVVJMIGJ5IHJlcGxhY2luZyBhbGwga25vd24gdmFyaWFibGVzXG4gICAqIHdpdGggdGhlaXIgcmVzb2x2ZWQgdmFsdWVzLiBPcHRpb25hbCBgb3B0X2JpbmRpbmdzYCBjYW4gYmUgdXNlZCB0byBhZGQgbmV3XG4gICAqIHZhcmlhYmxlcyBvciBvdmVycmlkZSBleGlzdGluZyBvbmVzLiAgQW55IGFzeW5jIGJpbmRpbmdzIGFyZSBpZ25vcmVkLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gICAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsIChSZXNvbHZlclJldHVybkRlZnwhU3luY1Jlc29sdmVyRGVmKT49fSBvcHRfYmluZGluZ3NcbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgUmVzb2x2ZXJSZXR1cm5EZWY+PX0gb3B0X2NvbGxlY3RWYXJzXG4gICAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsIGJvb2xlYW4+PX0gb3B0X3doaXRlTGlzdCBPcHRpb25hbCB3aGl0ZSBsaXN0IG9mXG4gICAqICAgICBuYW1lcyB0aGF0IGNhbiBiZSBzdWJzdGl0dXRlZC5cbiAgICogQHJldHVybiB7c3RyaW5nfVxuICAgKi9cbiAgZXhwYW5kVXJsU3luYyh1cmwsIG9wdF9iaW5kaW5ncywgb3B0X2NvbGxlY3RWYXJzLCBvcHRfd2hpdGVMaXN0KSB7XG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlUHJvdG9jb2xNYXRjaGVzXyh1cmwsIC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAodGhpcy5leHBhbmRfKFxuICAgICAgICB1cmwsIG9wdF9iaW5kaW5ncywgb3B0X2NvbGxlY3RWYXJzLCAvKiBvcHRfc3luYyAqLyB0cnVlLFxuICAgICAgICBvcHRfd2hpdGVMaXN0KSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4cGFuZHMgdGhlIHByb3ZpZGVkIFVSTCBieSByZXBsYWNpbmcgYWxsIGtub3duIHZhcmlhYmxlcyB3aXRoIHRoZWlyXG4gICAqIHJlc29sdmVkIHZhbHVlcy4gT3B0aW9uYWwgYG9wdF9iaW5kaW5nc2AgY2FuIGJlIHVzZWQgdG8gYWRkIG5ldyB2YXJpYWJsZXNcbiAgICogb3Igb3ZlcnJpZGUgZXhpc3Rpbmcgb25lcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPj19IG9wdF9iaW5kaW5nc1xuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPj19IG9wdF93aGl0ZUxpc3QgT3B0aW9uYWwgd2hpdGUgbGlzdCBvZiBuYW1lc1xuICAgKiAgICAgdGhhdCBjYW4gYmUgc3Vic3RpdHV0ZWQuXG4gICAqIEByZXR1cm4geyFQcm9taXNlPHN0cmluZz59XG4gICAqL1xuICBleHBhbmRVcmxBc3luYyh1cmwsIG9wdF9iaW5kaW5ncywgb3B0X3doaXRlTGlzdCkge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPHN0cmluZz59ICovIChcbiAgICAgIHRoaXMuZXhwYW5kXyh1cmwsIG9wdF9iaW5kaW5ncywgdW5kZWZpbmVkLCB1bmRlZmluZWQsXG4gICAgICAgICAgb3B0X3doaXRlTGlzdCkudGhlbihcbiAgICAgICAgICByZXBsYWNlbWVudCA9PiB0aGlzLmVuc3VyZVByb3RvY29sTWF0Y2hlc18odXJsLCByZXBsYWNlbWVudCkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeHBhbmRzIGFuIGlucHV0IGVsZW1lbnQgdmFsdWUgYXR0cmlidXRlIHdpdGggdmFyaWFibGUgc3Vic3RpdHV0ZWQuXG4gICAqIEBwYXJhbSB7IUhUTUxJbnB1dEVsZW1lbnR9IGVsZW1lbnRcbiAgICogQHJldHVybiB7IVByb21pc2U8c3RyaW5nPn1cbiAgICovXG4gIGV4cGFuZElucHV0VmFsdWVBc3luYyhlbGVtZW50KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8c3RyaW5nPn0gKi8gKFxuICAgICAgdGhpcy5leHBhbmRJbnB1dFZhbHVlXyhlbGVtZW50LCAvKm9wdF9zeW5jKi8gZmFsc2UpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeHBhbmRzIGFuIGlucHV0IGVsZW1lbnQgdmFsdWUgYXR0cmlidXRlIHdpdGggdmFyaWFibGUgc3Vic3RpdHV0ZWQuXG4gICAqIEBwYXJhbSB7IUhUTUxJbnB1dEVsZW1lbnR9IGVsZW1lbnRcbiAgICogQHJldHVybiB7c3RyaW5nfSBSZXBsYWNlZCBzdHJpbmcgZm9yIHRlc3RpbmdcbiAgICovXG4gIGV4cGFuZElucHV0VmFsdWVTeW5jKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHtzdHJpbmd9ICovIChcbiAgICAgIHRoaXMuZXhwYW5kSW5wdXRWYWx1ZV8oZWxlbWVudCwgLypvcHRfc3luYyovIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeHBhbmRzIGluIGlucHV0IGVsZW1lbnQgdmFsdWUgYXR0cmlidXRlIHdpdGggdmFyaWFibGUgc3Vic3RpdHV0ZWQuXG4gICAqIEBwYXJhbSB7IUhUTUxJbnB1dEVsZW1lbnR9IGVsZW1lbnRcbiAgICogQHBhcmFtIHtib29sZWFuPX0gb3B0X3N5bmNcbiAgICogQHJldHVybiB7c3RyaW5nfCFQcm9taXNlPHN0cmluZz59XG4gICAqL1xuICBleHBhbmRJbnB1dFZhbHVlXyhlbGVtZW50LCBvcHRfc3luYykge1xuICAgIGRldigpLmFzc2VydChlbGVtZW50LnRhZ05hbWUgPT0gJ0lOUFVUJyAmJlxuICAgICAgICAoZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSB8fCAnJykudG9Mb3dlckNhc2UoKSA9PSAnaGlkZGVuJyxcbiAgICAnSW5wdXQgdmFsdWUgZXhwYW5zaW9uIG9ubHkgd29ya3Mgb24gaGlkZGVuIGlucHV0IGZpZWxkczogJXMnLCBlbGVtZW50KTtcblxuICAgIGNvbnN0IHdoaXRlbGlzdCA9IHRoaXMuZ2V0V2hpdGVsaXN0Rm9yRWxlbWVudF8oZWxlbWVudCk7XG4gICAgaWYgKCF3aGl0ZWxpc3QpIHtcbiAgICAgIHJldHVybiBvcHRfc3luYyA/IGVsZW1lbnQudmFsdWUgOiBQcm9taXNlLnJlc29sdmUoZWxlbWVudC52YWx1ZSk7XG4gICAgfVxuICAgIGlmIChlbGVtZW50W09SSUdJTkFMX1ZBTFVFX1BST1BFUlRZXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBlbGVtZW50W09SSUdJTkFMX1ZBTFVFX1BST1BFUlRZXSA9IGVsZW1lbnQudmFsdWU7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuZXhwYW5kXyhcbiAgICAgICAgZWxlbWVudFtPUklHSU5BTF9WQUxVRV9QUk9QRVJUWV0gfHwgZWxlbWVudC52YWx1ZSxcbiAgICAgICAgLyogb3B0X2JpbmRpbmdzICovIHVuZGVmaW5lZCxcbiAgICAgICAgLyogb3B0X2NvbGxlY3RWYXJzICovIHVuZGVmaW5lZCxcbiAgICAgICAgLyogb3B0X3N5bmMgKi8gb3B0X3N5bmMsXG4gICAgICAgIC8qIG9wdF93aGl0ZWxpc3QgKi8gd2hpdGVsaXN0KTtcblxuICAgIGlmIChvcHRfc3luYykge1xuICAgICAgcmV0dXJuIGVsZW1lbnQudmFsdWUgPSByZXN1bHQ7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQudGhlbihuZXdWYWx1ZSA9PiB7XG4gICAgICBlbGVtZW50LnZhbHVlID0gbmV3VmFsdWU7XG4gICAgICByZXR1cm4gbmV3VmFsdWU7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHJlcGxhY2VtZW50IHdoaXRlbGlzdCBmcm9tIGVsZW1lbnRzJyBkYXRhLWFtcC1yZXBsYWNlIGF0dHJpYnV0ZS5cbiAgICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPj19IG9wdF9zdXBwb3J0ZWRSZXBsYWNlbWVudCBPcHRpb25hbCBzdXBwb3J0ZWRcbiAgICogcmVwbGFjZW1lbnQgdGhhdCBmaWx0ZXJzIHdoaXRlbGlzdCB0byBhIHN1YnNldC5cbiAgICogQHJldHVybiB7IU9iamVjdDxzdHJpbmcsIGJvb2xlYW4+fHVuZGVmaW5lZH1cbiAgICovXG4gIGdldFdoaXRlbGlzdEZvckVsZW1lbnRfKGVsZW1lbnQsIG9wdF9zdXBwb3J0ZWRSZXBsYWNlbWVudCkge1xuICAgIGNvbnN0IHdoaXRlbGlzdCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWFtcC1yZXBsYWNlJyk7XG4gICAgaWYgKCF3aGl0ZWxpc3QpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgcmVxdWVzdGVkUmVwbGFjZW1lbnRzID0ge307XG4gICAgd2hpdGVsaXN0LnRyaW0oKS5zcGxpdCgvXFxzKy8pLmZvckVhY2gocmVwbGFjZW1lbnQgPT4ge1xuICAgICAgaWYgKCFvcHRfc3VwcG9ydGVkUmVwbGFjZW1lbnQgfHxcbiAgICAgICAgICBoYXNPd24ob3B0X3N1cHBvcnRlZFJlcGxhY2VtZW50LCByZXBsYWNlbWVudCkpIHtcbiAgICAgICAgcmVxdWVzdGVkUmVwbGFjZW1lbnRzW3JlcGxhY2VtZW50XSA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1c2VyKCkud2FybignVVJMJywgJ0lnbm9yaW5nIHVuc3VwcG9ydGVkIHJlcGxhY2VtZW50JywgcmVwbGFjZW1lbnQpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiByZXF1ZXN0ZWRSZXBsYWNlbWVudHM7XG4gIH1cblxuICAvKipcbiAgICAqIFJldHVybnMgd2hldGhlciB2YXJpYWJsZSBzdWJzdGl0dXRpb24gaXMgYWxsb3dlZCBmb3IgZ2l2ZW4gdXJsLlxuICAgICogQHBhcmFtIHshTG9jYXRpb259IHVybFxuICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAqL1xuICBpc0FsbG93ZWRPcmlnaW5fKHVybCkge1xuICAgIGNvbnN0IGRvY0luZm8gPSBTZXJ2aWNlcy5kb2N1bWVudEluZm9Gb3JEb2ModGhpcy5hbXBkb2MpO1xuICAgIGlmICh1cmwub3JpZ2luID09IHBhcnNlVXJsRGVwcmVjYXRlZChkb2NJbmZvLmNhbm9uaWNhbFVybCkub3JpZ2luIHx8XG4gICAgICAgIHVybC5vcmlnaW4gPT0gcGFyc2VVcmxEZXByZWNhdGVkKGRvY0luZm8uc291cmNlVXJsKS5vcmlnaW4pIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGNvbnN0IG1ldGEgPSB0aGlzLmFtcGRvYy5nZXRSb290Tm9kZSgpLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICdtZXRhW25hbWU9YW1wLWxpbmstdmFyaWFibGUtYWxsb3dlZC1vcmlnaW5dJyk7XG5cbiAgICBpZiAobWV0YSAmJiBtZXRhLmhhc0F0dHJpYnV0ZSgnY29udGVudCcpKSB7XG4gICAgICBjb25zdCB3aGl0ZWxpc3QgPSBtZXRhLmdldEF0dHJpYnV0ZSgnY29udGVudCcpLnRyaW0oKS5zcGxpdCgvXFxzKy8pO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3aGl0ZWxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHVybC5vcmlnaW4gPT0gcGFyc2VVcmxEZXByZWNhdGVkKHdoaXRlbGlzdFtpXSkub3JpZ2luKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogUmVwbGFjZXMgdmFsdWVzIGluIHRoZSBsaW5rIG9mIGFuIGFuY2hvciB0YWcgaWZcbiAgICogLSB0aGUgbGluayBvcHRzIGludG8gaXQgKHZpYSBkYXRhLWFtcC1yZXBsYWNlIGFyZ3VtZW50KVxuICAgKiAtIHRoZSBkZXN0aW5hdGlvbiBpcyB0aGUgc291cmNlIG9yIGNhbm9uaWNhbCBvcmlnaW4gb2YgdGhpcyBkb2MuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnQgQW4gYW5jaG9yIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7P3N0cmluZ30gZGVmYXVsdFVybFBhcmFtcyB0byBleHBhbmQgbGluayBpZiBjYWxsZXIgcmVxdWVzdC5cbiAgICogQHJldHVybiB7c3RyaW5nfHVuZGVmaW5lZH0gUmVwbGFjZWQgc3RyaW5nIGZvciB0ZXN0aW5nXG4gICAqL1xuICBtYXliZUV4cGFuZExpbmsoZWxlbWVudCwgZGVmYXVsdFVybFBhcmFtcykge1xuICAgIGRldigpLmFzc2VydChlbGVtZW50LnRhZ05hbWUgPT0gJ0EnKTtcbiAgICBjb25zdCBzdXBwb3J0ZWRSZXBsYWNlbWVudHMgPSB7XG4gICAgICAnQ0xJRU5UX0lEJzogdHJ1ZSxcbiAgICAgICdRVUVSWV9QQVJBTSc6IHRydWUsXG4gICAgfTtcbiAgICBjb25zdCBhZGRpdGlvbmFsVXJsUGFyYW1ldGVycyA9XG4gICAgICAgIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWFtcC1hZGRwYXJhbXMnKSB8fCAnJztcbiAgICBjb25zdCB3aGl0ZWxpc3QgPSB0aGlzLmdldFdoaXRlbGlzdEZvckVsZW1lbnRfKFxuICAgICAgICBlbGVtZW50LCBzdXBwb3J0ZWRSZXBsYWNlbWVudHMpO1xuXG4gICAgaWYgKCF3aGl0ZWxpc3QgJiYgIWFkZGl0aW9uYWxVcmxQYXJhbWV0ZXJzICYmICFkZWZhdWx0VXJsUGFyYW1zKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIE9SSUdJTkFMX0hSRUZfUFJPUEVSVFkgaGFzIHRoZSB2YWx1ZSBvZiB0aGUgaHJlZiBcInByZS1yZXBsYWNlbWVudFwiLlxuICAgIC8vIFdlIHNldCB0aGlzIHRvIHRoZSBvcmlnaW5hbCB2YWx1ZSBiZWZvcmUgZG9pbmcgYW55IHdvcmsgYW5kIHVzZSBpdFxuICAgIC8vIG9uIHN1YnNlcXVlbnQgcmVwbGFjZW1lbnRzLCBzbyB0aGF0IGVhY2ggcnVuIGdldHMgYSBmcmVzaCB2YWx1ZS5cbiAgICBsZXQgaHJlZiA9IGRldigpLmFzc2VydFN0cmluZyhcbiAgICAgICAgZWxlbWVudFtPUklHSU5BTF9IUkVGX1BST1BFUlRZXSB8fCBlbGVtZW50LmdldEF0dHJpYnV0ZSgnaHJlZicpKTtcbiAgICBjb25zdCB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQoaHJlZik7XG4gICAgaWYgKGVsZW1lbnRbT1JJR0lOQUxfSFJFRl9QUk9QRVJUWV0gPT0gbnVsbCkge1xuICAgICAgZWxlbWVudFtPUklHSU5BTF9IUkVGX1BST1BFUlRZXSA9IGhyZWY7XG4gICAgfVxuICAgIGlmIChhZGRpdGlvbmFsVXJsUGFyYW1ldGVycykge1xuICAgICAgaHJlZiA9IGFkZFBhcmFtc1RvVXJsKFxuICAgICAgICAgIGhyZWYsXG4gICAgICAgICAgcGFyc2VRdWVyeVN0cmluZyhhZGRpdGlvbmFsVXJsUGFyYW1ldGVycykpO1xuICAgIH1cblxuICAgIGNvbnN0IGlzQWxsb3dlZE9yaWdpbiA9IHRoaXMuaXNBbGxvd2VkT3JpZ2luXyh1cmwpO1xuICAgIGlmICghaXNBbGxvd2VkT3JpZ2luKSB7XG4gICAgICBpZiAod2hpdGVsaXN0KSB7XG4gICAgICAgIHVzZXIoKS53YXJuKCdVUkwnLCAnSWdub3JpbmcgbGluayByZXBsYWNlbWVudCcsIGhyZWYsXG4gICAgICAgICAgICAnIGJlY2F1c2UgdGhlIGxpbmsgZG9lcyBub3QgZ28gdG8gdGhlIGRvY3VtZW50XFwncycgK1xuICAgICAgICAgICAgJyBzb3VyY2UsIGNhbm9uaWNhbCwgb3Igd2hpdGVsaXN0ZWQgb3JpZ2luLicpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGVsZW1lbnQuaHJlZiA9IGhyZWY7XG4gICAgfVxuXG4gICAgLy8gTm90ZSB0aGF0IGRlZmF1bHRVcmxQYXJhbXMgaXMgdHJlYXRlZCBkaWZmZXJlbnRseSB0aGFuXG4gICAgLy8gYWRkaXRpb25hbFVybFBhcmFtZXRlcnMgaW4gdHdvIHdheXMgIzE6IElmIHRoZSBvdXRnb2luZyB1cmwgb3JpZ2luIGlzIG5vdFxuICAgIC8vIHdoaXRlbGlzdGVkOiBhZGRpdGlvbmFsVXJsUGFyYW1ldGVycyBhcmUgYWx3YXlzIGFwcGVuZGVkIGJ5IG5vdCBleHBhbmRlZCxcbiAgICAvLyBkZWZhdWx0VXJsUGFyYW1zIHdpbGwgbm90IGJlIGFwcGVuZGVkLiAjMjogSWYgdGhlIGV4cGFuc2lvbiBmdW5jdGlvbiBpc1xuICAgIC8vIG5vdCB3aGl0ZWxpc3RlZDogYWRkaXRpb25hbFVybFBhcmFtdGVycyB3aWxsIG5vdCBiZSBleHBhbmRlZCxcbiAgICAvLyBkZWZhdWx0VXJsUGFyYW1zIHdpbGwgYnkgZGVmYXVsdCBzdXBwb3J0IFFVRVJZX1BBUkFNLCBhbmQgd2lsbCBzdGlsbCBiZVxuICAgIC8vIGV4cGFuZGVkLlxuICAgIGlmIChkZWZhdWx0VXJsUGFyYW1zKSB7XG4gICAgICBpZiAoIXdoaXRlbGlzdCB8fCAhd2hpdGVsaXN0WydRVUVSWV9QQVJBTSddKSB7XG4gICAgICAgIC8vIG92ZXJyaWRlIHdoaXRlbGlzdCBhbmQgZXhwYW5kIGRlZmF1bHRVcmxQYXJhbXM7XG4gICAgICAgIGNvbnN0IG92ZXJyaWRlV2hpdGVsaXN0ID0geydRVUVSWV9QQVJBTSc6IHRydWV9O1xuICAgICAgICBkZWZhdWx0VXJsUGFyYW1zID0gdGhpcy5leHBhbmRVcmxTeW5jKFxuICAgICAgICAgICAgZGVmYXVsdFVybFBhcmFtcyxcbiAgICAgICAgICAgIC8qIG9wdF9iaW5kaW5ncyAqLyB1bmRlZmluZWQsXG4gICAgICAgICAgICAvKiBvcHRfY29sbGVjdFZhcnMgKi8gdW5kZWZpbmVkLFxuICAgICAgICAgICAgLyogb3B0X3doaXRlbGlzdCAqLyBvdmVycmlkZVdoaXRlbGlzdCk7XG4gICAgICB9XG4gICAgICBocmVmID0gYWRkUGFyYW1zVG9VcmwoaHJlZiwgcGFyc2VRdWVyeVN0cmluZyhkZWZhdWx0VXJsUGFyYW1zKSk7XG4gICAgfVxuXG4gICAgaWYgKHdoaXRlbGlzdCkge1xuICAgICAgaHJlZiA9IHRoaXMuZXhwYW5kVXJsU3luYyhcbiAgICAgICAgICBocmVmLFxuICAgICAgICAgIC8qIG9wdF9iaW5kaW5ncyAqLyB1bmRlZmluZWQsXG4gICAgICAgICAgLyogb3B0X2NvbGxlY3RWYXJzICovIHVuZGVmaW5lZCxcbiAgICAgICAgICAvKiBvcHRfd2hpdGVsaXN0ICovIHdoaXRlbGlzdCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVsZW1lbnQuaHJlZiA9IGhyZWY7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPj19IG9wdF9iaW5kaW5nc1xuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPj19IG9wdF9jb2xsZWN0VmFyc1xuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfc3luY1xuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPj19IG9wdF93aGl0ZUxpc3QgT3B0aW9uYWwgd2hpdGUgbGlzdCBvZiBuYW1lc1xuICAgKiAgICAgdGhhdCBjYW4gYmUgc3Vic3RpdHV0ZWQuXG4gICAqIEByZXR1cm4geyFQcm9taXNlPHN0cmluZz58c3RyaW5nfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZXhwYW5kXyh1cmwsIG9wdF9iaW5kaW5ncywgb3B0X2NvbGxlY3RWYXJzLCBvcHRfc3luYywgb3B0X3doaXRlTGlzdCkge1xuICAgIGNvbnN0IGlzVjJFeHBlcmltZW50T24gPSBpc0V4cGVyaW1lbnRPbih0aGlzLmFtcGRvYy53aW4sXG4gICAgICAgICd1cmwtcmVwbGFjZW1lbnQtdjInKTtcbiAgICBpZiAoaXNWMkV4cGVyaW1lbnRPbikge1xuICAgICAgLy8gVE9ETyhjY29yZHkpIHN1cHBvcnQgb3B0X2NvbGxlY3RWYXJzICYmIG9wdF93aGl0ZWxpc3RcbiAgICAgIHJldHVybiB0aGlzLmV4cGFuZGVyXy4vKk9LKi9leHBhbmQodXJsLCBvcHRfYmluZGluZ3MsIG9wdF9jb2xsZWN0VmFycyxcbiAgICAgICAgICBvcHRfc3luYywgb3B0X3doaXRlTGlzdCk7XG4gICAgfVxuXG4gICAgLy8gZXhpc3RpbmcgcGFyc2luZyBtZXRob2RcbiAgICBjb25zdCBleHByID0gdGhpcy52YXJpYWJsZVNvdXJjZV8uZ2V0RXhwcihvcHRfYmluZGluZ3MpO1xuICAgIGxldCByZXBsYWNlbWVudFByb21pc2U7XG4gICAgbGV0IHJlcGxhY2VtZW50ID0gdXJsLnJlcGxhY2UoZXhwciwgKG1hdGNoLCBuYW1lLCBvcHRfc3RyYXJncykgPT4ge1xuICAgICAgbGV0IGFyZ3MgPSBbXTtcbiAgICAgIGlmICh0eXBlb2Ygb3B0X3N0cmFyZ3MgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgYXJncyA9IG9wdF9zdHJhcmdzLnNwbGl0KC8sXFxzKi8pO1xuICAgICAgfVxuICAgICAgaWYgKG9wdF93aGl0ZUxpc3QgJiYgIW9wdF93aGl0ZUxpc3RbbmFtZV0pIHtcbiAgICAgICAgLy8gRG8gbm90IHBlcmZvcm0gc3Vic3RpdHV0aW9uIGFuZCBqdXN0IHJldHVybiBiYWNrIHRoZSBvcmlnaW5hbFxuICAgICAgICAvLyBtYXRjaCwgc28gdGhhdCB0aGUgc3RyaW5nIGRvZXNuJ3QgY2hhbmdlLlxuICAgICAgICByZXR1cm4gbWF0Y2g7XG4gICAgICB9XG4gICAgICBsZXQgYmluZGluZztcbiAgICAgIGlmIChvcHRfYmluZGluZ3MgJiYgKG5hbWUgaW4gb3B0X2JpbmRpbmdzKSkge1xuICAgICAgICBiaW5kaW5nID0gb3B0X2JpbmRpbmdzW25hbWVdO1xuICAgICAgfSBlbHNlIGlmICgoYmluZGluZyA9IHRoaXMudmFyaWFibGVTb3VyY2VfLmdldChuYW1lKSkpIHtcbiAgICAgICAgaWYgKG9wdF9zeW5jKSB7XG4gICAgICAgICAgYmluZGluZyA9IGJpbmRpbmcuc3luYztcbiAgICAgICAgICBpZiAoIWJpbmRpbmcpIHtcbiAgICAgICAgICAgIHVzZXIoKS5lcnJvcihUQUcsICdpZ25vcmluZyBhc3luYyByZXBsYWNlbWVudCBrZXk6ICcsIG5hbWUpO1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBiaW5kaW5nID0gYmluZGluZy5hc3luYyB8fCBiaW5kaW5nLnN5bmM7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGxldCB2YWw7XG4gICAgICB0cnkge1xuICAgICAgICB2YWwgPSAodHlwZW9mIGJpbmRpbmcgPT0gJ2Z1bmN0aW9uJykgP1xuICAgICAgICAgIGJpbmRpbmcuYXBwbHkobnVsbCwgYXJncykgOiBiaW5kaW5nO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBSZXBvcnQgZXJyb3IsIGJ1dCBkbyBub3QgZGlzcnVwdCBVUkwgcmVwbGFjZW1lbnQuIFRoaXMgd2lsbFxuICAgICAgICAvLyBpbnRlcnBvbGF0ZSBhcyB0aGUgZW1wdHkgc3RyaW5nLlxuICAgICAgICBpZiAob3B0X3N5bmMpIHtcbiAgICAgICAgICB2YWwgPSAnJztcbiAgICAgICAgfVxuICAgICAgICByZXRocm93QXN5bmMoZSk7XG4gICAgICB9XG4gICAgICAvLyBJbiBjYXNlIHRoZSBwcm9kdWNlZCB2YWx1ZSBpcyBhIHByb21pc2UsIHdlIGRvbid0IGFjdHVhbGx5XG4gICAgICAvLyByZXBsYWNlIGFueXRoaW5nIGhlcmUsIGJ1dCBkbyBpdCBhZ2FpbiB3aGVuIHRoZSBwcm9taXNlIHJlc29sdmVzLlxuICAgICAgaWYgKHZhbCAmJiB2YWwudGhlbikge1xuICAgICAgICBpZiAob3B0X3N5bmMpIHtcbiAgICAgICAgICB1c2VyKCkuZXJyb3IoVEFHLCAnaWdub3JpbmcgcHJvbWlzZSB2YWx1ZSBmb3Iga2V5OiAnLCBuYW1lKTtcbiAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cbiAgICAgICAgLyoqIEBjb25zdCB7UHJvbWlzZTxzdHJpbmc+fSAqL1xuICAgICAgICBjb25zdCBwID0gdmFsLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgLy8gUmVwb3J0IGVycm9yLCBidXQgZG8gbm90IGRpc3J1cHQgVVJMIHJlcGxhY2VtZW50LiBUaGlzIHdpbGxcbiAgICAgICAgICAvLyBpbnRlcnBvbGF0ZSBhcyB0aGUgZW1wdHkgc3RyaW5nLlxuICAgICAgICAgIHJldGhyb3dBc3luYyhlcnIpO1xuICAgICAgICB9KS50aGVuKHYgPT4ge1xuICAgICAgICAgIHJlcGxhY2VtZW50ID0gcmVwbGFjZW1lbnQucmVwbGFjZShtYXRjaCxcbiAgICAgICAgICAgICAgTk9FTkNPREVfV0hJVEVMSVNUW21hdGNoXSA/IHYgOiBlbmNvZGVWYWx1ZSh2KSk7XG4gICAgICAgICAgaWYgKG9wdF9jb2xsZWN0VmFycykge1xuICAgICAgICAgICAgb3B0X2NvbGxlY3RWYXJzW21hdGNoXSA9IHY7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHJlcGxhY2VtZW50UHJvbWlzZSkge1xuICAgICAgICAgIHJlcGxhY2VtZW50UHJvbWlzZSA9IHJlcGxhY2VtZW50UHJvbWlzZS50aGVuKCgpID0+IHApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlcGxhY2VtZW50UHJvbWlzZSA9IHA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1hdGNoO1xuICAgICAgfVxuICAgICAgaWYgKG9wdF9jb2xsZWN0VmFycykge1xuICAgICAgICBvcHRfY29sbGVjdFZhcnNbbWF0Y2hdID0gdmFsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIE5PRU5DT0RFX1dISVRFTElTVFttYXRjaF0gPyB2YWwgOiBlbmNvZGVWYWx1ZSh2YWwpO1xuICAgIH0pO1xuXG4gICAgaWYgKHJlcGxhY2VtZW50UHJvbWlzZSkge1xuICAgICAgcmVwbGFjZW1lbnRQcm9taXNlID0gcmVwbGFjZW1lbnRQcm9taXNlLnRoZW4oKCkgPT4gcmVwbGFjZW1lbnQpO1xuICAgIH1cblxuICAgIGlmIChvcHRfc3luYykge1xuICAgICAgcmV0dXJuIHJlcGxhY2VtZW50O1xuICAgIH1cbiAgICByZXR1cm4gcmVwbGFjZW1lbnRQcm9taXNlIHx8IFByb21pc2UucmVzb2x2ZShyZXBsYWNlbWVudCk7XG4gIH1cblxuICAvKipcbiAgICogQ29sbGVjdHMgYWxsIHN1YnN0aXR1dGlvbnMgaW4gdGhlIHByb3ZpZGVkIFVSTCBhbmQgZXhwYW5kcyB0aGVtIHRvIHRoZVxuICAgKiB2YWx1ZXMgZm9yIGtub3duIHZhcmlhYmxlcy4gT3B0aW9uYWwgYG9wdF9iaW5kaW5nc2AgY2FuIGJlIHVzZWQgdG8gYWRkXG4gICAqIG5ldyB2YXJpYWJsZXMgb3Igb3ZlcnJpZGUgZXhpc3Rpbmcgb25lcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPj19IG9wdF9iaW5kaW5nc1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhT2JqZWN0PHN0cmluZywgKj4+fVxuICAgKi9cbiAgY29sbGVjdFZhcnModXJsLCBvcHRfYmluZGluZ3MpIHtcbiAgICBjb25zdCB2YXJzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICByZXR1cm4gdGhpcy5leHBhbmRfKHVybCwgb3B0X2JpbmRpbmdzLCB2YXJzKS50aGVuKCgpID0+IHZhcnMpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbGxlY3RzIHN1YnN0aXR1dGlvbnMgaW4gdGhlIGBzcmNgIGF0dHJpYnV0ZSBvZiB0aGUgZ2l2ZW4gZWxlbWVudFxuICAgKiB0aGF0IGFyZSBfbm90XyB3aGl0ZWxpc3RlZCB2aWEgYGRhdGEtYW1wLXJlcGxhY2VgIG9wdC1pbiBhdHRyaWJ1dGUuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAgICogQHJldHVybiB7IUFycmF5PHN0cmluZz59XG4gICAqL1xuICBjb2xsZWN0VW53aGl0ZWxpc3RlZFZhcnNTeW5jKGVsZW1lbnQpIHtcbiAgICBjb25zdCB1cmwgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnc3JjJyk7XG4gICAgY29uc3QgdmFycyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgdGhpcy5leHBhbmRTdHJpbmdTeW5jKHVybCwgLyogb3B0X2JpbmRpbmdzICovIHVuZGVmaW5lZCwgdmFycyk7XG4gICAgY29uc3QgdmFyTmFtZXMgPSBPYmplY3Qua2V5cyh2YXJzKTtcblxuICAgIGNvbnN0IHdoaXRlbGlzdCA9IHRoaXMuZ2V0V2hpdGVsaXN0Rm9yRWxlbWVudF8oZWxlbWVudCk7XG4gICAgaWYgKHdoaXRlbGlzdCkge1xuICAgICAgcmV0dXJuIHZhck5hbWVzLmZpbHRlcih2ID0+ICF3aGl0ZWxpc3Rbdl0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBBbGwgdmFycyBhcmUgdW53aGl0ZWxpc3RlZCBpZiB0aGUgZWxlbWVudCBoYXMgbm8gd2hpdGVsaXN0LlxuICAgICAgcmV0dXJuIHZhck5hbWVzO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBFbnN1cmVzIHRoYXQgdGhlIHByb3RvY29sIG9mIHRoZSBvcmlnaW5hbCB1cmwgbWF0Y2hlcyB0aGUgcHJvdG9jb2wgb2YgdGhlXG4gICAqIHJlcGxhY2VtZW50IHVybC4gUmV0dXJucyB0aGUgcmVwbGFjZW1lbnQgaWYgdGhleSBkbywgdGhlIG9yaWdpbmFsIGlmIHRoZXlcbiAgICogZG8gbm90LlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gICAqIEBwYXJhbSB7c3RyaW5nfSByZXBsYWNlbWVudFxuICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAqL1xuICBlbnN1cmVQcm90b2NvbE1hdGNoZXNfKHVybCwgcmVwbGFjZW1lbnQpIHtcbiAgICBjb25zdCBuZXdQcm90b2NvbCA9IHBhcnNlVXJsRGVwcmVjYXRlZChyZXBsYWNlbWVudCwgLyogb3B0X25vY2FjaGUgKi8gdHJ1ZSlcbiAgICAgICAgLnByb3RvY29sO1xuICAgIGNvbnN0IG9sZFByb3RvY29sID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCwgLyogb3B0X25vY2FjaGUgKi8gdHJ1ZSlcbiAgICAgICAgLnByb3RvY29sO1xuICAgIGlmIChuZXdQcm90b2NvbCAhPSBvbGRQcm90b2NvbCkge1xuICAgICAgdXNlcigpLmVycm9yKFRBRywgJ0lsbGVnYWwgcmVwbGFjZW1lbnQgb2YgdGhlIHByb3RvY29sOiAnLCB1cmwpO1xuICAgICAgcmV0dXJuIHVybDtcbiAgICB9XG4gICAgdXNlcigpLmFzc2VydChpc1Byb3RvY29sVmFsaWQocmVwbGFjZW1lbnQpLFxuICAgICAgICAnVGhlIHJlcGxhY2VtZW50IHVybCBoYXMgaW52YWxpZCBwcm90b2NvbDogJXMnLCByZXBsYWNlbWVudCk7XG5cbiAgICByZXR1cm4gcmVwbGFjZW1lbnQ7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7VmFyaWFibGVTb3VyY2V9XG4gICAqL1xuICBnZXRWYXJpYWJsZVNvdXJjZSgpIHtcbiAgICByZXR1cm4gdGhpcy52YXJpYWJsZVNvdXJjZV87XG4gIH1cbn1cblxuLyoqXG4gKiBFeHRyYWN0cyBjbGllbnQgSUQgZnJvbSBhIF9nYSBjb29raWUuXG4gKiBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS9hbmFseXRpY3MvZGV2Z3VpZGVzL2NvbGxlY3Rpb24vYW5hbHl0aWNzanMvY29va2llcy11c2VyLWlkXG4gKiBAcGFyYW0ge3N0cmluZ30gZ2FDb29raWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RDbGllbnRJZEZyb21HYUNvb2tpZShnYUNvb2tpZSkge1xuICByZXR1cm4gZ2FDb29raWUucmVwbGFjZSgvXihHQTF8MSlcXC5bXFxkLV0rXFwuLywgJycpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IS4vYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGxVcmxSZXBsYWNlbWVudHNTZXJ2aWNlRm9yRG9jKGFtcGRvYykge1xuICByZWdpc3RlclNlcnZpY2VCdWlsZGVyRm9yRG9jKFxuICAgICAgYW1wZG9jLFxuICAgICAgJ3VybC1yZXBsYWNlJyxcbiAgICAgIGZ1bmN0aW9uKGRvYykge1xuICAgICAgICByZXR1cm4gbmV3IFVybFJlcGxhY2VtZW50cyhkb2MsIG5ldyBHbG9iYWxWYXJpYWJsZVNvdXJjZShkb2MpKTtcbiAgICAgIH0pO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshLi9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICogQHBhcmFtIHshV2luZG93fSBlbWJlZFdpblxuICogQHBhcmFtIHshVmFyaWFibGVTb3VyY2V9IHZhclNvdXJjZVxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbFVybFJlcGxhY2VtZW50c0ZvckVtYmVkKGFtcGRvYywgZW1iZWRXaW4sIHZhclNvdXJjZSkge1xuICBpbnN0YWxsU2VydmljZUluRW1iZWRTY29wZShlbWJlZFdpbiwgJ3VybC1yZXBsYWNlJyxcbiAgICAgIG5ldyBVcmxSZXBsYWNlbWVudHMoYW1wZG9jLCB2YXJTb3VyY2UpKTtcbn1cblxuLyoqXG4gKiBAdHlwZWRlZiB7e2luY29taW5nRnJhZ21lbnQ6IHN0cmluZywgb3V0Z29pbmdGcmFnbWVudDogc3RyaW5nfX1cbiAqL1xubGV0IFNoYXJlVHJhY2tpbmdGcmFnbWVudHNEZWY7XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCB7ZGV2fSBmcm9tICcuLi9sb2cnO1xuaW1wb3J0IHtpc0Zpbml0ZU51bWJlcn0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHtsb2FkUHJvbWlzZX0gZnJvbSAnLi4vZXZlbnQtaGVscGVyJztcblxuLyoqIEB0eXBlZGVmIHtzdHJpbmd8bnVtYmVyfGJvb2xlYW58dW5kZWZpbmVkfG51bGx9ICovXG5sZXQgUmVzb2x2ZXJSZXR1cm5EZWY7XG5cbi8qKiBAdHlwZWRlZiB7ZnVuY3Rpb24oLi4uKik6UmVzb2x2ZXJSZXR1cm5EZWZ9ICovXG5leHBvcnQgbGV0IFN5bmNSZXNvbHZlckRlZjtcblxuLyoqIEB0eXBlZGVmIHtmdW5jdGlvbiguLi4qKTohUHJvbWlzZTxSZXNvbHZlclJldHVybkRlZj59ICovXG5leHBvcnQgbGV0IEFzeW5jUmVzb2x2ZXJEZWY7XG5cbi8qKiBAdHlwZWRlZiB7e3N5bmM6IFN5bmNSZXNvbHZlckRlZiwgYXN5bmM6IEFzeW5jUmVzb2x2ZXJEZWZ9fSAqL1xubGV0IFJlcGxhY2VtZW50RGVmO1xuXG5cbi8qKlxuICogUmV0dXJucyBuYXZpZ2F0aW9uIHRpbWluZyBpbmZvcm1hdGlvbiBiYXNlZCBvbiB0aGUgc3RhcnQgYW5kIGVuZCBldmVudHMuXG4gKiBUaGUgZGF0YSBmb3IgdGhlIHRpbWluZyBldmVudHMgaXMgcmV0cmlldmVkIGZyb20gcGVyZm9ybWFuY2UudGltaW5nIEFQSS5cbiAqIElmIHN0YXJ0IGFuZCBlbmQgZXZlbnRzIGFyZSBib3RoIGdpdmVuLCB0aGUgcmVzdWx0IGlzIHRoZSBkaWZmZXJlbmNlIGJldHdlZW5cbiAqIHRoZSB0d28uIElmIG9ubHkgc3RhcnQgZXZlbnQgaXMgZ2l2ZW4sIHRoZSByZXN1bHQgaXMgdGhlIHRpbWluZyB2YWx1ZSBhdFxuICogc3RhcnQgZXZlbnQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IHN0YXJ0RXZlbnRcbiAqIEBwYXJhbSB7c3RyaW5nPX0gZW5kRXZlbnRcbiAqIEByZXR1cm4geyFQcm9taXNlPFJlc29sdmVyUmV0dXJuRGVmPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRpbWluZ0RhdGFBc3luYyh3aW4sIHN0YXJ0RXZlbnQsIGVuZEV2ZW50KSB7XG4gIHJldHVybiBsb2FkUHJvbWlzZSh3aW4pLnRoZW4oKCkgPT4ge1xuICAgIHJldHVybiBnZXRUaW1pbmdEYXRhU3luYyh3aW4sIHN0YXJ0RXZlbnQsIGVuZEV2ZW50KTtcbiAgfSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBuYXZpZ2F0aW9uIHRpbWluZyBpbmZvcm1hdGlvbiBiYXNlZCBvbiB0aGUgc3RhcnQgYW5kIGVuZCBldmVudHMuXG4gKiBUaGUgZGF0YSBmb3IgdGhlIHRpbWluZyBldmVudHMgaXMgcmV0cmlldmVkIGZyb20gcGVyZm9ybWFuY2UudGltaW5nIEFQSS5cbiAqIElmIHN0YXJ0IGFuZCBlbmQgZXZlbnRzIGFyZSBib3RoIGdpdmVuLCB0aGUgcmVzdWx0IGlzIHRoZSBkaWZmZXJlbmNlIGJldHdlZW5cbiAqIHRoZSB0d28uIElmIG9ubHkgc3RhcnQgZXZlbnQgaXMgZ2l2ZW4sIHRoZSByZXN1bHQgaXMgdGhlIHRpbWluZyB2YWx1ZSBhdFxuICogc3RhcnQgZXZlbnQuIEVuZm9yY2VzIHN5bmNocm9ub3VzIGV2YWx1YXRpb24uXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IHN0YXJ0RXZlbnRcbiAqIEBwYXJhbSB7c3RyaW5nPX0gZW5kRXZlbnRcbiAqIEByZXR1cm4ge1Jlc29sdmVyUmV0dXJuRGVmfSB1bmRlZmluZWQgaWYgQVBJIGlzIG5vdCBhdmFpbGFibGUsIGVtcHR5IHN0cmluZ1xuICogICAgaWYgaXQgaXMgbm90IHlldCBhdmFpbGFibGUsIG9yIHZhbHVlIGFzIHN0cmluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGltaW5nRGF0YVN5bmMod2luLCBzdGFydEV2ZW50LCBlbmRFdmVudCkge1xuICBjb25zdCB0aW1pbmdJbmZvID0gd2luWydwZXJmb3JtYW5jZSddICYmIHdpblsncGVyZm9ybWFuY2UnXVsndGltaW5nJ107XG4gIGlmICghdGltaW5nSW5mbyB8fCB0aW1pbmdJbmZvWyduYXZpZ2F0aW9uU3RhcnQnXSA9PSAwKSB7XG4gICAgLy8gTmF2aWdhdGlvbiB0aW1pbmcgQVBJIGlzIG5vdCBzdXBwb3J0ZWQuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgbWV0cmljID0gKGVuZEV2ZW50ID09PSB1bmRlZmluZWQpXG4gICAgPyB0aW1pbmdJbmZvW3N0YXJ0RXZlbnRdXG4gICAgOiB0aW1pbmdJbmZvW2VuZEV2ZW50XSAtIHRpbWluZ0luZm9bc3RhcnRFdmVudF07XG5cbiAgaWYgKCFpc0Zpbml0ZU51bWJlcihtZXRyaWMpIHx8IG1ldHJpYyA8IDApIHtcbiAgICAvLyBUaGUgbWV0cmljIGlzIG5vdCBzdXBwb3J0ZWQuXG4gICAgcmV0dXJuO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBtZXRyaWM7XG4gIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIG5hdmlnYXRpb24gaW5mb3JtYXRpb24gZnJvbSB0aGUgY3VycmVudCBicm93c2luZyBjb250ZXh0LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyaWJ1dGVcbiAqIEByZXR1cm4ge1Jlc29sdmVyUmV0dXJuRGVmfVxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE5hdmlnYXRpb25EYXRhKHdpbiwgYXR0cmlidXRlKSB7XG4gIGNvbnN0IG5hdmlnYXRpb25JbmZvID0gd2luWydwZXJmb3JtYW5jZSddICYmXG4gICAgd2luWydwZXJmb3JtYW5jZSddWyduYXZpZ2F0aW9uJ107XG4gIGlmICghbmF2aWdhdGlvbkluZm8gfHwgbmF2aWdhdGlvbkluZm9bYXR0cmlidXRlXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gUGVyZm9ybWFuY2VOYXZpZ2F0aW9uIGludGVyZmFjZSBpcyBub3Qgc3VwcG9ydGVkIG9yIGF0dHJpYnV0ZSBpcyBub3RcbiAgICAvLyBpbXBsZW1lbnRlZC5cbiAgICByZXR1cm47XG4gIH1cbiAgcmV0dXJuIG5hdmlnYXRpb25JbmZvW2F0dHJpYnV0ZV07XG59XG5cblxuLyoqXG4gKiBBIGNsYXNzIHRvIHByb3ZpZGUgdmFyaWFibGUgc3Vic3RpdHV0aW9uIHJlbGF0ZWQgZmVhdHVyZXMuIEV4dGVuZCB0aGlzIGNsYXNzXG4gKiBhbmQgb3ZlcnJpZGUgaW5pdGlhbGl6ZSgpIHRvIGFkZCBtb3JlIHN1cHBvcnRlZCB2YXJpYWJsZXMuXG4gKi9cbmV4cG9ydCBjbGFzcyBWYXJpYWJsZVNvdXJjZSB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyEuL2FtcGRvYy1pbXBsLkFtcERvY30gYW1wZG9jXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhbXBkb2MpIHtcbiAgICAvKiogQHByb3RlY3RlZCBAY29uc3QgeyEuL2FtcGRvYy1pbXBsLkFtcERvY30gKi9cbiAgICB0aGlzLmFtcGRvYyA9IGFtcGRvYztcblxuICAgIC8qKiBAcHJpdmF0ZSB7IVJlZ0V4cHx1bmRlZmluZWR9ICovXG4gICAgdGhpcy5yZXBsYWNlbWVudEV4cHJfID0gdW5kZWZpbmVkO1xuXG4gICAgLyoqIEBwcml2YXRlIHshUmVnRXhwfHVuZGVmaW5lZH0gKi9cbiAgICB0aGlzLnJlcGxhY2VtZW50RXhwclYyXyA9IHVuZGVmaW5lZDtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFPYmplY3Q8c3RyaW5nLCAhUmVwbGFjZW1lbnREZWY+fSAqL1xuICAgIHRoaXMucmVwbGFjZW1lbnRzXyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cbiAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgdGhpcy5pbml0aWFsaXplZF8gPSBmYWxzZTtcblxuICAgIHRoaXMuZ2V0VXJsTWFjcm9XaGl0ZWxpc3RfKCk7XG4gIH1cblxuICAvKipcbiAgICogTGF6aWx5IGluaXRpYWxpemUgdGhlIGRlZmF1bHQgcmVwbGFjZW1lbnRzLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgaW5pdGlhbGl6ZV8oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplKCk7XG4gICAgdGhpcy5pbml0aWFsaXplZF8gPSB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIE92ZXJyaWRlIHRoaXMgbWV0aG9kIHRvIHNldCBhbGwgdGhlIHZhcmlhYmxlcyBzdXBwb3J0ZWQgYnkgZGVyaXZlZCBjbGFzcy5cbiAgICovXG4gIGluaXRpYWxpemUoKSB7XG4gICAgLy8gTmVlZHMgdG8gYmUgaW1wbGVtZW50ZWQgYnkgZGVyaXZlZCBjbGFzc2VzLlxuICB9XG5cbiAgLyoqXG4gICAqIE1ldGhvZCBleGlzdHMgdG8gYXNzaXN0IHN0dWJiaW5nIGluIHRlc3RzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcmV0dXJuIHshUmVwbGFjZW1lbnREZWZ9XG4gICAqL1xuICBnZXQobmFtZSkge1xuICAgIGlmICghdGhpcy5pbml0aWFsaXplZF8pIHtcbiAgICAgIHRoaXMuaW5pdGlhbGl6ZV8oKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5yZXBsYWNlbWVudHNfW25hbWVdO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgYSBzeW5jaHJvbm91cyB2YWx1ZSByZXNvbHZlciBmb3IgdGhlIHZhcmlhYmxlIHdpdGggdGhlIHNwZWNpZmllZCBuYW1lLlxuICAgKiBUaGUgdmFsdWUgcmVzb2x2ZXIgbWF5IG9wdGlvbmFsbHkgdGFrZSBhbiBleHRyYSBwYXJhbWV0ZXIuXG4gICAqIENhbiBiZSBjYWxsZWQgaW4gY29uanVuY3Rpb24gd2l0aCBzZXRBc3luYyB0byBhbGxvdyBmb3IgYWRkaXRpb25hbFxuICAgKiBhc3luY2hyb25vdXMgcmVzb2x2ZXIgd2hlcmUgZXhwYW5kIHdpbGwgdXNlIGFzeW5jIGFuZCBleHBhbmRTeW5jIHRoZSBzeW5jXG4gICAqIHZlcnNpb24uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2YXJOYW1lXG4gICAqIEBwYXJhbSB7IVN5bmNSZXNvbHZlckRlZn0gc3luY1Jlc29sdmVyXG4gICAqIEByZXR1cm4geyFWYXJpYWJsZVNvdXJjZX1cbiAgICovXG4gIHNldCh2YXJOYW1lLCBzeW5jUmVzb2x2ZXIpIHtcbiAgICBkZXYoKS5hc3NlcnQodmFyTmFtZS5pbmRleE9mKCdSRVRVUk4nKSA9PSAtMSk7XG4gICAgdGhpcy5yZXBsYWNlbWVudHNfW3Zhck5hbWVdID1cbiAgICAgICAgdGhpcy5yZXBsYWNlbWVudHNfW3Zhck5hbWVdIHx8IHtzeW5jOiB1bmRlZmluZWQsIGFzeW5jOiB1bmRlZmluZWR9O1xuICAgIHRoaXMucmVwbGFjZW1lbnRzX1t2YXJOYW1lXS5zeW5jID0gc3luY1Jlc29sdmVyO1xuICAgIHRoaXMucmVwbGFjZW1lbnRFeHByXyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnJlcGxhY2VtZW50RXhwclYyXyA9IHVuZGVmaW5lZDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIGFuIGFzeW5jIHZhbHVlIHJlc29sdmVyIGZvciB0aGUgdmFyaWFibGUgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUuXG4gICAqIFRoZSB2YWx1ZSByZXNvbHZlciBtYXkgb3B0aW9uYWxseSB0YWtlIGFuIGV4dHJhIHBhcmFtZXRlci5cbiAgICogQ2FuIGJlIGNhbGxlZCBpbiBjb25qdWN0aW9uIHdpdGggc2V0QXN5bmMgdG8gYWxsb3cgZm9yIGFkZGl0aW9uYWxcbiAgICogYXN5bmNocm9ub3VzIHJlc29sdmVyIHdoZXJlIGV4cGFuZCB3aWxsIHVzZSBhc3luYyBhbmQgZXhwYW5kU3luYyB0aGUgc3luY1xuICAgKiB2ZXJzaW9uLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmFyTmFtZVxuICAgKiBAcGFyYW0geyFBc3luY1Jlc29sdmVyRGVmfSBhc3luY1Jlc29sdmVyXG4gICAqIEByZXR1cm4geyFWYXJpYWJsZVNvdXJjZX1cbiAgICovXG4gIHNldEFzeW5jKHZhck5hbWUsIGFzeW5jUmVzb2x2ZXIpIHtcbiAgICBkZXYoKS5hc3NlcnQodmFyTmFtZS5pbmRleE9mKCdSRVRVUk4nKSA9PSAtMSk7XG4gICAgdGhpcy5yZXBsYWNlbWVudHNfW3Zhck5hbWVdID1cbiAgICAgICAgdGhpcy5yZXBsYWNlbWVudHNfW3Zhck5hbWVdIHx8IHtzeW5jOiB1bmRlZmluZWQsIGFzeW5jOiB1bmRlZmluZWR9O1xuICAgIHRoaXMucmVwbGFjZW1lbnRzX1t2YXJOYW1lXS5hc3luYyA9IGFzeW5jUmVzb2x2ZXI7XG4gICAgdGhpcy5yZXBsYWNlbWVudEV4cHJfID0gdW5kZWZpbmVkO1xuICAgIHRoaXMucmVwbGFjZW1lbnRFeHByVjJfID0gdW5kZWZpbmVkO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEhlbHBlciBtZXRob2QgdG8gc2V0IGJvdGggc3luYyBhbmQgYXN5bmMgcmVzb2x2ZXJzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmFyTmFtZVxuICAgKiBAcGFyYW0geyFTeW5jUmVzb2x2ZXJEZWZ9IHN5bmNSZXNvbHZlclxuICAgKiBAcGFyYW0geyFBc3luY1Jlc29sdmVyRGVmfSBhc3luY1Jlc29sdmVyXG4gICAqIEByZXR1cm4geyFWYXJpYWJsZVNvdXJjZX1cbiAgICovXG4gIHNldEJvdGgodmFyTmFtZSwgc3luY1Jlc29sdmVyLCBhc3luY1Jlc29sdmVyKSB7XG4gICAgcmV0dXJuIHRoaXMuc2V0KHZhck5hbWUsIHN5bmNSZXNvbHZlcikuc2V0QXN5bmModmFyTmFtZSwgYXN5bmNSZXNvbHZlcik7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIFJlZ3VsYXIgZXhwcmVzc2lvbiB0aGF0IGNhbiBiZSB1c2VkIHRvIGRldGVjdCBhbGwgdGhlIHZhcmlhYmxlc1xuICAgKiBpbiBhIHRlbXBsYXRlLlxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPj19IG9wdF9iaW5kaW5nc1xuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBpc1YyIEZsYWcgdG8gaWdub3JlIGNhcHR1cmUgb2YgYXJncy5cbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgYm9vbGVhbj49fSBvcHRfd2hpdGVMaXN0IE9wdGlvbmFsIHdoaXRlIGxpc3Qgb2YgbmFtZXNcbiAgICogICB0aGF0IGNhbiBiZSBzdWJzdGl0dXRlZC5cbiAgICovXG4gIGdldEV4cHIob3B0X2JpbmRpbmdzLCBpc1YyLCBvcHRfd2hpdGVMaXN0KSB7XG4gICAgaWYgKCF0aGlzLmluaXRpYWxpemVkXykge1xuICAgICAgdGhpcy5pbml0aWFsaXplXygpO1xuICAgIH1cblxuICAgIGNvbnN0IGFkZGl0aW9uYWxLZXlzID0gb3B0X2JpbmRpbmdzID8gT2JqZWN0LmtleXMob3B0X2JpbmRpbmdzKSA6IG51bGw7XG4gICAgaWYgKGFkZGl0aW9uYWxLZXlzICYmIGFkZGl0aW9uYWxLZXlzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IGFsbEtleXMgPSBPYmplY3Qua2V5cyh0aGlzLnJlcGxhY2VtZW50c18pO1xuICAgICAgYWRkaXRpb25hbEtleXMuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBpZiAodGhpcy5yZXBsYWNlbWVudHNfW2tleV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGFsbEtleXMucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0aGlzLmJ1aWxkRXhwcl8oYWxsS2V5cywgaXNWMiwgb3B0X3doaXRlTGlzdCk7XG4gICAgfVxuICAgIGlmICghdGhpcy5yZXBsYWNlbWVudEV4cHJfICYmICFpc1YyKSB7XG4gICAgICB0aGlzLnJlcGxhY2VtZW50RXhwcl8gPSB0aGlzLmJ1aWxkRXhwcl8oXG4gICAgICAgICAgT2JqZWN0LmtleXModGhpcy5yZXBsYWNlbWVudHNfKSk7XG4gICAgfVxuICAgIC8vIHNvbWV0aW1lcyB0aGUgdjEgZXhwYW5kIHdpbGwgYmUgY2FsbGVkIGJlZm9yZSB0aGUgdjJcbiAgICAvLyBzbyB3ZSBuZWVkIHRvIGNhY2hlIGJvdGggdmVyc2lvbnNcbiAgICBpZiAoIXRoaXMucmVwbGFjZW1lbnRFeHByVjJfICYmIGlzVjIpIHtcbiAgICAgIHRoaXMucmVwbGFjZW1lbnRFeHByVjJfID0gdGhpcy5idWlsZEV4cHJfKFxuICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMucmVwbGFjZW1lbnRzXyksIGlzVjIsIG9wdF93aGl0ZUxpc3QpO1xuICAgIH1cblxuICAgIHJldHVybiBpc1YyID8gdGhpcy5yZXBsYWNlbWVudEV4cHJWMl8gOlxuICAgICAgdGhpcy5yZXBsYWNlbWVudEV4cHJfO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IGtleXNcbiAgICogQHBhcmFtIHtib29sZWFuPX0gaXNWMiBmbGFnIHRvIGlnbm9yZSBjYXB0dXJlIG9mIGFyZ3NcbiAgICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgYm9vbGVhbj49fSBvcHRfd2hpdGVMaXN0IE9wdGlvbmFsIHdoaXRlIGxpc3Qgb2YgbmFtZXNcbiAgICogICB0aGF0IGNhbiBiZSBzdWJzdGl0dXRlZC5cbiAgICogQHJldHVybiB7IVJlZ0V4cH1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGJ1aWxkRXhwcl8oa2V5cywgaXNWMiwgb3B0X3doaXRlTGlzdCkge1xuICAgIC8vIElmIGEgd2hpdGVsaXN0IGlzIHByZXNlbnQsIHRoZSBrZXlzIG11c3QgYmVsb25nIHRvIHRoZSB3aGl0ZWxpc3QuXG4gICAgLy8gV2UgZmlsdGVyIHRoZSBrZXlzIG9uZSBsYXN0IHRpbWUgdG8gZW5zdXJlIG5vIHVud2hpdGVsaXN0ZWQga2V5IGlzXG4gICAgLy8gYWxsb3dlZC5cbiAgICBpZiAodGhpcy5nZXRVcmxNYWNyb1doaXRlbGlzdF8oKSkge1xuICAgICAga2V5cyA9IGtleXMuZmlsdGVyKGtleSA9PiB0aGlzLmdldFVybE1hY3JvV2hpdGVsaXN0XygpLmluY2x1ZGVzKGtleSkpO1xuICAgIH1cbiAgICAvLyBJZiBhIHdoaXRlbGlzdCBpcyBwYXNzZWQgaW50byB0aGUgY2FsbCB0byBHbG9iYWxWYXJpYWJsZVNvdXJjZS5leHBhbmRfXG4gICAgLy8gdGhlbiB3ZSBvbmx5IHJlc29sdmUgdmFsdWVzIGNvbnRhaW5lZCBpbiB0aGUgd2hpdGVsaXN0LlxuICAgIGlmIChvcHRfd2hpdGVMaXN0KSB7XG4gICAgICBrZXlzID0ga2V5cy5maWx0ZXIoa2V5ID0+IG9wdF93aGl0ZUxpc3Rba2V5XSk7XG4gICAgfVxuICAgIC8vIFRoZSBrZXlzIG11c3QgYmUgc29ydGVkIHRvIGVuc3VyZSB0aGF0IHRoZSBsb25nZXN0IGtleXMgYXJlIGNvbnNpZGVyZWRcbiAgICAvLyBmaXJzdC4gVGhpcyBhdm9pZHMgYSBwcm9ibGVtIHdoZXJlIGEgUkFORE9NIGNvbmZsaWN0cyB3aXRoIFJBTkRPTV9PTkUuXG4gICAga2V5cy5zb3J0KChzMSwgczIpID0+IHMyLmxlbmd0aCAtIHMxLmxlbmd0aCk7XG4gICAgLy8gS2V5cyB0aGF0IHN0YXJ0IHdpdGggYSBgJGAgbmVlZCB0byBiZSBlc2NhcGVkIHNvIHRoYXQgdGhleSBkbyBub3RcbiAgICAvLyBpbnRlcmZlcmUgd2l0aCB0aGUgcmVnZXggdGhhdCBpcyBjb25zdHJ1Y3RlZC5cbiAgICBjb25zdCBlc2NhcGVkID0ga2V5cy5tYXAoa2V5ID0+IHtcbiAgICAgIGlmIChrZXlbMF0gPT09ICckJykge1xuICAgICAgICByZXR1cm4gJ1xcXFwnICsga2V5O1xuICAgICAgfVxuICAgICAgcmV0dXJuIGtleTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGFsbCA9IGVzY2FwZWQuam9pbignfCcpO1xuICAgIC8vIE1hdGNoIHRoZSBnaXZlbiByZXBsYWNlbWVudCBwYXR0ZXJucywgYXMgd2VsbCBhcyBvcHRpb25hbGx5XG4gICAgLy8gYXJndW1lbnRzIHRvIHRoZSByZXBsYWNlbWVudCBiZWhpbmQgaXQgaW4gcGFyZW50aGVzZXMuXG4gICAgLy8gRXhhbXBsZSBzdHJpbmcgdGhhdCBtYXRjaFxuICAgIC8vIEZPT19CQVJcbiAgICAvLyBGT09fQkFSKGFyZzEpXG4gICAgLy8gRk9PX0JBUihhcmcxLGFyZzIpXG4gICAgLy8gRk9PX0JBUihhcmcxLCBhcmcyKVxuICAgIGxldCByZWdleFN0ciA9ICdcXFxcJD8oJyArIGFsbCArICcpJztcbiAgICAvLyBpZ25vcmUgdGhlIGNhcHR1cmluZyBvZiBhcmd1bWVudHMgaW4gbmV3IHBhcnNlclxuICAgIGlmICghaXNWMikge1xuICAgICAgcmVnZXhTdHIgKz0gJyg/OlxcXFwoKCg/OlxcXFxzKlswLTlhLXpBLVotXy5dKlxcXFxzKig/PSx8XFxcXCkpLD8pKilcXFxccypcXFxcKSk/JztcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBSZWdFeHAocmVnZXhTdHIsICdnJyk7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7P0FycmF5PHN0cmluZz59IFRoZSB3aGl0ZWxpc3Qgb2YgYWxsb3dlZCBBTVAgdmFyaWFibGVzLiAoaWYgcHJvdmlkZWQgaW5cbiAgICogICAgIGEgbWV0YSB0YWcpLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0VXJsTWFjcm9XaGl0ZWxpc3RfKCkge1xuICAgIGlmICh0aGlzLnZhcmlhYmxlV2hpdGVsaXN0Xykge1xuICAgICAgcmV0dXJuIHRoaXMudmFyaWFibGVXaGl0ZWxpc3RfO1xuICAgIH1cblxuICAgIGNvbnN0IHtoZWFkfSA9IHRoaXMuYW1wZG9jLmdldFJvb3ROb2RlKCk7XG4gICAgaWYgKCFoZWFkKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBBIG1ldGFbbmFtZT1cImFtcC1hbGxvd2VkLXVybC1tYWNyb3NcIl0gdGFnLCBpZiBwcmVzZW50LFxuICAgIC8vIGNvbnRhaW5zLCBpbiBpdHMgY29udGVudCBhdHRyaWJ1dGUsIGEgd2hpdGVsaXN0IG9mIHZhcmlhYmxlIHN1YnN0aXR1dGlvbi5cbiAgICBjb25zdCBtZXRhID1cbiAgICAgIGhlYWQucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPVwiYW1wLWFsbG93ZWQtdXJsLW1hY3Jvc1wiXScpO1xuICAgIGlmICghbWV0YSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHdoaXRlbGlzdCBvZiB2YXJpYWJsZXMgYWxsb3dlZCBmb3IgdmFyaWFibGUgc3Vic3RpdHV0aW9uLlxuICAgICAqIEBwcml2YXRlIHs/QXJyYXk8c3RyaW5nPn1cbiAgICAgKi9cbiAgICB0aGlzLnZhcmlhYmxlV2hpdGVsaXN0XyA9IG1ldGEuZ2V0QXR0cmlidXRlKCdjb250ZW50Jykuc3BsaXQoJywnKVxuICAgICAgICAubWFwKHZhcmlhYmxlID0+IHZhcmlhYmxlLnRyaW0oKSk7XG4gICAgcmV0dXJuIHRoaXMudmFyaWFibGVXaGl0ZWxpc3RfO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgZ2V0QW1wZG9jLFxuICBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUsXG4gIGdldEV4aXN0aW5nU2VydmljZU9yTnVsbCxcbiAgZ2V0U2VydmljZSxcbiAgZ2V0U2VydmljZUZvckRvYyxcbiAgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQsXG4gIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jLFxufSBmcm9tICcuL3NlcnZpY2UnO1xuaW1wb3J0IHtcbiAgZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MsXG4gIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUsXG4gIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MsXG4gIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2NJbkVtYmVkU2NvcGUsXG59IGZyb20gJy4vZWxlbWVudC1zZXJ2aWNlJztcblxuLyoqIEB0eXBlZGVmIHshLi4vZXh0ZW5zaW9ucy9hbXAtc3Vic2NyaXB0aW9ucy8wLjEvYW1wLXN1YnNjcmlwdGlvbnMuU3Vic2NyaXB0aW9uU2VydmljZX0gKi9cbmV4cG9ydCBsZXQgU3Vic2NyaXB0aW9uU2VydmljZTtcblxuZXhwb3J0IGNsYXNzIFNlcnZpY2VzIHtcbiAgLyoqXG4gICAqIEhpbnQ6IEFkZCBleHRlbnNpb25zIGZvbGRlciBwYXRoIHRvIGNvbXBpbGUuanMgd2l0aFxuICAgKiB3YXJuaW5ncyBjYW5ub3QgZmluZCBtb2R1bGVzLlxuICAgKi9cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBBY2Nlc3Mgc2VydmljZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hY2Nlc3MvMC4xL2FtcC1hY2Nlc3MuQWNjZXNzU2VydmljZT59XG4gICAqL1xuICBzdGF0aWMgYWNjZXNzU2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8IS4uL2V4dGVuc2lvbnMvYW1wLWFjY2Vzcy8wLjEvYW1wLWFjY2Vzcy5BY2Nlc3NTZXJ2aWNlPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnYWNjZXNzJywgJ2FtcC1hY2Nlc3MnKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIGZvciB0aGUgQWNjZXNzIHNlcnZpY2Ugb3IgYSBwcm9taXNlIGZvciBudWxsIGlmIHRoZVxuICAgKiBzZXJ2aWNlIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1hY2Nlc3MvMC4xL2FtcC1hY2Nlc3MuQWNjZXNzU2VydmljZT59XG4gICAqL1xuICBzdGF0aWMgYWNjZXNzU2VydmljZUZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWFjY2Vzcy8wLjEvYW1wLWFjY2Vzcy5BY2Nlc3NTZXJ2aWNlPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdhY2Nlc3MnLFxuICAgICAgICAgICdhbXAtYWNjZXNzJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIFN1YnNjcmlwdGlvbnMgc2VydmljZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCFTdWJzY3JpcHRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBzdWJzY3JpcHRpb25zU2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8IVN1YnNjcmlwdGlvblNlcnZpY2U+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdzdWJzY3JpcHRpb25zJyxcbiAgICAgICAgICAnYW1wLXN1YnNjcmlwdGlvbnMnKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIGZvciB0aGUgU3Vic2NyaXB0aW9ucyBzZXJ2aWNlLlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8P1N1YnNjcmlwdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIHN1YnNjcmlwdGlvbnNTZXJ2aWNlRm9yRG9jT3JOdWxsKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAoLyoqIEB0eXBlIHshUHJvbWlzZTw/U3Vic2NyaXB0aW9uU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnc3Vic2NyaXB0aW9ucycsXG4gICAgICAgICAgJ2FtcC1zdWJzY3JpcHRpb25zJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVbmxpa2UgbW9zdCBzZXJ2aWNlIGdldHRlcnMsIHBhc3NpbmcgYE5vZGVgIGlzIG5lY2Vzc2FyeSBmb3Igc29tZSBGSUUtc2NvcGVcbiAgICogc2VydmljZXMgc2luY2Ugc29tZXRpbWVzIHdlIG9ubHkgaGF2ZSB0aGUgRklFIERvY3VtZW50IGZvciBjb250ZXh0LlxuICAgKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9hY3Rpb24taW1wbC5BY3Rpb25TZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIGFjdGlvblNlcnZpY2VGb3JEb2Mobm9kZU9yRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9hY3Rpb24taW1wbC5BY3Rpb25TZXJ2aWNlfSAqLyAoXG4gICAgICBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUoXG4gICAgICAgICAgbm9kZU9yRG9jLCAnYWN0aW9uJywgLyogb3B0X2ZhbGxiYWNrVG9Ub3BXaW4gKi8gdHJ1ZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhQWN0aXZpdHk+fVxuICAgKi9cbiAgc3RhdGljIGFjdGl2aXR5Rm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPCFBY3Rpdml0eT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2FjdGl2aXR5JywgJ2FtcC1hbmFseXRpY3MnKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgZ2xvYmFsIGluc3RhbmNlIG9mIHRoZSBgQW1wRG9jU2VydmljZWAgc2VydmljZSB0aGF0IGNhbiBiZVxuICAgKiB1c2VkIHRvIHJlc29sdmUgYW4gYW1wZG9jIGZvciBhbnkgbm9kZTogZWl0aGVyIGluIHRoZSBzaW5nbGUtZG9jIG9yXG4gICAqIHNoYWRvdy1kb2MgZW52aXJvbm1lbnQuXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBhbXBkb2NTZXJ2aWNlRm9yKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jU2VydmljZX0gKi8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdhbXBkb2MnKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgQW1wRG9jIGZvciB0aGUgc3BlY2lmaWVkIGNvbnRleHQgbm9kZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfVxuICAgKi9cbiAgc3RhdGljIGFtcGRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gZ2V0QW1wZG9jKGVsZW1lbnRPckFtcERvYyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IGxvYWRBbmFseXRpY3NcbiAgICogQHJldHVybiB7IVByb21pc2U8IS4uL2V4dGVuc2lvbnMvYW1wLWFuYWx5dGljcy8wLjEvaW5zdHJ1bWVudGF0aW9uLkluc3RydW1lbnRhdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFuYWx5dGljc0ZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGxvYWRBbmFseXRpY3MgPSBmYWxzZSkge1xuICAgIGlmIChsb2FkQW5hbHl0aWNzKSB7XG4gICAgICAvLyBHZXQgRXh0ZW5zaW9ucyBzZXJ2aWNlIGFuZCBmb3JjZSBsb2FkIGFuYWx5dGljcyBleHRlbnNpb24uXG4gICAgICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2MoZWxlbWVudE9yQW1wRG9jKTtcbiAgICAgIFNlcnZpY2VzLmV4dGVuc2lvbnNGb3IoYW1wZG9jLndpbikuLypPSyovaW5zdGFsbEV4dGVuc2lvbkZvckRvYyhcbiAgICAgICAgICBhbXBkb2MsICdhbXAtYW5hbHl0aWNzJyk7XG4gICAgfVxuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hbmFseXRpY3MvMC4xL2luc3RydW1lbnRhdGlvbi5JbnN0cnVtZW50YXRpb25TZXJ2aWNlPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnYW1wLWFuYWx5dGljcy1pbnN0cnVtZW50YXRpb24nLFxuICAgICAgICAgICdhbXAtYW5hbHl0aWNzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYW5hbHl0aWNzLzAuMS9pbnN0cnVtZW50YXRpb24uSW5zdHJ1bWVudGF0aW9uU2VydmljZT59XG4gICAqL1xuICBzdGF0aWMgYW5hbHl0aWNzRm9yRG9jT3JOdWxsKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1hbmFseXRpY3MvMC4xL2luc3RydW1lbnRhdGlvbi5JbnN0cnVtZW50YXRpb25TZXJ2aWNlPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsXG4gICAgICAgICAgJ2FtcC1hbmFseXRpY3MtaW5zdHJ1bWVudGF0aW9uJywgJ2FtcC1hbmFseXRpY3MnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9iYXRjaGVkLXhoci1pbXBsLkJhdGNoZWRYaHJ9XG4gICAqL1xuICBzdGF0aWMgYmF0Y2hlZFhockZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2JhdGNoZWQteGhyLWltcGwuQmF0Y2hlZFhocn0gKi8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdiYXRjaGVkLXhocicpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWJpbmQvMC4xL2JpbmQtaW1wbC5CaW5kPn1cbiAgICovXG4gIHN0YXRpYyBiaW5kRm9yRG9jT3JOdWxsKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1iaW5kLzAuMS9iaW5kLWltcGwuQmluZD59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2NJbkVtYmVkU2NvcGUoXG4gICAgICAgICAgZWxlbWVudE9yQW1wRG9jLCAnYmluZCcsICdhbXAtYmluZCcpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8IS4vc2VydmljZS9jaWQtaW1wbC5DaWQ+fVxuICAgKi9cbiAgc3RhdGljIGNpZEZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi9zZXJ2aWNlL2NpZC1pbXBsLkNpZD59ICovIChcbiAgICAgIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2NpZCcpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9uYXZpZ2F0aW9uLk5hdmlnYXRpb259XG4gICAqL1xuICBzdGF0aWMgbmF2aWdhdGlvbkZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL25hdmlnYXRpb24uTmF2aWdhdGlvbn0gKi8gKFxuICAgICAgZ2V0U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICduYXZpZ2F0aW9uJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvY3J5cHRvLWltcGwuQ3J5cHRvfVxuICAgKi9cbiAgc3RhdGljIGNyeXB0b0Zvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IS4vc2VydmljZS9jcnlwdG8taW1wbC5DcnlwdG99ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAnY3J5cHRvJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9kb2N1bWVudC1pbmZvLWltcGwuRG9jdW1lbnRJbmZvRGVmfSBJbmZvIGFib3V0IHRoZSBkb2NcbiAgICovXG4gIHN0YXRpYyBkb2N1bWVudEluZm9Gb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9kb2N1bWVudC1pbmZvLWltcGwuRG9jSW5mb30gKi8gKFxuICAgICAgZ2V0U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdkb2N1bWVudEluZm8nKSkuZ2V0KCk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9kb2N1bWVudC1zdGF0ZS5Eb2N1bWVudFN0YXRlfVxuICAgKi9cbiAgc3RhdGljIGRvY3VtZW50U3RhdGVGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2Uod2luZG93LCAnZG9jdW1lbnRTdGF0ZScpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvZXh0ZW5zaW9ucy1pbXBsLkV4dGVuc2lvbnN9XG4gICAqL1xuICBzdGF0aWMgZXh0ZW5zaW9uc0Zvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2V4dGVuc2lvbnMtaW1wbC5FeHRlbnNpb25zfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ2V4dGVuc2lvbnMnKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBzZXJ2aWNlIGltcGxlbWVudGVkIGluIHNlcnZpY2UvaGlzdG9yeS1pbXBsLlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9oaXN0b3J5LWltcGwuSGlzdG9yeX1cbiAgICovXG4gIHN0YXRpYyBoaXN0b3J5Rm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvaGlzdG9yeS1pbXBsLkhpc3Rvcnl9ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnaGlzdG9yeScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshLi9pbnB1dC5JbnB1dH1cbiAgICovXG4gIHN0YXRpYyBpbnB1dEZvcih3aW4pIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZSh3aW4sICdpbnB1dCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2xheWVycy1pbXBsLkxheW91dExheWVyc31cbiAgICovXG4gIHN0YXRpYyBsYXllcnNGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9sYXllcnMtaW1wbC5MYXlvdXRMYXllcnN9ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnbGF5ZXJzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvcGVyZm9ybWFuY2UtaW1wbC5QZXJmb3JtYW5jZX1cbiAgICovXG4gIHN0YXRpYyBwZXJmb3JtYW5jZUZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3BlcmZvcm1hbmNlLWltcGwuUGVyZm9ybWFuY2V9Ki8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdwZXJmb3JtYW5jZScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3BlcmZvcm1hbmNlLWltcGwuUGVyZm9ybWFuY2V9XG4gICAqL1xuICBzdGF0aWMgcGVyZm9ybWFuY2VGb3JPck51bGwod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9wZXJmb3JtYW5jZS1pbXBsLlBlcmZvcm1hbmNlfSovIChcbiAgICAgIGdldEV4aXN0aW5nU2VydmljZU9yTnVsbCh3aW5kb3csICdwZXJmb3JtYW5jZScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3BsYXRmb3JtLWltcGwuUGxhdGZvcm19XG4gICAqL1xuICBzdGF0aWMgcGxhdGZvcm1Gb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9wbGF0Zm9ybS1pbXBsLlBsYXRmb3JtfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3BsYXRmb3JtJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZXMgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQoKSBzaW5jZSBSZXNvdXJjZXMgaXMgYSBzdGFydHVwIHNlcnZpY2UuXG4gICAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3Jlc291cmNlcy1pbXBsLlJlc291cmNlc31cbiAgICovXG4gIHN0YXRpYyByZXNvdXJjZXNGb3JEb2Mobm9kZU9yRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9yZXNvdXJjZXMtaW1wbC5SZXNvdXJjZXN9ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKG5vZGVPckRvYywgJ3Jlc291cmNlcycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHs/UHJvbWlzZTw/e2luY29taW5nRnJhZ21lbnQ6IHN0cmluZywgb3V0Z29pbmdGcmFnbWVudDogc3RyaW5nfT59XG4gICAqL1xuICBzdGF0aWMgc2hhcmVUcmFja2luZ0Zvck9yTnVsbCh3aW4pIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8P3tpbmNvbWluZ0ZyYWdtZW50OiBzdHJpbmcsIG91dGdvaW5nRnJhZ21lbnQ6IHN0cmluZ30+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgJ3NoYXJlLXRyYWNraW5nJyxcbiAgICAgICAgICAnYW1wLXNoYXJlLXRyYWNraW5nJywgdHJ1ZSkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHs/UHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL3ZhcmlhYmxlLXNlcnZpY2UuU3RvcnlWYXJpYWJsZURlZj59XG4gICAqL1xuICBzdGF0aWMgc3RvcnlWYXJpYWJsZVNlcnZpY2VGb3JPck51bGwod2luKSB7XG4gICAgcmV0dXJuIChcbiAgICAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvdmFyaWFibGUtc2VydmljZS5TdG9yeVZhcmlhYmxlRGVmPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgJ3N0b3J5LXZhcmlhYmxlJywgJ2FtcC1zdG9yeScsXG4gICAgICAgICAgdHJ1ZSkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJzaW9uIG9mIHRoZSBzdG9yeSBzdG9yZSBzZXJ2aWNlIGRlcGVuZHMgb24gd2hpY2ggdmVyc2lvbiBvZiBhbXAtc3RvcnlcbiAgICogdGhlIHB1Ymxpc2hlciBpcyBsb2FkaW5nLiBUaGV5IGFsbCBoYXZlIHRoZSBzYW1lIGltcGxlbWVudGF0aW9uLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHs/UHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvYW1wLXN0b3J5LXN0b3JlLXNlcnZpY2UuQW1wU3RvcnlTdG9yZVNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIHN0b3J5U3RvcmVTZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvYW1wLXN0b3J5LXN0b3JlLXNlcnZpY2UuQW1wU3RvcnlTdG9yZVNlcnZpY2U+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAnc3Rvcnktc3RvcmUnLCAnYW1wLXN0b3J5JykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHs/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIHN0b3J5U3RvcmVTZXJ2aWNlKHdpbikge1xuICAgIHJldHVybiAoLyoqIEB0eXBlIHs/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfSAqL1xuICAgICAgKGdldEV4aXN0aW5nU2VydmljZU9yTnVsbCh3aW4sICdzdG9yeS1zdG9yZScpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3RvcnktcmVxdWVzdC1zZXJ2aWNlLkFtcFN0b3J5UmVxdWVzdFNlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgc3RvcnlSZXF1ZXN0U2VydmljZSh3aW4pIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3RvcnktcmVxdWVzdC1zZXJ2aWNlLkFtcFN0b3J5UmVxdWVzdFNlcnZpY2V9ICovXG4gICAgICAoZ2V0RXhpc3RpbmdTZXJ2aWNlT3JOdWxsKHdpbiwgJ3N0b3J5LXJlcXVlc3QnKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGxvY2FsaXphdGlvblNlcnZpY2VGb3JPck51bGwod2luKSB7XG4gICAgcmV0dXJuIChcbiAgICAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2U+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAnbG9jYWxpemF0aW9uJywgJ2FtcC1zdG9yeScsIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9sb2NhbGl6YXRpb24uTG9jYWxpemF0aW9uU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBsb2NhbGl6YXRpb25TZXJ2aWNlKHdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbiwgJ2xvY2FsaXphdGlvbicpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRPRE8oIzE0MzU3KTogUmVtb3ZlIHRoaXMgd2hlbiBhbXAtc3Rvcnk6MC4xIGlzIGRlcHJlY2F0ZWQuXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4geyEuLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvYW1wLXN0b3J5LXN0b3JlLXNlcnZpY2UuQW1wU3RvcnlTdG9yZVNlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgc3RvcnlTdG9yZVNlcnZpY2VWMDEod2luKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2Uod2luLCAnc3Rvcnktc3RvcmUnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUT0RPKCMxNDM1Nyk6IFJlbW92ZSB0aGlzIHdoZW4gYW1wLXN0b3J5OjAuMSBpcyBkZXByZWNhdGVkLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshLi4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1yZXF1ZXN0LXNlcnZpY2UuQW1wU3RvcnlSZXF1ZXN0U2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBzdG9yeVJlcXVlc3RTZXJ2aWNlVjAxKHdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbiwgJ3N0b3J5LXJlcXVlc3QtdjAxJyk7XG4gIH1cblxuICAvKipcbiAgICogVE9ETygjMTQzNTcpOiBSZW1vdmUgdGhpcyB3aGVuIGFtcC1zdG9yeTowLjEgaXMgZGVwcmVjYXRlZC5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzAuMS9sb2NhbGl6YXRpb24uTG9jYWxpemF0aW9uU2VydmljZT59XG4gICAqL1xuICBzdGF0aWMgbG9jYWxpemF0aW9uU2VydmljZUZvck9yTnVsbFYwMSh3aW4pIHtcbiAgICByZXR1cm4gKFxuICAgIC8qKiBAdHlwZSB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzAuMS9sb2NhbGl6YXRpb24uTG9jYWxpemF0aW9uU2VydmljZT59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICdsb2NhbGl6YXRpb24tdjAxJywgJ2FtcC1zdG9yeScsXG4gICAgICAgICAgdHJ1ZSkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUT0RPKCMxNDM1Nyk6IFJlbW92ZSB0aGlzIHdoZW4gYW1wLXN0b3J5OjAuMSBpcyBkZXByZWNhdGVkLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshLi4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2xvY2FsaXphdGlvbi5Mb2NhbGl6YXRpb25TZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIGxvY2FsaXphdGlvblNlcnZpY2VWMDEod2luKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2Uod2luLCAnbG9jYWxpemF0aW9uLXYwMScpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4gez9Qcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC12aWV3ZXItaW50ZWdyYXRpb24vMC4xL3ZhcmlhYmxlLXNlcnZpY2UuVmlld2VySW50ZWdyYXRpb25WYXJpYWJsZURlZj59XG4gICAqL1xuICBzdGF0aWMgdmlld2VySW50ZWdyYXRpb25WYXJpYWJsZVNlcnZpY2VGb3JPck51bGwod2luKSB7XG4gICAgcmV0dXJuIChcbiAgICAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC12aWV3ZXItaW50ZWdyYXRpb24vMC4xL3ZhcmlhYmxlLXNlcnZpY2UuVmlld2VySW50ZWdyYXRpb25WYXJpYWJsZURlZj59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICd2aWV3ZXItaW50ZWdyYXRpb24tdmFyaWFibGUnLFxuICAgICAgICAgICdhbXAtdmlld2VyLWludGVncmF0aW9uJywgdHJ1ZSkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8IS4uL2V4dGVuc2lvbnMvYW1wLWFuaW1hdGlvbi8wLjEvd2ViLWFuaW1hdGlvbi1zZXJ2aWNlLldlYkFuaW1hdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIHdlYkFuaW1hdGlvblNlcnZpY2VGb3IoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hbmltYXRpb24vMC4xL3dlYi1hbmltYXRpb24tc2VydmljZS5XZWJBbmltYXRpb25TZXJ2aWNlPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUZvckRvYyhcbiAgICAgICAgICBlbGVtZW50T3JBbXBEb2MsICd3ZWItYW5pbWF0aW9uJywgJ2FtcC1hbmltYXRpb24nKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3N0b3JhZ2UtaW1wbC5TdG9yYWdlPn1cbiAgICovXG4gIHN0YXRpYyBzdG9yYWdlRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPCEuL3NlcnZpY2Uvc3RvcmFnZS1pbXBsLlN0b3JhZ2U+fSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdzdG9yYWdlJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvdGVtcGxhdGUtaW1wbC5UZW1wbGF0ZXN9XG4gICAqL1xuICBzdGF0aWMgdGVtcGxhdGVzRm9yKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvdGVtcGxhdGUtaW1wbC5UZW1wbGF0ZXN9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAndGVtcGxhdGVzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvdGltZXItaW1wbC5UaW1lcn1cbiAgICovXG4gIHN0YXRpYyB0aW1lckZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3RpbWVyLWltcGwuVGltZXJ9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAndGltZXInKSk7XG4gIH1cblxuICAvKipcbiAgICogVW5saWtlIG1vc3Qgc2VydmljZSBnZXR0ZXJzLCBwYXNzaW5nIGBOb2RlYCBpcyBuZWNlc3NhcnkgZm9yIHNvbWUgRklFLXNjb3BlXG4gICAqIHNlcnZpY2VzIHNpbmNlIHNvbWV0aW1lcyB3ZSBvbmx5IGhhdmUgdGhlIEZJRSBEb2N1bWVudCBmb3IgY29udGV4dC5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvdXJsLXJlcGxhY2VtZW50cy1pbXBsLlVybFJlcGxhY2VtZW50c31cbiAgICovXG4gIHN0YXRpYyB1cmxSZXBsYWNlbWVudHNGb3JEb2Mobm9kZU9yRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS91cmwtcmVwbGFjZW1lbnRzLWltcGwuVXJsUmVwbGFjZW1lbnRzfSAqLyAoXG4gICAgICBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUoXG4gICAgICAgICAgbm9kZU9yRG9jLCAndXJsLXJlcGxhY2UnLCAvKiBvcHRfZmFsbGJhY2tUb1RvcFdpbiAqLyB0cnVlKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC11c2VyLW5vdGlmaWNhdGlvbi8wLjEvYW1wLXVzZXItbm90aWZpY2F0aW9uLlVzZXJOb3RpZmljYXRpb25NYW5hZ2VyPn1cbiAgICovXG4gIHN0YXRpYyB1c2VyTm90aWZpY2F0aW9uTWFuYWdlckZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8IS4uL2V4dGVuc2lvbnMvYW1wLXVzZXItbm90aWZpY2F0aW9uLzAuMS9hbXAtdXNlci1ub3RpZmljYXRpb24uVXNlck5vdGlmaWNhdGlvbk1hbmFnZXI+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ3VzZXJOb3RpZmljYXRpb25NYW5hZ2VyJyxcbiAgICAgICAgICAnYW1wLXVzZXItbm90aWZpY2F0aW9uJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIGNvbnNlbnRQb2xpY3kgU2VydmljZSBvciBhIHByb21pc2UgZm9yIG51bGwgaWZcbiAgICogdGhlIHNlcnZpY2UgaXMgbm90IGF2YWlsYWJsZSBvbiB0aGUgY3VycmVudCBwYWdlLlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWNvbnNlbnQvMC4xL2NvbnNlbnQtcG9saWN5LW1hbmFnZXIuQ29uc2VudFBvbGljeU1hbmFnZXI+fVxuICAgKi9cbiAgc3RhdGljIGNvbnNlbnRQb2xpY3lTZXJ2aWNlRm9yRG9jT3JOdWxsKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAoLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtY29uc2VudC8wLjEvY29uc2VudC1wb2xpY3ktbWFuYWdlci5Db25zZW50UG9saWN5TWFuYWdlcj59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsXG4gICAgICAgICAgJ2NvbnNlbnRQb2xpY3lNYW5hZ2VyJywgJ2FtcC1jb25zZW50JykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIGdlbyBzZXJ2aWNlIG9yIGEgcHJvbWlzZSBmb3IgbnVsbCBpZlxuICAgKiB0aGUgc2VydmljZSBpcyBub3QgYXZhaWxhYmxlIG9uIHRoZSBjdXJyZW50IHBhZ2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtZ2VvLzAuMS9hbXAtZ2VvLkdlb0RlZj59XG4gICAqL1xuICBzdGF0aWMgZ2VvRm9yRG9jT3JOdWxsKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1nZW8vMC4xL2FtcC1nZW8uR2VvRGVmPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhcbiAgICAgICAgICBlbGVtZW50T3JBbXBEb2MsICdnZW8nLCAnYW1wLWdlbycsIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVbmxpa2UgbW9zdCBzZXJ2aWNlIGdldHRlcnMsIHBhc3NpbmcgYE5vZGVgIGlzIG5lY2Vzc2FyeSBmb3Igc29tZSBGSUUtc2NvcGVcbiAgICogc2VydmljZXMgc2luY2Ugc29tZXRpbWVzIHdlIG9ubHkgaGF2ZSB0aGUgRklFIERvY3VtZW50IGZvciBjb250ZXh0LlxuICAgKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS91cmwtaW1wbC5Vcmx9XG4gICAqL1xuICBzdGF0aWMgdXJsRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvdXJsLWltcGwuVXJsfSAqLyAoXG4gICAgICBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUoXG4gICAgICAgICAgbm9kZU9yRG9jLCAndXJsJywgLyogb3B0X2ZhbGxiYWNrVG9Ub3BXaW4gKi8gdHJ1ZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIGZvciB0aGUgZXhwZXJpbWVudCB2YXJpYW50cyBvciBhIHByb21pc2UgZm9yIG51bGwgaWYgaXRcbiAgICogaXMgbm90IGF2YWlsYWJsZSBvbiB0aGUgY3VycmVudCBwYWdlLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/T2JqZWN0PHN0cmluZz4+fVxuICAgKi9cbiAgc3RhdGljIHZhcmlhbnRGb3JPck51bGwod2luKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8P09iamVjdDxzdHJpbmc+Pn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICd2YXJpYW50JywgJ2FtcC1leHBlcmltZW50JywgdHJ1ZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3ZpZGVvLXNlcnZpY2UtaW50ZXJmYWNlLlZpZGVvU2VydmljZUludGVyZmFjZX1cbiAgICovXG4gIHN0YXRpYyB2aWRlb01hbmFnZXJGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIC8qKiBAdHlwZSB7IS4vc2VydmljZS92aWRlby1zZXJ2aWNlLWludGVyZmFjZS5WaWRlb1NlcnZpY2VJbnRlcmZhY2V9ICovIChcbiAgICAgICAgZ2V0U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICd2aWRlby1tYW5hZ2VyJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VzIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKCkgc2luY2UgVmlld2VyIGlzIGEgc3RhcnR1cCBzZXJ2aWNlLlxuICAgKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS92aWV3ZXItaW1wbC5WaWV3ZXJ9XG4gICAqL1xuICBzdGF0aWMgdmlld2VyRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2Uvdmlld2VyLWltcGwuVmlld2VyfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZChub2RlT3JEb2MsICd2aWV3ZXInKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBwcm9taXNlIGZvciB0aGUgdmlld2VyLiBUaGlzIGlzIGFuIHVudXN1YWwgY2FzZSBhbmQgbmVjZXNzYXJ5IG9ubHlcbiAgICogZm9yIHNlcnZpY2VzIHRoYXQgbmVlZCByZWZlcmVuY2UgdG8gdGhlIHZpZXdlciBiZWZvcmUgaXQgaGFzIGJlZW5cbiAgICogaW5pdGlhbGl6ZWQuIE1vc3Qgb2YgdGhlIGNvZGUsIGhvd2V2ZXIsIGp1c3Qgc2hvdWxkIHVzZSBgdmlld2VyRm9yRG9jYC5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuL3NlcnZpY2Uvdmlld2VyLWltcGwuVmlld2VyPn1cbiAgICovXG4gIHN0YXRpYyB2aWV3ZXJQcm9taXNlRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPCEuL3NlcnZpY2Uvdmlld2VyLWltcGwuVmlld2VyPn0gKi8gKFxuICAgICAgZ2V0U2VydmljZVByb21pc2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAndmlld2VyJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvdnN5bmMtaW1wbC5Wc3luY31cbiAgICovXG4gIHN0YXRpYyB2c3luY0Zvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3ZzeW5jLWltcGwuVnN5bmN9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAndnN5bmMnKSk7XG4gIH1cblxuICAvKipcbiAgICogVXNlcyBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZCgpIHNpbmNlIFZpZXdwb3J0IGlzIGEgc3RhcnR1cCBzZXJ2aWNlLlxuICAgKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS92aWV3cG9ydC92aWV3cG9ydC1pbXBsLlZpZXdwb3J0fVxuICAgKi9cbiAgc3RhdGljIHZpZXdwb3J0Rm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2Uvdmlld3BvcnQvdmlld3BvcnQtaW1wbC5WaWV3cG9ydH0gKi8gKFxuICAgICAgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQobm9kZU9yRG9jLCAndmlld3BvcnQnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS94aHItaW1wbC5YaHJ9XG4gICAqL1xuICBzdGF0aWMgeGhyRm9yKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UveGhyLWltcGwuWGhyfSAqLyAoZ2V0U2VydmljZSh3aW5kb3csICd4aHInKSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2Rldn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHttYXB9IGZyb20gJy4vdXRpbHMvb2JqZWN0LmpzJztcblxubGV0IGNvbnRhaW5lcjtcblxuLyoqXG4gKiBDcmVhdGVzIHRoZSBodG1sIGhlbHBlciBmb3IgdGhlIGRvYy5cbiAqXG4gKiBAcGFyYW0geyFFbGVtZW50fCFEb2N1bWVudH0gbm9kZU9yRG9jXG4gKiBAcmV0dXJuIHtmdW5jdGlvbighQXJyYXk8c3RyaW5nPik6IUVsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBodG1sRm9yKG5vZGVPckRvYykge1xuICBjb25zdCBkb2MgPSBub2RlT3JEb2Mub3duZXJEb2N1bWVudCB8fCBub2RlT3JEb2M7XG4gIGlmICghY29udGFpbmVyIHx8IGNvbnRhaW5lci5vd25lckRvY3VtZW50ICE9PSBkb2MpIHtcbiAgICBjb250YWluZXIgPSBkb2MuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIH1cblxuICByZXR1cm4gaHRtbDtcbn1cblxuLyoqXG4gKiBBIHRhZ2dlZCB0ZW1wbGF0ZSBsaXRlcmFsIGhlbHBlciB0byBnZW5lcmF0ZSBzdGF0aWMgRE9NIHRyZWVzLlxuICogVGhpcyBtdXN0IGJlIHVzZWQgYXMgYSB0YWdnZWQgdGVtcGxhdGUsIGllXG4gKlxuICogYGBgXG4gKiBjb25zdCBkaXYgPSBodG1sYDxkaXY+PHNwYW4+PC9zcGFuPjwvZGl2PmA7XG4gKiBgYGBcbiAqXG4gKiBPbmx5IHRoZSByb290IGVsZW1lbnQgYW5kIGl0cyBzdWJ0cmVlIHdpbGwgYmUgcmV0dXJuZWQuIERPIE5PVCB1c2UgdGhpcyB0b1xuICogcmVuZGVyIHN1YnRyZWUncyB3aXRoIGR5bmFtaWMgY29udGVudCwgaXQgV0lMTCByZXN1bHQgaW4gYW4gZXJyb3IhXG4gKlxuICogQHBhcmFtIHshQXJyYXk8c3RyaW5nPn0gc3RyaW5nc1xuICogQHJldHVybiB7IUVsZW1lbnR9XG4gKi9cbmZ1bmN0aW9uIGh0bWwoc3RyaW5ncykge1xuICBkZXYoKS5hc3NlcnQoc3RyaW5ncy5sZW5ndGggPT09IDEsICdJbXByb3BlciBodG1sIHRlbXBsYXRlIHRhZyB1c2FnZS4nKTtcbiAgY29udGFpbmVyLi8qT0sqL2lubmVySFRNTCA9IHN0cmluZ3NbMF07XG5cbiAgY29uc3QgZWwgPSBjb250YWluZXIuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gIGRldigpLmFzc2VydChlbCwgJ05vIGVsZW1lbnRzIGluIHRlbXBsYXRlJyk7XG4gIGRldigpLmFzc2VydCghZWwubmV4dEVsZW1lbnRTaWJsaW5nLCAnVG9vIG1hbnkgcm9vdCBlbGVtZW50cyBpbiB0ZW1wbGF0ZScpO1xuXG4gIC8vIENsZWFyIHRvIGZyZWUgbWVtb3J5LlxuICBjb250YWluZXIuLypPSyovaW5uZXJIVE1MID0gJyc7XG5cbiAgcmV0dXJuIGVsO1xufVxuXG4vKipcbiAqIFF1ZXJpZXMgYW4gZWxlbWVudCBmb3IgYWxsIGVsZW1lbnRzIHdpdGggYSBcInJlZlwiIGF0dHJpYnV0ZSwgcmVtb3ZpbmdcbiAqIHRoZSBhdHRyaWJ1dGUgYWZ0ZXJ3YXJkcy5cbiAqIFJldHVybnMgYSBuYW1lZCBtYXAgb2YgYWxsIHJlZiBlbGVtZW50cy5cbiAqXG4gKiBAcGFyYW0geyFFbGVtZW50fSByb290XG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgIUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gaHRtbFJlZnMocm9vdCkge1xuICBjb25zdCBlbGVtZW50cyA9IHJvb3QucXVlcnlTZWxlY3RvckFsbCgnW3JlZl0nKTtcbiAgY29uc3QgcmVmcyA9IG1hcCgpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBlbGVtZW50ID0gZWxlbWVudHNbaV07XG4gICAgY29uc3QgcmVmID0gZGV2KCkuYXNzZXJ0KGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdyZWYnKSwgJ0VtcHR5IHJlZiBhdHRyJyk7XG4gICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ3JlZicpO1xuICAgIGRldigpLmFzc2VydChyZWZzW3JlZl0gPT09IHVuZGVmaW5lZCwgJ0R1cGxpY2F0ZSByZWYnKTtcbiAgICByZWZzW3JlZl0gPSBlbGVtZW50O1xuICB9XG5cbiAgcmV0dXJuIHJlZnM7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gX21hdGNoXG4gKiBAcGFyYW0ge3N0cmluZ30gY2hhcmFjdGVyXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHRvVXBwZXJDYXNlKF9tYXRjaCwgY2hhcmFjdGVyKSB7XG4gIHJldHVybiBjaGFyYWN0ZXIudG9VcHBlckNhc2UoKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWF0Y2hcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gcHJlcGVuZERhc2hBbmRUb0xvd2VyQ2FzZShtYXRjaCkge1xuICByZXR1cm4gJy0nICsgbWF0Y2gudG9Mb3dlckNhc2UoKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBBdHRyaWJ1dGUgbmFtZSBjb250YWluaW5nIGRhc2hlcy5cbiAqIEByZXR1cm4ge3N0cmluZ30gRGFzaGVzIHJlbW92ZWQgYW5kIHN1Y2Nlc3NpdmUgY2hhcmFjdGVyIHNlbnQgdG8gdXBwZXIgY2FzZS5cbiAqIHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkYXNoVG9DYW1lbENhc2UobmFtZSkge1xuICByZXR1cm4gbmFtZS5yZXBsYWNlKC8tKFthLXpdKS9nLCB0b1VwcGVyQ2FzZSk7XG59XG5cbi8qKlxuICogQ29udmVydHMgYSBzdHJpbmcgdGhhdCBpcyBpbiBjYW1lbENhc2UgdG8gb25lIHRoYXQgaXMgaW4gZGFzaC1jYXNlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJpbmcgVGhlIHN0cmluZyB0byBjb252ZXJ0LlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgc3RyaW5nIGluIGRhc2gtY2FzZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNhbWVsQ2FzZVRvRGFzaChzdHJpbmcpIHtcbiAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC8oPyFeKVtBLVpdL2csIHByZXBlbmREYXNoQW5kVG9Mb3dlckNhc2UpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIEF0dHJpYnV0ZSBuYW1lIHdpdGggZGFzaGVzXG4gKiBAcmV0dXJuIHtzdHJpbmd9IERhc2hlcyByZXBsYWNlZCBieSB1bmRlcmxpbmVzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZGFzaFRvVW5kZXJsaW5lKG5hbWUpIHtcbiAgcmV0dXJuIG5hbWUucmVwbGFjZSgnLScsICdfJyk7XG59XG5cbi8qKlxuICogUG9seWZpbGwgZm9yIFN0cmluZy5wcm90b3R5cGUuZW5kc1dpdGguXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nXG4gKiBAcGFyYW0ge3N0cmluZ30gc3VmZml4XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gZW5kc1dpdGgoc3RyaW5nLCBzdWZmaXgpIHtcbiAgY29uc3QgaW5kZXggPSBzdHJpbmcubGVuZ3RoIC0gc3VmZml4Lmxlbmd0aDtcbiAgcmV0dXJuIGluZGV4ID49IDAgJiYgc3RyaW5nLmluZGV4T2Yoc3VmZml4LCBpbmRleCkgPT0gaW5kZXg7XG59XG5cbi8qKlxuICogUG9seWZpbGwgZm9yIFN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aC5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJpbmdcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcmVmaXhcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdGFydHNXaXRoKHN0cmluZywgcHJlZml4KSB7XG4gIGlmIChwcmVmaXgubGVuZ3RoID4gc3RyaW5nLmxlbmd0aCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gc3RyaW5nLmxhc3RJbmRleE9mKHByZWZpeCwgMCkgPT0gMDtcbn1cblxuLyoqXG4gKiBFeHBhbmRzIHBsYWNlaG9sZGVycyBpbiBhIGdpdmVuIHRlbXBsYXRlIHN0cmluZyB3aXRoIHZhbHVlcy5cbiAqXG4gKiBQbGFjZWhvbGRlcnMgdXNlICR7a2V5LW5hbWV9IHN5bnRheCBhbmQgYXJlIHJlcGxhY2VkIHdpdGggdGhlIHZhbHVlXG4gKiByZXR1cm5lZCBmcm9tIHRoZSBnaXZlbiBnZXR0ZXIgZnVuY3Rpb24uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHRlbXBsYXRlIFRoZSB0ZW1wbGF0ZSBzdHJpbmcgdG8gZXhwYW5kLlxuICogQHBhcmFtIHtmdW5jdGlvbihzdHJpbmcpOip9IGdldHRlciBGdW5jdGlvbiB1c2VkIHRvIHJldHJpZXZlIGEgdmFsdWUgZm9yIGFcbiAqICAgcGxhY2Vob2xkZXIuIFJldHVybnMgdmFsdWVzIHdpbGwgYmUgY29lcmNlZCBpbnRvIHN0cmluZ3MuXG4gKiBAcGFyYW0ge251bWJlcj19IG9wdF9tYXhJdGVyYXRpb25zIE51bWJlciBvZiB0aW1lcyB0byBleHBhbmQgdGhlIHRlbXBsYXRlLlxuICogICBEZWZhdWx0cyB0byAxLCBidXQgc2hvdWxkIGJlIHNldCB0byBhIGxhcmdlciB2YWx1ZSB5b3VyIHBsYWNlaG9sZGVyIHRva2Vuc1xuICogICBjYW4gYmUgZXhwYW5kZWQgdG8gb3RoZXIgcGxhY2Vob2xkZXIgdG9rZW5zLiBUYWtlIGNhdXRpb24gd2l0aCBsYXJnZSB2YWx1ZXNcbiAqICAgYXMgcmVjdXJzaXZlbHkgZXhwYW5kaW5nIGEgc3RyaW5nIGNhbiBiZSBleHBvbmVudGlhbGx5IGV4cGVuc2l2ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4cGFuZFRlbXBsYXRlKHRlbXBsYXRlLCBnZXR0ZXIsIG9wdF9tYXhJdGVyYXRpb25zKSB7XG4gIGNvbnN0IG1heEl0ZXJhdGlvbnMgPSBvcHRfbWF4SXRlcmF0aW9ucyB8fCAxO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IG1heEl0ZXJhdGlvbnM7IGkrKykge1xuICAgIGxldCBtYXRjaGVzID0gMDtcbiAgICB0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UoL1xcJHsoW159XSopfS9nLCAoX2EsIGIpID0+IHtcbiAgICAgIG1hdGNoZXMrKztcbiAgICAgIHJldHVybiBnZXR0ZXIoYik7XG4gICAgfSk7XG4gICAgaWYgKCFtYXRjaGVzKSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRlbXBsYXRlO1xufVxuXG4vKipcbiAqIEhhc2ggZnVuY3Rpb24gZGpiMmFcbiAqIFRoaXMgaXMgaW50ZW5kZWQgdG8gYmUgYSBzaW1wbGUsIGZhc3QgaGFzaGluZyBmdW5jdGlvbiB1c2luZyBtaW5pbWFsIGNvZGUuXG4gKiBJdCBkb2VzICpub3QqIGhhdmUgZ29vZCBjcnlwdG9ncmFwaGljIHByb3BlcnRpZXMuXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyXG4gKiBAcmV0dXJuIHtzdHJpbmd9IDMyLWJpdCB1bnNpZ25lZCBoYXNoIG9mIHRoZSBzdHJpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0cmluZ0hhc2gzMihzdHIpIHtcbiAgY29uc3Qge2xlbmd0aH0gPSBzdHI7XG4gIGxldCBoYXNoID0gNTM4MTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGhhc2ggPSBoYXNoICogMzMgXiBzdHIuY2hhckNvZGVBdChpKTtcbiAgfVxuICAvLyBDb252ZXJ0IGZyb20gMzItYml0IHNpZ25lZCB0byB1bnNpZ25lZC5cbiAgcmV0dXJuIFN0cmluZyhoYXNoID4+PiAwKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcuL3NlcnZpY2VzJztcbmltcG9ydCB7ZGV2LCByZXRocm93QXN5bmN9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7aW5zZXJ0QWZ0ZXJPckF0U3RhcnQsIHdhaXRGb3JCb2R5fSBmcm9tICcuL2RvbSc7XG5pbXBvcnQge21hcH0gZnJvbSAnLi91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtzZXRTdHlsZXN9IGZyb20gJy4vc3R5bGUnO1xuaW1wb3J0IHt3YWl0Rm9yU2VydmljZXN9IGZyb20gJy4vcmVuZGVyLWRlbGF5aW5nLXNlcnZpY2VzJztcblxuY29uc3QgVFJBTlNGT1JNRVJfUFJPUCA9ICdfX0FNUF9DU1NfVFInO1xuY29uc3QgU1RZTEVfTUFQX1BST1AgPSAnX19BTVBfQ1NTX1NNJztcbmNvbnN0IGJvZHlWaXNpYmxlU2VudGluZWwgPSAnX19BTVBfQk9EWV9WSVNJQkxFJztcblxuXG4vKipcbiAqIEFkZHMgdGhlIGdpdmVuIGNzcyB0ZXh0IHRvIHRoZSBnaXZlbiBhbXBkb2MuXG4gKlxuICogVGhlIHN0eWxlIHRhZ3Mgd2lsbCBiZSBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBoZWFkIGJlZm9yZSBhbGwgYXV0aG9yXG4gKiBzdHlsZXMuIE9uZSBlbGVtZW50IGNhbiBiZSB0aGUgbWFpbiBydW50aW1lIENTUy4gVGhpcyBpcyBndWFyYW50ZWVkXG4gKiB0byBhbHdheXMgYmUgdGhlIGZpcnN0IHN0eWxlc2hlZXQgaW4gdGhlIGRvYy5cbiAqXG4gKiBAcGFyYW0geyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBhbXBkb2MgVGhlIGFtcGRvYyB0aGF0IHNob3VsZCBnZXQgdGhlIG5ldyBzdHlsZXMuXG4gKiBAcGFyYW0ge3N0cmluZ30gY3NzVGV4dFxuICogQHBhcmFtIHs/ZnVuY3Rpb24oIUVsZW1lbnQpfHVuZGVmaW5lZH0gY2IgQ2FsbGVkIHdoZW4gdGhlIG5ldyBzdHlsZXMgYXJlIGF2YWlsYWJsZS5cbiAqICAgICBOb3QgdXNpbmcgYSBwcm9taXNlLCBiZWNhdXNlIHRoaXMgaXMgc3luY2hyb25vdXMgd2hlbiBwb3NzaWJsZS5cbiAqICAgICBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlLlxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2lzUnVudGltZUNzcyBJZiB0cnVlLCB0aGlzIHN0eWxlIHRhZyB3aWxsIGJlIGluc2VydGVkXG4gKiAgICAgYXMgdGhlIGZpcnN0IGVsZW1lbnQgaW4gaGVhZCBhbmQgYWxsIHN0eWxlIGVsZW1lbnRzIHdpbGwgYmUgcG9zaXRpb25lZFxuICogICAgIGFmdGVyLlxuICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfZXh0XG4gKiBAcmV0dXJuIHshRWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGxTdHlsZXNGb3JEb2MoXG4gIGFtcGRvYywgY3NzVGV4dCwgY2IsIG9wdF9pc1J1bnRpbWVDc3MsIG9wdF9leHQpIHtcbiAgY29uc3QgY3NzUm9vdCA9IGFtcGRvYy5nZXRIZWFkTm9kZSgpO1xuICBjb25zdCBzdHlsZSA9IGluc2VydFN0eWxlRWxlbWVudChcbiAgICAgIGNzc1Jvb3QsXG4gICAgICBtYXliZVRyYW5zZm9ybShjc3NSb290LCBjc3NUZXh0KSxcbiAgICAgIG9wdF9pc1J1bnRpbWVDc3MgfHwgZmFsc2UsXG4gICAgICBvcHRfZXh0IHx8IG51bGwpO1xuXG4gIGlmIChjYikge1xuICAgIGNvbnN0IHJvb3ROb2RlID0gYW1wZG9jLmdldFJvb3ROb2RlKCk7XG4gICAgLy8gU3R5bGVzIGFyZW4ndCBhbHdheXMgYXZhaWxhYmxlIHN5bmNocm9ub3VzbHkuIEUuZy4gaWYgdGhlcmUgaXMgYVxuICAgIC8vIHBlbmRpbmcgc3R5bGUgZG93bmxvYWQsIGl0IHdpbGwgaGF2ZSB0byBmaW5pc2ggYmVmb3JlIHRoZSBuZXdcbiAgICAvLyBzdHlsZSBpcyB2aXNpYmxlLlxuICAgIC8vIEZvciB0aGlzIHJlYXNvbiB3ZSBwb2xsIHVudGlsIHRoZSBzdHlsZSBiZWNvbWVzIGF2YWlsYWJsZS5cbiAgICAvLyBTeW5jIGNhc2UuXG4gICAgaWYgKHN0eWxlTG9hZGVkKHJvb3ROb2RlLCBzdHlsZSkpIHtcbiAgICAgIGNiKHN0eWxlKTtcbiAgICAgIHJldHVybiBzdHlsZTtcbiAgICB9XG4gICAgLy8gUG9sbCB1bnRpbCBzdHlsZXMgYXJlIGF2YWlsYWJsZS5cbiAgICBjb25zdCBpbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGlmIChzdHlsZUxvYWRlZChyb290Tm9kZSwgc3R5bGUpKSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgICAgICBjYihzdHlsZSk7XG4gICAgICB9XG4gICAgfSwgNCk7XG4gIH1cbiAgcmV0dXJuIHN0eWxlO1xufVxuXG5cbi8qKlxuICogQWRkcyB0aGUgZ2l2ZW4gY3NzIHRleHQgdG8gdGhlIGdpdmVuIGRvY3VtZW50LlxuICogVE9ETyhkdm95dGVua28sICMxMDcwNSk6IFJlbW92ZSB0aGlzIG1ldGhvZCBvbmNlIEZJRS9hbXBkb2MgbWlncmF0aW9uIGlzXG4gKiBkb25lLlxuICpcbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2MgVGhlIGRvY3VtZW50IHRoYXQgc2hvdWxkIGdldCB0aGUgbmV3IHN0eWxlcy5cbiAqIEBwYXJhbSB7c3RyaW5nfSBjc3NUZXh0XG4gKiBAcGFyYW0gez9mdW5jdGlvbighRWxlbWVudCl8dW5kZWZpbmVkfSBjYiBDYWxsZWQgd2hlbiB0aGUgbmV3IHN0eWxlcyBhcmVcbiAqICAgICBhdmFpbGFibGUuIE5vdCB1c2luZyBhIHByb21pc2UsIGJlY2F1c2UgdGhpcyBpcyBzeW5jaHJvbm91cyB3aGVuXG4gKiAgICAgcG9zc2libGUuIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2UuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfaXNSdW50aW1lQ3NzIElmIHRydWUsIHRoaXMgc3R5bGUgdGFnIHdpbGwgYmUgaW5zZXJ0ZWRcbiAqICAgICBhcyB0aGUgZmlyc3QgZWxlbWVudCBpbiBoZWFkIGFuZCBhbGwgc3R5bGUgZWxlbWVudHMgd2lsbCBiZSBwb3NpdGlvbmVkXG4gKiAgICAgYWZ0ZXIuXG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF9leHRcbiAqIEByZXR1cm4geyFFbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbFN0eWxlc0xlZ2FjeShcbiAgZG9jLCBjc3NUZXh0LCBjYiwgb3B0X2lzUnVudGltZUNzcywgb3B0X2V4dCkge1xuICBjb25zdCBzdHlsZSA9IGluc2VydFN0eWxlRWxlbWVudChcbiAgICAgIGRldigpLmFzc2VydEVsZW1lbnQoZG9jLmhlYWQpLFxuICAgICAgY3NzVGV4dCxcbiAgICAgIG9wdF9pc1J1bnRpbWVDc3MgfHwgZmFsc2UsXG4gICAgICBvcHRfZXh0IHx8IG51bGwpO1xuXG4gIGlmIChjYikge1xuICAgIC8vIFN0eWxlcyBhcmVuJ3QgYWx3YXlzIGF2YWlsYWJsZSBzeW5jaHJvbm91c2x5LiBFLmcuIGlmIHRoZXJlIGlzIGFcbiAgICAvLyBwZW5kaW5nIHN0eWxlIGRvd25sb2FkLCBpdCB3aWxsIGhhdmUgdG8gZmluaXNoIGJlZm9yZSB0aGUgbmV3XG4gICAgLy8gc3R5bGUgaXMgdmlzaWJsZS5cbiAgICAvLyBGb3IgdGhpcyByZWFzb24gd2UgcG9sbCB1bnRpbCB0aGUgc3R5bGUgYmVjb21lcyBhdmFpbGFibGUuXG4gICAgLy8gU3luYyBjYXNlLlxuICAgIGlmIChzdHlsZUxvYWRlZChkb2MsIHN0eWxlKSkge1xuICAgICAgY2Ioc3R5bGUpO1xuICAgICAgcmV0dXJuIHN0eWxlO1xuICAgIH1cbiAgICAvLyBQb2xsIHVudGlsIHN0eWxlcyBhcmUgYXZhaWxhYmxlLlxuICAgIGNvbnN0IGludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYgKHN0eWxlTG9hZGVkKGRvYywgc3R5bGUpKSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgICAgICBjYihzdHlsZSk7XG4gICAgICB9XG4gICAgfSwgNCk7XG4gIH1cbiAgcmV0dXJuIHN0eWxlO1xufVxuXG5cbi8qKlxuICogQ3JlYXRlcyB0aGUgcHJvcGVybHkgY29uZmlndXJlZCBzdHlsZSBlbGVtZW50LlxuICogQHBhcmFtIHshRWxlbWVudHwhU2hhZG93Um9vdH0gY3NzUm9vdFxuICogQHBhcmFtIHtzdHJpbmd9IGNzc1RleHRcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNSdW50aW1lQ3NzXG4gKiBAcGFyYW0gez9zdHJpbmd9IGV4dFxuICogQHJldHVybiB7IUVsZW1lbnR9XG4gKi9cbmZ1bmN0aW9uIGluc2VydFN0eWxlRWxlbWVudChjc3NSb290LCBjc3NUZXh0LCBpc1J1bnRpbWVDc3MsIGV4dCkge1xuICBsZXQgc3R5bGVNYXAgPSBjc3NSb290W1NUWUxFX01BUF9QUk9QXTtcbiAgaWYgKCFzdHlsZU1hcCkge1xuICAgIHN0eWxlTWFwID0gY3NzUm9vdFtTVFlMRV9NQVBfUFJPUF0gPSBtYXAoKTtcbiAgfVxuXG4gIGNvbnN0IGlzRXh0Q3NzID0gIWlzUnVudGltZUNzcyAmJlxuICAgICAgKGV4dCAmJiBleHQgIT0gJ2FtcC1jdXN0b20nICYmIGV4dCAhPSAnYW1wLWtleWZyYW1lcycpO1xuICBjb25zdCBrZXkgPVxuICAgICAgaXNSdW50aW1lQ3NzID8gJ2FtcC1ydW50aW1lJyA6XG4gICAgICAgIGlzRXh0Q3NzID8gYGFtcC1leHRlbnNpb249JHtleHR9YCA6IG51bGw7XG5cbiAgLy8gQ2hlY2sgaWYgaXQgaGFzIGFscmVhZHkgYmVlbiBjcmVhdGVkIG9yIGRpc2NvdmVyZWQuXG4gIGlmIChrZXkpIHtcbiAgICBjb25zdCBleGlzdGluZyA9IGdldEV4aXN0aW5nU3R5bGVFbGVtZW50KGNzc1Jvb3QsIHN0eWxlTWFwLCBrZXkpO1xuICAgIGlmIChleGlzdGluZykge1xuICAgICAgcmV0dXJuIGV4aXN0aW5nO1xuICAgIH1cbiAgfVxuXG4gIC8vIENyZWF0ZSB0aGUgbmV3IHN0eWxlIGVsZW1lbnQgYW5kIGFwcGVuZCB0byBjc3NSb290LlxuICBjb25zdCBkb2MgPSAoY3NzUm9vdC5vd25lckRvY3VtZW50IHx8IGNzc1Jvb3QpO1xuICBjb25zdCBzdHlsZSA9IGRvYy5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICBzdHlsZS4vKk9LKi90ZXh0Q29udGVudCA9IGNzc1RleHQ7XG4gIGxldCBhZnRlckVsZW1lbnQgPSBudWxsO1xuICAvLyBNYWtlIHN1cmUgdGhhdCB3ZSBwbGFjZSBzdHlsZSB0YWdzIGFmdGVyIHRoZSBtYWluIHJ1bnRpbWUgQ1NTLiBPdGhlcndpc2VcbiAgLy8gdGhlIG9yZGVyIGlzIHJhbmRvbS5cbiAgaWYgKGlzUnVudGltZUNzcykge1xuICAgIHN0eWxlLnNldEF0dHJpYnV0ZSgnYW1wLXJ1bnRpbWUnLCAnJyk7XG4gIH0gZWxzZSBpZiAoaXNFeHRDc3MpIHtcbiAgICBzdHlsZS5zZXRBdHRyaWJ1dGUoJ2FtcC1leHRlbnNpb24nLCBleHQgfHwgJycpO1xuICAgIGFmdGVyRWxlbWVudCA9IGRldigpLmFzc2VydEVsZW1lbnQoZ2V0RXhpc3RpbmdTdHlsZUVsZW1lbnQoXG4gICAgICAgIGNzc1Jvb3QsIHN0eWxlTWFwLCAnYW1wLXJ1bnRpbWUnKSk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKGV4dCkge1xuICAgICAgc3R5bGUuc2V0QXR0cmlidXRlKGV4dCwgJycpO1xuICAgIH1cbiAgICBhZnRlckVsZW1lbnQgPSBjc3NSb290Lmxhc3RDaGlsZDtcbiAgfVxuICBpbnNlcnRBZnRlck9yQXRTdGFydChjc3NSb290LCBzdHlsZSwgYWZ0ZXJFbGVtZW50KTtcbiAgaWYgKGtleSkge1xuICAgIHN0eWxlTWFwW2tleV0gPSBzdHlsZTtcbiAgfVxuICByZXR1cm4gc3R5bGU7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFFbGVtZW50fCFTaGFkb3dSb290fSBjc3NSb290XG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAhRWxlbWVudD59IHN0eWxlTWFwXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5XG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZnVuY3Rpb24gZ2V0RXhpc3RpbmdTdHlsZUVsZW1lbnQoY3NzUm9vdCwgc3R5bGVNYXAsIGtleSkge1xuICAvLyBBbHJlYWR5IGNhY2hlZC5cbiAgaWYgKHN0eWxlTWFwW2tleV0pIHtcbiAgICByZXR1cm4gc3R5bGVNYXBba2V5XTtcbiAgfVxuICAvLyBDaGVjayBpZiB0aGUgc3R5bGUgaGFzIGFscmVhZHkgYmVlbiBhZGRlZCBieSB0aGUgc2VydmVyIGxheW91dC5cbiAgY29uc3QgZXhpc3RpbmcgPSBjc3NSb290Li8qT0sqL3F1ZXJ5U2VsZWN0b3IoYHN0eWxlWyR7a2V5fV1gKTtcbiAgaWYgKGV4aXN0aW5nKSB7XG4gICAgc3R5bGVNYXBba2V5XSA9IGV4aXN0aW5nO1xuICAgIHJldHVybiBleGlzdGluZztcbiAgfVxuICAvLyBOb3RoaW5nIGZvdW5kLlxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4vKipcbiAqIEFwcGxpZXMgYSB0cmFuc2Zvcm1lciB0byB0aGUgQ1NTIHRleHQgaWYgaXQgaGFzIGJlZW4gcmVnaXN0ZXJlZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IVNoYWRvd1Jvb3R9IGNzc1Jvb3RcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nKTpzdHJpbmd9IHRyYW5zZm9ybWVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnN0YWxsQ3NzVHJhbnNmb3JtZXIoY3NzUm9vdCwgdHJhbnNmb3JtZXIpIHtcbiAgY3NzUm9vdFtUUkFOU0ZPUk1FUl9QUk9QXSA9IHRyYW5zZm9ybWVyO1xufVxuXG5cbi8qKlxuICogQXBwbGllcyBhIHRyYW5zZm9ybWVyIHRvIHRoZSBDU1MgdGV4dCBpZiBpdCBoYXMgYmVlbiByZWdpc3RlcmVkLlxuICogQHBhcmFtIHshRWxlbWVudHwhU2hhZG93Um9vdH0gY3NzUm9vdFxuICogQHBhcmFtIHtzdHJpbmd9IGNzc1RleHRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gbWF5YmVUcmFuc2Zvcm0oY3NzUm9vdCwgY3NzVGV4dCkge1xuICBjb25zdCB0cmFuc2Zvcm1lciA9IGNzc1Jvb3RbVFJBTlNGT1JNRVJfUFJPUF07XG4gIHJldHVybiB0cmFuc2Zvcm1lciA/IHRyYW5zZm9ybWVyKGNzc1RleHQpIDogY3NzVGV4dDtcbn1cblxuXG4vKipcbiAqIFNldHMgdGhlIGRvY3VtZW50J3MgYm9keSBvcGFjaXR5IHRvIDEuXG4gKiBJZiB0aGUgYm9keSBpcyBub3QgeWV0IGF2YWlsYWJsZSAoYmVjYXVzZSBvdXIgc2NyaXB0IHdhcyBsb2FkZWRcbiAqIHN5bmNocm9ub3VzbHkpLCBwb2xscyB1bnRpbCBpdCBpcy5cbiAqIEBwYXJhbSB7IURvY3VtZW50fSBkb2MgVGhlIGRvY3VtZW50IHdobydzIGJvZHkgd2Ugc2hvdWxkIG1ha2UgdmlzaWJsZS5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF93YWl0Rm9yU2VydmljZXMgV2hldGhlciB0aGUgYm9keSB2aXNpYmlsaXR5IHNob3VsZFxuICogICAgIGJlIGJsb2NrZWQgb24ga2V5IHNlcnZpY2VzIGJlaW5nIGxvYWRlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1ha2VCb2R5VmlzaWJsZShkb2MsIG9wdF93YWl0Rm9yU2VydmljZXMpIHtcbiAgZGV2KCkuYXNzZXJ0KGRvYy5kZWZhdWx0VmlldywgJ1Bhc3NlZCBpbiBkb2N1bWVudCBtdXN0IGhhdmUgYSBkZWZhdWx0VmlldycpO1xuICBjb25zdCB3aW4gPSAvKiogQHR5cGUgeyFXaW5kb3d9ICovIChkb2MuZGVmYXVsdFZpZXcpO1xuICBpZiAod2luW2JvZHlWaXNpYmxlU2VudGluZWxdKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IHNldCA9ICgpID0+IHtcbiAgICB3aW5bYm9keVZpc2libGVTZW50aW5lbF0gPSB0cnVlO1xuICAgIHNldFN0eWxlcyhkZXYoKS5hc3NlcnRFbGVtZW50KGRvYy5ib2R5KSwge1xuICAgICAgb3BhY2l0eTogMSxcbiAgICAgIHZpc2liaWxpdHk6ICd2aXNpYmxlJyxcbiAgICAgICdhbmltYXRpb24nOiAnbm9uZScsXG4gICAgfSk7XG4gICAgcmVuZGVyU3RhcnRlZE5vSW5saW5lKGRvYyk7XG4gIH07XG4gIHRyeSB7XG4gICAgd2FpdEZvckJvZHkoZG9jLCAoKSA9PiB7XG4gICAgICBpZiAod2luW2JvZHlWaXNpYmxlU2VudGluZWxdKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHdpbltib2R5VmlzaWJsZVNlbnRpbmVsXSA9IHRydWU7XG4gICAgICBpZiAob3B0X3dhaXRGb3JTZXJ2aWNlcykge1xuICAgICAgICB3YWl0Rm9yU2VydmljZXMod2luKS5jYXRjaChyZWFzb24gPT4ge1xuICAgICAgICAgIHJldGhyb3dBc3luYyhyZWFzb24pO1xuICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfSkudGhlbihzZXJ2aWNlcyA9PiB7XG4gICAgICAgICAgc2V0KCk7XG4gICAgICAgICAgaWYgKHNlcnZpY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIFNlcnZpY2VzLnJlc291cmNlc0ZvckRvYyhkb2MpLi8qT0sqL3NjaGVkdWxlUGFzcyhcbiAgICAgICAgICAgICAgICAxLCAvKiByZWxheW91dEFsbCAqLyB0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHBlcmYgPSBTZXJ2aWNlcy5wZXJmb3JtYW5jZUZvcih3aW4pO1xuICAgICAgICAgICAgcGVyZi50aWNrKCdtYnYnKTtcbiAgICAgICAgICAgIHBlcmYuZmx1c2goKTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gSWYgdGhlcmUgd2FzIGFuIGVycm9yIGR1cmluZyB0aGUgbG9naWMgYWJvdmUgKHN1Y2ggYXMgc2VydmljZSBub3RcbiAgICAvLyB5ZXQgaW5zdGFsbGVkLCBkZWZpbml0ZWx5IHRyeSB0byBtYWtlIHRoZSBib2R5IHZpc2libGUuXG4gICAgc2V0KCk7XG4gICAgLy8gQXZvaWQgZXJyb3JzIGluIHRoZSBmdW5jdGlvbiB0byBicmVhayBleGVjdXRpb24gZmxvdyBhcyB0aGlzIGlzXG4gICAgLy8gb2Z0ZW4gY2FsbGVkIGFzIGEgbGFzdCByZXNvcnQuXG4gICAgcmV0aHJvd0FzeW5jKGUpO1xuICB9XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKi9cbmZ1bmN0aW9uIHJlbmRlclN0YXJ0ZWROb0lubGluZShkb2MpIHtcbiAgdHJ5IHtcbiAgICBTZXJ2aWNlcy5yZXNvdXJjZXNGb3JEb2MoZG9jKS5yZW5kZXJTdGFydGVkKCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBgbWFrZUJvZHlWaXNpYmxlYCBpcyBjYWxsZWQgaW4gdGhlIGVycm9yLXByb2Nlc3NpbmcgY3ljbGUgYW5kIHRodXNcbiAgICAvLyBjb3VsZCBiZSB0cmlnZ2VyZWQgd2hlbiBydW50aW1lJ3MgaW5pdGlhbGl6YXRpb24gaXMgaW5jb21wbGV0ZSB3aGljaFxuICAgIC8vIHdvdWxkIGNhdXNlIHVucmVsYXRlZCBlcnJvcnMgdG8gYmUgdGhyb3duIGhlcmUuXG4gIH1cbn1cblxuXG4vKipcbiAqIEluZGljYXRlcyB0aGF0IHRoZSBib2R5IGlzIGFsd2F5cyB2aXNpYmxlLiBGb3IgaW5zdGFuY2UsIGluIGNhc2Ugb2YgUFdBLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJvZHlBbHdheXNWaXNpYmxlKHdpbikge1xuICB3aW5bYm9keVZpc2libGVTZW50aW5lbF0gPSB0cnVlO1xufVxuXG5cbi8qKlxuICogQ2hlY2tzIHdoZXRoZXIgYSBzdHlsZSBlbGVtZW50IHdhcyByZWdpc3RlcmVkIGluIHRoZSBET00uXG4gKiBAcGFyYW0geyFEb2N1bWVudHwhU2hhZG93Um9vdH0gZG9jXG4gKiBAcGFyYW0geyFFbGVtZW50fSBzdHlsZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gc3R5bGVMb2FkZWQoZG9jLCBzdHlsZSkge1xuICBjb25zdCBzaGVldHMgPSBkb2Muc3R5bGVTaGVldHM7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc2hlZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qgc2hlZXQgPSBzaGVldHNbaV07XG4gICAgaWYgKHNoZWV0Lm93bmVyTm9kZSA9PSBzdHlsZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vLyBOb3RlOiBsb2FkZWQgYnkgM3Agc3lzdGVtLiBDYW5ub3QgcmVseSBvbiBiYWJlbCBwb2x5ZmlsbHMuXG5pbXBvcnQge21hcH0gZnJvbSAnLi91dGlscy9vYmplY3QuanMnO1xuaW1wb3J0IHtzdGFydHNXaXRofSBmcm9tICcuL3N0cmluZyc7XG5cblxuLyoqIEB0eXBlIHtPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSAqL1xubGV0IHByb3BlcnR5TmFtZUNhY2hlO1xuXG4vKiogQGNvbnN0IHshQXJyYXk8c3RyaW5nPn0gKi9cbmNvbnN0IHZlbmRvclByZWZpeGVzID0gWydXZWJraXQnLCAnd2Via2l0JywgJ01veicsICdtb3onLCAnbXMnLCAnTycsICdvJ107XG5cblxuLyoqXG4gKiBAZXhwb3J0XG4gKiBAcGFyYW0ge3N0cmluZ30gY2FtZWxDYXNlIGNhbWVsIGNhc2VkIHN0cmluZ1xuICogQHJldHVybiB7c3RyaW5nfSB0aXRsZSBjYXNlZCBzdHJpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNhbWVsQ2FzZVRvVGl0bGVDYXNlKGNhbWVsQ2FzZSkge1xuICByZXR1cm4gY2FtZWxDYXNlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgY2FtZWxDYXNlLnNsaWNlKDEpO1xufVxuXG4vKipcbiAqIENoZWNrcyB0aGUgc3R5bGUgaWYgYSBwcmVmaXhlZCB2ZXJzaW9uIG9mIGEgcHJvcGVydHkgZXhpc3RzIGFuZCByZXR1cm5zXG4gKiBpdCBvciByZXR1cm5zIGFuIGVtcHR5IHN0cmluZy5cbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyFPYmplY3R9IHN0eWxlXG4gKiBAcGFyYW0ge3N0cmluZ30gdGl0bGVDYXNlIHRoZSB0aXRsZSBjYXNlIHZlcnNpb24gb2YgYSBjc3MgcHJvcGVydHkgbmFtZVxuICogQHJldHVybiB7c3RyaW5nfSB0aGUgcHJlZml4ZWQgcHJvcGVydHkgbmFtZSBvciBudWxsLlxuICovXG5mdW5jdGlvbiBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZV8oc3R5bGUsIHRpdGxlQ2FzZSkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHZlbmRvclByZWZpeGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgcHJvcGVydHlOYW1lID0gdmVuZG9yUHJlZml4ZXNbaV0gKyB0aXRsZUNhc2U7XG4gICAgaWYgKHN0eWxlW3Byb3BlcnR5TmFtZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHByb3BlcnR5TmFtZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuICcnO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHBvc3NpYmx5IHByZWZpeGVkIEphdmFTY3JpcHQgcHJvcGVydHkgbmFtZSBvZiBhIHN0eWxlIHByb3BlcnR5XG4gKiAoZXguIFdlYmtpdFRyYW5zaXRpb25EdXJhdGlvbikgZ2l2ZW4gYSBjYW1lbENhc2UnZCB2ZXJzaW9uIG9mIHRoZSBwcm9wZXJ0eVxuICogKGV4LiB0cmFuc2l0aW9uRHVyYXRpb24pLlxuICogQGV4cG9ydFxuICogQHBhcmFtIHshT2JqZWN0fSBzdHlsZVxuICogQHBhcmFtIHtzdHJpbmd9IGNhbWVsQ2FzZSB0aGUgY2FtZWwgY2FzZWQgdmVyc2lvbiBvZiBhIGNzcyBwcm9wZXJ0eSBuYW1lXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfYnlwYXNzQ2FjaGUgYnlwYXNzIHRoZSBtZW1vaXplZCBjYWNoZSBvZiBwcm9wZXJ0eVxuICogICBtYXBwaW5nXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZShzdHlsZSwgY2FtZWxDYXNlLCBvcHRfYnlwYXNzQ2FjaGUpIHtcbiAgaWYgKHN0YXJ0c1dpdGgoY2FtZWxDYXNlLCAnLS0nKSkge1xuICAgIC8vIENTUyB2YXJzIGFyZSByZXR1cm5lZCBhcyBpcy5cbiAgICByZXR1cm4gY2FtZWxDYXNlO1xuICB9XG4gIGlmICghcHJvcGVydHlOYW1lQ2FjaGUpIHtcbiAgICBwcm9wZXJ0eU5hbWVDYWNoZSA9IG1hcCgpO1xuICB9XG4gIGxldCBwcm9wZXJ0eU5hbWUgPSBwcm9wZXJ0eU5hbWVDYWNoZVtjYW1lbENhc2VdO1xuICBpZiAoIXByb3BlcnR5TmFtZSB8fCBvcHRfYnlwYXNzQ2FjaGUpIHtcbiAgICBwcm9wZXJ0eU5hbWUgPSBjYW1lbENhc2U7XG4gICAgaWYgKHN0eWxlW2NhbWVsQ2FzZV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgY29uc3QgdGl0bGVDYXNlID0gY2FtZWxDYXNlVG9UaXRsZUNhc2UoY2FtZWxDYXNlKTtcbiAgICAgIGNvbnN0IHByZWZpeGVkUHJvcGVydHlOYW1lID0gZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWVfKHN0eWxlLCB0aXRsZUNhc2UpO1xuXG4gICAgICBpZiAoc3R5bGVbcHJlZml4ZWRQcm9wZXJ0eU5hbWVdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcHJvcGVydHlOYW1lID0gcHJlZml4ZWRQcm9wZXJ0eU5hbWU7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghb3B0X2J5cGFzc0NhY2hlKSB7XG4gICAgICBwcm9wZXJ0eU5hbWVDYWNoZVtjYW1lbENhc2VdID0gcHJvcGVydHlOYW1lO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcHJvcGVydHlOYW1lO1xufVxuXG5cbi8qKlxuICogU2V0cyB0aGUgQ1NTIHN0eWxlcyBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgd2l0aCAhaW1wb3J0YW50LiBUaGUgc3R5bGVzXG4gKiBhcmUgc3BlY2lmaWVkIGFzIGEgbWFwIGZyb20gQ1NTIHByb3BlcnR5IG5hbWVzIHRvIHRoZWlyIHZhbHVlcy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICo+fSBzdHlsZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldEltcG9ydGFudFN0eWxlcyhlbGVtZW50LCBzdHlsZXMpIHtcbiAgZm9yIChjb25zdCBrIGluIHN0eWxlcykge1xuICAgIGVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoXG4gICAgICAgIGdldFZlbmRvckpzUHJvcGVydHlOYW1lKHN0eWxlcywgayksIHN0eWxlc1trXS50b1N0cmluZygpLCAnaW1wb3J0YW50Jyk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFNldHMgdGhlIENTUyBzdHlsZSBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgd2l0aCBvcHRpb25hbCB1bml0cywgZS5nLiBcInB4XCIuXG4gKiBAcGFyYW0gez9FbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvcGVydHlcbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X3VuaXRzXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfYnlwYXNzQ2FjaGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFN0eWxlKGVsZW1lbnQsIHByb3BlcnR5LCB2YWx1ZSwgb3B0X3VuaXRzLCBvcHRfYnlwYXNzQ2FjaGUpIHtcbiAgY29uc3QgcHJvcGVydHlOYW1lID0gZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWUoZWxlbWVudC5zdHlsZSwgcHJvcGVydHksXG4gICAgICBvcHRfYnlwYXNzQ2FjaGUpO1xuICBpZiAocHJvcGVydHlOYW1lKSB7XG4gICAgZWxlbWVudC5zdHlsZVtwcm9wZXJ0eU5hbWVdID1cbiAgICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAob3B0X3VuaXRzID8gdmFsdWUgKyBvcHRfdW5pdHMgOiB2YWx1ZSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBDU1Mgc3R5bGUgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5XG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfYnlwYXNzQ2FjaGVcbiAqIEByZXR1cm4geyp9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdHlsZShlbGVtZW50LCBwcm9wZXJ0eSwgb3B0X2J5cGFzc0NhY2hlKSB7XG4gIGNvbnN0IHByb3BlcnR5TmFtZSA9IGdldFZlbmRvckpzUHJvcGVydHlOYW1lKGVsZW1lbnQuc3R5bGUsIHByb3BlcnR5LFxuICAgICAgb3B0X2J5cGFzc0NhY2hlKTtcbiAgaWYgKCFwcm9wZXJ0eU5hbWUpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIHJldHVybiBlbGVtZW50LnN0eWxlW3Byb3BlcnR5TmFtZV07XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBDU1Mgc3R5bGVzIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudC4gVGhlIHN0eWxlc1xuICogYSBzcGVjaWZpZWQgYXMgYSBtYXAgZnJvbSBDU1MgcHJvcGVydHkgbmFtZXMgdG8gdGhlaXIgdmFsdWVzLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHshT2JqZWN0PHN0cmluZywgKj59IHN0eWxlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0U3R5bGVzKGVsZW1lbnQsIHN0eWxlcykge1xuICBmb3IgKGNvbnN0IGsgaW4gc3R5bGVzKSB7XG4gICAgc2V0U3R5bGUoZWxlbWVudCwgaywgc3R5bGVzW2tdKTtcbiAgfVxufVxuXG5cbi8qKlxuICogU2hvd3Mgb3IgaGlkZXMgdGhlIHNwZWNpZmllZCBlbGVtZW50LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2Rpc3BsYXlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvZ2dsZShlbGVtZW50LCBvcHRfZGlzcGxheSkge1xuICBpZiAob3B0X2Rpc3BsYXkgPT09IHVuZGVmaW5lZCkge1xuICAgIG9wdF9kaXNwbGF5ID0gZ2V0U3R5bGUoZWxlbWVudCwgJ2Rpc3BsYXknKSA9PSAnbm9uZSc7XG4gIH1cbiAgc2V0U3R5bGUoZWxlbWVudCwgJ2Rpc3BsYXknLCBvcHRfZGlzcGxheSA/ICcnIDogJ25vbmUnKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBwaXhlbCB2YWx1ZS5cbiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcHgodmFsdWUpIHtcbiAgcmV0dXJuIGAke3ZhbHVlfXB4YDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgZGVncmVlIHZhbHVlLlxuICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWcodmFsdWUpIHtcbiAgcmV0dXJuIGAke3ZhbHVlfWRlZ2A7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIFwidHJhbnNsYXRlWFwiIGZvciBDU1MgXCJ0cmFuc2Zvcm1cIiBwcm9wZXJ0eS5cbiAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyYW5zbGF0ZVgodmFsdWUpIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBgdHJhbnNsYXRlWCgke3ZhbHVlfSlgO1xuICB9XG4gIHJldHVybiBgdHJhbnNsYXRlWCgke3B4KHZhbHVlKX0pYDtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBcInRyYW5zbGF0ZVhcIiBmb3IgQ1NTIFwidHJhbnNmb3JtXCIgcHJvcGVydHkuXG4gKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IHhcbiAqIEBwYXJhbSB7KG51bWJlcnxzdHJpbmcpPX0gb3B0X3lcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyYW5zbGF0ZSh4LCBvcHRfeSkge1xuICBpZiAodHlwZW9mIHggPT0gJ251bWJlcicpIHtcbiAgICB4ID0gcHgoeCk7XG4gIH1cbiAgaWYgKG9wdF95ID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gYHRyYW5zbGF0ZSgke3h9KWA7XG4gIH1cbiAgaWYgKHR5cGVvZiBvcHRfeSA9PSAnbnVtYmVyJykge1xuICAgIG9wdF95ID0gcHgob3B0X3kpO1xuICB9XG4gIHJldHVybiBgdHJhbnNsYXRlKCR7eH0sICR7b3B0X3l9KWA7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgXCJzY2FsZVwiIGZvciBDU1MgXCJ0cmFuc2Zvcm1cIiBwcm9wZXJ0eS5cbiAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNjYWxlKHZhbHVlKSB7XG4gIHJldHVybiBgc2NhbGUoJHt2YWx1ZX0pYDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgXCJyb3RhdGVcIiBmb3IgQ1NTIFwidHJhbnNmb3JtXCIgcHJvcGVydHkuXG4gKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByb3RhdGUodmFsdWUpIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJykge1xuICAgIHZhbHVlID0gZGVnKHZhbHVlKTtcbiAgfVxuICByZXR1cm4gYHJvdGF0ZSgke3ZhbHVlfSlgO1xufVxuXG4vKipcbiAqIFJlbW92ZSBhbHBoYSB2YWx1ZSBmcm9tIGEgcmdiYSBjb2xvciB2YWx1ZS5cbiAqIFJldHVybiB0aGUgbmV3IGNvbG9yIHByb3BlcnR5IHdpdGggYWxwaGEgZXF1YWxzIGlmIGhhcyB0aGUgYWxwaGEgdmFsdWUuXG4gKiBDYWxsZXIgbmVlZHMgdG8gbWFrZSBzdXJlIHRoZSBpbnB1dCBjb2xvciB2YWx1ZSBpcyBhIHZhbGlkIHJnYmEvcmdiIHZhbHVlXG4gKiBAcGFyYW0ge3N0cmluZ30gcmdiYUNvbG9yXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVBbHBoYUZyb21Db2xvcihyZ2JhQ29sb3IpIHtcbiAgcmV0dXJuIHJnYmFDb2xvci5yZXBsYWNlKFxuICAgICAgL1xcKChbXixdKyksKFteLF0rKSwoW14sKV0rKSxbXildK1xcKS9nLCAnKCQxLCQyLCQzLCAxKScpO1xufVxuXG4vKipcbiAqIEdldHMgdGhlIGNvbXB1dGVkIHN0eWxlIG9mIHRoZSBlbGVtZW50LiBUaGUgaGVscGVyIGlzIG5lY2Vzc2FyeSB0byBlbmZvcmNlXG4gKiB0aGUgcG9zc2libGUgYG51bGxgIHZhbHVlIHJldHVybmVkIGJ5IGEgYnVnZ3kgRmlyZWZveC5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshRWxlbWVudH0gZWxcbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZWRTdHlsZSh3aW4sIGVsKSB7XG4gIGNvbnN0IHN0eWxlID0gLyoqIEB0eXBlIHs/Q1NTU3R5bGVEZWNsYXJhdGlvbn0gKi8od2luLmdldENvbXB1dGVkU3R5bGUoZWwpKTtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59ICovKHN0eWxlKSB8fCBtYXAoKTtcbn1cblxuXG4vKipcbiAqIFJlc2V0cyBzdHlsZXMgdGhhdCB3ZXJlIHNldCBkeW5hbWljYWxseSAoaS5lLiBpbmxpbmUpXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0geyFBcnJheTxzdHJpbmc+fSBwcm9wZXJ0aWVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldFN0eWxlcyhlbGVtZW50LCBwcm9wZXJ0aWVzKSB7XG4gIGNvbnN0IHN0eWxlT2JqID0ge307XG4gIHByb3BlcnRpZXMuZm9yRWFjaChwcm9wID0+IHtcbiAgICBzdHlsZU9ialtwcm9wXSA9IG51bGw7XG4gIH0pO1xuICBzZXRTdHlsZXMoZWxlbWVudCwgc3R5bGVPYmopO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qIEBjb25zdCAqL1xuY29uc3QgdG9TdHJpbmdfID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBFQ01BIFtbQ2xhc3NdXSBvZiBhIHZhbHVlXG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHRvU3RyaW5nKHZhbHVlKSB7XG4gIHJldHVybiB0b1N0cmluZ18uY2FsbCh2YWx1ZSk7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lcyBpZiB2YWx1ZSBpcyBhY3R1YWxseSBhbiBBcnJheS5cbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0FycmF5KHZhbHVlKSB7XG4gIHJldHVybiBBcnJheS5pc0FycmF5KHZhbHVlKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhbiBhcnJheS1saWtlIG9iamVjdCB0byBhbiBhcnJheS5cbiAqIEBwYXJhbSB7P0lBcnJheUxpa2U8VD58c3RyaW5nfSBhcnJheUxpa2VcbiAqIEByZXR1cm4geyFBcnJheTxUPn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b0FycmF5KGFycmF5TGlrZSkge1xuICBpZiAoIWFycmF5TGlrZSkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBjb25zdCBhcnJheSA9IG5ldyBBcnJheShhcnJheUxpa2UubGVuZ3RoKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheUxpa2UubGVuZ3RoOyBpKyspIHtcbiAgICBhcnJheVtpXSA9IGFycmF5TGlrZVtpXTtcbiAgfVxuICByZXR1cm4gYXJyYXk7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lcyBpZiB2YWx1ZSBpcyBhY3R1YWxseSBhbiBPYmplY3QuXG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgcmV0dXJuIHRvU3RyaW5nKHZhbHVlKSA9PT0gJ1tvYmplY3QgT2JqZWN0XSc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lcyBpZiB2YWx1ZSBpcyBvZiBudW1iZXIgdHlwZSBhbmQgZmluaXRlLlxuICogTmFOIGFuZCBJbmZpbml0eSBhcmUgbm90IGNvbnNpZGVyZWQgYSBmaW5pdGUgbnVtYmVyLlxuICogU3RyaW5nIG51bWJlcnMgYXJlIG5vdCBjb25zaWRlcmVkIG51bWJlcnMuXG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNGaW5pdGVOdW1iZXIodmFsdWUpIHtcbiAgcmV0dXJuICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIGlzRmluaXRlKHZhbHVlKSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIHdoZXRoZXIgYHNgIGlzIGEgdmFsaWQgdmFsdWUgb2YgYGVudW1PYmpgLlxuICpcbiAqIEBwYXJhbSB7IU9iamVjdDxUPn0gZW51bU9ialxuICogQHBhcmFtIHtUfSBzXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRW51bVZhbHVlKGVudW1PYmosIHMpIHtcbiAgZm9yIChjb25zdCBrIGluIGVudW1PYmopIHtcbiAgICBpZiAoZW51bU9ialtrXSA9PT0gcykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBFeHRlcm5zIGRlY2xhcmUgdGhhdCBhY2Nlc3MgYGRlZmF1bHRWaWV3YCBmcm9tIGBkb2N1bWVudGAgb3JcbiAqIGBvd25lckRvY3VtZW50YCBpcyBvZiB0eXBlIGAoV2luZG93fG51bGwpYCBidXQgbW9zdCBvZiBvdXIgcGFyYW1ldGVyIHR5cGVzXG4gKiBhc3N1bWUgdGhhdCBpdCBpcyBuZXZlciBudWxsLiBUaGlzIGlzIE9LIGluIHByYWN0aWNlIGFzIHdlIGV2ZXIgb25seSBnZXRcbiAqIG51bGwgb24gZGlzY29ubmVjdGVkIGRvY3VtZW50cyBvciBvbGQgSUUuXG4gKiBUaGlzIGhlbHBlciBmdW5jdGlvbiBjYXN0cyBpdCBpbnRvIGp1c3QgYSBzaW1wbGUgV2luZG93IHJldHVybiB0eXBlLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd3xudWxsfSB3aW5Pck51bGxcbiAqIEByZXR1cm4geyFXaW5kb3d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b1dpbih3aW5Pck51bGwpIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVdpbmRvd30gKi8gKHdpbk9yTnVsbCk7XG59XG5cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge3RyeURlY29kZVVyaUNvbXBvbmVudF99IGZyb20gJy4vdXJsLXRyeS1kZWNvZGUtdXJpLWNvbXBvbmVudCc7XG5cbmNvbnN0IHJlZ2V4ID0gLyg/Ol5bIz9dP3wmKShbXj0mXSspKD86PShbXiZdKikpPy9nO1xuXG4vKipcbiAqIFBhcnNlcyB0aGUgcXVlcnkgc3RyaW5nIG9mIGFuIFVSTC4gVGhpcyBtZXRob2QgcmV0dXJucyBhIHNpbXBsZSBrZXkvdmFsdWVcbiAqIG1hcC4gSWYgdGhlcmUgYXJlIGR1cGxpY2F0ZSBrZXlzIHRoZSBsYXRlc3QgdmFsdWUgaXMgcmV0dXJuZWQuXG4gKlxuICogRE8gTk9UIGltcG9ydCB0aGUgZnVuY3Rpb24gZnJvbSB0aGlzIGZpbGUuIEluc3RlYWQsIGltcG9ydCBwYXJzZVF1ZXJ5U3RyaW5nXG4gKiBmcm9tIGBzcmMvdXJsLmpzYC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcXVlcnlTdHJpbmdcbiAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VRdWVyeVN0cmluZ18ocXVlcnlTdHJpbmcpIHtcbiAgY29uc3QgcGFyYW1zID0gLyoqIEB0eXBlIHshSnNvbk9iamVjdH0gKi8gKE9iamVjdC5jcmVhdGUobnVsbCkpO1xuICBpZiAoIXF1ZXJ5U3RyaW5nKSB7XG4gICAgcmV0dXJuIHBhcmFtcztcbiAgfVxuXG4gIGxldCBtYXRjaDtcbiAgd2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWMocXVlcnlTdHJpbmcpKSkge1xuICAgIGNvbnN0IG5hbWUgPSB0cnlEZWNvZGVVcmlDb21wb25lbnRfKG1hdGNoWzFdLCBtYXRjaFsxXSk7XG4gICAgY29uc3QgdmFsdWUgPSBtYXRjaFsyXSA/IHRyeURlY29kZVVyaUNvbXBvbmVudF8obWF0Y2hbMl0sIG1hdGNoWzJdKSA6ICcnO1xuICAgIHBhcmFtc1tuYW1lXSA9IHZhbHVlO1xuICB9XG4gIHJldHVybiBwYXJhbXM7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBUcmllcyB0byBkZWNvZGUgYSBVUkkgY29tcG9uZW50LCBmYWxsaW5nIGJhY2sgdG8gb3B0X2ZhbGxiYWNrIChvciBhbiBlbXB0eVxuICogc3RyaW5nKVxuICpcbiAqIERPIE5PVCBpbXBvcnQgdGhlIGZ1bmN0aW9uIGZyb20gdGhpcyBmaWxlLiBJbnN0ZWFkLCBpbXBvcnRcbiAqIHRyeURlY29kZVVyaUNvbXBvbmVudCBmcm9tIGBzcmMvdXJsLmpzYC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gY29tcG9uZW50XG4gKiBAcGFyYW0ge3N0cmluZz19IGZhbGxiYWNrXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnlEZWNvZGVVcmlDb21wb25lbnRfKGNvbXBvbmVudCwgZmFsbGJhY2sgPSAnJykge1xuICB0cnkge1xuICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoY29tcG9uZW50KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBmYWxsYmFjaztcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7THJ1Q2FjaGV9IGZyb20gJy4vdXRpbHMvbHJ1LWNhY2hlJztcbmltcG9ydCB7ZGljdH0gZnJvbSAnLi91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtlbmRzV2l0aCwgc3RhcnRzV2l0aH0gZnJvbSAnLi9zdHJpbmcnO1xuaW1wb3J0IHtnZXRNb2RlfSBmcm9tICcuL21vZGUnO1xuaW1wb3J0IHtpc0FycmF5fSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7cGFyc2VRdWVyeVN0cmluZ199IGZyb20gJy4vdXJsLXBhcnNlLXF1ZXJ5LXN0cmluZyc7XG5pbXBvcnQge3RyeURlY29kZVVyaUNvbXBvbmVudF99IGZyb20gJy4vdXJsLXRyeS1kZWNvZGUtdXJpLWNvbXBvbmVudCc7XG5pbXBvcnQge3VybHN9IGZyb20gJy4vY29uZmlnJztcbmltcG9ydCB7dXNlcn0gZnJvbSAnLi9sb2cnO1xuXG4vKipcbiAqIEB0eXBlIHshSnNvbk9iamVjdH1cbiAqL1xuY29uc3QgU0VSVklOR19UWVBFX1BSRUZJWCA9IGRpY3Qoe1xuICAvLyBObyB2aWV3ZXJcbiAgJ2MnOiB0cnVlLFxuICAvLyBJbiB2aWV3ZXJcbiAgJ3YnOiB0cnVlLFxuICAvLyBBZCBsYW5kaW5nIHBhZ2VcbiAgJ2EnOiB0cnVlLFxuICAvLyBBZFxuICAnYWQnOiB0cnVlLFxufSk7XG5cbi8qKlxuICogQ2FjaGVkIGEtdGFnIHRvIGF2b2lkIG1lbW9yeSBhbGxvY2F0aW9uIGR1cmluZyBVUkwgcGFyc2luZy5cbiAqIEB0eXBlIHtIVE1MQW5jaG9yRWxlbWVudH1cbiAqL1xubGV0IGE7XG5cbi8qKlxuICogV2UgY2FjaGVkIGFsbCBwYXJzZWQgVVJMcy4gQXMgb2Ygbm93IHRoZXJlIGFyZSBubyB1c2UgY2FzZXNcbiAqIG9mIEFNUCBkb2NzIHRoYXQgd291bGQgZXZlciBwYXJzZSBhbiBhY3R1YWwgbGFyZ2UgbnVtYmVyIG9mIFVSTHMsXG4gKiBidXQgd2Ugb2Z0ZW4gcGFyc2UgdGhlIHNhbWUgb25lIG92ZXIgYW5kIG92ZXIgYWdhaW4uXG4gKiBAdHlwZSB7THJ1Q2FjaGV9XG4gKi9cbmxldCBjYWNoZTtcblxuLyoqIEBwcml2YXRlIEBjb25zdCBNYXRjaGVzIGFtcF9qc18qIHBhcmFtZXRlcnMgaW4gcXVlcnkgc3RyaW5nLiAqL1xuY29uc3QgQU1QX0pTX1BBUkFNU19SRUdFWCA9IC9bPyZdYW1wX2pzW14mXSovO1xuXG4vKiogQHByaXZhdGUgQGNvbnN0IE1hdGNoZXMgYW1wX2dzYSBwYXJhbWV0ZXJzIGluIHF1ZXJ5IHN0cmluZy4gKi9cbmNvbnN0IEFNUF9HU0FfUEFSQU1TX1JFR0VYID0gL1s/Jl1hbXBfZ3NhW14mXSovO1xuXG4vKiogQHByaXZhdGUgQGNvbnN0IE1hdGNoZXMgYW1wX3IgcGFyYW1ldGVycyBpbiBxdWVyeSBzdHJpbmcuICovXG5jb25zdCBBTVBfUl9QQVJBTVNfUkVHRVggPSAvWz8mXWFtcF9yW14mXSovO1xuXG4vKiogQHByaXZhdGUgQGNvbnN0IE1hdGNoZXMgdXNxcCBwYXJhbWV0ZXJzIGZyb20gZ29vZyBleHBlcmltZW50IGluIHF1ZXJ5IHN0cmluZy4gKi9cbmNvbnN0IEdPT0dMRV9FWFBFUklNRU5UX1BBUkFNU19SRUdFWCA9IC9bPyZddXNxcFteJl0qLztcblxuY29uc3QgSU5WQUxJRF9QUk9UT0NPTFMgPSBbXG4gIC8qZXNsaW50IG5vLXNjcmlwdC11cmw6IDAqLyAnamF2YXNjcmlwdDonLFxuICAvKmVzbGludCBuby1zY3JpcHQtdXJsOiAwKi8gJ2RhdGE6JyxcbiAgLyplc2xpbnQgbm8tc2NyaXB0LXVybDogMCovICd2YnNjcmlwdDonLFxuXTtcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuZXhwb3J0IGNvbnN0IFNPVVJDRV9PUklHSU5fUEFSQU0gPSAnX19hbXBfc291cmNlX29yaWdpbic7XG5cbi8qKlxuICogUmV0dXJucyB0aGUgY29ycmVjdCBvcmlnaW4gZm9yIGEgZ2l2ZW4gd2luZG93LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge3N0cmluZ30gb3JpZ2luXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRXaW5PcmlnaW4od2luKSB7XG4gIHJldHVybiB3aW4ub3JpZ2luIHx8IHBhcnNlVXJsRGVwcmVjYXRlZCh3aW4ubG9jYXRpb24uaHJlZikub3JpZ2luO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBMb2NhdGlvbi1saWtlIG9iamVjdCBmb3IgdGhlIGdpdmVuIFVSTC4gSWYgaXQgaXMgcmVsYXRpdmUsXG4gKiB0aGUgVVJMIGdldHMgcmVzb2x2ZWQuXG4gKiBDb25zaWRlciB0aGUgcmV0dXJuZWQgb2JqZWN0IGltbXV0YWJsZS4gVGhpcyBpcyBlbmZvcmNlZCBkdXJpbmdcbiAqIHRlc3RpbmcgYnkgZnJlZXppbmcgdGhlIG9iamVjdC5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9ub2NhY2hlXG4gKiBAcmV0dXJuIHshTG9jYXRpb259XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVVybERlcHJlY2F0ZWQodXJsLCBvcHRfbm9jYWNoZSkge1xuICBpZiAoIWEpIHtcbiAgICBhID0gLyoqIEB0eXBlIHshSFRNTEFuY2hvckVsZW1lbnR9ICovIChzZWxmLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKSk7XG4gICAgY2FjaGUgPSBzZWxmLlVybENhY2hlIHx8IChzZWxmLlVybENhY2hlID0gbmV3IExydUNhY2hlKDEwMCkpO1xuICB9XG5cbiAgcmV0dXJuIHBhcnNlVXJsV2l0aEEoYSwgdXJsLCBvcHRfbm9jYWNoZSA/IG51bGwgOiBjYWNoZSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIExvY2F0aW9uLWxpa2Ugb2JqZWN0IGZvciB0aGUgZ2l2ZW4gVVJMLiBJZiBpdCBpcyByZWxhdGl2ZSxcbiAqIHRoZSBVUkwgZ2V0cyByZXNvbHZlZC5cbiAqIENvbnNpZGVyIHRoZSByZXR1cm5lZCBvYmplY3QgaW1tdXRhYmxlLiBUaGlzIGlzIGVuZm9yY2VkIGR1cmluZ1xuICogdGVzdGluZyBieSBmcmVlemluZyB0aGUgb2JqZWN0LlxuICogQHBhcmFtIHshSFRNTEFuY2hvckVsZW1lbnR9IGFcbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7THJ1Q2FjaGU9fSBvcHRfY2FjaGVcbiAqIEByZXR1cm4geyFMb2NhdGlvbn1cbiAqIEByZXN0cmljdGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVVybFdpdGhBKGEsIHVybCwgb3B0X2NhY2hlKSB7XG4gIGlmIChvcHRfY2FjaGUgJiYgb3B0X2NhY2hlLmhhcyh1cmwpKSB7XG4gICAgcmV0dXJuIG9wdF9jYWNoZS5nZXQodXJsKTtcbiAgfVxuXG4gIGEuaHJlZiA9IHVybDtcblxuICAvLyBJRTExIGRvZXNuJ3QgcHJvdmlkZSBmdWxsIFVSTCBjb21wb25lbnRzIHdoZW4gcGFyc2luZyByZWxhdGl2ZSBVUkxzLlxuICAvLyBBc3NpZ25pbmcgdG8gaXRzZWxmIGFnYWluIGRvZXMgdGhlIHRyaWNrICMzNDQ5LlxuICBpZiAoIWEucHJvdG9jb2wpIHtcbiAgICBhLmhyZWYgPSBhLmhyZWY7XG4gIH1cblxuICBjb25zdCBpbmZvID0gLyoqIEB0eXBlIHshTG9jYXRpb259ICovKHtcbiAgICBocmVmOiBhLmhyZWYsXG4gICAgcHJvdG9jb2w6IGEucHJvdG9jb2wsXG4gICAgaG9zdDogYS5ob3N0LFxuICAgIGhvc3RuYW1lOiBhLmhvc3RuYW1lLFxuICAgIHBvcnQ6IGEucG9ydCA9PSAnMCcgPyAnJyA6IGEucG9ydCxcbiAgICBwYXRobmFtZTogYS5wYXRobmFtZSxcbiAgICBzZWFyY2g6IGEuc2VhcmNoLFxuICAgIGhhc2g6IGEuaGFzaCxcbiAgICBvcmlnaW46IG51bGwsIC8vIFNldCBiZWxvdy5cbiAgfSk7XG5cbiAgLy8gU29tZSBJRTExIHNwZWNpZmljIHBvbHlmaWxscy5cbiAgLy8gMSkgSUUxMSBzdHJpcHMgb3V0IHRoZSBsZWFkaW5nICcvJyBpbiB0aGUgcGF0aG5hbWUuXG4gIGlmIChpbmZvLnBhdGhuYW1lWzBdICE9PSAnLycpIHtcbiAgICBpbmZvLnBhdGhuYW1lID0gJy8nICsgaW5mby5wYXRobmFtZTtcbiAgfVxuXG4gIC8vIDIpIEZvciBVUkxzIHdpdGggaW1wbGljaXQgcG9ydHMsIElFMTEgcGFyc2VzIHRvIGRlZmF1bHQgcG9ydHMgd2hpbGVcbiAgLy8gb3RoZXIgYnJvd3NlcnMgbGVhdmUgdGhlIHBvcnQgZmllbGQgZW1wdHkuXG4gIGlmICgoaW5mby5wcm90b2NvbCA9PSAnaHR0cDonICYmIGluZm8ucG9ydCA9PSA4MClcbiAgICAgIHx8IChpbmZvLnByb3RvY29sID09ICdodHRwczonICYmIGluZm8ucG9ydCA9PSA0NDMpKSB7XG4gICAgaW5mby5wb3J0ID0gJyc7XG4gICAgaW5mby5ob3N0ID0gaW5mby5ob3N0bmFtZTtcbiAgfVxuXG4gIC8vIEZvciBkYXRhIFVSSSBhLm9yaWdpbiBpcyBlcXVhbCB0byB0aGUgc3RyaW5nICdudWxsJyB3aGljaCBpcyBub3QgdXNlZnVsLlxuICAvLyBXZSBpbnN0ZWFkIHJldHVybiB0aGUgYWN0dWFsIG9yaWdpbiB3aGljaCBpcyB0aGUgZnVsbCBVUkwuXG4gIGlmIChhLm9yaWdpbiAmJiBhLm9yaWdpbiAhPSAnbnVsbCcpIHtcbiAgICBpbmZvLm9yaWdpbiA9IGEub3JpZ2luO1xuICB9IGVsc2UgaWYgKGluZm8ucHJvdG9jb2wgPT0gJ2RhdGE6JyB8fCAhaW5mby5ob3N0KSB7XG4gICAgaW5mby5vcmlnaW4gPSBpbmZvLmhyZWY7XG4gIH0gZWxzZSB7XG4gICAgaW5mby5vcmlnaW4gPSBpbmZvLnByb3RvY29sICsgJy8vJyArIGluZm8uaG9zdDtcbiAgfVxuXG4gIC8vIEZyZWV6ZSBkdXJpbmcgdGVzdGluZyB0byBhdm9pZCBhY2NpZGVudGFsIG11dGF0aW9uLlxuICBjb25zdCBmcm96ZW4gPSAoZ2V0TW9kZSgpLnRlc3QgJiYgT2JqZWN0LmZyZWV6ZSkgPyBPYmplY3QuZnJlZXplKGluZm8pIDogaW5mbztcblxuICBpZiAob3B0X2NhY2hlKSB7XG4gICAgb3B0X2NhY2hlLnB1dCh1cmwsIGZyb3plbik7XG4gIH1cblxuICByZXR1cm4gZnJvemVuO1xufVxuXG4vKipcbiAqIEFwcGVuZHMgdGhlIHN0cmluZyBqdXN0IGJlZm9yZSB0aGUgZnJhZ21lbnQgcGFydCAob3Igb3B0aW9uYWxseVxuICogdG8gdGhlIGZyb250IG9mIHRoZSBxdWVyeSBzdHJpbmcpIG9mIHRoZSBVUkwuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0ge3N0cmluZ30gcGFyYW1TdHJpbmdcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9hZGRUb0Zyb250XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcHBlbmRFbmNvZGVkUGFyYW1TdHJpbmdUb1VybCh1cmwsIHBhcmFtU3RyaW5nLFxuICBvcHRfYWRkVG9Gcm9udCkge1xuICBpZiAoIXBhcmFtU3RyaW5nKSB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxuICBjb25zdCBtYWluQW5kRnJhZ21lbnQgPSB1cmwuc3BsaXQoJyMnLCAyKTtcbiAgY29uc3QgbWFpbkFuZFF1ZXJ5ID0gbWFpbkFuZEZyYWdtZW50WzBdLnNwbGl0KCc/JywgMik7XG5cbiAgbGV0IG5ld1VybCA9IG1haW5BbmRRdWVyeVswXSArIChcbiAgICBtYWluQW5kUXVlcnlbMV1cbiAgICAgID8gKG9wdF9hZGRUb0Zyb250XG4gICAgICAgID8gYD8ke3BhcmFtU3RyaW5nfSYke21haW5BbmRRdWVyeVsxXX1gXG4gICAgICAgIDogYD8ke21haW5BbmRRdWVyeVsxXX0mJHtwYXJhbVN0cmluZ31gKVxuICAgICAgOiBgPyR7cGFyYW1TdHJpbmd9YCk7XG4gIG5ld1VybCArPSBtYWluQW5kRnJhZ21lbnRbMV0gPyBgIyR7bWFpbkFuZEZyYWdtZW50WzFdfWAgOiAnJztcbiAgcmV0dXJuIG5ld1VybDtcbn1cbi8qKlxuICogQXBwZW5kcyBhIHF1ZXJ5IHN0cmluZyBmaWVsZCBhbmQgdmFsdWUgdG8gYSB1cmwuIGBrZXlgIGFuZCBgdmFsdWVgXG4gKiB3aWxsIGJlIHJhbiB0aHJvdWdoIGBlbmNvZGVVUklDb21wb25lbnRgIGJlZm9yZSBhcHBlbmRpbmcuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5XG4gKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9hZGRUb0Zyb250XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGRQYXJhbVRvVXJsKHVybCwga2V5LCB2YWx1ZSwgb3B0X2FkZFRvRnJvbnQpIHtcbiAgY29uc3QgZmllbGQgPSBgJHtlbmNvZGVVUklDb21wb25lbnQoa2V5KX09JHtlbmNvZGVVUklDb21wb25lbnQodmFsdWUpfWA7XG4gIHJldHVybiBhcHBlbmRFbmNvZGVkUGFyYW1TdHJpbmdUb1VybCh1cmwsIGZpZWxkLCBvcHRfYWRkVG9Gcm9udCk7XG59XG5cbi8qKlxuICogQXBwZW5kcyBxdWVyeSBzdHJpbmcgZmllbGRzIGFuZCB2YWx1ZXMgdG8gYSB1cmwuIFRoZSBgcGFyYW1zYCBvYmplY3RzJ1xuICogYGtleWBzIGFuZCBgdmFsdWVgcyB3aWxsIGJlIHRyYW5zZm9ybWVkIGludG8gcXVlcnkgc3RyaW5nIGtleXMvdmFsdWVzLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHBhcmFtIHshSnNvbk9iamVjdDxzdHJpbmcsIHN0cmluZ3whQXJyYXk8c3RyaW5nPj59IHBhcmFtc1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkUGFyYW1zVG9VcmwodXJsLCBwYXJhbXMpIHtcbiAgcmV0dXJuIGFwcGVuZEVuY29kZWRQYXJhbVN0cmluZ1RvVXJsKHVybCwgc2VyaWFsaXplUXVlcnlTdHJpbmcocGFyYW1zKSk7XG59XG5cbi8qKlxuICogU2VyaWFsaXplcyB0aGUgcGFzc2VkIHBhcmFtZXRlciBtYXAgaW50byBhIHF1ZXJ5IHN0cmluZyB3aXRoIGJvdGgga2V5c1xuICogYW5kIHZhbHVlcyBlbmNvZGVkLlxuICogQHBhcmFtIHshSnNvbk9iamVjdDxzdHJpbmcsIHN0cmluZ3whQXJyYXk8c3RyaW5nPj59IHBhcmFtc1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2VyaWFsaXplUXVlcnlTdHJpbmcocGFyYW1zKSB7XG4gIGNvbnN0IHMgPSBbXTtcbiAgZm9yIChjb25zdCBrIGluIHBhcmFtcykge1xuICAgIGNvbnN0IHYgPSBwYXJhbXNba107XG4gICAgaWYgKHYgPT0gbnVsbCkge1xuICAgICAgY29udGludWU7XG4gICAgfSBlbHNlIGlmIChpc0FycmF5KHYpKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHYubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgc3YgPSAvKiogQHR5cGUge3N0cmluZ30gKi8gKHZbaV0pO1xuICAgICAgICBzLnB1c2goYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGspfT0ke2VuY29kZVVSSUNvbXBvbmVudChzdil9YCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHN2ID0gLyoqIEB0eXBlIHtzdHJpbmd9ICovICh2KTtcbiAgICAgIHMucHVzaChgJHtlbmNvZGVVUklDb21wb25lbnQoayl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHN2KX1gKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHMuam9pbignJicpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBVUkwgaXMgc2VjdXJlOiBlaXRoZXIgSFRUUFMgb3IgbG9jYWxob3N0IChmb3IgdGVzdGluZykuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzU2VjdXJlVXJsRGVwcmVjYXRlZCh1cmwpIHtcbiAgaWYgKHR5cGVvZiB1cmwgPT0gJ3N0cmluZycpIHtcbiAgICB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgfVxuICByZXR1cm4gKHVybC5wcm90b2NvbCA9PSAnaHR0cHM6JyB8fFxuICAgICAgdXJsLmhvc3RuYW1lID09ICdsb2NhbGhvc3QnIHx8XG4gICAgICBlbmRzV2l0aCh1cmwuaG9zdG5hbWUsICcubG9jYWxob3N0JykpO1xufVxuXG4vKipcbiAqIEFzc2VydHMgdGhhdCBhIGdpdmVuIHVybCBpcyBIVFRQUyBvciBwcm90b2NvbCByZWxhdGl2ZS4gSXQncyBhIHVzZXItbGV2ZWxcbiAqIGFzc2VydC5cbiAqXG4gKiBQcm92aWRlcyBhbiBleGNlcHRpb24gZm9yIGxvY2FsaG9zdC5cbiAqXG4gKiBAcGFyYW0gez9zdHJpbmd8dW5kZWZpbmVkfSB1cmxTdHJpbmdcbiAqIEBwYXJhbSB7IUVsZW1lbnR8c3RyaW5nfSBlbGVtZW50Q29udGV4dCBFbGVtZW50IHdoZXJlIHRoZSB1cmwgd2FzIGZvdW5kLlxuICogQHBhcmFtIHtzdHJpbmc9fSBzb3VyY2VOYW1lIFVzZWQgZm9yIGVycm9yIG1lc3NhZ2VzLlxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0SHR0cHNVcmwoXG4gIHVybFN0cmluZywgZWxlbWVudENvbnRleHQsIHNvdXJjZU5hbWUgPSAnc291cmNlJykge1xuICB1c2VyKCkuYXNzZXJ0KHVybFN0cmluZyAhPSBudWxsLCAnJXMgJXMgbXVzdCBiZSBhdmFpbGFibGUnLFxuICAgICAgZWxlbWVudENvbnRleHQsIHNvdXJjZU5hbWUpO1xuICAvLyAoZXJ3aW5tLCAjNDU2MCk6IHR5cGUgY2FzdCBuZWNlc3NhcnkgdW50aWwgIzQ1NjAgaXMgZml4ZWQuXG4gIGNvbnN0IHRoZVVybFN0cmluZyA9IC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAodXJsU3RyaW5nKTtcbiAgdXNlcigpLmFzc2VydChpc1NlY3VyZVVybERlcHJlY2F0ZWQodGhlVXJsU3RyaW5nKSB8fCAvXihcXC9cXC8pLy50ZXN0KHRoZVVybFN0cmluZyksXG4gICAgICAnJXMgJXMgbXVzdCBzdGFydCB3aXRoICcgK1xuICAgICAgJ1wiaHR0cHM6Ly9cIiBvciBcIi8vXCIgb3IgYmUgcmVsYXRpdmUgYW5kIHNlcnZlZCBmcm9tICcgK1xuICAgICAgJ2VpdGhlciBodHRwcyBvciBmcm9tIGxvY2FsaG9zdC4gSW52YWxpZCB2YWx1ZTogJXMnLFxuICAgICAgZWxlbWVudENvbnRleHQsIHNvdXJjZU5hbWUsIHRoZVVybFN0cmluZyk7XG4gIHJldHVybiB0aGVVcmxTdHJpbmc7XG59XG5cbi8qKlxuICogQXNzZXJ0cyB0aGF0IGEgZ2l2ZW4gdXJsIGlzIGFuIGFic29sdXRlIEhUVFAgb3IgSFRUUFMgVVJMLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFN0cmluZ1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0QWJzb2x1dGVIdHRwT3JIdHRwc1VybCh1cmxTdHJpbmcpIHtcbiAgdXNlcigpLmFzc2VydCgvXmh0dHBzP1xcOi9pLnRlc3QodXJsU3RyaW5nKSxcbiAgICAgICdVUkwgbXVzdCBzdGFydCB3aXRoIFwiaHR0cDovL1wiIG9yIFwiaHR0cHM6Ly9cIi4gSW52YWxpZCB2YWx1ZTogJXMnLFxuICAgICAgdXJsU3RyaW5nKTtcbiAgcmV0dXJuIHBhcnNlVXJsRGVwcmVjYXRlZCh1cmxTdHJpbmcpLmhyZWY7XG59XG5cblxuLyoqXG4gKiBQYXJzZXMgdGhlIHF1ZXJ5IHN0cmluZyBvZiBhbiBVUkwuIFRoaXMgbWV0aG9kIHJldHVybnMgYSBzaW1wbGUga2V5L3ZhbHVlXG4gKiBtYXAuIElmIHRoZXJlIGFyZSBkdXBsaWNhdGUga2V5cyB0aGUgbGF0ZXN0IHZhbHVlIGlzIHJldHVybmVkLlxuICpcbiAqIFRoaXMgZnVuY3Rpb24gaXMgaW1wbGVtZW50ZWQgaW4gYSBzZXBhcmF0ZSBmaWxlIHRvIGF2b2lkIGEgY2lyY3VsYXJcbiAqIGRlcGVuZGVuY3kuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5U3RyaW5nXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlUXVlcnlTdHJpbmcocXVlcnlTdHJpbmcpIHtcbiAgcmV0dXJuIHBhcnNlUXVlcnlTdHJpbmdfKHF1ZXJ5U3RyaW5nKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBVUkwgd2l0aG91dCBmcmFnbWVudC4gSWYgVVJMIGRvZXNuJ3QgY29udGFpbiBmcmFnbWVudCwgdGhlIHNhbWVcbiAqIHN0cmluZyBpcyByZXR1cm5lZC5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUZyYWdtZW50KHVybCkge1xuICBjb25zdCBpbmRleCA9IHVybC5pbmRleE9mKCcjJyk7XG4gIGlmIChpbmRleCA9PSAtMSkge1xuICAgIHJldHVybiB1cmw7XG4gIH1cbiAgcmV0dXJuIHVybC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGZyYWdtZW50IGZyb20gdGhlIFVSTC4gSWYgdGhlIFVSTCBkb2Vzbid0IGNvbnRhaW4gZnJhZ21lbnQsXG4gKiB0aGUgZW1wdHkgc3RyaW5nIGlzIHJldHVybmVkLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RnJhZ21lbnQodXJsKSB7XG4gIGNvbnN0IGluZGV4ID0gdXJsLmluZGV4T2YoJyMnKTtcbiAgaWYgKGluZGV4ID09IC0xKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG4gIHJldHVybiB1cmwuc3Vic3RyaW5nKGluZGV4KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgdGhlIFVSTCBoYXMgdGhlIG9yaWdpbiBvZiBhIHByb3h5LlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmwgVVJMIG9mIGFuIEFNUCBkb2N1bWVudC5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1Byb3h5T3JpZ2luKHVybCkge1xuICBpZiAodHlwZW9mIHVybCA9PSAnc3RyaW5nJykge1xuICAgIHVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICB9XG4gIHJldHVybiB1cmxzLmNkblByb3h5UmVnZXgudGVzdCh1cmwub3JpZ2luKTtcbn1cblxuLyoqXG4gKiBGb3IgcHJveHktb3JpZ2luIFVSTHMsIHJldHVybnMgdGhlIHNlcnZpbmcgdHlwZS4gT3RoZXJ3aXNlLCByZXR1cm5zIG51bGwuXG4gKiBFLmcuLCAnaHR0cHM6Ly9hbXAtY29tLmNkbi5hbXBwcm9qZWN0Lm9yZy9hL3MvYW1wLmNvbS9hbXBfZG9jdW1lbnQuaHRtbCdcbiAqIHJldHVybnMgJ2EnLlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmwgVVJMIG9mIGFuIEFNUCBkb2N1bWVudC5cbiAqIEByZXR1cm4gez9zdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcm94eVNlcnZpbmdUeXBlKHVybCkge1xuICBpZiAodHlwZW9mIHVybCA9PSAnc3RyaW5nJykge1xuICAgIHVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICB9XG4gIGlmICghaXNQcm94eU9yaWdpbih1cmwpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgcGF0aCA9IHVybC5wYXRobmFtZS5zcGxpdCgnLycsIDIpO1xuICByZXR1cm4gcGF0aFsxXTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgdGhlIFVSTCBvcmlnaW4gaXMgbG9jYWxob3N0LlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmwgVVJMIG9mIGFuIEFNUCBkb2N1bWVudC5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvY2FsaG9zdE9yaWdpbih1cmwpIHtcbiAgaWYgKHR5cGVvZiB1cmwgPT0gJ3N0cmluZycpIHtcbiAgICB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgfVxuICByZXR1cm4gdXJscy5sb2NhbGhvc3RSZWdleC50ZXN0KHVybC5vcmlnaW4pO1xufVxuXG4vKipcbiAqIFJldHVybnMgd2hldGhlciB0aGUgVVJMIGhhcyB2YWxpZCBwcm90b2NvbC5cbiAqIERlZXAgbGluayBwcm90b2NvbCBpcyB2YWxpZCwgYnV0IG5vdCBqYXZhc2NyaXB0IGV0Yy5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNQcm90b2NvbFZhbGlkKHVybCkge1xuICBpZiAoIXVybCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGlmICh0eXBlb2YgdXJsID09ICdzdHJpbmcnKSB7XG4gICAgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIH1cbiAgcmV0dXJuICFJTlZBTElEX1BST1RPQ09MUy5pbmNsdWRlcyh1cmwucHJvdG9jb2wpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBVUkwgd2l0aG91dCBBTVAgSlMgcGFyYW1ldGVycy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUFtcEpzUGFyYW1zRnJvbVVybCh1cmwpIHtcbiAgY29uc3QgcGFyc2VkID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIGNvbnN0IHNlYXJjaCA9IHJlbW92ZUFtcEpzUGFyYW1zRnJvbVNlYXJjaChwYXJzZWQuc2VhcmNoKTtcbiAgcmV0dXJuIHBhcnNlZC5vcmlnaW4gKyBwYXJzZWQucGF0aG5hbWUgKyBzZWFyY2ggKyBwYXJzZWQuaGFzaDtcblxufVxuXG4vKipcbiAqIFJldHVybnMgYSBVUkwgd2l0aG91dCBhIHF1ZXJ5IHN0cmluZy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZVNlYXJjaCh1cmwpIHtcbiAgY29uc3QgaW5kZXggPSB1cmwuaW5kZXhPZignPycpO1xuICBpZiAoaW5kZXggPT0gLTEpIHtcbiAgICByZXR1cm4gdXJsO1xuICB9XG4gIGNvbnN0IGZyYWdtZW50ID0gZ2V0RnJhZ21lbnQodXJsKTtcbiAgcmV0dXJuIHVybC5zdWJzdHJpbmcoMCwgaW5kZXgpICsgZnJhZ21lbnQ7XG59XG5cbi8qKlxuICogUmVtb3ZlcyBwYXJhbWV0ZXJzIHRoYXQgc3RhcnQgd2l0aCBhbXAganMgcGFyYW1ldGVyIHBhdHRlcm4gYW5kIHJldHVybnMgdGhlXG4gKiBuZXcgc2VhcmNoIHN0cmluZy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxTZWFyY2hcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gcmVtb3ZlQW1wSnNQYXJhbXNGcm9tU2VhcmNoKHVybFNlYXJjaCkge1xuICBpZiAoIXVybFNlYXJjaCB8fCB1cmxTZWFyY2ggPT0gJz8nKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG4gIGNvbnN0IHNlYXJjaCA9IHVybFNlYXJjaFxuICAgICAgLnJlcGxhY2UoQU1QX0pTX1BBUkFNU19SRUdFWCwgJycpXG4gICAgICAucmVwbGFjZShBTVBfR1NBX1BBUkFNU19SRUdFWCwgJycpXG4gICAgICAucmVwbGFjZShBTVBfUl9QQVJBTVNfUkVHRVgsICcnKVxuICAgICAgLnJlcGxhY2UoR09PR0xFX0VYUEVSSU1FTlRfUEFSQU1TX1JFR0VYLCAnJylcbiAgICAgIC5yZXBsYWNlKC9eWz8mXS8sICcnKTsgLy8gUmVtb3ZlcyBmaXJzdCA/IG9yICYuXG4gIHJldHVybiBzZWFyY2ggPyAnPycgKyBzZWFyY2ggOiAnJztcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBzb3VyY2UgVVJMIG9mIGFuIEFNUCBkb2N1bWVudCBmb3IgZG9jdW1lbnRzIHNlcnZlZFxuICogb24gYSBwcm94eSBvcmlnaW4gb3IgZGlyZWN0bHkuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybCBVUkwgb2YgYW4gQU1QIGRvY3VtZW50LlxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U291cmNlVXJsKHVybCkge1xuICBpZiAodHlwZW9mIHVybCA9PSAnc3RyaW5nJykge1xuICAgIHVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICB9XG5cbiAgLy8gTm90IGEgcHJveHkgVVJMIC0gcmV0dXJuIHRoZSBVUkwgaXRzZWxmLlxuICBpZiAoIWlzUHJveHlPcmlnaW4odXJsKSkge1xuICAgIHJldHVybiB1cmwuaHJlZjtcbiAgfVxuXG4gIC8vIEEgcHJveHkgVVJMLlxuICAvLyBFeGFtcGxlIHBhdGggdGhhdCBpcyBiZWluZyBtYXRjaGVkIGhlcmUuXG4gIC8vIGh0dHBzOi8vY2RuLmFtcHByb2plY3Qub3JnL2Mvcy93d3cub3JpZ2luLmNvbS9mb28vXG4gIC8vIFRoZSAvcy8gaXMgb3B0aW9uYWwgYW5kIHNpZ25hbHMgYSBzZWN1cmUgb3JpZ2luLlxuICBjb25zdCBwYXRoID0gdXJsLnBhdGhuYW1lLnNwbGl0KCcvJyk7XG4gIGNvbnN0IHByZWZpeCA9IHBhdGhbMV07XG4gIHVzZXIoKS5hc3NlcnQoU0VSVklOR19UWVBFX1BSRUZJWFtwcmVmaXhdLFxuICAgICAgJ1Vua25vd24gcGF0aCBwcmVmaXggaW4gdXJsICVzJywgdXJsLmhyZWYpO1xuICBjb25zdCBkb21haW5Pckh0dHBzU2lnbmFsID0gcGF0aFsyXTtcbiAgY29uc3Qgb3JpZ2luID0gZG9tYWluT3JIdHRwc1NpZ25hbCA9PSAncydcbiAgICA/ICdodHRwczovLycgKyBkZWNvZGVVUklDb21wb25lbnQocGF0aFszXSlcbiAgICA6ICdodHRwOi8vJyArIGRlY29kZVVSSUNvbXBvbmVudChkb21haW5Pckh0dHBzU2lnbmFsKTtcbiAgLy8gU2FuaXR5IHRlc3QgdGhhdCB3aGF0IHdlIGZvdW5kIGxvb2tzIGxpa2UgYSBkb21haW4uXG4gIHVzZXIoKS5hc3NlcnQob3JpZ2luLmluZGV4T2YoJy4nKSA+IDAsICdFeHBlY3RlZCBhIC4gaW4gb3JpZ2luICVzJywgb3JpZ2luKTtcbiAgcGF0aC5zcGxpY2UoMSwgZG9tYWluT3JIdHRwc1NpZ25hbCA9PSAncycgPyAzIDogMik7XG4gIHJldHVybiBvcmlnaW4gKyBwYXRoLmpvaW4oJy8nKSArXG4gICAgICByZW1vdmVBbXBKc1BhcmFtc0Zyb21TZWFyY2godXJsLnNlYXJjaCkgKyAodXJsLmhhc2ggfHwgJycpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHNvdXJjZSBvcmlnaW4gb2YgYW4gQU1QIGRvY3VtZW50IGZvciBkb2N1bWVudHMgc2VydmVkXG4gKiBvbiBhIHByb3h5IG9yaWdpbiBvciBkaXJlY3RseS5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsIFVSTCBvZiBhbiBBTVAgZG9jdW1lbnQuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBzb3VyY2Ugb3JpZ2luIG9mIHRoZSBVUkwuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTb3VyY2VPcmlnaW4odXJsKSB7XG4gIHJldHVybiBwYXJzZVVybERlcHJlY2F0ZWQoZ2V0U291cmNlVXJsKHVybCkpLm9yaWdpbjtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFic29sdXRlIFVSTCByZXNvbHZlZCBiYXNlZCBvbiB0aGUgcmVsYXRpdmUgVVJMIGFuZCB0aGUgYmFzZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSByZWxhdGl2ZVVybFN0cmluZ1xuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSBiYXNlVXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNvbHZlUmVsYXRpdmVVcmwocmVsYXRpdmVVcmxTdHJpbmcsIGJhc2VVcmwpIHtcbiAgaWYgKHR5cGVvZiBiYXNlVXJsID09ICdzdHJpbmcnKSB7XG4gICAgYmFzZVVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZChiYXNlVXJsKTtcbiAgfVxuICBpZiAodHlwZW9mIFVSTCA9PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIG5ldyBVUkwocmVsYXRpdmVVcmxTdHJpbmcsIGJhc2VVcmwuaHJlZikudG9TdHJpbmcoKTtcbiAgfVxuICByZXR1cm4gcmVzb2x2ZVJlbGF0aXZlVXJsRmFsbGJhY2tfKHJlbGF0aXZlVXJsU3RyaW5nLCBiYXNlVXJsKTtcbn1cblxuLyoqXG4gKiBGYWxsYmFjayBmb3IgVVJMIHJlc29sdmVyIHdoZW4gVVJMIGNsYXNzIGlzIG5vdCBhdmFpbGFibGUuXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVsYXRpdmVVcmxTdHJpbmdcbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gYmFzZVVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICogQHByaXZhdGUgVmlzaWJsZSBmb3IgdGVzdGluZy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVSZWxhdGl2ZVVybEZhbGxiYWNrXyhyZWxhdGl2ZVVybFN0cmluZywgYmFzZVVybCkge1xuICBpZiAodHlwZW9mIGJhc2VVcmwgPT0gJ3N0cmluZycpIHtcbiAgICBiYXNlVXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKGJhc2VVcmwpO1xuICB9XG4gIHJlbGF0aXZlVXJsU3RyaW5nID0gcmVsYXRpdmVVcmxTdHJpbmcucmVwbGFjZSgvXFxcXC9nLCAnLycpO1xuICBjb25zdCByZWxhdGl2ZVVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZChyZWxhdGl2ZVVybFN0cmluZyk7XG5cbiAgLy8gQWJzb2x1dGUgVVJMLlxuICBpZiAoc3RhcnRzV2l0aChyZWxhdGl2ZVVybFN0cmluZy50b0xvd2VyQ2FzZSgpLCByZWxhdGl2ZVVybC5wcm90b2NvbCkpIHtcbiAgICByZXR1cm4gcmVsYXRpdmVVcmwuaHJlZjtcbiAgfVxuXG4gIC8vIFByb3RvY29sLXJlbGF0aXZlIFVSTC5cbiAgaWYgKHN0YXJ0c1dpdGgocmVsYXRpdmVVcmxTdHJpbmcsICcvLycpKSB7XG4gICAgcmV0dXJuIGJhc2VVcmwucHJvdG9jb2wgKyByZWxhdGl2ZVVybFN0cmluZztcbiAgfVxuXG4gIC8vIEFic29sdXRlIHBhdGguXG4gIGlmIChzdGFydHNXaXRoKHJlbGF0aXZlVXJsU3RyaW5nLCAnLycpKSB7XG4gICAgcmV0dXJuIGJhc2VVcmwub3JpZ2luICsgcmVsYXRpdmVVcmxTdHJpbmc7XG4gIH1cblxuICAvLyBSZWxhdGl2ZSBwYXRoLlxuICByZXR1cm4gYmFzZVVybC5vcmlnaW4gKyBiYXNlVXJsLnBhdGhuYW1lLnJlcGxhY2UoL1xcL1teL10qJC8sICcvJylcbiAgICAgICsgcmVsYXRpdmVVcmxTdHJpbmc7XG59XG5cblxuLyoqXG4gKiBBZGQgXCJfX2FtcF9zb3VyY2Vfb3JpZ2luXCIgcXVlcnkgcGFyYW1ldGVyIHRvIHRoZSBVUkwuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29yc1VybCh3aW4sIHVybCkge1xuICBjaGVja0NvcnNVcmwodXJsKTtcbiAgY29uc3Qgc291cmNlT3JpZ2luID0gZ2V0U291cmNlT3JpZ2luKHdpbi5sb2NhdGlvbi5ocmVmKTtcbiAgcmV0dXJuIGFkZFBhcmFtVG9VcmwodXJsLCBTT1VSQ0VfT1JJR0lOX1BBUkFNLCBzb3VyY2VPcmlnaW4pO1xufVxuXG5cbi8qKlxuICogQ2hlY2tzIGlmIHRoZSB1cmwgaGFzIF9fYW1wX3NvdXJjZV9vcmlnaW4gYW5kIHRocm93cyBpZiBpdCBkb2VzLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tDb3JzVXJsKHVybCkge1xuICBjb25zdCBwYXJzZWRVcmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgY29uc3QgcXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKHBhcnNlZFVybC5zZWFyY2gpO1xuICB1c2VyKCkuYXNzZXJ0KCEoU09VUkNFX09SSUdJTl9QQVJBTSBpbiBxdWVyeSksXG4gICAgICAnU291cmNlIG9yaWdpbiBpcyBub3QgYWxsb3dlZCBpbiAlcycsIHVybCk7XG59XG5cbi8qKlxuICogVHJpZXMgdG8gZGVjb2RlIGEgVVJJIGNvbXBvbmVudCwgZmFsbGluZyBiYWNrIHRvIG9wdF9mYWxsYmFjayAob3IgYW4gZW1wdHlcbiAqIHN0cmluZylcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gY29tcG9uZW50XG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF9mYWxsYmFja1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ5RGVjb2RlVXJpQ29tcG9uZW50KGNvbXBvbmVudCwgb3B0X2ZhbGxiYWNrKSB7XG4gIHJldHVybiB0cnlEZWNvZGVVcmlDb21wb25lbnRfKGNvbXBvbmVudCwgb3B0X2ZhbGxiYWNrKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogQ29tcGFyZXMgaWYgdHdvIGFycmF5cyBjb250YWlucyBleGFjdGx5IHNhbWUgZWxlbWVudHMgb2Ygc2FtZSBudW1iZXJcbiAqIG9mIHNhbWUgb3JkZXIuXG4gKiBOb3RpY2UgdGhhdCBpdCBkb2VzIE5PVCBoYW5kbGUgTmFOIGNhc2UgYXMgZXhwZWN0ZWRcbiAqXG4gKiBAcGFyYW0geyFBcnJheTxUPn0gYXJyMVxuICogQHBhcmFtIHshQXJyYXk8VD59IGFycjJcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXJlRXF1YWxPcmRlcmVkKGFycjEsIGFycjIpIHtcbiAgaWYgKGFycjEubGVuZ3RoICE9PSBhcnIyLmxlbmd0aCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyMS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChhcnIxW2ldICE9PSBhcnIyW2ldKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59XG5cbi8qKlxuICogQSBiaXQgbGlrZSBBcnJheSNmaWx0ZXIsIGJ1dCByZW1vdmVzIGVsZW1lbnRzIHRoYXQgZmlsdGVyIGZhbHNlIGZyb20gdGhlXG4gKiBhcnJheS4gUmV0dXJucyB0aGUgZmlsdGVyZWQgaXRlbXMuXG4gKlxuICogQHBhcmFtIHshQXJyYXk8VD59IGFycmF5XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKFQsIG51bWJlciwgIUFycmF5PFQ+KTpib29sZWFufSBmaWx0ZXJcbiAqIEByZXR1cm4geyFBcnJheTxUPn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJTcGxpY2UoYXJyYXksIGZpbHRlcikge1xuICBjb25zdCBzcGxpY2UgPSBbXTtcbiAgbGV0IGluZGV4ID0gMDtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGl0ZW0gPSBhcnJheVtpXTtcbiAgICBpZiAoZmlsdGVyKGl0ZW0sIGksIGFycmF5KSkge1xuICAgICAgaWYgKGluZGV4IDwgaSkge1xuICAgICAgICBhcnJheVtpbmRleF0gPSBpdGVtO1xuICAgICAgfVxuICAgICAgaW5kZXgrKztcbiAgICB9IGVsc2Uge1xuICAgICAgc3BsaWNlLnB1c2goaXRlbSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKGluZGV4IDwgYXJyYXkubGVuZ3RoKSB7XG4gICAgYXJyYXkubGVuZ3RoID0gaW5kZXg7XG4gIH1cblxuICByZXR1cm4gc3BsaWNlO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBmaXJzdCBlbGVtZW50IG1hdGNoaW5nIHRoZSBwcmVkaWNhdGUuXG4gKiBMaWtlIEFycmF5I2ZpbmRJbmRleC5cbiAqXG4gKiBAcGFyYW0geyFBcnJheTxUPn0gYXJyYXlcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oVCwgbnVtYmVyLCAhQXJyYXk8VD4pOmJvb2xlYW59IHByZWRpY2F0ZVxuICogQHJldHVybiB7bnVtYmVyfVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRJbmRleChhcnJheSwgcHJlZGljYXRlKSB7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAocHJlZGljYXRlKGFycmF5W2ldLCBpLCBhcnJheSkpIHtcbiAgICAgIHJldHVybiBpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gLTE7XG59XG5cbi8qKlxuICogQ29udmVydHMgdGhlIGdpdmVuIGl0ZXJhdG9yIHRvIGFuIGFycmF5LlxuICpcbiAqIEBwYXJhbSB7IUl0ZXJhdG9yPFQ+fSBpdGVyYXRvclxuICogQHJldHVybiB7QXJyYXk8VD59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gZnJvbUl0ZXJhdG9yKGl0ZXJhdG9yKSB7XG4gIGNvbnN0IGFycmF5ID0gW107XG4gIGZvciAobGV0IGUgPSBpdGVyYXRvci5uZXh0KCk7ICFlLmRvbmU7IGUgPSBpdGVyYXRvci5uZXh0KCkpIHtcbiAgICBhcnJheS5wdXNoKGUudmFsdWUpO1xuICB9XG4gIHJldHVybiBhcnJheTtcbn1cblxuLyoqXG4gKiBBZGRzIGl0ZW0gdG8gYXJyYXkgaWYgaXQgaXMgbm90IGFscmVhZHkgcHJlc2VudC5cbiAqXG4gKiBAcGFyYW0ge0FycmF5PFQ+fSBhcnJheVxuICogQHBhcmFtIHtUfSBpdGVtXG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gcHVzaElmTm90RXhpc3QoYXJyYXksIGl0ZW0pIHtcbiAgaWYgKGFycmF5LmluZGV4T2YoaXRlbSkgPCAwKSB7XG4gICAgYXJyYXkucHVzaChpdGVtKTtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7Ynl0ZXNUb1N0cmluZywgc3RyaW5nVG9CeXRlcywgdXRmOEVuY29kZX0gZnJvbSAnLi9ieXRlcyc7XG5cbi8qKlxuICogQ2hhcmFjdGVyIG1hcHBpbmcgZnJvbSBiYXNlNjR1cmwgdG8gYmFzZTY0LlxuICogQGNvbnN0IHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn1cbiAqL1xuY29uc3QgYmFzZTY0VXJsRGVjb2RlU3VicyA9IHsnLSc6ICcrJywgJ18nOiAnLycsICcuJzogJz0nfTtcblxuLyoqXG4gKiBDaGFyYWN0ZXIgbWFwcGluZyBmcm9tIGJhc2U2NCB0byBiYXNlNjR1cmwuXG4gKiBAY29uc3QgeyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fVxuICovXG5jb25zdCBiYXNlNjRVcmxFbmNvZGVTdWJzID0geycrJzogJy0nLCAnLyc6ICdfJywgJz0nOiAnLid9O1xuXG4vKipcbiAqIENvbnZlcnRzIGEgc3RyaW5nIHdoaWNoIGlzIGluIGJhc2U2NHVybCBlbmNvZGluZyBpbnRvIGEgVWludDhBcnJheVxuICogY29udGFpbmluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcbiAqIEByZXR1cm4geyFVaW50OEFycmF5fVxuICovXG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0VXJsRGVjb2RlVG9CeXRlcyhzdHIpIHtcbiAgY29uc3QgZW5jb2RlZCA9IGF0b2Ioc3RyLnJlcGxhY2UoL1stXy5dL2csIGNoID0+IGJhc2U2NFVybERlY29kZVN1YnNbY2hdKSk7XG4gIHJldHVybiBzdHJpbmdUb0J5dGVzKGVuY29kZWQpO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgc3RyaW5nIHdoaWNoIGlzIGluIGJhc2U2NCBlbmNvZGluZyBpbnRvIGEgVWludDhBcnJheVxuICogY29udGFpbmluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcbiAqIEByZXR1cm4geyFVaW50OEFycmF5fVxuICovXG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0RGVjb2RlVG9CeXRlcyhzdHIpIHtcbiAgcmV0dXJuIHN0cmluZ1RvQnl0ZXMoYXRvYihzdHIpKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIGJ5dGVzIGFycmF5IGludG8gYmFzZTY0dXJsIGVuY29kZWQgc3RyaW5nLlxuICogYmFzZTY0dXJsIGlzIGRlZmluZWQgaW4gUkZDIDQ2NDguIEl0IGlzIHNvbWV0aW1lcyByZWZlcnJlZCB0byBhcyBcIndlYiBzYWZlXCIuXG4gKiBAcGFyYW0geyFVaW50OEFycmF5fSBieXRlc1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0VXJsRW5jb2RlRnJvbUJ5dGVzKGJ5dGVzKSB7XG4gIGNvbnN0IHN0ciA9IGJ5dGVzVG9TdHJpbmcoYnl0ZXMpO1xuICByZXR1cm4gYnRvYShzdHIpLnJlcGxhY2UoL1srLz1dL2csIGNoID0+IGJhc2U2NFVybEVuY29kZVN1YnNbY2hdKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIHN0cmluZyBpbnRvIGJhc2U2NHVybCBlbmNvZGVkIHN0cmluZy5cbiAqIGJhc2U2NHVybCBpcyBkZWZpbmVkIGluIFJGQyA0NjQ4LiBJdCBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgXCJ3ZWIgc2FmZVwiLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0VXJsRW5jb2RlRnJvbVN0cmluZyhzdHIpIHtcbiAgY29uc3QgYnl0ZXMgPSB1dGY4RW5jb2RlKHN0cik7XG4gIHJldHVybiBiYXNlNjRVcmxFbmNvZGVGcm9tQnl0ZXMoYnl0ZXMpO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgYnl0ZXMgYXJyYXkgaW50byBiYXNlNjQgZW5jb2RlZCBzdHJpbmcuXG4gKiBAcGFyYW0geyFVaW50OEFycmF5fSBieXRlc1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0RW5jb2RlRnJvbUJ5dGVzKGJ5dGVzKSB7XG4gIHJldHVybiBidG9hKGJ5dGVzVG9TdHJpbmcoYnl0ZXMpKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2Rldn0gZnJvbSAnLi4vbG9nJztcblxuLyoqXG4gKiBJbnRlcnByZXQgYSBieXRlIGFycmF5IGFzIGEgVVRGLTggc3RyaW5nLlxuICogQHBhcmFtIHshQnVmZmVyU291cmNlfSBieXRlc1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdXRmOERlY29kZShieXRlcykge1xuICBpZiAodHlwZW9mIFRleHREZWNvZGVyICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoJ3V0Zi04JykuZGVjb2RlKGJ5dGVzKTtcbiAgfVxuICBjb25zdCBhc2NpaVN0cmluZyA9IGJ5dGVzVG9TdHJpbmcobmV3IFVpbnQ4QXJyYXkoYnl0ZXMuYnVmZmVyIHx8IGJ5dGVzKSk7XG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGFzY2lpU3RyaW5nKSk7XG59XG5cbi8qKlxuICogVHVybiBhIHN0cmluZyBpbnRvIFVURi04IGJ5dGVzLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZ1xuICogQHJldHVybiB7IVVpbnQ4QXJyYXl9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1dGY4RW5jb2RlKHN0cmluZykge1xuICBpZiAodHlwZW9mIFRleHRFbmNvZGVyICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBuZXcgVGV4dEVuY29kZXIoJ3V0Zi04JykuZW5jb2RlKHN0cmluZyk7XG4gIH1cbiAgcmV0dXJuIHN0cmluZ1RvQnl0ZXModW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZykpKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIHN0cmluZyB3aGljaCBob2xkcyA4LWJpdCBjb2RlIHBvaW50cywgc3VjaCBhcyB0aGUgcmVzdWx0IG9mIGF0b2IsXG4gKiBpbnRvIGEgVWludDhBcnJheSB3aXRoIHRoZSBjb3JyZXNwb25kaW5nIGJ5dGVzLlxuICogSWYgeW91IGhhdmUgYSBzdHJpbmcgb2YgY2hhcmFjdGVycywgeW91IHByb2JhYmx5IHdhbnQgdG8gYmUgdXNpbmcgdXRmOEVuY29kZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcbiAqIEByZXR1cm4geyFVaW50OEFycmF5fVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RyaW5nVG9CeXRlcyhzdHIpIHtcbiAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheShzdHIubGVuZ3RoKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBjaGFyQ29kZSA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgIGRldigpLmFzc2VydChjaGFyQ29kZSA8PSAyNTUsICdDaGFyYWN0ZXJzIG11c3QgYmUgaW4gcmFuZ2UgWzAsMjU1XScpO1xuICAgIGJ5dGVzW2ldID0gY2hhckNvZGU7XG4gIH1cbiAgcmV0dXJuIGJ5dGVzO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgOC1iaXQgYnl0ZXMgYXJyYXkgaW50byBhIHN0cmluZ1xuICogQHBhcmFtIHshVWludDhBcnJheX0gYnl0ZXNcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJ5dGVzVG9TdHJpbmcoYnl0ZXMpIHtcbiAgLy8gSW50ZW50aW9uYWxseSBhdm9pZHMgU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseSBzbyB3ZSBkb24ndCBzdWZmZXIgYVxuICAvLyBzdGFjayBvdmVyZmxvdy4gIzEwNDk1LCBodHRwczovL2pzcGVyZi5jb20vYnl0ZXNUb1N0cmluZy0yXG4gIGNvbnN0IGFycmF5ID0gbmV3IEFycmF5KGJ5dGVzLmxlbmd0aCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICBhcnJheVtpXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0pO1xuICB9XG4gIHJldHVybiBhcnJheS5qb2luKCcnKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIDQtaXRlbSBieXRlIGFycmF5IHRvIGFuIHVuc2lnbmVkIGludGVnZXIuXG4gKiBBc3N1bWVzIGJ5dGVzIGFyZSBiaWcgZW5kaWFuLlxuICogQHBhcmFtIHshVWludDhBcnJheX0gYnl0ZXNcbiAqIEByZXR1cm4ge251bWJlcn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJ5dGVzVG9VSW50MzIoYnl0ZXMpIHtcbiAgaWYgKGJ5dGVzLmxlbmd0aCAhPSA0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdSZWNlaXZlZCBieXRlIGFycmF5IHdpdGggbGVuZ3RoICE9IDQnKTtcbiAgfVxuICBjb25zdCB2YWwgPSAoYnl0ZXNbMF0gJiAweEZGKSA8PCAyNCB8XG4gICAgIChieXRlc1sxXSAmIDB4RkYpIDw8IDE2IHxcbiAgICAgKGJ5dGVzWzJdICYgMHhGRikgPDwgOCB8XG4gICAgIChieXRlc1szXSAmIDB4RkYpO1xuICAvLyBDb252ZXJ0IHRvIHVuc2lnbmVkLlxuICByZXR1cm4gdmFsID4+PiAwO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIGEgcmFuZG9tIGJ5dGVzIGFycmF5IHdpdGggc3BlY2lmaWMgbGVuZ3RoIHVzaW5nXG4gKiB3aW4uY3J5cHRvLmdldFJhbmRvbVZhbHVlcy4gUmV0dXJuIG51bGwgaWYgaXQgaXMgbm90IGF2YWlsYWJsZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge251bWJlcn0gbGVuZ3RoXG4gKiBAcmV0dXJuIHs/VWludDhBcnJheX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENyeXB0b1JhbmRvbUJ5dGVzQXJyYXkod2luLCBsZW5ndGgpIHtcbiAgaWYgKCF3aW4uY3J5cHRvIHx8ICF3aW4uY3J5cHRvLmdldFJhbmRvbVZhbHVlcykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLy8gV2lkZWx5IGF2YWlsYWJsZSBpbiBicm93c2VycyB3ZSBzdXBwb3J0OlxuICAvLyBodHRwOi8vY2FuaXVzZS5jb20vI3NlYXJjaD1nZXRSYW5kb21WYWx1ZXNcbiAgY29uc3QgdWludDhhcnJheSA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7XG4gIHdpbi5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKHVpbnQ4YXJyYXkpO1xuICByZXR1cm4gdWludDhhcnJheTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge3N0cmluZ0hhc2gzMn0gZnJvbSAnLi4vc3RyaW5nJztcblxuXG4vKipcbiAqIEdldHMgYSBzdHJpbmcgb2YgY29uY2F0ZW5hdGVkIGVsZW1lbnQgbmFtZXMgYW5kIHJlbGF0aXZlIHBvc2l0aW9uc1xuICogb2YgdGhlIERPTSBlbGVtZW50IGFuZCBpdHMgcGFyZW50RWxlbWVudCdzICh1cCB0byAyNSkuICBSZWxhdGl2ZSBwb3NpdGlvblxuICogaXMgdGhlIGluZGV4IG9mIG5vZGVzIHdpdGggdGhpcyB0YWcgd2l0aGluIHRoZSBwYXJlbnQncyBjaGlsZHJlbi5cbiAqIFRoZSBvcmRlciBpcyBmcm9tIHRoZSBpbm5lciB0byBvdXRlciBub2RlcyBpbiBET00gaGllcmFyY2h5LlxuICpcbiAqIElmIGEgRE9NIGhpZXJhcmNoeSBpcyB0aGUgZm9sbG93aW5nOlxuICpcbiAqIDxkaXYgaWQ9J2lkMScgLi4uPlxuICogICA8ZGl2IGlkPSdpZDInIC4uLj5cbiAqICAgICA8dGFibGUgLi4uPiAgICAgICAvLyB0YWJsZTowXG4gKiAgICAgICA8dHI+ICAgICAgICAgICAgLy8gdHI6MFxuICogICAgICAgICA8dGQ+Li4uPC90ZD4gIC8vIHRkOjBcbiAqICAgICAgICAgPHRkPiAgICAgICAgICAvLyB0ZDoxXG4gKiAgICAgICAgICAgPGFtcC1hZCAuLi4+PC9hbXAtYWQ+XG4gKiAgICAgICAgIDwvdGQ+XG4gKiAgICAgICA8L3RyPlxuICogICAgICAgPHRyPi4uLjwvdHI+ICAgIC8vIHRyOjFcbiAqICAgICA8L3RhYmxlPlxuICogICA8L2Rpdj5cbiAqIDwvZGl2PlxuICpcbiAqIFdpdGggdGhlIGFtcC1hZCBlbGVtZW50IHBhc3NlZCBpbjpcbiAqICdhbXAtYWQuMCx0ZC4xLHRyLjAsdGFibGUuMCxkaXYvaWQyLjAsZGl2L2lkMS4wJ1xuICpcbiAqIE5vdGU6IDI1IGlzIGNob3NlbiBhcmJpdHJhcmlseS5cbiAqXG4gKiBAcGFyYW0gez9FbGVtZW50fSBlbGVtZW50IERPTSBub2RlIGZyb20gd2hpY2ggdG8gZ2V0IGZpbmdlcnByaW50LlxuICogQHJldHVybiB7c3RyaW5nfSBDb25jYXRlbmF0ZWQgZWxlbWVudCBpZHMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkb21GaW5nZXJwcmludFBsYWluKGVsZW1lbnQpIHtcbiAgY29uc3QgaWRzID0gW107XG4gIGxldCBsZXZlbCA9IDA7XG4gIHdoaWxlIChlbGVtZW50ICYmIGVsZW1lbnQubm9kZVR5cGUgPT0gLyogZWxlbWVudCAqLyAxICYmIGxldmVsIDwgMjUpIHtcbiAgICBsZXQgaWQgPSAnJztcbiAgICBpZiAoZWxlbWVudC5pZCkge1xuICAgICAgaWQgPSBgLyR7ZWxlbWVudC5pZH1gO1xuICAgIH1cbiAgICBjb25zdCBub2RlTmFtZSA9IGVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICBpZHMucHVzaChgJHtub2RlTmFtZX0ke2lkfSR7aW5kZXhXaXRoaW5QYXJlbnQoZWxlbWVudCl9YCk7XG4gICAgbGV2ZWwrKztcbiAgICBlbGVtZW50ID0gZWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICB9XG4gIHJldHVybiBpZHMuam9pbigpO1xufVxuXG5cbmV4cG9ydCBjbGFzcyBEb21GaW5nZXJwcmludCB7XG4gIC8qKlxuICAgKiBDYWxjdWxhdGVzIGFkIHNsb3QgRE9NIGZpbmdlcnByaW50LiAgVGhpcyBrZXkgaXMgaW50ZW5kZWQgdG9cbiAgICogaWRlbnRpZnkgXCJzYW1lXCIgYWQgdW5pdCBhY3Jvc3MgbWFueSBwYWdlIHZpZXdzLiBUaGlzIGlzXG4gICAqIGJhc2VkIG9uIHdoZXJlIHRoZSBhZCBhcHBlYXJzIHdpdGhpbiB0aGUgcGFnZSdzIERPTSBzdHJ1Y3R1cmUuXG4gICAqXG4gICAqIEBwYXJhbSB7P0VsZW1lbnR9IGVsZW1lbnQgVGhlIERPTSBlbGVtZW50IGZyb20gd2hpY2ggdG8gY29sbGVjdFxuICAgKiAgICAgdGhlIERPTSBjaGFpbiBlbGVtZW50IElEcy4gIElmIG51bGwsIERPTSBjaGFpbiBlbGVtZW50IElEcyBhcmUgbm90XG4gICAqICAgICBpbmNsdWRlZCBpbiB0aGUgaGFzaC5cbiAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgYWQgdW5pdCBoYXNoIGtleSBzdHJpbmcuXG4gICAqL1xuICBzdGF0aWMgZ2VuZXJhdGUoZWxlbWVudCkge1xuICAgIHJldHVybiBzdHJpbmdIYXNoMzIoZG9tRmluZ2VycHJpbnRQbGFpbihlbGVtZW50KSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIEdldHMgYSBzdHJpbmcgc2hvd2luZyB0aGUgaW5kZXggb2YgYW4gZWxlbWVudCB3aXRoaW5cbiAqIHRoZSBjaGlsZHJlbiBvZiBpdHMgcGFyZW50LCBjb3VudGluZyBvbmx5IG5vZGVzIHdpdGggdGhlIHNhbWUgdGFnLlxuICogU3RvcCBhdCAyNSwganVzdCB0byBoYXZlIGEgbGltaXQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50IERPTSBub2RlIHRvIGdldCBpbmRleCBvZi5cbiAqIEByZXR1cm4ge3N0cmluZ30gJy48aW5kZXg+JyBvciAnJy5cbiAqL1xuZnVuY3Rpb24gaW5kZXhXaXRoaW5QYXJlbnQoZWxlbWVudCkge1xuICBjb25zdCB7bm9kZU5hbWV9ID0gZWxlbWVudDtcbiAgLy8gRmluZCBteSBpbmRleCB3aXRoaW4gbXkgcGFyZW50J3MgY2hpbGRyZW5cbiAgbGV0IGkgPSAwO1xuICBsZXQgY291bnQgPSAwO1xuICBsZXQgc2libGluZyA9IGVsZW1lbnQucHJldmlvdXNFbGVtZW50U2libGluZztcbiAgLy8gRGlmZmVyZW50IGJyb3dzZXJzIGhhdmUgZGlmZmVyZW50IGNoaWxkcmVuLlxuICAvLyBTbyBjb3VudCBvbmx5IG5vZGVzIHdpdGggdGhlIHNhbWUgdGFnLlxuICAvLyBVc2UgYSBsaW1pdCBmb3IgdGhlIHRhZ3MsIHNvIHRoYXQgZGlmZmVyZW50IGJyb3dzZXJzIGdldCB0aGUgc2FtZVxuICAvLyBjb3VudC4gU28gMjUgYW5kIGhpZ2hlciBhbGwgcmV0dXJuIG5vIGluZGV4LlxuICB3aGlsZSAoc2libGluZyAmJiBjb3VudCA8IDI1ICYmIGkgPCAxMDApIHtcbiAgICBpZiAoc2libGluZy5ub2RlTmFtZSA9PSBub2RlTmFtZSkge1xuICAgICAgY291bnQrKztcbiAgICB9XG4gICAgaSsrO1xuICAgIHNpYmxpbmcgPSBzaWJsaW5nLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG4gIH1cbiAgLy8gSWYgd2UgZ290IHRvIHRoZSBlbmQsIHRoZW4gdGhlIGNvdW50IGlzIGFjY3VyYXRlOyBvdGhlcndpc2Ugc2tpcCBjb3VudC5cbiAgcmV0dXJuIGNvdW50IDwgMjUgJiYgaSA8IDEwMCA/IGAuJHtjb3VudH1gIDogJyc7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtkZXZ9IGZyb20gJy4uL2xvZyc7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmNvbnN0IFRBRyA9ICdscnUtY2FjaGUnO1xuXG4vKipcbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBjbGFzcyBMcnVDYWNoZSB7XG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gY2FwYWNpdHlcbiAgICovXG4gIGNvbnN0cnVjdG9yKGNhcGFjaXR5KSB7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7bnVtYmVyfSAqL1xuICAgIHRoaXMuY2FwYWNpdHlfID0gY2FwYWNpdHk7XG5cbiAgICAvKiogQHByaXZhdGUge251bWJlcn0gKi9cbiAgICB0aGlzLnNpemVfID0gMDtcblxuICAgIC8qKlxuICAgICAqIEFuIGluY3JlbWVudGluZyBjb3VudGVyIHRvIGRlZmluZSB0aGUgbGFzdCBhY2Nlc3MuXG4gICAgICogQHByaXZhdGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLmFjY2Vzc18gPSAwO1xuXG4gICAgLyoqIEBwcml2YXRlIHshT2JqZWN0PChudW1iZXJ8c3RyaW5nKSwge3BheWxvYWQ6IFQsIGFjY2VzczogbnVtYmVyfT59ICovXG4gICAgdGhpcy5jYWNoZV8gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgd2hldGhlciBrZXkgaXMgY2FjaGVkLlxuICAgKlxuICAgKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IGtleVxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgaGFzKGtleSkge1xuICAgIHJldHVybiAhIXRoaXMuY2FjaGVfW2tleV07XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSBrZXlcbiAgICogQHJldHVybiB7VH0gVGhlIGNhY2hlZCBwYXlsb2FkLlxuICAgKi9cbiAgZ2V0KGtleSkge1xuICAgIGNvbnN0IGNhY2hlYWJsZSA9IHRoaXMuY2FjaGVfW2tleV07XG4gICAgaWYgKGNhY2hlYWJsZSkge1xuICAgICAgY2FjaGVhYmxlLmFjY2VzcyA9ICsrdGhpcy5hY2Nlc3NfO1xuICAgICAgcmV0dXJuIGNhY2hlYWJsZS5wYXlsb2FkO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30ga2V5XG4gICAqIEBwYXJhbSB7VH0gcGF5bG9hZCBUaGUgcGF5bG9hZCB0byBjYWNoZS5cbiAgICovXG4gIHB1dChrZXksIHBheWxvYWQpIHtcbiAgICBpZiAoIXRoaXMuaGFzKGtleSkpIHtcbiAgICAgIHRoaXMuc2l6ZV8rKztcbiAgICB9XG4gICAgdGhpcy5jYWNoZV9ba2V5XSA9IHtwYXlsb2FkLCBhY2Nlc3M6IHRoaXMuYWNjZXNzX307XG4gICAgdGhpcy5ldmljdF8oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFdmljdHMgdGhlIG9sZGVzdCBjYWNoZSBlbnRyeSwgaWYgd2UndmUgZXhjZWVkZWQgY2FwYWNpdHkuXG4gICAqL1xuICBldmljdF8oKSB7XG4gICAgaWYgKHRoaXMuc2l6ZV8gPD0gdGhpcy5jYXBhY2l0eV8pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBkZXYoKS53YXJuKFRBRywgJ1RyaW1taW5nIExSVSBjYWNoZScpO1xuICAgIGNvbnN0IGNhY2hlID0gdGhpcy5jYWNoZV87XG4gICAgbGV0IG9sZGVzdCA9IHRoaXMuYWNjZXNzXyArIDE7XG4gICAgbGV0IG9sZGVzdEtleTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBjYWNoZSkge1xuICAgICAgY29uc3Qge2FjY2Vzc30gPSBjYWNoZVtrZXldO1xuICAgICAgaWYgKGFjY2VzcyA8IG9sZGVzdCkge1xuICAgICAgICBvbGRlc3QgPSBhY2Nlc3M7XG4gICAgICAgIG9sZGVzdEtleSA9IGtleTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAob2xkZXN0S2V5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGRlbGV0ZSBjYWNoZVtvbGRlc3RLZXldO1xuICAgICAgdGhpcy5zaXplXy0tO1xuICAgIH1cbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7aXNPYmplY3R9IGZyb20gJy4uL3R5cGVzJztcblxuLyogQGNvbnN0ICovXG5jb25zdCBoYXNPd25fID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcblxuLyoqXG4gKiBSZXR1cm5zIGEgbWFwLWxpa2Ugb2JqZWN0LlxuICogSWYgb3B0X2luaXRpYWwgaXMgcHJvdmlkZWQsIGNvcGllcyBpdHMgb3duIHByb3BlcnRpZXMgaW50byB0aGVcbiAqIG5ld2x5IGNyZWF0ZWQgb2JqZWN0LlxuICogQHBhcmFtIHtUPX0gb3B0X2luaXRpYWwgVGhpcyBzaG91bGQgdHlwaWNhbGx5IGJlIGFuIG9iamVjdCBsaXRlcmFsLlxuICogQHJldHVybiB7VH1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXAob3B0X2luaXRpYWwpIHtcbiAgY29uc3Qgb2JqID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgaWYgKG9wdF9pbml0aWFsKSB7XG4gICAgT2JqZWN0LmFzc2lnbihvYmosIG9wdF9pbml0aWFsKTtcbiAgfVxuICByZXR1cm4gb2JqO1xufVxuXG4vKipcbiAqIFJldHVybiBhbiBlbXB0eSBKc29uT2JqZWN0IG9yIG1ha2VzIHRoZSBwYXNzZWQgaW4gb2JqZWN0IGxpdGVyYWxcbiAqIGFuIEpzb25PYmplY3QuXG4gKiBUaGUgSnNvbk9iamVjdCB0eXBlIGlzIGp1c3QgYSBzaW1wbGUgb2JqZWN0IHRoYXQgaXMgYXQtZGljdC5cbiAqIFNlZVxuICogaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9jbG9zdXJlLWNvbXBpbGVyL3dpa2kvQHN0cnVjdC1hbmQtQGRpY3QtQW5ub3RhdGlvbnNcbiAqIGZvciB3aGF0IGEgZGljdCBpcyB0eXBlLXdpc2UuXG4gKiBUaGUgbGludGVyIGVuZm9yY2VzIHRoYXQgdGhlIGFyZ3VtZW50IGlzLCBpbiBmYWN0LCBhdC1kaWN0IGxpa2UuXG4gKiBAcGFyYW0geyFPYmplY3Q9fSBvcHRfaW5pdGlhbFxuICogQHJldHVybiB7IUpzb25PYmplY3R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkaWN0KG9wdF9pbml0aWFsKSB7XG4gIC8vIFdlIGRvIG5vdCBjb3B5LiBUaGUgbGludGVyIGVuZm9yY2VzIHRoYXQgdGhlIHBhc3NlZCBpbiBvYmplY3QgaXMgYSBsaXRlcmFsXG4gIC8vIGFuZCB0aHVzIHRoZSBjYWxsZXIgY2Fubm90IGhhdmUgYSByZWZlcmVuY2UgdG8gaXQuXG4gIHJldHVybiAvKiogQHR5cGUgeyFKc29uT2JqZWN0fSAqLyAob3B0X2luaXRpYWwgfHwge30pO1xufVxuXG4vKipcbiAqIENoZWNrcyBpZiB0aGUgZ2l2ZW4ga2V5IGlzIGEgcHJvcGVydHkgaW4gdGhlIG1hcC5cbiAqXG4gKiBAcGFyYW0ge1R9ICBvYmogYSBtYXAgbGlrZSBwcm9wZXJ0eS5cbiAqIEBwYXJhbSB7c3RyaW5nfSAga2V5XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc093bihvYmosIGtleSkge1xuICByZXR1cm4gaGFzT3duXy5jYWxsKG9iaiwga2V5KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIG9ialtrZXldIGlmZiBrZXkgaXMgb2JqJ3Mgb3duIHByb3BlcnR5IChpcyBub3QgaW5oZXJpdGVkKS5cbiAqIE90aGVyd2lzZSwgcmV0dXJucyB1bmRlZmluZWQuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9ialxuICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICogQHJldHVybiB7Kn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG93blByb3BlcnR5KG9iaiwga2V5KSB7XG4gIGlmIChoYXNPd24ob2JqLCBrZXkpKSB7XG4gICAgcmV0dXJuIG9ialtrZXldO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn1cblxuLyoqXG4gKiBEZWVwIG1lcmdlcyBzb3VyY2UgaW50byB0YXJnZXQuXG4gKlxuICogQHBhcmFtIHshT2JqZWN0fSB0YXJnZXRcbiAqIEBwYXJhbSB7IU9iamVjdH0gc291cmNlXG4gKiBAcGFyYW0ge251bWJlcn0gZGVwdGggVGhlIG1heGltdW0gbWVyZ2UgZGVwdGguIElmIGV4Y2VlZGVkLCBPYmplY3QuYXNzaWduXG4gKiAgICAgICAgICAgICAgICAgICAgICAgd2lsbCBiZSB1c2VkIGluc3RlYWQuXG4gKiBAcmV0dXJuIHshT2JqZWN0fVxuICogQHRocm93cyB7RXJyb3J9IElmIHNvdXJjZSBjb250YWlucyBhIGNpcmN1bGFyIHJlZmVyZW5jZS5cbiAqIE5vdGU6IE9ubHkgbmVzdGVkIG9iamVjdHMgYXJlIGRlZXAtbWVyZ2VkLCBwcmltaXRpdmVzIGFuZCBhcnJheXMgYXJlIG5vdC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlZXBNZXJnZSh0YXJnZXQsIHNvdXJjZSwgZGVwdGggPSAxMCkge1xuICAvLyBLZWVwIHRyYWNrIG9mIHNlZW4gb2JqZWN0cyB0byBkZXRlY3QgcmVjdXJzaXZlIHJlZmVyZW5jZXMuXG4gIGNvbnN0IHNlZW4gPSBbXTtcblxuICAvKiogQHR5cGUgeyFBcnJheTx7dDogIU9iamVjdCwgczogIU9iamVjdCwgZDogbnVtYmVyfT59ICovXG4gIGNvbnN0IHF1ZXVlID0gW107XG4gIHF1ZXVlLnB1c2goe3Q6IHRhcmdldCwgczogc291cmNlLCBkOiAwfSk7XG5cbiAgLy8gQkZTIHRvIGVuc3VyZSBvYmplY3RzIGRvbid0IGhhdmUgcmVjdXJzaXZlIHJlZmVyZW5jZXMgYXQgc2hhbGxvd2VyIGRlcHRocy5cbiAgd2hpbGUgKHF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCB7dCwgcywgZH0gPSBxdWV1ZS5zaGlmdCgpO1xuICAgIGlmIChzZWVuLmluY2x1ZGVzKHMpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NvdXJjZSBvYmplY3QgaGFzIGEgY2lyY3VsYXIgcmVmZXJlbmNlLicpO1xuICAgIH1cbiAgICBzZWVuLnB1c2gocyk7XG4gICAgaWYgKHQgPT09IHMpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoZCA+IGRlcHRoKSB7XG4gICAgICBPYmplY3QuYXNzaWduKHQsIHMpO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIE9iamVjdC5rZXlzKHMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgIGNvbnN0IG5ld1ZhbHVlID0gc1trZXldO1xuICAgICAgLy8gUGVyZm9ybSBhIGRlZXAgbWVyZ2UgSUZGIGJvdGggdGFyZ2V0IGFuZCBzb3VyY2UgaGF2ZSB0aGUgc2FtZSBrZXlcbiAgICAgIC8vIHdob3NlIGNvcnJlc3BvbmRpbmcgdmFsdWVzIGFyZSBvYmplY3RzLlxuICAgICAgaWYgKGhhc093bih0LCBrZXkpKSB7XG4gICAgICAgIGNvbnN0IG9sZFZhbHVlID0gdFtrZXldO1xuICAgICAgICBpZiAoaXNPYmplY3QobmV3VmFsdWUpICYmIGlzT2JqZWN0KG9sZFZhbHVlKSkge1xuICAgICAgICAgIHF1ZXVlLnB1c2goe3Q6IG9sZFZhbHVlLCBzOiBuZXdWYWx1ZSwgZDogZCArIDF9KTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRba2V5XSA9IG5ld1ZhbHVlO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiB0YXJnZXQ7XG59XG5cbi8qKlxuICogQHBhcmFtIHshT2JqZWN0fSBvIEFuIG9iamVjdCB0byByZW1vdmUgcHJvcGVydGllcyBmcm9tXG4gKiBAcGFyYW0geyFBcnJheTxzdHJpbmc+fSBwcm9wcyBBIGxpc3Qgb2YgcHJvcGVydGllcyB0byByZW1vdmUgZnJvbSB0aGUgT2JqZWN0XG4gKiBAcmV0dXJuIHshT2JqZWN0fSBBbiBvYmplY3Qgd2l0aCB0aGUgZ2l2ZW4gcHJvcGVydGllcyByZW1vdmVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvbWl0KG8sIHByb3BzKSB7XG4gIHJldHVybiBPYmplY3Qua2V5cyhvKS5yZWR1Y2UoKGFjYywga2V5KSA9PiB7XG4gICAgaWYgKCFwcm9wcy5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICBhY2Nba2V5XSA9IG9ba2V5XTtcbiAgICB9XG4gICAgcmV0dXJuIGFjYztcbiAgfSwge30pO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogUmV0dXJucyBhIERlZmVycmVkIHN0cnVjdCwgd2hpY2ggaG9sZHMgYSBwZW5kaW5nIHByb21pc2UgYW5kIGl0cyBhc3NvY2lhdGVkXG4gKiByZXNvbHZlIGFuZCByZWplY3QgZnVuY3Rpb25zLlxuICpcbiAqIFRoaXMgaXMgcHJlZmVycmVkIGluc3RlYWQgb2YgY3JlYXRpbmcgYSBQcm9taXNlIGluc3RhbmNlIHRvIGV4dHJhY3QgdGhlXG4gKiByZXNvbHZlL3JlamVjdCBmdW5jdGlvbnMgeW91cnNlbGY6XG4gKlxuICogYGBgXG4gKiAvLyBBdm9pZCBkb2luZ1xuICogbGV0IHJlc29sdmU7XG4gKiBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2UocmVzID0+IHtcbiAqICAgcmVzb2x2ZSA9IHJlcztcbiAqIH0pO1xuICpcbiAqIC8vIEdvb2RcbiAqIGNvbnN0IGRlZmVycmVkID0gbmV3IERlZmVycmVkKCk7XG4gKiBjb25zdCB7IHByb21pc2UsIHJlc29sdmUgfSA9IGRlZmVycmVkO1xuICogYGBgXG4gKlxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGNsYXNzIERlZmVycmVkIHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgRGVmZXJyZWQuXG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBsZXQgcmVzb2x2ZSwgcmVqZWN0O1xuXG4gICAgLyoqXG4gICAgICogQGNvbnN0IHshUHJvbWlzZTxUPn1cbiAgICAgKi9cbiAgICB0aGlzLnByb21pc2UgPSBuZXcgLypPSyovUHJvbWlzZSgocmVzLCByZWopID0+IHtcbiAgICAgIHJlc29sdmUgPSByZXM7XG4gICAgICByZWplY3QgPSByZWo7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBAY29uc3Qge2Z1bmN0aW9uKFQ9KX1cbiAgICAgKi9cbiAgICB0aGlzLnJlc29sdmUgPSByZXNvbHZlO1xuXG4gICAgLyoqXG4gICAgICogQGNvbnN0IHtmdW5jdGlvbigqPSl9XG4gICAgICovXG4gICAgdGhpcy5yZWplY3QgPSByZWplY3Q7XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgcHJvbWlzZSByZXNvbHZlZCB0byB0aGUgcmV0dXJuIHZhbHVlIG9mIGZuLlxuICogSWYgZm4gc3luYyB0aHJvd3MsIGl0IHdpbGwgY2F1c2UgdGhlIHByb21pc2UgdG8gcmVqZWN0LlxuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKTpUfSBmblxuICogQHJldHVybiB7IVByb21pc2U8VD59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ5UmVzb2x2ZShmbikge1xuICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgcmVzb2x2ZShmbigpKTtcbiAgfSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2Ugd2hpY2ggcmVzb2x2ZXMgaWYgYSB0aHJlc2hvbGQgYW1vdW50IG9mIHRoZSBnaXZlbiBwcm9taXNlc1xuICogcmVzb2x2ZSwgYW5kIHJlamVjdHMgb3RoZXJ3aXNlLlxuICogQHBhcmFtIHshQXJyYXk8IVByb21pc2U+fSBwcm9taXNlcyBUaGUgYXJyYXkgb2YgcHJvbWlzZXMgdG8gdGVzdC5cbiAqIEBwYXJhbSB7bnVtYmVyfSBjb3VudCBUaGUgbnVtYmVyIG9mIHByb21pc2VzIHRoYXQgbXVzdCByZXNvbHZlIGZvciB0aGVcbiAqICAgICByZXR1cm5lZCBwcm9taXNlIHRvIHJlc29sdmUuXG4gKiBAcmV0dXJuIHshUHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgaWYgYW55IG9mIHRoZSBnaXZlbiBwcm9taXNlc1xuICogICAgIHJlc29sdmUsIGFuZCB3aGljaCByZWplY3RzIG90aGVyd2lzZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNvbWUocHJvbWlzZXMsIGNvdW50ID0gMSkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGNvdW50ID0gTWF0aC5tYXgoY291bnQsIDApO1xuICAgIGNvbnN0IGV4dHJhID0gcHJvbWlzZXMubGVuZ3RoIC0gY291bnQ7XG4gICAgaWYgKGV4dHJhIDwgMCkge1xuICAgICAgcmVqZWN0KG5ldyBFcnJvcignbm90IGVub3VnaCBwcm9taXNlcyB0byByZXNvbHZlJykpO1xuICAgIH1cbiAgICBpZiAocHJvbWlzZXMubGVuZ3RoID09IDApIHtcbiAgICAgIHJlc29sdmUoW10pO1xuICAgIH1cbiAgICBjb25zdCB2YWx1ZXMgPSBbXTtcbiAgICBjb25zdCByZWFzb25zID0gW107XG5cbiAgICBjb25zdCBvbkZ1bGZpbGxlZCA9IHZhbHVlID0+IHtcbiAgICAgIGlmICh2YWx1ZXMubGVuZ3RoIDwgY291bnQpIHtcbiAgICAgICAgdmFsdWVzLnB1c2godmFsdWUpO1xuICAgICAgfVxuICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPT0gY291bnQpIHtcbiAgICAgICAgcmVzb2x2ZSh2YWx1ZXMpO1xuICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgb25SZWplY3RlZCA9IHJlYXNvbiA9PiB7XG4gICAgICBpZiAocmVhc29ucy5sZW5ndGggPD0gZXh0cmEpIHtcbiAgICAgICAgcmVhc29ucy5wdXNoKHJlYXNvbik7XG4gICAgICB9XG4gICAgICBpZiAocmVhc29ucy5sZW5ndGggPiBleHRyYSkge1xuICAgICAgICByZWplY3QocmVhc29ucyk7XG4gICAgICB9XG4gICAgfTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb21pc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBQcm9taXNlLnJlc29sdmUocHJvbWlzZXNbaV0pLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpO1xuICAgIH1cbiAgfSk7XG59XG5cbi8qKlxuICogUmVzb2x2ZXMgd2l0aCB0aGUgcmVzdWx0IG9mIHRoZSBsYXN0IHByb21pc2UgYWRkZWQuXG4gKiBAaW1wbGVtZW50cyB7SVRoZW5hYmxlfVxuICovXG5leHBvcnQgY2xhc3MgTGFzdEFkZGVkUmVzb2x2ZXIge1xuICAvKipcbiAgICogQHBhcmFtIHshQXJyYXk8IVByb21pc2U+PX0gb3B0X3Byb21pc2VzXG4gICAqL1xuICBjb25zdHJ1Y3RvcihvcHRfcHJvbWlzZXMpIHtcbiAgICBsZXQgcmVzb2x2ZV8sIHJlamVjdF87XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IVByb21pc2V9ICovXG4gICAgdGhpcy5wcm9taXNlXyA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHJlc29sdmVfID0gcmVzb2x2ZTtcbiAgICAgIHJlamVjdF8gPSByZWplY3Q7XG4gICAgfSk7XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICB0aGlzLnJlc29sdmVfID0gcmVzb2x2ZV87XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICB0aGlzLnJlamVjdF8gPSByZWplY3RfO1xuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgdGhpcy5jb3VudF8gPSAwO1xuXG4gICAgaWYgKG9wdF9wcm9taXNlcykge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcHRfcHJvbWlzZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy5hZGQob3B0X3Byb21pc2VzW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWRkIGEgcHJvbWlzZSB0byBwb3NzaWJseSBiZSByZXNvbHZlZC5cbiAgICogQHBhcmFtIHshUHJvbWlzZX0gcHJvbWlzZVxuICAgKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAgICovXG4gIGFkZChwcm9taXNlKSB7XG4gICAgY29uc3QgY291bnRBdEFkZCA9ICsrdGhpcy5jb3VudF87XG4gICAgUHJvbWlzZS5yZXNvbHZlKHByb21pc2UpLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgIGlmICh0aGlzLmNvdW50XyA9PT0gY291bnRBdEFkZCkge1xuICAgICAgICB0aGlzLnJlc29sdmVfKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSwgZXJyb3IgPT4ge1xuICAgICAgLy8gRG9uJ3QgZm9sbG93IGJlaGF2aW9yIG9mIFByb21pc2UuYWxsIGFuZCBQcm9taXNlLnJhY2UgZXJyb3Igc28gdGhhdFxuICAgICAgLy8gdGhpcyB3aWxsIG9ubHkgcmVqZWN0IHdoZW4gbW9zdCByZWNlbnRseSBhZGRlZCBwcm9taXNlIGZhaWxzLlxuICAgICAgaWYgKHRoaXMuY291bnRfID09PSBjb3VudEF0QWRkKSB7XG4gICAgICAgIHRoaXMucmVqZWN0XyhlcnJvcik7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMucHJvbWlzZV87XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHRoZW4ob3B0X3Jlc29sdmUsIG9wdF9yZWplY3QpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9taXNlXy50aGVuKG9wdF9yZXNvbHZlLCBvcHRfcmVqZWN0KTtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogV3JhcHMgYSBnaXZlbiBjYWxsYmFjayBhbmQgYXBwbGllcyBhIHJhdGUgbGltaXQuXG4gKiBJdCB0aHJvdHRsZXMgdGhlIGNhbGxzIHNvIHRoYXQgbm8gY29uc2VxdWVudCBjYWxscyBoYXZlIHRpbWUgaW50ZXJ2YWxcbiAqIHNtYWxsZXIgdGhhbiB0aGUgZ2l2ZW4gbWluaW1hbCBpbnRlcnZhbC5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtmdW5jdGlvbiguLi4qKX0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7bnVtYmVyfSBtaW5JbnRlcnZhbCB0aGUgbWluaW11bSB0aW1lIGludGVydmFsIGluIG1pbGxpc2Vjb25kXG4gKiBAcmV0dXJuIHtmdW5jdGlvbiguLi4qKX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRocm90dGxlKHdpbiwgY2FsbGJhY2ssIG1pbkludGVydmFsKSB7XG4gIGxldCBsb2NrZXIgPSAwO1xuICBsZXQgbmV4dENhbGxBcmdzID0gbnVsbDtcblxuICAvKipcbiAgICogQHBhcmFtIHshT2JqZWN0fSBhcmdzXG4gICAqL1xuICBmdW5jdGlvbiBmaXJlKGFyZ3MpIHtcbiAgICBuZXh0Q2FsbEFyZ3MgPSBudWxsO1xuICAgIC8vIExvY2sgdGhlIGZpcmUgZm9yIG1pbkludGVydmFsIG1pbGxpc2Vjb25kc1xuICAgIGxvY2tlciA9IHdpbi5zZXRUaW1lb3V0KHdhaXRlciwgbWluSW50ZXJ2YWwpO1xuXG4gICAgY2FsbGJhY2suYXBwbHkobnVsbCwgYXJncyk7XG4gIH1cblxuICAvKipcbiAgICogV2FpdGVyIGZ1bmN0aW9uXG4gICAqL1xuICBmdW5jdGlvbiB3YWl0ZXIoKSB7XG4gICAgbG9ja2VyID0gMDtcbiAgICAvLyBJZiBkdXJpbmcgdGhlIHBlcmlvZCB0aGVyZSdyZSBpbnZvY2F0aW9ucyBxdWV1ZWQgdXAsIGZpcmUgb25jZS5cbiAgICBpZiAobmV4dENhbGxBcmdzKSB7XG4gICAgICBmaXJlKG5leHRDYWxsQXJncyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uKC4uLmFyZ3MpIHtcbiAgICBpZiAobG9ja2VyKSB7XG4gICAgICBuZXh0Q2FsbEFyZ3MgPSBhcmdzO1xuICAgIH0gZWxzZSB7XG4gICAgICBmaXJlKGFyZ3MpO1xuICAgIH1cbiAgfTtcbn1cblxuLyoqXG4gKiBXcmFwcyBhIGdpdmVuIGNhbGxiYWNrIGFuZCBhcHBsaWVzIGEgd2FpdCB0aW1lciwgc28gdGhhdCBtaW5JbnRlcnZhbFxuICogbWlsbGlzZWNvbmRzIG11c3QgcGFzcyBzaW5jZSB0aGUgbGFzdCBjYWxsIGJlZm9yZSB0aGUgY2FsbGJhY2sgaXMgYWN0dWFsbHlcbiAqIGludm9rZWQuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oLi4uKil9IGNhbGxiYWNrXG4gKiBAcGFyYW0ge251bWJlcn0gbWluSW50ZXJ2YWwgdGhlIG1pbmltdW0gdGltZSBpbnRlcnZhbCBpbiBtaWxsaXNlY29uZFxuICogQHJldHVybiB7ZnVuY3Rpb24oLi4uKil9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWJvdW5jZSh3aW4sIGNhbGxiYWNrLCBtaW5JbnRlcnZhbCkge1xuICBsZXQgbG9ja2VyID0gMDtcbiAgbGV0IHRpbWVzdGFtcCA9IDA7XG4gIGxldCBuZXh0Q2FsbEFyZ3MgPSBudWxsO1xuXG4gIC8qKlxuICAgKiBAcGFyYW0gez9BcnJheX0gYXJnc1xuICAgKi9cbiAgZnVuY3Rpb24gZmlyZShhcmdzKSB7XG4gICAgbmV4dENhbGxBcmdzID0gbnVsbDtcbiAgICBjYWxsYmFjay5hcHBseShudWxsLCBhcmdzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBXYWl0IGZ1bmN0aW9uIGZvciBkZWJvdW5jZVxuICAgKi9cbiAgZnVuY3Rpb24gd2FpdGVyKCkge1xuICAgIGxvY2tlciA9IDA7XG4gICAgY29uc3QgcmVtYWluaW5nID0gbWluSW50ZXJ2YWwgLSAod2luLkRhdGUubm93KCkgLSB0aW1lc3RhbXApO1xuICAgIGlmIChyZW1haW5pbmcgPiAwKSB7XG4gICAgICBsb2NrZXIgPSB3aW4uc2V0VGltZW91dCh3YWl0ZXIsIHJlbWFpbmluZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZpcmUobmV4dENhbGxBcmdzKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24oLi4uYXJncykge1xuICAgIHRpbWVzdGFtcCA9IHdpbi5EYXRlLm5vdygpO1xuICAgIG5leHRDYWxsQXJncyA9IGFyZ3M7XG4gICAgaWYgKCFsb2NrZXIpIHtcbiAgICAgIGxvY2tlciA9IHdpbi5zZXRUaW1lb3V0KHdhaXRlciwgbWluSW50ZXJ2YWwpO1xuICAgIH1cbiAgfTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge0RlZmVycmVkfSBmcm9tICcuL3Byb21pc2UnO1xuaW1wb3J0IHttYXB9IGZyb20gJy4vb2JqZWN0JztcblxuXG4vKipcbiAqIFRoaXMgb2JqZWN0IHRyYWN0cyBzaWduYWxzIGFuZCBhbGxvd3MgYmxvY2tpbmcgdW50aWwgYSBzaWduYWwgaGFzIGJlZW5cbiAqIHJlY2VpdmVkLlxuICovXG5leHBvcnQgY2xhc3MgU2lnbmFscyB7XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgU2lnbmFscy5cbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIC8qKlxuICAgICAqIEEgbWFwcGluZyBmcm9tIGEgc2lnbmFsIG5hbWUgdG8gdGhlIHNpZ25hbCByZXNwb25zZTogZWl0aGVyIHRpbWUgb3JcbiAgICAgKiBhbiBlcnJvci5cbiAgICAgKiBAcHJpdmF0ZSBAY29uc3QgeyFPYmplY3Q8c3RyaW5nLCAodGltZXwhRXJyb3IpPn1cbiAgICAgKi9cbiAgICB0aGlzLm1hcF8gPSBtYXAoKTtcblxuICAgIC8qKlxuICAgICAqIEEgbWFwcGluZyBmcm9tIGEgc2lnbmFsIG5hbWUgdG8gdGhlIHNpZ25hbCBwcm9taXNlLCByZXNvbHZlIGFuZCByZWplY3QuXG4gICAgICogT25seSBhbGxvY2F0ZWQgd2hlbiBwcm9taXNlIGhhcyBiZWVuIHJlcXVlc3RlZC5cbiAgICAgKiBAcHJpdmF0ZSB7P09iamVjdDxzdHJpbmcsIHtcbiAgICAgKiAgIHByb21pc2U6ICFQcm9taXNlLFxuICAgICAqICAgcmVzb2x2ZTogKGZ1bmN0aW9uKHRpbWUpfHVuZGVmaW5lZCksXG4gICAgICogICByZWplY3Q6IChmdW5jdGlvbighRXJyb3IpfHVuZGVmaW5lZClcbiAgICAgKiB9Pn1cbiAgICAgKi9cbiAgICB0aGlzLnByb21pc2VNYXBfID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IGtub3duIHZhbHVlIG9mIHRoZSBzaWduYWwuIElmIHNpZ25hbCBpcyBub3QgeWV0XG4gICAqIGF2YWlsYWJsZSwgYG51bGxgIGlzIHJldHVybmVkLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcmV0dXJuIHtudW1iZXJ8IUVycm9yfG51bGx9XG4gICAqL1xuICBnZXQobmFtZSkge1xuICAgIHJldHVybiB0aGlzLm1hcF9bbmFtZV0gfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBwcm9taXNlIHRoYXQncyByZXNvbHZlZCB3aGVuIHRoZSBzaWduYWwgaXMgdHJpZ2dlcmVkLiBUaGVcbiAgICogcmVzb2x2ZWQgdmFsdWUgaXMgdGhlIHRpbWUgb2YgdGhlIHNpZ25hbC5cbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICogQHJldHVybiB7IVByb21pc2U8dGltZT59XG4gICAqL1xuICB3aGVuU2lnbmFsKG5hbWUpIHtcbiAgICBsZXQgcHJvbWlzZVN0cnVjdCA9IHRoaXMucHJvbWlzZU1hcF8gJiYgdGhpcy5wcm9taXNlTWFwX1tuYW1lXTtcbiAgICBpZiAoIXByb21pc2VTdHJ1Y3QpIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMubWFwX1tuYW1lXTtcbiAgICAgIGlmIChyZXN1bHQgIT0gbnVsbCkge1xuICAgICAgICAvLyBJbW1lZGlhdGVseSByZXNvbHZlIHNpZ25hbC5cbiAgICAgICAgY29uc3QgcHJvbWlzZSA9IHR5cGVvZiByZXN1bHQgPT0gJ251bWJlcicgP1xuICAgICAgICAgIFByb21pc2UucmVzb2x2ZShyZXN1bHQpIDpcbiAgICAgICAgICBQcm9taXNlLnJlamVjdChyZXN1bHQpO1xuICAgICAgICBwcm9taXNlU3RydWN0ID0ge3Byb21pc2V9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gQWxsb2NhdGUgdGhlIHByb21pc2UvcmVzb2x2ZXIgZm9yIHdoZW4gdGhlIHNpZ25hbCBhcnJpdmVzIGluIHRoZVxuICAgICAgICAvLyBmdXR1cmUuXG4gICAgICAgIGNvbnN0IGRlZmVycmVkID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgIGNvbnN0IHtwcm9taXNlLCByZXNvbHZlLCByZWplY3R9ID0gZGVmZXJyZWQ7XG5cbiAgICAgICAgcHJvbWlzZVN0cnVjdCA9IHtwcm9taXNlLCByZXNvbHZlLCByZWplY3R9O1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLnByb21pc2VNYXBfKSB7XG4gICAgICAgIHRoaXMucHJvbWlzZU1hcF8gPSBtYXAoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMucHJvbWlzZU1hcF9bbmFtZV0gPSBwcm9taXNlU3RydWN0O1xuICAgIH1cbiAgICByZXR1cm4gcHJvbWlzZVN0cnVjdC5wcm9taXNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFRyaWdnZXJzIHRoZSBzaWduYWwgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUgb24gdGhlIGVsZW1lbnQuIFRoZSB0aW1lIGlzXG4gICAqIG9wdGlvbmFsOyBpZiBub3QgcHJvdmlkZWQsIHRoZSBjdXJyZW50IHRpbWUgaXMgdXNlZC4gVGhlIGFzc29jaWF0ZWRcbiAgICogcHJvbWlzZSBpcyByZXNvbHZlZCB3aXRoIHRoZSByZXN1bHRpbmcgdGltZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICogQHBhcmFtIHt0aW1lPX0gb3B0X3RpbWVcbiAgICovXG4gIHNpZ25hbChuYW1lLCBvcHRfdGltZSkge1xuICAgIGlmICh0aGlzLm1hcF9bbmFtZV0gIT0gbnVsbCkge1xuICAgICAgLy8gRG8gbm90IGR1cGxpY2F0ZSBzaWduYWxzLlxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB0aW1lID0gb3B0X3RpbWUgfHwgRGF0ZS5ub3coKTtcbiAgICB0aGlzLm1hcF9bbmFtZV0gPSB0aW1lO1xuICAgIGNvbnN0IHByb21pc2VTdHJ1Y3QgPSB0aGlzLnByb21pc2VNYXBfICYmIHRoaXMucHJvbWlzZU1hcF9bbmFtZV07XG4gICAgaWYgKHByb21pc2VTdHJ1Y3QgJiYgcHJvbWlzZVN0cnVjdC5yZXNvbHZlKSB7XG4gICAgICBwcm9taXNlU3RydWN0LnJlc29sdmUodGltZSk7XG4gICAgICBwcm9taXNlU3RydWN0LnJlc29sdmUgPSB1bmRlZmluZWQ7XG4gICAgICBwcm9taXNlU3RydWN0LnJlamVjdCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVqZWN0cyB0aGUgc2lnbmFsLiBJbmRpY2F0ZXMgdGhhdCB0aGUgc2lnbmFsIHdpbGwgbmV2ZXIgc3VjY2VlZC4gVGhlXG4gICAqIGFzc29jaWF0ZWQgc2lnbmFsIGlzIHJlamVjdGVkLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcGFyYW0geyFFcnJvcn0gZXJyb3JcbiAgICovXG4gIHJlamVjdFNpZ25hbChuYW1lLCBlcnJvcikge1xuICAgIGlmICh0aGlzLm1hcF9bbmFtZV0gIT0gbnVsbCkge1xuICAgICAgLy8gRG8gbm90IGR1cGxpY2F0ZSBzaWduYWxzLlxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLm1hcF9bbmFtZV0gPSBlcnJvcjtcbiAgICBjb25zdCBwcm9taXNlU3RydWN0ID0gdGhpcy5wcm9taXNlTWFwXyAmJiB0aGlzLnByb21pc2VNYXBfW25hbWVdO1xuICAgIGlmIChwcm9taXNlU3RydWN0ICYmIHByb21pc2VTdHJ1Y3QucmVqZWN0KSB7XG4gICAgICBwcm9taXNlU3RydWN0LnJlamVjdChlcnJvcik7XG4gICAgICBwcm9taXNlU3RydWN0LnJlc29sdmUgPSB1bmRlZmluZWQ7XG4gICAgICBwcm9taXNlU3RydWN0LnJlamVjdCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVzZXRzIGFsbCBzaWduYWxzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKi9cbiAgcmVzZXQobmFtZSkge1xuICAgIGlmICh0aGlzLm1hcF9bbmFtZV0pIHtcbiAgICAgIGRlbGV0ZSB0aGlzLm1hcF9bbmFtZV07XG4gICAgfVxuICAgIC8vIFJlc2V0IHByb21pc2UgaXQgaGFzIGFscmVhZHkgYmVlbiByZXNvbHZlZC5cbiAgICBjb25zdCBwcm9taXNlU3RydWN0ID0gdGhpcy5wcm9taXNlTWFwXyAmJiB0aGlzLnByb21pc2VNYXBfW25hbWVdO1xuICAgIGlmIChwcm9taXNlU3RydWN0ICYmICFwcm9taXNlU3RydWN0LnJlc29sdmUpIHtcbiAgICAgIGRlbGV0ZSB0aGlzLnByb21pc2VNYXBfW25hbWVdO1xuICAgIH1cbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQW4gaW50ZXJmYWNlIHRvIGludGVyYWN0IHdpdGggYnJvd3NlciB3aW5kb3cgb2JqZWN0LlxuICogTWFpbmx5IHVzZWQgdG8gbW9jayBvdXQgcmVhZCBvbmx5IEFQSXMgaW4gdGVzdC5cbiAqIFNlZSB0ZXN0LWhlbHBlci5qcyNtb2NrV2luZG93SW50ZXJmYWNlXG4gKi9cbmV4cG9ydCBjbGFzcyBXaW5kb3dJbnRlcmZhY2Uge1xuXG4gIC8qKlxuICAgKiBAc3RhdGljXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICovXG4gIHN0YXRpYyBnZXREb2N1bWVudFJlZmVycmVyKHdpbikge1xuICAgIHJldHVybiB3aW4uZG9jdW1lbnQucmVmZXJyZXI7XG4gIH1cblxuICAvKipcbiAgICogQHN0YXRpY1xuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAqL1xuICBzdGF0aWMgZ2V0SG9zdG5hbWUod2luKSB7XG4gICAgcmV0dXJuIHdpbi5sb2NhdGlvbi5ob3N0bmFtZTtcbiAgfVxufVxuIiwiLyohIGh0dHBzOi8vbXRocy5iZS9jc3Nlc2NhcGUgdjEuNS4xIGJ5IEBtYXRoaWFzIHwgTUlUIGxpY2Vuc2UgKi9cblxuXG4vKipcbiAqIFRoaXMgcmVnZXggY29uc2lzdHMgb2YgNCBtYXRjaGluZyBjYXB0dXJlIGdyb3VwcyBhbmQgb25lIChub24tbWF0Y2hpbmcpIGZhbGxiYWNrOlxuICpcbiAqIC0gKFxcMCksIGNhdGNoIHRoZSBudWxsIHRlcm1pbmF0b3IgY2hhcmFjdGVyIHNvIGl0IG1heSBiZSByZXBsYWNlZCBieSBVVEZcbiAqICAgUmVwbGFjZW1lbnQgQ2hhclxuICogLSBeKC0pJCwgY2F0Y2ggYSBzb2xpdGFyeSBkYXNoIGNoYXIsIHNvIHRoYXQgaXQgbWF5IGJlIGJhY2tzbGFzaCBlc2NhcGVkLlxuICogICBUaGlzIGlzIGEgc2VwYXJhdGUgY2FwdHVyZSBncm91cCBzbyB0aGF0IHRoZSBsZWdhbC1jaGFycyAoZ3JvdXAgNCkgZG9lc24ndFxuICogICBjYXB0dXJlIGl0IGZpcnN0LCBzaW5jZSB0aGF0IGdyb3VwIGRvZXNuJ3QgbmVlZCB0byBlc2NhcGUgaXRzIGRhc2guXG4gKiAtIChbXFx4MDEtXFx4MWZcXHg3Zl18Xi0/WzAtOV0pLCBjYXRjaCBhIFVURiBjb250cm9sIGNoYXIsIG9yIGFueSBsZWFkaW5nXG4gKiAgIG51bWJlciAod2l0aCBhbiBvcHRpb25hbCBsZWFkaW5nIGRhc2gpLiBUaGUgY29udHJvbCBvciB0aGUgbnVtYmVyIChidXQgbm90XG4gKiAgIHRoZSBsZWFkaW5nIGRhc2gpIG11c3QgYmUgaGV4LWVzY2FwZWQsLlxuICogLSAoW1xceDgwLVxcdWZmZmYwLTlhLXpBLVpfLV0rKSwgY2F0Y2ggbGVnYWwtY2hhcnMsIHdpdGggdGhlIGV4Y2VwdGlvbiBvZiBhXG4gKiAgIHNvbGl0YXJ5IGRhc2gsIHdoaWNoIHdpbGwgYWxyZWFkeSBoYXZlIG1hdGNoZWQgaW4gZ3JvdXAgMS5cbiAqIC0gW15dLCBmaW5hbGx5LCBhIGNhdGNoLWFsbCB0aGF0IGFsbG93cyB1cyB0byBiYWNrc2xhc2ggZXNjYXBlIHRoZSBjaGFyLlxuICpcbiAqIFRvZ2V0aGVyLCB0aGlzIG1hdGNoZXMgZXZlcnl0aGluZyBuZWNlc3NhcnkgZm9yIENTUy5lc2NhcGUuXG4gKi9cbnZhciByZWdleCA9IC8oXFwwKXxeKC0pJHwoW1xceDAxLVxceDFmXFx4N2ZdfF4tP1swLTldKXwoW1xceDgwLVxcdWZmZmYwLTlhLXpBLVpfLV0rKXxbXl0vZztcblxuZnVuY3Rpb24gZXNjYXBlcihtYXRjaCwgbmlsLCBkYXNoLCBoZXhFc2NhcGUsIGNoYXJzKSB7XG4gIC8vIENoYXJzIGlzIHRoZSBsZWdhbC1jaGFycyAoZ3JvdXAgNCkgY2FwdHVyZVxuICBpZiAoY2hhcnMpIHtcbiAgICByZXR1cm4gY2hhcnM7XG4gIH1cbiAgLy8gTmlsIGlzIHRoZSBudWxsIHRlcm1pbmF0b3IgKGdyb3VwIDEpIGNhcHR1cmVcbiAgaWYgKG5pbCkge1xuICAgIHJldHVybiAnXFx1RkZGRCc7XG4gIH1cbiAgLy8gQm90aCBVVEYgY29udHJvbCBjaGFycywgYW5kIGxlYWRpbmcgbnVtYmVycyAod2l0aCBvcHRpb25hbCBsZWFkaW5nIGRhc2gpXG4gIC8vIChncm91cCAzKSBtdXN0IGJlIGJhY2tzbGFzaCBlc2NhcGVkIHdpdGggYSB0cmFpbGluZyBzcGFjZS4gIEZ1bm5pbHksIHRoZVxuICAvLyBsZWFkaW5nIGRhc2ggbXVzdCBub3QgYmUgZXNjYXBlZCwgYnV0IHRoZSBudW1iZXIuIDpzaHJ1ZzpcbiAgaWYgKGhleEVzY2FwZSkge1xuICAgIHJldHVybiBtYXRjaC5zbGljZSgwLCAtMSkgKyAnXFxcXCcgKyBtYXRjaC5zbGljZSgtMSkuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikgKyAnICdcbiAgfVxuICAvLyBGaW5hbGx5LCB0aGUgc29saXRhcnkgZGFzaCBhbmQgdGhlIGNhdGNoLWFsbCBjaGFycyByZXF1aXJlIGJhY2tzbGFzaFxuICAvLyBlc2NhcGluZy5cbiAgcmV0dXJuICdcXFxcJyArIG1hdGNoO1xufVxuXG4vKipcbiAqIGh0dHBzOi8vZHJhZnRzLmNzc3dnLm9yZy9jc3NvbS8jc2VyaWFsaXplLWFuLWlkZW50aWZpZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3NzRXNjYXBlKHZhbHVlKSB7XG4gIHJldHVybiBTdHJpbmcodmFsdWUpLnJlcGxhY2UocmVnZXgsIGVzY2FwZXIpO1xufVxuIl19"}